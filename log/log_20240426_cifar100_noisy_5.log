nohup: ignoring input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.404, Test loss: 1.100, Test accuracy: 53.44
Round   0, Global train loss: 1.404, Global test loss: 1.095, Global test accuracy: 53.60
Round   1, Train loss: 1.142, Test loss: 0.974, Test accuracy: 58.98
Round   1, Global train loss: 1.142, Global test loss: 0.901, Global test accuracy: 62.40
Round   2, Train loss: 1.139, Test loss: 0.968, Test accuracy: 58.14
Round   2, Global train loss: 1.139, Global test loss: 0.960, Global test accuracy: 58.00
Round   3, Train loss: 0.980, Test loss: 0.889, Test accuracy: 62.48
Round   3, Global train loss: 0.980, Global test loss: 0.826, Global test accuracy: 65.00
Round   4, Train loss: 0.896, Test loss: 0.852, Test accuracy: 64.24
Round   4, Global train loss: 0.896, Global test loss: 0.728, Global test accuracy: 68.60
Round   5, Train loss: 0.829, Test loss: 0.863, Test accuracy: 64.16
Round   5, Global train loss: 0.829, Global test loss: 0.742, Global test accuracy: 69.60
Round   6, Train loss: 0.845, Test loss: 0.841, Test accuracy: 64.56
Round   6, Global train loss: 0.845, Global test loss: 0.691, Global test accuracy: 69.40
Round   7, Train loss: 0.767, Test loss: 0.839, Test accuracy: 64.94
Round   7, Global train loss: 0.767, Global test loss: 0.743, Global test accuracy: 69.60
Round   8, Train loss: 0.893, Test loss: 0.815, Test accuracy: 66.06
Round   8, Global train loss: 0.893, Global test loss: 0.781, Global test accuracy: 67.40
Round   9, Train loss: 0.870, Test loss: 0.795, Test accuracy: 67.48
Round   9, Global train loss: 0.870, Global test loss: 0.734, Global test accuracy: 70.00
Round  10, Train loss: 0.786, Test loss: 0.810, Test accuracy: 66.66
Round  10, Global train loss: 0.786, Global test loss: 0.710, Global test accuracy: 71.20
Round  11, Train loss: 0.766, Test loss: 0.821, Test accuracy: 67.04
Round  11, Global train loss: 0.766, Global test loss: 0.744, Global test accuracy: 69.80
Round  12, Train loss: 0.696, Test loss: 0.805, Test accuracy: 67.64
Round  12, Global train loss: 0.696, Global test loss: 0.691, Global test accuracy: 72.20
Round  13, Train loss: 0.704, Test loss: 0.820, Test accuracy: 67.26
Round  13, Global train loss: 0.704, Global test loss: 0.685, Global test accuracy: 71.20
Round  14, Train loss: 0.683, Test loss: 0.804, Test accuracy: 68.54
Round  14, Global train loss: 0.683, Global test loss: 0.688, Global test accuracy: 72.60
Round  15, Train loss: 0.703, Test loss: 0.821, Test accuracy: 68.04
Round  15, Global train loss: 0.703, Global test loss: 0.724, Global test accuracy: 73.20
Round  16, Train loss: 0.689, Test loss: 0.834, Test accuracy: 67.34
Round  16, Global train loss: 0.689, Global test loss: 0.678, Global test accuracy: 70.60
Round  17, Train loss: 0.626, Test loss: 0.823, Test accuracy: 67.58
Round  17, Global train loss: 0.626, Global test loss: 0.673, Global test accuracy: 72.00
Round  18, Train loss: 0.646, Test loss: 0.799, Test accuracy: 68.06
Round  18, Global train loss: 0.646, Global test loss: 0.695, Global test accuracy: 72.60
Round  19, Train loss: 0.596, Test loss: 0.814, Test accuracy: 68.20
Round  19, Global train loss: 0.596, Global test loss: 0.668, Global test accuracy: 74.00
Round  20, Train loss: 0.677, Test loss: 0.820, Test accuracy: 68.40
Round  20, Global train loss: 0.677, Global test loss: 0.717, Global test accuracy: 71.20
Round  21, Train loss: 0.520, Test loss: 0.820, Test accuracy: 69.12
Round  21, Global train loss: 0.520, Global test loss: 0.661, Global test accuracy: 73.20
Round  22, Train loss: 0.635, Test loss: 0.793, Test accuracy: 69.64
Round  22, Global train loss: 0.635, Global test loss: 0.662, Global test accuracy: 73.60
Round  23, Train loss: 0.529, Test loss: 0.767, Test accuracy: 71.00
Round  23, Global train loss: 0.529, Global test loss: 0.655, Global test accuracy: 75.40
Round  24, Train loss: 0.550, Test loss: 0.787, Test accuracy: 70.36
Round  24, Global train loss: 0.550, Global test loss: 0.735, Global test accuracy: 72.60
Round  25, Train loss: 0.608, Test loss: 0.790, Test accuracy: 70.12
Round  25, Global train loss: 0.608, Global test loss: 0.684, Global test accuracy: 71.20
Round  26, Train loss: 0.467, Test loss: 0.781, Test accuracy: 70.32
Round  26, Global train loss: 0.467, Global test loss: 0.667, Global test accuracy: 73.00
Round  27, Train loss: 0.603, Test loss: 0.770, Test accuracy: 71.34
Round  27, Global train loss: 0.603, Global test loss: 0.654, Global test accuracy: 74.20
Round  28, Train loss: 0.588, Test loss: 0.803, Test accuracy: 70.62
Round  28, Global train loss: 0.588, Global test loss: 0.692, Global test accuracy: 72.80
Round  29, Train loss: 0.489, Test loss: 0.819, Test accuracy: 70.46
Round  29, Global train loss: 0.489, Global test loss: 0.637, Global test accuracy: 74.80
Round  30, Train loss: 0.426, Test loss: 0.823, Test accuracy: 70.22
Round  30, Global train loss: 0.426, Global test loss: 0.682, Global test accuracy: 74.20
Round  31, Train loss: 0.469, Test loss: 0.834, Test accuracy: 70.02
Round  31, Global train loss: 0.469, Global test loss: 0.696, Global test accuracy: 74.20
Round  32, Train loss: 0.463, Test loss: 0.805, Test accuracy: 71.14
Round  32, Global train loss: 0.463, Global test loss: 0.629, Global test accuracy: 74.40
Round  33, Train loss: 0.413, Test loss: 0.831, Test accuracy: 71.32
Round  33, Global train loss: 0.413, Global test loss: 0.619, Global test accuracy: 75.40
Round  34, Train loss: 0.439, Test loss: 0.850, Test accuracy: 71.14
Round  34, Global train loss: 0.439, Global test loss: 0.671, Global test accuracy: 72.80
Round  35, Train loss: 0.495, Test loss: 0.859, Test accuracy: 70.96
Round  35, Global train loss: 0.495, Global test loss: 0.682, Global test accuracy: 72.80
Round  36, Train loss: 0.428, Test loss: 0.866, Test accuracy: 71.38
Round  36, Global train loss: 0.428, Global test loss: 0.689, Global test accuracy: 74.40
Round  37, Train loss: 0.405, Test loss: 0.874, Test accuracy: 71.26
Round  37, Global train loss: 0.405, Global test loss: 0.687, Global test accuracy: 73.00
Round  38, Train loss: 0.409, Test loss: 0.894, Test accuracy: 71.70
Round  38, Global train loss: 0.409, Global test loss: 0.672, Global test accuracy: 74.00
Round  39, Train loss: 0.404, Test loss: 0.882, Test accuracy: 72.42
Round  39, Global train loss: 0.404, Global test loss: 0.673, Global test accuracy: 74.60
Round  40, Train loss: 0.382, Test loss: 0.876, Test accuracy: 72.16
Round  40, Global train loss: 0.382, Global test loss: 0.722, Global test accuracy: 73.00
Round  41, Train loss: 0.277, Test loss: 0.897, Test accuracy: 71.86
Round  41, Global train loss: 0.277, Global test loss: 0.696, Global test accuracy: 76.20
Round  42, Train loss: 0.389, Test loss: 0.923, Test accuracy: 70.90
Round  42, Global train loss: 0.389, Global test loss: 0.622, Global test accuracy: 75.40
Round  43, Train loss: 0.338, Test loss: 0.935, Test accuracy: 71.28
Round  43, Global train loss: 0.338, Global test loss: 0.680, Global test accuracy: 75.00
Round  44, Train loss: 0.339, Test loss: 0.927, Test accuracy: 72.06
Round  44, Global train loss: 0.339, Global test loss: 0.616, Global test accuracy: 75.40
Round  45, Train loss: 0.298, Test loss: 0.925, Test accuracy: 71.96
Round  45, Global train loss: 0.298, Global test loss: 0.689, Global test accuracy: 75.20
Round  46, Train loss: 0.288, Test loss: 0.968, Test accuracy: 71.00
Round  46, Global train loss: 0.288, Global test loss: 0.687, Global test accuracy: 75.80
Round  47, Train loss: 0.278, Test loss: 0.945, Test accuracy: 71.24
Round  47, Global train loss: 0.278, Global test loss: 0.681, Global test accuracy: 75.40
Round  48, Train loss: 0.279, Test loss: 0.933, Test accuracy: 71.90
Round  48, Global train loss: 0.279, Global test loss: 0.702, Global test accuracy: 73.40
Round  49, Train loss: 0.298, Test loss: 0.966, Test accuracy: 71.74
Round  49, Global train loss: 0.298, Global test loss: 0.739, Global test accuracy: 73.20
Round  50, Train loss: 0.260, Test loss: 0.965, Test accuracy: 71.96
Round  50, Global train loss: 0.260, Global test loss: 0.668, Global test accuracy: 76.60
Round  51, Train loss: 0.286, Test loss: 0.949, Test accuracy: 72.48
Round  51, Global train loss: 0.286, Global test loss: 0.646, Global test accuracy: 76.80
Round  52, Train loss: 0.231, Test loss: 0.981, Test accuracy: 72.18
Round  52, Global train loss: 0.231, Global test loss: 0.680, Global test accuracy: 77.00
Round  53, Train loss: 0.273, Test loss: 0.963, Test accuracy: 72.60
Round  53, Global train loss: 0.273, Global test loss: 0.672, Global test accuracy: 76.20
Round  54, Train loss: 0.359, Test loss: 0.968, Test accuracy: 72.78
Round  54, Global train loss: 0.359, Global test loss: 0.662, Global test accuracy: 75.00
Round  55, Train loss: 0.223, Test loss: 0.980, Test accuracy: 72.76
Round  55, Global train loss: 0.223, Global test loss: 0.813, Global test accuracy: 74.00
Round  56, Train loss: 0.251, Test loss: 0.978, Test accuracy: 72.68
Round  56, Global train loss: 0.251, Global test loss: 0.739, Global test accuracy: 75.40
Round  57, Train loss: 0.295, Test loss: 1.008, Test accuracy: 72.58
Round  57, Global train loss: 0.295, Global test loss: 0.716, Global test accuracy: 75.60
Round  58, Train loss: 0.261, Test loss: 1.030, Test accuracy: 72.46
Round  58, Global train loss: 0.261, Global test loss: 0.684, Global test accuracy: 76.00
Round  59, Train loss: 0.273, Test loss: 1.068, Test accuracy: 71.86
Round  59, Global train loss: 0.273, Global test loss: 0.733, Global test accuracy: 75.00
Round  60, Train loss: 0.275, Test loss: 1.073, Test accuracy: 72.40
Round  60, Global train loss: 0.275, Global test loss: 0.678, Global test accuracy: 76.60
Round  61, Train loss: 0.210, Test loss: 1.080, Test accuracy: 72.20
Round  61, Global train loss: 0.210, Global test loss: 0.749, Global test accuracy: 76.40
Round  62, Train loss: 0.239, Test loss: 1.077, Test accuracy: 72.60
Round  62, Global train loss: 0.239, Global test loss: 0.751, Global test accuracy: 74.40
Round  63, Train loss: 0.213, Test loss: 1.094, Test accuracy: 72.60
Round  63, Global train loss: 0.213, Global test loss: 0.695, Global test accuracy: 76.00
Round  64, Train loss: 0.145, Test loss: 1.104, Test accuracy: 72.76
Round  64, Global train loss: 0.145, Global test loss: 0.696, Global test accuracy: 76.40
Round  65, Train loss: 0.241, Test loss: 1.102, Test accuracy: 72.64
Round  65, Global train loss: 0.241, Global test loss: 0.700, Global test accuracy: 76.60
Round  66, Train loss: 0.181, Test loss: 1.101, Test accuracy: 72.32
Round  66, Global train loss: 0.181, Global test loss: 0.677, Global test accuracy: 76.00
Round  67, Train loss: 0.183, Test loss: 1.112, Test accuracy: 72.08
Round  67, Global train loss: 0.183, Global test loss: 0.676, Global test accuracy: 76.20
Round  68, Train loss: 0.174, Test loss: 1.119, Test accuracy: 72.18
Round  68, Global train loss: 0.174, Global test loss: 0.653, Global test accuracy: 78.00
Round  69, Train loss: 0.201, Test loss: 1.173, Test accuracy: 72.02
Round  69, Global train loss: 0.201, Global test loss: 0.701, Global test accuracy: 77.00
Round  70, Train loss: 0.180, Test loss: 1.198, Test accuracy: 71.86
Round  70, Global train loss: 0.180, Global test loss: 0.760, Global test accuracy: 74.60
Round  71, Train loss: 0.136, Test loss: 1.199, Test accuracy: 72.12
Round  71, Global train loss: 0.136, Global test loss: 0.743, Global test accuracy: 75.80
Round  72, Train loss: 0.126, Test loss: 1.193, Test accuracy: 71.98
Round  72, Global train loss: 0.126, Global test loss: 0.741, Global test accuracy: 76.00
Round  73, Train loss: 0.195, Test loss: 1.142, Test accuracy: 72.56
Round  73, Global train loss: 0.195, Global test loss: 0.741, Global test accuracy: 75.40
Round  74, Train loss: 0.203, Test loss: 1.207, Test accuracy: 72.10
Round  74, Global train loss: 0.203, Global test loss: 0.749, Global test accuracy: 73.00
Round  75, Train loss: 0.138, Test loss: 1.211, Test accuracy: 72.30
Round  75, Global train loss: 0.138, Global test loss: 0.779, Global test accuracy: 75.40
Round  76, Train loss: 0.162, Test loss: 1.293, Test accuracy: 71.38
Round  76, Global train loss: 0.162, Global test loss: 0.867, Global test accuracy: 76.20
Round  77, Train loss: 0.139, Test loss: 1.308, Test accuracy: 71.64
Round  77, Global train loss: 0.139, Global test loss: 0.779, Global test accuracy: 75.00
Round  78, Train loss: 0.149, Test loss: 1.317, Test accuracy: 71.26
Round  78, Global train loss: 0.149, Global test loss: 0.655, Global test accuracy: 76.80
Round  79, Train loss: 0.146, Test loss: 1.390, Test accuracy: 71.00
Round  79, Global train loss: 0.146, Global test loss: 0.777, Global test accuracy: 74.40
Round  80, Train loss: 0.165, Test loss: 1.406, Test accuracy: 71.30
Round  80, Global train loss: 0.165, Global test loss: 0.727, Global test accuracy: 74.00
Round  81, Train loss: 0.161, Test loss: 1.313, Test accuracy: 71.46
Round  81, Global train loss: 0.161, Global test loss: 0.788, Global test accuracy: 75.60
Round  82, Train loss: 0.131, Test loss: 1.305, Test accuracy: 71.68
Round  82, Global train loss: 0.131, Global test loss: 0.764, Global test accuracy: 74.80
Round  83, Train loss: 0.116, Test loss: 1.327, Test accuracy: 71.38
Round  83, Global train loss: 0.116, Global test loss: 0.869, Global test accuracy: 73.60
Round  84, Train loss: 0.120, Test loss: 1.323, Test accuracy: 71.80
Round  84, Global train loss: 0.120, Global test loss: 0.676, Global test accuracy: 79.80
Round  85, Train loss: 0.148, Test loss: 1.322, Test accuracy: 71.76
Round  85, Global train loss: 0.148, Global test loss: 0.782, Global test accuracy: 75.40
Round  86, Train loss: 0.127, Test loss: 1.368, Test accuracy: 71.78
Round  86, Global train loss: 0.127, Global test loss: 0.781, Global test accuracy: 74.40
Round  87, Train loss: 0.129, Test loss: 1.390, Test accuracy: 71.66
Round  87, Global train loss: 0.129, Global test loss: 0.827, Global test accuracy: 75.00
Round  88, Train loss: 0.127, Test loss: 1.363, Test accuracy: 71.90
Round  88, Global train loss: 0.127, Global test loss: 0.778, Global test accuracy: 76.40
Round  89, Train loss: 0.137, Test loss: 1.349, Test accuracy: 72.00
Round  89, Global train loss: 0.137, Global test loss: 0.701, Global test accuracy: 75.00
Round  90, Train loss: 0.115, Test loss: 1.336, Test accuracy: 71.60
Round  90, Global train loss: 0.115, Global test loss: 0.658, Global test accuracy: 76.40
Round  91, Train loss: 0.117, Test loss: 1.321, Test accuracy: 72.36
Round  91, Global train loss: 0.117, Global test loss: 0.717, Global test accuracy: 76.20
Round  92, Train loss: 0.095, Test loss: 1.378, Test accuracy: 72.28
Round  92, Global train loss: 0.095, Global test loss: 0.818, Global test accuracy: 75.60
Round  93, Train loss: 0.098, Test loss: 1.313, Test accuracy: 72.92
Round  93, Global train loss: 0.098, Global test loss: 0.777, Global test accuracy: 76.60
Round  94, Train loss: 0.088, Test loss: 1.342, Test accuracy: 73.04
Round  94, Global train loss: 0.088, Global test loss: 0.768, Global test accuracy: 77.80
Round  95, Train loss: 0.095, Test loss: 1.333, Test accuracy: 73.18
Round  95, Global train loss: 0.095, Global test loss: 0.864, Global test accuracy: 74.60
Round  96, Train loss: 0.128, Test loss: 1.352, Test accuracy: 72.74
Round  96, Global train loss: 0.128, Global test loss: 0.788, Global test accuracy: 75.00
Round  97, Train loss: 0.116, Test loss: 1.409, Test accuracy: 71.76
Round  97, Global train loss: 0.116, Global test loss: 0.835, Global test accuracy: 75.80
Round  98, Train loss: 0.083, Test loss: 1.421, Test accuracy: 72.32
Round  98, Global train loss: 0.083, Global test loss: 0.870, Global test accuracy: 75.40
Round  99, Train loss: 0.100, Test loss: 1.415, Test accuracy: 72.22
Round  99, Global train loss: 0.100, Global test loss: 0.876, Global test accuracy: 75.20
Final Round, Train loss: 0.097, Test loss: 1.458, Test accuracy: 73.02
Final Round, Global train loss: 0.097, Global test loss: 0.876, Global test accuracy: 75.20
Average accuracy final 10 rounds: 72.442 

Average global accuracy final 10 rounds: 75.86 

1015.5328197479248
[1.82037353515625, 3.6407470703125, 5.180870532989502, 6.720993995666504, 8.152337551116943, 9.583681106567383, 11.141531229019165, 12.699381351470947, 14.299602031707764, 15.89982271194458, 17.473193883895874, 19.046565055847168, 20.621822357177734, 22.1970796585083, 23.750437259674072, 25.303794860839844, 26.95282745361328, 28.60186004638672, 30.24576187133789, 31.889663696289062, 33.53720498085022, 35.18474626541138, 36.8234121799469, 38.46207809448242, 40.07252645492554, 41.68297481536865, 43.37212300300598, 45.06127119064331, 46.6294379234314, 48.19760465621948, 49.73343634605408, 51.26926803588867, 52.84004878997803, 54.41082954406738, 56.141844511032104, 57.872859477996826, 59.41670489311218, 60.96055030822754, 62.52687644958496, 64.09320259094238, 65.61657118797302, 67.13993978500366, 68.8222644329071, 70.50458908081055, 72.2671570777893, 74.02972507476807, 75.56433987617493, 77.09895467758179, 78.74876141548157, 80.39856815338135, 82.0216703414917, 83.64477252960205, 85.16618514060974, 86.68759775161743, 88.39531350135803, 90.10302925109863, 91.61475777626038, 93.12648630142212, 94.83027267456055, 96.53405904769897, 98.19210886955261, 99.85015869140625, 101.49997019767761, 103.14978170394897, 104.71317601203918, 106.2765703201294, 107.99682402610779, 109.71707773208618, 111.63210535049438, 113.54713296890259, 115.56496000289917, 117.58278703689575, 119.34477996826172, 121.10677289962769, 122.71467614173889, 124.3225793838501, 126.00625777244568, 127.68993616104126, 129.41316437721252, 131.1363925933838, 132.69166207313538, 134.24693155288696, 135.81401371955872, 137.38109588623047, 138.9375603199005, 140.49402475357056, 142.00575160980225, 143.51747846603394, 145.06883120536804, 146.62018394470215, 148.216561794281, 149.81293964385986, 151.31020307540894, 152.807466506958, 154.39300727844238, 155.97854804992676, 157.4928092956543, 159.00707054138184, 160.81328654289246, 162.61950254440308, 164.14934635162354, 165.679190158844, 167.67353987693787, 169.66788959503174, 171.257581949234, 172.84727430343628, 174.44660997390747, 176.04594564437866, 177.661288022995, 179.27663040161133, 180.79450058937073, 182.31237077713013, 183.9619333744049, 185.6114959716797, 187.19888520240784, 188.786274433136, 190.28967905044556, 191.79308366775513, 193.41664791107178, 195.04021215438843, 196.78607988357544, 198.53194761276245, 200.17535138130188, 201.8187551498413, 203.68094968795776, 205.54314422607422, 207.12180829048157, 208.70047235488892, 210.31723833084106, 211.9340043067932, 213.58263969421387, 215.23127508163452, 216.71611046791077, 218.200945854187, 219.6806926727295, 221.16043949127197, 223.047425031662, 224.934410572052, 226.43097758293152, 227.92754459381104, 229.41164755821228, 230.89575052261353, 232.38259768486023, 233.86944484710693, 235.42209768295288, 236.97475051879883, 238.7195053100586, 240.46426010131836, 242.0248305797577, 243.58540105819702, 245.15346431732178, 246.72152757644653, 248.2278552055359, 249.73418283462524, 251.2570743560791, 252.77996587753296, 254.39548015594482, 256.0109944343567, 257.58365297317505, 259.1563115119934, 260.69600439071655, 262.2356972694397, 263.91402411460876, 265.59235095977783, 267.11139965057373, 268.63044834136963, 270.2421805858612, 271.8539128303528, 273.4405200481415, 275.0271272659302, 276.51305317878723, 277.9989790916443, 279.48579382896423, 280.9726085662842, 282.4306457042694, 283.88868284225464, 285.8894774913788, 287.89027214050293, 289.612398147583, 291.3345241546631, 292.8784062862396, 294.42228841781616, 295.9623477458954, 297.5024070739746, 299.11751413345337, 300.73262119293213, 302.2834417819977, 303.83426237106323, 305.92089223861694, 308.00752210617065, 309.8479347229004, 311.6883473396301, 313.9295892715454, 316.1708312034607, 318.13940620422363, 320.1079812049866, 322.3273231983185, 324.5466651916504, 326.59061312675476, 328.63456106185913, 331.913147687912, 335.19173431396484]
[53.44, 53.44, 58.98, 58.98, 58.14, 58.14, 62.48, 62.48, 64.24, 64.24, 64.16, 64.16, 64.56, 64.56, 64.94, 64.94, 66.06, 66.06, 67.48, 67.48, 66.66, 66.66, 67.04, 67.04, 67.64, 67.64, 67.26, 67.26, 68.54, 68.54, 68.04, 68.04, 67.34, 67.34, 67.58, 67.58, 68.06, 68.06, 68.2, 68.2, 68.4, 68.4, 69.12, 69.12, 69.64, 69.64, 71.0, 71.0, 70.36, 70.36, 70.12, 70.12, 70.32, 70.32, 71.34, 71.34, 70.62, 70.62, 70.46, 70.46, 70.22, 70.22, 70.02, 70.02, 71.14, 71.14, 71.32, 71.32, 71.14, 71.14, 70.96, 70.96, 71.38, 71.38, 71.26, 71.26, 71.7, 71.7, 72.42, 72.42, 72.16, 72.16, 71.86, 71.86, 70.9, 70.9, 71.28, 71.28, 72.06, 72.06, 71.96, 71.96, 71.0, 71.0, 71.24, 71.24, 71.9, 71.9, 71.74, 71.74, 71.96, 71.96, 72.48, 72.48, 72.18, 72.18, 72.6, 72.6, 72.78, 72.78, 72.76, 72.76, 72.68, 72.68, 72.58, 72.58, 72.46, 72.46, 71.86, 71.86, 72.4, 72.4, 72.2, 72.2, 72.6, 72.6, 72.6, 72.6, 72.76, 72.76, 72.64, 72.64, 72.32, 72.32, 72.08, 72.08, 72.18, 72.18, 72.02, 72.02, 71.86, 71.86, 72.12, 72.12, 71.98, 71.98, 72.56, 72.56, 72.1, 72.1, 72.3, 72.3, 71.38, 71.38, 71.64, 71.64, 71.26, 71.26, 71.0, 71.0, 71.3, 71.3, 71.46, 71.46, 71.68, 71.68, 71.38, 71.38, 71.8, 71.8, 71.76, 71.76, 71.78, 71.78, 71.66, 71.66, 71.9, 71.9, 72.0, 72.0, 71.6, 71.6, 72.36, 72.36, 72.28, 72.28, 72.92, 72.92, 73.04, 73.04, 73.18, 73.18, 72.74, 72.74, 71.76, 71.76, 72.32, 72.32, 72.22, 72.22, 73.02, 73.02]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.433, Test loss: 1.116, Test accuracy: 50.80
Round   0, Global train loss: 1.433, Global test loss: 1.113, Global test accuracy: 51.00
Round   1, Train loss: 1.175, Test loss: 0.998, Test accuracy: 57.46
Round   1, Global train loss: 1.175, Global test loss: 0.959, Global test accuracy: 60.20
Round   2, Train loss: 1.018, Test loss: 0.879, Test accuracy: 62.34
Round   2, Global train loss: 1.018, Global test loss: 0.806, Global test accuracy: 66.20
Round   3, Train loss: 0.900, Test loss: 0.836, Test accuracy: 63.12
Round   3, Global train loss: 0.900, Global test loss: 0.729, Global test accuracy: 67.40
Round   4, Train loss: 0.824, Test loss: 0.837, Test accuracy: 64.14
Round   4, Global train loss: 0.824, Global test loss: 0.712, Global test accuracy: 69.80
Round   5, Train loss: 0.798, Test loss: 0.783, Test accuracy: 66.30
Round   5, Global train loss: 0.798, Global test loss: 0.670, Global test accuracy: 71.20
Round   6, Train loss: 0.728, Test loss: 0.804, Test accuracy: 66.80
Round   6, Global train loss: 0.728, Global test loss: 0.708, Global test accuracy: 73.00
Round   7, Train loss: 0.738, Test loss: 0.748, Test accuracy: 69.72
Round   7, Global train loss: 0.738, Global test loss: 0.641, Global test accuracy: 74.40
Round   8, Train loss: 0.665, Test loss: 0.729, Test accuracy: 71.00
Round   8, Global train loss: 0.665, Global test loss: 0.644, Global test accuracy: 74.00
Round   9, Train loss: 0.636, Test loss: 0.690, Test accuracy: 72.44
Round   9, Global train loss: 0.636, Global test loss: 0.590, Global test accuracy: 74.80
Round  10, Train loss: 0.599, Test loss: 0.697, Test accuracy: 72.68
Round  10, Global train loss: 0.599, Global test loss: 0.622, Global test accuracy: 74.80
Round  11, Train loss: 0.564, Test loss: 0.714, Test accuracy: 72.36
Round  11, Global train loss: 0.564, Global test loss: 0.634, Global test accuracy: 75.00
Round  12, Train loss: 0.557, Test loss: 0.723, Test accuracy: 72.60
Round  12, Global train loss: 0.557, Global test loss: 0.600, Global test accuracy: 76.80
Round  13, Train loss: 0.575, Test loss: 0.714, Test accuracy: 72.42
Round  13, Global train loss: 0.575, Global test loss: 0.559, Global test accuracy: 76.40
Round  14, Train loss: 0.514, Test loss: 0.724, Test accuracy: 72.60
Round  14, Global train loss: 0.514, Global test loss: 0.609, Global test accuracy: 77.20
Round  15, Train loss: 0.557, Test loss: 0.683, Test accuracy: 74.48
Round  15, Global train loss: 0.557, Global test loss: 0.550, Global test accuracy: 78.80
Round  16, Train loss: 0.493, Test loss: 0.666, Test accuracy: 75.38
Round  16, Global train loss: 0.493, Global test loss: 0.563, Global test accuracy: 78.60
Round  17, Train loss: 0.506, Test loss: 0.665, Test accuracy: 75.98
Round  17, Global train loss: 0.506, Global test loss: 0.560, Global test accuracy: 78.60
Round  18, Train loss: 0.442, Test loss: 0.664, Test accuracy: 76.14
Round  18, Global train loss: 0.442, Global test loss: 0.587, Global test accuracy: 78.60
Round  19, Train loss: 0.410, Test loss: 0.695, Test accuracy: 75.42
Round  19, Global train loss: 0.410, Global test loss: 0.663, Global test accuracy: 76.80
Round  20, Train loss: 0.470, Test loss: 0.695, Test accuracy: 75.98
Round  20, Global train loss: 0.470, Global test loss: 0.555, Global test accuracy: 78.40
Round  21, Train loss: 0.380, Test loss: 0.680, Test accuracy: 76.34
Round  21, Global train loss: 0.380, Global test loss: 0.565, Global test accuracy: 80.80
Round  22, Train loss: 0.361, Test loss: 0.675, Test accuracy: 76.20
Round  22, Global train loss: 0.361, Global test loss: 0.568, Global test accuracy: 80.40
Round  23, Train loss: 0.336, Test loss: 0.695, Test accuracy: 76.00
Round  23, Global train loss: 0.336, Global test loss: 0.616, Global test accuracy: 78.20
Round  24, Train loss: 0.295, Test loss: 0.709, Test accuracy: 76.58
Round  24, Global train loss: 0.295, Global test loss: 0.623, Global test accuracy: 79.80
Round  25, Train loss: 0.272, Test loss: 0.720, Test accuracy: 76.12
Round  25, Global train loss: 0.272, Global test loss: 0.646, Global test accuracy: 79.00
Round  26, Train loss: 0.278, Test loss: 0.736, Test accuracy: 76.10
Round  26, Global train loss: 0.278, Global test loss: 0.666, Global test accuracy: 79.00
Round  27, Train loss: 0.271, Test loss: 0.741, Test accuracy: 75.92
Round  27, Global train loss: 0.271, Global test loss: 0.630, Global test accuracy: 80.40
Round  28, Train loss: 0.254, Test loss: 0.787, Test accuracy: 76.08
Round  28, Global train loss: 0.254, Global test loss: 0.675, Global test accuracy: 80.40
Round  29, Train loss: 0.369, Test loss: 0.762, Test accuracy: 76.26
Round  29, Global train loss: 0.369, Global test loss: 0.574, Global test accuracy: 79.80
Round  30, Train loss: 0.291, Test loss: 0.792, Test accuracy: 76.60
Round  30, Global train loss: 0.291, Global test loss: 0.591, Global test accuracy: 81.60
Round  31, Train loss: 0.317, Test loss: 0.777, Test accuracy: 77.08
Round  31, Global train loss: 0.317, Global test loss: 0.578, Global test accuracy: 82.20
Round  32, Train loss: 0.224, Test loss: 0.784, Test accuracy: 76.30
Round  32, Global train loss: 0.224, Global test loss: 0.674, Global test accuracy: 79.00
Round  33, Train loss: 0.198, Test loss: 0.794, Test accuracy: 76.48
Round  33, Global train loss: 0.198, Global test loss: 0.650, Global test accuracy: 81.00
Round  34, Train loss: 0.171, Test loss: 0.768, Test accuracy: 77.10
Round  34, Global train loss: 0.171, Global test loss: 0.685, Global test accuracy: 79.60
Round  35, Train loss: 0.223, Test loss: 0.806, Test accuracy: 77.68
Round  35, Global train loss: 0.223, Global test loss: 0.662, Global test accuracy: 79.20
Round  36, Train loss: 0.158, Test loss: 0.807, Test accuracy: 77.62
Round  36, Global train loss: 0.158, Global test loss: 0.715, Global test accuracy: 80.40
Round  37, Train loss: 0.253, Test loss: 0.818, Test accuracy: 77.80
Round  37, Global train loss: 0.253, Global test loss: 0.617, Global test accuracy: 82.20
Round  38, Train loss: 0.221, Test loss: 0.804, Test accuracy: 77.56
Round  38, Global train loss: 0.221, Global test loss: 0.624, Global test accuracy: 80.80
Round  39, Train loss: 0.162, Test loss: 0.810, Test accuracy: 77.82
Round  39, Global train loss: 0.162, Global test loss: 0.700, Global test accuracy: 80.60
Round  40, Train loss: 0.163, Test loss: 0.823, Test accuracy: 78.34
Round  40, Global train loss: 0.163, Global test loss: 0.702, Global test accuracy: 82.60
Round  41, Train loss: 0.197, Test loss: 0.829, Test accuracy: 78.14
Round  41, Global train loss: 0.197, Global test loss: 0.615, Global test accuracy: 82.00
Round  42, Train loss: 0.129, Test loss: 0.828, Test accuracy: 78.00
Round  42, Global train loss: 0.129, Global test loss: 0.709, Global test accuracy: 81.60
Round  43, Train loss: 0.143, Test loss: 0.874, Test accuracy: 77.62
Round  43, Global train loss: 0.143, Global test loss: 0.753, Global test accuracy: 80.00
Round  44, Train loss: 0.226, Test loss: 0.884, Test accuracy: 78.22
Round  44, Global train loss: 0.226, Global test loss: 0.653, Global test accuracy: 81.20
Round  45, Train loss: 0.156, Test loss: 0.876, Test accuracy: 78.90
Round  45, Global train loss: 0.156, Global test loss: 0.691, Global test accuracy: 81.80
Round  46, Train loss: 0.098, Test loss: 0.868, Test accuracy: 78.82
Round  46, Global train loss: 0.098, Global test loss: 0.801, Global test accuracy: 80.80
Round  47, Train loss: 0.180, Test loss: 0.852, Test accuracy: 79.20
Round  47, Global train loss: 0.180, Global test loss: 0.646, Global test accuracy: 81.80
Round  48, Train loss: 0.115, Test loss: 0.852, Test accuracy: 79.20
Round  48, Global train loss: 0.115, Global test loss: 0.786, Global test accuracy: 80.60
Round  49, Train loss: 0.186, Test loss: 0.861, Test accuracy: 79.38
Round  49, Global train loss: 0.186, Global test loss: 0.623, Global test accuracy: 83.40
Round  50, Train loss: 0.163, Test loss: 0.869, Test accuracy: 78.84
Round  50, Global train loss: 0.163, Global test loss: 0.666, Global test accuracy: 82.80
Round  51, Train loss: 0.131, Test loss: 0.881, Test accuracy: 78.88
Round  51, Global train loss: 0.131, Global test loss: 0.676, Global test accuracy: 83.80
Round  52, Train loss: 0.127, Test loss: 0.889, Test accuracy: 79.14
Round  52, Global train loss: 0.127, Global test loss: 0.677, Global test accuracy: 83.00
Round  53, Train loss: 0.087, Test loss: 0.895, Test accuracy: 79.22
Round  53, Global train loss: 0.087, Global test loss: 0.768, Global test accuracy: 82.60
Round  54, Train loss: 0.182, Test loss: 0.891, Test accuracy: 79.08
Round  54, Global train loss: 0.182, Global test loss: 0.656, Global test accuracy: 80.80
Round  55, Train loss: 0.069, Test loss: 0.886, Test accuracy: 79.06
Round  55, Global train loss: 0.069, Global test loss: 0.768, Global test accuracy: 81.20
Round  56, Train loss: 0.167, Test loss: 0.866, Test accuracy: 79.38
Round  56, Global train loss: 0.167, Global test loss: 0.637, Global test accuracy: 82.60
Round  57, Train loss: 0.054, Test loss: 0.881, Test accuracy: 79.48
Round  57, Global train loss: 0.054, Global test loss: 0.788, Global test accuracy: 82.00
Round  58, Train loss: 0.116, Test loss: 0.898, Test accuracy: 79.22
Round  58, Global train loss: 0.116, Global test loss: 0.756, Global test accuracy: 81.80
Round  59, Train loss: 0.072, Test loss: 0.918, Test accuracy: 79.30
Round  59, Global train loss: 0.072, Global test loss: 0.803, Global test accuracy: 82.80
Round  60, Train loss: 0.042, Test loss: 0.910, Test accuracy: 79.96
Round  60, Global train loss: 0.042, Global test loss: 0.889, Global test accuracy: 83.60
Round  61, Train loss: 0.065, Test loss: 0.937, Test accuracy: 79.54
Round  61, Global train loss: 0.065, Global test loss: 0.939, Global test accuracy: 80.40
Round  62, Train loss: 0.149, Test loss: 0.975, Test accuracy: 80.08
Round  62, Global train loss: 0.149, Global test loss: 0.730, Global test accuracy: 83.40
Round  63, Train loss: 0.086, Test loss: 0.967, Test accuracy: 80.10
Round  63, Global train loss: 0.086, Global test loss: 0.756, Global test accuracy: 81.60
Round  64, Train loss: 0.050, Test loss: 0.972, Test accuracy: 80.16
Round  64, Global train loss: 0.050, Global test loss: 0.783, Global test accuracy: 83.20
Round  65, Train loss: 0.057, Test loss: 1.015, Test accuracy: 80.00
Round  65, Global train loss: 0.057, Global test loss: 0.883, Global test accuracy: 82.20
Round  66, Train loss: 0.134, Test loss: 1.023, Test accuracy: 79.90
Round  66, Global train loss: 0.134, Global test loss: 0.726, Global test accuracy: 82.40
Round  67, Train loss: 0.074, Test loss: 0.997, Test accuracy: 80.06
Round  67, Global train loss: 0.074, Global test loss: 0.760, Global test accuracy: 82.40
Round  68, Train loss: 0.075, Test loss: 0.926, Test accuracy: 80.60
Round  68, Global train loss: 0.075, Global test loss: 0.786, Global test accuracy: 84.40
Round  69, Train loss: 0.073, Test loss: 0.940, Test accuracy: 80.78
Round  69, Global train loss: 0.073, Global test loss: 0.769, Global test accuracy: 83.80
Round  70, Train loss: 0.117, Test loss: 0.917, Test accuracy: 81.20
Round  70, Global train loss: 0.117, Global test loss: 0.660, Global test accuracy: 84.40
Round  71, Train loss: 0.063, Test loss: 0.868, Test accuracy: 81.94
Round  71, Global train loss: 0.063, Global test loss: 0.765, Global test accuracy: 84.80
Round  72, Train loss: 0.049, Test loss: 0.896, Test accuracy: 81.64
Round  72, Global train loss: 0.049, Global test loss: 0.826, Global test accuracy: 81.20
Round  73, Train loss: 0.066, Test loss: 0.887, Test accuracy: 81.46
Round  73, Global train loss: 0.066, Global test loss: 0.753, Global test accuracy: 81.60
Round  74, Train loss: 0.061, Test loss: 0.877, Test accuracy: 81.18
Round  74, Global train loss: 0.061, Global test loss: 0.732, Global test accuracy: 84.20
Round  75, Train loss: 0.041, Test loss: 0.895, Test accuracy: 81.22
Round  75, Global train loss: 0.041, Global test loss: 0.872, Global test accuracy: 82.40
Round  76, Train loss: 0.095, Test loss: 0.874, Test accuracy: 81.24
Round  76, Global train loss: 0.095, Global test loss: 0.701, Global test accuracy: 84.80
Round  77, Train loss: 0.066, Test loss: 0.920, Test accuracy: 81.18
Round  77, Global train loss: 0.066, Global test loss: 0.835, Global test accuracy: 81.80
Round  78, Train loss: 0.107, Test loss: 0.947, Test accuracy: 81.16
Round  78, Global train loss: 0.107, Global test loss: 0.708, Global test accuracy: 82.00
Round  79, Train loss: 0.037, Test loss: 0.950, Test accuracy: 81.02
Round  79, Global train loss: 0.037, Global test loss: 0.816, Global test accuracy: 84.00
Round  80, Train loss: 0.058, Test loss: 0.924, Test accuracy: 81.44
Round  80, Global train loss: 0.058, Global test loss: 0.840, Global test accuracy: 83.60
Round  81, Train loss: 0.087, Test loss: 0.958, Test accuracy: 81.54
Round  81, Global train loss: 0.087, Global test loss: 0.805, Global test accuracy: 85.00
Round  82, Train loss: 0.079, Test loss: 0.956, Test accuracy: 81.28
Round  82, Global train loss: 0.079, Global test loss: 0.762, Global test accuracy: 83.60
Round  83, Train loss: 0.082, Test loss: 0.969, Test accuracy: 81.36
Round  83, Global train loss: 0.082, Global test loss: 0.784, Global test accuracy: 82.60
Round  84, Train loss: 0.037, Test loss: 0.971, Test accuracy: 81.38
Round  84, Global train loss: 0.037, Global test loss: 0.813, Global test accuracy: 84.00
Round  85, Train loss: 0.041, Test loss: 0.951, Test accuracy: 81.26
Round  85, Global train loss: 0.041, Global test loss: 0.796, Global test accuracy: 83.80
Round  86, Train loss: 0.018, Test loss: 0.976, Test accuracy: 81.72
Round  86, Global train loss: 0.018, Global test loss: 0.949, Global test accuracy: 84.60
Round  87, Train loss: 0.039, Test loss: 1.030, Test accuracy: 81.32
Round  87, Global train loss: 0.039, Global test loss: 0.918, Global test accuracy: 82.40
Round  88, Train loss: 0.075, Test loss: 1.018, Test accuracy: 81.06
Round  88, Global train loss: 0.075, Global test loss: 0.836, Global test accuracy: 82.20
Round  89, Train loss: 0.028, Test loss: 1.000, Test accuracy: 81.30
Round  89, Global train loss: 0.028, Global test loss: 0.911, Global test accuracy: 82.00
Round  90, Train loss: 0.038, Test loss: 0.970, Test accuracy: 82.18
Round  90, Global train loss: 0.038, Global test loss: 0.878, Global test accuracy: 84.80
Round  91, Train loss: 0.027, Test loss: 0.978, Test accuracy: 82.06
Round  91, Global train loss: 0.027, Global test loss: 0.916, Global test accuracy: 83.20
Round  92, Train loss: 0.061, Test loss: 0.971, Test accuracy: 82.24
Round  92, Global train loss: 0.061, Global test loss: 0.832, Global test accuracy: 83.60
Round  93, Train loss: 0.083, Test loss: 0.985, Test accuracy: 81.84
Round  93, Global train loss: 0.083, Global test loss: 0.836, Global test accuracy: 83.00
Round  94, Train loss: 0.030, Test loss: 0.992, Test accuracy: 81.58
Round  94, Global train loss: 0.030, Global test loss: 0.863, Global test accuracy: 83.00
Round  95, Train loss: 0.076, Test loss: 0.967, Test accuracy: 82.26
Round  95, Global train loss: 0.076, Global test loss: 0.786, Global test accuracy: 83.60
Round  96, Train loss: 0.064, Test loss: 0.995, Test accuracy: 82.52
Round  96, Global train loss: 0.064, Global test loss: 0.841, Global test accuracy: 84.40
Round  97, Train loss: 0.037, Test loss: 0.992, Test accuracy: 82.14
Round  97, Global train loss: 0.037, Global test loss: 0.840, Global test accuracy: 83.20
Round  98, Train loss: 0.037, Test loss: 0.989, Test accuracy: 82.04
Round  98, Global train loss: 0.037, Global test loss: 0.846, Global test accuracy: 84.80
Round  99, Train loss: 0.043, Test loss: 0.991, Test accuracy: 81.92
Round  99, Global train loss: 0.043, Global test loss: 0.778, Global test accuracy: 84.00
Final Round, Train loss: 0.036, Test loss: 0.997, Test accuracy: 82.46
Final Round, Global train loss: 0.036, Global test loss: 0.778, Global test accuracy: 84.00
Average accuracy final 10 rounds: 82.078 

Average global accuracy final 10 rounds: 83.76 

1000.3539600372314
[2.062657594680786, 4.125315189361572, 5.783952951431274, 7.442590713500977, 9.148088455200195, 10.853586196899414, 12.41316270828247, 13.972739219665527, 15.483105182647705, 16.993471145629883, 18.530179262161255, 20.066887378692627, 21.72580099105835, 23.384714603424072, 25.106380462646484, 26.828046321868896, 28.497171640396118, 30.16629695892334, 31.74501872062683, 33.32374048233032, 34.85235404968262, 36.38096761703491, 37.89273166656494, 39.40449571609497, 41.01165533065796, 42.61881494522095, 44.37343192100525, 46.12804889678955, 47.600011587142944, 49.07197427749634, 50.594465255737305, 52.11695623397827, 53.7164306640625, 55.31590509414673, 56.820467710494995, 58.32503032684326, 59.83478927612305, 61.34454822540283, 62.88551425933838, 64.42648029327393, 65.93749260902405, 67.44850492477417, 68.95272374153137, 70.45694255828857, 72.10123825073242, 73.74553394317627, 75.27153706550598, 76.7975401878357, 78.30296635627747, 79.80839252471924, 81.28410053253174, 82.75980854034424, 84.27248096466064, 85.78515338897705, 87.28831219673157, 88.79147100448608, 90.28944706916809, 91.7874231338501, 93.37191867828369, 94.95641422271729, 96.67388725280762, 98.39136028289795, 100.15770888328552, 101.9240574836731, 103.47929954528809, 105.03454160690308, 106.59329748153687, 108.15205335617065, 109.59230256080627, 111.0325517654419, 112.49036240577698, 113.94817304611206, 115.47764468193054, 117.00711631774902, 118.55540657043457, 120.10369682312012, 121.65922284126282, 123.21474885940552, 124.72703289985657, 126.23931694030762, 128.16947984695435, 130.09964275360107, 132.25780725479126, 134.41597175598145, 136.1154067516327, 137.81484174728394, 139.4800136089325, 141.14518547058105, 142.7707061767578, 144.39622688293457, 145.8683888912201, 147.34055089950562, 148.84366536140442, 150.34677982330322, 152.01791310310364, 153.68904638290405, 155.22502183914185, 156.76099729537964, 158.60998344421387, 160.4589695930481, 161.93059849739075, 163.4022274017334, 164.9777090549469, 166.5531907081604, 168.3218584060669, 170.0905261039734, 171.97579979896545, 173.86107349395752, 175.87771081924438, 177.89434814453125, 179.62390661239624, 181.35346508026123, 183.00731015205383, 184.66115522384644, 186.29064083099365, 187.92012643814087, 189.4410421848297, 190.96195793151855, 192.7179458141327, 194.47393369674683, 196.07056283950806, 197.6671919822693, 199.50952053070068, 201.35184907913208, 202.9122598171234, 204.47267055511475, 206.2194013595581, 207.96613216400146, 209.37503147125244, 210.78393077850342, 212.2351667881012, 213.68640279769897, 215.15115809440613, 216.61591339111328, 218.26828265190125, 219.9206519126892, 221.45922708511353, 222.99780225753784, 224.69377422332764, 226.38974618911743, 227.81206488609314, 229.23438358306885, 230.83003401756287, 232.42568445205688, 233.92137837409973, 235.41707229614258, 236.88129234313965, 238.34551239013672, 239.92427229881287, 241.503032207489, 243.1273157596588, 244.7515993118286, 246.2583348751068, 247.765070438385, 249.3604109287262, 250.95575141906738, 252.56858110427856, 254.18141078948975, 255.71429800987244, 257.2471852302551, 258.7413489818573, 260.2355127334595, 261.74353313446045, 263.2515535354614, 264.69967770576477, 266.1478018760681, 267.59603118896484, 269.0442605018616, 270.4937856197357, 271.94331073760986, 273.4070107936859, 274.87071084976196, 276.3420777320862, 277.8134446144104, 279.28965640068054, 280.7658681869507, 282.150776386261, 283.5356845855713, 285.00610065460205, 286.4765167236328, 287.9352457523346, 289.3939747810364, 290.9525337219238, 292.5110926628113, 294.52429580688477, 296.53749895095825, 298.1393277645111, 299.74115657806396, 301.3608021736145, 302.98044776916504, 304.49622893333435, 306.01201009750366, 307.6765835285187, 309.3411569595337, 310.92250514030457, 312.50385332107544, 314.0767686367035, 315.64968395233154, 317.40915060043335, 319.16861724853516, 323.0149006843567, 326.8611841201782]
[50.8, 50.8, 57.46, 57.46, 62.34, 62.34, 63.12, 63.12, 64.14, 64.14, 66.3, 66.3, 66.8, 66.8, 69.72, 69.72, 71.0, 71.0, 72.44, 72.44, 72.68, 72.68, 72.36, 72.36, 72.6, 72.6, 72.42, 72.42, 72.6, 72.6, 74.48, 74.48, 75.38, 75.38, 75.98, 75.98, 76.14, 76.14, 75.42, 75.42, 75.98, 75.98, 76.34, 76.34, 76.2, 76.2, 76.0, 76.0, 76.58, 76.58, 76.12, 76.12, 76.1, 76.1, 75.92, 75.92, 76.08, 76.08, 76.26, 76.26, 76.6, 76.6, 77.08, 77.08, 76.3, 76.3, 76.48, 76.48, 77.1, 77.1, 77.68, 77.68, 77.62, 77.62, 77.8, 77.8, 77.56, 77.56, 77.82, 77.82, 78.34, 78.34, 78.14, 78.14, 78.0, 78.0, 77.62, 77.62, 78.22, 78.22, 78.9, 78.9, 78.82, 78.82, 79.2, 79.2, 79.2, 79.2, 79.38, 79.38, 78.84, 78.84, 78.88, 78.88, 79.14, 79.14, 79.22, 79.22, 79.08, 79.08, 79.06, 79.06, 79.38, 79.38, 79.48, 79.48, 79.22, 79.22, 79.3, 79.3, 79.96, 79.96, 79.54, 79.54, 80.08, 80.08, 80.1, 80.1, 80.16, 80.16, 80.0, 80.0, 79.9, 79.9, 80.06, 80.06, 80.6, 80.6, 80.78, 80.78, 81.2, 81.2, 81.94, 81.94, 81.64, 81.64, 81.46, 81.46, 81.18, 81.18, 81.22, 81.22, 81.24, 81.24, 81.18, 81.18, 81.16, 81.16, 81.02, 81.02, 81.44, 81.44, 81.54, 81.54, 81.28, 81.28, 81.36, 81.36, 81.38, 81.38, 81.26, 81.26, 81.72, 81.72, 81.32, 81.32, 81.06, 81.06, 81.3, 81.3, 82.18, 82.18, 82.06, 82.06, 82.24, 82.24, 81.84, 81.84, 81.58, 81.58, 82.26, 82.26, 82.52, 82.52, 82.14, 82.14, 82.04, 82.04, 81.92, 81.92, 82.46, 82.46]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.414, Test loss: 1.124, Test accuracy: 52.88
Round   0, Global train loss: 1.414, Global test loss: 1.125, Global test accuracy: 53.40
Round   1, Train loss: 1.168, Test loss: 0.995, Test accuracy: 57.96
Round   1, Global train loss: 1.168, Global test loss: 0.932, Global test accuracy: 60.60
Round   2, Train loss: 1.037, Test loss: 0.940, Test accuracy: 60.74
Round   2, Global train loss: 1.037, Global test loss: 0.861, Global test accuracy: 63.60
Round   3, Train loss: 0.942, Test loss: 0.904, Test accuracy: 61.40
Round   3, Global train loss: 0.942, Global test loss: 0.759, Global test accuracy: 65.40
Round   4, Train loss: 0.892, Test loss: 0.868, Test accuracy: 63.74
Round   4, Global train loss: 0.892, Global test loss: 0.745, Global test accuracy: 70.40
Round   5, Train loss: 0.813, Test loss: 0.793, Test accuracy: 66.90
Round   5, Global train loss: 0.813, Global test loss: 0.689, Global test accuracy: 70.20
Round   6, Train loss: 0.771, Test loss: 0.808, Test accuracy: 67.08
Round   6, Global train loss: 0.771, Global test loss: 0.685, Global test accuracy: 73.20
Round   7, Train loss: 0.741, Test loss: 0.796, Test accuracy: 67.94
Round   7, Global train loss: 0.741, Global test loss: 0.661, Global test accuracy: 72.60
Round   8, Train loss: 0.702, Test loss: 0.788, Test accuracy: 68.80
Round   8, Global train loss: 0.702, Global test loss: 0.664, Global test accuracy: 73.60
Round   9, Train loss: 0.665, Test loss: 0.740, Test accuracy: 70.32
Round   9, Global train loss: 0.665, Global test loss: 0.633, Global test accuracy: 74.00
Round  10, Train loss: 0.644, Test loss: 0.743, Test accuracy: 70.14
Round  10, Global train loss: 0.644, Global test loss: 0.619, Global test accuracy: 74.60
Round  11, Train loss: 0.659, Test loss: 0.709, Test accuracy: 71.64
Round  11, Global train loss: 0.659, Global test loss: 0.609, Global test accuracy: 75.80
Round  12, Train loss: 0.646, Test loss: 0.708, Test accuracy: 71.58
Round  12, Global train loss: 0.646, Global test loss: 0.576, Global test accuracy: 77.20
Round  13, Train loss: 0.570, Test loss: 0.698, Test accuracy: 71.82
Round  13, Global train loss: 0.570, Global test loss: 0.601, Global test accuracy: 75.00
Round  14, Train loss: 0.550, Test loss: 0.702, Test accuracy: 71.96
Round  14, Global train loss: 0.550, Global test loss: 0.601, Global test accuracy: 76.60
Round  15, Train loss: 0.530, Test loss: 0.720, Test accuracy: 72.08
Round  15, Global train loss: 0.530, Global test loss: 0.640, Global test accuracy: 75.00
Round  16, Train loss: 0.555, Test loss: 0.717, Test accuracy: 72.74
Round  16, Global train loss: 0.555, Global test loss: 0.600, Global test accuracy: 77.80
Round  17, Train loss: 0.500, Test loss: 0.704, Test accuracy: 73.14
Round  17, Global train loss: 0.500, Global test loss: 0.604, Global test accuracy: 75.80
Round  18, Train loss: 0.486, Test loss: 0.671, Test accuracy: 74.16
Round  18, Global train loss: 0.486, Global test loss: 0.567, Global test accuracy: 78.60
Round  19, Train loss: 0.463, Test loss: 0.693, Test accuracy: 73.60
Round  19, Global train loss: 0.463, Global test loss: 0.596, Global test accuracy: 76.40
Round  20, Train loss: 0.515, Test loss: 0.690, Test accuracy: 73.88
Round  20, Global train loss: 0.515, Global test loss: 0.559, Global test accuracy: 77.00
Round  21, Train loss: 0.499, Test loss: 0.672, Test accuracy: 75.34
Round  21, Global train loss: 0.499, Global test loss: 0.521, Global test accuracy: 80.60
Round  22, Train loss: 0.479, Test loss: 0.665, Test accuracy: 75.32
Round  22, Global train loss: 0.479, Global test loss: 0.528, Global test accuracy: 79.20
Round  23, Train loss: 0.403, Test loss: 0.703, Test accuracy: 74.78
Round  23, Global train loss: 0.403, Global test loss: 0.568, Global test accuracy: 78.60
Round  24, Train loss: 0.445, Test loss: 0.657, Test accuracy: 76.26
Round  24, Global train loss: 0.445, Global test loss: 0.540, Global test accuracy: 79.40
Round  25, Train loss: 0.427, Test loss: 0.661, Test accuracy: 76.58
Round  25, Global train loss: 0.427, Global test loss: 0.558, Global test accuracy: 79.40
Round  26, Train loss: 0.337, Test loss: 0.635, Test accuracy: 77.66
Round  26, Global train loss: 0.337, Global test loss: 0.587, Global test accuracy: 79.20
Round  27, Train loss: 0.433, Test loss: 0.651, Test accuracy: 77.24
Round  27, Global train loss: 0.433, Global test loss: 0.531, Global test accuracy: 81.00
Round  28, Train loss: 0.381, Test loss: 0.644, Test accuracy: 77.34
Round  28, Global train loss: 0.381, Global test loss: 0.548, Global test accuracy: 78.00
Round  29, Train loss: 0.329, Test loss: 0.669, Test accuracy: 77.28
Round  29, Global train loss: 0.329, Global test loss: 0.607, Global test accuracy: 79.80
Round  30, Train loss: 0.354, Test loss: 0.722, Test accuracy: 76.72
Round  30, Global train loss: 0.354, Global test loss: 0.581, Global test accuracy: 79.40
Round  31, Train loss: 0.344, Test loss: 0.683, Test accuracy: 78.10
Round  31, Global train loss: 0.344, Global test loss: 0.530, Global test accuracy: 82.00
Round  32, Train loss: 0.357, Test loss: 0.688, Test accuracy: 77.82
Round  32, Global train loss: 0.357, Global test loss: 0.548, Global test accuracy: 80.40
Round  33, Train loss: 0.251, Test loss: 0.706, Test accuracy: 77.54
Round  33, Global train loss: 0.251, Global test loss: 0.602, Global test accuracy: 79.60
Round  34, Train loss: 0.339, Test loss: 0.698, Test accuracy: 77.90
Round  34, Global train loss: 0.339, Global test loss: 0.532, Global test accuracy: 81.60
Round  35, Train loss: 0.241, Test loss: 0.690, Test accuracy: 78.52
Round  35, Global train loss: 0.241, Global test loss: 0.594, Global test accuracy: 80.00
Round  36, Train loss: 0.302, Test loss: 0.712, Test accuracy: 78.14
Round  36, Global train loss: 0.302, Global test loss: 0.550, Global test accuracy: 81.20
Round  37, Train loss: 0.222, Test loss: 0.690, Test accuracy: 78.68
Round  37, Global train loss: 0.222, Global test loss: 0.602, Global test accuracy: 81.60
Round  38, Train loss: 0.237, Test loss: 0.696, Test accuracy: 78.56
Round  38, Global train loss: 0.237, Global test loss: 0.590, Global test accuracy: 81.20
Round  39, Train loss: 0.293, Test loss: 0.707, Test accuracy: 78.16
Round  39, Global train loss: 0.293, Global test loss: 0.553, Global test accuracy: 80.00
Round  40, Train loss: 0.243, Test loss: 0.696, Test accuracy: 78.48
Round  40, Global train loss: 0.243, Global test loss: 0.585, Global test accuracy: 80.60
Round  41, Train loss: 0.223, Test loss: 0.690, Test accuracy: 78.82
Round  41, Global train loss: 0.223, Global test loss: 0.589, Global test accuracy: 81.20
Round  42, Train loss: 0.230, Test loss: 0.706, Test accuracy: 79.14
Round  42, Global train loss: 0.230, Global test loss: 0.621, Global test accuracy: 81.80
Round  43, Train loss: 0.271, Test loss: 0.734, Test accuracy: 78.90
Round  43, Global train loss: 0.271, Global test loss: 0.560, Global test accuracy: 82.20
Round  44, Train loss: 0.189, Test loss: 0.730, Test accuracy: 79.00
Round  44, Global train loss: 0.189, Global test loss: 0.597, Global test accuracy: 81.00
Round  45, Train loss: 0.161, Test loss: 0.742, Test accuracy: 79.14
Round  45, Global train loss: 0.161, Global test loss: 0.691, Global test accuracy: 79.20
Round  46, Train loss: 0.231, Test loss: 0.764, Test accuracy: 79.10
Round  46, Global train loss: 0.231, Global test loss: 0.632, Global test accuracy: 81.60
Round  47, Train loss: 0.155, Test loss: 0.780, Test accuracy: 79.06
Round  47, Global train loss: 0.155, Global test loss: 0.673, Global test accuracy: 81.40
Round  48, Train loss: 0.233, Test loss: 0.778, Test accuracy: 79.10
Round  48, Global train loss: 0.233, Global test loss: 0.570, Global test accuracy: 82.60
Round  49, Train loss: 0.126, Test loss: 0.812, Test accuracy: 78.86
Round  49, Global train loss: 0.126, Global test loss: 0.694, Global test accuracy: 80.80
Round  50, Train loss: 0.135, Test loss: 0.809, Test accuracy: 79.48
Round  50, Global train loss: 0.135, Global test loss: 0.743, Global test accuracy: 81.80
Round  51, Train loss: 0.207, Test loss: 0.825, Test accuracy: 79.34
Round  51, Global train loss: 0.207, Global test loss: 0.650, Global test accuracy: 81.80
Round  52, Train loss: 0.123, Test loss: 0.819, Test accuracy: 79.84
Round  52, Global train loss: 0.123, Global test loss: 0.676, Global test accuracy: 81.80
Round  53, Train loss: 0.139, Test loss: 0.821, Test accuracy: 79.76
Round  53, Global train loss: 0.139, Global test loss: 0.660, Global test accuracy: 81.20
Round  54, Train loss: 0.148, Test loss: 0.795, Test accuracy: 79.74
Round  54, Global train loss: 0.148, Global test loss: 0.697, Global test accuracy: 82.40
Round  55, Train loss: 0.098, Test loss: 0.796, Test accuracy: 79.74
Round  55, Global train loss: 0.098, Global test loss: 0.702, Global test accuracy: 81.60
Round  56, Train loss: 0.125, Test loss: 0.856, Test accuracy: 79.28
Round  56, Global train loss: 0.125, Global test loss: 0.696, Global test accuracy: 81.40
Round  57, Train loss: 0.095, Test loss: 0.885, Test accuracy: 78.62
Round  57, Global train loss: 0.095, Global test loss: 0.813, Global test accuracy: 79.80
Round  58, Train loss: 0.114, Test loss: 0.849, Test accuracy: 78.76
Round  58, Global train loss: 0.114, Global test loss: 0.715, Global test accuracy: 80.00
Round  59, Train loss: 0.097, Test loss: 0.884, Test accuracy: 78.38
Round  59, Global train loss: 0.097, Global test loss: 0.759, Global test accuracy: 81.60
Round  60, Train loss: 0.087, Test loss: 0.881, Test accuracy: 78.30
Round  60, Global train loss: 0.087, Global test loss: 0.726, Global test accuracy: 82.40
Round  61, Train loss: 0.144, Test loss: 0.885, Test accuracy: 78.42
Round  61, Global train loss: 0.144, Global test loss: 0.724, Global test accuracy: 80.40
Round  62, Train loss: 0.058, Test loss: 0.872, Test accuracy: 78.96
Round  62, Global train loss: 0.058, Global test loss: 0.847, Global test accuracy: 81.20
Round  63, Train loss: 0.123, Test loss: 0.873, Test accuracy: 79.38
Round  63, Global train loss: 0.123, Global test loss: 0.768, Global test accuracy: 80.60
Round  64, Train loss: 0.082, Test loss: 0.897, Test accuracy: 79.14
Round  64, Global train loss: 0.082, Global test loss: 0.749, Global test accuracy: 81.60
Round  65, Train loss: 0.107, Test loss: 0.928, Test accuracy: 79.38
Round  65, Global train loss: 0.107, Global test loss: 0.698, Global test accuracy: 83.20
Round  66, Train loss: 0.060, Test loss: 0.913, Test accuracy: 80.06
Round  66, Global train loss: 0.060, Global test loss: 0.774, Global test accuracy: 81.80
Round  67, Train loss: 0.112, Test loss: 0.879, Test accuracy: 80.72
Round  67, Global train loss: 0.112, Global test loss: 0.716, Global test accuracy: 81.20
Round  68, Train loss: 0.090, Test loss: 0.842, Test accuracy: 80.84
Round  68, Global train loss: 0.090, Global test loss: 0.748, Global test accuracy: 81.40
Round  69, Train loss: 0.145, Test loss: 0.860, Test accuracy: 80.62
Round  69, Global train loss: 0.145, Global test loss: 0.668, Global test accuracy: 82.80
Round  70, Train loss: 0.088, Test loss: 0.862, Test accuracy: 80.78
Round  70, Global train loss: 0.088, Global test loss: 0.705, Global test accuracy: 82.40
Round  71, Train loss: 0.040, Test loss: 0.842, Test accuracy: 80.90
Round  71, Global train loss: 0.040, Global test loss: 0.821, Global test accuracy: 81.00
Round  72, Train loss: 0.046, Test loss: 0.862, Test accuracy: 80.72
Round  72, Global train loss: 0.046, Global test loss: 0.798, Global test accuracy: 82.00
Round  73, Train loss: 0.134, Test loss: 0.897, Test accuracy: 80.34
Round  73, Global train loss: 0.134, Global test loss: 0.728, Global test accuracy: 81.60
Round  74, Train loss: 0.058, Test loss: 0.886, Test accuracy: 80.34
Round  74, Global train loss: 0.058, Global test loss: 0.822, Global test accuracy: 82.00
Round  75, Train loss: 0.139, Test loss: 0.890, Test accuracy: 80.30
Round  75, Global train loss: 0.139, Global test loss: 0.700, Global test accuracy: 82.00
Round  76, Train loss: 0.078, Test loss: 0.868, Test accuracy: 80.30
Round  76, Global train loss: 0.078, Global test loss: 0.734, Global test accuracy: 81.80
Round  77, Train loss: 0.058, Test loss: 0.893, Test accuracy: 80.02
Round  77, Global train loss: 0.058, Global test loss: 0.781, Global test accuracy: 81.80
Round  78, Train loss: 0.081, Test loss: 0.894, Test accuracy: 80.10
Round  78, Global train loss: 0.081, Global test loss: 0.775, Global test accuracy: 81.40
Round  79, Train loss: 0.116, Test loss: 0.875, Test accuracy: 80.24
Round  79, Global train loss: 0.116, Global test loss: 0.696, Global test accuracy: 81.40
Round  80, Train loss: 0.069, Test loss: 0.860, Test accuracy: 80.28
Round  80, Global train loss: 0.069, Global test loss: 0.777, Global test accuracy: 82.20
Round  81, Train loss: 0.064, Test loss: 0.876, Test accuracy: 80.26
Round  81, Global train loss: 0.064, Global test loss: 0.732, Global test accuracy: 82.80
Round  82, Train loss: 0.096, Test loss: 0.867, Test accuracy: 80.44
Round  82, Global train loss: 0.096, Global test loss: 0.685, Global test accuracy: 83.80
Round  83, Train loss: 0.051, Test loss: 0.865, Test accuracy: 80.48
Round  83, Global train loss: 0.051, Global test loss: 0.806, Global test accuracy: 81.80
Round  84, Train loss: 0.046, Test loss: 0.880, Test accuracy: 80.48
Round  84, Global train loss: 0.046, Global test loss: 0.825, Global test accuracy: 82.20
Round  85, Train loss: 0.060, Test loss: 0.909, Test accuracy: 80.48
Round  85, Global train loss: 0.060, Global test loss: 0.793, Global test accuracy: 82.20
Round  86, Train loss: 0.041, Test loss: 0.907, Test accuracy: 80.64
Round  86, Global train loss: 0.041, Global test loss: 0.878, Global test accuracy: 82.20
Round  87, Train loss: 0.084, Test loss: 0.918, Test accuracy: 80.48
Round  87, Global train loss: 0.084, Global test loss: 0.773, Global test accuracy: 82.20
Round  88, Train loss: 0.063, Test loss: 0.889, Test accuracy: 81.12
Round  88, Global train loss: 0.063, Global test loss: 0.774, Global test accuracy: 83.60
Round  89, Train loss: 0.033, Test loss: 0.906, Test accuracy: 80.98
Round  89, Global train loss: 0.033, Global test loss: 0.851, Global test accuracy: 82.40
Round  90, Train loss: 0.081, Test loss: 0.905, Test accuracy: 80.40
Round  90, Global train loss: 0.081, Global test loss: 0.774, Global test accuracy: 81.40
Round  91, Train loss: 0.037, Test loss: 0.906, Test accuracy: 79.80
Round  91, Global train loss: 0.037, Global test loss: 0.792, Global test accuracy: 82.20
Round  92, Train loss: 0.064, Test loss: 0.916, Test accuracy: 79.96
Round  92, Global train loss: 0.064, Global test loss: 0.767, Global test accuracy: 82.80
Round  93, Train loss: 0.063, Test loss: 0.892, Test accuracy: 80.34
Round  93, Global train loss: 0.063, Global test loss: 0.758, Global test accuracy: 82.60
Round  94, Train loss: 0.046, Test loss: 0.894, Test accuracy: 80.70
Round  94, Global train loss: 0.046, Global test loss: 0.785, Global test accuracy: 80.80
Round  95, Train loss: 0.049, Test loss: 0.894, Test accuracy: 80.74
Round  95, Global train loss: 0.049, Global test loss: 0.816, Global test accuracy: 82.60/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 0.116, Test loss: 0.896, Test accuracy: 81.26
Round  96, Global train loss: 0.116, Global test loss: 0.722, Global test accuracy: 82.80
Round  97, Train loss: 0.025, Test loss: 0.891, Test accuracy: 81.46
Round  97, Global train loss: 0.025, Global test loss: 0.804, Global test accuracy: 82.00
Round  98, Train loss: 0.023, Test loss: 0.890, Test accuracy: 81.92
Round  98, Global train loss: 0.023, Global test loss: 0.892, Global test accuracy: 82.80
Round  99, Train loss: 0.083, Test loss: 0.900, Test accuracy: 81.86
Round  99, Global train loss: 0.083, Global test loss: 0.752, Global test accuracy: 82.20
Final Round, Train loss: 0.048, Test loss: 0.925, Test accuracy: 80.66
Final Round, Global train loss: 0.048, Global test loss: 0.752, Global test accuracy: 82.20
Average accuracy final 10 rounds: 80.844 

Average global accuracy final 10 rounds: 82.22 

1061.4229543209076
[1.9725704193115234, 3.945140838623047, 5.544729471206665, 7.144318103790283, 8.870974063873291, 10.597630023956299, 12.268010377883911, 13.938390731811523, 15.551802158355713, 17.165213584899902, 19.129084587097168, 21.092955589294434, 22.776557683944702, 24.46015977859497, 26.338314294815063, 28.216468811035156, 29.854804277420044, 31.49313974380493, 33.27539658546448, 35.05765342712402, 36.74363040924072, 38.42960739135742, 39.97413182258606, 41.5186562538147, 43.119560956954956, 44.720465660095215, 46.347623109817505, 47.974780559539795, 49.753742933273315, 51.532705307006836, 53.18367600440979, 54.834646701812744, 56.52267837524414, 58.21071004867554, 59.88123440742493, 61.551758766174316, 63.25011229515076, 64.9484658241272, 66.83333253860474, 68.71819925308228, 70.55080151557922, 72.38340377807617, 74.52391219139099, 76.66442060470581, 78.81941819190979, 80.97441577911377, 83.02108883857727, 85.06776189804077, 87.05541181564331, 89.04306173324585, 90.76886487007141, 92.49466800689697, 94.79862856864929, 97.10258913040161, 99.29005479812622, 101.47752046585083, 103.49989867210388, 105.52227687835693, 107.11282587051392, 108.7033748626709, 110.36591792106628, 112.02846097946167, 113.67443203926086, 115.32040309906006, 117.02279019355774, 118.72517728805542, 120.40535140037537, 122.08552551269531, 123.71977758407593, 125.35402965545654, 127.11447429656982, 128.8749189376831, 130.46450901031494, 132.05409908294678, 133.62958931922913, 135.20507955551147, 136.92881631851196, 138.65255308151245, 140.3305070400238, 142.00846099853516, 143.74257707595825, 145.47669315338135, 147.14518451690674, 148.81367588043213, 150.92644953727722, 153.03922319412231, 155.02572321891785, 157.01222324371338, 159.20995211601257, 161.40768098831177, 163.13743114471436, 164.86718130111694, 166.57597637176514, 168.28477144241333, 169.96592235565186, 171.64707326889038, 173.56723165512085, 175.48739004135132, 177.40810203552246, 179.3288140296936, 181.24546003341675, 183.1621060371399, 184.98420310020447, 186.80630016326904, 188.49195885658264, 190.17761754989624, 191.93283128738403, 193.68804502487183, 195.92548394203186, 198.1629228591919, 200.08478713035583, 202.00665140151978, 203.71046805381775, 205.41428470611572, 207.08049035072327, 208.7466959953308, 210.39456009864807, 212.04242420196533, 213.6340217590332, 215.22561931610107, 217.0078296661377, 218.79004001617432, 220.4981026649475, 222.2061653137207, 223.9231150150299, 225.6400647163391, 227.3272111415863, 229.0143575668335, 230.8261158466339, 232.63787412643433, 234.28440928459167, 235.93094444274902, 238.07445883750916, 240.2179732322693, 242.46963024139404, 244.7212872505188, 246.34624123573303, 247.97119522094727, 249.83927392959595, 251.70735263824463, 253.36431694030762, 255.0212812423706, 256.7666687965393, 258.512056350708, 260.14472341537476, 261.7773904800415, 263.4869282245636, 265.1964659690857, 266.85843229293823, 268.52039861679077, 270.3856818675995, 272.2509651184082, 274.14797139167786, 276.0449776649475, 277.91948914527893, 279.79400062561035, 281.5779700279236, 283.3619394302368, 285.16132616996765, 286.9607129096985, 288.5785119533539, 290.1963109970093, 291.99527406692505, 293.7942371368408, 295.6428689956665, 297.4915008544922, 299.1921422481537, 300.8927836418152, 302.6277914047241, 304.36279916763306, 306.03666734695435, 307.71053552627563, 309.450963973999, 311.1913924217224, 312.83957624435425, 314.4877600669861, 316.3720145225525, 318.2562689781189, 320.0136241912842, 321.77097940444946, 323.44392824172974, 325.11687707901, 326.9549136161804, 328.79295015335083, 330.6354606151581, 332.47797107696533, 334.1354892253876, 335.7930073738098, 337.4610810279846, 339.1291546821594, 340.8340117931366, 342.53886890411377, 344.3647449016571, 346.19062089920044, 347.8756718635559, 349.5607228279114, 351.3059482574463, 353.0511736869812, 354.7120327949524, 356.3728919029236, 359.9293761253357, 363.4858603477478]
[52.88, 52.88, 57.96, 57.96, 60.74, 60.74, 61.4, 61.4, 63.74, 63.74, 66.9, 66.9, 67.08, 67.08, 67.94, 67.94, 68.8, 68.8, 70.32, 70.32, 70.14, 70.14, 71.64, 71.64, 71.58, 71.58, 71.82, 71.82, 71.96, 71.96, 72.08, 72.08, 72.74, 72.74, 73.14, 73.14, 74.16, 74.16, 73.6, 73.6, 73.88, 73.88, 75.34, 75.34, 75.32, 75.32, 74.78, 74.78, 76.26, 76.26, 76.58, 76.58, 77.66, 77.66, 77.24, 77.24, 77.34, 77.34, 77.28, 77.28, 76.72, 76.72, 78.1, 78.1, 77.82, 77.82, 77.54, 77.54, 77.9, 77.9, 78.52, 78.52, 78.14, 78.14, 78.68, 78.68, 78.56, 78.56, 78.16, 78.16, 78.48, 78.48, 78.82, 78.82, 79.14, 79.14, 78.9, 78.9, 79.0, 79.0, 79.14, 79.14, 79.1, 79.1, 79.06, 79.06, 79.1, 79.1, 78.86, 78.86, 79.48, 79.48, 79.34, 79.34, 79.84, 79.84, 79.76, 79.76, 79.74, 79.74, 79.74, 79.74, 79.28, 79.28, 78.62, 78.62, 78.76, 78.76, 78.38, 78.38, 78.3, 78.3, 78.42, 78.42, 78.96, 78.96, 79.38, 79.38, 79.14, 79.14, 79.38, 79.38, 80.06, 80.06, 80.72, 80.72, 80.84, 80.84, 80.62, 80.62, 80.78, 80.78, 80.9, 80.9, 80.72, 80.72, 80.34, 80.34, 80.34, 80.34, 80.3, 80.3, 80.3, 80.3, 80.02, 80.02, 80.1, 80.1, 80.24, 80.24, 80.28, 80.28, 80.26, 80.26, 80.44, 80.44, 80.48, 80.48, 80.48, 80.48, 80.48, 80.48, 80.64, 80.64, 80.48, 80.48, 81.12, 81.12, 80.98, 80.98, 80.4, 80.4, 79.8, 79.8, 79.96, 79.96, 80.34, 80.34, 80.7, 80.7, 80.74, 80.74, 81.26, 81.26, 81.46, 81.46, 81.92, 81.92, 81.86, 81.86, 80.66, 80.66]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.452, Test loss: 1.161, Test accuracy: 53.82
Round   0, Global train loss: 1.452, Global test loss: 1.162, Global test accuracy: 55.00
Round   1, Train loss: 1.183, Test loss: 0.987, Test accuracy: 56.28
Round   1, Global train loss: 1.183, Global test loss: 0.926, Global test accuracy: 57.60
Round   2, Train loss: 1.025, Test loss: 0.955, Test accuracy: 59.48
Round   2, Global train loss: 1.025, Global test loss: 0.850, Global test accuracy: 63.80
Round   3, Train loss: 0.932, Test loss: 0.899, Test accuracy: 62.00
Round   3, Global train loss: 0.932, Global test loss: 0.747, Global test accuracy: 67.20
Round   4, Train loss: 0.840, Test loss: 0.873, Test accuracy: 63.70
Round   4, Global train loss: 0.840, Global test loss: 0.774, Global test accuracy: 65.20
Round   5, Train loss: 0.812, Test loss: 0.878, Test accuracy: 63.90
Round   5, Global train loss: 0.812, Global test loss: 0.754, Global test accuracy: 68.20
Round   6, Train loss: 0.747, Test loss: 0.885, Test accuracy: 64.14
Round   6, Global train loss: 0.747, Global test loss: 0.729, Global test accuracy: 68.60
Round   7, Train loss: 0.740, Test loss: 0.840, Test accuracy: 66.28
Round   7, Global train loss: 0.740, Global test loss: 0.641, Global test accuracy: 74.40
Round   8, Train loss: 0.684, Test loss: 0.808, Test accuracy: 67.72
Round   8, Global train loss: 0.684, Global test loss: 0.658, Global test accuracy: 74.20
Round   9, Train loss: 0.661, Test loss: 0.830, Test accuracy: 67.98
Round   9, Global train loss: 0.661, Global test loss: 0.749, Global test accuracy: 69.00
Round  10, Train loss: 0.582, Test loss: 0.782, Test accuracy: 69.58
Round  10, Global train loss: 0.582, Global test loss: 0.660, Global test accuracy: 73.60
Round  11, Train loss: 0.570, Test loss: 0.776, Test accuracy: 69.98
Round  11, Global train loss: 0.570, Global test loss: 0.631, Global test accuracy: 73.40
Round  12, Train loss: 0.587, Test loss: 0.760, Test accuracy: 70.40
Round  12, Global train loss: 0.587, Global test loss: 0.621, Global test accuracy: 74.00
Round  13, Train loss: 0.561, Test loss: 0.753, Test accuracy: 71.02
Round  13, Global train loss: 0.561, Global test loss: 0.596, Global test accuracy: 76.20
Round  14, Train loss: 0.522, Test loss: 0.751, Test accuracy: 71.36
Round  14, Global train loss: 0.522, Global test loss: 0.598, Global test accuracy: 75.80
Round  15, Train loss: 0.497, Test loss: 0.715, Test accuracy: 72.74
Round  15, Global train loss: 0.497, Global test loss: 0.590, Global test accuracy: 77.00
Round  16, Train loss: 0.448, Test loss: 0.719, Test accuracy: 73.00
Round  16, Global train loss: 0.448, Global test loss: 0.644, Global test accuracy: 75.20
Round  17, Train loss: 0.448, Test loss: 0.713, Test accuracy: 73.32
Round  17, Global train loss: 0.448, Global test loss: 0.611, Global test accuracy: 75.80
Round  18, Train loss: 0.473, Test loss: 0.717, Test accuracy: 73.34
Round  18, Global train loss: 0.473, Global test loss: 0.585, Global test accuracy: 77.20
Round  19, Train loss: 0.430, Test loss: 0.720, Test accuracy: 73.72
Round  19, Global train loss: 0.430, Global test loss: 0.612, Global test accuracy: 77.60
Round  20, Train loss: 0.383, Test loss: 0.719, Test accuracy: 74.20
Round  20, Global train loss: 0.383, Global test loss: 0.639, Global test accuracy: 76.40
Round  21, Train loss: 0.432, Test loss: 0.707, Test accuracy: 75.00
Round  21, Global train loss: 0.432, Global test loss: 0.561, Global test accuracy: 79.20
Round  22, Train loss: 0.355, Test loss: 0.745, Test accuracy: 74.38
Round  22, Global train loss: 0.355, Global test loss: 0.689, Global test accuracy: 77.40
Round  23, Train loss: 0.374, Test loss: 0.729, Test accuracy: 74.90
Round  23, Global train loss: 0.374, Global test loss: 0.573, Global test accuracy: 78.80
Round  24, Train loss: 0.389, Test loss: 0.744, Test accuracy: 74.80
Round  24, Global train loss: 0.389, Global test loss: 0.582, Global test accuracy: 77.20
Round  25, Train loss: 0.357, Test loss: 0.771, Test accuracy: 74.38
Round  25, Global train loss: 0.357, Global test loss: 0.577, Global test accuracy: 80.20
Round  26, Train loss: 0.304, Test loss: 0.788, Test accuracy: 74.46
Round  26, Global train loss: 0.304, Global test loss: 0.648, Global test accuracy: 78.80
Round  27, Train loss: 0.367, Test loss: 0.779, Test accuracy: 74.84
Round  27, Global train loss: 0.367, Global test loss: 0.556, Global test accuracy: 80.60
Round  28, Train loss: 0.321, Test loss: 0.765, Test accuracy: 75.48
Round  28, Global train loss: 0.321, Global test loss: 0.619, Global test accuracy: 80.40
Round  29, Train loss: 0.268, Test loss: 0.786, Test accuracy: 75.10
Round  29, Global train loss: 0.268, Global test loss: 0.635, Global test accuracy: 79.00
Round  30, Train loss: 0.308, Test loss: 0.762, Test accuracy: 76.10
Round  30, Global train loss: 0.308, Global test loss: 0.626, Global test accuracy: 79.80
Round  31, Train loss: 0.316, Test loss: 0.807, Test accuracy: 75.94
Round  31, Global train loss: 0.316, Global test loss: 0.653, Global test accuracy: 79.40
Round  32, Train loss: 0.287, Test loss: 0.814, Test accuracy: 75.40
Round  32, Global train loss: 0.287, Global test loss: 0.564, Global test accuracy: 81.60
Round  33, Train loss: 0.242, Test loss: 0.824, Test accuracy: 75.18
Round  33, Global train loss: 0.242, Global test loss: 0.663, Global test accuracy: 79.60
Round  34, Train loss: 0.252, Test loss: 0.846, Test accuracy: 75.36
Round  34, Global train loss: 0.252, Global test loss: 0.685, Global test accuracy: 79.40
Round  35, Train loss: 0.244, Test loss: 0.827, Test accuracy: 76.20
Round  35, Global train loss: 0.244, Global test loss: 0.569, Global test accuracy: 81.80
Round  36, Train loss: 0.223, Test loss: 0.802, Test accuracy: 77.42
Round  36, Global train loss: 0.223, Global test loss: 0.624, Global test accuracy: 80.60
Round  37, Train loss: 0.188, Test loss: 0.784, Test accuracy: 77.52
Round  37, Global train loss: 0.188, Global test loss: 0.658, Global test accuracy: 79.60
Round  38, Train loss: 0.188, Test loss: 0.797, Test accuracy: 77.28
Round  38, Global train loss: 0.188, Global test loss: 0.632, Global test accuracy: 81.20
Round  39, Train loss: 0.261, Test loss: 0.791, Test accuracy: 77.46
Round  39, Global train loss: 0.261, Global test loss: 0.576, Global test accuracy: 80.00
Round  40, Train loss: 0.168, Test loss: 0.844, Test accuracy: 76.86
Round  40, Global train loss: 0.168, Global test loss: 0.727, Global test accuracy: 79.00
Round  41, Train loss: 0.175, Test loss: 0.854, Test accuracy: 76.36
Round  41, Global train loss: 0.175, Global test loss: 0.685, Global test accuracy: 81.00
Round  42, Train loss: 0.167, Test loss: 0.862, Test accuracy: 77.00
Round  42, Global train loss: 0.167, Global test loss: 0.727, Global test accuracy: 79.80
Round  43, Train loss: 0.130, Test loss: 0.816, Test accuracy: 77.64
Round  43, Global train loss: 0.130, Global test loss: 0.655, Global test accuracy: 80.80
Round  44, Train loss: 0.155, Test loss: 0.812, Test accuracy: 77.64
Round  44, Global train loss: 0.155, Global test loss: 0.720, Global test accuracy: 79.60
Round  45, Train loss: 0.123, Test loss: 0.811, Test accuracy: 77.72
Round  45, Global train loss: 0.123, Global test loss: 0.698, Global test accuracy: 81.00
Round  46, Train loss: 0.148, Test loss: 0.803, Test accuracy: 77.68
Round  46, Global train loss: 0.148, Global test loss: 0.674, Global test accuracy: 80.80
Round  47, Train loss: 0.121, Test loss: 0.844, Test accuracy: 77.24
Round  47, Global train loss: 0.121, Global test loss: 0.758, Global test accuracy: 77.80
Round  48, Train loss: 0.160, Test loss: 0.831, Test accuracy: 77.88
Round  48, Global train loss: 0.160, Global test loss: 0.650, Global test accuracy: 81.40
Round  49, Train loss: 0.119, Test loss: 0.843, Test accuracy: 78.18
Round  49, Global train loss: 0.119, Global test loss: 0.697, Global test accuracy: 80.60
Round  50, Train loss: 0.211, Test loss: 0.870, Test accuracy: 77.60
Round  50, Global train loss: 0.211, Global test loss: 0.640, Global test accuracy: 81.80
Round  51, Train loss: 0.154, Test loss: 0.890, Test accuracy: 78.18
Round  51, Global train loss: 0.154, Global test loss: 0.721, Global test accuracy: 81.80
Round  52, Train loss: 0.085, Test loss: 0.928, Test accuracy: 78.06
Round  52, Global train loss: 0.085, Global test loss: 0.868, Global test accuracy: 80.60
Round  53, Train loss: 0.118, Test loss: 0.963, Test accuracy: 77.48
Round  53, Global train loss: 0.118, Global test loss: 0.812, Global test accuracy: 80.60
Round  54, Train loss: 0.183, Test loss: 0.931, Test accuracy: 77.62
Round  54, Global train loss: 0.183, Global test loss: 0.693, Global test accuracy: 80.80
Round  55, Train loss: 0.130, Test loss: 0.884, Test accuracy: 78.46
Round  55, Global train loss: 0.130, Global test loss: 0.654, Global test accuracy: 82.80
Round  56, Train loss: 0.154, Test loss: 0.856, Test accuracy: 79.04
Round  56, Global train loss: 0.154, Global test loss: 0.707, Global test accuracy: 81.60
Round  57, Train loss: 0.097, Test loss: 0.841, Test accuracy: 79.34
Round  57, Global train loss: 0.097, Global test loss: 0.663, Global test accuracy: 83.40
Round  58, Train loss: 0.081, Test loss: 0.842, Test accuracy: 79.62
Round  58, Global train loss: 0.081, Global test loss: 0.808, Global test accuracy: 82.20
Round  59, Train loss: 0.177, Test loss: 0.851, Test accuracy: 79.44
Round  59, Global train loss: 0.177, Global test loss: 0.618, Global test accuracy: 82.00
Round  60, Train loss: 0.078, Test loss: 0.841, Test accuracy: 79.74
Round  60, Global train loss: 0.078, Global test loss: 0.717, Global test accuracy: 83.20
Round  61, Train loss: 0.099, Test loss: 0.821, Test accuracy: 79.90
Round  61, Global train loss: 0.099, Global test loss: 0.709, Global test accuracy: 82.20
Round  62, Train loss: 0.110, Test loss: 0.834, Test accuracy: 79.50
Round  62, Global train loss: 0.110, Global test loss: 0.711, Global test accuracy: 80.60
Round  63, Train loss: 0.118, Test loss: 0.863, Test accuracy: 79.56
Round  63, Global train loss: 0.118, Global test loss: 0.682, Global test accuracy: 81.80
Round  64, Train loss: 0.067, Test loss: 0.908, Test accuracy: 79.76
Round  64, Global train loss: 0.067, Global test loss: 0.912, Global test accuracy: 80.80
Round  65, Train loss: 0.069, Test loss: 0.903, Test accuracy: 80.30
Round  65, Global train loss: 0.069, Global test loss: 0.695, Global test accuracy: 83.40
Round  66, Train loss: 0.093, Test loss: 0.902, Test accuracy: 79.74
Round  66, Global train loss: 0.093, Global test loss: 0.705, Global test accuracy: 82.40
Round  67, Train loss: 0.124, Test loss: 0.909, Test accuracy: 79.26
Round  67, Global train loss: 0.124, Global test loss: 0.597, Global test accuracy: 83.20
Round  68, Train loss: 0.072, Test loss: 0.900, Test accuracy: 79.10
Round  68, Global train loss: 0.072, Global test loss: 0.687, Global test accuracy: 84.40
Round  69, Train loss: 0.084, Test loss: 0.877, Test accuracy: 79.74
Round  69, Global train loss: 0.084, Global test loss: 0.659, Global test accuracy: 83.60
Round  70, Train loss: 0.067, Test loss: 0.831, Test accuracy: 80.38
Round  70, Global train loss: 0.067, Global test loss: 0.661, Global test accuracy: 81.60
Round  71, Train loss: 0.088, Test loss: 0.821, Test accuracy: 79.94
Round  71, Global train loss: 0.088, Global test loss: 0.657, Global test accuracy: 83.00
Round  72, Train loss: 0.078, Test loss: 0.790, Test accuracy: 80.30
Round  72, Global train loss: 0.078, Global test loss: 0.685, Global test accuracy: 83.20
Round  73, Train loss: 0.133, Test loss: 0.809, Test accuracy: 80.46
Round  73, Global train loss: 0.133, Global test loss: 0.622, Global test accuracy: 83.40
Round  74, Train loss: 0.043, Test loss: 0.845, Test accuracy: 80.54
Round  74, Global train loss: 0.043, Global test loss: 0.808, Global test accuracy: 83.00
Round  75, Train loss: 0.084, Test loss: 0.832, Test accuracy: 80.28
Round  75, Global train loss: 0.084, Global test loss: 0.647, Global test accuracy: 84.00
Round  76, Train loss: 0.052, Test loss: 0.898, Test accuracy: 80.50
Round  76, Global train loss: 0.052, Global test loss: 0.907, Global test accuracy: 81.00
Round  77, Train loss: 0.073, Test loss: 0.856, Test accuracy: 80.60
Round  77, Global train loss: 0.073, Global test loss: 0.720, Global test accuracy: 83.40
Round  78, Train loss: 0.044, Test loss: 0.895, Test accuracy: 80.66
Round  78, Global train loss: 0.044, Global test loss: 0.842, Global test accuracy: 81.80
Round  79, Train loss: 0.097, Test loss: 0.921, Test accuracy: 80.08
Round  79, Global train loss: 0.097, Global test loss: 0.712, Global test accuracy: 81.40
Round  80, Train loss: 0.101, Test loss: 0.867, Test accuracy: 80.94
Round  80, Global train loss: 0.101, Global test loss: 0.644, Global test accuracy: 84.00
Round  81, Train loss: 0.028, Test loss: 0.887, Test accuracy: 80.94
Round  81, Global train loss: 0.028, Global test loss: 0.795, Global test accuracy: 83.60
Round  82, Train loss: 0.055, Test loss: 0.899, Test accuracy: 81.08
Round  82, Global train loss: 0.055, Global test loss: 0.760, Global test accuracy: 83.40
Round  83, Train loss: 0.070, Test loss: 0.906, Test accuracy: 80.68
Round  83, Global train loss: 0.070, Global test loss: 0.713, Global test accuracy: 82.20
Round  84, Train loss: 0.039, Test loss: 0.936, Test accuracy: 80.46
Round  84, Global train loss: 0.039, Global test loss: 0.861, Global test accuracy: 80.80
Round  85, Train loss: 0.085, Test loss: 0.902, Test accuracy: 80.58
Round  85, Global train loss: 0.085, Global test loss: 0.685, Global test accuracy: 82.60
Round  86, Train loss: 0.053, Test loss: 0.920, Test accuracy: 80.40
Round  86, Global train loss: 0.053, Global test loss: 0.784, Global test accuracy: 82.80
Round  87, Train loss: 0.071, Test loss: 0.921, Test accuracy: 80.46
Round  87, Global train loss: 0.071, Global test loss: 0.735, Global test accuracy: 82.00
Round  88, Train loss: 0.061, Test loss: 0.889, Test accuracy: 80.26
Round  88, Global train loss: 0.061, Global test loss: 0.718, Global test accuracy: 81.60
Round  89, Train loss: 0.029, Test loss: 0.869, Test accuracy: 80.58
Round  89, Global train loss: 0.029, Global test loss: 0.825, Global test accuracy: 82.20
Round  90, Train loss: 0.023, Test loss: 0.889, Test accuracy: 80.26
Round  90, Global train loss: 0.023, Global test loss: 0.896, Global test accuracy: 80.80
Round  91, Train loss: 0.092, Test loss: 0.923, Test accuracy: 80.20
Round  91, Global train loss: 0.092, Global test loss: 0.667, Global test accuracy: 83.00
Round  92, Train loss: 0.067, Test loss: 0.892, Test accuracy: 80.74
Round  92, Global train loss: 0.067, Global test loss: 0.700, Global test accuracy: 82.20
Round  93, Train loss: 0.034, Test loss: 0.870, Test accuracy: 80.82
Round  93, Global train loss: 0.034, Global test loss: 0.757, Global test accuracy: 83.20
Round  94, Train loss: 0.071, Test loss: 0.885, Test accuracy: 80.78
Round  94, Global train loss: 0.071, Global test loss: 0.743, Global test accuracy: 82.00
Round  95, Train loss: 0.029, Test loss: 0.901, Test accuracy: 80.78
Round  95, Global train loss: 0.029, Global test loss: 0.807, Global test accuracy: 82.60
Round  96, Train loss: 0.062, Test loss: 0.927, Test accuracy: 80.96
Round  96, Global train loss: 0.062, Global test loss: 0.783, Global test accuracy: 83.40
Round  97, Train loss: 0.025, Test loss: 0.902, Test accuracy: 81.38
Round  97, Global train loss: 0.025, Global test loss: 0.801, Global test accuracy: 83.40
Round  98, Train loss: 0.014, Test loss: 0.919, Test accuracy: 81.38
Round  98, Global train loss: 0.014, Global test loss: 0.909, Global test accuracy: 82.40
Round  99, Train loss: 0.015, Test loss: 0.933, Test accuracy: 81.76
Round  99, Global train loss: 0.015, Global test loss: 0.897, Global test accuracy: 83.00
Final Round, Train loss: 0.055, Test loss: 0.989, Test accuracy: 79.56
Final Round, Global train loss: 0.055, Global test loss: 0.897, Global test accuracy: 83.00
Average accuracy final 10 rounds: 80.90600000000002
Average global accuracy final 10 rounds: 82.6
1602.6177515983582
[4.269386053085327, 8.01222276687622, 13.076135396957397, 17.482006311416626, 21.416951656341553, 25.298340320587158, 29.21275234222412, 33.140979528427124, 37.58058142662048, 41.444934368133545, 45.299158811569214, 49.10008001327515, 53.16162824630737, 57.501723289489746, 61.560920000076294, 65.36137557029724, 69.63222408294678, 73.74500179290771, 77.58170676231384, 81.60682249069214, 85.66599297523499, 89.51046752929688, 93.49648356437683, 97.39619898796082, 102.11110520362854, 106.14735674858093, 110.03320360183716, 115.12589263916016, 119.28001856803894, 123.22314620018005, 127.09899067878723, 131.21162462234497, 135.13908100128174, 139.84509181976318, 143.90825629234314, 148.3130567073822, 152.13940691947937, 156.15292811393738, 160.21407508850098, 164.71983432769775, 169.0116481781006, 172.9813780784607, 177.0689549446106, 181.20514178276062, 185.04362320899963, 189.16285490989685, 193.16856360435486, 197.2904245853424, 201.18351411819458, 205.08882784843445, 209.06915926933289, 213.11122107505798, 217.09252643585205, 221.05149745941162, 225.08977556228638, 229.0457763671875, 232.87960529327393, 236.8022539615631, 240.82470989227295, 244.78874969482422, 248.62237071990967, 252.96770572662354, 258.02913331985474, 262.6657075881958, 267.0675482749939, 270.9074532985687, 274.69046354293823, 278.59561586380005, 282.779203414917, 286.6183269023895, 290.6272985935211, 294.6143481731415, 298.51287937164307, 303.0392699241638, 307.25552010536194, 311.2996883392334, 315.2623860836029, 319.2414200305939, 323.112277507782, 327.2720785140991, 331.1844036579132, 336.20212841033936, 339.87455558776855, 343.75740027427673, 347.8407735824585, 351.8794891834259, 356.0969569683075, 360.2207624912262, 364.1448004245758, 368.0550546646118, 372.4690771102905, 376.3893828392029, 380.1814618110657, 384.75413727760315, 388.7832968235016, 392.57418274879456, 396.3980643749237, 400.2990894317627, 404.13437843322754, 408.1731746196747, 415.37154817581177]
[53.82, 56.28, 59.48, 62.0, 63.7, 63.9, 64.14, 66.28, 67.72, 67.98, 69.58, 69.98, 70.4, 71.02, 71.36, 72.74, 73.0, 73.32, 73.34, 73.72, 74.2, 75.0, 74.38, 74.9, 74.8, 74.38, 74.46, 74.84, 75.48, 75.1, 76.1, 75.94, 75.4, 75.18, 75.36, 76.2, 77.42, 77.52, 77.28, 77.46, 76.86, 76.36, 77.0, 77.64, 77.64, 77.72, 77.68, 77.24, 77.88, 78.18, 77.6, 78.18, 78.06, 77.48, 77.62, 78.46, 79.04, 79.34, 79.62, 79.44, 79.74, 79.9, 79.5, 79.56, 79.76, 80.3, 79.74, 79.26, 79.1, 79.74, 80.38, 79.94, 80.3, 80.46, 80.54, 80.28, 80.5, 80.6, 80.66, 80.08, 80.94, 80.94, 81.08, 80.68, 80.46, 80.58, 80.4, 80.46, 80.26, 80.58, 80.26, 80.2, 80.74, 80.82, 80.78, 80.78, 80.96, 81.38, 81.38, 81.76, 79.56]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.574, Test loss: 1.282, Test accuracy: 48.04
Round   0, Global train loss: 1.574, Global test loss: 1.282, Global test accuracy: 48.00
Round   1, Train loss: 1.274, Test loss: 1.054, Test accuracy: 56.90
Round   1, Global train loss: 1.274, Global test loss: 1.036, Global test accuracy: 57.00
Round   2, Train loss: 1.142, Test loss: 0.954, Test accuracy: 60.70
Round   2, Global train loss: 1.142, Global test loss: 0.924, Global test accuracy: 61.20
Round   3, Train loss: 1.060, Test loss: 0.891, Test accuracy: 61.54
Round   3, Global train loss: 1.060, Global test loss: 0.842, Global test accuracy: 62.80
Round   4, Train loss: 0.982, Test loss: 0.797, Test accuracy: 63.86
Round   4, Global train loss: 0.982, Global test loss: 0.782, Global test accuracy: 64.40
Round   5, Train loss: 0.898, Test loss: 0.760, Test accuracy: 67.40
Round   5, Global train loss: 0.898, Global test loss: 0.735, Global test accuracy: 69.20
Round   6, Train loss: 0.874, Test loss: 0.742, Test accuracy: 68.80
Round   6, Global train loss: 0.874, Global test loss: 0.726, Global test accuracy: 69.00
Round   7, Train loss: 0.869, Test loss: 0.707, Test accuracy: 70.04
Round   7, Global train loss: 0.869, Global test loss: 0.694, Global test accuracy: 70.20
Round   8, Train loss: 0.811, Test loss: 0.737, Test accuracy: 70.28
Round   8, Global train loss: 0.811, Global test loss: 0.724, Global test accuracy: 71.20
Round   9, Train loss: 0.764, Test loss: 0.679, Test accuracy: 72.34
Round   9, Global train loss: 0.764, Global test loss: 0.659, Global test accuracy: 72.20
Round  10, Train loss: 0.760, Test loss: 0.692, Test accuracy: 71.42
Round  10, Global train loss: 0.760, Global test loss: 0.677, Global test accuracy: 71.80
Round  11, Train loss: 0.710, Test loss: 0.654, Test accuracy: 73.40
Round  11, Global train loss: 0.710, Global test loss: 0.632, Global test accuracy: 74.60
Round  12, Train loss: 0.731, Test loss: 0.670, Test accuracy: 72.56
Round  12, Global train loss: 0.731, Global test loss: 0.652, Global test accuracy: 73.60
Round  13, Train loss: 0.681, Test loss: 0.745, Test accuracy: 70.06
Round  13, Global train loss: 0.681, Global test loss: 0.707, Global test accuracy: 71.40
Round  14, Train loss: 0.678, Test loss: 0.661, Test accuracy: 73.88
Round  14, Global train loss: 0.678, Global test loss: 0.607, Global test accuracy: 76.00
Round  15, Train loss: 0.657, Test loss: 0.642, Test accuracy: 73.34
Round  15, Global train loss: 0.657, Global test loss: 0.627, Global test accuracy: 73.80
Round  16, Train loss: 0.589, Test loss: 0.683, Test accuracy: 72.74
Round  16, Global train loss: 0.589, Global test loss: 0.667, Global test accuracy: 73.80
Round  17, Train loss: 0.574, Test loss: 0.667, Test accuracy: 73.08
Round  17, Global train loss: 0.574, Global test loss: 0.633, Global test accuracy: 74.60
Round  18, Train loss: 0.569, Test loss: 0.639, Test accuracy: 74.72
Round  18, Global train loss: 0.569, Global test loss: 0.606, Global test accuracy: 75.80
Round  19, Train loss: 0.530, Test loss: 0.656, Test accuracy: 73.54
Round  19, Global train loss: 0.530, Global test loss: 0.642, Global test accuracy: 73.60
Round  20, Train loss: 0.548, Test loss: 0.629, Test accuracy: 76.40
Round  20, Global train loss: 0.548, Global test loss: 0.593, Global test accuracy: 76.80
Round  21, Train loss: 0.528, Test loss: 0.615, Test accuracy: 75.26
Round  21, Global train loss: 0.528, Global test loss: 0.585, Global test accuracy: 76.00
Round  22, Train loss: 0.521, Test loss: 0.632, Test accuracy: 75.26
Round  22, Global train loss: 0.521, Global test loss: 0.625, Global test accuracy: 76.00
Round  23, Train loss: 0.524, Test loss: 0.630, Test accuracy: 74.62
Round  23, Global train loss: 0.524, Global test loss: 0.608, Global test accuracy: 75.40
Round  24, Train loss: 0.452, Test loss: 0.634, Test accuracy: 75.40
Round  24, Global train loss: 0.452, Global test loss: 0.612, Global test accuracy: 77.40
Round  25, Train loss: 0.515, Test loss: 0.580, Test accuracy: 76.78
Round  25, Global train loss: 0.515, Global test loss: 0.564, Global test accuracy: 78.40
Round  26, Train loss: 0.509, Test loss: 0.576, Test accuracy: 77.34
Round  26, Global train loss: 0.509, Global test loss: 0.553, Global test accuracy: 78.20
Round  27, Train loss: 0.454, Test loss: 0.549, Test accuracy: 78.92
Round  27, Global train loss: 0.454, Global test loss: 0.529, Global test accuracy: 79.40
Round  28, Train loss: 0.478, Test loss: 0.565, Test accuracy: 77.80
Round  28, Global train loss: 0.478, Global test loss: 0.561, Global test accuracy: 79.00
Round  29, Train loss: 0.450, Test loss: 0.571, Test accuracy: 77.68
Round  29, Global train loss: 0.450, Global test loss: 0.551, Global test accuracy: 78.80
Round  30, Train loss: 0.487, Test loss: 0.550, Test accuracy: 78.44
Round  30, Global train loss: 0.487, Global test loss: 0.537, Global test accuracy: 78.40
Round  31, Train loss: 0.423, Test loss: 0.571, Test accuracy: 77.98
Round  31, Global train loss: 0.423, Global test loss: 0.557, Global test accuracy: 78.40
Round  32, Train loss: 0.448, Test loss: 0.551, Test accuracy: 78.08
Round  32, Global train loss: 0.448, Global test loss: 0.545, Global test accuracy: 78.00
Round  33, Train loss: 0.361, Test loss: 0.577, Test accuracy: 79.04
Round  33, Global train loss: 0.361, Global test loss: 0.581, Global test accuracy: 79.60
Round  34, Train loss: 0.412, Test loss: 0.573, Test accuracy: 78.10
Round  34, Global train loss: 0.412, Global test loss: 0.567, Global test accuracy: 77.20
Round  35, Train loss: 0.430, Test loss: 0.515, Test accuracy: 80.20
Round  35, Global train loss: 0.430, Global test loss: 0.508, Global test accuracy: 81.00
Round  36, Train loss: 0.379, Test loss: 0.583, Test accuracy: 76.14
Round  36, Global train loss: 0.379, Global test loss: 0.574, Global test accuracy: 76.60
Round  37, Train loss: 0.361, Test loss: 0.595, Test accuracy: 76.96
Round  37, Global train loss: 0.361, Global test loss: 0.595, Global test accuracy: 76.20
Round  38, Train loss: 0.350, Test loss: 0.564, Test accuracy: 78.20
Round  38, Global train loss: 0.350, Global test loss: 0.555, Global test accuracy: 77.80
Round  39, Train loss: 0.303, Test loss: 0.583, Test accuracy: 78.70
Round  39, Global train loss: 0.303, Global test loss: 0.578, Global test accuracy: 78.80
Round  40, Train loss: 0.286, Test loss: 0.608, Test accuracy: 77.72
Round  40, Global train loss: 0.286, Global test loss: 0.608, Global test accuracy: 78.80
Round  41, Train loss: 0.391, Test loss: 0.583, Test accuracy: 78.24
Round  41, Global train loss: 0.391, Global test loss: 0.537, Global test accuracy: 79.40
Round  42, Train loss: 0.262, Test loss: 0.608, Test accuracy: 78.34
Round  42, Global train loss: 0.262, Global test loss: 0.585, Global test accuracy: 79.40
Round  43, Train loss: 0.314, Test loss: 0.581, Test accuracy: 78.88
Round  43, Global train loss: 0.314, Global test loss: 0.562, Global test accuracy: 78.40
Round  44, Train loss: 0.360, Test loss: 0.592, Test accuracy: 78.30
Round  44, Global train loss: 0.360, Global test loss: 0.580, Global test accuracy: 78.80
Round  45, Train loss: 0.312, Test loss: 0.544, Test accuracy: 79.04
Round  45, Global train loss: 0.312, Global test loss: 0.519, Global test accuracy: 79.40
Round  46, Train loss: 0.323, Test loss: 0.526, Test accuracy: 80.32
Round  46, Global train loss: 0.323, Global test loss: 0.508, Global test accuracy: 81.00
Round  47, Train loss: 0.273, Test loss: 0.547, Test accuracy: 79.74
Round  47, Global train loss: 0.273, Global test loss: 0.543, Global test accuracy: 79.60
Round  48, Train loss: 0.260, Test loss: 0.572, Test accuracy: 80.02
Round  48, Global train loss: 0.260, Global test loss: 0.581, Global test accuracy: 80.00
Round  49, Train loss: 0.221, Test loss: 0.565, Test accuracy: 79.94
Round  49, Global train loss: 0.221, Global test loss: 0.576, Global test accuracy: 80.20
Round  50, Train loss: 0.312, Test loss: 0.569, Test accuracy: 80.94
Round  50, Global train loss: 0.312, Global test loss: 0.559, Global test accuracy: 81.60
Round  51, Train loss: 0.294, Test loss: 0.534, Test accuracy: 81.02
Round  51, Global train loss: 0.294, Global test loss: 0.517, Global test accuracy: 82.40
Round  52, Train loss: 0.291, Test loss: 0.570, Test accuracy: 79.68
Round  52, Global train loss: 0.291, Global test loss: 0.543, Global test accuracy: 79.80
Round  53, Train loss: 0.215, Test loss: 0.575, Test accuracy: 80.40
Round  53, Global train loss: 0.215, Global test loss: 0.563, Global test accuracy: 81.60
Round  54, Train loss: 0.169, Test loss: 0.608, Test accuracy: 78.80
Round  54, Global train loss: 0.169, Global test loss: 0.615, Global test accuracy: 77.40
Round  55, Train loss: 0.259, Test loss: 0.552, Test accuracy: 81.76
Round  55, Global train loss: 0.259, Global test loss: 0.512, Global test accuracy: 82.80
Round  56, Train loss: 0.227, Test loss: 0.547, Test accuracy: 82.08
Round  56, Global train loss: 0.227, Global test loss: 0.530, Global test accuracy: 83.00
Round  57, Train loss: 0.222, Test loss: 0.584, Test accuracy: 80.64
Round  57, Global train loss: 0.222, Global test loss: 0.566, Global test accuracy: 80.60
Round  58, Train loss: 0.169, Test loss: 0.588, Test accuracy: 80.54
Round  58, Global train loss: 0.169, Global test loss: 0.597, Global test accuracy: 80.40
Round  59, Train loss: 0.245, Test loss: 0.546, Test accuracy: 81.28
Round  59, Global train loss: 0.245, Global test loss: 0.529, Global test accuracy: 81.20
Round  60, Train loss: 0.209, Test loss: 0.540, Test accuracy: 80.70
Round  60, Global train loss: 0.209, Global test loss: 0.531, Global test accuracy: 81.60
Round  61, Train loss: 0.212, Test loss: 0.590, Test accuracy: 80.80
Round  61, Global train loss: 0.212, Global test loss: 0.580, Global test accuracy: 81.60
Round  62, Train loss: 0.184, Test loss: 0.580, Test accuracy: 80.66
Round  62, Global train loss: 0.184, Global test loss: 0.581, Global test accuracy: 80.20
Round  63, Train loss: 0.214, Test loss: 0.602, Test accuracy: 81.54
Round  63, Global train loss: 0.214, Global test loss: 0.570, Global test accuracy: 81.60
Round  64, Train loss: 0.154, Test loss: 0.579, Test accuracy: 80.22
Round  64, Global train loss: 0.154, Global test loss: 0.567, Global test accuracy: 81.40
Round  65, Train loss: 0.186, Test loss: 0.587, Test accuracy: 82.00
Round  65, Global train loss: 0.186, Global test loss: 0.572, Global test accuracy: 83.00
Round  66, Train loss: 0.163, Test loss: 0.585, Test accuracy: 81.10
Round  66, Global train loss: 0.163, Global test loss: 0.562, Global test accuracy: 81.60
Round  67, Train loss: 0.143, Test loss: 0.591, Test accuracy: 82.14
Round  67, Global train loss: 0.143, Global test loss: 0.606, Global test accuracy: 81.60
Round  68, Train loss: 0.167, Test loss: 0.585, Test accuracy: 82.36
Round  68, Global train loss: 0.167, Global test loss: 0.604, Global test accuracy: 83.40
Round  69, Train loss: 0.156, Test loss: 0.609, Test accuracy: 80.66
Round  69, Global train loss: 0.156, Global test loss: 0.589, Global test accuracy: 81.00
Round  70, Train loss: 0.127, Test loss: 0.649, Test accuracy: 79.64
Round  70, Global train loss: 0.127, Global test loss: 0.683, Global test accuracy: 79.80
Round  71, Train loss: 0.199, Test loss: 0.587, Test accuracy: 81.28
Round  71, Global train loss: 0.199, Global test loss: 0.570, Global test accuracy: 82.00
Round  72, Train loss: 0.147, Test loss: 0.598, Test accuracy: 81.32
Round  72, Global train loss: 0.147, Global test loss: 0.575, Global test accuracy: 82.20
Round  73, Train loss: 0.123, Test loss: 0.594, Test accuracy: 80.06
Round  73, Global train loss: 0.123, Global test loss: 0.591, Global test accuracy: 79.40
Round  74, Train loss: 0.113, Test loss: 0.630, Test accuracy: 80.46
Round  74, Global train loss: 0.113, Global test loss: 0.624, Global test accuracy: 80.60
Round  75, Train loss: 0.184, Test loss: 0.622, Test accuracy: 81.74
Round  75, Global train loss: 0.184, Global test loss: 0.559, Global test accuracy: 82.00
Round  76, Train loss: 0.098, Test loss: 0.652, Test accuracy: 81.20
Round  76, Global train loss: 0.098, Global test loss: 0.649, Global test accuracy: 81.60
Round  77, Train loss: 0.106, Test loss: 0.679, Test accuracy: 80.52
Round  77, Global train loss: 0.106, Global test loss: 0.656, Global test accuracy: 79.80
Round  78, Train loss: 0.076, Test loss: 0.666, Test accuracy: 81.76
Round  78, Global train loss: 0.076, Global test loss: 0.678, Global test accuracy: 81.80
Round  79, Train loss: 0.130, Test loss: 0.607, Test accuracy: 82.28
Round  79, Global train loss: 0.130, Global test loss: 0.593, Global test accuracy: 83.20
Round  80, Train loss: 0.171, Test loss: 0.577, Test accuracy: 81.48
Round  80, Global train loss: 0.171, Global test loss: 0.538, Global test accuracy: 81.40
Round  81, Train loss: 0.149, Test loss: 0.598, Test accuracy: 82.54
Round  81, Global train loss: 0.149, Global test loss: 0.560, Global test accuracy: 83.00
Round  82, Train loss: 0.149, Test loss: 0.699, Test accuracy: 81.08
Round  82, Global train loss: 0.149, Global test loss: 0.644, Global test accuracy: 82.20
Round  83, Train loss: 0.119, Test loss: 0.693, Test accuracy: 80.50
Round  83, Global train loss: 0.119, Global test loss: 0.659, Global test accuracy: 81.40
Round  84, Train loss: 0.111, Test loss: 0.669, Test accuracy: 80.86
Round  84, Global train loss: 0.111, Global test loss: 0.640, Global test accuracy: 80.40
Round  85, Train loss: 0.083, Test loss: 0.701, Test accuracy: 80.00
Round  85, Global train loss: 0.083, Global test loss: 0.719, Global test accuracy: 80.80
Round  86, Train loss: 0.085, Test loss: 0.675, Test accuracy: 79.68
Round  86, Global train loss: 0.085, Global test loss: 0.657, Global test accuracy: 79.80
Round  87, Train loss: 0.081, Test loss: 0.636, Test accuracy: 81.48
Round  87, Global train loss: 0.081, Global test loss: 0.625, Global test accuracy: 81.40
Round  88, Train loss: 0.082, Test loss: 0.631, Test accuracy: 81.98
Round  88, Global train loss: 0.082, Global test loss: 0.629, Global test accuracy: 81.60
Round  89, Train loss: 0.152, Test loss: 0.566, Test accuracy: 83.22
Round  89, Global train loss: 0.152, Global test loss: 0.532, Global test accuracy: 83.40
Round  90, Train loss: 0.119, Test loss: 0.613, Test accuracy: 82.44
Round  90, Global train loss: 0.119, Global test loss: 0.606, Global test accuracy: 83.00
Round  91, Train loss: 0.070, Test loss: 0.670, Test accuracy: 81.38
Round  91, Global train loss: 0.070, Global test loss: 0.689, Global test accuracy: 81.40
Round  92, Train loss: 0.089, Test loss: 0.669, Test accuracy: 81.32
Round  92, Global train loss: 0.089, Global test loss: 0.653, Global test accuracy: 80.80
Round  93, Train loss: 0.121, Test loss: 0.666, Test accuracy: 81.54
Round  93, Global train loss: 0.121, Global test loss: 0.646, Global test accuracy: 80.20
Round  94, Train loss: 0.094, Test loss: 0.659, Test accuracy: 81.44
Round  94, Global train loss: 0.094, Global test loss: 0.614, Global test accuracy: 81.60
Round  95, Train loss: 0.106, Test loss: 0.676, Test accuracy: 82.42
Round  95, Global train loss: 0.106, Global test loss: 0.623, Global test accuracy: 83.20
Round  96, Train loss: 0.075, Test loss: 0.665, Test accuracy: 82.24
Round  96, Global train loss: 0.075, Global test loss: 0.653, Global test accuracy: 82.40
Round  97, Train loss: 0.054, Test loss: 0.690, Test accuracy: 81.40
Round  97, Global train loss: 0.054, Global test loss: 0.705, Global test accuracy: 81.60
Round  98, Train loss: 0.090, Test loss: 0.644, Test accuracy: 82.38
Round  98, Global train loss: 0.090, Global test loss: 0.624, Global test accuracy: 82.40
Round  99, Train loss: 0.058, Test loss: 0.629, Test accuracy: 82.14
Round  99, Global train loss: 0.058, Global test loss: 0.636, Global test accuracy: 81.80
Final Round, Train loss: 0.050, Test loss: 0.649, Test accuracy: 82.02
Final Round, Global train loss: 0.050, Global test loss: 0.636, Global test accuracy: 81.80
Average accuracy final 10 rounds: 81.86999999999999
910.973484992981
[2.253702163696289, 4.074076890945435, 6.009337902069092, 7.745633840560913, 9.568112850189209, 11.326768159866333, 13.170787334442139, 14.981847047805786, 16.763646602630615, 18.49858832359314, 20.25390315055847, 22.00307011604309, 23.7737820148468, 25.581748247146606, 27.402631282806396, 29.256221294403076, 31.018095016479492, 32.830910205841064, 34.61738419532776, 36.59264326095581, 38.32386302947998, 40.03998303413391, 41.836475133895874, 43.55452632904053, 45.34971737861633, 47.094783306121826, 49.00525903701782, 50.76896286010742, 52.585994243621826, 54.494016885757446, 56.41010332107544, 58.268086433410645, 60.13239407539368, 61.95818209648132, 63.79677081108093, 65.58692622184753, 67.4600579738617, 69.26688122749329, 71.1838846206665, 73.01173758506775, 75.15277981758118, 77.31095337867737, 79.3050320148468, 81.22635626792908, 83.02122330665588, 85.04654335975647, 86.83584022521973, 88.66916251182556, 90.43127679824829, 92.17633891105652, 94.60873556137085, 96.55007243156433, 98.4402174949646, 100.80914616584778, 102.89437747001648, 105.20100331306458, 107.6107223033905, 109.9157989025116, 111.69455766677856, 113.4859127998352, 115.2833685874939, 117.10353088378906, 118.79171204566956, 120.58740973472595, 122.36294531822205, 124.162113904953, 125.88260054588318, 127.63490986824036, 129.2972755432129, 131.1001274585724, 132.91513347625732, 134.67119431495667, 136.40588688850403, 138.65143370628357, 140.48442673683167, 142.34604811668396, 144.0767011642456, 145.96785712242126, 147.71641850471497, 149.47816729545593, 151.21349954605103, 153.0894753932953, 154.9441487789154, 156.93690943717957, 158.8290011882782, 160.5893325805664, 162.4543433189392, 164.16011500358582, 166.02544689178467, 167.77688264846802, 169.57236099243164, 171.42729353904724, 173.35838317871094, 175.13410139083862, 176.86638522148132, 178.77069759368896, 180.9647731781006, 183.1292176246643, 185.01588344573975, 187.0879509449005, 190.40649557113647]
[48.04, 56.9, 60.7, 61.54, 63.86, 67.4, 68.8, 70.04, 70.28, 72.34, 71.42, 73.4, 72.56, 70.06, 73.88, 73.34, 72.74, 73.08, 74.72, 73.54, 76.4, 75.26, 75.26, 74.62, 75.4, 76.78, 77.34, 78.92, 77.8, 77.68, 78.44, 77.98, 78.08, 79.04, 78.1, 80.2, 76.14, 76.96, 78.2, 78.7, 77.72, 78.24, 78.34, 78.88, 78.3, 79.04, 80.32, 79.74, 80.02, 79.94, 80.94, 81.02, 79.68, 80.4, 78.8, 81.76, 82.08, 80.64, 80.54, 81.28, 80.7, 80.8, 80.66, 81.54, 80.22, 82.0, 81.1, 82.14, 82.36, 80.66, 79.64, 81.28, 81.32, 80.06, 80.46, 81.74, 81.2, 80.52, 81.76, 82.28, 81.48, 82.54, 81.08, 80.5, 80.86, 80.0, 79.68, 81.48, 81.98, 83.22, 82.44, 81.38, 81.32, 81.54, 81.44, 82.42, 82.24, 81.4, 82.38, 82.14, 82.02]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.557, Test loss: 1.233, Test accuracy: 50.20
Round   0, Global train loss: 1.557, Global test loss: 1.233, Global test accuracy: 50.00
Round   1, Train loss: 1.256, Test loss: 1.028, Test accuracy: 56.04
Round   1, Global train loss: 1.256, Global test loss: 1.026, Global test accuracy: 56.00
Round   2, Train loss: 1.128, Test loss: 0.921, Test accuracy: 60.68
Round   2, Global train loss: 1.128, Global test loss: 0.916, Global test accuracy: 60.00
Round   3, Train loss: 1.029, Test loss: 0.822, Test accuracy: 65.02
Round   3, Global train loss: 1.029, Global test loss: 0.817, Global test accuracy: 64.60
Round   4, Train loss: 0.939, Test loss: 0.790, Test accuracy: 65.84
Round   4, Global train loss: 0.939, Global test loss: 0.785, Global test accuracy: 65.40
Round   5, Train loss: 0.880, Test loss: 0.749, Test accuracy: 67.14
Round   5, Global train loss: 0.880, Global test loss: 0.745, Global test accuracy: 66.60
Round   6, Train loss: 0.836, Test loss: 0.724, Test accuracy: 68.36
Round   6, Global train loss: 0.836, Global test loss: 0.719, Global test accuracy: 68.20
Round   7, Train loss: 0.802, Test loss: 0.701, Test accuracy: 69.74
Round   7, Global train loss: 0.802, Global test loss: 0.696, Global test accuracy: 69.80
Round   8, Train loss: 0.776, Test loss: 0.713, Test accuracy: 69.68
Round   8, Global train loss: 0.776, Global test loss: 0.708, Global test accuracy: 68.60
Round   9, Train loss: 0.747, Test loss: 0.654, Test accuracy: 72.44
Round   9, Global train loss: 0.747, Global test loss: 0.649, Global test accuracy: 71.80
Round  10, Train loss: 0.743, Test loss: 0.677, Test accuracy: 71.26
Round  10, Global train loss: 0.743, Global test loss: 0.673, Global test accuracy: 71.60
Round  11, Train loss: 0.634, Test loss: 0.707, Test accuracy: 70.74
Round  11, Global train loss: 0.634, Global test loss: 0.699, Global test accuracy: 70.80
Round  12, Train loss: 0.645, Test loss: 0.699, Test accuracy: 69.74
Round  12, Global train loss: 0.645, Global test loss: 0.667, Global test accuracy: 71.60
Round  13, Train loss: 0.676, Test loss: 0.663, Test accuracy: 70.74
Round  13, Global train loss: 0.676, Global test loss: 0.644, Global test accuracy: 72.40
Round  14, Train loss: 0.595, Test loss: 0.683, Test accuracy: 70.28
Round  14, Global train loss: 0.595, Global test loss: 0.671, Global test accuracy: 70.80
Round  15, Train loss: 0.594, Test loss: 0.618, Test accuracy: 74.04
Round  15, Global train loss: 0.594, Global test loss: 0.615, Global test accuracy: 74.80
Round  16, Train loss: 0.613, Test loss: 0.651, Test accuracy: 74.70
Round  16, Global train loss: 0.613, Global test loss: 0.629, Global test accuracy: 75.20
Round  17, Train loss: 0.591, Test loss: 0.668, Test accuracy: 73.16
Round  17, Global train loss: 0.591, Global test loss: 0.627, Global test accuracy: 74.40
Round  18, Train loss: 0.531, Test loss: 0.705, Test accuracy: 71.36
Round  18, Global train loss: 0.531, Global test loss: 0.659, Global test accuracy: 72.60
Round  19, Train loss: 0.574, Test loss: 0.641, Test accuracy: 74.48
Round  19, Global train loss: 0.574, Global test loss: 0.632, Global test accuracy: 74.80
Round  20, Train loss: 0.532, Test loss: 0.638, Test accuracy: 75.26
Round  20, Global train loss: 0.532, Global test loss: 0.604, Global test accuracy: 76.20
Round  21, Train loss: 0.549, Test loss: 0.587, Test accuracy: 77.06
Round  21, Global train loss: 0.549, Global test loss: 0.582, Global test accuracy: 77.20
Round  22, Train loss: 0.498, Test loss: 0.598, Test accuracy: 77.02
Round  22, Global train loss: 0.498, Global test loss: 0.592, Global test accuracy: 77.80
Round  23, Train loss: 0.488, Test loss: 0.611, Test accuracy: 75.76
Round  23, Global train loss: 0.488, Global test loss: 0.595, Global test accuracy: 76.40
Round  24, Train loss: 0.465, Test loss: 0.627, Test accuracy: 74.40
Round  24, Global train loss: 0.465, Global test loss: 0.610, Global test accuracy: 76.60
Round  25, Train loss: 0.440, Test loss: 0.595, Test accuracy: 77.02
Round  25, Global train loss: 0.440, Global test loss: 0.590, Global test accuracy: 77.00
Round  26, Train loss: 0.490, Test loss: 0.605, Test accuracy: 75.52
Round  26, Global train loss: 0.490, Global test loss: 0.590, Global test accuracy: 75.60
Round  27, Train loss: 0.469, Test loss: 0.633, Test accuracy: 74.94
Round  27, Global train loss: 0.469, Global test loss: 0.595, Global test accuracy: 76.00
Round  28, Train loss: 0.449, Test loss: 0.606, Test accuracy: 75.70
Round  28, Global train loss: 0.449, Global test loss: 0.577, Global test accuracy: 77.20
Round  29, Train loss: 0.394, Test loss: 0.662, Test accuracy: 73.18
Round  29, Global train loss: 0.394, Global test loss: 0.618, Global test accuracy: 75.20
Round  30, Train loss: 0.378, Test loss: 0.626, Test accuracy: 76.68
Round  30, Global train loss: 0.378, Global test loss: 0.606, Global test accuracy: 77.00
Round  31, Train loss: 0.352, Test loss: 0.628, Test accuracy: 76.78
Round  31, Global train loss: 0.352, Global test loss: 0.600, Global test accuracy: 78.60
Round  32, Train loss: 0.359, Test loss: 0.604, Test accuracy: 77.82
Round  32, Global train loss: 0.359, Global test loss: 0.599, Global test accuracy: 79.40
Round  33, Train loss: 0.331, Test loss: 0.593, Test accuracy: 77.08
Round  33, Global train loss: 0.331, Global test loss: 0.600, Global test accuracy: 77.40
Round  34, Train loss: 0.379, Test loss: 0.572, Test accuracy: 79.70
Round  34, Global train loss: 0.379, Global test loss: 0.562, Global test accuracy: 80.20
Round  35, Train loss: 0.375, Test loss: 0.575, Test accuracy: 79.14
Round  35, Global train loss: 0.375, Global test loss: 0.553, Global test accuracy: 79.00
Round  36, Train loss: 0.278, Test loss: 0.631, Test accuracy: 78.12
Round  36, Global train loss: 0.278, Global test loss: 0.639, Global test accuracy: 78.60
Round  37, Train loss: 0.363, Test loss: 0.673, Test accuracy: 76.80
Round  37, Global train loss: 0.363, Global test loss: 0.660, Global test accuracy: 76.80
Round  38, Train loss: 0.324, Test loss: 0.627, Test accuracy: 77.44
Round  38, Global train loss: 0.324, Global test loss: 0.616, Global test accuracy: 78.40
Round  39, Train loss: 0.267, Test loss: 0.605, Test accuracy: 79.54
Round  39, Global train loss: 0.267, Global test loss: 0.584, Global test accuracy: 80.00
Round  40, Train loss: 0.318, Test loss: 0.600, Test accuracy: 78.68
Round  40, Global train loss: 0.318, Global test loss: 0.588, Global test accuracy: 77.80
Round  41, Train loss: 0.339, Test loss: 0.551, Test accuracy: 79.84
Round  41, Global train loss: 0.339, Global test loss: 0.526, Global test accuracy: 80.00
Round  42, Train loss: 0.297, Test loss: 0.577, Test accuracy: 78.96
Round  42, Global train loss: 0.297, Global test loss: 0.561, Global test accuracy: 79.20
Round  43, Train loss: 0.281, Test loss: 0.593, Test accuracy: 79.22
Round  43, Global train loss: 0.281, Global test loss: 0.571, Global test accuracy: 79.80
Round  44, Train loss: 0.302, Test loss: 0.585, Test accuracy: 78.90
Round  44, Global train loss: 0.302, Global test loss: 0.576, Global test accuracy: 79.00
Round  45, Train loss: 0.244, Test loss: 0.623, Test accuracy: 80.48
Round  45, Global train loss: 0.244, Global test loss: 0.616, Global test accuracy: 81.00
Round  46, Train loss: 0.216, Test loss: 0.637, Test accuracy: 79.14
Round  46, Global train loss: 0.216, Global test loss: 0.615, Global test accuracy: 80.40
Round  47, Train loss: 0.194, Test loss: 0.719, Test accuracy: 77.74
Round  47, Global train loss: 0.194, Global test loss: 0.737, Global test accuracy: 77.80
Round  48, Train loss: 0.241, Test loss: 0.657, Test accuracy: 77.60
Round  48, Global train loss: 0.241, Global test loss: 0.634, Global test accuracy: 79.40
Round  49, Train loss: 0.265, Test loss: 0.630, Test accuracy: 79.12
Round  49, Global train loss: 0.265, Global test loss: 0.603, Global test accuracy: 80.00
Round  50, Train loss: 0.200, Test loss: 0.639, Test accuracy: 78.88
Round  50, Global train loss: 0.200, Global test loss: 0.648, Global test accuracy: 79.20
Round  51, Train loss: 0.245, Test loss: 0.630, Test accuracy: 79.22
Round  51, Global train loss: 0.245, Global test loss: 0.599, Global test accuracy: 80.20
Round  52, Train loss: 0.174, Test loss: 0.659, Test accuracy: 79.22
Round  52, Global train loss: 0.174, Global test loss: 0.660, Global test accuracy: 79.80
Round  53, Train loss: 0.162, Test loss: 0.661, Test accuracy: 80.02
Round  53, Global train loss: 0.162, Global test loss: 0.664, Global test accuracy: 80.80
Round  54, Train loss: 0.213, Test loss: 0.679, Test accuracy: 78.80
Round  54, Global train loss: 0.213, Global test loss: 0.626, Global test accuracy: 78.80
Round  55, Train loss: 0.213, Test loss: 0.665, Test accuracy: 78.66
Round  55, Global train loss: 0.213, Global test loss: 0.652, Global test accuracy: 78.40
Round  56, Train loss: 0.207, Test loss: 0.650, Test accuracy: 80.70
Round  56, Global train loss: 0.207, Global test loss: 0.610, Global test accuracy: 81.60
Round  57, Train loss: 0.197, Test loss: 0.646, Test accuracy: 79.98
Round  57, Global train loss: 0.197, Global test loss: 0.607, Global test accuracy: 80.80
Round  58, Train loss: 0.161, Test loss: 0.681, Test accuracy: 80.48
Round  58, Global train loss: 0.161, Global test loss: 0.664, Global test accuracy: 80.80
Round  59, Train loss: 0.120, Test loss: 0.691, Test accuracy: 78.68
Round  59, Global train loss: 0.120, Global test loss: 0.693, Global test accuracy: 79.20
Round  60, Train loss: 0.203, Test loss: 0.705, Test accuracy: 79.10
Round  60, Global train loss: 0.203, Global test loss: 0.664, Global test accuracy: 80.00
Round  61, Train loss: 0.147, Test loss: 0.646, Test accuracy: 79.94
Round  61, Global train loss: 0.147, Global test loss: 0.636, Global test accuracy: 80.20
Round  62, Train loss: 0.108, Test loss: 0.686, Test accuracy: 80.26
Round  62, Global train loss: 0.108, Global test loss: 0.710, Global test accuracy: 80.80
Round  63, Train loss: 0.158, Test loss: 0.687, Test accuracy: 80.24
Round  63, Global train loss: 0.158, Global test loss: 0.666, Global test accuracy: 81.20
Round  64, Train loss: 0.184, Test loss: 0.630, Test accuracy: 80.92
Round  64, Global train loss: 0.184, Global test loss: 0.601, Global test accuracy: 80.80
Round  65, Train loss: 0.151, Test loss: 0.684, Test accuracy: 79.78
Round  65, Global train loss: 0.151, Global test loss: 0.646, Global test accuracy: 80.80
Round  66, Train loss: 0.181, Test loss: 0.642, Test accuracy: 81.58
Round  66, Global train loss: 0.181, Global test loss: 0.598, Global test accuracy: 83.00
Round  67, Train loss: 0.183, Test loss: 0.662, Test accuracy: 80.92
Round  67, Global train loss: 0.183, Global test loss: 0.617, Global test accuracy: 81.00
Round  68, Train loss: 0.132, Test loss: 0.671, Test accuracy: 80.22
Round  68, Global train loss: 0.132, Global test loss: 0.645, Global test accuracy: 81.40
Round  69, Train loss: 0.121, Test loss: 0.648, Test accuracy: 80.70
Round  69, Global train loss: 0.121, Global test loss: 0.660, Global test accuracy: 80.40
Round  70, Train loss: 0.101, Test loss: 0.682, Test accuracy: 80.68
Round  70, Global train loss: 0.101, Global test loss: 0.685, Global test accuracy: 81.00
Round  71, Train loss: 0.118, Test loss: 0.679, Test accuracy: 81.34
Round  71, Global train loss: 0.118, Global test loss: 0.671, Global test accuracy: 80.80
Round  72, Train loss: 0.134, Test loss: 0.633, Test accuracy: 81.20
Round  72, Global train loss: 0.134, Global test loss: 0.632, Global test accuracy: 81.20
Round  73, Train loss: 0.123, Test loss: 0.689, Test accuracy: 81.02
Round  73, Global train loss: 0.123, Global test loss: 0.718, Global test accuracy: 80.80
Round  74, Train loss: 0.099, Test loss: 0.668, Test accuracy: 81.10
Round  74, Global train loss: 0.099, Global test loss: 0.692, Global test accuracy: 81.00
Round  75, Train loss: 0.149, Test loss: 0.635, Test accuracy: 81.28
Round  75, Global train loss: 0.149, Global test loss: 0.599, Global test accuracy: 82.00
Round  76, Train loss: 0.116, Test loss: 0.646, Test accuracy: 81.52
Round  76, Global train loss: 0.116, Global test loss: 0.611, Global test accuracy: 82.40
Round  77, Train loss: 0.147, Test loss: 0.618, Test accuracy: 81.18
Round  77, Global train loss: 0.147, Global test loss: 0.579, Global test accuracy: 81.40
Round  78, Train loss: 0.127, Test loss: 0.733, Test accuracy: 80.44
Round  78, Global train loss: 0.127, Global test loss: 0.694, Global test accuracy: 81.40
Round  79, Train loss: 0.137, Test loss: 0.665, Test accuracy: 81.16
Round  79, Global train loss: 0.137, Global test loss: 0.653, Global test accuracy: 80.80
Round  80, Train loss: 0.072, Test loss: 0.659, Test accuracy: 80.82
Round  80, Global train loss: 0.072, Global test loss: 0.664, Global test accuracy: 81.00
Round  81, Train loss: 0.062, Test loss: 0.646, Test accuracy: 82.02
Round  81, Global train loss: 0.062, Global test loss: 0.660, Global test accuracy: 81.60
Round  82, Train loss: 0.069, Test loss: 0.645, Test accuracy: 81.40
Round  82, Global train loss: 0.069, Global test loss: 0.649, Global test accuracy: 81.40
Round  83, Train loss: 0.062, Test loss: 0.677, Test accuracy: 81.78
Round  83, Global train loss: 0.062, Global test loss: 0.688, Global test accuracy: 83.20
Round  84, Train loss: 0.053, Test loss: 0.679, Test accuracy: 81.74
Round  84, Global train loss: 0.053, Global test loss: 0.699, Global test accuracy: 82.60
Round  85, Train loss: 0.045, Test loss: 0.687, Test accuracy: 81.80
Round  85, Global train loss: 0.045, Global test loss: 0.719, Global test accuracy: 82.00
Round  86, Train loss: 0.052, Test loss: 0.724, Test accuracy: 81.02
Round  86, Global train loss: 0.052, Global test loss: 0.771, Global test accuracy: 81.40
Round  87, Train loss: 0.045, Test loss: 0.722, Test accuracy: 81.48
Round  87, Global train loss: 0.045, Global test loss: 0.761, Global test accuracy: 81.20
Round  88, Train loss: 0.044, Test loss: 0.722, Test accuracy: 82.02
Round  88, Global train loss: 0.044, Global test loss: 0.764, Global test accuracy: 82.40
Round  89, Train loss: 0.046, Test loss: 0.707, Test accuracy: 81.96
Round  89, Global train loss: 0.046, Global test loss: 0.743, Global test accuracy: 82.60
Round  90, Train loss: 0.045, Test loss: 0.737, Test accuracy: 81.36
Round  90, Global train loss: 0.045, Global test loss: 0.786, Global test accuracy: 80.80
Round  91, Train loss: 0.034, Test loss: 0.727, Test accuracy: 80.14
Round  91, Global train loss: 0.034, Global test loss: 0.763, Global test accuracy: 80.00
Round  92, Train loss: 0.033, Test loss: 0.707, Test accuracy: 81.28
Round  92, Global train loss: 0.033, Global test loss: 0.739, Global test accuracy: 81.40
Round  93, Train loss: 0.028, Test loss: 0.730, Test accuracy: 81.64
Round  93, Global train loss: 0.028, Global test loss: 0.774, Global test accuracy: 81.20
Round  94, Train loss: 0.033, Test loss: 0.725, Test accuracy: 81.06
Round  94, Global train loss: 0.033, Global test loss: 0.768, Global test accuracy: 81.40
Round  95, Train loss: 0.031, Test loss: 0.724, Test accuracy: 81.74
Round  95, Global train loss: 0.031, Global test loss: 0.763, Global test accuracy: 81.60
Round  96, Train loss: 0.035, Test loss: 0.715, Test accuracy: 81.36
Round  96, Global train loss: 0.035, Global test loss: 0.755, Global test accuracy: 82.00
Round  97, Train loss: 0.040, Test loss: 0.692, Test accuracy: 81.66
Round  97, Global train loss: 0.040, Global test loss: 0.732, Global test accuracy: 81.60
Round  98, Train loss: 0.034, Test loss: 0.699, Test accuracy: 81.26
Round  98, Global train loss: 0.034, Global test loss: 0.732, Global test accuracy: 81.40
Round  99, Train loss: 0.071, Test loss: 0.708, Test accuracy: 82.10
Round  99, Global train loss: 0.071, Global test loss: 0.679, Global test accuracy: 82.80
Final Round, Train loss: 0.057, Test loss: 0.721, Test accuracy: 82.00
Final Round, Global train loss: 0.057, Global test loss: 0.679, Global test accuracy: 82.80
Average accuracy final 10 rounds: 81.36
2010.012302160263
[2.453470230102539, 4.651336193084717, 6.822815179824829, 9.47934365272522, 11.576461791992188, 13.611778974533081, 15.827593088150024, 18.31928253173828, 20.517879486083984, 22.672683715820312, 30.31894040107727, 41.80174970626831, 52.95972561836243, 55.02429676055908, 66.87559413909912, 78.82283210754395, 90.09145331382751, 101.48257040977478, 112.68622493743896, 124.00655198097229, 126.0047402381897, 137.4733645915985, 139.47722101211548, 141.59343767166138, 153.1248164176941, 155.20339822769165, 166.5622432231903, 178.13914585113525, 189.33765959739685, 200.6453309059143, 211.65617060661316, 223.2712483406067, 235.05147099494934, 237.17912673950195, 248.73137092590332, 260.11919116973877, 262.2451903820038, 273.9844446182251, 285.26241302490234, 296.85220432281494, 298.92535376548767, 310.3597502708435, 321.833340883255, 332.92330265045166, 343.7608346939087, 345.84246373176575, 357.1526737213135, 359.16633200645447, 361.22225880622864, 372.54647397994995, 374.79293847084045, 386.0136368274689, 388.083039522171, 399.36010360717773, 410.61591362953186, 421.56357884407043, 433.05111956596375, 444.5560693740845, 446.5736768245697, 457.6735851764679, 468.8410634994507, 470.96825075149536, 473.0981969833374, 484.14591693878174, 497.5165390968323, 508.73136615753174, 519.9342365264893, 531.3104934692383, 542.2232050895691, 544.188148021698, 555.2577638626099, 557.3413078784943, 568.2404730319977, 570.2397532463074, 572.2723097801208, 583.4877631664276, 594.5808267593384, 605.7019019126892, 617.0426843166351, 628.2176232337952, 630.4080901145935, 632.5809323787689, 634.864720582962, 637.0164947509766, 639.106281042099, 641.0958707332611, 643.2020792961121, 645.2361662387848, 647.4886498451233, 649.706531047821, 651.8103067874908, 654.0005404949188, 656.1177263259888, 658.1964070796967, 660.3213818073273, 662.432373046875, 664.4544677734375, 666.6695039272308, 668.8082685470581, 679.8389940261841, 691.51136469841]
[50.2, 56.04, 60.68, 65.02, 65.84, 67.14, 68.36, 69.74, 69.68, 72.44, 71.26, 70.74, 69.74, 70.74, 70.28, 74.04, 74.7, 73.16, 71.36, 74.48, 75.26, 77.06, 77.02, 75.76, 74.4, 77.02, 75.52, 74.94, 75.7, 73.18, 76.68, 76.78, 77.82, 77.08, 79.7, 79.14, 78.12, 76.8, 77.44, 79.54, 78.68, 79.84, 78.96, 79.22, 78.9, 80.48, 79.14, 77.74, 77.6, 79.12, 78.88, 79.22, 79.22, 80.02, 78.8, 78.66, 80.7, 79.98, 80.48, 78.68, 79.1, 79.94, 80.26, 80.24, 80.92, 79.78, 81.58, 80.92, 80.22, 80.7, 80.68, 81.34, 81.2, 81.02, 81.1, 81.28, 81.52, 81.18, 80.44, 81.16, 80.82, 82.02, 81.4, 81.78, 81.74, 81.8, 81.02, 81.48, 82.02, 81.96, 81.36, 80.14, 81.28, 81.64, 81.06, 81.74, 81.36, 81.66, 81.26, 82.1, 82.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.529, Test loss: 1.379, Test accuracy: 43.38
Round   0, Global train loss: 1.529, Global test loss: 1.381, Global test accuracy: 43.60
Round   1, Train loss: 1.484, Test loss: 1.308, Test accuracy: 44.38
Round   1, Global train loss: 1.484, Global test loss: 1.272, Global test accuracy: 45.00
Round   2, Train loss: 1.438, Test loss: 1.290, Test accuracy: 47.12
Round   2, Global train loss: 1.438, Global test loss: 1.270, Global test accuracy: 49.00
Round   3, Train loss: 1.417, Test loss: 1.263, Test accuracy: 49.56
Round   3, Global train loss: 1.417, Global test loss: 1.256, Global test accuracy: 51.20
Round   4, Train loss: 1.285, Test loss: 1.166, Test accuracy: 53.86
Round   4, Global train loss: 1.285, Global test loss: 1.038, Global test accuracy: 60.60
Round   5, Train loss: 1.258, Test loss: 1.147, Test accuracy: 54.16
Round   5, Global train loss: 1.258, Global test loss: 0.992, Global test accuracy: 61.60
Round   6, Train loss: 1.366, Test loss: 1.134, Test accuracy: 54.26
Round   6, Global train loss: 1.366, Global test loss: 1.203, Global test accuracy: 55.80
Round   7, Train loss: 1.187, Test loss: 1.123, Test accuracy: 55.30
Round   7, Global train loss: 1.187, Global test loss: 0.976, Global test accuracy: 60.60
Round   8, Train loss: 1.179, Test loss: 1.120, Test accuracy: 55.40
Round   8, Global train loss: 1.179, Global test loss: 0.996, Global test accuracy: 61.40
Round   9, Train loss: 1.158, Test loss: 1.097, Test accuracy: 56.62
Round   9, Global train loss: 1.158, Global test loss: 0.947, Global test accuracy: 65.00
Round  10, Train loss: 1.236, Test loss: 1.090, Test accuracy: 56.90
Round  10, Global train loss: 1.236, Global test loss: 1.040, Global test accuracy: 63.80
Round  11, Train loss: 1.217, Test loss: 1.070, Test accuracy: 57.66
Round  11, Global train loss: 1.217, Global test loss: 0.996, Global test accuracy: 65.40
Round  12, Train loss: 1.384, Test loss: 1.075, Test accuracy: 58.14
Round  12, Global train loss: 1.384, Global test loss: 1.209, Global test accuracy: 60.00
Round  13, Train loss: 1.185, Test loss: 1.061, Test accuracy: 58.58
Round  13, Global train loss: 1.185, Global test loss: 0.932, Global test accuracy: 65.40
Round  14, Train loss: 1.160, Test loss: 1.061, Test accuracy: 58.84
Round  14, Global train loss: 1.160, Global test loss: 0.974, Global test accuracy: 66.60
Round  15, Train loss: 1.157, Test loss: 1.048, Test accuracy: 59.32
Round  15, Global train loss: 1.157, Global test loss: 0.975, Global test accuracy: 64.60
Round  16, Train loss: 1.138, Test loss: 1.060, Test accuracy: 58.74
Round  16, Global train loss: 1.138, Global test loss: 1.010, Global test accuracy: 63.80
Round  17, Train loss: 0.973, Test loss: 1.061, Test accuracy: 58.52
Round  17, Global train loss: 0.973, Global test loss: 0.848, Global test accuracy: 69.00
Round  18, Train loss: 0.973, Test loss: 1.063, Test accuracy: 59.02
Round  18, Global train loss: 0.973, Global test loss: 0.841, Global test accuracy: 67.60
Round  19, Train loss: 0.898, Test loss: 1.044, Test accuracy: 59.40
Round  19, Global train loss: 0.898, Global test loss: 0.776, Global test accuracy: 70.40
Round  20, Train loss: 1.043, Test loss: 1.052, Test accuracy: 59.38
Round  20, Global train loss: 1.043, Global test loss: 0.890, Global test accuracy: 67.80
Round  21, Train loss: 0.914, Test loss: 1.057, Test accuracy: 59.52
Round  21, Global train loss: 0.914, Global test loss: 0.829, Global test accuracy: 71.20
Round  22, Train loss: 1.033, Test loss: 1.071, Test accuracy: 59.62
Round  22, Global train loss: 1.033, Global test loss: 0.986, Global test accuracy: 67.60
Round  23, Train loss: 1.123, Test loss: 1.099, Test accuracy: 59.36
Round  23, Global train loss: 1.123, Global test loss: 0.997, Global test accuracy: 64.60
Round  24, Train loss: 1.012, Test loss: 1.070, Test accuracy: 60.24
Round  24, Global train loss: 1.012, Global test loss: 0.975, Global test accuracy: 67.40
Round  25, Train loss: 1.238, Test loss: 1.063, Test accuracy: 60.28
Round  25, Global train loss: 1.238, Global test loss: 1.073, Global test accuracy: 62.60
Round  26, Train loss: 1.031, Test loss: 1.074, Test accuracy: 59.60
Round  26, Global train loss: 1.031, Global test loss: 0.971, Global test accuracy: 66.40
Round  27, Train loss: 1.159, Test loss: 1.084, Test accuracy: 60.06
Round  27, Global train loss: 1.159, Global test loss: 1.062, Global test accuracy: 60.20
Round  28, Train loss: 0.987, Test loss: 1.087, Test accuracy: 60.72
Round  28, Global train loss: 0.987, Global test loss: 0.923, Global test accuracy: 65.00
Round  29, Train loss: 0.963, Test loss: 1.097, Test accuracy: 59.98
Round  29, Global train loss: 0.963, Global test loss: 0.970, Global test accuracy: 63.40
Round  30, Train loss: 1.122, Test loss: 1.124, Test accuracy: 59.16
Round  30, Global train loss: 1.122, Global test loss: 1.143, Global test accuracy: 59.40
Round  31, Train loss: 0.871, Test loss: 1.097, Test accuracy: 59.20
Round  31, Global train loss: 0.871, Global test loss: 0.892, Global test accuracy: 67.80
Round  32, Train loss: 0.968, Test loss: 1.066, Test accuracy: 60.44
Round  32, Global train loss: 0.968, Global test loss: 0.901, Global test accuracy: 67.00
Round  33, Train loss: 1.033, Test loss: 1.064, Test accuracy: 60.76
Round  33, Global train loss: 1.033, Global test loss: 1.147, Global test accuracy: 59.20
Round  34, Train loss: 0.884, Test loss: 1.093, Test accuracy: 60.58
Round  34, Global train loss: 0.884, Global test loss: 0.977, Global test accuracy: 67.60
Round  35, Train loss: 0.714, Test loss: 1.099, Test accuracy: 60.42
Round  35, Global train loss: 0.714, Global test loss: 0.837, Global test accuracy: 67.60
Round  36, Train loss: 1.001, Test loss: 1.125, Test accuracy: 60.18
Round  36, Global train loss: 1.001, Global test loss: 1.011, Global test accuracy: 61.40
Round  37, Train loss: 0.672, Test loss: 1.132, Test accuracy: 59.14
Round  37, Global train loss: 0.672, Global test loss: 0.865, Global test accuracy: 68.80
Round  38, Train loss: 0.692, Test loss: 1.118, Test accuracy: 60.74
Round  38, Global train loss: 0.692, Global test loss: 0.901, Global test accuracy: 66.40
Round  39, Train loss: 1.128, Test loss: 1.120, Test accuracy: 59.94
Round  39, Global train loss: 1.128, Global test loss: 1.084, Global test accuracy: 60.40
Round  40, Train loss: 0.874, Test loss: 1.161, Test accuracy: 60.04
Round  40, Global train loss: 0.874, Global test loss: 1.049, Global test accuracy: 63.40
Round  41, Train loss: 0.880, Test loss: 1.164, Test accuracy: 60.10
Round  41, Global train loss: 0.880, Global test loss: 0.849, Global test accuracy: 68.80
Round  42, Train loss: 0.837, Test loss: 1.177, Test accuracy: 59.38
Round  42, Global train loss: 0.837, Global test loss: 0.834, Global test accuracy: 66.80
Round  43, Train loss: 0.629, Test loss: 1.171, Test accuracy: 60.24
Round  43, Global train loss: 0.629, Global test loss: 0.752, Global test accuracy: 71.60
Round  44, Train loss: 0.682, Test loss: 1.137, Test accuracy: 60.36
Round  44, Global train loss: 0.682, Global test loss: 0.908, Global test accuracy: 67.60
Round  45, Train loss: 0.882, Test loss: 1.159, Test accuracy: 60.38
Round  45, Global train loss: 0.882, Global test loss: 0.998, Global test accuracy: 62.80
Round  46, Train loss: 0.907, Test loss: 1.170, Test accuracy: 59.92
Round  46, Global train loss: 0.907, Global test loss: 1.127, Global test accuracy: 61.40
Round  47, Train loss: 0.974, Test loss: 1.178, Test accuracy: 59.32
Round  47, Global train loss: 0.974, Global test loss: 1.161, Global test accuracy: 57.40
Round  48, Train loss: 0.645, Test loss: 1.217, Test accuracy: 58.32
Round  48, Global train loss: 0.645, Global test loss: 0.780, Global test accuracy: 70.60
Round  49, Train loss: 0.604, Test loss: 1.256, Test accuracy: 58.66
Round  49, Global train loss: 0.604, Global test loss: 0.930, Global test accuracy: 68.00
Round  50, Train loss: 0.798, Test loss: 1.299, Test accuracy: 57.90
Round  50, Global train loss: 0.798, Global test loss: 0.930, Global test accuracy: 65.60
Round  51, Train loss: 0.573, Test loss: 1.303, Test accuracy: 58.04
Round  51, Global train loss: 0.573, Global test loss: 0.827, Global test accuracy: 69.00
Round  52, Train loss: 0.501, Test loss: 1.318, Test accuracy: 58.06
Round  52, Global train loss: 0.501, Global test loss: 0.864, Global test accuracy: 68.00
Round  53, Train loss: 0.630, Test loss: 1.322, Test accuracy: 58.14
Round  53, Global train loss: 0.630, Global test loss: 0.723, Global test accuracy: 70.00
Round  54, Train loss: 0.754, Test loss: 1.304, Test accuracy: 58.84
Round  54, Global train loss: 0.754, Global test loss: 1.025, Global test accuracy: 61.40
Round  55, Train loss: 0.682, Test loss: 1.323, Test accuracy: 58.04
Round  55, Global train loss: 0.682, Global test loss: 1.003, Global test accuracy: 61.40
Round  56, Train loss: 0.550, Test loss: 1.330, Test accuracy: 57.66
Round  56, Global train loss: 0.550, Global test loss: 0.728, Global test accuracy: 73.80
Round  57, Train loss: 0.492, Test loss: 1.365, Test accuracy: 57.70
Round  57, Global train loss: 0.492, Global test loss: 0.818, Global test accuracy: 70.80
Round  58, Train loss: 0.545, Test loss: 1.341, Test accuracy: 57.58
Round  58, Global train loss: 0.545, Global test loss: 0.785, Global test accuracy: 71.40
Round  59, Train loss: 0.434, Test loss: 1.426, Test accuracy: 57.08
Round  59, Global train loss: 0.434, Global test loss: 0.958, Global test accuracy: 63.60
Round  60, Train loss: 0.638, Test loss: 1.447, Test accuracy: 57.42
Round  60, Global train loss: 0.638, Global test loss: 1.147, Global test accuracy: 55.40
Round  61, Train loss: 0.426, Test loss: 1.430, Test accuracy: 57.98
Round  61, Global train loss: 0.426, Global test loss: 0.967, Global test accuracy: 65.20
Round  62, Train loss: 0.720, Test loss: 1.434, Test accuracy: 58.64
Round  62, Global train loss: 0.720, Global test loss: 0.962, Global test accuracy: 64.20
Round  63, Train loss: 0.635, Test loss: 1.451, Test accuracy: 59.02
Round  63, Global train loss: 0.635, Global test loss: 0.830, Global test accuracy: 71.00
Round  64, Train loss: 0.662, Test loss: 1.496, Test accuracy: 57.60
Round  64, Global train loss: 0.662, Global test loss: 1.141, Global test accuracy: 55.80
Round  65, Train loss: 0.515, Test loss: 1.477, Test accuracy: 57.60
Round  65, Global train loss: 0.515, Global test loss: 0.850, Global test accuracy: 66.00
Round  66, Train loss: 0.315, Test loss: 1.477, Test accuracy: 56.70
Round  66, Global train loss: 0.315, Global test loss: 0.753, Global test accuracy: 71.20
Round  67, Train loss: 0.600, Test loss: 1.522, Test accuracy: 56.46
Round  67, Global train loss: 0.600, Global test loss: 1.152, Global test accuracy: 56.60
Round  68, Train loss: 0.576, Test loss: 1.566, Test accuracy: 56.74
Round  68, Global train loss: 0.576, Global test loss: 0.845, Global test accuracy: 69.20
Round  69, Train loss: 0.450, Test loss: 1.560, Test accuracy: 57.44
Round  69, Global train loss: 0.450, Global test loss: 0.825, Global test accuracy: 70.60
Round  70, Train loss: 0.436, Test loss: 1.566, Test accuracy: 57.52
Round  70, Global train loss: 0.436, Global test loss: 0.761, Global test accuracy: 71.80
Round  71, Train loss: 0.556, Test loss: 1.580, Test accuracy: 57.70
Round  71, Global train loss: 0.556, Global test loss: 1.064, Global test accuracy: 63.20
Round  72, Train loss: 0.446, Test loss: 1.558, Test accuracy: 57.38
Round  72, Global train loss: 0.446, Global test loss: 1.043, Global test accuracy: 61.40
Round  73, Train loss: 0.423, Test loss: 1.615, Test accuracy: 57.56
Round  73, Global train loss: 0.423, Global test loss: 1.008, Global test accuracy: 64.60
Round  74, Train loss: 0.403, Test loss: 1.653, Test accuracy: 58.06
Round  74, Global train loss: 0.403, Global test loss: 0.938, Global test accuracy: 64.20
Round  75, Train loss: 0.260, Test loss: 1.708, Test accuracy: 57.36
Round  75, Global train loss: 0.260, Global test loss: 0.722, Global test accuracy: 75.60
Round  76, Train loss: 0.462, Test loss: 1.768, Test accuracy: 57.18
Round  76, Global train loss: 0.462, Global test loss: 1.058, Global test accuracy: 60.40
Round  77, Train loss: 0.483, Test loss: 1.808, Test accuracy: 57.46
Round  77, Global train loss: 0.483, Global test loss: 1.075, Global test accuracy: 60.80
Round  78, Train loss: 0.376, Test loss: 1.817, Test accuracy: 56.88
Round  78, Global train loss: 0.376, Global test loss: 1.022, Global test accuracy: 62.20
Round  79, Train loss: 0.344, Test loss: 1.842, Test accuracy: 56.68
Round  79, Global train loss: 0.344, Global test loss: 0.957, Global test accuracy: 67.40
Round  80, Train loss: 0.316, Test loss: 1.788, Test accuracy: 56.74
Round  80, Global train loss: 0.316, Global test loss: 0.906, Global test accuracy: 65.80
Round  81, Train loss: 0.251, Test loss: 1.777, Test accuracy: 57.10
Round  81, Global train loss: 0.251, Global test loss: 0.783, Global test accuracy: 73.20
Round  82, Train loss: 0.365, Test loss: 1.785, Test accuracy: 57.10
Round  82, Global train loss: 0.365, Global test loss: 0.793, Global test accuracy: 71.60
Round  83, Train loss: 0.227, Test loss: 1.860, Test accuracy: 56.82
Round  83, Global train loss: 0.227, Global test loss: 0.832, Global test accuracy: 69.60
Round  84, Train loss: 0.343, Test loss: 1.885, Test accuracy: 57.50
Round  84, Global train loss: 0.343, Global test loss: 0.827, Global test accuracy: 69.80
Round  85, Train loss: 0.253, Test loss: 1.930, Test accuracy: 57.46
Round  85, Global train loss: 0.253, Global test loss: 0.847, Global test accuracy: 70.20
Round  86, Train loss: 0.240, Test loss: 1.944, Test accuracy: 56.70
Round  86, Global train loss: 0.240, Global test loss: 0.769, Global test accuracy: 71.60
Round  87, Train loss: 0.357, Test loss: 1.980, Test accuracy: 56.02
Round  87, Global train loss: 0.357, Global test loss: 0.898, Global test accuracy: 69.60
Round  88, Train loss: 0.346, Test loss: 1.947, Test accuracy: 56.18
Round  88, Global train loss: 0.346, Global test loss: 0.837, Global test accuracy: 70.20
Round  89, Train loss: 0.228, Test loss: 1.982, Test accuracy: 56.04
Round  89, Global train loss: 0.228, Global test loss: 0.811, Global test accuracy: 70.00
Round  90, Train loss: 0.302, Test loss: 1.919, Test accuracy: 56.22
Round  90, Global train loss: 0.302, Global test loss: 0.912, Global test accuracy: 64.40
Round  91, Train loss: 0.326, Test loss: 1.938, Test accuracy: 56.42
Round  91, Global train loss: 0.326, Global test loss: 0.968, Global test accuracy: 65.00
Round  92, Train loss: 0.191, Test loss: 1.921, Test accuracy: 56.70
Round  92, Global train loss: 0.191, Global test loss: 0.729, Global test accuracy: 73.80
Round  93, Train loss: 0.280, Test loss: 1.942, Test accuracy: 56.28
Round  93, Global train loss: 0.280, Global test loss: 1.088, Global test accuracy: 59.60
Round  94, Train loss: 0.229, Test loss: 1.940, Test accuracy: 56.86
Round  94, Global train loss: 0.229, Global test loss: 0.920, Global test accuracy: 66.20
Round  95, Train loss: 0.263, Test loss: 1.935, Test accuracy: 57.38
Round  95, Global train loss: 0.263, Global test loss: 0.814, Global test accuracy: 71.00
Round  96, Train loss: 0.251, Test loss: 1.975, Test accuracy: 57.68
Round  96, Global train loss: 0.251, Global test loss: 0.812, Global test accuracy: 72.00
Round  97, Train loss: 0.319, Test loss: 2.002, Test accuracy: 57.38
Round  97, Global train loss: 0.319, Global test loss: 1.034, Global test accuracy: 62.20
Round  98, Train loss: 0.233, Test loss: 2.058, Test accuracy: 56.66
Round  98, Global train loss: 0.233, Global test loss: 0.951, Global test accuracy: 66.40
Round  99, Train loss: 0.204, Test loss: 2.143, Test accuracy: 56.86
Round  99, Global train loss: 0.204, Global test loss: 1.016, Global test accuracy: 64.20
Final Round, Train loss: 0.227, Test loss: 2.199, Test accuracy: 57.86
Final Round, Global train loss: 0.227, Global test loss: 1.016, Global test accuracy: 64.20
Average accuracy final 10 rounds: 56.843999999999994 

Average global accuracy final 10 rounds: 66.48 

1028.3372015953064
[1.8313591480255127, 3.6627182960510254, 5.201702356338501, 6.740686416625977, 8.3178071975708, 9.894927978515625, 11.441509246826172, 12.988090515136719, 14.42434811592102, 15.860605716705322, 17.43293023109436, 19.0052547454834, 20.898470163345337, 22.791685581207275, 24.286140203475952, 25.78059482574463, 27.295345544815063, 28.810096263885498, 30.64587688446045, 32.4816575050354, 34.14456486701965, 35.807472229003906, 37.4107780456543, 39.01408386230469, 40.66925501823425, 42.32442617416382, 43.999364614486694, 45.67430305480957, 47.241270303726196, 48.80823755264282, 50.36550569534302, 51.92277383804321, 53.50232768058777, 55.081881523132324, 56.830209255218506, 58.57853698730469, 60.3116135597229, 62.04469013214111, 63.755401611328125, 65.46611309051514, 67.2107424736023, 68.95537185668945, 70.57697343826294, 72.19857501983643, 74.02980279922485, 75.86103057861328, 77.43444919586182, 79.00786781311035, 80.58829379081726, 82.16871976852417, 83.76149034500122, 85.35426092147827, 86.95471620559692, 88.55517148971558, 90.24003195762634, 91.92489242553711, 93.48266911506653, 95.04044580459595, 96.76491475105286, 98.48938369750977, 100.3030264377594, 102.11666917800903, 103.75057101249695, 105.38447284698486, 107.07522749900818, 108.7659821510315, 110.39112186431885, 112.0162615776062, 113.56893253326416, 115.12160348892212, 116.67606163024902, 118.23051977157593, 119.89459943771362, 121.55867910385132, 123.23176217079163, 124.90484523773193, 126.45503759384155, 128.00522994995117, 129.58407497406006, 131.16291999816895, 132.85468935966492, 134.5464587211609, 136.14901447296143, 137.75157022476196, 139.35149431228638, 140.9514183998108, 142.5378382205963, 144.12425804138184, 145.70213294029236, 147.28000783920288, 148.97193598747253, 150.6638641357422, 152.29212498664856, 153.92038583755493, 155.57573008537292, 157.23107433319092, 158.81198906898499, 160.39290380477905, 162.1028938293457, 163.81288385391235, 165.3857867717743, 166.95868968963623, 168.64394974708557, 170.3292098045349, 171.86369919776917, 173.39818859100342, 175.0295922756195, 176.6609959602356, 178.2098879814148, 179.758780002594, 181.31208038330078, 182.86538076400757, 184.59493613243103, 186.3244915008545, 187.91526985168457, 189.50604820251465, 191.03402423858643, 192.5620002746582, 194.18643617630005, 195.8108720779419, 197.7680242061615, 199.7251763343811, 201.636168718338, 203.54716110229492, 205.26198506355286, 206.9768090248108, 208.62131357192993, 210.26581811904907, 212.0145401954651, 213.7632622718811, 215.3541030883789, 216.9449439048767, 218.65217876434326, 220.35941362380981, 221.9344732761383, 223.5095329284668, 225.2703926563263, 227.0312523841858, 228.61934685707092, 230.20744132995605, 231.9090051651001, 233.61056900024414, 235.23408007621765, 236.85759115219116, 238.54353380203247, 240.22947645187378, 241.90419507026672, 243.57891368865967, 245.18697142601013, 246.7950291633606, 248.5547115802765, 250.31439399719238, 252.02068281173706, 253.72697162628174, 255.37935543060303, 257.0317392349243, 258.53006863594055, 260.0283980369568, 261.64418387413025, 263.2599697113037, 264.8388237953186, 266.4176778793335, 267.86152815818787, 269.30537843704224, 270.8320837020874, 272.35878896713257, 274.0306179523468, 275.70244693756104, 277.26847887039185, 278.83451080322266, 280.5421395301819, 282.2497682571411, 283.89739537239075, 285.5450224876404, 287.15551590919495, 288.7660093307495, 290.37856435775757, 291.9911193847656, 293.69992113113403, 295.40872287750244, 297.0975675582886, 298.7864122390747, 300.44682335853577, 302.1072344779968, 303.661744594574, 305.2162547111511, 306.9080169200897, 308.5997791290283, 310.19947814941406, 311.7991771697998, 313.6125741004944, 315.42597103118896, 317.0825824737549, 318.7391939163208, 320.3033797740936, 321.86756563186646, 323.5349304676056, 325.2022953033447, 326.8621714115143, 328.52204751968384, 331.9351134300232, 335.34817934036255]
[43.38, 43.38, 44.38, 44.38, 47.12, 47.12, 49.56, 49.56, 53.86, 53.86, 54.16, 54.16, 54.26, 54.26, 55.3, 55.3, 55.4, 55.4, 56.62, 56.62, 56.9, 56.9, 57.66, 57.66, 58.14, 58.14, 58.58, 58.58, 58.84, 58.84, 59.32, 59.32, 58.74, 58.74, 58.52, 58.52, 59.02, 59.02, 59.4, 59.4, 59.38, 59.38, 59.52, 59.52, 59.62, 59.62, 59.36, 59.36, 60.24, 60.24, 60.28, 60.28, 59.6, 59.6, 60.06, 60.06, 60.72, 60.72, 59.98, 59.98, 59.16, 59.16, 59.2, 59.2, 60.44, 60.44, 60.76, 60.76, 60.58, 60.58, 60.42, 60.42, 60.18, 60.18, 59.14, 59.14, 60.74, 60.74, 59.94, 59.94, 60.04, 60.04, 60.1, 60.1, 59.38, 59.38, 60.24, 60.24, 60.36, 60.36, 60.38, 60.38, 59.92, 59.92, 59.32, 59.32, 58.32, 58.32, 58.66, 58.66, 57.9, 57.9, 58.04, 58.04, 58.06, 58.06, 58.14, 58.14, 58.84, 58.84, 58.04, 58.04, 57.66, 57.66, 57.7, 57.7, 57.58, 57.58, 57.08, 57.08, 57.42, 57.42, 57.98, 57.98, 58.64, 58.64, 59.02, 59.02, 57.6, 57.6, 57.6, 57.6, 56.7, 56.7, 56.46, 56.46, 56.74, 56.74, 57.44, 57.44, 57.52, 57.52, 57.7, 57.7, 57.38, 57.38, 57.56, 57.56, 58.06, 58.06, 57.36, 57.36, 57.18, 57.18, 57.46, 57.46, 56.88, 56.88, 56.68, 56.68, 56.74, 56.74, 57.1, 57.1, 57.1, 57.1, 56.82, 56.82, 57.5, 57.5, 57.46, 57.46, 56.7, 56.7, 56.02, 56.02, 56.18, 56.18, 56.04, 56.04, 56.22, 56.22, 56.42, 56.42, 56.7, 56.7, 56.28, 56.28, 56.86, 56.86, 57.38, 57.38, 57.68, 57.68, 57.38, 57.38, 56.66, 56.66, 56.86, 56.86, 57.86, 57.86]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.502, Test loss: 1.294, Test accuracy: 45.40
Round   0, Global train loss: 1.502, Global test loss: 1.286, Global test accuracy: 45.20
Round   1, Train loss: 1.341, Test loss: 1.166, Test accuracy: 50.76
Round   1, Global train loss: 1.341, Global test loss: 1.081, Global test accuracy: 53.20
Round   2, Train loss: 1.213, Test loss: 1.063, Test accuracy: 56.54
Round   2, Global train loss: 1.213, Global test loss: 0.946, Global test accuracy: 60.40
Round   3, Train loss: 1.271, Test loss: 1.007, Test accuracy: 60.04
Round   3, Global train loss: 1.271, Global test loss: 0.939, Global test accuracy: 64.20
Round   4, Train loss: 1.200, Test loss: 1.019, Test accuracy: 60.14
Round   4, Global train loss: 1.200, Global test loss: 0.902, Global test accuracy: 64.00
Round   5, Train loss: 1.095, Test loss: 0.976, Test accuracy: 62.34
Round   5, Global train loss: 1.095, Global test loss: 0.804, Global test accuracy: 67.00
Round   6, Train loss: 1.084, Test loss: 0.962, Test accuracy: 63.04
Round   6, Global train loss: 1.084, Global test loss: 0.802, Global test accuracy: 67.80
Round   7, Train loss: 1.238, Test loss: 0.958, Test accuracy: 63.36
Round   7, Global train loss: 1.238, Global test loss: 0.910, Global test accuracy: 70.60
Round   8, Train loss: 1.114, Test loss: 0.934, Test accuracy: 64.56
Round   8, Global train loss: 1.114, Global test loss: 0.823, Global test accuracy: 71.00
Round   9, Train loss: 1.040, Test loss: 0.924, Test accuracy: 65.30
Round   9, Global train loss: 1.040, Global test loss: 0.778, Global test accuracy: 69.40
Round  10, Train loss: 1.002, Test loss: 0.913, Test accuracy: 65.54
Round  10, Global train loss: 1.002, Global test loss: 0.804, Global test accuracy: 69.00
Round  11, Train loss: 0.965, Test loss: 0.917, Test accuracy: 65.32
Round  11, Global train loss: 0.965, Global test loss: 0.813, Global test accuracy: 66.80
Round  12, Train loss: 0.927, Test loss: 0.898, Test accuracy: 66.08
Round  12, Global train loss: 0.927, Global test loss: 0.774, Global test accuracy: 69.80
Round  13, Train loss: 1.029, Test loss: 0.876, Test accuracy: 67.06
Round  13, Global train loss: 1.029, Global test loss: 0.744, Global test accuracy: 72.20
Round  14, Train loss: 1.126, Test loss: 0.876, Test accuracy: 67.22
Round  14, Global train loss: 1.126, Global test loss: 0.861, Global test accuracy: 77.00
Round  15, Train loss: 0.824, Test loss: 0.876, Test accuracy: 68.20
Round  15, Global train loss: 0.824, Global test loss: 0.765, Global test accuracy: 72.00
Round  16, Train loss: 0.753, Test loss: 0.860, Test accuracy: 69.12
Round  16, Global train loss: 0.753, Global test loss: 0.709, Global test accuracy: 73.60
Round  17, Train loss: 1.041, Test loss: 0.858, Test accuracy: 68.82
Round  17, Global train loss: 1.041, Global test loss: 0.767, Global test accuracy: 73.20
Round  18, Train loss: 0.805, Test loss: 0.854, Test accuracy: 69.40
Round  18, Global train loss: 0.805, Global test loss: 0.698, Global test accuracy: 75.20
Round  19, Train loss: 0.926, Test loss: 0.859, Test accuracy: 69.14
Round  19, Global train loss: 0.926, Global test loss: 0.729, Global test accuracy: 75.60
Round  20, Train loss: 0.820, Test loss: 0.861, Test accuracy: 69.78
Round  20, Global train loss: 0.820, Global test loss: 0.671, Global test accuracy: 76.00
Round  21, Train loss: 0.851, Test loss: 0.858, Test accuracy: 69.60
Round  21, Global train loss: 0.851, Global test loss: 0.752, Global test accuracy: 73.80
Round  22, Train loss: 0.729, Test loss: 0.839, Test accuracy: 70.26
Round  22, Global train loss: 0.729, Global test loss: 0.653, Global test accuracy: 76.20
Round  23, Train loss: 0.711, Test loss: 0.845, Test accuracy: 70.34
Round  23, Global train loss: 0.711, Global test loss: 0.720, Global test accuracy: 76.00
Round  24, Train loss: 0.748, Test loss: 0.876, Test accuracy: 70.02
Round  24, Global train loss: 0.748, Global test loss: 0.782, Global test accuracy: 73.60
Round  25, Train loss: 0.583, Test loss: 0.931, Test accuracy: 69.64
Round  25, Global train loss: 0.583, Global test loss: 0.787, Global test accuracy: 72.80
Round  26, Train loss: 0.535, Test loss: 0.926, Test accuracy: 70.10
Round  26, Global train loss: 0.535, Global test loss: 0.781, Global test accuracy: 73.40
Round  27, Train loss: 0.486, Test loss: 0.959, Test accuracy: 68.98
Round  27, Global train loss: 0.486, Global test loss: 0.868, Global test accuracy: 72.20
Round  28, Train loss: 0.478, Test loss: 0.965, Test accuracy: 68.90
Round  28, Global train loss: 0.478, Global test loss: 0.756, Global test accuracy: 75.60
Round  29, Train loss: 0.442, Test loss: 1.021, Test accuracy: 68.52
Round  29, Global train loss: 0.442, Global test loss: 0.879, Global test accuracy: 73.40
Round  30, Train loss: 0.514, Test loss: 1.033, Test accuracy: 68.64
Round  30, Global train loss: 0.514, Global test loss: 0.801, Global test accuracy: 73.40
Round  31, Train loss: 0.470, Test loss: 1.035, Test accuracy: 68.10
Round  31, Global train loss: 0.470, Global test loss: 0.783, Global test accuracy: 74.20
Round  32, Train loss: 0.609, Test loss: 1.031, Test accuracy: 67.60
Round  32, Global train loss: 0.609, Global test loss: 0.814, Global test accuracy: 74.20
Round  33, Train loss: 0.391, Test loss: 1.036, Test accuracy: 68.24
Round  33, Global train loss: 0.391, Global test loss: 0.968, Global test accuracy: 72.60
Round  34, Train loss: 0.455, Test loss: 1.028, Test accuracy: 68.06
Round  34, Global train loss: 0.455, Global test loss: 0.888, Global test accuracy: 71.80
Round  35, Train loss: 0.484, Test loss: 1.078, Test accuracy: 68.38
Round  35, Global train loss: 0.484, Global test loss: 0.851, Global test accuracy: 75.40
Round  36, Train loss: 0.424, Test loss: 1.077, Test accuracy: 68.94
Round  36, Global train loss: 0.424, Global test loss: 0.896, Global test accuracy: 74.00
Round  37, Train loss: 0.415, Test loss: 1.111, Test accuracy: 68.58
Round  37, Global train loss: 0.415, Global test loss: 0.927, Global test accuracy: 73.80
Round  38, Train loss: 0.329, Test loss: 1.095, Test accuracy: 68.84
Round  38, Global train loss: 0.329, Global test loss: 0.917, Global test accuracy: 74.20
Round  39, Train loss: 0.378, Test loss: 1.144, Test accuracy: 68.54
Round  39, Global train loss: 0.378, Global test loss: 0.889, Global test accuracy: 72.40
Round  40, Train loss: 0.310, Test loss: 1.179, Test accuracy: 68.68
Round  40, Global train loss: 0.310, Global test loss: 0.965, Global test accuracy: 72.00
Round  41, Train loss: 0.570, Test loss: 1.149, Test accuracy: 69.00
Round  41, Global train loss: 0.570, Global test loss: 0.721, Global test accuracy: 77.00
Round  42, Train loss: 0.527, Test loss: 1.148, Test accuracy: 69.18
Round  42, Global train loss: 0.527, Global test loss: 0.750, Global test accuracy: 77.20
Round  43, Train loss: 0.522, Test loss: 1.115, Test accuracy: 69.80
Round  43, Global train loss: 0.522, Global test loss: 0.772, Global test accuracy: 77.60
Round  44, Train loss: 0.347, Test loss: 1.105, Test accuracy: 69.86
Round  44, Global train loss: 0.347, Global test loss: 0.782, Global test accuracy: 77.40
Round  45, Train loss: 0.228, Test loss: 1.097, Test accuracy: 70.16
Round  45, Global train loss: 0.228, Global test loss: 0.828, Global test accuracy: 76.60
Round  46, Train loss: 0.219, Test loss: 1.123, Test accuracy: 70.14
Round  46, Global train loss: 0.219, Global test loss: 0.929, Global test accuracy: 75.20
Round  47, Train loss: 0.202, Test loss: 1.114, Test accuracy: 70.60
Round  47, Global train loss: 0.202, Global test loss: 0.977, Global test accuracy: 73.80
Round  48, Train loss: 0.506, Test loss: 1.160, Test accuracy: 69.38
Round  48, Global train loss: 0.506, Global test loss: 0.868, Global test accuracy: 75.40
Round  49, Train loss: 0.264, Test loss: 1.138, Test accuracy: 69.56
Round  49, Global train loss: 0.264, Global test loss: 0.914, Global test accuracy: 76.00
Round  50, Train loss: 0.287, Test loss: 1.156, Test accuracy: 69.70
Round  50, Global train loss: 0.287, Global test loss: 0.914, Global test accuracy: 76.00
Round  51, Train loss: 0.424, Test loss: 1.206, Test accuracy: 68.78
Round  51, Global train loss: 0.424, Global test loss: 0.939, Global test accuracy: 73.40
Round  52, Train loss: 0.230, Test loss: 1.223, Test accuracy: 68.66
Round  52, Global train loss: 0.230, Global test loss: 0.962, Global test accuracy: 73.60
Round  53, Train loss: 0.448, Test loss: 1.278, Test accuracy: 67.68
Round  53, Global train loss: 0.448, Global test loss: 0.959, Global test accuracy: 72.60
Round  54, Train loss: 0.223, Test loss: 1.251, Test accuracy: 68.60
Round  54, Global train loss: 0.223, Global test loss: 1.156, Global test accuracy: 71.60
Round  55, Train loss: 0.186, Test loss: 1.277, Test accuracy: 69.10
Round  55, Global train loss: 0.186, Global test loss: 1.095, Global test accuracy: 74.80
Round  56, Train loss: 0.365, Test loss: 1.282, Test accuracy: 69.48
Round  56, Global train loss: 0.365, Global test loss: 0.962, Global test accuracy: 74.40
Round  57, Train loss: 0.337, Test loss: 1.263, Test accuracy: 69.66
Round  57, Global train loss: 0.337, Global test loss: 0.941, Global test accuracy: 74.40
Round  58, Train loss: 0.239, Test loss: 1.303, Test accuracy: 69.68
Round  58, Global train loss: 0.239, Global test loss: 1.162, Global test accuracy: 72.80
Round  59, Train loss: 0.157, Test loss: 1.300, Test accuracy: 69.46
Round  59, Global train loss: 0.157, Global test loss: 1.145, Global test accuracy: 73.80
Round  60, Train loss: 0.146, Test loss: 1.325, Test accuracy: 69.76
Round  60, Global train loss: 0.146, Global test loss: 1.234, Global test accuracy: 71.00
Round  61, Train loss: 0.113, Test loss: 1.333, Test accuracy: 69.64
Round  61, Global train loss: 0.113, Global test loss: 1.181, Global test accuracy: 75.60
Round  62, Train loss: 0.200, Test loss: 1.351, Test accuracy: 69.70
Round  62, Global train loss: 0.200, Global test loss: 1.038, Global test accuracy: 75.60
Round  63, Train loss: 0.322, Test loss: 1.414, Test accuracy: 69.08
Round  63, Global train loss: 0.322, Global test loss: 0.956, Global test accuracy: 75.20
Round  64, Train loss: 0.115, Test loss: 1.431, Test accuracy: 68.82
Round  64, Global train loss: 0.115, Global test loss: 1.181, Global test accuracy: 73.80
Round  65, Train loss: 0.256, Test loss: 1.396, Test accuracy: 69.66
Round  65, Global train loss: 0.256, Global test loss: 1.096, Global test accuracy: 74.80
Round  66, Train loss: 0.286, Test loss: 1.437, Test accuracy: 69.36
Round  66, Global train loss: 0.286, Global test loss: 1.102, Global test accuracy: 73.20
Round  67, Train loss: 0.120, Test loss: 1.374, Test accuracy: 70.56
Round  67, Global train loss: 0.120, Global test loss: 1.116, Global test accuracy: 74.80
Round  68, Train loss: 0.290, Test loss: 1.414, Test accuracy: 70.64
Round  68, Global train loss: 0.290, Global test loss: 1.085, Global test accuracy: 75.00
Round  69, Train loss: 0.249, Test loss: 1.443, Test accuracy: 70.32
Round  69, Global train loss: 0.249, Global test loss: 1.181, Global test accuracy: 72.00
Round  70, Train loss: 0.321, Test loss: 1.419, Test accuracy: 70.42
Round  70, Global train loss: 0.321, Global test loss: 1.003, Global test accuracy: 75.20
Round  71, Train loss: 0.150, Test loss: 1.456, Test accuracy: 70.78
Round  71, Global train loss: 0.150, Global test loss: 1.277, Global test accuracy: 74.20
Round  72, Train loss: 0.157, Test loss: 1.426, Test accuracy: 69.96
Round  72, Global train loss: 0.157, Global test loss: 1.047, Global test accuracy: 76.00
Round  73, Train loss: 0.115, Test loss: 1.423, Test accuracy: 69.92
Round  73, Global train loss: 0.115, Global test loss: 1.116, Global test accuracy: 75.00
Round  74, Train loss: 0.099, Test loss: 1.388, Test accuracy: 70.20
Round  74, Global train loss: 0.099, Global test loss: 1.179, Global test accuracy: 76.00
Round  75, Train loss: 0.311, Test loss: 1.435, Test accuracy: 69.66
Round  75, Global train loss: 0.311, Global test loss: 1.180, Global test accuracy: 68.60
Round  76, Train loss: 0.121, Test loss: 1.452, Test accuracy: 69.80
Round  76, Global train loss: 0.121, Global test loss: 1.291, Global test accuracy: 73.80
Round  77, Train loss: 0.110, Test loss: 1.473, Test accuracy: 69.44
Round  77, Global train loss: 0.110, Global test loss: 1.294, Global test accuracy: 72.00
Round  78, Train loss: 0.080, Test loss: 1.469, Test accuracy: 70.04
Round  78, Global train loss: 0.080, Global test loss: 1.369, Global test accuracy: 74.60
Round  79, Train loss: 0.174, Test loss: 1.476, Test accuracy: 70.68
Round  79, Global train loss: 0.174, Global test loss: 1.238, Global test accuracy: 72.20
Round  80, Train loss: 0.090, Test loss: 1.487, Test accuracy: 70.60
Round  80, Global train loss: 0.090, Global test loss: 1.279, Global test accuracy: 74.80
Round  81, Train loss: 0.245, Test loss: 1.507, Test accuracy: 70.12
Round  81, Global train loss: 0.245, Global test loss: 1.100, Global test accuracy: 73.40
Round  82, Train loss: 0.164, Test loss: 1.508, Test accuracy: 70.14
Round  82, Global train loss: 0.164, Global test loss: 1.204, Global test accuracy: 73.00
Round  83, Train loss: 0.186, Test loss: 1.509, Test accuracy: 70.26
Round  83, Global train loss: 0.186, Global test loss: 1.154, Global test accuracy: 73.80
Round  84, Train loss: 0.154, Test loss: 1.595, Test accuracy: 69.42
Round  84, Global train loss: 0.154, Global test loss: 1.260, Global test accuracy: 71.40
Round  85, Train loss: 0.193, Test loss: 1.575, Test accuracy: 69.76
Round  85, Global train loss: 0.193, Global test loss: 1.174, Global test accuracy: 74.20
Round  86, Train loss: 0.144, Test loss: 1.578, Test accuracy: 69.86
Round  86, Global train loss: 0.144, Global test loss: 1.274, Global test accuracy: 73.00
Round  87, Train loss: 0.191, Test loss: 1.561, Test accuracy: 69.42
Round  87, Global train loss: 0.191, Global test loss: 1.175, Global test accuracy: 72.60
Round  88, Train loss: 0.157, Test loss: 1.550, Test accuracy: 70.20
Round  88, Global train loss: 0.157, Global test loss: 1.156, Global test accuracy: 73.80
Round  89, Train loss: 0.154, Test loss: 1.527, Test accuracy: 70.64
Round  89, Global train loss: 0.154, Global test loss: 1.181, Global test accuracy: 74.60
Round  90, Train loss: 0.104, Test loss: 1.540, Test accuracy: 70.76
Round  90, Global train loss: 0.104, Global test loss: 1.339, Global test accuracy: 74.20
Round  91, Train loss: 0.101, Test loss: 1.549, Test accuracy: 69.92
Round  91, Global train loss: 0.101, Global test loss: 1.283, Global test accuracy: 75.00
Round  92, Train loss: 0.193, Test loss: 1.570, Test accuracy: 69.26
Round  92, Global train loss: 0.193, Global test loss: 1.310, Global test accuracy: 69.80
Round  93, Train loss: 0.120, Test loss: 1.526, Test accuracy: 69.90
Round  93, Global train loss: 0.120, Global test loss: 1.196, Global test accuracy: 77.40
Round  94, Train loss: 0.061, Test loss: 1.541, Test accuracy: 70.60
Round  94, Global train loss: 0.061, Global test loss: 1.294, Global test accuracy: 76.00
Round  95, Train loss: 0.135, Test loss: 1.557, Test accuracy: 70.14
Round  95, Global train loss: 0.135, Global test loss: 1.212, Global test accuracy: 74.40
Round  96, Train loss: 0.114, Test loss: 1.526, Test accuracy: 70.60
Round  96, Global train loss: 0.114, Global test loss: 1.290, Global test accuracy: 74.00
Round  97, Train loss: 0.095, Test loss: 1.521, Test accuracy: 70.92
Round  97, Global train loss: 0.095, Global test loss: 1.260, Global test accuracy: 76.40
Round  98, Train loss: 0.112, Test loss: 1.508, Test accuracy: 71.24
Round  98, Global train loss: 0.112, Global test loss: 1.146, Global test accuracy: 76.80
Round  99, Train loss: 0.097, Test loss: 1.508, Test accuracy: 71.06
Round  99, Global train loss: 0.097, Global test loss: 1.199, Global test accuracy: 75.80
Final Round, Train loss: 0.096, Test loss: 1.586, Test accuracy: 70.52
Final Round, Global train loss: 0.096, Global test loss: 1.199, Global test accuracy: 75.80
Average accuracy final 10 rounds: 70.44000000000001 

Average global accuracy final 10 rounds: 74.98 

1026.471333026886
[1.9985425472259521, 3.9970850944519043, 5.637342691421509, 7.277600288391113, 8.889196395874023, 10.500792503356934, 12.206624746322632, 13.91245698928833, 15.753833770751953, 17.595210552215576, 19.4854576587677, 21.375704765319824, 23.20167565345764, 25.02764654159546, 26.63740634918213, 28.2471661567688, 29.94640016555786, 31.645634174346924, 33.228397607803345, 34.811161041259766, 36.41342568397522, 38.015690326690674, 39.60460090637207, 41.19351148605347, 42.85856628417969, 44.52362108230591, 46.08640456199646, 47.64918804168701, 49.412699699401855, 51.1762113571167, 52.93889617919922, 54.70158100128174, 56.329458475112915, 57.95733594894409, 59.51190972328186, 61.06648349761963, 62.80227613449097, 64.5380687713623, 66.34300088882446, 68.14793300628662, 69.73353886604309, 71.31914472579956, 73.14697289466858, 74.9748010635376, 76.62754392623901, 78.28028678894043, 79.93196821212769, 81.58364963531494, 83.22371292114258, 84.86377620697021, 86.46774196624756, 88.0717077255249, 89.6565158367157, 91.2413239479065, 92.90488529205322, 94.56844663619995, 96.17935681343079, 97.79026699066162, 99.45242595672607, 101.11458492279053, 102.7008605003357, 104.28713607788086, 105.83318996429443, 107.37924385070801, 108.87783551216125, 110.3764271736145, 112.0433394908905, 113.7102518081665, 115.33416891098022, 116.95808601379395, 118.581857919693, 120.20562982559204, 121.8483338356018, 123.49103784561157, 125.23847913742065, 126.98592042922974, 128.5988166332245, 130.21171283721924, 131.77050161361694, 133.32929039001465, 134.888112783432, 136.44693517684937, 138.00467205047607, 139.56240892410278, 141.18500781059265, 142.80760669708252, 144.45994424819946, 146.1122817993164, 147.71530508995056, 149.31832838058472, 150.8858892917633, 152.4534502029419, 154.0256860256195, 155.59792184829712, 157.05242943763733, 158.50693702697754, 160.2361249923706, 161.96531295776367, 163.61285638809204, 165.2603998184204, 166.8505518436432, 168.44070386886597, 170.1180078983307, 171.7953119277954, 173.57587146759033, 175.35643100738525, 177.07844495773315, 178.80045890808105, 180.5549623966217, 182.30946588516235, 183.9723527431488, 185.63523960113525, 187.31844758987427, 189.00165557861328, 190.48380064964294, 191.9659457206726, 193.51141715049744, 195.05688858032227, 196.72747993469238, 198.3980712890625, 200.02889156341553, 201.65971183776855, 203.32003569602966, 204.98035955429077, 206.5007619857788, 208.02116441726685, 209.69253158569336, 211.36389875411987, 212.98355293273926, 214.60320711135864, 216.10105919837952, 217.5989112854004, 219.13760638237, 220.6763014793396, 222.20330500602722, 223.73030853271484, 225.38398241996765, 227.03765630722046, 228.64925360679626, 230.26085090637207, 231.97342705726624, 233.6860032081604, 235.28897166252136, 236.89194011688232, 238.4917755126953, 240.0916109085083, 241.6280951499939, 243.1645793914795, 244.67735147476196, 246.19012355804443, 247.81012392044067, 249.4301242828369, 251.03401732444763, 252.63791036605835, 254.37677383422852, 256.1156373023987, 257.7194800376892, 259.32332277297974, 260.87497639656067, 262.4266300201416, 264.25073075294495, 266.0748314857483, 267.6743848323822, 269.2739381790161, 270.909423828125, 272.5449094772339, 274.246755361557, 275.9486012458801, 277.4822647571564, 279.0159282684326, 280.65929102897644, 282.30265378952026, 283.86746406555176, 285.43227434158325, 287.0252830982208, 288.6182918548584, 290.31358885765076, 292.0088858604431, 293.7738735675812, 295.53886127471924, 297.2145154476166, 298.8901696205139, 300.64300513267517, 302.3958406448364, 303.98556661605835, 305.5752925872803, 307.1528317928314, 308.73037099838257, 310.3000416755676, 311.8697123527527, 313.43656182289124, 315.0034112930298, 316.73780632019043, 318.4722013473511, 320.21005868911743, 321.9479160308838, 323.48844027519226, 325.02896451950073, 326.442013502121, 327.8550624847412, 331.1645562648773, 334.4740500450134]
[45.4, 45.4, 50.76, 50.76, 56.54, 56.54, 60.04, 60.04, 60.14, 60.14, 62.34, 62.34, 63.04, 63.04, 63.36, 63.36, 64.56, 64.56, 65.3, 65.3, 65.54, 65.54, 65.32, 65.32, 66.08, 66.08, 67.06, 67.06, 67.22, 67.22, 68.2, 68.2, 69.12, 69.12, 68.82, 68.82, 69.4, 69.4, 69.14, 69.14, 69.78, 69.78, 69.6, 69.6, 70.26, 70.26, 70.34, 70.34, 70.02, 70.02, 69.64, 69.64, 70.1, 70.1, 68.98, 68.98, 68.9, 68.9, 68.52, 68.52, 68.64, 68.64, 68.1, 68.1, 67.6, 67.6, 68.24, 68.24, 68.06, 68.06, 68.38, 68.38, 68.94, 68.94, 68.58, 68.58, 68.84, 68.84, 68.54, 68.54, 68.68, 68.68, 69.0, 69.0, 69.18, 69.18, 69.8, 69.8, 69.86, 69.86, 70.16, 70.16, 70.14, 70.14, 70.6, 70.6, 69.38, 69.38, 69.56, 69.56, 69.7, 69.7, 68.78, 68.78, 68.66, 68.66, 67.68, 67.68, 68.6, 68.6, 69.1, 69.1, 69.48, 69.48, 69.66, 69.66, 69.68, 69.68, 69.46, 69.46, 69.76, 69.76, 69.64, 69.64, 69.7, 69.7, 69.08, 69.08, 68.82, 68.82, 69.66, 69.66, 69.36, 69.36, 70.56, 70.56, 70.64, 70.64, 70.32, 70.32, 70.42, 70.42, 70.78, 70.78, 69.96, 69.96, 69.92, 69.92, 70.2, 70.2, 69.66, 69.66, 69.8, 69.8, 69.44, 69.44, 70.04, 70.04, 70.68, 70.68, 70.6, 70.6, 70.12, 70.12, 70.14, 70.14, 70.26, 70.26, 69.42, 69.42, 69.76, 69.76, 69.86, 69.86, 69.42, 69.42, 70.2, 70.2, 70.64, 70.64, 70.76, 70.76, 69.92, 69.92, 69.26, 69.26, 69.9, 69.9, 70.6, 70.6, 70.14, 70.14, 70.6, 70.6, 70.92, 70.92, 71.24, 71.24, 71.06, 71.06, 70.52, 70.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.509, Test loss: 1.360, Test accuracy: 43.48
Round   0, Global train loss: 1.509, Global test loss: 1.357, Global test accuracy: 44.40
Round   1, Train loss: 1.430, Test loss: 1.295, Test accuracy: 48.26
Round   1, Global train loss: 1.430, Global test loss: 1.252, Global test accuracy: 53.20
Round   2, Train loss: 1.341, Test loss: 1.206, Test accuracy: 53.26
Round   2, Global train loss: 1.341, Global test loss: 1.119, Global test accuracy: 59.40
Round   3, Train loss: 1.272, Test loss: 1.142, Test accuracy: 55.08
Round   3, Global train loss: 1.272, Global test loss: 1.054, Global test accuracy: 59.00
Round   4, Train loss: 1.203, Test loss: 1.110, Test accuracy: 56.94
Round   4, Global train loss: 1.203, Global test loss: 0.999, Global test accuracy: 64.20
Round   5, Train loss: 1.238, Test loss: 1.064, Test accuracy: 59.02
Round   5, Global train loss: 1.238, Global test loss: 0.947, Global test accuracy: 66.40
Round   6, Train loss: 1.152, Test loss: 1.034, Test accuracy: 60.32
Round   6, Global train loss: 1.152, Global test loss: 0.870, Global test accuracy: 69.20
Round   7, Train loss: 1.228, Test loss: 1.016, Test accuracy: 61.58
Round   7, Global train loss: 1.228, Global test loss: 0.891, Global test accuracy: 69.60
Round   8, Train loss: 1.067, Test loss: 0.996, Test accuracy: 62.58
Round   8, Global train loss: 1.067, Global test loss: 0.852, Global test accuracy: 67.80
Round   9, Train loss: 1.146, Test loss: 0.992, Test accuracy: 62.30
Round   9, Global train loss: 1.146, Global test loss: 0.908, Global test accuracy: 67.80
Round  10, Train loss: 1.156, Test loss: 0.975, Test accuracy: 63.62
Round  10, Global train loss: 1.156, Global test loss: 0.925, Global test accuracy: 69.40
Round  11, Train loss: 0.941, Test loss: 0.986, Test accuracy: 63.48
Round  11, Global train loss: 0.941, Global test loss: 0.823, Global test accuracy: 67.40
Round  12, Train loss: 1.081, Test loss: 0.954, Test accuracy: 64.30
Round  12, Global train loss: 1.081, Global test loss: 0.853, Global test accuracy: 67.20
Round  13, Train loss: 1.140, Test loss: 0.948, Test accuracy: 65.44
Round  13, Global train loss: 1.140, Global test loss: 0.830, Global test accuracy: 71.40
Round  14, Train loss: 1.104, Test loss: 0.957, Test accuracy: 64.74
Round  14, Global train loss: 1.104, Global test loss: 0.873, Global test accuracy: 70.20
Round  15, Train loss: 1.101, Test loss: 0.967, Test accuracy: 64.34
Round  15, Global train loss: 1.101, Global test loss: 0.890, Global test accuracy: 68.60
Round  16, Train loss: 1.024, Test loss: 0.952, Test accuracy: 64.98
Round  16, Global train loss: 1.024, Global test loss: 0.787, Global test accuracy: 69.60
Round  17, Train loss: 1.085, Test loss: 0.933, Test accuracy: 65.16
Round  17, Global train loss: 1.085, Global test loss: 0.807, Global test accuracy: 71.60
Round  18, Train loss: 0.987, Test loss: 0.895, Test accuracy: 66.68
Round  18, Global train loss: 0.987, Global test loss: 0.802, Global test accuracy: 69.60
Round  19, Train loss: 0.844, Test loss: 0.902, Test accuracy: 66.72
Round  19, Global train loss: 0.844, Global test loss: 0.739, Global test accuracy: 72.00
Round  20, Train loss: 0.832, Test loss: 0.900, Test accuracy: 66.78
Round  20, Global train loss: 0.832, Global test loss: 0.706, Global test accuracy: 72.80
Round  21, Train loss: 0.969, Test loss: 0.909, Test accuracy: 66.00
Round  21, Global train loss: 0.969, Global test loss: 0.837, Global test accuracy: 69.60
Round  22, Train loss: 1.039, Test loss: 0.897, Test accuracy: 66.06
Round  22, Global train loss: 1.039, Global test loss: 0.844, Global test accuracy: 69.20
Round  23, Train loss: 0.813, Test loss: 0.919, Test accuracy: 65.52
Round  23, Global train loss: 0.813, Global test loss: 0.735, Global test accuracy: 73.80
Round  24, Train loss: 0.915, Test loss: 0.925, Test accuracy: 65.58
Round  24, Global train loss: 0.915, Global test loss: 0.857, Global test accuracy: 69.80
Round  25, Train loss: 0.903, Test loss: 0.967, Test accuracy: 65.26
Round  25, Global train loss: 0.903, Global test loss: 0.923, Global test accuracy: 67.20
Round  26, Train loss: 0.819, Test loss: 0.954, Test accuracy: 65.82
Round  26, Global train loss: 0.819, Global test loss: 0.806, Global test accuracy: 69.80
Round  27, Train loss: 0.801, Test loss: 0.976, Test accuracy: 65.44
Round  27, Global train loss: 0.801, Global test loss: 0.961, Global test accuracy: 64.60
Round  28, Train loss: 0.814, Test loss: 0.956, Test accuracy: 65.92
Round  28, Global train loss: 0.814, Global test loss: 0.771, Global test accuracy: 69.60
Round  29, Train loss: 0.837, Test loss: 0.970, Test accuracy: 65.38
Round  29, Global train loss: 0.837, Global test loss: 1.011, Global test accuracy: 64.40
Round  30, Train loss: 0.647, Test loss: 0.992, Test accuracy: 64.96
Round  30, Global train loss: 0.647, Global test loss: 0.818, Global test accuracy: 69.00
Round  31, Train loss: 0.764, Test loss: 1.012, Test accuracy: 64.50
Round  31, Global train loss: 0.764, Global test loss: 0.874, Global test accuracy: 67.80
Round  32, Train loss: 0.563, Test loss: 1.032, Test accuracy: 64.28
Round  32, Global train loss: 0.563, Global test loss: 0.808, Global test accuracy: 70.20
Round  33, Train loss: 0.501, Test loss: 1.053, Test accuracy: 64.52
Round  33, Global train loss: 0.501, Global test loss: 0.882, Global test accuracy: 71.00
Round  34, Train loss: 0.743, Test loss: 1.082, Test accuracy: 64.66
Round  34, Global train loss: 0.743, Global test loss: 1.061, Global test accuracy: 64.40
Round  35, Train loss: 0.629, Test loss: 1.118, Test accuracy: 64.26
Round  35, Global train loss: 0.629, Global test loss: 0.952, Global test accuracy: 69.40
Round  36, Train loss: 0.497, Test loss: 1.146, Test accuracy: 64.14
Round  36, Global train loss: 0.497, Global test loss: 1.117, Global test accuracy: 67.20
Round  37, Train loss: 0.563, Test loss: 1.192, Test accuracy: 63.74
Round  37, Global train loss: 0.563, Global test loss: 1.007, Global test accuracy: 68.20
Round  38, Train loss: 0.549, Test loss: 1.190, Test accuracy: 64.26
Round  38, Global train loss: 0.549, Global test loss: 1.123, Global test accuracy: 66.60
Round  39, Train loss: 0.465, Test loss: 1.231, Test accuracy: 63.82
Round  39, Global train loss: 0.465, Global test loss: 1.043, Global test accuracy: 66.20
Round  40, Train loss: 0.397, Test loss: 1.252, Test accuracy: 63.56
Round  40, Global train loss: 0.397, Global test loss: 0.996, Global test accuracy: 69.00
Round  41, Train loss: 0.592, Test loss: 1.256, Test accuracy: 64.06
Round  41, Global train loss: 0.592, Global test loss: 0.802, Global test accuracy: 70.60
Round  42, Train loss: 0.464, Test loss: 1.224, Test accuracy: 64.42
Round  42, Global train loss: 0.464, Global test loss: 0.860, Global test accuracy: 71.40
Round  43, Train loss: 0.428, Test loss: 1.255, Test accuracy: 64.14
Round  43, Global train loss: 0.428, Global test loss: 0.888, Global test accuracy: 69.60
Round  44, Train loss: 0.568, Test loss: 1.250, Test accuracy: 64.44
Round  44, Global train loss: 0.568, Global test loss: 0.999, Global test accuracy: 67.40
Round  45, Train loss: 0.355, Test loss: 1.274, Test accuracy: 64.60
Round  45, Global train loss: 0.355, Global test loss: 1.091, Global test accuracy: 67.60
Round  46, Train loss: 0.340, Test loss: 1.323, Test accuracy: 64.40
Round  46, Global train loss: 0.340, Global test loss: 1.174, Global test accuracy: 67.60
Round  47, Train loss: 0.362, Test loss: 1.301, Test accuracy: 64.50
Round  47, Global train loss: 0.362, Global test loss: 1.030, Global test accuracy: 68.00
Round  48, Train loss: 0.421, Test loss: 1.308, Test accuracy: 65.08
Round  48, Global train loss: 0.421, Global test loss: 0.894, Global test accuracy: 71.60
Round  49, Train loss: 0.411, Test loss: 1.362, Test accuracy: 64.50
Round  49, Global train loss: 0.411, Global test loss: 1.055, Global test accuracy: 68.00
Round  50, Train loss: 0.316, Test loss: 1.335, Test accuracy: 64.90
Round  50, Global train loss: 0.316, Global test loss: 0.965, Global test accuracy: 70.80
Round  51, Train loss: 0.414, Test loss: 1.370, Test accuracy: 64.34
Round  51, Global train loss: 0.414, Global test loss: 1.031, Global test accuracy: 68.00
Round  52, Train loss: 0.337, Test loss: 1.456, Test accuracy: 63.88
Round  52, Global train loss: 0.337, Global test loss: 1.244, Global test accuracy: 67.60
Round  53, Train loss: 0.346, Test loss: 1.469, Test accuracy: 64.72
Round  53, Global train loss: 0.346, Global test loss: 1.094, Global test accuracy: 72.20
Round  54, Train loss: 0.208, Test loss: 1.428, Test accuracy: 64.46
Round  54, Global train loss: 0.208, Global test loss: 1.289, Global test accuracy: 68.20
Round  55, Train loss: 0.405, Test loss: 1.425, Test accuracy: 64.86
Round  55, Global train loss: 0.405, Global test loss: 1.295, Global test accuracy: 64.60
Round  56, Train loss: 0.414, Test loss: 1.412, Test accuracy: 64.88
Round  56, Global train loss: 0.414, Global test loss: 0.977, Global test accuracy: 68.60
Round  57, Train loss: 0.327, Test loss: 1.489, Test accuracy: 65.52
Round  57, Global train loss: 0.327, Global test loss: 1.074, Global test accuracy: 69.40
Round  58, Train loss: 0.344, Test loss: 1.448, Test accuracy: 65.70
Round  58, Global train loss: 0.344, Global test loss: 1.151, Global test accuracy: 69.00
Round  59, Train loss: 0.277, Test loss: 1.459, Test accuracy: 65.52
Round  59, Global train loss: 0.277, Global test loss: 1.394, Global test accuracy: 65.80
Round  60, Train loss: 0.202, Test loss: 1.470, Test accuracy: 65.90
Round  60, Global train loss: 0.202, Global test loss: 1.373, Global test accuracy: 65.80
Round  61, Train loss: 0.262, Test loss: 1.514, Test accuracy: 64.96
Round  61, Global train loss: 0.262, Global test loss: 1.515, Global test accuracy: 65.40
Round  62, Train loss: 0.238, Test loss: 1.554, Test accuracy: 65.36
Round  62, Global train loss: 0.238, Global test loss: 1.290, Global test accuracy: 65.80
Round  63, Train loss: 0.335, Test loss: 1.530, Test accuracy: 65.24
Round  63, Global train loss: 0.335, Global test loss: 1.006, Global test accuracy: 70.40
Round  64, Train loss: 0.228, Test loss: 1.519, Test accuracy: 64.90
Round  64, Global train loss: 0.228, Global test loss: 1.262, Global test accuracy: 66.00
Round  65, Train loss: 0.273, Test loss: 1.524, Test accuracy: 66.00
Round  65, Global train loss: 0.273, Global test loss: 1.042, Global test accuracy: 72.40
Round  66, Train loss: 0.328, Test loss: 1.464, Test accuracy: 66.08
Round  66, Global train loss: 0.328, Global test loss: 1.080, Global test accuracy: 66.40
Round  67, Train loss: 0.142, Test loss: 1.479, Test accuracy: 66.40
Round  67, Global train loss: 0.142, Global test loss: 1.233, Global test accuracy: 70.40
Round  68, Train loss: 0.265, Test loss: 1.449, Test accuracy: 66.80
Round  68, Global train loss: 0.265, Global test loss: 0.956, Global test accuracy: 71.80
Round  69, Train loss: 0.265, Test loss: 1.434, Test accuracy: 66.72
Round  69, Global train loss: 0.265, Global test loss: 1.037, Global test accuracy: 71.20
Round  70, Train loss: 0.242, Test loss: 1.463, Test accuracy: 66.30
Round  70, Global train loss: 0.242, Global test loss: 0.951, Global test accuracy: 74.00
Round  71, Train loss: 0.148, Test loss: 1.474, Test accuracy: 66.62
Round  71, Global train loss: 0.148, Global test loss: 1.256, Global test accuracy: 71.40
Round  72, Train loss: 0.176, Test loss: 1.416, Test accuracy: 66.72
Round  72, Global train loss: 0.176, Global test loss: 1.172, Global test accuracy: 70.40
Round  73, Train loss: 0.173, Test loss: 1.440, Test accuracy: 67.00
Round  73, Global train loss: 0.173, Global test loss: 1.308, Global test accuracy: 69.80
Round  74, Train loss: 0.250, Test loss: 1.500, Test accuracy: 66.94
Round  74, Global train loss: 0.250, Global test loss: 1.402, Global test accuracy: 66.60
Round  75, Train loss: 0.217, Test loss: 1.493, Test accuracy: 66.70
Round  75, Global train loss: 0.217, Global test loss: 1.088, Global test accuracy: 71.80
Round  76, Train loss: 0.136, Test loss: 1.543, Test accuracy: 66.48
Round  76, Global train loss: 0.136, Global test loss: 1.357, Global test accuracy: 70.20
Round  77, Train loss: 0.113, Test loss: 1.535, Test accuracy: 66.74
Round  77, Global train loss: 0.113, Global test loss: 1.557, Global test accuracy: 69.00
Round  78, Train loss: 0.100, Test loss: 1.574, Test accuracy: 66.40
Round  78, Global train loss: 0.100, Global test loss: 1.533, Global test accuracy: 68.60
Round  79, Train loss: 0.175, Test loss: 1.596, Test accuracy: 67.24
Round  79, Global train loss: 0.175, Global test loss: 1.233, Global test accuracy: 72.60
Round  80, Train loss: 0.177, Test loss: 1.594, Test accuracy: 67.74
Round  80, Global train loss: 0.177, Global test loss: 1.420, Global test accuracy: 68.80
Round  81, Train loss: 0.180, Test loss: 1.591, Test accuracy: 67.66
Round  81, Global train loss: 0.180, Global test loss: 1.154, Global test accuracy: 70.60
Round  82, Train loss: 0.165, Test loss: 1.607, Test accuracy: 67.24
Round  82, Global train loss: 0.165, Global test loss: 1.281, Global test accuracy: 68.80
Round  83, Train loss: 0.144, Test loss: 1.606, Test accuracy: 66.88
Round  83, Global train loss: 0.144, Global test loss: 1.238, Global test accuracy: 70.00
Round  84, Train loss: 0.127, Test loss: 1.583, Test accuracy: 67.38
Round  84, Global train loss: 0.127, Global test loss: 1.204, Global test accuracy: 70.40
Round  85, Train loss: 0.244, Test loss: 1.569, Test accuracy: 67.38
Round  85, Global train loss: 0.244, Global test loss: 1.018, Global test accuracy: 71.00
Round  86, Train loss: 0.136, Test loss: 1.537, Test accuracy: 67.28
Round  86, Global train loss: 0.136, Global test loss: 1.121, Global test accuracy: 73.80
Round  87, Train loss: 0.168, Test loss: 1.581, Test accuracy: 66.70
Round  87, Global train loss: 0.168, Global test loss: 1.229, Global test accuracy: 72.00
Round  88, Train loss: 0.197, Test loss: 1.546, Test accuracy: 67.50
Round  88, Global train loss: 0.197, Global test loss: 1.144, Global test accuracy: 70.80
Round  89, Train loss: 0.195, Test loss: 1.523, Test accuracy: 68.18
Round  89, Global train loss: 0.195, Global test loss: 1.069, Global test accuracy: 71.40
Round  90, Train loss: 0.171, Test loss: 1.582, Test accuracy: 67.28
Round  90, Global train loss: 0.171, Global test loss: 1.420, Global test accuracy: 67.20
Round  91, Train loss: 0.187, Test loss: 1.604, Test accuracy: 67.18
Round  91, Global train loss: 0.187, Global test loss: 1.306, Global test accuracy: 67.60
Round  92, Train loss: 0.144, Test loss: 1.645, Test accuracy: 67.52
Round  92, Global train loss: 0.144, Global test loss: 1.224, Global test accuracy: 75.00
Round  93, Train loss: 0.130, Test loss: 1.644, Test accuracy: 67.46
Round  93, Global train loss: 0.130, Global test loss: 1.287, Global test accuracy: 72.60
Round  94, Train loss: 0.202, Test loss: 1.621, Test accuracy: 66.92
Round  94, Global train loss: 0.202, Global test loss: 1.225, Global test accuracy: 68.00/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.135, Test loss: 1.640, Test accuracy: 66.86
Round  95, Global train loss: 0.135, Global test loss: 1.158, Global test accuracy: 71.00
Round  96, Train loss: 0.120, Test loss: 1.598, Test accuracy: 66.92
Round  96, Global train loss: 0.120, Global test loss: 1.259, Global test accuracy: 71.80
Round  97, Train loss: 0.176, Test loss: 1.584, Test accuracy: 66.58
Round  97, Global train loss: 0.176, Global test loss: 1.226, Global test accuracy: 71.20
Round  98, Train loss: 0.126, Test loss: 1.568, Test accuracy: 66.80
Round  98, Global train loss: 0.126, Global test loss: 1.204, Global test accuracy: 73.80
Round  99, Train loss: 0.068, Test loss: 1.527, Test accuracy: 67.68
Round  99, Global train loss: 0.068, Global test loss: 1.323, Global test accuracy: 73.20
Final Round, Train loss: 0.100, Test loss: 1.665, Test accuracy: 68.20
Final Round, Global train loss: 0.100, Global test loss: 1.323, Global test accuracy: 73.20
Average accuracy final 10 rounds: 67.12 

Average global accuracy final 10 rounds: 71.14 

1043.746245622635
[1.8635163307189941, 3.7270326614379883, 5.5023651123046875, 7.277697563171387, 8.946477890014648, 10.61525821685791, 12.288317680358887, 13.961377143859863, 15.651403665542603, 17.341430187225342, 18.98522162437439, 20.629013061523438, 22.374131202697754, 24.11924934387207, 25.736587285995483, 27.353925228118896, 29.10335087776184, 30.852776527404785, 32.58924174308777, 34.32570695877075, 35.99524545669556, 37.66478395462036, 39.4156494140625, 41.16651487350464, 42.81979990005493, 44.473084926605225, 46.18040156364441, 47.887718200683594, 49.603248834609985, 51.31877946853638, 52.97599387168884, 54.63320827484131, 56.259578466415405, 57.8859486579895, 59.60799837112427, 61.33004808425903, 63.03182673454285, 64.73360538482666, 66.45490670204163, 68.17620801925659, 69.89336228370667, 71.61051654815674, 73.37188863754272, 75.13326072692871, 76.7373399734497, 78.3414192199707, 80.0190646648407, 81.6967101097107, 83.36271953582764, 85.02872896194458, 86.71409940719604, 88.39946985244751, 90.12088012695312, 91.84229040145874, 93.53538846969604, 95.22848653793335, 96.95943117141724, 98.69037580490112, 100.28232955932617, 101.87428331375122, 103.68730449676514, 105.50032567977905, 107.16121768951416, 108.82210969924927, 110.54023146629333, 112.2583532333374, 113.97145366668701, 115.68455410003662, 117.3679735660553, 119.05139303207397, 120.77870583534241, 122.50601863861084, 124.20907258987427, 125.9121265411377, 127.57611274719238, 129.24009895324707, 130.93036794662476, 132.62063694000244, 134.4726254940033, 136.32461404800415, 138.04725003242493, 139.7698860168457, 141.43827271461487, 143.10665941238403, 144.86412906646729, 146.62159872055054, 148.30418944358826, 149.98678016662598, 151.6534984111786, 153.3202166557312, 155.25163769721985, 157.1830587387085, 158.7999939918518, 160.41692924499512, 162.2349603176117, 164.05299139022827, 165.88813829421997, 167.72328519821167, 169.63548159599304, 171.5476779937744, 173.3039951324463, 175.06031227111816, 176.87431144714355, 178.68831062316895, 180.33421993255615, 181.98012924194336, 183.82695078849792, 185.6737723350525, 187.28419709205627, 188.89462184906006, 190.572411775589, 192.25020170211792, 193.991868019104, 195.7335343360901, 197.45935678482056, 199.18517923355103, 200.92320370674133, 202.66122817993164, 204.36543917655945, 206.06965017318726, 207.8784477710724, 209.68724536895752, 211.32210087776184, 212.95695638656616, 214.64740371704102, 216.33785104751587, 218.17734909057617, 220.01684713363647, 221.60755944252014, 223.1982717514038, 224.82139801979065, 226.4445242881775, 228.1036241054535, 229.7627239227295, 231.4843249320984, 233.20592594146729, 234.85145354270935, 236.49698114395142, 238.1298110485077, 239.76264095306396, 241.38828921318054, 243.01393747329712, 244.6927170753479, 246.37149667739868, 248.05537700653076, 249.73925733566284, 251.83845949172974, 253.93766164779663, 255.96742486953735, 257.9971880912781, 259.80602765083313, 261.6148672103882, 263.2735469341278, 264.93222665786743, 266.732182264328, 268.5321378707886, 270.36173248291016, 272.19132709503174, 273.8498320579529, 275.508337020874, 277.3644845485687, 279.2206320762634, 281.02899861335754, 282.83736515045166, 284.71248507499695, 286.58760499954224, 288.25167894363403, 289.91575288772583, 291.7104058265686, 293.5050587654114, 295.13433933258057, 296.76361989974976, 298.6213529109955, 300.4790859222412, 302.08011198043823, 303.68113803863525, 305.470246553421, 307.2593550682068, 309.0263888835907, 310.7934226989746, 312.62421107292175, 314.4549994468689, 316.6632571220398, 318.8715147972107, 320.8246474266052, 322.77778005599976, 324.90016531944275, 327.02255058288574, 328.69402599334717, 330.3655014038086, 332.1056978702545, 333.84589433670044, 335.7047870159149, 337.5636796951294, 339.34783124923706, 341.1319828033447, 343.15411043167114, 345.17623805999756, 346.923214673996, 348.6701912879944, 352.41063928604126, 356.15108728408813]
[43.48, 43.48, 48.26, 48.26, 53.26, 53.26, 55.08, 55.08, 56.94, 56.94, 59.02, 59.02, 60.32, 60.32, 61.58, 61.58, 62.58, 62.58, 62.3, 62.3, 63.62, 63.62, 63.48, 63.48, 64.3, 64.3, 65.44, 65.44, 64.74, 64.74, 64.34, 64.34, 64.98, 64.98, 65.16, 65.16, 66.68, 66.68, 66.72, 66.72, 66.78, 66.78, 66.0, 66.0, 66.06, 66.06, 65.52, 65.52, 65.58, 65.58, 65.26, 65.26, 65.82, 65.82, 65.44, 65.44, 65.92, 65.92, 65.38, 65.38, 64.96, 64.96, 64.5, 64.5, 64.28, 64.28, 64.52, 64.52, 64.66, 64.66, 64.26, 64.26, 64.14, 64.14, 63.74, 63.74, 64.26, 64.26, 63.82, 63.82, 63.56, 63.56, 64.06, 64.06, 64.42, 64.42, 64.14, 64.14, 64.44, 64.44, 64.6, 64.6, 64.4, 64.4, 64.5, 64.5, 65.08, 65.08, 64.5, 64.5, 64.9, 64.9, 64.34, 64.34, 63.88, 63.88, 64.72, 64.72, 64.46, 64.46, 64.86, 64.86, 64.88, 64.88, 65.52, 65.52, 65.7, 65.7, 65.52, 65.52, 65.9, 65.9, 64.96, 64.96, 65.36, 65.36, 65.24, 65.24, 64.9, 64.9, 66.0, 66.0, 66.08, 66.08, 66.4, 66.4, 66.8, 66.8, 66.72, 66.72, 66.3, 66.3, 66.62, 66.62, 66.72, 66.72, 67.0, 67.0, 66.94, 66.94, 66.7, 66.7, 66.48, 66.48, 66.74, 66.74, 66.4, 66.4, 67.24, 67.24, 67.74, 67.74, 67.66, 67.66, 67.24, 67.24, 66.88, 66.88, 67.38, 67.38, 67.38, 67.38, 67.28, 67.28, 66.7, 66.7, 67.5, 67.5, 68.18, 68.18, 67.28, 67.28, 67.18, 67.18, 67.52, 67.52, 67.46, 67.46, 66.92, 66.92, 66.86, 66.86, 66.92, 66.92, 66.58, 66.58, 66.8, 66.8, 67.68, 67.68, 68.2, 68.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.537, Test loss: 1.401, Test accuracy: 43.60
Round   0, Global train loss: 1.537, Global test loss: 1.410, Global test accuracy: 44.60
Round   1, Train loss: 1.476, Test loss: 1.314, Test accuracy: 45.48
Round   1, Global train loss: 1.476, Global test loss: 1.283, Global test accuracy: 47.00
Round   2, Train loss: 1.461, Test loss: 1.258, Test accuracy: 50.18
Round   2, Global train loss: 1.461, Global test loss: 1.234, Global test accuracy: 51.80
Round   3, Train loss: 1.349, Test loss: 1.213, Test accuracy: 53.46
Round   3, Global train loss: 1.349, Global test loss: 1.175, Global test accuracy: 56.20
Round   4, Train loss: 1.252, Test loss: 1.133, Test accuracy: 56.74
Round   4, Global train loss: 1.252, Global test loss: 0.986, Global test accuracy: 62.40
Round   5, Train loss: 1.111, Test loss: 1.135, Test accuracy: 56.56
Round   5, Global train loss: 1.111, Global test loss: 0.948, Global test accuracy: 61.80
Round   6, Train loss: 1.280, Test loss: 1.108, Test accuracy: 58.70
Round   6, Global train loss: 1.280, Global test loss: 1.037, Global test accuracy: 64.80
Round   7, Train loss: 1.010, Test loss: 1.107, Test accuracy: 59.20
Round   7, Global train loss: 1.010, Global test loss: 0.842, Global test accuracy: 65.60
Round   8, Train loss: 1.087, Test loss: 1.073, Test accuracy: 60.30
Round   8, Global train loss: 1.087, Global test loss: 0.894, Global test accuracy: 66.00
Round   9, Train loss: 1.022, Test loss: 1.040, Test accuracy: 61.26
Round   9, Global train loss: 1.022, Global test loss: 0.835, Global test accuracy: 67.00
Round  10, Train loss: 1.047, Test loss: 1.047, Test accuracy: 61.84
Round  10, Global train loss: 1.047, Global test loss: 0.956, Global test accuracy: 65.60
Round  11, Train loss: 1.100, Test loss: 1.056, Test accuracy: 61.74
Round  11, Global train loss: 1.100, Global test loss: 0.966, Global test accuracy: 67.20
Round  12, Train loss: 1.224, Test loss: 1.020, Test accuracy: 63.28
Round  12, Global train loss: 1.224, Global test loss: 0.985, Global test accuracy: 68.20
Round  13, Train loss: 1.018, Test loss: 1.037, Test accuracy: 62.94
Round  13, Global train loss: 1.018, Global test loss: 0.862, Global test accuracy: 66.40
Round  14, Train loss: 0.993, Test loss: 1.020, Test accuracy: 63.46
Round  14, Global train loss: 0.993, Global test loss: 0.841, Global test accuracy: 69.40
Round  15, Train loss: 1.000, Test loss: 0.984, Test accuracy: 64.50
Round  15, Global train loss: 1.000, Global test loss: 0.836, Global test accuracy: 68.00
Round  16, Train loss: 0.978, Test loss: 1.006, Test accuracy: 64.36
Round  16, Global train loss: 0.978, Global test loss: 0.881, Global test accuracy: 66.00
Round  17, Train loss: 0.810, Test loss: 0.982, Test accuracy: 64.80
Round  17, Global train loss: 0.810, Global test loss: 0.784, Global test accuracy: 70.20
Round  18, Train loss: 0.817, Test loss: 0.976, Test accuracy: 64.14
Round  18, Global train loss: 0.817, Global test loss: 0.829, Global test accuracy: 67.40
Round  19, Train loss: 0.799, Test loss: 1.008, Test accuracy: 63.62
Round  19, Global train loss: 0.799, Global test loss: 0.834, Global test accuracy: 67.00
Round  20, Train loss: 0.909, Test loss: 0.977, Test accuracy: 63.56
Round  20, Global train loss: 0.909, Global test loss: 0.762, Global test accuracy: 70.60
Round  21, Train loss: 0.749, Test loss: 0.958, Test accuracy: 64.14
Round  21, Global train loss: 0.749, Global test loss: 0.784, Global test accuracy: 70.60
Round  22, Train loss: 0.819, Test loss: 0.986, Test accuracy: 64.60
Round  22, Global train loss: 0.819, Global test loss: 0.842, Global test accuracy: 67.80
Round  23, Train loss: 0.892, Test loss: 1.028, Test accuracy: 63.00
Round  23, Global train loss: 0.892, Global test loss: 0.885, Global test accuracy: 66.20
Round  24, Train loss: 0.746, Test loss: 0.979, Test accuracy: 63.02
Round  24, Global train loss: 0.746, Global test loss: 0.821, Global test accuracy: 70.20
Round  25, Train loss: 0.894, Test loss: 0.988, Test accuracy: 63.42
Round  25, Global train loss: 0.894, Global test loss: 0.948, Global test accuracy: 62.40
Round  26, Train loss: 0.782, Test loss: 0.994, Test accuracy: 63.28
Round  26, Global train loss: 0.782, Global test loss: 0.837, Global test accuracy: 67.60
Round  27, Train loss: 0.825, Test loss: 1.034, Test accuracy: 61.34
Round  27, Global train loss: 0.825, Global test loss: 0.962, Global test accuracy: 61.40
Round  28, Train loss: 0.704, Test loss: 1.063, Test accuracy: 60.50
Round  28, Global train loss: 0.704, Global test loss: 0.884, Global test accuracy: 66.80
Round  29, Train loss: 0.645, Test loss: 1.095, Test accuracy: 60.18
Round  29, Global train loss: 0.645, Global test loss: 0.933, Global test accuracy: 65.80
Round  30, Train loss: 0.720, Test loss: 1.083, Test accuracy: 61.22
Round  30, Global train loss: 0.720, Global test loss: 0.994, Global test accuracy: 62.00
Round  31, Train loss: 0.574, Test loss: 1.100, Test accuracy: 61.46
Round  31, Global train loss: 0.574, Global test loss: 0.836, Global test accuracy: 70.00
Round  32, Train loss: 0.654, Test loss: 1.119, Test accuracy: 60.96
Round  32, Global train loss: 0.654, Global test loss: 0.892, Global test accuracy: 66.20
Round  33, Train loss: 0.604, Test loss: 1.125, Test accuracy: 61.58
Round  33, Global train loss: 0.604, Global test loss: 1.082, Global test accuracy: 64.00
Round  34, Train loss: 0.551, Test loss: 1.099, Test accuracy: 62.18
Round  34, Global train loss: 0.551, Global test loss: 0.867, Global test accuracy: 67.80
Round  35, Train loss: 0.507, Test loss: 1.076, Test accuracy: 63.56
Round  35, Global train loss: 0.507, Global test loss: 0.749, Global test accuracy: 73.00
Round  36, Train loss: 0.514, Test loss: 1.126, Test accuracy: 62.94
Round  36, Global train loss: 0.514, Global test loss: 1.009, Global test accuracy: 62.00
Round  37, Train loss: 0.433, Test loss: 1.128, Test accuracy: 63.16
Round  37, Global train loss: 0.433, Global test loss: 0.816, Global test accuracy: 70.60
Round  38, Train loss: 0.405, Test loss: 1.180, Test accuracy: 61.82
Round  38, Global train loss: 0.405, Global test loss: 0.939, Global test accuracy: 68.20
Round  39, Train loss: 0.536, Test loss: 1.187, Test accuracy: 62.08
Round  39, Global train loss: 0.536, Global test loss: 1.113, Global test accuracy: 63.60
Round  40, Train loss: 0.475, Test loss: 1.176, Test accuracy: 62.82
Round  40, Global train loss: 0.475, Global test loss: 1.097, Global test accuracy: 64.60
Round  41, Train loss: 0.560, Test loss: 1.245, Test accuracy: 62.58
Round  41, Global train loss: 0.560, Global test loss: 0.898, Global test accuracy: 68.40
Round  42, Train loss: 0.433, Test loss: 1.296, Test accuracy: 61.60
Round  42, Global train loss: 0.433, Global test loss: 0.913, Global test accuracy: 70.20
Round  43, Train loss: 0.393, Test loss: 1.259, Test accuracy: 62.46
Round  43, Global train loss: 0.393, Global test loss: 0.764, Global test accuracy: 73.80
Round  44, Train loss: 0.409, Test loss: 1.232, Test accuracy: 63.14
Round  44, Global train loss: 0.409, Global test loss: 0.840, Global test accuracy: 71.60
Round  45, Train loss: 0.370, Test loss: 1.178, Test accuracy: 64.54
Round  45, Global train loss: 0.370, Global test loss: 1.021, Global test accuracy: 68.80
Round  46, Train loss: 0.404, Test loss: 1.186, Test accuracy: 64.14
Round  46, Global train loss: 0.404, Global test loss: 1.159, Global test accuracy: 61.40
Round  47, Train loss: 0.368, Test loss: 1.252, Test accuracy: 63.20
Round  47, Global train loss: 0.368, Global test loss: 1.373, Global test accuracy: 57.40
Round  48, Train loss: 0.382, Test loss: 1.248, Test accuracy: 63.84
Round  48, Global train loss: 0.382, Global test loss: 0.764, Global test accuracy: 73.00
Round  49, Train loss: 0.324, Test loss: 1.220, Test accuracy: 64.40
Round  49, Global train loss: 0.324, Global test loss: 0.901, Global test accuracy: 70.20
Round  50, Train loss: 0.336, Test loss: 1.214, Test accuracy: 64.74
Round  50, Global train loss: 0.336, Global test loss: 0.979, Global test accuracy: 69.20
Round  51, Train loss: 0.360, Test loss: 1.239, Test accuracy: 64.44
Round  51, Global train loss: 0.360, Global test loss: 0.819, Global test accuracy: 72.00
Round  52, Train loss: 0.230, Test loss: 1.291, Test accuracy: 64.18
Round  52, Global train loss: 0.230, Global test loss: 0.886, Global test accuracy: 74.80
Round  53, Train loss: 0.295, Test loss: 1.321, Test accuracy: 64.10
Round  53, Global train loss: 0.295, Global test loss: 0.864, Global test accuracy: 74.00
Round  54, Train loss: 0.240, Test loss: 1.323, Test accuracy: 64.22
Round  54, Global train loss: 0.240, Global test loss: 1.393, Global test accuracy: 63.20
Round  55, Train loss: 0.233, Test loss: 1.378, Test accuracy: 64.14
Round  55, Global train loss: 0.233, Global test loss: 1.067, Global test accuracy: 70.40
Round  56, Train loss: 0.267, Test loss: 1.378, Test accuracy: 63.98
Round  56, Global train loss: 0.267, Global test loss: 0.775, Global test accuracy: 74.80
Round  57, Train loss: 0.275, Test loss: 1.385, Test accuracy: 64.38
Round  57, Global train loss: 0.275, Global test loss: 0.847, Global test accuracy: 71.40
Round  58, Train loss: 0.212, Test loss: 1.353, Test accuracy: 65.22
Round  58, Global train loss: 0.212, Global test loss: 0.917, Global test accuracy: 74.20
Round  59, Train loss: 0.172, Test loss: 1.355, Test accuracy: 65.70
Round  59, Global train loss: 0.172, Global test loss: 1.144, Global test accuracy: 70.60
Round  60, Train loss: 0.179, Test loss: 1.351, Test accuracy: 65.74
Round  60, Global train loss: 0.179, Global test loss: 1.307, Global test accuracy: 65.40
Round  61, Train loss: 0.208, Test loss: 1.349, Test accuracy: 65.78
Round  61, Global train loss: 0.208, Global test loss: 1.153, Global test accuracy: 69.20
Round  62, Train loss: 0.222, Test loss: 1.347, Test accuracy: 66.32
Round  62, Global train loss: 0.222, Global test loss: 1.216, Global test accuracy: 67.00
Round  63, Train loss: 0.270, Test loss: 1.347, Test accuracy: 66.44
Round  63, Global train loss: 0.270, Global test loss: 0.839, Global test accuracy: 73.40
Round  64, Train loss: 0.213, Test loss: 1.372, Test accuracy: 66.34
Round  64, Global train loss: 0.213, Global test loss: 1.351, Global test accuracy: 65.20
Round  65, Train loss: 0.245, Test loss: 1.368, Test accuracy: 65.78
Round  65, Global train loss: 0.245, Global test loss: 0.967, Global test accuracy: 69.60
Round  66, Train loss: 0.192, Test loss: 1.424, Test accuracy: 65.24
Round  66, Global train loss: 0.192, Global test loss: 0.841, Global test accuracy: 75.40
Round  67, Train loss: 0.181, Test loss: 1.490, Test accuracy: 65.50
Round  67, Global train loss: 0.181, Global test loss: 1.546, Global test accuracy: 65.40
Round  68, Train loss: 0.279, Test loss: 1.539, Test accuracy: 64.98
Round  68, Global train loss: 0.279, Global test loss: 1.012, Global test accuracy: 71.40
Round  69, Train loss: 0.218, Test loss: 1.583, Test accuracy: 64.74
Round  69, Global train loss: 0.218, Global test loss: 1.097, Global test accuracy: 68.60
Round  70, Train loss: 0.275, Test loss: 1.564, Test accuracy: 64.78
Round  70, Global train loss: 0.275, Global test loss: 0.862, Global test accuracy: 75.60
Round  71, Train loss: 0.181, Test loss: 1.568, Test accuracy: 64.28
Round  71, Global train loss: 0.181, Global test loss: 1.574, Global test accuracy: 62.00
Round  72, Train loss: 0.203, Test loss: 1.593, Test accuracy: 64.54
Round  72, Global train loss: 0.203, Global test loss: 1.508, Global test accuracy: 64.00
Round  73, Train loss: 0.165, Test loss: 1.560, Test accuracy: 65.40
Round  73, Global train loss: 0.165, Global test loss: 1.400, Global test accuracy: 67.00
Round  74, Train loss: 0.126, Test loss: 1.508, Test accuracy: 66.30
Round  74, Global train loss: 0.126, Global test loss: 1.149, Global test accuracy: 71.20
Round  75, Train loss: 0.191, Test loss: 1.511, Test accuracy: 66.30
Round  75, Global train loss: 0.191, Global test loss: 0.887, Global test accuracy: 77.40
Round  76, Train loss: 0.154, Test loss: 1.493, Test accuracy: 66.32
Round  76, Global train loss: 0.154, Global test loss: 1.514, Global test accuracy: 64.60
Round  77, Train loss: 0.097, Test loss: 1.485, Test accuracy: 66.58
Round  77, Global train loss: 0.097, Global test loss: 1.566, Global test accuracy: 64.40
Round  78, Train loss: 0.106, Test loss: 1.526, Test accuracy: 66.60
Round  78, Global train loss: 0.106, Global test loss: 1.543, Global test accuracy: 66.80
Round  79, Train loss: 0.132, Test loss: 1.555, Test accuracy: 65.80
Round  79, Global train loss: 0.132, Global test loss: 1.122, Global test accuracy: 72.00
Round  80, Train loss: 0.128, Test loss: 1.576, Test accuracy: 65.34
Round  80, Global train loss: 0.128, Global test loss: 1.227, Global test accuracy: 70.60
Round  81, Train loss: 0.162, Test loss: 1.607, Test accuracy: 64.60
Round  81, Global train loss: 0.162, Global test loss: 0.916, Global test accuracy: 74.80
Round  82, Train loss: 0.140, Test loss: 1.593, Test accuracy: 65.06
Round  82, Global train loss: 0.140, Global test loss: 1.152, Global test accuracy: 71.80
Round  83, Train loss: 0.126, Test loss: 1.608, Test accuracy: 65.46
Round  83, Global train loss: 0.126, Global test loss: 1.257, Global test accuracy: 70.60
Round  84, Train loss: 0.122, Test loss: 1.575, Test accuracy: 66.04
Round  84, Global train loss: 0.122, Global test loss: 1.105, Global test accuracy: 72.20
Round  85, Train loss: 0.174, Test loss: 1.591, Test accuracy: 66.60
Round  85, Global train loss: 0.174, Global test loss: 0.945, Global test accuracy: 74.40
Round  86, Train loss: 0.110, Test loss: 1.622, Test accuracy: 66.70
Round  86, Global train loss: 0.110, Global test loss: 0.944, Global test accuracy: 77.20
Round  87, Train loss: 0.143, Test loss: 1.609, Test accuracy: 66.62
Round  87, Global train loss: 0.143, Global test loss: 1.066, Global test accuracy: 73.20
Round  88, Train loss: 0.132, Test loss: 1.640, Test accuracy: 67.02
Round  88, Global train loss: 0.132, Global test loss: 1.135, Global test accuracy: 73.00
Round  89, Train loss: 0.173, Test loss: 1.684, Test accuracy: 66.22
Round  89, Global train loss: 0.173, Global test loss: 1.062, Global test accuracy: 74.40
Round  90, Train loss: 0.106, Test loss: 1.633, Test accuracy: 66.50
Round  90, Global train loss: 0.106, Global test loss: 1.362, Global test accuracy: 70.20
Round  91, Train loss: 0.125, Test loss: 1.641, Test accuracy: 66.52
Round  91, Global train loss: 0.125, Global test loss: 1.205, Global test accuracy: 71.60
Round  92, Train loss: 0.134, Test loss: 1.668, Test accuracy: 65.92
Round  92, Global train loss: 0.134, Global test loss: 1.013, Global test accuracy: 74.80
Round  93, Train loss: 0.133, Test loss: 1.693, Test accuracy: 66.40
Round  93, Global train loss: 0.133, Global test loss: 1.693, Global test accuracy: 64.40
Round  94, Train loss: 0.108, Test loss: 1.708, Test accuracy: 66.04
Round  94, Global train loss: 0.108, Global test loss: 1.219, Global test accuracy: 73.00
Round  95, Train loss: 0.115, Test loss: 1.692, Test accuracy: 66.28
Round  95, Global train loss: 0.115, Global test loss: 1.185, Global test accuracy: 73.00
Round  96, Train loss: 0.078, Test loss: 1.753, Test accuracy: 66.18
Round  96, Global train loss: 0.078, Global test loss: 1.272, Global test accuracy: 71.60
Round  97, Train loss: 0.175, Test loss: 1.764, Test accuracy: 65.84
Round  97, Global train loss: 0.175, Global test loss: 1.514, Global test accuracy: 66.60
Round  98, Train loss: 0.118, Test loss: 1.752, Test accuracy: 65.46
Round  98, Global train loss: 0.118, Global test loss: 1.259, Global test accuracy: 70.00
Round  99, Train loss: 0.060, Test loss: 1.754, Test accuracy: 66.14
Round  99, Global train loss: 0.060, Global test loss: 1.465, Global test accuracy: 68.60
Final Round, Train loss: 0.113, Test loss: 1.837, Test accuracy: 65.26
Final Round, Global train loss: 0.113, Global test loss: 1.465, Global test accuracy: 68.60
Average accuracy final 10 rounds: 66.128
Average global accuracy final 10 rounds: 70.38
1565.5459368228912
[3.9449453353881836, 8.025793075561523, 11.716085195541382, 15.500535011291504, 19.489288568496704, 23.27690076828003, 27.01930832862854, 30.834179639816284, 34.81481981277466, 38.57710909843445, 42.41284918785095, 46.291534185409546, 50.45125603675842, 54.67522644996643, 59.237422943115234, 63.417298316955566, 67.73793315887451, 71.48091387748718, 75.27049493789673, 79.1039707660675, 83.05599784851074, 86.85399627685547, 90.88913202285767, 95.06552076339722, 98.98995757102966, 103.02468943595886, 107.02262759208679, 111.03039407730103, 114.9627857208252, 119.06720638275146, 122.77470231056213, 126.7103967666626, 130.61915516853333, 134.6822109222412, 138.5521275997162, 142.23564457893372, 146.31767749786377, 150.24508810043335, 154.02276468276978, 158.03111004829407, 162.03390979766846, 165.73499608039856, 169.68177890777588, 173.57342267036438, 177.60112690925598, 181.57731747627258, 185.34906363487244, 189.294855594635, 193.21416330337524, 196.94111323356628, 200.76420283317566, 204.56348276138306, 208.49192428588867, 212.97998356819153, 217.0099561214447, 220.87950944900513, 224.7086136341095, 228.5572588443756, 232.6360239982605, 236.52272081375122, 240.56619834899902, 244.5649881362915, 248.33850193023682, 252.41036653518677, 256.2946901321411, 260.13828325271606, 263.86763215065, 267.75875210762024, 271.62947702407837, 275.3999271392822, 279.5731418132782, 283.46143984794617, 287.2770302295685, 291.093154668808, 294.91129064559937, 298.8793725967407, 302.86609983444214, 306.9229667186737, 310.82809829711914, 314.7759096622467, 318.7365691661835, 322.694269657135, 326.7735323905945, 330.60406398773193, 334.51013231277466, 338.56162691116333, 342.34872579574585, 346.21884322166443, 350.03547739982605, 353.90035343170166, 357.83683800697327, 361.6979646682739, 365.66750383377075, 369.44906663894653, 373.4348237514496, 377.4840853214264, 381.33034467697144, 385.17247104644775, 388.86626720428467, 392.7355418205261, 399.752726316452]
[43.6, 45.48, 50.18, 53.46, 56.74, 56.56, 58.7, 59.2, 60.3, 61.26, 61.84, 61.74, 63.28, 62.94, 63.46, 64.5, 64.36, 64.8, 64.14, 63.62, 63.56, 64.14, 64.6, 63.0, 63.02, 63.42, 63.28, 61.34, 60.5, 60.18, 61.22, 61.46, 60.96, 61.58, 62.18, 63.56, 62.94, 63.16, 61.82, 62.08, 62.82, 62.58, 61.6, 62.46, 63.14, 64.54, 64.14, 63.2, 63.84, 64.4, 64.74, 64.44, 64.18, 64.1, 64.22, 64.14, 63.98, 64.38, 65.22, 65.7, 65.74, 65.78, 66.32, 66.44, 66.34, 65.78, 65.24, 65.5, 64.98, 64.74, 64.78, 64.28, 64.54, 65.4, 66.3, 66.3, 66.32, 66.58, 66.6, 65.8, 65.34, 64.6, 65.06, 65.46, 66.04, 66.6, 66.7, 66.62, 67.02, 66.22, 66.5, 66.52, 65.92, 66.4, 66.04, 66.28, 66.18, 65.84, 65.46, 66.14, 65.26]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.566, Test loss: 1.386, Test accuracy: 41.80
Round   0, Global train loss: 1.566, Global test loss: 1.385, Global test accuracy: 41.60
Round   1, Train loss: 1.442, Test loss: 1.270, Test accuracy: 49.90
Round   1, Global train loss: 1.442, Global test loss: 1.256, Global test accuracy: 49.80
Round   2, Train loss: 1.369, Test loss: 1.162, Test accuracy: 54.84
Round   2, Global train loss: 1.369, Global test loss: 1.136, Global test accuracy: 55.20
Round   3, Train loss: 1.288, Test loss: 1.100, Test accuracy: 57.56
Round   3, Global train loss: 1.288, Global test loss: 1.083, Global test accuracy: 57.20
Round   4, Train loss: 1.277, Test loss: 1.054, Test accuracy: 61.36
Round   4, Global train loss: 1.277, Global test loss: 1.012, Global test accuracy: 61.80
Round   5, Train loss: 1.267, Test loss: 1.022, Test accuracy: 60.78
Round   5, Global train loss: 1.267, Global test loss: 1.029, Global test accuracy: 59.00
Round   6, Train loss: 1.157, Test loss: 0.991, Test accuracy: 61.06
Round   6, Global train loss: 1.157, Global test loss: 0.909, Global test accuracy: 64.60
Round   7, Train loss: 1.173, Test loss: 0.965, Test accuracy: 62.18
Round   7, Global train loss: 1.173, Global test loss: 0.902, Global test accuracy: 63.20
Round   8, Train loss: 1.247, Test loss: 0.976, Test accuracy: 62.82
Round   8, Global train loss: 1.247, Global test loss: 0.953, Global test accuracy: 63.40
Round   9, Train loss: 1.177, Test loss: 0.970, Test accuracy: 63.76
Round   9, Global train loss: 1.177, Global test loss: 0.966, Global test accuracy: 62.20
Round  10, Train loss: 1.061, Test loss: 0.949, Test accuracy: 64.10
Round  10, Global train loss: 1.061, Global test loss: 0.908, Global test accuracy: 63.60
Round  11, Train loss: 1.142, Test loss: 0.930, Test accuracy: 65.94
Round  11, Global train loss: 1.142, Global test loss: 0.884, Global test accuracy: 67.80
Round  12, Train loss: 1.119, Test loss: 0.881, Test accuracy: 67.24
Round  12, Global train loss: 1.119, Global test loss: 0.834, Global test accuracy: 67.60
Round  13, Train loss: 1.160, Test loss: 0.883, Test accuracy: 66.72
Round  13, Global train loss: 1.160, Global test loss: 0.843, Global test accuracy: 70.00
Round  14, Train loss: 1.161, Test loss: 0.868, Test accuracy: 67.16
Round  14, Global train loss: 1.161, Global test loss: 0.844, Global test accuracy: 68.60
Round  15, Train loss: 1.009, Test loss: 0.837, Test accuracy: 68.46
Round  15, Global train loss: 1.009, Global test loss: 0.814, Global test accuracy: 65.40
Round  16, Train loss: 0.961, Test loss: 0.841, Test accuracy: 69.02
Round  16, Global train loss: 0.961, Global test loss: 0.776, Global test accuracy: 69.00
Round  17, Train loss: 1.028, Test loss: 0.834, Test accuracy: 69.04
Round  17, Global train loss: 1.028, Global test loss: 0.764, Global test accuracy: 69.60
Round  18, Train loss: 1.049, Test loss: 0.857, Test accuracy: 68.40
Round  18, Global train loss: 1.049, Global test loss: 0.828, Global test accuracy: 66.00
Round  19, Train loss: 1.142, Test loss: 0.852, Test accuracy: 69.24
Round  19, Global train loss: 1.142, Global test loss: 0.828, Global test accuracy: 71.80
Round  20, Train loss: 0.990, Test loss: 0.809, Test accuracy: 70.58
Round  20, Global train loss: 0.990, Global test loss: 0.712, Global test accuracy: 74.20
Round  21, Train loss: 1.055, Test loss: 0.850, Test accuracy: 70.10
Round  21, Global train loss: 1.055, Global test loss: 0.824, Global test accuracy: 70.00
Round  22, Train loss: 0.920, Test loss: 0.819, Test accuracy: 70.16
Round  22, Global train loss: 0.920, Global test loss: 0.754, Global test accuracy: 70.40
Round  23, Train loss: 1.101, Test loss: 0.867, Test accuracy: 67.78
Round  23, Global train loss: 1.101, Global test loss: 0.826, Global test accuracy: 71.00
Round  24, Train loss: 0.916, Test loss: 0.806, Test accuracy: 69.16
Round  24, Global train loss: 0.916, Global test loss: 0.767, Global test accuracy: 67.60
Round  25, Train loss: 0.973, Test loss: 0.802, Test accuracy: 69.90
Round  25, Global train loss: 0.973, Global test loss: 0.772, Global test accuracy: 70.80
Round  26, Train loss: 0.790, Test loss: 0.802, Test accuracy: 70.84
Round  26, Global train loss: 0.790, Global test loss: 0.751, Global test accuracy: 72.20
Round  27, Train loss: 0.979, Test loss: 0.840, Test accuracy: 69.42
Round  27, Global train loss: 0.979, Global test loss: 0.829, Global test accuracy: 69.00
Round  28, Train loss: 0.752, Test loss: 0.763, Test accuracy: 72.20
Round  28, Global train loss: 0.752, Global test loss: 0.662, Global test accuracy: 74.60
Round  29, Train loss: 0.869, Test loss: 0.820, Test accuracy: 70.76
Round  29, Global train loss: 0.869, Global test loss: 0.800, Global test accuracy: 71.00
Round  30, Train loss: 0.788, Test loss: 0.787, Test accuracy: 72.06
Round  30, Global train loss: 0.788, Global test loss: 0.718, Global test accuracy: 73.20
Round  31, Train loss: 0.757, Test loss: 0.822, Test accuracy: 70.88
Round  31, Global train loss: 0.757, Global test loss: 0.755, Global test accuracy: 73.00
Round  32, Train loss: 0.943, Test loss: 0.802, Test accuracy: 72.08
Round  32, Global train loss: 0.943, Global test loss: 0.743, Global test accuracy: 74.60
Round  33, Train loss: 0.715, Test loss: 0.781, Test accuracy: 72.96
Round  33, Global train loss: 0.715, Global test loss: 0.702, Global test accuracy: 74.00
Round  34, Train loss: 0.823, Test loss: 0.827, Test accuracy: 70.96
Round  34, Global train loss: 0.823, Global test loss: 0.816, Global test accuracy: 70.40
Round  35, Train loss: 0.921, Test loss: 0.785, Test accuracy: 72.12
Round  35, Global train loss: 0.921, Global test loss: 0.767, Global test accuracy: 71.80
Round  36, Train loss: 0.795, Test loss: 0.871, Test accuracy: 68.10
Round  36, Global train loss: 0.795, Global test loss: 0.831, Global test accuracy: 69.00
Round  37, Train loss: 0.866, Test loss: 0.827, Test accuracy: 70.60
Round  37, Global train loss: 0.866, Global test loss: 0.800, Global test accuracy: 71.20
Round  38, Train loss: 0.696, Test loss: 0.835, Test accuracy: 70.54
Round  38, Global train loss: 0.696, Global test loss: 0.793, Global test accuracy: 70.80
Round  39, Train loss: 0.763, Test loss: 0.842, Test accuracy: 69.46
Round  39, Global train loss: 0.763, Global test loss: 0.766, Global test accuracy: 70.40
Round  40, Train loss: 0.655, Test loss: 0.805, Test accuracy: 71.66
Round  40, Global train loss: 0.655, Global test loss: 0.736, Global test accuracy: 73.40
Round  41, Train loss: 0.735, Test loss: 0.734, Test accuracy: 73.84
Round  41, Global train loss: 0.735, Global test loss: 0.637, Global test accuracy: 77.00
Round  42, Train loss: 0.806, Test loss: 0.758, Test accuracy: 73.74
Round  42, Global train loss: 0.806, Global test loss: 0.714, Global test accuracy: 73.80
Round  43, Train loss: 0.903, Test loss: 0.750, Test accuracy: 74.14
Round  43, Global train loss: 0.903, Global test loss: 0.718, Global test accuracy: 75.80
Round  44, Train loss: 0.626, Test loss: 0.812, Test accuracy: 70.78
Round  44, Global train loss: 0.626, Global test loss: 0.765, Global test accuracy: 73.20
Round  45, Train loss: 0.633, Test loss: 0.788, Test accuracy: 72.80
Round  45, Global train loss: 0.633, Global test loss: 0.745, Global test accuracy: 74.00
Round  46, Train loss: 0.527, Test loss: 0.810, Test accuracy: 72.62
Round  46, Global train loss: 0.527, Global test loss: 0.768, Global test accuracy: 72.60
Round  47, Train loss: 0.601, Test loss: 0.944, Test accuracy: 66.64
Round  47, Global train loss: 0.601, Global test loss: 0.893, Global test accuracy: 68.20
Round  48, Train loss: 0.830, Test loss: 0.829, Test accuracy: 71.04
Round  48, Global train loss: 0.830, Global test loss: 0.734, Global test accuracy: 72.20
Round  49, Train loss: 0.518, Test loss: 0.879, Test accuracy: 68.76
Round  49, Global train loss: 0.518, Global test loss: 0.810, Global test accuracy: 69.60
Round  50, Train loss: 0.773, Test loss: 0.891, Test accuracy: 70.44
Round  50, Global train loss: 0.773, Global test loss: 0.824, Global test accuracy: 72.00
Round  51, Train loss: 0.684, Test loss: 0.803, Test accuracy: 71.54
Round  51, Global train loss: 0.684, Global test loss: 0.725, Global test accuracy: 73.00
Round  52, Train loss: 0.645, Test loss: 0.836, Test accuracy: 70.62
Round  52, Global train loss: 0.645, Global test loss: 0.837, Global test accuracy: 70.20
Round  53, Train loss: 0.758, Test loss: 0.888, Test accuracy: 69.60
Round  53, Global train loss: 0.758, Global test loss: 0.799, Global test accuracy: 71.20
Round  54, Train loss: 0.459, Test loss: 0.928, Test accuracy: 68.80
Round  54, Global train loss: 0.459, Global test loss: 0.958, Global test accuracy: 67.40
Round  55, Train loss: 0.532, Test loss: 0.939, Test accuracy: 67.12
Round  55, Global train loss: 0.532, Global test loss: 0.955, Global test accuracy: 66.00
Round  56, Train loss: 0.575, Test loss: 0.804, Test accuracy: 71.98
Round  56, Global train loss: 0.575, Global test loss: 0.766, Global test accuracy: 73.20
Round  57, Train loss: 0.610, Test loss: 0.902, Test accuracy: 68.34
Round  57, Global train loss: 0.610, Global test loss: 0.821, Global test accuracy: 69.80
Round  58, Train loss: 0.646, Test loss: 0.925, Test accuracy: 67.32
Round  58, Global train loss: 0.646, Global test loss: 0.897, Global test accuracy: 67.40
Round  59, Train loss: 0.380, Test loss: 0.910, Test accuracy: 69.58
Round  59, Global train loss: 0.380, Global test loss: 0.965, Global test accuracy: 70.00
Round  60, Train loss: 0.429, Test loss: 1.018, Test accuracy: 68.30
Round  60, Global train loss: 0.429, Global test loss: 1.055, Global test accuracy: 68.20
Round  61, Train loss: 0.381, Test loss: 0.919, Test accuracy: 69.80
Round  61, Global train loss: 0.381, Global test loss: 0.976, Global test accuracy: 69.20
Round  62, Train loss: 0.419, Test loss: 0.976, Test accuracy: 68.06
Round  62, Global train loss: 0.419, Global test loss: 0.919, Global test accuracy: 69.00
Round  63, Train loss: 0.523, Test loss: 0.894, Test accuracy: 70.86
Round  63, Global train loss: 0.523, Global test loss: 0.747, Global test accuracy: 73.60
Round  64, Train loss: 0.397, Test loss: 1.005, Test accuracy: 68.10
Round  64, Global train loss: 0.397, Global test loss: 0.970, Global test accuracy: 69.20
Round  65, Train loss: 0.499, Test loss: 0.934, Test accuracy: 68.62
Round  65, Global train loss: 0.499, Global test loss: 0.835, Global test accuracy: 70.00
Round  66, Train loss: 0.468, Test loss: 0.855, Test accuracy: 71.46
Round  66, Global train loss: 0.468, Global test loss: 0.778, Global test accuracy: 73.00
Round  67, Train loss: 0.312, Test loss: 0.963, Test accuracy: 68.18
Round  67, Global train loss: 0.312, Global test loss: 0.971, Global test accuracy: 68.40
Round  68, Train loss: 0.472, Test loss: 0.861, Test accuracy: 71.50
Round  68, Global train loss: 0.472, Global test loss: 0.740, Global test accuracy: 73.00
Round  69, Train loss: 0.484, Test loss: 0.897, Test accuracy: 70.60
Round  69, Global train loss: 0.484, Global test loss: 0.856, Global test accuracy: 73.00
Round  70, Train loss: 0.615, Test loss: 0.918, Test accuracy: 69.98
Round  70, Global train loss: 0.615, Global test loss: 0.741, Global test accuracy: 72.00
Round  71, Train loss: 0.322, Test loss: 0.898, Test accuracy: 71.34
Round  71, Global train loss: 0.322, Global test loss: 0.858, Global test accuracy: 72.60
Round  72, Train loss: 0.362, Test loss: 0.922, Test accuracy: 69.92
Round  72, Global train loss: 0.362, Global test loss: 0.866, Global test accuracy: 72.20
Round  73, Train loss: 0.349, Test loss: 0.980, Test accuracy: 70.10
Round  73, Global train loss: 0.349, Global test loss: 0.945, Global test accuracy: 71.20
Round  74, Train loss: 0.302, Test loss: 1.010, Test accuracy: 68.08
Round  74, Global train loss: 0.302, Global test loss: 1.074, Global test accuracy: 67.40
Round  75, Train loss: 0.576, Test loss: 0.956, Test accuracy: 69.18
Round  75, Global train loss: 0.576, Global test loss: 0.888, Global test accuracy: 70.40
Round  76, Train loss: 0.278, Test loss: 0.963, Test accuracy: 69.78
Round  76, Global train loss: 0.278, Global test loss: 0.937, Global test accuracy: 71.60
Round  77, Train loss: 0.254, Test loss: 1.032, Test accuracy: 69.32
Round  77, Global train loss: 0.254, Global test loss: 1.102, Global test accuracy: 68.60
Round  78, Train loss: 0.264, Test loss: 1.076, Test accuracy: 66.40
Round  78, Global train loss: 0.264, Global test loss: 1.120, Global test accuracy: 67.00
Round  79, Train loss: 0.333, Test loss: 0.952, Test accuracy: 71.00
Round  79, Global train loss: 0.333, Global test loss: 0.902, Global test accuracy: 72.20
Round  80, Train loss: 0.265, Test loss: 0.979, Test accuracy: 69.46
Round  80, Global train loss: 0.265, Global test loss: 1.026, Global test accuracy: 68.40
Round  81, Train loss: 0.518, Test loss: 0.950, Test accuracy: 71.36
Round  81, Global train loss: 0.518, Global test loss: 0.788, Global test accuracy: 73.60
Round  82, Train loss: 0.337, Test loss: 1.036, Test accuracy: 69.60
Round  82, Global train loss: 0.337, Global test loss: 0.966, Global test accuracy: 72.60
Round  83, Train loss: 0.335, Test loss: 1.011, Test accuracy: 69.44
Round  83, Global train loss: 0.335, Global test loss: 0.916, Global test accuracy: 71.20
Round  84, Train loss: 0.315, Test loss: 1.050, Test accuracy: 70.46
Round  84, Global train loss: 0.315, Global test loss: 0.992, Global test accuracy: 70.20
Round  85, Train loss: 0.344, Test loss: 0.985, Test accuracy: 71.26
Round  85, Global train loss: 0.344, Global test loss: 0.796, Global test accuracy: 75.20
Round  86, Train loss: 0.419, Test loss: 1.054, Test accuracy: 68.72
Round  86, Global train loss: 0.419, Global test loss: 0.887, Global test accuracy: 71.40
Round  87, Train loss: 0.303, Test loss: 1.094, Test accuracy: 68.70
Round  87, Global train loss: 0.303, Global test loss: 0.959, Global test accuracy: 70.40
Round  88, Train loss: 0.327, Test loss: 1.102, Test accuracy: 68.20
Round  88, Global train loss: 0.327, Global test loss: 0.872, Global test accuracy: 71.80
Round  89, Train loss: 0.308, Test loss: 0.946, Test accuracy: 72.24
Round  89, Global train loss: 0.308, Global test loss: 0.799, Global test accuracy: 76.00
Round  90, Train loss: 0.301, Test loss: 1.054, Test accuracy: 70.14
Round  90, Global train loss: 0.301, Global test loss: 1.052, Global test accuracy: 69.00
Round  91, Train loss: 0.225, Test loss: 1.053, Test accuracy: 71.56
Round  91, Global train loss: 0.225, Global test loss: 1.002, Global test accuracy: 71.80
Round  92, Train loss: 0.423, Test loss: 1.035, Test accuracy: 68.90
Round  92, Global train loss: 0.423, Global test loss: 0.938, Global test accuracy: 69.60
Round  93, Train loss: 0.267, Test loss: 1.065, Test accuracy: 67.30
Round  93, Global train loss: 0.267, Global test loss: 1.009, Global test accuracy: 69.80
Round  94, Train loss: 0.227, Test loss: 1.026, Test accuracy: 69.90
Round  94, Global train loss: 0.227, Global test loss: 0.995, Global test accuracy: 70.80
Round  95, Train loss: 0.295, Test loss: 1.087, Test accuracy: 69.40
Round  95, Global train loss: 0.295, Global test loss: 0.921, Global test accuracy: 71.80
Round  96, Train loss: 0.251, Test loss: 1.122, Test accuracy: 68.68
Round  96, Global train loss: 0.251, Global test loss: 1.048, Global test accuracy: 70.00
Round  97, Train loss: 0.255, Test loss: 1.067, Test accuracy: 69.44
Round  97, Global train loss: 0.255, Global test loss: 0.960, Global test accuracy: 70.20
Round  98, Train loss: 0.308, Test loss: 1.226, Test accuracy: 67.34
Round  98, Global train loss: 0.308, Global test loss: 1.046, Global test accuracy: 69.80
Round  99, Train loss: 0.257, Test loss: 1.201, Test accuracy: 68.60
Round  99, Global train loss: 0.257, Global test loss: 1.112, Global test accuracy: 69.60
Final Round, Train loss: 0.181, Test loss: 1.218, Test accuracy: 69.00
Final Round, Global train loss: 0.181, Global test loss: 1.112, Global test accuracy: 69.60
Average accuracy final 10 rounds: 69.126
934.3779389858246
[2.6449625492095947, 4.531756162643433, 6.485201597213745, 8.364105224609375, 10.148994207382202, 12.00017523765564, 13.88597822189331, 15.897342920303345, 17.697173357009888, 19.90017557144165, 22.074662685394287, 24.270042419433594, 26.58190655708313, 28.92567491531372, 31.188941955566406, 33.02696466445923, 34.88369393348694, 36.79645848274231, 38.60716652870178, 40.50037717819214, 42.31848192214966, 44.17867922782898, 46.00738453865051, 47.907774925231934, 49.63064193725586, 51.49395513534546, 53.24997329711914, 55.10266065597534, 56.97271966934204, 58.88313937187195, 60.758514404296875, 62.7591712474823, 64.92860317230225, 67.02603673934937, 68.94936323165894, 70.76649332046509, 72.62661695480347, 74.41141772270203, 76.25452208518982, 78.0929856300354, 80.0061674118042, 81.99431586265564, 83.91821122169495, 85.81435799598694, 87.80696702003479, 89.7747368812561, 91.76804184913635, 93.67694473266602, 96.24869275093079, 98.28773474693298, 100.10720086097717, 102.01683282852173, 103.88876032829285, 105.90309023857117, 107.70583009719849, 109.65318536758423, 111.66158366203308, 113.44991207122803, 115.59772372245789, 117.47534656524658, 119.38593435287476, 121.30028581619263, 123.16636252403259, 125.05228996276855, 126.94300246238708, 128.76511025428772, 130.6889476776123, 132.69382166862488, 134.6125385761261, 136.73999977111816, 138.61532425880432, 140.42516446113586, 142.5629391670227, 144.50104641914368, 146.38784384727478, 148.1456401348114, 150.15485787391663, 151.9187924861908, 153.73632264137268, 155.56251645088196, 157.47504234313965, 159.34345889091492, 161.2924873828888, 163.17540168762207, 165.09773921966553, 167.00475239753723, 168.82317686080933, 170.65101718902588, 172.55038213729858, 174.3327043056488, 176.18745803833008, 178.086030960083, 179.99632740020752, 181.89768505096436, 183.79503393173218, 185.63275814056396, 187.50010180473328, 189.62134432792664, 191.6743221282959, 193.59698629379272, 196.55067420005798]
[41.8, 49.9, 54.84, 57.56, 61.36, 60.78, 61.06, 62.18, 62.82, 63.76, 64.1, 65.94, 67.24, 66.72, 67.16, 68.46, 69.02, 69.04, 68.4, 69.24, 70.58, 70.1, 70.16, 67.78, 69.16, 69.9, 70.84, 69.42, 72.2, 70.76, 72.06, 70.88, 72.08, 72.96, 70.96, 72.12, 68.1, 70.6, 70.54, 69.46, 71.66, 73.84, 73.74, 74.14, 70.78, 72.8, 72.62, 66.64, 71.04, 68.76, 70.44, 71.54, 70.62, 69.6, 68.8, 67.12, 71.98, 68.34, 67.32, 69.58, 68.3, 69.8, 68.06, 70.86, 68.1, 68.62, 71.46, 68.18, 71.5, 70.6, 69.98, 71.34, 69.92, 70.1, 68.08, 69.18, 69.78, 69.32, 66.4, 71.0, 69.46, 71.36, 69.6, 69.44, 70.46, 71.26, 68.72, 68.7, 68.2, 72.24, 70.14, 71.56, 68.9, 67.3, 69.9, 69.4, 68.68, 69.44, 67.34, 68.6, 69.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.593, Test loss: 1.461, Test accuracy: 41.66
Round   0, Global train loss: 1.593, Global test loss: 1.457, Global test accuracy: 43.00
Round   1, Train loss: 1.463, Test loss: 1.269, Test accuracy: 50.02
Round   1, Global train loss: 1.463, Global test loss: 1.253, Global test accuracy: 52.20
Round   2, Train loss: 1.383, Test loss: 1.181, Test accuracy: 53.92
Round   2, Global train loss: 1.383, Global test loss: 1.159, Global test accuracy: 55.80
Round   3, Train loss: 1.340, Test loss: 1.117, Test accuracy: 57.22
Round   3, Global train loss: 1.340, Global test loss: 1.092, Global test accuracy: 58.00
Round   4, Train loss: 1.297, Test loss: 1.051, Test accuracy: 60.80
Round   4, Global train loss: 1.297, Global test loss: 1.022, Global test accuracy: 61.80
Round   5, Train loss: 1.259, Test loss: 1.008, Test accuracy: 61.80
Round   5, Global train loss: 1.259, Global test loss: 0.974, Global test accuracy: 62.60
Round   6, Train loss: 1.226, Test loss: 0.957, Test accuracy: 63.16
Round   6, Global train loss: 1.226, Global test loss: 0.920, Global test accuracy: 64.00
Round   7, Train loss: 1.198, Test loss: 0.959, Test accuracy: 63.44
Round   7, Global train loss: 1.198, Global test loss: 0.916, Global test accuracy: 65.00
Round   8, Train loss: 1.181, Test loss: 0.947, Test accuracy: 64.80
Round   8, Global train loss: 1.181, Global test loss: 0.905, Global test accuracy: 64.80
Round   9, Train loss: 1.162, Test loss: 0.910, Test accuracy: 64.98
Round   9, Global train loss: 1.162, Global test loss: 0.864, Global test accuracy: 65.00
Round  10, Train loss: 1.067, Test loss: 0.908, Test accuracy: 66.68
Round  10, Global train loss: 1.067, Global test loss: 0.865, Global test accuracy: 66.20
Round  11, Train loss: 1.130, Test loss: 0.929, Test accuracy: 64.84
Round  11, Global train loss: 1.130, Global test loss: 0.927, Global test accuracy: 64.60
Round  12, Train loss: 1.062, Test loss: 0.944, Test accuracy: 64.30
Round  12, Global train loss: 1.062, Global test loss: 0.878, Global test accuracy: 65.20
Round  13, Train loss: 0.981, Test loss: 0.889, Test accuracy: 66.06
Round  13, Global train loss: 0.981, Global test loss: 0.779, Global test accuracy: 68.20
Round  14, Train loss: 1.060, Test loss: 1.021, Test accuracy: 62.32
Round  14, Global train loss: 1.060, Global test loss: 0.907, Global test accuracy: 65.20
Round  15, Train loss: 1.020, Test loss: 0.899, Test accuracy: 65.92
Round  15, Global train loss: 1.020, Global test loss: 0.862, Global test accuracy: 64.00
Round  16, Train loss: 0.914, Test loss: 0.921, Test accuracy: 64.70
Round  16, Global train loss: 0.914, Global test loss: 0.875, Global test accuracy: 66.00
Round  17, Train loss: 0.993, Test loss: 0.930, Test accuracy: 63.56
Round  17, Global train loss: 0.993, Global test loss: 0.845, Global test accuracy: 65.40
Round  18, Train loss: 1.005, Test loss: 0.892, Test accuracy: 67.20
Round  18, Global train loss: 1.005, Global test loss: 0.830, Global test accuracy: 66.40
Round  19, Train loss: 1.068, Test loss: 0.899, Test accuracy: 66.44
Round  19, Global train loss: 1.068, Global test loss: 0.835, Global test accuracy: 69.80
Round  20, Train loss: 0.957, Test loss: 0.866, Test accuracy: 68.26
Round  20, Global train loss: 0.957, Global test loss: 0.789, Global test accuracy: 72.40
Round  21, Train loss: 1.020, Test loss: 0.926, Test accuracy: 65.06
Round  21, Global train loss: 1.020, Global test loss: 0.886, Global test accuracy: 65.00
Round  22, Train loss: 0.885, Test loss: 0.872, Test accuracy: 66.72
Round  22, Global train loss: 0.885, Global test loss: 0.779, Global test accuracy: 69.00
Round  23, Train loss: 0.978, Test loss: 0.941, Test accuracy: 64.74
Round  23, Global train loss: 0.978, Global test loss: 0.889, Global test accuracy: 67.60
Round  24, Train loss: 0.918, Test loss: 0.891, Test accuracy: 66.92
Round  24, Global train loss: 0.918, Global test loss: 0.850, Global test accuracy: 65.80
Round  25, Train loss: 0.824, Test loss: 0.819, Test accuracy: 68.58
Round  25, Global train loss: 0.824, Global test loss: 0.779, Global test accuracy: 68.00
Round  26, Train loss: 0.840, Test loss: 0.787, Test accuracy: 71.78
Round  26, Global train loss: 0.840, Global test loss: 0.733, Global test accuracy: 74.00
Round  27, Train loss: 0.803, Test loss: 0.831, Test accuracy: 68.82
Round  27, Global train loss: 0.803, Global test loss: 0.823, Global test accuracy: 67.40
Round  28, Train loss: 0.717, Test loss: 0.792, Test accuracy: 70.30
Round  28, Global train loss: 0.717, Global test loss: 0.707, Global test accuracy: 72.40
Round  29, Train loss: 0.728, Test loss: 0.822, Test accuracy: 69.76
Round  29, Global train loss: 0.728, Global test loss: 0.796, Global test accuracy: 69.80
Round  30, Train loss: 0.834, Test loss: 0.828, Test accuracy: 69.46
Round  30, Global train loss: 0.834, Global test loss: 0.772, Global test accuracy: 71.80
Round  31, Train loss: 0.710, Test loss: 0.798, Test accuracy: 72.00
Round  31, Global train loss: 0.710, Global test loss: 0.722, Global test accuracy: 73.20
Round  32, Train loss: 0.957, Test loss: 0.863, Test accuracy: 68.74
Round  32, Global train loss: 0.957, Global test loss: 0.836, Global test accuracy: 70.80
Round  33, Train loss: 0.797, Test loss: 0.860, Test accuracy: 68.30
Round  33, Global train loss: 0.797, Global test loss: 0.805, Global test accuracy: 72.60
Round  34, Train loss: 0.708, Test loss: 0.853, Test accuracy: 68.92
Round  34, Global train loss: 0.708, Global test loss: 0.836, Global test accuracy: 68.20
Round  35, Train loss: 0.787, Test loss: 0.888, Test accuracy: 67.42
Round  35, Global train loss: 0.787, Global test loss: 0.890, Global test accuracy: 65.40
Round  36, Train loss: 0.795, Test loss: 0.962, Test accuracy: 64.56
Round  36, Global train loss: 0.795, Global test loss: 0.942, Global test accuracy: 64.00
Round  37, Train loss: 0.782, Test loss: 0.857, Test accuracy: 68.94
Round  37, Global train loss: 0.782, Global test loss: 0.809, Global test accuracy: 69.60
Round  38, Train loss: 0.657, Test loss: 0.871, Test accuracy: 68.34
Round  38, Global train loss: 0.657, Global test loss: 0.823, Global test accuracy: 68.80
Round  39, Train loss: 0.733, Test loss: 0.827, Test accuracy: 70.34
Round  39, Global train loss: 0.733, Global test loss: 0.789, Global test accuracy: 72.00
Round  40, Train loss: 0.708, Test loss: 0.903, Test accuracy: 68.30
Round  40, Global train loss: 0.708, Global test loss: 0.880, Global test accuracy: 68.80
Round  41, Train loss: 0.714, Test loss: 0.763, Test accuracy: 72.92
Round  41, Global train loss: 0.714, Global test loss: 0.721, Global test accuracy: 73.80
Round  42, Train loss: 0.745, Test loss: 0.824, Test accuracy: 70.66
Round  42, Global train loss: 0.745, Global test loss: 0.774, Global test accuracy: 72.00
Round  43, Train loss: 0.803, Test loss: 0.865, Test accuracy: 68.10
Round  43, Global train loss: 0.803, Global test loss: 0.788, Global test accuracy: 71.20
Round  44, Train loss: 0.620, Test loss: 0.789, Test accuracy: 72.04
Round  44, Global train loss: 0.620, Global test loss: 0.722, Global test accuracy: 73.40
Round  45, Train loss: 0.572, Test loss: 0.827, Test accuracy: 70.68
Round  45, Global train loss: 0.572, Global test loss: 0.811, Global test accuracy: 71.40
Round  46, Train loss: 0.515, Test loss: 0.792, Test accuracy: 71.20
Round  46, Global train loss: 0.515, Global test loss: 0.763, Global test accuracy: 73.00
Round  47, Train loss: 0.519, Test loss: 0.829, Test accuracy: 70.06
Round  47, Global train loss: 0.519, Global test loss: 0.785, Global test accuracy: 71.20
Round  48, Train loss: 0.710, Test loss: 0.836, Test accuracy: 70.14
Round  48, Global train loss: 0.710, Global test loss: 0.786, Global test accuracy: 71.80
Round  49, Train loss: 0.565, Test loss: 0.839, Test accuracy: 71.12
Round  49, Global train loss: 0.565, Global test loss: 0.787, Global test accuracy: 72.60
Round  50, Train loss: 0.678, Test loss: 0.907, Test accuracy: 68.18
Round  50, Global train loss: 0.678, Global test loss: 0.816, Global test accuracy: 71.40
Round  51, Train loss: 0.616, Test loss: 0.865, Test accuracy: 69.08
Round  51, Global train loss: 0.616, Global test loss: 0.794, Global test accuracy: 71.40
Round  52, Train loss: 0.548, Test loss: 0.885, Test accuracy: 69.20
Round  52, Global train loss: 0.548, Global test loss: 0.875, Global test accuracy: 67.80
Round  53, Train loss: 0.705, Test loss: 0.862, Test accuracy: 69.66
Round  53, Global train loss: 0.705, Global test loss: 0.792, Global test accuracy: 71.00
Round  54, Train loss: 0.514, Test loss: 1.025, Test accuracy: 63.80
Round  54, Global train loss: 0.514, Global test loss: 1.005, Global test accuracy: 62.40
Round  55, Train loss: 0.450, Test loss: 0.850, Test accuracy: 70.80
Round  55, Global train loss: 0.450, Global test loss: 0.850, Global test accuracy: 70.20
Round  56, Train loss: 0.509, Test loss: 0.795, Test accuracy: 72.60
Round  56, Global train loss: 0.509, Global test loss: 0.749, Global test accuracy: 73.00
Round  57, Train loss: 0.562, Test loss: 0.868, Test accuracy: 69.66
Round  57, Global train loss: 0.562, Global test loss: 0.798, Global test accuracy: 70.80
Round  58, Train loss: 0.470, Test loss: 0.924, Test accuracy: 67.32
Round  58, Global train loss: 0.470, Global test loss: 0.902, Global test accuracy: 68.60
Round  59, Train loss: 0.367, Test loss: 0.884, Test accuracy: 70.74
Round  59, Global train loss: 0.367, Global test loss: 0.890, Global test accuracy: 71.00
Round  60, Train loss: 0.387, Test loss: 0.967, Test accuracy: 67.82
Round  60, Global train loss: 0.387, Global test loss: 0.959, Global test accuracy: 68.80
Round  61, Train loss: 0.304, Test loss: 0.896, Test accuracy: 71.32
Round  61, Global train loss: 0.304, Global test loss: 0.950, Global test accuracy: 71.20
Round  62, Train loss: 0.411, Test loss: 0.884, Test accuracy: 70.22
Round  62, Global train loss: 0.411, Global test loss: 0.856, Global test accuracy: 70.80
Round  63, Train loss: 0.448, Test loss: 0.833, Test accuracy: 70.96
Round  63, Global train loss: 0.448, Global test loss: 0.750, Global test accuracy: 73.20
Round  64, Train loss: 0.334, Test loss: 0.862, Test accuracy: 71.58
Round  64, Global train loss: 0.334, Global test loss: 0.817, Global test accuracy: 73.20
Round  65, Train loss: 0.406, Test loss: 0.870, Test accuracy: 71.22
Round  65, Global train loss: 0.406, Global test loss: 0.803, Global test accuracy: 72.20
Round  66, Train loss: 0.414, Test loss: 0.802, Test accuracy: 72.58
Round  66, Global train loss: 0.414, Global test loss: 0.739, Global test accuracy: 74.60
Round  67, Train loss: 0.317, Test loss: 0.843, Test accuracy: 72.68
Round  67, Global train loss: 0.317, Global test loss: 0.825, Global test accuracy: 74.60
Round  68, Train loss: 0.466, Test loss: 0.875, Test accuracy: 71.22
Round  68, Global train loss: 0.466, Global test loss: 0.777, Global test accuracy: 74.00
Round  69, Train loss: 0.432, Test loss: 0.895, Test accuracy: 70.20
Round  69, Global train loss: 0.432, Global test loss: 0.858, Global test accuracy: 71.20
Round  70, Train loss: 0.537, Test loss: 0.854, Test accuracy: 70.68
Round  70, Global train loss: 0.537, Global test loss: 0.752, Global test accuracy: 73.20
Round  71, Train loss: 0.351, Test loss: 1.044, Test accuracy: 65.96
Round  71, Global train loss: 0.351, Global test loss: 1.016, Global test accuracy: 66.00
Round  72, Train loss: 0.372, Test loss: 0.964, Test accuracy: 67.88
Round  72, Global train loss: 0.372, Global test loss: 0.923, Global test accuracy: 68.40
Round  73, Train loss: 0.343, Test loss: 0.967, Test accuracy: 69.90
Round  73, Global train loss: 0.343, Global test loss: 0.937, Global test accuracy: 70.80
Round  74, Train loss: 0.245, Test loss: 0.917, Test accuracy: 71.12
Round  74, Global train loss: 0.245, Global test loss: 0.942, Global test accuracy: 71.20
Round  75, Train loss: 0.501, Test loss: 0.897, Test accuracy: 70.00
Round  75, Global train loss: 0.501, Global test loss: 0.830, Global test accuracy: 71.60
Round  76, Train loss: 0.364, Test loss: 0.994, Test accuracy: 68.46
Round  76, Global train loss: 0.364, Global test loss: 0.944, Global test accuracy: 68.60
Round  77, Train loss: 0.308, Test loss: 1.047, Test accuracy: 66.84
Round  77, Global train loss: 0.308, Global test loss: 1.038, Global test accuracy: 66.40
Round  78, Train loss: 0.278, Test loss: 1.061, Test accuracy: 66.80
Round  78, Global train loss: 0.278, Global test loss: 1.057, Global test accuracy: 66.40
Round  79, Train loss: 0.270, Test loss: 0.971, Test accuracy: 69.46
Round  79, Global train loss: 0.270, Global test loss: 0.905, Global test accuracy: 70.20
Round  80, Train loss: 0.269, Test loss: 0.938, Test accuracy: 69.12
Round  80, Global train loss: 0.269, Global test loss: 0.909, Global test accuracy: 70.00
Round  81, Train loss: 0.213, Test loss: 0.955, Test accuracy: 69.76
Round  81, Global train loss: 0.213, Global test loss: 0.924, Global test accuracy: 71.20
Round  82, Train loss: 0.204, Test loss: 0.925, Test accuracy: 71.20
Round  82, Global train loss: 0.204, Global test loss: 0.896, Global test accuracy: 72.40
Round  83, Train loss: 0.205, Test loss: 0.979, Test accuracy: 70.62
Round  83, Global train loss: 0.205, Global test loss: 0.953, Global test accuracy: 71.80
Round  84, Train loss: 0.188, Test loss: 0.960, Test accuracy: 71.08
Round  84, Global train loss: 0.188, Global test loss: 0.923, Global test accuracy: 72.00
Round  85, Train loss: 0.194, Test loss: 0.921, Test accuracy: 71.48
Round  85, Global train loss: 0.194, Global test loss: 0.887, Global test accuracy: 71.80
Round  86, Train loss: 0.169, Test loss: 0.981, Test accuracy: 71.26
Round  86, Global train loss: 0.169, Global test loss: 0.957, Global test accuracy: 72.20
Round  87, Train loss: 0.163, Test loss: 0.970, Test accuracy: 71.28
Round  87, Global train loss: 0.163, Global test loss: 0.942, Global test accuracy: 72.00
Round  88, Train loss: 0.165, Test loss: 0.969, Test accuracy: 70.32
Round  88, Global train loss: 0.165, Global test loss: 0.946, Global test accuracy: 72.40
Round  89, Train loss: 0.145, Test loss: 1.012, Test accuracy: 69.20
Round  89, Global train loss: 0.145, Global test loss: 0.990, Global test accuracy: 70.20
Round  90, Train loss: 0.145, Test loss: 0.980, Test accuracy: 70.84
Round  90, Global train loss: 0.145, Global test loss: 0.951, Global test accuracy: 72.60
Round  91, Train loss: 0.140, Test loss: 1.021, Test accuracy: 70.32
Round  91, Global train loss: 0.140, Global test loss: 0.999, Global test accuracy: 71.20
Round  92, Train loss: 0.130, Test loss: 1.068, Test accuracy: 69.02
Round  92, Global train loss: 0.130, Global test loss: 1.045, Global test accuracy: 69.80
Round  93, Train loss: 0.148, Test loss: 1.036, Test accuracy: 70.22
Round  93, Global train loss: 0.148, Global test loss: 1.017, Global test accuracy: 71.00
Round  94, Train loss: 0.130, Test loss: 1.050, Test accuracy: 68.80
Round  94, Global train loss: 0.130, Global test loss: 1.029, Global test accuracy: 68.80
Round  95, Train loss: 0.150, Test loss: 1.026, Test accuracy: 69.48
Round  95, Global train loss: 0.150, Global test loss: 1.005, Global test accuracy: 70.60
Round  96, Train loss: 0.126, Test loss: 1.041, Test accuracy: 68.68
Round  96, Global train loss: 0.126, Global test loss: 1.019, Global test accuracy: 68.80
Round  97, Train loss: 0.126, Test loss: 1.055, Test accuracy: 68.48
Round  97, Global train loss: 0.126, Global test loss: 1.030, Global test accuracy: 68.80
Round  98, Train loss: 0.119, Test loss: 1.059, Test accuracy: 68.80
Round  98, Global train loss: 0.119, Global test loss: 1.046, Global test accuracy: 69.00
Round  99, Train loss: 0.189, Test loss: 1.004, Test accuracy: 69.78
Round  99, Global train loss: 0.189, Global test loss: 0.920, Global test accuracy: 70.00
Final Round, Train loss: 0.147, Test loss: 1.023, Test accuracy: 69.78
Final Round, Global train loss: 0.147, Global test loss: 0.920, Global test accuracy: 70.00
Average accuracy final 10 rounds: 69.44200000000001
2157.435567140579
[2.5611820220947266, 4.645711421966553, 7.064177513122559, 9.672987699508667, 11.78155255317688, 13.93578577041626, 16.028648614883423, 18.168625354766846, 20.243252277374268, 22.40201210975647, 29.606369495391846, 40.44086146354675, 51.390618324279785, 62.40566802024841, 73.87490510940552, 76.48744249343872, 88.23939204216003, 99.85395956039429, 111.83268117904663, 122.96739029884338, 134.21034169197083, 145.87450456619263, 157.83361196517944, 170.36391806602478, 181.80068278312683, 192.66451358795166, 194.92256903648376, 206.38420844078064, 217.54139184951782, 228.67228746414185, 242.16975569725037, 253.22583556175232, 264.3797836303711, 275.96226143836975, 287.4727110862732, 299.02403354644775, 310.12368083000183, 321.30703616142273, 332.54476141929626, 344.0581593513489, 355.42523074150085, 366.5688855648041, 377.75874614715576, 389.3232967853546, 400.36368703842163, 402.444974899292, 404.6475179195404, 415.8510777950287, 427.3122684955597, 438.5773198604584, 450.000919342041, 461.21850657463074, 472.41290163993835, 483.9410910606384, 495.20174527168274, 497.18674969673157, 508.5523111820221, 519.6252856254578, 530.5968813896179, 541.4840135574341, 553.1197459697723, 555.3121826648712, 557.408221244812, 568.7963590621948, 570.9854164123535, 582.6345002651215, 593.9256775379181, 595.9663705825806, 607.2677538394928, 618.534907579422, 630.9997661113739, 643.0432541370392, 654.229558467865, 656.2213072776794, 658.2320511341095, 669.905942440033, 671.9448363780975, 674.2742335796356, 676.4100601673126, 687.7619421482086, 689.9896249771118, 692.3197107315063, 694.4762387275696, 696.6841678619385, 698.832109451294, 700.957275390625, 703.054215669632, 705.0453848838806, 707.1754698753357, 709.3131427764893, 711.9636507034302, 714.189474105835, 716.2258131504059, 718.5165114402771, 720.6610305309296, 722.7852463722229, 724.9966778755188, 727.1790201663971, 729.3095879554749, 740.4093787670135, 752.2980360984802]
[41.66, 50.02, 53.92, 57.22, 60.8, 61.8, 63.16, 63.44, 64.8, 64.98, 66.68, 64.84, 64.3, 66.06, 62.32, 65.92, 64.7, 63.56, 67.2, 66.44, 68.26, 65.06, 66.72, 64.74, 66.92, 68.58, 71.78, 68.82, 70.3, 69.76, 69.46, 72.0, 68.74, 68.3, 68.92, 67.42, 64.56, 68.94, 68.34, 70.34, 68.3, 72.92, 70.66, 68.1, 72.04, 70.68, 71.2, 70.06, 70.14, 71.12, 68.18, 69.08, 69.2, 69.66, 63.8, 70.8, 72.6, 69.66, 67.32, 70.74, 67.82, 71.32, 70.22, 70.96, 71.58, 71.22, 72.58, 72.68, 71.22, 70.2, 70.68, 65.96, 67.88, 69.9, 71.12, 70.0, 68.46, 66.84, 66.8, 69.46, 69.12, 69.76, 71.2, 70.62, 71.08, 71.48, 71.26, 71.28, 70.32, 69.2, 70.84, 70.32, 69.02, 70.22, 68.8, 69.48, 68.68, 68.48, 68.8, 69.78, 69.78]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.494, Test loss: 1.490, Test accuracy: 34.20
Round   0, Global train loss: 1.494, Global test loss: 1.488, Global test accuracy: 34.60
Round   1, Train loss: 1.477, Test loss: 1.432, Test accuracy: 38.98
Round   1, Global train loss: 1.477, Global test loss: 1.381, Global test accuracy: 42.00
Round   2, Train loss: 1.384, Test loss: 1.365, Test accuracy: 43.84
Round   2, Global train loss: 1.384, Global test loss: 1.237, Global test accuracy: 55.40
Round   3, Train loss: 1.408, Test loss: 1.370, Test accuracy: 44.00
Round   3, Global train loss: 1.408, Global test loss: 1.310, Global test accuracy: 56.60
Round   4, Train loss: 1.404, Test loss: 1.357, Test accuracy: 43.30
Round   4, Global train loss: 1.404, Global test loss: 1.352, Global test accuracy: 47.80
Round   5, Train loss: 1.331, Test loss: 1.307, Test accuracy: 45.48
Round   5, Global train loss: 1.331, Global test loss: 1.215, Global test accuracy: 53.60
Round   6, Train loss: 1.381, Test loss: 1.318, Test accuracy: 46.60
Round   6, Global train loss: 1.381, Global test loss: 1.335, Global test accuracy: 52.80
Round   7, Train loss: 1.368, Test loss: 1.311, Test accuracy: 46.40
Round   7, Global train loss: 1.368, Global test loss: 1.318, Global test accuracy: 53.80
Round   8, Train loss: 1.380, Test loss: 1.290, Test accuracy: 47.28
Round   8, Global train loss: 1.380, Global test loss: 1.276, Global test accuracy: 50.80
Round   9, Train loss: 1.318, Test loss: 1.275, Test accuracy: 48.94
Round   9, Global train loss: 1.318, Global test loss: 1.242, Global test accuracy: 59.20
Round  10, Train loss: 1.183, Test loss: 1.242, Test accuracy: 49.88
Round  10, Global train loss: 1.183, Global test loss: 1.138, Global test accuracy: 61.40
Round  11, Train loss: 1.428, Test loss: 1.304, Test accuracy: 47.36
Round  11, Global train loss: 1.428, Global test loss: 1.390, Global test accuracy: 50.40
Round  12, Train loss: 1.362, Test loss: 1.289, Test accuracy: 46.50
Round  12, Global train loss: 1.362, Global test loss: 1.320, Global test accuracy: 42.40
Round  13, Train loss: 1.174, Test loss: 1.261, Test accuracy: 49.98
Round  13, Global train loss: 1.174, Global test loss: 1.159, Global test accuracy: 61.80
Round  14, Train loss: 1.367, Test loss: 1.276, Test accuracy: 48.74
Round  14, Global train loss: 1.367, Global test loss: 1.221, Global test accuracy: 56.80
Round  15, Train loss: 1.339, Test loss: 1.273, Test accuracy: 49.18
Round  15, Global train loss: 1.339, Global test loss: 1.300, Global test accuracy: 51.80
Round  16, Train loss: 1.238, Test loss: 1.279, Test accuracy: 48.98
Round  16, Global train loss: 1.238, Global test loss: 1.177, Global test accuracy: 59.00
Round  17, Train loss: 1.186, Test loss: 1.280, Test accuracy: 48.46
Round  17, Global train loss: 1.186, Global test loss: 1.144, Global test accuracy: 57.00
Round  18, Train loss: 1.235, Test loss: 1.262, Test accuracy: 49.42
Round  18, Global train loss: 1.235, Global test loss: 1.134, Global test accuracy: 56.60
Round  19, Train loss: 1.232, Test loss: 1.255, Test accuracy: 49.60
Round  19, Global train loss: 1.232, Global test loss: 1.171, Global test accuracy: 57.60
Round  20, Train loss: 1.278, Test loss: 1.251, Test accuracy: 50.16
Round  20, Global train loss: 1.278, Global test loss: 1.301, Global test accuracy: 53.80
Round  21, Train loss: 1.189, Test loss: 1.270, Test accuracy: 49.18
Round  21, Global train loss: 1.189, Global test loss: 1.203, Global test accuracy: 57.20
Round  22, Train loss: 1.173, Test loss: 1.260, Test accuracy: 49.70
Round  22, Global train loss: 1.173, Global test loss: 1.179, Global test accuracy: 58.60
Round  23, Train loss: 1.286, Test loss: 1.262, Test accuracy: 49.84
Round  23, Global train loss: 1.286, Global test loss: 1.277, Global test accuracy: 45.80
Round  24, Train loss: 1.140, Test loss: 1.260, Test accuracy: 50.52
Round  24, Global train loss: 1.140, Global test loss: 1.076, Global test accuracy: 61.20
Round  25, Train loss: 1.177, Test loss: 1.280, Test accuracy: 49.38
Round  25, Global train loss: 1.177, Global test loss: 1.062, Global test accuracy: 64.40
Round  26, Train loss: 1.120, Test loss: 1.281, Test accuracy: 49.68
Round  26, Global train loss: 1.120, Global test loss: 1.173, Global test accuracy: 61.40
Round  27, Train loss: 0.958, Test loss: 1.270, Test accuracy: 49.96
Round  27, Global train loss: 0.958, Global test loss: 0.996, Global test accuracy: 66.00
Round  28, Train loss: 1.070, Test loss: 1.307, Test accuracy: 48.70
Round  28, Global train loss: 1.070, Global test loss: 1.181, Global test accuracy: 61.20
Round  29, Train loss: 1.020, Test loss: 1.300, Test accuracy: 49.04
Round  29, Global train loss: 1.020, Global test loss: 1.014, Global test accuracy: 62.20
Round  30, Train loss: 1.231, Test loss: 1.316, Test accuracy: 48.46
Round  30, Global train loss: 1.231, Global test loss: 1.190, Global test accuracy: 55.80
Round  31, Train loss: 1.070, Test loss: 1.319, Test accuracy: 49.54
Round  31, Global train loss: 1.070, Global test loss: 1.208, Global test accuracy: 59.00
Round  32, Train loss: 0.958, Test loss: 1.308, Test accuracy: 50.54
Round  32, Global train loss: 0.958, Global test loss: 1.071, Global test accuracy: 62.00
Round  33, Train loss: 0.919, Test loss: 1.284, Test accuracy: 50.94
Round  33, Global train loss: 0.919, Global test loss: 0.961, Global test accuracy: 64.80
Round  34, Train loss: 0.946, Test loss: 1.278, Test accuracy: 51.12
Round  34, Global train loss: 0.946, Global test loss: 1.030, Global test accuracy: 62.40
Round  35, Train loss: 0.973, Test loss: 1.327, Test accuracy: 49.56
Round  35, Global train loss: 0.973, Global test loss: 1.004, Global test accuracy: 60.60
Round  36, Train loss: 0.987, Test loss: 1.336, Test accuracy: 48.72
Round  36, Global train loss: 0.987, Global test loss: 1.088, Global test accuracy: 61.00
Round  37, Train loss: 1.036, Test loss: 1.339, Test accuracy: 49.10
Round  37, Global train loss: 1.036, Global test loss: 1.052, Global test accuracy: 62.60
Round  38, Train loss: 0.926, Test loss: 1.326, Test accuracy: 48.98
Round  38, Global train loss: 0.926, Global test loss: 0.970, Global test accuracy: 61.20
Round  39, Train loss: 0.823, Test loss: 1.348, Test accuracy: 48.38
Round  39, Global train loss: 0.823, Global test loss: 0.996, Global test accuracy: 65.00
Round  40, Train loss: 0.862, Test loss: 1.350, Test accuracy: 48.00
Round  40, Global train loss: 0.862, Global test loss: 1.068, Global test accuracy: 64.40
Round  41, Train loss: 1.022, Test loss: 1.377, Test accuracy: 47.70
Round  41, Global train loss: 1.022, Global test loss: 1.090, Global test accuracy: 62.40
Round  42, Train loss: 1.068, Test loss: 1.448, Test accuracy: 46.44
Round  42, Global train loss: 1.068, Global test loss: 1.093, Global test accuracy: 61.40
Round  43, Train loss: 1.207, Test loss: 1.419, Test accuracy: 45.80
Round  43, Global train loss: 1.207, Global test loss: 1.182, Global test accuracy: 59.20
Round  44, Train loss: 1.051, Test loss: 1.426, Test accuracy: 46.12
Round  44, Global train loss: 1.051, Global test loss: 1.164, Global test accuracy: 57.80
Round  45, Train loss: 0.894, Test loss: 1.443, Test accuracy: 46.50
Round  45, Global train loss: 0.894, Global test loss: 0.982, Global test accuracy: 63.00
Round  46, Train loss: 0.963, Test loss: 1.475, Test accuracy: 47.18
Round  46, Global train loss: 0.963, Global test loss: 1.086, Global test accuracy: 60.60
Round  47, Train loss: 0.737, Test loss: 1.440, Test accuracy: 48.00
Round  47, Global train loss: 0.737, Global test loss: 0.965, Global test accuracy: 65.20
Round  48, Train loss: 1.062, Test loss: 1.477, Test accuracy: 48.54
Round  48, Global train loss: 1.062, Global test loss: 1.198, Global test accuracy: 53.80
Round  49, Train loss: 0.892, Test loss: 1.520, Test accuracy: 47.62
Round  49, Global train loss: 0.892, Global test loss: 1.107, Global test accuracy: 59.20
Round  50, Train loss: 0.849, Test loss: 1.500, Test accuracy: 48.90
Round  50, Global train loss: 0.849, Global test loss: 1.058, Global test accuracy: 62.80
Round  51, Train loss: 1.047, Test loss: 1.476, Test accuracy: 48.76
Round  51, Global train loss: 1.047, Global test loss: 1.161, Global test accuracy: 56.60
Round  52, Train loss: 0.710, Test loss: 1.569, Test accuracy: 47.70
Round  52, Global train loss: 0.710, Global test loss: 1.108, Global test accuracy: 57.60
Round  53, Train loss: 0.805, Test loss: 1.579, Test accuracy: 47.24
Round  53, Global train loss: 0.805, Global test loss: 0.988, Global test accuracy: 61.80
Round  54, Train loss: 0.952, Test loss: 1.628, Test accuracy: 46.30
Round  54, Global train loss: 0.952, Global test loss: 1.074, Global test accuracy: 62.20
Round  55, Train loss: 0.736, Test loss: 1.654, Test accuracy: 45.64
Round  55, Global train loss: 0.736, Global test loss: 0.934, Global test accuracy: 64.60
Round  56, Train loss: 0.944, Test loss: 1.699, Test accuracy: 44.64
Round  56, Global train loss: 0.944, Global test loss: 1.082, Global test accuracy: 59.20
Round  57, Train loss: 0.707, Test loss: 1.665, Test accuracy: 45.70
Round  57, Global train loss: 0.707, Global test loss: 1.169, Global test accuracy: 49.40
Round  58, Train loss: 0.646, Test loss: 1.686, Test accuracy: 45.60
Round  58, Global train loss: 0.646, Global test loss: 0.987, Global test accuracy: 62.00
Round  59, Train loss: 0.952, Test loss: 1.674, Test accuracy: 46.64
Round  59, Global train loss: 0.952, Global test loss: 1.041, Global test accuracy: 58.40
Round  60, Train loss: 0.753, Test loss: 1.705, Test accuracy: 46.00
Round  60, Global train loss: 0.753, Global test loss: 1.124, Global test accuracy: 58.40
Round  61, Train loss: 0.766, Test loss: 1.788, Test accuracy: 45.54
Round  61, Global train loss: 0.766, Global test loss: 1.204, Global test accuracy: 49.00
Round  62, Train loss: 0.693, Test loss: 1.822, Test accuracy: 45.58
Round  62, Global train loss: 0.693, Global test loss: 0.966, Global test accuracy: 61.60
Round  63, Train loss: 0.546, Test loss: 1.865, Test accuracy: 45.28
Round  63, Global train loss: 0.546, Global test loss: 1.096, Global test accuracy: 59.60
Round  64, Train loss: 0.774, Test loss: 1.915, Test accuracy: 45.14
Round  64, Global train loss: 0.774, Global test loss: 1.134, Global test accuracy: 60.80
Round  65, Train loss: 0.484, Test loss: 1.866, Test accuracy: 45.94
Round  65, Global train loss: 0.484, Global test loss: 1.093, Global test accuracy: 62.00
Round  66, Train loss: 0.459, Test loss: 1.879, Test accuracy: 45.46
Round  66, Global train loss: 0.459, Global test loss: 1.056, Global test accuracy: 59.00
Round  67, Train loss: 0.811, Test loss: 1.902, Test accuracy: 45.68
Round  67, Global train loss: 0.811, Global test loss: 1.007, Global test accuracy: 62.20
Round  68, Train loss: 0.461, Test loss: 1.903, Test accuracy: 45.70
Round  68, Global train loss: 0.461, Global test loss: 1.182, Global test accuracy: 59.80
Round  69, Train loss: 0.614, Test loss: 1.989, Test accuracy: 45.50
Round  69, Global train loss: 0.614, Global test loss: 1.053, Global test accuracy: 56.60
Round  70, Train loss: 0.566, Test loss: 2.093, Test accuracy: 45.16
Round  70, Global train loss: 0.566, Global test loss: 1.003, Global test accuracy: 61.60
Round  71, Train loss: 0.795, Test loss: 2.164, Test accuracy: 44.24
Round  71, Global train loss: 0.795, Global test loss: 1.293, Global test accuracy: 50.80
Round  72, Train loss: 0.804, Test loss: 2.173, Test accuracy: 43.78
Round  72, Global train loss: 0.804, Global test loss: 1.367, Global test accuracy: 45.40
Round  73, Train loss: 0.480, Test loss: 2.160, Test accuracy: 44.12
Round  73, Global train loss: 0.480, Global test loss: 0.979, Global test accuracy: 60.00
Round  74, Train loss: 0.648, Test loss: 2.215, Test accuracy: 43.72
Round  74, Global train loss: 0.648, Global test loss: 1.053, Global test accuracy: 59.40
Round  75, Train loss: 0.575, Test loss: 2.186, Test accuracy: 44.56
Round  75, Global train loss: 0.575, Global test loss: 1.076, Global test accuracy: 62.60
Round  76, Train loss: 0.502, Test loss: 2.170, Test accuracy: 44.90
Round  76, Global train loss: 0.502, Global test loss: 1.002, Global test accuracy: 62.20
Round  77, Train loss: 0.333, Test loss: 2.200, Test accuracy: 44.86
Round  77, Global train loss: 0.333, Global test loss: 1.199, Global test accuracy: 59.60
Round  78, Train loss: 0.478, Test loss: 2.231, Test accuracy: 43.90
Round  78, Global train loss: 0.478, Global test loss: 1.214, Global test accuracy: 54.80
Round  79, Train loss: 0.607, Test loss: 2.295, Test accuracy: 43.58
Round  79, Global train loss: 0.607, Global test loss: 1.314, Global test accuracy: 47.40
Round  80, Train loss: 0.613, Test loss: 2.238, Test accuracy: 44.16
Round  80, Global train loss: 0.613, Global test loss: 1.265, Global test accuracy: 49.20
Round  81, Train loss: 0.379, Test loss: 2.255, Test accuracy: 44.56
Round  81, Global train loss: 0.379, Global test loss: 1.196, Global test accuracy: 58.80
Round  82, Train loss: 0.508, Test loss: 2.280, Test accuracy: 45.50
Round  82, Global train loss: 0.508, Global test loss: 1.138, Global test accuracy: 57.40
Round  83, Train loss: 0.331, Test loss: 2.282, Test accuracy: 44.84
Round  83, Global train loss: 0.331, Global test loss: 0.971, Global test accuracy: 62.80
Round  84, Train loss: 0.436, Test loss: 2.351, Test accuracy: 45.44
Round  84, Global train loss: 0.436, Global test loss: 1.158, Global test accuracy: 53.40
Round  85, Train loss: 0.398, Test loss: 2.350, Test accuracy: 45.12
Round  85, Global train loss: 0.398, Global test loss: 1.053, Global test accuracy: 59.80
Round  86, Train loss: 0.468, Test loss: 2.389, Test accuracy: 45.42
Round  86, Global train loss: 0.468, Global test loss: 0.966, Global test accuracy: 63.00
Round  87, Train loss: 0.353, Test loss: 2.339, Test accuracy: 45.34
Round  87, Global train loss: 0.353, Global test loss: 0.959, Global test accuracy: 65.00
Round  88, Train loss: 0.262, Test loss: 2.596, Test accuracy: 44.22
Round  88, Global train loss: 0.262, Global test loss: 0.922, Global test accuracy: 63.40
Round  89, Train loss: 0.426, Test loss: 2.645, Test accuracy: 43.84
Round  89, Global train loss: 0.426, Global test loss: 0.969, Global test accuracy: 62.60
Round  90, Train loss: 0.405, Test loss: 2.725, Test accuracy: 43.26
Round  90, Global train loss: 0.405, Global test loss: 1.196, Global test accuracy: 50.20
Round  91, Train loss: 0.384, Test loss: 2.813, Test accuracy: 42.44
Round  91, Global train loss: 0.384, Global test loss: 1.260, Global test accuracy: 46.60
Round  92, Train loss: 0.254, Test loss: 2.770, Test accuracy: 43.50
Round  92, Global train loss: 0.254, Global test loss: 0.939, Global test accuracy: 66.60
Round  93, Train loss: 0.202, Test loss: 2.663, Test accuracy: 43.14
Round  93, Global train loss: 0.202, Global test loss: 0.885, Global test accuracy: 63.60
Round  94, Train loss: 0.382, Test loss: 2.719, Test accuracy: 43.90
Round  94, Global train loss: 0.382, Global test loss: 1.119, Global test accuracy: 58.20
Round  95, Train loss: 0.464, Test loss: 2.791, Test accuracy: 43.22
Round  95, Global train loss: 0.464, Global test loss: 1.314, Global test accuracy: 50.00
Round  96, Train loss: 0.386, Test loss: 2.702, Test accuracy: 44.12
Round  96, Global train loss: 0.386, Global test loss: 1.297, Global test accuracy: 50.40
Round  97, Train loss: 0.324, Test loss: 2.701, Test accuracy: 45.10
Round  97, Global train loss: 0.324, Global test loss: 1.131, Global test accuracy: 58.80
Round  98, Train loss: 0.330, Test loss: 2.711, Test accuracy: 44.50
Round  98, Global train loss: 0.330, Global test loss: 1.138, Global test accuracy: 56.60
Round  99, Train loss: 0.237, Test loss: 2.834, Test accuracy: 43.40
Round  99, Global train loss: 0.237, Global test loss: 0.923, Global test accuracy: 64.60
Final Round, Train loss: 0.290, Test loss: 2.972, Test accuracy: 44.14
Final Round, Global train loss: 0.290, Global test loss: 0.923, Global test accuracy: 64.60
Average accuracy final 10 rounds: 43.658 

Average global accuracy final 10 rounds: 56.559999999999995 

1015.4045913219452
[1.7560734748840332, 3.5121469497680664, 5.09077000617981, 6.669393062591553, 8.18811559677124, 9.706838130950928, 11.355574131011963, 13.004310131072998, 14.628075122833252, 16.251840114593506, 17.82266116142273, 19.393482208251953, 20.958008766174316, 22.52253532409668, 23.9969642162323, 25.47139310836792, 27.065058946609497, 28.658724784851074, 30.25232720375061, 31.845929622650146, 33.36268734931946, 34.87944507598877, 36.478864431381226, 38.07828378677368, 39.58208417892456, 41.08588457107544, 42.648138761520386, 44.21039295196533, 45.78189253807068, 47.353392124176025, 49.08894753456116, 50.82450294494629, 52.36275863647461, 53.90101432800293, 55.43663549423218, 56.972256660461426, 58.501725912094116, 60.03119516372681, 61.719451904296875, 63.40770864486694, 65.04993081092834, 66.69215297698975, 68.4077627658844, 70.12337255477905, 71.69627118110657, 73.26916980743408, 75.07429480552673, 76.87941980361938, 78.45554375648499, 80.03166770935059, 81.55992031097412, 83.08817291259766, 84.69445490837097, 86.30073690414429, 88.05307745933533, 89.80541801452637, 91.48378276824951, 93.16214752197266, 94.91445016860962, 96.66675281524658, 98.3069839477539, 99.94721508026123, 101.47848224639893, 103.00974941253662, 104.72955274581909, 106.44935607910156, 107.98977255821228, 109.530189037323, 111.12207055091858, 112.71395206451416, 114.23425722122192, 115.75456237792969, 117.26348066329956, 118.77239894866943, 120.36671113967896, 121.96102333068848, 123.58340764045715, 125.20579195022583, 126.92939901351929, 128.65300607681274, 130.30126857757568, 131.94953107833862, 133.65831351280212, 135.36709594726562, 136.92709302902222, 138.4870901107788, 140.14350700378418, 141.79992389678955, 143.35122776031494, 144.90253162384033, 146.62653851509094, 148.35054540634155, 150.05286931991577, 151.75519323349, 153.30505228042603, 154.85491132736206, 156.42128729820251, 157.98766326904297, 159.59707760810852, 161.20649194717407, 162.82591319084167, 164.44533443450928, 165.9931812286377, 167.5410280227661, 169.0432894229889, 170.54555082321167, 172.02275896072388, 173.49996709823608, 175.00489258766174, 176.5098180770874, 178.06671237945557, 179.62360668182373, 181.297691822052, 182.97177696228027, 184.52988195419312, 186.08798694610596, 187.6871576309204, 189.28632831573486, 190.9681978225708, 192.65006732940674, 194.2019407749176, 195.75381422042847, 197.34485840797424, 198.93590259552002, 200.6217737197876, 202.30764484405518, 203.93219995498657, 205.55675506591797, 207.20932269096375, 208.86189031600952, 210.45308351516724, 212.04427671432495, 213.64358258247375, 215.24288845062256, 216.85645580291748, 218.4700231552124, 220.05113220214844, 221.63224124908447, 223.33521723747253, 225.0381932258606, 226.71829199790955, 228.3983907699585, 229.89548325538635, 231.3925757408142, 232.981130361557, 234.5696849822998, 236.05141925811768, 237.53315353393555, 239.2752664089203, 241.01737928390503, 242.71014380455017, 244.4029083251953, 246.06100869178772, 247.71910905838013, 249.69483876228333, 251.67056846618652, 253.36161756515503, 255.05266666412354, 256.59394931793213, 258.1352319717407, 259.7510244846344, 261.3668169975281, 262.8734438419342, 264.38007068634033, 265.99449038505554, 267.60891008377075, 269.194100856781, 270.77929162979126, 272.44381308555603, 274.1083345413208, 275.7114293575287, 277.3145241737366, 278.9311988353729, 280.5478734970093, 282.1147110462189, 283.68154859542847, 285.2378535270691, 286.7941584587097, 288.32368659973145, 289.8532147407532, 291.39064049720764, 292.9280662536621, 294.4983398914337, 296.0686135292053, 297.6144845485687, 299.16035556793213, 300.8084557056427, 302.45655584335327, 304.19855093955994, 305.9405460357666, 307.572607755661, 309.2046694755554, 310.8133211135864, 312.42197275161743, 314.1085412502289, 315.79510974884033, 317.45386028289795, 319.11261081695557, 320.69984221458435, 322.28707361221313, 325.4607963562012, 328.6345191001892]
[34.2, 34.2, 38.98, 38.98, 43.84, 43.84, 44.0, 44.0, 43.3, 43.3, 45.48, 45.48, 46.6, 46.6, 46.4, 46.4, 47.28, 47.28, 48.94, 48.94, 49.88, 49.88, 47.36, 47.36, 46.5, 46.5, 49.98, 49.98, 48.74, 48.74, 49.18, 49.18, 48.98, 48.98, 48.46, 48.46, 49.42, 49.42, 49.6, 49.6, 50.16, 50.16, 49.18, 49.18, 49.7, 49.7, 49.84, 49.84, 50.52, 50.52, 49.38, 49.38, 49.68, 49.68, 49.96, 49.96, 48.7, 48.7, 49.04, 49.04, 48.46, 48.46, 49.54, 49.54, 50.54, 50.54, 50.94, 50.94, 51.12, 51.12, 49.56, 49.56, 48.72, 48.72, 49.1, 49.1, 48.98, 48.98, 48.38, 48.38, 48.0, 48.0, 47.7, 47.7, 46.44, 46.44, 45.8, 45.8, 46.12, 46.12, 46.5, 46.5, 47.18, 47.18, 48.0, 48.0, 48.54, 48.54, 47.62, 47.62, 48.9, 48.9, 48.76, 48.76, 47.7, 47.7, 47.24, 47.24, 46.3, 46.3, 45.64, 45.64, 44.64, 44.64, 45.7, 45.7, 45.6, 45.6, 46.64, 46.64, 46.0, 46.0, 45.54, 45.54, 45.58, 45.58, 45.28, 45.28, 45.14, 45.14, 45.94, 45.94, 45.46, 45.46, 45.68, 45.68, 45.7, 45.7, 45.5, 45.5, 45.16, 45.16, 44.24, 44.24, 43.78, 43.78, 44.12, 44.12, 43.72, 43.72, 44.56, 44.56, 44.9, 44.9, 44.86, 44.86, 43.9, 43.9, 43.58, 43.58, 44.16, 44.16, 44.56, 44.56, 45.5, 45.5, 44.84, 44.84, 45.44, 45.44, 45.12, 45.12, 45.42, 45.42, 45.34, 45.34, 44.22, 44.22, 43.84, 43.84, 43.26, 43.26, 42.44, 42.44, 43.5, 43.5, 43.14, 43.14, 43.9, 43.9, 43.22, 43.22, 44.12, 44.12, 45.1, 45.1, 44.5, 44.5, 43.4, 43.4, 44.14, 44.14]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.466, Test loss: 1.480, Test accuracy: 37.26
Round   0, Global train loss: 1.466, Global test loss: 1.472, Global test accuracy: 37.40
Round   1, Train loss: 1.478, Test loss: 1.449, Test accuracy: 41.74
Round   1, Global train loss: 1.478, Global test loss: 1.403, Global test accuracy: 45.20
Round   2, Train loss: 1.338, Test loss: 1.359, Test accuracy: 45.20
Round   2, Global train loss: 1.338, Global test loss: 1.150, Global test accuracy: 59.60
Round   3, Train loss: 1.351, Test loss: 1.316, Test accuracy: 46.28
Round   3, Global train loss: 1.351, Global test loss: 1.159, Global test accuracy: 57.20
Round   4, Train loss: 1.420, Test loss: 1.312, Test accuracy: 48.98
Round   4, Global train loss: 1.420, Global test loss: 1.280, Global test accuracy: 55.60
Round   5, Train loss: 1.256, Test loss: 1.263, Test accuracy: 50.30
Round   5, Global train loss: 1.256, Global test loss: 1.134, Global test accuracy: 57.80
Round   6, Train loss: 1.256, Test loss: 1.250, Test accuracy: 51.24
Round   6, Global train loss: 1.256, Global test loss: 1.184, Global test accuracy: 54.00
Round   7, Train loss: 1.228, Test loss: 1.186, Test accuracy: 55.00
Round   7, Global train loss: 1.228, Global test loss: 1.002, Global test accuracy: 63.60
Round   8, Train loss: 1.290, Test loss: 1.167, Test accuracy: 56.98
Round   8, Global train loss: 1.290, Global test loss: 1.111, Global test accuracy: 65.20
Round   9, Train loss: 1.316, Test loss: 1.195, Test accuracy: 54.46
Round   9, Global train loss: 1.316, Global test loss: 1.132, Global test accuracy: 63.40
Round  10, Train loss: 1.183, Test loss: 1.128, Test accuracy: 56.54
Round  10, Global train loss: 1.183, Global test loss: 0.929, Global test accuracy: 66.00
Round  11, Train loss: 1.137, Test loss: 1.179, Test accuracy: 53.22
Round  11, Global train loss: 1.137, Global test loss: 1.099, Global test accuracy: 56.00
Round  12, Train loss: 1.147, Test loss: 1.157, Test accuracy: 55.08
Round  12, Global train loss: 1.147, Global test loss: 0.956, Global test accuracy: 64.60
Round  13, Train loss: 1.302, Test loss: 1.173, Test accuracy: 54.30
Round  13, Global train loss: 1.302, Global test loss: 1.095, Global test accuracy: 62.00
Round  14, Train loss: 1.237, Test loss: 1.176, Test accuracy: 54.50
Round  14, Global train loss: 1.237, Global test loss: 0.999, Global test accuracy: 70.40
Round  15, Train loss: 1.102, Test loss: 1.180, Test accuracy: 54.42
Round  15, Global train loss: 1.102, Global test loss: 0.969, Global test accuracy: 62.20
Round  16, Train loss: 1.121, Test loss: 1.180, Test accuracy: 54.52
Round  16, Global train loss: 1.121, Global test loss: 1.025, Global test accuracy: 61.00
Round  17, Train loss: 1.096, Test loss: 1.176, Test accuracy: 54.72
Round  17, Global train loss: 1.096, Global test loss: 1.010, Global test accuracy: 63.80
Round  18, Train loss: 1.121, Test loss: 1.172, Test accuracy: 55.64
Round  18, Global train loss: 1.121, Global test loss: 0.979, Global test accuracy: 63.60
Round  19, Train loss: 1.223, Test loss: 1.165, Test accuracy: 56.24
Round  19, Global train loss: 1.223, Global test loss: 1.069, Global test accuracy: 66.20
Round  20, Train loss: 0.994, Test loss: 1.160, Test accuracy: 56.90
Round  20, Global train loss: 0.994, Global test loss: 0.972, Global test accuracy: 62.00
Round  21, Train loss: 1.103, Test loss: 1.156, Test accuracy: 56.78
Round  21, Global train loss: 1.103, Global test loss: 1.174, Global test accuracy: 56.60
Round  22, Train loss: 0.986, Test loss: 1.187, Test accuracy: 56.36
Round  22, Global train loss: 0.986, Global test loss: 1.174, Global test accuracy: 56.80
Round  23, Train loss: 0.939, Test loss: 1.180, Test accuracy: 56.28
Round  23, Global train loss: 0.939, Global test loss: 0.963, Global test accuracy: 65.60
Round  24, Train loss: 0.887, Test loss: 1.210, Test accuracy: 55.32
Round  24, Global train loss: 0.887, Global test loss: 1.006, Global test accuracy: 62.20
Round  25, Train loss: 1.126, Test loss: 1.242, Test accuracy: 52.92
Round  25, Global train loss: 1.126, Global test loss: 1.142, Global test accuracy: 59.60
Round  26, Train loss: 0.966, Test loss: 1.309, Test accuracy: 50.64
Round  26, Global train loss: 0.966, Global test loss: 1.196, Global test accuracy: 53.60
Round  27, Train loss: 0.896, Test loss: 1.313, Test accuracy: 52.56
Round  27, Global train loss: 0.896, Global test loss: 1.074, Global test accuracy: 60.40
Round  28, Train loss: 0.895, Test loss: 1.336, Test accuracy: 53.20
Round  28, Global train loss: 0.895, Global test loss: 1.113, Global test accuracy: 58.60
Round  29, Train loss: 0.786, Test loss: 1.386, Test accuracy: 52.74
Round  29, Global train loss: 0.786, Global test loss: 0.839, Global test accuracy: 70.60
Round  30, Train loss: 0.894, Test loss: 1.490, Test accuracy: 50.30
Round  30, Global train loss: 0.894, Global test loss: 1.054, Global test accuracy: 62.20
Round  31, Train loss: 0.698, Test loss: 1.509, Test accuracy: 50.02
Round  31, Global train loss: 0.698, Global test loss: 0.994, Global test accuracy: 63.80
Round  32, Train loss: 0.828, Test loss: 1.537, Test accuracy: 48.98
Round  32, Global train loss: 0.828, Global test loss: 1.020, Global test accuracy: 63.60
Round  33, Train loss: 0.654, Test loss: 1.507, Test accuracy: 50.74
Round  33, Global train loss: 0.654, Global test loss: 0.781, Global test accuracy: 70.80
Round  34, Train loss: 0.797, Test loss: 1.592, Test accuracy: 49.10
Round  34, Global train loss: 0.797, Global test loss: 1.311, Global test accuracy: 51.40
Round  35, Train loss: 0.647, Test loss: 1.677, Test accuracy: 48.72
Round  35, Global train loss: 0.647, Global test loss: 1.169, Global test accuracy: 57.60
Round  36, Train loss: 0.838, Test loss: 1.695, Test accuracy: 48.26
Round  36, Global train loss: 0.838, Global test loss: 1.163, Global test accuracy: 57.40
Round  37, Train loss: 0.643, Test loss: 1.671, Test accuracy: 49.18
Round  37, Global train loss: 0.643, Global test loss: 1.273, Global test accuracy: 56.80
Round  38, Train loss: 0.556, Test loss: 1.678, Test accuracy: 48.96
Round  38, Global train loss: 0.556, Global test loss: 1.179, Global test accuracy: 59.40
Round  39, Train loss: 0.642, Test loss: 1.687, Test accuracy: 49.40
Round  39, Global train loss: 0.642, Global test loss: 1.054, Global test accuracy: 63.60
Round  40, Train loss: 0.596, Test loss: 1.703, Test accuracy: 50.22
Round  40, Global train loss: 0.596, Global test loss: 1.248, Global test accuracy: 58.60
Round  41, Train loss: 0.528, Test loss: 1.692, Test accuracy: 50.90
Round  41, Global train loss: 0.528, Global test loss: 1.275, Global test accuracy: 58.80
Round  42, Train loss: 0.598, Test loss: 1.751, Test accuracy: 50.18
Round  42, Global train loss: 0.598, Global test loss: 1.423, Global test accuracy: 51.20
Round  43, Train loss: 0.540, Test loss: 1.703, Test accuracy: 52.02
Round  43, Global train loss: 0.540, Global test loss: 1.528, Global test accuracy: 49.60
Round  44, Train loss: 0.455, Test loss: 1.774, Test accuracy: 51.16
Round  44, Global train loss: 0.455, Global test loss: 1.514, Global test accuracy: 55.60
Round  45, Train loss: 0.447, Test loss: 1.803, Test accuracy: 50.40
Round  45, Global train loss: 0.447, Global test loss: 1.441, Global test accuracy: 57.40
Round  46, Train loss: 0.528, Test loss: 1.859, Test accuracy: 50.72
Round  46, Global train loss: 0.528, Global test loss: 1.687, Global test accuracy: 50.40
Round  47, Train loss: 0.443, Test loss: 1.916, Test accuracy: 49.52
Round  47, Global train loss: 0.443, Global test loss: 1.171, Global test accuracy: 61.80
Round  48, Train loss: 0.274, Test loss: 1.968, Test accuracy: 50.02
Round  48, Global train loss: 0.274, Global test loss: 1.810, Global test accuracy: 54.00
Round  49, Train loss: 0.457, Test loss: 2.011, Test accuracy: 50.24
Round  49, Global train loss: 0.457, Global test loss: 1.747, Global test accuracy: 49.40
Round  50, Train loss: 0.382, Test loss: 2.063, Test accuracy: 49.54
Round  50, Global train loss: 0.382, Global test loss: 1.860, Global test accuracy: 51.60
Round  51, Train loss: 0.351, Test loss: 2.103, Test accuracy: 49.20
Round  51, Global train loss: 0.351, Global test loss: 1.849, Global test accuracy: 52.20
Round  52, Train loss: 0.381, Test loss: 2.043, Test accuracy: 50.76
Round  52, Global train loss: 0.381, Global test loss: 1.431, Global test accuracy: 60.20
Round  53, Train loss: 0.385, Test loss: 2.076, Test accuracy: 50.58
Round  53, Global train loss: 0.385, Global test loss: 1.176, Global test accuracy: 65.20
Round  54, Train loss: 0.457, Test loss: 2.065, Test accuracy: 50.40
Round  54, Global train loss: 0.457, Global test loss: 1.625, Global test accuracy: 52.20
Round  55, Train loss: 0.323, Test loss: 2.113, Test accuracy: 49.64
Round  55, Global train loss: 0.323, Global test loss: 1.379, Global test accuracy: 59.40
Round  56, Train loss: 0.225, Test loss: 2.179, Test accuracy: 48.96
Round  56, Global train loss: 0.225, Global test loss: 1.580, Global test accuracy: 55.60
Round  57, Train loss: 0.359, Test loss: 2.197, Test accuracy: 48.84
Round  57, Global train loss: 0.359, Global test loss: 1.236, Global test accuracy: 62.40
Round  58, Train loss: 0.414, Test loss: 2.213, Test accuracy: 49.30
Round  58, Global train loss: 0.414, Global test loss: 1.402, Global test accuracy: 56.40
Round  59, Train loss: 0.293, Test loss: 2.232, Test accuracy: 49.86
Round  59, Global train loss: 0.293, Global test loss: 1.761, Global test accuracy: 54.20
Round  60, Train loss: 0.226, Test loss: 2.299, Test accuracy: 49.30
Round  60, Global train loss: 0.226, Global test loss: 1.794, Global test accuracy: 55.00
Round  61, Train loss: 0.259, Test loss: 2.250, Test accuracy: 50.82
Round  61, Global train loss: 0.259, Global test loss: 1.183, Global test accuracy: 66.20
Round  62, Train loss: 0.349, Test loss: 2.149, Test accuracy: 52.08
Round  62, Global train loss: 0.349, Global test loss: 1.709, Global test accuracy: 51.60
Round  63, Train loss: 0.227, Test loss: 2.212, Test accuracy: 51.38
Round  63, Global train loss: 0.227, Global test loss: 1.920, Global test accuracy: 54.20
Round  64, Train loss: 0.263, Test loss: 2.213, Test accuracy: 51.14
Round  64, Global train loss: 0.263, Global test loss: 1.729, Global test accuracy: 59.20
Round  65, Train loss: 0.224, Test loss: 2.237, Test accuracy: 51.36
Round  65, Global train loss: 0.224, Global test loss: 1.862, Global test accuracy: 54.40
Round  66, Train loss: 0.275, Test loss: 2.262, Test accuracy: 51.36
Round  66, Global train loss: 0.275, Global test loss: 1.580, Global test accuracy: 57.80
Round  67, Train loss: 0.193, Test loss: 2.281, Test accuracy: 50.48
Round  67, Global train loss: 0.193, Global test loss: 1.701, Global test accuracy: 55.60
Round  68, Train loss: 0.228, Test loss: 2.415, Test accuracy: 50.12
Round  68, Global train loss: 0.228, Global test loss: 2.410, Global test accuracy: 47.40
Round  69, Train loss: 0.256, Test loss: 2.392, Test accuracy: 49.72
Round  69, Global train loss: 0.256, Global test loss: 1.461, Global test accuracy: 62.00
Round  70, Train loss: 0.216, Test loss: 2.354, Test accuracy: 51.60
Round  70, Global train loss: 0.216, Global test loss: 1.640, Global test accuracy: 57.20
Round  71, Train loss: 0.267, Test loss: 2.344, Test accuracy: 52.24
Round  71, Global train loss: 0.267, Global test loss: 1.754, Global test accuracy: 56.00
Round  72, Train loss: 0.191, Test loss: 2.404, Test accuracy: 51.50
Round  72, Global train loss: 0.191, Global test loss: 2.075, Global test accuracy: 51.40
Round  73, Train loss: 0.288, Test loss: 2.433, Test accuracy: 51.04
Round  73, Global train loss: 0.288, Global test loss: 1.453, Global test accuracy: 59.40
Round  74, Train loss: 0.135, Test loss: 2.423, Test accuracy: 50.98
Round  74, Global train loss: 0.135, Global test loss: 1.791, Global test accuracy: 57.80
Round  75, Train loss: 0.283, Test loss: 2.494, Test accuracy: 50.14
Round  75, Global train loss: 0.283, Global test loss: 2.013, Global test accuracy: 48.60
Round  76, Train loss: 0.158, Test loss: 2.483, Test accuracy: 49.70
Round  76, Global train loss: 0.158, Global test loss: 1.792, Global test accuracy: 58.60
Round  77, Train loss: 0.165, Test loss: 2.487, Test accuracy: 50.56
Round  77, Global train loss: 0.165, Global test loss: 1.835, Global test accuracy: 57.60
Round  78, Train loss: 0.138, Test loss: 2.456, Test accuracy: 50.60
Round  78, Global train loss: 0.138, Global test loss: 2.257, Global test accuracy: 52.40
Round  79, Train loss: 0.208, Test loss: 2.403, Test accuracy: 51.30
Round  79, Global train loss: 0.208, Global test loss: 1.974, Global test accuracy: 53.40
Round  80, Train loss: 0.155, Test loss: 2.474, Test accuracy: 51.08
Round  80, Global train loss: 0.155, Global test loss: 1.970, Global test accuracy: 59.00
Round  81, Train loss: 0.133, Test loss: 2.570, Test accuracy: 51.04
Round  81, Global train loss: 0.133, Global test loss: 2.331, Global test accuracy: 53.60
Round  82, Train loss: 0.181, Test loss: 2.532, Test accuracy: 50.90
Round  82, Global train loss: 0.181, Global test loss: 2.469, Global test accuracy: 46.60
Round  83, Train loss: 0.216, Test loss: 2.529, Test accuracy: 51.96
Round  83, Global train loss: 0.216, Global test loss: 1.695, Global test accuracy: 57.20
Round  84, Train loss: 0.193, Test loss: 2.577, Test accuracy: 52.04
Round  84, Global train loss: 0.193, Global test loss: 1.629, Global test accuracy: 64.40
Round  85, Train loss: 0.148, Test loss: 2.515, Test accuracy: 51.32
Round  85, Global train loss: 0.148, Global test loss: 1.917, Global test accuracy: 57.80
Round  86, Train loss: 0.197, Test loss: 2.512, Test accuracy: 51.68
Round  86, Global train loss: 0.197, Global test loss: 1.725, Global test accuracy: 58.80
Round  87, Train loss: 0.207, Test loss: 2.516, Test accuracy: 51.44
Round  87, Global train loss: 0.207, Global test loss: 1.630, Global test accuracy: 59.80
Round  88, Train loss: 0.152, Test loss: 2.492, Test accuracy: 52.04
Round  88, Global train loss: 0.152, Global test loss: 1.653, Global test accuracy: 63.80
Round  89, Train loss: 0.185, Test loss: 2.510, Test accuracy: 51.52
Round  89, Global train loss: 0.185, Global test loss: 1.766, Global test accuracy: 58.40
Round  90, Train loss: 0.147, Test loss: 2.609, Test accuracy: 50.76
Round  90, Global train loss: 0.147, Global test loss: 1.828, Global test accuracy: 60.20
Round  91, Train loss: 0.128, Test loss: 2.577, Test accuracy: 51.34
Round  91, Global train loss: 0.128, Global test loss: 1.852, Global test accuracy: 61.20
Round  92, Train loss: 0.152, Test loss: 2.582, Test accuracy: 51.52
Round  92, Global train loss: 0.152, Global test loss: 2.120, Global test accuracy: 51.00
Round  93, Train loss: 0.154, Test loss: 2.539, Test accuracy: 51.76
Round  93, Global train loss: 0.154, Global test loss: 1.662, Global test accuracy: 61.40
Round  94, Train loss: 0.104, Test loss: 2.554, Test accuracy: 51.78
Round  94, Global train loss: 0.104, Global test loss: 1.806, Global test accuracy: 63.80
Round  95, Train loss: 0.154, Test loss: 2.540, Test accuracy: 52.26
Round  95, Global train loss: 0.154, Global test loss: 1.928, Global test accuracy: 56.00
Round  96, Train loss: 0.120, Test loss: 2.577, Test accuracy: 52.32
Round  96, Global train loss: 0.120, Global test loss: 2.147, Global test accuracy: 54.00
Round  97, Train loss: 0.083, Test loss: 2.631, Test accuracy: 51.90
Round  97, Global train loss: 0.083, Global test loss: 2.259, Global test accuracy: 55.20
Round  98, Train loss: 0.162, Test loss: 2.658, Test accuracy: 51.38
Round  98, Global train loss: 0.162, Global test loss: 2.409, Global test accuracy: 51.00
Round  99, Train loss: 0.164, Test loss: 2.646, Test accuracy: 51.94
Round  99, Global train loss: 0.164, Global test loss: 1.765, Global test accuracy: 58.20
Final Round, Train loss: 0.112, Test loss: 2.695, Test accuracy: 52.30
Final Round, Global train loss: 0.112, Global test loss: 1.765, Global test accuracy: 58.20
Average accuracy final 10 rounds: 51.696000000000005 

Average global accuracy final 10 rounds: 57.2 

999.7318558692932
[1.9233877658843994, 3.846775531768799, 5.401263236999512, 6.955750942230225, 8.58285927772522, 10.209967613220215, 11.668110609054565, 13.126253604888916, 14.535181045532227, 15.944108486175537, 17.512153387069702, 19.080198287963867, 20.63915252685547, 22.19810676574707, 23.720972776412964, 25.243838787078857, 26.837337255477905, 28.430835723876953, 29.982999324798584, 31.535162925720215, 33.08609700202942, 34.63703107833862, 36.190770626068115, 37.74451017379761, 39.23344945907593, 40.72238874435425, 42.318934202194214, 43.91547966003418, 45.40799903869629, 46.9005184173584, 48.41319251060486, 49.92586660385132, 51.54295802116394, 53.16004943847656, 54.74688529968262, 56.33372116088867, 57.980913162231445, 59.62810516357422, 61.20124006271362, 62.77437496185303, 64.20471787452698, 65.63506078720093, 67.24768495559692, 68.86030912399292, 70.49401021003723, 72.12771129608154, 73.7947587966919, 75.46180629730225, 77.14207601547241, 78.82234573364258, 80.2835099697113, 81.74467420578003, 83.22761797904968, 84.71056175231934, 86.16796159744263, 87.62536144256592, 89.25161170959473, 90.87786197662354, 92.55510020256042, 94.23233842849731, 95.85118412971497, 97.47002983093262, 99.09697985649109, 100.72392988204956, 102.29147219657898, 103.8590145111084, 105.42510938644409, 106.99120426177979, 108.53104639053345, 110.07088851928711, 111.60154962539673, 113.13221073150635, 114.64921450614929, 116.16621828079224, 117.68261051177979, 119.19900274276733, 120.81462168693542, 122.43024063110352, 123.98247456550598, 125.53470849990845, 127.04649186134338, 128.55827522277832, 130.06986093521118, 131.58144664764404, 133.22887015342712, 134.8762936592102, 136.38034749031067, 137.88440132141113, 139.4895441532135, 141.09468698501587, 142.62518310546875, 144.15567922592163, 145.83061003684998, 147.50554084777832, 149.2521448135376, 150.99874877929688, 152.63679218292236, 154.27483558654785, 155.89181518554688, 157.5087947845459, 159.2659318447113, 161.0230689048767, 162.64304995536804, 164.26303100585938, 165.84302234649658, 167.4230136871338, 169.0027060508728, 170.58239841461182, 172.1450457572937, 173.7076930999756, 175.22193050384521, 176.73616790771484, 178.27198433876038, 179.8078007698059, 181.27696585655212, 182.74613094329834, 184.31325435638428, 185.88037776947021, 187.40372037887573, 188.92706298828125, 190.58931970596313, 192.25157642364502, 194.2417652606964, 196.2319540977478, 197.88982963562012, 199.54770517349243, 201.3228302001953, 203.0979552268982, 204.67841410636902, 206.25887298583984, 207.72348880767822, 209.1881046295166, 210.80353546142578, 212.41896629333496, 214.03082370758057, 215.64268112182617, 217.23096346855164, 218.8192458152771, 220.33219170570374, 221.84513759613037, 223.5387134552002, 225.23228931427002, 226.91396951675415, 228.59564971923828, 230.14313006401062, 231.69061040878296, 233.16907286643982, 234.64753532409668, 236.21183133125305, 237.77612733840942, 239.34058141708374, 240.90503549575806, 242.53045892715454, 244.15588235855103, 245.71544432640076, 247.2750062942505, 248.83324527740479, 250.39148426055908, 251.99876046180725, 253.60603666305542, 255.2342734336853, 256.8625102043152, 258.58749985694885, 260.3124895095825, 261.8182954788208, 263.3241014480591, 265.1320309638977, 266.9399604797363, 268.8846046924591, 270.8292489051819, 272.48385643959045, 274.138463973999, 275.70028162002563, 277.26209926605225, 278.7667257785797, 280.2713522911072, 281.8623151779175, 283.4532780647278, 284.9673674106598, 286.4814567565918, 288.0252146720886, 289.56897258758545, 291.3809745311737, 293.19297647476196, 294.7255005836487, 296.2580246925354, 297.8259506225586, 299.3938765525818, 300.8404657840729, 302.28705501556396, 303.7590832710266, 305.23111152648926, 306.66319465637207, 308.0952777862549, 309.8425543308258, 311.58983087539673, 313.2032608985901, 314.81669092178345, 316.32401394844055, 317.83133697509766, 321.0493609905243, 324.2673850059509]
[37.26, 37.26, 41.74, 41.74, 45.2, 45.2, 46.28, 46.28, 48.98, 48.98, 50.3, 50.3, 51.24, 51.24, 55.0, 55.0, 56.98, 56.98, 54.46, 54.46, 56.54, 56.54, 53.22, 53.22, 55.08, 55.08, 54.3, 54.3, 54.5, 54.5, 54.42, 54.42, 54.52, 54.52, 54.72, 54.72, 55.64, 55.64, 56.24, 56.24, 56.9, 56.9, 56.78, 56.78, 56.36, 56.36, 56.28, 56.28, 55.32, 55.32, 52.92, 52.92, 50.64, 50.64, 52.56, 52.56, 53.2, 53.2, 52.74, 52.74, 50.3, 50.3, 50.02, 50.02, 48.98, 48.98, 50.74, 50.74, 49.1, 49.1, 48.72, 48.72, 48.26, 48.26, 49.18, 49.18, 48.96, 48.96, 49.4, 49.4, 50.22, 50.22, 50.9, 50.9, 50.18, 50.18, 52.02, 52.02, 51.16, 51.16, 50.4, 50.4, 50.72, 50.72, 49.52, 49.52, 50.02, 50.02, 50.24, 50.24, 49.54, 49.54, 49.2, 49.2, 50.76, 50.76, 50.58, 50.58, 50.4, 50.4, 49.64, 49.64, 48.96, 48.96, 48.84, 48.84, 49.3, 49.3, 49.86, 49.86, 49.3, 49.3, 50.82, 50.82, 52.08, 52.08, 51.38, 51.38, 51.14, 51.14, 51.36, 51.36, 51.36, 51.36, 50.48, 50.48, 50.12, 50.12, 49.72, 49.72, 51.6, 51.6, 52.24, 52.24, 51.5, 51.5, 51.04, 51.04, 50.98, 50.98, 50.14, 50.14, 49.7, 49.7, 50.56, 50.56, 50.6, 50.6, 51.3, 51.3, 51.08, 51.08, 51.04, 51.04, 50.9, 50.9, 51.96, 51.96, 52.04, 52.04, 51.32, 51.32, 51.68, 51.68, 51.44, 51.44, 52.04, 52.04, 51.52, 51.52, 50.76, 50.76, 51.34, 51.34, 51.52, 51.52, 51.76, 51.76, 51.78, 51.78, 52.26, 52.26, 52.32, 52.32, 51.9, 51.9, 51.38, 51.38, 51.94, 51.94, 52.3, 52.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.535, Test loss: 1.546, Test accuracy: 29.80
Round   0, Global train loss: 1.535, Global test loss: 1.551, Global test accuracy: 29.60
Round   1, Train loss: 1.466, Test loss: 1.439, Test accuracy: 40.02
Round   1, Global train loss: 1.466, Global test loss: 1.391, Global test accuracy: 45.00
Round   2, Train loss: 1.486, Test loss: 1.420, Test accuracy: 41.36
Round   2, Global train loss: 1.486, Global test loss: 1.377, Global test accuracy: 48.80
Round   3, Train loss: 1.484, Test loss: 1.399, Test accuracy: 41.76
Round   3, Global train loss: 1.484, Global test loss: 1.363, Global test accuracy: 48.60
Round   4, Train loss: 1.400, Test loss: 1.364, Test accuracy: 42.00
Round   4, Global train loss: 1.400, Global test loss: 1.273, Global test accuracy: 46.00
Round   5, Train loss: 1.357, Test loss: 1.342, Test accuracy: 43.38
Round   5, Global train loss: 1.357, Global test loss: 1.215, Global test accuracy: 50.40
Round   6, Train loss: 1.355, Test loss: 1.303, Test accuracy: 46.78
Round   6, Global train loss: 1.355, Global test loss: 1.203, Global test accuracy: 51.40
Round   7, Train loss: 1.483, Test loss: 1.337, Test accuracy: 46.72
Round   7, Global train loss: 1.483, Global test loss: 1.335, Global test accuracy: 50.20
Round   8, Train loss: 1.388, Test loss: 1.285, Test accuracy: 49.92
Round   8, Global train loss: 1.388, Global test loss: 1.222, Global test accuracy: 56.80
Round   9, Train loss: 1.448, Test loss: 1.290, Test accuracy: 49.74
Round   9, Global train loss: 1.448, Global test loss: 1.270, Global test accuracy: 58.40
Round  10, Train loss: 1.341, Test loss: 1.251, Test accuracy: 49.96
Round  10, Global train loss: 1.341, Global test loss: 1.178, Global test accuracy: 55.40
Round  11, Train loss: 1.445, Test loss: 1.238, Test accuracy: 51.76
Round  11, Global train loss: 1.445, Global test loss: 1.244, Global test accuracy: 54.20
Round  12, Train loss: 1.445, Test loss: 1.257, Test accuracy: 49.34
Round  12, Global train loss: 1.445, Global test loss: 1.288, Global test accuracy: 51.60
Round  13, Train loss: 1.318, Test loss: 1.242, Test accuracy: 50.92
Round  13, Global train loss: 1.318, Global test loss: 1.121, Global test accuracy: 61.40
Round  14, Train loss: 1.409, Test loss: 1.241, Test accuracy: 51.16
Round  14, Global train loss: 1.409, Global test loss: 1.220, Global test accuracy: 60.40
Round  15, Train loss: 1.281, Test loss: 1.236, Test accuracy: 52.82
Round  15, Global train loss: 1.281, Global test loss: 1.149, Global test accuracy: 55.40
Round  16, Train loss: 1.154, Test loss: 1.215, Test accuracy: 53.50
Round  16, Global train loss: 1.154, Global test loss: 1.019, Global test accuracy: 59.60
Round  17, Train loss: 1.133, Test loss: 1.248, Test accuracy: 53.70
Round  17, Global train loss: 1.133, Global test loss: 1.022, Global test accuracy: 60.20
Round  18, Train loss: 1.257, Test loss: 1.240, Test accuracy: 54.22
Round  18, Global train loss: 1.257, Global test loss: 1.067, Global test accuracy: 63.40
Round  19, Train loss: 1.308, Test loss: 1.207, Test accuracy: 54.54
Round  19, Global train loss: 1.308, Global test loss: 1.106, Global test accuracy: 62.60
Round  20, Train loss: 1.200, Test loss: 1.207, Test accuracy: 54.18
Round  20, Global train loss: 1.200, Global test loss: 1.109, Global test accuracy: 58.60
Round  21, Train loss: 1.137, Test loss: 1.202, Test accuracy: 54.32
Round  21, Global train loss: 1.137, Global test loss: 1.049, Global test accuracy: 61.40
Round  22, Train loss: 1.073, Test loss: 1.223, Test accuracy: 54.36
Round  22, Global train loss: 1.073, Global test loss: 1.075, Global test accuracy: 58.40
Round  23, Train loss: 1.394, Test loss: 1.218, Test accuracy: 54.08
Round  23, Global train loss: 1.394, Global test loss: 1.275, Global test accuracy: 53.80
Round  24, Train loss: 1.085, Test loss: 1.224, Test accuracy: 53.80
Round  24, Global train loss: 1.085, Global test loss: 1.060, Global test accuracy: 58.00
Round  25, Train loss: 1.191, Test loss: 1.223, Test accuracy: 53.62
Round  25, Global train loss: 1.191, Global test loss: 1.075, Global test accuracy: 63.60
Round  26, Train loss: 1.216, Test loss: 1.234, Test accuracy: 52.98
Round  26, Global train loss: 1.216, Global test loss: 1.163, Global test accuracy: 58.40
Round  27, Train loss: 1.075, Test loss: 1.230, Test accuracy: 53.16
Round  27, Global train loss: 1.075, Global test loss: 1.114, Global test accuracy: 59.00
Round  28, Train loss: 1.170, Test loss: 1.226, Test accuracy: 53.18
Round  28, Global train loss: 1.170, Global test loss: 1.147, Global test accuracy: 59.20
Round  29, Train loss: 1.199, Test loss: 1.251, Test accuracy: 51.88
Round  29, Global train loss: 1.199, Global test loss: 1.139, Global test accuracy: 59.40
Round  30, Train loss: 1.250, Test loss: 1.244, Test accuracy: 52.82
Round  30, Global train loss: 1.250, Global test loss: 1.244, Global test accuracy: 56.20
Round  31, Train loss: 1.168, Test loss: 1.278, Test accuracy: 50.72
Round  31, Global train loss: 1.168, Global test loss: 1.302, Global test accuracy: 48.60
Round  32, Train loss: 1.091, Test loss: 1.318, Test accuracy: 49.42
Round  32, Global train loss: 1.091, Global test loss: 1.245, Global test accuracy: 56.40
Round  33, Train loss: 1.091, Test loss: 1.329, Test accuracy: 50.06
Round  33, Global train loss: 1.091, Global test loss: 1.121, Global test accuracy: 59.80
Round  34, Train loss: 0.841, Test loss: 1.331, Test accuracy: 49.96
Round  34, Global train loss: 0.841, Global test loss: 1.188, Global test accuracy: 55.20
Round  35, Train loss: 0.858, Test loss: 1.351, Test accuracy: 49.74
Round  35, Global train loss: 0.858, Global test loss: 1.173, Global test accuracy: 54.20
Round  36, Train loss: 1.036, Test loss: 1.383, Test accuracy: 48.96
Round  36, Global train loss: 1.036, Global test loss: 1.180, Global test accuracy: 57.80
Round  37, Train loss: 0.793, Test loss: 1.405, Test accuracy: 48.62
Round  37, Global train loss: 0.793, Global test loss: 1.150, Global test accuracy: 59.40
Round  38, Train loss: 0.773, Test loss: 1.409, Test accuracy: 49.42
Round  38, Global train loss: 0.773, Global test loss: 1.187, Global test accuracy: 58.80
Round  39, Train loss: 0.915, Test loss: 1.410, Test accuracy: 49.98
Round  39, Global train loss: 0.915, Global test loss: 1.259, Global test accuracy: 53.20
Round  40, Train loss: 0.904, Test loss: 1.462, Test accuracy: 49.50
Round  40, Global train loss: 0.904, Global test loss: 1.365, Global test accuracy: 48.80
Round  41, Train loss: 0.728, Test loss: 1.474, Test accuracy: 49.88
Round  41, Global train loss: 0.728, Global test loss: 1.180, Global test accuracy: 59.40
Round  42, Train loss: 0.708, Test loss: 1.474, Test accuracy: 49.42
Round  42, Global train loss: 0.708, Global test loss: 1.167, Global test accuracy: 61.00
Round  43, Train loss: 0.732, Test loss: 1.552, Test accuracy: 47.42
Round  43, Global train loss: 0.732, Global test loss: 1.215, Global test accuracy: 58.20
Round  44, Train loss: 0.689, Test loss: 1.580, Test accuracy: 48.14
Round  44, Global train loss: 0.689, Global test loss: 1.352, Global test accuracy: 55.60
Round  45, Train loss: 0.626, Test loss: 1.661, Test accuracy: 46.72
Round  45, Global train loss: 0.626, Global test loss: 1.553, Global test accuracy: 50.40
Round  46, Train loss: 0.555, Test loss: 1.750, Test accuracy: 46.00
Round  46, Global train loss: 0.555, Global test loss: 1.308, Global test accuracy: 59.80
Round  47, Train loss: 0.763, Test loss: 1.769, Test accuracy: 46.40
Round  47, Global train loss: 0.763, Global test loss: 1.263, Global test accuracy: 57.00
Round  48, Train loss: 0.561, Test loss: 1.816, Test accuracy: 46.38
Round  48, Global train loss: 0.561, Global test loss: 1.719, Global test accuracy: 49.40
Round  49, Train loss: 0.499, Test loss: 1.916, Test accuracy: 45.56
Round  49, Global train loss: 0.499, Global test loss: 1.495, Global test accuracy: 57.20
Round  50, Train loss: 0.436, Test loss: 1.879, Test accuracy: 46.38
Round  50, Global train loss: 0.436, Global test loss: 1.560, Global test accuracy: 59.00
Round  51, Train loss: 0.547, Test loss: 1.868, Test accuracy: 47.16
Round  51, Global train loss: 0.547, Global test loss: 1.697, Global test accuracy: 49.00
Round  52, Train loss: 0.675, Test loss: 1.925, Test accuracy: 46.68
Round  52, Global train loss: 0.675, Global test loss: 1.734, Global test accuracy: 46.00
Round  53, Train loss: 0.766, Test loss: 1.933, Test accuracy: 46.58
Round  53, Global train loss: 0.766, Global test loss: 1.591, Global test accuracy: 45.80
Round  54, Train loss: 0.511, Test loss: 1.994, Test accuracy: 46.68
Round  54, Global train loss: 0.511, Global test loss: 1.417, Global test accuracy: 58.40
Round  55, Train loss: 0.489, Test loss: 2.012, Test accuracy: 46.54
Round  55, Global train loss: 0.489, Global test loss: 1.502, Global test accuracy: 56.60
Round  56, Train loss: 0.506, Test loss: 2.054, Test accuracy: 45.32
Round  56, Global train loss: 0.506, Global test loss: 1.613, Global test accuracy: 48.60
Round  57, Train loss: 0.658, Test loss: 2.053, Test accuracy: 46.04
Round  57, Global train loss: 0.658, Global test loss: 1.737, Global test accuracy: 42.80
Round  58, Train loss: 0.575, Test loss: 2.097, Test accuracy: 45.48
Round  58, Global train loss: 0.575, Global test loss: 1.608, Global test accuracy: 49.40
Round  59, Train loss: 0.471, Test loss: 2.144, Test accuracy: 44.88
Round  59, Global train loss: 0.471, Global test loss: 1.664, Global test accuracy: 47.80
Round  60, Train loss: 0.395, Test loss: 2.174, Test accuracy: 45.54
Round  60, Global train loss: 0.395, Global test loss: 1.739, Global test accuracy: 54.40
Round  61, Train loss: 0.600, Test loss: 2.134, Test accuracy: 47.14
Round  61, Global train loss: 0.600, Global test loss: 1.729, Global test accuracy: 46.60
Round  62, Train loss: 0.402, Test loss: 2.132, Test accuracy: 47.54
Round  62, Global train loss: 0.402, Global test loss: 1.621, Global test accuracy: 54.00
Round  63, Train loss: 0.301, Test loss: 2.146, Test accuracy: 47.32
Round  63, Global train loss: 0.301, Global test loss: 1.800, Global test accuracy: 57.80
Round  64, Train loss: 0.372, Test loss: 2.183, Test accuracy: 47.12
Round  64, Global train loss: 0.372, Global test loss: 1.859, Global test accuracy: 53.80
Round  65, Train loss: 0.263, Test loss: 2.207, Test accuracy: 46.80
Round  65, Global train loss: 0.263, Global test loss: 2.037, Global test accuracy: 53.00
Round  66, Train loss: 0.466, Test loss: 2.343, Test accuracy: 45.70
Round  66, Global train loss: 0.466, Global test loss: 2.032, Global test accuracy: 48.80
Round  67, Train loss: 0.385, Test loss: 2.364, Test accuracy: 45.62
Round  67, Global train loss: 0.385, Global test loss: 1.946, Global test accuracy: 47.60
Round  68, Train loss: 0.197, Test loss: 2.356, Test accuracy: 46.72
Round  68, Global train loss: 0.197, Global test loss: 2.162, Global test accuracy: 55.60
Round  69, Train loss: 0.460, Test loss: 2.297, Test accuracy: 48.10
Round  69, Global train loss: 0.460, Global test loss: 1.910, Global test accuracy: 47.00
Round  70, Train loss: 0.400, Test loss: 2.320, Test accuracy: 46.84
Round  70, Global train loss: 0.400, Global test loss: 2.060, Global test accuracy: 45.00
Round  71, Train loss: 0.388, Test loss: 2.290, Test accuracy: 46.64
Round  71, Global train loss: 0.388, Global test loss: 1.735, Global test accuracy: 50.00
Round  72, Train loss: 0.273, Test loss: 2.378, Test accuracy: 46.44
Round  72, Global train loss: 0.273, Global test loss: 2.277, Global test accuracy: 45.80
Round  73, Train loss: 0.489, Test loss: 2.341, Test accuracy: 47.02
Round  73, Global train loss: 0.489, Global test loss: 1.749, Global test accuracy: 49.80
Round  74, Train loss: 0.293, Test loss: 2.376, Test accuracy: 47.06
Round  74, Global train loss: 0.293, Global test loss: 1.991, Global test accuracy: 50.40
Round  75, Train loss: 0.303, Test loss: 2.421, Test accuracy: 47.04
Round  75, Global train loss: 0.303, Global test loss: 1.728, Global test accuracy: 55.80
Round  76, Train loss: 0.243, Test loss: 2.541, Test accuracy: 46.24
Round  76, Global train loss: 0.243, Global test loss: 2.132, Global test accuracy: 51.20
Round  77, Train loss: 0.169, Test loss: 2.552, Test accuracy: 46.68
Round  77, Global train loss: 0.169, Global test loss: 2.130, Global test accuracy: 56.00
Round  78, Train loss: 0.151, Test loss: 2.574, Test accuracy: 47.80
Round  78, Global train loss: 0.151, Global test loss: 2.304, Global test accuracy: 56.00
Round  79, Train loss: 0.329, Test loss: 2.656, Test accuracy: 47.98
Round  79, Global train loss: 0.329, Global test loss: 1.967, Global test accuracy: 51.20
Round  80, Train loss: 0.246, Test loss: 2.668, Test accuracy: 48.16
Round  80, Global train loss: 0.246, Global test loss: 2.206, Global test accuracy: 50.20
Round  81, Train loss: 0.205, Test loss: 2.679, Test accuracy: 47.14
Round  81, Global train loss: 0.205, Global test loss: 2.015, Global test accuracy: 58.20
Round  82, Train loss: 0.192, Test loss: 2.675, Test accuracy: 48.30
Round  82, Global train loss: 0.192, Global test loss: 2.180, Global test accuracy: 53.60
Round  83, Train loss: 0.373, Test loss: 2.685, Test accuracy: 47.98
Round  83, Global train loss: 0.373, Global test loss: 2.068, Global test accuracy: 50.60
Round  84, Train loss: 0.387, Test loss: 2.732, Test accuracy: 48.64
Round  84, Global train loss: 0.387, Global test loss: 2.039, Global test accuracy: 48.20
Round  85, Train loss: 0.160, Test loss: 2.723, Test accuracy: 48.06
Round  85, Global train loss: 0.160, Global test loss: 2.194, Global test accuracy: 52.60
Round  86, Train loss: 0.285, Test loss: 2.728, Test accuracy: 47.90
Round  86, Global train loss: 0.285, Global test loss: 1.638, Global test accuracy: 58.80
Round  87, Train loss: 0.342, Test loss: 2.607, Test accuracy: 48.02
Round  87, Global train loss: 0.342, Global test loss: 1.955, Global test accuracy: 48.80
Round  88, Train loss: 0.311, Test loss: 2.625, Test accuracy: 47.86
Round  88, Global train loss: 0.311, Global test loss: 2.047, Global test accuracy: 49.80
Round  89, Train loss: 0.254, Test loss: 2.690, Test accuracy: 47.40
Round  89, Global train loss: 0.254, Global test loss: 1.850, Global test accuracy: 57.00
Round  90, Train loss: 0.277, Test loss: 2.707, Test accuracy: 48.62
Round  90, Global train loss: 0.277, Global test loss: 2.527, Global test accuracy: 46.80
Round  91, Train loss: 0.263, Test loss: 2.782, Test accuracy: 47.22
Round  91, Global train loss: 0.263, Global test loss: 2.632, Global test accuracy: 40.20
Round  92, Train loss: 0.277, Test loss: 2.818, Test accuracy: 47.24
Round  92, Global train loss: 0.277, Global test loss: 2.323, Global test accuracy: 49.80
Round  93, Train loss: 0.238, Test loss: 2.893, Test accuracy: 46.88
Round  93, Global train loss: 0.238, Global test loss: 2.289, Global test accuracy: 50.60
Round  94, Train loss: 0.210, Test loss: 2.781, Test accuracy: 47.84
Round  94, Global train loss: 0.210, Global test loss: 2.184, Global test accuracy: 52.00/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.203, Test loss: 2.785, Test accuracy: 48.24
Round  95, Global train loss: 0.203, Global test loss: 2.173, Global test accuracy: 51.40
Round  96, Train loss: 0.155, Test loss: 2.841, Test accuracy: 47.86
Round  96, Global train loss: 0.155, Global test loss: 2.287, Global test accuracy: 49.00
Round  97, Train loss: 0.172, Test loss: 2.769, Test accuracy: 48.78
Round  97, Global train loss: 0.172, Global test loss: 2.138, Global test accuracy: 54.40
Round  98, Train loss: 0.152, Test loss: 2.808, Test accuracy: 48.10
Round  98, Global train loss: 0.152, Global test loss: 2.373, Global test accuracy: 54.80
Round  99, Train loss: 0.205, Test loss: 2.883, Test accuracy: 48.46
Round  99, Global train loss: 0.205, Global test loss: 2.224, Global test accuracy: 55.60
Final Round, Train loss: 0.152, Test loss: 2.901, Test accuracy: 49.66
Final Round, Global train loss: 0.152, Global test loss: 2.224, Global test accuracy: 55.60
Average accuracy final 10 rounds: 47.92400000000001 

Average global accuracy final 10 rounds: 50.46 

1031.4023625850677
[1.8530645370483398, 3.7061290740966797, 5.461209297180176, 7.216289520263672, 8.966518878936768, 10.716748237609863, 12.456890344619751, 14.197032451629639, 15.802522659301758, 17.408012866973877, 19.226361513137817, 21.044710159301758, 22.679063320159912, 24.313416481018066, 25.97298789024353, 27.632559299468994, 29.299837827682495, 30.967116355895996, 32.594078063964844, 34.22103977203369, 35.87235641479492, 37.52367305755615, 39.24951791763306, 40.97536277770996, 42.608644008636475, 44.24192523956299, 45.92149090766907, 47.60105657577515, 49.28027677536011, 50.95949697494507, 52.79752969741821, 54.63556241989136, 56.391677379608154, 58.14779233932495, 60.02618861198425, 61.904584884643555, 63.67997670173645, 65.45536851882935, 67.28689861297607, 69.1184287071228, 70.78071641921997, 72.44300413131714, 74.08627343177795, 75.72954273223877, 77.4380292892456, 79.14651584625244, 80.82731747627258, 82.50811910629272, 84.22360134124756, 85.93908357620239, 88.09744834899902, 90.25581312179565, 92.33059358596802, 94.40537405014038, 96.37797212600708, 98.35057020187378, 99.98352265357971, 101.61647510528564, 103.22970128059387, 104.8429274559021, 106.47239232063293, 108.10185718536377, 109.73163104057312, 111.36140489578247, 113.02441096305847, 114.68741703033447, 116.46619153022766, 118.24496603012085, 119.83707332611084, 121.42918062210083, 123.17948126792908, 124.92978191375732, 126.69216299057007, 128.4545440673828, 130.13152050971985, 131.80849695205688, 133.4577031135559, 135.10690927505493, 136.77513098716736, 138.44335269927979, 140.05106902122498, 141.65878534317017, 143.3997597694397, 145.14073419570923, 146.84933805465698, 148.55794191360474, 150.34843468666077, 152.1389274597168, 153.80322313308716, 155.46751880645752, 157.11055994033813, 158.75360107421875, 160.53191232681274, 162.31022357940674, 164.00653982162476, 165.70285606384277, 167.3596329689026, 169.0164098739624, 170.6825487613678, 172.3486876487732, 173.98884916305542, 175.62901067733765, 177.19465970993042, 178.7603087425232, 180.53484106063843, 182.30937337875366, 183.96375560760498, 185.6181378364563, 187.40834188461304, 189.19854593276978, 190.8354389667511, 192.47233200073242, 194.42643427848816, 196.3805365562439, 198.11314797401428, 199.84575939178467, 201.52523183822632, 203.20470428466797, 204.85082244873047, 206.49694061279297, 208.11361694335938, 209.73029327392578, 211.43148565292358, 213.1326780319214, 214.76446199417114, 216.3962459564209, 218.33885526657104, 220.2814645767212, 221.90660977363586, 223.53175497055054, 225.1580367088318, 226.78431844711304, 228.48015213012695, 230.17598581314087, 231.9936168193817, 233.81124782562256, 235.48586297035217, 237.1604781150818, 238.88215970993042, 240.60384130477905, 242.20085978507996, 243.79787826538086, 245.4693877696991, 247.14089727401733, 248.87809681892395, 250.61529636383057, 252.2156846523285, 253.81607294082642, 255.49862122535706, 257.1811695098877, 258.94289469718933, 260.70461988449097, 262.317622423172, 263.930624961853, 265.51631140708923, 267.10199785232544, 268.8782777786255, 270.65455770492554, 272.3359010219574, 274.01724433898926, 275.66163301467896, 277.30602169036865, 278.9058976173401, 280.5057735443115, 282.2634060382843, 284.0210385322571, 285.6543695926666, 287.2877006530762, 288.85244369506836, 290.41718673706055, 292.18895959854126, 293.960732460022, 295.6159896850586, 297.2712469100952, 298.9494001865387, 300.6275534629822, 302.2792081832886, 303.93086290359497, 305.60068464279175, 307.2705063819885, 308.9839560985565, 310.6974058151245, 312.3754074573517, 314.05340909957886, 315.72853088378906, 317.40365266799927, 318.9996123313904, 320.5955719947815, 322.2238676548004, 323.85216331481934, 325.5276138782501, 327.2030644416809, 328.8834927082062, 330.56392097473145, 332.27881145477295, 333.99370193481445, 335.7391548156738, 337.4846076965332, 339.16892886161804, 340.8532500267029, 344.26784229278564, 347.6824345588684]
[29.8, 29.8, 40.02, 40.02, 41.36, 41.36, 41.76, 41.76, 42.0, 42.0, 43.38, 43.38, 46.78, 46.78, 46.72, 46.72, 49.92, 49.92, 49.74, 49.74, 49.96, 49.96, 51.76, 51.76, 49.34, 49.34, 50.92, 50.92, 51.16, 51.16, 52.82, 52.82, 53.5, 53.5, 53.7, 53.7, 54.22, 54.22, 54.54, 54.54, 54.18, 54.18, 54.32, 54.32, 54.36, 54.36, 54.08, 54.08, 53.8, 53.8, 53.62, 53.62, 52.98, 52.98, 53.16, 53.16, 53.18, 53.18, 51.88, 51.88, 52.82, 52.82, 50.72, 50.72, 49.42, 49.42, 50.06, 50.06, 49.96, 49.96, 49.74, 49.74, 48.96, 48.96, 48.62, 48.62, 49.42, 49.42, 49.98, 49.98, 49.5, 49.5, 49.88, 49.88, 49.42, 49.42, 47.42, 47.42, 48.14, 48.14, 46.72, 46.72, 46.0, 46.0, 46.4, 46.4, 46.38, 46.38, 45.56, 45.56, 46.38, 46.38, 47.16, 47.16, 46.68, 46.68, 46.58, 46.58, 46.68, 46.68, 46.54, 46.54, 45.32, 45.32, 46.04, 46.04, 45.48, 45.48, 44.88, 44.88, 45.54, 45.54, 47.14, 47.14, 47.54, 47.54, 47.32, 47.32, 47.12, 47.12, 46.8, 46.8, 45.7, 45.7, 45.62, 45.62, 46.72, 46.72, 48.1, 48.1, 46.84, 46.84, 46.64, 46.64, 46.44, 46.44, 47.02, 47.02, 47.06, 47.06, 47.04, 47.04, 46.24, 46.24, 46.68, 46.68, 47.8, 47.8, 47.98, 47.98, 48.16, 48.16, 47.14, 47.14, 48.3, 48.3, 47.98, 47.98, 48.64, 48.64, 48.06, 48.06, 47.9, 47.9, 48.02, 48.02, 47.86, 47.86, 47.4, 47.4, 48.62, 48.62, 47.22, 47.22, 47.24, 47.24, 46.88, 46.88, 47.84, 47.84, 48.24, 48.24, 47.86, 47.86, 48.78, 48.78, 48.1, 48.1, 48.46, 48.46, 49.66, 49.66]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.518, Test loss: 1.519, Test accuracy: 38.52
Round   0, Global train loss: 1.518, Global test loss: 1.527, Global test accuracy: 42.00
Round   1, Train loss: 1.438, Test loss: 1.451, Test accuracy: 34.38
Round   1, Global train loss: 1.438, Global test loss: 1.403, Global test accuracy: 39.00
Round   2, Train loss: 1.489, Test loss: 1.447, Test accuracy: 37.32
Round   2, Global train loss: 1.489, Global test loss: 1.373, Global test accuracy: 50.00
Round   3, Train loss: 1.359, Test loss: 1.391, Test accuracy: 39.96
Round   3, Global train loss: 1.359, Global test loss: 1.244, Global test accuracy: 53.80
Round   4, Train loss: 1.367, Test loss: 1.387, Test accuracy: 40.60
Round   4, Global train loss: 1.367, Global test loss: 1.303, Global test accuracy: 45.40
Round   5, Train loss: 1.379, Test loss: 1.374, Test accuracy: 42.88
Round   5, Global train loss: 1.379, Global test loss: 1.277, Global test accuracy: 52.40
Round   6, Train loss: 1.405, Test loss: 1.346, Test accuracy: 48.82
Round   6, Global train loss: 1.405, Global test loss: 1.255, Global test accuracy: 60.20
Round   7, Train loss: 1.420, Test loss: 1.342, Test accuracy: 49.80
Round   7, Global train loss: 1.420, Global test loss: 1.254, Global test accuracy: 62.60
Round   8, Train loss: 1.318, Test loss: 1.350, Test accuracy: 50.18
Round   8, Global train loss: 1.318, Global test loss: 1.278, Global test accuracy: 57.20
Round   9, Train loss: 1.225, Test loss: 1.340, Test accuracy: 50.60
Round   9, Global train loss: 1.225, Global test loss: 1.156, Global test accuracy: 60.40
Round  10, Train loss: 1.301, Test loss: 1.323, Test accuracy: 52.72
Round  10, Global train loss: 1.301, Global test loss: 1.163, Global test accuracy: 60.60
Round  11, Train loss: 1.427, Test loss: 1.335, Test accuracy: 51.76
Round  11, Global train loss: 1.427, Global test loss: 1.310, Global test accuracy: 58.20
Round  12, Train loss: 1.252, Test loss: 1.290, Test accuracy: 53.04
Round  12, Global train loss: 1.252, Global test loss: 1.124, Global test accuracy: 63.60
Round  13, Train loss: 1.134, Test loss: 1.265, Test accuracy: 53.72
Round  13, Global train loss: 1.134, Global test loss: 1.129, Global test accuracy: 58.60
Round  14, Train loss: 1.099, Test loss: 1.277, Test accuracy: 53.50
Round  14, Global train loss: 1.099, Global test loss: 0.973, Global test accuracy: 66.00
Round  15, Train loss: 1.228, Test loss: 1.256, Test accuracy: 53.74
Round  15, Global train loss: 1.228, Global test loss: 1.093, Global test accuracy: 63.00
Round  16, Train loss: 1.035, Test loss: 1.272, Test accuracy: 53.18
Round  16, Global train loss: 1.035, Global test loss: 1.055, Global test accuracy: 59.60
Round  17, Train loss: 1.134, Test loss: 1.268, Test accuracy: 53.10
Round  17, Global train loss: 1.134, Global test loss: 1.048, Global test accuracy: 63.00
Round  18, Train loss: 1.216, Test loss: 1.261, Test accuracy: 52.72
Round  18, Global train loss: 1.216, Global test loss: 1.189, Global test accuracy: 57.80
Round  19, Train loss: 1.069, Test loss: 1.243, Test accuracy: 53.14
Round  19, Global train loss: 1.069, Global test loss: 1.012, Global test accuracy: 64.40
Round  20, Train loss: 1.099, Test loss: 1.209, Test accuracy: 54.26
Round  20, Global train loss: 1.099, Global test loss: 1.008, Global test accuracy: 63.80
Round  21, Train loss: 1.053, Test loss: 1.227, Test accuracy: 54.28
Round  21, Global train loss: 1.053, Global test loss: 1.190, Global test accuracy: 54.80
Round  22, Train loss: 0.982, Test loss: 1.241, Test accuracy: 53.78
Round  22, Global train loss: 0.982, Global test loss: 1.121, Global test accuracy: 56.60
Round  23, Train loss: 1.118, Test loss: 1.261, Test accuracy: 52.42
Round  23, Global train loss: 1.118, Global test loss: 1.148, Global test accuracy: 58.20
Round  24, Train loss: 1.127, Test loss: 1.274, Test accuracy: 52.30
Round  24, Global train loss: 1.127, Global test loss: 1.261, Global test accuracy: 54.00
Round  25, Train loss: 0.876, Test loss: 1.290, Test accuracy: 51.66
Round  25, Global train loss: 0.876, Global test loss: 1.027, Global test accuracy: 61.60
Round  26, Train loss: 0.966, Test loss: 1.285, Test accuracy: 52.14
Round  26, Global train loss: 0.966, Global test loss: 1.052, Global test accuracy: 59.80
Round  27, Train loss: 0.763, Test loss: 1.346, Test accuracy: 51.52
Round  27, Global train loss: 0.763, Global test loss: 1.145, Global test accuracy: 58.00
Round  28, Train loss: 0.894, Test loss: 1.374, Test accuracy: 50.30
Round  28, Global train loss: 0.894, Global test loss: 1.083, Global test accuracy: 60.20
Round  29, Train loss: 0.990, Test loss: 1.410, Test accuracy: 48.94
Round  29, Global train loss: 0.990, Global test loss: 1.069, Global test accuracy: 63.20
Round  30, Train loss: 0.810, Test loss: 1.479, Test accuracy: 47.90
Round  30, Global train loss: 0.810, Global test loss: 0.997, Global test accuracy: 60.80
Round  31, Train loss: 0.962, Test loss: 1.490, Test accuracy: 48.04
Round  31, Global train loss: 0.962, Global test loss: 1.159, Global test accuracy: 54.20
Round  32, Train loss: 0.839, Test loss: 1.507, Test accuracy: 47.70
Round  32, Global train loss: 0.839, Global test loss: 1.036, Global test accuracy: 61.40
Round  33, Train loss: 0.858, Test loss: 1.452, Test accuracy: 50.00
Round  33, Global train loss: 0.858, Global test loss: 1.024, Global test accuracy: 64.20
Round  34, Train loss: 0.763, Test loss: 1.451, Test accuracy: 50.52
Round  34, Global train loss: 0.763, Global test loss: 1.108, Global test accuracy: 58.40
Round  35, Train loss: 0.863, Test loss: 1.538, Test accuracy: 48.54
Round  35, Global train loss: 0.863, Global test loss: 1.303, Global test accuracy: 54.00
Round  36, Train loss: 0.645, Test loss: 1.515, Test accuracy: 49.52
Round  36, Global train loss: 0.645, Global test loss: 1.039, Global test accuracy: 62.20
Round  37, Train loss: 0.590, Test loss: 1.590, Test accuracy: 48.62
Round  37, Global train loss: 0.590, Global test loss: 1.099, Global test accuracy: 62.00
Round  38, Train loss: 0.766, Test loss: 1.606, Test accuracy: 48.68
Round  38, Global train loss: 0.766, Global test loss: 1.272, Global test accuracy: 55.40
Round  39, Train loss: 0.642, Test loss: 1.590, Test accuracy: 50.20
Round  39, Global train loss: 0.642, Global test loss: 1.151, Global test accuracy: 60.60
Round  40, Train loss: 0.586, Test loss: 1.643, Test accuracy: 50.72
Round  40, Global train loss: 0.586, Global test loss: 1.185, Global test accuracy: 60.80
Round  41, Train loss: 0.599, Test loss: 1.648, Test accuracy: 51.00
Round  41, Global train loss: 0.599, Global test loss: 1.187, Global test accuracy: 61.40
Round  42, Train loss: 0.504, Test loss: 1.665, Test accuracy: 51.64
Round  42, Global train loss: 0.504, Global test loss: 1.071, Global test accuracy: 63.20
Round  43, Train loss: 0.412, Test loss: 1.717, Test accuracy: 51.92
Round  43, Global train loss: 0.412, Global test loss: 1.237, Global test accuracy: 63.80
Round  44, Train loss: 0.523, Test loss: 1.661, Test accuracy: 52.78
Round  44, Global train loss: 0.523, Global test loss: 1.224, Global test accuracy: 61.80
Round  45, Train loss: 0.615, Test loss: 1.647, Test accuracy: 53.24
Round  45, Global train loss: 0.615, Global test loss: 1.470, Global test accuracy: 54.40
Round  46, Train loss: 0.360, Test loss: 1.709, Test accuracy: 53.50
Round  46, Global train loss: 0.360, Global test loss: 1.349, Global test accuracy: 63.20
Round  47, Train loss: 0.441, Test loss: 1.733, Test accuracy: 53.56
Round  47, Global train loss: 0.441, Global test loss: 1.102, Global test accuracy: 64.60
Round  48, Train loss: 0.396, Test loss: 1.791, Test accuracy: 52.88
Round  48, Global train loss: 0.396, Global test loss: 1.693, Global test accuracy: 55.20
Round  49, Train loss: 0.306, Test loss: 1.779, Test accuracy: 53.40
Round  49, Global train loss: 0.306, Global test loss: 1.311, Global test accuracy: 63.80
Round  50, Train loss: 0.264, Test loss: 1.768, Test accuracy: 53.88
Round  50, Global train loss: 0.264, Global test loss: 1.342, Global test accuracy: 64.20
Round  51, Train loss: 0.387, Test loss: 1.849, Test accuracy: 52.76
Round  51, Global train loss: 0.387, Global test loss: 1.797, Global test accuracy: 53.00
Round  52, Train loss: 0.463, Test loss: 1.789, Test accuracy: 53.94
Round  52, Global train loss: 0.463, Global test loss: 1.272, Global test accuracy: 59.40
Round  53, Train loss: 0.536, Test loss: 1.863, Test accuracy: 53.10
Round  53, Global train loss: 0.536, Global test loss: 1.428, Global test accuracy: 56.00
Round  54, Train loss: 0.334, Test loss: 1.827, Test accuracy: 53.34
Round  54, Global train loss: 0.334, Global test loss: 1.207, Global test accuracy: 64.80
Round  55, Train loss: 0.427, Test loss: 1.853, Test accuracy: 53.58
Round  55, Global train loss: 0.427, Global test loss: 1.439, Global test accuracy: 59.80
Round  56, Train loss: 0.439, Test loss: 1.860, Test accuracy: 53.56
Round  56, Global train loss: 0.439, Global test loss: 1.467, Global test accuracy: 57.20
Round  57, Train loss: 0.429, Test loss: 1.936, Test accuracy: 52.98
Round  57, Global train loss: 0.429, Global test loss: 1.406, Global test accuracy: 60.20
Round  58, Train loss: 0.325, Test loss: 1.894, Test accuracy: 53.10
Round  58, Global train loss: 0.325, Global test loss: 1.249, Global test accuracy: 63.80
Round  59, Train loss: 0.392, Test loss: 1.918, Test accuracy: 53.02
Round  59, Global train loss: 0.392, Global test loss: 1.497, Global test accuracy: 58.60
Round  60, Train loss: 0.379, Test loss: 1.973, Test accuracy: 52.32
Round  60, Global train loss: 0.379, Global test loss: 1.596, Global test accuracy: 54.20
Round  61, Train loss: 0.351, Test loss: 1.864, Test accuracy: 53.78
Round  61, Global train loss: 0.351, Global test loss: 1.193, Global test accuracy: 63.20
Round  62, Train loss: 0.344, Test loss: 1.894, Test accuracy: 52.68
Round  62, Global train loss: 0.344, Global test loss: 1.459, Global test accuracy: 60.20
Round  63, Train loss: 0.191, Test loss: 1.984, Test accuracy: 53.42
Round  63, Global train loss: 0.191, Global test loss: 1.824, Global test accuracy: 61.40
Round  64, Train loss: 0.383, Test loss: 1.985, Test accuracy: 54.62
Round  64, Global train loss: 0.383, Global test loss: 1.606, Global test accuracy: 57.80
Round  65, Train loss: 0.281, Test loss: 1.912, Test accuracy: 55.06
Round  65, Global train loss: 0.281, Global test loss: 1.600, Global test accuracy: 58.40
Round  66, Train loss: 0.271, Test loss: 1.942, Test accuracy: 55.10
Round  66, Global train loss: 0.271, Global test loss: 1.504, Global test accuracy: 63.00
Round  67, Train loss: 0.383, Test loss: 2.034, Test accuracy: 54.30
Round  67, Global train loss: 0.383, Global test loss: 1.627, Global test accuracy: 54.20
Round  68, Train loss: 0.179, Test loss: 2.073, Test accuracy: 53.12
Round  68, Global train loss: 0.179, Global test loss: 1.802, Global test accuracy: 57.00
Round  69, Train loss: 0.262, Test loss: 2.129, Test accuracy: 52.08
Round  69, Global train loss: 0.262, Global test loss: 1.457, Global test accuracy: 59.80
Round  70, Train loss: 0.221, Test loss: 2.092, Test accuracy: 52.48
Round  70, Global train loss: 0.221, Global test loss: 1.596, Global test accuracy: 59.80
Round  71, Train loss: 0.325, Test loss: 2.071, Test accuracy: 52.80
Round  71, Global train loss: 0.325, Global test loss: 1.483, Global test accuracy: 55.20
Round  72, Train loss: 0.244, Test loss: 1.986, Test accuracy: 53.94
Round  72, Global train loss: 0.244, Global test loss: 1.506, Global test accuracy: 59.80
Round  73, Train loss: 0.359, Test loss: 2.006, Test accuracy: 53.52
Round  73, Global train loss: 0.359, Global test loss: 1.358, Global test accuracy: 59.80
Round  74, Train loss: 0.345, Test loss: 2.094, Test accuracy: 52.62
Round  74, Global train loss: 0.345, Global test loss: 1.848, Global test accuracy: 49.40
Round  75, Train loss: 0.201, Test loss: 2.057, Test accuracy: 52.96
Round  75, Global train loss: 0.201, Global test loss: 1.416, Global test accuracy: 64.80
Round  76, Train loss: 0.265, Test loss: 2.081, Test accuracy: 53.78
Round  76, Global train loss: 0.265, Global test loss: 1.791, Global test accuracy: 53.60
Round  77, Train loss: 0.204, Test loss: 2.086, Test accuracy: 53.96
Round  77, Global train loss: 0.204, Global test loss: 1.716, Global test accuracy: 58.20
Round  78, Train loss: 0.132, Test loss: 2.003, Test accuracy: 54.18
Round  78, Global train loss: 0.132, Global test loss: 1.801, Global test accuracy: 58.60
Round  79, Train loss: 0.276, Test loss: 2.137, Test accuracy: 53.74
Round  79, Global train loss: 0.276, Global test loss: 1.703, Global test accuracy: 55.60
Round  80, Train loss: 0.211, Test loss: 2.184, Test accuracy: 53.30
Round  80, Global train loss: 0.211, Global test loss: 1.785, Global test accuracy: 60.20
Round  81, Train loss: 0.135, Test loss: 2.216, Test accuracy: 53.46
Round  81, Global train loss: 0.135, Global test loss: 1.706, Global test accuracy: 61.80
Round  82, Train loss: 0.100, Test loss: 2.224, Test accuracy: 53.58
Round  82, Global train loss: 0.100, Global test loss: 1.703, Global test accuracy: 64.00
Round  83, Train loss: 0.245, Test loss: 2.191, Test accuracy: 53.94
Round  83, Global train loss: 0.245, Global test loss: 1.494, Global test accuracy: 62.00
Round  84, Train loss: 0.292, Test loss: 2.222, Test accuracy: 53.56
Round  84, Global train loss: 0.292, Global test loss: 1.623, Global test accuracy: 58.40
Round  85, Train loss: 0.212, Test loss: 2.270, Test accuracy: 53.10
Round  85, Global train loss: 0.212, Global test loss: 1.796, Global test accuracy: 58.00
Round  86, Train loss: 0.252, Test loss: 2.282, Test accuracy: 52.44
Round  86, Global train loss: 0.252, Global test loss: 1.414, Global test accuracy: 64.00
Round  87, Train loss: 0.242, Test loss: 2.232, Test accuracy: 53.66
Round  87, Global train loss: 0.242, Global test loss: 1.500, Global test accuracy: 62.60
Round  88, Train loss: 0.189, Test loss: 2.210, Test accuracy: 53.94
Round  88, Global train loss: 0.189, Global test loss: 1.543, Global test accuracy: 62.20
Round  89, Train loss: 0.237, Test loss: 2.204, Test accuracy: 54.36
Round  89, Global train loss: 0.237, Global test loss: 1.386, Global test accuracy: 66.20
Round  90, Train loss: 0.194, Test loss: 2.260, Test accuracy: 54.18
Round  90, Global train loss: 0.194, Global test loss: 1.822, Global test accuracy: 58.00
Round  91, Train loss: 0.162, Test loss: 2.332, Test accuracy: 54.02
Round  91, Global train loss: 0.162, Global test loss: 1.988, Global test accuracy: 55.00
Round  92, Train loss: 0.169, Test loss: 2.320, Test accuracy: 54.22
Round  92, Global train loss: 0.169, Global test loss: 1.806, Global test accuracy: 60.40
Round  93, Train loss: 0.201, Test loss: 2.330, Test accuracy: 53.56
Round  93, Global train loss: 0.201, Global test loss: 1.698, Global test accuracy: 63.00
Round  94, Train loss: 0.234, Test loss: 2.325, Test accuracy: 53.88
Round  94, Global train loss: 0.234, Global test loss: 1.838, Global test accuracy: 58.60
Round  95, Train loss: 0.148, Test loss: 2.302, Test accuracy: 53.82
Round  95, Global train loss: 0.148, Global test loss: 1.606, Global test accuracy: 61.80
Round  96, Train loss: 0.125, Test loss: 2.408, Test accuracy: 52.84
Round  96, Global train loss: 0.125, Global test loss: 1.776, Global test accuracy: 55.80
Round  97, Train loss: 0.164, Test loss: 2.359, Test accuracy: 54.06
Round  97, Global train loss: 0.164, Global test loss: 1.894, Global test accuracy: 58.40
Round  98, Train loss: 0.117, Test loss: 2.410, Test accuracy: 52.98
Round  98, Global train loss: 0.117, Global test loss: 2.210, Global test accuracy: 52.60
Round  99, Train loss: 0.154, Test loss: 2.446, Test accuracy: 52.84
Round  99, Global train loss: 0.154, Global test loss: 1.779, Global test accuracy: 63.00
Final Round, Train loss: 0.131, Test loss: 2.625, Test accuracy: 52.26
Final Round, Global train loss: 0.131, Global test loss: 1.779, Global test accuracy: 63.00
Average accuracy final 10 rounds: 53.63999999999999
Average global accuracy final 10 rounds: 58.65999999999999
1523.2498059272766
[3.972634792327881, 7.716386556625366, 11.55814528465271, 15.323171854019165, 19.027657508850098, 22.782899618148804, 26.8500235080719, 30.52278208732605, 34.24632954597473, 37.939738273620605, 41.59907031059265, 45.25976085662842, 48.935365200042725, 52.81193399429321, 56.55473732948303, 60.22860074043274, 64.01021361351013, 67.7521448135376, 71.50400900840759, 75.5157880783081, 79.612233877182, 83.26150345802307, 87.07566785812378, 91.16682767868042, 95.02047324180603, 99.0070264339447, 102.94301891326904, 106.7004497051239, 110.49980187416077, 114.17572903633118, 117.97514748573303, 122.06044864654541, 125.91107702255249, 129.6089563369751, 133.38716459274292, 137.34017753601074, 141.32501196861267, 145.30100178718567, 149.13017582893372, 152.9458601474762, 156.83512020111084, 160.5279176235199, 164.21827220916748, 167.96220707893372, 171.97937989234924, 175.8826916217804, 179.61413192749023, 183.4560146331787, 187.3257462978363, 191.13054776191711, 194.8561508655548, 198.73487257957458, 202.4478132724762, 206.34665751457214, 210.1475932598114, 213.76190495491028, 217.55909085273743, 221.2540979385376, 224.94758701324463, 228.62000560760498, 232.42503142356873, 236.24321913719177, 239.9324939250946, 244.02405214309692, 247.6913776397705, 251.56538319587708, 255.2779824733734, 258.8668723106384, 262.6893255710602, 266.5689296722412, 270.48400592803955, 274.19558811187744, 277.86005330085754, 281.5423219203949, 285.27748823165894, 289.38729095458984, 293.2194402217865, 297.02553486824036, 300.7986364364624, 304.7111392021179, 308.3302593231201, 312.06265211105347, 315.95894384384155, 319.7149820327759, 323.30150270462036, 327.19079875946045, 331.3569531440735, 335.37631726264954, 339.2360682487488, 343.0022099018097, 346.9873309135437, 350.7272255420685, 354.4635064601898, 358.3650062084198, 362.1575734615326, 365.9033851623535, 369.6219985485077, 373.5517952442169, 377.35883378982544, 381.1059558391571, 388.03319787979126]
[38.52, 34.38, 37.32, 39.96, 40.6, 42.88, 48.82, 49.8, 50.18, 50.6, 52.72, 51.76, 53.04, 53.72, 53.5, 53.74, 53.18, 53.1, 52.72, 53.14, 54.26, 54.28, 53.78, 52.42, 52.3, 51.66, 52.14, 51.52, 50.3, 48.94, 47.9, 48.04, 47.7, 50.0, 50.52, 48.54, 49.52, 48.62, 48.68, 50.2, 50.72, 51.0, 51.64, 51.92, 52.78, 53.24, 53.5, 53.56, 52.88, 53.4, 53.88, 52.76, 53.94, 53.1, 53.34, 53.58, 53.56, 52.98, 53.1, 53.02, 52.32, 53.78, 52.68, 53.42, 54.62, 55.06, 55.1, 54.3, 53.12, 52.08, 52.48, 52.8, 53.94, 53.52, 52.62, 52.96, 53.78, 53.96, 54.18, 53.74, 53.3, 53.46, 53.58, 53.94, 53.56, 53.1, 52.44, 53.66, 53.94, 54.36, 54.18, 54.02, 54.22, 53.56, 53.88, 53.82, 52.84, 54.06, 52.98, 52.84, 52.26]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.571, Test loss: 1.521, Test accuracy: 32.86
Round   0, Global train loss: 1.571, Global test loss: 1.519, Global test accuracy: 32.60
Round   1, Train loss: 1.445, Test loss: 1.352, Test accuracy: 43.06
Round   1, Global train loss: 1.445, Global test loss: 1.332, Global test accuracy: 43.80
Round   2, Train loss: 1.428, Test loss: 1.329, Test accuracy: 45.08
Round   2, Global train loss: 1.428, Global test loss: 1.304, Global test accuracy: 47.00
Round   3, Train loss: 1.444, Test loss: 1.324, Test accuracy: 45.84
Round   3, Global train loss: 1.444, Global test loss: 1.304, Global test accuracy: 47.20
Round   4, Train loss: 1.295, Test loss: 1.208, Test accuracy: 49.48
Round   4, Global train loss: 1.295, Global test loss: 1.156, Global test accuracy: 50.00
Round   5, Train loss: 1.254, Test loss: 1.165, Test accuracy: 52.50
Round   5, Global train loss: 1.254, Global test loss: 1.096, Global test accuracy: 52.00
Round   6, Train loss: 1.278, Test loss: 1.147, Test accuracy: 54.20
Round   6, Global train loss: 1.278, Global test loss: 1.089, Global test accuracy: 58.40
Round   7, Train loss: 1.386, Test loss: 1.191, Test accuracy: 53.14
Round   7, Global train loss: 1.386, Global test loss: 1.206, Global test accuracy: 59.60
Round   8, Train loss: 1.194, Test loss: 1.113, Test accuracy: 58.06
Round   8, Global train loss: 1.194, Global test loss: 1.034, Global test accuracy: 63.60
Round   9, Train loss: 1.295, Test loss: 1.162, Test accuracy: 55.22
Round   9, Global train loss: 1.295, Global test loss: 1.107, Global test accuracy: 60.80
Round  10, Train loss: 1.253, Test loss: 1.089, Test accuracy: 58.90
Round  10, Global train loss: 1.253, Global test loss: 1.048, Global test accuracy: 61.00
Round  11, Train loss: 1.252, Test loss: 1.110, Test accuracy: 57.44
Round  11, Global train loss: 1.252, Global test loss: 1.123, Global test accuracy: 58.40
Round  12, Train loss: 1.483, Test loss: 1.205, Test accuracy: 56.64
Round  12, Global train loss: 1.483, Global test loss: 1.274, Global test accuracy: 61.40
Round  13, Train loss: 1.214, Test loss: 1.101, Test accuracy: 59.92
Round  13, Global train loss: 1.214, Global test loss: 1.003, Global test accuracy: 64.80
Round  14, Train loss: 1.503, Test loss: 1.174, Test accuracy: 58.58
Round  14, Global train loss: 1.503, Global test loss: 1.262, Global test accuracy: 62.20
Round  15, Train loss: 1.289, Test loss: 1.132, Test accuracy: 58.36
Round  15, Global train loss: 1.289, Global test loss: 1.057, Global test accuracy: 63.40
Round  16, Train loss: 1.216, Test loss: 1.099, Test accuracy: 59.38
Round  16, Global train loss: 1.216, Global test loss: 0.994, Global test accuracy: 67.60
Round  17, Train loss: 1.066, Test loss: 1.056, Test accuracy: 61.66
Round  17, Global train loss: 1.066, Global test loss: 0.889, Global test accuracy: 69.60
Round  18, Train loss: 1.020, Test loss: 1.001, Test accuracy: 64.90
Round  18, Global train loss: 1.020, Global test loss: 0.862, Global test accuracy: 69.40
Round  19, Train loss: 1.292, Test loss: 1.059, Test accuracy: 64.58
Round  19, Global train loss: 1.292, Global test loss: 1.023, Global test accuracy: 67.40
Round  20, Train loss: 1.232, Test loss: 1.097, Test accuracy: 60.72
Round  20, Global train loss: 1.232, Global test loss: 1.012, Global test accuracy: 65.00
Round  21, Train loss: 0.996, Test loss: 1.059, Test accuracy: 62.40
Round  21, Global train loss: 0.996, Global test loss: 0.891, Global test accuracy: 65.40
Round  22, Train loss: 1.022, Test loss: 1.059, Test accuracy: 63.12
Round  22, Global train loss: 1.022, Global test loss: 0.891, Global test accuracy: 67.00
Round  23, Train loss: 1.296, Test loss: 1.081, Test accuracy: 61.88
Round  23, Global train loss: 1.296, Global test loss: 1.123, Global test accuracy: 63.40
Round  24, Train loss: 1.001, Test loss: 1.014, Test accuracy: 64.30
Round  24, Global train loss: 1.001, Global test loss: 0.849, Global test accuracy: 66.40
Round  25, Train loss: 1.265, Test loss: 1.020, Test accuracy: 65.94
Round  25, Global train loss: 1.265, Global test loss: 0.996, Global test accuracy: 70.20
Round  26, Train loss: 1.134, Test loss: 1.046, Test accuracy: 63.54
Round  26, Global train loss: 1.134, Global test loss: 0.930, Global test accuracy: 66.80
Round  27, Train loss: 1.111, Test loss: 1.055, Test accuracy: 62.12
Round  27, Global train loss: 1.111, Global test loss: 0.902, Global test accuracy: 70.40
Round  28, Train loss: 1.122, Test loss: 1.045, Test accuracy: 64.34
Round  28, Global train loss: 1.122, Global test loss: 0.907, Global test accuracy: 69.40
Round  29, Train loss: 1.288, Test loss: 1.045, Test accuracy: 62.14
Round  29, Global train loss: 1.288, Global test loss: 1.021, Global test accuracy: 70.00
Round  30, Train loss: 1.280, Test loss: 1.027, Test accuracy: 65.10
Round  30, Global train loss: 1.280, Global test loss: 1.081, Global test accuracy: 65.80
Round  31, Train loss: 1.191, Test loss: 1.043, Test accuracy: 64.24
Round  31, Global train loss: 1.191, Global test loss: 1.034, Global test accuracy: 67.00
Round  32, Train loss: 1.051, Test loss: 1.029, Test accuracy: 63.72
Round  32, Global train loss: 1.051, Global test loss: 0.904, Global test accuracy: 67.00
Round  33, Train loss: 1.255, Test loss: 1.039, Test accuracy: 63.14
Round  33, Global train loss: 1.255, Global test loss: 1.006, Global test accuracy: 68.00
Round  34, Train loss: 0.760, Test loss: 0.974, Test accuracy: 67.24
Round  34, Global train loss: 0.760, Global test loss: 0.837, Global test accuracy: 68.00
Round  35, Train loss: 0.769, Test loss: 0.992, Test accuracy: 65.22
Round  35, Global train loss: 0.769, Global test loss: 0.842, Global test accuracy: 67.00
Round  36, Train loss: 1.183, Test loss: 1.000, Test accuracy: 64.88
Round  36, Global train loss: 1.183, Global test loss: 0.927, Global test accuracy: 68.40
Round  37, Train loss: 1.012, Test loss: 1.062, Test accuracy: 63.02
Round  37, Global train loss: 1.012, Global test loss: 0.873, Global test accuracy: 69.00
Round  38, Train loss: 0.793, Test loss: 1.014, Test accuracy: 65.88
Round  38, Global train loss: 0.793, Global test loss: 0.827, Global test accuracy: 68.60
Round  39, Train loss: 0.958, Test loss: 1.019, Test accuracy: 63.92
Round  39, Global train loss: 0.958, Global test loss: 0.850, Global test accuracy: 68.20
Round  40, Train loss: 1.000, Test loss: 1.063, Test accuracy: 62.46
Round  40, Global train loss: 1.000, Global test loss: 0.898, Global test accuracy: 66.40
Round  41, Train loss: 0.982, Test loss: 1.040, Test accuracy: 63.66
Round  41, Global train loss: 0.982, Global test loss: 0.869, Global test accuracy: 69.00
Round  42, Train loss: 0.882, Test loss: 0.976, Test accuracy: 67.04
Round  42, Global train loss: 0.882, Global test loss: 0.798, Global test accuracy: 72.60
Round  43, Train loss: 0.909, Test loss: 0.951, Test accuracy: 68.82
Round  43, Global train loss: 0.909, Global test loss: 0.835, Global test accuracy: 71.40
Round  44, Train loss: 0.927, Test loss: 1.054, Test accuracy: 63.22
Round  44, Global train loss: 0.927, Global test loss: 0.907, Global test accuracy: 70.00
Round  45, Train loss: 0.677, Test loss: 1.047, Test accuracy: 63.82
Round  45, Global train loss: 0.677, Global test loss: 0.877, Global test accuracy: 68.00
Round  46, Train loss: 0.822, Test loss: 1.022, Test accuracy: 65.20
Round  46, Global train loss: 0.822, Global test loss: 0.823, Global test accuracy: 70.00
Round  47, Train loss: 1.125, Test loss: 1.087, Test accuracy: 62.12
Round  47, Global train loss: 1.125, Global test loss: 0.972, Global test accuracy: 68.60
Round  48, Train loss: 0.765, Test loss: 1.174, Test accuracy: 59.66
Round  48, Global train loss: 0.765, Global test loss: 1.061, Global test accuracy: 64.00
Round  49, Train loss: 0.765, Test loss: 1.005, Test accuracy: 66.70
Round  49, Global train loss: 0.765, Global test loss: 0.809, Global test accuracy: 70.80
Round  50, Train loss: 0.709, Test loss: 1.030, Test accuracy: 66.44
Round  50, Global train loss: 0.709, Global test loss: 0.840, Global test accuracy: 69.80
Round  51, Train loss: 0.693, Test loss: 1.087, Test accuracy: 62.08
Round  51, Global train loss: 0.693, Global test loss: 0.971, Global test accuracy: 68.60
Round  52, Train loss: 0.957, Test loss: 1.084, Test accuracy: 62.48
Round  52, Global train loss: 0.957, Global test loss: 0.959, Global test accuracy: 65.20
Round  53, Train loss: 0.964, Test loss: 1.034, Test accuracy: 63.84
Round  53, Global train loss: 0.964, Global test loss: 0.911, Global test accuracy: 68.00
Round  54, Train loss: 0.875, Test loss: 1.018, Test accuracy: 64.66
Round  54, Global train loss: 0.875, Global test loss: 0.843, Global test accuracy: 72.00
Round  55, Train loss: 0.721, Test loss: 1.052, Test accuracy: 64.46
Round  55, Global train loss: 0.721, Global test loss: 0.905, Global test accuracy: 67.20
Round  56, Train loss: 0.814, Test loss: 1.154, Test accuracy: 59.66
Round  56, Global train loss: 0.814, Global test loss: 1.004, Global test accuracy: 63.60
Round  57, Train loss: 1.107, Test loss: 1.228, Test accuracy: 55.68
Round  57, Global train loss: 1.107, Global test loss: 1.180, Global test accuracy: 55.00
Round  58, Train loss: 0.949, Test loss: 1.097, Test accuracy: 59.82
Round  58, Global train loss: 0.949, Global test loss: 0.972, Global test accuracy: 65.80
Round  59, Train loss: 0.711, Test loss: 1.081, Test accuracy: 61.90
Round  59, Global train loss: 0.711, Global test loss: 0.920, Global test accuracy: 70.00
Round  60, Train loss: 0.616, Test loss: 1.116, Test accuracy: 61.82
Round  60, Global train loss: 0.616, Global test loss: 0.989, Global test accuracy: 66.80
Round  61, Train loss: 1.037, Test loss: 1.240, Test accuracy: 56.80
Round  61, Global train loss: 1.037, Global test loss: 1.186, Global test accuracy: 54.60
Round  62, Train loss: 0.600, Test loss: 1.011, Test accuracy: 65.46
Round  62, Global train loss: 0.600, Global test loss: 0.823, Global test accuracy: 71.00
Round  63, Train loss: 0.606, Test loss: 1.064, Test accuracy: 63.42
Round  63, Global train loss: 0.606, Global test loss: 0.904, Global test accuracy: 68.00
Round  64, Train loss: 0.586, Test loss: 1.096, Test accuracy: 62.24
Round  64, Global train loss: 0.586, Global test loss: 0.982, Global test accuracy: 66.20
Round  65, Train loss: 0.387, Test loss: 1.012, Test accuracy: 65.10
Round  65, Global train loss: 0.387, Global test loss: 0.991, Global test accuracy: 65.20
Round  66, Train loss: 0.786, Test loss: 1.152, Test accuracy: 60.12
Round  66, Global train loss: 0.786, Global test loss: 0.981, Global test accuracy: 65.60
Round  67, Train loss: 0.537, Test loss: 1.094, Test accuracy: 63.26
Round  67, Global train loss: 0.537, Global test loss: 0.978, Global test accuracy: 68.00
Round  68, Train loss: 0.347, Test loss: 1.118, Test accuracy: 64.30
Round  68, Global train loss: 0.347, Global test loss: 1.067, Global test accuracy: 66.40
Round  69, Train loss: 0.772, Test loss: 1.210, Test accuracy: 59.00
Round  69, Global train loss: 0.772, Global test loss: 1.071, Global test accuracy: 61.60
Round  70, Train loss: 0.658, Test loss: 1.187, Test accuracy: 59.98
Round  70, Global train loss: 0.658, Global test loss: 0.993, Global test accuracy: 65.40
Round  71, Train loss: 0.638, Test loss: 1.133, Test accuracy: 61.94
Round  71, Global train loss: 0.638, Global test loss: 1.097, Global test accuracy: 61.40
Round  72, Train loss: 0.579, Test loss: 1.186, Test accuracy: 58.80
Round  72, Global train loss: 0.579, Global test loss: 1.150, Global test accuracy: 57.40
Round  73, Train loss: 0.813, Test loss: 1.089, Test accuracy: 61.70
Round  73, Global train loss: 0.813, Global test loss: 0.899, Global test accuracy: 68.20
Round  74, Train loss: 0.483, Test loss: 1.132, Test accuracy: 59.26
Round  74, Global train loss: 0.483, Global test loss: 1.013, Global test accuracy: 66.80
Round  75, Train loss: 0.464, Test loss: 1.049, Test accuracy: 64.82
Round  75, Global train loss: 0.464, Global test loss: 0.892, Global test accuracy: 70.40
Round  76, Train loss: 0.422, Test loss: 1.136, Test accuracy: 63.28
Round  76, Global train loss: 0.422, Global test loss: 1.005, Global test accuracy: 67.60
Round  77, Train loss: 0.303, Test loss: 1.074, Test accuracy: 64.92
Round  77, Global train loss: 0.303, Global test loss: 1.067, Global test accuracy: 64.00
Round  78, Train loss: 0.334, Test loss: 1.096, Test accuracy: 64.58
Round  78, Global train loss: 0.334, Global test loss: 1.016, Global test accuracy: 68.40
Round  79, Train loss: 0.563, Test loss: 1.165, Test accuracy: 60.06
Round  79, Global train loss: 0.563, Global test loss: 1.131, Global test accuracy: 58.60
Round  80, Train loss: 0.574, Test loss: 1.406, Test accuracy: 54.82
Round  80, Global train loss: 0.574, Global test loss: 1.272, Global test accuracy: 55.20
Round  81, Train loss: 0.307, Test loss: 1.222, Test accuracy: 62.60
Round  81, Global train loss: 0.307, Global test loss: 1.211, Global test accuracy: 66.40
Round  82, Train loss: 0.412, Test loss: 1.161, Test accuracy: 61.68
Round  82, Global train loss: 0.412, Global test loss: 1.002, Global test accuracy: 66.40
Round  83, Train loss: 0.584, Test loss: 1.251, Test accuracy: 58.86
Round  83, Global train loss: 0.584, Global test loss: 1.055, Global test accuracy: 66.20
Round  84, Train loss: 0.787, Test loss: 1.396, Test accuracy: 53.28
Round  84, Global train loss: 0.787, Global test loss: 1.240, Global test accuracy: 52.40
Round  85, Train loss: 0.292, Test loss: 1.111, Test accuracy: 64.14
Round  85, Global train loss: 0.292, Global test loss: 1.010, Global test accuracy: 68.60
Round  86, Train loss: 0.615, Test loss: 1.129, Test accuracy: 61.52
Round  86, Global train loss: 0.615, Global test loss: 0.898, Global test accuracy: 66.60
Round  87, Train loss: 0.588, Test loss: 1.180, Test accuracy: 60.42
Round  87, Global train loss: 0.588, Global test loss: 0.975, Global test accuracy: 66.00
Round  88, Train loss: 0.557, Test loss: 1.203, Test accuracy: 59.92
Round  88, Global train loss: 0.557, Global test loss: 1.046, Global test accuracy: 64.40
Round  89, Train loss: 0.563, Test loss: 1.178, Test accuracy: 60.70
Round  89, Global train loss: 0.563, Global test loss: 0.974, Global test accuracy: 65.60
Round  90, Train loss: 0.607, Test loss: 1.330, Test accuracy: 56.08
Round  90, Global train loss: 0.607, Global test loss: 1.260, Global test accuracy: 54.00
Round  91, Train loss: 0.531, Test loss: 1.381, Test accuracy: 55.02
Round  91, Global train loss: 0.531, Global test loss: 1.322, Global test accuracy: 53.00
Round  92, Train loss: 0.475, Test loss: 1.362, Test accuracy: 58.76
Round  92, Global train loss: 0.475, Global test loss: 1.141, Global test accuracy: 62.40
Round  93, Train loss: 0.513, Test loss: 1.202, Test accuracy: 60.32
Round  93, Global train loss: 0.513, Global test loss: 0.999, Global test accuracy: 66.00
Round  94, Train loss: 0.467, Test loss: 1.304, Test accuracy: 59.24
Round  94, Global train loss: 0.467, Global test loss: 1.097, Global test accuracy: 62.20
Round  95, Train loss: 0.388, Test loss: 1.278, Test accuracy: 59.24
Round  95, Global train loss: 0.388, Global test loss: 1.274, Global test accuracy: 56.00
Round  96, Train loss: 0.361, Test loss: 1.345, Test accuracy: 57.26
Round  96, Global train loss: 0.361, Global test loss: 1.338, Global test accuracy: 54.40
Round  97, Train loss: 0.309, Test loss: 1.291, Test accuracy: 57.16
Round  97, Global train loss: 0.309, Global test loss: 1.228, Global test accuracy: 58.40
Round  98, Train loss: 0.230, Test loss: 1.291, Test accuracy: 60.02
Round  98, Global train loss: 0.230, Global test loss: 1.190, Global test accuracy: 64.80
Round  99, Train loss: 0.481, Test loss: 1.370, Test accuracy: 60.16
Round  99, Global train loss: 0.481, Global test loss: 1.082, Global test accuracy: 65.80
Final Round, Train loss: 0.350, Test loss: 1.395, Test accuracy: 59.96
Final Round, Global train loss: 0.350, Global test loss: 1.082, Global test accuracy: 65.80
Average accuracy final 10 rounds: 58.326
907.238559961319
[2.127255916595459, 3.938887119293213, 5.873089551925659, 7.730780363082886, 9.547510147094727, 11.437309265136719, 13.195486783981323, 14.980862379074097, 16.761388540267944, 18.55604314804077, 20.514835357666016, 22.37932538986206, 24.43209481239319, 26.27928924560547, 28.075624704360962, 30.001184940338135, 31.89026165008545, 33.884334325790405, 35.676440954208374, 37.43616843223572, 39.25180387496948, 41.06511902809143, 42.88673734664917, 44.809669494628906, 46.65726327896118, 48.63960552215576, 50.37587904930115, 52.141756534576416, 53.99405074119568, 55.73205304145813, 57.53465247154236, 59.28023815155029, 61.11772036552429, 63.001439332962036, 64.74605369567871, 66.58810114860535, 68.32779312133789, 70.1754219532013, 71.9281690120697, 73.72591876983643, 75.49150276184082, 77.33301877975464, 79.14045977592468, 80.928635597229, 82.68107891082764, 84.51522445678711, 86.31076049804688, 88.39900779724121, 90.34859848022461, 92.2445297241211, 94.04585385322571, 95.80397820472717, 97.694491147995, 99.49338221549988, 101.33844923973083, 103.021005153656, 104.76912999153137, 106.53559017181396, 108.35835695266724, 110.17453837394714, 111.96290898323059, 113.75268363952637, 115.56753182411194, 117.30704522132874, 119.22952198982239, 121.15493202209473, 123.28096318244934, 125.12612748146057, 126.83732557296753, 128.81222701072693, 130.6713752746582, 132.5066273212433, 134.26786351203918, 136.18399739265442, 137.9850561618805, 139.73651885986328, 141.56094551086426, 143.41364812850952, 145.29885005950928, 147.11679553985596, 148.96050643920898, 150.7346842288971, 152.59072136878967, 154.61525416374207, 156.92448711395264, 159.03206872940063, 161.15903091430664, 163.3461389541626, 165.29070520401, 167.24132204055786, 169.59242248535156, 171.4721052646637, 173.31166005134583, 175.27939653396606, 177.27650833129883, 179.1940369606018, 180.97052431106567, 182.81656908988953, 184.57551193237305, 186.3623116016388, 189.3955717086792]
[32.86, 43.06, 45.08, 45.84, 49.48, 52.5, 54.2, 53.14, 58.06, 55.22, 58.9, 57.44, 56.64, 59.92, 58.58, 58.36, 59.38, 61.66, 64.9, 64.58, 60.72, 62.4, 63.12, 61.88, 64.3, 65.94, 63.54, 62.12, 64.34, 62.14, 65.1, 64.24, 63.72, 63.14, 67.24, 65.22, 64.88, 63.02, 65.88, 63.92, 62.46, 63.66, 67.04, 68.82, 63.22, 63.82, 65.2, 62.12, 59.66, 66.7, 66.44, 62.08, 62.48, 63.84, 64.66, 64.46, 59.66, 55.68, 59.82, 61.9, 61.82, 56.8, 65.46, 63.42, 62.24, 65.1, 60.12, 63.26, 64.3, 59.0, 59.98, 61.94, 58.8, 61.7, 59.26, 64.82, 63.28, 64.92, 64.58, 60.06, 54.82, 62.6, 61.68, 58.86, 53.28, 64.14, 61.52, 60.42, 59.92, 60.7, 56.08, 55.02, 58.76, 60.32, 59.24, 59.24, 57.26, 57.16, 60.02, 60.16, 59.96]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.556, Test loss: 1.526, Test accuracy: 33.38
Round   0, Global train loss: 1.556, Global test loss: 1.512, Global test accuracy: 38.20
Round   1, Train loss: 1.467, Test loss: 1.446, Test accuracy: 38.90
Round   1, Global train loss: 1.467, Global test loss: 1.410, Global test accuracy: 43.60
Round   2, Train loss: 1.428, Test loss: 1.401, Test accuracy: 41.70
Round   2, Global train loss: 1.428, Global test loss: 1.348, Global test accuracy: 45.60
Round   3, Train loss: 1.401, Test loss: 1.373, Test accuracy: 43.60
Round   3, Global train loss: 1.401, Global test loss: 1.309, Global test accuracy: 49.00
Round   4, Train loss: 1.382, Test loss: 1.327, Test accuracy: 47.04
Round   4, Global train loss: 1.382, Global test loss: 1.244, Global test accuracy: 50.00
Round   5, Train loss: 1.357, Test loss: 1.312, Test accuracy: 49.66
Round   5, Global train loss: 1.357, Global test loss: 1.227, Global test accuracy: 53.80
Round   6, Train loss: 1.337, Test loss: 1.284, Test accuracy: 50.98
Round   6, Global train loss: 1.337, Global test loss: 1.183, Global test accuracy: 56.40
Round   7, Train loss: 1.318, Test loss: 1.272, Test accuracy: 52.16
Round   7, Global train loss: 1.318, Global test loss: 1.159, Global test accuracy: 60.80
Round   8, Train loss: 1.300, Test loss: 1.257, Test accuracy: 52.06
Round   8, Global train loss: 1.300, Global test loss: 1.134, Global test accuracy: 60.40
Round   9, Train loss: 1.287, Test loss: 1.247, Test accuracy: 53.24
Round   9, Global train loss: 1.287, Global test loss: 1.119, Global test accuracy: 62.60
Round  10, Train loss: 1.203, Test loss: 1.206, Test accuracy: 54.78
Round  10, Global train loss: 1.203, Global test loss: 0.943, Global test accuracy: 65.60
Round  11, Train loss: 1.194, Test loss: 1.366, Test accuracy: 43.96
Round  11, Global train loss: 1.194, Global test loss: 1.385, Global test accuracy: 38.80
Round  12, Train loss: 1.144, Test loss: 1.244, Test accuracy: 49.34
Round  12, Global train loss: 1.144, Global test loss: 0.979, Global test accuracy: 61.40
Round  13, Train loss: 1.116, Test loss: 1.333, Test accuracy: 45.84
Round  13, Global train loss: 1.116, Global test loss: 1.107, Global test accuracy: 56.40
Round  14, Train loss: 1.036, Test loss: 1.221, Test accuracy: 50.00
Round  14, Global train loss: 1.036, Global test loss: 0.866, Global test accuracy: 64.00
Round  15, Train loss: 1.248, Test loss: 1.388, Test accuracy: 43.70
Round  15, Global train loss: 1.248, Global test loss: 1.306, Global test accuracy: 48.80
Round  16, Train loss: 1.244, Test loss: 1.330, Test accuracy: 46.24
Round  16, Global train loss: 1.244, Global test loss: 1.224, Global test accuracy: 50.40
Round  17, Train loss: 1.261, Test loss: 1.263, Test accuracy: 49.46
Round  17, Global train loss: 1.261, Global test loss: 1.197, Global test accuracy: 50.80
Round  18, Train loss: 1.134, Test loss: 1.247, Test accuracy: 49.68
Round  18, Global train loss: 1.134, Global test loss: 1.199, Global test accuracy: 53.60
Round  19, Train loss: 1.060, Test loss: 1.169, Test accuracy: 54.52
Round  19, Global train loss: 1.060, Global test loss: 0.880, Global test accuracy: 66.20
Round  20, Train loss: 1.208, Test loss: 1.338, Test accuracy: 46.58
Round  20, Global train loss: 1.208, Global test loss: 1.310, Global test accuracy: 47.80
Round  21, Train loss: 1.141, Test loss: 1.388, Test accuracy: 44.34
Round  21, Global train loss: 1.141, Global test loss: 1.411, Global test accuracy: 38.60
Round  22, Train loss: 1.154, Test loss: 1.371, Test accuracy: 46.84
Round  22, Global train loss: 1.154, Global test loss: 1.299, Global test accuracy: 47.40
Round  23, Train loss: 1.091, Test loss: 1.299, Test accuracy: 49.12
Round  23, Global train loss: 1.091, Global test loss: 1.051, Global test accuracy: 57.60
Round  24, Train loss: 1.121, Test loss: 1.184, Test accuracy: 53.36
Round  24, Global train loss: 1.121, Global test loss: 1.040, Global test accuracy: 60.80
Round  25, Train loss: 0.870, Test loss: 1.184, Test accuracy: 54.36
Round  25, Global train loss: 0.870, Global test loss: 1.024, Global test accuracy: 63.20
Round  26, Train loss: 0.909, Test loss: 1.181, Test accuracy: 54.48
Round  26, Global train loss: 0.909, Global test loss: 0.988, Global test accuracy: 62.60
Round  27, Train loss: 1.017, Test loss: 1.193, Test accuracy: 51.36
Round  27, Global train loss: 1.017, Global test loss: 0.911, Global test accuracy: 65.00
Round  28, Train loss: 0.916, Test loss: 1.278, Test accuracy: 49.28
Round  28, Global train loss: 0.916, Global test loss: 1.066, Global test accuracy: 59.60
Round  29, Train loss: 0.981, Test loss: 1.122, Test accuracy: 55.66
Round  29, Global train loss: 0.981, Global test loss: 0.785, Global test accuracy: 70.20
Round  30, Train loss: 0.907, Test loss: 1.137, Test accuracy: 54.32
Round  30, Global train loss: 0.907, Global test loss: 0.807, Global test accuracy: 67.40
Round  31, Train loss: 0.911, Test loss: 1.201, Test accuracy: 52.04
Round  31, Global train loss: 0.911, Global test loss: 0.964, Global test accuracy: 61.60
Round  32, Train loss: 0.848, Test loss: 1.224, Test accuracy: 50.52
Round  32, Global train loss: 0.848, Global test loss: 0.993, Global test accuracy: 63.40
Round  33, Train loss: 0.907, Test loss: 1.104, Test accuracy: 56.02
Round  33, Global train loss: 0.907, Global test loss: 0.719, Global test accuracy: 72.00
Round  34, Train loss: 0.889, Test loss: 1.142, Test accuracy: 53.76
Round  34, Global train loss: 0.889, Global test loss: 1.007, Global test accuracy: 61.20
Round  35, Train loss: 0.875, Test loss: 1.201, Test accuracy: 51.72
Round  35, Global train loss: 0.875, Global test loss: 1.089, Global test accuracy: 58.40
Round  36, Train loss: 0.900, Test loss: 1.129, Test accuracy: 56.18
Round  36, Global train loss: 0.900, Global test loss: 0.771, Global test accuracy: 67.60
Round  37, Train loss: 1.047, Test loss: 1.143, Test accuracy: 55.24
Round  37, Global train loss: 1.047, Global test loss: 1.107, Global test accuracy: 53.40
Round  38, Train loss: 0.949, Test loss: 1.134, Test accuracy: 55.80
Round  38, Global train loss: 0.949, Global test loss: 0.921, Global test accuracy: 63.20
Round  39, Train loss: 0.892, Test loss: 1.161, Test accuracy: 53.96
Round  39, Global train loss: 0.892, Global test loss: 0.907, Global test accuracy: 69.00
Round  40, Train loss: 0.891, Test loss: 1.176, Test accuracy: 54.62
Round  40, Global train loss: 0.891, Global test loss: 0.925, Global test accuracy: 64.40
Round  41, Train loss: 0.965, Test loss: 1.144, Test accuracy: 55.44
Round  41, Global train loss: 0.965, Global test loss: 1.054, Global test accuracy: 59.60
Round  42, Train loss: 0.821, Test loss: 1.137, Test accuracy: 55.84
Round  42, Global train loss: 0.821, Global test loss: 0.939, Global test accuracy: 63.20
Round  43, Train loss: 0.832, Test loss: 1.203, Test accuracy: 53.20
Round  43, Global train loss: 0.832, Global test loss: 1.074, Global test accuracy: 56.20
Round  44, Train loss: 0.855, Test loss: 1.268, Test accuracy: 50.16
Round  44, Global train loss: 0.855, Global test loss: 1.262, Global test accuracy: 50.00
Round  45, Train loss: 0.791, Test loss: 1.203, Test accuracy: 51.88
Round  45, Global train loss: 0.791, Global test loss: 1.105, Global test accuracy: 56.00
Round  46, Train loss: 0.830, Test loss: 1.123, Test accuracy: 55.96
Round  46, Global train loss: 0.830, Global test loss: 0.985, Global test accuracy: 61.60
Round  47, Train loss: 0.723, Test loss: 1.094, Test accuracy: 57.32
Round  47, Global train loss: 0.723, Global test loss: 0.821, Global test accuracy: 67.20
Round  48, Train loss: 0.806, Test loss: 1.209, Test accuracy: 52.40
Round  48, Global train loss: 0.806, Global test loss: 1.243, Global test accuracy: 50.40
Round  49, Train loss: 0.746, Test loss: 1.166, Test accuracy: 56.34
Round  49, Global train loss: 0.746, Global test loss: 1.056, Global test accuracy: 59.60
Round  50, Train loss: 0.697, Test loss: 1.181, Test accuracy: 54.58
Round  50, Global train loss: 0.697, Global test loss: 1.064, Global test accuracy: 59.00
Round  51, Train loss: 0.815, Test loss: 1.455, Test accuracy: 43.18
Round  51, Global train loss: 0.815, Global test loss: 1.549, Global test accuracy: 36.00
Round  52, Train loss: 0.802, Test loss: 1.230, Test accuracy: 52.90
Round  52, Global train loss: 0.802, Global test loss: 1.008, Global test accuracy: 63.60
Round  53, Train loss: 0.721, Test loss: 1.119, Test accuracy: 57.02
Round  53, Global train loss: 0.721, Global test loss: 0.771, Global test accuracy: 70.20
Round  54, Train loss: 0.665, Test loss: 1.127, Test accuracy: 57.30
Round  54, Global train loss: 0.665, Global test loss: 0.936, Global test accuracy: 64.40
Round  55, Train loss: 0.696, Test loss: 1.172, Test accuracy: 55.18
Round  55, Global train loss: 0.696, Global test loss: 0.974, Global test accuracy: 62.80
Round  56, Train loss: 0.737, Test loss: 1.235, Test accuracy: 53.34
Round  56, Global train loss: 0.737, Global test loss: 1.065, Global test accuracy: 59.60
Round  57, Train loss: 0.654, Test loss: 1.154, Test accuracy: 55.96
Round  57, Global train loss: 0.654, Global test loss: 0.907, Global test accuracy: 66.60
Round  58, Train loss: 0.535, Test loss: 1.083, Test accuracy: 59.94
Round  58, Global train loss: 0.535, Global test loss: 0.771, Global test accuracy: 70.80
Round  59, Train loss: 0.621, Test loss: 1.146, Test accuracy: 55.88
Round  59, Global train loss: 0.621, Global test loss: 0.885, Global test accuracy: 66.20
Round  60, Train loss: 0.601, Test loss: 1.228, Test accuracy: 52.88
Round  60, Global train loss: 0.601, Global test loss: 1.247, Global test accuracy: 52.60
Round  61, Train loss: 0.677, Test loss: 1.162, Test accuracy: 56.66
Round  61, Global train loss: 0.677, Global test loss: 0.907, Global test accuracy: 66.80
Round  62, Train loss: 0.527, Test loss: 1.168, Test accuracy: 58.02
Round  62, Global train loss: 0.527, Global test loss: 0.954, Global test accuracy: 65.60
Round  63, Train loss: 0.549, Test loss: 1.239, Test accuracy: 53.72
Round  63, Global train loss: 0.549, Global test loss: 1.262, Global test accuracy: 57.20
Round  64, Train loss: 0.755, Test loss: 1.348, Test accuracy: 50.16
Round  64, Global train loss: 0.755, Global test loss: 1.416, Global test accuracy: 46.00
Round  65, Train loss: 0.518, Test loss: 1.281, Test accuracy: 56.24
Round  65, Global train loss: 0.518, Global test loss: 1.199, Global test accuracy: 59.20
Round  66, Train loss: 0.566, Test loss: 1.139, Test accuracy: 61.34
Round  66, Global train loss: 0.566, Global test loss: 0.895, Global test accuracy: 68.20
Round  67, Train loss: 0.584, Test loss: 1.387, Test accuracy: 51.50
Round  67, Global train loss: 0.584, Global test loss: 1.205, Global test accuracy: 55.80
Round  68, Train loss: 0.540, Test loss: 1.444, Test accuracy: 50.76
Round  68, Global train loss: 0.540, Global test loss: 1.541, Global test accuracy: 51.80
Round  69, Train loss: 0.647, Test loss: 1.288, Test accuracy: 54.20
Round  69, Global train loss: 0.647, Global test loss: 1.032, Global test accuracy: 64.00
Round  70, Train loss: 0.578, Test loss: 1.243, Test accuracy: 56.46
Round  70, Global train loss: 0.578, Global test loss: 0.991, Global test accuracy: 64.80
Round  71, Train loss: 0.436, Test loss: 1.355, Test accuracy: 55.68
Round  71, Global train loss: 0.436, Global test loss: 1.182, Global test accuracy: 60.80
Round  72, Train loss: 0.521, Test loss: 1.410, Test accuracy: 53.64
Round  72, Global train loss: 0.521, Global test loss: 1.269, Global test accuracy: 55.20
Round  73, Train loss: 0.444, Test loss: 1.103, Test accuracy: 64.20
Round  73, Global train loss: 0.444, Global test loss: 0.774, Global test accuracy: 73.00
Round  74, Train loss: 0.515, Test loss: 1.316, Test accuracy: 54.94
Round  74, Global train loss: 0.515, Global test loss: 1.121, Global test accuracy: 61.60
Round  75, Train loss: 0.401, Test loss: 1.278, Test accuracy: 56.80
Round  75, Global train loss: 0.401, Global test loss: 1.088, Global test accuracy: 62.40
Round  76, Train loss: 0.579, Test loss: 1.333, Test accuracy: 55.18
Round  76, Global train loss: 0.579, Global test loss: 1.161, Global test accuracy: 58.40
Round  77, Train loss: 0.446, Test loss: 1.308, Test accuracy: 56.76
Round  77, Global train loss: 0.446, Global test loss: 1.197, Global test accuracy: 62.20
Round  78, Train loss: 0.454, Test loss: 1.425, Test accuracy: 54.26
Round  78, Global train loss: 0.454, Global test loss: 1.539, Global test accuracy: 55.20
Round  79, Train loss: 0.441, Test loss: 1.411, Test accuracy: 54.72
Round  79, Global train loss: 0.441, Global test loss: 1.194, Global test accuracy: 59.60
Round  80, Train loss: 0.413, Test loss: 1.289, Test accuracy: 56.94
Round  80, Global train loss: 0.413, Global test loss: 1.011, Global test accuracy: 65.40
Round  81, Train loss: 0.388, Test loss: 1.237, Test accuracy: 59.08
Round  81, Global train loss: 0.388, Global test loss: 0.958, Global test accuracy: 66.80
Round  82, Train loss: 0.380, Test loss: 1.231, Test accuracy: 58.94
Round  82, Global train loss: 0.380, Global test loss: 0.939, Global test accuracy: 67.40
Round  83, Train loss: 0.357, Test loss: 1.275, Test accuracy: 58.98
Round  83, Global train loss: 0.357, Global test loss: 1.002, Global test accuracy: 66.80
Round  84, Train loss: 0.341, Test loss: 1.285, Test accuracy: 59.20
Round  84, Global train loss: 0.341, Global test loss: 0.987, Global test accuracy: 67.00
Round  85, Train loss: 0.338, Test loss: 1.295, Test accuracy: 58.40
Round  85, Global train loss: 0.338, Global test loss: 1.010, Global test accuracy: 67.00
Round  86, Train loss: 0.319, Test loss: 1.274, Test accuracy: 59.26
Round  86, Global train loss: 0.319, Global test loss: 0.965, Global test accuracy: 68.00
Round  87, Train loss: 0.305, Test loss: 1.341, Test accuracy: 57.92
Round  87, Global train loss: 0.305, Global test loss: 1.046, Global test accuracy: 65.80
Round  88, Train loss: 0.301, Test loss: 1.308, Test accuracy: 57.80
Round  88, Global train loss: 0.301, Global test loss: 1.013, Global test accuracy: 66.60
Round  89, Train loss: 0.287, Test loss: 1.332, Test accuracy: 57.82
Round  89, Global train loss: 0.287, Global test loss: 1.044, Global test accuracy: 64.60
Round  90, Train loss: 0.279, Test loss: 1.307, Test accuracy: 59.28
Round  90, Global train loss: 0.279, Global test loss: 1.002, Global test accuracy: 66.80
Round  91, Train loss: 0.280, Test loss: 1.353, Test accuracy: 56.86
Round  91, Global train loss: 0.280, Global test loss: 1.028, Global test accuracy: 64.80
Round  92, Train loss: 0.268, Test loss: 1.362, Test accuracy: 57.72
Round  92, Global train loss: 0.268, Global test loss: 1.072, Global test accuracy: 65.40
Round  93, Train loss: 0.256, Test loss: 1.346, Test accuracy: 58.40
Round  93, Global train loss: 0.256, Global test loss: 1.067, Global test accuracy: 67.40
Round  94, Train loss: 0.250, Test loss: 1.395, Test accuracy: 56.56
Round  94, Global train loss: 0.250, Global test loss: 1.124, Global test accuracy: 64.40
Round  95, Train loss: 0.243, Test loss: 1.334, Test accuracy: 58.84
Round  95, Global train loss: 0.243, Global test loss: 1.060, Global test accuracy: 66.40
Round  96, Train loss: 0.242, Test loss: 1.409, Test accuracy: 56.80
Round  96, Global train loss: 0.242, Global test loss: 1.102, Global test accuracy: 63.00
Round  97, Train loss: 0.240, Test loss: 1.450, Test accuracy: 55.50
Round  97, Global train loss: 0.240, Global test loss: 1.155, Global test accuracy: 64.20
Round  98, Train loss: 0.225, Test loss: 1.359, Test accuracy: 58.02
Round  98, Global train loss: 0.225, Global test loss: 1.065, Global test accuracy: 65.80
Round  99, Train loss: 0.317, Test loss: 1.437, Test accuracy: 56.76
Round  99, Global train loss: 0.317, Global test loss: 1.133, Global test accuracy: 63.20
Final Round, Train loss: 0.263, Test loss: 1.484, Test accuracy: 56.42
Final Round, Global train loss: 0.263, Global test loss: 1.133, Global test accuracy: 63.20
Average accuracy final 10 rounds: 57.474000000000004
2309.4571743011475
[2.2667036056518555, 4.446025848388672, 6.649841070175171, 8.975588321685791, 11.115858316421509, 13.466532707214355, 15.621900796890259, 18.093995094299316, 20.161404848098755, 22.63161277770996, 30.31881880760193, 41.478750228881836, 53.27150201797485, 64.49235844612122, 75.33673763275146, 86.38997507095337, 97.2545223236084, 108.0052170753479, 118.8050696849823, 129.9283163547516, 140.9010148048401, 151.70682787895203, 162.82571506500244, 175.84333324432373, 177.8682279586792, 180.1887013912201, 191.71662425994873, 203.23656511306763, 214.6806778907776, 226.6925766468048, 237.54983472824097, 249.07327699661255, 260.22533106803894, 271.4280114173889, 282.73596000671387, 294.2787199020386, 305.3613121509552, 316.82477736473083, 318.87144470214844, 330.4930055141449, 342.20725107192993, 353.6149573326111, 355.69693326950073, 366.64707827568054, 377.9684491157532, 389.06875681877136, 400.6010389328003, 411.8268859386444, 424.21247124671936, 435.9194369316101, 447.2545895576477, 458.7765245437622, 470.5134074687958, 482.1034576892853, 494.1916525363922, 506.0611641407013, 517.8197546005249, 529.8093793392181, 531.9311189651489, 543.8223717212677, 555.793313741684, 567.7565407752991, 579.3321039676666, 593.1556100845337, 604.6115987300873, 615.7227447032928, 617.7497043609619, 629.5285391807556, 641.968240737915, 654.87451004982, 666.3912606239319, 677.8440442085266, 689.0666255950928, 691.1472733020782, 702.6430518627167, 714.4652495384216, 725.841495513916, 728.0155003070831, 738.9610793590546, 749.6574540138245, 751.7672185897827, 753.8892455101013, 756.0582439899445, 758.1301465034485, 760.3072791099548, 762.4318900108337, 764.6407217979431, 766.706139087677, 768.6645531654358, 770.7464025020599, 772.8963379859924, 775.106014251709, 777.151623249054, 779.2319400310516, 781.2928612232208, 783.3422608375549, 785.3761057853699, 787.3977189064026, 789.4427468776703, 800.4459171295166, 812.5884115695953]
[33.38, 38.9, 41.7, 43.6, 47.04, 49.66, 50.98, 52.16, 52.06, 53.24, 54.78, 43.96, 49.34, 45.84, 50.0, 43.7, 46.24, 49.46, 49.68, 54.52, 46.58, 44.34, 46.84, 49.12, 53.36, 54.36, 54.48, 51.36, 49.28, 55.66, 54.32, 52.04, 50.52, 56.02, 53.76, 51.72, 56.18, 55.24, 55.8, 53.96, 54.62, 55.44, 55.84, 53.2, 50.16, 51.88, 55.96, 57.32, 52.4, 56.34, 54.58, 43.18, 52.9, 57.02, 57.3, 55.18, 53.34, 55.96, 59.94, 55.88, 52.88, 56.66, 58.02, 53.72, 50.16, 56.24, 61.34, 51.5, 50.76, 54.2, 56.46, 55.68, 53.64, 64.2, 54.94, 56.8, 55.18, 56.76, 54.26, 54.72, 56.94, 59.08, 58.94, 58.98, 59.2, 58.4, 59.26, 57.92, 57.8, 57.82, 59.28, 56.86, 57.72, 58.4, 56.56, 58.84, 56.8, 55.5, 58.02, 56.76, 56.42]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.559, Test loss: 1.510, Test accuracy: 34.80
Round   0, Global train loss: 1.559, Global test loss: 1.521, Global test accuracy: 34.40
Round   1, Train loss: 1.529, Test loss: 1.429, Test accuracy: 40.54
Round   1, Global train loss: 1.529, Global test loss: 1.398, Global test accuracy: 43.40
Round   2, Train loss: 1.398, Test loss: 1.349, Test accuracy: 44.44
Round   2, Global train loss: 1.398, Global test loss: 1.187, Global test accuracy: 55.20
Round   3, Train loss: 1.410, Test loss: 1.345, Test accuracy: 46.42
Round   3, Global train loss: 1.410, Global test loss: 1.280, Global test accuracy: 53.80
Round   4, Train loss: 1.516, Test loss: 1.340, Test accuracy: 46.18
Round   4, Global train loss: 1.516, Global test loss: 1.379, Global test accuracy: 47.20
Round   5, Train loss: 1.363, Test loss: 1.274, Test accuracy: 49.14
Round   5, Global train loss: 1.363, Global test loss: 1.176, Global test accuracy: 57.20
Round   6, Train loss: 1.438, Test loss: 1.301, Test accuracy: 49.72
Round   6, Global train loss: 1.438, Global test loss: 1.349, Global test accuracy: 54.20
Round   7, Train loss: 1.384, Test loss: 1.272, Test accuracy: 51.04
Round   7, Global train loss: 1.384, Global test loss: 1.277, Global test accuracy: 57.00
Round   8, Train loss: 1.442, Test loss: 1.254, Test accuracy: 51.98
Round   8, Global train loss: 1.442, Global test loss: 1.252, Global test accuracy: 58.00
Round   9, Train loss: 1.362, Test loss: 1.231, Test accuracy: 52.98
Round   9, Global train loss: 1.362, Global test loss: 1.195, Global test accuracy: 59.80
Round  10, Train loss: 1.233, Test loss: 1.194, Test accuracy: 54.04
Round  10, Global train loss: 1.233, Global test loss: 1.106, Global test accuracy: 60.80
Round  11, Train loss: 1.433, Test loss: 1.243, Test accuracy: 53.50
Round  11, Global train loss: 1.433, Global test loss: 1.329, Global test accuracy: 57.20
Round  12, Train loss: 1.355, Test loss: 1.230, Test accuracy: 53.36
Round  12, Global train loss: 1.355, Global test loss: 1.246, Global test accuracy: 63.20
Round  13, Train loss: 1.301, Test loss: 1.215, Test accuracy: 53.92
Round  13, Global train loss: 1.301, Global test loss: 1.218, Global test accuracy: 60.00
Round  14, Train loss: 1.280, Test loss: 1.201, Test accuracy: 54.72
Round  14, Global train loss: 1.280, Global test loss: 1.062, Global test accuracy: 67.40
Round  15, Train loss: 1.460, Test loss: 1.201, Test accuracy: 54.86
Round  15, Global train loss: 1.460, Global test loss: 1.343, Global test accuracy: 55.80
Round  16, Train loss: 1.370, Test loss: 1.192, Test accuracy: 55.24
Round  16, Global train loss: 1.370, Global test loss: 1.206, Global test accuracy: 58.40
Round  17, Train loss: 1.303, Test loss: 1.186, Test accuracy: 56.22
Round  17, Global train loss: 1.303, Global test loss: 1.147, Global test accuracy: 59.40
Round  18, Train loss: 1.297, Test loss: 1.181, Test accuracy: 56.42
Round  18, Global train loss: 1.297, Global test loss: 1.095, Global test accuracy: 61.20
Round  19, Train loss: 1.237, Test loss: 1.186, Test accuracy: 55.14
Round  19, Global train loss: 1.237, Global test loss: 1.127, Global test accuracy: 60.60
Round  20, Train loss: 1.411, Test loss: 1.185, Test accuracy: 55.60
Round  20, Global train loss: 1.411, Global test loss: 1.334, Global test accuracy: 56.00
Round  21, Train loss: 1.391, Test loss: 1.184, Test accuracy: 55.10
Round  21, Global train loss: 1.391, Global test loss: 1.305, Global test accuracy: 58.00
Round  22, Train loss: 1.327, Test loss: 1.170, Test accuracy: 55.76
Round  22, Global train loss: 1.327, Global test loss: 1.236, Global test accuracy: 59.40
Round  23, Train loss: 1.254, Test loss: 1.172, Test accuracy: 55.32
Round  23, Global train loss: 1.254, Global test loss: 1.227, Global test accuracy: 59.40
Round  24, Train loss: 1.209, Test loss: 1.164, Test accuracy: 56.06
Round  24, Global train loss: 1.209, Global test loss: 1.075, Global test accuracy: 63.00
Round  25, Train loss: 1.134, Test loss: 1.167, Test accuracy: 55.96
Round  25, Global train loss: 1.134, Global test loss: 0.991, Global test accuracy: 64.40
Round  26, Train loss: 1.180, Test loss: 1.155, Test accuracy: 56.28
Round  26, Global train loss: 1.180, Global test loss: 1.145, Global test accuracy: 63.60
Round  27, Train loss: 1.065, Test loss: 1.157, Test accuracy: 56.34
Round  27, Global train loss: 1.065, Global test loss: 1.040, Global test accuracy: 63.60
Round  28, Train loss: 1.139, Test loss: 1.165, Test accuracy: 55.62
Round  28, Global train loss: 1.139, Global test loss: 1.174, Global test accuracy: 63.40
Round  29, Train loss: 0.988, Test loss: 1.189, Test accuracy: 55.28
Round  29, Global train loss: 0.988, Global test loss: 0.921, Global test accuracy: 68.60
Round  30, Train loss: 1.109, Test loss: 1.208, Test accuracy: 54.38
Round  30, Global train loss: 1.109, Global test loss: 1.072, Global test accuracy: 63.00
Round  31, Train loss: 1.045, Test loss: 1.210, Test accuracy: 54.40
Round  31, Global train loss: 1.045, Global test loss: 1.184, Global test accuracy: 65.00
Round  32, Train loss: 1.019, Test loss: 1.218, Test accuracy: 53.80
Round  32, Global train loss: 1.019, Global test loss: 1.037, Global test accuracy: 69.60
Round  33, Train loss: 0.912, Test loss: 1.216, Test accuracy: 53.58
Round  33, Global train loss: 0.912, Global test loss: 0.927, Global test accuracy: 67.20
Round  34, Train loss: 1.083, Test loss: 1.205, Test accuracy: 54.90
Round  34, Global train loss: 1.083, Global test loss: 1.010, Global test accuracy: 63.20
Round  35, Train loss: 1.057, Test loss: 1.205, Test accuracy: 54.82
Round  35, Global train loss: 1.057, Global test loss: 0.962, Global test accuracy: 66.00
Round  36, Train loss: 0.982, Test loss: 1.198, Test accuracy: 54.82
Round  36, Global train loss: 0.982, Global test loss: 1.026, Global test accuracy: 65.00
Round  37, Train loss: 1.190, Test loss: 1.212, Test accuracy: 54.56
Round  37, Global train loss: 1.190, Global test loss: 1.130, Global test accuracy: 61.20
Round  38, Train loss: 0.970, Test loss: 1.198, Test accuracy: 55.02
Round  38, Global train loss: 0.970, Global test loss: 0.897, Global test accuracy: 66.80
Round  39, Train loss: 0.896, Test loss: 1.218, Test accuracy: 55.14
Round  39, Global train loss: 0.896, Global test loss: 0.987, Global test accuracy: 70.00
Round  40, Train loss: 0.947, Test loss: 1.206, Test accuracy: 55.82
Round  40, Global train loss: 0.947, Global test loss: 1.097, Global test accuracy: 62.00
Round  41, Train loss: 1.095, Test loss: 1.196, Test accuracy: 56.22
Round  41, Global train loss: 1.095, Global test loss: 1.044, Global test accuracy: 63.20
Round  42, Train loss: 1.075, Test loss: 1.215, Test accuracy: 55.38
Round  42, Global train loss: 1.075, Global test loss: 1.046, Global test accuracy: 64.60
Round  43, Train loss: 1.186, Test loss: 1.242, Test accuracy: 54.50
Round  43, Global train loss: 1.186, Global test loss: 1.129, Global test accuracy: 61.40
Round  44, Train loss: 1.168, Test loss: 1.248, Test accuracy: 53.18
Round  44, Global train loss: 1.168, Global test loss: 1.229, Global test accuracy: 59.00
Round  45, Train loss: 0.994, Test loss: 1.272, Test accuracy: 52.52
Round  45, Global train loss: 0.994, Global test loss: 1.037, Global test accuracy: 63.00
Round  46, Train loss: 1.093, Test loss: 1.311, Test accuracy: 52.30
Round  46, Global train loss: 1.093, Global test loss: 1.125, Global test accuracy: 59.20
Round  47, Train loss: 0.775, Test loss: 1.306, Test accuracy: 51.96
Round  47, Global train loss: 0.775, Global test loss: 0.949, Global test accuracy: 67.40
Round  48, Train loss: 1.098, Test loss: 1.310, Test accuracy: 52.34
Round  48, Global train loss: 1.098, Global test loss: 1.162, Global test accuracy: 59.00
Round  49, Train loss: 1.015, Test loss: 1.311, Test accuracy: 51.74
Round  49, Global train loss: 1.015, Global test loss: 1.074, Global test accuracy: 62.00
Round  50, Train loss: 0.958, Test loss: 1.342, Test accuracy: 52.28
Round  50, Global train loss: 0.958, Global test loss: 1.090, Global test accuracy: 60.40
Round  51, Train loss: 1.120, Test loss: 1.341, Test accuracy: 52.76
Round  51, Global train loss: 1.120, Global test loss: 1.240, Global test accuracy: 56.80
Round  52, Train loss: 0.784, Test loss: 1.403, Test accuracy: 51.24
Round  52, Global train loss: 0.784, Global test loss: 1.142, Global test accuracy: 62.60
Round  53, Train loss: 0.750, Test loss: 1.403, Test accuracy: 51.94
Round  53, Global train loss: 0.750, Global test loss: 0.889, Global test accuracy: 63.40
Round  54, Train loss: 1.012, Test loss: 1.420, Test accuracy: 51.10
Round  54, Global train loss: 1.012, Global test loss: 1.084, Global test accuracy: 62.20
Round  55, Train loss: 0.838, Test loss: 1.436, Test accuracy: 50.38
Round  55, Global train loss: 0.838, Global test loss: 0.972, Global test accuracy: 64.20
Round  56, Train loss: 0.922, Test loss: 1.427, Test accuracy: 50.78
Round  56, Global train loss: 0.922, Global test loss: 0.995, Global test accuracy: 64.40
Round  57, Train loss: 0.696, Test loss: 1.405, Test accuracy: 51.52
Round  57, Global train loss: 0.696, Global test loss: 1.148, Global test accuracy: 63.80
Round  58, Train loss: 0.629, Test loss: 1.469, Test accuracy: 51.22
Round  58, Global train loss: 0.629, Global test loss: 0.933, Global test accuracy: 67.40
Round  59, Train loss: 0.904, Test loss: 1.489, Test accuracy: 50.72
Round  59, Global train loss: 0.904, Global test loss: 0.966, Global test accuracy: 62.40
Round  60, Train loss: 0.800, Test loss: 1.501, Test accuracy: 51.48
Round  60, Global train loss: 0.800, Global test loss: 1.093, Global test accuracy: 60.80
Round  61, Train loss: 0.724, Test loss: 1.513, Test accuracy: 51.68
Round  61, Global train loss: 0.724, Global test loss: 1.045, Global test accuracy: 63.20
Round  62, Train loss: 0.755, Test loss: 1.532, Test accuracy: 51.64
Round  62, Global train loss: 0.755, Global test loss: 0.978, Global test accuracy: 62.40
Round  63, Train loss: 0.690, Test loss: 1.566, Test accuracy: 51.10
Round  63, Global train loss: 0.690, Global test loss: 1.083, Global test accuracy: 59.80
Round  64, Train loss: 0.880, Test loss: 1.595, Test accuracy: 50.48
Round  64, Global train loss: 0.880, Global test loss: 1.217, Global test accuracy: 56.60
Round  65, Train loss: 0.583, Test loss: 1.584, Test accuracy: 51.12
Round  65, Global train loss: 0.583, Global test loss: 0.971, Global test accuracy: 64.20
Round  66, Train loss: 0.478, Test loss: 1.580, Test accuracy: 50.64
Round  66, Global train loss: 0.478, Global test loss: 1.033, Global test accuracy: 64.60
Round  67, Train loss: 0.779, Test loss: 1.583, Test accuracy: 50.50
Round  67, Global train loss: 0.779, Global test loss: 0.932, Global test accuracy: 66.60
Round  68, Train loss: 0.663, Test loss: 1.625, Test accuracy: 50.32
Round  68, Global train loss: 0.663, Global test loss: 1.092, Global test accuracy: 58.00
Round  69, Train loss: 0.697, Test loss: 1.631, Test accuracy: 50.00
Round  69, Global train loss: 0.697, Global test loss: 1.086, Global test accuracy: 64.00
Round  70, Train loss: 0.561, Test loss: 1.676, Test accuracy: 50.10
Round  70, Global train loss: 0.561, Global test loss: 1.017, Global test accuracy: 64.00
Round  71, Train loss: 0.783, Test loss: 1.702, Test accuracy: 50.06
Round  71, Global train loss: 0.783, Global test loss: 1.223, Global test accuracy: 59.80
Round  72, Train loss: 0.761, Test loss: 1.717, Test accuracy: 51.54
Round  72, Global train loss: 0.761, Global test loss: 1.237, Global test accuracy: 54.20
Round  73, Train loss: 0.459, Test loss: 1.794, Test accuracy: 50.94
Round  73, Global train loss: 0.459, Global test loss: 0.904, Global test accuracy: 66.20
Round  74, Train loss: 0.616, Test loss: 1.846, Test accuracy: 49.54
Round  74, Global train loss: 0.616, Global test loss: 0.993, Global test accuracy: 66.00
Round  75, Train loss: 0.626, Test loss: 1.845, Test accuracy: 50.30
Round  75, Global train loss: 0.626, Global test loss: 1.056, Global test accuracy: 61.60
Round  76, Train loss: 0.591, Test loss: 1.800, Test accuracy: 50.68
Round  76, Global train loss: 0.591, Global test loss: 1.043, Global test accuracy: 60.60
Round  77, Train loss: 0.419, Test loss: 1.829, Test accuracy: 49.64
Round  77, Global train loss: 0.419, Global test loss: 1.024, Global test accuracy: 63.20
Round  78, Train loss: 0.532, Test loss: 1.901, Test accuracy: 49.44
Round  78, Global train loss: 0.532, Global test loss: 1.161, Global test accuracy: 54.80
Round  79, Train loss: 0.600, Test loss: 1.958, Test accuracy: 48.42
Round  79, Global train loss: 0.600, Global test loss: 1.174, Global test accuracy: 57.60
Round  80, Train loss: 0.709, Test loss: 1.993, Test accuracy: 48.48
Round  80, Global train loss: 0.709, Global test loss: 1.237, Global test accuracy: 53.40
Round  81, Train loss: 0.456, Test loss: 1.946, Test accuracy: 49.46
Round  81, Global train loss: 0.456, Global test loss: 1.038, Global test accuracy: 62.40
Round  82, Train loss: 0.544, Test loss: 1.989, Test accuracy: 48.64
Round  82, Global train loss: 0.544, Global test loss: 1.119, Global test accuracy: 58.20
Round  83, Train loss: 0.347, Test loss: 1.984, Test accuracy: 48.60
Round  83, Global train loss: 0.347, Global test loss: 0.982, Global test accuracy: 65.40
Round  84, Train loss: 0.416, Test loss: 2.038, Test accuracy: 48.44
Round  84, Global train loss: 0.416, Global test loss: 0.990, Global test accuracy: 60.60
Round  85, Train loss: 0.422, Test loss: 2.032, Test accuracy: 49.36
Round  85, Global train loss: 0.422, Global test loss: 1.024, Global test accuracy: 61.80
Round  86, Train loss: 0.487, Test loss: 2.059, Test accuracy: 48.90
Round  86, Global train loss: 0.487, Global test loss: 0.973, Global test accuracy: 65.20
Round  87, Train loss: 0.416, Test loss: 2.037, Test accuracy: 49.48
Round  87, Global train loss: 0.416, Global test loss: 0.980, Global test accuracy: 67.40
Round  88, Train loss: 0.290, Test loss: 2.162, Test accuracy: 48.70
Round  88, Global train loss: 0.290, Global test loss: 0.849, Global test accuracy: 70.80
Round  89, Train loss: 0.432, Test loss: 2.189, Test accuracy: 48.22
Round  89, Global train loss: 0.432, Global test loss: 0.990, Global test accuracy: 64.80
Round  90, Train loss: 0.404, Test loss: 2.181, Test accuracy: 48.14
Round  90, Global train loss: 0.404, Global test loss: 1.150, Global test accuracy: 57.60
Round  91, Train loss: 0.370, Test loss: 2.215, Test accuracy: 48.86
Round  91, Global train loss: 0.370, Global test loss: 1.139, Global test accuracy: 59.00
Round  92, Train loss: 0.350, Test loss: 2.274, Test accuracy: 48.52
Round  92, Global train loss: 0.350, Global test loss: 0.997, Global test accuracy: 63.40
Round  93, Train loss: 0.230, Test loss: 2.240, Test accuracy: 48.96
Round  93, Global train loss: 0.230, Global test loss: 0.932, Global test accuracy: 69.20
Round  94, Train loss: 0.393, Test loss: 2.294, Test accuracy: 48.28
Round  94, Global train loss: 0.393, Global test loss: 1.057, Global test accuracy: 61.60
Round  95, Train loss: 0.425, Test loss: 2.294, Test accuracy: 48.54
Round  95, Global train loss: 0.425, Global test loss: 1.127, Global test accuracy: 60.80
Round  96, Train loss: 0.375, Test loss: 2.289, Test accuracy: 48.38
Round  96, Global train loss: 0.375, Global test loss: 1.146, Global test accuracy: 59.20
Round  97, Train loss: 0.346, Test loss: 2.274, Test accuracy: 48.76
Round  97, Global train loss: 0.346, Global test loss: 1.071, Global test accuracy: 60.40
Round  98, Train loss: 0.425, Test loss: 2.256, Test accuracy: 48.54
Round  98, Global train loss: 0.425, Global test loss: 1.199, Global test accuracy: 55.20
Round  99, Train loss: 0.311, Test loss: 2.334, Test accuracy: 47.82
Round  99, Global train loss: 0.311, Global test loss: 0.953, Global test accuracy: 63.20
Final Round, Train loss: 0.315, Test loss: 2.421, Test accuracy: 47.88
Final Round, Global train loss: 0.315, Global test loss: 0.953, Global test accuracy: 63.20
Average accuracy final 10 rounds: 48.47999999999999 

Average global accuracy final 10 rounds: 60.96000000000001 

990.6559326648712
[1.8442726135253906, 3.6885452270507812, 5.1282923221588135, 6.568039417266846, 8.126749753952026, 9.685460090637207, 11.247416734695435, 12.809373378753662, 14.236318826675415, 15.663264274597168, 17.224551677703857, 18.785839080810547, 20.57950782775879, 22.37317657470703, 23.946558475494385, 25.51994037628174, 27.021626234054565, 28.523312091827393, 30.04504704475403, 31.566781997680664, 33.20771551132202, 34.84864902496338, 36.361067056655884, 37.87348508834839, 39.41643452644348, 40.959383964538574, 42.438703775405884, 43.91802358627319, 45.52406930923462, 47.130115032196045, 48.580886363983154, 50.031657695770264, 51.6181116104126, 53.20456552505493, 54.749995946884155, 56.29542636871338, 57.82535195350647, 59.35527753829956, 60.838181495666504, 62.32108545303345, 63.92215442657471, 65.52322340011597, 66.98914408683777, 68.45506477355957, 69.89126348495483, 71.3274621963501, 72.8322479724884, 74.33703374862671, 76.22020840644836, 78.10338306427002, 79.98585653305054, 81.86833000183105, 83.5955228805542, 85.32271575927734, 86.75968170166016, 88.19664764404297, 89.59483909606934, 90.9930305480957, 92.48898839950562, 93.98494625091553, 95.53520202636719, 97.08545780181885, 98.66388416290283, 100.24231052398682, 101.82246208190918, 103.40261363983154, 105.15288019180298, 106.90314674377441, 108.40960502624512, 109.91606330871582, 111.63533520698547, 113.35460710525513, 115.01714205741882, 116.67967700958252, 118.16208267211914, 119.64448833465576, 121.18665385246277, 122.72881937026978, 124.3022243976593, 125.87562942504883, 127.34715747833252, 128.8186855316162, 130.27661538124084, 131.73454523086548, 133.2856640815735, 134.8367829322815, 136.31082940101624, 137.78487586975098, 139.29073429107666, 140.79659271240234, 142.4092526435852, 144.02191257476807, 145.508553981781, 146.99519538879395, 148.453058719635, 149.91092205047607, 151.4273543357849, 152.94378662109375, 154.34085607528687, 155.73792552947998, 157.57918047904968, 159.42043542861938, 160.98937511444092, 162.55831480026245, 164.15644669532776, 165.75457859039307, 167.37162852287292, 168.98867845535278, 170.54165410995483, 172.09462976455688, 173.57313799858093, 175.05164623260498, 176.649671792984, 178.24769735336304, 179.86613821983337, 181.4845790863037, 183.02179718017578, 184.55901527404785, 186.10853910446167, 187.6580629348755, 189.11830163002014, 190.5785403251648, 192.14212346076965, 193.7057065963745, 195.1895294189453, 196.6733522415161, 198.5425510406494, 200.41174983978271, 202.1043643951416, 203.7969789505005, 205.30223321914673, 206.80748748779297, 208.4015974998474, 209.99570751190186, 211.60136818885803, 213.2070288658142, 214.72205448150635, 216.2370800971985, 217.83473753929138, 219.43239498138428, 221.1693253517151, 222.9062557220459, 224.6058807373047, 226.30550575256348, 227.95170497894287, 229.59790420532227, 231.10699939727783, 232.6160945892334, 234.14325094223022, 235.67040729522705, 237.35252499580383, 239.03464269638062, 240.52534651756287, 242.01605033874512, 243.42364311218262, 244.83123588562012, 246.3728744983673, 247.9145131111145, 249.52384042739868, 251.13316774368286, 252.57621383666992, 254.01925992965698, 255.595716714859, 257.17217350006104, 258.6732940673828, 260.1744146347046, 261.6794948577881, 263.1845750808716, 264.66378021240234, 266.1429853439331, 267.5712809562683, 268.9995765686035, 270.6503200531006, 272.30106353759766, 273.9128489494324, 275.5246343612671, 277.03433203697205, 278.544029712677, 280.08630204200745, 281.6285743713379, 283.11772656440735, 284.6068787574768, 286.20499300956726, 287.8031072616577, 289.42614459991455, 291.0491819381714, 292.51758193969727, 293.98598194122314, 295.38904452323914, 296.7921071052551, 298.27774453163147, 299.7633819580078, 301.3291518688202, 302.89492177963257, 304.4357008934021, 305.97648000717163, 307.55964756011963, 309.1428151130676, 310.7386405467987, 312.3344659805298, 315.5392405986786, 318.7440152168274]
[34.8, 34.8, 40.54, 40.54, 44.44, 44.44, 46.42, 46.42, 46.18, 46.18, 49.14, 49.14, 49.72, 49.72, 51.04, 51.04, 51.98, 51.98, 52.98, 52.98, 54.04, 54.04, 53.5, 53.5, 53.36, 53.36, 53.92, 53.92, 54.72, 54.72, 54.86, 54.86, 55.24, 55.24, 56.22, 56.22, 56.42, 56.42, 55.14, 55.14, 55.6, 55.6, 55.1, 55.1, 55.76, 55.76, 55.32, 55.32, 56.06, 56.06, 55.96, 55.96, 56.28, 56.28, 56.34, 56.34, 55.62, 55.62, 55.28, 55.28, 54.38, 54.38, 54.4, 54.4, 53.8, 53.8, 53.58, 53.58, 54.9, 54.9, 54.82, 54.82, 54.82, 54.82, 54.56, 54.56, 55.02, 55.02, 55.14, 55.14, 55.82, 55.82, 56.22, 56.22, 55.38, 55.38, 54.5, 54.5, 53.18, 53.18, 52.52, 52.52, 52.3, 52.3, 51.96, 51.96, 52.34, 52.34, 51.74, 51.74, 52.28, 52.28, 52.76, 52.76, 51.24, 51.24, 51.94, 51.94, 51.1, 51.1, 50.38, 50.38, 50.78, 50.78, 51.52, 51.52, 51.22, 51.22, 50.72, 50.72, 51.48, 51.48, 51.68, 51.68, 51.64, 51.64, 51.1, 51.1, 50.48, 50.48, 51.12, 51.12, 50.64, 50.64, 50.5, 50.5, 50.32, 50.32, 50.0, 50.0, 50.1, 50.1, 50.06, 50.06, 51.54, 51.54, 50.94, 50.94, 49.54, 49.54, 50.3, 50.3, 50.68, 50.68, 49.64, 49.64, 49.44, 49.44, 48.42, 48.42, 48.48, 48.48, 49.46, 49.46, 48.64, 48.64, 48.6, 48.6, 48.44, 48.44, 49.36, 49.36, 48.9, 48.9, 49.48, 49.48, 48.7, 48.7, 48.22, 48.22, 48.14, 48.14, 48.86, 48.86, 48.52, 48.52, 48.96, 48.96, 48.28, 48.28, 48.54, 48.54, 48.38, 48.38, 48.76, 48.76, 48.54, 48.54, 47.82, 47.82, 47.88, 47.88]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.570, Test loss: 1.437, Test accuracy: 41.86
Round   0, Global train loss: 1.570, Global test loss: 1.437, Global test accuracy: 42.60
Round   1, Train loss: 1.461, Test loss: 1.342, Test accuracy: 45.20
Round   1, Global train loss: 1.461, Global test loss: 1.298, Global test accuracy: 47.60
Round   2, Train loss: 1.489, Test loss: 1.313, Test accuracy: 47.30
Round   2, Global train loss: 1.489, Global test loss: 1.253, Global test accuracy: 51.20
Round   3, Train loss: 1.415, Test loss: 1.278, Test accuracy: 49.38
Round   3, Global train loss: 1.415, Global test loss: 1.177, Global test accuracy: 54.80
Round   4, Train loss: 1.422, Test loss: 1.229, Test accuracy: 53.02
Round   4, Global train loss: 1.422, Global test loss: 1.166, Global test accuracy: 58.00
Round   5, Train loss: 1.365, Test loss: 1.213, Test accuracy: 52.68
Round   5, Global train loss: 1.365, Global test loss: 1.113, Global test accuracy: 56.00
Round   6, Train loss: 1.321, Test loss: 1.157, Test accuracy: 56.58
Round   6, Global train loss: 1.321, Global test loss: 1.102, Global test accuracy: 59.60
Round   7, Train loss: 1.387, Test loss: 1.143, Test accuracy: 58.64
Round   7, Global train loss: 1.387, Global test loss: 1.099, Global test accuracy: 63.60
Round   8, Train loss: 1.336, Test loss: 1.144, Test accuracy: 58.44
Round   8, Global train loss: 1.336, Global test loss: 1.107, Global test accuracy: 61.80
Round   9, Train loss: 1.350, Test loss: 1.131, Test accuracy: 58.70
Round   9, Global train loss: 1.350, Global test loss: 1.072, Global test accuracy: 63.60
Round  10, Train loss: 1.389, Test loss: 1.127, Test accuracy: 58.80
Round  10, Global train loss: 1.389, Global test loss: 1.082, Global test accuracy: 63.20
Round  11, Train loss: 1.325, Test loss: 1.112, Test accuracy: 59.78
Round  11, Global train loss: 1.325, Global test loss: 1.094, Global test accuracy: 62.60
Round  12, Train loss: 1.350, Test loss: 1.114, Test accuracy: 60.00
Round  12, Global train loss: 1.350, Global test loss: 1.080, Global test accuracy: 64.40
Round  13, Train loss: 1.308, Test loss: 1.099, Test accuracy: 61.04
Round  13, Global train loss: 1.308, Global test loss: 1.004, Global test accuracy: 65.80
Round  14, Train loss: 1.299, Test loss: 1.110, Test accuracy: 59.92
Round  14, Global train loss: 1.299, Global test loss: 1.007, Global test accuracy: 68.20
Round  15, Train loss: 1.293, Test loss: 1.108, Test accuracy: 59.48
Round  15, Global train loss: 1.293, Global test loss: 1.062, Global test accuracy: 63.80
Round  16, Train loss: 1.198, Test loss: 1.082, Test accuracy: 60.54
Round  16, Global train loss: 1.198, Global test loss: 0.996, Global test accuracy: 64.80
Round  17, Train loss: 1.146, Test loss: 1.091, Test accuracy: 59.64
Round  17, Global train loss: 1.146, Global test loss: 0.973, Global test accuracy: 65.40
Round  18, Train loss: 1.220, Test loss: 1.093, Test accuracy: 59.42
Round  18, Global train loss: 1.220, Global test loss: 1.040, Global test accuracy: 64.00
Round  19, Train loss: 1.216, Test loss: 1.083, Test accuracy: 60.16
Round  19, Global train loss: 1.216, Global test loss: 0.984, Global test accuracy: 67.20
Round  20, Train loss: 1.164, Test loss: 1.091, Test accuracy: 59.74
Round  20, Global train loss: 1.164, Global test loss: 1.081, Global test accuracy: 60.80
Round  21, Train loss: 1.074, Test loss: 1.067, Test accuracy: 60.60
Round  21, Global train loss: 1.074, Global test loss: 1.025, Global test accuracy: 60.20
Round  22, Train loss: 0.986, Test loss: 1.083, Test accuracy: 59.66
Round  22, Global train loss: 0.986, Global test loss: 1.025, Global test accuracy: 60.20
Round  23, Train loss: 1.097, Test loss: 1.111, Test accuracy: 58.46
Round  23, Global train loss: 1.097, Global test loss: 1.113, Global test accuracy: 59.60
Round  24, Train loss: 1.010, Test loss: 1.130, Test accuracy: 58.12
Round  24, Global train loss: 1.010, Global test loss: 1.016, Global test accuracy: 62.80
Round  25, Train loss: 0.999, Test loss: 1.135, Test accuracy: 57.94
Round  25, Global train loss: 0.999, Global test loss: 0.956, Global test accuracy: 65.80
Round  26, Train loss: 0.986, Test loss: 1.165, Test accuracy: 56.94
Round  26, Global train loss: 0.986, Global test loss: 1.093, Global test accuracy: 60.20
Round  27, Train loss: 0.925, Test loss: 1.166, Test accuracy: 57.70
Round  27, Global train loss: 0.925, Global test loss: 1.015, Global test accuracy: 63.80
Round  28, Train loss: 0.907, Test loss: 1.158, Test accuracy: 58.34
Round  28, Global train loss: 0.907, Global test loss: 1.036, Global test accuracy: 62.40
Round  29, Train loss: 1.061, Test loss: 1.175, Test accuracy: 57.18
Round  29, Global train loss: 1.061, Global test loss: 1.054, Global test accuracy: 60.40
Round  30, Train loss: 0.895, Test loss: 1.211, Test accuracy: 57.18
Round  30, Global train loss: 0.895, Global test loss: 1.081, Global test accuracy: 59.40
Round  31, Train loss: 0.871, Test loss: 1.248, Test accuracy: 56.62
Round  31, Global train loss: 0.871, Global test loss: 1.094, Global test accuracy: 61.80
Round  32, Train loss: 0.819, Test loss: 1.296, Test accuracy: 56.12
Round  32, Global train loss: 0.819, Global test loss: 1.080, Global test accuracy: 61.40
Round  33, Train loss: 0.917, Test loss: 1.315, Test accuracy: 56.20
Round  33, Global train loss: 0.917, Global test loss: 1.107, Global test accuracy: 61.20
Round  34, Train loss: 0.744, Test loss: 1.321, Test accuracy: 56.00
Round  34, Global train loss: 0.744, Global test loss: 1.114, Global test accuracy: 60.60
Round  35, Train loss: 0.741, Test loss: 1.346, Test accuracy: 55.62
Round  35, Global train loss: 0.741, Global test loss: 1.175, Global test accuracy: 59.40
Round  36, Train loss: 0.810, Test loss: 1.364, Test accuracy: 55.52
Round  36, Global train loss: 0.810, Global test loss: 1.098, Global test accuracy: 62.00
Round  37, Train loss: 0.683, Test loss: 1.412, Test accuracy: 54.80
Round  37, Global train loss: 0.683, Global test loss: 1.290, Global test accuracy: 56.60
Round  38, Train loss: 0.663, Test loss: 1.400, Test accuracy: 55.00
Round  38, Global train loss: 0.663, Global test loss: 1.122, Global test accuracy: 62.80
Round  39, Train loss: 0.646, Test loss: 1.482, Test accuracy: 54.48
Round  39, Global train loss: 0.646, Global test loss: 1.273, Global test accuracy: 57.60
Round  40, Train loss: 0.604, Test loss: 1.536, Test accuracy: 54.26
Round  40, Global train loss: 0.604, Global test loss: 1.332, Global test accuracy: 56.00
Round  41, Train loss: 0.592, Test loss: 1.565, Test accuracy: 55.14
Round  41, Global train loss: 0.592, Global test loss: 1.330, Global test accuracy: 60.80
Round  42, Train loss: 0.527, Test loss: 1.583, Test accuracy: 55.10
Round  42, Global train loss: 0.527, Global test loss: 1.071, Global test accuracy: 63.80
Round  43, Train loss: 0.441, Test loss: 1.692, Test accuracy: 54.26
Round  43, Global train loss: 0.441, Global test loss: 1.287, Global test accuracy: 60.60
Round  44, Train loss: 0.498, Test loss: 1.631, Test accuracy: 55.38
Round  44, Global train loss: 0.498, Global test loss: 1.442, Global test accuracy: 60.00
Round  45, Train loss: 0.502, Test loss: 1.629, Test accuracy: 54.82
Round  45, Global train loss: 0.502, Global test loss: 1.330, Global test accuracy: 58.40
Round  46, Train loss: 0.443, Test loss: 1.675, Test accuracy: 54.10
Round  46, Global train loss: 0.443, Global test loss: 1.313, Global test accuracy: 62.40
Round  47, Train loss: 0.548, Test loss: 1.680, Test accuracy: 53.62
Round  47, Global train loss: 0.548, Global test loss: 1.323, Global test accuracy: 57.60
Round  48, Train loss: 0.298, Test loss: 1.667, Test accuracy: 53.72
Round  48, Global train loss: 0.298, Global test loss: 1.559, Global test accuracy: 57.20
Round  49, Train loss: 0.371, Test loss: 1.753, Test accuracy: 53.52
Round  49, Global train loss: 0.371, Global test loss: 1.418, Global test accuracy: 60.20
Round  50, Train loss: 0.305, Test loss: 1.718, Test accuracy: 53.64
Round  50, Global train loss: 0.305, Global test loss: 1.445, Global test accuracy: 62.00
Round  51, Train loss: 0.339, Test loss: 1.747, Test accuracy: 53.10
Round  51, Global train loss: 0.339, Global test loss: 1.559, Global test accuracy: 59.20
Round  52, Train loss: 0.449, Test loss: 1.749, Test accuracy: 54.00
Round  52, Global train loss: 0.449, Global test loss: 1.433, Global test accuracy: 57.20
Round  53, Train loss: 0.540, Test loss: 1.828, Test accuracy: 53.42
Round  53, Global train loss: 0.540, Global test loss: 1.414, Global test accuracy: 55.80
Round  54, Train loss: 0.380, Test loss: 1.846, Test accuracy: 53.74
Round  54, Global train loss: 0.380, Global test loss: 1.424, Global test accuracy: 57.20
Round  55, Train loss: 0.433, Test loss: 1.832, Test accuracy: 53.34
Round  55, Global train loss: 0.433, Global test loss: 1.395, Global test accuracy: 57.80
Round  56, Train loss: 0.385, Test loss: 1.849, Test accuracy: 53.82
Round  56, Global train loss: 0.385, Global test loss: 1.594, Global test accuracy: 55.20
Round  57, Train loss: 0.435, Test loss: 1.845, Test accuracy: 53.96
Round  57, Global train loss: 0.435, Global test loss: 1.515, Global test accuracy: 54.20
Round  58, Train loss: 0.371, Test loss: 1.825, Test accuracy: 55.44
Round  58, Global train loss: 0.371, Global test loss: 1.359, Global test accuracy: 62.00
Round  59, Train loss: 0.347, Test loss: 1.818, Test accuracy: 55.78
Round  59, Global train loss: 0.347, Global test loss: 1.482, Global test accuracy: 59.40
Round  60, Train loss: 0.289, Test loss: 1.898, Test accuracy: 54.18
Round  60, Global train loss: 0.289, Global test loss: 1.705, Global test accuracy: 56.20
Round  61, Train loss: 0.344, Test loss: 1.933, Test accuracy: 53.12
Round  61, Global train loss: 0.344, Global test loss: 1.680, Global test accuracy: 53.80
Round  62, Train loss: 0.332, Test loss: 2.032, Test accuracy: 52.30
Round  62, Global train loss: 0.332, Global test loss: 1.471, Global test accuracy: 60.60
Round  63, Train loss: 0.275, Test loss: 1.996, Test accuracy: 53.38
Round  63, Global train loss: 0.275, Global test loss: 1.709, Global test accuracy: 58.20
Round  64, Train loss: 0.332, Test loss: 2.012, Test accuracy: 54.06
Round  64, Global train loss: 0.332, Global test loss: 1.673, Global test accuracy: 58.20
Round  65, Train loss: 0.264, Test loss: 2.019, Test accuracy: 53.78
Round  65, Global train loss: 0.264, Global test loss: 1.590, Global test accuracy: 62.60
Round  66, Train loss: 0.293, Test loss: 2.085, Test accuracy: 53.12
Round  66, Global train loss: 0.293, Global test loss: 1.698, Global test accuracy: 58.20
Round  67, Train loss: 0.323, Test loss: 2.082, Test accuracy: 53.56
Round  67, Global train loss: 0.323, Global test loss: 1.581, Global test accuracy: 57.20
Round  68, Train loss: 0.198, Test loss: 2.071, Test accuracy: 53.76
Round  68, Global train loss: 0.198, Global test loss: 1.926, Global test accuracy: 57.40
Round  69, Train loss: 0.300, Test loss: 2.096, Test accuracy: 54.36
Round  69, Global train loss: 0.300, Global test loss: 1.721, Global test accuracy: 57.40
Round  70, Train loss: 0.220, Test loss: 2.119, Test accuracy: 53.58
Round  70, Global train loss: 0.220, Global test loss: 1.899, Global test accuracy: 54.60
Round  71, Train loss: 0.282, Test loss: 2.107, Test accuracy: 54.58
Round  71, Global train loss: 0.282, Global test loss: 1.670, Global test accuracy: 59.20
Round  72, Train loss: 0.156, Test loss: 2.181, Test accuracy: 53.78
Round  72, Global train loss: 0.156, Global test loss: 1.935, Global test accuracy: 55.80
Round  73, Train loss: 0.339, Test loss: 2.226, Test accuracy: 53.08
Round  73, Global train loss: 0.339, Global test loss: 1.613, Global test accuracy: 56.40
Round  74, Train loss: 0.260, Test loss: 2.280, Test accuracy: 53.80
Round  74, Global train loss: 0.260, Global test loss: 1.862, Global test accuracy: 55.20
Round  75, Train loss: 0.206, Test loss: 2.236, Test accuracy: 54.06
Round  75, Global train loss: 0.206, Global test loss: 1.610, Global test accuracy: 59.80
Round  76, Train loss: 0.223, Test loss: 2.162, Test accuracy: 54.46
Round  76, Global train loss: 0.223, Global test loss: 1.885, Global test accuracy: 58.40
Round  77, Train loss: 0.171, Test loss: 2.178, Test accuracy: 54.70
Round  77, Global train loss: 0.171, Global test loss: 1.825, Global test accuracy: 61.20
Round  78, Train loss: 0.127, Test loss: 2.202, Test accuracy: 53.94
Round  78, Global train loss: 0.127, Global test loss: 2.123, Global test accuracy: 57.20
Round  79, Train loss: 0.187, Test loss: 2.237, Test accuracy: 53.86
Round  79, Global train loss: 0.187, Global test loss: 1.738, Global test accuracy: 58.60
Round  80, Train loss: 0.227, Test loss: 2.244, Test accuracy: 54.70
Round  80, Global train loss: 0.227, Global test loss: 2.005, Global test accuracy: 57.80
Round  81, Train loss: 0.125, Test loss: 2.221, Test accuracy: 54.82
Round  81, Global train loss: 0.125, Global test loss: 1.973, Global test accuracy: 61.40
Round  82, Train loss: 0.126, Test loss: 2.270, Test accuracy: 54.64
Round  82, Global train loss: 0.126, Global test loss: 2.024, Global test accuracy: 60.00
Round  83, Train loss: 0.272, Test loss: 2.273, Test accuracy: 54.92
Round  83, Global train loss: 0.272, Global test loss: 1.756, Global test accuracy: 58.00
Round  84, Train loss: 0.253, Test loss: 2.400, Test accuracy: 53.52
Round  84, Global train loss: 0.253, Global test loss: 2.128, Global test accuracy: 52.40
Round  85, Train loss: 0.152, Test loss: 2.350, Test accuracy: 53.60
Round  85, Global train loss: 0.152, Global test loss: 2.037, Global test accuracy: 55.00
Round  86, Train loss: 0.230, Test loss: 2.306, Test accuracy: 53.94
Round  86, Global train loss: 0.230, Global test loss: 1.722, Global test accuracy: 57.40
Round  87, Train loss: 0.231, Test loss: 2.286, Test accuracy: 54.78
Round  87, Global train loss: 0.231, Global test loss: 1.882, Global test accuracy: 57.60
Round  88, Train loss: 0.201, Test loss: 2.278, Test accuracy: 54.82
Round  88, Global train loss: 0.201, Global test loss: 1.786, Global test accuracy: 60.80
Round  89, Train loss: 0.200, Test loss: 2.268, Test accuracy: 55.36
Round  89, Global train loss: 0.200, Global test loss: 1.721, Global test accuracy: 60.20
Round  90, Train loss: 0.176, Test loss: 2.275, Test accuracy: 56.06
Round  90, Global train loss: 0.176, Global test loss: 1.967, Global test accuracy: 56.60
Round  91, Train loss: 0.135, Test loss: 2.311, Test accuracy: 56.06
Round  91, Global train loss: 0.135, Global test loss: 2.158, Global test accuracy: 56.40
Round  92, Train loss: 0.189, Test loss: 2.294, Test accuracy: 55.90
Round  92, Global train loss: 0.189, Global test loss: 1.888, Global test accuracy: 58.60
Round  93, Train loss: 0.197, Test loss: 2.336, Test accuracy: 55.04
Round  93, Global train loss: 0.197, Global test loss: 1.937, Global test accuracy: 55.60
Round  94, Train loss: 0.162, Test loss: 2.371, Test accuracy: 54.56
Round  94, Global train loss: 0.162, Global test loss: 2.132, Global test accuracy: 55.00
Round  95, Train loss: 0.138, Test loss: 2.406, Test accuracy: 54.18
Round  95, Global train loss: 0.138, Global test loss: 1.870, Global test accuracy: 59.00
Round  96, Train loss: 0.133, Test loss: 2.450, Test accuracy: 54.06
Round  96, Global train loss: 0.133, Global test loss: 2.049, Global test accuracy: 58.60
Round  97, Train loss: 0.152, Test loss: 2.377, Test accuracy: 54.68
Round  97, Global train loss: 0.152, Global test loss: 2.083, Global test accuracy: 59.80
Round  98, Train loss: 0.103, Test loss: 2.401, Test accuracy: 55.32
Round  98, Global train loss: 0.103, Global test loss: 2.187, Global test accuracy: 58.20
Round  99, Train loss: 0.161, Test loss: 2.423, Test accuracy: 54.94
Round  99, Global train loss: 0.161, Global test loss: 1.953, Global test accuracy: 58.20
Final Round, Train loss: 0.141, Test loss: 2.539, Test accuracy: 54.36
Final Round, Global train loss: 0.141, Global test loss: 1.953, Global test accuracy: 58.20
Average accuracy final 10 rounds: 55.08 

Average global accuracy final 10 rounds: 57.599999999999994 

1004.4164876937866
[1.9553968906402588, 3.9107937812805176, 5.435269117355347, 6.959744453430176, 8.43611216545105, 9.912479877471924, 11.474408388137817, 13.036336898803711, 14.531529903411865, 16.02672290802002, 17.650609254837036, 19.274495601654053, 21.14112401008606, 23.007752418518066, 24.551068782806396, 26.094385147094727, 27.549819231033325, 29.005253314971924, 30.39577627182007, 31.786299228668213, 33.36720085144043, 34.94810247421265, 36.39614391326904, 37.84418535232544, 39.50001502037048, 41.15584468841553, 42.71166467666626, 44.26748466491699, 45.907124042510986, 47.54676342010498, 49.11313986778259, 50.679516315460205, 52.152586936950684, 53.62565755844116, 55.144291400909424, 56.662925243377686, 58.09883165359497, 59.534738063812256, 61.022695541381836, 62.510653018951416, 64.12566661834717, 65.74068021774292, 67.38090586662292, 69.02113151550293, 70.57732319831848, 72.13351488113403, 73.6449134349823, 75.15631198883057, 76.94810509681702, 78.73989820480347, 80.42717242240906, 82.11444664001465, 83.72549247741699, 85.33653831481934, 86.88178944587708, 88.42704057693481, 90.10658979415894, 91.78613901138306, 93.39106249809265, 94.99598598480225, 96.49291133880615, 97.98983669281006, 99.62509155273438, 101.26034641265869, 102.98487329483032, 104.70940017700195, 106.42482256889343, 108.14024496078491, 109.74774646759033, 111.35524797439575, 113.05509328842163, 114.75493860244751, 116.35880398750305, 117.9626693725586, 119.48791790008545, 121.0131664276123, 122.57899785041809, 124.14482927322388, 125.81728911399841, 127.48974895477295, 129.20393800735474, 130.91812705993652, 132.71881794929504, 134.51950883865356, 136.0652151107788, 137.61092138290405, 139.17609572410583, 140.74127006530762, 142.62885808944702, 144.51644611358643, 146.01194858551025, 147.50745105743408, 148.95533895492554, 150.403226852417, 151.96579957008362, 153.52837228775024, 155.07059836387634, 156.61282444000244, 158.18695521354675, 159.76108598709106, 161.44694066047668, 163.1327953338623, 164.60832047462463, 166.08384561538696, 167.70143675804138, 169.3190279006958, 170.7526891231537, 172.18635034561157, 173.7926526069641, 175.39895486831665, 177.08955025672913, 178.7801456451416, 180.48475050926208, 182.18935537338257, 183.7648570537567, 185.34035873413086, 186.84578919410706, 188.35121965408325, 189.88438868522644, 191.41755771636963, 192.95904350280762, 194.5005292892456, 196.23056769371033, 197.96060609817505, 199.89752078056335, 201.83443546295166, 203.3717200756073, 204.90900468826294, 206.65191078186035, 208.39481687545776, 210.02801036834717, 211.66120386123657, 213.21781635284424, 214.7744288444519, 216.2633421421051, 217.7522554397583, 219.23144555091858, 220.71063566207886, 222.3404324054718, 223.97022914886475, 225.45599007606506, 226.94175100326538, 228.46820831298828, 229.99466562271118, 231.58669590950012, 233.17872619628906, 234.72126579284668, 236.2638053894043, 237.9139358997345, 239.5640664100647, 241.1193332672119, 242.67460012435913, 244.2335183620453, 245.79243659973145, 247.37143564224243, 248.95043468475342, 250.5532522201538, 252.1560697555542, 253.6544852256775, 255.15290069580078, 256.7810711860657, 258.40924167633057, 259.9842975139618, 261.559353351593, 263.185604095459, 264.81185483932495, 266.36426281929016, 267.91667079925537, 269.52796459198, 271.1392583847046, 272.6767179965973, 274.21417760849, 275.8280498981476, 277.4419221878052, 279.03242540359497, 280.62292861938477, 282.3394284248352, 284.05592823028564, 285.6091094017029, 287.1622905731201, 288.71327352523804, 290.26425647735596, 291.6755745410919, 293.0868926048279, 294.62014508247375, 296.15339756011963, 297.88562965393066, 299.6178617477417, 301.2364430427551, 302.85502433776855, 304.6703848838806, 306.4857454299927, 308.29720282554626, 310.10866022109985, 311.75185656547546, 313.3950529098511, 314.91883611679077, 316.44261932373047, 318.0711226463318, 319.6996259689331, 323.10091948509216, 326.5022130012512]
[41.86, 41.86, 45.2, 45.2, 47.3, 47.3, 49.38, 49.38, 53.02, 53.02, 52.68, 52.68, 56.58, 56.58, 58.64, 58.64, 58.44, 58.44, 58.7, 58.7, 58.8, 58.8, 59.78, 59.78, 60.0, 60.0, 61.04, 61.04, 59.92, 59.92, 59.48, 59.48, 60.54, 60.54, 59.64, 59.64, 59.42, 59.42, 60.16, 60.16, 59.74, 59.74, 60.6, 60.6, 59.66, 59.66, 58.46, 58.46, 58.12, 58.12, 57.94, 57.94, 56.94, 56.94, 57.7, 57.7, 58.34, 58.34, 57.18, 57.18, 57.18, 57.18, 56.62, 56.62, 56.12, 56.12, 56.2, 56.2, 56.0, 56.0, 55.62, 55.62, 55.52, 55.52, 54.8, 54.8, 55.0, 55.0, 54.48, 54.48, 54.26, 54.26, 55.14, 55.14, 55.1, 55.1, 54.26, 54.26, 55.38, 55.38, 54.82, 54.82, 54.1, 54.1, 53.62, 53.62, 53.72, 53.72, 53.52, 53.52, 53.64, 53.64, 53.1, 53.1, 54.0, 54.0, 53.42, 53.42, 53.74, 53.74, 53.34, 53.34, 53.82, 53.82, 53.96, 53.96, 55.44, 55.44, 55.78, 55.78, 54.18, 54.18, 53.12, 53.12, 52.3, 52.3, 53.38, 53.38, 54.06, 54.06, 53.78, 53.78, 53.12, 53.12, 53.56, 53.56, 53.76, 53.76, 54.36, 54.36, 53.58, 53.58, 54.58, 54.58, 53.78, 53.78, 53.08, 53.08, 53.8, 53.8, 54.06, 54.06, 54.46, 54.46, 54.7, 54.7, 53.94, 53.94, 53.86, 53.86, 54.7, 54.7, 54.82, 54.82, 54.64, 54.64, 54.92, 54.92, 53.52, 53.52, 53.6, 53.6, 53.94, 53.94, 54.78, 54.78, 54.82, 54.82, 55.36, 55.36, 56.06, 56.06, 56.06, 56.06, 55.9, 55.9, 55.04, 55.04, 54.56, 54.56, 54.18, 54.18, 54.06, 54.06, 54.68, 54.68, 55.32, 55.32, 54.94, 54.94, 54.36, 54.36]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.544, Test loss: 1.487, Test accuracy: 37.94
Round   0, Global train loss: 1.544, Global test loss: 1.505, Global test accuracy: 39.80
Round   1, Train loss: 1.539, Test loss: 1.443, Test accuracy: 39.54
Round   1, Global train loss: 1.539, Global test loss: 1.440, Global test accuracy: 43.20
Round   2, Train loss: 1.392, Test loss: 1.352, Test accuracy: 42.86
Round   2, Global train loss: 1.392, Global test loss: 1.188, Global test accuracy: 53.60
Round   3, Train loss: 1.354, Test loss: 1.308, Test accuracy: 45.98
Round   3, Global train loss: 1.354, Global test loss: 1.130, Global test accuracy: 58.40
Round   4, Train loss: 1.552, Test loss: 1.304, Test accuracy: 49.86
Round   4, Global train loss: 1.552, Global test loss: 1.324, Global test accuracy: 57.40
Round   5, Train loss: 1.368, Test loss: 1.254, Test accuracy: 50.58
Round   5, Global train loss: 1.368, Global test loss: 1.147, Global test accuracy: 57.80
Round   6, Train loss: 1.419, Test loss: 1.238, Test accuracy: 54.06
Round   6, Global train loss: 1.419, Global test loss: 1.256, Global test accuracy: 54.80
Round   7, Train loss: 1.305, Test loss: 1.168, Test accuracy: 56.76
Round   7, Global train loss: 1.305, Global test loss: 1.043, Global test accuracy: 62.20
Round   8, Train loss: 1.502, Test loss: 1.182, Test accuracy: 57.36
Round   8, Global train loss: 1.502, Global test loss: 1.227, Global test accuracy: 59.40
Round   9, Train loss: 1.319, Test loss: 1.155, Test accuracy: 56.84
Round   9, Global train loss: 1.319, Global test loss: 1.043, Global test accuracy: 65.60
Round  10, Train loss: 1.196, Test loss: 1.136, Test accuracy: 56.38
Round  10, Global train loss: 1.196, Global test loss: 0.956, Global test accuracy: 63.20
Round  11, Train loss: 1.438, Test loss: 1.181, Test accuracy: 55.88
Round  11, Global train loss: 1.438, Global test loss: 1.225, Global test accuracy: 57.20
Round  12, Train loss: 1.239, Test loss: 1.158, Test accuracy: 56.68
Round  12, Global train loss: 1.239, Global test loss: 0.982, Global test accuracy: 67.20
Round  13, Train loss: 1.275, Test loss: 1.125, Test accuracy: 59.14
Round  13, Global train loss: 1.275, Global test loss: 0.933, Global test accuracy: 69.60
Round  14, Train loss: 1.084, Test loss: 1.114, Test accuracy: 58.64
Round  14, Global train loss: 1.084, Global test loss: 0.814, Global test accuracy: 69.20
Round  15, Train loss: 1.410, Test loss: 1.111, Test accuracy: 59.32
Round  15, Global train loss: 1.410, Global test loss: 1.132, Global test accuracy: 63.20
Round  16, Train loss: 1.328, Test loss: 1.119, Test accuracy: 57.76
Round  16, Global train loss: 1.328, Global test loss: 1.102, Global test accuracy: 62.20
Round  17, Train loss: 1.306, Test loss: 1.097, Test accuracy: 58.24
Round  17, Global train loss: 1.306, Global test loss: 1.075, Global test accuracy: 62.60
Round  18, Train loss: 1.270, Test loss: 1.099, Test accuracy: 57.56
Round  18, Global train loss: 1.270, Global test loss: 1.047, Global test accuracy: 64.40
Round  19, Train loss: 1.036, Test loss: 1.116, Test accuracy: 57.68
Round  19, Global train loss: 1.036, Global test loss: 0.826, Global test accuracy: 67.00
Round  20, Train loss: 1.301, Test loss: 1.116, Test accuracy: 57.74
Round  20, Global train loss: 1.301, Global test loss: 1.186, Global test accuracy: 56.20
Round  21, Train loss: 1.256, Test loss: 1.137, Test accuracy: 56.84
Round  21, Global train loss: 1.256, Global test loss: 1.261, Global test accuracy: 53.40
Round  22, Train loss: 1.145, Test loss: 1.146, Test accuracy: 56.68
Round  22, Global train loss: 1.145, Global test loss: 1.193, Global test accuracy: 55.40
Round  23, Train loss: 1.045, Test loss: 1.171, Test accuracy: 55.58
Round  23, Global train loss: 1.045, Global test loss: 0.981, Global test accuracy: 63.40
Round  24, Train loss: 1.000, Test loss: 1.159, Test accuracy: 55.84
Round  24, Global train loss: 1.000, Global test loss: 1.004, Global test accuracy: 60.60
Round  25, Train loss: 0.838, Test loss: 1.153, Test accuracy: 56.40
Round  25, Global train loss: 0.838, Global test loss: 0.749, Global test accuracy: 70.20
Round  26, Train loss: 0.970, Test loss: 1.153, Test accuracy: 55.76
Round  26, Global train loss: 0.970, Global test loss: 0.900, Global test accuracy: 66.60
Round  27, Train loss: 0.919, Test loss: 1.148, Test accuracy: 55.54
Round  27, Global train loss: 0.919, Global test loss: 0.831, Global test accuracy: 66.60
Round  28, Train loss: 0.917, Test loss: 1.154, Test accuracy: 55.18
Round  28, Global train loss: 0.917, Global test loss: 0.938, Global test accuracy: 64.60
Round  29, Train loss: 0.913, Test loss: 1.179, Test accuracy: 55.26
Round  29, Global train loss: 0.913, Global test loss: 0.798, Global test accuracy: 72.60
Round  30, Train loss: 0.793, Test loss: 1.173, Test accuracy: 55.38
Round  30, Global train loss: 0.793, Global test loss: 0.762, Global test accuracy: 69.80
Round  31, Train loss: 0.868, Test loss: 1.180, Test accuracy: 55.80
Round  31, Global train loss: 0.868, Global test loss: 0.928, Global test accuracy: 64.40
Round  32, Train loss: 0.912, Test loss: 1.196, Test accuracy: 55.16
Round  32, Global train loss: 0.912, Global test loss: 0.941, Global test accuracy: 63.80
Round  33, Train loss: 0.813, Test loss: 1.176, Test accuracy: 54.82
Round  33, Global train loss: 0.813, Global test loss: 0.733, Global test accuracy: 70.20
Round  34, Train loss: 0.870, Test loss: 1.217, Test accuracy: 54.72
Round  34, Global train loss: 0.870, Global test loss: 1.061, Global test accuracy: 59.80
Round  35, Train loss: 0.890, Test loss: 1.253, Test accuracy: 54.40
Round  35, Global train loss: 0.890, Global test loss: 1.041, Global test accuracy: 60.20
Round  36, Train loss: 0.730, Test loss: 1.264, Test accuracy: 55.00
Round  36, Global train loss: 0.730, Global test loss: 0.788, Global test accuracy: 72.20
Round  37, Train loss: 0.913, Test loss: 1.257, Test accuracy: 55.28
Round  37, Global train loss: 0.913, Global test loss: 1.165, Global test accuracy: 57.20
Round  38, Train loss: 0.764, Test loss: 1.273, Test accuracy: 54.80
Round  38, Global train loss: 0.764, Global test loss: 0.978, Global test accuracy: 62.40
Round  39, Train loss: 0.753, Test loss: 1.260, Test accuracy: 55.32
Round  39, Global train loss: 0.753, Global test loss: 0.889, Global test accuracy: 66.20
Round  40, Train loss: 0.661, Test loss: 1.322, Test accuracy: 53.96
Round  40, Global train loss: 0.661, Global test loss: 0.972, Global test accuracy: 65.60
Round  41, Train loss: 0.809, Test loss: 1.338, Test accuracy: 53.42
Round  41, Global train loss: 0.809, Global test loss: 1.286, Global test accuracy: 54.40
Round  42, Train loss: 0.624, Test loss: 1.362, Test accuracy: 53.62
Round  42, Global train loss: 0.624, Global test loss: 1.044, Global test accuracy: 63.80
Round  43, Train loss: 0.575, Test loss: 1.407, Test accuracy: 52.70
Round  43, Global train loss: 0.575, Global test loss: 1.108, Global test accuracy: 59.40
Round  44, Train loss: 0.734, Test loss: 1.447, Test accuracy: 52.50
Round  44, Global train loss: 0.734, Global test loss: 1.536, Global test accuracy: 48.80
Round  45, Train loss: 0.606, Test loss: 1.507, Test accuracy: 52.90
Round  45, Global train loss: 0.606, Global test loss: 1.340, Global test accuracy: 57.00
Round  46, Train loss: 0.553, Test loss: 1.573, Test accuracy: 52.26
Round  46, Global train loss: 0.553, Global test loss: 1.230, Global test accuracy: 60.20
Round  47, Train loss: 0.568, Test loss: 1.614, Test accuracy: 51.68
Round  47, Global train loss: 0.568, Global test loss: 1.031, Global test accuracy: 63.20
Round  48, Train loss: 0.499, Test loss: 1.643, Test accuracy: 51.48
Round  48, Global train loss: 0.499, Global test loss: 1.612, Global test accuracy: 52.40
Round  49, Train loss: 0.458, Test loss: 1.684, Test accuracy: 52.12
Round  49, Global train loss: 0.458, Global test loss: 1.377, Global test accuracy: 59.80
Round  50, Train loss: 0.434, Test loss: 1.620, Test accuracy: 52.62
Round  50, Global train loss: 0.434, Global test loss: 1.213, Global test accuracy: 61.00
Round  51, Train loss: 0.541, Test loss: 1.617, Test accuracy: 53.68
Round  51, Global train loss: 0.541, Global test loss: 1.757, Global test accuracy: 50.40
Round  52, Train loss: 0.507, Test loss: 1.664, Test accuracy: 53.24
Round  52, Global train loss: 0.507, Global test loss: 1.180, Global test accuracy: 62.60
Round  53, Train loss: 0.482, Test loss: 1.661, Test accuracy: 52.58
Round  53, Global train loss: 0.482, Global test loss: 1.008, Global test accuracy: 65.00
Round  54, Train loss: 0.503, Test loss: 1.677, Test accuracy: 53.22
Round  54, Global train loss: 0.503, Global test loss: 1.297, Global test accuracy: 59.20
Round  55, Train loss: 0.495, Test loss: 1.682, Test accuracy: 53.62
Round  55, Global train loss: 0.495, Global test loss: 1.328, Global test accuracy: 58.40
Round  56, Train loss: 0.489, Test loss: 1.712, Test accuracy: 54.10
Round  56, Global train loss: 0.489, Global test loss: 1.386, Global test accuracy: 57.00
Round  57, Train loss: 0.464, Test loss: 1.711, Test accuracy: 54.62
Round  57, Global train loss: 0.464, Global test loss: 1.109, Global test accuracy: 64.60
Round  58, Train loss: 0.324, Test loss: 1.729, Test accuracy: 54.86
Round  58, Global train loss: 0.324, Global test loss: 0.963, Global test accuracy: 71.00
Round  59, Train loss: 0.333, Test loss: 1.738, Test accuracy: 54.82
Round  59, Global train loss: 0.333, Global test loss: 1.262, Global test accuracy: 63.40
Round  60, Train loss: 0.453, Test loss: 1.748, Test accuracy: 55.26
Round  60, Global train loss: 0.453, Global test loss: 1.623, Global test accuracy: 58.20
Round  61, Train loss: 0.399, Test loss: 1.830, Test accuracy: 54.62
Round  61, Global train loss: 0.399, Global test loss: 1.290, Global test accuracy: 63.40
Round  62, Train loss: 0.346, Test loss: 1.811, Test accuracy: 54.60
Round  62, Global train loss: 0.346, Global test loss: 1.288, Global test accuracy: 63.80
Round  63, Train loss: 0.377, Test loss: 1.892, Test accuracy: 53.92
Round  63, Global train loss: 0.377, Global test loss: 1.887, Global test accuracy: 55.40
Round  64, Train loss: 0.486, Test loss: 1.898, Test accuracy: 54.38
Round  64, Global train loss: 0.486, Global test loss: 1.774, Global test accuracy: 52.20
Round  65, Train loss: 0.313, Test loss: 1.890, Test accuracy: 53.98
Round  65, Global train loss: 0.313, Global test loss: 1.430, Global test accuracy: 60.80
Round  66, Train loss: 0.294, Test loss: 1.938, Test accuracy: 54.20
Round  66, Global train loss: 0.294, Global test loss: 1.184, Global test accuracy: 67.60
Round  67, Train loss: 0.371, Test loss: 1.957, Test accuracy: 54.06
Round  67, Global train loss: 0.371, Global test loss: 1.562, Global test accuracy: 60.00
Round  68, Train loss: 0.311, Test loss: 1.982, Test accuracy: 53.74
Round  68, Global train loss: 0.311, Global test loss: 1.869, Global test accuracy: 54.80
Round  69, Train loss: 0.316, Test loss: 2.053, Test accuracy: 52.52
Round  69, Global train loss: 0.316, Global test loss: 1.470, Global test accuracy: 62.00
Round  70, Train loss: 0.268, Test loss: 2.032, Test accuracy: 53.34
Round  70, Global train loss: 0.268, Global test loss: 1.331, Global test accuracy: 63.40
Round  71, Train loss: 0.333, Test loss: 2.069, Test accuracy: 52.86
Round  71, Global train loss: 0.333, Global test loss: 1.450, Global test accuracy: 60.80
Round  72, Train loss: 0.183, Test loss: 2.157, Test accuracy: 52.44
Round  72, Global train loss: 0.183, Global test loss: 1.693, Global test accuracy: 61.00
Round  73, Train loss: 0.245, Test loss: 2.162, Test accuracy: 53.20
Round  73, Global train loss: 0.245, Global test loss: 1.095, Global test accuracy: 70.80
Round  74, Train loss: 0.344, Test loss: 2.004, Test accuracy: 54.90
Round  74, Global train loss: 0.344, Global test loss: 1.378, Global test accuracy: 61.40
Round  75, Train loss: 0.271, Test loss: 1.988, Test accuracy: 55.04
Round  75, Global train loss: 0.271, Global test loss: 1.367, Global test accuracy: 63.20
Round  76, Train loss: 0.267, Test loss: 1.965, Test accuracy: 55.36
Round  76, Global train loss: 0.267, Global test loss: 1.672, Global test accuracy: 60.40
Round  77, Train loss: 0.209, Test loss: 2.002, Test accuracy: 55.44
Round  77, Global train loss: 0.209, Global test loss: 1.564, Global test accuracy: 64.20
Round  78, Train loss: 0.198, Test loss: 2.111, Test accuracy: 54.50
Round  78, Global train loss: 0.198, Global test loss: 2.159, Global test accuracy: 53.60
Round  79, Train loss: 0.238, Test loss: 2.174, Test accuracy: 54.38
Round  79, Global train loss: 0.238, Global test loss: 1.635, Global test accuracy: 62.60
Round  80, Train loss: 0.290, Test loss: 2.156, Test accuracy: 55.54
Round  80, Global train loss: 0.290, Global test loss: 2.163, Global test accuracy: 50.60
Round  81, Train loss: 0.243, Test loss: 2.128, Test accuracy: 56.28
Round  81, Global train loss: 0.243, Global test loss: 1.951, Global test accuracy: 55.20
Round  82, Train loss: 0.146, Test loss: 2.163, Test accuracy: 55.64
Round  82, Global train loss: 0.146, Global test loss: 1.674, Global test accuracy: 59.60
Round  83, Train loss: 0.292, Test loss: 2.225, Test accuracy: 55.84
Round  83, Global train loss: 0.292, Global test loss: 1.273, Global test accuracy: 67.80
Round  84, Train loss: 0.323, Test loss: 2.242, Test accuracy: 55.56
Round  84, Global train loss: 0.323, Global test loss: 1.314, Global test accuracy: 63.80
Round  85, Train loss: 0.187, Test loss: 2.228, Test accuracy: 55.88
Round  85, Global train loss: 0.187, Global test loss: 1.603, Global test accuracy: 63.00
Round  86, Train loss: 0.227, Test loss: 2.173, Test accuracy: 56.16
Round  86, Global train loss: 0.227, Global test loss: 1.216, Global test accuracy: 67.80
Round  87, Train loss: 0.274, Test loss: 2.115, Test accuracy: 56.64
Round  87, Global train loss: 0.274, Global test loss: 1.340, Global test accuracy: 65.00
Round  88, Train loss: 0.201, Test loss: 2.043, Test accuracy: 57.56
Round  88, Global train loss: 0.201, Global test loss: 1.278, Global test accuracy: 69.20
Round  89, Train loss: 0.172, Test loss: 2.049, Test accuracy: 58.14
Round  89, Global train loss: 0.172, Global test loss: 1.249, Global test accuracy: 70.80
Round  90, Train loss: 0.193, Test loss: 1.976, Test accuracy: 58.50
Round  90, Global train loss: 0.193, Global test loss: 1.384, Global test accuracy: 66.40
Round  91, Train loss: 0.148, Test loss: 2.074, Test accuracy: 58.38
Round  91, Global train loss: 0.148, Global test loss: 1.428, Global test accuracy: 65.80
Round  92, Train loss: 0.217, Test loss: 2.116, Test accuracy: 57.52
Round  92, Global train loss: 0.217, Global test loss: 1.467, Global test accuracy: 64.20
Round  93, Train loss: 0.170, Test loss: 2.145, Test accuracy: 57.18
Round  93, Global train loss: 0.170, Global test loss: 1.345, Global test accuracy: 68.60
Round  94, Train loss: 0.220, Test loss: 2.149, Test accuracy: 57.50
Round  94, Global train loss: 0.220, Global test loss: 1.655, Global test accuracy: 60.60/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.150, Test loss: 2.183, Test accuracy: 56.84
Round  95, Global train loss: 0.150, Global test loss: 1.692, Global test accuracy: 63.00
Round  96, Train loss: 0.152, Test loss: 2.212, Test accuracy: 57.12
Round  96, Global train loss: 0.152, Global test loss: 1.789, Global test accuracy: 59.80
Round  97, Train loss: 0.178, Test loss: 2.189, Test accuracy: 56.62
Round  97, Global train loss: 0.178, Global test loss: 1.996, Global test accuracy: 58.60
Round  98, Train loss: 0.193, Test loss: 2.331, Test accuracy: 55.70
Round  98, Global train loss: 0.193, Global test loss: 2.417, Global test accuracy: 52.80
Round  99, Train loss: 0.178, Test loss: 2.367, Test accuracy: 55.56
Round  99, Global train loss: 0.178, Global test loss: 1.492, Global test accuracy: 68.20
Final Round, Train loss: 0.143, Test loss: 2.149, Test accuracy: 57.34
Final Round, Global train loss: 0.143, Global test loss: 1.492, Global test accuracy: 68.20
Average accuracy final 10 rounds: 57.092 

Average global accuracy final 10 rounds: 62.8 

948.3798019886017
[2.178311824798584, 4.356623649597168, 6.078808784484863, 7.800993919372559, 9.484180450439453, 11.167366981506348, 12.858778715133667, 14.550190448760986, 16.215243816375732, 17.88029718399048, 19.523683786392212, 21.167070388793945, 22.837682723999023, 24.5082950592041, 26.25413990020752, 27.999984741210938, 29.716506004333496, 31.433027267456055, 33.063713788986206, 34.69440031051636, 36.508782625198364, 38.32316493988037, 40.03917908668518, 41.75519323348999, 43.44394063949585, 45.13268804550171, 46.718106508255005, 48.3035249710083, 49.90659523010254, 51.50966548919678, 53.19082260131836, 54.87197971343994, 56.62685990333557, 58.3817400932312, 60.21089506149292, 62.04005002975464, 63.82427191734314, 65.60849380493164, 67.23004198074341, 68.85159015655518, 70.54200673103333, 72.23242330551147, 73.86978149414062, 75.50713968276978, 77.16277408599854, 78.8184084892273, 80.56387066841125, 82.30933284759521, 83.9862425327301, 85.66315221786499, 87.50070762634277, 89.33826303482056, 91.0801453590393, 92.82202768325806, 94.4508101940155, 96.07959270477295, 97.72591280937195, 99.37223291397095, 101.02626085281372, 102.6802887916565, 104.50507140159607, 106.32985401153564, 108.43936204910278, 110.54887008666992, 112.47264099121094, 114.39641189575195, 116.35791373252869, 118.31941556930542, 120.18331003189087, 122.04720449447632, 123.71263837814331, 125.3780722618103, 127.06071352958679, 128.74335479736328, 130.40892791748047, 132.07450103759766, 133.67497634887695, 135.27545166015625, 136.9418909549713, 138.60833024978638, 140.56529784202576, 142.52226543426514, 144.15332102775574, 145.78437662124634, 147.5625123977661, 149.3406481742859, 151.02248620986938, 152.70432424545288, 154.15668296813965, 155.60904169082642, 157.1486358642578, 158.6882300376892, 160.14491391181946, 161.6015977859497, 163.0410680770874, 164.4805383682251, 165.8472180366516, 167.21389770507812, 168.64557719230652, 170.0772566795349, 171.59898233413696, 173.120707988739, 174.59661078453064, 176.07251358032227, 177.4889166355133, 178.90531969070435, 180.3793761730194, 181.85343265533447, 183.2643530368805, 184.6752734184265, 186.1193265914917, 187.56337976455688, 188.9711401462555, 190.3789005279541, 191.7882218360901, 193.19754314422607, 194.6209201812744, 196.04429721832275, 197.46303153038025, 198.88176584243774, 200.31748390197754, 201.75320196151733, 203.24843907356262, 204.7436761856079, 206.16255402565002, 207.58143186569214, 208.96915459632874, 210.35687732696533, 211.80405044555664, 213.25122356414795, 214.72154688835144, 216.19187021255493, 217.61708736419678, 219.04230451583862, 220.42960786819458, 221.81691122055054, 223.1801676750183, 224.54342412948608, 225.8834445476532, 227.2234649658203, 228.863196849823, 230.50292873382568, 231.77061581611633, 233.03830289840698, 234.2567811012268, 235.47525930404663, 236.73806881904602, 238.0008783340454, 239.4369876384735, 240.8730969429016, 242.12896990776062, 243.38484287261963, 244.644362449646, 245.90388202667236, 247.11713528633118, 248.33038854599, 249.5437216758728, 250.75705480575562, 251.94939470291138, 253.14173460006714, 254.34428930282593, 255.54684400558472, 256.732670545578, 257.9184970855713, 259.1102910041809, 260.3020849227905, 261.5102789402008, 262.7184729576111, 263.9113428592682, 265.1042127609253, 266.31928420066833, 267.5343556404114, 268.74550223350525, 269.9566488265991, 271.17135429382324, 272.38605976104736, 273.589476108551, 274.7928924560547, 276.1212341785431, 277.4495759010315, 278.8288757801056, 280.2081756591797, 281.4068088531494, 282.60544204711914, 283.83958435058594, 285.07372665405273, 286.30828046798706, 287.5428342819214, 288.7365970611572, 289.93035984039307, 291.1480665206909, 292.36577320098877, 293.5579478740692, 294.75012254714966, 295.9483621120453, 297.1466016769409, 298.33982968330383, 299.53305768966675, 300.7276690006256, 301.9222803115845, 304.3098385334015, 306.6973967552185]
[37.94, 37.94, 39.54, 39.54, 42.86, 42.86, 45.98, 45.98, 49.86, 49.86, 50.58, 50.58, 54.06, 54.06, 56.76, 56.76, 57.36, 57.36, 56.84, 56.84, 56.38, 56.38, 55.88, 55.88, 56.68, 56.68, 59.14, 59.14, 58.64, 58.64, 59.32, 59.32, 57.76, 57.76, 58.24, 58.24, 57.56, 57.56, 57.68, 57.68, 57.74, 57.74, 56.84, 56.84, 56.68, 56.68, 55.58, 55.58, 55.84, 55.84, 56.4, 56.4, 55.76, 55.76, 55.54, 55.54, 55.18, 55.18, 55.26, 55.26, 55.38, 55.38, 55.8, 55.8, 55.16, 55.16, 54.82, 54.82, 54.72, 54.72, 54.4, 54.4, 55.0, 55.0, 55.28, 55.28, 54.8, 54.8, 55.32, 55.32, 53.96, 53.96, 53.42, 53.42, 53.62, 53.62, 52.7, 52.7, 52.5, 52.5, 52.9, 52.9, 52.26, 52.26, 51.68, 51.68, 51.48, 51.48, 52.12, 52.12, 52.62, 52.62, 53.68, 53.68, 53.24, 53.24, 52.58, 52.58, 53.22, 53.22, 53.62, 53.62, 54.1, 54.1, 54.62, 54.62, 54.86, 54.86, 54.82, 54.82, 55.26, 55.26, 54.62, 54.62, 54.6, 54.6, 53.92, 53.92, 54.38, 54.38, 53.98, 53.98, 54.2, 54.2, 54.06, 54.06, 53.74, 53.74, 52.52, 52.52, 53.34, 53.34, 52.86, 52.86, 52.44, 52.44, 53.2, 53.2, 54.9, 54.9, 55.04, 55.04, 55.36, 55.36, 55.44, 55.44, 54.5, 54.5, 54.38, 54.38, 55.54, 55.54, 56.28, 56.28, 55.64, 55.64, 55.84, 55.84, 55.56, 55.56, 55.88, 55.88, 56.16, 56.16, 56.64, 56.64, 57.56, 57.56, 58.14, 58.14, 58.5, 58.5, 58.38, 58.38, 57.52, 57.52, 57.18, 57.18, 57.5, 57.5, 56.84, 56.84, 57.12, 57.12, 56.62, 56.62, 55.7, 55.7, 55.56, 55.56, 57.34, 57.34]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.541, Test loss: 1.492, Test accuracy: 28.66
Round   0, Global train loss: 1.541, Global test loss: 1.483, Global test accuracy: 29.00
Round   1, Train loss: 1.422, Test loss: 1.481, Test accuracy: 34.12
Round   1, Global train loss: 1.422, Global test loss: 1.428, Global test accuracy: 38.40
Round   2, Train loss: 1.351, Test loss: 1.425, Test accuracy: 38.22
Round   2, Global train loss: 1.351, Global test loss: 1.275, Global test accuracy: 51.00
Round   3, Train loss: 1.297, Test loss: 1.404, Test accuracy: 42.42
Round   3, Global train loss: 1.297, Global test loss: 1.277, Global test accuracy: 55.60
Round   4, Train loss: 1.322, Test loss: 1.413, Test accuracy: 47.30
Round   4, Global train loss: 1.322, Global test loss: 1.364, Global test accuracy: 55.20
Round   5, Train loss: 1.147, Test loss: 1.403, Test accuracy: 47.96
Round   5, Global train loss: 1.147, Global test loss: 1.370, Global test accuracy: 52.20
Round   6, Train loss: 1.158, Test loss: 1.337, Test accuracy: 53.62
Round   6, Global train loss: 1.158, Global test loss: 1.219, Global test accuracy: 56.80
Round   7, Train loss: 1.247, Test loss: 1.275, Test accuracy: 55.32
Round   7, Global train loss: 1.247, Global test loss: 1.078, Global test accuracy: 61.20
Round   8, Train loss: 1.193, Test loss: 1.237, Test accuracy: 58.18
Round   8, Global train loss: 1.193, Global test loss: 1.104, Global test accuracy: 63.00
Round   9, Train loss: 1.290, Test loss: 1.231, Test accuracy: 58.94
Round   9, Global train loss: 1.290, Global test loss: 1.140, Global test accuracy: 65.00
Round  10, Train loss: 1.250, Test loss: 1.207, Test accuracy: 59.68
Round  10, Global train loss: 1.250, Global test loss: 1.135, Global test accuracy: 65.60
Round  11, Train loss: 1.080, Test loss: 1.222, Test accuracy: 58.16
Round  11, Global train loss: 1.080, Global test loss: 1.147, Global test accuracy: 59.80
Round  12, Train loss: 1.176, Test loss: 1.200, Test accuracy: 58.24
Round  12, Global train loss: 1.176, Global test loss: 1.035, Global test accuracy: 62.20
Round  13, Train loss: 1.311, Test loss: 1.204, Test accuracy: 58.04
Round  13, Global train loss: 1.311, Global test loss: 1.138, Global test accuracy: 62.60
Round  14, Train loss: 1.233, Test loss: 1.189, Test accuracy: 58.40
Round  14, Global train loss: 1.233, Global test loss: 0.971, Global test accuracy: 69.40
Round  15, Train loss: 1.100, Test loss: 1.191, Test accuracy: 57.80
Round  15, Global train loss: 1.100, Global test loss: 1.039, Global test accuracy: 62.00
Round  16, Train loss: 1.071, Test loss: 1.178, Test accuracy: 59.12
Round  16, Global train loss: 1.071, Global test loss: 1.032, Global test accuracy: 62.20
Round  17, Train loss: 1.023, Test loss: 1.175, Test accuracy: 59.28
Round  17, Global train loss: 1.023, Global test loss: 1.030, Global test accuracy: 63.40
Round  18, Train loss: 1.034, Test loss: 1.187, Test accuracy: 57.86
Round  18, Global train loss: 1.034, Global test loss: 1.141, Global test accuracy: 59.20
Round  19, Train loss: 1.232, Test loss: 1.200, Test accuracy: 57.26
Round  19, Global train loss: 1.232, Global test loss: 1.119, Global test accuracy: 61.60
Round  20, Train loss: 0.977, Test loss: 1.217, Test accuracy: 56.80
Round  20, Global train loss: 0.977, Global test loss: 1.100, Global test accuracy: 59.80
Round  21, Train loss: 1.022, Test loss: 1.203, Test accuracy: 57.86
Round  21, Global train loss: 1.022, Global test loss: 1.211, Global test accuracy: 58.60
Round  22, Train loss: 0.894, Test loss: 1.229, Test accuracy: 56.68
Round  22, Global train loss: 0.894, Global test loss: 1.214, Global test accuracy: 57.00
Round  23, Train loss: 0.976, Test loss: 1.236, Test accuracy: 57.58
Round  23, Global train loss: 0.976, Global test loss: 0.998, Global test accuracy: 62.60
Round  24, Train loss: 0.823, Test loss: 1.265, Test accuracy: 56.88
Round  24, Global train loss: 0.823, Global test loss: 1.168, Global test accuracy: 60.40
Round  25, Train loss: 1.053, Test loss: 1.291, Test accuracy: 56.34
Round  25, Global train loss: 1.053, Global test loss: 1.065, Global test accuracy: 62.00
Round  26, Train loss: 0.931, Test loss: 1.338, Test accuracy: 54.98
Round  26, Global train loss: 0.931, Global test loss: 1.164, Global test accuracy: 57.40
Round  27, Train loss: 0.884, Test loss: 1.329, Test accuracy: 56.10
Round  27, Global train loss: 0.884, Global test loss: 1.055, Global test accuracy: 64.40
Round  28, Train loss: 0.880, Test loss: 1.366, Test accuracy: 55.00
Round  28, Global train loss: 0.880, Global test loss: 1.281, Global test accuracy: 54.20
Round  29, Train loss: 0.834, Test loss: 1.392, Test accuracy: 54.52
Round  29, Global train loss: 0.834, Global test loss: 0.919, Global test accuracy: 66.60
Round  30, Train loss: 0.870, Test loss: 1.385, Test accuracy: 54.42
Round  30, Global train loss: 0.870, Global test loss: 1.124, Global test accuracy: 60.60
Round  31, Train loss: 0.742, Test loss: 1.362, Test accuracy: 54.68
Round  31, Global train loss: 0.742, Global test loss: 0.966, Global test accuracy: 63.00
Round  32, Train loss: 0.795, Test loss: 1.378, Test accuracy: 55.76
Round  32, Global train loss: 0.795, Global test loss: 1.034, Global test accuracy: 61.80
Round  33, Train loss: 0.735, Test loss: 1.369, Test accuracy: 56.10
Round  33, Global train loss: 0.735, Global test loss: 0.907, Global test accuracy: 65.80
Round  34, Train loss: 0.672, Test loss: 1.428, Test accuracy: 54.84
Round  34, Global train loss: 0.672, Global test loss: 1.322, Global test accuracy: 56.80
Round  35, Train loss: 0.582, Test loss: 1.419, Test accuracy: 55.68
Round  35, Global train loss: 0.582, Global test loss: 1.170, Global test accuracy: 58.60
Round  36, Train loss: 0.845, Test loss: 1.453, Test accuracy: 55.38
Round  36, Global train loss: 0.845, Global test loss: 1.199, Global test accuracy: 58.40
Round  37, Train loss: 0.657, Test loss: 1.439, Test accuracy: 55.40
Round  37, Global train loss: 0.657, Global test loss: 1.183, Global test accuracy: 58.60
Round  38, Train loss: 0.505, Test loss: 1.437, Test accuracy: 55.68
Round  38, Global train loss: 0.505, Global test loss: 1.179, Global test accuracy: 60.20
Round  39, Train loss: 0.642, Test loss: 1.477, Test accuracy: 55.42
Round  39, Global train loss: 0.642, Global test loss: 1.073, Global test accuracy: 61.00
Round  40, Train loss: 0.616, Test loss: 1.534, Test accuracy: 54.04
Round  40, Global train loss: 0.616, Global test loss: 1.295, Global test accuracy: 54.20
Round  41, Train loss: 0.517, Test loss: 1.484, Test accuracy: 54.62
Round  41, Global train loss: 0.517, Global test loss: 1.105, Global test accuracy: 63.20
Round  42, Train loss: 0.528, Test loss: 1.543, Test accuracy: 53.52
Round  42, Global train loss: 0.528, Global test loss: 1.103, Global test accuracy: 61.00
Round  43, Train loss: 0.499, Test loss: 1.563, Test accuracy: 54.12
Round  43, Global train loss: 0.499, Global test loss: 1.300, Global test accuracy: 57.60
Round  44, Train loss: 0.469, Test loss: 1.612, Test accuracy: 54.32
Round  44, Global train loss: 0.469, Global test loss: 1.378, Global test accuracy: 58.00
Round  45, Train loss: 0.439, Test loss: 1.574, Test accuracy: 55.00
Round  45, Global train loss: 0.439, Global test loss: 1.405, Global test accuracy: 58.40
Round  46, Train loss: 0.524, Test loss: 1.632, Test accuracy: 54.20
Round  46, Global train loss: 0.524, Global test loss: 1.394, Global test accuracy: 56.80
Round  47, Train loss: 0.520, Test loss: 1.626, Test accuracy: 54.78
Round  47, Global train loss: 0.520, Global test loss: 1.181, Global test accuracy: 60.60
Round  48, Train loss: 0.274, Test loss: 1.709, Test accuracy: 54.60
Round  48, Global train loss: 0.274, Global test loss: 1.795, Global test accuracy: 53.60
Round  49, Train loss: 0.456, Test loss: 1.716, Test accuracy: 54.52
Round  49, Global train loss: 0.456, Global test loss: 1.526, Global test accuracy: 53.60
Round  50, Train loss: 0.433, Test loss: 1.676, Test accuracy: 54.86
Round  50, Global train loss: 0.433, Global test loss: 1.471, Global test accuracy: 56.40
Round  51, Train loss: 0.324, Test loss: 1.742, Test accuracy: 54.74
Round  51, Global train loss: 0.324, Global test loss: 1.821, Global test accuracy: 54.40
Round  52, Train loss: 0.474, Test loss: 1.776, Test accuracy: 54.18
Round  52, Global train loss: 0.474, Global test loss: 1.372, Global test accuracy: 57.80
Round  53, Train loss: 0.436, Test loss: 1.801, Test accuracy: 54.20
Round  53, Global train loss: 0.436, Global test loss: 1.261, Global test accuracy: 61.40
Round  54, Train loss: 0.446, Test loss: 1.776, Test accuracy: 54.08
Round  54, Global train loss: 0.446, Global test loss: 1.425, Global test accuracy: 55.80
Round  55, Train loss: 0.341, Test loss: 1.764, Test accuracy: 54.42
Round  55, Global train loss: 0.341, Global test loss: 1.348, Global test accuracy: 61.40
Round  56, Train loss: 0.253, Test loss: 1.849, Test accuracy: 54.32
Round  56, Global train loss: 0.253, Global test loss: 1.666, Global test accuracy: 57.00
Round  57, Train loss: 0.400, Test loss: 1.765, Test accuracy: 55.22
Round  57, Global train loss: 0.400, Global test loss: 1.192, Global test accuracy: 62.20
Round  58, Train loss: 0.458, Test loss: 1.799, Test accuracy: 55.02
Round  58, Global train loss: 0.458, Global test loss: 1.319, Global test accuracy: 60.60
Round  59, Train loss: 0.314, Test loss: 1.718, Test accuracy: 55.34
Round  59, Global train loss: 0.314, Global test loss: 1.379, Global test accuracy: 58.40
Round  60, Train loss: 0.266, Test loss: 1.823, Test accuracy: 54.18
Round  60, Global train loss: 0.266, Global test loss: 1.620, Global test accuracy: 59.00
Round  61, Train loss: 0.344, Test loss: 1.883, Test accuracy: 53.96
Round  61, Global train loss: 0.344, Global test loss: 1.353, Global test accuracy: 59.80
Round  62, Train loss: 0.352, Test loss: 2.022, Test accuracy: 53.02
Round  62, Global train loss: 0.352, Global test loss: 1.678, Global test accuracy: 54.80
Round  63, Train loss: 0.249, Test loss: 2.075, Test accuracy: 53.12
Round  63, Global train loss: 0.249, Global test loss: 1.776, Global test accuracy: 58.20
Round  64, Train loss: 0.287, Test loss: 2.178, Test accuracy: 52.82
Round  64, Global train loss: 0.287, Global test loss: 1.709, Global test accuracy: 57.20
Round  65, Train loss: 0.214, Test loss: 2.101, Test accuracy: 53.12
Round  65, Global train loss: 0.214, Global test loss: 1.753, Global test accuracy: 59.40
Round  66, Train loss: 0.313, Test loss: 2.061, Test accuracy: 53.86
Round  66, Global train loss: 0.313, Global test loss: 1.534, Global test accuracy: 60.00
Round  67, Train loss: 0.196, Test loss: 2.044, Test accuracy: 54.18
Round  67, Global train loss: 0.196, Global test loss: 1.603, Global test accuracy: 60.80
Round  68, Train loss: 0.256, Test loss: 2.001, Test accuracy: 54.94
Round  68, Global train loss: 0.256, Global test loss: 1.877, Global test accuracy: 54.80
Round  69, Train loss: 0.295, Test loss: 2.065, Test accuracy: 54.00
Round  69, Global train loss: 0.295, Global test loss: 1.657, Global test accuracy: 54.20
Round  70, Train loss: 0.244, Test loss: 2.116, Test accuracy: 53.08
Round  70, Global train loss: 0.244, Global test loss: 1.780, Global test accuracy: 55.60
Round  71, Train loss: 0.270, Test loss: 2.129, Test accuracy: 53.20
Round  71, Global train loss: 0.270, Global test loss: 1.581, Global test accuracy: 60.20
Round  72, Train loss: 0.197, Test loss: 2.145, Test accuracy: 53.28
Round  72, Global train loss: 0.197, Global test loss: 1.847, Global test accuracy: 55.80
Round  73, Train loss: 0.322, Test loss: 2.163, Test accuracy: 52.68
Round  73, Global train loss: 0.322, Global test loss: 1.594, Global test accuracy: 56.20
Round  74, Train loss: 0.181, Test loss: 2.193, Test accuracy: 52.76
Round  74, Global train loss: 0.181, Global test loss: 1.747, Global test accuracy: 58.20
Round  75, Train loss: 0.246, Test loss: 2.205, Test accuracy: 52.20
Round  75, Global train loss: 0.246, Global test loss: 1.678, Global test accuracy: 56.60
Round  76, Train loss: 0.185, Test loss: 2.224, Test accuracy: 52.32
Round  76, Global train loss: 0.185, Global test loss: 1.836, Global test accuracy: 56.80
Round  77, Train loss: 0.190, Test loss: 2.261, Test accuracy: 51.94
Round  77, Global train loss: 0.190, Global test loss: 2.039, Global test accuracy: 56.40
Round  78, Train loss: 0.122, Test loss: 2.290, Test accuracy: 52.64
Round  78, Global train loss: 0.122, Global test loss: 2.258, Global test accuracy: 55.60
Round  79, Train loss: 0.235, Test loss: 2.321, Test accuracy: 52.90
Round  79, Global train loss: 0.235, Global test loss: 1.748, Global test accuracy: 58.00
Round  80, Train loss: 0.192, Test loss: 2.319, Test accuracy: 53.04
Round  80, Global train loss: 0.192, Global test loss: 1.798, Global test accuracy: 57.00
Round  81, Train loss: 0.133, Test loss: 2.307, Test accuracy: 53.22
Round  81, Global train loss: 0.133, Global test loss: 1.939, Global test accuracy: 58.00
Round  82, Train loss: 0.174, Test loss: 2.368, Test accuracy: 52.72
Round  82, Global train loss: 0.174, Global test loss: 2.162, Global test accuracy: 55.00
Round  83, Train loss: 0.262, Test loss: 2.319, Test accuracy: 53.80
Round  83, Global train loss: 0.262, Global test loss: 1.614, Global test accuracy: 58.80
Round  84, Train loss: 0.242, Test loss: 2.312, Test accuracy: 53.70
Round  84, Global train loss: 0.242, Global test loss: 1.444, Global test accuracy: 62.20
Round  85, Train loss: 0.132, Test loss: 2.231, Test accuracy: 53.94
Round  85, Global train loss: 0.132, Global test loss: 1.915, Global test accuracy: 57.60
Round  86, Train loss: 0.197, Test loss: 2.252, Test accuracy: 54.06
Round  86, Global train loss: 0.197, Global test loss: 1.576, Global test accuracy: 61.00
Round  87, Train loss: 0.272, Test loss: 2.262, Test accuracy: 54.58
Round  87, Global train loss: 0.272, Global test loss: 1.486, Global test accuracy: 58.40
Round  88, Train loss: 0.187, Test loss: 2.267, Test accuracy: 54.40
Round  88, Global train loss: 0.187, Global test loss: 1.580, Global test accuracy: 62.40
Round  89, Train loss: 0.185, Test loss: 2.286, Test accuracy: 54.82
Round  89, Global train loss: 0.185, Global test loss: 1.643, Global test accuracy: 60.20
Round  90, Train loss: 0.164, Test loss: 2.293, Test accuracy: 54.66
Round  90, Global train loss: 0.164, Global test loss: 1.799, Global test accuracy: 56.40
Round  91, Train loss: 0.149, Test loss: 2.293, Test accuracy: 54.60
Round  91, Global train loss: 0.149, Global test loss: 1.849, Global test accuracy: 58.00
Round  92, Train loss: 0.240, Test loss: 2.338, Test accuracy: 55.08
Round  92, Global train loss: 0.240, Global test loss: 2.124, Global test accuracy: 50.20
Round  93, Train loss: 0.172, Test loss: 2.388, Test accuracy: 55.58
Round  93, Global train loss: 0.172, Global test loss: 1.789, Global test accuracy: 59.40
Round  94, Train loss: 0.123, Test loss: 2.424, Test accuracy: 55.48
Round  94, Global train loss: 0.123, Global test loss: 1.935, Global test accuracy: 61.40
Round  95, Train loss: 0.167, Test loss: 2.487, Test accuracy: 54.42
Round  95, Global train loss: 0.167, Global test loss: 1.938, Global test accuracy: 57.80
Round  96, Train loss: 0.137, Test loss: 2.404, Test accuracy: 54.88
Round  96, Global train loss: 0.137, Global test loss: 1.799, Global test accuracy: 61.00
Round  97, Train loss: 0.109, Test loss: 2.348, Test accuracy: 55.06
Round  97, Global train loss: 0.109, Global test loss: 1.891, Global test accuracy: 58.80
Round  98, Train loss: 0.162, Test loss: 2.313, Test accuracy: 55.32
Round  98, Global train loss: 0.162, Global test loss: 2.233, Global test accuracy: 54.40
Round  99, Train loss: 0.176, Test loss: 2.348, Test accuracy: 54.62
Round  99, Global train loss: 0.176, Global test loss: 1.924, Global test accuracy: 57.00
Final Round, Train loss: 0.125, Test loss: 2.522, Test accuracy: 55.70
Final Round, Global train loss: 0.125, Global test loss: 1.924, Global test accuracy: 57.00
Average accuracy final 10 rounds: 54.97
Average global accuracy final 10 rounds: 57.440000000000005
1241.9736363887787
[3.3829822540283203, 6.314723014831543, 9.189462423324585, 12.106167554855347, 15.107218980789185, 18.059479236602783, 21.0470871925354, 24.026085138320923, 27.069156885147095, 30.275834321975708, 33.50321054458618, 36.60943412780762, 39.62709331512451, 42.626015186309814, 45.56761980056763, 48.52169370651245, 51.59675312042236, 54.55237698554993, 57.58266496658325, 60.567866802215576, 63.57915687561035, 66.51403665542603, 69.49679470062256, 72.42618417739868, 75.37774682044983, 78.39416766166687, 81.36597323417664, 84.3524820804596, 87.3232524394989, 90.36773443222046, 93.35905361175537, 96.35389590263367, 99.43011546134949, 102.46522378921509, 105.42127346992493, 108.4007420539856, 111.43378591537476, 114.38050055503845, 117.39764332771301, 120.3792040348053, 123.33827471733093, 126.29901766777039, 129.31600284576416, 132.26767706871033, 135.14603662490845, 138.06358647346497, 141.04231309890747, 143.99277663230896, 147.1435351371765, 150.17972421646118, 153.287677526474, 156.2553586959839, 159.44134664535522, 162.596027135849, 165.63963174819946, 168.78154373168945, 171.9105794429779, 175.0573410987854, 178.10761618614197, 181.1945207118988, 184.35256552696228, 187.42977857589722, 190.5781991481781, 193.66921401023865, 196.75948119163513, 199.861878156662, 202.91654896736145, 205.994149684906, 209.02701425552368, 212.17404007911682, 215.12252807617188, 218.12742257118225, 221.2043285369873, 224.19961047172546, 227.27826499938965, 230.3855423927307, 233.43653178215027, 236.43052554130554, 239.51242876052856, 242.54027009010315, 245.49730277061462, 248.48528051376343, 251.49090194702148, 254.5125696659088, 257.5632481575012, 260.7226951122284, 263.8676233291626, 266.86896109580994, 269.79679918289185, 272.70249009132385, 275.6450226306915, 278.70220923423767, 281.8396818637848, 284.9273681640625, 287.91937923431396, 291.03099822998047, 294.24346375465393, 297.4258460998535, 300.4343636035919, 303.37079548835754, 308.71643114089966]
[28.66, 34.12, 38.22, 42.42, 47.3, 47.96, 53.62, 55.32, 58.18, 58.94, 59.68, 58.16, 58.24, 58.04, 58.4, 57.8, 59.12, 59.28, 57.86, 57.26, 56.8, 57.86, 56.68, 57.58, 56.88, 56.34, 54.98, 56.1, 55.0, 54.52, 54.42, 54.68, 55.76, 56.1, 54.84, 55.68, 55.38, 55.4, 55.68, 55.42, 54.04, 54.62, 53.52, 54.12, 54.32, 55.0, 54.2, 54.78, 54.6, 54.52, 54.86, 54.74, 54.18, 54.2, 54.08, 54.42, 54.32, 55.22, 55.02, 55.34, 54.18, 53.96, 53.02, 53.12, 52.82, 53.12, 53.86, 54.18, 54.94, 54.0, 53.08, 53.2, 53.28, 52.68, 52.76, 52.2, 52.32, 51.94, 52.64, 52.9, 53.04, 53.22, 52.72, 53.8, 53.7, 53.94, 54.06, 54.58, 54.4, 54.82, 54.66, 54.6, 55.08, 55.58, 55.48, 54.42, 54.88, 55.06, 55.32, 54.62, 55.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.578, Test loss: 1.524, Test accuracy: 41.38
Round   0, Global train loss: 1.578, Global test loss: 1.522, Global test accuracy: 42.80
Round   1, Train loss: 1.522, Test loss: 1.475, Test accuracy: 40.70
Round   1, Global train loss: 1.522, Global test loss: 1.467, Global test accuracy: 40.80
Round   2, Train loss: 1.479, Test loss: 1.352, Test accuracy: 45.48
Round   2, Global train loss: 1.479, Global test loss: 1.319, Global test accuracy: 47.40
Round   3, Train loss: 1.438, Test loss: 1.334, Test accuracy: 45.92
Round   3, Global train loss: 1.438, Global test loss: 1.304, Global test accuracy: 45.80
Round   4, Train loss: 1.424, Test loss: 1.336, Test accuracy: 45.78
Round   4, Global train loss: 1.424, Global test loss: 1.352, Global test accuracy: 45.00
Round   5, Train loss: 1.461, Test loss: 1.334, Test accuracy: 47.36
Round   5, Global train loss: 1.461, Global test loss: 1.331, Global test accuracy: 46.60
Round   6, Train loss: 1.455, Test loss: 1.316, Test accuracy: 46.60
Round   6, Global train loss: 1.455, Global test loss: 1.306, Global test accuracy: 46.00
Round   7, Train loss: 1.365, Test loss: 1.244, Test accuracy: 48.98
Round   7, Global train loss: 1.365, Global test loss: 1.177, Global test accuracy: 47.80
Round   8, Train loss: 1.416, Test loss: 1.271, Test accuracy: 48.34
Round   8, Global train loss: 1.416, Global test loss: 1.262, Global test accuracy: 47.00
Round   9, Train loss: 1.347, Test loss: 1.226, Test accuracy: 50.36
Round   9, Global train loss: 1.347, Global test loss: 1.176, Global test accuracy: 50.00
Round  10, Train loss: 1.290, Test loss: 1.156, Test accuracy: 52.60
Round  10, Global train loss: 1.290, Global test loss: 1.087, Global test accuracy: 53.20
Round  11, Train loss: 1.382, Test loss: 1.230, Test accuracy: 49.42
Round  11, Global train loss: 1.382, Global test loss: 1.230, Global test accuracy: 48.80
Round  12, Train loss: 1.297, Test loss: 1.164, Test accuracy: 51.08
Round  12, Global train loss: 1.297, Global test loss: 1.070, Global test accuracy: 53.40
Round  13, Train loss: 1.264, Test loss: 1.169, Test accuracy: 53.48
Round  13, Global train loss: 1.264, Global test loss: 1.079, Global test accuracy: 55.60
Round  14, Train loss: 1.215, Test loss: 1.115, Test accuracy: 57.06
Round  14, Global train loss: 1.215, Global test loss: 0.960, Global test accuracy: 64.80
Round  15, Train loss: 1.302, Test loss: 1.173, Test accuracy: 53.98
Round  15, Global train loss: 1.302, Global test loss: 1.180, Global test accuracy: 51.60
Round  16, Train loss: 1.299, Test loss: 1.122, Test accuracy: 55.76
Round  16, Global train loss: 1.299, Global test loss: 1.097, Global test accuracy: 53.40
Round  17, Train loss: 1.309, Test loss: 1.206, Test accuracy: 54.02
Round  17, Global train loss: 1.309, Global test loss: 1.190, Global test accuracy: 51.60
Round  18, Train loss: 1.361, Test loss: 1.153, Test accuracy: 55.38
Round  18, Global train loss: 1.361, Global test loss: 1.165, Global test accuracy: 53.60
Round  19, Train loss: 1.136, Test loss: 1.097, Test accuracy: 57.50
Round  19, Global train loss: 1.136, Global test loss: 0.952, Global test accuracy: 62.20
Round  20, Train loss: 1.252, Test loss: 1.111, Test accuracy: 59.12
Round  20, Global train loss: 1.252, Global test loss: 1.095, Global test accuracy: 56.80
Round  21, Train loss: 1.261, Test loss: 1.126, Test accuracy: 58.54
Round  21, Global train loss: 1.261, Global test loss: 1.126, Global test accuracy: 55.60
Round  22, Train loss: 1.261, Test loss: 1.154, Test accuracy: 56.68
Round  22, Global train loss: 1.261, Global test loss: 1.162, Global test accuracy: 54.00
Round  23, Train loss: 1.204, Test loss: 1.136, Test accuracy: 59.44
Round  23, Global train loss: 1.204, Global test loss: 1.047, Global test accuracy: 60.60
Round  24, Train loss: 1.337, Test loss: 1.151, Test accuracy: 58.42
Round  24, Global train loss: 1.337, Global test loss: 1.164, Global test accuracy: 61.00
Round  25, Train loss: 1.168, Test loss: 1.083, Test accuracy: 59.84
Round  25, Global train loss: 1.168, Global test loss: 0.983, Global test accuracy: 63.80
Round  26, Train loss: 1.209, Test loss: 1.091, Test accuracy: 58.16
Round  26, Global train loss: 1.209, Global test loss: 1.003, Global test accuracy: 59.60
Round  27, Train loss: 1.137, Test loss: 1.091, Test accuracy: 59.44
Round  27, Global train loss: 1.137, Global test loss: 0.981, Global test accuracy: 60.80
Round  28, Train loss: 1.178, Test loss: 1.081, Test accuracy: 58.14
Round  28, Global train loss: 1.178, Global test loss: 0.982, Global test accuracy: 60.40
Round  29, Train loss: 1.163, Test loss: 1.039, Test accuracy: 60.94
Round  29, Global train loss: 1.163, Global test loss: 0.908, Global test accuracy: 69.40
Round  30, Train loss: 1.045, Test loss: 0.996, Test accuracy: 62.24
Round  30, Global train loss: 1.045, Global test loss: 0.863, Global test accuracy: 67.20
Round  31, Train loss: 1.124, Test loss: 1.022, Test accuracy: 61.86
Round  31, Global train loss: 1.124, Global test loss: 0.900, Global test accuracy: 67.40
Round  32, Train loss: 1.142, Test loss: 1.045, Test accuracy: 60.22
Round  32, Global train loss: 1.142, Global test loss: 0.931, Global test accuracy: 65.00
Round  33, Train loss: 1.116, Test loss: 1.000, Test accuracy: 62.10
Round  33, Global train loss: 1.116, Global test loss: 0.853, Global test accuracy: 69.00
Round  34, Train loss: 1.282, Test loss: 1.080, Test accuracy: 58.94
Round  34, Global train loss: 1.282, Global test loss: 1.080, Global test accuracy: 61.80
Round  35, Train loss: 1.214, Test loss: 1.086, Test accuracy: 58.54
Round  35, Global train loss: 1.214, Global test loss: 1.020, Global test accuracy: 64.80
Round  36, Train loss: 0.970, Test loss: 1.025, Test accuracy: 61.22
Round  36, Global train loss: 0.970, Global test loss: 0.869, Global test accuracy: 69.00
Round  37, Train loss: 1.126, Test loss: 1.072, Test accuracy: 61.80
Round  37, Global train loss: 1.126, Global test loss: 1.067, Global test accuracy: 61.20
Round  38, Train loss: 1.199, Test loss: 1.078, Test accuracy: 61.08
Round  38, Global train loss: 1.199, Global test loss: 1.041, Global test accuracy: 64.60
Round  39, Train loss: 1.066, Test loss: 1.054, Test accuracy: 60.18
Round  39, Global train loss: 1.066, Global test loss: 0.921, Global test accuracy: 63.20
Round  40, Train loss: 1.047, Test loss: 1.075, Test accuracy: 60.16
Round  40, Global train loss: 1.047, Global test loss: 0.963, Global test accuracy: 63.60
Round  41, Train loss: 1.110, Test loss: 1.107, Test accuracy: 58.98
Round  41, Global train loss: 1.110, Global test loss: 1.057, Global test accuracy: 61.20
Round  42, Train loss: 1.030, Test loss: 1.044, Test accuracy: 62.20
Round  42, Global train loss: 1.030, Global test loss: 0.942, Global test accuracy: 67.20
Round  43, Train loss: 0.994, Test loss: 1.035, Test accuracy: 62.14
Round  43, Global train loss: 0.994, Global test loss: 0.995, Global test accuracy: 62.80
Round  44, Train loss: 1.032, Test loss: 1.199, Test accuracy: 56.54
Round  44, Global train loss: 1.032, Global test loss: 1.202, Global test accuracy: 57.80
Round  45, Train loss: 1.078, Test loss: 1.184, Test accuracy: 56.28
Round  45, Global train loss: 1.078, Global test loss: 1.153, Global test accuracy: 56.60
Round  46, Train loss: 0.936, Test loss: 1.060, Test accuracy: 60.42
Round  46, Global train loss: 0.936, Global test loss: 1.020, Global test accuracy: 61.80
Round  47, Train loss: 0.959, Test loss: 1.049, Test accuracy: 60.46
Round  47, Global train loss: 0.959, Global test loss: 0.977, Global test accuracy: 60.40
Round  48, Train loss: 0.956, Test loss: 1.247, Test accuracy: 54.70
Round  48, Global train loss: 0.956, Global test loss: 1.285, Global test accuracy: 53.40
Round  49, Train loss: 0.858, Test loss: 1.130, Test accuracy: 58.72
Round  49, Global train loss: 0.858, Global test loss: 1.054, Global test accuracy: 60.80
Round  50, Train loss: 0.826, Test loss: 1.072, Test accuracy: 60.62
Round  50, Global train loss: 0.826, Global test loss: 1.003, Global test accuracy: 62.00
Round  51, Train loss: 0.891, Test loss: 1.369, Test accuracy: 52.84
Round  51, Global train loss: 0.891, Global test loss: 1.434, Global test accuracy: 51.60
Round  52, Train loss: 0.815, Test loss: 1.127, Test accuracy: 58.36
Round  52, Global train loss: 0.815, Global test loss: 1.075, Global test accuracy: 59.60
Round  53, Train loss: 0.901, Test loss: 1.089, Test accuracy: 60.48
Round  53, Global train loss: 0.901, Global test loss: 0.934, Global test accuracy: 65.00
Round  54, Train loss: 0.829, Test loss: 1.136, Test accuracy: 59.16
Round  54, Global train loss: 0.829, Global test loss: 1.023, Global test accuracy: 61.60
Round  55, Train loss: 0.905, Test loss: 1.176, Test accuracy: 57.72
Round  55, Global train loss: 0.905, Global test loss: 1.085, Global test accuracy: 60.00
Round  56, Train loss: 0.831, Test loss: 1.212, Test accuracy: 56.98
Round  56, Global train loss: 0.831, Global test loss: 1.158, Global test accuracy: 58.80
Round  57, Train loss: 0.783, Test loss: 1.107, Test accuracy: 59.44
Round  57, Global train loss: 0.783, Global test loss: 0.993, Global test accuracy: 63.80
Round  58, Train loss: 0.782, Test loss: 1.022, Test accuracy: 62.36
Round  58, Global train loss: 0.782, Global test loss: 0.936, Global test accuracy: 65.20
Round  59, Train loss: 0.758, Test loss: 1.108, Test accuracy: 59.96
Round  59, Global train loss: 0.758, Global test loss: 1.040, Global test accuracy: 61.60
Round  60, Train loss: 0.818, Test loss: 1.307, Test accuracy: 55.18
Round  60, Global train loss: 0.818, Global test loss: 1.297, Global test accuracy: 55.40
Round  61, Train loss: 0.694, Test loss: 1.128, Test accuracy: 60.82
Round  61, Global train loss: 0.694, Global test loss: 1.065, Global test accuracy: 62.60
Round  62, Train loss: 0.774, Test loss: 1.185, Test accuracy: 59.04
Round  62, Global train loss: 0.774, Global test loss: 1.067, Global test accuracy: 61.60
Round  63, Train loss: 0.733, Test loss: 1.313, Test accuracy: 54.84
Round  63, Global train loss: 0.733, Global test loss: 1.330, Global test accuracy: 54.00
Round  64, Train loss: 0.678, Test loss: 1.354, Test accuracy: 53.12
Round  64, Global train loss: 0.678, Global test loss: 1.394, Global test accuracy: 51.60
Round  65, Train loss: 0.792, Test loss: 1.395, Test accuracy: 51.74
Round  65, Global train loss: 0.792, Global test loss: 1.319, Global test accuracy: 51.80
Round  66, Train loss: 0.687, Test loss: 1.190, Test accuracy: 58.86
Round  66, Global train loss: 0.687, Global test loss: 1.107, Global test accuracy: 59.80
Round  67, Train loss: 0.711, Test loss: 1.352, Test accuracy: 53.10
Round  67, Global train loss: 0.711, Global test loss: 1.303, Global test accuracy: 51.20
Round  68, Train loss: 0.664, Test loss: 1.413, Test accuracy: 51.14
Round  68, Global train loss: 0.664, Global test loss: 1.468, Global test accuracy: 49.60
Round  69, Train loss: 0.587, Test loss: 1.195, Test accuracy: 59.48
Round  69, Global train loss: 0.587, Global test loss: 1.144, Global test accuracy: 61.80
Round  70, Train loss: 0.565, Test loss: 1.313, Test accuracy: 57.06
Round  70, Global train loss: 0.565, Global test loss: 1.223, Global test accuracy: 58.80
Round  71, Train loss: 0.589, Test loss: 1.213, Test accuracy: 59.02
Round  71, Global train loss: 0.589, Global test loss: 1.090, Global test accuracy: 60.80
Round  72, Train loss: 0.462, Test loss: 1.236, Test accuracy: 58.70
Round  72, Global train loss: 0.462, Global test loss: 1.260, Global test accuracy: 59.00
Round  73, Train loss: 0.629, Test loss: 1.074, Test accuracy: 61.98
Round  73, Global train loss: 0.629, Global test loss: 0.907, Global test accuracy: 65.80
Round  74, Train loss: 0.613, Test loss: 1.402, Test accuracy: 55.08
Round  74, Global train loss: 0.613, Global test loss: 1.362, Global test accuracy: 56.40
Round  75, Train loss: 0.517, Test loss: 1.313, Test accuracy: 56.72
Round  75, Global train loss: 0.517, Global test loss: 1.215, Global test accuracy: 59.40
Round  76, Train loss: 0.548, Test loss: 1.445, Test accuracy: 52.26
Round  76, Global train loss: 0.548, Global test loss: 1.451, Global test accuracy: 51.60
Round  77, Train loss: 0.611, Test loss: 1.540, Test accuracy: 51.66
Round  77, Global train loss: 0.611, Global test loss: 1.439, Global test accuracy: 52.20
Round  78, Train loss: 0.452, Test loss: 1.639, Test accuracy: 49.24
Round  78, Global train loss: 0.452, Global test loss: 1.759, Global test accuracy: 49.00
Round  79, Train loss: 0.511, Test loss: 1.379, Test accuracy: 56.46
Round  79, Global train loss: 0.511, Global test loss: 1.261, Global test accuracy: 59.00
Round  80, Train loss: 0.444, Test loss: 1.484, Test accuracy: 55.56
Round  80, Global train loss: 0.444, Global test loss: 1.601, Global test accuracy: 53.00
Round  81, Train loss: 0.499, Test loss: 1.569, Test accuracy: 52.90
Round  81, Global train loss: 0.499, Global test loss: 1.579, Global test accuracy: 53.20
Round  82, Train loss: 0.384, Test loss: 1.429, Test accuracy: 55.12
Round  82, Global train loss: 0.384, Global test loss: 1.434, Global test accuracy: 57.20
Round  83, Train loss: 0.511, Test loss: 1.390, Test accuracy: 56.86
Round  83, Global train loss: 0.511, Global test loss: 1.246, Global test accuracy: 57.40
Round  84, Train loss: 0.499, Test loss: 1.302, Test accuracy: 59.80
Round  84, Global train loss: 0.499, Global test loss: 1.164, Global test accuracy: 61.20
Round  85, Train loss: 0.457, Test loss: 1.558, Test accuracy: 53.92
Round  85, Global train loss: 0.457, Global test loss: 1.603, Global test accuracy: 53.20
Round  86, Train loss: 0.494, Test loss: 1.354, Test accuracy: 58.82
Round  86, Global train loss: 0.494, Global test loss: 1.119, Global test accuracy: 63.20
Round  87, Train loss: 0.449, Test loss: 1.353, Test accuracy: 59.44
Round  87, Global train loss: 0.449, Global test loss: 1.169, Global test accuracy: 61.40
Round  88, Train loss: 0.472, Test loss: 1.412, Test accuracy: 58.96
Round  88, Global train loss: 0.472, Global test loss: 1.235, Global test accuracy: 60.40
Round  89, Train loss: 0.467, Test loss: 1.329, Test accuracy: 61.22
Round  89, Global train loss: 0.467, Global test loss: 1.079, Global test accuracy: 65.80
Round  90, Train loss: 0.391, Test loss: 1.424, Test accuracy: 57.84
Round  90, Global train loss: 0.391, Global test loss: 1.379, Global test accuracy: 60.80
Round  91, Train loss: 0.335, Test loss: 1.454, Test accuracy: 55.76
Round  91, Global train loss: 0.335, Global test loss: 1.424, Global test accuracy: 55.20
Round  92, Train loss: 0.406, Test loss: 1.364, Test accuracy: 60.30
Round  92, Global train loss: 0.406, Global test loss: 1.296, Global test accuracy: 61.20
Round  93, Train loss: 0.463, Test loss: 1.398, Test accuracy: 58.08
Round  93, Global train loss: 0.463, Global test loss: 1.165, Global test accuracy: 62.40
Round  94, Train loss: 0.390, Test loss: 1.466, Test accuracy: 58.34
Round  94, Global train loss: 0.390, Global test loss: 1.399, Global test accuracy: 59.00
Round  95, Train loss: 0.292, Test loss: 1.458, Test accuracy: 57.46
Round  95, Global train loss: 0.292, Global test loss: 1.370, Global test accuracy: 59.40
Round  96, Train loss: 0.261, Test loss: 1.419, Test accuracy: 59.08
Round  96, Global train loss: 0.261, Global test loss: 1.342, Global test accuracy: 61.40
Round  97, Train loss: 0.362, Test loss: 1.740, Test accuracy: 53.50
Round  97, Global train loss: 0.362, Global test loss: 1.734, Global test accuracy: 51.20
Round  98, Train loss: 0.314, Test loss: 1.712, Test accuracy: 52.70
Round  98, Global train loss: 0.314, Global test loss: 1.846, Global test accuracy: 52.00
Round  99, Train loss: 0.408, Test loss: 1.441, Test accuracy: 57.70
Round  99, Global train loss: 0.408, Global test loss: 1.308, Global test accuracy: 59.00
Final Round, Train loss: 0.297, Test loss: 1.499, Test accuracy: 57.98
Final Round, Global train loss: 0.297, Global test loss: 1.308, Global test accuracy: 59.00
Average accuracy final 10 rounds: 57.07600000000001
731.5057773590088
[1.709322214126587, 3.1220428943634033, 4.544975996017456, 5.946950912475586, 7.350531816482544, 8.722888231277466, 10.107160568237305, 11.507091522216797, 12.876514911651611, 14.284359693527222, 15.664798974990845, 17.091662883758545, 18.489137887954712, 19.869322299957275, 21.247520208358765, 22.651313543319702, 24.017770528793335, 25.416204929351807, 26.79906463623047, 28.24048638343811, 29.67341709136963, 31.08418321609497, 32.46738290786743, 33.940290689468384, 35.36939883232117, 36.82492780685425, 38.20315098762512, 39.58244180679321, 40.9719660282135, 42.37606596946716, 43.76293468475342, 45.19391465187073, 46.563812255859375, 47.980656147003174, 49.38340616226196, 50.76909327507019, 52.14216208457947, 53.527695655822754, 54.89790630340576, 56.26555848121643, 57.64092254638672, 59.02971792221069, 60.38413715362549, 61.77822756767273, 63.17290115356445, 64.55042672157288, 65.93933463096619, 67.31893706321716, 68.71207880973816, 70.09428906440735, 71.50439786911011, 72.87642335891724, 74.39169692993164, 75.7676477432251, 77.19232964515686, 78.6344211101532, 80.0049500465393, 81.37535667419434, 82.78238224983215, 84.22515153884888, 85.7016236782074, 87.10779166221619, 88.48719787597656, 89.8498854637146, 91.2594563961029, 92.64556813240051, 94.02413082122803, 95.41299080848694, 96.76322865486145, 98.14725375175476, 99.5360062122345, 100.89832711219788, 102.30552959442139, 103.70802593231201, 105.10052132606506, 106.50321292877197, 107.88430166244507, 109.31586956977844, 110.7148072719574, 112.0854218006134, 113.46054029464722, 114.82927536964417, 116.20922899246216, 117.67232489585876, 119.0802149772644, 120.52909255027771, 121.98749685287476, 123.47322154045105, 124.84900164604187, 126.24297642707825, 127.61773538589478, 128.99605536460876, 130.40847158432007, 131.86356377601624, 133.3304626941681, 134.75476622581482, 136.14842081069946, 137.53848433494568, 138.92601561546326, 140.28851771354675, 142.52186274528503]
[41.38, 40.7, 45.48, 45.92, 45.78, 47.36, 46.6, 48.98, 48.34, 50.36, 52.6, 49.42, 51.08, 53.48, 57.06, 53.98, 55.76, 54.02, 55.38, 57.5, 59.12, 58.54, 56.68, 59.44, 58.42, 59.84, 58.16, 59.44, 58.14, 60.94, 62.24, 61.86, 60.22, 62.1, 58.94, 58.54, 61.22, 61.8, 61.08, 60.18, 60.16, 58.98, 62.2, 62.14, 56.54, 56.28, 60.42, 60.46, 54.7, 58.72, 60.62, 52.84, 58.36, 60.48, 59.16, 57.72, 56.98, 59.44, 62.36, 59.96, 55.18, 60.82, 59.04, 54.84, 53.12, 51.74, 58.86, 53.1, 51.14, 59.48, 57.06, 59.02, 58.7, 61.98, 55.08, 56.72, 52.26, 51.66, 49.24, 56.46, 55.56, 52.9, 55.12, 56.86, 59.8, 53.92, 58.82, 59.44, 58.96, 61.22, 57.84, 55.76, 60.3, 58.08, 58.34, 57.46, 59.08, 53.5, 52.7, 57.7, 57.98]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.610, Test loss: 1.539, Test accuracy: 37.28
Round   0, Global train loss: 1.610, Global test loss: 1.536, Global test accuracy: 40.20
Round   1, Train loss: 1.529, Test loss: 1.385, Test accuracy: 44.24
Round   1, Global train loss: 1.529, Global test loss: 1.371, Global test accuracy: 43.80
Round   2, Train loss: 1.470, Test loss: 1.299, Test accuracy: 46.76
Round   2, Global train loss: 1.470, Global test loss: 1.278, Global test accuracy: 45.40
Round   3, Train loss: 1.440, Test loss: 1.251, Test accuracy: 50.34
Round   3, Global train loss: 1.440, Global test loss: 1.227, Global test accuracy: 53.40
Round   4, Train loss: 1.421, Test loss: 1.208, Test accuracy: 53.30
Round   4, Global train loss: 1.421, Global test loss: 1.182, Global test accuracy: 58.60
Round   5, Train loss: 1.397, Test loss: 1.174, Test accuracy: 55.40
Round   5, Global train loss: 1.397, Global test loss: 1.143, Global test accuracy: 62.60
Round   6, Train loss: 1.373, Test loss: 1.137, Test accuracy: 58.02
Round   6, Global train loss: 1.373, Global test loss: 1.106, Global test accuracy: 63.60
Round   7, Train loss: 1.350, Test loss: 1.100, Test accuracy: 60.64
Round   7, Global train loss: 1.350, Global test loss: 1.062, Global test accuracy: 66.60
Round   8, Train loss: 1.332, Test loss: 1.073, Test accuracy: 60.60
Round   8, Global train loss: 1.332, Global test loss: 1.031, Global test accuracy: 66.40
Round   9, Train loss: 1.316, Test loss: 1.026, Test accuracy: 63.06
Round   9, Global train loss: 1.316, Global test loss: 0.974, Global test accuracy: 69.60
Round  10, Train loss: 1.318, Test loss: 1.036, Test accuracy: 63.06
Round  10, Global train loss: 1.318, Global test loss: 1.011, Global test accuracy: 66.80
Round  11, Train loss: 1.335, Test loss: 1.060, Test accuracy: 62.00
Round  11, Global train loss: 1.335, Global test loss: 1.079, Global test accuracy: 66.00
Round  12, Train loss: 1.225, Test loss: 1.058, Test accuracy: 61.40
Round  12, Global train loss: 1.225, Global test loss: 1.020, Global test accuracy: 65.20
Round  13, Train loss: 1.137, Test loss: 1.011, Test accuracy: 62.38
Round  13, Global train loss: 1.137, Global test loss: 0.940, Global test accuracy: 65.20
Round  14, Train loss: 1.219, Test loss: 1.074, Test accuracy: 62.32
Round  14, Global train loss: 1.219, Global test loss: 1.020, Global test accuracy: 69.60
Round  15, Train loss: 1.214, Test loss: 1.025, Test accuracy: 62.84
Round  15, Global train loss: 1.214, Global test loss: 0.930, Global test accuracy: 64.60
Round  16, Train loss: 1.114, Test loss: 1.036, Test accuracy: 63.84
Round  16, Global train loss: 1.114, Global test loss: 0.916, Global test accuracy: 68.20
Round  17, Train loss: 1.128, Test loss: 0.997, Test accuracy: 64.12
Round  17, Global train loss: 1.128, Global test loss: 0.914, Global test accuracy: 66.40
Round  18, Train loss: 1.179, Test loss: 1.030, Test accuracy: 63.18
Round  18, Global train loss: 1.179, Global test loss: 1.001, Global test accuracy: 66.00
Round  19, Train loss: 1.117, Test loss: 0.993, Test accuracy: 65.60
Round  19, Global train loss: 1.117, Global test loss: 0.892, Global test accuracy: 69.40
Round  20, Train loss: 1.103, Test loss: 1.018, Test accuracy: 64.34
Round  20, Global train loss: 1.103, Global test loss: 0.905, Global test accuracy: 66.60
Round  21, Train loss: 1.065, Test loss: 0.954, Test accuracy: 65.78
Round  21, Global train loss: 1.065, Global test loss: 0.831, Global test accuracy: 67.80
Round  22, Train loss: 1.002, Test loss: 0.932, Test accuracy: 67.12
Round  22, Global train loss: 1.002, Global test loss: 0.802, Global test accuracy: 67.60
Round  23, Train loss: 1.160, Test loss: 0.997, Test accuracy: 63.62
Round  23, Global train loss: 1.160, Global test loss: 0.971, Global test accuracy: 65.80
Round  24, Train loss: 1.097, Test loss: 0.974, Test accuracy: 64.54
Round  24, Global train loss: 1.097, Global test loss: 0.902, Global test accuracy: 68.60
Round  25, Train loss: 1.018, Test loss: 0.966, Test accuracy: 66.36
Round  25, Global train loss: 1.018, Global test loss: 0.880, Global test accuracy: 69.20
Round  26, Train loss: 1.045, Test loss: 0.961, Test accuracy: 64.88
Round  26, Global train loss: 1.045, Global test loss: 0.889, Global test accuracy: 67.80
Round  27, Train loss: 0.946, Test loss: 0.963, Test accuracy: 65.90
Round  27, Global train loss: 0.946, Global test loss: 0.865, Global test accuracy: 69.00
Round  28, Train loss: 1.012, Test loss: 0.972, Test accuracy: 64.80
Round  28, Global train loss: 1.012, Global test loss: 0.885, Global test accuracy: 68.80
Round  29, Train loss: 1.147, Test loss: 1.042, Test accuracy: 61.34
Round  29, Global train loss: 1.147, Global test loss: 1.021, Global test accuracy: 65.20
Round  30, Train loss: 1.107, Test loss: 0.973, Test accuracy: 65.00
Round  30, Global train loss: 1.107, Global test loss: 0.906, Global test accuracy: 70.00
Round  31, Train loss: 1.135, Test loss: 1.031, Test accuracy: 63.72
Round  31, Global train loss: 1.135, Global test loss: 0.996, Global test accuracy: 64.60
Round  32, Train loss: 1.062, Test loss: 1.052, Test accuracy: 61.40
Round  32, Global train loss: 1.062, Global test loss: 1.005, Global test accuracy: 63.20
Round  33, Train loss: 1.108, Test loss: 1.038, Test accuracy: 63.72
Round  33, Global train loss: 1.108, Global test loss: 1.019, Global test accuracy: 67.60
Round  34, Train loss: 0.972, Test loss: 0.929, Test accuracy: 67.12
Round  34, Global train loss: 0.972, Global test loss: 0.873, Global test accuracy: 67.00
Round  35, Train loss: 1.057, Test loss: 1.007, Test accuracy: 63.38
Round  35, Global train loss: 1.057, Global test loss: 0.961, Global test accuracy: 66.60
Round  36, Train loss: 0.943, Test loss: 0.941, Test accuracy: 67.00
Round  36, Global train loss: 0.943, Global test loss: 0.849, Global test accuracy: 69.80
Round  37, Train loss: 0.868, Test loss: 0.932, Test accuracy: 65.88
Round  37, Global train loss: 0.868, Global test loss: 0.839, Global test accuracy: 66.20
Round  38, Train loss: 1.028, Test loss: 0.952, Test accuracy: 65.44
Round  38, Global train loss: 1.028, Global test loss: 0.911, Global test accuracy: 66.20
Round  39, Train loss: 0.962, Test loss: 0.981, Test accuracy: 65.22
Round  39, Global train loss: 0.962, Global test loss: 0.948, Global test accuracy: 67.00
Round  40, Train loss: 0.887, Test loss: 0.916, Test accuracy: 66.80
Round  40, Global train loss: 0.887, Global test loss: 0.856, Global test accuracy: 68.20
Round  41, Train loss: 0.942, Test loss: 0.975, Test accuracy: 65.84
Round  41, Global train loss: 0.942, Global test loss: 0.914, Global test accuracy: 69.20
Round  42, Train loss: 0.867, Test loss: 0.935, Test accuracy: 67.12
Round  42, Global train loss: 0.867, Global test loss: 0.861, Global test accuracy: 68.20
Round  43, Train loss: 0.833, Test loss: 0.906, Test accuracy: 67.20
Round  43, Global train loss: 0.833, Global test loss: 0.819, Global test accuracy: 70.20
Round  44, Train loss: 0.819, Test loss: 0.966, Test accuracy: 65.40
Round  44, Global train loss: 0.819, Global test loss: 0.912, Global test accuracy: 66.00
Round  45, Train loss: 0.858, Test loss: 0.955, Test accuracy: 65.02
Round  45, Global train loss: 0.858, Global test loss: 0.933, Global test accuracy: 65.20
Round  46, Train loss: 0.725, Test loss: 0.885, Test accuracy: 67.54
Round  46, Global train loss: 0.725, Global test loss: 0.800, Global test accuracy: 69.00
Round  47, Train loss: 0.816, Test loss: 0.964, Test accuracy: 65.32
Round  47, Global train loss: 0.816, Global test loss: 0.895, Global test accuracy: 68.20
Round  48, Train loss: 0.735, Test loss: 0.962, Test accuracy: 65.26
Round  48, Global train loss: 0.735, Global test loss: 0.896, Global test accuracy: 66.40
Round  49, Train loss: 0.651, Test loss: 0.898, Test accuracy: 67.10
Round  49, Global train loss: 0.651, Global test loss: 0.812, Global test accuracy: 69.40
Round  50, Train loss: 0.603, Test loss: 0.891, Test accuracy: 67.26
Round  50, Global train loss: 0.603, Global test loss: 0.826, Global test accuracy: 69.20
Round  51, Train loss: 0.691, Test loss: 1.021, Test accuracy: 63.12
Round  51, Global train loss: 0.691, Global test loss: 0.971, Global test accuracy: 64.40
Round  52, Train loss: 0.724, Test loss: 0.925, Test accuracy: 66.72
Round  52, Global train loss: 0.724, Global test loss: 0.866, Global test accuracy: 67.20
Round  53, Train loss: 0.919, Test loss: 1.105, Test accuracy: 59.34
Round  53, Global train loss: 0.919, Global test loss: 1.057, Global test accuracy: 59.40
Round  54, Train loss: 0.707, Test loss: 0.974, Test accuracy: 65.22
Round  54, Global train loss: 0.707, Global test loss: 0.900, Global test accuracy: 67.00
Round  55, Train loss: 0.739, Test loss: 0.991, Test accuracy: 63.46
Round  55, Global train loss: 0.739, Global test loss: 0.919, Global test accuracy: 64.60
Round  56, Train loss: 0.774, Test loss: 1.099, Test accuracy: 59.46
Round  56, Global train loss: 0.774, Global test loss: 1.054, Global test accuracy: 61.20
Round  57, Train loss: 0.812, Test loss: 1.089, Test accuracy: 61.10
Round  57, Global train loss: 0.812, Global test loss: 1.045, Global test accuracy: 62.80
Round  58, Train loss: 0.670, Test loss: 0.972, Test accuracy: 65.52
Round  58, Global train loss: 0.670, Global test loss: 0.888, Global test accuracy: 67.80
Round  59, Train loss: 0.748, Test loss: 1.119, Test accuracy: 58.34
Round  59, Global train loss: 0.748, Global test loss: 1.047, Global test accuracy: 60.60
Round  60, Train loss: 0.671, Test loss: 1.045, Test accuracy: 62.90
Round  60, Global train loss: 0.671, Global test loss: 0.999, Global test accuracy: 63.20
Round  61, Train loss: 0.725, Test loss: 1.079, Test accuracy: 61.98
Round  61, Global train loss: 0.725, Global test loss: 1.013, Global test accuracy: 63.40
Round  62, Train loss: 0.665, Test loss: 1.066, Test accuracy: 61.92
Round  62, Global train loss: 0.665, Global test loss: 1.001, Global test accuracy: 64.60
Round  63, Train loss: 0.520, Test loss: 1.046, Test accuracy: 62.64
Round  63, Global train loss: 0.520, Global test loss: 1.045, Global test accuracy: 61.40
Round  64, Train loss: 0.599, Test loss: 1.057, Test accuracy: 63.06
Round  64, Global train loss: 0.599, Global test loss: 1.022, Global test accuracy: 64.20
Round  65, Train loss: 0.525, Test loss: 1.053, Test accuracy: 63.80
Round  65, Global train loss: 0.525, Global test loss: 1.088, Global test accuracy: 62.00
Round  66, Train loss: 0.565, Test loss: 1.074, Test accuracy: 63.22
Round  66, Global train loss: 0.565, Global test loss: 1.022, Global test accuracy: 64.60
Round  67, Train loss: 0.707, Test loss: 1.227, Test accuracy: 55.86
Round  67, Global train loss: 0.707, Global test loss: 1.165, Global test accuracy: 55.40
Round  68, Train loss: 0.398, Test loss: 1.040, Test accuracy: 64.22
Round  68, Global train loss: 0.398, Global test loss: 1.134, Global test accuracy: 62.40
Round  69, Train loss: 0.579, Test loss: 1.138, Test accuracy: 61.18
Round  69, Global train loss: 0.579, Global test loss: 1.028, Global test accuracy: 63.20
Round  70, Train loss: 0.523, Test loss: 1.185, Test accuracy: 59.92
Round  70, Global train loss: 0.523, Global test loss: 1.103, Global test accuracy: 61.20
Round  71, Train loss: 0.566, Test loss: 1.103, Test accuracy: 61.64
Round  71, Global train loss: 0.566, Global test loss: 1.026, Global test accuracy: 62.80
Round  72, Train loss: 0.425, Test loss: 1.146, Test accuracy: 62.16
Round  72, Global train loss: 0.425, Global test loss: 1.104, Global test accuracy: 63.20
Round  73, Train loss: 0.664, Test loss: 1.166, Test accuracy: 60.68
Round  73, Global train loss: 0.664, Global test loss: 1.037, Global test accuracy: 62.40
Round  74, Train loss: 0.606, Test loss: 1.307, Test accuracy: 57.14
Round  74, Global train loss: 0.606, Global test loss: 1.250, Global test accuracy: 57.80
Round  75, Train loss: 0.482, Test loss: 1.178, Test accuracy: 59.52
Round  75, Global train loss: 0.482, Global test loss: 1.136, Global test accuracy: 59.00
Round  76, Train loss: 0.466, Test loss: 1.157, Test accuracy: 62.54
Round  76, Global train loss: 0.466, Global test loss: 1.146, Global test accuracy: 64.00
Round  77, Train loss: 0.388, Test loss: 1.148, Test accuracy: 61.58
Round  77, Global train loss: 0.388, Global test loss: 1.199, Global test accuracy: 60.80
Round  78, Train loss: 0.301, Test loss: 1.218, Test accuracy: 61.00
Round  78, Global train loss: 0.301, Global test loss: 1.288, Global test accuracy: 60.40
Round  79, Train loss: 0.507, Test loss: 1.204, Test accuracy: 60.42
Round  79, Global train loss: 0.507, Global test loss: 1.110, Global test accuracy: 61.60
Round  80, Train loss: 0.317, Test loss: 1.156, Test accuracy: 62.72
Round  80, Global train loss: 0.317, Global test loss: 1.158, Global test accuracy: 63.60
Round  81, Train loss: 0.269, Test loss: 1.134, Test accuracy: 63.76
Round  81, Global train loss: 0.269, Global test loss: 1.139, Global test accuracy: 65.20
Round  82, Train loss: 0.258, Test loss: 1.168, Test accuracy: 64.04
Round  82, Global train loss: 0.258, Global test loss: 1.176, Global test accuracy: 65.40
Round  83, Train loss: 0.238, Test loss: 1.184, Test accuracy: 64.06
Round  83, Global train loss: 0.238, Global test loss: 1.209, Global test accuracy: 64.60
Round  84, Train loss: 0.238, Test loss: 1.174, Test accuracy: 64.66
Round  84, Global train loss: 0.238, Global test loss: 1.197, Global test accuracy: 65.60
Round  85, Train loss: 0.222, Test loss: 1.180, Test accuracy: 64.82
Round  85, Global train loss: 0.222, Global test loss: 1.205, Global test accuracy: 66.40
Round  86, Train loss: 0.210, Test loss: 1.186, Test accuracy: 64.28
Round  86, Global train loss: 0.210, Global test loss: 1.212, Global test accuracy: 65.60
Round  87, Train loss: 0.208, Test loss: 1.241, Test accuracy: 63.14
Round  87, Global train loss: 0.208, Global test loss: 1.296, Global test accuracy: 64.60
Round  88, Train loss: 0.200, Test loss: 1.252, Test accuracy: 62.78
Round  88, Global train loss: 0.200, Global test loss: 1.285, Global test accuracy: 63.00
Round  89, Train loss: 0.187, Test loss: 1.273, Test accuracy: 63.66
Round  89, Global train loss: 0.187, Global test loss: 1.343, Global test accuracy: 63.80
Round  90, Train loss: 0.180, Test loss: 1.221, Test accuracy: 64.10
Round  90, Global train loss: 0.180, Global test loss: 1.273, Global test accuracy: 64.20
Round  91, Train loss: 0.177, Test loss: 1.254, Test accuracy: 63.32
Round  91, Global train loss: 0.177, Global test loss: 1.317, Global test accuracy: 64.20
Round  92, Train loss: 0.174, Test loss: 1.291, Test accuracy: 63.34
Round  92, Global train loss: 0.174, Global test loss: 1.357, Global test accuracy: 65.40
Round  93, Train loss: 0.150, Test loss: 1.311, Test accuracy: 63.70
Round  93, Global train loss: 0.150, Global test loss: 1.394, Global test accuracy: 65.40
Round  94, Train loss: 0.142, Test loss: 1.325, Test accuracy: 63.90
Round  94, Global train loss: 0.142, Global test loss: 1.415, Global test accuracy: 65.60
Round  95, Train loss: 0.155, Test loss: 1.362, Test accuracy: 61.14
Round  95, Global train loss: 0.155, Global test loss: 1.451, Global test accuracy: 62.40
Round  96, Train loss: 0.141, Test loss: 1.311, Test accuracy: 63.28
Round  96, Global train loss: 0.141, Global test loss: 1.395, Global test accuracy: 64.00
Round  97, Train loss: 0.127, Test loss: 1.370, Test accuracy: 62.80
Round  97, Global train loss: 0.127, Global test loss: 1.469, Global test accuracy: 63.40
Round  98, Train loss: 0.141, Test loss: 1.387, Test accuracy: 62.10
Round  98, Global train loss: 0.141, Global test loss: 1.484, Global test accuracy: 64.00
Round  99, Train loss: 0.329, Test loss: 1.374, Test accuracy: 61.88
Round  99, Global train loss: 0.329, Global test loss: 1.277, Global test accuracy: 62.20
Final Round, Train loss: 0.282, Test loss: 1.406, Test accuracy: 61.68
Final Round, Global train loss: 0.282, Global test loss: 1.277, Global test accuracy: 62.20
Average accuracy final 10 rounds: 62.95600000000001
1800.4646606445312
[2.045853614807129, 3.6783864498138428, 5.352158308029175, 6.974850177764893, 8.621366739273071, 10.246542692184448, 11.867833375930786, 13.536194562911987, 15.186610698699951, 16.870187759399414, 22.443814992904663, 31.881942749023438, 41.124013900756836, 50.10936784744263, 59.49186849594116, 68.71868371963501, 78.12256145477295, 87.56560683250427, 96.98339056968689, 106.48600220680237, 115.97697401046753, 117.5922679901123, 119.30096530914307, 128.7685239315033, 137.9277892112732, 147.42110896110535, 156.62319111824036, 165.85557460784912, 175.22898769378662, 184.54254841804504, 194.2790150642395, 203.60740303993225, 212.92894577980042, 222.29995727539062, 231.60224270820618, 241.1189284324646, 250.8907015323639, 260.24847316741943, 269.56831526756287, 279.08696603775024, 288.4137828350067, 297.847852230072, 307.177885055542, 316.57167196273804, 325.72470474243164, 334.93655610084534, 336.5455906391144, 346.0474784374237, 355.13304567337036, 356.7794632911682, 358.4048607349396, 367.73749589920044, 377.10486102104187, 386.6023938655853, 395.81877541542053, 405.28188610076904, 414.6562340259552, 424.1492073535919, 433.654256105423, 443.0668454170227, 452.51130843162537, 461.88078236579895, 471.11357975006104, 472.7666425704956, 482.1326711177826, 491.38112473487854, 500.4460425376892, 509.9018666744232, 511.5298991203308, 520.9559504985809, 530.0200514793396, 539.6842265129089, 548.7700967788696, 558.9816772937775, 568.5321161746979, 577.8030428886414, 586.7445693016052, 595.831533908844, 597.5034518241882, 606.3857593536377, 607.9692912101746, 609.5688214302063, 611.1558363437653, 612.7913084030151, 614.4207720756531, 616.0186445713043, 617.5892605781555, 619.1801013946533, 620.7571170330048, 622.3484404087067, 623.9258241653442, 625.5097358226776, 627.2171919345856, 628.9010968208313, 630.5581755638123, 632.2265553474426, 633.8621094226837, 635.4444355964661, 637.053601026535, 646.0745732784271, 655.3656601905823]
[37.28, 44.24, 46.76, 50.34, 53.3, 55.4, 58.02, 60.64, 60.6, 63.06, 63.06, 62.0, 61.4, 62.38, 62.32, 62.84, 63.84, 64.12, 63.18, 65.6, 64.34, 65.78, 67.12, 63.62, 64.54, 66.36, 64.88, 65.9, 64.8, 61.34, 65.0, 63.72, 61.4, 63.72, 67.12, 63.38, 67.0, 65.88, 65.44, 65.22, 66.8, 65.84, 67.12, 67.2, 65.4, 65.02, 67.54, 65.32, 65.26, 67.1, 67.26, 63.12, 66.72, 59.34, 65.22, 63.46, 59.46, 61.1, 65.52, 58.34, 62.9, 61.98, 61.92, 62.64, 63.06, 63.8, 63.22, 55.86, 64.22, 61.18, 59.92, 61.64, 62.16, 60.68, 57.14, 59.52, 62.54, 61.58, 61.0, 60.42, 62.72, 63.76, 64.04, 64.06, 64.66, 64.82, 64.28, 63.14, 62.78, 63.66, 64.1, 63.32, 63.34, 63.7, 63.9, 61.14, 63.28, 62.8, 62.1, 61.88, 61.68]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.488, Test loss: 1.552, Test accuracy: 32.64
Round   0, Global train loss: 1.488, Global test loss: 1.541, Global test accuracy: 34.40
Round   1, Train loss: 1.450, Test loss: 1.537, Test accuracy: 35.56
Round   1, Global train loss: 1.450, Global test loss: 1.494, Global test accuracy: 39.20
Round   2, Train loss: 1.595, Test loss: 1.562, Test accuracy: 36.04
Round   2, Global train loss: 1.595, Global test loss: 1.534, Global test accuracy: 42.40
Round   3, Train loss: 1.354, Test loss: 1.515, Test accuracy: 37.38
Round   3, Global train loss: 1.354, Global test loss: 1.429, Global test accuracy: 44.60
Round   4, Train loss: 1.512, Test loss: 1.532, Test accuracy: 36.14
Round   4, Global train loss: 1.512, Global test loss: 1.539, Global test accuracy: 34.00
Round   5, Train loss: 1.511, Test loss: 1.525, Test accuracy: 36.78
Round   5, Global train loss: 1.511, Global test loss: 1.506, Global test accuracy: 41.40
Round   6, Train loss: 1.382, Test loss: 1.511, Test accuracy: 38.42
Round   6, Global train loss: 1.382, Global test loss: 1.463, Global test accuracy: 45.20
Round   7, Train loss: 1.472, Test loss: 1.501, Test accuracy: 38.96
Round   7, Global train loss: 1.472, Global test loss: 1.468, Global test accuracy: 45.00
Round   8, Train loss: 1.428, Test loss: 1.488, Test accuracy: 37.72
Round   8, Global train loss: 1.428, Global test loss: 1.478, Global test accuracy: 35.20
Round   9, Train loss: 1.357, Test loss: 1.489, Test accuracy: 38.50
Round   9, Global train loss: 1.357, Global test loss: 1.388, Global test accuracy: 41.40
Round  10, Train loss: 1.337, Test loss: 1.475, Test accuracy: 38.98
Round  10, Global train loss: 1.337, Global test loss: 1.374, Global test accuracy: 45.60
Round  11, Train loss: 1.476, Test loss: 1.474, Test accuracy: 38.04
Round  11, Global train loss: 1.476, Global test loss: 1.491, Global test accuracy: 44.20
Round  12, Train loss: 1.417, Test loss: 1.464, Test accuracy: 38.16
Round  12, Global train loss: 1.417, Global test loss: 1.435, Global test accuracy: 49.40
Round  13, Train loss: 1.307, Test loss: 1.465, Test accuracy: 39.04
Round  13, Global train loss: 1.307, Global test loss: 1.329, Global test accuracy: 45.80
Round  14, Train loss: 1.351, Test loss: 1.477, Test accuracy: 38.50
Round  14, Global train loss: 1.351, Global test loss: 1.408, Global test accuracy: 46.60
Round  15, Train loss: 1.304, Test loss: 1.493, Test accuracy: 38.08
Round  15, Global train loss: 1.304, Global test loss: 1.378, Global test accuracy: 42.20
Round  16, Train loss: 1.322, Test loss: 1.489, Test accuracy: 37.88
Round  16, Global train loss: 1.322, Global test loss: 1.345, Global test accuracy: 47.80
Round  17, Train loss: 1.436, Test loss: 1.491, Test accuracy: 36.78
Round  17, Global train loss: 1.436, Global test loss: 1.489, Global test accuracy: 41.60
Round  18, Train loss: 1.291, Test loss: 1.479, Test accuracy: 37.02
Round  18, Global train loss: 1.291, Global test loss: 1.338, Global test accuracy: 47.20
Round  19, Train loss: 1.209, Test loss: 1.459, Test accuracy: 38.18
Round  19, Global train loss: 1.209, Global test loss: 1.251, Global test accuracy: 48.40
Round  20, Train loss: 1.529, Test loss: 1.465, Test accuracy: 37.24
Round  20, Global train loss: 1.529, Global test loss: 1.520, Global test accuracy: 37.80
Round  21, Train loss: 1.283, Test loss: 1.453, Test accuracy: 37.24
Round  21, Global train loss: 1.283, Global test loss: 1.371, Global test accuracy: 49.80
Round  22, Train loss: 1.211, Test loss: 1.470, Test accuracy: 37.48
Round  22, Global train loss: 1.211, Global test loss: 1.326, Global test accuracy: 45.20
Round  23, Train loss: 1.263, Test loss: 1.452, Test accuracy: 38.56
Round  23, Global train loss: 1.263, Global test loss: 1.373, Global test accuracy: 53.80
Round  24, Train loss: 1.254, Test loss: 1.439, Test accuracy: 39.00
Round  24, Global train loss: 1.254, Global test loss: 1.373, Global test accuracy: 45.40
Round  25, Train loss: 1.431, Test loss: 1.443, Test accuracy: 39.02
Round  25, Global train loss: 1.431, Global test loss: 1.476, Global test accuracy: 38.80
Round  26, Train loss: 1.403, Test loss: 1.444, Test accuracy: 39.54
Round  26, Global train loss: 1.403, Global test loss: 1.466, Global test accuracy: 41.60
Round  27, Train loss: 0.989, Test loss: 1.468, Test accuracy: 39.50
Round  27, Global train loss: 0.989, Global test loss: 1.249, Global test accuracy: 47.00
Round  28, Train loss: 1.332, Test loss: 1.490, Test accuracy: 38.16
Round  28, Global train loss: 1.332, Global test loss: 1.433, Global test accuracy: 41.20
Round  29, Train loss: 1.226, Test loss: 1.487, Test accuracy: 38.50
Round  29, Global train loss: 1.226, Global test loss: 1.337, Global test accuracy: 45.60
Round  30, Train loss: 1.293, Test loss: 1.496, Test accuracy: 37.54
Round  30, Global train loss: 1.293, Global test loss: 1.442, Global test accuracy: 38.60
Round  31, Train loss: 1.280, Test loss: 1.501, Test accuracy: 37.18
Round  31, Global train loss: 1.280, Global test loss: 1.379, Global test accuracy: 42.40
Round  32, Train loss: 1.193, Test loss: 1.522, Test accuracy: 37.32
Round  32, Global train loss: 1.193, Global test loss: 1.300, Global test accuracy: 47.00
Round  33, Train loss: 1.438, Test loss: 1.529, Test accuracy: 37.70
Round  33, Global train loss: 1.438, Global test loss: 1.511, Global test accuracy: 33.60
Round  34, Train loss: 1.155, Test loss: 1.523, Test accuracy: 37.30
Round  34, Global train loss: 1.155, Global test loss: 1.284, Global test accuracy: 51.20
Round  35, Train loss: 1.149, Test loss: 1.541, Test accuracy: 36.80
Round  35, Global train loss: 1.149, Global test loss: 1.328, Global test accuracy: 47.00
Round  36, Train loss: 1.035, Test loss: 1.579, Test accuracy: 36.50
Round  36, Global train loss: 1.035, Global test loss: 1.282, Global test accuracy: 48.80
Round  37, Train loss: 1.100, Test loss: 1.563, Test accuracy: 37.14
Round  37, Global train loss: 1.100, Global test loss: 1.296, Global test accuracy: 45.60
Round  38, Train loss: 1.004, Test loss: 1.588, Test accuracy: 36.66
Round  38, Global train loss: 1.004, Global test loss: 1.271, Global test accuracy: 51.20
Round  39, Train loss: 1.197, Test loss: 1.575, Test accuracy: 37.06
Round  39, Global train loss: 1.197, Global test loss: 1.353, Global test accuracy: 51.80
Round  40, Train loss: 1.157, Test loss: 1.586, Test accuracy: 37.24
Round  40, Global train loss: 1.157, Global test loss: 1.370, Global test accuracy: 40.20
Round  41, Train loss: 1.060, Test loss: 1.582, Test accuracy: 37.32
Round  41, Global train loss: 1.060, Global test loss: 1.273, Global test accuracy: 47.60
Round  42, Train loss: 0.855, Test loss: 1.606, Test accuracy: 36.76
Round  42, Global train loss: 0.855, Global test loss: 1.211, Global test accuracy: 49.20
Round  43, Train loss: 1.079, Test loss: 1.626, Test accuracy: 36.90
Round  43, Global train loss: 1.079, Global test loss: 1.252, Global test accuracy: 47.80
Round  44, Train loss: 1.274, Test loss: 1.651, Test accuracy: 35.82
Round  44, Global train loss: 1.274, Global test loss: 1.483, Global test accuracy: 43.40
Round  45, Train loss: 0.940, Test loss: 1.676, Test accuracy: 35.82
Round  45, Global train loss: 0.940, Global test loss: 1.307, Global test accuracy: 46.20
Round  46, Train loss: 1.016, Test loss: 1.694, Test accuracy: 35.24
Round  46, Global train loss: 1.016, Global test loss: 1.223, Global test accuracy: 51.60
Round  47, Train loss: 0.974, Test loss: 1.694, Test accuracy: 35.06
Round  47, Global train loss: 0.974, Global test loss: 1.243, Global test accuracy: 48.60
Round  48, Train loss: 1.127, Test loss: 1.737, Test accuracy: 34.32
Round  48, Global train loss: 1.127, Global test loss: 1.464, Global test accuracy: 34.60
Round  49, Train loss: 0.901, Test loss: 1.753, Test accuracy: 34.88
Round  49, Global train loss: 0.901, Global test loss: 1.297, Global test accuracy: 44.00
Round  50, Train loss: 0.994, Test loss: 1.768, Test accuracy: 36.20
Round  50, Global train loss: 0.994, Global test loss: 1.384, Global test accuracy: 41.20
Round  51, Train loss: 1.053, Test loss: 1.785, Test accuracy: 36.14
Round  51, Global train loss: 1.053, Global test loss: 1.374, Global test accuracy: 40.80
Round  52, Train loss: 0.955, Test loss: 1.786, Test accuracy: 36.44
Round  52, Global train loss: 0.955, Global test loss: 1.258, Global test accuracy: 52.20
Round  53, Train loss: 1.159, Test loss: 1.809, Test accuracy: 35.86
Round  53, Global train loss: 1.159, Global test loss: 1.534, Global test accuracy: 30.60
Round  54, Train loss: 1.000, Test loss: 1.819, Test accuracy: 36.34
Round  54, Global train loss: 1.000, Global test loss: 1.294, Global test accuracy: 46.20
Round  55, Train loss: 0.984, Test loss: 1.881, Test accuracy: 35.86
Round  55, Global train loss: 0.984, Global test loss: 1.396, Global test accuracy: 39.20
Round  56, Train loss: 0.753, Test loss: 1.967, Test accuracy: 36.46
Round  56, Global train loss: 0.753, Global test loss: 1.285, Global test accuracy: 49.80
Round  57, Train loss: 0.898, Test loss: 1.931, Test accuracy: 36.82
Round  57, Global train loss: 0.898, Global test loss: 1.316, Global test accuracy: 46.00
Round  58, Train loss: 0.782, Test loss: 1.879, Test accuracy: 37.62
Round  58, Global train loss: 0.782, Global test loss: 1.279, Global test accuracy: 49.20
Round  59, Train loss: 0.817, Test loss: 1.887, Test accuracy: 37.90
Round  59, Global train loss: 0.817, Global test loss: 1.362, Global test accuracy: 40.00
Round  60, Train loss: 0.894, Test loss: 1.980, Test accuracy: 37.02
Round  60, Global train loss: 0.894, Global test loss: 1.320, Global test accuracy: 43.80
Round  61, Train loss: 0.828, Test loss: 2.034, Test accuracy: 36.72
Round  61, Global train loss: 0.828, Global test loss: 1.219, Global test accuracy: 49.80
Round  62, Train loss: 0.692, Test loss: 2.042, Test accuracy: 37.04
Round  62, Global train loss: 0.692, Global test loss: 1.299, Global test accuracy: 46.60
Round  63, Train loss: 0.870, Test loss: 2.093, Test accuracy: 37.14
Round  63, Global train loss: 0.870, Global test loss: 1.431, Global test accuracy: 37.20
Round  64, Train loss: 0.783, Test loss: 2.109, Test accuracy: 37.70
Round  64, Global train loss: 0.783, Global test loss: 1.297, Global test accuracy: 51.60
Round  65, Train loss: 0.619, Test loss: 2.126, Test accuracy: 37.76
Round  65, Global train loss: 0.619, Global test loss: 1.277, Global test accuracy: 46.60
Round  66, Train loss: 0.653, Test loss: 2.164, Test accuracy: 36.42
Round  66, Global train loss: 0.653, Global test loss: 1.278, Global test accuracy: 47.00
Round  67, Train loss: 0.677, Test loss: 2.175, Test accuracy: 37.52
Round  67, Global train loss: 0.677, Global test loss: 1.337, Global test accuracy: 46.40
Round  68, Train loss: 0.662, Test loss: 2.201, Test accuracy: 37.88
Round  68, Global train loss: 0.662, Global test loss: 1.227, Global test accuracy: 51.60
Round  69, Train loss: 0.692, Test loss: 2.197, Test accuracy: 38.20
Round  69, Global train loss: 0.692, Global test loss: 1.331, Global test accuracy: 46.20
Round  70, Train loss: 0.580, Test loss: 2.213, Test accuracy: 38.28
Round  70, Global train loss: 0.580, Global test loss: 1.245, Global test accuracy: 50.60
Round  71, Train loss: 0.608, Test loss: 2.268, Test accuracy: 37.60
Round  71, Global train loss: 0.608, Global test loss: 1.412, Global test accuracy: 38.40
Round  72, Train loss: 0.507, Test loss: 2.291, Test accuracy: 37.96
Round  72, Global train loss: 0.507, Global test loss: 1.271, Global test accuracy: 47.60
Round  73, Train loss: 0.608, Test loss: 2.402, Test accuracy: 37.14
Round  73, Global train loss: 0.608, Global test loss: 1.460, Global test accuracy: 37.20
Round  74, Train loss: 0.812, Test loss: 2.409, Test accuracy: 37.24
Round  74, Global train loss: 0.812, Global test loss: 1.513, Global test accuracy: 32.20
Round  75, Train loss: 0.566, Test loss: 2.508, Test accuracy: 36.84
Round  75, Global train loss: 0.566, Global test loss: 1.243, Global test accuracy: 50.20
Round  76, Train loss: 0.548, Test loss: 2.452, Test accuracy: 37.02
Round  76, Global train loss: 0.548, Global test loss: 1.413, Global test accuracy: 39.80
Round  77, Train loss: 0.495, Test loss: 2.553, Test accuracy: 37.30
Round  77, Global train loss: 0.495, Global test loss: 1.307, Global test accuracy: 46.20
Round  78, Train loss: 0.528, Test loss: 2.616, Test accuracy: 36.76
Round  78, Global train loss: 0.528, Global test loss: 1.306, Global test accuracy: 48.60
Round  79, Train loss: 0.405, Test loss: 2.624, Test accuracy: 37.50
Round  79, Global train loss: 0.405, Global test loss: 1.363, Global test accuracy: 42.00
Round  80, Train loss: 0.444, Test loss: 2.743, Test accuracy: 37.32
Round  80, Global train loss: 0.444, Global test loss: 1.261, Global test accuracy: 53.00
Round  81, Train loss: 0.504, Test loss: 2.759, Test accuracy: 37.26
Round  81, Global train loss: 0.504, Global test loss: 1.244, Global test accuracy: 49.00
Round  82, Train loss: 0.500, Test loss: 2.797, Test accuracy: 37.10
Round  82, Global train loss: 0.500, Global test loss: 1.481, Global test accuracy: 40.20
Round  83, Train loss: 0.459, Test loss: 2.808, Test accuracy: 37.08
Round  83, Global train loss: 0.459, Global test loss: 1.227, Global test accuracy: 49.60
Round  84, Train loss: 0.425, Test loss: 2.719, Test accuracy: 37.90
Round  84, Global train loss: 0.425, Global test loss: 1.223, Global test accuracy: 49.20
Round  85, Train loss: 0.589, Test loss: 2.841, Test accuracy: 37.20
Round  85, Global train loss: 0.589, Global test loss: 1.561, Global test accuracy: 37.80
Round  86, Train loss: 0.591, Test loss: 2.829, Test accuracy: 37.20
Round  86, Global train loss: 0.591, Global test loss: 1.500, Global test accuracy: 38.40
Round  87, Train loss: 0.426, Test loss: 2.997, Test accuracy: 36.58
Round  87, Global train loss: 0.426, Global test loss: 1.315, Global test accuracy: 47.80
Round  88, Train loss: 0.458, Test loss: 3.014, Test accuracy: 36.42
Round  88, Global train loss: 0.458, Global test loss: 1.413, Global test accuracy: 46.00
Round  89, Train loss: 0.412, Test loss: 3.076, Test accuracy: 36.28
Round  89, Global train loss: 0.412, Global test loss: 1.518, Global test accuracy: 39.80
Round  90, Train loss: 0.452, Test loss: 3.061, Test accuracy: 36.04
Round  90, Global train loss: 0.452, Global test loss: 1.490, Global test accuracy: 34.40
Round  91, Train loss: 0.414, Test loss: 3.114, Test accuracy: 36.46
Round  91, Global train loss: 0.414, Global test loss: 1.469, Global test accuracy: 36.20
Round  92, Train loss: 0.384, Test loss: 3.068, Test accuracy: 36.62
Round  92, Global train loss: 0.384, Global test loss: 1.377, Global test accuracy: 41.40
Round  93, Train loss: 0.422, Test loss: 3.170, Test accuracy: 36.06
Round  93, Global train loss: 0.422, Global test loss: 1.503, Global test accuracy: 39.00
Round  94, Train loss: 0.394, Test loss: 3.160, Test accuracy: 36.66
Round  94, Global train loss: 0.394, Global test loss: 1.451, Global test accuracy: 36.80
Round  95, Train loss: 0.302, Test loss: 3.176, Test accuracy: 36.84
Round  95, Global train loss: 0.302, Global test loss: 1.458, Global test accuracy: 44.80
Round  96, Train loss: 0.331, Test loss: 3.231, Test accuracy: 36.54
Round  96, Global train loss: 0.331, Global test loss: 1.400, Global test accuracy: 44.60
Round  97, Train loss: 0.337, Test loss: 3.380, Test accuracy: 36.58
Round  97, Global train loss: 0.337, Global test loss: 1.489, Global test accuracy: 36.20
Round  98, Train loss: 0.252, Test loss: 3.429, Test accuracy: 37.48
Round  98, Global train loss: 0.252, Global test loss: 1.469, Global test accuracy: 46.40
Round  99, Train loss: 0.334, Test loss: 3.399, Test accuracy: 37.88
Round  99, Global train loss: 0.334, Global test loss: 1.366, Global test accuracy: 44.00
Final Round, Train loss: 0.314, Test loss: 3.557, Test accuracy: 36.24
Final Round, Global train loss: 0.314, Global test loss: 1.366, Global test accuracy: 44.00
Average accuracy final 10 rounds: 36.715999999999994 

Average global accuracy final 10 rounds: 40.38 

825.3011374473572
[1.520320177078247, 3.040640354156494, 4.212488651275635, 5.384336948394775, 6.5611608028411865, 7.737984657287598, 8.915056705474854, 10.09212875366211, 11.255515813827515, 12.41890287399292, 13.591695070266724, 14.764487266540527, 15.912559986114502, 17.060632705688477, 18.228673934936523, 19.39671516418457, 20.644033670425415, 21.89135217666626, 23.12150812149048, 24.351664066314697, 25.504123210906982, 26.656582355499268, 27.798728227615356, 28.940874099731445, 30.095821619033813, 31.25076913833618, 32.44199013710022, 33.63321113586426, 34.89036273956299, 36.14751434326172, 37.30213785171509, 38.45676136016846, 39.60599064826965, 40.75521993637085, 41.92619490623474, 43.09716987609863, 44.253716230392456, 45.41026258468628, 46.587010622024536, 47.76375865936279, 48.944151401519775, 50.12454414367676, 51.292057037353516, 52.45956993103027, 53.625361919403076, 54.79115390777588, 55.97051978111267, 57.14988565444946, 58.30036020278931, 59.45083475112915, 60.71405601501465, 61.97727727890015, 63.18742322921753, 64.39756917953491, 65.60116195678711, 66.8047547340393, 67.96586871147156, 69.12698268890381, 70.28014278411865, 71.4333028793335, 72.60050177574158, 73.76770067214966, 74.9341311454773, 76.10056161880493, 77.25933384895325, 78.41810607910156, 79.58216905593872, 80.74623203277588, 82.01128935813904, 83.2763466835022, 84.44003891944885, 85.60373115539551, 86.76503896713257, 87.92634677886963, 89.08823704719543, 90.25012731552124, 91.43795466423035, 92.62578201293945, 93.8567385673523, 95.08769512176514, 96.22310447692871, 97.35851383209229, 98.59228134155273, 99.82604885101318, 101.055184841156, 102.28432083129883, 103.42484474182129, 104.56536865234375, 105.7360725402832, 106.90677642822266, 108.0621497631073, 109.21752309799194, 110.38857674598694, 111.55963039398193, 112.73454928398132, 113.90946817398071, 115.09053611755371, 116.27160406112671, 117.47515439987183, 118.67870473861694, 119.93520307540894, 121.19170141220093, 122.37884140014648, 123.56598138809204, 124.87380075454712, 126.1816201210022, 127.46592950820923, 128.75023889541626, 129.97822260856628, 131.2062063217163, 132.36060976982117, 133.51501321792603, 134.68443870544434, 135.85386419296265, 137.0729730129242, 138.29208183288574, 139.46982097625732, 140.6475601196289, 141.81215167045593, 142.97674322128296, 144.16786932945251, 145.35899543762207, 146.5459885597229, 147.73298168182373, 148.9743936061859, 150.2158055305481, 151.39720821380615, 152.5786108970642, 153.7345621585846, 154.89051342010498, 156.08091235160828, 157.27131128311157, 158.4421718120575, 159.61303234100342, 160.78666639328003, 161.96030044555664, 163.14157676696777, 164.3228530883789, 165.49058985710144, 166.65832662582397, 167.8268654346466, 168.99540424346924, 170.14400219917297, 171.2926001548767, 172.47752571105957, 173.66245126724243, 174.83033442497253, 175.99821758270264, 177.16140031814575, 178.32458305358887, 179.56010675430298, 180.7956304550171, 181.99616193771362, 183.19669342041016, 184.385901927948, 185.57511043548584, 186.74384689331055, 187.91258335113525, 189.0676233768463, 190.22266340255737, 191.42382407188416, 192.62498474121094, 193.8721480369568, 195.11931133270264, 196.28711199760437, 197.4549126625061, 198.66913151741028, 199.88335037231445, 201.11853885650635, 202.35372734069824, 203.51760959625244, 204.68149185180664, 205.86438298225403, 207.04727411270142, 208.28238821029663, 209.51750230789185, 210.68175768852234, 211.84601306915283, 213.05497431755066, 214.2639355659485, 215.44693422317505, 216.6299328804016, 217.83748364448547, 219.04503440856934, 220.2784924507141, 221.5119504928589, 222.69808626174927, 223.88422203063965, 225.16077518463135, 226.43732833862305, 227.5920069217682, 228.74668550491333, 229.9265570640564, 231.10642862319946, 232.35393357276917, 233.60143852233887, 234.86406421661377, 236.12668991088867, 237.28474640846252, 238.44280290603638, 240.8743395805359, 243.3058762550354]
[32.64, 32.64, 35.56, 35.56, 36.04, 36.04, 37.38, 37.38, 36.14, 36.14, 36.78, 36.78, 38.42, 38.42, 38.96, 38.96, 37.72, 37.72, 38.5, 38.5, 38.98, 38.98, 38.04, 38.04, 38.16, 38.16, 39.04, 39.04, 38.5, 38.5, 38.08, 38.08, 37.88, 37.88, 36.78, 36.78, 37.02, 37.02, 38.18, 38.18, 37.24, 37.24, 37.24, 37.24, 37.48, 37.48, 38.56, 38.56, 39.0, 39.0, 39.02, 39.02, 39.54, 39.54, 39.5, 39.5, 38.16, 38.16, 38.5, 38.5, 37.54, 37.54, 37.18, 37.18, 37.32, 37.32, 37.7, 37.7, 37.3, 37.3, 36.8, 36.8, 36.5, 36.5, 37.14, 37.14, 36.66, 36.66, 37.06, 37.06, 37.24, 37.24, 37.32, 37.32, 36.76, 36.76, 36.9, 36.9, 35.82, 35.82, 35.82, 35.82, 35.24, 35.24, 35.06, 35.06, 34.32, 34.32, 34.88, 34.88, 36.2, 36.2, 36.14, 36.14, 36.44, 36.44, 35.86, 35.86, 36.34, 36.34, 35.86, 35.86, 36.46, 36.46, 36.82, 36.82, 37.62, 37.62, 37.9, 37.9, 37.02, 37.02, 36.72, 36.72, 37.04, 37.04, 37.14, 37.14, 37.7, 37.7, 37.76, 37.76, 36.42, 36.42, 37.52, 37.52, 37.88, 37.88, 38.2, 38.2, 38.28, 38.28, 37.6, 37.6, 37.96, 37.96, 37.14, 37.14, 37.24, 37.24, 36.84, 36.84, 37.02, 37.02, 37.3, 37.3, 36.76, 36.76, 37.5, 37.5, 37.32, 37.32, 37.26, 37.26, 37.1, 37.1, 37.08, 37.08, 37.9, 37.9, 37.2, 37.2, 37.2, 37.2, 36.58, 36.58, 36.42, 36.42, 36.28, 36.28, 36.04, 36.04, 36.46, 36.46, 36.62, 36.62, 36.06, 36.06, 36.66, 36.66, 36.84, 36.84, 36.54, 36.54, 36.58, 36.58, 37.48, 37.48, 37.88, 37.88, 36.24, 36.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.516, Test loss: 1.510, Test accuracy: 32.76
Round   0, Global train loss: 1.516, Global test loss: 1.512, Global test accuracy: 32.60
Round   1, Train loss: 1.497, Test loss: 1.466, Test accuracy: 38.46
Round   1, Global train loss: 1.497, Global test loss: 1.441, Global test accuracy: 40.20
Round   2, Train loss: 1.595, Test loss: 1.493, Test accuracy: 40.28
Round   2, Global train loss: 1.595, Global test loss: 1.484, Global test accuracy: 45.80
Round   3, Train loss: 1.529, Test loss: 1.467, Test accuracy: 40.76
Round   3, Global train loss: 1.529, Global test loss: 1.441, Global test accuracy: 43.40
Round   4, Train loss: 1.476, Test loss: 1.445, Test accuracy: 42.34
Round   4, Global train loss: 1.476, Global test loss: 1.392, Global test accuracy: 48.80
Round   5, Train loss: 1.555, Test loss: 1.447, Test accuracy: 43.34
Round   5, Global train loss: 1.555, Global test loss: 1.440, Global test accuracy: 48.60
Round   6, Train loss: 1.456, Test loss: 1.424, Test accuracy: 43.28
Round   6, Global train loss: 1.456, Global test loss: 1.343, Global test accuracy: 47.00
Round   7, Train loss: 1.353, Test loss: 1.378, Test accuracy: 44.82
Round   7, Global train loss: 1.353, Global test loss: 1.181, Global test accuracy: 53.60
Round   8, Train loss: 1.449, Test loss: 1.348, Test accuracy: 47.80
Round   8, Global train loss: 1.449, Global test loss: 1.279, Global test accuracy: 55.80
Round   9, Train loss: 1.529, Test loss: 1.350, Test accuracy: 48.78
Round   9, Global train loss: 1.529, Global test loss: 1.390, Global test accuracy: 52.80
Round  10, Train loss: 1.414, Test loss: 1.345, Test accuracy: 47.78
Round  10, Global train loss: 1.414, Global test loss: 1.265, Global test accuracy: 56.40
Round  11, Train loss: 1.521, Test loss: 1.334, Test accuracy: 48.18
Round  11, Global train loss: 1.521, Global test loss: 1.402, Global test accuracy: 47.60
Round  12, Train loss: 1.299, Test loss: 1.325, Test accuracy: 47.82
Round  12, Global train loss: 1.299, Global test loss: 1.129, Global test accuracy: 57.00
Round  13, Train loss: 1.500, Test loss: 1.318, Test accuracy: 48.54
Round  13, Global train loss: 1.500, Global test loss: 1.352, Global test accuracy: 50.80
Round  14, Train loss: 1.340, Test loss: 1.320, Test accuracy: 48.00
Round  14, Global train loss: 1.340, Global test loss: 1.222, Global test accuracy: 54.40
Round  15, Train loss: 1.484, Test loss: 1.329, Test accuracy: 46.96
Round  15, Global train loss: 1.484, Global test loss: 1.375, Global test accuracy: 50.20
Round  16, Train loss: 1.431, Test loss: 1.328, Test accuracy: 47.74
Round  16, Global train loss: 1.431, Global test loss: 1.376, Global test accuracy: 48.00
Round  17, Train loss: 1.460, Test loss: 1.353, Test accuracy: 45.86
Round  17, Global train loss: 1.460, Global test loss: 1.449, Global test accuracy: 42.40
Round  18, Train loss: 1.431, Test loss: 1.367, Test accuracy: 45.26
Round  18, Global train loss: 1.431, Global test loss: 1.420, Global test accuracy: 45.60
Round  19, Train loss: 1.214, Test loss: 1.375, Test accuracy: 44.92
Round  19, Global train loss: 1.214, Global test loss: 1.038, Global test accuracy: 59.40
Round  20, Train loss: 1.475, Test loss: 1.363, Test accuracy: 45.70
Round  20, Global train loss: 1.475, Global test loss: 1.432, Global test accuracy: 43.20
Round  21, Train loss: 1.093, Test loss: 1.349, Test accuracy: 46.04
Round  21, Global train loss: 1.093, Global test loss: 0.903, Global test accuracy: 65.40
Round  22, Train loss: 1.393, Test loss: 1.328, Test accuracy: 46.86
Round  22, Global train loss: 1.393, Global test loss: 1.342, Global test accuracy: 49.00
Round  23, Train loss: 1.240, Test loss: 1.334, Test accuracy: 46.52
Round  23, Global train loss: 1.240, Global test loss: 1.241, Global test accuracy: 53.80
Round  24, Train loss: 1.269, Test loss: 1.361, Test accuracy: 45.24
Round  24, Global train loss: 1.269, Global test loss: 1.345, Global test accuracy: 50.40
Round  25, Train loss: 1.230, Test loss: 1.363, Test accuracy: 45.22
Round  25, Global train loss: 1.230, Global test loss: 1.403, Global test accuracy: 46.80
Round  26, Train loss: 1.231, Test loss: 1.359, Test accuracy: 45.98
Round  26, Global train loss: 1.231, Global test loss: 1.277, Global test accuracy: 47.80
Round  27, Train loss: 1.092, Test loss: 1.375, Test accuracy: 45.74
Round  27, Global train loss: 1.092, Global test loss: 1.173, Global test accuracy: 57.20
Round  28, Train loss: 1.130, Test loss: 1.407, Test accuracy: 44.86
Round  28, Global train loss: 1.130, Global test loss: 1.302, Global test accuracy: 45.40
Round  29, Train loss: 1.114, Test loss: 1.434, Test accuracy: 44.58
Round  29, Global train loss: 1.114, Global test loss: 1.338, Global test accuracy: 46.80
Round  30, Train loss: 1.120, Test loss: 1.482, Test accuracy: 44.16
Round  30, Global train loss: 1.120, Global test loss: 1.580, Global test accuracy: 42.60
Round  31, Train loss: 1.136, Test loss: 1.501, Test accuracy: 44.26
Round  31, Global train loss: 1.136, Global test loss: 1.538, Global test accuracy: 37.80
Round  32, Train loss: 1.008, Test loss: 1.520, Test accuracy: 43.08
Round  32, Global train loss: 1.008, Global test loss: 1.623, Global test accuracy: 41.60
Round  33, Train loss: 1.113, Test loss: 1.555, Test accuracy: 42.74
Round  33, Global train loss: 1.113, Global test loss: 1.755, Global test accuracy: 31.80
Round  34, Train loss: 0.902, Test loss: 1.636, Test accuracy: 42.04
Round  34, Global train loss: 0.902, Global test loss: 1.269, Global test accuracy: 54.80
Round  35, Train loss: 0.947, Test loss: 1.669, Test accuracy: 42.94
Round  35, Global train loss: 0.947, Global test loss: 1.785, Global test accuracy: 39.20
Round  36, Train loss: 0.757, Test loss: 1.791, Test accuracy: 41.54
Round  36, Global train loss: 0.757, Global test loss: 1.744, Global test accuracy: 45.60
Round  37, Train loss: 0.803, Test loss: 1.837, Test accuracy: 40.74
Round  37, Global train loss: 0.803, Global test loss: 2.004, Global test accuracy: 39.00
Round  38, Train loss: 0.641, Test loss: 1.812, Test accuracy: 40.62
Round  38, Global train loss: 0.641, Global test loss: 1.276, Global test accuracy: 55.80
Round  39, Train loss: 0.921, Test loss: 1.818, Test accuracy: 41.52
Round  39, Global train loss: 0.921, Global test loss: 1.120, Global test accuracy: 58.00
Round  40, Train loss: 0.931, Test loss: 1.827, Test accuracy: 42.12
Round  40, Global train loss: 0.931, Global test loss: 1.775, Global test accuracy: 38.00
Round  41, Train loss: 0.755, Test loss: 1.829, Test accuracy: 42.88
Round  41, Global train loss: 0.755, Global test loss: 1.853, Global test accuracy: 42.00
Round  42, Train loss: 0.599, Test loss: 1.904, Test accuracy: 42.66
Round  42, Global train loss: 0.599, Global test loss: 1.406, Global test accuracy: 54.60
Round  43, Train loss: 0.695, Test loss: 1.943, Test accuracy: 42.68
Round  43, Global train loss: 0.695, Global test loss: 1.500, Global test accuracy: 48.60
Round  44, Train loss: 0.816, Test loss: 1.968, Test accuracy: 42.96
Round  44, Global train loss: 0.816, Global test loss: 1.454, Global test accuracy: 47.00
Round  45, Train loss: 0.690, Test loss: 1.968, Test accuracy: 42.70
Round  45, Global train loss: 0.690, Global test loss: 1.779, Global test accuracy: 42.00
Round  46, Train loss: 0.564, Test loss: 2.016, Test accuracy: 42.28
Round  46, Global train loss: 0.564, Global test loss: 1.311, Global test accuracy: 54.60
Round  47, Train loss: 0.525, Test loss: 2.071, Test accuracy: 41.64
Round  47, Global train loss: 0.525, Global test loss: 1.467, Global test accuracy: 54.20
Round  48, Train loss: 0.681, Test loss: 2.104, Test accuracy: 40.66
Round  48, Global train loss: 0.681, Global test loss: 1.905, Global test accuracy: 38.20
Round  49, Train loss: 0.651, Test loss: 2.090, Test accuracy: 40.76
Round  49, Global train loss: 0.651, Global test loss: 1.778, Global test accuracy: 42.40
Round  50, Train loss: 0.472, Test loss: 2.143, Test accuracy: 41.50
Round  50, Global train loss: 0.472, Global test loss: 2.050, Global test accuracy: 44.20
Round  51, Train loss: 0.612, Test loss: 2.203, Test accuracy: 41.48
Round  51, Global train loss: 0.612, Global test loss: 1.545, Global test accuracy: 49.80
Round  52, Train loss: 0.606, Test loss: 2.203, Test accuracy: 41.42
Round  52, Global train loss: 0.606, Global test loss: 1.613, Global test accuracy: 47.40
Round  53, Train loss: 0.705, Test loss: 2.188, Test accuracy: 42.78
Round  53, Global train loss: 0.705, Global test loss: 1.640, Global test accuracy: 43.80
Round  54, Train loss: 0.496, Test loss: 2.169, Test accuracy: 43.98
Round  54, Global train loss: 0.496, Global test loss: 1.600, Global test accuracy: 51.80
Round  55, Train loss: 0.520, Test loss: 2.196, Test accuracy: 42.36
Round  55, Global train loss: 0.520, Global test loss: 1.706, Global test accuracy: 46.00
Round  56, Train loss: 0.425, Test loss: 2.251, Test accuracy: 41.96
Round  56, Global train loss: 0.425, Global test loss: 1.585, Global test accuracy: 53.80
Round  57, Train loss: 0.543, Test loss: 2.305, Test accuracy: 42.02
Round  57, Global train loss: 0.543, Global test loss: 1.831, Global test accuracy: 43.40
Round  58, Train loss: 0.474, Test loss: 2.319, Test accuracy: 43.00
Round  58, Global train loss: 0.474, Global test loss: 1.992, Global test accuracy: 46.60
Round  59, Train loss: 0.431, Test loss: 2.345, Test accuracy: 43.76
Round  59, Global train loss: 0.431, Global test loss: 1.923, Global test accuracy: 46.00
Round  60, Train loss: 0.560, Test loss: 2.348, Test accuracy: 43.24
Round  60, Global train loss: 0.560, Global test loss: 1.709, Global test accuracy: 45.20
Round  61, Train loss: 0.393, Test loss: 2.387, Test accuracy: 43.18
Round  61, Global train loss: 0.393, Global test loss: 1.671, Global test accuracy: 51.60
Round  62, Train loss: 0.394, Test loss: 2.373, Test accuracy: 43.44
Round  62, Global train loss: 0.394, Global test loss: 1.927, Global test accuracy: 49.40
Round  63, Train loss: 0.508, Test loss: 2.359, Test accuracy: 43.16
Round  63, Global train loss: 0.508, Global test loss: 2.208, Global test accuracy: 36.60
Round  64, Train loss: 0.426, Test loss: 2.439, Test accuracy: 43.04
Round  64, Global train loss: 0.426, Global test loss: 1.443, Global test accuracy: 56.60
Round  65, Train loss: 0.409, Test loss: 2.512, Test accuracy: 42.50
Round  65, Global train loss: 0.409, Global test loss: 2.014, Global test accuracy: 43.40
Round  66, Train loss: 0.337, Test loss: 2.541, Test accuracy: 42.78
Round  66, Global train loss: 0.337, Global test loss: 1.865, Global test accuracy: 51.20
Round  67, Train loss: 0.396, Test loss: 2.606, Test accuracy: 41.98
Round  67, Global train loss: 0.396, Global test loss: 2.340, Global test accuracy: 38.60
Round  68, Train loss: 0.292, Test loss: 2.658, Test accuracy: 42.18
Round  68, Global train loss: 0.292, Global test loss: 1.599, Global test accuracy: 60.80
Round  69, Train loss: 0.488, Test loss: 2.644, Test accuracy: 41.78
Round  69, Global train loss: 0.488, Global test loss: 1.931, Global test accuracy: 44.00
Round  70, Train loss: 0.297, Test loss: 2.658, Test accuracy: 42.36
Round  70, Global train loss: 0.297, Global test loss: 2.583, Global test accuracy: 43.40
Round  71, Train loss: 0.417, Test loss: 2.615, Test accuracy: 41.80
Round  71, Global train loss: 0.417, Global test loss: 2.303, Global test accuracy: 37.80
Round  72, Train loss: 0.343, Test loss: 2.632, Test accuracy: 42.34
Round  72, Global train loss: 0.343, Global test loss: 1.824, Global test accuracy: 49.60
Round  73, Train loss: 0.322, Test loss: 2.803, Test accuracy: 42.14
Round  73, Global train loss: 0.322, Global test loss: 2.622, Global test accuracy: 43.20
Round  74, Train loss: 0.345, Test loss: 2.908, Test accuracy: 42.78
Round  74, Global train loss: 0.345, Global test loss: 2.260, Global test accuracy: 44.00
Round  75, Train loss: 0.250, Test loss: 2.865, Test accuracy: 42.36
Round  75, Global train loss: 0.250, Global test loss: 1.795, Global test accuracy: 52.60
Round  76, Train loss: 0.301, Test loss: 2.875, Test accuracy: 42.72
Round  76, Global train loss: 0.301, Global test loss: 2.193, Global test accuracy: 47.00
Round  77, Train loss: 0.320, Test loss: 2.872, Test accuracy: 42.42
Round  77, Global train loss: 0.320, Global test loss: 2.254, Global test accuracy: 44.00
Round  78, Train loss: 0.297, Test loss: 2.862, Test accuracy: 42.68
Round  78, Global train loss: 0.297, Global test loss: 1.674, Global test accuracy: 58.00
Round  79, Train loss: 0.302, Test loss: 2.859, Test accuracy: 42.96
Round  79, Global train loss: 0.302, Global test loss: 2.195, Global test accuracy: 47.60
Round  80, Train loss: 0.270, Test loss: 2.919, Test accuracy: 43.64
Round  80, Global train loss: 0.270, Global test loss: 2.039, Global test accuracy: 48.40
Round  81, Train loss: 0.282, Test loss: 2.986, Test accuracy: 42.94
Round  81, Global train loss: 0.282, Global test loss: 1.844, Global test accuracy: 50.20
Round  82, Train loss: 0.285, Test loss: 2.985, Test accuracy: 42.20
Round  82, Global train loss: 0.285, Global test loss: 2.835, Global test accuracy: 38.60
Round  83, Train loss: 0.204, Test loss: 2.890, Test accuracy: 43.30
Round  83, Global train loss: 0.204, Global test loss: 1.987, Global test accuracy: 54.00
Round  84, Train loss: 0.295, Test loss: 2.942, Test accuracy: 43.18
Round  84, Global train loss: 0.295, Global test loss: 2.675, Global test accuracy: 41.40
Round  85, Train loss: 0.243, Test loss: 2.911, Test accuracy: 43.50
Round  85, Global train loss: 0.243, Global test loss: 2.802, Global test accuracy: 41.80
Round  86, Train loss: 0.167, Test loss: 2.886, Test accuracy: 44.80
Round  86, Global train loss: 0.167, Global test loss: 2.840, Global test accuracy: 43.00
Round  87, Train loss: 0.183, Test loss: 2.847, Test accuracy: 45.32
Round  87, Global train loss: 0.183, Global test loss: 2.674, Global test accuracy: 47.80
Round  88, Train loss: 0.150, Test loss: 2.979, Test accuracy: 43.86
Round  88, Global train loss: 0.150, Global test loss: 3.129, Global test accuracy: 38.00
Round  89, Train loss: 0.235, Test loss: 2.929, Test accuracy: 44.28
Round  89, Global train loss: 0.235, Global test loss: 2.782, Global test accuracy: 42.60
Round  90, Train loss: 0.269, Test loss: 2.941, Test accuracy: 44.06
Round  90, Global train loss: 0.269, Global test loss: 2.598, Global test accuracy: 44.00
Round  91, Train loss: 0.288, Test loss: 2.954, Test accuracy: 43.94
Round  91, Global train loss: 0.288, Global test loss: 2.168, Global test accuracy: 46.20
Round  92, Train loss: 0.274, Test loss: 2.886, Test accuracy: 44.86
Round  92, Global train loss: 0.274, Global test loss: 2.349, Global test accuracy: 43.00
Round  93, Train loss: 0.222, Test loss: 2.929, Test accuracy: 44.30
Round  93, Global train loss: 0.222, Global test loss: 3.158, Global test accuracy: 37.80
Round  94, Train loss: 0.210, Test loss: 2.927, Test accuracy: 44.58
Round  94, Global train loss: 0.210, Global test loss: 2.177, Global test accuracy: 49.80
Round  95, Train loss: 0.229, Test loss: 3.002, Test accuracy: 43.64
Round  95, Global train loss: 0.229, Global test loss: 2.084, Global test accuracy: 51.40
Round  96, Train loss: 0.161, Test loss: 3.027, Test accuracy: 43.46
Round  96, Global train loss: 0.161, Global test loss: 3.140, Global test accuracy: 41.20
Round  97, Train loss: 0.203, Test loss: 3.052, Test accuracy: 43.28
Round  97, Global train loss: 0.203, Global test loss: 2.286, Global test accuracy: 50.40
Round  98, Train loss: 0.184, Test loss: 2.998, Test accuracy: 44.18
Round  98, Global train loss: 0.184, Global test loss: 2.036, Global test accuracy: 56.80
Round  99, Train loss: 0.194, Test loss: 3.010, Test accuracy: 44.56
Round  99, Global train loss: 0.194, Global test loss: 2.911, Global test accuracy: 42.80
Final Round, Train loss: 0.177, Test loss: 3.199, Test accuracy: 43.26
Final Round, Global train loss: 0.177, Global test loss: 2.911, Global test accuracy: 42.80
Average accuracy final 10 rounds: 44.086000000000006 

Average global accuracy final 10 rounds: 46.34 

825.4834539890289
[1.5579099655151367, 3.1158199310302734, 4.349415302276611, 5.583010673522949, 6.874658823013306, 8.166306972503662, 9.458756685256958, 10.751206398010254, 12.07630181312561, 13.401397228240967, 14.732241868972778, 16.06308650970459, 17.331022024154663, 18.598957538604736, 19.880696535110474, 21.16243553161621, 22.44447946548462, 23.726523399353027, 24.96665072441101, 26.206778049468994, 27.34621834754944, 28.485658645629883, 29.74264168739319, 30.999624729156494, 32.243666887283325, 33.487709045410156, 34.71123123168945, 35.93475341796875, 37.15493965148926, 38.375125885009766, 39.55811262130737, 40.74109935760498, 41.92349600791931, 43.10589265823364, 44.34217834472656, 45.57846403121948, 46.726069688797, 47.87367534637451, 49.013155460357666, 50.15263557434082, 51.297101974487305, 52.44156837463379, 53.6086859703064, 54.775803565979004, 55.91691184043884, 57.05802011489868, 58.29929280281067, 59.540565490722656, 60.74994397163391, 61.959322452545166, 63.10404992103577, 64.24877738952637, 65.47350263595581, 66.69822788238525, 67.83859515190125, 68.97896242141724, 70.1411645412445, 71.30336666107178, 72.46250772476196, 73.62164878845215, 74.76235389709473, 75.9030590057373, 77.07310199737549, 78.24314498901367, 79.45757627487183, 80.67200756072998, 81.86819911003113, 83.06439065933228, 84.20053291320801, 85.33667516708374, 86.48587918281555, 87.63508319854736, 88.78806519508362, 89.94104719161987, 91.08174109458923, 92.2224349975586, 93.39770913124084, 94.5729832649231, 95.74648809432983, 96.91999292373657, 98.05409574508667, 99.18819856643677, 100.33281207084656, 101.47742557525635, 102.63534998893738, 103.79327440261841, 104.93054938316345, 106.0678243637085, 107.25982737541199, 108.45183038711548, 109.61035895347595, 110.76888751983643, 112.02652859687805, 113.28416967391968, 114.469318151474, 115.65446662902832, 116.88050508499146, 118.10654354095459, 119.25514817237854, 120.40375280380249, 121.56842231750488, 122.73309183120728, 123.89038372039795, 125.04767560958862, 126.18910717964172, 127.33053874969482, 128.4876594543457, 129.64478015899658, 130.98687171936035, 132.32896327972412, 133.55510878562927, 134.78125429153442, 136.03937363624573, 137.29749298095703, 138.5087571144104, 139.72002124786377, 140.86832404136658, 142.01662683486938, 143.2297945022583, 144.44296216964722, 145.6394453048706, 146.835928440094, 148.00375390052795, 149.1715793609619, 150.4280300140381, 151.68448066711426, 152.93282461166382, 154.18116855621338, 155.3287308216095, 156.47629308700562, 157.61834621429443, 158.76039934158325, 159.9321587085724, 161.10391807556152, 162.25531363487244, 163.40670919418335, 164.55423188209534, 165.70175457000732, 166.8594090938568, 168.0170636177063, 169.17081594467163, 170.32456827163696, 171.48910427093506, 172.65364027023315, 173.85084342956543, 175.0480465888977, 176.1922881603241, 177.3365297317505, 178.50941967964172, 179.68230962753296, 180.82445240020752, 181.96659517288208, 183.12163877487183, 184.27668237686157, 185.44880509376526, 186.62092781066895, 187.7571029663086, 188.89327812194824, 190.03472995758057, 191.1761817932129, 192.30978322029114, 193.44338464736938, 194.59826016426086, 195.75313568115234, 196.90339756011963, 198.0536594390869, 199.24841046333313, 200.44316148757935, 201.6175298690796, 202.79189825057983, 203.94982862472534, 205.10775899887085, 206.2732057571411, 207.43865251541138, 208.69239377975464, 209.9461350440979, 211.09607315063477, 212.24601125717163, 213.3781280517578, 214.510244846344, 215.65279841423035, 216.7953519821167, 217.94007682800293, 219.08480167388916, 220.2316234111786, 221.37844514846802, 222.54266047477722, 223.70687580108643, 224.8724193572998, 226.03796291351318, 227.19069409370422, 228.34342527389526, 229.49320459365845, 230.64298391342163, 231.80032515525818, 232.95766639709473, 234.11142563819885, 235.26518487930298, 236.43058395385742, 237.59598302841187, 240.02987599372864, 242.4637689590454]
[32.76, 32.76, 38.46, 38.46, 40.28, 40.28, 40.76, 40.76, 42.34, 42.34, 43.34, 43.34, 43.28, 43.28, 44.82, 44.82, 47.8, 47.8, 48.78, 48.78, 47.78, 47.78, 48.18, 48.18, 47.82, 47.82, 48.54, 48.54, 48.0, 48.0, 46.96, 46.96, 47.74, 47.74, 45.86, 45.86, 45.26, 45.26, 44.92, 44.92, 45.7, 45.7, 46.04, 46.04, 46.86, 46.86, 46.52, 46.52, 45.24, 45.24, 45.22, 45.22, 45.98, 45.98, 45.74, 45.74, 44.86, 44.86, 44.58, 44.58, 44.16, 44.16, 44.26, 44.26, 43.08, 43.08, 42.74, 42.74, 42.04, 42.04, 42.94, 42.94, 41.54, 41.54, 40.74, 40.74, 40.62, 40.62, 41.52, 41.52, 42.12, 42.12, 42.88, 42.88, 42.66, 42.66, 42.68, 42.68, 42.96, 42.96, 42.7, 42.7, 42.28, 42.28, 41.64, 41.64, 40.66, 40.66, 40.76, 40.76, 41.5, 41.5, 41.48, 41.48, 41.42, 41.42, 42.78, 42.78, 43.98, 43.98, 42.36, 42.36, 41.96, 41.96, 42.02, 42.02, 43.0, 43.0, 43.76, 43.76, 43.24, 43.24, 43.18, 43.18, 43.44, 43.44, 43.16, 43.16, 43.04, 43.04, 42.5, 42.5, 42.78, 42.78, 41.98, 41.98, 42.18, 42.18, 41.78, 41.78, 42.36, 42.36, 41.8, 41.8, 42.34, 42.34, 42.14, 42.14, 42.78, 42.78, 42.36, 42.36, 42.72, 42.72, 42.42, 42.42, 42.68, 42.68, 42.96, 42.96, 43.64, 43.64, 42.94, 42.94, 42.2, 42.2, 43.3, 43.3, 43.18, 43.18, 43.5, 43.5, 44.8, 44.8, 45.32, 45.32, 43.86, 43.86, 44.28, 44.28, 44.06, 44.06, 43.94, 43.94, 44.86, 44.86, 44.3, 44.3, 44.58, 44.58, 43.64, 43.64, 43.46, 43.46, 43.28, 43.28, 44.18, 44.18, 44.56, 44.56, 43.26, 43.26]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.527, Test loss: 1.555, Test accuracy: 32.68
Round   0, Global train loss: 1.527, Global test loss: 1.558, Global test accuracy: 34.40
Round   1, Train loss: 1.555, Test loss: 1.528, Test accuracy: 35.88
Round   1, Global train loss: 1.555, Global test loss: 1.519, Global test accuracy: 37.40
Round   2, Train loss: 1.575, Test loss: 1.525, Test accuracy: 37.72
Round   2, Global train loss: 1.575, Global test loss: 1.510, Global test accuracy: 47.40
Round   3, Train loss: 1.522, Test loss: 1.512, Test accuracy: 34.50
Round   3, Global train loss: 1.522, Global test loss: 1.465, Global test accuracy: 37.00
Round   4, Train loss: 1.567, Test loss: 1.509, Test accuracy: 36.44
Round   4, Global train loss: 1.567, Global test loss: 1.490, Global test accuracy: 42.40
Round   5, Train loss: 1.560, Test loss: 1.498, Test accuracy: 39.34
Round   5, Global train loss: 1.560, Global test loss: 1.479, Global test accuracy: 49.20
Round   6, Train loss: 1.534, Test loss: 1.482, Test accuracy: 39.04
Round   6, Global train loss: 1.534, Global test loss: 1.448, Global test accuracy: 41.20
Round   7, Train loss: 1.463, Test loss: 1.453, Test accuracy: 40.78
Round   7, Global train loss: 1.463, Global test loss: 1.330, Global test accuracy: 52.40
Round   8, Train loss: 1.454, Test loss: 1.431, Test accuracy: 42.50
Round   8, Global train loss: 1.454, Global test loss: 1.339, Global test accuracy: 58.80
Round   9, Train loss: 1.474, Test loss: 1.426, Test accuracy: 42.94
Round   9, Global train loss: 1.474, Global test loss: 1.369, Global test accuracy: 56.40
Round  10, Train loss: 1.421, Test loss: 1.425, Test accuracy: 41.80
Round  10, Global train loss: 1.421, Global test loss: 1.310, Global test accuracy: 45.80
Round  11, Train loss: 1.587, Test loss: 1.413, Test accuracy: 43.42
Round  11, Global train loss: 1.587, Global test loss: 1.460, Global test accuracy: 55.60
Round  12, Train loss: 1.424, Test loss: 1.399, Test accuracy: 43.52
Round  12, Global train loss: 1.424, Global test loss: 1.288, Global test accuracy: 53.20
Round  13, Train loss: 1.399, Test loss: 1.393, Test accuracy: 44.26
Round  13, Global train loss: 1.399, Global test loss: 1.283, Global test accuracy: 50.40
Round  14, Train loss: 1.429, Test loss: 1.387, Test accuracy: 46.06
Round  14, Global train loss: 1.429, Global test loss: 1.333, Global test accuracy: 53.80
Round  15, Train loss: 1.487, Test loss: 1.389, Test accuracy: 44.02
Round  15, Global train loss: 1.487, Global test loss: 1.382, Global test accuracy: 50.40
Round  16, Train loss: 1.448, Test loss: 1.394, Test accuracy: 43.40
Round  16, Global train loss: 1.448, Global test loss: 1.355, Global test accuracy: 49.80
Round  17, Train loss: 1.545, Test loss: 1.397, Test accuracy: 43.58
Round  17, Global train loss: 1.545, Global test loss: 1.474, Global test accuracy: 46.00
Round  18, Train loss: 1.370, Test loss: 1.418, Test accuracy: 42.46
Round  18, Global train loss: 1.370, Global test loss: 1.290, Global test accuracy: 52.40
Round  19, Train loss: 1.336, Test loss: 1.392, Test accuracy: 43.42
Round  19, Global train loss: 1.336, Global test loss: 1.231, Global test accuracy: 57.40
Round  20, Train loss: 1.467, Test loss: 1.372, Test accuracy: 45.04
Round  20, Global train loss: 1.467, Global test loss: 1.344, Global test accuracy: 53.60
Round  21, Train loss: 1.313, Test loss: 1.354, Test accuracy: 46.16
Round  21, Global train loss: 1.313, Global test loss: 1.149, Global test accuracy: 63.60
Round  22, Train loss: 1.260, Test loss: 1.366, Test accuracy: 46.16
Round  22, Global train loss: 1.260, Global test loss: 1.128, Global test accuracy: 59.00
Round  23, Train loss: 1.386, Test loss: 1.340, Test accuracy: 47.86
Round  23, Global train loss: 1.386, Global test loss: 1.280, Global test accuracy: 54.60
Round  24, Train loss: 1.294, Test loss: 1.346, Test accuracy: 47.48
Round  24, Global train loss: 1.294, Global test loss: 1.254, Global test accuracy: 55.60
Round  25, Train loss: 1.350, Test loss: 1.348, Test accuracy: 46.44
Round  25, Global train loss: 1.350, Global test loss: 1.340, Global test accuracy: 47.40
Round  26, Train loss: 1.384, Test loss: 1.346, Test accuracy: 47.22
Round  26, Global train loss: 1.384, Global test loss: 1.330, Global test accuracy: 49.80
Round  27, Train loss: 1.108, Test loss: 1.372, Test accuracy: 45.94
Round  27, Global train loss: 1.108, Global test loss: 1.173, Global test accuracy: 52.60
Round  28, Train loss: 1.307, Test loss: 1.374, Test accuracy: 46.12
Round  28, Global train loss: 1.307, Global test loss: 1.321, Global test accuracy: 49.20
Round  29, Train loss: 1.125, Test loss: 1.384, Test accuracy: 45.50
Round  29, Global train loss: 1.125, Global test loss: 1.177, Global test accuracy: 58.80
Round  30, Train loss: 1.339, Test loss: 1.417, Test accuracy: 42.96
Round  30, Global train loss: 1.339, Global test loss: 1.563, Global test accuracy: 33.60
Round  31, Train loss: 1.188, Test loss: 1.458, Test accuracy: 42.02
Round  31, Global train loss: 1.188, Global test loss: 1.437, Global test accuracy: 45.40
Round  32, Train loss: 1.138, Test loss: 1.465, Test accuracy: 42.48
Round  32, Global train loss: 1.138, Global test loss: 1.439, Global test accuracy: 46.40
Round  33, Train loss: 1.263, Test loss: 1.456, Test accuracy: 42.68
Round  33, Global train loss: 1.263, Global test loss: 1.502, Global test accuracy: 40.60
Round  34, Train loss: 1.045, Test loss: 1.513, Test accuracy: 39.68
Round  34, Global train loss: 1.045, Global test loss: 1.242, Global test accuracy: 52.60
Round  35, Train loss: 1.104, Test loss: 1.543, Test accuracy: 39.62
Round  35, Global train loss: 1.104, Global test loss: 1.498, Global test accuracy: 43.40
Round  36, Train loss: 0.931, Test loss: 1.564, Test accuracy: 39.20
Round  36, Global train loss: 0.931, Global test loss: 1.477, Global test accuracy: 43.60
Round  37, Train loss: 0.969, Test loss: 1.584, Test accuracy: 39.22
Round  37, Global train loss: 0.969, Global test loss: 1.579, Global test accuracy: 43.80
Round  38, Train loss: 0.876, Test loss: 1.595, Test accuracy: 40.94
Round  38, Global train loss: 0.876, Global test loss: 1.306, Global test accuracy: 52.00
Round  39, Train loss: 1.156, Test loss: 1.576, Test accuracy: 42.06
Round  39, Global train loss: 1.156, Global test loss: 1.201, Global test accuracy: 54.20
Round  40, Train loss: 1.040, Test loss: 1.601, Test accuracy: 42.20
Round  40, Global train loss: 1.040, Global test loss: 1.449, Global test accuracy: 44.80
Round  41, Train loss: 0.884, Test loss: 1.692, Test accuracy: 40.44
Round  41, Global train loss: 0.884, Global test loss: 1.578, Global test accuracy: 44.80
Round  42, Train loss: 0.776, Test loss: 1.736, Test accuracy: 40.08
Round  42, Global train loss: 0.776, Global test loss: 1.506, Global test accuracy: 49.00
Round  43, Train loss: 0.971, Test loss: 1.784, Test accuracy: 39.32
Round  43, Global train loss: 0.971, Global test loss: 1.534, Global test accuracy: 46.40
Round  44, Train loss: 1.168, Test loss: 1.832, Test accuracy: 38.18
Round  44, Global train loss: 1.168, Global test loss: 1.644, Global test accuracy: 33.60
Round  45, Train loss: 0.790, Test loss: 1.824, Test accuracy: 38.14
Round  45, Global train loss: 0.790, Global test loss: 1.687, Global test accuracy: 42.60
Round  46, Train loss: 0.777, Test loss: 1.916, Test accuracy: 38.60
Round  46, Global train loss: 0.777, Global test loss: 1.543, Global test accuracy: 46.80
Round  47, Train loss: 0.717, Test loss: 1.942, Test accuracy: 38.90
Round  47, Global train loss: 0.717, Global test loss: 1.549, Global test accuracy: 48.80
Round  48, Train loss: 0.824, Test loss: 1.944, Test accuracy: 39.20
Round  48, Global train loss: 0.824, Global test loss: 1.671, Global test accuracy: 37.80
Round  49, Train loss: 0.726, Test loss: 1.983, Test accuracy: 39.72
Round  49, Global train loss: 0.726, Global test loss: 1.528, Global test accuracy: 45.80
Round  50, Train loss: 0.683, Test loss: 2.000, Test accuracy: 39.52
Round  50, Global train loss: 0.683, Global test loss: 1.914, Global test accuracy: 39.80
Round  51, Train loss: 0.952, Test loss: 2.014, Test accuracy: 38.94
Round  51, Global train loss: 0.952, Global test loss: 1.655, Global test accuracy: 38.40
Round  52, Train loss: 0.886, Test loss: 2.031, Test accuracy: 39.40
Round  52, Global train loss: 0.886, Global test loss: 1.711, Global test accuracy: 41.00
Round  53, Train loss: 0.946, Test loss: 2.058, Test accuracy: 38.38
Round  53, Global train loss: 0.946, Global test loss: 1.739, Global test accuracy: 32.60
Round  54, Train loss: 0.679, Test loss: 2.087, Test accuracy: 37.50
Round  54, Global train loss: 0.679, Global test loss: 1.914, Global test accuracy: 40.40
Round  55, Train loss: 0.847, Test loss: 2.156, Test accuracy: 38.84
Round  55, Global train loss: 0.847, Global test loss: 1.882, Global test accuracy: 37.40
Round  56, Train loss: 0.548, Test loss: 2.196, Test accuracy: 39.72
Round  56, Global train loss: 0.548, Global test loss: 1.893, Global test accuracy: 47.60
Round  57, Train loss: 0.743, Test loss: 2.191, Test accuracy: 39.84
Round  57, Global train loss: 0.743, Global test loss: 1.954, Global test accuracy: 40.80
Round  58, Train loss: 0.624, Test loss: 2.342, Test accuracy: 39.06
Round  58, Global train loss: 0.624, Global test loss: 2.070, Global test accuracy: 44.40
Round  59, Train loss: 0.552, Test loss: 2.345, Test accuracy: 38.50
Round  59, Global train loss: 0.552, Global test loss: 1.815, Global test accuracy: 37.60
Round  60, Train loss: 0.747, Test loss: 2.326, Test accuracy: 38.68
Round  60, Global train loss: 0.747, Global test loss: 1.946, Global test accuracy: 39.20
Round  61, Train loss: 0.595, Test loss: 2.432, Test accuracy: 37.30
Round  61, Global train loss: 0.595, Global test loss: 2.131, Global test accuracy: 39.80
Round  62, Train loss: 0.462, Test loss: 2.504, Test accuracy: 36.40
Round  62, Global train loss: 0.462, Global test loss: 2.169, Global test accuracy: 44.00
Round  63, Train loss: 0.561, Test loss: 2.461, Test accuracy: 36.98
Round  63, Global train loss: 0.561, Global test loss: 2.090, Global test accuracy: 40.00
Round  64, Train loss: 0.672, Test loss: 2.454, Test accuracy: 37.52
Round  64, Global train loss: 0.672, Global test loss: 1.746, Global test accuracy: 41.80
Round  65, Train loss: 0.412, Test loss: 2.483, Test accuracy: 37.40
Round  65, Global train loss: 0.412, Global test loss: 1.812, Global test accuracy: 48.80
Round  66, Train loss: 0.547, Test loss: 2.480, Test accuracy: 37.94
Round  66, Global train loss: 0.547, Global test loss: 2.014, Global test accuracy: 41.00
Round  67, Train loss: 0.421, Test loss: 2.527, Test accuracy: 37.80
Round  67, Global train loss: 0.421, Global test loss: 2.168, Global test accuracy: 41.80
Round  68, Train loss: 0.420, Test loss: 2.685, Test accuracy: 37.00
Round  68, Global train loss: 0.420, Global test loss: 2.097, Global test accuracy: 44.60
Round  69, Train loss: 0.604, Test loss: 2.806, Test accuracy: 36.10
Round  69, Global train loss: 0.604, Global test loss: 2.045, Global test accuracy: 37.80
Round  70, Train loss: 0.429, Test loss: 2.820, Test accuracy: 36.34
Round  70, Global train loss: 0.429, Global test loss: 2.347, Global test accuracy: 37.60
Round  71, Train loss: 0.429, Test loss: 2.785, Test accuracy: 36.62
Round  71, Global train loss: 0.429, Global test loss: 2.280, Global test accuracy: 39.60
Round  72, Train loss: 0.490, Test loss: 2.688, Test accuracy: 36.88
Round  72, Global train loss: 0.490, Global test loss: 1.825, Global test accuracy: 46.60
Round  73, Train loss: 0.335, Test loss: 2.624, Test accuracy: 37.70
Round  73, Global train loss: 0.335, Global test loss: 2.180, Global test accuracy: 43.00
Round  74, Train loss: 0.555, Test loss: 2.654, Test accuracy: 38.00
Round  74, Global train loss: 0.555, Global test loss: 2.353, Global test accuracy: 31.20
Round  75, Train loss: 0.353, Test loss: 2.728, Test accuracy: 37.48
Round  75, Global train loss: 0.353, Global test loss: 2.134, Global test accuracy: 44.80
Round  76, Train loss: 0.403, Test loss: 2.883, Test accuracy: 36.74
Round  76, Global train loss: 0.403, Global test loss: 2.482, Global test accuracy: 38.40
Round  77, Train loss: 0.445, Test loss: 2.931, Test accuracy: 36.60
Round  77, Global train loss: 0.445, Global test loss: 2.355, Global test accuracy: 40.80
Round  78, Train loss: 0.426, Test loss: 3.004, Test accuracy: 36.82
Round  78, Global train loss: 0.426, Global test loss: 2.338, Global test accuracy: 39.60
Round  79, Train loss: 0.377, Test loss: 2.902, Test accuracy: 38.00
Round  79, Global train loss: 0.377, Global test loss: 2.221, Global test accuracy: 39.60
Round  80, Train loss: 0.335, Test loss: 2.915, Test accuracy: 36.96
Round  80, Global train loss: 0.335, Global test loss: 2.130, Global test accuracy: 45.60
Round  81, Train loss: 0.399, Test loss: 2.938, Test accuracy: 37.32
Round  81, Global train loss: 0.399, Global test loss: 2.053, Global test accuracy: 42.80
Round  82, Train loss: 0.311, Test loss: 2.878, Test accuracy: 37.70
Round  82, Global train loss: 0.311, Global test loss: 2.769, Global test accuracy: 38.80
Round  83, Train loss: 0.301, Test loss: 2.877, Test accuracy: 37.56
Round  83, Global train loss: 0.301, Global test loss: 2.192, Global test accuracy: 45.20
Round  84, Train loss: 0.343, Test loss: 2.942, Test accuracy: 37.28
Round  84, Global train loss: 0.343, Global test loss: 2.659, Global test accuracy: 40.00
Round  85, Train loss: 0.372, Test loss: 3.051, Test accuracy: 37.28
Round  85, Global train loss: 0.372, Global test loss: 2.937, Global test accuracy: 32.20
Round  86, Train loss: 0.262, Test loss: 3.071, Test accuracy: 36.72
Round  86, Global train loss: 0.262, Global test loss: 3.233, Global test accuracy: 31.80
Round  87, Train loss: 0.283, Test loss: 3.096, Test accuracy: 36.60
Round  87, Global train loss: 0.283, Global test loss: 2.640, Global test accuracy: 40.60
Round  88, Train loss: 0.172, Test loss: 3.118, Test accuracy: 36.42
Round  88, Global train loss: 0.172, Global test loss: 3.293, Global test accuracy: 36.80
Round  89, Train loss: 0.259, Test loss: 3.223, Test accuracy: 36.34
Round  89, Global train loss: 0.259, Global test loss: 3.403, Global test accuracy: 34.80
Round  90, Train loss: 0.277, Test loss: 3.357, Test accuracy: 36.44
Round  90, Global train loss: 0.277, Global test loss: 2.566, Global test accuracy: 40.20
Round  91, Train loss: 0.405, Test loss: 3.364, Test accuracy: 36.66
Round  91, Global train loss: 0.405, Global test loss: 2.296, Global test accuracy: 39.60
Round  92, Train loss: 0.342, Test loss: 3.348, Test accuracy: 36.66
Round  92, Global train loss: 0.342, Global test loss: 2.593, Global test accuracy: 37.20
Round  93, Train loss: 0.265, Test loss: 3.297, Test accuracy: 36.60
Round  93, Global train loss: 0.265, Global test loss: 3.043, Global test accuracy: 34.80
Round  94, Train loss: 0.325, Test loss: 3.274, Test accuracy: 37.06
Round  94, Global train loss: 0.325, Global test loss: 2.675, Global test accuracy: 36.00/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.250, Test loss: 3.272, Test accuracy: 37.24
Round  95, Global train loss: 0.250, Global test loss: 2.725, Global test accuracy: 45.80
Round  96, Train loss: 0.191, Test loss: 3.359, Test accuracy: 37.40
Round  96, Global train loss: 0.191, Global test loss: 3.390, Global test accuracy: 37.00
Round  97, Train loss: 0.333, Test loss: 3.401, Test accuracy: 37.04
Round  97, Global train loss: 0.333, Global test loss: 2.709, Global test accuracy: 37.00
Round  98, Train loss: 0.191, Test loss: 3.339, Test accuracy: 37.58
Round  98, Global train loss: 0.191, Global test loss: 2.857, Global test accuracy: 45.20
Round  99, Train loss: 0.242, Test loss: 3.310, Test accuracy: 37.98
Round  99, Global train loss: 0.242, Global test loss: 3.047, Global test accuracy: 37.60
Final Round, Train loss: 0.215, Test loss: 3.804, Test accuracy: 35.18
Final Round, Global train loss: 0.215, Global test loss: 3.047, Global test accuracy: 37.60
Average accuracy final 10 rounds: 37.066 

Average global accuracy final 10 rounds: 39.04 

837.3880426883698
[1.6368129253387451, 3.2736258506774902, 4.636957406997681, 6.000288963317871, 7.336429834365845, 8.672570705413818, 9.957115173339844, 11.24165964126587, 12.621362924575806, 14.001066207885742, 15.337736129760742, 16.674406051635742, 17.905453205108643, 19.136500358581543, 20.45099902153015, 21.76549768447876, 23.041628122329712, 24.317758560180664, 25.570814847946167, 26.82387113571167, 28.144658088684082, 29.465445041656494, 30.74859070777893, 32.03173637390137, 33.37982749938965, 34.72791862487793, 35.9879195690155, 37.247920513153076, 38.486878395080566, 39.72583627700806, 40.98823118209839, 42.25062608718872, 43.50843834877014, 44.76625061035156, 46.118921756744385, 47.47159290313721, 48.83845543861389, 50.205317974090576, 51.527087688446045, 52.848857402801514, 54.18479323387146, 55.520729064941406, 56.802491664886475, 58.08425426483154, 59.51074552536011, 60.93723678588867, 62.328874588012695, 63.72051239013672, 65.11201214790344, 66.50351190567017, 67.87459373474121, 69.24567556381226, 70.49129176139832, 71.73690795898438, 72.98607587814331, 74.23524379730225, 75.52848958969116, 76.82173538208008, 78.0489649772644, 79.27619457244873, 80.64311289787292, 82.01003122329712, 83.34646964073181, 84.6829080581665, 85.9550404548645, 87.2271728515625, 88.45985007286072, 89.69252729415894, 90.91660690307617, 92.14068651199341, 93.43574547767639, 94.73080444335938, 96.08598113059998, 97.44115781784058, 98.79266571998596, 100.14417362213135, 101.4474127292633, 102.75065183639526, 104.00944137573242, 105.26823091506958, 106.5040111541748, 107.73979139328003, 108.96150636672974, 110.18322134017944, 111.41556811332703, 112.64791488647461, 113.89228749275208, 115.13666009902954, 116.40292167663574, 117.66918325424194, 118.90200209617615, 120.13482093811035, 121.38222002983093, 122.62961912155151, 123.85670280456543, 125.08378648757935, 126.32211661338806, 127.56044673919678, 128.79581236839294, 130.0311779975891, 131.2690405845642, 132.5069031715393, 133.7578363418579, 135.0087695121765, 136.2594563961029, 137.5101432800293, 138.74372553825378, 139.97730779647827, 141.1977949142456, 142.41828203201294, 143.6646168231964, 144.91095161437988, 146.15752267837524, 147.4040937423706, 148.63467693328857, 149.86526012420654, 151.1160271167755, 152.36679410934448, 153.8112473487854, 155.25570058822632, 156.58465337753296, 157.9136061668396, 159.15568041801453, 160.39775466918945, 161.6227262020111, 162.84769773483276, 164.10273385047913, 165.3577699661255, 166.65405464172363, 167.95033931732178, 169.17172145843506, 170.39310359954834, 171.61073279380798, 172.82836198806763, 174.16433572769165, 175.50030946731567, 176.7591426372528, 178.01797580718994, 179.3573727607727, 180.69676971435547, 181.9392409324646, 183.18171215057373, 184.43263387680054, 185.68355560302734, 186.91978669166565, 188.15601778030396, 189.42087602615356, 190.68573427200317, 192.09939646720886, 193.51305866241455, 194.77855491638184, 196.04405117034912, 197.31065320968628, 198.57725524902344, 199.83832907676697, 201.0994029045105, 202.3574206829071, 203.6154384613037, 204.86253666877747, 206.10963487625122, 207.46919965744019, 208.82876443862915, 210.13038182258606, 211.43199920654297, 212.68745231628418, 213.9429054260254, 215.2776882648468, 216.6124711036682, 217.91392493247986, 219.2153787612915, 220.44307136535645, 221.6707639694214, 222.88954377174377, 224.10832357406616, 225.32798409461975, 226.54764461517334, 227.82298707962036, 229.09832954406738, 230.5091540813446, 231.91997861862183, 233.14175939559937, 234.3635401725769, 235.57137155532837, 236.77920293807983, 238.01730918884277, 239.2554154396057, 240.4891288280487, 241.7228422164917, 242.9778380393982, 244.2328338623047, 245.49327087402344, 246.7537078857422, 248.0158393383026, 249.27797079086304, 250.50261330604553, 251.72725582122803, 252.9968981742859, 254.26654052734375, 255.57158827781677, 256.8766360282898, 259.5357415676117, 262.1948471069336]
[32.68, 32.68, 35.88, 35.88, 37.72, 37.72, 34.5, 34.5, 36.44, 36.44, 39.34, 39.34, 39.04, 39.04, 40.78, 40.78, 42.5, 42.5, 42.94, 42.94, 41.8, 41.8, 43.42, 43.42, 43.52, 43.52, 44.26, 44.26, 46.06, 46.06, 44.02, 44.02, 43.4, 43.4, 43.58, 43.58, 42.46, 42.46, 43.42, 43.42, 45.04, 45.04, 46.16, 46.16, 46.16, 46.16, 47.86, 47.86, 47.48, 47.48, 46.44, 46.44, 47.22, 47.22, 45.94, 45.94, 46.12, 46.12, 45.5, 45.5, 42.96, 42.96, 42.02, 42.02, 42.48, 42.48, 42.68, 42.68, 39.68, 39.68, 39.62, 39.62, 39.2, 39.2, 39.22, 39.22, 40.94, 40.94, 42.06, 42.06, 42.2, 42.2, 40.44, 40.44, 40.08, 40.08, 39.32, 39.32, 38.18, 38.18, 38.14, 38.14, 38.6, 38.6, 38.9, 38.9, 39.2, 39.2, 39.72, 39.72, 39.52, 39.52, 38.94, 38.94, 39.4, 39.4, 38.38, 38.38, 37.5, 37.5, 38.84, 38.84, 39.72, 39.72, 39.84, 39.84, 39.06, 39.06, 38.5, 38.5, 38.68, 38.68, 37.3, 37.3, 36.4, 36.4, 36.98, 36.98, 37.52, 37.52, 37.4, 37.4, 37.94, 37.94, 37.8, 37.8, 37.0, 37.0, 36.1, 36.1, 36.34, 36.34, 36.62, 36.62, 36.88, 36.88, 37.7, 37.7, 38.0, 38.0, 37.48, 37.48, 36.74, 36.74, 36.6, 36.6, 36.82, 36.82, 38.0, 38.0, 36.96, 36.96, 37.32, 37.32, 37.7, 37.7, 37.56, 37.56, 37.28, 37.28, 37.28, 37.28, 36.72, 36.72, 36.6, 36.6, 36.42, 36.42, 36.34, 36.34, 36.44, 36.44, 36.66, 36.66, 36.66, 36.66, 36.6, 36.6, 37.06, 37.06, 37.24, 37.24, 37.4, 37.4, 37.04, 37.04, 37.58, 37.58, 37.98, 37.98, 35.18, 35.18]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.532, Test loss: 1.567, Test accuracy: 33.86
Round   0, Global train loss: 1.532, Global test loss: 1.565, Global test accuracy: 35.20
Round   1, Train loss: 1.502, Test loss: 1.515, Test accuracy: 34.66
Round   1, Global train loss: 1.502, Global test loss: 1.488, Global test accuracy: 36.20
Round   2, Train loss: 1.408, Test loss: 1.486, Test accuracy: 38.00
Round   2, Global train loss: 1.408, Global test loss: 1.404, Global test accuracy: 48.60
Round   3, Train loss: 1.437, Test loss: 1.490, Test accuracy: 39.18
Round   3, Global train loss: 1.437, Global test loss: 1.434, Global test accuracy: 49.20
Round   4, Train loss: 1.490, Test loss: 1.474, Test accuracy: 40.86
Round   4, Global train loss: 1.490, Global test loss: 1.432, Global test accuracy: 49.80
Round   5, Train loss: 1.399, Test loss: 1.463, Test accuracy: 41.16
Round   5, Global train loss: 1.399, Global test loss: 1.387, Global test accuracy: 48.80
Round   6, Train loss: 1.399, Test loss: 1.451, Test accuracy: 43.00
Round   6, Global train loss: 1.399, Global test loss: 1.374, Global test accuracy: 52.20
Round   7, Train loss: 1.474, Test loss: 1.444, Test accuracy: 43.24
Round   7, Global train loss: 1.474, Global test loss: 1.353, Global test accuracy: 53.00
Round   8, Train loss: 1.475, Test loss: 1.438, Test accuracy: 45.92
Round   8, Global train loss: 1.475, Global test loss: 1.386, Global test accuracy: 53.60
Round   9, Train loss: 1.318, Test loss: 1.442, Test accuracy: 46.78
Round   9, Global train loss: 1.318, Global test loss: 1.310, Global test accuracy: 55.80
Round  10, Train loss: 1.266, Test loss: 1.443, Test accuracy: 45.42
Round  10, Global train loss: 1.266, Global test loss: 1.333, Global test accuracy: 55.60
Round  11, Train loss: 1.343, Test loss: 1.441, Test accuracy: 47.52
Round  11, Global train loss: 1.343, Global test loss: 1.349, Global test accuracy: 54.40
Round  12, Train loss: 1.433, Test loss: 1.434, Test accuracy: 47.76
Round  12, Global train loss: 1.433, Global test loss: 1.331, Global test accuracy: 57.40
Round  13, Train loss: 1.195, Test loss: 1.428, Test accuracy: 48.20
Round  13, Global train loss: 1.195, Global test loss: 1.272, Global test accuracy: 55.40
Round  14, Train loss: 1.366, Test loss: 1.417, Test accuracy: 47.80
Round  14, Global train loss: 1.366, Global test loss: 1.338, Global test accuracy: 53.20
Round  15, Train loss: 1.298, Test loss: 1.423, Test accuracy: 46.76
Round  15, Global train loss: 1.298, Global test loss: 1.337, Global test accuracy: 50.20
Round  16, Train loss: 1.201, Test loss: 1.399, Test accuracy: 47.62
Round  16, Global train loss: 1.201, Global test loss: 1.270, Global test accuracy: 52.40
Round  17, Train loss: 1.282, Test loss: 1.405, Test accuracy: 47.80
Round  17, Global train loss: 1.282, Global test loss: 1.293, Global test accuracy: 57.60
Round  18, Train loss: 1.238, Test loss: 1.401, Test accuracy: 49.06
Round  18, Global train loss: 1.238, Global test loss: 1.251, Global test accuracy: 57.60
Round  19, Train loss: 1.333, Test loss: 1.391, Test accuracy: 49.50
Round  19, Global train loss: 1.333, Global test loss: 1.249, Global test accuracy: 57.40
Round  20, Train loss: 1.159, Test loss: 1.396, Test accuracy: 49.10
Round  20, Global train loss: 1.159, Global test loss: 1.193, Global test accuracy: 60.00
Round  21, Train loss: 1.477, Test loss: 1.412, Test accuracy: 46.58
Round  21, Global train loss: 1.477, Global test loss: 1.421, Global test accuracy: 45.20
Round  22, Train loss: 1.070, Test loss: 1.452, Test accuracy: 45.70
Round  22, Global train loss: 1.070, Global test loss: 1.149, Global test accuracy: 60.20
Round  23, Train loss: 1.291, Test loss: 1.435, Test accuracy: 45.36
Round  23, Global train loss: 1.291, Global test loss: 1.256, Global test accuracy: 51.40
Round  24, Train loss: 1.104, Test loss: 1.417, Test accuracy: 45.06
Round  24, Global train loss: 1.104, Global test loss: 1.225, Global test accuracy: 52.40
Round  25, Train loss: 1.178, Test loss: 1.426, Test accuracy: 44.92
Round  25, Global train loss: 1.178, Global test loss: 1.309, Global test accuracy: 51.20
Round  26, Train loss: 1.320, Test loss: 1.439, Test accuracy: 44.28
Round  26, Global train loss: 1.320, Global test loss: 1.296, Global test accuracy: 53.80
Round  27, Train loss: 1.058, Test loss: 1.438, Test accuracy: 44.84
Round  27, Global train loss: 1.058, Global test loss: 1.219, Global test accuracy: 51.00
Round  28, Train loss: 1.111, Test loss: 1.454, Test accuracy: 44.46
Round  28, Global train loss: 1.111, Global test loss: 1.208, Global test accuracy: 53.40
Round  29, Train loss: 1.101, Test loss: 1.491, Test accuracy: 43.68
Round  29, Global train loss: 1.101, Global test loss: 1.282, Global test accuracy: 49.40
Round  30, Train loss: 1.179, Test loss: 1.544, Test accuracy: 42.86
Round  30, Global train loss: 1.179, Global test loss: 1.502, Global test accuracy: 44.60
Round  31, Train loss: 0.985, Test loss: 1.532, Test accuracy: 43.04
Round  31, Global train loss: 0.985, Global test loss: 1.234, Global test accuracy: 52.60
Round  32, Train loss: 0.883, Test loss: 1.582, Test accuracy: 42.38
Round  32, Global train loss: 0.883, Global test loss: 1.535, Global test accuracy: 45.60
Round  33, Train loss: 0.903, Test loss: 1.587, Test accuracy: 43.00
Round  33, Global train loss: 0.903, Global test loss: 1.230, Global test accuracy: 53.60
Round  34, Train loss: 1.167, Test loss: 1.634, Test accuracy: 42.20
Round  34, Global train loss: 1.167, Global test loss: 1.442, Global test accuracy: 44.20
Round  35, Train loss: 0.897, Test loss: 1.684, Test accuracy: 41.40
Round  35, Global train loss: 0.897, Global test loss: 1.534, Global test accuracy: 49.60
Round  36, Train loss: 0.915, Test loss: 1.705, Test accuracy: 41.78
Round  36, Global train loss: 0.915, Global test loss: 1.670, Global test accuracy: 41.20
Round  37, Train loss: 0.683, Test loss: 1.738, Test accuracy: 41.50
Round  37, Global train loss: 0.683, Global test loss: 1.734, Global test accuracy: 48.20
Round  38, Train loss: 1.040, Test loss: 1.752, Test accuracy: 41.72
Round  38, Global train loss: 1.040, Global test loss: 1.743, Global test accuracy: 37.80
Round  39, Train loss: 1.117, Test loss: 1.800, Test accuracy: 41.18
Round  39, Global train loss: 1.117, Global test loss: 1.509, Global test accuracy: 44.20
Round  40, Train loss: 0.782, Test loss: 1.830, Test accuracy: 40.48
Round  40, Global train loss: 0.782, Global test loss: 1.385, Global test accuracy: 51.60
Round  41, Train loss: 0.725, Test loss: 1.855, Test accuracy: 40.68
Round  41, Global train loss: 0.725, Global test loss: 1.752, Global test accuracy: 45.60
Round  42, Train loss: 0.771, Test loss: 1.901, Test accuracy: 41.06
Round  42, Global train loss: 0.771, Global test loss: 1.741, Global test accuracy: 39.40
Round  43, Train loss: 0.809, Test loss: 1.980, Test accuracy: 40.20
Round  43, Global train loss: 0.809, Global test loss: 1.695, Global test accuracy: 44.60
Round  44, Train loss: 0.890, Test loss: 1.961, Test accuracy: 40.62
Round  44, Global train loss: 0.890, Global test loss: 1.527, Global test accuracy: 47.40
Round  45, Train loss: 0.618, Test loss: 1.997, Test accuracy: 40.32
Round  45, Global train loss: 0.618, Global test loss: 1.687, Global test accuracy: 48.80
Round  46, Train loss: 0.845, Test loss: 2.051, Test accuracy: 39.96
Round  46, Global train loss: 0.845, Global test loss: 1.831, Global test accuracy: 39.20
Round  47, Train loss: 0.708, Test loss: 2.186, Test accuracy: 39.24
Round  47, Global train loss: 0.708, Global test loss: 2.025, Global test accuracy: 41.20
Round  48, Train loss: 0.710, Test loss: 2.233, Test accuracy: 39.16
Round  48, Global train loss: 0.710, Global test loss: 1.706, Global test accuracy: 46.40
Round  49, Train loss: 0.620, Test loss: 2.300, Test accuracy: 39.76
Round  49, Global train loss: 0.620, Global test loss: 1.684, Global test accuracy: 49.80
Round  50, Train loss: 0.554, Test loss: 2.332, Test accuracy: 39.82
Round  50, Global train loss: 0.554, Global test loss: 2.070, Global test accuracy: 41.20
Round  51, Train loss: 0.916, Test loss: 2.341, Test accuracy: 39.94
Round  51, Global train loss: 0.916, Global test loss: 1.787, Global test accuracy: 36.40
Round  52, Train loss: 0.724, Test loss: 2.398, Test accuracy: 39.72
Round  52, Global train loss: 0.724, Global test loss: 1.702, Global test accuracy: 43.60
Round  53, Train loss: 0.666, Test loss: 2.346, Test accuracy: 39.80
Round  53, Global train loss: 0.666, Global test loss: 1.604, Global test accuracy: 47.80
Round  54, Train loss: 0.518, Test loss: 2.368, Test accuracy: 40.14
Round  54, Global train loss: 0.518, Global test loss: 1.917, Global test accuracy: 47.40
Round  55, Train loss: 0.727, Test loss: 2.373, Test accuracy: 39.88
Round  55, Global train loss: 0.727, Global test loss: 1.982, Global test accuracy: 37.00
Round  56, Train loss: 0.512, Test loss: 2.440, Test accuracy: 39.22
Round  56, Global train loss: 0.512, Global test loss: 1.915, Global test accuracy: 45.20
Round  57, Train loss: 0.501, Test loss: 2.479, Test accuracy: 39.38
Round  57, Global train loss: 0.501, Global test loss: 1.932, Global test accuracy: 49.20
Round  58, Train loss: 0.583, Test loss: 2.579, Test accuracy: 38.76
Round  58, Global train loss: 0.583, Global test loss: 2.171, Global test accuracy: 40.60
Round  59, Train loss: 0.484, Test loss: 2.626, Test accuracy: 38.52
Round  59, Global train loss: 0.484, Global test loss: 2.201, Global test accuracy: 39.80
Round  60, Train loss: 0.550, Test loss: 2.608, Test accuracy: 37.70
Round  60, Global train loss: 0.550, Global test loss: 1.937, Global test accuracy: 45.60
Round  61, Train loss: 0.521, Test loss: 2.657, Test accuracy: 37.92
Round  61, Global train loss: 0.521, Global test loss: 2.239, Global test accuracy: 38.20
Round  62, Train loss: 0.348, Test loss: 2.709, Test accuracy: 37.96
Round  62, Global train loss: 0.348, Global test loss: 2.466, Global test accuracy: 44.00
Round  63, Train loss: 0.402, Test loss: 2.698, Test accuracy: 38.78
Round  63, Global train loss: 0.402, Global test loss: 1.940, Global test accuracy: 50.80
Round  64, Train loss: 0.576, Test loss: 2.758, Test accuracy: 39.60
Round  64, Global train loss: 0.576, Global test loss: 2.064, Global test accuracy: 41.60
Round  65, Train loss: 0.379, Test loss: 2.751, Test accuracy: 39.72
Round  65, Global train loss: 0.379, Global test loss: 2.063, Global test accuracy: 45.80
Round  66, Train loss: 0.434, Test loss: 2.749, Test accuracy: 39.68
Round  66, Global train loss: 0.434, Global test loss: 2.167, Global test accuracy: 41.60
Round  67, Train loss: 0.336, Test loss: 2.746, Test accuracy: 39.72
Round  67, Global train loss: 0.336, Global test loss: 2.002, Global test accuracy: 47.00
Round  68, Train loss: 0.447, Test loss: 2.831, Test accuracy: 38.80
Round  68, Global train loss: 0.447, Global test loss: 2.382, Global test accuracy: 35.00
Round  69, Train loss: 0.476, Test loss: 2.924, Test accuracy: 39.34
Round  69, Global train loss: 0.476, Global test loss: 1.908, Global test accuracy: 47.80
Round  70, Train loss: 0.371, Test loss: 2.963, Test accuracy: 39.58
Round  70, Global train loss: 0.371, Global test loss: 2.590, Global test accuracy: 42.00
Round  71, Train loss: 0.306, Test loss: 2.861, Test accuracy: 39.02
Round  71, Global train loss: 0.306, Global test loss: 2.041, Global test accuracy: 49.00
Round  72, Train loss: 0.483, Test loss: 2.836, Test accuracy: 39.06
Round  72, Global train loss: 0.483, Global test loss: 2.184, Global test accuracy: 41.80
Round  73, Train loss: 0.261, Test loss: 2.836, Test accuracy: 39.60
Round  73, Global train loss: 0.261, Global test loss: 2.047, Global test accuracy: 48.00
Round  74, Train loss: 0.378, Test loss: 2.895, Test accuracy: 39.56
Round  74, Global train loss: 0.378, Global test loss: 2.023, Global test accuracy: 47.60
Round  75, Train loss: 0.435, Test loss: 2.932, Test accuracy: 39.64
Round  75, Global train loss: 0.435, Global test loss: 2.513, Global test accuracy: 35.60
Round  76, Train loss: 0.342, Test loss: 2.911, Test accuracy: 38.82
Round  76, Global train loss: 0.342, Global test loss: 2.148, Global test accuracy: 44.40
Round  77, Train loss: 0.295, Test loss: 2.999, Test accuracy: 37.86
Round  77, Global train loss: 0.295, Global test loss: 2.365, Global test accuracy: 44.80
Round  78, Train loss: 0.393, Test loss: 3.036, Test accuracy: 38.08
Round  78, Global train loss: 0.393, Global test loss: 2.239, Global test accuracy: 39.80
Round  79, Train loss: 0.301, Test loss: 3.002, Test accuracy: 38.60
Round  79, Global train loss: 0.301, Global test loss: 2.072, Global test accuracy: 46.40
Round  80, Train loss: 0.343, Test loss: 3.030, Test accuracy: 39.06
Round  80, Global train loss: 0.343, Global test loss: 2.200, Global test accuracy: 44.60
Round  81, Train loss: 0.427, Test loss: 3.071, Test accuracy: 38.48
Round  81, Global train loss: 0.427, Global test loss: 2.347, Global test accuracy: 39.00
Round  82, Train loss: 0.182, Test loss: 3.251, Test accuracy: 37.40
Round  82, Global train loss: 0.182, Global test loss: 3.024, Global test accuracy: 44.20
Round  83, Train loss: 0.365, Test loss: 3.214, Test accuracy: 39.02
Round  83, Global train loss: 0.365, Global test loss: 2.573, Global test accuracy: 38.40
Round  84, Train loss: 0.310, Test loss: 3.238, Test accuracy: 38.62
Round  84, Global train loss: 0.310, Global test loss: 2.645, Global test accuracy: 44.60
Round  85, Train loss: 0.253, Test loss: 3.225, Test accuracy: 39.70
Round  85, Global train loss: 0.253, Global test loss: 2.903, Global test accuracy: 42.40
Round  86, Train loss: 0.237, Test loss: 3.132, Test accuracy: 39.60
Round  86, Global train loss: 0.237, Global test loss: 2.901, Global test accuracy: 36.20
Round  87, Train loss: 0.224, Test loss: 3.224, Test accuracy: 38.90
Round  87, Global train loss: 0.224, Global test loss: 3.053, Global test accuracy: 39.20
Round  88, Train loss: 0.151, Test loss: 3.275, Test accuracy: 38.60
Round  88, Global train loss: 0.151, Global test loss: 2.987, Global test accuracy: 44.60
Round  89, Train loss: 0.151, Test loss: 3.424, Test accuracy: 37.98
Round  89, Global train loss: 0.151, Global test loss: 3.039, Global test accuracy: 46.00
Round  90, Train loss: 0.289, Test loss: 3.413, Test accuracy: 37.62
Round  90, Global train loss: 0.289, Global test loss: 2.530, Global test accuracy: 39.20
Round  91, Train loss: 0.385, Test loss: 3.349, Test accuracy: 38.08
Round  91, Global train loss: 0.385, Global test loss: 2.267, Global test accuracy: 41.00
Round  92, Train loss: 0.276, Test loss: 3.296, Test accuracy: 38.04
Round  92, Global train loss: 0.276, Global test loss: 2.201, Global test accuracy: 48.60
Round  93, Train loss: 0.155, Test loss: 3.240, Test accuracy: 38.50
Round  93, Global train loss: 0.155, Global test loss: 2.680, Global test accuracy: 45.40
Round  94, Train loss: 0.291, Test loss: 3.245, Test accuracy: 38.88
Round  94, Global train loss: 0.291, Global test loss: 2.526, Global test accuracy: 41.20
Round  95, Train loss: 0.219, Test loss: 3.181, Test accuracy: 39.42
Round  95, Global train loss: 0.219, Global test loss: 2.700, Global test accuracy: 45.20
Round  96, Train loss: 0.104, Test loss: 3.181, Test accuracy: 39.28
Round  96, Global train loss: 0.104, Global test loss: 3.108, Global test accuracy: 45.40
Round  97, Train loss: 0.313, Test loss: 3.199, Test accuracy: 39.26
Round  97, Global train loss: 0.313, Global test loss: 2.618, Global test accuracy: 41.60
Round  98, Train loss: 0.199, Test loss: 3.196, Test accuracy: 39.78
Round  98, Global train loss: 0.199, Global test loss: 2.755, Global test accuracy: 44.80
Round  99, Train loss: 0.209, Test loss: 3.171, Test accuracy: 39.10
Round  99, Global train loss: 0.209, Global test loss: 2.665, Global test accuracy: 45.80
Final Round, Train loss: 0.210, Test loss: 3.740, Test accuracy: 37.86
Final Round, Global train loss: 0.210, Global test loss: 2.665, Global test accuracy: 45.80
Average accuracy final 10 rounds: 38.79599999999999
Average global accuracy final 10 rounds: 43.81999999999999
1217.7336966991425
[3.2402384281158447, 6.1384437084198, 9.062000513076782, 12.004377841949463, 14.920998811721802, 17.91850709915161, 20.85750436782837, 23.84619951248169, 26.88333225250244, 29.829380750656128, 32.98403835296631, 36.01428151130676, 39.106826305389404, 42.03060531616211, 44.93417549133301, 47.82306909561157, 50.87667441368103, 53.75306725502014, 56.65061378479004, 59.54526662826538, 62.46465754508972, 65.48385620117188, 68.4823248386383, 71.52882623672485, 74.52878332138062, 77.6002414226532, 80.697829246521, 83.7371141910553, 86.54915285110474, 89.4324803352356, 92.31216788291931, 95.21704983711243, 98.06554126739502, 101.08973431587219, 104.02537202835083, 106.95556259155273, 110.00867319107056, 112.96075201034546, 115.89683318138123, 118.80797696113586, 121.64305329322815, 124.61671161651611, 127.56029772758484, 130.58076071739197, 133.696031332016, 136.60793471336365, 139.52493977546692, 142.42574501037598, 145.36346650123596, 148.27077841758728, 151.2705056667328, 154.20356440544128, 157.2703502178192, 160.14383816719055, 163.03422570228577, 165.95937299728394, 168.8340983390808, 171.74669003486633, 174.66075539588928, 177.55265355110168, 180.47741603851318, 183.47462439537048, 186.48497605323792, 189.40376663208008, 192.28930640220642, 195.2155933380127, 198.17745161056519, 201.12191152572632, 204.02449345588684, 207.02347946166992, 209.96329474449158, 212.8514688014984, 215.8919780254364, 218.89881014823914, 221.87244033813477, 224.77107858657837, 227.67345786094666, 230.73991513252258, 233.73882675170898, 236.74094009399414, 239.60629057884216, 242.61665391921997, 245.86369633674622, 249.08331823349, 252.03969931602478, 255.02751088142395, 258.0206756591797, 260.95413279533386, 264.0633776187897, 267.0339138507843, 269.94972825050354, 272.8609483242035, 275.8192467689514, 278.9108555316925, 282.0405659675598, 285.17477798461914, 288.16360354423523, 291.24335741996765, 294.35028862953186, 297.3833465576172, 302.44384837150574]
[33.86, 34.66, 38.0, 39.18, 40.86, 41.16, 43.0, 43.24, 45.92, 46.78, 45.42, 47.52, 47.76, 48.2, 47.8, 46.76, 47.62, 47.8, 49.06, 49.5, 49.1, 46.58, 45.7, 45.36, 45.06, 44.92, 44.28, 44.84, 44.46, 43.68, 42.86, 43.04, 42.38, 43.0, 42.2, 41.4, 41.78, 41.5, 41.72, 41.18, 40.48, 40.68, 41.06, 40.2, 40.62, 40.32, 39.96, 39.24, 39.16, 39.76, 39.82, 39.94, 39.72, 39.8, 40.14, 39.88, 39.22, 39.38, 38.76, 38.52, 37.7, 37.92, 37.96, 38.78, 39.6, 39.72, 39.68, 39.72, 38.8, 39.34, 39.58, 39.02, 39.06, 39.6, 39.56, 39.64, 38.82, 37.86, 38.08, 38.6, 39.06, 38.48, 37.4, 39.02, 38.62, 39.7, 39.6, 38.9, 38.6, 37.98, 37.62, 38.08, 38.04, 38.5, 38.88, 39.42, 39.28, 39.26, 39.78, 39.1, 37.86]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.565, Test loss: 1.565, Test accuracy: 30.70
Round   0, Global train loss: 1.565, Global test loss: 1.562, Global test accuracy: 29.60
Round   1, Train loss: 1.541, Test loss: 1.525, Test accuracy: 37.82
Round   1, Global train loss: 1.541, Global test loss: 1.519, Global test accuracy: 38.20
Round   2, Train loss: 1.571, Test loss: 1.546, Test accuracy: 35.08
Round   2, Global train loss: 1.571, Global test loss: 1.539, Global test accuracy: 36.60
Round   3, Train loss: 1.489, Test loss: 1.492, Test accuracy: 39.44
Round   3, Global train loss: 1.489, Global test loss: 1.476, Global test accuracy: 38.80
Round   4, Train loss: 1.519, Test loss: 1.517, Test accuracy: 35.86
Round   4, Global train loss: 1.519, Global test loss: 1.513, Global test accuracy: 33.40
Round   5, Train loss: 1.595, Test loss: 1.534, Test accuracy: 34.58
Round   5, Global train loss: 1.595, Global test loss: 1.525, Global test accuracy: 36.40
Round   6, Train loss: 1.503, Test loss: 1.500, Test accuracy: 37.22
Round   6, Global train loss: 1.503, Global test loss: 1.467, Global test accuracy: 38.00
Round   7, Train loss: 1.518, Test loss: 1.488, Test accuracy: 37.84
Round   7, Global train loss: 1.518, Global test loss: 1.461, Global test accuracy: 36.20
Round   8, Train loss: 1.498, Test loss: 1.470, Test accuracy: 35.70
Round   8, Global train loss: 1.498, Global test loss: 1.453, Global test accuracy: 36.20
Round   9, Train loss: 1.490, Test loss: 1.481, Test accuracy: 37.00
Round   9, Global train loss: 1.490, Global test loss: 1.445, Global test accuracy: 40.00
Round  10, Train loss: 1.397, Test loss: 1.432, Test accuracy: 40.98
Round  10, Global train loss: 1.397, Global test loss: 1.374, Global test accuracy: 39.00
Round  11, Train loss: 1.533, Test loss: 1.464, Test accuracy: 38.44
Round  11, Global train loss: 1.533, Global test loss: 1.465, Global test accuracy: 36.60
Round  12, Train loss: 1.481, Test loss: 1.470, Test accuracy: 36.74
Round  12, Global train loss: 1.481, Global test loss: 1.417, Global test accuracy: 40.80
Round  13, Train loss: 1.313, Test loss: 1.441, Test accuracy: 40.36
Round  13, Global train loss: 1.313, Global test loss: 1.384, Global test accuracy: 39.00
Round  14, Train loss: 1.422, Test loss: 1.435, Test accuracy: 40.98
Round  14, Global train loss: 1.422, Global test loss: 1.369, Global test accuracy: 38.80
Round  15, Train loss: 1.394, Test loss: 1.444, Test accuracy: 39.98
Round  15, Global train loss: 1.394, Global test loss: 1.370, Global test accuracy: 38.80
Round  16, Train loss: 1.449, Test loss: 1.421, Test accuracy: 41.68
Round  16, Global train loss: 1.449, Global test loss: 1.336, Global test accuracy: 45.20
Round  17, Train loss: 1.509, Test loss: 1.460, Test accuracy: 38.44
Round  17, Global train loss: 1.509, Global test loss: 1.467, Global test accuracy: 36.60
Round  18, Train loss: 1.392, Test loss: 1.449, Test accuracy: 37.52
Round  18, Global train loss: 1.392, Global test loss: 1.350, Global test accuracy: 40.00
Round  19, Train loss: 1.315, Test loss: 1.418, Test accuracy: 40.58
Round  19, Global train loss: 1.315, Global test loss: 1.285, Global test accuracy: 46.00
Round  20, Train loss: 1.519, Test loss: 1.460, Test accuracy: 38.12
Round  20, Global train loss: 1.519, Global test loss: 1.473, Global test accuracy: 39.20
Round  21, Train loss: 1.368, Test loss: 1.399, Test accuracy: 41.64
Round  21, Global train loss: 1.368, Global test loss: 1.245, Global test accuracy: 49.60
Round  22, Train loss: 1.311, Test loss: 1.409, Test accuracy: 40.68
Round  22, Global train loss: 1.311, Global test loss: 1.284, Global test accuracy: 44.20
Round  23, Train loss: 1.427, Test loss: 1.413, Test accuracy: 40.66
Round  23, Global train loss: 1.427, Global test loss: 1.328, Global test accuracy: 44.80
Round  24, Train loss: 1.321, Test loss: 1.406, Test accuracy: 42.22
Round  24, Global train loss: 1.321, Global test loss: 1.266, Global test accuracy: 50.60
Round  25, Train loss: 1.385, Test loss: 1.436, Test accuracy: 40.28
Round  25, Global train loss: 1.385, Global test loss: 1.389, Global test accuracy: 41.00
Round  26, Train loss: 1.500, Test loss: 1.457, Test accuracy: 38.08
Round  26, Global train loss: 1.500, Global test loss: 1.471, Global test accuracy: 37.00
Round  27, Train loss: 1.144, Test loss: 1.368, Test accuracy: 45.22
Round  27, Global train loss: 1.144, Global test loss: 1.245, Global test accuracy: 50.20
Round  28, Train loss: 1.347, Test loss: 1.411, Test accuracy: 42.10
Round  28, Global train loss: 1.347, Global test loss: 1.338, Global test accuracy: 41.60
Round  29, Train loss: 1.294, Test loss: 1.408, Test accuracy: 41.86
Round  29, Global train loss: 1.294, Global test loss: 1.209, Global test accuracy: 48.60
Round  30, Train loss: 1.389, Test loss: 1.445, Test accuracy: 39.38
Round  30, Global train loss: 1.389, Global test loss: 1.435, Global test accuracy: 39.20
Round  31, Train loss: 1.325, Test loss: 1.453, Test accuracy: 39.20
Round  31, Global train loss: 1.325, Global test loss: 1.359, Global test accuracy: 41.80
Round  32, Train loss: 1.294, Test loss: 1.443, Test accuracy: 41.02
Round  32, Global train loss: 1.294, Global test loss: 1.301, Global test accuracy: 47.80
Round  33, Train loss: 1.454, Test loss: 1.477, Test accuracy: 39.12
Round  33, Global train loss: 1.454, Global test loss: 1.488, Global test accuracy: 41.00
Round  34, Train loss: 1.281, Test loss: 1.374, Test accuracy: 43.14
Round  34, Global train loss: 1.281, Global test loss: 1.182, Global test accuracy: 50.60
Round  35, Train loss: 1.205, Test loss: 1.424, Test accuracy: 42.00
Round  35, Global train loss: 1.205, Global test loss: 1.367, Global test accuracy: 46.80
Round  36, Train loss: 1.145, Test loss: 1.383, Test accuracy: 43.76
Round  36, Global train loss: 1.145, Global test loss: 1.227, Global test accuracy: 50.60
Round  37, Train loss: 1.243, Test loss: 1.430, Test accuracy: 42.32
Round  37, Global train loss: 1.243, Global test loss: 1.308, Global test accuracy: 48.40
Round  38, Train loss: 1.123, Test loss: 1.350, Test accuracy: 44.56
Round  38, Global train loss: 1.123, Global test loss: 1.183, Global test accuracy: 52.00
Round  39, Train loss: 1.371, Test loss: 1.364, Test accuracy: 44.10
Round  39, Global train loss: 1.371, Global test loss: 1.298, Global test accuracy: 48.40
Round  40, Train loss: 1.260, Test loss: 1.409, Test accuracy: 43.34
Round  40, Global train loss: 1.260, Global test loss: 1.345, Global test accuracy: 45.40
Round  41, Train loss: 1.167, Test loss: 1.468, Test accuracy: 41.90
Round  41, Global train loss: 1.167, Global test loss: 1.297, Global test accuracy: 50.60
Round  42, Train loss: 1.026, Test loss: 1.389, Test accuracy: 44.38
Round  42, Global train loss: 1.026, Global test loss: 1.266, Global test accuracy: 50.40
Round  43, Train loss: 1.267, Test loss: 1.349, Test accuracy: 46.52
Round  43, Global train loss: 1.267, Global test loss: 1.205, Global test accuracy: 55.40
Round  44, Train loss: 1.454, Test loss: 1.449, Test accuracy: 42.26
Round  44, Global train loss: 1.454, Global test loss: 1.486, Global test accuracy: 40.40
Round  45, Train loss: 1.189, Test loss: 1.463, Test accuracy: 41.64
Round  45, Global train loss: 1.189, Global test loss: 1.344, Global test accuracy: 46.20
Round  46, Train loss: 1.048, Test loss: 1.389, Test accuracy: 44.22
Round  46, Global train loss: 1.048, Global test loss: 1.210, Global test accuracy: 53.40
Round  47, Train loss: 1.065, Test loss: 1.381, Test accuracy: 45.66
Round  47, Global train loss: 1.065, Global test loss: 1.144, Global test accuracy: 54.40
Round  48, Train loss: 1.195, Test loss: 1.493, Test accuracy: 40.80
Round  48, Global train loss: 1.195, Global test loss: 1.407, Global test accuracy: 39.80
Round  49, Train loss: 1.089, Test loss: 1.396, Test accuracy: 44.78
Round  49, Global train loss: 1.089, Global test loss: 1.201, Global test accuracy: 52.40
Round  50, Train loss: 1.070, Test loss: 1.458, Test accuracy: 42.84
Round  50, Global train loss: 1.070, Global test loss: 1.356, Global test accuracy: 46.60
Round  51, Train loss: 1.220, Test loss: 1.464, Test accuracy: 40.82
Round  51, Global train loss: 1.220, Global test loss: 1.359, Global test accuracy: 45.40
Round  52, Train loss: 1.238, Test loss: 1.429, Test accuracy: 41.70
Round  52, Global train loss: 1.238, Global test loss: 1.353, Global test accuracy: 47.00
Round  53, Train loss: 1.423, Test loss: 1.467, Test accuracy: 40.66
Round  53, Global train loss: 1.423, Global test loss: 1.495, Global test accuracy: 35.80
Round  54, Train loss: 1.068, Test loss: 1.426, Test accuracy: 43.50
Round  54, Global train loss: 1.068, Global test loss: 1.297, Global test accuracy: 48.20
Round  55, Train loss: 1.234, Test loss: 1.537, Test accuracy: 38.74
Round  55, Global train loss: 1.234, Global test loss: 1.477, Global test accuracy: 38.00
Round  56, Train loss: 0.903, Test loss: 1.401, Test accuracy: 45.38
Round  56, Global train loss: 0.903, Global test loss: 1.301, Global test accuracy: 49.20
Round  57, Train loss: 1.157, Test loss: 1.549, Test accuracy: 40.80
Round  57, Global train loss: 1.157, Global test loss: 1.435, Global test accuracy: 44.40
Round  58, Train loss: 0.927, Test loss: 1.494, Test accuracy: 42.10
Round  58, Global train loss: 0.927, Global test loss: 1.363, Global test accuracy: 52.20
Round  59, Train loss: 0.993, Test loss: 1.527, Test accuracy: 41.54
Round  59, Global train loss: 0.993, Global test loss: 1.416, Global test accuracy: 44.20
Round  60, Train loss: 1.115, Test loss: 1.521, Test accuracy: 43.76
Round  60, Global train loss: 1.115, Global test loss: 1.380, Global test accuracy: 46.00
Round  61, Train loss: 0.949, Test loss: 1.489, Test accuracy: 42.76
Round  61, Global train loss: 0.949, Global test loss: 1.345, Global test accuracy: 48.00
Round  62, Train loss: 0.849, Test loss: 1.558, Test accuracy: 42.52
Round  62, Global train loss: 0.849, Global test loss: 1.478, Global test accuracy: 52.00
Round  63, Train loss: 0.974, Test loss: 1.601, Test accuracy: 41.00
Round  63, Global train loss: 0.974, Global test loss: 1.490, Global test accuracy: 42.80
Round  64, Train loss: 1.097, Test loss: 1.545, Test accuracy: 42.58
Round  64, Global train loss: 1.097, Global test loss: 1.320, Global test accuracy: 48.20
Round  65, Train loss: 0.880, Test loss: 1.588, Test accuracy: 41.98
Round  65, Global train loss: 0.880, Global test loss: 1.426, Global test accuracy: 49.00
Round  66, Train loss: 0.922, Test loss: 1.533, Test accuracy: 42.48
Round  66, Global train loss: 0.922, Global test loss: 1.414, Global test accuracy: 45.20
Round  67, Train loss: 0.848, Test loss: 1.697, Test accuracy: 37.74
Round  67, Global train loss: 0.848, Global test loss: 1.621, Global test accuracy: 41.20
Round  68, Train loss: 0.729, Test loss: 1.531, Test accuracy: 42.02
Round  68, Global train loss: 0.729, Global test loss: 1.368, Global test accuracy: 49.80
Round  69, Train loss: 1.071, Test loss: 1.654, Test accuracy: 41.76
Round  69, Global train loss: 1.071, Global test loss: 1.469, Global test accuracy: 43.80
Round  70, Train loss: 0.756, Test loss: 1.760, Test accuracy: 41.80
Round  70, Global train loss: 0.756, Global test loss: 1.750, Global test accuracy: 43.40
Round  71, Train loss: 0.924, Test loss: 1.815, Test accuracy: 39.18
Round  71, Global train loss: 0.924, Global test loss: 1.676, Global test accuracy: 42.40
Round  72, Train loss: 0.848, Test loss: 1.606, Test accuracy: 42.68
Round  72, Global train loss: 0.848, Global test loss: 1.404, Global test accuracy: 50.20
Round  73, Train loss: 0.782, Test loss: 1.788, Test accuracy: 39.30
Round  73, Global train loss: 0.782, Global test loss: 1.757, Global test accuracy: 40.20
Round  74, Train loss: 0.970, Test loss: 1.814, Test accuracy: 38.76
Round  74, Global train loss: 0.970, Global test loss: 1.684, Global test accuracy: 37.40
Round  75, Train loss: 0.646, Test loss: 1.684, Test accuracy: 41.54
Round  75, Global train loss: 0.646, Global test loss: 1.522, Global test accuracy: 48.00
Round  76, Train loss: 0.779, Test loss: 1.774, Test accuracy: 39.56
Round  76, Global train loss: 0.779, Global test loss: 1.726, Global test accuracy: 40.80
Round  77, Train loss: 0.847, Test loss: 1.796, Test accuracy: 39.48
Round  77, Global train loss: 0.847, Global test loss: 1.637, Global test accuracy: 43.60
Round  78, Train loss: 0.874, Test loss: 1.705, Test accuracy: 42.80
Round  78, Global train loss: 0.874, Global test loss: 1.383, Global test accuracy: 53.00
Round  79, Train loss: 0.868, Test loss: 1.803, Test accuracy: 40.86
Round  79, Global train loss: 0.868, Global test loss: 1.598, Global test accuracy: 42.40
Round  80, Train loss: 0.667, Test loss: 1.748, Test accuracy: 42.74
Round  80, Global train loss: 0.667, Global test loss: 1.494, Global test accuracy: 48.60
Round  81, Train loss: 0.810, Test loss: 1.704, Test accuracy: 43.32
Round  81, Global train loss: 0.810, Global test loss: 1.399, Global test accuracy: 51.40
Round  82, Train loss: 0.595, Test loss: 1.906, Test accuracy: 38.42
Round  82, Global train loss: 0.595, Global test loss: 1.991, Global test accuracy: 42.80
Round  83, Train loss: 0.534, Test loss: 1.692, Test accuracy: 42.26
Round  83, Global train loss: 0.534, Global test loss: 1.537, Global test accuracy: 48.00
Round  84, Train loss: 0.582, Test loss: 1.748, Test accuracy: 43.58
Round  84, Global train loss: 0.582, Global test loss: 1.739, Global test accuracy: 49.20
Round  85, Train loss: 0.668, Test loss: 1.961, Test accuracy: 37.88
Round  85, Global train loss: 0.668, Global test loss: 1.988, Global test accuracy: 35.80
Round  86, Train loss: 0.543, Test loss: 1.977, Test accuracy: 38.80
Round  86, Global train loss: 0.543, Global test loss: 2.063, Global test accuracy: 36.20
Round  87, Train loss: 0.409, Test loss: 1.964, Test accuracy: 42.26
Round  87, Global train loss: 0.409, Global test loss: 1.997, Global test accuracy: 45.80
Round  88, Train loss: 0.364, Test loss: 2.011, Test accuracy: 41.74
Round  88, Global train loss: 0.364, Global test loss: 2.284, Global test accuracy: 43.80
Round  89, Train loss: 0.484, Test loss: 2.127, Test accuracy: 37.02
Round  89, Global train loss: 0.484, Global test loss: 2.259, Global test accuracy: 40.60
Round  90, Train loss: 0.605, Test loss: 1.923, Test accuracy: 39.60
Round  90, Global train loss: 0.605, Global test loss: 1.793, Global test accuracy: 40.40
Round  91, Train loss: 0.833, Test loss: 1.880, Test accuracy: 41.02
Round  91, Global train loss: 0.833, Global test loss: 1.585, Global test accuracy: 42.20
Round  92, Train loss: 0.742, Test loss: 1.889, Test accuracy: 40.88
Round  92, Global train loss: 0.742, Global test loss: 1.660, Global test accuracy: 43.00
Round  93, Train loss: 0.447, Test loss: 2.178, Test accuracy: 39.14
Round  93, Global train loss: 0.447, Global test loss: 2.293, Global test accuracy: 41.40
Round  94, Train loss: 0.613, Test loss: 2.064, Test accuracy: 38.22
Round  94, Global train loss: 0.613, Global test loss: 1.881, Global test accuracy: 38.60
Round  95, Train loss: 0.513, Test loss: 1.939, Test accuracy: 41.58
Round  95, Global train loss: 0.513, Global test loss: 1.809, Global test accuracy: 47.60
Round  96, Train loss: 0.389, Test loss: 2.030, Test accuracy: 41.02
Round  96, Global train loss: 0.389, Global test loss: 2.093, Global test accuracy: 46.60
Round  97, Train loss: 0.627, Test loss: 2.036, Test accuracy: 40.30
Round  97, Global train loss: 0.627, Global test loss: 1.899, Global test accuracy: 39.80
Round  98, Train loss: 0.429, Test loss: 1.903, Test accuracy: 43.70
Round  98, Global train loss: 0.429, Global test loss: 1.714, Global test accuracy: 50.20
Round  99, Train loss: 0.431, Test loss: 2.084, Test accuracy: 40.80
Round  99, Global train loss: 0.431, Global test loss: 2.127, Global test accuracy: 44.20
Final Round, Train loss: 0.454, Test loss: 2.190, Test accuracy: 40.70
Final Round, Global train loss: 0.454, Global test loss: 2.127, Global test accuracy: 44.20
Average accuracy final 10 rounds: 40.626
733.0810215473175
[1.789745807647705, 3.2407476902008057, 4.720408916473389, 6.161796569824219, 7.612436771392822, 9.066374778747559, 10.545253276824951, 12.019473791122437, 13.512008428573608, 14.977652788162231, 16.431856393814087, 17.935060262680054, 19.363959312438965, 20.837286949157715, 22.312533378601074, 23.78173828125, 25.38888645172119, 26.916035652160645, 28.429591417312622, 29.890154600143433, 31.381103038787842, 32.808241844177246, 34.32583022117615, 35.81801390647888, 37.25486636161804, 38.71506857872009, 40.12706232070923, 41.538687229156494, 42.969051361083984, 44.389244079589844, 45.884411573410034, 47.296324491500854, 48.73214554786682, 50.24049091339111, 51.74903392791748, 53.22915244102478, 54.708351850509644, 56.173482179641724, 57.6504008769989, 59.26591968536377, 60.792293310165405, 62.26322340965271, 63.72890257835388, 65.21035194396973, 66.68883109092712, 68.16420221328735, 69.5910484790802, 71.01826453208923, 72.47339510917664, 74.04226875305176, 75.66393399238586, 77.18549919128418, 78.67195057868958, 80.18427109718323, 81.65298295021057, 83.1578094959259, 84.64013624191284, 86.17416524887085, 87.61677384376526, 89.04078412055969, 90.55760526657104, 92.01047277450562, 93.47096085548401, 94.95112824440002, 96.39201545715332, 97.83994507789612, 99.36805987358093, 100.9018783569336, 102.29702091217041, 103.7115592956543, 105.24139666557312, 106.65539574623108, 108.11394453048706, 109.51950645446777, 110.94185018539429, 112.34465193748474, 113.72861790657043, 115.15341472625732, 116.58881950378418, 118.02218818664551, 119.45442652702332, 120.90903162956238, 122.3215115070343, 123.70190382003784, 125.09933471679688, 126.64729166030884, 128.00551438331604, 129.34212708473206, 130.72161507606506, 132.05794048309326, 133.38552331924438, 134.73690032958984, 136.1976306438446, 137.67654180526733, 139.11359119415283, 140.52580499649048, 141.85214757919312, 143.18128633499146, 144.5387523174286, 145.9158148765564, 148.13311052322388]
[30.7, 37.82, 35.08, 39.44, 35.86, 34.58, 37.22, 37.84, 35.7, 37.0, 40.98, 38.44, 36.74, 40.36, 40.98, 39.98, 41.68, 38.44, 37.52, 40.58, 38.12, 41.64, 40.68, 40.66, 42.22, 40.28, 38.08, 45.22, 42.1, 41.86, 39.38, 39.2, 41.02, 39.12, 43.14, 42.0, 43.76, 42.32, 44.56, 44.1, 43.34, 41.9, 44.38, 46.52, 42.26, 41.64, 44.22, 45.66, 40.8, 44.78, 42.84, 40.82, 41.7, 40.66, 43.5, 38.74, 45.38, 40.8, 42.1, 41.54, 43.76, 42.76, 42.52, 41.0, 42.58, 41.98, 42.48, 37.74, 42.02, 41.76, 41.8, 39.18, 42.68, 39.3, 38.76, 41.54, 39.56, 39.48, 42.8, 40.86, 42.74, 43.32, 38.42, 42.26, 43.58, 37.88, 38.8, 42.26, 41.74, 37.02, 39.6, 41.02, 40.88, 39.14, 38.22, 41.58, 41.02, 40.3, 43.7, 40.8, 40.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.595, Test loss: 1.597, Test accuracy: 26.14
Round   0, Global train loss: 1.595, Global test loss: 1.589, Global test accuracy: 21.80
Round   1, Train loss: 1.555, Test loss: 1.582, Test accuracy: 29.46
Round   1, Global train loss: 1.555, Global test loss: 1.562, Global test accuracy: 33.60
Round   2, Train loss: 1.543, Test loss: 1.562, Test accuracy: 30.74
Round   2, Global train loss: 1.543, Global test loss: 1.533, Global test accuracy: 40.00
Round   3, Train loss: 1.531, Test loss: 1.531, Test accuracy: 32.88
Round   3, Global train loss: 1.531, Global test loss: 1.495, Global test accuracy: 43.40
Round   4, Train loss: 1.520, Test loss: 1.510, Test accuracy: 34.32
Round   4, Global train loss: 1.520, Global test loss: 1.473, Global test accuracy: 44.20
Round   5, Train loss: 1.512, Test loss: 1.485, Test accuracy: 36.54
Round   5, Global train loss: 1.512, Global test loss: 1.444, Global test accuracy: 45.20
Round   6, Train loss: 1.504, Test loss: 1.466, Test accuracy: 38.46
Round   6, Global train loss: 1.504, Global test loss: 1.425, Global test accuracy: 47.80
Round   7, Train loss: 1.497, Test loss: 1.451, Test accuracy: 39.16
Round   7, Global train loss: 1.497, Global test loss: 1.406, Global test accuracy: 48.80
Round   8, Train loss: 1.490, Test loss: 1.429, Test accuracy: 41.58
Round   8, Global train loss: 1.490, Global test loss: 1.380, Global test accuracy: 50.40
Round   9, Train loss: 1.481, Test loss: 1.419, Test accuracy: 42.98
Round   9, Global train loss: 1.481, Global test loss: 1.369, Global test accuracy: 51.40
Round  10, Train loss: 1.531, Test loss: 1.450, Test accuracy: 40.84
Round  10, Global train loss: 1.531, Global test loss: 1.447, Global test accuracy: 52.00
Round  11, Train loss: 1.393, Test loss: 1.449, Test accuracy: 39.78
Round  11, Global train loss: 1.393, Global test loss: 1.424, Global test accuracy: 38.60
Round  12, Train loss: 1.375, Test loss: 1.394, Test accuracy: 43.76
Round  12, Global train loss: 1.375, Global test loss: 1.297, Global test accuracy: 51.80
Round  13, Train loss: 1.399, Test loss: 1.472, Test accuracy: 41.30
Round  13, Global train loss: 1.399, Global test loss: 1.462, Global test accuracy: 43.20
Round  14, Train loss: 1.417, Test loss: 1.460, Test accuracy: 42.00
Round  14, Global train loss: 1.417, Global test loss: 1.424, Global test accuracy: 42.40
Round  15, Train loss: 1.374, Test loss: 1.396, Test accuracy: 44.34
Round  15, Global train loss: 1.374, Global test loss: 1.352, Global test accuracy: 46.40
Round  16, Train loss: 1.377, Test loss: 1.438, Test accuracy: 42.30
Round  16, Global train loss: 1.377, Global test loss: 1.423, Global test accuracy: 38.00
Round  17, Train loss: 1.361, Test loss: 1.432, Test accuracy: 41.94
Round  17, Global train loss: 1.361, Global test loss: 1.384, Global test accuracy: 42.40
Round  18, Train loss: 1.423, Test loss: 1.392, Test accuracy: 43.30
Round  18, Global train loss: 1.423, Global test loss: 1.347, Global test accuracy: 52.60
Round  19, Train loss: 1.346, Test loss: 1.356, Test accuracy: 46.44
Round  19, Global train loss: 1.346, Global test loss: 1.266, Global test accuracy: 50.80
Round  20, Train loss: 1.392, Test loss: 1.419, Test accuracy: 40.88
Round  20, Global train loss: 1.392, Global test loss: 1.374, Global test accuracy: 48.40
Round  21, Train loss: 1.328, Test loss: 1.366, Test accuracy: 43.48
Round  21, Global train loss: 1.328, Global test loss: 1.227, Global test accuracy: 55.20
Round  22, Train loss: 1.297, Test loss: 1.412, Test accuracy: 39.66
Round  22, Global train loss: 1.297, Global test loss: 1.340, Global test accuracy: 56.60
Round  23, Train loss: 1.360, Test loss: 1.437, Test accuracy: 39.34
Round  23, Global train loss: 1.360, Global test loss: 1.385, Global test accuracy: 44.40
Round  24, Train loss: 1.374, Test loss: 1.365, Test accuracy: 43.62
Round  24, Global train loss: 1.374, Global test loss: 1.318, Global test accuracy: 49.80
Round  25, Train loss: 1.343, Test loss: 1.374, Test accuracy: 43.10
Round  25, Global train loss: 1.343, Global test loss: 1.332, Global test accuracy: 44.20
Round  26, Train loss: 1.302, Test loss: 1.385, Test accuracy: 42.54
Round  26, Global train loss: 1.302, Global test loss: 1.320, Global test accuracy: 58.20
Round  27, Train loss: 1.318, Test loss: 1.321, Test accuracy: 47.92
Round  27, Global train loss: 1.318, Global test loss: 1.260, Global test accuracy: 52.80
Round  28, Train loss: 1.350, Test loss: 1.414, Test accuracy: 40.66
Round  28, Global train loss: 1.350, Global test loss: 1.453, Global test accuracy: 38.20
Round  29, Train loss: 1.361, Test loss: 1.372, Test accuracy: 43.96
Round  29, Global train loss: 1.361, Global test loss: 1.277, Global test accuracy: 58.00
Round  30, Train loss: 1.296, Test loss: 1.370, Test accuracy: 44.34
Round  30, Global train loss: 1.296, Global test loss: 1.317, Global test accuracy: 47.80
Round  31, Train loss: 1.337, Test loss: 1.404, Test accuracy: 41.44
Round  31, Global train loss: 1.337, Global test loss: 1.380, Global test accuracy: 49.40
Round  32, Train loss: 1.327, Test loss: 1.455, Test accuracy: 38.04
Round  32, Global train loss: 1.327, Global test loss: 1.435, Global test accuracy: 40.40
Round  33, Train loss: 1.328, Test loss: 1.466, Test accuracy: 37.54
Round  33, Global train loss: 1.328, Global test loss: 1.408, Global test accuracy: 45.20
Round  34, Train loss: 1.309, Test loss: 1.260, Test accuracy: 51.22
Round  34, Global train loss: 1.309, Global test loss: 1.119, Global test accuracy: 61.20
Round  35, Train loss: 1.274, Test loss: 1.344, Test accuracy: 46.76
Round  35, Global train loss: 1.274, Global test loss: 1.332, Global test accuracy: 47.60
Round  36, Train loss: 1.253, Test loss: 1.399, Test accuracy: 42.20
Round  36, Global train loss: 1.253, Global test loss: 1.351, Global test accuracy: 45.80
Round  37, Train loss: 1.268, Test loss: 1.406, Test accuracy: 41.88
Round  37, Global train loss: 1.268, Global test loss: 1.378, Global test accuracy: 45.40
Round  38, Train loss: 1.184, Test loss: 1.323, Test accuracy: 46.26
Round  38, Global train loss: 1.184, Global test loss: 1.234, Global test accuracy: 50.60
Round  39, Train loss: 1.281, Test loss: 1.350, Test accuracy: 45.58
Round  39, Global train loss: 1.281, Global test loss: 1.212, Global test accuracy: 53.80
Round  40, Train loss: 1.265, Test loss: 1.379, Test accuracy: 43.96
Round  40, Global train loss: 1.265, Global test loss: 1.251, Global test accuracy: 55.60
Round  41, Train loss: 1.235, Test loss: 1.443, Test accuracy: 40.36
Round  41, Global train loss: 1.235, Global test loss: 1.387, Global test accuracy: 40.40
Round  42, Train loss: 1.162, Test loss: 1.333, Test accuracy: 45.92
Round  42, Global train loss: 1.162, Global test loss: 1.266, Global test accuracy: 51.80
Round  43, Train loss: 1.219, Test loss: 1.307, Test accuracy: 47.64
Round  43, Global train loss: 1.219, Global test loss: 1.221, Global test accuracy: 50.00
Round  44, Train loss: 1.246, Test loss: 1.354, Test accuracy: 44.94
Round  44, Global train loss: 1.246, Global test loss: 1.309, Global test accuracy: 49.20
Round  45, Train loss: 1.224, Test loss: 1.383, Test accuracy: 43.54
Round  45, Global train loss: 1.224, Global test loss: 1.275, Global test accuracy: 52.00
Round  46, Train loss: 1.101, Test loss: 1.348, Test accuracy: 46.20
Round  46, Global train loss: 1.101, Global test loss: 1.250, Global test accuracy: 47.60
Round  47, Train loss: 1.088, Test loss: 1.363, Test accuracy: 45.50
Round  47, Global train loss: 1.088, Global test loss: 1.281, Global test accuracy: 45.80
Round  48, Train loss: 1.193, Test loss: 1.367, Test accuracy: 44.64
Round  48, Global train loss: 1.193, Global test loss: 1.251, Global test accuracy: 53.20
Round  49, Train loss: 1.124, Test loss: 1.402, Test accuracy: 44.58
Round  49, Global train loss: 1.124, Global test loss: 1.274, Global test accuracy: 50.80
Round  50, Train loss: 1.037, Test loss: 1.435, Test accuracy: 41.70
Round  50, Global train loss: 1.037, Global test loss: 1.394, Global test accuracy: 44.60
Round  51, Train loss: 1.103, Test loss: 1.346, Test accuracy: 45.92
Round  51, Global train loss: 1.103, Global test loss: 1.275, Global test accuracy: 48.40
Round  52, Train loss: 1.151, Test loss: 1.439, Test accuracy: 42.20
Round  52, Global train loss: 1.151, Global test loss: 1.378, Global test accuracy: 43.40
Round  53, Train loss: 1.214, Test loss: 1.465, Test accuracy: 42.14
Round  53, Global train loss: 1.214, Global test loss: 1.396, Global test accuracy: 46.00
Round  54, Train loss: 1.056, Test loss: 1.466, Test accuracy: 41.14
Round  54, Global train loss: 1.056, Global test loss: 1.430, Global test accuracy: 40.80
Round  55, Train loss: 1.064, Test loss: 1.429, Test accuracy: 42.98
Round  55, Global train loss: 1.064, Global test loss: 1.324, Global test accuracy: 48.80
Round  56, Train loss: 1.002, Test loss: 1.503, Test accuracy: 40.22
Round  56, Global train loss: 1.002, Global test loss: 1.480, Global test accuracy: 40.20
Round  57, Train loss: 1.227, Test loss: 1.593, Test accuracy: 37.78
Round  57, Global train loss: 1.227, Global test loss: 1.545, Global test accuracy: 40.20
Round  58, Train loss: 0.984, Test loss: 1.520, Test accuracy: 40.68
Round  58, Global train loss: 0.984, Global test loss: 1.502, Global test accuracy: 41.00
Round  59, Train loss: 0.926, Test loss: 1.493, Test accuracy: 40.88
Round  59, Global train loss: 0.926, Global test loss: 1.368, Global test accuracy: 45.60
Round  60, Train loss: 1.092, Test loss: 1.547, Test accuracy: 39.22
Round  60, Global train loss: 1.092, Global test loss: 1.474, Global test accuracy: 42.40
Round  61, Train loss: 0.970, Test loss: 1.456, Test accuracy: 42.32
Round  61, Global train loss: 0.970, Global test loss: 1.385, Global test accuracy: 44.00
Round  62, Train loss: 1.001, Test loss: 1.578, Test accuracy: 40.76
Round  62, Global train loss: 1.001, Global test loss: 1.569, Global test accuracy: 43.60
Round  63, Train loss: 1.034, Test loss: 1.634, Test accuracy: 39.42
Round  63, Global train loss: 1.034, Global test loss: 1.507, Global test accuracy: 43.20
Round  64, Train loss: 1.079, Test loss: 1.526, Test accuracy: 40.98
Round  64, Global train loss: 1.079, Global test loss: 1.442, Global test accuracy: 41.60
Round  65, Train loss: 0.944, Test loss: 1.666, Test accuracy: 36.14
Round  65, Global train loss: 0.944, Global test loss: 1.543, Global test accuracy: 42.00
Round  66, Train loss: 0.944, Test loss: 1.693, Test accuracy: 33.58
Round  66, Global train loss: 0.944, Global test loss: 1.606, Global test accuracy: 34.40
Round  67, Train loss: 0.853, Test loss: 1.620, Test accuracy: 39.86
Round  67, Global train loss: 0.853, Global test loss: 1.564, Global test accuracy: 43.60
Round  68, Train loss: 0.863, Test loss: 1.507, Test accuracy: 41.64
Round  68, Global train loss: 0.863, Global test loss: 1.411, Global test accuracy: 44.80
Round  69, Train loss: 1.005, Test loss: 1.569, Test accuracy: 39.82
Round  69, Global train loss: 1.005, Global test loss: 1.372, Global test accuracy: 49.20
Round  70, Train loss: 0.784, Test loss: 1.644, Test accuracy: 38.70
Round  70, Global train loss: 0.784, Global test loss: 1.640, Global test accuracy: 39.00
Round  71, Train loss: 0.896, Test loss: 1.721, Test accuracy: 35.76
Round  71, Global train loss: 0.896, Global test loss: 1.716, Global test accuracy: 37.20
Round  72, Train loss: 0.899, Test loss: 1.662, Test accuracy: 35.16
Round  72, Global train loss: 0.899, Global test loss: 1.572, Global test accuracy: 37.00
Round  73, Train loss: 0.881, Test loss: 1.726, Test accuracy: 36.12
Round  73, Global train loss: 0.881, Global test loss: 1.728, Global test accuracy: 37.60
Round  74, Train loss: 0.945, Test loss: 1.813, Test accuracy: 35.48
Round  74, Global train loss: 0.945, Global test loss: 1.718, Global test accuracy: 36.60
Round  75, Train loss: 0.751, Test loss: 1.622, Test accuracy: 42.68
Round  75, Global train loss: 0.751, Global test loss: 1.530, Global test accuracy: 44.40
Round  76, Train loss: 0.869, Test loss: 1.777, Test accuracy: 37.06
Round  76, Global train loss: 0.869, Global test loss: 1.750, Global test accuracy: 36.00
Round  77, Train loss: 0.902, Test loss: 1.844, Test accuracy: 32.10
Round  77, Global train loss: 0.902, Global test loss: 1.823, Global test accuracy: 32.40
Round  78, Train loss: 0.854, Test loss: 1.777, Test accuracy: 37.88
Round  78, Global train loss: 0.854, Global test loss: 1.626, Global test accuracy: 43.00
Round  79, Train loss: 0.818, Test loss: 1.749, Test accuracy: 35.06
Round  79, Global train loss: 0.818, Global test loss: 1.681, Global test accuracy: 38.60
Round  80, Train loss: 0.721, Test loss: 1.767, Test accuracy: 37.86
Round  80, Global train loss: 0.721, Global test loss: 1.730, Global test accuracy: 39.00
Round  81, Train loss: 0.644, Test loss: 1.823, Test accuracy: 37.94
Round  81, Global train loss: 0.644, Global test loss: 1.767, Global test accuracy: 41.00
Round  82, Train loss: 0.610, Test loss: 1.803, Test accuracy: 38.98
Round  82, Global train loss: 0.610, Global test loss: 1.753, Global test accuracy: 43.40
Round  83, Train loss: 0.565, Test loss: 1.938, Test accuracy: 36.64
Round  83, Global train loss: 0.565, Global test loss: 1.934, Global test accuracy: 40.00
Round  84, Train loss: 0.539, Test loss: 1.927, Test accuracy: 36.50
Round  84, Global train loss: 0.539, Global test loss: 1.923, Global test accuracy: 39.20
Round  85, Train loss: 0.518, Test loss: 1.957, Test accuracy: 36.60
Round  85, Global train loss: 0.518, Global test loss: 1.971, Global test accuracy: 39.20
Round  86, Train loss: 0.491, Test loss: 2.001, Test accuracy: 36.54
Round  86, Global train loss: 0.491, Global test loss: 2.016, Global test accuracy: 37.60
Round  87, Train loss: 0.461, Test loss: 1.958, Test accuracy: 36.98
Round  87, Global train loss: 0.461, Global test loss: 1.968, Global test accuracy: 38.00
Round  88, Train loss: 0.466, Test loss: 1.949, Test accuracy: 36.68
Round  88, Global train loss: 0.466, Global test loss: 1.956, Global test accuracy: 37.40
Round  89, Train loss: 0.435, Test loss: 2.058, Test accuracy: 35.16
Round  89, Global train loss: 0.435, Global test loss: 2.093, Global test accuracy: 35.40
Round  90, Train loss: 0.425, Test loss: 2.065, Test accuracy: 36.94
Round  90, Global train loss: 0.425, Global test loss: 2.098, Global test accuracy: 37.60
Round  91, Train loss: 0.417, Test loss: 2.045, Test accuracy: 36.34
Round  91, Global train loss: 0.417, Global test loss: 2.075, Global test accuracy: 37.00
Round  92, Train loss: 0.412, Test loss: 2.053, Test accuracy: 35.78
Round  92, Global train loss: 0.412, Global test loss: 2.083, Global test accuracy: 37.00
Round  93, Train loss: 0.373, Test loss: 2.170, Test accuracy: 35.78
Round  93, Global train loss: 0.373, Global test loss: 2.220, Global test accuracy: 37.00
Round  94, Train loss: 0.389, Test loss: 2.032, Test accuracy: 36.88
Round  94, Global train loss: 0.389, Global test loss: 2.067, Global test accuracy: 38.40
Round  95, Train loss: 0.352, Test loss: 2.157, Test accuracy: 36.60
Round  95, Global train loss: 0.352, Global test loss: 2.221, Global test accuracy: 38.20
Round  96, Train loss: 0.357, Test loss: 2.122, Test accuracy: 36.38
Round  96, Global train loss: 0.357, Global test loss: 2.182, Global test accuracy: 38.80
Round  97, Train loss: 0.350, Test loss: 2.182, Test accuracy: 34.72
Round  97, Global train loss: 0.350, Global test loss: 2.236, Global test accuracy: 35.60
Round  98, Train loss: 0.323, Test loss: 2.225, Test accuracy: 34.34
Round  98, Global train loss: 0.323, Global test loss: 2.296, Global test accuracy: 36.40
Round  99, Train loss: 0.432, Test loss: 2.080, Test accuracy: 37.00
Round  99, Global train loss: 0.432, Global test loss: 1.929, Global test accuracy: 39.20
Final Round, Train loss: 0.374, Test loss: 2.167, Test accuracy: 36.74
Final Round, Global train loss: 0.374, Global test loss: 1.929, Global test accuracy: 39.20
Average accuracy final 10 rounds: 36.07600000000001
1820.9975097179413
[2.0068609714508057, 3.7098968029022217, 5.461188554763794, 7.169272422790527, 8.766154527664185, 10.363330602645874, 12.028256893157959, 13.648703336715698, 15.23277473449707, 16.843631982803345, 22.323559045791626, 31.80845332145691, 41.469430923461914, 51.239383935928345, 60.93949747085571, 70.34143304824829, 79.94895219802856, 89.63775110244751, 99.06942105293274, 108.35618734359741, 117.78300666809082, 127.3445177078247, 136.92734742164612, 146.67716431617737, 156.4614543914795, 166.096604347229, 176.10837149620056, 186.04680705070496, 195.6768627166748, 205.70781922340393, 214.9991500377655, 224.73027181625366, 234.5066146850586, 243.98484563827515, 245.54960417747498, 254.8781135082245, 264.60525465011597, 275.05139780044556, 276.6540985107422, 286.0214002132416, 295.66362142562866, 305.28852677345276, 306.98517179489136, 308.6951289176941, 318.41655015945435, 328.08222484588623, 338.0916154384613, 347.7532343864441, 357.4853866100311, 366.9702236652374, 376.3564875125885, 385.83190965652466, 395.3509142398834, 404.97199416160583, 414.5535089969635, 424.5714485645294, 434.223091840744, 443.65628361701965, 445.3957417011261, 455.5625042915344, 465.8193783760071, 467.5710310935974, 469.28926944732666, 479.200501203537, 488.8632712364197, 498.7142713069916, 508.7869780063629, 518.6145648956299, 520.2141020298004, 530.0014517307281, 531.6267230510712, 541.5342333316803, 551.2042033672333, 552.8004121780396, 562.7663996219635, 564.3574233055115, 574.0971441268921, 583.4030485153198, 592.5070390701294, 601.9076836109161, 603.5385656356812, 605.2332925796509, 606.9706702232361, 608.6581859588623, 610.3355805873871, 611.9964923858643, 613.7154726982117, 615.4557650089264, 617.1357576847076, 618.7270209789276, 620.3109390735626, 621.9723823070526, 623.6038851737976, 625.2639625072479, 626.8806369304657, 628.6137309074402, 630.2703437805176, 632.0023493766785, 633.6288459300995, 642.7909643650055, 651.7660193443298]
[26.14, 29.46, 30.74, 32.88, 34.32, 36.54, 38.46, 39.16, 41.58, 42.98, 40.84, 39.78, 43.76, 41.3, 42.0, 44.34, 42.3, 41.94, 43.3, 46.44, 40.88, 43.48, 39.66, 39.34, 43.62, 43.1, 42.54, 47.92, 40.66, 43.96, 44.34, 41.44, 38.04, 37.54, 51.22, 46.76, 42.2, 41.88, 46.26, 45.58, 43.96, 40.36, 45.92, 47.64, 44.94, 43.54, 46.2, 45.5, 44.64, 44.58, 41.7, 45.92, 42.2, 42.14, 41.14, 42.98, 40.22, 37.78, 40.68, 40.88, 39.22, 42.32, 40.76, 39.42, 40.98, 36.14, 33.58, 39.86, 41.64, 39.82, 38.7, 35.76, 35.16, 36.12, 35.48, 42.68, 37.06, 32.1, 37.88, 35.06, 37.86, 37.94, 38.98, 36.64, 36.5, 36.6, 36.54, 36.98, 36.68, 35.16, 36.94, 36.34, 35.78, 35.78, 36.88, 36.6, 36.38, 34.72, 34.34, 37.0, 36.74]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.574, Test loss: 1.521, Test accuracy: 40.98
Round   0, Global train loss: 1.574, Global test loss: 1.526, Global test accuracy: 43.60
Round   1, Train loss: 1.508, Test loss: 1.413, Test accuracy: 47.36
Round   1, Global train loss: 1.508, Global test loss: 1.379, Global test accuracy: 54.20
Round   2, Train loss: 1.515, Test loss: 1.380, Test accuracy: 45.52
Round   2, Global train loss: 1.515, Global test loss: 1.343, Global test accuracy: 50.20
Round   3, Train loss: 1.514, Test loss: 1.389, Test accuracy: 45.18
Round   3, Global train loss: 1.514, Global test loss: 1.395, Global test accuracy: 44.80
Round   4, Train loss: 1.505, Test loss: 1.351, Test accuracy: 46.74
Round   4, Global train loss: 1.505, Global test loss: 1.366, Global test accuracy: 48.00
Round   5, Train loss: 1.448, Test loss: 1.317, Test accuracy: 49.52
Round   5, Global train loss: 1.448, Global test loss: 1.239, Global test accuracy: 56.60
Round   6, Train loss: 1.439, Test loss: 1.325, Test accuracy: 51.42
Round   6, Global train loss: 1.439, Global test loss: 1.328, Global test accuracy: 59.20
Round   7, Train loss: 1.508, Test loss: 1.326, Test accuracy: 50.12
Round   7, Global train loss: 1.508, Global test loss: 1.385, Global test accuracy: 51.00
Round   8, Train loss: 1.471, Test loss: 1.306, Test accuracy: 51.30
Round   8, Global train loss: 1.471, Global test loss: 1.341, Global test accuracy: 51.40
Round   9, Train loss: 1.397, Test loss: 1.291, Test accuracy: 52.24
Round   9, Global train loss: 1.397, Global test loss: 1.227, Global test accuracy: 60.00
Round  10, Train loss: 1.463, Test loss: 1.295, Test accuracy: 52.40
Round  10, Global train loss: 1.463, Global test loss: 1.313, Global test accuracy: 57.40
Round  11, Train loss: 1.461, Test loss: 1.283, Test accuracy: 51.38
Round  11, Global train loss: 1.461, Global test loss: 1.340, Global test accuracy: 52.00
Round  12, Train loss: 1.430, Test loss: 1.279, Test accuracy: 50.76
Round  12, Global train loss: 1.430, Global test loss: 1.250, Global test accuracy: 57.80
Round  13, Train loss: 1.448, Test loss: 1.280, Test accuracy: 51.44
Round  13, Global train loss: 1.448, Global test loss: 1.325, Global test accuracy: 56.40
Round  14, Train loss: 1.418, Test loss: 1.282, Test accuracy: 51.26
Round  14, Global train loss: 1.418, Global test loss: 1.296, Global test accuracy: 55.00
Round  15, Train loss: 1.418, Test loss: 1.276, Test accuracy: 51.66
Round  15, Global train loss: 1.418, Global test loss: 1.273, Global test accuracy: 55.60
Round  16, Train loss: 1.407, Test loss: 1.265, Test accuracy: 52.74
Round  16, Global train loss: 1.407, Global test loss: 1.270, Global test accuracy: 53.00
Round  17, Train loss: 1.407, Test loss: 1.267, Test accuracy: 52.42
Round  17, Global train loss: 1.407, Global test loss: 1.282, Global test accuracy: 52.80
Round  18, Train loss: 1.365, Test loss: 1.241, Test accuracy: 52.88
Round  18, Global train loss: 1.365, Global test loss: 1.268, Global test accuracy: 61.40
Round  19, Train loss: 1.386, Test loss: 1.230, Test accuracy: 54.04
Round  19, Global train loss: 1.386, Global test loss: 1.384, Global test accuracy: 54.60
Round  20, Train loss: 1.266, Test loss: 1.219, Test accuracy: 53.50
Round  20, Global train loss: 1.266, Global test loss: 1.047, Global test accuracy: 64.40
Round  21, Train loss: 1.347, Test loss: 1.232, Test accuracy: 52.66
Round  21, Global train loss: 1.347, Global test loss: 1.234, Global test accuracy: 55.20
Round  22, Train loss: 1.288, Test loss: 1.223, Test accuracy: 52.88
Round  22, Global train loss: 1.288, Global test loss: 1.163, Global test accuracy: 61.00
Round  23, Train loss: 1.356, Test loss: 1.230, Test accuracy: 52.12
Round  23, Global train loss: 1.356, Global test loss: 1.281, Global test accuracy: 55.80
Round  24, Train loss: 1.330, Test loss: 1.241, Test accuracy: 51.14
Round  24, Global train loss: 1.330, Global test loss: 1.226, Global test accuracy: 57.80
Round  25, Train loss: 1.369, Test loss: 1.237, Test accuracy: 51.06
Round  25, Global train loss: 1.369, Global test loss: 1.310, Global test accuracy: 52.40
Round  26, Train loss: 1.294, Test loss: 1.238, Test accuracy: 51.22
Round  26, Global train loss: 1.294, Global test loss: 1.247, Global test accuracy: 63.00
Round  27, Train loss: 1.380, Test loss: 1.245, Test accuracy: 50.92
Round  27, Global train loss: 1.380, Global test loss: 1.328, Global test accuracy: 51.60
Round  28, Train loss: 1.301, Test loss: 1.259, Test accuracy: 50.54
Round  28, Global train loss: 1.301, Global test loss: 1.258, Global test accuracy: 56.20
Round  29, Train loss: 1.238, Test loss: 1.273, Test accuracy: 51.04
Round  29, Global train loss: 1.238, Global test loss: 1.239, Global test accuracy: 60.20
Round  30, Train loss: 1.237, Test loss: 1.274, Test accuracy: 50.92
Round  30, Global train loss: 1.237, Global test loss: 1.129, Global test accuracy: 62.00
Round  31, Train loss: 1.261, Test loss: 1.271, Test accuracy: 50.88
Round  31, Global train loss: 1.261, Global test loss: 1.125, Global test accuracy: 60.80
Round  32, Train loss: 1.224, Test loss: 1.271, Test accuracy: 50.96
Round  32, Global train loss: 1.224, Global test loss: 1.250, Global test accuracy: 55.00
Round  33, Train loss: 1.182, Test loss: 1.263, Test accuracy: 51.16
Round  33, Global train loss: 1.182, Global test loss: 1.122, Global test accuracy: 63.40
Round  34, Train loss: 1.194, Test loss: 1.266, Test accuracy: 50.64
Round  34, Global train loss: 1.194, Global test loss: 1.093, Global test accuracy: 62.40
Round  35, Train loss: 1.153, Test loss: 1.291, Test accuracy: 49.86
Round  35, Global train loss: 1.153, Global test loss: 1.107, Global test accuracy: 65.60
Round  36, Train loss: 1.144, Test loss: 1.293, Test accuracy: 49.74
Round  36, Global train loss: 1.144, Global test loss: 1.059, Global test accuracy: 63.40
Round  37, Train loss: 1.256, Test loss: 1.285, Test accuracy: 49.84
Round  37, Global train loss: 1.256, Global test loss: 1.306, Global test accuracy: 53.80
Round  38, Train loss: 1.221, Test loss: 1.314, Test accuracy: 48.84
Round  38, Global train loss: 1.221, Global test loss: 1.312, Global test accuracy: 51.60
Round  39, Train loss: 1.119, Test loss: 1.317, Test accuracy: 49.10
Round  39, Global train loss: 1.119, Global test loss: 1.115, Global test accuracy: 60.60
Round  40, Train loss: 1.047, Test loss: 1.340, Test accuracy: 48.22
Round  40, Global train loss: 1.047, Global test loss: 1.091, Global test accuracy: 65.80
Round  41, Train loss: 1.151, Test loss: 1.331, Test accuracy: 48.40
Round  41, Global train loss: 1.151, Global test loss: 1.255, Global test accuracy: 53.00
Round  42, Train loss: 1.034, Test loss: 1.324, Test accuracy: 48.42
Round  42, Global train loss: 1.034, Global test loss: 1.198, Global test accuracy: 60.80
Round  43, Train loss: 0.975, Test loss: 1.355, Test accuracy: 47.36
Round  43, Global train loss: 0.975, Global test loss: 1.196, Global test accuracy: 62.20
Round  44, Train loss: 1.156, Test loss: 1.366, Test accuracy: 47.92
Round  44, Global train loss: 1.156, Global test loss: 1.286, Global test accuracy: 53.20
Round  45, Train loss: 1.225, Test loss: 1.369, Test accuracy: 46.84
Round  45, Global train loss: 1.225, Global test loss: 1.311, Global test accuracy: 49.80
Round  46, Train loss: 1.045, Test loss: 1.405, Test accuracy: 46.54
Round  46, Global train loss: 1.045, Global test loss: 1.065, Global test accuracy: 63.20
Round  47, Train loss: 0.982, Test loss: 1.423, Test accuracy: 46.28
Round  47, Global train loss: 0.982, Global test loss: 1.040, Global test accuracy: 64.20
Round  48, Train loss: 1.076, Test loss: 1.451, Test accuracy: 45.88
Round  48, Global train loss: 1.076, Global test loss: 1.235, Global test accuracy: 56.00
Round  49, Train loss: 1.011, Test loss: 1.467, Test accuracy: 45.60
Round  49, Global train loss: 1.011, Global test loss: 1.179, Global test accuracy: 58.40
Round  50, Train loss: 0.892, Test loss: 1.449, Test accuracy: 45.56
Round  50, Global train loss: 0.892, Global test loss: 1.029, Global test accuracy: 64.40
Round  51, Train loss: 1.003, Test loss: 1.459, Test accuracy: 45.18
Round  51, Global train loss: 1.003, Global test loss: 1.164, Global test accuracy: 61.00
Round  52, Train loss: 0.895, Test loss: 1.475, Test accuracy: 45.98
Round  52, Global train loss: 0.895, Global test loss: 1.070, Global test accuracy: 62.00
Round  53, Train loss: 0.981, Test loss: 1.482, Test accuracy: 46.24
Round  53, Global train loss: 0.981, Global test loss: 1.098, Global test accuracy: 58.60
Round  54, Train loss: 0.988, Test loss: 1.524, Test accuracy: 45.84
Round  54, Global train loss: 0.988, Global test loss: 1.219, Global test accuracy: 58.00
Round  55, Train loss: 1.021, Test loss: 1.552, Test accuracy: 45.56
Round  55, Global train loss: 1.021, Global test loss: 1.303, Global test accuracy: 49.80
Round  56, Train loss: 0.918, Test loss: 1.539, Test accuracy: 44.92
Round  56, Global train loss: 0.918, Global test loss: 1.305, Global test accuracy: 48.60
Round  57, Train loss: 0.901, Test loss: 1.556, Test accuracy: 44.76
Round  57, Global train loss: 0.901, Global test loss: 1.123, Global test accuracy: 60.40
Round  58, Train loss: 0.817, Test loss: 1.576, Test accuracy: 44.78
Round  58, Global train loss: 0.817, Global test loss: 1.041, Global test accuracy: 63.40
Round  59, Train loss: 0.651, Test loss: 1.634, Test accuracy: 44.04
Round  59, Global train loss: 0.651, Global test loss: 0.999, Global test accuracy: 63.40
Round  60, Train loss: 0.764, Test loss: 1.625, Test accuracy: 44.70
Round  60, Global train loss: 0.764, Global test loss: 1.161, Global test accuracy: 58.00
Round  61, Train loss: 0.779, Test loss: 1.710, Test accuracy: 43.04
Round  61, Global train loss: 0.779, Global test loss: 1.108, Global test accuracy: 63.00
Round  62, Train loss: 0.692, Test loss: 1.724, Test accuracy: 42.84
Round  62, Global train loss: 0.692, Global test loss: 1.078, Global test accuracy: 60.60
Round  63, Train loss: 0.964, Test loss: 1.736, Test accuracy: 43.20
Round  63, Global train loss: 0.964, Global test loss: 1.260, Global test accuracy: 53.80
Round  64, Train loss: 0.555, Test loss: 1.723, Test accuracy: 43.52
Round  64, Global train loss: 0.555, Global test loss: 0.973, Global test accuracy: 64.40
Round  65, Train loss: 0.891, Test loss: 1.764, Test accuracy: 43.70
Round  65, Global train loss: 0.891, Global test loss: 1.232, Global test accuracy: 54.20
Round  66, Train loss: 0.679, Test loss: 1.769, Test accuracy: 44.16
Round  66, Global train loss: 0.679, Global test loss: 1.180, Global test accuracy: 54.20
Round  67, Train loss: 0.848, Test loss: 1.786, Test accuracy: 44.26
Round  67, Global train loss: 0.848, Global test loss: 1.203, Global test accuracy: 54.80
Round  68, Train loss: 0.779, Test loss: 1.814, Test accuracy: 43.88
Round  68, Global train loss: 0.779, Global test loss: 1.224, Global test accuracy: 54.60
Round  69, Train loss: 0.802, Test loss: 1.852, Test accuracy: 42.42
Round  69, Global train loss: 0.802, Global test loss: 1.306, Global test accuracy: 51.60
Round  70, Train loss: 0.594, Test loss: 1.896, Test accuracy: 42.46
Round  70, Global train loss: 0.594, Global test loss: 1.198, Global test accuracy: 55.60
Round  71, Train loss: 0.472, Test loss: 1.887, Test accuracy: 41.80
Round  71, Global train loss: 0.472, Global test loss: 1.035, Global test accuracy: 59.80
Round  72, Train loss: 0.675, Test loss: 1.924, Test accuracy: 42.30
Round  72, Global train loss: 0.675, Global test loss: 1.218, Global test accuracy: 54.60
Round  73, Train loss: 0.544, Test loss: 1.976, Test accuracy: 42.42
Round  73, Global train loss: 0.544, Global test loss: 1.066, Global test accuracy: 61.60
Round  74, Train loss: 0.533, Test loss: 2.059, Test accuracy: 42.84
Round  74, Global train loss: 0.533, Global test loss: 1.130, Global test accuracy: 57.20
Round  75, Train loss: 0.554, Test loss: 2.105, Test accuracy: 43.02
Round  75, Global train loss: 0.554, Global test loss: 1.093, Global test accuracy: 59.20
Round  76, Train loss: 0.527, Test loss: 2.123, Test accuracy: 43.28
Round  76, Global train loss: 0.527, Global test loss: 1.183, Global test accuracy: 53.40
Round  77, Train loss: 0.645, Test loss: 2.154, Test accuracy: 43.86
Round  77, Global train loss: 0.645, Global test loss: 1.292, Global test accuracy: 51.00
Round  78, Train loss: 0.448, Test loss: 2.117, Test accuracy: 43.42
Round  78, Global train loss: 0.448, Global test loss: 1.057, Global test accuracy: 60.80
Round  79, Train loss: 0.498, Test loss: 2.133, Test accuracy: 43.68
Round  79, Global train loss: 0.498, Global test loss: 1.186, Global test accuracy: 56.40
Round  80, Train loss: 0.538, Test loss: 2.176, Test accuracy: 43.18
Round  80, Global train loss: 0.538, Global test loss: 1.176, Global test accuracy: 54.80
Round  81, Train loss: 0.447, Test loss: 2.165, Test accuracy: 43.54
Round  81, Global train loss: 0.447, Global test loss: 1.063, Global test accuracy: 61.40
Round  82, Train loss: 0.725, Test loss: 2.246, Test accuracy: 42.28
Round  82, Global train loss: 0.725, Global test loss: 1.469, Global test accuracy: 38.20
Round  83, Train loss: 0.516, Test loss: 2.338, Test accuracy: 41.64
Round  83, Global train loss: 0.516, Global test loss: 1.238, Global test accuracy: 50.80
Round  84, Train loss: 0.509, Test loss: 2.333, Test accuracy: 41.50
Round  84, Global train loss: 0.509, Global test loss: 1.384, Global test accuracy: 43.80
Round  85, Train loss: 0.484, Test loss: 2.332, Test accuracy: 42.06
Round  85, Global train loss: 0.484, Global test loss: 1.251, Global test accuracy: 53.00
Round  86, Train loss: 0.438, Test loss: 2.427, Test accuracy: 41.42
Round  86, Global train loss: 0.438, Global test loss: 1.060, Global test accuracy: 59.80
Round  87, Train loss: 0.497, Test loss: 2.430, Test accuracy: 40.96
Round  87, Global train loss: 0.497, Global test loss: 1.394, Global test accuracy: 42.00
Round  88, Train loss: 0.439, Test loss: 2.444, Test accuracy: 41.84
Round  88, Global train loss: 0.439, Global test loss: 1.352, Global test accuracy: 45.40
Round  89, Train loss: 0.414, Test loss: 2.436, Test accuracy: 41.56
Round  89, Global train loss: 0.414, Global test loss: 1.392, Global test accuracy: 46.40
Round  90, Train loss: 0.427, Test loss: 2.534, Test accuracy: 40.70
Round  90, Global train loss: 0.427, Global test loss: 1.342, Global test accuracy: 44.60
Round  91, Train loss: 0.332, Test loss: 2.610, Test accuracy: 40.76
Round  91, Global train loss: 0.332, Global test loss: 1.008, Global test accuracy: 62.60
Round  92, Train loss: 0.399, Test loss: 2.577, Test accuracy: 40.60
Round  92, Global train loss: 0.399, Global test loss: 1.179, Global test accuracy: 54.60
Round  93, Train loss: 0.366, Test loss: 2.649, Test accuracy: 40.54
Round  93, Global train loss: 0.366, Global test loss: 1.240, Global test accuracy: 49.20
Round  94, Train loss: 0.347, Test loss: 2.660, Test accuracy: 40.18
Round  94, Global train loss: 0.347, Global test loss: 1.293, Global test accuracy: 48.20
Round  95, Train loss: 0.421, Test loss: 2.634, Test accuracy: 40.94
Round  95, Global train loss: 0.421, Global test loss: 1.147, Global test accuracy: 55.60
Round  96, Train loss: 0.320, Test loss: 2.718, Test accuracy: 40.84
Round  96, Global train loss: 0.320, Global test loss: 1.116, Global test accuracy: 61.20
Round  97, Train loss: 0.306, Test loss: 2.742, Test accuracy: 41.36
Round  97, Global train loss: 0.306, Global test loss: 1.239, Global test accuracy: 50.80
Round  98, Train loss: 0.434, Test loss: 2.741, Test accuracy: 41.04
Round  98, Global train loss: 0.434, Global test loss: 1.279, Global test accuracy: 50.20
Round  99, Train loss: 0.290, Test loss: 2.750, Test accuracy: 40.44
Round  99, Global train loss: 0.290, Global test loss: 1.223, Global test accuracy: 49.40
Final Round, Train loss: 0.319, Test loss: 2.963, Test accuracy: 40.40
Final Round, Global train loss: 0.319, Global test loss: 1.223, Global test accuracy: 49.40
Average accuracy final 10 rounds: 40.739999999999995 

Average global accuracy final 10 rounds: 52.64 

799.3377530574799
[1.5226385593414307, 3.0452771186828613, 4.307579040527344, 5.569880962371826, 6.693284273147583, 7.81668758392334, 8.915724277496338, 10.014760971069336, 11.116835117340088, 12.21890926361084, 13.315838098526001, 14.412766933441162, 15.619530200958252, 16.826293468475342, 18.00977921485901, 19.193264961242676, 20.295310735702515, 21.397356510162354, 22.498486042022705, 23.599615573883057, 24.690032958984375, 25.780450344085693, 26.881890535354614, 27.983330726623535, 29.12653136253357, 30.269731998443604, 31.445706844329834, 32.621681690216064, 33.82758641242981, 35.033491134643555, 36.28512358665466, 37.53675603866577, 38.68971800804138, 39.84267997741699, 40.94094920158386, 42.03921842575073, 43.13883090019226, 44.23844337463379, 45.334378480911255, 46.43031358718872, 47.68619990348816, 48.9420862197876, 50.12993907928467, 51.31779193878174, 52.42423701286316, 53.53068208694458, 54.62458872795105, 55.71849536895752, 56.836442947387695, 57.95439052581787, 59.081315994262695, 60.20824146270752, 61.316651344299316, 62.42506122589111, 63.6252715587616, 64.82548189163208, 65.93316197395325, 67.04084205627441, 68.14836430549622, 69.25588655471802, 70.4407422542572, 71.62559795379639, 72.73262691497803, 73.83965587615967, 74.94480729103088, 76.0499587059021, 77.32816362380981, 78.60636854171753, 79.73052883148193, 80.85468912124634, 81.98052620887756, 83.10636329650879, 84.2116129398346, 85.3168625831604, 86.41848468780518, 87.52010679244995, 88.61906123161316, 89.71801567077637, 90.9810094833374, 92.24400329589844, 93.33903646469116, 94.43406963348389, 95.53638219833374, 96.6386947631836, 97.73036766052246, 98.82204055786133, 99.92857909202576, 101.03511762619019, 102.16829252243042, 103.30146741867065, 104.56212019920349, 105.82277297973633, 107.08759808540344, 108.35242319107056, 109.57335901260376, 110.79429483413696, 111.90909194946289, 113.02388906478882, 114.12060832977295, 115.21732759475708, 116.30869650840759, 117.4000654220581, 118.57134962081909, 119.74263381958008, 120.93631029129028, 122.12998676300049, 123.40504455566406, 124.68010234832764, 125.8186047077179, 126.95710706710815, 128.0784945487976, 129.19988203048706, 130.29726147651672, 131.3946409225464, 132.48521852493286, 133.57579612731934, 134.8083827495575, 136.04096937179565, 137.23504161834717, 138.42911386489868, 139.61163544654846, 140.79415702819824, 141.9032301902771, 143.01230335235596, 144.1276776790619, 145.24305200576782, 146.35996913909912, 147.47688627243042, 148.5838005542755, 149.6907148361206, 150.79780626296997, 151.90489768981934, 153.16644477844238, 154.42799186706543, 155.52984714508057, 156.6317024230957, 157.72346472740173, 158.81522703170776, 159.92523670196533, 161.0352463722229, 162.1357524394989, 163.2362585067749, 164.36022424697876, 165.48418998718262, 166.7327196598053, 167.98124933242798, 169.17480993270874, 170.3683705329895, 171.64097261428833, 172.91357469558716, 174.03628039360046, 175.15898609161377, 176.25990962982178, 177.36083316802979, 178.46973133087158, 179.57862949371338, 180.74904322624207, 181.91945695877075, 183.0154163837433, 184.11137580871582, 185.3668761253357, 186.62237644195557, 187.8574185371399, 189.09246063232422, 190.31356596946716, 191.5346713066101, 192.76792931556702, 194.00118732452393, 195.2736518383026, 196.5461163520813, 197.8244605064392, 199.10280466079712, 200.37459659576416, 201.6463885307312, 202.88207411766052, 204.11775970458984, 205.3161063194275, 206.51445293426514, 207.77657175064087, 209.0386905670166, 210.1408088207245, 211.24292707443237, 212.32982683181763, 213.41672658920288, 214.51415514945984, 215.6115837097168, 216.73580360412598, 217.86002349853516, 219.113107919693, 220.36619234085083, 221.62196493148804, 222.87773752212524, 224.11123394966125, 225.34473037719727, 226.47751355171204, 227.6102967262268, 228.80778169631958, 230.00526666641235, 231.1959090232849, 232.38655138015747, 234.81003093719482, 237.23351049423218]
[40.98, 40.98, 47.36, 47.36, 45.52, 45.52, 45.18, 45.18, 46.74, 46.74, 49.52, 49.52, 51.42, 51.42, 50.12, 50.12, 51.3, 51.3, 52.24, 52.24, 52.4, 52.4, 51.38, 51.38, 50.76, 50.76, 51.44, 51.44, 51.26, 51.26, 51.66, 51.66, 52.74, 52.74, 52.42, 52.42, 52.88, 52.88, 54.04, 54.04, 53.5, 53.5, 52.66, 52.66, 52.88, 52.88, 52.12, 52.12, 51.14, 51.14, 51.06, 51.06, 51.22, 51.22, 50.92, 50.92, 50.54, 50.54, 51.04, 51.04, 50.92, 50.92, 50.88, 50.88, 50.96, 50.96, 51.16, 51.16, 50.64, 50.64, 49.86, 49.86, 49.74, 49.74, 49.84, 49.84, 48.84, 48.84, 49.1, 49.1, 48.22, 48.22, 48.4, 48.4, 48.42, 48.42, 47.36, 47.36, 47.92, 47.92, 46.84, 46.84, 46.54, 46.54, 46.28, 46.28, 45.88, 45.88, 45.6, 45.6, 45.56, 45.56, 45.18, 45.18, 45.98, 45.98, 46.24, 46.24, 45.84, 45.84, 45.56, 45.56, 44.92, 44.92, 44.76, 44.76, 44.78, 44.78, 44.04, 44.04, 44.7, 44.7, 43.04, 43.04, 42.84, 42.84, 43.2, 43.2, 43.52, 43.52, 43.7, 43.7, 44.16, 44.16, 44.26, 44.26, 43.88, 43.88, 42.42, 42.42, 42.46, 42.46, 41.8, 41.8, 42.3, 42.3, 42.42, 42.42, 42.84, 42.84, 43.02, 43.02, 43.28, 43.28, 43.86, 43.86, 43.42, 43.42, 43.68, 43.68, 43.18, 43.18, 43.54, 43.54, 42.28, 42.28, 41.64, 41.64, 41.5, 41.5, 42.06, 42.06, 41.42, 41.42, 40.96, 40.96, 41.84, 41.84, 41.56, 41.56, 40.7, 40.7, 40.76, 40.76, 40.6, 40.6, 40.54, 40.54, 40.18, 40.18, 40.94, 40.94, 40.84, 40.84, 41.36, 41.36, 41.04, 41.04, 40.44, 40.44, 40.4, 40.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.573, Test loss: 1.528, Test accuracy: 41.20
Round   0, Global train loss: 1.573, Global test loss: 1.532, Global test accuracy: 43.40
Round   1, Train loss: 1.501, Test loss: 1.395, Test accuracy: 47.12
Round   1, Global train loss: 1.501, Global test loss: 1.349, Global test accuracy: 53.60
Round   2, Train loss: 1.479, Test loss: 1.351, Test accuracy: 45.06
Round   2, Global train loss: 1.479, Global test loss: 1.270, Global test accuracy: 49.20
Round   3, Train loss: 1.505, Test loss: 1.332, Test accuracy: 48.94
Round   3, Global train loss: 1.505, Global test loss: 1.294, Global test accuracy: 53.20
Round   4, Train loss: 1.498, Test loss: 1.303, Test accuracy: 52.38
Round   4, Global train loss: 1.498, Global test loss: 1.289, Global test accuracy: 56.00
Round   5, Train loss: 1.444, Test loss: 1.267, Test accuracy: 52.52
Round   5, Global train loss: 1.444, Global test loss: 1.183, Global test accuracy: 58.20
Round   6, Train loss: 1.427, Test loss: 1.251, Test accuracy: 52.94
Round   6, Global train loss: 1.427, Global test loss: 1.196, Global test accuracy: 58.00
Round   7, Train loss: 1.465, Test loss: 1.248, Test accuracy: 52.32
Round   7, Global train loss: 1.465, Global test loss: 1.227, Global test accuracy: 55.60
Round   8, Train loss: 1.467, Test loss: 1.222, Test accuracy: 53.66
Round   8, Global train loss: 1.467, Global test loss: 1.171, Global test accuracy: 57.60
Round   9, Train loss: 1.332, Test loss: 1.197, Test accuracy: 53.88
Round   9, Global train loss: 1.332, Global test loss: 1.108, Global test accuracy: 57.00
Round  10, Train loss: 1.367, Test loss: 1.191, Test accuracy: 53.54
Round  10, Global train loss: 1.367, Global test loss: 1.135, Global test accuracy: 53.00
Round  11, Train loss: 1.372, Test loss: 1.192, Test accuracy: 53.10
Round  11, Global train loss: 1.372, Global test loss: 1.108, Global test accuracy: 57.40
Round  12, Train loss: 1.321, Test loss: 1.179, Test accuracy: 54.02
Round  12, Global train loss: 1.321, Global test loss: 1.103, Global test accuracy: 57.20
Round  13, Train loss: 1.405, Test loss: 1.179, Test accuracy: 53.84
Round  13, Global train loss: 1.405, Global test loss: 1.124, Global test accuracy: 58.20
Round  14, Train loss: 1.372, Test loss: 1.164, Test accuracy: 54.90
Round  14, Global train loss: 1.372, Global test loss: 1.128, Global test accuracy: 58.00
Round  15, Train loss: 1.237, Test loss: 1.180, Test accuracy: 54.20
Round  15, Global train loss: 1.237, Global test loss: 1.173, Global test accuracy: 52.80
Round  16, Train loss: 1.330, Test loss: 1.182, Test accuracy: 54.38
Round  16, Global train loss: 1.330, Global test loss: 1.128, Global test accuracy: 58.60
Round  17, Train loss: 1.295, Test loss: 1.186, Test accuracy: 54.28
Round  17, Global train loss: 1.295, Global test loss: 1.134, Global test accuracy: 56.80
Round  18, Train loss: 1.296, Test loss: 1.202, Test accuracy: 53.44
Round  18, Global train loss: 1.296, Global test loss: 1.121, Global test accuracy: 59.20
Round  19, Train loss: 1.271, Test loss: 1.200, Test accuracy: 54.16
Round  19, Global train loss: 1.271, Global test loss: 1.172, Global test accuracy: 58.40
Round  20, Train loss: 1.288, Test loss: 1.201, Test accuracy: 53.78
Round  20, Global train loss: 1.288, Global test loss: 1.084, Global test accuracy: 58.20
Round  21, Train loss: 1.263, Test loss: 1.218, Test accuracy: 52.84
Round  21, Global train loss: 1.263, Global test loss: 1.173, Global test accuracy: 53.60
Round  22, Train loss: 1.118, Test loss: 1.204, Test accuracy: 53.00
Round  22, Global train loss: 1.118, Global test loss: 1.043, Global test accuracy: 58.20
Round  23, Train loss: 1.158, Test loss: 1.224, Test accuracy: 52.44
Round  23, Global train loss: 1.158, Global test loss: 1.179, Global test accuracy: 54.40
Round  24, Train loss: 1.096, Test loss: 1.259, Test accuracy: 51.96
Round  24, Global train loss: 1.096, Global test loss: 1.206, Global test accuracy: 54.80
Round  25, Train loss: 1.050, Test loss: 1.270, Test accuracy: 51.76
Round  25, Global train loss: 1.050, Global test loss: 1.303, Global test accuracy: 50.40
Round  26, Train loss: 1.110, Test loss: 1.279, Test accuracy: 52.76
Round  26, Global train loss: 1.110, Global test loss: 1.188, Global test accuracy: 58.00
Round  27, Train loss: 1.080, Test loss: 1.324, Test accuracy: 52.26
Round  27, Global train loss: 1.080, Global test loss: 1.344, Global test accuracy: 50.20
Round  28, Train loss: 0.946, Test loss: 1.337, Test accuracy: 51.76
Round  28, Global train loss: 0.946, Global test loss: 1.280, Global test accuracy: 53.00
Round  29, Train loss: 0.925, Test loss: 1.389, Test accuracy: 50.24
Round  29, Global train loss: 0.925, Global test loss: 1.386, Global test accuracy: 51.60
Round  30, Train loss: 0.979, Test loss: 1.426, Test accuracy: 49.22
Round  30, Global train loss: 0.979, Global test loss: 1.190, Global test accuracy: 55.20
Round  31, Train loss: 1.078, Test loss: 1.450, Test accuracy: 49.22
Round  31, Global train loss: 1.078, Global test loss: 1.265, Global test accuracy: 52.40
Round  32, Train loss: 0.871, Test loss: 1.446, Test accuracy: 49.56
Round  32, Global train loss: 0.871, Global test loss: 1.366, Global test accuracy: 50.20
Round  33, Train loss: 0.977, Test loss: 1.451, Test accuracy: 49.36
Round  33, Global train loss: 0.977, Global test loss: 1.236, Global test accuracy: 51.60
Round  34, Train loss: 0.924, Test loss: 1.474, Test accuracy: 48.78
Round  34, Global train loss: 0.924, Global test loss: 1.218, Global test accuracy: 54.20
Round  35, Train loss: 0.919, Test loss: 1.496, Test accuracy: 49.18
Round  35, Global train loss: 0.919, Global test loss: 1.305, Global test accuracy: 51.80
Round  36, Train loss: 0.887, Test loss: 1.519, Test accuracy: 49.10
Round  36, Global train loss: 0.887, Global test loss: 1.294, Global test accuracy: 51.80
Round  37, Train loss: 0.882, Test loss: 1.571, Test accuracy: 48.32
Round  37, Global train loss: 0.882, Global test loss: 1.461, Global test accuracy: 43.60
Round  38, Train loss: 0.832, Test loss: 1.598, Test accuracy: 48.62
Round  38, Global train loss: 0.832, Global test loss: 1.537, Global test accuracy: 46.60
Round  39, Train loss: 0.724, Test loss: 1.640, Test accuracy: 48.72
Round  39, Global train loss: 0.724, Global test loss: 1.323, Global test accuracy: 54.20
Round  40, Train loss: 0.818, Test loss: 1.668, Test accuracy: 48.24
Round  40, Global train loss: 0.818, Global test loss: 1.332, Global test accuracy: 52.20
Round  41, Train loss: 0.736, Test loss: 1.692, Test accuracy: 48.24
Round  41, Global train loss: 0.736, Global test loss: 1.543, Global test accuracy: 45.00
Round  42, Train loss: 0.647, Test loss: 1.722, Test accuracy: 47.96
Round  42, Global train loss: 0.647, Global test loss: 1.473, Global test accuracy: 47.20
Round  43, Train loss: 0.598, Test loss: 1.747, Test accuracy: 47.14
Round  43, Global train loss: 0.598, Global test loss: 1.495, Global test accuracy: 48.20
Round  44, Train loss: 0.619, Test loss: 1.737, Test accuracy: 47.80
Round  44, Global train loss: 0.619, Global test loss: 1.531, Global test accuracy: 47.40
Round  45, Train loss: 0.521, Test loss: 1.828, Test accuracy: 46.96
Round  45, Global train loss: 0.521, Global test loss: 1.782, Global test accuracy: 51.20
Round  46, Train loss: 0.665, Test loss: 1.861, Test accuracy: 47.00
Round  46, Global train loss: 0.665, Global test loss: 1.507, Global test accuracy: 53.00
Round  47, Train loss: 0.607, Test loss: 1.862, Test accuracy: 46.62
Round  47, Global train loss: 0.607, Global test loss: 1.484, Global test accuracy: 52.80
Round  48, Train loss: 0.564, Test loss: 1.895, Test accuracy: 46.16
Round  48, Global train loss: 0.564, Global test loss: 1.800, Global test accuracy: 47.80
Round  49, Train loss: 0.576, Test loss: 1.943, Test accuracy: 45.36
Round  49, Global train loss: 0.576, Global test loss: 1.732, Global test accuracy: 45.80
Round  50, Train loss: 0.616, Test loss: 1.954, Test accuracy: 45.34
Round  50, Global train loss: 0.616, Global test loss: 1.400, Global test accuracy: 52.20
Round  51, Train loss: 0.517, Test loss: 1.915, Test accuracy: 45.84
Round  51, Global train loss: 0.517, Global test loss: 1.627, Global test accuracy: 46.20
Round  52, Train loss: 0.488, Test loss: 1.951, Test accuracy: 46.10
Round  52, Global train loss: 0.488, Global test loss: 1.557, Global test accuracy: 52.80
Round  53, Train loss: 0.482, Test loss: 2.082, Test accuracy: 44.64
Round  53, Global train loss: 0.482, Global test loss: 1.766, Global test accuracy: 46.80
Round  54, Train loss: 0.427, Test loss: 2.213, Test accuracy: 44.36
Round  54, Global train loss: 0.427, Global test loss: 1.987, Global test accuracy: 48.60
Round  55, Train loss: 0.394, Test loss: 2.266, Test accuracy: 45.48
Round  55, Global train loss: 0.394, Global test loss: 2.067, Global test accuracy: 45.60
Round  56, Train loss: 0.455, Test loss: 2.307, Test accuracy: 46.24
Round  56, Global train loss: 0.455, Global test loss: 1.964, Global test accuracy: 46.20
Round  57, Train loss: 0.447, Test loss: 2.273, Test accuracy: 45.90
Round  57, Global train loss: 0.447, Global test loss: 1.791, Global test accuracy: 47.20
Round  58, Train loss: 0.438, Test loss: 2.316, Test accuracy: 45.32
Round  58, Global train loss: 0.438, Global test loss: 1.846, Global test accuracy: 47.40
Round  59, Train loss: 0.513, Test loss: 2.254, Test accuracy: 46.42
Round  59, Global train loss: 0.513, Global test loss: 1.538, Global test accuracy: 53.20
Round  60, Train loss: 0.370, Test loss: 2.236, Test accuracy: 47.04
Round  60, Global train loss: 0.370, Global test loss: 1.853, Global test accuracy: 46.40
Round  61, Train loss: 0.313, Test loss: 2.272, Test accuracy: 45.46
Round  61, Global train loss: 0.313, Global test loss: 2.036, Global test accuracy: 42.80
Round  62, Train loss: 0.366, Test loss: 2.247, Test accuracy: 46.12
Round  62, Global train loss: 0.366, Global test loss: 1.750, Global test accuracy: 53.40
Round  63, Train loss: 0.373, Test loss: 2.248, Test accuracy: 46.68
Round  63, Global train loss: 0.373, Global test loss: 2.111, Global test accuracy: 44.40
Round  64, Train loss: 0.462, Test loss: 2.293, Test accuracy: 46.74
Round  64, Global train loss: 0.462, Global test loss: 1.683, Global test accuracy: 48.80
Round  65, Train loss: 0.273, Test loss: 2.328, Test accuracy: 46.68
Round  65, Global train loss: 0.273, Global test loss: 2.119, Global test accuracy: 50.00
Round  66, Train loss: 0.303, Test loss: 2.263, Test accuracy: 47.52
Round  66, Global train loss: 0.303, Global test loss: 1.827, Global test accuracy: 50.80
Round  67, Train loss: 0.267, Test loss: 2.310, Test accuracy: 47.10
Round  67, Global train loss: 0.267, Global test loss: 2.218, Global test accuracy: 47.60
Round  68, Train loss: 0.281, Test loss: 2.392, Test accuracy: 47.14
Round  68, Global train loss: 0.281, Global test loss: 2.276, Global test accuracy: 50.00
Round  69, Train loss: 0.242, Test loss: 2.383, Test accuracy: 47.56
Round  69, Global train loss: 0.242, Global test loss: 2.375, Global test accuracy: 44.80
Round  70, Train loss: 0.251, Test loss: 2.428, Test accuracy: 46.50
Round  70, Global train loss: 0.251, Global test loss: 2.226, Global test accuracy: 48.20
Round  71, Train loss: 0.384, Test loss: 2.500, Test accuracy: 45.60
Round  71, Global train loss: 0.384, Global test loss: 1.902, Global test accuracy: 49.40
Round  72, Train loss: 0.237, Test loss: 2.516, Test accuracy: 45.58
Round  72, Global train loss: 0.237, Global test loss: 2.236, Global test accuracy: 46.60
Round  73, Train loss: 0.473, Test loss: 2.502, Test accuracy: 46.78
Round  73, Global train loss: 0.473, Global test loss: 1.729, Global test accuracy: 51.60
Round  74, Train loss: 0.191, Test loss: 2.500, Test accuracy: 46.32
Round  74, Global train loss: 0.191, Global test loss: 2.247, Global test accuracy: 52.20
Round  75, Train loss: 0.292, Test loss: 2.511, Test accuracy: 45.80
Round  75, Global train loss: 0.292, Global test loss: 2.007, Global test accuracy: 49.80
Round  76, Train loss: 0.251, Test loss: 2.578, Test accuracy: 45.98
Round  76, Global train loss: 0.251, Global test loss: 2.257, Global test accuracy: 49.00
Round  77, Train loss: 0.246, Test loss: 2.577, Test accuracy: 46.18
Round  77, Global train loss: 0.246, Global test loss: 2.262, Global test accuracy: 46.20
Round  78, Train loss: 0.301, Test loss: 2.579, Test accuracy: 47.22
Round  78, Global train loss: 0.301, Global test loss: 2.017, Global test accuracy: 48.20
Round  79, Train loss: 0.220, Test loss: 2.543, Test accuracy: 47.16
Round  79, Global train loss: 0.220, Global test loss: 2.303, Global test accuracy: 51.20
Round  80, Train loss: 0.217, Test loss: 2.670, Test accuracy: 46.82
Round  80, Global train loss: 0.217, Global test loss: 2.401, Global test accuracy: 48.20
Round  81, Train loss: 0.203, Test loss: 2.644, Test accuracy: 47.34
Round  81, Global train loss: 0.203, Global test loss: 1.998, Global test accuracy: 53.00
Round  82, Train loss: 0.206, Test loss: 2.669, Test accuracy: 46.98
Round  82, Global train loss: 0.206, Global test loss: 2.688, Global test accuracy: 43.00
Round  83, Train loss: 0.163, Test loss: 2.736, Test accuracy: 46.86
Round  83, Global train loss: 0.163, Global test loss: 2.462, Global test accuracy: 50.00
Round  84, Train loss: 0.178, Test loss: 2.747, Test accuracy: 46.66
Round  84, Global train loss: 0.178, Global test loss: 2.640, Global test accuracy: 48.00
Round  85, Train loss: 0.195, Test loss: 2.768, Test accuracy: 47.20
Round  85, Global train loss: 0.195, Global test loss: 2.473, Global test accuracy: 49.20
Round  86, Train loss: 0.270, Test loss: 2.848, Test accuracy: 46.24
Round  86, Global train loss: 0.270, Global test loss: 2.108, Global test accuracy: 50.80
Round  87, Train loss: 0.126, Test loss: 2.776, Test accuracy: 46.58
Round  87, Global train loss: 0.126, Global test loss: 2.651, Global test accuracy: 49.00
Round  88, Train loss: 0.138, Test loss: 2.797, Test accuracy: 47.34
Round  88, Global train loss: 0.138, Global test loss: 2.671, Global test accuracy: 49.00
Round  89, Train loss: 0.137, Test loss: 2.845, Test accuracy: 47.36
Round  89, Global train loss: 0.137, Global test loss: 2.760, Global test accuracy: 48.40
Round  90, Train loss: 0.239, Test loss: 2.847, Test accuracy: 47.22
Round  90, Global train loss: 0.239, Global test loss: 2.406, Global test accuracy: 47.80
Round  91, Train loss: 0.283, Test loss: 2.790, Test accuracy: 47.64
Round  91, Global train loss: 0.283, Global test loss: 1.996, Global test accuracy: 52.60
Round  92, Train loss: 0.139, Test loss: 2.783, Test accuracy: 47.64
Round  92, Global train loss: 0.139, Global test loss: 2.487, Global test accuracy: 50.00
Round  93, Train loss: 0.178, Test loss: 2.739, Test accuracy: 47.64
Round  93, Global train loss: 0.178, Global test loss: 2.470, Global test accuracy: 53.00
Round  94, Train loss: 0.159, Test loss: 2.785, Test accuracy: 47.40
Round  94, Global train loss: 0.159, Global test loss: 2.654, Global test accuracy: 47.60
Round  95, Train loss: 0.228, Test loss: 2.741, Test accuracy: 48.46
Round  95, Global train loss: 0.228, Global test loss: 2.317, Global test accuracy: 50.00
Round  96, Train loss: 0.277, Test loss: 2.788, Test accuracy: 48.28
Round  96, Global train loss: 0.277, Global test loss: 2.197, Global test accuracy: 50.40
Round  97, Train loss: 0.115, Test loss: 2.770, Test accuracy: 48.54
Round  97, Global train loss: 0.115, Global test loss: 2.397, Global test accuracy: 53.40
Round  98, Train loss: 0.186, Test loss: 2.786, Test accuracy: 48.68
Round  98, Global train loss: 0.186, Global test loss: 2.511, Global test accuracy: 48.60
Round  99, Train loss: 0.180, Test loss: 2.818, Test accuracy: 48.74
Round  99, Global train loss: 0.180, Global test loss: 2.489, Global test accuracy: 51.40
Final Round, Train loss: 0.166, Test loss: 2.915, Test accuracy: 48.50
Final Round, Global train loss: 0.166, Global test loss: 2.489, Global test accuracy: 51.40
Average accuracy final 10 rounds: 48.024 

Average global accuracy final 10 rounds: 50.480000000000004 

782.1374318599701
[1.4714436531066895, 2.942887306213379, 4.165783882141113, 5.388680458068848, 6.616211414337158, 7.843742370605469, 9.091605186462402, 10.339468002319336, 11.476932764053345, 12.614397525787354, 13.724735736846924, 14.835073947906494, 15.95659351348877, 17.078113079071045, 18.20431900024414, 19.330524921417236, 20.45602560043335, 21.581526279449463, 22.786725997924805, 23.991925716400146, 25.143258333206177, 26.294590950012207, 27.50533628463745, 28.716081619262695, 29.93754291534424, 31.15900421142578, 32.37443947792053, 33.58987474441528, 34.832772731781006, 36.07567071914673, 37.24722862243652, 38.41878652572632, 39.6548535823822, 40.890920639038086, 42.128159523010254, 43.36539840698242, 44.537360429763794, 45.709322452545166, 46.913180351257324, 48.11703824996948, 49.202107429504395, 50.28717660903931, 51.3709921836853, 52.4548077583313, 53.54668998718262, 54.638572216033936, 55.72354555130005, 56.80851888656616, 57.9114465713501, 59.01437425613403, 60.16694450378418, 61.319514751434326, 62.53294563293457, 63.746376514434814, 64.9815571308136, 66.21673774719238, 67.47014236450195, 68.72354698181152, 69.95482110977173, 71.18609523773193, 72.27067804336548, 73.35526084899902, 74.43722105026245, 75.51918125152588, 76.5936632156372, 77.66814517974854, 78.7318947315216, 79.79564428329468, 80.87612342834473, 81.95660257339478, 83.03916907310486, 84.12173557281494, 85.20218801498413, 86.28264045715332, 87.36589884757996, 88.44915723800659, 89.5285325050354, 90.60790777206421, 91.68938851356506, 92.77086925506592, 93.87296080589294, 94.97505235671997, 96.06653022766113, 97.1580080986023, 98.2234787940979, 99.2889494895935, 100.38039422035217, 101.47183895111084, 102.69595718383789, 103.92007541656494, 104.9986264705658, 106.07717752456665, 107.15073299407959, 108.22428846359253, 109.30674982070923, 110.38921117782593, 111.47610855102539, 112.56300592422485, 113.65433979034424, 114.74567365646362, 115.81972002983093, 116.89376640319824, 117.9555094242096, 119.01725244522095, 120.08956480026245, 121.16187715530396, 122.24018239974976, 123.31848764419556, 124.40980386734009, 125.50112009048462, 126.5771267414093, 127.65313339233398, 128.72816848754883, 129.80320358276367, 130.88000178337097, 131.95679998397827, 133.03946018218994, 134.1221203804016, 135.2467954158783, 136.37147045135498, 137.4524917602539, 138.53351306915283, 139.60550212860107, 140.67749118804932, 141.78545355796814, 142.89341592788696, 144.1080195903778, 145.32262325286865, 146.5428421497345, 147.76306104660034, 148.96376729011536, 150.16447353363037, 151.32328629493713, 152.4820990562439, 153.68101286888123, 154.87992668151855, 156.07265615463257, 157.26538562774658, 158.4542179107666, 159.64305019378662, 160.83389115333557, 162.02473211288452, 163.1092987060547, 164.19386529922485, 165.27282619476318, 166.3517870903015, 167.47967314720154, 168.60755920410156, 169.73030996322632, 170.85306072235107, 172.08800387382507, 173.32294702529907, 174.4324712753296, 175.5419955253601, 176.65185046195984, 177.76170539855957, 178.86983180046082, 179.97795820236206, 181.13522815704346, 182.29249811172485, 183.4433057308197, 184.59411334991455, 185.71031856536865, 186.82652378082275, 187.9428267478943, 189.05912971496582, 190.16826248168945, 191.2773952484131, 192.39675521850586, 193.51611518859863, 194.724027633667, 195.93194007873535, 197.14412641525269, 198.35631275177002, 199.56878232955933, 200.78125190734863, 202.00639152526855, 203.23153114318848, 204.29749250411987, 205.36345386505127, 206.4323389530182, 207.5012240409851, 208.56779599189758, 209.63436794281006, 210.7049412727356, 211.77551460266113, 212.85482382774353, 213.93413305282593, 215.0203878879547, 216.1066427230835, 217.19098281860352, 218.27532291412354, 219.3616669178009, 220.44801092147827, 221.5555419921875, 222.66307306289673, 223.7721209526062, 224.88116884231567, 225.98054432868958, 227.07991981506348, 229.31113243103027, 231.54234504699707]
[41.2, 41.2, 47.12, 47.12, 45.06, 45.06, 48.94, 48.94, 52.38, 52.38, 52.52, 52.52, 52.94, 52.94, 52.32, 52.32, 53.66, 53.66, 53.88, 53.88, 53.54, 53.54, 53.1, 53.1, 54.02, 54.02, 53.84, 53.84, 54.9, 54.9, 54.2, 54.2, 54.38, 54.38, 54.28, 54.28, 53.44, 53.44, 54.16, 54.16, 53.78, 53.78, 52.84, 52.84, 53.0, 53.0, 52.44, 52.44, 51.96, 51.96, 51.76, 51.76, 52.76, 52.76, 52.26, 52.26, 51.76, 51.76, 50.24, 50.24, 49.22, 49.22, 49.22, 49.22, 49.56, 49.56, 49.36, 49.36, 48.78, 48.78, 49.18, 49.18, 49.1, 49.1, 48.32, 48.32, 48.62, 48.62, 48.72, 48.72, 48.24, 48.24, 48.24, 48.24, 47.96, 47.96, 47.14, 47.14, 47.8, 47.8, 46.96, 46.96, 47.0, 47.0, 46.62, 46.62, 46.16, 46.16, 45.36, 45.36, 45.34, 45.34, 45.84, 45.84, 46.1, 46.1, 44.64, 44.64, 44.36, 44.36, 45.48, 45.48, 46.24, 46.24, 45.9, 45.9, 45.32, 45.32, 46.42, 46.42, 47.04, 47.04, 45.46, 45.46, 46.12, 46.12, 46.68, 46.68, 46.74, 46.74, 46.68, 46.68, 47.52, 47.52, 47.1, 47.1, 47.14, 47.14, 47.56, 47.56, 46.5, 46.5, 45.6, 45.6, 45.58, 45.58, 46.78, 46.78, 46.32, 46.32, 45.8, 45.8, 45.98, 45.98, 46.18, 46.18, 47.22, 47.22, 47.16, 47.16, 46.82, 46.82, 47.34, 47.34, 46.98, 46.98, 46.86, 46.86, 46.66, 46.66, 47.2, 47.2, 46.24, 46.24, 46.58, 46.58, 47.34, 47.34, 47.36, 47.36, 47.22, 47.22, 47.64, 47.64, 47.64, 47.64, 47.64, 47.64, 47.4, 47.4, 48.46, 48.46, 48.28, 48.28, 48.54, 48.54, 48.68, 48.68, 48.74, 48.74, 48.5, 48.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.589, Test loss: 1.568, Test accuracy: 38.28
Round   0, Global train loss: 1.589, Global test loss: 1.568, Global test accuracy: 42.80
Round   1, Train loss: 1.519, Test loss: 1.456, Test accuracy: 42.86
Round   1, Global train loss: 1.519, Global test loss: 1.424, Global test accuracy: 48.20
Round   2, Train loss: 1.485, Test loss: 1.408, Test accuracy: 42.18
Round   2, Global train loss: 1.485, Global test loss: 1.322, Global test accuracy: 47.80
Round   3, Train loss: 1.505, Test loss: 1.387, Test accuracy: 44.28
Round   3, Global train loss: 1.505, Global test loss: 1.329, Global test accuracy: 48.80
Round   4, Train loss: 1.517, Test loss: 1.357, Test accuracy: 48.90
Round   4, Global train loss: 1.517, Global test loss: 1.313, Global test accuracy: 55.00
Round   5, Train loss: 1.515, Test loss: 1.336, Test accuracy: 51.10
Round   5, Global train loss: 1.515, Global test loss: 1.307, Global test accuracy: 57.20
Round   6, Train loss: 1.501, Test loss: 1.305, Test accuracy: 52.74
Round   6, Global train loss: 1.501, Global test loss: 1.269, Global test accuracy: 56.80
Round   7, Train loss: 1.477, Test loss: 1.291, Test accuracy: 52.36
Round   7, Global train loss: 1.477, Global test loss: 1.212, Global test accuracy: 59.60
Round   8, Train loss: 1.478, Test loss: 1.274, Test accuracy: 51.46
Round   8, Global train loss: 1.478, Global test loss: 1.179, Global test accuracy: 59.80
Round   9, Train loss: 1.431, Test loss: 1.251, Test accuracy: 52.46
Round   9, Global train loss: 1.431, Global test loss: 1.199, Global test accuracy: 59.40
Round  10, Train loss: 1.371, Test loss: 1.229, Test accuracy: 53.78
Round  10, Global train loss: 1.371, Global test loss: 1.119, Global test accuracy: 58.80
Round  11, Train loss: 1.368, Test loss: 1.211, Test accuracy: 54.76
Round  11, Global train loss: 1.368, Global test loss: 1.093, Global test accuracy: 61.80
Round  12, Train loss: 1.370, Test loss: 1.206, Test accuracy: 55.76
Round  12, Global train loss: 1.370, Global test loss: 1.135, Global test accuracy: 62.40
Round  13, Train loss: 1.447, Test loss: 1.213, Test accuracy: 56.32
Round  13, Global train loss: 1.447, Global test loss: 1.182, Global test accuracy: 63.60
Round  14, Train loss: 1.421, Test loss: 1.201, Test accuracy: 57.22
Round  14, Global train loss: 1.421, Global test loss: 1.149, Global test accuracy: 61.60
Round  15, Train loss: 1.261, Test loss: 1.181, Test accuracy: 57.86
Round  15, Global train loss: 1.261, Global test loss: 1.055, Global test accuracy: 64.00
Round  16, Train loss: 1.342, Test loss: 1.174, Test accuracy: 57.66
Round  16, Global train loss: 1.342, Global test loss: 1.050, Global test accuracy: 62.00
Round  17, Train loss: 1.353, Test loss: 1.185, Test accuracy: 57.46
Round  17, Global train loss: 1.353, Global test loss: 1.095, Global test accuracy: 64.00
Round  18, Train loss: 1.404, Test loss: 1.184, Test accuracy: 58.28
Round  18, Global train loss: 1.404, Global test loss: 1.171, Global test accuracy: 64.20
Round  19, Train loss: 1.392, Test loss: 1.188, Test accuracy: 57.70
Round  19, Global train loss: 1.392, Global test loss: 1.207, Global test accuracy: 60.00
Round  20, Train loss: 1.427, Test loss: 1.173, Test accuracy: 58.10
Round  20, Global train loss: 1.427, Global test loss: 1.176, Global test accuracy: 60.60
Round  21, Train loss: 1.348, Test loss: 1.160, Test accuracy: 57.80
Round  21, Global train loss: 1.348, Global test loss: 1.116, Global test accuracy: 61.00
Round  22, Train loss: 1.281, Test loss: 1.172, Test accuracy: 56.86
Round  22, Global train loss: 1.281, Global test loss: 1.044, Global test accuracy: 64.20
Round  23, Train loss: 1.257, Test loss: 1.164, Test accuracy: 57.10
Round  23, Global train loss: 1.257, Global test loss: 1.062, Global test accuracy: 61.40
Round  24, Train loss: 1.241, Test loss: 1.185, Test accuracy: 55.34
Round  24, Global train loss: 1.241, Global test loss: 1.073, Global test accuracy: 61.40
Round  25, Train loss: 1.196, Test loss: 1.170, Test accuracy: 55.60
Round  25, Global train loss: 1.196, Global test loss: 1.069, Global test accuracy: 59.40
Round  26, Train loss: 1.305, Test loss: 1.198, Test accuracy: 54.84
Round  26, Global train loss: 1.305, Global test loss: 1.168, Global test accuracy: 59.20
Round  27, Train loss: 1.135, Test loss: 1.235, Test accuracy: 52.46
Round  27, Global train loss: 1.135, Global test loss: 1.134, Global test accuracy: 57.00
Round  28, Train loss: 1.121, Test loss: 1.270, Test accuracy: 51.08
Round  28, Global train loss: 1.121, Global test loss: 1.130, Global test accuracy: 58.20
Round  29, Train loss: 1.149, Test loss: 1.261, Test accuracy: 51.72
Round  29, Global train loss: 1.149, Global test loss: 1.135, Global test accuracy: 57.00
Round  30, Train loss: 1.172, Test loss: 1.242, Test accuracy: 52.22
Round  30, Global train loss: 1.172, Global test loss: 1.036, Global test accuracy: 62.40
Round  31, Train loss: 1.190, Test loss: 1.272, Test accuracy: 51.08
Round  31, Global train loss: 1.190, Global test loss: 1.157, Global test accuracy: 59.80
Round  32, Train loss: 1.074, Test loss: 1.263, Test accuracy: 52.06
Round  32, Global train loss: 1.074, Global test loss: 1.105, Global test accuracy: 58.20
Round  33, Train loss: 1.189, Test loss: 1.256, Test accuracy: 52.64
Round  33, Global train loss: 1.189, Global test loss: 1.105, Global test accuracy: 59.60
Round  34, Train loss: 1.085, Test loss: 1.243, Test accuracy: 54.04
Round  34, Global train loss: 1.085, Global test loss: 1.054, Global test accuracy: 62.60
Round  35, Train loss: 1.102, Test loss: 1.267, Test accuracy: 53.48
Round  35, Global train loss: 1.102, Global test loss: 1.163, Global test accuracy: 56.80
Round  36, Train loss: 1.118, Test loss: 1.290, Test accuracy: 52.42
Round  36, Global train loss: 1.118, Global test loss: 1.132, Global test accuracy: 60.20
Round  37, Train loss: 1.085, Test loss: 1.302, Test accuracy: 51.72
Round  37, Global train loss: 1.085, Global test loss: 1.198, Global test accuracy: 52.20
Round  38, Train loss: 1.032, Test loss: 1.308, Test accuracy: 51.38
Round  38, Global train loss: 1.032, Global test loss: 1.233, Global test accuracy: 54.00
Round  39, Train loss: 0.910, Test loss: 1.359, Test accuracy: 49.88
Round  39, Global train loss: 0.910, Global test loss: 1.156, Global test accuracy: 55.80
Round  40, Train loss: 1.055, Test loss: 1.354, Test accuracy: 49.86
Round  40, Global train loss: 1.055, Global test loss: 1.129, Global test accuracy: 57.20
Round  41, Train loss: 0.899, Test loss: 1.385, Test accuracy: 49.16
Round  41, Global train loss: 0.899, Global test loss: 1.290, Global test accuracy: 54.40
Round  42, Train loss: 0.908, Test loss: 1.374, Test accuracy: 49.96
Round  42, Global train loss: 0.908, Global test loss: 1.203, Global test accuracy: 54.40
Round  43, Train loss: 0.822, Test loss: 1.415, Test accuracy: 49.36
Round  43, Global train loss: 0.822, Global test loss: 1.277, Global test accuracy: 53.40
Round  44, Train loss: 0.822, Test loss: 1.411, Test accuracy: 49.90
Round  44, Global train loss: 0.822, Global test loss: 1.286, Global test accuracy: 51.40
Round  45, Train loss: 0.668, Test loss: 1.424, Test accuracy: 49.88
Round  45, Global train loss: 0.668, Global test loss: 1.357, Global test accuracy: 52.60
Round  46, Train loss: 0.837, Test loss: 1.514, Test accuracy: 48.42
Round  46, Global train loss: 0.837, Global test loss: 1.246, Global test accuracy: 54.20
Round  47, Train loss: 0.769, Test loss: 1.492, Test accuracy: 49.46
Round  47, Global train loss: 0.769, Global test loss: 1.260, Global test accuracy: 54.40
Round  48, Train loss: 0.754, Test loss: 1.527, Test accuracy: 49.90
Round  48, Global train loss: 0.754, Global test loss: 1.427, Global test accuracy: 53.20
Round  49, Train loss: 0.698, Test loss: 1.550, Test accuracy: 50.38
Round  49, Global train loss: 0.698, Global test loss: 1.397, Global test accuracy: 53.40
Round  50, Train loss: 0.818, Test loss: 1.574, Test accuracy: 49.36
Round  50, Global train loss: 0.818, Global test loss: 1.234, Global test accuracy: 54.00
Round  51, Train loss: 0.737, Test loss: 1.590, Test accuracy: 49.06
Round  51, Global train loss: 0.737, Global test loss: 1.460, Global test accuracy: 50.00
Round  52, Train loss: 0.654, Test loss: 1.604, Test accuracy: 48.86
Round  52, Global train loss: 0.654, Global test loss: 1.295, Global test accuracy: 55.80
Round  53, Train loss: 0.604, Test loss: 1.610, Test accuracy: 49.70
Round  53, Global train loss: 0.604, Global test loss: 1.272, Global test accuracy: 56.20
Round  54, Train loss: 0.620, Test loss: 1.666, Test accuracy: 49.36
Round  54, Global train loss: 0.620, Global test loss: 1.596, Global test accuracy: 47.40
Round  55, Train loss: 0.479, Test loss: 1.772, Test accuracy: 48.38
Round  55, Global train loss: 0.479, Global test loss: 1.700, Global test accuracy: 49.80
Round  56, Train loss: 0.627, Test loss: 1.754, Test accuracy: 47.82
Round  56, Global train loss: 0.627, Global test loss: 1.510, Global test accuracy: 45.40
Round  57, Train loss: 0.614, Test loss: 1.755, Test accuracy: 47.62
Round  57, Global train loss: 0.614, Global test loss: 1.481, Global test accuracy: 50.80
Round  58, Train loss: 0.568, Test loss: 1.732, Test accuracy: 48.40
Round  58, Global train loss: 0.568, Global test loss: 1.394, Global test accuracy: 54.20
Round  59, Train loss: 0.725, Test loss: 1.759, Test accuracy: 49.02
Round  59, Global train loss: 0.725, Global test loss: 1.382, Global test accuracy: 52.00
Round  60, Train loss: 0.537, Test loss: 1.772, Test accuracy: 49.22
Round  60, Global train loss: 0.537, Global test loss: 1.507, Global test accuracy: 53.40
Round  61, Train loss: 0.433, Test loss: 1.779, Test accuracy: 49.20
Round  61, Global train loss: 0.433, Global test loss: 1.477, Global test accuracy: 54.40
Round  62, Train loss: 0.470, Test loss: 1.855, Test accuracy: 48.68
Round  62, Global train loss: 0.470, Global test loss: 1.521, Global test accuracy: 54.00
Round  63, Train loss: 0.473, Test loss: 1.899, Test accuracy: 48.12
Round  63, Global train loss: 0.473, Global test loss: 1.684, Global test accuracy: 49.00
Round  64, Train loss: 0.638, Test loss: 1.978, Test accuracy: 47.28
Round  64, Global train loss: 0.638, Global test loss: 1.619, Global test accuracy: 48.80
Round  65, Train loss: 0.334, Test loss: 1.893, Test accuracy: 48.30
Round  65, Global train loss: 0.334, Global test loss: 1.728, Global test accuracy: 52.80
Round  66, Train loss: 0.436, Test loss: 1.948, Test accuracy: 48.50
Round  66, Global train loss: 0.436, Global test loss: 1.696, Global test accuracy: 51.60
Round  67, Train loss: 0.343, Test loss: 2.023, Test accuracy: 47.80
Round  67, Global train loss: 0.343, Global test loss: 1.756, Global test accuracy: 51.80
Round  68, Train loss: 0.386, Test loss: 1.977, Test accuracy: 48.50
Round  68, Global train loss: 0.386, Global test loss: 1.648, Global test accuracy: 54.80
Round  69, Train loss: 0.326, Test loss: 1.999, Test accuracy: 48.38
Round  69, Global train loss: 0.326, Global test loss: 1.737, Global test accuracy: 51.80
Round  70, Train loss: 0.337, Test loss: 1.992, Test accuracy: 48.72
Round  70, Global train loss: 0.337, Global test loss: 1.781, Global test accuracy: 49.80
Round  71, Train loss: 0.532, Test loss: 1.965, Test accuracy: 48.82
Round  71, Global train loss: 0.532, Global test loss: 1.553, Global test accuracy: 51.20
Round  72, Train loss: 0.345, Test loss: 1.985, Test accuracy: 48.80
Round  72, Global train loss: 0.345, Global test loss: 1.848, Global test accuracy: 49.40
Round  73, Train loss: 0.602, Test loss: 2.086, Test accuracy: 47.96
Round  73, Global train loss: 0.602, Global test loss: 1.619, Global test accuracy: 49.80
Round  74, Train loss: 0.272, Test loss: 2.145, Test accuracy: 47.24
Round  74, Global train loss: 0.272, Global test loss: 1.805, Global test accuracy: 50.60
Round  75, Train loss: 0.408, Test loss: 2.129, Test accuracy: 47.38
Round  75, Global train loss: 0.408, Global test loss: 1.542, Global test accuracy: 53.40
Round  76, Train loss: 0.330, Test loss: 2.017, Test accuracy: 48.80
Round  76, Global train loss: 0.330, Global test loss: 1.521, Global test accuracy: 54.00
Round  77, Train loss: 0.322, Test loss: 2.128, Test accuracy: 47.58
Round  77, Global train loss: 0.322, Global test loss: 1.865, Global test accuracy: 47.60
Round  78, Train loss: 0.381, Test loss: 2.165, Test accuracy: 47.32
Round  78, Global train loss: 0.381, Global test loss: 1.853, Global test accuracy: 46.20
Round  79, Train loss: 0.277, Test loss: 2.237, Test accuracy: 46.90
Round  79, Global train loss: 0.277, Global test loss: 1.900, Global test accuracy: 53.20
Round  80, Train loss: 0.299, Test loss: 2.249, Test accuracy: 47.90
Round  80, Global train loss: 0.299, Global test loss: 1.917, Global test accuracy: 52.20
Round  81, Train loss: 0.333, Test loss: 2.264, Test accuracy: 47.88
Round  81, Global train loss: 0.333, Global test loss: 1.690, Global test accuracy: 51.40
Round  82, Train loss: 0.259, Test loss: 2.189, Test accuracy: 48.06
Round  82, Global train loss: 0.259, Global test loss: 1.961, Global test accuracy: 47.60
Round  83, Train loss: 0.234, Test loss: 2.180, Test accuracy: 48.70
Round  83, Global train loss: 0.234, Global test loss: 1.923, Global test accuracy: 49.00
Round  84, Train loss: 0.199, Test loss: 2.225, Test accuracy: 48.98
Round  84, Global train loss: 0.199, Global test loss: 2.223, Global test accuracy: 51.80
Round  85, Train loss: 0.274, Test loss: 2.243, Test accuracy: 49.38
Round  85, Global train loss: 0.274, Global test loss: 2.022, Global test accuracy: 50.80
Round  86, Train loss: 0.376, Test loss: 2.233, Test accuracy: 49.60
Round  86, Global train loss: 0.376, Global test loss: 1.763, Global test accuracy: 51.00
Round  87, Train loss: 0.156, Test loss: 2.229, Test accuracy: 49.08
Round  87, Global train loss: 0.156, Global test loss: 2.272, Global test accuracy: 51.40
Round  88, Train loss: 0.220, Test loss: 2.307, Test accuracy: 48.68
Round  88, Global train loss: 0.220, Global test loss: 2.076, Global test accuracy: 48.80
Round  89, Train loss: 0.153, Test loss: 2.330, Test accuracy: 48.98
Round  89, Global train loss: 0.153, Global test loss: 2.332, Global test accuracy: 51.80
Round  90, Train loss: 0.286, Test loss: 2.369, Test accuracy: 49.48
Round  90, Global train loss: 0.286, Global test loss: 1.950, Global test accuracy: 53.60
Round  91, Train loss: 0.438, Test loss: 2.377, Test accuracy: 48.80
Round  91, Global train loss: 0.438, Global test loss: 1.900, Global test accuracy: 48.60
Round  92, Train loss: 0.190, Test loss: 2.346, Test accuracy: 48.98
Round  92, Global train loss: 0.190, Global test loss: 2.097, Global test accuracy: 50.40
Round  93, Train loss: 0.257, Test loss: 2.344, Test accuracy: 47.88
Round  93, Global train loss: 0.257, Global test loss: 2.005, Global test accuracy: 50.20/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.198, Test loss: 2.397, Test accuracy: 47.14
Round  94, Global train loss: 0.198, Global test loss: 2.204, Global test accuracy: 51.40
Round  95, Train loss: 0.277, Test loss: 2.428, Test accuracy: 47.64
Round  95, Global train loss: 0.277, Global test loss: 1.897, Global test accuracy: 54.40
Round  96, Train loss: 0.334, Test loss: 2.462, Test accuracy: 46.56
Round  96, Global train loss: 0.334, Global test loss: 1.874, Global test accuracy: 50.60
Round  97, Train loss: 0.168, Test loss: 2.498, Test accuracy: 46.52
Round  97, Global train loss: 0.168, Global test loss: 2.243, Global test accuracy: 51.40
Round  98, Train loss: 0.264, Test loss: 2.468, Test accuracy: 47.36
Round  98, Global train loss: 0.264, Global test loss: 2.076, Global test accuracy: 50.00
Round  99, Train loss: 0.257, Test loss: 2.470, Test accuracy: 47.98
Round  99, Global train loss: 0.257, Global test loss: 2.024, Global test accuracy: 53.20
Final Round, Train loss: 0.198, Test loss: 2.536, Test accuracy: 48.80
Final Round, Global train loss: 0.198, Global test loss: 2.024, Global test accuracy: 53.20
Average accuracy final 10 rounds: 47.834 

Average global accuracy final 10 rounds: 51.38 

898.7175543308258
[1.5842859745025635, 3.168571949005127, 4.500164985656738, 5.83175802230835, 7.128540277481079, 8.425322532653809, 9.716391324996948, 11.007460117340088, 12.298270463943481, 13.589080810546875, 14.886869430541992, 16.18465805053711, 17.466434717178345, 18.74821138381958, 20.013477087020874, 21.278742790222168, 22.58051037788391, 23.882277965545654, 25.16708755493164, 26.451897144317627, 27.7656192779541, 29.079341411590576, 30.370411157608032, 31.66148090362549, 32.954895973205566, 34.248311042785645, 35.605000019073486, 36.96168899536133, 38.14148569107056, 39.321282386779785, 40.48447346687317, 41.64766454696655, 42.81072449684143, 43.97378444671631, 45.14546012878418, 46.31713581085205, 47.485219955444336, 48.65330410003662, 49.814173460006714, 50.97504281997681, 52.13990664482117, 53.30477046966553, 54.46910572052002, 55.63344097137451, 56.79640054702759, 57.959360122680664, 59.11560320854187, 60.271846294403076, 61.43767309188843, 62.60349988937378, 63.77228593826294, 64.9410719871521, 66.11809349060059, 67.29511499404907, 68.47933292388916, 69.66355085372925, 70.84867024421692, 72.03378963470459, 73.21816205978394, 74.40253448486328, 75.57867741584778, 76.75482034683228, 77.92318987846375, 79.09155941009521, 80.26383972167969, 81.43612003326416, 82.60484075546265, 83.77356147766113, 84.96074628829956, 86.14793109893799, 87.5479028224945, 88.94787454605103, 90.29440546035767, 91.6409363746643, 92.94918608665466, 94.25743579864502, 95.54807925224304, 96.83872270584106, 98.12990522384644, 99.4210877418518, 100.74014663696289, 102.05920553207397, 103.3884072303772, 104.71760892868042, 106.04080414772034, 107.36399936676025, 108.68491005897522, 110.00582075119019, 111.38803958892822, 112.77025842666626, 114.13410639762878, 115.49795436859131, 116.82141375541687, 118.14487314224243, 119.49917483329773, 120.85347652435303, 122.14244937896729, 123.43142223358154, 124.75990152359009, 126.08838081359863, 127.47309112548828, 128.85780143737793, 130.21141028404236, 131.5650191307068, 132.97043585777283, 134.37585258483887, 135.7174220085144, 137.05899143218994, 138.42964696884155, 139.80030250549316, 141.1790714263916, 142.55784034729004, 143.8344235420227, 145.11100673675537, 146.44633865356445, 147.78167057037354, 149.1235523223877, 150.46543407440186, 151.86643600463867, 153.2674379348755, 154.6740801334381, 156.08072233200073, 157.43178176879883, 158.78284120559692, 160.1088993549347, 161.43495750427246, 162.88677215576172, 164.33858680725098, 165.6807734966278, 167.02296018600464, 168.38273668289185, 169.74251317977905, 171.0876123905182, 172.43271160125732, 173.8322832584381, 175.2318549156189, 176.78454065322876, 178.33722639083862, 179.8032443523407, 181.26926231384277, 182.79768633842468, 184.3261103630066, 185.8634181022644, 187.40072584152222, 188.92971849441528, 190.45871114730835, 191.93151903152466, 193.40432691574097, 194.97579288482666, 196.54725885391235, 198.14558386802673, 199.7439088821411, 201.32272481918335, 202.9015407562256, 205.13851141929626, 207.37548208236694, 209.42237854003906, 211.46927499771118, 213.51702785491943, 215.56478071212769, 217.57949829101562, 219.59421586990356, 221.31832075119019, 223.0424256324768, 224.9929621219635, 226.9434986114502, 228.59255599975586, 230.24161338806152, 231.88878202438354, 233.53595066070557, 235.37729692459106, 237.21864318847656, 239.08382749557495, 240.94901180267334, 242.95727801322937, 244.9655442237854, 247.02907538414001, 249.09260654449463, 251.1378149986267, 253.1830234527588, 255.2945110797882, 257.4059987068176, 259.3460569381714, 261.28611516952515, 262.9396085739136, 264.593101978302, 266.26405024528503, 267.93499851226807, 269.52987003326416, 271.12474155426025, 272.693235874176, 274.2617301940918, 275.82289457321167, 277.38405895233154, 278.8987934589386, 280.41352796554565, 281.9629154205322, 283.5123028755188, 285.1541130542755, 286.7959232330322, 289.9868788719177, 293.1778345108032]
[38.28, 38.28, 42.86, 42.86, 42.18, 42.18, 44.28, 44.28, 48.9, 48.9, 51.1, 51.1, 52.74, 52.74, 52.36, 52.36, 51.46, 51.46, 52.46, 52.46, 53.78, 53.78, 54.76, 54.76, 55.76, 55.76, 56.32, 56.32, 57.22, 57.22, 57.86, 57.86, 57.66, 57.66, 57.46, 57.46, 58.28, 58.28, 57.7, 57.7, 58.1, 58.1, 57.8, 57.8, 56.86, 56.86, 57.1, 57.1, 55.34, 55.34, 55.6, 55.6, 54.84, 54.84, 52.46, 52.46, 51.08, 51.08, 51.72, 51.72, 52.22, 52.22, 51.08, 51.08, 52.06, 52.06, 52.64, 52.64, 54.04, 54.04, 53.48, 53.48, 52.42, 52.42, 51.72, 51.72, 51.38, 51.38, 49.88, 49.88, 49.86, 49.86, 49.16, 49.16, 49.96, 49.96, 49.36, 49.36, 49.9, 49.9, 49.88, 49.88, 48.42, 48.42, 49.46, 49.46, 49.9, 49.9, 50.38, 50.38, 49.36, 49.36, 49.06, 49.06, 48.86, 48.86, 49.7, 49.7, 49.36, 49.36, 48.38, 48.38, 47.82, 47.82, 47.62, 47.62, 48.4, 48.4, 49.02, 49.02, 49.22, 49.22, 49.2, 49.2, 48.68, 48.68, 48.12, 48.12, 47.28, 47.28, 48.3, 48.3, 48.5, 48.5, 47.8, 47.8, 48.5, 48.5, 48.38, 48.38, 48.72, 48.72, 48.82, 48.82, 48.8, 48.8, 47.96, 47.96, 47.24, 47.24, 47.38, 47.38, 48.8, 48.8, 47.58, 47.58, 47.32, 47.32, 46.9, 46.9, 47.9, 47.9, 47.88, 47.88, 48.06, 48.06, 48.7, 48.7, 48.98, 48.98, 49.38, 49.38, 49.6, 49.6, 49.08, 49.08, 48.68, 48.68, 48.98, 48.98, 49.48, 49.48, 48.8, 48.8, 48.98, 48.98, 47.88, 47.88, 47.14, 47.14, 47.64, 47.64, 46.56, 46.56, 46.52, 46.52, 47.36, 47.36, 47.98, 47.98, 48.8, 48.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.573, Test loss: 1.562, Test accuracy: 38.38
Round   0, Global train loss: 1.573, Global test loss: 1.565, Global test accuracy: 41.60
Round   1, Train loss: 1.503, Test loss: 1.495, Test accuracy: 42.98
Round   1, Global train loss: 1.503, Global test loss: 1.470, Global test accuracy: 48.60
Round   2, Train loss: 1.429, Test loss: 1.493, Test accuracy: 41.14
Round   2, Global train loss: 1.429, Global test loss: 1.411, Global test accuracy: 45.40
Round   3, Train loss: 1.436, Test loss: 1.423, Test accuracy: 48.20
Round   3, Global train loss: 1.436, Global test loss: 1.358, Global test accuracy: 52.00
Round   4, Train loss: 1.494, Test loss: 1.413, Test accuracy: 51.24
Round   4, Global train loss: 1.494, Global test loss: 1.381, Global test accuracy: 55.60
Round   5, Train loss: 1.364, Test loss: 1.405, Test accuracy: 50.94
Round   5, Global train loss: 1.364, Global test loss: 1.316, Global test accuracy: 58.40
Round   6, Train loss: 1.285, Test loss: 1.410, Test accuracy: 52.16
Round   6, Global train loss: 1.285, Global test loss: 1.333, Global test accuracy: 59.00
Round   7, Train loss: 1.401, Test loss: 1.381, Test accuracy: 52.02
Round   7, Global train loss: 1.401, Global test loss: 1.322, Global test accuracy: 53.00
Round   8, Train loss: 1.458, Test loss: 1.363, Test accuracy: 53.44
Round   8, Global train loss: 1.458, Global test loss: 1.303, Global test accuracy: 57.40
Round   9, Train loss: 1.225, Test loss: 1.332, Test accuracy: 54.86
Round   9, Global train loss: 1.225, Global test loss: 1.251, Global test accuracy: 61.60
Round  10, Train loss: 1.374, Test loss: 1.336, Test accuracy: 55.20
Round  10, Global train loss: 1.374, Global test loss: 1.313, Global test accuracy: 57.80
Round  11, Train loss: 1.395, Test loss: 1.363, Test accuracy: 54.40
Round  11, Global train loss: 1.395, Global test loss: 1.307, Global test accuracy: 56.60
Round  12, Train loss: 1.220, Test loss: 1.376, Test accuracy: 53.96
Round  12, Global train loss: 1.220, Global test loss: 1.356, Global test accuracy: 58.20
Round  13, Train loss: 1.364, Test loss: 1.371, Test accuracy: 54.06
Round  13, Global train loss: 1.364, Global test loss: 1.275, Global test accuracy: 60.00
Round  14, Train loss: 1.244, Test loss: 1.362, Test accuracy: 54.46
Round  14, Global train loss: 1.244, Global test loss: 1.215, Global test accuracy: 60.80
Round  15, Train loss: 1.291, Test loss: 1.332, Test accuracy: 54.06
Round  15, Global train loss: 1.291, Global test loss: 1.351, Global test accuracy: 53.00
Round  16, Train loss: 1.359, Test loss: 1.330, Test accuracy: 54.14
Round  16, Global train loss: 1.359, Global test loss: 1.268, Global test accuracy: 60.00
Round  17, Train loss: 1.289, Test loss: 1.321, Test accuracy: 54.54
Round  17, Global train loss: 1.289, Global test loss: 1.209, Global test accuracy: 59.80
Round  18, Train loss: 1.242, Test loss: 1.330, Test accuracy: 54.50
Round  18, Global train loss: 1.242, Global test loss: 1.272, Global test accuracy: 61.00
Round  19, Train loss: 1.271, Test loss: 1.321, Test accuracy: 54.62
Round  19, Global train loss: 1.271, Global test loss: 1.316, Global test accuracy: 58.80
Round  20, Train loss: 1.126, Test loss: 1.342, Test accuracy: 53.48
Round  20, Global train loss: 1.126, Global test loss: 1.101, Global test accuracy: 59.40
Round  21, Train loss: 1.144, Test loss: 1.321, Test accuracy: 53.90
Round  21, Global train loss: 1.144, Global test loss: 1.175, Global test accuracy: 58.00
Round  22, Train loss: 1.138, Test loss: 1.306, Test accuracy: 54.14
Round  22, Global train loss: 1.138, Global test loss: 1.170, Global test accuracy: 61.60
Round  23, Train loss: 1.166, Test loss: 1.320, Test accuracy: 51.68
Round  23, Global train loss: 1.166, Global test loss: 1.209, Global test accuracy: 54.40
Round  24, Train loss: 1.055, Test loss: 1.315, Test accuracy: 51.62
Round  24, Global train loss: 1.055, Global test loss: 1.236, Global test accuracy: 54.40
Round  25, Train loss: 1.170, Test loss: 1.324, Test accuracy: 50.98
Round  25, Global train loss: 1.170, Global test loss: 1.338, Global test accuracy: 51.00
Round  26, Train loss: 1.134, Test loss: 1.316, Test accuracy: 51.52
Round  26, Global train loss: 1.134, Global test loss: 1.165, Global test accuracy: 54.20
Round  27, Train loss: 1.242, Test loss: 1.325, Test accuracy: 49.42
Round  27, Global train loss: 1.242, Global test loss: 1.344, Global test accuracy: 46.20
Round  28, Train loss: 1.005, Test loss: 1.356, Test accuracy: 49.28
Round  28, Global train loss: 1.005, Global test loss: 1.302, Global test accuracy: 50.20
Round  29, Train loss: 1.037, Test loss: 1.328, Test accuracy: 49.18
Round  29, Global train loss: 1.037, Global test loss: 1.215, Global test accuracy: 51.60
Round  30, Train loss: 1.029, Test loss: 1.366, Test accuracy: 49.62
Round  30, Global train loss: 1.029, Global test loss: 1.114, Global test accuracy: 58.20
Round  31, Train loss: 1.097, Test loss: 1.366, Test accuracy: 48.84
Round  31, Global train loss: 1.097, Global test loss: 1.115, Global test accuracy: 58.60
Round  32, Train loss: 0.891, Test loss: 1.334, Test accuracy: 49.00
Round  32, Global train loss: 0.891, Global test loss: 1.202, Global test accuracy: 55.40
Round  33, Train loss: 0.963, Test loss: 1.387, Test accuracy: 48.34
Round  33, Global train loss: 0.963, Global test loss: 1.107, Global test accuracy: 59.40
Round  34, Train loss: 1.002, Test loss: 1.407, Test accuracy: 47.68
Round  34, Global train loss: 1.002, Global test loss: 1.139, Global test accuracy: 56.00
Round  35, Train loss: 0.914, Test loss: 1.443, Test accuracy: 47.66
Round  35, Global train loss: 0.914, Global test loss: 1.160, Global test accuracy: 57.00
Round  36, Train loss: 0.877, Test loss: 1.426, Test accuracy: 47.74
Round  36, Global train loss: 0.877, Global test loss: 1.097, Global test accuracy: 58.40
Round  37, Train loss: 0.939, Test loss: 1.490, Test accuracy: 47.06
Round  37, Global train loss: 0.939, Global test loss: 1.316, Global test accuracy: 49.00
Round  38, Train loss: 0.914, Test loss: 1.504, Test accuracy: 46.28
Round  38, Global train loss: 0.914, Global test loss: 1.330, Global test accuracy: 47.20
Round  39, Train loss: 0.861, Test loss: 1.573, Test accuracy: 44.40
Round  39, Global train loss: 0.861, Global test loss: 1.299, Global test accuracy: 51.40
Round  40, Train loss: 0.760, Test loss: 1.608, Test accuracy: 45.00
Round  40, Global train loss: 0.760, Global test loss: 1.045, Global test accuracy: 62.20
Round  41, Train loss: 0.743, Test loss: 1.635, Test accuracy: 44.66
Round  41, Global train loss: 0.743, Global test loss: 1.417, Global test accuracy: 49.40
Round  42, Train loss: 0.707, Test loss: 1.674, Test accuracy: 44.50
Round  42, Global train loss: 0.707, Global test loss: 1.390, Global test accuracy: 49.40
Round  43, Train loss: 0.631, Test loss: 1.711, Test accuracy: 43.96
Round  43, Global train loss: 0.631, Global test loss: 1.461, Global test accuracy: 45.80
Round  44, Train loss: 0.683, Test loss: 1.751, Test accuracy: 44.88
Round  44, Global train loss: 0.683, Global test loss: 1.618, Global test accuracy: 47.80
Round  45, Train loss: 0.669, Test loss: 1.840, Test accuracy: 45.06
Round  45, Global train loss: 0.669, Global test loss: 1.821, Global test accuracy: 45.60
Round  46, Train loss: 0.719, Test loss: 1.893, Test accuracy: 44.64
Round  46, Global train loss: 0.719, Global test loss: 1.416, Global test accuracy: 50.80
Round  47, Train loss: 0.682, Test loss: 1.927, Test accuracy: 44.60
Round  47, Global train loss: 0.682, Global test loss: 1.466, Global test accuracy: 50.80
Round  48, Train loss: 0.545, Test loss: 1.903, Test accuracy: 44.44
Round  48, Global train loss: 0.545, Global test loss: 1.629, Global test accuracy: 48.20
Round  49, Train loss: 0.620, Test loss: 1.927, Test accuracy: 44.88
Round  49, Global train loss: 0.620, Global test loss: 1.755, Global test accuracy: 46.20
Round  50, Train loss: 0.675, Test loss: 1.983, Test accuracy: 44.76
Round  50, Global train loss: 0.675, Global test loss: 1.362, Global test accuracy: 54.40
Round  51, Train loss: 0.496, Test loss: 1.979, Test accuracy: 45.42
Round  51, Global train loss: 0.496, Global test loss: 1.524, Global test accuracy: 53.20
Round  52, Train loss: 0.574, Test loss: 2.016, Test accuracy: 44.74
Round  52, Global train loss: 0.574, Global test loss: 1.550, Global test accuracy: 50.40
Round  53, Train loss: 0.518, Test loss: 2.075, Test accuracy: 44.32
Round  53, Global train loss: 0.518, Global test loss: 1.618, Global test accuracy: 48.80
Round  54, Train loss: 0.477, Test loss: 2.097, Test accuracy: 44.40
Round  54, Global train loss: 0.477, Global test loss: 1.758, Global test accuracy: 48.40
Round  55, Train loss: 0.521, Test loss: 2.161, Test accuracy: 44.06
Round  55, Global train loss: 0.521, Global test loss: 2.091, Global test accuracy: 37.60
Round  56, Train loss: 0.525, Test loss: 2.207, Test accuracy: 43.86
Round  56, Global train loss: 0.525, Global test loss: 1.822, Global test accuracy: 44.60
Round  57, Train loss: 0.503, Test loss: 2.213, Test accuracy: 44.34
Round  57, Global train loss: 0.503, Global test loss: 1.700, Global test accuracy: 47.60
Round  58, Train loss: 0.530, Test loss: 2.252, Test accuracy: 42.74
Round  58, Global train loss: 0.530, Global test loss: 1.698, Global test accuracy: 44.60
Round  59, Train loss: 0.463, Test loss: 2.282, Test accuracy: 43.00
Round  59, Global train loss: 0.463, Global test loss: 1.493, Global test accuracy: 56.20
Round  60, Train loss: 0.422, Test loss: 2.285, Test accuracy: 43.76
Round  60, Global train loss: 0.422, Global test loss: 1.739, Global test accuracy: 49.40
Round  61, Train loss: 0.410, Test loss: 2.271, Test accuracy: 44.16
Round  61, Global train loss: 0.410, Global test loss: 1.862, Global test accuracy: 43.60
Round  62, Train loss: 0.430, Test loss: 2.282, Test accuracy: 44.84
Round  62, Global train loss: 0.430, Global test loss: 1.815, Global test accuracy: 48.80
Round  63, Train loss: 0.389, Test loss: 2.355, Test accuracy: 45.04
Round  63, Global train loss: 0.389, Global test loss: 2.278, Global test accuracy: 40.40
Round  64, Train loss: 0.436, Test loss: 2.355, Test accuracy: 45.12
Round  64, Global train loss: 0.436, Global test loss: 1.435, Global test accuracy: 56.20
Round  65, Train loss: 0.362, Test loss: 2.299, Test accuracy: 45.44
Round  65, Global train loss: 0.362, Global test loss: 2.296, Global test accuracy: 42.60
Round  66, Train loss: 0.361, Test loss: 2.366, Test accuracy: 44.82
Round  66, Global train loss: 0.361, Global test loss: 1.878, Global test accuracy: 49.00
Round  67, Train loss: 0.353, Test loss: 2.443, Test accuracy: 43.96
Round  67, Global train loss: 0.353, Global test loss: 2.422, Global test accuracy: 35.80
Round  68, Train loss: 0.363, Test loss: 2.445, Test accuracy: 43.74
Round  68, Global train loss: 0.363, Global test loss: 2.343, Global test accuracy: 43.80
Round  69, Train loss: 0.303, Test loss: 2.443, Test accuracy: 44.40
Round  69, Global train loss: 0.303, Global test loss: 2.491, Global test accuracy: 41.40
Round  70, Train loss: 0.259, Test loss: 2.591, Test accuracy: 43.68
Round  70, Global train loss: 0.259, Global test loss: 2.315, Global test accuracy: 44.00
Round  71, Train loss: 0.367, Test loss: 2.559, Test accuracy: 43.58
Round  71, Global train loss: 0.367, Global test loss: 1.685, Global test accuracy: 54.00
Round  72, Train loss: 0.244, Test loss: 2.557, Test accuracy: 44.06
Round  72, Global train loss: 0.244, Global test loss: 2.322, Global test accuracy: 45.40
Round  73, Train loss: 0.438, Test loss: 2.539, Test accuracy: 44.32
Round  73, Global train loss: 0.438, Global test loss: 1.368, Global test accuracy: 60.40
Round  74, Train loss: 0.241, Test loss: 2.566, Test accuracy: 43.66
Round  74, Global train loss: 0.241, Global test loss: 2.052, Global test accuracy: 45.80
Round  75, Train loss: 0.344, Test loss: 2.611, Test accuracy: 43.94
Round  75, Global train loss: 0.344, Global test loss: 1.902, Global test accuracy: 47.20
Round  76, Train loss: 0.309, Test loss: 2.694, Test accuracy: 43.90
Round  76, Global train loss: 0.309, Global test loss: 2.478, Global test accuracy: 44.00
Round  77, Train loss: 0.278, Test loss: 2.730, Test accuracy: 43.52
Round  77, Global train loss: 0.278, Global test loss: 2.579, Global test accuracy: 44.00
Round  78, Train loss: 0.292, Test loss: 2.742, Test accuracy: 44.42
Round  78, Global train loss: 0.292, Global test loss: 1.804, Global test accuracy: 50.20
Round  79, Train loss: 0.247, Test loss: 2.729, Test accuracy: 43.96
Round  79, Global train loss: 0.247, Global test loss: 2.127, Global test accuracy: 48.40
Round  80, Train loss: 0.267, Test loss: 2.739, Test accuracy: 44.50
Round  80, Global train loss: 0.267, Global test loss: 2.051, Global test accuracy: 52.00
Round  81, Train loss: 0.239, Test loss: 2.675, Test accuracy: 44.82
Round  81, Global train loss: 0.239, Global test loss: 1.999, Global test accuracy: 51.00
Round  82, Train loss: 0.242, Test loss: 2.651, Test accuracy: 44.56
Round  82, Global train loss: 0.242, Global test loss: 2.690, Global test accuracy: 38.60
Round  83, Train loss: 0.202, Test loss: 2.666, Test accuracy: 44.90
Round  83, Global train loss: 0.202, Global test loss: 2.198, Global test accuracy: 48.20
Round  84, Train loss: 0.177, Test loss: 2.665, Test accuracy: 44.98
Round  84, Global train loss: 0.177, Global test loss: 2.778, Global test accuracy: 42.40
Round  85, Train loss: 0.216, Test loss: 2.762, Test accuracy: 45.32
Round  85, Global train loss: 0.216, Global test loss: 2.413, Global test accuracy: 47.20
Round  86, Train loss: 0.227, Test loss: 2.804, Test accuracy: 44.84
Round  86, Global train loss: 0.227, Global test loss: 1.993, Global test accuracy: 56.20
Round  87, Train loss: 0.184, Test loss: 2.759, Test accuracy: 45.64
Round  87, Global train loss: 0.184, Global test loss: 2.772, Global test accuracy: 42.20
Round  88, Train loss: 0.164, Test loss: 2.806, Test accuracy: 45.44
Round  88, Global train loss: 0.164, Global test loss: 2.713, Global test accuracy: 46.00
Round  89, Train loss: 0.143, Test loss: 2.913, Test accuracy: 44.32
Round  89, Global train loss: 0.143, Global test loss: 3.228, Global test accuracy: 42.20
Round  90, Train loss: 0.219, Test loss: 2.856, Test accuracy: 45.04
Round  90, Global train loss: 0.219, Global test loss: 2.264, Global test accuracy: 49.40
Round  91, Train loss: 0.279, Test loss: 2.803, Test accuracy: 45.14
Round  91, Global train loss: 0.279, Global test loss: 1.696, Global test accuracy: 59.40
Round  92, Train loss: 0.171, Test loss: 2.864, Test accuracy: 44.94
Round  92, Global train loss: 0.171, Global test loss: 2.468, Global test accuracy: 45.40
Round  93, Train loss: 0.197, Test loss: 2.825, Test accuracy: 45.28
Round  93, Global train loss: 0.197, Global test loss: 2.695, Global test accuracy: 48.40
Round  94, Train loss: 0.163, Test loss: 2.769, Test accuracy: 45.48
Round  94, Global train loss: 0.163, Global test loss: 2.444, Global test accuracy: 50.80
Round  95, Train loss: 0.209, Test loss: 2.856, Test accuracy: 44.32
Round  95, Global train loss: 0.209, Global test loss: 2.476, Global test accuracy: 47.80
Round  96, Train loss: 0.265, Test loss: 2.847, Test accuracy: 45.04
Round  96, Global train loss: 0.265, Global test loss: 2.036, Global test accuracy: 49.40
Round  97, Train loss: 0.134, Test loss: 2.947, Test accuracy: 44.78
Round  97, Global train loss: 0.134, Global test loss: 2.315, Global test accuracy: 49.40
Round  98, Train loss: 0.206, Test loss: 2.847, Test accuracy: 45.12
Round  98, Global train loss: 0.206, Global test loss: 2.186, Global test accuracy: 50.80
Round  99, Train loss: 0.130, Test loss: 2.985, Test accuracy: 44.52
Round  99, Global train loss: 0.130, Global test loss: 2.484, Global test accuracy: 51.40
Final Round, Train loss: 0.173, Test loss: 3.100, Test accuracy: 46.18
Final Round, Global train loss: 0.173, Global test loss: 2.484, Global test accuracy: 51.40
Average accuracy final 10 rounds: 44.966
Average global accuracy final 10 rounds: 50.21999999999999
1531.875991821289
[3.998378276824951, 7.627975702285767, 11.223524570465088, 14.868919134140015, 18.523690462112427, 22.212441444396973, 25.832097053527832, 29.468283653259277, 33.15121841430664, 36.847829818725586, 40.60208034515381, 44.51236867904663, 48.14147925376892, 52.33705759048462, 56.30533003807068, 60.35258221626282, 64.42665719985962, 68.25915575027466, 71.98234558105469, 75.69075918197632, 79.38350057601929, 82.97064757347107, 86.74179172515869, 90.3840844631195, 94.17709064483643, 97.90618085861206, 101.61448383331299, 105.20126271247864, 109.07395648956299, 112.89317560195923, 116.67081260681152, 120.43093585968018, 124.14670944213867, 127.856454372406, 131.62722063064575, 135.66526460647583, 139.51599788665771, 143.26323056221008, 146.90882468223572, 150.71220779418945, 154.67305302619934, 158.52319741249084, 162.2653946876526, 166.04408764839172, 170.0106589794159, 174.1543951034546, 178.18751764297485, 181.96605157852173, 185.99154090881348, 189.93731546401978, 193.83711886405945, 197.87432837486267, 201.6744349002838, 205.42219257354736, 209.3706545829773, 213.36119890213013, 217.21861696243286, 221.1401011943817, 225.12103366851807, 228.90585827827454, 232.75807690620422, 236.7852897644043, 240.6188247203827, 244.75244665145874, 248.81741762161255, 252.75435161590576, 256.65821170806885, 260.6150486469269, 264.5113523006439, 268.69570326805115, 272.99912548065186, 277.0382421016693, 280.9972667694092, 285.36917781829834, 289.21161913871765, 292.9763526916504, 296.72045612335205, 300.8381826877594, 304.70329904556274, 308.7113835811615, 312.55737042427063, 316.2061011791229, 320.1651494503021, 324.2130079269409, 328.21330761909485, 332.034720659256, 335.93914556503296, 339.8177182674408, 343.79316806793213, 347.7205379009247, 351.7715928554535, 355.5998270511627, 359.4708414077759, 363.2802793979645, 367.1730742454529, 371.0347602367401, 375.08387303352356, 379.04314637184143, 382.9000437259674, 386.55134105682373, 393.59061002731323]
[38.38, 42.98, 41.14, 48.2, 51.24, 50.94, 52.16, 52.02, 53.44, 54.86, 55.2, 54.4, 53.96, 54.06, 54.46, 54.06, 54.14, 54.54, 54.5, 54.62, 53.48, 53.9, 54.14, 51.68, 51.62, 50.98, 51.52, 49.42, 49.28, 49.18, 49.62, 48.84, 49.0, 48.34, 47.68, 47.66, 47.74, 47.06, 46.28, 44.4, 45.0, 44.66, 44.5, 43.96, 44.88, 45.06, 44.64, 44.6, 44.44, 44.88, 44.76, 45.42, 44.74, 44.32, 44.4, 44.06, 43.86, 44.34, 42.74, 43.0, 43.76, 44.16, 44.84, 45.04, 45.12, 45.44, 44.82, 43.96, 43.74, 44.4, 43.68, 43.58, 44.06, 44.32, 43.66, 43.94, 43.9, 43.52, 44.42, 43.96, 44.5, 44.82, 44.56, 44.9, 44.98, 45.32, 44.84, 45.64, 45.44, 44.32, 45.04, 45.14, 44.94, 45.28, 45.48, 44.32, 45.04, 44.78, 45.12, 44.52, 46.18]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.620, Test loss: 1.577, Test accuracy: 33.46
Round   0, Global train loss: 1.620, Global test loss: 1.577, Global test accuracy: 35.60
Round   1, Train loss: 1.566, Test loss: 1.515, Test accuracy: 39.96
Round   1, Global train loss: 1.566, Global test loss: 1.511, Global test accuracy: 40.20
Round   2, Train loss: 1.526, Test loss: 1.431, Test accuracy: 43.64
Round   2, Global train loss: 1.526, Global test loss: 1.418, Global test accuracy: 43.00
Round   3, Train loss: 1.550, Test loss: 1.429, Test accuracy: 46.14
Round   3, Global train loss: 1.550, Global test loss: 1.421, Global test accuracy: 46.20
Round   4, Train loss: 1.547, Test loss: 1.406, Test accuracy: 47.02
Round   4, Global train loss: 1.547, Global test loss: 1.395, Global test accuracy: 48.00
Round   5, Train loss: 1.511, Test loss: 1.376, Test accuracy: 49.40
Round   5, Global train loss: 1.511, Global test loss: 1.356, Global test accuracy: 51.20
Round   6, Train loss: 1.544, Test loss: 1.396, Test accuracy: 51.00
Round   6, Global train loss: 1.544, Global test loss: 1.397, Global test accuracy: 54.20
Round   7, Train loss: 1.485, Test loss: 1.368, Test accuracy: 49.86
Round   7, Global train loss: 1.485, Global test loss: 1.340, Global test accuracy: 49.80
Round   8, Train loss: 1.526, Test loss: 1.366, Test accuracy: 51.10
Round   8, Global train loss: 1.526, Global test loss: 1.353, Global test accuracy: 54.00
Round   9, Train loss: 1.479, Test loss: 1.295, Test accuracy: 53.66
Round   9, Global train loss: 1.479, Global test loss: 1.280, Global test accuracy: 54.80
Round  10, Train loss: 1.374, Test loss: 1.264, Test accuracy: 54.44
Round  10, Global train loss: 1.374, Global test loss: 1.211, Global test accuracy: 52.20
Round  11, Train loss: 1.458, Test loss: 1.280, Test accuracy: 54.74
Round  11, Global train loss: 1.458, Global test loss: 1.245, Global test accuracy: 58.00
Round  12, Train loss: 1.343, Test loss: 1.214, Test accuracy: 56.36
Round  12, Global train loss: 1.343, Global test loss: 1.159, Global test accuracy: 56.60
Round  13, Train loss: 1.415, Test loss: 1.252, Test accuracy: 57.64
Round  13, Global train loss: 1.415, Global test loss: 1.202, Global test accuracy: 60.00
Round  14, Train loss: 1.500, Test loss: 1.279, Test accuracy: 54.58
Round  14, Global train loss: 1.500, Global test loss: 1.279, Global test accuracy: 62.20
Round  15, Train loss: 1.253, Test loss: 1.191, Test accuracy: 58.14
Round  15, Global train loss: 1.253, Global test loss: 1.122, Global test accuracy: 56.80
Round  16, Train loss: 1.421, Test loss: 1.197, Test accuracy: 59.24
Round  16, Global train loss: 1.421, Global test loss: 1.135, Global test accuracy: 60.80
Round  17, Train loss: 1.393, Test loss: 1.199, Test accuracy: 59.08
Round  17, Global train loss: 1.393, Global test loss: 1.127, Global test accuracy: 61.20
Round  18, Train loss: 1.505, Test loss: 1.241, Test accuracy: 58.42
Round  18, Global train loss: 1.505, Global test loss: 1.279, Global test accuracy: 64.80
Round  19, Train loss: 1.477, Test loss: 1.229, Test accuracy: 58.52
Round  19, Global train loss: 1.477, Global test loss: 1.255, Global test accuracy: 63.40
Round  20, Train loss: 1.474, Test loss: 1.204, Test accuracy: 59.18
Round  20, Global train loss: 1.474, Global test loss: 1.198, Global test accuracy: 61.60
Round  21, Train loss: 1.459, Test loss: 1.249, Test accuracy: 56.30
Round  21, Global train loss: 1.459, Global test loss: 1.258, Global test accuracy: 59.00
Round  22, Train loss: 1.377, Test loss: 1.197, Test accuracy: 59.66
Round  22, Global train loss: 1.377, Global test loss: 1.138, Global test accuracy: 63.60
Round  23, Train loss: 1.367, Test loss: 1.183, Test accuracy: 58.96
Round  23, Global train loss: 1.367, Global test loss: 1.131, Global test accuracy: 61.00
Round  24, Train loss: 1.235, Test loss: 1.156, Test accuracy: 59.72
Round  24, Global train loss: 1.235, Global test loss: 1.100, Global test accuracy: 56.60
Round  25, Train loss: 1.220, Test loss: 1.154, Test accuracy: 60.64
Round  25, Global train loss: 1.220, Global test loss: 1.092, Global test accuracy: 59.80
Round  26, Train loss: 1.455, Test loss: 1.168, Test accuracy: 61.88
Round  26, Global train loss: 1.455, Global test loss: 1.200, Global test accuracy: 65.20
Round  27, Train loss: 1.335, Test loss: 1.184, Test accuracy: 59.00
Round  27, Global train loss: 1.335, Global test loss: 1.128, Global test accuracy: 63.20
Round  28, Train loss: 1.195, Test loss: 1.149, Test accuracy: 61.04
Round  28, Global train loss: 1.195, Global test loss: 1.061, Global test accuracy: 61.40
Round  29, Train loss: 1.289, Test loss: 1.159, Test accuracy: 59.90
Round  29, Global train loss: 1.289, Global test loss: 1.093, Global test accuracy: 60.80
Round  30, Train loss: 1.313, Test loss: 1.179, Test accuracy: 61.32
Round  30, Global train loss: 1.313, Global test loss: 1.091, Global test accuracy: 63.40
Round  31, Train loss: 1.417, Test loss: 1.190, Test accuracy: 60.98
Round  31, Global train loss: 1.417, Global test loss: 1.196, Global test accuracy: 65.60
Round  32, Train loss: 1.254, Test loss: 1.190, Test accuracy: 59.22
Round  32, Global train loss: 1.254, Global test loss: 1.114, Global test accuracy: 58.80
Round  33, Train loss: 1.400, Test loss: 1.189, Test accuracy: 58.80
Round  33, Global train loss: 1.400, Global test loss: 1.170, Global test accuracy: 63.40
Round  34, Train loss: 1.313, Test loss: 1.181, Test accuracy: 60.32
Round  34, Global train loss: 1.313, Global test loss: 1.119, Global test accuracy: 61.20
Round  35, Train loss: 1.278, Test loss: 1.127, Test accuracy: 62.16
Round  35, Global train loss: 1.278, Global test loss: 1.043, Global test accuracy: 64.20
Round  36, Train loss: 1.371, Test loss: 1.178, Test accuracy: 59.54
Round  36, Global train loss: 1.371, Global test loss: 1.166, Global test accuracy: 64.00
Round  37, Train loss: 1.355, Test loss: 1.217, Test accuracy: 57.28
Round  37, Global train loss: 1.355, Global test loss: 1.220, Global test accuracy: 59.20
Round  38, Train loss: 1.326, Test loss: 1.247, Test accuracy: 54.66
Round  38, Global train loss: 1.326, Global test loss: 1.229, Global test accuracy: 58.60
Round  39, Train loss: 1.160, Test loss: 1.135, Test accuracy: 60.70
Round  39, Global train loss: 1.160, Global test loss: 1.026, Global test accuracy: 61.60
Round  40, Train loss: 1.231, Test loss: 1.134, Test accuracy: 61.02
Round  40, Global train loss: 1.231, Global test loss: 1.055, Global test accuracy: 62.20
Round  41, Train loss: 1.288, Test loss: 1.246, Test accuracy: 53.96
Round  41, Global train loss: 1.288, Global test loss: 1.222, Global test accuracy: 59.80
Round  42, Train loss: 1.293, Test loss: 1.199, Test accuracy: 55.98
Round  42, Global train loss: 1.293, Global test loss: 1.197, Global test accuracy: 57.40
Round  43, Train loss: 1.267, Test loss: 1.292, Test accuracy: 51.28
Round  43, Global train loss: 1.267, Global test loss: 1.289, Global test accuracy: 52.80
Round  44, Train loss: 1.150, Test loss: 1.240, Test accuracy: 54.62
Round  44, Global train loss: 1.150, Global test loss: 1.188, Global test accuracy: 58.00
Round  45, Train loss: 1.032, Test loss: 1.209, Test accuracy: 56.80
Round  45, Global train loss: 1.032, Global test loss: 1.147, Global test accuracy: 59.60
Round  46, Train loss: 1.078, Test loss: 1.170, Test accuracy: 59.94
Round  46, Global train loss: 1.078, Global test loss: 1.067, Global test accuracy: 63.40
Round  47, Train loss: 1.057, Test loss: 1.163, Test accuracy: 59.02
Round  47, Global train loss: 1.057, Global test loss: 1.068, Global test accuracy: 60.80
Round  48, Train loss: 1.092, Test loss: 1.178, Test accuracy: 57.52
Round  48, Global train loss: 1.092, Global test loss: 1.122, Global test accuracy: 59.60
Round  49, Train loss: 1.096, Test loss: 1.224, Test accuracy: 52.72
Round  49, Global train loss: 1.096, Global test loss: 1.182, Global test accuracy: 56.00
Round  50, Train loss: 1.216, Test loss: 1.180, Test accuracy: 57.92
Round  50, Global train loss: 1.216, Global test loss: 1.108, Global test accuracy: 60.20
Round  51, Train loss: 1.204, Test loss: 1.257, Test accuracy: 54.36
Round  51, Global train loss: 1.204, Global test loss: 1.220, Global test accuracy: 58.00
Round  52, Train loss: 1.003, Test loss: 1.207, Test accuracy: 54.88
Round  52, Global train loss: 1.003, Global test loss: 1.104, Global test accuracy: 55.40
Round  53, Train loss: 1.070, Test loss: 1.213, Test accuracy: 55.40
Round  53, Global train loss: 1.070, Global test loss: 1.136, Global test accuracy: 57.80
Round  54, Train loss: 1.018, Test loss: 1.207, Test accuracy: 55.80
Round  54, Global train loss: 1.018, Global test loss: 1.157, Global test accuracy: 57.00
Round  55, Train loss: 0.954, Test loss: 1.316, Test accuracy: 50.40
Round  55, Global train loss: 0.954, Global test loss: 1.282, Global test accuracy: 52.40
Round  56, Train loss: 1.092, Test loss: 1.288, Test accuracy: 50.28
Round  56, Global train loss: 1.092, Global test loss: 1.257, Global test accuracy: 49.00
Round  57, Train loss: 0.991, Test loss: 1.237, Test accuracy: 53.32
Round  57, Global train loss: 0.991, Global test loss: 1.171, Global test accuracy: 55.80
Round  58, Train loss: 1.020, Test loss: 1.254, Test accuracy: 53.44
Round  58, Global train loss: 1.020, Global test loss: 1.163, Global test accuracy: 55.00
Round  59, Train loss: 1.218, Test loss: 1.278, Test accuracy: 53.52
Round  59, Global train loss: 1.218, Global test loss: 1.202, Global test accuracy: 56.60
Round  60, Train loss: 1.046, Test loss: 1.314, Test accuracy: 51.26
Round  60, Global train loss: 1.046, Global test loss: 1.259, Global test accuracy: 52.80
Round  61, Train loss: 0.922, Test loss: 1.295, Test accuracy: 51.52
Round  61, Global train loss: 0.922, Global test loss: 1.224, Global test accuracy: 56.40
Round  62, Train loss: 0.875, Test loss: 1.193, Test accuracy: 56.26
Round  62, Global train loss: 0.875, Global test loss: 1.090, Global test accuracy: 58.80
Round  63, Train loss: 0.822, Test loss: 1.358, Test accuracy: 50.58
Round  63, Global train loss: 0.822, Global test loss: 1.353, Global test accuracy: 51.60
Round  64, Train loss: 1.161, Test loss: 1.255, Test accuracy: 53.08
Round  64, Global train loss: 1.161, Global test loss: 1.186, Global test accuracy: 55.40
Round  65, Train loss: 0.708, Test loss: 1.217, Test accuracy: 55.90
Round  65, Global train loss: 0.708, Global test loss: 1.207, Global test accuracy: 55.20
Round  66, Train loss: 0.855, Test loss: 1.284, Test accuracy: 52.64
Round  66, Global train loss: 0.855, Global test loss: 1.193, Global test accuracy: 55.40
Round  67, Train loss: 0.755, Test loss: 1.348, Test accuracy: 49.34
Round  67, Global train loss: 0.755, Global test loss: 1.321, Global test accuracy: 50.20
Round  68, Train loss: 0.645, Test loss: 1.260, Test accuracy: 55.14
Round  68, Global train loss: 0.645, Global test loss: 1.287, Global test accuracy: 55.60
Round  69, Train loss: 0.691, Test loss: 1.339, Test accuracy: 50.78
Round  69, Global train loss: 0.691, Global test loss: 1.334, Global test accuracy: 51.20
Round  70, Train loss: 0.714, Test loss: 1.407, Test accuracy: 48.86
Round  70, Global train loss: 0.714, Global test loss: 1.357, Global test accuracy: 50.20
Round  71, Train loss: 0.936, Test loss: 1.315, Test accuracy: 54.64
Round  71, Global train loss: 0.936, Global test loss: 1.158, Global test accuracy: 56.00
Round  72, Train loss: 0.697, Test loss: 1.403, Test accuracy: 48.98
Round  72, Global train loss: 0.697, Global test loss: 1.389, Global test accuracy: 48.80
Round  73, Train loss: 1.097, Test loss: 1.365, Test accuracy: 49.82
Round  73, Global train loss: 1.097, Global test loss: 1.226, Global test accuracy: 52.60
Round  74, Train loss: 0.614, Test loss: 1.317, Test accuracy: 53.14
Round  74, Global train loss: 0.614, Global test loss: 1.286, Global test accuracy: 54.80
Round  75, Train loss: 0.781, Test loss: 1.339, Test accuracy: 51.58
Round  75, Global train loss: 0.781, Global test loss: 1.221, Global test accuracy: 54.40
Round  76, Train loss: 0.608, Test loss: 1.391, Test accuracy: 52.24
Round  76, Global train loss: 0.608, Global test loss: 1.401, Global test accuracy: 53.40
Round  77, Train loss: 0.661, Test loss: 1.345, Test accuracy: 52.36
Round  77, Global train loss: 0.661, Global test loss: 1.308, Global test accuracy: 54.40
Round  78, Train loss: 0.839, Test loss: 1.456, Test accuracy: 47.84
Round  78, Global train loss: 0.839, Global test loss: 1.347, Global test accuracy: 46.80
Round  79, Train loss: 0.604, Test loss: 1.357, Test accuracy: 54.30
Round  79, Global train loss: 0.604, Global test loss: 1.357, Global test accuracy: 54.00
Round  80, Train loss: 0.658, Test loss: 1.426, Test accuracy: 50.70
Round  80, Global train loss: 0.658, Global test loss: 1.314, Global test accuracy: 51.80
Round  81, Train loss: 0.666, Test loss: 1.431, Test accuracy: 50.14
Round  81, Global train loss: 0.666, Global test loss: 1.330, Global test accuracy: 52.60
Round  82, Train loss: 0.570, Test loss: 1.573, Test accuracy: 45.76
Round  82, Global train loss: 0.570, Global test loss: 1.585, Global test accuracy: 44.80
Round  83, Train loss: 0.537, Test loss: 1.519, Test accuracy: 48.92
Round  83, Global train loss: 0.537, Global test loss: 1.527, Global test accuracy: 50.00
Round  84, Train loss: 0.371, Test loss: 1.425, Test accuracy: 52.90
Round  84, Global train loss: 0.371, Global test loss: 1.569, Global test accuracy: 54.20
Round  85, Train loss: 0.515, Test loss: 1.540, Test accuracy: 47.84
Round  85, Global train loss: 0.515, Global test loss: 1.545, Global test accuracy: 51.00
Round  86, Train loss: 0.797, Test loss: 1.549, Test accuracy: 48.16
Round  86, Global train loss: 0.797, Global test loss: 1.349, Global test accuracy: 48.20
Round  87, Train loss: 0.423, Test loss: 1.524, Test accuracy: 48.24
Round  87, Global train loss: 0.423, Global test loss: 1.628, Global test accuracy: 49.80
Round  88, Train loss: 0.489, Test loss: 1.558, Test accuracy: 48.18
Round  88, Global train loss: 0.489, Global test loss: 1.535, Global test accuracy: 50.00
Round  89, Train loss: 0.292, Test loss: 1.539, Test accuracy: 48.74
Round  89, Global train loss: 0.292, Global test loss: 1.743, Global test accuracy: 47.80
Round  90, Train loss: 0.631, Test loss: 1.697, Test accuracy: 46.40
Round  90, Global train loss: 0.631, Global test loss: 1.515, Global test accuracy: 46.20
Round  91, Train loss: 0.846, Test loss: 1.643, Test accuracy: 45.86
Round  91, Global train loss: 0.846, Global test loss: 1.359, Global test accuracy: 46.20
Round  92, Train loss: 0.486, Test loss: 1.617, Test accuracy: 47.82
Round  92, Global train loss: 0.486, Global test loss: 1.628, Global test accuracy: 50.00
Round  93, Train loss: 0.430, Test loss: 1.514, Test accuracy: 53.20
Round  93, Global train loss: 0.430, Global test loss: 1.569, Global test accuracy: 55.20
Round  94, Train loss: 0.431, Test loss: 1.564, Test accuracy: 49.62
Round  94, Global train loss: 0.431, Global test loss: 1.512, Global test accuracy: 51.20
Round  95, Train loss: 0.519, Test loss: 1.536, Test accuracy: 51.82
Round  95, Global train loss: 0.519, Global test loss: 1.418, Global test accuracy: 51.80
Round  96, Train loss: 0.623, Test loss: 1.486, Test accuracy: 51.04
Round  96, Global train loss: 0.623, Global test loss: 1.305, Global test accuracy: 52.40
Round  97, Train loss: 0.387, Test loss: 1.576, Test accuracy: 50.50
Round  97, Global train loss: 0.387, Global test loss: 1.619, Global test accuracy: 50.80
Round  98, Train loss: 0.553, Test loss: 1.715, Test accuracy: 47.28
Round  98, Global train loss: 0.553, Global test loss: 1.561, Global test accuracy: 47.60
Round  99, Train loss: 0.467, Test loss: 1.619, Test accuracy: 51.52
Round  99, Global train loss: 0.467, Global test loss: 1.496, Global test accuracy: 52.40
Final Round, Train loss: 0.444, Test loss: 1.653, Test accuracy: 51.08
Final Round, Global train loss: 0.444, Global test loss: 1.496, Global test accuracy: 52.40
Average accuracy final 10 rounds: 49.506
850.0634787082672
[2.2076644897460938, 4.055635929107666, 5.78976583480835, 7.50983738899231, 9.308484315872192, 11.05405569076538, 12.867811679840088, 14.613924741744995, 16.49627995491028, 18.364272356033325, 20.35346746444702, 22.349156141281128, 24.150935173034668, 26.13504195213318, 28.058855772018433, 29.793953895568848, 31.529375076293945, 33.33804392814636, 35.27827000617981, 36.92875957489014, 38.64623212814331, 40.393893241882324, 42.192657470703125, 43.951186656951904, 45.81558299064636, 47.627334117889404, 49.49480128288269, 51.41315174102783, 53.63550806045532, 55.89914298057556, 58.207037687301636, 59.97090721130371, 61.759204149246216, 63.560606956481934, 65.3820812702179, 67.07477068901062, 68.76793265342712, 70.63023138046265, 72.4326708316803, 74.1228723526001, 75.93355417251587, 77.79875445365906, 79.59599447250366, 81.46211099624634, 83.20895600318909, 84.9938428401947, 86.88897752761841, 88.70562410354614, 90.60603857040405, 92.67494320869446, 94.83735060691833, 96.64205574989319, 98.51575422286987, 100.19363236427307, 101.93333959579468, 103.73119807243347, 105.82138562202454, 107.53985476493835, 109.24417161941528, 111.09446120262146, 112.74091529846191, 114.3405487537384, 115.8935317993164, 117.43908214569092, 119.02244663238525, 120.61696600914001, 122.14829301834106, 123.72274041175842, 125.27739810943604, 126.86083436012268, 128.41164684295654, 129.94584679603577, 131.5423936843872, 133.06998825073242, 134.70368885993958, 136.2008879184723, 137.7883505821228, 139.29249095916748, 140.81224966049194, 142.38465905189514, 143.91248965263367, 145.43491196632385, 146.96160578727722, 148.4712417125702, 150.02752923965454, 151.59623956680298, 153.1188623905182, 154.68732857704163, 156.26685118675232, 157.81857991218567, 159.38623452186584, 160.95341658592224, 162.50421953201294, 164.02299523353577, 165.58859252929688, 167.12864065170288, 168.64614987373352, 170.26081895828247, 171.89882826805115, 173.48321890830994, 176.0372977256775]
[33.46, 39.96, 43.64, 46.14, 47.02, 49.4, 51.0, 49.86, 51.1, 53.66, 54.44, 54.74, 56.36, 57.64, 54.58, 58.14, 59.24, 59.08, 58.42, 58.52, 59.18, 56.3, 59.66, 58.96, 59.72, 60.64, 61.88, 59.0, 61.04, 59.9, 61.32, 60.98, 59.22, 58.8, 60.32, 62.16, 59.54, 57.28, 54.66, 60.7, 61.02, 53.96, 55.98, 51.28, 54.62, 56.8, 59.94, 59.02, 57.52, 52.72, 57.92, 54.36, 54.88, 55.4, 55.8, 50.4, 50.28, 53.32, 53.44, 53.52, 51.26, 51.52, 56.26, 50.58, 53.08, 55.9, 52.64, 49.34, 55.14, 50.78, 48.86, 54.64, 48.98, 49.82, 53.14, 51.58, 52.24, 52.36, 47.84, 54.3, 50.7, 50.14, 45.76, 48.92, 52.9, 47.84, 48.16, 48.24, 48.18, 48.74, 46.4, 45.86, 47.82, 53.2, 49.62, 51.82, 51.04, 50.5, 47.28, 51.52, 51.08]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.591, Test loss: 1.561, Test accuracy: 34.52
Round   0, Global train loss: 1.591, Global test loss: 1.556, Global test accuracy: 36.80
Round   1, Train loss: 1.531, Test loss: 1.468, Test accuracy: 41.78
Round   1, Global train loss: 1.531, Global test loss: 1.453, Global test accuracy: 44.80
Round   2, Train loss: 1.497, Test loss: 1.408, Test accuracy: 46.32
Round   2, Global train loss: 1.497, Global test loss: 1.385, Global test accuracy: 46.60
Round   3, Train loss: 1.479, Test loss: 1.381, Test accuracy: 48.08
Round   3, Global train loss: 1.479, Global test loss: 1.354, Global test accuracy: 48.40
Round   4, Train loss: 1.465, Test loss: 1.342, Test accuracy: 50.78
Round   4, Global train loss: 1.465, Global test loss: 1.309, Global test accuracy: 51.00
Round   5, Train loss: 1.448, Test loss: 1.326, Test accuracy: 53.46
Round   5, Global train loss: 1.448, Global test loss: 1.291, Global test accuracy: 54.20
Round   6, Train loss: 1.436, Test loss: 1.288, Test accuracy: 55.38
Round   6, Global train loss: 1.436, Global test loss: 1.248, Global test accuracy: 56.20
Round   7, Train loss: 1.421, Test loss: 1.261, Test accuracy: 57.30
Round   7, Global train loss: 1.421, Global test loss: 1.215, Global test accuracy: 58.60
Round   8, Train loss: 1.409, Test loss: 1.243, Test accuracy: 58.08
Round   8, Global train loss: 1.409, Global test loss: 1.194, Global test accuracy: 59.40
Round   9, Train loss: 1.398, Test loss: 1.244, Test accuracy: 58.88
Round   9, Global train loss: 1.398, Global test loss: 1.193, Global test accuracy: 59.60
Round  10, Train loss: 1.494, Test loss: 1.271, Test accuracy: 55.78
Round  10, Global train loss: 1.494, Global test loss: 1.281, Global test accuracy: 56.60
Round  11, Train loss: 1.212, Test loss: 1.353, Test accuracy: 49.40
Round  11, Global train loss: 1.212, Global test loss: 1.406, Global test accuracy: 44.00
Round  12, Train loss: 1.266, Test loss: 1.445, Test accuracy: 44.52
Round  12, Global train loss: 1.266, Global test loss: 1.412, Global test accuracy: 47.40
Round  13, Train loss: 1.180, Test loss: 1.346, Test accuracy: 49.08
Round  13, Global train loss: 1.180, Global test loss: 1.209, Global test accuracy: 55.20
Round  14, Train loss: 1.306, Test loss: 1.372, Test accuracy: 49.38
Round  14, Global train loss: 1.306, Global test loss: 1.241, Global test accuracy: 58.00
Round  15, Train loss: 1.283, Test loss: 1.437, Test accuracy: 45.44
Round  15, Global train loss: 1.283, Global test loss: 1.428, Global test accuracy: 48.40
Round  16, Train loss: 1.210, Test loss: 1.340, Test accuracy: 50.18
Round  16, Global train loss: 1.210, Global test loss: 1.192, Global test accuracy: 56.40
Round  17, Train loss: 1.192, Test loss: 1.332, Test accuracy: 51.26
Round  17, Global train loss: 1.192, Global test loss: 1.163, Global test accuracy: 58.40
Round  18, Train loss: 1.178, Test loss: 1.181, Test accuracy: 61.46
Round  18, Global train loss: 1.178, Global test loss: 1.100, Global test accuracy: 64.20
Round  19, Train loss: 1.223, Test loss: 1.217, Test accuracy: 57.40
Round  19, Global train loss: 1.223, Global test loss: 1.197, Global test accuracy: 58.60
Round  20, Train loss: 1.102, Test loss: 1.112, Test accuracy: 62.82
Round  20, Global train loss: 1.102, Global test loss: 0.923, Global test accuracy: 64.40
Round  21, Train loss: 1.303, Test loss: 1.279, Test accuracy: 53.20
Round  21, Global train loss: 1.303, Global test loss: 1.253, Global test accuracy: 56.40
Round  22, Train loss: 1.243, Test loss: 1.157, Test accuracy: 61.26
Round  22, Global train loss: 1.243, Global test loss: 1.042, Global test accuracy: 64.00
Round  23, Train loss: 1.223, Test loss: 1.250, Test accuracy: 54.96
Round  23, Global train loss: 1.223, Global test loss: 1.276, Global test accuracy: 55.80
Round  24, Train loss: 1.268, Test loss: 1.311, Test accuracy: 50.68
Round  24, Global train loss: 1.268, Global test loss: 1.307, Global test accuracy: 53.40
Round  25, Train loss: 1.314, Test loss: 1.303, Test accuracy: 51.12
Round  25, Global train loss: 1.314, Global test loss: 1.314, Global test accuracy: 53.00
Round  26, Train loss: 1.209, Test loss: 1.187, Test accuracy: 59.90
Round  26, Global train loss: 1.209, Global test loss: 1.112, Global test accuracy: 62.80
Round  27, Train loss: 1.313, Test loss: 1.278, Test accuracy: 53.12
Round  27, Global train loss: 1.313, Global test loss: 1.308, Global test accuracy: 51.40
Round  28, Train loss: 1.276, Test loss: 1.321, Test accuracy: 50.40
Round  28, Global train loss: 1.276, Global test loss: 1.271, Global test accuracy: 55.40
Round  29, Train loss: 1.206, Test loss: 1.248, Test accuracy: 53.50
Round  29, Global train loss: 1.206, Global test loss: 1.184, Global test accuracy: 56.80
Round  30, Train loss: 1.186, Test loss: 1.190, Test accuracy: 57.10
Round  30, Global train loss: 1.186, Global test loss: 1.061, Global test accuracy: 65.20
Round  31, Train loss: 1.210, Test loss: 1.141, Test accuracy: 59.82
Round  31, Global train loss: 1.210, Global test loss: 1.000, Global test accuracy: 68.60
Round  32, Train loss: 1.219, Test loss: 1.293, Test accuracy: 50.38
Round  32, Global train loss: 1.219, Global test loss: 1.311, Global test accuracy: 52.00
Round  33, Train loss: 1.173, Test loss: 1.208, Test accuracy: 56.68
Round  33, Global train loss: 1.173, Global test loss: 1.133, Global test accuracy: 58.80
Round  34, Train loss: 1.148, Test loss: 1.135, Test accuracy: 59.38
Round  34, Global train loss: 1.148, Global test loss: 1.006, Global test accuracy: 64.00
Round  35, Train loss: 1.132, Test loss: 1.119, Test accuracy: 60.10
Round  35, Global train loss: 1.132, Global test loss: 0.983, Global test accuracy: 65.00
Round  36, Train loss: 1.136, Test loss: 1.127, Test accuracy: 59.08
Round  36, Global train loss: 1.136, Global test loss: 1.030, Global test accuracy: 61.40
Round  37, Train loss: 1.085, Test loss: 1.114, Test accuracy: 59.76
Round  37, Global train loss: 1.085, Global test loss: 1.018, Global test accuracy: 61.20
Round  38, Train loss: 1.078, Test loss: 1.097, Test accuracy: 60.38
Round  38, Global train loss: 1.078, Global test loss: 0.991, Global test accuracy: 62.80
Round  39, Train loss: 1.044, Test loss: 1.179, Test accuracy: 55.36
Round  39, Global train loss: 1.044, Global test loss: 1.103, Global test accuracy: 57.40
Round  40, Train loss: 1.072, Test loss: 1.141, Test accuracy: 57.90
Round  40, Global train loss: 1.072, Global test loss: 1.001, Global test accuracy: 63.80
Round  41, Train loss: 1.148, Test loss: 1.215, Test accuracy: 54.24
Round  41, Global train loss: 1.148, Global test loss: 1.176, Global test accuracy: 56.40
Round  42, Train loss: 1.061, Test loss: 1.192, Test accuracy: 53.82
Round  42, Global train loss: 1.061, Global test loss: 1.108, Global test accuracy: 60.20
Round  43, Train loss: 1.010, Test loss: 1.186, Test accuracy: 53.18
Round  43, Global train loss: 1.010, Global test loss: 1.062, Global test accuracy: 58.20
Round  44, Train loss: 1.066, Test loss: 1.283, Test accuracy: 49.56
Round  44, Global train loss: 1.066, Global test loss: 1.260, Global test accuracy: 52.00
Round  45, Train loss: 1.082, Test loss: 1.339, Test accuracy: 48.06
Round  45, Global train loss: 1.082, Global test loss: 1.395, Global test accuracy: 43.80
Round  46, Train loss: 1.035, Test loss: 1.150, Test accuracy: 56.94
Round  46, Global train loss: 1.035, Global test loss: 1.048, Global test accuracy: 61.20
Round  47, Train loss: 1.037, Test loss: 1.107, Test accuracy: 59.30
Round  47, Global train loss: 1.037, Global test loss: 1.007, Global test accuracy: 62.60
Round  48, Train loss: 1.141, Test loss: 1.201, Test accuracy: 54.44
Round  48, Global train loss: 1.141, Global test loss: 1.194, Global test accuracy: 55.00
Round  49, Train loss: 1.102, Test loss: 1.225, Test accuracy: 54.08
Round  49, Global train loss: 1.102, Global test loss: 1.196, Global test accuracy: 60.20
Round  50, Train loss: 0.905, Test loss: 1.019, Test accuracy: 62.42
Round  50, Global train loss: 0.905, Global test loss: 0.904, Global test accuracy: 63.20
Round  51, Train loss: 0.903, Test loss: 1.105, Test accuracy: 58.96
Round  51, Global train loss: 0.903, Global test loss: 1.080, Global test accuracy: 59.00
Round  52, Train loss: 0.866, Test loss: 1.148, Test accuracy: 56.50
Round  52, Global train loss: 0.866, Global test loss: 1.062, Global test accuracy: 58.80
Round  53, Train loss: 0.959, Test loss: 1.308, Test accuracy: 50.36
Round  53, Global train loss: 0.959, Global test loss: 1.267, Global test accuracy: 50.80
Round  54, Train loss: 0.898, Test loss: 1.203, Test accuracy: 56.26
Round  54, Global train loss: 0.898, Global test loss: 1.177, Global test accuracy: 57.40
Round  55, Train loss: 0.953, Test loss: 1.350, Test accuracy: 49.84
Round  55, Global train loss: 0.953, Global test loss: 1.330, Global test accuracy: 50.20
Round  56, Train loss: 0.871, Test loss: 1.127, Test accuracy: 58.60
Round  56, Global train loss: 0.871, Global test loss: 1.018, Global test accuracy: 61.20
Round  57, Train loss: 0.868, Test loss: 1.183, Test accuracy: 55.20
Round  57, Global train loss: 0.868, Global test loss: 1.132, Global test accuracy: 56.60
Round  58, Train loss: 0.783, Test loss: 1.256, Test accuracy: 53.34
Round  58, Global train loss: 0.783, Global test loss: 1.134, Global test accuracy: 58.00
Round  59, Train loss: 0.804, Test loss: 1.070, Test accuracy: 59.94
Round  59, Global train loss: 0.804, Global test loss: 0.926, Global test accuracy: 65.00
Round  60, Train loss: 0.861, Test loss: 1.242, Test accuracy: 54.92
Round  60, Global train loss: 0.861, Global test loss: 1.153, Global test accuracy: 58.80
Round  61, Train loss: 0.733, Test loss: 1.228, Test accuracy: 55.04
Round  61, Global train loss: 0.733, Global test loss: 1.165, Global test accuracy: 57.00
Round  62, Train loss: 0.774, Test loss: 1.208, Test accuracy: 54.40
Round  62, Global train loss: 0.774, Global test loss: 1.115, Global test accuracy: 57.20
Round  63, Train loss: 0.831, Test loss: 1.335, Test accuracy: 51.18
Round  63, Global train loss: 0.831, Global test loss: 1.338, Global test accuracy: 52.20
Round  64, Train loss: 0.749, Test loss: 1.039, Test accuracy: 61.92
Round  64, Global train loss: 0.749, Global test loss: 0.946, Global test accuracy: 64.20
Round  65, Train loss: 0.848, Test loss: 1.349, Test accuracy: 51.54
Round  65, Global train loss: 0.848, Global test loss: 1.418, Global test accuracy: 48.40
Round  66, Train loss: 0.727, Test loss: 1.246, Test accuracy: 53.20
Round  66, Global train loss: 0.727, Global test loss: 1.153, Global test accuracy: 56.40
Round  67, Train loss: 0.707, Test loss: 1.482, Test accuracy: 48.22
Round  67, Global train loss: 0.707, Global test loss: 1.544, Global test accuracy: 47.80
Round  68, Train loss: 0.814, Test loss: 1.411, Test accuracy: 50.34
Round  68, Global train loss: 0.814, Global test loss: 1.416, Global test accuracy: 50.40
Round  69, Train loss: 0.681, Test loss: 1.417, Test accuracy: 51.16
Round  69, Global train loss: 0.681, Global test loss: 1.443, Global test accuracy: 52.40
Round  70, Train loss: 0.662, Test loss: 1.377, Test accuracy: 53.42
Round  70, Global train loss: 0.662, Global test loss: 1.392, Global test accuracy: 54.20
Round  71, Train loss: 0.708, Test loss: 1.200, Test accuracy: 56.54
Round  71, Global train loss: 0.708, Global test loss: 1.086, Global test accuracy: 60.60
Round  72, Train loss: 0.643, Test loss: 1.291, Test accuracy: 57.34
Round  72, Global train loss: 0.643, Global test loss: 1.315, Global test accuracy: 58.20
Round  73, Train loss: 0.679, Test loss: 1.246, Test accuracy: 58.46
Round  73, Global train loss: 0.679, Global test loss: 1.057, Global test accuracy: 61.40
Round  74, Train loss: 0.626, Test loss: 1.422, Test accuracy: 52.84
Round  74, Global train loss: 0.626, Global test loss: 1.411, Global test accuracy: 53.00
Round  75, Train loss: 0.636, Test loss: 1.330, Test accuracy: 52.60
Round  75, Global train loss: 0.636, Global test loss: 1.213, Global test accuracy: 57.00
Round  76, Train loss: 0.588, Test loss: 1.431, Test accuracy: 51.04
Round  76, Global train loss: 0.588, Global test loss: 1.428, Global test accuracy: 51.20
Round  77, Train loss: 0.572, Test loss: 1.484, Test accuracy: 51.22
Round  77, Global train loss: 0.572, Global test loss: 1.478, Global test accuracy: 52.60
Round  78, Train loss: 0.528, Test loss: 1.243, Test accuracy: 58.64
Round  78, Global train loss: 0.528, Global test loss: 1.076, Global test accuracy: 63.40
Round  79, Train loss: 0.619, Test loss: 1.560, Test accuracy: 49.76
Round  79, Global train loss: 0.619, Global test loss: 1.579, Global test accuracy: 49.60
Round  80, Train loss: 0.571, Test loss: 1.475, Test accuracy: 52.34
Round  80, Global train loss: 0.571, Global test loss: 1.463, Global test accuracy: 55.00
Round  81, Train loss: 0.455, Test loss: 1.418, Test accuracy: 53.30
Round  81, Global train loss: 0.455, Global test loss: 1.406, Global test accuracy: 54.80
Round  82, Train loss: 0.413, Test loss: 1.465, Test accuracy: 51.32
Round  82, Global train loss: 0.413, Global test loss: 1.486, Global test accuracy: 53.00
Round  83, Train loss: 0.395, Test loss: 1.576, Test accuracy: 51.20
Round  83, Global train loss: 0.395, Global test loss: 1.608, Global test accuracy: 53.40
Round  84, Train loss: 0.361, Test loss: 1.512, Test accuracy: 51.62
Round  84, Global train loss: 0.361, Global test loss: 1.544, Global test accuracy: 54.20
Round  85, Train loss: 0.338, Test loss: 1.568, Test accuracy: 50.86
Round  85, Global train loss: 0.338, Global test loss: 1.614, Global test accuracy: 53.80
Round  86, Train loss: 0.323, Test loss: 1.534, Test accuracy: 50.36
Round  86, Global train loss: 0.323, Global test loss: 1.606, Global test accuracy: 53.00
Round  87, Train loss: 0.327, Test loss: 1.490, Test accuracy: 52.02
Round  87, Global train loss: 0.327, Global test loss: 1.559, Global test accuracy: 54.20
Round  88, Train loss: 0.320, Test loss: 1.576, Test accuracy: 51.32
Round  88, Global train loss: 0.320, Global test loss: 1.636, Global test accuracy: 52.40
Round  89, Train loss: 0.288, Test loss: 1.568, Test accuracy: 50.76
Round  89, Global train loss: 0.288, Global test loss: 1.633, Global test accuracy: 52.20
Round  90, Train loss: 0.264, Test loss: 1.623, Test accuracy: 51.46
Round  90, Global train loss: 0.264, Global test loss: 1.716, Global test accuracy: 52.80
Round  91, Train loss: 0.233, Test loss: 1.646, Test accuracy: 51.94
Round  91, Global train loss: 0.233, Global test loss: 1.762, Global test accuracy: 55.40
Round  92, Train loss: 0.286, Test loss: 1.573, Test accuracy: 52.04
Round  92, Global train loss: 0.286, Global test loss: 1.685, Global test accuracy: 54.00
Round  93, Train loss: 0.227, Test loss: 1.663, Test accuracy: 49.74
Round  93, Global train loss: 0.227, Global test loss: 1.784, Global test accuracy: 51.80
Round  94, Train loss: 0.220, Test loss: 1.573, Test accuracy: 52.34
Round  94, Global train loss: 0.220, Global test loss: 1.735, Global test accuracy: 51.60
Round  95, Train loss: 0.222, Test loss: 1.622, Test accuracy: 51.80
Round  95, Global train loss: 0.222, Global test loss: 1.792, Global test accuracy: 53.20
Round  96, Train loss: 0.217, Test loss: 1.710, Test accuracy: 49.60
Round  96, Global train loss: 0.217, Global test loss: 1.854, Global test accuracy: 50.40
Round  97, Train loss: 0.224, Test loss: 1.607, Test accuracy: 50.84
Round  97, Global train loss: 0.224, Global test loss: 1.767, Global test accuracy: 51.80
Round  98, Train loss: 0.187, Test loss: 1.610, Test accuracy: 52.58
Round  98, Global train loss: 0.187, Global test loss: 1.805, Global test accuracy: 53.60
Round  99, Train loss: 0.420, Test loss: 1.596, Test accuracy: 51.76
Round  99, Global train loss: 0.420, Global test loss: 1.505, Global test accuracy: 51.00
Final Round, Train loss: 0.363, Test loss: 1.631, Test accuracy: 51.56
Final Round, Global train loss: 0.363, Global test loss: 1.505, Global test accuracy: 51.00
Average accuracy final 10 rounds: 51.41000000000001
2080.0076587200165
[2.235135078430176, 4.070103883743286, 5.8738439083099365, 7.694172143936157, 9.435748100280762, 11.201341390609741, 12.968430757522583, 14.807839632034302, 16.64342498779297, 18.450127840042114, 24.55469846725464, 33.72383713722229, 43.03094434738159, 52.234124422073364, 61.411410331726074, 70.6814489364624, 80.00177645683289, 89.13792276382446, 98.084059715271, 107.11555099487305, 116.47045969963074, 125.57940363883972, 135.0096366405487, 144.07185173034668, 153.19369983673096, 162.36283802986145, 171.53083205223083, 180.752512216568, 189.9409327507019, 199.1599268913269, 208.18200850486755, 217.32097625732422, 226.33711171150208, 235.57776498794556, 244.7471044063568, 253.8539423942566, 263.32073736190796, 272.5172941684723, 281.57463908195496, 290.783273935318, 300.00416254997253, 309.1231632232666, 318.319317817688, 327.52312707901, 336.72561740875244, 345.8243405818939, 355.0102365016937, 364.00457644462585, 365.75330328941345, 375.08570528030396, 384.1831431388855, 393.136358499527, 402.6381161212921, 411.69425892829895, 420.68084025382996, 429.9135310649872, 439.0892481803894, 448.233434677124, 457.379469871521, 466.53952264785767, 475.72127413749695, 484.78436732292175, 493.92421889305115, 502.96408772468567, 512.150102853775, 521.2734014987946, 530.3902978897095, 539.8257119655609, 548.8836178779602, 558.0735394954681, 567.4427075386047, 576.7247414588928, 578.4572327136993, 587.7318162918091, 596.7336423397064, 605.9068846702576, 614.7160403728485, 623.4229049682617, 631.9197950363159, 640.2734169960022, 641.8982985019684, 643.4850180149078, 645.0607731342316, 646.7101657390594, 648.3844451904297, 650.0766432285309, 651.7076394557953, 653.2599759101868, 654.8720180988312, 656.453447341919, 658.0258882045746, 659.5942168235779, 661.1424646377563, 662.7516920566559, 664.3278238773346, 665.9906277656555, 667.6391696929932, 669.2335340976715, 670.8753387928009, 679.5988149642944, 689.1339328289032]
[34.52, 41.78, 46.32, 48.08, 50.78, 53.46, 55.38, 57.3, 58.08, 58.88, 55.78, 49.4, 44.52, 49.08, 49.38, 45.44, 50.18, 51.26, 61.46, 57.4, 62.82, 53.2, 61.26, 54.96, 50.68, 51.12, 59.9, 53.12, 50.4, 53.5, 57.1, 59.82, 50.38, 56.68, 59.38, 60.1, 59.08, 59.76, 60.38, 55.36, 57.9, 54.24, 53.82, 53.18, 49.56, 48.06, 56.94, 59.3, 54.44, 54.08, 62.42, 58.96, 56.5, 50.36, 56.26, 49.84, 58.6, 55.2, 53.34, 59.94, 54.92, 55.04, 54.4, 51.18, 61.92, 51.54, 53.2, 48.22, 50.34, 51.16, 53.42, 56.54, 57.34, 58.46, 52.84, 52.6, 51.04, 51.22, 58.64, 49.76, 52.34, 53.3, 51.32, 51.2, 51.62, 50.86, 50.36, 52.02, 51.32, 50.76, 51.46, 51.94, 52.04, 49.74, 52.34, 51.8, 49.6, 50.84, 52.58, 51.76, 51.56]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.558, Test loss: 1.509, Test accuracy: 45.58
Round   0, Global train loss: 1.558, Global test loss: 1.535, Global test accuracy: 50.00
Round   1, Train loss: 1.401, Test loss: 1.371, Test accuracy: 45.06
Round   1, Global train loss: 1.401, Global test loss: 1.304, Global test accuracy: 53.20
Round   2, Train loss: 1.465, Test loss: 1.436, Test accuracy: 38.76
Round   2, Global train loss: 1.465, Global test loss: 1.502, Global test accuracy: 38.80
Round   3, Train loss: 1.504, Test loss: 1.438, Test accuracy: 38.82
Round   3, Global train loss: 1.504, Global test loss: 1.457, Global test accuracy: 39.20
Round   4, Train loss: 1.222, Test loss: 1.376, Test accuracy: 41.08
Round   4, Global train loss: 1.222, Global test loss: 1.126, Global test accuracy: 57.80
Round   5, Train loss: 1.370, Test loss: 1.408, Test accuracy: 41.28
Round   5, Global train loss: 1.370, Global test loss: 1.332, Global test accuracy: 57.00
Round   6, Train loss: 1.317, Test loss: 1.437, Test accuracy: 38.44
Round   6, Global train loss: 1.317, Global test loss: 1.193, Global test accuracy: 67.40
Round   7, Train loss: 1.541, Test loss: 1.438, Test accuracy: 37.02
Round   7, Global train loss: 1.541, Global test loss: 1.529, Global test accuracy: 29.40
Round   8, Train loss: 1.468, Test loss: 1.430, Test accuracy: 36.28
Round   8, Global train loss: 1.468, Global test loss: 1.506, Global test accuracy: 36.40
Round   9, Train loss: 1.595, Test loss: 1.432, Test accuracy: 35.20
Round   9, Global train loss: 1.595, Global test loss: 1.592, Global test accuracy: 28.00
Round  10, Train loss: 1.352, Test loss: 1.425, Test accuracy: 35.52
Round  10, Global train loss: 1.352, Global test loss: 1.384, Global test accuracy: 49.40
Round  11, Train loss: 1.118, Test loss: 1.434, Test accuracy: 35.42
Round  11, Global train loss: 1.118, Global test loss: 1.011, Global test accuracy: 66.00
Round  12, Train loss: 1.589, Test loss: 1.435, Test accuracy: 35.12
Round  12, Global train loss: 1.589, Global test loss: 1.575, Global test accuracy: 35.80
Round  13, Train loss: 1.577, Test loss: 1.437, Test accuracy: 35.90
Round  13, Global train loss: 1.577, Global test loss: 1.607, Global test accuracy: 21.60
Round  14, Train loss: 1.518, Test loss: 1.447, Test accuracy: 34.04
Round  14, Global train loss: 1.518, Global test loss: 1.533, Global test accuracy: 31.80
Round  15, Train loss: 1.316, Test loss: 1.434, Test accuracy: 34.48
Round  15, Global train loss: 1.316, Global test loss: 1.366, Global test accuracy: 58.60
Round  16, Train loss: 1.555, Test loss: 1.432, Test accuracy: 34.64
Round  16, Global train loss: 1.555, Global test loss: 1.565, Global test accuracy: 30.40
Round  17, Train loss: 1.385, Test loss: 1.423, Test accuracy: 34.64
Round  17, Global train loss: 1.385, Global test loss: 1.361, Global test accuracy: 50.80
Round  18, Train loss: 1.498, Test loss: 1.440, Test accuracy: 33.70
Round  18, Global train loss: 1.498, Global test loss: 1.511, Global test accuracy: 42.60
Round  19, Train loss: 1.068, Test loss: 1.476, Test accuracy: 32.78
Round  19, Global train loss: 1.068, Global test loss: 1.063, Global test accuracy: 60.80
Round  20, Train loss: 1.051, Test loss: 1.453, Test accuracy: 33.06
Round  20, Global train loss: 1.051, Global test loss: 1.021, Global test accuracy: 61.80
Round  21, Train loss: 1.415, Test loss: 1.452, Test accuracy: 32.92
Round  21, Global train loss: 1.415, Global test loss: 1.438, Global test accuracy: 40.40
Round  22, Train loss: 1.225, Test loss: 1.463, Test accuracy: 33.10
Round  22, Global train loss: 1.225, Global test loss: 1.239, Global test accuracy: 52.20
Round  23, Train loss: 1.461, Test loss: 1.474, Test accuracy: 32.58
Round  23, Global train loss: 1.461, Global test loss: 1.513, Global test accuracy: 31.80
Round  24, Train loss: 1.463, Test loss: 1.468, Test accuracy: 32.78
Round  24, Global train loss: 1.463, Global test loss: 1.547, Global test accuracy: 27.60
Round  25, Train loss: 1.289, Test loss: 1.482, Test accuracy: 32.92
Round  25, Global train loss: 1.289, Global test loss: 1.351, Global test accuracy: 45.40
Round  26, Train loss: 1.556, Test loss: 1.480, Test accuracy: 33.18
Round  26, Global train loss: 1.556, Global test loss: 1.569, Global test accuracy: 29.00
Round  27, Train loss: 1.090, Test loss: 1.481, Test accuracy: 33.30
Round  27, Global train loss: 1.090, Global test loss: 1.105, Global test accuracy: 62.40
Round  28, Train loss: 1.290, Test loss: 1.468, Test accuracy: 32.96
Round  28, Global train loss: 1.290, Global test loss: 1.284, Global test accuracy: 52.00
Round  29, Train loss: 0.983, Test loss: 1.464, Test accuracy: 33.56
Round  29, Global train loss: 0.983, Global test loss: 0.984, Global test accuracy: 65.60
Round  30, Train loss: 1.222, Test loss: 1.475, Test accuracy: 33.60
Round  30, Global train loss: 1.222, Global test loss: 1.257, Global test accuracy: 51.40
Round  31, Train loss: 1.136, Test loss: 1.494, Test accuracy: 32.78
Round  31, Global train loss: 1.136, Global test loss: 1.193, Global test accuracy: 59.40
Round  32, Train loss: 1.402, Test loss: 1.494, Test accuracy: 32.86
Round  32, Global train loss: 1.402, Global test loss: 1.446, Global test accuracy: 42.00
Round  33, Train loss: 1.071, Test loss: 1.516, Test accuracy: 33.16
Round  33, Global train loss: 1.071, Global test loss: 1.224, Global test accuracy: 51.20
Round  34, Train loss: 1.230, Test loss: 1.522, Test accuracy: 33.26
Round  34, Global train loss: 1.230, Global test loss: 1.304, Global test accuracy: 49.60
Round  35, Train loss: 1.358, Test loss: 1.526, Test accuracy: 32.54
Round  35, Global train loss: 1.358, Global test loss: 1.417, Global test accuracy: 43.20
Round  36, Train loss: 1.481, Test loss: 1.535, Test accuracy: 33.40
Round  36, Global train loss: 1.481, Global test loss: 1.556, Global test accuracy: 30.20
Round  37, Train loss: 0.996, Test loss: 1.568, Test accuracy: 32.70
Round  37, Global train loss: 0.996, Global test loss: 1.232, Global test accuracy: 50.00
Round  38, Train loss: 1.144, Test loss: 1.553, Test accuracy: 33.44
Round  38, Global train loss: 1.144, Global test loss: 1.334, Global test accuracy: 47.80
Round  39, Train loss: 1.236, Test loss: 1.577, Test accuracy: 32.84
Round  39, Global train loss: 1.236, Global test loss: 1.433, Global test accuracy: 40.00
Round  40, Train loss: 1.045, Test loss: 1.610, Test accuracy: 32.64
Round  40, Global train loss: 1.045, Global test loss: 1.189, Global test accuracy: 46.60
Round  41, Train loss: 1.479, Test loss: 1.619, Test accuracy: 33.38
Round  41, Global train loss: 1.479, Global test loss: 1.583, Global test accuracy: 25.60
Round  42, Train loss: 0.882, Test loss: 1.591, Test accuracy: 34.38
Round  42, Global train loss: 0.882, Global test loss: 1.117, Global test accuracy: 51.80
Round  43, Train loss: 0.953, Test loss: 1.619, Test accuracy: 33.64
Round  43, Global train loss: 0.953, Global test loss: 0.981, Global test accuracy: 65.00
Round  44, Train loss: 1.096, Test loss: 1.626, Test accuracy: 33.04
Round  44, Global train loss: 1.096, Global test loss: 1.195, Global test accuracy: 52.40
Round  45, Train loss: 1.229, Test loss: 1.630, Test accuracy: 33.78
Round  45, Global train loss: 1.229, Global test loss: 1.385, Global test accuracy: 42.80
Round  46, Train loss: 1.003, Test loss: 1.680, Test accuracy: 33.40
Round  46, Global train loss: 1.003, Global test loss: 1.295, Global test accuracy: 50.20
Round  47, Train loss: 1.183, Test loss: 1.693, Test accuracy: 33.76
Round  47, Global train loss: 1.183, Global test loss: 1.356, Global test accuracy: 44.00
Round  48, Train loss: 0.849, Test loss: 1.671, Test accuracy: 33.68
Round  48, Global train loss: 0.849, Global test loss: 0.916, Global test accuracy: 70.20
Round  49, Train loss: 1.431, Test loss: 1.692, Test accuracy: 32.80
Round  49, Global train loss: 1.431, Global test loss: 1.598, Global test accuracy: 24.20
Round  50, Train loss: 0.885, Test loss: 1.744, Test accuracy: 32.42
Round  50, Global train loss: 0.885, Global test loss: 1.140, Global test accuracy: 51.40
Round  51, Train loss: 1.201, Test loss: 1.800, Test accuracy: 32.34
Round  51, Global train loss: 1.201, Global test loss: 1.603, Global test accuracy: 24.60
Round  52, Train loss: 0.906, Test loss: 1.811, Test accuracy: 32.94
Round  52, Global train loss: 0.906, Global test loss: 1.011, Global test accuracy: 65.40
Round  53, Train loss: 0.714, Test loss: 1.803, Test accuracy: 33.42
Round  53, Global train loss: 0.714, Global test loss: 0.923, Global test accuracy: 63.60
Round  54, Train loss: 1.178, Test loss: 1.827, Test accuracy: 33.70
Round  54, Global train loss: 1.178, Global test loss: 1.528, Global test accuracy: 32.20
Round  55, Train loss: 0.920, Test loss: 1.872, Test accuracy: 32.76
Round  55, Global train loss: 0.920, Global test loss: 1.065, Global test accuracy: 60.60
Round  56, Train loss: 1.295, Test loss: 1.884, Test accuracy: 32.02
Round  56, Global train loss: 1.295, Global test loss: 1.603, Global test accuracy: 23.20
Round  57, Train loss: 0.562, Test loss: 1.881, Test accuracy: 31.78
Round  57, Global train loss: 0.562, Global test loss: 0.867, Global test accuracy: 69.40
Round  58, Train loss: 0.927, Test loss: 1.900, Test accuracy: 32.82
Round  58, Global train loss: 0.927, Global test loss: 1.182, Global test accuracy: 54.80
Round  59, Train loss: 1.169, Test loss: 1.943, Test accuracy: 32.30
Round  59, Global train loss: 1.169, Global test loss: 1.361, Global test accuracy: 43.40
Round  60, Train loss: 0.826, Test loss: 1.986, Test accuracy: 31.80
Round  60, Global train loss: 0.826, Global test loss: 1.089, Global test accuracy: 59.40
Round  61, Train loss: 0.583, Test loss: 1.977, Test accuracy: 32.20
Round  61, Global train loss: 0.583, Global test loss: 0.897, Global test accuracy: 65.80
Round  62, Train loss: 0.621, Test loss: 2.058, Test accuracy: 31.66
Round  62, Global train loss: 0.621, Global test loss: 1.071, Global test accuracy: 59.80
Round  63, Train loss: 0.987, Test loss: 2.049, Test accuracy: 32.14
Round  63, Global train loss: 0.987, Global test loss: 1.604, Global test accuracy: 25.80
Round  64, Train loss: 0.814, Test loss: 2.084, Test accuracy: 31.50
Round  64, Global train loss: 0.814, Global test loss: 1.151, Global test accuracy: 62.20
Round  65, Train loss: 0.766, Test loss: 2.163, Test accuracy: 31.54
Round  65, Global train loss: 0.766, Global test loss: 1.363, Global test accuracy: 39.00
Round  66, Train loss: 0.669, Test loss: 2.082, Test accuracy: 32.34
Round  66, Global train loss: 0.669, Global test loss: 1.003, Global test accuracy: 61.20
Round  67, Train loss: 0.824, Test loss: 2.110, Test accuracy: 32.38
Round  67, Global train loss: 0.824, Global test loss: 1.346, Global test accuracy: 45.20
Round  68, Train loss: 0.474, Test loss: 2.146, Test accuracy: 31.92
Round  68, Global train loss: 0.474, Global test loss: 0.899, Global test accuracy: 67.60
Round  69, Train loss: 0.680, Test loss: 2.120, Test accuracy: 32.38
Round  69, Global train loss: 0.680, Global test loss: 1.241, Global test accuracy: 48.20
Round  70, Train loss: 1.082, Test loss: 2.156, Test accuracy: 32.44
Round  70, Global train loss: 1.082, Global test loss: 1.594, Global test accuracy: 25.00
Round  71, Train loss: 0.612, Test loss: 2.170, Test accuracy: 32.30
Round  71, Global train loss: 0.612, Global test loss: 1.210, Global test accuracy: 50.00
Round  72, Train loss: 0.816, Test loss: 2.216, Test accuracy: 32.68
Round  72, Global train loss: 0.816, Global test loss: 1.295, Global test accuracy: 48.00
Round  73, Train loss: 0.804, Test loss: 2.267, Test accuracy: 32.50
Round  73, Global train loss: 0.804, Global test loss: 1.121, Global test accuracy: 62.80
Round  74, Train loss: 0.582, Test loss: 2.362, Test accuracy: 31.82
Round  74, Global train loss: 0.582, Global test loss: 1.324, Global test accuracy: 45.20
Round  75, Train loss: 0.773, Test loss: 2.403, Test accuracy: 32.08
Round  75, Global train loss: 0.773, Global test loss: 1.202, Global test accuracy: 56.60
Round  76, Train loss: 0.469, Test loss: 2.499, Test accuracy: 32.62
Round  76, Global train loss: 0.469, Global test loss: 1.300, Global test accuracy: 48.00
Round  77, Train loss: 0.589, Test loss: 2.530, Test accuracy: 32.22
Round  77, Global train loss: 0.589, Global test loss: 1.251, Global test accuracy: 53.20
Round  78, Train loss: 0.684, Test loss: 2.561, Test accuracy: 32.48
Round  78, Global train loss: 0.684, Global test loss: 1.201, Global test accuracy: 51.20
Round  79, Train loss: 0.851, Test loss: 2.616, Test accuracy: 32.46
Round  79, Global train loss: 0.851, Global test loss: 1.204, Global test accuracy: 53.00
Round  80, Train loss: 0.495, Test loss: 2.631, Test accuracy: 32.18
Round  80, Global train loss: 0.495, Global test loss: 1.231, Global test accuracy: 51.20
Round  81, Train loss: 0.396, Test loss: 2.639, Test accuracy: 32.08
Round  81, Global train loss: 0.396, Global test loss: 1.278, Global test accuracy: 50.80
Round  82, Train loss: 0.647, Test loss: 2.633, Test accuracy: 32.58
Round  82, Global train loss: 0.647, Global test loss: 1.289, Global test accuracy: 44.00
Round  83, Train loss: 0.595, Test loss: 2.721, Test accuracy: 32.40
Round  83, Global train loss: 0.595, Global test loss: 1.620, Global test accuracy: 32.00
Round  84, Train loss: 0.410, Test loss: 2.760, Test accuracy: 33.32
Round  84, Global train loss: 0.410, Global test loss: 1.137, Global test accuracy: 55.80
Round  85, Train loss: 0.535, Test loss: 2.781, Test accuracy: 32.66
Round  85, Global train loss: 0.535, Global test loss: 1.189, Global test accuracy: 51.60
Round  86, Train loss: 0.532, Test loss: 2.834, Test accuracy: 32.58
Round  86, Global train loss: 0.532, Global test loss: 1.141, Global test accuracy: 56.00
Round  87, Train loss: 0.488, Test loss: 2.835, Test accuracy: 32.64
Round  87, Global train loss: 0.488, Global test loss: 1.003, Global test accuracy: 64.80
Round  88, Train loss: 0.662, Test loss: 2.891, Test accuracy: 33.24
Round  88, Global train loss: 0.662, Global test loss: 1.612, Global test accuracy: 28.00
Round  89, Train loss: 0.222, Test loss: 2.939, Test accuracy: 33.16
Round  89, Global train loss: 0.222, Global test loss: 0.948, Global test accuracy: 66.20
Round  90, Train loss: 0.826, Test loss: 2.950, Test accuracy: 32.68
Round  90, Global train loss: 0.826, Global test loss: 1.628, Global test accuracy: 22.80
Round  91, Train loss: 0.298, Test loss: 2.894, Test accuracy: 33.12
Round  91, Global train loss: 0.298, Global test loss: 1.039, Global test accuracy: 58.00
Round  92, Train loss: 0.718, Test loss: 2.960, Test accuracy: 32.84
Round  92, Global train loss: 0.718, Global test loss: 1.353, Global test accuracy: 42.00
Round  93, Train loss: 0.403, Test loss: 2.971, Test accuracy: 33.22
Round  93, Global train loss: 0.403, Global test loss: 1.190, Global test accuracy: 53.60
Round  94, Train loss: 0.413, Test loss: 3.072, Test accuracy: 33.10
Round  94, Global train loss: 0.413, Global test loss: 1.245, Global test accuracy: 52.60
Round  95, Train loss: 0.581, Test loss: 3.089, Test accuracy: 32.66
Round  95, Global train loss: 0.581, Global test loss: 1.699, Global test accuracy: 23.40
Round  96, Train loss: 0.616, Test loss: 3.096, Test accuracy: 32.32
Round  96, Global train loss: 0.616, Global test loss: 1.696, Global test accuracy: 21.20
Round  97, Train loss: 0.421, Test loss: 3.103, Test accuracy: 32.40
Round  97, Global train loss: 0.421, Global test loss: 1.044, Global test accuracy: 59.60
Round  98, Train loss: 0.536, Test loss: 3.274, Test accuracy: 32.00
Round  98, Global train loss: 0.536, Global test loss: 1.673, Global test accuracy: 28.60
Round  99, Train loss: 0.518, Test loss: 3.345, Test accuracy: 32.56
Round  99, Global train loss: 0.518, Global test loss: 1.473, Global test accuracy: 34.00
Final Round, Train loss: 0.408, Test loss: 3.471, Test accuracy: 31.92
Final Round, Global train loss: 0.408, Global test loss: 1.473, Global test accuracy: 34.00
Average accuracy final 10 rounds: 32.69 

Average global accuracy final 10 rounds: 39.58 

790.3324840068817
[1.6457269191741943, 3.2914538383483887, 4.439036130905151, 5.586618423461914, 6.832294702529907, 8.0779709815979, 9.290738105773926, 10.503505229949951, 11.705325603485107, 12.907145977020264, 14.123101949691772, 15.339057922363281, 16.518834352493286, 17.69861078262329, 18.92023515701294, 20.141859531402588, 21.338480710983276, 22.535101890563965, 23.75183892250061, 24.968575954437256, 26.139960289001465, 27.311344623565674, 28.4982168674469, 29.685089111328125, 30.82891035079956, 31.972731590270996, 33.20487713813782, 34.43702268600464, 35.673468828201294, 36.90991497039795, 38.195703983306885, 39.48149299621582, 40.62914776802063, 41.77680253982544, 42.994794845581055, 44.21278715133667, 45.407569885253906, 46.60235261917114, 47.74168133735657, 48.88101005554199, 50.07839870452881, 51.275787353515625, 52.44464373588562, 53.613500118255615, 54.799262285232544, 55.98502445220947, 57.1923041343689, 58.39958381652832, 59.6138277053833, 60.82807159423828, 62.01043391227722, 63.19279623031616, 64.35914611816406, 65.52549600601196, 66.69782948493958, 67.87016296386719, 69.06086564064026, 70.25156831741333, 71.44908809661865, 72.64660787582397, 73.86826658248901, 75.08992528915405, 76.3500463962555, 77.61016750335693, 78.80634450912476, 80.00252151489258, 81.21395993232727, 82.42539834976196, 83.59636545181274, 84.76733255386353, 85.96354603767395, 87.15975952148438, 88.36493563652039, 89.5701117515564, 90.78569960594177, 92.00128746032715, 93.17770266532898, 94.35411787033081, 95.53811550140381, 96.7221131324768, 97.89237117767334, 99.06262922286987, 100.30142903327942, 101.54022884368896, 102.77698922157288, 104.01374959945679, 105.26591944694519, 106.5180892944336, 107.76307654380798, 109.00806379318237, 110.1974151134491, 111.38676643371582, 112.58578729629517, 113.78480815887451, 114.98078417778015, 116.17676019668579, 117.3029146194458, 118.42906904220581, 119.56551599502563, 120.70196294784546, 121.82576704025269, 122.94957113265991, 124.09646368026733, 125.24335622787476, 126.46095991134644, 127.67856359481812, 128.91662049293518, 130.15467739105225, 131.37231612205505, 132.58995485305786, 133.77415776252747, 134.95836067199707, 136.2274158000946, 137.49647092819214, 138.67422819137573, 139.85198545455933, 141.062260389328, 142.27253532409668, 143.49246072769165, 144.71238613128662, 145.90353083610535, 147.09467554092407, 148.2983946800232, 149.50211381912231, 150.69564700126648, 151.88918018341064, 153.1150233745575, 154.34086656570435, 155.56172609329224, 156.78258562088013, 157.90710878372192, 159.03163194656372, 160.21791434288025, 161.40419673919678, 162.63754844665527, 163.87090015411377, 165.05579471588135, 166.24068927764893, 167.43603658676147, 168.63138389587402, 169.85829901695251, 171.085214138031, 172.33129501342773, 173.57737588882446, 174.7227120399475, 175.86804819107056, 177.12546133995056, 178.38287448883057, 179.551007270813, 180.7191400527954, 181.91103839874268, 183.10293674468994, 184.30079531669617, 185.4986538887024, 186.7596950531006, 188.02073621749878, 189.2358958721161, 190.4510555267334, 191.79840326309204, 193.14575099945068, 194.35373282432556, 195.56171464920044, 196.72548913955688, 197.88926362991333, 199.07910752296448, 200.26895141601562, 201.4895589351654, 202.71016645431519, 203.94302535057068, 205.17588424682617, 206.34958577156067, 207.52328729629517, 208.68663096427917, 209.84997463226318, 211.0494294166565, 212.2488842010498, 213.42276740074158, 214.59665060043335, 215.73938727378845, 216.88212394714355, 218.03245902061462, 219.1827940940857, 220.36254978179932, 221.54230546951294, 222.77760457992554, 224.01290369033813, 225.24822402000427, 226.4835443496704, 227.7378499507904, 228.9921555519104, 230.1467409133911, 231.30132627487183, 232.51962232589722, 233.7379183769226, 234.9099771976471, 236.08203601837158, 237.26701712608337, 238.45199823379517, 239.58560848236084, 240.7192187309265, 243.09642052650452, 245.47362232208252]
[45.58, 45.58, 45.06, 45.06, 38.76, 38.76, 38.82, 38.82, 41.08, 41.08, 41.28, 41.28, 38.44, 38.44, 37.02, 37.02, 36.28, 36.28, 35.2, 35.2, 35.52, 35.52, 35.42, 35.42, 35.12, 35.12, 35.9, 35.9, 34.04, 34.04, 34.48, 34.48, 34.64, 34.64, 34.64, 34.64, 33.7, 33.7, 32.78, 32.78, 33.06, 33.06, 32.92, 32.92, 33.1, 33.1, 32.58, 32.58, 32.78, 32.78, 32.92, 32.92, 33.18, 33.18, 33.3, 33.3, 32.96, 32.96, 33.56, 33.56, 33.6, 33.6, 32.78, 32.78, 32.86, 32.86, 33.16, 33.16, 33.26, 33.26, 32.54, 32.54, 33.4, 33.4, 32.7, 32.7, 33.44, 33.44, 32.84, 32.84, 32.64, 32.64, 33.38, 33.38, 34.38, 34.38, 33.64, 33.64, 33.04, 33.04, 33.78, 33.78, 33.4, 33.4, 33.76, 33.76, 33.68, 33.68, 32.8, 32.8, 32.42, 32.42, 32.34, 32.34, 32.94, 32.94, 33.42, 33.42, 33.7, 33.7, 32.76, 32.76, 32.02, 32.02, 31.78, 31.78, 32.82, 32.82, 32.3, 32.3, 31.8, 31.8, 32.2, 32.2, 31.66, 31.66, 32.14, 32.14, 31.5, 31.5, 31.54, 31.54, 32.34, 32.34, 32.38, 32.38, 31.92, 31.92, 32.38, 32.38, 32.44, 32.44, 32.3, 32.3, 32.68, 32.68, 32.5, 32.5, 31.82, 31.82, 32.08, 32.08, 32.62, 32.62, 32.22, 32.22, 32.48, 32.48, 32.46, 32.46, 32.18, 32.18, 32.08, 32.08, 32.58, 32.58, 32.4, 32.4, 33.32, 33.32, 32.66, 32.66, 32.58, 32.58, 32.64, 32.64, 33.24, 33.24, 33.16, 33.16, 32.68, 32.68, 33.12, 33.12, 32.84, 32.84, 33.22, 33.22, 33.1, 33.1, 32.66, 32.66, 32.32, 32.32, 32.4, 32.4, 32.0, 32.0, 32.56, 32.56, 31.92, 31.92]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.575, Test loss: 1.575, Test accuracy: 22.08
Round   0, Global train loss: 1.575, Global test loss: 1.578, Global test accuracy: 22.40
Round   1, Train loss: 1.541, Test loss: 1.531, Test accuracy: 29.60
Round   1, Global train loss: 1.541, Global test loss: 1.503, Global test accuracy: 30.80
Round   2, Train loss: 1.572, Test loss: 1.532, Test accuracy: 32.34
Round   2, Global train loss: 1.572, Global test loss: 1.514, Global test accuracy: 33.40
Round   3, Train loss: 1.553, Test loss: 1.519, Test accuracy: 34.06
Round   3, Global train loss: 1.553, Global test loss: 1.489, Global test accuracy: 39.00
Round   4, Train loss: 1.506, Test loss: 1.496, Test accuracy: 37.06
Round   4, Global train loss: 1.506, Global test loss: 1.443, Global test accuracy: 44.60
Round   5, Train loss: 1.466, Test loss: 1.476, Test accuracy: 37.52
Round   5, Global train loss: 1.466, Global test loss: 1.394, Global test accuracy: 45.60
Round   6, Train loss: 1.544, Test loss: 1.501, Test accuracy: 36.60
Round   6, Global train loss: 1.544, Global test loss: 1.466, Global test accuracy: 43.60
Round   7, Train loss: 1.501, Test loss: 1.495, Test accuracy: 37.58
Round   7, Global train loss: 1.501, Global test loss: 1.439, Global test accuracy: 42.40
Round   8, Train loss: 1.516, Test loss: 1.481, Test accuracy: 37.62
Round   8, Global train loss: 1.516, Global test loss: 1.394, Global test accuracy: 41.00
Round   9, Train loss: 1.541, Test loss: 1.480, Test accuracy: 38.04
Round   9, Global train loss: 1.541, Global test loss: 1.485, Global test accuracy: 40.60
Round  10, Train loss: 1.573, Test loss: 1.475, Test accuracy: 37.30
Round  10, Global train loss: 1.573, Global test loss: 1.500, Global test accuracy: 35.00
Round  11, Train loss: 1.461, Test loss: 1.462, Test accuracy: 37.98
Round  11, Global train loss: 1.461, Global test loss: 1.332, Global test accuracy: 44.60
Round  12, Train loss: 1.533, Test loss: 1.463, Test accuracy: 36.76
Round  12, Global train loss: 1.533, Global test loss: 1.513, Global test accuracy: 35.60
Round  13, Train loss: 1.480, Test loss: 1.470, Test accuracy: 36.34
Round  13, Global train loss: 1.480, Global test loss: 1.410, Global test accuracy: 42.20
Round  14, Train loss: 1.510, Test loss: 1.482, Test accuracy: 35.08
Round  14, Global train loss: 1.510, Global test loss: 1.543, Global test accuracy: 28.60
Round  15, Train loss: 1.480, Test loss: 1.488, Test accuracy: 36.22
Round  15, Global train loss: 1.480, Global test loss: 1.390, Global test accuracy: 43.20
Round  16, Train loss: 1.413, Test loss: 1.478, Test accuracy: 36.68
Round  16, Global train loss: 1.413, Global test loss: 1.411, Global test accuracy: 43.20
Round  17, Train loss: 1.524, Test loss: 1.479, Test accuracy: 37.04
Round  17, Global train loss: 1.524, Global test loss: 1.493, Global test accuracy: 33.20
Round  18, Train loss: 1.491, Test loss: 1.481, Test accuracy: 37.62
Round  18, Global train loss: 1.491, Global test loss: 1.540, Global test accuracy: 31.20
Round  19, Train loss: 1.440, Test loss: 1.476, Test accuracy: 37.30
Round  19, Global train loss: 1.440, Global test loss: 1.343, Global test accuracy: 44.80
Round  20, Train loss: 1.443, Test loss: 1.481, Test accuracy: 37.18
Round  20, Global train loss: 1.443, Global test loss: 1.363, Global test accuracy: 44.60
Round  21, Train loss: 1.410, Test loss: 1.486, Test accuracy: 35.90
Round  21, Global train loss: 1.410, Global test loss: 1.398, Global test accuracy: 45.80
Round  22, Train loss: 1.402, Test loss: 1.491, Test accuracy: 35.32
Round  22, Global train loss: 1.402, Global test loss: 1.445, Global test accuracy: 39.80
Round  23, Train loss: 1.380, Test loss: 1.497, Test accuracy: 35.18
Round  23, Global train loss: 1.380, Global test loss: 1.536, Global test accuracy: 35.20
Round  24, Train loss: 1.354, Test loss: 1.506, Test accuracy: 35.12
Round  24, Global train loss: 1.354, Global test loss: 1.527, Global test accuracy: 32.20
Round  25, Train loss: 1.336, Test loss: 1.513, Test accuracy: 35.98
Round  25, Global train loss: 1.336, Global test loss: 1.397, Global test accuracy: 44.20
Round  26, Train loss: 1.364, Test loss: 1.547, Test accuracy: 35.04
Round  26, Global train loss: 1.364, Global test loss: 1.637, Global test accuracy: 28.20
Round  27, Train loss: 1.244, Test loss: 1.574, Test accuracy: 34.68
Round  27, Global train loss: 1.244, Global test loss: 1.371, Global test accuracy: 45.60
Round  28, Train loss: 1.347, Test loss: 1.613, Test accuracy: 34.70
Round  28, Global train loss: 1.347, Global test loss: 1.613, Global test accuracy: 31.20
Round  29, Train loss: 1.299, Test loss: 1.624, Test accuracy: 34.74
Round  29, Global train loss: 1.299, Global test loss: 1.422, Global test accuracy: 39.00
Round  30, Train loss: 1.231, Test loss: 1.613, Test accuracy: 34.52
Round  30, Global train loss: 1.231, Global test loss: 1.508, Global test accuracy: 37.20
Round  31, Train loss: 1.146, Test loss: 1.652, Test accuracy: 33.68
Round  31, Global train loss: 1.146, Global test loss: 1.346, Global test accuracy: 44.00
Round  32, Train loss: 1.271, Test loss: 1.708, Test accuracy: 32.78
Round  32, Global train loss: 1.271, Global test loss: 1.648, Global test accuracy: 34.80
Round  33, Train loss: 1.120, Test loss: 1.747, Test accuracy: 33.44
Round  33, Global train loss: 1.120, Global test loss: 1.681, Global test accuracy: 36.60
Round  34, Train loss: 1.166, Test loss: 1.711, Test accuracy: 33.88
Round  34, Global train loss: 1.166, Global test loss: 1.599, Global test accuracy: 35.00
Round  35, Train loss: 1.170, Test loss: 1.770, Test accuracy: 33.06
Round  35, Global train loss: 1.170, Global test loss: 1.710, Global test accuracy: 29.80
Round  36, Train loss: 1.040, Test loss: 1.812, Test accuracy: 33.24
Round  36, Global train loss: 1.040, Global test loss: 1.955, Global test accuracy: 28.40
Round  37, Train loss: 1.027, Test loss: 1.839, Test accuracy: 32.80
Round  37, Global train loss: 1.027, Global test loss: 1.731, Global test accuracy: 35.40
Round  38, Train loss: 0.938, Test loss: 1.883, Test accuracy: 32.62
Round  38, Global train loss: 0.938, Global test loss: 1.850, Global test accuracy: 34.60
Round  39, Train loss: 0.919, Test loss: 1.917, Test accuracy: 33.22
Round  39, Global train loss: 0.919, Global test loss: 1.737, Global test accuracy: 39.00
Round  40, Train loss: 1.011, Test loss: 1.974, Test accuracy: 31.86
Round  40, Global train loss: 1.011, Global test loss: 1.812, Global test accuracy: 30.80
Round  41, Train loss: 0.903, Test loss: 2.010, Test accuracy: 31.36
Round  41, Global train loss: 0.903, Global test loss: 2.198, Global test accuracy: 26.00
Round  42, Train loss: 0.928, Test loss: 2.031, Test accuracy: 31.54
Round  42, Global train loss: 0.928, Global test loss: 1.832, Global test accuracy: 38.20
Round  43, Train loss: 0.977, Test loss: 2.121, Test accuracy: 32.18
Round  43, Global train loss: 0.977, Global test loss: 1.620, Global test accuracy: 38.80
Round  44, Train loss: 0.866, Test loss: 2.126, Test accuracy: 31.28
Round  44, Global train loss: 0.866, Global test loss: 2.118, Global test accuracy: 26.60
Round  45, Train loss: 0.847, Test loss: 2.149, Test accuracy: 32.32
Round  45, Global train loss: 0.847, Global test loss: 1.868, Global test accuracy: 36.40
Round  46, Train loss: 0.693, Test loss: 2.218, Test accuracy: 32.74
Round  46, Global train loss: 0.693, Global test loss: 2.155, Global test accuracy: 33.60
Round  47, Train loss: 0.759, Test loss: 2.297, Test accuracy: 32.20
Round  47, Global train loss: 0.759, Global test loss: 2.263, Global test accuracy: 28.80
Round  48, Train loss: 0.924, Test loss: 2.370, Test accuracy: 31.98
Round  48, Global train loss: 0.924, Global test loss: 1.810, Global test accuracy: 36.00
Round  49, Train loss: 0.729, Test loss: 2.478, Test accuracy: 31.06
Round  49, Global train loss: 0.729, Global test loss: 2.341, Global test accuracy: 30.80
Round  50, Train loss: 0.777, Test loss: 2.493, Test accuracy: 30.92
Round  50, Global train loss: 0.777, Global test loss: 1.945, Global test accuracy: 36.00
Round  51, Train loss: 0.593, Test loss: 2.563, Test accuracy: 30.96
Round  51, Global train loss: 0.593, Global test loss: 2.671, Global test accuracy: 29.60
Round  52, Train loss: 0.833, Test loss: 2.575, Test accuracy: 31.40
Round  52, Global train loss: 0.833, Global test loss: 1.821, Global test accuracy: 36.80
Round  53, Train loss: 0.677, Test loss: 2.638, Test accuracy: 30.70
Round  53, Global train loss: 0.677, Global test loss: 2.133, Global test accuracy: 33.00
Round  54, Train loss: 0.545, Test loss: 2.688, Test accuracy: 31.18
Round  54, Global train loss: 0.545, Global test loss: 2.876, Global test accuracy: 27.20
Round  55, Train loss: 0.675, Test loss: 2.709, Test accuracy: 31.02
Round  55, Global train loss: 0.675, Global test loss: 2.265, Global test accuracy: 33.80
Round  56, Train loss: 0.506, Test loss: 2.815, Test accuracy: 31.34
Round  56, Global train loss: 0.506, Global test loss: 3.118, Global test accuracy: 28.60
Round  57, Train loss: 0.676, Test loss: 2.876, Test accuracy: 32.02
Round  57, Global train loss: 0.676, Global test loss: 2.009, Global test accuracy: 40.80
Round  58, Train loss: 0.550, Test loss: 2.855, Test accuracy: 32.86
Round  58, Global train loss: 0.550, Global test loss: 2.726, Global test accuracy: 27.80
Round  59, Train loss: 0.617, Test loss: 2.940, Test accuracy: 32.96
Round  59, Global train loss: 0.617, Global test loss: 2.253, Global test accuracy: 34.40
Round  60, Train loss: 0.581, Test loss: 2.970, Test accuracy: 32.26
Round  60, Global train loss: 0.581, Global test loss: 2.280, Global test accuracy: 33.80
Round  61, Train loss: 0.553, Test loss: 3.065, Test accuracy: 31.88
Round  61, Global train loss: 0.553, Global test loss: 2.270, Global test accuracy: 33.80
Round  62, Train loss: 0.483, Test loss: 2.968, Test accuracy: 32.86
Round  62, Global train loss: 0.483, Global test loss: 2.312, Global test accuracy: 38.60
Round  63, Train loss: 0.481, Test loss: 2.999, Test accuracy: 32.96
Round  63, Global train loss: 0.481, Global test loss: 2.755, Global test accuracy: 38.20
Round  64, Train loss: 0.439, Test loss: 3.117, Test accuracy: 32.10
Round  64, Global train loss: 0.439, Global test loss: 2.394, Global test accuracy: 38.80
Round  65, Train loss: 0.443, Test loss: 3.176, Test accuracy: 32.06
Round  65, Global train loss: 0.443, Global test loss: 2.787, Global test accuracy: 38.80
Round  66, Train loss: 0.551, Test loss: 3.288, Test accuracy: 31.56
Round  66, Global train loss: 0.551, Global test loss: 2.164, Global test accuracy: 39.60
Round  67, Train loss: 0.418, Test loss: 3.274, Test accuracy: 31.34
Round  67, Global train loss: 0.418, Global test loss: 3.017, Global test accuracy: 29.40
Round  68, Train loss: 0.442, Test loss: 3.326, Test accuracy: 31.76
Round  68, Global train loss: 0.442, Global test loss: 2.421, Global test accuracy: 36.00
Round  69, Train loss: 0.359, Test loss: 3.388, Test accuracy: 31.90
Round  69, Global train loss: 0.359, Global test loss: 3.112, Global test accuracy: 29.80
Round  70, Train loss: 0.411, Test loss: 3.487, Test accuracy: 30.52
Round  70, Global train loss: 0.411, Global test loss: 3.573, Global test accuracy: 27.80
Round  71, Train loss: 0.413, Test loss: 3.498, Test accuracy: 30.06
Round  71, Global train loss: 0.413, Global test loss: 3.066, Global test accuracy: 31.40
Round  72, Train loss: 0.362, Test loss: 3.447, Test accuracy: 30.86
Round  72, Global train loss: 0.362, Global test loss: 3.038, Global test accuracy: 32.40
Round  73, Train loss: 0.428, Test loss: 3.439, Test accuracy: 31.76
Round  73, Global train loss: 0.428, Global test loss: 2.889, Global test accuracy: 34.00
Round  74, Train loss: 0.365, Test loss: 3.405, Test accuracy: 32.40
Round  74, Global train loss: 0.365, Global test loss: 2.803, Global test accuracy: 37.40
Round  75, Train loss: 0.377, Test loss: 3.444, Test accuracy: 31.96
Round  75, Global train loss: 0.377, Global test loss: 2.837, Global test accuracy: 33.00
Round  76, Train loss: 0.270, Test loss: 3.550, Test accuracy: 31.74
Round  76, Global train loss: 0.270, Global test loss: 3.230, Global test accuracy: 35.40
Round  77, Train loss: 0.334, Test loss: 3.565, Test accuracy: 31.76
Round  77, Global train loss: 0.334, Global test loss: 2.859, Global test accuracy: 34.40
Round  78, Train loss: 0.298, Test loss: 3.517, Test accuracy: 32.18
Round  78, Global train loss: 0.298, Global test loss: 3.394, Global test accuracy: 29.60
Round  79, Train loss: 0.372, Test loss: 3.591, Test accuracy: 32.36
Round  79, Global train loss: 0.372, Global test loss: 2.807, Global test accuracy: 37.20
Round  80, Train loss: 0.335, Test loss: 3.599, Test accuracy: 33.22
Round  80, Global train loss: 0.335, Global test loss: 3.228, Global test accuracy: 36.00
Round  81, Train loss: 0.231, Test loss: 3.634, Test accuracy: 33.32
Round  81, Global train loss: 0.231, Global test loss: 3.287, Global test accuracy: 36.00
Round  82, Train loss: 0.251, Test loss: 3.621, Test accuracy: 33.04
Round  82, Global train loss: 0.251, Global test loss: 3.528, Global test accuracy: 30.80
Round  83, Train loss: 0.182, Test loss: 3.655, Test accuracy: 33.00
Round  83, Global train loss: 0.182, Global test loss: 3.822, Global test accuracy: 31.80
Round  84, Train loss: 0.335, Test loss: 3.731, Test accuracy: 32.48
Round  84, Global train loss: 0.335, Global test loss: 2.932, Global test accuracy: 38.80
Round  85, Train loss: 0.305, Test loss: 3.773, Test accuracy: 32.30
Round  85, Global train loss: 0.305, Global test loss: 2.911, Global test accuracy: 38.20
Round  86, Train loss: 0.291, Test loss: 3.788, Test accuracy: 32.54
Round  86, Global train loss: 0.291, Global test loss: 3.002, Global test accuracy: 38.20
Round  87, Train loss: 0.346, Test loss: 3.838, Test accuracy: 32.60
Round  87, Global train loss: 0.346, Global test loss: 2.786, Global test accuracy: 38.80
Round  88, Train loss: 0.229, Test loss: 3.842, Test accuracy: 32.68
Round  88, Global train loss: 0.229, Global test loss: 3.733, Global test accuracy: 32.60
Round  89, Train loss: 0.296, Test loss: 3.841, Test accuracy: 32.30
Round  89, Global train loss: 0.296, Global test loss: 2.927, Global test accuracy: 35.80
Round  90, Train loss: 0.237, Test loss: 3.908, Test accuracy: 32.26
Round  90, Global train loss: 0.237, Global test loss: 3.674, Global test accuracy: 35.40
Round  91, Train loss: 0.326, Test loss: 3.919, Test accuracy: 32.56
Round  91, Global train loss: 0.326, Global test loss: 2.757, Global test accuracy: 41.20
Round  92, Train loss: 0.339, Test loss: 3.959, Test accuracy: 32.32
Round  92, Global train loss: 0.339, Global test loss: 3.219, Global test accuracy: 32.40
Round  93, Train loss: 0.244, Test loss: 3.951, Test accuracy: 32.70
Round  93, Global train loss: 0.244, Global test loss: 3.777, Global test accuracy: 30.60
Round  94, Train loss: 0.200, Test loss: 3.980, Test accuracy: 32.74
Round  94, Global train loss: 0.200, Global test loss: 3.260, Global test accuracy: 39.00
Round  95, Train loss: 0.221, Test loss: 3.979, Test accuracy: 33.38
Round  95, Global train loss: 0.221, Global test loss: 3.622, Global test accuracy: 35.60
Round  96, Train loss: 0.204, Test loss: 4.084, Test accuracy: 32.98
Round  96, Global train loss: 0.204, Global test loss: 3.946, Global test accuracy: 33.60
Round  97, Train loss: 0.359, Test loss: 4.036, Test accuracy: 32.50
Round  97, Global train loss: 0.359, Global test loss: 2.750, Global test accuracy: 37.40
Round  98, Train loss: 0.177, Test loss: 4.084, Test accuracy: 32.28
Round  98, Global train loss: 0.177, Global test loss: 3.973, Global test accuracy: 32.80
Round  99, Train loss: 0.242, Test loss: 4.137, Test accuracy: 32.54
Round  99, Global train loss: 0.242, Global test loss: 3.611, Global test accuracy: 32.00
Final Round, Train loss: 0.194, Test loss: 4.429, Test accuracy: 31.18
Final Round, Global train loss: 0.194, Global test loss: 3.611, Global test accuracy: 32.00
Average accuracy final 10 rounds: 32.626000000000005 

Average global accuracy final 10 rounds: 35.0 

786.1599152088165
[1.453120231628418, 2.906240463256836, 4.05794358253479, 5.209646701812744, 6.3368165493011475, 7.463986396789551, 8.618428945541382, 9.772871494293213, 10.878812074661255, 11.984752655029297, 13.104612112045288, 14.22447156906128, 15.328520774841309, 16.432569980621338, 17.629592657089233, 18.82661533355713, 19.948028802871704, 21.06944227218628, 22.21157717704773, 23.35371208190918, 24.5162034034729, 25.67869472503662, 26.888046503067017, 28.097398281097412, 29.252828359603882, 30.40825843811035, 31.6125385761261, 32.816818714141846, 34.009429693222046, 35.202040672302246, 36.38902711868286, 37.57601356506348, 38.79155468940735, 40.00709581375122, 41.16588234901428, 42.324668884277344, 43.515543699264526, 44.70641851425171, 45.898961305618286, 47.09150409698486, 48.31242275238037, 49.53334140777588, 50.69065022468567, 51.84795904159546, 53.009902000427246, 54.17184495925903, 55.41619253158569, 56.66054010391235, 57.833006620407104, 59.005473136901855, 60.157565116882324, 61.30965709686279, 62.434786319732666, 63.55991554260254, 64.73792695999146, 65.91593837738037, 67.13632822036743, 68.35671806335449, 69.53270936012268, 70.70870065689087, 71.9033694267273, 73.09803819656372, 74.42358207702637, 75.74912595748901, 76.91499280929565, 78.0808596611023, 79.26557207107544, 80.45028448104858, 81.63145065307617, 82.81261682510376, 84.05634903907776, 85.30008125305176, 86.4688663482666, 87.63765144348145, 88.87469625473022, 90.111741065979, 91.31869149208069, 92.52564191818237, 93.71660542488098, 94.90756893157959, 96.09404754638672, 97.28052616119385, 98.44536280632019, 99.61019945144653, 100.80175566673279, 101.99331188201904, 103.25867247581482, 104.5240330696106, 105.65661430358887, 106.78919553756714, 107.99297165870667, 109.19674777984619, 110.39775943756104, 111.59877109527588, 112.86266040802002, 114.12654972076416, 115.31453514099121, 116.50252056121826, 117.68323183059692, 118.86394309997559, 120.07773542404175, 121.29152774810791, 122.51759171485901, 123.74365568161011, 124.90870571136475, 126.07375574111938, 127.24381041526794, 128.4138650894165, 129.72076535224915, 131.0276656150818, 132.26894354820251, 133.51022148132324, 134.62712836265564, 135.74403524398804, 136.92270231246948, 138.10136938095093, 139.28081941604614, 140.46026945114136, 141.6187870502472, 142.77730464935303, 143.8946657180786, 145.0120267868042, 146.20044088363647, 147.38885498046875, 148.57121753692627, 149.7535800933838, 150.85693526268005, 151.96029043197632, 153.10983061790466, 154.259370803833, 155.3789393901825, 156.49850797653198, 157.68786358833313, 158.87721920013428, 160.07820773124695, 161.27919626235962, 162.43504810333252, 163.59089994430542, 164.76665949821472, 165.94241905212402, 167.29849529266357, 168.65457153320312, 169.83669590950012, 171.01882028579712, 172.18681240081787, 173.35480451583862, 174.47674465179443, 175.59868478775024, 176.75793600082397, 177.9171872138977, 179.107901096344, 180.29861497879028, 181.52564930915833, 182.75268363952637, 183.9950213432312, 185.23735904693604, 186.41797375679016, 187.5985884666443, 188.77558374404907, 189.95257902145386, 191.100754737854, 192.24893045425415, 193.51220417022705, 194.77547788619995, 195.98947477340698, 197.203471660614, 198.3976149559021, 199.59175825119019, 200.77413082122803, 201.95650339126587, 203.1969907283783, 204.43747806549072, 205.646831035614, 206.8561840057373, 208.05384373664856, 209.25150346755981, 210.4301986694336, 211.60889387130737, 212.78838992118835, 213.96788597106934, 215.16501355171204, 216.36214113235474, 217.51409006118774, 218.66603899002075, 219.8917999267578, 221.11756086349487, 222.32150864601135, 223.52545642852783, 224.70840167999268, 225.89134693145752, 227.04094910621643, 228.19055128097534, 229.40933108329773, 230.62811088562012, 231.85539746284485, 233.08268404006958, 234.29122352600098, 235.49976301193237, 236.6580057144165, 237.81624841690063, 240.26568388938904, 242.71511936187744]
[22.08, 22.08, 29.6, 29.6, 32.34, 32.34, 34.06, 34.06, 37.06, 37.06, 37.52, 37.52, 36.6, 36.6, 37.58, 37.58, 37.62, 37.62, 38.04, 38.04, 37.3, 37.3, 37.98, 37.98, 36.76, 36.76, 36.34, 36.34, 35.08, 35.08, 36.22, 36.22, 36.68, 36.68, 37.04, 37.04, 37.62, 37.62, 37.3, 37.3, 37.18, 37.18, 35.9, 35.9, 35.32, 35.32, 35.18, 35.18, 35.12, 35.12, 35.98, 35.98, 35.04, 35.04, 34.68, 34.68, 34.7, 34.7, 34.74, 34.74, 34.52, 34.52, 33.68, 33.68, 32.78, 32.78, 33.44, 33.44, 33.88, 33.88, 33.06, 33.06, 33.24, 33.24, 32.8, 32.8, 32.62, 32.62, 33.22, 33.22, 31.86, 31.86, 31.36, 31.36, 31.54, 31.54, 32.18, 32.18, 31.28, 31.28, 32.32, 32.32, 32.74, 32.74, 32.2, 32.2, 31.98, 31.98, 31.06, 31.06, 30.92, 30.92, 30.96, 30.96, 31.4, 31.4, 30.7, 30.7, 31.18, 31.18, 31.02, 31.02, 31.34, 31.34, 32.02, 32.02, 32.86, 32.86, 32.96, 32.96, 32.26, 32.26, 31.88, 31.88, 32.86, 32.86, 32.96, 32.96, 32.1, 32.1, 32.06, 32.06, 31.56, 31.56, 31.34, 31.34, 31.76, 31.76, 31.9, 31.9, 30.52, 30.52, 30.06, 30.06, 30.86, 30.86, 31.76, 31.76, 32.4, 32.4, 31.96, 31.96, 31.74, 31.74, 31.76, 31.76, 32.18, 32.18, 32.36, 32.36, 33.22, 33.22, 33.32, 33.32, 33.04, 33.04, 33.0, 33.0, 32.48, 32.48, 32.3, 32.3, 32.54, 32.54, 32.6, 32.6, 32.68, 32.68, 32.3, 32.3, 32.26, 32.26, 32.56, 32.56, 32.32, 32.32, 32.7, 32.7, 32.74, 32.74, 33.38, 33.38, 32.98, 32.98, 32.5, 32.5, 32.28, 32.28, 32.54, 32.54, 31.18, 31.18]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.549, Test loss: 1.562, Test accuracy: 28.92
Round   0, Global train loss: 1.549, Global test loss: 1.566, Global test accuracy: 30.00
Round   1, Train loss: 1.475, Test loss: 1.463, Test accuracy: 35.00
Round   1, Global train loss: 1.475, Global test loss: 1.421, Global test accuracy: 41.80
Round   2, Train loss: 1.595, Test loss: 1.493, Test accuracy: 37.46
Round   2, Global train loss: 1.595, Global test loss: 1.508, Global test accuracy: 39.80
Round   3, Train loss: 1.522, Test loss: 1.475, Test accuracy: 37.26
Round   3, Global train loss: 1.522, Global test loss: 1.428, Global test accuracy: 42.40
Round   4, Train loss: 1.498, Test loss: 1.435, Test accuracy: 40.36
Round   4, Global train loss: 1.498, Global test loss: 1.371, Global test accuracy: 48.40
Round   5, Train loss: 1.482, Test loss: 1.426, Test accuracy: 39.66
Round   5, Global train loss: 1.482, Global test loss: 1.362, Global test accuracy: 45.20
Round   6, Train loss: 1.459, Test loss: 1.453, Test accuracy: 38.22
Round   6, Global train loss: 1.459, Global test loss: 1.378, Global test accuracy: 45.00
Round   7, Train loss: 1.577, Test loss: 1.455, Test accuracy: 38.02
Round   7, Global train loss: 1.577, Global test loss: 1.493, Global test accuracy: 39.60
Round   8, Train loss: 1.479, Test loss: 1.453, Test accuracy: 39.10
Round   8, Global train loss: 1.479, Global test loss: 1.395, Global test accuracy: 42.60
Round   9, Train loss: 1.564, Test loss: 1.449, Test accuracy: 38.70
Round   9, Global train loss: 1.564, Global test loss: 1.506, Global test accuracy: 35.80
Round  10, Train loss: 1.565, Test loss: 1.443, Test accuracy: 38.02
Round  10, Global train loss: 1.565, Global test loss: 1.462, Global test accuracy: 39.00
Round  11, Train loss: 1.457, Test loss: 1.449, Test accuracy: 37.12
Round  11, Global train loss: 1.457, Global test loss: 1.324, Global test accuracy: 47.80
Round  12, Train loss: 1.530, Test loss: 1.454, Test accuracy: 36.64
Round  12, Global train loss: 1.530, Global test loss: 1.523, Global test accuracy: 30.60
Round  13, Train loss: 1.542, Test loss: 1.455, Test accuracy: 36.28
Round  13, Global train loss: 1.542, Global test loss: 1.515, Global test accuracy: 33.40
Round  14, Train loss: 1.510, Test loss: 1.467, Test accuracy: 35.18
Round  14, Global train loss: 1.510, Global test loss: 1.554, Global test accuracy: 27.60
Round  15, Train loss: 1.428, Test loss: 1.472, Test accuracy: 34.90
Round  15, Global train loss: 1.428, Global test loss: 1.402, Global test accuracy: 36.00
Round  16, Train loss: 1.523, Test loss: 1.483, Test accuracy: 33.54
Round  16, Global train loss: 1.523, Global test loss: 1.558, Global test accuracy: 28.80
Round  17, Train loss: 1.402, Test loss: 1.490, Test accuracy: 33.24
Round  17, Global train loss: 1.402, Global test loss: 1.386, Global test accuracy: 41.40
Round  18, Train loss: 1.482, Test loss: 1.476, Test accuracy: 34.56
Round  18, Global train loss: 1.482, Global test loss: 1.500, Global test accuracy: 34.80
Round  19, Train loss: 1.417, Test loss: 1.498, Test accuracy: 32.82
Round  19, Global train loss: 1.417, Global test loss: 1.365, Global test accuracy: 37.40
Round  20, Train loss: 1.398, Test loss: 1.501, Test accuracy: 33.32
Round  20, Global train loss: 1.398, Global test loss: 1.321, Global test accuracy: 41.40
Round  21, Train loss: 1.402, Test loss: 1.490, Test accuracy: 33.92
Round  21, Global train loss: 1.402, Global test loss: 1.322, Global test accuracy: 42.40
Round  22, Train loss: 1.504, Test loss: 1.500, Test accuracy: 33.90
Round  22, Global train loss: 1.504, Global test loss: 1.541, Global test accuracy: 29.00
Round  23, Train loss: 1.466, Test loss: 1.500, Test accuracy: 34.14
Round  23, Global train loss: 1.466, Global test loss: 1.547, Global test accuracy: 29.60
Round  24, Train loss: 1.454, Test loss: 1.503, Test accuracy: 34.36
Round  24, Global train loss: 1.454, Global test loss: 1.577, Global test accuracy: 26.60
Round  25, Train loss: 1.357, Test loss: 1.494, Test accuracy: 34.50
Round  25, Global train loss: 1.357, Global test loss: 1.349, Global test accuracy: 40.60
Round  26, Train loss: 1.418, Test loss: 1.515, Test accuracy: 33.16
Round  26, Global train loss: 1.418, Global test loss: 1.559, Global test accuracy: 32.20
Round  27, Train loss: 1.337, Test loss: 1.494, Test accuracy: 34.34
Round  27, Global train loss: 1.337, Global test loss: 1.401, Global test accuracy: 39.20
Round  28, Train loss: 1.413, Test loss: 1.500, Test accuracy: 34.82
Round  28, Global train loss: 1.413, Global test loss: 1.532, Global test accuracy: 33.80
Round  29, Train loss: 1.322, Test loss: 1.528, Test accuracy: 33.78
Round  29, Global train loss: 1.322, Global test loss: 1.342, Global test accuracy: 42.60
Round  30, Train loss: 1.382, Test loss: 1.541, Test accuracy: 33.82
Round  30, Global train loss: 1.382, Global test loss: 1.554, Global test accuracy: 33.60
Round  31, Train loss: 1.293, Test loss: 1.542, Test accuracy: 33.92
Round  31, Global train loss: 1.293, Global test loss: 1.300, Global test accuracy: 44.00
Round  32, Train loss: 1.283, Test loss: 1.545, Test accuracy: 34.34
Round  32, Global train loss: 1.283, Global test loss: 1.363, Global test accuracy: 40.00
Round  33, Train loss: 1.361, Test loss: 1.568, Test accuracy: 34.14
Round  33, Global train loss: 1.361, Global test loss: 1.599, Global test accuracy: 30.00
Round  34, Train loss: 1.230, Test loss: 1.625, Test accuracy: 33.18
Round  34, Global train loss: 1.230, Global test loss: 1.481, Global test accuracy: 35.40
Round  35, Train loss: 1.177, Test loss: 1.665, Test accuracy: 32.92
Round  35, Global train loss: 1.177, Global test loss: 1.497, Global test accuracy: 37.80
Round  36, Train loss: 1.216, Test loss: 1.686, Test accuracy: 32.10
Round  36, Global train loss: 1.216, Global test loss: 1.881, Global test accuracy: 24.20
Round  37, Train loss: 1.290, Test loss: 1.716, Test accuracy: 31.58
Round  37, Global train loss: 1.290, Global test loss: 1.691, Global test accuracy: 29.60
Round  38, Train loss: 1.228, Test loss: 1.736, Test accuracy: 31.10
Round  38, Global train loss: 1.228, Global test loss: 1.710, Global test accuracy: 27.00
Round  39, Train loss: 1.101, Test loss: 1.763, Test accuracy: 31.40
Round  39, Global train loss: 1.101, Global test loss: 1.601, Global test accuracy: 32.60
Round  40, Train loss: 1.087, Test loss: 1.742, Test accuracy: 31.60
Round  40, Global train loss: 1.087, Global test loss: 1.484, Global test accuracy: 36.40
Round  41, Train loss: 1.104, Test loss: 1.783, Test accuracy: 31.78
Round  41, Global train loss: 1.104, Global test loss: 1.969, Global test accuracy: 28.00
Round  42, Train loss: 1.099, Test loss: 1.787, Test accuracy: 32.22
Round  42, Global train loss: 1.099, Global test loss: 1.405, Global test accuracy: 40.60
Round  43, Train loss: 0.998, Test loss: 1.826, Test accuracy: 31.96
Round  43, Global train loss: 0.998, Global test loss: 1.320, Global test accuracy: 47.00
Round  44, Train loss: 1.089, Test loss: 1.829, Test accuracy: 31.96
Round  44, Global train loss: 1.089, Global test loss: 1.712, Global test accuracy: 31.40
Round  45, Train loss: 0.982, Test loss: 1.895, Test accuracy: 31.56
Round  45, Global train loss: 0.982, Global test loss: 1.646, Global test accuracy: 34.80
Round  46, Train loss: 1.027, Test loss: 1.925, Test accuracy: 31.86
Round  46, Global train loss: 1.027, Global test loss: 1.950, Global test accuracy: 28.80
Round  47, Train loss: 0.849, Test loss: 1.997, Test accuracy: 31.76
Round  47, Global train loss: 0.849, Global test loss: 1.831, Global test accuracy: 34.20
Round  48, Train loss: 1.049, Test loss: 2.048, Test accuracy: 32.04
Round  48, Global train loss: 1.049, Global test loss: 1.532, Global test accuracy: 39.40
Round  49, Train loss: 0.989, Test loss: 2.072, Test accuracy: 31.60
Round  49, Global train loss: 0.989, Global test loss: 2.071, Global test accuracy: 25.80
Round  50, Train loss: 0.919, Test loss: 2.120, Test accuracy: 31.14
Round  50, Global train loss: 0.919, Global test loss: 1.714, Global test accuracy: 36.80
Round  51, Train loss: 0.851, Test loss: 2.106, Test accuracy: 32.12
Round  51, Global train loss: 0.851, Global test loss: 2.187, Global test accuracy: 28.00
Round  52, Train loss: 0.825, Test loss: 2.129, Test accuracy: 31.60
Round  52, Global train loss: 0.825, Global test loss: 1.512, Global test accuracy: 44.20
Round  53, Train loss: 0.856, Test loss: 2.083, Test accuracy: 33.06
Round  53, Global train loss: 0.856, Global test loss: 1.545, Global test accuracy: 45.00
Round  54, Train loss: 0.751, Test loss: 2.220, Test accuracy: 32.82
Round  54, Global train loss: 0.751, Global test loss: 2.503, Global test accuracy: 25.60
Round  55, Train loss: 0.803, Test loss: 2.242, Test accuracy: 33.20
Round  55, Global train loss: 0.803, Global test loss: 1.766, Global test accuracy: 39.20
Round  56, Train loss: 0.681, Test loss: 2.277, Test accuracy: 32.80
Round  56, Global train loss: 0.681, Global test loss: 2.501, Global test accuracy: 27.00
Round  57, Train loss: 0.890, Test loss: 2.309, Test accuracy: 33.12
Round  57, Global train loss: 0.890, Global test loss: 1.648, Global test accuracy: 43.40
Round  58, Train loss: 0.764, Test loss: 2.349, Test accuracy: 31.78
Round  58, Global train loss: 0.764, Global test loss: 2.222, Global test accuracy: 29.00
Round  59, Train loss: 0.764, Test loss: 2.398, Test accuracy: 32.12
Round  59, Global train loss: 0.764, Global test loss: 1.902, Global test accuracy: 36.20
Round  60, Train loss: 0.749, Test loss: 2.389, Test accuracy: 32.36
Round  60, Global train loss: 0.749, Global test loss: 1.784, Global test accuracy: 39.60
Round  61, Train loss: 0.612, Test loss: 2.455, Test accuracy: 32.30
Round  61, Global train loss: 0.612, Global test loss: 1.530, Global test accuracy: 49.80
Round  62, Train loss: 0.685, Test loss: 2.474, Test accuracy: 32.24
Round  62, Global train loss: 0.685, Global test loss: 1.785, Global test accuracy: 41.20
Round  63, Train loss: 0.709, Test loss: 2.562, Test accuracy: 32.30
Round  63, Global train loss: 0.709, Global test loss: 2.461, Global test accuracy: 29.60
Round  64, Train loss: 0.658, Test loss: 2.574, Test accuracy: 32.48
Round  64, Global train loss: 0.658, Global test loss: 1.913, Global test accuracy: 38.40
Round  65, Train loss: 0.610, Test loss: 2.510, Test accuracy: 32.66
Round  65, Global train loss: 0.610, Global test loss: 1.940, Global test accuracy: 41.40
Round  66, Train loss: 0.613, Test loss: 2.537, Test accuracy: 33.16
Round  66, Global train loss: 0.613, Global test loss: 1.584, Global test accuracy: 52.00
Round  67, Train loss: 0.595, Test loss: 2.615, Test accuracy: 33.96
Round  67, Global train loss: 0.595, Global test loss: 2.485, Global test accuracy: 35.20
Round  68, Train loss: 0.583, Test loss: 2.711, Test accuracy: 32.68
Round  68, Global train loss: 0.583, Global test loss: 2.177, Global test accuracy: 38.60
Round  69, Train loss: 0.544, Test loss: 2.753, Test accuracy: 32.44
Round  69, Global train loss: 0.544, Global test loss: 2.846, Global test accuracy: 28.20
Round  70, Train loss: 0.553, Test loss: 2.832, Test accuracy: 31.96
Round  70, Global train loss: 0.553, Global test loss: 2.737, Global test accuracy: 30.60
Round  71, Train loss: 0.578, Test loss: 2.879, Test accuracy: 32.74
Round  71, Global train loss: 0.578, Global test loss: 2.610, Global test accuracy: 33.60
Round  72, Train loss: 0.560, Test loss: 2.865, Test accuracy: 32.14
Round  72, Global train loss: 0.560, Global test loss: 2.633, Global test accuracy: 25.80
Round  73, Train loss: 0.500, Test loss: 2.924, Test accuracy: 32.08
Round  73, Global train loss: 0.500, Global test loss: 2.285, Global test accuracy: 41.00
Round  74, Train loss: 0.495, Test loss: 2.915, Test accuracy: 33.16
Round  74, Global train loss: 0.495, Global test loss: 2.272, Global test accuracy: 39.80
Round  75, Train loss: 0.497, Test loss: 2.856, Test accuracy: 34.02
Round  75, Global train loss: 0.497, Global test loss: 2.080, Global test accuracy: 43.40
Round  76, Train loss: 0.467, Test loss: 2.902, Test accuracy: 32.96
Round  76, Global train loss: 0.467, Global test loss: 2.727, Global test accuracy: 31.20
Round  77, Train loss: 0.386, Test loss: 2.906, Test accuracy: 32.94
Round  77, Global train loss: 0.386, Global test loss: 2.499, Global test accuracy: 35.80
Round  78, Train loss: 0.456, Test loss: 3.029, Test accuracy: 32.24
Round  78, Global train loss: 0.456, Global test loss: 2.911, Global test accuracy: 29.40
Round  79, Train loss: 0.525, Test loss: 3.104, Test accuracy: 32.22
Round  79, Global train loss: 0.525, Global test loss: 2.323, Global test accuracy: 33.60
Round  80, Train loss: 0.491, Test loss: 3.125, Test accuracy: 32.24
Round  80, Global train loss: 0.491, Global test loss: 2.690, Global test accuracy: 30.20
Round  81, Train loss: 0.391, Test loss: 3.099, Test accuracy: 32.70
Round  81, Global train loss: 0.391, Global test loss: 2.849, Global test accuracy: 31.00
Round  82, Train loss: 0.378, Test loss: 3.124, Test accuracy: 31.74
Round  82, Global train loss: 0.378, Global test loss: 3.017, Global test accuracy: 30.40
Round  83, Train loss: 0.369, Test loss: 3.174, Test accuracy: 31.46
Round  83, Global train loss: 0.369, Global test loss: 3.267, Global test accuracy: 27.20
Round  84, Train loss: 0.428, Test loss: 3.189, Test accuracy: 32.00
Round  84, Global train loss: 0.428, Global test loss: 2.486, Global test accuracy: 36.80
Round  85, Train loss: 0.488, Test loss: 3.209, Test accuracy: 32.04
Round  85, Global train loss: 0.488, Global test loss: 2.306, Global test accuracy: 39.40
Round  86, Train loss: 0.425, Test loss: 3.183, Test accuracy: 33.26
Round  86, Global train loss: 0.425, Global test loss: 2.438, Global test accuracy: 38.80
Round  87, Train loss: 0.319, Test loss: 3.237, Test accuracy: 33.62
Round  87, Global train loss: 0.319, Global test loss: 2.073, Global test accuracy: 51.40
Round  88, Train loss: 0.421, Test loss: 3.282, Test accuracy: 33.14
Round  88, Global train loss: 0.421, Global test loss: 3.208, Global test accuracy: 28.00
Round  89, Train loss: 0.372, Test loss: 3.295, Test accuracy: 33.38
Round  89, Global train loss: 0.372, Global test loss: 2.484, Global test accuracy: 39.40
Round  90, Train loss: 0.389, Test loss: 3.425, Test accuracy: 33.52
Round  90, Global train loss: 0.389, Global test loss: 3.411, Global test accuracy: 29.20
Round  91, Train loss: 0.371, Test loss: 3.490, Test accuracy: 32.42
Round  91, Global train loss: 0.371, Global test loss: 2.066, Global test accuracy: 48.20
Round  92, Train loss: 0.314, Test loss: 3.473, Test accuracy: 32.94
Round  92, Global train loss: 0.314, Global test loss: 2.634, Global test accuracy: 40.40
Round  93, Train loss: 0.314, Test loss: 3.370, Test accuracy: 34.52
Round  93, Global train loss: 0.314, Global test loss: 2.993, Global test accuracy: 35.20/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.305, Test loss: 3.450, Test accuracy: 34.32
Round  94, Global train loss: 0.305, Global test loss: 2.900, Global test accuracy: 34.60
Round  95, Train loss: 0.390, Test loss: 3.536, Test accuracy: 33.16
Round  95, Global train loss: 0.390, Global test loss: 3.355, Global test accuracy: 28.20
Round  96, Train loss: 0.306, Test loss: 3.587, Test accuracy: 32.62
Round  96, Global train loss: 0.306, Global test loss: 3.543, Global test accuracy: 30.00
Round  97, Train loss: 0.370, Test loss: 3.560, Test accuracy: 33.82
Round  97, Global train loss: 0.370, Global test loss: 2.162, Global test accuracy: 49.80
Round  98, Train loss: 0.299, Test loss: 3.506, Test accuracy: 34.82
Round  98, Global train loss: 0.299, Global test loss: 3.434, Global test accuracy: 31.80
Round  99, Train loss: 0.234, Test loss: 3.535, Test accuracy: 34.66
Round  99, Global train loss: 0.234, Global test loss: 3.092, Global test accuracy: 37.00
Final Round, Train loss: 0.266, Test loss: 3.915, Test accuracy: 33.76
Final Round, Global train loss: 0.266, Global test loss: 3.092, Global test accuracy: 37.00
Average accuracy final 10 rounds: 33.68 

Average global accuracy final 10 rounds: 36.440000000000005 

827.7211544513702
[1.6088569164276123, 3.2177138328552246, 4.466123580932617, 5.71453332901001, 6.99700140953064, 8.27946949005127, 9.551265001296997, 10.823060512542725, 12.131049156188965, 13.439037799835205, 14.771958351135254, 16.104878902435303, 17.414737462997437, 18.72459602355957, 20.068276166915894, 21.411956310272217, 22.922459840774536, 24.432963371276855, 25.741554260253906, 27.050145149230957, 28.37099266052246, 29.691840171813965, 30.958712816238403, 32.22558546066284, 33.53650760650635, 34.84742975234985, 36.13792896270752, 37.428428173065186, 38.679418087005615, 39.930408000946045, 41.22239542007446, 42.51438283920288, 43.78732943534851, 45.06027603149414, 46.323312282562256, 47.58634853363037, 48.88755655288696, 50.188764572143555, 51.563403606414795, 52.938042640686035, 54.23851656913757, 55.53899049758911, 56.811389684677124, 58.08378887176514, 59.36231064796448, 60.64083242416382, 62.025596380233765, 63.41036033630371, 64.71514344215393, 66.01992654800415, 67.30710077285767, 68.59427499771118, 69.92024445533752, 71.24621391296387, 72.60226345062256, 73.95831298828125, 75.18819737434387, 76.4180817604065, 77.7788918018341, 79.13970184326172, 80.46470832824707, 81.78971481323242, 83.09183716773987, 84.39395952224731, 85.65843033790588, 86.92290115356445, 88.258704662323, 89.59450817108154, 90.83557081222534, 92.07663345336914, 93.38907957077026, 94.70152568817139, 96.01281356811523, 97.32410144805908, 98.69644069671631, 100.06877994537354, 101.40581178665161, 102.74284362792969, 104.0698595046997, 105.39687538146973, 106.7828106880188, 108.16874599456787, 109.47637152671814, 110.78399705886841, 112.10060691833496, 113.41721677780151, 114.77292799949646, 116.1286392211914, 117.45954632759094, 118.79045343399048, 120.10216522216797, 121.41387701034546, 122.75356841087341, 124.09325981140137, 125.38699054718018, 126.68072128295898, 127.96258473396301, 129.24444818496704, 130.57002091407776, 131.89559364318848, 133.2099061012268, 134.52421855926514, 135.79280972480774, 137.06140089035034, 138.3355598449707, 139.60971879959106, 140.90124917030334, 142.19277954101562, 143.5329749584198, 144.87317037582397, 146.17412090301514, 147.4750714302063, 148.79295420646667, 150.11083698272705, 151.4526126384735, 152.79438829421997, 154.1557912826538, 155.51719427108765, 156.83948183059692, 158.1617693901062, 159.47635412216187, 160.79093885421753, 162.09490609169006, 163.3988733291626, 164.68070578575134, 165.9625382423401, 167.29141688346863, 168.62029552459717, 169.91283988952637, 171.20538425445557, 172.52383255958557, 173.84228086471558, 175.10411715507507, 176.36595344543457, 177.6503484249115, 178.93474340438843, 180.22203135490417, 181.50931930541992, 182.87058544158936, 184.2318515777588, 185.51818537712097, 186.80451917648315, 188.0759584903717, 189.34739780426025, 190.60408282279968, 191.8607678413391, 193.17007613182068, 194.47938442230225, 195.81356596946716, 197.14774751663208, 198.38716459274292, 199.62658166885376, 200.8582501411438, 202.08991861343384, 203.4224419593811, 204.75496530532837, 205.99504971504211, 207.23513412475586, 208.49239802360535, 209.74966192245483, 211.1016047000885, 212.45354747772217, 213.7864785194397, 215.11940956115723, 216.4009280204773, 217.68244647979736, 218.9859676361084, 220.28948879241943, 221.66326808929443, 223.03704738616943, 224.35162901878357, 225.6662106513977, 226.99037337303162, 228.31453609466553, 229.5968451499939, 230.87915420532227, 232.25622940063477, 233.63330459594727, 235.08852100372314, 236.54373741149902, 237.81122469902039, 239.07871198654175, 240.35045504570007, 241.6221981048584, 242.9570553302765, 244.29191255569458, 245.58169674873352, 246.87148094177246, 248.13353943824768, 249.3955979347229, 250.73530673980713, 252.07501554489136, 253.3358805179596, 254.59674549102783, 255.84036302566528, 257.08398056030273, 258.3553318977356, 259.62668323516846, 260.9077854156494, 262.18888759613037, 264.8287947177887, 267.468701839447]
[28.92, 28.92, 35.0, 35.0, 37.46, 37.46, 37.26, 37.26, 40.36, 40.36, 39.66, 39.66, 38.22, 38.22, 38.02, 38.02, 39.1, 39.1, 38.7, 38.7, 38.02, 38.02, 37.12, 37.12, 36.64, 36.64, 36.28, 36.28, 35.18, 35.18, 34.9, 34.9, 33.54, 33.54, 33.24, 33.24, 34.56, 34.56, 32.82, 32.82, 33.32, 33.32, 33.92, 33.92, 33.9, 33.9, 34.14, 34.14, 34.36, 34.36, 34.5, 34.5, 33.16, 33.16, 34.34, 34.34, 34.82, 34.82, 33.78, 33.78, 33.82, 33.82, 33.92, 33.92, 34.34, 34.34, 34.14, 34.14, 33.18, 33.18, 32.92, 32.92, 32.1, 32.1, 31.58, 31.58, 31.1, 31.1, 31.4, 31.4, 31.6, 31.6, 31.78, 31.78, 32.22, 32.22, 31.96, 31.96, 31.96, 31.96, 31.56, 31.56, 31.86, 31.86, 31.76, 31.76, 32.04, 32.04, 31.6, 31.6, 31.14, 31.14, 32.12, 32.12, 31.6, 31.6, 33.06, 33.06, 32.82, 32.82, 33.2, 33.2, 32.8, 32.8, 33.12, 33.12, 31.78, 31.78, 32.12, 32.12, 32.36, 32.36, 32.3, 32.3, 32.24, 32.24, 32.3, 32.3, 32.48, 32.48, 32.66, 32.66, 33.16, 33.16, 33.96, 33.96, 32.68, 32.68, 32.44, 32.44, 31.96, 31.96, 32.74, 32.74, 32.14, 32.14, 32.08, 32.08, 33.16, 33.16, 34.02, 34.02, 32.96, 32.96, 32.94, 32.94, 32.24, 32.24, 32.22, 32.22, 32.24, 32.24, 32.7, 32.7, 31.74, 31.74, 31.46, 31.46, 32.0, 32.0, 32.04, 32.04, 33.26, 33.26, 33.62, 33.62, 33.14, 33.14, 33.38, 33.38, 33.52, 33.52, 32.42, 32.42, 32.94, 32.94, 34.52, 34.52, 34.32, 34.32, 33.16, 33.16, 32.62, 32.62, 33.82, 33.82, 34.82, 34.82, 34.66, 34.66, 33.76, 33.76]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.562, Test loss: 1.571, Test accuracy: 28.14
Round   0, Global train loss: 1.562, Global test loss: 1.571, Global test accuracy: 29.00
Round   1, Train loss: 1.534, Test loss: 1.536, Test accuracy: 31.24
Round   1, Global train loss: 1.534, Global test loss: 1.510, Global test accuracy: 31.20
Round   2, Train loss: 1.584, Test loss: 1.543, Test accuracy: 35.66
Round   2, Global train loss: 1.584, Global test loss: 1.536, Global test accuracy: 41.00
Round   3, Train loss: 1.579, Test loss: 1.543, Test accuracy: 33.44
Round   3, Global train loss: 1.579, Global test loss: 1.533, Global test accuracy: 40.20
Round   4, Train loss: 1.505, Test loss: 1.526, Test accuracy: 33.78
Round   4, Global train loss: 1.505, Global test loss: 1.474, Global test accuracy: 40.60
Round   5, Train loss: 1.488, Test loss: 1.518, Test accuracy: 34.80
Round   5, Global train loss: 1.488, Global test loss: 1.466, Global test accuracy: 41.20
Round   6, Train loss: 1.461, Test loss: 1.525, Test accuracy: 34.16
Round   6, Global train loss: 1.461, Global test loss: 1.406, Global test accuracy: 42.60
Round   7, Train loss: 1.552, Test loss: 1.513, Test accuracy: 34.82
Round   7, Global train loss: 1.552, Global test loss: 1.482, Global test accuracy: 45.00
Round   8, Train loss: 1.557, Test loss: 1.498, Test accuracy: 37.38
Round   8, Global train loss: 1.557, Global test loss: 1.463, Global test accuracy: 45.00
Round   9, Train loss: 1.535, Test loss: 1.491, Test accuracy: 38.16
Round   9, Global train loss: 1.535, Global test loss: 1.480, Global test accuracy: 41.80
Round  10, Train loss: 1.539, Test loss: 1.479, Test accuracy: 39.24
Round  10, Global train loss: 1.539, Global test loss: 1.464, Global test accuracy: 46.60
Round  11, Train loss: 1.451, Test loss: 1.461, Test accuracy: 40.28
Round  11, Global train loss: 1.451, Global test loss: 1.383, Global test accuracy: 50.40
Round  12, Train loss: 1.491, Test loss: 1.445, Test accuracy: 41.50
Round  12, Global train loss: 1.491, Global test loss: 1.428, Global test accuracy: 38.80
Round  13, Train loss: 1.530, Test loss: 1.440, Test accuracy: 41.40
Round  13, Global train loss: 1.530, Global test loss: 1.449, Global test accuracy: 41.60
Round  14, Train loss: 1.464, Test loss: 1.437, Test accuracy: 41.30
Round  14, Global train loss: 1.464, Global test loss: 1.423, Global test accuracy: 40.20
Round  15, Train loss: 1.433, Test loss: 1.437, Test accuracy: 41.02
Round  15, Global train loss: 1.433, Global test loss: 1.369, Global test accuracy: 44.40
Round  16, Train loss: 1.504, Test loss: 1.441, Test accuracy: 40.88
Round  16, Global train loss: 1.504, Global test loss: 1.483, Global test accuracy: 37.20
Round  17, Train loss: 1.463, Test loss: 1.444, Test accuracy: 40.72
Round  17, Global train loss: 1.463, Global test loss: 1.397, Global test accuracy: 40.60
Round  18, Train loss: 1.431, Test loss: 1.443, Test accuracy: 40.94
Round  18, Global train loss: 1.431, Global test loss: 1.437, Global test accuracy: 39.40
Round  19, Train loss: 1.422, Test loss: 1.445, Test accuracy: 40.64
Round  19, Global train loss: 1.422, Global test loss: 1.316, Global test accuracy: 49.40
Round  20, Train loss: 1.388, Test loss: 1.436, Test accuracy: 40.54
Round  20, Global train loss: 1.388, Global test loss: 1.285, Global test accuracy: 47.20
Round  21, Train loss: 1.483, Test loss: 1.431, Test accuracy: 39.98
Round  21, Global train loss: 1.483, Global test loss: 1.420, Global test accuracy: 39.60
Round  22, Train loss: 1.443, Test loss: 1.427, Test accuracy: 39.44
Round  22, Global train loss: 1.443, Global test loss: 1.390, Global test accuracy: 43.20
Round  23, Train loss: 1.404, Test loss: 1.420, Test accuracy: 39.96
Round  23, Global train loss: 1.404, Global test loss: 1.446, Global test accuracy: 38.00
Round  24, Train loss: 1.408, Test loss: 1.428, Test accuracy: 38.62
Round  24, Global train loss: 1.408, Global test loss: 1.471, Global test accuracy: 35.00
Round  25, Train loss: 1.403, Test loss: 1.436, Test accuracy: 38.36
Round  25, Global train loss: 1.403, Global test loss: 1.415, Global test accuracy: 37.00
Round  26, Train loss: 1.361, Test loss: 1.440, Test accuracy: 38.72
Round  26, Global train loss: 1.361, Global test loss: 1.437, Global test accuracy: 35.60
Round  27, Train loss: 1.318, Test loss: 1.446, Test accuracy: 39.42
Round  27, Global train loss: 1.318, Global test loss: 1.327, Global test accuracy: 45.40
Round  28, Train loss: 1.353, Test loss: 1.475, Test accuracy: 38.42
Round  28, Global train loss: 1.353, Global test loss: 1.436, Global test accuracy: 35.20
Round  29, Train loss: 1.309, Test loss: 1.489, Test accuracy: 37.86
Round  29, Global train loss: 1.309, Global test loss: 1.245, Global test accuracy: 47.00
Round  30, Train loss: 1.306, Test loss: 1.498, Test accuracy: 37.32
Round  30, Global train loss: 1.306, Global test loss: 1.377, Global test accuracy: 39.40
Round  31, Train loss: 1.292, Test loss: 1.501, Test accuracy: 37.92
Round  31, Global train loss: 1.292, Global test loss: 1.300, Global test accuracy: 42.20
Round  32, Train loss: 1.364, Test loss: 1.491, Test accuracy: 37.56
Round  32, Global train loss: 1.364, Global test loss: 1.468, Global test accuracy: 36.00
Round  33, Train loss: 1.278, Test loss: 1.493, Test accuracy: 37.28
Round  33, Global train loss: 1.278, Global test loss: 1.422, Global test accuracy: 42.60
Round  34, Train loss: 1.265, Test loss: 1.495, Test accuracy: 37.20
Round  34, Global train loss: 1.265, Global test loss: 1.462, Global test accuracy: 39.00
Round  35, Train loss: 1.207, Test loss: 1.496, Test accuracy: 37.50
Round  35, Global train loss: 1.207, Global test loss: 1.367, Global test accuracy: 42.80
Round  36, Train loss: 1.134, Test loss: 1.550, Test accuracy: 36.52
Round  36, Global train loss: 1.134, Global test loss: 1.553, Global test accuracy: 32.00
Round  37, Train loss: 1.197, Test loss: 1.571, Test accuracy: 36.18
Round  37, Global train loss: 1.197, Global test loss: 1.523, Global test accuracy: 37.60
Round  38, Train loss: 1.106, Test loss: 1.595, Test accuracy: 36.02
Round  38, Global train loss: 1.106, Global test loss: 1.523, Global test accuracy: 38.00
Round  39, Train loss: 1.071, Test loss: 1.648, Test accuracy: 35.42
Round  39, Global train loss: 1.071, Global test loss: 1.696, Global test accuracy: 35.40
Round  40, Train loss: 1.083, Test loss: 1.674, Test accuracy: 35.02
Round  40, Global train loss: 1.083, Global test loss: 1.587, Global test accuracy: 37.60
Round  41, Train loss: 0.988, Test loss: 1.688, Test accuracy: 35.66
Round  41, Global train loss: 0.988, Global test loss: 1.619, Global test accuracy: 34.60
Round  42, Train loss: 1.100, Test loss: 1.661, Test accuracy: 36.44
Round  42, Global train loss: 1.100, Global test loss: 1.568, Global test accuracy: 40.00
Round  43, Train loss: 1.041, Test loss: 1.700, Test accuracy: 36.08
Round  43, Global train loss: 1.041, Global test loss: 1.482, Global test accuracy: 39.60
Round  44, Train loss: 0.973, Test loss: 1.760, Test accuracy: 35.68
Round  44, Global train loss: 0.973, Global test loss: 1.637, Global test accuracy: 36.00
Round  45, Train loss: 0.992, Test loss: 1.797, Test accuracy: 35.98
Round  45, Global train loss: 0.992, Global test loss: 1.761, Global test accuracy: 32.80
Round  46, Train loss: 0.890, Test loss: 1.848, Test accuracy: 34.70
Round  46, Global train loss: 0.890, Global test loss: 1.842, Global test accuracy: 33.40
Round  47, Train loss: 0.819, Test loss: 1.897, Test accuracy: 34.44
Round  47, Global train loss: 0.819, Global test loss: 1.869, Global test accuracy: 35.00
Round  48, Train loss: 0.979, Test loss: 1.941, Test accuracy: 34.20
Round  48, Global train loss: 0.979, Global test loss: 1.459, Global test accuracy: 41.40
Round  49, Train loss: 0.874, Test loss: 2.063, Test accuracy: 32.76
Round  49, Global train loss: 0.874, Global test loss: 2.112, Global test accuracy: 27.60
Round  50, Train loss: 0.905, Test loss: 2.035, Test accuracy: 32.84
Round  50, Global train loss: 0.905, Global test loss: 1.742, Global test accuracy: 37.60
Round  51, Train loss: 0.725, Test loss: 2.062, Test accuracy: 33.94
Round  51, Global train loss: 0.725, Global test loss: 1.946, Global test accuracy: 38.00
Round  52, Train loss: 0.879, Test loss: 2.035, Test accuracy: 34.78
Round  52, Global train loss: 0.879, Global test loss: 1.583, Global test accuracy: 42.80
Round  53, Train loss: 0.734, Test loss: 2.062, Test accuracy: 34.32
Round  53, Global train loss: 0.734, Global test loss: 1.639, Global test accuracy: 41.40
Round  54, Train loss: 0.648, Test loss: 2.145, Test accuracy: 34.90
Round  54, Global train loss: 0.648, Global test loss: 2.292, Global test accuracy: 32.00
Round  55, Train loss: 0.719, Test loss: 2.174, Test accuracy: 34.98
Round  55, Global train loss: 0.719, Global test loss: 1.798, Global test accuracy: 43.20
Round  56, Train loss: 0.596, Test loss: 2.291, Test accuracy: 33.94
Round  56, Global train loss: 0.596, Global test loss: 2.360, Global test accuracy: 32.40
Round  57, Train loss: 0.809, Test loss: 2.278, Test accuracy: 34.54
Round  57, Global train loss: 0.809, Global test loss: 1.582, Global test accuracy: 44.60
Round  58, Train loss: 0.655, Test loss: 2.338, Test accuracy: 33.88
Round  58, Global train loss: 0.655, Global test loss: 2.181, Global test accuracy: 33.00
Round  59, Train loss: 0.738, Test loss: 2.405, Test accuracy: 34.02
Round  59, Global train loss: 0.738, Global test loss: 2.185, Global test accuracy: 34.20
Round  60, Train loss: 0.649, Test loss: 2.513, Test accuracy: 34.26
Round  60, Global train loss: 0.649, Global test loss: 1.914, Global test accuracy: 39.60
Round  61, Train loss: 0.618, Test loss: 2.552, Test accuracy: 33.42
Round  61, Global train loss: 0.618, Global test loss: 1.888, Global test accuracy: 39.80
Round  62, Train loss: 0.589, Test loss: 2.601, Test accuracy: 33.56
Round  62, Global train loss: 0.589, Global test loss: 1.989, Global test accuracy: 41.20
Round  63, Train loss: 0.599, Test loss: 2.628, Test accuracy: 33.54
Round  63, Global train loss: 0.599, Global test loss: 2.373, Global test accuracy: 35.60
Round  64, Train loss: 0.568, Test loss: 2.630, Test accuracy: 33.28
Round  64, Global train loss: 0.568, Global test loss: 2.258, Global test accuracy: 36.00
Round  65, Train loss: 0.583, Test loss: 2.625, Test accuracy: 32.40
Round  65, Global train loss: 0.583, Global test loss: 2.483, Global test accuracy: 31.20
Round  66, Train loss: 0.661, Test loss: 2.673, Test accuracy: 32.08
Round  66, Global train loss: 0.661, Global test loss: 2.019, Global test accuracy: 39.20
Round  67, Train loss: 0.521, Test loss: 2.746, Test accuracy: 31.72
Round  67, Global train loss: 0.521, Global test loss: 2.517, Global test accuracy: 30.80
Round  68, Train loss: 0.534, Test loss: 2.759, Test accuracy: 31.70
Round  68, Global train loss: 0.534, Global test loss: 2.078, Global test accuracy: 40.20
Round  69, Train loss: 0.439, Test loss: 2.807, Test accuracy: 32.64
Round  69, Global train loss: 0.439, Global test loss: 2.547, Global test accuracy: 35.00
Round  70, Train loss: 0.479, Test loss: 2.838, Test accuracy: 33.22
Round  70, Global train loss: 0.479, Global test loss: 2.669, Global test accuracy: 31.20
Round  71, Train loss: 0.472, Test loss: 2.932, Test accuracy: 32.08
Round  71, Global train loss: 0.472, Global test loss: 2.663, Global test accuracy: 33.20
Round  72, Train loss: 0.483, Test loss: 2.880, Test accuracy: 33.62
Round  72, Global train loss: 0.483, Global test loss: 2.443, Global test accuracy: 33.20
Round  73, Train loss: 0.467, Test loss: 2.880, Test accuracy: 33.90
Round  73, Global train loss: 0.467, Global test loss: 2.205, Global test accuracy: 41.20
Round  74, Train loss: 0.503, Test loss: 2.875, Test accuracy: 34.08
Round  74, Global train loss: 0.503, Global test loss: 2.594, Global test accuracy: 29.60
Round  75, Train loss: 0.440, Test loss: 2.986, Test accuracy: 33.92
Round  75, Global train loss: 0.440, Global test loss: 2.582, Global test accuracy: 35.20
Round  76, Train loss: 0.403, Test loss: 3.061, Test accuracy: 32.88
Round  76, Global train loss: 0.403, Global test loss: 3.021, Global test accuracy: 29.00
Round  77, Train loss: 0.369, Test loss: 3.139, Test accuracy: 32.36
Round  77, Global train loss: 0.369, Global test loss: 2.688, Global test accuracy: 35.00
Round  78, Train loss: 0.383, Test loss: 3.147, Test accuracy: 32.00
Round  78, Global train loss: 0.383, Global test loss: 2.893, Global test accuracy: 32.40
Round  79, Train loss: 0.487, Test loss: 3.160, Test accuracy: 31.82
Round  79, Global train loss: 0.487, Global test loss: 2.282, Global test accuracy: 36.80
Round  80, Train loss: 0.410, Test loss: 3.119, Test accuracy: 33.00
Round  80, Global train loss: 0.410, Global test loss: 2.493, Global test accuracy: 38.00
Round  81, Train loss: 0.336, Test loss: 3.165, Test accuracy: 32.62
Round  81, Global train loss: 0.336, Global test loss: 2.899, Global test accuracy: 32.80
Round  82, Train loss: 0.309, Test loss: 3.151, Test accuracy: 33.02
Round  82, Global train loss: 0.309, Global test loss: 3.011, Global test accuracy: 32.40
Round  83, Train loss: 0.294, Test loss: 3.094, Test accuracy: 32.98
Round  83, Global train loss: 0.294, Global test loss: 3.156, Global test accuracy: 31.00
Round  84, Train loss: 0.405, Test loss: 3.192, Test accuracy: 32.74
Round  84, Global train loss: 0.405, Global test loss: 2.509, Global test accuracy: 38.80
Round  85, Train loss: 0.430, Test loss: 3.229, Test accuracy: 33.50
Round  85, Global train loss: 0.430, Global test loss: 2.418, Global test accuracy: 39.60
Round  86, Train loss: 0.370, Test loss: 3.316, Test accuracy: 33.16
Round  86, Global train loss: 0.370, Global test loss: 2.510, Global test accuracy: 38.00
Round  87, Train loss: 0.402, Test loss: 3.346, Test accuracy: 33.66
Round  87, Global train loss: 0.402, Global test loss: 2.331, Global test accuracy: 40.00
Round  88, Train loss: 0.321, Test loss: 3.499, Test accuracy: 32.10
Round  88, Global train loss: 0.321, Global test loss: 3.420, Global test accuracy: 28.00
Round  89, Train loss: 0.334, Test loss: 3.562, Test accuracy: 30.68
Round  89, Global train loss: 0.334, Global test loss: 2.689, Global test accuracy: 35.40
Round  90, Train loss: 0.336, Test loss: 3.463, Test accuracy: 31.68
Round  90, Global train loss: 0.336, Global test loss: 3.194, Global test accuracy: 30.40
Round  91, Train loss: 0.398, Test loss: 3.576, Test accuracy: 31.68
Round  91, Global train loss: 0.398, Global test loss: 2.755, Global test accuracy: 38.00
Round  92, Train loss: 0.380, Test loss: 3.554, Test accuracy: 32.06
Round  92, Global train loss: 0.380, Global test loss: 3.051, Global test accuracy: 36.20
Round  93, Train loss: 0.307, Test loss: 3.616, Test accuracy: 32.26
Round  93, Global train loss: 0.307, Global test loss: 3.056, Global test accuracy: 35.20
Round  94, Train loss: 0.268, Test loss: 3.598, Test accuracy: 32.62
Round  94, Global train loss: 0.268, Global test loss: 2.822, Global test accuracy: 40.00
Round  95, Train loss: 0.308, Test loss: 3.758, Test accuracy: 31.90
Round  95, Global train loss: 0.308, Global test loss: 3.341, Global test accuracy: 33.20
Round  96, Train loss: 0.254, Test loss: 3.746, Test accuracy: 32.52
Round  96, Global train loss: 0.254, Global test loss: 3.811, Global test accuracy: 30.40
Round  97, Train loss: 0.399, Test loss: 3.734, Test accuracy: 32.42
Round  97, Global train loss: 0.399, Global test loss: 2.558, Global test accuracy: 39.00
Round  98, Train loss: 0.267, Test loss: 3.709, Test accuracy: 32.48
Round  98, Global train loss: 0.267, Global test loss: 3.693, Global test accuracy: 29.80
Round  99, Train loss: 0.276, Test loss: 3.688, Test accuracy: 32.18
Round  99, Global train loss: 0.276, Global test loss: 3.253, Global test accuracy: 34.20
Final Round, Train loss: 0.257, Test loss: 3.830, Test accuracy: 32.84
Final Round, Global train loss: 0.257, Global test loss: 3.253, Global test accuracy: 34.20
Average accuracy final 10 rounds: 32.18000000000001
Average global accuracy final 10 rounds: 34.64
1180.2881398200989
[3.267765522003174, 6.143749237060547, 9.119893312454224, 11.954972982406616, 14.810062646865845, 17.629050731658936, 20.4442400932312, 23.364991903305054, 26.156457662582397, 28.981292247772217, 31.979522466659546, 34.84930157661438, 37.744917154312134, 40.62057709693909, 43.42678737640381, 46.24127650260925, 49.042975664138794, 51.85010600090027, 54.6238067150116, 57.41106343269348, 60.2688934803009, 63.13991189002991, 65.97207164764404, 68.83734393119812, 71.6392433643341, 74.51944088935852, 77.33328866958618, 80.19915747642517, 83.07713460922241, 85.90324330329895, 88.72180318832397, 91.71287798881531, 94.53998708724976, 97.38254261016846, 100.21757221221924, 102.98804879188538, 105.91949391365051, 108.9281861782074, 111.91559672355652, 114.7165470123291, 117.53415584564209, 120.49417877197266, 123.45284509658813, 126.44167470932007, 129.36339855194092, 132.3762719631195, 135.38343167304993, 138.23111009597778, 141.0875985622406, 144.01542949676514, 146.89573693275452, 149.8478147983551, 152.88623523712158, 155.79141807556152, 158.6889898777008, 161.5742893218994, 164.43988513946533, 167.29526352882385, 170.05955004692078, 172.83695006370544, 175.68592929840088, 178.48191165924072, 181.45131707191467, 184.56065106391907, 187.47736930847168, 190.3770763874054, 193.22930145263672, 196.12063789367676, 198.98868346214294, 201.85531401634216, 204.74449062347412, 207.61285591125488, 210.46895170211792, 213.49461579322815, 216.44973993301392, 219.32551956176758, 222.2149350643158, 225.13135409355164, 227.943190574646, 230.76799154281616, 233.70028638839722, 236.61013293266296, 239.48466992378235, 242.35177159309387, 245.39069628715515, 248.29791259765625, 251.2607705593109, 254.1229956150055, 257.08664298057556, 259.97672748565674, 262.90187668800354, 265.8254749774933, 268.82521748542786, 271.75975608825684, 274.7923743724823, 277.6821405887604, 280.5422933101654, 283.46207189559937, 286.4142391681671, 289.3412389755249, 294.3901069164276]
[28.14, 31.24, 35.66, 33.44, 33.78, 34.8, 34.16, 34.82, 37.38, 38.16, 39.24, 40.28, 41.5, 41.4, 41.3, 41.02, 40.88, 40.72, 40.94, 40.64, 40.54, 39.98, 39.44, 39.96, 38.62, 38.36, 38.72, 39.42, 38.42, 37.86, 37.32, 37.92, 37.56, 37.28, 37.2, 37.5, 36.52, 36.18, 36.02, 35.42, 35.02, 35.66, 36.44, 36.08, 35.68, 35.98, 34.7, 34.44, 34.2, 32.76, 32.84, 33.94, 34.78, 34.32, 34.9, 34.98, 33.94, 34.54, 33.88, 34.02, 34.26, 33.42, 33.56, 33.54, 33.28, 32.4, 32.08, 31.72, 31.7, 32.64, 33.22, 32.08, 33.62, 33.9, 34.08, 33.92, 32.88, 32.36, 32.0, 31.82, 33.0, 32.62, 33.02, 32.98, 32.74, 33.5, 33.16, 33.66, 32.1, 30.68, 31.68, 31.68, 32.06, 32.26, 32.62, 31.9, 32.52, 32.42, 32.48, 32.18, 32.84]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.609, Test loss: 1.581, Test accuracy: 26.18
Round   0, Global train loss: 1.609, Global test loss: 1.580, Global test accuracy: 23.00
Round   1, Train loss: 1.552, Test loss: 1.546, Test accuracy: 28.68
Round   1, Global train loss: 1.552, Global test loss: 1.543, Global test accuracy: 25.80
Round   2, Train loss: 1.578, Test loss: 1.542, Test accuracy: 36.20
Round   2, Global train loss: 1.578, Global test loss: 1.537, Global test accuracy: 42.20
Round   3, Train loss: 1.600, Test loss: 1.551, Test accuracy: 33.46
Round   3, Global train loss: 1.600, Global test loss: 1.547, Global test accuracy: 39.20
Round   4, Train loss: 1.555, Test loss: 1.491, Test accuracy: 35.86
Round   4, Global train loss: 1.555, Global test loss: 1.474, Global test accuracy: 37.40
Round   5, Train loss: 1.520, Test loss: 1.496, Test accuracy: 37.82
Round   5, Global train loss: 1.520, Global test loss: 1.487, Global test accuracy: 37.00
Round   6, Train loss: 1.523, Test loss: 1.488, Test accuracy: 39.28
Round   6, Global train loss: 1.523, Global test loss: 1.461, Global test accuracy: 34.20
Round   7, Train loss: 1.571, Test loss: 1.524, Test accuracy: 35.78
Round   7, Global train loss: 1.571, Global test loss: 1.524, Global test accuracy: 40.00
Round   8, Train loss: 1.590, Test loss: 1.522, Test accuracy: 35.56
Round   8, Global train loss: 1.590, Global test loss: 1.517, Global test accuracy: 45.40
Round   9, Train loss: 1.565, Test loss: 1.542, Test accuracy: 32.64
Round   9, Global train loss: 1.565, Global test loss: 1.544, Global test accuracy: 44.60
Round  10, Train loss: 1.592, Test loss: 1.526, Test accuracy: 34.52
Round  10, Global train loss: 1.592, Global test loss: 1.515, Global test accuracy: 43.80
Round  11, Train loss: 1.530, Test loss: 1.463, Test accuracy: 39.22
Round  11, Global train loss: 1.530, Global test loss: 1.406, Global test accuracy: 41.00
Round  12, Train loss: 1.531, Test loss: 1.494, Test accuracy: 38.18
Round  12, Global train loss: 1.531, Global test loss: 1.512, Global test accuracy: 36.60
Round  13, Train loss: 1.586, Test loss: 1.506, Test accuracy: 37.72
Round  13, Global train loss: 1.586, Global test loss: 1.504, Global test accuracy: 44.00
Round  14, Train loss: 1.522, Test loss: 1.492, Test accuracy: 39.26
Round  14, Global train loss: 1.522, Global test loss: 1.492, Global test accuracy: 36.40
Round  15, Train loss: 1.526, Test loss: 1.478, Test accuracy: 39.38
Round  15, Global train loss: 1.526, Global test loss: 1.435, Global test accuracy: 42.20
Round  16, Train loss: 1.547, Test loss: 1.504, Test accuracy: 35.02
Round  16, Global train loss: 1.547, Global test loss: 1.507, Global test accuracy: 40.80
Round  17, Train loss: 1.544, Test loss: 1.501, Test accuracy: 37.74
Round  17, Global train loss: 1.544, Global test loss: 1.482, Global test accuracy: 48.20
Round  18, Train loss: 1.541, Test loss: 1.503, Test accuracy: 37.82
Round  18, Global train loss: 1.541, Global test loss: 1.491, Global test accuracy: 45.20
Round  19, Train loss: 1.481, Test loss: 1.464, Test accuracy: 41.48
Round  19, Global train loss: 1.481, Global test loss: 1.400, Global test accuracy: 45.80
Round  20, Train loss: 1.496, Test loss: 1.436, Test accuracy: 43.50
Round  20, Global train loss: 1.496, Global test loss: 1.355, Global test accuracy: 49.60
Round  21, Train loss: 1.569, Test loss: 1.481, Test accuracy: 39.56
Round  21, Global train loss: 1.569, Global test loss: 1.488, Global test accuracy: 42.00
Round  22, Train loss: 1.557, Test loss: 1.475, Test accuracy: 38.06
Round  22, Global train loss: 1.557, Global test loss: 1.452, Global test accuracy: 43.60
Round  23, Train loss: 1.530, Test loss: 1.507, Test accuracy: 36.18
Round  23, Global train loss: 1.530, Global test loss: 1.519, Global test accuracy: 42.60
Round  24, Train loss: 1.524, Test loss: 1.502, Test accuracy: 35.62
Round  24, Global train loss: 1.524, Global test loss: 1.494, Global test accuracy: 43.00
Round  25, Train loss: 1.550, Test loss: 1.498, Test accuracy: 37.00
Round  25, Global train loss: 1.550, Global test loss: 1.485, Global test accuracy: 39.60
Round  26, Train loss: 1.512, Test loss: 1.476, Test accuracy: 39.10
Round  26, Global train loss: 1.512, Global test loss: 1.469, Global test accuracy: 46.20
Round  27, Train loss: 1.492, Test loss: 1.459, Test accuracy: 41.16
Round  27, Global train loss: 1.492, Global test loss: 1.387, Global test accuracy: 46.20
Round  28, Train loss: 1.503, Test loss: 1.457, Test accuracy: 40.78
Round  28, Global train loss: 1.503, Global test loss: 1.431, Global test accuracy: 48.00
Round  29, Train loss: 1.470, Test loss: 1.439, Test accuracy: 42.62
Round  29, Global train loss: 1.470, Global test loss: 1.349, Global test accuracy: 47.40
Round  30, Train loss: 1.493, Test loss: 1.431, Test accuracy: 42.66
Round  30, Global train loss: 1.493, Global test loss: 1.377, Global test accuracy: 48.80
Round  31, Train loss: 1.434, Test loss: 1.449, Test accuracy: 41.88
Round  31, Global train loss: 1.434, Global test loss: 1.380, Global test accuracy: 45.80
Round  32, Train loss: 1.530, Test loss: 1.478, Test accuracy: 39.30
Round  32, Global train loss: 1.530, Global test loss: 1.490, Global test accuracy: 40.80
Round  33, Train loss: 1.515, Test loss: 1.464, Test accuracy: 40.52
Round  33, Global train loss: 1.515, Global test loss: 1.437, Global test accuracy: 44.80
Round  34, Train loss: 1.516, Test loss: 1.502, Test accuracy: 36.38
Round  34, Global train loss: 1.516, Global test loss: 1.510, Global test accuracy: 36.60
Round  35, Train loss: 1.476, Test loss: 1.461, Test accuracy: 39.56
Round  35, Global train loss: 1.476, Global test loss: 1.446, Global test accuracy: 45.20
Round  36, Train loss: 1.450, Test loss: 1.489, Test accuracy: 35.94
Round  36, Global train loss: 1.450, Global test loss: 1.494, Global test accuracy: 38.00
Round  37, Train loss: 1.498, Test loss: 1.460, Test accuracy: 38.94
Round  37, Global train loss: 1.498, Global test loss: 1.435, Global test accuracy: 43.60
Round  38, Train loss: 1.468, Test loss: 1.484, Test accuracy: 36.08
Round  38, Global train loss: 1.468, Global test loss: 1.466, Global test accuracy: 41.20
Round  39, Train loss: 1.471, Test loss: 1.472, Test accuracy: 38.56
Round  39, Global train loss: 1.471, Global test loss: 1.464, Global test accuracy: 41.00
Round  40, Train loss: 1.457, Test loss: 1.465, Test accuracy: 37.74
Round  40, Global train loss: 1.457, Global test loss: 1.447, Global test accuracy: 42.80
Round  41, Train loss: 1.422, Test loss: 1.503, Test accuracy: 34.52
Round  41, Global train loss: 1.422, Global test loss: 1.484, Global test accuracy: 37.80
Round  42, Train loss: 1.458, Test loss: 1.463, Test accuracy: 37.24
Round  42, Global train loss: 1.458, Global test loss: 1.422, Global test accuracy: 40.80
Round  43, Train loss: 1.411, Test loss: 1.445, Test accuracy: 38.60
Round  43, Global train loss: 1.411, Global test loss: 1.381, Global test accuracy: 44.40
Round  44, Train loss: 1.403, Test loss: 1.459, Test accuracy: 37.20
Round  44, Global train loss: 1.403, Global test loss: 1.435, Global test accuracy: 41.00
Round  45, Train loss: 1.401, Test loss: 1.517, Test accuracy: 34.82
Round  45, Global train loss: 1.401, Global test loss: 1.544, Global test accuracy: 34.60
Round  46, Train loss: 1.400, Test loss: 1.515, Test accuracy: 33.94
Round  46, Global train loss: 1.400, Global test loss: 1.506, Global test accuracy: 36.40
Round  47, Train loss: 1.354, Test loss: 1.535, Test accuracy: 31.58
Round  47, Global train loss: 1.354, Global test loss: 1.515, Global test accuracy: 31.60
Round  48, Train loss: 1.394, Test loss: 1.449, Test accuracy: 37.50
Round  48, Global train loss: 1.394, Global test loss: 1.344, Global test accuracy: 43.40
Round  49, Train loss: 1.357, Test loss: 1.553, Test accuracy: 32.38
Round  49, Global train loss: 1.357, Global test loss: 1.575, Global test accuracy: 32.00
Round  50, Train loss: 1.354, Test loss: 1.500, Test accuracy: 35.34
Round  50, Global train loss: 1.354, Global test loss: 1.480, Global test accuracy: 36.00
Round  51, Train loss: 1.305, Test loss: 1.519, Test accuracy: 34.72
Round  51, Global train loss: 1.305, Global test loss: 1.501, Global test accuracy: 35.60
Round  52, Train loss: 1.348, Test loss: 1.469, Test accuracy: 37.92
Round  52, Global train loss: 1.348, Global test loss: 1.368, Global test accuracy: 45.80
Round  53, Train loss: 1.286, Test loss: 1.449, Test accuracy: 36.84
Round  53, Global train loss: 1.286, Global test loss: 1.345, Global test accuracy: 40.00
Round  54, Train loss: 1.294, Test loss: 1.612, Test accuracy: 29.08
Round  54, Global train loss: 1.294, Global test loss: 1.650, Global test accuracy: 29.00
Round  55, Train loss: 1.238, Test loss: 1.480, Test accuracy: 36.94
Round  55, Global train loss: 1.238, Global test loss: 1.402, Global test accuracy: 38.00
Round  56, Train loss: 1.199, Test loss: 1.553, Test accuracy: 31.68
Round  56, Global train loss: 1.199, Global test loss: 1.548, Global test accuracy: 33.60
Round  57, Train loss: 1.301, Test loss: 1.475, Test accuracy: 35.12
Round  57, Global train loss: 1.301, Global test loss: 1.349, Global test accuracy: 39.20
Round  58, Train loss: 1.263, Test loss: 1.542, Test accuracy: 31.26
Round  58, Global train loss: 1.263, Global test loss: 1.517, Global test accuracy: 33.40
Round  59, Train loss: 1.254, Test loss: 1.547, Test accuracy: 33.32
Round  59, Global train loss: 1.254, Global test loss: 1.528, Global test accuracy: 33.40
Round  60, Train loss: 1.199, Test loss: 1.552, Test accuracy: 34.42
Round  60, Global train loss: 1.199, Global test loss: 1.449, Global test accuracy: 33.80
Round  61, Train loss: 1.195, Test loss: 1.505, Test accuracy: 36.48
Round  61, Global train loss: 1.195, Global test loss: 1.388, Global test accuracy: 40.20
Round  62, Train loss: 1.171, Test loss: 1.502, Test accuracy: 37.04
Round  62, Global train loss: 1.171, Global test loss: 1.386, Global test accuracy: 39.00
Round  63, Train loss: 1.164, Test loss: 1.588, Test accuracy: 32.52
Round  63, Global train loss: 1.164, Global test loss: 1.569, Global test accuracy: 34.20
Round  64, Train loss: 1.122, Test loss: 1.555, Test accuracy: 35.24
Round  64, Global train loss: 1.122, Global test loss: 1.445, Global test accuracy: 42.20
Round  65, Train loss: 1.142, Test loss: 1.591, Test accuracy: 35.34
Round  65, Global train loss: 1.142, Global test loss: 1.596, Global test accuracy: 36.80
Round  66, Train loss: 1.161, Test loss: 1.516, Test accuracy: 37.00
Round  66, Global train loss: 1.161, Global test loss: 1.412, Global test accuracy: 38.20
Round  67, Train loss: 1.088, Test loss: 1.668, Test accuracy: 32.18
Round  67, Global train loss: 1.088, Global test loss: 1.700, Global test accuracy: 33.00
Round  68, Train loss: 1.094, Test loss: 1.585, Test accuracy: 35.30
Round  68, Global train loss: 1.094, Global test loss: 1.453, Global test accuracy: 37.00
Round  69, Train loss: 1.046, Test loss: 1.642, Test accuracy: 30.80
Round  69, Global train loss: 1.046, Global test loss: 1.646, Global test accuracy: 30.20
Round  70, Train loss: 1.007, Test loss: 1.647, Test accuracy: 32.46
Round  70, Global train loss: 1.007, Global test loss: 1.666, Global test accuracy: 31.40
Round  71, Train loss: 1.030, Test loss: 1.624, Test accuracy: 33.72
Round  71, Global train loss: 1.030, Global test loss: 1.566, Global test accuracy: 35.80
Round  72, Train loss: 0.983, Test loss: 1.698, Test accuracy: 31.40
Round  72, Global train loss: 0.983, Global test loss: 1.691, Global test accuracy: 29.20
Round  73, Train loss: 0.968, Test loss: 1.677, Test accuracy: 32.16
Round  73, Global train loss: 0.968, Global test loss: 1.520, Global test accuracy: 33.80
Round  74, Train loss: 1.018, Test loss: 1.794, Test accuracy: 30.08
Round  74, Global train loss: 1.018, Global test loss: 1.745, Global test accuracy: 29.60
Round  75, Train loss: 0.930, Test loss: 1.683, Test accuracy: 33.78
Round  75, Global train loss: 0.930, Global test loss: 1.590, Global test accuracy: 34.80
Round  76, Train loss: 0.915, Test loss: 1.759, Test accuracy: 30.66
Round  76, Global train loss: 0.915, Global test loss: 1.807, Global test accuracy: 31.00
Round  77, Train loss: 0.855, Test loss: 1.729, Test accuracy: 33.56
Round  77, Global train loss: 0.855, Global test loss: 1.675, Global test accuracy: 35.40
Round  78, Train loss: 0.914, Test loss: 1.778, Test accuracy: 30.38
Round  78, Global train loss: 0.914, Global test loss: 1.770, Global test accuracy: 29.60
Round  79, Train loss: 0.911, Test loss: 1.789, Test accuracy: 31.90
Round  79, Global train loss: 0.911, Global test loss: 1.630, Global test accuracy: 33.80
Round  80, Train loss: 0.896, Test loss: 1.802, Test accuracy: 28.14
Round  80, Global train loss: 0.896, Global test loss: 1.754, Global test accuracy: 28.60
Round  81, Train loss: 0.825, Test loss: 1.930, Test accuracy: 26.84
Round  81, Global train loss: 0.825, Global test loss: 1.963, Global test accuracy: 24.80
Round  82, Train loss: 0.770, Test loss: 1.891, Test accuracy: 27.82
Round  82, Global train loss: 0.770, Global test loss: 1.983, Global test accuracy: 27.20
Round  83, Train loss: 0.745, Test loss: 1.969, Test accuracy: 28.32
Round  83, Global train loss: 0.745, Global test loss: 2.060, Global test accuracy: 28.40
Round  84, Train loss: 0.829, Test loss: 1.828, Test accuracy: 33.92
Round  84, Global train loss: 0.829, Global test loss: 1.676, Global test accuracy: 36.00
Round  85, Train loss: 0.848, Test loss: 1.805, Test accuracy: 33.66
Round  85, Global train loss: 0.848, Global test loss: 1.641, Global test accuracy: 35.20
Round  86, Train loss: 0.809, Test loss: 1.909, Test accuracy: 33.22
Round  86, Global train loss: 0.809, Global test loss: 1.720, Global test accuracy: 34.40
Round  87, Train loss: 0.847, Test loss: 1.778, Test accuracy: 34.42
Round  87, Global train loss: 0.847, Global test loss: 1.570, Global test accuracy: 36.20
Round  88, Train loss: 0.729, Test loss: 2.137, Test accuracy: 26.88
Round  88, Global train loss: 0.729, Global test loss: 2.235, Global test accuracy: 24.60
Round  89, Train loss: 0.778, Test loss: 1.996, Test accuracy: 31.18
Round  89, Global train loss: 0.778, Global test loss: 1.797, Global test accuracy: 33.80
Round  90, Train loss: 0.688, Test loss: 2.115, Test accuracy: 28.88
Round  90, Global train loss: 0.688, Global test loss: 2.220, Global test accuracy: 27.20
Round  91, Train loss: 0.838, Test loss: 1.856, Test accuracy: 33.74
Round  91, Global train loss: 0.838, Global test loss: 1.581, Global test accuracy: 37.00
Round  92, Train loss: 0.755, Test loss: 2.049, Test accuracy: 30.64
Round  92, Global train loss: 0.755, Global test loss: 1.939, Global test accuracy: 30.80
Round  93, Train loss: 0.677, Test loss: 1.916, Test accuracy: 33.04
Round  93, Global train loss: 0.677, Global test loss: 1.892, Global test accuracy: 32.20
Round  94, Train loss: 0.650, Test loss: 1.933, Test accuracy: 32.90
Round  94, Global train loss: 0.650, Global test loss: 1.826, Global test accuracy: 33.60
Round  95, Train loss: 0.636, Test loss: 2.159, Test accuracy: 31.26
Round  95, Global train loss: 0.636, Global test loss: 2.234, Global test accuracy: 30.80
Round  96, Train loss: 0.555, Test loss: 2.041, Test accuracy: 31.86
Round  96, Global train loss: 0.555, Global test loss: 2.106, Global test accuracy: 33.00
Round  97, Train loss: 0.835, Test loss: 2.023, Test accuracy: 32.56
Round  97, Global train loss: 0.835, Global test loss: 1.744, Global test accuracy: 34.20
Round  98, Train loss: 0.617, Test loss: 2.199, Test accuracy: 27.18
Round  98, Global train loss: 0.617, Global test loss: 2.351, Global test accuracy: 26.60
Round  99, Train loss: 0.633, Test loss: 2.230, Test accuracy: 29.04
Round  99, Global train loss: 0.633, Global test loss: 2.183, Global test accuracy: 28.40
Final Round, Train loss: 0.554, Test loss: 2.323, Test accuracy: 29.56
Final Round, Global train loss: 0.554, Global test loss: 2.183, Global test accuracy: 28.40
Average accuracy final 10 rounds: 31.110000000000003
710.2640478610992
[1.666100025177002, 3.0511159896850586, 4.459341526031494, 5.858674764633179, 7.2465221881866455, 8.657079219818115, 10.10912299156189, 11.659644603729248, 13.062047958374023, 14.4688081741333, 15.891631364822388, 17.285775899887085, 18.66778826713562, 20.040973663330078, 21.416497468948364, 22.84580898284912, 24.226546049118042, 25.630855321884155, 27.013094663619995, 28.383728742599487, 29.75424337387085, 31.177101135253906, 32.59032201766968, 34.005664348602295, 35.42301344871521, 36.81976270675659, 38.27314066886902, 39.62712550163269, 41.026390075683594, 42.43402624130249, 43.83505582809448, 45.288394927978516, 46.67435312271118, 48.09945821762085, 49.5036199092865, 50.84367275238037, 52.263059854507446, 53.63334894180298, 55.03559327125549, 56.427051067352295, 57.821160554885864, 59.205190658569336, 60.627540588378906, 62.0166494846344, 63.3533890247345, 64.73371720314026, 66.21357893943787, 67.55832934379578, 68.95122265815735, 70.34907865524292, 71.71574306488037, 73.18256998062134, 74.5275890827179, 75.89699006080627, 77.31789088249207, 78.72337031364441, 80.07194352149963, 81.46860265731812, 82.81520962715149, 84.13997077941895, 85.47941470146179, 86.80715537071228, 88.15166664123535, 89.49950695037842, 90.8339216709137, 92.15060567855835, 93.4755449295044, 94.84952116012573, 96.1816999912262, 97.66436457633972, 99.0741069316864, 100.50319004058838, 101.87062621116638, 103.2291829586029, 104.64452171325684, 106.03261804580688, 107.41025280952454, 108.79636430740356, 110.21892285346985, 111.5869243144989, 112.97761559486389, 114.38114666938782, 115.76650834083557, 117.16308450698853, 118.55493235588074, 119.93921637535095, 121.42048692703247, 122.81463360786438, 124.1988754272461, 125.58993816375732, 126.9615433216095, 128.3166675567627, 129.7146816253662, 131.10627222061157, 132.46130466461182, 133.96327328681946, 135.42701125144958, 136.80848240852356, 138.19163608551025, 139.5859408378601, 141.78636646270752]
[26.18, 28.68, 36.2, 33.46, 35.86, 37.82, 39.28, 35.78, 35.56, 32.64, 34.52, 39.22, 38.18, 37.72, 39.26, 39.38, 35.02, 37.74, 37.82, 41.48, 43.5, 39.56, 38.06, 36.18, 35.62, 37.0, 39.1, 41.16, 40.78, 42.62, 42.66, 41.88, 39.3, 40.52, 36.38, 39.56, 35.94, 38.94, 36.08, 38.56, 37.74, 34.52, 37.24, 38.6, 37.2, 34.82, 33.94, 31.58, 37.5, 32.38, 35.34, 34.72, 37.92, 36.84, 29.08, 36.94, 31.68, 35.12, 31.26, 33.32, 34.42, 36.48, 37.04, 32.52, 35.24, 35.34, 37.0, 32.18, 35.3, 30.8, 32.46, 33.72, 31.4, 32.16, 30.08, 33.78, 30.66, 33.56, 30.38, 31.9, 28.14, 26.84, 27.82, 28.32, 33.92, 33.66, 33.22, 34.42, 26.88, 31.18, 28.88, 33.74, 30.64, 33.04, 32.9, 31.26, 31.86, 32.56, 27.18, 29.04, 29.56]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.596, Test loss: 1.583, Test accuracy: 32.08
Round   0, Global train loss: 1.596, Global test loss: 1.577, Global test accuracy: 40.00
Round   1, Train loss: 1.555, Test loss: 1.553, Test accuracy: 32.26
Round   1, Global train loss: 1.555, Global test loss: 1.536, Global test accuracy: 41.20
Round   2, Train loss: 1.538, Test loss: 1.527, Test accuracy: 34.56
Round   2, Global train loss: 1.538, Global test loss: 1.498, Global test accuracy: 41.40
Round   3, Train loss: 1.526, Test loss: 1.520, Test accuracy: 34.38
Round   3, Global train loss: 1.526, Global test loss: 1.487, Global test accuracy: 44.60
Round   4, Train loss: 1.520, Test loss: 1.514, Test accuracy: 33.02
Round   4, Global train loss: 1.520, Global test loss: 1.476, Global test accuracy: 45.20
Round   5, Train loss: 1.511, Test loss: 1.514, Test accuracy: 32.62
Round   5, Global train loss: 1.511, Global test loss: 1.474, Global test accuracy: 46.80
Round   6, Train loss: 1.504, Test loss: 1.494, Test accuracy: 33.92
Round   6, Global train loss: 1.504, Global test loss: 1.441, Global test accuracy: 47.20
Round   7, Train loss: 1.491, Test loss: 1.491, Test accuracy: 32.98
Round   7, Global train loss: 1.491, Global test loss: 1.434, Global test accuracy: 47.60
Round   8, Train loss: 1.482, Test loss: 1.481, Test accuracy: 33.02
Round   8, Global train loss: 1.482, Global test loss: 1.415, Global test accuracy: 47.60
Round   9, Train loss: 1.474, Test loss: 1.480, Test accuracy: 32.80
Round   9, Global train loss: 1.474, Global test loss: 1.402, Global test accuracy: 49.40
Round  10, Train loss: 1.466, Test loss: 1.489, Test accuracy: 32.12
Round  10, Global train loss: 1.466, Global test loss: 1.413, Global test accuracy: 51.60
Round  11, Train loss: 1.285, Test loss: 1.446, Test accuracy: 34.08
Round  11, Global train loss: 1.285, Global test loss: 1.160, Global test accuracy: 50.40
Round  12, Train loss: 1.432, Test loss: 1.555, Test accuracy: 28.68
Round  12, Global train loss: 1.432, Global test loss: 1.667, Global test accuracy: 20.60
Round  13, Train loss: 1.446, Test loss: 1.671, Test accuracy: 26.32
Round  13, Global train loss: 1.446, Global test loss: 1.681, Global test accuracy: 23.40
Round  14, Train loss: 1.432, Test loss: 1.593, Test accuracy: 27.62
Round  14, Global train loss: 1.432, Global test loss: 1.647, Global test accuracy: 21.40
Round  15, Train loss: 1.352, Test loss: 1.571, Test accuracy: 28.76
Round  15, Global train loss: 1.352, Global test loss: 1.407, Global test accuracy: 49.60
Round  16, Train loss: 1.428, Test loss: 1.632, Test accuracy: 26.16
Round  16, Global train loss: 1.428, Global test loss: 1.668, Global test accuracy: 23.40
Round  17, Train loss: 1.402, Test loss: 1.504, Test accuracy: 31.14
Round  17, Global train loss: 1.402, Global test loss: 1.398, Global test accuracy: 49.40
Round  18, Train loss: 1.431, Test loss: 1.566, Test accuracy: 29.40
Round  18, Global train loss: 1.431, Global test loss: 1.662, Global test accuracy: 23.00
Round  19, Train loss: 1.264, Test loss: 1.448, Test accuracy: 34.82
Round  19, Global train loss: 1.264, Global test loss: 1.147, Global test accuracy: 54.80
Round  20, Train loss: 1.225, Test loss: 1.436, Test accuracy: 35.78
Round  20, Global train loss: 1.225, Global test loss: 1.129, Global test accuracy: 55.00
Round  21, Train loss: 1.360, Test loss: 1.509, Test accuracy: 30.10
Round  21, Global train loss: 1.360, Global test loss: 1.387, Global test accuracy: 38.20
Round  22, Train loss: 1.347, Test loss: 1.527, Test accuracy: 29.88
Round  22, Global train loss: 1.347, Global test loss: 1.344, Global test accuracy: 44.20
Round  23, Train loss: 1.371, Test loss: 1.586, Test accuracy: 27.80
Round  23, Global train loss: 1.371, Global test loss: 1.743, Global test accuracy: 19.20
Round  24, Train loss: 1.394, Test loss: 1.626, Test accuracy: 25.26
Round  24, Global train loss: 1.394, Global test loss: 1.694, Global test accuracy: 20.40
Round  25, Train loss: 1.383, Test loss: 1.577, Test accuracy: 27.66
Round  25, Global train loss: 1.383, Global test loss: 1.437, Global test accuracy: 40.80
Round  26, Train loss: 1.435, Test loss: 1.614, Test accuracy: 25.80
Round  26, Global train loss: 1.435, Global test loss: 1.687, Global test accuracy: 21.40
Round  27, Train loss: 1.332, Test loss: 1.518, Test accuracy: 30.68
Round  27, Global train loss: 1.332, Global test loss: 1.293, Global test accuracy: 53.80
Round  28, Train loss: 1.342, Test loss: 1.495, Test accuracy: 32.78
Round  28, Global train loss: 1.342, Global test loss: 1.321, Global test accuracy: 54.40
Round  29, Train loss: 1.195, Test loss: 1.457, Test accuracy: 36.06
Round  29, Global train loss: 1.195, Global test loss: 1.089, Global test accuracy: 53.60
Round  30, Train loss: 1.332, Test loss: 1.498, Test accuracy: 30.58
Round  30, Global train loss: 1.332, Global test loss: 1.289, Global test accuracy: 51.80
Round  31, Train loss: 1.263, Test loss: 1.522, Test accuracy: 29.56
Round  31, Global train loss: 1.263, Global test loss: 1.268, Global test accuracy: 54.20
Round  32, Train loss: 1.311, Test loss: 1.558, Test accuracy: 25.86
Round  32, Global train loss: 1.311, Global test loss: 1.425, Global test accuracy: 46.00
Round  33, Train loss: 1.288, Test loss: 1.529, Test accuracy: 29.02
Round  33, Global train loss: 1.288, Global test loss: 1.300, Global test accuracy: 51.20
Round  34, Train loss: 1.295, Test loss: 1.508, Test accuracy: 31.48
Round  34, Global train loss: 1.295, Global test loss: 1.353, Global test accuracy: 46.40
Round  35, Train loss: 1.317, Test loss: 1.516, Test accuracy: 29.80
Round  35, Global train loss: 1.317, Global test loss: 1.330, Global test accuracy: 47.00
Round  36, Train loss: 1.365, Test loss: 1.590, Test accuracy: 27.44
Round  36, Global train loss: 1.365, Global test loss: 1.736, Global test accuracy: 23.20
Round  37, Train loss: 1.285, Test loss: 1.536, Test accuracy: 28.72
Round  37, Global train loss: 1.285, Global test loss: 1.292, Global test accuracy: 49.40
Round  38, Train loss: 1.271, Test loss: 1.562, Test accuracy: 27.84
Round  38, Global train loss: 1.271, Global test loss: 1.309, Global test accuracy: 44.20
Round  39, Train loss: 1.291, Test loss: 1.568, Test accuracy: 26.84
Round  39, Global train loss: 1.291, Global test loss: 1.381, Global test accuracy: 43.60
Round  40, Train loss: 1.186, Test loss: 1.524, Test accuracy: 30.16
Round  40, Global train loss: 1.186, Global test loss: 1.207, Global test accuracy: 47.80
Round  41, Train loss: 1.339, Test loss: 1.604, Test accuracy: 26.60
Round  41, Global train loss: 1.339, Global test loss: 1.689, Global test accuracy: 23.60
Round  42, Train loss: 1.194, Test loss: 1.511, Test accuracy: 30.48
Round  42, Global train loss: 1.194, Global test loss: 1.155, Global test accuracy: 49.20
Round  43, Train loss: 1.124, Test loss: 1.500, Test accuracy: 32.66
Round  43, Global train loss: 1.124, Global test loss: 1.068, Global test accuracy: 55.20
Round  44, Train loss: 1.241, Test loss: 1.507, Test accuracy: 30.10
Round  44, Global train loss: 1.241, Global test loss: 1.250, Global test accuracy: 49.60
Round  45, Train loss: 1.232, Test loss: 1.527, Test accuracy: 29.60
Round  45, Global train loss: 1.232, Global test loss: 1.374, Global test accuracy: 43.60
Round  46, Train loss: 1.222, Test loss: 1.537, Test accuracy: 27.80
Round  46, Global train loss: 1.222, Global test loss: 1.300, Global test accuracy: 43.80
Round  47, Train loss: 1.226, Test loss: 1.521, Test accuracy: 28.82
Round  47, Global train loss: 1.226, Global test loss: 1.336, Global test accuracy: 42.40
Round  48, Train loss: 1.096, Test loss: 1.472, Test accuracy: 33.60
Round  48, Global train loss: 1.096, Global test loss: 1.012, Global test accuracy: 57.40
Round  49, Train loss: 1.274, Test loss: 1.551, Test accuracy: 29.70
Round  49, Global train loss: 1.274, Global test loss: 1.767, Global test accuracy: 19.40
Round  50, Train loss: 1.127, Test loss: 1.493, Test accuracy: 32.48
Round  50, Global train loss: 1.127, Global test loss: 1.140, Global test accuracy: 47.60
Round  51, Train loss: 1.283, Test loss: 1.549, Test accuracy: 29.06
Round  51, Global train loss: 1.283, Global test loss: 1.659, Global test accuracy: 23.00
Round  52, Train loss: 1.100, Test loss: 1.514, Test accuracy: 31.50
Round  52, Global train loss: 1.100, Global test loss: 1.112, Global test accuracy: 55.00
Round  53, Train loss: 1.023, Test loss: 1.471, Test accuracy: 33.62
Round  53, Global train loss: 1.023, Global test loss: 1.054, Global test accuracy: 55.00
Round  54, Train loss: 1.216, Test loss: 1.588, Test accuracy: 29.42
Round  54, Global train loss: 1.216, Global test loss: 1.836, Global test accuracy: 19.80
Round  55, Train loss: 1.125, Test loss: 1.488, Test accuracy: 33.66
Round  55, Global train loss: 1.125, Global test loss: 1.181, Global test accuracy: 56.60
Round  56, Train loss: 1.204, Test loss: 1.596, Test accuracy: 31.18
Round  56, Global train loss: 1.204, Global test loss: 1.793, Global test accuracy: 22.60
Round  57, Train loss: 1.075, Test loss: 1.480, Test accuracy: 35.60
Round  57, Global train loss: 1.075, Global test loss: 1.050, Global test accuracy: 55.00
Round  58, Train loss: 1.099, Test loss: 1.491, Test accuracy: 35.06
Round  58, Global train loss: 1.099, Global test loss: 1.262, Global test accuracy: 51.80
Round  59, Train loss: 1.123, Test loss: 1.524, Test accuracy: 33.58
Round  59, Global train loss: 1.123, Global test loss: 1.353, Global test accuracy: 45.00
Round  60, Train loss: 1.080, Test loss: 1.461, Test accuracy: 34.98
Round  60, Global train loss: 1.080, Global test loss: 1.157, Global test accuracy: 54.40
Round  61, Train loss: 0.966, Test loss: 1.498, Test accuracy: 35.38
Round  61, Global train loss: 0.966, Global test loss: 1.022, Global test accuracy: 58.80
Round  62, Train loss: 1.050, Test loss: 1.498, Test accuracy: 35.40
Round  62, Global train loss: 1.050, Global test loss: 1.144, Global test accuracy: 55.40
Round  63, Train loss: 1.136, Test loss: 1.598, Test accuracy: 30.80
Round  63, Global train loss: 1.136, Global test loss: 1.737, Global test accuracy: 23.80
Round  64, Train loss: 1.038, Test loss: 1.549, Test accuracy: 33.58
Round  64, Global train loss: 1.038, Global test loss: 1.243, Global test accuracy: 51.40
Round  65, Train loss: 1.062, Test loss: 1.610, Test accuracy: 31.08
Round  65, Global train loss: 1.062, Global test loss: 1.414, Global test accuracy: 41.00
Round  66, Train loss: 0.980, Test loss: 1.612, Test accuracy: 34.42
Round  66, Global train loss: 0.980, Global test loss: 1.047, Global test accuracy: 54.80
Round  67, Train loss: 1.001, Test loss: 1.632, Test accuracy: 32.66
Round  67, Global train loss: 1.001, Global test loss: 1.400, Global test accuracy: 43.40
Round  68, Train loss: 0.892, Test loss: 1.485, Test accuracy: 40.22
Round  68, Global train loss: 0.892, Global test loss: 0.975, Global test accuracy: 58.40
Round  69, Train loss: 0.980, Test loss: 1.645, Test accuracy: 34.48
Round  69, Global train loss: 0.980, Global test loss: 1.337, Global test accuracy: 47.80
Round  70, Train loss: 1.011, Test loss: 1.670, Test accuracy: 34.00
Round  70, Global train loss: 1.011, Global test loss: 1.880, Global test accuracy: 25.20
Round  71, Train loss: 0.972, Test loss: 1.594, Test accuracy: 33.48
Round  71, Global train loss: 0.972, Global test loss: 1.330, Global test accuracy: 47.00
Round  72, Train loss: 0.956, Test loss: 1.636, Test accuracy: 33.66
Round  72, Global train loss: 0.956, Global test loss: 1.407, Global test accuracy: 44.60
Round  73, Train loss: 0.919, Test loss: 1.634, Test accuracy: 33.42
Round  73, Global train loss: 0.919, Global test loss: 1.215, Global test accuracy: 52.00
Round  74, Train loss: 0.962, Test loss: 1.754, Test accuracy: 32.58
Round  74, Global train loss: 0.962, Global test loss: 1.447, Global test accuracy: 44.80
Round  75, Train loss: 0.903, Test loss: 1.720, Test accuracy: 32.32
Round  75, Global train loss: 0.903, Global test loss: 1.332, Global test accuracy: 47.40
Round  76, Train loss: 0.868, Test loss: 1.695, Test accuracy: 33.42
Round  76, Global train loss: 0.868, Global test loss: 1.458, Global test accuracy: 44.40
Round  77, Train loss: 0.920, Test loss: 1.681, Test accuracy: 34.32
Round  77, Global train loss: 0.920, Global test loss: 1.383, Global test accuracy: 45.60
Round  78, Train loss: 0.876, Test loss: 1.724, Test accuracy: 34.58
Round  78, Global train loss: 0.876, Global test loss: 1.423, Global test accuracy: 47.00
Round  79, Train loss: 0.888, Test loss: 1.610, Test accuracy: 38.60
Round  79, Global train loss: 0.888, Global test loss: 1.217, Global test accuracy: 52.60
Round  80, Train loss: 0.851, Test loss: 1.626, Test accuracy: 37.54
Round  80, Global train loss: 0.851, Global test loss: 1.151, Global test accuracy: 57.00
Round  81, Train loss: 0.741, Test loss: 1.646, Test accuracy: 37.18
Round  81, Global train loss: 0.741, Global test loss: 1.141, Global test accuracy: 55.00
Round  82, Train loss: 0.718, Test loss: 1.633, Test accuracy: 37.40
Round  82, Global train loss: 0.718, Global test loss: 1.148, Global test accuracy: 54.40
Round  83, Train loss: 0.694, Test loss: 1.619, Test accuracy: 40.04
Round  83, Global train loss: 0.694, Global test loss: 1.115, Global test accuracy: 55.20
Round  84, Train loss: 0.661, Test loss: 1.611, Test accuracy: 39.02
Round  84, Global train loss: 0.661, Global test loss: 1.148, Global test accuracy: 56.20
Round  85, Train loss: 0.629, Test loss: 1.590, Test accuracy: 39.58
Round  85, Global train loss: 0.629, Global test loss: 1.123, Global test accuracy: 56.20
Round  86, Train loss: 0.604, Test loss: 1.601, Test accuracy: 39.84
Round  86, Global train loss: 0.604, Global test loss: 1.144, Global test accuracy: 55.80
Round  87, Train loss: 0.598, Test loss: 1.631, Test accuracy: 39.24
Round  87, Global train loss: 0.598, Global test loss: 1.187, Global test accuracy: 54.60
Round  88, Train loss: 0.573, Test loss: 1.594, Test accuracy: 39.58
Round  88, Global train loss: 0.573, Global test loss: 1.183, Global test accuracy: 54.80
Round  89, Train loss: 0.543, Test loss: 1.670, Test accuracy: 38.84
Round  89, Global train loss: 0.543, Global test loss: 1.255, Global test accuracy: 54.60
Round  90, Train loss: 0.523, Test loss: 1.649, Test accuracy: 38.90
Round  90, Global train loss: 0.523, Global test loss: 1.238, Global test accuracy: 53.60
Round  91, Train loss: 0.506, Test loss: 1.634, Test accuracy: 39.56
Round  91, Global train loss: 0.506, Global test loss: 1.223, Global test accuracy: 55.40
Round  92, Train loss: 0.505, Test loss: 1.665, Test accuracy: 39.08
Round  92, Global train loss: 0.505, Global test loss: 1.279, Global test accuracy: 54.00
Round  93, Train loss: 0.478, Test loss: 1.681, Test accuracy: 38.32
Round  93, Global train loss: 0.478, Global test loss: 1.278, Global test accuracy: 53.20
Round  94, Train loss: 0.460, Test loss: 1.688, Test accuracy: 39.24
Round  94, Global train loss: 0.460, Global test loss: 1.306, Global test accuracy: 53.40
Round  95, Train loss: 0.472, Test loss: 1.721, Test accuracy: 36.12
Round  95, Global train loss: 0.472, Global test loss: 1.362, Global test accuracy: 52.60
Round  96, Train loss: 0.418, Test loss: 1.686, Test accuracy: 38.36
Round  96, Global train loss: 0.418, Global test loss: 1.305, Global test accuracy: 53.60
Round  97, Train loss: 0.391, Test loss: 1.732, Test accuracy: 38.82
Round  97, Global train loss: 0.391, Global test loss: 1.372, Global test accuracy: 53.60
Round  98, Train loss: 0.408, Test loss: 1.753, Test accuracy: 36.82
Round  98, Global train loss: 0.408, Global test loss: 1.385, Global test accuracy: 51.80
Round  99, Train loss: 0.667, Test loss: 1.923, Test accuracy: 34.24
Round  99, Global train loss: 0.667, Global test loss: 1.536, Global test accuracy: 45.20
Final Round, Train loss: 0.531, Test loss: 2.050, Test accuracy: 34.00
Final Round, Global train loss: 0.531, Global test loss: 1.536, Global test accuracy: 45.20
Average accuracy final 10 rounds: 37.946
1926.3225181102753
[1.9005157947540283, 3.545516014099121, 5.193296909332275, 6.802998781204224, 8.443855047225952, 10.057645797729492, 11.912434816360474, 13.49659013748169, 15.093508958816528, 16.655178785324097, 22.06372332572937, 30.37724232673645, 38.59463429450989, 47.05808162689209, 55.50467801094055, 64.05774188041687, 72.81873559951782, 81.38563799858093, 90.08340287208557, 98.4206473827362, 106.98573303222656, 115.68158769607544, 124.15535521507263, 132.8137378692627, 141.39999055862427, 150.04970574378967, 158.62810039520264, 167.1252636909485, 175.6417429447174, 184.0480558872223, 192.48251700401306, 200.9497218132019, 209.41298389434814, 217.9856460094452, 226.3842329978943, 234.84860348701477, 243.46182894706726, 251.9694526195526, 260.3742415904999, 268.87754106521606, 277.2771849632263, 285.8188154697418, 294.2200038433075, 302.4235644340515, 310.9954762458801, 319.580105304718, 328.00682497024536, 336.63117837905884, 345.26675748825073, 354.0418403148651, 362.72747135162354, 371.2729992866516, 379.69556951522827, 388.2717297077179, 396.87291431427, 405.26673340797424, 413.72132897377014, 422.09168338775635, 430.5940191745758, 439.08343863487244, 447.63522458076477, 455.88809514045715, 464.4208481311798, 472.9210088253021, 481.4847435951233, 490.0962858200073, 498.60915780067444, 507.1849946975708, 515.7771437168121, 524.3140790462494, 532.9478335380554, 541.3965940475464, 549.6500773429871, 558.3517236709595, 566.9820697307587, 575.4367573261261, 583.8335344791412, 592.3681423664093, 601.1469171047211, 609.6323761940002, 611.2709529399872, 612.866001367569, 614.5119678974152, 616.1286692619324, 617.8412058353424, 619.4454646110535, 621.088992357254, 622.711195230484, 624.3044700622559, 625.9329023361206, 627.5566358566284, 629.1709396839142, 630.8144428730011, 632.3802711963654, 633.9689490795135, 635.5361530780792, 637.1566128730774, 638.8745403289795, 640.4377927780151, 648.7782368659973, 658.6894478797913]
[32.08, 32.26, 34.56, 34.38, 33.02, 32.62, 33.92, 32.98, 33.02, 32.8, 32.12, 34.08, 28.68, 26.32, 27.62, 28.76, 26.16, 31.14, 29.4, 34.82, 35.78, 30.1, 29.88, 27.8, 25.26, 27.66, 25.8, 30.68, 32.78, 36.06, 30.58, 29.56, 25.86, 29.02, 31.48, 29.8, 27.44, 28.72, 27.84, 26.84, 30.16, 26.6, 30.48, 32.66, 30.1, 29.6, 27.8, 28.82, 33.6, 29.7, 32.48, 29.06, 31.5, 33.62, 29.42, 33.66, 31.18, 35.6, 35.06, 33.58, 34.98, 35.38, 35.4, 30.8, 33.58, 31.08, 34.42, 32.66, 40.22, 34.48, 34.0, 33.48, 33.66, 33.42, 32.58, 32.32, 33.42, 34.32, 34.58, 38.6, 37.54, 37.18, 37.4, 40.04, 39.02, 39.58, 39.84, 39.24, 39.58, 38.84, 38.9, 39.56, 39.08, 38.32, 39.24, 36.12, 38.36, 38.82, 36.82, 34.24, 34.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.582, Test loss: 1.542, Test accuracy: 34.78
Round   0, Global train loss: 1.582, Global test loss: 1.544, Global test accuracy: 36.20
Round   1, Train loss: 1.548, Test loss: 1.483, Test accuracy: 38.86
Round   1, Global train loss: 1.548, Global test loss: 1.480, Global test accuracy: 41.60
Round   2, Train loss: 1.555, Test loss: 1.467, Test accuracy: 37.08
Round   2, Global train loss: 1.555, Global test loss: 1.448, Global test accuracy: 38.80
Round   3, Train loss: 1.545, Test loss: 1.468, Test accuracy: 39.02
Round   3, Global train loss: 1.545, Global test loss: 1.474, Global test accuracy: 42.40
Round   4, Train loss: 1.546, Test loss: 1.451, Test accuracy: 40.16
Round   4, Global train loss: 1.546, Global test loss: 1.423, Global test accuracy: 44.80
Round   5, Train loss: 1.506, Test loss: 1.430, Test accuracy: 40.88
Round   5, Global train loss: 1.506, Global test loss: 1.387, Global test accuracy: 45.40
Round   6, Train loss: 1.506, Test loss: 1.429, Test accuracy: 40.58
Round   6, Global train loss: 1.506, Global test loss: 1.427, Global test accuracy: 42.20
Round   7, Train loss: 1.508, Test loss: 1.417, Test accuracy: 41.86
Round   7, Global train loss: 1.508, Global test loss: 1.364, Global test accuracy: 49.00
Round   8, Train loss: 1.510, Test loss: 1.407, Test accuracy: 42.98
Round   8, Global train loss: 1.510, Global test loss: 1.415, Global test accuracy: 51.60
Round   9, Train loss: 1.478, Test loss: 1.393, Test accuracy: 43.00
Round   9, Global train loss: 1.478, Global test loss: 1.383, Global test accuracy: 47.60
Round  10, Train loss: 1.518, Test loss: 1.399, Test accuracy: 42.68
Round  10, Global train loss: 1.518, Global test loss: 1.444, Global test accuracy: 46.80
Round  11, Train loss: 1.488, Test loss: 1.396, Test accuracy: 43.16
Round  11, Global train loss: 1.488, Global test loss: 1.386, Global test accuracy: 48.20
Round  12, Train loss: 1.461, Test loss: 1.396, Test accuracy: 41.64
Round  12, Global train loss: 1.461, Global test loss: 1.317, Global test accuracy: 50.80
Round  13, Train loss: 1.531, Test loss: 1.397, Test accuracy: 41.78
Round  13, Global train loss: 1.531, Global test loss: 1.465, Global test accuracy: 39.20
Round  14, Train loss: 1.501, Test loss: 1.398, Test accuracy: 42.42
Round  14, Global train loss: 1.501, Global test loss: 1.386, Global test accuracy: 49.80
Round  15, Train loss: 1.472, Test loss: 1.397, Test accuracy: 41.82
Round  15, Global train loss: 1.472, Global test loss: 1.431, Global test accuracy: 45.00
Round  16, Train loss: 1.453, Test loss: 1.387, Test accuracy: 42.54
Round  16, Global train loss: 1.453, Global test loss: 1.328, Global test accuracy: 50.40
Round  17, Train loss: 1.435, Test loss: 1.392, Test accuracy: 42.64
Round  17, Global train loss: 1.435, Global test loss: 1.346, Global test accuracy: 47.20
Round  18, Train loss: 1.470, Test loss: 1.395, Test accuracy: 42.60
Round  18, Global train loss: 1.470, Global test loss: 1.407, Global test accuracy: 49.80
Round  19, Train loss: 1.452, Test loss: 1.384, Test accuracy: 43.48
Round  19, Global train loss: 1.452, Global test loss: 1.381, Global test accuracy: 48.00
Round  20, Train loss: 1.438, Test loss: 1.393, Test accuracy: 43.02
Round  20, Global train loss: 1.438, Global test loss: 1.383, Global test accuracy: 50.80
Round  21, Train loss: 1.441, Test loss: 1.392, Test accuracy: 43.48
Round  21, Global train loss: 1.441, Global test loss: 1.326, Global test accuracy: 49.80
Round  22, Train loss: 1.423, Test loss: 1.395, Test accuracy: 42.50
Round  22, Global train loss: 1.423, Global test loss: 1.371, Global test accuracy: 53.00
Round  23, Train loss: 1.376, Test loss: 1.391, Test accuracy: 42.82
Round  23, Global train loss: 1.376, Global test loss: 1.311, Global test accuracy: 52.00
Round  24, Train loss: 1.428, Test loss: 1.390, Test accuracy: 43.26
Round  24, Global train loss: 1.428, Global test loss: 1.398, Global test accuracy: 48.60
Round  25, Train loss: 1.429, Test loss: 1.384, Test accuracy: 43.56
Round  25, Global train loss: 1.429, Global test loss: 1.388, Global test accuracy: 48.60
Round  26, Train loss: 1.381, Test loss: 1.397, Test accuracy: 43.86
Round  26, Global train loss: 1.381, Global test loss: 1.302, Global test accuracy: 56.20
Round  27, Train loss: 1.417, Test loss: 1.389, Test accuracy: 44.14
Round  27, Global train loss: 1.417, Global test loss: 1.395, Global test accuracy: 49.20
Round  28, Train loss: 1.382, Test loss: 1.393, Test accuracy: 44.14
Round  28, Global train loss: 1.382, Global test loss: 1.348, Global test accuracy: 53.20
Round  29, Train loss: 1.346, Test loss: 1.388, Test accuracy: 43.44
Round  29, Global train loss: 1.346, Global test loss: 1.328, Global test accuracy: 59.60
Round  30, Train loss: 1.395, Test loss: 1.405, Test accuracy: 42.82
Round  30, Global train loss: 1.395, Global test loss: 1.364, Global test accuracy: 48.20
Round  31, Train loss: 1.319, Test loss: 1.414, Test accuracy: 42.58
Round  31, Global train loss: 1.319, Global test loss: 1.361, Global test accuracy: 49.40
Round  32, Train loss: 1.367, Test loss: 1.428, Test accuracy: 42.92
Round  32, Global train loss: 1.367, Global test loss: 1.352, Global test accuracy: 50.00
Round  33, Train loss: 1.297, Test loss: 1.423, Test accuracy: 43.04
Round  33, Global train loss: 1.297, Global test loss: 1.327, Global test accuracy: 50.20
Round  34, Train loss: 1.311, Test loss: 1.430, Test accuracy: 42.16
Round  34, Global train loss: 1.311, Global test loss: 1.312, Global test accuracy: 53.00
Round  35, Train loss: 1.363, Test loss: 1.450, Test accuracy: 41.74
Round  35, Global train loss: 1.363, Global test loss: 1.469, Global test accuracy: 37.40
Round  36, Train loss: 1.328, Test loss: 1.453, Test accuracy: 41.38
Round  36, Global train loss: 1.328, Global test loss: 1.407, Global test accuracy: 46.40
Round  37, Train loss: 1.279, Test loss: 1.464, Test accuracy: 41.62
Round  37, Global train loss: 1.279, Global test loss: 1.370, Global test accuracy: 44.60
Round  38, Train loss: 1.346, Test loss: 1.466, Test accuracy: 41.50
Round  38, Global train loss: 1.346, Global test loss: 1.319, Global test accuracy: 52.00
Round  39, Train loss: 1.241, Test loss: 1.477, Test accuracy: 41.46
Round  39, Global train loss: 1.241, Global test loss: 1.250, Global test accuracy: 58.40
Round  40, Train loss: 1.208, Test loss: 1.471, Test accuracy: 41.40
Round  40, Global train loss: 1.208, Global test loss: 1.412, Global test accuracy: 44.80
Round  41, Train loss: 1.221, Test loss: 1.476, Test accuracy: 41.42
Round  41, Global train loss: 1.221, Global test loss: 1.343, Global test accuracy: 50.20
Round  42, Train loss: 1.296, Test loss: 1.494, Test accuracy: 40.80
Round  42, Global train loss: 1.296, Global test loss: 1.410, Global test accuracy: 46.60
Round  43, Train loss: 1.255, Test loss: 1.500, Test accuracy: 40.48
Round  43, Global train loss: 1.255, Global test loss: 1.267, Global test accuracy: 55.20
Round  44, Train loss: 1.198, Test loss: 1.494, Test accuracy: 40.34
Round  44, Global train loss: 1.198, Global test loss: 1.209, Global test accuracy: 58.60
Round  45, Train loss: 1.081, Test loss: 1.537, Test accuracy: 40.04
Round  45, Global train loss: 1.081, Global test loss: 1.348, Global test accuracy: 46.00
Round  46, Train loss: 1.247, Test loss: 1.547, Test accuracy: 40.54
Round  46, Global train loss: 1.247, Global test loss: 1.333, Global test accuracy: 53.20
Round  47, Train loss: 1.188, Test loss: 1.563, Test accuracy: 40.16
Round  47, Global train loss: 1.188, Global test loss: 1.295, Global test accuracy: 56.60
Round  48, Train loss: 1.093, Test loss: 1.566, Test accuracy: 39.70
Round  48, Global train loss: 1.093, Global test loss: 1.341, Global test accuracy: 51.60
Round  49, Train loss: 1.071, Test loss: 1.557, Test accuracy: 40.36
Round  49, Global train loss: 1.071, Global test loss: 1.365, Global test accuracy: 54.60
Round  50, Train loss: 1.126, Test loss: 1.584, Test accuracy: 40.16
Round  50, Global train loss: 1.126, Global test loss: 1.344, Global test accuracy: 47.80
Round  51, Train loss: 1.139, Test loss: 1.587, Test accuracy: 40.34
Round  51, Global train loss: 1.139, Global test loss: 1.270, Global test accuracy: 49.80
Round  52, Train loss: 1.069, Test loss: 1.597, Test accuracy: 40.36
Round  52, Global train loss: 1.069, Global test loss: 1.237, Global test accuracy: 60.40
Round  53, Train loss: 0.964, Test loss: 1.640, Test accuracy: 39.50
Round  53, Global train loss: 0.964, Global test loss: 1.272, Global test accuracy: 54.80
Round  54, Train loss: 1.075, Test loss: 1.671, Test accuracy: 39.78
Round  54, Global train loss: 1.075, Global test loss: 1.322, Global test accuracy: 49.00
Round  55, Train loss: 1.076, Test loss: 1.692, Test accuracy: 39.96
Round  55, Global train loss: 1.076, Global test loss: 1.227, Global test accuracy: 60.40
Round  56, Train loss: 1.005, Test loss: 1.760, Test accuracy: 38.54
Round  56, Global train loss: 1.005, Global test loss: 1.384, Global test accuracy: 45.20
Round  57, Train loss: 0.882, Test loss: 1.772, Test accuracy: 39.90
Round  57, Global train loss: 0.882, Global test loss: 1.263, Global test accuracy: 52.00
Round  58, Train loss: 1.047, Test loss: 1.783, Test accuracy: 39.70
Round  58, Global train loss: 1.047, Global test loss: 1.328, Global test accuracy: 54.20
Round  59, Train loss: 0.917, Test loss: 1.810, Test accuracy: 38.44
Round  59, Global train loss: 0.917, Global test loss: 1.351, Global test accuracy: 48.80
Round  60, Train loss: 0.940, Test loss: 1.821, Test accuracy: 38.06
Round  60, Global train loss: 0.940, Global test loss: 1.329, Global test accuracy: 51.00
Round  61, Train loss: 0.980, Test loss: 1.845, Test accuracy: 38.24
Round  61, Global train loss: 0.980, Global test loss: 1.272, Global test accuracy: 54.40
Round  62, Train loss: 0.809, Test loss: 1.879, Test accuracy: 37.88
Round  62, Global train loss: 0.809, Global test loss: 1.354, Global test accuracy: 45.20
Round  63, Train loss: 0.871, Test loss: 1.865, Test accuracy: 38.20
Round  63, Global train loss: 0.871, Global test loss: 1.437, Global test accuracy: 41.40
Round  64, Train loss: 0.856, Test loss: 1.841, Test accuracy: 39.84
Round  64, Global train loss: 0.856, Global test loss: 1.224, Global test accuracy: 56.60
Round  65, Train loss: 0.717, Test loss: 1.877, Test accuracy: 38.48
Round  65, Global train loss: 0.717, Global test loss: 1.313, Global test accuracy: 49.00
Round  66, Train loss: 0.822, Test loss: 1.913, Test accuracy: 38.34
Round  66, Global train loss: 0.822, Global test loss: 1.342, Global test accuracy: 46.20
Round  67, Train loss: 0.820, Test loss: 1.976, Test accuracy: 38.56
Round  67, Global train loss: 0.820, Global test loss: 1.388, Global test accuracy: 46.20
Round  68, Train loss: 0.832, Test loss: 2.052, Test accuracy: 37.54
Round  68, Global train loss: 0.832, Global test loss: 1.313, Global test accuracy: 51.80
Round  69, Train loss: 0.711, Test loss: 2.071, Test accuracy: 37.38
Round  69, Global train loss: 0.711, Global test loss: 1.350, Global test accuracy: 48.40
Round  70, Train loss: 0.788, Test loss: 2.069, Test accuracy: 38.34
Round  70, Global train loss: 0.788, Global test loss: 1.364, Global test accuracy: 46.00
Round  71, Train loss: 0.549, Test loss: 2.165, Test accuracy: 37.84
Round  71, Global train loss: 0.549, Global test loss: 1.416, Global test accuracy: 43.60
Round  72, Train loss: 0.660, Test loss: 2.268, Test accuracy: 36.56
Round  72, Global train loss: 0.660, Global test loss: 1.300, Global test accuracy: 48.80
Round  73, Train loss: 0.573, Test loss: 2.251, Test accuracy: 36.90
Round  73, Global train loss: 0.573, Global test loss: 1.458, Global test accuracy: 41.20
Round  74, Train loss: 0.637, Test loss: 2.233, Test accuracy: 37.00
Round  74, Global train loss: 0.637, Global test loss: 1.279, Global test accuracy: 52.80
Round  75, Train loss: 0.733, Test loss: 2.251, Test accuracy: 37.10
Round  75, Global train loss: 0.733, Global test loss: 1.360, Global test accuracy: 49.60
Round  76, Train loss: 0.540, Test loss: 2.288, Test accuracy: 36.10
Round  76, Global train loss: 0.540, Global test loss: 1.336, Global test accuracy: 48.20
Round  77, Train loss: 0.525, Test loss: 2.383, Test accuracy: 36.58
Round  77, Global train loss: 0.525, Global test loss: 1.303, Global test accuracy: 48.60
Round  78, Train loss: 0.611, Test loss: 2.347, Test accuracy: 36.28
Round  78, Global train loss: 0.611, Global test loss: 1.231, Global test accuracy: 52.40
Round  79, Train loss: 0.423, Test loss: 2.399, Test accuracy: 36.66
Round  79, Global train loss: 0.423, Global test loss: 1.288, Global test accuracy: 50.20
Round  80, Train loss: 0.656, Test loss: 2.443, Test accuracy: 36.42
Round  80, Global train loss: 0.656, Global test loss: 1.354, Global test accuracy: 47.40
Round  81, Train loss: 0.614, Test loss: 2.485, Test accuracy: 35.68
Round  81, Global train loss: 0.614, Global test loss: 1.232, Global test accuracy: 51.80
Round  82, Train loss: 0.439, Test loss: 2.522, Test accuracy: 36.42
Round  82, Global train loss: 0.439, Global test loss: 1.476, Global test accuracy: 42.00
Round  83, Train loss: 0.584, Test loss: 2.493, Test accuracy: 37.56
Round  83, Global train loss: 0.584, Global test loss: 1.320, Global test accuracy: 52.20
Round  84, Train loss: 0.610, Test loss: 2.566, Test accuracy: 37.46
Round  84, Global train loss: 0.610, Global test loss: 1.470, Global test accuracy: 39.80
Round  85, Train loss: 0.634, Test loss: 2.612, Test accuracy: 37.50
Round  85, Global train loss: 0.634, Global test loss: 1.325, Global test accuracy: 46.80
Round  86, Train loss: 0.616, Test loss: 2.682, Test accuracy: 37.40
Round  86, Global train loss: 0.616, Global test loss: 1.405, Global test accuracy: 42.60
Round  87, Train loss: 0.647, Test loss: 2.666, Test accuracy: 36.82
Round  87, Global train loss: 0.647, Global test loss: 1.466, Global test accuracy: 38.60
Round  88, Train loss: 0.563, Test loss: 2.778, Test accuracy: 36.74
Round  88, Global train loss: 0.563, Global test loss: 1.652, Global test accuracy: 38.80
Round  89, Train loss: 0.355, Test loss: 2.795, Test accuracy: 37.02
Round  89, Global train loss: 0.355, Global test loss: 1.524, Global test accuracy: 40.00
Round  90, Train loss: 0.397, Test loss: 2.863, Test accuracy: 37.12
Round  90, Global train loss: 0.397, Global test loss: 1.371, Global test accuracy: 45.00
Round  91, Train loss: 0.421, Test loss: 2.844, Test accuracy: 37.44
Round  91, Global train loss: 0.421, Global test loss: 1.276, Global test accuracy: 49.00
Round  92, Train loss: 0.440, Test loss: 2.837, Test accuracy: 37.78
Round  92, Global train loss: 0.440, Global test loss: 1.319, Global test accuracy: 51.80
Round  93, Train loss: 0.420, Test loss: 2.918, Test accuracy: 37.10
Round  93, Global train loss: 0.420, Global test loss: 1.559, Global test accuracy: 38.40
Round  94, Train loss: 0.372, Test loss: 2.895, Test accuracy: 36.66
Round  94, Global train loss: 0.372, Global test loss: 1.348, Global test accuracy: 46.40
Round  95, Train loss: 0.400, Test loss: 2.884, Test accuracy: 35.98
Round  95, Global train loss: 0.400, Global test loss: 1.425, Global test accuracy: 43.40
Round  96, Train loss: 0.380, Test loss: 3.013, Test accuracy: 36.06
Round  96, Global train loss: 0.380, Global test loss: 1.618, Global test accuracy: 41.80
Round  97, Train loss: 0.359, Test loss: 3.110, Test accuracy: 36.56
Round  97, Global train loss: 0.359, Global test loss: 1.364, Global test accuracy: 47.80
Round  98, Train loss: 0.388, Test loss: 3.062, Test accuracy: 36.92
Round  98, Global train loss: 0.388, Global test loss: 1.424, Global test accuracy: 44.60
Round  99, Train loss: 0.337, Test loss: 3.138, Test accuracy: 36.92
Round  99, Global train loss: 0.337, Global test loss: 1.435, Global test accuracy: 44.40
Final Round, Train loss: 0.376, Test loss: 3.366, Test accuracy: 36.64
Final Round, Global train loss: 0.376, Global test loss: 1.435, Global test accuracy: 44.40
Average accuracy final 10 rounds: 36.854 

Average global accuracy final 10 rounds: 45.26 

789.0083119869232
[1.4717669486999512, 2.9435338973999023, 4.143981456756592, 5.344429016113281, 6.536889553070068, 7.7293500900268555, 8.928264617919922, 10.127179145812988, 11.261400938034058, 12.395622730255127, 13.657780170440674, 14.91993761062622, 16.08160161972046, 17.243265628814697, 18.471678972244263, 19.700092315673828, 20.885353088378906, 22.070613861083984, 23.262125730514526, 24.45363759994507, 25.637747526168823, 26.821857452392578, 27.95657730102539, 29.091297149658203, 30.352689504623413, 31.614081859588623, 32.782620668411255, 33.95115947723389, 35.10531497001648, 36.25947046279907, 37.46018433570862, 38.660898208618164, 39.83997678756714, 41.01905536651611, 42.220454454422, 43.42185354232788, 44.619587421417236, 45.81732130050659, 46.9962739944458, 48.17522668838501, 49.35951900482178, 50.543811321258545, 51.74769830703735, 52.95158529281616, 54.11847472190857, 55.28536415100098, 56.496278047561646, 57.707191944122314, 58.86881470680237, 60.03043746948242, 61.16853475570679, 62.30663204193115, 63.49676585197449, 64.68689966201782, 65.88400053977966, 67.0811014175415, 68.33077955245972, 69.58045768737793, 70.74658298492432, 71.9127082824707, 73.10434460639954, 74.29598093032837, 75.46529960632324, 76.63461828231812, 77.8767614364624, 79.11890459060669, 80.36147785186768, 81.60405111312866, 82.78430271148682, 83.96455430984497, 85.10291934013367, 86.24128437042236, 87.44206523895264, 88.64284610748291, 89.84464263916016, 91.0464391708374, 92.33887958526611, 93.63131999969482, 94.78596878051758, 95.94061756134033, 97.10443472862244, 98.26825189590454, 99.44279479980469, 100.61733770370483, 101.81317591667175, 103.00901412963867, 104.22608733177185, 105.44316053390503, 106.650315284729, 107.85747003555298, 109.05012965202332, 110.24278926849365, 111.46045231819153, 112.6781153678894, 113.85795140266418, 115.03778743743896, 116.23495507240295, 117.43212270736694, 118.61012840270996, 119.78813409805298, 121.01187491416931, 122.23561573028564, 123.45771026611328, 124.67980480194092, 125.92786931991577, 127.17593383789062, 128.40538024902344, 129.63482666015625, 130.86517024040222, 132.0955138206482, 133.31705164909363, 134.53858947753906, 135.77861380577087, 137.01863813400269, 138.21686720848083, 139.41509628295898, 140.6040141582489, 141.79293203353882, 142.9711833000183, 144.1494345664978, 145.34928131103516, 146.5491280555725, 147.7205948829651, 148.89206171035767, 150.11546540260315, 151.33886909484863, 152.53322577476501, 153.7275824546814, 154.96114420890808, 156.19470596313477, 157.4108428955078, 158.62697982788086, 159.80542612075806, 160.98387241363525, 162.16415429115295, 163.34443616867065, 164.52982759475708, 165.7152190208435, 166.89882826805115, 168.0824375152588, 169.28825521469116, 170.49407291412354, 171.67587161064148, 172.85767030715942, 174.01402735710144, 175.17038440704346, 176.34118175506592, 177.51197910308838, 178.7831506729126, 180.05432224273682, 181.3003339767456, 182.5463457107544, 183.71171188354492, 184.87707805633545, 186.1171498298645, 187.35722160339355, 188.56009030342102, 189.7629590034485, 190.91645526885986, 192.06995153427124, 193.23481583595276, 194.39968013763428, 195.59348154067993, 196.7872829437256, 197.9373598098755, 199.0874366760254, 200.2615451812744, 201.43565368652344, 202.59715700149536, 203.75866031646729, 204.92544388771057, 206.09222745895386, 207.2278344631195, 208.36344146728516, 209.5333490371704, 210.70325660705566, 211.8574891090393, 213.01172161102295, 214.15155124664307, 215.29138088226318, 216.53738522529602, 217.78338956832886, 218.97437357902527, 220.16535758972168, 221.3763644695282, 222.58737134933472, 223.72791361808777, 224.86845588684082, 226.06049227714539, 227.25252866744995, 228.48292994499207, 229.71333122253418, 230.86658573150635, 232.01984024047852, 233.2388346195221, 234.45782899856567, 235.61639380455017, 236.77495861053467, 237.9358766078949, 239.09679460525513, 241.5220422744751, 243.94728994369507]
[34.78, 34.78, 38.86, 38.86, 37.08, 37.08, 39.02, 39.02, 40.16, 40.16, 40.88, 40.88, 40.58, 40.58, 41.86, 41.86, 42.98, 42.98, 43.0, 43.0, 42.68, 42.68, 43.16, 43.16, 41.64, 41.64, 41.78, 41.78, 42.42, 42.42, 41.82, 41.82, 42.54, 42.54, 42.64, 42.64, 42.6, 42.6, 43.48, 43.48, 43.02, 43.02, 43.48, 43.48, 42.5, 42.5, 42.82, 42.82, 43.26, 43.26, 43.56, 43.56, 43.86, 43.86, 44.14, 44.14, 44.14, 44.14, 43.44, 43.44, 42.82, 42.82, 42.58, 42.58, 42.92, 42.92, 43.04, 43.04, 42.16, 42.16, 41.74, 41.74, 41.38, 41.38, 41.62, 41.62, 41.5, 41.5, 41.46, 41.46, 41.4, 41.4, 41.42, 41.42, 40.8, 40.8, 40.48, 40.48, 40.34, 40.34, 40.04, 40.04, 40.54, 40.54, 40.16, 40.16, 39.7, 39.7, 40.36, 40.36, 40.16, 40.16, 40.34, 40.34, 40.36, 40.36, 39.5, 39.5, 39.78, 39.78, 39.96, 39.96, 38.54, 38.54, 39.9, 39.9, 39.7, 39.7, 38.44, 38.44, 38.06, 38.06, 38.24, 38.24, 37.88, 37.88, 38.2, 38.2, 39.84, 39.84, 38.48, 38.48, 38.34, 38.34, 38.56, 38.56, 37.54, 37.54, 37.38, 37.38, 38.34, 38.34, 37.84, 37.84, 36.56, 36.56, 36.9, 36.9, 37.0, 37.0, 37.1, 37.1, 36.1, 36.1, 36.58, 36.58, 36.28, 36.28, 36.66, 36.66, 36.42, 36.42, 35.68, 35.68, 36.42, 36.42, 37.56, 37.56, 37.46, 37.46, 37.5, 37.5, 37.4, 37.4, 36.82, 36.82, 36.74, 36.74, 37.02, 37.02, 37.12, 37.12, 37.44, 37.44, 37.78, 37.78, 37.1, 37.1, 36.66, 36.66, 35.98, 35.98, 36.06, 36.06, 36.56, 36.56, 36.92, 36.92, 36.92, 36.92, 36.64, 36.64]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.587, Test loss: 1.554, Test accuracy: 33.50
Round   0, Global train loss: 1.587, Global test loss: 1.556, Global test accuracy: 34.60
Round   1, Train loss: 1.548, Test loss: 1.466, Test accuracy: 39.74
Round   1, Global train loss: 1.548, Global test loss: 1.449, Global test accuracy: 43.00
Round   2, Train loss: 1.516, Test loss: 1.432, Test accuracy: 42.02
Round   2, Global train loss: 1.516, Global test loss: 1.386, Global test accuracy: 46.80
Round   3, Train loss: 1.538, Test loss: 1.432, Test accuracy: 43.66
Round   3, Global train loss: 1.538, Global test loss: 1.416, Global test accuracy: 50.20
Round   4, Train loss: 1.544, Test loss: 1.410, Test accuracy: 45.02
Round   4, Global train loss: 1.544, Global test loss: 1.391, Global test accuracy: 50.80
Round   5, Train loss: 1.454, Test loss: 1.373, Test accuracy: 45.10
Round   5, Global train loss: 1.454, Global test loss: 1.266, Global test accuracy: 51.80
Round   6, Train loss: 1.488, Test loss: 1.363, Test accuracy: 47.02
Round   6, Global train loss: 1.488, Global test loss: 1.285, Global test accuracy: 56.80
Round   7, Train loss: 1.501, Test loss: 1.356, Test accuracy: 48.60
Round   7, Global train loss: 1.501, Global test loss: 1.238, Global test accuracy: 64.20
Round   8, Train loss: 1.514, Test loss: 1.336, Test accuracy: 51.62
Round   8, Global train loss: 1.514, Global test loss: 1.333, Global test accuracy: 60.40
Round   9, Train loss: 1.459, Test loss: 1.326, Test accuracy: 51.60
Round   9, Global train loss: 1.459, Global test loss: 1.259, Global test accuracy: 61.80
Round  10, Train loss: 1.488, Test loss: 1.322, Test accuracy: 50.76
Round  10, Global train loss: 1.488, Global test loss: 1.243, Global test accuracy: 61.40
Round  11, Train loss: 1.393, Test loss: 1.297, Test accuracy: 51.90
Round  11, Global train loss: 1.393, Global test loss: 1.212, Global test accuracy: 57.60
Round  12, Train loss: 1.463, Test loss: 1.287, Test accuracy: 52.86
Round  12, Global train loss: 1.463, Global test loss: 1.178, Global test accuracy: 67.80
Round  13, Train loss: 1.492, Test loss: 1.290, Test accuracy: 53.92
Round  13, Global train loss: 1.492, Global test loss: 1.307, Global test accuracy: 54.60
Round  14, Train loss: 1.450, Test loss: 1.300, Test accuracy: 52.60
Round  14, Global train loss: 1.450, Global test loss: 1.288, Global test accuracy: 55.60
Round  15, Train loss: 1.418, Test loss: 1.305, Test accuracy: 51.70
Round  15, Global train loss: 1.418, Global test loss: 1.300, Global test accuracy: 55.60
Round  16, Train loss: 1.312, Test loss: 1.319, Test accuracy: 52.28
Round  16, Global train loss: 1.312, Global test loss: 1.237, Global test accuracy: 57.00
Round  17, Train loss: 1.300, Test loss: 1.318, Test accuracy: 51.66
Round  17, Global train loss: 1.300, Global test loss: 1.236, Global test accuracy: 53.20
Round  18, Train loss: 1.386, Test loss: 1.323, Test accuracy: 51.68
Round  18, Global train loss: 1.386, Global test loss: 1.274, Global test accuracy: 59.20
Round  19, Train loss: 1.402, Test loss: 1.325, Test accuracy: 50.60
Round  19, Global train loss: 1.402, Global test loss: 1.217, Global test accuracy: 60.20
Round  20, Train loss: 1.281, Test loss: 1.319, Test accuracy: 50.36
Round  20, Global train loss: 1.281, Global test loss: 1.188, Global test accuracy: 58.20
Round  21, Train loss: 1.404, Test loss: 1.313, Test accuracy: 49.54
Round  21, Global train loss: 1.404, Global test loss: 1.224, Global test accuracy: 56.20
Round  22, Train loss: 1.324, Test loss: 1.311, Test accuracy: 48.76
Round  22, Global train loss: 1.324, Global test loss: 1.257, Global test accuracy: 54.60
Round  23, Train loss: 1.279, Test loss: 1.314, Test accuracy: 48.62
Round  23, Global train loss: 1.279, Global test loss: 1.195, Global test accuracy: 57.00
Round  24, Train loss: 1.212, Test loss: 1.327, Test accuracy: 49.18
Round  24, Global train loss: 1.212, Global test loss: 1.266, Global test accuracy: 54.00
Round  25, Train loss: 1.176, Test loss: 1.344, Test accuracy: 48.90
Round  25, Global train loss: 1.176, Global test loss: 1.306, Global test accuracy: 49.20
Round  26, Train loss: 1.264, Test loss: 1.383, Test accuracy: 47.30
Round  26, Global train loss: 1.264, Global test loss: 1.287, Global test accuracy: 51.80
Round  27, Train loss: 1.223, Test loss: 1.412, Test accuracy: 46.50
Round  27, Global train loss: 1.223, Global test loss: 1.390, Global test accuracy: 49.60
Round  28, Train loss: 1.177, Test loss: 1.439, Test accuracy: 45.56
Round  28, Global train loss: 1.177, Global test loss: 1.327, Global test accuracy: 49.40
Round  29, Train loss: 1.158, Test loss: 1.451, Test accuracy: 44.44
Round  29, Global train loss: 1.158, Global test loss: 1.322, Global test accuracy: 47.60
Round  30, Train loss: 1.063, Test loss: 1.512, Test accuracy: 44.00
Round  30, Global train loss: 1.063, Global test loss: 1.617, Global test accuracy: 39.20
Round  31, Train loss: 1.057, Test loss: 1.565, Test accuracy: 42.84
Round  31, Global train loss: 1.057, Global test loss: 1.546, Global test accuracy: 37.80
Round  32, Train loss: 0.897, Test loss: 1.563, Test accuracy: 42.96
Round  32, Global train loss: 0.897, Global test loss: 1.598, Global test accuracy: 44.40
Round  33, Train loss: 0.922, Test loss: 1.561, Test accuracy: 43.84
Round  33, Global train loss: 0.922, Global test loss: 1.446, Global test accuracy: 47.80
Round  34, Train loss: 1.103, Test loss: 1.599, Test accuracy: 42.70
Round  34, Global train loss: 1.103, Global test loss: 1.366, Global test accuracy: 49.20
Round  35, Train loss: 0.886, Test loss: 1.641, Test accuracy: 41.74
Round  35, Global train loss: 0.886, Global test loss: 1.857, Global test accuracy: 35.60
Round  36, Train loss: 0.853, Test loss: 1.715, Test accuracy: 41.60
Round  36, Global train loss: 0.853, Global test loss: 1.883, Global test accuracy: 36.40
Round  37, Train loss: 0.692, Test loss: 1.785, Test accuracy: 41.38
Round  37, Global train loss: 0.692, Global test loss: 1.884, Global test accuracy: 45.40
Round  38, Train loss: 0.879, Test loss: 1.813, Test accuracy: 41.14
Round  38, Global train loss: 0.879, Global test loss: 1.769, Global test accuracy: 36.00
Round  39, Train loss: 1.068, Test loss: 1.809, Test accuracy: 41.12
Round  39, Global train loss: 1.068, Global test loss: 1.270, Global test accuracy: 53.80
Round  40, Train loss: 0.805, Test loss: 1.862, Test accuracy: 41.06
Round  40, Global train loss: 0.805, Global test loss: 1.731, Global test accuracy: 40.20
Round  41, Train loss: 0.731, Test loss: 1.866, Test accuracy: 41.12
Round  41, Global train loss: 0.731, Global test loss: 1.833, Global test accuracy: 42.60
Round  42, Train loss: 0.715, Test loss: 1.946, Test accuracy: 41.06
Round  42, Global train loss: 0.715, Global test loss: 1.802, Global test accuracy: 40.00
Round  43, Train loss: 0.685, Test loss: 2.074, Test accuracy: 40.70
Round  43, Global train loss: 0.685, Global test loss: 1.618, Global test accuracy: 50.00
Round  44, Train loss: 0.738, Test loss: 2.034, Test accuracy: 41.08
Round  44, Global train loss: 0.738, Global test loss: 1.420, Global test accuracy: 53.00
Round  45, Train loss: 0.607, Test loss: 2.095, Test accuracy: 41.42
Round  45, Global train loss: 0.607, Global test loss: 1.886, Global test accuracy: 42.20
Round  46, Train loss: 0.702, Test loss: 2.130, Test accuracy: 41.08
Round  46, Global train loss: 0.702, Global test loss: 1.987, Global test accuracy: 39.40
Round  47, Train loss: 0.583, Test loss: 2.183, Test accuracy: 40.58
Round  47, Global train loss: 0.583, Global test loss: 1.902, Global test accuracy: 43.00
Round  48, Train loss: 0.662, Test loss: 2.184, Test accuracy: 40.86
Round  48, Global train loss: 0.662, Global test loss: 1.825, Global test accuracy: 42.80
Round  49, Train loss: 0.600, Test loss: 2.228, Test accuracy: 40.86
Round  49, Global train loss: 0.600, Global test loss: 1.880, Global test accuracy: 43.00
Round  50, Train loss: 0.458, Test loss: 2.146, Test accuracy: 41.90
Round  50, Global train loss: 0.458, Global test loss: 1.982, Global test accuracy: 44.40
Round  51, Train loss: 0.710, Test loss: 2.206, Test accuracy: 41.74
Round  51, Global train loss: 0.710, Global test loss: 1.795, Global test accuracy: 44.00
Round  52, Train loss: 0.642, Test loss: 2.189, Test accuracy: 42.48
Round  52, Global train loss: 0.642, Global test loss: 1.669, Global test accuracy: 46.80
Round  53, Train loss: 0.603, Test loss: 2.198, Test accuracy: 42.60
Round  53, Global train loss: 0.603, Global test loss: 1.535, Global test accuracy: 49.40
Round  54, Train loss: 0.504, Test loss: 2.160, Test accuracy: 44.02
Round  54, Global train loss: 0.504, Global test loss: 1.912, Global test accuracy: 48.60
Round  55, Train loss: 0.562, Test loss: 2.267, Test accuracy: 42.00
Round  55, Global train loss: 0.562, Global test loss: 1.813, Global test accuracy: 44.00
Round  56, Train loss: 0.481, Test loss: 2.349, Test accuracy: 40.68
Round  56, Global train loss: 0.481, Global test loss: 2.170, Global test accuracy: 39.60
Round  57, Train loss: 0.464, Test loss: 2.390, Test accuracy: 40.94
Round  57, Global train loss: 0.464, Global test loss: 1.917, Global test accuracy: 45.80
Round  58, Train loss: 0.508, Test loss: 2.481, Test accuracy: 40.06
Round  58, Global train loss: 0.508, Global test loss: 2.242, Global test accuracy: 41.40
Round  59, Train loss: 0.421, Test loss: 2.581, Test accuracy: 40.42
Round  59, Global train loss: 0.421, Global test loss: 2.217, Global test accuracy: 43.80
Round  60, Train loss: 0.478, Test loss: 2.577, Test accuracy: 40.18
Round  60, Global train loss: 0.478, Global test loss: 1.946, Global test accuracy: 47.00
Round  61, Train loss: 0.424, Test loss: 2.593, Test accuracy: 41.46
Round  61, Global train loss: 0.424, Global test loss: 2.163, Global test accuracy: 42.40
Round  62, Train loss: 0.364, Test loss: 2.614, Test accuracy: 41.40
Round  62, Global train loss: 0.364, Global test loss: 2.240, Global test accuracy: 43.00
Round  63, Train loss: 0.436, Test loss: 2.591, Test accuracy: 40.92
Round  63, Global train loss: 0.436, Global test loss: 2.153, Global test accuracy: 42.00
Round  64, Train loss: 0.470, Test loss: 2.615, Test accuracy: 41.40
Round  64, Global train loss: 0.470, Global test loss: 1.816, Global test accuracy: 52.20
Round  65, Train loss: 0.390, Test loss: 2.627, Test accuracy: 41.94
Round  65, Global train loss: 0.390, Global test loss: 2.180, Global test accuracy: 42.40
Round  66, Train loss: 0.391, Test loss: 2.703, Test accuracy: 41.38
Round  66, Global train loss: 0.391, Global test loss: 2.373, Global test accuracy: 41.20
Round  67, Train loss: 0.348, Test loss: 2.752, Test accuracy: 41.90
Round  67, Global train loss: 0.348, Global test loss: 2.479, Global test accuracy: 40.60
Round  68, Train loss: 0.377, Test loss: 2.821, Test accuracy: 41.86
Round  68, Global train loss: 0.377, Global test loss: 2.493, Global test accuracy: 39.60
Round  69, Train loss: 0.432, Test loss: 2.764, Test accuracy: 41.82
Round  69, Global train loss: 0.432, Global test loss: 1.997, Global test accuracy: 44.00
Round  70, Train loss: 0.304, Test loss: 2.825, Test accuracy: 41.22
Round  70, Global train loss: 0.304, Global test loss: 2.734, Global test accuracy: 40.00
Round  71, Train loss: 0.279, Test loss: 2.868, Test accuracy: 40.78
Round  71, Global train loss: 0.279, Global test loss: 2.257, Global test accuracy: 48.80
Round  72, Train loss: 0.394, Test loss: 2.857, Test accuracy: 40.56
Round  72, Global train loss: 0.394, Global test loss: 2.278, Global test accuracy: 43.80
Round  73, Train loss: 0.267, Test loss: 2.889, Test accuracy: 40.52
Round  73, Global train loss: 0.267, Global test loss: 2.533, Global test accuracy: 40.40
Round  74, Train loss: 0.322, Test loss: 2.918, Test accuracy: 40.16
Round  74, Global train loss: 0.322, Global test loss: 2.451, Global test accuracy: 45.60
Round  75, Train loss: 0.356, Test loss: 3.002, Test accuracy: 40.54
Round  75, Global train loss: 0.356, Global test loss: 2.784, Global test accuracy: 36.80
Round  76, Train loss: 0.288, Test loss: 2.983, Test accuracy: 40.84
Round  76, Global train loss: 0.288, Global test loss: 2.501, Global test accuracy: 42.00
Round  77, Train loss: 0.263, Test loss: 2.997, Test accuracy: 40.36
Round  77, Global train loss: 0.263, Global test loss: 2.444, Global test accuracy: 46.00
Round  78, Train loss: 0.309, Test loss: 3.092, Test accuracy: 39.94
Round  78, Global train loss: 0.309, Global test loss: 2.378, Global test accuracy: 46.00
Round  79, Train loss: 0.303, Test loss: 3.163, Test accuracy: 40.58
Round  79, Global train loss: 0.303, Global test loss: 2.442, Global test accuracy: 44.00
Round  80, Train loss: 0.312, Test loss: 3.217, Test accuracy: 40.52
Round  80, Global train loss: 0.312, Global test loss: 2.604, Global test accuracy: 43.00
Round  81, Train loss: 0.325, Test loss: 3.237, Test accuracy: 40.56
Round  81, Global train loss: 0.325, Global test loss: 2.266, Global test accuracy: 46.00
Round  82, Train loss: 0.193, Test loss: 3.145, Test accuracy: 40.28
Round  82, Global train loss: 0.193, Global test loss: 2.959, Global test accuracy: 41.60
Round  83, Train loss: 0.304, Test loss: 3.163, Test accuracy: 39.98
Round  83, Global train loss: 0.304, Global test loss: 2.855, Global test accuracy: 38.40
Round  84, Train loss: 0.254, Test loss: 3.191, Test accuracy: 40.30
Round  84, Global train loss: 0.254, Global test loss: 2.855, Global test accuracy: 39.80
Round  85, Train loss: 0.165, Test loss: 3.283, Test accuracy: 39.94
Round  85, Global train loss: 0.165, Global test loss: 3.033, Global test accuracy: 44.20
Round  86, Train loss: 0.155, Test loss: 3.259, Test accuracy: 40.38
Round  86, Global train loss: 0.155, Global test loss: 3.500, Global test accuracy: 38.60
Round  87, Train loss: 0.206, Test loss: 3.338, Test accuracy: 40.42
Round  87, Global train loss: 0.206, Global test loss: 3.452, Global test accuracy: 38.20
Round  88, Train loss: 0.134, Test loss: 3.333, Test accuracy: 40.68
Round  88, Global train loss: 0.134, Global test loss: 3.751, Global test accuracy: 37.00
Round  89, Train loss: 0.167, Test loss: 3.346, Test accuracy: 40.80
Round  89, Global train loss: 0.167, Global test loss: 3.023, Global test accuracy: 43.80
Round  90, Train loss: 0.258, Test loss: 3.352, Test accuracy: 40.16
Round  90, Global train loss: 0.258, Global test loss: 3.030, Global test accuracy: 38.60
Round  91, Train loss: 0.310, Test loss: 3.313, Test accuracy: 40.34
Round  91, Global train loss: 0.310, Global test loss: 2.354, Global test accuracy: 44.40
Round  92, Train loss: 0.230, Test loss: 3.353, Test accuracy: 40.26
Round  92, Global train loss: 0.230, Global test loss: 2.698, Global test accuracy: 42.40
Round  93, Train loss: 0.163, Test loss: 3.348, Test accuracy: 40.62
Round  93, Global train loss: 0.163, Global test loss: 3.393, Global test accuracy: 41.60
Round  94, Train loss: 0.245, Test loss: 3.403, Test accuracy: 40.34
Round  94, Global train loss: 0.245, Global test loss: 2.957, Global test accuracy: 41.20
Round  95, Train loss: 0.221, Test loss: 3.502, Test accuracy: 40.68
Round  95, Global train loss: 0.221, Global test loss: 3.030, Global test accuracy: 45.00
Round  96, Train loss: 0.103, Test loss: 3.551, Test accuracy: 41.48
Round  96, Global train loss: 0.103, Global test loss: 3.272, Global test accuracy: 47.00
Round  97, Train loss: 0.248, Test loss: 3.526, Test accuracy: 40.90
Round  97, Global train loss: 0.248, Global test loss: 3.024, Global test accuracy: 40.80
Round  98, Train loss: 0.204, Test loss: 3.531, Test accuracy: 40.14
Round  98, Global train loss: 0.204, Global test loss: 3.073, Global test accuracy: 44.60
Round  99, Train loss: 0.167, Test loss: 3.584, Test accuracy: 39.86
Round  99, Global train loss: 0.167, Global test loss: 3.475, Global test accuracy: 40.40
Final Round, Train loss: 0.176, Test loss: 3.852, Test accuracy: 39.90
Final Round, Global train loss: 0.176, Global test loss: 3.475, Global test accuracy: 40.40
Average accuracy final 10 rounds: 40.477999999999994 

Average global accuracy final 10 rounds: 42.6 

789.0892407894135
[1.474989652633667, 2.949979305267334, 4.206753730773926, 5.463528156280518, 6.678518772125244, 7.893509387969971, 9.062187910079956, 10.230866432189941, 11.461910486221313, 12.692954540252686, 13.871389389038086, 15.049824237823486, 16.22493863105774, 17.400053024291992, 18.626304388046265, 19.852555751800537, 21.083754777908325, 22.314953804016113, 23.479347229003906, 24.6437406539917, 25.792062044143677, 26.940383434295654, 28.11826181411743, 29.29614019393921, 30.473402738571167, 31.650665283203125, 32.86717486381531, 34.08368444442749, 35.27056002616882, 36.457435607910156, 37.65366315841675, 38.84989070892334, 39.98868274688721, 41.127474784851074, 42.50203561782837, 43.876596450805664, 45.056082248687744, 46.235568046569824, 47.39858388900757, 48.56159973144531, 49.71595573425293, 50.87031173706055, 52.05508756637573, 53.23986339569092, 54.43461799621582, 55.62937259674072, 56.803502798080444, 57.977632999420166, 59.290735960006714, 60.60383892059326, 61.84208297729492, 63.08032703399658, 64.29481506347656, 65.50930309295654, 66.69994640350342, 67.8905897140503, 69.13582992553711, 70.38107013702393, 71.55995321273804, 72.73883628845215, 73.95052886009216, 75.16222143173218, 76.30305886268616, 77.44389629364014, 78.63905119895935, 79.83420610427856, 81.00702500343323, 82.17984390258789, 83.31512188911438, 84.45039987564087, 85.6102614402771, 86.77012300491333, 87.93496823310852, 89.09981346130371, 90.2877128124237, 91.4756121635437, 92.62456321716309, 93.77351427078247, 94.95385003089905, 96.13418579101562, 97.31336951255798, 98.49255323410034, 99.6861572265625, 100.87976121902466, 102.09353446960449, 103.30730772018433, 104.47423696517944, 105.64116621017456, 106.83629822731018, 108.0314302444458, 109.21248412132263, 110.39353799819946, 111.56480956077576, 112.73608112335205, 113.96814799308777, 115.20021486282349, 116.35409426689148, 117.50797367095947, 118.66363573074341, 119.81929779052734, 121.03382205963135, 122.24834632873535, 123.48725271224976, 124.72615909576416, 125.93076062202454, 127.13536214828491, 128.33581614494324, 129.53627014160156, 130.731614112854, 131.92695808410645, 133.1332745552063, 134.33959102630615, 135.5408477783203, 136.74210453033447, 137.93102836608887, 139.11995220184326, 140.28756546974182, 141.45517873764038, 142.69784116744995, 143.94050359725952, 145.15184235572815, 146.36318111419678, 147.58531618118286, 148.80745124816895, 150.00900530815125, 151.21055936813354, 152.46580910682678, 153.72105884552002, 154.82384371757507, 155.92662858963013, 157.07778143882751, 158.2289342880249, 159.39405965805054, 160.55918502807617, 161.76017451286316, 162.96116399765015, 164.13659715652466, 165.31203031539917, 166.50918674468994, 167.7063431739807, 168.9089856147766, 170.1116280555725, 171.35763335227966, 172.60363864898682, 173.78280234336853, 174.96196603775024, 176.2222809791565, 177.48259592056274, 178.6863420009613, 179.89008808135986, 181.12337923049927, 182.35667037963867, 183.59032344818115, 184.82397651672363, 185.99676990509033, 187.16956329345703, 188.42836213111877, 189.68716096878052, 190.86309242248535, 192.03902387619019, 193.31968450546265, 194.6003451347351, 195.78196454048157, 196.96358394622803, 198.17103052139282, 199.37847709655762, 200.55307388305664, 201.72767066955566, 202.862952709198, 203.99823474884033, 205.19648218154907, 206.3947296142578, 207.53546166419983, 208.67619371414185, 209.82643818855286, 210.97668266296387, 212.16198420524597, 213.34728574752808, 214.5387043952942, 215.7301230430603, 216.89172554016113, 218.05332803726196, 219.2079348564148, 220.36254167556763, 221.59022450447083, 222.81790733337402, 223.97955107688904, 225.14119482040405, 226.33628058433533, 227.5313663482666, 228.84381818771362, 230.15627002716064, 231.44780278205872, 232.7393355369568, 233.93345165252686, 235.12756776809692, 236.3235239982605, 237.51948022842407, 238.7635464668274, 240.0076127052307, 242.38748931884766, 244.7673659324646]
[33.5, 33.5, 39.74, 39.74, 42.02, 42.02, 43.66, 43.66, 45.02, 45.02, 45.1, 45.1, 47.02, 47.02, 48.6, 48.6, 51.62, 51.62, 51.6, 51.6, 50.76, 50.76, 51.9, 51.9, 52.86, 52.86, 53.92, 53.92, 52.6, 52.6, 51.7, 51.7, 52.28, 52.28, 51.66, 51.66, 51.68, 51.68, 50.6, 50.6, 50.36, 50.36, 49.54, 49.54, 48.76, 48.76, 48.62, 48.62, 49.18, 49.18, 48.9, 48.9, 47.3, 47.3, 46.5, 46.5, 45.56, 45.56, 44.44, 44.44, 44.0, 44.0, 42.84, 42.84, 42.96, 42.96, 43.84, 43.84, 42.7, 42.7, 41.74, 41.74, 41.6, 41.6, 41.38, 41.38, 41.14, 41.14, 41.12, 41.12, 41.06, 41.06, 41.12, 41.12, 41.06, 41.06, 40.7, 40.7, 41.08, 41.08, 41.42, 41.42, 41.08, 41.08, 40.58, 40.58, 40.86, 40.86, 40.86, 40.86, 41.9, 41.9, 41.74, 41.74, 42.48, 42.48, 42.6, 42.6, 44.02, 44.02, 42.0, 42.0, 40.68, 40.68, 40.94, 40.94, 40.06, 40.06, 40.42, 40.42, 40.18, 40.18, 41.46, 41.46, 41.4, 41.4, 40.92, 40.92, 41.4, 41.4, 41.94, 41.94, 41.38, 41.38, 41.9, 41.9, 41.86, 41.86, 41.82, 41.82, 41.22, 41.22, 40.78, 40.78, 40.56, 40.56, 40.52, 40.52, 40.16, 40.16, 40.54, 40.54, 40.84, 40.84, 40.36, 40.36, 39.94, 39.94, 40.58, 40.58, 40.52, 40.52, 40.56, 40.56, 40.28, 40.28, 39.98, 39.98, 40.3, 40.3, 39.94, 39.94, 40.38, 40.38, 40.42, 40.42, 40.68, 40.68, 40.8, 40.8, 40.16, 40.16, 40.34, 40.34, 40.26, 40.26, 40.62, 40.62, 40.34, 40.34, 40.68, 40.68, 41.48, 41.48, 40.9, 40.9, 40.14, 40.14, 39.86, 39.86, 39.9, 39.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.594, Test loss: 1.579, Test accuracy: 28.14
Round   0, Global train loss: 1.594, Global test loss: 1.579, Global test accuracy: 27.20
Round   1, Train loss: 1.573, Test loss: 1.514, Test accuracy: 35.60
Round   1, Global train loss: 1.573, Global test loss: 1.503, Global test accuracy: 36.00
Round   2, Train loss: 1.564, Test loss: 1.498, Test accuracy: 38.08
Round   2, Global train loss: 1.564, Global test loss: 1.468, Global test accuracy: 45.60
Round   3, Train loss: 1.572, Test loss: 1.495, Test accuracy: 38.66
Round   3, Global train loss: 1.572, Global test loss: 1.473, Global test accuracy: 45.20
Round   4, Train loss: 1.568, Test loss: 1.477, Test accuracy: 40.86
Round   4, Global train loss: 1.568, Global test loss: 1.446, Global test accuracy: 49.80
Round   5, Train loss: 1.537, Test loss: 1.451, Test accuracy: 41.04
Round   5, Global train loss: 1.537, Global test loss: 1.394, Global test accuracy: 47.60
Round   6, Train loss: 1.536, Test loss: 1.438, Test accuracy: 42.08
Round   6, Global train loss: 1.536, Global test loss: 1.382, Global test accuracy: 50.60
Round   7, Train loss: 1.468, Test loss: 1.402, Test accuracy: 43.84
Round   7, Global train loss: 1.468, Global test loss: 1.247, Global test accuracy: 58.20
Round   8, Train loss: 1.542, Test loss: 1.384, Test accuracy: 46.98
Round   8, Global train loss: 1.542, Global test loss: 1.366, Global test accuracy: 60.20
Round   9, Train loss: 1.516, Test loss: 1.377, Test accuracy: 47.52
Round   9, Global train loss: 1.516, Global test loss: 1.347, Global test accuracy: 57.80
Round  10, Train loss: 1.488, Test loss: 1.373, Test accuracy: 46.98
Round  10, Global train loss: 1.488, Global test loss: 1.277, Global test accuracy: 55.20
Round  11, Train loss: 1.511, Test loss: 1.346, Test accuracy: 48.86
Round  11, Global train loss: 1.511, Global test loss: 1.332, Global test accuracy: 52.00
Round  12, Train loss: 1.422, Test loss: 1.331, Test accuracy: 48.64
Round  12, Global train loss: 1.422, Global test loss: 1.179, Global test accuracy: 60.40
Round  13, Train loss: 1.497, Test loss: 1.327, Test accuracy: 49.66
Round  13, Global train loss: 1.497, Global test loss: 1.323, Global test accuracy: 52.40
Round  14, Train loss: 1.482, Test loss: 1.318, Test accuracy: 48.80
Round  14, Global train loss: 1.482, Global test loss: 1.288, Global test accuracy: 54.40
Round  15, Train loss: 1.493, Test loss: 1.325, Test accuracy: 47.72
Round  15, Global train loss: 1.493, Global test loss: 1.360, Global test accuracy: 49.80
Round  16, Train loss: 1.438, Test loss: 1.335, Test accuracy: 46.52
Round  16, Global train loss: 1.438, Global test loss: 1.329, Global test accuracy: 48.60
Round  17, Train loss: 1.454, Test loss: 1.336, Test accuracy: 47.36
Round  17, Global train loss: 1.454, Global test loss: 1.369, Global test accuracy: 48.20
Round  18, Train loss: 1.451, Test loss: 1.332, Test accuracy: 47.36
Round  18, Global train loss: 1.451, Global test loss: 1.336, Global test accuracy: 50.20
Round  19, Train loss: 1.384, Test loss: 1.333, Test accuracy: 46.80
Round  19, Global train loss: 1.384, Global test loss: 1.153, Global test accuracy: 58.40
Round  20, Train loss: 1.410, Test loss: 1.342, Test accuracy: 45.50
Round  20, Global train loss: 1.410, Global test loss: 1.267, Global test accuracy: 53.00
Round  21, Train loss: 1.385, Test loss: 1.331, Test accuracy: 46.48
Round  21, Global train loss: 1.385, Global test loss: 1.150, Global test accuracy: 60.20
Round  22, Train loss: 1.374, Test loss: 1.329, Test accuracy: 46.80
Round  22, Global train loss: 1.374, Global test loss: 1.245, Global test accuracy: 57.00
Round  23, Train loss: 1.384, Test loss: 1.346, Test accuracy: 44.76
Round  23, Global train loss: 1.384, Global test loss: 1.243, Global test accuracy: 56.60
Round  24, Train loss: 1.364, Test loss: 1.338, Test accuracy: 45.64
Round  24, Global train loss: 1.364, Global test loss: 1.321, Global test accuracy: 50.20
Round  25, Train loss: 1.357, Test loss: 1.344, Test accuracy: 46.38
Round  25, Global train loss: 1.357, Global test loss: 1.358, Global test accuracy: 49.60
Round  26, Train loss: 1.377, Test loss: 1.349, Test accuracy: 46.02
Round  26, Global train loss: 1.377, Global test loss: 1.245, Global test accuracy: 54.60
Round  27, Train loss: 1.258, Test loss: 1.360, Test accuracy: 45.48
Round  27, Global train loss: 1.258, Global test loss: 1.258, Global test accuracy: 48.20
Round  28, Train loss: 1.303, Test loss: 1.354, Test accuracy: 45.86
Round  28, Global train loss: 1.303, Global test loss: 1.220, Global test accuracy: 54.60
Round  29, Train loss: 1.284, Test loss: 1.362, Test accuracy: 44.72
Round  29, Global train loss: 1.284, Global test loss: 1.335, Global test accuracy: 47.40
Round  30, Train loss: 1.301, Test loss: 1.350, Test accuracy: 46.46
Round  30, Global train loss: 1.301, Global test loss: 1.415, Global test accuracy: 43.80
Round  31, Train loss: 1.217, Test loss: 1.355, Test accuracy: 45.94
Round  31, Global train loss: 1.217, Global test loss: 1.349, Global test accuracy: 49.20
Round  32, Train loss: 1.164, Test loss: 1.388, Test accuracy: 45.04
Round  32, Global train loss: 1.164, Global test loss: 1.455, Global test accuracy: 44.20
Round  33, Train loss: 1.169, Test loss: 1.395, Test accuracy: 45.58
Round  33, Global train loss: 1.169, Global test loss: 1.368, Global test accuracy: 48.60
Round  34, Train loss: 1.192, Test loss: 1.405, Test accuracy: 46.84
Round  34, Global train loss: 1.192, Global test loss: 1.204, Global test accuracy: 54.00
Round  35, Train loss: 1.130, Test loss: 1.452, Test accuracy: 45.60
Round  35, Global train loss: 1.130, Global test loss: 1.581, Global test accuracy: 40.80
Round  36, Train loss: 1.093, Test loss: 1.478, Test accuracy: 45.72
Round  36, Global train loss: 1.093, Global test loss: 1.639, Global test accuracy: 42.00
Round  37, Train loss: 0.981, Test loss: 1.507, Test accuracy: 45.36
Round  37, Global train loss: 0.981, Global test loss: 1.663, Global test accuracy: 43.80
Round  38, Train loss: 1.024, Test loss: 1.546, Test accuracy: 44.80
Round  38, Global train loss: 1.024, Global test loss: 1.517, Global test accuracy: 46.00
Round  39, Train loss: 1.138, Test loss: 1.575, Test accuracy: 43.44
Round  39, Global train loss: 1.138, Global test loss: 1.168, Global test accuracy: 55.40
Round  40, Train loss: 1.015, Test loss: 1.592, Test accuracy: 44.30
Round  40, Global train loss: 1.015, Global test loss: 1.430, Global test accuracy: 47.40
Round  41, Train loss: 0.948, Test loss: 1.607, Test accuracy: 43.68
Round  41, Global train loss: 0.948, Global test loss: 1.633, Global test accuracy: 45.60
Round  42, Train loss: 0.868, Test loss: 1.635, Test accuracy: 43.10
Round  42, Global train loss: 0.868, Global test loss: 1.554, Global test accuracy: 46.20
Round  43, Train loss: 0.908, Test loss: 1.706, Test accuracy: 42.30
Round  43, Global train loss: 0.908, Global test loss: 1.490, Global test accuracy: 48.80
Round  44, Train loss: 1.004, Test loss: 1.708, Test accuracy: 42.34
Round  44, Global train loss: 1.004, Global test loss: 1.408, Global test accuracy: 50.80
Round  45, Train loss: 0.801, Test loss: 1.729, Test accuracy: 42.46
Round  45, Global train loss: 0.801, Global test loss: 1.696, Global test accuracy: 44.00
Round  46, Train loss: 0.865, Test loss: 1.753, Test accuracy: 41.58
Round  46, Global train loss: 0.865, Global test loss: 1.599, Global test accuracy: 43.40
Round  47, Train loss: 0.751, Test loss: 1.788, Test accuracy: 41.82
Round  47, Global train loss: 0.751, Global test loss: 1.592, Global test accuracy: 48.20
Round  48, Train loss: 0.818, Test loss: 1.833, Test accuracy: 41.88
Round  48, Global train loss: 0.818, Global test loss: 1.588, Global test accuracy: 42.40
Round  49, Train loss: 0.796, Test loss: 1.860, Test accuracy: 41.28
Round  49, Global train loss: 0.796, Global test loss: 1.596, Global test accuracy: 43.40
Round  50, Train loss: 0.693, Test loss: 1.860, Test accuracy: 40.98
Round  50, Global train loss: 0.693, Global test loss: 1.903, Global test accuracy: 38.60
Round  51, Train loss: 0.916, Test loss: 1.867, Test accuracy: 41.16
Round  51, Global train loss: 0.916, Global test loss: 1.535, Global test accuracy: 42.80
Round  52, Train loss: 0.817, Test loss: 1.884, Test accuracy: 40.06
Round  52, Global train loss: 0.817, Global test loss: 1.556, Global test accuracy: 47.20
Round  53, Train loss: 0.794, Test loss: 1.892, Test accuracy: 40.28
Round  53, Global train loss: 0.794, Global test loss: 1.485, Global test accuracy: 43.60
Round  54, Train loss: 0.627, Test loss: 1.951, Test accuracy: 40.14
Round  54, Global train loss: 0.627, Global test loss: 1.695, Global test accuracy: 45.20
Round  55, Train loss: 0.756, Test loss: 1.965, Test accuracy: 40.80
Round  55, Global train loss: 0.756, Global test loss: 1.686, Global test accuracy: 44.00
Round  56, Train loss: 0.587, Test loss: 1.947, Test accuracy: 40.78
Round  56, Global train loss: 0.587, Global test loss: 1.649, Global test accuracy: 46.40
Round  57, Train loss: 0.655, Test loss: 1.996, Test accuracy: 40.76
Round  57, Global train loss: 0.655, Global test loss: 1.689, Global test accuracy: 45.00
Round  58, Train loss: 0.672, Test loss: 2.058, Test accuracy: 40.44
Round  58, Global train loss: 0.672, Global test loss: 2.005, Global test accuracy: 39.00
Round  59, Train loss: 0.571, Test loss: 2.147, Test accuracy: 39.90
Round  59, Global train loss: 0.571, Global test loss: 2.016, Global test accuracy: 38.20
Round  60, Train loss: 0.679, Test loss: 2.183, Test accuracy: 39.86
Round  60, Global train loss: 0.679, Global test loss: 1.786, Global test accuracy: 42.20
Round  61, Train loss: 0.545, Test loss: 2.241, Test accuracy: 39.44
Round  61, Global train loss: 0.545, Global test loss: 1.894, Global test accuracy: 44.00
Round  62, Train loss: 0.486, Test loss: 2.309, Test accuracy: 38.88
Round  62, Global train loss: 0.486, Global test loss: 2.369, Global test accuracy: 43.80
Round  63, Train loss: 0.565, Test loss: 2.309, Test accuracy: 39.24
Round  63, Global train loss: 0.565, Global test loss: 1.837, Global test accuracy: 42.20
Round  64, Train loss: 0.562, Test loss: 2.262, Test accuracy: 40.70
Round  64, Global train loss: 0.562, Global test loss: 1.563, Global test accuracy: 50.00
Round  65, Train loss: 0.493, Test loss: 2.238, Test accuracy: 40.64
Round  65, Global train loss: 0.493, Global test loss: 1.845, Global test accuracy: 44.60
Round  66, Train loss: 0.505, Test loss: 2.246, Test accuracy: 39.80
Round  66, Global train loss: 0.505, Global test loss: 1.929, Global test accuracy: 41.00
Round  67, Train loss: 0.449, Test loss: 2.338, Test accuracy: 40.24
Round  67, Global train loss: 0.449, Global test loss: 2.121, Global test accuracy: 40.20
Round  68, Train loss: 0.456, Test loss: 2.346, Test accuracy: 40.38
Round  68, Global train loss: 0.456, Global test loss: 1.919, Global test accuracy: 47.80
Round  69, Train loss: 0.554, Test loss: 2.326, Test accuracy: 40.44
Round  69, Global train loss: 0.554, Global test loss: 1.597, Global test accuracy: 45.60
Round  70, Train loss: 0.406, Test loss: 2.354, Test accuracy: 40.36
Round  70, Global train loss: 0.406, Global test loss: 2.258, Global test accuracy: 41.40
Round  71, Train loss: 0.419, Test loss: 2.396, Test accuracy: 40.54
Round  71, Global train loss: 0.419, Global test loss: 2.255, Global test accuracy: 42.80
Round  72, Train loss: 0.501, Test loss: 2.384, Test accuracy: 40.44
Round  72, Global train loss: 0.501, Global test loss: 1.999, Global test accuracy: 43.80
Round  73, Train loss: 0.344, Test loss: 2.437, Test accuracy: 40.22
Round  73, Global train loss: 0.344, Global test loss: 2.245, Global test accuracy: 40.80
Round  74, Train loss: 0.458, Test loss: 2.454, Test accuracy: 39.70
Round  74, Global train loss: 0.458, Global test loss: 2.060, Global test accuracy: 42.80
Round  75, Train loss: 0.392, Test loss: 2.463, Test accuracy: 39.90
Round  75, Global train loss: 0.392, Global test loss: 2.168, Global test accuracy: 41.80
Round  76, Train loss: 0.372, Test loss: 2.482, Test accuracy: 40.26
Round  76, Global train loss: 0.372, Global test loss: 2.087, Global test accuracy: 41.80
Round  77, Train loss: 0.400, Test loss: 2.429, Test accuracy: 40.26
Round  77, Global train loss: 0.400, Global test loss: 1.958, Global test accuracy: 45.20
Round  78, Train loss: 0.382, Test loss: 2.466, Test accuracy: 40.78
Round  78, Global train loss: 0.382, Global test loss: 1.883, Global test accuracy: 48.00
Round  79, Train loss: 0.362, Test loss: 2.556, Test accuracy: 39.32
Round  79, Global train loss: 0.362, Global test loss: 2.038, Global test accuracy: 44.60
Round  80, Train loss: 0.331, Test loss: 2.603, Test accuracy: 38.76
Round  80, Global train loss: 0.331, Global test loss: 1.999, Global test accuracy: 47.00
Round  81, Train loss: 0.406, Test loss: 2.689, Test accuracy: 38.46
Round  81, Global train loss: 0.406, Global test loss: 2.020, Global test accuracy: 42.40
Round  82, Train loss: 0.285, Test loss: 2.682, Test accuracy: 38.66
Round  82, Global train loss: 0.285, Global test loss: 2.612, Global test accuracy: 40.60
Round  83, Train loss: 0.333, Test loss: 2.672, Test accuracy: 39.56
Round  83, Global train loss: 0.333, Global test loss: 2.178, Global test accuracy: 45.20
Round  84, Train loss: 0.368, Test loss: 2.624, Test accuracy: 40.20
Round  84, Global train loss: 0.368, Global test loss: 2.221, Global test accuracy: 41.60
Round  85, Train loss: 0.302, Test loss: 2.652, Test accuracy: 39.94
Round  85, Global train loss: 0.302, Global test loss: 2.607, Global test accuracy: 37.60
Round  86, Train loss: 0.268, Test loss: 2.693, Test accuracy: 39.36
Round  86, Global train loss: 0.268, Global test loss: 2.859, Global test accuracy: 33.40
Round  87, Train loss: 0.277, Test loss: 2.770, Test accuracy: 38.94
Round  87, Global train loss: 0.277, Global test loss: 2.780, Global test accuracy: 37.40
Round  88, Train loss: 0.179, Test loss: 2.793, Test accuracy: 38.80
Round  88, Global train loss: 0.179, Global test loss: 3.047, Global test accuracy: 35.80
Round  89, Train loss: 0.228, Test loss: 2.883, Test accuracy: 38.66
Round  89, Global train loss: 0.228, Global test loss: 2.940, Global test accuracy: 40.40
Round  90, Train loss: 0.336, Test loss: 2.916, Test accuracy: 38.92
Round  90, Global train loss: 0.336, Global test loss: 2.314, Global test accuracy: 38.80
Round  91, Train loss: 0.413, Test loss: 2.920, Test accuracy: 38.88
Round  91, Global train loss: 0.413, Global test loss: 2.078, Global test accuracy: 42.20
Round  92, Train loss: 0.329, Test loss: 2.907, Test accuracy: 38.94
Round  92, Global train loss: 0.329, Global test loss: 2.028, Global test accuracy: 43.80
Round  93, Train loss: 0.234, Test loss: 2.808, Test accuracy: 39.46
Round  93, Global train loss: 0.234, Global test loss: 2.640, Global test accuracy: 41.00/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.298, Test loss: 2.894, Test accuracy: 38.46
Round  94, Global train loss: 0.298, Global test loss: 2.460, Global test accuracy: 38.00
Round  95, Train loss: 0.248, Test loss: 2.865, Test accuracy: 38.88
Round  95, Global train loss: 0.248, Global test loss: 2.278, Global test accuracy: 44.60
Round  96, Train loss: 0.167, Test loss: 2.875, Test accuracy: 37.96
Round  96, Global train loss: 0.167, Global test loss: 2.996, Global test accuracy: 38.80
Round  97, Train loss: 0.328, Test loss: 2.878, Test accuracy: 38.62
Round  97, Global train loss: 0.328, Global test loss: 2.425, Global test accuracy: 41.40
Round  98, Train loss: 0.224, Test loss: 2.897, Test accuracy: 39.24
Round  98, Global train loss: 0.224, Global test loss: 2.505, Global test accuracy: 44.40
Round  99, Train loss: 0.225, Test loss: 2.903, Test accuracy: 39.58
Round  99, Global train loss: 0.225, Global test loss: 2.888, Global test accuracy: 39.40
Final Round, Train loss: 0.198, Test loss: 3.118, Test accuracy: 40.08
Final Round, Global train loss: 0.198, Global test loss: 2.888, Global test accuracy: 39.40
Average accuracy final 10 rounds: 38.894 

Average global accuracy final 10 rounds: 41.239999999999995 

843.2593841552734
[1.5352880954742432, 3.0705761909484863, 4.335417747497559, 5.600259304046631, 6.904223442077637, 8.208187580108643, 9.523178339004517, 10.83816909790039, 12.18344259262085, 13.528716087341309, 14.831634998321533, 16.134553909301758, 17.39897632598877, 18.66339874267578, 20.099406003952026, 21.53541326522827, 22.836700677871704, 24.137988090515137, 25.453136205673218, 26.7682843208313, 28.020147800445557, 29.272011280059814, 30.59739661216736, 31.922781944274902, 33.23992967605591, 34.557077407836914, 35.927037715911865, 37.296998023986816, 38.71169376373291, 40.126389503479004, 41.48484992980957, 42.84331035614014, 44.14689254760742, 45.45047473907471, 46.74500036239624, 48.03952598571777, 49.39245653152466, 50.74538707733154, 52.027915954589844, 53.310444831848145, 54.613173723220825, 55.915902614593506, 57.192450761795044, 58.46899890899658, 59.92243790626526, 61.375876903533936, 62.69764566421509, 64.01941442489624, 65.32539105415344, 66.63136768341064, 67.97490811347961, 69.31844854354858, 70.55732536315918, 71.79620218276978, 73.08112263679504, 74.36604309082031, 75.63805317878723, 76.91006326675415, 78.218430519104, 79.52679777145386, 80.77370285987854, 82.02060794830322, 83.28433322906494, 84.54805850982666, 85.80519199371338, 87.0623254776001, 88.3164587020874, 89.5705919265747, 90.82935333251953, 92.08811473846436, 93.35590600967407, 94.62369728088379, 95.89026689529419, 97.15683650970459, 98.48009204864502, 99.80334758758545, 101.10151386260986, 102.39968013763428, 103.70200157165527, 105.00432300567627, 106.34125471115112, 107.67818641662598, 108.99425768852234, 110.3103289604187, 111.63204908370972, 112.95376920700073, 114.23609805107117, 115.5184268951416, 116.78023791313171, 118.04204893112183, 119.32117080688477, 120.6002926826477, 121.89616584777832, 123.19203901290894, 124.44715619087219, 125.70227336883545, 126.97356057167053, 128.24484777450562, 129.51431488990784, 130.78378200531006, 132.08487558364868, 133.3859691619873, 134.7622880935669, 136.13860702514648, 137.6040861606598, 139.0695652961731, 140.3521580696106, 141.6347508430481, 142.95935344696045, 144.2839560508728, 145.6102364063263, 146.93651676177979, 148.20280480384827, 149.46909284591675, 150.81109142303467, 152.1530900001526, 153.46902513504028, 154.78496026992798, 156.1175355911255, 157.450110912323, 158.72623920440674, 160.00236749649048, 161.35232615470886, 162.70228481292725, 163.97069597244263, 165.239107131958, 166.5603427886963, 167.88157844543457, 169.20163130760193, 170.5216841697693, 171.86970162391663, 173.21771907806396, 174.48478412628174, 175.7518491744995, 177.3514289855957, 178.9510087966919, 180.25916957855225, 181.5673303604126, 182.90628814697266, 184.24524593353271, 185.61244010925293, 186.97963428497314, 188.29781556129456, 189.61599683761597, 190.93151688575745, 192.24703693389893, 193.53359985351562, 194.82016277313232, 196.19339275360107, 197.56662273406982, 198.8487765789032, 200.13093042373657, 201.42789125442505, 202.72485208511353, 204.08121514320374, 205.43757820129395, 206.95219445228577, 208.4668107032776, 209.92250752449036, 211.37820434570312, 212.8892059326172, 214.40020751953125, 215.90552473068237, 217.4108419418335, 218.9199402332306, 220.42903852462769, 221.91432929039001, 223.39962005615234, 224.90997791290283, 226.42033576965332, 227.82569241523743, 229.23104906082153, 230.68545031547546, 232.1398515701294, 233.53685855865479, 234.93386554718018, 236.31404995918274, 237.6942343711853, 239.121563911438, 240.54889345169067, 241.96417212486267, 243.37945079803467, 244.7985634803772, 246.21767616271973, 247.609783411026, 249.00189065933228, 250.36821842193604, 251.7345461845398, 253.18887901306152, 254.64321184158325, 256.03382897377014, 257.42444610595703, 258.7901749610901, 260.15590381622314, 261.50018405914307, 262.844464302063, 264.128919839859, 265.41337537765503, 266.6828782558441, 267.9523811340332, 270.69214057922363, 273.43190002441406]
[28.14, 28.14, 35.6, 35.6, 38.08, 38.08, 38.66, 38.66, 40.86, 40.86, 41.04, 41.04, 42.08, 42.08, 43.84, 43.84, 46.98, 46.98, 47.52, 47.52, 46.98, 46.98, 48.86, 48.86, 48.64, 48.64, 49.66, 49.66, 48.8, 48.8, 47.72, 47.72, 46.52, 46.52, 47.36, 47.36, 47.36, 47.36, 46.8, 46.8, 45.5, 45.5, 46.48, 46.48, 46.8, 46.8, 44.76, 44.76, 45.64, 45.64, 46.38, 46.38, 46.02, 46.02, 45.48, 45.48, 45.86, 45.86, 44.72, 44.72, 46.46, 46.46, 45.94, 45.94, 45.04, 45.04, 45.58, 45.58, 46.84, 46.84, 45.6, 45.6, 45.72, 45.72, 45.36, 45.36, 44.8, 44.8, 43.44, 43.44, 44.3, 44.3, 43.68, 43.68, 43.1, 43.1, 42.3, 42.3, 42.34, 42.34, 42.46, 42.46, 41.58, 41.58, 41.82, 41.82, 41.88, 41.88, 41.28, 41.28, 40.98, 40.98, 41.16, 41.16, 40.06, 40.06, 40.28, 40.28, 40.14, 40.14, 40.8, 40.8, 40.78, 40.78, 40.76, 40.76, 40.44, 40.44, 39.9, 39.9, 39.86, 39.86, 39.44, 39.44, 38.88, 38.88, 39.24, 39.24, 40.7, 40.7, 40.64, 40.64, 39.8, 39.8, 40.24, 40.24, 40.38, 40.38, 40.44, 40.44, 40.36, 40.36, 40.54, 40.54, 40.44, 40.44, 40.22, 40.22, 39.7, 39.7, 39.9, 39.9, 40.26, 40.26, 40.26, 40.26, 40.78, 40.78, 39.32, 39.32, 38.76, 38.76, 38.46, 38.46, 38.66, 38.66, 39.56, 39.56, 40.2, 40.2, 39.94, 39.94, 39.36, 39.36, 38.94, 38.94, 38.8, 38.8, 38.66, 38.66, 38.92, 38.92, 38.88, 38.88, 38.94, 38.94, 39.46, 39.46, 38.46, 38.46, 38.88, 38.88, 37.96, 37.96, 38.62, 38.62, 39.24, 39.24, 39.58, 39.58, 40.08, 40.08]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.595, Test loss: 1.572, Test accuracy: 32.70
Round   0, Global train loss: 1.595, Global test loss: 1.573, Global test accuracy: 33.40
Round   1, Train loss: 1.537, Test loss: 1.486, Test accuracy: 36.24
Round   1, Global train loss: 1.537, Global test loss: 1.465, Global test accuracy: 37.80
Round   2, Train loss: 1.506, Test loss: 1.478, Test accuracy: 40.06
Round   2, Global train loss: 1.506, Global test loss: 1.439, Global test accuracy: 44.80
Round   3, Train loss: 1.492, Test loss: 1.470, Test accuracy: 41.88
Round   3, Global train loss: 1.492, Global test loss: 1.439, Global test accuracy: 46.60
Round   4, Train loss: 1.498, Test loss: 1.459, Test accuracy: 43.80
Round   4, Global train loss: 1.498, Global test loss: 1.419, Global test accuracy: 51.20
Round   5, Train loss: 1.460, Test loss: 1.476, Test accuracy: 44.64
Round   5, Global train loss: 1.460, Global test loss: 1.426, Global test accuracy: 52.00
Round   6, Train loss: 1.462, Test loss: 1.439, Test accuracy: 46.10
Round   6, Global train loss: 1.462, Global test loss: 1.329, Global test accuracy: 53.40
Round   7, Train loss: 1.440, Test loss: 1.450, Test accuracy: 45.64
Round   7, Global train loss: 1.440, Global test loss: 1.411, Global test accuracy: 53.20
Round   8, Train loss: 1.472, Test loss: 1.428, Test accuracy: 48.78
Round   8, Global train loss: 1.472, Global test loss: 1.401, Global test accuracy: 51.60
Round   9, Train loss: 1.433, Test loss: 1.409, Test accuracy: 49.68
Round   9, Global train loss: 1.433, Global test loss: 1.342, Global test accuracy: 54.00
Round  10, Train loss: 1.387, Test loss: 1.407, Test accuracy: 49.14
Round  10, Global train loss: 1.387, Global test loss: 1.312, Global test accuracy: 54.20
Round  11, Train loss: 1.413, Test loss: 1.394, Test accuracy: 50.06
Round  11, Global train loss: 1.413, Global test loss: 1.315, Global test accuracy: 53.80
Round  12, Train loss: 1.408, Test loss: 1.380, Test accuracy: 50.62
Round  12, Global train loss: 1.408, Global test loss: 1.331, Global test accuracy: 56.60
Round  13, Train loss: 1.354, Test loss: 1.383, Test accuracy: 50.22
Round  13, Global train loss: 1.354, Global test loss: 1.338, Global test accuracy: 53.80
Round  14, Train loss: 1.383, Test loss: 1.390, Test accuracy: 51.44
Round  14, Global train loss: 1.383, Global test loss: 1.321, Global test accuracy: 54.80
Round  15, Train loss: 1.380, Test loss: 1.378, Test accuracy: 52.88
Round  15, Global train loss: 1.380, Global test loss: 1.283, Global test accuracy: 53.40
Round  16, Train loss: 1.348, Test loss: 1.384, Test accuracy: 51.42
Round  16, Global train loss: 1.348, Global test loss: 1.303, Global test accuracy: 49.60
Round  17, Train loss: 1.346, Test loss: 1.386, Test accuracy: 51.44
Round  17, Global train loss: 1.346, Global test loss: 1.298, Global test accuracy: 54.20
Round  18, Train loss: 1.330, Test loss: 1.364, Test accuracy: 50.14
Round  18, Global train loss: 1.330, Global test loss: 1.314, Global test accuracy: 54.00
Round  19, Train loss: 1.344, Test loss: 1.364, Test accuracy: 50.58
Round  19, Global train loss: 1.344, Global test loss: 1.265, Global test accuracy: 53.80
Round  20, Train loss: 1.321, Test loss: 1.364, Test accuracy: 50.22
Round  20, Global train loss: 1.321, Global test loss: 1.379, Global test accuracy: 52.20
Round  21, Train loss: 1.390, Test loss: 1.352, Test accuracy: 49.84
Round  21, Global train loss: 1.390, Global test loss: 1.206, Global test accuracy: 56.20
Round  22, Train loss: 1.285, Test loss: 1.329, Test accuracy: 51.24
Round  22, Global train loss: 1.285, Global test loss: 1.271, Global test accuracy: 56.20
Round  23, Train loss: 1.319, Test loss: 1.331, Test accuracy: 50.72
Round  23, Global train loss: 1.319, Global test loss: 1.190, Global test accuracy: 55.60
Round  24, Train loss: 1.262, Test loss: 1.323, Test accuracy: 50.80
Round  24, Global train loss: 1.262, Global test loss: 1.284, Global test accuracy: 51.00
Round  25, Train loss: 1.263, Test loss: 1.338, Test accuracy: 49.78
Round  25, Global train loss: 1.263, Global test loss: 1.280, Global test accuracy: 50.20
Round  26, Train loss: 1.306, Test loss: 1.339, Test accuracy: 49.54
Round  26, Global train loss: 1.306, Global test loss: 1.224, Global test accuracy: 55.80
Round  27, Train loss: 1.204, Test loss: 1.326, Test accuracy: 49.40
Round  27, Global train loss: 1.204, Global test loss: 1.262, Global test accuracy: 52.00
Round  28, Train loss: 1.185, Test loss: 1.370, Test accuracy: 48.70
Round  28, Global train loss: 1.185, Global test loss: 1.299, Global test accuracy: 53.80
Round  29, Train loss: 1.234, Test loss: 1.358, Test accuracy: 48.34
Round  29, Global train loss: 1.234, Global test loss: 1.230, Global test accuracy: 53.20
Round  30, Train loss: 1.181, Test loss: 1.388, Test accuracy: 47.38
Round  30, Global train loss: 1.181, Global test loss: 1.383, Global test accuracy: 46.80
Round  31, Train loss: 1.165, Test loss: 1.395, Test accuracy: 47.28
Round  31, Global train loss: 1.165, Global test loss: 1.332, Global test accuracy: 51.20
Round  32, Train loss: 1.065, Test loss: 1.402, Test accuracy: 47.54
Round  32, Global train loss: 1.065, Global test loss: 1.416, Global test accuracy: 48.60
Round  33, Train loss: 1.079, Test loss: 1.385, Test accuracy: 47.70
Round  33, Global train loss: 1.079, Global test loss: 1.339, Global test accuracy: 51.40
Round  34, Train loss: 1.201, Test loss: 1.424, Test accuracy: 47.20
Round  34, Global train loss: 1.201, Global test loss: 1.348, Global test accuracy: 51.60
Round  35, Train loss: 0.967, Test loss: 1.484, Test accuracy: 46.18
Round  35, Global train loss: 0.967, Global test loss: 1.571, Global test accuracy: 46.60
Round  36, Train loss: 0.983, Test loss: 1.502, Test accuracy: 45.62
Round  36, Global train loss: 0.983, Global test loss: 1.429, Global test accuracy: 45.60
Round  37, Train loss: 0.879, Test loss: 1.549, Test accuracy: 45.28
Round  37, Global train loss: 0.879, Global test loss: 1.600, Global test accuracy: 45.40
Round  38, Train loss: 1.023, Test loss: 1.577, Test accuracy: 44.82
Round  38, Global train loss: 1.023, Global test loss: 1.489, Global test accuracy: 46.60
Round  39, Train loss: 1.129, Test loss: 1.600, Test accuracy: 44.46
Round  39, Global train loss: 1.129, Global test loss: 1.325, Global test accuracy: 49.20
Round  40, Train loss: 0.924, Test loss: 1.623, Test accuracy: 43.74
Round  40, Global train loss: 0.924, Global test loss: 1.526, Global test accuracy: 45.60
Round  41, Train loss: 0.856, Test loss: 1.646, Test accuracy: 43.20
Round  41, Global train loss: 0.856, Global test loss: 1.477, Global test accuracy: 46.20
Round  42, Train loss: 0.824, Test loss: 1.615, Test accuracy: 44.18
Round  42, Global train loss: 0.824, Global test loss: 1.576, Global test accuracy: 46.20
Round  43, Train loss: 0.879, Test loss: 1.663, Test accuracy: 43.20
Round  43, Global train loss: 0.879, Global test loss: 1.519, Global test accuracy: 45.20
Round  44, Train loss: 0.951, Test loss: 1.709, Test accuracy: 42.42
Round  44, Global train loss: 0.951, Global test loss: 1.410, Global test accuracy: 47.60
Round  45, Train loss: 0.756, Test loss: 1.724, Test accuracy: 43.46
Round  45, Global train loss: 0.756, Global test loss: 1.540, Global test accuracy: 49.40
Round  46, Train loss: 0.848, Test loss: 1.736, Test accuracy: 43.56
Round  46, Global train loss: 0.848, Global test loss: 1.576, Global test accuracy: 46.60
Round  47, Train loss: 0.750, Test loss: 1.815, Test accuracy: 43.18
Round  47, Global train loss: 0.750, Global test loss: 1.741, Global test accuracy: 43.60
Round  48, Train loss: 0.788, Test loss: 1.835, Test accuracy: 43.10
Round  48, Global train loss: 0.788, Global test loss: 1.700, Global test accuracy: 45.00
Round  49, Train loss: 0.710, Test loss: 1.860, Test accuracy: 43.44
Round  49, Global train loss: 0.710, Global test loss: 1.644, Global test accuracy: 44.00
Round  50, Train loss: 0.639, Test loss: 1.876, Test accuracy: 41.82
Round  50, Global train loss: 0.639, Global test loss: 1.786, Global test accuracy: 41.80
Round  51, Train loss: 0.838, Test loss: 1.895, Test accuracy: 42.10
Round  51, Global train loss: 0.838, Global test loss: 1.491, Global test accuracy: 43.60
Round  52, Train loss: 0.756, Test loss: 1.985, Test accuracy: 40.52
Round  52, Global train loss: 0.756, Global test loss: 1.526, Global test accuracy: 47.00
Round  53, Train loss: 0.766, Test loss: 1.981, Test accuracy: 40.84
Round  53, Global train loss: 0.766, Global test loss: 1.483, Global test accuracy: 47.60
Round  54, Train loss: 0.617, Test loss: 2.006, Test accuracy: 40.30
Round  54, Global train loss: 0.617, Global test loss: 1.868, Global test accuracy: 44.80
Round  55, Train loss: 0.677, Test loss: 2.022, Test accuracy: 41.88
Round  55, Global train loss: 0.677, Global test loss: 1.665, Global test accuracy: 46.80
Round  56, Train loss: 0.537, Test loss: 2.031, Test accuracy: 42.38
Round  56, Global train loss: 0.537, Global test loss: 1.882, Global test accuracy: 46.60
Round  57, Train loss: 0.587, Test loss: 2.030, Test accuracy: 42.50
Round  57, Global train loss: 0.587, Global test loss: 1.665, Global test accuracy: 50.40
Round  58, Train loss: 0.600, Test loss: 2.083, Test accuracy: 42.30
Round  58, Global train loss: 0.600, Global test loss: 1.917, Global test accuracy: 45.40
Round  59, Train loss: 0.535, Test loss: 2.100, Test accuracy: 42.54
Round  59, Global train loss: 0.535, Global test loss: 1.818, Global test accuracy: 44.00
Round  60, Train loss: 0.595, Test loss: 2.123, Test accuracy: 41.98
Round  60, Global train loss: 0.595, Global test loss: 1.687, Global test accuracy: 46.80
Round  61, Train loss: 0.531, Test loss: 2.151, Test accuracy: 41.34
Round  61, Global train loss: 0.531, Global test loss: 1.979, Global test accuracy: 39.60
Round  62, Train loss: 0.476, Test loss: 2.195, Test accuracy: 40.98
Round  62, Global train loss: 0.476, Global test loss: 2.025, Global test accuracy: 43.60
Round  63, Train loss: 0.509, Test loss: 2.236, Test accuracy: 41.48
Round  63, Global train loss: 0.509, Global test loss: 2.019, Global test accuracy: 44.80
Round  64, Train loss: 0.579, Test loss: 2.250, Test accuracy: 40.78
Round  64, Global train loss: 0.579, Global test loss: 1.807, Global test accuracy: 44.80
Round  65, Train loss: 0.455, Test loss: 2.244, Test accuracy: 41.44
Round  65, Global train loss: 0.455, Global test loss: 1.883, Global test accuracy: 48.80
Round  66, Train loss: 0.451, Test loss: 2.264, Test accuracy: 41.84
Round  66, Global train loss: 0.451, Global test loss: 1.926, Global test accuracy: 45.80
Round  67, Train loss: 0.400, Test loss: 2.362, Test accuracy: 41.02
Round  67, Global train loss: 0.400, Global test loss: 2.230, Global test accuracy: 42.80
Round  68, Train loss: 0.450, Test loss: 2.468, Test accuracy: 40.44
Round  68, Global train loss: 0.450, Global test loss: 2.211, Global test accuracy: 43.20
Round  69, Train loss: 0.510, Test loss: 2.474, Test accuracy: 41.14
Round  69, Global train loss: 0.510, Global test loss: 1.895, Global test accuracy: 47.80
Round  70, Train loss: 0.384, Test loss: 2.470, Test accuracy: 41.84
Round  70, Global train loss: 0.384, Global test loss: 2.321, Global test accuracy: 44.40
Round  71, Train loss: 0.396, Test loss: 2.488, Test accuracy: 42.30
Round  71, Global train loss: 0.396, Global test loss: 2.246, Global test accuracy: 44.00
Round  72, Train loss: 0.405, Test loss: 2.529, Test accuracy: 42.74
Round  72, Global train loss: 0.405, Global test loss: 2.108, Global test accuracy: 46.60
Round  73, Train loss: 0.323, Test loss: 2.468, Test accuracy: 42.44
Round  73, Global train loss: 0.323, Global test loss: 2.230, Global test accuracy: 45.40
Round  74, Train loss: 0.389, Test loss: 2.552, Test accuracy: 42.32
Round  74, Global train loss: 0.389, Global test loss: 2.150, Global test accuracy: 46.20
Round  75, Train loss: 0.397, Test loss: 2.524, Test accuracy: 42.92
Round  75, Global train loss: 0.397, Global test loss: 2.201, Global test accuracy: 44.60
Round  76, Train loss: 0.315, Test loss: 2.538, Test accuracy: 43.40
Round  76, Global train loss: 0.315, Global test loss: 2.287, Global test accuracy: 44.00
Round  77, Train loss: 0.335, Test loss: 2.512, Test accuracy: 42.86
Round  77, Global train loss: 0.335, Global test loss: 2.093, Global test accuracy: 44.80
Round  78, Train loss: 0.369, Test loss: 2.554, Test accuracy: 42.94
Round  78, Global train loss: 0.369, Global test loss: 2.053, Global test accuracy: 45.40
Round  79, Train loss: 0.348, Test loss: 2.662, Test accuracy: 42.42
Round  79, Global train loss: 0.348, Global test loss: 2.185, Global test accuracy: 43.20
Round  80, Train loss: 0.370, Test loss: 2.789, Test accuracy: 42.06
Round  80, Global train loss: 0.370, Global test loss: 2.360, Global test accuracy: 43.80
Round  81, Train loss: 0.405, Test loss: 2.759, Test accuracy: 42.38
Round  81, Global train loss: 0.405, Global test loss: 2.137, Global test accuracy: 42.80
Round  82, Train loss: 0.283, Test loss: 2.658, Test accuracy: 43.28
Round  82, Global train loss: 0.283, Global test loss: 2.490, Global test accuracy: 47.40
Round  83, Train loss: 0.334, Test loss: 2.690, Test accuracy: 43.02
Round  83, Global train loss: 0.334, Global test loss: 2.418, Global test accuracy: 42.80
Round  84, Train loss: 0.304, Test loss: 2.736, Test accuracy: 42.80
Round  84, Global train loss: 0.304, Global test loss: 2.561, Global test accuracy: 42.00
Round  85, Train loss: 0.292, Test loss: 2.809, Test accuracy: 42.36
Round  85, Global train loss: 0.292, Global test loss: 2.699, Global test accuracy: 40.40
Round  86, Train loss: 0.229, Test loss: 2.851, Test accuracy: 42.46
Round  86, Global train loss: 0.229, Global test loss: 2.912, Global test accuracy: 42.40
Round  87, Train loss: 0.262, Test loss: 2.898, Test accuracy: 42.48
Round  87, Global train loss: 0.262, Global test loss: 2.700, Global test accuracy: 43.40
Round  88, Train loss: 0.147, Test loss: 2.872, Test accuracy: 42.44
Round  88, Global train loss: 0.147, Global test loss: 3.072, Global test accuracy: 41.20
Round  89, Train loss: 0.223, Test loss: 2.908, Test accuracy: 42.54
Round  89, Global train loss: 0.223, Global test loss: 2.768, Global test accuracy: 41.80
Round  90, Train loss: 0.318, Test loss: 2.868, Test accuracy: 42.28
Round  90, Global train loss: 0.318, Global test loss: 2.293, Global test accuracy: 44.20
Round  91, Train loss: 0.395, Test loss: 2.921, Test accuracy: 41.50
Round  91, Global train loss: 0.395, Global test loss: 2.114, Global test accuracy: 43.80
Round  92, Train loss: 0.283, Test loss: 2.893, Test accuracy: 41.60
Round  92, Global train loss: 0.283, Global test loss: 2.304, Global test accuracy: 43.80
Round  93, Train loss: 0.185, Test loss: 2.917, Test accuracy: 41.58
Round  93, Global train loss: 0.185, Global test loss: 2.867, Global test accuracy: 44.80
Round  94, Train loss: 0.324, Test loss: 2.927, Test accuracy: 41.92
Round  94, Global train loss: 0.324, Global test loss: 2.253, Global test accuracy: 41.00
Round  95, Train loss: 0.243, Test loss: 2.957, Test accuracy: 42.58
Round  95, Global train loss: 0.243, Global test loss: 2.606, Global test accuracy: 46.80
Round  96, Train loss: 0.172, Test loss: 2.961, Test accuracy: 41.90
Round  96, Global train loss: 0.172, Global test loss: 2.857, Global test accuracy: 43.60
Round  97, Train loss: 0.297, Test loss: 3.014, Test accuracy: 41.72
Round  97, Global train loss: 0.297, Global test loss: 2.404, Global test accuracy: 41.80
Round  98, Train loss: 0.217, Test loss: 3.052, Test accuracy: 41.86
Round  98, Global train loss: 0.217, Global test loss: 2.725, Global test accuracy: 44.00
Round  99, Train loss: 0.230, Test loss: 3.050, Test accuracy: 41.06
Round  99, Global train loss: 0.230, Global test loss: 2.829, Global test accuracy: 43.00
Final Round, Train loss: 0.204, Test loss: 3.224, Test accuracy: 39.30
Final Round, Global train loss: 0.204, Global test loss: 2.829, Global test accuracy: 43.00
Average accuracy final 10 rounds: 41.8
Average global accuracy final 10 rounds: 43.67999999999999
1207.9663767814636
[3.1520943641662598, 5.9888014793396, 8.807656526565552, 11.682722330093384, 14.561914920806885, 17.407304048538208, 20.330585479736328, 23.148499488830566, 26.03232979774475, 28.88863706588745, 31.802170991897583, 34.68006706237793, 37.52754235267639, 40.31028938293457, 43.183043479919434, 46.09656858444214, 48.95438361167908, 51.797197341918945, 54.70881366729736, 57.564594745635986, 60.54150104522705, 63.42882442474365, 66.38357520103455, 69.24198627471924, 72.09241056442261, 74.98461556434631, 77.90047526359558, 80.81867623329163, 83.66439580917358, 86.53216218948364, 89.3620274066925, 92.27180194854736, 95.1431097984314, 97.98810839653015, 100.89872717857361, 103.80268430709839, 106.69436359405518, 109.56400847434998, 112.32468342781067, 115.1890766620636, 118.01468992233276, 120.79705238342285, 123.63908553123474, 126.55278253555298, 129.46504950523376, 132.33930683135986, 135.16241979599, 138.02223300933838, 140.90890312194824, 143.74544095993042, 146.6429886817932, 149.56569027900696, 152.4720664024353, 155.34878253936768, 158.34716534614563, 161.25878286361694, 164.29863905906677, 167.25882363319397, 170.35865712165833, 173.55555820465088, 176.75486993789673, 179.93545198440552, 183.14395117759705, 186.31815910339355, 189.52534198760986, 192.58587980270386, 195.64150071144104, 198.82683157920837, 201.88425850868225, 204.96488523483276, 208.03664660453796, 211.11178278923035, 214.0914704799652, 217.08963584899902, 219.94118118286133, 222.98414874076843, 225.9230833053589, 228.94213557243347, 232.05327367782593, 235.076322555542, 238.09209275245667, 241.1395456790924, 244.12904238700867, 247.16062545776367, 250.18721294403076, 253.25448179244995, 256.32013869285583, 259.32326316833496, 262.5355112552643, 265.58512115478516, 268.72579765319824, 271.791202545166, 274.7890090942383, 277.8437993526459, 280.9257118701935, 284.004695892334, 287.01842212677, 290.05504846572876, 293.2647657394409, 296.36037158966064, 301.72315526008606]
[32.7, 36.24, 40.06, 41.88, 43.8, 44.64, 46.1, 45.64, 48.78, 49.68, 49.14, 50.06, 50.62, 50.22, 51.44, 52.88, 51.42, 51.44, 50.14, 50.58, 50.22, 49.84, 51.24, 50.72, 50.8, 49.78, 49.54, 49.4, 48.7, 48.34, 47.38, 47.28, 47.54, 47.7, 47.2, 46.18, 45.62, 45.28, 44.82, 44.46, 43.74, 43.2, 44.18, 43.2, 42.42, 43.46, 43.56, 43.18, 43.1, 43.44, 41.82, 42.1, 40.52, 40.84, 40.3, 41.88, 42.38, 42.5, 42.3, 42.54, 41.98, 41.34, 40.98, 41.48, 40.78, 41.44, 41.84, 41.02, 40.44, 41.14, 41.84, 42.3, 42.74, 42.44, 42.32, 42.92, 43.4, 42.86, 42.94, 42.42, 42.06, 42.38, 43.28, 43.02, 42.8, 42.36, 42.46, 42.48, 42.44, 42.54, 42.28, 41.5, 41.6, 41.58, 41.92, 42.58, 41.9, 41.72, 41.86, 41.06, 39.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.619, Test loss: 1.555, Test accuracy: 33.96
Round   0, Global train loss: 1.619, Global test loss: 1.554, Global test accuracy: 34.00
Round   1, Train loss: 1.570, Test loss: 1.470, Test accuracy: 38.98
Round   1, Global train loss: 1.570, Global test loss: 1.467, Global test accuracy: 38.20
Round   2, Train loss: 1.518, Test loss: 1.436, Test accuracy: 42.28
Round   2, Global train loss: 1.518, Global test loss: 1.425, Global test accuracy: 41.60
Round   3, Train loss: 1.557, Test loss: 1.444, Test accuracy: 42.32
Round   3, Global train loss: 1.557, Global test loss: 1.438, Global test accuracy: 41.80
Round   4, Train loss: 1.555, Test loss: 1.444, Test accuracy: 45.42
Round   4, Global train loss: 1.555, Global test loss: 1.441, Global test accuracy: 45.40
Round   5, Train loss: 1.488, Test loss: 1.399, Test accuracy: 47.38
Round   5, Global train loss: 1.488, Global test loss: 1.373, Global test accuracy: 46.20
Round   6, Train loss: 1.524, Test loss: 1.373, Test accuracy: 47.32
Round   6, Global train loss: 1.524, Global test loss: 1.352, Global test accuracy: 45.40
Round   7, Train loss: 1.502, Test loss: 1.339, Test accuracy: 48.68
Round   7, Global train loss: 1.502, Global test loss: 1.310, Global test accuracy: 47.80
Round   8, Train loss: 1.538, Test loss: 1.359, Test accuracy: 51.46
Round   8, Global train loss: 1.538, Global test loss: 1.362, Global test accuracy: 55.00
Round   9, Train loss: 1.492, Test loss: 1.328, Test accuracy: 52.28
Round   9, Global train loss: 1.492, Global test loss: 1.295, Global test accuracy: 54.20
Round  10, Train loss: 1.507, Test loss: 1.347, Test accuracy: 51.12
Round  10, Global train loss: 1.507, Global test loss: 1.315, Global test accuracy: 49.00
Round  11, Train loss: 1.454, Test loss: 1.322, Test accuracy: 50.56
Round  11, Global train loss: 1.454, Global test loss: 1.299, Global test accuracy: 47.80
Round  12, Train loss: 1.469, Test loss: 1.301, Test accuracy: 55.32
Round  12, Global train loss: 1.469, Global test loss: 1.242, Global test accuracy: 59.00
Round  13, Train loss: 1.497, Test loss: 1.330, Test accuracy: 53.40
Round  13, Global train loss: 1.497, Global test loss: 1.320, Global test accuracy: 52.40
Round  14, Train loss: 1.517, Test loss: 1.329, Test accuracy: 52.54
Round  14, Global train loss: 1.517, Global test loss: 1.314, Global test accuracy: 52.80
Round  15, Train loss: 1.484, Test loss: 1.346, Test accuracy: 48.46
Round  15, Global train loss: 1.484, Global test loss: 1.332, Global test accuracy: 48.80
Round  16, Train loss: 1.437, Test loss: 1.310, Test accuracy: 49.94
Round  16, Global train loss: 1.437, Global test loss: 1.264, Global test accuracy: 51.20
Round  17, Train loss: 1.413, Test loss: 1.309, Test accuracy: 51.22
Round  17, Global train loss: 1.413, Global test loss: 1.265, Global test accuracy: 50.60
Round  18, Train loss: 1.468, Test loss: 1.298, Test accuracy: 50.22
Round  18, Global train loss: 1.468, Global test loss: 1.278, Global test accuracy: 54.00
Round  19, Train loss: 1.458, Test loss: 1.280, Test accuracy: 54.18
Round  19, Global train loss: 1.458, Global test loss: 1.238, Global test accuracy: 56.80
Round  20, Train loss: 1.373, Test loss: 1.266, Test accuracy: 54.68
Round  20, Global train loss: 1.373, Global test loss: 1.211, Global test accuracy: 57.40
Round  21, Train loss: 1.482, Test loss: 1.278, Test accuracy: 53.58
Round  21, Global train loss: 1.482, Global test loss: 1.265, Global test accuracy: 57.60
Round  22, Train loss: 1.427, Test loss: 1.288, Test accuracy: 54.08
Round  22, Global train loss: 1.427, Global test loss: 1.249, Global test accuracy: 59.60
Round  23, Train loss: 1.455, Test loss: 1.273, Test accuracy: 52.28
Round  23, Global train loss: 1.455, Global test loss: 1.227, Global test accuracy: 56.60
Round  24, Train loss: 1.397, Test loss: 1.236, Test accuracy: 53.72
Round  24, Global train loss: 1.397, Global test loss: 1.198, Global test accuracy: 53.60
Round  25, Train loss: 1.389, Test loss: 1.273, Test accuracy: 52.90
Round  25, Global train loss: 1.389, Global test loss: 1.246, Global test accuracy: 54.80
Round  26, Train loss: 1.442, Test loss: 1.270, Test accuracy: 54.56
Round  26, Global train loss: 1.442, Global test loss: 1.238, Global test accuracy: 57.60
Round  27, Train loss: 1.424, Test loss: 1.274, Test accuracy: 54.28
Round  27, Global train loss: 1.424, Global test loss: 1.249, Global test accuracy: 56.00
Round  28, Train loss: 1.424, Test loss: 1.255, Test accuracy: 54.10
Round  28, Global train loss: 1.424, Global test loss: 1.218, Global test accuracy: 57.20
Round  29, Train loss: 1.414, Test loss: 1.272, Test accuracy: 54.22
Round  29, Global train loss: 1.414, Global test loss: 1.244, Global test accuracy: 59.40
Round  30, Train loss: 1.428, Test loss: 1.320, Test accuracy: 50.58
Round  30, Global train loss: 1.428, Global test loss: 1.330, Global test accuracy: 52.60
Round  31, Train loss: 1.363, Test loss: 1.284, Test accuracy: 51.90
Round  31, Global train loss: 1.363, Global test loss: 1.246, Global test accuracy: 55.00
Round  32, Train loss: 1.340, Test loss: 1.289, Test accuracy: 49.00
Round  32, Global train loss: 1.340, Global test loss: 1.274, Global test accuracy: 47.20
Round  33, Train loss: 1.278, Test loss: 1.226, Test accuracy: 54.42
Round  33, Global train loss: 1.278, Global test loss: 1.158, Global test accuracy: 56.00
Round  34, Train loss: 1.385, Test loss: 1.241, Test accuracy: 54.96
Round  34, Global train loss: 1.385, Global test loss: 1.225, Global test accuracy: 57.20
Round  35, Train loss: 1.358, Test loss: 1.348, Test accuracy: 47.32
Round  35, Global train loss: 1.358, Global test loss: 1.366, Global test accuracy: 49.00
Round  36, Train loss: 1.373, Test loss: 1.320, Test accuracy: 47.54
Round  36, Global train loss: 1.373, Global test loss: 1.323, Global test accuracy: 46.40
Round  37, Train loss: 1.254, Test loss: 1.304, Test accuracy: 46.78
Round  37, Global train loss: 1.254, Global test loss: 1.291, Global test accuracy: 43.40
Round  38, Train loss: 1.361, Test loss: 1.304, Test accuracy: 48.24
Round  38, Global train loss: 1.361, Global test loss: 1.303, Global test accuracy: 46.80
Round  39, Train loss: 1.364, Test loss: 1.240, Test accuracy: 54.80
Round  39, Global train loss: 1.364, Global test loss: 1.192, Global test accuracy: 56.80
Round  40, Train loss: 1.281, Test loss: 1.257, Test accuracy: 50.36
Round  40, Global train loss: 1.281, Global test loss: 1.219, Global test accuracy: 50.80
Round  41, Train loss: 1.236, Test loss: 1.257, Test accuracy: 50.06
Round  41, Global train loss: 1.236, Global test loss: 1.234, Global test accuracy: 49.20
Round  42, Train loss: 1.274, Test loss: 1.285, Test accuracy: 49.06
Round  42, Global train loss: 1.274, Global test loss: 1.274, Global test accuracy: 50.00
Round  43, Train loss: 1.197, Test loss: 1.216, Test accuracy: 53.58
Round  43, Global train loss: 1.197, Global test loss: 1.157, Global test accuracy: 54.20
Round  44, Train loss: 1.224, Test loss: 1.211, Test accuracy: 54.14
Round  44, Global train loss: 1.224, Global test loss: 1.164, Global test accuracy: 54.00
Round  45, Train loss: 1.210, Test loss: 1.318, Test accuracy: 47.32
Round  45, Global train loss: 1.210, Global test loss: 1.294, Global test accuracy: 48.00
Round  46, Train loss: 1.256, Test loss: 1.356, Test accuracy: 44.84
Round  46, Global train loss: 1.256, Global test loss: 1.335, Global test accuracy: 45.00
Round  47, Train loss: 1.159, Test loss: 1.341, Test accuracy: 45.20
Round  47, Global train loss: 1.159, Global test loss: 1.296, Global test accuracy: 44.20
Round  48, Train loss: 1.201, Test loss: 1.310, Test accuracy: 48.30
Round  48, Global train loss: 1.201, Global test loss: 1.270, Global test accuracy: 48.60
Round  49, Train loss: 1.170, Test loss: 1.324, Test accuracy: 47.84
Round  49, Global train loss: 1.170, Global test loss: 1.266, Global test accuracy: 50.80
Round  50, Train loss: 1.062, Test loss: 1.355, Test accuracy: 45.08
Round  50, Global train loss: 1.062, Global test loss: 1.352, Global test accuracy: 44.80
Round  51, Train loss: 1.212, Test loss: 1.307, Test accuracy: 48.04
Round  51, Global train loss: 1.212, Global test loss: 1.266, Global test accuracy: 50.80
Round  52, Train loss: 1.164, Test loss: 1.337, Test accuracy: 46.52
Round  52, Global train loss: 1.164, Global test loss: 1.294, Global test accuracy: 49.40
Round  53, Train loss: 1.100, Test loss: 1.200, Test accuracy: 53.70
Round  53, Global train loss: 1.100, Global test loss: 1.138, Global test accuracy: 55.60
Round  54, Train loss: 1.023, Test loss: 1.319, Test accuracy: 46.52
Round  54, Global train loss: 1.023, Global test loss: 1.312, Global test accuracy: 45.40
Round  55, Train loss: 1.135, Test loss: 1.328, Test accuracy: 46.76
Round  55, Global train loss: 1.135, Global test loss: 1.280, Global test accuracy: 48.80
Round  56, Train loss: 1.045, Test loss: 1.359, Test accuracy: 47.42
Round  56, Global train loss: 1.045, Global test loss: 1.348, Global test accuracy: 47.80
Round  57, Train loss: 1.000, Test loss: 1.271, Test accuracy: 49.34
Round  57, Global train loss: 1.000, Global test loss: 1.257, Global test accuracy: 47.80
Round  58, Train loss: 1.075, Test loss: 1.362, Test accuracy: 46.96
Round  58, Global train loss: 1.075, Global test loss: 1.329, Global test accuracy: 46.80
Round  59, Train loss: 1.000, Test loss: 1.369, Test accuracy: 43.28
Round  59, Global train loss: 1.000, Global test loss: 1.336, Global test accuracy: 43.40
Round  60, Train loss: 1.008, Test loss: 1.283, Test accuracy: 50.36
Round  60, Global train loss: 1.008, Global test loss: 1.241, Global test accuracy: 51.60
Round  61, Train loss: 0.976, Test loss: 1.411, Test accuracy: 46.04
Round  61, Global train loss: 0.976, Global test loss: 1.377, Global test accuracy: 45.80
Round  62, Train loss: 0.860, Test loss: 1.428, Test accuracy: 44.62
Round  62, Global train loss: 0.860, Global test loss: 1.472, Global test accuracy: 44.80
Round  63, Train loss: 0.936, Test loss: 1.397, Test accuracy: 46.66
Round  63, Global train loss: 0.936, Global test loss: 1.354, Global test accuracy: 46.80
Round  64, Train loss: 0.983, Test loss: 1.314, Test accuracy: 49.24
Round  64, Global train loss: 0.983, Global test loss: 1.251, Global test accuracy: 49.40
Round  65, Train loss: 0.925, Test loss: 1.484, Test accuracy: 41.50
Round  65, Global train loss: 0.925, Global test loss: 1.455, Global test accuracy: 40.60
Round  66, Train loss: 0.900, Test loss: 1.487, Test accuracy: 43.66
Round  66, Global train loss: 0.900, Global test loss: 1.454, Global test accuracy: 43.40
Round  67, Train loss: 0.837, Test loss: 1.500, Test accuracy: 44.06
Round  67, Global train loss: 0.837, Global test loss: 1.445, Global test accuracy: 46.40
Round  68, Train loss: 0.878, Test loss: 1.541, Test accuracy: 43.44
Round  68, Global train loss: 0.878, Global test loss: 1.504, Global test accuracy: 43.60
Round  69, Train loss: 0.949, Test loss: 1.387, Test accuracy: 47.38
Round  69, Global train loss: 0.949, Global test loss: 1.236, Global test accuracy: 50.80
Round  70, Train loss: 0.808, Test loss: 1.730, Test accuracy: 39.06
Round  70, Global train loss: 0.808, Global test loss: 1.794, Global test accuracy: 36.40
Round  71, Train loss: 0.738, Test loss: 1.594, Test accuracy: 42.86
Round  71, Global train loss: 0.738, Global test loss: 1.634, Global test accuracy: 43.60
Round  72, Train loss: 0.881, Test loss: 1.562, Test accuracy: 41.94
Round  72, Global train loss: 0.881, Global test loss: 1.492, Global test accuracy: 43.00
Round  73, Train loss: 0.698, Test loss: 1.496, Test accuracy: 44.86
Round  73, Global train loss: 0.698, Global test loss: 1.484, Global test accuracy: 45.60
Round  74, Train loss: 0.761, Test loss: 1.471, Test accuracy: 45.42
Round  74, Global train loss: 0.761, Global test loss: 1.450, Global test accuracy: 46.20
Round  75, Train loss: 0.778, Test loss: 1.571, Test accuracy: 44.86
Round  75, Global train loss: 0.778, Global test loss: 1.560, Global test accuracy: 44.80
Round  76, Train loss: 0.718, Test loss: 1.616, Test accuracy: 43.34
Round  76, Global train loss: 0.718, Global test loss: 1.606, Global test accuracy: 45.20
Round  77, Train loss: 0.690, Test loss: 1.555, Test accuracy: 47.38
Round  77, Global train loss: 0.690, Global test loss: 1.559, Global test accuracy: 49.20
Round  78, Train loss: 0.720, Test loss: 1.513, Test accuracy: 48.38
Round  78, Global train loss: 0.720, Global test loss: 1.443, Global test accuracy: 50.20
Round  79, Train loss: 0.716, Test loss: 1.499, Test accuracy: 47.22
Round  79, Global train loss: 0.716, Global test loss: 1.414, Global test accuracy: 48.60
Round  80, Train loss: 0.701, Test loss: 1.609, Test accuracy: 43.72
Round  80, Global train loss: 0.701, Global test loss: 1.489, Global test accuracy: 45.80
Round  81, Train loss: 0.726, Test loss: 1.576, Test accuracy: 44.14
Round  81, Global train loss: 0.726, Global test loss: 1.448, Global test accuracy: 45.60
Round  82, Train loss: 0.527, Test loss: 1.648, Test accuracy: 45.94
Round  82, Global train loss: 0.527, Global test loss: 1.845, Global test accuracy: 46.00
Round  83, Train loss: 0.666, Test loss: 1.644, Test accuracy: 43.82
Round  83, Global train loss: 0.666, Global test loss: 1.630, Global test accuracy: 43.60
Round  84, Train loss: 0.659, Test loss: 1.697, Test accuracy: 43.32
Round  84, Global train loss: 0.659, Global test loss: 1.679, Global test accuracy: 43.40
Round  85, Train loss: 0.538, Test loss: 1.807, Test accuracy: 40.80
Round  85, Global train loss: 0.538, Global test loss: 1.821, Global test accuracy: 41.60
Round  86, Train loss: 0.526, Test loss: 1.927, Test accuracy: 39.16
Round  86, Global train loss: 0.526, Global test loss: 1.977, Global test accuracy: 39.00
Round  87, Train loss: 0.555, Test loss: 1.974, Test accuracy: 39.44
Round  87, Global train loss: 0.555, Global test loss: 1.941, Global test accuracy: 37.60
Round  88, Train loss: 0.434, Test loss: 1.965, Test accuracy: 38.54
Round  88, Global train loss: 0.434, Global test loss: 2.036, Global test accuracy: 38.60
Round  89, Train loss: 0.433, Test loss: 1.856, Test accuracy: 40.22
Round  89, Global train loss: 0.433, Global test loss: 2.024, Global test accuracy: 42.80
Round  90, Train loss: 0.581, Test loss: 1.868, Test accuracy: 40.04
Round  90, Global train loss: 0.581, Global test loss: 1.813, Global test accuracy: 40.00
Round  91, Train loss: 0.713, Test loss: 1.737, Test accuracy: 41.56
Round  91, Global train loss: 0.713, Global test loss: 1.518, Global test accuracy: 43.00
Round  92, Train loss: 0.603, Test loss: 1.599, Test accuracy: 45.16
Round  92, Global train loss: 0.603, Global test loss: 1.411, Global test accuracy: 49.20
Round  93, Train loss: 0.440, Test loss: 1.767, Test accuracy: 44.22
Round  93, Global train loss: 0.440, Global test loss: 1.900, Global test accuracy: 44.20
Round  94, Train loss: 0.602, Test loss: 1.966, Test accuracy: 39.56
Round  94, Global train loss: 0.602, Global test loss: 1.883, Global test accuracy: 39.60
Round  95, Train loss: 0.521, Test loss: 1.757, Test accuracy: 43.46
Round  95, Global train loss: 0.521, Global test loss: 1.826, Global test accuracy: 44.40
Round  96, Train loss: 0.363, Test loss: 1.946, Test accuracy: 41.78
Round  96, Global train loss: 0.363, Global test loss: 2.129, Global test accuracy: 41.80
Round  97, Train loss: 0.613, Test loss: 1.867, Test accuracy: 41.20
Round  97, Global train loss: 0.613, Global test loss: 1.787, Global test accuracy: 40.60
Round  98, Train loss: 0.431, Test loss: 1.928, Test accuracy: 43.28
Round  98, Global train loss: 0.431, Global test loss: 2.048, Global test accuracy: 42.60
Round  99, Train loss: 0.447, Test loss: 2.059, Test accuracy: 39.72
Round  99, Global train loss: 0.447, Global test loss: 2.164, Global test accuracy: 39.40
Final Round, Train loss: 0.422, Test loss: 2.128, Test accuracy: 40.12
Final Round, Global train loss: 0.422, Global test loss: 2.164, Global test accuracy: 39.40
Average accuracy final 10 rounds: 41.998000000000005
714.5392880439758
[1.7223713397979736, 3.1856091022491455, 4.577566385269165, 6.026440143585205, 7.377535581588745, 8.77111291885376, 10.202844142913818, 11.607925415039062, 13.010655879974365, 14.405401468276978, 15.766775131225586, 17.2067129611969, 18.5842604637146, 19.92654061317444, 21.319233179092407, 22.711768627166748, 24.144718647003174, 25.526888608932495, 26.96768832206726, 28.345563650131226, 29.73784852027893, 31.10661005973816, 32.50079846382141, 33.935478925704956, 35.54212832450867, 36.93947148323059, 38.35178804397583, 39.74492025375366, 41.14379572868347, 42.53740954399109, 43.94614815711975, 45.334402084350586, 46.71669340133667, 48.18414926528931, 49.5919668674469, 50.95344400405884, 52.38011121749878, 53.81546115875244, 55.15887904167175, 56.53266191482544, 57.95567798614502, 59.528319120407104, 60.891372203826904, 62.265843868255615, 63.654032707214355, 65.04213285446167, 66.4427981376648, 67.80848860740662, 69.18013286590576, 70.61445140838623, 71.97902703285217, 73.3680145740509, 74.78584241867065, 76.15498352050781, 77.52352237701416, 78.92551612854004, 80.32738471031189, 81.70556807518005, 83.0854332447052, 84.70636630058289, 86.11554503440857, 87.53933334350586, 88.9415078163147, 90.36754441261292, 91.76974558830261, 93.1435935497284, 94.56858396530151, 95.99167966842651, 97.36817717552185, 98.75233864784241, 100.18886137008667, 101.5774199962616, 102.95337009429932, 104.3446102142334, 105.80220603942871, 107.19851279258728, 108.62806558609009, 110.02127242088318, 111.44128775596619, 112.90502166748047, 114.28745722770691, 115.73319983482361, 117.20612454414368, 118.65356492996216, 120.06494235992432, 121.47272253036499, 122.89678883552551, 124.30168128013611, 125.65359354019165, 127.01253247261047, 128.36559557914734, 129.79067087173462, 131.1873333454132, 132.62697672843933, 134.23646545410156, 135.63573265075684, 137.02444291114807, 138.4040083885193, 139.75923657417297, 141.2480366230011, 143.47941255569458]
[33.96, 38.98, 42.28, 42.32, 45.42, 47.38, 47.32, 48.68, 51.46, 52.28, 51.12, 50.56, 55.32, 53.4, 52.54, 48.46, 49.94, 51.22, 50.22, 54.18, 54.68, 53.58, 54.08, 52.28, 53.72, 52.9, 54.56, 54.28, 54.1, 54.22, 50.58, 51.9, 49.0, 54.42, 54.96, 47.32, 47.54, 46.78, 48.24, 54.8, 50.36, 50.06, 49.06, 53.58, 54.14, 47.32, 44.84, 45.2, 48.3, 47.84, 45.08, 48.04, 46.52, 53.7, 46.52, 46.76, 47.42, 49.34, 46.96, 43.28, 50.36, 46.04, 44.62, 46.66, 49.24, 41.5, 43.66, 44.06, 43.44, 47.38, 39.06, 42.86, 41.94, 44.86, 45.42, 44.86, 43.34, 47.38, 48.38, 47.22, 43.72, 44.14, 45.94, 43.82, 43.32, 40.8, 39.16, 39.44, 38.54, 40.22, 40.04, 41.56, 45.16, 44.22, 39.56, 43.46, 41.78, 41.2, 43.28, 39.72, 40.12]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.607, Test loss: 1.593, Test accuracy: 27.42
Round   0, Global train loss: 1.607, Global test loss: 1.589, Global test accuracy: 35.40
Round   1, Train loss: 1.574, Test loss: 1.561, Test accuracy: 31.42
Round   1, Global train loss: 1.574, Global test loss: 1.549, Global test accuracy: 39.00
Round   2, Train loss: 1.558, Test loss: 1.511, Test accuracy: 36.62
Round   2, Global train loss: 1.558, Global test loss: 1.492, Global test accuracy: 42.60
Round   3, Train loss: 1.545, Test loss: 1.475, Test accuracy: 40.24
Round   3, Global train loss: 1.545, Global test loss: 1.453, Global test accuracy: 46.40
Round   4, Train loss: 1.536, Test loss: 1.449, Test accuracy: 43.32
Round   4, Global train loss: 1.536, Global test loss: 1.426, Global test accuracy: 47.00
Round   5, Train loss: 1.529, Test loss: 1.433, Test accuracy: 44.40
Round   5, Global train loss: 1.529, Global test loss: 1.407, Global test accuracy: 49.20
Round   6, Train loss: 1.520, Test loss: 1.413, Test accuracy: 45.30
Round   6, Global train loss: 1.520, Global test loss: 1.387, Global test accuracy: 50.20
Round   7, Train loss: 1.517, Test loss: 1.392, Test accuracy: 47.60
Round   7, Global train loss: 1.517, Global test loss: 1.364, Global test accuracy: 51.00
Round   8, Train loss: 1.510, Test loss: 1.379, Test accuracy: 49.06
Round   8, Global train loss: 1.510, Global test loss: 1.351, Global test accuracy: 52.80
Round   9, Train loss: 1.501, Test loss: 1.364, Test accuracy: 49.50
Round   9, Global train loss: 1.501, Global test loss: 1.333, Global test accuracy: 53.60
Round  10, Train loss: 1.512, Test loss: 1.359, Test accuracy: 48.42
Round  10, Global train loss: 1.512, Global test loss: 1.323, Global test accuracy: 52.00
Round  11, Train loss: 1.398, Test loss: 1.377, Test accuracy: 49.16
Round  11, Global train loss: 1.398, Global test loss: 1.336, Global test accuracy: 53.20
Round  12, Train loss: 1.450, Test loss: 1.364, Test accuracy: 49.74
Round  12, Global train loss: 1.450, Global test loss: 1.316, Global test accuracy: 59.40
Round  13, Train loss: 1.355, Test loss: 1.511, Test accuracy: 37.74
Round  13, Global train loss: 1.355, Global test loss: 1.478, Global test accuracy: 38.80
Round  14, Train loss: 1.378, Test loss: 1.448, Test accuracy: 40.64
Round  14, Global train loss: 1.378, Global test loss: 1.379, Global test accuracy: 45.20
Round  15, Train loss: 1.465, Test loss: 1.405, Test accuracy: 44.56
Round  15, Global train loss: 1.465, Global test loss: 1.372, Global test accuracy: 53.40
Round  16, Train loss: 1.442, Test loss: 1.329, Test accuracy: 49.22
Round  16, Global train loss: 1.442, Global test loss: 1.266, Global test accuracy: 55.20
Round  17, Train loss: 1.333, Test loss: 1.350, Test accuracy: 47.46
Round  17, Global train loss: 1.333, Global test loss: 1.290, Global test accuracy: 51.40
Round  18, Train loss: 1.424, Test loss: 1.380, Test accuracy: 45.38
Round  18, Global train loss: 1.424, Global test loss: 1.343, Global test accuracy: 52.20
Round  19, Train loss: 1.361, Test loss: 1.368, Test accuracy: 45.98
Round  19, Global train loss: 1.361, Global test loss: 1.306, Global test accuracy: 49.60
Round  20, Train loss: 1.353, Test loss: 1.348, Test accuracy: 47.68
Round  20, Global train loss: 1.353, Global test loss: 1.278, Global test accuracy: 56.60
Round  21, Train loss: 1.380, Test loss: 1.322, Test accuracy: 48.08
Round  21, Global train loss: 1.380, Global test loss: 1.269, Global test accuracy: 53.20
Round  22, Train loss: 1.363, Test loss: 1.337, Test accuracy: 49.68
Round  22, Global train loss: 1.363, Global test loss: 1.298, Global test accuracy: 53.80
Round  23, Train loss: 1.428, Test loss: 1.327, Test accuracy: 50.02
Round  23, Global train loss: 1.428, Global test loss: 1.299, Global test accuracy: 59.00
Round  24, Train loss: 1.330, Test loss: 1.283, Test accuracy: 51.32
Round  24, Global train loss: 1.330, Global test loss: 1.235, Global test accuracy: 51.00
Round  25, Train loss: 1.331, Test loss: 1.281, Test accuracy: 52.32
Round  25, Global train loss: 1.331, Global test loss: 1.211, Global test accuracy: 56.80
Round  26, Train loss: 1.347, Test loss: 1.307, Test accuracy: 48.56
Round  26, Global train loss: 1.347, Global test loss: 1.273, Global test accuracy: 52.80
Round  27, Train loss: 1.330, Test loss: 1.321, Test accuracy: 47.52
Round  27, Global train loss: 1.330, Global test loss: 1.298, Global test accuracy: 47.20
Round  28, Train loss: 1.324, Test loss: 1.352, Test accuracy: 47.30
Round  28, Global train loss: 1.324, Global test loss: 1.311, Global test accuracy: 50.60
Round  29, Train loss: 1.335, Test loss: 1.332, Test accuracy: 48.74
Round  29, Global train loss: 1.335, Global test loss: 1.278, Global test accuracy: 53.00
Round  30, Train loss: 1.392, Test loss: 1.336, Test accuracy: 47.34
Round  30, Global train loss: 1.392, Global test loss: 1.335, Global test accuracy: 49.20
Round  31, Train loss: 1.257, Test loss: 1.368, Test accuracy: 45.06
Round  31, Global train loss: 1.257, Global test loss: 1.338, Global test accuracy: 50.60
Round  32, Train loss: 1.343, Test loss: 1.288, Test accuracy: 48.44
Round  32, Global train loss: 1.343, Global test loss: 1.239, Global test accuracy: 51.40
Round  33, Train loss: 1.220, Test loss: 1.340, Test accuracy: 46.66
Round  33, Global train loss: 1.220, Global test loss: 1.306, Global test accuracy: 47.60
Round  34, Train loss: 1.266, Test loss: 1.282, Test accuracy: 50.46
Round  34, Global train loss: 1.266, Global test loss: 1.216, Global test accuracy: 57.60
Round  35, Train loss: 1.406, Test loss: 1.337, Test accuracy: 45.38
Round  35, Global train loss: 1.406, Global test loss: 1.333, Global test accuracy: 47.00
Round  36, Train loss: 1.240, Test loss: 1.319, Test accuracy: 45.48
Round  36, Global train loss: 1.240, Global test loss: 1.274, Global test accuracy: 47.80
Round  37, Train loss: 1.269, Test loss: 1.298, Test accuracy: 47.24
Round  37, Global train loss: 1.269, Global test loss: 1.241, Global test accuracy: 48.80
Round  38, Train loss: 1.279, Test loss: 1.286, Test accuracy: 47.78
Round  38, Global train loss: 1.279, Global test loss: 1.250, Global test accuracy: 47.60
Round  39, Train loss: 1.313, Test loss: 1.278, Test accuracy: 47.96
Round  39, Global train loss: 1.313, Global test loss: 1.223, Global test accuracy: 55.40
Round  40, Train loss: 1.238, Test loss: 1.336, Test accuracy: 46.28
Round  40, Global train loss: 1.238, Global test loss: 1.310, Global test accuracy: 52.60
Round  41, Train loss: 1.248, Test loss: 1.252, Test accuracy: 48.36
Round  41, Global train loss: 1.248, Global test loss: 1.181, Global test accuracy: 51.40
Round  42, Train loss: 1.331, Test loss: 1.292, Test accuracy: 47.24
Round  42, Global train loss: 1.331, Global test loss: 1.269, Global test accuracy: 47.60
Round  43, Train loss: 1.248, Test loss: 1.265, Test accuracy: 48.38
Round  43, Global train loss: 1.248, Global test loss: 1.213, Global test accuracy: 49.20
Round  44, Train loss: 1.195, Test loss: 1.311, Test accuracy: 46.60
Round  44, Global train loss: 1.195, Global test loss: 1.240, Global test accuracy: 49.40
Round  45, Train loss: 1.173, Test loss: 1.316, Test accuracy: 46.56
Round  45, Global train loss: 1.173, Global test loss: 1.280, Global test accuracy: 47.80
Round  46, Train loss: 1.258, Test loss: 1.315, Test accuracy: 46.66
Round  46, Global train loss: 1.258, Global test loss: 1.262, Global test accuracy: 48.40
Round  47, Train loss: 1.164, Test loss: 1.206, Test accuracy: 51.14
Round  47, Global train loss: 1.164, Global test loss: 1.157, Global test accuracy: 53.00
Round  48, Train loss: 1.192, Test loss: 1.274, Test accuracy: 47.70
Round  48, Global train loss: 1.192, Global test loss: 1.211, Global test accuracy: 51.80
Round  49, Train loss: 1.151, Test loss: 1.277, Test accuracy: 48.34
Round  49, Global train loss: 1.151, Global test loss: 1.193, Global test accuracy: 54.40
Round  50, Train loss: 1.084, Test loss: 1.329, Test accuracy: 46.18
Round  50, Global train loss: 1.084, Global test loss: 1.285, Global test accuracy: 48.60
Round  51, Train loss: 1.204, Test loss: 1.280, Test accuracy: 47.48
Round  51, Global train loss: 1.204, Global test loss: 1.218, Global test accuracy: 53.60
Round  52, Train loss: 1.211, Test loss: 1.329, Test accuracy: 45.56
Round  52, Global train loss: 1.211, Global test loss: 1.276, Global test accuracy: 48.00
Round  53, Train loss: 1.085, Test loss: 1.240, Test accuracy: 49.42
Round  53, Global train loss: 1.085, Global test loss: 1.158, Global test accuracy: 54.20
Round  54, Train loss: 1.060, Test loss: 1.248, Test accuracy: 48.98
Round  54, Global train loss: 1.060, Global test loss: 1.219, Global test accuracy: 48.60
Round  55, Train loss: 1.195, Test loss: 1.292, Test accuracy: 47.38
Round  55, Global train loss: 1.195, Global test loss: 1.285, Global test accuracy: 48.60
Round  56, Train loss: 1.095, Test loss: 1.321, Test accuracy: 45.78
Round  56, Global train loss: 1.095, Global test loss: 1.305, Global test accuracy: 45.20
Round  57, Train loss: 1.010, Test loss: 1.289, Test accuracy: 46.92
Round  57, Global train loss: 1.010, Global test loss: 1.218, Global test accuracy: 48.60
Round  58, Train loss: 1.091, Test loss: 1.430, Test accuracy: 42.02
Round  58, Global train loss: 1.091, Global test loss: 1.399, Global test accuracy: 43.80
Round  59, Train loss: 1.014, Test loss: 1.399, Test accuracy: 42.76
Round  59, Global train loss: 1.014, Global test loss: 1.352, Global test accuracy: 45.60
Round  60, Train loss: 1.008, Test loss: 1.321, Test accuracy: 46.48
Round  60, Global train loss: 1.008, Global test loss: 1.270, Global test accuracy: 46.00
Round  61, Train loss: 1.019, Test loss: 1.370, Test accuracy: 45.12
Round  61, Global train loss: 1.019, Global test loss: 1.337, Global test accuracy: 45.20
Round  62, Train loss: 0.904, Test loss: 1.353, Test accuracy: 47.08
Round  62, Global train loss: 0.904, Global test loss: 1.313, Global test accuracy: 48.80
Round  63, Train loss: 0.979, Test loss: 1.417, Test accuracy: 44.40
Round  63, Global train loss: 0.979, Global test loss: 1.370, Global test accuracy: 45.40
Round  64, Train loss: 0.919, Test loss: 1.288, Test accuracy: 45.90
Round  64, Global train loss: 0.919, Global test loss: 1.240, Global test accuracy: 46.80
Round  65, Train loss: 0.922, Test loss: 1.287, Test accuracy: 47.74
Round  65, Global train loss: 0.922, Global test loss: 1.213, Global test accuracy: 50.80
Round  66, Train loss: 0.965, Test loss: 1.417, Test accuracy: 44.28
Round  66, Global train loss: 0.965, Global test loss: 1.367, Global test accuracy: 45.00
Round  67, Train loss: 0.921, Test loss: 1.421, Test accuracy: 42.30
Round  67, Global train loss: 0.921, Global test loss: 1.391, Global test accuracy: 43.00
Round  68, Train loss: 0.895, Test loss: 1.437, Test accuracy: 41.52
Round  68, Global train loss: 0.895, Global test loss: 1.401, Global test accuracy: 42.20
Round  69, Train loss: 0.984, Test loss: 1.428, Test accuracy: 42.50
Round  69, Global train loss: 0.984, Global test loss: 1.300, Global test accuracy: 43.80
Round  70, Train loss: 0.896, Test loss: 1.574, Test accuracy: 39.80
Round  70, Global train loss: 0.896, Global test loss: 1.566, Global test accuracy: 39.80
Round  71, Train loss: 0.803, Test loss: 1.400, Test accuracy: 47.62
Round  71, Global train loss: 0.803, Global test loss: 1.363, Global test accuracy: 49.60
Round  72, Train loss: 0.844, Test loss: 1.439, Test accuracy: 44.64
Round  72, Global train loss: 0.844, Global test loss: 1.390, Global test accuracy: 45.20
Round  73, Train loss: 0.752, Test loss: 1.475, Test accuracy: 43.36
Round  73, Global train loss: 0.752, Global test loss: 1.443, Global test accuracy: 42.40
Round  74, Train loss: 0.770, Test loss: 1.488, Test accuracy: 45.38
Round  74, Global train loss: 0.770, Global test loss: 1.433, Global test accuracy: 44.80
Round  75, Train loss: 0.783, Test loss: 1.440, Test accuracy: 45.16
Round  75, Global train loss: 0.783, Global test loss: 1.381, Global test accuracy: 45.80
Round  76, Train loss: 0.759, Test loss: 1.612, Test accuracy: 42.40
Round  76, Global train loss: 0.759, Global test loss: 1.532, Global test accuracy: 43.60
Round  77, Train loss: 0.685, Test loss: 1.477, Test accuracy: 44.86
Round  77, Global train loss: 0.685, Global test loss: 1.420, Global test accuracy: 46.60
Round  78, Train loss: 0.667, Test loss: 1.452, Test accuracy: 45.16
Round  78, Global train loss: 0.667, Global test loss: 1.380, Global test accuracy: 47.40
Round  79, Train loss: 0.727, Test loss: 1.508, Test accuracy: 43.52
Round  79, Global train loss: 0.727, Global test loss: 1.401, Global test accuracy: 43.60
Round  80, Train loss: 0.596, Test loss: 1.552, Test accuracy: 44.10
Round  80, Global train loss: 0.596, Global test loss: 1.651, Global test accuracy: 47.00
Round  81, Train loss: 0.595, Test loss: 1.519, Test accuracy: 44.12
Round  81, Global train loss: 0.595, Global test loss: 1.570, Global test accuracy: 44.60
Round  82, Train loss: 0.529, Test loss: 1.589, Test accuracy: 42.32
Round  82, Global train loss: 0.529, Global test loss: 1.635, Global test accuracy: 43.60
Round  83, Train loss: 0.500, Test loss: 1.611, Test accuracy: 43.76
Round  83, Global train loss: 0.500, Global test loss: 1.724, Global test accuracy: 46.00
Round  84, Train loss: 0.483, Test loss: 1.640, Test accuracy: 42.18
Round  84, Global train loss: 0.483, Global test loss: 1.738, Global test accuracy: 42.60
Round  85, Train loss: 0.458, Test loss: 1.613, Test accuracy: 43.76
Round  85, Global train loss: 0.458, Global test loss: 1.716, Global test accuracy: 45.60
Round  86, Train loss: 0.441, Test loss: 1.610, Test accuracy: 43.34
Round  86, Global train loss: 0.441, Global test loss: 1.733, Global test accuracy: 44.00
Round  87, Train loss: 0.430, Test loss: 1.636, Test accuracy: 43.16
Round  87, Global train loss: 0.430, Global test loss: 1.763, Global test accuracy: 44.60
Round  88, Train loss: 0.407, Test loss: 1.673, Test accuracy: 43.30
Round  88, Global train loss: 0.407, Global test loss: 1.821, Global test accuracy: 45.20
Round  89, Train loss: 0.384, Test loss: 1.729, Test accuracy: 43.04
Round  89, Global train loss: 0.384, Global test loss: 1.908, Global test accuracy: 44.40
Round  90, Train loss: 0.357, Test loss: 1.693, Test accuracy: 42.98
Round  90, Global train loss: 0.357, Global test loss: 1.895, Global test accuracy: 42.80
Round  91, Train loss: 0.348, Test loss: 1.685, Test accuracy: 44.46
Round  91, Global train loss: 0.348, Global test loss: 1.878, Global test accuracy: 44.80
Round  92, Train loss: 0.327, Test loss: 1.766, Test accuracy: 41.92
Round  92, Global train loss: 0.327, Global test loss: 1.963, Global test accuracy: 43.40
Round  93, Train loss: 0.337, Test loss: 1.668, Test accuracy: 43.62
Round  93, Global train loss: 0.337, Global test loss: 1.851, Global test accuracy: 45.20
Round  94, Train loss: 0.321, Test loss: 1.813, Test accuracy: 43.52
Round  94, Global train loss: 0.321, Global test loss: 2.085, Global test accuracy: 43.20
Round  95, Train loss: 0.302, Test loss: 1.707, Test accuracy: 43.60
Round  95, Global train loss: 0.302, Global test loss: 1.922, Global test accuracy: 43.60
Round  96, Train loss: 0.273, Test loss: 1.782, Test accuracy: 43.64
Round  96, Global train loss: 0.273, Global test loss: 2.026, Global test accuracy: 45.20
Round  97, Train loss: 0.287, Test loss: 1.672, Test accuracy: 45.86
Round  97, Global train loss: 0.287, Global test loss: 1.905, Global test accuracy: 46.20
Round  98, Train loss: 0.264, Test loss: 1.815, Test accuracy: 43.00
Round  98, Global train loss: 0.264, Global test loss: 2.077, Global test accuracy: 45.40
Round  99, Train loss: 0.514, Test loss: 1.763, Test accuracy: 43.24
Round  99, Global train loss: 0.514, Global test loss: 1.666, Global test accuracy: 44.60
Final Round, Train loss: 0.436, Test loss: 1.787, Test accuracy: 43.24
Final Round, Global train loss: 0.436, Global test loss: 1.666, Global test accuracy: 44.60
Average accuracy final 10 rounds: 43.583999999999996
1809.0213906764984
[1.9329662322998047, 3.549612522125244, 5.195465564727783, 6.809287786483765, 8.413811683654785, 10.028846263885498, 11.643162965774536, 13.276992082595825, 14.940061569213867, 16.665470838546753, 22.21891760826111, 30.671182870864868, 38.912638425827026, 47.180352210998535, 55.65661668777466, 64.06274151802063, 72.4526777267456, 81.22540616989136, 89.76977562904358, 98.45644354820251, 107.27975058555603, 115.91636729240417, 124.51589703559875, 133.37940168380737, 142.19467306137085, 150.9867284297943, 159.63313508033752, 168.217999458313, 176.98308038711548, 185.62745666503906, 194.29735922813416, 202.93118691444397, 211.1192979812622, 219.890234708786, 228.4999179840088, 237.2081654071808, 245.67649841308594, 254.28471040725708, 263.01883816719055, 271.5992398262024, 280.4103660583496, 281.97945523262024, 290.4595320224762, 298.9556119441986, 307.4218649864197, 316.23331451416016, 324.85869455337524, 326.4243791103363, 334.77806520462036, 343.3195786476135, 351.496230840683, 360.3094062805176, 368.8368854522705, 377.38803458213806, 385.94677543640137, 394.6322901248932, 403.1269874572754, 411.5655765533447, 420.0012357234955, 428.81713485717773, 437.5441987514496, 446.27254843711853, 448.02972054481506, 456.6332757472992, 465.27236819267273, 473.8151071071625, 482.54205989837646, 490.86378264427185, 499.34562373161316, 508.02528071403503, 509.616069316864, 511.1871557235718, 519.7258975505829, 528.5511457920074, 536.8335409164429, 545.1841924190521, 553.597638130188, 562.336626291275, 570.9304256439209, 579.5824859142303, 581.1895816326141, 582.7604656219482, 584.3750426769257, 585.916259765625, 587.5007486343384, 589.1617212295532, 590.8191955089569, 592.3630256652832, 593.9749474525452, 595.6369001865387, 597.412248134613, 599.0136942863464, 600.6244328022003, 602.2146272659302, 603.7970144748688, 605.3712587356567, 606.9591145515442, 608.5481476783752, 610.169055223465, 618.9763865470886, 628.4033854007721]
[27.42, 31.42, 36.62, 40.24, 43.32, 44.4, 45.3, 47.6, 49.06, 49.5, 48.42, 49.16, 49.74, 37.74, 40.64, 44.56, 49.22, 47.46, 45.38, 45.98, 47.68, 48.08, 49.68, 50.02, 51.32, 52.32, 48.56, 47.52, 47.3, 48.74, 47.34, 45.06, 48.44, 46.66, 50.46, 45.38, 45.48, 47.24, 47.78, 47.96, 46.28, 48.36, 47.24, 48.38, 46.6, 46.56, 46.66, 51.14, 47.7, 48.34, 46.18, 47.48, 45.56, 49.42, 48.98, 47.38, 45.78, 46.92, 42.02, 42.76, 46.48, 45.12, 47.08, 44.4, 45.9, 47.74, 44.28, 42.3, 41.52, 42.5, 39.8, 47.62, 44.64, 43.36, 45.38, 45.16, 42.4, 44.86, 45.16, 43.52, 44.1, 44.12, 42.32, 43.76, 42.18, 43.76, 43.34, 43.16, 43.3, 43.04, 42.98, 44.46, 41.92, 43.62, 43.52, 43.6, 43.64, 45.86, 43.0, 43.24, 43.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.608, Test loss: 1.609, Test accuracy: 21.80
Round   0, Global train loss: 1.608, Global test loss: 1.609, Global test accuracy: 21.40
Round   1, Train loss: 1.605, Test loss: 1.608, Test accuracy: 24.84
Round   1, Global train loss: 1.605, Global test loss: 1.606, Global test accuracy: 28.40
Round   2, Train loss: 1.598, Test loss: 1.605, Test accuracy: 25.66
Round   2, Global train loss: 1.598, Global test loss: 1.602, Global test accuracy: 29.60
Round   3, Train loss: 1.597, Test loss: 1.605, Test accuracy: 24.94
Round   3, Global train loss: 1.597, Global test loss: 1.599, Global test accuracy: 27.80
Round   4, Train loss: 1.599, Test loss: 1.602, Test accuracy: 23.74
Round   4, Global train loss: 1.599, Global test loss: 1.598, Global test accuracy: 20.00
Round   5, Train loss: 1.594, Test loss: 1.602, Test accuracy: 23.92
Round   5, Global train loss: 1.594, Global test loss: 1.595, Global test accuracy: 22.60
Round   6, Train loss: 1.597, Test loss: 1.603, Test accuracy: 23.80
Round   6, Global train loss: 1.597, Global test loss: 1.604, Global test accuracy: 20.20
Round   7, Train loss: 1.579, Test loss: 1.602, Test accuracy: 24.90
Round   7, Global train loss: 1.579, Global test loss: 1.593, Global test accuracy: 27.20
Round   8, Train loss: 1.582, Test loss: 1.603, Test accuracy: 23.28
Round   8, Global train loss: 1.582, Global test loss: 1.591, Global test accuracy: 21.40
Round   9, Train loss: 1.543, Test loss: 1.591, Test accuracy: 25.50
Round   9, Global train loss: 1.543, Global test loss: 1.544, Global test accuracy: 39.20
Round  10, Train loss: 1.522, Test loss: 1.592, Test accuracy: 24.80
Round  10, Global train loss: 1.522, Global test loss: 1.537, Global test accuracy: 33.80
Round  11, Train loss: 1.575, Test loss: 1.599, Test accuracy: 23.66
Round  11, Global train loss: 1.575, Global test loss: 1.588, Global test accuracy: 27.40
Round  12, Train loss: 1.551, Test loss: 1.596, Test accuracy: 22.92
Round  12, Global train loss: 1.551, Global test loss: 1.567, Global test accuracy: 29.60
Round  13, Train loss: 1.580, Test loss: 1.599, Test accuracy: 23.50
Round  13, Global train loss: 1.580, Global test loss: 1.604, Global test accuracy: 21.00
Round  14, Train loss: 1.558, Test loss: 1.595, Test accuracy: 24.58
Round  14, Global train loss: 1.558, Global test loss: 1.584, Global test accuracy: 22.60
Round  15, Train loss: 1.567, Test loss: 1.597, Test accuracy: 24.98
Round  15, Global train loss: 1.567, Global test loss: 1.608, Global test accuracy: 23.00
Round  16, Train loss: 1.460, Test loss: 1.592, Test accuracy: 25.92
Round  16, Global train loss: 1.460, Global test loss: 1.461, Global test accuracy: 36.60
Round  17, Train loss: 1.505, Test loss: 1.591, Test accuracy: 26.18
Round  17, Global train loss: 1.505, Global test loss: 1.544, Global test accuracy: 32.60
Round  18, Train loss: 1.451, Test loss: 1.591, Test accuracy: 26.36
Round  18, Global train loss: 1.451, Global test loss: 1.475, Global test accuracy: 39.20
Round  19, Train loss: 1.521, Test loss: 1.584, Test accuracy: 26.46
Round  19, Global train loss: 1.521, Global test loss: 1.569, Global test accuracy: 27.00
Round  20, Train loss: 1.503, Test loss: 1.596, Test accuracy: 25.82
Round  20, Global train loss: 1.503, Global test loss: 1.591, Global test accuracy: 25.00
Round  21, Train loss: 1.464, Test loss: 1.593, Test accuracy: 26.96
Round  21, Global train loss: 1.464, Global test loss: 1.523, Global test accuracy: 32.60
Round  22, Train loss: 1.503, Test loss: 1.584, Test accuracy: 27.68
Round  22, Global train loss: 1.503, Global test loss: 1.573, Global test accuracy: 26.80
Round  23, Train loss: 1.560, Test loss: 1.585, Test accuracy: 26.94
Round  23, Global train loss: 1.560, Global test loss: 1.617, Global test accuracy: 17.40
Round  24, Train loss: 1.547, Test loss: 1.588, Test accuracy: 27.52
Round  24, Global train loss: 1.547, Global test loss: 1.616, Global test accuracy: 18.60
Round  25, Train loss: 1.522, Test loss: 1.592, Test accuracy: 27.22
Round  25, Global train loss: 1.522, Global test loss: 1.611, Global test accuracy: 21.00
Round  26, Train loss: 1.377, Test loss: 1.608, Test accuracy: 26.08
Round  26, Global train loss: 1.377, Global test loss: 1.436, Global test accuracy: 39.20
Round  27, Train loss: 1.549, Test loss: 1.613, Test accuracy: 26.62
Round  27, Global train loss: 1.549, Global test loss: 1.614, Global test accuracy: 21.60
Round  28, Train loss: 1.349, Test loss: 1.631, Test accuracy: 26.38
Round  28, Global train loss: 1.349, Global test loss: 1.426, Global test accuracy: 40.40
Round  29, Train loss: 1.522, Test loss: 1.639, Test accuracy: 26.14
Round  29, Global train loss: 1.522, Global test loss: 1.627, Global test accuracy: 17.40
Round  30, Train loss: 1.431, Test loss: 1.624, Test accuracy: 26.46
Round  30, Global train loss: 1.431, Global test loss: 1.491, Global test accuracy: 34.80
Round  31, Train loss: 1.533, Test loss: 1.627, Test accuracy: 26.66
Round  31, Global train loss: 1.533, Global test loss: 1.601, Global test accuracy: 23.60
Round  32, Train loss: 1.390, Test loss: 1.637, Test accuracy: 27.24
Round  32, Global train loss: 1.390, Global test loss: 1.606, Global test accuracy: 26.80
Round  33, Train loss: 1.458, Test loss: 1.635, Test accuracy: 28.36
Round  33, Global train loss: 1.458, Global test loss: 1.606, Global test accuracy: 25.20
Round  34, Train loss: 1.409, Test loss: 1.662, Test accuracy: 27.12
Round  34, Global train loss: 1.409, Global test loss: 1.513, Global test accuracy: 29.80
Round  35, Train loss: 1.485, Test loss: 1.655, Test accuracy: 26.58
Round  35, Global train loss: 1.485, Global test loss: 1.652, Global test accuracy: 10.80
Round  36, Train loss: 1.375, Test loss: 1.646, Test accuracy: 26.54
Round  36, Global train loss: 1.375, Global test loss: 1.536, Global test accuracy: 35.00
Round  37, Train loss: 1.367, Test loss: 1.658, Test accuracy: 25.98
Round  37, Global train loss: 1.367, Global test loss: 1.621, Global test accuracy: 23.40
Round  38, Train loss: 1.298, Test loss: 1.701, Test accuracy: 25.76
Round  38, Global train loss: 1.298, Global test loss: 1.568, Global test accuracy: 28.40
Round  39, Train loss: 1.353, Test loss: 1.703, Test accuracy: 26.50
Round  39, Global train loss: 1.353, Global test loss: 1.512, Global test accuracy: 33.20
Round  40, Train loss: 1.317, Test loss: 1.711, Test accuracy: 26.56
Round  40, Global train loss: 1.317, Global test loss: 1.503, Global test accuracy: 31.00
Round  41, Train loss: 1.312, Test loss: 1.721, Test accuracy: 26.40
Round  41, Global train loss: 1.312, Global test loss: 1.455, Global test accuracy: 34.40
Round  42, Train loss: 1.218, Test loss: 1.732, Test accuracy: 25.94
Round  42, Global train loss: 1.218, Global test loss: 1.540, Global test accuracy: 29.20
Round  43, Train loss: 1.148, Test loss: 1.746, Test accuracy: 25.88
Round  43, Global train loss: 1.148, Global test loss: 1.432, Global test accuracy: 36.40
Round  44, Train loss: 1.507, Test loss: 1.755, Test accuracy: 25.12
Round  44, Global train loss: 1.507, Global test loss: 1.600, Global test accuracy: 26.80
Round  45, Train loss: 1.464, Test loss: 1.761, Test accuracy: 25.48
Round  45, Global train loss: 1.464, Global test loss: 1.617, Global test accuracy: 21.20
Round  46, Train loss: 1.491, Test loss: 1.768, Test accuracy: 24.98
Round  46, Global train loss: 1.491, Global test loss: 1.607, Global test accuracy: 26.00
Round  47, Train loss: 1.307, Test loss: 1.787, Test accuracy: 25.38
Round  47, Global train loss: 1.307, Global test loss: 1.628, Global test accuracy: 26.80
Round  48, Train loss: 1.407, Test loss: 1.794, Test accuracy: 26.50
Round  48, Global train loss: 1.407, Global test loss: 1.617, Global test accuracy: 20.40
Round  49, Train loss: 1.448, Test loss: 1.816, Test accuracy: 26.54
Round  49, Global train loss: 1.448, Global test loss: 1.587, Global test accuracy: 27.40
Round  50, Train loss: 1.067, Test loss: 1.821, Test accuracy: 26.14
Round  50, Global train loss: 1.067, Global test loss: 1.400, Global test accuracy: 41.00
Round  51, Train loss: 1.430, Test loss: 1.832, Test accuracy: 26.54
Round  51, Global train loss: 1.430, Global test loss: 1.609, Global test accuracy: 18.60
Round  52, Train loss: 1.387, Test loss: 1.828, Test accuracy: 26.36
Round  52, Global train loss: 1.387, Global test loss: 1.622, Global test accuracy: 20.00
Round  53, Train loss: 1.331, Test loss: 1.843, Test accuracy: 26.54
Round  53, Global train loss: 1.331, Global test loss: 1.553, Global test accuracy: 30.60
Round  54, Train loss: 1.353, Test loss: 1.819, Test accuracy: 26.52
Round  54, Global train loss: 1.353, Global test loss: 1.608, Global test accuracy: 26.60
Round  55, Train loss: 1.390, Test loss: 1.849, Test accuracy: 25.90
Round  55, Global train loss: 1.390, Global test loss: 1.602, Global test accuracy: 26.20
Round  56, Train loss: 1.215, Test loss: 1.860, Test accuracy: 26.62
Round  56, Global train loss: 1.215, Global test loss: 1.602, Global test accuracy: 28.20
Round  57, Train loss: 1.194, Test loss: 1.918, Test accuracy: 25.30
Round  57, Global train loss: 1.194, Global test loss: 1.473, Global test accuracy: 40.00
Round  58, Train loss: 1.178, Test loss: 1.898, Test accuracy: 25.60
Round  58, Global train loss: 1.178, Global test loss: 1.440, Global test accuracy: 35.00
Round  59, Train loss: 1.312, Test loss: 1.924, Test accuracy: 26.58
Round  59, Global train loss: 1.312, Global test loss: 1.623, Global test accuracy: 19.00
Round  60, Train loss: 1.282, Test loss: 1.940, Test accuracy: 26.22
Round  60, Global train loss: 1.282, Global test loss: 1.616, Global test accuracy: 21.80
Round  61, Train loss: 1.180, Test loss: 2.030, Test accuracy: 25.12
Round  61, Global train loss: 1.180, Global test loss: 1.679, Global test accuracy: 18.60
Round  62, Train loss: 0.918, Test loss: 2.071, Test accuracy: 24.60
Round  62, Global train loss: 0.918, Global test loss: 1.419, Global test accuracy: 38.00
Round  63, Train loss: 1.127, Test loss: 2.065, Test accuracy: 25.66
Round  63, Global train loss: 1.127, Global test loss: 1.708, Global test accuracy: 19.80
Round  64, Train loss: 0.917, Test loss: 2.086, Test accuracy: 26.14
Round  64, Global train loss: 0.917, Global test loss: 1.541, Global test accuracy: 31.20
Round  65, Train loss: 1.005, Test loss: 2.161, Test accuracy: 25.54
Round  65, Global train loss: 1.005, Global test loss: 1.465, Global test accuracy: 34.00
Round  66, Train loss: 1.196, Test loss: 2.218, Test accuracy: 25.24
Round  66, Global train loss: 1.196, Global test loss: 1.646, Global test accuracy: 22.20
Round  67, Train loss: 1.037, Test loss: 2.226, Test accuracy: 24.62
Round  67, Global train loss: 1.037, Global test loss: 1.682, Global test accuracy: 22.20
Round  68, Train loss: 0.783, Test loss: 2.243, Test accuracy: 24.86
Round  68, Global train loss: 0.783, Global test loss: 1.549, Global test accuracy: 31.80
Round  69, Train loss: 1.207, Test loss: 2.243, Test accuracy: 25.68
Round  69, Global train loss: 1.207, Global test loss: 1.624, Global test accuracy: 19.20
Round  70, Train loss: 1.060, Test loss: 2.329, Test accuracy: 25.68
Round  70, Global train loss: 1.060, Global test loss: 1.667, Global test accuracy: 21.40
Round  71, Train loss: 1.172, Test loss: 2.368, Test accuracy: 25.32
Round  71, Global train loss: 1.172, Global test loss: 1.626, Global test accuracy: 22.40
Round  72, Train loss: 1.075, Test loss: 2.407, Test accuracy: 24.22
Round  72, Global train loss: 1.075, Global test loss: 1.675, Global test accuracy: 17.80
Round  73, Train loss: 0.889, Test loss: 2.407, Test accuracy: 24.52
Round  73, Global train loss: 0.889, Global test loss: 1.681, Global test accuracy: 26.20
Round  74, Train loss: 1.123, Test loss: 2.454, Test accuracy: 25.10
Round  74, Global train loss: 1.123, Global test loss: 1.561, Global test accuracy: 30.80
Round  75, Train loss: 1.083, Test loss: 2.459, Test accuracy: 24.66
Round  75, Global train loss: 1.083, Global test loss: 1.603, Global test accuracy: 27.00
Round  76, Train loss: 1.010, Test loss: 2.393, Test accuracy: 24.90
Round  76, Global train loss: 1.010, Global test loss: 1.587, Global test accuracy: 27.20
Round  77, Train loss: 0.896, Test loss: 2.414, Test accuracy: 24.82
Round  77, Global train loss: 0.896, Global test loss: 1.690, Global test accuracy: 18.20
Round  78, Train loss: 0.826, Test loss: 2.486, Test accuracy: 25.08
Round  78, Global train loss: 0.826, Global test loss: 1.532, Global test accuracy: 37.00
Round  79, Train loss: 0.970, Test loss: 2.474, Test accuracy: 25.22
Round  79, Global train loss: 0.970, Global test loss: 1.651, Global test accuracy: 23.20
Round  80, Train loss: 0.852, Test loss: 2.535, Test accuracy: 24.66
Round  80, Global train loss: 0.852, Global test loss: 1.644, Global test accuracy: 27.60
Round  81, Train loss: 0.792, Test loss: 2.532, Test accuracy: 25.42
Round  81, Global train loss: 0.792, Global test loss: 1.577, Global test accuracy: 29.80
Round  82, Train loss: 0.886, Test loss: 2.621, Test accuracy: 25.04
Round  82, Global train loss: 0.886, Global test loss: 1.680, Global test accuracy: 20.40
Round  83, Train loss: 0.645, Test loss: 2.702, Test accuracy: 25.04
Round  83, Global train loss: 0.645, Global test loss: 1.411, Global test accuracy: 40.20
Round  84, Train loss: 0.786, Test loss: 2.752, Test accuracy: 24.52
Round  84, Global train loss: 0.786, Global test loss: 1.656, Global test accuracy: 21.60
Round  85, Train loss: 0.792, Test loss: 2.833, Test accuracy: 24.02
Round  85, Global train loss: 0.792, Global test loss: 1.649, Global test accuracy: 28.20
Round  86, Train loss: 0.491, Test loss: 2.957, Test accuracy: 23.78
Round  86, Global train loss: 0.491, Global test loss: 1.495, Global test accuracy: 36.80
Round  87, Train loss: 0.695, Test loss: 2.932, Test accuracy: 24.46
Round  87, Global train loss: 0.695, Global test loss: 1.537, Global test accuracy: 35.80
Round  88, Train loss: 0.595, Test loss: 3.055, Test accuracy: 24.20
Round  88, Global train loss: 0.595, Global test loss: 1.533, Global test accuracy: 30.40
Round  89, Train loss: 0.504, Test loss: 3.036, Test accuracy: 24.16
Round  89, Global train loss: 0.504, Global test loss: 1.413, Global test accuracy: 41.60
Round  90, Train loss: 0.535, Test loss: 3.107, Test accuracy: 24.58
Round  90, Global train loss: 0.535, Global test loss: 1.509, Global test accuracy: 33.80
Round  91, Train loss: 0.592, Test loss: 3.151, Test accuracy: 24.46
Round  91, Global train loss: 0.592, Global test loss: 1.735, Global test accuracy: 25.00
Round  92, Train loss: 0.853, Test loss: 3.183, Test accuracy: 24.52
Round  92, Global train loss: 0.853, Global test loss: 1.653, Global test accuracy: 23.60
Round  93, Train loss: 0.671, Test loss: 3.235, Test accuracy: 25.18
Round  93, Global train loss: 0.671, Global test loss: 1.752, Global test accuracy: 22.20
Round  94, Train loss: 0.779, Test loss: 3.155, Test accuracy: 25.72
Round  94, Global train loss: 0.779, Global test loss: 1.475, Global test accuracy: 34.20
Round  95, Train loss: 0.812, Test loss: 3.113, Test accuracy: 26.44
Round  95, Global train loss: 0.812, Global test loss: 1.645, Global test accuracy: 24.40
Round  96, Train loss: 0.643, Test loss: 3.235, Test accuracy: 25.92
Round  96, Global train loss: 0.643, Global test loss: 1.736, Global test accuracy: 20.40
Round  97, Train loss: 0.632, Test loss: 3.272, Test accuracy: 25.32
Round  97, Global train loss: 0.632, Global test loss: 1.814, Global test accuracy: 19.80
Round  98, Train loss: 0.638, Test loss: 3.326, Test accuracy: 25.06
Round  98, Global train loss: 0.638, Global test loss: 1.694, Global test accuracy: 22.80
Round  99, Train loss: 0.593, Test loss: 3.386, Test accuracy: 25.18
Round  99, Global train loss: 0.593, Global test loss: 1.683, Global test accuracy: 21.00
Final Round, Train loss: 0.557, Test loss: 3.594, Test accuracy: 25.12
Final Round, Global train loss: 0.557, Global test loss: 1.683, Global test accuracy: 21.00
Average accuracy final 10 rounds: 25.238 

Average global accuracy final 10 rounds: 24.720000000000002 

791.0122292041779
[1.485217809677124, 2.970435619354248, 4.144078254699707, 5.317720890045166, 6.5316643714904785, 7.745607852935791, 8.98868465423584, 10.231761455535889, 11.469482898712158, 12.707204341888428, 13.917899131774902, 15.128593921661377, 16.389519453048706, 17.650444984436035, 18.734971046447754, 19.819497108459473, 20.967509269714355, 22.11552143096924, 23.30007266998291, 24.484623908996582, 25.6871075630188, 26.889591217041016, 28.117011308670044, 29.344431400299072, 30.583657264709473, 31.822883129119873, 32.991880655288696, 34.16087818145752, 35.375492095947266, 36.59010601043701, 37.80215668678284, 39.01420736312866, 40.232829570770264, 41.451451778411865, 42.708364963531494, 43.96527814865112, 45.1659209728241, 46.36656379699707, 47.5807409286499, 48.794918060302734, 50.00268912315369, 51.21046018600464, 52.38421845436096, 53.557976722717285, 54.765575647354126, 55.97317457199097, 57.09679698944092, 58.22041940689087, 59.417038917541504, 60.61365842819214, 61.832643270492554, 63.05162811279297, 64.19631838798523, 65.34100866317749, 66.49448895454407, 67.64796924591064, 68.86116027832031, 70.07435131072998, 71.25655436515808, 72.43875741958618, 73.6120114326477, 74.78526544570923, 75.9212007522583, 77.05713605880737, 78.23075485229492, 79.40437364578247, 80.59818744659424, 81.792001247406, 83.02443552017212, 84.25686979293823, 85.49218893051147, 86.72750806808472, 87.93132996559143, 89.13515186309814, 90.33905911445618, 91.54296636581421, 92.72485375404358, 93.90674114227295, 95.22658085823059, 96.54642057418823, 97.77059030532837, 98.9947600364685, 100.13688659667969, 101.27901315689087, 102.41975092887878, 103.5604887008667, 104.74541163444519, 105.93033456802368, 107.16000127792358, 108.38966798782349, 109.54910087585449, 110.7085337638855, 111.97656846046448, 113.24460315704346, 114.4486768245697, 115.65275049209595, 116.82530045509338, 117.99785041809082, 119.14134979248047, 120.28484916687012, 121.43858432769775, 122.59231948852539, 123.78696084022522, 124.98160219192505, 126.17382264137268, 127.36604309082031, 128.51505255699158, 129.66406202316284, 130.86015105247498, 132.0562400817871, 133.5952410697937, 135.1342420578003, 136.2937421798706, 137.45324230194092, 138.65270495414734, 139.85216760635376, 141.06894493103027, 142.2857222557068, 143.46781039237976, 144.64989852905273, 145.82909893989563, 147.00829935073853, 148.23042154312134, 149.45254373550415, 150.5968120098114, 151.74108028411865, 152.9102804660797, 154.07948064804077, 155.318763256073, 156.55804586410522, 157.74556708335876, 158.9330883026123, 160.17987608909607, 161.42666387557983, 162.63908529281616, 163.8515067100525, 165.05513072013855, 166.2587547302246, 167.44757270812988, 168.63639068603516, 169.8112485408783, 170.98610639572144, 172.1182792186737, 173.25045204162598, 174.43688583374023, 175.6233196258545, 176.85677433013916, 178.09022903442383, 179.36455988883972, 180.63889074325562, 181.83136534690857, 183.02383995056152, 184.17466521263123, 185.32549047470093, 186.53520894050598, 187.74492740631104, 188.96544671058655, 190.18596601486206, 191.3725962638855, 192.55922651290894, 193.80043244361877, 195.0416383743286, 196.27184891700745, 197.50205945968628, 198.73764300346375, 199.9732265472412, 201.1663854122162, 202.35954427719116, 203.50381779670715, 204.64809131622314, 205.8263590335846, 207.00462675094604, 208.18332982063293, 209.36203289031982, 210.58201718330383, 211.80200147628784, 213.0019612312317, 214.20192098617554, 215.37211275100708, 216.54230451583862, 217.69669842720032, 218.851092338562, 219.989994764328, 221.128897190094, 222.28164982795715, 223.4344024658203, 224.64795804023743, 225.86151361465454, 227.0504231452942, 228.23933267593384, 229.38223147392273, 230.52513027191162, 231.71264123916626, 232.9001522064209, 234.05549240112305, 235.2108325958252, 236.37970900535583, 237.54858541488647, 238.71295046806335, 239.87731552124023, 242.38057923316956, 244.88384294509888]
[21.8, 21.8, 24.84, 24.84, 25.66, 25.66, 24.94, 24.94, 23.74, 23.74, 23.92, 23.92, 23.8, 23.8, 24.9, 24.9, 23.28, 23.28, 25.5, 25.5, 24.8, 24.8, 23.66, 23.66, 22.92, 22.92, 23.5, 23.5, 24.58, 24.58, 24.98, 24.98, 25.92, 25.92, 26.18, 26.18, 26.36, 26.36, 26.46, 26.46, 25.82, 25.82, 26.96, 26.96, 27.68, 27.68, 26.94, 26.94, 27.52, 27.52, 27.22, 27.22, 26.08, 26.08, 26.62, 26.62, 26.38, 26.38, 26.14, 26.14, 26.46, 26.46, 26.66, 26.66, 27.24, 27.24, 28.36, 28.36, 27.12, 27.12, 26.58, 26.58, 26.54, 26.54, 25.98, 25.98, 25.76, 25.76, 26.5, 26.5, 26.56, 26.56, 26.4, 26.4, 25.94, 25.94, 25.88, 25.88, 25.12, 25.12, 25.48, 25.48, 24.98, 24.98, 25.38, 25.38, 26.5, 26.5, 26.54, 26.54, 26.14, 26.14, 26.54, 26.54, 26.36, 26.36, 26.54, 26.54, 26.52, 26.52, 25.9, 25.9, 26.62, 26.62, 25.3, 25.3, 25.6, 25.6, 26.58, 26.58, 26.22, 26.22, 25.12, 25.12, 24.6, 24.6, 25.66, 25.66, 26.14, 26.14, 25.54, 25.54, 25.24, 25.24, 24.62, 24.62, 24.86, 24.86, 25.68, 25.68, 25.68, 25.68, 25.32, 25.32, 24.22, 24.22, 24.52, 24.52, 25.1, 25.1, 24.66, 24.66, 24.9, 24.9, 24.82, 24.82, 25.08, 25.08, 25.22, 25.22, 24.66, 24.66, 25.42, 25.42, 25.04, 25.04, 25.04, 25.04, 24.52, 24.52, 24.02, 24.02, 23.78, 23.78, 24.46, 24.46, 24.2, 24.2, 24.16, 24.16, 24.58, 24.58, 24.46, 24.46, 24.52, 24.52, 25.18, 25.18, 25.72, 25.72, 26.44, 26.44, 25.92, 25.92, 25.32, 25.32, 25.06, 25.06, 25.18, 25.18, 25.12, 25.12]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.608, Test loss: 1.608, Test accuracy: 22.20
Round   0, Global train loss: 1.608, Global test loss: 1.607, Global test accuracy: 23.60
Round   1, Train loss: 1.587, Test loss: 1.612, Test accuracy: 21.88
Round   1, Global train loss: 1.587, Global test loss: 1.607, Global test accuracy: 23.40
Round   2, Train loss: 1.583, Test loss: 1.612, Test accuracy: 21.98
Round   2, Global train loss: 1.583, Global test loss: 1.607, Global test accuracy: 23.20
Round   3, Train loss: 1.598, Test loss: 1.605, Test accuracy: 23.38
Round   3, Global train loss: 1.598, Global test loss: 1.589, Global test accuracy: 22.20
Round   4, Train loss: 1.579, Test loss: 1.592, Test accuracy: 27.56
Round   4, Global train loss: 1.579, Global test loss: 1.577, Global test accuracy: 30.00
Round   5, Train loss: 1.569, Test loss: 1.586, Test accuracy: 27.92
Round   5, Global train loss: 1.569, Global test loss: 1.563, Global test accuracy: 30.20
Round   6, Train loss: 1.592, Test loss: 1.570, Test accuracy: 30.08
Round   6, Global train loss: 1.592, Global test loss: 1.551, Global test accuracy: 31.60
Round   7, Train loss: 1.562, Test loss: 1.572, Test accuracy: 30.84
Round   7, Global train loss: 1.562, Global test loss: 1.558, Global test accuracy: 31.80
Round   8, Train loss: 1.561, Test loss: 1.561, Test accuracy: 31.98
Round   8, Global train loss: 1.561, Global test loss: 1.526, Global test accuracy: 37.00
Round   9, Train loss: 1.556, Test loss: 1.558, Test accuracy: 32.02
Round   9, Global train loss: 1.556, Global test loss: 1.509, Global test accuracy: 36.80
Round  10, Train loss: 1.571, Test loss: 1.562, Test accuracy: 31.04
Round  10, Global train loss: 1.571, Global test loss: 1.541, Global test accuracy: 33.60
Round  11, Train loss: 1.576, Test loss: 1.563, Test accuracy: 31.10
Round  11, Global train loss: 1.576, Global test loss: 1.524, Global test accuracy: 34.80
Round  12, Train loss: 1.560, Test loss: 1.564, Test accuracy: 31.12
Round  12, Global train loss: 1.560, Global test loss: 1.566, Global test accuracy: 28.80
Round  13, Train loss: 1.549, Test loss: 1.561, Test accuracy: 32.32
Round  13, Global train loss: 1.549, Global test loss: 1.563, Global test accuracy: 32.20
Round  14, Train loss: 1.560, Test loss: 1.562, Test accuracy: 31.94
Round  14, Global train loss: 1.560, Global test loss: 1.534, Global test accuracy: 34.20
Round  15, Train loss: 1.543, Test loss: 1.561, Test accuracy: 31.90
Round  15, Global train loss: 1.543, Global test loss: 1.550, Global test accuracy: 29.40
Round  16, Train loss: 1.535, Test loss: 1.563, Test accuracy: 31.74
Round  16, Global train loss: 1.535, Global test loss: 1.540, Global test accuracy: 32.60
Round  17, Train loss: 1.531, Test loss: 1.570, Test accuracy: 31.62
Round  17, Global train loss: 1.531, Global test loss: 1.534, Global test accuracy: 33.40
Round  18, Train loss: 1.516, Test loss: 1.577, Test accuracy: 31.22
Round  18, Global train loss: 1.516, Global test loss: 1.549, Global test accuracy: 31.40
Round  19, Train loss: 1.515, Test loss: 1.569, Test accuracy: 31.54
Round  19, Global train loss: 1.515, Global test loss: 1.524, Global test accuracy: 32.00
Round  20, Train loss: 1.479, Test loss: 1.575, Test accuracy: 31.34
Round  20, Global train loss: 1.479, Global test loss: 1.610, Global test accuracy: 28.00
Round  21, Train loss: 1.482, Test loss: 1.582, Test accuracy: 31.24
Round  21, Global train loss: 1.482, Global test loss: 1.549, Global test accuracy: 31.60
Round  22, Train loss: 1.515, Test loss: 1.581, Test accuracy: 31.06
Round  22, Global train loss: 1.515, Global test loss: 1.512, Global test accuracy: 33.00
Round  23, Train loss: 1.475, Test loss: 1.600, Test accuracy: 30.22
Round  23, Global train loss: 1.475, Global test loss: 1.600, Global test accuracy: 30.20
Round  24, Train loss: 1.465, Test loss: 1.603, Test accuracy: 30.22
Round  24, Global train loss: 1.465, Global test loss: 1.554, Global test accuracy: 33.60
Round  25, Train loss: 1.382, Test loss: 1.632, Test accuracy: 30.20
Round  25, Global train loss: 1.382, Global test loss: 1.621, Global test accuracy: 31.20
Round  26, Train loss: 1.424, Test loss: 1.655, Test accuracy: 30.74
Round  26, Global train loss: 1.424, Global test loss: 1.606, Global test accuracy: 32.80
Round  27, Train loss: 1.407, Test loss: 1.667, Test accuracy: 30.20
Round  27, Global train loss: 1.407, Global test loss: 1.588, Global test accuracy: 28.80
Round  28, Train loss: 1.377, Test loss: 1.662, Test accuracy: 30.08
Round  28, Global train loss: 1.377, Global test loss: 1.587, Global test accuracy: 35.40
Round  29, Train loss: 1.288, Test loss: 1.674, Test accuracy: 30.58
Round  29, Global train loss: 1.288, Global test loss: 1.730, Global test accuracy: 27.60
Round  30, Train loss: 1.304, Test loss: 1.703, Test accuracy: 29.76
Round  30, Global train loss: 1.304, Global test loss: 1.686, Global test accuracy: 32.00
Round  31, Train loss: 1.238, Test loss: 1.726, Test accuracy: 28.56
Round  31, Global train loss: 1.238, Global test loss: 1.777, Global test accuracy: 25.00
Round  32, Train loss: 1.205, Test loss: 1.782, Test accuracy: 28.34
Round  32, Global train loss: 1.205, Global test loss: 1.860, Global test accuracy: 27.00
Round  33, Train loss: 1.141, Test loss: 1.824, Test accuracy: 28.38
Round  33, Global train loss: 1.141, Global test loss: 1.837, Global test accuracy: 29.00
Round  34, Train loss: 1.199, Test loss: 1.863, Test accuracy: 27.92
Round  34, Global train loss: 1.199, Global test loss: 1.719, Global test accuracy: 32.20
Round  35, Train loss: 1.090, Test loss: 1.911, Test accuracy: 27.58
Round  35, Global train loss: 1.090, Global test loss: 1.977, Global test accuracy: 26.20
Round  36, Train loss: 1.214, Test loss: 1.945, Test accuracy: 27.62
Round  36, Global train loss: 1.214, Global test loss: 1.750, Global test accuracy: 33.20
Round  37, Train loss: 1.040, Test loss: 1.945, Test accuracy: 28.44
Round  37, Global train loss: 1.040, Global test loss: 2.002, Global test accuracy: 27.60
Round  38, Train loss: 1.007, Test loss: 1.989, Test accuracy: 28.12
Round  38, Global train loss: 1.007, Global test loss: 1.983, Global test accuracy: 28.20
Round  39, Train loss: 1.013, Test loss: 2.038, Test accuracy: 28.42
Round  39, Global train loss: 1.013, Global test loss: 1.837, Global test accuracy: 32.40
Round  40, Train loss: 0.910, Test loss: 2.113, Test accuracy: 27.52
Round  40, Global train loss: 0.910, Global test loss: 2.084, Global test accuracy: 28.60
Round  41, Train loss: 0.873, Test loss: 2.140, Test accuracy: 27.54
Round  41, Global train loss: 0.873, Global test loss: 2.060, Global test accuracy: 27.40
Round  42, Train loss: 0.829, Test loss: 2.255, Test accuracy: 27.80
Round  42, Global train loss: 0.829, Global test loss: 2.268, Global test accuracy: 29.60
Round  43, Train loss: 0.955, Test loss: 2.310, Test accuracy: 28.02
Round  43, Global train loss: 0.955, Global test loss: 2.018, Global test accuracy: 28.80
Round  44, Train loss: 1.104, Test loss: 2.394, Test accuracy: 27.58
Round  44, Global train loss: 1.104, Global test loss: 1.845, Global test accuracy: 31.60
Round  45, Train loss: 0.827, Test loss: 2.395, Test accuracy: 27.84
Round  45, Global train loss: 0.827, Global test loss: 2.259, Global test accuracy: 26.60
Round  46, Train loss: 1.038, Test loss: 2.452, Test accuracy: 26.66
Round  46, Global train loss: 1.038, Global test loss: 1.988, Global test accuracy: 27.80
Round  47, Train loss: 0.746, Test loss: 2.364, Test accuracy: 27.54
Round  47, Global train loss: 0.746, Global test loss: 2.438, Global test accuracy: 24.00
Round  48, Train loss: 0.710, Test loss: 2.470, Test accuracy: 26.90
Round  48, Global train loss: 0.710, Global test loss: 2.501, Global test accuracy: 26.20
Round  49, Train loss: 0.893, Test loss: 2.442, Test accuracy: 27.72
Round  49, Global train loss: 0.893, Global test loss: 1.996, Global test accuracy: 29.80
Round  50, Train loss: 0.750, Test loss: 2.492, Test accuracy: 27.38
Round  50, Global train loss: 0.750, Global test loss: 2.321, Global test accuracy: 25.20
Round  51, Train loss: 0.713, Test loss: 2.593, Test accuracy: 27.14
Round  51, Global train loss: 0.713, Global test loss: 2.406, Global test accuracy: 25.60
Round  52, Train loss: 0.690, Test loss: 2.650, Test accuracy: 26.88
Round  52, Global train loss: 0.690, Global test loss: 2.520, Global test accuracy: 25.60
Round  53, Train loss: 0.880, Test loss: 2.718, Test accuracy: 26.78
Round  53, Global train loss: 0.880, Global test loss: 2.252, Global test accuracy: 23.40
Round  54, Train loss: 0.685, Test loss: 2.802, Test accuracy: 25.56
Round  54, Global train loss: 0.685, Global test loss: 2.429, Global test accuracy: 26.80
Round  55, Train loss: 0.800, Test loss: 2.861, Test accuracy: 25.46
Round  55, Global train loss: 0.800, Global test loss: 2.272, Global test accuracy: 26.80
Round  56, Train loss: 0.563, Test loss: 2.879, Test accuracy: 25.26
Round  56, Global train loss: 0.563, Global test loss: 2.858, Global test accuracy: 21.60
Round  57, Train loss: 0.664, Test loss: 2.858, Test accuracy: 24.98
Round  57, Global train loss: 0.664, Global test loss: 2.368, Global test accuracy: 27.20
Round  58, Train loss: 0.611, Test loss: 2.895, Test accuracy: 25.20
Round  58, Global train loss: 0.611, Global test loss: 2.532, Global test accuracy: 27.00
Round  59, Train loss: 0.577, Test loss: 3.006, Test accuracy: 24.48
Round  59, Global train loss: 0.577, Global test loss: 2.700, Global test accuracy: 24.40
Round  60, Train loss: 0.517, Test loss: 3.042, Test accuracy: 25.12
Round  60, Global train loss: 0.517, Global test loss: 2.714, Global test accuracy: 27.80
Round  61, Train loss: 0.506, Test loss: 3.187, Test accuracy: 24.36
Round  61, Global train loss: 0.506, Global test loss: 3.000, Global test accuracy: 25.60
Round  62, Train loss: 0.621, Test loss: 3.298, Test accuracy: 24.54
Round  62, Global train loss: 0.621, Global test loss: 2.796, Global test accuracy: 24.40
Round  63, Train loss: 0.403, Test loss: 3.357, Test accuracy: 23.84
Round  63, Global train loss: 0.403, Global test loss: 3.359, Global test accuracy: 23.20
Round  64, Train loss: 0.508, Test loss: 3.354, Test accuracy: 24.26
Round  64, Global train loss: 0.508, Global test loss: 2.990, Global test accuracy: 27.40
Round  65, Train loss: 0.410, Test loss: 3.343, Test accuracy: 24.54
Round  65, Global train loss: 0.410, Global test loss: 3.168, Global test accuracy: 27.60
Round  66, Train loss: 0.436, Test loss: 3.418, Test accuracy: 24.40
Round  66, Global train loss: 0.436, Global test loss: 3.121, Global test accuracy: 24.00
Round  67, Train loss: 0.357, Test loss: 3.395, Test accuracy: 24.70
Round  67, Global train loss: 0.357, Global test loss: 3.341, Global test accuracy: 25.00
Round  68, Train loss: 0.432, Test loss: 3.455, Test accuracy: 23.98
Round  68, Global train loss: 0.432, Global test loss: 3.189, Global test accuracy: 27.20
Round  69, Train loss: 0.652, Test loss: 3.481, Test accuracy: 24.96
Round  69, Global train loss: 0.652, Global test loss: 2.565, Global test accuracy: 26.00
Round  70, Train loss: 0.370, Test loss: 3.476, Test accuracy: 25.60
Round  70, Global train loss: 0.370, Global test loss: 3.186, Global test accuracy: 27.00
Round  71, Train loss: 0.579, Test loss: 3.549, Test accuracy: 24.58
Round  71, Global train loss: 0.579, Global test loss: 2.897, Global test accuracy: 22.80
Round  72, Train loss: 0.360, Test loss: 3.609, Test accuracy: 23.82
Round  72, Global train loss: 0.360, Global test loss: 3.496, Global test accuracy: 20.80
Round  73, Train loss: 0.430, Test loss: 3.641, Test accuracy: 24.00
Round  73, Global train loss: 0.430, Global test loss: 3.328, Global test accuracy: 22.80
Round  74, Train loss: 0.572, Test loss: 3.590, Test accuracy: 23.56
Round  74, Global train loss: 0.572, Global test loss: 2.840, Global test accuracy: 23.40
Round  75, Train loss: 0.312, Test loss: 3.701, Test accuracy: 23.72
Round  75, Global train loss: 0.312, Global test loss: 3.518, Global test accuracy: 24.60
Round  76, Train loss: 0.503, Test loss: 3.815, Test accuracy: 24.22
Round  76, Global train loss: 0.503, Global test loss: 3.031, Global test accuracy: 24.20
Round  77, Train loss: 0.386, Test loss: 3.697, Test accuracy: 24.58
Round  77, Global train loss: 0.386, Global test loss: 3.235, Global test accuracy: 27.00
Round  78, Train loss: 0.444, Test loss: 3.696, Test accuracy: 25.16
Round  78, Global train loss: 0.444, Global test loss: 3.089, Global test accuracy: 28.20
Round  79, Train loss: 0.325, Test loss: 3.668, Test accuracy: 25.28
Round  79, Global train loss: 0.325, Global test loss: 3.505, Global test accuracy: 24.00
Round  80, Train loss: 0.500, Test loss: 3.760, Test accuracy: 24.78
Round  80, Global train loss: 0.500, Global test loss: 3.140, Global test accuracy: 22.60
Round  81, Train loss: 0.284, Test loss: 3.841, Test accuracy: 24.96
Round  81, Global train loss: 0.284, Global test loss: 3.839, Global test accuracy: 20.40
Round  82, Train loss: 0.288, Test loss: 3.912, Test accuracy: 24.14
Round  82, Global train loss: 0.288, Global test loss: 3.748, Global test accuracy: 23.60
Round  83, Train loss: 0.363, Test loss: 4.000, Test accuracy: 23.86
Round  83, Global train loss: 0.363, Global test loss: 3.553, Global test accuracy: 24.20
Round  84, Train loss: 0.214, Test loss: 4.089, Test accuracy: 24.44
Round  84, Global train loss: 0.214, Global test loss: 4.148, Global test accuracy: 23.40
Round  85, Train loss: 0.481, Test loss: 4.045, Test accuracy: 24.32
Round  85, Global train loss: 0.481, Global test loss: 3.354, Global test accuracy: 22.20
Round  86, Train loss: 0.348, Test loss: 4.160, Test accuracy: 23.78
Round  86, Global train loss: 0.348, Global test loss: 3.653, Global test accuracy: 26.20
Round  87, Train loss: 0.455, Test loss: 4.190, Test accuracy: 24.04
Round  87, Global train loss: 0.455, Global test loss: 3.288, Global test accuracy: 26.80
Round  88, Train loss: 0.268, Test loss: 4.178, Test accuracy: 23.70
Round  88, Global train loss: 0.268, Global test loss: 3.886, Global test accuracy: 25.80
Round  89, Train loss: 0.294, Test loss: 4.093, Test accuracy: 24.18
Round  89, Global train loss: 0.294, Global test loss: 3.557, Global test accuracy: 26.00
Round  90, Train loss: 0.237, Test loss: 4.109, Test accuracy: 24.46
Round  90, Global train loss: 0.237, Global test loss: 3.854, Global test accuracy: 27.00
Round  91, Train loss: 0.221, Test loss: 4.308, Test accuracy: 23.44
Round  91, Global train loss: 0.221, Global test loss: 4.528, Global test accuracy: 21.40
Round  92, Train loss: 0.479, Test loss: 4.320, Test accuracy: 23.12
Round  92, Global train loss: 0.479, Global test loss: 3.340, Global test accuracy: 24.00
Round  93, Train loss: 0.308, Test loss: 4.479, Test accuracy: 22.42
Round  93, Global train loss: 0.308, Global test loss: 3.884, Global test accuracy: 23.80
Round  94, Train loss: 0.372, Test loss: 4.578, Test accuracy: 22.02
Round  94, Global train loss: 0.372, Global test loss: 3.555, Global test accuracy: 26.20
Round  95, Train loss: 0.264, Test loss: 4.700, Test accuracy: 21.96
Round  95, Global train loss: 0.264, Global test loss: 4.376, Global test accuracy: 22.20
Round  96, Train loss: 0.363, Test loss: 4.597, Test accuracy: 22.70
Round  96, Global train loss: 0.363, Global test loss: 3.605, Global test accuracy: 24.80
Round  97, Train loss: 0.229, Test loss: 4.582, Test accuracy: 23.12
Round  97, Global train loss: 0.229, Global test loss: 4.199, Global test accuracy: 25.00
Round  98, Train loss: 0.311, Test loss: 4.561, Test accuracy: 23.64
Round  98, Global train loss: 0.311, Global test loss: 3.815, Global test accuracy: 25.60
Round  99, Train loss: 0.254, Test loss: 4.507, Test accuracy: 23.68
Round  99, Global train loss: 0.254, Global test loss: 3.761, Global test accuracy: 25.80
Final Round, Train loss: 0.242, Test loss: 4.377, Test accuracy: 24.66
Final Round, Global train loss: 0.242, Global test loss: 3.761, Global test accuracy: 25.80
Average accuracy final 10 rounds: 23.056 

Average global accuracy final 10 rounds: 24.58 

814.9194436073303
[1.5558438301086426, 3.111687660217285, 4.348691701889038, 5.585695743560791, 6.845030069351196, 8.104364395141602, 9.349518775939941, 10.594673156738281, 11.803719520568848, 13.012765884399414, 14.25841474533081, 15.504063606262207, 16.735684871673584, 17.96730613708496, 19.2225239276886, 20.477741718292236, 21.7061710357666, 22.934600353240967, 24.274730443954468, 25.61486053466797, 26.905720472335815, 28.196580410003662, 29.437167167663574, 30.677753925323486, 31.95323896408081, 33.228724002838135, 34.437581300735474, 35.64643859863281, 36.76554346084595, 37.88464832305908, 39.07700157165527, 40.269354820251465, 41.45124530792236, 42.63313579559326, 43.80064821243286, 44.96816062927246, 46.2043936252594, 47.44062662124634, 48.693265199661255, 49.94590377807617, 51.14911985397339, 52.352335929870605, 53.576740026474, 54.80114412307739, 56.09300494194031, 57.38486576080322, 58.73132920265198, 60.07779264450073, 61.32827639579773, 62.57876014709473, 63.792529582977295, 65.00629901885986, 66.27013945579529, 67.53397989273071, 68.75526118278503, 69.97654247283936, 71.20567774772644, 72.43481302261353, 73.69635772705078, 74.95790243148804, 76.27538704872131, 77.59287166595459, 78.8093249797821, 80.02577829360962, 81.25043630599976, 82.47509431838989, 83.7125883102417, 84.9500823020935, 86.26025652885437, 87.57043075561523, 88.84885454177856, 90.1272783279419, 91.32377791404724, 92.52027750015259, 93.76253509521484, 95.0047926902771, 96.2241313457489, 97.4434700012207, 98.66428589820862, 99.88510179519653, 101.06725358963013, 102.24940538406372, 103.42147397994995, 104.59354257583618, 105.76943969726562, 106.94533681869507, 108.1721043586731, 109.39887189865112, 110.65783596038818, 111.91680002212524, 113.16200470924377, 114.4072093963623, 115.595543384552, 116.7838773727417, 118.03729367256165, 119.29070997238159, 120.46268725395203, 121.63466453552246, 122.80253100395203, 123.97039747238159, 125.19433045387268, 126.41826343536377, 127.69596838951111, 128.97367334365845, 130.20593690872192, 131.4382004737854, 132.6412332057953, 133.84426593780518, 135.08698630332947, 136.32970666885376, 137.52904438972473, 138.7283821105957, 139.93258714675903, 141.13679218292236, 142.3361213207245, 143.5354504585266, 144.73620629310608, 145.93696212768555, 147.13197350502014, 148.32698488235474, 149.54867243766785, 150.77035999298096, 152.19114232063293, 153.6119246482849, 154.78708267211914, 155.96224069595337, 157.19914627075195, 158.43605184555054, 159.67165875434875, 160.90726566314697, 162.1288640499115, 163.35046243667603, 164.58637857437134, 165.82229471206665, 166.97661972045898, 168.13094472885132, 169.3157434463501, 170.50054216384888, 171.74902510643005, 172.99750804901123, 174.29884672164917, 175.6001853942871, 176.80788135528564, 178.01557731628418, 179.24563193321228, 180.47568655014038, 181.79583978652954, 183.1159930229187, 184.39059257507324, 185.66519212722778, 186.92689108848572, 188.18859004974365, 189.56480050086975, 190.94101095199585, 192.12441444396973, 193.3078179359436, 194.5699679851532, 195.8321180343628, 197.06999111175537, 198.30786418914795, 199.5228147506714, 200.73776531219482, 202.11691308021545, 203.49606084823608, 204.72054481506348, 205.94502878189087, 207.1737642288208, 208.40249967575073, 209.66222429275513, 210.92194890975952, 212.16571712493896, 213.4094853401184, 214.63749837875366, 215.86551141738892, 217.0699245929718, 218.2743377685547, 219.52486109733582, 220.77538442611694, 221.99777817726135, 223.22017192840576, 224.49984502792358, 225.7795181274414, 227.0424370765686, 228.3053560256958, 229.73023796081543, 231.15511989593506, 232.3798794746399, 233.60463905334473, 234.81099033355713, 236.01734161376953, 237.2489595413208, 238.48057746887207, 239.7125928401947, 240.94460821151733, 242.14214491844177, 243.3396816253662, 244.51359796524048, 245.68751430511475, 246.84939694404602, 248.0112795829773, 250.47718691825867, 252.94309425354004]
[22.2, 22.2, 21.88, 21.88, 21.98, 21.98, 23.38, 23.38, 27.56, 27.56, 27.92, 27.92, 30.08, 30.08, 30.84, 30.84, 31.98, 31.98, 32.02, 32.02, 31.04, 31.04, 31.1, 31.1, 31.12, 31.12, 32.32, 32.32, 31.94, 31.94, 31.9, 31.9, 31.74, 31.74, 31.62, 31.62, 31.22, 31.22, 31.54, 31.54, 31.34, 31.34, 31.24, 31.24, 31.06, 31.06, 30.22, 30.22, 30.22, 30.22, 30.2, 30.2, 30.74, 30.74, 30.2, 30.2, 30.08, 30.08, 30.58, 30.58, 29.76, 29.76, 28.56, 28.56, 28.34, 28.34, 28.38, 28.38, 27.92, 27.92, 27.58, 27.58, 27.62, 27.62, 28.44, 28.44, 28.12, 28.12, 28.42, 28.42, 27.52, 27.52, 27.54, 27.54, 27.8, 27.8, 28.02, 28.02, 27.58, 27.58, 27.84, 27.84, 26.66, 26.66, 27.54, 27.54, 26.9, 26.9, 27.72, 27.72, 27.38, 27.38, 27.14, 27.14, 26.88, 26.88, 26.78, 26.78, 25.56, 25.56, 25.46, 25.46, 25.26, 25.26, 24.98, 24.98, 25.2, 25.2, 24.48, 24.48, 25.12, 25.12, 24.36, 24.36, 24.54, 24.54, 23.84, 23.84, 24.26, 24.26, 24.54, 24.54, 24.4, 24.4, 24.7, 24.7, 23.98, 23.98, 24.96, 24.96, 25.6, 25.6, 24.58, 24.58, 23.82, 23.82, 24.0, 24.0, 23.56, 23.56, 23.72, 23.72, 24.22, 24.22, 24.58, 24.58, 25.16, 25.16, 25.28, 25.28, 24.78, 24.78, 24.96, 24.96, 24.14, 24.14, 23.86, 23.86, 24.44, 24.44, 24.32, 24.32, 23.78, 23.78, 24.04, 24.04, 23.7, 23.7, 24.18, 24.18, 24.46, 24.46, 23.44, 23.44, 23.12, 23.12, 22.42, 22.42, 22.02, 22.02, 21.96, 21.96, 22.7, 22.7, 23.12, 23.12, 23.64, 23.64, 23.68, 23.68, 24.66, 24.66]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.610, Test loss: 1.613, Test accuracy: 23.10
Round   0, Global train loss: 1.610, Global test loss: 1.612, Global test accuracy: 24.60
Round   1, Train loss: 1.608, Test loss: 1.613, Test accuracy: 21.48
Round   1, Global train loss: 1.608, Global test loss: 1.611, Global test accuracy: 23.40
Round   2, Train loss: 1.606, Test loss: 1.615, Test accuracy: 19.76
Round   2, Global train loss: 1.606, Global test loss: 1.615, Global test accuracy: 21.00
Round   3, Train loss: 1.604, Test loss: 1.615, Test accuracy: 19.36
Round   3, Global train loss: 1.604, Global test loss: 1.613, Global test accuracy: 20.00
Round   4, Train loss: 1.607, Test loss: 1.617, Test accuracy: 19.06
Round   4, Global train loss: 1.607, Global test loss: 1.619, Global test accuracy: 18.20
Round   5, Train loss: 1.605, Test loss: 1.616, Test accuracy: 21.38
Round   5, Global train loss: 1.605, Global test loss: 1.615, Global test accuracy: 24.00
Round   6, Train loss: 1.604, Test loss: 1.616, Test accuracy: 20.80
Round   6, Global train loss: 1.604, Global test loss: 1.611, Global test accuracy: 22.20
Round   7, Train loss: 1.602, Test loss: 1.620, Test accuracy: 19.80
Round   7, Global train loss: 1.602, Global test loss: 1.621, Global test accuracy: 19.20
Round   8, Train loss: 1.604, Test loss: 1.620, Test accuracy: 19.32
Round   8, Global train loss: 1.604, Global test loss: 1.613, Global test accuracy: 21.20
Round   9, Train loss: 1.569, Test loss: 1.606, Test accuracy: 21.82
Round   9, Global train loss: 1.569, Global test loss: 1.579, Global test accuracy: 37.40
Round  10, Train loss: 1.553, Test loss: 1.598, Test accuracy: 22.84
Round  10, Global train loss: 1.553, Global test loss: 1.555, Global test accuracy: 31.40
Round  11, Train loss: 1.585, Test loss: 1.601, Test accuracy: 22.92
Round  11, Global train loss: 1.585, Global test loss: 1.590, Global test accuracy: 26.20
Round  12, Train loss: 1.573, Test loss: 1.602, Test accuracy: 22.88
Round  12, Global train loss: 1.573, Global test loss: 1.612, Global test accuracy: 22.20
Round  13, Train loss: 1.599, Test loss: 1.601, Test accuracy: 22.86
Round  13, Global train loss: 1.599, Global test loss: 1.617, Global test accuracy: 21.20
Round  14, Train loss: 1.574, Test loss: 1.607, Test accuracy: 22.38
Round  14, Global train loss: 1.574, Global test loss: 1.612, Global test accuracy: 22.40
Round  15, Train loss: 1.593, Test loss: 1.608, Test accuracy: 22.82
Round  15, Global train loss: 1.593, Global test loss: 1.608, Global test accuracy: 24.40
Round  16, Train loss: 1.519, Test loss: 1.604, Test accuracy: 23.58
Round  16, Global train loss: 1.519, Global test loss: 1.550, Global test accuracy: 40.00
Round  17, Train loss: 1.535, Test loss: 1.603, Test accuracy: 23.22
Round  17, Global train loss: 1.535, Global test loss: 1.561, Global test accuracy: 35.60
Round  18, Train loss: 1.505, Test loss: 1.601, Test accuracy: 23.46
Round  18, Global train loss: 1.505, Global test loss: 1.537, Global test accuracy: 40.20
Round  19, Train loss: 1.561, Test loss: 1.600, Test accuracy: 24.94
Round  19, Global train loss: 1.561, Global test loss: 1.599, Global test accuracy: 27.20
Round  20, Train loss: 1.552, Test loss: 1.597, Test accuracy: 25.48
Round  20, Global train loss: 1.552, Global test loss: 1.623, Global test accuracy: 27.80
Round  21, Train loss: 1.516, Test loss: 1.602, Test accuracy: 24.16
Round  21, Global train loss: 1.516, Global test loss: 1.566, Global test accuracy: 33.20
Round  22, Train loss: 1.562, Test loss: 1.610, Test accuracy: 23.54
Round  22, Global train loss: 1.562, Global test loss: 1.594, Global test accuracy: 29.60
Round  23, Train loss: 1.574, Test loss: 1.613, Test accuracy: 24.28
Round  23, Global train loss: 1.574, Global test loss: 1.613, Global test accuracy: 24.60
Round  24, Train loss: 1.570, Test loss: 1.612, Test accuracy: 23.66
Round  24, Global train loss: 1.570, Global test loss: 1.606, Global test accuracy: 24.40
Round  25, Train loss: 1.560, Test loss: 1.614, Test accuracy: 24.10
Round  25, Global train loss: 1.560, Global test loss: 1.656, Global test accuracy: 21.20
Round  26, Train loss: 1.471, Test loss: 1.610, Test accuracy: 24.88
Round  26, Global train loss: 1.471, Global test loss: 1.510, Global test accuracy: 38.20
Round  27, Train loss: 1.559, Test loss: 1.616, Test accuracy: 24.14
Round  27, Global train loss: 1.559, Global test loss: 1.633, Global test accuracy: 20.40
Round  28, Train loss: 1.461, Test loss: 1.623, Test accuracy: 23.58
Round  28, Global train loss: 1.461, Global test loss: 1.513, Global test accuracy: 37.60
Round  29, Train loss: 1.530, Test loss: 1.624, Test accuracy: 24.90
Round  29, Global train loss: 1.530, Global test loss: 1.659, Global test accuracy: 22.00
Round  30, Train loss: 1.475, Test loss: 1.631, Test accuracy: 24.08
Round  30, Global train loss: 1.475, Global test loss: 1.528, Global test accuracy: 33.40
Round  31, Train loss: 1.518, Test loss: 1.643, Test accuracy: 23.50
Round  31, Global train loss: 1.518, Global test loss: 1.671, Global test accuracy: 21.20
Round  32, Train loss: 1.472, Test loss: 1.645, Test accuracy: 22.52
Round  32, Global train loss: 1.472, Global test loss: 1.676, Global test accuracy: 20.20
Round  33, Train loss: 1.493, Test loss: 1.640, Test accuracy: 23.88
Round  33, Global train loss: 1.493, Global test loss: 1.661, Global test accuracy: 23.20
Round  34, Train loss: 1.447, Test loss: 1.642, Test accuracy: 24.56
Round  34, Global train loss: 1.447, Global test loss: 1.571, Global test accuracy: 33.40
Round  35, Train loss: 1.468, Test loss: 1.651, Test accuracy: 25.12
Round  35, Global train loss: 1.468, Global test loss: 1.736, Global test accuracy: 19.60
Round  36, Train loss: 1.437, Test loss: 1.669, Test accuracy: 24.28
Round  36, Global train loss: 1.437, Global test loss: 1.575, Global test accuracy: 28.80
Round  37, Train loss: 1.415, Test loss: 1.681, Test accuracy: 24.58
Round  37, Global train loss: 1.415, Global test loss: 1.717, Global test accuracy: 20.00
Round  38, Train loss: 1.356, Test loss: 1.717, Test accuracy: 23.38
Round  38, Global train loss: 1.356, Global test loss: 1.687, Global test accuracy: 25.40
Round  39, Train loss: 1.368, Test loss: 1.736, Test accuracy: 23.12
Round  39, Global train loss: 1.368, Global test loss: 1.645, Global test accuracy: 27.00
Round  40, Train loss: 1.309, Test loss: 1.752, Test accuracy: 23.14
Round  40, Global train loss: 1.309, Global test loss: 1.664, Global test accuracy: 28.20
Round  41, Train loss: 1.283, Test loss: 1.762, Test accuracy: 22.88
Round  41, Global train loss: 1.283, Global test loss: 1.625, Global test accuracy: 28.40
Round  42, Train loss: 1.248, Test loss: 1.775, Test accuracy: 23.06
Round  42, Global train loss: 1.248, Global test loss: 1.730, Global test accuracy: 28.40
Round  43, Train loss: 1.252, Test loss: 1.793, Test accuracy: 23.24
Round  43, Global train loss: 1.252, Global test loss: 1.639, Global test accuracy: 31.40
Round  44, Train loss: 1.411, Test loss: 1.806, Test accuracy: 24.36
Round  44, Global train loss: 1.411, Global test loss: 1.660, Global test accuracy: 27.00
Round  45, Train loss: 1.277, Test loss: 1.807, Test accuracy: 24.98
Round  45, Global train loss: 1.277, Global test loss: 1.751, Global test accuracy: 23.80
Round  46, Train loss: 1.361, Test loss: 1.820, Test accuracy: 23.98
Round  46, Global train loss: 1.361, Global test loss: 1.669, Global test accuracy: 27.80
Round  47, Train loss: 1.157, Test loss: 1.874, Test accuracy: 23.66
Round  47, Global train loss: 1.157, Global test loss: 1.991, Global test accuracy: 20.20
Round  48, Train loss: 1.174, Test loss: 1.924, Test accuracy: 24.36
Round  48, Global train loss: 1.174, Global test loss: 1.981, Global test accuracy: 22.80
Round  49, Train loss: 1.263, Test loss: 1.930, Test accuracy: 24.54
Round  49, Global train loss: 1.263, Global test loss: 1.749, Global test accuracy: 26.60
Round  50, Train loss: 1.054, Test loss: 1.940, Test accuracy: 24.78
Round  50, Global train loss: 1.054, Global test loss: 1.777, Global test accuracy: 32.60
Round  51, Train loss: 1.158, Test loss: 1.998, Test accuracy: 24.10
Round  51, Global train loss: 1.158, Global test loss: 1.893, Global test accuracy: 21.20
Round  52, Train loss: 1.104, Test loss: 2.063, Test accuracy: 24.40
Round  52, Global train loss: 1.104, Global test loss: 2.039, Global test accuracy: 23.00
Round  53, Train loss: 1.189, Test loss: 2.056, Test accuracy: 25.04
Round  53, Global train loss: 1.189, Global test loss: 1.704, Global test accuracy: 31.00
Round  54, Train loss: 1.076, Test loss: 2.075, Test accuracy: 25.90
Round  54, Global train loss: 1.076, Global test loss: 1.905, Global test accuracy: 25.20
Round  55, Train loss: 1.096, Test loss: 2.086, Test accuracy: 26.04
Round  55, Global train loss: 1.096, Global test loss: 1.838, Global test accuracy: 26.00
Round  56, Train loss: 0.897, Test loss: 2.142, Test accuracy: 25.18
Round  56, Global train loss: 0.897, Global test loss: 2.177, Global test accuracy: 24.60
Round  57, Train loss: 0.934, Test loss: 2.198, Test accuracy: 25.44
Round  57, Global train loss: 0.934, Global test loss: 1.911, Global test accuracy: 31.60
Round  58, Train loss: 0.910, Test loss: 2.208, Test accuracy: 25.48
Round  58, Global train loss: 0.910, Global test loss: 1.907, Global test accuracy: 28.20
Round  59, Train loss: 0.971, Test loss: 2.241, Test accuracy: 25.54
Round  59, Global train loss: 0.971, Global test loss: 2.055, Global test accuracy: 23.40
Round  60, Train loss: 0.867, Test loss: 2.329, Test accuracy: 25.48
Round  60, Global train loss: 0.867, Global test loss: 2.158, Global test accuracy: 26.40
Round  61, Train loss: 0.812, Test loss: 2.423, Test accuracy: 25.72
Round  61, Global train loss: 0.812, Global test loss: 2.462, Global test accuracy: 22.40
Round  62, Train loss: 0.809, Test loss: 2.493, Test accuracy: 25.64
Round  62, Global train loss: 0.809, Global test loss: 1.888, Global test accuracy: 37.20
Round  63, Train loss: 0.711, Test loss: 2.527, Test accuracy: 26.20
Round  63, Global train loss: 0.711, Global test loss: 2.554, Global test accuracy: 24.20
Round  64, Train loss: 0.695, Test loss: 2.597, Test accuracy: 25.68
Round  64, Global train loss: 0.695, Global test loss: 2.358, Global test accuracy: 33.00
Round  65, Train loss: 0.655, Test loss: 2.635, Test accuracy: 24.92
Round  65, Global train loss: 0.655, Global test loss: 2.408, Global test accuracy: 26.00
Round  66, Train loss: 0.705, Test loss: 2.689, Test accuracy: 24.90
Round  66, Global train loss: 0.705, Global test loss: 2.563, Global test accuracy: 24.00
Round  67, Train loss: 0.603, Test loss: 2.757, Test accuracy: 24.38
Round  67, Global train loss: 0.603, Global test loss: 2.880, Global test accuracy: 22.80
Round  68, Train loss: 0.619, Test loss: 2.757, Test accuracy: 24.34
Round  68, Global train loss: 0.619, Global test loss: 2.712, Global test accuracy: 27.40
Round  69, Train loss: 0.883, Test loss: 2.862, Test accuracy: 23.86
Round  69, Global train loss: 0.883, Global test loss: 2.347, Global test accuracy: 21.20
Round  70, Train loss: 0.572, Test loss: 2.951, Test accuracy: 24.28
Round  70, Global train loss: 0.572, Global test loss: 2.916, Global test accuracy: 22.60
Round  71, Train loss: 0.798, Test loss: 2.981, Test accuracy: 24.26
Round  71, Global train loss: 0.798, Global test loss: 2.530, Global test accuracy: 22.40
Round  72, Train loss: 0.551, Test loss: 3.056, Test accuracy: 23.88
Round  72, Global train loss: 0.551, Global test loss: 2.898, Global test accuracy: 19.80
Round  73, Train loss: 0.572, Test loss: 3.224, Test accuracy: 23.26
Round  73, Global train loss: 0.572, Global test loss: 3.156, Global test accuracy: 23.20
Round  74, Train loss: 0.736, Test loss: 3.216, Test accuracy: 22.52
Round  74, Global train loss: 0.736, Global test loss: 2.657, Global test accuracy: 22.40
Round  75, Train loss: 0.544, Test loss: 3.167, Test accuracy: 22.70
Round  75, Global train loss: 0.544, Global test loss: 2.900, Global test accuracy: 24.80
Round  76, Train loss: 0.617, Test loss: 3.181, Test accuracy: 24.10
Round  76, Global train loss: 0.617, Global test loss: 2.667, Global test accuracy: 27.00
Round  77, Train loss: 0.565, Test loss: 3.143, Test accuracy: 24.92
Round  77, Global train loss: 0.565, Global test loss: 2.886, Global test accuracy: 25.00
Round  78, Train loss: 0.594, Test loss: 3.237, Test accuracy: 24.54
Round  78, Global train loss: 0.594, Global test loss: 2.604, Global test accuracy: 30.20
Round  79, Train loss: 0.472, Test loss: 3.254, Test accuracy: 24.80
Round  79, Global train loss: 0.472, Global test loss: 2.932, Global test accuracy: 23.60
Round  80, Train loss: 0.596, Test loss: 3.320, Test accuracy: 24.42
Round  80, Global train loss: 0.596, Global test loss: 2.739, Global test accuracy: 25.60
Round  81, Train loss: 0.396, Test loss: 3.361, Test accuracy: 24.68
Round  81, Global train loss: 0.396, Global test loss: 3.361, Global test accuracy: 24.80
Round  82, Train loss: 0.426, Test loss: 3.429, Test accuracy: 23.94
Round  82, Global train loss: 0.426, Global test loss: 3.066, Global test accuracy: 23.80
Round  83, Train loss: 0.414, Test loss: 3.398, Test accuracy: 24.62
Round  83, Global train loss: 0.414, Global test loss: 2.708, Global test accuracy: 28.40
Round  84, Train loss: 0.321, Test loss: 3.364, Test accuracy: 25.24
Round  84, Global train loss: 0.321, Global test loss: 3.338, Global test accuracy: 24.60
Round  85, Train loss: 0.565, Test loss: 3.346, Test accuracy: 24.90
Round  85, Global train loss: 0.565, Global test loss: 2.778, Global test accuracy: 24.80
Round  86, Train loss: 0.400, Test loss: 3.405, Test accuracy: 24.94
Round  86, Global train loss: 0.400, Global test loss: 2.859, Global test accuracy: 29.60
Round  87, Train loss: 0.556, Test loss: 3.404, Test accuracy: 24.70
Round  87, Global train loss: 0.556, Global test loss: 2.455, Global test accuracy: 30.20
Round  88, Train loss: 0.337, Test loss: 3.459, Test accuracy: 24.50
Round  88, Global train loss: 0.337, Global test loss: 2.928, Global test accuracy: 27.80
Round  89, Train loss: 0.332, Test loss: 3.418, Test accuracy: 24.80
Round  89, Global train loss: 0.332, Global test loss: 3.007, Global test accuracy: 29.80
Round  90, Train loss: 0.274, Test loss: 3.626, Test accuracy: 24.40
Round  90, Global train loss: 0.274, Global test loss: 3.353, Global test accuracy: 29.20
Round  91, Train loss: 0.280, Test loss: 3.593, Test accuracy: 24.30
Round  91, Global train loss: 0.280, Global test loss: 3.861, Global test accuracy: 24.80
Round  92, Train loss: 0.582, Test loss: 3.725, Test accuracy: 24.54
Round  92, Global train loss: 0.582, Global test loss: 2.978, Global test accuracy: 24.80
Round  93, Train loss: 0.422, Test loss: 3.690, Test accuracy: 24.62
Round  93, Global train loss: 0.422, Global test loss: 3.293, Global test accuracy: 24.40/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.485, Test loss: 3.827, Test accuracy: 23.60
Round  94, Global train loss: 0.485, Global test loss: 2.807, Global test accuracy: 27.40
Round  95, Train loss: 0.368, Test loss: 3.853, Test accuracy: 23.92
Round  95, Global train loss: 0.368, Global test loss: 3.428, Global test accuracy: 24.00
Round  96, Train loss: 0.441, Test loss: 3.961, Test accuracy: 22.96
Round  96, Global train loss: 0.441, Global test loss: 3.410, Global test accuracy: 22.20
Round  97, Train loss: 0.315, Test loss: 4.068, Test accuracy: 22.76
Round  97, Global train loss: 0.315, Global test loss: 3.748, Global test accuracy: 22.00
Round  98, Train loss: 0.368, Test loss: 4.132, Test accuracy: 22.64
Round  98, Global train loss: 0.368, Global test loss: 3.460, Global test accuracy: 24.60
Round  99, Train loss: 0.333, Test loss: 4.171, Test accuracy: 23.26
Round  99, Global train loss: 0.333, Global test loss: 3.622, Global test accuracy: 24.40
Final Round, Train loss: 0.304, Test loss: 4.094, Test accuracy: 24.72
Final Round, Global train loss: 0.304, Global test loss: 3.622, Global test accuracy: 24.40
Average accuracy final 10 rounds: 23.7 

Average global accuracy final 10 rounds: 24.78 

822.1850237846375
[1.6429316997528076, 3.2858633995056152, 4.579975366592407, 5.874087333679199, 7.179255962371826, 8.484424591064453, 9.97026777267456, 11.456110954284668, 12.749031782150269, 14.04195261001587, 15.310570478439331, 16.579188346862793, 17.902151346206665, 19.225114345550537, 20.485105752944946, 21.745097160339355, 23.04417109489441, 24.343245029449463, 25.62740731239319, 26.911569595336914, 28.15696144104004, 29.402353286743164, 30.71705651283264, 32.03175973892212, 33.394537687301636, 34.75731563568115, 36.036256074905396, 37.31519651412964, 38.64308309555054, 39.970969676971436, 41.26664733886719, 42.56232500076294, 43.80362319946289, 45.04492139816284, 46.307783365249634, 47.570645332336426, 48.770705461502075, 49.970765590667725, 51.299991846084595, 52.629218101501465, 53.890926122665405, 55.152634143829346, 56.44108033180237, 57.72952651977539, 59.02264857292175, 60.315770626068115, 61.644291162490845, 62.972811698913574, 64.25667214393616, 65.54053258895874, 66.7954843044281, 68.05043601989746, 69.34115839004517, 70.63188076019287, 71.95921015739441, 73.28653955459595, 74.578777551651, 75.87101554870605, 77.2386064529419, 78.60619735717773, 79.88603663444519, 81.16587591171265, 82.51483798027039, 83.86380004882812, 85.30396676063538, 86.74413347244263, 87.98289227485657, 89.22165107727051, 90.49697732925415, 91.7723035812378, 93.03250980377197, 94.29271602630615, 95.58051824569702, 96.86832046508789, 98.24473810195923, 99.62115573883057, 100.93920421600342, 102.25725269317627, 103.55286359786987, 104.84847450256348, 106.14500117301941, 107.44152784347534, 108.75421524047852, 110.06690263748169, 111.41264867782593, 112.75839471817017, 114.10802602767944, 115.45765733718872, 116.78233623504639, 118.10701513290405, 119.38473653793335, 120.66245794296265, 121.96126294136047, 123.2600679397583, 124.57379150390625, 125.8875150680542, 127.18333768844604, 128.4791603088379, 129.8862268924713, 131.29329347610474, 132.60394954681396, 133.9146056175232, 135.14109706878662, 136.36758852005005, 137.62627029418945, 138.88495206832886, 140.11680793762207, 141.34866380691528, 142.69794940948486, 144.04723501205444, 145.41418528556824, 146.78113555908203, 148.12611770629883, 149.47109985351562, 150.7527437210083, 152.03438758850098, 153.32409930229187, 154.61381101608276, 155.9053132534027, 157.19681549072266, 158.47872018814087, 159.76062488555908, 161.0203206539154, 162.28001642227173, 163.5627465248108, 164.84547662734985, 166.1935727596283, 167.54166889190674, 169.05775213241577, 170.5738353729248, 171.88427782058716, 173.1947202682495, 174.5476233959198, 175.9005265235901, 177.1929636001587, 178.4854006767273, 179.7791121006012, 181.0728235244751, 182.3736710548401, 183.67451858520508, 184.95720219612122, 186.23988580703735, 187.54164814949036, 188.84341049194336, 190.07881999015808, 191.3142294883728, 192.65536165237427, 193.99649381637573, 195.28934621810913, 196.58219861984253, 197.93241047859192, 199.2826223373413, 200.52680587768555, 201.77098941802979, 203.1047432422638, 204.4384970664978, 205.80242681503296, 207.16635656356812, 208.4823191165924, 209.7982816696167, 211.1065011024475, 212.41472053527832, 213.81536388397217, 215.21600723266602, 216.47181487083435, 217.72762250900269, 219.02911186218262, 220.33060121536255, 221.6146857738495, 222.89877033233643, 224.18485045433044, 225.47093057632446, 226.7717249393463, 228.07251930236816, 229.36069297790527, 230.64886665344238, 231.92044067382812, 233.19201469421387, 234.51822638511658, 235.8444380760193, 237.15161561965942, 238.45879316329956, 239.7582883834839, 241.0577836036682, 242.44796681404114, 243.83815002441406, 245.13741612434387, 246.43668222427368, 247.85488939285278, 249.27309656143188, 250.5386667251587, 251.8042368888855, 253.1411154270172, 254.47799396514893, 255.8093409538269, 257.1406879425049, 258.4698235988617, 259.7989592552185, 261.11016368865967, 262.42136812210083, 265.0984408855438, 267.7755136489868]
[23.1, 23.1, 21.48, 21.48, 19.76, 19.76, 19.36, 19.36, 19.06, 19.06, 21.38, 21.38, 20.8, 20.8, 19.8, 19.8, 19.32, 19.32, 21.82, 21.82, 22.84, 22.84, 22.92, 22.92, 22.88, 22.88, 22.86, 22.86, 22.38, 22.38, 22.82, 22.82, 23.58, 23.58, 23.22, 23.22, 23.46, 23.46, 24.94, 24.94, 25.48, 25.48, 24.16, 24.16, 23.54, 23.54, 24.28, 24.28, 23.66, 23.66, 24.1, 24.1, 24.88, 24.88, 24.14, 24.14, 23.58, 23.58, 24.9, 24.9, 24.08, 24.08, 23.5, 23.5, 22.52, 22.52, 23.88, 23.88, 24.56, 24.56, 25.12, 25.12, 24.28, 24.28, 24.58, 24.58, 23.38, 23.38, 23.12, 23.12, 23.14, 23.14, 22.88, 22.88, 23.06, 23.06, 23.24, 23.24, 24.36, 24.36, 24.98, 24.98, 23.98, 23.98, 23.66, 23.66, 24.36, 24.36, 24.54, 24.54, 24.78, 24.78, 24.1, 24.1, 24.4, 24.4, 25.04, 25.04, 25.9, 25.9, 26.04, 26.04, 25.18, 25.18, 25.44, 25.44, 25.48, 25.48, 25.54, 25.54, 25.48, 25.48, 25.72, 25.72, 25.64, 25.64, 26.2, 26.2, 25.68, 25.68, 24.92, 24.92, 24.9, 24.9, 24.38, 24.38, 24.34, 24.34, 23.86, 23.86, 24.28, 24.28, 24.26, 24.26, 23.88, 23.88, 23.26, 23.26, 22.52, 22.52, 22.7, 22.7, 24.1, 24.1, 24.92, 24.92, 24.54, 24.54, 24.8, 24.8, 24.42, 24.42, 24.68, 24.68, 23.94, 23.94, 24.62, 24.62, 25.24, 25.24, 24.9, 24.9, 24.94, 24.94, 24.7, 24.7, 24.5, 24.5, 24.8, 24.8, 24.4, 24.4, 24.3, 24.3, 24.54, 24.54, 24.62, 24.62, 23.6, 23.6, 23.92, 23.92, 22.96, 22.96, 22.76, 22.76, 22.64, 22.64, 23.26, 23.26, 24.72, 24.72]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.581, Test loss: 1.592, Test accuracy: 29.02
Round   0, Global train loss: 1.581, Global test loss: 1.593, Global test accuracy: 31.20
Round   1, Train loss: 1.557, Test loss: 1.587, Test accuracy: 23.64
Round   1, Global train loss: 1.557, Global test loss: 1.586, Global test accuracy: 24.80
Round   2, Train loss: 1.535, Test loss: 1.588, Test accuracy: 23.82
Round   2, Global train loss: 1.535, Global test loss: 1.559, Global test accuracy: 25.20
Round   3, Train loss: 1.522, Test loss: 1.583, Test accuracy: 22.92
Round   3, Global train loss: 1.522, Global test loss: 1.542, Global test accuracy: 26.80
Round   4, Train loss: 1.567, Test loss: 1.594, Test accuracy: 20.84
Round   4, Global train loss: 1.567, Global test loss: 1.604, Global test accuracy: 20.40
Round   5, Train loss: 1.574, Test loss: 1.599, Test accuracy: 21.08
Round   5, Global train loss: 1.574, Global test loss: 1.616, Global test accuracy: 19.40
Round   6, Train loss: 1.526, Test loss: 1.610, Test accuracy: 21.36
Round   6, Global train loss: 1.526, Global test loss: 1.613, Global test accuracy: 17.60
Round   7, Train loss: 1.545, Test loss: 1.625, Test accuracy: 24.64
Round   7, Global train loss: 1.545, Global test loss: 1.613, Global test accuracy: 30.20
Round   8, Train loss: 1.559, Test loss: 1.638, Test accuracy: 25.46
Round   8, Global train loss: 1.559, Global test loss: 1.664, Global test accuracy: 24.60
Round   9, Train loss: 1.559, Test loss: 1.664, Test accuracy: 25.36
Round   9, Global train loss: 1.559, Global test loss: 1.701, Global test accuracy: 24.60
Round  10, Train loss: 1.526, Test loss: 1.663, Test accuracy: 26.14
Round  10, Global train loss: 1.526, Global test loss: 1.608, Global test accuracy: 31.00
Round  11, Train loss: 1.492, Test loss: 1.674, Test accuracy: 25.88
Round  11, Global train loss: 1.492, Global test loss: 1.607, Global test accuracy: 34.00
Round  12, Train loss: 1.508, Test loss: 1.688, Test accuracy: 27.72
Round  12, Global train loss: 1.508, Global test loss: 1.595, Global test accuracy: 31.60
Round  13, Train loss: 1.516, Test loss: 1.697, Test accuracy: 28.48
Round  13, Global train loss: 1.516, Global test loss: 1.771, Global test accuracy: 27.80
Round  14, Train loss: 1.519, Test loss: 1.688, Test accuracy: 29.44
Round  14, Global train loss: 1.519, Global test loss: 1.642, Global test accuracy: 33.20
Round  15, Train loss: 1.421, Test loss: 1.692, Test accuracy: 29.44
Round  15, Global train loss: 1.421, Global test loss: 1.485, Global test accuracy: 39.80
Round  16, Train loss: 1.471, Test loss: 1.678, Test accuracy: 29.48
Round  16, Global train loss: 1.471, Global test loss: 1.532, Global test accuracy: 36.20
Round  17, Train loss: 1.490, Test loss: 1.707, Test accuracy: 28.96
Round  17, Global train loss: 1.490, Global test loss: 1.763, Global test accuracy: 26.60
Round  18, Train loss: 1.494, Test loss: 1.698, Test accuracy: 28.38
Round  18, Global train loss: 1.494, Global test loss: 1.714, Global test accuracy: 28.40
Round  19, Train loss: 1.488, Test loss: 1.689, Test accuracy: 28.12
Round  19, Global train loss: 1.488, Global test loss: 1.623, Global test accuracy: 33.20
Round  20, Train loss: 1.457, Test loss: 1.686, Test accuracy: 28.14
Round  20, Global train loss: 1.457, Global test loss: 1.696, Global test accuracy: 28.60
Round  21, Train loss: 1.457, Test loss: 1.686, Test accuracy: 29.14
Round  21, Global train loss: 1.457, Global test loss: 1.688, Global test accuracy: 30.60
Round  22, Train loss: 1.428, Test loss: 1.687, Test accuracy: 28.62
Round  22, Global train loss: 1.428, Global test loss: 1.558, Global test accuracy: 32.80
Round  23, Train loss: 1.372, Test loss: 1.728, Test accuracy: 28.08
Round  23, Global train loss: 1.372, Global test loss: 1.774, Global test accuracy: 28.00
Round  24, Train loss: 1.426, Test loss: 1.709, Test accuracy: 28.02
Round  24, Global train loss: 1.426, Global test loss: 1.786, Global test accuracy: 26.80
Round  25, Train loss: 1.411, Test loss: 1.734, Test accuracy: 28.00
Round  25, Global train loss: 1.411, Global test loss: 1.787, Global test accuracy: 26.80
Round  26, Train loss: 1.397, Test loss: 1.749, Test accuracy: 27.00
Round  26, Global train loss: 1.397, Global test loss: 1.545, Global test accuracy: 32.00
Round  27, Train loss: 1.342, Test loss: 1.777, Test accuracy: 26.42
Round  27, Global train loss: 1.342, Global test loss: 1.677, Global test accuracy: 26.60
Round  28, Train loss: 1.340, Test loss: 1.824, Test accuracy: 26.54
Round  28, Global train loss: 1.340, Global test loss: 1.644, Global test accuracy: 30.60
Round  29, Train loss: 1.326, Test loss: 1.828, Test accuracy: 26.68
Round  29, Global train loss: 1.326, Global test loss: 1.879, Global test accuracy: 24.00
Round  30, Train loss: 1.297, Test loss: 1.840, Test accuracy: 27.08
Round  30, Global train loss: 1.297, Global test loss: 1.659, Global test accuracy: 30.40
Round  31, Train loss: 1.241, Test loss: 1.847, Test accuracy: 26.06
Round  31, Global train loss: 1.241, Global test loss: 1.815, Global test accuracy: 26.60
Round  32, Train loss: 1.186, Test loss: 1.894, Test accuracy: 25.40
Round  32, Global train loss: 1.186, Global test loss: 1.813, Global test accuracy: 29.40
Round  33, Train loss: 1.183, Test loss: 1.901, Test accuracy: 24.92
Round  33, Global train loss: 1.183, Global test loss: 1.761, Global test accuracy: 28.20
Round  34, Train loss: 1.293, Test loss: 1.923, Test accuracy: 24.68
Round  34, Global train loss: 1.293, Global test loss: 1.873, Global test accuracy: 23.00
Round  35, Train loss: 1.120, Test loss: 2.030, Test accuracy: 24.28
Round  35, Global train loss: 1.120, Global test loss: 2.282, Global test accuracy: 17.40
Round  36, Train loss: 1.204, Test loss: 2.057, Test accuracy: 25.34
Round  36, Global train loss: 1.204, Global test loss: 1.558, Global test accuracy: 34.60
Round  37, Train loss: 1.115, Test loss: 2.075, Test accuracy: 26.50
Round  37, Global train loss: 1.115, Global test loss: 2.283, Global test accuracy: 24.20
Round  38, Train loss: 1.121, Test loss: 2.093, Test accuracy: 26.54
Round  38, Global train loss: 1.121, Global test loss: 1.977, Global test accuracy: 26.20
Round  39, Train loss: 1.133, Test loss: 2.120, Test accuracy: 26.66
Round  39, Global train loss: 1.133, Global test loss: 1.996, Global test accuracy: 22.80
Round  40, Train loss: 1.046, Test loss: 2.099, Test accuracy: 26.74
Round  40, Global train loss: 1.046, Global test loss: 2.078, Global test accuracy: 22.00
Round  41, Train loss: 0.999, Test loss: 2.140, Test accuracy: 26.74
Round  41, Global train loss: 0.999, Global test loss: 2.126, Global test accuracy: 22.80
Round  42, Train loss: 0.951, Test loss: 2.171, Test accuracy: 27.08
Round  42, Global train loss: 0.951, Global test loss: 2.289, Global test accuracy: 21.20
Round  43, Train loss: 0.973, Test loss: 2.222, Test accuracy: 27.62
Round  43, Global train loss: 0.973, Global test loss: 1.917, Global test accuracy: 34.60
Round  44, Train loss: 1.079, Test loss: 2.263, Test accuracy: 28.62
Round  44, Global train loss: 1.079, Global test loss: 1.696, Global test accuracy: 33.20
Round  45, Train loss: 0.835, Test loss: 2.328, Test accuracy: 27.50
Round  45, Global train loss: 0.835, Global test loss: 2.218, Global test accuracy: 25.40
Round  46, Train loss: 1.018, Test loss: 2.310, Test accuracy: 28.22
Round  46, Global train loss: 1.018, Global test loss: 1.815, Global test accuracy: 30.80
Round  47, Train loss: 0.799, Test loss: 2.321, Test accuracy: 27.74
Round  47, Global train loss: 0.799, Global test loss: 2.420, Global test accuracy: 23.80
Round  48, Train loss: 0.714, Test loss: 2.421, Test accuracy: 26.76
Round  48, Global train loss: 0.714, Global test loss: 2.650, Global test accuracy: 25.60
Round  49, Train loss: 0.876, Test loss: 2.427, Test accuracy: 26.68
Round  49, Global train loss: 0.876, Global test loss: 2.033, Global test accuracy: 30.40
Round  50, Train loss: 0.843, Test loss: 2.530, Test accuracy: 26.90
Round  50, Global train loss: 0.843, Global test loss: 2.339, Global test accuracy: 26.20
Round  51, Train loss: 0.740, Test loss: 2.635, Test accuracy: 26.68
Round  51, Global train loss: 0.740, Global test loss: 2.278, Global test accuracy: 30.00
Round  52, Train loss: 0.682, Test loss: 2.717, Test accuracy: 26.16
Round  52, Global train loss: 0.682, Global test loss: 2.392, Global test accuracy: 27.20
Round  53, Train loss: 0.969, Test loss: 2.764, Test accuracy: 25.64
Round  53, Global train loss: 0.969, Global test loss: 2.209, Global test accuracy: 26.40
Round  54, Train loss: 0.631, Test loss: 2.794, Test accuracy: 25.96
Round  54, Global train loss: 0.631, Global test loss: 2.101, Global test accuracy: 33.40
Round  55, Train loss: 0.786, Test loss: 2.871, Test accuracy: 24.96
Round  55, Global train loss: 0.786, Global test loss: 2.252, Global test accuracy: 26.00
Round  56, Train loss: 0.600, Test loss: 2.846, Test accuracy: 24.84
Round  56, Global train loss: 0.600, Global test loss: 2.781, Global test accuracy: 26.80
Round  57, Train loss: 0.674, Test loss: 2.854, Test accuracy: 24.94
Round  57, Global train loss: 0.674, Global test loss: 2.274, Global test accuracy: 27.60
Round  58, Train loss: 0.677, Test loss: 2.913, Test accuracy: 26.08
Round  58, Global train loss: 0.677, Global test loss: 2.651, Global test accuracy: 25.80
Round  59, Train loss: 0.641, Test loss: 3.020, Test accuracy: 26.18
Round  59, Global train loss: 0.641, Global test loss: 2.561, Global test accuracy: 29.60
Round  60, Train loss: 0.466, Test loss: 2.992, Test accuracy: 27.04
Round  60, Global train loss: 0.466, Global test loss: 2.279, Global test accuracy: 39.20
Round  61, Train loss: 0.491, Test loss: 3.105, Test accuracy: 26.46
Round  61, Global train loss: 0.491, Global test loss: 2.749, Global test accuracy: 26.60
Round  62, Train loss: 0.609, Test loss: 3.206, Test accuracy: 26.96
Round  62, Global train loss: 0.609, Global test loss: 2.603, Global test accuracy: 33.00
Round  63, Train loss: 0.372, Test loss: 3.249, Test accuracy: 27.10
Round  63, Global train loss: 0.372, Global test loss: 3.095, Global test accuracy: 29.80
Round  64, Train loss: 0.507, Test loss: 3.214, Test accuracy: 27.08
Round  64, Global train loss: 0.507, Global test loss: 2.760, Global test accuracy: 30.40
Round  65, Train loss: 0.466, Test loss: 3.390, Test accuracy: 25.90
Round  65, Global train loss: 0.466, Global test loss: 3.246, Global test accuracy: 25.00
Round  66, Train loss: 0.435, Test loss: 3.573, Test accuracy: 24.78
Round  66, Global train loss: 0.435, Global test loss: 3.256, Global test accuracy: 26.40
Round  67, Train loss: 0.339, Test loss: 3.539, Test accuracy: 25.86
Round  67, Global train loss: 0.339, Global test loss: 3.364, Global test accuracy: 29.80
Round  68, Train loss: 0.441, Test loss: 3.411, Test accuracy: 26.44
Round  68, Global train loss: 0.441, Global test loss: 3.127, Global test accuracy: 31.60
Round  69, Train loss: 0.664, Test loss: 3.502, Test accuracy: 27.50
Round  69, Global train loss: 0.664, Global test loss: 2.840, Global test accuracy: 29.60
Round  70, Train loss: 0.365, Test loss: 3.488, Test accuracy: 28.14
Round  70, Global train loss: 0.365, Global test loss: 2.991, Global test accuracy: 32.00
Round  71, Train loss: 0.607, Test loss: 3.536, Test accuracy: 27.88
Round  71, Global train loss: 0.607, Global test loss: 2.856, Global test accuracy: 29.40
Round  72, Train loss: 0.338, Test loss: 3.578, Test accuracy: 27.12
Round  72, Global train loss: 0.338, Global test loss: 3.277, Global test accuracy: 30.40
Round  73, Train loss: 0.389, Test loss: 3.732, Test accuracy: 26.38
Round  73, Global train loss: 0.389, Global test loss: 3.559, Global test accuracy: 27.40
Round  74, Train loss: 0.573, Test loss: 3.771, Test accuracy: 26.74
Round  74, Global train loss: 0.573, Global test loss: 2.776, Global test accuracy: 30.60
Round  75, Train loss: 0.361, Test loss: 3.796, Test accuracy: 26.06
Round  75, Global train loss: 0.361, Global test loss: 3.787, Global test accuracy: 21.80
Round  76, Train loss: 0.510, Test loss: 3.835, Test accuracy: 25.80
Round  76, Global train loss: 0.510, Global test loss: 3.255, Global test accuracy: 26.80
Round  77, Train loss: 0.323, Test loss: 3.820, Test accuracy: 25.98
Round  77, Global train loss: 0.323, Global test loss: 2.895, Global test accuracy: 32.60
Round  78, Train loss: 0.444, Test loss: 3.900, Test accuracy: 26.04
Round  78, Global train loss: 0.444, Global test loss: 2.998, Global test accuracy: 29.40
Round  79, Train loss: 0.282, Test loss: 3.904, Test accuracy: 25.92
Round  79, Global train loss: 0.282, Global test loss: 2.830, Global test accuracy: 34.20
Round  80, Train loss: 0.521, Test loss: 3.941, Test accuracy: 26.06
Round  80, Global train loss: 0.521, Global test loss: 3.198, Global test accuracy: 26.00
Round  81, Train loss: 0.273, Test loss: 3.971, Test accuracy: 26.32
Round  81, Global train loss: 0.273, Global test loss: 3.442, Global test accuracy: 30.40
Round  82, Train loss: 0.277, Test loss: 3.855, Test accuracy: 26.54
Round  82, Global train loss: 0.277, Global test loss: 3.249, Global test accuracy: 29.60
Round  83, Train loss: 0.385, Test loss: 3.926, Test accuracy: 26.74
Round  83, Global train loss: 0.385, Global test loss: 3.613, Global test accuracy: 25.20
Round  84, Train loss: 0.178, Test loss: 3.987, Test accuracy: 26.02
Round  84, Global train loss: 0.178, Global test loss: 3.954, Global test accuracy: 29.60
Round  85, Train loss: 0.484, Test loss: 3.977, Test accuracy: 26.30
Round  85, Global train loss: 0.484, Global test loss: 3.153, Global test accuracy: 27.80
Round  86, Train loss: 0.310, Test loss: 3.948, Test accuracy: 27.10
Round  86, Global train loss: 0.310, Global test loss: 3.337, Global test accuracy: 30.40
Round  87, Train loss: 0.496, Test loss: 3.975, Test accuracy: 26.80
Round  87, Global train loss: 0.496, Global test loss: 3.089, Global test accuracy: 23.40
Round  88, Train loss: 0.253, Test loss: 4.031, Test accuracy: 27.08
Round  88, Global train loss: 0.253, Global test loss: 4.115, Global test accuracy: 23.20
Round  89, Train loss: 0.313, Test loss: 4.080, Test accuracy: 26.70
Round  89, Global train loss: 0.313, Global test loss: 3.947, Global test accuracy: 26.00
Round  90, Train loss: 0.230, Test loss: 4.169, Test accuracy: 26.88
Round  90, Global train loss: 0.230, Global test loss: 4.250, Global test accuracy: 22.20
Round  91, Train loss: 0.213, Test loss: 4.118, Test accuracy: 26.78
Round  91, Global train loss: 0.213, Global test loss: 4.209, Global test accuracy: 25.40
Round  92, Train loss: 0.448, Test loss: 4.185, Test accuracy: 26.94
Round  92, Global train loss: 0.448, Global test loss: 3.130, Global test accuracy: 29.40
Round  93, Train loss: 0.289, Test loss: 4.204, Test accuracy: 27.52
Round  93, Global train loss: 0.289, Global test loss: 3.559, Global test accuracy: 26.20
Round  94, Train loss: 0.422, Test loss: 4.072, Test accuracy: 28.16
Round  94, Global train loss: 0.422, Global test loss: 2.913, Global test accuracy: 31.60
Round  95, Train loss: 0.250, Test loss: 4.065, Test accuracy: 27.84
Round  95, Global train loss: 0.250, Global test loss: 3.518, Global test accuracy: 31.40
Round  96, Train loss: 0.303, Test loss: 4.226, Test accuracy: 27.18
Round  96, Global train loss: 0.303, Global test loss: 3.466, Global test accuracy: 30.00
Round  97, Train loss: 0.223, Test loss: 4.212, Test accuracy: 27.14
Round  97, Global train loss: 0.223, Global test loss: 4.261, Global test accuracy: 25.00
Round  98, Train loss: 0.320, Test loss: 4.219, Test accuracy: 27.60
Round  98, Global train loss: 0.320, Global test loss: 3.573, Global test accuracy: 27.80
Round  99, Train loss: 0.209, Test loss: 4.242, Test accuracy: 27.52
Round  99, Global train loss: 0.209, Global test loss: 3.192, Global test accuracy: 35.00
Final Round, Train loss: 0.239, Test loss: 4.491, Test accuracy: 27.52
Final Round, Global train loss: 0.239, Global test loss: 3.192, Global test accuracy: 35.00
Average accuracy final 10 rounds: 27.355999999999995
Average global accuracy final 10 rounds: 28.400000000000002
1222.1479353904724
[3.2022132873535156, 6.1888041496276855, 9.13050389289856, 12.1764395236969, 15.13053822517395, 18.10754680633545, 20.947361707687378, 23.946288585662842, 26.900755405426025, 29.883912563323975, 32.86864948272705, 35.87479043006897, 38.77919387817383, 41.76186800003052, 44.77831721305847, 47.68911123275757, 50.670676946640015, 53.65671706199646, 56.58861565589905, 59.63305878639221, 62.7043092250824, 65.67493772506714, 68.68038845062256, 71.59770274162292, 74.69634771347046, 77.64373087882996, 80.65742564201355, 83.59181356430054, 86.52717518806458, 89.41338872909546, 92.28746747970581, 95.25866413116455, 98.25840425491333, 101.36219382286072, 104.32701706886292, 107.53604292869568, 110.58840465545654, 113.66874074935913, 116.7404317855835, 119.73678946495056, 122.73588514328003, 125.72570037841797, 128.72515988349915, 131.7589077949524, 134.74132704734802, 137.9743251800537, 140.9959692955017, 144.019690990448, 147.10021877288818, 150.21299839019775, 153.17812633514404, 156.1017246246338, 159.05635523796082, 162.2142550945282, 165.223571062088, 168.69093871116638, 171.64455771446228, 174.68000674247742, 177.6968114376068, 180.72148203849792, 183.7285521030426, 186.8114321231842, 189.87140440940857, 192.84117245674133, 195.8648920059204, 198.85545253753662, 201.93657779693604, 204.8765766620636, 207.9548704624176, 211.0150327682495, 214.07980751991272, 217.09007048606873, 220.15601682662964, 223.27596974372864, 226.26693773269653, 229.26970195770264, 232.47429895401, 235.6183340549469, 238.71392488479614, 241.76972198486328, 244.79802870750427, 247.88130569458008, 250.96891021728516, 254.00912261009216, 257.087384223938, 260.11892533302307, 263.3724420070648, 266.53469944000244, 269.61852765083313, 272.68945932388306, 275.72513151168823, 278.75678420066833, 281.7691340446472, 284.74616837501526, 287.71838760375977, 290.71829319000244, 293.7637071609497, 296.71371722221375, 299.6466028690338, 302.5767300128937, 307.8288826942444]
[29.02, 23.64, 23.82, 22.92, 20.84, 21.08, 21.36, 24.64, 25.46, 25.36, 26.14, 25.88, 27.72, 28.48, 29.44, 29.44, 29.48, 28.96, 28.38, 28.12, 28.14, 29.14, 28.62, 28.08, 28.02, 28.0, 27.0, 26.42, 26.54, 26.68, 27.08, 26.06, 25.4, 24.92, 24.68, 24.28, 25.34, 26.5, 26.54, 26.66, 26.74, 26.74, 27.08, 27.62, 28.62, 27.5, 28.22, 27.74, 26.76, 26.68, 26.9, 26.68, 26.16, 25.64, 25.96, 24.96, 24.84, 24.94, 26.08, 26.18, 27.04, 26.46, 26.96, 27.1, 27.08, 25.9, 24.78, 25.86, 26.44, 27.5, 28.14, 27.88, 27.12, 26.38, 26.74, 26.06, 25.8, 25.98, 26.04, 25.92, 26.06, 26.32, 26.54, 26.74, 26.02, 26.3, 27.1, 26.8, 27.08, 26.7, 26.88, 26.78, 26.94, 27.52, 28.16, 27.84, 27.18, 27.14, 27.6, 27.52, 27.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.628, Test loss: 1.603, Test accuracy: 28.50
Round   0, Global train loss: 1.628, Global test loss: 1.602, Global test accuracy: 30.20
Round   1, Train loss: 1.605, Test loss: 1.599, Test accuracy: 25.18
Round   1, Global train loss: 1.605, Global test loss: 1.599, Global test accuracy: 24.40
Round   2, Train loss: 1.601, Test loss: 1.598, Test accuracy: 23.76
Round   2, Global train loss: 1.601, Global test loss: 1.598, Global test accuracy: 23.60
Round   3, Train loss: 1.606, Test loss: 1.591, Test accuracy: 25.56
Round   3, Global train loss: 1.606, Global test loss: 1.590, Global test accuracy: 25.60
Round   4, Train loss: 1.595, Test loss: 1.589, Test accuracy: 26.60
Round   4, Global train loss: 1.595, Global test loss: 1.587, Global test accuracy: 30.60
Round   5, Train loss: 1.595, Test loss: 1.590, Test accuracy: 26.40
Round   5, Global train loss: 1.595, Global test loss: 1.590, Global test accuracy: 29.20
Round   6, Train loss: 1.601, Test loss: 1.580, Test accuracy: 27.56
Round   6, Global train loss: 1.601, Global test loss: 1.578, Global test accuracy: 27.00
Round   7, Train loss: 1.593, Test loss: 1.577, Test accuracy: 28.92
Round   7, Global train loss: 1.593, Global test loss: 1.575, Global test accuracy: 31.60
Round   8, Train loss: 1.593, Test loss: 1.570, Test accuracy: 30.34
Round   8, Global train loss: 1.593, Global test loss: 1.570, Global test accuracy: 31.60
Round   9, Train loss: 1.591, Test loss: 1.571, Test accuracy: 31.50
Round   9, Global train loss: 1.591, Global test loss: 1.575, Global test accuracy: 33.60
Round  10, Train loss: 1.593, Test loss: 1.566, Test accuracy: 30.38
Round  10, Global train loss: 1.593, Global test loss: 1.563, Global test accuracy: 29.80
Round  11, Train loss: 1.600, Test loss: 1.564, Test accuracy: 32.72
Round  11, Global train loss: 1.600, Global test loss: 1.563, Global test accuracy: 33.40
Round  12, Train loss: 1.594, Test loss: 1.561, Test accuracy: 32.30
Round  12, Global train loss: 1.594, Global test loss: 1.556, Global test accuracy: 33.80
Round  13, Train loss: 1.587, Test loss: 1.560, Test accuracy: 30.56
Round  13, Global train loss: 1.587, Global test loss: 1.552, Global test accuracy: 31.80
Round  14, Train loss: 1.595, Test loss: 1.567, Test accuracy: 30.58
Round  14, Global train loss: 1.595, Global test loss: 1.567, Global test accuracy: 31.20
Round  15, Train loss: 1.589, Test loss: 1.560, Test accuracy: 31.00
Round  15, Global train loss: 1.589, Global test loss: 1.553, Global test accuracy: 28.80
Round  16, Train loss: 1.587, Test loss: 1.558, Test accuracy: 30.76
Round  16, Global train loss: 1.587, Global test loss: 1.553, Global test accuracy: 31.00
Round  17, Train loss: 1.581, Test loss: 1.562, Test accuracy: 29.76
Round  17, Global train loss: 1.581, Global test loss: 1.557, Global test accuracy: 27.20
Round  18, Train loss: 1.579, Test loss: 1.565, Test accuracy: 29.00
Round  18, Global train loss: 1.579, Global test loss: 1.557, Global test accuracy: 29.80
Round  19, Train loss: 1.583, Test loss: 1.563, Test accuracy: 30.12
Round  19, Global train loss: 1.583, Global test loss: 1.559, Global test accuracy: 31.20
Round  20, Train loss: 1.571, Test loss: 1.562, Test accuracy: 28.48
Round  20, Global train loss: 1.571, Global test loss: 1.550, Global test accuracy: 30.80
Round  21, Train loss: 1.569, Test loss: 1.560, Test accuracy: 28.98
Round  21, Global train loss: 1.569, Global test loss: 1.548, Global test accuracy: 30.60
Round  22, Train loss: 1.587, Test loss: 1.555, Test accuracy: 30.70
Round  22, Global train loss: 1.587, Global test loss: 1.552, Global test accuracy: 32.40
Round  23, Train loss: 1.574, Test loss: 1.548, Test accuracy: 30.46
Round  23, Global train loss: 1.574, Global test loss: 1.537, Global test accuracy: 28.60
Round  24, Train loss: 1.568, Test loss: 1.553, Test accuracy: 30.36
Round  24, Global train loss: 1.568, Global test loss: 1.547, Global test accuracy: 30.60
Round  25, Train loss: 1.549, Test loss: 1.555, Test accuracy: 30.46
Round  25, Global train loss: 1.549, Global test loss: 1.548, Global test accuracy: 34.00
Round  26, Train loss: 1.563, Test loss: 1.556, Test accuracy: 30.36
Round  26, Global train loss: 1.563, Global test loss: 1.550, Global test accuracy: 31.00
Round  27, Train loss: 1.563, Test loss: 1.552, Test accuracy: 30.38
Round  27, Global train loss: 1.563, Global test loss: 1.543, Global test accuracy: 30.40
Round  28, Train loss: 1.559, Test loss: 1.550, Test accuracy: 29.92
Round  28, Global train loss: 1.559, Global test loss: 1.542, Global test accuracy: 29.80
Round  29, Train loss: 1.540, Test loss: 1.557, Test accuracy: 29.50
Round  29, Global train loss: 1.540, Global test loss: 1.547, Global test accuracy: 29.00
Round  30, Train loss: 1.551, Test loss: 1.566, Test accuracy: 28.70
Round  30, Global train loss: 1.551, Global test loss: 1.563, Global test accuracy: 26.20
Round  31, Train loss: 1.541, Test loss: 1.557, Test accuracy: 28.52
Round  31, Global train loss: 1.541, Global test loss: 1.554, Global test accuracy: 28.60
Round  32, Train loss: 1.525, Test loss: 1.555, Test accuracy: 29.32
Round  32, Global train loss: 1.525, Global test loss: 1.547, Global test accuracy: 31.00
Round  33, Train loss: 1.516, Test loss: 1.565, Test accuracy: 28.68
Round  33, Global train loss: 1.516, Global test loss: 1.559, Global test accuracy: 31.60
Round  34, Train loss: 1.532, Test loss: 1.558, Test accuracy: 29.96
Round  34, Global train loss: 1.532, Global test loss: 1.548, Global test accuracy: 32.00
Round  35, Train loss: 1.509, Test loss: 1.557, Test accuracy: 28.26
Round  35, Global train loss: 1.509, Global test loss: 1.554, Global test accuracy: 27.20
Round  36, Train loss: 1.543, Test loss: 1.557, Test accuracy: 29.46
Round  36, Global train loss: 1.543, Global test loss: 1.549, Global test accuracy: 29.20
Round  37, Train loss: 1.502, Test loss: 1.580, Test accuracy: 26.86
Round  37, Global train loss: 1.502, Global test loss: 1.577, Global test accuracy: 26.80
Round  38, Train loss: 1.491, Test loss: 1.576, Test accuracy: 27.98
Round  38, Global train loss: 1.491, Global test loss: 1.564, Global test accuracy: 28.40
Round  39, Train loss: 1.499, Test loss: 1.582, Test accuracy: 27.46
Round  39, Global train loss: 1.499, Global test loss: 1.563, Global test accuracy: 29.00
Round  40, Train loss: 1.477, Test loss: 1.553, Test accuracy: 28.90
Round  40, Global train loss: 1.477, Global test loss: 1.538, Global test accuracy: 28.80
Round  41, Train loss: 1.467, Test loss: 1.585, Test accuracy: 27.76
Round  41, Global train loss: 1.467, Global test loss: 1.585, Global test accuracy: 25.20
Round  42, Train loss: 1.455, Test loss: 1.587, Test accuracy: 26.46
Round  42, Global train loss: 1.455, Global test loss: 1.575, Global test accuracy: 26.80
Round  43, Train loss: 1.474, Test loss: 1.574, Test accuracy: 26.80
Round  43, Global train loss: 1.474, Global test loss: 1.555, Global test accuracy: 26.00
Round  44, Train loss: 1.509, Test loss: 1.581, Test accuracy: 27.20
Round  44, Global train loss: 1.509, Global test loss: 1.574, Global test accuracy: 26.20
Round  45, Train loss: 1.449, Test loss: 1.591, Test accuracy: 25.80
Round  45, Global train loss: 1.449, Global test loss: 1.583, Global test accuracy: 25.00
Round  46, Train loss: 1.499, Test loss: 1.596, Test accuracy: 26.80
Round  46, Global train loss: 1.499, Global test loss: 1.572, Global test accuracy: 30.00
Round  47, Train loss: 1.387, Test loss: 1.604, Test accuracy: 26.70
Round  47, Global train loss: 1.387, Global test loss: 1.616, Global test accuracy: 26.60
Round  48, Train loss: 1.397, Test loss: 1.608, Test accuracy: 26.10
Round  48, Global train loss: 1.397, Global test loss: 1.605, Global test accuracy: 26.00
Round  49, Train loss: 1.454, Test loss: 1.596, Test accuracy: 27.12
Round  49, Global train loss: 1.454, Global test loss: 1.578, Global test accuracy: 28.20
Round  50, Train loss: 1.387, Test loss: 1.635, Test accuracy: 25.46
Round  50, Global train loss: 1.387, Global test loss: 1.639, Global test accuracy: 25.80
Round  51, Train loss: 1.382, Test loss: 1.658, Test accuracy: 25.62
Round  51, Global train loss: 1.382, Global test loss: 1.663, Global test accuracy: 25.40
Round  52, Train loss: 1.391, Test loss: 1.647, Test accuracy: 25.26
Round  52, Global train loss: 1.391, Global test loss: 1.629, Global test accuracy: 25.00
Round  53, Train loss: 1.423, Test loss: 1.681, Test accuracy: 24.96
Round  53, Global train loss: 1.423, Global test loss: 1.642, Global test accuracy: 25.20
Round  54, Train loss: 1.384, Test loss: 1.638, Test accuracy: 26.70
Round  54, Global train loss: 1.384, Global test loss: 1.608, Global test accuracy: 28.40
Round  55, Train loss: 1.410, Test loss: 1.615, Test accuracy: 26.16
Round  55, Global train loss: 1.410, Global test loss: 1.577, Global test accuracy: 28.00
Round  56, Train loss: 1.274, Test loss: 1.666, Test accuracy: 26.66
Round  56, Global train loss: 1.274, Global test loss: 1.697, Global test accuracy: 28.20
Round  57, Train loss: 1.372, Test loss: 1.665, Test accuracy: 26.68
Round  57, Global train loss: 1.372, Global test loss: 1.637, Global test accuracy: 25.20
Round  58, Train loss: 1.312, Test loss: 1.691, Test accuracy: 26.40
Round  58, Global train loss: 1.312, Global test loss: 1.683, Global test accuracy: 25.60
Round  59, Train loss: 1.328, Test loss: 1.707, Test accuracy: 24.86
Round  59, Global train loss: 1.328, Global test loss: 1.664, Global test accuracy: 24.00
Round  60, Train loss: 1.271, Test loss: 1.679, Test accuracy: 26.58
Round  60, Global train loss: 1.271, Global test loss: 1.668, Global test accuracy: 26.20
Round  61, Train loss: 1.237, Test loss: 1.738, Test accuracy: 24.60
Round  61, Global train loss: 1.237, Global test loss: 1.733, Global test accuracy: 26.20
Round  62, Train loss: 1.288, Test loss: 1.735, Test accuracy: 25.26
Round  62, Global train loss: 1.288, Global test loss: 1.693, Global test accuracy: 26.00
Round  63, Train loss: 1.119, Test loss: 1.721, Test accuracy: 25.84
Round  63, Global train loss: 1.119, Global test loss: 1.755, Global test accuracy: 26.80
Round  64, Train loss: 1.186, Test loss: 1.748, Test accuracy: 24.84
Round  64, Global train loss: 1.186, Global test loss: 1.738, Global test accuracy: 27.20
Round  65, Train loss: 1.129, Test loss: 1.771, Test accuracy: 24.16
Round  65, Global train loss: 1.129, Global test loss: 1.814, Global test accuracy: 24.20
Round  66, Train loss: 1.164, Test loss: 1.747, Test accuracy: 25.12
Round  66, Global train loss: 1.164, Global test loss: 1.749, Global test accuracy: 24.40
Round  67, Train loss: 1.035, Test loss: 1.820, Test accuracy: 24.34
Round  67, Global train loss: 1.035, Global test loss: 1.923, Global test accuracy: 25.20
Round  68, Train loss: 1.107, Test loss: 1.804, Test accuracy: 24.82
Round  68, Global train loss: 1.107, Global test loss: 1.801, Global test accuracy: 26.00
Round  69, Train loss: 1.213, Test loss: 1.881, Test accuracy: 23.86
Round  69, Global train loss: 1.213, Global test loss: 1.770, Global test accuracy: 23.00
Round  70, Train loss: 1.044, Test loss: 1.838, Test accuracy: 23.88
Round  70, Global train loss: 1.044, Global test loss: 1.875, Global test accuracy: 23.80
Round  71, Train loss: 1.173, Test loss: 1.829, Test accuracy: 27.08
Round  71, Global train loss: 1.173, Global test loss: 1.749, Global test accuracy: 27.40
Round  72, Train loss: 1.021, Test loss: 1.915, Test accuracy: 24.78
Round  72, Global train loss: 1.021, Global test loss: 1.954, Global test accuracy: 24.80
Round  73, Train loss: 1.001, Test loss: 1.820, Test accuracy: 28.60
Round  73, Global train loss: 1.001, Global test loss: 1.829, Global test accuracy: 29.80
Round  74, Train loss: 1.151, Test loss: 1.900, Test accuracy: 27.94
Round  74, Global train loss: 1.151, Global test loss: 1.793, Global test accuracy: 29.00
Round  75, Train loss: 0.919, Test loss: 2.059, Test accuracy: 22.66
Round  75, Global train loss: 0.919, Global test loss: 2.143, Global test accuracy: 23.40
Round  76, Train loss: 1.073, Test loss: 1.934, Test accuracy: 26.92
Round  76, Global train loss: 1.073, Global test loss: 1.839, Global test accuracy: 27.40
Round  77, Train loss: 1.015, Test loss: 1.946, Test accuracy: 24.50
Round  77, Global train loss: 1.015, Global test loss: 1.957, Global test accuracy: 25.60
Round  78, Train loss: 1.038, Test loss: 2.038, Test accuracy: 21.98
Round  78, Global train loss: 1.038, Global test loss: 1.981, Global test accuracy: 22.20
Round  79, Train loss: 0.936, Test loss: 1.978, Test accuracy: 23.60
Round  79, Global train loss: 0.936, Global test loss: 1.986, Global test accuracy: 22.40
Round  80, Train loss: 1.062, Test loss: 2.014, Test accuracy: 27.42
Round  80, Global train loss: 1.062, Global test loss: 1.892, Global test accuracy: 27.40
Round  81, Train loss: 0.813, Test loss: 2.081, Test accuracy: 23.46
Round  81, Global train loss: 0.813, Global test loss: 2.193, Global test accuracy: 23.00
Round  82, Train loss: 0.823, Test loss: 2.070, Test accuracy: 25.06
Round  82, Global train loss: 0.823, Global test loss: 2.126, Global test accuracy: 26.40
Round  83, Train loss: 0.902, Test loss: 2.124, Test accuracy: 23.38
Round  83, Global train loss: 0.902, Global test loss: 2.104, Global test accuracy: 22.80
Round  84, Train loss: 0.672, Test loss: 2.106, Test accuracy: 23.74
Round  84, Global train loss: 0.672, Global test loss: 2.322, Global test accuracy: 23.40
Round  85, Train loss: 0.961, Test loss: 2.077, Test accuracy: 25.78
Round  85, Global train loss: 0.961, Global test loss: 1.932, Global test accuracy: 27.00
Round  86, Train loss: 0.906, Test loss: 2.055, Test accuracy: 25.44
Round  86, Global train loss: 0.906, Global test loss: 2.012, Global test accuracy: 25.20
Round  87, Train loss: 1.037, Test loss: 2.149, Test accuracy: 23.84
Round  87, Global train loss: 1.037, Global test loss: 1.949, Global test accuracy: 24.60
Round  88, Train loss: 0.755, Test loss: 2.206, Test accuracy: 24.04
Round  88, Global train loss: 0.755, Global test loss: 2.294, Global test accuracy: 24.20
Round  89, Train loss: 0.773, Test loss: 2.236, Test accuracy: 22.58
Round  89, Global train loss: 0.773, Global test loss: 2.281, Global test accuracy: 22.40
Round  90, Train loss: 0.684, Test loss: 2.213, Test accuracy: 27.22
Round  90, Global train loss: 0.684, Global test loss: 2.306, Global test accuracy: 28.00
Round  91, Train loss: 0.601, Test loss: 2.262, Test accuracy: 24.92
Round  91, Global train loss: 0.601, Global test loss: 2.469, Global test accuracy: 24.60
Round  92, Train loss: 1.020, Test loss: 2.129, Test accuracy: 28.98
Round  92, Global train loss: 1.020, Global test loss: 1.896, Global test accuracy: 29.80
Round  93, Train loss: 0.785, Test loss: 2.237, Test accuracy: 27.02
Round  93, Global train loss: 0.785, Global test loss: 2.170, Global test accuracy: 27.80
Round  94, Train loss: 0.932, Test loss: 2.324, Test accuracy: 24.10
Round  94, Global train loss: 0.932, Global test loss: 2.064, Global test accuracy: 22.80
Round  95, Train loss: 0.675, Test loss: 2.353, Test accuracy: 23.36
Round  95, Global train loss: 0.675, Global test loss: 2.397, Global test accuracy: 24.00
Round  96, Train loss: 0.827, Test loss: 2.441, Test accuracy: 22.42
Round  96, Global train loss: 0.827, Global test loss: 2.324, Global test accuracy: 23.60
Round  97, Train loss: 0.604, Test loss: 2.337, Test accuracy: 26.14
Round  97, Global train loss: 0.604, Global test loss: 2.472, Global test accuracy: 25.20
Round  98, Train loss: 0.762, Test loss: 2.403, Test accuracy: 25.08
Round  98, Global train loss: 0.762, Global test loss: 2.357, Global test accuracy: 25.20
Round  99, Train loss: 0.694, Test loss: 2.216, Test accuracy: 26.52
Round  99, Global train loss: 0.694, Global test loss: 2.239, Global test accuracy: 27.20
Final Round, Train loss: 0.647, Test loss: 2.337, Test accuracy: 26.84
Final Round, Global train loss: 0.647, Global test loss: 2.239, Global test accuracy: 27.20
Average accuracy final 10 rounds: 25.576
715.2064573764801
[1.848048448562622, 3.571411371231079, 5.070936679840088, 6.5568578243255615, 8.028751134872437, 9.518083572387695, 11.01796293258667, 12.500190496444702, 13.963244676589966, 15.44868803024292, 16.921899795532227, 18.41266918182373, 19.88337731361389, 21.3535737991333, 22.84787154197693, 24.32888889312744, 25.83038306236267, 27.3291232585907, 28.785735607147217, 30.266155004501343, 31.727688550949097, 33.19047284126282, 34.651732206344604, 36.14843964576721, 37.62401008605957, 39.09071183204651, 40.57365322113037, 42.049949645996094, 43.507989168167114, 44.9578378200531, 46.427239656448364, 47.90915870666504, 49.35704851150513, 50.80418634414673, 52.27732062339783, 53.76108646392822, 55.25650072097778, 56.774418592453, 58.25901126861572, 59.75258946418762, 61.24292612075806, 62.7258734703064, 64.20895624160767, 65.70167851448059, 67.1838948726654, 68.65733432769775, 70.14401340484619, 71.63649988174438, 73.12409806251526, 74.65873694419861, 76.18426299095154, 77.66374802589417, 79.15348434448242, 80.6311604976654, 82.112384557724, 83.60891008377075, 85.08814907073975, 86.57474136352539, 88.05187463760376, 89.51536202430725, 91.01032400131226, 92.43963503837585, 93.84730315208435, 95.26839423179626, 96.7032904624939, 98.18953895568848, 99.76762199401855, 101.20120120048523, 102.61609363555908, 104.03639006614685, 105.4488513469696, 106.88954496383667, 108.29856705665588, 109.7179651260376, 111.12783432006836, 112.5245885848999, 113.92917966842651, 115.35385346412659, 116.81706857681274, 118.22293543815613, 119.63262033462524, 121.03614974021912, 122.56883478164673, 123.96595621109009, 125.32871055603027, 126.72086000442505, 128.0806393623352, 129.47628092765808, 130.9203338623047, 132.32480597496033, 133.72261333465576, 135.11407375335693, 136.49589037895203, 137.91592597961426, 139.34300541877747, 140.82183456420898, 142.30202269554138, 143.78149819374084, 145.33414816856384, 146.9053556919098, 149.07679176330566]
[28.5, 25.18, 23.76, 25.56, 26.6, 26.4, 27.56, 28.92, 30.34, 31.5, 30.38, 32.72, 32.3, 30.56, 30.58, 31.0, 30.76, 29.76, 29.0, 30.12, 28.48, 28.98, 30.7, 30.46, 30.36, 30.46, 30.36, 30.38, 29.92, 29.5, 28.7, 28.52, 29.32, 28.68, 29.96, 28.26, 29.46, 26.86, 27.98, 27.46, 28.9, 27.76, 26.46, 26.8, 27.2, 25.8, 26.8, 26.7, 26.1, 27.12, 25.46, 25.62, 25.26, 24.96, 26.7, 26.16, 26.66, 26.68, 26.4, 24.86, 26.58, 24.6, 25.26, 25.84, 24.84, 24.16, 25.12, 24.34, 24.82, 23.86, 23.88, 27.08, 24.78, 28.6, 27.94, 22.66, 26.92, 24.5, 21.98, 23.6, 27.42, 23.46, 25.06, 23.38, 23.74, 25.78, 25.44, 23.84, 24.04, 22.58, 27.22, 24.92, 28.98, 27.02, 24.1, 23.36, 22.42, 26.14, 25.08, 26.52, 26.84]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1062789 (local), 1062144 (global); Percentage 99.94 (1062144/1062789)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=5, bias=True)
)
Round   0, Train loss: 1.625, Test loss: 1.605, Test accuracy: 20.96
Round   0, Global train loss: 1.625, Global test loss: 1.604, Global test accuracy: 19.60
Round   1, Train loss: 1.600, Test loss: 1.604, Test accuracy: 20.36
Round   1, Global train loss: 1.600, Global test loss: 1.601, Global test accuracy: 19.20
Round   2, Train loss: 1.598, Test loss: 1.602, Test accuracy: 21.10
Round   2, Global train loss: 1.598, Global test loss: 1.597, Global test accuracy: 19.60
Round   3, Train loss: 1.595, Test loss: 1.599, Test accuracy: 21.72
Round   3, Global train loss: 1.595, Global test loss: 1.592, Global test accuracy: 22.20
Round   4, Train loss: 1.592, Test loss: 1.592, Test accuracy: 23.40
Round   4, Global train loss: 1.592, Global test loss: 1.584, Global test accuracy: 25.20
Round   5, Train loss: 1.590, Test loss: 1.586, Test accuracy: 24.82
Round   5, Global train loss: 1.590, Global test loss: 1.578, Global test accuracy: 28.40
Round   6, Train loss: 1.588, Test loss: 1.582, Test accuracy: 25.08
Round   6, Global train loss: 1.588, Global test loss: 1.574, Global test accuracy: 28.60
Round   7, Train loss: 1.586, Test loss: 1.577, Test accuracy: 26.36
Round   7, Global train loss: 1.586, Global test loss: 1.569, Global test accuracy: 30.20
Round   8, Train loss: 1.584, Test loss: 1.576, Test accuracy: 26.72
Round   8, Global train loss: 1.584, Global test loss: 1.568, Global test accuracy: 30.40
Round   9, Train loss: 1.581, Test loss: 1.574, Test accuracy: 26.54
Round   9, Global train loss: 1.581, Global test loss: 1.566, Global test accuracy: 28.80
Round  10, Train loss: 1.583, Test loss: 1.573, Test accuracy: 26.06
Round  10, Global train loss: 1.583, Global test loss: 1.557, Global test accuracy: 33.60
Round  11, Train loss: 1.500, Test loss: 1.570, Test accuracy: 28.50
Round  11, Global train loss: 1.500, Global test loss: 1.557, Global test accuracy: 28.60
Round  12, Train loss: 1.487, Test loss: 1.606, Test accuracy: 25.44
Round  12, Global train loss: 1.487, Global test loss: 1.591, Global test accuracy: 24.40
Round  13, Train loss: 1.506, Test loss: 1.667, Test accuracy: 21.12
Round  13, Global train loss: 1.506, Global test loss: 1.633, Global test accuracy: 18.40
Round  14, Train loss: 1.443, Test loss: 1.686, Test accuracy: 22.62
Round  14, Global train loss: 1.443, Global test loss: 1.629, Global test accuracy: 23.20
Round  15, Train loss: 1.454, Test loss: 1.699, Test accuracy: 21.54
Round  15, Global train loss: 1.454, Global test loss: 1.643, Global test accuracy: 21.00
Round  16, Train loss: 1.461, Test loss: 1.656, Test accuracy: 23.56
Round  16, Global train loss: 1.461, Global test loss: 1.594, Global test accuracy: 26.00
Round  17, Train loss: 1.457, Test loss: 1.672, Test accuracy: 23.54
Round  17, Global train loss: 1.457, Global test loss: 1.635, Global test accuracy: 25.00
Round  18, Train loss: 1.469, Test loss: 1.640, Test accuracy: 24.02
Round  18, Global train loss: 1.469, Global test loss: 1.581, Global test accuracy: 25.00
Round  19, Train loss: 1.483, Test loss: 1.614, Test accuracy: 26.42
Round  19, Global train loss: 1.483, Global test loss: 1.574, Global test accuracy: 27.40
Round  20, Train loss: 1.498, Test loss: 1.628, Test accuracy: 22.88
Round  20, Global train loss: 1.498, Global test loss: 1.615, Global test accuracy: 21.20
Round  21, Train loss: 1.434, Test loss: 1.625, Test accuracy: 23.10
Round  21, Global train loss: 1.434, Global test loss: 1.598, Global test accuracy: 21.60
Round  22, Train loss: 1.482, Test loss: 1.588, Test accuracy: 25.52
Round  22, Global train loss: 1.482, Global test loss: 1.566, Global test accuracy: 35.00
Round  23, Train loss: 1.422, Test loss: 1.654, Test accuracy: 23.96
Round  23, Global train loss: 1.422, Global test loss: 1.689, Global test accuracy: 22.00
Round  24, Train loss: 1.451, Test loss: 1.664, Test accuracy: 23.02
Round  24, Global train loss: 1.451, Global test loss: 1.637, Global test accuracy: 23.20
Round  25, Train loss: 1.479, Test loss: 1.636, Test accuracy: 22.60
Round  25, Global train loss: 1.479, Global test loss: 1.641, Global test accuracy: 21.20
Round  26, Train loss: 1.439, Test loss: 1.619, Test accuracy: 24.70
Round  26, Global train loss: 1.439, Global test loss: 1.589, Global test accuracy: 25.60
Round  27, Train loss: 1.422, Test loss: 1.639, Test accuracy: 23.62
Round  27, Global train loss: 1.422, Global test loss: 1.668, Global test accuracy: 24.80
Round  28, Train loss: 1.425, Test loss: 1.601, Test accuracy: 25.70
Round  28, Global train loss: 1.425, Global test loss: 1.575, Global test accuracy: 28.20
Round  29, Train loss: 1.436, Test loss: 1.627, Test accuracy: 22.94
Round  29, Global train loss: 1.436, Global test loss: 1.643, Global test accuracy: 22.40
Round  30, Train loss: 1.419, Test loss: 1.624, Test accuracy: 22.96
Round  30, Global train loss: 1.419, Global test loss: 1.602, Global test accuracy: 24.60
Round  31, Train loss: 1.437, Test loss: 1.657, Test accuracy: 21.08
Round  31, Global train loss: 1.437, Global test loss: 1.671, Global test accuracy: 18.40
Round  32, Train loss: 1.427, Test loss: 1.666, Test accuracy: 22.08
Round  32, Global train loss: 1.427, Global test loss: 1.678, Global test accuracy: 24.00
Round  33, Train loss: 1.452, Test loss: 1.658, Test accuracy: 21.36
Round  33, Global train loss: 1.452, Global test loss: 1.660, Global test accuracy: 23.80
Round  34, Train loss: 1.447, Test loss: 1.623, Test accuracy: 22.32
Round  34, Global train loss: 1.447, Global test loss: 1.591, Global test accuracy: 27.20
Round  35, Train loss: 1.411, Test loss: 1.654, Test accuracy: 21.76
Round  35, Global train loss: 1.411, Global test loss: 1.693, Global test accuracy: 20.40
Round  36, Train loss: 1.399, Test loss: 1.600, Test accuracy: 25.66
Round  36, Global train loss: 1.399, Global test loss: 1.569, Global test accuracy: 25.40
Round  37, Train loss: 1.414, Test loss: 1.640, Test accuracy: 23.08
Round  37, Global train loss: 1.414, Global test loss: 1.678, Global test accuracy: 23.00
Round  38, Train loss: 1.401, Test loss: 1.626, Test accuracy: 22.72
Round  38, Global train loss: 1.401, Global test loss: 1.605, Global test accuracy: 23.00
Round  39, Train loss: 1.428, Test loss: 1.582, Test accuracy: 26.24
Round  39, Global train loss: 1.428, Global test loss: 1.543, Global test accuracy: 29.20
Round  40, Train loss: 1.381, Test loss: 1.598, Test accuracy: 24.56
Round  40, Global train loss: 1.381, Global test loss: 1.584, Global test accuracy: 24.80
Round  41, Train loss: 1.431, Test loss: 1.582, Test accuracy: 25.52
Round  41, Global train loss: 1.431, Global test loss: 1.554, Global test accuracy: 26.00
Round  42, Train loss: 1.373, Test loss: 1.630, Test accuracy: 23.44
Round  42, Global train loss: 1.373, Global test loss: 1.633, Global test accuracy: 24.20
Round  43, Train loss: 1.388, Test loss: 1.611, Test accuracy: 23.44
Round  43, Global train loss: 1.388, Global test loss: 1.571, Global test accuracy: 25.80
Round  44, Train loss: 1.449, Test loss: 1.588, Test accuracy: 27.56
Round  44, Global train loss: 1.449, Global test loss: 1.576, Global test accuracy: 30.00
Round  45, Train loss: 1.415, Test loss: 1.605, Test accuracy: 25.36
Round  45, Global train loss: 1.415, Global test loss: 1.614, Global test accuracy: 25.60
Round  46, Train loss: 1.437, Test loss: 1.618, Test accuracy: 24.56
Round  46, Global train loss: 1.437, Global test loss: 1.595, Global test accuracy: 26.80
Round  47, Train loss: 1.516, Test loss: 1.621, Test accuracy: 23.94
Round  47, Global train loss: 1.516, Global test loss: 1.645, Global test accuracy: 24.00
Round  48, Train loss: 1.397, Test loss: 1.624, Test accuracy: 23.62
Round  48, Global train loss: 1.397, Global test loss: 1.653, Global test accuracy: 22.40
Round  49, Train loss: 1.428, Test loss: 1.598, Test accuracy: 26.62
Round  49, Global train loss: 1.428, Global test loss: 1.576, Global test accuracy: 28.80
Round  50, Train loss: 1.397, Test loss: 1.580, Test accuracy: 28.68
Round  50, Global train loss: 1.397, Global test loss: 1.558, Global test accuracy: 27.00
Round  51, Train loss: 1.415, Test loss: 1.592, Test accuracy: 27.16
Round  51, Global train loss: 1.415, Global test loss: 1.595, Global test accuracy: 26.40
Round  52, Train loss: 1.398, Test loss: 1.621, Test accuracy: 25.20
Round  52, Global train loss: 1.398, Global test loss: 1.621, Global test accuracy: 23.40
Round  53, Train loss: 1.444, Test loss: 1.591, Test accuracy: 28.96
Round  53, Global train loss: 1.444, Global test loss: 1.570, Global test accuracy: 30.00
Round  54, Train loss: 1.386, Test loss: 1.640, Test accuracy: 24.30
Round  54, Global train loss: 1.386, Global test loss: 1.624, Global test accuracy: 21.40
Round  55, Train loss: 1.404, Test loss: 1.644, Test accuracy: 25.70
Round  55, Global train loss: 1.404, Global test loss: 1.614, Global test accuracy: 29.20
Round  56, Train loss: 1.465, Test loss: 1.645, Test accuracy: 24.34
Round  56, Global train loss: 1.465, Global test loss: 1.673, Global test accuracy: 24.60
Round  57, Train loss: 1.352, Test loss: 1.606, Test accuracy: 25.94
Round  57, Global train loss: 1.352, Global test loss: 1.567, Global test accuracy: 26.20
Round  58, Train loss: 1.364, Test loss: 1.593, Test accuracy: 28.16
Round  58, Global train loss: 1.364, Global test loss: 1.540, Global test accuracy: 32.60
Round  59, Train loss: 1.302, Test loss: 1.618, Test accuracy: 26.88
Round  59, Global train loss: 1.302, Global test loss: 1.600, Global test accuracy: 26.20
Round  60, Train loss: 1.302, Test loss: 1.655, Test accuracy: 24.92
Round  60, Global train loss: 1.302, Global test loss: 1.631, Global test accuracy: 22.00
Round  61, Train loss: 1.320, Test loss: 1.629, Test accuracy: 24.46
Round  61, Global train loss: 1.320, Global test loss: 1.624, Global test accuracy: 22.00
Round  62, Train loss: 1.341, Test loss: 1.589, Test accuracy: 28.60
Round  62, Global train loss: 1.341, Global test loss: 1.554, Global test accuracy: 30.20
Round  63, Train loss: 1.384, Test loss: 1.670, Test accuracy: 24.84
Round  63, Global train loss: 1.384, Global test loss: 1.708, Global test accuracy: 22.20
Round  64, Train loss: 1.331, Test loss: 1.637, Test accuracy: 25.06
Round  64, Global train loss: 1.331, Global test loss: 1.614, Global test accuracy: 27.00
Round  65, Train loss: 1.288, Test loss: 1.659, Test accuracy: 24.16
Round  65, Global train loss: 1.288, Global test loss: 1.652, Global test accuracy: 24.80
Round  66, Train loss: 1.297, Test loss: 1.702, Test accuracy: 21.92
Round  66, Global train loss: 1.297, Global test loss: 1.699, Global test accuracy: 18.80
Round  67, Train loss: 1.299, Test loss: 1.710, Test accuracy: 22.24
Round  67, Global train loss: 1.299, Global test loss: 1.768, Global test accuracy: 22.20
Round  68, Train loss: 1.345, Test loss: 1.687, Test accuracy: 23.82
Round  68, Global train loss: 1.345, Global test loss: 1.678, Global test accuracy: 24.40
Round  69, Train loss: 1.315, Test loss: 1.702, Test accuracy: 24.88
Round  69, Global train loss: 1.315, Global test loss: 1.659, Global test accuracy: 25.20
Round  70, Train loss: 1.223, Test loss: 1.747, Test accuracy: 21.90
Round  70, Global train loss: 1.223, Global test loss: 1.754, Global test accuracy: 19.00
Round  71, Train loss: 1.270, Test loss: 1.709, Test accuracy: 23.92
Round  71, Global train loss: 1.270, Global test loss: 1.671, Global test accuracy: 26.60
Round  72, Train loss: 1.204, Test loss: 1.766, Test accuracy: 20.92
Round  72, Global train loss: 1.204, Global test loss: 1.774, Global test accuracy: 20.00
Round  73, Train loss: 1.241, Test loss: 1.767, Test accuracy: 24.66
Round  73, Global train loss: 1.241, Global test loss: 1.812, Global test accuracy: 23.40
Round  74, Train loss: 1.257, Test loss: 1.822, Test accuracy: 23.26
Round  74, Global train loss: 1.257, Global test loss: 1.766, Global test accuracy: 22.60
Round  75, Train loss: 1.153, Test loss: 1.800, Test accuracy: 25.68
Round  75, Global train loss: 1.153, Global test loss: 1.824, Global test accuracy: 24.40
Round  76, Train loss: 1.210, Test loss: 1.804, Test accuracy: 23.62
Round  76, Global train loss: 1.210, Global test loss: 1.758, Global test accuracy: 23.40
Round  77, Train loss: 1.178, Test loss: 1.746, Test accuracy: 26.22
Round  77, Global train loss: 1.178, Global test loss: 1.726, Global test accuracy: 26.00
Round  78, Train loss: 1.154, Test loss: 1.732, Test accuracy: 26.88
Round  78, Global train loss: 1.154, Global test loss: 1.676, Global test accuracy: 27.80
Round  79, Train loss: 1.084, Test loss: 1.849, Test accuracy: 22.24
Round  79, Global train loss: 1.084, Global test loss: 1.845, Global test accuracy: 22.40
Round  80, Train loss: 1.066, Test loss: 1.846, Test accuracy: 22.96
Round  80, Global train loss: 1.066, Global test loss: 1.911, Global test accuracy: 21.80
Round  81, Train loss: 1.005, Test loss: 1.919, Test accuracy: 22.80
Round  81, Global train loss: 1.005, Global test loss: 2.003, Global test accuracy: 21.40
Round  82, Train loss: 0.971, Test loss: 1.947, Test accuracy: 23.84
Round  82, Global train loss: 0.971, Global test loss: 2.039, Global test accuracy: 22.00
Round  83, Train loss: 0.942, Test loss: 1.948, Test accuracy: 24.10
Round  83, Global train loss: 0.942, Global test loss: 2.051, Global test accuracy: 23.80
Round  84, Train loss: 0.916, Test loss: 1.943, Test accuracy: 24.88
Round  84, Global train loss: 0.916, Global test loss: 2.045, Global test accuracy: 25.40
Round  85, Train loss: 0.886, Test loss: 1.980, Test accuracy: 23.34
Round  85, Global train loss: 0.886, Global test loss: 2.094, Global test accuracy: 22.80
Round  86, Train loss: 0.851, Test loss: 1.988, Test accuracy: 24.88
Round  86, Global train loss: 0.851, Global test loss: 2.107, Global test accuracy: 24.40
Round  87, Train loss: 0.822, Test loss: 2.017, Test accuracy: 25.22
Round  87, Global train loss: 0.822, Global test loss: 2.145, Global test accuracy: 24.60
Round  88, Train loss: 0.799, Test loss: 2.086, Test accuracy: 24.14
Round  88, Global train loss: 0.799, Global test loss: 2.241, Global test accuracy: 22.60
Round  89, Train loss: 0.786, Test loss: 2.073, Test accuracy: 24.32
Round  89, Global train loss: 0.786, Global test loss: 2.222, Global test accuracy: 24.80
Round  90, Train loss: 0.742, Test loss: 2.128, Test accuracy: 24.02
Round  90, Global train loss: 0.742, Global test loss: 2.301, Global test accuracy: 24.00
Round  91, Train loss: 0.723, Test loss: 2.203, Test accuracy: 23.64
Round  91, Global train loss: 0.723, Global test loss: 2.398, Global test accuracy: 23.80
Round  92, Train loss: 0.699, Test loss: 2.176, Test accuracy: 23.86
Round  92, Global train loss: 0.699, Global test loss: 2.360, Global test accuracy: 23.80
Round  93, Train loss: 0.672, Test loss: 2.210, Test accuracy: 23.48
Round  93, Global train loss: 0.672, Global test loss: 2.405, Global test accuracy: 22.00
Round  94, Train loss: 0.651, Test loss: 2.292, Test accuracy: 22.34
Round  94, Global train loss: 0.651, Global test loss: 2.519, Global test accuracy: 21.20
Round  95, Train loss: 0.635, Test loss: 2.310, Test accuracy: 23.46
Round  95, Global train loss: 0.635, Global test loss: 2.548, Global test accuracy: 23.80
Round  96, Train loss: 0.617, Test loss: 2.239, Test accuracy: 24.24
Round  96, Global train loss: 0.617, Global test loss: 2.457, Global test accuracy: 23.80
Round  97, Train loss: 0.594, Test loss: 2.375, Test accuracy: 21.30
Round  97, Global train loss: 0.594, Global test loss: 2.631, Global test accuracy: 21.40
Round  98, Train loss: 0.558, Test loss: 2.374, Test accuracy: 21.88
Round  98, Global train loss: 0.558, Global test loss: 2.636, Global test accuracy: 22.20
Round  99, Train loss: 0.734, Test loss: 2.308, Test accuracy: 22.72
Round  99, Global train loss: 0.734, Global test loss: 2.225, Global test accuracy: 22.00
Final Round, Train loss: 0.620, Test loss: 2.408, Test accuracy: 22.60
Final Round, Global train loss: 0.620, Global test loss: 2.225, Global test accuracy: 22.00
Average accuracy final 10 rounds: 23.093999999999998
1853.6437137126923
[1.818040370941162, 3.355975866317749, 4.916071176528931, 6.445713996887207, 8.207751750946045, 9.740082025527954, 11.274235486984253, 12.823433637619019, 14.412053346633911, 15.956161737442017, 21.517175436019897, 29.425880670547485, 37.28213691711426, 45.02942371368408, 52.867812395095825, 61.09987664222717, 68.93466520309448, 76.72182154655457, 84.4927487373352, 92.4289801120758, 100.40870070457458, 108.23779249191284, 115.98667693138123, 123.78176641464233, 131.676771402359, 139.41486763954163, 147.19884133338928, 155.00359678268433, 162.86381435394287, 170.86651849746704, 178.74232053756714, 186.59119987487793, 194.41652083396912, 202.30628299713135, 210.66132235527039, 218.79409837722778, 226.93926215171814, 235.03293466567993, 243.627543926239, 251.6039843559265, 259.58485555648804, 267.5329008102417, 275.6130166053772, 284.0557096004486, 292.0940291881561, 300.2622549533844, 308.22486543655396, 309.7553653717041, 317.82962226867676, 326.3505551815033, 334.37549686431885, 342.41247391700745, 350.45728158950806, 358.72826862335205, 366.7281198501587, 375.2072591781616, 376.677161693573, 384.67243933677673, 392.61904764175415, 400.45766520500183, 408.31999349594116, 416.2087867259979, 424.59172320365906, 426.0545246601105, 433.8438138961792, 441.8047442436218, 449.4846889972687, 450.958389043808, 452.4353337287903, 460.6860074996948, 468.8371932506561, 476.9887373447418, 484.98972749710083, 486.46666979789734, 494.24327516555786, 495.68581461906433, 503.4885730743408, 511.6137914657593, 519.4787619113922, 527.2863352298737, 528.7957057952881, 530.2483415603638, 531.7420210838318, 533.1939797401428, 534.6769111156464, 536.1442556381226, 537.6315324306488, 539.1185774803162, 540.59699177742, 542.2103550434113, 543.6818597316742, 545.1460490226746, 546.5982394218445, 548.0512435436249, 549.5091462135315, 550.9782195091248, 552.4598507881165, 553.931515455246, 555.6923129558563, 563.6322438716888, 572.1723637580872]
[20.96, 20.36, 21.1, 21.72, 23.4, 24.82, 25.08, 26.36, 26.72, 26.54, 26.06, 28.5, 25.44, 21.12, 22.62, 21.54, 23.56, 23.54, 24.02, 26.42, 22.88, 23.1, 25.52, 23.96, 23.02, 22.6, 24.7, 23.62, 25.7, 22.94, 22.96, 21.08, 22.08, 21.36, 22.32, 21.76, 25.66, 23.08, 22.72, 26.24, 24.56, 25.52, 23.44, 23.44, 27.56, 25.36, 24.56, 23.94, 23.62, 26.62, 28.68, 27.16, 25.2, 28.96, 24.3, 25.7, 24.34, 25.94, 28.16, 26.88, 24.92, 24.46, 28.6, 24.84, 25.06, 24.16, 21.92, 22.24, 23.82, 24.88, 21.9, 23.92, 20.92, 24.66, 23.26, 25.68, 23.62, 26.22, 26.88, 22.24, 22.96, 22.8, 23.84, 24.1, 24.88, 23.34, 24.88, 25.22, 24.14, 24.32, 24.02, 23.64, 23.86, 23.48, 22.34, 23.46, 24.24, 21.3, 21.88, 22.72, 22.6]
