nohup: 忽略输入
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.638, Test loss: 0.697, Test accuracy: 74.40 

Round   0, Global train loss: 0.638, Global test loss: 0.756, Global test accuracy: 50.60 

Round   1, Train loss: 0.475, Test loss: 0.666, Test accuracy: 76.40 

Round   1, Global train loss: 0.475, Global test loss: 0.736, Global test accuracy: 50.50 

Round   2, Train loss: 0.392, Test loss: 0.473, Test accuracy: 80.80 

Round   2, Global train loss: 0.392, Global test loss: 0.737, Global test accuracy: 50.10 

Round   3, Train loss: 0.310, Test loss: 0.525, Test accuracy: 80.90 

Round   3, Global train loss: 0.310, Global test loss: 0.795, Global test accuracy: 50.00 

Round   4, Train loss: 0.258, Test loss: 0.647, Test accuracy: 78.80 

Round   4, Global train loss: 0.258, Global test loss: 0.775, Global test accuracy: 50.00 

Round   5, Train loss: 0.246, Test loss: 0.629, Test accuracy: 81.90 

Round   5, Global train loss: 0.246, Global test loss: 0.845, Global test accuracy: 50.00 

Round   6, Train loss: 0.210, Test loss: 0.546, Test accuracy: 82.50 

Round   6, Global train loss: 0.210, Global test loss: 0.856, Global test accuracy: 50.00 

Round   7, Train loss: 0.181, Test loss: 0.867, Test accuracy: 80.30 

Round   7, Global train loss: 0.181, Global test loss: 0.985, Global test accuracy: 50.00 

Round   8, Train loss: 0.159, Test loss: 0.672, Test accuracy: 80.50 

Round   8, Global train loss: 0.159, Global test loss: 0.919, Global test accuracy: 50.00 

Round   9, Train loss: 0.140, Test loss: 0.604, Test accuracy: 83.70 

Round   9, Global train loss: 0.140, Global test loss: 0.903, Global test accuracy: 50.00 

Round  10, Train loss: 0.135, Test loss: 0.774, Test accuracy: 79.00 

Round  10, Global train loss: 0.135, Global test loss: 0.990, Global test accuracy: 50.00 

Round  11, Train loss: 0.132, Test loss: 0.660, Test accuracy: 82.00 

Round  11, Global train loss: 0.132, Global test loss: 0.890, Global test accuracy: 50.00 

Round  12, Train loss: 0.080, Test loss: 0.755, Test accuracy: 82.20 

Round  12, Global train loss: 0.080, Global test loss: 0.936, Global test accuracy: 50.00 

Round  13, Train loss: 0.090, Test loss: 0.673, Test accuracy: 82.70 

Round  13, Global train loss: 0.090, Global test loss: 0.977, Global test accuracy: 50.00 

Round  14, Train loss: 0.078, Test loss: 0.683, Test accuracy: 83.60 

Round  14, Global train loss: 0.078, Global test loss: 0.997, Global test accuracy: 50.00 

Round  15, Train loss: 0.090, Test loss: 0.673, Test accuracy: 83.20 

Round  15, Global train loss: 0.090, Global test loss: 1.006, Global test accuracy: 50.00 

Round  16, Train loss: 0.062, Test loss: 0.624, Test accuracy: 83.40 

Round  16, Global train loss: 0.062, Global test loss: 0.968, Global test accuracy: 50.00 

Round  17, Train loss: 0.075, Test loss: 0.700, Test accuracy: 82.90 

Round  17, Global train loss: 0.075, Global test loss: 0.967, Global test accuracy: 50.00 

Round  18, Train loss: 0.031, Test loss: 0.820, Test accuracy: 81.90 

Round  18, Global train loss: 0.031, Global test loss: 0.975, Global test accuracy: 50.00 

Round  19, Train loss: 0.049, Test loss: 0.738, Test accuracy: 82.40 

Round  19, Global train loss: 0.049, Global test loss: 0.992, Global test accuracy: 50.00 

Round  20, Train loss: 0.053, Test loss: 0.759, Test accuracy: 83.20 

Round  20, Global train loss: 0.053, Global test loss: 0.974, Global test accuracy: 50.00 

Round  21, Train loss: 0.049, Test loss: 0.687, Test accuracy: 83.00 

Round  21, Global train loss: 0.049, Global test loss: 0.961, Global test accuracy: 50.00 

Round  22, Train loss: 0.035, Test loss: 0.630, Test accuracy: 84.30 

Round  22, Global train loss: 0.035, Global test loss: 1.040, Global test accuracy: 50.00 

Round  23, Train loss: 0.020, Test loss: 0.682, Test accuracy: 86.00 

Round  23, Global train loss: 0.020, Global test loss: 1.099, Global test accuracy: 50.00 

Round  24, Train loss: 0.027, Test loss: 0.687, Test accuracy: 84.00 

Round  24, Global train loss: 0.027, Global test loss: 1.037, Global test accuracy: 50.00 

Round  25, Train loss: 0.016, Test loss: 0.708, Test accuracy: 83.60 

Round  25, Global train loss: 0.016, Global test loss: 1.140, Global test accuracy: 50.00 

Round  26, Train loss: 0.030, Test loss: 0.775, Test accuracy: 83.50 

Round  26, Global train loss: 0.030, Global test loss: 1.045, Global test accuracy: 50.00 

Round  27, Train loss: 0.015, Test loss: 0.753, Test accuracy: 83.70 

Round  27, Global train loss: 0.015, Global test loss: 1.007, Global test accuracy: 50.00 

Round  28, Train loss: 0.013, Test loss: 0.734, Test accuracy: 84.50 

Round  28, Global train loss: 0.013, Global test loss: 1.103, Global test accuracy: 50.00 

Round  29, Train loss: 0.033, Test loss: 0.643, Test accuracy: 84.60 

Round  29, Global train loss: 0.033, Global test loss: 1.112, Global test accuracy: 50.00 

Round  30, Train loss: 0.024, Test loss: 0.685, Test accuracy: 84.10 

Round  30, Global train loss: 0.024, Global test loss: 0.994, Global test accuracy: 50.00 

Round  31, Train loss: 0.024, Test loss: 0.658, Test accuracy: 84.40 

Round  31, Global train loss: 0.024, Global test loss: 1.035, Global test accuracy: 50.00 

Round  32, Train loss: 0.032, Test loss: 0.818, Test accuracy: 82.90 

Round  32, Global train loss: 0.032, Global test loss: 0.920, Global test accuracy: 50.00 

Round  33, Train loss: 0.017, Test loss: 0.734, Test accuracy: 83.60 

Round  33, Global train loss: 0.017, Global test loss: 1.003, Global test accuracy: 50.00 

Round  34, Train loss: 0.017, Test loss: 0.761, Test accuracy: 83.60 

Round  34, Global train loss: 0.017, Global test loss: 1.032, Global test accuracy: 50.00 

Final Round, Train loss: 0.011, Test loss: 0.740, Test accuracy: 84.90 

Final Round, Global train loss: 0.011, Global test loss: 1.032, Global test accuracy: 50.00 

Average accuracy final 10 rounds: 83.85000000000001 

Average global accuracy final 10 rounds: 50.0 

471.84739565849304
[4.515965223312378, 6.807361125946045, 9.128337860107422, 11.454946756362915, 13.770606279373169, 16.036926746368408, 18.355757474899292, 20.67072319984436, 22.912657976150513, 25.14022397994995, 27.472371101379395, 29.865806579589844, 32.21675205230713, 34.58399820327759, 37.004016637802124, 39.28540825843811, 41.58087110519409, 43.84293007850647, 46.14504671096802, 48.41742491722107, 50.7748749256134, 53.17548322677612, 55.57171702384949, 57.85460662841797, 60.208868741989136, 62.588892698287964, 64.84262466430664, 67.25135803222656, 69.5863516330719, 71.88039040565491, 74.38872051239014, 76.61272954940796, 78.93021440505981, 81.13218975067139, 83.60444641113281, 88.06827354431152]
[74.4, 76.4, 80.8, 80.9, 78.8, 81.9, 82.5, 80.3, 80.5, 83.7, 79.0, 82.0, 82.2, 82.7, 83.6, 83.2, 83.4, 82.9, 81.9, 82.4, 83.2, 83.0, 84.3, 86.0, 84.0, 83.6, 83.5, 83.7, 84.5, 84.6, 84.1, 84.4, 82.9, 83.6, 83.6, 84.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 1.078, Train accuracy: 78.500, Test loss: 2.058, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.495, Train accuracy: 76.500, Test loss: 0.872, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.395, Train accuracy: 81.500, Test loss: 1.349, Test accuracy: 70.00 

Round   0, Train loss: 0.395, Test loss: 1.349, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.238, Train accuracy: 90.500, Test loss: 1.004, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.373, Train accuracy: 89.500, Test loss: 1.443, Test accuracy: 70.50 

Round   1, Train loss: 0.373, Test loss: 1.443, Test accuracy: 70.50 

        train local model (freeze embeding):client   0,  Train loss: 0.116, Train accuracy: 96.000, Test loss: 1.018, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.105, Train accuracy: 98.500, Test loss: 0.996, Test accuracy: 71.50 

Round   2, Train loss: 0.105, Test loss: 0.996, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.162, Train accuracy: 93.500, Test loss: 1.393, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.109, Train accuracy: 96.500, Test loss: 0.988, Test accuracy: 74.00 

Round   3, Train loss: 0.109, Test loss: 0.988, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.039, Train accuracy: 98.500, Test loss: 1.146, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.160, Train accuracy: 95.500, Test loss: 1.289, Test accuracy: 72.00 

Round   4, Train loss: 0.160, Test loss: 1.289, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.062, Train accuracy: 98.000, Test loss: 1.012, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 1.296, Test accuracy: 73.00 

Round   5, Train loss: 0.017, Test loss: 1.296, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 1.178, Test accuracy: 76.00 

Round   6, Train loss: 0.016, Test loss: 1.178, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.283, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.435, Test accuracy: 71.50 

Round   7, Train loss: 0.005, Test loss: 1.435, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 1.440, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 1.452, Test accuracy: 72.00 

Round   8, Train loss: 0.010, Test loss: 1.452, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.414, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.647, Test accuracy: 75.50 

Round   9, Train loss: 0.003, Test loss: 1.647, Test accuracy: 75.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.515, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.651, Test accuracy: 74.00 

Round  10, Train loss: 0.002, Test loss: 1.651, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.690, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 73.00 

Round  11, Train loss: 0.017, Test loss: 1.182, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.123, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 77.00 

Round  12, Train loss: 0.005, Test loss: 1.042, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.222, Test accuracy: 74.00 

Round  13, Train loss: 0.007, Test loss: 1.222, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.205, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.425, Test accuracy: 73.00 

Round  14, Train loss: 0.000, Test loss: 1.425, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.430, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.078, Test accuracy: 74.50 

Round  15, Train loss: 0.003, Test loss: 1.078, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.161, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.241, Test accuracy: 78.50 

Round  16, Train loss: 0.028, Test loss: 1.241, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.149, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.072, Train accuracy: 98.000, Test loss: 1.421, Test accuracy: 71.00 

Round  17, Train loss: 0.072, Test loss: 1.421, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 1.352, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 76.00 

Round  18, Train loss: 0.000, Test loss: 1.327, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.310, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.284, Test accuracy: 76.00 

Round  19, Train loss: 0.001, Test loss: 1.284, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.364, Test accuracy: 75.00 

Final Round, Train loss: 0.000, Test loss: 1.295, Test accuracy: 76.50 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.537, Train accuracy: 75.500, Test loss: 0.462, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.358, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.510, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.932, Train accuracy: 60.500, Test loss: 0.879, Test accuracy: 66.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.231, Train accuracy: 91.000, Test loss: 0.419, Test accuracy: 82.00 

Round   0, Train loss: 0.116, Test loss: 0.758, Test accuracy: 77.25 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.000, Test loss: 1.219, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 1.419, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.239, Train accuracy: 89.500, Test loss: 0.394, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.284, Train accuracy: 89.000, Test loss: 0.974, Test accuracy: 74.50 

Round   1, Train loss: 0.150, Test loss: 0.811, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.500, Test loss: 1.289, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.237, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.163, Train accuracy: 92.000, Test loss: 0.379, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.101, Train accuracy: 96.500, Test loss: 0.571, Test accuracy: 81.50 

Round   2, Train loss: 0.052, Test loss: 0.698, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.048, Train accuracy: 99.000, Test loss: 1.136, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.361, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.073, Train accuracy: 98.000, Test loss: 0.335, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.046, Train accuracy: 98.000, Test loss: 0.414, Test accuracy: 86.50 

Round   3, Train loss: 0.026, Test loss: 0.703, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 1.009, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.240, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.038, Train accuracy: 99.500, Test loss: 0.459, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.051, Train accuracy: 97.500, Test loss: 0.647, Test accuracy: 86.00 

Round   4, Train loss: 0.026, Test loss: 0.743, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 1.120, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.257, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.000, Test loss: 0.544, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 0.529, Test accuracy: 86.00 

Round   5, Train loss: 0.018, Test loss: 0.853, Test accuracy: 78.75 

        train local model (freeze embeding):client   0,  Train loss: 0.039, Train accuracy: 98.500, Test loss: 1.032, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.386, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 0.677, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 0.633, Test accuracy: 83.00 

Round   6, Train loss: 0.013, Test loss: 0.758, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 1.224, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.175, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.567, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.066, Train accuracy: 98.000, Test loss: 0.741, Test accuracy: 84.50 

Round   7, Train loss: 0.034, Test loss: 0.789, Test accuracy: 81.25 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.269, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.594, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.665, Test accuracy: 86.00 

Round   8, Train loss: 0.013, Test loss: 0.831, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.077, Train accuracy: 98.000, Test loss: 1.672, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.576, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.746, Test accuracy: 83.50 

Round   9, Train loss: 0.041, Test loss: 0.897, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.240, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.282, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.488, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.578, Test accuracy: 86.00 

Round  10, Train loss: 0.002, Test loss: 0.848, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.250, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.268, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.500, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.518, Test accuracy: 86.50 

Round  11, Train loss: 0.007, Test loss: 0.820, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.263, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.044, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.576, Test accuracy: 84.50 

Round  12, Train loss: 0.006, Test loss: 0.765, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.118, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.577, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.724, Test accuracy: 84.50 

Round  13, Train loss: 0.004, Test loss: 0.873, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.306, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.397, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.626, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.666, Test accuracy: 86.50 

Round  14, Train loss: 0.001, Test loss: 0.879, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.308, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.438, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.626, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.566, Test accuracy: 85.00 

Round  15, Train loss: 0.000, Test loss: 0.876, Test accuracy: 83.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.393, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.439, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.593, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.608, Test accuracy: 88.00 

Round  16, Train loss: 0.001, Test loss: 0.882, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.353, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 1.695, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.638, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.692, Test accuracy: 85.50 

Round  17, Train loss: 0.010, Test loss: 0.947, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.473, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.260, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.670, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.631, Test accuracy: 86.50 

Round  18, Train loss: 0.001, Test loss: 0.886, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.369, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 1.358, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.623, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.796, Test accuracy: 81.50 

Round  19, Train loss: 0.004, Test loss: 0.933, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.277, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.343, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.707, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.695, Test accuracy: 86.50 

Final Round, Train loss: 0.001, Test loss: 0.934, Test accuracy: 80.00 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.839, Train accuracy: 59.000, Test loss: 1.085, Test accuracy: 56.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.352, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.733, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.717, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.456, Train accuracy: 79.500, Test loss: 0.636, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.330, Train accuracy: 85.000, Test loss: 0.979, Test accuracy: 70.00 

Round   0, Train loss: 0.110, Test loss: 0.778, Test accuracy: 79.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.290, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.331, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.573, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.553, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.344, Train accuracy: 83.500, Test loss: 0.815, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.196, Train accuracy: 91.000, Test loss: 1.044, Test accuracy: 72.00 

Round   1, Train loss: 0.066, Test loss: 0.726, Test accuracy: 80.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.192, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.358, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.555, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.145, Train accuracy: 95.000, Test loss: 0.723, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.164, Train accuracy: 94.500, Test loss: 1.089, Test accuracy: 69.00 

Round   2, Train loss: 0.056, Test loss: 0.777, Test accuracy: 79.67 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.397, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.609, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.539, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.096, Train accuracy: 98.000, Test loss: 0.849, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.113, Train accuracy: 96.000, Test loss: 1.257, Test accuracy: 73.00 

Round   3, Train loss: 0.040, Test loss: 0.786, Test accuracy: 81.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.219, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 1.341, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.506, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.664, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.044, Train accuracy: 99.500, Test loss: 0.910, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.113, Train accuracy: 97.000, Test loss: 1.275, Test accuracy: 74.00 

Round   4, Train loss: 0.044, Test loss: 0.779, Test accuracy: 81.83 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.181, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.382, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.631, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.036, Train accuracy: 100.000, Test loss: 0.913, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.580, Train accuracy: 83.500, Test loss: 2.471, Test accuracy: 68.50 

Round   5, Train loss: 0.195, Test loss: 0.879, Test accuracy: 79.67 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.188, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.310, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.549, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.586, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.027, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.039, Train accuracy: 99.000, Test loss: 1.415, Test accuracy: 72.50 

Round   6, Train loss: 0.024, Test loss: 0.919, Test accuracy: 80.83 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.138, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.350, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.500, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.736, Test accuracy: 85.50 

        train local model (freeze embeding):client   2,  Train loss: 0.022, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.077, Train accuracy: 97.500, Test loss: 1.339, Test accuracy: 74.50 

Round   7, Train loss: 0.027, Test loss: 0.904, Test accuracy: 80.17 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.257, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.458, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.458, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.607, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.131, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.080, Train accuracy: 97.500, Test loss: 1.307, Test accuracy: 75.00 

Round   8, Train loss: 0.030, Test loss: 0.848, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.245, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.475, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.036, Train accuracy: 98.500, Test loss: 0.812, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 1.068, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.075, Train accuracy: 97.000, Test loss: 1.431, Test accuracy: 71.00 

Round   9, Train loss: 0.037, Test loss: 0.868, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 1.339, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.356, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.464, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.539, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.992, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 1.125, Test accuracy: 74.50 

Round  10, Train loss: 0.005, Test loss: 0.866, Test accuracy: 80.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.311, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.418, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.535, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.143, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.023, Test accuracy: 74.00 

Round  11, Train loss: 0.001, Test loss: 0.866, Test accuracy: 80.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.212, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.314, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.420, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.493, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.101, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.400, Test accuracy: 75.50 

Round  12, Train loss: 0.003, Test loss: 0.897, Test accuracy: 81.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.209, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.316, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.437, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.613, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.465, Test accuracy: 70.50 

Round  13, Train loss: 0.003, Test loss: 0.953, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.309, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 1.365, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.483, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.521, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.116, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.043, Train accuracy: 98.500, Test loss: 1.512, Test accuracy: 73.50 

Round  14, Train loss: 0.026, Test loss: 0.942, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.266, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.599, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.451, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.683, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.056, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.695, Test accuracy: 73.50 

Round  15, Train loss: 0.005, Test loss: 0.924, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.408, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.416, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.539, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.091, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.067, Train accuracy: 98.000, Test loss: 1.257, Test accuracy: 72.50 

Round  16, Train loss: 0.024, Test loss: 0.911, Test accuracy: 80.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.421, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.464, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.537, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.951, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 76.50 

Round  17, Train loss: 0.002, Test loss: 0.877, Test accuracy: 80.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.314, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.500, Test loss: 0.514, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.551, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.945, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 74.00 

Round  18, Train loss: 0.002, Test loss: 0.870, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.400, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.306, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.508, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.514, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.227, Test accuracy: 75.50 

Round  19, Train loss: 0.003, Test loss: 0.902, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.415, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.338, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.517, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.524, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.066, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 75.50 

Final Round, Train loss: 0.001, Test loss: 0.904, Test accuracy: 81.00 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.522, Train accuracy: 78.500, Test loss: 0.735, Test accuracy: 70.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.325, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.509, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.772, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.126, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.278, Train accuracy: 87.000, Test loss: 0.384, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.201, Test accuracy: 93.00 

Round   0, Train loss: 0.006, Test loss: 0.749, Test accuracy: 83.62 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.450, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.530, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.626, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.075, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.222, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.128, Train accuracy: 95.000, Test loss: 0.219, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.065, Train accuracy: 97.500, Test loss: 0.410, Test accuracy: 87.50 

Round   1, Train loss: 0.017, Test loss: 0.732, Test accuracy: 83.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.328, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.508, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.550, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.566, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.056, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.407, Train accuracy: 82.000, Test loss: 2.040, Test accuracy: 68.00 

        train local model (freeze embeding):client   3,  Train loss: 0.058, Train accuracy: 99.500, Test loss: 0.203, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.287, Test accuracy: 92.00 

Round   2, Train loss: 0.103, Test loss: 0.753, Test accuracy: 84.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.450, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.582, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 98.500, Test loss: 0.839, Test accuracy: 82.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.170, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.735, Test accuracy: 70.50 

        train local model (freeze embeding):client   3,  Train loss: 0.037, Train accuracy: 99.500, Test loss: 0.206, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.000, Test loss: 0.186, Test accuracy: 95.00 

Round   3, Train loss: 0.018, Test loss: 0.778, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.444, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.512, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.528, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.163, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 0.204, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.211, Test accuracy: 95.50 

Round   4, Train loss: 0.007, Test loss: 0.732, Test accuracy: 84.38 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.367, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.220, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.512, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.629, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.057, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.181, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.221, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 93.00 

Round   5, Train loss: 0.001, Test loss: 0.719, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.325, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.393, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.506, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.638, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.071, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.488, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.192, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.167, Test accuracy: 94.00 

Round   6, Train loss: 0.002, Test loss: 0.718, Test accuracy: 84.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.277, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.558, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.488, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.517, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.129, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.226, Train accuracy: 92.000, Test loss: 2.220, Test accuracy: 66.00 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.198, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.396, Test accuracy: 91.00 

Round   7, Train loss: 0.061, Test loss: 0.825, Test accuracy: 82.88 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.387, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.465, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.043, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.254, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.197, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.204, Test accuracy: 93.00 

Round   8, Train loss: 0.001, Test loss: 0.725, Test accuracy: 84.62 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.344, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.386, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.484, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.072, Train accuracy: 97.000, Test loss: 0.506, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.500, Test loss: 1.479, Test accuracy: 74.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.173, Test accuracy: 95.00 

Round   9, Train loss: 0.030, Test loss: 0.687, Test accuracy: 85.62 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.275, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.537, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.678, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.080, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.137, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.188, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 93.00 

Round  10, Train loss: 0.001, Test loss: 0.704, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.267, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.424, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.505, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.739, Test accuracy: 84.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.193, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 1.679, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.196, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.218, Test accuracy: 94.50 

Round  11, Train loss: 0.010, Test loss: 0.758, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.379, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.392, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.482, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.241, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.429, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.222, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.246, Test accuracy: 96.00 

Round  12, Train loss: 0.002, Test loss: 0.762, Test accuracy: 85.12 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.354, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.508, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.491, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.548, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.343, Test accuracy: 75.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.236, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.174, Test accuracy: 94.50 

Round  13, Train loss: 0.001, Test loss: 0.771, Test accuracy: 84.88 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.418, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.461, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.490, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.760, Test accuracy: 83.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.269, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.471, Test accuracy: 74.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.240, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.246, Test accuracy: 95.00 

Round  14, Train loss: 0.005, Test loss: 0.767, Test accuracy: 85.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 1.452, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.489, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.516, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.272, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.336, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.216, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.185, Test accuracy: 95.00 

Round  15, Train loss: 0.009, Test loss: 0.766, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.356, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.390, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.522, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.455, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.265, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.227, Test accuracy: 96.50 

Round  16, Train loss: 0.001, Test loss: 0.747, Test accuracy: 85.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.348, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.489, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.484, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.686, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.215, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.384, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.256, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.169, Test accuracy: 95.00 

Round  17, Train loss: 0.001, Test loss: 0.742, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.410, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.524, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.144, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.204, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.203, Test accuracy: 95.00 

Round  18, Train loss: 0.000, Test loss: 0.796, Test accuracy: 84.38 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.438, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.411, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.524, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.529, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.136, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 95.00 

Round  19, Train loss: 0.001, Test loss: 0.780, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.464, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.479, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.490, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.494, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.170, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.289, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.244, Test accuracy: 95.00 

Final Round, Train loss: 0.000, Test loss: 0.785, Test accuracy: 85.12 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.192, Train accuracy: 90.500, Test loss: 0.342, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.503, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.560, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.505, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.532, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.221, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.248, Test accuracy: 95.50 

        train local model (freeze embeding):client   4,  Train loss: 0.197, Train accuracy: 92.000, Test loss: 0.386, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.149, Test accuracy: 95.00 

Round   0, Train loss: 0.004, Test loss: 0.650, Test accuracy: 86.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.407, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.621, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.528, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.546, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.247, Test accuracy: 74.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.256, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.270, Test accuracy: 94.00 

        train local model (freeze embeding):client   4,  Train loss: 0.082, Train accuracy: 98.000, Test loss: 0.246, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.016, Train accuracy: 99.000, Test loss: 0.250, Test accuracy: 95.00 

Round   1, Train loss: 0.004, Test loss: 0.648, Test accuracy: 87.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.390, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.507, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.589, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.294, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.260, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 0.449, Test accuracy: 87.00 

        train local model (freeze embeding):client   4,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 0.213, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 0.195, Test accuracy: 95.00 

Round   2, Train loss: 0.013, Test loss: 0.648, Test accuracy: 86.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.392, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.000, Test loss: 1.755, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.548, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.661, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.220, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.274, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.043, Train accuracy: 98.500, Test loss: 0.223, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.055, Train accuracy: 98.000, Test loss: 0.247, Test accuracy: 93.50 

Round   3, Train loss: 0.015, Test loss: 0.651, Test accuracy: 86.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.468, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.509, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.555, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.540, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.219, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.256, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.269, Test accuracy: 94.50 

        train local model (freeze embeding):client   4,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.233, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.273, Test accuracy: 93.00 

Round   4, Train loss: 0.003, Test loss: 0.657, Test accuracy: 86.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.435, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 1.472, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.570, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.533, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.142, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.292, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 93.50 

        train local model (freeze embeding):client   4,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.210, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.177, Test accuracy: 95.50 

Round   5, Train loss: 0.009, Test loss: 0.667, Test accuracy: 86.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.298, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.369, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.567, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.633, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.136, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.361, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.289, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.282, Test accuracy: 96.00 

        train local model (freeze embeding):client   4,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.218, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.247, Train accuracy: 90.000, Test loss: 0.881, Test accuracy: 81.00 

Round   6, Train loss: 0.050, Test loss: 0.657, Test accuracy: 86.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.273, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.285, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.545, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.609, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.104, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.309, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.251, Test accuracy: 94.50 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.231, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.206, Test accuracy: 94.50 

Round   7, Train loss: 0.002, Test loss: 0.615, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.317, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.517, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.507, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.278, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.276, Test accuracy: 94.50 

        train local model (freeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.230, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.341, Test accuracy: 95.00 

Round   8, Train loss: 0.001, Test loss: 0.625, Test accuracy: 87.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.190, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.325, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.565, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.578, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.066, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.252, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 93.50 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.507, Test accuracy: 91.50 

Round   9, Train loss: 0.003, Test loss: 0.636, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.400, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.602, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.598, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.116, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.219, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.353, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.338, Test accuracy: 94.00 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.269, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.273, Test accuracy: 95.00 

Round  10, Train loss: 0.000, Test loss: 0.669, Test accuracy: 87.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.408, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.613, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.598, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.118, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.193, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.318, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.211, Test accuracy: 94.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.285, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.275, Test accuracy: 95.00 

Round  11, Train loss: 0.000, Test loss: 0.666, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.342, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.473, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.589, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.675, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.117, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.086, Train accuracy: 96.000, Test loss: 1.103, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.266, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.215, Test accuracy: 96.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.247, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.249, Test accuracy: 95.00 

Round  12, Train loss: 0.017, Test loss: 0.656, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.372, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.420, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.487, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.069, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.255, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.067, Train accuracy: 98.000, Test loss: 0.431, Test accuracy: 88.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.272, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.041, Train accuracy: 98.000, Test loss: 0.381, Test accuracy: 88.00 

Round  13, Train loss: 0.022, Test loss: 0.646, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.346, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 1.169, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.493, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.551, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.146, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.246, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.168, Test accuracy: 96.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.266, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.236, Test accuracy: 94.50 

Round  14, Train loss: 0.007, Test loss: 0.601, Test accuracy: 87.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.667, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.079, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.200, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.107, Test accuracy: 96.50 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.241, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.181, Test accuracy: 95.00 

Round  15, Train loss: 0.001, Test loss: 0.606, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.326, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 1.433, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.529, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.584, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.949, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.232, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.248, Test accuracy: 94.50 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.241, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 92.50 

Round  16, Train loss: 0.008, Test loss: 0.619, Test accuracy: 87.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.298, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.417, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.557, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.588, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.179, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.219, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 94.50 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 94.50 

Round  17, Train loss: 0.000, Test loss: 0.621, Test accuracy: 87.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.269, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.547, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.475, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.078, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.241, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.211, Test accuracy: 96.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.211, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.255, Test accuracy: 93.50 

Round  18, Train loss: 0.001, Test loss: 0.603, Test accuracy: 88.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.322, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.255, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.489, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.508, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.951, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.242, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.272, Test accuracy: 95.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.223, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.266, Test accuracy: 94.50 

Round  19, Train loss: 0.000, Test loss: 0.614, Test accuracy: 88.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.310, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.363, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.490, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.494, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.224, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.251, Test accuracy: 94.50 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.231, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.228, Test accuracy: 94.50 

Final Round, Train loss: 0.000, Test loss: 0.619, Test accuracy: 88.30 

Average accuracy final 10 rounds: 409.89 

1938.520417690277
[5.759766101837158, 11.572420835494995, 17.68074941635132, 23.844295501708984, 30.22102403640747, 36.59648633003235, 43.069817781448364, 49.10640621185303, 55.53913497924805, 61.7724072933197, 67.830575466156, 73.71666049957275, 79.9312584400177, 86.35197353363037, 92.4631712436676, 98.70254302024841, 105.02916669845581, 111.19689869880676, 117.55536794662476, 123.7537682056427, 127.1790976524353, 133.23688530921936, 139.52845978736877, 145.67719793319702, 151.75576090812683, 157.80945658683777, 164.03860330581665, 170.0834436416626, 176.4854531288147, 182.53853678703308, 189.3053057193756, 195.47501873970032, 201.768559217453, 208.06571626663208, 214.32484889030457, 220.3549280166626, 226.7964072227478, 232.96960020065308, 238.97365045547485, 245.01991081237793, 251.06962418556213, 254.28867292404175, 260.30603408813477, 266.35852003097534, 272.53781962394714, 278.70672082901, 284.80414032936096, 290.96230602264404, 297.38373160362244, 303.5082573890686, 309.48254680633545, 315.4977614879608, 321.9346454143524, 328.0267221927643, 334.21317195892334, 340.47069931030273, 346.37780261039734, 352.5263829231262, 358.4718198776245, 364.5765063762665, 370.78738927841187, 377.1443598270416, 380.3094961643219, 386.5724275112152, 392.6072607040405, 399.02104139328003, 405.16046142578125, 411.3058798313141, 417.6105897426605, 423.53919291496277, 429.78628396987915, 436.18922996520996, 442.32599997520447, 448.7088534832001, 454.83792638778687, 461.5069785118103, 467.71053552627563, 474.13096594810486, 480.2325904369354, 486.4461627006531, 492.641233921051, 498.8952810764313, 505.23569679260254, 509.2553536891937, 515.4347712993622, 521.4047458171844, 527.6250467300415, 533.7365341186523, 539.6929903030396, 545.7350766658783, 551.7528581619263, 557.8780126571655, 564.2289931774139, 570.4030158519745, 576.8750591278076, 583.5788040161133, 589.7563638687134, 596.240332365036, 602.6390035152435, 608.9449248313904, 615.2480895519257, 621.4464890956879, 627.6033945083618, 633.537269115448, 636.713663816452]
[70.0, 70.5, 71.5, 74.0, 72.0, 73.0, 76.0, 71.5, 72.0, 75.5, 74.0, 73.0, 77.0, 74.0, 73.0, 74.5, 78.5, 71.0, 76.0, 76.0, 76.5, 77.25, 76.5, 81.0, 80.5, 80.75, 78.75, 80.5, 81.25, 80.75, 80.75, 81.0, 81.0, 82.0, 81.5, 82.25, 83.25, 83.5, 82.25, 81.75, 80.25, 80.0, 79.83333333333333, 80.16666666666667, 79.66666666666667, 81.83333333333333, 81.83333333333333, 79.66666666666667, 80.83333333333333, 80.16666666666667, 81.5, 81.0, 80.66666666666667, 80.33333333333333, 81.66666666666667, 80.5, 80.0, 81.0, 80.66666666666667, 80.16666666666667, 81.5, 81.5, 81.0, 83.625, 83.875, 84.875, 84.5, 84.375, 84.0, 84.875, 82.875, 84.625, 85.625, 85.0, 85.0, 85.125, 84.875, 85.75, 83.5, 85.875, 84.5, 84.375, 84.75, 85.125, 86.2, 87.2, 86.6, 86.6, 86.7, 86.7, 86.6, 87.5, 87.3, 87.5, 87.7, 88.0, 87.5, 87.0, 87.6, 87.5, 87.2, 87.6, 88.2, 88.1, 88.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.643, Test loss: 0.529, Test accuracy: 76.70 

Round   0, Global train loss: 0.643, Global test loss: 0.700, Global test accuracy: 52.50 

Round   1, Train loss: 0.565, Test loss: 0.505, Test accuracy: 76.30 

Round   1, Global train loss: 0.565, Global test loss: 0.760, Global test accuracy: 51.10 

Round   2, Train loss: 0.519, Test loss: 0.801, Test accuracy: 74.40 

Round   2, Global train loss: 0.519, Global test loss: 0.863, Global test accuracy: 51.00 

Round   3, Train loss: 0.505, Test loss: 0.538, Test accuracy: 79.10 

Round   3, Global train loss: 0.505, Global test loss: 0.825, Global test accuracy: 56.20 

Round   4, Train loss: 0.424, Test loss: 0.539, Test accuracy: 79.20 

Round   4, Global train loss: 0.424, Global test loss: 0.981, Global test accuracy: 55.90 

Round   5, Train loss: 0.391, Test loss: 0.578, Test accuracy: 77.70 

Round   5, Global train loss: 0.391, Global test loss: 0.725, Global test accuracy: 66.00 

Round   6, Train loss: 0.371, Test loss: 0.583, Test accuracy: 78.30 

Round   6, Global train loss: 0.371, Global test loss: 0.924, Global test accuracy: 61.90 

Round   7, Train loss: 0.340, Test loss: 0.489, Test accuracy: 81.00 

Round   7, Global train loss: 0.340, Global test loss: 0.889, Global test accuracy: 63.10 

Round   8, Train loss: 0.343, Test loss: 0.508, Test accuracy: 78.80 

Round   8, Global train loss: 0.343, Global test loss: 0.625, Global test accuracy: 65.70 

Round   9, Train loss: 0.305, Test loss: 0.614, Test accuracy: 78.30 

Round   9, Global train loss: 0.305, Global test loss: 0.925, Global test accuracy: 62.40 

Round  10, Train loss: 0.308, Test loss: 0.509, Test accuracy: 82.00 

Round  10, Global train loss: 0.308, Global test loss: 0.904, Global test accuracy: 63.00 

Round  11, Train loss: 0.269, Test loss: 0.567, Test accuracy: 80.20 

Round  11, Global train loss: 0.269, Global test loss: 0.793, Global test accuracy: 67.00 

Round  12, Train loss: 0.285, Test loss: 0.469, Test accuracy: 82.70 

Round  12, Global train loss: 0.285, Global test loss: 0.759, Global test accuracy: 65.60 

Round  13, Train loss: 0.260, Test loss: 0.627, Test accuracy: 80.90 

Round  13, Global train loss: 0.260, Global test loss: 0.865, Global test accuracy: 66.90 

Round  14, Train loss: 0.257, Test loss: 0.691, Test accuracy: 78.80 

Round  14, Global train loss: 0.257, Global test loss: 0.880, Global test accuracy: 66.00 

Round  15, Train loss: 0.241, Test loss: 0.509, Test accuracy: 81.40 

Round  15, Global train loss: 0.241, Global test loss: 0.819, Global test accuracy: 66.30 

Round  16, Train loss: 0.209, Test loss: 0.568, Test accuracy: 81.00 

Round  16, Global train loss: 0.209, Global test loss: 0.914, Global test accuracy: 66.00 

Round  17, Train loss: 0.214, Test loss: 0.557, Test accuracy: 83.50 

Round  17, Global train loss: 0.214, Global test loss: 0.786, Global test accuracy: 68.50 

Round  18, Train loss: 0.209, Test loss: 0.523, Test accuracy: 82.20 

Round  18, Global train loss: 0.209, Global test loss: 0.724, Global test accuracy: 68.80 

Round  19, Train loss: 0.198, Test loss: 0.519, Test accuracy: 83.00 

Round  19, Global train loss: 0.198, Global test loss: 0.732, Global test accuracy: 70.00 

Round  20, Train loss: 0.191, Test loss: 0.581, Test accuracy: 82.50 

Round  20, Global train loss: 0.191, Global test loss: 0.759, Global test accuracy: 70.20 

Round  21, Train loss: 0.183, Test loss: 0.610, Test accuracy: 80.40 

Round  21, Global train loss: 0.183, Global test loss: 0.811, Global test accuracy: 69.20 

Round  22, Train loss: 0.157, Test loss: 0.685, Test accuracy: 83.30 

Round  22, Global train loss: 0.157, Global test loss: 0.845, Global test accuracy: 68.30 

Round  23, Train loss: 0.160, Test loss: 0.629, Test accuracy: 81.90 

Round  23, Global train loss: 0.160, Global test loss: 0.793, Global test accuracy: 68.70 

Round  24, Train loss: 0.137, Test loss: 0.585, Test accuracy: 82.30 

Round  24, Global train loss: 0.137, Global test loss: 0.859, Global test accuracy: 67.00 

Round  25, Train loss: 0.139, Test loss: 0.621, Test accuracy: 83.20 

Round  25, Global train loss: 0.139, Global test loss: 0.842, Global test accuracy: 70.20 

Round  26, Train loss: 0.127, Test loss: 0.619, Test accuracy: 82.00 

Round  26, Global train loss: 0.127, Global test loss: 0.855, Global test accuracy: 69.50 

Round  27, Train loss: 0.176, Test loss: 0.549, Test accuracy: 82.90 

Round  27, Global train loss: 0.176, Global test loss: 0.716, Global test accuracy: 70.60 

Round  28, Train loss: 0.100, Test loss: 0.593, Test accuracy: 83.40 

Round  28, Global train loss: 0.100, Global test loss: 0.850, Global test accuracy: 69.80 

Round  29, Train loss: 0.103, Test loss: 0.632, Test accuracy: 81.50 

Round  29, Global train loss: 0.103, Global test loss: 0.921, Global test accuracy: 70.90 

Round  30, Train loss: 0.118, Test loss: 0.765, Test accuracy: 82.00 

Round  30, Global train loss: 0.118, Global test loss: 1.000, Global test accuracy: 69.00 

Round  31, Train loss: 0.109, Test loss: 0.641, Test accuracy: 83.40 

Round  31, Global train loss: 0.109, Global test loss: 0.891, Global test accuracy: 69.90 

Round  32, Train loss: 0.090, Test loss: 0.587, Test accuracy: 84.40 

Round  32, Global train loss: 0.090, Global test loss: 0.867, Global test accuracy: 70.20 

Round  33, Train loss: 0.100, Test loss: 0.963, Test accuracy: 83.60 

Round  33, Global train loss: 0.100, Global test loss: 0.770, Global test accuracy: 72.90 

Round  34, Train loss: 0.093, Test loss: 0.698, Test accuracy: 83.80 

Round  34, Global train loss: 0.093, Global test loss: 0.750, Global test accuracy: 73.40 

Final Round, Train loss: 0.080, Test loss: 0.747, Test accuracy: 83.60 

Final Round, Global train loss: 0.080, Global test loss: 0.750, Global test accuracy: 73.40 

Average accuracy final 10 rounds: 83.02 

Average global accuracy final 10 rounds: 70.64 

467.2884249687195
[4.197738885879517, 6.445592164993286, 8.65182614326477, 11.104944229125977, 13.314913511276245, 15.725735664367676, 18.106765270233154, 20.37791395187378, 22.62864112854004, 24.931211709976196, 27.232314586639404, 29.49377679824829, 31.78734827041626, 34.078617572784424, 36.332080125808716, 38.608072996139526, 40.86178660392761, 43.1193470954895, 45.48899459838867, 47.71442103385925, 50.09067726135254, 52.294251441955566, 54.56471586227417, 56.983779191970825, 59.395235538482666, 61.65544629096985, 63.962029218673706, 66.30537509918213, 68.58026480674744, 70.95736932754517, 73.27291703224182, 75.57493615150452, 77.88444995880127, 80.16444492340088, 82.48088574409485, 87.01927495002747]
[76.7, 76.3, 74.4, 79.1, 79.2, 77.7, 78.3, 81.0, 78.8, 78.3, 82.0, 80.2, 82.7, 80.9, 78.8, 81.4, 81.0, 83.5, 82.2, 83.0, 82.5, 80.4, 83.3, 81.9, 82.3, 83.2, 82.0, 82.9, 83.4, 81.5, 82.0, 83.4, 84.4, 83.6, 83.8, 83.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.728, Test loss: 0.823, Test accuracy: 52.00 

Round   1, Train loss: 0.624, Test loss: 1.188, Test accuracy: 52.70 

Round   2, Train loss: 0.576, Test loss: 0.864, Test accuracy: 58.50 

Round   3, Train loss: 0.532, Test loss: 0.605, Test accuracy: 67.10 

Round   4, Train loss: 0.505, Test loss: 0.613, Test accuracy: 70.90 

Round   5, Train loss: 0.476, Test loss: 0.780, Test accuracy: 69.30 

Round   6, Train loss: 0.457, Test loss: 0.529, Test accuracy: 73.60 

Round   7, Train loss: 0.414, Test loss: 0.479, Test accuracy: 77.30 

Round   8, Train loss: 0.408, Test loss: 0.555, Test accuracy: 74.60 

Round   9, Train loss: 0.391, Test loss: 0.564, Test accuracy: 77.60 

Round  10, Train loss: 0.387, Test loss: 0.507, Test accuracy: 78.40 

Round  11, Train loss: 0.352, Test loss: 0.450, Test accuracy: 81.60 

Round  12, Train loss: 0.340, Test loss: 0.458, Test accuracy: 79.80 

Round  13, Train loss: 0.313, Test loss: 0.530, Test accuracy: 78.50 

Round  14, Train loss: 0.331, Test loss: 0.541, Test accuracy: 80.20 

Round  15, Train loss: 0.294, Test loss: 0.401, Test accuracy: 83.20 

Round  16, Train loss: 0.276, Test loss: 0.453, Test accuracy: 82.00 

Round  17, Train loss: 0.258, Test loss: 0.500, Test accuracy: 81.60 

Round  18, Train loss: 0.249, Test loss: 0.404, Test accuracy: 83.70 

Round  19, Train loss: 0.236, Test loss: 0.452, Test accuracy: 82.50 

Round  20, Train loss: 0.229, Test loss: 0.482, Test accuracy: 82.50 

Round  21, Train loss: 0.219, Test loss: 0.450, Test accuracy: 82.90 

Round  22, Train loss: 0.205, Test loss: 0.463, Test accuracy: 81.50 

Round  23, Train loss: 0.203, Test loss: 0.424, Test accuracy: 83.10 

Round  24, Train loss: 0.211, Test loss: 0.507, Test accuracy: 82.70 

Round  25, Train loss: 0.179, Test loss: 0.476, Test accuracy: 83.40 

Round  26, Train loss: 0.167, Test loss: 0.498, Test accuracy: 82.40 

Round  27, Train loss: 0.158, Test loss: 0.462, Test accuracy: 83.80 

Round  28, Train loss: 0.151, Test loss: 0.491, Test accuracy: 82.50 

Round  29, Train loss: 0.162, Test loss: 0.476, Test accuracy: 83.10 

Round  30, Train loss: 0.143, Test loss: 0.502, Test accuracy: 82.90 

Round  31, Train loss: 0.142, Test loss: 0.457, Test accuracy: 83.30 

Round  32, Train loss: 0.124, Test loss: 0.467, Test accuracy: 84.70 

Round  33, Train loss: 0.109, Test loss: 0.495, Test accuracy: 84.10 

Round  34, Train loss: 0.121, Test loss: 0.510, Test accuracy: 83.30 

Round  35, Train loss: 0.104, Test loss: 0.514, Test accuracy: 83.80 

Round  36, Train loss: 0.124, Test loss: 0.496, Test accuracy: 84.80 

Round  37, Train loss: 0.107, Test loss: 0.572, Test accuracy: 84.30 

Round  38, Train loss: 0.095, Test loss: 0.490, Test accuracy: 83.80 

Round  39, Train loss: 0.097, Test loss: 0.529, Test accuracy: 82.70 

Round  40, Train loss: 0.103, Test loss: 0.465, Test accuracy: 84.30 

Round  41, Train loss: 0.087, Test loss: 0.503, Test accuracy: 85.20 

Round  42, Train loss: 0.065, Test loss: 0.502, Test accuracy: 84.50 

Round  43, Train loss: 0.084, Test loss: 0.530, Test accuracy: 84.10 

Round  44, Train loss: 0.068, Test loss: 0.525, Test accuracy: 85.30 

Round  45, Train loss: 0.062, Test loss: 0.488, Test accuracy: 84.60 

Round  46, Train loss: 0.076, Test loss: 0.495, Test accuracy: 84.50 

Round  47, Train loss: 0.073, Test loss: 0.490, Test accuracy: 85.10 

Round  48, Train loss: 0.051, Test loss: 0.540, Test accuracy: 84.90 

Round  49, Train loss: 0.055, Test loss: 0.479, Test accuracy: 85.00 

Final Round, Train loss: 0.038, Test loss: 0.486, Test accuracy: 84.70 

Average accuracy final 10 rounds: 84.75 

489.10517597198486
[3.7777814865112305, 5.62951135635376, 7.452832221984863, 9.270606756210327, 11.139042139053345, 12.972139358520508, 14.799550771713257, 16.586348056793213, 18.325804471969604, 20.12344217300415, 21.88313937187195, 23.624034881591797, 25.42786741256714, 27.27520751953125, 29.054509162902832, 30.854121208190918, 32.63763761520386, 34.587857246398926, 36.29918694496155, 38.211021423339844, 40.07857322692871, 41.872130155563354, 43.64338779449463, 45.434274435043335, 47.2323842048645, 49.023240089416504, 50.80843639373779, 52.66168737411499, 54.48441696166992, 56.309611797332764, 58.07233238220215, 59.90721368789673, 61.861248254776, 63.74195170402527, 65.67496252059937, 67.56720495223999, 69.49201989173889, 71.31680107116699, 73.28870749473572, 75.10600709915161, 76.97715640068054, 78.82142615318298, 80.6402051448822, 82.52176213264465, 84.37557125091553, 86.20791864395142, 88.06924247741699, 89.93378806114197, 91.71125984191895, 93.52828764915466, 95.33592534065247]
[52.0, 52.7, 58.5, 67.1, 70.9, 69.3, 73.6, 77.3, 74.6, 77.6, 78.4, 81.6, 79.8, 78.5, 80.2, 83.2, 82.0, 81.6, 83.7, 82.5, 82.5, 82.9, 81.5, 83.1, 82.7, 83.4, 82.4, 83.8, 82.5, 83.1, 82.9, 83.3, 84.7, 84.1, 83.3, 83.8, 84.8, 84.3, 83.8, 82.7, 84.3, 85.2, 84.5, 84.1, 85.3, 84.6, 84.5, 85.1, 84.9, 85.0, 84.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.716, Test loss: 0.963, Test accuracy: 50.30
Round   1, Train loss: 0.655, Test loss: 1.207, Test accuracy: 54.80
Round   2, Train loss: 0.604, Test loss: 0.876, Test accuracy: 59.80
Round   3, Train loss: 0.550, Test loss: 0.637, Test accuracy: 70.10
Round   4, Train loss: 0.518, Test loss: 0.936, Test accuracy: 60.10
Round   5, Train loss: 0.486, Test loss: 0.562, Test accuracy: 74.30
Round   6, Train loss: 0.451, Test loss: 0.493, Test accuracy: 75.40
Round   7, Train loss: 0.422, Test loss: 0.693, Test accuracy: 69.30
Round   8, Train loss: 0.426, Test loss: 0.672, Test accuracy: 70.50
Round   9, Train loss: 0.412, Test loss: 0.475, Test accuracy: 79.10
Round  10, Train loss: 0.347, Test loss: 0.626, Test accuracy: 73.70
Round  11, Train loss: 0.345, Test loss: 0.536, Test accuracy: 77.70
Round  12, Train loss: 0.333, Test loss: 0.590, Test accuracy: 78.30
Round  13, Train loss: 0.343, Test loss: 0.831, Test accuracy: 69.10
Round  14, Train loss: 0.293, Test loss: 0.480, Test accuracy: 79.80
Round  15, Train loss: 0.285, Test loss: 0.490, Test accuracy: 80.70
Round  16, Train loss: 0.251, Test loss: 0.388, Test accuracy: 84.40
Round  17, Train loss: 0.257, Test loss: 0.423, Test accuracy: 82.50
Round  18, Train loss: 0.242, Test loss: 0.393, Test accuracy: 83.50
Round  19, Train loss: 0.215, Test loss: 0.395, Test accuracy: 83.80
Round  20, Train loss: 0.204, Test loss: 0.444, Test accuracy: 83.40
Round  21, Train loss: 0.200, Test loss: 0.393, Test accuracy: 84.30
Round  22, Train loss: 0.188, Test loss: 0.419, Test accuracy: 84.50
Round  23, Train loss: 0.196, Test loss: 0.527, Test accuracy: 80.00
Round  24, Train loss: 0.188, Test loss: 0.439, Test accuracy: 83.30
Round  25, Train loss: 0.179, Test loss: 0.434, Test accuracy: 82.40
Round  26, Train loss: 0.169, Test loss: 0.375, Test accuracy: 86.10
Round  27, Train loss: 0.147, Test loss: 0.476, Test accuracy: 82.70
Round  28, Train loss: 0.141, Test loss: 0.450, Test accuracy: 84.00
Round  29, Train loss: 0.139, Test loss: 0.441, Test accuracy: 84.60
Round  30, Train loss: 0.129, Test loss: 0.465, Test accuracy: 84.00
Round  31, Train loss: 0.131, Test loss: 0.436, Test accuracy: 86.00
Round  32, Train loss: 0.128, Test loss: 0.500, Test accuracy: 83.10
Round  33, Train loss: 0.117, Test loss: 0.428, Test accuracy: 85.00
Round  34, Train loss: 0.095, Test loss: 0.418, Test accuracy: 85.00
Round  35, Train loss: 0.096, Test loss: 0.460, Test accuracy: 84.70
Round  36, Train loss: 0.095, Test loss: 0.470, Test accuracy: 84.60
Round  37, Train loss: 0.094, Test loss: 0.446, Test accuracy: 85.60
Round  38, Train loss: 0.094, Test loss: 0.445, Test accuracy: 85.60
Round  39, Train loss: 0.071, Test loss: 0.451, Test accuracy: 85.70
Round  40, Train loss: 0.085, Test loss: 0.458, Test accuracy: 84.90
Round  41, Train loss: 0.064, Test loss: 0.450, Test accuracy: 85.60
Round  42, Train loss: 0.071, Test loss: 0.462, Test accuracy: 85.20
Round  43, Train loss: 0.067, Test loss: 0.499, Test accuracy: 85.00
Round  44, Train loss: 0.072, Test loss: 0.474, Test accuracy: 84.80
Round  45, Train loss: 0.062, Test loss: 0.478, Test accuracy: 84.80
Round  46, Train loss: 0.048, Test loss: 0.490, Test accuracy: 85.70
Round  47, Train loss: 0.054, Test loss: 0.487, Test accuracy: 85.00
Round  48, Train loss: 0.041, Test loss: 0.468, Test accuracy: 85.70
Round  49, Train loss: 0.041, Test loss: 0.465, Test accuracy: 85.60
Final Round, Train loss: 0.025, Test loss: 0.476, Test accuracy: 85.20
Average accuracy final 10 rounds: 85.22999999999999
544.5584335327148
[4.088104963302612, 6.201577663421631, 8.282850742340088, 10.300161123275757, 12.290187358856201, 14.35249948501587, 16.531037092208862, 18.56890869140625, 20.568709135055542, 22.632253170013428, 24.68682360649109, 26.71928644180298, 28.801446199417114, 30.94683003425598, 33.084932804107666, 35.36474251747131, 37.469613790512085, 39.59343147277832, 41.63714241981506, 43.79766321182251, 45.82725691795349, 47.91795229911804, 50.00821137428284, 52.19724106788635, 54.194265365600586, 56.29091954231262, 58.31883001327515, 60.36824703216553, 62.469321489334106, 64.5525734424591, 66.6296854019165, 68.63789415359497, 70.72118210792542, 72.7644476890564, 74.81938791275024, 76.90399098396301, 78.84874892234802, 80.86994194984436, 83.06311225891113, 84.99853324890137, 87.1130039691925, 89.16622233390808, 91.3128297328949, 93.38038325309753, 95.42135190963745, 97.61480784416199, 99.69692397117615, 101.72095274925232, 103.81611108779907, 105.88586854934692, 107.92618918418884]
[50.3, 54.8, 59.8, 70.1, 60.1, 74.3, 75.4, 69.3, 70.5, 79.1, 73.7, 77.7, 78.3, 69.1, 79.8, 80.7, 84.4, 82.5, 83.5, 83.8, 83.4, 84.3, 84.5, 80.0, 83.3, 82.4, 86.1, 82.7, 84.0, 84.6, 84.0, 86.0, 83.1, 85.0, 85.0, 84.7, 84.6, 85.6, 85.6, 85.7, 84.9, 85.6, 85.2, 85.0, 84.8, 84.8, 85.7, 85.0, 85.7, 85.6, 85.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.699, Test loss: 0.545, Test accuracy: 75.30 

Round   0, Global train loss: 0.699, Global test loss: 0.702, Global test accuracy: 50.50 

Round   1, Train loss: 0.565, Test loss: 0.523, Test accuracy: 77.10 

Round   1, Global train loss: 0.565, Global test loss: 0.717, Global test accuracy: 50.00 

Round   2, Train loss: 0.499, Test loss: 0.786, Test accuracy: 71.40 

Round   2, Global train loss: 0.499, Global test loss: 0.768, Global test accuracy: 50.00 

Round   3, Train loss: 0.420, Test loss: 0.839, Test accuracy: 71.50 

Round   3, Global train loss: 0.420, Global test loss: 0.727, Global test accuracy: 50.00 

Round   4, Train loss: 0.369, Test loss: 0.825, Test accuracy: 77.00 

Round   4, Global train loss: 0.369, Global test loss: 0.780, Global test accuracy: 50.00 

Round   5, Train loss: 0.321, Test loss: 0.591, Test accuracy: 79.30 

Round   5, Global train loss: 0.321, Global test loss: 0.769, Global test accuracy: 50.00 

Round   6, Train loss: 0.261, Test loss: 0.733, Test accuracy: 74.00 

Round   6, Global train loss: 0.261, Global test loss: 0.747, Global test accuracy: 50.00 

Round   7, Train loss: 0.250, Test loss: 0.658, Test accuracy: 79.70 

Round   7, Global train loss: 0.250, Global test loss: 0.751, Global test accuracy: 50.00 

Round   8, Train loss: 0.183, Test loss: 0.689, Test accuracy: 79.20 

Round   8, Global train loss: 0.183, Global test loss: 0.741, Global test accuracy: 50.00 

Round   9, Train loss: 0.193, Test loss: 0.817, Test accuracy: 78.40 

Round   9, Global train loss: 0.193, Global test loss: 0.803, Global test accuracy: 50.00 

Round  10, Train loss: 0.150, Test loss: 1.089, Test accuracy: 78.40 

Round  10, Global train loss: 0.150, Global test loss: 0.825, Global test accuracy: 50.00 

Round  11, Train loss: 0.135, Test loss: 0.859, Test accuracy: 80.60 

Round  11, Global train loss: 0.135, Global test loss: 0.847, Global test accuracy: 50.00 

Round  12, Train loss: 0.106, Test loss: 0.806, Test accuracy: 80.20 

Round  12, Global train loss: 0.106, Global test loss: 0.854, Global test accuracy: 50.00 

Round  13, Train loss: 0.100, Test loss: 1.097, Test accuracy: 77.40 

Round  13, Global train loss: 0.100, Global test loss: 0.781, Global test accuracy: 50.00 

Round  14, Train loss: 0.113, Test loss: 0.918, Test accuracy: 78.20 

Round  14, Global train loss: 0.113, Global test loss: 0.795, Global test accuracy: 50.00 

Round  15, Train loss: 0.076, Test loss: 0.936, Test accuracy: 80.30 

Round  15, Global train loss: 0.076, Global test loss: 0.802, Global test accuracy: 50.00 

Round  16, Train loss: 0.068, Test loss: 0.804, Test accuracy: 81.10 

Round  16, Global train loss: 0.068, Global test loss: 0.793, Global test accuracy: 50.00 

Round  17, Train loss: 0.061, Test loss: 0.933, Test accuracy: 80.50 

Round  17, Global train loss: 0.061, Global test loss: 0.791, Global test accuracy: 50.00 

Round  18, Train loss: 0.062, Test loss: 1.040, Test accuracy: 79.40 

Round  18, Global train loss: 0.062, Global test loss: 0.744, Global test accuracy: 50.00 

Round  19, Train loss: 0.059, Test loss: 0.896, Test accuracy: 79.70 

Round  19, Global train loss: 0.059, Global test loss: 0.824, Global test accuracy: 50.00 

Round  20, Train loss: 0.067, Test loss: 0.784, Test accuracy: 82.40 

Round  20, Global train loss: 0.067, Global test loss: 0.813, Global test accuracy: 50.00 

Round  21, Train loss: 0.049, Test loss: 1.016, Test accuracy: 79.00 

Round  21, Global train loss: 0.049, Global test loss: 0.849, Global test accuracy: 50.00 

Round  22, Train loss: 0.044, Test loss: 0.886, Test accuracy: 82.50 

Round  22, Global train loss: 0.044, Global test loss: 0.848, Global test accuracy: 50.00 

Round  23, Train loss: 0.045, Test loss: 0.989, Test accuracy: 79.70 

Round  23, Global train loss: 0.045, Global test loss: 0.796, Global test accuracy: 50.00 

Round  24, Train loss: 0.036, Test loss: 0.966, Test accuracy: 80.40 

Round  24, Global train loss: 0.036, Global test loss: 0.880, Global test accuracy: 50.00 

Round  25, Train loss: 0.020, Test loss: 0.915, Test accuracy: 82.10 

Round  25, Global train loss: 0.020, Global test loss: 0.855, Global test accuracy: 50.00 

Round  26, Train loss: 0.023, Test loss: 0.899, Test accuracy: 81.90 

Round  26, Global train loss: 0.023, Global test loss: 0.796, Global test accuracy: 50.00 

Round  27, Train loss: 0.016, Test loss: 0.919, Test accuracy: 82.10 

Round  27, Global train loss: 0.016, Global test loss: 0.824, Global test accuracy: 50.00 

Round  28, Train loss: 0.033, Test loss: 0.937, Test accuracy: 82.20 

Round  28, Global train loss: 0.033, Global test loss: 0.799, Global test accuracy: 50.00 

Round  29, Train loss: 0.017, Test loss: 1.071, Test accuracy: 82.00 

Round  29, Global train loss: 0.017, Global test loss: 0.782, Global test accuracy: 50.00 

Round  30, Train loss: 0.033, Test loss: 0.933, Test accuracy: 82.30 

Round  30, Global train loss: 0.033, Global test loss: 0.866, Global test accuracy: 50.00 

Round  31, Train loss: 0.021, Test loss: 1.177, Test accuracy: 79.60 

Round  31, Global train loss: 0.021, Global test loss: 0.901, Global test accuracy: 50.00 

Round  32, Train loss: 0.018, Test loss: 0.917, Test accuracy: 82.60 

Round  32, Global train loss: 0.018, Global test loss: 0.799, Global test accuracy: 50.00 

Round  33, Train loss: 0.052, Test loss: 0.922, Test accuracy: 81.00 

Round  33, Global train loss: 0.052, Global test loss: 0.827, Global test accuracy: 50.00 

Round  34, Train loss: 0.023, Test loss: 0.853, Test accuracy: 81.90 

Round  34, Global train loss: 0.023, Global test loss: 0.812, Global test accuracy: 50.00 

Final Round, Train loss: 0.016, Test loss: 1.006, Test accuracy: 81.80 

Final Round, Global train loss: 0.016, Global test loss: 0.812, Global test accuracy: 50.00 

Average accuracy final 10 rounds: 81.77 

Average global accuracy final 10 rounds: 50.0 

467.77019786834717
[4.366007089614868, 6.657686710357666, 8.853657722473145, 11.130068063735962, 13.40721583366394, 15.68143081665039, 18.008249759674072, 20.267302989959717, 22.588977098464966, 24.87123703956604, 27.3149471282959, 29.638668537139893, 32.089266300201416, 34.409477949142456, 36.67644715309143, 39.020512342453, 41.45220065116882, 43.89160084724426, 46.35446286201477, 48.76735329627991, 51.02207064628601, 53.28298878669739, 55.51022672653198, 57.740740060806274, 60.13949918746948, 62.54374957084656, 64.89282298088074, 67.3524444103241, 69.65133905410767, 71.85515117645264, 74.14318203926086, 76.36644220352173, 78.6326117515564, 80.89468574523926, 83.1454529762268, 87.6666054725647]
[75.3, 77.1, 71.4, 71.5, 77.0, 79.3, 74.0, 79.7, 79.2, 78.4, 78.4, 80.6, 80.2, 77.4, 78.2, 80.3, 81.1, 80.5, 79.4, 79.7, 82.4, 79.0, 82.5, 79.7, 80.4, 82.1, 81.9, 82.1, 82.2, 82.0, 82.3, 79.6, 82.6, 81.0, 81.9, 81.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.446, Train accuracy: 79.000, Test loss: 0.844, Test accuracy: 64.50 

        train local model (freeze embeding):client   0,  Train loss: 0.289, Train accuracy: 86.000, Test loss: 0.857, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.288, Train accuracy: 87.000, Test loss: 1.128, Test accuracy: 69.00 

Round   0, Train loss: 0.288, Test loss: 1.128, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.176, Train accuracy: 93.500, Test loss: 0.843, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.303, Train accuracy: 85.500, Test loss: 1.405, Test accuracy: 64.00 

Round   1, Train loss: 0.303, Test loss: 1.405, Test accuracy: 64.00 

        train local model (freeze embeding):client   0,  Train loss: 0.142, Train accuracy: 93.000, Test loss: 1.063, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.087, Train accuracy: 97.000, Test loss: 1.143, Test accuracy: 69.50 

Round   2, Train loss: 0.087, Test loss: 1.143, Test accuracy: 69.50 

        train local model (freeze embeding):client   0,  Train loss: 0.059, Train accuracy: 97.500, Test loss: 1.290, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.154, Train accuracy: 95.000, Test loss: 1.256, Test accuracy: 65.00 

Round   3, Train loss: 0.154, Test loss: 1.256, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.080, Train accuracy: 98.500, Test loss: 1.070, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.064, Train accuracy: 97.000, Test loss: 1.157, Test accuracy: 73.00 

Round   4, Train loss: 0.064, Test loss: 1.157, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.078, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.101, Test accuracy: 72.50 

Round   5, Train loss: 0.014, Test loss: 1.101, Test accuracy: 72.50 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 1.164, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 70.00 

Round   6, Train loss: 0.007, Test loss: 1.182, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.308, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 73.00 

Round   7, Train loss: 0.011, Test loss: 1.224, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.152, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.650, Test accuracy: 71.00 

Round   8, Train loss: 0.005, Test loss: 1.650, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.646, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.664, Test accuracy: 71.50 

Round   9, Train loss: 0.000, Test loss: 1.664, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.715, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 2.147, Test accuracy: 71.00 

Round  10, Train loss: 0.008, Test loss: 2.147, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 2.138, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 1.115, Test accuracy: 71.50 

Round  11, Train loss: 0.041, Test loss: 1.115, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.229, Test accuracy: 73.00 

Round  12, Train loss: 0.002, Test loss: 1.229, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.247, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.393, Test accuracy: 70.50 

Round  13, Train loss: 0.028, Test loss: 1.393, Test accuracy: 70.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.298, Test accuracy: 69.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.408, Test accuracy: 71.50 

Round  14, Train loss: 0.006, Test loss: 1.408, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.292, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.346, Test accuracy: 71.00 

Round  15, Train loss: 0.003, Test loss: 1.346, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.419, Test accuracy: 67.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.128, Train accuracy: 95.500, Test loss: 1.639, Test accuracy: 65.50 

Round  16, Train loss: 0.128, Test loss: 1.639, Test accuracy: 65.50 

        train local model (freeze embeding):client   0,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 1.589, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.328, Test accuracy: 74.50 

Round  17, Train loss: 0.001, Test loss: 1.328, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.351, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.235, Test accuracy: 77.00 

Round  18, Train loss: 0.000, Test loss: 1.235, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.247, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.347, Test accuracy: 75.50 

Round  19, Train loss: 0.000, Test loss: 1.347, Test accuracy: 75.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.370, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 77.50 

Final Round, Train loss: 0.000, Test loss: 1.358, Test accuracy: 76.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.449, Train accuracy: 81.500, Test loss: 0.487, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.515, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.535, Train accuracy: 67.500, Test loss: 0.639, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.165, Train accuracy: 94.500, Test loss: 0.677, Test accuracy: 82.00 

Round   0, Train loss: 0.083, Test loss: 1.143, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 1.837, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.181, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.118, Train accuracy: 97.000, Test loss: 0.381, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.076, Train accuracy: 98.000, Test loss: 0.870, Test accuracy: 81.00 

Round   1, Train loss: 0.039, Test loss: 1.028, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 1.524, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.474, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.111, Train accuracy: 97.000, Test loss: 0.752, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.063, Train accuracy: 97.500, Test loss: 0.630, Test accuracy: 78.50 

Round   2, Train loss: 0.031, Test loss: 0.920, Test accuracy: 77.25 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.595, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 72.50 

        train local model (freeze embeding):client   1,  Train loss: 0.022, Train accuracy: 100.000, Test loss: 0.313, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.153, Train accuracy: 94.500, Test loss: 0.801, Test accuracy: 80.50 

Round   3, Train loss: 0.077, Test loss: 0.897, Test accuracy: 79.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.319, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.326, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.447, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 86.50 

Round   4, Train loss: 0.008, Test loss: 1.032, Test accuracy: 77.25 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.625, Test accuracy: 65.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.461, Test accuracy: 71.50 

        train local model (freeze embeding):client   1,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.389, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.360, Test accuracy: 90.00 

Round   5, Train loss: 0.004, Test loss: 0.846, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.390, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.416, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.538, Test accuracy: 83.50 

Round   6, Train loss: 0.011, Test loss: 1.069, Test accuracy: 76.75 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.493, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.438, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 90.00 

Round   7, Train loss: 0.000, Test loss: 0.900, Test accuracy: 79.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.415, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.442, Test accuracy: 72.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.420, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.427, Test accuracy: 85.50 

Round   8, Train loss: 0.008, Test loss: 0.911, Test accuracy: 79.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.500, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 1.622, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.525, Test accuracy: 89.50 

Round   9, Train loss: 0.015, Test loss: 0.933, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.543, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.440, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.462, Test accuracy: 87.00 

Round  10, Train loss: 0.001, Test loss: 0.926, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 1.482, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.455, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.390, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.433, Test accuracy: 90.50 

Round  11, Train loss: 0.000, Test loss: 0.921, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.524, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.428, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.501, Test accuracy: 89.00 

Round  12, Train loss: 0.000, Test loss: 1.018, Test accuracy: 79.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.527, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.526, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.423, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.444, Test accuracy: 88.50 

Round  13, Train loss: 0.000, Test loss: 0.989, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.557, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 2.386, Test accuracy: 68.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.457, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.501, Test accuracy: 89.50 

Round  14, Train loss: 0.019, Test loss: 1.021, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.546, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.503, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.607, Test accuracy: 88.00 

Round  15, Train loss: 0.002, Test loss: 0.966, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.519, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.287, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.418, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.637, Test accuracy: 85.50 

Round  16, Train loss: 0.007, Test loss: 0.942, Test accuracy: 78.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.372, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.053, Train accuracy: 99.000, Test loss: 1.822, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.482, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.404, Test accuracy: 90.00 

Round  17, Train loss: 0.027, Test loss: 1.036, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.384, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.404, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.421, Test accuracy: 89.50 

Round  18, Train loss: 0.000, Test loss: 0.974, Test accuracy: 79.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.429, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.324, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.427, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.362, Test accuracy: 90.50 

Round  19, Train loss: 0.000, Test loss: 0.918, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.339, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.341, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.421, Test accuracy: 90.50 

Final Round, Train loss: 0.000, Test loss: 0.943, Test accuracy: 79.25 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.832, Train accuracy: 62.500, Test loss: 0.932, Test accuracy: 61.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.354, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.402, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.427, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.521, Train accuracy: 72.000, Test loss: 0.673, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.115, Train accuracy: 96.500, Test loss: 0.462, Test accuracy: 87.00 

Round   0, Train loss: 0.038, Test loss: 0.768, Test accuracy: 80.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.212, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.464, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.181, Train accuracy: 91.500, Test loss: 0.410, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 0.366, Test accuracy: 89.50 

Round   1, Train loss: 0.010, Test loss: 0.728, Test accuracy: 81.33 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.227, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.378, Test accuracy: 72.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.532, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.476, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.081, Train accuracy: 98.000, Test loss: 0.384, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.051, Train accuracy: 99.000, Test loss: 0.321, Test accuracy: 89.00 

Round   2, Train loss: 0.017, Test loss: 0.686, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.102, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.390, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.500, Test loss: 0.514, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.474, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 0.364, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 0.385, Test accuracy: 88.50 

Round   3, Train loss: 0.013, Test loss: 0.682, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.153, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.680, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.485, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.304, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 89.50 

Round   4, Train loss: 0.003, Test loss: 0.692, Test accuracy: 82.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.362, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.451, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.273, Test accuracy: 92.50 

Round   5, Train loss: 0.001, Test loss: 0.640, Test accuracy: 83.83 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.122, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.216, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.592, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.360, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.451, Test accuracy: 88.50 

Round   6, Train loss: 0.009, Test loss: 0.664, Test accuracy: 83.33 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.102, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.258, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.485, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.501, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.051, Train accuracy: 98.500, Test loss: 0.513, Test accuracy: 85.50 

Round   7, Train loss: 0.018, Test loss: 0.694, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.112, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.431, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.487, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.488, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.338, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.460, Test accuracy: 89.00 

Round   8, Train loss: 0.001, Test loss: 0.713, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.346, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.515, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.503, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.417, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 89.50 

Round   9, Train loss: 0.002, Test loss: 0.741, Test accuracy: 82.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.102, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.386, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.544, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.495, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.371, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.049, Train accuracy: 99.000, Test loss: 0.302, Test accuracy: 91.00 

Round  10, Train loss: 0.017, Test loss: 0.738, Test accuracy: 81.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.176, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.484, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.599, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 90.50 

Round  11, Train loss: 0.001, Test loss: 0.697, Test accuracy: 83.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.392, Test accuracy: 72.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.476, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.453, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.318, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.313, Test accuracy: 92.50 

Round  12, Train loss: 0.003, Test loss: 0.690, Test accuracy: 84.67 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.108, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.546, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.332, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 90.00 

Round  13, Train loss: 0.000, Test loss: 0.674, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.479, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.511, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.116, Train accuracy: 95.500, Test loss: 0.735, Test accuracy: 87.00 

Round  14, Train loss: 0.039, Test loss: 0.702, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.418, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.444, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.385, Test accuracy: 89.50 

Round  15, Train loss: 0.001, Test loss: 0.643, Test accuracy: 85.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.361, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.417, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.515, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.399, Test accuracy: 90.00 

Round  16, Train loss: 0.000, Test loss: 0.689, Test accuracy: 84.33 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.157, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.091, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.607, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.339, Test accuracy: 92.50 

Round  17, Train loss: 0.002, Test loss: 0.677, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.156, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.462, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.456, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.366, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.337, Test accuracy: 92.00 

Round  18, Train loss: 0.001, Test loss: 0.615, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.159, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.461, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 91.50 

Round  19, Train loss: 0.001, Test loss: 0.656, Test accuracy: 83.17 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.088, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.434, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.401, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.375, Test accuracy: 91.00 

Final Round, Train loss: 0.001, Test loss: 0.662, Test accuracy: 83.50 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.785, Train accuracy: 55.000, Test loss: 0.885, Test accuracy: 57.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.174, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.441, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.438, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 92.00 

        train local model (freeze embeding):client   3,  Train loss: 0.554, Train accuracy: 70.500, Test loss: 0.686, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.293, Train accuracy: 90.000, Test loss: 1.126, Test accuracy: 64.00 

Round   0, Train loss: 0.073, Test loss: 0.767, Test accuracy: 76.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.061, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.489, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.497, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.432, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.423, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.433, Train accuracy: 80.000, Test loss: 0.837, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.117, Train accuracy: 95.000, Test loss: 1.220, Test accuracy: 64.50 

Round   1, Train loss: 0.029, Test loss: 0.772, Test accuracy: 77.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.048, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.080, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.532, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.676, Train accuracy: 84.000, Test loss: 1.730, Test accuracy: 74.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.473, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.411, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.273, Train accuracy: 89.500, Test loss: 0.818, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.187, Train accuracy: 93.000, Test loss: 1.379, Test accuracy: 65.00 

Round   2, Train loss: 0.219, Test loss: 0.834, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.021, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.210, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.578, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.510, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.496, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.410, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.204, Train accuracy: 94.500, Test loss: 0.923, Test accuracy: 63.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.135, Train accuracy: 95.500, Test loss: 1.206, Test accuracy: 65.50 

Round   3, Train loss: 0.036, Test loss: 0.807, Test accuracy: 76.62 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.080, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.567, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.759, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.493, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 91.50 

        train local model (freeze embeding):client   3,  Train loss: 0.273, Train accuracy: 88.500, Test loss: 1.210, Test accuracy: 59.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.181, Train accuracy: 92.500, Test loss: 1.197, Test accuracy: 66.00 

Round   4, Train loss: 0.045, Test loss: 0.816, Test accuracy: 77.25 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.466, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.705, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.478, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.494, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.101, Train accuracy: 98.000, Test loss: 1.088, Test accuracy: 62.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.084, Train accuracy: 96.500, Test loss: 1.347, Test accuracy: 63.00 

Round   5, Train loss: 0.022, Test loss: 0.816, Test accuracy: 76.88 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.529, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.634, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.068, Train accuracy: 99.000, Test loss: 0.600, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.449, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.422, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.072, Train accuracy: 98.000, Test loss: 1.229, Test accuracy: 62.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.065, Train accuracy: 98.500, Test loss: 1.767, Test accuracy: 59.50 

Round   6, Train loss: 0.033, Test loss: 0.867, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.359, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.567, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.482, Test accuracy: 90.00 

        train local model (freeze embeding):client   3,  Train loss: 0.042, Train accuracy: 99.500, Test loss: 1.382, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.038, Train accuracy: 99.500, Test loss: 1.777, Test accuracy: 63.00 

Round   7, Train loss: 0.011, Test loss: 0.922, Test accuracy: 76.62 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.090, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 1.591, Test accuracy: 68.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.633, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.634, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.462, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.043, Train accuracy: 99.000, Test loss: 1.345, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.209, Train accuracy: 91.000, Test loss: 1.339, Test accuracy: 71.50 

Round   8, Train loss: 0.058, Test loss: 0.818, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.061, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.263, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.645, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.669, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.456, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.401, Test accuracy: 92.50 

        train local model (freeze embeding):client   3,  Train loss: 0.033, Train accuracy: 99.500, Test loss: 1.388, Test accuracy: 63.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.217, Train accuracy: 91.500, Test loss: 2.040, Test accuracy: 61.50 

Round   9, Train loss: 0.055, Test loss: 0.897, Test accuracy: 77.75 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.222, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.628, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.490, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.488, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 1.434, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.151, Train accuracy: 95.000, Test loss: 2.845, Test accuracy: 62.00 

Round  10, Train loss: 0.038, Test loss: 1.010, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.048, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.051, Train accuracy: 98.500, Test loss: 1.183, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.649, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.771, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 91.50 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.520, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.808, Test accuracy: 65.50 

Round  11, Train loss: 0.017, Test loss: 0.950, Test accuracy: 76.38 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.500, Test loss: 1.164, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.419, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.668, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.654, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.449, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.430, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 1.599, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.315, Train accuracy: 88.000, Test loss: 2.304, Test accuracy: 55.00 

Round  12, Train loss: 0.079, Test loss: 1.005, Test accuracy: 76.88 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.506, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.646, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.685, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.671, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 1.642, Test accuracy: 63.50 

Round  13, Train loss: 0.012, Test loss: 0.939, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.087, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.356, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.624, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.572, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.490, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.506, Test accuracy: 88.50 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.674, Test accuracy: 65.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.104, Train accuracy: 95.000, Test loss: 2.173, Test accuracy: 62.50 

Round  14, Train loss: 0.026, Test loss: 0.995, Test accuracy: 76.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.137, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.239, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.620, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.682, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.715, Test accuracy: 65.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 1.707, Test accuracy: 66.00 

Round  15, Train loss: 0.005, Test loss: 0.959, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.118, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.617, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.500, Test loss: 0.615, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.468, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.326, Test accuracy: 92.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.806, Test accuracy: 63.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.191, Test accuracy: 65.50 

Round  16, Train loss: 0.001, Test loss: 0.977, Test accuracy: 76.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.181, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.585, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.600, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.431, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.850, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.116, Test accuracy: 66.00 

Round  17, Train loss: 0.000, Test loss: 1.021, Test accuracy: 76.38 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.117, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.189, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.629, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.427, Test accuracy: 91.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.907, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 2.244, Test accuracy: 64.00 

Round  18, Train loss: 0.002, Test loss: 1.028, Test accuracy: 76.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.652, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.645, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.449, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.045, Test accuracy: 63.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.878, Test accuracy: 66.00 

Round  19, Train loss: 0.007, Test loss: 0.987, Test accuracy: 77.38 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.660, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.676, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.417, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.828, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.791, Test accuracy: 64.50 

Final Round, Train loss: 0.001, Test loss: 0.976, Test accuracy: 76.88 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.358, Train accuracy: 84.500, Test loss: 0.268, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.147, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.311, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.649, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.486, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.805, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.896, Test accuracy: 63.00 

        train local model (freeze embeding):client   4,  Train loss: 0.352, Train accuracy: 84.000, Test loss: 0.259, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.091, Train accuracy: 97.000, Test loss: 0.289, Test accuracy: 91.50 

Round   0, Train loss: 0.019, Test loss: 0.814, Test accuracy: 80.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.164, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.204, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.602, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.578, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.422, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.648, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.929, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.935, Test accuracy: 65.00 

        train local model (freeze embeding):client   4,  Train loss: 0.264, Train accuracy: 87.000, Test loss: 0.312, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.078, Train accuracy: 99.500, Test loss: 0.188, Test accuracy: 94.50 

Round   1, Train loss: 0.024, Test loss: 0.793, Test accuracy: 81.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.431, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.532, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.578, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.435, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.384, Test accuracy: 92.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.939, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.923, Test accuracy: 65.50 

        train local model (freeze embeding):client   4,  Train loss: 0.168, Train accuracy: 95.000, Test loss: 0.279, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.096, Train accuracy: 95.500, Test loss: 0.502, Test accuracy: 85.50 

Round   2, Train loss: 0.020, Test loss: 0.802, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.009, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.283, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.561, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.601, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.549, Test accuracy: 88.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.008, Test accuracy: 65.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 1.788, Test accuracy: 63.50 

        train local model (freeze embeding):client   4,  Train loss: 0.102, Train accuracy: 96.000, Test loss: 0.244, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.182, Train accuracy: 94.500, Test loss: 0.628, Test accuracy: 85.50 

Round   3, Train loss: 0.039, Test loss: 0.833, Test accuracy: 80.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.415, Test accuracy: 70.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.559, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.073, Train accuracy: 97.000, Test loss: 1.150, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.406, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.458, Test accuracy: 90.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.869, Test accuracy: 65.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.408, Test accuracy: 61.50 

        train local model (freeze embeding):client   4,  Train loss: 0.061, Train accuracy: 99.000, Test loss: 0.251, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.312, Test accuracy: 93.50 

Round   4, Train loss: 0.022, Test loss: 0.798, Test accuracy: 80.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.317, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.557, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.575, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.423, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.438, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.878, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.208, Train accuracy: 92.500, Test loss: 2.189, Test accuracy: 59.50 

        train local model (freeze embeding):client   4,  Train loss: 0.038, Train accuracy: 99.500, Test loss: 0.219, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.098, Train accuracy: 98.000, Test loss: 0.306, Test accuracy: 93.50 

Round   5, Train loss: 0.061, Test loss: 0.751, Test accuracy: 82.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.981, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.219, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.575, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 0.761, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.136, Train accuracy: 96.500, Test loss: 0.502, Test accuracy: 90.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.765, Test accuracy: 63.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.852, Test accuracy: 66.00 

        train local model (freeze embeding):client   4,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 0.224, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.362, Test accuracy: 91.50 

Round   6, Train loss: 0.036, Test loss: 0.775, Test accuracy: 81.30 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.221, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.591, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.540, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.359, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.493, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.664, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.244, Test accuracy: 62.50 

        train local model (freeze embeding):client   4,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 0.235, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 92.50 

Round   7, Train loss: 0.001, Test loss: 0.803, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.031, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 1.307, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.582, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.616, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.363, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.338, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.768, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.039, Test accuracy: 64.50 

        train local model (freeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.247, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.304, Test accuracy: 93.00 

Round   8, Train loss: 0.003, Test loss: 0.833, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.212, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.563, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.578, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.404, Test accuracy: 90.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.983, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.910, Test accuracy: 66.00 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.238, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.072, Train accuracy: 99.500, Test loss: 0.548, Test accuracy: 86.00 

Round   9, Train loss: 0.015, Test loss: 0.836, Test accuracy: 81.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.137, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.533, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.638, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 92.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.809, Test accuracy: 63.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 2.000, Test accuracy: 63.50 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.298, Test accuracy: 92.00 

Round  10, Train loss: 0.007, Test loss: 0.797, Test accuracy: 81.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.065, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.557, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.564, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.423, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 92.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.781, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.890, Test accuracy: 65.50 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.271, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 93.50 

Round  11, Train loss: 0.001, Test loss: 0.874, Test accuracy: 81.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.129, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.560, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.623, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.319, Test accuracy: 92.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.869, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.834, Test accuracy: 66.00 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.279, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.117, Train accuracy: 94.500, Test loss: 0.598, Test accuracy: 87.50 

Round  12, Train loss: 0.024, Test loss: 0.835, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.040, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.602, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.662, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.381, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.377, Test accuracy: 91.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.720, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.293, Train accuracy: 89.000, Test loss: 1.668, Test accuracy: 69.00 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.276, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.273, Test accuracy: 92.50 

Round  13, Train loss: 0.062, Test loss: 0.775, Test accuracy: 82.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.586, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.581, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.335, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.354, Test accuracy: 93.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.718, Test accuracy: 66.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.934, Test accuracy: 64.50 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 93.00 

Round  14, Train loss: 0.001, Test loss: 0.782, Test accuracy: 83.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.134, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.586, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.597, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.304, Test accuracy: 91.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.853, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 2.391, Test accuracy: 61.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.255, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.053, Train accuracy: 98.500, Test loss: 0.784, Test accuracy: 86.50 

Round  15, Train loss: 0.013, Test loss: 0.858, Test accuracy: 82.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.048, Train accuracy: 98.000, Test loss: 1.178, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.588, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.567, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.346, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.940, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.132, Test accuracy: 64.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.306, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.265, Test accuracy: 93.50 

Round  16, Train loss: 0.010, Test loss: 0.825, Test accuracy: 81.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.131, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.524, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.527, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.339, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.879, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.000, Test accuracy: 65.50 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.315, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.437, Test accuracy: 89.50 

Round  17, Train loss: 0.000, Test loss: 0.825, Test accuracy: 82.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.961, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.019, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.493, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.561, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.359, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.420, Test accuracy: 91.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.907, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.049, Test accuracy: 65.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.261, Test accuracy: 94.50 

Round  18, Train loss: 0.001, Test loss: 0.819, Test accuracy: 82.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.974, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.492, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.973, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.074, Train accuracy: 98.000, Test loss: 2.502, Test accuracy: 62.50 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.284, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.410, Test accuracy: 88.50 

Round  19, Train loss: 0.016, Test loss: 0.881, Test accuracy: 81.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.927, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.960, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.567, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.579, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.306, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.318, Test accuracy: 93.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.975, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.012, Test accuracy: 64.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.278, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.285, Test accuracy: 92.50 

Final Round, Train loss: 0.001, Test loss: 0.819, Test accuracy: 81.60 

Average accuracy final 10 rounds: 393.92750000000007 

1951.1409032344818
[5.692774295806885, 11.52798843383789, 17.391116857528687, 23.451662063598633, 29.487581253051758, 35.31434464454651, 40.816224575042725, 46.63203716278076, 52.631099700927734, 58.450825214385986, 64.53165698051453, 70.6131284236908, 76.73512148857117, 82.93685150146484, 89.15982007980347, 94.98642539978027, 100.98851442337036, 107.07165312767029, 113.23793721199036, 119.0948760509491, 122.30141115188599, 128.25885701179504, 134.09102129936218, 140.30321311950684, 146.6143832206726, 152.74945330619812, 158.94936513900757, 164.95959210395813, 170.99313354492188, 177.36199188232422, 183.28665924072266, 189.0692698955536, 195.36793208122253, 201.45025897026062, 207.44144535064697, 213.61392450332642, 219.99152946472168, 226.17802596092224, 233.0692994594574, 239.226313829422, 245.64037132263184, 249.54099941253662, 255.8092315196991, 262.0859730243683, 268.4428119659424, 274.7227256298065, 281.1012382507324, 287.5830764770508, 293.82545137405396, 300.2948863506317, 306.59306025505066, 312.74043107032776, 319.23285150527954, 325.2622768878937, 331.44295024871826, 337.77021074295044, 343.7960913181305, 350.05197525024414, 356.38183188438416, 362.5094504356384, 368.6583721637726, 374.9986639022827, 378.97264552116394, 384.9988286495209, 391.3549654483795, 397.9505867958069, 404.43353843688965, 410.9239158630371, 417.09124732017517, 423.23611545562744, 429.36775493621826, 435.6559684276581, 442.279878616333, 448.31009316444397, 454.4934928417206, 460.56774640083313, 466.93373942375183, 472.90812397003174, 479.30600571632385, 485.53464365005493, 492.04902052879333, 498.71467304229736, 505.0870192050934, 508.8500473499298, 514.9579002857208, 521.6393721103668, 527.9305279254913, 534.3188252449036, 540.4540495872498, 546.8764741420746, 553.3855676651001, 559.8949520587921, 566.1651880741119, 572.3862092494965, 578.6253809928894, 585.1337459087372, 591.4747574329376, 597.9889786243439, 604.2415962219238, 610.3469336032867, 617.0708096027374, 623.3753702640533, 629.8732860088348, 636.4623248577118, 639.6701521873474]
[69.0, 64.0, 69.5, 65.0, 73.0, 72.5, 70.0, 73.0, 71.0, 71.5, 71.0, 71.5, 73.0, 70.5, 71.5, 71.0, 65.5, 74.5, 77.0, 75.5, 76.0, 75.0, 74.0, 77.25, 79.25, 77.25, 81.0, 76.75, 79.75, 79.25, 80.75, 80.5, 82.0, 79.25, 79.5, 80.25, 79.0, 78.75, 76.5, 79.25, 80.25, 79.25, 80.66666666666667, 81.33333333333333, 82.16666666666667, 82.16666666666667, 82.66666666666667, 83.83333333333333, 83.33333333333333, 82.5, 82.16666666666667, 82.66666666666667, 81.33333333333333, 83.16666666666667, 84.66666666666667, 83.0, 82.5, 85.33333333333333, 84.33333333333333, 84.5, 84.0, 83.16666666666667, 83.5, 76.875, 77.25, 77.0, 76.625, 77.25, 76.875, 77.5, 76.625, 78.0, 77.75, 76.5, 76.375, 76.875, 77.0, 76.25, 77.0, 76.125, 76.375, 76.75, 77.375, 76.875, 80.6, 81.1, 80.5, 80.8, 80.4, 82.2, 81.3, 81.5, 81.5, 81.1, 81.7, 81.1, 82.0, 82.9, 83.4, 82.1, 81.1, 82.1, 82.3, 81.7, 81.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.735, Test loss: 0.759, Test accuracy: 71.80 

Round   0, Global train loss: 0.735, Global test loss: 0.869, Global test accuracy: 50.10 

Round   1, Train loss: 0.633, Test loss: 0.643, Test accuracy: 71.30 

Round   1, Global train loss: 0.633, Global test loss: 0.891, Global test accuracy: 50.80 

Round   2, Train loss: 0.596, Test loss: 0.756, Test accuracy: 70.90 

Round   2, Global train loss: 0.596, Global test loss: 0.817, Global test accuracy: 57.10 

Round   3, Train loss: 0.593, Test loss: 0.529, Test accuracy: 76.10 

Round   3, Global train loss: 0.593, Global test loss: 0.797, Global test accuracy: 57.20 

Round   4, Train loss: 0.528, Test loss: 0.590, Test accuracy: 75.80 

Round   4, Global train loss: 0.528, Global test loss: 0.702, Global test accuracy: 64.10 

Round   5, Train loss: 0.519, Test loss: 0.536, Test accuracy: 74.70 

Round   5, Global train loss: 0.519, Global test loss: 0.706, Global test accuracy: 64.20 

Round   6, Train loss: 0.501, Test loss: 0.578, Test accuracy: 74.50 

Round   6, Global train loss: 0.501, Global test loss: 0.772, Global test accuracy: 62.90 

Round   7, Train loss: 0.453, Test loss: 0.647, Test accuracy: 75.20 

Round   7, Global train loss: 0.453, Global test loss: 0.865, Global test accuracy: 63.60 

Round   8, Train loss: 0.439, Test loss: 0.638, Test accuracy: 77.50 

Round   8, Global train loss: 0.439, Global test loss: 0.809, Global test accuracy: 66.30 

Round   9, Train loss: 0.421, Test loss: 0.616, Test accuracy: 79.40 

Round   9, Global train loss: 0.421, Global test loss: 0.960, Global test accuracy: 65.60 

Round  10, Train loss: 0.417, Test loss: 0.657, Test accuracy: 73.50 

Round  10, Global train loss: 0.417, Global test loss: 0.897, Global test accuracy: 64.50 

Round  11, Train loss: 0.353, Test loss: 0.629, Test accuracy: 77.40 

Round  11, Global train loss: 0.353, Global test loss: 1.021, Global test accuracy: 64.80 

Round  12, Train loss: 0.377, Test loss: 0.656, Test accuracy: 77.50 

Round  12, Global train loss: 0.377, Global test loss: 0.934, Global test accuracy: 66.00 

Round  13, Train loss: 0.340, Test loss: 0.545, Test accuracy: 77.40 

Round  13, Global train loss: 0.340, Global test loss: 0.955, Global test accuracy: 66.70 

Round  14, Train loss: 0.321, Test loss: 0.563, Test accuracy: 80.70 

Round  14, Global train loss: 0.321, Global test loss: 0.913, Global test accuracy: 67.70 

Round  15, Train loss: 0.306, Test loss: 0.609, Test accuracy: 76.50 

Round  15, Global train loss: 0.306, Global test loss: 1.077, Global test accuracy: 64.50 

Round  16, Train loss: 0.298, Test loss: 0.756, Test accuracy: 73.80 

Round  16, Global train loss: 0.298, Global test loss: 0.942, Global test accuracy: 66.10 

Round  17, Train loss: 0.268, Test loss: 0.853, Test accuracy: 74.20 

Round  17, Global train loss: 0.268, Global test loss: 1.072, Global test accuracy: 62.70 

Round  18, Train loss: 0.255, Test loss: 0.811, Test accuracy: 78.40 

Round  18, Global train loss: 0.255, Global test loss: 0.967, Global test accuracy: 66.10 

Round  19, Train loss: 0.257, Test loss: 0.643, Test accuracy: 79.70 

Round  19, Global train loss: 0.257, Global test loss: 1.080, Global test accuracy: 64.10 

Round  20, Train loss: 0.239, Test loss: 0.721, Test accuracy: 78.10 

Round  20, Global train loss: 0.239, Global test loss: 1.110, Global test accuracy: 66.40 

Round  21, Train loss: 0.209, Test loss: 1.066, Test accuracy: 76.70 

Round  21, Global train loss: 0.209, Global test loss: 1.000, Global test accuracy: 66.60 

Round  22, Train loss: 0.217, Test loss: 0.583, Test accuracy: 81.70 

Round  22, Global train loss: 0.217, Global test loss: 0.996, Global test accuracy: 68.10 

Round  23, Train loss: 0.209, Test loss: 0.592, Test accuracy: 81.70 

Round  23, Global train loss: 0.209, Global test loss: 1.062, Global test accuracy: 69.30 

Round  24, Train loss: 0.187, Test loss: 0.790, Test accuracy: 78.90 

Round  24, Global train loss: 0.187, Global test loss: 1.099, Global test accuracy: 67.70 

Round  25, Train loss: 0.182, Test loss: 0.672, Test accuracy: 79.00 

Round  25, Global train loss: 0.182, Global test loss: 1.019, Global test accuracy: 68.50 

Round  26, Train loss: 0.185, Test loss: 0.673, Test accuracy: 77.80 

Round  26, Global train loss: 0.185, Global test loss: 1.159, Global test accuracy: 65.00 

Round  27, Train loss: 0.186, Test loss: 0.905, Test accuracy: 77.90 

Round  27, Global train loss: 0.186, Global test loss: 1.325, Global test accuracy: 64.50 

Round  28, Train loss: 0.165, Test loss: 0.676, Test accuracy: 80.70 

Round  28, Global train loss: 0.165, Global test loss: 1.124, Global test accuracy: 67.60 

Round  29, Train loss: 0.171, Test loss: 0.561, Test accuracy: 82.50 

Round  29, Global train loss: 0.171, Global test loss: 1.000, Global test accuracy: 69.30 

Round  30, Train loss: 0.155, Test loss: 0.654, Test accuracy: 81.70 

Round  30, Global train loss: 0.155, Global test loss: 1.107, Global test accuracy: 68.60 

Round  31, Train loss: 0.147, Test loss: 0.647, Test accuracy: 79.70 

Round  31, Global train loss: 0.147, Global test loss: 1.045, Global test accuracy: 66.30 

Round  32, Train loss: 0.130, Test loss: 0.824, Test accuracy: 78.00 

Round  32, Global train loss: 0.130, Global test loss: 1.185, Global test accuracy: 65.80 

Round  33, Train loss: 0.122, Test loss: 0.934, Test accuracy: 77.00 

Round  33, Global train loss: 0.122, Global test loss: 1.046, Global test accuracy: 67.80 

Round  34, Train loss: 0.115, Test loss: 0.751, Test accuracy: 80.80 

Round  34, Global train loss: 0.115, Global test loss: 1.246, Global test accuracy: 66.10 

Final Round, Train loss: 0.095, Test loss: 0.768, Test accuracy: 81.40 

Final Round, Global train loss: 0.095, Global test loss: 1.246, Global test accuracy: 66.10 

Average accuracy final 10 rounds: 79.50999999999999 

Average global accuracy final 10 rounds: 66.95 

469.519371509552
[4.379110813140869, 6.766363620758057, 9.265656232833862, 11.58207893371582, 13.95682430267334, 16.24256730079651, 18.59807252883911, 20.92930269241333, 23.121708869934082, 25.398396968841553, 27.812586784362793, 30.28615379333496, 32.60098338127136, 34.97806143760681, 37.251556158065796, 39.53777575492859, 41.91514611244202, 44.33664655685425, 46.58000302314758, 48.95260953903198, 51.32583570480347, 53.5798659324646, 55.897125005722046, 58.240543603897095, 60.769633054733276, 63.02755784988403, 65.42953634262085, 67.8459587097168, 70.07665824890137, 72.3313295841217, 74.76947808265686, 77.01359987258911, 79.36103892326355, 81.68998074531555, 83.90491843223572, 88.37808871269226]
[71.8, 71.3, 70.9, 76.1, 75.8, 74.7, 74.5, 75.2, 77.5, 79.4, 73.5, 77.4, 77.5, 77.4, 80.7, 76.5, 73.8, 74.2, 78.4, 79.7, 78.1, 76.7, 81.7, 81.7, 78.9, 79.0, 77.8, 77.9, 80.7, 82.5, 81.7, 79.7, 78.0, 77.0, 80.8, 81.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.694, Test loss: 0.780, Test accuracy: 51.70 

Round   1, Train loss: 0.685, Test loss: 0.867, Test accuracy: 54.30 

Round   2, Train loss: 0.675, Test loss: 0.711, Test accuracy: 62.90 

Round   3, Train loss: 0.680, Test loss: 1.019, Test accuracy: 62.50 

Round   4, Train loss: 0.636, Test loss: 0.793, Test accuracy: 70.20 

Round   5, Train loss: 0.598, Test loss: 0.721, Test accuracy: 64.50 

Round   6, Train loss: 0.566, Test loss: 0.652, Test accuracy: 69.50 

Round   7, Train loss: 0.533, Test loss: 0.826, Test accuracy: 65.80 

Round   8, Train loss: 0.504, Test loss: 0.743, Test accuracy: 68.90 

Round   9, Train loss: 0.504, Test loss: 0.462, Test accuracy: 77.10 

Round  10, Train loss: 0.499, Test loss: 0.821, Test accuracy: 70.20 

Round  11, Train loss: 0.473, Test loss: 0.685, Test accuracy: 73.20 

Round  12, Train loss: 0.449, Test loss: 0.505, Test accuracy: 76.80 

Round  13, Train loss: 0.399, Test loss: 0.495, Test accuracy: 75.70 

Round  14, Train loss: 0.390, Test loss: 0.480, Test accuracy: 76.80 

Round  15, Train loss: 0.405, Test loss: 0.672, Test accuracy: 72.50 

Round  16, Train loss: 0.395, Test loss: 0.597, Test accuracy: 74.10 

Round  17, Train loss: 0.353, Test loss: 0.580, Test accuracy: 75.70 

Round  18, Train loss: 0.335, Test loss: 0.591, Test accuracy: 76.00 

Round  19, Train loss: 0.318, Test loss: 0.525, Test accuracy: 77.70 

Round  20, Train loss: 0.308, Test loss: 0.567, Test accuracy: 75.90 

Round  21, Train loss: 0.297, Test loss: 0.582, Test accuracy: 74.90 

Round  22, Train loss: 0.288, Test loss: 0.575, Test accuracy: 77.00 

Round  23, Train loss: 0.269, Test loss: 0.508, Test accuracy: 78.70 

Round  24, Train loss: 0.262, Test loss: 0.597, Test accuracy: 78.70 

Round  25, Train loss: 0.240, Test loss: 0.536, Test accuracy: 79.40 

Round  26, Train loss: 0.231, Test loss: 0.503, Test accuracy: 78.80 

Round  27, Train loss: 0.225, Test loss: 0.682, Test accuracy: 77.90 

Round  28, Train loss: 0.204, Test loss: 0.508, Test accuracy: 80.20 

Round  29, Train loss: 0.199, Test loss: 0.510, Test accuracy: 79.30 

Round  30, Train loss: 0.184, Test loss: 0.483, Test accuracy: 80.50 

Round  31, Train loss: 0.172, Test loss: 0.495, Test accuracy: 79.50 

Round  32, Train loss: 0.146, Test loss: 0.643, Test accuracy: 78.80 

Round  33, Train loss: 0.157, Test loss: 0.581, Test accuracy: 79.50 

Round  34, Train loss: 0.151, Test loss: 0.479, Test accuracy: 80.80 

Round  35, Train loss: 0.143, Test loss: 0.519, Test accuracy: 80.50 

Round  36, Train loss: 0.150, Test loss: 0.809, Test accuracy: 79.40 

Round  37, Train loss: 0.126, Test loss: 0.594, Test accuracy: 80.90 

Round  38, Train loss: 0.131, Test loss: 0.664, Test accuracy: 79.70 

Round  39, Train loss: 0.113, Test loss: 0.559, Test accuracy: 80.40 

Round  40, Train loss: 0.125, Test loss: 0.569, Test accuracy: 81.10 

Round  41, Train loss: 0.100, Test loss: 0.524, Test accuracy: 81.60 

Round  42, Train loss: 0.100, Test loss: 0.595, Test accuracy: 80.80 

Round  43, Train loss: 0.088, Test loss: 0.505, Test accuracy: 81.70 

Round  44, Train loss: 0.093, Test loss: 0.652, Test accuracy: 79.70 

Round  45, Train loss: 0.087, Test loss: 0.613, Test accuracy: 80.10 

Round  46, Train loss: 0.059, Test loss: 0.536, Test accuracy: 82.30 

Round  47, Train loss: 0.080, Test loss: 0.657, Test accuracy: 80.10 

Round  48, Train loss: 0.074, Test loss: 0.566, Test accuracy: 82.00 

Round  49, Train loss: 0.067, Test loss: 0.525, Test accuracy: 82.90 

Final Round, Train loss: 0.041, Test loss: 0.615, Test accuracy: 82.50 

Average accuracy final 10 rounds: 81.23000000000002 

492.89848041534424
[3.8646080493927, 5.669694423675537, 7.486626386642456, 9.319806814193726, 11.238009214401245, 13.174588680267334, 14.980821132659912, 16.781235694885254, 18.689802885055542, 20.467565774917603, 22.358794927597046, 24.098027229309082, 25.953394889831543, 27.757091522216797, 29.622647285461426, 31.453723430633545, 33.262300968170166, 35.09628200531006, 36.949793100357056, 38.770190954208374, 40.76225161552429, 42.59783482551575, 44.40592408180237, 46.290005922317505, 48.089054584503174, 49.923864126205444, 51.71183443069458, 53.57565665245056, 55.388678550720215, 57.18936204910278, 59.09824180603027, 60.89562439918518, 62.66694259643555, 64.5450747013092, 66.3874740600586, 68.29120755195618, 70.10824203491211, 71.86413383483887, 73.66279697418213, 75.48742818832397, 77.28833842277527, 79.0440399646759, 80.89348125457764, 82.75610637664795, 84.72823286056519, 86.65398144721985, 88.41122770309448, 90.2668993473053, 92.11097359657288, 93.97323203086853, 95.91809725761414]
[51.7, 54.3, 62.9, 62.5, 70.2, 64.5, 69.5, 65.8, 68.9, 77.1, 70.2, 73.2, 76.8, 75.7, 76.8, 72.5, 74.1, 75.7, 76.0, 77.7, 75.9, 74.9, 77.0, 78.7, 78.7, 79.4, 78.8, 77.9, 80.2, 79.3, 80.5, 79.5, 78.8, 79.5, 80.8, 80.5, 79.4, 80.9, 79.7, 80.4, 81.1, 81.6, 80.8, 81.7, 79.7, 80.1, 82.3, 80.1, 82.0, 82.9, 82.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.758, Test loss: 0.927, Test accuracy: 50.40
Round   1, Train loss: 0.693, Test loss: 0.789, Test accuracy: 61.60
Round   2, Train loss: 0.698, Test loss: 0.923, Test accuracy: 59.90
Round   3, Train loss: 0.645, Test loss: 0.634, Test accuracy: 66.60
Round   4, Train loss: 0.599, Test loss: 0.673, Test accuracy: 65.30
Round   5, Train loss: 0.580, Test loss: 0.775, Test accuracy: 64.60
Round   6, Train loss: 0.554, Test loss: 0.549, Test accuracy: 70.30
Round   7, Train loss: 0.540, Test loss: 0.743, Test accuracy: 66.40
Round   8, Train loss: 0.508, Test loss: 0.543, Test accuracy: 74.00
Round   9, Train loss: 0.493, Test loss: 1.027, Test accuracy: 61.30
Round  10, Train loss: 0.483, Test loss: 0.469, Test accuracy: 77.90
Round  11, Train loss: 0.440, Test loss: 0.509, Test accuracy: 74.70
Round  12, Train loss: 0.406, Test loss: 0.466, Test accuracy: 76.80
Round  13, Train loss: 0.403, Test loss: 0.651, Test accuracy: 74.20
Round  14, Train loss: 0.396, Test loss: 0.450, Test accuracy: 77.00
Round  15, Train loss: 0.365, Test loss: 0.485, Test accuracy: 77.60
Round  16, Train loss: 0.350, Test loss: 0.632, Test accuracy: 71.80
Round  17, Train loss: 0.347, Test loss: 0.593, Test accuracy: 74.60
Round  18, Train loss: 0.332, Test loss: 0.585, Test accuracy: 76.30
Round  19, Train loss: 0.302, Test loss: 0.441, Test accuracy: 80.50
Round  20, Train loss: 0.290, Test loss: 0.578, Test accuracy: 76.00
Round  21, Train loss: 0.282, Test loss: 0.467, Test accuracy: 79.90
Round  22, Train loss: 0.258, Test loss: 0.454, Test accuracy: 78.90
Round  23, Train loss: 0.260, Test loss: 0.467, Test accuracy: 79.60
Round  24, Train loss: 0.259, Test loss: 0.649, Test accuracy: 77.60
Round  25, Train loss: 0.209, Test loss: 0.446, Test accuracy: 81.10
Round  26, Train loss: 0.210, Test loss: 0.542, Test accuracy: 79.90
Round  27, Train loss: 0.217, Test loss: 0.504, Test accuracy: 77.70
Round  28, Train loss: 0.195, Test loss: 0.470, Test accuracy: 79.90
Round  29, Train loss: 0.169, Test loss: 0.475, Test accuracy: 80.30
Round  30, Train loss: 0.175, Test loss: 0.521, Test accuracy: 80.00
Round  31, Train loss: 0.150, Test loss: 0.523, Test accuracy: 79.40
Round  32, Train loss: 0.148, Test loss: 0.593, Test accuracy: 80.30
Round  33, Train loss: 0.175, Test loss: 0.561, Test accuracy: 80.50
Round  34, Train loss: 0.138, Test loss: 0.586, Test accuracy: 79.80
Round  35, Train loss: 0.127, Test loss: 0.500, Test accuracy: 81.70
Round  36, Train loss: 0.111, Test loss: 0.559, Test accuracy: 80.60
Round  37, Train loss: 0.112, Test loss: 0.655, Test accuracy: 78.70
Round  38, Train loss: 0.099, Test loss: 0.538, Test accuracy: 81.40
Round  39, Train loss: 0.103, Test loss: 0.521, Test accuracy: 81.10
Round  40, Train loss: 0.120, Test loss: 0.710, Test accuracy: 79.90
Round  41, Train loss: 0.102, Test loss: 0.513, Test accuracy: 81.80
Round  42, Train loss: 0.089, Test loss: 0.520, Test accuracy: 81.60
Round  43, Train loss: 0.074, Test loss: 0.608, Test accuracy: 81.00
Round  44, Train loss: 0.067, Test loss: 0.554, Test accuracy: 80.80
Round  45, Train loss: 0.064, Test loss: 0.523, Test accuracy: 82.20
Round  46, Train loss: 0.059, Test loss: 0.552, Test accuracy: 81.30
Round  47, Train loss: 0.074, Test loss: 0.562, Test accuracy: 81.70
Round  48, Train loss: 0.055, Test loss: 0.564, Test accuracy: 81.30
Round  49, Train loss: 0.034, Test loss: 0.567, Test accuracy: 81.50
Final Round, Train loss: 0.028, Test loss: 0.595, Test accuracy: 81.50
Average accuracy final 10 rounds: 81.31
546.3970246315002
[4.306774139404297, 6.235391139984131, 8.199804067611694, 10.338967323303223, 12.368066310882568, 14.51767110824585, 16.866233348846436, 18.963746786117554, 21.03674054145813, 23.2535343170166, 25.3018536567688, 27.32282519340515, 29.47800636291504, 31.605491161346436, 33.59882092475891, 35.621094942092896, 37.66417694091797, 39.70405578613281, 41.69572448730469, 43.8336079120636, 45.929096937179565, 47.96290636062622, 49.98647427558899, 52.11018896102905, 54.175217151641846, 56.224992990493774, 58.28844881057739, 60.500003814697266, 62.55465650558472, 64.71447443962097, 66.75679969787598, 68.76637101173401, 70.88553857803345, 73.09186148643494, 75.29228973388672, 77.38336777687073, 79.46718955039978, 81.51001787185669, 83.59824419021606, 85.66626048088074, 87.6505835056305, 89.65456056594849, 91.68643593788147, 93.67643737792969, 95.68736863136292, 97.73640537261963, 99.9246027469635, 101.93800806999207, 104.01126337051392, 106.12891483306885, 108.15148043632507]
[50.4, 61.6, 59.9, 66.6, 65.3, 64.6, 70.3, 66.4, 74.0, 61.3, 77.9, 74.7, 76.8, 74.2, 77.0, 77.6, 71.8, 74.6, 76.3, 80.5, 76.0, 79.9, 78.9, 79.6, 77.6, 81.1, 79.9, 77.7, 79.9, 80.3, 80.0, 79.4, 80.3, 80.5, 79.8, 81.7, 80.6, 78.7, 81.4, 81.1, 79.9, 81.8, 81.6, 81.0, 80.8, 82.2, 81.3, 81.7, 81.3, 81.5, 81.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.406, Test loss: 1.276, Test accuracy: 52.50 

Round   0, Global train loss: 1.406, Global test loss: 1.595, Global test accuracy: 22.70 

Round   1, Train loss: 1.124, Test loss: 1.537, Test accuracy: 51.30 

Round   1, Global train loss: 1.124, Global test loss: 1.613, Global test accuracy: 29.70 

Round   2, Train loss: 0.980, Test loss: 1.310, Test accuracy: 56.10 

Round   2, Global train loss: 0.980, Global test loss: 1.725, Global test accuracy: 27.00 

Round   3, Train loss: 0.860, Test loss: 1.357, Test accuracy: 57.10 

Round   3, Global train loss: 0.860, Global test loss: 2.145, Global test accuracy: 23.30 

Round   4, Train loss: 0.740, Test loss: 1.326, Test accuracy: 57.90 

Round   4, Global train loss: 0.740, Global test loss: 2.077, Global test accuracy: 24.00 

Round   5, Train loss: 0.638, Test loss: 1.234, Test accuracy: 60.20 

Round   5, Global train loss: 0.638, Global test loss: 2.147, Global test accuracy: 22.20 

Round   6, Train loss: 0.555, Test loss: 1.502, Test accuracy: 57.30 

Round   6, Global train loss: 0.555, Global test loss: 2.268, Global test accuracy: 20.80 

Round   7, Train loss: 0.457, Test loss: 1.460, Test accuracy: 61.80 

Round   7, Global train loss: 0.457, Global test loss: 2.053, Global test accuracy: 23.40 

Round   8, Train loss: 0.405, Test loss: 1.521, Test accuracy: 59.70 

Round   8, Global train loss: 0.405, Global test loss: 2.032, Global test accuracy: 25.80 

Round   9, Train loss: 0.337, Test loss: 1.749, Test accuracy: 60.10 

Round   9, Global train loss: 0.337, Global test loss: 2.395, Global test accuracy: 22.50 

Round  10, Train loss: 0.284, Test loss: 1.546, Test accuracy: 61.60 

Round  10, Global train loss: 0.284, Global test loss: 2.149, Global test accuracy: 22.60 

Round  11, Train loss: 0.253, Test loss: 1.626, Test accuracy: 62.80 

Round  11, Global train loss: 0.253, Global test loss: 2.175, Global test accuracy: 25.80 

Round  12, Train loss: 0.202, Test loss: 1.576, Test accuracy: 64.90 

Round  12, Global train loss: 0.202, Global test loss: 2.099, Global test accuracy: 24.50 

Round  13, Train loss: 0.140, Test loss: 1.802, Test accuracy: 61.50 

Round  13, Global train loss: 0.140, Global test loss: 2.322, Global test accuracy: 24.40 

Round  14, Train loss: 0.151, Test loss: 1.580, Test accuracy: 63.40 

Round  14, Global train loss: 0.151, Global test loss: 2.728, Global test accuracy: 21.30 

Round  15, Train loss: 0.138, Test loss: 1.658, Test accuracy: 62.90 

Round  15, Global train loss: 0.138, Global test loss: 2.519, Global test accuracy: 22.20 

Round  16, Train loss: 0.104, Test loss: 1.839, Test accuracy: 63.40 

Round  16, Global train loss: 0.104, Global test loss: 2.499, Global test accuracy: 21.60 

Round  17, Train loss: 0.110, Test loss: 1.893, Test accuracy: 61.60 

Round  17, Global train loss: 0.110, Global test loss: 2.399, Global test accuracy: 25.30 

Round  18, Train loss: 0.074, Test loss: 1.788, Test accuracy: 64.30 

Round  18, Global train loss: 0.074, Global test loss: 2.527, Global test accuracy: 22.30 

Round  19, Train loss: 0.091, Test loss: 1.536, Test accuracy: 67.00 

Round  19, Global train loss: 0.091, Global test loss: 2.433, Global test accuracy: 21.70 

Round  20, Train loss: 0.069, Test loss: 1.827, Test accuracy: 64.50 

Round  20, Global train loss: 0.069, Global test loss: 2.308, Global test accuracy: 22.00 

Round  21, Train loss: 0.087, Test loss: 1.769, Test accuracy: 64.30 

Round  21, Global train loss: 0.087, Global test loss: 2.539, Global test accuracy: 25.20 

Round  22, Train loss: 0.047, Test loss: 1.963, Test accuracy: 64.90 

Round  22, Global train loss: 0.047, Global test loss: 2.405, Global test accuracy: 23.00 

Round  23, Train loss: 0.049, Test loss: 1.619, Test accuracy: 67.10 

Round  23, Global train loss: 0.049, Global test loss: 2.935, Global test accuracy: 20.80 

Round  24, Train loss: 0.041, Test loss: 1.978, Test accuracy: 63.00 

Round  24, Global train loss: 0.041, Global test loss: 2.595, Global test accuracy: 21.90 

Round  25, Train loss: 0.049, Test loss: 1.775, Test accuracy: 67.10 

Round  25, Global train loss: 0.049, Global test loss: 2.606, Global test accuracy: 20.80 

Round  26, Train loss: 0.047, Test loss: 1.703, Test accuracy: 67.00 

Round  26, Global train loss: 0.047, Global test loss: 2.361, Global test accuracy: 24.30 

Round  27, Train loss: 0.037, Test loss: 1.722, Test accuracy: 67.00 

Round  27, Global train loss: 0.037, Global test loss: 2.539, Global test accuracy: 21.60 

Round  28, Train loss: 0.039, Test loss: 1.709, Test accuracy: 65.70 

Round  28, Global train loss: 0.039, Global test loss: 2.088, Global test accuracy: 25.90 

Round  29, Train loss: 0.032, Test loss: 1.838, Test accuracy: 65.40 

Round  29, Global train loss: 0.032, Global test loss: 2.163, Global test accuracy: 27.60 

Round  30, Train loss: 0.047, Test loss: 1.759, Test accuracy: 67.70 

Round  30, Global train loss: 0.047, Global test loss: 2.017, Global test accuracy: 24.90 

Round  31, Train loss: 0.042, Test loss: 2.098, Test accuracy: 62.80 

Round  31, Global train loss: 0.042, Global test loss: 2.618, Global test accuracy: 25.30 

Round  32, Train loss: 0.036, Test loss: 1.832, Test accuracy: 65.50 

Round  32, Global train loss: 0.036, Global test loss: 2.631, Global test accuracy: 22.00 

Round  33, Train loss: 0.034, Test loss: 1.828, Test accuracy: 67.30 

Round  33, Global train loss: 0.034, Global test loss: 2.635, Global test accuracy: 21.70 

Round  34, Train loss: 0.023, Test loss: 1.775, Test accuracy: 68.00 

Round  34, Global train loss: 0.023, Global test loss: 2.601, Global test accuracy: 21.90 

Final Round, Train loss: 0.011, Test loss: 1.848, Test accuracy: 68.00 

Final Round, Global train loss: 0.011, Global test loss: 2.601, Global test accuracy: 21.90 

Average accuracy final 10 rounds: 66.35 

Average global accuracy final 10 rounds: 23.599999999999998 

463.2455735206604
[7.632966995239258, 13.111263990402222, 18.73567032814026, 24.2617826461792, 30.11959958076477, 35.66099572181702, 41.14825892448425, 46.705493688583374, 52.12873935699463, 57.80357050895691, 63.42668318748474, 68.8426833152771, 74.44472241401672, 79.91021728515625, 85.54856395721436, 91.10214924812317, 96.70253467559814, 102.34893202781677, 107.97413492202759, 113.55593466758728, 119.15774178504944, 124.6313693523407, 130.50087642669678, 136.05708026885986, 141.58638739585876, 147.19205331802368, 152.73620653152466, 158.2883529663086, 163.81512546539307, 169.35914063453674, 175.06939554214478, 180.54134488105774, 186.13271737098694, 191.69313383102417, 197.1266565322876, 208.70637226104736]
[52.5, 51.3, 56.1, 57.1, 57.9, 60.2, 57.3, 61.8, 59.7, 60.1, 61.6, 62.8, 64.9, 61.5, 63.4, 62.9, 63.4, 61.6, 64.3, 67.0, 64.5, 64.3, 64.9, 67.1, 63.0, 67.1, 67.0, 67.0, 65.7, 65.4, 67.7, 62.8, 65.5, 67.3, 68.0, 68.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.421, Test loss: 1.403, Test accuracy: 45.90 

Round   0, Global train loss: 1.421, Global test loss: 1.841, Global test accuracy: 25.90 

Round   1, Train loss: 1.238, Test loss: 1.255, Test accuracy: 51.30 

Round   1, Global train loss: 1.238, Global test loss: 1.665, Global test accuracy: 32.90 

Round   2, Train loss: 1.114, Test loss: 1.703, Test accuracy: 47.00 

Round   2, Global train loss: 1.114, Global test loss: 1.550, Global test accuracy: 36.10 

Round   3, Train loss: 1.020, Test loss: 1.437, Test accuracy: 49.20 

Round   3, Global train loss: 1.020, Global test loss: 1.503, Global test accuracy: 38.20 

Round   4, Train loss: 0.914, Test loss: 1.168, Test accuracy: 58.50 

Round   4, Global train loss: 0.914, Global test loss: 1.604, Global test accuracy: 42.00 

Round   5, Train loss: 0.845, Test loss: 1.346, Test accuracy: 57.60 

Round   5, Global train loss: 0.845, Global test loss: 1.571, Global test accuracy: 44.30 

Round   6, Train loss: 0.747, Test loss: 1.213, Test accuracy: 60.30 

Round   6, Global train loss: 0.747, Global test loss: 1.731, Global test accuracy: 42.30 

Round   7, Train loss: 0.684, Test loss: 1.531, Test accuracy: 57.50 

Round   7, Global train loss: 0.684, Global test loss: 1.586, Global test accuracy: 45.80 

Round   8, Train loss: 0.634, Test loss: 1.412, Test accuracy: 59.00 

Round   8, Global train loss: 0.634, Global test loss: 1.524, Global test accuracy: 46.90 

Round   9, Train loss: 0.557, Test loss: 1.256, Test accuracy: 62.20 

Round   9, Global train loss: 0.557, Global test loss: 1.553, Global test accuracy: 49.40 

Round  10, Train loss: 0.501, Test loss: 1.648, Test accuracy: 57.50 

Round  10, Global train loss: 0.501, Global test loss: 1.775, Global test accuracy: 43.30 

Round  11, Train loss: 0.441, Test loss: 1.417, Test accuracy: 61.80 

Round  11, Global train loss: 0.441, Global test loss: 1.853, Global test accuracy: 43.60 

Round  12, Train loss: 0.415, Test loss: 1.275, Test accuracy: 62.70 

Round  12, Global train loss: 0.415, Global test loss: 1.783, Global test accuracy: 44.30 

Round  13, Train loss: 0.364, Test loss: 1.655, Test accuracy: 61.10 

Round  13, Global train loss: 0.364, Global test loss: 1.949, Global test accuracy: 44.30 

Round  14, Train loss: 0.333, Test loss: 1.526, Test accuracy: 59.70 

Round  14, Global train loss: 0.333, Global test loss: 1.906, Global test accuracy: 44.30 

Round  15, Train loss: 0.306, Test loss: 2.030, Test accuracy: 56.30 

Round  15, Global train loss: 0.306, Global test loss: 1.939, Global test accuracy: 44.90 

Round  16, Train loss: 0.277, Test loss: 1.539, Test accuracy: 63.30 

Round  16, Global train loss: 0.277, Global test loss: 1.926, Global test accuracy: 47.30 

Round  17, Train loss: 0.231, Test loss: 1.405, Test accuracy: 67.30 

Round  17, Global train loss: 0.231, Global test loss: 1.852, Global test accuracy: 49.00 

Round  18, Train loss: 0.240, Test loss: 1.516, Test accuracy: 64.80 

Round  18, Global train loss: 0.240, Global test loss: 1.809, Global test accuracy: 48.60 

Round  19, Train loss: 0.178, Test loss: 1.474, Test accuracy: 64.50 

Round  19, Global train loss: 0.178, Global test loss: 2.044, Global test accuracy: 46.80 

Round  20, Train loss: 0.204, Test loss: 1.446, Test accuracy: 65.50 

Round  20, Global train loss: 0.204, Global test loss: 2.120, Global test accuracy: 44.90 

Round  21, Train loss: 0.132, Test loss: 1.504, Test accuracy: 64.90 

Round  21, Global train loss: 0.132, Global test loss: 2.049, Global test accuracy: 47.30 

Round  22, Train loss: 0.183, Test loss: 1.451, Test accuracy: 65.60 

Round  22, Global train loss: 0.183, Global test loss: 1.866, Global test accuracy: 49.90 

Round  23, Train loss: 0.127, Test loss: 1.741, Test accuracy: 64.00 

Round  23, Global train loss: 0.127, Global test loss: 2.032, Global test accuracy: 49.50 

Round  24, Train loss: 0.100, Test loss: 1.475, Test accuracy: 67.50 

Round  24, Global train loss: 0.100, Global test loss: 2.039, Global test accuracy: 50.00 

Round  25, Train loss: 0.126, Test loss: 1.518, Test accuracy: 66.30 

Round  25, Global train loss: 0.126, Global test loss: 2.106, Global test accuracy: 48.90 

Round  26, Train loss: 0.111, Test loss: 1.805, Test accuracy: 65.40 

Round  26, Global train loss: 0.111, Global test loss: 2.076, Global test accuracy: 49.90 

Round  27, Train loss: 0.096, Test loss: 1.651, Test accuracy: 65.10 

Round  27, Global train loss: 0.096, Global test loss: 2.180, Global test accuracy: 48.90 

Round  28, Train loss: 0.090, Test loss: 1.734, Test accuracy: 66.10 

Round  28, Global train loss: 0.090, Global test loss: 2.150, Global test accuracy: 48.60 

Round  29, Train loss: 0.062, Test loss: 1.700, Test accuracy: 64.20 

Round  29, Global train loss: 0.062, Global test loss: 2.117, Global test accuracy: 50.70 

Round  30, Train loss: 0.122, Test loss: 1.584, Test accuracy: 64.40 

Round  30, Global train loss: 0.122, Global test loss: 2.106, Global test accuracy: 50.30 

Round  31, Train loss: 0.039, Test loss: 1.593, Test accuracy: 67.90 

Round  31, Global train loss: 0.039, Global test loss: 2.243, Global test accuracy: 50.20 

Round  32, Train loss: 0.047, Test loss: 1.753, Test accuracy: 62.90 

Round  32, Global train loss: 0.047, Global test loss: 2.528, Global test accuracy: 46.60 

Round  33, Train loss: 0.044, Test loss: 1.800, Test accuracy: 63.30 

Round  33, Global train loss: 0.044, Global test loss: 2.392, Global test accuracy: 48.40 

Round  34, Train loss: 0.057, Test loss: 1.797, Test accuracy: 67.70 

Round  34, Global train loss: 0.057, Global test loss: 2.508, Global test accuracy: 49.30 

Final Round, Train loss: 0.049, Test loss: 1.600, Test accuracy: 67.70 

Final Round, Global train loss: 0.049, Global test loss: 2.508, Global test accuracy: 49.30 

Average accuracy final 10 rounds: 65.33 

Average global accuracy final 10 rounds: 49.18 

466.75508403778076
[7.913214683532715, 13.48057508468628, 18.92590880393982, 24.85418391227722, 30.51561999320984, 36.110068798065186, 41.72650599479675, 47.33187127113342, 53.0181303024292, 58.511215925216675, 64.11019158363342, 69.77529764175415, 75.34493350982666, 81.01166415214539, 86.71422743797302, 92.29803133010864, 98.39744734764099, 104.41668677330017, 109.67995762825012, 115.20162057876587, 120.87436723709106, 126.41157293319702, 131.75090742111206, 137.28059148788452, 142.97102665901184, 148.55902338027954, 154.01383781433105, 159.56043553352356, 165.1469759941101, 170.65217518806458, 176.5438928604126, 182.1401562690735, 188.16015195846558, 193.80642652511597, 199.50154280662537, 210.5532956123352]
[45.9, 51.3, 47.0, 49.2, 58.5, 57.6, 60.3, 57.5, 59.0, 62.2, 57.5, 61.8, 62.7, 61.1, 59.7, 56.3, 63.3, 67.3, 64.8, 64.5, 65.5, 64.9, 65.6, 64.0, 67.5, 66.3, 65.4, 65.1, 66.1, 64.2, 64.4, 67.9, 62.9, 63.3, 67.7, 67.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.539, Test loss: 1.593, Test accuracy: 34.30 

Round   1, Train loss: 1.289, Test loss: 1.316, Test accuracy: 42.60 

Round   2, Train loss: 1.147, Test loss: 1.138, Test accuracy: 56.60 

Round   3, Train loss: 1.072, Test loss: 1.130, Test accuracy: 53.60 

Round   4, Train loss: 1.004, Test loss: 1.301, Test accuracy: 51.50 

Round   5, Train loss: 0.943, Test loss: 1.120, Test accuracy: 57.80 

Round   6, Train loss: 0.819, Test loss: 1.019, Test accuracy: 59.80 

Round   7, Train loss: 0.771, Test loss: 1.071, Test accuracy: 60.50 

Round   8, Train loss: 0.715, Test loss: 1.017, Test accuracy: 61.40 

Round   9, Train loss: 0.653, Test loss: 1.095, Test accuracy: 61.00 

Round  10, Train loss: 0.616, Test loss: 1.086, Test accuracy: 61.10 

Round  11, Train loss: 0.548, Test loss: 1.110, Test accuracy: 63.20 

Round  12, Train loss: 0.524, Test loss: 1.078, Test accuracy: 62.40 

Round  13, Train loss: 0.488, Test loss: 1.073, Test accuracy: 63.50 

Round  14, Train loss: 0.440, Test loss: 1.044, Test accuracy: 64.20 

Round  15, Train loss: 0.388, Test loss: 1.109, Test accuracy: 63.80 

Round  16, Train loss: 0.355, Test loss: 1.095, Test accuracy: 64.80 

Round  17, Train loss: 0.342, Test loss: 1.040, Test accuracy: 66.40 

Round  18, Train loss: 0.286, Test loss: 1.137, Test accuracy: 64.80 

Round  19, Train loss: 0.245, Test loss: 1.113, Test accuracy: 66.10 

Round  20, Train loss: 0.264, Test loss: 1.141, Test accuracy: 65.70 

Round  21, Train loss: 0.224, Test loss: 1.156, Test accuracy: 64.90 

Round  22, Train loss: 0.194, Test loss: 1.223, Test accuracy: 64.70 

Round  23, Train loss: 0.203, Test loss: 1.151, Test accuracy: 66.60 

Round  24, Train loss: 0.163, Test loss: 1.238, Test accuracy: 65.80 

Round  25, Train loss: 0.135, Test loss: 1.195, Test accuracy: 67.50 

Round  26, Train loss: 0.148, Test loss: 1.253, Test accuracy: 66.50 

Round  27, Train loss: 0.151, Test loss: 1.268, Test accuracy: 66.50 

Round  28, Train loss: 0.133, Test loss: 1.221, Test accuracy: 66.40 

Round  29, Train loss: 0.110, Test loss: 1.284, Test accuracy: 67.40 

Round  30, Train loss: 0.107, Test loss: 1.267, Test accuracy: 67.60 

Round  31, Train loss: 0.117, Test loss: 1.317, Test accuracy: 66.60 

Round  32, Train loss: 0.083, Test loss: 1.373, Test accuracy: 66.00 

Round  33, Train loss: 0.068, Test loss: 1.433, Test accuracy: 67.50 

Round  34, Train loss: 0.125, Test loss: 1.398, Test accuracy: 67.40 

Round  35, Train loss: 0.065, Test loss: 1.380, Test accuracy: 68.60 

Round  36, Train loss: 0.068, Test loss: 1.461, Test accuracy: 65.90 

Round  37, Train loss: 0.069, Test loss: 1.288, Test accuracy: 67.20 

Round  38, Train loss: 0.041, Test loss: 1.297, Test accuracy: 68.40 

Round  39, Train loss: 0.047, Test loss: 1.461, Test accuracy: 65.70 

Final Round, Train loss: 0.029, Test loss: 1.423, Test accuracy: 67.70 

Average accuracy final 10 rounds: 67.09 

383.2625377178192
[6.152380704879761, 10.42529582977295, 14.605523347854614, 19.024636030197144, 23.558030605316162, 28.005123138427734, 32.32160305976868, 36.33706092834473, 40.67276668548584, 44.87145638465881, 49.06894898414612, 53.533947229385376, 57.8048357963562, 62.084115982055664, 66.39157557487488, 70.54829621315002, 74.92715549468994, 79.13394117355347, 83.41302585601807, 87.62494993209839, 91.86431765556335, 96.33173489570618, 100.7194755077362, 105.12365102767944, 109.28641939163208, 113.53108882904053, 117.84965419769287, 122.20309853553772, 126.46627497673035, 131.14336490631104, 135.52306127548218, 139.7680902481079, 144.23333549499512, 148.5022702217102, 153.2187774181366, 157.6524863243103, 162.47798347473145, 166.82636284828186, 171.35699081420898, 175.6489667892456, 180.7121298313141]
[34.3, 42.6, 56.6, 53.6, 51.5, 57.8, 59.8, 60.5, 61.4, 61.0, 61.1, 63.2, 62.4, 63.5, 64.2, 63.8, 64.8, 66.4, 64.8, 66.1, 65.7, 64.9, 64.7, 66.6, 65.8, 67.5, 66.5, 66.5, 66.4, 67.4, 67.6, 66.6, 66.0, 67.5, 67.4, 68.6, 65.9, 67.2, 68.4, 65.7, 67.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.567, Test loss: 1.702, Test accuracy: 30.80
Round   1, Train loss: 1.327, Test loss: 1.401, Test accuracy: 35.30
Round   2, Train loss: 1.188, Test loss: 1.338, Test accuracy: 43.80
Round   3, Train loss: 1.105, Test loss: 1.190, Test accuracy: 50.20
Round   4, Train loss: 1.025, Test loss: 1.043, Test accuracy: 56.60
Round   5, Train loss: 0.957, Test loss: 1.075, Test accuracy: 56.20
Round   6, Train loss: 0.885, Test loss: 1.064, Test accuracy: 56.90
Round   7, Train loss: 0.839, Test loss: 1.019, Test accuracy: 58.50
Round   8, Train loss: 0.778, Test loss: 1.002, Test accuracy: 60.40
Round   9, Train loss: 0.722, Test loss: 0.995, Test accuracy: 64.40
Round  10, Train loss: 0.687, Test loss: 0.988, Test accuracy: 62.60
Round  11, Train loss: 0.646, Test loss: 0.981, Test accuracy: 63.30
Round  12, Train loss: 0.581, Test loss: 1.030, Test accuracy: 62.90
Round  13, Train loss: 0.568, Test loss: 0.990, Test accuracy: 65.10
Round  14, Train loss: 0.483, Test loss: 0.996, Test accuracy: 65.00
Round  15, Train loss: 0.447, Test loss: 0.976, Test accuracy: 64.90
Round  16, Train loss: 0.432, Test loss: 0.980, Test accuracy: 67.40
Round  17, Train loss: 0.400, Test loss: 1.091, Test accuracy: 64.80
Round  18, Train loss: 0.362, Test loss: 1.108, Test accuracy: 65.70
Round  19, Train loss: 0.325, Test loss: 1.086, Test accuracy: 66.00
Round  20, Train loss: 0.314, Test loss: 1.042, Test accuracy: 67.40
Round  21, Train loss: 0.264, Test loss: 1.118, Test accuracy: 64.40
Round  22, Train loss: 0.246, Test loss: 1.204, Test accuracy: 64.00
Round  23, Train loss: 0.250, Test loss: 1.104, Test accuracy: 67.40
Round  24, Train loss: 0.194, Test loss: 1.202, Test accuracy: 66.70
Round  25, Train loss: 0.195, Test loss: 1.148, Test accuracy: 67.60
Round  26, Train loss: 0.180, Test loss: 1.109, Test accuracy: 68.10
Round  27, Train loss: 0.145, Test loss: 1.194, Test accuracy: 65.60
Round  28, Train loss: 0.170, Test loss: 1.222, Test accuracy: 65.10
Round  29, Train loss: 0.140, Test loss: 1.267, Test accuracy: 65.40
Round  30, Train loss: 0.131, Test loss: 1.168, Test accuracy: 68.30
Round  31, Train loss: 0.127, Test loss: 1.289, Test accuracy: 66.20
Round  32, Train loss: 0.130, Test loss: 1.310, Test accuracy: 67.50
Round  33, Train loss: 0.099, Test loss: 1.254, Test accuracy: 67.30
Round  34, Train loss: 0.108, Test loss: 1.212, Test accuracy: 67.10
Round  35, Train loss: 0.079, Test loss: 1.314, Test accuracy: 67.40
Round  36, Train loss: 0.095, Test loss: 1.403, Test accuracy: 66.00
Round  37, Train loss: 0.102, Test loss: 1.325, Test accuracy: 66.60
Round  38, Train loss: 0.071, Test loss: 1.211, Test accuracy: 67.30
Round  39, Train loss: 0.063, Test loss: 1.272, Test accuracy: 67.60
Final Round, Train loss: 0.031, Test loss: 1.258, Test accuracy: 67.80
Average accuracy final 10 rounds: 67.13
434.8874521255493
[7.145135879516602, 12.094735622406006, 17.247698307037354, 22.20511293411255, 27.241528034210205, 32.263983726501465, 37.196937084198, 41.97900390625, 46.80456900596619, 51.9352445602417, 56.78891396522522, 61.79286170005798, 66.71423029899597, 71.59464359283447, 76.67940092086792, 81.7009220123291, 86.55660963058472, 91.45540070533752, 96.24775505065918, 101.39334154129028, 106.2424533367157, 111.29707312583923, 116.04794549942017, 120.99674773216248, 125.96671080589294, 131.1488676071167, 136.33703780174255, 141.56372141838074, 146.659166097641, 152.0702600479126, 157.06965732574463, 162.00764656066895, 166.78571844100952, 171.56050992012024, 176.55556750297546, 181.52671074867249, 186.42444324493408, 191.5043981075287, 196.53776121139526, 201.59605717658997, 206.98072290420532]
[30.8, 35.3, 43.8, 50.2, 56.6, 56.2, 56.9, 58.5, 60.4, 64.4, 62.6, 63.3, 62.9, 65.1, 65.0, 64.9, 67.4, 64.8, 65.7, 66.0, 67.4, 64.4, 64.0, 67.4, 66.7, 67.6, 68.1, 65.6, 65.1, 65.4, 68.3, 66.2, 67.5, 67.3, 67.1, 67.4, 66.0, 66.6, 67.3, 67.6, 67.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.641, Train accuracy: 73.000, Test loss: 1.337, Test accuracy: 52.80 

        train local model (freeze embeding):client   0,  Train loss: 0.531, Train accuracy: 78.200, Test loss: 1.279, Test accuracy: 58.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.909, Train accuracy: 69.200, Test loss: 2.222, Test accuracy: 42.80 

Round   0, Train loss: 0.909, Test loss: 2.222, Test accuracy: 42.80 

        train local model (freeze embeding):client   0,  Train loss: 0.346, Train accuracy: 88.000, Test loss: 1.512, Test accuracy: 57.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.265, Train accuracy: 91.000, Test loss: 1.768, Test accuracy: 54.80 

Round   1, Train loss: 0.265, Test loss: 1.768, Test accuracy: 54.80 

        train local model (freeze embeding):client   0,  Train loss: 0.198, Train accuracy: 93.200, Test loss: 1.685, Test accuracy: 57.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.332, Train accuracy: 88.200, Test loss: 2.398, Test accuracy: 52.00 

Round   2, Train loss: 0.332, Test loss: 2.398, Test accuracy: 52.00 

        train local model (freeze embeding):client   0,  Train loss: 0.142, Train accuracy: 95.600, Test loss: 1.648, Test accuracy: 57.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.057, Train accuracy: 98.200, Test loss: 1.907, Test accuracy: 59.80 

Round   3, Train loss: 0.057, Test loss: 1.907, Test accuracy: 59.80 

        train local model (freeze embeding):client   0,  Train loss: 0.044, Train accuracy: 98.800, Test loss: 1.938, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.205, Train accuracy: 93.200, Test loss: 1.936, Test accuracy: 58.60 

Round   4, Train loss: 0.205, Test loss: 1.936, Test accuracy: 58.60 

        train local model (freeze embeding):client   0,  Train loss: 0.104, Train accuracy: 96.000, Test loss: 1.721, Test accuracy: 61.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.600, Test loss: 1.806, Test accuracy: 60.60 

Round   5, Train loss: 0.027, Test loss: 1.806, Test accuracy: 60.60 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.809, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.038, Train accuracy: 98.800, Test loss: 1.885, Test accuracy: 60.80 

Round   6, Train loss: 0.038, Test loss: 1.885, Test accuracy: 60.80 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.930, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.040, Train accuracy: 99.000, Test loss: 1.932, Test accuracy: 58.60 

Round   7, Train loss: 0.040, Test loss: 1.932, Test accuracy: 58.60 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.600, Test loss: 1.913, Test accuracy: 58.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.887, Test accuracy: 60.00 

Round   8, Train loss: 0.006, Test loss: 1.887, Test accuracy: 60.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.917, Test accuracy: 60.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 2.027, Test accuracy: 59.40 

Round   9, Train loss: 0.010, Test loss: 2.027, Test accuracy: 59.40 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.942, Test accuracy: 60.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.181, Test accuracy: 62.20 

Round  10, Train loss: 0.003, Test loss: 2.181, Test accuracy: 62.20 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 2.150, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 2.516, Test accuracy: 59.20 

Round  11, Train loss: 0.018, Test loss: 2.516, Test accuracy: 59.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.336, Test accuracy: 59.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.350, Test accuracy: 59.20 

Round  12, Train loss: 0.004, Test loss: 2.350, Test accuracy: 59.20 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.316, Test accuracy: 60.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.064, Train accuracy: 96.800, Test loss: 2.818, Test accuracy: 56.80 

Round  13, Train loss: 0.064, Test loss: 2.818, Test accuracy: 56.80 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 2.501, Test accuracy: 59.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.086, Test accuracy: 62.80 

Round  14, Train loss: 0.001, Test loss: 2.086, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.041, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.162, Test accuracy: 62.20 

Round  15, Train loss: 0.004, Test loss: 2.162, Test accuracy: 62.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.209, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.302, Test accuracy: 62.20 

Round  16, Train loss: 0.002, Test loss: 2.302, Test accuracy: 62.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.367, Test accuracy: 59.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.246, Test accuracy: 62.20 

Round  17, Train loss: 0.001, Test loss: 2.246, Test accuracy: 62.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.176, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.198, Test accuracy: 60.60 

Round  18, Train loss: 0.002, Test loss: 2.198, Test accuracy: 60.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.298, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.205, Test accuracy: 62.80 

Round  19, Train loss: 0.001, Test loss: 2.205, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.185, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.215, Test accuracy: 61.60 

Final Round, Train loss: 0.000, Test loss: 2.206, Test accuracy: 62.40 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.841, Train accuracy: 64.200, Test loss: 1.049, Test accuracy: 58.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.184, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.290, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.890, Train accuracy: 61.400, Test loss: 1.144, Test accuracy: 55.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.191, Train accuracy: 94.400, Test loss: 1.021, Test accuracy: 69.80 

Round   0, Train loss: 0.096, Test loss: 1.529, Test accuracy: 64.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.174, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.976, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.279, Train accuracy: 93.600, Test loss: 0.893, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.190, Train accuracy: 94.400, Test loss: 1.212, Test accuracy: 70.20 

Round   1, Train loss: 0.096, Test loss: 1.468, Test accuracy: 66.40 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 2.057, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.920, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.112, Train accuracy: 96.800, Test loss: 0.883, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.225, Train accuracy: 93.200, Test loss: 1.603, Test accuracy: 67.40 

Round   2, Train loss: 0.113, Test loss: 1.514, Test accuracy: 66.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.972, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.836, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.055, Train accuracy: 98.800, Test loss: 1.061, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 99.200, Test loss: 1.293, Test accuracy: 71.60 

Round   3, Train loss: 0.019, Test loss: 1.395, Test accuracy: 67.90 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.790, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.083, Train accuracy: 97.400, Test loss: 2.701, Test accuracy: 57.00 

        train local model (freeze embeding):client   1,  Train loss: 0.035, Train accuracy: 99.400, Test loss: 1.024, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.046, Train accuracy: 98.600, Test loss: 1.228, Test accuracy: 73.60 

Round   4, Train loss: 0.065, Test loss: 1.646, Test accuracy: 65.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.909, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.078, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.037, Train accuracy: 99.200, Test loss: 1.037, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.045, Train accuracy: 99.200, Test loss: 1.625, Test accuracy: 67.60 

Round   5, Train loss: 0.023, Test loss: 1.651, Test accuracy: 67.70 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.933, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 2.162, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.334, Test accuracy: 67.80 

Round   6, Train loss: 0.011, Test loss: 1.523, Test accuracy: 68.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.988, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.952, Test accuracy: 60.80 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.393, Test accuracy: 71.00 

Round   7, Train loss: 0.006, Test loss: 1.582, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.987, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 2.103, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.152, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.505, Test accuracy: 71.60 

Round   8, Train loss: 0.017, Test loss: 1.635, Test accuracy: 67.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.022, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.959, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.237, Test accuracy: 75.80 

Round   9, Train loss: 0.001, Test loss: 1.516, Test accuracy: 69.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.905, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.007, Test accuracy: 63.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.418, Test accuracy: 71.80 

Round  10, Train loss: 0.004, Test loss: 1.666, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.064, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.296, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.237, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.283, Test accuracy: 75.00 

Round  11, Train loss: 0.008, Test loss: 1.632, Test accuracy: 69.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.046, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.139, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.221, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.364, Test accuracy: 72.80 

Round  12, Train loss: 0.000, Test loss: 1.670, Test accuracy: 69.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.125, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 2.218, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.582, Test accuracy: 70.40 

Round  13, Train loss: 0.003, Test loss: 1.776, Test accuracy: 68.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.085, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.152, Test accuracy: 65.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.361, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.693, Test accuracy: 72.00 

Round  14, Train loss: 0.008, Test loss: 1.658, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.088, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.123, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.321, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.600, Test loss: 1.414, Test accuracy: 73.80 

Round  15, Train loss: 0.003, Test loss: 1.665, Test accuracy: 68.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.015, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.030, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.281, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.276, Test accuracy: 76.20 

Round  16, Train loss: 0.000, Test loss: 1.699, Test accuracy: 68.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.133, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.301, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.256, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.468, Test accuracy: 75.60 

Round  17, Train loss: 0.001, Test loss: 1.784, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.204, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.061, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.323, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.528, Test accuracy: 73.20 

Round  18, Train loss: 0.002, Test loss: 1.613, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.994, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.113, Test accuracy: 62.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.328, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.035, Train accuracy: 98.400, Test loss: 1.544, Test accuracy: 71.40 

Round  19, Train loss: 0.018, Test loss: 1.704, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.086, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.064, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.210, Test accuracy: 76.80 

Final Round, Train loss: 0.001, Test loss: 1.678, Test accuracy: 70.40 

Average accuracy final 10 rounds: 130.29 

988.0269479751587
[15.699241161346436, 30.580824375152588, 45.21633529663086, 60.028056621551514, 75.35455298423767, 90.52437233924866, 105.51863169670105, 120.06559705734253, 135.14074182510376, 149.72780013084412, 164.7624156475067, 180.5838005542755, 195.73493123054504, 210.9306025505066, 226.54765129089355, 241.59132313728333, 256.4137828350067, 271.68827533721924, 286.7459452152252, 302.0594503879547, 310.1898193359375, 324.4734206199646, 339.67561888694763, 354.80990195274353, 369.7623553276062, 385.3140230178833, 400.59605979919434, 415.3361427783966, 430.37719225883484, 445.78302025794983, 460.62878584861755, 475.997501373291, 491.9225356578827, 507.33425426483154, 522.5187385082245, 537.4426603317261, 552.7951068878174, 568.4249444007874, 583.2630150318146, 598.5183682441711, 613.8659045696259, 623.2601153850555]
[42.8, 54.8, 52.0, 59.8, 58.6, 60.6, 60.8, 58.6, 60.0, 59.4, 62.2, 59.2, 59.2, 56.8, 62.8, 62.2, 62.2, 62.2, 60.6, 62.8, 62.4, 64.0, 66.4, 66.0, 67.9, 65.8, 67.7, 68.7, 68.4, 67.3, 69.5, 69.8, 69.9, 69.7, 68.5, 69.8, 68.9, 68.9, 69.2, 68.4, 69.6, 70.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.458, Test loss: 1.297, Test accuracy: 51.00 

Round   0, Global train loss: 1.458, Global test loss: 1.621, Global test accuracy: 30.80 

Round   1, Train loss: 1.143, Test loss: 1.173, Test accuracy: 55.10 

Round   1, Global train loss: 1.143, Global test loss: 1.496, Global test accuracy: 33.50 

Round   2, Train loss: 0.957, Test loss: 1.248, Test accuracy: 57.30 

Round   2, Global train loss: 0.957, Global test loss: 1.562, Global test accuracy: 31.40 

Round   3, Train loss: 0.855, Test loss: 1.316, Test accuracy: 59.50 

Round   3, Global train loss: 0.855, Global test loss: 1.536, Global test accuracy: 33.40 

Round   4, Train loss: 0.696, Test loss: 1.282, Test accuracy: 58.80 

Round   4, Global train loss: 0.696, Global test loss: 1.606, Global test accuracy: 34.40 

Round   5, Train loss: 0.609, Test loss: 1.346, Test accuracy: 60.70 

Round   5, Global train loss: 0.609, Global test loss: 1.798, Global test accuracy: 34.20 

Round   6, Train loss: 0.505, Test loss: 1.268, Test accuracy: 65.40 

Round   6, Global train loss: 0.505, Global test loss: 1.928, Global test accuracy: 35.00 

Round   7, Train loss: 0.437, Test loss: 1.217, Test accuracy: 64.60 

Round   7, Global train loss: 0.437, Global test loss: 1.609, Global test accuracy: 34.30 

Round   8, Train loss: 0.384, Test loss: 1.531, Test accuracy: 62.40 

Round   8, Global train loss: 0.384, Global test loss: 1.669, Global test accuracy: 35.30 

Round   9, Train loss: 0.317, Test loss: 1.378, Test accuracy: 66.20 

Round   9, Global train loss: 0.317, Global test loss: 1.899, Global test accuracy: 31.40 

Round  10, Train loss: 0.263, Test loss: 1.465, Test accuracy: 64.20 

Round  10, Global train loss: 0.263, Global test loss: 1.824, Global test accuracy: 29.90 

Round  11, Train loss: 0.232, Test loss: 1.348, Test accuracy: 68.20 

Round  11, Global train loss: 0.232, Global test loss: 1.893, Global test accuracy: 30.30 

Round  12, Train loss: 0.191, Test loss: 1.838, Test accuracy: 63.80 

Round  12, Global train loss: 0.191, Global test loss: 1.727, Global test accuracy: 30.50 

Round  13, Train loss: 0.202, Test loss: 1.381, Test accuracy: 69.50 

Round  13, Global train loss: 0.202, Global test loss: 1.718, Global test accuracy: 35.90 

Round  14, Train loss: 0.159, Test loss: 1.516, Test accuracy: 67.20 

Round  14, Global train loss: 0.159, Global test loss: 1.728, Global test accuracy: 31.70 

Round  15, Train loss: 0.141, Test loss: 1.636, Test accuracy: 66.90 

Round  15, Global train loss: 0.141, Global test loss: 1.796, Global test accuracy: 29.90 

Round  16, Train loss: 0.137, Test loss: 1.571, Test accuracy: 66.10 

Round  16, Global train loss: 0.137, Global test loss: 1.946, Global test accuracy: 33.50 

Round  17, Train loss: 0.105, Test loss: 1.578, Test accuracy: 68.40 

Round  17, Global train loss: 0.105, Global test loss: 2.149, Global test accuracy: 29.60 

Round  18, Train loss: 0.063, Test loss: 1.761, Test accuracy: 68.10 

Round  18, Global train loss: 0.063, Global test loss: 2.139, Global test accuracy: 29.40 

Round  19, Train loss: 0.072, Test loss: 1.611, Test accuracy: 68.30 

Round  19, Global train loss: 0.072, Global test loss: 1.736, Global test accuracy: 28.70 

Round  20, Train loss: 0.059, Test loss: 2.045, Test accuracy: 66.20 

Round  20, Global train loss: 0.059, Global test loss: 2.108, Global test accuracy: 27.70 

Round  21, Train loss: 0.071, Test loss: 1.826, Test accuracy: 68.20 

Round  21, Global train loss: 0.071, Global test loss: 1.663, Global test accuracy: 32.60 

Round  22, Train loss: 0.060, Test loss: 1.738, Test accuracy: 68.30 

Round  22, Global train loss: 0.060, Global test loss: 2.208, Global test accuracy: 29.70 

Round  23, Train loss: 0.045, Test loss: 1.769, Test accuracy: 68.10 

Round  23, Global train loss: 0.045, Global test loss: 2.024, Global test accuracy: 29.00 

Round  24, Train loss: 0.064, Test loss: 1.696, Test accuracy: 70.40 

Round  24, Global train loss: 0.064, Global test loss: 1.996, Global test accuracy: 25.80 

Round  25, Train loss: 0.039, Test loss: 1.698, Test accuracy: 70.10 

Round  25, Global train loss: 0.039, Global test loss: 1.786, Global test accuracy: 28.90 

Round  26, Train loss: 0.051, Test loss: 1.719, Test accuracy: 68.30 

Round  26, Global train loss: 0.051, Global test loss: 2.291, Global test accuracy: 29.80 

Round  27, Train loss: 0.046, Test loss: 1.729, Test accuracy: 70.80 

Round  27, Global train loss: 0.046, Global test loss: 2.378, Global test accuracy: 26.90 

Round  28, Train loss: 0.036, Test loss: 1.891, Test accuracy: 70.40 

Round  28, Global train loss: 0.036, Global test loss: 2.220, Global test accuracy: 29.30 

Round  29, Train loss: 0.037, Test loss: 1.792, Test accuracy: 70.40 

Round  29, Global train loss: 0.037, Global test loss: 2.398, Global test accuracy: 29.50 

Round  30, Train loss: 0.021, Test loss: 1.847, Test accuracy: 69.40 

Round  30, Global train loss: 0.021, Global test loss: 2.305, Global test accuracy: 29.10 

Round  31, Train loss: 0.043, Test loss: 1.929, Test accuracy: 68.90 

Round  31, Global train loss: 0.043, Global test loss: 2.395, Global test accuracy: 28.90 

Round  32, Train loss: 0.036, Test loss: 1.827, Test accuracy: 69.60 

Round  32, Global train loss: 0.036, Global test loss: 1.950, Global test accuracy: 29.10 

Round  33, Train loss: 0.038, Test loss: 1.754, Test accuracy: 70.70 

Round  33, Global train loss: 0.038, Global test loss: 2.264, Global test accuracy: 28.60 

Round  34, Train loss: 0.031, Test loss: 1.851, Test accuracy: 69.50 

Round  34, Global train loss: 0.031, Global test loss: 1.990, Global test accuracy: 29.90 

Final Round, Train loss: 0.018, Test loss: 1.877, Test accuracy: 70.70 

Final Round, Global train loss: 0.018, Global test loss: 1.990, Global test accuracy: 29.90 

Average accuracy final 10 rounds: 69.81 

Average global accuracy final 10 rounds: 28.999999999999996 

463.4470224380493
[7.481868028640747, 12.954909324645996, 18.501339197158813, 23.885363340377808, 29.535300254821777, 35.08281397819519, 40.536232471466064, 46.127697706222534, 51.674981117248535, 57.37760639190674, 62.79288291931152, 68.33935403823853, 74.1296775341034, 79.65502452850342, 85.1622154712677, 90.66850757598877, 96.10899686813354, 101.98314309120178, 108.00350165367126, 113.77126717567444, 119.33697628974915, 124.70670509338379, 130.3286657333374, 135.9939694404602, 141.4785680770874, 147.07575273513794, 152.5807650089264, 158.21719336509705, 163.61312794685364, 169.18284344673157, 174.56852269172668, 180.17525506019592, 185.63203477859497, 191.04761791229248, 196.74147748947144, 207.99149298667908]
[51.0, 55.1, 57.3, 59.5, 58.8, 60.7, 65.4, 64.6, 62.4, 66.2, 64.2, 68.2, 63.8, 69.5, 67.2, 66.9, 66.1, 68.4, 68.1, 68.3, 66.2, 68.2, 68.3, 68.1, 70.4, 70.1, 68.3, 70.8, 70.4, 70.4, 69.4, 68.9, 69.6, 70.7, 69.5, 70.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.462, Test loss: 1.354, Test accuracy: 43.40 

Round   0, Global train loss: 1.462, Global test loss: 1.757, Global test accuracy: 27.60 

Round   1, Train loss: 1.240, Test loss: 1.356, Test accuracy: 50.80 

Round   1, Global train loss: 1.240, Global test loss: 1.460, Global test accuracy: 37.20 

Round   2, Train loss: 1.117, Test loss: 1.329, Test accuracy: 55.10 

Round   2, Global train loss: 1.117, Global test loss: 1.384, Global test accuracy: 43.30 

Round   3, Train loss: 0.998, Test loss: 1.183, Test accuracy: 58.20 

Round   3, Global train loss: 0.998, Global test loss: 1.230, Global test accuracy: 48.30 

Round   4, Train loss: 0.896, Test loss: 1.087, Test accuracy: 60.80 

Round   4, Global train loss: 0.896, Global test loss: 1.354, Global test accuracy: 47.20 

Round   5, Train loss: 0.807, Test loss: 1.387, Test accuracy: 58.20 

Round   5, Global train loss: 0.807, Global test loss: 1.382, Global test accuracy: 50.20 

Round   6, Train loss: 0.712, Test loss: 1.077, Test accuracy: 63.00 

Round   6, Global train loss: 0.712, Global test loss: 1.449, Global test accuracy: 49.70 

Round   7, Train loss: 0.663, Test loss: 1.155, Test accuracy: 65.80 

Round   7, Global train loss: 0.663, Global test loss: 1.408, Global test accuracy: 52.80 

Round   8, Train loss: 0.596, Test loss: 1.325, Test accuracy: 65.30 

Round   8, Global train loss: 0.596, Global test loss: 1.672, Global test accuracy: 51.10 

Round   9, Train loss: 0.499, Test loss: 1.723, Test accuracy: 60.70 

Round   9, Global train loss: 0.499, Global test loss: 1.659, Global test accuracy: 51.00 

Round  10, Train loss: 0.475, Test loss: 1.563, Test accuracy: 62.00 

Round  10, Global train loss: 0.475, Global test loss: 1.919, Global test accuracy: 51.60 

Round  11, Train loss: 0.399, Test loss: 1.498, Test accuracy: 59.50 

Round  11, Global train loss: 0.399, Global test loss: 1.574, Global test accuracy: 51.80 

Round  12, Train loss: 0.375, Test loss: 1.538, Test accuracy: 64.50 

Round  12, Global train loss: 0.375, Global test loss: 1.544, Global test accuracy: 56.90 

Round  13, Train loss: 0.343, Test loss: 1.424, Test accuracy: 64.20 

Round  13, Global train loss: 0.343, Global test loss: 1.470, Global test accuracy: 58.40 

Round  14, Train loss: 0.302, Test loss: 1.508, Test accuracy: 64.10 

Round  14, Global train loss: 0.302, Global test loss: 1.781, Global test accuracy: 54.40 

Round  15, Train loss: 0.271, Test loss: 1.814, Test accuracy: 61.40 

Round  15, Global train loss: 0.271, Global test loss: 2.232, Global test accuracy: 50.30 

Round  16, Train loss: 0.220, Test loss: 1.377, Test accuracy: 69.40 

Round  16, Global train loss: 0.220, Global test loss: 1.857, Global test accuracy: 54.70 

Round  17, Train loss: 0.227, Test loss: 1.531, Test accuracy: 66.30 

Round  17, Global train loss: 0.227, Global test loss: 1.701, Global test accuracy: 57.90 

Round  18, Train loss: 0.187, Test loss: 1.361, Test accuracy: 69.40 

Round  18, Global train loss: 0.187, Global test loss: 1.695, Global test accuracy: 59.10 

Round  19, Train loss: 0.210, Test loss: 1.684, Test accuracy: 65.10 

Round  19, Global train loss: 0.210, Global test loss: 1.891, Global test accuracy: 55.80 

Round  20, Train loss: 0.140, Test loss: 1.524, Test accuracy: 68.20 

Round  20, Global train loss: 0.140, Global test loss: 1.770, Global test accuracy: 58.00 

Round  21, Train loss: 0.144, Test loss: 1.590, Test accuracy: 66.30 

Round  21, Global train loss: 0.144, Global test loss: 1.799, Global test accuracy: 59.30 

Round  22, Train loss: 0.134, Test loss: 1.532, Test accuracy: 69.30 

Round  22, Global train loss: 0.134, Global test loss: 1.907, Global test accuracy: 56.90 

Round  23, Train loss: 0.142, Test loss: 1.742, Test accuracy: 66.50 

Round  23, Global train loss: 0.142, Global test loss: 2.070, Global test accuracy: 56.80 

Round  24, Train loss: 0.129, Test loss: 1.544, Test accuracy: 70.50 

Round  24, Global train loss: 0.129, Global test loss: 1.798, Global test accuracy: 60.80 

Round  25, Train loss: 0.102, Test loss: 1.728, Test accuracy: 67.30 

Round  25, Global train loss: 0.102, Global test loss: 1.736, Global test accuracy: 59.30 

Round  26, Train loss: 0.084, Test loss: 1.603, Test accuracy: 69.60 

Round  26, Global train loss: 0.084, Global test loss: 1.806, Global test accuracy: 61.60 

Round  27, Train loss: 0.058, Test loss: 1.910, Test accuracy: 66.30 

Round  27, Global train loss: 0.058, Global test loss: 2.161, Global test accuracy: 58.20 

Round  28, Train loss: 0.078, Test loss: 1.744, Test accuracy: 68.20 

Round  28, Global train loss: 0.078, Global test loss: 1.855, Global test accuracy: 59.80 

Round  29, Train loss: 0.110, Test loss: 1.531, Test accuracy: 68.40 

Round  29, Global train loss: 0.110, Global test loss: 1.815, Global test accuracy: 60.70 

Round  30, Train loss: 0.071, Test loss: 1.777, Test accuracy: 66.80 

Round  30, Global train loss: 0.071, Global test loss: 1.855, Global test accuracy: 59.80 

Round  31, Train loss: 0.064, Test loss: 1.551, Test accuracy: 70.80 

Round  31, Global train loss: 0.064, Global test loss: 1.800, Global test accuracy: 59.10 

Round  32, Train loss: 0.038, Test loss: 1.626, Test accuracy: 70.00 

Round  32, Global train loss: 0.038, Global test loss: 1.902, Global test accuracy: 59.80 

Round  33, Train loss: 0.053, Test loss: 1.867, Test accuracy: 68.60 

Round  33, Global train loss: 0.053, Global test loss: 2.105, Global test accuracy: 58.40 

Round  34, Train loss: 0.023, Test loss: 1.812, Test accuracy: 69.10 

Round  34, Global train loss: 0.023, Global test loss: 1.956, Global test accuracy: 59.40 

Final Round, Train loss: 0.026, Test loss: 1.734, Test accuracy: 70.30 

Final Round, Global train loss: 0.026, Global test loss: 1.956, Global test accuracy: 59.40 

Average accuracy final 10 rounds: 68.50999999999999 

Average global accuracy final 10 rounds: 59.609999999999985 

466.50860500335693
[7.92916202545166, 13.794006824493408, 19.61112666130066, 25.49729824066162, 30.961308479309082, 36.477970361709595, 42.06189799308777, 47.7342414855957, 53.28818964958191, 58.79481315612793, 64.57341289520264, 70.37692189216614, 75.71014094352722, 81.56164383888245, 86.93300318717957, 92.22407388687134, 97.58210158348083, 103.06152153015137, 108.58078289031982, 114.06709408760071, 119.69435834884644, 125.32546091079712, 130.7081425189972, 136.18422675132751, 141.71360635757446, 147.9484465122223, 153.88854360580444, 159.69713878631592, 165.27021431922913, 170.898535490036, 176.40443396568298, 181.84596300125122, 187.5044686794281, 193.09432697296143, 198.64350152015686, 209.7523000240326]
[43.4, 50.8, 55.1, 58.2, 60.8, 58.2, 63.0, 65.8, 65.3, 60.7, 62.0, 59.5, 64.5, 64.2, 64.1, 61.4, 69.4, 66.3, 69.4, 65.1, 68.2, 66.3, 69.3, 66.5, 70.5, 67.3, 69.6, 66.3, 68.2, 68.4, 66.8, 70.8, 70.0, 68.6, 69.1, 70.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.539, Test loss: 1.847, Test accuracy: 25.80 

Round   1, Train loss: 1.315, Test loss: 1.167, Test accuracy: 50.50 

Round   2, Train loss: 1.174, Test loss: 1.229, Test accuracy: 46.60 

Round   3, Train loss: 1.054, Test loss: 1.033, Test accuracy: 56.30 

Round   4, Train loss: 0.961, Test loss: 0.929, Test accuracy: 62.80 

Round   5, Train loss: 0.920, Test loss: 1.046, Test accuracy: 59.30 

Round   6, Train loss: 0.862, Test loss: 1.055, Test accuracy: 60.90 

Round   7, Train loss: 0.769, Test loss: 0.948, Test accuracy: 65.00 

Round   8, Train loss: 0.709, Test loss: 0.935, Test accuracy: 65.50 

Round   9, Train loss: 0.658, Test loss: 0.999, Test accuracy: 64.90 

Round  10, Train loss: 0.636, Test loss: 1.054, Test accuracy: 64.20 

Round  11, Train loss: 0.584, Test loss: 0.928, Test accuracy: 67.90 

Round  12, Train loss: 0.519, Test loss: 1.013, Test accuracy: 66.30 

Round  13, Train loss: 0.486, Test loss: 0.954, Test accuracy: 69.00 

Round  14, Train loss: 0.443, Test loss: 0.955, Test accuracy: 67.50 

Round  15, Train loss: 0.418, Test loss: 1.002, Test accuracy: 67.40 

Round  16, Train loss: 0.356, Test loss: 1.029, Test accuracy: 67.90 

Round  17, Train loss: 0.348, Test loss: 1.072, Test accuracy: 66.80 

Round  18, Train loss: 0.330, Test loss: 1.012, Test accuracy: 69.00 

Round  19, Train loss: 0.261, Test loss: 1.003, Test accuracy: 69.90 

Round  20, Train loss: 0.253, Test loss: 1.150, Test accuracy: 67.80 

Round  21, Train loss: 0.240, Test loss: 1.121, Test accuracy: 67.40 

Round  22, Train loss: 0.208, Test loss: 1.168, Test accuracy: 69.30 

Round  23, Train loss: 0.201, Test loss: 1.162, Test accuracy: 69.00 

Round  24, Train loss: 0.191, Test loss: 1.176, Test accuracy: 68.00 

Round  25, Train loss: 0.155, Test loss: 1.279, Test accuracy: 68.00 

Round  26, Train loss: 0.165, Test loss: 1.220, Test accuracy: 68.70 

Round  27, Train loss: 0.140, Test loss: 1.133, Test accuracy: 70.40 

Round  28, Train loss: 0.152, Test loss: 1.153, Test accuracy: 69.60 

Round  29, Train loss: 0.140, Test loss: 1.220, Test accuracy: 68.60 

Round  30, Train loss: 0.108, Test loss: 1.232, Test accuracy: 70.00 

Round  31, Train loss: 0.084, Test loss: 1.245, Test accuracy: 67.70 

Round  32, Train loss: 0.124, Test loss: 1.219, Test accuracy: 70.60 

Round  33, Train loss: 0.102, Test loss: 1.199, Test accuracy: 71.30 

Round  34, Train loss: 0.091, Test loss: 1.256, Test accuracy: 67.80 

Round  35, Train loss: 0.070, Test loss: 1.272, Test accuracy: 70.00 

Round  36, Train loss: 0.072, Test loss: 1.360, Test accuracy: 69.60 

Round  37, Train loss: 0.061, Test loss: 1.288, Test accuracy: 70.00 

Round  38, Train loss: 0.051, Test loss: 1.393, Test accuracy: 69.10 

Round  39, Train loss: 0.066, Test loss: 1.436, Test accuracy: 68.80 

Final Round, Train loss: 0.058, Test loss: 1.423, Test accuracy: 69.10 

Average accuracy final 10 rounds: 69.49 

388.44082736968994
[6.283776521682739, 10.558531284332275, 14.764811038970947, 19.037750482559204, 23.227864265441895, 27.540530920028687, 31.920487880706787, 36.44148302078247, 40.9969961643219, 45.295443534851074, 49.655492305755615, 54.06924295425415, 58.362162828445435, 62.70527768135071, 67.02610659599304, 71.59398984909058, 75.8977780342102, 80.3961980342865, 85.25803208351135, 89.74160766601562, 94.27744221687317, 98.8157160282135, 103.41627192497253, 107.8471028804779, 112.03291988372803, 116.60969686508179, 120.79435300827026, 125.02494502067566, 129.29458904266357, 133.6918659210205, 138.03093791007996, 142.40847325325012, 147.02776217460632, 151.4329674243927, 155.6384720802307, 159.98898220062256, 164.35388374328613, 168.79644966125488, 173.23347187042236, 177.64850664138794, 181.97612309455872]
[25.8, 50.5, 46.6, 56.3, 62.8, 59.3, 60.9, 65.0, 65.5, 64.9, 64.2, 67.9, 66.3, 69.0, 67.5, 67.4, 67.9, 66.8, 69.0, 69.9, 67.8, 67.4, 69.3, 69.0, 68.0, 68.0, 68.7, 70.4, 69.6, 68.6, 70.0, 67.7, 70.6, 71.3, 67.8, 70.0, 69.6, 70.0, 69.1, 68.8, 69.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.551, Test loss: 1.589, Test accuracy: 36.70
Round   1, Train loss: 1.332, Test loss: 1.339, Test accuracy: 40.10
Round   2, Train loss: 1.192, Test loss: 1.047, Test accuracy: 54.10
Round   3, Train loss: 1.080, Test loss: 1.031, Test accuracy: 57.50
Round   4, Train loss: 1.011, Test loss: 1.071, Test accuracy: 58.60
Round   5, Train loss: 0.921, Test loss: 0.934, Test accuracy: 63.90
Round   6, Train loss: 0.861, Test loss: 1.058, Test accuracy: 60.70
Round   7, Train loss: 0.795, Test loss: 1.043, Test accuracy: 61.80
Round   8, Train loss: 0.731, Test loss: 0.920, Test accuracy: 66.80
Round   9, Train loss: 0.665, Test loss: 0.893, Test accuracy: 67.60
Round  10, Train loss: 0.604, Test loss: 1.017, Test accuracy: 67.00
Round  11, Train loss: 0.601, Test loss: 1.020, Test accuracy: 65.20
Round  12, Train loss: 0.535, Test loss: 1.040, Test accuracy: 65.20
Round  13, Train loss: 0.490, Test loss: 1.051, Test accuracy: 65.70
Round  14, Train loss: 0.459, Test loss: 0.969, Test accuracy: 66.50
Round  15, Train loss: 0.398, Test loss: 0.899, Test accuracy: 69.40
Round  16, Train loss: 0.357, Test loss: 1.056, Test accuracy: 66.60
Round  17, Train loss: 0.323, Test loss: 0.986, Test accuracy: 69.50
Round  18, Train loss: 0.324, Test loss: 1.008, Test accuracy: 68.10
Round  19, Train loss: 0.269, Test loss: 0.979, Test accuracy: 70.60
Round  20, Train loss: 0.276, Test loss: 1.000, Test accuracy: 69.00
Round  21, Train loss: 0.228, Test loss: 1.036, Test accuracy: 69.60
Round  22, Train loss: 0.210, Test loss: 1.012, Test accuracy: 71.00
Round  23, Train loss: 0.180, Test loss: 1.114, Test accuracy: 67.90
Round  24, Train loss: 0.192, Test loss: 1.096, Test accuracy: 70.40
Round  25, Train loss: 0.191, Test loss: 1.091, Test accuracy: 70.10
Round  26, Train loss: 0.156, Test loss: 1.051, Test accuracy: 69.90
Round  27, Train loss: 0.131, Test loss: 1.127, Test accuracy: 69.60
Round  28, Train loss: 0.135, Test loss: 1.106, Test accuracy: 71.60
Round  29, Train loss: 0.109, Test loss: 1.150, Test accuracy: 70.80
Round  30, Train loss: 0.102, Test loss: 1.170, Test accuracy: 70.40
Round  31, Train loss: 0.113, Test loss: 1.171, Test accuracy: 70.10
Round  32, Train loss: 0.130, Test loss: 1.151, Test accuracy: 69.80
Round  33, Train loss: 0.086, Test loss: 1.126, Test accuracy: 72.20
Round  34, Train loss: 0.084, Test loss: 1.088, Test accuracy: 72.70
Round  35, Train loss: 0.066, Test loss: 1.180, Test accuracy: 72.20
Round  36, Train loss: 0.071, Test loss: 1.165, Test accuracy: 72.30
Round  37, Train loss: 0.061, Test loss: 1.133, Test accuracy: 72.80
Round  38, Train loss: 0.046, Test loss: 1.210, Test accuracy: 73.20
Round  39, Train loss: 0.053, Test loss: 1.272, Test accuracy: 70.40
Final Round, Train loss: 0.042, Test loss: 1.243, Test accuracy: 71.20
Average accuracy final 10 rounds: 71.61
434.16353011131287
[6.902753591537476, 11.744050741195679, 16.6159245967865, 21.573848724365234, 26.818273782730103, 32.04604911804199, 37.11021184921265, 41.869677782058716, 46.57108473777771, 51.3804612159729, 56.47982668876648, 61.25425410270691, 66.26771330833435, 71.26568412780762, 76.11414933204651, 81.06107759475708, 85.93725371360779, 90.9930830001831, 95.9079692363739, 100.93052196502686, 105.74493885040283, 110.75840091705322, 115.76906681060791, 120.62286829948425, 125.75278949737549, 130.67212200164795, 135.8452274799347, 140.70525455474854, 145.83443021774292, 150.96063923835754, 155.88597869873047, 161.06505846977234, 166.19599771499634, 171.20408177375793, 176.10554790496826, 181.10447216033936, 186.18154907226562, 191.19230794906616, 196.4855237007141, 201.33306646347046, 206.60898733139038]
[36.7, 40.1, 54.1, 57.5, 58.6, 63.9, 60.7, 61.8, 66.8, 67.6, 67.0, 65.2, 65.2, 65.7, 66.5, 69.4, 66.6, 69.5, 68.1, 70.6, 69.0, 69.6, 71.0, 67.9, 70.4, 70.1, 69.9, 69.6, 71.6, 70.8, 70.4, 70.1, 69.8, 72.2, 72.7, 72.2, 72.3, 72.8, 73.2, 70.4, 71.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.419, Train accuracy: 83.200, Test loss: 1.193, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.245, Train accuracy: 92.200, Test loss: 0.919, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.409, Train accuracy: 86.000, Test loss: 1.417, Test accuracy: 62.00 

Round   0, Train loss: 0.409, Test loss: 1.417, Test accuracy: 62.00 

        train local model (freeze embeding):client   0,  Train loss: 0.226, Train accuracy: 92.400, Test loss: 1.145, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.071, Train accuracy: 97.800, Test loss: 1.110, Test accuracy: 75.60 

Round   1, Train loss: 0.071, Test loss: 1.110, Test accuracy: 75.60 

        train local model (freeze embeding):client   0,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 1.019, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 1.019, Test accuracy: 74.00 

Round   2, Train loss: 0.054, Test loss: 1.019, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.044, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.064, Train accuracy: 98.400, Test loss: 1.252, Test accuracy: 74.40 

Round   3, Train loss: 0.064, Test loss: 1.252, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.076, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.082, Train accuracy: 97.400, Test loss: 1.336, Test accuracy: 73.80 

Round   4, Train loss: 0.082, Test loss: 1.336, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 1.112, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.143, Test accuracy: 76.00 

Round   5, Train loss: 0.018, Test loss: 1.143, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.129, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.200, Test loss: 1.167, Test accuracy: 75.40 

Round   6, Train loss: 0.019, Test loss: 1.167, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.108, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.102, Test accuracy: 78.20 

Round   7, Train loss: 0.002, Test loss: 1.102, Test accuracy: 78.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.117, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 77.00 

Round   8, Train loss: 0.002, Test loss: 1.244, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.230, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.071, Test accuracy: 79.00 

Round   9, Train loss: 0.002, Test loss: 1.071, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.050, Train accuracy: 98.400, Test loss: 1.412, Test accuracy: 74.60 

Round  10, Train loss: 0.050, Test loss: 1.412, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.225, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.072, Test accuracy: 78.00 

Round  11, Train loss: 0.001, Test loss: 1.072, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.045, Test accuracy: 80.00 

Round  12, Train loss: 0.000, Test loss: 1.045, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.223, Test accuracy: 79.00 

Round  13, Train loss: 0.003, Test loss: 1.223, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.245, Test accuracy: 77.00 

Round  14, Train loss: 0.003, Test loss: 1.245, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.210, Test accuracy: 77.40 

Round  15, Train loss: 0.000, Test loss: 1.210, Test accuracy: 77.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.276, Test accuracy: 77.00 

Round  16, Train loss: 0.001, Test loss: 1.276, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.158, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.184, Test accuracy: 81.60 

Round  17, Train loss: 0.009, Test loss: 1.184, Test accuracy: 81.60 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.194, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 79.80 

Round  18, Train loss: 0.000, Test loss: 1.113, Test accuracy: 79.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.093, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 81.00 

Round  19, Train loss: 0.000, Test loss: 1.092, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.115, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.170, Test accuracy: 80.20 

Final Round, Train loss: 0.000, Test loss: 1.155, Test accuracy: 79.40 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 1.024, Train accuracy: 58.600, Test loss: 1.291, Test accuracy: 49.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.166, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.157, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 1.254, Train accuracy: 49.400, Test loss: 1.710, Test accuracy: 41.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.602, Train accuracy: 77.600, Test loss: 1.579, Test accuracy: 55.80 

Round   0, Train loss: 0.301, Test loss: 1.149, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.087, Test accuracy: 80.40 

        train local model (freeze embeding):client   1,  Train loss: 0.544, Train accuracy: 79.400, Test loss: 1.225, Test accuracy: 58.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.504, Train accuracy: 80.200, Test loss: 1.809, Test accuracy: 52.20 

Round   1, Train loss: 0.252, Test loss: 1.221, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.115, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.040, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.277, Train accuracy: 91.800, Test loss: 1.291, Test accuracy: 59.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.258, Train accuracy: 90.800, Test loss: 1.937, Test accuracy: 56.00 

Round   2, Train loss: 0.130, Test loss: 1.206, Test accuracy: 68.10 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.964, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.134, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.165, Train accuracy: 95.800, Test loss: 1.432, Test accuracy: 59.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.179, Train accuracy: 94.200, Test loss: 1.901, Test accuracy: 55.40 

Round   3, Train loss: 0.090, Test loss: 1.334, Test accuracy: 67.30 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.030, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.078, Train accuracy: 98.400, Test loss: 1.523, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.276, Train accuracy: 91.600, Test loss: 2.163, Test accuracy: 54.00 

Round   4, Train loss: 0.138, Test loss: 1.328, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.050, Train accuracy: 99.000, Test loss: 1.609, Test accuracy: 60.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.071, Train accuracy: 98.000, Test loss: 1.830, Test accuracy: 57.80 

Round   5, Train loss: 0.036, Test loss: 1.270, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.104, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.032, Train accuracy: 99.600, Test loss: 1.646, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.276, Train accuracy: 91.200, Test loss: 2.410, Test accuracy: 53.00 

Round   6, Train loss: 0.139, Test loss: 1.452, Test accuracy: 66.80 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.001, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.081, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.600, Test loss: 1.717, Test accuracy: 61.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.136, Train accuracy: 96.400, Test loss: 2.506, Test accuracy: 54.40 

Round   7, Train loss: 0.069, Test loss: 1.429, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.951, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.876, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.393, Train accuracy: 87.400, Test loss: 3.186, Test accuracy: 50.40 

Round   8, Train loss: 0.197, Test loss: 1.526, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.021, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.078, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.840, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.095, Train accuracy: 97.200, Test loss: 2.366, Test accuracy: 58.00 

Round   9, Train loss: 0.048, Test loss: 1.467, Test accuracy: 70.30 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.124, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.840, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 2.057, Test accuracy: 60.60 

Round  10, Train loss: 0.008, Test loss: 1.388, Test accuracy: 71.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.048, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.118, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.932, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.221, Test accuracy: 60.00 

Round  11, Train loss: 0.001, Test loss: 1.509, Test accuracy: 70.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.800, Test loss: 1.266, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.992, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 2.546, Test accuracy: 57.40 

Round  12, Train loss: 0.014, Test loss: 1.588, Test accuracy: 70.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.043, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.175, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.042, Train accuracy: 99.400, Test loss: 2.143, Test accuracy: 58.60 

Round  13, Train loss: 0.021, Test loss: 1.468, Test accuracy: 72.10 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.047, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.097, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.264, Test accuracy: 60.80 

Round  14, Train loss: 0.002, Test loss: 1.458, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.054, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.047, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.231, Test accuracy: 62.00 

Round  15, Train loss: 0.001, Test loss: 1.496, Test accuracy: 70.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.142, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.148, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.062, Train accuracy: 98.000, Test loss: 2.659, Test accuracy: 57.40 

Round  16, Train loss: 0.031, Test loss: 1.600, Test accuracy: 69.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.087, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.143, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.033, Train accuracy: 98.800, Test loss: 2.876, Test accuracy: 58.80 

Round  17, Train loss: 0.017, Test loss: 1.599, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.118, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.076, Test accuracy: 80.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.085, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.545, Test accuracy: 57.40 

Round  18, Train loss: 0.002, Test loss: 1.617, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.096, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.253, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.333, Test accuracy: 60.00 

Round  19, Train loss: 0.000, Test loss: 1.557, Test accuracy: 71.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.238, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.243, Test accuracy: 62.20 

Final Round, Train loss: 0.000, Test loss: 1.582, Test accuracy: 71.30 

Average accuracy final 10 rounds: 149.54 

986.9852089881897
[15.418044328689575, 29.724747896194458, 45.52127957344055, 60.95489311218262, 76.15620994567871, 90.93880915641785, 105.81172275543213, 121.572016954422, 136.9874975681305, 152.37716674804688, 167.00176286697388, 182.05850887298584, 196.75649785995483, 211.7109067440033, 226.88646149635315, 242.85667872428894, 257.7010016441345, 273.7927861213684, 288.9303078651428, 303.7847309112549, 312.31838631629944, 327.703125, 343.12153339385986, 357.72176790237427, 372.85039258003235, 387.7016222476959, 403.2131042480469, 418.2761826515198, 433.2872462272644, 448.594779253006, 463.53922963142395, 478.21214294433594, 493.51017713546753, 509.3433277606964, 524.3650379180908, 539.7342884540558, 554.9949381351471, 570.6077983379364, 586.302139043808, 601.4961504936218, 616.8854429721832, 626.1783435344696]
[62.0, 75.6, 74.0, 74.4, 73.8, 76.0, 75.4, 78.2, 77.0, 79.0, 74.6, 78.0, 80.0, 79.0, 77.0, 77.4, 77.0, 81.6, 79.8, 81.0, 79.4, 69.0, 66.6, 68.1, 67.3, 67.8, 70.0, 66.8, 68.4, 69.0, 70.3, 71.9, 70.7, 70.8, 72.1, 71.6, 70.7, 69.7, 70.6, 70.0, 71.9, 71.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.396, Test loss: 1.227, Test accuracy: 53.36 

Round   0, Global train loss: 1.396, Global test loss: 2.074, Global test accuracy: 31.64 

Round   1, Train loss: 1.065, Test loss: 1.286, Test accuracy: 55.72 

Round   1, Global train loss: 1.065, Global test loss: 2.095, Global test accuracy: 31.52 

Round   2, Train loss: 0.903, Test loss: 1.129, Test accuracy: 60.28 

Round   2, Global train loss: 0.903, Global test loss: 2.143, Global test accuracy: 31.92 

Round   3, Train loss: 0.743, Test loss: 1.221, Test accuracy: 60.80 

Round   3, Global train loss: 0.743, Global test loss: 2.178, Global test accuracy: 32.32 

Round   4, Train loss: 0.646, Test loss: 1.187, Test accuracy: 61.64 

Round   4, Global train loss: 0.646, Global test loss: 2.209, Global test accuracy: 28.88 

Round   5, Train loss: 0.528, Test loss: 1.281, Test accuracy: 61.40 

Round   5, Global train loss: 0.528, Global test loss: 2.205, Global test accuracy: 26.60 

Round   6, Train loss: 0.458, Test loss: 1.279, Test accuracy: 64.16 

Round   6, Global train loss: 0.458, Global test loss: 2.192, Global test accuracy: 32.16 

Round   7, Train loss: 0.397, Test loss: 1.310, Test accuracy: 65.76 

Round   7, Global train loss: 0.397, Global test loss: 2.261, Global test accuracy: 22.84 

Round   8, Train loss: 0.321, Test loss: 1.336, Test accuracy: 66.08 

Round   8, Global train loss: 0.321, Global test loss: 2.253, Global test accuracy: 23.04 

Round   9, Train loss: 0.266, Test loss: 1.516, Test accuracy: 64.84 

Round   9, Global train loss: 0.266, Global test loss: 2.292, Global test accuracy: 22.68 

Round  10, Train loss: 0.238, Test loss: 1.425, Test accuracy: 67.92 

Round  10, Global train loss: 0.238, Global test loss: 2.301, Global test accuracy: 16.20 

Round  11, Train loss: 0.204, Test loss: 1.422, Test accuracy: 67.52 

Round  11, Global train loss: 0.204, Global test loss: 2.297, Global test accuracy: 21.00 

Round  12, Train loss: 0.174, Test loss: 1.360, Test accuracy: 68.88 

Round  12, Global train loss: 0.174, Global test loss: 2.283, Global test accuracy: 22.28 

Round  13, Train loss: 0.151, Test loss: 1.387, Test accuracy: 68.04 

Round  13, Global train loss: 0.151, Global test loss: 2.357, Global test accuracy: 23.20 

Round  14, Train loss: 0.119, Test loss: 1.414, Test accuracy: 69.80 

Round  14, Global train loss: 0.119, Global test loss: 2.289, Global test accuracy: 23.52 

Round  15, Train loss: 0.091, Test loss: 1.496, Test accuracy: 70.12 

Round  15, Global train loss: 0.091, Global test loss: 2.286, Global test accuracy: 24.52 

Round  16, Train loss: 0.093, Test loss: 1.739, Test accuracy: 66.96 

Round  16, Global train loss: 0.093, Global test loss: 2.346, Global test accuracy: 22.68 

Round  17, Train loss: 0.096, Test loss: 1.450, Test accuracy: 71.00 

Round  17, Global train loss: 0.096, Global test loss: 2.256, Global test accuracy: 23.92 

Round  18, Train loss: 0.078, Test loss: 1.529, Test accuracy: 69.24 

Round  18, Global train loss: 0.078, Global test loss: 2.295, Global test accuracy: 23.76 

Round  19, Train loss: 0.059, Test loss: 1.518, Test accuracy: 70.16 

Round  19, Global train loss: 0.059, Global test loss: 2.312, Global test accuracy: 23.44 

Round  20, Train loss: 0.061, Test loss: 1.433, Test accuracy: 71.36 

Round  20, Global train loss: 0.061, Global test loss: 2.308, Global test accuracy: 23.32 

Round  21, Train loss: 0.071, Test loss: 1.731, Test accuracy: 67.48 

Round  21, Global train loss: 0.071, Global test loss: 2.331, Global test accuracy: 23.84 

Round  22, Train loss: 0.057, Test loss: 1.491, Test accuracy: 71.72 

Round  22, Global train loss: 0.057, Global test loss: 2.292, Global test accuracy: 20.96 

Round  23, Train loss: 0.045, Test loss: 1.482, Test accuracy: 71.32 

Round  23, Global train loss: 0.045, Global test loss: 2.297, Global test accuracy: 21.72 

Round  24, Train loss: 0.031, Test loss: 1.501, Test accuracy: 71.92 

Round  24, Global train loss: 0.031, Global test loss: 2.303, Global test accuracy: 21.04 

Round  25, Train loss: 0.045, Test loss: 1.627, Test accuracy: 70.36 

Round  25, Global train loss: 0.045, Global test loss: 2.317, Global test accuracy: 18.88 

Round  26, Train loss: 0.034, Test loss: 1.626, Test accuracy: 71.44 

Round  26, Global train loss: 0.034, Global test loss: 2.305, Global test accuracy: 22.04 

Round  27, Train loss: 0.046, Test loss: 1.619, Test accuracy: 70.84 

Round  27, Global train loss: 0.046, Global test loss: 2.269, Global test accuracy: 20.72 

Round  28, Train loss: 0.031, Test loss: 1.559, Test accuracy: 72.12 

Round  28, Global train loss: 0.031, Global test loss: 2.297, Global test accuracy: 21.48 

Round  29, Train loss: 0.028, Test loss: 1.447, Test accuracy: 72.32 

Round  29, Global train loss: 0.028, Global test loss: 2.333, Global test accuracy: 21.44 

Round  30, Train loss: 0.033, Test loss: 1.695, Test accuracy: 70.44 

Round  30, Global train loss: 0.033, Global test loss: 2.323, Global test accuracy: 22.60 

Round  31, Train loss: 0.031, Test loss: 1.589, Test accuracy: 70.84 

Round  31, Global train loss: 0.031, Global test loss: 2.338, Global test accuracy: 18.44 

Round  32, Train loss: 0.029, Test loss: 1.602, Test accuracy: 70.72 

Round  32, Global train loss: 0.029, Global test loss: 2.259, Global test accuracy: 22.00 

Round  33, Train loss: 0.027, Test loss: 1.652, Test accuracy: 72.20 

Round  33, Global train loss: 0.027, Global test loss: 2.280, Global test accuracy: 22.84 

Round  34, Train loss: 0.024, Test loss: 1.531, Test accuracy: 71.80 

Round  34, Global train loss: 0.024, Global test loss: 2.270, Global test accuracy: 21.88 

Final Round, Train loss: 0.019, Test loss: 1.603, Test accuracy: 72.60 

Final Round, Global train loss: 0.019, Global test loss: 2.270, Global test accuracy: 21.88 

Average accuracy final 10 rounds: 71.30799999999999 

Average global accuracy final 10 rounds: 21.231999999999996 

1146.8082239627838
[7.528708219528198, 13.138117790222168, 18.62250304222107, 24.571406602859497, 30.246053457260132, 35.89300298690796, 41.58537173271179, 47.26558256149292, 52.92321276664734, 58.77710032463074, 64.14398145675659, 69.7289650440216, 75.29222464561462, 81.13203263282776, 87.06208419799805, 92.63211393356323, 98.45325541496277, 104.0665283203125, 109.84570455551147, 116.14926815032959, 121.75530123710632, 127.47394227981567, 133.1842484474182, 139.5161075592041, 145.30207300186157, 151.15560746192932, 157.24856734275818, 162.89547514915466, 168.64258933067322, 174.28722262382507, 179.853905916214, 185.56925535202026, 191.45043563842773, 197.28292894363403, 203.56001472473145, 214.64968538284302]
[53.36, 55.72, 60.28, 60.8, 61.64, 61.4, 64.16, 65.76, 66.08, 64.84, 67.92, 67.52, 68.88, 68.04, 69.8, 70.12, 66.96, 71.0, 69.24, 70.16, 71.36, 67.48, 71.72, 71.32, 71.92, 70.36, 71.44, 70.84, 72.12, 72.32, 70.44, 70.84, 70.72, 72.2, 71.8, 72.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.390, Test loss: 1.251, Test accuracy: 51.68 

Round   0, Global train loss: 1.390, Global test loss: 2.128, Global test accuracy: 23.40 

Round   1, Train loss: 1.229, Test loss: 1.097, Test accuracy: 58.20 

Round   1, Global train loss: 1.229, Global test loss: 1.817, Global test accuracy: 38.04 

Round   2, Train loss: 1.083, Test loss: 1.158, Test accuracy: 58.44 

Round   2, Global train loss: 1.083, Global test loss: 1.568, Global test accuracy: 48.88 

Round   3, Train loss: 0.948, Test loss: 1.198, Test accuracy: 59.20 

Round   3, Global train loss: 0.948, Global test loss: 1.671, Global test accuracy: 47.84 

Round   4, Train loss: 0.859, Test loss: 0.949, Test accuracy: 64.56 

Round   4, Global train loss: 0.859, Global test loss: 1.448, Global test accuracy: 54.84 

Round   5, Train loss: 0.771, Test loss: 0.966, Test accuracy: 66.64 

Round   5, Global train loss: 0.771, Global test loss: 1.340, Global test accuracy: 58.12 

Round   6, Train loss: 0.706, Test loss: 1.174, Test accuracy: 65.24 

Round   6, Global train loss: 0.706, Global test loss: 1.306, Global test accuracy: 59.56 

Round   7, Train loss: 0.641, Test loss: 0.925, Test accuracy: 69.20 

Round   7, Global train loss: 0.641, Global test loss: 1.179, Global test accuracy: 62.44 

Round   8, Train loss: 0.588, Test loss: 1.033, Test accuracy: 68.88 

Round   8, Global train loss: 0.588, Global test loss: 1.327, Global test accuracy: 60.88 

Round   9, Train loss: 0.547, Test loss: 0.873, Test accuracy: 73.08 

Round   9, Global train loss: 0.547, Global test loss: 1.203, Global test accuracy: 63.28 

Round  10, Train loss: 0.503, Test loss: 1.080, Test accuracy: 69.76 

Round  10, Global train loss: 0.503, Global test loss: 1.247, Global test accuracy: 63.76 

Round  11, Train loss: 0.457, Test loss: 0.876, Test accuracy: 73.28 

Round  11, Global train loss: 0.457, Global test loss: 1.171, Global test accuracy: 64.60 

Round  12, Train loss: 0.421, Test loss: 0.872, Test accuracy: 73.60 

Round  12, Global train loss: 0.421, Global test loss: 1.131, Global test accuracy: 65.44 

Round  13, Train loss: 0.398, Test loss: 0.816, Test accuracy: 74.96 

Round  13, Global train loss: 0.398, Global test loss: 1.188, Global test accuracy: 65.24 

Round  14, Train loss: 0.359, Test loss: 0.950, Test accuracy: 73.24 

Round  14, Global train loss: 0.359, Global test loss: 1.164, Global test accuracy: 66.16 

Round  15, Train loss: 0.353, Test loss: 0.762, Test accuracy: 76.92 

Round  15, Global train loss: 0.353, Global test loss: 1.145, Global test accuracy: 66.32 

Round  16, Train loss: 0.311, Test loss: 0.783, Test accuracy: 76.52 

Round  16, Global train loss: 0.311, Global test loss: 1.118, Global test accuracy: 66.88 

Round  17, Train loss: 0.308, Test loss: 0.978, Test accuracy: 74.36 

Round  17, Global train loss: 0.308, Global test loss: 1.124, Global test accuracy: 67.68 

Round  18, Train loss: 0.265, Test loss: 0.910, Test accuracy: 76.64 

Round  18, Global train loss: 0.265, Global test loss: 1.259, Global test accuracy: 66.36 

Round  19, Train loss: 0.262, Test loss: 1.015, Test accuracy: 75.04 

Round  19, Global train loss: 0.262, Global test loss: 1.155, Global test accuracy: 68.72 

Round  20, Train loss: 0.241, Test loss: 0.900, Test accuracy: 77.20 

Round  20, Global train loss: 0.241, Global test loss: 1.083, Global test accuracy: 69.28 

Round  21, Train loss: 0.218, Test loss: 0.829, Test accuracy: 77.88 

Round  21, Global train loss: 0.218, Global test loss: 1.188, Global test accuracy: 67.80 

Round  22, Train loss: 0.218, Test loss: 0.933, Test accuracy: 76.88 

Round  22, Global train loss: 0.218, Global test loss: 1.166, Global test accuracy: 68.24 

Round  23, Train loss: 0.196, Test loss: 0.814, Test accuracy: 78.72 

Round  23, Global train loss: 0.196, Global test loss: 1.112, Global test accuracy: 69.92 

Round  24, Train loss: 0.191, Test loss: 0.964, Test accuracy: 77.68 

Round  24, Global train loss: 0.191, Global test loss: 1.164, Global test accuracy: 68.60 

Round  25, Train loss: 0.166, Test loss: 0.945, Test accuracy: 76.44 

Round  25, Global train loss: 0.166, Global test loss: 1.175, Global test accuracy: 68.72 

Round  26, Train loss: 0.159, Test loss: 0.886, Test accuracy: 79.84 

Round  26, Global train loss: 0.159, Global test loss: 1.127, Global test accuracy: 69.68 

Round  27, Train loss: 0.148, Test loss: 0.839, Test accuracy: 78.88 

Round  27, Global train loss: 0.148, Global test loss: 1.123, Global test accuracy: 70.24 

Round  28, Train loss: 0.132, Test loss: 0.817, Test accuracy: 79.72 

Round  28, Global train loss: 0.132, Global test loss: 1.125, Global test accuracy: 69.64 

Round  29, Train loss: 0.124, Test loss: 0.809, Test accuracy: 80.04 

Round  29, Global train loss: 0.124, Global test loss: 1.113, Global test accuracy: 70.04 

Round  30, Train loss: 0.124, Test loss: 0.890, Test accuracy: 79.36 

Round  30, Global train loss: 0.124, Global test loss: 1.093, Global test accuracy: 70.92 

Round  31, Train loss: 0.095, Test loss: 0.891, Test accuracy: 78.92 

Round  31, Global train loss: 0.095, Global test loss: 1.070, Global test accuracy: 71.52 

Round  32, Train loss: 0.100, Test loss: 0.852, Test accuracy: 81.00 

Round  32, Global train loss: 0.100, Global test loss: 1.093, Global test accuracy: 71.56 

Round  33, Train loss: 0.104, Test loss: 0.883, Test accuracy: 79.64 

Round  33, Global train loss: 0.104, Global test loss: 1.083, Global test accuracy: 71.32 

Round  34, Train loss: 0.109, Test loss: 0.830, Test accuracy: 80.20 

Round  34, Global train loss: 0.109, Global test loss: 1.093, Global test accuracy: 72.32 

Round  35, Train loss: 0.075, Test loss: 0.829, Test accuracy: 80.88 

Round  35, Global train loss: 0.075, Global test loss: 1.143, Global test accuracy: 71.44 

Round  36, Train loss: 0.093, Test loss: 0.942, Test accuracy: 78.28 

Round  36, Global train loss: 0.093, Global test loss: 1.087, Global test accuracy: 71.52 

Round  37, Train loss: 0.103, Test loss: 0.958, Test accuracy: 78.60 

Round  37, Global train loss: 0.103, Global test loss: 1.123, Global test accuracy: 71.16 

Round  38, Train loss: 0.069, Test loss: 0.864, Test accuracy: 80.92 

Round  38, Global train loss: 0.069, Global test loss: 1.112, Global test accuracy: 71.68 

Round  39, Train loss: 0.047, Test loss: 0.787, Test accuracy: 81.72 

Round  39, Global train loss: 0.047, Global test loss: 1.077, Global test accuracy: 72.12 

Round  40, Train loss: 0.059, Test loss: 1.059, Test accuracy: 78.00 

Round  40, Global train loss: 0.059, Global test loss: 1.139, Global test accuracy: 72.08 

Round  41, Train loss: 0.066, Test loss: 0.911, Test accuracy: 79.72 

Round  41, Global train loss: 0.066, Global test loss: 1.116, Global test accuracy: 72.20 

Round  42, Train loss: 0.070, Test loss: 0.965, Test accuracy: 78.76 

Round  42, Global train loss: 0.070, Global test loss: 1.107, Global test accuracy: 72.28 

Round  43, Train loss: 0.063, Test loss: 0.893, Test accuracy: 80.48 

Round  43, Global train loss: 0.063, Global test loss: 1.068, Global test accuracy: 72.16 

Round  44, Train loss: 0.042, Test loss: 0.826, Test accuracy: 80.84 

Round  44, Global train loss: 0.042, Global test loss: 1.052, Global test accuracy: 72.76 

Round  45, Train loss: 0.069, Test loss: 1.269, Test accuracy: 76.24 

Round  45, Global train loss: 0.069, Global test loss: 1.108, Global test accuracy: 72.44 

Round  46, Train loss: 0.058, Test loss: 0.833, Test accuracy: 82.16 

Round  46, Global train loss: 0.058, Global test loss: 1.090, Global test accuracy: 72.20 

Round  47, Train loss: 0.042, Test loss: 0.967, Test accuracy: 79.28 

Round  47, Global train loss: 0.042, Global test loss: 1.048, Global test accuracy: 72.32 

Round  48, Train loss: 0.043, Test loss: 0.901, Test accuracy: 80.32 

Round  48, Global train loss: 0.043, Global test loss: 1.093, Global test accuracy: 72.36 

Round  49, Train loss: 0.046, Test loss: 0.996, Test accuracy: 77.92 

Round  49, Global train loss: 0.046, Global test loss: 1.088, Global test accuracy: 72.40 

Final Round, Train loss: 0.069, Test loss: 1.047, Test accuracy: 78.00 

Final Round, Global train loss: 0.069, Global test loss: 1.088, Global test accuracy: 72.40 

Average accuracy final 10 rounds: 79.372 

Average global accuracy final 10 rounds: 72.32 

1609.8526146411896
[7.551425218582153, 13.181427240371704, 19.10598921775818, 24.925349950790405, 30.456671714782715, 36.328248739242554, 41.834667682647705, 47.40505361557007, 52.99215745925903, 58.59641695022583, 64.32287669181824, 69.92387533187866, 75.60364890098572, 81.28835344314575, 86.92724704742432, 92.8508996963501, 98.45126628875732, 104.02126550674438, 109.69671273231506, 115.14170503616333, 120.89956641197205, 126.53317189216614, 132.33432626724243, 138.14217472076416, 144.21904349327087, 149.94889569282532, 155.5447599887848, 161.03365445137024, 166.75621700286865, 172.32197833061218, 177.88699197769165, 183.47440814971924, 188.98982524871826, 194.59377527236938, 200.050683259964, 205.9002697467804, 211.62490892410278, 217.02519607543945, 222.6466522216797, 228.3902337551117, 233.932941198349, 239.68456888198853, 245.12179350852966, 250.9390571117401, 256.72563123703003, 262.4128534793854, 268.09016251564026, 273.87599325180054, 279.55605030059814, 285.4942374229431, 296.84706139564514]
[51.68, 58.2, 58.44, 59.2, 64.56, 66.64, 65.24, 69.2, 68.88, 73.08, 69.76, 73.28, 73.6, 74.96, 73.24, 76.92, 76.52, 74.36, 76.64, 75.04, 77.2, 77.88, 76.88, 78.72, 77.68, 76.44, 79.84, 78.88, 79.72, 80.04, 79.36, 78.92, 81.0, 79.64, 80.2, 80.88, 78.28, 78.6, 80.92, 81.72, 78.0, 79.72, 78.76, 80.48, 80.84, 76.24, 82.16, 79.28, 80.32, 77.92, 78.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.513, Test loss: 1.758, Test accuracy: 27.64 

Round   1, Train loss: 1.260, Test loss: 1.326, Test accuracy: 46.16 

Round   2, Train loss: 1.133, Test loss: 1.288, Test accuracy: 49.44 

Round   3, Train loss: 0.998, Test loss: 1.026, Test accuracy: 59.12 

Round   4, Train loss: 0.922, Test loss: 0.960, Test accuracy: 61.40 

Round   5, Train loss: 0.864, Test loss: 0.927, Test accuracy: 62.00 

Round   6, Train loss: 0.791, Test loss: 0.871, Test accuracy: 66.00 

Round   7, Train loss: 0.756, Test loss: 0.946, Test accuracy: 65.04 

Round   8, Train loss: 0.697, Test loss: 0.791, Test accuracy: 69.32 

Round   9, Train loss: 0.648, Test loss: 0.779, Test accuracy: 69.32 

Round  10, Train loss: 0.604, Test loss: 0.675, Test accuracy: 74.04 

Round  11, Train loss: 0.551, Test loss: 0.667, Test accuracy: 74.80 

Round  12, Train loss: 0.537, Test loss: 0.664, Test accuracy: 75.48 

Round  13, Train loss: 0.506, Test loss: 0.685, Test accuracy: 74.52 

Round  14, Train loss: 0.468, Test loss: 0.655, Test accuracy: 76.40 

Round  15, Train loss: 0.433, Test loss: 0.610, Test accuracy: 77.68 

Round  16, Train loss: 0.418, Test loss: 0.676, Test accuracy: 76.20 

Round  17, Train loss: 0.374, Test loss: 0.594, Test accuracy: 78.60 

Round  18, Train loss: 0.357, Test loss: 0.598, Test accuracy: 78.44 

Round  19, Train loss: 0.337, Test loss: 0.592, Test accuracy: 79.32 

Round  20, Train loss: 0.326, Test loss: 0.618, Test accuracy: 77.92 

Round  21, Train loss: 0.301, Test loss: 0.575, Test accuracy: 80.16 

Round  22, Train loss: 0.280, Test loss: 0.564, Test accuracy: 80.36 

Round  23, Train loss: 0.261, Test loss: 0.589, Test accuracy: 79.80 

Round  24, Train loss: 0.263, Test loss: 0.576, Test accuracy: 80.44 

Round  25, Train loss: 0.233, Test loss: 0.641, Test accuracy: 79.88 

Round  26, Train loss: 0.219, Test loss: 0.544, Test accuracy: 81.28 

Round  27, Train loss: 0.217, Test loss: 0.551, Test accuracy: 81.68 

Round  28, Train loss: 0.177, Test loss: 0.570, Test accuracy: 81.80 

Round  29, Train loss: 0.179, Test loss: 0.573, Test accuracy: 81.72 

Round  30, Train loss: 0.183, Test loss: 0.581, Test accuracy: 82.36 

Round  31, Train loss: 0.167, Test loss: 0.556, Test accuracy: 82.00 

Round  32, Train loss: 0.163, Test loss: 0.563, Test accuracy: 82.12 

Round  33, Train loss: 0.129, Test loss: 0.572, Test accuracy: 82.60 

Round  34, Train loss: 0.141, Test loss: 0.590, Test accuracy: 81.40 

Round  35, Train loss: 0.122, Test loss: 0.582, Test accuracy: 82.52 

Round  36, Train loss: 0.121, Test loss: 0.587, Test accuracy: 82.36 

Round  37, Train loss: 0.126, Test loss: 0.609, Test accuracy: 82.00 

Round  38, Train loss: 0.107, Test loss: 0.593, Test accuracy: 82.36 

Round  39, Train loss: 0.107, Test loss: 0.567, Test accuracy: 83.08 

Round  40, Train loss: 0.092, Test loss: 0.567, Test accuracy: 83.72 

Round  41, Train loss: 0.087, Test loss: 0.592, Test accuracy: 82.92 

Round  42, Train loss: 0.095, Test loss: 0.599, Test accuracy: 82.16 

Round  43, Train loss: 0.082, Test loss: 0.564, Test accuracy: 83.40 

Round  44, Train loss: 0.066, Test loss: 0.567, Test accuracy: 83.68 

Round  45, Train loss: 0.062, Test loss: 0.588, Test accuracy: 83.44 

Round  46, Train loss: 0.068, Test loss: 0.598, Test accuracy: 83.68 

Round  47, Train loss: 0.064, Test loss: 0.610, Test accuracy: 83.08 

Round  48, Train loss: 0.060, Test loss: 0.608, Test accuracy: 84.12 

Round  49, Train loss: 0.051, Test loss: 0.586, Test accuracy: 83.20 

Final Round, Train loss: 0.032, Test loss: 0.587, Test accuracy: 83.44 

Average accuracy final 10 rounds: 83.34 

1170.529054403305
[6.231118202209473, 10.555653810501099, 14.871262550354004, 19.27691340446472, 23.81272864341736, 28.150715351104736, 32.347328424453735, 36.68962788581848, 41.019387006759644, 45.35211253166199, 49.559407234191895, 54.06121802330017, 58.45677089691162, 62.88687300682068, 67.40346479415894, 71.84538888931274, 76.12642216682434, 80.67796063423157, 85.1152982711792, 89.45648002624512, 93.73015451431274, 98.0855119228363, 102.32073879241943, 106.66556453704834, 111.08914089202881, 115.4177474975586, 120.00892233848572, 124.34703135490417, 128.6254072189331, 132.91365599632263, 137.3091380596161, 141.67047381401062, 146.0920226573944, 150.46849822998047, 154.8773021697998, 159.2676031589508, 163.52150082588196, 168.2082314491272, 172.85234570503235, 177.16607975959778, 181.5444781780243, 185.94884729385376, 190.30642318725586, 194.62171459197998, 199.00015139579773, 203.41078400611877, 207.8758602142334, 212.45114731788635, 216.95128059387207, 221.40491008758545, 225.7024552822113]
[27.64, 46.16, 49.44, 59.12, 61.4, 62.0, 66.0, 65.04, 69.32, 69.32, 74.04, 74.8, 75.48, 74.52, 76.4, 77.68, 76.2, 78.6, 78.44, 79.32, 77.92, 80.16, 80.36, 79.8, 80.44, 79.88, 81.28, 81.68, 81.8, 81.72, 82.36, 82.0, 82.12, 82.6, 81.4, 82.52, 82.36, 82.0, 82.36, 83.08, 83.72, 82.92, 82.16, 83.4, 83.68, 83.44, 83.68, 83.08, 84.12, 83.2, 83.44]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.522, Test loss: 1.796, Test accuracy: 24.64
Round   1, Train loss: 1.268, Test loss: 1.481, Test accuracy: 42.48
Round   2, Train loss: 1.134, Test loss: 1.203, Test accuracy: 53.76
Round   3, Train loss: 1.018, Test loss: 0.993, Test accuracy: 59.16
Round   4, Train loss: 0.933, Test loss: 1.017, Test accuracy: 58.76
Round   5, Train loss: 0.867, Test loss: 0.862, Test accuracy: 66.64
Round   6, Train loss: 0.805, Test loss: 0.846, Test accuracy: 66.88
Round   7, Train loss: 0.747, Test loss: 0.774, Test accuracy: 70.04
Round   8, Train loss: 0.714, Test loss: 0.814, Test accuracy: 69.24
Round   9, Train loss: 0.672, Test loss: 0.731, Test accuracy: 71.80
Round  10, Train loss: 0.623, Test loss: 0.739, Test accuracy: 71.68
Round  11, Train loss: 0.585, Test loss: 0.743, Test accuracy: 71.88
Round  12, Train loss: 0.551, Test loss: 0.673, Test accuracy: 74.40
Round  13, Train loss: 0.514, Test loss: 0.637, Test accuracy: 75.04
Round  14, Train loss: 0.494, Test loss: 0.654, Test accuracy: 76.04
Round  15, Train loss: 0.462, Test loss: 0.609, Test accuracy: 77.92
Round  16, Train loss: 0.431, Test loss: 0.625, Test accuracy: 76.72
Round  17, Train loss: 0.408, Test loss: 0.581, Test accuracy: 78.24
Round  18, Train loss: 0.374, Test loss: 0.573, Test accuracy: 79.72
Round  19, Train loss: 0.345, Test loss: 0.572, Test accuracy: 79.40
Round  20, Train loss: 0.334, Test loss: 0.564, Test accuracy: 80.04
Round  21, Train loss: 0.313, Test loss: 0.551, Test accuracy: 80.92
Round  22, Train loss: 0.297, Test loss: 0.553, Test accuracy: 80.44
Round  23, Train loss: 0.284, Test loss: 0.539, Test accuracy: 81.52
Round  24, Train loss: 0.275, Test loss: 0.549, Test accuracy: 80.96
Round  25, Train loss: 0.238, Test loss: 0.521, Test accuracy: 82.12
Round  26, Train loss: 0.225, Test loss: 0.538, Test accuracy: 81.52
Round  27, Train loss: 0.228, Test loss: 0.563, Test accuracy: 81.40
Round  28, Train loss: 0.216, Test loss: 0.533, Test accuracy: 81.36
Round  29, Train loss: 0.196, Test loss: 0.536, Test accuracy: 82.20
Round  30, Train loss: 0.181, Test loss: 0.549, Test accuracy: 81.92
Round  31, Train loss: 0.172, Test loss: 0.540, Test accuracy: 82.16
Round  32, Train loss: 0.166, Test loss: 0.529, Test accuracy: 82.68
Round  33, Train loss: 0.163, Test loss: 0.538, Test accuracy: 82.00
Round  34, Train loss: 0.148, Test loss: 0.537, Test accuracy: 82.40
Round  35, Train loss: 0.141, Test loss: 0.551, Test accuracy: 82.52
Round  36, Train loss: 0.123, Test loss: 0.532, Test accuracy: 82.48
Round  37, Train loss: 0.111, Test loss: 0.544, Test accuracy: 84.08
Round  38, Train loss: 0.118, Test loss: 0.551, Test accuracy: 82.48
Round  39, Train loss: 0.120, Test loss: 0.532, Test accuracy: 83.16
Round  40, Train loss: 0.097, Test loss: 0.524, Test accuracy: 83.20
Round  41, Train loss: 0.082, Test loss: 0.550, Test accuracy: 83.56
Round  42, Train loss: 0.094, Test loss: 0.545, Test accuracy: 83.44
Round  43, Train loss: 0.089, Test loss: 0.552, Test accuracy: 82.60
Round  44, Train loss: 0.077, Test loss: 0.550, Test accuracy: 83.88
Round  45, Train loss: 0.073, Test loss: 0.561, Test accuracy: 83.20
Round  46, Train loss: 0.063, Test loss: 0.552, Test accuracy: 83.96
Round  47, Train loss: 0.074, Test loss: 0.533, Test accuracy: 83.88
Round  48, Train loss: 0.063, Test loss: 0.559, Test accuracy: 83.16
Round  49, Train loss: 0.064, Test loss: 0.570, Test accuracy: 83.64
Final Round, Train loss: 0.032, Test loss: 0.556, Test accuracy: 84.16
Average accuracy final 10 rounds: 83.45200000000001
1363.3317332267761
[6.817451477050781, 11.770672798156738, 16.78801941871643, 21.766749382019043, 26.89221167564392, 32.28998637199402, 37.60732054710388, 42.65948247909546, 47.734907388687134, 52.86677265167236, 58.17180871963501, 63.46182894706726, 68.6420841217041, 74.00319600105286, 79.27879738807678, 84.586421251297, 89.70266556739807, 94.91138482093811, 100.00231790542603, 105.18579125404358, 110.48633766174316, 115.64854264259338, 120.7786316871643, 125.81706166267395, 130.7595672607422, 135.93531203269958, 141.20929169654846, 146.21441626548767, 151.4758222103119, 156.54095029830933, 161.80081057548523, 166.76829361915588, 171.81637573242188, 176.83584117889404, 182.0140142440796, 187.04229617118835, 192.22083163261414, 197.6379656791687, 202.62734603881836, 207.89343643188477, 212.98688960075378, 218.50240898132324, 223.84354424476624, 229.17626762390137, 234.25470638275146, 239.20338678359985, 244.5038878917694, 249.78320455551147, 254.9154291152954, 260.1682550907135, 265.2348372936249]
[24.64, 42.48, 53.76, 59.16, 58.76, 66.64, 66.88, 70.04, 69.24, 71.8, 71.68, 71.88, 74.4, 75.04, 76.04, 77.92, 76.72, 78.24, 79.72, 79.4, 80.04, 80.92, 80.44, 81.52, 80.96, 82.12, 81.52, 81.4, 81.36, 82.2, 81.92, 82.16, 82.68, 82.0, 82.4, 82.52, 82.48, 84.08, 82.48, 83.16, 83.2, 83.56, 83.44, 82.6, 83.88, 83.2, 83.96, 83.88, 83.16, 83.64, 84.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.517, Train accuracy: 81.400, Test loss: 1.230, Test accuracy: 60.40 

        train local model (freeze embeding):client   0,  Train loss: 0.331, Train accuracy: 88.800, Test loss: 1.111, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.228, Train accuracy: 91.800, Test loss: 1.113, Test accuracy: 67.40 

Round   0, Train loss: 0.228, Test loss: 1.113, Test accuracy: 67.40 

        train local model (freeze embeding):client   0,  Train loss: 0.153, Train accuracy: 94.600, Test loss: 1.045, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.338, Train accuracy: 87.400, Test loss: 1.512, Test accuracy: 62.60 

Round   1, Train loss: 0.338, Test loss: 1.512, Test accuracy: 62.60 

        train local model (freeze embeding):client   0,  Train loss: 0.119, Train accuracy: 96.400, Test loss: 1.133, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.055, Train accuracy: 98.000, Test loss: 1.258, Test accuracy: 71.80 

Round   2, Train loss: 0.055, Test loss: 1.258, Test accuracy: 71.80 

        train local model (freeze embeding):client   0,  Train loss: 0.055, Train accuracy: 98.200, Test loss: 1.239, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.061, Train accuracy: 98.600, Test loss: 1.222, Test accuracy: 72.60 

Round   3, Train loss: 0.061, Test loss: 1.222, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.200, Test loss: 1.179, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.600, Test loss: 1.308, Test accuracy: 71.20 

Round   4, Train loss: 0.026, Test loss: 1.308, Test accuracy: 71.20 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.294, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 1.445, Test accuracy: 72.60 

Round   5, Train loss: 0.037, Test loss: 1.445, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.200, Test loss: 1.349, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.438, Test accuracy: 70.20 

Round   6, Train loss: 0.009, Test loss: 1.438, Test accuracy: 70.20 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.432, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.512, Test accuracy: 71.60 

Round   7, Train loss: 0.012, Test loss: 1.512, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.480, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.025, Train accuracy: 98.600, Test loss: 1.573, Test accuracy: 69.20 

Round   8, Train loss: 0.025, Test loss: 1.573, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.331, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.552, Test accuracy: 71.00 

Round   9, Train loss: 0.009, Test loss: 1.552, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.491, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 98.600, Test loss: 1.783, Test accuracy: 69.00 

Round  10, Train loss: 0.031, Test loss: 1.783, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.440, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.623, Test accuracy: 73.00 

Round  11, Train loss: 0.002, Test loss: 1.623, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.578, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.600, Test loss: 1.779, Test accuracy: 71.20 

Round  12, Train loss: 0.030, Test loss: 1.779, Test accuracy: 71.20 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.691, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.466, Test accuracy: 72.80 

Round  13, Train loss: 0.001, Test loss: 1.466, Test accuracy: 72.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.497, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.429, Test accuracy: 74.60 

Round  14, Train loss: 0.000, Test loss: 1.429, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.414, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.426, Test accuracy: 76.00 

Round  15, Train loss: 0.001, Test loss: 1.426, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.446, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.404, Test accuracy: 76.40 

Round  16, Train loss: 0.001, Test loss: 1.404, Test accuracy: 76.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.426, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.306, Test accuracy: 78.00 

Round  17, Train loss: 0.000, Test loss: 1.306, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.310, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.621, Test accuracy: 72.00 

Round  18, Train loss: 0.017, Test loss: 1.621, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.529, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.375, Test accuracy: 76.40 

Round  19, Train loss: 0.001, Test loss: 1.375, Test accuracy: 76.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.419, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.365, Test accuracy: 76.40 

Final Round, Train loss: 0.000, Test loss: 1.373, Test accuracy: 75.80 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.746, Train accuracy: 70.000, Test loss: 0.965, Test accuracy: 58.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.365, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.494, Test accuracy: 76.40 

        train local model (freeze embeding):client   1,  Train loss: 0.790, Train accuracy: 66.000, Test loss: 1.014, Test accuracy: 58.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.278, Train accuracy: 89.400, Test loss: 1.025, Test accuracy: 65.00 

Round   0, Train loss: 0.139, Test loss: 1.110, Test accuracy: 69.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.328, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.377, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.428, Train accuracy: 83.400, Test loss: 1.165, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.360, Train accuracy: 89.200, Test loss: 1.416, Test accuracy: 63.40 

Round   1, Train loss: 0.180, Test loss: 1.241, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.401, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.738, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.174, Train accuracy: 93.400, Test loss: 0.988, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.170, Train accuracy: 94.200, Test loss: 1.407, Test accuracy: 64.00 

Round   2, Train loss: 0.090, Test loss: 1.255, Test accuracy: 70.20 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.380, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.530, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.103, Train accuracy: 97.200, Test loss: 1.084, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.068, Train accuracy: 97.600, Test loss: 1.403, Test accuracy: 62.40 

Round   3, Train loss: 0.041, Test loss: 1.177, Test accuracy: 70.80 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.291, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.343, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.047, Train accuracy: 99.200, Test loss: 1.167, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.050, Train accuracy: 99.000, Test loss: 1.431, Test accuracy: 66.20 

Round   4, Train loss: 0.025, Test loss: 1.249, Test accuracy: 70.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.351, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 74.80 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.800, Test loss: 1.230, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.111, Train accuracy: 96.000, Test loss: 1.572, Test accuracy: 68.00 

Round   5, Train loss: 0.057, Test loss: 1.305, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.353, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.549, Test accuracy: 72.40 

        train local model (freeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.400, Test loss: 1.269, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 1.644, Test accuracy: 66.00 

Round   6, Train loss: 0.013, Test loss: 1.370, Test accuracy: 71.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.337, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.451, Test accuracy: 75.40 

        train local model (freeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.499, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.063, Train accuracy: 97.800, Test loss: 1.824, Test accuracy: 64.60 

Round   7, Train loss: 0.034, Test loss: 1.354, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.323, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.599, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.382, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.600, Test accuracy: 67.00 

Round   8, Train loss: 0.015, Test loss: 1.385, Test accuracy: 70.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.489, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.442, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.425, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 98.800, Test loss: 1.628, Test accuracy: 68.00 

Round   9, Train loss: 0.016, Test loss: 1.404, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.430, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 1.598, Test accuracy: 73.80 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.436, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 1.696, Test accuracy: 67.60 

Round  10, Train loss: 0.026, Test loss: 1.391, Test accuracy: 71.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.714, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.431, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.955, Test accuracy: 66.80 

Round  11, Train loss: 0.010, Test loss: 1.488, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.429, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.580, Test accuracy: 76.20 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 1.739, Test accuracy: 67.20 

Round  12, Train loss: 0.011, Test loss: 1.422, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.487, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.471, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.648, Test accuracy: 69.60 

Round  13, Train loss: 0.000, Test loss: 1.436, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.407, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.373, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.576, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 98.600, Test loss: 1.608, Test accuracy: 71.20 

Round  14, Train loss: 0.014, Test loss: 1.473, Test accuracy: 73.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.359, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.393, Test accuracy: 76.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.510, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.530, Test accuracy: 69.20 

Round  15, Train loss: 0.001, Test loss: 1.423, Test accuracy: 72.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.397, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.496, Test accuracy: 75.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.476, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.714, Test accuracy: 68.40 

Round  16, Train loss: 0.001, Test loss: 1.498, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.406, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.450, Test accuracy: 75.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.575, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.701, Test accuracy: 66.40 

Round  17, Train loss: 0.006, Test loss: 1.519, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.469, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.413, Test accuracy: 76.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.660, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.000, Test loss: 1.760, Test accuracy: 66.00 

Round  18, Train loss: 0.008, Test loss: 1.520, Test accuracy: 71.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.415, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.358, Test accuracy: 75.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.686, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.645, Test accuracy: 68.20 

Round  19, Train loss: 0.000, Test loss: 1.452, Test accuracy: 72.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.339, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.364, Test accuracy: 75.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.581, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.562, Test accuracy: 69.40 

Final Round, Train loss: 0.000, Test loss: 1.449, Test accuracy: 72.50 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.680, Train accuracy: 75.000, Test loss: 0.730, Test accuracy: 75.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.379, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.403, Test accuracy: 76.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.608, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.787, Test accuracy: 70.00 

        train local model (freeze embeding):client   2,  Train loss: 0.570, Train accuracy: 79.400, Test loss: 0.548, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.123, Train accuracy: 96.200, Test loss: 0.645, Test accuracy: 81.80 

Round   0, Train loss: 0.043, Test loss: 1.088, Test accuracy: 76.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.314, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.363, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.467, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.606, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.295, Train accuracy: 89.200, Test loss: 0.587, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.143, Train accuracy: 96.000, Test loss: 0.855, Test accuracy: 76.00 

Round   1, Train loss: 0.048, Test loss: 1.113, Test accuracy: 77.07 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.309, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.319, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.508, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.125, Train accuracy: 96.200, Test loss: 0.568, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 0.996, Test accuracy: 78.20 

Round   2, Train loss: 0.011, Test loss: 1.070, Test accuracy: 77.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.283, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 77.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.439, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.646, Test accuracy: 67.80 

        train local model (freeze embeding):client   2,  Train loss: 0.056, Train accuracy: 98.200, Test loss: 0.633, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.076, Train accuracy: 97.600, Test loss: 0.831, Test accuracy: 81.20 

Round   3, Train loss: 0.029, Test loss: 1.041, Test accuracy: 77.87 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.283, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.331, Test accuracy: 76.20 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.421, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.793, Test accuracy: 68.00 

        train local model (freeze embeding):client   2,  Train loss: 0.039, Train accuracy: 99.000, Test loss: 0.628, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.051, Train accuracy: 98.800, Test loss: 0.935, Test accuracy: 79.60 

Round   4, Train loss: 0.021, Test loss: 1.118, Test accuracy: 77.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.140, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.283, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.386, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.653, Test accuracy: 72.00 

        train local model (freeze embeding):client   2,  Train loss: 0.039, Train accuracy: 99.200, Test loss: 0.658, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.771, Test accuracy: 83.00 

Round   5, Train loss: 0.006, Test loss: 1.068, Test accuracy: 78.73 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.239, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.391, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.335, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 98.800, Test loss: 1.787, Test accuracy: 68.40 

        train local model (freeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.800, Test loss: 0.660, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 0.880, Test accuracy: 81.00 

Round   6, Train loss: 0.014, Test loss: 1.018, Test accuracy: 77.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.140, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.363, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.287, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.044, Train accuracy: 98.200, Test loss: 1.695, Test accuracy: 70.60 

        train local model (freeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.800, Test loss: 0.652, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 81.00 

Round   7, Train loss: 0.017, Test loss: 1.038, Test accuracy: 78.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.181, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.344, Test accuracy: 76.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.356, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.060, Train accuracy: 98.400, Test loss: 1.807, Test accuracy: 69.00 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.682, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 0.972, Test accuracy: 81.40 

Round   8, Train loss: 0.023, Test loss: 1.118, Test accuracy: 78.47 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.238, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.416, Test accuracy: 74.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.438, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.591, Test accuracy: 70.60 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.697, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.766, Test accuracy: 81.80 

Round   9, Train loss: 0.005, Test loss: 1.046, Test accuracy: 78.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.154, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.286, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.347, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.508, Test accuracy: 71.80 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 0.671, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.024, Test accuracy: 80.20 

Round  10, Train loss: 0.005, Test loss: 1.077, Test accuracy: 78.73 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.194, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.299, Test accuracy: 77.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.341, Test accuracy: 72.60 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.731, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.048, Test accuracy: 80.60 

Round  11, Train loss: 0.001, Test loss: 1.077, Test accuracy: 78.27 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.229, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.533, Test accuracy: 74.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.312, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.419, Test accuracy: 73.60 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.879, Test accuracy: 82.60 

Round  12, Train loss: 0.003, Test loss: 1.089, Test accuracy: 78.07 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.252, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.271, Test accuracy: 77.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.564, Test accuracy: 67.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.748, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 81.00 

Round  13, Train loss: 0.002, Test loss: 1.085, Test accuracy: 78.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.173, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.424, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.338, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 74.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.765, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.863, Test accuracy: 83.20 

Round  14, Train loss: 0.001, Test loss: 1.089, Test accuracy: 78.07 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.222, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.284, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.312, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.200, Train accuracy: 94.800, Test loss: 2.764, Test accuracy: 66.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.775, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.029, Test accuracy: 79.20 

Round  15, Train loss: 0.074, Test loss: 1.155, Test accuracy: 77.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.194, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.329, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.348, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.823, Test accuracy: 68.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.776, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.898, Test accuracy: 82.00 

Round  16, Train loss: 0.010, Test loss: 1.071, Test accuracy: 78.47 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.261, Test accuracy: 76.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.322, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.420, Test accuracy: 72.60 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.711, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.815, Test accuracy: 84.40 

Round  17, Train loss: 0.001, Test loss: 1.069, Test accuracy: 79.07 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.205, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.397, Test accuracy: 76.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.321, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.524, Test accuracy: 72.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.684, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 82.80 

Round  18, Train loss: 0.000, Test loss: 1.067, Test accuracy: 79.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.212, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.339, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.528, Test accuracy: 69.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.899, Test accuracy: 83.40 

Round  19, Train loss: 0.001, Test loss: 1.102, Test accuracy: 78.73 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.204, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.188, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.345, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.358, Test accuracy: 74.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.775, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.807, Test accuracy: 84.40 

Final Round, Train loss: 0.000, Test loss: 1.087, Test accuracy: 79.20 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.493, Train accuracy: 82.000, Test loss: 0.532, Test accuracy: 79.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.209, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.257, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.378, Test accuracy: 73.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.769, Test accuracy: 86.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.859, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.548, Train accuracy: 79.000, Test loss: 0.608, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.067, Train accuracy: 98.800, Test loss: 0.771, Test accuracy: 78.00 

Round   0, Train loss: 0.017, Test loss: 0.916, Test accuracy: 79.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.101, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.243, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.277, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.435, Test accuracy: 72.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.757, Test accuracy: 85.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.819, Test accuracy: 83.80 

        train local model (freeze embeding):client   3,  Train loss: 0.292, Train accuracy: 89.200, Test loss: 0.591, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.048, Train accuracy: 98.200, Test loss: 0.757, Test accuracy: 79.00 

Round   1, Train loss: 0.012, Test loss: 0.907, Test accuracy: 81.15 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.276, Test accuracy: 76.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.277, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.422, Test accuracy: 73.20 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.773, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.850, Test accuracy: 82.40 

        train local model (freeze embeding):client   3,  Train loss: 0.134, Train accuracy: 96.000, Test loss: 0.552, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.105, Train accuracy: 95.800, Test loss: 1.004, Test accuracy: 73.20 

Round   2, Train loss: 0.027, Test loss: 0.868, Test accuracy: 80.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.702, Test accuracy: 69.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.685, Test accuracy: 86.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.019, Test accuracy: 79.40 

        train local model (freeze embeding):client   3,  Train loss: 0.125, Train accuracy: 95.200, Test loss: 0.625, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.052, Train accuracy: 98.200, Test loss: 0.945, Test accuracy: 78.00 

Round   3, Train loss: 0.026, Test loss: 0.875, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.225, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.253, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.387, Test accuracy: 71.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.677, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 0.880, Test accuracy: 84.40 

        train local model (freeze embeding):client   3,  Train loss: 0.093, Train accuracy: 96.600, Test loss: 0.646, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.075, Train accuracy: 96.600, Test loss: 0.959, Test accuracy: 77.00 

Round   4, Train loss: 0.022, Test loss: 0.869, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.260, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.246, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.600, Test accuracy: 72.20 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 0.676, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 84.40 

        train local model (freeze embeding):client   3,  Train loss: 0.036, Train accuracy: 99.400, Test loss: 0.643, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.062, Train accuracy: 98.000, Test loss: 0.813, Test accuracy: 80.80 

Round   5, Train loss: 0.017, Test loss: 0.885, Test accuracy: 80.85 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.448, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.272, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.347, Test accuracy: 73.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.692, Test accuracy: 86.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.802, Test accuracy: 83.80 

        train local model (freeze embeding):client   3,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 0.631, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 0.958, Test accuracy: 77.40 

Round   6, Train loss: 0.007, Test loss: 0.925, Test accuracy: 80.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.046, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.233, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.234, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.496, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.671, Test accuracy: 87.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.074, Train accuracy: 98.200, Test loss: 1.268, Test accuracy: 78.40 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.725, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 0.860, Test accuracy: 81.20 

Round   7, Train loss: 0.024, Test loss: 0.911, Test accuracy: 80.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.108, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.200, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.420, Test accuracy: 73.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.701, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.817, Test accuracy: 83.80 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 0.756, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 0.870, Test accuracy: 80.20 

Round   8, Train loss: 0.003, Test loss: 0.900, Test accuracy: 81.05 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.200, Test loss: 1.688, Test accuracy: 75.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.229, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.402, Test accuracy: 72.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.802, Test accuracy: 83.80 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 0.984, Test accuracy: 79.20 

Round   9, Train loss: 0.007, Test loss: 0.938, Test accuracy: 80.35 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.221, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.261, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.200, Test loss: 1.467, Test accuracy: 73.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.683, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.028, Test accuracy: 80.60 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 0.776, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 0.865, Test accuracy: 78.00 

Round  10, Train loss: 0.012, Test loss: 0.882, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.003, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.187, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.324, Test accuracy: 73.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.680, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.750, Test accuracy: 86.00 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.735, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.818, Test accuracy: 81.60 

Round  11, Train loss: 0.002, Test loss: 0.876, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.189, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.132, Train accuracy: 96.400, Test loss: 1.677, Test accuracy: 70.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.675, Test accuracy: 87.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 0.847, Test accuracy: 84.60 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.730, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.871, Test accuracy: 82.20 

Round  12, Train loss: 0.036, Test loss: 0.921, Test accuracy: 81.15 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.523, Test accuracy: 74.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.675, Test accuracy: 87.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 0.928, Test accuracy: 79.80 

Round  13, Train loss: 0.004, Test loss: 0.890, Test accuracy: 81.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.986, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.104, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.497, Test accuracy: 72.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.650, Test accuracy: 87.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.710, Test accuracy: 86.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.772, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.032, Train accuracy: 99.200, Test loss: 1.176, Test accuracy: 76.60 

Round  14, Train loss: 0.009, Test loss: 0.909, Test accuracy: 80.65 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.252, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.308, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.343, Test accuracy: 75.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.665, Test accuracy: 86.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.709, Test accuracy: 87.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.741, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.914, Test accuracy: 81.40 

Round  15, Train loss: 0.001, Test loss: 0.920, Test accuracy: 81.85 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.287, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.415, Test accuracy: 72.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.683, Test accuracy: 88.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.836, Test accuracy: 84.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.769, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.891, Test accuracy: 81.60 

Round  16, Train loss: 0.001, Test loss: 0.930, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.992, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.205, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.284, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.381, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.663, Test accuracy: 87.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.693, Test accuracy: 87.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.770, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 81.80 

Round  17, Train loss: 0.000, Test loss: 0.922, Test accuracy: 81.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.161, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.370, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.672, Test accuracy: 87.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 84.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.793, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 81.00 

Round  18, Train loss: 0.001, Test loss: 0.938, Test accuracy: 81.65 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.067, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.273, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.356, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.684, Test accuracy: 87.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.821, Test accuracy: 84.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.784, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 80.40 

Round  19, Train loss: 0.001, Test loss: 0.906, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.985, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.241, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.256, Test accuracy: 74.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.665, Test accuracy: 87.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.668, Test accuracy: 86.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.809, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.812, Test accuracy: 82.40 

Final Round, Train loss: 0.000, Test loss: 0.913, Test accuracy: 81.55 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.498, Train accuracy: 76.800, Test loss: 0.695, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.989, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.032, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.252, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.425, Test accuracy: 74.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.663, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.710, Test accuracy: 86.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.821, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.874, Test accuracy: 80.80 

        train local model (freeze embeding):client   4,  Train loss: 0.583, Train accuracy: 76.000, Test loss: 0.857, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.152, Train accuracy: 94.400, Test loss: 0.906, Test accuracy: 74.00 

Round   0, Train loss: 0.031, Test loss: 0.845, Test accuracy: 80.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.133, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.193, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.283, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.675, Test accuracy: 87.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.714, Test accuracy: 87.20 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.821, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 79.80 

        train local model (freeze embeding):client   4,  Train loss: 0.339, Train accuracy: 86.600, Test loss: 0.749, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.145, Train accuracy: 94.800, Test loss: 1.093, Test accuracy: 73.40 

Round   1, Train loss: 0.030, Test loss: 0.853, Test accuracy: 81.56 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 1.415, Test accuracy: 69.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.648, Test accuracy: 87.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.677, Test accuracy: 86.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.826, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.812, Test accuracy: 82.80 

        train local model (freeze embeding):client   4,  Train loss: 0.196, Train accuracy: 91.200, Test loss: 0.695, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.061, Train accuracy: 98.000, Test loss: 0.950, Test accuracy: 74.80 

Round   2, Train loss: 0.015, Test loss: 0.828, Test accuracy: 81.84 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.299, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.146, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.235, Test accuracy: 77.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.634, Test accuracy: 88.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.054, Train accuracy: 98.200, Test loss: 1.013, Test accuracy: 81.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.820, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.960, Test accuracy: 80.20 

        train local model (freeze embeding):client   4,  Train loss: 0.119, Train accuracy: 96.000, Test loss: 0.713, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 1.056, Test accuracy: 75.40 

Round   3, Train loss: 0.018, Test loss: 0.856, Test accuracy: 81.44 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.286, Test accuracy: 75.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.143, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.232, Test accuracy: 77.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.656, Test accuracy: 88.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.783, Test accuracy: 84.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.827, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 81.00 

        train local model (freeze embeding):client   4,  Train loss: 0.102, Train accuracy: 96.600, Test loss: 0.793, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.090, Train accuracy: 96.200, Test loss: 1.091, Test accuracy: 73.80 

Round   4, Train loss: 0.019, Test loss: 0.835, Test accuracy: 81.84 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.902, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.123, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.292, Test accuracy: 75.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.648, Test accuracy: 87.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 0.781, Test accuracy: 84.20 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.789, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.918, Test accuracy: 82.60 

        train local model (freeze embeding):client   4,  Train loss: 0.051, Train accuracy: 99.400, Test loss: 0.792, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 0.966, Test accuracy: 76.20 

Round   5, Train loss: 0.007, Test loss: 0.827, Test accuracy: 82.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.019, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 74.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.621, Test accuracy: 87.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.709, Test accuracy: 86.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.799, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 82.80 

        train local model (freeze embeding):client   4,  Train loss: 0.038, Train accuracy: 99.400, Test loss: 0.784, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.107, Train accuracy: 97.200, Test loss: 1.176, Test accuracy: 73.80 

Round   6, Train loss: 0.023, Test loss: 0.809, Test accuracy: 82.36 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.949, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.312, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.599, Test accuracy: 88.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.031, Train accuracy: 98.800, Test loss: 1.076, Test accuracy: 82.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.792, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.151, Train accuracy: 95.400, Test loss: 1.538, Test accuracy: 72.60 

        train local model (freeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.800, Test loss: 0.817, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 1.196, Test accuracy: 74.60 

Round   7, Train loss: 0.045, Test loss: 0.841, Test accuracy: 81.64 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.249, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.278, Test accuracy: 73.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.616, Test accuracy: 88.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.691, Test accuracy: 87.40 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.797, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.079, Train accuracy: 96.800, Test loss: 1.280, Test accuracy: 76.80 

        train local model (freeze embeding):client   4,  Train loss: 0.028, Train accuracy: 99.800, Test loss: 0.860, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.107, Train accuracy: 96.200, Test loss: 1.191, Test accuracy: 75.60 

Round   8, Train loss: 0.039, Test loss: 0.834, Test accuracy: 82.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.917, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.051, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.248, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.632, Test accuracy: 88.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.646, Test accuracy: 87.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.853, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 80.60 

        train local model (freeze embeding):client   4,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.030, Train accuracy: 98.800, Test loss: 1.173, Test accuracy: 75.20 

Round   9, Train loss: 0.007, Test loss: 0.846, Test accuracy: 82.68 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.232, Test accuracy: 76.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.067, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.111, Test accuracy: 80.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.615, Test accuracy: 88.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.032, Train accuracy: 98.600, Test loss: 0.871, Test accuracy: 83.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.819, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.116, Test accuracy: 78.00 

        train local model (freeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 0.939, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.125, Train accuracy: 96.000, Test loss: 1.529, Test accuracy: 70.20 

Round  10, Train loss: 0.035, Test loss: 0.852, Test accuracy: 82.48 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.922, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.046, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.445, Test accuracy: 72.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.596, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.678, Test accuracy: 86.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.805, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.807, Test accuracy: 82.20 

        train local model (freeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 0.929, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.051, Train accuracy: 98.400, Test loss: 1.264, Test accuracy: 74.80 

Round  11, Train loss: 0.014, Test loss: 0.863, Test accuracy: 82.36 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.917, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.068, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 81.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.634, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.704, Test accuracy: 87.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.801, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.933, Test accuracy: 81.80 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.091, Test accuracy: 79.60 

Round  12, Train loss: 0.002, Test loss: 0.859, Test accuracy: 82.64 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.106, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.439, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.620, Test accuracy: 88.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.694, Test accuracy: 88.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.793, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 81.20 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.987, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.224, Train accuracy: 92.600, Test loss: 1.580, Test accuracy: 72.20 

Round  13, Train loss: 0.046, Test loss: 0.856, Test accuracy: 82.56 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.206, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.024, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 78.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.644, Test accuracy: 88.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.200, Test loss: 0.895, Test accuracy: 84.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.780, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.837, Test accuracy: 83.00 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 79.60 

Round  14, Train loss: 0.005, Test loss: 0.869, Test accuracy: 82.68 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.200, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.992, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.658, Test accuracy: 88.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 84.40 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.793, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.825, Test accuracy: 82.80 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.971, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.126, Test accuracy: 79.00 

Round  15, Train loss: 0.002, Test loss: 0.867, Test accuracy: 82.56 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.992, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.058, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.183, Test accuracy: 77.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.645, Test accuracy: 87.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.712, Test accuracy: 87.40 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.839, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 82.60 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.135, Train accuracy: 95.600, Test loss: 1.325, Test accuracy: 75.60 

Round  16, Train loss: 0.028, Test loss: 0.880, Test accuracy: 82.92 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 81.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.226, Test accuracy: 75.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.651, Test accuracy: 88.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.720, Test accuracy: 86.60 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.870, Test accuracy: 83.40 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.011, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.091, Train accuracy: 97.200, Test loss: 1.362, Test accuracy: 74.00 

Round  17, Train loss: 0.019, Test loss: 0.858, Test accuracy: 82.88 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 81.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.609, Test accuracy: 87.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.741, Test accuracy: 87.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.876, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 81.20 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.060, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.242, Test accuracy: 78.60 

Round  18, Train loss: 0.001, Test loss: 0.882, Test accuracy: 82.72 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.901, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.030, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.067, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.634, Test accuracy: 87.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.102, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.840, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.901, Test accuracy: 83.40 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.140, Test accuracy: 78.80 

Round  19, Train loss: 0.005, Test loss: 0.897, Test accuracy: 82.12 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.027, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 79.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.619, Test accuracy: 87.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.608, Test accuracy: 87.80 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.822, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.825, Test accuracy: 82.60 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 80.20 

Final Round, Train loss: 0.001, Test loss: 0.882, Test accuracy: 82.20 

Average accuracy final 10 rounds: 388.687 

4866.867129087448
[14.792833089828491, 29.48949408531189, 44.340603828430176, 58.97577166557312, 74.35079741477966, 89.3182954788208, 104.11824536323547, 118.56953597068787, 132.95648503303528, 148.04945254325867, 163.2240607738495, 178.7363567352295, 193.79625058174133, 209.00424313545227, 224.10400366783142, 239.7048420906067, 255.55203986167908, 270.3158669471741, 285.20684576034546, 300.3920931816101, 308.3468964099884, 324.15163373947144, 339.32591938972473, 355.03058886528015, 370.6025114059448, 385.86339473724365, 401.58176827430725, 417.19086742401123, 432.50411462783813, 448.3063666820526, 463.75612115859985, 478.94096207618713, 494.485867023468, 510.33083033561707, 525.3612401485443, 540.7936089038849, 556.2260332107544, 571.1160635948181, 586.3280758857727, 601.2949385643005, 616.5445120334625, 625.1940591335297, 641.218254327774, 656.8215188980103, 671.9758634567261, 687.8984849452972, 703.5533556938171, 719.2990744113922, 735.0130059719086, 750.2795648574829, 766.6099331378937, 782.383407831192, 798.6994824409485, 814.6239063739777, 830.0660483837128, 845.5441608428955, 860.8861429691315, 876.3429498672485, 891.3540802001953, 906.852108001709, 923.036171913147, 938.5231349468231, 947.5015625953674, 963.0528402328491, 978.693229675293, 994.0890986919403, 1009.8797841072083, 1025.8185086250305, 1041.7806370258331, 1057.4666540622711, 1073.3805661201477, 1089.0908806324005, 1104.0170097351074, 1119.732745885849, 1134.5683000087738, 1149.818638086319, 1165.5208597183228, 1181.0473809242249, 1196.9498410224915, 1212.3609709739685, 1228.2639620304108, 1244.0175547599792, 1259.695543050766, 1268.5150661468506, 1283.9574460983276, 1300.382187128067, 1316.3293642997742, 1332.511688709259, 1347.9917352199554, 1363.6044037342072, 1379.6414031982422, 1394.9135546684265, 1410.215714931488, 1426.7515096664429, 1442.8975353240967, 1459.0336837768555, 1474.5396044254303, 1490.3062901496887, 1506.2282266616821, 1522.3280985355377, 1538.0987186431885, 1553.9493823051453, 1569.932752609253, 1585.3459289073944, 1594.5263104438782]
[67.4, 62.6, 71.8, 72.6, 71.2, 72.6, 70.2, 71.6, 69.2, 71.0, 69.0, 73.0, 71.2, 72.8, 74.6, 76.0, 76.4, 78.0, 72.0, 76.4, 75.8, 69.9, 69.0, 70.2, 70.8, 70.2, 70.4, 71.2, 72.6, 70.5, 72.0, 71.9, 72.2, 72.6, 72.6, 73.2, 72.5, 72.4, 72.0, 71.1, 72.5, 72.5, 76.33333333333333, 77.06666666666666, 77.8, 77.86666666666666, 77.2, 78.73333333333333, 77.8, 78.2, 78.46666666666667, 78.2, 78.73333333333333, 78.26666666666667, 78.06666666666666, 78.2, 78.06666666666666, 77.8, 78.46666666666667, 79.06666666666666, 79.6, 78.73333333333333, 79.2, 79.75, 81.15, 80.7, 79.5, 80.5, 80.85, 80.8, 80.8, 81.05, 80.35, 81.5, 82.0, 81.15, 81.3, 80.65, 81.85, 80.75, 81.2, 81.65, 81.5, 81.55, 80.88, 81.56, 81.84, 81.44, 81.84, 82.12, 82.36, 81.64, 82.2, 82.68, 82.48, 82.36, 82.64, 82.56, 82.68, 82.56, 82.92, 82.88, 82.72, 82.12, 82.2]
