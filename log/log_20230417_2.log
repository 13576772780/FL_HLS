nohup: 忽略输入
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.527, Test loss: 1.457, Test accuracy: 46.24 

Round   0, Global train loss: 1.527, Global test loss: 2.240, Global test accuracy: 16.00 

Round   1, Train loss: 1.240, Test loss: 1.466, Test accuracy: 47.40 

Round   1, Global train loss: 1.240, Global test loss: 2.224, Global test accuracy: 16.56 

Round   2, Train loss: 1.069, Test loss: 1.380, Test accuracy: 50.32 

Round   2, Global train loss: 1.069, Global test loss: 2.241, Global test accuracy: 16.12 

Round   3, Train loss: 0.951, Test loss: 1.486, Test accuracy: 52.92 

Round   3, Global train loss: 0.951, Global test loss: 2.367, Global test accuracy: 19.76 

Round   4, Train loss: 0.823, Test loss: 1.359, Test accuracy: 55.56 

Round   4, Global train loss: 0.823, Global test loss: 2.353, Global test accuracy: 16.00 

Round   5, Train loss: 0.718, Test loss: 1.467, Test accuracy: 56.12 

Round   5, Global train loss: 0.718, Global test loss: 2.405, Global test accuracy: 16.00 

Round   6, Train loss: 0.609, Test loss: 1.594, Test accuracy: 57.12 

Round   6, Global train loss: 0.609, Global test loss: 2.373, Global test accuracy: 16.04 

Round   7, Train loss: 0.542, Test loss: 1.674, Test accuracy: 57.52 

Round   7, Global train loss: 0.542, Global test loss: 2.376, Global test accuracy: 16.16 

Round   8, Train loss: 0.430, Test loss: 1.763, Test accuracy: 56.56 

Round   8, Global train loss: 0.430, Global test loss: 2.441, Global test accuracy: 16.48 

Round   9, Train loss: 0.386, Test loss: 2.079, Test accuracy: 55.96 

Round   9, Global train loss: 0.386, Global test loss: 2.510, Global test accuracy: 20.92 

Round  10, Train loss: 0.320, Test loss: 1.729, Test accuracy: 58.80 

Round  10, Global train loss: 0.320, Global test loss: 2.392, Global test accuracy: 16.40 

Round  11, Train loss: 0.294, Test loss: 1.678, Test accuracy: 58.52 

Round  11, Global train loss: 0.294, Global test loss: 2.422, Global test accuracy: 19.52 

Round  12, Train loss: 0.239, Test loss: 1.839, Test accuracy: 59.88 

Round  12, Global train loss: 0.239, Global test loss: 2.430, Global test accuracy: 17.60 

Round  13, Train loss: 0.184, Test loss: 1.852, Test accuracy: 60.20 

Round  13, Global train loss: 0.184, Global test loss: 2.438, Global test accuracy: 16.52 

Round  14, Train loss: 0.174, Test loss: 1.993, Test accuracy: 59.20 

Round  14, Global train loss: 0.174, Global test loss: 2.386, Global test accuracy: 19.52 

Round  15, Train loss: 0.146, Test loss: 2.305, Test accuracy: 57.56 

Round  15, Global train loss: 0.146, Global test loss: 2.442, Global test accuracy: 19.96 

Round  16, Train loss: 0.144, Test loss: 1.872, Test accuracy: 62.24 

Round  16, Global train loss: 0.144, Global test loss: 2.406, Global test accuracy: 21.20 

Round  17, Train loss: 0.118, Test loss: 1.964, Test accuracy: 62.00 

Round  17, Global train loss: 0.118, Global test loss: 2.498, Global test accuracy: 21.12 

Round  18, Train loss: 0.109, Test loss: 2.130, Test accuracy: 60.60 

Round  18, Global train loss: 0.109, Global test loss: 2.494, Global test accuracy: 20.72 

Round  19, Train loss: 0.099, Test loss: 1.980, Test accuracy: 60.24 

Round  19, Global train loss: 0.099, Global test loss: 2.609, Global test accuracy: 18.76 

Round  20, Train loss: 0.068, Test loss: 2.098, Test accuracy: 60.36 

Round  20, Global train loss: 0.068, Global test loss: 2.561, Global test accuracy: 21.72 

Round  21, Train loss: 0.094, Test loss: 1.999, Test accuracy: 62.24 

Round  21, Global train loss: 0.094, Global test loss: 2.489, Global test accuracy: 20.76 

Round  22, Train loss: 0.065, Test loss: 2.064, Test accuracy: 61.52 

Round  22, Global train loss: 0.065, Global test loss: 2.545, Global test accuracy: 21.76 

Round  23, Train loss: 0.063, Test loss: 2.158, Test accuracy: 61.92 

Round  23, Global train loss: 0.063, Global test loss: 2.522, Global test accuracy: 18.12 

Round  24, Train loss: 0.062, Test loss: 2.076, Test accuracy: 61.64 

Round  24, Global train loss: 0.062, Global test loss: 2.441, Global test accuracy: 16.88 

Round  25, Train loss: 0.052, Test loss: 2.058, Test accuracy: 63.16 

Round  25, Global train loss: 0.052, Global test loss: 2.444, Global test accuracy: 17.44 

Round  26, Train loss: 0.041, Test loss: 2.053, Test accuracy: 62.92 

Round  26, Global train loss: 0.041, Global test loss: 2.506, Global test accuracy: 17.16 

Round  27, Train loss: 0.044, Test loss: 2.254, Test accuracy: 61.88 

Round  27, Global train loss: 0.044, Global test loss: 2.571, Global test accuracy: 21.12 

Round  28, Train loss: 0.046, Test loss: 2.136, Test accuracy: 63.48 

Round  28, Global train loss: 0.046, Global test loss: 2.557, Global test accuracy: 17.60 

Round  29, Train loss: 0.033, Test loss: 2.135, Test accuracy: 62.52 

Round  29, Global train loss: 0.033, Global test loss: 2.571, Global test accuracy: 17.96 

Round  30, Train loss: 0.044, Test loss: 2.019, Test accuracy: 62.76 

Round  30, Global train loss: 0.044, Global test loss: 2.524, Global test accuracy: 20.36 

Round  31, Train loss: 0.036, Test loss: 2.081, Test accuracy: 62.40 

Round  31, Global train loss: 0.036, Global test loss: 2.550, Global test accuracy: 18.00 

Round  32, Train loss: 0.047, Test loss: 2.261, Test accuracy: 60.76 

Round  32, Global train loss: 0.047, Global test loss: 2.592, Global test accuracy: 17.20 

Round  33, Train loss: 0.047, Test loss: 2.194, Test accuracy: 63.04 

Round  33, Global train loss: 0.047, Global test loss: 2.523, Global test accuracy: 18.00 

Round  34, Train loss: 0.029, Test loss: 2.156, Test accuracy: 63.48 

Round  34, Global train loss: 0.029, Global test loss: 2.519, Global test accuracy: 20.76 

Final Round, Train loss: 0.033, Test loss: 2.081, Test accuracy: 63.16 

Final Round, Global train loss: 0.033, Global test loss: 2.519, Global test accuracy: 20.76 

Average accuracy final 10 rounds: 62.64 

Average global accuracy final 10 rounds: 18.560000000000002 

1262.1554918289185
[8.563995361328125, 14.754324674606323, 20.995551347732544, 27.242610692977905, 33.495033502578735, 39.74110531806946, 45.974761724472046, 52.26966738700867, 58.29532980918884, 64.60616493225098, 70.89255428314209, 77.21613359451294, 83.35378646850586, 89.43727684020996, 95.71235871315002, 101.9122576713562, 108.10707211494446, 114.38023018836975, 120.62979388237, 126.89599514007568, 133.06185865402222, 139.295001745224, 145.72342014312744, 151.56042194366455, 158.10548424720764, 164.24799585342407, 170.54644870758057, 177.48544454574585, 183.9769105911255, 189.9875931739807, 195.79711246490479, 202.63002681732178, 209.2821011543274, 216.19270181655884, 222.63568592071533, 235.90280652046204]
[46.24, 47.4, 50.32, 52.92, 55.56, 56.12, 57.12, 57.52, 56.56, 55.96, 58.8, 58.52, 59.88, 60.2, 59.2, 57.56, 62.24, 62.0, 60.6, 60.24, 60.36, 62.24, 61.52, 61.92, 61.64, 63.16, 62.92, 61.88, 63.48, 62.52, 62.76, 62.4, 60.76, 63.04, 63.48, 63.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.542, Test loss: 1.446, Test accuracy: 43.32 

Round   0, Global train loss: 1.542, Global test loss: 2.414, Global test accuracy: 16.00 

Round   1, Train loss: 1.429, Test loss: 1.244, Test accuracy: 50.08 

Round   1, Global train loss: 1.429, Global test loss: 2.085, Global test accuracy: 25.96 

Round   2, Train loss: 1.297, Test loss: 1.377, Test accuracy: 50.20 

Round   2, Global train loss: 1.297, Global test loss: 1.858, Global test accuracy: 32.96 

Round   3, Train loss: 1.183, Test loss: 1.294, Test accuracy: 54.04 

Round   3, Global train loss: 1.183, Global test loss: 1.700, Global test accuracy: 41.60 

Round   4, Train loss: 1.081, Test loss: 1.272, Test accuracy: 53.68 

Round   4, Global train loss: 1.081, Global test loss: 1.668, Global test accuracy: 40.72 

Round   5, Train loss: 1.015, Test loss: 1.272, Test accuracy: 55.96 

Round   5, Global train loss: 1.015, Global test loss: 1.653, Global test accuracy: 41.64 

Round   6, Train loss: 0.942, Test loss: 1.219, Test accuracy: 58.96 

Round   6, Global train loss: 0.942, Global test loss: 1.542, Global test accuracy: 46.16 

Round   7, Train loss: 0.869, Test loss: 1.280, Test accuracy: 58.12 

Round   7, Global train loss: 0.869, Global test loss: 1.469, Global test accuracy: 48.40 

Round   8, Train loss: 0.807, Test loss: 1.446, Test accuracy: 57.08 

Round   8, Global train loss: 0.807, Global test loss: 1.397, Global test accuracy: 50.76 

Round   9, Train loss: 0.745, Test loss: 1.297, Test accuracy: 59.92 

Round   9, Global train loss: 0.745, Global test loss: 1.491, Global test accuracy: 50.20 

Round  10, Train loss: 0.710, Test loss: 1.318, Test accuracy: 61.08 

Round  10, Global train loss: 0.710, Global test loss: 1.340, Global test accuracy: 54.68 

Round  11, Train loss: 0.663, Test loss: 1.507, Test accuracy: 58.44 

Round  11, Global train loss: 0.663, Global test loss: 1.559, Global test accuracy: 51.96 

Round  12, Train loss: 0.597, Test loss: 1.407, Test accuracy: 61.88 

Round  12, Global train loss: 0.597, Global test loss: 1.334, Global test accuracy: 57.76 

Round  13, Train loss: 0.565, Test loss: 1.229, Test accuracy: 63.76 

Round  13, Global train loss: 0.565, Global test loss: 1.398, Global test accuracy: 56.84 

Round  14, Train loss: 0.542, Test loss: 1.223, Test accuracy: 64.44 

Round  14, Global train loss: 0.542, Global test loss: 1.386, Global test accuracy: 57.72 

Round  15, Train loss: 0.495, Test loss: 1.259, Test accuracy: 63.72 

Round  15, Global train loss: 0.495, Global test loss: 1.313, Global test accuracy: 59.32 

Round  16, Train loss: 0.473, Test loss: 1.434, Test accuracy: 62.56 

Round  16, Global train loss: 0.473, Global test loss: 1.411, Global test accuracy: 58.68 

Round  17, Train loss: 0.429, Test loss: 1.441, Test accuracy: 64.04 

Round  17, Global train loss: 0.429, Global test loss: 1.376, Global test accuracy: 60.16 

Round  18, Train loss: 0.410, Test loss: 1.333, Test accuracy: 65.16 

Round  18, Global train loss: 0.410, Global test loss: 1.312, Global test accuracy: 60.64 

Round  19, Train loss: 0.385, Test loss: 1.384, Test accuracy: 65.88 

Round  19, Global train loss: 0.385, Global test loss: 1.407, Global test accuracy: 61.08 

Round  20, Train loss: 0.362, Test loss: 1.351, Test accuracy: 66.60 

Round  20, Global train loss: 0.362, Global test loss: 1.314, Global test accuracy: 61.72 

Round  21, Train loss: 0.322, Test loss: 1.372, Test accuracy: 66.16 

Round  21, Global train loss: 0.322, Global test loss: 1.231, Global test accuracy: 62.60 

Round  22, Train loss: 0.301, Test loss: 1.492, Test accuracy: 64.48 

Round  22, Global train loss: 0.301, Global test loss: 1.409, Global test accuracy: 60.72 

Round  23, Train loss: 0.293, Test loss: 1.352, Test accuracy: 67.88 

Round  23, Global train loss: 0.293, Global test loss: 1.418, Global test accuracy: 61.60 

Round  24, Train loss: 0.280, Test loss: 1.321, Test accuracy: 67.04 

Round  24, Global train loss: 0.280, Global test loss: 1.318, Global test accuracy: 62.00 

Round  25, Train loss: 0.254, Test loss: 1.547, Test accuracy: 65.04 

Round  25, Global train loss: 0.254, Global test loss: 1.439, Global test accuracy: 61.16 

Round  26, Train loss: 0.230, Test loss: 1.344, Test accuracy: 68.64 

Round  26, Global train loss: 0.230, Global test loss: 1.415, Global test accuracy: 62.32 

Round  27, Train loss: 0.227, Test loss: 1.520, Test accuracy: 67.48 

Round  27, Global train loss: 0.227, Global test loss: 1.398, Global test accuracy: 62.20 

Round  28, Train loss: 0.220, Test loss: 1.479, Test accuracy: 66.20 

Round  28, Global train loss: 0.220, Global test loss: 1.353, Global test accuracy: 63.04 

Round  29, Train loss: 0.184, Test loss: 1.556, Test accuracy: 66.92 

Round  29, Global train loss: 0.184, Global test loss: 1.333, Global test accuracy: 62.56 

Round  30, Train loss: 0.187, Test loss: 1.814, Test accuracy: 64.20 

Round  30, Global train loss: 0.187, Global test loss: 1.471, Global test accuracy: 61.48 

Round  31, Train loss: 0.171, Test loss: 1.305, Test accuracy: 70.80 

Round  31, Global train loss: 0.171, Global test loss: 1.306, Global test accuracy: 64.20 

Round  32, Train loss: 0.178, Test loss: 1.374, Test accuracy: 69.00 

Round  32, Global train loss: 0.178, Global test loss: 1.432, Global test accuracy: 62.48 

Round  33, Train loss: 0.156, Test loss: 1.662, Test accuracy: 66.88 

Round  33, Global train loss: 0.156, Global test loss: 1.420, Global test accuracy: 63.00 

Round  34, Train loss: 0.138, Test loss: 1.372, Test accuracy: 70.96 

Round  34, Global train loss: 0.138, Global test loss: 1.350, Global test accuracy: 64.76 

Round  35, Train loss: 0.153, Test loss: 1.659, Test accuracy: 66.96 

Round  35, Global train loss: 0.153, Global test loss: 1.407, Global test accuracy: 63.68 

Round  36, Train loss: 0.133, Test loss: 1.402, Test accuracy: 69.16 

Round  36, Global train loss: 0.133, Global test loss: 1.389, Global test accuracy: 64.08 

Round  37, Train loss: 0.130, Test loss: 1.603, Test accuracy: 68.08 

Round  37, Global train loss: 0.130, Global test loss: 1.423, Global test accuracy: 63.72 

Round  38, Train loss: 0.128, Test loss: 1.616, Test accuracy: 68.12 

Round  38, Global train loss: 0.128, Global test loss: 1.376, Global test accuracy: 63.20 

Round  39, Train loss: 0.089, Test loss: 1.514, Test accuracy: 69.44 

Round  39, Global train loss: 0.089, Global test loss: 1.490, Global test accuracy: 62.88 

Round  40, Train loss: 0.098, Test loss: 1.532, Test accuracy: 69.44 

Round  40, Global train loss: 0.098, Global test loss: 1.400, Global test accuracy: 65.48 

Round  41, Train loss: 0.094, Test loss: 1.596, Test accuracy: 69.04 

Round  41, Global train loss: 0.094, Global test loss: 1.511, Global test accuracy: 62.72 

Round  42, Train loss: 0.082, Test loss: 1.375, Test accuracy: 72.20 

Round  42, Global train loss: 0.082, Global test loss: 1.357, Global test accuracy: 66.60 

Round  43, Train loss: 0.102, Test loss: 1.639, Test accuracy: 69.04 

Round  43, Global train loss: 0.102, Global test loss: 1.500, Global test accuracy: 64.16 

Round  44, Train loss: 0.087, Test loss: 1.503, Test accuracy: 71.20 

Round  44, Global train loss: 0.087, Global test loss: 1.407, Global test accuracy: 65.80 

Round  45, Train loss: 0.087, Test loss: 1.418, Test accuracy: 71.64 

Round  45, Global train loss: 0.087, Global test loss: 1.384, Global test accuracy: 65.80 

Round  46, Train loss: 0.085, Test loss: 1.613, Test accuracy: 69.88 

Round  46, Global train loss: 0.085, Global test loss: 1.373, Global test accuracy: 66.00 

Round  47, Train loss: 0.074, Test loss: 1.462, Test accuracy: 70.72 

Round  47, Global train loss: 0.074, Global test loss: 1.420, Global test accuracy: 65.36 

Round  48, Train loss: 0.083, Test loss: 1.663, Test accuracy: 68.44 

Round  48, Global train loss: 0.083, Global test loss: 1.508, Global test accuracy: 64.48 

Round  49, Train loss: 0.063, Test loss: 1.501, Test accuracy: 71.24 

Round  49, Global train loss: 0.063, Global test loss: 1.441, Global test accuracy: 65.04 

Final Round, Train loss: 0.091, Test loss: 1.401, Test accuracy: 70.48 

Final Round, Global train loss: 0.091, Global test loss: 1.441, Global test accuracy: 65.04 

Average accuracy final 10 rounds: 70.284 

Average global accuracy final 10 rounds: 65.144 

1763.9022989273071
[9.02085828781128, 15.677707433700562, 22.15122890472412, 28.34315299987793, 35.226513385772705, 41.535019636154175, 47.56435680389404, 54.20919966697693, 60.761985301971436, 67.1158607006073, 73.36762285232544, 79.8873507976532, 85.73439192771912, 91.91469144821167, 97.71918296813965, 104.02057838439941, 110.68024373054504, 117.17292523384094, 123.30408525466919, 128.99508786201477, 135.60311913490295, 141.641263961792, 147.4395341873169, 153.220308303833, 159.63073897361755, 165.82774877548218, 172.21078157424927, 178.92888021469116, 185.24611639976501, 190.9285089969635, 197.08193731307983, 203.28683710098267, 209.52005553245544, 216.3160457611084, 222.1007537841797, 228.2653727531433, 234.17117404937744, 239.88048887252808, 245.58128929138184, 251.95073652267456, 258.780291557312, 264.8950443267822, 271.6611454486847, 278.27093410491943, 284.30753564834595, 290.10954785346985, 295.99868154525757, 301.74210691452026, 307.89655780792236, 314.64727330207825, 326.71329855918884]
[43.32, 50.08, 50.2, 54.04, 53.68, 55.96, 58.96, 58.12, 57.08, 59.92, 61.08, 58.44, 61.88, 63.76, 64.44, 63.72, 62.56, 64.04, 65.16, 65.88, 66.6, 66.16, 64.48, 67.88, 67.04, 65.04, 68.64, 67.48, 66.2, 66.92, 64.2, 70.8, 69.0, 66.88, 70.96, 66.96, 69.16, 68.08, 68.12, 69.44, 69.44, 69.04, 72.2, 69.04, 71.2, 71.64, 69.88, 70.72, 68.44, 71.24, 70.48]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.593, Test loss: 1.708, Test accuracy: 29.12 

Round   1, Train loss: 1.441, Test loss: 1.468, Test accuracy: 37.20 

Round   2, Train loss: 1.346, Test loss: 1.456, Test accuracy: 39.40 

Round   3, Train loss: 1.244, Test loss: 1.313, Test accuracy: 46.64 

Round   4, Train loss: 1.156, Test loss: 1.138, Test accuracy: 53.92 

Round   5, Train loss: 1.090, Test loss: 1.067, Test accuracy: 56.52 

Round   6, Train loss: 1.026, Test loss: 1.170, Test accuracy: 54.00 

Round   7, Train loss: 0.986, Test loss: 1.120, Test accuracy: 56.16 

Round   8, Train loss: 0.928, Test loss: 1.019, Test accuracy: 60.04 

Round   9, Train loss: 0.877, Test loss: 0.942, Test accuracy: 64.44 

Round  10, Train loss: 0.825, Test loss: 1.057, Test accuracy: 59.96 

Round  11, Train loss: 0.784, Test loss: 0.935, Test accuracy: 64.80 

Round  12, Train loss: 0.752, Test loss: 1.049, Test accuracy: 62.92 

Round  13, Train loss: 0.711, Test loss: 0.933, Test accuracy: 66.60 

Round  14, Train loss: 0.668, Test loss: 0.883, Test accuracy: 66.96 

Round  15, Train loss: 0.624, Test loss: 0.875, Test accuracy: 68.00 

Round  16, Train loss: 0.588, Test loss: 0.933, Test accuracy: 66.68 

Round  17, Train loss: 0.571, Test loss: 1.101, Test accuracy: 63.12 

Round  18, Train loss: 0.548, Test loss: 0.876, Test accuracy: 69.96 

Round  19, Train loss: 0.512, Test loss: 0.853, Test accuracy: 70.08 

Round  20, Train loss: 0.492, Test loss: 0.918, Test accuracy: 67.96 

Round  21, Train loss: 0.450, Test loss: 0.880, Test accuracy: 69.40 

Round  22, Train loss: 0.413, Test loss: 0.906, Test accuracy: 69.24 

Round  23, Train loss: 0.412, Test loss: 0.857, Test accuracy: 71.88 

Round  24, Train loss: 0.363, Test loss: 0.836, Test accuracy: 72.16 

Round  25, Train loss: 0.364, Test loss: 0.840, Test accuracy: 72.80 

Round  26, Train loss: 0.344, Test loss: 0.823, Test accuracy: 72.64 

Round  27, Train loss: 0.320, Test loss: 0.880, Test accuracy: 72.52 

Round  28, Train loss: 0.299, Test loss: 0.919, Test accuracy: 71.28 

Round  29, Train loss: 0.289, Test loss: 0.916, Test accuracy: 71.52 

Round  30, Train loss: 0.261, Test loss: 0.918, Test accuracy: 71.92 

Round  31, Train loss: 0.259, Test loss: 0.915, Test accuracy: 72.48 

Round  32, Train loss: 0.244, Test loss: 0.873, Test accuracy: 72.76 

Round  33, Train loss: 0.231, Test loss: 0.866, Test accuracy: 73.92 

Round  34, Train loss: 0.206, Test loss: 0.926, Test accuracy: 72.56 

Round  35, Train loss: 0.197, Test loss: 0.957, Test accuracy: 71.76 

Round  36, Train loss: 0.185, Test loss: 0.894, Test accuracy: 73.72 

Round  37, Train loss: 0.171, Test loss: 0.905, Test accuracy: 73.52 

Round  38, Train loss: 0.173, Test loss: 0.959, Test accuracy: 73.28 

Round  39, Train loss: 0.158, Test loss: 0.909, Test accuracy: 73.40 

Round  40, Train loss: 0.134, Test loss: 0.923, Test accuracy: 74.60 

Round  41, Train loss: 0.139, Test loss: 0.950, Test accuracy: 73.32 

Round  42, Train loss: 0.136, Test loss: 0.887, Test accuracy: 75.28 

Round  43, Train loss: 0.115, Test loss: 0.899, Test accuracy: 75.16 

Round  44, Train loss: 0.116, Test loss: 0.909, Test accuracy: 75.28 

Round  45, Train loss: 0.110, Test loss: 0.952, Test accuracy: 74.04 

Round  46, Train loss: 0.105, Test loss: 0.949, Test accuracy: 74.60 

Round  47, Train loss: 0.090, Test loss: 0.936, Test accuracy: 74.16 

Round  48, Train loss: 0.094, Test loss: 0.933, Test accuracy: 74.76 

Round  49, Train loss: 0.093, Test loss: 0.940, Test accuracy: 74.88 

Final Round, Train loss: 0.054, Test loss: 0.962, Test accuracy: 74.88 

Average accuracy final 10 rounds: 74.608 

1331.1706147193909
[8.047914981842041, 13.439203262329102, 18.070621728897095, 22.807685136795044, 27.405239582061768, 32.4926381111145, 37.69303035736084, 42.91945815086365, 48.07353949546814, 52.76499915122986, 58.18414115905762, 63.19319796562195, 68.094158411026, 73.50124931335449, 78.74114894866943, 83.92696619033813, 89.14852380752563, 94.07362008094788, 98.86538314819336, 104.35313606262207, 109.28910231590271, 114.01795172691345, 118.70611047744751, 123.44210004806519, 128.98202562332153, 133.72958874702454, 139.10856986045837, 143.70762491226196, 148.19858312606812, 152.8120448589325, 157.4582302570343, 162.43378353118896, 167.1668038368225, 172.69780826568604, 177.4615616798401, 182.41224360466003, 187.48363518714905, 192.44981980323792, 197.93232131004333, 202.6273491382599, 207.32910752296448, 211.97265934944153, 216.82973456382751, 221.633944272995, 226.3237750530243, 231.02094674110413, 236.20508909225464, 241.18213868141174, 246.15790104866028, 251.30637454986572, 257.18171095848083]
[29.12, 37.2, 39.4, 46.64, 53.92, 56.52, 54.0, 56.16, 60.04, 64.44, 59.96, 64.8, 62.92, 66.6, 66.96, 68.0, 66.68, 63.12, 69.96, 70.08, 67.96, 69.4, 69.24, 71.88, 72.16, 72.8, 72.64, 72.52, 71.28, 71.52, 71.92, 72.48, 72.76, 73.92, 72.56, 71.76, 73.72, 73.52, 73.28, 73.4, 74.6, 73.32, 75.28, 75.16, 75.28, 74.04, 74.6, 74.16, 74.76, 74.88, 74.88]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.614, Test loss: 1.773, Test accuracy: 26.16
Round   1, Train loss: 1.451, Test loss: 1.580, Test accuracy: 31.40
Round   2, Train loss: 1.355, Test loss: 1.413, Test accuracy: 40.24
Round   3, Train loss: 1.233, Test loss: 1.249, Test accuracy: 47.52
Round   4, Train loss: 1.163, Test loss: 1.248, Test accuracy: 50.04
Round   5, Train loss: 1.090, Test loss: 1.207, Test accuracy: 52.60
Round   6, Train loss: 1.031, Test loss: 1.109, Test accuracy: 56.80
Round   7, Train loss: 0.968, Test loss: 1.052, Test accuracy: 59.44
Round   8, Train loss: 0.927, Test loss: 1.036, Test accuracy: 60.04
Round   9, Train loss: 0.880, Test loss: 0.967, Test accuracy: 62.92
Round  10, Train loss: 0.828, Test loss: 1.002, Test accuracy: 62.32
Round  11, Train loss: 0.779, Test loss: 1.036, Test accuracy: 62.28
Round  12, Train loss: 0.751, Test loss: 0.998, Test accuracy: 62.68
Round  13, Train loss: 0.713, Test loss: 0.903, Test accuracy: 66.96
Round  14, Train loss: 0.670, Test loss: 0.902, Test accuracy: 66.76
Round  15, Train loss: 0.627, Test loss: 0.900, Test accuracy: 68.00
Round  16, Train loss: 0.591, Test loss: 0.868, Test accuracy: 69.56
Round  17, Train loss: 0.566, Test loss: 0.869, Test accuracy: 69.16
Round  18, Train loss: 0.534, Test loss: 0.887, Test accuracy: 69.80
Round  19, Train loss: 0.515, Test loss: 0.865, Test accuracy: 69.72
Round  20, Train loss: 0.484, Test loss: 0.843, Test accuracy: 71.12
Round  21, Train loss: 0.458, Test loss: 0.820, Test accuracy: 71.68
Round  22, Train loss: 0.431, Test loss: 0.965, Test accuracy: 67.52
Round  23, Train loss: 0.412, Test loss: 0.860, Test accuracy: 71.60
Round  24, Train loss: 0.388, Test loss: 0.847, Test accuracy: 71.44
Round  25, Train loss: 0.369, Test loss: 0.847, Test accuracy: 72.12
Round  26, Train loss: 0.335, Test loss: 0.868, Test accuracy: 72.08
Round  27, Train loss: 0.314, Test loss: 0.849, Test accuracy: 73.28
Round  28, Train loss: 0.301, Test loss: 0.861, Test accuracy: 73.08
Round  29, Train loss: 0.295, Test loss: 0.911, Test accuracy: 71.72
Round  30, Train loss: 0.271, Test loss: 0.877, Test accuracy: 72.52
Round  31, Train loss: 0.257, Test loss: 0.861, Test accuracy: 73.28
Round  32, Train loss: 0.231, Test loss: 0.862, Test accuracy: 73.20
Round  33, Train loss: 0.228, Test loss: 0.853, Test accuracy: 73.12
Round  34, Train loss: 0.213, Test loss: 0.846, Test accuracy: 74.28
Round  35, Train loss: 0.211, Test loss: 0.856, Test accuracy: 73.32
Round  36, Train loss: 0.178, Test loss: 0.876, Test accuracy: 74.12
Round  37, Train loss: 0.183, Test loss: 0.877, Test accuracy: 74.16
Round  38, Train loss: 0.157, Test loss: 0.867, Test accuracy: 73.96
Round  39, Train loss: 0.147, Test loss: 0.857, Test accuracy: 74.92
Round  40, Train loss: 0.154, Test loss: 0.906, Test accuracy: 74.08
Round  41, Train loss: 0.131, Test loss: 0.888, Test accuracy: 75.08
Round  42, Train loss: 0.124, Test loss: 0.883, Test accuracy: 75.52
Round  43, Train loss: 0.127, Test loss: 0.908, Test accuracy: 74.84
Round  44, Train loss: 0.107, Test loss: 0.923, Test accuracy: 74.72
Round  45, Train loss: 0.115, Test loss: 0.910, Test accuracy: 74.96
Round  46, Train loss: 0.108, Test loss: 0.893, Test accuracy: 75.60
Round  47, Train loss: 0.086, Test loss: 0.880, Test accuracy: 76.04
Round  48, Train loss: 0.087, Test loss: 0.909, Test accuracy: 74.80
Round  49, Train loss: 0.087, Test loss: 0.920, Test accuracy: 75.20
Final Round, Train loss: 0.049, Test loss: 0.926, Test accuracy: 75.24
Average accuracy final 10 rounds: 75.084
1515.3253931999207
[8.512732028961182, 14.246040105819702, 19.727723121643066, 25.438858032226562, 30.87864375114441, 36.25277543067932, 41.66136646270752, 47.30346441268921, 53.47530174255371, 59.828176498413086, 66.19515585899353, 71.72451663017273, 77.32794904708862, 82.94622611999512, 88.6144757270813, 94.03827548027039, 99.4519317150116, 105.64380311965942, 111.4592010974884, 116.84697031974792, 122.36464023590088, 128.2875416278839, 134.52639055252075, 140.76364016532898, 146.2812020778656, 151.73991799354553, 157.21011662483215, 162.71918082237244, 168.6477563381195, 173.98519444465637, 179.47737669944763, 185.8337504863739, 191.7528896331787, 198.05193901062012, 203.67125797271729, 209.0929057598114, 214.4158079624176, 220.50985312461853, 226.92434787750244, 232.40230250358582, 237.78649282455444, 243.18476128578186, 248.47349524497986, 253.80671882629395, 259.167010307312, 264.5165448188782, 270.5786352157593, 276.1154639720917, 282.2273859977722, 287.6121439933777, 293.98549580574036]
[26.16, 31.4, 40.24, 47.52, 50.04, 52.6, 56.8, 59.44, 60.04, 62.92, 62.32, 62.28, 62.68, 66.96, 66.76, 68.0, 69.56, 69.16, 69.8, 69.72, 71.12, 71.68, 67.52, 71.6, 71.44, 72.12, 72.08, 73.28, 73.08, 71.72, 72.52, 73.28, 73.2, 73.12, 74.28, 73.32, 74.12, 74.16, 73.96, 74.92, 74.08, 75.08, 75.52, 74.84, 74.72, 74.96, 75.6, 76.04, 74.8, 75.2, 75.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.476, Train accuracy: 83.800, Test loss: 1.664, Test accuracy: 51.40 

        train local model (freeze embeding):client   0,  Train loss: 0.481, Train accuracy: 83.000, Test loss: 1.786, Test accuracy: 52.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.496, Train accuracy: 80.200, Test loss: 1.815, Test accuracy: 50.60 

Round   0, Train loss: 0.496, Test loss: 1.815, Test accuracy: 50.60 

        train local model (freeze embeding):client   0,  Train loss: 0.289, Train accuracy: 91.000, Test loss: 1.697, Test accuracy: 52.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.323, Train accuracy: 89.000, Test loss: 1.701, Test accuracy: 54.80 

Round   1, Train loss: 0.323, Test loss: 1.701, Test accuracy: 54.80 

        train local model (freeze embeding):client   0,  Train loss: 0.174, Train accuracy: 94.600, Test loss: 1.675, Test accuracy: 55.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.313, Train accuracy: 87.800, Test loss: 2.202, Test accuracy: 46.80 

Round   2, Train loss: 0.313, Test loss: 2.202, Test accuracy: 46.80 

        train local model (freeze embeding):client   0,  Train loss: 0.180, Train accuracy: 94.000, Test loss: 2.066, Test accuracy: 51.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.317, Train accuracy: 89.000, Test loss: 1.902, Test accuracy: 53.00 

Round   3, Train loss: 0.317, Test loss: 1.902, Test accuracy: 53.00 

        train local model (freeze embeding):client   0,  Train loss: 0.134, Train accuracy: 95.400, Test loss: 1.967, Test accuracy: 54.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.193, Train accuracy: 93.200, Test loss: 2.032, Test accuracy: 52.00 

Round   4, Train loss: 0.193, Test loss: 2.032, Test accuracy: 52.00 

        train local model (freeze embeding):client   0,  Train loss: 0.090, Train accuracy: 97.800, Test loss: 1.954, Test accuracy: 55.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.124, Train accuracy: 95.000, Test loss: 2.283, Test accuracy: 52.40 

Round   5, Train loss: 0.124, Test loss: 2.283, Test accuracy: 52.40 

        train local model (freeze embeding):client   0,  Train loss: 0.063, Train accuracy: 98.200, Test loss: 2.111, Test accuracy: 55.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.136, Train accuracy: 96.000, Test loss: 2.290, Test accuracy: 52.60 

Round   6, Train loss: 0.136, Test loss: 2.290, Test accuracy: 52.60 

        train local model (freeze embeding):client   0,  Train loss: 0.051, Train accuracy: 98.600, Test loss: 2.250, Test accuracy: 52.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.066, Train accuracy: 98.000, Test loss: 2.534, Test accuracy: 55.00 

Round   7, Train loss: 0.066, Test loss: 2.534, Test accuracy: 55.00 

        train local model (freeze embeding):client   0,  Train loss: 0.035, Train accuracy: 99.200, Test loss: 2.341, Test accuracy: 57.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.083, Train accuracy: 96.600, Test loss: 2.555, Test accuracy: 52.40 

Round   8, Train loss: 0.083, Test loss: 2.555, Test accuracy: 52.40 

        train local model (freeze embeding):client   0,  Train loss: 0.052, Train accuracy: 98.400, Test loss: 2.450, Test accuracy: 54.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.059, Train accuracy: 97.800, Test loss: 2.625, Test accuracy: 53.00 

Round   9, Train loss: 0.059, Test loss: 2.625, Test accuracy: 53.00 

        train local model (freeze embeding):client   0,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 2.485, Test accuracy: 54.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 2.329, Test accuracy: 57.40 

Round  10, Train loss: 0.017, Test loss: 2.329, Test accuracy: 57.40 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 2.386, Test accuracy: 57.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.040, Train accuracy: 98.800, Test loss: 2.697, Test accuracy: 55.80 

Round  11, Train loss: 0.040, Test loss: 2.697, Test accuracy: 55.80 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 2.524, Test accuracy: 56.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 2.509, Test accuracy: 55.80 

Round  12, Train loss: 0.023, Test loss: 2.509, Test accuracy: 55.80 

        train local model (freeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.800, Test loss: 2.523, Test accuracy: 57.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.134, Train accuracy: 95.800, Test loss: 3.291, Test accuracy: 48.40 

Round  13, Train loss: 0.134, Test loss: 3.291, Test accuracy: 48.40 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 2.874, Test accuracy: 55.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 3.013, Test accuracy: 53.00 

Round  14, Train loss: 0.028, Test loss: 3.013, Test accuracy: 53.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 2.905, Test accuracy: 54.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.678, Test accuracy: 56.20 

Round  15, Train loss: 0.003, Test loss: 2.678, Test accuracy: 56.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.672, Test accuracy: 57.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.852, Test accuracy: 59.40 

Round  16, Train loss: 0.006, Test loss: 2.852, Test accuracy: 59.40 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 2.831, Test accuracy: 58.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 2.524, Test accuracy: 61.00 

Round  17, Train loss: 0.034, Test loss: 2.524, Test accuracy: 61.00 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 2.520, Test accuracy: 61.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 2.534, Test accuracy: 57.80 

Round  18, Train loss: 0.022, Test loss: 2.534, Test accuracy: 57.80 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 2.693, Test accuracy: 58.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.072, Train accuracy: 97.400, Test loss: 3.247, Test accuracy: 51.60 

Round  19, Train loss: 0.072, Test loss: 3.247, Test accuracy: 51.60 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 2.865, Test accuracy: 55.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 2.842, Test accuracy: 56.00 

Final Round, Train loss: 0.016, Test loss: 2.942, Test accuracy: 54.40 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.153, Train accuracy: 94.800, Test loss: 2.070, Test accuracy: 56.40 

        train local model (freeze embeding):client   0,  Train loss: 0.062, Train accuracy: 97.400, Test loss: 1.939, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 2.225, Test accuracy: 60.40 

        train local model (freeze embeding):client   1,  Train loss: 0.259, Train accuracy: 91.000, Test loss: 1.425, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.174, Train accuracy: 94.400, Test loss: 1.520, Test accuracy: 62.80 

Round   0, Train loss: 0.095, Test loss: 1.664, Test accuracy: 61.70 

        train local model (freeze embeding):client   0,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 1.813, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 2.307, Test accuracy: 59.40 

        train local model (freeze embeding):client   1,  Train loss: 0.162, Train accuracy: 94.800, Test loss: 1.400, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.259, Train accuracy: 90.400, Test loss: 1.831, Test accuracy: 61.20 

Round   1, Train loss: 0.134, Test loss: 1.608, Test accuracy: 62.50 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.600, Test loss: 1.839, Test accuracy: 59.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.247, Test accuracy: 60.00 

        train local model (freeze embeding):client   1,  Train loss: 0.113, Train accuracy: 96.600, Test loss: 1.464, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.113, Train accuracy: 96.600, Test loss: 1.623, Test accuracy: 60.20 

Round   2, Train loss: 0.059, Test loss: 1.679, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.839, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.800, Test loss: 2.339, Test accuracy: 56.80 

        train local model (freeze embeding):client   1,  Train loss: 0.063, Train accuracy: 98.600, Test loss: 1.426, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.335, Train accuracy: 88.200, Test loss: 2.198, Test accuracy: 59.20 

Round   3, Train loss: 0.177, Test loss: 1.822, Test accuracy: 61.90 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.885, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.800, Test loss: 2.554, Test accuracy: 59.40 

        train local model (freeze embeding):client   1,  Train loss: 0.063, Train accuracy: 98.200, Test loss: 1.518, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.152, Train accuracy: 94.600, Test loss: 2.002, Test accuracy: 57.20 

Round   4, Train loss: 0.098, Test loss: 1.973, Test accuracy: 60.50 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 2.039, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.040, Train accuracy: 99.600, Test loss: 2.350, Test accuracy: 59.20 

        train local model (freeze embeding):client   1,  Train loss: 0.059, Train accuracy: 97.800, Test loss: 1.612, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.296, Train accuracy: 89.800, Test loss: 2.134, Test accuracy: 57.40 

Round   5, Train loss: 0.168, Test loss: 1.755, Test accuracy: 63.90 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 1.906, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 2.158, Test accuracy: 62.60 

        train local model (freeze embeding):client   1,  Train loss: 0.035, Train accuracy: 99.200, Test loss: 1.539, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.128, Train accuracy: 96.200, Test loss: 2.363, Test accuracy: 57.80 

Round   6, Train loss: 0.068, Test loss: 1.780, Test accuracy: 62.50 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.939, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 2.353, Test accuracy: 58.00 

        train local model (freeze embeding):client   1,  Train loss: 0.034, Train accuracy: 99.400, Test loss: 1.447, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.155, Train accuracy: 94.000, Test loss: 1.996, Test accuracy: 57.80 

Round   7, Train loss: 0.082, Test loss: 1.820, Test accuracy: 62.20 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 2.031, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.448, Test accuracy: 59.60 

        train local model (freeze embeding):client   1,  Train loss: 0.035, Train accuracy: 98.800, Test loss: 1.610, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.759, Test accuracy: 62.80 

Round   8, Train loss: 0.009, Test loss: 1.773, Test accuracy: 64.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 2.046, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 2.514, Test accuracy: 59.40 

        train local model (freeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.544, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.035, Train accuracy: 98.800, Test loss: 1.948, Test accuracy: 61.60 

Round   9, Train loss: 0.033, Test loss: 2.019, Test accuracy: 62.30 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 2.170, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.474, Test accuracy: 60.00 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.666, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.099, Train accuracy: 96.000, Test loss: 1.980, Test accuracy: 60.00 

Round  10, Train loss: 0.051, Test loss: 1.915, Test accuracy: 63.30 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 2.132, Test accuracy: 60.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 2.479, Test accuracy: 60.40 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.698, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.442, Train accuracy: 86.400, Test loss: 2.691, Test accuracy: 59.00 

Round  11, Train loss: 0.229, Test loss: 2.001, Test accuracy: 62.90 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 2.226, Test accuracy: 60.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.432, Test accuracy: 60.60 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.730, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.063, Train accuracy: 98.200, Test loss: 2.394, Test accuracy: 57.40 

Round  12, Train loss: 0.033, Test loss: 2.092, Test accuracy: 62.40 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 2.296, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 2.526, Test accuracy: 57.00 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.785, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.059, Train accuracy: 97.600, Test loss: 1.932, Test accuracy: 62.60 

Round  13, Train loss: 0.034, Test loss: 1.859, Test accuracy: 62.50 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 2.139, Test accuracy: 61.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.347, Test accuracy: 61.00 

        train local model (freeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 1.652, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.088, Train accuracy: 97.600, Test loss: 2.493, Test accuracy: 60.00 

Round  14, Train loss: 0.047, Test loss: 1.925, Test accuracy: 63.10 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.123, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 2.440, Test accuracy: 61.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.768, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 98.800, Test loss: 2.070, Test accuracy: 64.00 

Round  15, Train loss: 0.019, Test loss: 1.903, Test accuracy: 64.50 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.141, Test accuracy: 60.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.342, Test accuracy: 62.80 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.722, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 1.919, Test accuracy: 63.00 

Round  16, Train loss: 0.013, Test loss: 1.853, Test accuracy: 64.90 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.093, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.416, Test accuracy: 60.60 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.600, Test loss: 1.694, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.982, Test accuracy: 62.00 

Round  17, Train loss: 0.020, Test loss: 1.942, Test accuracy: 64.10 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.283, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.454, Test accuracy: 59.40 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.653, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.942, Test accuracy: 64.80 

Round  18, Train loss: 0.006, Test loss: 1.963, Test accuracy: 64.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.254, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.386, Test accuracy: 61.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.766, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.040, Train accuracy: 98.200, Test loss: 1.974, Test accuracy: 62.00 

Round  19, Train loss: 0.020, Test loss: 1.924, Test accuracy: 63.90 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.206, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.161, Test accuracy: 60.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.792, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.806, Test accuracy: 64.40 

Final Round, Train loss: 0.002, Test loss: 1.915, Test accuracy: 64.00 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.200, Test loss: 1.190, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.070, Train accuracy: 97.400, Test loss: 2.121, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.430, Test accuracy: 58.60 

        train local model (freeze embeding):client   1,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 1.592, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.626, Test accuracy: 65.80 

        train local model (freeze embeding):client   2,  Train loss: 0.132, Train accuracy: 95.600, Test loss: 1.027, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.191, Train accuracy: 93.600, Test loss: 1.327, Test accuracy: 69.60 

Round   0, Train loss: 0.067, Test loss: 1.527, Test accuracy: 65.87 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.985, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.290, Test accuracy: 59.80 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 1.557, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.762, Test accuracy: 67.60 

        train local model (freeze embeding):client   2,  Train loss: 0.124, Train accuracy: 96.200, Test loss: 0.959, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.092, Train accuracy: 97.000, Test loss: 1.347, Test accuracy: 68.60 

Round   1, Train loss: 0.035, Test loss: 1.455, Test accuracy: 68.73 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.947, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.242, Test accuracy: 61.00 

        train local model (freeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.546, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.102, Train accuracy: 96.800, Test loss: 2.188, Test accuracy: 63.20 

        train local model (freeze embeding):client   2,  Train loss: 0.081, Train accuracy: 97.200, Test loss: 0.988, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.076, Train accuracy: 97.200, Test loss: 1.276, Test accuracy: 70.00 

Round   2, Train loss: 0.061, Test loss: 1.462, Test accuracy: 68.27 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.919, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.053, Train accuracy: 98.200, Test loss: 2.559, Test accuracy: 55.80 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.483, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.946, Test accuracy: 64.60 

        train local model (freeze embeding):client   2,  Train loss: 0.045, Train accuracy: 99.200, Test loss: 0.957, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.167, Train accuracy: 94.000, Test loss: 1.309, Test accuracy: 69.80 

Round   3, Train loss: 0.078, Test loss: 1.496, Test accuracy: 68.67 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 1.998, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.025, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.631, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.559, Test accuracy: 67.80 

        train local model (freeze embeding):client   2,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 0.995, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.110, Train accuracy: 96.600, Test loss: 1.445, Test accuracy: 69.40 

Round   4, Train loss: 0.038, Test loss: 1.458, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.791, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.221, Test accuracy: 63.40 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.542, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.088, Train accuracy: 97.400, Test loss: 2.192, Test accuracy: 60.00 

        train local model (freeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.800, Test loss: 1.005, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.046, Train accuracy: 98.600, Test loss: 1.397, Test accuracy: 71.60 

Round   5, Train loss: 0.046, Test loss: 1.512, Test accuracy: 68.13 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.956, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 2.561, Test accuracy: 59.20 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.659, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.034, Train accuracy: 99.400, Test loss: 1.896, Test accuracy: 61.60 

        train local model (freeze embeding):client   2,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.099, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.113, Train accuracy: 95.600, Test loss: 1.784, Test accuracy: 64.80 

Round   6, Train loss: 0.055, Test loss: 1.584, Test accuracy: 66.47 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.001, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 2.761, Test accuracy: 61.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.596, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.048, Train accuracy: 98.000, Test loss: 1.963, Test accuracy: 64.00 

        train local model (freeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.400, Test loss: 1.108, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.082, Train accuracy: 97.600, Test loss: 1.698, Test accuracy: 69.80 

Round   7, Train loss: 0.051, Test loss: 1.626, Test accuracy: 68.07 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.995, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.226, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.573, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.815, Test accuracy: 66.00 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.400, Test loss: 1.396, Test accuracy: 73.00 

Round   8, Train loss: 0.009, Test loss: 1.506, Test accuracy: 69.27 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 2.007, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.307, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.558, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 2.124, Test accuracy: 60.60 

        train local model (freeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.092, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.034, Train accuracy: 98.600, Test loss: 1.489, Test accuracy: 70.80 

Round   9, Train loss: 0.022, Test loss: 1.528, Test accuracy: 68.13 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.011, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.286, Test accuracy: 61.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.557, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 2.157, Test accuracy: 61.00 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.193, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.200, Test loss: 1.248, Test accuracy: 72.80 

Round  10, Train loss: 0.016, Test loss: 1.581, Test accuracy: 67.53 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.909, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.246, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.647, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.560, Test accuracy: 69.40 

        train local model (freeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.120, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.393, Test accuracy: 72.80 

Round  11, Train loss: 0.007, Test loss: 1.545, Test accuracy: 69.33 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.963, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.184, Test accuracy: 63.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.550, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.643, Test accuracy: 66.80 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.276, Test accuracy: 73.20 

Round  12, Train loss: 0.003, Test loss: 1.551, Test accuracy: 68.93 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.973, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 2.290, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.601, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.791, Test accuracy: 66.40 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.123, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.430, Test accuracy: 73.40 

Round  13, Train loss: 0.006, Test loss: 1.611, Test accuracy: 68.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.108, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.300, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.650, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.923, Test accuracy: 64.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.146, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.288, Test accuracy: 72.40 

Round  14, Train loss: 0.006, Test loss: 1.553, Test accuracy: 69.07 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.033, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.454, Test accuracy: 66.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.689, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.215, Train accuracy: 92.400, Test loss: 2.715, Test accuracy: 57.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.107, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.480, Test accuracy: 73.40 

Round  15, Train loss: 0.074, Test loss: 1.696, Test accuracy: 67.73 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.164, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.297, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.793, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.777, Test accuracy: 68.60 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.209, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.055, Train accuracy: 97.800, Test loss: 1.595, Test accuracy: 71.00 

Round  16, Train loss: 0.019, Test loss: 1.647, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.106, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.280, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.656, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.876, Test accuracy: 65.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.400, Test loss: 1.667, Test accuracy: 71.20 

Round  17, Train loss: 0.015, Test loss: 1.639, Test accuracy: 69.13 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.079, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.592, Test accuracy: 61.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.736, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 98.800, Test loss: 2.466, Test accuracy: 62.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.369, Test accuracy: 73.40 

Round  18, Train loss: 0.013, Test loss: 1.731, Test accuracy: 69.07 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 2.234, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 2.680, Test accuracy: 58.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.759, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 2.356, Test accuracy: 62.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.239, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.308, Test accuracy: 73.00 

Round  19, Train loss: 0.010, Test loss: 1.772, Test accuracy: 66.73 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.175, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.174, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.871, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.871, Test accuracy: 66.40 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.193, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.204, Test accuracy: 74.20 

Final Round, Train loss: 0.003, Test loss: 1.751, Test accuracy: 67.47 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.069, Train accuracy: 97.400, Test loss: 1.781, Test accuracy: 64.40 

        train local model (freeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.600, Test loss: 1.797, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 2.235, Test accuracy: 61.60 

        train local model (freeze embeding):client   1,  Train loss: 0.035, Train accuracy: 98.600, Test loss: 1.613, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.798, Test accuracy: 68.00 

        train local model (freeze embeding):client   2,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.032, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 73.20 

        train local model (freeze embeding):client   3,  Train loss: 0.092, Train accuracy: 97.400, Test loss: 1.247, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.089, Train accuracy: 97.000, Test loss: 1.538, Test accuracy: 69.00 

Round   0, Train loss: 0.029, Test loss: 1.323, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.769, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.072, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.462, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.626, Test accuracy: 68.40 

        train local model (freeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 0.929, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.259, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.144, Train accuracy: 95.200, Test loss: 1.263, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.144, Train accuracy: 96.200, Test loss: 1.558, Test accuracy: 67.40 

Round   1, Train loss: 0.039, Test loss: 1.281, Test accuracy: 71.75 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.711, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.210, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.365, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.726, Test accuracy: 69.20 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 0.987, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.059, Train accuracy: 96.800, Test loss: 1.582, Test accuracy: 70.00 

        train local model (freeze embeding):client   3,  Train loss: 0.079, Train accuracy: 97.400, Test loss: 1.160, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.092, Train accuracy: 96.000, Test loss: 1.416, Test accuracy: 67.60 

Round   2, Train loss: 0.039, Test loss: 1.354, Test accuracy: 71.20 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.818, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.236, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.371, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.802, Test accuracy: 67.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.992, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.040, Train accuracy: 98.000, Test loss: 1.691, Test accuracy: 69.60 

        train local model (freeze embeding):client   3,  Train loss: 0.065, Train accuracy: 97.400, Test loss: 1.144, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.190, Train accuracy: 94.200, Test loss: 2.097, Test accuracy: 60.60 

Round   3, Train loss: 0.061, Test loss: 1.345, Test accuracy: 71.25 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.815, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 2.241, Test accuracy: 63.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.452, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.834, Test accuracy: 66.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.284, Test accuracy: 73.60 

        train local model (freeze embeding):client   3,  Train loss: 0.046, Train accuracy: 99.000, Test loss: 1.245, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.088, Train accuracy: 97.400, Test loss: 1.494, Test accuracy: 68.20 

Round   4, Train loss: 0.032, Test loss: 1.350, Test accuracy: 71.85 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.832, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.125, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.417, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.034, Train accuracy: 98.400, Test loss: 1.918, Test accuracy: 65.20 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.014, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.433, Test accuracy: 70.40 

        train local model (freeze embeding):client   3,  Train loss: 0.049, Train accuracy: 98.800, Test loss: 1.269, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.153, Train accuracy: 95.000, Test loss: 1.865, Test accuracy: 62.80 

Round   5, Train loss: 0.049, Test loss: 1.404, Test accuracy: 71.10 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.872, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.326, Test accuracy: 59.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.415, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.881, Test accuracy: 68.60 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.058, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.298, Test accuracy: 72.40 

        train local model (freeze embeding):client   3,  Train loss: 0.024, Train accuracy: 99.800, Test loss: 1.283, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.145, Train accuracy: 94.800, Test loss: 1.596, Test accuracy: 65.60 

Round   6, Train loss: 0.041, Test loss: 1.402, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.877, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 2.332, Test accuracy: 61.40 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.578, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 2.023, Test accuracy: 62.60 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.200, Test loss: 1.330, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.319, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.278, Train accuracy: 91.800, Test loss: 2.212, Test accuracy: 63.80 

Round   7, Train loss: 0.083, Test loss: 1.477, Test accuracy: 70.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.926, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.094, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.648, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.200, Test loss: 2.028, Test accuracy: 64.20 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.041, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.200, Test loss: 1.425, Test accuracy: 70.80 

        train local model (freeze embeding):client   3,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.333, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.145, Train accuracy: 94.400, Test loss: 1.664, Test accuracy: 66.20 

Round   8, Train loss: 0.046, Test loss: 1.442, Test accuracy: 70.50 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.915, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 2.372, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.552, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.871, Test accuracy: 64.40 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.049, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 1.356, Test accuracy: 73.20 

        train local model (freeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 1.294, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.475, Test accuracy: 69.00 

Round   9, Train loss: 0.014, Test loss: 1.403, Test accuracy: 71.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.909, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.470, Test accuracy: 61.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.527, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.653, Test accuracy: 69.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.075, Train accuracy: 97.400, Test loss: 1.692, Test accuracy: 70.80 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.329, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.489, Test accuracy: 69.00 

Round  10, Train loss: 0.027, Test loss: 1.463, Test accuracy: 70.50 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.924, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.454, Test accuracy: 60.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.550, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.706, Test accuracy: 69.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.456, Test accuracy: 73.60 

        train local model (freeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.360, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.699, Test accuracy: 65.80 

Round  11, Train loss: 0.014, Test loss: 1.441, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.600, Test loss: 1.906, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.251, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.487, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 1.983, Test accuracy: 67.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.052, Train accuracy: 98.200, Test loss: 1.693, Test accuracy: 69.20 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.433, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.053, Train accuracy: 98.200, Test loss: 1.801, Test accuracy: 68.40 

Round  12, Train loss: 0.034, Test loss: 1.446, Test accuracy: 71.95 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.887, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 2.719, Test accuracy: 59.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.556, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.033, Train accuracy: 98.800, Test loss: 1.930, Test accuracy: 66.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.408, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.356, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.520, Test accuracy: 67.80 

Round  13, Train loss: 0.019, Test loss: 1.460, Test accuracy: 71.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.907, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.075, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.511, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.139, Train accuracy: 95.400, Test loss: 2.486, Test accuracy: 62.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.045, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.085, Train accuracy: 96.400, Test loss: 1.664, Test accuracy: 71.80 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.373, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.030, Train accuracy: 99.400, Test loss: 1.713, Test accuracy: 66.60 

Round  14, Train loss: 0.063, Test loss: 1.468, Test accuracy: 71.15 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.806, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.351, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.511, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.618, Test accuracy: 71.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.150, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.376, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.445, Train accuracy: 87.800, Test loss: 2.738, Test accuracy: 55.00 

Round  15, Train loss: 0.112, Test loss: 1.467, Test accuracy: 71.55 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.847, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.185, Test accuracy: 64.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.515, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.039, Train accuracy: 98.800, Test loss: 1.970, Test accuracy: 63.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.039, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.305, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.378, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.788, Test accuracy: 68.60 

Round  16, Train loss: 0.015, Test loss: 1.463, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.940, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 2.324, Test accuracy: 60.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.551, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 2.086, Test accuracy: 68.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.177, Test accuracy: 76.20 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.485, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.611, Test accuracy: 69.00 

Round  17, Train loss: 0.012, Test loss: 1.445, Test accuracy: 71.90 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.893, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.253, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.549, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.056, Train accuracy: 97.400, Test loss: 2.350, Test accuracy: 63.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.239, Test accuracy: 76.40 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.069, Train accuracy: 97.600, Test loss: 1.767, Test accuracy: 69.80 

Round  18, Train loss: 0.032, Test loss: 1.424, Test accuracy: 73.05 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.967, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.116, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.462, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.706, Test accuracy: 70.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.406, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.410, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.500, Test accuracy: 70.60 

Round  19, Train loss: 0.007, Test loss: 1.454, Test accuracy: 72.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.925, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.923, Test accuracy: 67.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.478, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.498, Test accuracy: 72.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 77.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.461, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.494, Test accuracy: 71.40 

Final Round, Train loss: 0.002, Test loss: 1.475, Test accuracy: 72.35 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.512, Test accuracy: 68.80 

        train local model (freeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.600, Test loss: 1.581, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 2.262, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 1.395, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.040, Train accuracy: 98.600, Test loss: 1.953, Test accuracy: 66.80 

        train local model (freeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.041, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.429, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.085, Train accuracy: 97.400, Test loss: 1.223, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.046, Train accuracy: 99.000, Test loss: 1.460, Test accuracy: 67.20 

        train local model (freeze embeding):client   4,  Train loss: 0.081, Train accuracy: 96.000, Test loss: 1.361, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.118, Train accuracy: 96.600, Test loss: 1.382, Test accuracy: 68.40 

Round   0, Train loss: 0.048, Test loss: 1.290, Test accuracy: 72.04 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.657, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.078, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.348, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.786, Test accuracy: 66.80 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.002, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 75.80 

        train local model (freeze embeding):client   3,  Train loss: 0.027, Train accuracy: 99.400, Test loss: 1.244, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.030, Train accuracy: 99.200, Test loss: 1.374, Test accuracy: 70.60 

        train local model (freeze embeding):client   4,  Train loss: 0.132, Train accuracy: 96.200, Test loss: 1.305, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.108, Train accuracy: 96.000, Test loss: 1.876, Test accuracy: 66.80 

Round   1, Train loss: 0.030, Test loss: 1.264, Test accuracy: 73.24 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.495, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.743, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.352, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.560, Test accuracy: 69.00 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 0.960, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.388, Test accuracy: 73.40 

        train local model (freeze embeding):client   3,  Train loss: 0.027, Train accuracy: 99.800, Test loss: 1.158, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.042, Train accuracy: 98.800, Test loss: 1.763, Test accuracy: 68.60 

        train local model (freeze embeding):client   4,  Train loss: 0.106, Train accuracy: 97.000, Test loss: 1.250, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.055, Train accuracy: 98.400, Test loss: 1.522, Test accuracy: 67.20 

Round   2, Train loss: 0.022, Test loss: 1.240, Test accuracy: 73.68 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.883, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.344, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.489, Test accuracy: 73.20 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.907, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.139, Test accuracy: 75.60 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.198, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.607, Test accuracy: 65.40 

        train local model (freeze embeding):client   4,  Train loss: 0.073, Train accuracy: 97.600, Test loss: 1.126, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.061, Train accuracy: 98.800, Test loss: 1.475, Test accuracy: 69.80 

Round   3, Train loss: 0.017, Test loss: 1.233, Test accuracy: 73.96 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.490, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.388, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.434, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.569, Test accuracy: 71.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.943, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.400, Test loss: 1.444, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.270, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.080, Train accuracy: 97.400, Test loss: 1.733, Test accuracy: 64.80 

        train local model (freeze embeding):client   4,  Train loss: 0.056, Train accuracy: 98.600, Test loss: 1.154, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.092, Train accuracy: 97.000, Test loss: 1.548, Test accuracy: 69.00 

Round   4, Train loss: 0.040, Test loss: 1.306, Test accuracy: 73.52 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.655, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.913, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.367, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.789, Test accuracy: 68.60 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.985, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.333, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.281, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.053, Train accuracy: 98.200, Test loss: 1.694, Test accuracy: 65.60 

        train local model (freeze embeding):client   4,  Train loss: 0.060, Train accuracy: 98.200, Test loss: 1.211, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.072, Train accuracy: 97.400, Test loss: 1.449, Test accuracy: 67.20 

Round   5, Train loss: 0.031, Test loss: 1.259, Test accuracy: 72.96 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.683, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.974, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.488, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.713, Test accuracy: 68.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.970, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.253, Test accuracy: 75.60 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.234, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.541, Test accuracy: 69.00 

        train local model (freeze embeding):client   4,  Train loss: 0.047, Train accuracy: 98.800, Test loss: 1.184, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.063, Train accuracy: 98.200, Test loss: 1.565, Test accuracy: 65.80 

Round   6, Train loss: 0.017, Test loss: 1.291, Test accuracy: 72.64 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.519, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.097, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.370, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.693, Test accuracy: 69.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.000, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.182, Test accuracy: 75.60 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.052, Train accuracy: 98.200, Test loss: 1.664, Test accuracy: 67.80 

        train local model (freeze embeding):client   4,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 1.175, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.842, Test accuracy: 66.80 

Round   7, Train loss: 0.020, Test loss: 1.298, Test accuracy: 72.64 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.574, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.217, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.416, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.657, Test accuracy: 71.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.974, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.139, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.273, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.693, Test accuracy: 69.80 

        train local model (freeze embeding):client   4,  Train loss: 0.020, Train accuracy: 99.800, Test loss: 1.204, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.046, Train accuracy: 98.600, Test loss: 1.444, Test accuracy: 69.20 

Round   8, Train loss: 0.014, Test loss: 1.319, Test accuracy: 72.84 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.632, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.963, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.450, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.646, Test accuracy: 70.80 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.958, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.327, Test accuracy: 73.40 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.321, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 68.60 

        train local model (freeze embeding):client   4,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.030, Train accuracy: 99.200, Test loss: 1.638, Test accuracy: 68.80 

Round   9, Train loss: 0.011, Test loss: 1.312, Test accuracy: 73.36 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.662, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 2.365, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.409, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.840, Test accuracy: 68.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.052, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.032, Train accuracy: 99.200, Test loss: 1.380, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.309, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.422, Test accuracy: 69.80 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.187, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.038, Train accuracy: 98.800, Test loss: 1.759, Test accuracy: 69.60 

Round  10, Train loss: 0.023, Test loss: 1.331, Test accuracy: 73.92 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.606, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.117, Test accuracy: 67.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.425, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.609, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.223, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.383, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.028, Train accuracy: 99.400, Test loss: 1.691, Test accuracy: 69.80 

        train local model (freeze embeding):client   4,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.277, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.428, Test accuracy: 68.80 

Round  11, Train loss: 0.011, Test loss: 1.360, Test accuracy: 72.56 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.628, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.968, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.441, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.522, Test accuracy: 72.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.991, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.117, Test accuracy: 76.20 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.298, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.050, Train accuracy: 98.000, Test loss: 1.839, Test accuracy: 68.80 

        train local model (freeze embeding):client   4,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.129, Train accuracy: 96.400, Test loss: 1.872, Test accuracy: 60.40 

Round  12, Train loss: 0.036, Test loss: 1.328, Test accuracy: 73.52 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.621, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.944, Test accuracy: 67.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.479, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.621, Test accuracy: 72.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.986, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.413, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.745, Test accuracy: 69.00 

        train local model (freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.247, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.828, Test accuracy: 67.80 

Round  13, Train loss: 0.006, Test loss: 1.356, Test accuracy: 73.48 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.681, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 2.252, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.451, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.400, Test loss: 1.754, Test accuracy: 70.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.970, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 74.60 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.383, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.411, Test accuracy: 71.40 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.073, Train accuracy: 97.600, Test loss: 1.656, Test accuracy: 68.20 

Round  14, Train loss: 0.025, Test loss: 1.356, Test accuracy: 73.76 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.717, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.600, Test loss: 2.295, Test accuracy: 62.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.422, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.044, Train accuracy: 98.400, Test loss: 1.951, Test accuracy: 67.60 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.043, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.155, Train accuracy: 94.600, Test loss: 2.144, Test accuracy: 65.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.411, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.537, Test accuracy: 71.00 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.230, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.178, Train accuracy: 94.000, Test loss: 2.003, Test accuracy: 62.80 

Round  15, Train loss: 0.077, Test loss: 1.358, Test accuracy: 73.72 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.766, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.084, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.475, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.869, Test accuracy: 68.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.159, Test accuracy: 77.40 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.427, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.056, Train accuracy: 98.600, Test loss: 1.823, Test accuracy: 70.00 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.375, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.500, Test accuracy: 69.00 

Round  16, Train loss: 0.013, Test loss: 1.377, Test accuracy: 72.68 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.706, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.293, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.464, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.639, Test accuracy: 70.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.254, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.403, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.470, Test accuracy: 73.20 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.304, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.435, Test accuracy: 71.80 

Round  17, Train loss: 0.001, Test loss: 1.368, Test accuracy: 73.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.708, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.951, Test accuracy: 67.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.503, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.590, Test accuracy: 72.20 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.986, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.413, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.478, Test accuracy: 72.80 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.317, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 1.831, Test accuracy: 69.20 

Round  18, Train loss: 0.004, Test loss: 1.407, Test accuracy: 73.36 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.687, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.056, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.034, Train accuracy: 99.200, Test loss: 2.162, Test accuracy: 67.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.013, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.219, Test accuracy: 74.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.460, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.039, Train accuracy: 98.800, Test loss: 1.799, Test accuracy: 71.40 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.330, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.282, Train accuracy: 91.400, Test loss: 2.624, Test accuracy: 63.20 

Round  19, Train loss: 0.071, Test loss: 1.427, Test accuracy: 73.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.750, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.790, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.524, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.522, Test accuracy: 74.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.992, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 77.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 72.80 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.333, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.382, Test accuracy: 72.20 

Final Round, Train loss: 0.002, Test loss: 1.430, Test accuracy: 73.36 

Average accuracy final 10 rounds: 332.96799999999996 

3512.728499174118
[10.58631157875061, 21.025413513183594, 31.221267461776733, 41.599037647247314, 52.22657322883606, 63.040133237838745, 73.3872902393341, 83.96080493927002, 94.1544942855835, 104.5920512676239, 115.09221696853638, 125.65804982185364, 136.13758301734924, 146.6831316947937, 156.91012001037598, 167.13246774673462, 177.65835165977478, 188.17254066467285, 199.14077401161194, 209.6452829837799, 218.51543879508972, 228.9323766231537, 239.49394583702087, 251.65461444854736, 262.72286319732666, 273.6493401527405, 284.96699261665344, 297.5243525505066, 308.1965310573578, 318.84712743759155, 331.0928554534912, 343.02235412597656, 353.45950078964233, 364.59824204444885, 375.1108374595642, 385.953177690506, 396.47601342201233, 407.0100209712982, 417.5755295753479, 428.5483558177948, 439.2464921474457, 446.80437898635864, 457.41107869148254, 467.92704343795776, 478.56525683403015, 489.16242575645447, 499.7611322402954, 510.6277859210968, 521.2622215747833, 532.2149474620819, 543.8105249404907, 554.5247802734375, 566.6481556892395, 578.3656947612762, 588.8123624324799, 599.9932200908661, 610.4086546897888, 620.8362040519714, 631.3483667373657, 642.2248725891113, 653.1442708969116, 663.841677904129, 671.5901198387146, 682.3234589099884, 692.74684882164, 703.1586940288544, 713.6141724586487, 724.3371727466583, 734.6996850967407, 745.1738867759705, 756.7214102745056, 768.6531758308411, 779.4623005390167, 790.26744556427, 801.8480520248413, 812.3135814666748, 824.1009874343872, 834.7943198680878, 845.2260537147522, 855.757217168808, 867.1045453548431, 876.3281035423279, 886.1109294891357, 891.7488176822662, 901.9443964958191, 913.7019593715668, 924.5752801895142, 935.4302704334259, 946.2834897041321, 956.4702954292297, 967.4720432758331, 978.491064786911, 989.355751991272, 999.4786193370819, 1009.217027425766, 1019.3282778263092, 1029.0640590190887, 1038.8038747310638, 1048.5889048576355, 1058.1431102752686, 1068.0232000350952, 1077.6760640144348, 1087.0669164657593, 1096.6193838119507, 1102.7668645381927]
[50.6, 54.8, 46.8, 53.0, 52.0, 52.4, 52.6, 55.0, 52.4, 53.0, 57.4, 55.8, 55.8, 48.4, 53.0, 56.2, 59.4, 61.0, 57.8, 51.6, 54.4, 61.7, 62.5, 63.4, 61.9, 60.5, 63.9, 62.5, 62.2, 64.5, 62.3, 63.3, 62.9, 62.4, 62.5, 63.1, 64.5, 64.9, 64.1, 64.5, 63.9, 64.0, 65.86666666666666, 68.73333333333333, 68.26666666666667, 68.66666666666667, 68.0, 68.13333333333334, 66.46666666666667, 68.06666666666666, 69.26666666666667, 68.13333333333334, 67.53333333333333, 69.33333333333333, 68.93333333333334, 68.66666666666667, 69.06666666666666, 67.73333333333333, 69.4, 69.13333333333334, 69.06666666666666, 66.73333333333333, 67.46666666666667, 71.0, 71.75, 71.2, 71.25, 71.85, 71.1, 71.5, 70.5, 70.5, 71.2, 70.5, 72.0, 71.95, 71.1, 71.15, 71.55, 72.0, 71.9, 73.05, 72.3, 72.35, 72.04, 73.24, 73.68, 73.96, 73.52, 72.96, 72.64, 72.64, 72.84, 73.36, 73.92, 72.56, 73.52, 73.48, 73.76, 73.72, 72.68, 73.2, 73.36, 73.88, 73.36]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.500, Test loss: 1.449, Test accuracy: 48.00 

Round   0, Global train loss: 1.500, Global test loss: 2.317, Global test accuracy: 18.84 

Round   1, Train loss: 1.187, Test loss: 1.325, Test accuracy: 52.84 

Round   1, Global train loss: 1.187, Global test loss: 2.385, Global test accuracy: 20.00 

Round   2, Train loss: 1.010, Test loss: 1.376, Test accuracy: 53.56 

Round   2, Global train loss: 1.010, Global test loss: 2.373, Global test accuracy: 12.08 

Round   3, Train loss: 0.866, Test loss: 1.314, Test accuracy: 57.32 

Round   3, Global train loss: 0.866, Global test loss: 2.251, Global test accuracy: 13.92 

Round   4, Train loss: 0.751, Test loss: 1.333, Test accuracy: 57.96 

Round   4, Global train loss: 0.751, Global test loss: 2.345, Global test accuracy: 12.52 

Round   5, Train loss: 0.661, Test loss: 1.554, Test accuracy: 57.52 

Round   5, Global train loss: 0.661, Global test loss: 2.382, Global test accuracy: 12.08 

Round   6, Train loss: 0.553, Test loss: 1.503, Test accuracy: 59.72 

Round   6, Global train loss: 0.553, Global test loss: 2.416, Global test accuracy: 12.36 

Round   7, Train loss: 0.468, Test loss: 1.475, Test accuracy: 61.44 

Round   7, Global train loss: 0.468, Global test loss: 2.510, Global test accuracy: 12.08 

Round   8, Train loss: 0.418, Test loss: 1.448, Test accuracy: 61.72 

Round   8, Global train loss: 0.418, Global test loss: 2.535, Global test accuracy: 12.08 

Round   9, Train loss: 0.346, Test loss: 1.622, Test accuracy: 60.32 

Round   9, Global train loss: 0.346, Global test loss: 2.586, Global test accuracy: 12.20 

Round  10, Train loss: 0.278, Test loss: 1.589, Test accuracy: 63.56 

Round  10, Global train loss: 0.278, Global test loss: 2.468, Global test accuracy: 12.08 

Round  11, Train loss: 0.248, Test loss: 1.948, Test accuracy: 61.28 

Round  11, Global train loss: 0.248, Global test loss: 2.512, Global test accuracy: 12.00 

Round  12, Train loss: 0.206, Test loss: 1.774, Test accuracy: 63.04 

Round  12, Global train loss: 0.206, Global test loss: 2.548, Global test accuracy: 12.04 

Round  13, Train loss: 0.176, Test loss: 1.837, Test accuracy: 61.68 

Round  13, Global train loss: 0.176, Global test loss: 2.470, Global test accuracy: 12.04 

Round  14, Train loss: 0.154, Test loss: 1.676, Test accuracy: 65.08 

Round  14, Global train loss: 0.154, Global test loss: 2.552, Global test accuracy: 12.00 

Round  15, Train loss: 0.137, Test loss: 1.747, Test accuracy: 64.16 

Round  15, Global train loss: 0.137, Global test loss: 2.545, Global test accuracy: 12.08 

Round  16, Train loss: 0.113, Test loss: 1.820, Test accuracy: 65.52 

Round  16, Global train loss: 0.113, Global test loss: 2.600, Global test accuracy: 12.04 

Round  17, Train loss: 0.130, Test loss: 1.950, Test accuracy: 62.32 

Round  17, Global train loss: 0.130, Global test loss: 2.650, Global test accuracy: 12.00 

Round  18, Train loss: 0.099, Test loss: 1.796, Test accuracy: 65.08 

Round  18, Global train loss: 0.099, Global test loss: 2.625, Global test accuracy: 12.04 

Round  19, Train loss: 0.079, Test loss: 1.767, Test accuracy: 65.12 

Round  19, Global train loss: 0.079, Global test loss: 2.559, Global test accuracy: 12.08 

Round  20, Train loss: 0.068, Test loss: 1.814, Test accuracy: 66.56 

Round  20, Global train loss: 0.068, Global test loss: 2.619, Global test accuracy: 12.04 

Round  21, Train loss: 0.068, Test loss: 1.803, Test accuracy: 65.40 

Round  21, Global train loss: 0.068, Global test loss: 2.553, Global test accuracy: 12.04 

Round  22, Train loss: 0.064, Test loss: 1.875, Test accuracy: 65.28 

Round  22, Global train loss: 0.064, Global test loss: 2.547, Global test accuracy: 12.08 

Round  23, Train loss: 0.052, Test loss: 1.961, Test accuracy: 64.96 

Round  23, Global train loss: 0.052, Global test loss: 2.567, Global test accuracy: 12.08 

Round  24, Train loss: 0.066, Test loss: 1.774, Test accuracy: 66.72 

Round  24, Global train loss: 0.066, Global test loss: 2.519, Global test accuracy: 12.08 

Round  25, Train loss: 0.039, Test loss: 1.838, Test accuracy: 66.88 

Round  25, Global train loss: 0.039, Global test loss: 2.620, Global test accuracy: 12.04 

Round  26, Train loss: 0.035, Test loss: 1.905, Test accuracy: 66.64 

Round  26, Global train loss: 0.035, Global test loss: 2.597, Global test accuracy: 12.08 

Round  27, Train loss: 0.031, Test loss: 2.068, Test accuracy: 65.24 

Round  27, Global train loss: 0.031, Global test loss: 2.563, Global test accuracy: 12.08 

Round  28, Train loss: 0.030, Test loss: 1.985, Test accuracy: 66.72 

Round  28, Global train loss: 0.030, Global test loss: 2.594, Global test accuracy: 12.04 

Round  29, Train loss: 0.024, Test loss: 1.976, Test accuracy: 67.28 

Round  29, Global train loss: 0.024, Global test loss: 2.644, Global test accuracy: 12.08 

Round  30, Train loss: 0.021, Test loss: 1.937, Test accuracy: 66.44 

Round  30, Global train loss: 0.021, Global test loss: 2.638, Global test accuracy: 12.04 

Round  31, Train loss: 0.022, Test loss: 1.940, Test accuracy: 66.76 

Round  31, Global train loss: 0.022, Global test loss: 2.602, Global test accuracy: 12.08 

Round  32, Train loss: 0.024, Test loss: 2.060, Test accuracy: 65.88 

Round  32, Global train loss: 0.024, Global test loss: 2.619, Global test accuracy: 12.08 

Round  33, Train loss: 0.031, Test loss: 2.056, Test accuracy: 65.96 

Round  33, Global train loss: 0.031, Global test loss: 2.624, Global test accuracy: 12.04 

Round  34, Train loss: 0.039, Test loss: 2.023, Test accuracy: 66.28 

Round  34, Global train loss: 0.039, Global test loss: 2.593, Global test accuracy: 12.08 

Final Round, Train loss: 0.031, Test loss: 2.000, Test accuracy: 66.28 

Final Round, Global train loss: 0.031, Global test loss: 2.593, Global test accuracy: 12.08 

Average accuracy final 10 rounds: 66.40799999999999 

Average global accuracy final 10 rounds: 12.064 

1209.1270637512207
[7.967828750610352, 13.751991510391235, 19.509774684906006, 25.23245930671692, 30.835203409194946, 36.562501192092896, 42.43027448654175, 48.02550554275513, 53.59467673301697, 59.184534549713135, 64.88433647155762, 70.67627882957458, 76.42993807792664, 82.08505010604858, 87.67513823509216, 93.3083245754242, 98.95494937896729, 104.55148649215698, 111.12516140937805, 117.8016414642334, 124.18390154838562, 130.57329773902893, 137.47082257270813, 143.48210263252258, 150.0331437587738, 156.93749833106995, 163.7829647064209, 170.1255660057068, 176.07840657234192, 181.88598132133484, 188.01242232322693, 193.87657499313354, 200.1233959197998, 205.96821641921997, 211.7184910774231, 223.22002720832825]
[48.0, 52.84, 53.56, 57.32, 57.96, 57.52, 59.72, 61.44, 61.72, 60.32, 63.56, 61.28, 63.04, 61.68, 65.08, 64.16, 65.52, 62.32, 65.08, 65.12, 66.56, 65.4, 65.28, 64.96, 66.72, 66.88, 66.64, 65.24, 66.72, 67.28, 66.44, 66.76, 65.88, 65.96, 66.28, 66.28]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.483, Test loss: 1.424, Test accuracy: 46.52 

Round   0, Global train loss: 1.483, Global test loss: 2.278, Global test accuracy: 23.80 

Round   1, Train loss: 1.377, Test loss: 1.374, Test accuracy: 49.88 

Round   1, Global train loss: 1.377, Global test loss: 2.021, Global test accuracy: 30.60 

Round   2, Train loss: 1.236, Test loss: 1.217, Test accuracy: 55.20 

Round   2, Global train loss: 1.236, Global test loss: 1.691, Global test accuracy: 43.24 

Round   3, Train loss: 1.114, Test loss: 1.222, Test accuracy: 57.32 

Round   3, Global train loss: 1.114, Global test loss: 1.586, Global test accuracy: 47.40 

Round   4, Train loss: 1.014, Test loss: 1.174, Test accuracy: 58.52 

Round   4, Global train loss: 1.014, Global test loss: 1.520, Global test accuracy: 49.44 

Round   5, Train loss: 0.928, Test loss: 1.135, Test accuracy: 60.48 

Round   5, Global train loss: 0.928, Global test loss: 1.398, Global test accuracy: 53.64 

Round   6, Train loss: 0.869, Test loss: 1.124, Test accuracy: 61.60 

Round   6, Global train loss: 0.869, Global test loss: 1.392, Global test accuracy: 54.40 

Round   7, Train loss: 0.813, Test loss: 1.139, Test accuracy: 63.92 

Round   7, Global train loss: 0.813, Global test loss: 1.277, Global test accuracy: 58.28 

Round   8, Train loss: 0.735, Test loss: 1.244, Test accuracy: 59.68 

Round   8, Global train loss: 0.735, Global test loss: 1.270, Global test accuracy: 58.32 

Round   9, Train loss: 0.685, Test loss: 1.188, Test accuracy: 64.52 

Round   9, Global train loss: 0.685, Global test loss: 1.308, Global test accuracy: 58.92 

Round  10, Train loss: 0.629, Test loss: 1.122, Test accuracy: 65.76 

Round  10, Global train loss: 0.629, Global test loss: 1.299, Global test accuracy: 59.52 

Round  11, Train loss: 0.585, Test loss: 1.174, Test accuracy: 64.56 

Round  11, Global train loss: 0.585, Global test loss: 1.190, Global test accuracy: 62.48 

Round  12, Train loss: 0.554, Test loss: 1.258, Test accuracy: 63.44 

Round  12, Global train loss: 0.554, Global test loss: 1.208, Global test accuracy: 62.08 

Round  13, Train loss: 0.511, Test loss: 1.253, Test accuracy: 64.84 

Round  13, Global train loss: 0.511, Global test loss: 1.139, Global test accuracy: 63.04 

Round  14, Train loss: 0.470, Test loss: 1.104, Test accuracy: 68.16 

Round  14, Global train loss: 0.470, Global test loss: 1.135, Global test accuracy: 64.40 

Round  15, Train loss: 0.444, Test loss: 1.386, Test accuracy: 65.84 

Round  15, Global train loss: 0.444, Global test loss: 1.140, Global test accuracy: 65.00 

Round  16, Train loss: 0.415, Test loss: 1.083, Test accuracy: 69.92 

Round  16, Global train loss: 0.415, Global test loss: 1.124, Global test accuracy: 65.08 

Round  17, Train loss: 0.378, Test loss: 1.208, Test accuracy: 68.20 

Round  17, Global train loss: 0.378, Global test loss: 1.169, Global test accuracy: 65.40 

Round  18, Train loss: 0.358, Test loss: 1.226, Test accuracy: 68.88 

Round  18, Global train loss: 0.358, Global test loss: 1.124, Global test accuracy: 65.44 

Round  19, Train loss: 0.342, Test loss: 1.509, Test accuracy: 68.04 

Round  19, Global train loss: 0.342, Global test loss: 1.068, Global test accuracy: 67.68 

Round  20, Train loss: 0.323, Test loss: 1.192, Test accuracy: 68.48 

Round  20, Global train loss: 0.323, Global test loss: 1.093, Global test accuracy: 66.80 

Round  21, Train loss: 0.295, Test loss: 1.332, Test accuracy: 69.48 

Round  21, Global train loss: 0.295, Global test loss: 1.199, Global test accuracy: 65.96 

Round  22, Train loss: 0.273, Test loss: 1.169, Test accuracy: 70.44 

Round  22, Global train loss: 0.273, Global test loss: 1.116, Global test accuracy: 68.24 

Round  23, Train loss: 0.263, Test loss: 1.135, Test accuracy: 72.00 

Round  23, Global train loss: 0.263, Global test loss: 1.144, Global test accuracy: 67.84 

Round  24, Train loss: 0.229, Test loss: 1.144, Test accuracy: 72.92 

Round  24, Global train loss: 0.229, Global test loss: 1.071, Global test accuracy: 69.12 

Round  25, Train loss: 0.250, Test loss: 1.073, Test accuracy: 72.88 

Round  25, Global train loss: 0.250, Global test loss: 1.072, Global test accuracy: 69.64 

Round  26, Train loss: 0.198, Test loss: 1.117, Test accuracy: 72.48 

Round  26, Global train loss: 0.198, Global test loss: 1.109, Global test accuracy: 69.12 

Round  27, Train loss: 0.197, Test loss: 1.176, Test accuracy: 73.12 

Round  27, Global train loss: 0.197, Global test loss: 1.118, Global test accuracy: 69.52 

Round  28, Train loss: 0.188, Test loss: 1.278, Test accuracy: 71.76 

Round  28, Global train loss: 0.188, Global test loss: 1.130, Global test accuracy: 68.44 

Round  29, Train loss: 0.186, Test loss: 1.103, Test accuracy: 73.64 

Round  29, Global train loss: 0.186, Global test loss: 1.101, Global test accuracy: 69.16 

Round  30, Train loss: 0.158, Test loss: 1.252, Test accuracy: 72.48 

Round  30, Global train loss: 0.158, Global test loss: 1.096, Global test accuracy: 70.56 

Round  31, Train loss: 0.153, Test loss: 1.205, Test accuracy: 74.00 

Round  31, Global train loss: 0.153, Global test loss: 1.103, Global test accuracy: 69.88 

Round  32, Train loss: 0.132, Test loss: 1.261, Test accuracy: 73.40 

Round  32, Global train loss: 0.132, Global test loss: 1.086, Global test accuracy: 70.32 

Round  33, Train loss: 0.134, Test loss: 1.281, Test accuracy: 71.96 

Round  33, Global train loss: 0.134, Global test loss: 1.159, Global test accuracy: 69.24 

Round  34, Train loss: 0.130, Test loss: 1.430, Test accuracy: 70.56 

Round  34, Global train loss: 0.130, Global test loss: 1.115, Global test accuracy: 71.32 

Round  35, Train loss: 0.122, Test loss: 1.396, Test accuracy: 72.52 

Round  35, Global train loss: 0.122, Global test loss: 1.136, Global test accuracy: 70.04 

Round  36, Train loss: 0.123, Test loss: 1.224, Test accuracy: 73.92 

Round  36, Global train loss: 0.123, Global test loss: 1.086, Global test accuracy: 70.92 

Round  37, Train loss: 0.104, Test loss: 1.240, Test accuracy: 73.68 

Round  37, Global train loss: 0.104, Global test loss: 1.116, Global test accuracy: 70.80 

Round  38, Train loss: 0.099, Test loss: 1.234, Test accuracy: 74.36 

Round  38, Global train loss: 0.099, Global test loss: 1.105, Global test accuracy: 71.44 

Round  39, Train loss: 0.109, Test loss: 1.395, Test accuracy: 71.36 

Round  39, Global train loss: 0.109, Global test loss: 1.240, Global test accuracy: 68.44 

Round  40, Train loss: 0.098, Test loss: 1.214, Test accuracy: 74.88 

Round  40, Global train loss: 0.098, Global test loss: 1.198, Global test accuracy: 70.32 

Round  41, Train loss: 0.076, Test loss: 1.213, Test accuracy: 74.84 

Round  41, Global train loss: 0.076, Global test loss: 1.123, Global test accuracy: 71.56 

Round  42, Train loss: 0.065, Test loss: 1.184, Test accuracy: 75.80 

Round  42, Global train loss: 0.065, Global test loss: 1.153, Global test accuracy: 70.96 

Round  43, Train loss: 0.097, Test loss: 1.415, Test accuracy: 71.60 

Round  43, Global train loss: 0.097, Global test loss: 1.228, Global test accuracy: 69.12 

Round  44, Train loss: 0.082, Test loss: 1.333, Test accuracy: 73.28 

Round  44, Global train loss: 0.082, Global test loss: 1.142, Global test accuracy: 71.04 

Round  45, Train loss: 0.071, Test loss: 1.405, Test accuracy: 74.44 

Round  45, Global train loss: 0.071, Global test loss: 1.218, Global test accuracy: 69.88 

Round  46, Train loss: 0.059, Test loss: 1.304, Test accuracy: 74.88 

Round  46, Global train loss: 0.059, Global test loss: 1.151, Global test accuracy: 70.88 

Round  47, Train loss: 0.080, Test loss: 1.394, Test accuracy: 73.24 

Round  47, Global train loss: 0.080, Global test loss: 1.178, Global test accuracy: 70.52 

Round  48, Train loss: 0.049, Test loss: 1.550, Test accuracy: 72.68 

Round  48, Global train loss: 0.049, Global test loss: 1.237, Global test accuracy: 70.68 

Round  49, Train loss: 0.058, Test loss: 1.200, Test accuracy: 74.88 

Round  49, Global train loss: 0.058, Global test loss: 1.162, Global test accuracy: 70.60 

Final Round, Train loss: 0.072, Test loss: 1.359, Test accuracy: 73.20 

Final Round, Global train loss: 0.072, Global test loss: 1.162, Global test accuracy: 70.60 

Average accuracy final 10 rounds: 74.05199999999999 

Average global accuracy final 10 rounds: 70.556 

1639.8810286521912
[7.86037278175354, 13.71556544303894, 19.403107404708862, 25.167311906814575, 30.692578077316284, 36.53634786605835, 42.29228138923645, 47.92048621177673, 53.50025200843811, 59.436737060546875, 65.18753099441528, 70.74744391441345, 76.52577471733093, 82.2061243057251, 87.91248798370361, 93.56685757637024, 99.24530172348022, 104.88081574440002, 110.76675987243652, 116.72830653190613, 122.50637602806091, 128.2261621952057, 134.18925642967224, 140.2461359500885, 146.0707130432129, 151.74557185173035, 157.39376497268677, 163.1946623325348, 168.9004466533661, 174.9895510673523, 180.8704047203064, 186.60040664672852, 192.2187101840973, 197.86676907539368, 203.48508667945862, 209.3920452594757, 215.17067408561707, 221.05667185783386, 226.73630690574646, 232.5501194000244, 238.10476756095886, 243.92136669158936, 249.67913246154785, 255.52303957939148, 261.4269645214081, 267.37234139442444, 273.348388671875, 279.01760840415955, 285.05549144744873, 290.9135572910309, 302.4567823410034]
[46.52, 49.88, 55.2, 57.32, 58.52, 60.48, 61.6, 63.92, 59.68, 64.52, 65.76, 64.56, 63.44, 64.84, 68.16, 65.84, 69.92, 68.2, 68.88, 68.04, 68.48, 69.48, 70.44, 72.0, 72.92, 72.88, 72.48, 73.12, 71.76, 73.64, 72.48, 74.0, 73.4, 71.96, 70.56, 72.52, 73.92, 73.68, 74.36, 71.36, 74.88, 74.84, 75.8, 71.6, 73.28, 74.44, 74.88, 73.24, 72.68, 74.88, 73.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.576, Test loss: 1.843, Test accuracy: 22.04 

Round   1, Train loss: 1.439, Test loss: 1.906, Test accuracy: 23.28 

Round   2, Train loss: 1.326, Test loss: 1.587, Test accuracy: 35.32 

Round   3, Train loss: 1.205, Test loss: 1.354, Test accuracy: 44.04 

Round   4, Train loss: 1.115, Test loss: 1.178, Test accuracy: 53.92 

Round   5, Train loss: 1.028, Test loss: 1.075, Test accuracy: 56.88 

Round   6, Train loss: 0.962, Test loss: 1.010, Test accuracy: 60.20 

Round   7, Train loss: 0.918, Test loss: 0.962, Test accuracy: 62.08 

Round   8, Train loss: 0.863, Test loss: 0.954, Test accuracy: 62.16 

Round   9, Train loss: 0.809, Test loss: 0.949, Test accuracy: 62.52 

Round  10, Train loss: 0.766, Test loss: 0.888, Test accuracy: 65.52 

Round  11, Train loss: 0.721, Test loss: 0.886, Test accuracy: 66.20 

Round  12, Train loss: 0.676, Test loss: 0.898, Test accuracy: 66.68 

Round  13, Train loss: 0.640, Test loss: 0.896, Test accuracy: 65.96 

Round  14, Train loss: 0.595, Test loss: 0.811, Test accuracy: 69.60 

Round  15, Train loss: 0.577, Test loss: 0.779, Test accuracy: 71.04 

Round  16, Train loss: 0.541, Test loss: 0.797, Test accuracy: 69.96 

Round  17, Train loss: 0.491, Test loss: 0.813, Test accuracy: 71.12 

Round  18, Train loss: 0.485, Test loss: 0.868, Test accuracy: 69.52 

Round  19, Train loss: 0.453, Test loss: 0.783, Test accuracy: 72.80 

Round  20, Train loss: 0.438, Test loss: 0.854, Test accuracy: 71.40 

Round  21, Train loss: 0.401, Test loss: 0.733, Test accuracy: 74.36 

Round  22, Train loss: 0.377, Test loss: 0.755, Test accuracy: 74.36 

Round  23, Train loss: 0.352, Test loss: 0.737, Test accuracy: 74.68 

Round  24, Train loss: 0.327, Test loss: 0.759, Test accuracy: 74.16 

Round  25, Train loss: 0.312, Test loss: 0.757, Test accuracy: 74.60 

Round  26, Train loss: 0.292, Test loss: 0.762, Test accuracy: 74.48 

Round  27, Train loss: 0.275, Test loss: 0.726, Test accuracy: 75.92 

Round  28, Train loss: 0.249, Test loss: 0.745, Test accuracy: 76.12 

Round  29, Train loss: 0.238, Test loss: 0.773, Test accuracy: 75.20 

Round  30, Train loss: 0.239, Test loss: 0.754, Test accuracy: 77.08 

Round  31, Train loss: 0.211, Test loss: 0.746, Test accuracy: 75.64 

Round  32, Train loss: 0.201, Test loss: 0.769, Test accuracy: 75.92 

Round  33, Train loss: 0.196, Test loss: 0.766, Test accuracy: 75.80 

Round  34, Train loss: 0.179, Test loss: 0.796, Test accuracy: 75.76 

Round  35, Train loss: 0.174, Test loss: 0.824, Test accuracy: 75.76 

Round  36, Train loss: 0.171, Test loss: 0.779, Test accuracy: 76.40 

Round  37, Train loss: 0.157, Test loss: 0.808, Test accuracy: 76.04 

Round  38, Train loss: 0.136, Test loss: 0.762, Test accuracy: 77.52 

Round  39, Train loss: 0.131, Test loss: 0.789, Test accuracy: 76.84 

Round  40, Train loss: 0.132, Test loss: 0.817, Test accuracy: 76.92 

Round  41, Train loss: 0.111, Test loss: 0.790, Test accuracy: 77.28 

Round  42, Train loss: 0.102, Test loss: 0.825, Test accuracy: 76.84 

Round  43, Train loss: 0.095, Test loss: 0.852, Test accuracy: 76.88 

Round  44, Train loss: 0.089, Test loss: 0.829, Test accuracy: 77.00 

Round  45, Train loss: 0.093, Test loss: 0.864, Test accuracy: 76.68 

Round  46, Train loss: 0.086, Test loss: 0.890, Test accuracy: 76.36 

Round  47, Train loss: 0.072, Test loss: 0.842, Test accuracy: 78.04 

Round  48, Train loss: 0.073, Test loss: 0.848, Test accuracy: 77.44 

Round  49, Train loss: 0.088, Test loss: 0.820, Test accuracy: 77.76 

Final Round, Train loss: 0.045, Test loss: 0.844, Test accuracy: 77.72 

Average accuracy final 10 rounds: 77.11999999999999 

1295.8674573898315
[6.3482372760772705, 10.978359699249268, 15.682243347167969, 20.433189630508423, 25.17704200744629, 29.770434141159058, 34.296661615371704, 38.959253549575806, 43.71556544303894, 48.34641671180725, 53.17267346382141, 58.20733308792114, 63.56359601020813, 68.725106716156, 73.42022848129272, 78.00638461112976, 82.92565774917603, 87.58832120895386, 92.41104912757874, 97.30665993690491, 101.90108561515808, 106.72515368461609, 111.55693006515503, 117.08845925331116, 121.57585883140564, 126.21140265464783, 130.79771661758423, 135.55739951133728, 140.77010679244995, 145.43292665481567, 150.903555393219, 156.29182696342468, 160.8806881904602, 165.51451563835144, 170.4287292957306, 175.354877948761, 179.9415979385376, 184.5123348236084, 189.80153465270996, 194.81296229362488, 199.38352394104004, 204.05558037757874, 208.69648027420044, 213.3010401725769, 217.9065444469452, 222.93699860572815, 227.56539344787598, 232.19174981117249, 236.72751927375793, 241.39100003242493, 247.170649766922]
[22.04, 23.28, 35.32, 44.04, 53.92, 56.88, 60.2, 62.08, 62.16, 62.52, 65.52, 66.2, 66.68, 65.96, 69.6, 71.04, 69.96, 71.12, 69.52, 72.8, 71.4, 74.36, 74.36, 74.68, 74.16, 74.6, 74.48, 75.92, 76.12, 75.2, 77.08, 75.64, 75.92, 75.8, 75.76, 75.76, 76.4, 76.04, 77.52, 76.84, 76.92, 77.28, 76.84, 76.88, 77.0, 76.68, 76.36, 78.04, 77.44, 77.76, 77.72]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.608, Test loss: 1.875, Test accuracy: 24.76
Round   1, Train loss: 1.415, Test loss: 1.750, Test accuracy: 30.12
Round   2, Train loss: 1.273, Test loss: 1.321, Test accuracy: 43.72
Round   3, Train loss: 1.177, Test loss: 1.295, Test accuracy: 45.52
Round   4, Train loss: 1.099, Test loss: 1.181, Test accuracy: 54.40
Round   5, Train loss: 1.024, Test loss: 1.200, Test accuracy: 52.68
Round   6, Train loss: 0.957, Test loss: 0.959, Test accuracy: 62.84
Round   7, Train loss: 0.897, Test loss: 1.013, Test accuracy: 61.08
Round   8, Train loss: 0.857, Test loss: 1.025, Test accuracy: 61.52
Round   9, Train loss: 0.799, Test loss: 0.865, Test accuracy: 65.56
Round  10, Train loss: 0.760, Test loss: 0.888, Test accuracy: 65.92
Round  11, Train loss: 0.711, Test loss: 0.834, Test accuracy: 69.12
Round  12, Train loss: 0.682, Test loss: 0.824, Test accuracy: 68.48
Round  13, Train loss: 0.642, Test loss: 0.868, Test accuracy: 67.60
Round  14, Train loss: 0.603, Test loss: 0.853, Test accuracy: 68.24
Round  15, Train loss: 0.575, Test loss: 0.808, Test accuracy: 70.44
Round  16, Train loss: 0.540, Test loss: 0.854, Test accuracy: 68.80
Round  17, Train loss: 0.511, Test loss: 0.821, Test accuracy: 70.48
Round  18, Train loss: 0.485, Test loss: 0.809, Test accuracy: 72.08
Round  19, Train loss: 0.447, Test loss: 0.790, Test accuracy: 73.32
Round  20, Train loss: 0.432, Test loss: 0.809, Test accuracy: 72.12
Round  21, Train loss: 0.396, Test loss: 0.718, Test accuracy: 74.56
Round  22, Train loss: 0.383, Test loss: 0.764, Test accuracy: 74.36
Round  23, Train loss: 0.358, Test loss: 0.726, Test accuracy: 75.76
Round  24, Train loss: 0.356, Test loss: 0.746, Test accuracy: 74.56
Round  25, Train loss: 0.312, Test loss: 0.721, Test accuracy: 75.20
Round  26, Train loss: 0.314, Test loss: 0.731, Test accuracy: 75.88
Round  27, Train loss: 0.279, Test loss: 0.708, Test accuracy: 75.96
Round  28, Train loss: 0.266, Test loss: 0.712, Test accuracy: 75.68
Round  29, Train loss: 0.250, Test loss: 0.735, Test accuracy: 75.92
Round  30, Train loss: 0.238, Test loss: 0.729, Test accuracy: 76.60
Round  31, Train loss: 0.235, Test loss: 0.712, Test accuracy: 76.92
Round  32, Train loss: 0.206, Test loss: 0.741, Test accuracy: 76.56
Round  33, Train loss: 0.198, Test loss: 0.738, Test accuracy: 76.28
Round  34, Train loss: 0.192, Test loss: 0.718, Test accuracy: 77.48
Round  35, Train loss: 0.178, Test loss: 0.712, Test accuracy: 77.96
Round  36, Train loss: 0.162, Test loss: 0.718, Test accuracy: 76.96
Round  37, Train loss: 0.147, Test loss: 0.747, Test accuracy: 77.32
Round  38, Train loss: 0.152, Test loss: 0.757, Test accuracy: 77.40
Round  39, Train loss: 0.142, Test loss: 0.735, Test accuracy: 77.92
Round  40, Train loss: 0.124, Test loss: 0.769, Test accuracy: 77.00
Round  41, Train loss: 0.108, Test loss: 0.751, Test accuracy: 78.08
Round  42, Train loss: 0.116, Test loss: 0.741, Test accuracy: 78.92
Round  43, Train loss: 0.106, Test loss: 0.769, Test accuracy: 77.60
Round  44, Train loss: 0.106, Test loss: 0.751, Test accuracy: 78.04
Round  45, Train loss: 0.089, Test loss: 0.761, Test accuracy: 77.80
Round  46, Train loss: 0.089, Test loss: 0.789, Test accuracy: 77.88
Round  47, Train loss: 0.087, Test loss: 0.752, Test accuracy: 78.32
Round  48, Train loss: 0.094, Test loss: 0.763, Test accuracy: 78.24
Round  49, Train loss: 0.074, Test loss: 0.759, Test accuracy: 78.92
Final Round, Train loss: 0.046, Test loss: 0.762, Test accuracy: 78.00
Average accuracy final 10 rounds: 78.08
1493.2753381729126
[8.392492532730103, 14.068122386932373, 19.901233196258545, 25.219407558441162, 31.43553638458252, 37.30048990249634, 43.47229766845703, 49.22127604484558, 54.56391215324402, 59.97975158691406, 65.42606282234192, 70.76199173927307, 76.13220024108887, 81.48470258712769, 86.81210780143738, 92.54462552070618, 98.66421937942505, 104.10004043579102, 109.72163581848145, 115.13538527488708, 120.54842400550842, 125.78827238082886, 131.29434180259705, 137.47195720672607, 142.74947667121887, 148.07856273651123, 153.34718823432922, 158.68188166618347, 164.17775130271912, 170.56802797317505, 176.72986888885498, 182.96090841293335, 188.38361883163452, 193.65032267570496, 199.89343810081482, 206.22480249404907, 211.63073325157166, 217.37666201591492, 223.59786891937256, 228.91900157928467, 235.3185954093933, 240.70002341270447, 245.99406385421753, 252.13033056259155, 257.4403307437897, 262.6369981765747, 268.1292836666107, 273.52060437202454, 278.8925108909607, 284.2894835472107, 290.79894375801086]
[24.76, 30.12, 43.72, 45.52, 54.4, 52.68, 62.84, 61.08, 61.52, 65.56, 65.92, 69.12, 68.48, 67.6, 68.24, 70.44, 68.8, 70.48, 72.08, 73.32, 72.12, 74.56, 74.36, 75.76, 74.56, 75.2, 75.88, 75.96, 75.68, 75.92, 76.6, 76.92, 76.56, 76.28, 77.48, 77.96, 76.96, 77.32, 77.4, 77.92, 77.0, 78.08, 78.92, 77.6, 78.04, 77.8, 77.88, 78.32, 78.24, 78.92, 78.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.528, Train accuracy: 79.400, Test loss: 1.384, Test accuracy: 53.40 

        train local model (freeze embeding):client   0,  Train loss: 0.377, Train accuracy: 85.600, Test loss: 1.230, Test accuracy: 60.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.645, Train accuracy: 73.400, Test loss: 1.812, Test accuracy: 52.40 

Round   0, Train loss: 0.645, Test loss: 1.812, Test accuracy: 52.40 

        train local model (freeze embeding):client   0,  Train loss: 0.253, Train accuracy: 90.800, Test loss: 1.295, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.304, Train accuracy: 88.200, Test loss: 1.612, Test accuracy: 58.60 

Round   1, Train loss: 0.304, Test loss: 1.612, Test accuracy: 58.60 

        train local model (freeze embeding):client   0,  Train loss: 0.167, Train accuracy: 94.000, Test loss: 1.380, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.160, Train accuracy: 94.800, Test loss: 1.404, Test accuracy: 64.00 

Round   2, Train loss: 0.160, Test loss: 1.404, Test accuracy: 64.00 

        train local model (freeze embeding):client   0,  Train loss: 0.101, Train accuracy: 97.000, Test loss: 1.416, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.169, Train accuracy: 93.800, Test loss: 1.473, Test accuracy: 60.20 

Round   3, Train loss: 0.169, Test loss: 1.473, Test accuracy: 60.20 

        train local model (freeze embeding):client   0,  Train loss: 0.086, Train accuracy: 97.200, Test loss: 1.404, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.126, Train accuracy: 95.200, Test loss: 1.637, Test accuracy: 59.20 

Round   4, Train loss: 0.126, Test loss: 1.637, Test accuracy: 59.20 

        train local model (freeze embeding):client   0,  Train loss: 0.083, Train accuracy: 97.400, Test loss: 1.586, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.149, Train accuracy: 95.000, Test loss: 1.802, Test accuracy: 60.00 

Round   5, Train loss: 0.149, Test loss: 1.802, Test accuracy: 60.00 

        train local model (freeze embeding):client   0,  Train loss: 0.076, Train accuracy: 97.200, Test loss: 1.617, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.152, Train accuracy: 94.800, Test loss: 1.741, Test accuracy: 61.60 

Round   6, Train loss: 0.152, Test loss: 1.741, Test accuracy: 61.60 

        train local model (freeze embeding):client   0,  Train loss: 0.059, Train accuracy: 97.600, Test loss: 1.657, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.400, Test loss: 1.742, Test accuracy: 64.40 

Round   7, Train loss: 0.031, Test loss: 1.742, Test accuracy: 64.40 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.200, Test loss: 1.767, Test accuracy: 61.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.049, Train accuracy: 98.600, Test loss: 1.981, Test accuracy: 59.20 

Round   8, Train loss: 0.049, Test loss: 1.981, Test accuracy: 59.20 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.738, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.033, Train accuracy: 99.600, Test loss: 1.786, Test accuracy: 63.00 

Round   9, Train loss: 0.033, Test loss: 1.786, Test accuracy: 63.00 

        train local model (freeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.803, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.043, Train accuracy: 98.600, Test loss: 1.836, Test accuracy: 63.20 

Round  10, Train loss: 0.043, Test loss: 1.836, Test accuracy: 63.20 

        train local model (freeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 1.829, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.058, Train accuracy: 97.800, Test loss: 1.818, Test accuracy: 62.60 

Round  11, Train loss: 0.058, Test loss: 1.818, Test accuracy: 62.60 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.839, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.081, Train accuracy: 97.200, Test loss: 2.072, Test accuracy: 62.00 

Round  12, Train loss: 0.081, Test loss: 2.072, Test accuracy: 62.00 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.774, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.600, Test loss: 1.838, Test accuracy: 64.20 

Round  13, Train loss: 0.045, Test loss: 1.838, Test accuracy: 64.20 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.600, Test loss: 1.776, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.810, Test accuracy: 63.80 

Round  14, Train loss: 0.005, Test loss: 1.810, Test accuracy: 63.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.793, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.048, Train accuracy: 98.400, Test loss: 1.929, Test accuracy: 65.00 

Round  15, Train loss: 0.048, Test loss: 1.929, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 1.854, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.104, Train accuracy: 97.000, Test loss: 2.243, Test accuracy: 64.00 

Round  16, Train loss: 0.104, Test loss: 2.243, Test accuracy: 64.00 

        train local model (freeze embeding):client   0,  Train loss: 0.039, Train accuracy: 98.600, Test loss: 1.858, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 2.057, Test accuracy: 62.80 

Round  17, Train loss: 0.029, Test loss: 2.057, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 2.037, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.400, Test loss: 2.062, Test accuracy: 61.80 

Round  18, Train loss: 0.012, Test loss: 2.062, Test accuracy: 61.80 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.095, Test accuracy: 59.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.200, Test loss: 2.023, Test accuracy: 63.40 

Round  19, Train loss: 0.018, Test loss: 2.023, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 2.048, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.011, Test accuracy: 63.80 

Final Round, Train loss: 0.007, Test loss: 2.134, Test accuracy: 62.20 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.076, Train accuracy: 96.600, Test loss: 1.094, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.041, Train accuracy: 98.600, Test loss: 1.465, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.572, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.207, Train accuracy: 92.800, Test loss: 0.972, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.304, Train accuracy: 88.200, Test loss: 1.459, Test accuracy: 63.80 

Round   0, Train loss: 0.155, Test loss: 1.191, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.034, Train accuracy: 99.200, Test loss: 1.407, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.554, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.123, Train accuracy: 95.200, Test loss: 0.944, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.425, Train accuracy: 83.200, Test loss: 1.829, Test accuracy: 61.20 

Round   1, Train loss: 0.216, Test loss: 1.217, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.040, Train accuracy: 99.000, Test loss: 1.353, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.030, Train accuracy: 98.600, Test loss: 1.716, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.097, Train accuracy: 97.600, Test loss: 0.882, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.111, Train accuracy: 96.400, Test loss: 1.409, Test accuracy: 69.60 

Round   2, Train loss: 0.070, Test loss: 1.267, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 1.496, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.655, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.094, Train accuracy: 96.400, Test loss: 1.022, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.209, Train accuracy: 93.200, Test loss: 1.365, Test accuracy: 68.40 

Round   3, Train loss: 0.108, Test loss: 1.211, Test accuracy: 72.30 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 1.520, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.674, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.036, Train accuracy: 99.200, Test loss: 0.997, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.149, Train accuracy: 95.200, Test loss: 1.458, Test accuracy: 68.80 

Round   4, Train loss: 0.077, Test loss: 1.338, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.587, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.687, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.400, Test loss: 0.970, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.062, Train accuracy: 97.400, Test loss: 1.341, Test accuracy: 72.60 

Round   5, Train loss: 0.036, Test loss: 1.269, Test accuracy: 70.70 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.476, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.765, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.023, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.042, Train accuracy: 99.000, Test loss: 1.289, Test accuracy: 71.60 

Round   6, Train loss: 0.027, Test loss: 1.286, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.647, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.743, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.153, Train accuracy: 95.600, Test loss: 1.425, Test accuracy: 69.60 

Round   7, Train loss: 0.079, Test loss: 1.270, Test accuracy: 73.20 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.519, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.726, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.055, Train accuracy: 97.600, Test loss: 1.510, Test accuracy: 69.20 

Round   8, Train loss: 0.029, Test loss: 1.272, Test accuracy: 73.50 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.505, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.592, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.986, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.236, Train accuracy: 91.600, Test loss: 1.699, Test accuracy: 69.20 

Round   9, Train loss: 0.125, Test loss: 1.384, Test accuracy: 72.70 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.554, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.716, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.029, Train accuracy: 98.800, Test loss: 1.058, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 1.406, Test accuracy: 72.20 

Round  10, Train loss: 0.019, Test loss: 1.301, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.501, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.046, Train accuracy: 98.600, Test loss: 1.883, Test accuracy: 65.60 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.126, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.077, Train accuracy: 97.800, Test loss: 1.276, Test accuracy: 73.20 

Round  11, Train loss: 0.061, Test loss: 1.276, Test accuracy: 73.30 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.498, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.600, Test loss: 1.784, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.205, Train accuracy: 93.200, Test loss: 1.650, Test accuracy: 67.80 

Round  12, Train loss: 0.116, Test loss: 1.413, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.624, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.621, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.051, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.168, Test accuracy: 76.60 

Round  13, Train loss: 0.006, Test loss: 1.227, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.491, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.696, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.251, Test accuracy: 74.80 

Round  14, Train loss: 0.005, Test loss: 1.248, Test accuracy: 73.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.461, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.642, Test accuracy: 69.40 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.996, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.275, Test accuracy: 73.40 

Round  15, Train loss: 0.007, Test loss: 1.311, Test accuracy: 73.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.568, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.820, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.072, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.164, Test accuracy: 75.60 

Round  16, Train loss: 0.003, Test loss: 1.378, Test accuracy: 73.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.593, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.824, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.190, Test accuracy: 74.80 

Round  17, Train loss: 0.005, Test loss: 1.385, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.733, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.857, Test accuracy: 69.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.367, Test accuracy: 73.80 

Round  18, Train loss: 0.012, Test loss: 1.404, Test accuracy: 73.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.657, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.869, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.200, Test loss: 1.304, Test accuracy: 74.40 

Round  19, Train loss: 0.013, Test loss: 1.345, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.668, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.669, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 79.00 

Final Round, Train loss: 0.002, Test loss: 1.342, Test accuracy: 74.20 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.186, Train accuracy: 94.200, Test loss: 1.405, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.058, Train accuracy: 97.800, Test loss: 1.408, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.696, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.053, Train accuracy: 98.200, Test loss: 1.029, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 75.40 

        train local model (freeze embeding):client   2,  Train loss: 0.205, Train accuracy: 92.800, Test loss: 0.910, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.075, Train accuracy: 98.200, Test loss: 0.955, Test accuracy: 77.60 

Round   0, Train loss: 0.034, Test loss: 1.068, Test accuracy: 75.27 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.278, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.701, Test accuracy: 67.60 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.890, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 99.200, Test loss: 1.433, Test accuracy: 73.80 

        train local model (freeze embeding):client   2,  Train loss: 0.135, Train accuracy: 95.600, Test loss: 0.842, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.076, Train accuracy: 96.800, Test loss: 1.060, Test accuracy: 75.80 

Round   1, Train loss: 0.040, Test loss: 1.066, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.419, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.602, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.203, Test accuracy: 76.40 

        train local model (freeze embeding):client   2,  Train loss: 0.081, Train accuracy: 98.400, Test loss: 0.912, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 1.009, Test accuracy: 80.00 

Round   2, Train loss: 0.010, Test loss: 1.062, Test accuracy: 77.60 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.379, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.740, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.126, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.051, Train accuracy: 98.400, Test loss: 0.868, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.262, Train accuracy: 89.600, Test loss: 1.854, Test accuracy: 67.60 

Round   3, Train loss: 0.090, Test loss: 1.148, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.398, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.807, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.936, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.175, Train accuracy: 94.600, Test loss: 1.780, Test accuracy: 69.40 

        train local model (freeze embeding):client   2,  Train loss: 0.045, Train accuracy: 98.800, Test loss: 0.890, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.111, Train accuracy: 96.200, Test loss: 1.236, Test accuracy: 73.20 

Round   4, Train loss: 0.098, Test loss: 1.163, Test accuracy: 75.53 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.424, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.030, Train accuracy: 98.800, Test loss: 1.638, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.051, Train accuracy: 98.400, Test loss: 1.223, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.600, Test loss: 0.863, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.048, Train accuracy: 98.600, Test loss: 1.039, Test accuracy: 76.00 

Round   5, Train loss: 0.043, Test loss: 1.084, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.321, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.556, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.923, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.200, Test loss: 1.131, Test accuracy: 76.80 

        train local model (freeze embeding):client   2,  Train loss: 0.044, Train accuracy: 98.800, Test loss: 0.909, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.095, Train accuracy: 97.400, Test loss: 1.057, Test accuracy: 78.60 

Round   6, Train loss: 0.043, Test loss: 1.005, Test accuracy: 77.53 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.302, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.695, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.600, Test loss: 0.833, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 1.339, Test accuracy: 73.60 

        train local model (freeze embeding):client   2,  Train loss: 0.027, Train accuracy: 99.400, Test loss: 0.861, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 1.049, Test accuracy: 76.40 

Round   7, Train loss: 0.022, Test loss: 1.035, Test accuracy: 77.53 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.364, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.563, Test accuracy: 72.40 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.865, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.109, Test accuracy: 78.40 

        train local model (freeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.400, Test loss: 0.865, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.057, Test accuracy: 78.80 

Round   8, Train loss: 0.008, Test loss: 1.033, Test accuracy: 77.60 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.291, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.681, Test accuracy: 69.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.200, Test loss: 1.150, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.852, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.144, Test accuracy: 77.80 

Round   9, Train loss: 0.014, Test loss: 1.085, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.417, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.661, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.862, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 0.907, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 80.80 

Round  10, Train loss: 0.007, Test loss: 1.061, Test accuracy: 77.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.307, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.661, Test accuracy: 71.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.255, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.895, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 98.400, Test loss: 1.307, Test accuracy: 76.20 

Round  11, Train loss: 0.015, Test loss: 1.098, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.376, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.632, Test accuracy: 73.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 79.20 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.050, Train accuracy: 98.400, Test loss: 1.200, Test accuracy: 76.40 

Round  12, Train loss: 0.017, Test loss: 1.087, Test accuracy: 77.27 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.404, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.659, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.158, Train accuracy: 95.200, Test loss: 1.803, Test accuracy: 71.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.872, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.967, Test accuracy: 80.80 

Round  13, Train loss: 0.055, Test loss: 1.096, Test accuracy: 77.27 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.817, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.292, Train accuracy: 89.600, Test loss: 2.381, Test accuracy: 65.20 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 0.861, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.088, Train accuracy: 97.400, Test loss: 1.500, Test accuracy: 72.40 

Round  14, Train loss: 0.127, Test loss: 1.296, Test accuracy: 74.27 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.495, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.613, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.061, Test accuracy: 77.60 

        train local model (freeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 0.986, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.080, Train accuracy: 97.000, Test loss: 1.268, Test accuracy: 76.00 

Round  15, Train loss: 0.028, Test loss: 1.145, Test accuracy: 77.47 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.401, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.616, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.949, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 80.20 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.116, Test accuracy: 79.40 

Round  16, Train loss: 0.002, Test loss: 1.072, Test accuracy: 78.47 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.377, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.463, Test accuracy: 73.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.885, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.600, Test loss: 1.243, Test accuracy: 75.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.890, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.044, Test accuracy: 79.20 

Round  17, Train loss: 0.019, Test loss: 1.095, Test accuracy: 77.93 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.400, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.637, Test accuracy: 70.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 80.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.940, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.922, Test accuracy: 81.00 

Round  18, Train loss: 0.001, Test loss: 1.092, Test accuracy: 77.87 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.395, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.583, Test accuracy: 70.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 80.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.085, Test accuracy: 80.20 

Round  19, Train loss: 0.001, Test loss: 1.098, Test accuracy: 78.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.433, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.414, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.982, Test accuracy: 80.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.924, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.932, Test accuracy: 83.20 

Final Round, Train loss: 0.001, Test loss: 1.110, Test accuracy: 79.00 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.045, Train accuracy: 98.400, Test loss: 1.241, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.040, Train accuracy: 98.400, Test loss: 1.296, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.668, Test accuracy: 68.80 

        train local model (freeze embeding):client   1,  Train loss: 0.037, Train accuracy: 99.800, Test loss: 0.958, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 1.232, Test accuracy: 75.20 

        train local model (freeze embeding):client   2,  Train loss: 0.053, Train accuracy: 98.200, Test loss: 0.930, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.087, Train accuracy: 96.800, Test loss: 1.066, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.174, Train accuracy: 93.800, Test loss: 1.012, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.063, Train accuracy: 98.800, Test loss: 0.896, Test accuracy: 75.60 

Round   0, Train loss: 0.049, Test loss: 0.962, Test accuracy: 77.25 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.202, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.035, Train accuracy: 98.600, Test loss: 1.743, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.799, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.200, Test loss: 1.087, Test accuracy: 76.40 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 0.865, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.008, Test accuracy: 78.40 

        train local model (freeze embeding):client   3,  Train loss: 0.205, Train accuracy: 90.400, Test loss: 0.938, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.084, Train accuracy: 98.000, Test loss: 1.258, Test accuracy: 71.60 

Round   1, Train loss: 0.038, Test loss: 1.003, Test accuracy: 76.10 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.266, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.670, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.805, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.200, Test loss: 1.149, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.101, Train accuracy: 96.400, Test loss: 1.470, Test accuracy: 75.40 

        train local model (freeze embeding):client   3,  Train loss: 0.143, Train accuracy: 94.200, Test loss: 0.889, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.275, Train accuracy: 88.600, Test loss: 1.455, Test accuracy: 68.60 

Round   2, Train loss: 0.100, Test loss: 1.029, Test accuracy: 76.75 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.364, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.469, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.842, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.916, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.400, Test loss: 0.861, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.037, Test accuracy: 80.20 

        train local model (freeze embeding):client   3,  Train loss: 0.092, Train accuracy: 97.200, Test loss: 0.938, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.100, Train accuracy: 96.400, Test loss: 1.079, Test accuracy: 72.20 

Round   3, Train loss: 0.027, Test loss: 0.990, Test accuracy: 77.25 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.292, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.490, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.821, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.992, Test accuracy: 80.80 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.872, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.043, Train accuracy: 98.800, Test loss: 1.196, Test accuracy: 77.80 

        train local model (freeze embeding):client   3,  Train loss: 0.061, Train accuracy: 98.400, Test loss: 0.976, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.111, Train accuracy: 97.200, Test loss: 1.313, Test accuracy: 69.80 

Round   4, Train loss: 0.042, Test loss: 1.022, Test accuracy: 77.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.348, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.542, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.832, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 1.091, Test accuracy: 78.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.854, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.064, Train accuracy: 97.800, Test loss: 1.297, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.050, Train accuracy: 98.400, Test loss: 0.962, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.088, Train accuracy: 96.800, Test loss: 1.220, Test accuracy: 72.40 

Round   5, Train loss: 0.046, Test loss: 0.996, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.294, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.398, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.856, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.898, Test accuracy: 81.80 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.820, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 98.800, Test loss: 1.190, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.038, Train accuracy: 99.400, Test loss: 0.932, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.099, Train accuracy: 96.600, Test loss: 1.441, Test accuracy: 69.80 

Round   6, Train loss: 0.033, Test loss: 0.990, Test accuracy: 77.95 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.302, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.400, Test loss: 1.843, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.822, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.134, Test accuracy: 79.40 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 0.955, Test accuracy: 80.80 

        train local model (freeze embeding):client   3,  Train loss: 0.027, Train accuracy: 99.600, Test loss: 0.926, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.108, Train accuracy: 96.200, Test loss: 1.186, Test accuracy: 72.20 

Round   7, Train loss: 0.043, Test loss: 0.998, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.284, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.813, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.817, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.995, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.847, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.802, Test accuracy: 82.40 

        train local model (freeze embeding):client   3,  Train loss: 0.033, Train accuracy: 99.200, Test loss: 0.894, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.058, Train accuracy: 97.800, Test loss: 1.102, Test accuracy: 76.80 

Round   8, Train loss: 0.023, Test loss: 0.998, Test accuracy: 78.30 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.276, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.502, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.837, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 81.60 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.849, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.400, Test loss: 0.994, Test accuracy: 79.60 

        train local model (freeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.800, Test loss: 0.946, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.098, Train accuracy: 96.400, Test loss: 1.382, Test accuracy: 71.20 

Round   9, Train loss: 0.028, Test loss: 1.009, Test accuracy: 78.45 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.345, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 1.681, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.906, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 98.800, Test loss: 1.075, Test accuracy: 77.60 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.852, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 0.903, Test accuracy: 80.40 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 0.957, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 1.042, Test accuracy: 75.80 

Round  10, Train loss: 0.023, Test loss: 0.982, Test accuracy: 78.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.284, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.452, Test accuracy: 73.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.046, Test accuracy: 80.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.845, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 0.992, Test accuracy: 81.20 

        train local model (freeze embeding):client   3,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.982, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.062, Train accuracy: 97.400, Test loss: 1.205, Test accuracy: 73.00 

Round  11, Train loss: 0.019, Test loss: 1.008, Test accuracy: 78.35 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.278, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.630, Test accuracy: 72.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.600, Test loss: 1.071, Test accuracy: 78.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.801, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.040, Train accuracy: 98.600, Test loss: 1.162, Test accuracy: 77.40 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.177, Test accuracy: 75.20 

Round  12, Train loss: 0.020, Test loss: 1.023, Test accuracy: 78.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.363, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.645, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.793, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 81.40 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.882, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.154, Test accuracy: 79.80 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.097, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.048, Train accuracy: 98.200, Test loss: 1.294, Test accuracy: 74.40 

Round  13, Train loss: 0.018, Test loss: 1.071, Test accuracy: 77.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.293, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.485, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.830, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.027, Test accuracy: 80.20 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.808, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 84.20 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.097, Train accuracy: 95.600, Test loss: 1.461, Test accuracy: 69.60 

Round  14, Train loss: 0.026, Test loss: 1.045, Test accuracy: 78.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.315, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.580, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.958, Test accuracy: 81.40 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.081, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 1.243, Test accuracy: 73.20 

Round  15, Train loss: 0.008, Test loss: 1.063, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.372, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.485, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.862, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.952, Test accuracy: 81.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.856, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.170, Test accuracy: 77.40 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.071, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.154, Train accuracy: 95.400, Test loss: 1.338, Test accuracy: 72.60 

Round  16, Train loss: 0.045, Test loss: 1.054, Test accuracy: 78.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.507, Test accuracy: 73.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.228, Test accuracy: 75.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.806, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.894, Test accuracy: 82.40 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.179, Train accuracy: 93.800, Test loss: 1.722, Test accuracy: 66.80 

Round  17, Train loss: 0.050, Test loss: 1.033, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.320, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.536, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.845, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.032, Test accuracy: 81.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.891, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 81.20 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.326, Test accuracy: 75.40 

Round  18, Train loss: 0.006, Test loss: 1.034, Test accuracy: 79.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.344, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.035, Train accuracy: 98.800, Test loss: 1.878, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.316, Test accuracy: 76.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 1.181, Test accuracy: 77.40 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.028, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 1.295, Test accuracy: 72.60 

Round  19, Train loss: 0.022, Test loss: 1.077, Test accuracy: 77.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.382, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.377, Test accuracy: 75.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 79.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.817, Test accuracy: 83.40 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.069, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.060, Test accuracy: 76.80 

Final Round, Train loss: 0.002, Test loss: 1.044, Test accuracy: 78.50 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.051, Train accuracy: 98.200, Test loss: 1.707, Test accuracy: 61.80 

        train local model (freeze embeding):client   0,  Train loss: 0.047, Train accuracy: 98.600, Test loss: 1.272, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.755, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.800, Test loss: 0.952, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.974, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.800, Test loss: 0.886, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.964, Test accuracy: 79.60 

        train local model (freeze embeding):client   3,  Train loss: 0.048, Train accuracy: 98.200, Test loss: 1.198, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 1.399, Test accuracy: 71.60 

        train local model (freeze embeding):client   4,  Train loss: 0.143, Train accuracy: 96.200, Test loss: 1.246, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.209, Train accuracy: 91.800, Test loss: 1.835, Test accuracy: 55.60 

Round   0, Train loss: 0.056, Test loss: 1.031, Test accuracy: 75.56 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.192, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 0.842, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.787, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.200, Test loss: 1.253, Test accuracy: 78.60 

        train local model (freeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.119, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 73.60 

        train local model (freeze embeding):client   4,  Train loss: 0.152, Train accuracy: 94.800, Test loss: 1.246, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.100, Train accuracy: 96.200, Test loss: 1.663, Test accuracy: 58.20 

Round   1, Train loss: 0.027, Test loss: 1.009, Test accuracy: 75.24 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.153, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.406, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.803, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.119, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.812, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.028, Test accuracy: 80.40 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.256, Test accuracy: 75.00 

        train local model (freeze embeding):client   4,  Train loss: 0.124, Train accuracy: 96.000, Test loss: 1.184, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.173, Train accuracy: 92.600, Test loss: 1.815, Test accuracy: 60.60 

Round   2, Train loss: 0.044, Test loss: 0.968, Test accuracy: 76.56 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.158, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.332, Test accuracy: 75.40 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.758, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.027, Train accuracy: 98.800, Test loss: 1.118, Test accuracy: 77.20 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.788, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.068, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.000, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 1.252, Test accuracy: 73.40 

        train local model (freeze embeding):client   4,  Train loss: 0.117, Train accuracy: 96.800, Test loss: 1.210, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.131, Train accuracy: 95.200, Test loss: 1.830, Test accuracy: 59.40 

Round   3, Train loss: 0.037, Test loss: 1.028, Test accuracy: 75.16 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.172, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.323, Test accuracy: 74.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.796, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 0.843, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.089, Test accuracy: 77.40 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.196, Test accuracy: 75.20 

        train local model (freeze embeding):client   4,  Train loss: 0.096, Train accuracy: 97.000, Test loss: 1.313, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.068, Train accuracy: 97.400, Test loss: 1.822, Test accuracy: 61.40 

Round   4, Train loss: 0.021, Test loss: 1.008, Test accuracy: 75.76 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.209, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.373, Test accuracy: 72.80 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.759, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.943, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.877, Test accuracy: 82.60 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.009, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.315, Test accuracy: 76.20 

        train local model (freeze embeding):client   4,  Train loss: 0.075, Train accuracy: 98.600, Test loss: 1.303, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.091, Train accuracy: 95.800, Test loss: 1.834, Test accuracy: 60.60 

Round   5, Train loss: 0.025, Test loss: 1.017, Test accuracy: 76.68 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.216, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.873, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.779, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.940, Test accuracy: 81.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.810, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 1.315, Test accuracy: 73.60 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 1.404, Test accuracy: 71.40 

        train local model (freeze embeding):client   4,  Train loss: 0.044, Train accuracy: 99.400, Test loss: 1.339, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.168, Train accuracy: 92.800, Test loss: 1.928, Test accuracy: 57.80 

Round   6, Train loss: 0.058, Test loss: 1.071, Test accuracy: 75.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.307, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.354, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.800, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 80.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.822, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.913, Test accuracy: 80.40 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.039, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.042, Train accuracy: 98.200, Test loss: 1.431, Test accuracy: 74.20 

        train local model (freeze embeding):client   4,  Train loss: 0.051, Train accuracy: 99.200, Test loss: 1.362, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.179, Train accuracy: 93.400, Test loss: 2.175, Test accuracy: 58.60 

Round   7, Train loss: 0.045, Test loss: 1.054, Test accuracy: 76.68 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.462, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.783, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.802, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.870, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 0.958, Test accuracy: 79.40 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.025, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 1.311, Test accuracy: 73.60 

        train local model (freeze embeding):client   4,  Train loss: 0.033, Train accuracy: 99.400, Test loss: 1.340, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.168, Train accuracy: 94.000, Test loss: 2.409, Test accuracy: 57.40 

Round   8, Train loss: 0.042, Test loss: 1.043, Test accuracy: 76.32 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.288, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.443, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.083, Train accuracy: 97.400, Test loss: 1.378, Test accuracy: 76.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.771, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.800, Test accuracy: 83.80 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.070, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.130, Test accuracy: 76.60 

        train local model (freeze embeding):client   4,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.410, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.052, Train accuracy: 98.000, Test loss: 1.955, Test accuracy: 62.20 

Round   9, Train loss: 0.028, Test loss: 1.068, Test accuracy: 76.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.222, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.510, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.940, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.757, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 0.981, Test accuracy: 80.20 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.036, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.200, Test loss: 1.261, Test accuracy: 75.80 

        train local model (freeze embeding):client   4,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 1.355, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.101, Train accuracy: 96.800, Test loss: 2.037, Test accuracy: 62.00 

Round  10, Train loss: 0.028, Test loss: 1.042, Test accuracy: 76.68 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.358, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 1.569, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.092, Test accuracy: 78.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.776, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.107, Train accuracy: 97.600, Test loss: 1.881, Test accuracy: 71.80 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.068, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.432, Test accuracy: 74.00 

        train local model (freeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 1.383, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.124, Train accuracy: 96.400, Test loss: 1.875, Test accuracy: 61.00 

Round  11, Train loss: 0.058, Test loss: 1.095, Test accuracy: 75.36 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.340, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.333, Test accuracy: 74.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.825, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.912, Test accuracy: 81.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.836, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.921, Test accuracy: 81.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.045, Train accuracy: 98.800, Test loss: 1.274, Test accuracy: 73.00 

        train local model (freeze embeding):client   4,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 1.430, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.381, Train accuracy: 87.000, Test loss: 2.818, Test accuracy: 54.20 

Round  12, Train loss: 0.087, Test loss: 1.070, Test accuracy: 75.68 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.260, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.343, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.758, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 82.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.825, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 81.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.103, Test accuracy: 78.40 

        train local model (freeze embeding):client   4,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.472, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.157, Train accuracy: 94.200, Test loss: 2.175, Test accuracy: 63.20 

Round  13, Train loss: 0.033, Test loss: 1.074, Test accuracy: 76.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.251, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.600, Test loss: 1.271, Test accuracy: 77.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.779, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.990, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.088, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.335, Test accuracy: 74.60 

        train local model (freeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.422, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.135, Train accuracy: 96.600, Test loss: 2.218, Test accuracy: 59.20 

Round  14, Train loss: 0.040, Test loss: 1.102, Test accuracy: 76.16 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.238, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.413, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.797, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.862, Test accuracy: 82.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 80.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.080, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.159, Test accuracy: 74.60 

        train local model (freeze embeding):client   4,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.474, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.069, Train accuracy: 98.000, Test loss: 1.817, Test accuracy: 64.40 

Round  15, Train loss: 0.017, Test loss: 1.065, Test accuracy: 76.64 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.256, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.394, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.797, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.862, Test accuracy: 81.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.776, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 83.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.168, Test accuracy: 77.00 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.450, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.734, Test accuracy: 65.20 

Round  16, Train loss: 0.004, Test loss: 1.050, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.264, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.561, Test accuracy: 74.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.765, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.200, Test loss: 1.382, Test accuracy: 76.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.773, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.880, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.045, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.064, Train accuracy: 97.600, Test loss: 1.641, Test accuracy: 72.20 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.435, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.111, Train accuracy: 95.800, Test loss: 2.025, Test accuracy: 60.00 

Round  17, Train loss: 0.042, Test loss: 1.077, Test accuracy: 76.32 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.410, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.825, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.009, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.750, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.835, Test accuracy: 82.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.068, Train accuracy: 97.400, Test loss: 1.400, Test accuracy: 72.40 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.447, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.030, Train accuracy: 99.400, Test loss: 2.054, Test accuracy: 64.60 

Round  18, Train loss: 0.021, Test loss: 1.062, Test accuracy: 76.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.208, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.396, Test accuracy: 74.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.824, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 81.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.857, Test accuracy: 81.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.065, Test accuracy: 78.60 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.507, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.175, Train accuracy: 93.400, Test loss: 2.212, Test accuracy: 56.80 

Round  19, Train loss: 0.036, Test loss: 1.053, Test accuracy: 76.96 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.287, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.272, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.790, Test accuracy: 83.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.778, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.800, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.989, Test accuracy: 78.40 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.399, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.433, Test accuracy: 68.00 

Final Round, Train loss: 0.002, Test loss: 1.054, Test accuracy: 76.64 

Average accuracy final 10 rounds: 368.863 

3500.85973072052
[9.531737089157104, 19.24411177635193, 28.739155769348145, 38.53154230117798, 47.94643044471741, 58.15232181549072, 67.84774851799011, 77.37338495254517, 87.16479587554932, 97.0648238658905, 106.54971575737, 116.29997515678406, 125.9142701625824, 135.33295798301697, 144.8102638721466, 154.57042145729065, 164.29313397407532, 174.06558513641357, 183.88209748268127, 193.23382592201233, 199.0142686367035, 208.82773303985596, 218.61739897727966, 228.27567744255066, 238.26010417938232, 248.1511378288269, 257.7314887046814, 267.4238667488098, 277.5170748233795, 287.61472606658936, 297.4135732650757, 307.49973011016846, 317.15837144851685, 327.03138494491577, 336.76666927337646, 346.43315076828003, 356.17308235168457, 365.8042960166931, 375.6145119667053, 385.52136397361755, 395.5767686367035, 401.15704441070557, 410.9207684993744, 420.59570717811584, 430.53670358657837, 440.0831129550934, 449.9774832725525, 459.9511272907257, 469.7366862297058, 479.564777135849, 489.35249614715576, 499.1166045665741, 508.93309450149536, 518.7940981388092, 528.5777587890625, 538.7526886463165, 548.8558993339539, 558.5521304607391, 569.2926626205444, 580.3467175960541, 591.4762487411499, 604.0182723999023, 612.9489912986755, 624.3914892673492, 636.6880054473877, 647.7424347400665, 660.198319196701, 671.5566673278809, 682.2226011753082, 694.1113359928131, 704.7373080253601, 715.5803565979004, 726.4787213802338, 737.5322914123535, 748.1127164363861, 759.9487681388855, 770.6682815551758, 781.2846131324768, 791.8081893920898, 802.2423329353333, 813.9887692928314, 824.9118452072144, 836.5775430202484, 844.2603983879089, 854.8792252540588, 865.533031463623, 877.4845559597015, 889.7968113422394, 900.7536716461182, 911.6638939380646, 922.205738067627, 933.104118347168, 944.353483915329, 955.1658625602722, 965.8418924808502, 976.7214250564575, 987.8117187023163, 999.4257807731628, 1011.2566094398499, 1021.4918563365936, 1032.677098274231, 1043.0811789035797, 1053.3972499370575, 1064.0026557445526, 1070.517606973648]
[52.4, 58.6, 64.0, 60.2, 59.2, 60.0, 61.6, 64.4, 59.2, 63.0, 63.2, 62.6, 62.0, 64.2, 63.8, 65.0, 64.0, 62.8, 61.8, 63.4, 62.2, 69.0, 70.0, 72.0, 72.3, 70.6, 70.7, 72.4, 73.2, 73.5, 72.7, 72.0, 73.3, 72.4, 74.5, 73.4, 73.4, 73.5, 74.0, 73.6, 74.5, 74.2, 75.26666666666667, 75.4, 77.6, 75.4, 75.53333333333333, 75.4, 77.53333333333333, 77.53333333333333, 77.6, 77.0, 77.66666666666667, 78.0, 77.26666666666667, 77.26666666666667, 74.26666666666667, 77.46666666666667, 78.46666666666667, 77.93333333333334, 77.86666666666666, 78.8, 79.0, 77.25, 76.1, 76.75, 77.25, 77.7, 78.0, 77.95, 78.5, 78.3, 78.45, 78.7, 78.35, 78.1, 77.7, 78.3, 77.5, 78.2, 79.0, 79.3, 77.2, 78.5, 75.56, 75.24, 76.56, 75.16, 75.76, 76.68, 75.2, 76.68, 76.32, 76.2, 76.68, 75.36, 75.68, 76.2, 76.16, 76.64, 77.0, 76.32, 76.88, 76.96, 76.64]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.463, Test loss: 1.340, Test accuracy: 45.60 

Round   0, Global train loss: 1.463, Global test loss: 1.931, Global test accuracy: 27.70 

Round   1, Train loss: 1.145, Test loss: 1.261, Test accuracy: 49.50 

Round   1, Global train loss: 1.145, Global test loss: 1.789, Global test accuracy: 22.90 

Round   2, Train loss: 0.968, Test loss: 1.450, Test accuracy: 51.00 

Round   2, Global train loss: 0.968, Global test loss: 2.015, Global test accuracy: 25.90 

Round   3, Train loss: 0.853, Test loss: 1.218, Test accuracy: 56.20 

Round   3, Global train loss: 0.853, Global test loss: 2.049, Global test accuracy: 23.30 

Round   4, Train loss: 0.732, Test loss: 1.304, Test accuracy: 59.40 

Round   4, Global train loss: 0.732, Global test loss: 2.423, Global test accuracy: 24.60 

Round   5, Train loss: 0.642, Test loss: 1.436, Test accuracy: 55.70 

Round   5, Global train loss: 0.642, Global test loss: 2.344, Global test accuracy: 21.80 

Round   6, Train loss: 0.571, Test loss: 1.391, Test accuracy: 60.60 

Round   6, Global train loss: 0.571, Global test loss: 2.771, Global test accuracy: 20.60 

Round   7, Train loss: 0.438, Test loss: 1.655, Test accuracy: 56.40 

Round   7, Global train loss: 0.438, Global test loss: 2.917, Global test accuracy: 20.50 

Round   8, Train loss: 0.401, Test loss: 1.488, Test accuracy: 61.50 

Round   8, Global train loss: 0.401, Global test loss: 3.025, Global test accuracy: 20.30 

Round   9, Train loss: 0.344, Test loss: 1.643, Test accuracy: 59.10 

Round   9, Global train loss: 0.344, Global test loss: 3.457, Global test accuracy: 20.20 

Round  10, Train loss: 0.255, Test loss: 2.012, Test accuracy: 59.70 

Round  10, Global train loss: 0.255, Global test loss: 3.362, Global test accuracy: 20.10 

Round  11, Train loss: 0.244, Test loss: 1.966, Test accuracy: 58.30 

Round  11, Global train loss: 0.244, Global test loss: 3.705, Global test accuracy: 20.00 

Round  12, Train loss: 0.219, Test loss: 1.913, Test accuracy: 61.60 

Round  12, Global train loss: 0.219, Global test loss: 3.583, Global test accuracy: 20.10 

Round  13, Train loss: 0.175, Test loss: 2.146, Test accuracy: 60.50 

Round  13, Global train loss: 0.175, Global test loss: 3.049, Global test accuracy: 20.50 

Round  14, Train loss: 0.145, Test loss: 2.185, Test accuracy: 58.50 

Round  14, Global train loss: 0.145, Global test loss: 4.637, Global test accuracy: 20.00 

Round  15, Train loss: 0.152, Test loss: 1.998, Test accuracy: 61.70 

Round  15, Global train loss: 0.152, Global test loss: 3.395, Global test accuracy: 20.10 

Round  16, Train loss: 0.135, Test loss: 1.895, Test accuracy: 63.20 

Round  16, Global train loss: 0.135, Global test loss: 3.423, Global test accuracy: 20.80 

Round  17, Train loss: 0.092, Test loss: 1.873, Test accuracy: 62.70 

Round  17, Global train loss: 0.092, Global test loss: 4.024, Global test accuracy: 20.00 

Round  18, Train loss: 0.118, Test loss: 2.226, Test accuracy: 62.50 

Round  18, Global train loss: 0.118, Global test loss: 3.450, Global test accuracy: 20.20 

Round  19, Train loss: 0.074, Test loss: 1.889, Test accuracy: 65.30 

Round  19, Global train loss: 0.074, Global test loss: 3.913, Global test accuracy: 20.00 

Round  20, Train loss: 0.104, Test loss: 1.994, Test accuracy: 63.90 

Round  20, Global train loss: 0.104, Global test loss: 3.751, Global test accuracy: 20.20 

Round  21, Train loss: 0.050, Test loss: 2.151, Test accuracy: 64.20 

Round  21, Global train loss: 0.050, Global test loss: 4.316, Global test accuracy: 20.10 

Round  22, Train loss: 0.060, Test loss: 2.016, Test accuracy: 63.60 

Round  22, Global train loss: 0.060, Global test loss: 3.761, Global test accuracy: 20.50 

Round  23, Train loss: 0.046, Test loss: 2.104, Test accuracy: 64.50 

Round  23, Global train loss: 0.046, Global test loss: 4.429, Global test accuracy: 20.00 

Round  24, Train loss: 0.050, Test loss: 2.302, Test accuracy: 61.80 

Round  24, Global train loss: 0.050, Global test loss: 4.449, Global test accuracy: 20.00 

Round  25, Train loss: 0.042, Test loss: 2.015, Test accuracy: 63.80 

Round  25, Global train loss: 0.042, Global test loss: 4.187, Global test accuracy: 20.00 

Round  26, Train loss: 0.045, Test loss: 2.148, Test accuracy: 62.80 

Round  26, Global train loss: 0.045, Global test loss: 4.081, Global test accuracy: 20.30 

Round  27, Train loss: 0.023, Test loss: 2.072, Test accuracy: 63.00 

Round  27, Global train loss: 0.023, Global test loss: 4.448, Global test accuracy: 20.00 

Round  28, Train loss: 0.045, Test loss: 2.349, Test accuracy: 63.20 

Round  28, Global train loss: 0.045, Global test loss: 4.138, Global test accuracy: 20.10 

Round  29, Train loss: 0.061, Test loss: 2.106, Test accuracy: 61.50 

Round  29, Global train loss: 0.061, Global test loss: 3.889, Global test accuracy: 20.00 

Round  30, Train loss: 0.030, Test loss: 2.018, Test accuracy: 64.80 

Round  30, Global train loss: 0.030, Global test loss: 4.185, Global test accuracy: 20.00 

Round  31, Train loss: 0.036, Test loss: 2.254, Test accuracy: 63.90 

Round  31, Global train loss: 0.036, Global test loss: 4.269, Global test accuracy: 20.10 

Round  32, Train loss: 0.034, Test loss: 2.049, Test accuracy: 66.10 

Round  32, Global train loss: 0.034, Global test loss: 4.439, Global test accuracy: 20.00 

Round  33, Train loss: 0.033, Test loss: 2.067, Test accuracy: 66.00 

Round  33, Global train loss: 0.033, Global test loss: 3.964, Global test accuracy: 20.30 

Round  34, Train loss: 0.023, Test loss: 2.128, Test accuracy: 64.20 

Round  34, Global train loss: 0.023, Global test loss: 4.300, Global test accuracy: 20.00 

Final Round, Train loss: 0.016, Test loss: 2.427, Test accuracy: 64.60 

Final Round, Global train loss: 0.016, Global test loss: 4.300, Global test accuracy: 20.00 

Average accuracy final 10 rounds: 63.93 

Average global accuracy final 10 rounds: 20.080000000000002 

488.65254616737366
[7.847954988479614, 13.465944290161133, 18.944108963012695, 24.552605390548706, 30.26991295814514, 35.835729360580444, 41.454314947128296, 47.24780225753784, 52.97222971916199, 58.71586060523987, 64.38708019256592, 70.79398655891418, 76.75235176086426, 82.7417380809784, 88.62460398674011, 94.75465226173401, 100.65351462364197, 106.43209791183472, 112.43271517753601, 118.43793439865112, 124.50349879264832, 130.5184931755066, 136.5442476272583, 142.6900007724762, 148.89799332618713, 154.82057309150696, 160.63380908966064, 166.36576461791992, 172.34271264076233, 178.13676977157593, 184.4439091682434, 190.46584057807922, 196.53091049194336, 202.93129587173462, 209.0003502368927, 220.86747884750366]
[45.6, 49.5, 51.0, 56.2, 59.4, 55.7, 60.6, 56.4, 61.5, 59.1, 59.7, 58.3, 61.6, 60.5, 58.5, 61.7, 63.2, 62.7, 62.5, 65.3, 63.9, 64.2, 63.6, 64.5, 61.8, 63.8, 62.8, 63.0, 63.2, 61.5, 64.8, 63.9, 66.1, 66.0, 64.2, 64.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.443, Test loss: 1.303, Test accuracy: 48.90 

Round   0, Global train loss: 1.443, Global test loss: 1.732, Global test accuracy: 25.50 

Round   1, Train loss: 1.265, Test loss: 1.385, Test accuracy: 47.90 

Round   1, Global train loss: 1.265, Global test loss: 1.957, Global test accuracy: 28.90 

Round   2, Train loss: 1.146, Test loss: 1.186, Test accuracy: 56.40 

Round   2, Global train loss: 1.146, Global test loss: 2.005, Global test accuracy: 29.20 

Round   3, Train loss: 1.020, Test loss: 1.330, Test accuracy: 55.00 

Round   3, Global train loss: 1.020, Global test loss: 1.913, Global test accuracy: 34.70 

Round   4, Train loss: 0.923, Test loss: 1.437, Test accuracy: 48.90 

Round   4, Global train loss: 0.923, Global test loss: 1.696, Global test accuracy: 40.60 

Round   5, Train loss: 0.847, Test loss: 1.344, Test accuracy: 53.90 

Round   5, Global train loss: 0.847, Global test loss: 2.152, Global test accuracy: 36.00 

Round   6, Train loss: 0.782, Test loss: 1.310, Test accuracy: 56.40 

Round   6, Global train loss: 0.782, Global test loss: 1.827, Global test accuracy: 39.40 

Round   7, Train loss: 0.693, Test loss: 1.416, Test accuracy: 60.30 

Round   7, Global train loss: 0.693, Global test loss: 1.965, Global test accuracy: 41.50 

Round   8, Train loss: 0.654, Test loss: 1.209, Test accuracy: 62.10 

Round   8, Global train loss: 0.654, Global test loss: 2.307, Global test accuracy: 40.10 

Round   9, Train loss: 0.555, Test loss: 1.315, Test accuracy: 61.70 

Round   9, Global train loss: 0.555, Global test loss: 2.253, Global test accuracy: 39.10 

Round  10, Train loss: 0.529, Test loss: 1.390, Test accuracy: 59.10 

Round  10, Global train loss: 0.529, Global test loss: 2.145, Global test accuracy: 40.40 

Round  11, Train loss: 0.483, Test loss: 1.326, Test accuracy: 62.50 

Round  11, Global train loss: 0.483, Global test loss: 2.412, Global test accuracy: 39.60 

Round  12, Train loss: 0.425, Test loss: 1.487, Test accuracy: 59.40 

Round  12, Global train loss: 0.425, Global test loss: 2.160, Global test accuracy: 40.90 

Round  13, Train loss: 0.368, Test loss: 1.532, Test accuracy: 61.00 

Round  13, Global train loss: 0.368, Global test loss: 2.326, Global test accuracy: 40.70 

Round  14, Train loss: 0.345, Test loss: 1.365, Test accuracy: 64.10 

Round  14, Global train loss: 0.345, Global test loss: 2.179, Global test accuracy: 44.40 

Round  15, Train loss: 0.322, Test loss: 1.583, Test accuracy: 60.70 

Round  15, Global train loss: 0.322, Global test loss: 2.024, Global test accuracy: 46.40 

Round  16, Train loss: 0.309, Test loss: 1.744, Test accuracy: 60.60 

Round  16, Global train loss: 0.309, Global test loss: 2.137, Global test accuracy: 44.30 

Round  17, Train loss: 0.223, Test loss: 1.607, Test accuracy: 62.40 

Round  17, Global train loss: 0.223, Global test loss: 2.686, Global test accuracy: 43.50 

Round  18, Train loss: 0.197, Test loss: 1.757, Test accuracy: 62.30 

Round  18, Global train loss: 0.197, Global test loss: 2.682, Global test accuracy: 45.00 

Round  19, Train loss: 0.204, Test loss: 1.679, Test accuracy: 63.40 

Round  19, Global train loss: 0.204, Global test loss: 2.551, Global test accuracy: 45.60 

Round  20, Train loss: 0.185, Test loss: 1.824, Test accuracy: 62.80 

Round  20, Global train loss: 0.185, Global test loss: 2.844, Global test accuracy: 41.50 

Round  21, Train loss: 0.185, Test loss: 2.018, Test accuracy: 62.20 

Round  21, Global train loss: 0.185, Global test loss: 2.463, Global test accuracy: 44.40 

Round  22, Train loss: 0.170, Test loss: 1.853, Test accuracy: 63.30 

Round  22, Global train loss: 0.170, Global test loss: 2.504, Global test accuracy: 46.80 

Round  23, Train loss: 0.148, Test loss: 1.544, Test accuracy: 67.80 

Round  23, Global train loss: 0.148, Global test loss: 2.612, Global test accuracy: 45.60 

Round  24, Train loss: 0.130, Test loss: 1.855, Test accuracy: 62.70 

Round  24, Global train loss: 0.130, Global test loss: 2.690, Global test accuracy: 44.30 

Round  25, Train loss: 0.111, Test loss: 1.778, Test accuracy: 66.60 

Round  25, Global train loss: 0.111, Global test loss: 2.741, Global test accuracy: 44.50 

Round  26, Train loss: 0.116, Test loss: 1.679, Test accuracy: 65.80 

Round  26, Global train loss: 0.116, Global test loss: 2.842, Global test accuracy: 45.10 

Round  27, Train loss: 0.084, Test loss: 1.699, Test accuracy: 65.80 

Round  27, Global train loss: 0.084, Global test loss: 2.531, Global test accuracy: 48.30 

Round  28, Train loss: 0.093, Test loss: 1.890, Test accuracy: 65.80 

Round  28, Global train loss: 0.093, Global test loss: 2.539, Global test accuracy: 49.10 

Round  29, Train loss: 0.056, Test loss: 1.974, Test accuracy: 65.20 

Round  29, Global train loss: 0.056, Global test loss: 2.754, Global test accuracy: 46.40 

Round  30, Train loss: 0.106, Test loss: 1.676, Test accuracy: 67.70 

Round  30, Global train loss: 0.106, Global test loss: 2.769, Global test accuracy: 49.50 

Round  31, Train loss: 0.065, Test loss: 1.859, Test accuracy: 67.50 

Round  31, Global train loss: 0.065, Global test loss: 2.906, Global test accuracy: 47.00 

Round  32, Train loss: 0.063, Test loss: 1.902, Test accuracy: 64.00 

Round  32, Global train loss: 0.063, Global test loss: 2.738, Global test accuracy: 47.00 

Round  33, Train loss: 0.048, Test loss: 1.718, Test accuracy: 66.50 

Round  33, Global train loss: 0.048, Global test loss: 2.706, Global test accuracy: 47.80 

Round  34, Train loss: 0.038, Test loss: 1.856, Test accuracy: 65.40 

Round  34, Global train loss: 0.038, Global test loss: 2.776, Global test accuracy: 47.40 

Final Round, Train loss: 0.062, Test loss: 1.777, Test accuracy: 64.90 

Final Round, Global train loss: 0.062, Global test loss: 2.776, Global test accuracy: 47.40 

Average accuracy final 10 rounds: 66.03 

Average global accuracy final 10 rounds: 47.21000000000001 

470.5750935077667
[8.581216812133789, 14.589489221572876, 20.740015268325806, 26.758628606796265, 32.30568265914917, 37.88162589073181, 43.52538323402405, 49.025968074798584, 54.80204153060913, 60.460180044174194, 66.07483863830566, 71.70317554473877, 77.32470941543579, 82.90690207481384, 88.45696449279785, 93.8620707988739, 99.39422345161438, 105.08311533927917, 110.751793384552, 116.70767641067505, 122.34411478042603, 128.05227732658386, 133.66151642799377, 139.4027087688446, 144.92187666893005, 150.5043785572052, 156.0956699848175, 161.66785049438477, 167.1936376094818, 172.7183952331543, 178.6013789176941, 184.50018978118896, 190.59284210205078, 196.11023783683777, 201.7565405368805, 212.8783254623413]
[48.9, 47.9, 56.4, 55.0, 48.9, 53.9, 56.4, 60.3, 62.1, 61.7, 59.1, 62.5, 59.4, 61.0, 64.1, 60.7, 60.6, 62.4, 62.3, 63.4, 62.8, 62.2, 63.3, 67.8, 62.7, 66.6, 65.8, 65.8, 65.8, 65.2, 67.7, 67.5, 64.0, 66.5, 65.4, 64.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.532, Test loss: 1.595, Test accuracy: 29.50 

Round   1, Train loss: 1.305, Test loss: 1.230, Test accuracy: 49.50 

Round   2, Train loss: 1.165, Test loss: 1.282, Test accuracy: 48.30 

Round   3, Train loss: 1.063, Test loss: 1.090, Test accuracy: 53.70 

Round   4, Train loss: 0.979, Test loss: 1.285, Test accuracy: 48.60 

Round   5, Train loss: 0.916, Test loss: 1.221, Test accuracy: 52.90 

Round   6, Train loss: 0.851, Test loss: 1.117, Test accuracy: 55.80 

Round   7, Train loss: 0.801, Test loss: 1.142, Test accuracy: 58.90 

Round   8, Train loss: 0.765, Test loss: 1.009, Test accuracy: 60.90 

Round   9, Train loss: 0.690, Test loss: 1.038, Test accuracy: 61.10 

Round  10, Train loss: 0.636, Test loss: 1.192, Test accuracy: 61.80 

Round  11, Train loss: 0.641, Test loss: 1.136, Test accuracy: 62.00 

Round  12, Train loss: 0.566, Test loss: 1.087, Test accuracy: 60.20 

Round  13, Train loss: 0.502, Test loss: 1.081, Test accuracy: 63.60 

Round  14, Train loss: 0.472, Test loss: 1.093, Test accuracy: 63.00 

Round  15, Train loss: 0.422, Test loss: 1.119, Test accuracy: 63.00 

Round  16, Train loss: 0.391, Test loss: 1.129, Test accuracy: 64.40 

Round  17, Train loss: 0.364, Test loss: 1.216, Test accuracy: 63.20 

Round  18, Train loss: 0.326, Test loss: 1.375, Test accuracy: 59.80 

Round  19, Train loss: 0.297, Test loss: 1.266, Test accuracy: 64.00 

Round  20, Train loss: 0.281, Test loss: 1.306, Test accuracy: 63.70 

Round  21, Train loss: 0.245, Test loss: 1.314, Test accuracy: 62.80 

Round  22, Train loss: 0.232, Test loss: 1.280, Test accuracy: 63.20 

Round  23, Train loss: 0.217, Test loss: 1.324, Test accuracy: 64.40 

Round  24, Train loss: 0.201, Test loss: 1.344, Test accuracy: 64.30 

Round  25, Train loss: 0.177, Test loss: 1.333, Test accuracy: 66.40 

Round  26, Train loss: 0.174, Test loss: 1.296, Test accuracy: 64.90 

Round  27, Train loss: 0.144, Test loss: 1.286, Test accuracy: 67.00 

Round  28, Train loss: 0.147, Test loss: 1.273, Test accuracy: 67.20 

Round  29, Train loss: 0.109, Test loss: 1.431, Test accuracy: 63.30 

Round  30, Train loss: 0.113, Test loss: 1.370, Test accuracy: 66.80 

Round  31, Train loss: 0.098, Test loss: 1.410, Test accuracy: 66.00 

Round  32, Train loss: 0.099, Test loss: 1.536, Test accuracy: 64.60 

Round  33, Train loss: 0.112, Test loss: 1.465, Test accuracy: 65.00 

Round  34, Train loss: 0.087, Test loss: 1.355, Test accuracy: 67.30 

Round  35, Train loss: 0.055, Test loss: 1.416, Test accuracy: 66.80 

Round  36, Train loss: 0.038, Test loss: 1.468, Test accuracy: 66.90 

Round  37, Train loss: 0.071, Test loss: 1.508, Test accuracy: 65.90 

Round  38, Train loss: 0.076, Test loss: 1.568, Test accuracy: 65.10 

Round  39, Train loss: 0.084, Test loss: 1.509, Test accuracy: 66.50 

Final Round, Train loss: 0.045, Test loss: 1.521, Test accuracy: 66.00 

Average accuracy final 10 rounds: 66.09 

385.2314715385437
[6.8834497928619385, 11.10761833190918, 15.3200101852417, 19.965076446533203, 24.17879867553711, 28.43102741241455, 32.754209995269775, 37.147136211395264, 41.4755380153656, 45.910075187683105, 50.40321326255798, 54.7047381401062, 59.15925168991089, 63.5197377204895, 67.91412019729614, 72.33831548690796, 76.45504260063171, 80.94733572006226, 85.50546050071716, 90.01682448387146, 94.29484248161316, 98.61434555053711, 103.03936195373535, 107.36806631088257, 111.74439668655396, 116.1032223701477, 120.5037100315094, 124.67079544067383, 129.01608443260193, 133.60592937469482, 137.95636224746704, 142.27574825286865, 146.5212526321411, 150.86362385749817, 155.37225317955017, 159.68408179283142, 164.0869219303131, 168.40420365333557, 172.85241150856018, 177.06357407569885, 181.41407084465027]
[29.5, 49.5, 48.3, 53.7, 48.6, 52.9, 55.8, 58.9, 60.9, 61.1, 61.8, 62.0, 60.2, 63.6, 63.0, 63.0, 64.4, 63.2, 59.8, 64.0, 63.7, 62.8, 63.2, 64.4, 64.3, 66.4, 64.9, 67.0, 67.2, 63.3, 66.8, 66.0, 64.6, 65.0, 67.3, 66.8, 66.9, 65.9, 65.1, 66.5, 66.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.518, Test loss: 1.681, Test accuracy: 28.70
Round   1, Train loss: 1.313, Test loss: 1.276, Test accuracy: 44.50
Round   2, Train loss: 1.154, Test loss: 1.140, Test accuracy: 53.70
Round   3, Train loss: 1.056, Test loss: 1.129, Test accuracy: 52.90
Round   4, Train loss: 0.974, Test loss: 1.030, Test accuracy: 59.30
Round   5, Train loss: 0.940, Test loss: 1.071, Test accuracy: 57.50
Round   6, Train loss: 0.853, Test loss: 0.966, Test accuracy: 61.40
Round   7, Train loss: 0.782, Test loss: 0.962, Test accuracy: 62.70
Round   8, Train loss: 0.735, Test loss: 0.954, Test accuracy: 63.40
Round   9, Train loss: 0.679, Test loss: 0.994, Test accuracy: 63.10
Round  10, Train loss: 0.609, Test loss: 1.030, Test accuracy: 60.10
Round  11, Train loss: 0.560, Test loss: 0.974, Test accuracy: 62.50
Round  12, Train loss: 0.520, Test loss: 1.009, Test accuracy: 64.70
Round  13, Train loss: 0.477, Test loss: 1.019, Test accuracy: 64.40
Round  14, Train loss: 0.450, Test loss: 1.022, Test accuracy: 64.40
Round  15, Train loss: 0.383, Test loss: 1.082, Test accuracy: 62.50
Round  16, Train loss: 0.384, Test loss: 1.032, Test accuracy: 65.30
Round  17, Train loss: 0.332, Test loss: 1.076, Test accuracy: 63.90
Round  18, Train loss: 0.290, Test loss: 1.057, Test accuracy: 66.30
Round  19, Train loss: 0.287, Test loss: 1.123, Test accuracy: 64.00
Round  20, Train loss: 0.241, Test loss: 1.167, Test accuracy: 64.30
Round  21, Train loss: 0.236, Test loss: 1.121, Test accuracy: 65.60
Round  22, Train loss: 0.212, Test loss: 1.168, Test accuracy: 65.90
Round  23, Train loss: 0.214, Test loss: 1.268, Test accuracy: 64.30
Round  24, Train loss: 0.169, Test loss: 1.246, Test accuracy: 64.60
Round  25, Train loss: 0.167, Test loss: 1.246, Test accuracy: 66.00
Round  26, Train loss: 0.155, Test loss: 1.242, Test accuracy: 63.70
Round  27, Train loss: 0.141, Test loss: 1.296, Test accuracy: 65.10
Round  28, Train loss: 0.144, Test loss: 1.298, Test accuracy: 66.20
Round  29, Train loss: 0.111, Test loss: 1.313, Test accuracy: 66.30
Round  30, Train loss: 0.105, Test loss: 1.280, Test accuracy: 65.30
Round  31, Train loss: 0.102, Test loss: 1.341, Test accuracy: 65.80
Round  32, Train loss: 0.089, Test loss: 1.395, Test accuracy: 65.00
Round  33, Train loss: 0.073, Test loss: 1.341, Test accuracy: 66.20
Round  34, Train loss: 0.098, Test loss: 1.371, Test accuracy: 65.40
Round  35, Train loss: 0.072, Test loss: 1.361, Test accuracy: 64.80
Round  36, Train loss: 0.068, Test loss: 1.328, Test accuracy: 68.00
Round  37, Train loss: 0.053, Test loss: 1.383, Test accuracy: 65.80
Round  38, Train loss: 0.064, Test loss: 1.410, Test accuracy: 66.00
Round  39, Train loss: 0.045, Test loss: 1.415, Test accuracy: 66.30
Final Round, Train loss: 0.028, Test loss: 1.415, Test accuracy: 66.40
Average accuracy final 10 rounds: 65.86
439.6577718257904
[6.860877752304077, 12.114552021026611, 17.807737350463867, 22.77060079574585, 28.158227920532227, 33.33158612251282, 38.24814510345459, 43.4448459148407, 48.41920280456543, 53.292845487594604, 58.361902475357056, 63.199836015701294, 68.21016883850098, 73.59049272537231, 78.680344581604, 83.71223163604736, 88.68130421638489, 93.79947233200073, 98.94490599632263, 104.0330114364624, 109.044264793396, 114.07255458831787, 119.11646270751953, 124.16253089904785, 128.99988842010498, 133.88136410713196, 138.80060863494873, 143.76129388809204, 149.07707691192627, 154.35439205169678, 159.28900122642517, 164.25381088256836, 169.13014721870422, 174.07915544509888, 179.56288075447083, 184.43204188346863, 189.3182499408722, 194.6779601573944, 199.4183361530304, 204.3095633983612, 209.08617639541626]
[28.7, 44.5, 53.7, 52.9, 59.3, 57.5, 61.4, 62.7, 63.4, 63.1, 60.1, 62.5, 64.7, 64.4, 64.4, 62.5, 65.3, 63.9, 66.3, 64.0, 64.3, 65.6, 65.9, 64.3, 64.6, 66.0, 63.7, 65.1, 66.2, 66.3, 65.3, 65.8, 65.0, 66.2, 65.4, 64.8, 68.0, 65.8, 66.0, 66.3, 66.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.433, Train accuracy: 85.800, Test loss: 1.449, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.191, Train accuracy: 92.800, Test loss: 0.856, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.145, Train accuracy: 94.600, Test loss: 0.848, Test accuracy: 73.00 

Round   0, Train loss: 0.145, Test loss: 0.848, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.088, Train accuracy: 97.600, Test loss: 0.882, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.207, Train accuracy: 92.000, Test loss: 1.187, Test accuracy: 68.60 

Round   1, Train loss: 0.207, Test loss: 1.187, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.076, Train accuracy: 98.200, Test loss: 0.935, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.085, Train accuracy: 97.400, Test loss: 1.036, Test accuracy: 72.40 

Round   2, Train loss: 0.085, Test loss: 1.036, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.053, Train accuracy: 98.200, Test loss: 0.962, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.119, Train accuracy: 96.200, Test loss: 1.267, Test accuracy: 68.00 

Round   3, Train loss: 0.119, Test loss: 1.267, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.042, Train accuracy: 99.000, Test loss: 1.047, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.129, Train accuracy: 96.200, Test loss: 1.111, Test accuracy: 71.00 

Round   4, Train loss: 0.129, Test loss: 1.111, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.048, Train accuracy: 98.600, Test loss: 1.075, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.107, Train accuracy: 95.600, Test loss: 1.240, Test accuracy: 71.60 

Round   5, Train loss: 0.107, Test loss: 1.240, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.045, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.050, Train accuracy: 97.800, Test loss: 1.168, Test accuracy: 72.20 

Round   6, Train loss: 0.050, Test loss: 1.168, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.600, Test loss: 1.017, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.158, Test accuracy: 73.40 

Round   7, Train loss: 0.008, Test loss: 1.158, Test accuracy: 73.40 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.181, Test accuracy: 74.20 

Round   8, Train loss: 0.014, Test loss: 1.181, Test accuracy: 74.20 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.039, Train accuracy: 98.600, Test loss: 1.321, Test accuracy: 72.00 

Round   9, Train loss: 0.039, Test loss: 1.321, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.113, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.201, Test accuracy: 74.80 

Round  10, Train loss: 0.009, Test loss: 1.201, Test accuracy: 74.80 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.175, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.040, Train accuracy: 98.600, Test loss: 1.077, Test accuracy: 76.80 

Round  11, Train loss: 0.040, Test loss: 1.077, Test accuracy: 76.80 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 0.977, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.033, Train accuracy: 98.800, Test loss: 1.397, Test accuracy: 74.40 

Round  12, Train loss: 0.033, Test loss: 1.397, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.284, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.109, Test accuracy: 75.40 

Round  13, Train loss: 0.003, Test loss: 1.109, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.133, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.207, Test accuracy: 74.80 

Round  14, Train loss: 0.005, Test loss: 1.207, Test accuracy: 74.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.232, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.416, Test accuracy: 74.20 

Round  15, Train loss: 0.011, Test loss: 1.416, Test accuracy: 74.20 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.366, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.023, Train accuracy: 98.800, Test loss: 1.473, Test accuracy: 73.80 

Round  16, Train loss: 0.023, Test loss: 1.473, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.236, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.352, Test accuracy: 73.20 

Round  17, Train loss: 0.007, Test loss: 1.352, Test accuracy: 73.20 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.350, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.329, Test accuracy: 74.80 

Round  18, Train loss: 0.001, Test loss: 1.329, Test accuracy: 74.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.344, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.023, Train accuracy: 98.600, Test loss: 1.952, Test accuracy: 67.80 

Round  19, Train loss: 0.023, Test loss: 1.952, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.773, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.684, Test accuracy: 71.00 

Final Round, Train loss: 0.012, Test loss: 1.849, Test accuracy: 69.80 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.203, Train accuracy: 93.800, Test loss: 1.956, Test accuracy: 50.00 

        train local model (freeze embeding):client   0,  Train loss: 0.432, Train accuracy: 85.800, Test loss: 1.443, Test accuracy: 58.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.793, Train accuracy: 68.800, Test loss: 1.931, Test accuracy: 44.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.395, Train accuracy: 84.600, Test loss: 1.845, Test accuracy: 48.40 

Round   0, Train loss: 0.199, Test loss: 1.616, Test accuracy: 53.70 

        train local model (freeze embeding):client   0,  Train loss: 0.146, Train accuracy: 95.800, Test loss: 1.041, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.106, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.536, Train accuracy: 78.000, Test loss: 1.683, Test accuracy: 49.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.460, Train accuracy: 82.200, Test loss: 2.104, Test accuracy: 51.60 

Round   1, Train loss: 0.236, Test loss: 1.705, Test accuracy: 55.50 

        train local model (freeze embeding):client   0,  Train loss: 0.131, Train accuracy: 96.000, Test loss: 1.243, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.008, Test accuracy: 74.80 

        train local model (freeze embeding):client   1,  Train loss: 0.365, Train accuracy: 88.000, Test loss: 1.564, Test accuracy: 53.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.281, Train accuracy: 89.400, Test loss: 1.903, Test accuracy: 52.80 

Round   2, Train loss: 0.142, Test loss: 1.352, Test accuracy: 60.50 

        train local model (freeze embeding):client   0,  Train loss: 0.065, Train accuracy: 98.400, Test loss: 1.122, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.113, Train accuracy: 96.800, Test loss: 1.528, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.319, Train accuracy: 88.800, Test loss: 1.632, Test accuracy: 54.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.197, Train accuracy: 93.000, Test loss: 1.885, Test accuracy: 55.20 

Round   3, Train loss: 0.155, Test loss: 1.489, Test accuracy: 60.50 

        train local model (freeze embeding):client   0,  Train loss: 0.076, Train accuracy: 98.000, Test loss: 1.160, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.097, Test accuracy: 74.80 

        train local model (freeze embeding):client   1,  Train loss: 0.212, Train accuracy: 93.000, Test loss: 1.599, Test accuracy: 56.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.238, Train accuracy: 89.400, Test loss: 2.122, Test accuracy: 52.00 

Round   4, Train loss: 0.123, Test loss: 1.436, Test accuracy: 60.30 

        train local model (freeze embeding):client   0,  Train loss: 0.047, Train accuracy: 99.200, Test loss: 1.156, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.088, Test accuracy: 75.40 

        train local model (freeze embeding):client   1,  Train loss: 0.156, Train accuracy: 95.600, Test loss: 1.689, Test accuracy: 55.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.216, Train accuracy: 92.400, Test loss: 2.230, Test accuracy: 52.80 

Round   5, Train loss: 0.112, Test loss: 1.506, Test accuracy: 61.30 

        train local model (freeze embeding):client   0,  Train loss: 0.059, Train accuracy: 98.800, Test loss: 1.143, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.152, Train accuracy: 94.200, Test loss: 1.752, Test accuracy: 55.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.216, Train accuracy: 91.200, Test loss: 2.229, Test accuracy: 53.00 

Round   6, Train loss: 0.109, Test loss: 1.443, Test accuracy: 61.30 

        train local model (freeze embeding):client   0,  Train loss: 0.059, Train accuracy: 98.400, Test loss: 1.234, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.282, Test accuracy: 74.80 

        train local model (freeze embeding):client   1,  Train loss: 0.158, Train accuracy: 95.600, Test loss: 1.876, Test accuracy: 54.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.108, Train accuracy: 96.400, Test loss: 2.285, Test accuracy: 52.00 

Round   7, Train loss: 0.057, Test loss: 1.608, Test accuracy: 61.10 

        train local model (freeze embeding):client   0,  Train loss: 0.042, Train accuracy: 98.800, Test loss: 1.180, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.317, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.116, Train accuracy: 96.000, Test loss: 1.943, Test accuracy: 54.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.074, Train accuracy: 97.200, Test loss: 2.719, Test accuracy: 53.60 

Round   8, Train loss: 0.039, Test loss: 1.737, Test accuracy: 60.30 

        train local model (freeze embeding):client   0,  Train loss: 0.033, Train accuracy: 98.800, Test loss: 1.281, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.379, Test accuracy: 74.20 

        train local model (freeze embeding):client   1,  Train loss: 0.065, Train accuracy: 98.200, Test loss: 2.086, Test accuracy: 54.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.230, Train accuracy: 91.800, Test loss: 2.769, Test accuracy: 49.00 

Round   9, Train loss: 0.122, Test loss: 1.573, Test accuracy: 63.20 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.155, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.080, Train accuracy: 97.600, Test loss: 2.033, Test accuracy: 55.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.084, Train accuracy: 97.200, Test loss: 2.204, Test accuracy: 55.00 

Round  10, Train loss: 0.043, Test loss: 1.603, Test accuracy: 62.10 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.600, Test loss: 1.243, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.288, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.045, Train accuracy: 98.600, Test loss: 2.036, Test accuracy: 59.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.101, Train accuracy: 96.000, Test loss: 2.295, Test accuracy: 52.40 

Round  11, Train loss: 0.055, Test loss: 1.683, Test accuracy: 61.30 

        train local model (freeze embeding):client   0,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 1.257, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 73.80 

        train local model (freeze embeding):client   1,  Train loss: 0.051, Train accuracy: 98.200, Test loss: 2.116, Test accuracy: 55.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.266, Train accuracy: 91.000, Test loss: 3.224, Test accuracy: 53.60 

Round  12, Train loss: 0.135, Test loss: 1.754, Test accuracy: 61.80 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.600, Test loss: 1.237, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.079, Train accuracy: 97.400, Test loss: 1.586, Test accuracy: 71.80 

        train local model (freeze embeding):client   1,  Train loss: 0.053, Train accuracy: 99.200, Test loss: 2.073, Test accuracy: 54.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.033, Train accuracy: 99.400, Test loss: 2.330, Test accuracy: 56.80 

Round  13, Train loss: 0.056, Test loss: 1.611, Test accuracy: 63.00 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 1.264, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.169, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.046, Train accuracy: 99.200, Test loss: 2.149, Test accuracy: 54.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.190, Train accuracy: 93.200, Test loss: 2.773, Test accuracy: 49.80 

Round  14, Train loss: 0.097, Test loss: 1.648, Test accuracy: 62.10 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.262, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.046, Train accuracy: 99.000, Test loss: 2.157, Test accuracy: 55.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.034, Train accuracy: 98.600, Test loss: 2.663, Test accuracy: 57.00 

Round  15, Train loss: 0.020, Test loss: 1.738, Test accuracy: 64.10 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.800, Test loss: 1.275, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.238, Test accuracy: 74.40 

        train local model (freeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 2.202, Test accuracy: 56.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.235, Train accuracy: 92.200, Test loss: 2.818, Test accuracy: 50.60 

Round  16, Train loss: 0.118, Test loss: 1.705, Test accuracy: 62.50 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 1.201, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.265, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 2.129, Test accuracy: 56.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 2.733, Test accuracy: 55.00 

Round  17, Train loss: 0.020, Test loss: 1.768, Test accuracy: 63.90 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.122, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 75.20 

        train local model (freeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.800, Test loss: 2.222, Test accuracy: 56.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 2.495, Test accuracy: 54.60 

Round  18, Train loss: 0.008, Test loss: 1.745, Test accuracy: 64.70 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.238, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.179, Test accuracy: 75.80 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 2.286, Test accuracy: 56.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.073, Train accuracy: 96.200, Test loss: 2.681, Test accuracy: 54.20 

Round  19, Train loss: 0.038, Test loss: 1.817, Test accuracy: 64.50 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.191, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.157, Test accuracy: 73.80 

        train local model (freeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 2.425, Test accuracy: 56.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 2.442, Test accuracy: 56.40 

Final Round, Train loss: 0.010, Test loss: 1.649, Test accuracy: 65.50 

Average accuracy final 10 rounds: 136.99999999999997 

679.5526928901672
[10.24876594543457, 19.308700799942017, 28.52658247947693, 37.584389448165894, 46.70943784713745, 56.03305196762085, 65.16468238830566, 75.37325143814087, 84.9423234462738, 94.21620225906372, 103.74624586105347, 113.6769425868988, 123.69906806945801, 133.43302512168884, 142.6824767589569, 152.37464547157288, 162.02966356277466, 171.60401034355164, 181.46938967704773, 190.87610268592834, 197.20187973976135, 206.81167316436768, 216.56320667266846, 226.47366404533386, 235.9162368774414, 245.27099514007568, 254.71519947052002, 264.32723474502563, 273.7958378791809, 283.3954577445984, 293.20047879219055, 302.6228709220886, 312.64511346817017, 322.03996562957764, 331.2688982486725, 340.9942524433136, 350.9227042198181, 360.50074791908264, 369.7716155052185, 379.52192521095276, 388.7661406993866, 394.687362909317]
[73.0, 68.6, 72.4, 68.0, 71.0, 71.6, 72.2, 73.4, 74.2, 72.0, 74.8, 76.8, 74.4, 75.4, 74.8, 74.2, 73.8, 73.2, 74.8, 67.8, 69.8, 53.7, 55.5, 60.5, 60.5, 60.3, 61.3, 61.3, 61.1, 60.3, 63.2, 62.1, 61.3, 61.8, 63.0, 62.1, 64.1, 62.5, 63.9, 64.7, 64.5, 65.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.456, Test loss: 1.570, Test accuracy: 39.60 

Round   0, Global train loss: 1.456, Global test loss: 2.203, Global test accuracy: 20.00 

Round   1, Train loss: 1.108, Test loss: 1.110, Test accuracy: 55.70 

Round   1, Global train loss: 1.108, Global test loss: 1.941, Global test accuracy: 20.20 

Round   2, Train loss: 0.958, Test loss: 1.292, Test accuracy: 53.90 

Round   2, Global train loss: 0.958, Global test loss: 2.281, Global test accuracy: 20.00 

Round   3, Train loss: 0.826, Test loss: 1.458, Test accuracy: 53.70 

Round   3, Global train loss: 0.826, Global test loss: 2.417, Global test accuracy: 20.20 

Round   4, Train loss: 0.712, Test loss: 1.238, Test accuracy: 58.00 

Round   4, Global train loss: 0.712, Global test loss: 2.843, Global test accuracy: 20.00 

Round   5, Train loss: 0.605, Test loss: 1.630, Test accuracy: 54.80 

Round   5, Global train loss: 0.605, Global test loss: 2.797, Global test accuracy: 20.20 

Round   6, Train loss: 0.525, Test loss: 1.643, Test accuracy: 56.90 

Round   6, Global train loss: 0.525, Global test loss: 3.587, Global test accuracy: 20.00 

Round   7, Train loss: 0.436, Test loss: 1.655, Test accuracy: 58.80 

Round   7, Global train loss: 0.436, Global test loss: 2.961, Global test accuracy: 20.10 

Round   8, Train loss: 0.378, Test loss: 1.354, Test accuracy: 60.70 

Round   8, Global train loss: 0.378, Global test loss: 2.932, Global test accuracy: 20.10 

Round   9, Train loss: 0.296, Test loss: 1.687, Test accuracy: 60.20 

Round   9, Global train loss: 0.296, Global test loss: 3.680, Global test accuracy: 20.00 

Round  10, Train loss: 0.267, Test loss: 1.589, Test accuracy: 64.00 

Round  10, Global train loss: 0.267, Global test loss: 3.209, Global test accuracy: 20.70 

Round  11, Train loss: 0.222, Test loss: 1.868, Test accuracy: 59.70 

Round  11, Global train loss: 0.222, Global test loss: 3.297, Global test accuracy: 20.50 

Round  12, Train loss: 0.227, Test loss: 1.678, Test accuracy: 63.80 

Round  12, Global train loss: 0.227, Global test loss: 3.287, Global test accuracy: 19.90 

Round  13, Train loss: 0.147, Test loss: 1.661, Test accuracy: 64.10 

Round  13, Global train loss: 0.147, Global test loss: 3.237, Global test accuracy: 20.60 

Round  14, Train loss: 0.140, Test loss: 1.703, Test accuracy: 63.00 

Round  14, Global train loss: 0.140, Global test loss: 3.623, Global test accuracy: 20.30 

Round  15, Train loss: 0.116, Test loss: 1.498, Test accuracy: 68.60 

Round  15, Global train loss: 0.116, Global test loss: 3.475, Global test accuracy: 21.60 

Round  16, Train loss: 0.098, Test loss: 1.533, Test accuracy: 65.60 

Round  16, Global train loss: 0.098, Global test loss: 4.099, Global test accuracy: 20.00 

Round  17, Train loss: 0.097, Test loss: 1.604, Test accuracy: 66.20 

Round  17, Global train loss: 0.097, Global test loss: 4.065, Global test accuracy: 20.00 

Round  18, Train loss: 0.086, Test loss: 1.837, Test accuracy: 64.90 

Round  18, Global train loss: 0.086, Global test loss: 3.396, Global test accuracy: 23.60 

Round  19, Train loss: 0.075, Test loss: 1.848, Test accuracy: 63.70 

Round  19, Global train loss: 0.075, Global test loss: 3.685, Global test accuracy: 24.50 

Round  20, Train loss: 0.098, Test loss: 1.559, Test accuracy: 68.70 

Round  20, Global train loss: 0.098, Global test loss: 3.202, Global test accuracy: 21.10 

Round  21, Train loss: 0.071, Test loss: 1.662, Test accuracy: 65.30 

Round  21, Global train loss: 0.071, Global test loss: 3.030, Global test accuracy: 22.30 

Round  22, Train loss: 0.045, Test loss: 1.658, Test accuracy: 67.20 

Round  22, Global train loss: 0.045, Global test loss: 3.715, Global test accuracy: 21.70 

Round  23, Train loss: 0.033, Test loss: 1.774, Test accuracy: 65.80 

Round  23, Global train loss: 0.033, Global test loss: 3.716, Global test accuracy: 20.50 

Round  24, Train loss: 0.036, Test loss: 1.679, Test accuracy: 67.30 

Round  24, Global train loss: 0.036, Global test loss: 3.446, Global test accuracy: 22.20 

Round  25, Train loss: 0.040, Test loss: 1.723, Test accuracy: 66.70 

Round  25, Global train loss: 0.040, Global test loss: 3.413, Global test accuracy: 24.20 

Round  26, Train loss: 0.055, Test loss: 1.840, Test accuracy: 65.60 

Round  26, Global train loss: 0.055, Global test loss: 3.711, Global test accuracy: 22.40 

Round  27, Train loss: 0.028, Test loss: 1.687, Test accuracy: 68.30 

Round  27, Global train loss: 0.028, Global test loss: 3.798, Global test accuracy: 22.00 

Round  28, Train loss: 0.056, Test loss: 1.786, Test accuracy: 67.10 

Round  28, Global train loss: 0.056, Global test loss: 3.727, Global test accuracy: 21.40 

Round  29, Train loss: 0.049, Test loss: 1.772, Test accuracy: 65.60 

Round  29, Global train loss: 0.049, Global test loss: 3.582, Global test accuracy: 19.90 

Round  30, Train loss: 0.044, Test loss: 1.811, Test accuracy: 64.90 

Round  30, Global train loss: 0.044, Global test loss: 3.891, Global test accuracy: 20.20 

Round  31, Train loss: 0.018, Test loss: 1.857, Test accuracy: 66.20 

Round  31, Global train loss: 0.018, Global test loss: 3.889, Global test accuracy: 23.50 

Round  32, Train loss: 0.019, Test loss: 1.723, Test accuracy: 66.80 

Round  32, Global train loss: 0.019, Global test loss: 4.060, Global test accuracy: 22.30 

Round  33, Train loss: 0.013, Test loss: 1.774, Test accuracy: 67.40 

Round  33, Global train loss: 0.013, Global test loss: 4.129, Global test accuracy: 24.20 

Round  34, Train loss: 0.014, Test loss: 1.876, Test accuracy: 67.80 

Round  34, Global train loss: 0.014, Global test loss: 4.059, Global test accuracy: 23.70 

Final Round, Train loss: 0.035, Test loss: 2.057, Test accuracy: 63.10 

Final Round, Global train loss: 0.035, Global test loss: 4.059, Global test accuracy: 23.70 

Average accuracy final 10 rounds: 66.64 

Average global accuracy final 10 rounds: 22.38 

485.2509036064148
[7.615354061126709, 13.148030757904053, 18.816237211227417, 24.60351037979126, 30.19205117225647, 35.82918953895569, 41.85951566696167, 47.62614679336548, 53.80874156951904, 59.548736572265625, 65.54369115829468, 71.40441131591797, 77.54413080215454, 83.91619277000427, 89.94230532646179, 96.06478810310364, 102.18786644935608, 108.24285411834717, 114.08182406425476, 120.32880139350891, 125.97087144851685, 131.960999250412, 137.5843164920807, 143.86595273017883, 150.2619984149933, 156.44862580299377, 163.0303726196289, 169.07319617271423, 175.08863472938538, 181.07965803146362, 187.46564292907715, 193.63867783546448, 199.87701439857483, 205.5675230026245, 211.3711748123169, 222.9354031085968]
[39.6, 55.7, 53.9, 53.7, 58.0, 54.8, 56.9, 58.8, 60.7, 60.2, 64.0, 59.7, 63.8, 64.1, 63.0, 68.6, 65.6, 66.2, 64.9, 63.7, 68.7, 65.3, 67.2, 65.8, 67.3, 66.7, 65.6, 68.3, 67.1, 65.6, 64.9, 66.2, 66.8, 67.4, 67.8, 63.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.463, Test loss: 1.409, Test accuracy: 48.70 

Round   0, Global train loss: 1.463, Global test loss: 2.033, Global test accuracy: 20.00 

Round   1, Train loss: 1.257, Test loss: 1.395, Test accuracy: 48.30 

Round   1, Global train loss: 1.257, Global test loss: 1.726, Global test accuracy: 27.10 

Round   2, Train loss: 1.116, Test loss: 1.242, Test accuracy: 55.60 

Round   2, Global train loss: 1.116, Global test loss: 1.425, Global test accuracy: 40.60 

Round   3, Train loss: 1.010, Test loss: 1.157, Test accuracy: 58.40 

Round   3, Global train loss: 1.010, Global test loss: 1.578, Global test accuracy: 40.70 

Round   4, Train loss: 0.889, Test loss: 1.224, Test accuracy: 56.10 

Round   4, Global train loss: 0.889, Global test loss: 1.543, Global test accuracy: 42.60 

Round   5, Train loss: 0.805, Test loss: 1.238, Test accuracy: 58.80 

Round   5, Global train loss: 0.805, Global test loss: 1.861, Global test accuracy: 40.10 

Round   6, Train loss: 0.748, Test loss: 1.369, Test accuracy: 57.60 

Round   6, Global train loss: 0.748, Global test loss: 1.588, Global test accuracy: 45.60 

Round   7, Train loss: 0.644, Test loss: 1.195, Test accuracy: 63.20 

Round   7, Global train loss: 0.644, Global test loss: 1.660, Global test accuracy: 46.80 

Round   8, Train loss: 0.578, Test loss: 1.525, Test accuracy: 58.70 

Round   8, Global train loss: 0.578, Global test loss: 1.531, Global test accuracy: 47.30 

Round   9, Train loss: 0.518, Test loss: 1.452, Test accuracy: 59.60 

Round   9, Global train loss: 0.518, Global test loss: 2.242, Global test accuracy: 40.00 

Round  10, Train loss: 0.462, Test loss: 1.211, Test accuracy: 64.70 

Round  10, Global train loss: 0.462, Global test loss: 1.694, Global test accuracy: 50.30 

Round  11, Train loss: 0.433, Test loss: 1.571, Test accuracy: 59.60 

Round  11, Global train loss: 0.433, Global test loss: 1.957, Global test accuracy: 43.20 

Round  12, Train loss: 0.380, Test loss: 1.697, Test accuracy: 58.60 

Round  12, Global train loss: 0.380, Global test loss: 2.051, Global test accuracy: 44.80 

Round  13, Train loss: 0.341, Test loss: 1.385, Test accuracy: 63.10 

Round  13, Global train loss: 0.341, Global test loss: 1.904, Global test accuracy: 49.10 

Round  14, Train loss: 0.269, Test loss: 1.577, Test accuracy: 62.90 

Round  14, Global train loss: 0.269, Global test loss: 1.897, Global test accuracy: 49.10 

Round  15, Train loss: 0.241, Test loss: 1.383, Test accuracy: 66.60 

Round  15, Global train loss: 0.241, Global test loss: 1.929, Global test accuracy: 49.50 

Round  16, Train loss: 0.245, Test loss: 1.538, Test accuracy: 64.10 

Round  16, Global train loss: 0.245, Global test loss: 2.105, Global test accuracy: 48.30 

Round  17, Train loss: 0.217, Test loss: 1.528, Test accuracy: 64.50 

Round  17, Global train loss: 0.217, Global test loss: 2.114, Global test accuracy: 50.10 

Round  18, Train loss: 0.204, Test loss: 1.614, Test accuracy: 64.80 

Round  18, Global train loss: 0.204, Global test loss: 2.104, Global test accuracy: 48.80 

Round  19, Train loss: 0.178, Test loss: 1.520, Test accuracy: 66.40 

Round  19, Global train loss: 0.178, Global test loss: 2.092, Global test accuracy: 48.90 

Round  20, Train loss: 0.149, Test loss: 1.605, Test accuracy: 67.30 

Round  20, Global train loss: 0.149, Global test loss: 2.260, Global test accuracy: 50.50 

Round  21, Train loss: 0.119, Test loss: 1.651, Test accuracy: 66.50 

Round  21, Global train loss: 0.119, Global test loss: 2.298, Global test accuracy: 51.10 

Round  22, Train loss: 0.155, Test loss: 2.049, Test accuracy: 60.40 

Round  22, Global train loss: 0.155, Global test loss: 2.271, Global test accuracy: 50.10 

Round  23, Train loss: 0.130, Test loss: 1.549, Test accuracy: 67.80 

Round  23, Global train loss: 0.130, Global test loss: 2.256, Global test accuracy: 47.10 

Round  24, Train loss: 0.109, Test loss: 1.621, Test accuracy: 67.40 

Round  24, Global train loss: 0.109, Global test loss: 2.410, Global test accuracy: 48.90 

Round  25, Train loss: 0.119, Test loss: 1.729, Test accuracy: 66.70 

Round  25, Global train loss: 0.119, Global test loss: 2.167, Global test accuracy: 52.20 

Round  26, Train loss: 0.075, Test loss: 1.658, Test accuracy: 67.10 

Round  26, Global train loss: 0.075, Global test loss: 2.326, Global test accuracy: 50.60 

Round  27, Train loss: 0.084, Test loss: 1.840, Test accuracy: 64.70 

Round  27, Global train loss: 0.084, Global test loss: 2.259, Global test accuracy: 49.00 

Round  28, Train loss: 0.085, Test loss: 1.524, Test accuracy: 68.20 

Round  28, Global train loss: 0.085, Global test loss: 2.323, Global test accuracy: 49.30 

Round  29, Train loss: 0.085, Test loss: 1.793, Test accuracy: 68.20 

Round  29, Global train loss: 0.085, Global test loss: 2.243, Global test accuracy: 51.10 

Round  30, Train loss: 0.078, Test loss: 1.934, Test accuracy: 63.70 

Round  30, Global train loss: 0.078, Global test loss: 2.634, Global test accuracy: 46.70 

Round  31, Train loss: 0.054, Test loss: 1.643, Test accuracy: 69.40 

Round  31, Global train loss: 0.054, Global test loss: 2.518, Global test accuracy: 50.90 

Round  32, Train loss: 0.052, Test loss: 1.697, Test accuracy: 68.60 

Round  32, Global train loss: 0.052, Global test loss: 2.439, Global test accuracy: 51.00 

Round  33, Train loss: 0.077, Test loss: 1.894, Test accuracy: 66.90 

Round  33, Global train loss: 0.077, Global test loss: 2.429, Global test accuracy: 48.60 

Round  34, Train loss: 0.057, Test loss: 1.807, Test accuracy: 66.10 

Round  34, Global train loss: 0.057, Global test loss: 2.446, Global test accuracy: 51.70 

Final Round, Train loss: 0.049, Test loss: 1.784, Test accuracy: 67.50 

Final Round, Global train loss: 0.049, Global test loss: 2.446, Global test accuracy: 51.70 

Average accuracy final 10 rounds: 66.96 

Average global accuracy final 10 rounds: 50.11000000000001 

479.03727889060974
[8.292005777359009, 14.17554497718811, 20.21547508239746, 26.331541061401367, 32.532602310180664, 38.674659729003906, 44.69851613044739, 51.05673885345459, 56.95956897735596, 62.91250133514404, 69.12761926651001, 74.8893072605133, 80.50342845916748, 86.13537693023682, 91.61998891830444, 97.13641357421875, 102.99226474761963, 108.56849336624146, 114.27405619621277, 120.05098223686218, 125.65272998809814, 131.24375772476196, 136.86319398880005, 142.36202311515808, 148.33355045318604, 153.94240617752075, 159.54269647598267, 165.01760149002075, 170.70990657806396, 176.6515383720398, 182.2945749759674, 188.14781951904297, 193.74029159545898, 199.47041487693787, 205.15347862243652, 217.0892677307129]
[48.7, 48.3, 55.6, 58.4, 56.1, 58.8, 57.6, 63.2, 58.7, 59.6, 64.7, 59.6, 58.6, 63.1, 62.9, 66.6, 64.1, 64.5, 64.8, 66.4, 67.3, 66.5, 60.4, 67.8, 67.4, 66.7, 67.1, 64.7, 68.2, 68.2, 63.7, 69.4, 68.6, 66.9, 66.1, 67.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.532, Test loss: 1.772, Test accuracy: 27.50 

Round   1, Train loss: 1.348, Test loss: 1.422, Test accuracy: 41.20 

Round   2, Train loss: 1.218, Test loss: 1.210, Test accuracy: 50.70 

Round   3, Train loss: 1.134, Test loss: 1.323, Test accuracy: 48.70 

Round   4, Train loss: 1.033, Test loss: 1.033, Test accuracy: 56.80 

Round   5, Train loss: 0.939, Test loss: 1.057, Test accuracy: 55.20 

Round   6, Train loss: 0.880, Test loss: 1.102, Test accuracy: 56.80 

Round   7, Train loss: 0.809, Test loss: 1.038, Test accuracy: 57.00 

Round   8, Train loss: 0.755, Test loss: 1.078, Test accuracy: 59.80 

Round   9, Train loss: 0.690, Test loss: 0.989, Test accuracy: 62.90 

Round  10, Train loss: 0.633, Test loss: 1.094, Test accuracy: 61.20 

Round  11, Train loss: 0.567, Test loss: 0.987, Test accuracy: 65.70 

Round  12, Train loss: 0.561, Test loss: 1.078, Test accuracy: 61.50 

Round  13, Train loss: 0.486, Test loss: 0.965, Test accuracy: 64.60 

Round  14, Train loss: 0.435, Test loss: 1.042, Test accuracy: 65.90 

Round  15, Train loss: 0.391, Test loss: 0.994, Test accuracy: 65.90 

Round  16, Train loss: 0.392, Test loss: 1.201, Test accuracy: 62.50 

Round  17, Train loss: 0.365, Test loss: 1.073, Test accuracy: 65.10 

Round  18, Train loss: 0.312, Test loss: 1.077, Test accuracy: 66.70 

Round  19, Train loss: 0.287, Test loss: 1.263, Test accuracy: 63.40 

Round  20, Train loss: 0.258, Test loss: 1.137, Test accuracy: 67.60 

Round  21, Train loss: 0.244, Test loss: 1.145, Test accuracy: 65.90 

Round  22, Train loss: 0.211, Test loss: 1.177, Test accuracy: 67.40 

Round  23, Train loss: 0.191, Test loss: 1.274, Test accuracy: 66.30 

Round  24, Train loss: 0.208, Test loss: 1.234, Test accuracy: 65.80 

Round  25, Train loss: 0.165, Test loss: 1.204, Test accuracy: 67.10 

Round  26, Train loss: 0.135, Test loss: 1.155, Test accuracy: 68.40 

Round  27, Train loss: 0.131, Test loss: 1.429, Test accuracy: 66.60 

Round  28, Train loss: 0.133, Test loss: 1.271, Test accuracy: 67.60 

Round  29, Train loss: 0.121, Test loss: 1.267, Test accuracy: 67.50 

Round  30, Train loss: 0.112, Test loss: 1.246, Test accuracy: 68.70 

Round  31, Train loss: 0.123, Test loss: 1.256, Test accuracy: 67.80 

Round  32, Train loss: 0.097, Test loss: 1.378, Test accuracy: 66.30 

Round  33, Train loss: 0.078, Test loss: 1.315, Test accuracy: 67.50 

Round  34, Train loss: 0.080, Test loss: 1.281, Test accuracy: 68.00 

Round  35, Train loss: 0.072, Test loss: 1.347, Test accuracy: 67.40 

Round  36, Train loss: 0.075, Test loss: 1.387, Test accuracy: 67.90 

Round  37, Train loss: 0.064, Test loss: 1.410, Test accuracy: 66.70 

Round  38, Train loss: 0.074, Test loss: 1.375, Test accuracy: 66.50 

Round  39, Train loss: 0.046, Test loss: 1.417, Test accuracy: 68.20 

Final Round, Train loss: 0.040, Test loss: 1.422, Test accuracy: 67.70 

Average accuracy final 10 rounds: 67.5 

416.84884691238403
[7.473461866378784, 12.091407060623169, 16.773984670639038, 21.428900957107544, 26.09853434562683, 30.8064181804657, 35.49200916290283, 40.149653911590576, 44.83665418624878, 49.477128744125366, 54.09144949913025, 58.65084218978882, 63.493706703186035, 68.22266554832458, 72.80616974830627, 77.32371520996094, 82.0035879611969, 86.53154015541077, 91.1100378036499, 95.71602439880371, 100.29974365234375, 105.00692510604858, 109.57967138290405, 114.11145162582397, 118.69004416465759, 123.23224401473999, 127.79697871208191, 132.37730264663696, 136.82924389839172, 141.47023963928223, 146.08239483833313, 150.65330600738525, 155.20817184448242, 159.90318274497986, 164.54490852355957, 169.14955139160156, 173.75367665290833, 178.32209539413452, 182.83097195625305, 187.32297158241272, 193.10584592819214]
[27.5, 41.2, 50.7, 48.7, 56.8, 55.2, 56.8, 57.0, 59.8, 62.9, 61.2, 65.7, 61.5, 64.6, 65.9, 65.9, 62.5, 65.1, 66.7, 63.4, 67.6, 65.9, 67.4, 66.3, 65.8, 67.1, 68.4, 66.6, 67.6, 67.5, 68.7, 67.8, 66.3, 67.5, 68.0, 67.4, 67.9, 66.7, 66.5, 68.2, 67.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.541, Test loss: 1.720, Test accuracy: 25.40
Round   1, Train loss: 1.322, Test loss: 1.344, Test accuracy: 40.80
Round   2, Train loss: 1.196, Test loss: 1.162, Test accuracy: 48.60
Round   3, Train loss: 1.084, Test loss: 1.054, Test accuracy: 55.00
Round   4, Train loss: 0.999, Test loss: 0.975, Test accuracy: 57.50
Round   5, Train loss: 0.909, Test loss: 0.978, Test accuracy: 59.00
Round   6, Train loss: 0.865, Test loss: 1.072, Test accuracy: 57.00
Round   7, Train loss: 0.821, Test loss: 1.082, Test accuracy: 55.80
Round   8, Train loss: 0.721, Test loss: 1.068, Test accuracy: 59.60
Round   9, Train loss: 0.676, Test loss: 1.000, Test accuracy: 62.20
Round  10, Train loss: 0.633, Test loss: 0.980, Test accuracy: 63.40
Round  11, Train loss: 0.577, Test loss: 0.994, Test accuracy: 62.40
Round  12, Train loss: 0.546, Test loss: 1.061, Test accuracy: 63.00
Round  13, Train loss: 0.500, Test loss: 1.082, Test accuracy: 63.30
Round  14, Train loss: 0.456, Test loss: 1.112, Test accuracy: 62.40
Round  15, Train loss: 0.406, Test loss: 1.069, Test accuracy: 64.60
Round  16, Train loss: 0.352, Test loss: 1.042, Test accuracy: 65.90
Round  17, Train loss: 0.344, Test loss: 1.128, Test accuracy: 64.00
Round  18, Train loss: 0.304, Test loss: 1.076, Test accuracy: 64.70
Round  19, Train loss: 0.265, Test loss: 1.213, Test accuracy: 63.70
Round  20, Train loss: 0.267, Test loss: 1.134, Test accuracy: 65.50
Round  21, Train loss: 0.243, Test loss: 1.161, Test accuracy: 67.40
Round  22, Train loss: 0.221, Test loss: 1.200, Test accuracy: 64.80
Round  23, Train loss: 0.200, Test loss: 1.200, Test accuracy: 67.10
Round  24, Train loss: 0.173, Test loss: 1.154, Test accuracy: 69.20
Round  25, Train loss: 0.179, Test loss: 1.239, Test accuracy: 66.10
Round  26, Train loss: 0.167, Test loss: 1.161, Test accuracy: 68.20
Round  27, Train loss: 0.133, Test loss: 1.169, Test accuracy: 68.80
Round  28, Train loss: 0.128, Test loss: 1.187, Test accuracy: 67.20
Round  29, Train loss: 0.119, Test loss: 1.255, Test accuracy: 67.80
Round  30, Train loss: 0.123, Test loss: 1.246, Test accuracy: 67.20
Round  31, Train loss: 0.113, Test loss: 1.288, Test accuracy: 67.40
Round  32, Train loss: 0.082, Test loss: 1.336, Test accuracy: 66.90
Round  33, Train loss: 0.077, Test loss: 1.330, Test accuracy: 67.30
Round  34, Train loss: 0.073, Test loss: 1.325, Test accuracy: 67.00
Round  35, Train loss: 0.063, Test loss: 1.364, Test accuracy: 67.80
Round  36, Train loss: 0.064, Test loss: 1.352, Test accuracy: 68.40
Round  37, Train loss: 0.069, Test loss: 1.442, Test accuracy: 65.30
Round  38, Train loss: 0.060, Test loss: 1.360, Test accuracy: 67.20
Round  39, Train loss: 0.049, Test loss: 1.517, Test accuracy: 66.30
Final Round, Train loss: 0.040, Test loss: 1.507, Test accuracy: 68.20
Average accuracy final 10 rounds: 67.08000000000001
444.57609724998474
[7.030869722366333, 12.20089840888977, 17.311376094818115, 22.43584942817688, 27.609832525253296, 32.59487819671631, 37.629459857940674, 42.788220167160034, 47.720468521118164, 52.83343982696533, 58.08224153518677, 63.47209310531616, 68.3538727760315, 73.16195034980774, 78.34472823143005, 83.48239827156067, 88.68242359161377, 93.79024338722229, 99.02283787727356, 104.03385925292969, 109.01854395866394, 113.96870565414429, 118.93753862380981, 124.01038908958435, 129.51688981056213, 134.75409603118896, 140.09678483009338, 145.02615928649902, 150.3174614906311, 155.51644277572632, 160.88723945617676, 166.00229501724243, 171.70643281936646, 177.06625366210938, 182.25997281074524, 187.4768590927124, 192.63236260414124, 197.90961718559265, 202.83056163787842, 208.02575588226318, 212.86292481422424]
[25.4, 40.8, 48.6, 55.0, 57.5, 59.0, 57.0, 55.8, 59.6, 62.2, 63.4, 62.4, 63.0, 63.3, 62.4, 64.6, 65.9, 64.0, 64.7, 63.7, 65.5, 67.4, 64.8, 67.1, 69.2, 66.1, 68.2, 68.8, 67.2, 67.8, 67.2, 67.4, 66.9, 67.3, 67.0, 67.8, 68.4, 65.3, 67.2, 66.3, 68.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.486, Train accuracy: 80.800, Test loss: 1.387, Test accuracy: 58.80 

        train local model (freeze embeding):client   0,  Train loss: 0.301, Train accuracy: 88.000, Test loss: 1.307, Test accuracy: 59.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.366, Train accuracy: 83.200, Test loss: 1.464, Test accuracy: 56.60 

Round   0, Train loss: 0.366, Test loss: 1.464, Test accuracy: 56.60 

        train local model (freeze embeding):client   0,  Train loss: 0.205, Train accuracy: 92.800, Test loss: 1.239, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.385, Train accuracy: 85.200, Test loss: 1.450, Test accuracy: 57.40 

Round   1, Train loss: 0.385, Test loss: 1.450, Test accuracy: 57.40 

        train local model (freeze embeding):client   0,  Train loss: 0.283, Train accuracy: 89.400, Test loss: 1.434, Test accuracy: 57.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.162, Train accuracy: 94.400, Test loss: 1.587, Test accuracy: 58.20 

Round   2, Train loss: 0.162, Test loss: 1.587, Test accuracy: 58.20 

        train local model (freeze embeding):client   0,  Train loss: 0.132, Train accuracy: 96.200, Test loss: 1.472, Test accuracy: 59.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.105, Train accuracy: 97.200, Test loss: 1.359, Test accuracy: 62.00 

Round   3, Train loss: 0.105, Test loss: 1.359, Test accuracy: 62.00 

        train local model (freeze embeding):client   0,  Train loss: 0.094, Train accuracy: 97.400, Test loss: 1.407, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.448, Train accuracy: 85.800, Test loss: 2.151, Test accuracy: 53.00 

Round   4, Train loss: 0.448, Test loss: 2.151, Test accuracy: 53.00 

        train local model (freeze embeding):client   0,  Train loss: 0.103, Train accuracy: 96.400, Test loss: 1.434, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.552, Train accuracy: 82.000, Test loss: 2.682, Test accuracy: 55.80 

Round   5, Train loss: 0.552, Test loss: 2.682, Test accuracy: 55.80 

        train local model (freeze embeding):client   0,  Train loss: 0.065, Train accuracy: 98.200, Test loss: 1.619, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.049, Train accuracy: 99.000, Test loss: 1.662, Test accuracy: 61.40 

Round   6, Train loss: 0.049, Test loss: 1.662, Test accuracy: 61.40 

        train local model (freeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.200, Test loss: 1.660, Test accuracy: 60.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.089, Train accuracy: 98.200, Test loss: 1.988, Test accuracy: 57.60 

Round   7, Train loss: 0.089, Test loss: 1.988, Test accuracy: 57.60 

        train local model (freeze embeding):client   0,  Train loss: 0.046, Train accuracy: 99.000, Test loss: 1.713, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.054, Train accuracy: 99.000, Test loss: 1.724, Test accuracy: 58.20 

Round   8, Train loss: 0.054, Test loss: 1.724, Test accuracy: 58.20 

        train local model (freeze embeding):client   0,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 1.659, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 1.627, Test accuracy: 60.20 

Round   9, Train loss: 0.024, Test loss: 1.627, Test accuracy: 60.20 

        train local model (freeze embeding):client   0,  Train loss: 0.032, Train accuracy: 98.600, Test loss: 1.722, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.076, Train accuracy: 97.600, Test loss: 2.094, Test accuracy: 58.60 

Round  10, Train loss: 0.076, Test loss: 2.094, Test accuracy: 58.60 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.716, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.200, Test loss: 1.840, Test accuracy: 63.20 

Round  11, Train loss: 0.017, Test loss: 1.840, Test accuracy: 63.20 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.600, Test loss: 1.817, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.841, Test accuracy: 61.60 

Round  12, Train loss: 0.012, Test loss: 1.841, Test accuracy: 61.60 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.400, Test loss: 1.759, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.728, Test accuracy: 65.60 

Round  13, Train loss: 0.006, Test loss: 1.728, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.744, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.135, Train accuracy: 94.200, Test loss: 2.038, Test accuracy: 60.00 

Round  14, Train loss: 0.135, Test loss: 2.038, Test accuracy: 60.00 

        train local model (freeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.400, Test loss: 1.825, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.600, Test loss: 1.777, Test accuracy: 63.40 

Round  15, Train loss: 0.007, Test loss: 1.777, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.771, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.763, Test accuracy: 61.80 

Round  16, Train loss: 0.007, Test loss: 1.763, Test accuracy: 61.80 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.812, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.400, Test loss: 1.707, Test accuracy: 64.80 

Round  17, Train loss: 0.028, Test loss: 1.707, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.700, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.769, Test accuracy: 63.60 

Round  18, Train loss: 0.013, Test loss: 1.769, Test accuracy: 63.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.786, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.906, Test accuracy: 64.60 

Round  19, Train loss: 0.008, Test loss: 1.906, Test accuracy: 64.60 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.856, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.939, Test accuracy: 64.00 

Final Round, Train loss: 0.012, Test loss: 1.931, Test accuracy: 63.40 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.059, Train accuracy: 97.800, Test loss: 1.504, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.338, Train accuracy: 86.600, Test loss: 1.876, Test accuracy: 52.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.585, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.399, Train accuracy: 84.600, Test loss: 1.616, Test accuracy: 58.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.172, Train accuracy: 93.000, Test loss: 1.936, Test accuracy: 61.80 

Round   0, Train loss: 0.088, Test loss: 1.764, Test accuracy: 57.10 

        train local model (freeze embeding):client   0,  Train loss: 0.173, Train accuracy: 93.600, Test loss: 1.758, Test accuracy: 56.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.601, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.237, Train accuracy: 90.600, Test loss: 1.455, Test accuracy: 60.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.226, Train accuracy: 92.800, Test loss: 1.852, Test accuracy: 62.00 

Round   1, Train loss: 0.115, Test loss: 1.634, Test accuracy: 61.10 

        train local model (freeze embeding):client   0,  Train loss: 0.110, Train accuracy: 96.200, Test loss: 1.727, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.054, Train accuracy: 98.200, Test loss: 1.976, Test accuracy: 61.80 

        train local model (freeze embeding):client   1,  Train loss: 0.161, Train accuracy: 95.000, Test loss: 1.404, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.060, Train accuracy: 98.200, Test loss: 1.407, Test accuracy: 66.80 

Round   2, Train loss: 0.057, Test loss: 1.609, Test accuracy: 59.70 

        train local model (freeze embeding):client   0,  Train loss: 0.089, Train accuracy: 97.400, Test loss: 1.786, Test accuracy: 60.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.764, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.128, Train accuracy: 96.200, Test loss: 1.362, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.071, Train accuracy: 97.400, Test loss: 1.622, Test accuracy: 66.60 

Round   3, Train loss: 0.037, Test loss: 1.677, Test accuracy: 63.10 

        train local model (freeze embeding):client   0,  Train loss: 0.104, Train accuracy: 96.200, Test loss: 1.854, Test accuracy: 60.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.980, Test accuracy: 61.40 

        train local model (freeze embeding):client   1,  Train loss: 0.084, Train accuracy: 97.600, Test loss: 1.429, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.074, Train accuracy: 98.200, Test loss: 1.570, Test accuracy: 67.60 

Round   4, Train loss: 0.047, Test loss: 1.663, Test accuracy: 62.70 

        train local model (freeze embeding):client   0,  Train loss: 0.049, Train accuracy: 98.600, Test loss: 1.723, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.759, Test accuracy: 62.60 

        train local model (freeze embeding):client   1,  Train loss: 0.075, Train accuracy: 98.000, Test loss: 1.381, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.144, Train accuracy: 95.200, Test loss: 1.818, Test accuracy: 65.80 

Round   5, Train loss: 0.073, Test loss: 1.654, Test accuracy: 61.90 

        train local model (freeze embeding):client   0,  Train loss: 0.053, Train accuracy: 98.400, Test loss: 1.767, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.110, Train accuracy: 96.200, Test loss: 2.281, Test accuracy: 57.80 

        train local model (freeze embeding):client   1,  Train loss: 0.039, Train accuracy: 99.200, Test loss: 1.408, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 98.600, Test loss: 1.478, Test accuracy: 70.80 

Round   6, Train loss: 0.076, Test loss: 1.721, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.600, Test loss: 1.834, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.680, Test accuracy: 62.80 

        train local model (freeze embeding):client   1,  Train loss: 0.076, Train accuracy: 97.600, Test loss: 1.359, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.049, Train accuracy: 98.600, Test loss: 1.658, Test accuracy: 69.20 

Round   7, Train loss: 0.032, Test loss: 1.573, Test accuracy: 64.50 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.600, Test loss: 1.612, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.400, Test loss: 1.699, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.059, Train accuracy: 97.800, Test loss: 1.411, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.051, Train accuracy: 97.800, Test loss: 1.684, Test accuracy: 68.60 

Round   8, Train loss: 0.039, Test loss: 1.589, Test accuracy: 62.60 

        train local model (freeze embeding):client   0,  Train loss: 0.046, Train accuracy: 98.000, Test loss: 1.636, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.832, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 1.359, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.050, Train accuracy: 98.400, Test loss: 1.444, Test accuracy: 70.80 

Round   9, Train loss: 0.029, Test loss: 1.570, Test accuracy: 64.00 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.747, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.782, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.045, Train accuracy: 99.000, Test loss: 1.370, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 98.200, Test loss: 1.747, Test accuracy: 67.80 

Round  10, Train loss: 0.023, Test loss: 1.660, Test accuracy: 63.90 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 1.670, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.200, Test loss: 1.894, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.460, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.033, Train accuracy: 98.800, Test loss: 1.887, Test accuracy: 67.60 

Round  11, Train loss: 0.025, Test loss: 1.702, Test accuracy: 63.80 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 1.745, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.798, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.600, Test loss: 1.516, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 1.728, Test accuracy: 66.80 

Round  12, Train loss: 0.020, Test loss: 1.618, Test accuracy: 65.30 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.661, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 2.418, Test accuracy: 61.20 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.490, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.520, Test accuracy: 70.00 

Round  13, Train loss: 0.020, Test loss: 1.700, Test accuracy: 65.20 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.742, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 2.316, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.480, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.444, Test accuracy: 72.40 

Round  14, Train loss: 0.010, Test loss: 1.668, Test accuracy: 66.20 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.888, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.943, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.483, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 1.817, Test accuracy: 69.00 

Round  15, Train loss: 0.017, Test loss: 1.651, Test accuracy: 67.10 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 1.801, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.881, Test accuracy: 66.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.486, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.086, Train accuracy: 97.200, Test loss: 1.921, Test accuracy: 66.00 

Round  16, Train loss: 0.043, Test loss: 1.683, Test accuracy: 67.10 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.684, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.834, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.505, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.615, Test accuracy: 73.20 

Round  17, Train loss: 0.001, Test loss: 1.597, Test accuracy: 66.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.716, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.909, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.433, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.674, Test accuracy: 72.00 

Round  18, Train loss: 0.002, Test loss: 1.632, Test accuracy: 67.90 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.890, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.132, Test accuracy: 63.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.490, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.545, Test accuracy: 74.00 

Round  19, Train loss: 0.003, Test loss: 1.734, Test accuracy: 67.90 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.865, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.847, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.515, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.482, Test accuracy: 70.80 

Final Round, Train loss: 0.005, Test loss: 1.683, Test accuracy: 67.30 

Average accuracy final 10 rounds: 128.78999999999996 

696.501677274704
[9.5702223777771, 19.129466772079468, 28.508621215820312, 37.93321895599365, 48.02765130996704, 57.93926739692688, 67.8863275051117, 77.65695834159851, 87.54065012931824, 97.47989773750305, 107.18356680870056, 116.54676103591919, 125.49339079856873, 134.66210007667542, 144.33356165885925, 154.0223948955536, 163.692720413208, 173.26029920578003, 183.24498295783997, 192.7862274646759, 198.42685675621033, 208.18043994903564, 217.89482355117798, 227.51686215400696, 237.29929995536804, 246.90101099014282, 256.88057351112366, 266.8536629676819, 277.0227105617523, 286.86547327041626, 296.91152715682983, 306.65408849716187, 316.16195702552795, 326.35814094543457, 336.434935092926, 346.72528052330017, 356.32996678352356, 366.41659331321716, 376.1322181224823, 386.3189899921417, 396.199640750885, 402.3196470737457]
[56.6, 57.4, 58.2, 62.0, 53.0, 55.8, 61.4, 57.6, 58.2, 60.2, 58.6, 63.2, 61.6, 65.6, 60.0, 63.4, 61.8, 64.8, 63.6, 64.6, 63.4, 57.1, 61.1, 59.7, 63.1, 62.7, 61.9, 62.8, 64.5, 62.6, 64.0, 63.9, 63.8, 65.3, 65.2, 66.2, 67.1, 67.1, 66.3, 67.9, 67.9, 67.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.690, Test loss: 0.750, Test accuracy: 71.30 

Round   0, Global train loss: 0.690, Global test loss: 0.762, Global test accuracy: 50.00 

Round   1, Train loss: 0.486, Test loss: 0.724, Test accuracy: 73.60 

Round   1, Global train loss: 0.486, Global test loss: 0.682, Global test accuracy: 52.00 

Round   2, Train loss: 0.427, Test loss: 0.762, Test accuracy: 73.00 

Round   2, Global train loss: 0.427, Global test loss: 0.677, Global test accuracy: 55.20 

Round   3, Train loss: 0.350, Test loss: 0.743, Test accuracy: 75.70 

Round   3, Global train loss: 0.350, Global test loss: 0.701, Global test accuracy: 50.00 

Round   4, Train loss: 0.325, Test loss: 0.653, Test accuracy: 78.00 

Round   4, Global train loss: 0.325, Global test loss: 0.674, Global test accuracy: 60.40 

Round   5, Train loss: 0.268, Test loss: 0.835, Test accuracy: 78.20 

Round   5, Global train loss: 0.268, Global test loss: 0.696, Global test accuracy: 50.60 

Round   6, Train loss: 0.264, Test loss: 0.560, Test accuracy: 80.40 

Round   6, Global train loss: 0.264, Global test loss: 0.694, Global test accuracy: 50.50 

Round   7, Train loss: 0.224, Test loss: 0.581, Test accuracy: 80.40 

Round   7, Global train loss: 0.224, Global test loss: 0.709, Global test accuracy: 50.00 

Round   8, Train loss: 0.177, Test loss: 0.566, Test accuracy: 83.40 

Round   8, Global train loss: 0.177, Global test loss: 0.699, Global test accuracy: 50.00 

Round   9, Train loss: 0.171, Test loss: 0.569, Test accuracy: 82.60 

Round   9, Global train loss: 0.171, Global test loss: 0.696, Global test accuracy: 50.00 

Round  10, Train loss: 0.131, Test loss: 0.590, Test accuracy: 82.10 

Round  10, Global train loss: 0.131, Global test loss: 0.724, Global test accuracy: 50.00 

Round  11, Train loss: 0.120, Test loss: 0.576, Test accuracy: 83.40 

Round  11, Global train loss: 0.120, Global test loss: 0.706, Global test accuracy: 50.00 

Round  12, Train loss: 0.103, Test loss: 0.636, Test accuracy: 82.80 

Round  12, Global train loss: 0.103, Global test loss: 0.708, Global test accuracy: 50.00 

Round  13, Train loss: 0.096, Test loss: 0.660, Test accuracy: 83.30 

Round  13, Global train loss: 0.096, Global test loss: 0.744, Global test accuracy: 50.00 

Round  14, Train loss: 0.097, Test loss: 0.776, Test accuracy: 81.60 

Round  14, Global train loss: 0.097, Global test loss: 0.717, Global test accuracy: 50.00 

Round  15, Train loss: 0.085, Test loss: 0.794, Test accuracy: 80.20 

Round  15, Global train loss: 0.085, Global test loss: 0.728, Global test accuracy: 50.00 

Round  16, Train loss: 0.062, Test loss: 0.623, Test accuracy: 83.30 

Round  16, Global train loss: 0.062, Global test loss: 0.765, Global test accuracy: 50.00 

Round  17, Train loss: 0.079, Test loss: 0.822, Test accuracy: 81.20 

Round  17, Global train loss: 0.079, Global test loss: 0.763, Global test accuracy: 50.00 

Round  18, Train loss: 0.051, Test loss: 0.720, Test accuracy: 81.80 

Round  18, Global train loss: 0.051, Global test loss: 0.742, Global test accuracy: 50.00 

Round  19, Train loss: 0.052, Test loss: 0.651, Test accuracy: 83.40 

Round  19, Global train loss: 0.052, Global test loss: 0.748, Global test accuracy: 50.00 

Round  20, Train loss: 0.057, Test loss: 0.767, Test accuracy: 81.40 

Round  20, Global train loss: 0.057, Global test loss: 0.766, Global test accuracy: 50.00 

Round  21, Train loss: 0.054, Test loss: 0.729, Test accuracy: 81.40 

Round  21, Global train loss: 0.054, Global test loss: 0.789, Global test accuracy: 50.00 

Round  22, Train loss: 0.045, Test loss: 0.692, Test accuracy: 84.40 

Round  22, Global train loss: 0.045, Global test loss: 0.746, Global test accuracy: 50.00 

Round  23, Train loss: 0.039, Test loss: 0.655, Test accuracy: 86.80 

Round  23, Global train loss: 0.039, Global test loss: 0.771, Global test accuracy: 50.00 

Round  24, Train loss: 0.033, Test loss: 0.854, Test accuracy: 82.90 

Round  24, Global train loss: 0.033, Global test loss: 0.737, Global test accuracy: 50.00 

Round  25, Train loss: 0.018, Test loss: 0.678, Test accuracy: 85.10 

Round  25, Global train loss: 0.018, Global test loss: 0.763, Global test accuracy: 50.00 

Round  26, Train loss: 0.027, Test loss: 0.727, Test accuracy: 83.80 

Round  26, Global train loss: 0.027, Global test loss: 0.786, Global test accuracy: 50.00 

Round  27, Train loss: 0.048, Test loss: 0.691, Test accuracy: 84.30 

Round  27, Global train loss: 0.048, Global test loss: 0.735, Global test accuracy: 50.00 

Round  28, Train loss: 0.026, Test loss: 0.718, Test accuracy: 84.50 

Round  28, Global train loss: 0.026, Global test loss: 0.748, Global test accuracy: 50.00 

Round  29, Train loss: 0.015, Test loss: 0.635, Test accuracy: 85.10 

Round  29, Global train loss: 0.015, Global test loss: 0.725, Global test accuracy: 50.00 

Round  30, Train loss: 0.026, Test loss: 0.672, Test accuracy: 83.90 

Round  30, Global train loss: 0.026, Global test loss: 0.739, Global test accuracy: 50.00 

Round  31, Train loss: 0.013, Test loss: 0.685, Test accuracy: 84.70 

Round  31, Global train loss: 0.013, Global test loss: 0.754, Global test accuracy: 50.00 

Round  32, Train loss: 0.011, Test loss: 0.774, Test accuracy: 84.30 

Round  32, Global train loss: 0.011, Global test loss: 0.753, Global test accuracy: 50.00 

Round  33, Train loss: 0.022, Test loss: 0.717, Test accuracy: 83.50 

Round  33, Global train loss: 0.022, Global test loss: 0.745, Global test accuracy: 50.00 

Round  34, Train loss: 0.035, Test loss: 0.568, Test accuracy: 85.90 

Round  34, Global train loss: 0.035, Global test loss: 0.785, Global test accuracy: 50.00 

Final Round, Train loss: 0.018, Test loss: 0.606, Test accuracy: 85.70 

Final Round, Global train loss: 0.018, Global test loss: 0.785, Global test accuracy: 50.00 

Average accuracy final 10 rounds: 84.50999999999999 

Average global accuracy final 10 rounds: 50.0 

500.7682740688324
[4.364601373672485, 6.687970161437988, 9.295850276947021, 11.755524396896362, 14.237462759017944, 16.818503856658936, 19.312663078308105, 21.873667240142822, 24.355794191360474, 26.748104333877563, 29.25372886657715, 31.62208843231201, 34.20647573471069, 36.70007824897766, 39.344313859939575, 41.76197052001953, 44.1320686340332, 46.63930416107178, 49.17956876754761, 51.66056036949158, 54.302196741104126, 56.81435537338257, 59.24102592468262, 61.73602533340454, 64.18389248847961, 66.66973853111267, 69.21721625328064, 71.79696941375732, 74.28129458427429, 76.67551159858704, 79.34157824516296, 81.94462180137634, 84.44455814361572, 86.9943335056305, 89.52746057510376, 94.67576885223389]
[71.3, 73.6, 73.0, 75.7, 78.0, 78.2, 80.4, 80.4, 83.4, 82.6, 82.1, 83.4, 82.8, 83.3, 81.6, 80.2, 83.3, 81.2, 81.8, 83.4, 81.4, 81.4, 84.4, 86.8, 82.9, 85.1, 83.8, 84.3, 84.5, 85.1, 83.9, 84.7, 84.3, 83.5, 85.9, 85.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.668, Test loss: 0.717, Test accuracy: 73.10 

Round   0, Global train loss: 0.668, Global test loss: 0.659, Global test accuracy: 60.80 

Round   1, Train loss: 0.630, Test loss: 0.620, Test accuracy: 74.70 

Round   1, Global train loss: 0.630, Global test loss: 0.669, Global test accuracy: 62.40 

Round   2, Train loss: 0.563, Test loss: 0.463, Test accuracy: 77.70 

Round   2, Global train loss: 0.563, Global test loss: 0.665, Global test accuracy: 61.00 

Round   3, Train loss: 0.544, Test loss: 0.527, Test accuracy: 78.60 

Round   3, Global train loss: 0.544, Global test loss: 0.669, Global test accuracy: 61.70 

Round   4, Train loss: 0.489, Test loss: 1.239, Test accuracy: 72.30 

Round   4, Global train loss: 0.489, Global test loss: 0.799, Global test accuracy: 61.10 

Round   5, Train loss: 0.441, Test loss: 0.623, Test accuracy: 77.30 

Round   5, Global train loss: 0.441, Global test loss: 0.744, Global test accuracy: 61.50 

Round   6, Train loss: 0.424, Test loss: 0.819, Test accuracy: 77.90 

Round   6, Global train loss: 0.424, Global test loss: 0.756, Global test accuracy: 62.50 

Round   7, Train loss: 0.405, Test loss: 0.662, Test accuracy: 80.40 

Round   7, Global train loss: 0.405, Global test loss: 0.712, Global test accuracy: 64.40 

Round   8, Train loss: 0.395, Test loss: 0.686, Test accuracy: 79.30 

Round   8, Global train loss: 0.395, Global test loss: 0.718, Global test accuracy: 64.20 

Round   9, Train loss: 0.351, Test loss: 0.757, Test accuracy: 76.80 

Round   9, Global train loss: 0.351, Global test loss: 0.746, Global test accuracy: 62.00 

Round  10, Train loss: 0.346, Test loss: 0.570, Test accuracy: 80.20 

Round  10, Global train loss: 0.346, Global test loss: 0.732, Global test accuracy: 65.70 

Round  11, Train loss: 0.334, Test loss: 0.499, Test accuracy: 80.40 

Round  11, Global train loss: 0.334, Global test loss: 0.717, Global test accuracy: 66.10 

Round  12, Train loss: 0.294, Test loss: 0.744, Test accuracy: 76.10 

Round  12, Global train loss: 0.294, Global test loss: 0.815, Global test accuracy: 64.00 

Round  13, Train loss: 0.282, Test loss: 0.609, Test accuracy: 82.10 

Round  13, Global train loss: 0.282, Global test loss: 0.766, Global test accuracy: 65.90 

Round  14, Train loss: 0.296, Test loss: 0.532, Test accuracy: 82.70 

Round  14, Global train loss: 0.296, Global test loss: 0.789, Global test accuracy: 66.40 

Round  15, Train loss: 0.286, Test loss: 0.501, Test accuracy: 82.90 

Round  15, Global train loss: 0.286, Global test loss: 0.775, Global test accuracy: 66.30 

Round  16, Train loss: 0.272, Test loss: 0.619, Test accuracy: 81.20 

Round  16, Global train loss: 0.272, Global test loss: 0.842, Global test accuracy: 66.60 

Round  17, Train loss: 0.240, Test loss: 0.580, Test accuracy: 81.40 

Round  17, Global train loss: 0.240, Global test loss: 0.796, Global test accuracy: 66.70 

Round  18, Train loss: 0.223, Test loss: 0.497, Test accuracy: 83.50 

Round  18, Global train loss: 0.223, Global test loss: 0.802, Global test accuracy: 66.50 

Round  19, Train loss: 0.215, Test loss: 0.565, Test accuracy: 82.60 

Round  19, Global train loss: 0.215, Global test loss: 0.827, Global test accuracy: 67.80 

Round  20, Train loss: 0.216, Test loss: 0.482, Test accuracy: 83.30 

Round  20, Global train loss: 0.216, Global test loss: 0.823, Global test accuracy: 68.50 

Round  21, Train loss: 0.190, Test loss: 0.500, Test accuracy: 84.00 

Round  21, Global train loss: 0.190, Global test loss: 0.893, Global test accuracy: 67.20 

Round  22, Train loss: 0.210, Test loss: 0.523, Test accuracy: 83.20 

Round  22, Global train loss: 0.210, Global test loss: 0.821, Global test accuracy: 68.00 

Round  23, Train loss: 0.152, Test loss: 0.680, Test accuracy: 82.30 

Round  23, Global train loss: 0.152, Global test loss: 0.932, Global test accuracy: 66.40 

Round  24, Train loss: 0.179, Test loss: 0.680, Test accuracy: 81.20 

Round  24, Global train loss: 0.179, Global test loss: 0.857, Global test accuracy: 67.70 

Round  25, Train loss: 0.160, Test loss: 0.624, Test accuracy: 81.20 

Round  25, Global train loss: 0.160, Global test loss: 0.977, Global test accuracy: 66.40 

Round  26, Train loss: 0.160, Test loss: 0.714, Test accuracy: 82.40 

Round  26, Global train loss: 0.160, Global test loss: 0.867, Global test accuracy: 67.60 

Round  27, Train loss: 0.165, Test loss: 0.853, Test accuracy: 81.10 

Round  27, Global train loss: 0.165, Global test loss: 0.875, Global test accuracy: 67.70 

Round  28, Train loss: 0.127, Test loss: 0.777, Test accuracy: 79.60 

Round  28, Global train loss: 0.127, Global test loss: 0.884, Global test accuracy: 67.20 

Round  29, Train loss: 0.122, Test loss: 0.911, Test accuracy: 81.10 

Round  29, Global train loss: 0.122, Global test loss: 0.922, Global test accuracy: 67.20 

Round  30, Train loss: 0.128, Test loss: 0.623, Test accuracy: 83.20 

Round  30, Global train loss: 0.128, Global test loss: 0.955, Global test accuracy: 67.10 

Round  31, Train loss: 0.142, Test loss: 0.519, Test accuracy: 82.30 

Round  31, Global train loss: 0.142, Global test loss: 0.963, Global test accuracy: 66.20 

Round  32, Train loss: 0.124, Test loss: 0.657, Test accuracy: 81.10 

Round  32, Global train loss: 0.124, Global test loss: 0.985, Global test accuracy: 68.20 

Round  33, Train loss: 0.119, Test loss: 0.554, Test accuracy: 82.70 

Round  33, Global train loss: 0.119, Global test loss: 0.858, Global test accuracy: 68.90 

Round  34, Train loss: 0.127, Test loss: 0.525, Test accuracy: 83.80 

Round  34, Global train loss: 0.127, Global test loss: 0.899, Global test accuracy: 68.50 

Final Round, Train loss: 0.074, Test loss: 0.562, Test accuracy: 84.80 

Final Round, Global train loss: 0.074, Global test loss: 0.899, Global test accuracy: 68.50 

Average accuracy final 10 rounds: 81.85 

Average global accuracy final 10 rounds: 67.5 

496.6993074417114
[4.448045492172241, 7.111663341522217, 9.563531160354614, 11.98905324935913, 14.592053174972534, 17.11764883995056, 19.632771015167236, 22.235774278640747, 24.696680307388306, 27.178949117660522, 29.79980492591858, 32.27064037322998, 34.86143946647644, 37.33474636077881, 39.874269008636475, 42.56309461593628, 45.346765995025635, 47.91730570793152, 50.5738205909729, 52.997671127319336, 55.61498403549194, 58.10999608039856, 60.64895987510681, 63.13688325881958, 65.53531527519226, 68.26479959487915, 70.70706820487976, 73.21619749069214, 75.74437975883484, 78.29353761672974, 80.71061658859253, 83.04310989379883, 85.59086608886719, 88.2471833229065, 90.75210547447205, 95.54321765899658]
[73.1, 74.7, 77.7, 78.6, 72.3, 77.3, 77.9, 80.4, 79.3, 76.8, 80.2, 80.4, 76.1, 82.1, 82.7, 82.9, 81.2, 81.4, 83.5, 82.6, 83.3, 84.0, 83.2, 82.3, 81.2, 81.2, 82.4, 81.1, 79.6, 81.1, 83.2, 82.3, 81.1, 82.7, 83.8, 84.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.688, Test loss: 0.915, Test accuracy: 52.40 

Round   1, Train loss: 0.647, Test loss: 0.783, Test accuracy: 62.30 

Round   2, Train loss: 0.601, Test loss: 0.880, Test accuracy: 58.20 

Round   3, Train loss: 0.576, Test loss: 0.909, Test accuracy: 66.10 

Round   4, Train loss: 0.560, Test loss: 0.635, Test accuracy: 68.00 

Round   5, Train loss: 0.547, Test loss: 0.798, Test accuracy: 69.10 

Round   6, Train loss: 0.510, Test loss: 0.683, Test accuracy: 69.00 

Round   7, Train loss: 0.464, Test loss: 0.902, Test accuracy: 67.70 

Round   8, Train loss: 0.434, Test loss: 0.737, Test accuracy: 68.40 

Round   9, Train loss: 0.411, Test loss: 0.576, Test accuracy: 76.00 

Round  10, Train loss: 0.397, Test loss: 0.504, Test accuracy: 78.60 

Round  11, Train loss: 0.366, Test loss: 0.591, Test accuracy: 76.70 

Round  12, Train loss: 0.375, Test loss: 0.639, Test accuracy: 75.50 

Round  13, Train loss: 0.355, Test loss: 0.582, Test accuracy: 76.20 

Round  14, Train loss: 0.339, Test loss: 0.476, Test accuracy: 79.50 

Round  15, Train loss: 0.315, Test loss: 0.496, Test accuracy: 79.50 

Round  16, Train loss: 0.295, Test loss: 0.613, Test accuracy: 77.10 

Round  17, Train loss: 0.271, Test loss: 0.491, Test accuracy: 79.70 

Round  18, Train loss: 0.277, Test loss: 0.585, Test accuracy: 76.70 

Round  19, Train loss: 0.259, Test loss: 0.411, Test accuracy: 81.20 

Round  20, Train loss: 0.251, Test loss: 0.482, Test accuracy: 78.90 

Round  21, Train loss: 0.226, Test loss: 0.524, Test accuracy: 80.70 

Round  22, Train loss: 0.222, Test loss: 0.579, Test accuracy: 78.70 

Round  23, Train loss: 0.211, Test loss: 0.594, Test accuracy: 78.70 

Round  24, Train loss: 0.191, Test loss: 0.504, Test accuracy: 79.80 

Round  25, Train loss: 0.184, Test loss: 0.469, Test accuracy: 80.80 

Round  26, Train loss: 0.175, Test loss: 0.504, Test accuracy: 80.00 

Round  27, Train loss: 0.178, Test loss: 0.544, Test accuracy: 79.40 

Round  28, Train loss: 0.155, Test loss: 0.584, Test accuracy: 78.00 

Round  29, Train loss: 0.150, Test loss: 0.495, Test accuracy: 80.60 

Round  30, Train loss: 0.140, Test loss: 0.590, Test accuracy: 79.00 

Round  31, Train loss: 0.128, Test loss: 0.538, Test accuracy: 80.30 

Round  32, Train loss: 0.129, Test loss: 0.449, Test accuracy: 83.10 

Round  33, Train loss: 0.119, Test loss: 0.505, Test accuracy: 82.10 

Round  34, Train loss: 0.102, Test loss: 0.465, Test accuracy: 82.70 

Round  35, Train loss: 0.110, Test loss: 0.476, Test accuracy: 82.30 

Round  36, Train loss: 0.122, Test loss: 0.495, Test accuracy: 82.10 

Round  37, Train loss: 0.089, Test loss: 0.461, Test accuracy: 82.40 

Round  38, Train loss: 0.095, Test loss: 0.491, Test accuracy: 81.90 

Round  39, Train loss: 0.081, Test loss: 0.442, Test accuracy: 82.90 

Round  40, Train loss: 0.088, Test loss: 0.478, Test accuracy: 82.70 

Round  41, Train loss: 0.091, Test loss: 0.487, Test accuracy: 83.30 

Round  42, Train loss: 0.065, Test loss: 0.492, Test accuracy: 83.40 

Round  43, Train loss: 0.067, Test loss: 0.505, Test accuracy: 84.00 

Round  44, Train loss: 0.060, Test loss: 0.491, Test accuracy: 83.30 

Round  45, Train loss: 0.046, Test loss: 0.487, Test accuracy: 83.90 

Round  46, Train loss: 0.051, Test loss: 0.511, Test accuracy: 82.60 

Round  47, Train loss: 0.035, Test loss: 0.530, Test accuracy: 82.60 

Round  48, Train loss: 0.054, Test loss: 0.568, Test accuracy: 82.20 

Round  49, Train loss: 0.059, Test loss: 0.585, Test accuracy: 82.20 

Final Round, Train loss: 0.033, Test loss: 0.582, Test accuracy: 82.40 

Average accuracy final 10 rounds: 83.02 

495.17110896110535
[3.93412446975708, 5.648956298828125, 7.505898952484131, 9.339911937713623, 11.270568370819092, 13.117424726486206, 15.021596193313599, 16.81978487968445, 18.99618697166443, 20.897385835647583, 22.81246519088745, 24.827880859375, 26.72283935546875, 28.574848175048828, 30.402207851409912, 32.1777708530426, 34.09026074409485, 35.99796223640442, 37.928866147994995, 39.83032298088074, 41.660146713256836, 43.472909450531006, 45.16356587409973, 47.02137541770935, 48.977988719940186, 50.95202112197876, 52.897393465042114, 54.82288432121277, 56.65249848365784, 58.474199533462524, 60.29489469528198, 62.109867811203, 64.09485697746277, 66.0310800075531, 67.86482906341553, 69.76579427719116, 71.54585146903992, 73.4151451587677, 75.21791338920593, 77.14497518539429, 79.06184124946594, 80.97257804870605, 82.87215256690979, 84.6706075668335, 86.52564477920532, 88.46380805969238, 90.2528567314148, 92.09164500236511, 93.93333721160889, 95.92311954498291, 97.65011954307556]
[52.4, 62.3, 58.2, 66.1, 68.0, 69.1, 69.0, 67.7, 68.4, 76.0, 78.6, 76.7, 75.5, 76.2, 79.5, 79.5, 77.1, 79.7, 76.7, 81.2, 78.9, 80.7, 78.7, 78.7, 79.8, 80.8, 80.0, 79.4, 78.0, 80.6, 79.0, 80.3, 83.1, 82.1, 82.7, 82.3, 82.1, 82.4, 81.9, 82.9, 82.7, 83.3, 83.4, 84.0, 83.3, 83.9, 82.6, 82.6, 82.2, 82.2, 82.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.815, Test loss: 1.182, Test accuracy: 50.40
Round   1, Train loss: 0.656, Test loss: 0.881, Test accuracy: 57.10
Round   2, Train loss: 0.621, Test loss: 1.097, Test accuracy: 60.20
Round   3, Train loss: 0.590, Test loss: 0.747, Test accuracy: 64.20
Round   4, Train loss: 0.554, Test loss: 0.877, Test accuracy: 64.30
Round   5, Train loss: 0.523, Test loss: 0.754, Test accuracy: 66.00
Round   6, Train loss: 0.478, Test loss: 0.605, Test accuracy: 71.20
Round   7, Train loss: 0.460, Test loss: 0.671, Test accuracy: 70.90
Round   8, Train loss: 0.439, Test loss: 0.762, Test accuracy: 73.00
Round   9, Train loss: 0.429, Test loss: 0.669, Test accuracy: 73.50
Round  10, Train loss: 0.412, Test loss: 0.491, Test accuracy: 77.10
Round  11, Train loss: 0.390, Test loss: 0.799, Test accuracy: 67.20
Round  12, Train loss: 0.383, Test loss: 0.475, Test accuracy: 77.80
Round  13, Train loss: 0.361, Test loss: 0.636, Test accuracy: 72.80
Round  14, Train loss: 0.328, Test loss: 0.572, Test accuracy: 75.10
Round  15, Train loss: 0.318, Test loss: 0.550, Test accuracy: 76.60
Round  16, Train loss: 0.301, Test loss: 0.577, Test accuracy: 77.30
Round  17, Train loss: 0.297, Test loss: 0.459, Test accuracy: 80.10
Round  18, Train loss: 0.264, Test loss: 0.524, Test accuracy: 78.20
Round  19, Train loss: 0.268, Test loss: 0.490, Test accuracy: 80.70
Round  20, Train loss: 0.248, Test loss: 0.513, Test accuracy: 78.40
Round  21, Train loss: 0.226, Test loss: 0.489, Test accuracy: 79.20
Round  22, Train loss: 0.205, Test loss: 0.514, Test accuracy: 80.60
Round  23, Train loss: 0.227, Test loss: 0.473, Test accuracy: 80.50
Round  24, Train loss: 0.201, Test loss: 0.426, Test accuracy: 81.90
Round  25, Train loss: 0.203, Test loss: 0.484, Test accuracy: 80.90
Round  26, Train loss: 0.185, Test loss: 0.502, Test accuracy: 80.00
Round  27, Train loss: 0.163, Test loss: 0.521, Test accuracy: 81.20
Round  28, Train loss: 0.179, Test loss: 0.491, Test accuracy: 81.40
Round  29, Train loss: 0.181, Test loss: 0.441, Test accuracy: 83.30
Round  30, Train loss: 0.141, Test loss: 0.444, Test accuracy: 83.70
Round  31, Train loss: 0.140, Test loss: 0.475, Test accuracy: 82.30
Round  32, Train loss: 0.146, Test loss: 0.485, Test accuracy: 82.10
Round  33, Train loss: 0.121, Test loss: 0.454, Test accuracy: 82.80
Round  34, Train loss: 0.125, Test loss: 0.444, Test accuracy: 83.30
Round  35, Train loss: 0.109, Test loss: 0.515, Test accuracy: 81.50
Round  36, Train loss: 0.111, Test loss: 0.458, Test accuracy: 83.30
Round  37, Train loss: 0.103, Test loss: 0.462, Test accuracy: 83.40
Round  38, Train loss: 0.100, Test loss: 0.498, Test accuracy: 82.10
Round  39, Train loss: 0.077, Test loss: 0.507, Test accuracy: 83.00
Round  40, Train loss: 0.097, Test loss: 0.454, Test accuracy: 82.90
Round  41, Train loss: 0.078, Test loss: 0.460, Test accuracy: 83.80
Round  42, Train loss: 0.076, Test loss: 0.465, Test accuracy: 84.00
Round  43, Train loss: 0.072, Test loss: 0.492, Test accuracy: 83.60
Round  44, Train loss: 0.062, Test loss: 0.481, Test accuracy: 84.30
Round  45, Train loss: 0.064, Test loss: 0.504, Test accuracy: 83.00
Round  46, Train loss: 0.075, Test loss: 0.482, Test accuracy: 84.40
Round  47, Train loss: 0.076, Test loss: 0.493, Test accuracy: 83.50
Round  48, Train loss: 0.058, Test loss: 0.497, Test accuracy: 84.30
Round  49, Train loss: 0.069, Test loss: 0.483, Test accuracy: 83.80
Final Round, Train loss: 0.035, Test loss: 0.466, Test accuracy: 84.50
Average accuracy final 10 rounds: 83.75999999999999
554.3834459781647
[4.153758525848389, 6.169842958450317, 8.152865886688232, 10.217411041259766, 12.366650819778442, 14.399219751358032, 16.439114809036255, 18.646199941635132, 20.77350950241089, 22.880409240722656, 24.948610067367554, 27.1167893409729, 29.292465448379517, 31.54350185394287, 33.76729106903076, 35.81142854690552, 37.82176232337952, 39.857558488845825, 41.93574380874634, 44.05986785888672, 46.139941453933716, 48.378029346466064, 50.494436502456665, 52.526479721069336, 54.66927623748779, 56.83734965324402, 58.94094920158386, 60.97604966163635, 63.20836687088013, 65.35755801200867, 67.553227186203, 69.63701391220093, 71.76095294952393, 73.91952514648438, 76.00674772262573, 78.13905262947083, 80.2341513633728, 82.35471296310425, 84.43399381637573, 86.48778581619263, 88.63202357292175, 90.84356212615967, 92.90987539291382, 94.99135899543762, 97.15530180931091, 99.29748463630676, 101.36884903907776, 103.37682390213013, 105.41804146766663, 107.60629057884216, 109.52165651321411]
[50.4, 57.1, 60.2, 64.2, 64.3, 66.0, 71.2, 70.9, 73.0, 73.5, 77.1, 67.2, 77.8, 72.8, 75.1, 76.6, 77.3, 80.1, 78.2, 80.7, 78.4, 79.2, 80.6, 80.5, 81.9, 80.9, 80.0, 81.2, 81.4, 83.3, 83.7, 82.3, 82.1, 82.8, 83.3, 81.5, 83.3, 83.4, 82.1, 83.0, 82.9, 83.8, 84.0, 83.6, 84.3, 83.0, 84.4, 83.5, 84.3, 83.8, 84.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.137, Train accuracy: 94.000, Test loss: 0.597, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.169, Train accuracy: 95.000, Test loss: 0.534, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.046, Train accuracy: 98.500, Test loss: 0.478, Test accuracy: 83.00 

Round   0, Train loss: 0.046, Test loss: 0.478, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.525, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.058, Train accuracy: 98.000, Test loss: 0.659, Test accuracy: 81.50 

Round   1, Train loss: 0.058, Test loss: 0.659, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 0.659, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.544, Test accuracy: 84.00 

Round   2, Train loss: 0.022, Test loss: 0.544, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.624, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.044, Train accuracy: 98.500, Test loss: 0.680, Test accuracy: 85.50 

Round   3, Train loss: 0.044, Test loss: 0.680, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.567, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.459, Test accuracy: 84.00 

Round   4, Train loss: 0.014, Test loss: 0.459, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.539, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 0.902, Test accuracy: 81.50 

Round   5, Train loss: 0.025, Test loss: 0.902, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.758, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.728, Test accuracy: 84.50 

Round   6, Train loss: 0.006, Test loss: 0.728, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.697, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.628, Test accuracy: 82.50 

Round   7, Train loss: 0.022, Test loss: 0.628, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 0.629, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.608, Test accuracy: 84.00 

Round   8, Train loss: 0.004, Test loss: 0.608, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.648, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.746, Test accuracy: 85.00 

Round   9, Train loss: 0.006, Test loss: 0.746, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.711, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.630, Test accuracy: 85.00 

Round  10, Train loss: 0.003, Test loss: 0.630, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.673, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.607, Test accuracy: 87.00 

Round  11, Train loss: 0.001, Test loss: 0.607, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.578, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.635, Test accuracy: 87.00 

Round  12, Train loss: 0.001, Test loss: 0.635, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.627, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.804, Test accuracy: 82.50 

Round  13, Train loss: 0.002, Test loss: 0.804, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.775, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.682, Test accuracy: 83.00 

Round  14, Train loss: 0.001, Test loss: 0.682, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.678, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 85.50 

Round  15, Train loss: 0.007, Test loss: 0.536, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.527, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.096, Train accuracy: 96.500, Test loss: 1.014, Test accuracy: 79.00 

Round  16, Train loss: 0.096, Test loss: 1.014, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 0.631, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.435, Test accuracy: 87.50 

Round  17, Train loss: 0.008, Test loss: 0.435, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.804, Test accuracy: 84.00 

Round  18, Train loss: 0.001, Test loss: 0.804, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.757, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.662, Test accuracy: 86.50 

Round  19, Train loss: 0.000, Test loss: 0.662, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.678, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.651, Test accuracy: 87.00 

Final Round, Train loss: 0.000, Test loss: 0.668, Test accuracy: 87.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.169, Test accuracy: 95.00 

        train local model (freeze embeding):client   0,  Train loss: 0.056, Train accuracy: 97.500, Test loss: 0.812, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.654, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.132, Train accuracy: 93.000, Test loss: 0.283, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 0.198, Test accuracy: 94.50 

Round   0, Train loss: 0.013, Test loss: 0.670, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 0.855, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.730, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.118, Train accuracy: 95.500, Test loss: 0.215, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.132, Test accuracy: 95.00 

Round   1, Train loss: 0.009, Test loss: 0.742, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.995, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.636, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.062, Train accuracy: 97.000, Test loss: 0.200, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.060, Train accuracy: 97.000, Test loss: 0.217, Test accuracy: 92.00 

Round   2, Train loss: 0.034, Test loss: 0.668, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 0.989, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.858, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.047, Train accuracy: 98.500, Test loss: 0.210, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.039, Train accuracy: 99.000, Test loss: 0.155, Test accuracy: 94.50 

Round   3, Train loss: 0.023, Test loss: 0.571, Test accuracy: 85.75 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.828, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.583, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.076, Train accuracy: 97.500, Test loss: 0.204, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.114, Train accuracy: 96.000, Test loss: 0.338, Test accuracy: 91.00 

Round   4, Train loss: 0.058, Test loss: 0.551, Test accuracy: 85.25 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.825, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.566, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.055, Train accuracy: 99.000, Test loss: 0.175, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.206, Test accuracy: 90.00 

Round   5, Train loss: 0.017, Test loss: 0.503, Test accuracy: 87.75 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.698, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.659, Test accuracy: 87.50 

        train local model (freeze embeding):client   1,  Train loss: 0.101, Train accuracy: 97.000, Test loss: 0.203, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.164, Train accuracy: 96.000, Test loss: 0.324, Test accuracy: 91.00 

Round   6, Train loss: 0.082, Test loss: 0.557, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.855, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.663, Test accuracy: 84.50 

        train local model (freeze embeding):client   1,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.192, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.257, Test accuracy: 93.50 

Round   7, Train loss: 0.006, Test loss: 0.629, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.202, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 0.544, Test accuracy: 87.50 

Round   8, Train loss: 0.024, Test loss: 0.651, Test accuracy: 87.25 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.793, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.653, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.351, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 0.281, Test accuracy: 90.50 

Round   9, Train loss: 0.013, Test loss: 0.597, Test accuracy: 86.25 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.773, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.530, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.219, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.079, Train accuracy: 97.000, Test loss: 0.222, Test accuracy: 94.00 

Round  10, Train loss: 0.041, Test loss: 0.504, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.789, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.562, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.233, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.176, Test accuracy: 96.50 

Round  11, Train loss: 0.008, Test loss: 0.472, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.695, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.580, Test accuracy: 84.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.197, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.277, Test accuracy: 92.00 

Round  12, Train loss: 0.005, Test loss: 0.481, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.730, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.679, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.189, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.142, Test accuracy: 95.00 

Round  13, Train loss: 0.001, Test loss: 0.459, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.706, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.204, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.244, Test accuracy: 93.50 

Round  14, Train loss: 0.000, Test loss: 0.565, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.763, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.745, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.199, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.209, Test accuracy: 93.50 

Round  15, Train loss: 0.000, Test loss: 0.568, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.783, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.703, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.221, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.114, Train accuracy: 97.500, Test loss: 0.299, Test accuracy: 94.50 

Round  16, Train loss: 0.057, Test loss: 0.727, Test accuracy: 85.25 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 98.000, Test loss: 0.942, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.759, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.203, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.189, Test accuracy: 94.00 

Round  17, Train loss: 0.007, Test loss: 0.490, Test accuracy: 88.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.760, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.758, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.214, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.226, Test accuracy: 93.50 

Round  18, Train loss: 0.003, Test loss: 0.489, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.734, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.801, Test accuracy: 84.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.227, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.168, Test accuracy: 95.50 

Round  19, Train loss: 0.000, Test loss: 0.497, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.789, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.787, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.200, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.205, Test accuracy: 94.50 

Final Round, Train loss: 0.001, Test loss: 0.509, Test accuracy: 89.50 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.059, Train accuracy: 98.000, Test loss: 0.971, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.128, Train accuracy: 94.500, Test loss: 0.586, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.602, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.246, Train accuracy: 91.500, Test loss: 0.454, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.119, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.180, Train accuracy: 93.500, Test loss: 0.849, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.198, Train accuracy: 90.000, Test loss: 0.755, Test accuracy: 72.50 

Round   0, Train loss: 0.071, Test loss: 0.559, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.417, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.541, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.057, Train accuracy: 99.500, Test loss: 0.292, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.250, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.191, Train accuracy: 93.500, Test loss: 0.824, Test accuracy: 65.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.209, Train accuracy: 92.000, Test loss: 0.992, Test accuracy: 68.50 

Round   1, Train loss: 0.075, Test loss: 0.566, Test accuracy: 80.17 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.500, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.640, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.080, Train accuracy: 97.000, Test loss: 0.281, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.234, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.167, Train accuracy: 96.500, Test loss: 0.833, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.078, Train accuracy: 98.000, Test loss: 1.100, Test accuracy: 72.00 

Round   2, Train loss: 0.033, Test loss: 0.540, Test accuracy: 80.67 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.550, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.552, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.059, Train accuracy: 97.500, Test loss: 0.341, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.173, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.133, Train accuracy: 95.000, Test loss: 0.904, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.078, Train accuracy: 97.000, Test loss: 0.876, Test accuracy: 73.00 

Round   3, Train loss: 0.029, Test loss: 0.566, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.532, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.634, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.316, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.163, Test accuracy: 95.50 

        train local model (freeze embeding):client   2,  Train loss: 0.112, Train accuracy: 96.500, Test loss: 0.897, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.049, Train accuracy: 98.000, Test loss: 1.026, Test accuracy: 73.00 

Round   4, Train loss: 0.017, Test loss: 0.542, Test accuracy: 81.33 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.471, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.725, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.293, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.262, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.069, Train accuracy: 96.500, Test loss: 0.937, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.083, Train accuracy: 97.500, Test loss: 1.336, Test accuracy: 69.50 

Round   5, Train loss: 0.029, Test loss: 0.573, Test accuracy: 80.83 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.000, Test loss: 0.495, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.661, Test accuracy: 87.50 

        train local model (freeze embeding):client   1,  Train loss: 0.048, Train accuracy: 98.000, Test loss: 0.286, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.273, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.066, Train accuracy: 97.000, Test loss: 0.942, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.238, Train accuracy: 90.000, Test loss: 1.641, Test accuracy: 66.00 

Round   6, Train loss: 0.080, Test loss: 0.574, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.425, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.583, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.280, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.126, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.059, Train accuracy: 99.500, Test loss: 1.027, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.088, Train accuracy: 97.000, Test loss: 1.234, Test accuracy: 72.00 

Round   7, Train loss: 0.031, Test loss: 0.606, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.577, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.445, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 0.341, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.236, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.033, Train accuracy: 99.500, Test loss: 0.916, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.258, Train accuracy: 88.500, Test loss: 1.659, Test accuracy: 66.00 

Round   8, Train loss: 0.094, Test loss: 0.663, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.439, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.934, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.328, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.218, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.053, Train accuracy: 98.500, Test loss: 1.035, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 1.440, Test accuracy: 68.50 

Round   9, Train loss: 0.013, Test loss: 0.651, Test accuracy: 80.33 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.479, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.503, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.289, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.220, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 1.122, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.128, Train accuracy: 96.000, Test loss: 1.413, Test accuracy: 68.50 

Round  10, Train loss: 0.045, Test loss: 0.592, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.426, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.749, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.322, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.263, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.052, Train accuracy: 99.000, Test loss: 1.027, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.655, Train accuracy: 80.500, Test loss: 1.821, Test accuracy: 66.00 

Round  11, Train loss: 0.220, Test loss: 0.630, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.558, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.532, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.207, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.167, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.047, Train accuracy: 98.500, Test loss: 1.012, Test accuracy: 67.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.225, Test accuracy: 73.50 

Round  12, Train loss: 0.002, Test loss: 0.579, Test accuracy: 82.67 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.475, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.508, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.256, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.262, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 1.117, Test accuracy: 77.00 

Round  13, Train loss: 0.012, Test loss: 0.572, Test accuracy: 83.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.394, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.612, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.333, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.148, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.000, Test loss: 1.280, Test accuracy: 70.50 

Round  14, Train loss: 0.011, Test loss: 0.612, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 0.712, Test accuracy: 84.50 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.265, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.201, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.040, Train accuracy: 99.500, Test loss: 1.210, Test accuracy: 73.50 

Round  15, Train loss: 0.025, Test loss: 0.595, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.502, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.702, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.335, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.189, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 1.049, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 1.234, Test accuracy: 73.00 

Round  16, Train loss: 0.010, Test loss: 0.652, Test accuracy: 83.33 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.484, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.260, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.364, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.051, Train accuracy: 98.000, Test loss: 1.490, Test accuracy: 72.00 

Round  17, Train loss: 0.022, Test loss: 0.708, Test accuracy: 82.67 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.487, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.675, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.331, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.186, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.021, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 1.382, Test accuracy: 69.50 

Round  18, Train loss: 0.007, Test loss: 0.667, Test accuracy: 83.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.467, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.516, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.282, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.140, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.304, Test accuracy: 74.00 

Round  19, Train loss: 0.003, Test loss: 0.687, Test accuracy: 81.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.516, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.515, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.269, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.270, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.119, Test accuracy: 71.00 

Final Round, Train loss: 0.005, Test loss: 0.651, Test accuracy: 82.67 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.048, Train accuracy: 97.500, Test loss: 0.612, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.260, Train accuracy: 90.500, Test loss: 0.843, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.523, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.207, Train accuracy: 92.500, Test loss: 0.445, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 0.321, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.258, Train accuracy: 91.000, Test loss: 1.018, Test accuracy: 65.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.070, Train accuracy: 98.500, Test loss: 1.262, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.173, Train accuracy: 94.500, Test loss: 0.719, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.076, Train accuracy: 96.500, Test loss: 0.628, Test accuracy: 81.50 

Round   0, Train loss: 0.045, Test loss: 0.667, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 0.533, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.640, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.031, Train accuracy: 98.500, Test loss: 0.317, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.049, Train accuracy: 99.000, Test loss: 1.054, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 1.359, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.336, Train accuracy: 84.000, Test loss: 0.646, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.085, Train accuracy: 97.000, Test loss: 0.716, Test accuracy: 78.50 

Round   1, Train loss: 0.026, Test loss: 0.589, Test accuracy: 80.62 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.600, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.261, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.162, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.039, Train accuracy: 99.500, Test loss: 1.211, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.486, Train accuracy: 87.000, Test loss: 2.705, Test accuracy: 62.00 

        train local model (freeze embeding):client   3,  Train loss: 0.281, Train accuracy: 89.000, Test loss: 0.663, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.126, Train accuracy: 96.000, Test loss: 0.736, Test accuracy: 82.00 

Round   2, Train loss: 0.154, Test loss: 0.574, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.413, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.648, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.223, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.176, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.000, Test loss: 1.072, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.299, Train accuracy: 92.000, Test loss: 1.431, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.241, Train accuracy: 89.000, Test loss: 0.516, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.141, Train accuracy: 95.000, Test loss: 1.025, Test accuracy: 76.00 

Round   3, Train loss: 0.111, Test loss: 0.547, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.437, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.023, Train accuracy: 98.500, Test loss: 0.277, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.129, Test accuracy: 96.00 

        train local model (freeze embeding):client   2,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.046, Train accuracy: 99.500, Test loss: 1.290, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.226, Train accuracy: 92.000, Test loss: 0.636, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.859, Train accuracy: 74.500, Test loss: 2.141, Test accuracy: 59.00 

Round   4, Train loss: 0.227, Test loss: 0.639, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.437, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.722, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.278, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.271, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 0.998, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.384, Train accuracy: 92.500, Test loss: 1.595, Test accuracy: 66.00 

        train local model (freeze embeding):client   3,  Train loss: 0.264, Train accuracy: 89.000, Test loss: 0.686, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.174, Train accuracy: 93.500, Test loss: 0.984, Test accuracy: 79.50 

Round   5, Train loss: 0.142, Test loss: 0.602, Test accuracy: 81.38 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.399, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.387, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.323, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.065, Train accuracy: 97.500, Test loss: 1.418, Test accuracy: 74.50 

        train local model (freeze embeding):client   3,  Train loss: 0.194, Train accuracy: 93.500, Test loss: 0.617, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 0.616, Test accuracy: 83.00 

Round   6, Train loss: 0.031, Test loss: 0.561, Test accuracy: 83.62 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.419, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.442, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.283, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.317, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 1.065, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 98.500, Test loss: 1.212, Test accuracy: 74.50 

        train local model (freeze embeding):client   3,  Train loss: 0.115, Train accuracy: 95.500, Test loss: 0.545, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.087, Train accuracy: 97.000, Test loss: 0.743, Test accuracy: 77.50 

Round   7, Train loss: 0.029, Test loss: 0.547, Test accuracy: 83.88 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.437, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.516, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.298, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.227, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.049, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.234, Test accuracy: 75.50 

        train local model (freeze embeding):client   3,  Train loss: 0.149, Train accuracy: 93.000, Test loss: 0.643, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.073, Train accuracy: 97.000, Test loss: 1.048, Test accuracy: 80.50 

Round   8, Train loss: 0.019, Test loss: 0.561, Test accuracy: 83.38 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.474, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.280, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.167, Test accuracy: 96.00 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.053, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.063, Train accuracy: 98.500, Test loss: 0.527, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.134, Train accuracy: 95.000, Test loss: 0.813, Test accuracy: 81.00 

Round   9, Train loss: 0.036, Test loss: 0.586, Test accuracy: 83.12 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.415, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.644, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.262, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.276, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 1.137, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.125, Train accuracy: 95.500, Test loss: 1.526, Test accuracy: 71.50 

        train local model (freeze embeding):client   3,  Train loss: 0.086, Train accuracy: 97.000, Test loss: 0.609, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.027, Train accuracy: 100.000, Test loss: 0.531, Test accuracy: 82.00 

Round  10, Train loss: 0.041, Test loss: 0.570, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.459, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.495, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.277, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.294, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.082, Train accuracy: 97.000, Test loss: 1.048, Test accuracy: 70.00 

        train local model (freeze embeding):client   3,  Train loss: 0.086, Train accuracy: 97.500, Test loss: 0.524, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.776, Test accuracy: 84.00 

Round  11, Train loss: 0.022, Test loss: 0.586, Test accuracy: 83.12 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.597, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.209, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 1.804, Test accuracy: 70.00 

        train local model (freeze embeding):client   3,  Train loss: 0.043, Train accuracy: 99.000, Test loss: 0.535, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 2.265, Train accuracy: 77.000, Test loss: 3.993, Test accuracy: 68.00 

Round  12, Train loss: 0.571, Test loss: 0.645, Test accuracy: 82.88 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.586, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.323, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.165, Test accuracy: 95.50 

        train local model (freeze embeding):client   2,  Train loss: 0.030, Train accuracy: 99.500, Test loss: 1.129, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.042, Train accuracy: 98.500, Test loss: 1.507, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.128, Train accuracy: 96.000, Test loss: 0.672, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.101, Train accuracy: 96.500, Test loss: 0.777, Test accuracy: 80.50 

Round  13, Train loss: 0.037, Test loss: 0.586, Test accuracy: 83.12 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.521, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.588, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.194, Train accuracy: 96.500, Test loss: 0.987, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.085, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.432, Test accuracy: 75.50 

        train local model (freeze embeding):client   3,  Train loss: 0.049, Train accuracy: 98.000, Test loss: 0.513, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.020, Train accuracy: 98.500, Test loss: 1.041, Test accuracy: 80.50 

Round  14, Train loss: 0.054, Test loss: 0.657, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.551, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.641, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.199, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.151, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.039, Train accuracy: 98.000, Test loss: 1.430, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.040, Train accuracy: 99.000, Test loss: 0.591, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.049, Train accuracy: 98.000, Test loss: 0.638, Test accuracy: 83.00 

Round  15, Train loss: 0.029, Test loss: 0.587, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.571, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.578, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.231, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 98.500, Test loss: 0.259, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.172, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.332, Test accuracy: 75.50 

        train local model (freeze embeding):client   3,  Train loss: 0.047, Train accuracy: 98.000, Test loss: 0.666, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.064, Train accuracy: 97.000, Test loss: 1.225, Test accuracy: 76.00 

Round  16, Train loss: 0.022, Test loss: 0.691, Test accuracy: 81.88 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.573, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.574, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.235, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.091, Test accuracy: 97.50 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.420, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.055, Train accuracy: 98.500, Test loss: 0.564, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.649, Test accuracy: 83.00 

Round  17, Train loss: 0.003, Test loss: 0.656, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.564, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.616, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.175, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.237, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 1.230, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.402, Test accuracy: 75.50 

        train local model (freeze embeding):client   3,  Train loss: 0.024, Train accuracy: 100.000, Test loss: 0.662, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.093, Train accuracy: 97.000, Test loss: 0.513, Test accuracy: 85.50 

Round  18, Train loss: 0.024, Test loss: 0.621, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.575, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.637, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.222, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.166, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.141, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 0.550, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.042, Train accuracy: 98.500, Test loss: 0.736, Test accuracy: 83.00 

Round  19, Train loss: 0.013, Test loss: 0.597, Test accuracy: 83.62 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.572, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.576, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.218, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.111, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.143, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 0.520, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.503, Test accuracy: 83.50 

Final Round, Train loss: 0.007, Test loss: 0.597, Test accuracy: 83.62 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.098, Train accuracy: 96.500, Test loss: 0.481, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.067, Train accuracy: 97.000, Test loss: 0.692, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.897, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.241, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 0.267, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.144, Train accuracy: 94.500, Test loss: 1.089, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 1.504, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.193, Train accuracy: 91.500, Test loss: 0.615, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.082, Train accuracy: 96.000, Test loss: 0.886, Test accuracy: 84.00 

        train local model (freeze embeding):client   4,  Train loss: 0.099, Train accuracy: 96.000, Test loss: 0.559, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.289, Test accuracy: 90.00 

Round   0, Train loss: 0.033, Test loss: 0.637, Test accuracy: 80.40 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.578, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.762, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.272, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.145, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.114, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.081, Train accuracy: 97.000, Test loss: 1.290, Test accuracy: 71.50 

        train local model (freeze embeding):client   3,  Train loss: 0.088, Train accuracy: 98.000, Test loss: 0.566, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.129, Train accuracy: 96.000, Test loss: 1.663, Test accuracy: 78.00 

        train local model (freeze embeding):client   4,  Train loss: 0.212, Train accuracy: 91.000, Test loss: 0.564, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.311, Test accuracy: 90.50 

Round   1, Train loss: 0.045, Test loss: 0.608, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.526, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.713, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.166, Test accuracy: 96.00 

        train local model (freeze embeding):client   2,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.105, Train accuracy: 96.000, Test loss: 2.166, Test accuracy: 68.50 

        train local model (freeze embeding):client   3,  Train loss: 0.070, Train accuracy: 97.500, Test loss: 0.560, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.079, Train accuracy: 97.000, Test loss: 0.888, Test accuracy: 78.50 

        train local model (freeze embeding):client   4,  Train loss: 0.182, Train accuracy: 92.500, Test loss: 0.510, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.034, Train accuracy: 98.500, Test loss: 0.364, Test accuracy: 90.50 

Round   2, Train loss: 0.044, Test loss: 0.619, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.495, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.625, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.275, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.263, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.108, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.042, Train accuracy: 98.000, Test loss: 1.325, Test accuracy: 71.50 

        train local model (freeze embeding):client   3,  Train loss: 0.068, Train accuracy: 97.000, Test loss: 0.565, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.095, Train accuracy: 96.000, Test loss: 1.029, Test accuracy: 75.50 

        train local model (freeze embeding):client   4,  Train loss: 0.162, Train accuracy: 96.000, Test loss: 0.608, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.308, Test accuracy: 90.50 

Round   3, Train loss: 0.030, Test loss: 0.629, Test accuracy: 81.90 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.522, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.547, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.308, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.195, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.139, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.126, Train accuracy: 97.000, Test loss: 1.837, Test accuracy: 74.50 

        train local model (freeze embeding):client   3,  Train loss: 0.056, Train accuracy: 99.000, Test loss: 0.591, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.110, Train accuracy: 95.000, Test loss: 0.715, Test accuracy: 82.50 

        train local model (freeze embeding):client   4,  Train loss: 0.180, Train accuracy: 92.500, Test loss: 0.498, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 91.50 

Round   4, Train loss: 0.050, Test loss: 0.587, Test accuracy: 82.30 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.670, Test accuracy: 84.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.287, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.322, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.202, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.080, Train accuracy: 96.500, Test loss: 2.082, Test accuracy: 66.00 

        train local model (freeze embeding):client   3,  Train loss: 0.072, Train accuracy: 97.000, Test loss: 0.582, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.710, Test accuracy: 83.50 

        train local model (freeze embeding):client   4,  Train loss: 0.188, Train accuracy: 92.000, Test loss: 0.507, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 90.50 

Round   5, Train loss: 0.020, Test loss: 0.622, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.525, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.611, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.249, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.221, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.247, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 1.400, Test accuracy: 74.50 

        train local model (freeze embeding):client   3,  Train loss: 0.073, Train accuracy: 96.500, Test loss: 0.677, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.211, Train accuracy: 92.500, Test loss: 0.914, Test accuracy: 77.50 

        train local model (freeze embeding):client   4,  Train loss: 0.147, Train accuracy: 94.500, Test loss: 0.495, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.224, Test accuracy: 92.50 

Round   6, Train loss: 0.046, Test loss: 0.581, Test accuracy: 83.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.530, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.039, Train accuracy: 98.000, Test loss: 0.291, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.161, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.040, Train accuracy: 98.500, Test loss: 1.623, Test accuracy: 69.50 

        train local model (freeze embeding):client   3,  Train loss: 0.024, Train accuracy: 100.000, Test loss: 0.529, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.051, Train accuracy: 97.000, Test loss: 1.427, Test accuracy: 77.00 

        train local model (freeze embeding):client   4,  Train loss: 0.089, Train accuracy: 97.500, Test loss: 0.421, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.386, Test accuracy: 87.50 

Round   7, Train loss: 0.029, Test loss: 0.570, Test accuracy: 83.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.460, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 2.920, Train accuracy: 57.500, Test loss: 5.577, Test accuracy: 56.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.217, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.270, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.684, Test accuracy: 73.50 

        train local model (freeze embeding):client   3,  Train loss: 0.039, Train accuracy: 98.500, Test loss: 0.616, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 85.00 

        train local model (freeze embeding):client   4,  Train loss: 0.075, Train accuracy: 98.000, Test loss: 0.500, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.587, Train accuracy: 84.000, Test loss: 1.646, Test accuracy: 71.00 

Round   8, Train loss: 0.706, Test loss: 0.976, Test accuracy: 79.90 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.482, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.534, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.271, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.178, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.516, Test accuracy: 69.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 72.50 

        train local model (freeze embeding):client   3,  Train loss: 0.055, Train accuracy: 98.500, Test loss: 0.633, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.424, Train accuracy: 87.000, Test loss: 2.157, Test accuracy: 70.50 

        train local model (freeze embeding):client   4,  Train loss: 0.052, Train accuracy: 98.500, Test loss: 0.391, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.354, Test accuracy: 91.00 

Round   9, Train loss: 0.087, Test loss: 0.602, Test accuracy: 83.70 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.503, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.057, Train accuracy: 97.500, Test loss: 0.943, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.228, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.311, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.545, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.533, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.613, Test accuracy: 83.50 

        train local model (freeze embeding):client   4,  Train loss: 0.069, Train accuracy: 97.000, Test loss: 0.429, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.274, Test accuracy: 92.00 

Round  10, Train loss: 0.013, Test loss: 0.618, Test accuracy: 82.90 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.485, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.623, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.205, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.234, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.294, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.673, Train accuracy: 84.500, Test loss: 3.868, Test accuracy: 61.00 

        train local model (freeze embeding):client   3,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 0.580, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.578, Test accuracy: 86.00 

        train local model (freeze embeding):client   4,  Train loss: 0.044, Train accuracy: 99.000, Test loss: 0.408, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.401, Test accuracy: 91.00 

Round  11, Train loss: 0.137, Test loss: 0.616, Test accuracy: 83.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.491, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.490, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.278, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.241, Train accuracy: 95.500, Test loss: 1.108, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.363, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.473, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.032, Train accuracy: 98.500, Test loss: 0.553, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.149, Test accuracy: 81.00 

        train local model (freeze embeding):client   4,  Train loss: 0.055, Train accuracy: 97.500, Test loss: 0.393, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.159, Train accuracy: 93.000, Test loss: 0.564, Test accuracy: 82.50 

Round  12, Train loss: 0.082, Test loss: 0.600, Test accuracy: 83.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.568, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.208, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.313, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.357, Test accuracy: 75.50 

        train local model (freeze embeding):client   3,  Train loss: 0.052, Train accuracy: 99.000, Test loss: 0.805, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.225, Train accuracy: 93.000, Test loss: 1.641, Test accuracy: 74.50 

        train local model (freeze embeding):client   4,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 0.378, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.323, Test accuracy: 91.00 

Round  13, Train loss: 0.046, Test loss: 0.621, Test accuracy: 83.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.543, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.605, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.253, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 1.240, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.403, Test accuracy: 72.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.505, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.000, Test loss: 0.459, Test accuracy: 85.00 

        train local model (freeze embeding):client   4,  Train loss: 0.047, Train accuracy: 99.000, Test loss: 0.460, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.366, Test accuracy: 90.00 

Round  14, Train loss: 0.007, Test loss: 0.617, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.543, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.655, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.272, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 98.500, Test loss: 0.151, Test accuracy: 95.50 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 1.233, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.481, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.548, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.081, Train accuracy: 97.000, Test loss: 1.001, Test accuracy: 72.00 

        train local model (freeze embeding):client   4,  Train loss: 0.031, Train accuracy: 99.500, Test loss: 0.378, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.041, Train accuracy: 98.000, Test loss: 0.397, Test accuracy: 89.50 

Round  15, Train loss: 0.030, Test loss: 0.624, Test accuracy: 83.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.575, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.586, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.237, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.199, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.588, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.613, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.031, Train accuracy: 98.500, Test loss: 0.663, Test accuracy: 81.00 

        train local model (freeze embeding):client   4,  Train loss: 0.026, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.464, Test accuracy: 88.50 

Round  16, Train loss: 0.009, Test loss: 0.602, Test accuracy: 82.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.626, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.663, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.236, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.245, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.241, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 1.670, Test accuracy: 69.00 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.662, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.591, Test accuracy: 83.50 

        train local model (freeze embeding):client   4,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.451, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.348, Test accuracy: 91.00 

Round  17, Train loss: 0.003, Test loss: 0.643, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.573, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.574, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.178, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.282, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.363, Test accuracy: 73.50 

        train local model (freeze embeding):client   3,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.663, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.650, Test accuracy: 82.50 

        train local model (freeze embeding):client   4,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.437, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 91.50 

Round  18, Train loss: 0.001, Test loss: 0.626, Test accuracy: 84.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.603, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.557, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.249, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.239, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.589, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.651, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 86.50 

        train local model (freeze embeding):client   4,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.403, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.045, Train accuracy: 98.000, Test loss: 0.595, Test accuracy: 86.00 

Round  19, Train loss: 0.010, Test loss: 0.607, Test accuracy: 83.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.561, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.562, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.267, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.283, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.284, Test accuracy: 71.50 

        train local model (freeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.597, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 0.561, Test accuracy: 83.50 

        train local model (freeze embeding):client   4,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.408, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.365, Test accuracy: 90.00 

Final Round, Train loss: 0.007, Test loss: 0.583, Test accuracy: 83.60 

Average accuracy final 10 rounds: 421.82083333333344 

1346.1124477386475
[4.082327842712402, 8.563680171966553, 12.624470233917236, 16.42256999015808, 20.4753520488739, 24.303693056106567, 28.325600624084473, 32.363569259643555, 36.42421245574951, 40.53297734260559, 44.41827034950256, 48.36272358894348, 52.2673134803772, 56.24202919006348, 60.38847303390503, 64.29475235939026, 68.19174456596375, 72.13228106498718, 76.09015345573425, 79.96943426132202, 82.35300159454346, 86.22288727760315, 90.35684657096863, 94.39890646934509, 98.42080807685852, 102.67910766601562, 107.17879128456116, 111.26480627059937, 115.53419804573059, 119.60189628601074, 123.68729043006897, 127.67541360855103, 131.50159430503845, 135.5030562877655, 139.41260957717896, 143.5007643699646, 147.34059691429138, 151.31882238388062, 155.13875269889832, 158.99788737297058, 162.88911294937134, 165.22657370567322, 169.27874541282654, 173.26451206207275, 177.33392906188965, 181.47410702705383, 185.76705121994019, 189.93486380577087, 194.01505661010742, 198.0434205532074, 202.0567717552185, 206.14928269386292, 210.2043797969818, 214.5237889289856, 218.51566195487976, 222.57526278495789, 226.4814636707306, 230.4312882423401, 234.56879544258118, 238.55721592903137, 242.62030124664307, 246.7288761138916, 249.35590243339539, 253.377379655838, 257.439480304718, 261.47491693496704, 265.63516187667847, 269.5788550376892, 273.4386029243469, 277.43122148513794, 281.56945514678955, 285.62933230400085, 289.6732850074768, 293.5898609161377, 297.79049038887024, 302.1033368110657, 306.2174286842346, 310.2544889450073, 314.4033691883087, 318.41944551467896, 322.35822796821594, 326.47375226020813, 330.56302857398987, 333.1125361919403, 337.31424021720886, 341.43511414527893, 345.6364150047302, 349.56004762649536, 353.5445604324341, 357.5369257926941, 361.63475942611694, 365.92983627319336, 370.16041898727417, 374.13673305511475, 378.2422881126404, 382.2752888202667, 386.6183807849884, 390.72716069221497, 394.8420889377594, 398.8401494026184, 402.94824624061584, 407.12808895111084, 411.14561700820923, 415.12622237205505, 418.0994167327881]
[83.0, 81.5, 84.0, 85.5, 84.0, 81.5, 84.5, 82.5, 84.0, 85.0, 85.0, 87.0, 87.0, 82.5, 83.0, 85.5, 79.0, 87.5, 84.0, 86.5, 87.0, 84.0, 85.0, 84.25, 85.75, 85.25, 87.75, 88.0, 86.0, 87.25, 86.25, 88.5, 88.75, 89.25, 88.75, 88.0, 87.5, 85.25, 88.25, 88.75, 89.5, 89.5, 80.0, 80.16666666666667, 80.66666666666667, 80.0, 81.33333333333333, 80.83333333333333, 82.16666666666667, 82.0, 80.5, 80.33333333333333, 82.16666666666667, 80.5, 82.66666666666667, 83.83333333333333, 83.0, 82.16666666666667, 83.33333333333333, 82.66666666666667, 83.33333333333333, 81.66666666666667, 82.66666666666667, 78.0, 80.625, 81.75, 82.0, 79.0, 81.375, 83.625, 83.875, 83.375, 83.125, 83.5, 83.125, 82.875, 83.125, 82.25, 82.25, 81.875, 82.25, 84.0, 83.625, 83.625, 80.4, 82.5, 82.0, 81.9, 82.3, 83.5, 83.3, 83.1, 79.9, 83.7, 82.9, 83.2, 83.6, 83.9, 84.0, 83.1, 82.8, 83.5, 84.2, 83.3, 83.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.681, Test loss: 0.625, Test accuracy: 70.50 

Round   0, Global train loss: 0.681, Global test loss: 0.916, Global test accuracy: 50.00 

Round   1, Train loss: 0.538, Test loss: 1.067, Test accuracy: 69.90 

Round   1, Global train loss: 0.538, Global test loss: 0.915, Global test accuracy: 50.00 

Round   2, Train loss: 0.470, Test loss: 0.474, Test accuracy: 79.70 

Round   2, Global train loss: 0.470, Global test loss: 0.896, Global test accuracy: 50.00 

Round   3, Train loss: 0.376, Test loss: 0.497, Test accuracy: 79.80 

Round   3, Global train loss: 0.376, Global test loss: 1.048, Global test accuracy: 50.00 

Round   4, Train loss: 0.329, Test loss: 0.626, Test accuracy: 78.60 

Round   4, Global train loss: 0.329, Global test loss: 1.106, Global test accuracy: 50.00 

Round   5, Train loss: 0.296, Test loss: 0.595, Test accuracy: 79.30 

Round   5, Global train loss: 0.296, Global test loss: 1.111, Global test accuracy: 50.00 

Round   6, Train loss: 0.259, Test loss: 0.937, Test accuracy: 78.20 

Round   6, Global train loss: 0.259, Global test loss: 0.977, Global test accuracy: 50.00 

Round   7, Train loss: 0.238, Test loss: 0.529, Test accuracy: 81.50 

Round   7, Global train loss: 0.238, Global test loss: 1.053, Global test accuracy: 50.00 

Round   8, Train loss: 0.188, Test loss: 0.562, Test accuracy: 82.00 

Round   8, Global train loss: 0.188, Global test loss: 1.217, Global test accuracy: 50.00 

Round   9, Train loss: 0.157, Test loss: 0.599, Test accuracy: 81.20 

Round   9, Global train loss: 0.157, Global test loss: 1.249, Global test accuracy: 50.00 

Round  10, Train loss: 0.159, Test loss: 0.545, Test accuracy: 81.80 

Round  10, Global train loss: 0.159, Global test loss: 1.188, Global test accuracy: 50.00 

Round  11, Train loss: 0.146, Test loss: 0.547, Test accuracy: 82.90 

Round  11, Global train loss: 0.146, Global test loss: 1.349, Global test accuracy: 50.00 

Round  12, Train loss: 0.125, Test loss: 0.672, Test accuracy: 80.70 

Round  12, Global train loss: 0.125, Global test loss: 1.185, Global test accuracy: 50.00 

Round  13, Train loss: 0.116, Test loss: 0.700, Test accuracy: 82.10 

Round  13, Global train loss: 0.116, Global test loss: 1.153, Global test accuracy: 50.00 

Round  14, Train loss: 0.101, Test loss: 0.523, Test accuracy: 84.20 

Round  14, Global train loss: 0.101, Global test loss: 1.093, Global test accuracy: 50.00 

Round  15, Train loss: 0.069, Test loss: 0.657, Test accuracy: 81.90 

Round  15, Global train loss: 0.069, Global test loss: 1.342, Global test accuracy: 50.00 

Round  16, Train loss: 0.069, Test loss: 0.565, Test accuracy: 84.60 

Round  16, Global train loss: 0.069, Global test loss: 1.360, Global test accuracy: 50.00 

Round  17, Train loss: 0.072, Test loss: 0.630, Test accuracy: 82.90 

Round  17, Global train loss: 0.072, Global test loss: 1.186, Global test accuracy: 50.00 

Round  18, Train loss: 0.074, Test loss: 0.717, Test accuracy: 80.70 

Round  18, Global train loss: 0.074, Global test loss: 1.293, Global test accuracy: 50.00 

Round  19, Train loss: 0.042, Test loss: 0.746, Test accuracy: 82.60 

Round  19, Global train loss: 0.042, Global test loss: 1.403, Global test accuracy: 50.00 

Round  20, Train loss: 0.062, Test loss: 0.517, Test accuracy: 84.90 

Round  20, Global train loss: 0.062, Global test loss: 1.369, Global test accuracy: 50.00 

Round  21, Train loss: 0.024, Test loss: 0.603, Test accuracy: 83.30 

Round  21, Global train loss: 0.024, Global test loss: 1.538, Global test accuracy: 50.00 

Round  22, Train loss: 0.041, Test loss: 0.607, Test accuracy: 84.00 

Round  22, Global train loss: 0.041, Global test loss: 1.561, Global test accuracy: 50.00 

Round  23, Train loss: 0.039, Test loss: 0.585, Test accuracy: 84.10 

Round  23, Global train loss: 0.039, Global test loss: 1.432, Global test accuracy: 50.00 

Round  24, Train loss: 0.018, Test loss: 0.665, Test accuracy: 83.70 

Round  24, Global train loss: 0.018, Global test loss: 1.667, Global test accuracy: 50.00 

Round  25, Train loss: 0.025, Test loss: 0.582, Test accuracy: 86.00 

Round  25, Global train loss: 0.025, Global test loss: 1.588, Global test accuracy: 50.00 

Round  26, Train loss: 0.033, Test loss: 0.640, Test accuracy: 84.10 

Round  26, Global train loss: 0.033, Global test loss: 1.539, Global test accuracy: 50.00 

Round  27, Train loss: 0.027, Test loss: 0.674, Test accuracy: 84.30 

Round  27, Global train loss: 0.027, Global test loss: 1.451, Global test accuracy: 50.00 

Round  28, Train loss: 0.020, Test loss: 0.627, Test accuracy: 85.60 

Round  28, Global train loss: 0.020, Global test loss: 1.516, Global test accuracy: 50.00 

Round  29, Train loss: 0.025, Test loss: 0.648, Test accuracy: 82.30 

Round  29, Global train loss: 0.025, Global test loss: 1.400, Global test accuracy: 50.00 

Round  30, Train loss: 0.022, Test loss: 0.659, Test accuracy: 83.60 

Round  30, Global train loss: 0.022, Global test loss: 1.514, Global test accuracy: 50.00 

Round  31, Train loss: 0.025, Test loss: 0.621, Test accuracy: 82.90 

Round  31, Global train loss: 0.025, Global test loss: 1.601, Global test accuracy: 50.00 

Round  32, Train loss: 0.015, Test loss: 0.701, Test accuracy: 84.50 

Round  32, Global train loss: 0.015, Global test loss: 1.782, Global test accuracy: 50.00 

Round  33, Train loss: 0.010, Test loss: 0.697, Test accuracy: 84.50 

Round  33, Global train loss: 0.010, Global test loss: 1.822, Global test accuracy: 50.00 

Round  34, Train loss: 0.006, Test loss: 0.675, Test accuracy: 84.70 

Round  34, Global train loss: 0.006, Global test loss: 1.796, Global test accuracy: 50.00 

Final Round, Train loss: 0.016, Test loss: 0.766, Test accuracy: 83.50 

Final Round, Global train loss: 0.016, Global test loss: 1.796, Global test accuracy: 50.00 

Average accuracy final 10 rounds: 84.25 

Average global accuracy final 10 rounds: 50.0 

510.8624346256256
[4.53244948387146, 7.141969203948975, 9.587060689926147, 11.970741748809814, 14.76303768157959, 17.27276372909546, 19.717782258987427, 22.23099422454834, 24.75751519203186, 27.173261642456055, 29.84483289718628, 32.34266710281372, 34.788551330566406, 37.36949419975281, 39.88881874084473, 42.4536452293396, 45.040948152542114, 47.63431239128113, 50.2296838760376, 52.86098837852478, 55.45182490348816, 58.06089520454407, 60.69567656517029, 63.3578782081604, 65.9218487739563, 68.57087016105652, 71.10618495941162, 73.66104650497437, 76.23651242256165, 78.91668224334717, 81.50542521476746, 84.1000440120697, 86.67090940475464, 89.2589704990387, 91.86571216583252, 97.14243412017822]
[70.5, 69.9, 79.7, 79.8, 78.6, 79.3, 78.2, 81.5, 82.0, 81.2, 81.8, 82.9, 80.7, 82.1, 84.2, 81.9, 84.6, 82.9, 80.7, 82.6, 84.9, 83.3, 84.0, 84.1, 83.7, 86.0, 84.1, 84.3, 85.6, 82.3, 83.6, 82.9, 84.5, 84.5, 84.7, 83.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.703, Test loss: 0.738, Test accuracy: 68.50 

Round   0, Global train loss: 0.703, Global test loss: 0.781, Global test accuracy: 50.00 

Round   1, Train loss: 0.663, Test loss: 0.609, Test accuracy: 72.70 

Round   1, Global train loss: 0.663, Global test loss: 0.672, Global test accuracy: 60.60 

Round   2, Train loss: 0.589, Test loss: 0.584, Test accuracy: 74.90 

Round   2, Global train loss: 0.589, Global test loss: 0.794, Global test accuracy: 53.80 

Round   3, Train loss: 0.582, Test loss: 0.954, Test accuracy: 72.60 

Round   3, Global train loss: 0.582, Global test loss: 0.705, Global test accuracy: 63.70 

Round   4, Train loss: 0.510, Test loss: 0.615, Test accuracy: 77.10 

Round   4, Global train loss: 0.510, Global test loss: 0.722, Global test accuracy: 63.90 

Round   5, Train loss: 0.469, Test loss: 0.712, Test accuracy: 75.10 

Round   5, Global train loss: 0.469, Global test loss: 0.971, Global test accuracy: 59.40 

Round   6, Train loss: 0.428, Test loss: 0.553, Test accuracy: 78.40 

Round   6, Global train loss: 0.428, Global test loss: 0.809, Global test accuracy: 65.20 

Round   7, Train loss: 0.424, Test loss: 1.037, Test accuracy: 74.30 

Round   7, Global train loss: 0.424, Global test loss: 0.838, Global test accuracy: 66.90 

Round   8, Train loss: 0.397, Test loss: 0.762, Test accuracy: 75.40 

Round   8, Global train loss: 0.397, Global test loss: 0.764, Global test accuracy: 65.90 

Round   9, Train loss: 0.375, Test loss: 0.439, Test accuracy: 81.70 

Round   9, Global train loss: 0.375, Global test loss: 0.942, Global test accuracy: 65.30 

Round  10, Train loss: 0.326, Test loss: 0.714, Test accuracy: 80.10 

Round  10, Global train loss: 0.326, Global test loss: 1.098, Global test accuracy: 59.70 

Round  11, Train loss: 0.307, Test loss: 0.641, Test accuracy: 80.90 

Round  11, Global train loss: 0.307, Global test loss: 0.900, Global test accuracy: 67.10 

Round  12, Train loss: 0.292, Test loss: 0.544, Test accuracy: 84.00 

Round  12, Global train loss: 0.292, Global test loss: 0.998, Global test accuracy: 65.80 

Round  13, Train loss: 0.275, Test loss: 0.634, Test accuracy: 81.40 

Round  13, Global train loss: 0.275, Global test loss: 1.174, Global test accuracy: 64.60 

Round  14, Train loss: 0.249, Test loss: 0.470, Test accuracy: 84.00 

Round  14, Global train loss: 0.249, Global test loss: 1.057, Global test accuracy: 66.50 

Round  15, Train loss: 0.246, Test loss: 0.636, Test accuracy: 79.90 

Round  15, Global train loss: 0.246, Global test loss: 1.004, Global test accuracy: 65.40 

Round  16, Train loss: 0.241, Test loss: 0.591, Test accuracy: 81.40 

Round  16, Global train loss: 0.241, Global test loss: 0.995, Global test accuracy: 67.40 

Round  17, Train loss: 0.216, Test loss: 0.489, Test accuracy: 83.60 

Round  17, Global train loss: 0.216, Global test loss: 1.105, Global test accuracy: 66.40 

Round  18, Train loss: 0.204, Test loss: 0.501, Test accuracy: 83.40 

Round  18, Global train loss: 0.204, Global test loss: 1.076, Global test accuracy: 66.30 

Round  19, Train loss: 0.215, Test loss: 0.563, Test accuracy: 80.90 

Round  19, Global train loss: 0.215, Global test loss: 0.898, Global test accuracy: 67.50 

Round  20, Train loss: 0.199, Test loss: 0.677, Test accuracy: 82.10 

Round  20, Global train loss: 0.199, Global test loss: 0.919, Global test accuracy: 66.70 

Round  21, Train loss: 0.166, Test loss: 0.461, Test accuracy: 83.90 

Round  21, Global train loss: 0.166, Global test loss: 1.092, Global test accuracy: 66.00 

Round  22, Train loss: 0.162, Test loss: 0.528, Test accuracy: 85.70 

Round  22, Global train loss: 0.162, Global test loss: 1.256, Global test accuracy: 65.50 

Round  23, Train loss: 0.168, Test loss: 0.477, Test accuracy: 84.60 

Round  23, Global train loss: 0.168, Global test loss: 1.262, Global test accuracy: 66.00 

Round  24, Train loss: 0.149, Test loss: 0.619, Test accuracy: 83.50 

Round  24, Global train loss: 0.149, Global test loss: 1.078, Global test accuracy: 66.80 

Round  25, Train loss: 0.133, Test loss: 0.577, Test accuracy: 84.00 

Round  25, Global train loss: 0.133, Global test loss: 1.269, Global test accuracy: 66.30 

Round  26, Train loss: 0.144, Test loss: 0.448, Test accuracy: 86.30 

Round  26, Global train loss: 0.144, Global test loss: 1.116, Global test accuracy: 67.00 

Round  27, Train loss: 0.122, Test loss: 0.460, Test accuracy: 85.60 

Round  27, Global train loss: 0.122, Global test loss: 1.266, Global test accuracy: 66.70 

Round  28, Train loss: 0.134, Test loss: 0.547, Test accuracy: 84.20 

Round  28, Global train loss: 0.134, Global test loss: 1.215, Global test accuracy: 66.60 

Round  29, Train loss: 0.121, Test loss: 0.518, Test accuracy: 83.70 

Round  29, Global train loss: 0.121, Global test loss: 1.204, Global test accuracy: 67.00 

Round  30, Train loss: 0.098, Test loss: 0.682, Test accuracy: 81.40 

Round  30, Global train loss: 0.098, Global test loss: 1.327, Global test accuracy: 65.60 

Round  31, Train loss: 0.096, Test loss: 0.649, Test accuracy: 82.90 

Round  31, Global train loss: 0.096, Global test loss: 1.305, Global test accuracy: 67.10 

Round  32, Train loss: 0.088, Test loss: 0.579, Test accuracy: 83.90 

Round  32, Global train loss: 0.088, Global test loss: 1.366, Global test accuracy: 66.50 

Round  33, Train loss: 0.083, Test loss: 0.652, Test accuracy: 82.60 

Round  33, Global train loss: 0.083, Global test loss: 1.435, Global test accuracy: 66.70 

Round  34, Train loss: 0.099, Test loss: 0.617, Test accuracy: 82.60 

Round  34, Global train loss: 0.099, Global test loss: 1.362, Global test accuracy: 67.00 

Final Round, Train loss: 0.065, Test loss: 0.603, Test accuracy: 83.00 

Final Round, Global train loss: 0.065, Global test loss: 1.362, Global test accuracy: 67.00 

Average accuracy final 10 rounds: 83.72 

Average global accuracy final 10 rounds: 66.65 

503.8210835456848
[4.720414638519287, 7.114640712738037, 9.674058675765991, 11.503282308578491, 14.095205783843994, 16.67246651649475, 19.231078147888184, 21.79472827911377, 24.337559700012207, 27.009389400482178, 29.73324680328369, 32.371819257736206, 34.940988540649414, 37.50763559341431, 40.04823398590088, 42.489240884780884, 45.075140953063965, 47.61484670639038, 50.0925452709198, 52.642526149749756, 55.1424458026886, 57.78170585632324, 60.31260800361633, 62.77180790901184, 65.24808359146118, 67.86006045341492, 70.55308198928833, 73.11394166946411, 75.65517020225525, 78.31943345069885, 80.93628549575806, 83.45549011230469, 86.01721215248108, 88.60023283958435, 91.14043688774109, 96.24731063842773]
[68.5, 72.7, 74.9, 72.6, 77.1, 75.1, 78.4, 74.3, 75.4, 81.7, 80.1, 80.9, 84.0, 81.4, 84.0, 79.9, 81.4, 83.6, 83.4, 80.9, 82.1, 83.9, 85.7, 84.6, 83.5, 84.0, 86.3, 85.6, 84.2, 83.7, 81.4, 82.9, 83.9, 82.6, 82.6, 83.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.721, Test loss: 1.015, Test accuracy: 50.00 

Round   1, Train loss: 0.712, Test loss: 1.117, Test accuracy: 57.50 

Round   2, Train loss: 0.623, Test loss: 0.810, Test accuracy: 60.80 

Round   3, Train loss: 0.598, Test loss: 0.732, Test accuracy: 62.90 

Round   4, Train loss: 0.577, Test loss: 1.021, Test accuracy: 63.90 

Round   5, Train loss: 0.540, Test loss: 0.564, Test accuracy: 70.80 

Round   6, Train loss: 0.537, Test loss: 0.806, Test accuracy: 68.90 

Round   7, Train loss: 0.492, Test loss: 0.625, Test accuracy: 68.80 

Round   8, Train loss: 0.487, Test loss: 0.698, Test accuracy: 68.60 

Round   9, Train loss: 0.449, Test loss: 0.442, Test accuracy: 78.50 

Round  10, Train loss: 0.416, Test loss: 0.768, Test accuracy: 71.30 

Round  11, Train loss: 0.408, Test loss: 0.496, Test accuracy: 77.00 

Round  12, Train loss: 0.377, Test loss: 0.644, Test accuracy: 75.90 

Round  13, Train loss: 0.363, Test loss: 0.779, Test accuracy: 69.50 

Round  14, Train loss: 0.348, Test loss: 0.434, Test accuracy: 79.70 

Round  15, Train loss: 0.334, Test loss: 0.423, Test accuracy: 81.90 

Round  16, Train loss: 0.319, Test loss: 0.520, Test accuracy: 78.50 

Round  17, Train loss: 0.300, Test loss: 0.595, Test accuracy: 76.70 

Round  18, Train loss: 0.285, Test loss: 0.521, Test accuracy: 78.10 

Round  19, Train loss: 0.269, Test loss: 0.623, Test accuracy: 78.20 

Round  20, Train loss: 0.249, Test loss: 0.409, Test accuracy: 83.20 

Round  21, Train loss: 0.228, Test loss: 0.428, Test accuracy: 81.90 

Round  22, Train loss: 0.227, Test loss: 0.388, Test accuracy: 83.90 

Round  23, Train loss: 0.213, Test loss: 0.520, Test accuracy: 80.80 

Round  24, Train loss: 0.203, Test loss: 0.408, Test accuracy: 83.20 

Round  25, Train loss: 0.200, Test loss: 0.471, Test accuracy: 81.20 

Round  26, Train loss: 0.180, Test loss: 0.504, Test accuracy: 81.80 

Round  27, Train loss: 0.162, Test loss: 0.410, Test accuracy: 83.20 

Round  28, Train loss: 0.161, Test loss: 0.453, Test accuracy: 83.20 

Round  29, Train loss: 0.149, Test loss: 0.447, Test accuracy: 82.30 

Round  30, Train loss: 0.141, Test loss: 0.434, Test accuracy: 82.70 

Round  31, Train loss: 0.140, Test loss: 0.493, Test accuracy: 83.30 

Round  32, Train loss: 0.136, Test loss: 0.477, Test accuracy: 83.50 

Round  33, Train loss: 0.112, Test loss: 0.453, Test accuracy: 83.20 

Round  34, Train loss: 0.110, Test loss: 0.464, Test accuracy: 83.20 

Round  35, Train loss: 0.104, Test loss: 0.407, Test accuracy: 83.70 

Round  36, Train loss: 0.109, Test loss: 0.412, Test accuracy: 84.40 

Round  37, Train loss: 0.104, Test loss: 0.450, Test accuracy: 84.80 

Round  38, Train loss: 0.087, Test loss: 0.422, Test accuracy: 83.90 

Round  39, Train loss: 0.088, Test loss: 0.456, Test accuracy: 83.90 

Round  40, Train loss: 0.070, Test loss: 0.459, Test accuracy: 83.80 

Round  41, Train loss: 0.066, Test loss: 0.468, Test accuracy: 83.20 

Round  42, Train loss: 0.074, Test loss: 0.413, Test accuracy: 84.30 

Round  43, Train loss: 0.062, Test loss: 0.438, Test accuracy: 85.10 

Round  44, Train loss: 0.057, Test loss: 0.412, Test accuracy: 85.00 

Round  45, Train loss: 0.052, Test loss: 0.450, Test accuracy: 85.30 

Round  46, Train loss: 0.054, Test loss: 0.493, Test accuracy: 84.00 

Round  47, Train loss: 0.049, Test loss: 0.486, Test accuracy: 83.50 

Round  48, Train loss: 0.054, Test loss: 0.471, Test accuracy: 83.80 

Round  49, Train loss: 0.049, Test loss: 0.431, Test accuracy: 84.80 

Final Round, Train loss: 0.027, Test loss: 0.467, Test accuracy: 84.90 

Average accuracy final 10 rounds: 84.28 

516.9685616493225
[3.9970054626464844, 5.9145567417144775, 7.854459285736084, 9.793606519699097, 11.885847568511963, 13.869798183441162, 15.827869892120361, 17.760377168655396, 19.697839975357056, 21.633870124816895, 23.567489624023438, 25.514451503753662, 27.382946252822876, 29.27996063232422, 31.3073992729187, 33.2082314491272, 35.09612417221069, 36.98363757133484, 38.913546562194824, 40.81146049499512, 42.646634340286255, 44.7420072555542, 46.66438126564026, 48.73856735229492, 50.68185877799988, 52.649638414382935, 54.781681537628174, 56.71008038520813, 58.611676931381226, 60.628297090530396, 62.571155071258545, 64.5217125415802, 66.46832752227783, 68.45796871185303, 70.28479719161987, 72.21185874938965, 74.29885220527649, 76.15914344787598, 78.01636123657227, 79.85547304153442, 81.66669273376465, 83.53182315826416, 85.4578812122345, 87.54510998725891, 89.63391900062561, 91.58127117156982, 93.4526915550232, 95.48516654968262, 97.50985407829285, 99.43289160728455, 101.2391459941864]
[50.0, 57.5, 60.8, 62.9, 63.9, 70.8, 68.9, 68.8, 68.6, 78.5, 71.3, 77.0, 75.9, 69.5, 79.7, 81.9, 78.5, 76.7, 78.1, 78.2, 83.2, 81.9, 83.9, 80.8, 83.2, 81.2, 81.8, 83.2, 83.2, 82.3, 82.7, 83.3, 83.5, 83.2, 83.2, 83.7, 84.4, 84.8, 83.9, 83.9, 83.8, 83.2, 84.3, 85.1, 85.0, 85.3, 84.0, 83.5, 83.8, 84.8, 84.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.806, Test loss: 0.949, Test accuracy: 50.20
Round   1, Train loss: 0.679, Test loss: 0.797, Test accuracy: 61.90
Round   2, Train loss: 0.647, Test loss: 0.967, Test accuracy: 54.20
Round   3, Train loss: 0.625, Test loss: 0.962, Test accuracy: 64.20
Round   4, Train loss: 0.568, Test loss: 0.760, Test accuracy: 66.50
Round   5, Train loss: 0.540, Test loss: 0.529, Test accuracy: 73.50
Round   6, Train loss: 0.505, Test loss: 0.666, Test accuracy: 71.10
Round   7, Train loss: 0.485, Test loss: 0.623, Test accuracy: 70.40
Round   8, Train loss: 0.479, Test loss: 0.722, Test accuracy: 68.80
Round   9, Train loss: 0.439, Test loss: 0.666, Test accuracy: 75.00
Round  10, Train loss: 0.430, Test loss: 0.580, Test accuracy: 77.00
Round  11, Train loss: 0.397, Test loss: 0.535, Test accuracy: 74.30
Round  12, Train loss: 0.377, Test loss: 0.685, Test accuracy: 72.80
Round  13, Train loss: 0.375, Test loss: 0.417, Test accuracy: 81.30
Round  14, Train loss: 0.341, Test loss: 0.481, Test accuracy: 78.90
Round  15, Train loss: 0.332, Test loss: 0.720, Test accuracy: 73.60
Round  16, Train loss: 0.321, Test loss: 0.586, Test accuracy: 76.00
Round  17, Train loss: 0.291, Test loss: 0.514, Test accuracy: 79.10
Round  18, Train loss: 0.286, Test loss: 0.589, Test accuracy: 77.00
Round  19, Train loss: 0.272, Test loss: 0.503, Test accuracy: 80.10
Round  20, Train loss: 0.277, Test loss: 0.468, Test accuracy: 81.50
Round  21, Train loss: 0.233, Test loss: 0.469, Test accuracy: 80.80
Round  22, Train loss: 0.221, Test loss: 0.455, Test accuracy: 81.00
Round  23, Train loss: 0.220, Test loss: 0.521, Test accuracy: 80.70
Round  24, Train loss: 0.194, Test loss: 0.435, Test accuracy: 82.70
Round  25, Train loss: 0.210, Test loss: 0.437, Test accuracy: 83.00
Round  26, Train loss: 0.176, Test loss: 0.428, Test accuracy: 83.10
Round  27, Train loss: 0.186, Test loss: 0.415, Test accuracy: 83.50
Round  28, Train loss: 0.174, Test loss: 0.394, Test accuracy: 84.30
Round  29, Train loss: 0.148, Test loss: 0.418, Test accuracy: 83.40
Round  30, Train loss: 0.145, Test loss: 0.483, Test accuracy: 82.00
Round  31, Train loss: 0.133, Test loss: 0.400, Test accuracy: 84.40
Round  32, Train loss: 0.130, Test loss: 0.403, Test accuracy: 84.20
Round  33, Train loss: 0.125, Test loss: 0.391, Test accuracy: 86.20
Round  34, Train loss: 0.117, Test loss: 0.412, Test accuracy: 84.40
Round  35, Train loss: 0.108, Test loss: 0.448, Test accuracy: 83.40
Round  36, Train loss: 0.099, Test loss: 0.410, Test accuracy: 85.00
Round  37, Train loss: 0.083, Test loss: 0.457, Test accuracy: 83.10
Round  38, Train loss: 0.095, Test loss: 0.438, Test accuracy: 83.90
Round  39, Train loss: 0.101, Test loss: 0.470, Test accuracy: 83.20
Round  40, Train loss: 0.097, Test loss: 0.415, Test accuracy: 85.20
Round  41, Train loss: 0.070, Test loss: 0.417, Test accuracy: 85.00
Round  42, Train loss: 0.073, Test loss: 0.457, Test accuracy: 84.50
Round  43, Train loss: 0.067, Test loss: 0.510, Test accuracy: 83.30
Round  44, Train loss: 0.053, Test loss: 0.429, Test accuracy: 85.70
Round  45, Train loss: 0.072, Test loss: 0.426, Test accuracy: 85.20
Round  46, Train loss: 0.060, Test loss: 0.414, Test accuracy: 85.40
Round  47, Train loss: 0.045, Test loss: 0.424, Test accuracy: 84.90
Round  48, Train loss: 0.045, Test loss: 0.428, Test accuracy: 85.40
Round  49, Train loss: 0.045, Test loss: 0.447, Test accuracy: 85.20
Final Round, Train loss: 0.030, Test loss: 0.464, Test accuracy: 84.70
Average accuracy final 10 rounds: 84.98
572.5781710147858
[4.174558401107788, 6.39268684387207, 8.506221771240234, 10.6601243019104, 12.928495645523071, 15.089083671569824, 17.24979281425476, 19.506218910217285, 21.724543571472168, 23.919888734817505, 26.10847783088684, 28.32936692237854, 30.51901388168335, 32.705233573913574, 34.97616267204285, 37.21312355995178, 39.41262149810791, 41.432776927948, 43.58155298233032, 45.68069839477539, 47.866782903671265, 49.99918603897095, 52.11230158805847, 54.354305267333984, 56.53372573852539, 58.66274666786194, 60.73782539367676, 63.04541301727295, 65.3860375881195, 67.56435513496399, 69.77037286758423, 71.88672995567322, 74.2060284614563, 76.43582773208618, 78.64535284042358, 80.73684120178223, 82.93286156654358, 85.15095829963684, 87.60299682617188, 89.7408058643341, 91.88274145126343, 93.87357497215271, 96.02063059806824, 98.18702387809753, 100.39156460762024, 102.49844813346863, 104.81864762306213, 107.01619100570679, 109.38655519485474, 111.70177555084229, 113.75937032699585]
[50.2, 61.9, 54.2, 64.2, 66.5, 73.5, 71.1, 70.4, 68.8, 75.0, 77.0, 74.3, 72.8, 81.3, 78.9, 73.6, 76.0, 79.1, 77.0, 80.1, 81.5, 80.8, 81.0, 80.7, 82.7, 83.0, 83.1, 83.5, 84.3, 83.4, 82.0, 84.4, 84.2, 86.2, 84.4, 83.4, 85.0, 83.1, 83.9, 83.2, 85.2, 85.0, 84.5, 83.3, 85.7, 85.2, 85.4, 84.9, 85.4, 85.2, 84.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.051, Train accuracy: 98.500, Test loss: 0.283, Test accuracy: 91.50 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 0.339, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.245, Test accuracy: 91.00 

Round   0, Train loss: 0.032, Test loss: 0.245, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.033, Train accuracy: 99.500, Test loss: 0.274, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.073, Train accuracy: 97.500, Test loss: 0.396, Test accuracy: 89.50 

Round   1, Train loss: 0.073, Test loss: 0.396, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.500, Test loss: 0.372, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.106, Train accuracy: 96.500, Test loss: 0.354, Test accuracy: 89.50 

Round   2, Train loss: 0.106, Test loss: 0.354, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.248, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.235, Test accuracy: 93.50 

Round   3, Train loss: 0.007, Test loss: 0.235, Test accuracy: 93.50 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.229, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.059, Train accuracy: 97.500, Test loss: 0.430, Test accuracy: 88.00 

Round   4, Train loss: 0.059, Test loss: 0.430, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.253, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.058, Train accuracy: 98.000, Test loss: 0.483, Test accuracy: 87.50 

Round   5, Train loss: 0.058, Test loss: 0.483, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.311, Test accuracy: 91.50 

Round   6, Train loss: 0.010, Test loss: 0.311, Test accuracy: 91.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 0.332, Test accuracy: 90.00 

Round   7, Train loss: 0.025, Test loss: 0.332, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.358, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.035, Train accuracy: 98.500, Test loss: 0.429, Test accuracy: 87.00 

Round   8, Train loss: 0.035, Test loss: 0.429, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.047, Train accuracy: 99.000, Test loss: 0.392, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 0.378, Test accuracy: 87.50 

Round   9, Train loss: 0.024, Test loss: 0.378, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.379, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.287, Test accuracy: 91.50 

Round  10, Train loss: 0.007, Test loss: 0.287, Test accuracy: 91.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.328, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.283, Test accuracy: 93.50 

Round  11, Train loss: 0.000, Test loss: 0.283, Test accuracy: 93.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.151, Train accuracy: 96.000, Test loss: 0.328, Test accuracy: 93.00 

Round  12, Train loss: 0.151, Test loss: 0.328, Test accuracy: 93.00 

        train local model (freeze embeding):client   0,  Train loss: 0.064, Train accuracy: 98.500, Test loss: 0.318, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.308, Test accuracy: 93.00 

Round  13, Train loss: 0.003, Test loss: 0.308, Test accuracy: 93.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.311, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.254, Test accuracy: 93.00 

Round  14, Train loss: 0.004, Test loss: 0.254, Test accuracy: 93.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.266, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 92.00 

Round  15, Train loss: 0.001, Test loss: 0.355, Test accuracy: 92.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.338, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.320, Test accuracy: 94.00 

Round  16, Train loss: 0.000, Test loss: 0.320, Test accuracy: 94.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 94.00 

Round  17, Train loss: 0.000, Test loss: 0.350, Test accuracy: 94.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 91.50 

Round  18, Train loss: 0.000, Test loss: 0.395, Test accuracy: 91.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.390, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 93.50 

Round  19, Train loss: 0.002, Test loss: 0.336, Test accuracy: 93.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.353, Test accuracy: 92.00 

Final Round, Train loss: 0.002, Test loss: 0.386, Test accuracy: 90.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.396, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.222, Train accuracy: 91.500, Test loss: 0.342, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.153, Train accuracy: 93.500, Test loss: 0.503, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.054, Train accuracy: 97.000, Test loss: 0.412, Test accuracy: 86.50 

Round   0, Train loss: 0.029, Test loss: 0.429, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.116, Train accuracy: 94.000, Test loss: 0.302, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.340, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.178, Train accuracy: 92.000, Test loss: 0.481, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.066, Train accuracy: 98.500, Test loss: 0.276, Test accuracy: 90.50 

Round   1, Train loss: 0.036, Test loss: 0.460, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.100, Train accuracy: 96.000, Test loss: 0.313, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.065, Train accuracy: 97.500, Test loss: 0.402, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.142, Train accuracy: 92.500, Test loss: 0.403, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.093, Train accuracy: 95.500, Test loss: 0.330, Test accuracy: 89.50 

Round   2, Train loss: 0.079, Test loss: 0.482, Test accuracy: 82.75 

        train local model (freeze embeding):client   0,  Train loss: 0.153, Train accuracy: 94.000, Test loss: 0.374, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.039, Train accuracy: 99.000, Test loss: 0.292, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.315, Test accuracy: 88.00 

Round   3, Train loss: 0.006, Test loss: 0.406, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 0.246, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 0.325, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.115, Train accuracy: 95.500, Test loss: 0.357, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.040, Train accuracy: 98.000, Test loss: 0.446, Test accuracy: 86.50 

Round   4, Train loss: 0.032, Test loss: 0.423, Test accuracy: 86.25 

        train local model (freeze embeding):client   0,  Train loss: 0.140, Train accuracy: 94.500, Test loss: 0.356, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.254, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.050, Train accuracy: 98.500, Test loss: 0.302, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.048, Train accuracy: 99.000, Test loss: 0.492, Test accuracy: 85.50 

Round   5, Train loss: 0.035, Test loss: 0.386, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.104, Train accuracy: 95.500, Test loss: 0.350, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.333, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.237, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.253, Test accuracy: 90.00 

Round   6, Train loss: 0.008, Test loss: 0.418, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.076, Train accuracy: 97.000, Test loss: 0.340, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.037, Train accuracy: 99.500, Test loss: 0.336, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.308, Train accuracy: 89.500, Test loss: 0.571, Test accuracy: 78.50 

Round   7, Train loss: 0.155, Test loss: 0.398, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.103, Train accuracy: 96.000, Test loss: 0.355, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 0.479, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.290, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.270, Test accuracy: 91.50 

Round   8, Train loss: 0.029, Test loss: 0.473, Test accuracy: 83.25 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.332, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.332, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.067, Train accuracy: 97.500, Test loss: 0.299, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 90.00 

Round   9, Train loss: 0.004, Test loss: 0.445, Test accuracy: 85.25 

        train local model (freeze embeding):client   0,  Train loss: 0.058, Train accuracy: 98.000, Test loss: 0.340, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.269, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.401, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.133, Train accuracy: 94.000, Test loss: 0.445, Test accuracy: 90.00 

Round  10, Train loss: 0.068, Test loss: 0.362, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.105, Train accuracy: 95.500, Test loss: 0.338, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.035, Train accuracy: 99.500, Test loss: 0.318, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.077, Train accuracy: 97.500, Test loss: 0.445, Test accuracy: 84.50 

Round  11, Train loss: 0.040, Test loss: 0.370, Test accuracy: 85.75 

        train local model (freeze embeding):client   0,  Train loss: 0.039, Train accuracy: 98.500, Test loss: 0.322, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.310, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.265, Train accuracy: 90.000, Test loss: 0.695, Test accuracy: 78.00 

Round  12, Train loss: 0.133, Test loss: 0.568, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.075, Train accuracy: 98.000, Test loss: 0.322, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.000, Test loss: 0.279, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 88.50 

Round  13, Train loss: 0.003, Test loss: 0.341, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.289, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.300, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.282, Test accuracy: 91.00 

Round  14, Train loss: 0.001, Test loss: 0.319, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.287, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.328, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.299, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.320, Test accuracy: 90.00 

Round  15, Train loss: 0.003, Test loss: 0.338, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.305, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.331, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.098, Train accuracy: 96.000, Test loss: 0.540, Test accuracy: 85.50 

Round  16, Train loss: 0.049, Test loss: 0.517, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.114, Train accuracy: 95.000, Test loss: 0.377, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.051, Train accuracy: 98.500, Test loss: 0.549, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.246, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 92.00 

Round  17, Train loss: 0.026, Test loss: 0.497, Test accuracy: 85.75 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.371, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.322, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 0.331, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.418, Test accuracy: 88.50 

Round  18, Train loss: 0.001, Test loss: 0.417, Test accuracy: 87.25 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.363, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.394, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.320, Test accuracy: 90.00 

Round  19, Train loss: 0.001, Test loss: 0.348, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 88.50 

Final Round, Train loss: 0.006, Test loss: 0.375, Test accuracy: 87.25 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.136, Train accuracy: 92.500, Test loss: 0.848, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.116, Train accuracy: 95.000, Test loss: 0.320, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.388, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.123, Train accuracy: 94.500, Test loss: 0.619, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.500, Test loss: 0.523, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.182, Train accuracy: 91.500, Test loss: 0.738, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.432, Train accuracy: 86.000, Test loss: 1.141, Test accuracy: 67.50 

Round   0, Train loss: 0.157, Test loss: 0.439, Test accuracy: 81.67 

        train local model (freeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.500, Test loss: 0.282, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.063, Train accuracy: 98.000, Test loss: 0.453, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.000, Test loss: 0.321, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.218, Train accuracy: 93.000, Test loss: 0.729, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.213, Train accuracy: 90.500, Test loss: 1.453, Test accuracy: 63.50 

Round   1, Train loss: 0.076, Test loss: 0.475, Test accuracy: 81.67 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 100.000, Test loss: 0.286, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.351, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.164, Train accuracy: 93.000, Test loss: 0.813, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.128, Train accuracy: 96.000, Test loss: 0.806, Test accuracy: 72.00 

Round   2, Train loss: 0.044, Test loss: 0.479, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.302, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.053, Train accuracy: 99.000, Test loss: 0.422, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.551, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.115, Train accuracy: 96.000, Test loss: 0.831, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 2.487, Train accuracy: 64.000, Test loss: 4.786, Test accuracy: 54.00 

Round   3, Train loss: 0.836, Test loss: 0.709, Test accuracy: 78.33 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.339, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.307, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.030, Train accuracy: 98.500, Test loss: 0.372, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 99.000, Test loss: 0.593, Test accuracy: 81.50 

        train local model (freeze embeding):client   2,  Train loss: 0.098, Train accuracy: 97.000, Test loss: 0.794, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.040, Train accuracy: 99.000, Test loss: 0.877, Test accuracy: 73.50 

Round   4, Train loss: 0.028, Test loss: 0.479, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.314, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.346, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.024, Train accuracy: 100.000, Test loss: 0.372, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.720, Test accuracy: 84.50 

        train local model (freeze embeding):client   2,  Train loss: 0.078, Train accuracy: 97.500, Test loss: 0.801, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.048, Train accuracy: 99.000, Test loss: 0.776, Test accuracy: 76.50 

Round   5, Train loss: 0.028, Test loss: 0.508, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.360, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.038, Train accuracy: 99.500, Test loss: 0.362, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.401, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.055, Train accuracy: 99.000, Test loss: 0.769, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.085, Train accuracy: 97.000, Test loss: 1.005, Test accuracy: 74.00 

Round   6, Train loss: 0.034, Test loss: 0.492, Test accuracy: 83.17 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.263, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.502, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.053, Train accuracy: 98.000, Test loss: 0.357, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.034, Train accuracy: 99.500, Test loss: 0.773, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.088, Train accuracy: 97.500, Test loss: 0.830, Test accuracy: 72.50 

Round   7, Train loss: 0.033, Test loss: 0.484, Test accuracy: 83.33 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.039, Train accuracy: 98.500, Test loss: 0.343, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.808, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.167, Train accuracy: 93.500, Test loss: 1.118, Test accuracy: 71.00 

Round   8, Train loss: 0.058, Test loss: 0.526, Test accuracy: 81.67 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.309, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.379, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.394, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.052, Train accuracy: 98.500, Test loss: 0.837, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.179, Train accuracy: 93.000, Test loss: 1.023, Test accuracy: 68.00 

Round   9, Train loss: 0.063, Test loss: 0.464, Test accuracy: 82.83 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.296, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.385, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.000, Test loss: 0.356, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 0.810, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.093, Train accuracy: 96.000, Test loss: 0.903, Test accuracy: 72.00 

Round  10, Train loss: 0.032, Test loss: 0.497, Test accuracy: 81.83 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.231, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 0.433, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.365, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.052, Train accuracy: 98.000, Test loss: 0.775, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.209, Train accuracy: 90.000, Test loss: 1.395, Test accuracy: 74.50 

Round  11, Train loss: 0.070, Test loss: 0.503, Test accuracy: 82.67 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.336, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.353, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.500, Test loss: 0.411, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.031, Train accuracy: 99.500, Test loss: 0.813, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.060, Train accuracy: 98.000, Test loss: 0.835, Test accuracy: 77.00 

Round  12, Train loss: 0.032, Test loss: 0.434, Test accuracy: 83.83 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.281, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.309, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.319, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.346, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.740, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.068, Train accuracy: 97.500, Test loss: 1.625, Test accuracy: 71.00 

Round  13, Train loss: 0.024, Test loss: 0.543, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.253, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.462, Train accuracy: 88.500, Test loss: 1.528, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.323, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 0.916, Test accuracy: 69.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.487, Train accuracy: 83.500, Test loss: 2.239, Test accuracy: 66.00 

Round  14, Train loss: 0.317, Test loss: 0.672, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.328, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.342, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.333, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.289, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.975, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.756, Test accuracy: 75.00 

Round  15, Train loss: 0.019, Test loss: 0.502, Test accuracy: 82.83 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.500, Test loss: 0.257, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.302, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 77.50 

Round  16, Train loss: 0.003, Test loss: 0.517, Test accuracy: 83.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.206, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.355, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.267, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.928, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.136, Train accuracy: 97.000, Test loss: 0.998, Test accuracy: 74.00 

Round  17, Train loss: 0.048, Test loss: 0.531, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.798, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.337, Train accuracy: 90.500, Test loss: 1.113, Test accuracy: 65.00 

Round  18, Train loss: 0.113, Test loss: 0.492, Test accuracy: 83.83 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.250, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.509, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.451, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 0.935, Test accuracy: 69.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 1.000, Test accuracy: 76.00 

Round  19, Train loss: 0.011, Test loss: 0.529, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.248, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.248, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.365, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 71.00 

Final Round, Train loss: 0.005, Test loss: 0.530, Test accuracy: 82.17 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.121, Train accuracy: 96.000, Test loss: 1.453, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.126, Train accuracy: 94.500, Test loss: 0.379, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.146, Train accuracy: 96.000, Test loss: 0.842, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.078, Train accuracy: 98.000, Test loss: 0.379, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.057, Train accuracy: 98.000, Test loss: 0.345, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.202, Train accuracy: 92.000, Test loss: 1.103, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.985, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.161, Train accuracy: 93.500, Test loss: 0.976, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.047, Train accuracy: 98.000, Test loss: 1.176, Test accuracy: 65.50 

Round   0, Train loss: 0.065, Test loss: 0.733, Test accuracy: 78.38 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.375, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 0.274, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.301, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.044, Train accuracy: 98.000, Test loss: 0.886, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.812, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.292, Train accuracy: 88.500, Test loss: 1.091, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.155, Train accuracy: 93.500, Test loss: 1.132, Test accuracy: 73.00 

Round   1, Train loss: 0.046, Test loss: 0.635, Test accuracy: 78.75 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.362, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.227, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.273, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.341, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.043, Train accuracy: 98.000, Test loss: 0.844, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.031, Train accuracy: 98.000, Test loss: 0.955, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.148, Train accuracy: 95.500, Test loss: 1.070, Test accuracy: 63.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.186, Train accuracy: 92.500, Test loss: 1.213, Test accuracy: 68.50 

Round   2, Train loss: 0.057, Test loss: 0.607, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.277, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.222, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.068, Train accuracy: 97.000, Test loss: 0.768, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.074, Test accuracy: 74.50 

        train local model (freeze embeding):client   3,  Train loss: 0.189, Train accuracy: 92.000, Test loss: 1.002, Test accuracy: 67.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.193, Train accuracy: 94.000, Test loss: 1.344, Test accuracy: 69.00 

Round   3, Train loss: 0.052, Test loss: 0.630, Test accuracy: 80.62 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.418, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.218, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.307, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.046, Train accuracy: 98.000, Test loss: 1.395, Test accuracy: 71.50 

        train local model (freeze embeding):client   3,  Train loss: 0.218, Train accuracy: 91.500, Test loss: 1.080, Test accuracy: 66.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.107, Train accuracy: 97.000, Test loss: 1.222, Test accuracy: 72.50 

Round   4, Train loss: 0.039, Test loss: 0.679, Test accuracy: 79.38 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.257, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.279, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.281, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.956, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.773, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.103, Train accuracy: 95.500, Test loss: 1.131, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.156, Train accuracy: 93.500, Test loss: 1.145, Test accuracy: 71.50 

Round   5, Train loss: 0.041, Test loss: 0.614, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.384, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.410, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.472, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.790, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.087, Train accuracy: 96.000, Test loss: 1.091, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.069, Train accuracy: 97.500, Test loss: 0.995, Test accuracy: 72.00 

Round   6, Train loss: 0.020, Test loss: 0.632, Test accuracy: 79.75 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.298, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.124, Train accuracy: 93.000, Test loss: 0.545, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.043, Train accuracy: 98.000, Test loss: 1.307, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.070, Train accuracy: 98.000, Test loss: 1.121, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.143, Train accuracy: 95.500, Test loss: 1.366, Test accuracy: 70.50 

Round   7, Train loss: 0.078, Test loss: 0.643, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.329, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.291, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.815, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.126, Train accuracy: 96.000, Test loss: 1.195, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.089, Train accuracy: 98.000, Test loss: 1.186, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.042, Train accuracy: 99.000, Test loss: 1.265, Test accuracy: 70.50 

Round   8, Train loss: 0.043, Test loss: 0.666, Test accuracy: 78.88 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.410, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.350, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 0.784, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.879, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.067, Train accuracy: 99.000, Test loss: 1.065, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.105, Train accuracy: 96.500, Test loss: 1.364, Test accuracy: 72.00 

Round   9, Train loss: 0.027, Test loss: 0.723, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.412, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.416, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.430, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.800, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.000, Test loss: 1.074, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.066, Train accuracy: 97.000, Test loss: 1.180, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.119, Train accuracy: 97.000, Test loss: 1.196, Test accuracy: 73.50 

Round  10, Train loss: 0.033, Test loss: 0.648, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.296, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.377, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.313, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.968, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.013, Test accuracy: 75.50 

        train local model (freeze embeding):client   3,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 1.094, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.174, Train accuracy: 93.000, Test loss: 1.638, Test accuracy: 68.50 

Round  11, Train loss: 0.045, Test loss: 0.686, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.294, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.266, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.846, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.047, Train accuracy: 98.500, Test loss: 1.105, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.215, Test accuracy: 73.00 

Round  12, Train loss: 0.008, Test loss: 0.695, Test accuracy: 80.62 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.250, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.310, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 0.571, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.000, Test loss: 0.839, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.144, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.052, Train accuracy: 98.000, Test loss: 1.086, Test accuracy: 73.50 

Round  13, Train loss: 0.024, Test loss: 0.654, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.370, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.288, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.803, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.139, Train accuracy: 95.000, Test loss: 1.677, Test accuracy: 68.00 

        train local model (freeze embeding):client   3,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.401, Train accuracy: 89.000, Test loss: 2.460, Test accuracy: 65.50 

Round  14, Train loss: 0.135, Test loss: 0.697, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.000, Test loss: 0.438, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.282, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.348, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.224, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.891, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.183, Train accuracy: 94.000, Test loss: 1.218, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 1.363, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.110, Train accuracy: 94.000, Test loss: 1.414, Test accuracy: 68.00 

Round  15, Train loss: 0.074, Test loss: 0.731, Test accuracy: 81.12 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.371, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.323, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.253, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.287, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.859, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 1.322, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.150, Train accuracy: 94.500, Test loss: 1.533, Test accuracy: 72.00 

Round  16, Train loss: 0.039, Test loss: 0.707, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.360, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.221, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.331, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.789, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.159, Train accuracy: 93.500, Test loss: 1.496, Test accuracy: 70.50 

        train local model (freeze embeding):client   3,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 66.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.570, Train accuracy: 77.500, Test loss: 2.545, Test accuracy: 60.00 

Round  17, Train loss: 0.183, Test loss: 0.723, Test accuracy: 80.38 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.410, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.482, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.197, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.271, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.842, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 1.170, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 70.50 

Round  18, Train loss: 0.001, Test loss: 0.666, Test accuracy: 82.12 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.371, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.661, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.276, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.938, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.027, Train accuracy: 98.500, Test loss: 1.151, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.248, Test accuracy: 66.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 1.338, Test accuracy: 71.50 

Round  19, Train loss: 0.013, Test loss: 0.668, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.390, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.215, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.037, Train accuracy: 98.500, Test loss: 1.153, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 1.205, Test accuracy: 65.00 

Final Round, Train loss: 0.010, Test loss: 0.624, Test accuracy: 81.62 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.709, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.067, Train accuracy: 97.500, Test loss: 0.481, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.174, Train accuracy: 94.500, Test loss: 0.276, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.294, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.042, Train accuracy: 98.500, Test loss: 0.859, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.031, Train accuracy: 98.500, Test loss: 1.111, Test accuracy: 72.50 

        train local model (freeze embeding):client   3,  Train loss: 0.353, Train accuracy: 85.000, Test loss: 0.893, Test accuracy: 66.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.343, Train accuracy: 91.000, Test loss: 1.609, Test accuracy: 66.00 

        train local model (freeze embeding):client   4,  Train loss: 0.057, Train accuracy: 98.000, Test loss: 0.783, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.681, Test accuracy: 85.50 

Round   0, Train loss: 0.080, Test loss: 0.644, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.420, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.508, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.041, Train accuracy: 98.500, Test loss: 0.259, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.297, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.874, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.927, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.123, Train accuracy: 97.000, Test loss: 0.977, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.235, Test accuracy: 72.00 

        train local model (freeze embeding):client   4,  Train loss: 0.133, Train accuracy: 95.000, Test loss: 0.848, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.756, Test accuracy: 83.00 

Round   1, Train loss: 0.005, Test loss: 0.632, Test accuracy: 80.40 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.337, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.264, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.462, Train accuracy: 85.000, Test loss: 0.688, Test accuracy: 74.50 

        train local model (freeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.853, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.970, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.054, Train accuracy: 99.500, Test loss: 1.030, Test accuracy: 67.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 1.491, Test accuracy: 69.50 

        train local model (freeze embeding):client   4,  Train loss: 0.139, Train accuracy: 95.500, Test loss: 0.554, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.643, Test accuracy: 85.00 

Round   2, Train loss: 0.106, Test loss: 0.600, Test accuracy: 81.30 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 0.358, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.235, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.278, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.223, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.685, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 1.032, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.083, Train accuracy: 96.500, Test loss: 1.547, Test accuracy: 71.00 

        train local model (freeze embeding):client   4,  Train loss: 0.178, Train accuracy: 92.000, Test loss: 0.407, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.122, Train accuracy: 94.000, Test loss: 1.331, Test accuracy: 82.50 

Round   3, Train loss: 0.043, Test loss: 0.669, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.480, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.292, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.204, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.732, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 1.118, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.068, Train accuracy: 98.000, Test loss: 1.650, Test accuracy: 72.00 

        train local model (freeze embeding):client   4,  Train loss: 0.076, Train accuracy: 98.500, Test loss: 0.432, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.560, Test accuracy: 87.50 

Round   4, Train loss: 0.015, Test loss: 0.639, Test accuracy: 82.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.367, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.173, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.294, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.363, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.756, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 98.500, Test loss: 0.956, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.022, Train accuracy: 100.000, Test loss: 1.169, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.040, Train accuracy: 98.500, Test loss: 1.294, Test accuracy: 76.00 

        train local model (freeze embeding):client   4,  Train loss: 0.136, Train accuracy: 95.000, Test loss: 0.440, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 0.707, Test accuracy: 85.50 

Round   5, Train loss: 0.022, Test loss: 0.640, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.386, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.289, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.435, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.713, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 1.247, Test accuracy: 69.00 

        train local model (freeze embeding):client   3,  Train loss: 0.038, Train accuracy: 98.000, Test loss: 1.167, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.394, Test accuracy: 75.00 

        train local model (freeze embeding):client   4,  Train loss: 0.120, Train accuracy: 95.500, Test loss: 0.536, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.377, Train accuracy: 84.500, Test loss: 0.799, Test accuracy: 78.00 

Round   6, Train loss: 0.085, Test loss: 0.621, Test accuracy: 81.90 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.381, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.302, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.333, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.372, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.745, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.771, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 1.195, Test accuracy: 65.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.427, Test accuracy: 71.50 

        train local model (freeze embeding):client   4,  Train loss: 0.068, Train accuracy: 97.500, Test loss: 0.424, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.557, Test accuracy: 83.50 

Round   7, Train loss: 0.011, Test loss: 0.649, Test accuracy: 82.70 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.331, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.429, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.741, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.051, Train accuracy: 98.000, Test loss: 1.292, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.308, Train accuracy: 91.000, Test loss: 1.820, Test accuracy: 65.50 

        train local model (freeze embeding):client   4,  Train loss: 0.082, Train accuracy: 96.500, Test loss: 0.582, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 80.00 

Round   8, Train loss: 0.065, Test loss: 0.691, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.273, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.030, Train accuracy: 98.500, Test loss: 0.490, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.266, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.508, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.769, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 75.50 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.093, Test accuracy: 67.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.099, Train accuracy: 96.500, Test loss: 1.562, Test accuracy: 72.00 

        train local model (freeze embeding):client   4,  Train loss: 0.059, Train accuracy: 97.500, Test loss: 0.479, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.858, Test accuracy: 83.50 

Round   9, Train loss: 0.035, Test loss: 0.583, Test accuracy: 82.80 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.000, Test loss: 0.370, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.265, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.766, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 1.118, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.037, Train accuracy: 98.500, Test loss: 1.447, Test accuracy: 72.00 

        train local model (freeze embeding):client   4,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 0.463, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.716, Test accuracy: 83.00 

Round  10, Train loss: 0.009, Test loss: 0.653, Test accuracy: 83.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.252, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.270, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.263, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 1.111, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.045, Train accuracy: 98.500, Test loss: 1.432, Test accuracy: 74.00 

        train local model (freeze embeding):client   4,  Train loss: 0.033, Train accuracy: 100.000, Test loss: 0.525, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 0.827, Test accuracy: 85.50 

Round  11, Train loss: 0.013, Test loss: 0.657, Test accuracy: 83.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.278, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.255, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.296, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.889, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.731, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.185, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.074, Train accuracy: 96.000, Test loss: 1.473, Test accuracy: 72.50 

        train local model (freeze embeding):client   4,  Train loss: 0.052, Train accuracy: 98.500, Test loss: 0.473, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.085, Train accuracy: 96.500, Test loss: 0.998, Test accuracy: 82.00 

Round  12, Train loss: 0.034, Test loss: 0.623, Test accuracy: 82.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.302, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.307, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.756, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 1.140, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 1.151, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.372, Test accuracy: 71.50 

        train local model (freeze embeding):client   4,  Train loss: 0.041, Train accuracy: 98.000, Test loss: 0.593, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.034, Train accuracy: 99.500, Test loss: 0.917, Test accuracy: 80.00 

Round  13, Train loss: 0.010, Test loss: 0.661, Test accuracy: 82.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.302, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.285, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.333, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.735, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.938, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.276, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.432, Test accuracy: 72.00 

        train local model (freeze embeding):client   4,  Train loss: 0.035, Train accuracy: 98.500, Test loss: 0.506, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 87.00 

Round  14, Train loss: 0.003, Test loss: 0.625, Test accuracy: 82.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.271, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.247, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.276, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.243, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.788, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.987, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.209, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.273, Test accuracy: 70.50 

        train local model (freeze embeding):client   4,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.480, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.622, Test accuracy: 86.50 

Round  15, Train loss: 0.001, Test loss: 0.640, Test accuracy: 83.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.288, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.284, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.370, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.800, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.932, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.234, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.361, Test accuracy: 73.50 

        train local model (freeze embeding):client   4,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.544, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.540, Test accuracy: 87.50 

Round  16, Train loss: 0.001, Test loss: 0.653, Test accuracy: 83.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.281, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.279, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.254, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.473, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.155, Train accuracy: 93.000, Test loss: 1.538, Test accuracy: 68.50 

        train local model (freeze embeding):client   4,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.571, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.688, Test accuracy: 88.00 

Round  17, Train loss: 0.034, Test loss: 0.667, Test accuracy: 83.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.320, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.260, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.221, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.790, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.416, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.630, Test accuracy: 72.50 

        train local model (freeze embeding):client   4,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 0.482, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 0.645, Test accuracy: 87.50 

Round  18, Train loss: 0.007, Test loss: 0.696, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.279, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.305, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.271, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.830, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.359, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.134, Train accuracy: 96.000, Test loss: 1.534, Test accuracy: 71.00 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.523, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.690, Test accuracy: 84.50 

Round  19, Train loss: 0.034, Test loss: 0.640, Test accuracy: 83.20 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.350, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.303, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.262, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.237, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.763, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.790, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.231, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.225, Test accuracy: 71.00 

        train local model (freeze embeding):client   4,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.482, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 85.50 

Final Round, Train loss: 0.007, Test loss: 0.622, Test accuracy: 83.30 

Average accuracy final 10 rounds: 426.38833333333326 

1340.2438650131226
[3.993076801300049, 7.789402961730957, 11.68578052520752, 15.600976705551147, 19.522536993026733, 23.413858652114868, 27.395259618759155, 31.375884532928467, 35.231900453567505, 39.10652709007263, 43.081459760665894, 47.059653759002686, 50.839985847473145, 54.62584471702576, 58.47735524177551, 62.50090980529785, 66.3475923538208, 70.21400761604309, 73.98498153686523, 77.75069069862366, 79.97539162635803, 83.91951298713684, 88.03352618217468, 92.01400375366211, 95.98466372489929, 100.16507601737976, 104.1523015499115, 108.14521145820618, 112.16014790534973, 116.25986218452454, 120.45740628242493, 124.5631148815155, 128.67832970619202, 132.62599158287048, 136.56761264801025, 140.59587144851685, 144.50910258293152, 148.49206042289734, 152.52477979660034, 156.56057453155518, 160.56425881385803, 162.76891016960144, 166.76628470420837, 170.72080874443054, 174.79024934768677, 178.83991742134094, 182.78351640701294, 186.76871800422668, 190.6787974834442, 194.7016408443451, 198.7231080532074, 202.7945659160614, 206.9686233997345, 210.98397874832153, 215.05878257751465, 218.98753356933594, 222.99628281593323, 227.09225511550903, 231.05316400527954, 235.09233903884888, 239.23823285102844, 243.28687262535095, 245.5346817970276, 249.58706784248352, 253.57277584075928, 257.562593460083, 261.3658947944641, 265.3993504047394, 269.3887746334076, 273.5296428203583, 277.51792335510254, 281.5459578037262, 285.3652265071869, 289.48588705062866, 293.69878697395325, 297.68575072288513, 301.72116446495056, 305.7436511516571, 309.96092796325684, 314.06909561157227, 317.8764066696167, 321.9004011154175, 325.88937163352966, 328.3610897064209, 332.4198212623596, 336.50868487358093, 340.3454029560089, 344.54466009140015, 348.6978747844696, 352.81771540641785, 356.9183700084686, 360.92558193206787, 364.9060945510864, 368.98642086982727, 373.0466763973236, 377.1462380886078, 381.3523874282837, 385.3881995677948, 390.00486183166504, 394.1132094860077, 398.16020131111145, 402.2186167240143, 406.4744870662689, 410.70305609703064, 413.03999185562134]
[91.0, 89.5, 89.5, 93.5, 88.0, 87.5, 91.5, 90.0, 87.0, 87.5, 91.5, 93.5, 93.0, 93.0, 93.0, 92.0, 94.0, 94.0, 91.5, 93.5, 90.0, 83.5, 83.75, 82.75, 86.0, 86.25, 86.0, 84.75, 85.0, 83.25, 85.25, 87.5, 85.75, 81.75, 88.5, 88.0, 88.5, 85.0, 85.75, 87.25, 89.25, 87.25, 81.66666666666667, 81.66666666666667, 82.16666666666667, 78.33333333333333, 81.5, 83.5, 83.16666666666667, 83.33333333333333, 81.66666666666667, 82.83333333333333, 81.83333333333333, 82.66666666666667, 83.83333333333333, 82.5, 81.5, 82.83333333333333, 83.33333333333333, 83.0, 83.83333333333333, 82.5, 82.16666666666667, 78.375, 78.75, 79.5, 80.625, 79.375, 80.0, 79.75, 80.0, 78.875, 80.0, 80.25, 80.25, 80.625, 81.0, 81.5, 81.125, 80.75, 80.375, 82.125, 81.0, 81.625, 79.0, 80.4, 81.3, 80.0, 82.8, 81.5, 81.9, 82.7, 82.0, 82.8, 83.3, 83.2, 82.7, 82.2, 82.1, 83.9, 83.8, 83.4, 83.0, 83.2, 83.3]
