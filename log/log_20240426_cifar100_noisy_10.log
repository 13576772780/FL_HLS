nohup: ignoring input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.661, Test loss: 2.120, Test accuracy: 31.36
Round   0, Global train loss: 1.661, Global test loss: 2.309, Global test accuracy: 29.84
Round   1, Train loss: 1.460, Test loss: 1.618, Test accuracy: 37.50
Round   1, Global train loss: 1.460, Global test loss: 2.060, Global test accuracy: 27.38
Round   2, Train loss: 1.271, Test loss: 1.506, Test accuracy: 44.06
Round   2, Global train loss: 1.271, Global test loss: 2.153, Global test accuracy: 28.36
Round   3, Train loss: 1.225, Test loss: 1.319, Test accuracy: 46.98
Round   3, Global train loss: 1.225, Global test loss: 1.917, Global test accuracy: 28.98
Round   4, Train loss: 1.347, Test loss: 1.324, Test accuracy: 53.08
Round   4, Global train loss: 1.347, Global test loss: 2.228, Global test accuracy: 33.76
Round   5, Train loss: 1.062, Test loss: 1.326, Test accuracy: 52.16
Round   5, Global train loss: 1.062, Global test loss: 2.308, Global test accuracy: 24.04
Round   6, Train loss: 1.132, Test loss: 1.160, Test accuracy: 57.96
Round   6, Global train loss: 1.132, Global test loss: 2.207, Global test accuracy: 32.46
Round   7, Train loss: 0.984, Test loss: 1.121, Test accuracy: 58.84
Round   7, Global train loss: 0.984, Global test loss: 2.005, Global test accuracy: 33.72
Round   8, Train loss: 0.926, Test loss: 1.054, Test accuracy: 59.78
Round   8, Global train loss: 0.926, Global test loss: 1.896, Global test accuracy: 36.34
Round   9, Train loss: 0.996, Test loss: 1.031, Test accuracy: 60.44
Round   9, Global train loss: 0.996, Global test loss: 1.918, Global test accuracy: 33.32
Round  10, Train loss: 1.131, Test loss: 0.928, Test accuracy: 64.18
Round  10, Global train loss: 1.131, Global test loss: 1.959, Global test accuracy: 36.46
Round  11, Train loss: 0.922, Test loss: 0.927, Test accuracy: 64.34
Round  11, Global train loss: 0.922, Global test loss: 1.927, Global test accuracy: 32.84
Round  12, Train loss: 0.751, Test loss: 0.891, Test accuracy: 65.82
Round  12, Global train loss: 0.751, Global test loss: 1.785, Global test accuracy: 37.70
Round  13, Train loss: 0.913, Test loss: 0.865, Test accuracy: 67.40
Round  13, Global train loss: 0.913, Global test loss: 2.127, Global test accuracy: 28.14
Round  14, Train loss: 0.710, Test loss: 0.843, Test accuracy: 69.02
Round  14, Global train loss: 0.710, Global test loss: 2.140, Global test accuracy: 31.78
Round  15, Train loss: 0.827, Test loss: 0.847, Test accuracy: 69.40
Round  15, Global train loss: 0.827, Global test loss: 2.160, Global test accuracy: 30.26
Round  16, Train loss: 0.872, Test loss: 0.877, Test accuracy: 68.34
Round  16, Global train loss: 0.872, Global test loss: 2.330, Global test accuracy: 25.48
Round  17, Train loss: 0.846, Test loss: 0.860, Test accuracy: 69.38
Round  17, Global train loss: 0.846, Global test loss: 2.046, Global test accuracy: 27.60
Round  18, Train loss: 0.693, Test loss: 0.845, Test accuracy: 70.80
Round  18, Global train loss: 0.693, Global test loss: 1.924, Global test accuracy: 35.60
Round  19, Train loss: 0.664, Test loss: 0.848, Test accuracy: 70.62
Round  19, Global train loss: 0.664, Global test loss: 2.140, Global test accuracy: 29.78
Round  20, Train loss: 0.685, Test loss: 0.850, Test accuracy: 70.64
Round  20, Global train loss: 0.685, Global test loss: 2.049, Global test accuracy: 30.02
Round  21, Train loss: 0.561, Test loss: 0.847, Test accuracy: 70.62
Round  21, Global train loss: 0.561, Global test loss: 1.758, Global test accuracy: 44.68
Round  22, Train loss: 0.656, Test loss: 0.847, Test accuracy: 71.08
Round  22, Global train loss: 0.656, Global test loss: 2.094, Global test accuracy: 35.16
Round  23, Train loss: 0.557, Test loss: 0.828, Test accuracy: 71.76
Round  23, Global train loss: 0.557, Global test loss: 1.839, Global test accuracy: 42.50
Round  24, Train loss: 0.675, Test loss: 0.828, Test accuracy: 72.42
Round  24, Global train loss: 0.675, Global test loss: 2.219, Global test accuracy: 28.18
Round  25, Train loss: 0.561, Test loss: 0.830, Test accuracy: 72.20
Round  25, Global train loss: 0.561, Global test loss: 1.861, Global test accuracy: 44.42
Round  26, Train loss: 0.717, Test loss: 0.811, Test accuracy: 72.96
Round  26, Global train loss: 0.717, Global test loss: 2.063, Global test accuracy: 33.16
Round  27, Train loss: 0.480, Test loss: 0.820, Test accuracy: 72.78
Round  27, Global train loss: 0.480, Global test loss: 1.947, Global test accuracy: 38.58
Round  28, Train loss: 0.666, Test loss: 0.792, Test accuracy: 73.56
Round  28, Global train loss: 0.666, Global test loss: 2.029, Global test accuracy: 30.54
Round  29, Train loss: 0.486, Test loss: 0.839, Test accuracy: 73.10
Round  29, Global train loss: 0.486, Global test loss: 1.895, Global test accuracy: 35.50
Round  30, Train loss: 0.512, Test loss: 0.812, Test accuracy: 73.48
Round  30, Global train loss: 0.512, Global test loss: 1.910, Global test accuracy: 38.14
Round  31, Train loss: 0.422, Test loss: 0.829, Test accuracy: 73.02
Round  31, Global train loss: 0.422, Global test loss: 1.750, Global test accuracy: 39.64
Round  32, Train loss: 0.362, Test loss: 0.825, Test accuracy: 73.44
Round  32, Global train loss: 0.362, Global test loss: 2.166, Global test accuracy: 35.90
Round  33, Train loss: 0.414, Test loss: 0.851, Test accuracy: 73.36
Round  33, Global train loss: 0.414, Global test loss: 2.114, Global test accuracy: 29.90
Round  34, Train loss: 0.383, Test loss: 0.867, Test accuracy: 73.46
Round  34, Global train loss: 0.383, Global test loss: 1.818, Global test accuracy: 39.46
Round  35, Train loss: 0.366, Test loss: 0.893, Test accuracy: 73.38
Round  35, Global train loss: 0.366, Global test loss: 2.316, Global test accuracy: 34.96
Round  36, Train loss: 0.474, Test loss: 0.889, Test accuracy: 74.22
Round  36, Global train loss: 0.474, Global test loss: 2.181, Global test accuracy: 28.94
Round  37, Train loss: 0.419, Test loss: 0.904, Test accuracy: 73.42
Round  37, Global train loss: 0.419, Global test loss: 1.935, Global test accuracy: 29.92
Round  38, Train loss: 0.318, Test loss: 0.916, Test accuracy: 73.04
Round  38, Global train loss: 0.318, Global test loss: 1.777, Global test accuracy: 38.44
Round  39, Train loss: 0.353, Test loss: 0.913, Test accuracy: 74.08
Round  39, Global train loss: 0.353, Global test loss: 1.896, Global test accuracy: 37.68
Round  40, Train loss: 0.311, Test loss: 0.905, Test accuracy: 74.20
Round  40, Global train loss: 0.311, Global test loss: 1.927, Global test accuracy: 41.90
Round  41, Train loss: 0.247, Test loss: 0.904, Test accuracy: 74.16
Round  41, Global train loss: 0.247, Global test loss: 1.860, Global test accuracy: 37.00
Round  42, Train loss: 0.381, Test loss: 0.917, Test accuracy: 74.36
Round  42, Global train loss: 0.381, Global test loss: 2.281, Global test accuracy: 31.06
Round  43, Train loss: 0.454, Test loss: 0.916, Test accuracy: 74.12
Round  43, Global train loss: 0.454, Global test loss: 1.855, Global test accuracy: 37.58
Round  44, Train loss: 0.267, Test loss: 0.949, Test accuracy: 73.88
Round  44, Global train loss: 0.267, Global test loss: 2.117, Global test accuracy: 30.70
Round  45, Train loss: 0.345, Test loss: 0.968, Test accuracy: 73.62
Round  45, Global train loss: 0.345, Global test loss: 2.093, Global test accuracy: 29.90
Round  46, Train loss: 0.300, Test loss: 0.958, Test accuracy: 73.68
Round  46, Global train loss: 0.300, Global test loss: 1.889, Global test accuracy: 35.46
Round  47, Train loss: 0.301, Test loss: 0.947, Test accuracy: 73.88
Round  47, Global train loss: 0.301, Global test loss: 2.124, Global test accuracy: 31.40
Round  48, Train loss: 0.309, Test loss: 0.922, Test accuracy: 74.44
Round  48, Global train loss: 0.309, Global test loss: 1.949, Global test accuracy: 35.46
Round  49, Train loss: 0.248, Test loss: 0.891, Test accuracy: 75.34
Round  49, Global train loss: 0.248, Global test loss: 1.824, Global test accuracy: 40.10
Round  50, Train loss: 0.202, Test loss: 0.942, Test accuracy: 74.62
Round  50, Global train loss: 0.202, Global test loss: 1.808, Global test accuracy: 37.96
Round  51, Train loss: 0.275, Test loss: 0.951, Test accuracy: 74.54
Round  51, Global train loss: 0.275, Global test loss: 1.876, Global test accuracy: 34.80
Round  52, Train loss: 0.249, Test loss: 0.946, Test accuracy: 75.00
Round  52, Global train loss: 0.249, Global test loss: 2.095, Global test accuracy: 28.48
Round  53, Train loss: 0.254, Test loss: 0.960, Test accuracy: 75.06
Round  53, Global train loss: 0.254, Global test loss: 2.356, Global test accuracy: 25.40
Round  54, Train loss: 0.292, Test loss: 0.979, Test accuracy: 74.58
Round  54, Global train loss: 0.292, Global test loss: 2.512, Global test accuracy: 26.86
Round  55, Train loss: 0.281, Test loss: 0.992, Test accuracy: 75.82
Round  55, Global train loss: 0.281, Global test loss: 2.036, Global test accuracy: 37.12
Round  56, Train loss: 0.199, Test loss: 0.988, Test accuracy: 76.04
Round  56, Global train loss: 0.199, Global test loss: 1.700, Global test accuracy: 41.88
Round  57, Train loss: 0.244, Test loss: 0.997, Test accuracy: 75.82
Round  57, Global train loss: 0.244, Global test loss: 2.123, Global test accuracy: 32.52
Round  58, Train loss: 0.152, Test loss: 1.014, Test accuracy: 75.38
Round  58, Global train loss: 0.152, Global test loss: 1.850, Global test accuracy: 38.80
Round  59, Train loss: 0.201, Test loss: 1.020, Test accuracy: 75.18
Round  59, Global train loss: 0.201, Global test loss: 1.936, Global test accuracy: 36.32
Round  60, Train loss: 0.275, Test loss: 1.072, Test accuracy: 74.30
Round  60, Global train loss: 0.275, Global test loss: 2.286, Global test accuracy: 29.10
Round  61, Train loss: 0.156, Test loss: 1.055, Test accuracy: 74.62
Round  61, Global train loss: 0.156, Global test loss: 2.021, Global test accuracy: 39.34
Round  62, Train loss: 0.204, Test loss: 1.087, Test accuracy: 74.66
Round  62, Global train loss: 0.204, Global test loss: 2.040, Global test accuracy: 36.08
Round  63, Train loss: 0.224, Test loss: 1.066, Test accuracy: 75.20
Round  63, Global train loss: 0.224, Global test loss: 2.033, Global test accuracy: 32.70
Round  64, Train loss: 0.199, Test loss: 1.037, Test accuracy: 75.72
Round  64, Global train loss: 0.199, Global test loss: 1.811, Global test accuracy: 39.04
Round  65, Train loss: 0.172, Test loss: 1.067, Test accuracy: 75.24
Round  65, Global train loss: 0.172, Global test loss: 1.942, Global test accuracy: 35.50
Round  66, Train loss: 0.191, Test loss: 1.099, Test accuracy: 74.86
Round  66, Global train loss: 0.191, Global test loss: 2.222, Global test accuracy: 28.52
Round  67, Train loss: 0.124, Test loss: 1.090, Test accuracy: 75.04
Round  67, Global train loss: 0.124, Global test loss: 1.816, Global test accuracy: 39.06
Round  68, Train loss: 0.182, Test loss: 1.079, Test accuracy: 75.28
Round  68, Global train loss: 0.182, Global test loss: 2.299, Global test accuracy: 36.14
Round  69, Train loss: 0.119, Test loss: 1.095, Test accuracy: 75.52
Round  69, Global train loss: 0.119, Global test loss: 2.049, Global test accuracy: 42.06
Round  70, Train loss: 0.215, Test loss: 1.134, Test accuracy: 75.04
Round  70, Global train loss: 0.215, Global test loss: 2.216, Global test accuracy: 30.24
Round  71, Train loss: 0.130, Test loss: 1.193, Test accuracy: 74.96
Round  71, Global train loss: 0.130, Global test loss: 1.748, Global test accuracy: 38.42
Round  72, Train loss: 0.161, Test loss: 1.173, Test accuracy: 75.06
Round  72, Global train loss: 0.161, Global test loss: 2.105, Global test accuracy: 32.14
Round  73, Train loss: 0.150, Test loss: 1.177, Test accuracy: 74.80
Round  73, Global train loss: 0.150, Global test loss: 2.332, Global test accuracy: 34.44
Round  74, Train loss: 0.126, Test loss: 1.160, Test accuracy: 74.56
Round  74, Global train loss: 0.126, Global test loss: 1.782, Global test accuracy: 39.08
Round  75, Train loss: 0.129, Test loss: 1.162, Test accuracy: 74.98
Round  75, Global train loss: 0.129, Global test loss: 2.008, Global test accuracy: 30.76
Round  76, Train loss: 0.153, Test loss: 1.166, Test accuracy: 75.34
Round  76, Global train loss: 0.153, Global test loss: 2.020, Global test accuracy: 27.90
Round  77, Train loss: 0.172, Test loss: 1.142, Test accuracy: 75.22
Round  77, Global train loss: 0.172, Global test loss: 2.280, Global test accuracy: 30.48
Round  78, Train loss: 0.123, Test loss: 1.182, Test accuracy: 75.74
Round  78, Global train loss: 0.123, Global test loss: 2.197, Global test accuracy: 34.92
Round  79, Train loss: 0.081, Test loss: 1.246, Test accuracy: 75.36
Round  79, Global train loss: 0.081, Global test loss: 1.928, Global test accuracy: 40.68
Round  80, Train loss: 0.153, Test loss: 1.249, Test accuracy: 75.78
Round  80, Global train loss: 0.153, Global test loss: 1.975, Global test accuracy: 34.62
Round  81, Train loss: 0.102, Test loss: 1.247, Test accuracy: 75.50
Round  81, Global train loss: 0.102, Global test loss: 2.252, Global test accuracy: 35.38
Round  82, Train loss: 0.136, Test loss: 1.249, Test accuracy: 75.26
Round  82, Global train loss: 0.136, Global test loss: 2.237, Global test accuracy: 31.14
Round  83, Train loss: 0.121, Test loss: 1.267, Test accuracy: 75.32
Round  83, Global train loss: 0.121, Global test loss: 2.079, Global test accuracy: 28.60
Round  84, Train loss: 0.133, Test loss: 1.253, Test accuracy: 75.12
Round  84, Global train loss: 0.133, Global test loss: 1.930, Global test accuracy: 34.20
Round  85, Train loss: 0.122, Test loss: 1.356, Test accuracy: 74.56
Round  85, Global train loss: 0.122, Global test loss: 1.975, Global test accuracy: 38.60
Round  86, Train loss: 0.083, Test loss: 1.345, Test accuracy: 74.74
Round  86, Global train loss: 0.083, Global test loss: 1.861, Global test accuracy: 34.56
Round  87, Train loss: 0.063, Test loss: 1.244, Test accuracy: 75.50
Round  87, Global train loss: 0.063, Global test loss: 2.289, Global test accuracy: 32.56
Round  88, Train loss: 0.101, Test loss: 1.218, Test accuracy: 76.30
Round  88, Global train loss: 0.101, Global test loss: 2.024, Global test accuracy: 34.48
Round  89, Train loss: 0.103, Test loss: 1.211, Test accuracy: 75.56
Round  89, Global train loss: 0.103, Global test loss: 1.759, Global test accuracy: 43.82
Round  90, Train loss: 0.079, Test loss: 1.274, Test accuracy: 75.12
Round  90, Global train loss: 0.079, Global test loss: 2.652, Global test accuracy: 33.68
Round  91, Train loss: 0.109, Test loss: 1.302, Test accuracy: 74.64
Round  91, Global train loss: 0.109, Global test loss: 2.022, Global test accuracy: 36.82
Round  92, Train loss: 0.060, Test loss: 1.271, Test accuracy: 74.84
Round  92, Global train loss: 0.060, Global test loss: 2.227, Global test accuracy: 31.90
Round  93, Train loss: 0.122, Test loss: 1.251, Test accuracy: 75.28
Round  93, Global train loss: 0.122, Global test loss: 2.213, Global test accuracy: 30.92
Round  94, Train loss: 0.070, Test loss: 1.236, Test accuracy: 75.18
Round  94, Global train loss: 0.070, Global test loss: 2.184, Global test accuracy: 30.82
Round  95, Train loss: 0.132, Test loss: 1.277, Test accuracy: 75.14
Round  95, Global train loss: 0.132, Global test loss: 1.981, Global test accuracy: 31.32
Round  96, Train loss: 0.071, Test loss: 1.306, Test accuracy: 74.94
Round  96, Global train loss: 0.071, Global test loss: 1.896, Global test accuracy: 37.64
Round  97, Train loss: 0.086, Test loss: 1.320, Test accuracy: 74.44
Round  97, Global train loss: 0.086, Global test loss: 2.873, Global test accuracy: 28.80
Round  98, Train loss: 0.113, Test loss: 1.292, Test accuracy: 74.80
Round  98, Global train loss: 0.113, Global test loss: 2.153, Global test accuracy: 29.50
Round  99, Train loss: 0.092, Test loss: 1.270, Test accuracy: 75.46
Round  99, Global train loss: 0.092, Global test loss: 2.271, Global test accuracy: 31.62
Final Round, Train loss: 0.071, Test loss: 1.359, Test accuracy: 75.84
Final Round, Global train loss: 0.071, Global test loss: 2.271, Global test accuracy: 31.62
Average accuracy final 10 rounds: 74.98400000000001 

Average global accuracy final 10 rounds: 32.302 

1000.2793231010437
[1.6476414203643799, 3.2952828407287598, 4.535263538360596, 5.775244235992432, 7.11903190612793, 8.462819576263428, 9.791189432144165, 11.119559288024902, 12.624486923217773, 14.129414558410645, 15.549690961837769, 16.969967365264893, 18.475594758987427, 19.98122215270996, 21.669938802719116, 23.35865545272827, 24.994624614715576, 26.63059377670288, 28.23599100112915, 29.84138822555542, 31.260520219802856, 32.67965221405029, 34.227813720703125, 35.77597522735596, 37.27086782455444, 38.76576042175293, 40.22832441329956, 41.69088840484619, 43.371453046798706, 45.05201768875122, 46.70064043998718, 48.349263191223145, 49.96550130844116, 51.58173942565918, 53.051111936569214, 54.52048444747925, 56.094887256622314, 57.66929006576538, 59.1523277759552, 60.63536548614502, 62.172873973846436, 63.71038246154785, 65.36229753494263, 67.0142126083374, 68.71013283729553, 70.40605306625366, 72.01622343063354, 73.62639379501343, 75.31900358200073, 77.01161336898804, 78.51398658752441, 80.01635980606079, 81.55340194702148, 83.09044408798218, 84.64537191390991, 86.20029973983765, 87.75073599815369, 89.30117225646973, 90.90957880020142, 92.5179853439331, 94.01093935966492, 95.50389337539673, 97.10019445419312, 98.6964955329895, 100.14130020141602, 101.58610486984253, 103.13898611068726, 104.69186735153198, 106.37981414794922, 108.06776094436646, 109.50981831550598, 110.95187568664551, 112.40945887565613, 113.86704206466675, 115.36755752563477, 116.86807298660278, 118.43121004104614, 119.9943470954895, 121.54686188697815, 123.0993766784668, 124.57676529884338, 126.05415391921997, 127.47550058364868, 128.8968472480774, 130.52173018455505, 132.14661312103271, 133.73973321914673, 135.33285331726074, 136.77835774421692, 138.2238621711731, 140.1246256828308, 142.02538919448853, 143.75835824012756, 145.4913272857666, 146.9975860118866, 148.5038447380066, 149.91933417320251, 151.33482360839844, 152.87295651435852, 154.4110894203186, 155.89738726615906, 157.3836851119995, 158.8807098865509, 160.3777346611023, 161.83745861053467, 163.29718255996704, 164.73224115371704, 166.16729974746704, 167.6468367576599, 169.12637376785278, 170.58761072158813, 172.0488476753235, 173.68722820281982, 175.32560873031616, 176.82093143463135, 178.31625413894653, 179.75405502319336, 181.19185590744019, 182.72139739990234, 184.2509388923645, 185.79143047332764, 187.33192205429077, 189.1353316307068, 190.9387412071228, 193.23377346992493, 195.52880573272705, 197.3257715702057, 199.12273740768433, 200.61080718040466, 202.098876953125, 203.7398817539215, 205.38088655471802, 206.9453160762787, 208.50974559783936, 210.05653953552246, 211.60333347320557, 213.1225287914276, 214.64172410964966, 216.2818374633789, 217.92195081710815, 219.5667760372162, 221.21160125732422, 222.8444333076477, 224.4772653579712, 225.98136830329895, 227.4854712486267, 228.902676820755, 230.3198823928833, 231.97095847129822, 233.62203454971313, 235.2045283317566, 236.78702211380005, 238.47831201553345, 240.16960191726685, 241.95355987548828, 243.73751783370972, 245.42655086517334, 247.11558389663696, 248.6417441368103, 250.16790437698364, 251.6923623085022, 253.21682024002075, 254.96918630599976, 256.72155237197876, 258.75124406814575, 260.78093576431274, 262.6832489967346, 264.5855622291565, 266.0556437969208, 267.52572536468506, 269.08064126968384, 270.6355571746826, 272.18244791030884, 273.72933864593506, 275.46770000457764, 277.2060613632202, 278.9523034095764, 280.6985454559326, 282.2937617301941, 283.88897800445557, 285.4961130619049, 287.10324811935425, 288.8200948238373, 290.5369415283203, 292.13151121139526, 293.7260808944702, 295.4948830604553, 297.26368522644043, 298.76176834106445, 300.2598514556885, 301.8120608329773, 303.3642702102661, 304.9816334247589, 306.5989966392517, 308.19598054885864, 309.7929644584656, 311.4616641998291, 313.1303639411926, 315.47592544555664, 317.82148694992065, 322.0435130596161, 326.2655391693115]
[31.36, 31.36, 37.5, 37.5, 44.06, 44.06, 46.98, 46.98, 53.08, 53.08, 52.16, 52.16, 57.96, 57.96, 58.84, 58.84, 59.78, 59.78, 60.44, 60.44, 64.18, 64.18, 64.34, 64.34, 65.82, 65.82, 67.4, 67.4, 69.02, 69.02, 69.4, 69.4, 68.34, 68.34, 69.38, 69.38, 70.8, 70.8, 70.62, 70.62, 70.64, 70.64, 70.62, 70.62, 71.08, 71.08, 71.76, 71.76, 72.42, 72.42, 72.2, 72.2, 72.96, 72.96, 72.78, 72.78, 73.56, 73.56, 73.1, 73.1, 73.48, 73.48, 73.02, 73.02, 73.44, 73.44, 73.36, 73.36, 73.46, 73.46, 73.38, 73.38, 74.22, 74.22, 73.42, 73.42, 73.04, 73.04, 74.08, 74.08, 74.2, 74.2, 74.16, 74.16, 74.36, 74.36, 74.12, 74.12, 73.88, 73.88, 73.62, 73.62, 73.68, 73.68, 73.88, 73.88, 74.44, 74.44, 75.34, 75.34, 74.62, 74.62, 74.54, 74.54, 75.0, 75.0, 75.06, 75.06, 74.58, 74.58, 75.82, 75.82, 76.04, 76.04, 75.82, 75.82, 75.38, 75.38, 75.18, 75.18, 74.3, 74.3, 74.62, 74.62, 74.66, 74.66, 75.2, 75.2, 75.72, 75.72, 75.24, 75.24, 74.86, 74.86, 75.04, 75.04, 75.28, 75.28, 75.52, 75.52, 75.04, 75.04, 74.96, 74.96, 75.06, 75.06, 74.8, 74.8, 74.56, 74.56, 74.98, 74.98, 75.34, 75.34, 75.22, 75.22, 75.74, 75.74, 75.36, 75.36, 75.78, 75.78, 75.5, 75.5, 75.26, 75.26, 75.32, 75.32, 75.12, 75.12, 74.56, 74.56, 74.74, 74.74, 75.5, 75.5, 76.3, 76.3, 75.56, 75.56, 75.12, 75.12, 74.64, 74.64, 74.84, 74.84, 75.28, 75.28, 75.18, 75.18, 75.14, 75.14, 74.94, 74.94, 74.44, 74.44, 74.8, 74.8, 75.46, 75.46, 75.84, 75.84]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.682, Test loss: 2.238, Test accuracy: 16.50
Round   0, Global train loss: 1.682, Global test loss: 2.412, Global test accuracy: 10.72
Round   1, Train loss: 1.487, Test loss: 1.868, Test accuracy: 30.10
Round   1, Global train loss: 1.487, Global test loss: 2.176, Global test accuracy: 19.60
Round   2, Train loss: 1.330, Test loss: 1.657, Test accuracy: 41.44
Round   2, Global train loss: 1.330, Global test loss: 2.093, Global test accuracy: 28.24
Round   3, Train loss: 1.225, Test loss: 1.481, Test accuracy: 45.68
Round   3, Global train loss: 1.225, Global test loss: 1.792, Global test accuracy: 38.36
Round   4, Train loss: 1.175, Test loss: 1.489, Test accuracy: 50.24
Round   4, Global train loss: 1.175, Global test loss: 2.075, Global test accuracy: 34.82
Round   5, Train loss: 1.164, Test loss: 1.166, Test accuracy: 56.76
Round   5, Global train loss: 1.164, Global test loss: 1.633, Global test accuracy: 44.50
Round   6, Train loss: 1.128, Test loss: 1.079, Test accuracy: 59.30
Round   6, Global train loss: 1.128, Global test loss: 1.884, Global test accuracy: 38.46
Round   7, Train loss: 0.926, Test loss: 1.013, Test accuracy: 62.88
Round   7, Global train loss: 0.926, Global test loss: 1.687, Global test accuracy: 46.32
Round   8, Train loss: 0.956, Test loss: 0.940, Test accuracy: 65.32
Round   8, Global train loss: 0.956, Global test loss: 1.535, Global test accuracy: 48.16
Round   9, Train loss: 0.827, Test loss: 0.959, Test accuracy: 65.80
Round   9, Global train loss: 0.827, Global test loss: 1.558, Global test accuracy: 53.06
Round  10, Train loss: 0.868, Test loss: 0.952, Test accuracy: 65.76
Round  10, Global train loss: 0.868, Global test loss: 1.656, Global test accuracy: 46.00
Round  11, Train loss: 0.862, Test loss: 0.910, Test accuracy: 67.68
Round  11, Global train loss: 0.862, Global test loss: 1.321, Global test accuracy: 55.96
Round  12, Train loss: 0.786, Test loss: 0.867, Test accuracy: 70.24
Round  12, Global train loss: 0.786, Global test loss: 1.507, Global test accuracy: 52.16
Round  13, Train loss: 0.905, Test loss: 0.874, Test accuracy: 70.90
Round  13, Global train loss: 0.905, Global test loss: 1.674, Global test accuracy: 48.52
Round  14, Train loss: 0.858, Test loss: 0.728, Test accuracy: 74.68
Round  14, Global train loss: 0.858, Global test loss: 1.161, Global test accuracy: 59.64
Round  15, Train loss: 0.631, Test loss: 0.714, Test accuracy: 75.32
Round  15, Global train loss: 0.631, Global test loss: 1.235, Global test accuracy: 59.58
Round  16, Train loss: 0.720, Test loss: 0.695, Test accuracy: 75.88
Round  16, Global train loss: 0.720, Global test loss: 1.204, Global test accuracy: 59.20
Round  17, Train loss: 0.674, Test loss: 0.690, Test accuracy: 76.28
Round  17, Global train loss: 0.674, Global test loss: 1.618, Global test accuracy: 55.12
Round  18, Train loss: 0.744, Test loss: 0.715, Test accuracy: 75.68
Round  18, Global train loss: 0.744, Global test loss: 1.108, Global test accuracy: 62.94
Round  19, Train loss: 0.634, Test loss: 0.698, Test accuracy: 76.18
Round  19, Global train loss: 0.634, Global test loss: 1.111, Global test accuracy: 65.00
Round  20, Train loss: 0.526, Test loss: 0.721, Test accuracy: 75.74
Round  20, Global train loss: 0.526, Global test loss: 1.322, Global test accuracy: 62.70
Round  21, Train loss: 0.589, Test loss: 0.738, Test accuracy: 75.12
Round  21, Global train loss: 0.589, Global test loss: 1.307, Global test accuracy: 57.80
Round  22, Train loss: 0.619, Test loss: 0.706, Test accuracy: 75.94
Round  22, Global train loss: 0.619, Global test loss: 1.055, Global test accuracy: 64.76
Round  23, Train loss: 0.483, Test loss: 0.727, Test accuracy: 75.26
Round  23, Global train loss: 0.483, Global test loss: 1.403, Global test accuracy: 58.82
Round  24, Train loss: 0.497, Test loss: 0.707, Test accuracy: 75.98
Round  24, Global train loss: 0.497, Global test loss: 1.288, Global test accuracy: 61.34
Round  25, Train loss: 0.479, Test loss: 0.710, Test accuracy: 76.36
Round  25, Global train loss: 0.479, Global test loss: 1.462, Global test accuracy: 59.96
Round  26, Train loss: 0.546, Test loss: 0.722, Test accuracy: 76.04
Round  26, Global train loss: 0.546, Global test loss: 1.036, Global test accuracy: 65.66
Round  27, Train loss: 0.510, Test loss: 0.693, Test accuracy: 77.24
Round  27, Global train loss: 0.510, Global test loss: 1.242, Global test accuracy: 59.92
Round  28, Train loss: 0.471, Test loss: 0.673, Test accuracy: 78.20
Round  28, Global train loss: 0.471, Global test loss: 1.115, Global test accuracy: 64.46
Round  29, Train loss: 0.531, Test loss: 0.687, Test accuracy: 77.56
Round  29, Global train loss: 0.531, Global test loss: 1.172, Global test accuracy: 61.84
Round  30, Train loss: 0.475, Test loss: 0.698, Test accuracy: 78.16
Round  30, Global train loss: 0.475, Global test loss: 1.041, Global test accuracy: 68.04
Round  31, Train loss: 0.364, Test loss: 0.700, Test accuracy: 77.96
Round  31, Global train loss: 0.364, Global test loss: 1.274, Global test accuracy: 62.82
Round  32, Train loss: 0.495, Test loss: 0.699, Test accuracy: 77.98
Round  32, Global train loss: 0.495, Global test loss: 1.000, Global test accuracy: 68.50
Round  33, Train loss: 0.421, Test loss: 0.698, Test accuracy: 78.04
Round  33, Global train loss: 0.421, Global test loss: 1.028, Global test accuracy: 68.56
Round  34, Train loss: 0.362, Test loss: 0.723, Test accuracy: 78.14
Round  34, Global train loss: 0.362, Global test loss: 1.585, Global test accuracy: 57.84
Round  35, Train loss: 0.493, Test loss: 0.732, Test accuracy: 77.98
Round  35, Global train loss: 0.493, Global test loss: 1.328, Global test accuracy: 60.34
Round  36, Train loss: 0.346, Test loss: 0.710, Test accuracy: 78.22
Round  36, Global train loss: 0.346, Global test loss: 1.075, Global test accuracy: 66.98
Round  37, Train loss: 0.429, Test loss: 0.708, Test accuracy: 78.54
Round  37, Global train loss: 0.429, Global test loss: 1.419, Global test accuracy: 63.00
Round  38, Train loss: 0.427, Test loss: 0.699, Test accuracy: 78.92
Round  38, Global train loss: 0.427, Global test loss: 0.899, Global test accuracy: 71.06
Round  39, Train loss: 0.310, Test loss: 0.710, Test accuracy: 79.26
Round  39, Global train loss: 0.310, Global test loss: 1.122, Global test accuracy: 65.90
Round  40, Train loss: 0.252, Test loss: 0.680, Test accuracy: 79.98
Round  40, Global train loss: 0.252, Global test loss: 1.093, Global test accuracy: 67.16
Round  41, Train loss: 0.331, Test loss: 0.684, Test accuracy: 79.54
Round  41, Global train loss: 0.331, Global test loss: 1.114, Global test accuracy: 67.74
Round  42, Train loss: 0.271, Test loss: 0.682, Test accuracy: 79.48
Round  42, Global train loss: 0.271, Global test loss: 1.157, Global test accuracy: 65.20
Round  43, Train loss: 0.366, Test loss: 0.686, Test accuracy: 79.62
Round  43, Global train loss: 0.366, Global test loss: 1.046, Global test accuracy: 68.02
Round  44, Train loss: 0.386, Test loss: 0.691, Test accuracy: 79.70
Round  44, Global train loss: 0.386, Global test loss: 0.955, Global test accuracy: 71.08
Round  45, Train loss: 0.367, Test loss: 0.691, Test accuracy: 79.96
Round  45, Global train loss: 0.367, Global test loss: 0.994, Global test accuracy: 71.00
Round  46, Train loss: 0.362, Test loss: 0.725, Test accuracy: 79.90
Round  46, Global train loss: 0.362, Global test loss: 1.106, Global test accuracy: 67.56
Round  47, Train loss: 0.256, Test loss: 0.750, Test accuracy: 79.22
Round  47, Global train loss: 0.256, Global test loss: 1.020, Global test accuracy: 68.82
Round  48, Train loss: 0.284, Test loss: 0.741, Test accuracy: 79.06
Round  48, Global train loss: 0.284, Global test loss: 1.027, Global test accuracy: 69.82
Round  49, Train loss: 0.259, Test loss: 0.758, Test accuracy: 79.02
Round  49, Global train loss: 0.259, Global test loss: 1.201, Global test accuracy: 66.46
Round  50, Train loss: 0.315, Test loss: 0.763, Test accuracy: 78.86
Round  50, Global train loss: 0.315, Global test loss: 1.199, Global test accuracy: 67.96
Round  51, Train loss: 0.259, Test loss: 0.754, Test accuracy: 79.20
Round  51, Global train loss: 0.259, Global test loss: 1.176, Global test accuracy: 69.80
Round  52, Train loss: 0.255, Test loss: 0.772, Test accuracy: 78.62
Round  52, Global train loss: 0.255, Global test loss: 1.045, Global test accuracy: 68.36
Round  53, Train loss: 0.314, Test loss: 0.728, Test accuracy: 79.90
Round  53, Global train loss: 0.314, Global test loss: 1.002, Global test accuracy: 70.42
Round  54, Train loss: 0.242, Test loss: 0.760, Test accuracy: 79.66
Round  54, Global train loss: 0.242, Global test loss: 1.051, Global test accuracy: 70.34
Round  55, Train loss: 0.257, Test loss: 0.763, Test accuracy: 79.20
Round  55, Global train loss: 0.257, Global test loss: 1.024, Global test accuracy: 69.56
Round  56, Train loss: 0.198, Test loss: 0.766, Test accuracy: 79.06
Round  56, Global train loss: 0.198, Global test loss: 1.218, Global test accuracy: 67.32
Round  57, Train loss: 0.247, Test loss: 0.757, Test accuracy: 79.36
Round  57, Global train loss: 0.247, Global test loss: 1.234, Global test accuracy: 68.92
Round  58, Train loss: 0.249, Test loss: 0.751, Test accuracy: 80.08
Round  58, Global train loss: 0.249, Global test loss: 1.038, Global test accuracy: 71.08
Round  59, Train loss: 0.264, Test loss: 0.748, Test accuracy: 80.28
Round  59, Global train loss: 0.264, Global test loss: 0.980, Global test accuracy: 71.96
Round  60, Train loss: 0.239, Test loss: 0.737, Test accuracy: 80.26
Round  60, Global train loss: 0.239, Global test loss: 1.048, Global test accuracy: 69.06
Round  61, Train loss: 0.279, Test loss: 0.754, Test accuracy: 79.88
Round  61, Global train loss: 0.279, Global test loss: 1.126, Global test accuracy: 69.56
Round  62, Train loss: 0.232, Test loss: 0.730, Test accuracy: 80.58
Round  62, Global train loss: 0.232, Global test loss: 1.265, Global test accuracy: 67.40
Round  63, Train loss: 0.223, Test loss: 0.747, Test accuracy: 80.60
Round  63, Global train loss: 0.223, Global test loss: 1.246, Global test accuracy: 69.26
Round  64, Train loss: 0.188, Test loss: 0.757, Test accuracy: 80.56
Round  64, Global train loss: 0.188, Global test loss: 1.023, Global test accuracy: 70.32
Round  65, Train loss: 0.143, Test loss: 0.796, Test accuracy: 80.20
Round  65, Global train loss: 0.143, Global test loss: 1.199, Global test accuracy: 69.94
Round  66, Train loss: 0.206, Test loss: 0.813, Test accuracy: 80.02
Round  66, Global train loss: 0.206, Global test loss: 1.281, Global test accuracy: 68.68
Round  67, Train loss: 0.200, Test loss: 0.796, Test accuracy: 80.28
Round  67, Global train loss: 0.200, Global test loss: 1.332, Global test accuracy: 68.00
Round  68, Train loss: 0.185, Test loss: 0.810, Test accuracy: 80.82
Round  68, Global train loss: 0.185, Global test loss: 1.079, Global test accuracy: 70.92
Round  69, Train loss: 0.206, Test loss: 0.808, Test accuracy: 81.22
Round  69, Global train loss: 0.206, Global test loss: 1.257, Global test accuracy: 66.20
Round  70, Train loss: 0.156, Test loss: 0.780, Test accuracy: 81.48
Round  70, Global train loss: 0.156, Global test loss: 1.110, Global test accuracy: 70.72
Round  71, Train loss: 0.190, Test loss: 0.773, Test accuracy: 81.20
Round  71, Global train loss: 0.190, Global test loss: 1.078, Global test accuracy: 70.88
Round  72, Train loss: 0.171, Test loss: 0.780, Test accuracy: 81.38
Round  72, Global train loss: 0.171, Global test loss: 1.351, Global test accuracy: 69.56
Round  73, Train loss: 0.183, Test loss: 0.802, Test accuracy: 81.08
Round  73, Global train loss: 0.183, Global test loss: 1.191, Global test accuracy: 70.32
Round  74, Train loss: 0.128, Test loss: 0.818, Test accuracy: 81.26
Round  74, Global train loss: 0.128, Global test loss: 1.452, Global test accuracy: 67.56
Round  75, Train loss: 0.152, Test loss: 0.830, Test accuracy: 80.90
Round  75, Global train loss: 0.152, Global test loss: 1.047, Global test accuracy: 71.22
Round  76, Train loss: 0.171, Test loss: 0.839, Test accuracy: 80.24
Round  76, Global train loss: 0.171, Global test loss: 1.251, Global test accuracy: 69.48
Round  77, Train loss: 0.129, Test loss: 0.864, Test accuracy: 79.46
Round  77, Global train loss: 0.129, Global test loss: 1.122, Global test accuracy: 69.48
Round  78, Train loss: 0.179, Test loss: 0.865, Test accuracy: 80.00
Round  78, Global train loss: 0.179, Global test loss: 1.050, Global test accuracy: 71.40
Round  79, Train loss: 0.154, Test loss: 0.832, Test accuracy: 80.58
Round  79, Global train loss: 0.154, Global test loss: 1.232, Global test accuracy: 70.82
Round  80, Train loss: 0.147, Test loss: 0.875, Test accuracy: 80.96
Round  80, Global train loss: 0.147, Global test loss: 1.397, Global test accuracy: 67.56
Round  81, Train loss: 0.180, Test loss: 0.895, Test accuracy: 80.30
Round  81, Global train loss: 0.180, Global test loss: 1.257, Global test accuracy: 69.32
Round  82, Train loss: 0.097, Test loss: 0.896, Test accuracy: 80.04
Round  82, Global train loss: 0.097, Global test loss: 1.218, Global test accuracy: 70.12
Round  83, Train loss: 0.122, Test loss: 0.907, Test accuracy: 80.14
Round  83, Global train loss: 0.122, Global test loss: 1.360, Global test accuracy: 68.82
Round  84, Train loss: 0.111, Test loss: 0.872, Test accuracy: 80.18
Round  84, Global train loss: 0.111, Global test loss: 1.379, Global test accuracy: 68.70
Round  85, Train loss: 0.088, Test loss: 0.929, Test accuracy: 79.68
Round  85, Global train loss: 0.088, Global test loss: 1.320, Global test accuracy: 69.20
Round  86, Train loss: 0.147, Test loss: 0.883, Test accuracy: 80.24
Round  86, Global train loss: 0.147, Global test loss: 1.097, Global test accuracy: 70.20
Round  87, Train loss: 0.094, Test loss: 0.859, Test accuracy: 80.36
Round  87, Global train loss: 0.094, Global test loss: 1.288, Global test accuracy: 68.42
Round  88, Train loss: 0.180, Test loss: 0.876, Test accuracy: 80.42
Round  88, Global train loss: 0.180, Global test loss: 1.282, Global test accuracy: 70.32
Round  89, Train loss: 0.117, Test loss: 0.857, Test accuracy: 80.68
Round  89, Global train loss: 0.117, Global test loss: 1.378, Global test accuracy: 69.54
Round  90, Train loss: 0.151, Test loss: 0.856, Test accuracy: 80.34
Round  90, Global train loss: 0.151, Global test loss: 1.252, Global test accuracy: 71.46
Round  91, Train loss: 0.091, Test loss: 0.846, Test accuracy: 80.88
Round  91, Global train loss: 0.091, Global test loss: 1.292, Global test accuracy: 70.26
Round  92, Train loss: 0.134, Test loss: 0.840, Test accuracy: 81.30
Round  92, Global train loss: 0.134, Global test loss: 1.278, Global test accuracy: 70.58
Round  93, Train loss: 0.137, Test loss: 0.835, Test accuracy: 81.70
Round  93, Global train loss: 0.137, Global test loss: 1.114, Global test accuracy: 73.10
Round  94, Train loss: 0.088, Test loss: 0.887, Test accuracy: 80.98
Round  94, Global train loss: 0.088, Global test loss: 1.253, Global test accuracy: 70.88
Round  95, Train loss: 0.093, Test loss: 0.848, Test accuracy: 81.60
Round  95, Global train loss: 0.093, Global test loss: 1.428, Global test accuracy: 67.28
Round  96, Train loss: 0.099, Test loss: 0.863, Test accuracy: 81.46
Round  96, Global train loss: 0.099, Global test loss: 1.275, Global test accuracy: 70.48
Round  97, Train loss: 0.097, Test loss: 0.871, Test accuracy: 81.18
Round  97, Global train loss: 0.097, Global test loss: 1.314, Global test accuracy: 71.54
Round  98, Train loss: 0.072, Test loss: 0.860, Test accuracy: 81.28
Round  98, Global train loss: 0.072, Global test loss: 1.323, Global test accuracy: 71.42
Round  99, Train loss: 0.098, Test loss: 0.915, Test accuracy: 80.84
Round  99, Global train loss: 0.098, Global test loss: 1.278, Global test accuracy: 70.88
Final Round, Train loss: 0.101, Test loss: 0.901, Test accuracy: 81.00
Final Round, Global train loss: 0.101, Global test loss: 1.278, Global test accuracy: 70.88
Average accuracy final 10 rounds: 81.15599999999999 

Average global accuracy final 10 rounds: 70.78800000000001 

1026.078498840332
[1.9583792686462402, 3.9167585372924805, 5.402910947799683, 6.889063358306885, 8.614365339279175, 10.339667320251465, 12.046374797821045, 13.753082275390625, 15.720539808273315, 17.687997341156006, 19.23073720932007, 20.77347707748413, 22.50140905380249, 24.22934103012085, 25.940869331359863, 27.652397632598877, 29.33666706085205, 31.020936489105225, 32.70390272140503, 34.386868953704834, 36.082380294799805, 37.777891635894775, 39.42457437515259, 41.0712571144104, 42.64891219139099, 44.22656726837158, 45.790470123291016, 47.35437297821045, 48.91539406776428, 50.476415157318115, 52.0716826915741, 53.66695022583008, 55.209094285964966, 56.75123834609985, 58.40542817115784, 60.05961799621582, 61.6471529006958, 63.23468780517578, 64.78596138954163, 66.33723497390747, 67.94820761680603, 69.55918025970459, 71.06329822540283, 72.56741619110107, 74.10389804840088, 75.64037990570068, 77.22230648994446, 78.80423307418823, 80.42851877212524, 82.05280447006226, 83.6852855682373, 85.31776666641235, 87.16855359077454, 89.01934051513672, 90.58527159690857, 92.15120267868042, 93.71634721755981, 95.28149175643921, 96.83276772499084, 98.38404369354248, 99.96594572067261, 101.54784774780273, 103.1176815032959, 104.68751525878906, 106.26512956619263, 107.84274387359619, 109.50957894325256, 111.17641401290894, 112.72908020019531, 114.28174638748169, 115.91242098808289, 117.54309558868408, 119.11690044403076, 120.69070529937744, 122.229816198349, 123.76892709732056, 125.28004264831543, 126.7911581993103, 128.33191537857056, 129.8726725578308, 131.33947730064392, 132.80628204345703, 134.86692690849304, 136.92757177352905, 138.72980880737305, 140.53204584121704, 142.17812275886536, 143.82419967651367, 145.4856469631195, 147.14709424972534, 148.90389275550842, 150.6606912612915, 152.70045256614685, 154.7402138710022, 156.90554237365723, 159.07087087631226, 161.368248462677, 163.66562604904175, 165.75623536109924, 167.84684467315674, 169.49688577651978, 171.1469268798828, 172.77412843704224, 174.40132999420166, 175.96161699295044, 177.52190399169922, 179.09141397476196, 180.6609239578247, 182.27346682548523, 183.88600969314575, 185.43470454216003, 186.98339939117432, 188.57699155807495, 190.1705837249756, 191.6825978755951, 193.1946120262146, 194.69555354118347, 196.19649505615234, 197.72707080841064, 199.25764656066895, 200.81102466583252, 202.3644027709961, 203.97167992591858, 205.57895708084106, 207.02184295654297, 208.46472883224487, 210.15617156028748, 211.84761428833008, 213.3928873538971, 214.9381604194641, 216.50724458694458, 218.07632875442505, 219.63127255439758, 221.18621635437012, 222.7409942150116, 224.29577207565308, 225.88489747047424, 227.4740228652954, 229.10118007659912, 230.72833728790283, 232.34348559379578, 233.95863389968872, 235.8020749092102, 237.6455159187317, 239.06838607788086, 240.49125623703003, 242.06473588943481, 243.6382155418396, 245.3326244354248, 247.02703332901, 248.5571005344391, 250.08716773986816, 251.76006245613098, 253.4329571723938, 254.9858856201172, 256.5388140678406, 258.5306406021118, 260.52246713638306, 262.11519622802734, 263.70792531967163, 265.33052158355713, 266.9531178474426, 268.48786878585815, 270.0226197242737, 271.544775724411, 273.06693172454834, 274.6999270915985, 276.3329224586487, 277.84118366241455, 279.3494448661804, 280.9228129386902, 282.49618101119995, 284.1112415790558, 285.7263021469116, 287.37384128570557, 289.0213804244995, 290.56896114349365, 292.1165418624878, 293.6473124027252, 295.17808294296265, 296.73405861854553, 298.2900342941284, 299.7985129356384, 301.30699157714844, 302.87638664245605, 304.4457817077637, 305.9623305797577, 307.4788794517517, 309.5451455116272, 311.6114115715027, 313.3658072948456, 315.1202030181885, 316.7562141418457, 318.39222526550293, 320.13162326812744, 321.87102127075195, 323.63343572616577, 325.3958501815796, 327.20300483703613, 329.0101594924927, 332.2855522632599, 335.5609450340271]
[16.5, 16.5, 30.1, 30.1, 41.44, 41.44, 45.68, 45.68, 50.24, 50.24, 56.76, 56.76, 59.3, 59.3, 62.88, 62.88, 65.32, 65.32, 65.8, 65.8, 65.76, 65.76, 67.68, 67.68, 70.24, 70.24, 70.9, 70.9, 74.68, 74.68, 75.32, 75.32, 75.88, 75.88, 76.28, 76.28, 75.68, 75.68, 76.18, 76.18, 75.74, 75.74, 75.12, 75.12, 75.94, 75.94, 75.26, 75.26, 75.98, 75.98, 76.36, 76.36, 76.04, 76.04, 77.24, 77.24, 78.2, 78.2, 77.56, 77.56, 78.16, 78.16, 77.96, 77.96, 77.98, 77.98, 78.04, 78.04, 78.14, 78.14, 77.98, 77.98, 78.22, 78.22, 78.54, 78.54, 78.92, 78.92, 79.26, 79.26, 79.98, 79.98, 79.54, 79.54, 79.48, 79.48, 79.62, 79.62, 79.7, 79.7, 79.96, 79.96, 79.9, 79.9, 79.22, 79.22, 79.06, 79.06, 79.02, 79.02, 78.86, 78.86, 79.2, 79.2, 78.62, 78.62, 79.9, 79.9, 79.66, 79.66, 79.2, 79.2, 79.06, 79.06, 79.36, 79.36, 80.08, 80.08, 80.28, 80.28, 80.26, 80.26, 79.88, 79.88, 80.58, 80.58, 80.6, 80.6, 80.56, 80.56, 80.2, 80.2, 80.02, 80.02, 80.28, 80.28, 80.82, 80.82, 81.22, 81.22, 81.48, 81.48, 81.2, 81.2, 81.38, 81.38, 81.08, 81.08, 81.26, 81.26, 80.9, 80.9, 80.24, 80.24, 79.46, 79.46, 80.0, 80.0, 80.58, 80.58, 80.96, 80.96, 80.3, 80.3, 80.04, 80.04, 80.14, 80.14, 80.18, 80.18, 79.68, 79.68, 80.24, 80.24, 80.36, 80.36, 80.42, 80.42, 80.68, 80.68, 80.34, 80.34, 80.88, 80.88, 81.3, 81.3, 81.7, 81.7, 80.98, 80.98, 81.6, 81.6, 81.46, 81.46, 81.18, 81.18, 81.28, 81.28, 80.84, 80.84, 81.0, 81.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.644, Test loss: 1.936, Test accuracy: 28.40
Round   0, Global train loss: 1.644, Global test loss: 2.171, Global test accuracy: 22.80
Round   1, Train loss: 1.393, Test loss: 1.784, Test accuracy: 34.70
Round   1, Global train loss: 1.393, Global test loss: 2.078, Global test accuracy: 25.14
Round   2, Train loss: 1.297, Test loss: 2.011, Test accuracy: 39.56
Round   2, Global train loss: 1.297, Global test loss: 2.458, Global test accuracy: 30.34
Round   3, Train loss: 1.239, Test loss: 1.543, Test accuracy: 45.34
Round   3, Global train loss: 1.239, Global test loss: 2.016, Global test accuracy: 32.36
Round   4, Train loss: 1.167, Test loss: 1.291, Test accuracy: 51.16
Round   4, Global train loss: 1.167, Global test loss: 1.678, Global test accuracy: 38.78
Round   5, Train loss: 1.250, Test loss: 1.063, Test accuracy: 60.36
Round   5, Global train loss: 1.250, Global test loss: 1.566, Global test accuracy: 47.46
Round   6, Train loss: 1.093, Test loss: 1.117, Test accuracy: 58.58
Round   6, Global train loss: 1.093, Global test loss: 1.808, Global test accuracy: 37.66
Round   7, Train loss: 1.044, Test loss: 1.075, Test accuracy: 61.62
Round   7, Global train loss: 1.044, Global test loss: 1.714, Global test accuracy: 47.92
Round   8, Train loss: 1.044, Test loss: 0.914, Test accuracy: 65.18
Round   8, Global train loss: 1.044, Global test loss: 1.492, Global test accuracy: 49.74
Round   9, Train loss: 0.984, Test loss: 0.901, Test accuracy: 66.02
Round   9, Global train loss: 0.984, Global test loss: 1.381, Global test accuracy: 51.54
Round  10, Train loss: 1.112, Test loss: 0.883, Test accuracy: 66.70
Round  10, Global train loss: 1.112, Global test loss: 1.748, Global test accuracy: 39.24
Round  11, Train loss: 0.899, Test loss: 0.878, Test accuracy: 67.22
Round  11, Global train loss: 0.899, Global test loss: 1.447, Global test accuracy: 49.46
Round  12, Train loss: 0.937, Test loss: 0.862, Test accuracy: 68.24
Round  12, Global train loss: 0.937, Global test loss: 1.261, Global test accuracy: 58.82
Round  13, Train loss: 0.917, Test loss: 0.817, Test accuracy: 70.44
Round  13, Global train loss: 0.917, Global test loss: 1.532, Global test accuracy: 50.40
Round  14, Train loss: 0.773, Test loss: 0.786, Test accuracy: 71.44
Round  14, Global train loss: 0.773, Global test loss: 1.366, Global test accuracy: 55.32
Round  15, Train loss: 0.774, Test loss: 0.822, Test accuracy: 70.44
Round  15, Global train loss: 0.774, Global test loss: 1.357, Global test accuracy: 55.92
Round  16, Train loss: 0.851, Test loss: 0.798, Test accuracy: 70.94
Round  16, Global train loss: 0.851, Global test loss: 1.333, Global test accuracy: 57.32
Round  17, Train loss: 0.890, Test loss: 0.780, Test accuracy: 71.94
Round  17, Global train loss: 0.890, Global test loss: 1.409, Global test accuracy: 55.26
Round  18, Train loss: 0.735, Test loss: 0.775, Test accuracy: 72.44
Round  18, Global train loss: 0.735, Global test loss: 1.170, Global test accuracy: 60.94
Round  19, Train loss: 0.792, Test loss: 0.766, Test accuracy: 72.94
Round  19, Global train loss: 0.792, Global test loss: 1.368, Global test accuracy: 57.02
Round  20, Train loss: 0.737, Test loss: 0.753, Test accuracy: 73.54
Round  20, Global train loss: 0.737, Global test loss: 1.255, Global test accuracy: 57.74
Round  21, Train loss: 0.697, Test loss: 0.747, Test accuracy: 74.22
Round  21, Global train loss: 0.697, Global test loss: 1.349, Global test accuracy: 56.80
Round  22, Train loss: 0.699, Test loss: 0.720, Test accuracy: 75.64
Round  22, Global train loss: 0.699, Global test loss: 1.142, Global test accuracy: 62.90
Round  23, Train loss: 0.618, Test loss: 0.713, Test accuracy: 75.56
Round  23, Global train loss: 0.618, Global test loss: 1.119, Global test accuracy: 64.14
Round  24, Train loss: 0.579, Test loss: 0.697, Test accuracy: 76.36
Round  24, Global train loss: 0.579, Global test loss: 1.190, Global test accuracy: 62.72
Round  25, Train loss: 0.689, Test loss: 0.710, Test accuracy: 76.42
Round  25, Global train loss: 0.689, Global test loss: 1.328, Global test accuracy: 59.84
Round  26, Train loss: 0.600, Test loss: 0.745, Test accuracy: 75.16
Round  26, Global train loss: 0.600, Global test loss: 1.037, Global test accuracy: 65.92
Round  27, Train loss: 0.636, Test loss: 0.748, Test accuracy: 75.70
Round  27, Global train loss: 0.636, Global test loss: 1.132, Global test accuracy: 61.76
Round  28, Train loss: 0.618, Test loss: 0.734, Test accuracy: 76.44
Round  28, Global train loss: 0.618, Global test loss: 1.287, Global test accuracy: 58.18
Round  29, Train loss: 0.494, Test loss: 0.737, Test accuracy: 76.36
Round  29, Global train loss: 0.494, Global test loss: 1.139, Global test accuracy: 63.16
Round  30, Train loss: 0.471, Test loss: 0.739, Test accuracy: 76.02
Round  30, Global train loss: 0.471, Global test loss: 1.247, Global test accuracy: 63.00
Round  31, Train loss: 0.532, Test loss: 0.729, Test accuracy: 76.32
Round  31, Global train loss: 0.532, Global test loss: 1.079, Global test accuracy: 64.66
Round  32, Train loss: 0.418, Test loss: 0.721, Test accuracy: 76.62
Round  32, Global train loss: 0.418, Global test loss: 1.206, Global test accuracy: 64.56
Round  33, Train loss: 0.551, Test loss: 0.672, Test accuracy: 78.58
Round  33, Global train loss: 0.551, Global test loss: 1.154, Global test accuracy: 62.92
Round  34, Train loss: 0.486, Test loss: 0.666, Test accuracy: 78.12
Round  34, Global train loss: 0.486, Global test loss: 1.016, Global test accuracy: 66.86
Round  35, Train loss: 0.447, Test loss: 0.672, Test accuracy: 77.66
Round  35, Global train loss: 0.447, Global test loss: 1.398, Global test accuracy: 60.28
Round  36, Train loss: 0.470, Test loss: 0.672, Test accuracy: 77.64
Round  36, Global train loss: 0.470, Global test loss: 1.157, Global test accuracy: 62.96
Round  37, Train loss: 0.489, Test loss: 0.648, Test accuracy: 78.46
Round  37, Global train loss: 0.489, Global test loss: 1.246, Global test accuracy: 60.18
Round  38, Train loss: 0.462, Test loss: 0.640, Test accuracy: 79.10
Round  38, Global train loss: 0.462, Global test loss: 0.927, Global test accuracy: 69.40
Round  39, Train loss: 0.484, Test loss: 0.642, Test accuracy: 79.10
Round  39, Global train loss: 0.484, Global test loss: 1.164, Global test accuracy: 64.00
Round  40, Train loss: 0.458, Test loss: 0.677, Test accuracy: 78.30
Round  40, Global train loss: 0.458, Global test loss: 1.077, Global test accuracy: 67.22
Round  41, Train loss: 0.382, Test loss: 0.704, Test accuracy: 78.36
Round  41, Global train loss: 0.382, Global test loss: 1.135, Global test accuracy: 65.06
Round  42, Train loss: 0.433, Test loss: 0.675, Test accuracy: 79.00
Round  42, Global train loss: 0.433, Global test loss: 1.029, Global test accuracy: 66.12
Round  43, Train loss: 0.401, Test loss: 0.725, Test accuracy: 77.80
Round  43, Global train loss: 0.401, Global test loss: 1.419, Global test accuracy: 58.04
Round  44, Train loss: 0.338, Test loss: 0.728, Test accuracy: 78.22
Round  44, Global train loss: 0.338, Global test loss: 1.492, Global test accuracy: 58.58
Round  45, Train loss: 0.439, Test loss: 0.743, Test accuracy: 78.08
Round  45, Global train loss: 0.439, Global test loss: 0.977, Global test accuracy: 69.88
Round  46, Train loss: 0.379, Test loss: 0.734, Test accuracy: 78.04
Round  46, Global train loss: 0.379, Global test loss: 1.031, Global test accuracy: 68.88
Round  47, Train loss: 0.383, Test loss: 0.727, Test accuracy: 78.46
Round  47, Global train loss: 0.383, Global test loss: 1.059, Global test accuracy: 69.00
Round  48, Train loss: 0.394, Test loss: 0.721, Test accuracy: 78.50
Round  48, Global train loss: 0.394, Global test loss: 1.149, Global test accuracy: 65.82
Round  49, Train loss: 0.366, Test loss: 0.727, Test accuracy: 79.18
Round  49, Global train loss: 0.366, Global test loss: 1.229, Global test accuracy: 65.24
Round  50, Train loss: 0.324, Test loss: 0.727, Test accuracy: 78.92
Round  50, Global train loss: 0.324, Global test loss: 1.176, Global test accuracy: 66.16
Round  51, Train loss: 0.323, Test loss: 0.737, Test accuracy: 78.96
Round  51, Global train loss: 0.323, Global test loss: 1.428, Global test accuracy: 64.72
Round  52, Train loss: 0.292, Test loss: 0.766, Test accuracy: 78.40
Round  52, Global train loss: 0.292, Global test loss: 1.126, Global test accuracy: 68.78
Round  53, Train loss: 0.309, Test loss: 0.774, Test accuracy: 78.46
Round  53, Global train loss: 0.309, Global test loss: 1.058, Global test accuracy: 67.90
Round  54, Train loss: 0.391, Test loss: 0.730, Test accuracy: 79.08
Round  54, Global train loss: 0.391, Global test loss: 1.228, Global test accuracy: 65.94
Round  55, Train loss: 0.294, Test loss: 0.749, Test accuracy: 78.74
Round  55, Global train loss: 0.294, Global test loss: 1.192, Global test accuracy: 67.18
Round  56, Train loss: 0.272, Test loss: 0.744, Test accuracy: 79.38
Round  56, Global train loss: 0.272, Global test loss: 1.027, Global test accuracy: 70.34
Round  57, Train loss: 0.293, Test loss: 0.788, Test accuracy: 78.66
Round  57, Global train loss: 0.293, Global test loss: 0.993, Global test accuracy: 71.10
Round  58, Train loss: 0.233, Test loss: 0.772, Test accuracy: 79.06
Round  58, Global train loss: 0.233, Global test loss: 1.119, Global test accuracy: 69.08
Round  59, Train loss: 0.356, Test loss: 0.772, Test accuracy: 79.20
Round  59, Global train loss: 0.356, Global test loss: 1.067, Global test accuracy: 69.98
Round  60, Train loss: 0.305, Test loss: 0.787, Test accuracy: 78.76
Round  60, Global train loss: 0.305, Global test loss: 1.141, Global test accuracy: 68.90
Round  61, Train loss: 0.289, Test loss: 0.769, Test accuracy: 79.30
Round  61, Global train loss: 0.289, Global test loss: 1.138, Global test accuracy: 68.12
Round  62, Train loss: 0.212, Test loss: 0.783, Test accuracy: 78.96
Round  62, Global train loss: 0.212, Global test loss: 1.055, Global test accuracy: 69.74
Round  63, Train loss: 0.236, Test loss: 0.767, Test accuracy: 79.64
Round  63, Global train loss: 0.236, Global test loss: 1.214, Global test accuracy: 68.16
Round  64, Train loss: 0.261, Test loss: 0.768, Test accuracy: 79.88
Round  64, Global train loss: 0.261, Global test loss: 1.125, Global test accuracy: 70.52
Round  65, Train loss: 0.252, Test loss: 0.748, Test accuracy: 80.20
Round  65, Global train loss: 0.252, Global test loss: 1.059, Global test accuracy: 70.36
Round  66, Train loss: 0.188, Test loss: 0.766, Test accuracy: 79.62
Round  66, Global train loss: 0.188, Global test loss: 1.107, Global test accuracy: 70.04
Round  67, Train loss: 0.231, Test loss: 0.776, Test accuracy: 79.04
Round  67, Global train loss: 0.231, Global test loss: 1.092, Global test accuracy: 70.02
Round  68, Train loss: 0.184, Test loss: 0.794, Test accuracy: 78.80
Round  68, Global train loss: 0.184, Global test loss: 1.103, Global test accuracy: 70.14
Round  69, Train loss: 0.229, Test loss: 0.806, Test accuracy: 78.80
Round  69, Global train loss: 0.229, Global test loss: 1.084, Global test accuracy: 69.56
Round  70, Train loss: 0.200, Test loss: 0.804, Test accuracy: 79.54
Round  70, Global train loss: 0.200, Global test loss: 1.077, Global test accuracy: 71.36
Round  71, Train loss: 0.246, Test loss: 0.772, Test accuracy: 80.30
Round  71, Global train loss: 0.246, Global test loss: 1.014, Global test accuracy: 72.90
Round  72, Train loss: 0.220, Test loss: 0.779, Test accuracy: 79.88
Round  72, Global train loss: 0.220, Global test loss: 1.067, Global test accuracy: 69.56
Round  73, Train loss: 0.160, Test loss: 0.784, Test accuracy: 80.24
Round  73, Global train loss: 0.160, Global test loss: 1.109, Global test accuracy: 69.82
Round  74, Train loss: 0.138, Test loss: 0.763, Test accuracy: 81.02
Round  74, Global train loss: 0.138, Global test loss: 1.378, Global test accuracy: 68.38
Round  75, Train loss: 0.242, Test loss: 0.767, Test accuracy: 81.70
Round  75, Global train loss: 0.242, Global test loss: 1.052, Global test accuracy: 71.98
Round  76, Train loss: 0.151, Test loss: 0.778, Test accuracy: 80.98
Round  76, Global train loss: 0.151, Global test loss: 1.036, Global test accuracy: 72.34
Round  77, Train loss: 0.209, Test loss: 0.807, Test accuracy: 80.20
Round  77, Global train loss: 0.209, Global test loss: 1.132, Global test accuracy: 70.32
Round  78, Train loss: 0.188, Test loss: 0.797, Test accuracy: 80.40
Round  78, Global train loss: 0.188, Global test loss: 1.215, Global test accuracy: 70.26
Round  79, Train loss: 0.181, Test loss: 0.755, Test accuracy: 81.14
Round  79, Global train loss: 0.181, Global test loss: 1.270, Global test accuracy: 70.02
Round  80, Train loss: 0.199, Test loss: 0.799, Test accuracy: 80.52
Round  80, Global train loss: 0.199, Global test loss: 1.186, Global test accuracy: 69.88
Round  81, Train loss: 0.207, Test loss: 0.804, Test accuracy: 80.54
Round  81, Global train loss: 0.207, Global test loss: 1.235, Global test accuracy: 69.96
Round  82, Train loss: 0.132, Test loss: 0.789, Test accuracy: 80.56
Round  82, Global train loss: 0.132, Global test loss: 1.209, Global test accuracy: 71.06
Round  83, Train loss: 0.170, Test loss: 0.801, Test accuracy: 80.74
Round  83, Global train loss: 0.170, Global test loss: 1.090, Global test accuracy: 71.34
Round  84, Train loss: 0.231, Test loss: 0.803, Test accuracy: 80.54
Round  84, Global train loss: 0.231, Global test loss: 1.310, Global test accuracy: 67.66
Round  85, Train loss: 0.170, Test loss: 0.822, Test accuracy: 80.66
Round  85, Global train loss: 0.170, Global test loss: 1.101, Global test accuracy: 71.46
Round  86, Train loss: 0.176, Test loss: 0.839, Test accuracy: 80.78
Round  86, Global train loss: 0.176, Global test loss: 1.130, Global test accuracy: 72.70
Round  87, Train loss: 0.180, Test loss: 0.811, Test accuracy: 81.12
Round  87, Global train loss: 0.180, Global test loss: 1.233, Global test accuracy: 70.26
Round  88, Train loss: 0.131, Test loss: 0.837, Test accuracy: 80.68
Round  88, Global train loss: 0.131, Global test loss: 1.127, Global test accuracy: 71.06
Round  89, Train loss: 0.177, Test loss: 0.862, Test accuracy: 80.54
Round  89, Global train loss: 0.177, Global test loss: 1.291, Global test accuracy: 70.88
Round  90, Train loss: 0.148, Test loss: 0.867, Test accuracy: 80.54
Round  90, Global train loss: 0.148, Global test loss: 1.253, Global test accuracy: 70.32
Round  91, Train loss: 0.175, Test loss: 0.863, Test accuracy: 80.64
Round  91, Global train loss: 0.175, Global test loss: 1.240, Global test accuracy: 70.68
Round  92, Train loss: 0.168, Test loss: 0.836, Test accuracy: 81.26
Round  92, Global train loss: 0.168, Global test loss: 1.182, Global test accuracy: 70.54
Round  93, Train loss: 0.148, Test loss: 0.825, Test accuracy: 81.34
Round  93, Global train loss: 0.148, Global test loss: 1.155, Global test accuracy: 69.96
Round  94, Train loss: 0.122, Test loss: 0.827, Test accuracy: 81.16
Round  94, Global train loss: 0.122, Global test loss: 1.149, Global test accuracy: 71.58
Round  95, Train loss: 0.164, Test loss: 0.873, Test accuracy: 80.44
Round  95, Global train loss: 0.164, Global test loss: 1.171, Global test accuracy: 72.50/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 0.123, Test loss: 0.871, Test accuracy: 80.60
Round  96, Global train loss: 0.123, Global test loss: 1.186, Global test accuracy: 72.04
Round  97, Train loss: 0.144, Test loss: 0.870, Test accuracy: 80.96
Round  97, Global train loss: 0.144, Global test loss: 1.158, Global test accuracy: 72.30
Round  98, Train loss: 0.167, Test loss: 0.910, Test accuracy: 80.46
Round  98, Global train loss: 0.167, Global test loss: 1.275, Global test accuracy: 70.82
Round  99, Train loss: 0.135, Test loss: 0.914, Test accuracy: 80.30
Round  99, Global train loss: 0.135, Global test loss: 1.143, Global test accuracy: 72.14
Final Round, Train loss: 0.103, Test loss: 0.871, Test accuracy: 81.76
Final Round, Global train loss: 0.103, Global test loss: 1.143, Global test accuracy: 72.14
Average accuracy final 10 rounds: 80.77000000000001 

Average global accuracy final 10 rounds: 71.288 

1030.4392862319946
[2.0518736839294434, 4.103747367858887, 5.725555419921875, 7.347363471984863, 8.911802053451538, 10.476240634918213, 12.180360555648804, 13.884480476379395, 15.580202341079712, 17.27592420578003, 19.037748336791992, 20.799572467803955, 22.695380926132202, 24.59118938446045, 26.216688871383667, 27.842188358306885, 29.593485355377197, 31.34478235244751, 33.040424823760986, 34.73606729507446, 36.38499093055725, 38.03391456604004, 39.67320537567139, 41.312496185302734, 42.947726011276245, 44.582955837249756, 46.27715182304382, 47.97134780883789, 49.7484176158905, 51.525487422943115, 53.08282518386841, 54.6401629447937, 56.324472188949585, 58.00878143310547, 59.74176549911499, 61.47474956512451, 63.06825876235962, 64.66176795959473, 66.64171600341797, 68.62166404724121, 70.13930416107178, 71.65694427490234, 73.43348526954651, 75.21002626419067, 76.88965439796448, 78.56928253173828, 80.2401282787323, 81.91097402572632, 83.87529468536377, 85.83961534500122, 87.46701574325562, 89.09441614151001, 90.79087495803833, 92.48733377456665, 94.15367841720581, 95.82002305984497, 97.51228189468384, 99.2045407295227, 100.81644582748413, 102.42835092544556, 104.05049896240234, 105.67264699935913, 107.40135478973389, 109.13006258010864, 110.81650471687317, 112.5029468536377, 114.12721300125122, 115.75147914886475, 117.54858374595642, 119.3456883430481, 121.11704754829407, 122.88840675354004, 124.49185943603516, 126.09531211853027, 127.69970083236694, 129.3040895462036, 130.8969156742096, 132.48974180221558, 134.08064937591553, 135.67155694961548, 137.29470205307007, 138.91784715652466, 140.55874109268188, 142.1996350288391, 143.77059960365295, 145.3415641784668, 146.84934878349304, 148.3571333885193, 150.03553986549377, 151.71394634246826, 153.35833048820496, 155.00271463394165, 156.81651091575623, 158.6303071975708, 160.21918487548828, 161.80806255340576, 163.31162428855896, 164.81518602371216, 166.3734474182129, 167.93170881271362, 169.60861921310425, 171.28552961349487, 172.98797702789307, 174.69042444229126, 176.27265906333923, 177.8548936843872, 179.64320945739746, 181.43152523040771, 183.1072428226471, 184.78296041488647, 186.5261209011078, 188.2692813873291, 189.98315596580505, 191.697030544281, 193.32665514945984, 194.95627975463867, 196.5855598449707, 198.21483993530273, 199.750586271286, 201.2863326072693, 202.94546627998352, 204.60459995269775, 206.19214177131653, 207.7796835899353, 209.92344522476196, 212.06720685958862, 214.07694387435913, 216.08668088912964, 218.10706639289856, 220.12745189666748, 221.9790997505188, 223.83074760437012, 225.5639190673828, 227.2970905303955, 228.89578223228455, 230.49447393417358, 232.13570356369019, 233.7769331932068, 235.4195203781128, 237.0621075630188, 238.63330745697021, 240.20450735092163, 241.7786591053009, 243.35281085968018, 244.96030497550964, 246.5677990913391, 248.31357336044312, 250.05934762954712, 251.61697125434875, 253.1745948791504, 254.80313301086426, 256.4316711425781, 258.032114982605, 259.63255882263184, 261.23487544059753, 262.83719205856323, 264.7790720462799, 266.7209520339966, 268.7566659450531, 270.7923798561096, 272.4775228500366, 274.1626658439636, 275.7436406612396, 277.3246154785156, 279.35806488990784, 281.39151430130005, 283.0566658973694, 284.7218174934387, 286.425972700119, 288.1301279067993, 289.919730424881, 291.70933294296265, 293.3534531593323, 294.9975733757019, 296.58840823173523, 298.17924308776855, 299.86646819114685, 301.55369329452515, 303.11161041259766, 304.66952753067017, 306.30696201324463, 307.9443964958191, 309.60040187835693, 311.2564072608948, 313.2987105846405, 315.34101390838623, 317.3515102863312, 319.3620066642761, 321.20850920677185, 323.0550117492676, 324.8070912361145, 326.5591707229614, 328.13982033729553, 329.72046995162964, 331.37945675849915, 333.03844356536865, 334.70127987861633, 336.364116191864, 338.17946553230286, 339.9948148727417, 343.5509798526764, 347.1071448326111]
[28.4, 28.4, 34.7, 34.7, 39.56, 39.56, 45.34, 45.34, 51.16, 51.16, 60.36, 60.36, 58.58, 58.58, 61.62, 61.62, 65.18, 65.18, 66.02, 66.02, 66.7, 66.7, 67.22, 67.22, 68.24, 68.24, 70.44, 70.44, 71.44, 71.44, 70.44, 70.44, 70.94, 70.94, 71.94, 71.94, 72.44, 72.44, 72.94, 72.94, 73.54, 73.54, 74.22, 74.22, 75.64, 75.64, 75.56, 75.56, 76.36, 76.36, 76.42, 76.42, 75.16, 75.16, 75.7, 75.7, 76.44, 76.44, 76.36, 76.36, 76.02, 76.02, 76.32, 76.32, 76.62, 76.62, 78.58, 78.58, 78.12, 78.12, 77.66, 77.66, 77.64, 77.64, 78.46, 78.46, 79.1, 79.1, 79.1, 79.1, 78.3, 78.3, 78.36, 78.36, 79.0, 79.0, 77.8, 77.8, 78.22, 78.22, 78.08, 78.08, 78.04, 78.04, 78.46, 78.46, 78.5, 78.5, 79.18, 79.18, 78.92, 78.92, 78.96, 78.96, 78.4, 78.4, 78.46, 78.46, 79.08, 79.08, 78.74, 78.74, 79.38, 79.38, 78.66, 78.66, 79.06, 79.06, 79.2, 79.2, 78.76, 78.76, 79.3, 79.3, 78.96, 78.96, 79.64, 79.64, 79.88, 79.88, 80.2, 80.2, 79.62, 79.62, 79.04, 79.04, 78.8, 78.8, 78.8, 78.8, 79.54, 79.54, 80.3, 80.3, 79.88, 79.88, 80.24, 80.24, 81.02, 81.02, 81.7, 81.7, 80.98, 80.98, 80.2, 80.2, 80.4, 80.4, 81.14, 81.14, 80.52, 80.52, 80.54, 80.54, 80.56, 80.56, 80.74, 80.74, 80.54, 80.54, 80.66, 80.66, 80.78, 80.78, 81.12, 81.12, 80.68, 80.68, 80.54, 80.54, 80.54, 80.54, 80.64, 80.64, 81.26, 81.26, 81.34, 81.34, 81.16, 81.16, 80.44, 80.44, 80.6, 80.6, 80.96, 80.96, 80.46, 80.46, 80.3, 80.3, 81.76, 81.76]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.650, Test loss: 2.268, Test accuracy: 24.82
Round   0, Global train loss: 1.650, Global test loss: 2.438, Global test accuracy: 21.50
Round   1, Train loss: 1.461, Test loss: 1.604, Test accuracy: 40.52
Round   1, Global train loss: 1.461, Global test loss: 1.942, Global test accuracy: 33.46
Round   2, Train loss: 1.491, Test loss: 1.621, Test accuracy: 43.26
Round   2, Global train loss: 1.491, Global test loss: 2.575, Global test accuracy: 23.20
Round   3, Train loss: 1.357, Test loss: 1.548, Test accuracy: 46.40
Round   3, Global train loss: 1.357, Global test loss: 2.628, Global test accuracy: 25.12
Round   4, Train loss: 1.232, Test loss: 1.231, Test accuracy: 54.62
Round   4, Global train loss: 1.232, Global test loss: 1.791, Global test accuracy: 39.44
Round   5, Train loss: 1.156, Test loss: 1.246, Test accuracy: 52.98
Round   5, Global train loss: 1.156, Global test loss: 1.779, Global test accuracy: 40.14
Round   6, Train loss: 1.090, Test loss: 1.247, Test accuracy: 54.22
Round   6, Global train loss: 1.090, Global test loss: 1.929, Global test accuracy: 39.68
Round   7, Train loss: 1.182, Test loss: 1.152, Test accuracy: 57.68
Round   7, Global train loss: 1.182, Global test loss: 1.639, Global test accuracy: 43.22
Round   8, Train loss: 1.047, Test loss: 1.208, Test accuracy: 57.28
Round   8, Global train loss: 1.047, Global test loss: 1.791, Global test accuracy: 41.76
Round   9, Train loss: 0.998, Test loss: 1.150, Test accuracy: 59.24
Round   9, Global train loss: 0.998, Global test loss: 1.840, Global test accuracy: 40.24
Round  10, Train loss: 0.962, Test loss: 1.110, Test accuracy: 60.18
Round  10, Global train loss: 0.962, Global test loss: 1.562, Global test accuracy: 46.82
Round  11, Train loss: 0.919, Test loss: 1.161, Test accuracy: 59.52
Round  11, Global train loss: 0.919, Global test loss: 1.877, Global test accuracy: 42.66
Round  12, Train loss: 0.860, Test loss: 1.041, Test accuracy: 62.14
Round  12, Global train loss: 0.860, Global test loss: 1.375, Global test accuracy: 53.88
Round  13, Train loss: 0.974, Test loss: 0.950, Test accuracy: 65.56
Round  13, Global train loss: 0.974, Global test loss: 1.504, Global test accuracy: 52.02
Round  14, Train loss: 0.760, Test loss: 0.844, Test accuracy: 68.82
Round  14, Global train loss: 0.760, Global test loss: 1.693, Global test accuracy: 48.16
Round  15, Train loss: 0.707, Test loss: 0.803, Test accuracy: 70.42
Round  15, Global train loss: 0.707, Global test loss: 1.429, Global test accuracy: 51.06
Round  16, Train loss: 0.759, Test loss: 0.782, Test accuracy: 71.24
Round  16, Global train loss: 0.759, Global test loss: 1.216, Global test accuracy: 59.08
Round  17, Train loss: 0.700, Test loss: 0.786, Test accuracy: 71.46
Round  17, Global train loss: 0.700, Global test loss: 1.245, Global test accuracy: 57.66
Round  18, Train loss: 0.646, Test loss: 0.778, Test accuracy: 72.40
Round  18, Global train loss: 0.646, Global test loss: 1.201, Global test accuracy: 59.02
Round  19, Train loss: 0.682, Test loss: 0.787, Test accuracy: 72.14
Round  19, Global train loss: 0.682, Global test loss: 1.141, Global test accuracy: 63.42
Round  20, Train loss: 0.658, Test loss: 0.761, Test accuracy: 73.34
Round  20, Global train loss: 0.658, Global test loss: 1.449, Global test accuracy: 53.36
Round  21, Train loss: 0.713, Test loss: 0.742, Test accuracy: 74.00
Round  21, Global train loss: 0.713, Global test loss: 1.562, Global test accuracy: 48.50
Round  22, Train loss: 0.568, Test loss: 0.748, Test accuracy: 73.74
Round  22, Global train loss: 0.568, Global test loss: 1.445, Global test accuracy: 53.62
Round  23, Train loss: 0.593, Test loss: 0.736, Test accuracy: 74.56
Round  23, Global train loss: 0.593, Global test loss: 1.199, Global test accuracy: 60.78
Round  24, Train loss: 0.597, Test loss: 0.752, Test accuracy: 74.30
Round  24, Global train loss: 0.597, Global test loss: 1.189, Global test accuracy: 62.08
Round  25, Train loss: 0.538, Test loss: 0.722, Test accuracy: 74.96
Round  25, Global train loss: 0.538, Global test loss: 1.364, Global test accuracy: 57.06
Round  26, Train loss: 0.580, Test loss: 0.709, Test accuracy: 75.56
Round  26, Global train loss: 0.580, Global test loss: 1.035, Global test accuracy: 66.18
Round  27, Train loss: 0.518, Test loss: 0.681, Test accuracy: 76.64
Round  27, Global train loss: 0.518, Global test loss: 1.131, Global test accuracy: 63.44
Round  28, Train loss: 0.495, Test loss: 0.708, Test accuracy: 75.92
Round  28, Global train loss: 0.495, Global test loss: 1.159, Global test accuracy: 63.80
Round  29, Train loss: 0.639, Test loss: 0.655, Test accuracy: 78.04
Round  29, Global train loss: 0.639, Global test loss: 1.056, Global test accuracy: 64.98
Round  30, Train loss: 0.510, Test loss: 0.662, Test accuracy: 78.30
Round  30, Global train loss: 0.510, Global test loss: 1.173, Global test accuracy: 62.28
Round  31, Train loss: 0.467, Test loss: 0.667, Test accuracy: 78.14
Round  31, Global train loss: 0.467, Global test loss: 1.005, Global test accuracy: 66.44
Round  32, Train loss: 0.409, Test loss: 0.706, Test accuracy: 77.40
Round  32, Global train loss: 0.409, Global test loss: 1.071, Global test accuracy: 65.06
Round  33, Train loss: 0.469, Test loss: 0.679, Test accuracy: 77.96
Round  33, Global train loss: 0.469, Global test loss: 1.254, Global test accuracy: 60.54
Round  34, Train loss: 0.482, Test loss: 0.695, Test accuracy: 77.94
Round  34, Global train loss: 0.482, Global test loss: 1.061, Global test accuracy: 66.38
Round  35, Train loss: 0.466, Test loss: 0.697, Test accuracy: 77.62
Round  35, Global train loss: 0.466, Global test loss: 1.245, Global test accuracy: 63.04
Round  36, Train loss: 0.523, Test loss: 0.700, Test accuracy: 77.86
Round  36, Global train loss: 0.523, Global test loss: 1.212, Global test accuracy: 64.34
Round  37, Train loss: 0.361, Test loss: 0.709, Test accuracy: 77.70
Round  37, Global train loss: 0.361, Global test loss: 1.225, Global test accuracy: 65.58
Round  38, Train loss: 0.492, Test loss: 0.727, Test accuracy: 77.30
Round  38, Global train loss: 0.492, Global test loss: 0.944, Global test accuracy: 67.92
Round  39, Train loss: 0.327, Test loss: 0.720, Test accuracy: 77.28
Round  39, Global train loss: 0.327, Global test loss: 1.079, Global test accuracy: 68.34
Round  40, Train loss: 0.419, Test loss: 0.705, Test accuracy: 78.16
Round  40, Global train loss: 0.419, Global test loss: 0.982, Global test accuracy: 70.14
Round  41, Train loss: 0.377, Test loss: 0.687, Test accuracy: 78.78
Round  41, Global train loss: 0.377, Global test loss: 1.040, Global test accuracy: 69.16
Round  42, Train loss: 0.383, Test loss: 0.711, Test accuracy: 78.08
Round  42, Global train loss: 0.383, Global test loss: 1.176, Global test accuracy: 64.38
Round  43, Train loss: 0.424, Test loss: 0.716, Test accuracy: 77.94
Round  43, Global train loss: 0.424, Global test loss: 1.320, Global test accuracy: 63.54
Round  44, Train loss: 0.351, Test loss: 0.738, Test accuracy: 77.70
Round  44, Global train loss: 0.351, Global test loss: 0.992, Global test accuracy: 69.84
Round  45, Train loss: 0.277, Test loss: 0.735, Test accuracy: 77.88
Round  45, Global train loss: 0.277, Global test loss: 1.127, Global test accuracy: 65.22
Round  46, Train loss: 0.339, Test loss: 0.732, Test accuracy: 78.14
Round  46, Global train loss: 0.339, Global test loss: 1.018, Global test accuracy: 67.98
Round  47, Train loss: 0.312, Test loss: 0.715, Test accuracy: 78.78
Round  47, Global train loss: 0.312, Global test loss: 1.071, Global test accuracy: 69.62
Round  48, Train loss: 0.310, Test loss: 0.711, Test accuracy: 78.42
Round  48, Global train loss: 0.310, Global test loss: 1.202, Global test accuracy: 67.82
Round  49, Train loss: 0.377, Test loss: 0.725, Test accuracy: 78.32
Round  49, Global train loss: 0.377, Global test loss: 1.243, Global test accuracy: 65.08
Round  50, Train loss: 0.359, Test loss: 0.736, Test accuracy: 78.12
Round  50, Global train loss: 0.359, Global test loss: 1.211, Global test accuracy: 64.04
Round  51, Train loss: 0.331, Test loss: 0.730, Test accuracy: 78.32
Round  51, Global train loss: 0.331, Global test loss: 1.070, Global test accuracy: 69.06
Round  52, Train loss: 0.312, Test loss: 0.753, Test accuracy: 77.92
Round  52, Global train loss: 0.312, Global test loss: 1.078, Global test accuracy: 67.20
Round  53, Train loss: 0.262, Test loss: 0.770, Test accuracy: 77.86
Round  53, Global train loss: 0.262, Global test loss: 1.237, Global test accuracy: 65.58
Round  54, Train loss: 0.301, Test loss: 0.792, Test accuracy: 78.24
Round  54, Global train loss: 0.301, Global test loss: 1.130, Global test accuracy: 69.30
Round  55, Train loss: 0.289, Test loss: 0.774, Test accuracy: 78.68
Round  55, Global train loss: 0.289, Global test loss: 1.099, Global test accuracy: 70.12
Round  56, Train loss: 0.318, Test loss: 0.758, Test accuracy: 79.40
Round  56, Global train loss: 0.318, Global test loss: 1.115, Global test accuracy: 67.22
Round  57, Train loss: 0.277, Test loss: 0.771, Test accuracy: 79.04
Round  57, Global train loss: 0.277, Global test loss: 0.975, Global test accuracy: 70.48
Round  58, Train loss: 0.234, Test loss: 0.752, Test accuracy: 79.58
Round  58, Global train loss: 0.234, Global test loss: 1.311, Global test accuracy: 65.30
Round  59, Train loss: 0.257, Test loss: 0.771, Test accuracy: 79.62
Round  59, Global train loss: 0.257, Global test loss: 1.305, Global test accuracy: 67.88
Round  60, Train loss: 0.243, Test loss: 0.779, Test accuracy: 79.18
Round  60, Global train loss: 0.243, Global test loss: 1.206, Global test accuracy: 66.20
Round  61, Train loss: 0.280, Test loss: 0.822, Test accuracy: 79.02
Round  61, Global train loss: 0.280, Global test loss: 1.130, Global test accuracy: 68.44
Round  62, Train loss: 0.224, Test loss: 0.819, Test accuracy: 79.24
Round  62, Global train loss: 0.224, Global test loss: 0.952, Global test accuracy: 71.44
Round  63, Train loss: 0.234, Test loss: 0.799, Test accuracy: 79.62
Round  63, Global train loss: 0.234, Global test loss: 1.174, Global test accuracy: 69.94
Round  64, Train loss: 0.247, Test loss: 0.770, Test accuracy: 79.68
Round  64, Global train loss: 0.247, Global test loss: 1.308, Global test accuracy: 68.42
Round  65, Train loss: 0.182, Test loss: 0.768, Test accuracy: 79.92
Round  65, Global train loss: 0.182, Global test loss: 1.181, Global test accuracy: 69.22
Round  66, Train loss: 0.261, Test loss: 0.797, Test accuracy: 79.30
Round  66, Global train loss: 0.261, Global test loss: 1.173, Global test accuracy: 69.74
Round  67, Train loss: 0.194, Test loss: 0.802, Test accuracy: 79.48
Round  67, Global train loss: 0.194, Global test loss: 1.075, Global test accuracy: 71.76
Round  68, Train loss: 0.294, Test loss: 0.776, Test accuracy: 79.70
Round  68, Global train loss: 0.294, Global test loss: 1.035, Global test accuracy: 70.02
Round  69, Train loss: 0.232, Test loss: 0.785, Test accuracy: 79.72
Round  69, Global train loss: 0.232, Global test loss: 1.213, Global test accuracy: 66.70
Round  70, Train loss: 0.220, Test loss: 0.810, Test accuracy: 79.38
Round  70, Global train loss: 0.220, Global test loss: 1.432, Global test accuracy: 65.10
Round  71, Train loss: 0.197, Test loss: 0.819, Test accuracy: 79.34
Round  71, Global train loss: 0.197, Global test loss: 1.481, Global test accuracy: 67.44
Round  72, Train loss: 0.179, Test loss: 0.813, Test accuracy: 79.32
Round  72, Global train loss: 0.179, Global test loss: 1.067, Global test accuracy: 73.22
Round  73, Train loss: 0.138, Test loss: 0.808, Test accuracy: 79.72
Round  73, Global train loss: 0.138, Global test loss: 1.217, Global test accuracy: 70.82
Round  74, Train loss: 0.204, Test loss: 0.813, Test accuracy: 80.14
Round  74, Global train loss: 0.204, Global test loss: 1.024, Global test accuracy: 71.80
Round  75, Train loss: 0.141, Test loss: 0.790, Test accuracy: 80.66
Round  75, Global train loss: 0.141, Global test loss: 1.133, Global test accuracy: 70.56
Round  76, Train loss: 0.140, Test loss: 0.810, Test accuracy: 80.94
Round  76, Global train loss: 0.140, Global test loss: 1.476, Global test accuracy: 67.92
Round  77, Train loss: 0.166, Test loss: 0.805, Test accuracy: 80.52
Round  77, Global train loss: 0.166, Global test loss: 1.168, Global test accuracy: 71.28
Round  78, Train loss: 0.222, Test loss: 0.823, Test accuracy: 79.52
Round  78, Global train loss: 0.222, Global test loss: 1.180, Global test accuracy: 69.16
Round  79, Train loss: 0.151, Test loss: 0.812, Test accuracy: 79.98
Round  79, Global train loss: 0.151, Global test loss: 1.297, Global test accuracy: 68.48
Round  80, Train loss: 0.144, Test loss: 0.838, Test accuracy: 79.88
Round  80, Global train loss: 0.144, Global test loss: 1.100, Global test accuracy: 70.18
Round  81, Train loss: 0.137, Test loss: 0.846, Test accuracy: 79.76
Round  81, Global train loss: 0.137, Global test loss: 1.156, Global test accuracy: 72.56
Round  82, Train loss: 0.120, Test loss: 0.858, Test accuracy: 79.80
Round  82, Global train loss: 0.120, Global test loss: 1.264, Global test accuracy: 71.06
Round  83, Train loss: 0.181, Test loss: 0.875, Test accuracy: 79.54
Round  83, Global train loss: 0.181, Global test loss: 1.396, Global test accuracy: 68.64
Round  84, Train loss: 0.138, Test loss: 0.892, Test accuracy: 79.42
Round  84, Global train loss: 0.138, Global test loss: 1.333, Global test accuracy: 67.46
Round  85, Train loss: 0.114, Test loss: 0.893, Test accuracy: 79.78
Round  85, Global train loss: 0.114, Global test loss: 1.322, Global test accuracy: 67.98
Round  86, Train loss: 0.161, Test loss: 0.888, Test accuracy: 79.68
Round  86, Global train loss: 0.161, Global test loss: 1.164, Global test accuracy: 71.82
Round  87, Train loss: 0.120, Test loss: 0.878, Test accuracy: 79.64
Round  87, Global train loss: 0.120, Global test loss: 1.207, Global test accuracy: 69.58
Round  88, Train loss: 0.128, Test loss: 0.874, Test accuracy: 79.74
Round  88, Global train loss: 0.128, Global test loss: 1.438, Global test accuracy: 68.30
Round  89, Train loss: 0.107, Test loss: 0.850, Test accuracy: 80.18
Round  89, Global train loss: 0.107, Global test loss: 1.573, Global test accuracy: 65.76
Round  90, Train loss: 0.110, Test loss: 0.883, Test accuracy: 80.02
Round  90, Global train loss: 0.110, Global test loss: 1.244, Global test accuracy: 70.94
Round  91, Train loss: 0.109, Test loss: 0.877, Test accuracy: 80.16
Round  91, Global train loss: 0.109, Global test loss: 1.283, Global test accuracy: 70.68
Round  92, Train loss: 0.198, Test loss: 0.881, Test accuracy: 80.24
Round  92, Global train loss: 0.198, Global test loss: 1.418, Global test accuracy: 65.68
Round  93, Train loss: 0.130, Test loss: 0.877, Test accuracy: 80.24
Round  93, Global train loss: 0.130, Global test loss: 1.491, Global test accuracy: 64.60
Round  94, Train loss: 0.176, Test loss: 0.879, Test accuracy: 79.82
Round  94, Global train loss: 0.176, Global test loss: 1.309, Global test accuracy: 70.82
Round  95, Train loss: 0.076, Test loss: 0.865, Test accuracy: 80.52
Round  95, Global train loss: 0.076, Global test loss: 1.368, Global test accuracy: 67.40
Round  96, Train loss: 0.122, Test loss: 0.863, Test accuracy: 80.16
Round  96, Global train loss: 0.122, Global test loss: 1.078, Global test accuracy: 72.60
Round  97, Train loss: 0.126, Test loss: 0.860, Test accuracy: 80.52
Round  97, Global train loss: 0.126, Global test loss: 1.087, Global test accuracy: 72.26
Round  98, Train loss: 0.167, Test loss: 0.850, Test accuracy: 80.78
Round  98, Global train loss: 0.167, Global test loss: 1.119, Global test accuracy: 72.38
Round  99, Train loss: 0.110, Test loss: 0.862, Test accuracy: 80.82
Round  99, Global train loss: 0.110, Global test loss: 1.320, Global test accuracy: 69.54
Final Round, Train loss: 0.103, Test loss: 0.949, Test accuracy: 80.42
Final Round, Global train loss: 0.103, Global test loss: 1.320, Global test accuracy: 69.54
Average accuracy final 10 rounds: 80.328
Average global accuracy final 10 rounds: 69.69
1573.7624151706696
[3.9424185752868652, 7.923255681991577, 11.747934818267822, 16.603809118270874, 20.418864488601685, 24.292930841445923, 28.275556564331055, 32.57920980453491, 36.39285206794739, 40.67503356933594, 44.55013847351074, 48.41298484802246, 52.0399808883667, 55.98528695106506, 59.88853120803833, 63.84088158607483, 67.80392789840698, 71.75709819793701, 75.66698861122131, 79.58754110336304, 83.47321462631226, 87.20655369758606, 91.04268717765808, 94.94453310966492, 99.33954286575317, 103.94765543937683, 108.02852725982666, 112.04146885871887, 116.36377453804016, 120.3696403503418, 124.32790541648865, 128.1951642036438, 131.98536491394043, 135.74070692062378, 139.47819685935974, 143.30148148536682, 147.6456527709961, 151.50036644935608, 155.37233567237854, 159.24102067947388, 163.03362154960632, 166.79736304283142, 170.8044776916504, 174.85364294052124, 178.86014199256897, 182.93274688720703, 187.1789791584015, 191.2240641117096, 195.80010509490967, 200.25092554092407, 204.9650056362152, 208.7970325946808, 212.50748229026794, 216.29691433906555, 220.18079662322998, 224.07830500602722, 227.89837837219238, 231.81524801254272, 235.7535755634308, 239.55945801734924, 243.34052157402039, 247.1031994819641, 251.03061437606812, 254.9149296283722, 258.7663869857788, 262.6553955078125, 266.6823811531067, 270.555166721344, 274.7408974170685, 278.68856406211853, 282.5236051082611, 286.4257388114929, 290.2011408805847, 294.0871422290802, 298.0287458896637, 301.8196325302124, 305.7773323059082, 309.90318536758423, 313.84451699256897, 317.99699449539185, 322.13918828964233, 326.0452227592468, 330.0095410346985, 334.08391761779785, 338.03491592407227, 342.00836420059204, 346.0169632434845, 350.94504737854004, 354.84857654571533, 359.0369372367859, 362.87726521492004, 366.93644881248474, 370.8580300807953, 374.78735423088074, 378.67553329467773, 382.4797670841217, 386.2335352897644, 390.11065435409546, 393.9182593822479, 397.8486421108246, 405.84666109085083]
[24.82, 40.52, 43.26, 46.4, 54.62, 52.98, 54.22, 57.68, 57.28, 59.24, 60.18, 59.52, 62.14, 65.56, 68.82, 70.42, 71.24, 71.46, 72.4, 72.14, 73.34, 74.0, 73.74, 74.56, 74.3, 74.96, 75.56, 76.64, 75.92, 78.04, 78.3, 78.14, 77.4, 77.96, 77.94, 77.62, 77.86, 77.7, 77.3, 77.28, 78.16, 78.78, 78.08, 77.94, 77.7, 77.88, 78.14, 78.78, 78.42, 78.32, 78.12, 78.32, 77.92, 77.86, 78.24, 78.68, 79.4, 79.04, 79.58, 79.62, 79.18, 79.02, 79.24, 79.62, 79.68, 79.92, 79.3, 79.48, 79.7, 79.72, 79.38, 79.34, 79.32, 79.72, 80.14, 80.66, 80.94, 80.52, 79.52, 79.98, 79.88, 79.76, 79.8, 79.54, 79.42, 79.78, 79.68, 79.64, 79.74, 80.18, 80.02, 80.16, 80.24, 80.24, 79.82, 80.52, 80.16, 80.52, 80.78, 80.82, 80.42]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.959, Test loss: 2.289, Test accuracy: 13.38
Round   0, Global train loss: 1.959, Global test loss: 2.375, Global test accuracy: 12.40
Round   1, Train loss: 1.579, Test loss: 1.993, Test accuracy: 31.86
Round   1, Global train loss: 1.579, Global test loss: 2.365, Global test accuracy: 17.46
Round   2, Train loss: 1.371, Test loss: 1.758, Test accuracy: 38.98
Round   2, Global train loss: 1.371, Global test loss: 2.263, Global test accuracy: 27.00
Round   3, Train loss: 1.222, Test loss: 1.549, Test accuracy: 44.84
Round   3, Global train loss: 1.222, Global test loss: 2.236, Global test accuracy: 24.20
Round   4, Train loss: 1.308, Test loss: 1.214, Test accuracy: 55.14
Round   4, Global train loss: 1.308, Global test loss: 2.131, Global test accuracy: 28.64
Round   5, Train loss: 1.151, Test loss: 1.257, Test accuracy: 54.00
Round   5, Global train loss: 1.151, Global test loss: 2.268, Global test accuracy: 28.18
Round   6, Train loss: 1.229, Test loss: 1.158, Test accuracy: 56.68
Round   6, Global train loss: 1.229, Global test loss: 2.192, Global test accuracy: 27.82
Round   7, Train loss: 1.079, Test loss: 1.075, Test accuracy: 60.76
Round   7, Global train loss: 1.079, Global test loss: 1.812, Global test accuracy: 35.48
Round   8, Train loss: 1.002, Test loss: 0.983, Test accuracy: 62.28
Round   8, Global train loss: 1.002, Global test loss: 1.869, Global test accuracy: 47.38
Round   9, Train loss: 1.054, Test loss: 0.998, Test accuracy: 63.02
Round   9, Global train loss: 1.054, Global test loss: 1.878, Global test accuracy: 37.62
Round  10, Train loss: 1.023, Test loss: 0.914, Test accuracy: 67.44
Round  10, Global train loss: 1.023, Global test loss: 1.953, Global test accuracy: 35.50
Round  11, Train loss: 1.021, Test loss: 0.922, Test accuracy: 67.12
Round  11, Global train loss: 1.021, Global test loss: 2.272, Global test accuracy: 28.54
Round  12, Train loss: 0.944, Test loss: 0.867, Test accuracy: 69.44
Round  12, Global train loss: 0.944, Global test loss: 2.382, Global test accuracy: 24.98
Round  13, Train loss: 0.950, Test loss: 0.877, Test accuracy: 68.70
Round  13, Global train loss: 0.950, Global test loss: 2.129, Global test accuracy: 29.72
Round  14, Train loss: 0.819, Test loss: 0.880, Test accuracy: 69.36
Round  14, Global train loss: 0.819, Global test loss: 1.859, Global test accuracy: 31.00
Round  15, Train loss: 0.924, Test loss: 0.816, Test accuracy: 71.20
Round  15, Global train loss: 0.924, Global test loss: 2.070, Global test accuracy: 29.22
Round  16, Train loss: 0.765, Test loss: 0.791, Test accuracy: 72.02
Round  16, Global train loss: 0.765, Global test loss: 2.390, Global test accuracy: 37.36
Round  17, Train loss: 0.865, Test loss: 0.782, Test accuracy: 73.12
Round  17, Global train loss: 0.865, Global test loss: 2.429, Global test accuracy: 21.28
Round  18, Train loss: 0.745, Test loss: 0.720, Test accuracy: 74.92
Round  18, Global train loss: 0.745, Global test loss: 1.832, Global test accuracy: 37.14
Round  19, Train loss: 0.864, Test loss: 0.673, Test accuracy: 75.26
Round  19, Global train loss: 0.864, Global test loss: 1.786, Global test accuracy: 47.18
Round  20, Train loss: 0.787, Test loss: 0.702, Test accuracy: 75.92
Round  20, Global train loss: 0.787, Global test loss: 2.106, Global test accuracy: 38.80
Round  21, Train loss: 0.798, Test loss: 0.673, Test accuracy: 76.20
Round  21, Global train loss: 0.798, Global test loss: 2.312, Global test accuracy: 34.92
Round  22, Train loss: 0.691, Test loss: 0.645, Test accuracy: 77.46
Round  22, Global train loss: 0.691, Global test loss: 1.554, Global test accuracy: 51.12
Round  23, Train loss: 0.630, Test loss: 0.645, Test accuracy: 76.64
Round  23, Global train loss: 0.630, Global test loss: 2.139, Global test accuracy: 35.78
Round  24, Train loss: 0.653, Test loss: 0.664, Test accuracy: 77.08
Round  24, Global train loss: 0.653, Global test loss: 2.105, Global test accuracy: 40.98
Round  25, Train loss: 0.689, Test loss: 0.649, Test accuracy: 77.36
Round  25, Global train loss: 0.689, Global test loss: 1.683, Global test accuracy: 45.22
Round  26, Train loss: 0.671, Test loss: 0.645, Test accuracy: 77.20
Round  26, Global train loss: 0.671, Global test loss: 1.441, Global test accuracy: 48.20
Round  27, Train loss: 0.640, Test loss: 0.633, Test accuracy: 77.56
Round  27, Global train loss: 0.640, Global test loss: 2.103, Global test accuracy: 35.24
Round  28, Train loss: 0.655, Test loss: 0.624, Test accuracy: 77.90
Round  28, Global train loss: 0.655, Global test loss: 1.773, Global test accuracy: 46.34
Round  29, Train loss: 0.585, Test loss: 0.580, Test accuracy: 79.60
Round  29, Global train loss: 0.585, Global test loss: 1.426, Global test accuracy: 48.98
Round  30, Train loss: 0.623, Test loss: 0.590, Test accuracy: 79.68
Round  30, Global train loss: 0.623, Global test loss: 1.800, Global test accuracy: 41.52
Round  31, Train loss: 0.598, Test loss: 0.617, Test accuracy: 78.20
Round  31, Global train loss: 0.598, Global test loss: 1.709, Global test accuracy: 44.86
Round  32, Train loss: 0.640, Test loss: 0.592, Test accuracy: 79.16
Round  32, Global train loss: 0.640, Global test loss: 2.380, Global test accuracy: 40.32
Round  33, Train loss: 0.559, Test loss: 0.598, Test accuracy: 78.70
Round  33, Global train loss: 0.559, Global test loss: 1.619, Global test accuracy: 51.72
Round  34, Train loss: 0.615, Test loss: 0.592, Test accuracy: 79.56
Round  34, Global train loss: 0.615, Global test loss: 2.612, Global test accuracy: 32.26
Round  35, Train loss: 0.505, Test loss: 0.579, Test accuracy: 79.96
Round  35, Global train loss: 0.505, Global test loss: 1.805, Global test accuracy: 53.10
Round  36, Train loss: 0.511, Test loss: 0.582, Test accuracy: 79.66
Round  36, Global train loss: 0.511, Global test loss: 1.728, Global test accuracy: 48.72
Round  37, Train loss: 0.513, Test loss: 0.571, Test accuracy: 80.20
Round  37, Global train loss: 0.513, Global test loss: 1.910, Global test accuracy: 44.40
Round  38, Train loss: 0.445, Test loss: 0.555, Test accuracy: 81.02
Round  38, Global train loss: 0.445, Global test loss: 1.415, Global test accuracy: 51.14
Round  39, Train loss: 0.568, Test loss: 0.557, Test accuracy: 81.62
Round  39, Global train loss: 0.568, Global test loss: 2.141, Global test accuracy: 33.42
Round  40, Train loss: 0.544, Test loss: 0.558, Test accuracy: 81.12
Round  40, Global train loss: 0.544, Global test loss: 1.918, Global test accuracy: 39.36
Round  41, Train loss: 0.472, Test loss: 0.573, Test accuracy: 79.88
Round  41, Global train loss: 0.472, Global test loss: 1.532, Global test accuracy: 50.98
Round  42, Train loss: 0.459, Test loss: 0.553, Test accuracy: 81.28
Round  42, Global train loss: 0.459, Global test loss: 1.667, Global test accuracy: 54.42
Round  43, Train loss: 0.459, Test loss: 0.556, Test accuracy: 80.82
Round  43, Global train loss: 0.459, Global test loss: 1.418, Global test accuracy: 56.78
Round  44, Train loss: 0.411, Test loss: 0.566, Test accuracy: 80.18
Round  44, Global train loss: 0.411, Global test loss: 1.495, Global test accuracy: 51.06
Round  45, Train loss: 0.412, Test loss: 0.586, Test accuracy: 79.44
Round  45, Global train loss: 0.412, Global test loss: 1.604, Global test accuracy: 50.74
Round  46, Train loss: 0.470, Test loss: 0.550, Test accuracy: 80.80
Round  46, Global train loss: 0.470, Global test loss: 1.223, Global test accuracy: 58.82
Round  47, Train loss: 0.493, Test loss: 0.550, Test accuracy: 80.78
Round  47, Global train loss: 0.493, Global test loss: 1.323, Global test accuracy: 53.10
Round  48, Train loss: 0.500, Test loss: 0.554, Test accuracy: 80.98
Round  48, Global train loss: 0.500, Global test loss: 1.926, Global test accuracy: 46.58
Round  49, Train loss: 0.406, Test loss: 0.559, Test accuracy: 81.32
Round  49, Global train loss: 0.406, Global test loss: 1.749, Global test accuracy: 45.82
Round  50, Train loss: 0.440, Test loss: 0.565, Test accuracy: 80.78
Round  50, Global train loss: 0.440, Global test loss: 2.000, Global test accuracy: 52.58
Round  51, Train loss: 0.364, Test loss: 0.533, Test accuracy: 82.14
Round  51, Global train loss: 0.364, Global test loss: 1.742, Global test accuracy: 48.40
Round  52, Train loss: 0.449, Test loss: 0.538, Test accuracy: 81.44
Round  52, Global train loss: 0.449, Global test loss: 1.346, Global test accuracy: 52.76
Round  53, Train loss: 0.359, Test loss: 0.558, Test accuracy: 80.58
Round  53, Global train loss: 0.359, Global test loss: 1.257, Global test accuracy: 58.00
Round  54, Train loss: 0.314, Test loss: 0.528, Test accuracy: 82.06
Round  54, Global train loss: 0.314, Global test loss: 1.550, Global test accuracy: 54.04
Round  55, Train loss: 0.353, Test loss: 0.548, Test accuracy: 80.70
Round  55, Global train loss: 0.353, Global test loss: 1.734, Global test accuracy: 43.74
Round  56, Train loss: 0.300, Test loss: 0.544, Test accuracy: 80.66
Round  56, Global train loss: 0.300, Global test loss: 1.810, Global test accuracy: 45.06
Round  57, Train loss: 0.328, Test loss: 0.564, Test accuracy: 80.94
Round  57, Global train loss: 0.328, Global test loss: 1.933, Global test accuracy: 44.04
Round  58, Train loss: 0.381, Test loss: 0.533, Test accuracy: 81.30
Round  58, Global train loss: 0.381, Global test loss: 1.598, Global test accuracy: 48.12
Round  59, Train loss: 0.385, Test loss: 0.593, Test accuracy: 78.44
Round  59, Global train loss: 0.385, Global test loss: 1.840, Global test accuracy: 44.48
Round  60, Train loss: 0.356, Test loss: 0.534, Test accuracy: 80.92
Round  60, Global train loss: 0.356, Global test loss: 1.486, Global test accuracy: 47.56
Round  61, Train loss: 0.320, Test loss: 0.527, Test accuracy: 81.22
Round  61, Global train loss: 0.320, Global test loss: 1.571, Global test accuracy: 58.80
Round  62, Train loss: 0.349, Test loss: 0.539, Test accuracy: 80.54
Round  62, Global train loss: 0.349, Global test loss: 1.766, Global test accuracy: 41.96
Round  63, Train loss: 0.269, Test loss: 0.523, Test accuracy: 81.44
Round  63, Global train loss: 0.269, Global test loss: 1.760, Global test accuracy: 53.90
Round  64, Train loss: 0.282, Test loss: 0.538, Test accuracy: 80.84
Round  64, Global train loss: 0.282, Global test loss: 1.435, Global test accuracy: 53.34
Round  65, Train loss: 0.274, Test loss: 0.532, Test accuracy: 81.80
Round  65, Global train loss: 0.274, Global test loss: 1.754, Global test accuracy: 51.78
Round  66, Train loss: 0.305, Test loss: 0.532, Test accuracy: 81.48
Round  66, Global train loss: 0.305, Global test loss: 1.439, Global test accuracy: 52.32
Round  67, Train loss: 0.243, Test loss: 0.529, Test accuracy: 81.64
Round  67, Global train loss: 0.243, Global test loss: 1.597, Global test accuracy: 54.64
Round  68, Train loss: 0.205, Test loss: 0.527, Test accuracy: 81.70
Round  68, Global train loss: 0.205, Global test loss: 1.719, Global test accuracy: 51.14
Round  69, Train loss: 0.214, Test loss: 0.551, Test accuracy: 80.86
Round  69, Global train loss: 0.214, Global test loss: 1.698, Global test accuracy: 49.92
Round  70, Train loss: 0.320, Test loss: 0.522, Test accuracy: 82.18
Round  70, Global train loss: 0.320, Global test loss: 1.510, Global test accuracy: 52.18
Round  71, Train loss: 0.357, Test loss: 0.512, Test accuracy: 81.92
Round  71, Global train loss: 0.357, Global test loss: 1.973, Global test accuracy: 48.66
Round  72, Train loss: 0.205, Test loss: 0.531, Test accuracy: 81.76
Round  72, Global train loss: 0.205, Global test loss: 1.390, Global test accuracy: 55.80
Round  73, Train loss: 0.281, Test loss: 0.527, Test accuracy: 82.10
Round  73, Global train loss: 0.281, Global test loss: 2.121, Global test accuracy: 47.50
Round  74, Train loss: 0.309, Test loss: 0.520, Test accuracy: 81.78
Round  74, Global train loss: 0.309, Global test loss: 1.506, Global test accuracy: 49.96
Round  75, Train loss: 0.277, Test loss: 0.554, Test accuracy: 81.82
Round  75, Global train loss: 0.277, Global test loss: 2.495, Global test accuracy: 42.26
Round  76, Train loss: 0.234, Test loss: 0.538, Test accuracy: 82.14
Round  76, Global train loss: 0.234, Global test loss: 1.793, Global test accuracy: 52.62
Round  77, Train loss: 0.230, Test loss: 0.546, Test accuracy: 81.22
Round  77, Global train loss: 0.230, Global test loss: 2.125, Global test accuracy: 39.38
Round  78, Train loss: 0.261, Test loss: 0.567, Test accuracy: 81.30
Round  78, Global train loss: 0.261, Global test loss: 2.437, Global test accuracy: 46.22
Round  79, Train loss: 0.210, Test loss: 0.546, Test accuracy: 80.82
Round  79, Global train loss: 0.210, Global test loss: 1.381, Global test accuracy: 52.74
Round  80, Train loss: 0.171, Test loss: 0.544, Test accuracy: 81.78
Round  80, Global train loss: 0.171, Global test loss: 1.467, Global test accuracy: 55.10
Round  81, Train loss: 0.259, Test loss: 0.546, Test accuracy: 82.16
Round  81, Global train loss: 0.259, Global test loss: 1.848, Global test accuracy: 52.12
Round  82, Train loss: 0.236, Test loss: 0.543, Test accuracy: 82.40
Round  82, Global train loss: 0.236, Global test loss: 1.332, Global test accuracy: 62.04
Round  83, Train loss: 0.173, Test loss: 0.534, Test accuracy: 82.60
Round  83, Global train loss: 0.173, Global test loss: 1.528, Global test accuracy: 57.86
Round  84, Train loss: 0.200, Test loss: 0.571, Test accuracy: 81.70
Round  84, Global train loss: 0.200, Global test loss: 1.532, Global test accuracy: 53.20
Round  85, Train loss: 0.175, Test loss: 0.570, Test accuracy: 82.16
Round  85, Global train loss: 0.175, Global test loss: 1.357, Global test accuracy: 57.56
Round  86, Train loss: 0.213, Test loss: 0.537, Test accuracy: 81.96
Round  86, Global train loss: 0.213, Global test loss: 1.820, Global test accuracy: 49.90
Round  87, Train loss: 0.223, Test loss: 0.608, Test accuracy: 81.20
Round  87, Global train loss: 0.223, Global test loss: 1.990, Global test accuracy: 53.76
Round  88, Train loss: 0.261, Test loss: 0.581, Test accuracy: 80.78
Round  88, Global train loss: 0.261, Global test loss: 2.589, Global test accuracy: 45.52
Round  89, Train loss: 0.191, Test loss: 0.560, Test accuracy: 82.26
Round  89, Global train loss: 0.191, Global test loss: 1.243, Global test accuracy: 59.52
Round  90, Train loss: 0.186, Test loss: 0.526, Test accuracy: 82.18
Round  90, Global train loss: 0.186, Global test loss: 1.483, Global test accuracy: 58.68
Round  91, Train loss: 0.182, Test loss: 0.551, Test accuracy: 82.56
Round  91, Global train loss: 0.182, Global test loss: 1.648, Global test accuracy: 53.10
Round  92, Train loss: 0.191, Test loss: 0.523, Test accuracy: 82.74
Round  92, Global train loss: 0.191, Global test loss: 1.676, Global test accuracy: 52.80
Round  93, Train loss: 0.160, Test loss: 0.555, Test accuracy: 82.54
Round  93, Global train loss: 0.160, Global test loss: 1.260, Global test accuracy: 58.98
Round  94, Train loss: 0.172, Test loss: 0.544, Test accuracy: 81.98
Round  94, Global train loss: 0.172, Global test loss: 1.612, Global test accuracy: 50.14
Round  95, Train loss: 0.164, Test loss: 0.574, Test accuracy: 81.76
Round  95, Global train loss: 0.164, Global test loss: 1.578, Global test accuracy: 52.80
Round  96, Train loss: 0.157, Test loss: 0.553, Test accuracy: 82.18
Round  96, Global train loss: 0.157, Global test loss: 1.470, Global test accuracy: 53.58
Round  97, Train loss: 0.284, Test loss: 0.553, Test accuracy: 81.58
Round  97, Global train loss: 0.284, Global test loss: 1.837, Global test accuracy: 43.64
Round  98, Train loss: 0.190, Test loss: 0.558, Test accuracy: 82.20
Round  98, Global train loss: 0.190, Global test loss: 1.819, Global test accuracy: 44.76
Round  99, Train loss: 0.259, Test loss: 0.543, Test accuracy: 82.84
Round  99, Global train loss: 0.259, Global test loss: 1.717, Global test accuracy: 51.02
Final Round, Train loss: 0.138, Test loss: 0.544, Test accuracy: 83.00
Final Round, Global train loss: 0.138, Global test loss: 1.717, Global test accuracy: 51.02
Average accuracy final 10 rounds: 82.256
911.3063967227936
[2.1431164741516113, 4.177513360977173, 5.947643756866455, 7.883502721786499, 9.713257551193237, 11.738494634628296, 13.515042543411255, 15.440720796585083, 17.328449726104736, 19.292107105255127, 21.151408195495605, 22.866692304611206, 24.75353980064392, 26.50692582130432, 28.4239559173584, 30.18292212486267, 32.01272988319397, 33.95245575904846, 35.71089577674866, 37.438817262649536, 39.24768114089966, 41.062419176101685, 42.91881513595581, 44.64795160293579, 46.487653493881226, 48.30425763130188, 50.27767276763916, 52.04416584968567, 53.74082970619202, 55.53900170326233, 57.38452982902527, 59.553987979888916, 61.347352504730225, 63.12265396118164, 64.82374453544617, 66.64821934700012, 68.41439175605774, 70.16201138496399, 71.88496780395508, 73.7824501991272, 75.6651542186737, 77.61296081542969, 79.51021027565002, 81.4507429599762, 83.39284324645996, 85.08023715019226, 87.25421380996704, 89.36950278282166, 91.53672814369202, 93.31389355659485, 95.11276841163635, 96.87857985496521, 98.67103934288025, 100.4272689819336, 102.28158354759216, 104.21897840499878, 106.23020243644714, 108.0533037185669, 109.83331656455994, 111.55591535568237, 113.52533054351807, 115.3364610671997, 117.07062792778015, 118.84385395050049, 120.73310923576355, 122.59007477760315, 124.57786440849304, 126.40065455436707, 128.35655665397644, 130.24543571472168, 132.26417565345764, 134.0569770336151, 135.82960987091064, 137.72476482391357, 139.95916771888733, 142.35840678215027, 144.2216832637787, 146.01781511306763, 147.7668013572693, 149.52384090423584, 151.28312230110168, 152.98012518882751, 154.7887852191925, 156.5344274044037, 158.30375933647156, 159.98347520828247, 161.94197940826416, 163.9124903678894, 165.9021396636963, 167.70355415344238, 169.6212351322174, 171.54164719581604, 173.4392328262329, 175.2454514503479, 176.99412202835083, 178.7853765487671, 181.18479347229004, 183.14000368118286, 185.22778511047363, 187.25818920135498, 190.4307782649994]
[13.38, 31.86, 38.98, 44.84, 55.14, 54.0, 56.68, 60.76, 62.28, 63.02, 67.44, 67.12, 69.44, 68.7, 69.36, 71.2, 72.02, 73.12, 74.92, 75.26, 75.92, 76.2, 77.46, 76.64, 77.08, 77.36, 77.2, 77.56, 77.9, 79.6, 79.68, 78.2, 79.16, 78.7, 79.56, 79.96, 79.66, 80.2, 81.02, 81.62, 81.12, 79.88, 81.28, 80.82, 80.18, 79.44, 80.8, 80.78, 80.98, 81.32, 80.78, 82.14, 81.44, 80.58, 82.06, 80.7, 80.66, 80.94, 81.3, 78.44, 80.92, 81.22, 80.54, 81.44, 80.84, 81.8, 81.48, 81.64, 81.7, 80.86, 82.18, 81.92, 81.76, 82.1, 81.78, 81.82, 82.14, 81.22, 81.3, 80.82, 81.78, 82.16, 82.4, 82.6, 81.7, 82.16, 81.96, 81.2, 80.78, 82.26, 82.18, 82.56, 82.74, 82.54, 81.98, 81.76, 82.18, 81.58, 82.2, 82.84, 83.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.959, Test loss: 1.788, Test accuracy: 39.96
Round   0, Global train loss: 1.959, Global test loss: 2.190, Global test accuracy: 28.60
Round   1, Train loss: 1.534, Test loss: 1.335, Test accuracy: 51.14
Round   1, Global train loss: 1.534, Global test loss: 1.964, Global test accuracy: 38.32
Round   2, Train loss: 1.359, Test loss: 1.196, Test accuracy: 55.40
Round   2, Global train loss: 1.359, Global test loss: 1.848, Global test accuracy: 37.62
Round   3, Train loss: 1.269, Test loss: 1.112, Test accuracy: 57.80
Round   3, Global train loss: 1.269, Global test loss: 1.774, Global test accuracy: 41.46
Round   4, Train loss: 1.207, Test loss: 1.050, Test accuracy: 60.42
Round   4, Global train loss: 1.207, Global test loss: 1.710, Global test accuracy: 44.06
Round   5, Train loss: 1.150, Test loss: 1.013, Test accuracy: 62.44
Round   5, Global train loss: 1.150, Global test loss: 1.670, Global test accuracy: 46.22
Round   6, Train loss: 1.097, Test loss: 0.960, Test accuracy: 65.06
Round   6, Global train loss: 1.097, Global test loss: 1.628, Global test accuracy: 47.34
Round   7, Train loss: 1.056, Test loss: 0.913, Test accuracy: 66.52
Round   7, Global train loss: 1.056, Global test loss: 1.573, Global test accuracy: 49.70
Round   8, Train loss: 1.012, Test loss: 0.880, Test accuracy: 69.42
Round   8, Global train loss: 1.012, Global test loss: 1.555, Global test accuracy: 51.88
Round   9, Train loss: 0.974, Test loss: 0.852, Test accuracy: 69.98
Round   9, Global train loss: 0.974, Global test loss: 1.523, Global test accuracy: 52.32
Round  10, Train loss: 0.878, Test loss: 0.814, Test accuracy: 70.62
Round  10, Global train loss: 0.878, Global test loss: 2.190, Global test accuracy: 23.28
Round  11, Train loss: 0.811, Test loss: 0.831, Test accuracy: 70.12
Round  11, Global train loss: 0.811, Global test loss: 2.423, Global test accuracy: 28.34
Round  12, Train loss: 0.818, Test loss: 0.780, Test accuracy: 72.64
Round  12, Global train loss: 0.818, Global test loss: 1.989, Global test accuracy: 33.96
Round  13, Train loss: 0.795, Test loss: 0.750, Test accuracy: 72.24
Round  13, Global train loss: 0.795, Global test loss: 1.693, Global test accuracy: 47.04
Round  14, Train loss: 0.706, Test loss: 0.749, Test accuracy: 73.08
Round  14, Global train loss: 0.706, Global test loss: 2.125, Global test accuracy: 36.06
Round  15, Train loss: 0.708, Test loss: 0.773, Test accuracy: 70.84
Round  15, Global train loss: 0.708, Global test loss: 2.036, Global test accuracy: 33.78
Round  16, Train loss: 0.757, Test loss: 0.721, Test accuracy: 74.54
Round  16, Global train loss: 0.757, Global test loss: 1.800, Global test accuracy: 36.42
Round  17, Train loss: 0.671, Test loss: 0.757, Test accuracy: 72.34
Round  17, Global train loss: 0.671, Global test loss: 1.932, Global test accuracy: 39.66
Round  18, Train loss: 0.696, Test loss: 0.718, Test accuracy: 74.28
Round  18, Global train loss: 0.696, Global test loss: 1.968, Global test accuracy: 37.20
Round  19, Train loss: 0.683, Test loss: 0.675, Test accuracy: 75.24
Round  19, Global train loss: 0.683, Global test loss: 1.631, Global test accuracy: 48.20
Round  20, Train loss: 0.630, Test loss: 0.717, Test accuracy: 73.80
Round  20, Global train loss: 0.630, Global test loss: 2.252, Global test accuracy: 33.30
Round  21, Train loss: 0.630, Test loss: 0.690, Test accuracy: 75.42
Round  21, Global train loss: 0.630, Global test loss: 1.948, Global test accuracy: 39.20
Round  22, Train loss: 0.684, Test loss: 0.680, Test accuracy: 75.96
Round  22, Global train loss: 0.684, Global test loss: 2.455, Global test accuracy: 30.96
Round  23, Train loss: 0.619, Test loss: 0.677, Test accuracy: 75.36
Round  23, Global train loss: 0.619, Global test loss: 2.256, Global test accuracy: 42.90
Round  24, Train loss: 0.645, Test loss: 0.662, Test accuracy: 75.86
Round  24, Global train loss: 0.645, Global test loss: 2.078, Global test accuracy: 41.54
Round  25, Train loss: 0.597, Test loss: 0.649, Test accuracy: 76.12
Round  25, Global train loss: 0.597, Global test loss: 1.852, Global test accuracy: 36.82
Round  26, Train loss: 0.534, Test loss: 0.638, Test accuracy: 76.82
Round  26, Global train loss: 0.534, Global test loss: 1.642, Global test accuracy: 44.14
Round  27, Train loss: 0.562, Test loss: 0.650, Test accuracy: 77.04
Round  27, Global train loss: 0.562, Global test loss: 2.313, Global test accuracy: 33.68
Round  28, Train loss: 0.598, Test loss: 0.642, Test accuracy: 77.20
Round  28, Global train loss: 0.598, Global test loss: 2.596, Global test accuracy: 19.80
Round  29, Train loss: 0.531, Test loss: 0.630, Test accuracy: 77.48
Round  29, Global train loss: 0.531, Global test loss: 1.920, Global test accuracy: 31.24
Round  30, Train loss: 0.549, Test loss: 0.644, Test accuracy: 76.82
Round  30, Global train loss: 0.549, Global test loss: 2.404, Global test accuracy: 30.16
Round  31, Train loss: 0.524, Test loss: 0.603, Test accuracy: 78.26
Round  31, Global train loss: 0.524, Global test loss: 2.596, Global test accuracy: 41.22
Round  32, Train loss: 0.491, Test loss: 0.594, Test accuracy: 78.76
Round  32, Global train loss: 0.491, Global test loss: 1.549, Global test accuracy: 45.00
Round  33, Train loss: 0.462, Test loss: 0.601, Test accuracy: 78.06
Round  33, Global train loss: 0.462, Global test loss: 1.912, Global test accuracy: 40.50
Round  34, Train loss: 0.471, Test loss: 0.605, Test accuracy: 78.04
Round  34, Global train loss: 0.471, Global test loss: 2.411, Global test accuracy: 32.32
Round  35, Train loss: 0.500, Test loss: 0.602, Test accuracy: 78.96
Round  35, Global train loss: 0.500, Global test loss: 2.681, Global test accuracy: 38.28
Round  36, Train loss: 0.477, Test loss: 0.586, Test accuracy: 79.18
Round  36, Global train loss: 0.477, Global test loss: 1.759, Global test accuracy: 42.18
Round  37, Train loss: 0.481, Test loss: 0.581, Test accuracy: 79.54
Round  37, Global train loss: 0.481, Global test loss: 1.746, Global test accuracy: 50.00
Round  38, Train loss: 0.495, Test loss: 0.588, Test accuracy: 78.88
Round  38, Global train loss: 0.495, Global test loss: 1.702, Global test accuracy: 44.72
Round  39, Train loss: 0.450, Test loss: 0.566, Test accuracy: 80.04
Round  39, Global train loss: 0.450, Global test loss: 1.515, Global test accuracy: 47.10
Round  40, Train loss: 0.399, Test loss: 0.583, Test accuracy: 79.12
Round  40, Global train loss: 0.399, Global test loss: 2.142, Global test accuracy: 45.56
Round  41, Train loss: 0.389, Test loss: 0.588, Test accuracy: 79.38
Round  41, Global train loss: 0.389, Global test loss: 1.962, Global test accuracy: 40.42
Round  42, Train loss: 0.390, Test loss: 0.580, Test accuracy: 79.42
Round  42, Global train loss: 0.390, Global test loss: 1.811, Global test accuracy: 45.50
Round  43, Train loss: 0.391, Test loss: 0.587, Test accuracy: 79.68
Round  43, Global train loss: 0.391, Global test loss: 2.108, Global test accuracy: 43.32
Round  44, Train loss: 0.346, Test loss: 0.571, Test accuracy: 80.26
Round  44, Global train loss: 0.346, Global test loss: 1.795, Global test accuracy: 44.50
Round  45, Train loss: 0.438, Test loss: 0.573, Test accuracy: 79.82
Round  45, Global train loss: 0.438, Global test loss: 2.654, Global test accuracy: 37.98
Round  46, Train loss: 0.414, Test loss: 0.574, Test accuracy: 79.92
Round  46, Global train loss: 0.414, Global test loss: 2.015, Global test accuracy: 38.14
Round  47, Train loss: 0.351, Test loss: 0.581, Test accuracy: 79.40
Round  47, Global train loss: 0.351, Global test loss: 1.527, Global test accuracy: 56.66
Round  48, Train loss: 0.349, Test loss: 0.594, Test accuracy: 78.78
Round  48, Global train loss: 0.349, Global test loss: 1.663, Global test accuracy: 46.82
Round  49, Train loss: 0.385, Test loss: 0.575, Test accuracy: 80.12
Round  49, Global train loss: 0.385, Global test loss: 1.923, Global test accuracy: 44.34
Round  50, Train loss: 0.405, Test loss: 0.553, Test accuracy: 80.66
Round  50, Global train loss: 0.405, Global test loss: 1.962, Global test accuracy: 44.00
Round  51, Train loss: 0.340, Test loss: 0.563, Test accuracy: 80.24
Round  51, Global train loss: 0.340, Global test loss: 2.210, Global test accuracy: 37.80
Round  52, Train loss: 0.361, Test loss: 0.567, Test accuracy: 80.20
Round  52, Global train loss: 0.361, Global test loss: 1.709, Global test accuracy: 38.54
Round  53, Train loss: 0.332, Test loss: 0.581, Test accuracy: 80.00
Round  53, Global train loss: 0.332, Global test loss: 1.604, Global test accuracy: 52.90
Round  54, Train loss: 0.367, Test loss: 0.568, Test accuracy: 79.56
Round  54, Global train loss: 0.367, Global test loss: 1.568, Global test accuracy: 45.20
Round  55, Train loss: 0.322, Test loss: 0.581, Test accuracy: 79.42
Round  55, Global train loss: 0.322, Global test loss: 1.445, Global test accuracy: 50.92
Round  56, Train loss: 0.288, Test loss: 0.584, Test accuracy: 79.82
Round  56, Global train loss: 0.288, Global test loss: 2.495, Global test accuracy: 33.38
Round  57, Train loss: 0.303, Test loss: 0.578, Test accuracy: 80.18
Round  57, Global train loss: 0.303, Global test loss: 1.935, Global test accuracy: 41.16
Round  58, Train loss: 0.321, Test loss: 0.578, Test accuracy: 79.98
Round  58, Global train loss: 0.321, Global test loss: 1.698, Global test accuracy: 49.40
Round  59, Train loss: 0.284, Test loss: 0.568, Test accuracy: 80.40
Round  59, Global train loss: 0.284, Global test loss: 2.167, Global test accuracy: 49.56
Round  60, Train loss: 0.234, Test loss: 0.564, Test accuracy: 80.12
Round  60, Global train loss: 0.234, Global test loss: 2.041, Global test accuracy: 49.20
Round  61, Train loss: 0.226, Test loss: 0.577, Test accuracy: 80.12
Round  61, Global train loss: 0.226, Global test loss: 1.476, Global test accuracy: 51.04
Round  62, Train loss: 0.260, Test loss: 0.565, Test accuracy: 80.66
Round  62, Global train loss: 0.260, Global test loss: 1.627, Global test accuracy: 56.76
Round  63, Train loss: 0.292, Test loss: 0.566, Test accuracy: 80.98
Round  63, Global train loss: 0.292, Global test loss: 1.846, Global test accuracy: 44.44
Round  64, Train loss: 0.281, Test loss: 0.562, Test accuracy: 81.16
Round  64, Global train loss: 0.281, Global test loss: 3.107, Global test accuracy: 30.78
Round  65, Train loss: 0.320, Test loss: 0.543, Test accuracy: 80.64
Round  65, Global train loss: 0.320, Global test loss: 2.008, Global test accuracy: 45.28
Round  66, Train loss: 0.230, Test loss: 0.576, Test accuracy: 79.96
Round  66, Global train loss: 0.230, Global test loss: 2.490, Global test accuracy: 35.50
Round  67, Train loss: 0.268, Test loss: 0.588, Test accuracy: 78.90
Round  67, Global train loss: 0.268, Global test loss: 2.032, Global test accuracy: 43.78
Round  68, Train loss: 0.247, Test loss: 0.588, Test accuracy: 79.38
Round  68, Global train loss: 0.247, Global test loss: 1.674, Global test accuracy: 58.84
Round  69, Train loss: 0.268, Test loss: 0.569, Test accuracy: 80.50
Round  69, Global train loss: 0.268, Global test loss: 2.137, Global test accuracy: 40.42
Round  70, Train loss: 0.220, Test loss: 0.567, Test accuracy: 80.52
Round  70, Global train loss: 0.220, Global test loss: 2.189, Global test accuracy: 49.84
Round  71, Train loss: 0.275, Test loss: 0.571, Test accuracy: 80.46
Round  71, Global train loss: 0.275, Global test loss: 2.633, Global test accuracy: 35.22
Round  72, Train loss: 0.234, Test loss: 0.558, Test accuracy: 81.06
Round  72, Global train loss: 0.234, Global test loss: 1.902, Global test accuracy: 42.38
Round  73, Train loss: 0.254, Test loss: 0.564, Test accuracy: 80.56
Round  73, Global train loss: 0.254, Global test loss: 1.938, Global test accuracy: 50.62
Round  74, Train loss: 0.235, Test loss: 0.538, Test accuracy: 81.62
Round  74, Global train loss: 0.235, Global test loss: 1.270, Global test accuracy: 55.56
Round  75, Train loss: 0.224, Test loss: 0.568, Test accuracy: 80.30
Round  75, Global train loss: 0.224, Global test loss: 1.894, Global test accuracy: 48.82
Round  76, Train loss: 0.197, Test loss: 0.570, Test accuracy: 80.86
Round  76, Global train loss: 0.197, Global test loss: 2.092, Global test accuracy: 37.48
Round  77, Train loss: 0.202, Test loss: 0.576, Test accuracy: 80.38
Round  77, Global train loss: 0.202, Global test loss: 2.128, Global test accuracy: 40.84
Round  78, Train loss: 0.214, Test loss: 0.571, Test accuracy: 81.26
Round  78, Global train loss: 0.214, Global test loss: 1.715, Global test accuracy: 58.80
Round  79, Train loss: 0.242, Test loss: 0.578, Test accuracy: 80.90
Round  79, Global train loss: 0.242, Global test loss: 2.713, Global test accuracy: 40.68
Round  80, Train loss: 0.204, Test loss: 0.567, Test accuracy: 81.28
Round  80, Global train loss: 0.204, Global test loss: 1.166, Global test accuracy: 63.56
Round  81, Train loss: 0.156, Test loss: 0.573, Test accuracy: 81.26
Round  81, Global train loss: 0.156, Global test loss: 1.385, Global test accuracy: 56.84
Round  82, Train loss: 0.143, Test loss: 0.581, Test accuracy: 80.60
Round  82, Global train loss: 0.143, Global test loss: 1.377, Global test accuracy: 57.08
Round  83, Train loss: 0.137, Test loss: 0.578, Test accuracy: 80.98
Round  83, Global train loss: 0.137, Global test loss: 1.295, Global test accuracy: 60.20
Round  84, Train loss: 0.124, Test loss: 0.598, Test accuracy: 80.82
Round  84, Global train loss: 0.124, Global test loss: 1.365, Global test accuracy: 58.68
Round  85, Train loss: 0.132, Test loss: 0.585, Test accuracy: 80.44
Round  85, Global train loss: 0.132, Global test loss: 1.311, Global test accuracy: 61.04
Round  86, Train loss: 0.117, Test loss: 0.600, Test accuracy: 80.92
Round  86, Global train loss: 0.117, Global test loss: 1.304, Global test accuracy: 61.18
Round  87, Train loss: 0.110, Test loss: 0.575, Test accuracy: 80.80
Round  87, Global train loss: 0.110, Global test loss: 1.295, Global test accuracy: 61.18
Round  88, Train loss: 0.098, Test loss: 0.594, Test accuracy: 80.70
Round  88, Global train loss: 0.098, Global test loss: 1.320, Global test accuracy: 60.80
Round  89, Train loss: 0.108, Test loss: 0.571, Test accuracy: 81.20
Round  89, Global train loss: 0.108, Global test loss: 1.290, Global test accuracy: 60.12
Round  90, Train loss: 0.100, Test loss: 0.572, Test accuracy: 81.10
Round  90, Global train loss: 0.100, Global test loss: 1.289, Global test accuracy: 60.60
Round  91, Train loss: 0.093, Test loss: 0.589, Test accuracy: 80.88
Round  91, Global train loss: 0.093, Global test loss: 1.306, Global test accuracy: 61.32
Round  92, Train loss: 0.090, Test loss: 0.590, Test accuracy: 81.02
Round  92, Global train loss: 0.090, Global test loss: 1.350, Global test accuracy: 59.44
Round  93, Train loss: 0.083, Test loss: 0.590, Test accuracy: 80.98
Round  93, Global train loss: 0.083, Global test loss: 1.307, Global test accuracy: 59.86
Round  94, Train loss: 0.087, Test loss: 0.589, Test accuracy: 81.00
Round  94, Global train loss: 0.087, Global test loss: 1.351, Global test accuracy: 59.42
Round  95, Train loss: 0.081, Test loss: 0.594, Test accuracy: 80.84
Round  95, Global train loss: 0.081, Global test loss: 1.268, Global test accuracy: 61.82
Round  96, Train loss: 0.079, Test loss: 0.611, Test accuracy: 80.58
Round  96, Global train loss: 0.079, Global test loss: 1.276, Global test accuracy: 62.16
Round  97, Train loss: 0.091, Test loss: 0.599, Test accuracy: 80.50
Round  97, Global train loss: 0.091, Global test loss: 1.249, Global test accuracy: 60.80
Round  98, Train loss: 0.074, Test loss: 0.625, Test accuracy: 80.60
Round  98, Global train loss: 0.074, Global test loss: 1.312, Global test accuracy: 60.60
Round  99, Train loss: 0.149, Test loss: 0.576, Test accuracy: 81.22
Round  99, Global train loss: 0.149, Global test loss: 0.874, Global test accuracy: 70.60
Final Round, Train loss: 0.124, Test loss: 0.582, Test accuracy: 81.46
Final Round, Global train loss: 0.124, Global test loss: 0.874, Global test accuracy: 70.60
Average accuracy final 10 rounds: 80.87200000000001
2378.343415737152
[2.3386778831481934, 4.378899097442627, 6.54901385307312, 8.77034330368042, 10.94815182685852, 13.067304611206055, 15.203542470932007, 17.492903232574463, 19.528496980667114, 21.701879501342773, 28.62255859375, 41.239097595214844, 52.27135229110718, 63.32829666137695, 74.79094338417053, 86.3569746017456, 88.50697541236877, 101.01882338523865, 113.57701063156128, 127.66987824440002, 140.17700099945068, 151.98116254806519, 163.70326042175293, 175.4794843196869, 187.34876012802124, 198.7203335762024, 210.1102101802826, 221.7080957889557, 233.3085663318634, 244.6097915172577, 255.94618940353394, 267.2991232872009, 269.40432929992676, 280.53942227363586, 292.5969240665436, 304.0060496330261, 306.04475355148315, 317.67790842056274, 329.0176341533661, 340.90659523010254, 352.9052200317383, 364.0882408618927, 375.1455547809601, 386.30584621429443, 397.2185082435608, 408.1631565093994, 419.0129237174988, 421.2111129760742, 432.3119807243347, 443.37390542030334, 454.7380442619324, 465.30926036834717, 476.8531265258789, 487.6887893676758, 498.7235553264618, 511.89485573768616, 523.0152924060822, 533.8336710929871, 535.7916116714478, 546.7280704975128, 557.5183351039886, 568.1917583942413, 578.7996690273285, 589.6461639404297, 600.909458398819, 611.6512598991394, 622.7275612354279, 634.0632762908936, 645.1941492557526, 655.9764218330383, 666.9739878177643, 677.572107553482, 688.4772329330444, 699.2805364131927, 710.0973172187805, 720.849436044693, 731.4447207450867, 742.4082496166229, 744.6327288150787, 755.3996975421906, 757.434045791626, 759.4677965641022, 761.6323506832123, 763.731113910675, 765.9797577857971, 768.1397960186005, 770.1698293685913, 772.227169752121, 774.2995235919952, 776.4701957702637, 778.627144575119, 780.6225769519806, 782.6542119979858, 784.7566759586334, 786.9119021892548, 788.9191524982452, 791.0021193027496, 793.0188150405884, 795.1041486263275, 805.8012726306915, 817.6232993602753]
[39.96, 51.14, 55.4, 57.8, 60.42, 62.44, 65.06, 66.52, 69.42, 69.98, 70.62, 70.12, 72.64, 72.24, 73.08, 70.84, 74.54, 72.34, 74.28, 75.24, 73.8, 75.42, 75.96, 75.36, 75.86, 76.12, 76.82, 77.04, 77.2, 77.48, 76.82, 78.26, 78.76, 78.06, 78.04, 78.96, 79.18, 79.54, 78.88, 80.04, 79.12, 79.38, 79.42, 79.68, 80.26, 79.82, 79.92, 79.4, 78.78, 80.12, 80.66, 80.24, 80.2, 80.0, 79.56, 79.42, 79.82, 80.18, 79.98, 80.4, 80.12, 80.12, 80.66, 80.98, 81.16, 80.64, 79.96, 78.9, 79.38, 80.5, 80.52, 80.46, 81.06, 80.56, 81.62, 80.3, 80.86, 80.38, 81.26, 80.9, 81.28, 81.26, 80.6, 80.98, 80.82, 80.44, 80.92, 80.8, 80.7, 81.2, 81.1, 80.88, 81.02, 80.98, 81.0, 80.84, 80.58, 80.5, 80.6, 81.22, 81.46]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.770, Test loss: 2.046, Test accuracy: 26.12
Round   0, Global train loss: 1.770, Global test loss: 2.250, Global test accuracy: 22.38
Round   1, Train loss: 1.674, Test loss: 1.726, Test accuracy: 37.14
Round   1, Global train loss: 1.674, Global test loss: 2.110, Global test accuracy: 27.40
Round   2, Train loss: 1.476, Test loss: 1.684, Test accuracy: 40.72
Round   2, Global train loss: 1.476, Global test loss: 2.140, Global test accuracy: 29.50
Round   3, Train loss: 1.520, Test loss: 1.623, Test accuracy: 45.22
Round   3, Global train loss: 1.520, Global test loss: 2.276, Global test accuracy: 27.52
Round   4, Train loss: 1.440, Test loss: 1.371, Test accuracy: 51.36
Round   4, Global train loss: 1.440, Global test loss: 1.901, Global test accuracy: 38.40
Round   5, Train loss: 1.519, Test loss: 1.165, Test accuracy: 57.82
Round   5, Global train loss: 1.519, Global test loss: 2.088, Global test accuracy: 25.82
Round   6, Train loss: 1.286, Test loss: 1.153, Test accuracy: 57.56
Round   6, Global train loss: 1.286, Global test loss: 2.211, Global test accuracy: 24.94
Round   7, Train loss: 1.445, Test loss: 1.138, Test accuracy: 59.56
Round   7, Global train loss: 1.445, Global test loss: 2.154, Global test accuracy: 29.30
Round   8, Train loss: 1.368, Test loss: 1.129, Test accuracy: 60.26
Round   8, Global train loss: 1.368, Global test loss: 2.171, Global test accuracy: 26.64
Round   9, Train loss: 1.251, Test loss: 1.102, Test accuracy: 61.18
Round   9, Global train loss: 1.251, Global test loss: 2.040, Global test accuracy: 26.90
Round  10, Train loss: 1.218, Test loss: 1.092, Test accuracy: 62.28
Round  10, Global train loss: 1.218, Global test loss: 2.009, Global test accuracy: 36.86
Round  11, Train loss: 1.060, Test loss: 1.082, Test accuracy: 62.84
Round  11, Global train loss: 1.060, Global test loss: 2.086, Global test accuracy: 36.74
Round  12, Train loss: 1.127, Test loss: 1.083, Test accuracy: 63.08
Round  12, Global train loss: 1.127, Global test loss: 2.089, Global test accuracy: 26.12
Round  13, Train loss: 1.209, Test loss: 1.047, Test accuracy: 64.04
Round  13, Global train loss: 1.209, Global test loss: 2.113, Global test accuracy: 25.74
Round  14, Train loss: 1.306, Test loss: 1.028, Test accuracy: 64.22
Round  14, Global train loss: 1.306, Global test loss: 2.057, Global test accuracy: 30.12
Round  15, Train loss: 1.069, Test loss: 1.018, Test accuracy: 64.38
Round  15, Global train loss: 1.069, Global test loss: 1.981, Global test accuracy: 31.76
Round  16, Train loss: 1.018, Test loss: 0.987, Test accuracy: 65.94
Round  16, Global train loss: 1.018, Global test loss: 2.027, Global test accuracy: 29.54
Round  17, Train loss: 1.114, Test loss: 0.985, Test accuracy: 66.38
Round  17, Global train loss: 1.114, Global test loss: 2.078, Global test accuracy: 37.60
Round  18, Train loss: 0.916, Test loss: 0.974, Test accuracy: 66.98
Round  18, Global train loss: 0.916, Global test loss: 2.005, Global test accuracy: 28.50
Round  19, Train loss: 0.965, Test loss: 0.963, Test accuracy: 66.96
Round  19, Global train loss: 0.965, Global test loss: 2.337, Global test accuracy: 29.30
Round  20, Train loss: 0.857, Test loss: 0.974, Test accuracy: 67.02
Round  20, Global train loss: 0.857, Global test loss: 1.993, Global test accuracy: 34.36
Round  21, Train loss: 1.028, Test loss: 0.969, Test accuracy: 67.40
Round  21, Global train loss: 1.028, Global test loss: 2.153, Global test accuracy: 28.90
Round  22, Train loss: 0.965, Test loss: 0.966, Test accuracy: 66.64
Round  22, Global train loss: 0.965, Global test loss: 2.120, Global test accuracy: 27.22
Round  23, Train loss: 0.980, Test loss: 0.956, Test accuracy: 67.98
Round  23, Global train loss: 0.980, Global test loss: 1.969, Global test accuracy: 41.68
Round  24, Train loss: 1.061, Test loss: 0.959, Test accuracy: 68.40
Round  24, Global train loss: 1.061, Global test loss: 2.088, Global test accuracy: 29.28
Round  25, Train loss: 0.966, Test loss: 0.948, Test accuracy: 68.98
Round  25, Global train loss: 0.966, Global test loss: 1.941, Global test accuracy: 32.86
Round  26, Train loss: 0.643, Test loss: 0.974, Test accuracy: 68.22
Round  26, Global train loss: 0.643, Global test loss: 1.995, Global test accuracy: 35.30
Round  27, Train loss: 0.996, Test loss: 0.956, Test accuracy: 69.48
Round  27, Global train loss: 0.996, Global test loss: 2.010, Global test accuracy: 32.34
Round  28, Train loss: 0.607, Test loss: 0.954, Test accuracy: 69.00
Round  28, Global train loss: 0.607, Global test loss: 1.918, Global test accuracy: 39.64
Round  29, Train loss: 0.812, Test loss: 0.948, Test accuracy: 68.84
Round  29, Global train loss: 0.812, Global test loss: 1.981, Global test accuracy: 34.84
Round  30, Train loss: 0.772, Test loss: 0.991, Test accuracy: 68.64
Round  30, Global train loss: 0.772, Global test loss: 2.065, Global test accuracy: 32.94
Round  31, Train loss: 0.725, Test loss: 0.986, Test accuracy: 69.02
Round  31, Global train loss: 0.725, Global test loss: 2.072, Global test accuracy: 29.62
Round  32, Train loss: 0.796, Test loss: 0.969, Test accuracy: 68.70
Round  32, Global train loss: 0.796, Global test loss: 2.220, Global test accuracy: 32.34
Round  33, Train loss: 0.709, Test loss: 0.966, Test accuracy: 69.22
Round  33, Global train loss: 0.709, Global test loss: 2.517, Global test accuracy: 30.06
Round  34, Train loss: 0.918, Test loss: 0.971, Test accuracy: 69.16
Round  34, Global train loss: 0.918, Global test loss: 2.130, Global test accuracy: 23.76
Round  35, Train loss: 0.679, Test loss: 0.989, Test accuracy: 68.54
Round  35, Global train loss: 0.679, Global test loss: 2.210, Global test accuracy: 28.26
Round  36, Train loss: 0.986, Test loss: 0.992, Test accuracy: 68.58
Round  36, Global train loss: 0.986, Global test loss: 2.027, Global test accuracy: 32.06
Round  37, Train loss: 0.607, Test loss: 0.995, Test accuracy: 68.86
Round  37, Global train loss: 0.607, Global test loss: 2.223, Global test accuracy: 28.26
Round  38, Train loss: 0.691, Test loss: 1.016, Test accuracy: 68.84
Round  38, Global train loss: 0.691, Global test loss: 2.084, Global test accuracy: 25.40
Round  39, Train loss: 0.879, Test loss: 1.032, Test accuracy: 68.82
Round  39, Global train loss: 0.879, Global test loss: 1.964, Global test accuracy: 29.20
Round  40, Train loss: 0.658, Test loss: 1.048, Test accuracy: 68.50
Round  40, Global train loss: 0.658, Global test loss: 2.065, Global test accuracy: 39.62
Round  41, Train loss: 0.495, Test loss: 1.036, Test accuracy: 68.40
Round  41, Global train loss: 0.495, Global test loss: 1.854, Global test accuracy: 39.76
Round  42, Train loss: 0.737, Test loss: 1.057, Test accuracy: 68.52
Round  42, Global train loss: 0.737, Global test loss: 2.000, Global test accuracy: 36.90
Round  43, Train loss: 0.601, Test loss: 1.046, Test accuracy: 69.16
Round  43, Global train loss: 0.601, Global test loss: 2.158, Global test accuracy: 34.02
Round  44, Train loss: 0.517, Test loss: 1.037, Test accuracy: 69.20
Round  44, Global train loss: 0.517, Global test loss: 2.072, Global test accuracy: 30.58
Round  45, Train loss: 0.603, Test loss: 1.054, Test accuracy: 69.00
Round  45, Global train loss: 0.603, Global test loss: 1.862, Global test accuracy: 38.00
Round  46, Train loss: 0.418, Test loss: 1.049, Test accuracy: 69.44
Round  46, Global train loss: 0.418, Global test loss: 2.059, Global test accuracy: 36.78
Round  47, Train loss: 0.647, Test loss: 1.060, Test accuracy: 69.08
Round  47, Global train loss: 0.647, Global test loss: 2.044, Global test accuracy: 27.96
Round  48, Train loss: 0.517, Test loss: 1.073, Test accuracy: 69.42
Round  48, Global train loss: 0.517, Global test loss: 1.827, Global test accuracy: 38.58
Round  49, Train loss: 0.450, Test loss: 1.081, Test accuracy: 69.62
Round  49, Global train loss: 0.450, Global test loss: 2.088, Global test accuracy: 33.64
Round  50, Train loss: 0.642, Test loss: 1.062, Test accuracy: 70.28
Round  50, Global train loss: 0.642, Global test loss: 1.900, Global test accuracy: 41.60
Round  51, Train loss: 0.578, Test loss: 1.056, Test accuracy: 70.04
Round  51, Global train loss: 0.578, Global test loss: 1.949, Global test accuracy: 36.46
Round  52, Train loss: 0.381, Test loss: 1.089, Test accuracy: 68.96
Round  52, Global train loss: 0.381, Global test loss: 1.941, Global test accuracy: 31.78
Round  53, Train loss: 0.540, Test loss: 1.072, Test accuracy: 68.94
Round  53, Global train loss: 0.540, Global test loss: 1.769, Global test accuracy: 38.88
Round  54, Train loss: 0.583, Test loss: 1.086, Test accuracy: 69.50
Round  54, Global train loss: 0.583, Global test loss: 2.252, Global test accuracy: 34.38
Round  55, Train loss: 0.567, Test loss: 1.099, Test accuracy: 69.02
Round  55, Global train loss: 0.567, Global test loss: 1.973, Global test accuracy: 34.36
Round  56, Train loss: 0.442, Test loss: 1.094, Test accuracy: 68.70
Round  56, Global train loss: 0.442, Global test loss: 2.017, Global test accuracy: 30.08
Round  57, Train loss: 0.500, Test loss: 1.148, Test accuracy: 68.56
Round  57, Global train loss: 0.500, Global test loss: 1.916, Global test accuracy: 35.04
Round  58, Train loss: 0.557, Test loss: 1.181, Test accuracy: 67.76
Round  58, Global train loss: 0.557, Global test loss: 2.117, Global test accuracy: 27.88
Round  59, Train loss: 0.376, Test loss: 1.184, Test accuracy: 68.28
Round  59, Global train loss: 0.376, Global test loss: 2.148, Global test accuracy: 31.68
Round  60, Train loss: 0.617, Test loss: 1.206, Test accuracy: 67.94
Round  60, Global train loss: 0.617, Global test loss: 2.113, Global test accuracy: 30.40
Round  61, Train loss: 0.326, Test loss: 1.242, Test accuracy: 67.16
Round  61, Global train loss: 0.326, Global test loss: 1.868, Global test accuracy: 36.82
Round  62, Train loss: 0.445, Test loss: 1.246, Test accuracy: 68.32
Round  62, Global train loss: 0.445, Global test loss: 1.818, Global test accuracy: 39.30
Round  63, Train loss: 0.382, Test loss: 1.259, Test accuracy: 67.78
Round  63, Global train loss: 0.382, Global test loss: 1.757, Global test accuracy: 39.44
Round  64, Train loss: 0.501, Test loss: 1.260, Test accuracy: 67.84
Round  64, Global train loss: 0.501, Global test loss: 1.927, Global test accuracy: 34.44
Round  65, Train loss: 0.472, Test loss: 1.253, Test accuracy: 68.44
Round  65, Global train loss: 0.472, Global test loss: 1.848, Global test accuracy: 35.44
Round  66, Train loss: 0.299, Test loss: 1.229, Test accuracy: 68.42
Round  66, Global train loss: 0.299, Global test loss: 2.021, Global test accuracy: 32.20
Round  67, Train loss: 0.317, Test loss: 1.235, Test accuracy: 68.20
Round  67, Global train loss: 0.317, Global test loss: 2.069, Global test accuracy: 43.02
Round  68, Train loss: 0.310, Test loss: 1.254, Test accuracy: 67.90
Round  68, Global train loss: 0.310, Global test loss: 1.932, Global test accuracy: 39.20
Round  69, Train loss: 0.492, Test loss: 1.288, Test accuracy: 68.30
Round  69, Global train loss: 0.492, Global test loss: 2.009, Global test accuracy: 31.52
Round  70, Train loss: 0.252, Test loss: 1.310, Test accuracy: 69.04
Round  70, Global train loss: 0.252, Global test loss: 2.133, Global test accuracy: 35.28
Round  71, Train loss: 0.346, Test loss: 1.311, Test accuracy: 68.24
Round  71, Global train loss: 0.346, Global test loss: 2.300, Global test accuracy: 30.24
Round  72, Train loss: 0.319, Test loss: 1.383, Test accuracy: 66.82
Round  72, Global train loss: 0.319, Global test loss: 2.001, Global test accuracy: 40.82
Round  73, Train loss: 0.290, Test loss: 1.396, Test accuracy: 67.14
Round  73, Global train loss: 0.290, Global test loss: 2.039, Global test accuracy: 29.08
Round  74, Train loss: 0.384, Test loss: 1.413, Test accuracy: 67.84
Round  74, Global train loss: 0.384, Global test loss: 1.933, Global test accuracy: 38.02
Round  75, Train loss: 0.258, Test loss: 1.423, Test accuracy: 67.88
Round  75, Global train loss: 0.258, Global test loss: 2.059, Global test accuracy: 35.30
Round  76, Train loss: 0.304, Test loss: 1.346, Test accuracy: 69.20
Round  76, Global train loss: 0.304, Global test loss: 2.153, Global test accuracy: 32.34
Round  77, Train loss: 0.434, Test loss: 1.404, Test accuracy: 67.92
Round  77, Global train loss: 0.434, Global test loss: 2.029, Global test accuracy: 33.34
Round  78, Train loss: 0.328, Test loss: 1.366, Test accuracy: 68.28
Round  78, Global train loss: 0.328, Global test loss: 2.028, Global test accuracy: 31.56
Round  79, Train loss: 0.209, Test loss: 1.393, Test accuracy: 67.66
Round  79, Global train loss: 0.209, Global test loss: 2.249, Global test accuracy: 35.66
Round  80, Train loss: 0.230, Test loss: 1.419, Test accuracy: 67.60
Round  80, Global train loss: 0.230, Global test loss: 1.947, Global test accuracy: 40.28
Round  81, Train loss: 0.238, Test loss: 1.433, Test accuracy: 68.00
Round  81, Global train loss: 0.238, Global test loss: 2.589, Global test accuracy: 33.80
Round  82, Train loss: 0.327, Test loss: 1.470, Test accuracy: 67.98
Round  82, Global train loss: 0.327, Global test loss: 1.972, Global test accuracy: 36.36
Round  83, Train loss: 0.249, Test loss: 1.525, Test accuracy: 66.70
Round  83, Global train loss: 0.249, Global test loss: 1.961, Global test accuracy: 32.48
Round  84, Train loss: 0.307, Test loss: 1.541, Test accuracy: 66.82
Round  84, Global train loss: 0.307, Global test loss: 1.956, Global test accuracy: 35.32
Round  85, Train loss: 0.121, Test loss: 1.617, Test accuracy: 66.24
Round  85, Global train loss: 0.121, Global test loss: 1.905, Global test accuracy: 37.96
Round  86, Train loss: 0.179, Test loss: 1.623, Test accuracy: 66.76
Round  86, Global train loss: 0.179, Global test loss: 1.830, Global test accuracy: 40.80
Round  87, Train loss: 0.159, Test loss: 1.643, Test accuracy: 66.28
Round  87, Global train loss: 0.159, Global test loss: 1.781, Global test accuracy: 37.86
Round  88, Train loss: 0.258, Test loss: 1.674, Test accuracy: 66.64
Round  88, Global train loss: 0.258, Global test loss: 1.893, Global test accuracy: 34.94
Round  89, Train loss: 0.127, Test loss: 1.637, Test accuracy: 66.70
Round  89, Global train loss: 0.127, Global test loss: 1.909, Global test accuracy: 37.02
Round  90, Train loss: 0.320, Test loss: 1.698, Test accuracy: 66.52
Round  90, Global train loss: 0.320, Global test loss: 2.083, Global test accuracy: 36.42
Round  91, Train loss: 0.241, Test loss: 1.689, Test accuracy: 67.14
Round  91, Global train loss: 0.241, Global test loss: 2.120, Global test accuracy: 29.64
Round  92, Train loss: 0.181, Test loss: 1.649, Test accuracy: 67.62
Round  92, Global train loss: 0.181, Global test loss: 2.015, Global test accuracy: 34.68
Round  93, Train loss: 0.223, Test loss: 1.621, Test accuracy: 67.40
Round  93, Global train loss: 0.223, Global test loss: 2.050, Global test accuracy: 40.94
Round  94, Train loss: 0.156, Test loss: 1.548, Test accuracy: 67.94
Round  94, Global train loss: 0.156, Global test loss: 1.861, Global test accuracy: 38.06
Round  95, Train loss: 0.242, Test loss: 1.551, Test accuracy: 67.58
Round  95, Global train loss: 0.242, Global test loss: 1.977, Global test accuracy: 31.22
Round  96, Train loss: 0.233, Test loss: 1.584, Test accuracy: 67.40
Round  96, Global train loss: 0.233, Global test loss: 1.954, Global test accuracy: 34.54
Round  97, Train loss: 0.133, Test loss: 1.648, Test accuracy: 67.66
Round  97, Global train loss: 0.133, Global test loss: 1.731, Global test accuracy: 42.96
Round  98, Train loss: 0.169, Test loss: 1.645, Test accuracy: 67.12
Round  98, Global train loss: 0.169, Global test loss: 1.794, Global test accuracy: 41.42
Round  99, Train loss: 0.173, Test loss: 1.736, Test accuracy: 67.06
Round  99, Global train loss: 0.173, Global test loss: 2.062, Global test accuracy: 36.64
Final Round, Train loss: 0.172, Test loss: 1.710, Test accuracy: 66.26
Final Round, Global train loss: 0.172, Global test loss: 2.062, Global test accuracy: 36.64
Average accuracy final 10 rounds: 67.34400000000001 

Average global accuracy final 10 rounds: 36.652 

1000.9932150840759
[1.7649688720703125, 3.529937744140625, 5.0078125, 6.485687255859375, 8.06364369392395, 9.641600131988525, 11.21060848236084, 12.779616832733154, 14.422125816345215, 16.064634799957275, 17.629523277282715, 19.194411754608154, 20.823708295822144, 22.453004837036133, 24.04765486717224, 25.64230489730835, 27.148964166641235, 28.65562343597412, 30.213463068008423, 31.771302700042725, 33.37103891372681, 34.97077512741089, 36.627689599990845, 38.2846040725708, 40.02057075500488, 41.756537437438965, 43.2618408203125, 44.767144203186035, 46.43622279167175, 48.10530138015747, 49.68157935142517, 51.25785732269287, 52.76276779174805, 54.26767826080322, 56.04287099838257, 57.818063735961914, 59.33268117904663, 60.84729862213135, 62.39568018913269, 63.94406175613403, 65.58045196533203, 67.21684217453003, 68.78397727012634, 70.35111236572266, 71.94542074203491, 73.53972911834717, 75.14029693603516, 76.74086475372314, 78.35374307632446, 79.96662139892578, 81.49562239646912, 83.02462339401245, 84.60982632637024, 86.19502925872803, 87.72404742240906, 89.25306558609009, 90.755619764328, 92.25817394256592, 93.80626440048218, 95.35435485839844, 96.90444827079773, 98.45454168319702, 100.00544762611389, 101.55635356903076, 103.1080117225647, 104.65966987609863, 106.26807451248169, 107.87647914886475, 109.47597122192383, 111.07546329498291, 112.55335664749146, 114.03125, 115.62882995605469, 117.22640991210938, 118.86233711242676, 120.49826431274414, 122.07764148712158, 123.65701866149902, 125.19908046722412, 126.74114227294922, 128.4332892894745, 130.12543630599976, 131.80338525772095, 133.48133420944214, 135.13785481452942, 136.7943754196167, 138.2822515964508, 139.7701277732849, 141.31282472610474, 142.85552167892456, 144.41119289398193, 145.9668641090393, 147.69843339920044, 149.43000268936157, 151.0397651195526, 152.64952754974365, 154.3365924358368, 156.02365732192993, 157.64758467674255, 159.27151203155518, 160.82505917549133, 162.3786063194275, 163.9041736125946, 165.42974090576172, 166.8693242073059, 168.3089075088501, 169.8591182231903, 171.40932893753052, 172.98154830932617, 174.55376768112183, 176.11374878883362, 177.6737298965454, 179.22657585144043, 180.77942180633545, 182.449777841568, 184.12013387680054, 185.7291784286499, 187.33822298049927, 188.91299843788147, 190.48777389526367, 192.05871486663818, 193.6296558380127, 195.15123677253723, 196.67281770706177, 198.256511926651, 199.84020614624023, 201.59780430793762, 203.355402469635, 204.92852401733398, 206.50164556503296, 208.20934295654297, 209.91704034805298, 211.4316849708557, 212.94632959365845, 214.49025058746338, 216.0341715812683, 217.57030582427979, 219.10644006729126, 220.5807921886444, 222.05514430999756, 223.76401686668396, 225.47288942337036, 227.03418064117432, 228.59547185897827, 230.04006695747375, 231.48466205596924, 233.05151462554932, 234.6183671951294, 236.12383484840393, 237.62930250167847, 239.2451455593109, 240.86098861694336, 242.37737464904785, 243.89376068115234, 245.43373084068298, 246.97370100021362, 248.67150020599365, 250.36929941177368, 251.91057014465332, 253.45184087753296, 254.95528292655945, 256.45872497558594, 258.00685811042786, 259.5549912452698, 261.3262917995453, 263.0975923538208, 264.60083770751953, 266.10408306121826, 267.89163637161255, 269.67918968200684, 271.2690703868866, 272.85895109176636, 274.42920422554016, 275.99945735931396, 277.70525598526, 279.41105461120605, 281.0395681858063, 282.6680817604065, 284.25286984443665, 285.8376579284668, 287.35433173179626, 288.87100553512573, 290.3732576370239, 291.8755097389221, 293.3654935359955, 294.85547733306885, 296.3767924308777, 297.8981075286865, 299.47487115859985, 301.0516347885132, 302.5028088092804, 303.9539828300476, 305.47684240341187, 306.9997019767761, 308.5976765155792, 310.1956510543823, 311.78210520744324, 313.36855936050415, 314.86486291885376, 316.36116647720337, 319.5671796798706, 322.77319288253784]
[26.12, 26.12, 37.14, 37.14, 40.72, 40.72, 45.22, 45.22, 51.36, 51.36, 57.82, 57.82, 57.56, 57.56, 59.56, 59.56, 60.26, 60.26, 61.18, 61.18, 62.28, 62.28, 62.84, 62.84, 63.08, 63.08, 64.04, 64.04, 64.22, 64.22, 64.38, 64.38, 65.94, 65.94, 66.38, 66.38, 66.98, 66.98, 66.96, 66.96, 67.02, 67.02, 67.4, 67.4, 66.64, 66.64, 67.98, 67.98, 68.4, 68.4, 68.98, 68.98, 68.22, 68.22, 69.48, 69.48, 69.0, 69.0, 68.84, 68.84, 68.64, 68.64, 69.02, 69.02, 68.7, 68.7, 69.22, 69.22, 69.16, 69.16, 68.54, 68.54, 68.58, 68.58, 68.86, 68.86, 68.84, 68.84, 68.82, 68.82, 68.5, 68.5, 68.4, 68.4, 68.52, 68.52, 69.16, 69.16, 69.2, 69.2, 69.0, 69.0, 69.44, 69.44, 69.08, 69.08, 69.42, 69.42, 69.62, 69.62, 70.28, 70.28, 70.04, 70.04, 68.96, 68.96, 68.94, 68.94, 69.5, 69.5, 69.02, 69.02, 68.7, 68.7, 68.56, 68.56, 67.76, 67.76, 68.28, 68.28, 67.94, 67.94, 67.16, 67.16, 68.32, 68.32, 67.78, 67.78, 67.84, 67.84, 68.44, 68.44, 68.42, 68.42, 68.2, 68.2, 67.9, 67.9, 68.3, 68.3, 69.04, 69.04, 68.24, 68.24, 66.82, 66.82, 67.14, 67.14, 67.84, 67.84, 67.88, 67.88, 69.2, 69.2, 67.92, 67.92, 68.28, 68.28, 67.66, 67.66, 67.6, 67.6, 68.0, 68.0, 67.98, 67.98, 66.7, 66.7, 66.82, 66.82, 66.24, 66.24, 66.76, 66.76, 66.28, 66.28, 66.64, 66.64, 66.7, 66.7, 66.52, 66.52, 67.14, 67.14, 67.62, 67.62, 67.4, 67.4, 67.94, 67.94, 67.58, 67.58, 67.4, 67.4, 67.66, 67.66, 67.12, 67.12, 67.06, 67.06, 66.26, 66.26]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.785, Test loss: 2.035, Test accuracy: 24.76
Round   0, Global train loss: 1.785, Global test loss: 2.248, Global test accuracy: 20.58
Round   1, Train loss: 1.685, Test loss: 1.752, Test accuracy: 34.38
Round   1, Global train loss: 1.685, Global test loss: 2.141, Global test accuracy: 23.42
Round   2, Train loss: 1.555, Test loss: 1.718, Test accuracy: 38.52
Round   2, Global train loss: 1.555, Global test loss: 2.134, Global test accuracy: 30.30
Round   3, Train loss: 1.543, Test loss: 1.639, Test accuracy: 43.14
Round   3, Global train loss: 1.543, Global test loss: 2.190, Global test accuracy: 29.38
Round   4, Train loss: 1.494, Test loss: 1.393, Test accuracy: 48.74
Round   4, Global train loss: 1.494, Global test loss: 1.822, Global test accuracy: 37.94
Round   5, Train loss: 1.488, Test loss: 1.186, Test accuracy: 56.38
Round   5, Global train loss: 1.488, Global test loss: 1.862, Global test accuracy: 33.04
Round   6, Train loss: 1.328, Test loss: 1.161, Test accuracy: 57.40
Round   6, Global train loss: 1.328, Global test loss: 2.133, Global test accuracy: 26.26
Round   7, Train loss: 1.423, Test loss: 1.110, Test accuracy: 59.46
Round   7, Global train loss: 1.423, Global test loss: 1.687, Global test accuracy: 45.96
Round   8, Train loss: 1.396, Test loss: 1.088, Test accuracy: 61.12
Round   8, Global train loss: 1.396, Global test loss: 1.773, Global test accuracy: 44.16
Round   9, Train loss: 1.279, Test loss: 1.075, Test accuracy: 62.22
Round   9, Global train loss: 1.279, Global test loss: 1.617, Global test accuracy: 46.02
Round  10, Train loss: 1.232, Test loss: 1.054, Test accuracy: 63.56
Round  10, Global train loss: 1.232, Global test loss: 1.785, Global test accuracy: 41.16
Round  11, Train loss: 1.111, Test loss: 1.023, Test accuracy: 65.22
Round  11, Global train loss: 1.111, Global test loss: 1.561, Global test accuracy: 47.62
Round  12, Train loss: 1.184, Test loss: 1.000, Test accuracy: 66.84
Round  12, Global train loss: 1.184, Global test loss: 1.564, Global test accuracy: 48.60
Round  13, Train loss: 1.224, Test loss: 0.955, Test accuracy: 69.58
Round  13, Global train loss: 1.224, Global test loss: 1.666, Global test accuracy: 49.62
Round  14, Train loss: 1.268, Test loss: 0.931, Test accuracy: 70.14
Round  14, Global train loss: 1.268, Global test loss: 1.505, Global test accuracy: 54.50
Round  15, Train loss: 1.161, Test loss: 0.921, Test accuracy: 71.00
Round  15, Global train loss: 1.161, Global test loss: 1.388, Global test accuracy: 57.38
Round  16, Train loss: 1.034, Test loss: 0.904, Test accuracy: 71.56
Round  16, Global train loss: 1.034, Global test loss: 1.401, Global test accuracy: 54.90
Round  17, Train loss: 1.109, Test loss: 0.888, Test accuracy: 71.96
Round  17, Global train loss: 1.109, Global test loss: 1.358, Global test accuracy: 57.60
Round  18, Train loss: 0.990, Test loss: 0.896, Test accuracy: 71.18
Round  18, Global train loss: 0.990, Global test loss: 1.314, Global test accuracy: 60.02
Round  19, Train loss: 0.999, Test loss: 0.918, Test accuracy: 70.58
Round  19, Global train loss: 0.999, Global test loss: 1.569, Global test accuracy: 47.48
Round  20, Train loss: 0.896, Test loss: 0.890, Test accuracy: 71.32
Round  20, Global train loss: 0.896, Global test loss: 1.502, Global test accuracy: 54.32
Round  21, Train loss: 1.036, Test loss: 0.883, Test accuracy: 71.76
Round  21, Global train loss: 1.036, Global test loss: 1.419, Global test accuracy: 53.94
Round  22, Train loss: 0.955, Test loss: 0.853, Test accuracy: 72.42
Round  22, Global train loss: 0.955, Global test loss: 1.384, Global test accuracy: 54.34
Round  23, Train loss: 0.992, Test loss: 0.828, Test accuracy: 72.86
Round  23, Global train loss: 0.992, Global test loss: 1.299, Global test accuracy: 60.14
Round  24, Train loss: 0.984, Test loss: 0.814, Test accuracy: 73.20
Round  24, Global train loss: 0.984, Global test loss: 1.169, Global test accuracy: 64.08
Round  25, Train loss: 1.001, Test loss: 0.846, Test accuracy: 73.12
Round  25, Global train loss: 1.001, Global test loss: 1.348, Global test accuracy: 56.84
Round  26, Train loss: 0.750, Test loss: 0.857, Test accuracy: 72.94
Round  26, Global train loss: 0.750, Global test loss: 1.230, Global test accuracy: 61.42
Round  27, Train loss: 1.033, Test loss: 0.868, Test accuracy: 72.46
Round  27, Global train loss: 1.033, Global test loss: 1.331, Global test accuracy: 60.16
Round  28, Train loss: 0.686, Test loss: 0.880, Test accuracy: 72.16
Round  28, Global train loss: 0.686, Global test loss: 1.400, Global test accuracy: 56.26
Round  29, Train loss: 0.889, Test loss: 0.852, Test accuracy: 72.94
Round  29, Global train loss: 0.889, Global test loss: 1.253, Global test accuracy: 61.10
Round  30, Train loss: 0.770, Test loss: 0.824, Test accuracy: 73.66
Round  30, Global train loss: 0.770, Global test loss: 1.475, Global test accuracy: 53.74
Round  31, Train loss: 0.746, Test loss: 0.837, Test accuracy: 73.28
Round  31, Global train loss: 0.746, Global test loss: 1.523, Global test accuracy: 53.50
Round  32, Train loss: 0.767, Test loss: 0.854, Test accuracy: 72.80
Round  32, Global train loss: 0.767, Global test loss: 1.593, Global test accuracy: 51.76
Round  33, Train loss: 0.704, Test loss: 0.878, Test accuracy: 72.52
Round  33, Global train loss: 0.704, Global test loss: 1.680, Global test accuracy: 49.46
Round  34, Train loss: 0.905, Test loss: 0.897, Test accuracy: 72.24
Round  34, Global train loss: 0.905, Global test loss: 1.364, Global test accuracy: 58.52
Round  35, Train loss: 0.718, Test loss: 0.891, Test accuracy: 71.96
Round  35, Global train loss: 0.718, Global test loss: 1.339, Global test accuracy: 59.36
Round  36, Train loss: 0.853, Test loss: 0.894, Test accuracy: 71.88
Round  36, Global train loss: 0.853, Global test loss: 1.322, Global test accuracy: 57.02
Round  37, Train loss: 0.634, Test loss: 0.890, Test accuracy: 72.02
Round  37, Global train loss: 0.634, Global test loss: 1.435, Global test accuracy: 57.80
Round  38, Train loss: 0.664, Test loss: 0.879, Test accuracy: 72.62
Round  38, Global train loss: 0.664, Global test loss: 1.283, Global test accuracy: 60.96
Round  39, Train loss: 0.825, Test loss: 0.862, Test accuracy: 72.40
Round  39, Global train loss: 0.825, Global test loss: 1.239, Global test accuracy: 60.62
Round  40, Train loss: 0.624, Test loss: 0.881, Test accuracy: 72.34
Round  40, Global train loss: 0.624, Global test loss: 1.458, Global test accuracy: 57.42
Round  41, Train loss: 0.589, Test loss: 0.873, Test accuracy: 72.54
Round  41, Global train loss: 0.589, Global test loss: 1.391, Global test accuracy: 57.14
Round  42, Train loss: 0.662, Test loss: 0.897, Test accuracy: 72.08
Round  42, Global train loss: 0.662, Global test loss: 1.163, Global test accuracy: 62.98
Round  43, Train loss: 0.547, Test loss: 0.905, Test accuracy: 72.24
Round  43, Global train loss: 0.547, Global test loss: 1.444, Global test accuracy: 58.00
Round  44, Train loss: 0.597, Test loss: 0.927, Test accuracy: 71.80
Round  44, Global train loss: 0.597, Global test loss: 1.323, Global test accuracy: 58.26
Round  45, Train loss: 0.547, Test loss: 0.959, Test accuracy: 70.60
Round  45, Global train loss: 0.547, Global test loss: 1.149, Global test accuracy: 65.54
Round  46, Train loss: 0.476, Test loss: 0.956, Test accuracy: 70.82
Round  46, Global train loss: 0.476, Global test loss: 1.275, Global test accuracy: 60.96
Round  47, Train loss: 0.636, Test loss: 0.916, Test accuracy: 72.20
Round  47, Global train loss: 0.636, Global test loss: 1.332, Global test accuracy: 58.92
Round  48, Train loss: 0.488, Test loss: 0.994, Test accuracy: 70.94
Round  48, Global train loss: 0.488, Global test loss: 1.243, Global test accuracy: 63.68
Round  49, Train loss: 0.500, Test loss: 1.010, Test accuracy: 71.22
Round  49, Global train loss: 0.500, Global test loss: 1.353, Global test accuracy: 60.04
Round  50, Train loss: 0.553, Test loss: 0.999, Test accuracy: 71.24
Round  50, Global train loss: 0.553, Global test loss: 1.376, Global test accuracy: 58.98
Round  51, Train loss: 0.562, Test loss: 0.992, Test accuracy: 70.98
Round  51, Global train loss: 0.562, Global test loss: 1.343, Global test accuracy: 61.12
Round  52, Train loss: 0.420, Test loss: 0.980, Test accuracy: 71.50
Round  52, Global train loss: 0.420, Global test loss: 1.182, Global test accuracy: 64.50
Round  53, Train loss: 0.431, Test loss: 0.942, Test accuracy: 72.28
Round  53, Global train loss: 0.431, Global test loss: 1.124, Global test accuracy: 63.62
Round  54, Train loss: 0.479, Test loss: 0.929, Test accuracy: 72.70
Round  54, Global train loss: 0.479, Global test loss: 1.593, Global test accuracy: 56.72
Round  55, Train loss: 0.538, Test loss: 0.938, Test accuracy: 72.78
Round  55, Global train loss: 0.538, Global test loss: 1.273, Global test accuracy: 63.16
Round  56, Train loss: 0.375, Test loss: 0.957, Test accuracy: 72.98
Round  56, Global train loss: 0.375, Global test loss: 1.285, Global test accuracy: 62.20
Round  57, Train loss: 0.463, Test loss: 0.982, Test accuracy: 72.86
Round  57, Global train loss: 0.463, Global test loss: 1.363, Global test accuracy: 62.34
Round  58, Train loss: 0.522, Test loss: 0.985, Test accuracy: 72.48
Round  58, Global train loss: 0.522, Global test loss: 1.441, Global test accuracy: 60.12
Round  59, Train loss: 0.388, Test loss: 1.014, Test accuracy: 71.86
Round  59, Global train loss: 0.388, Global test loss: 1.342, Global test accuracy: 60.44
Round  60, Train loss: 0.526, Test loss: 1.053, Test accuracy: 72.20
Round  60, Global train loss: 0.526, Global test loss: 1.573, Global test accuracy: 56.94
Round  61, Train loss: 0.330, Test loss: 1.044, Test accuracy: 72.36
Round  61, Global train loss: 0.330, Global test loss: 1.374, Global test accuracy: 63.78
Round  62, Train loss: 0.431, Test loss: 1.046, Test accuracy: 72.22
Round  62, Global train loss: 0.431, Global test loss: 1.249, Global test accuracy: 65.32
Round  63, Train loss: 0.358, Test loss: 1.060, Test accuracy: 72.08
Round  63, Global train loss: 0.358, Global test loss: 1.329, Global test accuracy: 62.86
Round  64, Train loss: 0.458, Test loss: 1.050, Test accuracy: 72.52
Round  64, Global train loss: 0.458, Global test loss: 1.461, Global test accuracy: 60.94
Round  65, Train loss: 0.410, Test loss: 1.118, Test accuracy: 71.38
Round  65, Global train loss: 0.410, Global test loss: 1.385, Global test accuracy: 62.86
Round  66, Train loss: 0.354, Test loss: 1.073, Test accuracy: 72.00
Round  66, Global train loss: 0.354, Global test loss: 1.337, Global test accuracy: 62.90
Round  67, Train loss: 0.301, Test loss: 1.009, Test accuracy: 72.32
Round  67, Global train loss: 0.301, Global test loss: 1.763, Global test accuracy: 58.52
Round  68, Train loss: 0.273, Test loss: 1.042, Test accuracy: 72.04
Round  68, Global train loss: 0.273, Global test loss: 1.402, Global test accuracy: 61.60
Round  69, Train loss: 0.428, Test loss: 1.064, Test accuracy: 71.72
Round  69, Global train loss: 0.428, Global test loss: 1.434, Global test accuracy: 61.22
Round  70, Train loss: 0.247, Test loss: 1.096, Test accuracy: 71.66
Round  70, Global train loss: 0.247, Global test loss: 1.591, Global test accuracy: 59.32
Round  71, Train loss: 0.308, Test loss: 1.063, Test accuracy: 72.38
Round  71, Global train loss: 0.308, Global test loss: 1.538, Global test accuracy: 58.56
Round  72, Train loss: 0.341, Test loss: 1.100, Test accuracy: 72.18
Round  72, Global train loss: 0.341, Global test loss: 1.507, Global test accuracy: 61.84
Round  73, Train loss: 0.335, Test loss: 1.105, Test accuracy: 72.10
Round  73, Global train loss: 0.335, Global test loss: 1.430, Global test accuracy: 62.54
Round  74, Train loss: 0.386, Test loss: 1.120, Test accuracy: 72.44
Round  74, Global train loss: 0.386, Global test loss: 1.472, Global test accuracy: 62.94
Round  75, Train loss: 0.281, Test loss: 1.126, Test accuracy: 72.02
Round  75, Global train loss: 0.281, Global test loss: 1.520, Global test accuracy: 59.36
Round  76, Train loss: 0.250, Test loss: 1.142, Test accuracy: 72.56
Round  76, Global train loss: 0.250, Global test loss: 1.459, Global test accuracy: 61.74
Round  77, Train loss: 0.352, Test loss: 1.147, Test accuracy: 72.32
Round  77, Global train loss: 0.352, Global test loss: 1.518, Global test accuracy: 61.68
Round  78, Train loss: 0.259, Test loss: 1.153, Test accuracy: 71.70
Round  78, Global train loss: 0.259, Global test loss: 1.543, Global test accuracy: 61.86
Round  79, Train loss: 0.205, Test loss: 1.168, Test accuracy: 72.08
Round  79, Global train loss: 0.205, Global test loss: 1.486, Global test accuracy: 63.82
Round  80, Train loss: 0.272, Test loss: 1.180, Test accuracy: 71.42
Round  80, Global train loss: 0.272, Global test loss: 1.410, Global test accuracy: 64.92
Round  81, Train loss: 0.222, Test loss: 1.184, Test accuracy: 71.96
Round  81, Global train loss: 0.222, Global test loss: 1.822, Global test accuracy: 58.66
Round  82, Train loss: 0.276, Test loss: 1.170, Test accuracy: 71.90
Round  82, Global train loss: 0.276, Global test loss: 1.523, Global test accuracy: 64.20
Round  83, Train loss: 0.232, Test loss: 1.195, Test accuracy: 71.28
Round  83, Global train loss: 0.232, Global test loss: 1.592, Global test accuracy: 62.74
Round  84, Train loss: 0.258, Test loss: 1.192, Test accuracy: 71.96
Round  84, Global train loss: 0.258, Global test loss: 1.592, Global test accuracy: 64.00
Round  85, Train loss: 0.237, Test loss: 1.228, Test accuracy: 71.64
Round  85, Global train loss: 0.237, Global test loss: 1.694, Global test accuracy: 61.62
Round  86, Train loss: 0.202, Test loss: 1.247, Test accuracy: 70.80
Round  86, Global train loss: 0.202, Global test loss: 1.472, Global test accuracy: 64.40
Round  87, Train loss: 0.201, Test loss: 1.283, Test accuracy: 70.90
Round  87, Global train loss: 0.201, Global test loss: 1.446, Global test accuracy: 66.28
Round  88, Train loss: 0.299, Test loss: 1.279, Test accuracy: 70.96
Round  88, Global train loss: 0.299, Global test loss: 1.694, Global test accuracy: 60.98
Round  89, Train loss: 0.185, Test loss: 1.249, Test accuracy: 71.74
Round  89, Global train loss: 0.185, Global test loss: 1.787, Global test accuracy: 62.36
Round  90, Train loss: 0.326, Test loss: 1.237, Test accuracy: 71.64
Round  90, Global train loss: 0.326, Global test loss: 1.713, Global test accuracy: 62.64
Round  91, Train loss: 0.276, Test loss: 1.273, Test accuracy: 71.44
Round  91, Global train loss: 0.276, Global test loss: 1.953, Global test accuracy: 59.70
Round  92, Train loss: 0.239, Test loss: 1.339, Test accuracy: 70.88
Round  92, Global train loss: 0.239, Global test loss: 1.644, Global test accuracy: 62.08
Round  93, Train loss: 0.230, Test loss: 1.369, Test accuracy: 71.32
Round  93, Global train loss: 0.230, Global test loss: 1.753, Global test accuracy: 60.82
Round  94, Train loss: 0.219, Test loss: 1.377, Test accuracy: 71.10
Round  94, Global train loss: 0.219, Global test loss: 1.634, Global test accuracy: 62.82
Round  95, Train loss: 0.225, Test loss: 1.287, Test accuracy: 71.60
Round  95, Global train loss: 0.225, Global test loss: 1.854, Global test accuracy: 58.52
Round  96, Train loss: 0.202, Test loss: 1.310, Test accuracy: 70.88
Round  96, Global train loss: 0.202, Global test loss: 1.701, Global test accuracy: 61.12
Round  97, Train loss: 0.186, Test loss: 1.330, Test accuracy: 71.22
Round  97, Global train loss: 0.186, Global test loss: 1.693, Global test accuracy: 61.78
Round  98, Train loss: 0.193, Test loss: 1.336, Test accuracy: 70.72
Round  98, Global train loss: 0.193, Global test loss: 1.534, Global test accuracy: 64.76
Round  99, Train loss: 0.171, Test loss: 1.338, Test accuracy: 71.38
Round  99, Global train loss: 0.171, Global test loss: 1.602, Global test accuracy: 64.08
Final Round, Train loss: 0.179, Test loss: 1.365, Test accuracy: 71.80
Final Round, Global train loss: 0.179, Global test loss: 1.602, Global test accuracy: 64.08
Average accuracy final 10 rounds: 71.218 

Average global accuracy final 10 rounds: 61.832 

993.2218449115753
[1.8842730522155762, 3.7685461044311523, 5.375434637069702, 6.982323169708252, 8.533547639846802, 10.084772109985352, 11.598586082458496, 13.11240005493164, 14.622073650360107, 16.131747245788574, 17.73969531059265, 19.34764337539673, 21.015263557434082, 22.682883739471436, 24.39976716041565, 26.116650581359863, 27.799429893493652, 29.48220920562744, 31.0755398273468, 32.66887044906616, 34.40232610702515, 36.13578176498413, 37.68177795410156, 39.227774143218994, 41.04319357872009, 42.85861301422119, 44.34389877319336, 45.82918453216553, 47.451740980148315, 49.0742974281311, 50.57066774368286, 52.06703805923462, 53.67408990859985, 55.28114175796509, 56.85065007209778, 58.42015838623047, 59.94567060470581, 61.47118282318115, 62.95151138305664, 64.43183994293213, 66.0554621219635, 67.67908430099487, 69.31659936904907, 70.95411443710327, 72.47653651237488, 73.99895858764648, 75.59029936790466, 77.18164014816284, 78.97133755683899, 80.76103496551514, 82.4387731552124, 84.11651134490967, 85.78328204154968, 87.4500527381897, 88.95654797554016, 90.46304321289062, 92.10071802139282, 93.73839282989502, 95.37300062179565, 97.00760841369629, 98.54669189453125, 100.08577537536621, 101.66184949874878, 103.23792362213135, 104.8583550453186, 106.47878646850586, 108.04544687271118, 109.6121072769165, 111.09640121459961, 112.58069515228271, 114.23566031455994, 115.89062547683716, 117.4404227733612, 118.99022006988525, 120.91452550888062, 122.83883094787598, 124.38921594619751, 125.93960094451904, 127.5704653263092, 129.20132970809937, 130.72184824943542, 132.24236679077148, 133.90274596214294, 135.5631251335144, 137.13076424598694, 138.69840335845947, 140.1086504459381, 141.51889753341675, 143.02814745903015, 144.53739738464355, 146.1602544784546, 147.78311157226562, 149.3685178756714, 150.95392417907715, 152.47535276412964, 153.99678134918213, 155.55058574676514, 157.10439014434814, 158.6874179840088, 160.27044582366943, 161.7191662788391, 163.1678867340088, 164.70487451553345, 166.2418622970581, 167.7715232372284, 169.30118417739868, 170.8528983592987, 172.40461254119873, 173.94641613960266, 175.4882197380066, 177.1121482849121, 178.73607683181763, 180.42034149169922, 182.1046061515808, 183.60833716392517, 185.11206817626953, 186.77682161331177, 188.441575050354, 190.02135801315308, 191.60114097595215, 193.03109884262085, 194.46105670928955, 196.0055229663849, 197.54998922348022, 198.99715876579285, 200.44432830810547, 201.99433779716492, 203.54434728622437, 205.1738953590393, 206.80344343185425, 208.5240318775177, 210.24462032318115, 211.72628808021545, 213.20795583724976, 214.674706697464, 216.14145755767822, 217.80903434753418, 219.47661113739014, 221.02551198005676, 222.5744128227234, 224.15617156028748, 225.73793029785156, 227.3591287136078, 228.980327129364, 230.5110161304474, 232.04170513153076, 233.75913906097412, 235.47657299041748, 237.25408577919006, 239.03159856796265, 240.6215808391571, 242.21156311035156, 243.66486954689026, 245.11817598342896, 246.64615726470947, 248.17413854599, 249.71683192253113, 251.25952529907227, 252.8482325077057, 254.4369397163391, 255.94248819351196, 257.4480366706848, 258.98669242858887, 260.5253481864929, 262.04586362838745, 263.566379070282, 265.18583822250366, 266.80529737472534, 268.32916593551636, 269.8530344963074, 271.4965353012085, 273.1400361061096, 274.6565179824829, 276.1729998588562, 277.8729944229126, 279.572988986969, 281.22136425971985, 282.8697395324707, 284.48187136650085, 286.094003200531, 287.65035247802734, 289.2067017555237, 290.76310634613037, 292.31951093673706, 293.9571897983551, 295.59486865997314, 297.17401456832886, 298.75316047668457, 300.7875509262085, 302.8219413757324, 304.6457335948944, 306.4695258140564, 308.3416290283203, 310.21373224258423, 311.8569734096527, 313.5002145767212, 315.05495500564575, 316.6096954345703, 318.2258849143982, 319.8420743942261, 322.9361500740051, 326.0302257537842]
[24.76, 24.76, 34.38, 34.38, 38.52, 38.52, 43.14, 43.14, 48.74, 48.74, 56.38, 56.38, 57.4, 57.4, 59.46, 59.46, 61.12, 61.12, 62.22, 62.22, 63.56, 63.56, 65.22, 65.22, 66.84, 66.84, 69.58, 69.58, 70.14, 70.14, 71.0, 71.0, 71.56, 71.56, 71.96, 71.96, 71.18, 71.18, 70.58, 70.58, 71.32, 71.32, 71.76, 71.76, 72.42, 72.42, 72.86, 72.86, 73.2, 73.2, 73.12, 73.12, 72.94, 72.94, 72.46, 72.46, 72.16, 72.16, 72.94, 72.94, 73.66, 73.66, 73.28, 73.28, 72.8, 72.8, 72.52, 72.52, 72.24, 72.24, 71.96, 71.96, 71.88, 71.88, 72.02, 72.02, 72.62, 72.62, 72.4, 72.4, 72.34, 72.34, 72.54, 72.54, 72.08, 72.08, 72.24, 72.24, 71.8, 71.8, 70.6, 70.6, 70.82, 70.82, 72.2, 72.2, 70.94, 70.94, 71.22, 71.22, 71.24, 71.24, 70.98, 70.98, 71.5, 71.5, 72.28, 72.28, 72.7, 72.7, 72.78, 72.78, 72.98, 72.98, 72.86, 72.86, 72.48, 72.48, 71.86, 71.86, 72.2, 72.2, 72.36, 72.36, 72.22, 72.22, 72.08, 72.08, 72.52, 72.52, 71.38, 71.38, 72.0, 72.0, 72.32, 72.32, 72.04, 72.04, 71.72, 71.72, 71.66, 71.66, 72.38, 72.38, 72.18, 72.18, 72.1, 72.1, 72.44, 72.44, 72.02, 72.02, 72.56, 72.56, 72.32, 72.32, 71.7, 71.7, 72.08, 72.08, 71.42, 71.42, 71.96, 71.96, 71.9, 71.9, 71.28, 71.28, 71.96, 71.96, 71.64, 71.64, 70.8, 70.8, 70.9, 70.9, 70.96, 70.96, 71.74, 71.74, 71.64, 71.64, 71.44, 71.44, 70.88, 70.88, 71.32, 71.32, 71.1, 71.1, 71.6, 71.6, 70.88, 70.88, 71.22, 71.22, 70.72, 70.72, 71.38, 71.38, 71.8, 71.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.738, Test loss: 1.931, Test accuracy: 29.04
Round   0, Global train loss: 1.738, Global test loss: 2.162, Global test accuracy: 25.56
Round   1, Train loss: 1.612, Test loss: 1.705, Test accuracy: 35.38
Round   1, Global train loss: 1.612, Global test loss: 2.128, Global test accuracy: 21.16
Round   2, Train loss: 1.513, Test loss: 1.627, Test accuracy: 41.10
Round   2, Global train loss: 1.513, Global test loss: 2.035, Global test accuracy: 29.54
Round   3, Train loss: 1.415, Test loss: 1.512, Test accuracy: 46.50
Round   3, Global train loss: 1.415, Global test loss: 1.972, Global test accuracy: 32.74
Round   4, Train loss: 1.472, Test loss: 1.337, Test accuracy: 50.90
Round   4, Global train loss: 1.472, Global test loss: 1.766, Global test accuracy: 37.04
Round   5, Train loss: 1.446, Test loss: 1.162, Test accuracy: 57.28
Round   5, Global train loss: 1.446, Global test loss: 1.844, Global test accuracy: 34.72
Round   6, Train loss: 1.248, Test loss: 1.137, Test accuracy: 58.04
Round   6, Global train loss: 1.248, Global test loss: 1.917, Global test accuracy: 30.56
Round   7, Train loss: 1.322, Test loss: 1.103, Test accuracy: 60.10
Round   7, Global train loss: 1.322, Global test loss: 1.678, Global test accuracy: 43.30
Round   8, Train loss: 1.331, Test loss: 1.073, Test accuracy: 61.20
Round   8, Global train loss: 1.331, Global test loss: 1.931, Global test accuracy: 40.12
Round   9, Train loss: 1.190, Test loss: 1.048, Test accuracy: 61.84
Round   9, Global train loss: 1.190, Global test loss: 1.535, Global test accuracy: 48.58
Round  10, Train loss: 1.122, Test loss: 1.039, Test accuracy: 62.34
Round  10, Global train loss: 1.122, Global test loss: 1.586, Global test accuracy: 45.62
Round  11, Train loss: 1.073, Test loss: 1.031, Test accuracy: 62.68
Round  11, Global train loss: 1.073, Global test loss: 1.573, Global test accuracy: 47.40
Round  12, Train loss: 1.039, Test loss: 0.996, Test accuracy: 64.42
Round  12, Global train loss: 1.039, Global test loss: 1.600, Global test accuracy: 46.38
Round  13, Train loss: 1.295, Test loss: 0.954, Test accuracy: 67.72
Round  13, Global train loss: 1.295, Global test loss: 1.573, Global test accuracy: 47.04
Round  14, Train loss: 1.162, Test loss: 0.945, Test accuracy: 67.14
Round  14, Global train loss: 1.162, Global test loss: 1.469, Global test accuracy: 53.54
Round  15, Train loss: 1.124, Test loss: 0.923, Test accuracy: 68.32
Round  15, Global train loss: 1.124, Global test loss: 1.419, Global test accuracy: 53.38
Round  16, Train loss: 1.073, Test loss: 0.916, Test accuracy: 68.32
Round  16, Global train loss: 1.073, Global test loss: 1.482, Global test accuracy: 51.26
Round  17, Train loss: 1.036, Test loss: 0.893, Test accuracy: 70.04
Round  17, Global train loss: 1.036, Global test loss: 1.374, Global test accuracy: 55.92
Round  18, Train loss: 0.907, Test loss: 0.873, Test accuracy: 70.60
Round  18, Global train loss: 0.907, Global test loss: 1.264, Global test accuracy: 58.36
Round  19, Train loss: 1.249, Test loss: 0.877, Test accuracy: 70.70
Round  19, Global train loss: 1.249, Global test loss: 1.434, Global test accuracy: 54.08
Round  20, Train loss: 1.151, Test loss: 0.868, Test accuracy: 70.48
Round  20, Global train loss: 1.151, Global test loss: 1.452, Global test accuracy: 54.22
Round  21, Train loss: 0.866, Test loss: 0.876, Test accuracy: 69.76
Round  21, Global train loss: 0.866, Global test loss: 1.423, Global test accuracy: 52.16
Round  22, Train loss: 0.836, Test loss: 0.848, Test accuracy: 70.46
Round  22, Global train loss: 0.836, Global test loss: 1.478, Global test accuracy: 51.24
Round  23, Train loss: 0.922, Test loss: 0.857, Test accuracy: 70.96
Round  23, Global train loss: 0.922, Global test loss: 1.303, Global test accuracy: 57.88
Round  24, Train loss: 0.822, Test loss: 0.860, Test accuracy: 71.94
Round  24, Global train loss: 0.822, Global test loss: 1.116, Global test accuracy: 64.32
Round  25, Train loss: 0.909, Test loss: 0.858, Test accuracy: 71.98
Round  25, Global train loss: 0.909, Global test loss: 1.309, Global test accuracy: 58.12
Round  26, Train loss: 0.680, Test loss: 0.852, Test accuracy: 71.98
Round  26, Global train loss: 0.680, Global test loss: 1.193, Global test accuracy: 61.92
Round  27, Train loss: 1.006, Test loss: 0.841, Test accuracy: 72.26
Round  27, Global train loss: 1.006, Global test loss: 1.302, Global test accuracy: 60.06
Round  28, Train loss: 0.740, Test loss: 0.822, Test accuracy: 72.98
Round  28, Global train loss: 0.740, Global test loss: 1.272, Global test accuracy: 59.58
Round  29, Train loss: 0.728, Test loss: 0.840, Test accuracy: 72.40
Round  29, Global train loss: 0.728, Global test loss: 1.332, Global test accuracy: 58.48
Round  30, Train loss: 0.682, Test loss: 0.861, Test accuracy: 72.10
Round  30, Global train loss: 0.682, Global test loss: 1.303, Global test accuracy: 56.98
Round  31, Train loss: 0.636, Test loss: 0.850, Test accuracy: 72.42
Round  31, Global train loss: 0.636, Global test loss: 1.385, Global test accuracy: 54.48
Round  32, Train loss: 0.640, Test loss: 0.833, Test accuracy: 72.98
Round  32, Global train loss: 0.640, Global test loss: 1.364, Global test accuracy: 59.26
Round  33, Train loss: 0.536, Test loss: 0.831, Test accuracy: 73.20
Round  33, Global train loss: 0.536, Global test loss: 1.394, Global test accuracy: 56.66
Round  34, Train loss: 0.658, Test loss: 0.846, Test accuracy: 73.12
Round  34, Global train loss: 0.658, Global test loss: 1.149, Global test accuracy: 62.74
Round  35, Train loss: 0.864, Test loss: 0.838, Test accuracy: 72.78
Round  35, Global train loss: 0.864, Global test loss: 1.285, Global test accuracy: 59.60
Round  36, Train loss: 0.843, Test loss: 0.837, Test accuracy: 72.70
Round  36, Global train loss: 0.843, Global test loss: 1.172, Global test accuracy: 61.88
Round  37, Train loss: 0.784, Test loss: 0.826, Test accuracy: 73.22
Round  37, Global train loss: 0.784, Global test loss: 1.242, Global test accuracy: 60.30
Round  38, Train loss: 0.640, Test loss: 0.830, Test accuracy: 73.26
Round  38, Global train loss: 0.640, Global test loss: 1.235, Global test accuracy: 61.40
Round  39, Train loss: 0.751, Test loss: 0.829, Test accuracy: 72.76
Round  39, Global train loss: 0.751, Global test loss: 1.194, Global test accuracy: 63.56
Round  40, Train loss: 0.635, Test loss: 0.834, Test accuracy: 72.88
Round  40, Global train loss: 0.635, Global test loss: 1.273, Global test accuracy: 58.92
Round  41, Train loss: 0.821, Test loss: 0.831, Test accuracy: 72.94
Round  41, Global train loss: 0.821, Global test loss: 1.281, Global test accuracy: 59.66
Round  42, Train loss: 0.968, Test loss: 0.848, Test accuracy: 72.52
Round  42, Global train loss: 0.968, Global test loss: 1.226, Global test accuracy: 59.76
Round  43, Train loss: 0.889, Test loss: 0.831, Test accuracy: 73.36
Round  43, Global train loss: 0.889, Global test loss: 1.291, Global test accuracy: 59.86
Round  44, Train loss: 0.525, Test loss: 0.803, Test accuracy: 73.96
Round  44, Global train loss: 0.525, Global test loss: 1.413, Global test accuracy: 58.08
Round  45, Train loss: 0.767, Test loss: 0.806, Test accuracy: 73.72
Round  45, Global train loss: 0.767, Global test loss: 1.126, Global test accuracy: 62.16
Round  46, Train loss: 0.494, Test loss: 0.831, Test accuracy: 72.72
Round  46, Global train loss: 0.494, Global test loss: 1.252, Global test accuracy: 60.42
Round  47, Train loss: 0.505, Test loss: 0.842, Test accuracy: 72.52
Round  47, Global train loss: 0.505, Global test loss: 1.312, Global test accuracy: 59.86
Round  48, Train loss: 0.664, Test loss: 0.881, Test accuracy: 71.74
Round  48, Global train loss: 0.664, Global test loss: 1.103, Global test accuracy: 64.06
Round  49, Train loss: 0.381, Test loss: 0.897, Test accuracy: 71.58
Round  49, Global train loss: 0.381, Global test loss: 1.134, Global test accuracy: 65.22
Round  50, Train loss: 0.549, Test loss: 0.865, Test accuracy: 72.20
Round  50, Global train loss: 0.549, Global test loss: 1.238, Global test accuracy: 62.52
Round  51, Train loss: 0.705, Test loss: 0.887, Test accuracy: 72.18
Round  51, Global train loss: 0.705, Global test loss: 1.275, Global test accuracy: 60.68
Round  52, Train loss: 0.451, Test loss: 0.920, Test accuracy: 71.56
Round  52, Global train loss: 0.451, Global test loss: 1.116, Global test accuracy: 66.14
Round  53, Train loss: 0.663, Test loss: 0.939, Test accuracy: 71.32
Round  53, Global train loss: 0.663, Global test loss: 1.115, Global test accuracy: 63.44
Round  54, Train loss: 0.396, Test loss: 0.938, Test accuracy: 71.58
Round  54, Global train loss: 0.396, Global test loss: 1.433, Global test accuracy: 58.74
Round  55, Train loss: 0.441, Test loss: 0.956, Test accuracy: 70.98
Round  55, Global train loss: 0.441, Global test loss: 1.313, Global test accuracy: 61.96
Round  56, Train loss: 0.562, Test loss: 0.957, Test accuracy: 71.20
Round  56, Global train loss: 0.562, Global test loss: 1.418, Global test accuracy: 59.50
Round  57, Train loss: 0.620, Test loss: 0.938, Test accuracy: 71.54
Round  57, Global train loss: 0.620, Global test loss: 1.192, Global test accuracy: 64.06
Round  58, Train loss: 0.472, Test loss: 0.925, Test accuracy: 71.52
Round  58, Global train loss: 0.472, Global test loss: 1.330, Global test accuracy: 61.98
Round  59, Train loss: 0.290, Test loss: 0.910, Test accuracy: 71.66
Round  59, Global train loss: 0.290, Global test loss: 1.244, Global test accuracy: 64.48
Round  60, Train loss: 0.310, Test loss: 0.941, Test accuracy: 71.62
Round  60, Global train loss: 0.310, Global test loss: 1.456, Global test accuracy: 61.44
Round  61, Train loss: 0.444, Test loss: 0.947, Test accuracy: 71.20
Round  61, Global train loss: 0.444, Global test loss: 1.253, Global test accuracy: 63.90
Round  62, Train loss: 0.600, Test loss: 0.946, Test accuracy: 72.14
Round  62, Global train loss: 0.600, Global test loss: 1.280, Global test accuracy: 61.00
Round  63, Train loss: 0.562, Test loss: 0.950, Test accuracy: 71.96
Round  63, Global train loss: 0.562, Global test loss: 1.268, Global test accuracy: 59.44
Round  64, Train loss: 0.387, Test loss: 0.963, Test accuracy: 71.84
Round  64, Global train loss: 0.387, Global test loss: 1.459, Global test accuracy: 59.08
Round  65, Train loss: 0.439, Test loss: 0.982, Test accuracy: 71.44
Round  65, Global train loss: 0.439, Global test loss: 1.480, Global test accuracy: 56.48
Round  66, Train loss: 0.382, Test loss: 0.954, Test accuracy: 72.50
Round  66, Global train loss: 0.382, Global test loss: 1.314, Global test accuracy: 62.64
Round  67, Train loss: 0.361, Test loss: 0.987, Test accuracy: 72.84
Round  67, Global train loss: 0.361, Global test loss: 1.591, Global test accuracy: 60.12
Round  68, Train loss: 0.430, Test loss: 0.970, Test accuracy: 72.88
Round  68, Global train loss: 0.430, Global test loss: 1.321, Global test accuracy: 58.82
Round  69, Train loss: 0.366, Test loss: 0.972, Test accuracy: 73.22
Round  69, Global train loss: 0.366, Global test loss: 1.389, Global test accuracy: 61.52
Round  70, Train loss: 0.427, Test loss: 0.979, Test accuracy: 73.40
Round  70, Global train loss: 0.427, Global test loss: 1.453, Global test accuracy: 60.46
Round  71, Train loss: 0.248, Test loss: 0.996, Test accuracy: 73.54
Round  71, Global train loss: 0.248, Global test loss: 1.504, Global test accuracy: 61.36
Round  72, Train loss: 0.394, Test loss: 0.985, Test accuracy: 73.10
Round  72, Global train loss: 0.394, Global test loss: 1.430, Global test accuracy: 60.70
Round  73, Train loss: 0.420, Test loss: 1.001, Test accuracy: 73.06
Round  73, Global train loss: 0.420, Global test loss: 1.404, Global test accuracy: 62.46
Round  74, Train loss: 0.295, Test loss: 1.017, Test accuracy: 72.48
Round  74, Global train loss: 0.295, Global test loss: 1.364, Global test accuracy: 64.30
Round  75, Train loss: 0.347, Test loss: 1.041, Test accuracy: 72.28
Round  75, Global train loss: 0.347, Global test loss: 1.350, Global test accuracy: 64.44
Round  76, Train loss: 0.229, Test loss: 1.012, Test accuracy: 72.44
Round  76, Global train loss: 0.229, Global test loss: 1.334, Global test accuracy: 63.74
Round  77, Train loss: 0.217, Test loss: 1.036, Test accuracy: 72.34
Round  77, Global train loss: 0.217, Global test loss: 1.428, Global test accuracy: 63.76
Round  78, Train loss: 0.333, Test loss: 1.006, Test accuracy: 72.78
Round  78, Global train loss: 0.333, Global test loss: 1.376, Global test accuracy: 64.44
Round  79, Train loss: 0.275, Test loss: 0.972, Test accuracy: 73.92
Round  79, Global train loss: 0.275, Global test loss: 1.481, Global test accuracy: 62.12
Round  80, Train loss: 0.374, Test loss: 0.988, Test accuracy: 73.70
Round  80, Global train loss: 0.374, Global test loss: 1.387, Global test accuracy: 64.04
Round  81, Train loss: 0.433, Test loss: 1.025, Test accuracy: 73.00
Round  81, Global train loss: 0.433, Global test loss: 1.544, Global test accuracy: 59.62
Round  82, Train loss: 0.291, Test loss: 1.064, Test accuracy: 71.54
Round  82, Global train loss: 0.291, Global test loss: 1.648, Global test accuracy: 56.54
Round  83, Train loss: 0.332, Test loss: 1.052, Test accuracy: 72.48
Round  83, Global train loss: 0.332, Global test loss: 1.510, Global test accuracy: 60.38
Round  84, Train loss: 0.269, Test loss: 1.061, Test accuracy: 73.28
Round  84, Global train loss: 0.269, Global test loss: 1.545, Global test accuracy: 58.76
Round  85, Train loss: 0.303, Test loss: 1.117, Test accuracy: 72.80
Round  85, Global train loss: 0.303, Global test loss: 1.533, Global test accuracy: 60.48
Round  86, Train loss: 0.253, Test loss: 1.144, Test accuracy: 72.80
Round  86, Global train loss: 0.253, Global test loss: 1.422, Global test accuracy: 62.76
Round  87, Train loss: 0.299, Test loss: 1.122, Test accuracy: 73.48
Round  87, Global train loss: 0.299, Global test loss: 1.557, Global test accuracy: 59.92
Round  88, Train loss: 0.301, Test loss: 1.136, Test accuracy: 72.54
Round  88, Global train loss: 0.301, Global test loss: 1.683, Global test accuracy: 57.18
Round  89, Train loss: 0.245, Test loss: 1.112, Test accuracy: 73.18
Round  89, Global train loss: 0.245, Global test loss: 1.652, Global test accuracy: 60.46
Round  90, Train loss: 0.331, Test loss: 1.168, Test accuracy: 72.44
Round  90, Global train loss: 0.331, Global test loss: 1.516, Global test accuracy: 62.76
Round  91, Train loss: 0.266, Test loss: 1.141, Test accuracy: 72.60
Round  91, Global train loss: 0.266, Global test loss: 1.932, Global test accuracy: 57.60
Round  92, Train loss: 0.263, Test loss: 1.162, Test accuracy: 72.44
Round  92, Global train loss: 0.263, Global test loss: 1.452, Global test accuracy: 63.36
Round  93, Train loss: 0.296, Test loss: 1.158, Test accuracy: 72.12
Round  93, Global train loss: 0.296, Global test loss: 1.595, Global test accuracy: 60.66
Round  94, Train loss: 0.335, Test loss: 1.140, Test accuracy: 72.36
Round  94, Global train loss: 0.335, Global test loss: 1.621, Global test accuracy: 60.86/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.225, Test loss: 1.133, Test accuracy: 73.18
Round  95, Global train loss: 0.225, Global test loss: 1.718, Global test accuracy: 59.56
Round  96, Train loss: 0.217, Test loss: 1.146, Test accuracy: 72.18
Round  96, Global train loss: 0.217, Global test loss: 1.704, Global test accuracy: 55.72
Round  97, Train loss: 0.298, Test loss: 1.160, Test accuracy: 72.50
Round  97, Global train loss: 0.298, Global test loss: 1.425, Global test accuracy: 61.98
Round  98, Train loss: 0.314, Test loss: 1.159, Test accuracy: 72.88
Round  98, Global train loss: 0.314, Global test loss: 1.448, Global test accuracy: 61.54
Round  99, Train loss: 0.220, Test loss: 1.152, Test accuracy: 72.66
Round  99, Global train loss: 0.220, Global test loss: 1.623, Global test accuracy: 59.44
Final Round, Train loss: 0.181, Test loss: 1.220, Test accuracy: 73.02
Final Round, Global train loss: 0.181, Global test loss: 1.623, Global test accuracy: 59.44
Average accuracy final 10 rounds: 72.536 

Average global accuracy final 10 rounds: 60.34800000000001 

1031.3439927101135
[2.2016634941101074, 4.403326988220215, 6.1436567306518555, 7.883986473083496, 9.51936149597168, 11.154736518859863, 12.770198822021484, 14.385661125183105, 16.0237934589386, 17.661925792694092, 19.331533670425415, 21.00114154815674, 22.694576501846313, 24.38801145553589, 26.19780445098877, 28.00759744644165, 29.804118394851685, 31.60063934326172, 33.30817699432373, 35.01571464538574, 36.751460313797, 38.48720598220825, 40.14709424972534, 41.80698251724243, 43.43805408477783, 45.06912565231323, 46.78392267227173, 48.498719692230225, 50.34182000160217, 52.18492031097412, 53.97425198554993, 55.76358366012573, 57.501715898513794, 59.239848136901855, 60.95039701461792, 62.660945892333984, 64.34045219421387, 66.01995849609375, 67.85607624053955, 69.69219398498535, 71.50758051872253, 73.32296705245972, 75.16751646995544, 77.01206588745117, 78.7222044467926, 80.43234300613403, 82.20272159576416, 83.97310018539429, 85.66350269317627, 87.35390520095825, 89.1267728805542, 90.89964056015015, 92.59126234054565, 94.28288412094116, 95.96064686775208, 97.63840961456299, 99.52851939201355, 101.41862916946411, 103.0922691822052, 104.76590919494629, 106.45467329025269, 108.14343738555908, 109.94217300415039, 111.7409086227417, 113.47885012626648, 115.21679162979126, 116.80002117156982, 118.38325071334839, 120.02019834518433, 121.65714597702026, 123.27663707733154, 124.89612817764282, 126.54059886932373, 128.18506956100464, 129.99436044692993, 131.80365133285522, 133.40763187408447, 135.01161241531372, 136.82825255393982, 138.64489269256592, 140.27253437042236, 141.9001760482788, 143.52468705177307, 145.14919805526733, 146.85593581199646, 148.5626735687256, 150.29870557785034, 152.0347375869751, 153.67107105255127, 155.30740451812744, 156.99989080429077, 158.6923770904541, 160.37398028373718, 162.05558347702026, 163.9355173110962, 165.81545114517212, 167.43933606147766, 169.0632209777832, 170.6743381023407, 172.2854552268982, 174.09008193016052, 175.89470863342285, 177.78972554206848, 179.6847424507141, 181.30872201919556, 182.932701587677, 184.59049463272095, 186.2482876777649, 187.99146819114685, 189.7346487045288, 191.64724135398865, 193.5598340034485, 195.31062984466553, 197.06142568588257, 198.7590355873108, 200.456645488739, 202.18691897392273, 203.91719245910645, 205.5637285709381, 207.21026468276978, 208.88096261024475, 210.55166053771973, 212.22412490844727, 213.8965892791748, 215.64572381973267, 217.39485836029053, 219.08797097206116, 220.7810835838318, 222.43915367126465, 224.0972237586975, 225.6615855693817, 227.22594738006592, 229.0302414894104, 230.83453559875488, 232.43003273010254, 234.0255298614502, 235.76432371139526, 237.50311756134033, 239.18258333206177, 240.8620491027832, 242.55655670166016, 244.2510643005371, 245.9216010570526, 247.59213781356812, 249.15387344360352, 250.71560907363892, 252.57388186454773, 254.43215465545654, 256.00525307655334, 257.57835149765015, 259.21105313301086, 260.8437547683716, 262.5000545978546, 264.15635442733765, 265.9719078540802, 267.78746128082275, 269.47578835487366, 271.16411542892456, 272.77724051475525, 274.39036560058594, 275.9393720626831, 277.4883785247803, 279.17172026634216, 280.85506200790405, 282.5191068649292, 284.18315172195435, 285.85643196105957, 287.5297122001648, 289.2204189300537, 290.9111256599426, 292.7219047546387, 294.5326838493347, 296.30745697021484, 298.08223009109497, 299.73413372039795, 301.3860373497009, 303.06374764442444, 304.74145793914795, 306.3012099266052, 307.8609619140625, 309.46666717529297, 311.07237243652344, 312.7730348110199, 314.47369718551636, 316.170627117157, 317.8675570487976, 319.6179578304291, 321.36835861206055, 323.12990522384644, 324.8914518356323, 326.5425639152527, 328.19367599487305, 329.95271587371826, 331.7117557525635, 333.7767479419708, 335.8417401313782, 337.58576488494873, 339.3297896385193, 341.0148456096649, 342.69990158081055, 346.1592917442322, 349.6186819076538]
[29.04, 29.04, 35.38, 35.38, 41.1, 41.1, 46.5, 46.5, 50.9, 50.9, 57.28, 57.28, 58.04, 58.04, 60.1, 60.1, 61.2, 61.2, 61.84, 61.84, 62.34, 62.34, 62.68, 62.68, 64.42, 64.42, 67.72, 67.72, 67.14, 67.14, 68.32, 68.32, 68.32, 68.32, 70.04, 70.04, 70.6, 70.6, 70.7, 70.7, 70.48, 70.48, 69.76, 69.76, 70.46, 70.46, 70.96, 70.96, 71.94, 71.94, 71.98, 71.98, 71.98, 71.98, 72.26, 72.26, 72.98, 72.98, 72.4, 72.4, 72.1, 72.1, 72.42, 72.42, 72.98, 72.98, 73.2, 73.2, 73.12, 73.12, 72.78, 72.78, 72.7, 72.7, 73.22, 73.22, 73.26, 73.26, 72.76, 72.76, 72.88, 72.88, 72.94, 72.94, 72.52, 72.52, 73.36, 73.36, 73.96, 73.96, 73.72, 73.72, 72.72, 72.72, 72.52, 72.52, 71.74, 71.74, 71.58, 71.58, 72.2, 72.2, 72.18, 72.18, 71.56, 71.56, 71.32, 71.32, 71.58, 71.58, 70.98, 70.98, 71.2, 71.2, 71.54, 71.54, 71.52, 71.52, 71.66, 71.66, 71.62, 71.62, 71.2, 71.2, 72.14, 72.14, 71.96, 71.96, 71.84, 71.84, 71.44, 71.44, 72.5, 72.5, 72.84, 72.84, 72.88, 72.88, 73.22, 73.22, 73.4, 73.4, 73.54, 73.54, 73.1, 73.1, 73.06, 73.06, 72.48, 72.48, 72.28, 72.28, 72.44, 72.44, 72.34, 72.34, 72.78, 72.78, 73.92, 73.92, 73.7, 73.7, 73.0, 73.0, 71.54, 71.54, 72.48, 72.48, 73.28, 73.28, 72.8, 72.8, 72.8, 72.8, 73.48, 73.48, 72.54, 72.54, 73.18, 73.18, 72.44, 72.44, 72.6, 72.6, 72.44, 72.44, 72.12, 72.12, 72.36, 72.36, 73.18, 73.18, 72.18, 72.18, 72.5, 72.5, 72.88, 72.88, 72.66, 72.66, 73.02, 73.02]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.721, Test loss: 1.974, Test accuracy: 28.22
Round   0, Global train loss: 1.721, Global test loss: 2.204, Global test accuracy: 24.10
Round   1, Train loss: 1.551, Test loss: 1.717, Test accuracy: 36.14
Round   1, Global train loss: 1.551, Global test loss: 2.153, Global test accuracy: 23.18
Round   2, Train loss: 1.526, Test loss: 1.667, Test accuracy: 39.76
Round   2, Global train loss: 1.526, Global test loss: 2.087, Global test accuracy: 30.10
Round   3, Train loss: 1.339, Test loss: 1.641, Test accuracy: 44.02
Round   3, Global train loss: 1.339, Global test loss: 2.181, Global test accuracy: 33.02
Round   4, Train loss: 1.392, Test loss: 1.375, Test accuracy: 48.96
Round   4, Global train loss: 1.392, Global test loss: 1.765, Global test accuracy: 38.80
Round   5, Train loss: 1.387, Test loss: 1.155, Test accuracy: 56.84
Round   5, Global train loss: 1.387, Global test loss: 1.964, Global test accuracy: 32.30
Round   6, Train loss: 1.248, Test loss: 1.117, Test accuracy: 59.12
Round   6, Global train loss: 1.248, Global test loss: 1.895, Global test accuracy: 33.82
Round   7, Train loss: 1.295, Test loss: 1.092, Test accuracy: 60.60
Round   7, Global train loss: 1.295, Global test loss: 1.635, Global test accuracy: 44.92
Round   8, Train loss: 1.068, Test loss: 1.057, Test accuracy: 62.46
Round   8, Global train loss: 1.068, Global test loss: 1.774, Global test accuracy: 42.96
Round   9, Train loss: 1.037, Test loss: 1.049, Test accuracy: 63.30
Round   9, Global train loss: 1.037, Global test loss: 1.477, Global test accuracy: 47.54
Round  10, Train loss: 1.059, Test loss: 0.995, Test accuracy: 65.02
Round  10, Global train loss: 1.059, Global test loss: 1.669, Global test accuracy: 45.82
Round  11, Train loss: 0.979, Test loss: 0.995, Test accuracy: 65.58
Round  11, Global train loss: 0.979, Global test loss: 1.373, Global test accuracy: 55.96
Round  12, Train loss: 1.106, Test loss: 0.955, Test accuracy: 67.48
Round  12, Global train loss: 1.106, Global test loss: 1.565, Global test accuracy: 48.46
Round  13, Train loss: 1.452, Test loss: 0.937, Test accuracy: 68.20
Round  13, Global train loss: 1.452, Global test loss: 1.621, Global test accuracy: 48.80
Round  14, Train loss: 1.244, Test loss: 0.928, Test accuracy: 67.56
Round  14, Global train loss: 1.244, Global test loss: 1.563, Global test accuracy: 49.98
Round  15, Train loss: 0.916, Test loss: 0.912, Test accuracy: 68.50
Round  15, Global train loss: 0.916, Global test loss: 1.347, Global test accuracy: 54.08
Round  16, Train loss: 0.930, Test loss: 0.898, Test accuracy: 68.96
Round  16, Global train loss: 0.930, Global test loss: 1.382, Global test accuracy: 53.20
Round  17, Train loss: 1.007, Test loss: 0.898, Test accuracy: 69.22
Round  17, Global train loss: 1.007, Global test loss: 1.295, Global test accuracy: 56.90
Round  18, Train loss: 0.757, Test loss: 0.904, Test accuracy: 69.36
Round  18, Global train loss: 0.757, Global test loss: 1.184, Global test accuracy: 59.64
Round  19, Train loss: 1.068, Test loss: 0.888, Test accuracy: 69.94
Round  19, Global train loss: 1.068, Global test loss: 1.458, Global test accuracy: 51.36
Round  20, Train loss: 1.064, Test loss: 0.883, Test accuracy: 69.90
Round  20, Global train loss: 1.064, Global test loss: 1.425, Global test accuracy: 54.92
Round  21, Train loss: 0.690, Test loss: 0.860, Test accuracy: 71.00
Round  21, Global train loss: 0.690, Global test loss: 1.316, Global test accuracy: 56.62
Round  22, Train loss: 0.704, Test loss: 0.877, Test accuracy: 71.42
Round  22, Global train loss: 0.704, Global test loss: 1.332, Global test accuracy: 56.16
Round  23, Train loss: 1.002, Test loss: 0.855, Test accuracy: 72.80
Round  23, Global train loss: 1.002, Global test loss: 1.286, Global test accuracy: 59.32
Round  24, Train loss: 0.725, Test loss: 0.842, Test accuracy: 73.38
Round  24, Global train loss: 0.725, Global test loss: 1.137, Global test accuracy: 61.68
Round  25, Train loss: 0.965, Test loss: 0.837, Test accuracy: 72.84
Round  25, Global train loss: 0.965, Global test loss: 1.304, Global test accuracy: 58.10
Round  26, Train loss: 0.643, Test loss: 0.837, Test accuracy: 72.66
Round  26, Global train loss: 0.643, Global test loss: 1.157, Global test accuracy: 62.60
Round  27, Train loss: 0.862, Test loss: 0.855, Test accuracy: 72.78
Round  27, Global train loss: 0.862, Global test loss: 1.304, Global test accuracy: 59.32
Round  28, Train loss: 0.746, Test loss: 0.873, Test accuracy: 72.52
Round  28, Global train loss: 0.746, Global test loss: 1.424, Global test accuracy: 56.16
Round  29, Train loss: 0.752, Test loss: 0.853, Test accuracy: 72.96
Round  29, Global train loss: 0.752, Global test loss: 1.290, Global test accuracy: 58.64
Round  30, Train loss: 0.623, Test loss: 0.840, Test accuracy: 73.58
Round  30, Global train loss: 0.623, Global test loss: 1.421, Global test accuracy: 57.20
Round  31, Train loss: 0.533, Test loss: 0.830, Test accuracy: 73.78
Round  31, Global train loss: 0.533, Global test loss: 1.496, Global test accuracy: 55.66
Round  32, Train loss: 0.541, Test loss: 0.851, Test accuracy: 73.20
Round  32, Global train loss: 0.541, Global test loss: 1.390, Global test accuracy: 57.78
Round  33, Train loss: 0.462, Test loss: 0.856, Test accuracy: 73.16
Round  33, Global train loss: 0.462, Global test loss: 1.593, Global test accuracy: 57.58
Round  34, Train loss: 0.697, Test loss: 0.850, Test accuracy: 73.32
Round  34, Global train loss: 0.697, Global test loss: 1.193, Global test accuracy: 61.50
Round  35, Train loss: 0.601, Test loss: 0.854, Test accuracy: 73.64
Round  35, Global train loss: 0.601, Global test loss: 1.306, Global test accuracy: 58.14
Round  36, Train loss: 0.629, Test loss: 0.843, Test accuracy: 74.02
Round  36, Global train loss: 0.629, Global test loss: 1.190, Global test accuracy: 61.92
Round  37, Train loss: 0.516, Test loss: 0.846, Test accuracy: 74.14
Round  37, Global train loss: 0.516, Global test loss: 1.355, Global test accuracy: 58.12
Round  38, Train loss: 0.392, Test loss: 0.814, Test accuracy: 74.68
Round  38, Global train loss: 0.392, Global test loss: 1.152, Global test accuracy: 64.72
Round  39, Train loss: 0.920, Test loss: 0.813, Test accuracy: 75.12
Round  39, Global train loss: 0.920, Global test loss: 1.191, Global test accuracy: 63.20
Round  40, Train loss: 0.458, Test loss: 0.859, Test accuracy: 74.60
Round  40, Global train loss: 0.458, Global test loss: 1.246, Global test accuracy: 61.60
Round  41, Train loss: 0.885, Test loss: 0.820, Test accuracy: 75.40
Round  41, Global train loss: 0.885, Global test loss: 1.278, Global test accuracy: 60.42
Round  42, Train loss: 0.843, Test loss: 0.817, Test accuracy: 74.50
Round  42, Global train loss: 0.843, Global test loss: 1.162, Global test accuracy: 65.00
Round  43, Train loss: 0.690, Test loss: 0.841, Test accuracy: 73.94
Round  43, Global train loss: 0.690, Global test loss: 1.330, Global test accuracy: 58.10
Round  44, Train loss: 0.452, Test loss: 0.855, Test accuracy: 73.86
Round  44, Global train loss: 0.452, Global test loss: 1.230, Global test accuracy: 62.82
Round  45, Train loss: 0.603, Test loss: 0.843, Test accuracy: 74.84
Round  45, Global train loss: 0.603, Global test loss: 1.119, Global test accuracy: 65.94
Round  46, Train loss: 0.463, Test loss: 0.875, Test accuracy: 73.80
Round  46, Global train loss: 0.463, Global test loss: 1.274, Global test accuracy: 61.96
Round  47, Train loss: 0.645, Test loss: 0.846, Test accuracy: 74.10
Round  47, Global train loss: 0.645, Global test loss: 1.228, Global test accuracy: 62.30
Round  48, Train loss: 0.603, Test loss: 0.857, Test accuracy: 74.30
Round  48, Global train loss: 0.603, Global test loss: 1.123, Global test accuracy: 64.36
Round  49, Train loss: 0.345, Test loss: 0.852, Test accuracy: 74.54
Round  49, Global train loss: 0.345, Global test loss: 1.195, Global test accuracy: 64.10
Round  50, Train loss: 0.597, Test loss: 0.865, Test accuracy: 74.16
Round  50, Global train loss: 0.597, Global test loss: 1.265, Global test accuracy: 60.94
Round  51, Train loss: 0.553, Test loss: 0.863, Test accuracy: 74.32
Round  51, Global train loss: 0.553, Global test loss: 1.205, Global test accuracy: 64.24
Round  52, Train loss: 0.330, Test loss: 0.902, Test accuracy: 74.10
Round  52, Global train loss: 0.330, Global test loss: 1.193, Global test accuracy: 65.66
Round  53, Train loss: 0.628, Test loss: 0.887, Test accuracy: 74.46
Round  53, Global train loss: 0.628, Global test loss: 1.130, Global test accuracy: 63.56
Round  54, Train loss: 0.331, Test loss: 0.892, Test accuracy: 74.48
Round  54, Global train loss: 0.331, Global test loss: 1.753, Global test accuracy: 58.86
Round  55, Train loss: 0.506, Test loss: 0.883, Test accuracy: 74.12
Round  55, Global train loss: 0.506, Global test loss: 1.240, Global test accuracy: 63.12
Round  56, Train loss: 0.573, Test loss: 0.912, Test accuracy: 73.58
Round  56, Global train loss: 0.573, Global test loss: 1.378, Global test accuracy: 61.06
Round  57, Train loss: 0.504, Test loss: 0.950, Test accuracy: 72.76
Round  57, Global train loss: 0.504, Global test loss: 1.189, Global test accuracy: 65.62
Round  58, Train loss: 0.495, Test loss: 0.911, Test accuracy: 73.38
Round  58, Global train loss: 0.495, Global test loss: 1.419, Global test accuracy: 60.40
Round  59, Train loss: 0.203, Test loss: 0.907, Test accuracy: 73.62
Round  59, Global train loss: 0.203, Global test loss: 1.234, Global test accuracy: 67.64
Round  60, Train loss: 0.381, Test loss: 0.938, Test accuracy: 72.94
Round  60, Global train loss: 0.381, Global test loss: 1.375, Global test accuracy: 62.96
Round  61, Train loss: 0.282, Test loss: 0.927, Test accuracy: 72.88
Round  61, Global train loss: 0.282, Global test loss: 1.256, Global test accuracy: 66.00
Round  62, Train loss: 0.481, Test loss: 0.936, Test accuracy: 73.06
Round  62, Global train loss: 0.481, Global test loss: 1.175, Global test accuracy: 67.08
Round  63, Train loss: 0.556, Test loss: 0.976, Test accuracy: 72.84
Round  63, Global train loss: 0.556, Global test loss: 1.301, Global test accuracy: 63.70
Round  64, Train loss: 0.459, Test loss: 1.011, Test accuracy: 73.26
Round  64, Global train loss: 0.459, Global test loss: 1.472, Global test accuracy: 59.04
Round  65, Train loss: 0.514, Test loss: 1.032, Test accuracy: 72.42
Round  65, Global train loss: 0.514, Global test loss: 1.482, Global test accuracy: 58.02
Round  66, Train loss: 0.359, Test loss: 1.028, Test accuracy: 72.82
Round  66, Global train loss: 0.359, Global test loss: 1.340, Global test accuracy: 62.52
Round  67, Train loss: 0.313, Test loss: 0.984, Test accuracy: 73.18
Round  67, Global train loss: 0.313, Global test loss: 1.588, Global test accuracy: 60.76
Round  68, Train loss: 0.477, Test loss: 0.990, Test accuracy: 72.98
Round  68, Global train loss: 0.477, Global test loss: 1.367, Global test accuracy: 60.42
Round  69, Train loss: 0.437, Test loss: 1.016, Test accuracy: 72.32
Round  69, Global train loss: 0.437, Global test loss: 1.448, Global test accuracy: 59.80
Round  70, Train loss: 0.393, Test loss: 1.047, Test accuracy: 72.20
Round  70, Global train loss: 0.393, Global test loss: 1.489, Global test accuracy: 59.02
Round  71, Train loss: 0.259, Test loss: 1.095, Test accuracy: 71.26
Round  71, Global train loss: 0.259, Global test loss: 1.494, Global test accuracy: 62.18
Round  72, Train loss: 0.263, Test loss: 1.071, Test accuracy: 71.36
Round  72, Global train loss: 0.263, Global test loss: 1.402, Global test accuracy: 63.36
Round  73, Train loss: 0.290, Test loss: 1.074, Test accuracy: 71.90
Round  73, Global train loss: 0.290, Global test loss: 1.347, Global test accuracy: 65.48
Round  74, Train loss: 0.347, Test loss: 1.051, Test accuracy: 72.72
Round  74, Global train loss: 0.347, Global test loss: 1.357, Global test accuracy: 63.48
Round  75, Train loss: 0.309, Test loss: 1.061, Test accuracy: 72.42
Round  75, Global train loss: 0.309, Global test loss: 1.396, Global test accuracy: 62.74
Round  76, Train loss: 0.190, Test loss: 1.071, Test accuracy: 73.00
Round  76, Global train loss: 0.190, Global test loss: 1.680, Global test accuracy: 61.70
Round  77, Train loss: 0.295, Test loss: 1.076, Test accuracy: 72.40
Round  77, Global train loss: 0.295, Global test loss: 1.391, Global test accuracy: 63.02
Round  78, Train loss: 0.228, Test loss: 1.050, Test accuracy: 72.64
Round  78, Global train loss: 0.228, Global test loss: 1.549, Global test accuracy: 64.40
Round  79, Train loss: 0.264, Test loss: 1.093, Test accuracy: 72.28
Round  79, Global train loss: 0.264, Global test loss: 1.703, Global test accuracy: 58.22
Round  80, Train loss: 0.250, Test loss: 1.128, Test accuracy: 72.34
Round  80, Global train loss: 0.250, Global test loss: 1.426, Global test accuracy: 64.38
Round  81, Train loss: 0.327, Test loss: 1.126, Test accuracy: 72.24
Round  81, Global train loss: 0.327, Global test loss: 1.525, Global test accuracy: 60.80
Round  82, Train loss: 0.360, Test loss: 1.141, Test accuracy: 71.60
Round  82, Global train loss: 0.360, Global test loss: 1.576, Global test accuracy: 58.24
Round  83, Train loss: 0.256, Test loss: 1.176, Test accuracy: 71.70
Round  83, Global train loss: 0.256, Global test loss: 1.632, Global test accuracy: 62.40
Round  84, Train loss: 0.339, Test loss: 1.203, Test accuracy: 71.32
Round  84, Global train loss: 0.339, Global test loss: 1.712, Global test accuracy: 57.84
Round  85, Train loss: 0.320, Test loss: 1.202, Test accuracy: 71.80
Round  85, Global train loss: 0.320, Global test loss: 1.700, Global test accuracy: 57.88
Round  86, Train loss: 0.202, Test loss: 1.203, Test accuracy: 72.04
Round  86, Global train loss: 0.202, Global test loss: 1.538, Global test accuracy: 63.36
Round  87, Train loss: 0.307, Test loss: 1.192, Test accuracy: 72.26
Round  87, Global train loss: 0.307, Global test loss: 1.466, Global test accuracy: 62.54
Round  88, Train loss: 0.342, Test loss: 1.214, Test accuracy: 72.14
Round  88, Global train loss: 0.342, Global test loss: 1.683, Global test accuracy: 58.32
Round  89, Train loss: 0.276, Test loss: 1.213, Test accuracy: 72.36
Round  89, Global train loss: 0.276, Global test loss: 1.737, Global test accuracy: 58.88
Round  90, Train loss: 0.319, Test loss: 1.221, Test accuracy: 72.06
Round  90, Global train loss: 0.319, Global test loss: 1.881, Global test accuracy: 57.92
Round  91, Train loss: 0.295, Test loss: 1.227, Test accuracy: 72.12
Round  91, Global train loss: 0.295, Global test loss: 2.037, Global test accuracy: 56.44
Round  92, Train loss: 0.206, Test loss: 1.222, Test accuracy: 71.70
Round  92, Global train loss: 0.206, Global test loss: 1.711, Global test accuracy: 59.60
Round  93, Train loss: 0.221, Test loss: 1.197, Test accuracy: 71.74
Round  93, Global train loss: 0.221, Global test loss: 1.555, Global test accuracy: 63.20
Round  94, Train loss: 0.240, Test loss: 1.214, Test accuracy: 71.90
Round  94, Global train loss: 0.240, Global test loss: 1.562, Global test accuracy: 64.30
Round  95, Train loss: 0.310, Test loss: 1.178, Test accuracy: 72.22
Round  95, Global train loss: 0.310, Global test loss: 1.698, Global test accuracy: 59.14
Round  96, Train loss: 0.275, Test loss: 1.178, Test accuracy: 72.38
Round  96, Global train loss: 0.275, Global test loss: 1.677, Global test accuracy: 57.76
Round  97, Train loss: 0.235, Test loss: 1.215, Test accuracy: 72.04
Round  97, Global train loss: 0.235, Global test loss: 1.422, Global test accuracy: 63.48
Round  98, Train loss: 0.224, Test loss: 1.229, Test accuracy: 71.94
Round  98, Global train loss: 0.224, Global test loss: 1.428, Global test accuracy: 63.20
Round  99, Train loss: 0.153, Test loss: 1.221, Test accuracy: 71.88
Round  99, Global train loss: 0.153, Global test loss: 1.754, Global test accuracy: 63.28
Final Round, Train loss: 0.169, Test loss: 1.273, Test accuracy: 73.40
Final Round, Global train loss: 0.169, Global test loss: 1.754, Global test accuracy: 63.28
Average accuracy final 10 rounds: 71.998
Average global accuracy final 10 rounds: 60.832
1529.374925851822
[3.9077916145324707, 7.621491193771362, 11.34586238861084, 15.136626720428467, 18.79340624809265, 22.833486795425415, 26.601620197296143, 30.35617995262146, 34.37889122962952, 38.038631200790405, 41.791372776031494, 45.65680766105652, 49.57221722602844, 53.433720111846924, 57.47191143035889, 61.48833513259888, 65.32877612113953, 69.44083833694458, 73.81403064727783, 78.00979566574097, 82.44061040878296, 86.87144422531128, 90.6901638507843, 94.90371918678284, 99.12591052055359, 103.22783732414246, 107.0823929309845, 110.94578742980957, 114.78984522819519, 118.62426614761353, 122.62944650650024, 126.40945959091187, 130.30068469047546, 134.23071384429932, 138.38439869880676, 142.09666991233826, 146.58694577217102, 151.12611985206604, 155.05378365516663, 159.73035764694214, 163.75346040725708, 167.6655957698822, 171.97900795936584, 176.53324389457703, 180.3304831981659, 184.01498579978943, 187.77263474464417, 191.4826762676239, 195.3484926223755, 199.17148447036743, 202.85140872001648, 206.5689902305603, 210.15118885040283, 213.88098001480103, 217.6232557296753, 221.47103548049927, 225.3064911365509, 228.95871543884277, 232.7380816936493, 236.32830548286438, 240.21164631843567, 244.07128071784973, 247.97618460655212, 251.87649941444397, 255.68405508995056, 259.6718313694, 263.50931572914124, 267.2869701385498, 271.09091234207153, 274.95975375175476, 278.6546654701233, 282.3486340045929, 285.9166522026062, 289.6463792324066, 293.52860593795776, 297.341739654541, 301.1392014026642, 305.08801674842834, 308.8502707481384, 312.7422161102295, 316.5326318740845, 320.40216183662415, 324.1761863231659, 327.82766699790955, 331.56199645996094, 335.2916588783264, 338.85163044929504, 342.4477069377899, 346.5219495296478, 350.33568954467773, 354.1034083366394, 357.6582362651825, 361.4392206668854, 365.1665687561035, 368.95831823349, 372.5584943294525, 376.4773817062378, 380.0155646800995, 383.7929263114929, 387.4268262386322, 394.0022666454315]
[28.22, 36.14, 39.76, 44.02, 48.96, 56.84, 59.12, 60.6, 62.46, 63.3, 65.02, 65.58, 67.48, 68.2, 67.56, 68.5, 68.96, 69.22, 69.36, 69.94, 69.9, 71.0, 71.42, 72.8, 73.38, 72.84, 72.66, 72.78, 72.52, 72.96, 73.58, 73.78, 73.2, 73.16, 73.32, 73.64, 74.02, 74.14, 74.68, 75.12, 74.6, 75.4, 74.5, 73.94, 73.86, 74.84, 73.8, 74.1, 74.3, 74.54, 74.16, 74.32, 74.1, 74.46, 74.48, 74.12, 73.58, 72.76, 73.38, 73.62, 72.94, 72.88, 73.06, 72.84, 73.26, 72.42, 72.82, 73.18, 72.98, 72.32, 72.2, 71.26, 71.36, 71.9, 72.72, 72.42, 73.0, 72.4, 72.64, 72.28, 72.34, 72.24, 71.6, 71.7, 71.32, 71.8, 72.04, 72.26, 72.14, 72.36, 72.06, 72.12, 71.7, 71.74, 71.9, 72.22, 72.38, 72.04, 71.94, 71.88, 73.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.992, Test loss: 2.102, Test accuracy: 25.44
Round   0, Global train loss: 1.992, Global test loss: 2.196, Global test accuracy: 23.62
Round   1, Train loss: 1.731, Test loss: 1.993, Test accuracy: 26.58
Round   1, Global train loss: 1.731, Global test loss: 2.330, Global test accuracy: 10.30
Round   2, Train loss: 1.618, Test loss: 1.932, Test accuracy: 31.98
Round   2, Global train loss: 1.618, Global test loss: 2.317, Global test accuracy: 20.22
Round   3, Train loss: 1.531, Test loss: 1.743, Test accuracy: 40.54
Round   3, Global train loss: 1.531, Global test loss: 2.224, Global test accuracy: 28.42
Round   4, Train loss: 1.514, Test loss: 1.513, Test accuracy: 49.08
Round   4, Global train loss: 1.514, Global test loss: 1.985, Global test accuracy: 33.70
Round   5, Train loss: 1.480, Test loss: 1.194, Test accuracy: 58.12
Round   5, Global train loss: 1.480, Global test loss: 2.225, Global test accuracy: 21.56
Round   6, Train loss: 1.260, Test loss: 1.187, Test accuracy: 55.92
Round   6, Global train loss: 1.260, Global test loss: 2.157, Global test accuracy: 30.20
Round   7, Train loss: 1.298, Test loss: 1.153, Test accuracy: 59.94
Round   7, Global train loss: 1.298, Global test loss: 1.913, Global test accuracy: 36.64
Round   8, Train loss: 1.312, Test loss: 1.170, Test accuracy: 59.68
Round   8, Global train loss: 1.312, Global test loss: 2.317, Global test accuracy: 25.76
Round   9, Train loss: 1.203, Test loss: 1.071, Test accuracy: 64.56
Round   9, Global train loss: 1.203, Global test loss: 1.887, Global test accuracy: 33.36
Round  10, Train loss: 1.169, Test loss: 1.051, Test accuracy: 65.92
Round  10, Global train loss: 1.169, Global test loss: 1.909, Global test accuracy: 37.94
Round  11, Train loss: 1.089, Test loss: 1.077, Test accuracy: 65.32
Round  11, Global train loss: 1.089, Global test loss: 1.719, Global test accuracy: 45.28
Round  12, Train loss: 1.168, Test loss: 1.056, Test accuracy: 66.12
Round  12, Global train loss: 1.168, Global test loss: 1.909, Global test accuracy: 30.26
Round  13, Train loss: 1.286, Test loss: 0.988, Test accuracy: 67.18
Round  13, Global train loss: 1.286, Global test loss: 1.947, Global test accuracy: 26.80
Round  14, Train loss: 1.211, Test loss: 0.953, Test accuracy: 68.84
Round  14, Global train loss: 1.211, Global test loss: 1.725, Global test accuracy: 46.42
Round  15, Train loss: 1.150, Test loss: 0.952, Test accuracy: 68.06
Round  15, Global train loss: 1.150, Global test loss: 1.877, Global test accuracy: 43.78
Round  16, Train loss: 1.118, Test loss: 0.927, Test accuracy: 69.86
Round  16, Global train loss: 1.118, Global test loss: 1.969, Global test accuracy: 31.10
Round  17, Train loss: 0.973, Test loss: 0.930, Test accuracy: 71.10
Round  17, Global train loss: 0.973, Global test loss: 1.702, Global test accuracy: 45.96
Round  18, Train loss: 0.958, Test loss: 0.934, Test accuracy: 70.92
Round  18, Global train loss: 0.958, Global test loss: 1.709, Global test accuracy: 40.76
Round  19, Train loss: 1.179, Test loss: 0.884, Test accuracy: 72.32
Round  19, Global train loss: 1.179, Global test loss: 2.147, Global test accuracy: 30.72
Round  20, Train loss: 1.088, Test loss: 0.919, Test accuracy: 71.20
Round  20, Global train loss: 1.088, Global test loss: 1.742, Global test accuracy: 48.46
Round  21, Train loss: 0.887, Test loss: 0.885, Test accuracy: 71.74
Round  21, Global train loss: 0.887, Global test loss: 1.900, Global test accuracy: 37.22
Round  22, Train loss: 0.831, Test loss: 0.861, Test accuracy: 72.86
Round  22, Global train loss: 0.831, Global test loss: 1.779, Global test accuracy: 42.26
Round  23, Train loss: 1.075, Test loss: 0.846, Test accuracy: 73.82
Round  23, Global train loss: 1.075, Global test loss: 1.697, Global test accuracy: 48.16
Round  24, Train loss: 0.877, Test loss: 0.798, Test accuracy: 73.50
Round  24, Global train loss: 0.877, Global test loss: 1.486, Global test accuracy: 47.02
Round  25, Train loss: 1.034, Test loss: 0.793, Test accuracy: 73.60
Round  25, Global train loss: 1.034, Global test loss: 1.803, Global test accuracy: 37.44
Round  26, Train loss: 0.759, Test loss: 0.797, Test accuracy: 74.06
Round  26, Global train loss: 0.759, Global test loss: 1.499, Global test accuracy: 52.48
Round  27, Train loss: 1.186, Test loss: 0.802, Test accuracy: 73.84
Round  27, Global train loss: 1.186, Global test loss: 2.002, Global test accuracy: 37.56
Round  28, Train loss: 0.744, Test loss: 0.785, Test accuracy: 75.06
Round  28, Global train loss: 0.744, Global test loss: 1.715, Global test accuracy: 43.10
Round  29, Train loss: 0.943, Test loss: 0.783, Test accuracy: 75.62
Round  29, Global train loss: 0.943, Global test loss: 1.821, Global test accuracy: 48.82
Round  30, Train loss: 0.699, Test loss: 0.776, Test accuracy: 74.34
Round  30, Global train loss: 0.699, Global test loss: 1.981, Global test accuracy: 36.02
Round  31, Train loss: 0.638, Test loss: 0.794, Test accuracy: 74.40
Round  31, Global train loss: 0.638, Global test loss: 1.698, Global test accuracy: 41.94
Round  32, Train loss: 0.714, Test loss: 0.795, Test accuracy: 74.06
Round  32, Global train loss: 0.714, Global test loss: 1.852, Global test accuracy: 46.30
Round  33, Train loss: 0.612, Test loss: 0.791, Test accuracy: 75.40
Round  33, Global train loss: 0.612, Global test loss: 1.795, Global test accuracy: 47.92
Round  34, Train loss: 0.842, Test loss: 0.793, Test accuracy: 75.06
Round  34, Global train loss: 0.842, Global test loss: 1.632, Global test accuracy: 44.08
Round  35, Train loss: 0.912, Test loss: 0.755, Test accuracy: 76.24
Round  35, Global train loss: 0.912, Global test loss: 2.537, Global test accuracy: 28.10
Round  36, Train loss: 0.957, Test loss: 0.735, Test accuracy: 77.44
Round  36, Global train loss: 0.957, Global test loss: 1.619, Global test accuracy: 46.00
Round  37, Train loss: 0.884, Test loss: 0.751, Test accuracy: 76.96
Round  37, Global train loss: 0.884, Global test loss: 2.531, Global test accuracy: 28.62
Round  38, Train loss: 0.757, Test loss: 0.757, Test accuracy: 76.94
Round  38, Global train loss: 0.757, Global test loss: 1.757, Global test accuracy: 36.28
Round  39, Train loss: 1.016, Test loss: 0.716, Test accuracy: 76.98
Round  39, Global train loss: 1.016, Global test loss: 1.575, Global test accuracy: 43.18
Round  40, Train loss: 0.761, Test loss: 0.752, Test accuracy: 76.74
Round  40, Global train loss: 0.761, Global test loss: 1.599, Global test accuracy: 56.10
Round  41, Train loss: 0.718, Test loss: 0.739, Test accuracy: 76.16
Round  41, Global train loss: 0.718, Global test loss: 1.747, Global test accuracy: 44.32
Round  42, Train loss: 0.995, Test loss: 0.703, Test accuracy: 77.32
Round  42, Global train loss: 0.995, Global test loss: 1.655, Global test accuracy: 44.86
Round  43, Train loss: 0.890, Test loss: 0.725, Test accuracy: 77.40
Round  43, Global train loss: 0.890, Global test loss: 2.227, Global test accuracy: 32.14
Round  44, Train loss: 0.565, Test loss: 0.705, Test accuracy: 78.12
Round  44, Global train loss: 0.565, Global test loss: 1.645, Global test accuracy: 46.88
Round  45, Train loss: 0.877, Test loss: 0.693, Test accuracy: 78.48
Round  45, Global train loss: 0.877, Global test loss: 1.520, Global test accuracy: 48.84
Round  46, Train loss: 0.555, Test loss: 0.705, Test accuracy: 77.80
Round  46, Global train loss: 0.555, Global test loss: 1.560, Global test accuracy: 49.86
Round  47, Train loss: 0.805, Test loss: 0.718, Test accuracy: 76.84
Round  47, Global train loss: 0.805, Global test loss: 1.685, Global test accuracy: 40.50
Round  48, Train loss: 0.662, Test loss: 0.690, Test accuracy: 77.38
Round  48, Global train loss: 0.662, Global test loss: 1.328, Global test accuracy: 55.62
Round  49, Train loss: 0.479, Test loss: 0.701, Test accuracy: 78.10
Round  49, Global train loss: 0.479, Global test loss: 1.406, Global test accuracy: 52.66
Round  50, Train loss: 0.805, Test loss: 0.691, Test accuracy: 78.00
Round  50, Global train loss: 0.805, Global test loss: 1.617, Global test accuracy: 53.70
Round  51, Train loss: 0.755, Test loss: 0.702, Test accuracy: 78.38
Round  51, Global train loss: 0.755, Global test loss: 1.543, Global test accuracy: 55.72
Round  52, Train loss: 0.545, Test loss: 0.677, Test accuracy: 79.30
Round  52, Global train loss: 0.545, Global test loss: 1.538, Global test accuracy: 46.40
Round  53, Train loss: 0.690, Test loss: 0.673, Test accuracy: 78.92
Round  53, Global train loss: 0.690, Global test loss: 1.361, Global test accuracy: 52.98
Round  54, Train loss: 0.536, Test loss: 0.700, Test accuracy: 78.58
Round  54, Global train loss: 0.536, Global test loss: 1.854, Global test accuracy: 45.74
Round  55, Train loss: 0.732, Test loss: 0.697, Test accuracy: 78.56
Round  55, Global train loss: 0.732, Global test loss: 1.787, Global test accuracy: 51.82
Round  56, Train loss: 0.587, Test loss: 0.687, Test accuracy: 78.52
Round  56, Global train loss: 0.587, Global test loss: 1.743, Global test accuracy: 44.28
Round  57, Train loss: 0.730, Test loss: 0.666, Test accuracy: 79.14
Round  57, Global train loss: 0.730, Global test loss: 1.540, Global test accuracy: 54.28
Round  58, Train loss: 0.744, Test loss: 0.681, Test accuracy: 78.78
Round  58, Global train loss: 0.744, Global test loss: 2.319, Global test accuracy: 31.34
Round  59, Train loss: 0.380, Test loss: 0.669, Test accuracy: 79.66
Round  59, Global train loss: 0.380, Global test loss: 1.374, Global test accuracy: 51.34
Round  60, Train loss: 0.658, Test loss: 0.687, Test accuracy: 78.10
Round  60, Global train loss: 0.658, Global test loss: 1.678, Global test accuracy: 47.42
Round  61, Train loss: 0.616, Test loss: 0.679, Test accuracy: 79.14
Round  61, Global train loss: 0.616, Global test loss: 1.831, Global test accuracy: 53.26
Round  62, Train loss: 0.762, Test loss: 0.681, Test accuracy: 78.54
Round  62, Global train loss: 0.762, Global test loss: 1.547, Global test accuracy: 48.86
Round  63, Train loss: 0.585, Test loss: 0.667, Test accuracy: 78.70
Round  63, Global train loss: 0.585, Global test loss: 1.427, Global test accuracy: 47.42
Round  64, Train loss: 0.681, Test loss: 0.664, Test accuracy: 78.86
Round  64, Global train loss: 0.681, Global test loss: 1.714, Global test accuracy: 43.62
Round  65, Train loss: 0.691, Test loss: 0.669, Test accuracy: 78.26
Round  65, Global train loss: 0.691, Global test loss: 1.499, Global test accuracy: 51.52
Round  66, Train loss: 0.414, Test loss: 0.679, Test accuracy: 78.24
Round  66, Global train loss: 0.414, Global test loss: 1.542, Global test accuracy: 54.50
Round  67, Train loss: 0.452, Test loss: 0.654, Test accuracy: 78.76
Round  67, Global train loss: 0.452, Global test loss: 2.236, Global test accuracy: 48.92
Round  68, Train loss: 0.496, Test loss: 0.681, Test accuracy: 78.60
Round  68, Global train loss: 0.496, Global test loss: 1.480, Global test accuracy: 51.18
Round  69, Train loss: 0.630, Test loss: 0.671, Test accuracy: 78.62
Round  69, Global train loss: 0.630, Global test loss: 1.563, Global test accuracy: 55.92
Round  70, Train loss: 0.481, Test loss: 0.685, Test accuracy: 78.56
Round  70, Global train loss: 0.481, Global test loss: 1.818, Global test accuracy: 46.64
Round  71, Train loss: 0.393, Test loss: 0.676, Test accuracy: 78.70
Round  71, Global train loss: 0.393, Global test loss: 1.499, Global test accuracy: 52.94
Round  72, Train loss: 0.571, Test loss: 0.687, Test accuracy: 78.04
Round  72, Global train loss: 0.571, Global test loss: 1.550, Global test accuracy: 56.78
Round  73, Train loss: 0.557, Test loss: 0.708, Test accuracy: 77.48
Round  73, Global train loss: 0.557, Global test loss: 1.620, Global test accuracy: 41.42
Round  74, Train loss: 0.603, Test loss: 0.711, Test accuracy: 77.36
Round  74, Global train loss: 0.603, Global test loss: 1.786, Global test accuracy: 52.80
Round  75, Train loss: 0.404, Test loss: 0.690, Test accuracy: 78.30
Round  75, Global train loss: 0.404, Global test loss: 1.791, Global test accuracy: 48.94
Round  76, Train loss: 0.359, Test loss: 0.699, Test accuracy: 78.50
Round  76, Global train loss: 0.359, Global test loss: 1.529, Global test accuracy: 52.90
Round  77, Train loss: 0.579, Test loss: 0.711, Test accuracy: 77.56
Round  77, Global train loss: 0.579, Global test loss: 1.493, Global test accuracy: 53.56
Round  78, Train loss: 0.528, Test loss: 0.699, Test accuracy: 78.10
Round  78, Global train loss: 0.528, Global test loss: 1.581, Global test accuracy: 49.10
Round  79, Train loss: 0.380, Test loss: 0.692, Test accuracy: 77.68
Round  79, Global train loss: 0.380, Global test loss: 1.627, Global test accuracy: 46.74
Round  80, Train loss: 0.561, Test loss: 0.675, Test accuracy: 78.58
Round  80, Global train loss: 0.561, Global test loss: 1.959, Global test accuracy: 48.96
Round  81, Train loss: 0.585, Test loss: 0.725, Test accuracy: 76.86
Round  81, Global train loss: 0.585, Global test loss: 2.231, Global test accuracy: 35.32
Round  82, Train loss: 0.586, Test loss: 0.715, Test accuracy: 76.72
Round  82, Global train loss: 0.586, Global test loss: 1.587, Global test accuracy: 46.26
Round  83, Train loss: 0.470, Test loss: 0.710, Test accuracy: 76.84
Round  83, Global train loss: 0.470, Global test loss: 1.612, Global test accuracy: 56.56
Round  84, Train loss: 0.560, Test loss: 0.733, Test accuracy: 76.40
Round  84, Global train loss: 0.560, Global test loss: 1.645, Global test accuracy: 45.44
Round  85, Train loss: 0.359, Test loss: 0.701, Test accuracy: 78.20
Round  85, Global train loss: 0.359, Global test loss: 1.923, Global test accuracy: 49.74
Round  86, Train loss: 0.366, Test loss: 0.718, Test accuracy: 77.18
Round  86, Global train loss: 0.366, Global test loss: 1.351, Global test accuracy: 57.62
Round  87, Train loss: 0.353, Test loss: 0.693, Test accuracy: 77.94
Round  87, Global train loss: 0.353, Global test loss: 1.391, Global test accuracy: 51.64
Round  88, Train loss: 0.504, Test loss: 0.707, Test accuracy: 77.28
Round  88, Global train loss: 0.504, Global test loss: 1.741, Global test accuracy: 50.26
Round  89, Train loss: 0.319, Test loss: 0.716, Test accuracy: 77.08
Round  89, Global train loss: 0.319, Global test loss: 1.715, Global test accuracy: 53.74
Round  90, Train loss: 0.703, Test loss: 0.730, Test accuracy: 76.56
Round  90, Global train loss: 0.703, Global test loss: 2.824, Global test accuracy: 33.44
Round  91, Train loss: 0.492, Test loss: 0.725, Test accuracy: 76.26
Round  91, Global train loss: 0.492, Global test loss: 2.582, Global test accuracy: 39.26
Round  92, Train loss: 0.312, Test loss: 0.710, Test accuracy: 76.52
Round  92, Global train loss: 0.312, Global test loss: 1.822, Global test accuracy: 51.20
Round  93, Train loss: 0.443, Test loss: 0.734, Test accuracy: 76.80
Round  93, Global train loss: 0.443, Global test loss: 1.567, Global test accuracy: 57.72
Round  94, Train loss: 0.451, Test loss: 0.752, Test accuracy: 75.80
Round  94, Global train loss: 0.451, Global test loss: 2.337, Global test accuracy: 38.96
Round  95, Train loss: 0.471, Test loss: 0.752, Test accuracy: 75.60
Round  95, Global train loss: 0.471, Global test loss: 1.729, Global test accuracy: 48.22
Round  96, Train loss: 0.440, Test loss: 0.736, Test accuracy: 76.32
Round  96, Global train loss: 0.440, Global test loss: 1.577, Global test accuracy: 51.12
Round  97, Train loss: 0.449, Test loss: 0.741, Test accuracy: 75.86
Round  97, Global train loss: 0.449, Global test loss: 1.444, Global test accuracy: 48.30
Round  98, Train loss: 0.457, Test loss: 0.724, Test accuracy: 76.42
Round  98, Global train loss: 0.457, Global test loss: 1.899, Global test accuracy: 43.26
Round  99, Train loss: 0.433, Test loss: 0.729, Test accuracy: 75.80
Round  99, Global train loss: 0.433, Global test loss: 1.819, Global test accuracy: 45.22
Final Round, Train loss: 0.321, Test loss: 0.736, Test accuracy: 76.10
Final Round, Global train loss: 0.321, Global test loss: 1.819, Global test accuracy: 45.22
Average accuracy final 10 rounds: 76.19399999999999
926.3144857883453
[2.180039882659912, 4.102236270904541, 5.914700984954834, 7.746412515640259, 9.50276517868042, 11.39522099494934, 13.181742191314697, 15.313935279846191, 17.17609143257141, 19.06343936920166, 20.987189054489136, 22.89118456840515, 24.77445650100708, 26.742255926132202, 28.63547134399414, 30.67822527885437, 32.546876668930054, 34.44193744659424, 36.37007737159729, 38.411553621292114, 40.20445656776428, 42.04315233230591, 43.85817623138428, 45.77912783622742, 47.680259227752686, 49.53253936767578, 51.40173387527466, 53.255630016326904, 55.085612058639526, 56.94148254394531, 59.07500100135803, 61.22075653076172, 63.14761543273926, 65.04526901245117, 66.84474992752075, 68.61940121650696, 70.70456337928772, 72.55051255226135, 74.41143679618835, 76.23564457893372, 78.18588781356812, 80.03179478645325, 81.92399573326111, 84.02180457115173, 85.95242285728455, 87.86540722846985, 89.86760830879211, 91.7960102558136, 93.62119603157043, 95.48909378051758, 97.27488470077515, 99.19513821601868, 100.95933222770691, 102.76281809806824, 104.5932788848877, 106.41397190093994, 108.3189549446106, 110.12468552589417, 112.32425427436829, 114.47605848312378, 116.56882572174072, 118.75875520706177, 120.83998227119446, 122.76460766792297, 124.68390583992004, 126.73851728439331, 128.71773552894592, 130.62232089042664, 132.42860960960388, 134.3584496974945, 136.1845543384552, 137.98852038383484, 139.77352166175842, 141.6107771396637, 143.39658617973328, 145.23279571533203, 147.16589951515198, 149.02884650230408, 150.92354774475098, 152.8896403312683, 154.70082640647888, 156.8180809020996, 158.68525290489197, 160.5067319869995, 162.31550073623657, 164.1435091495514, 165.98379778862, 167.85633444786072, 169.88879227638245, 171.7214970588684, 173.5747423171997, 175.6527705192566, 177.75411176681519, 179.60036873817444, 181.41391110420227, 183.54494667053223, 185.49754405021667, 187.38617539405823, 189.2531054019928, 191.13944697380066, 194.21817016601562]
[25.44, 26.58, 31.98, 40.54, 49.08, 58.12, 55.92, 59.94, 59.68, 64.56, 65.92, 65.32, 66.12, 67.18, 68.84, 68.06, 69.86, 71.1, 70.92, 72.32, 71.2, 71.74, 72.86, 73.82, 73.5, 73.6, 74.06, 73.84, 75.06, 75.62, 74.34, 74.4, 74.06, 75.4, 75.06, 76.24, 77.44, 76.96, 76.94, 76.98, 76.74, 76.16, 77.32, 77.4, 78.12, 78.48, 77.8, 76.84, 77.38, 78.1, 78.0, 78.38, 79.3, 78.92, 78.58, 78.56, 78.52, 79.14, 78.78, 79.66, 78.1, 79.14, 78.54, 78.7, 78.86, 78.26, 78.24, 78.76, 78.6, 78.62, 78.56, 78.7, 78.04, 77.48, 77.36, 78.3, 78.5, 77.56, 78.1, 77.68, 78.58, 76.86, 76.72, 76.84, 76.4, 78.2, 77.18, 77.94, 77.28, 77.08, 76.56, 76.26, 76.52, 76.8, 75.8, 75.6, 76.32, 75.86, 76.42, 75.8, 76.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.985, Test loss: 1.835, Test accuracy: 38.94
Round   0, Global train loss: 1.985, Global test loss: 2.185, Global test accuracy: 24.86
Round   1, Train loss: 1.650, Test loss: 1.418, Test accuracy: 47.98
Round   1, Global train loss: 1.650, Global test loss: 2.004, Global test accuracy: 33.48
Round   2, Train loss: 1.516, Test loss: 1.287, Test accuracy: 52.66
Round   2, Global train loss: 1.516, Global test loss: 1.913, Global test accuracy: 36.14
Round   3, Train loss: 1.452, Test loss: 1.244, Test accuracy: 54.74
Round   3, Global train loss: 1.452, Global test loss: 1.872, Global test accuracy: 38.00
Round   4, Train loss: 1.405, Test loss: 1.179, Test accuracy: 57.62
Round   4, Global train loss: 1.405, Global test loss: 1.808, Global test accuracy: 40.52
Round   5, Train loss: 1.364, Test loss: 1.139, Test accuracy: 59.30
Round   5, Global train loss: 1.364, Global test loss: 1.771, Global test accuracy: 43.24
Round   6, Train loss: 1.327, Test loss: 1.100, Test accuracy: 61.18
Round   6, Global train loss: 1.327, Global test loss: 1.740, Global test accuracy: 44.82
Round   7, Train loss: 1.294, Test loss: 1.039, Test accuracy: 63.48
Round   7, Global train loss: 1.294, Global test loss: 1.685, Global test accuracy: 46.78
Round   8, Train loss: 1.256, Test loss: 1.006, Test accuracy: 64.56
Round   8, Global train loss: 1.256, Global test loss: 1.640, Global test accuracy: 48.28
Round   9, Train loss: 1.231, Test loss: 0.991, Test accuracy: 67.06
Round   9, Global train loss: 1.231, Global test loss: 1.629, Global test accuracy: 50.28
Round  10, Train loss: 1.341, Test loss: 1.009, Test accuracy: 66.30
Round  10, Global train loss: 1.341, Global test loss: 2.522, Global test accuracy: 17.70
Round  11, Train loss: 1.094, Test loss: 1.024, Test accuracy: 64.76
Round  11, Global train loss: 1.094, Global test loss: 1.925, Global test accuracy: 42.20
Round  12, Train loss: 0.969, Test loss: 0.997, Test accuracy: 64.68
Round  12, Global train loss: 0.969, Global test loss: 2.260, Global test accuracy: 26.00
Round  13, Train loss: 0.984, Test loss: 0.901, Test accuracy: 68.58
Round  13, Global train loss: 0.984, Global test loss: 2.260, Global test accuracy: 22.06
Round  14, Train loss: 1.038, Test loss: 0.914, Test accuracy: 68.22
Round  14, Global train loss: 1.038, Global test loss: 1.721, Global test accuracy: 44.56
Round  15, Train loss: 1.230, Test loss: 0.903, Test accuracy: 70.30
Round  15, Global train loss: 1.230, Global test loss: 2.070, Global test accuracy: 28.58
Round  16, Train loss: 1.010, Test loss: 0.884, Test accuracy: 69.46
Round  16, Global train loss: 1.010, Global test loss: 1.816, Global test accuracy: 35.94
Round  17, Train loss: 1.047, Test loss: 0.898, Test accuracy: 68.02
Round  17, Global train loss: 1.047, Global test loss: 1.946, Global test accuracy: 33.84
Round  18, Train loss: 1.194, Test loss: 0.921, Test accuracy: 68.44
Round  18, Global train loss: 1.194, Global test loss: 2.227, Global test accuracy: 13.28
Round  19, Train loss: 0.883, Test loss: 0.878, Test accuracy: 68.60
Round  19, Global train loss: 0.883, Global test loss: 2.265, Global test accuracy: 28.66
Round  20, Train loss: 0.819, Test loss: 0.834, Test accuracy: 71.06
Round  20, Global train loss: 0.819, Global test loss: 1.874, Global test accuracy: 37.66
Round  21, Train loss: 1.088, Test loss: 0.844, Test accuracy: 72.30
Round  21, Global train loss: 1.088, Global test loss: 1.989, Global test accuracy: 34.58
Round  22, Train loss: 1.057, Test loss: 0.829, Test accuracy: 72.28
Round  22, Global train loss: 1.057, Global test loss: 2.162, Global test accuracy: 32.24
Round  23, Train loss: 0.776, Test loss: 0.780, Test accuracy: 73.14
Round  23, Global train loss: 0.776, Global test loss: 1.463, Global test accuracy: 52.96
Round  24, Train loss: 1.026, Test loss: 0.801, Test accuracy: 72.82
Round  24, Global train loss: 1.026, Global test loss: 1.885, Global test accuracy: 28.32
Round  25, Train loss: 0.895, Test loss: 0.802, Test accuracy: 73.16
Round  25, Global train loss: 0.895, Global test loss: 2.054, Global test accuracy: 35.68
Round  26, Train loss: 0.919, Test loss: 0.814, Test accuracy: 72.44
Round  26, Global train loss: 0.919, Global test loss: 1.785, Global test accuracy: 36.24
Round  27, Train loss: 0.836, Test loss: 0.791, Test accuracy: 72.84
Round  27, Global train loss: 0.836, Global test loss: 1.980, Global test accuracy: 36.66
Round  28, Train loss: 0.808, Test loss: 0.779, Test accuracy: 73.56
Round  28, Global train loss: 0.808, Global test loss: 1.739, Global test accuracy: 44.32
Round  29, Train loss: 0.928, Test loss: 0.818, Test accuracy: 71.88
Round  29, Global train loss: 0.928, Global test loss: 1.956, Global test accuracy: 43.40
Round  30, Train loss: 0.777, Test loss: 0.760, Test accuracy: 74.52
Round  30, Global train loss: 0.777, Global test loss: 2.036, Global test accuracy: 35.56
Round  31, Train loss: 0.853, Test loss: 0.765, Test accuracy: 73.44
Round  31, Global train loss: 0.853, Global test loss: 2.171, Global test accuracy: 37.06
Round  32, Train loss: 0.731, Test loss: 0.773, Test accuracy: 74.34
Round  32, Global train loss: 0.731, Global test loss: 1.709, Global test accuracy: 46.38
Round  33, Train loss: 0.736, Test loss: 0.807, Test accuracy: 72.34
Round  33, Global train loss: 0.736, Global test loss: 2.275, Global test accuracy: 33.80
Round  34, Train loss: 0.818, Test loss: 0.792, Test accuracy: 73.56
Round  34, Global train loss: 0.818, Global test loss: 1.855, Global test accuracy: 36.94
Round  35, Train loss: 0.875, Test loss: 0.733, Test accuracy: 75.28
Round  35, Global train loss: 0.875, Global test loss: 2.567, Global test accuracy: 27.20
Round  36, Train loss: 0.765, Test loss: 0.728, Test accuracy: 75.78
Round  36, Global train loss: 0.765, Global test loss: 1.612, Global test accuracy: 42.08
Round  37, Train loss: 0.891, Test loss: 0.733, Test accuracy: 75.52
Round  37, Global train loss: 0.891, Global test loss: 2.441, Global test accuracy: 28.38
Round  38, Train loss: 0.739, Test loss: 0.767, Test accuracy: 73.78
Round  38, Global train loss: 0.739, Global test loss: 1.758, Global test accuracy: 39.14
Round  39, Train loss: 0.617, Test loss: 0.722, Test accuracy: 75.38
Round  39, Global train loss: 0.617, Global test loss: 1.759, Global test accuracy: 39.60
Round  40, Train loss: 0.709, Test loss: 0.724, Test accuracy: 76.50
Round  40, Global train loss: 0.709, Global test loss: 1.578, Global test accuracy: 51.42
Round  41, Train loss: 0.545, Test loss: 0.695, Test accuracy: 76.26
Round  41, Global train loss: 0.545, Global test loss: 1.908, Global test accuracy: 41.74
Round  42, Train loss: 0.724, Test loss: 0.690, Test accuracy: 77.42
Round  42, Global train loss: 0.724, Global test loss: 1.525, Global test accuracy: 44.74
Round  43, Train loss: 0.607, Test loss: 0.687, Test accuracy: 76.32
Round  43, Global train loss: 0.607, Global test loss: 1.972, Global test accuracy: 30.62
Round  44, Train loss: 0.762, Test loss: 0.731, Test accuracy: 75.12
Round  44, Global train loss: 0.762, Global test loss: 2.080, Global test accuracy: 36.20
Round  45, Train loss: 0.692, Test loss: 0.676, Test accuracy: 78.06
Round  45, Global train loss: 0.692, Global test loss: 1.644, Global test accuracy: 46.18
Round  46, Train loss: 0.627, Test loss: 0.710, Test accuracy: 75.68
Round  46, Global train loss: 0.627, Global test loss: 1.897, Global test accuracy: 38.74
Round  47, Train loss: 0.602, Test loss: 0.692, Test accuracy: 75.98
Round  47, Global train loss: 0.602, Global test loss: 1.925, Global test accuracy: 29.90
Round  48, Train loss: 0.728, Test loss: 0.715, Test accuracy: 75.48
Round  48, Global train loss: 0.728, Global test loss: 1.521, Global test accuracy: 47.32
Round  49, Train loss: 0.632, Test loss: 0.716, Test accuracy: 75.52
Round  49, Global train loss: 0.632, Global test loss: 1.387, Global test accuracy: 56.34
Round  50, Train loss: 0.493, Test loss: 0.693, Test accuracy: 75.68
Round  50, Global train loss: 0.493, Global test loss: 1.337, Global test accuracy: 54.76
Round  51, Train loss: 0.618, Test loss: 0.692, Test accuracy: 76.28
Round  51, Global train loss: 0.618, Global test loss: 1.396, Global test accuracy: 49.26
Round  52, Train loss: 0.811, Test loss: 0.736, Test accuracy: 75.06
Round  52, Global train loss: 0.811, Global test loss: 2.075, Global test accuracy: 27.34
Round  53, Train loss: 0.592, Test loss: 0.710, Test accuracy: 75.36
Round  53, Global train loss: 0.592, Global test loss: 1.786, Global test accuracy: 42.80
Round  54, Train loss: 0.690, Test loss: 0.740, Test accuracy: 75.54
Round  54, Global train loss: 0.690, Global test loss: 2.740, Global test accuracy: 36.80
Round  55, Train loss: 0.705, Test loss: 0.737, Test accuracy: 74.40
Round  55, Global train loss: 0.705, Global test loss: 1.933, Global test accuracy: 44.48
Round  56, Train loss: 0.611, Test loss: 0.748, Test accuracy: 73.68
Round  56, Global train loss: 0.611, Global test loss: 2.423, Global test accuracy: 27.80
Round  57, Train loss: 0.499, Test loss: 0.682, Test accuracy: 76.54
Round  57, Global train loss: 0.499, Global test loss: 1.471, Global test accuracy: 46.66
Round  58, Train loss: 0.606, Test loss: 0.713, Test accuracy: 75.50
Round  58, Global train loss: 0.606, Global test loss: 2.495, Global test accuracy: 31.98
Round  59, Train loss: 0.683, Test loss: 0.755, Test accuracy: 74.18
Round  59, Global train loss: 0.683, Global test loss: 2.025, Global test accuracy: 25.54
Round  60, Train loss: 0.569, Test loss: 0.732, Test accuracy: 74.72
Round  60, Global train loss: 0.569, Global test loss: 1.791, Global test accuracy: 40.54
Round  61, Train loss: 0.624, Test loss: 0.750, Test accuracy: 74.44
Round  61, Global train loss: 0.624, Global test loss: 2.161, Global test accuracy: 37.10
Round  62, Train loss: 0.544, Test loss: 0.675, Test accuracy: 76.98
Round  62, Global train loss: 0.544, Global test loss: 1.729, Global test accuracy: 46.88
Round  63, Train loss: 0.467, Test loss: 0.695, Test accuracy: 75.54
Round  63, Global train loss: 0.467, Global test loss: 2.056, Global test accuracy: 38.10
Round  64, Train loss: 0.510, Test loss: 0.691, Test accuracy: 76.30
Round  64, Global train loss: 0.510, Global test loss: 1.980, Global test accuracy: 38.02
Round  65, Train loss: 0.453, Test loss: 0.699, Test accuracy: 76.18
Round  65, Global train loss: 0.453, Global test loss: 1.571, Global test accuracy: 47.88
Round  66, Train loss: 0.587, Test loss: 0.710, Test accuracy: 75.54
Round  66, Global train loss: 0.587, Global test loss: 1.825, Global test accuracy: 42.90
Round  67, Train loss: 0.534, Test loss: 0.725, Test accuracy: 75.04
Round  67, Global train loss: 0.534, Global test loss: 2.971, Global test accuracy: 38.96
Round  68, Train loss: 0.357, Test loss: 0.713, Test accuracy: 76.12
Round  68, Global train loss: 0.357, Global test loss: 1.905, Global test accuracy: 46.90
Round  69, Train loss: 0.448, Test loss: 0.691, Test accuracy: 76.60
Round  69, Global train loss: 0.448, Global test loss: 1.523, Global test accuracy: 52.34
Round  70, Train loss: 0.352, Test loss: 0.695, Test accuracy: 76.98
Round  70, Global train loss: 0.352, Global test loss: 1.973, Global test accuracy: 38.10
Round  71, Train loss: 0.430, Test loss: 0.693, Test accuracy: 76.58
Round  71, Global train loss: 0.430, Global test loss: 1.779, Global test accuracy: 45.20
Round  72, Train loss: 0.418, Test loss: 0.692, Test accuracy: 77.26
Round  72, Global train loss: 0.418, Global test loss: 1.615, Global test accuracy: 52.70
Round  73, Train loss: 0.493, Test loss: 0.710, Test accuracy: 76.04
Round  73, Global train loss: 0.493, Global test loss: 1.366, Global test accuracy: 51.24
Round  74, Train loss: 0.553, Test loss: 0.700, Test accuracy: 76.10
Round  74, Global train loss: 0.553, Global test loss: 1.940, Global test accuracy: 46.06
Round  75, Train loss: 0.454, Test loss: 0.727, Test accuracy: 75.74
Round  75, Global train loss: 0.454, Global test loss: 1.791, Global test accuracy: 39.20
Round  76, Train loss: 0.395, Test loss: 0.715, Test accuracy: 76.38
Round  76, Global train loss: 0.395, Global test loss: 1.951, Global test accuracy: 45.06
Round  77, Train loss: 0.442, Test loss: 0.698, Test accuracy: 76.64
Round  77, Global train loss: 0.442, Global test loss: 1.696, Global test accuracy: 47.26
Round  78, Train loss: 0.506, Test loss: 0.719, Test accuracy: 76.00
Round  78, Global train loss: 0.506, Global test loss: 1.798, Global test accuracy: 43.88
Round  79, Train loss: 0.424, Test loss: 0.745, Test accuracy: 74.62
Round  79, Global train loss: 0.424, Global test loss: 2.331, Global test accuracy: 39.44
Round  80, Train loss: 0.377, Test loss: 0.686, Test accuracy: 76.78
Round  80, Global train loss: 0.377, Global test loss: 1.133, Global test accuracy: 59.48
Round  81, Train loss: 0.339, Test loss: 0.681, Test accuracy: 77.16
Round  81, Global train loss: 0.339, Global test loss: 1.119, Global test accuracy: 60.36
Round  82, Train loss: 0.335, Test loss: 0.682, Test accuracy: 76.68
Round  82, Global train loss: 0.335, Global test loss: 1.126, Global test accuracy: 60.48
Round  83, Train loss: 0.321, Test loss: 0.680, Test accuracy: 76.36
Round  83, Global train loss: 0.321, Global test loss: 1.123, Global test accuracy: 60.58
Round  84, Train loss: 0.316, Test loss: 0.678, Test accuracy: 76.90
Round  84, Global train loss: 0.316, Global test loss: 1.109, Global test accuracy: 60.56
Round  85, Train loss: 0.293, Test loss: 0.675, Test accuracy: 77.12
Round  85, Global train loss: 0.293, Global test loss: 1.114, Global test accuracy: 61.12
Round  86, Train loss: 0.289, Test loss: 0.680, Test accuracy: 77.02
Round  86, Global train loss: 0.289, Global test loss: 1.110, Global test accuracy: 61.56
Round  87, Train loss: 0.277, Test loss: 0.683, Test accuracy: 77.30
Round  87, Global train loss: 0.277, Global test loss: 1.104, Global test accuracy: 60.68
Round  88, Train loss: 0.288, Test loss: 0.680, Test accuracy: 76.68
Round  88, Global train loss: 0.288, Global test loss: 1.105, Global test accuracy: 61.38
Round  89, Train loss: 0.273, Test loss: 0.683, Test accuracy: 76.60
Round  89, Global train loss: 0.273, Global test loss: 1.093, Global test accuracy: 61.82
Round  90, Train loss: 0.251, Test loss: 0.691, Test accuracy: 76.74
Round  90, Global train loss: 0.251, Global test loss: 1.101, Global test accuracy: 61.32
Round  91, Train loss: 0.258, Test loss: 0.688, Test accuracy: 76.70
Round  91, Global train loss: 0.258, Global test loss: 1.075, Global test accuracy: 63.20
Round  92, Train loss: 0.250, Test loss: 0.684, Test accuracy: 76.92
Round  92, Global train loss: 0.250, Global test loss: 1.101, Global test accuracy: 61.00
Round  93, Train loss: 0.226, Test loss: 0.707, Test accuracy: 76.86
Round  93, Global train loss: 0.226, Global test loss: 1.088, Global test accuracy: 62.72
Round  94, Train loss: 0.238, Test loss: 0.709, Test accuracy: 76.24
Round  94, Global train loss: 0.238, Global test loss: 1.109, Global test accuracy: 61.54
Round  95, Train loss: 0.219, Test loss: 0.699, Test accuracy: 76.98
Round  95, Global train loss: 0.219, Global test loss: 1.095, Global test accuracy: 63.08
Round  96, Train loss: 0.216, Test loss: 0.710, Test accuracy: 76.46
Round  96, Global train loss: 0.216, Global test loss: 1.087, Global test accuracy: 62.92
Round  97, Train loss: 0.210, Test loss: 0.719, Test accuracy: 76.62
Round  97, Global train loss: 0.210, Global test loss: 1.094, Global test accuracy: 62.80
Round  98, Train loss: 0.204, Test loss: 0.727, Test accuracy: 75.54
Round  98, Global train loss: 0.204, Global test loss: 1.116, Global test accuracy: 62.12
Round  99, Train loss: 0.310, Test loss: 0.723, Test accuracy: 75.88
Round  99, Global train loss: 0.310, Global test loss: 1.044, Global test accuracy: 67.00
Final Round, Train loss: 0.271, Test loss: 0.733, Test accuracy: 75.64
Final Round, Global train loss: 0.271, Global test loss: 1.044, Global test accuracy: 67.00
Average accuracy final 10 rounds: 76.494
2304.7025303840637
[2.45253586769104, 4.54724907875061, 6.6596338748931885, 8.971415758132935, 11.036525964736938, 13.157582759857178, 15.38679313659668, 17.399675846099854, 19.543509006500244, 21.57206153869629, 28.705394744873047, 39.620272636413574, 50.413628578186035, 52.66255450248718, 54.853137731552124, 65.93273115158081, 76.71087694168091, 87.47555828094482, 98.27232456207275, 109.17159128189087, 111.19728779792786, 122.24149131774902, 133.16585040092468, 143.91203927993774, 156.9550542831421, 167.8300883769989, 178.72058296203613, 189.89482283592224, 200.6480827331543, 211.74962520599365, 213.83483505249023, 224.85360956192017, 235.73925280570984, 246.4621284008026, 257.31637597084045, 268.4964175224304, 279.585800409317, 291.0894889831543, 302.5093071460724, 313.5320065021515, 315.6477599143982, 327.1024148464203, 338.4440495967865, 350.48880338668823, 361.69236302375793, 372.56732511520386, 383.2723391056061, 394.2907245159149, 405.45784091949463, 416.5377604961395, 427.3673937320709, 438.38119196891785, 449.5995514392853, 460.31209349632263, 471.11164689064026, 482.221670627594, 494.19855427742004, 505.7319669723511, 516.850652217865, 527.6406528949738, 538.4925870895386, 549.6043694019318, 560.432165145874, 571.4017834663391, 581.9832327365875, 592.6496064662933, 603.4550120830536, 614.2909119129181, 624.8747680187225, 626.9870865345001, 637.321860074997, 648.263396024704, 661.1642646789551, 671.6212298870087, 682.4552862644196, 693.6573159694672, 704.2381892204285, 706.4813838005066, 708.4124357700348, 719.5079391002655, 721.6872458457947, 723.8000891208649, 725.8380272388458, 728.0615751743317, 730.1123540401459, 732.1594049930573, 734.1919045448303, 736.3413519859314, 738.381266117096, 740.4745962619781, 742.6100335121155, 744.5761597156525, 746.6206786632538, 748.6517708301544, 750.6575720310211, 752.7455966472626, 754.7053277492523, 756.7235162258148, 758.8402605056763, 769.6261422634125, 781.4459040164948]
[38.94, 47.98, 52.66, 54.74, 57.62, 59.3, 61.18, 63.48, 64.56, 67.06, 66.3, 64.76, 64.68, 68.58, 68.22, 70.3, 69.46, 68.02, 68.44, 68.6, 71.06, 72.3, 72.28, 73.14, 72.82, 73.16, 72.44, 72.84, 73.56, 71.88, 74.52, 73.44, 74.34, 72.34, 73.56, 75.28, 75.78, 75.52, 73.78, 75.38, 76.5, 76.26, 77.42, 76.32, 75.12, 78.06, 75.68, 75.98, 75.48, 75.52, 75.68, 76.28, 75.06, 75.36, 75.54, 74.4, 73.68, 76.54, 75.5, 74.18, 74.72, 74.44, 76.98, 75.54, 76.3, 76.18, 75.54, 75.04, 76.12, 76.6, 76.98, 76.58, 77.26, 76.04, 76.1, 75.74, 76.38, 76.64, 76.0, 74.62, 76.78, 77.16, 76.68, 76.36, 76.9, 77.12, 77.02, 77.3, 76.68, 76.6, 76.74, 76.7, 76.92, 76.86, 76.24, 76.98, 76.46, 76.62, 75.54, 75.88, 75.64]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.728, Test loss: 2.119, Test accuracy: 16.18
Round   0, Global train loss: 1.728, Global test loss: 2.316, Global test accuracy: 12.70
Round   1, Train loss: 1.612, Test loss: 1.733, Test accuracy: 34.24
Round   1, Global train loss: 1.612, Global test loss: 2.126, Global test accuracy: 22.14
Round   2, Train loss: 1.645, Test loss: 1.554, Test accuracy: 37.78
Round   2, Global train loss: 1.645, Global test loss: 2.182, Global test accuracy: 17.24
Round   3, Train loss: 1.439, Test loss: 1.440, Test accuracy: 45.20
Round   3, Global train loss: 1.439, Global test loss: 2.031, Global test accuracy: 29.30
Round   4, Train loss: 1.440, Test loss: 1.505, Test accuracy: 44.84
Round   4, Global train loss: 1.440, Global test loss: 2.265, Global test accuracy: 25.82
Round   5, Train loss: 1.527, Test loss: 1.430, Test accuracy: 45.94
Round   5, Global train loss: 1.527, Global test loss: 2.042, Global test accuracy: 26.46
Round   6, Train loss: 1.251, Test loss: 1.415, Test accuracy: 45.72
Round   6, Global train loss: 1.251, Global test loss: 1.945, Global test accuracy: 28.06
Round   7, Train loss: 1.138, Test loss: 1.485, Test accuracy: 44.38
Round   7, Global train loss: 1.138, Global test loss: 2.313, Global test accuracy: 17.38
Round   8, Train loss: 1.086, Test loss: 1.397, Test accuracy: 50.06
Round   8, Global train loss: 1.086, Global test loss: 2.037, Global test accuracy: 31.84
Round   9, Train loss: 1.038, Test loss: 1.338, Test accuracy: 51.24
Round   9, Global train loss: 1.038, Global test loss: 1.955, Global test accuracy: 34.94
Round  10, Train loss: 1.525, Test loss: 1.345, Test accuracy: 50.26
Round  10, Global train loss: 1.525, Global test loss: 2.232, Global test accuracy: 27.00
Round  11, Train loss: 1.026, Test loss: 1.427, Test accuracy: 47.44
Round  11, Global train loss: 1.026, Global test loss: 2.209, Global test accuracy: 28.74
Round  12, Train loss: 0.980, Test loss: 1.251, Test accuracy: 52.70
Round  12, Global train loss: 0.980, Global test loss: 2.150, Global test accuracy: 26.28
Round  13, Train loss: 1.110, Test loss: 1.186, Test accuracy: 55.66
Round  13, Global train loss: 1.110, Global test loss: 2.123, Global test accuracy: 24.52
Round  14, Train loss: 1.093, Test loss: 1.119, Test accuracy: 58.58
Round  14, Global train loss: 1.093, Global test loss: 2.183, Global test accuracy: 28.70
Round  15, Train loss: 1.097, Test loss: 1.109, Test accuracy: 59.86
Round  15, Global train loss: 1.097, Global test loss: 2.182, Global test accuracy: 22.86
Round  16, Train loss: 1.127, Test loss: 1.102, Test accuracy: 59.84
Round  16, Global train loss: 1.127, Global test loss: 2.081, Global test accuracy: 32.80
Round  17, Train loss: 1.159, Test loss: 1.082, Test accuracy: 61.24
Round  17, Global train loss: 1.159, Global test loss: 2.129, Global test accuracy: 24.46
Round  18, Train loss: 1.238, Test loss: 1.092, Test accuracy: 60.42
Round  18, Global train loss: 1.238, Global test loss: 2.033, Global test accuracy: 31.10
Round  19, Train loss: 1.284, Test loss: 1.094, Test accuracy: 61.10
Round  19, Global train loss: 1.284, Global test loss: 2.212, Global test accuracy: 28.70
Round  20, Train loss: 0.995, Test loss: 1.102, Test accuracy: 61.30
Round  20, Global train loss: 0.995, Global test loss: 2.074, Global test accuracy: 28.42
Round  21, Train loss: 1.036, Test loss: 1.118, Test accuracy: 60.52
Round  21, Global train loss: 1.036, Global test loss: 2.065, Global test accuracy: 32.68
Round  22, Train loss: 1.085, Test loss: 1.104, Test accuracy: 60.28
Round  22, Global train loss: 1.085, Global test loss: 2.128, Global test accuracy: 27.34
Round  23, Train loss: 0.703, Test loss: 1.112, Test accuracy: 61.08
Round  23, Global train loss: 0.703, Global test loss: 2.214, Global test accuracy: 25.52
Round  24, Train loss: 1.101, Test loss: 1.116, Test accuracy: 60.92
Round  24, Global train loss: 1.101, Global test loss: 2.066, Global test accuracy: 36.98
Round  25, Train loss: 0.928, Test loss: 1.101, Test accuracy: 61.36
Round  25, Global train loss: 0.928, Global test loss: 2.133, Global test accuracy: 26.20
Round  26, Train loss: 0.504, Test loss: 1.128, Test accuracy: 60.40
Round  26, Global train loss: 0.504, Global test loss: 2.233, Global test accuracy: 23.60
Round  27, Train loss: 0.937, Test loss: 1.130, Test accuracy: 61.12
Round  27, Global train loss: 0.937, Global test loss: 2.140, Global test accuracy: 28.14
Round  28, Train loss: 0.447, Test loss: 1.108, Test accuracy: 62.36
Round  28, Global train loss: 0.447, Global test loss: 2.190, Global test accuracy: 25.40
Round  29, Train loss: 0.851, Test loss: 1.105, Test accuracy: 62.46
Round  29, Global train loss: 0.851, Global test loss: 2.014, Global test accuracy: 32.70
Round  30, Train loss: 0.873, Test loss: 1.123, Test accuracy: 61.48
Round  30, Global train loss: 0.873, Global test loss: 2.000, Global test accuracy: 29.40
Round  31, Train loss: 0.431, Test loss: 1.138, Test accuracy: 61.28
Round  31, Global train loss: 0.431, Global test loss: 2.216, Global test accuracy: 26.82
Round  32, Train loss: 0.444, Test loss: 1.143, Test accuracy: 61.40
Round  32, Global train loss: 0.444, Global test loss: 2.106, Global test accuracy: 25.14
Round  33, Train loss: 0.767, Test loss: 1.149, Test accuracy: 62.10
Round  33, Global train loss: 0.767, Global test loss: 1.987, Global test accuracy: 34.00
Round  34, Train loss: 0.998, Test loss: 1.169, Test accuracy: 61.14
Round  34, Global train loss: 0.998, Global test loss: 2.042, Global test accuracy: 33.70
Round  35, Train loss: 0.908, Test loss: 1.150, Test accuracy: 61.98
Round  35, Global train loss: 0.908, Global test loss: 2.158, Global test accuracy: 28.98
Round  36, Train loss: 1.077, Test loss: 1.152, Test accuracy: 61.52
Round  36, Global train loss: 1.077, Global test loss: 2.173, Global test accuracy: 31.80
Round  37, Train loss: 0.887, Test loss: 1.171, Test accuracy: 61.64
Round  37, Global train loss: 0.887, Global test loss: 2.120, Global test accuracy: 34.90
Round  38, Train loss: 0.945, Test loss: 1.207, Test accuracy: 61.18
Round  38, Global train loss: 0.945, Global test loss: 1.994, Global test accuracy: 28.16
Round  39, Train loss: 0.316, Test loss: 1.270, Test accuracy: 60.10
Round  39, Global train loss: 0.316, Global test loss: 2.123, Global test accuracy: 25.76
Round  40, Train loss: 0.264, Test loss: 1.312, Test accuracy: 59.56
Round  40, Global train loss: 0.264, Global test loss: 2.332, Global test accuracy: 24.40
Round  41, Train loss: 0.436, Test loss: 1.261, Test accuracy: 61.26
Round  41, Global train loss: 0.436, Global test loss: 1.775, Global test accuracy: 38.50
Round  42, Train loss: 0.753, Test loss: 1.276, Test accuracy: 61.14
Round  42, Global train loss: 0.753, Global test loss: 1.889, Global test accuracy: 37.40
Round  43, Train loss: 0.890, Test loss: 1.267, Test accuracy: 63.48
Round  43, Global train loss: 0.890, Global test loss: 1.996, Global test accuracy: 33.44
Round  44, Train loss: 0.289, Test loss: 1.222, Test accuracy: 63.78
Round  44, Global train loss: 0.289, Global test loss: 2.233, Global test accuracy: 28.46
Round  45, Train loss: 0.747, Test loss: 1.223, Test accuracy: 64.08
Round  45, Global train loss: 0.747, Global test loss: 2.203, Global test accuracy: 23.22
Round  46, Train loss: 1.085, Test loss: 1.238, Test accuracy: 62.96
Round  46, Global train loss: 1.085, Global test loss: 2.194, Global test accuracy: 26.68
Round  47, Train loss: 0.269, Test loss: 1.233, Test accuracy: 63.12
Round  47, Global train loss: 0.269, Global test loss: 2.012, Global test accuracy: 33.00
Round  48, Train loss: 0.545, Test loss: 1.236, Test accuracy: 62.96
Round  48, Global train loss: 0.545, Global test loss: 2.462, Global test accuracy: 28.40
Round  49, Train loss: 1.021, Test loss: 1.252, Test accuracy: 62.52
Round  49, Global train loss: 1.021, Global test loss: 2.188, Global test accuracy: 27.08
Round  50, Train loss: 0.970, Test loss: 1.282, Test accuracy: 62.32
Round  50, Global train loss: 0.970, Global test loss: 2.187, Global test accuracy: 26.66
Round  51, Train loss: 0.449, Test loss: 1.293, Test accuracy: 61.88
Round  51, Global train loss: 0.449, Global test loss: 2.213, Global test accuracy: 34.66
Round  52, Train loss: 0.603, Test loss: 1.296, Test accuracy: 62.32
Round  52, Global train loss: 0.603, Global test loss: 2.191, Global test accuracy: 18.00
Round  53, Train loss: 0.832, Test loss: 1.334, Test accuracy: 62.58
Round  53, Global train loss: 0.832, Global test loss: 2.059, Global test accuracy: 28.16
Round  54, Train loss: 0.449, Test loss: 1.355, Test accuracy: 62.28
Round  54, Global train loss: 0.449, Global test loss: 1.697, Global test accuracy: 44.46
Round  55, Train loss: 0.660, Test loss: 1.333, Test accuracy: 62.22
Round  55, Global train loss: 0.660, Global test loss: 1.906, Global test accuracy: 33.84
Round  56, Train loss: 0.799, Test loss: 1.420, Test accuracy: 61.10
Round  56, Global train loss: 0.799, Global test loss: 1.961, Global test accuracy: 34.12
Round  57, Train loss: 0.158, Test loss: 1.373, Test accuracy: 61.82
Round  57, Global train loss: 0.158, Global test loss: 2.066, Global test accuracy: 33.28
Round  58, Train loss: 0.448, Test loss: 1.387, Test accuracy: 62.42
Round  58, Global train loss: 0.448, Global test loss: 2.143, Global test accuracy: 29.00
Round  59, Train loss: 0.978, Test loss: 1.362, Test accuracy: 61.98
Round  59, Global train loss: 0.978, Global test loss: 2.152, Global test accuracy: 19.82
Round  60, Train loss: 0.271, Test loss: 1.340, Test accuracy: 62.24
Round  60, Global train loss: 0.271, Global test loss: 2.020, Global test accuracy: 36.06
Round  61, Train loss: 0.279, Test loss: 1.348, Test accuracy: 62.02
Round  61, Global train loss: 0.279, Global test loss: 2.029, Global test accuracy: 32.18
Round  62, Train loss: 0.755, Test loss: 1.418, Test accuracy: 60.70
Round  62, Global train loss: 0.755, Global test loss: 2.167, Global test accuracy: 31.36
Round  63, Train loss: 0.215, Test loss: 1.419, Test accuracy: 61.38
Round  63, Global train loss: 0.215, Global test loss: 1.923, Global test accuracy: 40.66
Round  64, Train loss: 0.618, Test loss: 1.446, Test accuracy: 61.04
Round  64, Global train loss: 0.618, Global test loss: 2.109, Global test accuracy: 32.18
Round  65, Train loss: 0.595, Test loss: 1.448, Test accuracy: 60.98
Round  65, Global train loss: 0.595, Global test loss: 2.000, Global test accuracy: 36.08
Round  66, Train loss: 0.170, Test loss: 1.446, Test accuracy: 61.24
Round  66, Global train loss: 0.170, Global test loss: 2.031, Global test accuracy: 34.30
Round  67, Train loss: 0.681, Test loss: 1.460, Test accuracy: 61.18
Round  67, Global train loss: 0.681, Global test loss: 2.253, Global test accuracy: 25.60
Round  68, Train loss: 0.635, Test loss: 1.457, Test accuracy: 61.00
Round  68, Global train loss: 0.635, Global test loss: 1.969, Global test accuracy: 32.94
Round  69, Train loss: 0.677, Test loss: 1.441, Test accuracy: 61.44
Round  69, Global train loss: 0.677, Global test loss: 2.226, Global test accuracy: 13.60
Round  70, Train loss: 0.232, Test loss: 1.498, Test accuracy: 60.66
Round  70, Global train loss: 0.232, Global test loss: 1.844, Global test accuracy: 39.26
Round  71, Train loss: 0.333, Test loss: 1.563, Test accuracy: 60.50
Round  71, Global train loss: 0.333, Global test loss: 2.015, Global test accuracy: 25.82
Round  72, Train loss: 0.399, Test loss: 1.568, Test accuracy: 60.84
Round  72, Global train loss: 0.399, Global test loss: 2.203, Global test accuracy: 30.96
Round  73, Train loss: 0.583, Test loss: 1.573, Test accuracy: 61.12
Round  73, Global train loss: 0.583, Global test loss: 2.349, Global test accuracy: 33.80
Round  74, Train loss: 0.574, Test loss: 1.623, Test accuracy: 60.42
Round  74, Global train loss: 0.574, Global test loss: 2.287, Global test accuracy: 23.50
Round  75, Train loss: 0.261, Test loss: 1.622, Test accuracy: 60.86
Round  75, Global train loss: 0.261, Global test loss: 2.034, Global test accuracy: 33.22
Round  76, Train loss: 0.799, Test loss: 1.668, Test accuracy: 60.62
Round  76, Global train loss: 0.799, Global test loss: 2.169, Global test accuracy: 27.94
Round  77, Train loss: 0.428, Test loss: 1.679, Test accuracy: 60.76
Round  77, Global train loss: 0.428, Global test loss: 2.008, Global test accuracy: 35.12
Round  78, Train loss: 0.284, Test loss: 1.640, Test accuracy: 60.92
Round  78, Global train loss: 0.284, Global test loss: 2.093, Global test accuracy: 34.34
Round  79, Train loss: 0.211, Test loss: 1.662, Test accuracy: 60.60
Round  79, Global train loss: 0.211, Global test loss: 2.010, Global test accuracy: 28.54
Round  80, Train loss: 0.579, Test loss: 1.697, Test accuracy: 60.86
Round  80, Global train loss: 0.579, Global test loss: 2.453, Global test accuracy: 30.44
Round  81, Train loss: 0.153, Test loss: 1.778, Test accuracy: 60.04
Round  81, Global train loss: 0.153, Global test loss: 1.848, Global test accuracy: 38.24
Round  82, Train loss: 0.295, Test loss: 1.782, Test accuracy: 59.48
Round  82, Global train loss: 0.295, Global test loss: 1.899, Global test accuracy: 39.20
Round  83, Train loss: 0.103, Test loss: 1.761, Test accuracy: 60.14
Round  83, Global train loss: 0.103, Global test loss: 2.031, Global test accuracy: 31.72
Round  84, Train loss: 0.085, Test loss: 1.775, Test accuracy: 60.32
Round  84, Global train loss: 0.085, Global test loss: 1.998, Global test accuracy: 37.54
Round  85, Train loss: 0.413, Test loss: 1.821, Test accuracy: 60.38
Round  85, Global train loss: 0.413, Global test loss: 2.020, Global test accuracy: 34.28
Round  86, Train loss: 0.428, Test loss: 1.839, Test accuracy: 60.58
Round  86, Global train loss: 0.428, Global test loss: 1.896, Global test accuracy: 36.72
Round  87, Train loss: 0.436, Test loss: 1.863, Test accuracy: 60.62
Round  87, Global train loss: 0.436, Global test loss: 2.075, Global test accuracy: 29.38
Round  88, Train loss: 0.133, Test loss: 1.819, Test accuracy: 60.66
Round  88, Global train loss: 0.133, Global test loss: 1.889, Global test accuracy: 34.96
Round  89, Train loss: 0.366, Test loss: 1.864, Test accuracy: 60.54
Round  89, Global train loss: 0.366, Global test loss: 1.908, Global test accuracy: 35.68
Round  90, Train loss: 0.185, Test loss: 1.836, Test accuracy: 60.04
Round  90, Global train loss: 0.185, Global test loss: 2.131, Global test accuracy: 29.02
Round  91, Train loss: 0.162, Test loss: 1.870, Test accuracy: 60.66
Round  91, Global train loss: 0.162, Global test loss: 2.209, Global test accuracy: 27.84
Round  92, Train loss: 0.411, Test loss: 1.895, Test accuracy: 60.16
Round  92, Global train loss: 0.411, Global test loss: 2.039, Global test accuracy: 30.50
Round  93, Train loss: 0.301, Test loss: 1.882, Test accuracy: 60.76
Round  93, Global train loss: 0.301, Global test loss: 2.179, Global test accuracy: 26.14
Round  94, Train loss: 0.324, Test loss: 1.960, Test accuracy: 59.76
Round  94, Global train loss: 0.324, Global test loss: 1.959, Global test accuracy: 33.76
Round  95, Train loss: 0.231, Test loss: 1.936, Test accuracy: 60.26
Round  95, Global train loss: 0.231, Global test loss: 2.109, Global test accuracy: 27.94
Round  96, Train loss: 0.187, Test loss: 2.015, Test accuracy: 60.68
Round  96, Global train loss: 0.187, Global test loss: 2.103, Global test accuracy: 28.72
Round  97, Train loss: 0.118, Test loss: 2.075, Test accuracy: 60.24
Round  97, Global train loss: 0.118, Global test loss: 2.054, Global test accuracy: 37.44
Round  98, Train loss: 0.399, Test loss: 2.064, Test accuracy: 60.50
Round  98, Global train loss: 0.399, Global test loss: 1.964, Global test accuracy: 36.38
Round  99, Train loss: 0.383, Test loss: 2.091, Test accuracy: 60.96
Round  99, Global train loss: 0.383, Global test loss: 2.101, Global test accuracy: 27.02
Final Round, Train loss: 0.240, Test loss: 2.070, Test accuracy: 60.66
Final Round, Global train loss: 0.240, Global test loss: 2.101, Global test accuracy: 27.02
Average accuracy final 10 rounds: 60.402 

Average global accuracy final 10 rounds: 30.476 

991.1775903701782
[1.8594262599945068, 3.7188525199890137, 5.2699668407440186, 6.821081161499023, 8.36866283416748, 9.916244506835938, 11.594363689422607, 13.272482872009277, 14.804674625396729, 16.33686637878418, 17.91481113433838, 19.492755889892578, 21.053225994110107, 22.613696098327637, 24.23221778869629, 25.85073947906494, 27.41785979270935, 28.98498010635376, 30.626189470291138, 32.267398834228516, 34.007508516311646, 35.747618198394775, 37.391337871551514, 39.03505754470825, 40.74930286407471, 42.46354818344116, 44.096054792404175, 45.72856140136719, 47.552932024002075, 49.37730264663696, 51.00026249885559, 52.62322235107422, 54.18916702270508, 55.75511169433594, 57.74458312988281, 59.73405456542969, 61.26958441734314, 62.80511426925659, 64.36609768867493, 65.92708110809326, 67.42914652824402, 68.93121194839478, 70.52992963790894, 72.1286473274231, 73.6190254688263, 75.10940361022949, 76.61606216430664, 78.12272071838379, 79.58485627174377, 81.04699182510376, 82.61495995521545, 84.18292808532715, 85.65773510932922, 87.1325421333313, 88.58511972427368, 90.03769731521606, 91.68551588058472, 93.33333444595337, 94.97448778152466, 96.61564111709595, 98.13178634643555, 99.64793157577515, 101.1612389087677, 102.67454624176025, 104.34236121177673, 106.01017618179321, 107.6918215751648, 109.37346696853638, 110.9120364189148, 112.45060586929321, 114.18867230415344, 115.92673873901367, 117.50604510307312, 119.08535146713257, 120.76644349098206, 122.44753551483154, 124.1507556438446, 125.85397577285767, 127.3746588230133, 128.89534187316895, 130.4706950187683, 132.04604816436768, 133.67781043052673, 135.3095726966858, 136.97902011871338, 138.64846754074097, 140.31957459449768, 141.9906816482544, 143.60736870765686, 145.22405576705933, 146.780122756958, 148.3361897468567, 149.92006373405457, 151.50393772125244, 153.01089715957642, 154.5178565979004, 156.10402655601501, 157.69019651412964, 159.1985056400299, 160.70681476593018, 162.20850276947021, 163.71019077301025, 165.28640222549438, 166.86261367797852, 168.51078414916992, 170.15895462036133, 171.73284125328064, 173.30672788619995, 174.8209412097931, 176.33515453338623, 177.85439133644104, 179.37362813949585, 181.13848853111267, 182.9033489227295, 184.39785075187683, 185.89235258102417, 187.36505651474, 188.8377604484558, 190.2663016319275, 191.69484281539917, 193.3214466571808, 194.9480504989624, 196.5129315853119, 198.07781267166138, 199.54813718795776, 201.01846170425415, 202.4547791481018, 203.89109659194946, 205.49824166297913, 207.1053867340088, 208.57369017601013, 210.04199361801147, 211.577730178833, 213.11346673965454, 214.86393547058105, 216.61440420150757, 218.13574743270874, 219.6570906639099, 221.2369728088379, 222.81685495376587, 224.27864623069763, 225.7404375076294, 227.359961271286, 228.97948503494263, 230.62136912345886, 232.2632532119751, 233.89808106422424, 235.5329089164734, 237.08884501457214, 238.6447811126709, 240.23757934570312, 241.83037757873535, 243.2190501689911, 244.60772275924683, 246.11557865142822, 247.62343454360962, 249.31103348731995, 250.99863243103027, 252.53231048583984, 254.0659885406494, 255.6217794418335, 257.1775703430176, 258.70248675346375, 260.2274031639099, 261.73625111579895, 263.245099067688, 264.8023030757904, 266.3595070838928, 267.8907618522644, 269.422016620636, 271.01958990097046, 272.61716318130493, 274.12783432006836, 275.6385054588318, 277.0491428375244, 278.45978021621704, 279.9969735145569, 281.53416681289673, 283.10406255722046, 284.6739583015442, 286.27130913734436, 287.86865997314453, 289.3830394744873, 290.8974189758301, 292.5534474849701, 294.2094759941101, 295.65536880493164, 297.1012616157532, 298.5607011318207, 300.0201406478882, 301.48989939689636, 302.95965814590454, 304.4483425617218, 305.93702697753906, 307.6146764755249, 309.29232597351074, 310.8007392883301, 312.3091526031494, 313.7704873085022, 315.231822013855, 318.262567281723, 321.29331254959106]
[16.18, 16.18, 34.24, 34.24, 37.78, 37.78, 45.2, 45.2, 44.84, 44.84, 45.94, 45.94, 45.72, 45.72, 44.38, 44.38, 50.06, 50.06, 51.24, 51.24, 50.26, 50.26, 47.44, 47.44, 52.7, 52.7, 55.66, 55.66, 58.58, 58.58, 59.86, 59.86, 59.84, 59.84, 61.24, 61.24, 60.42, 60.42, 61.1, 61.1, 61.3, 61.3, 60.52, 60.52, 60.28, 60.28, 61.08, 61.08, 60.92, 60.92, 61.36, 61.36, 60.4, 60.4, 61.12, 61.12, 62.36, 62.36, 62.46, 62.46, 61.48, 61.48, 61.28, 61.28, 61.4, 61.4, 62.1, 62.1, 61.14, 61.14, 61.98, 61.98, 61.52, 61.52, 61.64, 61.64, 61.18, 61.18, 60.1, 60.1, 59.56, 59.56, 61.26, 61.26, 61.14, 61.14, 63.48, 63.48, 63.78, 63.78, 64.08, 64.08, 62.96, 62.96, 63.12, 63.12, 62.96, 62.96, 62.52, 62.52, 62.32, 62.32, 61.88, 61.88, 62.32, 62.32, 62.58, 62.58, 62.28, 62.28, 62.22, 62.22, 61.1, 61.1, 61.82, 61.82, 62.42, 62.42, 61.98, 61.98, 62.24, 62.24, 62.02, 62.02, 60.7, 60.7, 61.38, 61.38, 61.04, 61.04, 60.98, 60.98, 61.24, 61.24, 61.18, 61.18, 61.0, 61.0, 61.44, 61.44, 60.66, 60.66, 60.5, 60.5, 60.84, 60.84, 61.12, 61.12, 60.42, 60.42, 60.86, 60.86, 60.62, 60.62, 60.76, 60.76, 60.92, 60.92, 60.6, 60.6, 60.86, 60.86, 60.04, 60.04, 59.48, 59.48, 60.14, 60.14, 60.32, 60.32, 60.38, 60.38, 60.58, 60.58, 60.62, 60.62, 60.66, 60.66, 60.54, 60.54, 60.04, 60.04, 60.66, 60.66, 60.16, 60.16, 60.76, 60.76, 59.76, 59.76, 60.26, 60.26, 60.68, 60.68, 60.24, 60.24, 60.5, 60.5, 60.96, 60.96, 60.66, 60.66]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.788, Test loss: 2.063, Test accuracy: 19.96
Round   0, Global train loss: 1.788, Global test loss: 2.267, Global test accuracy: 13.80
Round   1, Train loss: 1.510, Test loss: 1.646, Test accuracy: 40.54
Round   1, Global train loss: 1.510, Global test loss: 2.028, Global test accuracy: 29.16
Round   2, Train loss: 1.675, Test loss: 1.495, Test accuracy: 42.90
Round   2, Global train loss: 1.675, Global test loss: 2.192, Global test accuracy: 23.50
Round   3, Train loss: 1.431, Test loss: 1.369, Test accuracy: 48.98
Round   3, Global train loss: 1.431, Global test loss: 1.844, Global test accuracy: 37.10
Round   4, Train loss: 1.223, Test loss: 1.403, Test accuracy: 46.64
Round   4, Global train loss: 1.223, Global test loss: 2.148, Global test accuracy: 27.68
Round   5, Train loss: 1.130, Test loss: 1.306, Test accuracy: 51.24
Round   5, Global train loss: 1.130, Global test loss: 1.747, Global test accuracy: 42.48
Round   6, Train loss: 1.301, Test loss: 1.260, Test accuracy: 53.68
Round   6, Global train loss: 1.301, Global test loss: 1.711, Global test accuracy: 44.70
Round   7, Train loss: 1.460, Test loss: 1.309, Test accuracy: 50.90
Round   7, Global train loss: 1.460, Global test loss: 1.954, Global test accuracy: 28.36
Round   8, Train loss: 1.267, Test loss: 1.248, Test accuracy: 54.90
Round   8, Global train loss: 1.267, Global test loss: 1.763, Global test accuracy: 38.66
Round   9, Train loss: 1.175, Test loss: 1.192, Test accuracy: 57.58
Round   9, Global train loss: 1.175, Global test loss: 1.611, Global test accuracy: 46.32
Round  10, Train loss: 1.185, Test loss: 1.108, Test accuracy: 61.28
Round  10, Global train loss: 1.185, Global test loss: 1.616, Global test accuracy: 47.30
Round  11, Train loss: 1.139, Test loss: 1.246, Test accuracy: 58.28
Round  11, Global train loss: 1.139, Global test loss: 1.939, Global test accuracy: 39.48
Round  12, Train loss: 1.336, Test loss: 1.103, Test accuracy: 61.58
Round  12, Global train loss: 1.336, Global test loss: 1.650, Global test accuracy: 44.88
Round  13, Train loss: 1.104, Test loss: 1.092, Test accuracy: 62.82
Round  13, Global train loss: 1.104, Global test loss: 1.561, Global test accuracy: 47.72
Round  14, Train loss: 1.431, Test loss: 1.016, Test accuracy: 64.94
Round  14, Global train loss: 1.431, Global test loss: 1.798, Global test accuracy: 41.84
Round  15, Train loss: 1.068, Test loss: 1.021, Test accuracy: 64.26
Round  15, Global train loss: 1.068, Global test loss: 1.554, Global test accuracy: 52.96
Round  16, Train loss: 1.064, Test loss: 0.986, Test accuracy: 66.74
Round  16, Global train loss: 1.064, Global test loss: 1.485, Global test accuracy: 55.34
Round  17, Train loss: 1.031, Test loss: 1.003, Test accuracy: 65.56
Round  17, Global train loss: 1.031, Global test loss: 1.507, Global test accuracy: 48.82
Round  18, Train loss: 0.888, Test loss: 0.993, Test accuracy: 65.96
Round  18, Global train loss: 0.888, Global test loss: 1.326, Global test accuracy: 55.28
Round  19, Train loss: 0.990, Test loss: 0.975, Test accuracy: 66.84
Round  19, Global train loss: 0.990, Global test loss: 1.330, Global test accuracy: 56.02
Round  20, Train loss: 0.939, Test loss: 0.980, Test accuracy: 66.72
Round  20, Global train loss: 0.939, Global test loss: 1.473, Global test accuracy: 55.18
Round  21, Train loss: 0.699, Test loss: 0.975, Test accuracy: 66.76
Round  21, Global train loss: 0.699, Global test loss: 1.264, Global test accuracy: 58.70
Round  22, Train loss: 0.607, Test loss: 0.961, Test accuracy: 67.62
Round  22, Global train loss: 0.607, Global test loss: 1.386, Global test accuracy: 57.66
Round  23, Train loss: 0.755, Test loss: 0.927, Test accuracy: 68.70
Round  23, Global train loss: 0.755, Global test loss: 1.496, Global test accuracy: 50.44
Round  24, Train loss: 0.656, Test loss: 0.950, Test accuracy: 68.34
Round  24, Global train loss: 0.656, Global test loss: 1.322, Global test accuracy: 58.88
Round  25, Train loss: 0.912, Test loss: 0.966, Test accuracy: 67.44
Round  25, Global train loss: 0.912, Global test loss: 1.498, Global test accuracy: 52.24
Round  26, Train loss: 0.812, Test loss: 0.935, Test accuracy: 68.50
Round  26, Global train loss: 0.812, Global test loss: 1.351, Global test accuracy: 56.54
Round  27, Train loss: 0.674, Test loss: 0.940, Test accuracy: 69.06
Round  27, Global train loss: 0.674, Global test loss: 1.180, Global test accuracy: 64.48
Round  28, Train loss: 0.736, Test loss: 0.951, Test accuracy: 68.30
Round  28, Global train loss: 0.736, Global test loss: 1.345, Global test accuracy: 57.70
Round  29, Train loss: 1.063, Test loss: 0.963, Test accuracy: 67.66
Round  29, Global train loss: 1.063, Global test loss: 1.585, Global test accuracy: 53.82
Round  30, Train loss: 0.737, Test loss: 0.977, Test accuracy: 67.52
Round  30, Global train loss: 0.737, Global test loss: 1.176, Global test accuracy: 62.84
Round  31, Train loss: 0.964, Test loss: 0.979, Test accuracy: 68.28
Round  31, Global train loss: 0.964, Global test loss: 1.477, Global test accuracy: 51.42
Round  32, Train loss: 1.032, Test loss: 0.972, Test accuracy: 68.00
Round  32, Global train loss: 1.032, Global test loss: 1.473, Global test accuracy: 53.30
Round  33, Train loss: 0.958, Test loss: 0.976, Test accuracy: 67.88
Round  33, Global train loss: 0.958, Global test loss: 1.635, Global test accuracy: 50.32
Round  34, Train loss: 0.613, Test loss: 1.011, Test accuracy: 67.12
Round  34, Global train loss: 0.613, Global test loss: 1.705, Global test accuracy: 53.32
Round  35, Train loss: 0.908, Test loss: 0.976, Test accuracy: 68.38
Round  35, Global train loss: 0.908, Global test loss: 1.582, Global test accuracy: 52.24
Round  36, Train loss: 0.669, Test loss: 0.961, Test accuracy: 69.14
Round  36, Global train loss: 0.669, Global test loss: 1.253, Global test accuracy: 60.04
Round  37, Train loss: 0.751, Test loss: 0.973, Test accuracy: 68.84
Round  37, Global train loss: 0.751, Global test loss: 1.335, Global test accuracy: 60.18
Round  38, Train loss: 0.837, Test loss: 0.983, Test accuracy: 68.38
Round  38, Global train loss: 0.837, Global test loss: 1.418, Global test accuracy: 56.00
Round  39, Train loss: 0.926, Test loss: 1.000, Test accuracy: 67.94
Round  39, Global train loss: 0.926, Global test loss: 1.621, Global test accuracy: 50.64
Round  40, Train loss: 0.539, Test loss: 1.022, Test accuracy: 67.80
Round  40, Global train loss: 0.539, Global test loss: 1.521, Global test accuracy: 56.32
Round  41, Train loss: 1.093, Test loss: 1.028, Test accuracy: 67.74
Round  41, Global train loss: 1.093, Global test loss: 1.366, Global test accuracy: 57.08
Round  42, Train loss: 0.829, Test loss: 1.056, Test accuracy: 67.34
Round  42, Global train loss: 0.829, Global test loss: 1.451, Global test accuracy: 52.28
Round  43, Train loss: 0.476, Test loss: 1.007, Test accuracy: 68.62
Round  43, Global train loss: 0.476, Global test loss: 1.542, Global test accuracy: 56.04
Round  44, Train loss: 0.767, Test loss: 0.996, Test accuracy: 68.48
Round  44, Global train loss: 0.767, Global test loss: 1.220, Global test accuracy: 59.88
Round  45, Train loss: 0.416, Test loss: 1.031, Test accuracy: 67.98
Round  45, Global train loss: 0.416, Global test loss: 1.454, Global test accuracy: 61.32
Round  46, Train loss: 0.437, Test loss: 1.012, Test accuracy: 67.80
Round  46, Global train loss: 0.437, Global test loss: 1.467, Global test accuracy: 61.12
Round  47, Train loss: 0.732, Test loss: 1.024, Test accuracy: 67.44
Round  47, Global train loss: 0.732, Global test loss: 1.545, Global test accuracy: 55.74
Round  48, Train loss: 0.335, Test loss: 1.061, Test accuracy: 67.24
Round  48, Global train loss: 0.335, Global test loss: 1.566, Global test accuracy: 58.68
Round  49, Train loss: 0.351, Test loss: 1.088, Test accuracy: 66.88
Round  49, Global train loss: 0.351, Global test loss: 1.533, Global test accuracy: 60.38
Round  50, Train loss: 0.289, Test loss: 1.096, Test accuracy: 67.30
Round  50, Global train loss: 0.289, Global test loss: 1.691, Global test accuracy: 59.86
Round  51, Train loss: 0.371, Test loss: 1.086, Test accuracy: 67.56
Round  51, Global train loss: 0.371, Global test loss: 1.455, Global test accuracy: 59.44
Round  52, Train loss: 0.366, Test loss: 1.068, Test accuracy: 67.52
Round  52, Global train loss: 0.366, Global test loss: 1.247, Global test accuracy: 64.34
Round  53, Train loss: 0.424, Test loss: 1.023, Test accuracy: 68.30
Round  53, Global train loss: 0.424, Global test loss: 1.259, Global test accuracy: 62.26
Round  54, Train loss: 0.690, Test loss: 1.045, Test accuracy: 68.78
Round  54, Global train loss: 0.690, Global test loss: 1.442, Global test accuracy: 58.14
Round  55, Train loss: 0.628, Test loss: 1.061, Test accuracy: 68.16
Round  55, Global train loss: 0.628, Global test loss: 1.560, Global test accuracy: 54.62
Round  56, Train loss: 0.528, Test loss: 1.074, Test accuracy: 67.26
Round  56, Global train loss: 0.528, Global test loss: 1.193, Global test accuracy: 62.22
Round  57, Train loss: 0.560, Test loss: 1.122, Test accuracy: 67.16
Round  57, Global train loss: 0.560, Global test loss: 1.368, Global test accuracy: 57.92
Round  58, Train loss: 0.393, Test loss: 1.100, Test accuracy: 67.28
Round  58, Global train loss: 0.393, Global test loss: 1.884, Global test accuracy: 50.84
Round  59, Train loss: 0.307, Test loss: 1.110, Test accuracy: 67.04
Round  59, Global train loss: 0.307, Global test loss: 1.322, Global test accuracy: 60.00
Round  60, Train loss: 0.634, Test loss: 1.100, Test accuracy: 67.62
Round  60, Global train loss: 0.634, Global test loss: 1.240, Global test accuracy: 62.84
Round  61, Train loss: 0.534, Test loss: 1.079, Test accuracy: 68.32
Round  61, Global train loss: 0.534, Global test loss: 1.355, Global test accuracy: 59.00
Round  62, Train loss: 0.362, Test loss: 1.080, Test accuracy: 68.64
Round  62, Global train loss: 0.362, Global test loss: 1.740, Global test accuracy: 55.80
Round  63, Train loss: 0.488, Test loss: 1.068, Test accuracy: 69.42
Round  63, Global train loss: 0.488, Global test loss: 1.654, Global test accuracy: 54.62
Round  64, Train loss: 0.609, Test loss: 1.103, Test accuracy: 68.58
Round  64, Global train loss: 0.609, Global test loss: 1.314, Global test accuracy: 61.90
Round  65, Train loss: 0.256, Test loss: 1.149, Test accuracy: 68.50
Round  65, Global train loss: 0.256, Global test loss: 1.749, Global test accuracy: 58.46
Round  66, Train loss: 0.267, Test loss: 1.178, Test accuracy: 66.86
Round  66, Global train loss: 0.267, Global test loss: 1.504, Global test accuracy: 61.32
Round  67, Train loss: 0.590, Test loss: 1.162, Test accuracy: 67.34
Round  67, Global train loss: 0.590, Global test loss: 1.437, Global test accuracy: 58.68
Round  68, Train loss: 0.220, Test loss: 1.160, Test accuracy: 67.54
Round  68, Global train loss: 0.220, Global test loss: 1.400, Global test accuracy: 63.64
Round  69, Train loss: 0.264, Test loss: 1.152, Test accuracy: 67.58
Round  69, Global train loss: 0.264, Global test loss: 1.437, Global test accuracy: 64.40
Round  70, Train loss: 0.251, Test loss: 1.184, Test accuracy: 67.10
Round  70, Global train loss: 0.251, Global test loss: 1.493, Global test accuracy: 62.08
Round  71, Train loss: 0.609, Test loss: 1.206, Test accuracy: 67.64
Round  71, Global train loss: 0.609, Global test loss: 1.251, Global test accuracy: 64.34
Round  72, Train loss: 0.191, Test loss: 1.226, Test accuracy: 67.06
Round  72, Global train loss: 0.191, Global test loss: 1.610, Global test accuracy: 60.80
Round  73, Train loss: 0.306, Test loss: 1.194, Test accuracy: 68.06
Round  73, Global train loss: 0.306, Global test loss: 1.961, Global test accuracy: 54.28
Round  74, Train loss: 0.524, Test loss: 1.198, Test accuracy: 67.76
Round  74, Global train loss: 0.524, Global test loss: 1.463, Global test accuracy: 60.24
Round  75, Train loss: 0.533, Test loss: 1.211, Test accuracy: 67.68
Round  75, Global train loss: 0.533, Global test loss: 1.526, Global test accuracy: 55.22
Round  76, Train loss: 0.189, Test loss: 1.242, Test accuracy: 67.78
Round  76, Global train loss: 0.189, Global test loss: 1.313, Global test accuracy: 64.76
Round  77, Train loss: 0.211, Test loss: 1.248, Test accuracy: 67.76
Round  77, Global train loss: 0.211, Global test loss: 1.737, Global test accuracy: 60.40
Round  78, Train loss: 0.165, Test loss: 1.253, Test accuracy: 67.54
Round  78, Global train loss: 0.165, Global test loss: 1.531, Global test accuracy: 64.00
Round  79, Train loss: 0.511, Test loss: 1.214, Test accuracy: 67.90
Round  79, Global train loss: 0.511, Global test loss: 1.314, Global test accuracy: 60.52
Round  80, Train loss: 0.364, Test loss: 1.264, Test accuracy: 67.40
Round  80, Global train loss: 0.364, Global test loss: 1.658, Global test accuracy: 61.24
Round  81, Train loss: 0.460, Test loss: 1.258, Test accuracy: 68.30
Round  81, Global train loss: 0.460, Global test loss: 1.488, Global test accuracy: 61.60
Round  82, Train loss: 0.187, Test loss: 1.265, Test accuracy: 68.24
Round  82, Global train loss: 0.187, Global test loss: 1.509, Global test accuracy: 60.94
Round  83, Train loss: 0.491, Test loss: 1.332, Test accuracy: 66.52
Round  83, Global train loss: 0.491, Global test loss: 1.967, Global test accuracy: 50.24
Round  84, Train loss: 0.649, Test loss: 1.293, Test accuracy: 68.18
Round  84, Global train loss: 0.649, Global test loss: 1.813, Global test accuracy: 49.48
Round  85, Train loss: 0.188, Test loss: 1.273, Test accuracy: 68.74
Round  85, Global train loss: 0.188, Global test loss: 1.541, Global test accuracy: 62.40
Round  86, Train loss: 0.392, Test loss: 1.340, Test accuracy: 67.14
Round  86, Global train loss: 0.392, Global test loss: 1.808, Global test accuracy: 52.42
Round  87, Train loss: 0.437, Test loss: 1.394, Test accuracy: 66.78
Round  87, Global train loss: 0.437, Global test loss: 1.648, Global test accuracy: 55.10
Round  88, Train loss: 0.400, Test loss: 1.353, Test accuracy: 66.52
Round  88, Global train loss: 0.400, Global test loss: 1.728, Global test accuracy: 53.14
Round  89, Train loss: 0.387, Test loss: 1.329, Test accuracy: 66.66
Round  89, Global train loss: 0.387, Global test loss: 1.679, Global test accuracy: 57.52
Round  90, Train loss: 0.194, Test loss: 1.338, Test accuracy: 66.50
Round  90, Global train loss: 0.194, Global test loss: 1.781, Global test accuracy: 60.88
Round  91, Train loss: 0.121, Test loss: 1.394, Test accuracy: 66.26
Round  91, Global train loss: 0.121, Global test loss: 1.932, Global test accuracy: 58.14
Round  92, Train loss: 0.221, Test loss: 1.358, Test accuracy: 66.90
Round  92, Global train loss: 0.221, Global test loss: 1.538, Global test accuracy: 61.84
Round  93, Train loss: 0.202, Test loss: 1.418, Test accuracy: 66.48
Round  93, Global train loss: 0.202, Global test loss: 2.120, Global test accuracy: 56.68
Round  94, Train loss: 0.313, Test loss: 1.400, Test accuracy: 66.78
Round  94, Global train loss: 0.313, Global test loss: 1.467, Global test accuracy: 63.48
Round  95, Train loss: 0.374, Test loss: 1.415, Test accuracy: 66.76
Round  95, Global train loss: 0.374, Global test loss: 1.462, Global test accuracy: 60.94
Round  96, Train loss: 0.322, Test loss: 1.432, Test accuracy: 65.72
Round  96, Global train loss: 0.322, Global test loss: 1.550, Global test accuracy: 58.18
Round  97, Train loss: 0.302, Test loss: 1.485, Test accuracy: 65.24
Round  97, Global train loss: 0.302, Global test loss: 1.607, Global test accuracy: 59.92
Round  98, Train loss: 0.159, Test loss: 1.509, Test accuracy: 65.14
Round  98, Global train loss: 0.159, Global test loss: 1.492, Global test accuracy: 64.00
Round  99, Train loss: 0.160, Test loss: 1.445, Test accuracy: 66.50
Round  99, Global train loss: 0.160, Global test loss: 1.641, Global test accuracy: 63.16
Final Round, Train loss: 0.221, Test loss: 1.567, Test accuracy: 66.38
Final Round, Global train loss: 0.221, Global test loss: 1.641, Global test accuracy: 63.16
Average accuracy final 10 rounds: 66.22800000000001 

Average global accuracy final 10 rounds: 60.721999999999994 

1019.9596657752991
[2.034153938293457, 4.068307876586914, 5.628625392913818, 7.188942909240723, 8.764203071594238, 10.339463233947754, 11.89368224143982, 13.447901248931885, 15.075387954711914, 16.702874660491943, 18.42291760444641, 20.14296054840088, 21.805158376693726, 23.467356204986572, 25.130370140075684, 26.793384075164795, 28.456503868103027, 30.11962366104126, 31.79146647453308, 33.4633092880249, 34.99558091163635, 36.5278525352478, 38.05783939361572, 39.58782625198364, 41.17260789871216, 42.757389545440674, 44.29909944534302, 45.84080934524536, 47.445345640182495, 49.04988193511963, 50.6609742641449, 52.272066593170166, 53.95964193344116, 55.64721727371216, 57.17373967170715, 58.70026206970215, 60.42008566856384, 62.13990926742554, 63.781336545944214, 65.42276382446289, 66.98890709877014, 68.55505037307739, 70.1788055896759, 71.80256080627441, 73.43007683753967, 75.05759286880493, 76.74424767494202, 78.4309024810791, 79.98251295089722, 81.53412342071533, 83.10304856300354, 84.67197370529175, 86.29094815254211, 87.90992259979248, 89.42153644561768, 90.93315029144287, 92.54915833473206, 94.16516637802124, 95.75013017654419, 97.33509397506714, 98.88158679008484, 100.42807960510254, 101.94982767105103, 103.47157573699951, 105.0405786037445, 106.6095814704895, 108.21678447723389, 109.82398748397827, 111.4011583328247, 112.97832918167114, 114.52710556983948, 116.07588195800781, 117.59584474563599, 119.11580753326416, 120.75921726226807, 122.40262699127197, 124.05358982086182, 125.70455265045166, 127.24409794807434, 128.78364324569702, 130.34413385391235, 131.90462446212769, 133.48880171775818, 135.07297897338867, 136.59356379508972, 138.11414861679077, 139.69445657730103, 141.27476453781128, 142.87338304519653, 144.4720015525818, 146.03961277008057, 147.60722398757935, 149.1437051296234, 150.68018627166748, 152.16272354125977, 153.64526081085205, 155.26117515563965, 156.87708950042725, 158.5059654712677, 160.13484144210815, 161.74320936203003, 163.3515772819519, 165.1518998146057, 166.95222234725952, 168.55976748466492, 170.1673126220703, 171.66740584373474, 173.16749906539917, 174.73172640800476, 176.29595375061035, 177.83627152442932, 179.3765892982483, 180.91295552253723, 182.44932174682617, 183.97832465171814, 185.5073275566101, 187.06701970100403, 188.62671184539795, 190.2737901210785, 191.92086839675903, 193.6250138282776, 195.32915925979614, 196.9722068309784, 198.61525440216064, 200.4493179321289, 202.28338146209717, 203.94894409179688, 205.61450672149658, 207.28700160980225, 208.9594964981079, 210.6623499393463, 212.36520338058472, 213.9679217338562, 215.57064008712769, 217.0375533103943, 218.5044665336609, 220.0161771774292, 221.5278878211975, 223.15357089042664, 224.77925395965576, 226.31701612472534, 227.85477828979492, 229.41097497940063, 230.96717166900635, 232.48262810707092, 233.9980845451355, 235.44828128814697, 236.89847803115845, 238.49488353729248, 240.0912890434265, 241.6822533607483, 243.27321767807007, 244.7852804660797, 246.29734325408936, 247.87286925315857, 249.44839525222778, 251.0877754688263, 252.7271556854248, 254.40333342552185, 256.0795111656189, 257.5787477493286, 259.07798433303833, 260.70921087265015, 262.34043741226196, 263.94463181495667, 265.54882621765137, 267.108101606369, 268.66737699508667, 270.21480536460876, 271.76223373413086, 273.26245975494385, 274.76268577575684, 276.32828402519226, 277.8938822746277, 279.4873917102814, 281.08090114593506, 282.73004031181335, 284.37917947769165, 285.9192006587982, 287.4592218399048, 289.11037945747375, 290.7615370750427, 292.3854172229767, 294.00929737091064, 295.53006768226624, 297.0508379936218, 298.66890716552734, 300.28697633743286, 301.85052943229675, 303.41408252716064, 305.0287539958954, 306.6434254646301, 308.1943564414978, 309.7452874183655, 311.407030582428, 313.0687737464905, 314.76435899734497, 316.45994424819946, 318.13604712486267, 319.8121500015259, 323.12682461738586, 326.44149923324585]
[19.96, 19.96, 40.54, 40.54, 42.9, 42.9, 48.98, 48.98, 46.64, 46.64, 51.24, 51.24, 53.68, 53.68, 50.9, 50.9, 54.9, 54.9, 57.58, 57.58, 61.28, 61.28, 58.28, 58.28, 61.58, 61.58, 62.82, 62.82, 64.94, 64.94, 64.26, 64.26, 66.74, 66.74, 65.56, 65.56, 65.96, 65.96, 66.84, 66.84, 66.72, 66.72, 66.76, 66.76, 67.62, 67.62, 68.7, 68.7, 68.34, 68.34, 67.44, 67.44, 68.5, 68.5, 69.06, 69.06, 68.3, 68.3, 67.66, 67.66, 67.52, 67.52, 68.28, 68.28, 68.0, 68.0, 67.88, 67.88, 67.12, 67.12, 68.38, 68.38, 69.14, 69.14, 68.84, 68.84, 68.38, 68.38, 67.94, 67.94, 67.8, 67.8, 67.74, 67.74, 67.34, 67.34, 68.62, 68.62, 68.48, 68.48, 67.98, 67.98, 67.8, 67.8, 67.44, 67.44, 67.24, 67.24, 66.88, 66.88, 67.3, 67.3, 67.56, 67.56, 67.52, 67.52, 68.3, 68.3, 68.78, 68.78, 68.16, 68.16, 67.26, 67.26, 67.16, 67.16, 67.28, 67.28, 67.04, 67.04, 67.62, 67.62, 68.32, 68.32, 68.64, 68.64, 69.42, 69.42, 68.58, 68.58, 68.5, 68.5, 66.86, 66.86, 67.34, 67.34, 67.54, 67.54, 67.58, 67.58, 67.1, 67.1, 67.64, 67.64, 67.06, 67.06, 68.06, 68.06, 67.76, 67.76, 67.68, 67.68, 67.78, 67.78, 67.76, 67.76, 67.54, 67.54, 67.9, 67.9, 67.4, 67.4, 68.3, 68.3, 68.24, 68.24, 66.52, 66.52, 68.18, 68.18, 68.74, 68.74, 67.14, 67.14, 66.78, 66.78, 66.52, 66.52, 66.66, 66.66, 66.5, 66.5, 66.26, 66.26, 66.9, 66.9, 66.48, 66.48, 66.78, 66.78, 66.76, 66.76, 65.72, 65.72, 65.24, 65.24, 65.14, 65.14, 66.5, 66.5, 66.38, 66.38]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.795, Test loss: 2.120, Test accuracy: 16.30
Round   0, Global train loss: 1.795, Global test loss: 2.311, Global test accuracy: 10.00
Round   1, Train loss: 1.609, Test loss: 1.793, Test accuracy: 32.02
Round   1, Global train loss: 1.609, Global test loss: 2.186, Global test accuracy: 22.20
Round   2, Train loss: 1.583, Test loss: 1.569, Test accuracy: 38.10
Round   2, Global train loss: 1.583, Global test loss: 2.164, Global test accuracy: 18.58
Round   3, Train loss: 1.518, Test loss: 1.455, Test accuracy: 47.24
Round   3, Global train loss: 1.518, Global test loss: 1.877, Global test accuracy: 35.08
Round   4, Train loss: 1.419, Test loss: 1.429, Test accuracy: 49.78
Round   4, Global train loss: 1.419, Global test loss: 1.896, Global test accuracy: 36.78
Round   5, Train loss: 1.534, Test loss: 1.449, Test accuracy: 49.34
Round   5, Global train loss: 1.534, Global test loss: 1.934, Global test accuracy: 38.72
Round   6, Train loss: 1.391, Test loss: 1.389, Test accuracy: 51.60
Round   6, Global train loss: 1.391, Global test loss: 1.750, Global test accuracy: 41.84
Round   7, Train loss: 1.222, Test loss: 1.393, Test accuracy: 50.88
Round   7, Global train loss: 1.222, Global test loss: 1.833, Global test accuracy: 34.96
Round   8, Train loss: 1.154, Test loss: 1.350, Test accuracy: 52.76
Round   8, Global train loss: 1.154, Global test loss: 1.754, Global test accuracy: 38.64
Round   9, Train loss: 1.136, Test loss: 1.298, Test accuracy: 54.98
Round   9, Global train loss: 1.136, Global test loss: 1.637, Global test accuracy: 42.98
Round  10, Train loss: 1.390, Test loss: 1.256, Test accuracy: 57.46
Round  10, Global train loss: 1.390, Global test loss: 1.674, Global test accuracy: 43.72
Round  11, Train loss: 1.044, Test loss: 1.333, Test accuracy: 54.38
Round  11, Global train loss: 1.044, Global test loss: 1.722, Global test accuracy: 40.96
Round  12, Train loss: 0.968, Test loss: 1.203, Test accuracy: 58.54
Round  12, Global train loss: 0.968, Global test loss: 1.556, Global test accuracy: 46.60
Round  13, Train loss: 1.106, Test loss: 1.141, Test accuracy: 61.00
Round  13, Global train loss: 1.106, Global test loss: 1.543, Global test accuracy: 48.18
Round  14, Train loss: 1.131, Test loss: 1.074, Test accuracy: 63.36
Round  14, Global train loss: 1.131, Global test loss: 1.727, Global test accuracy: 43.00
Round  15, Train loss: 0.955, Test loss: 1.073, Test accuracy: 63.74
Round  15, Global train loss: 0.955, Global test loss: 1.467, Global test accuracy: 50.64
Round  16, Train loss: 1.169, Test loss: 1.070, Test accuracy: 62.30
Round  16, Global train loss: 1.169, Global test loss: 1.502, Global test accuracy: 52.52
Round  17, Train loss: 1.235, Test loss: 1.042, Test accuracy: 64.66
Round  17, Global train loss: 1.235, Global test loss: 1.494, Global test accuracy: 46.16
Round  18, Train loss: 1.219, Test loss: 1.051, Test accuracy: 64.48
Round  18, Global train loss: 1.219, Global test loss: 1.515, Global test accuracy: 51.52
Round  19, Train loss: 1.170, Test loss: 1.024, Test accuracy: 64.60
Round  19, Global train loss: 1.170, Global test loss: 1.459, Global test accuracy: 50.20
Round  20, Train loss: 0.831, Test loss: 1.019, Test accuracy: 64.62
Round  20, Global train loss: 0.831, Global test loss: 1.538, Global test accuracy: 48.94
Round  21, Train loss: 0.928, Test loss: 1.028, Test accuracy: 63.46
Round  21, Global train loss: 0.928, Global test loss: 1.427, Global test accuracy: 50.54
Round  22, Train loss: 1.125, Test loss: 1.006, Test accuracy: 65.02
Round  22, Global train loss: 1.125, Global test loss: 1.367, Global test accuracy: 53.94
Round  23, Train loss: 0.743, Test loss: 1.032, Test accuracy: 64.50
Round  23, Global train loss: 0.743, Global test loss: 1.579, Global test accuracy: 49.14
Round  24, Train loss: 1.325, Test loss: 1.022, Test accuracy: 64.10
Round  24, Global train loss: 1.325, Global test loss: 1.534, Global test accuracy: 51.20
Round  25, Train loss: 1.285, Test loss: 0.996, Test accuracy: 66.00
Round  25, Global train loss: 1.285, Global test loss: 1.511, Global test accuracy: 47.86
Round  26, Train loss: 0.722, Test loss: 1.003, Test accuracy: 66.46
Round  26, Global train loss: 0.722, Global test loss: 1.445, Global test accuracy: 52.46
Round  27, Train loss: 1.054, Test loss: 1.008, Test accuracy: 66.56
Round  27, Global train loss: 1.054, Global test loss: 1.441, Global test accuracy: 52.58
Round  28, Train loss: 0.670, Test loss: 0.990, Test accuracy: 66.82
Round  28, Global train loss: 0.670, Global test loss: 1.403, Global test accuracy: 54.24
Round  29, Train loss: 0.907, Test loss: 0.992, Test accuracy: 66.92
Round  29, Global train loss: 0.907, Global test loss: 1.371, Global test accuracy: 55.00
Round  30, Train loss: 0.922, Test loss: 0.998, Test accuracy: 66.60
Round  30, Global train loss: 0.922, Global test loss: 1.254, Global test accuracy: 55.86
Round  31, Train loss: 0.597, Test loss: 0.987, Test accuracy: 67.60
Round  31, Global train loss: 0.597, Global test loss: 1.417, Global test accuracy: 53.32
Round  32, Train loss: 0.662, Test loss: 1.016, Test accuracy: 66.76
Round  32, Global train loss: 0.662, Global test loss: 1.505, Global test accuracy: 52.44
Round  33, Train loss: 0.844, Test loss: 1.012, Test accuracy: 66.32
Round  33, Global train loss: 0.844, Global test loss: 1.419, Global test accuracy: 55.84
Round  34, Train loss: 1.313, Test loss: 0.993, Test accuracy: 67.00
Round  34, Global train loss: 1.313, Global test loss: 1.649, Global test accuracy: 48.12
Round  35, Train loss: 0.979, Test loss: 0.969, Test accuracy: 68.28
Round  35, Global train loss: 0.979, Global test loss: 1.453, Global test accuracy: 55.26
Round  36, Train loss: 0.923, Test loss: 0.981, Test accuracy: 67.56
Round  36, Global train loss: 0.923, Global test loss: 1.360, Global test accuracy: 54.50
Round  37, Train loss: 0.931, Test loss: 0.960, Test accuracy: 69.06
Round  37, Global train loss: 0.931, Global test loss: 1.347, Global test accuracy: 58.74
Round  38, Train loss: 1.211, Test loss: 0.977, Test accuracy: 67.72
Round  38, Global train loss: 1.211, Global test loss: 1.522, Global test accuracy: 50.44
Round  39, Train loss: 0.557, Test loss: 0.982, Test accuracy: 67.66
Round  39, Global train loss: 0.557, Global test loss: 1.377, Global test accuracy: 58.28
Round  40, Train loss: 0.520, Test loss: 0.999, Test accuracy: 67.34
Round  40, Global train loss: 0.520, Global test loss: 1.416, Global test accuracy: 56.26
Round  41, Train loss: 0.832, Test loss: 0.989, Test accuracy: 67.12
Round  41, Global train loss: 0.832, Global test loss: 1.171, Global test accuracy: 61.74
Round  42, Train loss: 1.092, Test loss: 0.954, Test accuracy: 68.20
Round  42, Global train loss: 1.092, Global test loss: 1.326, Global test accuracy: 54.74
Round  43, Train loss: 1.099, Test loss: 0.963, Test accuracy: 68.20
Round  43, Global train loss: 1.099, Global test loss: 1.290, Global test accuracy: 58.54
Round  44, Train loss: 0.508, Test loss: 0.988, Test accuracy: 67.78
Round  44, Global train loss: 0.508, Global test loss: 1.344, Global test accuracy: 57.94
Round  45, Train loss: 0.836, Test loss: 1.001, Test accuracy: 67.14
Round  45, Global train loss: 0.836, Global test loss: 1.337, Global test accuracy: 57.38
Round  46, Train loss: 1.111, Test loss: 0.991, Test accuracy: 67.12
Round  46, Global train loss: 1.111, Global test loss: 1.323, Global test accuracy: 56.00
Round  47, Train loss: 0.656, Test loss: 0.989, Test accuracy: 66.80
Round  47, Global train loss: 0.656, Global test loss: 1.406, Global test accuracy: 57.76
Round  48, Train loss: 0.748, Test loss: 1.034, Test accuracy: 65.14
Round  48, Global train loss: 0.748, Global test loss: 1.294, Global test accuracy: 58.58
Round  49, Train loss: 0.995, Test loss: 1.071, Test accuracy: 63.86
Round  49, Global train loss: 0.995, Global test loss: 1.432, Global test accuracy: 53.64
Round  50, Train loss: 0.910, Test loss: 1.118, Test accuracy: 63.82
Round  50, Global train loss: 0.910, Global test loss: 1.560, Global test accuracy: 50.88
Round  51, Train loss: 0.507, Test loss: 1.112, Test accuracy: 64.50
Round  51, Global train loss: 0.507, Global test loss: 1.545, Global test accuracy: 55.60
Round  52, Train loss: 0.437, Test loss: 1.125, Test accuracy: 64.02
Round  52, Global train loss: 0.437, Global test loss: 1.364, Global test accuracy: 57.60
Round  53, Train loss: 0.732, Test loss: 1.167, Test accuracy: 63.28
Round  53, Global train loss: 0.732, Global test loss: 1.350, Global test accuracy: 57.58
Round  54, Train loss: 0.609, Test loss: 1.127, Test accuracy: 64.60
Round  54, Global train loss: 0.609, Global test loss: 1.290, Global test accuracy: 60.02
Round  55, Train loss: 0.686, Test loss: 1.119, Test accuracy: 65.02
Round  55, Global train loss: 0.686, Global test loss: 1.329, Global test accuracy: 59.90
Round  56, Train loss: 0.644, Test loss: 1.093, Test accuracy: 66.00
Round  56, Global train loss: 0.644, Global test loss: 1.373, Global test accuracy: 58.12
Round  57, Train loss: 0.277, Test loss: 1.075, Test accuracy: 66.00
Round  57, Global train loss: 0.277, Global test loss: 1.470, Global test accuracy: 57.62
Round  58, Train loss: 0.791, Test loss: 1.043, Test accuracy: 67.18
Round  58, Global train loss: 0.791, Global test loss: 1.484, Global test accuracy: 55.96
Round  59, Train loss: 0.787, Test loss: 1.051, Test accuracy: 66.98
Round  59, Global train loss: 0.787, Global test loss: 1.440, Global test accuracy: 53.64
Round  60, Train loss: 0.635, Test loss: 1.073, Test accuracy: 66.60
Round  60, Global train loss: 0.635, Global test loss: 1.323, Global test accuracy: 59.72
Round  61, Train loss: 0.285, Test loss: 1.099, Test accuracy: 65.86
Round  61, Global train loss: 0.285, Global test loss: 1.555, Global test accuracy: 58.02
Round  62, Train loss: 0.798, Test loss: 1.092, Test accuracy: 65.80
Round  62, Global train loss: 0.798, Global test loss: 1.448, Global test accuracy: 54.48
Round  63, Train loss: 0.546, Test loss: 1.098, Test accuracy: 66.00
Round  63, Global train loss: 0.546, Global test loss: 1.519, Global test accuracy: 57.42
Round  64, Train loss: 0.460, Test loss: 1.137, Test accuracy: 65.50
Round  64, Global train loss: 0.460, Global test loss: 1.458, Global test accuracy: 57.24
Round  65, Train loss: 0.812, Test loss: 1.153, Test accuracy: 65.22
Round  65, Global train loss: 0.812, Global test loss: 1.551, Global test accuracy: 52.00
Round  66, Train loss: 0.452, Test loss: 1.213, Test accuracy: 64.16
Round  66, Global train loss: 0.452, Global test loss: 1.452, Global test accuracy: 58.12
Round  67, Train loss: 0.627, Test loss: 1.228, Test accuracy: 64.74
Round  67, Global train loss: 0.627, Global test loss: 1.778, Global test accuracy: 50.64
Round  68, Train loss: 0.531, Test loss: 1.236, Test accuracy: 65.36
Round  68, Global train loss: 0.531, Global test loss: 1.587, Global test accuracy: 55.10
Round  69, Train loss: 0.330, Test loss: 1.239, Test accuracy: 65.34
Round  69, Global train loss: 0.330, Global test loss: 1.660, Global test accuracy: 56.50
Round  70, Train loss: 0.268, Test loss: 1.267, Test accuracy: 64.68
Round  70, Global train loss: 0.268, Global test loss: 1.680, Global test accuracy: 57.50
Round  71, Train loss: 0.522, Test loss: 1.253, Test accuracy: 64.32
Round  71, Global train loss: 0.522, Global test loss: 1.342, Global test accuracy: 60.42
Round  72, Train loss: 0.375, Test loss: 1.235, Test accuracy: 64.84
Round  72, Global train loss: 0.375, Global test loss: 1.534, Global test accuracy: 57.90
Round  73, Train loss: 0.624, Test loss: 1.254, Test accuracy: 64.32
Round  73, Global train loss: 0.624, Global test loss: 1.552, Global test accuracy: 54.40
Round  74, Train loss: 0.546, Test loss: 1.264, Test accuracy: 64.34
Round  74, Global train loss: 0.546, Global test loss: 1.627, Global test accuracy: 53.00
Round  75, Train loss: 0.430, Test loss: 1.276, Test accuracy: 64.50
Round  75, Global train loss: 0.430, Global test loss: 1.494, Global test accuracy: 58.04
Round  76, Train loss: 0.468, Test loss: 1.310, Test accuracy: 64.64
Round  76, Global train loss: 0.468, Global test loss: 1.511, Global test accuracy: 56.90
Round  77, Train loss: 0.677, Test loss: 1.264, Test accuracy: 65.48
Round  77, Global train loss: 0.677, Global test loss: 1.686, Global test accuracy: 53.74
Round  78, Train loss: 0.410, Test loss: 1.281, Test accuracy: 65.08
Round  78, Global train loss: 0.410, Global test loss: 1.646, Global test accuracy: 55.92
Round  79, Train loss: 0.376, Test loss: 1.278, Test accuracy: 65.48
Round  79, Global train loss: 0.376, Global test loss: 1.519, Global test accuracy: 55.88
Round  80, Train loss: 0.269, Test loss: 1.331, Test accuracy: 65.32
Round  80, Global train loss: 0.269, Global test loss: 1.797, Global test accuracy: 55.58
Round  81, Train loss: 0.457, Test loss: 1.328, Test accuracy: 65.42
Round  81, Global train loss: 0.457, Global test loss: 1.531, Global test accuracy: 57.06
Round  82, Train loss: 0.303, Test loss: 1.383, Test accuracy: 64.48
Round  82, Global train loss: 0.303, Global test loss: 1.630, Global test accuracy: 56.20
Round  83, Train loss: 0.277, Test loss: 1.425, Test accuracy: 64.40
Round  83, Global train loss: 0.277, Global test loss: 1.591, Global test accuracy: 61.64
Round  84, Train loss: 0.240, Test loss: 1.441, Test accuracy: 64.16
Round  84, Global train loss: 0.240, Global test loss: 1.524, Global test accuracy: 61.98
Round  85, Train loss: 0.408, Test loss: 1.424, Test accuracy: 64.48
Round  85, Global train loss: 0.408, Global test loss: 1.598, Global test accuracy: 58.90
Round  86, Train loss: 0.463, Test loss: 1.475, Test accuracy: 63.88
Round  86, Global train loss: 0.463, Global test loss: 1.590, Global test accuracy: 55.94
Round  87, Train loss: 0.261, Test loss: 1.426, Test accuracy: 64.22
Round  87, Global train loss: 0.261, Global test loss: 1.614, Global test accuracy: 59.06
Round  88, Train loss: 0.364, Test loss: 1.466, Test accuracy: 64.66
Round  88, Global train loss: 0.364, Global test loss: 1.617, Global test accuracy: 58.42
Round  89, Train loss: 0.443, Test loss: 1.470, Test accuracy: 64.40
Round  89, Global train loss: 0.443, Global test loss: 1.585, Global test accuracy: 56.06
Round  90, Train loss: 0.180, Test loss: 1.475, Test accuracy: 64.44
Round  90, Global train loss: 0.180, Global test loss: 1.757, Global test accuracy: 59.18
Round  91, Train loss: 0.167, Test loss: 1.516, Test accuracy: 63.62
Round  91, Global train loss: 0.167, Global test loss: 1.983, Global test accuracy: 58.22
Round  92, Train loss: 0.193, Test loss: 1.509, Test accuracy: 63.92
Round  92, Global train loss: 0.193, Global test loss: 1.858, Global test accuracy: 60.54
Round  93, Train loss: 0.513, Test loss: 1.479, Test accuracy: 64.28
Round  93, Global train loss: 0.513, Global test loss: 1.894, Global test accuracy: 50.96
Round  94, Train loss: 0.319, Test loss: 1.470, Test accuracy: 64.30
Round  94, Global train loss: 0.319, Global test loss: 1.669, Global test accuracy: 57.96/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.275, Test loss: 1.508, Test accuracy: 64.36
Round  95, Global train loss: 0.275, Global test loss: 1.575, Global test accuracy: 57.98
Round  96, Train loss: 0.230, Test loss: 1.483, Test accuracy: 63.92
Round  96, Global train loss: 0.230, Global test loss: 1.602, Global test accuracy: 57.08
Round  97, Train loss: 0.345, Test loss: 1.508, Test accuracy: 64.38
Round  97, Global train loss: 0.345, Global test loss: 1.594, Global test accuracy: 58.12
Round  98, Train loss: 0.207, Test loss: 1.512, Test accuracy: 64.48
Round  98, Global train loss: 0.207, Global test loss: 1.673, Global test accuracy: 59.68
Round  99, Train loss: 0.299, Test loss: 1.521, Test accuracy: 64.58
Round  99, Global train loss: 0.299, Global test loss: 1.803, Global test accuracy: 55.42
Final Round, Train loss: 0.243, Test loss: 1.675, Test accuracy: 64.12
Final Round, Global train loss: 0.243, Global test loss: 1.803, Global test accuracy: 55.42
Average accuracy final 10 rounds: 64.22800000000001 

Average global accuracy final 10 rounds: 57.513999999999996 

1041.0328452587128
[1.9154362678527832, 3.8308725357055664, 5.462956190109253, 7.0950398445129395, 8.822017431259155, 10.548995018005371, 12.296545028686523, 14.044095039367676, 15.680424451828003, 17.31675386428833, 19.028196334838867, 20.739638805389404, 22.41972017288208, 24.099801540374756, 25.8403217792511, 27.58084201812744, 29.175856590270996, 30.77087116241455, 32.50632429122925, 34.241777420043945, 35.96123290061951, 37.68068838119507, 39.68787240982056, 41.695056438446045, 43.42714548110962, 45.15923452377319, 46.8823025226593, 48.60537052154541, 50.3186194896698, 52.03186845779419, 53.66753602027893, 55.30320358276367, 57.019014835357666, 58.73482608795166, 60.53152251243591, 62.328218936920166, 63.95074200630188, 65.5732650756836, 67.20872640609741, 68.84418773651123, 70.54826378822327, 72.2523398399353, 74.05886483192444, 75.86538982391357, 77.56111574172974, 79.2568416595459, 80.87568020820618, 82.49451875686646, 84.11698389053345, 85.73944902420044, 87.42820048332214, 89.11695194244385, 90.7782564163208, 92.43956089019775, 94.10576057434082, 95.77196025848389, 97.48900985717773, 99.20605945587158, 101.31635332107544, 103.4266471862793, 105.07059931755066, 106.71455144882202, 108.41807723045349, 110.12160301208496, 111.75888323783875, 113.39616346359253, 115.0641496181488, 116.73213577270508, 118.46836996078491, 120.20460414886475, 122.1156861782074, 124.02676820755005, 125.6955976486206, 127.36442708969116, 129.22505688667297, 131.08568668365479, 132.84347128868103, 134.60125589370728, 136.3288550376892, 138.05645418167114, 139.74728560447693, 141.43811702728271, 143.16074919700623, 144.88338136672974, 146.55048608779907, 148.2175908088684, 149.94424986839294, 151.67090892791748, 153.38229417800903, 155.0936794281006, 156.72287845611572, 158.35207748413086, 160.0748381614685, 161.79759883880615, 163.5164966583252, 165.23539447784424, 166.90419697761536, 168.57299947738647, 170.422354221344, 172.2717089653015, 174.02073788642883, 175.76976680755615, 177.33866810798645, 178.90756940841675, 180.6408987045288, 182.37422800064087, 184.17146730422974, 185.9687066078186, 187.91145849227905, 189.8542103767395, 191.70866465568542, 193.56311893463135, 195.18741512298584, 196.81171131134033, 198.5446047782898, 200.27749824523926, 202.09042263031006, 203.90334701538086, 205.67494821548462, 207.44654941558838, 209.34726643562317, 211.24798345565796, 213.15403413772583, 215.0600848197937, 216.8001353740692, 218.54018592834473, 220.37694597244263, 222.21370601654053, 223.91842103004456, 225.62313604354858, 227.4233376979828, 229.223539352417, 230.9574637413025, 232.691388130188, 234.5121672153473, 236.3329463005066, 238.37320852279663, 240.41347074508667, 242.2936315536499, 244.17379236221313, 245.81451392173767, 247.4552354812622, 249.08149480819702, 250.70775413513184, 252.3106071949005, 253.9134602546692, 255.54772639274597, 257.18199253082275, 258.96650099754333, 260.7510094642639, 262.4434974193573, 264.1359853744507, 265.8948736190796, 267.6537618637085, 269.5701446533203, 271.48652744293213, 273.2966499328613, 275.1067724227905, 276.69304513931274, 278.27931785583496, 279.91349053382874, 281.5476632118225, 283.21052742004395, 284.8733916282654, 286.49224400520325, 288.1110963821411, 289.6981077194214, 291.28511905670166, 292.99678659439087, 294.7084541320801, 296.43365716934204, 298.158860206604, 300.0476632118225, 301.936466217041, 303.701744556427, 305.467022895813, 307.2565293312073, 309.04603576660156, 310.54490184783936, 312.04376792907715, 313.71355295181274, 315.38333797454834, 317.0609700679779, 318.73860216140747, 320.5334165096283, 322.3282308578491, 324.15264320373535, 325.9770555496216, 327.6748716831207, 329.3726878166199, 331.09936594963074, 332.8260440826416, 334.52733993530273, 336.22863578796387, 337.9062514305115, 339.5838670730591, 341.17637610435486, 342.76888513565063, 344.46082520484924, 346.15276527404785, 349.69418573379517, 353.2356061935425]
[16.3, 16.3, 32.02, 32.02, 38.1, 38.1, 47.24, 47.24, 49.78, 49.78, 49.34, 49.34, 51.6, 51.6, 50.88, 50.88, 52.76, 52.76, 54.98, 54.98, 57.46, 57.46, 54.38, 54.38, 58.54, 58.54, 61.0, 61.0, 63.36, 63.36, 63.74, 63.74, 62.3, 62.3, 64.66, 64.66, 64.48, 64.48, 64.6, 64.6, 64.62, 64.62, 63.46, 63.46, 65.02, 65.02, 64.5, 64.5, 64.1, 64.1, 66.0, 66.0, 66.46, 66.46, 66.56, 66.56, 66.82, 66.82, 66.92, 66.92, 66.6, 66.6, 67.6, 67.6, 66.76, 66.76, 66.32, 66.32, 67.0, 67.0, 68.28, 68.28, 67.56, 67.56, 69.06, 69.06, 67.72, 67.72, 67.66, 67.66, 67.34, 67.34, 67.12, 67.12, 68.2, 68.2, 68.2, 68.2, 67.78, 67.78, 67.14, 67.14, 67.12, 67.12, 66.8, 66.8, 65.14, 65.14, 63.86, 63.86, 63.82, 63.82, 64.5, 64.5, 64.02, 64.02, 63.28, 63.28, 64.6, 64.6, 65.02, 65.02, 66.0, 66.0, 66.0, 66.0, 67.18, 67.18, 66.98, 66.98, 66.6, 66.6, 65.86, 65.86, 65.8, 65.8, 66.0, 66.0, 65.5, 65.5, 65.22, 65.22, 64.16, 64.16, 64.74, 64.74, 65.36, 65.36, 65.34, 65.34, 64.68, 64.68, 64.32, 64.32, 64.84, 64.84, 64.32, 64.32, 64.34, 64.34, 64.5, 64.5, 64.64, 64.64, 65.48, 65.48, 65.08, 65.08, 65.48, 65.48, 65.32, 65.32, 65.42, 65.42, 64.48, 64.48, 64.4, 64.4, 64.16, 64.16, 64.48, 64.48, 63.88, 63.88, 64.22, 64.22, 64.66, 64.66, 64.4, 64.4, 64.44, 64.44, 63.62, 63.62, 63.92, 63.92, 64.28, 64.28, 64.3, 64.3, 64.36, 64.36, 63.92, 63.92, 64.38, 64.38, 64.48, 64.48, 64.58, 64.58, 64.12, 64.12]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.786, Test loss: 2.070, Test accuracy: 19.44
Round   0, Global train loss: 1.786, Global test loss: 2.256, Global test accuracy: 14.60
Round   1, Train loss: 1.647, Test loss: 1.787, Test accuracy: 33.08
Round   1, Global train loss: 1.647, Global test loss: 2.142, Global test accuracy: 21.50
Round   2, Train loss: 1.588, Test loss: 1.549, Test accuracy: 41.84
Round   2, Global train loss: 1.588, Global test loss: 2.138, Global test accuracy: 27.76
Round   3, Train loss: 1.445, Test loss: 1.431, Test accuracy: 46.46
Round   3, Global train loss: 1.445, Global test loss: 1.864, Global test accuracy: 33.50
Round   4, Train loss: 1.383, Test loss: 1.420, Test accuracy: 46.70
Round   4, Global train loss: 1.383, Global test loss: 1.989, Global test accuracy: 25.12
Round   5, Train loss: 1.261, Test loss: 1.387, Test accuracy: 50.16
Round   5, Global train loss: 1.261, Global test loss: 1.782, Global test accuracy: 38.56
Round   6, Train loss: 1.324, Test loss: 1.339, Test accuracy: 52.08
Round   6, Global train loss: 1.324, Global test loss: 1.757, Global test accuracy: 39.80
Round   7, Train loss: 1.362, Test loss: 1.335, Test accuracy: 53.42
Round   7, Global train loss: 1.362, Global test loss: 1.755, Global test accuracy: 40.16
Round   8, Train loss: 1.275, Test loss: 1.359, Test accuracy: 53.26
Round   8, Global train loss: 1.275, Global test loss: 1.839, Global test accuracy: 36.80
Round   9, Train loss: 1.372, Test loss: 1.288, Test accuracy: 55.46
Round   9, Global train loss: 1.372, Global test loss: 1.756, Global test accuracy: 39.18
Round  10, Train loss: 1.191, Test loss: 1.173, Test accuracy: 60.12
Round  10, Global train loss: 1.191, Global test loss: 1.559, Global test accuracy: 47.30
Round  11, Train loss: 1.019, Test loss: 1.243, Test accuracy: 57.76
Round  11, Global train loss: 1.019, Global test loss: 1.708, Global test accuracy: 45.74
Round  12, Train loss: 1.419, Test loss: 1.157, Test accuracy: 58.74
Round  12, Global train loss: 1.419, Global test loss: 1.744, Global test accuracy: 43.56
Round  13, Train loss: 1.294, Test loss: 1.157, Test accuracy: 57.82
Round  13, Global train loss: 1.294, Global test loss: 1.781, Global test accuracy: 42.26
Round  14, Train loss: 1.440, Test loss: 1.100, Test accuracy: 59.48
Round  14, Global train loss: 1.440, Global test loss: 1.972, Global test accuracy: 36.52
Round  15, Train loss: 1.182, Test loss: 1.095, Test accuracy: 59.10
Round  15, Global train loss: 1.182, Global test loss: 1.676, Global test accuracy: 46.54
Round  16, Train loss: 1.139, Test loss: 1.106, Test accuracy: 59.30
Round  16, Global train loss: 1.139, Global test loss: 1.652, Global test accuracy: 52.58
Round  17, Train loss: 0.856, Test loss: 1.073, Test accuracy: 61.12
Round  17, Global train loss: 0.856, Global test loss: 1.495, Global test accuracy: 47.10
Round  18, Train loss: 1.144, Test loss: 1.054, Test accuracy: 62.56
Round  18, Global train loss: 1.144, Global test loss: 1.376, Global test accuracy: 59.22
Round  19, Train loss: 0.972, Test loss: 1.035, Test accuracy: 63.28
Round  19, Global train loss: 0.972, Global test loss: 1.481, Global test accuracy: 52.50
Round  20, Train loss: 1.057, Test loss: 1.049, Test accuracy: 64.74
Round  20, Global train loss: 1.057, Global test loss: 1.625, Global test accuracy: 50.64
Round  21, Train loss: 1.051, Test loss: 1.035, Test accuracy: 65.54
Round  21, Global train loss: 1.051, Global test loss: 1.562, Global test accuracy: 49.80
Round  22, Train loss: 0.789, Test loss: 1.034, Test accuracy: 65.56
Round  22, Global train loss: 0.789, Global test loss: 1.289, Global test accuracy: 58.06
Round  23, Train loss: 0.842, Test loss: 1.028, Test accuracy: 66.12
Round  23, Global train loss: 0.842, Global test loss: 1.478, Global test accuracy: 49.60
Round  24, Train loss: 0.905, Test loss: 1.019, Test accuracy: 66.00
Round  24, Global train loss: 0.905, Global test loss: 1.447, Global test accuracy: 54.16
Round  25, Train loss: 0.997, Test loss: 1.027, Test accuracy: 66.42
Round  25, Global train loss: 0.997, Global test loss: 1.685, Global test accuracy: 44.16
Round  26, Train loss: 1.151, Test loss: 1.045, Test accuracy: 65.46
Round  26, Global train loss: 1.151, Global test loss: 1.507, Global test accuracy: 52.26
Round  27, Train loss: 0.750, Test loss: 1.020, Test accuracy: 66.18
Round  27, Global train loss: 0.750, Global test loss: 1.353, Global test accuracy: 59.06
Round  28, Train loss: 1.090, Test loss: 1.044, Test accuracy: 66.00
Round  28, Global train loss: 1.090, Global test loss: 1.506, Global test accuracy: 51.70
Round  29, Train loss: 1.107, Test loss: 1.039, Test accuracy: 64.76
Round  29, Global train loss: 1.107, Global test loss: 1.671, Global test accuracy: 45.62
Round  30, Train loss: 0.770, Test loss: 1.011, Test accuracy: 65.04
Round  30, Global train loss: 0.770, Global test loss: 1.303, Global test accuracy: 57.90
Round  31, Train loss: 0.729, Test loss: 1.041, Test accuracy: 64.96
Round  31, Global train loss: 0.729, Global test loss: 1.279, Global test accuracy: 58.02
Round  32, Train loss: 0.995, Test loss: 1.037, Test accuracy: 64.06
Round  32, Global train loss: 0.995, Global test loss: 1.591, Global test accuracy: 51.76
Round  33, Train loss: 1.013, Test loss: 1.051, Test accuracy: 63.24
Round  33, Global train loss: 1.013, Global test loss: 1.597, Global test accuracy: 48.48
Round  34, Train loss: 1.031, Test loss: 1.041, Test accuracy: 64.70
Round  34, Global train loss: 1.031, Global test loss: 1.633, Global test accuracy: 50.94
Round  35, Train loss: 0.901, Test loss: 1.039, Test accuracy: 64.82
Round  35, Global train loss: 0.901, Global test loss: 1.742, Global test accuracy: 50.38
Round  36, Train loss: 0.697, Test loss: 1.038, Test accuracy: 65.32
Round  36, Global train loss: 0.697, Global test loss: 1.354, Global test accuracy: 57.34
Round  37, Train loss: 0.873, Test loss: 1.093, Test accuracy: 63.90
Round  37, Global train loss: 0.873, Global test loss: 1.387, Global test accuracy: 58.40
Round  38, Train loss: 0.633, Test loss: 1.088, Test accuracy: 63.92
Round  38, Global train loss: 0.633, Global test loss: 1.428, Global test accuracy: 59.76
Round  39, Train loss: 0.886, Test loss: 1.099, Test accuracy: 62.92
Round  39, Global train loss: 0.886, Global test loss: 1.531, Global test accuracy: 54.18
Round  40, Train loss: 0.889, Test loss: 1.097, Test accuracy: 63.08
Round  40, Global train loss: 0.889, Global test loss: 1.355, Global test accuracy: 55.38
Round  41, Train loss: 0.883, Test loss: 1.108, Test accuracy: 63.34
Round  41, Global train loss: 0.883, Global test loss: 1.342, Global test accuracy: 58.70
Round  42, Train loss: 0.647, Test loss: 1.116, Test accuracy: 63.54
Round  42, Global train loss: 0.647, Global test loss: 1.298, Global test accuracy: 59.04
Round  43, Train loss: 0.596, Test loss: 1.129, Test accuracy: 63.30
Round  43, Global train loss: 0.596, Global test loss: 1.315, Global test accuracy: 58.32
Round  44, Train loss: 1.131, Test loss: 1.123, Test accuracy: 63.98
Round  44, Global train loss: 1.131, Global test loss: 1.617, Global test accuracy: 48.06
Round  45, Train loss: 0.761, Test loss: 1.125, Test accuracy: 64.04
Round  45, Global train loss: 0.761, Global test loss: 1.465, Global test accuracy: 53.30
Round  46, Train loss: 0.569, Test loss: 1.096, Test accuracy: 64.38
Round  46, Global train loss: 0.569, Global test loss: 1.359, Global test accuracy: 59.60
Round  47, Train loss: 0.830, Test loss: 1.066, Test accuracy: 65.26
Round  47, Global train loss: 0.830, Global test loss: 1.593, Global test accuracy: 48.52
Round  48, Train loss: 0.455, Test loss: 1.096, Test accuracy: 64.98
Round  48, Global train loss: 0.455, Global test loss: 1.666, Global test accuracy: 52.28
Round  49, Train loss: 0.484, Test loss: 1.163, Test accuracy: 63.18
Round  49, Global train loss: 0.484, Global test loss: 1.526, Global test accuracy: 57.32
Round  50, Train loss: 0.400, Test loss: 1.112, Test accuracy: 64.84
Round  50, Global train loss: 0.400, Global test loss: 1.561, Global test accuracy: 58.54
Round  51, Train loss: 0.677, Test loss: 1.078, Test accuracy: 66.06
Round  51, Global train loss: 0.677, Global test loss: 1.429, Global test accuracy: 56.80
Round  52, Train loss: 0.434, Test loss: 1.099, Test accuracy: 66.00
Round  52, Global train loss: 0.434, Global test loss: 1.366, Global test accuracy: 59.64
Round  53, Train loss: 0.448, Test loss: 1.103, Test accuracy: 65.94
Round  53, Global train loss: 0.448, Global test loss: 1.152, Global test accuracy: 64.00
Round  54, Train loss: 1.006, Test loss: 1.132, Test accuracy: 65.38
Round  54, Global train loss: 1.006, Global test loss: 1.774, Global test accuracy: 43.20
Round  55, Train loss: 0.869, Test loss: 1.149, Test accuracy: 65.30
Round  55, Global train loss: 0.869, Global test loss: 1.740, Global test accuracy: 45.16
Round  56, Train loss: 0.571, Test loss: 1.174, Test accuracy: 65.44
Round  56, Global train loss: 0.571, Global test loss: 1.381, Global test accuracy: 58.00
Round  57, Train loss: 0.626, Test loss: 1.168, Test accuracy: 65.50
Round  57, Global train loss: 0.626, Global test loss: 1.637, Global test accuracy: 49.78
Round  58, Train loss: 0.454, Test loss: 1.230, Test accuracy: 64.28
Round  58, Global train loss: 0.454, Global test loss: 1.950, Global test accuracy: 46.72
Round  59, Train loss: 0.393, Test loss: 1.222, Test accuracy: 64.08
Round  59, Global train loss: 0.393, Global test loss: 1.323, Global test accuracy: 60.02
Round  60, Train loss: 0.448, Test loss: 1.193, Test accuracy: 64.48
Round  60, Global train loss: 0.448, Global test loss: 1.267, Global test accuracy: 62.46
Round  61, Train loss: 0.565, Test loss: 1.236, Test accuracy: 63.82
Round  61, Global train loss: 0.565, Global test loss: 1.482, Global test accuracy: 54.90
Round  62, Train loss: 0.627, Test loss: 1.278, Test accuracy: 63.36
Round  62, Global train loss: 0.627, Global test loss: 1.778, Global test accuracy: 49.92
Round  63, Train loss: 0.720, Test loss: 1.276, Test accuracy: 63.30
Round  63, Global train loss: 0.720, Global test loss: 1.888, Global test accuracy: 44.94
Round  64, Train loss: 0.366, Test loss: 1.330, Test accuracy: 62.86
Round  64, Global train loss: 0.366, Global test loss: 1.469, Global test accuracy: 57.44
Round  65, Train loss: 0.536, Test loss: 1.304, Test accuracy: 63.32
Round  65, Global train loss: 0.536, Global test loss: 1.688, Global test accuracy: 53.40
Round  66, Train loss: 0.343, Test loss: 1.311, Test accuracy: 63.42
Round  66, Global train loss: 0.343, Global test loss: 1.665, Global test accuracy: 54.18
Round  67, Train loss: 0.357, Test loss: 1.306, Test accuracy: 63.82
Round  67, Global train loss: 0.357, Global test loss: 1.538, Global test accuracy: 58.04
Round  68, Train loss: 0.479, Test loss: 1.303, Test accuracy: 63.76
Round  68, Global train loss: 0.479, Global test loss: 1.408, Global test accuracy: 60.10
Round  69, Train loss: 0.248, Test loss: 1.261, Test accuracy: 64.22
Round  69, Global train loss: 0.248, Global test loss: 1.413, Global test accuracy: 61.66
Round  70, Train loss: 0.436, Test loss: 1.241, Test accuracy: 64.06
Round  70, Global train loss: 0.436, Global test loss: 1.512, Global test accuracy: 58.24
Round  71, Train loss: 0.399, Test loss: 1.252, Test accuracy: 63.86
Round  71, Global train loss: 0.399, Global test loss: 1.298, Global test accuracy: 60.42
Round  72, Train loss: 0.248, Test loss: 1.247, Test accuracy: 64.84
Round  72, Global train loss: 0.248, Global test loss: 1.538, Global test accuracy: 61.30
Round  73, Train loss: 0.353, Test loss: 1.279, Test accuracy: 64.20
Round  73, Global train loss: 0.353, Global test loss: 1.747, Global test accuracy: 56.06
Round  74, Train loss: 0.282, Test loss: 1.329, Test accuracy: 63.74
Round  74, Global train loss: 0.282, Global test loss: 1.529, Global test accuracy: 62.50
Round  75, Train loss: 0.476, Test loss: 1.339, Test accuracy: 64.54
Round  75, Global train loss: 0.476, Global test loss: 1.463, Global test accuracy: 59.80
Round  76, Train loss: 0.242, Test loss: 1.343, Test accuracy: 64.52
Round  76, Global train loss: 0.242, Global test loss: 1.247, Global test accuracy: 65.58
Round  77, Train loss: 0.453, Test loss: 1.354, Test accuracy: 63.98
Round  77, Global train loss: 0.453, Global test loss: 1.631, Global test accuracy: 56.34
Round  78, Train loss: 0.371, Test loss: 1.375, Test accuracy: 63.88
Round  78, Global train loss: 0.371, Global test loss: 1.596, Global test accuracy: 56.16
Round  79, Train loss: 0.292, Test loss: 1.424, Test accuracy: 63.34
Round  79, Global train loss: 0.292, Global test loss: 1.444, Global test accuracy: 60.74
Round  80, Train loss: 0.416, Test loss: 1.437, Test accuracy: 63.64
Round  80, Global train loss: 0.416, Global test loss: 1.666, Global test accuracy: 56.10
Round  81, Train loss: 0.385, Test loss: 1.447, Test accuracy: 64.42
Round  81, Global train loss: 0.385, Global test loss: 1.621, Global test accuracy: 56.56
Round  82, Train loss: 0.328, Test loss: 1.421, Test accuracy: 63.72
Round  82, Global train loss: 0.328, Global test loss: 1.552, Global test accuracy: 57.08
Round  83, Train loss: 0.415, Test loss: 1.393, Test accuracy: 64.64
Round  83, Global train loss: 0.415, Global test loss: 1.860, Global test accuracy: 52.52
Round  84, Train loss: 0.437, Test loss: 1.447, Test accuracy: 64.12
Round  84, Global train loss: 0.437, Global test loss: 1.920, Global test accuracy: 49.52
Round  85, Train loss: 0.321, Test loss: 1.531, Test accuracy: 63.56
Round  85, Global train loss: 0.321, Global test loss: 1.516, Global test accuracy: 60.98
Round  86, Train loss: 0.426, Test loss: 1.592, Test accuracy: 63.36
Round  86, Global train loss: 0.426, Global test loss: 1.926, Global test accuracy: 50.06
Round  87, Train loss: 0.226, Test loss: 1.597, Test accuracy: 63.22
Round  87, Global train loss: 0.226, Global test loss: 1.772, Global test accuracy: 56.60
Round  88, Train loss: 0.222, Test loss: 1.573, Test accuracy: 63.22
Round  88, Global train loss: 0.222, Global test loss: 1.600, Global test accuracy: 59.72
Round  89, Train loss: 0.408, Test loss: 1.487, Test accuracy: 64.72
Round  89, Global train loss: 0.408, Global test loss: 1.817, Global test accuracy: 53.92
Round  90, Train loss: 0.227, Test loss: 1.480, Test accuracy: 65.30
Round  90, Global train loss: 0.227, Global test loss: 1.617, Global test accuracy: 59.94
Round  91, Train loss: 0.185, Test loss: 1.512, Test accuracy: 64.60
Round  91, Global train loss: 0.185, Global test loss: 1.685, Global test accuracy: 60.70
Round  92, Train loss: 0.314, Test loss: 1.457, Test accuracy: 64.98
Round  92, Global train loss: 0.314, Global test loss: 1.727, Global test accuracy: 56.62
Round  93, Train loss: 0.232, Test loss: 1.417, Test accuracy: 64.80
Round  93, Global train loss: 0.232, Global test loss: 1.666, Global test accuracy: 56.88
Round  94, Train loss: 0.316, Test loss: 1.443, Test accuracy: 64.80
Round  94, Global train loss: 0.316, Global test loss: 1.540, Global test accuracy: 59.18
Round  95, Train loss: 0.190, Test loss: 1.485, Test accuracy: 64.28
Round  95, Global train loss: 0.190, Global test loss: 1.418, Global test accuracy: 65.28
Round  96, Train loss: 0.160, Test loss: 1.474, Test accuracy: 64.06
Round  96, Global train loss: 0.160, Global test loss: 1.428, Global test accuracy: 64.42
Round  97, Train loss: 0.216, Test loss: 1.467, Test accuracy: 64.50
Round  97, Global train loss: 0.216, Global test loss: 1.520, Global test accuracy: 61.62
Round  98, Train loss: 0.302, Test loss: 1.503, Test accuracy: 64.58
Round  98, Global train loss: 0.302, Global test loss: 1.651, Global test accuracy: 58.42
Round  99, Train loss: 0.201, Test loss: 1.521, Test accuracy: 64.24
Round  99, Global train loss: 0.201, Global test loss: 1.639, Global test accuracy: 59.72
Final Round, Train loss: 0.220, Test loss: 1.675, Test accuracy: 64.74
Final Round, Global train loss: 0.220, Global test loss: 1.639, Global test accuracy: 59.72
Average accuracy final 10 rounds: 64.614
Average global accuracy final 10 rounds: 60.278
1530.8920669555664
[4.19720983505249, 8.157828092575073, 11.748620510101318, 15.537814617156982, 19.280046701431274, 23.17265009880066, 27.031420946121216, 30.690375566482544, 34.40214419364929, 38.27894186973572, 42.18941807746887, 46.13082528114319, 49.91170597076416, 53.71740770339966, 57.43270754814148, 61.123417139053345, 64.99001145362854, 68.95693302154541, 72.71711564064026, 76.5995283126831, 80.25018906593323, 84.04318380355835, 87.91922926902771, 91.54017853736877, 95.23319506645203, 99.07156133651733, 103.01624202728271, 107.15208530426025, 110.87961196899414, 114.86951327323914, 118.65760898590088, 122.65952849388123, 126.33637070655823, 130.13858938217163, 133.95398497581482, 138.13693404197693, 141.78173208236694, 145.48621201515198, 149.0495789051056, 152.80026245117188, 156.69435238838196, 160.62901401519775, 164.40011835098267, 168.39515900611877, 172.49150204658508, 176.345636844635, 180.18770909309387, 183.95355939865112, 187.7557361125946, 191.47463035583496, 195.32717728614807, 199.0599503517151, 202.8692078590393, 206.94946384429932, 210.8669683933258, 214.71112275123596, 218.57104325294495, 222.59221959114075, 226.63738989830017, 230.87764430046082, 234.85614442825317, 239.1632513999939, 242.89860129356384, 246.69990038871765, 250.6007091999054, 254.3781681060791, 258.25768852233887, 261.85093426704407, 266.0000157356262, 269.8973319530487, 274.1351947784424, 278.0654170513153, 281.7029893398285, 285.4486668109894, 289.1186878681183, 292.9353165626526, 296.8343288898468, 300.71673130989075, 304.4827787876129, 308.48380851745605, 312.50753808021545, 316.2095396518707, 319.9321346282959, 323.57378482818604, 327.29512333869934, 331.03884530067444, 334.8431866168976, 338.6119258403778, 342.30987095832825, 346.1831078529358, 350.0243184566498, 353.770179271698, 357.6820979118347, 361.55801820755005, 365.56077814102173, 369.18599796295166, 372.8749167919159, 376.62708735466003, 380.4764714241028, 384.21701836586, 391.04574251174927]
[19.44, 33.08, 41.84, 46.46, 46.7, 50.16, 52.08, 53.42, 53.26, 55.46, 60.12, 57.76, 58.74, 57.82, 59.48, 59.1, 59.3, 61.12, 62.56, 63.28, 64.74, 65.54, 65.56, 66.12, 66.0, 66.42, 65.46, 66.18, 66.0, 64.76, 65.04, 64.96, 64.06, 63.24, 64.7, 64.82, 65.32, 63.9, 63.92, 62.92, 63.08, 63.34, 63.54, 63.3, 63.98, 64.04, 64.38, 65.26, 64.98, 63.18, 64.84, 66.06, 66.0, 65.94, 65.38, 65.3, 65.44, 65.5, 64.28, 64.08, 64.48, 63.82, 63.36, 63.3, 62.86, 63.32, 63.42, 63.82, 63.76, 64.22, 64.06, 63.86, 64.84, 64.2, 63.74, 64.54, 64.52, 63.98, 63.88, 63.34, 63.64, 64.42, 63.72, 64.64, 64.12, 63.56, 63.36, 63.22, 63.22, 64.72, 65.3, 64.6, 64.98, 64.8, 64.8, 64.28, 64.06, 64.5, 64.58, 64.24, 64.74]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.063, Test loss: 2.230, Test accuracy: 10.48
Round   0, Global train loss: 2.063, Global test loss: 2.289, Global test accuracy: 10.00
Round   1, Train loss: 1.802, Test loss: 2.139, Test accuracy: 20.84
Round   1, Global train loss: 1.802, Global test loss: 2.432, Global test accuracy: 10.10
Round   2, Train loss: 1.698, Test loss: 1.752, Test accuracy: 37.40
Round   2, Global train loss: 1.698, Global test loss: 2.345, Global test accuracy: 20.90
Round   3, Train loss: 1.695, Test loss: 1.692, Test accuracy: 40.48
Round   3, Global train loss: 1.695, Global test loss: 2.181, Global test accuracy: 25.80
Round   4, Train loss: 1.694, Test loss: 1.786, Test accuracy: 36.92
Round   4, Global train loss: 1.694, Global test loss: 2.444, Global test accuracy: 13.40
Round   5, Train loss: 1.561, Test loss: 1.694, Test accuracy: 38.22
Round   5, Global train loss: 1.561, Global test loss: 2.215, Global test accuracy: 21.82
Round   6, Train loss: 1.590, Test loss: 1.612, Test accuracy: 41.26
Round   6, Global train loss: 1.590, Global test loss: 2.038, Global test accuracy: 28.54
Round   7, Train loss: 1.519, Test loss: 1.528, Test accuracy: 42.76
Round   7, Global train loss: 1.519, Global test loss: 2.005, Global test accuracy: 25.46
Round   8, Train loss: 1.503, Test loss: 1.701, Test accuracy: 41.58
Round   8, Global train loss: 1.503, Global test loss: 2.504, Global test accuracy: 14.36
Round   9, Train loss: 1.572, Test loss: 1.597, Test accuracy: 43.44
Round   9, Global train loss: 1.572, Global test loss: 2.262, Global test accuracy: 21.20
Round  10, Train loss: 1.429, Test loss: 1.445, Test accuracy: 49.44
Round  10, Global train loss: 1.429, Global test loss: 1.980, Global test accuracy: 31.86
Round  11, Train loss: 1.462, Test loss: 1.638, Test accuracy: 42.68
Round  11, Global train loss: 1.462, Global test loss: 2.472, Global test accuracy: 22.34
Round  12, Train loss: 1.477, Test loss: 1.343, Test accuracy: 51.02
Round  12, Global train loss: 1.477, Global test loss: 1.892, Global test accuracy: 37.80
Round  13, Train loss: 1.437, Test loss: 1.362, Test accuracy: 52.94
Round  13, Global train loss: 1.437, Global test loss: 2.042, Global test accuracy: 38.38
Round  14, Train loss: 1.259, Test loss: 1.248, Test accuracy: 56.36
Round  14, Global train loss: 1.259, Global test loss: 2.019, Global test accuracy: 31.02
Round  15, Train loss: 1.350, Test loss: 1.207, Test accuracy: 57.06
Round  15, Global train loss: 1.350, Global test loss: 1.958, Global test accuracy: 37.02
Round  16, Train loss: 1.290, Test loss: 1.179, Test accuracy: 59.48
Round  16, Global train loss: 1.290, Global test loss: 1.769, Global test accuracy: 45.64
Round  17, Train loss: 1.229, Test loss: 1.147, Test accuracy: 60.24
Round  17, Global train loss: 1.229, Global test loss: 1.848, Global test accuracy: 31.80
Round  18, Train loss: 1.441, Test loss: 1.144, Test accuracy: 60.20
Round  18, Global train loss: 1.441, Global test loss: 2.143, Global test accuracy: 37.12
Round  19, Train loss: 1.125, Test loss: 1.105, Test accuracy: 61.34
Round  19, Global train loss: 1.125, Global test loss: 1.933, Global test accuracy: 33.36
Round  20, Train loss: 1.213, Test loss: 1.125, Test accuracy: 63.52
Round  20, Global train loss: 1.213, Global test loss: 1.837, Global test accuracy: 42.22
Round  21, Train loss: 1.383, Test loss: 1.123, Test accuracy: 62.66
Round  21, Global train loss: 1.383, Global test loss: 2.058, Global test accuracy: 34.50
Round  22, Train loss: 1.290, Test loss: 1.094, Test accuracy: 63.52
Round  22, Global train loss: 1.290, Global test loss: 1.888, Global test accuracy: 35.22
Round  23, Train loss: 1.336, Test loss: 1.093, Test accuracy: 63.76
Round  23, Global train loss: 1.336, Global test loss: 1.985, Global test accuracy: 29.58
Round  24, Train loss: 1.234, Test loss: 1.072, Test accuracy: 64.92
Round  24, Global train loss: 1.234, Global test loss: 1.960, Global test accuracy: 39.84
Round  25, Train loss: 1.079, Test loss: 1.040, Test accuracy: 65.26
Round  25, Global train loss: 1.079, Global test loss: 1.962, Global test accuracy: 31.60
Round  26, Train loss: 1.276, Test loss: 1.057, Test accuracy: 65.90
Round  26, Global train loss: 1.276, Global test loss: 1.918, Global test accuracy: 35.30
Round  27, Train loss: 1.077, Test loss: 1.057, Test accuracy: 66.82
Round  27, Global train loss: 1.077, Global test loss: 1.616, Global test accuracy: 45.58
Round  28, Train loss: 1.246, Test loss: 1.077, Test accuracy: 64.80
Round  28, Global train loss: 1.246, Global test loss: 1.960, Global test accuracy: 35.80
Round  29, Train loss: 0.921, Test loss: 1.017, Test accuracy: 67.44
Round  29, Global train loss: 0.921, Global test loss: 1.821, Global test accuracy: 43.94
Round  30, Train loss: 1.084, Test loss: 1.007, Test accuracy: 67.94
Round  30, Global train loss: 1.084, Global test loss: 1.673, Global test accuracy: 44.02
Round  31, Train loss: 0.971, Test loss: 1.012, Test accuracy: 67.58
Round  31, Global train loss: 0.971, Global test loss: 1.582, Global test accuracy: 40.06
Round  32, Train loss: 1.025, Test loss: 1.018, Test accuracy: 67.04
Round  32, Global train loss: 1.025, Global test loss: 1.933, Global test accuracy: 37.18
Round  33, Train loss: 0.826, Test loss: 0.966, Test accuracy: 69.06
Round  33, Global train loss: 0.826, Global test loss: 1.849, Global test accuracy: 45.82
Round  34, Train loss: 1.190, Test loss: 0.978, Test accuracy: 68.16
Round  34, Global train loss: 1.190, Global test loss: 2.319, Global test accuracy: 35.92
Round  35, Train loss: 0.996, Test loss: 0.984, Test accuracy: 67.98
Round  35, Global train loss: 0.996, Global test loss: 2.476, Global test accuracy: 29.90
Round  36, Train loss: 0.868, Test loss: 0.969, Test accuracy: 67.90
Round  36, Global train loss: 0.868, Global test loss: 1.883, Global test accuracy: 39.24
Round  37, Train loss: 1.002, Test loss: 0.966, Test accuracy: 68.94
Round  37, Global train loss: 1.002, Global test loss: 1.588, Global test accuracy: 48.62
Round  38, Train loss: 0.884, Test loss: 0.934, Test accuracy: 68.98
Round  38, Global train loss: 0.884, Global test loss: 1.970, Global test accuracy: 40.26
Round  39, Train loss: 0.950, Test loss: 0.936, Test accuracy: 69.56
Round  39, Global train loss: 0.950, Global test loss: 1.912, Global test accuracy: 38.90
Round  40, Train loss: 1.138, Test loss: 1.000, Test accuracy: 66.36
Round  40, Global train loss: 1.138, Global test loss: 1.925, Global test accuracy: 37.28
Round  41, Train loss: 0.871, Test loss: 0.936, Test accuracy: 70.52
Round  41, Global train loss: 0.871, Global test loss: 1.462, Global test accuracy: 51.30
Round  42, Train loss: 0.826, Test loss: 0.934, Test accuracy: 70.18
Round  42, Global train loss: 0.826, Global test loss: 1.525, Global test accuracy: 45.20
Round  43, Train loss: 1.127, Test loss: 0.922, Test accuracy: 70.90
Round  43, Global train loss: 1.127, Global test loss: 1.742, Global test accuracy: 39.26
Round  44, Train loss: 1.140, Test loss: 0.956, Test accuracy: 70.12
Round  44, Global train loss: 1.140, Global test loss: 1.894, Global test accuracy: 37.08
Round  45, Train loss: 1.119, Test loss: 0.912, Test accuracy: 71.12
Round  45, Global train loss: 1.119, Global test loss: 2.124, Global test accuracy: 39.26
Round  46, Train loss: 0.904, Test loss: 0.913, Test accuracy: 70.80
Round  46, Global train loss: 0.904, Global test loss: 1.676, Global test accuracy: 45.32
Round  47, Train loss: 0.799, Test loss: 0.923, Test accuracy: 70.40
Round  47, Global train loss: 0.799, Global test loss: 1.650, Global test accuracy: 51.60
Round  48, Train loss: 1.241, Test loss: 0.913, Test accuracy: 70.40
Round  48, Global train loss: 1.241, Global test loss: 2.343, Global test accuracy: 25.30
Round  49, Train loss: 0.856, Test loss: 0.918, Test accuracy: 70.44
Round  49, Global train loss: 0.856, Global test loss: 1.656, Global test accuracy: 47.02
Round  50, Train loss: 0.800, Test loss: 0.929, Test accuracy: 69.50
Round  50, Global train loss: 0.800, Global test loss: 1.704, Global test accuracy: 46.78
Round  51, Train loss: 1.363, Test loss: 0.944, Test accuracy: 67.94
Round  51, Global train loss: 1.363, Global test loss: 2.618, Global test accuracy: 20.80
Round  52, Train loss: 0.873, Test loss: 0.916, Test accuracy: 69.78
Round  52, Global train loss: 0.873, Global test loss: 1.540, Global test accuracy: 48.66
Round  53, Train loss: 0.922, Test loss: 0.909, Test accuracy: 70.26
Round  53, Global train loss: 0.922, Global test loss: 1.550, Global test accuracy: 49.12
Round  54, Train loss: 0.888, Test loss: 0.923, Test accuracy: 69.30
Round  54, Global train loss: 0.888, Global test loss: 1.830, Global test accuracy: 41.96
Round  55, Train loss: 0.865, Test loss: 0.925, Test accuracy: 68.92
Round  55, Global train loss: 0.865, Global test loss: 1.940, Global test accuracy: 39.96
Round  56, Train loss: 0.871, Test loss: 0.906, Test accuracy: 70.16
Round  56, Global train loss: 0.871, Global test loss: 1.445, Global test accuracy: 54.54
Round  57, Train loss: 0.758, Test loss: 0.898, Test accuracy: 70.38
Round  57, Global train loss: 0.758, Global test loss: 1.508, Global test accuracy: 53.40
Round  58, Train loss: 0.689, Test loss: 0.891, Test accuracy: 70.12
Round  58, Global train loss: 0.689, Global test loss: 2.008, Global test accuracy: 37.76
Round  59, Train loss: 0.843, Test loss: 0.879, Test accuracy: 70.30
Round  59, Global train loss: 0.843, Global test loss: 1.725, Global test accuracy: 35.24
Round  60, Train loss: 0.869, Test loss: 0.888, Test accuracy: 69.98
Round  60, Global train loss: 0.869, Global test loss: 1.563, Global test accuracy: 43.96
Round  61, Train loss: 0.840, Test loss: 0.905, Test accuracy: 69.48
Round  61, Global train loss: 0.840, Global test loss: 1.812, Global test accuracy: 42.60
Round  62, Train loss: 0.794, Test loss: 0.877, Test accuracy: 71.00
Round  62, Global train loss: 0.794, Global test loss: 2.395, Global test accuracy: 28.72
Round  63, Train loss: 0.917, Test loss: 0.912, Test accuracy: 69.06
Round  63, Global train loss: 0.917, Global test loss: 1.889, Global test accuracy: 44.50
Round  64, Train loss: 0.829, Test loss: 0.881, Test accuracy: 70.02
Round  64, Global train loss: 0.829, Global test loss: 1.956, Global test accuracy: 43.82
Round  65, Train loss: 0.884, Test loss: 0.901, Test accuracy: 69.14
Round  65, Global train loss: 0.884, Global test loss: 2.490, Global test accuracy: 36.26
Round  66, Train loss: 0.786, Test loss: 0.894, Test accuracy: 69.52
Round  66, Global train loss: 0.786, Global test loss: 1.619, Global test accuracy: 42.48
Round  67, Train loss: 0.810, Test loss: 0.902, Test accuracy: 69.50
Round  67, Global train loss: 0.810, Global test loss: 2.401, Global test accuracy: 29.98
Round  68, Train loss: 0.964, Test loss: 0.920, Test accuracy: 68.82
Round  68, Global train loss: 0.964, Global test loss: 1.849, Global test accuracy: 33.68
Round  69, Train loss: 0.879, Test loss: 0.937, Test accuracy: 67.92
Round  69, Global train loss: 0.879, Global test loss: 1.965, Global test accuracy: 36.20
Round  70, Train loss: 0.975, Test loss: 0.965, Test accuracy: 66.06
Round  70, Global train loss: 0.975, Global test loss: 2.048, Global test accuracy: 30.84
Round  71, Train loss: 0.655, Test loss: 0.900, Test accuracy: 69.16
Round  71, Global train loss: 0.655, Global test loss: 1.544, Global test accuracy: 43.28
Round  72, Train loss: 0.861, Test loss: 0.923, Test accuracy: 68.58
Round  72, Global train loss: 0.861, Global test loss: 1.924, Global test accuracy: 30.68
Round  73, Train loss: 0.440, Test loss: 0.885, Test accuracy: 69.62
Round  73, Global train loss: 0.440, Global test loss: 2.454, Global test accuracy: 35.70
Round  74, Train loss: 0.719, Test loss: 0.896, Test accuracy: 68.88
Round  74, Global train loss: 0.719, Global test loss: 2.597, Global test accuracy: 27.80
Round  75, Train loss: 0.666, Test loss: 0.929, Test accuracy: 67.50
Round  75, Global train loss: 0.666, Global test loss: 2.082, Global test accuracy: 37.74
Round  76, Train loss: 0.686, Test loss: 0.906, Test accuracy: 68.94
Round  76, Global train loss: 0.686, Global test loss: 1.592, Global test accuracy: 38.84
Round  77, Train loss: 0.788, Test loss: 0.927, Test accuracy: 67.88
Round  77, Global train loss: 0.788, Global test loss: 2.382, Global test accuracy: 37.28
Round  78, Train loss: 1.020, Test loss: 0.971, Test accuracy: 65.80
Round  78, Global train loss: 1.020, Global test loss: 2.388, Global test accuracy: 21.44
Round  79, Train loss: 0.556, Test loss: 0.934, Test accuracy: 67.94
Round  79, Global train loss: 0.556, Global test loss: 1.590, Global test accuracy: 43.40
Round  80, Train loss: 0.831, Test loss: 0.938, Test accuracy: 67.80
Round  80, Global train loss: 0.831, Global test loss: 2.201, Global test accuracy: 35.68
Round  81, Train loss: 0.772, Test loss: 0.923, Test accuracy: 68.42
Round  81, Global train loss: 0.772, Global test loss: 1.963, Global test accuracy: 36.22
Round  82, Train loss: 0.854, Test loss: 0.951, Test accuracy: 66.16
Round  82, Global train loss: 0.854, Global test loss: 1.826, Global test accuracy: 39.94
Round  83, Train loss: 0.634, Test loss: 0.945, Test accuracy: 67.22
Round  83, Global train loss: 0.634, Global test loss: 2.022, Global test accuracy: 38.04
Round  84, Train loss: 0.414, Test loss: 0.929, Test accuracy: 68.38
Round  84, Global train loss: 0.414, Global test loss: 1.796, Global test accuracy: 48.60
Round  85, Train loss: 0.862, Test loss: 0.956, Test accuracy: 66.64
Round  85, Global train loss: 0.862, Global test loss: 2.104, Global test accuracy: 41.68
Round  86, Train loss: 0.400, Test loss: 0.907, Test accuracy: 68.32
Round  86, Global train loss: 0.400, Global test loss: 1.955, Global test accuracy: 37.76
Round  87, Train loss: 0.510, Test loss: 0.923, Test accuracy: 68.72
Round  87, Global train loss: 0.510, Global test loss: 1.791, Global test accuracy: 42.66
Round  88, Train loss: 0.470, Test loss: 0.936, Test accuracy: 67.98
Round  88, Global train loss: 0.470, Global test loss: 1.347, Global test accuracy: 57.42
Round  89, Train loss: 0.369, Test loss: 0.930, Test accuracy: 68.06
Round  89, Global train loss: 0.369, Global test loss: 1.923, Global test accuracy: 39.18
Round  90, Train loss: 0.792, Test loss: 0.968, Test accuracy: 66.68
Round  90, Global train loss: 0.792, Global test loss: 1.949, Global test accuracy: 37.46
Round  91, Train loss: 0.688, Test loss: 0.982, Test accuracy: 66.40
Round  91, Global train loss: 0.688, Global test loss: 1.936, Global test accuracy: 38.82
Round  92, Train loss: 0.640, Test loss: 0.988, Test accuracy: 67.30
Round  92, Global train loss: 0.640, Global test loss: 1.805, Global test accuracy: 46.32
Round  93, Train loss: 0.457, Test loss: 0.919, Test accuracy: 68.96
Round  93, Global train loss: 0.457, Global test loss: 2.026, Global test accuracy: 41.16
Round  94, Train loss: 0.596, Test loss: 0.943, Test accuracy: 68.60
Round  94, Global train loss: 0.596, Global test loss: 1.438, Global test accuracy: 53.06
Round  95, Train loss: 0.542, Test loss: 0.965, Test accuracy: 67.00
Round  95, Global train loss: 0.542, Global test loss: 1.735, Global test accuracy: 40.34
Round  96, Train loss: 0.508, Test loss: 0.986, Test accuracy: 66.16
Round  96, Global train loss: 0.508, Global test loss: 1.705, Global test accuracy: 39.74
Round  97, Train loss: 0.553, Test loss: 0.952, Test accuracy: 68.06
Round  97, Global train loss: 0.553, Global test loss: 1.599, Global test accuracy: 45.52
Round  98, Train loss: 0.714, Test loss: 0.979, Test accuracy: 67.14
Round  98, Global train loss: 0.714, Global test loss: 2.133, Global test accuracy: 37.60
Round  99, Train loss: 0.498, Test loss: 0.934, Test accuracy: 68.70
Round  99, Global train loss: 0.498, Global test loss: 1.537, Global test accuracy: 51.40
Final Round, Train loss: 0.468, Test loss: 0.976, Test accuracy: 67.76
Final Round, Global train loss: 0.468, Global test loss: 1.537, Global test accuracy: 51.40
Average accuracy final 10 rounds: 67.5
909.2189180850983
[2.060368061065674, 3.8195929527282715, 5.526655673980713, 7.373956203460693, 9.13155484199524, 10.935210466384888, 12.764641046524048, 14.585237264633179, 16.34478497505188, 18.126450777053833, 19.943288564682007, 21.7214777469635, 23.66562056541443, 25.801342964172363, 27.79279112815857, 29.690968990325928, 31.66769003868103, 33.52311968803406, 35.25268530845642, 37.44760298728943, 39.741857290267944, 41.51314163208008, 43.33461403846741, 45.29049205780029, 47.12961721420288, 49.00702214241028, 50.881609201431274, 52.65306305885315, 55.19322466850281, 57.074625730514526, 58.95546817779541, 60.84780550003052, 62.67237186431885, 64.52385568618774, 66.39509129524231, 68.22784209251404, 70.08481287956238, 72.21070671081543, 74.37131237983704, 76.26702284812927, 78.07487916946411, 79.94622254371643, 81.77466106414795, 83.58557367324829, 85.35894417762756, 87.16257405281067, 88.99405694007874, 90.79007029533386, 92.63248181343079, 94.47636389732361, 96.28333020210266, 98.13901495933533, 100.02937531471252, 101.84120154380798, 103.70612454414368, 105.5570752620697, 107.56680345535278, 109.4033408164978, 111.7761640548706, 113.8261992931366, 115.63375282287598, 117.58266496658325, 119.46892237663269, 121.20900702476501, 123.05452632904053, 124.91161012649536, 126.87494826316833, 128.7311816215515, 130.52028131484985, 132.27363872528076, 134.18188953399658, 135.87928128242493, 137.8489670753479, 139.80157375335693, 141.66628313064575, 143.57192754745483, 145.34765195846558, 147.2993938922882, 149.23396372795105, 151.06916332244873, 152.96925520896912, 154.90760731697083, 156.72107863426208, 158.5412290096283, 160.30926060676575, 162.201233625412, 164.07708764076233, 166.02123546600342, 167.9128019809723, 169.80152344703674, 171.55248403549194, 173.43953800201416, 175.26729488372803, 177.01009249687195, 178.8188338279724, 180.6458559036255, 182.48711943626404, 184.30643582344055, 186.11253237724304, 188.04662466049194, 190.95342540740967]
[10.48, 20.84, 37.4, 40.48, 36.92, 38.22, 41.26, 42.76, 41.58, 43.44, 49.44, 42.68, 51.02, 52.94, 56.36, 57.06, 59.48, 60.24, 60.2, 61.34, 63.52, 62.66, 63.52, 63.76, 64.92, 65.26, 65.9, 66.82, 64.8, 67.44, 67.94, 67.58, 67.04, 69.06, 68.16, 67.98, 67.9, 68.94, 68.98, 69.56, 66.36, 70.52, 70.18, 70.9, 70.12, 71.12, 70.8, 70.4, 70.4, 70.44, 69.5, 67.94, 69.78, 70.26, 69.3, 68.92, 70.16, 70.38, 70.12, 70.3, 69.98, 69.48, 71.0, 69.06, 70.02, 69.14, 69.52, 69.5, 68.82, 67.92, 66.06, 69.16, 68.58, 69.62, 68.88, 67.5, 68.94, 67.88, 65.8, 67.94, 67.8, 68.42, 66.16, 67.22, 68.38, 66.64, 68.32, 68.72, 67.98, 68.06, 66.68, 66.4, 67.3, 68.96, 68.6, 67.0, 66.16, 68.06, 67.14, 68.7, 67.76]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.025, Test loss: 1.983, Test accuracy: 34.28
Round   0, Global train loss: 2.025, Global test loss: 2.237, Global test accuracy: 23.18
Round   1, Train loss: 1.750, Test loss: 1.671, Test accuracy: 39.24
Round   1, Global train loss: 1.750, Global test loss: 2.145, Global test accuracy: 26.48
Round   2, Train loss: 1.640, Test loss: 1.534, Test accuracy: 44.62
Round   2, Global train loss: 1.640, Global test loss: 2.062, Global test accuracy: 29.20
Round   3, Train loss: 1.578, Test loss: 1.444, Test accuracy: 48.80
Round   3, Global train loss: 1.578, Global test loss: 2.010, Global test accuracy: 31.70
Round   4, Train loss: 1.530, Test loss: 1.383, Test accuracy: 50.68
Round   4, Global train loss: 1.530, Global test loss: 1.959, Global test accuracy: 33.38
Round   5, Train loss: 1.495, Test loss: 1.354, Test accuracy: 53.00
Round   5, Global train loss: 1.495, Global test loss: 1.937, Global test accuracy: 34.20
Round   6, Train loss: 1.458, Test loss: 1.324, Test accuracy: 54.14
Round   6, Global train loss: 1.458, Global test loss: 1.905, Global test accuracy: 37.30
Round   7, Train loss: 1.429, Test loss: 1.283, Test accuracy: 55.46
Round   7, Global train loss: 1.429, Global test loss: 1.874, Global test accuracy: 37.92
Round   8, Train loss: 1.394, Test loss: 1.242, Test accuracy: 57.98
Round   8, Global train loss: 1.394, Global test loss: 1.837, Global test accuracy: 40.36
Round   9, Train loss: 1.364, Test loss: 1.211, Test accuracy: 59.02
Round   9, Global train loss: 1.364, Global test loss: 1.807, Global test accuracy: 42.12
Round  10, Train loss: 1.278, Test loss: 1.173, Test accuracy: 61.48
Round  10, Global train loss: 1.278, Global test loss: 1.938, Global test accuracy: 36.18
Round  11, Train loss: 1.262, Test loss: 1.200, Test accuracy: 58.92
Round  11, Global train loss: 1.262, Global test loss: 2.418, Global test accuracy: 17.96
Round  12, Train loss: 1.189, Test loss: 1.142, Test accuracy: 62.08
Round  12, Global train loss: 1.189, Global test loss: 1.847, Global test accuracy: 39.50
Round  13, Train loss: 1.311, Test loss: 1.124, Test accuracy: 62.76
Round  13, Global train loss: 1.311, Global test loss: 1.929, Global test accuracy: 40.84
Round  14, Train loss: 1.072, Test loss: 1.129, Test accuracy: 62.00
Round  14, Global train loss: 1.072, Global test loss: 2.136, Global test accuracy: 30.92
Round  15, Train loss: 1.159, Test loss: 1.120, Test accuracy: 62.14
Round  15, Global train loss: 1.159, Global test loss: 1.988, Global test accuracy: 35.54
Round  16, Train loss: 1.052, Test loss: 1.087, Test accuracy: 63.88
Round  16, Global train loss: 1.052, Global test loss: 1.765, Global test accuracy: 45.54
Round  17, Train loss: 1.032, Test loss: 1.033, Test accuracy: 64.68
Round  17, Global train loss: 1.032, Global test loss: 1.869, Global test accuracy: 36.74
Round  18, Train loss: 1.306, Test loss: 1.053, Test accuracy: 63.80
Round  18, Global train loss: 1.306, Global test loss: 2.095, Global test accuracy: 42.28
Round  19, Train loss: 1.058, Test loss: 1.042, Test accuracy: 66.66
Round  19, Global train loss: 1.058, Global test loss: 1.907, Global test accuracy: 36.92
Round  20, Train loss: 1.054, Test loss: 1.050, Test accuracy: 66.60
Round  20, Global train loss: 1.054, Global test loss: 1.829, Global test accuracy: 40.08
Round  21, Train loss: 1.212, Test loss: 1.063, Test accuracy: 66.32
Round  21, Global train loss: 1.212, Global test loss: 2.039, Global test accuracy: 31.30
Round  22, Train loss: 1.198, Test loss: 1.034, Test accuracy: 66.24
Round  22, Global train loss: 1.198, Global test loss: 1.877, Global test accuracy: 36.70
Round  23, Train loss: 1.201, Test loss: 1.036, Test accuracy: 66.10
Round  23, Global train loss: 1.201, Global test loss: 1.971, Global test accuracy: 24.04
Round  24, Train loss: 1.023, Test loss: 1.020, Test accuracy: 67.30
Round  24, Global train loss: 1.023, Global test loss: 1.907, Global test accuracy: 43.16
Round  25, Train loss: 1.041, Test loss: 0.997, Test accuracy: 67.44
Round  25, Global train loss: 1.041, Global test loss: 2.020, Global test accuracy: 30.82
Round  26, Train loss: 1.155, Test loss: 1.002, Test accuracy: 67.22
Round  26, Global train loss: 1.155, Global test loss: 1.921, Global test accuracy: 35.12
Round  27, Train loss: 1.044, Test loss: 0.962, Test accuracy: 70.80
Round  27, Global train loss: 1.044, Global test loss: 1.595, Global test accuracy: 50.98
Round  28, Train loss: 1.108, Test loss: 0.985, Test accuracy: 68.32
Round  28, Global train loss: 1.108, Global test loss: 1.955, Global test accuracy: 34.10
Round  29, Train loss: 0.859, Test loss: 0.949, Test accuracy: 69.84
Round  29, Global train loss: 0.859, Global test loss: 1.852, Global test accuracy: 45.22
Round  30, Train loss: 1.012, Test loss: 0.953, Test accuracy: 70.00
Round  30, Global train loss: 1.012, Global test loss: 1.673, Global test accuracy: 42.96
Round  31, Train loss: 0.969, Test loss: 0.944, Test accuracy: 70.80
Round  31, Global train loss: 0.969, Global test loss: 1.514, Global test accuracy: 47.28
Round  32, Train loss: 0.927, Test loss: 0.962, Test accuracy: 68.82
Round  32, Global train loss: 0.927, Global test loss: 2.068, Global test accuracy: 37.46
Round  33, Train loss: 0.778, Test loss: 0.945, Test accuracy: 69.50
Round  33, Global train loss: 0.778, Global test loss: 1.876, Global test accuracy: 46.32
Round  34, Train loss: 1.112, Test loss: 0.930, Test accuracy: 71.08
Round  34, Global train loss: 1.112, Global test loss: 2.163, Global test accuracy: 39.10
Round  35, Train loss: 0.924, Test loss: 0.920, Test accuracy: 72.08
Round  35, Global train loss: 0.924, Global test loss: 2.321, Global test accuracy: 35.68
Round  36, Train loss: 0.816, Test loss: 0.946, Test accuracy: 69.60
Round  36, Global train loss: 0.816, Global test loss: 1.886, Global test accuracy: 39.34
Round  37, Train loss: 0.956, Test loss: 0.931, Test accuracy: 70.58
Round  37, Global train loss: 0.956, Global test loss: 1.666, Global test accuracy: 47.82
Round  38, Train loss: 0.860, Test loss: 0.895, Test accuracy: 71.22
Round  38, Global train loss: 0.860, Global test loss: 1.895, Global test accuracy: 38.60
Round  39, Train loss: 0.858, Test loss: 0.901, Test accuracy: 71.94
Round  39, Global train loss: 0.858, Global test loss: 1.819, Global test accuracy: 37.48
Round  40, Train loss: 1.075, Test loss: 0.915, Test accuracy: 70.98
Round  40, Global train loss: 1.075, Global test loss: 1.811, Global test accuracy: 42.46
Round  41, Train loss: 0.824, Test loss: 0.895, Test accuracy: 71.62
Round  41, Global train loss: 0.824, Global test loss: 1.456, Global test accuracy: 54.76
Round  42, Train loss: 0.781, Test loss: 0.919, Test accuracy: 71.24
Round  42, Global train loss: 0.781, Global test loss: 1.596, Global test accuracy: 43.42
Round  43, Train loss: 1.050, Test loss: 0.935, Test accuracy: 70.30
Round  43, Global train loss: 1.050, Global test loss: 1.741, Global test accuracy: 38.38
Round  44, Train loss: 1.006, Test loss: 0.916, Test accuracy: 70.52
Round  44, Global train loss: 1.006, Global test loss: 1.885, Global test accuracy: 34.18
Round  45, Train loss: 0.975, Test loss: 0.919, Test accuracy: 69.80
Round  45, Global train loss: 0.975, Global test loss: 2.095, Global test accuracy: 41.58
Round  46, Train loss: 0.892, Test loss: 0.891, Test accuracy: 71.92
Round  46, Global train loss: 0.892, Global test loss: 1.739, Global test accuracy: 45.54
Round  47, Train loss: 0.773, Test loss: 0.878, Test accuracy: 71.78
Round  47, Global train loss: 0.773, Global test loss: 1.758, Global test accuracy: 48.44
Round  48, Train loss: 1.181, Test loss: 0.902, Test accuracy: 70.92
Round  48, Global train loss: 1.181, Global test loss: 2.305, Global test accuracy: 26.28
Round  49, Train loss: 0.823, Test loss: 0.927, Test accuracy: 70.78
Round  49, Global train loss: 0.823, Global test loss: 1.704, Global test accuracy: 47.04
Round  50, Train loss: 0.769, Test loss: 0.902, Test accuracy: 71.56
Round  50, Global train loss: 0.769, Global test loss: 1.675, Global test accuracy: 49.32
Round  51, Train loss: 1.168, Test loss: 0.921, Test accuracy: 69.00
Round  51, Global train loss: 1.168, Global test loss: 2.680, Global test accuracy: 17.80
Round  52, Train loss: 0.812, Test loss: 0.900, Test accuracy: 70.80
Round  52, Global train loss: 0.812, Global test loss: 1.614, Global test accuracy: 42.60
Round  53, Train loss: 0.845, Test loss: 0.867, Test accuracy: 71.60
Round  53, Global train loss: 0.845, Global test loss: 1.504, Global test accuracy: 52.46
Round  54, Train loss: 0.781, Test loss: 0.883, Test accuracy: 71.48
Round  54, Global train loss: 0.781, Global test loss: 1.810, Global test accuracy: 40.90
Round  55, Train loss: 0.763, Test loss: 0.882, Test accuracy: 71.16
Round  55, Global train loss: 0.763, Global test loss: 1.907, Global test accuracy: 39.58
Round  56, Train loss: 0.778, Test loss: 0.873, Test accuracy: 71.18
Round  56, Global train loss: 0.778, Global test loss: 1.421, Global test accuracy: 56.88
Round  57, Train loss: 0.664, Test loss: 0.879, Test accuracy: 70.08
Round  57, Global train loss: 0.664, Global test loss: 1.578, Global test accuracy: 51.48
Round  58, Train loss: 0.671, Test loss: 0.852, Test accuracy: 71.72
Round  58, Global train loss: 0.671, Global test loss: 2.002, Global test accuracy: 37.66
Round  59, Train loss: 0.735, Test loss: 0.885, Test accuracy: 70.84
Round  59, Global train loss: 0.735, Global test loss: 1.752, Global test accuracy: 38.30
Round  60, Train loss: 0.798, Test loss: 0.878, Test accuracy: 69.94
Round  60, Global train loss: 0.798, Global test loss: 1.565, Global test accuracy: 42.60
Round  61, Train loss: 0.754, Test loss: 0.908, Test accuracy: 68.50
Round  61, Global train loss: 0.754, Global test loss: 1.884, Global test accuracy: 41.70
Round  62, Train loss: 0.691, Test loss: 0.913, Test accuracy: 69.42
Round  62, Global train loss: 0.691, Global test loss: 2.528, Global test accuracy: 28.76
Round  63, Train loss: 0.809, Test loss: 0.909, Test accuracy: 69.02
Round  63, Global train loss: 0.809, Global test loss: 1.886, Global test accuracy: 41.22
Round  64, Train loss: 0.767, Test loss: 0.889, Test accuracy: 70.78
Round  64, Global train loss: 0.767, Global test loss: 1.874, Global test accuracy: 43.68
Round  65, Train loss: 0.796, Test loss: 0.920, Test accuracy: 68.36
Round  65, Global train loss: 0.796, Global test loss: 2.381, Global test accuracy: 38.16
Round  66, Train loss: 0.703, Test loss: 0.910, Test accuracy: 69.36
Round  66, Global train loss: 0.703, Global test loss: 1.686, Global test accuracy: 43.92
Round  67, Train loss: 0.738, Test loss: 0.865, Test accuracy: 72.04
Round  67, Global train loss: 0.738, Global test loss: 2.334, Global test accuracy: 26.08
Round  68, Train loss: 0.855, Test loss: 0.919, Test accuracy: 68.82
Round  68, Global train loss: 0.855, Global test loss: 1.712, Global test accuracy: 41.22
Round  69, Train loss: 0.802, Test loss: 0.915, Test accuracy: 68.94
Round  69, Global train loss: 0.802, Global test loss: 1.951, Global test accuracy: 39.70
Round  70, Train loss: 0.831, Test loss: 0.971, Test accuracy: 65.12
Round  70, Global train loss: 0.831, Global test loss: 2.138, Global test accuracy: 29.50
Round  71, Train loss: 0.600, Test loss: 0.900, Test accuracy: 68.90
Round  71, Global train loss: 0.600, Global test loss: 1.503, Global test accuracy: 43.86
Round  72, Train loss: 0.726, Test loss: 0.951, Test accuracy: 67.32
Round  72, Global train loss: 0.726, Global test loss: 2.133, Global test accuracy: 26.22
Round  73, Train loss: 0.436, Test loss: 0.898, Test accuracy: 69.56
Round  73, Global train loss: 0.436, Global test loss: 2.483, Global test accuracy: 35.60
Round  74, Train loss: 0.648, Test loss: 0.910, Test accuracy: 68.86
Round  74, Global train loss: 0.648, Global test loss: 2.285, Global test accuracy: 27.92
Round  75, Train loss: 0.579, Test loss: 0.910, Test accuracy: 68.28
Round  75, Global train loss: 0.579, Global test loss: 2.076, Global test accuracy: 36.12
Round  76, Train loss: 0.661, Test loss: 0.907, Test accuracy: 68.78
Round  76, Global train loss: 0.661, Global test loss: 1.578, Global test accuracy: 42.06
Round  77, Train loss: 0.696, Test loss: 0.935, Test accuracy: 67.42
Round  77, Global train loss: 0.696, Global test loss: 2.410, Global test accuracy: 38.92
Round  78, Train loss: 0.784, Test loss: 0.987, Test accuracy: 65.74
Round  78, Global train loss: 0.784, Global test loss: 2.496, Global test accuracy: 20.48
Round  79, Train loss: 0.499, Test loss: 0.894, Test accuracy: 69.50
Round  79, Global train loss: 0.499, Global test loss: 1.573, Global test accuracy: 42.74
Round  80, Train loss: 0.499, Test loss: 0.891, Test accuracy: 69.62
Round  80, Global train loss: 0.499, Global test loss: 1.340, Global test accuracy: 55.10
Round  81, Train loss: 0.449, Test loss: 0.880, Test accuracy: 69.76
Round  81, Global train loss: 0.449, Global test loss: 1.341, Global test accuracy: 54.50
Round  82, Train loss: 0.425, Test loss: 0.885, Test accuracy: 70.58
Round  82, Global train loss: 0.425, Global test loss: 1.335, Global test accuracy: 55.56
Round  83, Train loss: 0.420, Test loss: 0.877, Test accuracy: 70.16
Round  83, Global train loss: 0.420, Global test loss: 1.313, Global test accuracy: 55.90
Round  84, Train loss: 0.408, Test loss: 0.888, Test accuracy: 70.28
Round  84, Global train loss: 0.408, Global test loss: 1.299, Global test accuracy: 56.84
Round  85, Train loss: 0.399, Test loss: 0.889, Test accuracy: 69.62
Round  85, Global train loss: 0.399, Global test loss: 1.300, Global test accuracy: 56.04
Round  86, Train loss: 0.378, Test loss: 0.895, Test accuracy: 70.38
Round  86, Global train loss: 0.378, Global test loss: 1.325, Global test accuracy: 55.96
Round  87, Train loss: 0.363, Test loss: 0.902, Test accuracy: 70.44
Round  87, Global train loss: 0.363, Global test loss: 1.290, Global test accuracy: 57.06
Round  88, Train loss: 0.362, Test loss: 0.895, Test accuracy: 70.18
Round  88, Global train loss: 0.362, Global test loss: 1.306, Global test accuracy: 56.56
Round  89, Train loss: 0.349, Test loss: 0.903, Test accuracy: 69.62
Round  89, Global train loss: 0.349, Global test loss: 1.290, Global test accuracy: 57.12
Round  90, Train loss: 0.345, Test loss: 0.912, Test accuracy: 69.74
Round  90, Global train loss: 0.345, Global test loss: 1.292, Global test accuracy: 57.12
Round  91, Train loss: 0.320, Test loss: 0.930, Test accuracy: 69.80
Round  91, Global train loss: 0.320, Global test loss: 1.284, Global test accuracy: 58.18
Round  92, Train loss: 0.331, Test loss: 0.903, Test accuracy: 70.24
Round  92, Global train loss: 0.331, Global test loss: 1.244, Global test accuracy: 58.96
Round  93, Train loss: 0.327, Test loss: 0.906, Test accuracy: 69.58
Round  93, Global train loss: 0.327, Global test loss: 1.257, Global test accuracy: 59.40
Round  94, Train loss: 0.311, Test loss: 0.915, Test accuracy: 69.88
Round  94, Global train loss: 0.311, Global test loss: 1.280, Global test accuracy: 57.62
Round  95, Train loss: 0.308, Test loss: 0.930, Test accuracy: 69.34
Round  95, Global train loss: 0.308, Global test loss: 1.296, Global test accuracy: 59.16
Round  96, Train loss: 0.304, Test loss: 0.922, Test accuracy: 69.80
Round  96, Global train loss: 0.304, Global test loss: 1.256, Global test accuracy: 58.94
Round  97, Train loss: 0.292, Test loss: 0.945, Test accuracy: 68.56
Round  97, Global train loss: 0.292, Global test loss: 1.280, Global test accuracy: 57.84
Round  98, Train loss: 0.289, Test loss: 0.942, Test accuracy: 68.86
Round  98, Global train loss: 0.289, Global test loss: 1.265, Global test accuracy: 58.28
Round  99, Train loss: 0.432, Test loss: 0.988, Test accuracy: 67.46
Round  99, Global train loss: 0.432, Global test loss: 1.214, Global test accuracy: 60.76
Final Round, Train loss: 0.390, Test loss: 0.999, Test accuracy: 67.50
Final Round, Global train loss: 0.390, Global test loss: 1.214, Global test accuracy: 60.76
Average accuracy final 10 rounds: 69.326
1974.558928489685
[2.5469696521759033, 4.6874847412109375, 7.104756832122803, 9.282024383544922, 11.321506977081299, 13.402202844619751, 15.668741941452026, 17.71442151069641, 19.77664875984192, 21.94826579093933, 24.05375099182129, 36.13493800163269, 47.44622993469238, 58.10874700546265, 60.216036319732666, 71.84838700294495, 83.30647540092468, 95.09248614311218, 106.77360486984253, 108.8854284286499, 120.19668531417847, 131.87562370300293, 143.20533394813538, 155.78936100006104, 168.50413250923157, 170.66593718528748, 182.22980117797852, 184.39585328102112, 196.2598373889923, 198.27046966552734, 209.857097864151, 212.16282176971436, 223.7357141971588, 225.99721693992615, 239.03701043128967, 250.65825486183167, 252.73111605644226, 254.81031823158264, 256.8253982067108, 268.3778040409088, 279.86487078666687, 281.7901837825775, 284.0957956314087, 295.8968322277069, 307.5169622898102, 319.145560503006, 321.31170535087585, 323.4505877494812, 335.1568958759308, 337.2315013408661, 339.27981328964233, 350.97725677490234, 362.511967420578, 374.32690382003784, 385.51868772506714, 397.79310417175293, 409.2673976421356, 421.072776556015, 423.170946598053, 434.7667193412781, 446.6434271335602, 457.8777868747711, 468.87999057769775, 481.91529870033264, 493.4485213756561, 504.8011441230774, 516.2708628177643, 527.7455739974976, 539.5956211090088, 551.0862183570862, 562.9122505187988, 574.3439996242523, 585.9349899291992, 587.9696581363678, 599.258448600769, 610.9211361408234, 613.1441900730133, 624.6585683822632, 636.2427110671997, 647.2176897525787, 649.4748797416687, 651.8362159729004, 654.5225577354431, 656.6360266208649, 658.960506439209, 661.0781481266022, 663.2362923622131, 665.6226952075958, 668.192786693573, 670.2805216312408, 672.3519051074982, 674.3980312347412, 676.4960615634918, 678.5327453613281, 680.7529809474945, 682.8129107952118, 684.920761346817, 687.0105044841766, 689.1090440750122, 700.3679158687592, 713.2400345802307]
[34.28, 39.24, 44.62, 48.8, 50.68, 53.0, 54.14, 55.46, 57.98, 59.02, 61.48, 58.92, 62.08, 62.76, 62.0, 62.14, 63.88, 64.68, 63.8, 66.66, 66.6, 66.32, 66.24, 66.1, 67.3, 67.44, 67.22, 70.8, 68.32, 69.84, 70.0, 70.8, 68.82, 69.5, 71.08, 72.08, 69.6, 70.58, 71.22, 71.94, 70.98, 71.62, 71.24, 70.3, 70.52, 69.8, 71.92, 71.78, 70.92, 70.78, 71.56, 69.0, 70.8, 71.6, 71.48, 71.16, 71.18, 70.08, 71.72, 70.84, 69.94, 68.5, 69.42, 69.02, 70.78, 68.36, 69.36, 72.04, 68.82, 68.94, 65.12, 68.9, 67.32, 69.56, 68.86, 68.28, 68.78, 67.42, 65.74, 69.5, 69.62, 69.76, 70.58, 70.16, 70.28, 69.62, 70.38, 70.44, 70.18, 69.62, 69.74, 69.8, 70.24, 69.58, 69.88, 69.34, 69.8, 68.56, 68.86, 67.46, 67.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.882, Test loss: 2.084, Test accuracy: 16.36
Round   0, Global train loss: 1.882, Global test loss: 2.269, Global test accuracy: 11.50
Round   1, Train loss: 1.738, Test loss: 1.773, Test accuracy: 33.80
Round   1, Global train loss: 1.738, Global test loss: 2.132, Global test accuracy: 23.02
Round   2, Train loss: 1.635, Test loss: 1.568, Test accuracy: 39.96
Round   2, Global train loss: 1.635, Global test loss: 2.190, Global test accuracy: 15.66
Round   3, Train loss: 1.494, Test loss: 1.434, Test accuracy: 49.32
Round   3, Global train loss: 1.494, Global test loss: 2.057, Global test accuracy: 34.20
Round   4, Train loss: 1.534, Test loss: 1.480, Test accuracy: 45.34
Round   4, Global train loss: 1.534, Global test loss: 2.240, Global test accuracy: 19.20
Round   5, Train loss: 1.416, Test loss: 1.424, Test accuracy: 46.82
Round   5, Global train loss: 1.416, Global test loss: 1.983, Global test accuracy: 28.36
Round   6, Train loss: 1.443, Test loss: 1.416, Test accuracy: 48.34
Round   6, Global train loss: 1.443, Global test loss: 2.030, Global test accuracy: 29.70
Round   7, Train loss: 1.336, Test loss: 1.405, Test accuracy: 47.04
Round   7, Global train loss: 1.336, Global test loss: 2.096, Global test accuracy: 21.82
Round   8, Train loss: 1.219, Test loss: 1.390, Test accuracy: 51.68
Round   8, Global train loss: 1.219, Global test loss: 2.081, Global test accuracy: 26.08
Round   9, Train loss: 1.265, Test loss: 1.328, Test accuracy: 54.74
Round   9, Global train loss: 1.265, Global test loss: 2.078, Global test accuracy: 33.60
Round  10, Train loss: 1.442, Test loss: 1.294, Test accuracy: 58.74
Round  10, Global train loss: 1.442, Global test loss: 2.193, Global test accuracy: 26.28
Round  11, Train loss: 1.071, Test loss: 1.398, Test accuracy: 54.88
Round  11, Global train loss: 1.071, Global test loss: 2.213, Global test accuracy: 31.32
Round  12, Train loss: 1.395, Test loss: 1.235, Test accuracy: 57.94
Round  12, Global train loss: 1.395, Global test loss: 2.038, Global test accuracy: 30.40
Round  13, Train loss: 1.365, Test loss: 1.218, Test accuracy: 59.94
Round  13, Global train loss: 1.365, Global test loss: 2.184, Global test accuracy: 30.10
Round  14, Train loss: 1.461, Test loss: 1.128, Test accuracy: 62.70
Round  14, Global train loss: 1.461, Global test loss: 2.142, Global test accuracy: 29.34
Round  15, Train loss: 1.441, Test loss: 1.102, Test accuracy: 63.46
Round  15, Global train loss: 1.441, Global test loss: 2.061, Global test accuracy: 30.78
Round  16, Train loss: 1.434, Test loss: 1.094, Test accuracy: 63.78
Round  16, Global train loss: 1.434, Global test loss: 2.116, Global test accuracy: 43.20
Round  17, Train loss: 1.163, Test loss: 1.077, Test accuracy: 64.56
Round  17, Global train loss: 1.163, Global test loss: 2.120, Global test accuracy: 26.32
Round  18, Train loss: 1.269, Test loss: 1.108, Test accuracy: 63.96
Round  18, Global train loss: 1.269, Global test loss: 1.985, Global test accuracy: 36.72
Round  19, Train loss: 1.302, Test loss: 1.096, Test accuracy: 64.30
Round  19, Global train loss: 1.302, Global test loss: 2.194, Global test accuracy: 28.18
Round  20, Train loss: 1.306, Test loss: 1.094, Test accuracy: 63.60
Round  20, Global train loss: 1.306, Global test loss: 2.045, Global test accuracy: 34.00
Round  21, Train loss: 1.282, Test loss: 1.088, Test accuracy: 63.80
Round  21, Global train loss: 1.282, Global test loss: 2.117, Global test accuracy: 32.12
Round  22, Train loss: 1.154, Test loss: 1.083, Test accuracy: 63.96
Round  22, Global train loss: 1.154, Global test loss: 2.074, Global test accuracy: 24.14
Round  23, Train loss: 0.855, Test loss: 1.044, Test accuracy: 65.36
Round  23, Global train loss: 0.855, Global test loss: 2.009, Global test accuracy: 33.44
Round  24, Train loss: 1.142, Test loss: 1.060, Test accuracy: 65.06
Round  24, Global train loss: 1.142, Global test loss: 2.026, Global test accuracy: 36.86
Round  25, Train loss: 1.160, Test loss: 1.054, Test accuracy: 65.86
Round  25, Global train loss: 1.160, Global test loss: 2.182, Global test accuracy: 27.40
Round  26, Train loss: 0.974, Test loss: 1.050, Test accuracy: 66.22
Round  26, Global train loss: 0.974, Global test loss: 2.127, Global test accuracy: 27.10
Round  27, Train loss: 0.947, Test loss: 1.039, Test accuracy: 66.62
Round  27, Global train loss: 0.947, Global test loss: 2.063, Global test accuracy: 38.42
Round  28, Train loss: 0.902, Test loss: 1.071, Test accuracy: 66.28
Round  28, Global train loss: 0.902, Global test loss: 2.094, Global test accuracy: 28.60
Round  29, Train loss: 1.062, Test loss: 1.093, Test accuracy: 66.12
Round  29, Global train loss: 1.062, Global test loss: 2.095, Global test accuracy: 29.38
Round  30, Train loss: 0.938, Test loss: 1.090, Test accuracy: 65.66
Round  30, Global train loss: 0.938, Global test loss: 1.984, Global test accuracy: 36.46
Round  31, Train loss: 0.603, Test loss: 1.082, Test accuracy: 66.26
Round  31, Global train loss: 0.603, Global test loss: 1.942, Global test accuracy: 31.32
Round  32, Train loss: 0.753, Test loss: 1.124, Test accuracy: 64.90
Round  32, Global train loss: 0.753, Global test loss: 2.130, Global test accuracy: 26.06
Round  33, Train loss: 0.962, Test loss: 1.121, Test accuracy: 65.24
Round  33, Global train loss: 0.962, Global test loss: 2.066, Global test accuracy: 30.86
Round  34, Train loss: 1.142, Test loss: 1.122, Test accuracy: 64.88
Round  34, Global train loss: 1.142, Global test loss: 2.090, Global test accuracy: 33.88
Round  35, Train loss: 0.941, Test loss: 1.112, Test accuracy: 65.74
Round  35, Global train loss: 0.941, Global test loss: 2.213, Global test accuracy: 28.18
Round  36, Train loss: 0.998, Test loss: 1.120, Test accuracy: 65.52
Round  36, Global train loss: 0.998, Global test loss: 2.111, Global test accuracy: 38.22
Round  37, Train loss: 1.079, Test loss: 1.125, Test accuracy: 65.44
Round  37, Global train loss: 1.079, Global test loss: 2.071, Global test accuracy: 43.20
Round  38, Train loss: 0.807, Test loss: 1.122, Test accuracy: 65.44
Round  38, Global train loss: 0.807, Global test loss: 1.962, Global test accuracy: 30.04
Round  39, Train loss: 0.632, Test loss: 1.165, Test accuracy: 64.70
Round  39, Global train loss: 0.632, Global test loss: 2.151, Global test accuracy: 26.78
Round  40, Train loss: 0.685, Test loss: 1.140, Test accuracy: 65.00
Round  40, Global train loss: 0.685, Global test loss: 2.088, Global test accuracy: 28.80
Round  41, Train loss: 0.792, Test loss: 1.140, Test accuracy: 64.90
Round  41, Global train loss: 0.792, Global test loss: 1.855, Global test accuracy: 34.14
Round  42, Train loss: 0.871, Test loss: 1.147, Test accuracy: 64.86
Round  42, Global train loss: 0.871, Global test loss: 1.957, Global test accuracy: 31.62
Round  43, Train loss: 0.958, Test loss: 1.166, Test accuracy: 64.54
Round  43, Global train loss: 0.958, Global test loss: 2.029, Global test accuracy: 28.62
Round  44, Train loss: 0.890, Test loss: 1.150, Test accuracy: 65.18
Round  44, Global train loss: 0.890, Global test loss: 1.945, Global test accuracy: 31.92
Round  45, Train loss: 0.818, Test loss: 1.177, Test accuracy: 65.10
Round  45, Global train loss: 0.818, Global test loss: 2.142, Global test accuracy: 25.48
Round  46, Train loss: 1.009, Test loss: 1.190, Test accuracy: 65.08
Round  46, Global train loss: 1.009, Global test loss: 2.227, Global test accuracy: 26.34
Round  47, Train loss: 0.618, Test loss: 1.220, Test accuracy: 64.54
Round  47, Global train loss: 0.618, Global test loss: 1.991, Global test accuracy: 36.44
Round  48, Train loss: 0.606, Test loss: 1.175, Test accuracy: 64.98
Round  48, Global train loss: 0.606, Global test loss: 2.251, Global test accuracy: 28.54
Round  49, Train loss: 0.920, Test loss: 1.188, Test accuracy: 64.26
Round  49, Global train loss: 0.920, Global test loss: 2.227, Global test accuracy: 25.48
Round  50, Train loss: 0.885, Test loss: 1.206, Test accuracy: 64.10
Round  50, Global train loss: 0.885, Global test loss: 2.203, Global test accuracy: 27.74
Round  51, Train loss: 0.664, Test loss: 1.244, Test accuracy: 62.98
Round  51, Global train loss: 0.664, Global test loss: 1.987, Global test accuracy: 35.70
Round  52, Train loss: 0.475, Test loss: 1.271, Test accuracy: 63.44
Round  52, Global train loss: 0.475, Global test loss: 2.024, Global test accuracy: 29.48
Round  53, Train loss: 0.557, Test loss: 1.268, Test accuracy: 63.80
Round  53, Global train loss: 0.557, Global test loss: 1.906, Global test accuracy: 41.06
Round  54, Train loss: 0.941, Test loss: 1.251, Test accuracy: 63.86
Round  54, Global train loss: 0.941, Global test loss: 2.077, Global test accuracy: 33.46
Round  55, Train loss: 0.801, Test loss: 1.300, Test accuracy: 63.16
Round  55, Global train loss: 0.801, Global test loss: 2.046, Global test accuracy: 36.94
Round  56, Train loss: 0.683, Test loss: 1.347, Test accuracy: 62.22
Round  56, Global train loss: 0.683, Global test loss: 1.883, Global test accuracy: 36.92
Round  57, Train loss: 0.436, Test loss: 1.337, Test accuracy: 62.42
Round  57, Global train loss: 0.436, Global test loss: 1.948, Global test accuracy: 36.40
Round  58, Train loss: 0.588, Test loss: 1.347, Test accuracy: 62.50
Round  58, Global train loss: 0.588, Global test loss: 2.443, Global test accuracy: 29.98
Round  59, Train loss: 0.737, Test loss: 1.327, Test accuracy: 63.76
Round  59, Global train loss: 0.737, Global test loss: 2.045, Global test accuracy: 25.72
Round  60, Train loss: 0.385, Test loss: 1.370, Test accuracy: 63.58
Round  60, Global train loss: 0.385, Global test loss: 1.899, Global test accuracy: 34.02
Round  61, Train loss: 0.399, Test loss: 1.483, Test accuracy: 62.50
Round  61, Global train loss: 0.399, Global test loss: 1.978, Global test accuracy: 32.04
Round  62, Train loss: 0.743, Test loss: 1.477, Test accuracy: 62.08
Round  62, Global train loss: 0.743, Global test loss: 2.161, Global test accuracy: 28.08
Round  63, Train loss: 0.518, Test loss: 1.457, Test accuracy: 62.32
Round  63, Global train loss: 0.518, Global test loss: 1.994, Global test accuracy: 34.68
Round  64, Train loss: 0.465, Test loss: 1.462, Test accuracy: 62.70
Round  64, Global train loss: 0.465, Global test loss: 1.992, Global test accuracy: 39.60
Round  65, Train loss: 0.525, Test loss: 1.516, Test accuracy: 61.82
Round  65, Global train loss: 0.525, Global test loss: 2.047, Global test accuracy: 36.82
Round  66, Train loss: 0.264, Test loss: 1.501, Test accuracy: 62.06
Round  66, Global train loss: 0.264, Global test loss: 1.929, Global test accuracy: 37.66
Round  67, Train loss: 0.414, Test loss: 1.462, Test accuracy: 62.64
Round  67, Global train loss: 0.414, Global test loss: 2.152, Global test accuracy: 29.64
Round  68, Train loss: 0.509, Test loss: 1.448, Test accuracy: 62.66
Round  68, Global train loss: 0.509, Global test loss: 2.070, Global test accuracy: 33.80
Round  69, Train loss: 0.424, Test loss: 1.444, Test accuracy: 62.24
Round  69, Global train loss: 0.424, Global test loss: 2.108, Global test accuracy: 27.78
Round  70, Train loss: 0.324, Test loss: 1.491, Test accuracy: 62.32
Round  70, Global train loss: 0.324, Global test loss: 1.981, Global test accuracy: 36.70
Round  71, Train loss: 0.462, Test loss: 1.491, Test accuracy: 61.82
Round  71, Global train loss: 0.462, Global test loss: 1.939, Global test accuracy: 31.90
Round  72, Train loss: 0.472, Test loss: 1.550, Test accuracy: 61.36
Round  72, Global train loss: 0.472, Global test loss: 1.997, Global test accuracy: 31.96
Round  73, Train loss: 0.453, Test loss: 1.568, Test accuracy: 61.26
Round  73, Global train loss: 0.453, Global test loss: 2.401, Global test accuracy: 29.00
Round  74, Train loss: 0.348, Test loss: 1.563, Test accuracy: 62.10
Round  74, Global train loss: 0.348, Global test loss: 2.191, Global test accuracy: 29.74
Round  75, Train loss: 0.411, Test loss: 1.559, Test accuracy: 62.92
Round  75, Global train loss: 0.411, Global test loss: 2.107, Global test accuracy: 26.02
Round  76, Train loss: 0.419, Test loss: 1.608, Test accuracy: 63.08
Round  76, Global train loss: 0.419, Global test loss: 2.081, Global test accuracy: 23.88
Round  77, Train loss: 0.370, Test loss: 1.671, Test accuracy: 62.30
Round  77, Global train loss: 0.370, Global test loss: 2.097, Global test accuracy: 34.96
Round  78, Train loss: 0.312, Test loss: 1.677, Test accuracy: 61.88
Round  78, Global train loss: 0.312, Global test loss: 2.030, Global test accuracy: 30.84
Round  79, Train loss: 0.312, Test loss: 1.646, Test accuracy: 61.34
Round  79, Global train loss: 0.312, Global test loss: 1.886, Global test accuracy: 33.70
Round  80, Train loss: 0.418, Test loss: 1.678, Test accuracy: 60.72
Round  80, Global train loss: 0.418, Global test loss: 2.299, Global test accuracy: 31.36
Round  81, Train loss: 0.251, Test loss: 1.670, Test accuracy: 61.00
Round  81, Global train loss: 0.251, Global test loss: 1.959, Global test accuracy: 34.26
Round  82, Train loss: 0.352, Test loss: 1.694, Test accuracy: 61.46
Round  82, Global train loss: 0.352, Global test loss: 2.035, Global test accuracy: 32.46
Round  83, Train loss: 0.178, Test loss: 1.753, Test accuracy: 61.36
Round  83, Global train loss: 0.178, Global test loss: 2.121, Global test accuracy: 28.90
Round  84, Train loss: 0.263, Test loss: 1.774, Test accuracy: 60.70
Round  84, Global train loss: 0.263, Global test loss: 1.931, Global test accuracy: 37.50
Round  85, Train loss: 0.315, Test loss: 1.774, Test accuracy: 60.92
Round  85, Global train loss: 0.315, Global test loss: 1.985, Global test accuracy: 35.50
Round  86, Train loss: 0.444, Test loss: 1.768, Test accuracy: 61.02
Round  86, Global train loss: 0.444, Global test loss: 2.067, Global test accuracy: 28.12
Round  87, Train loss: 0.234, Test loss: 1.749, Test accuracy: 61.66
Round  87, Global train loss: 0.234, Global test loss: 2.053, Global test accuracy: 33.80
Round  88, Train loss: 0.135, Test loss: 1.793, Test accuracy: 60.84
Round  88, Global train loss: 0.135, Global test loss: 1.868, Global test accuracy: 37.46
Round  89, Train loss: 0.381, Test loss: 1.789, Test accuracy: 61.10
Round  89, Global train loss: 0.381, Global test loss: 2.071, Global test accuracy: 26.52
Round  90, Train loss: 0.191, Test loss: 1.774, Test accuracy: 61.52
Round  90, Global train loss: 0.191, Global test loss: 1.932, Global test accuracy: 32.62
Round  91, Train loss: 0.168, Test loss: 1.807, Test accuracy: 61.56
Round  91, Global train loss: 0.168, Global test loss: 1.938, Global test accuracy: 32.42
Round  92, Train loss: 0.284, Test loss: 1.867, Test accuracy: 60.72
Round  92, Global train loss: 0.284, Global test loss: 2.088, Global test accuracy: 32.22
Round  93, Train loss: 0.202, Test loss: 1.851, Test accuracy: 60.26
Round  93, Global train loss: 0.202, Global test loss: 2.182, Global test accuracy: 30.66
Round  94, Train loss: 0.278, Test loss: 1.892, Test accuracy: 60.46
Round  94, Global train loss: 0.278, Global test loss: 1.906, Global test accuracy: 35.56
Round  95, Train loss: 0.216, Test loss: 1.911, Test accuracy: 60.90
Round  95, Global train loss: 0.216, Global test loss: 2.029, Global test accuracy: 34.38
Round  96, Train loss: 0.223, Test loss: 1.917, Test accuracy: 60.46
Round  96, Global train loss: 0.223, Global test loss: 2.046, Global test accuracy: 30.90
Round  97, Train loss: 0.156, Test loss: 1.908, Test accuracy: 61.16
Round  97, Global train loss: 0.156, Global test loss: 1.915, Global test accuracy: 35.42
Round  98, Train loss: 0.267, Test loss: 1.883, Test accuracy: 61.30
Round  98, Global train loss: 0.267, Global test loss: 2.089, Global test accuracy: 32.72
Round  99, Train loss: 0.239, Test loss: 1.875, Test accuracy: 61.54
Round  99, Global train loss: 0.239, Global test loss: 2.036, Global test accuracy: 34.30
Final Round, Train loss: 0.225, Test loss: 1.974, Test accuracy: 62.44
Final Round, Global train loss: 0.225, Global test loss: 2.036, Global test accuracy: 34.30
Average accuracy final 10 rounds: 60.988 

Average global accuracy final 10 rounds: 33.12 

990.4448082447052
[1.8115265369415283, 3.6230530738830566, 5.281711101531982, 6.940369129180908, 8.3583242893219, 9.77627944946289, 11.300579071044922, 12.824878692626953, 14.287433862686157, 15.749989032745361, 17.281145334243774, 18.812301635742188, 20.37856364250183, 21.944825649261475, 23.390673637390137, 24.8365216255188, 26.267704248428345, 27.69888687133789, 29.20052194595337, 30.702157020568848, 32.277693033218384, 33.85322904586792, 35.327048540115356, 36.80086803436279, 38.218851804733276, 39.63683557510376, 41.21187734603882, 42.78691911697388, 44.34173893928528, 45.89655876159668, 47.899462938308716, 49.90236711502075, 51.42231488227844, 52.94226264953613, 54.63596248626709, 56.32966232299805, 57.934937477111816, 59.540212631225586, 61.091230630874634, 62.64224863052368, 64.1850037574768, 65.72775888442993, 67.19901323318481, 68.6702675819397, 70.24511218070984, 71.81995677947998, 73.26345229148865, 74.70694780349731, 76.29920721054077, 77.89146661758423, 79.44092082977295, 80.99037504196167, 82.55808329582214, 84.12579154968262, 85.6335654258728, 87.14133930206299, 88.60821580886841, 90.07509231567383, 91.5598316192627, 93.04457092285156, 94.5220594406128, 95.99954795837402, 97.74711775779724, 99.49468755722046, 101.36583948135376, 103.23699140548706, 104.80329847335815, 106.36960554122925, 107.82065224647522, 109.27169895172119, 110.7693567276001, 112.267014503479, 113.79805183410645, 115.32908916473389, 116.84636855125427, 118.36364793777466, 119.92511439323425, 121.48658084869385, 122.98402762413025, 124.48147439956665, 126.01701164245605, 127.55254888534546, 129.09501028060913, 130.6374716758728, 132.10030817985535, 133.5631446838379, 134.99026012420654, 136.4173755645752, 137.93840861320496, 139.45944166183472, 140.97262120246887, 142.48580074310303, 144.04217410087585, 145.59854745864868, 146.9808211326599, 148.36309480667114, 149.90494012832642, 151.4467854499817, 152.99149107933044, 154.5361967086792, 156.08849334716797, 157.64078998565674, 159.10440397262573, 160.56801795959473, 162.11785888671875, 163.66769981384277, 165.11963772773743, 166.57157564163208, 168.11551690101624, 169.6594581604004, 171.16371655464172, 172.66797494888306, 174.17224597930908, 175.6765170097351, 177.23616647720337, 178.79581594467163, 180.37048482894897, 181.94515371322632, 183.47675013542175, 185.0083465576172, 186.63734531402588, 188.26634407043457, 190.22815346717834, 192.18996286392212, 193.77415132522583, 195.35833978652954, 196.93437099456787, 198.5104022026062, 200.1388852596283, 201.7673683166504, 203.30984354019165, 204.8523187637329, 206.39708805084229, 207.94185733795166, 209.5690221786499, 211.19618701934814, 212.70480036735535, 214.21341371536255, 215.72988963127136, 217.24636554718018, 218.8319869041443, 220.4176082611084, 222.11548352241516, 223.81335878372192, 225.34270787239075, 226.87205696105957, 228.4105315208435, 229.94900608062744, 231.43460631370544, 232.92020654678345, 234.3648328781128, 235.80945920944214, 237.39842438697815, 238.98738956451416, 240.4557662010193, 241.9241428375244, 243.4545121192932, 244.984881401062, 246.52908754348755, 248.0732936859131, 249.7506775856018, 251.42806148529053, 253.01230430603027, 254.59654712677002, 256.0004107952118, 257.40427446365356, 258.9660906791687, 260.52790689468384, 262.0722053050995, 263.61650371551514, 265.1605758666992, 266.7046480178833, 268.2888300418854, 269.87301206588745, 271.41970658302307, 272.9664011001587, 274.4856986999512, 276.00499629974365, 277.58216977119446, 279.15934324264526, 280.7298331260681, 282.30032300949097, 284.07152032852173, 285.8427176475525, 287.43639373779297, 289.03006982803345, 290.567503452301, 292.1049370765686, 293.5820314884186, 295.05912590026855, 296.5968687534332, 298.1346116065979, 299.8850665092468, 301.63552141189575, 303.171511888504, 304.7075023651123, 306.6259341239929, 308.54436588287354, 310.1734972000122, 311.8026285171509, 315.08458614349365, 318.3665437698364]
[16.36, 16.36, 33.8, 33.8, 39.96, 39.96, 49.32, 49.32, 45.34, 45.34, 46.82, 46.82, 48.34, 48.34, 47.04, 47.04, 51.68, 51.68, 54.74, 54.74, 58.74, 58.74, 54.88, 54.88, 57.94, 57.94, 59.94, 59.94, 62.7, 62.7, 63.46, 63.46, 63.78, 63.78, 64.56, 64.56, 63.96, 63.96, 64.3, 64.3, 63.6, 63.6, 63.8, 63.8, 63.96, 63.96, 65.36, 65.36, 65.06, 65.06, 65.86, 65.86, 66.22, 66.22, 66.62, 66.62, 66.28, 66.28, 66.12, 66.12, 65.66, 65.66, 66.26, 66.26, 64.9, 64.9, 65.24, 65.24, 64.88, 64.88, 65.74, 65.74, 65.52, 65.52, 65.44, 65.44, 65.44, 65.44, 64.7, 64.7, 65.0, 65.0, 64.9, 64.9, 64.86, 64.86, 64.54, 64.54, 65.18, 65.18, 65.1, 65.1, 65.08, 65.08, 64.54, 64.54, 64.98, 64.98, 64.26, 64.26, 64.1, 64.1, 62.98, 62.98, 63.44, 63.44, 63.8, 63.8, 63.86, 63.86, 63.16, 63.16, 62.22, 62.22, 62.42, 62.42, 62.5, 62.5, 63.76, 63.76, 63.58, 63.58, 62.5, 62.5, 62.08, 62.08, 62.32, 62.32, 62.7, 62.7, 61.82, 61.82, 62.06, 62.06, 62.64, 62.64, 62.66, 62.66, 62.24, 62.24, 62.32, 62.32, 61.82, 61.82, 61.36, 61.36, 61.26, 61.26, 62.1, 62.1, 62.92, 62.92, 63.08, 63.08, 62.3, 62.3, 61.88, 61.88, 61.34, 61.34, 60.72, 60.72, 61.0, 61.0, 61.46, 61.46, 61.36, 61.36, 60.7, 60.7, 60.92, 60.92, 61.02, 61.02, 61.66, 61.66, 60.84, 60.84, 61.1, 61.1, 61.52, 61.52, 61.56, 61.56, 60.72, 60.72, 60.26, 60.26, 60.46, 60.46, 60.9, 60.9, 60.46, 60.46, 61.16, 61.16, 61.3, 61.3, 61.54, 61.54, 62.44, 62.44]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.900, Test loss: 2.127, Test accuracy: 14.90
Round   0, Global train loss: 1.900, Global test loss: 2.307, Global test accuracy: 10.00
Round   1, Train loss: 1.785, Test loss: 1.825, Test accuracy: 30.88
Round   1, Global train loss: 1.785, Global test loss: 2.190, Global test accuracy: 18.22
Round   2, Train loss: 1.631, Test loss: 1.588, Test accuracy: 39.28
Round   2, Global train loss: 1.631, Global test loss: 2.217, Global test accuracy: 21.16
Round   3, Train loss: 1.750, Test loss: 1.494, Test accuracy: 46.24
Round   3, Global train loss: 1.750, Global test loss: 1.997, Global test accuracy: 34.64
Round   4, Train loss: 1.608, Test loss: 1.457, Test accuracy: 48.58
Round   4, Global train loss: 1.608, Global test loss: 1.951, Global test accuracy: 33.78
Round   5, Train loss: 1.606, Test loss: 1.445, Test accuracy: 48.04
Round   5, Global train loss: 1.606, Global test loss: 1.914, Global test accuracy: 35.10
Round   6, Train loss: 1.639, Test loss: 1.376, Test accuracy: 51.10
Round   6, Global train loss: 1.639, Global test loss: 1.789, Global test accuracy: 40.20
Round   7, Train loss: 1.599, Test loss: 1.373, Test accuracy: 50.24
Round   7, Global train loss: 1.599, Global test loss: 1.850, Global test accuracy: 35.82
Round   8, Train loss: 1.450, Test loss: 1.366, Test accuracy: 52.80
Round   8, Global train loss: 1.450, Global test loss: 1.807, Global test accuracy: 38.02
Round   9, Train loss: 1.543, Test loss: 1.334, Test accuracy: 53.40
Round   9, Global train loss: 1.543, Global test loss: 1.773, Global test accuracy: 41.06
Round  10, Train loss: 1.414, Test loss: 1.268, Test accuracy: 57.66
Round  10, Global train loss: 1.414, Global test loss: 1.776, Global test accuracy: 44.98
Round  11, Train loss: 1.530, Test loss: 1.324, Test accuracy: 54.76
Round  11, Global train loss: 1.530, Global test loss: 1.796, Global test accuracy: 41.84
Round  12, Train loss: 1.423, Test loss: 1.217, Test accuracy: 59.28
Round  12, Global train loss: 1.423, Global test loss: 1.771, Global test accuracy: 39.94
Round  13, Train loss: 1.336, Test loss: 1.161, Test accuracy: 62.30
Round  13, Global train loss: 1.336, Global test loss: 1.610, Global test accuracy: 49.72
Round  14, Train loss: 1.269, Test loss: 1.071, Test accuracy: 63.74
Round  14, Global train loss: 1.269, Global test loss: 1.855, Global test accuracy: 38.34
Round  15, Train loss: 1.221, Test loss: 1.060, Test accuracy: 64.48
Round  15, Global train loss: 1.221, Global test loss: 1.595, Global test accuracy: 44.84
Round  16, Train loss: 1.177, Test loss: 1.032, Test accuracy: 65.64
Round  16, Global train loss: 1.177, Global test loss: 1.531, Global test accuracy: 53.08
Round  17, Train loss: 1.245, Test loss: 1.022, Test accuracy: 65.80
Round  17, Global train loss: 1.245, Global test loss: 1.481, Global test accuracy: 51.04
Round  18, Train loss: 1.273, Test loss: 0.982, Test accuracy: 66.52
Round  18, Global train loss: 1.273, Global test loss: 1.455, Global test accuracy: 52.40
Round  19, Train loss: 1.214, Test loss: 0.961, Test accuracy: 68.12
Round  19, Global train loss: 1.214, Global test loss: 1.454, Global test accuracy: 52.38
Round  20, Train loss: 1.109, Test loss: 0.952, Test accuracy: 68.38
Round  20, Global train loss: 1.109, Global test loss: 1.456, Global test accuracy: 51.60
Round  21, Train loss: 1.197, Test loss: 0.949, Test accuracy: 68.64
Round  21, Global train loss: 1.197, Global test loss: 1.409, Global test accuracy: 55.62
Round  22, Train loss: 1.295, Test loss: 0.951, Test accuracy: 68.58
Round  22, Global train loss: 1.295, Global test loss: 1.460, Global test accuracy: 53.64
Round  23, Train loss: 1.421, Test loss: 0.966, Test accuracy: 67.86
Round  23, Global train loss: 1.421, Global test loss: 1.592, Global test accuracy: 48.82
Round  24, Train loss: 1.274, Test loss: 0.978, Test accuracy: 67.20
Round  24, Global train loss: 1.274, Global test loss: 1.440, Global test accuracy: 55.36
Round  25, Train loss: 1.274, Test loss: 0.969, Test accuracy: 67.40
Round  25, Global train loss: 1.274, Global test loss: 1.529, Global test accuracy: 51.54
Round  26, Train loss: 1.226, Test loss: 0.975, Test accuracy: 67.40
Round  26, Global train loss: 1.226, Global test loss: 1.546, Global test accuracy: 51.22
Round  27, Train loss: 1.135, Test loss: 0.968, Test accuracy: 68.08
Round  27, Global train loss: 1.135, Global test loss: 1.434, Global test accuracy: 55.42
Round  28, Train loss: 1.135, Test loss: 0.971, Test accuracy: 68.38
Round  28, Global train loss: 1.135, Global test loss: 1.565, Global test accuracy: 51.54
Round  29, Train loss: 0.876, Test loss: 0.955, Test accuracy: 68.30
Round  29, Global train loss: 0.876, Global test loss: 1.466, Global test accuracy: 55.92
Round  30, Train loss: 1.169, Test loss: 0.953, Test accuracy: 68.88
Round  30, Global train loss: 1.169, Global test loss: 1.356, Global test accuracy: 57.62
Round  31, Train loss: 1.053, Test loss: 0.932, Test accuracy: 69.96
Round  31, Global train loss: 1.053, Global test loss: 1.472, Global test accuracy: 53.02
Round  32, Train loss: 0.863, Test loss: 0.959, Test accuracy: 69.00
Round  32, Global train loss: 0.863, Global test loss: 1.493, Global test accuracy: 55.64
Round  33, Train loss: 0.779, Test loss: 0.960, Test accuracy: 69.14
Round  33, Global train loss: 0.779, Global test loss: 1.495, Global test accuracy: 56.92
Round  34, Train loss: 0.955, Test loss: 0.949, Test accuracy: 69.76
Round  34, Global train loss: 0.955, Global test loss: 1.648, Global test accuracy: 51.96
Round  35, Train loss: 0.699, Test loss: 0.936, Test accuracy: 70.06
Round  35, Global train loss: 0.699, Global test loss: 1.798, Global test accuracy: 53.20
Round  36, Train loss: 0.906, Test loss: 0.965, Test accuracy: 69.54
Round  36, Global train loss: 0.906, Global test loss: 1.340, Global test accuracy: 59.76
Round  37, Train loss: 0.840, Test loss: 0.990, Test accuracy: 68.80
Round  37, Global train loss: 0.840, Global test loss: 1.354, Global test accuracy: 59.76
Round  38, Train loss: 0.849, Test loss: 1.006, Test accuracy: 68.22
Round  38, Global train loss: 0.849, Global test loss: 1.424, Global test accuracy: 57.40
Round  39, Train loss: 0.718, Test loss: 1.005, Test accuracy: 67.96
Round  39, Global train loss: 0.718, Global test loss: 1.505, Global test accuracy: 56.64
Round  40, Train loss: 0.876, Test loss: 1.028, Test accuracy: 67.64
Round  40, Global train loss: 0.876, Global test loss: 1.548, Global test accuracy: 53.08
Round  41, Train loss: 0.761, Test loss: 1.033, Test accuracy: 67.82
Round  41, Global train loss: 0.761, Global test loss: 1.401, Global test accuracy: 57.88
Round  42, Train loss: 0.831, Test loss: 1.045, Test accuracy: 67.90
Round  42, Global train loss: 0.831, Global test loss: 1.439, Global test accuracy: 57.34
Round  43, Train loss: 1.019, Test loss: 1.028, Test accuracy: 68.30
Round  43, Global train loss: 1.019, Global test loss: 1.406, Global test accuracy: 57.46
Round  44, Train loss: 0.708, Test loss: 1.032, Test accuracy: 68.52
Round  44, Global train loss: 0.708, Global test loss: 1.537, Global test accuracy: 54.60
Round  45, Train loss: 0.704, Test loss: 1.038, Test accuracy: 68.38
Round  45, Global train loss: 0.704, Global test loss: 1.536, Global test accuracy: 54.40
Round  46, Train loss: 0.804, Test loss: 1.052, Test accuracy: 67.92
Round  46, Global train loss: 0.804, Global test loss: 1.522, Global test accuracy: 57.14
Round  47, Train loss: 0.694, Test loss: 1.062, Test accuracy: 67.86
Round  47, Global train loss: 0.694, Global test loss: 1.540, Global test accuracy: 57.62
Round  48, Train loss: 0.968, Test loss: 1.084, Test accuracy: 67.44
Round  48, Global train loss: 0.968, Global test loss: 1.668, Global test accuracy: 49.76
Round  49, Train loss: 0.658, Test loss: 1.090, Test accuracy: 67.22
Round  49, Global train loss: 0.658, Global test loss: 1.711, Global test accuracy: 55.16
Round  50, Train loss: 0.583, Test loss: 1.127, Test accuracy: 66.62
Round  50, Global train loss: 0.583, Global test loss: 1.785, Global test accuracy: 54.76
Round  51, Train loss: 0.820, Test loss: 1.150, Test accuracy: 66.22
Round  51, Global train loss: 0.820, Global test loss: 1.798, Global test accuracy: 49.16
Round  52, Train loss: 0.690, Test loss: 1.176, Test accuracy: 65.76
Round  52, Global train loss: 0.690, Global test loss: 1.647, Global test accuracy: 52.44
Round  53, Train loss: 0.718, Test loss: 1.204, Test accuracy: 65.24
Round  53, Global train loss: 0.718, Global test loss: 1.535, Global test accuracy: 56.00
Round  54, Train loss: 0.467, Test loss: 1.192, Test accuracy: 66.24
Round  54, Global train loss: 0.467, Global test loss: 1.700, Global test accuracy: 56.96
Round  55, Train loss: 0.411, Test loss: 1.191, Test accuracy: 66.50
Round  55, Global train loss: 0.411, Global test loss: 1.658, Global test accuracy: 58.16
Round  56, Train loss: 0.532, Test loss: 1.195, Test accuracy: 66.46
Round  56, Global train loss: 0.532, Global test loss: 1.387, Global test accuracy: 62.10
Round  57, Train loss: 0.530, Test loss: 1.197, Test accuracy: 67.14
Round  57, Global train loss: 0.530, Global test loss: 1.714, Global test accuracy: 54.00
Round  58, Train loss: 0.589, Test loss: 1.215, Test accuracy: 66.74
Round  58, Global train loss: 0.589, Global test loss: 1.800, Global test accuracy: 53.76
Round  59, Train loss: 0.548, Test loss: 1.187, Test accuracy: 67.76
Round  59, Global train loss: 0.548, Global test loss: 1.504, Global test accuracy: 60.88
Round  60, Train loss: 0.642, Test loss: 1.224, Test accuracy: 67.00
Round  60, Global train loss: 0.642, Global test loss: 1.651, Global test accuracy: 53.46
Round  61, Train loss: 0.516, Test loss: 1.283, Test accuracy: 65.64
Round  61, Global train loss: 0.516, Global test loss: 1.653, Global test accuracy: 55.42
Round  62, Train loss: 0.415, Test loss: 1.312, Test accuracy: 64.06
Round  62, Global train loss: 0.415, Global test loss: 1.723, Global test accuracy: 57.28
Round  63, Train loss: 0.415, Test loss: 1.294, Test accuracy: 64.38
Round  63, Global train loss: 0.415, Global test loss: 1.952, Global test accuracy: 54.40
Round  64, Train loss: 0.561, Test loss: 1.333, Test accuracy: 65.22
Round  64, Global train loss: 0.561, Global test loss: 1.604, Global test accuracy: 56.92
Round  65, Train loss: 0.406, Test loss: 1.359, Test accuracy: 65.56
Round  65, Global train loss: 0.406, Global test loss: 1.964, Global test accuracy: 55.44
Round  66, Train loss: 0.546, Test loss: 1.383, Test accuracy: 64.68
Round  66, Global train loss: 0.546, Global test loss: 1.840, Global test accuracy: 53.84
Round  67, Train loss: 0.507, Test loss: 1.367, Test accuracy: 65.04
Round  67, Global train loss: 0.507, Global test loss: 1.987, Global test accuracy: 52.72
Round  68, Train loss: 0.403, Test loss: 1.388, Test accuracy: 65.40
Round  68, Global train loss: 0.403, Global test loss: 1.968, Global test accuracy: 56.02
Round  69, Train loss: 0.476, Test loss: 1.430, Test accuracy: 64.50
Round  69, Global train loss: 0.476, Global test loss: 1.837, Global test accuracy: 53.86
Round  70, Train loss: 0.420, Test loss: 1.443, Test accuracy: 64.26
Round  70, Global train loss: 0.420, Global test loss: 2.015, Global test accuracy: 50.12
Round  71, Train loss: 0.492, Test loss: 1.444, Test accuracy: 65.50
Round  71, Global train loss: 0.492, Global test loss: 1.702, Global test accuracy: 56.20
Round  72, Train loss: 0.417, Test loss: 1.451, Test accuracy: 65.52
Round  72, Global train loss: 0.417, Global test loss: 1.868, Global test accuracy: 52.62
Round  73, Train loss: 0.400, Test loss: 1.475, Test accuracy: 65.64
Round  73, Global train loss: 0.400, Global test loss: 1.847, Global test accuracy: 57.44
Round  74, Train loss: 0.422, Test loss: 1.492, Test accuracy: 65.24
Round  74, Global train loss: 0.422, Global test loss: 2.212, Global test accuracy: 50.96
Round  75, Train loss: 0.284, Test loss: 1.478, Test accuracy: 65.92
Round  75, Global train loss: 0.284, Global test loss: 2.018, Global test accuracy: 54.52
Round  76, Train loss: 0.346, Test loss: 1.426, Test accuracy: 66.76
Round  76, Global train loss: 0.346, Global test loss: 1.663, Global test accuracy: 58.78
Round  77, Train loss: 0.345, Test loss: 1.479, Test accuracy: 65.46
Round  77, Global train loss: 0.345, Global test loss: 2.188, Global test accuracy: 53.34
Round  78, Train loss: 0.400, Test loss: 1.434, Test accuracy: 66.54
Round  78, Global train loss: 0.400, Global test loss: 2.160, Global test accuracy: 51.44
Round  79, Train loss: 0.369, Test loss: 1.454, Test accuracy: 65.38
Round  79, Global train loss: 0.369, Global test loss: 1.786, Global test accuracy: 53.42
Round  80, Train loss: 0.337, Test loss: 1.479, Test accuracy: 65.08
Round  80, Global train loss: 0.337, Global test loss: 1.775, Global test accuracy: 57.90
Round  81, Train loss: 0.329, Test loss: 1.525, Test accuracy: 64.84
Round  81, Global train loss: 0.329, Global test loss: 2.048, Global test accuracy: 56.16
Round  82, Train loss: 0.289, Test loss: 1.476, Test accuracy: 65.18
Round  82, Global train loss: 0.289, Global test loss: 1.886, Global test accuracy: 56.62
Round  83, Train loss: 0.326, Test loss: 1.554, Test accuracy: 64.38
Round  83, Global train loss: 0.326, Global test loss: 2.077, Global test accuracy: 55.36
Round  84, Train loss: 0.286, Test loss: 1.547, Test accuracy: 65.24
Round  84, Global train loss: 0.286, Global test loss: 1.982, Global test accuracy: 56.38
Round  85, Train loss: 0.287, Test loss: 1.525, Test accuracy: 66.06
Round  85, Global train loss: 0.287, Global test loss: 1.988, Global test accuracy: 57.24
Round  86, Train loss: 0.248, Test loss: 1.534, Test accuracy: 65.70
Round  86, Global train loss: 0.248, Global test loss: 1.672, Global test accuracy: 61.56
Round  87, Train loss: 0.314, Test loss: 1.561, Test accuracy: 65.18
Round  87, Global train loss: 0.314, Global test loss: 1.756, Global test accuracy: 58.52
Round  88, Train loss: 0.306, Test loss: 1.559, Test accuracy: 65.64
Round  88, Global train loss: 0.306, Global test loss: 1.926, Global test accuracy: 57.50
Round  89, Train loss: 0.235, Test loss: 1.562, Test accuracy: 65.98
Round  89, Global train loss: 0.235, Global test loss: 1.835, Global test accuracy: 61.88
Round  90, Train loss: 0.397, Test loss: 1.583, Test accuracy: 66.00
Round  90, Global train loss: 0.397, Global test loss: 2.118, Global test accuracy: 50.38
Round  91, Train loss: 0.297, Test loss: 1.625, Test accuracy: 66.16
Round  91, Global train loss: 0.297, Global test loss: 2.264, Global test accuracy: 49.04
Round  92, Train loss: 0.239, Test loss: 1.673, Test accuracy: 65.72
Round  92, Global train loss: 0.239, Global test loss: 2.270, Global test accuracy: 54.76
Round  93, Train loss: 0.305, Test loss: 1.702, Test accuracy: 65.34
Round  93, Global train loss: 0.305, Global test loss: 2.054, Global test accuracy: 57.10
Round  94, Train loss: 0.239, Test loss: 1.713, Test accuracy: 65.70
Round  94, Global train loss: 0.239, Global test loss: 1.869, Global test accuracy: 60.50
Round  95, Train loss: 0.271, Test loss: 1.743, Test accuracy: 65.20
Round  95, Global train loss: 0.271, Global test loss: 1.955, Global test accuracy: 58.10
Round  96, Train loss: 0.212, Test loss: 1.740, Test accuracy: 64.90
Round  96, Global train loss: 0.212, Global test loss: 1.987, Global test accuracy: 57.98
Round  97, Train loss: 0.296, Test loss: 1.767, Test accuracy: 64.44
Round  97, Global train loss: 0.296, Global test loss: 2.124, Global test accuracy: 55.20
Round  98, Train loss: 0.269, Test loss: 1.755, Test accuracy: 64.40
Round  98, Global train loss: 0.269, Global test loss: 2.144, Global test accuracy: 54.96
Round  99, Train loss: 0.278, Test loss: 1.714, Test accuracy: 64.82
Round  99, Global train loss: 0.278, Global test loss: 2.120, Global test accuracy: 53.98
Final Round, Train loss: 0.209, Test loss: 1.813, Test accuracy: 66.04
Final Round, Global train loss: 0.209, Global test loss: 2.120, Global test accuracy: 53.98
Average accuracy final 10 rounds: 65.268 

Average global accuracy final 10 rounds: 55.2 

1020.757417678833
[1.910642385482788, 3.821284770965576, 5.334949254989624, 6.848613739013672, 8.257182836532593, 9.665751934051514, 11.314263582229614, 12.962775230407715, 14.693123817443848, 16.42347240447998, 18.082386255264282, 19.741300106048584, 21.329065799713135, 22.916831493377686, 24.90616512298584, 26.895498752593994, 28.53313398361206, 30.170769214630127, 31.80851721763611, 33.44626522064209, 35.07198762893677, 36.697710037231445, 38.21366047859192, 39.72961091995239, 41.31707215309143, 42.90453338623047, 44.34803891181946, 45.79154443740845, 47.40252923965454, 49.013514041900635, 50.56381058692932, 52.11410713195801, 53.61143183708191, 55.10875654220581, 56.690030336380005, 58.2713041305542, 59.810173988342285, 61.34904384613037, 62.93703579902649, 64.52502775192261, 66.06921076774597, 67.61339378356934, 69.40389251708984, 71.19439125061035, 72.71963095664978, 74.24487066268921, 75.82961058616638, 77.41435050964355, 78.91777658462524, 80.42120265960693, 82.07944440841675, 83.73768615722656, 85.34248518943787, 86.94728422164917, 88.99922466278076, 91.05116510391235, 92.73114323616028, 94.4111213684082, 96.05615592002869, 97.70119047164917, 99.53845691680908, 101.375723361969, 102.93093204498291, 104.48614072799683, 106.16664242744446, 107.84714412689209, 109.53817439079285, 111.2292046546936, 112.95895576477051, 114.68870687484741, 116.2942123413086, 117.89971780776978, 119.53936338424683, 121.17900896072388, 122.81639361381531, 124.45377826690674, 126.27365016937256, 128.09352207183838, 129.7018277645111, 131.31013345718384, 133.10725831985474, 134.90438318252563, 136.6379828453064, 138.37158250808716, 140.07069396972656, 141.76980543136597, 143.45055508613586, 145.13130474090576, 146.79799938201904, 148.46469402313232, 150.1116008758545, 151.75850772857666, 153.37763667106628, 154.9967656135559, 156.77823877334595, 158.559711933136, 160.30155062675476, 162.04338932037354, 163.67732667922974, 165.31126403808594, 166.946839094162, 168.58241415023804, 170.1679048538208, 171.75339555740356, 173.2441737651825, 174.73495197296143, 176.31871581077576, 177.9024796485901, 179.47497296333313, 181.04746627807617, 182.60364151000977, 184.15981674194336, 185.69692754745483, 187.2340383529663, 188.86838150024414, 190.50272464752197, 192.0545313358307, 193.6063380241394, 195.08772206306458, 196.56910610198975, 198.2106213569641, 199.85213661193848, 201.43873119354248, 203.02532577514648, 204.57540130615234, 206.1254768371582, 207.73830246925354, 209.35112810134888, 211.0201952457428, 212.68926239013672, 214.2977101802826, 215.90615797042847, 217.5222761631012, 219.13839435577393, 220.67530632019043, 222.21221828460693, 223.78033661842346, 225.34845495224, 226.99794578552246, 228.64743661880493, 230.22466611862183, 231.80189561843872, 233.38299441337585, 234.964093208313, 236.58126759529114, 238.1984419822693, 239.68273448944092, 241.16702699661255, 242.83163619041443, 244.4962453842163, 246.09650921821594, 247.69677305221558, 249.28098797798157, 250.86520290374756, 252.54646134376526, 254.22771978378296, 255.80129551887512, 257.3748712539673, 258.9612350463867, 260.54759883880615, 262.1247103214264, 263.70182180404663, 265.37390065193176, 267.0459794998169, 268.68431210517883, 270.32264471054077, 271.98293137550354, 273.6432180404663, 275.18359375, 276.7239694595337, 278.2302739620209, 279.73657846450806, 281.340802192688, 282.9450259208679, 284.4910933971405, 286.0371608734131, 287.72625064849854, 289.415340423584, 291.0566806793213, 292.6980209350586, 294.3331549167633, 295.968288898468, 297.5670020580292, 299.16571521759033, 300.7449243068695, 302.3241333961487, 303.95264530181885, 305.581157207489, 307.2802104949951, 308.9792637825012, 310.70622849464417, 312.4331932067871, 314.00543189048767, 315.57767057418823, 317.09034514427185, 318.60301971435547, 320.3319113254547, 322.06080293655396, 323.6739389896393, 325.2870750427246, 328.578236579895, 331.86939811706543]
[14.9, 14.9, 30.88, 30.88, 39.28, 39.28, 46.24, 46.24, 48.58, 48.58, 48.04, 48.04, 51.1, 51.1, 50.24, 50.24, 52.8, 52.8, 53.4, 53.4, 57.66, 57.66, 54.76, 54.76, 59.28, 59.28, 62.3, 62.3, 63.74, 63.74, 64.48, 64.48, 65.64, 65.64, 65.8, 65.8, 66.52, 66.52, 68.12, 68.12, 68.38, 68.38, 68.64, 68.64, 68.58, 68.58, 67.86, 67.86, 67.2, 67.2, 67.4, 67.4, 67.4, 67.4, 68.08, 68.08, 68.38, 68.38, 68.3, 68.3, 68.88, 68.88, 69.96, 69.96, 69.0, 69.0, 69.14, 69.14, 69.76, 69.76, 70.06, 70.06, 69.54, 69.54, 68.8, 68.8, 68.22, 68.22, 67.96, 67.96, 67.64, 67.64, 67.82, 67.82, 67.9, 67.9, 68.3, 68.3, 68.52, 68.52, 68.38, 68.38, 67.92, 67.92, 67.86, 67.86, 67.44, 67.44, 67.22, 67.22, 66.62, 66.62, 66.22, 66.22, 65.76, 65.76, 65.24, 65.24, 66.24, 66.24, 66.5, 66.5, 66.46, 66.46, 67.14, 67.14, 66.74, 66.74, 67.76, 67.76, 67.0, 67.0, 65.64, 65.64, 64.06, 64.06, 64.38, 64.38, 65.22, 65.22, 65.56, 65.56, 64.68, 64.68, 65.04, 65.04, 65.4, 65.4, 64.5, 64.5, 64.26, 64.26, 65.5, 65.5, 65.52, 65.52, 65.64, 65.64, 65.24, 65.24, 65.92, 65.92, 66.76, 66.76, 65.46, 65.46, 66.54, 66.54, 65.38, 65.38, 65.08, 65.08, 64.84, 64.84, 65.18, 65.18, 64.38, 64.38, 65.24, 65.24, 66.06, 66.06, 65.7, 65.7, 65.18, 65.18, 65.64, 65.64, 65.98, 65.98, 66.0, 66.0, 66.16, 66.16, 65.72, 65.72, 65.34, 65.34, 65.7, 65.7, 65.2, 65.2, 64.9, 64.9, 64.44, 64.44, 64.4, 64.4, 64.82, 64.82, 66.04, 66.04]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.837, Test loss: 2.094, Test accuracy: 16.68
Round   0, Global train loss: 1.837, Global test loss: 2.282, Global test accuracy: 10.10
Round   1, Train loss: 1.635, Test loss: 1.706, Test accuracy: 36.74
Round   1, Global train loss: 1.635, Global test loss: 2.058, Global test accuracy: 25.22
Round   2, Train loss: 1.753, Test loss: 1.572, Test accuracy: 38.98
Round   2, Global train loss: 1.753, Global test loss: 2.200, Global test accuracy: 16.68
Round   3, Train loss: 1.578, Test loss: 1.428, Test accuracy: 49.38
Round   3, Global train loss: 1.578, Global test loss: 1.850, Global test accuracy: 40.38
Round   4, Train loss: 1.463, Test loss: 1.419, Test accuracy: 50.16
Round   4, Global train loss: 1.463, Global test loss: 1.912, Global test accuracy: 35.80
Round   5, Train loss: 1.492, Test loss: 1.360, Test accuracy: 51.54
Round   5, Global train loss: 1.492, Global test loss: 1.763, Global test accuracy: 40.46
Round   6, Train loss: 1.430, Test loss: 1.324, Test accuracy: 51.82
Round   6, Global train loss: 1.430, Global test loss: 1.753, Global test accuracy: 37.44
Round   7, Train loss: 1.461, Test loss: 1.340, Test accuracy: 50.22
Round   7, Global train loss: 1.461, Global test loss: 1.862, Global test accuracy: 32.18
Round   8, Train loss: 1.329, Test loss: 1.329, Test accuracy: 53.24
Round   8, Global train loss: 1.329, Global test loss: 1.828, Global test accuracy: 38.18
Round   9, Train loss: 1.282, Test loss: 1.246, Test accuracy: 55.96
Round   9, Global train loss: 1.282, Global test loss: 1.639, Global test accuracy: 43.28
Round  10, Train loss: 1.511, Test loss: 1.224, Test accuracy: 60.16
Round  10, Global train loss: 1.511, Global test loss: 1.684, Global test accuracy: 49.06
Round  11, Train loss: 1.265, Test loss: 1.310, Test accuracy: 54.30
Round  11, Global train loss: 1.265, Global test loss: 1.785, Global test accuracy: 40.70
Round  12, Train loss: 1.351, Test loss: 1.175, Test accuracy: 59.10
Round  12, Global train loss: 1.351, Global test loss: 1.596, Global test accuracy: 45.58
Round  13, Train loss: 1.302, Test loss: 1.132, Test accuracy: 61.14
Round  13, Global train loss: 1.302, Global test loss: 1.573, Global test accuracy: 49.64
Round  14, Train loss: 1.489, Test loss: 1.092, Test accuracy: 63.32
Round  14, Global train loss: 1.489, Global test loss: 1.695, Global test accuracy: 45.26
Round  15, Train loss: 1.334, Test loss: 1.076, Test accuracy: 64.58
Round  15, Global train loss: 1.334, Global test loss: 1.618, Global test accuracy: 47.74
Round  16, Train loss: 1.378, Test loss: 1.061, Test accuracy: 64.20
Round  16, Global train loss: 1.378, Global test loss: 1.742, Global test accuracy: 49.90
Round  17, Train loss: 1.357, Test loss: 1.037, Test accuracy: 66.00
Round  17, Global train loss: 1.357, Global test loss: 1.601, Global test accuracy: 49.52
Round  18, Train loss: 1.194, Test loss: 1.025, Test accuracy: 67.20
Round  18, Global train loss: 1.194, Global test loss: 1.467, Global test accuracy: 52.38
Round  19, Train loss: 1.397, Test loss: 1.033, Test accuracy: 67.02
Round  19, Global train loss: 1.397, Global test loss: 1.581, Global test accuracy: 52.86
Round  20, Train loss: 1.259, Test loss: 1.029, Test accuracy: 67.62
Round  20, Global train loss: 1.259, Global test loss: 1.474, Global test accuracy: 55.68
Round  21, Train loss: 1.094, Test loss: 1.040, Test accuracy: 67.44
Round  21, Global train loss: 1.094, Global test loss: 1.415, Global test accuracy: 53.22
Round  22, Train loss: 1.109, Test loss: 1.036, Test accuracy: 67.62
Round  22, Global train loss: 1.109, Global test loss: 1.441, Global test accuracy: 54.08
Round  23, Train loss: 0.978, Test loss: 0.995, Test accuracy: 68.76
Round  23, Global train loss: 0.978, Global test loss: 1.589, Global test accuracy: 47.34
Round  24, Train loss: 1.108, Test loss: 0.988, Test accuracy: 68.80
Round  24, Global train loss: 1.108, Global test loss: 1.339, Global test accuracy: 54.72
Round  25, Train loss: 1.222, Test loss: 0.969, Test accuracy: 68.96
Round  25, Global train loss: 1.222, Global test loss: 1.487, Global test accuracy: 53.60
Round  26, Train loss: 0.923, Test loss: 0.991, Test accuracy: 68.28
Round  26, Global train loss: 0.923, Global test loss: 1.434, Global test accuracy: 51.70
Round  27, Train loss: 1.079, Test loss: 0.986, Test accuracy: 68.58
Round  27, Global train loss: 1.079, Global test loss: 1.418, Global test accuracy: 57.72
Round  28, Train loss: 0.832, Test loss: 0.977, Test accuracy: 69.34
Round  28, Global train loss: 0.832, Global test loss: 1.523, Global test accuracy: 51.86
Round  29, Train loss: 1.185, Test loss: 0.967, Test accuracy: 69.66
Round  29, Global train loss: 1.185, Global test loss: 1.444, Global test accuracy: 56.38
Round  30, Train loss: 1.063, Test loss: 0.971, Test accuracy: 69.34
Round  30, Global train loss: 1.063, Global test loss: 1.323, Global test accuracy: 57.52
Round  31, Train loss: 0.979, Test loss: 0.985, Test accuracy: 69.32
Round  31, Global train loss: 0.979, Global test loss: 1.578, Global test accuracy: 48.30
Round  32, Train loss: 0.971, Test loss: 0.934, Test accuracy: 70.24
Round  32, Global train loss: 0.971, Global test loss: 1.490, Global test accuracy: 53.78
Round  33, Train loss: 1.084, Test loss: 0.929, Test accuracy: 70.18
Round  33, Global train loss: 1.084, Global test loss: 1.508, Global test accuracy: 54.30
Round  34, Train loss: 0.966, Test loss: 0.941, Test accuracy: 70.04
Round  34, Global train loss: 0.966, Global test loss: 1.373, Global test accuracy: 57.18
Round  35, Train loss: 1.034, Test loss: 0.945, Test accuracy: 69.92
Round  35, Global train loss: 1.034, Global test loss: 1.570, Global test accuracy: 51.12
Round  36, Train loss: 1.130, Test loss: 0.946, Test accuracy: 70.16
Round  36, Global train loss: 1.130, Global test loss: 1.434, Global test accuracy: 54.46
Round  37, Train loss: 1.091, Test loss: 0.955, Test accuracy: 69.48
Round  37, Global train loss: 1.091, Global test loss: 1.489, Global test accuracy: 56.12
Round  38, Train loss: 1.043, Test loss: 0.977, Test accuracy: 68.84
Round  38, Global train loss: 1.043, Global test loss: 1.360, Global test accuracy: 56.78
Round  39, Train loss: 0.843, Test loss: 0.990, Test accuracy: 68.10
Round  39, Global train loss: 0.843, Global test loss: 1.537, Global test accuracy: 53.54
Round  40, Train loss: 0.661, Test loss: 0.993, Test accuracy: 68.50
Round  40, Global train loss: 0.661, Global test loss: 1.439, Global test accuracy: 56.16
Round  41, Train loss: 1.057, Test loss: 0.989, Test accuracy: 68.58
Round  41, Global train loss: 1.057, Global test loss: 1.380, Global test accuracy: 56.50
Round  42, Train loss: 1.070, Test loss: 0.994, Test accuracy: 68.30
Round  42, Global train loss: 1.070, Global test loss: 1.486, Global test accuracy: 53.68
Round  43, Train loss: 0.900, Test loss: 1.039, Test accuracy: 66.72
Round  43, Global train loss: 0.900, Global test loss: 1.505, Global test accuracy: 54.44
Round  44, Train loss: 0.817, Test loss: 1.027, Test accuracy: 66.88
Round  44, Global train loss: 0.817, Global test loss: 1.386, Global test accuracy: 57.36
Round  45, Train loss: 0.730, Test loss: 1.029, Test accuracy: 66.54
Round  45, Global train loss: 0.730, Global test loss: 1.371, Global test accuracy: 57.40
Round  46, Train loss: 0.985, Test loss: 1.016, Test accuracy: 67.12
Round  46, Global train loss: 0.985, Global test loss: 1.535, Global test accuracy: 54.80
Round  47, Train loss: 0.784, Test loss: 1.017, Test accuracy: 66.94
Round  47, Global train loss: 0.784, Global test loss: 1.526, Global test accuracy: 55.30
Round  48, Train loss: 0.631, Test loss: 1.026, Test accuracy: 66.70
Round  48, Global train loss: 0.631, Global test loss: 1.457, Global test accuracy: 55.90
Round  49, Train loss: 0.886, Test loss: 1.058, Test accuracy: 65.78
Round  49, Global train loss: 0.886, Global test loss: 1.633, Global test accuracy: 52.48
Round  50, Train loss: 0.788, Test loss: 1.074, Test accuracy: 65.98
Round  50, Global train loss: 0.788, Global test loss: 1.790, Global test accuracy: 51.36
Round  51, Train loss: 0.588, Test loss: 1.052, Test accuracy: 66.94
Round  51, Global train loss: 0.588, Global test loss: 1.434, Global test accuracy: 56.66
Round  52, Train loss: 0.650, Test loss: 1.096, Test accuracy: 66.20
Round  52, Global train loss: 0.650, Global test loss: 1.431, Global test accuracy: 56.90
Round  53, Train loss: 0.668, Test loss: 1.091, Test accuracy: 66.56
Round  53, Global train loss: 0.668, Global test loss: 1.384, Global test accuracy: 55.82
Round  54, Train loss: 0.850, Test loss: 1.097, Test accuracy: 66.16
Round  54, Global train loss: 0.850, Global test loss: 1.553, Global test accuracy: 54.88
Round  55, Train loss: 0.734, Test loss: 1.112, Test accuracy: 66.34
Round  55, Global train loss: 0.734, Global test loss: 1.588, Global test accuracy: 53.96
Round  56, Train loss: 0.709, Test loss: 1.122, Test accuracy: 66.46
Round  56, Global train loss: 0.709, Global test loss: 1.453, Global test accuracy: 54.54
Round  57, Train loss: 0.603, Test loss: 1.122, Test accuracy: 66.48
Round  57, Global train loss: 0.603, Global test loss: 1.661, Global test accuracy: 51.92
Round  58, Train loss: 0.632, Test loss: 1.148, Test accuracy: 65.38
Round  58, Global train loss: 0.632, Global test loss: 1.613, Global test accuracy: 52.66
Round  59, Train loss: 0.664, Test loss: 1.139, Test accuracy: 65.88
Round  59, Global train loss: 0.664, Global test loss: 1.434, Global test accuracy: 55.86
Round  60, Train loss: 0.700, Test loss: 1.175, Test accuracy: 65.42
Round  60, Global train loss: 0.700, Global test loss: 1.413, Global test accuracy: 57.00
Round  61, Train loss: 0.573, Test loss: 1.188, Test accuracy: 64.96
Round  61, Global train loss: 0.573, Global test loss: 1.618, Global test accuracy: 55.46
Round  62, Train loss: 0.630, Test loss: 1.190, Test accuracy: 64.98
Round  62, Global train loss: 0.630, Global test loss: 1.531, Global test accuracy: 54.98
Round  63, Train loss: 0.561, Test loss: 1.186, Test accuracy: 65.28
Round  63, Global train loss: 0.561, Global test loss: 1.626, Global test accuracy: 56.66
Round  64, Train loss: 0.799, Test loss: 1.163, Test accuracy: 66.32
Round  64, Global train loss: 0.799, Global test loss: 1.480, Global test accuracy: 55.72
Round  65, Train loss: 0.487, Test loss: 1.208, Test accuracy: 65.38
Round  65, Global train loss: 0.487, Global test loss: 1.561, Global test accuracy: 56.66
Round  66, Train loss: 0.404, Test loss: 1.217, Test accuracy: 65.46
Round  66, Global train loss: 0.404, Global test loss: 1.455, Global test accuracy: 58.28
Round  67, Train loss: 0.711, Test loss: 1.188, Test accuracy: 66.36
Round  67, Global train loss: 0.711, Global test loss: 1.606, Global test accuracy: 53.16
Round  68, Train loss: 0.510, Test loss: 1.157, Test accuracy: 66.80
Round  68, Global train loss: 0.510, Global test loss: 1.573, Global test accuracy: 57.60
Round  69, Train loss: 0.473, Test loss: 1.203, Test accuracy: 66.14
Round  69, Global train loss: 0.473, Global test loss: 1.523, Global test accuracy: 57.94
Round  70, Train loss: 0.354, Test loss: 1.197, Test accuracy: 65.84
Round  70, Global train loss: 0.354, Global test loss: 1.605, Global test accuracy: 58.36
Round  71, Train loss: 0.706, Test loss: 1.241, Test accuracy: 65.16
Round  71, Global train loss: 0.706, Global test loss: 1.469, Global test accuracy: 55.58
Round  72, Train loss: 0.401, Test loss: 1.251, Test accuracy: 65.14
Round  72, Global train loss: 0.401, Global test loss: 1.774, Global test accuracy: 52.10
Round  73, Train loss: 0.501, Test loss: 1.252, Test accuracy: 65.74
Round  73, Global train loss: 0.501, Global test loss: 1.882, Global test accuracy: 49.90
Round  74, Train loss: 0.581, Test loss: 1.257, Test accuracy: 65.24
Round  74, Global train loss: 0.581, Global test loss: 1.688, Global test accuracy: 52.96
Round  75, Train loss: 0.577, Test loss: 1.259, Test accuracy: 64.38
Round  75, Global train loss: 0.577, Global test loss: 1.722, Global test accuracy: 53.60
Round  76, Train loss: 0.465, Test loss: 1.292, Test accuracy: 64.68
Round  76, Global train loss: 0.465, Global test loss: 1.534, Global test accuracy: 56.68
Round  77, Train loss: 0.374, Test loss: 1.372, Test accuracy: 63.98
Round  77, Global train loss: 0.374, Global test loss: 1.777, Global test accuracy: 56.02
Round  78, Train loss: 0.313, Test loss: 1.309, Test accuracy: 65.16
Round  78, Global train loss: 0.313, Global test loss: 1.683, Global test accuracy: 58.22
Round  79, Train loss: 0.545, Test loss: 1.309, Test accuracy: 64.92
Round  79, Global train loss: 0.545, Global test loss: 1.577, Global test accuracy: 56.56
Round  80, Train loss: 0.538, Test loss: 1.334, Test accuracy: 64.70
Round  80, Global train loss: 0.538, Global test loss: 1.907, Global test accuracy: 52.38
Round  81, Train loss: 0.497, Test loss: 1.326, Test accuracy: 64.82
Round  81, Global train loss: 0.497, Global test loss: 1.726, Global test accuracy: 56.06
Round  82, Train loss: 0.320, Test loss: 1.324, Test accuracy: 64.70
Round  82, Global train loss: 0.320, Global test loss: 1.593, Global test accuracy: 57.92
Round  83, Train loss: 0.472, Test loss: 1.339, Test accuracy: 64.52
Round  83, Global train loss: 0.472, Global test loss: 1.924, Global test accuracy: 53.20
Round  84, Train loss: 0.566, Test loss: 1.365, Test accuracy: 64.10
Round  84, Global train loss: 0.566, Global test loss: 1.859, Global test accuracy: 52.36
Round  85, Train loss: 0.316, Test loss: 1.348, Test accuracy: 63.80
Round  85, Global train loss: 0.316, Global test loss: 1.692, Global test accuracy: 55.90
Round  86, Train loss: 0.506, Test loss: 1.315, Test accuracy: 65.92
Round  86, Global train loss: 0.506, Global test loss: 1.731, Global test accuracy: 53.34
Round  87, Train loss: 0.513, Test loss: 1.321, Test accuracy: 66.02
Round  87, Global train loss: 0.513, Global test loss: 1.836, Global test accuracy: 50.82
Round  88, Train loss: 0.424, Test loss: 1.342, Test accuracy: 65.76
Round  88, Global train loss: 0.424, Global test loss: 1.699, Global test accuracy: 55.38
Round  89, Train loss: 0.475, Test loss: 1.423, Test accuracy: 64.44
Round  89, Global train loss: 0.475, Global test loss: 1.829, Global test accuracy: 51.90
Round  90, Train loss: 0.276, Test loss: 1.428, Test accuracy: 64.80
Round  90, Global train loss: 0.276, Global test loss: 1.911, Global test accuracy: 55.82
Round  91, Train loss: 0.220, Test loss: 1.464, Test accuracy: 64.42
Round  91, Global train loss: 0.220, Global test loss: 2.132, Global test accuracy: 53.44
Round  92, Train loss: 0.387, Test loss: 1.498, Test accuracy: 64.32
Round  92, Global train loss: 0.387, Global test loss: 1.753, Global test accuracy: 55.68
Round  93, Train loss: 0.285, Test loss: 1.503, Test accuracy: 64.20
Round  93, Global train loss: 0.285, Global test loss: 1.822, Global test accuracy: 55.92
Round  94, Train loss: 0.374, Test loss: 1.520, Test accuracy: 64.78
Round  94, Global train loss: 0.374, Global test loss: 1.719, Global test accuracy: 57.02/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.401, Test loss: 1.507, Test accuracy: 64.80
Round  95, Global train loss: 0.401, Global test loss: 1.715, Global test accuracy: 56.08
Round  96, Train loss: 0.367, Test loss: 1.494, Test accuracy: 64.96
Round  96, Global train loss: 0.367, Global test loss: 1.872, Global test accuracy: 53.08
Round  97, Train loss: 0.352, Test loss: 1.492, Test accuracy: 64.82
Round  97, Global train loss: 0.352, Global test loss: 1.669, Global test accuracy: 56.34
Round  98, Train loss: 0.336, Test loss: 1.471, Test accuracy: 65.22
Round  98, Global train loss: 0.336, Global test loss: 1.722, Global test accuracy: 58.10
Round  99, Train loss: 0.299, Test loss: 1.454, Test accuracy: 65.10
Round  99, Global train loss: 0.299, Global test loss: 1.742, Global test accuracy: 57.38
Final Round, Train loss: 0.284, Test loss: 1.545, Test accuracy: 64.78
Final Round, Global train loss: 0.284, Global test loss: 1.742, Global test accuracy: 57.38
Average accuracy final 10 rounds: 64.742 

Average global accuracy final 10 rounds: 55.885999999999996 

941.7940485477448
[1.9512436389923096, 3.902487277984619, 5.641202688217163, 7.379918098449707, 9.05151653289795, 10.723114967346191, 12.479199647903442, 14.235284328460693, 16.22962188720703, 18.22395944595337, 20.068323612213135, 21.9126877784729, 23.57288670539856, 25.23308563232422, 26.937655448913574, 28.64222526550293, 30.317249298095703, 31.992273330688477, 33.76086378097534, 35.52945423126221, 37.15997815132141, 38.790502071380615, 40.53529930114746, 42.28009653091431, 44.07395362854004, 45.86781072616577, 47.4778470993042, 49.08788347244263, 50.72827506065369, 52.368666648864746, 54.12388753890991, 55.87910842895508, 57.43779015541077, 58.996471881866455, 60.78155159950256, 62.56663131713867, 64.29585695266724, 66.0250825881958, 67.63298892974854, 69.24089527130127, 70.93967270851135, 72.63845014572144, 74.31131362915039, 75.98417711257935, 77.6523847579956, 79.32059240341187, 81.1190505027771, 82.91750860214233, 84.46073579788208, 86.00396299362183, 87.7788872718811, 89.55381155014038, 91.22414803504944, 92.8944845199585, 94.68974471092224, 96.48500490188599, 98.13502311706543, 99.78504133224487, 101.41968321800232, 103.05432510375977, 104.7080647945404, 106.36180448532104, 108.13051795959473, 109.89923143386841, 111.6612823009491, 113.42333316802979, 115.06319499015808, 116.70305681228638, 118.32196140289307, 119.94086599349976, 121.74801802635193, 123.5551700592041, 125.19251298904419, 126.82985591888428, 128.4502351284027, 130.07061433792114, 131.81756567955017, 133.5645170211792, 135.14715051651, 136.72978401184082, 138.56480598449707, 140.39982795715332, 142.10599517822266, 143.812162399292, 145.45714259147644, 147.1021227836609, 148.93522834777832, 150.76833391189575, 152.3080723285675, 153.84781074523926, 155.36947321891785, 156.89113569259644, 158.33350920677185, 159.77588272094727, 161.2447988986969, 162.71371507644653, 164.08858394622803, 165.46345281600952, 167.05019116401672, 168.63692951202393, 170.13099002838135, 171.62505054473877, 172.9697549343109, 174.31445932388306, 175.75298500061035, 177.19151067733765, 178.61905312538147, 180.0465955734253, 181.42727780342102, 182.80796003341675, 184.2341136932373, 185.66026735305786, 187.0066056251526, 188.35294389724731, 189.745858669281, 191.1387734413147, 192.57690262794495, 194.0150318145752, 195.4554944038391, 196.89595699310303, 198.37577939033508, 199.85560178756714, 201.4204924106598, 202.98538303375244, 204.4207785129547, 205.85617399215698, 207.23123908042908, 208.60630416870117, 209.98750066757202, 211.36869716644287, 212.7354211807251, 214.10214519500732, 215.57736372947693, 217.05258226394653, 218.38838052749634, 219.72417879104614, 221.15450882911682, 222.5848388671875, 223.92721033096313, 225.26958179473877, 226.58641600608826, 227.90325021743774, 229.16916370391846, 230.43507719039917, 231.66412234306335, 232.89316749572754, 234.11327505111694, 235.33338260650635, 236.58794951438904, 237.84251642227173, 239.01259875297546, 240.1826810836792, 241.42096543312073, 242.65924978256226, 243.88915753364563, 245.119065284729, 246.3503520488739, 247.5816388130188, 248.78049635887146, 249.97935390472412, 251.17669486999512, 252.3740358352661, 253.56647658348083, 254.75891733169556, 255.96656250953674, 257.17420768737793, 258.3898787498474, 259.6055498123169, 260.8025257587433, 261.9995017051697, 263.2059235572815, 264.4123454093933, 265.62717938423157, 266.8420133590698, 268.05132484436035, 269.2606363296509, 270.4576997756958, 271.6547632217407, 272.8505518436432, 274.04634046554565, 275.4203567504883, 276.7943730354309, 278.00186920166016, 279.2093653678894, 280.4492347240448, 281.6891040802002, 282.92111992836, 284.1531357765198, 285.34330010414124, 286.5334644317627, 287.73648142814636, 288.93949842453003, 290.12942361831665, 291.31934881210327, 292.51195883750916, 293.70456886291504, 294.91638684272766, 296.1282048225403, 297.3316721916199, 298.53513956069946, 300.9674994945526, 303.39985942840576]
[16.68, 16.68, 36.74, 36.74, 38.98, 38.98, 49.38, 49.38, 50.16, 50.16, 51.54, 51.54, 51.82, 51.82, 50.22, 50.22, 53.24, 53.24, 55.96, 55.96, 60.16, 60.16, 54.3, 54.3, 59.1, 59.1, 61.14, 61.14, 63.32, 63.32, 64.58, 64.58, 64.2, 64.2, 66.0, 66.0, 67.2, 67.2, 67.02, 67.02, 67.62, 67.62, 67.44, 67.44, 67.62, 67.62, 68.76, 68.76, 68.8, 68.8, 68.96, 68.96, 68.28, 68.28, 68.58, 68.58, 69.34, 69.34, 69.66, 69.66, 69.34, 69.34, 69.32, 69.32, 70.24, 70.24, 70.18, 70.18, 70.04, 70.04, 69.92, 69.92, 70.16, 70.16, 69.48, 69.48, 68.84, 68.84, 68.1, 68.1, 68.5, 68.5, 68.58, 68.58, 68.3, 68.3, 66.72, 66.72, 66.88, 66.88, 66.54, 66.54, 67.12, 67.12, 66.94, 66.94, 66.7, 66.7, 65.78, 65.78, 65.98, 65.98, 66.94, 66.94, 66.2, 66.2, 66.56, 66.56, 66.16, 66.16, 66.34, 66.34, 66.46, 66.46, 66.48, 66.48, 65.38, 65.38, 65.88, 65.88, 65.42, 65.42, 64.96, 64.96, 64.98, 64.98, 65.28, 65.28, 66.32, 66.32, 65.38, 65.38, 65.46, 65.46, 66.36, 66.36, 66.8, 66.8, 66.14, 66.14, 65.84, 65.84, 65.16, 65.16, 65.14, 65.14, 65.74, 65.74, 65.24, 65.24, 64.38, 64.38, 64.68, 64.68, 63.98, 63.98, 65.16, 65.16, 64.92, 64.92, 64.7, 64.7, 64.82, 64.82, 64.7, 64.7, 64.52, 64.52, 64.1, 64.1, 63.8, 63.8, 65.92, 65.92, 66.02, 66.02, 65.76, 65.76, 64.44, 64.44, 64.8, 64.8, 64.42, 64.42, 64.32, 64.32, 64.2, 64.2, 64.78, 64.78, 64.8, 64.8, 64.96, 64.96, 64.82, 64.82, 65.22, 65.22, 65.1, 65.1, 64.78, 64.78]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.864, Test loss: 2.121, Test accuracy: 16.12
Round   0, Global train loss: 1.864, Global test loss: 2.307, Global test accuracy: 10.50
Round   1, Train loss: 1.728, Test loss: 1.747, Test accuracy: 34.86
Round   1, Global train loss: 1.728, Global test loss: 2.106, Global test accuracy: 24.04
Round   2, Train loss: 1.647, Test loss: 1.580, Test accuracy: 38.36
Round   2, Global train loss: 1.647, Global test loss: 2.259, Global test accuracy: 16.98
Round   3, Train loss: 1.598, Test loss: 1.446, Test accuracy: 47.16
Round   3, Global train loss: 1.598, Global test loss: 1.862, Global test accuracy: 36.14
Round   4, Train loss: 1.654, Test loss: 1.455, Test accuracy: 47.78
Round   4, Global train loss: 1.654, Global test loss: 2.043, Global test accuracy: 32.18
Round   5, Train loss: 1.632, Test loss: 1.356, Test accuracy: 51.08
Round   5, Global train loss: 1.632, Global test loss: 1.814, Global test accuracy: 38.50
Round   6, Train loss: 1.387, Test loss: 1.345, Test accuracy: 50.90
Round   6, Global train loss: 1.387, Global test loss: 1.779, Global test accuracy: 35.64
Round   7, Train loss: 1.363, Test loss: 1.378, Test accuracy: 50.44
Round   7, Global train loss: 1.363, Global test loss: 2.019, Global test accuracy: 29.68
Round   8, Train loss: 1.343, Test loss: 1.350, Test accuracy: 52.46
Round   8, Global train loss: 1.343, Global test loss: 1.903, Global test accuracy: 35.26
Round   9, Train loss: 1.360, Test loss: 1.271, Test accuracy: 55.98
Round   9, Global train loss: 1.360, Global test loss: 1.712, Global test accuracy: 42.98
Round  10, Train loss: 1.558, Test loss: 1.254, Test accuracy: 59.52
Round  10, Global train loss: 1.558, Global test loss: 1.755, Global test accuracy: 46.32
Round  11, Train loss: 1.318, Test loss: 1.365, Test accuracy: 56.64
Round  11, Global train loss: 1.318, Global test loss: 1.922, Global test accuracy: 42.78
Round  12, Train loss: 1.299, Test loss: 1.195, Test accuracy: 60.40
Round  12, Global train loss: 1.299, Global test loss: 1.706, Global test accuracy: 44.00
Round  13, Train loss: 1.300, Test loss: 1.119, Test accuracy: 62.70
Round  13, Global train loss: 1.300, Global test loss: 1.599, Global test accuracy: 48.80
Round  14, Train loss: 1.366, Test loss: 1.051, Test accuracy: 65.10
Round  14, Global train loss: 1.366, Global test loss: 1.742, Global test accuracy: 41.46
Round  15, Train loss: 1.388, Test loss: 1.072, Test accuracy: 64.92
Round  15, Global train loss: 1.388, Global test loss: 1.617, Global test accuracy: 48.62
Round  16, Train loss: 1.361, Test loss: 1.046, Test accuracy: 65.42
Round  16, Global train loss: 1.361, Global test loss: 1.572, Global test accuracy: 49.78
Round  17, Train loss: 1.205, Test loss: 1.026, Test accuracy: 66.08
Round  17, Global train loss: 1.205, Global test loss: 1.509, Global test accuracy: 49.72
Round  18, Train loss: 1.407, Test loss: 1.025, Test accuracy: 66.46
Round  18, Global train loss: 1.407, Global test loss: 1.528, Global test accuracy: 52.02
Round  19, Train loss: 1.366, Test loss: 1.026, Test accuracy: 66.42
Round  19, Global train loss: 1.366, Global test loss: 1.509, Global test accuracy: 50.62
Round  20, Train loss: 1.283, Test loss: 1.003, Test accuracy: 66.30
Round  20, Global train loss: 1.283, Global test loss: 1.593, Global test accuracy: 49.92
Round  21, Train loss: 1.153, Test loss: 0.978, Test accuracy: 67.14
Round  21, Global train loss: 1.153, Global test loss: 1.449, Global test accuracy: 54.58
Round  22, Train loss: 1.168, Test loss: 0.984, Test accuracy: 66.94
Round  22, Global train loss: 1.168, Global test loss: 1.456, Global test accuracy: 53.40
Round  23, Train loss: 1.107, Test loss: 0.965, Test accuracy: 67.58
Round  23, Global train loss: 1.107, Global test loss: 1.546, Global test accuracy: 49.72
Round  24, Train loss: 1.175, Test loss: 0.968, Test accuracy: 67.68
Round  24, Global train loss: 1.175, Global test loss: 1.371, Global test accuracy: 59.12
Round  25, Train loss: 1.064, Test loss: 0.996, Test accuracy: 66.76
Round  25, Global train loss: 1.064, Global test loss: 1.558, Global test accuracy: 49.22
Round  26, Train loss: 0.900, Test loss: 0.990, Test accuracy: 67.22
Round  26, Global train loss: 0.900, Global test loss: 1.478, Global test accuracy: 53.90
Round  27, Train loss: 1.028, Test loss: 0.998, Test accuracy: 67.40
Round  27, Global train loss: 1.028, Global test loss: 1.297, Global test accuracy: 58.30
Round  28, Train loss: 0.817, Test loss: 0.983, Test accuracy: 67.76
Round  28, Global train loss: 0.817, Global test loss: 1.435, Global test accuracy: 52.92
Round  29, Train loss: 1.094, Test loss: 0.978, Test accuracy: 67.78
Round  29, Global train loss: 1.094, Global test loss: 1.579, Global test accuracy: 50.58
Round  30, Train loss: 1.124, Test loss: 0.994, Test accuracy: 67.96
Round  30, Global train loss: 1.124, Global test loss: 1.389, Global test accuracy: 55.30
Round  31, Train loss: 0.745, Test loss: 0.999, Test accuracy: 67.60
Round  31, Global train loss: 0.745, Global test loss: 1.421, Global test accuracy: 54.28
Round  32, Train loss: 0.681, Test loss: 1.003, Test accuracy: 68.40
Round  32, Global train loss: 0.681, Global test loss: 1.637, Global test accuracy: 53.04
Round  33, Train loss: 1.006, Test loss: 1.001, Test accuracy: 68.48
Round  33, Global train loss: 1.006, Global test loss: 1.494, Global test accuracy: 53.50
Round  34, Train loss: 0.959, Test loss: 0.990, Test accuracy: 69.20
Round  34, Global train loss: 0.959, Global test loss: 1.508, Global test accuracy: 54.54
Round  35, Train loss: 0.853, Test loss: 0.996, Test accuracy: 68.38
Round  35, Global train loss: 0.853, Global test loss: 1.639, Global test accuracy: 50.98
Round  36, Train loss: 1.040, Test loss: 1.010, Test accuracy: 67.60
Round  36, Global train loss: 1.040, Global test loss: 1.351, Global test accuracy: 56.26
Round  37, Train loss: 1.048, Test loss: 1.013, Test accuracy: 67.66
Round  37, Global train loss: 1.048, Global test loss: 1.455, Global test accuracy: 55.02
Round  38, Train loss: 0.832, Test loss: 1.022, Test accuracy: 67.80
Round  38, Global train loss: 0.832, Global test loss: 1.499, Global test accuracy: 55.78
Round  39, Train loss: 0.561, Test loss: 0.985, Test accuracy: 69.36
Round  39, Global train loss: 0.561, Global test loss: 1.660, Global test accuracy: 54.84
Round  40, Train loss: 0.630, Test loss: 0.975, Test accuracy: 70.18
Round  40, Global train loss: 0.630, Global test loss: 1.442, Global test accuracy: 57.56
Round  41, Train loss: 0.756, Test loss: 0.997, Test accuracy: 69.52
Round  41, Global train loss: 0.756, Global test loss: 1.297, Global test accuracy: 60.98
Round  42, Train loss: 0.766, Test loss: 0.982, Test accuracy: 69.60
Round  42, Global train loss: 0.766, Global test loss: 1.307, Global test accuracy: 59.10
Round  43, Train loss: 1.020, Test loss: 1.000, Test accuracy: 68.48
Round  43, Global train loss: 1.020, Global test loss: 1.425, Global test accuracy: 58.34
Round  44, Train loss: 0.770, Test loss: 1.025, Test accuracy: 67.54
Round  44, Global train loss: 0.770, Global test loss: 1.400, Global test accuracy: 54.94
Round  45, Train loss: 0.781, Test loss: 1.017, Test accuracy: 67.54
Round  45, Global train loss: 0.781, Global test loss: 1.397, Global test accuracy: 56.48
Round  46, Train loss: 0.936, Test loss: 1.013, Test accuracy: 67.70
Round  46, Global train loss: 0.936, Global test loss: 1.336, Global test accuracy: 59.82
Round  47, Train loss: 0.647, Test loss: 1.028, Test accuracy: 67.38
Round  47, Global train loss: 0.647, Global test loss: 1.602, Global test accuracy: 55.68
Round  48, Train loss: 0.794, Test loss: 1.026, Test accuracy: 67.86
Round  48, Global train loss: 0.794, Global test loss: 1.512, Global test accuracy: 54.44
Round  49, Train loss: 0.820, Test loss: 1.045, Test accuracy: 67.38
Round  49, Global train loss: 0.820, Global test loss: 1.448, Global test accuracy: 56.90
Round  50, Train loss: 0.712, Test loss: 1.101, Test accuracy: 66.28
Round  50, Global train loss: 0.712, Global test loss: 1.633, Global test accuracy: 54.10
Round  51, Train loss: 0.730, Test loss: 1.096, Test accuracy: 65.82
Round  51, Global train loss: 0.730, Global test loss: 1.580, Global test accuracy: 53.36
Round  52, Train loss: 0.658, Test loss: 1.118, Test accuracy: 65.38
Round  52, Global train loss: 0.658, Global test loss: 1.391, Global test accuracy: 57.64
Round  53, Train loss: 0.785, Test loss: 1.167, Test accuracy: 64.72
Round  53, Global train loss: 0.785, Global test loss: 1.432, Global test accuracy: 57.88
Round  54, Train loss: 0.722, Test loss: 1.116, Test accuracy: 66.32
Round  54, Global train loss: 0.722, Global test loss: 1.485, Global test accuracy: 55.94
Round  55, Train loss: 0.712, Test loss: 1.114, Test accuracy: 66.60
Round  55, Global train loss: 0.712, Global test loss: 1.539, Global test accuracy: 54.84
Round  56, Train loss: 0.830, Test loss: 1.136, Test accuracy: 65.22
Round  56, Global train loss: 0.830, Global test loss: 1.540, Global test accuracy: 52.98
Round  57, Train loss: 0.538, Test loss: 1.146, Test accuracy: 65.00
Round  57, Global train loss: 0.538, Global test loss: 1.638, Global test accuracy: 53.72
Round  58, Train loss: 0.518, Test loss: 1.143, Test accuracy: 65.26
Round  58, Global train loss: 0.518, Global test loss: 1.696, Global test accuracy: 55.44
Round  59, Train loss: 0.772, Test loss: 1.141, Test accuracy: 65.76
Round  59, Global train loss: 0.772, Global test loss: 1.601, Global test accuracy: 51.32
Round  60, Train loss: 0.520, Test loss: 1.193, Test accuracy: 65.82
Round  60, Global train loss: 0.520, Global test loss: 1.489, Global test accuracy: 57.50
Round  61, Train loss: 0.606, Test loss: 1.208, Test accuracy: 65.60
Round  61, Global train loss: 0.606, Global test loss: 1.599, Global test accuracy: 54.98
Round  62, Train loss: 0.628, Test loss: 1.212, Test accuracy: 65.52
Round  62, Global train loss: 0.628, Global test loss: 1.819, Global test accuracy: 51.22
Round  63, Train loss: 0.462, Test loss: 1.221, Test accuracy: 64.86
Round  63, Global train loss: 0.462, Global test loss: 1.723, Global test accuracy: 56.06
Round  64, Train loss: 0.618, Test loss: 1.247, Test accuracy: 63.72
Round  64, Global train loss: 0.618, Global test loss: 1.613, Global test accuracy: 53.32
Round  65, Train loss: 0.507, Test loss: 1.249, Test accuracy: 63.54
Round  65, Global train loss: 0.507, Global test loss: 1.672, Global test accuracy: 56.94
Round  66, Train loss: 0.358, Test loss: 1.247, Test accuracy: 64.06
Round  66, Global train loss: 0.358, Global test loss: 1.528, Global test accuracy: 60.00
Round  67, Train loss: 0.664, Test loss: 1.208, Test accuracy: 65.54
Round  67, Global train loss: 0.664, Global test loss: 1.662, Global test accuracy: 53.08
Round  68, Train loss: 0.448, Test loss: 1.233, Test accuracy: 65.58
Round  68, Global train loss: 0.448, Global test loss: 1.727, Global test accuracy: 55.84
Round  69, Train loss: 0.562, Test loss: 1.259, Test accuracy: 65.74
Round  69, Global train loss: 0.562, Global test loss: 1.705, Global test accuracy: 54.84
Round  70, Train loss: 0.423, Test loss: 1.284, Test accuracy: 65.08
Round  70, Global train loss: 0.423, Global test loss: 1.730, Global test accuracy: 57.84
Round  71, Train loss: 0.487, Test loss: 1.338, Test accuracy: 64.56
Round  71, Global train loss: 0.487, Global test loss: 1.509, Global test accuracy: 57.76
Round  72, Train loss: 0.447, Test loss: 1.334, Test accuracy: 65.20
Round  72, Global train loss: 0.447, Global test loss: 1.853, Global test accuracy: 52.96
Round  73, Train loss: 0.495, Test loss: 1.360, Test accuracy: 64.92
Round  73, Global train loss: 0.495, Global test loss: 1.932, Global test accuracy: 51.50
Round  74, Train loss: 0.531, Test loss: 1.377, Test accuracy: 64.30
Round  74, Global train loss: 0.531, Global test loss: 1.858, Global test accuracy: 50.30
Round  75, Train loss: 0.328, Test loss: 1.339, Test accuracy: 64.54
Round  75, Global train loss: 0.328, Global test loss: 1.917, Global test accuracy: 53.98
Round  76, Train loss: 0.546, Test loss: 1.372, Test accuracy: 64.52
Round  76, Global train loss: 0.546, Global test loss: 1.568, Global test accuracy: 56.02
Round  77, Train loss: 0.385, Test loss: 1.355, Test accuracy: 64.98
Round  77, Global train loss: 0.385, Global test loss: 1.938, Global test accuracy: 55.84
Round  78, Train loss: 0.378, Test loss: 1.376, Test accuracy: 64.40
Round  78, Global train loss: 0.378, Global test loss: 1.836, Global test accuracy: 56.26
Round  79, Train loss: 0.360, Test loss: 1.377, Test accuracy: 64.26
Round  79, Global train loss: 0.360, Global test loss: 1.642, Global test accuracy: 56.76
Round  80, Train loss: 0.595, Test loss: 1.385, Test accuracy: 64.42
Round  80, Global train loss: 0.595, Global test loss: 1.811, Global test accuracy: 53.18
Round  81, Train loss: 0.296, Test loss: 1.321, Test accuracy: 64.70
Round  81, Global train loss: 0.296, Global test loss: 1.638, Global test accuracy: 58.76
Round  82, Train loss: 0.354, Test loss: 1.387, Test accuracy: 64.54
Round  82, Global train loss: 0.354, Global test loss: 1.697, Global test accuracy: 57.32
Round  83, Train loss: 0.282, Test loss: 1.400, Test accuracy: 65.08
Round  83, Global train loss: 0.282, Global test loss: 1.925, Global test accuracy: 54.90
Round  84, Train loss: 0.365, Test loss: 1.421, Test accuracy: 65.52
Round  84, Global train loss: 0.365, Global test loss: 1.922, Global test accuracy: 53.50
Round  85, Train loss: 0.417, Test loss: 1.416, Test accuracy: 65.38
Round  85, Global train loss: 0.417, Global test loss: 1.687, Global test accuracy: 55.62
Round  86, Train loss: 0.449, Test loss: 1.390, Test accuracy: 66.68
Round  86, Global train loss: 0.449, Global test loss: 1.946, Global test accuracy: 53.70
Round  87, Train loss: 0.404, Test loss: 1.405, Test accuracy: 66.50
Round  87, Global train loss: 0.404, Global test loss: 1.754, Global test accuracy: 55.68
Round  88, Train loss: 0.247, Test loss: 1.394, Test accuracy: 66.12
Round  88, Global train loss: 0.247, Global test loss: 1.699, Global test accuracy: 59.88
Round  89, Train loss: 0.443, Test loss: 1.428, Test accuracy: 65.52
Round  89, Global train loss: 0.443, Global test loss: 1.824, Global test accuracy: 55.62
Round  90, Train loss: 0.345, Test loss: 1.442, Test accuracy: 65.38
Round  90, Global train loss: 0.345, Global test loss: 1.891, Global test accuracy: 54.84
Round  91, Train loss: 0.265, Test loss: 1.436, Test accuracy: 65.56
Round  91, Global train loss: 0.265, Global test loss: 1.828, Global test accuracy: 54.78
Round  92, Train loss: 0.344, Test loss: 1.465, Test accuracy: 65.38
Round  92, Global train loss: 0.344, Global test loss: 1.770, Global test accuracy: 59.48
Round  93, Train loss: 0.291, Test loss: 1.481, Test accuracy: 65.52
Round  93, Global train loss: 0.291, Global test loss: 1.986, Global test accuracy: 56.72
Round  94, Train loss: 0.436, Test loss: 1.489, Test accuracy: 64.42
Round  94, Global train loss: 0.436, Global test loss: 1.833, Global test accuracy: 53.98
Round  95, Train loss: 0.306, Test loss: 1.504, Test accuracy: 64.84
Round  95, Global train loss: 0.306, Global test loss: 1.946, Global test accuracy: 55.04
Round  96, Train loss: 0.293, Test loss: 1.516, Test accuracy: 64.32
Round  96, Global train loss: 0.293, Global test loss: 1.888, Global test accuracy: 53.98
Round  97, Train loss: 0.245, Test loss: 1.545, Test accuracy: 63.94
Round  97, Global train loss: 0.245, Global test loss: 1.858, Global test accuracy: 56.86
Round  98, Train loss: 0.339, Test loss: 1.543, Test accuracy: 64.60
Round  98, Global train loss: 0.339, Global test loss: 1.758, Global test accuracy: 60.16
Round  99, Train loss: 0.290, Test loss: 1.545, Test accuracy: 64.64
Round  99, Global train loss: 0.290, Global test loss: 1.785, Global test accuracy: 60.20
Final Round, Train loss: 0.266, Test loss: 1.582, Test accuracy: 65.16
Final Round, Global train loss: 0.266, Global test loss: 1.785, Global test accuracy: 60.20
Average accuracy final 10 rounds: 64.86
Average global accuracy final 10 rounds: 56.604000000000006
1272.3983161449432
[3.5421924591064453, 6.604377269744873, 9.661874532699585, 12.688079118728638, 15.712388515472412, 18.720418214797974, 21.7358500957489, 24.784270763397217, 27.84803557395935, 30.905380249023438, 33.90479564666748, 37.05169653892517, 40.175798416137695, 43.300015687942505, 46.35002779960632, 49.447951555252075, 52.54443645477295, 55.65347170829773, 58.73977327346802, 61.805140256881714, 64.8948245048523, 68.00783157348633, 71.17641353607178, 74.26085758209229, 77.42930889129639, 80.45196914672852, 83.59897041320801, 86.67144346237183, 89.75745439529419, 92.83756256103516, 95.96087145805359, 99.10416865348816, 102.27342486381531, 105.34231901168823, 108.48639583587646, 111.66433548927307, 114.77586889266968, 117.89020895957947, 120.96423125267029, 124.0663583278656, 127.1843421459198, 130.28275418281555, 133.3665771484375, 136.43592166900635, 139.5521650314331, 142.60847115516663, 145.71730422973633, 148.87364292144775, 152.0143575668335, 155.08844900131226, 158.15963506698608, 161.28755950927734, 164.40322422981262, 167.66386342048645, 170.9388885498047, 174.04084277153015, 177.12025356292725, 180.26701092720032, 183.3863627910614, 186.49410700798035, 189.6875500679016, 192.78717517852783, 195.92143559455872, 199.06944632530212, 202.146342754364, 205.29305601119995, 208.43107771873474, 211.49545574188232, 214.49692630767822, 217.5840892791748, 220.68236827850342, 223.69025135040283, 226.75906229019165, 229.82322454452515, 232.88626790046692, 235.9130277633667, 238.98074412345886, 242.06607341766357, 245.1042628288269, 248.16166877746582, 251.25151443481445, 254.32360410690308, 257.4391484260559, 260.56935811042786, 263.62637639045715, 266.71295857429504, 269.80635595321655, 272.9131429195404, 275.9954376220703, 279.16720032691956, 282.27404594421387, 285.36696887016296, 288.40415477752686, 291.63645815849304, 294.8136737346649, 297.8445420265198, 300.847309589386, 304.00661158561707, 307.01423931121826, 310.05913376808167, 315.3727054595947]
[16.12, 34.86, 38.36, 47.16, 47.78, 51.08, 50.9, 50.44, 52.46, 55.98, 59.52, 56.64, 60.4, 62.7, 65.1, 64.92, 65.42, 66.08, 66.46, 66.42, 66.3, 67.14, 66.94, 67.58, 67.68, 66.76, 67.22, 67.4, 67.76, 67.78, 67.96, 67.6, 68.4, 68.48, 69.2, 68.38, 67.6, 67.66, 67.8, 69.36, 70.18, 69.52, 69.6, 68.48, 67.54, 67.54, 67.7, 67.38, 67.86, 67.38, 66.28, 65.82, 65.38, 64.72, 66.32, 66.6, 65.22, 65.0, 65.26, 65.76, 65.82, 65.6, 65.52, 64.86, 63.72, 63.54, 64.06, 65.54, 65.58, 65.74, 65.08, 64.56, 65.2, 64.92, 64.3, 64.54, 64.52, 64.98, 64.4, 64.26, 64.42, 64.7, 64.54, 65.08, 65.52, 65.38, 66.68, 66.5, 66.12, 65.52, 65.38, 65.56, 65.38, 65.52, 64.42, 64.84, 64.32, 63.94, 64.6, 64.64, 65.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.044, Test loss: 2.252, Test accuracy: 12.10
Round   0, Global train loss: 2.044, Global test loss: 2.334, Global test accuracy: 10.50
Round   1, Train loss: 1.755, Test loss: 1.909, Test accuracy: 33.86
Round   1, Global train loss: 1.755, Global test loss: 2.232, Global test accuracy: 19.66
Round   2, Train loss: 1.823, Test loss: 1.752, Test accuracy: 37.08
Round   2, Global train loss: 1.823, Global test loss: 2.372, Global test accuracy: 12.14
Round   3, Train loss: 1.607, Test loss: 1.549, Test accuracy: 45.32
Round   3, Global train loss: 1.607, Global test loss: 2.025, Global test accuracy: 29.78
Round   4, Train loss: 1.522, Test loss: 1.553, Test accuracy: 45.44
Round   4, Global train loss: 1.522, Global test loss: 2.149, Global test accuracy: 28.24
Round   5, Train loss: 1.532, Test loss: 1.482, Test accuracy: 49.44
Round   5, Global train loss: 1.532, Global test loss: 2.023, Global test accuracy: 29.12
Round   6, Train loss: 1.490, Test loss: 1.418, Test accuracy: 51.06
Round   6, Global train loss: 1.490, Global test loss: 1.907, Global test accuracy: 34.56
Round   7, Train loss: 1.549, Test loss: 1.468, Test accuracy: 48.30
Round   7, Global train loss: 1.549, Global test loss: 2.132, Global test accuracy: 22.22
Round   8, Train loss: 1.376, Test loss: 1.429, Test accuracy: 52.18
Round   8, Global train loss: 1.376, Global test loss: 2.057, Global test accuracy: 31.36
Round   9, Train loss: 1.347, Test loss: 1.337, Test accuracy: 54.78
Round   9, Global train loss: 1.347, Global test loss: 1.828, Global test accuracy: 38.82
Round  10, Train loss: 1.661, Test loss: 1.351, Test accuracy: 55.40
Round  10, Global train loss: 1.661, Global test loss: 2.085, Global test accuracy: 35.92
Round  11, Train loss: 1.331, Test loss: 1.428, Test accuracy: 53.60
Round  11, Global train loss: 1.331, Global test loss: 2.074, Global test accuracy: 36.90
Round  12, Train loss: 1.336, Test loss: 1.230, Test accuracy: 58.32
Round  12, Global train loss: 1.336, Global test loss: 2.022, Global test accuracy: 27.88
Round  13, Train loss: 1.418, Test loss: 1.188, Test accuracy: 60.64
Round  13, Global train loss: 1.418, Global test loss: 1.929, Global test accuracy: 41.12
Round  14, Train loss: 1.437, Test loss: 1.093, Test accuracy: 63.28
Round  14, Global train loss: 1.437, Global test loss: 1.992, Global test accuracy: 25.90
Round  15, Train loss: 1.221, Test loss: 1.117, Test accuracy: 63.06
Round  15, Global train loss: 1.221, Global test loss: 1.866, Global test accuracy: 36.42
Round  16, Train loss: 1.240, Test loss: 1.084, Test accuracy: 63.78
Round  16, Global train loss: 1.240, Global test loss: 1.799, Global test accuracy: 45.26
Round  17, Train loss: 1.421, Test loss: 1.080, Test accuracy: 65.46
Round  17, Global train loss: 1.421, Global test loss: 1.948, Global test accuracy: 22.30
Round  18, Train loss: 1.259, Test loss: 1.046, Test accuracy: 65.96
Round  18, Global train loss: 1.259, Global test loss: 1.763, Global test accuracy: 44.24
Round  19, Train loss: 1.529, Test loss: 1.055, Test accuracy: 68.36
Round  19, Global train loss: 1.529, Global test loss: 1.966, Global test accuracy: 26.94
Round  20, Train loss: 1.128, Test loss: 1.018, Test accuracy: 68.88
Round  20, Global train loss: 1.128, Global test loss: 1.790, Global test accuracy: 37.72
Round  21, Train loss: 1.131, Test loss: 0.999, Test accuracy: 69.40
Round  21, Global train loss: 1.131, Global test loss: 1.681, Global test accuracy: 44.56
Round  22, Train loss: 1.169, Test loss: 1.034, Test accuracy: 69.24
Round  22, Global train loss: 1.169, Global test loss: 1.761, Global test accuracy: 38.42
Round  23, Train loss: 1.158, Test loss: 0.982, Test accuracy: 68.58
Round  23, Global train loss: 1.158, Global test loss: 1.979, Global test accuracy: 35.50
Round  24, Train loss: 1.183, Test loss: 1.003, Test accuracy: 69.04
Round  24, Global train loss: 1.183, Global test loss: 1.782, Global test accuracy: 46.30
Round  25, Train loss: 1.304, Test loss: 0.952, Test accuracy: 71.08
Round  25, Global train loss: 1.304, Global test loss: 1.930, Global test accuracy: 31.52
Round  26, Train loss: 1.074, Test loss: 0.955, Test accuracy: 71.44
Round  26, Global train loss: 1.074, Global test loss: 1.835, Global test accuracy: 34.28
Round  27, Train loss: 1.268, Test loss: 0.983, Test accuracy: 72.00
Round  27, Global train loss: 1.268, Global test loss: 1.773, Global test accuracy: 43.76
Round  28, Train loss: 1.028, Test loss: 0.958, Test accuracy: 71.42
Round  28, Global train loss: 1.028, Global test loss: 1.840, Global test accuracy: 34.40
Round  29, Train loss: 1.239, Test loss: 0.912, Test accuracy: 70.72
Round  29, Global train loss: 1.239, Global test loss: 1.928, Global test accuracy: 35.30
Round  30, Train loss: 1.211, Test loss: 0.927, Test accuracy: 71.28
Round  30, Global train loss: 1.211, Global test loss: 1.637, Global test accuracy: 42.52
Round  31, Train loss: 1.200, Test loss: 0.947, Test accuracy: 70.18
Round  31, Global train loss: 1.200, Global test loss: 2.000, Global test accuracy: 27.34
Round  32, Train loss: 1.199, Test loss: 0.882, Test accuracy: 71.50
Round  32, Global train loss: 1.199, Global test loss: 2.013, Global test accuracy: 33.00
Round  33, Train loss: 1.174, Test loss: 0.890, Test accuracy: 72.02
Round  33, Global train loss: 1.174, Global test loss: 1.914, Global test accuracy: 36.30
Round  34, Train loss: 1.076, Test loss: 0.870, Test accuracy: 72.34
Round  34, Global train loss: 1.076, Global test loss: 2.050, Global test accuracy: 39.20
Round  35, Train loss: 1.215, Test loss: 0.868, Test accuracy: 73.50
Round  35, Global train loss: 1.215, Global test loss: 2.018, Global test accuracy: 36.30
Round  36, Train loss: 1.312, Test loss: 0.890, Test accuracy: 72.52
Round  36, Global train loss: 1.312, Global test loss: 1.912, Global test accuracy: 41.46
Round  37, Train loss: 1.002, Test loss: 0.885, Test accuracy: 72.84
Round  37, Global train loss: 1.002, Global test loss: 1.669, Global test accuracy: 51.34
Round  38, Train loss: 1.254, Test loss: 0.874, Test accuracy: 73.98
Round  38, Global train loss: 1.254, Global test loss: 1.897, Global test accuracy: 28.58
Round  39, Train loss: 1.111, Test loss: 0.898, Test accuracy: 72.58
Round  39, Global train loss: 1.111, Global test loss: 1.918, Global test accuracy: 35.76
Round  40, Train loss: 0.889, Test loss: 0.869, Test accuracy: 72.76
Round  40, Global train loss: 0.889, Global test loss: 1.862, Global test accuracy: 34.48
Round  41, Train loss: 0.980, Test loss: 0.810, Test accuracy: 74.36
Round  41, Global train loss: 0.980, Global test loss: 1.545, Global test accuracy: 44.38
Round  42, Train loss: 1.143, Test loss: 0.832, Test accuracy: 74.08
Round  42, Global train loss: 1.143, Global test loss: 1.674, Global test accuracy: 39.06
Round  43, Train loss: 0.973, Test loss: 0.843, Test accuracy: 73.56
Round  43, Global train loss: 0.973, Global test loss: 1.637, Global test accuracy: 44.80
Round  44, Train loss: 0.689, Test loss: 0.810, Test accuracy: 74.00
Round  44, Global train loss: 0.689, Global test loss: 1.526, Global test accuracy: 48.54
Round  45, Train loss: 0.921, Test loss: 0.822, Test accuracy: 73.84
Round  45, Global train loss: 0.921, Global test loss: 1.687, Global test accuracy: 46.62
Round  46, Train loss: 1.103, Test loss: 0.814, Test accuracy: 74.68
Round  46, Global train loss: 1.103, Global test loss: 1.725, Global test accuracy: 46.38
Round  47, Train loss: 0.839, Test loss: 0.842, Test accuracy: 74.74
Round  47, Global train loss: 0.839, Global test loss: 1.683, Global test accuracy: 47.24
Round  48, Train loss: 0.761, Test loss: 0.833, Test accuracy: 73.86
Round  48, Global train loss: 0.761, Global test loss: 1.770, Global test accuracy: 39.86
Round  49, Train loss: 1.028, Test loss: 0.814, Test accuracy: 74.68
Round  49, Global train loss: 1.028, Global test loss: 1.745, Global test accuracy: 46.56
Round  50, Train loss: 0.964, Test loss: 0.830, Test accuracy: 74.00
Round  50, Global train loss: 0.964, Global test loss: 1.792, Global test accuracy: 43.94
Round  51, Train loss: 0.718, Test loss: 0.815, Test accuracy: 74.60
Round  51, Global train loss: 0.718, Global test loss: 1.801, Global test accuracy: 46.98
Round  52, Train loss: 1.005, Test loss: 0.820, Test accuracy: 74.60
Round  52, Global train loss: 1.005, Global test loss: 1.754, Global test accuracy: 37.02
Round  53, Train loss: 1.079, Test loss: 0.810, Test accuracy: 74.56
Round  53, Global train loss: 1.079, Global test loss: 1.703, Global test accuracy: 45.14
Round  54, Train loss: 0.736, Test loss: 0.795, Test accuracy: 75.04
Round  54, Global train loss: 0.736, Global test loss: 1.498, Global test accuracy: 53.78
Round  55, Train loss: 0.804, Test loss: 0.789, Test accuracy: 74.62
Round  55, Global train loss: 0.804, Global test loss: 1.564, Global test accuracy: 54.02
Round  56, Train loss: 0.856, Test loss: 0.783, Test accuracy: 74.86
Round  56, Global train loss: 0.856, Global test loss: 1.476, Global test accuracy: 47.64
Round  57, Train loss: 0.730, Test loss: 0.815, Test accuracy: 73.92
Round  57, Global train loss: 0.730, Global test loss: 1.607, Global test accuracy: 51.92
Round  58, Train loss: 0.910, Test loss: 0.791, Test accuracy: 75.36
Round  58, Global train loss: 0.910, Global test loss: 1.876, Global test accuracy: 33.22
Round  59, Train loss: 0.960, Test loss: 0.771, Test accuracy: 75.60
Round  59, Global train loss: 0.960, Global test loss: 1.513, Global test accuracy: 47.90
Round  60, Train loss: 0.851, Test loss: 0.760, Test accuracy: 76.12
Round  60, Global train loss: 0.851, Global test loss: 1.351, Global test accuracy: 58.00
Round  61, Train loss: 0.730, Test loss: 0.794, Test accuracy: 74.88
Round  61, Global train loss: 0.730, Global test loss: 1.691, Global test accuracy: 43.20
Round  62, Train loss: 0.902, Test loss: 0.778, Test accuracy: 75.04
Round  62, Global train loss: 0.902, Global test loss: 1.830, Global test accuracy: 40.98
Round  63, Train loss: 0.516, Test loss: 0.804, Test accuracy: 75.14
Round  63, Global train loss: 0.516, Global test loss: 1.716, Global test accuracy: 49.12
Round  64, Train loss: 1.028, Test loss: 0.799, Test accuracy: 74.12
Round  64, Global train loss: 1.028, Global test loss: 1.653, Global test accuracy: 53.86
Round  65, Train loss: 0.760, Test loss: 0.795, Test accuracy: 75.12
Round  65, Global train loss: 0.760, Global test loss: 1.950, Global test accuracy: 42.62
Round  66, Train loss: 0.706, Test loss: 0.790, Test accuracy: 74.74
Round  66, Global train loss: 0.706, Global test loss: 1.626, Global test accuracy: 47.00
Round  67, Train loss: 1.053, Test loss: 0.812, Test accuracy: 74.76
Round  67, Global train loss: 1.053, Global test loss: 1.904, Global test accuracy: 37.94
Round  68, Train loss: 0.715, Test loss: 0.802, Test accuracy: 74.44
Round  68, Global train loss: 0.715, Global test loss: 1.646, Global test accuracy: 48.10
Round  69, Train loss: 0.889, Test loss: 0.814, Test accuracy: 73.80
Round  69, Global train loss: 0.889, Global test loss: 1.734, Global test accuracy: 42.40
Round  70, Train loss: 0.629, Test loss: 0.816, Test accuracy: 73.06
Round  70, Global train loss: 0.629, Global test loss: 1.552, Global test accuracy: 49.08
Round  71, Train loss: 0.867, Test loss: 0.810, Test accuracy: 74.08
Round  71, Global train loss: 0.867, Global test loss: 1.526, Global test accuracy: 47.38
Round  72, Train loss: 0.580, Test loss: 0.826, Test accuracy: 73.20
Round  72, Global train loss: 0.580, Global test loss: 1.802, Global test accuracy: 43.72
Round  73, Train loss: 0.956, Test loss: 0.828, Test accuracy: 73.12
Round  73, Global train loss: 0.956, Global test loss: 2.245, Global test accuracy: 32.28
Round  74, Train loss: 0.965, Test loss: 0.826, Test accuracy: 73.64
Round  74, Global train loss: 0.965, Global test loss: 1.993, Global test accuracy: 37.18
Round  75, Train loss: 0.781, Test loss: 0.825, Test accuracy: 73.52
Round  75, Global train loss: 0.781, Global test loss: 1.632, Global test accuracy: 44.72
Round  76, Train loss: 0.841, Test loss: 0.820, Test accuracy: 73.82
Round  76, Global train loss: 0.841, Global test loss: 1.560, Global test accuracy: 46.84
Round  77, Train loss: 0.655, Test loss: 0.802, Test accuracy: 74.66
Round  77, Global train loss: 0.655, Global test loss: 2.093, Global test accuracy: 42.92
Round  78, Train loss: 0.465, Test loss: 0.785, Test accuracy: 74.82
Round  78, Global train loss: 0.465, Global test loss: 1.572, Global test accuracy: 49.30
Round  79, Train loss: 0.758, Test loss: 0.784, Test accuracy: 74.86
Round  79, Global train loss: 0.758, Global test loss: 1.475, Global test accuracy: 50.48
Round  80, Train loss: 0.652, Test loss: 0.834, Test accuracy: 73.28
Round  80, Global train loss: 0.652, Global test loss: 1.944, Global test accuracy: 41.54
Round  81, Train loss: 0.660, Test loss: 0.797, Test accuracy: 74.72
Round  81, Global train loss: 0.660, Global test loss: 1.719, Global test accuracy: 46.82
Round  82, Train loss: 0.494, Test loss: 0.823, Test accuracy: 73.98
Round  82, Global train loss: 0.494, Global test loss: 1.379, Global test accuracy: 57.74
Round  83, Train loss: 0.781, Test loss: 0.806, Test accuracy: 74.46
Round  83, Global train loss: 0.781, Global test loss: 1.840, Global test accuracy: 48.82
Round  84, Train loss: 0.777, Test loss: 0.809, Test accuracy: 73.58
Round  84, Global train loss: 0.777, Global test loss: 1.938, Global test accuracy: 39.30
Round  85, Train loss: 0.635, Test loss: 0.825, Test accuracy: 72.50
Round  85, Global train loss: 0.635, Global test loss: 1.520, Global test accuracy: 52.52
Round  86, Train loss: 0.673, Test loss: 0.841, Test accuracy: 72.24
Round  86, Global train loss: 0.673, Global test loss: 1.615, Global test accuracy: 42.84
Round  87, Train loss: 0.952, Test loss: 0.813, Test accuracy: 72.96
Round  87, Global train loss: 0.952, Global test loss: 2.022, Global test accuracy: 39.58
Round  88, Train loss: 0.742, Test loss: 0.815, Test accuracy: 73.74
Round  88, Global train loss: 0.742, Global test loss: 1.692, Global test accuracy: 44.18
Round  89, Train loss: 0.652, Test loss: 0.823, Test accuracy: 72.72
Round  89, Global train loss: 0.652, Global test loss: 1.622, Global test accuracy: 43.92
Round  90, Train loss: 0.563, Test loss: 0.842, Test accuracy: 73.02
Round  90, Global train loss: 0.563, Global test loss: 1.891, Global test accuracy: 39.00
Round  91, Train loss: 0.482, Test loss: 0.877, Test accuracy: 71.48
Round  91, Global train loss: 0.482, Global test loss: 1.886, Global test accuracy: 38.54
Round  92, Train loss: 0.650, Test loss: 0.833, Test accuracy: 71.94
Round  92, Global train loss: 0.650, Global test loss: 1.760, Global test accuracy: 48.10
Round  93, Train loss: 0.667, Test loss: 0.856, Test accuracy: 71.92
Round  93, Global train loss: 0.667, Global test loss: 2.232, Global test accuracy: 30.82
Round  94, Train loss: 0.570, Test loss: 0.833, Test accuracy: 72.34
Round  94, Global train loss: 0.570, Global test loss: 1.432, Global test accuracy: 51.20
Round  95, Train loss: 0.652, Test loss: 0.855, Test accuracy: 72.02
Round  95, Global train loss: 0.652, Global test loss: 1.661, Global test accuracy: 45.34
Round  96, Train loss: 0.603, Test loss: 0.870, Test accuracy: 71.26
Round  96, Global train loss: 0.603, Global test loss: 1.687, Global test accuracy: 44.00
Round  97, Train loss: 0.560, Test loss: 0.841, Test accuracy: 72.88
Round  97, Global train loss: 0.560, Global test loss: 1.308, Global test accuracy: 57.92
Round  98, Train loss: 0.524, Test loss: 0.859, Test accuracy: 72.18
Round  98, Global train loss: 0.524, Global test loss: 1.430, Global test accuracy: 53.20
Round  99, Train loss: 0.640, Test loss: 0.876, Test accuracy: 71.52
Round  99, Global train loss: 0.640, Global test loss: 1.674, Global test accuracy: 45.28
Final Round, Train loss: 0.505, Test loss: 0.866, Test accuracy: 72.10
Final Round, Global train loss: 0.505, Global test loss: 1.674, Global test accuracy: 45.28
Average accuracy final 10 rounds: 72.056
732.9723002910614
[1.787686824798584, 3.221613645553589, 4.616288423538208, 6.018460035324097, 7.484846591949463, 8.890257596969604, 10.28632640838623, 11.663619756698608, 13.076122283935547, 14.431683778762817, 15.808040380477905, 17.19605827331543, 18.584619998931885, 19.936859846115112, 21.28708052635193, 22.667495727539062, 24.058626413345337, 25.444448471069336, 26.8152973651886, 28.209487915039062, 29.59967827796936, 31.035274744033813, 32.4725387096405, 33.86942648887634, 35.319278717041016, 36.79797649383545, 38.184638023376465, 39.54973649978638, 40.911104917526245, 42.31268334388733, 43.69974732398987, 45.114272356033325, 46.49771189689636, 47.90350556373596, 49.28005290031433, 50.66880774497986, 52.121273040771484, 53.486300468444824, 54.86874294281006, 56.29402303695679, 57.70405912399292, 59.09345602989197, 60.51093125343323, 61.93125081062317, 63.4517548084259, 64.88497614860535, 66.27376437187195, 67.72748398780823, 69.21453809738159, 70.63562655448914, 72.107581615448, 73.48614311218262, 74.87544822692871, 76.32485675811768, 77.72717070579529, 79.11515593528748, 80.55487108230591, 81.93725776672363, 83.40623998641968, 84.8682062625885, 86.27000546455383, 87.6764075756073, 89.04527115821838, 90.41401720046997, 91.78592991828918, 93.18813300132751, 94.5889675617218, 95.99514651298523, 97.38778018951416, 98.77044320106506, 100.14592981338501, 101.5600335597992, 102.94792795181274, 104.35009360313416, 105.72176051139832, 107.10181736946106, 108.47554039955139, 109.86600995063782, 111.25472688674927, 112.67323279380798, 114.11473321914673, 115.5285701751709, 116.93851661682129, 118.32240581512451, 119.77775120735168, 121.28312063217163, 122.76405596733093, 124.21900463104248, 125.60037279129028, 127.01586484909058, 128.41048550605774, 129.83130073547363, 131.2232587337494, 132.6244878768921, 134.02459073066711, 135.41500163078308, 136.79448986053467, 138.19944977760315, 139.62005233764648, 141.00582671165466, 143.30521440505981]
[12.1, 33.86, 37.08, 45.32, 45.44, 49.44, 51.06, 48.3, 52.18, 54.78, 55.4, 53.6, 58.32, 60.64, 63.28, 63.06, 63.78, 65.46, 65.96, 68.36, 68.88, 69.4, 69.24, 68.58, 69.04, 71.08, 71.44, 72.0, 71.42, 70.72, 71.28, 70.18, 71.5, 72.02, 72.34, 73.5, 72.52, 72.84, 73.98, 72.58, 72.76, 74.36, 74.08, 73.56, 74.0, 73.84, 74.68, 74.74, 73.86, 74.68, 74.0, 74.6, 74.6, 74.56, 75.04, 74.62, 74.86, 73.92, 75.36, 75.6, 76.12, 74.88, 75.04, 75.14, 74.12, 75.12, 74.74, 74.76, 74.44, 73.8, 73.06, 74.08, 73.2, 73.12, 73.64, 73.52, 73.82, 74.66, 74.82, 74.86, 73.28, 74.72, 73.98, 74.46, 73.58, 72.5, 72.24, 72.96, 73.74, 72.72, 73.02, 71.48, 71.94, 71.92, 72.34, 72.02, 71.26, 72.88, 72.18, 71.52, 72.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.039, Test loss: 1.906, Test accuracy: 37.66
Round   0, Global train loss: 2.039, Global test loss: 2.214, Global test accuracy: 27.10
Round   1, Train loss: 1.757, Test loss: 1.519, Test accuracy: 46.00
Round   1, Global train loss: 1.757, Global test loss: 2.060, Global test accuracy: 31.04
Round   2, Train loss: 1.640, Test loss: 1.403, Test accuracy: 50.44
Round   2, Global train loss: 1.640, Global test loss: 1.982, Global test accuracy: 33.38
Round   3, Train loss: 1.588, Test loss: 1.322, Test accuracy: 52.74
Round   3, Global train loss: 1.588, Global test loss: 1.932, Global test accuracy: 36.58
Round   4, Train loss: 1.551, Test loss: 1.272, Test accuracy: 55.40
Round   4, Global train loss: 1.551, Global test loss: 1.898, Global test accuracy: 38.36
Round   5, Train loss: 1.514, Test loss: 1.243, Test accuracy: 56.48
Round   5, Global train loss: 1.514, Global test loss: 1.868, Global test accuracy: 39.36
Round   6, Train loss: 1.494, Test loss: 1.207, Test accuracy: 59.34
Round   6, Global train loss: 1.494, Global test loss: 1.839, Global test accuracy: 40.68
Round   7, Train loss: 1.463, Test loss: 1.177, Test accuracy: 60.60
Round   7, Global train loss: 1.463, Global test loss: 1.813, Global test accuracy: 43.56
Round   8, Train loss: 1.439, Test loss: 1.148, Test accuracy: 61.16
Round   8, Global train loss: 1.439, Global test loss: 1.794, Global test accuracy: 44.36
Round   9, Train loss: 1.413, Test loss: 1.116, Test accuracy: 62.68
Round   9, Global train loss: 1.413, Global test loss: 1.760, Global test accuracy: 46.28
Round  10, Train loss: 1.304, Test loss: 1.076, Test accuracy: 62.90
Round  10, Global train loss: 1.304, Global test loss: 2.066, Global test accuracy: 33.82
Round  11, Train loss: 1.215, Test loss: 1.072, Test accuracy: 62.94
Round  11, Global train loss: 1.215, Global test loss: 2.047, Global test accuracy: 35.10
Round  12, Train loss: 1.298, Test loss: 1.061, Test accuracy: 62.36
Round  12, Global train loss: 1.298, Global test loss: 1.928, Global test accuracy: 35.10
Round  13, Train loss: 1.261, Test loss: 1.017, Test accuracy: 66.16
Round  13, Global train loss: 1.261, Global test loss: 1.851, Global test accuracy: 42.26
Round  14, Train loss: 1.309, Test loss: 1.045, Test accuracy: 63.86
Round  14, Global train loss: 1.309, Global test loss: 2.342, Global test accuracy: 26.10
Round  15, Train loss: 1.185, Test loss: 1.019, Test accuracy: 66.06
Round  15, Global train loss: 1.185, Global test loss: 1.756, Global test accuracy: 42.46
Round  16, Train loss: 1.194, Test loss: 1.018, Test accuracy: 65.86
Round  16, Global train loss: 1.194, Global test loss: 2.084, Global test accuracy: 44.90
Round  17, Train loss: 1.179, Test loss: 1.004, Test accuracy: 66.92
Round  17, Global train loss: 1.179, Global test loss: 2.080, Global test accuracy: 25.08
Round  18, Train loss: 1.133, Test loss: 0.967, Test accuracy: 68.46
Round  18, Global train loss: 1.133, Global test loss: 1.752, Global test accuracy: 40.42
Round  19, Train loss: 1.174, Test loss: 0.957, Test accuracy: 68.42
Round  19, Global train loss: 1.174, Global test loss: 2.058, Global test accuracy: 35.66
Round  20, Train loss: 1.111, Test loss: 0.971, Test accuracy: 67.72
Round  20, Global train loss: 1.111, Global test loss: 1.803, Global test accuracy: 41.68
Round  21, Train loss: 1.050, Test loss: 0.937, Test accuracy: 69.30
Round  21, Global train loss: 1.050, Global test loss: 1.543, Global test accuracy: 51.06
Round  22, Train loss: 1.041, Test loss: 0.927, Test accuracy: 70.92
Round  22, Global train loss: 1.041, Global test loss: 1.692, Global test accuracy: 41.78
Round  23, Train loss: 0.975, Test loss: 0.962, Test accuracy: 67.96
Round  23, Global train loss: 0.975, Global test loss: 1.763, Global test accuracy: 39.20
Round  24, Train loss: 1.065, Test loss: 0.939, Test accuracy: 68.66
Round  24, Global train loss: 1.065, Global test loss: 2.053, Global test accuracy: 40.82
Round  25, Train loss: 1.194, Test loss: 0.904, Test accuracy: 70.02
Round  25, Global train loss: 1.194, Global test loss: 2.420, Global test accuracy: 24.22
Round  26, Train loss: 0.962, Test loss: 0.905, Test accuracy: 69.46
Round  26, Global train loss: 0.962, Global test loss: 1.935, Global test accuracy: 35.40
Round  27, Train loss: 1.000, Test loss: 0.875, Test accuracy: 72.22
Round  27, Global train loss: 1.000, Global test loss: 1.843, Global test accuracy: 37.82
Round  28, Train loss: 0.964, Test loss: 0.859, Test accuracy: 71.62
Round  28, Global train loss: 0.964, Global test loss: 1.858, Global test accuracy: 38.98
Round  29, Train loss: 1.015, Test loss: 0.881, Test accuracy: 71.42
Round  29, Global train loss: 1.015, Global test loss: 1.977, Global test accuracy: 33.78
Round  30, Train loss: 0.974, Test loss: 0.852, Test accuracy: 72.50
Round  30, Global train loss: 0.974, Global test loss: 1.594, Global test accuracy: 41.06
Round  31, Train loss: 0.959, Test loss: 0.866, Test accuracy: 72.18
Round  31, Global train loss: 0.959, Global test loss: 2.124, Global test accuracy: 27.00
Round  32, Train loss: 0.985, Test loss: 0.843, Test accuracy: 73.16
Round  32, Global train loss: 0.985, Global test loss: 2.086, Global test accuracy: 32.28
Round  33, Train loss: 0.949, Test loss: 0.865, Test accuracy: 72.42
Round  33, Global train loss: 0.949, Global test loss: 1.965, Global test accuracy: 35.44
Round  34, Train loss: 1.087, Test loss: 0.854, Test accuracy: 72.62
Round  34, Global train loss: 1.087, Global test loss: 2.183, Global test accuracy: 33.28
Round  35, Train loss: 1.033, Test loss: 0.864, Test accuracy: 72.90
Round  35, Global train loss: 1.033, Global test loss: 2.107, Global test accuracy: 34.28
Round  36, Train loss: 0.958, Test loss: 0.852, Test accuracy: 74.02
Round  36, Global train loss: 0.958, Global test loss: 1.985, Global test accuracy: 36.74
Round  37, Train loss: 0.987, Test loss: 0.846, Test accuracy: 73.36
Round  37, Global train loss: 0.987, Global test loss: 1.935, Global test accuracy: 50.36
Round  38, Train loss: 1.041, Test loss: 0.850, Test accuracy: 73.66
Round  38, Global train loss: 1.041, Global test loss: 2.130, Global test accuracy: 29.60
Round  39, Train loss: 0.900, Test loss: 0.835, Test accuracy: 73.88
Round  39, Global train loss: 0.900, Global test loss: 2.003, Global test accuracy: 33.46
Round  40, Train loss: 0.811, Test loss: 0.812, Test accuracy: 74.46
Round  40, Global train loss: 0.811, Global test loss: 1.736, Global test accuracy: 44.28
Round  41, Train loss: 1.065, Test loss: 0.825, Test accuracy: 74.50
Round  41, Global train loss: 1.065, Global test loss: 1.840, Global test accuracy: 39.74
Round  42, Train loss: 1.054, Test loss: 0.845, Test accuracy: 72.86
Round  42, Global train loss: 1.054, Global test loss: 2.349, Global test accuracy: 22.98
Round  43, Train loss: 0.973, Test loss: 0.835, Test accuracy: 72.44
Round  43, Global train loss: 0.973, Global test loss: 2.078, Global test accuracy: 38.76
Round  44, Train loss: 0.924, Test loss: 0.818, Test accuracy: 73.84
Round  44, Global train loss: 0.924, Global test loss: 1.623, Global test accuracy: 42.64
Round  45, Train loss: 0.858, Test loss: 0.831, Test accuracy: 72.60
Round  45, Global train loss: 0.858, Global test loss: 1.821, Global test accuracy: 37.94
Round  46, Train loss: 0.960, Test loss: 0.820, Test accuracy: 73.54
Round  46, Global train loss: 0.960, Global test loss: 2.274, Global test accuracy: 36.80
Round  47, Train loss: 0.922, Test loss: 0.824, Test accuracy: 73.44
Round  47, Global train loss: 0.922, Global test loss: 2.022, Global test accuracy: 37.50
Round  48, Train loss: 0.788, Test loss: 0.793, Test accuracy: 74.58
Round  48, Global train loss: 0.788, Global test loss: 1.896, Global test accuracy: 35.80
Round  49, Train loss: 0.903, Test loss: 0.812, Test accuracy: 73.54
Round  49, Global train loss: 0.903, Global test loss: 2.395, Global test accuracy: 35.02
Round  50, Train loss: 0.876, Test loss: 0.851, Test accuracy: 72.16
Round  50, Global train loss: 0.876, Global test loss: 2.268, Global test accuracy: 36.58
Round  51, Train loss: 0.736, Test loss: 0.817, Test accuracy: 73.88
Round  51, Global train loss: 0.736, Global test loss: 1.683, Global test accuracy: 47.22
Round  52, Train loss: 0.672, Test loss: 0.802, Test accuracy: 74.82
Round  52, Global train loss: 0.672, Global test loss: 1.460, Global test accuracy: 49.26
Round  53, Train loss: 0.647, Test loss: 0.806, Test accuracy: 74.06
Round  53, Global train loss: 0.647, Global test loss: 1.579, Global test accuracy: 45.48
Round  54, Train loss: 0.976, Test loss: 0.805, Test accuracy: 74.76
Round  54, Global train loss: 0.976, Global test loss: 1.819, Global test accuracy: 45.78
Round  55, Train loss: 0.806, Test loss: 0.807, Test accuracy: 74.56
Round  55, Global train loss: 0.806, Global test loss: 1.633, Global test accuracy: 47.30
Round  56, Train loss: 0.794, Test loss: 0.805, Test accuracy: 74.14
Round  56, Global train loss: 0.794, Global test loss: 1.423, Global test accuracy: 52.96
Round  57, Train loss: 0.737, Test loss: 0.794, Test accuracy: 74.16
Round  57, Global train loss: 0.737, Global test loss: 1.756, Global test accuracy: 44.40
Round  58, Train loss: 0.834, Test loss: 0.809, Test accuracy: 74.20
Round  58, Global train loss: 0.834, Global test loss: 2.530, Global test accuracy: 27.82
Round  59, Train loss: 0.770, Test loss: 0.827, Test accuracy: 73.26
Round  59, Global train loss: 0.770, Global test loss: 1.624, Global test accuracy: 42.44
Round  60, Train loss: 0.827, Test loss: 0.827, Test accuracy: 73.18
Round  60, Global train loss: 0.827, Global test loss: 1.679, Global test accuracy: 39.46
Round  61, Train loss: 0.653, Test loss: 0.802, Test accuracy: 73.40
Round  61, Global train loss: 0.653, Global test loss: 1.696, Global test accuracy: 45.40
Round  62, Train loss: 0.811, Test loss: 0.833, Test accuracy: 72.78
Round  62, Global train loss: 0.811, Global test loss: 1.983, Global test accuracy: 36.88
Round  63, Train loss: 0.777, Test loss: 0.821, Test accuracy: 73.06
Round  63, Global train loss: 0.777, Global test loss: 2.053, Global test accuracy: 39.86
Round  64, Train loss: 0.734, Test loss: 0.792, Test accuracy: 75.02
Round  64, Global train loss: 0.734, Global test loss: 1.518, Global test accuracy: 50.56
Round  65, Train loss: 0.755, Test loss: 0.823, Test accuracy: 73.52
Round  65, Global train loss: 0.755, Global test loss: 2.179, Global test accuracy: 33.50
Round  66, Train loss: 0.640, Test loss: 0.821, Test accuracy: 73.30
Round  66, Global train loss: 0.640, Global test loss: 1.866, Global test accuracy: 43.32
Round  67, Train loss: 0.710, Test loss: 0.791, Test accuracy: 74.20
Round  67, Global train loss: 0.710, Global test loss: 1.854, Global test accuracy: 34.30
Round  68, Train loss: 0.667, Test loss: 0.809, Test accuracy: 73.50
Round  68, Global train loss: 0.667, Global test loss: 1.836, Global test accuracy: 43.42
Round  69, Train loss: 0.510, Test loss: 0.812, Test accuracy: 73.56
Round  69, Global train loss: 0.510, Global test loss: 1.568, Global test accuracy: 48.12
Round  70, Train loss: 0.505, Test loss: 0.818, Test accuracy: 73.86
Round  70, Global train loss: 0.505, Global test loss: 1.628, Global test accuracy: 49.16
Round  71, Train loss: 0.767, Test loss: 0.823, Test accuracy: 74.04
Round  71, Global train loss: 0.767, Global test loss: 1.611, Global test accuracy: 42.58
Round  72, Train loss: 0.578, Test loss: 0.858, Test accuracy: 72.42
Round  72, Global train loss: 0.578, Global test loss: 1.720, Global test accuracy: 40.58
Round  73, Train loss: 0.688, Test loss: 0.836, Test accuracy: 73.54
Round  73, Global train loss: 0.688, Global test loss: 2.405, Global test accuracy: 34.90
Round  74, Train loss: 0.611, Test loss: 0.817, Test accuracy: 73.32
Round  74, Global train loss: 0.611, Global test loss: 1.864, Global test accuracy: 35.16
Round  75, Train loss: 0.727, Test loss: 0.850, Test accuracy: 73.00
Round  75, Global train loss: 0.727, Global test loss: 1.908, Global test accuracy: 37.10
Round  76, Train loss: 0.546, Test loss: 0.811, Test accuracy: 73.82
Round  76, Global train loss: 0.546, Global test loss: 1.303, Global test accuracy: 57.54
Round  77, Train loss: 0.628, Test loss: 0.832, Test accuracy: 73.38
Round  77, Global train loss: 0.628, Global test loss: 2.295, Global test accuracy: 34.00
Round  78, Train loss: 0.530, Test loss: 0.845, Test accuracy: 72.46
Round  78, Global train loss: 0.530, Global test loss: 1.819, Global test accuracy: 40.90
Round  79, Train loss: 0.662, Test loss: 0.832, Test accuracy: 73.08
Round  79, Global train loss: 0.662, Global test loss: 1.576, Global test accuracy: 44.54
Round  80, Train loss: 0.490, Test loss: 0.814, Test accuracy: 74.66
Round  80, Global train loss: 0.490, Global test loss: 1.261, Global test accuracy: 58.72
Round  81, Train loss: 0.435, Test loss: 0.798, Test accuracy: 75.04
Round  81, Global train loss: 0.435, Global test loss: 1.244, Global test accuracy: 58.50
Round  82, Train loss: 0.422, Test loss: 0.801, Test accuracy: 74.62
Round  82, Global train loss: 0.422, Global test loss: 1.245, Global test accuracy: 58.22
Round  83, Train loss: 0.394, Test loss: 0.798, Test accuracy: 75.06
Round  83, Global train loss: 0.394, Global test loss: 1.216, Global test accuracy: 59.32
Round  84, Train loss: 0.396, Test loss: 0.807, Test accuracy: 75.00
Round  84, Global train loss: 0.396, Global test loss: 1.243, Global test accuracy: 59.62
Round  85, Train loss: 0.379, Test loss: 0.811, Test accuracy: 74.60
Round  85, Global train loss: 0.379, Global test loss: 1.249, Global test accuracy: 58.84
Round  86, Train loss: 0.367, Test loss: 0.826, Test accuracy: 74.40
Round  86, Global train loss: 0.367, Global test loss: 1.258, Global test accuracy: 58.54
Round  87, Train loss: 0.359, Test loss: 0.835, Test accuracy: 73.64
Round  87, Global train loss: 0.359, Global test loss: 1.246, Global test accuracy: 59.72
Round  88, Train loss: 0.345, Test loss: 0.852, Test accuracy: 73.52
Round  88, Global train loss: 0.345, Global test loss: 1.280, Global test accuracy: 58.54
Round  89, Train loss: 0.346, Test loss: 0.857, Test accuracy: 73.50
Round  89, Global train loss: 0.346, Global test loss: 1.249, Global test accuracy: 59.68
Round  90, Train loss: 0.331, Test loss: 0.844, Test accuracy: 74.26
Round  90, Global train loss: 0.331, Global test loss: 1.252, Global test accuracy: 59.32
Round  91, Train loss: 0.322, Test loss: 0.842, Test accuracy: 74.10
Round  91, Global train loss: 0.322, Global test loss: 1.272, Global test accuracy: 59.42
Round  92, Train loss: 0.309, Test loss: 0.853, Test accuracy: 74.00
Round  92, Global train loss: 0.309, Global test loss: 1.275, Global test accuracy: 59.84
Round  93, Train loss: 0.302, Test loss: 0.853, Test accuracy: 73.94
Round  93, Global train loss: 0.302, Global test loss: 1.249, Global test accuracy: 60.02
Round  94, Train loss: 0.302, Test loss: 0.875, Test accuracy: 73.28
Round  94, Global train loss: 0.302, Global test loss: 1.269, Global test accuracy: 58.96
Round  95, Train loss: 0.294, Test loss: 0.869, Test accuracy: 73.00
Round  95, Global train loss: 0.294, Global test loss: 1.282, Global test accuracy: 57.24
Round  96, Train loss: 0.290, Test loss: 0.859, Test accuracy: 73.40
Round  96, Global train loss: 0.290, Global test loss: 1.249, Global test accuracy: 59.44
Round  97, Train loss: 0.271, Test loss: 0.853, Test accuracy: 74.10
Round  97, Global train loss: 0.271, Global test loss: 1.266, Global test accuracy: 60.04
Round  98, Train loss: 0.279, Test loss: 0.877, Test accuracy: 73.38
Round  98, Global train loss: 0.279, Global test loss: 1.280, Global test accuracy: 59.46
Round  99, Train loss: 0.453, Test loss: 0.870, Test accuracy: 73.28
Round  99, Global train loss: 0.453, Global test loss: 1.255, Global test accuracy: 58.06
Final Round, Train loss: 0.424, Test loss: 0.895, Test accuracy: 72.88
Final Round, Global train loss: 0.424, Global test loss: 1.255, Global test accuracy: 58.06
Average accuracy final 10 rounds: 73.67399999999999
1712.8041524887085
[1.933042287826538, 3.545095920562744, 5.10925030708313, 6.754784822463989, 8.38740873336792, 10.023258924484253, 11.631237030029297, 13.211988925933838, 14.786791801452637, 16.416902542114258, 22.06542658805847, 31.404216527938843, 40.76044940948486, 42.37789440155029, 51.773037910461426, 60.804264068603516, 69.94527006149292, 79.35178852081299, 88.72130966186523, 98.14763045310974, 108.10895252227783, 109.79046368598938, 118.91223978996277, 120.51032757759094, 129.70115423202515, 138.88878321647644, 147.8537998199463, 156.84667921066284, 158.49774599075317, 167.7088816165924, 176.81116127967834, 185.803936958313, 194.95807456970215, 204.37104654312134, 213.5632221698761, 222.6727168560028, 231.8961944580078, 241.11097383499146, 250.45070624351501, 259.89165782928467, 261.49825286865234, 270.9222159385681, 280.35742712020874, 289.5297830104828, 298.82098031044006, 300.45814538002014, 309.620402097702, 318.8655672073364, 328.04717230796814, 337.3006522655487, 346.59942626953125, 348.1853551864624, 349.7218942642212, 358.71024203300476, 368.1525774002075, 377.7808744907379, 387.2834541797638, 396.48048186302185, 405.7142400741577, 415.0853486061096, 424.32584404945374, 433.5934772491455, 442.66204023361206, 451.82874178886414, 461.4213345050812, 470.2962408065796, 479.4156165122986, 488.7833836078644, 498.1559262275696, 499.76468801498413, 501.3915739059448, 510.99573254585266, 520.1866445541382, 529.4038989543915, 538.5876634120941, 547.8900246620178, 549.4875774383545, 559.6147558689117, 569.543603181839, 578.8881435394287, 580.5362997055054, 582.1567316055298, 583.7568707466125, 585.4753122329712, 587.137143611908, 588.7304022312164, 590.3003821372986, 591.895501613617, 593.5381181240082, 595.2407171726227, 596.8409173488617, 598.4164443016052, 599.9713742733002, 601.5399518013, 603.127846956253, 604.7186892032623, 606.3001227378845, 607.8961329460144, 609.5203764438629, 618.6857872009277, 627.8933591842651]
[37.66, 46.0, 50.44, 52.74, 55.4, 56.48, 59.34, 60.6, 61.16, 62.68, 62.9, 62.94, 62.36, 66.16, 63.86, 66.06, 65.86, 66.92, 68.46, 68.42, 67.72, 69.3, 70.92, 67.96, 68.66, 70.02, 69.46, 72.22, 71.62, 71.42, 72.5, 72.18, 73.16, 72.42, 72.62, 72.9, 74.02, 73.36, 73.66, 73.88, 74.46, 74.5, 72.86, 72.44, 73.84, 72.6, 73.54, 73.44, 74.58, 73.54, 72.16, 73.88, 74.82, 74.06, 74.76, 74.56, 74.14, 74.16, 74.2, 73.26, 73.18, 73.4, 72.78, 73.06, 75.02, 73.52, 73.3, 74.2, 73.5, 73.56, 73.86, 74.04, 72.42, 73.54, 73.32, 73.0, 73.82, 73.38, 72.46, 73.08, 74.66, 75.04, 74.62, 75.06, 75.0, 74.6, 74.4, 73.64, 73.52, 73.5, 74.26, 74.1, 74.0, 73.94, 73.28, 73.0, 73.4, 74.1, 73.38, 73.28, 72.88]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.855, Test loss: 2.176, Test accuracy: 14.94
Round   0, Global train loss: 1.855, Global test loss: 2.319, Global test accuracy: 14.22
Round   1, Train loss: 1.797, Test loss: 2.187, Test accuracy: 15.84
Round   1, Global train loss: 1.797, Global test loss: 2.407, Global test accuracy: 10.70
Round   2, Train loss: 1.884, Test loss: 1.886, Test accuracy: 27.30
Round   2, Global train loss: 1.884, Global test loss: 2.281, Global test accuracy: 17.80
Round   3, Train loss: 1.722, Test loss: 1.804, Test accuracy: 31.76
Round   3, Global train loss: 1.722, Global test loss: 2.280, Global test accuracy: 20.70
Round   4, Train loss: 1.621, Test loss: 1.720, Test accuracy: 31.66
Round   4, Global train loss: 1.621, Global test loss: 2.145, Global test accuracy: 18.00
Round   5, Train loss: 1.672, Test loss: 1.718, Test accuracy: 35.10
Round   5, Global train loss: 1.672, Global test loss: 2.365, Global test accuracy: 16.60
Round   6, Train loss: 1.642, Test loss: 1.717, Test accuracy: 31.42
Round   6, Global train loss: 1.642, Global test loss: 2.363, Global test accuracy: 13.60
Round   7, Train loss: 1.769, Test loss: 1.661, Test accuracy: 37.22
Round   7, Global train loss: 1.769, Global test loss: 2.560, Global test accuracy: 15.40
Round   8, Train loss: 1.537, Test loss: 1.582, Test accuracy: 39.76
Round   8, Global train loss: 1.537, Global test loss: 2.197, Global test accuracy: 24.00
Round   9, Train loss: 1.595, Test loss: 1.612, Test accuracy: 40.08
Round   9, Global train loss: 1.595, Global test loss: 2.460, Global test accuracy: 14.92
Round  10, Train loss: 1.768, Test loss: 1.502, Test accuracy: 42.88
Round  10, Global train loss: 1.768, Global test loss: 2.374, Global test accuracy: 11.70
Round  11, Train loss: 1.531, Test loss: 1.481, Test accuracy: 43.64
Round  11, Global train loss: 1.531, Global test loss: 2.058, Global test accuracy: 25.00
Round  12, Train loss: 1.686, Test loss: 1.460, Test accuracy: 45.52
Round  12, Global train loss: 1.686, Global test loss: 2.544, Global test accuracy: 16.70
Round  13, Train loss: 1.675, Test loss: 1.446, Test accuracy: 46.24
Round  13, Global train loss: 1.675, Global test loss: 2.194, Global test accuracy: 19.16
Round  14, Train loss: 1.582, Test loss: 1.442, Test accuracy: 46.32
Round  14, Global train loss: 1.582, Global test loss: 2.184, Global test accuracy: 21.90
Round  15, Train loss: 1.465, Test loss: 1.470, Test accuracy: 43.56
Round  15, Global train loss: 1.465, Global test loss: 2.139, Global test accuracy: 24.82
Round  16, Train loss: 1.531, Test loss: 1.449, Test accuracy: 45.20
Round  16, Global train loss: 1.531, Global test loss: 2.115, Global test accuracy: 30.06
Round  17, Train loss: 1.339, Test loss: 1.481, Test accuracy: 45.36
Round  17, Global train loss: 1.339, Global test loss: 2.078, Global test accuracy: 24.74
Round  18, Train loss: 1.505, Test loss: 1.471, Test accuracy: 46.34
Round  18, Global train loss: 1.505, Global test loss: 2.488, Global test accuracy: 12.40
Round  19, Train loss: 1.627, Test loss: 1.467, Test accuracy: 45.26
Round  19, Global train loss: 1.627, Global test loss: 2.373, Global test accuracy: 12.80
Round  20, Train loss: 1.464, Test loss: 1.438, Test accuracy: 46.12
Round  20, Global train loss: 1.464, Global test loss: 2.154, Global test accuracy: 23.96
Round  21, Train loss: 1.534, Test loss: 1.426, Test accuracy: 47.86
Round  21, Global train loss: 1.534, Global test loss: 2.308, Global test accuracy: 16.48
Round  22, Train loss: 1.657, Test loss: 1.420, Test accuracy: 48.48
Round  22, Global train loss: 1.657, Global test loss: 2.429, Global test accuracy: 14.68
Round  23, Train loss: 1.492, Test loss: 1.414, Test accuracy: 48.10
Round  23, Global train loss: 1.492, Global test loss: 2.237, Global test accuracy: 25.80
Round  24, Train loss: 1.428, Test loss: 1.391, Test accuracy: 48.62
Round  24, Global train loss: 1.428, Global test loss: 2.262, Global test accuracy: 23.54
Round  25, Train loss: 1.266, Test loss: 1.386, Test accuracy: 48.88
Round  25, Global train loss: 1.266, Global test loss: 1.971, Global test accuracy: 40.02
Round  26, Train loss: 1.457, Test loss: 1.391, Test accuracy: 48.42
Round  26, Global train loss: 1.457, Global test loss: 2.267, Global test accuracy: 13.20
Round  27, Train loss: 1.567, Test loss: 1.401, Test accuracy: 47.68
Round  27, Global train loss: 1.567, Global test loss: 2.243, Global test accuracy: 22.10
Round  28, Train loss: 1.477, Test loss: 1.396, Test accuracy: 47.64
Round  28, Global train loss: 1.477, Global test loss: 2.245, Global test accuracy: 18.30
Round  29, Train loss: 1.437, Test loss: 1.392, Test accuracy: 49.30
Round  29, Global train loss: 1.437, Global test loss: 2.225, Global test accuracy: 28.14
Round  30, Train loss: 1.099, Test loss: 1.380, Test accuracy: 49.14
Round  30, Global train loss: 1.099, Global test loss: 2.070, Global test accuracy: 24.44
Round  31, Train loss: 1.401, Test loss: 1.386, Test accuracy: 48.30
Round  31, Global train loss: 1.401, Global test loss: 2.125, Global test accuracy: 17.40
Round  32, Train loss: 1.285, Test loss: 1.405, Test accuracy: 48.58
Round  32, Global train loss: 1.285, Global test loss: 2.057, Global test accuracy: 28.42
Round  33, Train loss: 1.277, Test loss: 1.402, Test accuracy: 49.30
Round  33, Global train loss: 1.277, Global test loss: 2.147, Global test accuracy: 25.68
Round  34, Train loss: 1.318, Test loss: 1.417, Test accuracy: 48.90
Round  34, Global train loss: 1.318, Global test loss: 2.213, Global test accuracy: 32.98
Round  35, Train loss: 1.139, Test loss: 1.426, Test accuracy: 48.34
Round  35, Global train loss: 1.139, Global test loss: 2.186, Global test accuracy: 25.44
Round  36, Train loss: 1.111, Test loss: 1.395, Test accuracy: 49.84
Round  36, Global train loss: 1.111, Global test loss: 2.068, Global test accuracy: 27.52
Round  37, Train loss: 1.164, Test loss: 1.412, Test accuracy: 49.48
Round  37, Global train loss: 1.164, Global test loss: 2.093, Global test accuracy: 27.40
Round  38, Train loss: 0.985, Test loss: 1.416, Test accuracy: 48.76
Round  38, Global train loss: 0.985, Global test loss: 2.103, Global test accuracy: 27.44
Round  39, Train loss: 1.426, Test loss: 1.417, Test accuracy: 48.74
Round  39, Global train loss: 1.426, Global test loss: 2.419, Global test accuracy: 18.12
Round  40, Train loss: 1.278, Test loss: 1.435, Test accuracy: 48.64
Round  40, Global train loss: 1.278, Global test loss: 2.380, Global test accuracy: 15.30
Round  41, Train loss: 1.112, Test loss: 1.438, Test accuracy: 48.72
Round  41, Global train loss: 1.112, Global test loss: 2.100, Global test accuracy: 28.02
Round  42, Train loss: 1.118, Test loss: 1.428, Test accuracy: 49.76
Round  42, Global train loss: 1.118, Global test loss: 2.288, Global test accuracy: 21.06
Round  43, Train loss: 1.079, Test loss: 1.454, Test accuracy: 48.38
Round  43, Global train loss: 1.079, Global test loss: 2.063, Global test accuracy: 27.44
Round  44, Train loss: 1.195, Test loss: 1.445, Test accuracy: 48.94
Round  44, Global train loss: 1.195, Global test loss: 2.181, Global test accuracy: 22.10
Round  45, Train loss: 1.129, Test loss: 1.468, Test accuracy: 47.66
Round  45, Global train loss: 1.129, Global test loss: 2.129, Global test accuracy: 23.46
Round  46, Train loss: 0.858, Test loss: 1.458, Test accuracy: 47.94
Round  46, Global train loss: 0.858, Global test loss: 2.105, Global test accuracy: 22.94
Round  47, Train loss: 0.871, Test loss: 1.466, Test accuracy: 48.30
Round  47, Global train loss: 0.871, Global test loss: 2.054, Global test accuracy: 35.48
Round  48, Train loss: 0.908, Test loss: 1.474, Test accuracy: 48.12
Round  48, Global train loss: 0.908, Global test loss: 2.141, Global test accuracy: 24.52
Round  49, Train loss: 1.073, Test loss: 1.527, Test accuracy: 47.02
Round  49, Global train loss: 1.073, Global test loss: 2.359, Global test accuracy: 24.36
Round  50, Train loss: 0.707, Test loss: 1.520, Test accuracy: 47.26
Round  50, Global train loss: 0.707, Global test loss: 1.946, Global test accuracy: 32.22
Round  51, Train loss: 0.941, Test loss: 1.581, Test accuracy: 46.58
Round  51, Global train loss: 0.941, Global test loss: 2.188, Global test accuracy: 30.64
Round  52, Train loss: 1.183, Test loss: 1.597, Test accuracy: 45.84
Round  52, Global train loss: 1.183, Global test loss: 2.245, Global test accuracy: 24.30
Round  53, Train loss: 1.212, Test loss: 1.586, Test accuracy: 46.50
Round  53, Global train loss: 1.212, Global test loss: 2.349, Global test accuracy: 18.34
Round  54, Train loss: 0.833, Test loss: 1.624, Test accuracy: 46.74
Round  54, Global train loss: 0.833, Global test loss: 2.043, Global test accuracy: 31.48
Round  55, Train loss: 0.943, Test loss: 1.612, Test accuracy: 46.74
Round  55, Global train loss: 0.943, Global test loss: 2.091, Global test accuracy: 30.70
Round  56, Train loss: 0.878, Test loss: 1.633, Test accuracy: 46.68
Round  56, Global train loss: 0.878, Global test loss: 2.061, Global test accuracy: 27.44
Round  57, Train loss: 1.091, Test loss: 1.625, Test accuracy: 46.88
Round  57, Global train loss: 1.091, Global test loss: 2.246, Global test accuracy: 19.56
Round  58, Train loss: 0.810, Test loss: 1.699, Test accuracy: 45.64
Round  58, Global train loss: 0.810, Global test loss: 2.232, Global test accuracy: 22.98
Round  59, Train loss: 0.709, Test loss: 1.684, Test accuracy: 46.24
Round  59, Global train loss: 0.709, Global test loss: 2.168, Global test accuracy: 27.48
Round  60, Train loss: 1.135, Test loss: 1.681, Test accuracy: 46.88
Round  60, Global train loss: 1.135, Global test loss: 2.318, Global test accuracy: 15.60
Round  61, Train loss: 0.703, Test loss: 1.667, Test accuracy: 46.48
Round  61, Global train loss: 0.703, Global test loss: 2.013, Global test accuracy: 29.48
Round  62, Train loss: 0.658, Test loss: 1.732, Test accuracy: 45.90
Round  62, Global train loss: 0.658, Global test loss: 2.108, Global test accuracy: 26.98
Round  63, Train loss: 1.003, Test loss: 1.755, Test accuracy: 45.08
Round  63, Global train loss: 1.003, Global test loss: 2.375, Global test accuracy: 15.38
Round  64, Train loss: 0.854, Test loss: 1.802, Test accuracy: 45.02
Round  64, Global train loss: 0.854, Global test loss: 2.226, Global test accuracy: 21.76
Round  65, Train loss: 0.769, Test loss: 1.839, Test accuracy: 45.54
Round  65, Global train loss: 0.769, Global test loss: 2.199, Global test accuracy: 28.28
Round  66, Train loss: 0.843, Test loss: 1.896, Test accuracy: 46.28
Round  66, Global train loss: 0.843, Global test loss: 2.169, Global test accuracy: 24.42
Round  67, Train loss: 0.907, Test loss: 1.892, Test accuracy: 47.04
Round  67, Global train loss: 0.907, Global test loss: 2.491, Global test accuracy: 15.80
Round  68, Train loss: 0.509, Test loss: 1.898, Test accuracy: 46.32
Round  68, Global train loss: 0.509, Global test loss: 2.104, Global test accuracy: 24.02
Round  69, Train loss: 1.073, Test loss: 1.908, Test accuracy: 45.32
Round  69, Global train loss: 1.073, Global test loss: 2.497, Global test accuracy: 10.40
Round  70, Train loss: 0.638, Test loss: 1.906, Test accuracy: 45.74
Round  70, Global train loss: 0.638, Global test loss: 2.122, Global test accuracy: 28.64
Round  71, Train loss: 0.738, Test loss: 1.951, Test accuracy: 45.38
Round  71, Global train loss: 0.738, Global test loss: 2.265, Global test accuracy: 25.14
Round  72, Train loss: 0.654, Test loss: 1.977, Test accuracy: 44.70
Round  72, Global train loss: 0.654, Global test loss: 2.289, Global test accuracy: 19.38
Round  73, Train loss: 0.645, Test loss: 2.029, Test accuracy: 44.86
Round  73, Global train loss: 0.645, Global test loss: 2.140, Global test accuracy: 21.00
Round  74, Train loss: 0.685, Test loss: 2.066, Test accuracy: 44.92
Round  74, Global train loss: 0.685, Global test loss: 2.137, Global test accuracy: 25.32
Round  75, Train loss: 0.429, Test loss: 2.058, Test accuracy: 44.96
Round  75, Global train loss: 0.429, Global test loss: 2.096, Global test accuracy: 25.36
Round  76, Train loss: 0.636, Test loss: 2.106, Test accuracy: 44.92
Round  76, Global train loss: 0.636, Global test loss: 2.225, Global test accuracy: 20.80
Round  77, Train loss: 0.646, Test loss: 2.164, Test accuracy: 45.18
Round  77, Global train loss: 0.646, Global test loss: 2.238, Global test accuracy: 20.96
Round  78, Train loss: 0.596, Test loss: 2.202, Test accuracy: 44.40
Round  78, Global train loss: 0.596, Global test loss: 2.247, Global test accuracy: 18.86
Round  79, Train loss: 0.668, Test loss: 2.200, Test accuracy: 43.70
Round  79, Global train loss: 0.668, Global test loss: 2.387, Global test accuracy: 14.08
Round  80, Train loss: 0.738, Test loss: 2.227, Test accuracy: 44.70
Round  80, Global train loss: 0.738, Global test loss: 2.472, Global test accuracy: 15.20
Round  81, Train loss: 0.536, Test loss: 2.250, Test accuracy: 44.40
Round  81, Global train loss: 0.536, Global test loss: 2.208, Global test accuracy: 25.06
Round  82, Train loss: 0.418, Test loss: 2.284, Test accuracy: 44.50
Round  82, Global train loss: 0.418, Global test loss: 2.153, Global test accuracy: 24.26
Round  83, Train loss: 0.332, Test loss: 2.347, Test accuracy: 44.18
Round  83, Global train loss: 0.332, Global test loss: 2.084, Global test accuracy: 26.74
Round  84, Train loss: 0.645, Test loss: 2.358, Test accuracy: 44.14
Round  84, Global train loss: 0.645, Global test loss: 2.257, Global test accuracy: 23.54
Round  85, Train loss: 0.436, Test loss: 2.408, Test accuracy: 42.98
Round  85, Global train loss: 0.436, Global test loss: 2.033, Global test accuracy: 33.04
Round  86, Train loss: 0.396, Test loss: 2.440, Test accuracy: 43.06
Round  86, Global train loss: 0.396, Global test loss: 2.138, Global test accuracy: 28.52
Round  87, Train loss: 0.490, Test loss: 2.471, Test accuracy: 43.26
Round  87, Global train loss: 0.490, Global test loss: 2.296, Global test accuracy: 28.64
Round  88, Train loss: 0.510, Test loss: 2.529, Test accuracy: 43.12
Round  88, Global train loss: 0.510, Global test loss: 2.214, Global test accuracy: 26.44
Round  89, Train loss: 0.359, Test loss: 2.502, Test accuracy: 44.02
Round  89, Global train loss: 0.359, Global test loss: 2.243, Global test accuracy: 23.66
Round  90, Train loss: 0.369, Test loss: 2.464, Test accuracy: 44.78
Round  90, Global train loss: 0.369, Global test loss: 2.120, Global test accuracy: 21.88
Round  91, Train loss: 0.471, Test loss: 2.535, Test accuracy: 44.60
Round  91, Global train loss: 0.471, Global test loss: 2.349, Global test accuracy: 16.84
Round  92, Train loss: 0.648, Test loss: 2.558, Test accuracy: 44.38
Round  92, Global train loss: 0.648, Global test loss: 2.527, Global test accuracy: 10.26
Round  93, Train loss: 0.441, Test loss: 2.608, Test accuracy: 43.88
Round  93, Global train loss: 0.441, Global test loss: 2.184, Global test accuracy: 25.02
Round  94, Train loss: 0.322, Test loss: 2.659, Test accuracy: 43.76
Round  94, Global train loss: 0.322, Global test loss: 2.169, Global test accuracy: 22.18
Round  95, Train loss: 0.328, Test loss: 2.762, Test accuracy: 43.50
Round  95, Global train loss: 0.328, Global test loss: 2.140, Global test accuracy: 27.14
Round  96, Train loss: 0.332, Test loss: 2.747, Test accuracy: 42.66
Round  96, Global train loss: 0.332, Global test loss: 2.132, Global test accuracy: 25.42
Round  97, Train loss: 0.313, Test loss: 2.753, Test accuracy: 43.08
Round  97, Global train loss: 0.313, Global test loss: 2.166, Global test accuracy: 23.06
Round  98, Train loss: 0.328, Test loss: 2.780, Test accuracy: 43.34
Round  98, Global train loss: 0.328, Global test loss: 2.142, Global test accuracy: 26.74
Round  99, Train loss: 0.296, Test loss: 2.853, Test accuracy: 43.34
Round  99, Global train loss: 0.296, Global test loss: 2.178, Global test accuracy: 23.86
Final Round, Train loss: 0.358, Test loss: 2.838, Test accuracy: 43.64
Final Round, Global train loss: 0.358, Global test loss: 2.178, Global test accuracy: 23.86
Average accuracy final 10 rounds: 43.732000000000006 

Average global accuracy final 10 rounds: 22.24 

801.7321670055389
[1.5093672275543213, 3.0187344551086426, 4.124634027481079, 5.230533599853516, 6.390797138214111, 7.551060676574707, 8.695435762405396, 9.839810848236084, 10.997314214706421, 12.154817581176758, 13.295966386795044, 14.43711519241333, 15.583667039871216, 16.7302188873291, 17.857763051986694, 18.985307216644287, 20.134876012802124, 21.28444480895996, 22.43388795852661, 23.58333110809326, 24.727762460708618, 25.872193813323975, 27.102408409118652, 28.33262300491333, 29.527904748916626, 30.723186492919922, 31.87225317955017, 33.02131986618042, 34.19266724586487, 35.364014625549316, 36.50219655036926, 37.64037847518921, 38.83346915245056, 40.026559829711914, 41.165807247161865, 42.305054664611816, 43.438968658447266, 44.572882652282715, 45.70231056213379, 46.83173847198486, 47.964927434921265, 49.098116397857666, 50.22068381309509, 51.34325122833252, 52.48224472999573, 53.621238231658936, 54.76095628738403, 55.90067434310913, 57.02984023094177, 58.159006118774414, 59.384514808654785, 60.610023498535156, 61.90528845787048, 63.20055341720581, 64.42925882339478, 65.65796422958374, 66.79127240180969, 67.92458057403564, 69.06923246383667, 70.2138843536377, 71.3701901435852, 72.52649593353271, 73.67028713226318, 74.81407833099365, 75.95230293273926, 77.09052753448486, 78.34192061424255, 79.59331369400024, 80.79258918762207, 81.9918646812439, 83.21955013275146, 84.44723558425903, 85.70184469223022, 86.95645380020142, 88.17159008979797, 89.38672637939453, 90.55715918540955, 91.72759199142456, 92.8874077796936, 94.04722356796265, 95.21218991279602, 96.3771562576294, 97.58917117118835, 98.80118608474731, 99.9640748500824, 101.12696361541748, 102.27842116355896, 103.42987871170044, 104.58015012741089, 105.73042154312134, 106.86581587791443, 108.00121021270752, 109.13529849052429, 110.26938676834106, 111.4337272644043, 112.59806776046753, 113.77023077011108, 114.94239377975464, 116.11273789405823, 117.28308200836182, 118.4459159374237, 119.6087498664856, 120.7354645729065, 121.86217927932739, 123.01778221130371, 124.17338514328003, 125.3075122833252, 126.44163942337036, 127.57198667526245, 128.70233392715454, 129.8567464351654, 131.01115894317627, 132.1705560684204, 133.32995319366455, 134.54319500923157, 135.75643682479858, 136.94080758094788, 138.12517833709717, 139.3442165851593, 140.56325483322144, 141.72334933280945, 142.88344383239746, 144.0273630619049, 145.17128229141235, 146.3824806213379, 147.59367895126343, 148.77900767326355, 149.96433639526367, 151.25934886932373, 152.5543613433838, 153.8083336353302, 155.0623059272766, 156.30304265022278, 157.54377937316895, 158.7800657749176, 160.01635217666626, 161.1526026725769, 162.28885316848755, 163.41292762756348, 164.5370020866394, 165.66665244102478, 166.79630279541016, 167.94406509399414, 169.09182739257812, 170.21627569198608, 171.34072399139404, 172.45557761192322, 173.5704312324524, 174.70058727264404, 175.8307433128357, 176.97434067726135, 178.117938041687, 179.26052594184875, 180.4031138420105, 181.55296277999878, 182.70281171798706, 183.80698537826538, 184.9111590385437, 186.04310703277588, 187.17505502700806, 188.28324818611145, 189.39144134521484, 190.5102870464325, 191.62913274765015, 192.77523827552795, 193.92134380340576, 195.12316751480103, 196.3249912261963, 197.45844411849976, 198.59189701080322, 199.74481987953186, 200.8977427482605, 202.02764916419983, 203.15755558013916, 204.2911605834961, 205.42476558685303, 206.5779993534088, 207.7312331199646, 208.94592356681824, 210.16061401367188, 211.36395525932312, 212.56729650497437, 213.75076031684875, 214.93422412872314, 216.1623945236206, 217.39056491851807, 218.54402923583984, 219.69749355316162, 220.92122435569763, 222.14495515823364, 223.3139626979828, 224.48297023773193, 225.59840655326843, 226.71384286880493, 227.84873032569885, 228.98361778259277, 230.1142337322235, 231.24484968185425, 232.39011454582214, 233.53537940979004, 235.9067850112915, 238.27819061279297]
[14.94, 14.94, 15.84, 15.84, 27.3, 27.3, 31.76, 31.76, 31.66, 31.66, 35.1, 35.1, 31.42, 31.42, 37.22, 37.22, 39.76, 39.76, 40.08, 40.08, 42.88, 42.88, 43.64, 43.64, 45.52, 45.52, 46.24, 46.24, 46.32, 46.32, 43.56, 43.56, 45.2, 45.2, 45.36, 45.36, 46.34, 46.34, 45.26, 45.26, 46.12, 46.12, 47.86, 47.86, 48.48, 48.48, 48.1, 48.1, 48.62, 48.62, 48.88, 48.88, 48.42, 48.42, 47.68, 47.68, 47.64, 47.64, 49.3, 49.3, 49.14, 49.14, 48.3, 48.3, 48.58, 48.58, 49.3, 49.3, 48.9, 48.9, 48.34, 48.34, 49.84, 49.84, 49.48, 49.48, 48.76, 48.76, 48.74, 48.74, 48.64, 48.64, 48.72, 48.72, 49.76, 49.76, 48.38, 48.38, 48.94, 48.94, 47.66, 47.66, 47.94, 47.94, 48.3, 48.3, 48.12, 48.12, 47.02, 47.02, 47.26, 47.26, 46.58, 46.58, 45.84, 45.84, 46.5, 46.5, 46.74, 46.74, 46.74, 46.74, 46.68, 46.68, 46.88, 46.88, 45.64, 45.64, 46.24, 46.24, 46.88, 46.88, 46.48, 46.48, 45.9, 45.9, 45.08, 45.08, 45.02, 45.02, 45.54, 45.54, 46.28, 46.28, 47.04, 47.04, 46.32, 46.32, 45.32, 45.32, 45.74, 45.74, 45.38, 45.38, 44.7, 44.7, 44.86, 44.86, 44.92, 44.92, 44.96, 44.96, 44.92, 44.92, 45.18, 45.18, 44.4, 44.4, 43.7, 43.7, 44.7, 44.7, 44.4, 44.4, 44.5, 44.5, 44.18, 44.18, 44.14, 44.14, 42.98, 42.98, 43.06, 43.06, 43.26, 43.26, 43.12, 43.12, 44.02, 44.02, 44.78, 44.78, 44.6, 44.6, 44.38, 44.38, 43.88, 43.88, 43.76, 43.76, 43.5, 43.5, 42.66, 42.66, 43.08, 43.08, 43.34, 43.34, 43.34, 43.34, 43.64, 43.64]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.914, Test loss: 2.168, Test accuracy: 13.60
Round   0, Global train loss: 1.914, Global test loss: 2.313, Global test accuracy: 11.50
Round   1, Train loss: 1.693, Test loss: 2.088, Test accuracy: 22.42
Round   1, Global train loss: 1.693, Global test loss: 2.251, Global test accuracy: 22.30
Round   2, Train loss: 1.803, Test loss: 1.721, Test accuracy: 32.64
Round   2, Global train loss: 1.803, Global test loss: 2.105, Global test accuracy: 28.06
Round   3, Train loss: 1.451, Test loss: 1.701, Test accuracy: 34.52
Round   3, Global train loss: 1.451, Global test loss: 2.152, Global test accuracy: 29.00
Round   4, Train loss: 1.675, Test loss: 1.632, Test accuracy: 35.70
Round   4, Global train loss: 1.675, Global test loss: 2.145, Global test accuracy: 28.28
Round   5, Train loss: 1.498, Test loss: 1.497, Test accuracy: 42.86
Round   5, Global train loss: 1.498, Global test loss: 1.826, Global test accuracy: 39.26
Round   6, Train loss: 1.440, Test loss: 1.530, Test accuracy: 41.26
Round   6, Global train loss: 1.440, Global test loss: 1.860, Global test accuracy: 35.68
Round   7, Train loss: 1.779, Test loss: 1.468, Test accuracy: 43.52
Round   7, Global train loss: 1.779, Global test loss: 2.077, Global test accuracy: 24.60
Round   8, Train loss: 1.646, Test loss: 1.391, Test accuracy: 49.42
Round   8, Global train loss: 1.646, Global test loss: 1.826, Global test accuracy: 36.60
Round   9, Train loss: 1.351, Test loss: 1.385, Test accuracy: 48.76
Round   9, Global train loss: 1.351, Global test loss: 1.794, Global test accuracy: 40.86
Round  10, Train loss: 1.390, Test loss: 1.298, Test accuracy: 51.82
Round  10, Global train loss: 1.390, Global test loss: 1.668, Global test accuracy: 44.06
Round  11, Train loss: 1.325, Test loss: 1.276, Test accuracy: 53.44
Round  11, Global train loss: 1.325, Global test loss: 1.597, Global test accuracy: 49.86
Round  12, Train loss: 1.710, Test loss: 1.254, Test accuracy: 54.00
Round  12, Global train loss: 1.710, Global test loss: 1.942, Global test accuracy: 33.50
Round  13, Train loss: 1.356, Test loss: 1.260, Test accuracy: 53.68
Round  13, Global train loss: 1.356, Global test loss: 1.559, Global test accuracy: 47.66
Round  14, Train loss: 1.329, Test loss: 1.257, Test accuracy: 54.38
Round  14, Global train loss: 1.329, Global test loss: 1.616, Global test accuracy: 45.22
Round  15, Train loss: 1.234, Test loss: 1.234, Test accuracy: 55.18
Round  15, Global train loss: 1.234, Global test loss: 1.591, Global test accuracy: 45.90
Round  16, Train loss: 0.960, Test loss: 1.224, Test accuracy: 55.82
Round  16, Global train loss: 0.960, Global test loss: 1.609, Global test accuracy: 49.74
Round  17, Train loss: 1.148, Test loss: 1.223, Test accuracy: 56.22
Round  17, Global train loss: 1.148, Global test loss: 1.463, Global test accuracy: 52.54
Round  18, Train loss: 1.198, Test loss: 1.183, Test accuracy: 57.58
Round  18, Global train loss: 1.198, Global test loss: 1.529, Global test accuracy: 49.48
Round  19, Train loss: 1.410, Test loss: 1.199, Test accuracy: 57.68
Round  19, Global train loss: 1.410, Global test loss: 1.647, Global test accuracy: 46.44
Round  20, Train loss: 1.377, Test loss: 1.229, Test accuracy: 56.18
Round  20, Global train loss: 1.377, Global test loss: 1.561, Global test accuracy: 49.02
Round  21, Train loss: 1.747, Test loss: 1.213, Test accuracy: 55.38
Round  21, Global train loss: 1.747, Global test loss: 1.944, Global test accuracy: 32.14
Round  22, Train loss: 1.106, Test loss: 1.220, Test accuracy: 55.48
Round  22, Global train loss: 1.106, Global test loss: 1.434, Global test accuracy: 53.48
Round  23, Train loss: 1.114, Test loss: 1.218, Test accuracy: 55.28
Round  23, Global train loss: 1.114, Global test loss: 1.583, Global test accuracy: 50.06
Round  24, Train loss: 1.134, Test loss: 1.193, Test accuracy: 56.12
Round  24, Global train loss: 1.134, Global test loss: 1.408, Global test accuracy: 54.24
Round  25, Train loss: 1.387, Test loss: 1.181, Test accuracy: 57.70
Round  25, Global train loss: 1.387, Global test loss: 1.479, Global test accuracy: 54.32
Round  26, Train loss: 1.341, Test loss: 1.170, Test accuracy: 57.74
Round  26, Global train loss: 1.341, Global test loss: 1.517, Global test accuracy: 49.04
Round  27, Train loss: 1.062, Test loss: 1.179, Test accuracy: 57.88
Round  27, Global train loss: 1.062, Global test loss: 1.502, Global test accuracy: 51.44
Round  28, Train loss: 1.348, Test loss: 1.165, Test accuracy: 57.94
Round  28, Global train loss: 1.348, Global test loss: 1.570, Global test accuracy: 45.04
Round  29, Train loss: 1.293, Test loss: 1.177, Test accuracy: 57.24
Round  29, Global train loss: 1.293, Global test loss: 1.597, Global test accuracy: 47.14
Round  30, Train loss: 1.091, Test loss: 1.192, Test accuracy: 56.60
Round  30, Global train loss: 1.091, Global test loss: 1.659, Global test accuracy: 44.42
Round  31, Train loss: 1.188, Test loss: 1.218, Test accuracy: 57.10
Round  31, Global train loss: 1.188, Global test loss: 1.483, Global test accuracy: 49.60
Round  32, Train loss: 0.750, Test loss: 1.211, Test accuracy: 57.90
Round  32, Global train loss: 0.750, Global test loss: 1.538, Global test accuracy: 52.78
Round  33, Train loss: 1.107, Test loss: 1.210, Test accuracy: 57.64
Round  33, Global train loss: 1.107, Global test loss: 1.430, Global test accuracy: 53.70
Round  34, Train loss: 1.488, Test loss: 1.209, Test accuracy: 58.18
Round  34, Global train loss: 1.488, Global test loss: 2.033, Global test accuracy: 35.72
Round  35, Train loss: 0.998, Test loss: 1.231, Test accuracy: 57.72
Round  35, Global train loss: 0.998, Global test loss: 1.773, Global test accuracy: 44.56
Round  36, Train loss: 1.042, Test loss: 1.239, Test accuracy: 56.90
Round  36, Global train loss: 1.042, Global test loss: 1.544, Global test accuracy: 46.94
Round  37, Train loss: 0.635, Test loss: 1.244, Test accuracy: 57.02
Round  37, Global train loss: 0.635, Global test loss: 1.591, Global test accuracy: 53.12
Round  38, Train loss: 1.283, Test loss: 1.249, Test accuracy: 56.72
Round  38, Global train loss: 1.283, Global test loss: 1.832, Global test accuracy: 40.84
Round  39, Train loss: 1.366, Test loss: 1.244, Test accuracy: 57.18
Round  39, Global train loss: 1.366, Global test loss: 1.916, Global test accuracy: 36.02
Round  40, Train loss: 1.003, Test loss: 1.285, Test accuracy: 56.18
Round  40, Global train loss: 1.003, Global test loss: 1.649, Global test accuracy: 47.98
Round  41, Train loss: 0.932, Test loss: 1.294, Test accuracy: 55.70
Round  41, Global train loss: 0.932, Global test loss: 1.648, Global test accuracy: 47.98
Round  42, Train loss: 0.865, Test loss: 1.267, Test accuracy: 56.82
Round  42, Global train loss: 0.865, Global test loss: 1.474, Global test accuracy: 53.06
Round  43, Train loss: 0.807, Test loss: 1.274, Test accuracy: 56.10
Round  43, Global train loss: 0.807, Global test loss: 1.540, Global test accuracy: 53.08
Round  44, Train loss: 0.820, Test loss: 1.277, Test accuracy: 56.32
Round  44, Global train loss: 0.820, Global test loss: 1.499, Global test accuracy: 53.92
Round  45, Train loss: 0.733, Test loss: 1.305, Test accuracy: 55.76
Round  45, Global train loss: 0.733, Global test loss: 1.560, Global test accuracy: 51.70
Round  46, Train loss: 1.375, Test loss: 1.308, Test accuracy: 56.12
Round  46, Global train loss: 1.375, Global test loss: 1.976, Global test accuracy: 36.04
Round  47, Train loss: 1.025, Test loss: 1.344, Test accuracy: 54.28
Round  47, Global train loss: 1.025, Global test loss: 1.972, Global test accuracy: 41.38
Round  48, Train loss: 1.154, Test loss: 1.405, Test accuracy: 54.76
Round  48, Global train loss: 1.154, Global test loss: 1.910, Global test accuracy: 40.14
Round  49, Train loss: 0.869, Test loss: 1.412, Test accuracy: 54.52
Round  49, Global train loss: 0.869, Global test loss: 1.720, Global test accuracy: 47.22
Round  50, Train loss: 0.744, Test loss: 1.444, Test accuracy: 54.18
Round  50, Global train loss: 0.744, Global test loss: 1.734, Global test accuracy: 48.68
Round  51, Train loss: 1.039, Test loss: 1.470, Test accuracy: 53.84
Round  51, Global train loss: 1.039, Global test loss: 1.886, Global test accuracy: 40.04
Round  52, Train loss: 0.770, Test loss: 1.488, Test accuracy: 53.32
Round  52, Global train loss: 0.770, Global test loss: 1.793, Global test accuracy: 45.64
Round  53, Train loss: 0.770, Test loss: 1.516, Test accuracy: 52.54
Round  53, Global train loss: 0.770, Global test loss: 1.848, Global test accuracy: 48.22
Round  54, Train loss: 0.894, Test loss: 1.463, Test accuracy: 53.14
Round  54, Global train loss: 0.894, Global test loss: 1.806, Global test accuracy: 47.22
Round  55, Train loss: 0.695, Test loss: 1.462, Test accuracy: 53.42
Round  55, Global train loss: 0.695, Global test loss: 1.821, Global test accuracy: 46.02
Round  56, Train loss: 0.875, Test loss: 1.528, Test accuracy: 52.46
Round  56, Global train loss: 0.875, Global test loss: 1.904, Global test accuracy: 42.66
Round  57, Train loss: 0.579, Test loss: 1.539, Test accuracy: 52.96
Round  57, Global train loss: 0.579, Global test loss: 1.983, Global test accuracy: 46.96
Round  58, Train loss: 0.726, Test loss: 1.562, Test accuracy: 53.24
Round  58, Global train loss: 0.726, Global test loss: 1.766, Global test accuracy: 47.46
Round  59, Train loss: 0.795, Test loss: 1.612, Test accuracy: 52.80
Round  59, Global train loss: 0.795, Global test loss: 1.903, Global test accuracy: 43.48
Round  60, Train loss: 0.550, Test loss: 1.653, Test accuracy: 52.58
Round  60, Global train loss: 0.550, Global test loss: 1.673, Global test accuracy: 53.84
Round  61, Train loss: 0.813, Test loss: 1.678, Test accuracy: 52.92
Round  61, Global train loss: 0.813, Global test loss: 1.781, Global test accuracy: 45.34
Round  62, Train loss: 0.612, Test loss: 1.671, Test accuracy: 53.08
Round  62, Global train loss: 0.612, Global test loss: 1.827, Global test accuracy: 50.92
Round  63, Train loss: 0.673, Test loss: 1.698, Test accuracy: 52.76
Round  63, Global train loss: 0.673, Global test loss: 1.924, Global test accuracy: 46.02
Round  64, Train loss: 0.711, Test loss: 1.737, Test accuracy: 52.34
Round  64, Global train loss: 0.711, Global test loss: 1.895, Global test accuracy: 46.18
Round  65, Train loss: 0.652, Test loss: 1.751, Test accuracy: 52.04
Round  65, Global train loss: 0.652, Global test loss: 2.025, Global test accuracy: 44.38
Round  66, Train loss: 0.531, Test loss: 1.746, Test accuracy: 52.04
Round  66, Global train loss: 0.531, Global test loss: 2.029, Global test accuracy: 45.58
Round  67, Train loss: 0.443, Test loss: 1.828, Test accuracy: 51.48
Round  67, Global train loss: 0.443, Global test loss: 2.253, Global test accuracy: 46.42
Round  68, Train loss: 0.943, Test loss: 1.786, Test accuracy: 52.56
Round  68, Global train loss: 0.943, Global test loss: 2.352, Global test accuracy: 34.50
Round  69, Train loss: 0.505, Test loss: 1.762, Test accuracy: 53.00
Round  69, Global train loss: 0.505, Global test loss: 2.126, Global test accuracy: 45.80
Round  70, Train loss: 0.380, Test loss: 1.769, Test accuracy: 52.80
Round  70, Global train loss: 0.380, Global test loss: 2.022, Global test accuracy: 49.40
Round  71, Train loss: 0.349, Test loss: 1.809, Test accuracy: 52.54
Round  71, Global train loss: 0.349, Global test loss: 2.282, Global test accuracy: 52.00
Round  72, Train loss: 0.681, Test loss: 1.844, Test accuracy: 52.48
Round  72, Global train loss: 0.681, Global test loss: 2.285, Global test accuracy: 42.34
Round  73, Train loss: 0.456, Test loss: 1.976, Test accuracy: 51.34
Round  73, Global train loss: 0.456, Global test loss: 2.281, Global test accuracy: 43.62
Round  74, Train loss: 0.541, Test loss: 2.001, Test accuracy: 51.62
Round  74, Global train loss: 0.541, Global test loss: 2.149, Global test accuracy: 47.00
Round  75, Train loss: 0.805, Test loss: 2.008, Test accuracy: 51.50
Round  75, Global train loss: 0.805, Global test loss: 2.740, Global test accuracy: 30.22
Round  76, Train loss: 0.456, Test loss: 2.029, Test accuracy: 51.66
Round  76, Global train loss: 0.456, Global test loss: 2.574, Global test accuracy: 40.24
Round  77, Train loss: 0.339, Test loss: 2.099, Test accuracy: 51.64
Round  77, Global train loss: 0.339, Global test loss: 2.681, Global test accuracy: 45.70
Round  78, Train loss: 0.517, Test loss: 2.174, Test accuracy: 51.54
Round  78, Global train loss: 0.517, Global test loss: 2.704, Global test accuracy: 41.02
Round  79, Train loss: 0.349, Test loss: 2.006, Test accuracy: 52.32
Round  79, Global train loss: 0.349, Global test loss: 2.587, Global test accuracy: 43.08
Round  80, Train loss: 0.481, Test loss: 2.050, Test accuracy: 51.48
Round  80, Global train loss: 0.481, Global test loss: 2.392, Global test accuracy: 43.02
Round  81, Train loss: 0.443, Test loss: 2.090, Test accuracy: 51.20
Round  81, Global train loss: 0.443, Global test loss: 2.309, Global test accuracy: 42.36
Round  82, Train loss: 0.387, Test loss: 2.062, Test accuracy: 51.10
Round  82, Global train loss: 0.387, Global test loss: 2.153, Global test accuracy: 49.94
Round  83, Train loss: 0.722, Test loss: 2.101, Test accuracy: 50.74
Round  83, Global train loss: 0.722, Global test loss: 2.664, Global test accuracy: 32.56
Round  84, Train loss: 0.272, Test loss: 2.196, Test accuracy: 49.52
Round  84, Global train loss: 0.272, Global test loss: 2.508, Global test accuracy: 49.46
Round  85, Train loss: 0.299, Test loss: 2.161, Test accuracy: 50.14
Round  85, Global train loss: 0.299, Global test loss: 2.158, Global test accuracy: 49.82
Round  86, Train loss: 0.332, Test loss: 2.156, Test accuracy: 50.46
Round  86, Global train loss: 0.332, Global test loss: 2.424, Global test accuracy: 45.56
Round  87, Train loss: 0.513, Test loss: 2.178, Test accuracy: 49.96
Round  87, Global train loss: 0.513, Global test loss: 2.267, Global test accuracy: 43.56
Round  88, Train loss: 0.288, Test loss: 2.209, Test accuracy: 50.32
Round  88, Global train loss: 0.288, Global test loss: 2.602, Global test accuracy: 46.42
Round  89, Train loss: 0.307, Test loss: 2.162, Test accuracy: 51.46
Round  89, Global train loss: 0.307, Global test loss: 2.363, Global test accuracy: 51.40
Round  90, Train loss: 0.554, Test loss: 2.152, Test accuracy: 52.46
Round  90, Global train loss: 0.554, Global test loss: 2.437, Global test accuracy: 40.84
Round  91, Train loss: 0.571, Test loss: 2.170, Test accuracy: 52.90
Round  91, Global train loss: 0.571, Global test loss: 2.714, Global test accuracy: 35.06
Round  92, Train loss: 0.323, Test loss: 2.238, Test accuracy: 52.20
Round  92, Global train loss: 0.323, Global test loss: 2.565, Global test accuracy: 42.52
Round  93, Train loss: 0.249, Test loss: 2.299, Test accuracy: 51.92
Round  93, Global train loss: 0.249, Global test loss: 2.339, Global test accuracy: 50.86
Round  94, Train loss: 0.549, Test loss: 2.230, Test accuracy: 52.26
Round  94, Global train loss: 0.549, Global test loss: 2.822, Global test accuracy: 31.00
Round  95, Train loss: 0.399, Test loss: 2.182, Test accuracy: 52.74
Round  95, Global train loss: 0.399, Global test loss: 2.662, Global test accuracy: 48.06
Round  96, Train loss: 0.177, Test loss: 2.228, Test accuracy: 52.18
Round  96, Global train loss: 0.177, Global test loss: 2.768, Global test accuracy: 47.68
Round  97, Train loss: 0.536, Test loss: 2.303, Test accuracy: 52.26
Round  97, Global train loss: 0.536, Global test loss: 2.857, Global test accuracy: 34.66
Round  98, Train loss: 0.299, Test loss: 2.295, Test accuracy: 52.50
Round  98, Global train loss: 0.299, Global test loss: 3.020, Global test accuracy: 45.26
Round  99, Train loss: 0.269, Test loss: 2.420, Test accuracy: 51.34
Round  99, Global train loss: 0.269, Global test loss: 2.535, Global test accuracy: 47.10
Final Round, Train loss: 0.305, Test loss: 2.469, Test accuracy: 50.88
Final Round, Global train loss: 0.305, Global test loss: 2.535, Global test accuracy: 47.10
Average accuracy final 10 rounds: 52.275999999999996 

Average global accuracy final 10 rounds: 42.30400000000001 

810.9021179676056
[1.5256223678588867, 3.0512447357177734, 4.185162782669067, 5.319080829620361, 6.482349872589111, 7.645618915557861, 8.787078142166138, 9.928537368774414, 11.07987904548645, 12.231220722198486, 13.368151903152466, 14.505083084106445, 15.64531397819519, 16.785544872283936, 17.945805549621582, 19.10606622695923, 20.3100905418396, 21.51411485671997, 22.704193353652954, 23.894271850585938, 25.086201906204224, 26.27813196182251, 27.473848581314087, 28.669565200805664, 29.896180868148804, 31.122796535491943, 32.2793333530426, 33.43587017059326, 34.55852961540222, 35.68118906021118, 36.8224515914917, 37.96371412277222, 39.10462999343872, 40.245545864105225, 41.38502526283264, 42.52450466156006, 43.665998220443726, 44.80749177932739, 45.94186305999756, 47.076234340667725, 48.21284866333008, 49.34946298599243, 50.487807273864746, 51.62615156173706, 52.77723836898804, 53.928325176239014, 55.0835497379303, 56.23877429962158, 57.36933493614197, 58.49989557266235, 59.61624073982239, 60.73258590698242, 61.88758087158203, 63.04257583618164, 64.28100252151489, 65.51942920684814, 66.67868518829346, 67.83794116973877, 68.96257138252258, 70.0872015953064, 71.21073842048645, 72.3342752456665, 73.4364562034607, 74.53863716125488, 75.67603945732117, 76.81344175338745, 77.97718691825867, 79.14093208312988, 80.28563785552979, 81.43034362792969, 82.62273669242859, 83.81512975692749, 84.9523651599884, 86.08960056304932, 87.30940985679626, 88.52921915054321, 89.67716693878174, 90.82511472702026, 91.93938684463501, 93.05365896224976, 94.17756462097168, 95.3014702796936, 96.46210885047913, 97.62274742126465, 98.87286972999573, 100.1229920387268, 101.35687136650085, 102.5907506942749, 103.74183988571167, 104.89292907714844, 106.10970902442932, 107.3264889717102, 108.52121829986572, 109.71594762802124, 110.92803049087524, 112.14011335372925, 113.38748359680176, 114.63485383987427, 115.87001895904541, 117.10518407821655, 118.24228167533875, 119.37937927246094, 120.52915906906128, 121.67893886566162, 122.81991052627563, 123.96088218688965, 125.24344778060913, 126.52601337432861, 127.77288341522217, 129.01975345611572, 130.2327892780304, 131.44582509994507, 132.72712969779968, 134.0084342956543, 135.23625588417053, 136.46407747268677, 137.70523166656494, 138.94638586044312, 140.21839046478271, 141.49039506912231, 142.76626443862915, 144.042133808136, 145.2528579235077, 146.4635820388794, 147.58359718322754, 148.70361232757568, 149.90835118293762, 151.11309003829956, 152.3443968296051, 153.57570362091064, 154.82474374771118, 156.07378387451172, 157.20403385162354, 158.33428382873535, 159.45265126228333, 160.5710186958313, 161.71795296669006, 162.86488723754883, 164.0681712627411, 165.27145528793335, 166.55688333511353, 167.8423113822937, 169.07687759399414, 170.31144380569458, 171.45830297470093, 172.60516214370728, 173.7394359111786, 174.8737096786499, 175.99890208244324, 177.12409448623657, 178.26737427711487, 179.41065406799316, 180.5639193058014, 181.71718454360962, 182.8458309173584, 183.97447729110718, 185.1288619041443, 186.2832465171814, 187.4341275691986, 188.58500862121582, 189.7239270210266, 190.8628454208374, 192.08893942832947, 193.31503343582153, 194.534818649292, 195.75460386276245, 196.91512823104858, 198.07565259933472, 199.21045351028442, 200.34525442123413, 201.47675967216492, 202.6082649230957, 203.76651287078857, 204.92476081848145, 206.05292344093323, 207.181086063385, 208.3188338279724, 209.45658159255981, 210.59283113479614, 211.72908067703247, 212.84911012649536, 213.96913957595825, 215.09325218200684, 216.21736478805542, 217.36415314674377, 218.51094150543213, 219.65082383155823, 220.79070615768433, 221.9232234954834, 223.05574083328247, 224.1855866909027, 225.31543254852295, 226.51263284683228, 227.7098331451416, 228.9332296848297, 230.15662622451782, 231.3211271762848, 232.48562812805176, 233.8815460205078, 235.27746391296387, 237.753520488739, 240.22957706451416]
[13.6, 13.6, 22.42, 22.42, 32.64, 32.64, 34.52, 34.52, 35.7, 35.7, 42.86, 42.86, 41.26, 41.26, 43.52, 43.52, 49.42, 49.42, 48.76, 48.76, 51.82, 51.82, 53.44, 53.44, 54.0, 54.0, 53.68, 53.68, 54.38, 54.38, 55.18, 55.18, 55.82, 55.82, 56.22, 56.22, 57.58, 57.58, 57.68, 57.68, 56.18, 56.18, 55.38, 55.38, 55.48, 55.48, 55.28, 55.28, 56.12, 56.12, 57.7, 57.7, 57.74, 57.74, 57.88, 57.88, 57.94, 57.94, 57.24, 57.24, 56.6, 56.6, 57.1, 57.1, 57.9, 57.9, 57.64, 57.64, 58.18, 58.18, 57.72, 57.72, 56.9, 56.9, 57.02, 57.02, 56.72, 56.72, 57.18, 57.18, 56.18, 56.18, 55.7, 55.7, 56.82, 56.82, 56.1, 56.1, 56.32, 56.32, 55.76, 55.76, 56.12, 56.12, 54.28, 54.28, 54.76, 54.76, 54.52, 54.52, 54.18, 54.18, 53.84, 53.84, 53.32, 53.32, 52.54, 52.54, 53.14, 53.14, 53.42, 53.42, 52.46, 52.46, 52.96, 52.96, 53.24, 53.24, 52.8, 52.8, 52.58, 52.58, 52.92, 52.92, 53.08, 53.08, 52.76, 52.76, 52.34, 52.34, 52.04, 52.04, 52.04, 52.04, 51.48, 51.48, 52.56, 52.56, 53.0, 53.0, 52.8, 52.8, 52.54, 52.54, 52.48, 52.48, 51.34, 51.34, 51.62, 51.62, 51.5, 51.5, 51.66, 51.66, 51.64, 51.64, 51.54, 51.54, 52.32, 52.32, 51.48, 51.48, 51.2, 51.2, 51.1, 51.1, 50.74, 50.74, 49.52, 49.52, 50.14, 50.14, 50.46, 50.46, 49.96, 49.96, 50.32, 50.32, 51.46, 51.46, 52.46, 52.46, 52.9, 52.9, 52.2, 52.2, 51.92, 51.92, 52.26, 52.26, 52.74, 52.74, 52.18, 52.18, 52.26, 52.26, 52.5, 52.5, 51.34, 51.34, 50.88, 50.88]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.883, Test loss: 2.178, Test accuracy: 16.62
Round   0, Global train loss: 1.883, Global test loss: 2.325, Global test accuracy: 15.64
Round   1, Train loss: 1.850, Test loss: 2.138, Test accuracy: 19.40
Round   1, Global train loss: 1.850, Global test loss: 2.303, Global test accuracy: 18.30
Round   2, Train loss: 1.762, Test loss: 1.742, Test accuracy: 34.22
Round   2, Global train loss: 1.762, Global test loss: 2.127, Global test accuracy: 26.76
Round   3, Train loss: 1.525, Test loss: 1.718, Test accuracy: 35.60
Round   3, Global train loss: 1.525, Global test loss: 2.231, Global test accuracy: 24.64
Round   4, Train loss: 1.630, Test loss: 1.610, Test accuracy: 38.78
Round   4, Global train loss: 1.630, Global test loss: 2.054, Global test accuracy: 32.46
Round   5, Train loss: 1.711, Test loss: 1.526, Test accuracy: 44.62
Round   5, Global train loss: 1.711, Global test loss: 2.021, Global test accuracy: 35.36
Round   6, Train loss: 1.719, Test loss: 1.550, Test accuracy: 42.40
Round   6, Global train loss: 1.719, Global test loss: 2.079, Global test accuracy: 31.62
Round   7, Train loss: 1.676, Test loss: 1.383, Test accuracy: 47.24
Round   7, Global train loss: 1.676, Global test loss: 1.991, Global test accuracy: 28.02
Round   8, Train loss: 1.427, Test loss: 1.338, Test accuracy: 50.78
Round   8, Global train loss: 1.427, Global test loss: 1.798, Global test accuracy: 40.26
Round   9, Train loss: 1.455, Test loss: 1.352, Test accuracy: 50.30
Round   9, Global train loss: 1.455, Global test loss: 1.944, Global test accuracy: 37.36
Round  10, Train loss: 1.607, Test loss: 1.303, Test accuracy: 52.58
Round  10, Global train loss: 1.607, Global test loss: 1.907, Global test accuracy: 35.80
Round  11, Train loss: 1.533, Test loss: 1.269, Test accuracy: 54.98
Round  11, Global train loss: 1.533, Global test loss: 1.776, Global test accuracy: 41.94
Round  12, Train loss: 1.549, Test loss: 1.259, Test accuracy: 54.64
Round  12, Global train loss: 1.549, Global test loss: 1.870, Global test accuracy: 35.74
Round  13, Train loss: 1.339, Test loss: 1.244, Test accuracy: 55.20
Round  13, Global train loss: 1.339, Global test loss: 1.704, Global test accuracy: 41.96
Round  14, Train loss: 1.529, Test loss: 1.251, Test accuracy: 55.56
Round  14, Global train loss: 1.529, Global test loss: 1.782, Global test accuracy: 39.82
Round  15, Train loss: 1.298, Test loss: 1.241, Test accuracy: 56.02
Round  15, Global train loss: 1.298, Global test loss: 1.757, Global test accuracy: 40.88
Round  16, Train loss: 1.586, Test loss: 1.246, Test accuracy: 55.36
Round  16, Global train loss: 1.586, Global test loss: 1.911, Global test accuracy: 40.72
Round  17, Train loss: 1.374, Test loss: 1.250, Test accuracy: 55.42
Round  17, Global train loss: 1.374, Global test loss: 1.775, Global test accuracy: 42.24
Round  18, Train loss: 0.944, Test loss: 1.235, Test accuracy: 56.26
Round  18, Global train loss: 0.944, Global test loss: 1.838, Global test accuracy: 43.56
Round  19, Train loss: 1.272, Test loss: 1.234, Test accuracy: 55.66
Round  19, Global train loss: 1.272, Global test loss: 1.567, Global test accuracy: 46.58
Round  20, Train loss: 1.155, Test loss: 1.217, Test accuracy: 55.84
Round  20, Global train loss: 1.155, Global test loss: 1.562, Global test accuracy: 47.34
Round  21, Train loss: 1.573, Test loss: 1.180, Test accuracy: 59.16
Round  21, Global train loss: 1.573, Global test loss: 1.797, Global test accuracy: 41.14
Round  22, Train loss: 1.182, Test loss: 1.155, Test accuracy: 60.42
Round  22, Global train loss: 1.182, Global test loss: 1.595, Global test accuracy: 47.80
Round  23, Train loss: 1.789, Test loss: 1.136, Test accuracy: 59.90
Round  23, Global train loss: 1.789, Global test loss: 1.962, Global test accuracy: 43.06
Round  24, Train loss: 1.142, Test loss: 1.162, Test accuracy: 58.56
Round  24, Global train loss: 1.142, Global test loss: 1.529, Global test accuracy: 50.14
Round  25, Train loss: 1.268, Test loss: 1.154, Test accuracy: 59.38
Round  25, Global train loss: 1.268, Global test loss: 1.447, Global test accuracy: 57.00
Round  26, Train loss: 1.210, Test loss: 1.189, Test accuracy: 57.06
Round  26, Global train loss: 1.210, Global test loss: 1.477, Global test accuracy: 53.86
Round  27, Train loss: 1.048, Test loss: 1.198, Test accuracy: 57.12
Round  27, Global train loss: 1.048, Global test loss: 1.481, Global test accuracy: 51.76
Round  28, Train loss: 1.499, Test loss: 1.150, Test accuracy: 58.56
Round  28, Global train loss: 1.499, Global test loss: 1.652, Global test accuracy: 47.50
Round  29, Train loss: 1.439, Test loss: 1.144, Test accuracy: 58.60
Round  29, Global train loss: 1.439, Global test loss: 1.773, Global test accuracy: 43.72
Round  30, Train loss: 1.085, Test loss: 1.139, Test accuracy: 60.70
Round  30, Global train loss: 1.085, Global test loss: 1.669, Global test accuracy: 43.46
Round  31, Train loss: 1.150, Test loss: 1.157, Test accuracy: 60.68
Round  31, Global train loss: 1.150, Global test loss: 1.573, Global test accuracy: 49.58
Round  32, Train loss: 1.007, Test loss: 1.161, Test accuracy: 61.18
Round  32, Global train loss: 1.007, Global test loss: 1.621, Global test accuracy: 47.44
Round  33, Train loss: 0.891, Test loss: 1.183, Test accuracy: 59.96
Round  33, Global train loss: 0.891, Global test loss: 1.555, Global test accuracy: 50.92
Round  34, Train loss: 1.145, Test loss: 1.180, Test accuracy: 59.90
Round  34, Global train loss: 1.145, Global test loss: 1.619, Global test accuracy: 46.40
Round  35, Train loss: 0.613, Test loss: 1.171, Test accuracy: 60.28
Round  35, Global train loss: 0.613, Global test loss: 2.064, Global test accuracy: 46.06
Round  36, Train loss: 1.194, Test loss: 1.170, Test accuracy: 61.02
Round  36, Global train loss: 1.194, Global test loss: 1.638, Global test accuracy: 47.36
Round  37, Train loss: 0.904, Test loss: 1.146, Test accuracy: 61.86
Round  37, Global train loss: 0.904, Global test loss: 1.562, Global test accuracy: 50.30
Round  38, Train loss: 0.941, Test loss: 1.160, Test accuracy: 61.58
Round  38, Global train loss: 0.941, Global test loss: 1.528, Global test accuracy: 51.72
Round  39, Train loss: 1.121, Test loss: 1.171, Test accuracy: 60.72
Round  39, Global train loss: 1.121, Global test loss: 1.661, Global test accuracy: 48.58
Round  40, Train loss: 0.678, Test loss: 1.170, Test accuracy: 60.96
Round  40, Global train loss: 0.678, Global test loss: 1.510, Global test accuracy: 54.44
Round  41, Train loss: 1.294, Test loss: 1.180, Test accuracy: 60.16
Round  41, Global train loss: 1.294, Global test loss: 1.656, Global test accuracy: 47.86
Round  42, Train loss: 0.506, Test loss: 1.183, Test accuracy: 60.46
Round  42, Global train loss: 0.506, Global test loss: 1.380, Global test accuracy: 58.82
Round  43, Train loss: 1.017, Test loss: 1.177, Test accuracy: 59.66
Round  43, Global train loss: 1.017, Global test loss: 1.515, Global test accuracy: 51.70
Round  44, Train loss: 1.340, Test loss: 1.178, Test accuracy: 60.18
Round  44, Global train loss: 1.340, Global test loss: 1.754, Global test accuracy: 43.38
Round  45, Train loss: 0.829, Test loss: 1.179, Test accuracy: 60.28
Round  45, Global train loss: 0.829, Global test loss: 1.485, Global test accuracy: 53.18
Round  46, Train loss: 0.958, Test loss: 1.190, Test accuracy: 60.38
Round  46, Global train loss: 0.958, Global test loss: 1.610, Global test accuracy: 49.42
Round  47, Train loss: 0.921, Test loss: 1.192, Test accuracy: 59.32
Round  47, Global train loss: 0.921, Global test loss: 1.663, Global test accuracy: 48.06
Round  48, Train loss: 0.951, Test loss: 1.186, Test accuracy: 59.88
Round  48, Global train loss: 0.951, Global test loss: 1.410, Global test accuracy: 55.86
Round  49, Train loss: 0.831, Test loss: 1.191, Test accuracy: 59.56
Round  49, Global train loss: 0.831, Global test loss: 1.625, Global test accuracy: 51.08
Round  50, Train loss: 0.788, Test loss: 1.227, Test accuracy: 58.82
Round  50, Global train loss: 0.788, Global test loss: 1.435, Global test accuracy: 55.76
Round  51, Train loss: 1.514, Test loss: 1.236, Test accuracy: 59.30
Round  51, Global train loss: 1.514, Global test loss: 1.820, Global test accuracy: 44.60
Round  52, Train loss: 1.463, Test loss: 1.267, Test accuracy: 57.84
Round  52, Global train loss: 1.463, Global test loss: 2.011, Global test accuracy: 38.18
Round  53, Train loss: 0.896, Test loss: 1.267, Test accuracy: 57.76
Round  53, Global train loss: 0.896, Global test loss: 1.708, Global test accuracy: 46.08
Round  54, Train loss: 0.605, Test loss: 1.288, Test accuracy: 57.28
Round  54, Global train loss: 0.605, Global test loss: 1.554, Global test accuracy: 52.86
Round  55, Train loss: 1.050, Test loss: 1.260, Test accuracy: 59.06
Round  55, Global train loss: 1.050, Global test loss: 1.676, Global test accuracy: 46.54
Round  56, Train loss: 0.784, Test loss: 1.249, Test accuracy: 59.90
Round  56, Global train loss: 0.784, Global test loss: 1.668, Global test accuracy: 53.06
Round  57, Train loss: 1.024, Test loss: 1.249, Test accuracy: 59.96
Round  57, Global train loss: 1.024, Global test loss: 1.846, Global test accuracy: 43.70
Round  58, Train loss: 1.032, Test loss: 1.257, Test accuracy: 59.24
Round  58, Global train loss: 1.032, Global test loss: 1.801, Global test accuracy: 44.18
Round  59, Train loss: 0.719, Test loss: 1.273, Test accuracy: 59.64
Round  59, Global train loss: 0.719, Global test loss: 1.567, Global test accuracy: 53.34
Round  60, Train loss: 0.725, Test loss: 1.335, Test accuracy: 58.52
Round  60, Global train loss: 0.725, Global test loss: 1.554, Global test accuracy: 54.58
Round  61, Train loss: 0.794, Test loss: 1.365, Test accuracy: 58.12
Round  61, Global train loss: 0.794, Global test loss: 1.490, Global test accuracy: 55.28
Round  62, Train loss: 0.962, Test loss: 1.345, Test accuracy: 57.68
Round  62, Global train loss: 0.962, Global test loss: 1.735, Global test accuracy: 46.96
Round  63, Train loss: 0.452, Test loss: 1.399, Test accuracy: 56.92
Round  63, Global train loss: 0.452, Global test loss: 1.708, Global test accuracy: 54.46
Round  64, Train loss: 0.743, Test loss: 1.394, Test accuracy: 56.58
Round  64, Global train loss: 0.743, Global test loss: 1.621, Global test accuracy: 52.06
Round  65, Train loss: 0.939, Test loss: 1.416, Test accuracy: 57.24
Round  65, Global train loss: 0.939, Global test loss: 1.965, Global test accuracy: 40.88
Round  66, Train loss: 0.808, Test loss: 1.442, Test accuracy: 57.32
Round  66, Global train loss: 0.808, Global test loss: 1.914, Global test accuracy: 43.38
Round  67, Train loss: 0.338, Test loss: 1.434, Test accuracy: 57.18
Round  67, Global train loss: 0.338, Global test loss: 1.794, Global test accuracy: 54.68
Round  68, Train loss: 0.716, Test loss: 1.456, Test accuracy: 56.32
Round  68, Global train loss: 0.716, Global test loss: 1.678, Global test accuracy: 50.66
Round  69, Train loss: 0.597, Test loss: 1.473, Test accuracy: 56.16
Round  69, Global train loss: 0.597, Global test loss: 1.617, Global test accuracy: 53.36
Round  70, Train loss: 0.848, Test loss: 1.437, Test accuracy: 57.60
Round  70, Global train loss: 0.848, Global test loss: 1.727, Global test accuracy: 49.78
Round  71, Train loss: 0.586, Test loss: 1.432, Test accuracy: 57.28
Round  71, Global train loss: 0.586, Global test loss: 2.040, Global test accuracy: 47.14
Round  72, Train loss: 1.021, Test loss: 1.527, Test accuracy: 56.88
Round  72, Global train loss: 1.021, Global test loss: 2.418, Global test accuracy: 33.70
Round  73, Train loss: 0.546, Test loss: 1.561, Test accuracy: 57.20
Round  73, Global train loss: 0.546, Global test loss: 1.925, Global test accuracy: 48.16
Round  74, Train loss: 0.591, Test loss: 1.550, Test accuracy: 57.08
Round  74, Global train loss: 0.591, Global test loss: 1.918, Global test accuracy: 46.86
Round  75, Train loss: 0.635, Test loss: 1.569, Test accuracy: 57.18
Round  75, Global train loss: 0.635, Global test loss: 1.813, Global test accuracy: 48.28
Round  76, Train loss: 0.679, Test loss: 1.570, Test accuracy: 57.08
Round  76, Global train loss: 0.679, Global test loss: 2.194, Global test accuracy: 38.02
Round  77, Train loss: 0.664, Test loss: 1.598, Test accuracy: 57.34
Round  77, Global train loss: 0.664, Global test loss: 2.324, Global test accuracy: 40.16
Round  78, Train loss: 0.535, Test loss: 1.612, Test accuracy: 57.64
Round  78, Global train loss: 0.535, Global test loss: 2.101, Global test accuracy: 42.30
Round  79, Train loss: 0.635, Test loss: 1.625, Test accuracy: 56.46
Round  79, Global train loss: 0.635, Global test loss: 2.421, Global test accuracy: 38.26
Round  80, Train loss: 0.371, Test loss: 1.650, Test accuracy: 56.56
Round  80, Global train loss: 0.371, Global test loss: 1.941, Global test accuracy: 52.08
Round  81, Train loss: 0.591, Test loss: 1.723, Test accuracy: 55.56
Round  81, Global train loss: 0.591, Global test loss: 2.116, Global test accuracy: 46.92
Round  82, Train loss: 0.485, Test loss: 1.705, Test accuracy: 55.72
Round  82, Global train loss: 0.485, Global test loss: 2.127, Global test accuracy: 46.78
Round  83, Train loss: 0.579, Test loss: 1.776, Test accuracy: 55.18
Round  83, Global train loss: 0.579, Global test loss: 1.984, Global test accuracy: 49.02
Round  84, Train loss: 0.685, Test loss: 1.792, Test accuracy: 55.04
Round  84, Global train loss: 0.685, Global test loss: 2.157, Global test accuracy: 44.58
Round  85, Train loss: 0.511, Test loss: 1.833, Test accuracy: 54.10
Round  85, Global train loss: 0.511, Global test loss: 2.096, Global test accuracy: 49.52
Round  86, Train loss: 0.442, Test loss: 1.744, Test accuracy: 56.06
Round  86, Global train loss: 0.442, Global test loss: 2.137, Global test accuracy: 49.84
Round  87, Train loss: 0.520, Test loss: 1.757, Test accuracy: 56.26
Round  87, Global train loss: 0.520, Global test loss: 1.943, Global test accuracy: 52.04
Round  88, Train loss: 0.180, Test loss: 1.796, Test accuracy: 56.72
Round  88, Global train loss: 0.180, Global test loss: 2.528, Global test accuracy: 53.06
Round  89, Train loss: 0.405, Test loss: 1.843, Test accuracy: 56.64
Round  89, Global train loss: 0.405, Global test loss: 2.063, Global test accuracy: 51.02
Round  90, Train loss: 0.533, Test loss: 1.781, Test accuracy: 56.58
Round  90, Global train loss: 0.533, Global test loss: 1.772, Global test accuracy: 54.54
Round  91, Train loss: 0.680, Test loss: 1.756, Test accuracy: 58.08
Round  91, Global train loss: 0.680, Global test loss: 1.949, Global test accuracy: 47.04
Round  92, Train loss: 0.380, Test loss: 1.804, Test accuracy: 57.16
Round  92, Global train loss: 0.380, Global test loss: 1.961, Global test accuracy: 54.10
Round  93, Train loss: 0.245, Test loss: 1.813, Test accuracy: 57.26
Round  93, Global train loss: 0.245, Global test loss: 1.997, Global test accuracy: 59.00
Round  94, Train loss: 0.610, Test loss: 1.828, Test accuracy: 56.74
Round  94, Global train loss: 0.610, Global test loss: 2.058, Global test accuracy: 47.86/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.478, Test loss: 1.778, Test accuracy: 58.06
Round  95, Global train loss: 0.478, Global test loss: 2.108, Global test accuracy: 48.80
Round  96, Train loss: 0.337, Test loss: 1.841, Test accuracy: 57.42
Round  96, Global train loss: 0.337, Global test loss: 2.260, Global test accuracy: 50.88
Round  97, Train loss: 0.571, Test loss: 1.843, Test accuracy: 56.98
Round  97, Global train loss: 0.571, Global test loss: 2.162, Global test accuracy: 44.92
Round  98, Train loss: 0.385, Test loss: 1.890, Test accuracy: 56.08
Round  98, Global train loss: 0.385, Global test loss: 2.196, Global test accuracy: 47.30
Round  99, Train loss: 0.560, Test loss: 1.851, Test accuracy: 56.46
Round  99, Global train loss: 0.560, Global test loss: 2.399, Global test accuracy: 42.64
Final Round, Train loss: 0.363, Test loss: 2.000, Test accuracy: 57.04
Final Round, Global train loss: 0.363, Global test loss: 2.399, Global test accuracy: 42.64
Average accuracy final 10 rounds: 57.081999999999994 

Average global accuracy final 10 rounds: 49.70799999999999 

831.9943423271179
[1.5399622917175293, 3.0799245834350586, 4.317856788635254, 5.555788993835449, 6.759463787078857, 7.963138580322266, 9.18812108039856, 10.413103580474854, 11.633666753768921, 12.854229927062988, 14.081263065338135, 15.308296203613281, 16.536231756210327, 17.764167308807373, 18.98937726020813, 20.214587211608887, 21.455707788467407, 22.696828365325928, 23.9339382648468, 25.171048164367676, 26.433144569396973, 27.69524097442627, 28.92965841293335, 30.16407585144043, 31.46873140335083, 32.77338695526123, 34.1148636341095, 35.456340312957764, 36.77989912033081, 38.10345792770386, 39.36372494697571, 40.62399196624756, 41.98370885848999, 43.34342575073242, 44.629565715789795, 45.91570568084717, 47.287007093429565, 48.65830850601196, 50.01915431022644, 51.38000011444092, 52.70642638206482, 54.03285264968872, 55.31814956665039, 56.60344648361206, 57.85163950920105, 59.09983253479004, 60.354090452194214, 61.60834836959839, 63.042630672454834, 64.47691297531128, 65.77486062049866, 67.07280826568604, 68.29388761520386, 69.51496696472168, 70.77925133705139, 72.0435357093811, 73.29467439651489, 74.54581308364868, 75.79541563987732, 77.04501819610596, 78.29075145721436, 79.53648471832275, 80.78730154037476, 82.03811836242676, 83.30069041252136, 84.56326246261597, 85.80680060386658, 87.05033874511719, 88.32007598876953, 89.58981323242188, 90.8990330696106, 92.20825290679932, 93.58024477958679, 94.95223665237427, 96.29643511772156, 97.64063358306885, 98.93754458427429, 100.23445558547974, 101.52623391151428, 102.81801223754883, 104.08127999305725, 105.34454774856567, 106.57742762565613, 107.81030750274658, 109.0440022945404, 110.27769708633423, 111.51171135902405, 112.74572563171387, 114.00119233131409, 115.2566590309143, 116.48913717269897, 117.72161531448364, 118.91752672195435, 120.11343812942505, 121.32334232330322, 122.5332465171814, 123.78010892868042, 125.02697134017944, 126.2695951461792, 127.51221895217896, 128.75811982154846, 130.00402069091797, 131.35509848594666, 132.70617628097534, 133.93860363960266, 135.17103099822998, 136.52383184432983, 137.8766326904297, 139.1767716407776, 140.4769105911255, 141.69386839866638, 142.91082620620728, 144.243266582489, 145.57570695877075, 146.87716245651245, 148.17861795425415, 149.42368268966675, 150.66874742507935, 151.91214680671692, 153.1555461883545, 154.41082406044006, 155.66610193252563, 156.89390897750854, 158.12171602249146, 159.3276126384735, 160.53350925445557, 161.73338150978088, 162.9332537651062, 164.14492678642273, 165.35659980773926, 166.5673222541809, 167.77804470062256, 168.9913341999054, 170.20462369918823, 171.41280937194824, 172.62099504470825, 173.86101126670837, 175.1010274887085, 176.3303506374359, 177.55967378616333, 178.82788753509521, 180.0961012840271, 181.3751986026764, 182.65429592132568, 183.91534113883972, 185.17638635635376, 186.41311049461365, 187.64983463287354, 188.87908792495728, 190.10834121704102, 191.34178709983826, 192.5752329826355, 193.89605045318604, 195.21686792373657, 196.47062134742737, 197.72437477111816, 198.9224739074707, 200.12057304382324, 201.34889101982117, 202.5772089958191, 203.7906620502472, 205.0041151046753, 206.22370219230652, 207.44328927993774, 208.639830827713, 209.83637237548828, 211.05085921287537, 212.26534605026245, 213.52745985984802, 214.7895736694336, 216.00703859329224, 217.22450351715088, 218.48025035858154, 219.7359972000122, 221.15123891830444, 222.56648063659668, 223.89700388908386, 225.22752714157104, 226.54901385307312, 227.8705005645752, 229.1503427028656, 230.430184841156, 231.782399892807, 233.134614944458, 234.45955848693848, 235.78450202941895, 237.0749216079712, 238.36534118652344, 239.7437424659729, 241.12214374542236, 242.40008997917175, 243.67803621292114, 244.99835348129272, 246.3186707496643, 247.6510455608368, 248.98342037200928, 250.2659239768982, 251.5484275817871, 252.8622341156006, 254.17604064941406, 256.813280582428, 259.4505205154419]
[16.62, 16.62, 19.4, 19.4, 34.22, 34.22, 35.6, 35.6, 38.78, 38.78, 44.62, 44.62, 42.4, 42.4, 47.24, 47.24, 50.78, 50.78, 50.3, 50.3, 52.58, 52.58, 54.98, 54.98, 54.64, 54.64, 55.2, 55.2, 55.56, 55.56, 56.02, 56.02, 55.36, 55.36, 55.42, 55.42, 56.26, 56.26, 55.66, 55.66, 55.84, 55.84, 59.16, 59.16, 60.42, 60.42, 59.9, 59.9, 58.56, 58.56, 59.38, 59.38, 57.06, 57.06, 57.12, 57.12, 58.56, 58.56, 58.6, 58.6, 60.7, 60.7, 60.68, 60.68, 61.18, 61.18, 59.96, 59.96, 59.9, 59.9, 60.28, 60.28, 61.02, 61.02, 61.86, 61.86, 61.58, 61.58, 60.72, 60.72, 60.96, 60.96, 60.16, 60.16, 60.46, 60.46, 59.66, 59.66, 60.18, 60.18, 60.28, 60.28, 60.38, 60.38, 59.32, 59.32, 59.88, 59.88, 59.56, 59.56, 58.82, 58.82, 59.3, 59.3, 57.84, 57.84, 57.76, 57.76, 57.28, 57.28, 59.06, 59.06, 59.9, 59.9, 59.96, 59.96, 59.24, 59.24, 59.64, 59.64, 58.52, 58.52, 58.12, 58.12, 57.68, 57.68, 56.92, 56.92, 56.58, 56.58, 57.24, 57.24, 57.32, 57.32, 57.18, 57.18, 56.32, 56.32, 56.16, 56.16, 57.6, 57.6, 57.28, 57.28, 56.88, 56.88, 57.2, 57.2, 57.08, 57.08, 57.18, 57.18, 57.08, 57.08, 57.34, 57.34, 57.64, 57.64, 56.46, 56.46, 56.56, 56.56, 55.56, 55.56, 55.72, 55.72, 55.18, 55.18, 55.04, 55.04, 54.1, 54.1, 56.06, 56.06, 56.26, 56.26, 56.72, 56.72, 56.64, 56.64, 56.58, 56.58, 58.08, 58.08, 57.16, 57.16, 57.26, 57.26, 56.74, 56.74, 58.06, 58.06, 57.42, 57.42, 56.98, 56.98, 56.08, 56.08, 56.46, 56.46, 57.04, 57.04]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.891, Test loss: 2.133, Test accuracy: 18.66
Round   0, Global train loss: 1.891, Global test loss: 2.276, Global test accuracy: 15.90
Round   1, Train loss: 1.730, Test loss: 2.091, Test accuracy: 22.30
Round   1, Global train loss: 1.730, Global test loss: 2.271, Global test accuracy: 19.40
Round   2, Train loss: 1.804, Test loss: 1.793, Test accuracy: 29.96
Round   2, Global train loss: 1.804, Global test loss: 2.244, Global test accuracy: 17.16
Round   3, Train loss: 1.556, Test loss: 1.690, Test accuracy: 35.68
Round   3, Global train loss: 1.556, Global test loss: 2.081, Global test accuracy: 30.50
Round   4, Train loss: 1.732, Test loss: 1.668, Test accuracy: 36.60
Round   4, Global train loss: 1.732, Global test loss: 2.183, Global test accuracy: 26.80
Round   5, Train loss: 1.580, Test loss: 1.653, Test accuracy: 38.56
Round   5, Global train loss: 1.580, Global test loss: 2.189, Global test accuracy: 29.40
Round   6, Train loss: 1.568, Test loss: 1.629, Test accuracy: 38.52
Round   6, Global train loss: 1.568, Global test loss: 2.003, Global test accuracy: 32.20
Round   7, Train loss: 1.833, Test loss: 1.556, Test accuracy: 41.76
Round   7, Global train loss: 1.833, Global test loss: 2.184, Global test accuracy: 20.00
Round   8, Train loss: 1.554, Test loss: 1.449, Test accuracy: 46.02
Round   8, Global train loss: 1.554, Global test loss: 1.822, Global test accuracy: 33.64
Round   9, Train loss: 1.462, Test loss: 1.466, Test accuracy: 44.60
Round   9, Global train loss: 1.462, Global test loss: 1.982, Global test accuracy: 30.10
Round  10, Train loss: 1.452, Test loss: 1.380, Test accuracy: 48.64
Round  10, Global train loss: 1.452, Global test loss: 1.763, Global test accuracy: 41.46
Round  11, Train loss: 1.489, Test loss: 1.355, Test accuracy: 49.38
Round  11, Global train loss: 1.489, Global test loss: 1.757, Global test accuracy: 45.32
Round  12, Train loss: 1.824, Test loss: 1.344, Test accuracy: 50.76
Round  12, Global train loss: 1.824, Global test loss: 2.063, Global test accuracy: 25.30
Round  13, Train loss: 1.467, Test loss: 1.319, Test accuracy: 52.02
Round  13, Global train loss: 1.467, Global test loss: 1.719, Global test accuracy: 41.14
Round  14, Train loss: 1.428, Test loss: 1.310, Test accuracy: 52.30
Round  14, Global train loss: 1.428, Global test loss: 1.780, Global test accuracy: 35.02
Round  15, Train loss: 1.385, Test loss: 1.297, Test accuracy: 51.54
Round  15, Global train loss: 1.385, Global test loss: 1.706, Global test accuracy: 41.94
Round  16, Train loss: 1.199, Test loss: 1.279, Test accuracy: 52.46
Round  16, Global train loss: 1.199, Global test loss: 1.689, Global test accuracy: 43.76
Round  17, Train loss: 1.362, Test loss: 1.291, Test accuracy: 53.36
Round  17, Global train loss: 1.362, Global test loss: 1.656, Global test accuracy: 46.28
Round  18, Train loss: 1.307, Test loss: 1.283, Test accuracy: 54.08
Round  18, Global train loss: 1.307, Global test loss: 1.722, Global test accuracy: 43.48
Round  19, Train loss: 1.541, Test loss: 1.279, Test accuracy: 53.40
Round  19, Global train loss: 1.541, Global test loss: 1.763, Global test accuracy: 40.56
Round  20, Train loss: 1.507, Test loss: 1.268, Test accuracy: 53.48
Round  20, Global train loss: 1.507, Global test loss: 1.646, Global test accuracy: 49.50
Round  21, Train loss: 1.713, Test loss: 1.237, Test accuracy: 55.72
Round  21, Global train loss: 1.713, Global test loss: 1.806, Global test accuracy: 39.70
Round  22, Train loss: 1.264, Test loss: 1.228, Test accuracy: 56.04
Round  22, Global train loss: 1.264, Global test loss: 1.618, Global test accuracy: 46.30
Round  23, Train loss: 1.310, Test loss: 1.232, Test accuracy: 55.20
Round  23, Global train loss: 1.310, Global test loss: 1.708, Global test accuracy: 42.80
Round  24, Train loss: 1.062, Test loss: 1.235, Test accuracy: 54.82
Round  24, Global train loss: 1.062, Global test loss: 1.480, Global test accuracy: 51.90
Round  25, Train loss: 1.317, Test loss: 1.239, Test accuracy: 56.18
Round  25, Global train loss: 1.317, Global test loss: 1.447, Global test accuracy: 51.62
Round  26, Train loss: 1.481, Test loss: 1.242, Test accuracy: 56.74
Round  26, Global train loss: 1.481, Global test loss: 1.525, Global test accuracy: 50.86
Round  27, Train loss: 1.220, Test loss: 1.222, Test accuracy: 57.92
Round  27, Global train loss: 1.220, Global test loss: 1.557, Global test accuracy: 47.22
Round  28, Train loss: 1.475, Test loss: 1.228, Test accuracy: 57.18
Round  28, Global train loss: 1.475, Global test loss: 1.701, Global test accuracy: 41.76
Round  29, Train loss: 1.227, Test loss: 1.227, Test accuracy: 56.48
Round  29, Global train loss: 1.227, Global test loss: 1.620, Global test accuracy: 43.92
Round  30, Train loss: 1.269, Test loss: 1.214, Test accuracy: 56.26
Round  30, Global train loss: 1.269, Global test loss: 1.668, Global test accuracy: 42.92
Round  31, Train loss: 1.373, Test loss: 1.239, Test accuracy: 55.70
Round  31, Global train loss: 1.373, Global test loss: 1.611, Global test accuracy: 44.04
Round  32, Train loss: 0.868, Test loss: 1.238, Test accuracy: 55.82
Round  32, Global train loss: 0.868, Global test loss: 1.646, Global test accuracy: 44.50
Round  33, Train loss: 1.316, Test loss: 1.236, Test accuracy: 56.22
Round  33, Global train loss: 1.316, Global test loss: 1.679, Global test accuracy: 44.82
Round  34, Train loss: 1.469, Test loss: 1.269, Test accuracy: 54.62
Round  34, Global train loss: 1.469, Global test loss: 1.764, Global test accuracy: 40.06
Round  35, Train loss: 1.098, Test loss: 1.265, Test accuracy: 54.26
Round  35, Global train loss: 1.098, Global test loss: 1.775, Global test accuracy: 41.76
Round  36, Train loss: 0.925, Test loss: 1.263, Test accuracy: 54.56
Round  36, Global train loss: 0.925, Global test loss: 1.707, Global test accuracy: 43.88
Round  37, Train loss: 0.774, Test loss: 1.262, Test accuracy: 54.64
Round  37, Global train loss: 0.774, Global test loss: 1.759, Global test accuracy: 43.64
Round  38, Train loss: 1.162, Test loss: 1.255, Test accuracy: 54.60
Round  38, Global train loss: 1.162, Global test loss: 1.610, Global test accuracy: 44.18
Round  39, Train loss: 1.584, Test loss: 1.286, Test accuracy: 53.96
Round  39, Global train loss: 1.584, Global test loss: 1.845, Global test accuracy: 35.40
Round  40, Train loss: 1.194, Test loss: 1.280, Test accuracy: 54.90
Round  40, Global train loss: 1.194, Global test loss: 1.667, Global test accuracy: 43.44
Round  41, Train loss: 0.816, Test loss: 1.315, Test accuracy: 54.52
Round  41, Global train loss: 0.816, Global test loss: 1.707, Global test accuracy: 45.80
Round  42, Train loss: 0.990, Test loss: 1.304, Test accuracy: 54.90
Round  42, Global train loss: 0.990, Global test loss: 1.546, Global test accuracy: 47.62
Round  43, Train loss: 1.070, Test loss: 1.289, Test accuracy: 56.08
Round  43, Global train loss: 1.070, Global test loss: 1.569, Global test accuracy: 49.90
Round  44, Train loss: 1.053, Test loss: 1.313, Test accuracy: 54.04
Round  44, Global train loss: 1.053, Global test loss: 1.610, Global test accuracy: 48.32
Round  45, Train loss: 0.882, Test loss: 1.320, Test accuracy: 53.76
Round  45, Global train loss: 0.882, Global test loss: 1.621, Global test accuracy: 45.10
Round  46, Train loss: 1.256, Test loss: 1.332, Test accuracy: 52.68
Round  46, Global train loss: 1.256, Global test loss: 1.792, Global test accuracy: 39.42
Round  47, Train loss: 0.943, Test loss: 1.371, Test accuracy: 52.02
Round  47, Global train loss: 0.943, Global test loss: 1.749, Global test accuracy: 44.52
Round  48, Train loss: 1.078, Test loss: 1.360, Test accuracy: 53.10
Round  48, Global train loss: 1.078, Global test loss: 1.658, Global test accuracy: 43.24
Round  49, Train loss: 0.804, Test loss: 1.398, Test accuracy: 52.70
Round  49, Global train loss: 0.804, Global test loss: 1.813, Global test accuracy: 44.42
Round  50, Train loss: 0.653, Test loss: 1.404, Test accuracy: 52.84
Round  50, Global train loss: 0.653, Global test loss: 1.674, Global test accuracy: 48.44
Round  51, Train loss: 1.013, Test loss: 1.416, Test accuracy: 52.96
Round  51, Global train loss: 1.013, Global test loss: 1.658, Global test accuracy: 47.54
Round  52, Train loss: 0.956, Test loss: 1.396, Test accuracy: 54.28
Round  52, Global train loss: 0.956, Global test loss: 1.741, Global test accuracy: 45.74
Round  53, Train loss: 0.976, Test loss: 1.428, Test accuracy: 54.14
Round  53, Global train loss: 0.976, Global test loss: 1.786, Global test accuracy: 42.90
Round  54, Train loss: 1.048, Test loss: 1.433, Test accuracy: 53.22
Round  54, Global train loss: 1.048, Global test loss: 1.764, Global test accuracy: 43.04
Round  55, Train loss: 0.892, Test loss: 1.507, Test accuracy: 51.98
Round  55, Global train loss: 0.892, Global test loss: 1.755, Global test accuracy: 43.60
Round  56, Train loss: 1.023, Test loss: 1.518, Test accuracy: 52.26
Round  56, Global train loss: 1.023, Global test loss: 1.906, Global test accuracy: 41.28
Round  57, Train loss: 0.733, Test loss: 1.548, Test accuracy: 52.48
Round  57, Global train loss: 0.733, Global test loss: 1.955, Global test accuracy: 44.66
Round  58, Train loss: 0.653, Test loss: 1.582, Test accuracy: 51.94
Round  58, Global train loss: 0.653, Global test loss: 1.610, Global test accuracy: 50.22
Round  59, Train loss: 0.694, Test loss: 1.568, Test accuracy: 52.50
Round  59, Global train loss: 0.694, Global test loss: 1.777, Global test accuracy: 44.96
Round  60, Train loss: 0.705, Test loss: 1.571, Test accuracy: 52.32
Round  60, Global train loss: 0.705, Global test loss: 1.624, Global test accuracy: 52.06
Round  61, Train loss: 1.018, Test loss: 1.595, Test accuracy: 52.44
Round  61, Global train loss: 1.018, Global test loss: 1.809, Global test accuracy: 41.86
Round  62, Train loss: 0.507, Test loss: 1.596, Test accuracy: 53.00
Round  62, Global train loss: 0.507, Global test loss: 1.818, Global test accuracy: 48.12
Round  63, Train loss: 0.789, Test loss: 1.597, Test accuracy: 53.20
Round  63, Global train loss: 0.789, Global test loss: 1.929, Global test accuracy: 42.80
Round  64, Train loss: 0.889, Test loss: 1.582, Test accuracy: 53.04
Round  64, Global train loss: 0.889, Global test loss: 1.809, Global test accuracy: 45.60
Round  65, Train loss: 0.614, Test loss: 1.590, Test accuracy: 52.56
Round  65, Global train loss: 0.614, Global test loss: 1.986, Global test accuracy: 42.28
Round  66, Train loss: 0.675, Test loss: 1.639, Test accuracy: 51.88
Round  66, Global train loss: 0.675, Global test loss: 2.012, Global test accuracy: 42.66
Round  67, Train loss: 0.535, Test loss: 1.660, Test accuracy: 51.76
Round  67, Global train loss: 0.535, Global test loss: 2.121, Global test accuracy: 42.76
Round  68, Train loss: 0.851, Test loss: 1.711, Test accuracy: 51.82
Round  68, Global train loss: 0.851, Global test loss: 2.088, Global test accuracy: 39.70
Round  69, Train loss: 0.680, Test loss: 1.734, Test accuracy: 52.02
Round  69, Global train loss: 0.680, Global test loss: 2.182, Global test accuracy: 40.16
Round  70, Train loss: 0.493, Test loss: 1.774, Test accuracy: 51.04
Round  70, Global train loss: 0.493, Global test loss: 2.013, Global test accuracy: 44.14
Round  71, Train loss: 0.449, Test loss: 1.787, Test accuracy: 51.08
Round  71, Global train loss: 0.449, Global test loss: 2.122, Global test accuracy: 45.56
Round  72, Train loss: 0.610, Test loss: 1.776, Test accuracy: 52.56
Round  72, Global train loss: 0.610, Global test loss: 2.044, Global test accuracy: 44.72
Round  73, Train loss: 0.606, Test loss: 1.767, Test accuracy: 52.00
Round  73, Global train loss: 0.606, Global test loss: 2.155, Global test accuracy: 39.64
Round  74, Train loss: 0.626, Test loss: 1.828, Test accuracy: 51.92
Round  74, Global train loss: 0.626, Global test loss: 2.049, Global test accuracy: 42.42
Round  75, Train loss: 0.763, Test loss: 1.816, Test accuracy: 51.50
Round  75, Global train loss: 0.763, Global test loss: 2.213, Global test accuracy: 38.38
Round  76, Train loss: 0.577, Test loss: 1.863, Test accuracy: 51.18
Round  76, Global train loss: 0.577, Global test loss: 2.495, Global test accuracy: 37.54
Round  77, Train loss: 0.456, Test loss: 1.859, Test accuracy: 51.66
Round  77, Global train loss: 0.456, Global test loss: 2.328, Global test accuracy: 43.32
Round  78, Train loss: 0.659, Test loss: 1.893, Test accuracy: 51.32
Round  78, Global train loss: 0.659, Global test loss: 2.292, Global test accuracy: 41.60
Round  79, Train loss: 0.527, Test loss: 1.893, Test accuracy: 50.32
Round  79, Global train loss: 0.527, Global test loss: 2.370, Global test accuracy: 38.38
Round  80, Train loss: 0.639, Test loss: 1.967, Test accuracy: 50.14
Round  80, Global train loss: 0.639, Global test loss: 2.330, Global test accuracy: 36.04
Round  81, Train loss: 0.622, Test loss: 2.011, Test accuracy: 50.24
Round  81, Global train loss: 0.622, Global test loss: 2.496, Global test accuracy: 34.56
Round  82, Train loss: 0.447, Test loss: 1.990, Test accuracy: 50.86
Round  82, Global train loss: 0.447, Global test loss: 2.271, Global test accuracy: 44.28
Round  83, Train loss: 0.654, Test loss: 2.032, Test accuracy: 50.54
Round  83, Global train loss: 0.654, Global test loss: 2.314, Global test accuracy: 40.38
Round  84, Train loss: 0.387, Test loss: 2.039, Test accuracy: 50.88
Round  84, Global train loss: 0.387, Global test loss: 2.103, Global test accuracy: 45.88
Round  85, Train loss: 0.393, Test loss: 2.092, Test accuracy: 50.58
Round  85, Global train loss: 0.393, Global test loss: 2.321, Global test accuracy: 44.68
Round  86, Train loss: 0.426, Test loss: 2.156, Test accuracy: 50.46
Round  86, Global train loss: 0.426, Global test loss: 2.428, Global test accuracy: 40.90
Round  87, Train loss: 0.359, Test loss: 2.169, Test accuracy: 50.54
Round  87, Global train loss: 0.359, Global test loss: 2.125, Global test accuracy: 44.16
Round  88, Train loss: 0.370, Test loss: 2.123, Test accuracy: 50.06
Round  88, Global train loss: 0.370, Global test loss: 2.423, Global test accuracy: 43.28
Round  89, Train loss: 0.335, Test loss: 2.150, Test accuracy: 49.92
Round  89, Global train loss: 0.335, Global test loss: 2.365, Global test accuracy: 46.98
Round  90, Train loss: 0.464, Test loss: 2.164, Test accuracy: 49.84
Round  90, Global train loss: 0.464, Global test loss: 2.279, Global test accuracy: 40.12
Round  91, Train loss: 0.499, Test loss: 2.191, Test accuracy: 50.00
Round  91, Global train loss: 0.499, Global test loss: 2.380, Global test accuracy: 38.78
Round  92, Train loss: 0.411, Test loss: 2.256, Test accuracy: 49.56
Round  92, Global train loss: 0.411, Global test loss: 2.470, Global test accuracy: 42.16
Round  93, Train loss: 0.314, Test loss: 2.284, Test accuracy: 50.00
Round  93, Global train loss: 0.314, Global test loss: 2.307, Global test accuracy: 46.80
Round  94, Train loss: 0.460, Test loss: 2.183, Test accuracy: 51.48
Round  94, Global train loss: 0.460, Global test loss: 2.409, Global test accuracy: 39.54
Round  95, Train loss: 0.485, Test loss: 2.200, Test accuracy: 51.14
Round  95, Global train loss: 0.485, Global test loss: 2.328, Global test accuracy: 44.28
Round  96, Train loss: 0.232, Test loss: 2.253, Test accuracy: 50.66
Round  96, Global train loss: 0.232, Global test loss: 2.442, Global test accuracy: 46.54
Round  97, Train loss: 0.452, Test loss: 2.349, Test accuracy: 50.16
Round  97, Global train loss: 0.452, Global test loss: 2.522, Global test accuracy: 42.06
Round  98, Train loss: 0.418, Test loss: 2.345, Test accuracy: 50.12
Round  98, Global train loss: 0.418, Global test loss: 2.495, Global test accuracy: 45.46
Round  99, Train loss: 0.348, Test loss: 2.298, Test accuracy: 50.72
Round  99, Global train loss: 0.348, Global test loss: 2.457, Global test accuracy: 43.16
Final Round, Train loss: 0.312, Test loss: 2.489, Test accuracy: 50.86
Final Round, Global train loss: 0.312, Global test loss: 2.457, Global test accuracy: 43.16
Average accuracy final 10 rounds: 50.368
Average global accuracy final 10 rounds: 42.89
1217.1741812229156
[3.1787140369415283, 6.0342161655426025, 9.05378532409668, 11.993479490280151, 15.07490587234497, 18.195029497146606, 21.29987597465515, 24.160387754440308, 26.96650528907776, 29.825995922088623, 32.80144286155701, 35.79563927650452, 38.64096713066101, 41.53129434585571, 44.430949687957764, 47.35632085800171, 50.318843126297, 53.362757205963135, 56.30620241165161, 59.31021046638489, 62.217193603515625, 65.17076897621155, 68.03075051307678, 70.91220831871033, 73.73986196517944, 76.78230333328247, 79.64365577697754, 82.47754621505737, 85.36423087120056, 88.37753033638, 91.54764246940613, 94.4656503200531, 97.35247993469238, 100.44370150566101, 103.40221834182739, 106.32579684257507, 109.3680431842804, 112.28568053245544, 115.19567441940308, 118.07523322105408, 121.0706090927124, 123.94862794876099, 127.00900912284851, 129.9403383731842, 132.77862524986267, 135.67310976982117, 138.62875247001648, 141.61734628677368, 144.56891083717346, 147.6697702407837, 150.7620074748993, 153.7147285938263, 156.87836170196533, 159.80228972434998, 162.737468957901, 165.74862122535706, 168.8486692905426, 171.78476881980896, 174.71085810661316, 177.62661790847778, 180.60508823394775, 183.63265442848206, 186.53572463989258, 189.6097812652588, 192.73808813095093, 195.76994585990906, 198.69110751152039, 201.77686667442322, 204.9076542854309, 208.04243874549866, 211.04816222190857, 214.0259726047516, 216.90453624725342, 219.81315183639526, 222.74682569503784, 225.7110514640808, 228.80079579353333, 231.8578805923462, 234.9363033771515, 237.96742177009583, 240.8842167854309, 243.80599403381348, 246.77163076400757, 249.70837783813477, 252.64937281608582, 255.5535204410553, 258.60942220687866, 261.5811960697174, 264.5073685646057, 267.6990180015564, 270.76236152648926, 273.8349118232727, 276.71452140808105, 279.56819915771484, 282.6268663406372, 285.50299096107483, 288.36273431777954, 291.4396929740906, 294.4444136619568, 297.40390968322754, 302.54608845710754]
[18.66, 22.3, 29.96, 35.68, 36.6, 38.56, 38.52, 41.76, 46.02, 44.6, 48.64, 49.38, 50.76, 52.02, 52.3, 51.54, 52.46, 53.36, 54.08, 53.4, 53.48, 55.72, 56.04, 55.2, 54.82, 56.18, 56.74, 57.92, 57.18, 56.48, 56.26, 55.7, 55.82, 56.22, 54.62, 54.26, 54.56, 54.64, 54.6, 53.96, 54.9, 54.52, 54.9, 56.08, 54.04, 53.76, 52.68, 52.02, 53.1, 52.7, 52.84, 52.96, 54.28, 54.14, 53.22, 51.98, 52.26, 52.48, 51.94, 52.5, 52.32, 52.44, 53.0, 53.2, 53.04, 52.56, 51.88, 51.76, 51.82, 52.02, 51.04, 51.08, 52.56, 52.0, 51.92, 51.5, 51.18, 51.66, 51.32, 50.32, 50.14, 50.24, 50.86, 50.54, 50.88, 50.58, 50.46, 50.54, 50.06, 49.92, 49.84, 50.0, 49.56, 50.0, 51.48, 51.14, 50.66, 50.16, 50.12, 50.72, 50.86]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.021, Test loss: 2.213, Test accuracy: 20.40
Round   0, Global train loss: 2.021, Global test loss: 2.279, Global test accuracy: 19.56
Round   1, Train loss: 1.855, Test loss: 2.180, Test accuracy: 20.62
Round   1, Global train loss: 1.855, Global test loss: 2.322, Global test accuracy: 17.80
Round   2, Train loss: 1.881, Test loss: 1.871, Test accuracy: 33.36
Round   2, Global train loss: 1.881, Global test loss: 2.316, Global test accuracy: 19.30
Round   3, Train loss: 1.691, Test loss: 1.763, Test accuracy: 36.58
Round   3, Global train loss: 1.691, Global test loss: 2.212, Global test accuracy: 22.40
Round   4, Train loss: 1.629, Test loss: 1.655, Test accuracy: 39.56
Round   4, Global train loss: 1.629, Global test loss: 2.048, Global test accuracy: 27.96
Round   5, Train loss: 1.844, Test loss: 1.706, Test accuracy: 41.84
Round   5, Global train loss: 1.844, Global test loss: 2.278, Global test accuracy: 18.38
Round   6, Train loss: 1.712, Test loss: 1.702, Test accuracy: 39.46
Round   6, Global train loss: 1.712, Global test loss: 2.243, Global test accuracy: 24.44
Round   7, Train loss: 1.692, Test loss: 1.536, Test accuracy: 46.64
Round   7, Global train loss: 1.692, Global test loss: 2.290, Global test accuracy: 22.76
Round   8, Train loss: 1.460, Test loss: 1.393, Test accuracy: 50.38
Round   8, Global train loss: 1.460, Global test loss: 1.879, Global test accuracy: 32.42
Round   9, Train loss: 1.573, Test loss: 1.440, Test accuracy: 50.88
Round   9, Global train loss: 1.573, Global test loss: 2.148, Global test accuracy: 30.66
Round  10, Train loss: 1.650, Test loss: 1.416, Test accuracy: 51.04
Round  10, Global train loss: 1.650, Global test loss: 2.091, Global test accuracy: 36.00
Round  11, Train loss: 1.712, Test loss: 1.445, Test accuracy: 50.36
Round  11, Global train loss: 1.712, Global test loss: 2.068, Global test accuracy: 16.82
Round  12, Train loss: 1.540, Test loss: 1.378, Test accuracy: 51.66
Round  12, Global train loss: 1.540, Global test loss: 2.251, Global test accuracy: 24.34
Round  13, Train loss: 1.463, Test loss: 1.378, Test accuracy: 55.80
Round  13, Global train loss: 1.463, Global test loss: 1.885, Global test accuracy: 39.10
Round  14, Train loss: 1.583, Test loss: 1.348, Test accuracy: 56.00
Round  14, Global train loss: 1.583, Global test loss: 1.978, Global test accuracy: 35.24
Round  15, Train loss: 1.425, Test loss: 1.331, Test accuracy: 55.90
Round  15, Global train loss: 1.425, Global test loss: 1.835, Global test accuracy: 41.06
Round  16, Train loss: 1.801, Test loss: 1.343, Test accuracy: 54.52
Round  16, Global train loss: 1.801, Global test loss: 2.365, Global test accuracy: 26.60
Round  17, Train loss: 1.610, Test loss: 1.361, Test accuracy: 55.00
Round  17, Global train loss: 1.610, Global test loss: 2.039, Global test accuracy: 19.54
Round  18, Train loss: 1.193, Test loss: 1.288, Test accuracy: 56.72
Round  18, Global train loss: 1.193, Global test loss: 1.920, Global test accuracy: 39.10
Round  19, Train loss: 1.295, Test loss: 1.250, Test accuracy: 58.20
Round  19, Global train loss: 1.295, Global test loss: 1.882, Global test accuracy: 42.46
Round  20, Train loss: 1.454, Test loss: 1.259, Test accuracy: 58.94
Round  20, Global train loss: 1.454, Global test loss: 1.999, Global test accuracy: 29.68
Round  21, Train loss: 1.391, Test loss: 1.219, Test accuracy: 58.36
Round  21, Global train loss: 1.391, Global test loss: 2.196, Global test accuracy: 22.04
Round  22, Train loss: 1.348, Test loss: 1.218, Test accuracy: 59.60
Round  22, Global train loss: 1.348, Global test loss: 1.961, Global test accuracy: 35.72
Round  23, Train loss: 1.783, Test loss: 1.239, Test accuracy: 60.60
Round  23, Global train loss: 1.783, Global test loss: 2.314, Global test accuracy: 29.32
Round  24, Train loss: 1.283, Test loss: 1.202, Test accuracy: 60.36
Round  24, Global train loss: 1.283, Global test loss: 1.858, Global test accuracy: 34.00
Round  25, Train loss: 1.339, Test loss: 1.206, Test accuracy: 60.46
Round  25, Global train loss: 1.339, Global test loss: 1.747, Global test accuracy: 43.30
Round  26, Train loss: 1.330, Test loss: 1.193, Test accuracy: 61.80
Round  26, Global train loss: 1.330, Global test loss: 1.740, Global test accuracy: 45.20
Round  27, Train loss: 1.203, Test loss: 1.168, Test accuracy: 62.34
Round  27, Global train loss: 1.203, Global test loss: 1.833, Global test accuracy: 40.50
Round  28, Train loss: 1.529, Test loss: 1.183, Test accuracy: 62.68
Round  28, Global train loss: 1.529, Global test loss: 2.007, Global test accuracy: 27.50
Round  29, Train loss: 1.377, Test loss: 1.157, Test accuracy: 63.34
Round  29, Global train loss: 1.377, Global test loss: 1.950, Global test accuracy: 30.72
Round  30, Train loss: 1.263, Test loss: 1.157, Test accuracy: 61.86
Round  30, Global train loss: 1.263, Global test loss: 1.856, Global test accuracy: 34.62
Round  31, Train loss: 1.338, Test loss: 1.172, Test accuracy: 62.54
Round  31, Global train loss: 1.338, Global test loss: 1.793, Global test accuracy: 35.30
Round  32, Train loss: 1.417, Test loss: 1.149, Test accuracy: 62.18
Round  32, Global train loss: 1.417, Global test loss: 2.084, Global test accuracy: 29.08
Round  33, Train loss: 1.281, Test loss: 1.137, Test accuracy: 64.08
Round  33, Global train loss: 1.281, Global test loss: 1.928, Global test accuracy: 35.50
Round  34, Train loss: 1.055, Test loss: 1.103, Test accuracy: 63.30
Round  34, Global train loss: 1.055, Global test loss: 2.008, Global test accuracy: 32.60
Round  35, Train loss: 0.864, Test loss: 1.122, Test accuracy: 62.74
Round  35, Global train loss: 0.864, Global test loss: 1.805, Global test accuracy: 43.08
Round  36, Train loss: 1.164, Test loss: 1.104, Test accuracy: 62.96
Round  36, Global train loss: 1.164, Global test loss: 1.798, Global test accuracy: 38.42
Round  37, Train loss: 1.366, Test loss: 1.137, Test accuracy: 61.96
Round  37, Global train loss: 1.366, Global test loss: 2.074, Global test accuracy: 29.20
Round  38, Train loss: 0.865, Test loss: 1.118, Test accuracy: 63.20
Round  38, Global train loss: 0.865, Global test loss: 1.865, Global test accuracy: 37.10
Round  39, Train loss: 1.231, Test loss: 1.113, Test accuracy: 62.60
Round  39, Global train loss: 1.231, Global test loss: 2.118, Global test accuracy: 29.30
Round  40, Train loss: 0.928, Test loss: 1.096, Test accuracy: 65.32
Round  40, Global train loss: 0.928, Global test loss: 1.576, Global test accuracy: 49.54
Round  41, Train loss: 1.434, Test loss: 1.096, Test accuracy: 62.42
Round  41, Global train loss: 1.434, Global test loss: 2.189, Global test accuracy: 26.90
Round  42, Train loss: 0.716, Test loss: 1.074, Test accuracy: 64.70
Round  42, Global train loss: 0.716, Global test loss: 1.482, Global test accuracy: 45.12
Round  43, Train loss: 1.364, Test loss: 1.074, Test accuracy: 64.10
Round  43, Global train loss: 1.364, Global test loss: 2.175, Global test accuracy: 32.70
Round  44, Train loss: 1.680, Test loss: 1.089, Test accuracy: 63.28
Round  44, Global train loss: 1.680, Global test loss: 2.221, Global test accuracy: 26.36
Round  45, Train loss: 1.160, Test loss: 1.067, Test accuracy: 64.68
Round  45, Global train loss: 1.160, Global test loss: 1.749, Global test accuracy: 43.22
Round  46, Train loss: 0.819, Test loss: 1.075, Test accuracy: 63.66
Round  46, Global train loss: 0.819, Global test loss: 2.097, Global test accuracy: 31.52
Round  47, Train loss: 1.037, Test loss: 1.065, Test accuracy: 64.98
Round  47, Global train loss: 1.037, Global test loss: 2.167, Global test accuracy: 38.94
Round  48, Train loss: 0.906, Test loss: 1.049, Test accuracy: 65.74
Round  48, Global train loss: 0.906, Global test loss: 1.419, Global test accuracy: 51.14
Round  49, Train loss: 0.820, Test loss: 1.058, Test accuracy: 66.16
Round  49, Global train loss: 0.820, Global test loss: 1.764, Global test accuracy: 38.34
Round  50, Train loss: 1.004, Test loss: 1.062, Test accuracy: 64.40
Round  50, Global train loss: 1.004, Global test loss: 1.642, Global test accuracy: 41.60
Round  51, Train loss: 1.381, Test loss: 1.066, Test accuracy: 64.52
Round  51, Global train loss: 1.381, Global test loss: 2.068, Global test accuracy: 36.54
Round  52, Train loss: 1.666, Test loss: 1.073, Test accuracy: 63.74
Round  52, Global train loss: 1.666, Global test loss: 2.296, Global test accuracy: 37.60
Round  53, Train loss: 1.403, Test loss: 1.066, Test accuracy: 63.50
Round  53, Global train loss: 1.403, Global test loss: 2.311, Global test accuracy: 27.06
Round  54, Train loss: 0.990, Test loss: 1.059, Test accuracy: 64.42
Round  54, Global train loss: 0.990, Global test loss: 1.892, Global test accuracy: 43.86
Round  55, Train loss: 1.308, Test loss: 1.075, Test accuracy: 63.66
Round  55, Global train loss: 1.308, Global test loss: 1.789, Global test accuracy: 37.64
Round  56, Train loss: 1.009, Test loss: 1.067, Test accuracy: 63.72
Round  56, Global train loss: 1.009, Global test loss: 1.984, Global test accuracy: 39.12
Round  57, Train loss: 1.578, Test loss: 1.087, Test accuracy: 62.34
Round  57, Global train loss: 1.578, Global test loss: 2.523, Global test accuracy: 24.88
Round  58, Train loss: 1.019, Test loss: 1.074, Test accuracy: 62.88
Round  58, Global train loss: 1.019, Global test loss: 1.946, Global test accuracy: 38.56
Round  59, Train loss: 0.772, Test loss: 1.073, Test accuracy: 63.88
Round  59, Global train loss: 0.772, Global test loss: 1.517, Global test accuracy: 40.96
Round  60, Train loss: 1.226, Test loss: 1.060, Test accuracy: 62.98
Round  60, Global train loss: 1.226, Global test loss: 1.758, Global test accuracy: 44.46
Round  61, Train loss: 0.999, Test loss: 1.073, Test accuracy: 63.78
Round  61, Global train loss: 0.999, Global test loss: 1.662, Global test accuracy: 46.40
Round  62, Train loss: 1.271, Test loss: 1.086, Test accuracy: 62.36
Round  62, Global train loss: 1.271, Global test loss: 2.170, Global test accuracy: 27.88
Round  63, Train loss: 0.761, Test loss: 1.067, Test accuracy: 63.78
Round  63, Global train loss: 0.761, Global test loss: 1.580, Global test accuracy: 48.96
Round  64, Train loss: 1.191, Test loss: 1.056, Test accuracy: 64.20
Round  64, Global train loss: 1.191, Global test loss: 2.565, Global test accuracy: 32.72
Round  65, Train loss: 1.050, Test loss: 1.088, Test accuracy: 62.64
Round  65, Global train loss: 1.050, Global test loss: 2.042, Global test accuracy: 31.84
Round  66, Train loss: 1.206, Test loss: 1.101, Test accuracy: 61.42
Round  66, Global train loss: 1.206, Global test loss: 1.899, Global test accuracy: 37.74
Round  67, Train loss: 0.657, Test loss: 1.078, Test accuracy: 63.10
Round  67, Global train loss: 0.657, Global test loss: 1.675, Global test accuracy: 49.68
Round  68, Train loss: 0.663, Test loss: 1.105, Test accuracy: 61.74
Round  68, Global train loss: 0.663, Global test loss: 2.039, Global test accuracy: 32.60
Round  69, Train loss: 0.945, Test loss: 1.085, Test accuracy: 62.66
Round  69, Global train loss: 0.945, Global test loss: 1.880, Global test accuracy: 42.68
Round  70, Train loss: 1.240, Test loss: 1.089, Test accuracy: 62.08
Round  70, Global train loss: 1.240, Global test loss: 1.895, Global test accuracy: 35.92
Round  71, Train loss: 1.240, Test loss: 1.097, Test accuracy: 61.50
Round  71, Global train loss: 1.240, Global test loss: 2.416, Global test accuracy: 25.76
Round  72, Train loss: 1.186, Test loss: 1.131, Test accuracy: 59.38
Round  72, Global train loss: 1.186, Global test loss: 2.367, Global test accuracy: 26.98
Round  73, Train loss: 0.958, Test loss: 1.100, Test accuracy: 61.74
Round  73, Global train loss: 0.958, Global test loss: 1.791, Global test accuracy: 34.22
Round  74, Train loss: 1.132, Test loss: 1.113, Test accuracy: 61.08
Round  74, Global train loss: 1.132, Global test loss: 2.000, Global test accuracy: 32.36
Round  75, Train loss: 0.592, Test loss: 1.060, Test accuracy: 64.48
Round  75, Global train loss: 0.592, Global test loss: 2.114, Global test accuracy: 33.28
Round  76, Train loss: 1.124, Test loss: 1.095, Test accuracy: 61.14
Round  76, Global train loss: 1.124, Global test loss: 2.026, Global test accuracy: 30.78
Round  77, Train loss: 1.334, Test loss: 1.127, Test accuracy: 60.22
Round  77, Global train loss: 1.334, Global test loss: 2.578, Global test accuracy: 23.84
Round  78, Train loss: 1.026, Test loss: 1.118, Test accuracy: 61.48
Round  78, Global train loss: 1.026, Global test loss: 2.665, Global test accuracy: 30.52
Round  79, Train loss: 1.112, Test loss: 1.153, Test accuracy: 59.18
Round  79, Global train loss: 1.112, Global test loss: 2.202, Global test accuracy: 30.28
Round  80, Train loss: 0.612, Test loss: 1.071, Test accuracy: 63.10
Round  80, Global train loss: 0.612, Global test loss: 1.851, Global test accuracy: 38.08
Round  81, Train loss: 0.880, Test loss: 1.089, Test accuracy: 62.22
Round  81, Global train loss: 0.880, Global test loss: 2.202, Global test accuracy: 31.04
Round  82, Train loss: 1.079, Test loss: 1.118, Test accuracy: 60.72
Round  82, Global train loss: 1.079, Global test loss: 2.255, Global test accuracy: 27.00
Round  83, Train loss: 0.546, Test loss: 1.089, Test accuracy: 62.64
Round  83, Global train loss: 0.546, Global test loss: 2.405, Global test accuracy: 30.76
Round  84, Train loss: 1.127, Test loss: 1.087, Test accuracy: 62.84
Round  84, Global train loss: 1.127, Global test loss: 2.027, Global test accuracy: 40.10
Round  85, Train loss: 1.061, Test loss: 1.108, Test accuracy: 61.92
Round  85, Global train loss: 1.061, Global test loss: 1.938, Global test accuracy: 35.30
Round  86, Train loss: 0.769, Test loss: 1.131, Test accuracy: 60.46
Round  86, Global train loss: 0.769, Global test loss: 1.962, Global test accuracy: 38.68
Round  87, Train loss: 0.507, Test loss: 1.106, Test accuracy: 61.98
Round  87, Global train loss: 0.507, Global test loss: 1.753, Global test accuracy: 42.42
Round  88, Train loss: 0.418, Test loss: 1.111, Test accuracy: 62.50
Round  88, Global train loss: 0.418, Global test loss: 1.959, Global test accuracy: 46.40
Round  89, Train loss: 0.990, Test loss: 1.128, Test accuracy: 60.44
Round  89, Global train loss: 0.990, Global test loss: 2.299, Global test accuracy: 26.54
Round  90, Train loss: 0.564, Test loss: 1.082, Test accuracy: 62.60
Round  90, Global train loss: 0.564, Global test loss: 1.366, Global test accuracy: 55.70
Round  91, Train loss: 0.811, Test loss: 1.125, Test accuracy: 60.72
Round  91, Global train loss: 0.811, Global test loss: 1.910, Global test accuracy: 36.64
Round  92, Train loss: 0.734, Test loss: 1.145, Test accuracy: 60.08
Round  92, Global train loss: 0.734, Global test loss: 1.938, Global test accuracy: 42.92
Round  93, Train loss: 0.651, Test loss: 1.157, Test accuracy: 60.34
Round  93, Global train loss: 0.651, Global test loss: 1.680, Global test accuracy: 46.08
Round  94, Train loss: 0.685, Test loss: 1.192, Test accuracy: 57.98
Round  94, Global train loss: 0.685, Global test loss: 1.774, Global test accuracy: 44.00
Round  95, Train loss: 0.976, Test loss: 1.148, Test accuracy: 59.70
Round  95, Global train loss: 0.976, Global test loss: 2.660, Global test accuracy: 28.36
Round  96, Train loss: 0.873, Test loss: 1.162, Test accuracy: 60.02
Round  96, Global train loss: 0.873, Global test loss: 2.205, Global test accuracy: 31.76
Round  97, Train loss: 0.672, Test loss: 1.146, Test accuracy: 60.06
Round  97, Global train loss: 0.672, Global test loss: 1.764, Global test accuracy: 43.32
Round  98, Train loss: 0.872, Test loss: 1.151, Test accuracy: 60.18
Round  98, Global train loss: 0.872, Global test loss: 2.796, Global test accuracy: 27.38
Round  99, Train loss: 0.948, Test loss: 1.137, Test accuracy: 61.22
Round  99, Global train loss: 0.948, Global test loss: 1.974, Global test accuracy: 31.32
Final Round, Train loss: 0.687, Test loss: 1.179, Test accuracy: 60.18
Final Round, Global train loss: 0.687, Global test loss: 1.974, Global test accuracy: 31.32
Average accuracy final 10 rounds: 60.290000000000006
721.5685629844666
[1.758150339126587, 3.2102622985839844, 4.660876750946045, 6.085864782333374, 7.5192484855651855, 8.961195707321167, 10.433460474014282, 11.845513343811035, 13.3003408908844, 14.701200008392334, 16.207449197769165, 17.610560178756714, 19.028353691101074, 20.44767451286316, 21.83814287185669, 23.195934772491455, 24.630002737045288, 26.08018136024475, 27.489578008651733, 28.879088878631592, 30.2483549118042, 31.606987476348877, 32.94826889038086, 34.31976938247681, 35.670531272888184, 37.042396783828735, 38.40505790710449, 39.78021478652954, 41.14955139160156, 42.53403639793396, 43.98357057571411, 45.480096101760864, 46.84119248390198, 48.17379355430603, 49.56200408935547, 50.97642469406128, 52.34346675872803, 53.72166633605957, 55.205084562301636, 56.6416220664978, 57.977866888046265, 59.337037801742554, 60.71459889411926, 62.06563425064087, 63.47994947433472, 64.89024639129639, 66.32598614692688, 67.72025203704834, 69.13341236114502, 70.599862575531, 72.04842758178711, 73.49291443824768, 74.89704060554504, 76.27666902542114, 77.63507318496704, 79.0907244682312, 80.5478892326355, 81.9388816356659, 83.31781816482544, 84.72690534591675, 86.21552228927612, 87.5786464214325, 88.97565960884094, 90.36792635917664, 91.77844595909119, 93.31385660171509, 94.71278190612793, 96.08751440048218, 97.46121835708618, 98.82025694847107, 100.18156743049622, 101.58173727989197, 102.96316003799438, 104.29400658607483, 105.68020606040955, 107.03997087478638, 108.38810968399048, 109.7450819015503, 111.09966802597046, 112.44297885894775, 113.77981424331665, 115.14518189430237, 116.50879836082458, 117.86534547805786, 119.19685292243958, 120.53214073181152, 121.91540575027466, 123.30078148841858, 124.6938886642456, 126.16093277931213, 127.53969645500183, 128.89455246925354, 130.2347800731659, 131.58172392845154, 132.9611041545868, 134.33882069587708, 135.78930473327637, 137.15856266021729, 138.62936782836914, 140.04745507240295, 142.28888583183289]
[20.4, 20.62, 33.36, 36.58, 39.56, 41.84, 39.46, 46.64, 50.38, 50.88, 51.04, 50.36, 51.66, 55.8, 56.0, 55.9, 54.52, 55.0, 56.72, 58.2, 58.94, 58.36, 59.6, 60.6, 60.36, 60.46, 61.8, 62.34, 62.68, 63.34, 61.86, 62.54, 62.18, 64.08, 63.3, 62.74, 62.96, 61.96, 63.2, 62.6, 65.32, 62.42, 64.7, 64.1, 63.28, 64.68, 63.66, 64.98, 65.74, 66.16, 64.4, 64.52, 63.74, 63.5, 64.42, 63.66, 63.72, 62.34, 62.88, 63.88, 62.98, 63.78, 62.36, 63.78, 64.2, 62.64, 61.42, 63.1, 61.74, 62.66, 62.08, 61.5, 59.38, 61.74, 61.08, 64.48, 61.14, 60.22, 61.48, 59.18, 63.1, 62.22, 60.72, 62.64, 62.84, 61.92, 60.46, 61.98, 62.5, 60.44, 62.6, 60.72, 60.08, 60.34, 57.98, 59.7, 60.02, 60.06, 60.18, 61.22, 60.18]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.070, Test loss: 1.999, Test accuracy: 29.16
Round   0, Global train loss: 2.070, Global test loss: 2.257, Global test accuracy: 23.18
Round   1, Train loss: 1.853, Test loss: 1.743, Test accuracy: 34.96
Round   1, Global train loss: 1.853, Global test loss: 2.190, Global test accuracy: 23.74
Round   2, Train loss: 1.775, Test loss: 1.641, Test accuracy: 37.00
Round   2, Global train loss: 1.775, Global test loss: 2.137, Global test accuracy: 28.68
Round   3, Train loss: 1.735, Test loss: 1.593, Test accuracy: 40.76
Round   3, Global train loss: 1.735, Global test loss: 2.096, Global test accuracy: 33.36
Round   4, Train loss: 1.699, Test loss: 1.542, Test accuracy: 41.94
Round   4, Global train loss: 1.699, Global test loss: 2.068, Global test accuracy: 35.08
Round   5, Train loss: 1.674, Test loss: 1.507, Test accuracy: 45.12
Round   5, Global train loss: 1.674, Global test loss: 2.038, Global test accuracy: 37.08
Round   6, Train loss: 1.652, Test loss: 1.485, Test accuracy: 44.98
Round   6, Global train loss: 1.652, Global test loss: 2.025, Global test accuracy: 35.46
Round   7, Train loss: 1.635, Test loss: 1.466, Test accuracy: 48.02
Round   7, Global train loss: 1.635, Global test loss: 2.012, Global test accuracy: 37.36
Round   8, Train loss: 1.616, Test loss: 1.433, Test accuracy: 47.60
Round   8, Global train loss: 1.616, Global test loss: 1.980, Global test accuracy: 39.50
Round   9, Train loss: 1.591, Test loss: 1.415, Test accuracy: 49.38
Round   9, Global train loss: 1.591, Global test loss: 1.963, Global test accuracy: 41.24
Round  10, Train loss: 1.607, Test loss: 1.393, Test accuracy: 51.64
Round  10, Global train loss: 1.607, Global test loss: 1.948, Global test accuracy: 32.66
Round  11, Train loss: 1.493, Test loss: 1.413, Test accuracy: 46.54
Round  11, Global train loss: 1.493, Global test loss: 2.550, Global test accuracy: 10.00
Round  12, Train loss: 1.528, Test loss: 1.407, Test accuracy: 49.58
Round  12, Global train loss: 1.528, Global test loss: 2.345, Global test accuracy: 25.20
Round  13, Train loss: 1.531, Test loss: 1.374, Test accuracy: 52.50
Round  13, Global train loss: 1.531, Global test loss: 2.173, Global test accuracy: 29.14
Round  14, Train loss: 1.559, Test loss: 1.314, Test accuracy: 53.62
Round  14, Global train loss: 1.559, Global test loss: 2.083, Global test accuracy: 32.54
Round  15, Train loss: 1.412, Test loss: 1.321, Test accuracy: 52.32
Round  15, Global train loss: 1.412, Global test loss: 2.507, Global test accuracy: 12.30
Round  16, Train loss: 1.533, Test loss: 1.329, Test accuracy: 53.46
Round  16, Global train loss: 1.533, Global test loss: 2.255, Global test accuracy: 18.30
Round  17, Train loss: 1.461, Test loss: 1.360, Test accuracy: 51.24
Round  17, Global train loss: 1.461, Global test loss: 2.604, Global test accuracy: 10.00
Round  18, Train loss: 1.443, Test loss: 1.333, Test accuracy: 52.06
Round  18, Global train loss: 1.443, Global test loss: 2.157, Global test accuracy: 29.52
Round  19, Train loss: 1.297, Test loss: 1.247, Test accuracy: 58.82
Round  19, Global train loss: 1.297, Global test loss: 1.845, Global test accuracy: 39.36
Round  20, Train loss: 1.567, Test loss: 1.296, Test accuracy: 57.82
Round  20, Global train loss: 1.567, Global test loss: 2.377, Global test accuracy: 19.96
Round  21, Train loss: 1.139, Test loss: 1.225, Test accuracy: 60.84
Round  21, Global train loss: 1.139, Global test loss: 2.185, Global test accuracy: 29.92
Round  22, Train loss: 1.475, Test loss: 1.242, Test accuracy: 58.68
Round  22, Global train loss: 1.475, Global test loss: 1.788, Global test accuracy: 43.34
Round  23, Train loss: 1.434, Test loss: 1.226, Test accuracy: 60.78
Round  23, Global train loss: 1.434, Global test loss: 2.183, Global test accuracy: 33.20
Round  24, Train loss: 1.222, Test loss: 1.185, Test accuracy: 62.60
Round  24, Global train loss: 1.222, Global test loss: 2.082, Global test accuracy: 29.58
Round  25, Train loss: 1.279, Test loss: 1.208, Test accuracy: 59.52
Round  25, Global train loss: 1.279, Global test loss: 2.101, Global test accuracy: 31.52
Round  26, Train loss: 1.477, Test loss: 1.211, Test accuracy: 59.46
Round  26, Global train loss: 1.477, Global test loss: 1.950, Global test accuracy: 31.10
Round  27, Train loss: 1.180, Test loss: 1.181, Test accuracy: 62.62
Round  27, Global train loss: 1.180, Global test loss: 1.711, Global test accuracy: 45.68
Round  28, Train loss: 1.395, Test loss: 1.184, Test accuracy: 60.08
Round  28, Global train loss: 1.395, Global test loss: 2.043, Global test accuracy: 37.08
Round  29, Train loss: 1.155, Test loss: 1.164, Test accuracy: 60.92
Round  29, Global train loss: 1.155, Global test loss: 1.759, Global test accuracy: 35.20
Round  30, Train loss: 1.466, Test loss: 1.212, Test accuracy: 57.08
Round  30, Global train loss: 1.466, Global test loss: 2.962, Global test accuracy: 13.90
Round  31, Train loss: 1.450, Test loss: 1.191, Test accuracy: 59.40
Round  31, Global train loss: 1.450, Global test loss: 1.985, Global test accuracy: 32.36
Round  32, Train loss: 1.491, Test loss: 1.219, Test accuracy: 57.54
Round  32, Global train loss: 1.491, Global test loss: 2.169, Global test accuracy: 21.82
Round  33, Train loss: 1.463, Test loss: 1.233, Test accuracy: 56.80
Round  33, Global train loss: 1.463, Global test loss: 2.351, Global test accuracy: 22.50
Round  34, Train loss: 1.061, Test loss: 1.147, Test accuracy: 62.32
Round  34, Global train loss: 1.061, Global test loss: 2.034, Global test accuracy: 35.72
Round  35, Train loss: 1.327, Test loss: 1.193, Test accuracy: 59.92
Round  35, Global train loss: 1.327, Global test loss: 2.723, Global test accuracy: 19.46
Round  36, Train loss: 1.229, Test loss: 1.163, Test accuracy: 60.70
Round  36, Global train loss: 1.229, Global test loss: 2.002, Global test accuracy: 30.84
Round  37, Train loss: 1.445, Test loss: 1.186, Test accuracy: 59.90
Round  37, Global train loss: 1.445, Global test loss: 2.210, Global test accuracy: 23.02
Round  38, Train loss: 1.007, Test loss: 1.161, Test accuracy: 61.32
Round  38, Global train loss: 1.007, Global test loss: 2.389, Global test accuracy: 23.76
Round  39, Train loss: 1.142, Test loss: 1.133, Test accuracy: 62.32
Round  39, Global train loss: 1.142, Global test loss: 2.086, Global test accuracy: 36.62
Round  40, Train loss: 1.290, Test loss: 1.166, Test accuracy: 61.02
Round  40, Global train loss: 1.290, Global test loss: 2.040, Global test accuracy: 34.32
Round  41, Train loss: 1.177, Test loss: 1.126, Test accuracy: 61.80
Round  41, Global train loss: 1.177, Global test loss: 1.759, Global test accuracy: 37.00
Round  42, Train loss: 1.074, Test loss: 1.154, Test accuracy: 63.22
Round  42, Global train loss: 1.074, Global test loss: 1.854, Global test accuracy: 27.96
Round  43, Train loss: 1.156, Test loss: 1.137, Test accuracy: 62.64
Round  43, Global train loss: 1.156, Global test loss: 2.074, Global test accuracy: 26.12
Round  44, Train loss: 1.312, Test loss: 1.153, Test accuracy: 61.14
Round  44, Global train loss: 1.312, Global test loss: 2.264, Global test accuracy: 21.40
Round  45, Train loss: 1.333, Test loss: 1.146, Test accuracy: 60.32
Round  45, Global train loss: 1.333, Global test loss: 1.853, Global test accuracy: 37.16
Round  46, Train loss: 0.890, Test loss: 1.102, Test accuracy: 62.46
Round  46, Global train loss: 0.890, Global test loss: 2.638, Global test accuracy: 22.08
Round  47, Train loss: 0.880, Test loss: 1.111, Test accuracy: 63.60
Round  47, Global train loss: 0.880, Global test loss: 2.167, Global test accuracy: 28.42
Round  48, Train loss: 1.009, Test loss: 1.127, Test accuracy: 61.68
Round  48, Global train loss: 1.009, Global test loss: 1.940, Global test accuracy: 36.40
Round  49, Train loss: 0.873, Test loss: 1.139, Test accuracy: 61.54
Round  49, Global train loss: 0.873, Global test loss: 1.929, Global test accuracy: 36.76
Round  50, Train loss: 1.094, Test loss: 1.161, Test accuracy: 59.48
Round  50, Global train loss: 1.094, Global test loss: 1.965, Global test accuracy: 33.68
Round  51, Train loss: 0.984, Test loss: 1.123, Test accuracy: 62.70
Round  51, Global train loss: 0.984, Global test loss: 2.029, Global test accuracy: 28.16
Round  52, Train loss: 1.203, Test loss: 1.114, Test accuracy: 62.32
Round  52, Global train loss: 1.203, Global test loss: 2.078, Global test accuracy: 37.80
Round  53, Train loss: 1.159, Test loss: 1.125, Test accuracy: 62.84
Round  53, Global train loss: 1.159, Global test loss: 2.096, Global test accuracy: 29.90
Round  54, Train loss: 1.079, Test loss: 1.142, Test accuracy: 61.40
Round  54, Global train loss: 1.079, Global test loss: 2.214, Global test accuracy: 36.54
Round  55, Train loss: 1.208, Test loss: 1.160, Test accuracy: 60.26
Round  55, Global train loss: 1.208, Global test loss: 2.306, Global test accuracy: 27.90
Round  56, Train loss: 1.025, Test loss: 1.176, Test accuracy: 57.86
Round  56, Global train loss: 1.025, Global test loss: 2.038, Global test accuracy: 37.48
Round  57, Train loss: 1.143, Test loss: 1.139, Test accuracy: 60.42
Round  57, Global train loss: 1.143, Global test loss: 1.987, Global test accuracy: 28.18
Round  58, Train loss: 0.928, Test loss: 1.129, Test accuracy: 61.30
Round  58, Global train loss: 0.928, Global test loss: 2.177, Global test accuracy: 32.64
Round  59, Train loss: 0.940, Test loss: 1.162, Test accuracy: 59.22
Round  59, Global train loss: 0.940, Global test loss: 1.836, Global test accuracy: 38.38
Round  60, Train loss: 1.077, Test loss: 1.156, Test accuracy: 59.94
Round  60, Global train loss: 1.077, Global test loss: 1.822, Global test accuracy: 42.14
Round  61, Train loss: 1.017, Test loss: 1.148, Test accuracy: 59.68
Round  61, Global train loss: 1.017, Global test loss: 2.002, Global test accuracy: 31.26
Round  62, Train loss: 0.925, Test loss: 1.138, Test accuracy: 61.38
Round  62, Global train loss: 0.925, Global test loss: 1.774, Global test accuracy: 36.48
Round  63, Train loss: 1.061, Test loss: 1.156, Test accuracy: 61.46
Round  63, Global train loss: 1.061, Global test loss: 2.060, Global test accuracy: 33.70
Round  64, Train loss: 0.925, Test loss: 1.115, Test accuracy: 62.30
Round  64, Global train loss: 0.925, Global test loss: 2.433, Global test accuracy: 28.66
Round  65, Train loss: 0.823, Test loss: 1.129, Test accuracy: 61.76
Round  65, Global train loss: 0.823, Global test loss: 1.708, Global test accuracy: 40.22
Round  66, Train loss: 1.083, Test loss: 1.141, Test accuracy: 59.28
Round  66, Global train loss: 1.083, Global test loss: 1.913, Global test accuracy: 38.44
Round  67, Train loss: 1.031, Test loss: 1.162, Test accuracy: 59.50
Round  67, Global train loss: 1.031, Global test loss: 1.957, Global test accuracy: 33.38
Round  68, Train loss: 0.735, Test loss: 1.144, Test accuracy: 60.20
Round  68, Global train loss: 0.735, Global test loss: 2.586, Global test accuracy: 22.78
Round  69, Train loss: 0.867, Test loss: 1.102, Test accuracy: 62.26
Round  69, Global train loss: 0.867, Global test loss: 1.722, Global test accuracy: 41.58
Round  70, Train loss: 1.176, Test loss: 1.144, Test accuracy: 60.06
Round  70, Global train loss: 1.176, Global test loss: 2.261, Global test accuracy: 22.80
Round  71, Train loss: 1.028, Test loss: 1.154, Test accuracy: 59.12
Round  71, Global train loss: 1.028, Global test loss: 1.961, Global test accuracy: 35.66
Round  72, Train loss: 0.774, Test loss: 1.094, Test accuracy: 62.26
Round  72, Global train loss: 0.774, Global test loss: 1.731, Global test accuracy: 42.74
Round  73, Train loss: 0.995, Test loss: 1.131, Test accuracy: 60.14
Round  73, Global train loss: 0.995, Global test loss: 1.812, Global test accuracy: 37.48
Round  74, Train loss: 1.026, Test loss: 1.191, Test accuracy: 57.18
Round  74, Global train loss: 1.026, Global test loss: 2.267, Global test accuracy: 20.68
Round  75, Train loss: 0.680, Test loss: 1.141, Test accuracy: 58.80
Round  75, Global train loss: 0.680, Global test loss: 2.626, Global test accuracy: 23.28
Round  76, Train loss: 0.921, Test loss: 1.159, Test accuracy: 58.86
Round  76, Global train loss: 0.921, Global test loss: 2.134, Global test accuracy: 34.04
Round  77, Train loss: 0.900, Test loss: 1.141, Test accuracy: 59.44
Round  77, Global train loss: 0.900, Global test loss: 2.084, Global test accuracy: 26.28
Round  78, Train loss: 0.773, Test loss: 1.164, Test accuracy: 58.60
Round  78, Global train loss: 0.773, Global test loss: 2.309, Global test accuracy: 29.70
Round  79, Train loss: 0.784, Test loss: 1.188, Test accuracy: 58.26
Round  79, Global train loss: 0.784, Global test loss: 1.848, Global test accuracy: 39.72
Round  80, Train loss: 0.661, Test loss: 1.116, Test accuracy: 61.46
Round  80, Global train loss: 0.661, Global test loss: 1.497, Global test accuracy: 52.78
Round  81, Train loss: 0.685, Test loss: 1.105, Test accuracy: 61.44
Round  81, Global train loss: 0.685, Global test loss: 1.462, Global test accuracy: 52.74
Round  82, Train loss: 0.582, Test loss: 1.121, Test accuracy: 61.64
Round  82, Global train loss: 0.582, Global test loss: 1.480, Global test accuracy: 53.18
Round  83, Train loss: 0.573, Test loss: 1.125, Test accuracy: 61.46
Round  83, Global train loss: 0.573, Global test loss: 1.501, Global test accuracy: 52.00
Round  84, Train loss: 0.545, Test loss: 1.096, Test accuracy: 62.54
Round  84, Global train loss: 0.545, Global test loss: 1.477, Global test accuracy: 53.46
Round  85, Train loss: 0.524, Test loss: 1.083, Test accuracy: 63.22
Round  85, Global train loss: 0.524, Global test loss: 1.463, Global test accuracy: 54.56
Round  86, Train loss: 0.512, Test loss: 1.099, Test accuracy: 62.22
Round  86, Global train loss: 0.512, Global test loss: 1.475, Global test accuracy: 53.12
Round  87, Train loss: 0.496, Test loss: 1.118, Test accuracy: 61.92
Round  87, Global train loss: 0.496, Global test loss: 1.488, Global test accuracy: 53.00
Round  88, Train loss: 0.490, Test loss: 1.106, Test accuracy: 62.26
Round  88, Global train loss: 0.490, Global test loss: 1.455, Global test accuracy: 53.20
Round  89, Train loss: 0.476, Test loss: 1.122, Test accuracy: 62.08
Round  89, Global train loss: 0.476, Global test loss: 1.488, Global test accuracy: 53.04
Round  90, Train loss: 0.450, Test loss: 1.123, Test accuracy: 62.44
Round  90, Global train loss: 0.450, Global test loss: 1.507, Global test accuracy: 52.80
Round  91, Train loss: 0.444, Test loss: 1.149, Test accuracy: 61.02
Round  91, Global train loss: 0.444, Global test loss: 1.525, Global test accuracy: 53.36
Round  92, Train loss: 0.436, Test loss: 1.139, Test accuracy: 61.52
Round  92, Global train loss: 0.436, Global test loss: 1.476, Global test accuracy: 53.02
Round  93, Train loss: 0.419, Test loss: 1.158, Test accuracy: 61.54
Round  93, Global train loss: 0.419, Global test loss: 1.481, Global test accuracy: 53.04
Round  94, Train loss: 0.415, Test loss: 1.144, Test accuracy: 61.36
Round  94, Global train loss: 0.415, Global test loss: 1.496, Global test accuracy: 52.48
Round  95, Train loss: 0.402, Test loss: 1.145, Test accuracy: 61.64
Round  95, Global train loss: 0.402, Global test loss: 1.485, Global test accuracy: 54.04
Round  96, Train loss: 0.390, Test loss: 1.145, Test accuracy: 61.76
Round  96, Global train loss: 0.390, Global test loss: 1.491, Global test accuracy: 53.80
Round  97, Train loss: 0.377, Test loss: 1.171, Test accuracy: 60.68
Round  97, Global train loss: 0.377, Global test loss: 1.525, Global test accuracy: 53.74
Round  98, Train loss: 0.368, Test loss: 1.160, Test accuracy: 61.36
Round  98, Global train loss: 0.368, Global test loss: 1.516, Global test accuracy: 53.20
Round  99, Train loss: 0.717, Test loss: 1.170, Test accuracy: 59.96
Round  99, Global train loss: 0.717, Global test loss: 1.435, Global test accuracy: 54.86
Final Round, Train loss: 0.671, Test loss: 1.197, Test accuracy: 58.98
Final Round, Global train loss: 0.671, Global test loss: 1.435, Global test accuracy: 54.86
Average accuracy final 10 rounds: 61.328
1860.1085839271545
[1.8627214431762695, 3.4216959476470947, 5.019171953201294, 6.566255569458008, 8.138651371002197, 9.79410696029663, 11.611108303070068, 13.244955062866211, 14.997987270355225, 16.669772386550903, 18.29544448852539, 27.67699646949768, 29.4085693359375, 38.88745880126953, 48.36998724937439, 57.68360233306885, 67.23064756393433, 76.80966806411743, 86.28547549247742, 87.83432292938232, 97.76345586776733, 99.42434883117676, 101.09834265708923, 110.7904725074768, 120.2723286151886, 129.84584522247314, 139.71432065963745, 149.15817308425903, 158.64509677886963, 168.26855087280273, 177.94314622879028, 187.54619121551514, 197.34924697875977, 207.1341848373413, 208.71206164360046, 218.48760175704956, 228.52428460121155, 238.29451155662537, 248.10249543190002, 249.7100691795349, 259.5578410625458, 268.96830105781555, 278.5123801231384, 288.4035861492157, 298.1194152832031, 307.7168619632721, 317.29162096977234, 326.94293212890625, 337.1407072544098, 346.44225430488586, 356.29408383369446, 365.6070387363434, 375.4160816669464, 385.0991303920746, 394.8673644065857, 404.9515619277954, 414.8511574268341, 424.54154777526855, 434.11774230003357, 443.9045376777649, 453.74236726760864, 463.40290665626526, 473.0622937679291, 483.1822347640991, 492.93059849739075, 502.6290602684021, 512.6086528301239, 522.2617928981781, 531.4227118492126, 541.1337394714355, 551.0224304199219, 560.6409001350403, 562.2292301654816, 572.2722160816193, 582.3772339820862, 592.2262737751007, 602.0052416324615, 611.910810470581, 621.2987265586853, 630.7555818557739, 632.3662805557251, 633.9923431873322, 635.6102776527405, 637.2765440940857, 638.8706974983215, 640.5429165363312, 642.260577917099, 644.0224590301514, 645.6590056419373, 647.3332757949829, 648.9591414928436, 650.7078924179077, 652.4268486499786, 654.0947635173798, 655.8433649539948, 657.4525406360626, 659.1089720726013, 660.7691297531128, 662.4223947525024, 671.7100040912628, 681.4226231575012]
[29.16, 34.96, 37.0, 40.76, 41.94, 45.12, 44.98, 48.02, 47.6, 49.38, 51.64, 46.54, 49.58, 52.5, 53.62, 52.32, 53.46, 51.24, 52.06, 58.82, 57.82, 60.84, 58.68, 60.78, 62.6, 59.52, 59.46, 62.62, 60.08, 60.92, 57.08, 59.4, 57.54, 56.8, 62.32, 59.92, 60.7, 59.9, 61.32, 62.32, 61.02, 61.8, 63.22, 62.64, 61.14, 60.32, 62.46, 63.6, 61.68, 61.54, 59.48, 62.7, 62.32, 62.84, 61.4, 60.26, 57.86, 60.42, 61.3, 59.22, 59.94, 59.68, 61.38, 61.46, 62.3, 61.76, 59.28, 59.5, 60.2, 62.26, 60.06, 59.12, 62.26, 60.14, 57.18, 58.8, 58.86, 59.44, 58.6, 58.26, 61.46, 61.44, 61.64, 61.46, 62.54, 63.22, 62.22, 61.92, 62.26, 62.08, 62.44, 61.02, 61.52, 61.54, 61.36, 61.64, 61.76, 60.68, 61.36, 59.96, 58.98]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.940, Test loss: 2.162, Test accuracy: 19.74
Round   0, Global train loss: 1.940, Global test loss: 2.318, Global test accuracy: 16.90
Round   1, Train loss: 1.926, Test loss: 1.888, Test accuracy: 33.82
Round   1, Global train loss: 1.926, Global test loss: 2.218, Global test accuracy: 23.38
Round   2, Train loss: 1.782, Test loss: 1.731, Test accuracy: 39.26
Round   2, Global train loss: 1.782, Global test loss: 2.113, Global test accuracy: 31.98
Round   3, Train loss: 1.630, Test loss: 1.740, Test accuracy: 37.70
Round   3, Global train loss: 1.630, Global test loss: 2.130, Global test accuracy: 25.22
Round   4, Train loss: 1.822, Test loss: 1.713, Test accuracy: 39.42
Round   4, Global train loss: 1.822, Global test loss: 2.228, Global test accuracy: 22.20
Round   5, Train loss: 1.792, Test loss: 1.648, Test accuracy: 41.36
Round   5, Global train loss: 1.792, Global test loss: 2.315, Global test accuracy: 18.42
Round   6, Train loss: 1.610, Test loss: 1.577, Test accuracy: 44.72
Round   6, Global train loss: 1.610, Global test loss: 2.206, Global test accuracy: 25.42
Round   7, Train loss: 1.675, Test loss: 1.439, Test accuracy: 49.48
Round   7, Global train loss: 1.675, Global test loss: 2.059, Global test accuracy: 33.10
Round   8, Train loss: 1.613, Test loss: 1.416, Test accuracy: 52.50
Round   8, Global train loss: 1.613, Global test loss: 2.206, Global test accuracy: 25.00
Round   9, Train loss: 1.642, Test loss: 1.420, Test accuracy: 51.48
Round   9, Global train loss: 1.642, Global test loss: 2.272, Global test accuracy: 22.90
Round  10, Train loss: 1.593, Test loss: 1.362, Test accuracy: 51.70
Round  10, Global train loss: 1.593, Global test loss: 2.074, Global test accuracy: 33.30
Round  11, Train loss: 1.614, Test loss: 1.255, Test accuracy: 56.88
Round  11, Global train loss: 1.614, Global test loss: 2.042, Global test accuracy: 37.30
Round  12, Train loss: 1.459, Test loss: 1.242, Test accuracy: 58.26
Round  12, Global train loss: 1.459, Global test loss: 2.086, Global test accuracy: 29.42
Round  13, Train loss: 1.603, Test loss: 1.242, Test accuracy: 57.90
Round  13, Global train loss: 1.603, Global test loss: 2.143, Global test accuracy: 28.10
Round  14, Train loss: 1.310, Test loss: 1.208, Test accuracy: 58.06
Round  14, Global train loss: 1.310, Global test loss: 2.092, Global test accuracy: 25.96
Round  15, Train loss: 1.431, Test loss: 1.189, Test accuracy: 58.72
Round  15, Global train loss: 1.431, Global test loss: 1.948, Global test accuracy: 38.18
Round  16, Train loss: 1.424, Test loss: 1.181, Test accuracy: 58.48
Round  16, Global train loss: 1.424, Global test loss: 2.095, Global test accuracy: 26.20
Round  17, Train loss: 1.489, Test loss: 1.179, Test accuracy: 58.40
Round  17, Global train loss: 1.489, Global test loss: 2.131, Global test accuracy: 27.60
Round  18, Train loss: 1.545, Test loss: 1.177, Test accuracy: 58.66
Round  18, Global train loss: 1.545, Global test loss: 2.155, Global test accuracy: 26.48
Round  19, Train loss: 1.608, Test loss: 1.179, Test accuracy: 59.92
Round  19, Global train loss: 1.608, Global test loss: 2.282, Global test accuracy: 15.20
Round  20, Train loss: 1.458, Test loss: 1.159, Test accuracy: 60.56
Round  20, Global train loss: 1.458, Global test loss: 2.373, Global test accuracy: 20.90
Round  21, Train loss: 1.132, Test loss: 1.151, Test accuracy: 60.76
Round  21, Global train loss: 1.132, Global test loss: 2.084, Global test accuracy: 26.38
Round  22, Train loss: 1.359, Test loss: 1.136, Test accuracy: 61.40
Round  22, Global train loss: 1.359, Global test loss: 2.084, Global test accuracy: 27.28
Round  23, Train loss: 1.312, Test loss: 1.140, Test accuracy: 61.20
Round  23, Global train loss: 1.312, Global test loss: 2.100, Global test accuracy: 26.74
Round  24, Train loss: 1.215, Test loss: 1.149, Test accuracy: 62.18
Round  24, Global train loss: 1.215, Global test loss: 2.026, Global test accuracy: 33.38
Round  25, Train loss: 1.270, Test loss: 1.139, Test accuracy: 61.92
Round  25, Global train loss: 1.270, Global test loss: 2.038, Global test accuracy: 32.80
Round  26, Train loss: 1.369, Test loss: 1.124, Test accuracy: 62.60
Round  26, Global train loss: 1.369, Global test loss: 2.155, Global test accuracy: 27.94
Round  27, Train loss: 1.288, Test loss: 1.138, Test accuracy: 61.40
Round  27, Global train loss: 1.288, Global test loss: 2.147, Global test accuracy: 28.60
Round  28, Train loss: 1.062, Test loss: 1.142, Test accuracy: 61.58
Round  28, Global train loss: 1.062, Global test loss: 1.895, Global test accuracy: 35.56
Round  29, Train loss: 1.354, Test loss: 1.151, Test accuracy: 60.84
Round  29, Global train loss: 1.354, Global test loss: 2.110, Global test accuracy: 28.70
Round  30, Train loss: 1.112, Test loss: 1.154, Test accuracy: 61.02
Round  30, Global train loss: 1.112, Global test loss: 2.027, Global test accuracy: 32.22
Round  31, Train loss: 1.163, Test loss: 1.138, Test accuracy: 62.04
Round  31, Global train loss: 1.163, Global test loss: 2.080, Global test accuracy: 31.80
Round  32, Train loss: 1.073, Test loss: 1.132, Test accuracy: 62.24
Round  32, Global train loss: 1.073, Global test loss: 2.059, Global test accuracy: 32.86
Round  33, Train loss: 1.270, Test loss: 1.131, Test accuracy: 62.20
Round  33, Global train loss: 1.270, Global test loss: 2.225, Global test accuracy: 20.96
Round  34, Train loss: 0.936, Test loss: 1.136, Test accuracy: 62.14
Round  34, Global train loss: 0.936, Global test loss: 1.919, Global test accuracy: 35.62
Round  35, Train loss: 0.926, Test loss: 1.148, Test accuracy: 61.92
Round  35, Global train loss: 0.926, Global test loss: 1.895, Global test accuracy: 32.82
Round  36, Train loss: 1.229, Test loss: 1.160, Test accuracy: 61.88
Round  36, Global train loss: 1.229, Global test loss: 2.176, Global test accuracy: 23.84
Round  37, Train loss: 1.306, Test loss: 1.155, Test accuracy: 61.12
Round  37, Global train loss: 1.306, Global test loss: 2.286, Global test accuracy: 21.58
Round  38, Train loss: 1.250, Test loss: 1.170, Test accuracy: 60.94
Round  38, Global train loss: 1.250, Global test loss: 2.299, Global test accuracy: 19.88
Round  39, Train loss: 0.993, Test loss: 1.185, Test accuracy: 60.70
Round  39, Global train loss: 0.993, Global test loss: 1.974, Global test accuracy: 31.88
Round  40, Train loss: 0.886, Test loss: 1.211, Test accuracy: 60.64
Round  40, Global train loss: 0.886, Global test loss: 2.101, Global test accuracy: 23.40
Round  41, Train loss: 0.997, Test loss: 1.226, Test accuracy: 59.94
Round  41, Global train loss: 0.997, Global test loss: 2.097, Global test accuracy: 35.44
Round  42, Train loss: 0.937, Test loss: 1.258, Test accuracy: 58.74
Round  42, Global train loss: 0.937, Global test loss: 2.045, Global test accuracy: 29.76
Round  43, Train loss: 0.890, Test loss: 1.262, Test accuracy: 59.60
Round  43, Global train loss: 0.890, Global test loss: 2.044, Global test accuracy: 28.38
Round  44, Train loss: 0.952, Test loss: 1.246, Test accuracy: 59.46
Round  44, Global train loss: 0.952, Global test loss: 1.931, Global test accuracy: 36.70
Round  45, Train loss: 1.146, Test loss: 1.238, Test accuracy: 60.06
Round  45, Global train loss: 1.146, Global test loss: 2.017, Global test accuracy: 35.34
Round  46, Train loss: 0.855, Test loss: 1.228, Test accuracy: 60.18
Round  46, Global train loss: 0.855, Global test loss: 1.897, Global test accuracy: 38.18
Round  47, Train loss: 0.803, Test loss: 1.232, Test accuracy: 60.18
Round  47, Global train loss: 0.803, Global test loss: 1.890, Global test accuracy: 38.50
Round  48, Train loss: 0.937, Test loss: 1.271, Test accuracy: 59.70
Round  48, Global train loss: 0.937, Global test loss: 2.127, Global test accuracy: 35.10
Round  49, Train loss: 0.778, Test loss: 1.257, Test accuracy: 60.34
Round  49, Global train loss: 0.778, Global test loss: 1.865, Global test accuracy: 36.00
Round  50, Train loss: 0.897, Test loss: 1.290, Test accuracy: 60.40
Round  50, Global train loss: 0.897, Global test loss: 2.089, Global test accuracy: 28.16
Round  51, Train loss: 1.069, Test loss: 1.279, Test accuracy: 60.70
Round  51, Global train loss: 1.069, Global test loss: 2.269, Global test accuracy: 28.76
Round  52, Train loss: 0.770, Test loss: 1.296, Test accuracy: 60.14
Round  52, Global train loss: 0.770, Global test loss: 1.962, Global test accuracy: 33.40
Round  53, Train loss: 0.765, Test loss: 1.355, Test accuracy: 59.42
Round  53, Global train loss: 0.765, Global test loss: 1.923, Global test accuracy: 36.02
Round  54, Train loss: 1.053, Test loss: 1.376, Test accuracy: 58.24
Round  54, Global train loss: 1.053, Global test loss: 2.191, Global test accuracy: 28.42
Round  55, Train loss: 0.844, Test loss: 1.349, Test accuracy: 58.38
Round  55, Global train loss: 0.844, Global test loss: 2.217, Global test accuracy: 26.20
Round  56, Train loss: 0.908, Test loss: 1.351, Test accuracy: 57.86
Round  56, Global train loss: 0.908, Global test loss: 2.262, Global test accuracy: 20.38
Round  57, Train loss: 0.971, Test loss: 1.373, Test accuracy: 57.48
Round  57, Global train loss: 0.971, Global test loss: 2.109, Global test accuracy: 29.76
Round  58, Train loss: 0.689, Test loss: 1.421, Test accuracy: 57.10
Round  58, Global train loss: 0.689, Global test loss: 2.140, Global test accuracy: 30.50
Round  59, Train loss: 0.667, Test loss: 1.427, Test accuracy: 57.58
Round  59, Global train loss: 0.667, Global test loss: 2.298, Global test accuracy: 22.92
Round  60, Train loss: 0.650, Test loss: 1.476, Test accuracy: 56.64
Round  60, Global train loss: 0.650, Global test loss: 2.024, Global test accuracy: 28.72
Round  61, Train loss: 0.762, Test loss: 1.513, Test accuracy: 56.64
Round  61, Global train loss: 0.762, Global test loss: 2.065, Global test accuracy: 32.32
Round  62, Train loss: 0.622, Test loss: 1.495, Test accuracy: 56.90
Round  62, Global train loss: 0.622, Global test loss: 1.951, Global test accuracy: 33.56
Round  63, Train loss: 0.899, Test loss: 1.547, Test accuracy: 56.26
Round  63, Global train loss: 0.899, Global test loss: 2.085, Global test accuracy: 29.40
Round  64, Train loss: 0.570, Test loss: 1.604, Test accuracy: 56.08
Round  64, Global train loss: 0.570, Global test loss: 2.293, Global test accuracy: 24.08
Round  65, Train loss: 0.790, Test loss: 1.613, Test accuracy: 55.68
Round  65, Global train loss: 0.790, Global test loss: 1.969, Global test accuracy: 34.62
Round  66, Train loss: 0.623, Test loss: 1.641, Test accuracy: 55.34
Round  66, Global train loss: 0.623, Global test loss: 2.111, Global test accuracy: 29.40
Round  67, Train loss: 0.772, Test loss: 1.680, Test accuracy: 54.50
Round  67, Global train loss: 0.772, Global test loss: 2.050, Global test accuracy: 29.52
Round  68, Train loss: 0.683, Test loss: 1.658, Test accuracy: 54.64
Round  68, Global train loss: 0.683, Global test loss: 2.021, Global test accuracy: 38.46
Round  69, Train loss: 0.738, Test loss: 1.647, Test accuracy: 54.98
Round  69, Global train loss: 0.738, Global test loss: 2.094, Global test accuracy: 27.36
Round  70, Train loss: 0.572, Test loss: 1.665, Test accuracy: 55.44
Round  70, Global train loss: 0.572, Global test loss: 2.092, Global test accuracy: 28.74
Round  71, Train loss: 0.369, Test loss: 1.694, Test accuracy: 54.32
Round  71, Global train loss: 0.369, Global test loss: 1.943, Global test accuracy: 32.66
Round  72, Train loss: 0.711, Test loss: 1.722, Test accuracy: 55.46
Round  72, Global train loss: 0.711, Global test loss: 2.143, Global test accuracy: 27.18
Round  73, Train loss: 0.328, Test loss: 1.731, Test accuracy: 55.88
Round  73, Global train loss: 0.328, Global test loss: 2.108, Global test accuracy: 27.26
Round  74, Train loss: 0.538, Test loss: 1.775, Test accuracy: 55.52
Round  74, Global train loss: 0.538, Global test loss: 1.999, Global test accuracy: 36.66
Round  75, Train loss: 0.519, Test loss: 1.761, Test accuracy: 55.40
Round  75, Global train loss: 0.519, Global test loss: 2.125, Global test accuracy: 32.10
Round  76, Train loss: 0.296, Test loss: 1.790, Test accuracy: 54.98
Round  76, Global train loss: 0.296, Global test loss: 1.828, Global test accuracy: 40.02
Round  77, Train loss: 0.489, Test loss: 1.809, Test accuracy: 54.52
Round  77, Global train loss: 0.489, Global test loss: 1.905, Global test accuracy: 37.40
Round  78, Train loss: 0.497, Test loss: 1.844, Test accuracy: 54.06
Round  78, Global train loss: 0.497, Global test loss: 2.167, Global test accuracy: 22.10
Round  79, Train loss: 0.383, Test loss: 1.899, Test accuracy: 54.36
Round  79, Global train loss: 0.383, Global test loss: 1.927, Global test accuracy: 34.44
Round  80, Train loss: 0.570, Test loss: 1.957, Test accuracy: 55.06
Round  80, Global train loss: 0.570, Global test loss: 2.099, Global test accuracy: 25.90
Round  81, Train loss: 0.413, Test loss: 1.967, Test accuracy: 55.84
Round  81, Global train loss: 0.413, Global test loss: 1.990, Global test accuracy: 31.44
Round  82, Train loss: 0.621, Test loss: 1.940, Test accuracy: 55.18
Round  82, Global train loss: 0.621, Global test loss: 2.269, Global test accuracy: 23.10
Round  83, Train loss: 0.561, Test loss: 2.010, Test accuracy: 54.20
Round  83, Global train loss: 0.561, Global test loss: 2.124, Global test accuracy: 25.88
Round  84, Train loss: 0.411, Test loss: 2.056, Test accuracy: 54.86
Round  84, Global train loss: 0.411, Global test loss: 2.064, Global test accuracy: 29.46
Round  85, Train loss: 0.473, Test loss: 2.073, Test accuracy: 54.64
Round  85, Global train loss: 0.473, Global test loss: 2.132, Global test accuracy: 26.86
Round  86, Train loss: 0.286, Test loss: 2.167, Test accuracy: 54.06
Round  86, Global train loss: 0.286, Global test loss: 2.225, Global test accuracy: 29.74
Round  87, Train loss: 0.435, Test loss: 2.153, Test accuracy: 54.10
Round  87, Global train loss: 0.435, Global test loss: 2.304, Global test accuracy: 24.20
Round  88, Train loss: 0.331, Test loss: 2.172, Test accuracy: 53.74
Round  88, Global train loss: 0.331, Global test loss: 2.162, Global test accuracy: 26.76
Round  89, Train loss: 0.356, Test loss: 2.166, Test accuracy: 53.62
Round  89, Global train loss: 0.356, Global test loss: 2.086, Global test accuracy: 27.90
Round  90, Train loss: 0.239, Test loss: 2.127, Test accuracy: 54.64
Round  90, Global train loss: 0.239, Global test loss: 2.094, Global test accuracy: 25.48
Round  91, Train loss: 0.303, Test loss: 2.097, Test accuracy: 54.68
Round  91, Global train loss: 0.303, Global test loss: 2.343, Global test accuracy: 24.68
Round  92, Train loss: 0.373, Test loss: 2.166, Test accuracy: 54.98
Round  92, Global train loss: 0.373, Global test loss: 2.102, Global test accuracy: 29.00
Round  93, Train loss: 0.267, Test loss: 2.221, Test accuracy: 54.10
Round  93, Global train loss: 0.267, Global test loss: 1.894, Global test accuracy: 36.42
Round  94, Train loss: 0.259, Test loss: 2.245, Test accuracy: 53.20
Round  94, Global train loss: 0.259, Global test loss: 2.075, Global test accuracy: 27.42
Round  95, Train loss: 0.303, Test loss: 2.329, Test accuracy: 53.06
Round  95, Global train loss: 0.303, Global test loss: 1.995, Global test accuracy: 30.04
Round  96, Train loss: 0.348, Test loss: 2.297, Test accuracy: 53.54
Round  96, Global train loss: 0.348, Global test loss: 2.110, Global test accuracy: 30.44
Round  97, Train loss: 0.342, Test loss: 2.333, Test accuracy: 53.78
Round  97, Global train loss: 0.342, Global test loss: 2.098, Global test accuracy: 29.28
Round  98, Train loss: 0.282, Test loss: 2.278, Test accuracy: 54.00
Round  98, Global train loss: 0.282, Global test loss: 2.143, Global test accuracy: 25.14
Round  99, Train loss: 0.181, Test loss: 2.329, Test accuracy: 53.28
Round  99, Global train loss: 0.181, Global test loss: 1.971, Global test accuracy: 35.80
Final Round, Train loss: 0.276, Test loss: 2.442, Test accuracy: 53.32
Final Round, Global train loss: 0.276, Global test loss: 1.971, Global test accuracy: 35.80
Average accuracy final 10 rounds: 53.926 

Average global accuracy final 10 rounds: 29.37 

796.2045984268188
[1.5353097915649414, 3.070619583129883, 4.307066440582275, 5.543513298034668, 6.785392999649048, 8.027272701263428, 9.258066415786743, 10.488860130310059, 11.814527750015259, 13.140195369720459, 14.397658824920654, 15.65512228012085, 16.87405824661255, 18.092994213104248, 19.325055599212646, 20.557116985321045, 21.679667949676514, 22.802218914031982, 23.91739511489868, 25.03257131576538, 26.239195346832275, 27.44581937789917, 28.535717248916626, 29.625615119934082, 30.720083475112915, 31.814551830291748, 33.03094553947449, 34.24733924865723, 35.35834789276123, 36.469356536865234, 37.5909161567688, 38.71247577667236, 39.9153368473053, 41.11819791793823, 42.19096922874451, 43.26374053955078, 44.34953999519348, 45.43533945083618, 46.51101565361023, 47.58669185638428, 48.67133402824402, 49.75597620010376, 50.8313410282135, 51.90670585632324, 53.04521727561951, 54.18372869491577, 55.357484340667725, 56.53123998641968, 57.662729024887085, 58.79421806335449, 59.89378094673157, 60.99334383010864, 62.091710329055786, 63.19007682800293, 64.30792474746704, 65.42577266693115, 66.54142165184021, 67.65707063674927, 68.81073141098022, 69.96439218521118, 71.22056722640991, 72.47674226760864, 73.66572976112366, 74.85471725463867, 76.02674269676208, 77.1987681388855, 78.38799405097961, 79.57721996307373, 80.7206199169159, 81.86401987075806, 83.09546399116516, 84.32690811157227, 85.55429768562317, 86.78168725967407, 88.02718901634216, 89.27269077301025, 90.37059783935547, 91.46850490570068, 92.546395778656, 93.62428665161133, 94.71480917930603, 95.80533170700073, 96.91703128814697, 98.02873086929321, 99.18338513374329, 100.33803939819336, 101.51924562454224, 102.70045185089111, 103.79674005508423, 104.89302825927734, 105.97792935371399, 107.06283044815063, 108.13608837127686, 109.20934629440308, 110.2893934249878, 111.36944055557251, 112.53805375099182, 113.70666694641113, 114.89112257957458, 116.07557821273804, 117.16011118888855, 118.24464416503906, 119.33952140808105, 120.43439865112305, 121.55481052398682, 122.67522239685059, 123.84660720825195, 125.01799201965332, 126.28688097000122, 127.55576992034912, 128.65238213539124, 129.74899435043335, 130.8433222770691, 131.93765020370483, 133.0433168411255, 134.14898347854614, 135.25240993499756, 136.35583639144897, 137.45421028137207, 138.55258417129517, 139.6944236755371, 140.83626317977905, 142.11259055137634, 143.38891792297363, 144.62496972084045, 145.86102151870728, 147.104722738266, 148.3484239578247, 149.48841547966003, 150.62840700149536, 151.80984807014465, 152.99128913879395, 154.1622347831726, 155.33318042755127, 156.52418112754822, 157.71518182754517, 158.88542914390564, 160.0556764602661, 161.32278895378113, 162.58990144729614, 163.84422850608826, 165.09855556488037, 166.20752692222595, 167.31649827957153, 168.41937017440796, 169.52224206924438, 170.60469961166382, 171.68715715408325, 172.78642678260803, 173.8856964111328, 175.07170128822327, 176.25770616531372, 177.43635630607605, 178.61500644683838, 179.71876907348633, 180.82253170013428, 181.93115425109863, 183.039776802063, 184.14499855041504, 185.2502202987671, 186.34517574310303, 187.44013118743896, 188.7252790927887, 190.01042699813843, 191.2507255077362, 192.49102401733398, 193.67115592956543, 194.85128784179688, 196.07482242584229, 197.2983570098877, 198.49867248535156, 199.69898796081543, 200.90779519081116, 202.11660242080688, 203.31598138809204, 204.5153603553772, 205.7045121192932, 206.89366388320923, 208.10091495513916, 209.3081660270691, 210.60212445259094, 211.8960828781128, 213.18187069892883, 214.46765851974487, 215.6337251663208, 216.79979181289673, 217.90201616287231, 219.0042405128479, 220.1347532272339, 221.26526594161987, 222.38658905029297, 223.50791215896606, 224.63964343070984, 225.7713747024536, 226.92863631248474, 228.08589792251587, 229.3405637741089, 230.5952296257019, 231.8177433013916, 233.0402569770813, 235.31414341926575, 237.5880298614502]
[19.74, 19.74, 33.82, 33.82, 39.26, 39.26, 37.7, 37.7, 39.42, 39.42, 41.36, 41.36, 44.72, 44.72, 49.48, 49.48, 52.5, 52.5, 51.48, 51.48, 51.7, 51.7, 56.88, 56.88, 58.26, 58.26, 57.9, 57.9, 58.06, 58.06, 58.72, 58.72, 58.48, 58.48, 58.4, 58.4, 58.66, 58.66, 59.92, 59.92, 60.56, 60.56, 60.76, 60.76, 61.4, 61.4, 61.2, 61.2, 62.18, 62.18, 61.92, 61.92, 62.6, 62.6, 61.4, 61.4, 61.58, 61.58, 60.84, 60.84, 61.02, 61.02, 62.04, 62.04, 62.24, 62.24, 62.2, 62.2, 62.14, 62.14, 61.92, 61.92, 61.88, 61.88, 61.12, 61.12, 60.94, 60.94, 60.7, 60.7, 60.64, 60.64, 59.94, 59.94, 58.74, 58.74, 59.6, 59.6, 59.46, 59.46, 60.06, 60.06, 60.18, 60.18, 60.18, 60.18, 59.7, 59.7, 60.34, 60.34, 60.4, 60.4, 60.7, 60.7, 60.14, 60.14, 59.42, 59.42, 58.24, 58.24, 58.38, 58.38, 57.86, 57.86, 57.48, 57.48, 57.1, 57.1, 57.58, 57.58, 56.64, 56.64, 56.64, 56.64, 56.9, 56.9, 56.26, 56.26, 56.08, 56.08, 55.68, 55.68, 55.34, 55.34, 54.5, 54.5, 54.64, 54.64, 54.98, 54.98, 55.44, 55.44, 54.32, 54.32, 55.46, 55.46, 55.88, 55.88, 55.52, 55.52, 55.4, 55.4, 54.98, 54.98, 54.52, 54.52, 54.06, 54.06, 54.36, 54.36, 55.06, 55.06, 55.84, 55.84, 55.18, 55.18, 54.2, 54.2, 54.86, 54.86, 54.64, 54.64, 54.06, 54.06, 54.1, 54.1, 53.74, 53.74, 53.62, 53.62, 54.64, 54.64, 54.68, 54.68, 54.98, 54.98, 54.1, 54.1, 53.2, 53.2, 53.06, 53.06, 53.54, 53.54, 53.78, 53.78, 54.0, 54.0, 53.28, 53.28, 53.32, 53.32]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.971, Test loss: 2.169, Test accuracy: 13.48
Round   0, Global train loss: 1.971, Global test loss: 2.327, Global test accuracy: 10.00
Round   1, Train loss: 1.718, Test loss: 1.811, Test accuracy: 34.32
Round   1, Global train loss: 1.718, Global test loss: 2.092, Global test accuracy: 29.36
Round   2, Train loss: 1.593, Test loss: 1.698, Test accuracy: 38.26
Round   2, Global train loss: 1.593, Global test loss: 1.980, Global test accuracy: 33.18
Round   3, Train loss: 1.684, Test loss: 1.634, Test accuracy: 40.98
Round   3, Global train loss: 1.684, Global test loss: 1.929, Global test accuracy: 35.80
Round   4, Train loss: 1.611, Test loss: 1.561, Test accuracy: 44.80
Round   4, Global train loss: 1.611, Global test loss: 1.919, Global test accuracy: 34.10
Round   5, Train loss: 1.684, Test loss: 1.485, Test accuracy: 47.80
Round   5, Global train loss: 1.684, Global test loss: 1.925, Global test accuracy: 34.92
Round   6, Train loss: 1.846, Test loss: 1.423, Test accuracy: 51.56
Round   6, Global train loss: 1.846, Global test loss: 1.900, Global test accuracy: 41.40
Round   7, Train loss: 1.626, Test loss: 1.316, Test accuracy: 54.16
Round   7, Global train loss: 1.626, Global test loss: 1.749, Global test accuracy: 37.78
Round   8, Train loss: 1.447, Test loss: 1.267, Test accuracy: 57.94
Round   8, Global train loss: 1.447, Global test loss: 1.747, Global test accuracy: 40.96
Round   9, Train loss: 1.638, Test loss: 1.266, Test accuracy: 57.96
Round   9, Global train loss: 1.638, Global test loss: 1.774, Global test accuracy: 41.88
Round  10, Train loss: 1.161, Test loss: 1.220, Test accuracy: 59.68
Round  10, Global train loss: 1.161, Global test loss: 1.701, Global test accuracy: 46.22
Round  11, Train loss: 1.714, Test loss: 1.154, Test accuracy: 63.86
Round  11, Global train loss: 1.714, Global test loss: 1.709, Global test accuracy: 48.38
Round  12, Train loss: 1.393, Test loss: 1.151, Test accuracy: 64.14
Round  12, Global train loss: 1.393, Global test loss: 1.628, Global test accuracy: 44.78
Round  13, Train loss: 1.434, Test loss: 1.127, Test accuracy: 65.14
Round  13, Global train loss: 1.434, Global test loss: 1.567, Global test accuracy: 49.64
Round  14, Train loss: 1.653, Test loss: 1.114, Test accuracy: 64.42
Round  14, Global train loss: 1.653, Global test loss: 1.697, Global test accuracy: 46.48
Round  15, Train loss: 1.321, Test loss: 1.136, Test accuracy: 63.84
Round  15, Global train loss: 1.321, Global test loss: 1.562, Global test accuracy: 48.60
Round  16, Train loss: 1.538, Test loss: 1.106, Test accuracy: 63.86
Round  16, Global train loss: 1.538, Global test loss: 1.579, Global test accuracy: 50.36
Round  17, Train loss: 1.260, Test loss: 1.122, Test accuracy: 64.22
Round  17, Global train loss: 1.260, Global test loss: 1.514, Global test accuracy: 52.54
Round  18, Train loss: 1.641, Test loss: 1.088, Test accuracy: 66.50
Round  18, Global train loss: 1.641, Global test loss: 1.610, Global test accuracy: 51.82
Round  19, Train loss: 1.654, Test loss: 1.086, Test accuracy: 66.66
Round  19, Global train loss: 1.654, Global test loss: 1.691, Global test accuracy: 49.46
Round  20, Train loss: 1.499, Test loss: 1.088, Test accuracy: 67.00
Round  20, Global train loss: 1.499, Global test loss: 1.699, Global test accuracy: 45.62
Round  21, Train loss: 1.524, Test loss: 1.101, Test accuracy: 66.42
Round  21, Global train loss: 1.524, Global test loss: 1.683, Global test accuracy: 45.88
Round  22, Train loss: 1.307, Test loss: 1.093, Test accuracy: 66.08
Round  22, Global train loss: 1.307, Global test loss: 1.549, Global test accuracy: 49.94
Round  23, Train loss: 1.595, Test loss: 1.087, Test accuracy: 65.18
Round  23, Global train loss: 1.595, Global test loss: 1.563, Global test accuracy: 53.12
Round  24, Train loss: 1.173, Test loss: 1.058, Test accuracy: 66.40
Round  24, Global train loss: 1.173, Global test loss: 1.521, Global test accuracy: 51.00
Round  25, Train loss: 1.141, Test loss: 1.058, Test accuracy: 66.46
Round  25, Global train loss: 1.141, Global test loss: 1.519, Global test accuracy: 52.06
Round  26, Train loss: 1.490, Test loss: 1.054, Test accuracy: 67.16
Round  26, Global train loss: 1.490, Global test loss: 1.492, Global test accuracy: 54.28
Round  27, Train loss: 1.269, Test loss: 1.052, Test accuracy: 67.40
Round  27, Global train loss: 1.269, Global test loss: 1.592, Global test accuracy: 48.02
Round  28, Train loss: 1.027, Test loss: 1.083, Test accuracy: 66.80
Round  28, Global train loss: 1.027, Global test loss: 1.491, Global test accuracy: 51.66
Round  29, Train loss: 1.227, Test loss: 1.092, Test accuracy: 65.50
Round  29, Global train loss: 1.227, Global test loss: 1.472, Global test accuracy: 52.62
Round  30, Train loss: 0.995, Test loss: 1.080, Test accuracy: 65.24
Round  30, Global train loss: 0.995, Global test loss: 1.494, Global test accuracy: 52.74
Round  31, Train loss: 0.922, Test loss: 1.087, Test accuracy: 65.80
Round  31, Global train loss: 0.922, Global test loss: 1.339, Global test accuracy: 56.02
Round  32, Train loss: 1.206, Test loss: 1.060, Test accuracy: 67.22
Round  32, Global train loss: 1.206, Global test loss: 1.411, Global test accuracy: 55.50
Round  33, Train loss: 1.180, Test loss: 1.060, Test accuracy: 66.48
Round  33, Global train loss: 1.180, Global test loss: 1.376, Global test accuracy: 55.92
Round  34, Train loss: 1.169, Test loss: 1.084, Test accuracy: 64.90
Round  34, Global train loss: 1.169, Global test loss: 1.485, Global test accuracy: 53.08
Round  35, Train loss: 0.918, Test loss: 1.067, Test accuracy: 65.76
Round  35, Global train loss: 0.918, Global test loss: 1.293, Global test accuracy: 59.26
Round  36, Train loss: 1.115, Test loss: 1.067, Test accuracy: 65.56
Round  36, Global train loss: 1.115, Global test loss: 1.401, Global test accuracy: 54.32
Round  37, Train loss: 1.216, Test loss: 1.075, Test accuracy: 64.78
Round  37, Global train loss: 1.216, Global test loss: 1.583, Global test accuracy: 49.34
Round  38, Train loss: 1.083, Test loss: 1.110, Test accuracy: 64.14
Round  38, Global train loss: 1.083, Global test loss: 1.708, Global test accuracy: 47.84
Round  39, Train loss: 0.880, Test loss: 1.060, Test accuracy: 65.56
Round  39, Global train loss: 0.880, Global test loss: 1.380, Global test accuracy: 55.86
Round  40, Train loss: 0.926, Test loss: 1.069, Test accuracy: 65.84
Round  40, Global train loss: 0.926, Global test loss: 1.417, Global test accuracy: 56.70
Round  41, Train loss: 1.005, Test loss: 1.061, Test accuracy: 66.12
Round  41, Global train loss: 1.005, Global test loss: 1.352, Global test accuracy: 56.62
Round  42, Train loss: 1.161, Test loss: 1.071, Test accuracy: 65.22
Round  42, Global train loss: 1.161, Global test loss: 1.531, Global test accuracy: 51.08
Round  43, Train loss: 1.079, Test loss: 1.098, Test accuracy: 64.66
Round  43, Global train loss: 1.079, Global test loss: 1.666, Global test accuracy: 45.74
Round  44, Train loss: 0.982, Test loss: 1.115, Test accuracy: 63.72
Round  44, Global train loss: 0.982, Global test loss: 1.564, Global test accuracy: 50.12
Round  45, Train loss: 0.978, Test loss: 1.155, Test accuracy: 61.42
Round  45, Global train loss: 0.978, Global test loss: 1.600, Global test accuracy: 49.86
Round  46, Train loss: 0.825, Test loss: 1.132, Test accuracy: 62.52
Round  46, Global train loss: 0.825, Global test loss: 1.450, Global test accuracy: 56.12
Round  47, Train loss: 0.728, Test loss: 1.161, Test accuracy: 61.90
Round  47, Global train loss: 0.728, Global test loss: 1.542, Global test accuracy: 54.64
Round  48, Train loss: 0.985, Test loss: 1.185, Test accuracy: 61.74
Round  48, Global train loss: 0.985, Global test loss: 1.517, Global test accuracy: 53.62
Round  49, Train loss: 0.684, Test loss: 1.180, Test accuracy: 62.40
Round  49, Global train loss: 0.684, Global test loss: 1.370, Global test accuracy: 56.40
Round  50, Train loss: 0.845, Test loss: 1.137, Test accuracy: 63.94
Round  50, Global train loss: 0.845, Global test loss: 1.557, Global test accuracy: 54.18
Round  51, Train loss: 1.021, Test loss: 1.150, Test accuracy: 63.60
Round  51, Global train loss: 1.021, Global test loss: 1.629, Global test accuracy: 47.42
Round  52, Train loss: 0.666, Test loss: 1.155, Test accuracy: 63.88
Round  52, Global train loss: 0.666, Global test loss: 1.517, Global test accuracy: 54.44
Round  53, Train loss: 0.742, Test loss: 1.195, Test accuracy: 62.70
Round  53, Global train loss: 0.742, Global test loss: 1.494, Global test accuracy: 53.68
Round  54, Train loss: 0.803, Test loss: 1.206, Test accuracy: 62.62
Round  54, Global train loss: 0.803, Global test loss: 1.631, Global test accuracy: 51.58
Round  55, Train loss: 0.698, Test loss: 1.218, Test accuracy: 62.76
Round  55, Global train loss: 0.698, Global test loss: 1.901, Global test accuracy: 46.72
Round  56, Train loss: 0.729, Test loss: 1.257, Test accuracy: 62.12
Round  56, Global train loss: 0.729, Global test loss: 1.936, Global test accuracy: 45.54
Round  57, Train loss: 0.584, Test loss: 1.294, Test accuracy: 62.28
Round  57, Global train loss: 0.584, Global test loss: 1.643, Global test accuracy: 53.54
Round  58, Train loss: 0.504, Test loss: 1.301, Test accuracy: 62.04
Round  58, Global train loss: 0.504, Global test loss: 1.760, Global test accuracy: 51.40
Round  59, Train loss: 0.695, Test loss: 1.325, Test accuracy: 61.94
Round  59, Global train loss: 0.695, Global test loss: 1.814, Global test accuracy: 48.76
Round  60, Train loss: 0.797, Test loss: 1.373, Test accuracy: 60.90
Round  60, Global train loss: 0.797, Global test loss: 1.867, Global test accuracy: 45.52
Round  61, Train loss: 0.515, Test loss: 1.360, Test accuracy: 61.86
Round  61, Global train loss: 0.515, Global test loss: 1.898, Global test accuracy: 48.88
Round  62, Train loss: 0.518, Test loss: 1.371, Test accuracy: 61.24
Round  62, Global train loss: 0.518, Global test loss: 1.639, Global test accuracy: 54.70
Round  63, Train loss: 0.534, Test loss: 1.375, Test accuracy: 60.72
Round  63, Global train loss: 0.534, Global test loss: 1.764, Global test accuracy: 52.58
Round  64, Train loss: 0.605, Test loss: 1.369, Test accuracy: 60.88
Round  64, Global train loss: 0.605, Global test loss: 1.907, Global test accuracy: 48.40
Round  65, Train loss: 0.593, Test loss: 1.385, Test accuracy: 61.46
Round  65, Global train loss: 0.593, Global test loss: 1.793, Global test accuracy: 51.52
Round  66, Train loss: 0.455, Test loss: 1.427, Test accuracy: 60.64
Round  66, Global train loss: 0.455, Global test loss: 1.725, Global test accuracy: 54.36
Round  67, Train loss: 0.489, Test loss: 1.445, Test accuracy: 61.00
Round  67, Global train loss: 0.489, Global test loss: 2.014, Global test accuracy: 49.34
Round  68, Train loss: 0.361, Test loss: 1.472, Test accuracy: 60.40
Round  68, Global train loss: 0.361, Global test loss: 1.876, Global test accuracy: 56.08
Round  69, Train loss: 0.379, Test loss: 1.502, Test accuracy: 60.54
Round  69, Global train loss: 0.379, Global test loss: 1.962, Global test accuracy: 53.64
Round  70, Train loss: 0.565, Test loss: 1.480, Test accuracy: 60.98
Round  70, Global train loss: 0.565, Global test loss: 2.124, Global test accuracy: 45.52
Round  71, Train loss: 0.580, Test loss: 1.486, Test accuracy: 60.94
Round  71, Global train loss: 0.580, Global test loss: 1.838, Global test accuracy: 47.74
Round  72, Train loss: 0.480, Test loss: 1.523, Test accuracy: 60.06
Round  72, Global train loss: 0.480, Global test loss: 1.850, Global test accuracy: 48.20
Round  73, Train loss: 0.713, Test loss: 1.563, Test accuracy: 59.54
Round  73, Global train loss: 0.713, Global test loss: 1.964, Global test accuracy: 46.94
Round  74, Train loss: 0.405, Test loss: 1.531, Test accuracy: 60.62
Round  74, Global train loss: 0.405, Global test loss: 1.792, Global test accuracy: 51.64
Round  75, Train loss: 0.260, Test loss: 1.619, Test accuracy: 59.64
Round  75, Global train loss: 0.260, Global test loss: 1.990, Global test accuracy: 55.78
Round  76, Train loss: 0.565, Test loss: 1.654, Test accuracy: 60.34
Round  76, Global train loss: 0.565, Global test loss: 1.842, Global test accuracy: 50.84
Round  77, Train loss: 0.537, Test loss: 1.658, Test accuracy: 60.00
Round  77, Global train loss: 0.537, Global test loss: 1.768, Global test accuracy: 53.12
Round  78, Train loss: 0.421, Test loss: 1.662, Test accuracy: 59.84
Round  78, Global train loss: 0.421, Global test loss: 1.852, Global test accuracy: 52.98
Round  79, Train loss: 0.477, Test loss: 1.661, Test accuracy: 59.30
Round  79, Global train loss: 0.477, Global test loss: 1.782, Global test accuracy: 53.14
Round  80, Train loss: 0.332, Test loss: 1.688, Test accuracy: 59.46
Round  80, Global train loss: 0.332, Global test loss: 1.902, Global test accuracy: 53.74
Round  81, Train loss: 0.486, Test loss: 1.670, Test accuracy: 59.88
Round  81, Global train loss: 0.486, Global test loss: 1.921, Global test accuracy: 52.32
Round  82, Train loss: 0.435, Test loss: 1.635, Test accuracy: 61.14
Round  82, Global train loss: 0.435, Global test loss: 2.060, Global test accuracy: 51.24
Round  83, Train loss: 0.312, Test loss: 1.685, Test accuracy: 60.30
Round  83, Global train loss: 0.312, Global test loss: 1.956, Global test accuracy: 52.10
Round  84, Train loss: 0.337, Test loss: 1.650, Test accuracy: 60.62
Round  84, Global train loss: 0.337, Global test loss: 1.909, Global test accuracy: 53.54
Round  85, Train loss: 0.344, Test loss: 1.629, Test accuracy: 60.80
Round  85, Global train loss: 0.344, Global test loss: 1.960, Global test accuracy: 51.26
Round  86, Train loss: 0.642, Test loss: 1.650, Test accuracy: 60.24
Round  86, Global train loss: 0.642, Global test loss: 2.010, Global test accuracy: 48.22
Round  87, Train loss: 0.423, Test loss: 1.621, Test accuracy: 60.88
Round  87, Global train loss: 0.423, Global test loss: 2.485, Global test accuracy: 42.60
Round  88, Train loss: 0.440, Test loss: 1.680, Test accuracy: 60.40
Round  88, Global train loss: 0.440, Global test loss: 2.175, Global test accuracy: 47.16
Round  89, Train loss: 0.258, Test loss: 1.688, Test accuracy: 60.04
Round  89, Global train loss: 0.258, Global test loss: 2.108, Global test accuracy: 52.22
Round  90, Train loss: 0.585, Test loss: 1.715, Test accuracy: 60.24
Round  90, Global train loss: 0.585, Global test loss: 2.293, Global test accuracy: 43.18
Round  91, Train loss: 0.396, Test loss: 1.683, Test accuracy: 61.28
Round  91, Global train loss: 0.396, Global test loss: 2.088, Global test accuracy: 49.52
Round  92, Train loss: 0.336, Test loss: 1.814, Test accuracy: 60.40
Round  92, Global train loss: 0.336, Global test loss: 2.339, Global test accuracy: 44.86
Round  93, Train loss: 0.403, Test loss: 1.773, Test accuracy: 60.92
Round  93, Global train loss: 0.403, Global test loss: 1.989, Global test accuracy: 51.94
Round  94, Train loss: 0.448, Test loss: 1.734, Test accuracy: 60.70
Round  94, Global train loss: 0.448, Global test loss: 2.143, Global test accuracy: 45.76
Round  95, Train loss: 0.321, Test loss: 1.786, Test accuracy: 60.62
Round  95, Global train loss: 0.321, Global test loss: 1.954, Global test accuracy: 54.60
Round  96, Train loss: 0.253, Test loss: 1.786, Test accuracy: 60.72
Round  96, Global train loss: 0.253, Global test loss: 2.185, Global test accuracy: 56.48
Round  97, Train loss: 0.296, Test loss: 1.800, Test accuracy: 61.00
Round  97, Global train loss: 0.296, Global test loss: 1.990, Global test accuracy: 53.64
Round  98, Train loss: 0.504, Test loss: 1.804, Test accuracy: 60.22
Round  98, Global train loss: 0.504, Global test loss: 2.320, Global test accuracy: 46.20
Round  99, Train loss: 0.378, Test loss: 1.822, Test accuracy: 60.60
Round  99, Global train loss: 0.378, Global test loss: 2.259, Global test accuracy: 49.74
Final Round, Train loss: 0.279, Test loss: 1.881, Test accuracy: 60.34
Final Round, Global train loss: 0.279, Global test loss: 2.259, Global test accuracy: 49.74
Average accuracy final 10 rounds: 60.67 

Average global accuracy final 10 rounds: 49.592 

808.4025022983551
[1.5398063659667969, 3.0796127319335938, 4.285526990890503, 5.491441249847412, 6.6577253341674805, 7.824009418487549, 8.91513729095459, 10.00626516342163, 11.164329290390015, 12.322393417358398, 13.511448383331299, 14.7005033493042, 15.876027584075928, 17.051551818847656, 18.254881143569946, 19.458210468292236, 20.545832872390747, 21.633455276489258, 22.687670707702637, 23.741886138916016, 24.830042123794556, 25.918198108673096, 27.000559091567993, 28.08292007446289, 29.216713428497314, 30.35050678253174, 31.557165384292603, 32.76382398605347, 33.931320667266846, 35.098817348480225, 36.19216871261597, 37.28552007675171, 38.358264207839966, 39.43100833892822, 40.5044732093811, 41.577938079833984, 42.657734870910645, 43.737531661987305, 44.97939109802246, 46.22125053405762, 47.471752882003784, 48.72225522994995, 49.87217378616333, 51.02209234237671, 52.19829344749451, 53.374494552612305, 54.58462905883789, 55.79476356506348, 57.23243165016174, 58.67009973526001, 59.85631442070007, 61.04252910614014, 62.22973132133484, 63.41693353652954, 64.62407684326172, 65.8312201499939, 66.99828004837036, 68.16533994674683, 69.38010692596436, 70.59487390518188, 71.70211219787598, 72.80935049057007, 73.90993928909302, 75.01052808761597, 76.1733009815216, 77.33607387542725, 78.57164883613586, 79.80722379684448, 80.92368507385254, 82.0401463508606, 83.22285556793213, 84.40556478500366, 85.6251630783081, 86.84476137161255, 88.02967095375061, 89.21458053588867, 90.47643423080444, 91.73828792572021, 92.93463730812073, 94.13098669052124, 95.22190499305725, 96.31282329559326, 97.3868682384491, 98.46091318130493, 99.53470468521118, 100.60849618911743, 101.68077945709229, 102.75306272506714, 103.83375024795532, 104.9144377708435, 105.99137139320374, 107.06830501556396, 108.14666509628296, 109.22502517700195, 110.30669164657593, 111.3883581161499, 112.47322964668274, 113.55810117721558, 114.64997625350952, 115.74185132980347, 116.82174134254456, 117.90163135528564, 118.99026989936829, 120.07890844345093, 121.15469574928284, 122.23048305511475, 123.33169150352478, 124.43289995193481, 125.68213868141174, 126.93137741088867, 128.10071063041687, 129.27004384994507, 130.42996883392334, 131.5898938179016, 132.7635850906372, 133.9372763633728, 135.12017798423767, 136.30307960510254, 137.4853539466858, 138.66762828826904, 139.84165120124817, 141.0156741142273, 142.18138074874878, 143.34708738327026, 144.5076150894165, 145.66814279556274, 146.84880661964417, 148.0294704437256, 149.20202732086182, 150.37458419799805, 151.59358167648315, 152.81257915496826, 153.97498559951782, 155.13739204406738, 156.32674288749695, 157.5160937309265, 158.7179663181305, 159.91983890533447, 161.0928990840912, 162.2659592628479, 163.44459533691406, 164.62323141098022, 165.8422498703003, 167.06126832962036, 168.38043308258057, 169.69959783554077, 170.96194314956665, 172.22428846359253, 173.49009346961975, 174.75589847564697, 176.00505256652832, 177.25420665740967, 178.49347615242004, 179.73274564743042, 181.05710005760193, 182.38145446777344, 183.67618918418884, 184.97092390060425, 186.2344970703125, 187.49807024002075, 188.7044379711151, 189.91080570220947, 191.1610085964203, 192.4112114906311, 193.7109010219574, 195.0105905532837, 196.26265168190002, 197.51471281051636, 198.8315305709839, 200.14834833145142, 201.3832561969757, 202.6181640625, 203.8835108280182, 205.14885759353638, 206.39747714996338, 207.64609670639038, 208.91178441047668, 210.177472114563, 211.43236780166626, 212.68726348876953, 213.9632604122162, 215.23925733566284, 216.49361562728882, 217.7479739189148, 219.01325464248657, 220.27853536605835, 221.53792095184326, 222.79730653762817, 224.04801607131958, 225.298725605011, 226.5515172481537, 227.8043088912964, 229.22990083694458, 230.65549278259277, 231.94671821594238, 233.237943649292, 234.50576901435852, 235.77359437942505, 237.03618502616882, 238.2987756729126, 240.857106924057, 243.41543817520142]
[13.48, 13.48, 34.32, 34.32, 38.26, 38.26, 40.98, 40.98, 44.8, 44.8, 47.8, 47.8, 51.56, 51.56, 54.16, 54.16, 57.94, 57.94, 57.96, 57.96, 59.68, 59.68, 63.86, 63.86, 64.14, 64.14, 65.14, 65.14, 64.42, 64.42, 63.84, 63.84, 63.86, 63.86, 64.22, 64.22, 66.5, 66.5, 66.66, 66.66, 67.0, 67.0, 66.42, 66.42, 66.08, 66.08, 65.18, 65.18, 66.4, 66.4, 66.46, 66.46, 67.16, 67.16, 67.4, 67.4, 66.8, 66.8, 65.5, 65.5, 65.24, 65.24, 65.8, 65.8, 67.22, 67.22, 66.48, 66.48, 64.9, 64.9, 65.76, 65.76, 65.56, 65.56, 64.78, 64.78, 64.14, 64.14, 65.56, 65.56, 65.84, 65.84, 66.12, 66.12, 65.22, 65.22, 64.66, 64.66, 63.72, 63.72, 61.42, 61.42, 62.52, 62.52, 61.9, 61.9, 61.74, 61.74, 62.4, 62.4, 63.94, 63.94, 63.6, 63.6, 63.88, 63.88, 62.7, 62.7, 62.62, 62.62, 62.76, 62.76, 62.12, 62.12, 62.28, 62.28, 62.04, 62.04, 61.94, 61.94, 60.9, 60.9, 61.86, 61.86, 61.24, 61.24, 60.72, 60.72, 60.88, 60.88, 61.46, 61.46, 60.64, 60.64, 61.0, 61.0, 60.4, 60.4, 60.54, 60.54, 60.98, 60.98, 60.94, 60.94, 60.06, 60.06, 59.54, 59.54, 60.62, 60.62, 59.64, 59.64, 60.34, 60.34, 60.0, 60.0, 59.84, 59.84, 59.3, 59.3, 59.46, 59.46, 59.88, 59.88, 61.14, 61.14, 60.3, 60.3, 60.62, 60.62, 60.8, 60.8, 60.24, 60.24, 60.88, 60.88, 60.4, 60.4, 60.04, 60.04, 60.24, 60.24, 61.28, 61.28, 60.4, 60.4, 60.92, 60.92, 60.7, 60.7, 60.62, 60.62, 60.72, 60.72, 61.0, 61.0, 60.22, 60.22, 60.6, 60.6, 60.34, 60.34]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.995, Test loss: 2.140, Test accuracy: 16.58
Round   0, Global train loss: 1.995, Global test loss: 2.292, Global test accuracy: 13.98
Round   1, Train loss: 1.854, Test loss: 1.831, Test accuracy: 33.52
Round   1, Global train loss: 1.854, Global test loss: 2.144, Global test accuracy: 26.08
Round   2, Train loss: 1.759, Test loss: 1.747, Test accuracy: 36.80
Round   2, Global train loss: 1.759, Global test loss: 2.076, Global test accuracy: 28.36
Round   3, Train loss: 1.717, Test loss: 1.668, Test accuracy: 39.70
Round   3, Global train loss: 1.717, Global test loss: 1.932, Global test accuracy: 29.72
Round   4, Train loss: 1.652, Test loss: 1.597, Test accuracy: 45.28
Round   4, Global train loss: 1.652, Global test loss: 1.927, Global test accuracy: 33.00
Round   5, Train loss: 1.739, Test loss: 1.580, Test accuracy: 45.44
Round   5, Global train loss: 1.739, Global test loss: 2.073, Global test accuracy: 26.84
Round   6, Train loss: 1.818, Test loss: 1.477, Test accuracy: 50.20
Round   6, Global train loss: 1.818, Global test loss: 1.931, Global test accuracy: 35.50
Round   7, Train loss: 1.611, Test loss: 1.350, Test accuracy: 56.04
Round   7, Global train loss: 1.611, Global test loss: 1.791, Global test accuracy: 40.36
Round   8, Train loss: 1.439, Test loss: 1.287, Test accuracy: 57.90
Round   8, Global train loss: 1.439, Global test loss: 1.715, Global test accuracy: 42.20
Round   9, Train loss: 1.799, Test loss: 1.307, Test accuracy: 56.98
Round   9, Global train loss: 1.799, Global test loss: 1.886, Global test accuracy: 34.18
Round  10, Train loss: 1.495, Test loss: 1.267, Test accuracy: 58.12
Round  10, Global train loss: 1.495, Global test loss: 1.793, Global test accuracy: 42.96
Round  11, Train loss: 1.576, Test loss: 1.209, Test accuracy: 62.08
Round  11, Global train loss: 1.576, Global test loss: 1.680, Global test accuracy: 46.86
Round  12, Train loss: 1.697, Test loss: 1.186, Test accuracy: 63.24
Round  12, Global train loss: 1.697, Global test loss: 1.840, Global test accuracy: 40.28
Round  13, Train loss: 1.555, Test loss: 1.161, Test accuracy: 63.28
Round  13, Global train loss: 1.555, Global test loss: 1.656, Global test accuracy: 47.78
Round  14, Train loss: 1.464, Test loss: 1.144, Test accuracy: 63.12
Round  14, Global train loss: 1.464, Global test loss: 1.626, Global test accuracy: 44.36
Round  15, Train loss: 1.639, Test loss: 1.132, Test accuracy: 62.92
Round  15, Global train loss: 1.639, Global test loss: 1.682, Global test accuracy: 48.56
Round  16, Train loss: 1.448, Test loss: 1.128, Test accuracy: 63.60
Round  16, Global train loss: 1.448, Global test loss: 1.627, Global test accuracy: 48.18
Round  17, Train loss: 1.364, Test loss: 1.146, Test accuracy: 62.52
Round  17, Global train loss: 1.364, Global test loss: 1.604, Global test accuracy: 48.04
Round  18, Train loss: 1.493, Test loss: 1.128, Test accuracy: 64.58
Round  18, Global train loss: 1.493, Global test loss: 1.518, Global test accuracy: 52.58
Round  19, Train loss: 1.579, Test loss: 1.097, Test accuracy: 65.16
Round  19, Global train loss: 1.579, Global test loss: 1.585, Global test accuracy: 52.50
Round  20, Train loss: 1.528, Test loss: 1.090, Test accuracy: 65.88
Round  20, Global train loss: 1.528, Global test loss: 1.660, Global test accuracy: 45.50
Round  21, Train loss: 1.335, Test loss: 1.098, Test accuracy: 65.50
Round  21, Global train loss: 1.335, Global test loss: 1.598, Global test accuracy: 46.96
Round  22, Train loss: 1.367, Test loss: 1.082, Test accuracy: 65.62
Round  22, Global train loss: 1.367, Global test loss: 1.558, Global test accuracy: 47.82
Round  23, Train loss: 1.601, Test loss: 1.043, Test accuracy: 66.10
Round  23, Global train loss: 1.601, Global test loss: 1.505, Global test accuracy: 54.14
Round  24, Train loss: 1.559, Test loss: 1.022, Test accuracy: 66.66
Round  24, Global train loss: 1.559, Global test loss: 1.689, Global test accuracy: 47.28
Round  25, Train loss: 1.423, Test loss: 1.053, Test accuracy: 66.22
Round  25, Global train loss: 1.423, Global test loss: 1.678, Global test accuracy: 47.60
Round  26, Train loss: 1.355, Test loss: 1.044, Test accuracy: 66.38
Round  26, Global train loss: 1.355, Global test loss: 1.505, Global test accuracy: 52.54
Round  27, Train loss: 1.266, Test loss: 0.989, Test accuracy: 67.74
Round  27, Global train loss: 1.266, Global test loss: 1.560, Global test accuracy: 50.50
Round  28, Train loss: 1.247, Test loss: 0.994, Test accuracy: 67.42
Round  28, Global train loss: 1.247, Global test loss: 1.547, Global test accuracy: 51.48
Round  29, Train loss: 1.409, Test loss: 1.019, Test accuracy: 66.24
Round  29, Global train loss: 1.409, Global test loss: 1.437, Global test accuracy: 55.64
Round  30, Train loss: 1.013, Test loss: 1.025, Test accuracy: 66.92
Round  30, Global train loss: 1.013, Global test loss: 1.527, Global test accuracy: 51.04
Round  31, Train loss: 0.826, Test loss: 1.030, Test accuracy: 65.94
Round  31, Global train loss: 0.826, Global test loss: 1.413, Global test accuracy: 54.84
Round  32, Train loss: 1.386, Test loss: 1.021, Test accuracy: 66.24
Round  32, Global train loss: 1.386, Global test loss: 1.455, Global test accuracy: 52.90
Round  33, Train loss: 1.311, Test loss: 1.026, Test accuracy: 66.06
Round  33, Global train loss: 1.311, Global test loss: 1.475, Global test accuracy: 51.94
Round  34, Train loss: 1.020, Test loss: 1.025, Test accuracy: 66.26
Round  34, Global train loss: 1.020, Global test loss: 1.414, Global test accuracy: 54.50
Round  35, Train loss: 0.956, Test loss: 1.023, Test accuracy: 66.82
Round  35, Global train loss: 0.956, Global test loss: 1.292, Global test accuracy: 59.06
Round  36, Train loss: 1.255, Test loss: 1.017, Test accuracy: 66.66
Round  36, Global train loss: 1.255, Global test loss: 1.385, Global test accuracy: 55.58
Round  37, Train loss: 1.137, Test loss: 1.000, Test accuracy: 67.78
Round  37, Global train loss: 1.137, Global test loss: 1.314, Global test accuracy: 59.88
Round  38, Train loss: 1.042, Test loss: 1.002, Test accuracy: 67.50
Round  38, Global train loss: 1.042, Global test loss: 1.443, Global test accuracy: 54.98
Round  39, Train loss: 1.124, Test loss: 0.999, Test accuracy: 67.04
Round  39, Global train loss: 1.124, Global test loss: 1.420, Global test accuracy: 54.30
Round  40, Train loss: 1.160, Test loss: 1.031, Test accuracy: 65.76
Round  40, Global train loss: 1.160, Global test loss: 1.476, Global test accuracy: 52.22
Round  41, Train loss: 1.064, Test loss: 1.045, Test accuracy: 64.94
Round  41, Global train loss: 1.064, Global test loss: 1.324, Global test accuracy: 58.04
Round  42, Train loss: 1.007, Test loss: 1.048, Test accuracy: 64.86
Round  42, Global train loss: 1.007, Global test loss: 1.381, Global test accuracy: 54.08
Round  43, Train loss: 0.940, Test loss: 1.044, Test accuracy: 64.94
Round  43, Global train loss: 0.940, Global test loss: 1.392, Global test accuracy: 54.18
Round  44, Train loss: 1.045, Test loss: 1.055, Test accuracy: 65.10
Round  44, Global train loss: 1.045, Global test loss: 1.327, Global test accuracy: 56.20
Round  45, Train loss: 1.236, Test loss: 1.042, Test accuracy: 65.42
Round  45, Global train loss: 1.236, Global test loss: 1.390, Global test accuracy: 56.06
Round  46, Train loss: 1.051, Test loss: 1.021, Test accuracy: 65.82
Round  46, Global train loss: 1.051, Global test loss: 1.407, Global test accuracy: 54.34
Round  47, Train loss: 0.981, Test loss: 1.040, Test accuracy: 65.32
Round  47, Global train loss: 0.981, Global test loss: 1.471, Global test accuracy: 54.00
Round  48, Train loss: 1.210, Test loss: 1.047, Test accuracy: 65.28
Round  48, Global train loss: 1.210, Global test loss: 1.483, Global test accuracy: 51.44
Round  49, Train loss: 0.776, Test loss: 1.019, Test accuracy: 66.24
Round  49, Global train loss: 0.776, Global test loss: 1.322, Global test accuracy: 59.16
Round  50, Train loss: 0.982, Test loss: 1.002, Test accuracy: 66.64
Round  50, Global train loss: 0.982, Global test loss: 1.477, Global test accuracy: 53.24
Round  51, Train loss: 1.146, Test loss: 1.047, Test accuracy: 65.06
Round  51, Global train loss: 1.146, Global test loss: 1.442, Global test accuracy: 52.90
Round  52, Train loss: 0.928, Test loss: 1.079, Test accuracy: 64.08
Round  52, Global train loss: 0.928, Global test loss: 1.509, Global test accuracy: 52.90
Round  53, Train loss: 0.928, Test loss: 1.092, Test accuracy: 64.08
Round  53, Global train loss: 0.928, Global test loss: 1.509, Global test accuracy: 52.34
Round  54, Train loss: 1.061, Test loss: 1.090, Test accuracy: 64.32
Round  54, Global train loss: 1.061, Global test loss: 1.529, Global test accuracy: 51.30
Round  55, Train loss: 0.814, Test loss: 1.103, Test accuracy: 63.78
Round  55, Global train loss: 0.814, Global test loss: 1.643, Global test accuracy: 49.32
Round  56, Train loss: 0.737, Test loss: 1.133, Test accuracy: 63.28
Round  56, Global train loss: 0.737, Global test loss: 1.539, Global test accuracy: 52.56
Round  57, Train loss: 0.872, Test loss: 1.140, Test accuracy: 62.80
Round  57, Global train loss: 0.872, Global test loss: 1.613, Global test accuracy: 53.00
Round  58, Train loss: 0.622, Test loss: 1.181, Test accuracy: 61.66
Round  58, Global train loss: 0.622, Global test loss: 1.648, Global test accuracy: 51.52
Round  59, Train loss: 0.801, Test loss: 1.209, Test accuracy: 61.80
Round  59, Global train loss: 0.801, Global test loss: 1.850, Global test accuracy: 49.28
Round  60, Train loss: 0.684, Test loss: 1.223, Test accuracy: 62.12
Round  60, Global train loss: 0.684, Global test loss: 1.481, Global test accuracy: 54.54
Round  61, Train loss: 0.677, Test loss: 1.262, Test accuracy: 61.64
Round  61, Global train loss: 0.677, Global test loss: 1.728, Global test accuracy: 46.74
Round  62, Train loss: 0.766, Test loss: 1.234, Test accuracy: 61.78
Round  62, Global train loss: 0.766, Global test loss: 1.720, Global test accuracy: 49.52
Round  63, Train loss: 0.758, Test loss: 1.274, Test accuracy: 61.24
Round  63, Global train loss: 0.758, Global test loss: 1.562, Global test accuracy: 53.58
Round  64, Train loss: 0.721, Test loss: 1.256, Test accuracy: 62.02
Round  64, Global train loss: 0.721, Global test loss: 1.619, Global test accuracy: 51.88
Round  65, Train loss: 0.858, Test loss: 1.243, Test accuracy: 62.78
Round  65, Global train loss: 0.858, Global test loss: 1.660, Global test accuracy: 49.62
Round  66, Train loss: 0.619, Test loss: 1.272, Test accuracy: 62.06
Round  66, Global train loss: 0.619, Global test loss: 1.698, Global test accuracy: 53.50
Round  67, Train loss: 0.625, Test loss: 1.264, Test accuracy: 62.34
Round  67, Global train loss: 0.625, Global test loss: 1.668, Global test accuracy: 51.48
Round  68, Train loss: 0.689, Test loss: 1.296, Test accuracy: 61.54
Round  68, Global train loss: 0.689, Global test loss: 1.828, Global test accuracy: 50.20
Round  69, Train loss: 0.591, Test loss: 1.296, Test accuracy: 62.20
Round  69, Global train loss: 0.591, Global test loss: 1.768, Global test accuracy: 51.30
Round  70, Train loss: 0.666, Test loss: 1.324, Test accuracy: 61.72
Round  70, Global train loss: 0.666, Global test loss: 1.873, Global test accuracy: 50.08
Round  71, Train loss: 0.646, Test loss: 1.381, Test accuracy: 61.36
Round  71, Global train loss: 0.646, Global test loss: 1.787, Global test accuracy: 49.92
Round  72, Train loss: 0.693, Test loss: 1.361, Test accuracy: 61.34
Round  72, Global train loss: 0.693, Global test loss: 1.862, Global test accuracy: 46.80
Round  73, Train loss: 0.624, Test loss: 1.366, Test accuracy: 60.98
Round  73, Global train loss: 0.624, Global test loss: 1.792, Global test accuracy: 52.00
Round  74, Train loss: 0.654, Test loss: 1.381, Test accuracy: 61.02
Round  74, Global train loss: 0.654, Global test loss: 1.786, Global test accuracy: 49.50
Round  75, Train loss: 0.471, Test loss: 1.378, Test accuracy: 61.80
Round  75, Global train loss: 0.471, Global test loss: 1.981, Global test accuracy: 54.20
Round  76, Train loss: 0.606, Test loss: 1.382, Test accuracy: 61.64
Round  76, Global train loss: 0.606, Global test loss: 1.684, Global test accuracy: 53.44
Round  77, Train loss: 0.584, Test loss: 1.402, Test accuracy: 61.24
Round  77, Global train loss: 0.584, Global test loss: 1.655, Global test accuracy: 55.78
Round  78, Train loss: 0.474, Test loss: 1.422, Test accuracy: 60.82
Round  78, Global train loss: 0.474, Global test loss: 1.714, Global test accuracy: 53.56
Round  79, Train loss: 0.698, Test loss: 1.446, Test accuracy: 60.16
Round  79, Global train loss: 0.698, Global test loss: 1.853, Global test accuracy: 49.56
Round  80, Train loss: 0.482, Test loss: 1.481, Test accuracy: 60.54
Round  80, Global train loss: 0.482, Global test loss: 1.971, Global test accuracy: 52.84
Round  81, Train loss: 0.535, Test loss: 1.493, Test accuracy: 60.96
Round  81, Global train loss: 0.535, Global test loss: 1.888, Global test accuracy: 52.64
Round  82, Train loss: 0.461, Test loss: 1.564, Test accuracy: 60.34
Round  82, Global train loss: 0.461, Global test loss: 2.087, Global test accuracy: 50.48
Round  83, Train loss: 0.502, Test loss: 1.576, Test accuracy: 59.30
Round  83, Global train loss: 0.502, Global test loss: 2.015, Global test accuracy: 48.54
Round  84, Train loss: 0.536, Test loss: 1.542, Test accuracy: 60.06
Round  84, Global train loss: 0.536, Global test loss: 2.106, Global test accuracy: 48.38
Round  85, Train loss: 0.487, Test loss: 1.590, Test accuracy: 60.38
Round  85, Global train loss: 0.487, Global test loss: 2.108, Global test accuracy: 47.18
Round  86, Train loss: 0.560, Test loss: 1.582, Test accuracy: 61.00
Round  86, Global train loss: 0.560, Global test loss: 2.008, Global test accuracy: 49.54
Round  87, Train loss: 0.470, Test loss: 1.612, Test accuracy: 60.12
Round  87, Global train loss: 0.470, Global test loss: 2.203, Global test accuracy: 47.56
Round  88, Train loss: 0.429, Test loss: 1.594, Test accuracy: 60.86
Round  88, Global train loss: 0.429, Global test loss: 2.097, Global test accuracy: 51.34
Round  89, Train loss: 0.478, Test loss: 1.613, Test accuracy: 60.32
Round  89, Global train loss: 0.478, Global test loss: 2.172, Global test accuracy: 45.64
Round  90, Train loss: 0.489, Test loss: 1.656, Test accuracy: 60.22
Round  90, Global train loss: 0.489, Global test loss: 2.138, Global test accuracy: 50.12
Round  91, Train loss: 0.464, Test loss: 1.684, Test accuracy: 59.56
Round  91, Global train loss: 0.464, Global test loss: 2.109, Global test accuracy: 48.22
Round  92, Train loss: 0.435, Test loss: 1.672, Test accuracy: 60.10
Round  92, Global train loss: 0.435, Global test loss: 2.102, Global test accuracy: 49.60
Round  93, Train loss: 0.479, Test loss: 1.654, Test accuracy: 60.56
Round  93, Global train loss: 0.479, Global test loss: 2.064, Global test accuracy: 50.66/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.484, Test loss: 1.717, Test accuracy: 59.48
Round  94, Global train loss: 0.484, Global test loss: 2.128, Global test accuracy: 46.60
Round  95, Train loss: 0.461, Test loss: 1.753, Test accuracy: 59.40
Round  95, Global train loss: 0.461, Global test loss: 2.077, Global test accuracy: 51.16
Round  96, Train loss: 0.323, Test loss: 1.721, Test accuracy: 59.78
Round  96, Global train loss: 0.323, Global test loss: 2.171, Global test accuracy: 51.94
Round  97, Train loss: 0.402, Test loss: 1.719, Test accuracy: 59.56
Round  97, Global train loss: 0.402, Global test loss: 2.102, Global test accuracy: 51.06
Round  98, Train loss: 0.449, Test loss: 1.765, Test accuracy: 59.18
Round  98, Global train loss: 0.449, Global test loss: 2.071, Global test accuracy: 50.28
Round  99, Train loss: 0.428, Test loss: 1.779, Test accuracy: 59.30
Round  99, Global train loss: 0.428, Global test loss: 2.372, Global test accuracy: 50.06
Final Round, Train loss: 0.314, Test loss: 1.843, Test accuracy: 59.90
Final Round, Global train loss: 0.314, Global test loss: 2.372, Global test accuracy: 50.06
Average accuracy final 10 rounds: 59.714000000000006 

Average global accuracy final 10 rounds: 49.97 

873.6810877323151
[1.4754393100738525, 2.950878620147705, 4.151788234710693, 5.352697849273682, 6.539229393005371, 7.7257609367370605, 8.90510368347168, 10.084446430206299, 11.260819673538208, 12.437192916870117, 13.661062002182007, 14.884931087493896, 16.256305694580078, 17.62768030166626, 18.90094017982483, 20.1742000579834, 21.478745937347412, 22.783291816711426, 24.06020426750183, 25.337116718292236, 26.638027906417847, 27.938939094543457, 29.144055128097534, 30.34917116165161, 31.537676334381104, 32.726181507110596, 33.89861226081848, 35.07104301452637, 36.24296832084656, 37.41489362716675, 38.59948396682739, 39.78407430648804, 40.97926568984985, 42.17445707321167, 43.356834173202515, 44.53921127319336, 45.716065883636475, 46.89292049407959, 48.081586599349976, 49.27025270462036, 50.56493258476257, 51.859612464904785, 53.03115367889404, 54.2026948928833, 55.3882372379303, 56.573779582977295, 57.75217366218567, 58.93056774139404, 60.09065914154053, 61.25075054168701, 62.42541193962097, 63.60007333755493, 64.76856923103333, 65.93706512451172, 67.12636160850525, 68.31565809249878, 69.48880958557129, 70.6619610786438, 71.83915734291077, 73.01635360717773, 74.18143820762634, 75.34652280807495, 76.54453587532043, 77.74254894256592, 78.91627240180969, 80.08999586105347, 81.25874900817871, 82.42750215530396, 83.63342928886414, 84.83935642242432, 86.05824279785156, 87.27712917327881, 88.48065757751465, 89.68418598175049, 90.86607694625854, 92.0479679107666, 93.2525589466095, 94.45714998245239, 95.64786124229431, 96.83857250213623, 98.01550650596619, 99.19244050979614, 100.3818941116333, 101.57134771347046, 102.90776205062866, 104.24417638778687, 105.5526864528656, 106.86119651794434, 108.16638398170471, 109.47157144546509, 110.75147652626038, 112.03138160705566, 113.3993890285492, 114.76739645004272, 116.21653747558594, 117.66567850112915, 119.12555766105652, 120.58543682098389, 122.02500343322754, 123.46457004547119, 124.91538906097412, 126.36620807647705, 127.7224805355072, 129.07875299453735, 130.4353289604187, 131.79190492630005, 133.0597493648529, 134.32759380340576, 135.62885689735413, 136.9301199913025, 138.2608494758606, 139.5915789604187, 140.98394417762756, 142.37630939483643, 143.73998856544495, 145.10366773605347, 146.4343626499176, 147.76505756378174, 149.103746175766, 150.44243478775024, 151.751779794693, 153.06112480163574, 154.4211940765381, 155.78126335144043, 157.00263667106628, 158.22400999069214, 159.50992894172668, 160.79584789276123, 162.1966254711151, 163.597403049469, 165.07012176513672, 166.54284048080444, 167.86356663703918, 169.18429279327393, 170.5009002685547, 171.81750774383545, 173.14973640441895, 174.48196506500244, 175.82752084732056, 177.17307662963867, 178.53346824645996, 179.89385986328125, 181.26217555999756, 182.63049125671387, 183.95949125289917, 185.28849124908447, 186.59876322746277, 187.90903520584106, 189.31440830230713, 190.7197813987732, 192.03105354309082, 193.34232568740845, 194.6416139602661, 195.94090223312378, 197.40604043006897, 198.87117862701416, 200.2243092060089, 201.57743978500366, 202.9227855205536, 204.26813125610352, 205.56506752967834, 206.86200380325317, 208.18039345741272, 209.49878311157227, 210.84530758857727, 212.19183206558228, 213.55790615081787, 214.92398023605347, 216.43749141693115, 217.95100259780884, 219.64137291908264, 221.33174324035645, 223.10639667510986, 224.88105010986328, 226.7727611064911, 228.6644721031189, 230.36661314964294, 232.068754196167, 233.74348950386047, 235.41822481155396, 237.07078504562378, 238.7233452796936, 240.40058708190918, 242.07782888412476, 243.8277087211609, 245.57758855819702, 247.2913463115692, 249.0051040649414, 250.61134219169617, 252.21758031845093, 253.83967304229736, 255.4617657661438, 257.10741996765137, 258.75307416915894, 260.40694856643677, 262.0608229637146, 263.68176341056824, 265.3027038574219, 266.986784696579, 268.6708655357361, 272.36669397354126, 276.06252241134644]
[16.58, 16.58, 33.52, 33.52, 36.8, 36.8, 39.7, 39.7, 45.28, 45.28, 45.44, 45.44, 50.2, 50.2, 56.04, 56.04, 57.9, 57.9, 56.98, 56.98, 58.12, 58.12, 62.08, 62.08, 63.24, 63.24, 63.28, 63.28, 63.12, 63.12, 62.92, 62.92, 63.6, 63.6, 62.52, 62.52, 64.58, 64.58, 65.16, 65.16, 65.88, 65.88, 65.5, 65.5, 65.62, 65.62, 66.1, 66.1, 66.66, 66.66, 66.22, 66.22, 66.38, 66.38, 67.74, 67.74, 67.42, 67.42, 66.24, 66.24, 66.92, 66.92, 65.94, 65.94, 66.24, 66.24, 66.06, 66.06, 66.26, 66.26, 66.82, 66.82, 66.66, 66.66, 67.78, 67.78, 67.5, 67.5, 67.04, 67.04, 65.76, 65.76, 64.94, 64.94, 64.86, 64.86, 64.94, 64.94, 65.1, 65.1, 65.42, 65.42, 65.82, 65.82, 65.32, 65.32, 65.28, 65.28, 66.24, 66.24, 66.64, 66.64, 65.06, 65.06, 64.08, 64.08, 64.08, 64.08, 64.32, 64.32, 63.78, 63.78, 63.28, 63.28, 62.8, 62.8, 61.66, 61.66, 61.8, 61.8, 62.12, 62.12, 61.64, 61.64, 61.78, 61.78, 61.24, 61.24, 62.02, 62.02, 62.78, 62.78, 62.06, 62.06, 62.34, 62.34, 61.54, 61.54, 62.2, 62.2, 61.72, 61.72, 61.36, 61.36, 61.34, 61.34, 60.98, 60.98, 61.02, 61.02, 61.8, 61.8, 61.64, 61.64, 61.24, 61.24, 60.82, 60.82, 60.16, 60.16, 60.54, 60.54, 60.96, 60.96, 60.34, 60.34, 59.3, 59.3, 60.06, 60.06, 60.38, 60.38, 61.0, 61.0, 60.12, 60.12, 60.86, 60.86, 60.32, 60.32, 60.22, 60.22, 59.56, 59.56, 60.1, 60.1, 60.56, 60.56, 59.48, 59.48, 59.4, 59.4, 59.78, 59.78, 59.56, 59.56, 59.18, 59.18, 59.3, 59.3, 59.9, 59.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.963, Test loss: 2.158, Test accuracy: 16.68
Round   0, Global train loss: 1.963, Global test loss: 2.304, Global test accuracy: 13.90
Round   1, Train loss: 1.898, Test loss: 1.902, Test accuracy: 32.68
Round   1, Global train loss: 1.898, Global test loss: 2.211, Global test accuracy: 26.02
Round   2, Train loss: 1.771, Test loss: 1.735, Test accuracy: 36.36
Round   2, Global train loss: 1.771, Global test loss: 2.060, Global test accuracy: 28.52
Round   3, Train loss: 1.788, Test loss: 1.730, Test accuracy: 37.56
Round   3, Global train loss: 1.788, Global test loss: 2.026, Global test accuracy: 31.46
Round   4, Train loss: 1.848, Test loss: 1.695, Test accuracy: 41.10
Round   4, Global train loss: 1.848, Global test loss: 2.099, Global test accuracy: 32.70
Round   5, Train loss: 1.704, Test loss: 1.670, Test accuracy: 40.48
Round   5, Global train loss: 1.704, Global test loss: 2.300, Global test accuracy: 17.42
Round   6, Train loss: 1.730, Test loss: 1.572, Test accuracy: 42.82
Round   6, Global train loss: 1.730, Global test loss: 2.065, Global test accuracy: 24.04
Round   7, Train loss: 1.630, Test loss: 1.398, Test accuracy: 49.20
Round   7, Global train loss: 1.630, Global test loss: 1.811, Global test accuracy: 38.02
Round   8, Train loss: 1.762, Test loss: 1.372, Test accuracy: 52.02
Round   8, Global train loss: 1.762, Global test loss: 1.940, Global test accuracy: 34.34
Round   9, Train loss: 1.655, Test loss: 1.387, Test accuracy: 51.14
Round   9, Global train loss: 1.655, Global test loss: 1.964, Global test accuracy: 34.76
Round  10, Train loss: 1.578, Test loss: 1.345, Test accuracy: 51.70
Round  10, Global train loss: 1.578, Global test loss: 1.823, Global test accuracy: 40.70
Round  11, Train loss: 1.662, Test loss: 1.303, Test accuracy: 54.96
Round  11, Global train loss: 1.662, Global test loss: 1.796, Global test accuracy: 47.24
Round  12, Train loss: 1.480, Test loss: 1.303, Test accuracy: 54.94
Round  12, Global train loss: 1.480, Global test loss: 1.694, Global test accuracy: 43.30
Round  13, Train loss: 1.634, Test loss: 1.287, Test accuracy: 54.76
Round  13, Global train loss: 1.634, Global test loss: 1.756, Global test accuracy: 44.52
Round  14, Train loss: 1.498, Test loss: 1.279, Test accuracy: 55.66
Round  14, Global train loss: 1.498, Global test loss: 1.740, Global test accuracy: 39.80
Round  15, Train loss: 1.486, Test loss: 1.261, Test accuracy: 57.60
Round  15, Global train loss: 1.486, Global test loss: 1.710, Global test accuracy: 45.40
Round  16, Train loss: 1.671, Test loss: 1.249, Test accuracy: 59.72
Round  16, Global train loss: 1.671, Global test loss: 1.819, Global test accuracy: 42.18
Round  17, Train loss: 1.524, Test loss: 1.252, Test accuracy: 59.72
Round  17, Global train loss: 1.524, Global test loss: 1.727, Global test accuracy: 46.08
Round  18, Train loss: 1.521, Test loss: 1.228, Test accuracy: 61.42
Round  18, Global train loss: 1.521, Global test loss: 1.649, Global test accuracy: 48.56
Round  19, Train loss: 1.655, Test loss: 1.207, Test accuracy: 61.66
Round  19, Global train loss: 1.655, Global test loss: 1.838, Global test accuracy: 35.48
Round  20, Train loss: 1.557, Test loss: 1.212, Test accuracy: 62.62
Round  20, Global train loss: 1.557, Global test loss: 1.821, Global test accuracy: 40.16
Round  21, Train loss: 1.355, Test loss: 1.167, Test accuracy: 63.52
Round  21, Global train loss: 1.355, Global test loss: 1.743, Global test accuracy: 44.24
Round  22, Train loss: 1.311, Test loss: 1.167, Test accuracy: 63.12
Round  22, Global train loss: 1.311, Global test loss: 1.620, Global test accuracy: 47.28
Round  23, Train loss: 1.517, Test loss: 1.166, Test accuracy: 62.62
Round  23, Global train loss: 1.517, Global test loss: 1.650, Global test accuracy: 50.02
Round  24, Train loss: 1.217, Test loss: 1.139, Test accuracy: 63.66
Round  24, Global train loss: 1.217, Global test loss: 1.590, Global test accuracy: 47.38
Round  25, Train loss: 1.285, Test loss: 1.144, Test accuracy: 63.84
Round  25, Global train loss: 1.285, Global test loss: 1.571, Global test accuracy: 49.30
Round  26, Train loss: 1.418, Test loss: 1.152, Test accuracy: 63.16
Round  26, Global train loss: 1.418, Global test loss: 1.528, Global test accuracy: 51.64
Round  27, Train loss: 1.517, Test loss: 1.131, Test accuracy: 63.12
Round  27, Global train loss: 1.517, Global test loss: 1.822, Global test accuracy: 42.82
Round  28, Train loss: 1.068, Test loss: 1.129, Test accuracy: 63.40
Round  28, Global train loss: 1.068, Global test loss: 1.427, Global test accuracy: 53.66
Round  29, Train loss: 1.346, Test loss: 1.139, Test accuracy: 63.24
Round  29, Global train loss: 1.346, Global test loss: 1.562, Global test accuracy: 50.66
Round  30, Train loss: 1.110, Test loss: 1.119, Test accuracy: 63.26
Round  30, Global train loss: 1.110, Global test loss: 1.551, Global test accuracy: 49.00
Round  31, Train loss: 1.263, Test loss: 1.111, Test accuracy: 63.52
Round  31, Global train loss: 1.263, Global test loss: 1.558, Global test accuracy: 50.90
Round  32, Train loss: 1.219, Test loss: 1.135, Test accuracy: 62.90
Round  32, Global train loss: 1.219, Global test loss: 1.493, Global test accuracy: 53.78
Round  33, Train loss: 1.347, Test loss: 1.132, Test accuracy: 63.04
Round  33, Global train loss: 1.347, Global test loss: 1.597, Global test accuracy: 48.68
Round  34, Train loss: 1.235, Test loss: 1.111, Test accuracy: 64.00
Round  34, Global train loss: 1.235, Global test loss: 1.497, Global test accuracy: 52.86
Round  35, Train loss: 1.047, Test loss: 1.120, Test accuracy: 63.84
Round  35, Global train loss: 1.047, Global test loss: 1.334, Global test accuracy: 58.60
Round  36, Train loss: 1.288, Test loss: 1.102, Test accuracy: 63.76
Round  36, Global train loss: 1.288, Global test loss: 1.663, Global test accuracy: 46.20
Round  37, Train loss: 1.460, Test loss: 1.116, Test accuracy: 63.90
Round  37, Global train loss: 1.460, Global test loss: 1.717, Global test accuracy: 44.94
Round  38, Train loss: 1.317, Test loss: 1.127, Test accuracy: 62.80
Round  38, Global train loss: 1.317, Global test loss: 1.849, Global test accuracy: 40.02
Round  39, Train loss: 1.168, Test loss: 1.127, Test accuracy: 62.36
Round  39, Global train loss: 1.168, Global test loss: 1.592, Global test accuracy: 49.30
Round  40, Train loss: 1.046, Test loss: 1.130, Test accuracy: 62.24
Round  40, Global train loss: 1.046, Global test loss: 1.484, Global test accuracy: 54.30
Round  41, Train loss: 1.187, Test loss: 1.111, Test accuracy: 63.08
Round  41, Global train loss: 1.187, Global test loss: 1.501, Global test accuracy: 51.94
Round  42, Train loss: 1.087, Test loss: 1.097, Test accuracy: 63.10
Round  42, Global train loss: 1.087, Global test loss: 1.515, Global test accuracy: 51.92
Round  43, Train loss: 1.005, Test loss: 1.125, Test accuracy: 62.12
Round  43, Global train loss: 1.005, Global test loss: 1.599, Global test accuracy: 48.94
Round  44, Train loss: 0.992, Test loss: 1.135, Test accuracy: 62.24
Round  44, Global train loss: 0.992, Global test loss: 1.426, Global test accuracy: 55.38
Round  45, Train loss: 1.154, Test loss: 1.141, Test accuracy: 61.72
Round  45, Global train loss: 1.154, Global test loss: 1.542, Global test accuracy: 51.46
Round  46, Train loss: 1.043, Test loss: 1.155, Test accuracy: 61.78
Round  46, Global train loss: 1.043, Global test loss: 1.525, Global test accuracy: 54.16
Round  47, Train loss: 0.969, Test loss: 1.139, Test accuracy: 62.36
Round  47, Global train loss: 0.969, Global test loss: 1.578, Global test accuracy: 55.10
Round  48, Train loss: 0.974, Test loss: 1.183, Test accuracy: 61.04
Round  48, Global train loss: 0.974, Global test loss: 1.460, Global test accuracy: 55.42
Round  49, Train loss: 0.861, Test loss: 1.182, Test accuracy: 61.36
Round  49, Global train loss: 0.861, Global test loss: 1.401, Global test accuracy: 57.36
Round  50, Train loss: 1.055, Test loss: 1.201, Test accuracy: 60.84
Round  50, Global train loss: 1.055, Global test loss: 1.618, Global test accuracy: 49.94
Round  51, Train loss: 1.021, Test loss: 1.214, Test accuracy: 60.54
Round  51, Global train loss: 1.021, Global test loss: 1.732, Global test accuracy: 44.26
Round  52, Train loss: 0.920, Test loss: 1.231, Test accuracy: 61.04
Round  52, Global train loss: 0.920, Global test loss: 1.595, Global test accuracy: 51.16
Round  53, Train loss: 0.933, Test loss: 1.252, Test accuracy: 60.44
Round  53, Global train loss: 0.933, Global test loss: 1.613, Global test accuracy: 49.90
Round  54, Train loss: 0.950, Test loss: 1.258, Test accuracy: 59.70
Round  54, Global train loss: 0.950, Global test loss: 1.739, Global test accuracy: 45.80
Round  55, Train loss: 1.020, Test loss: 1.268, Test accuracy: 59.48
Round  55, Global train loss: 1.020, Global test loss: 1.842, Global test accuracy: 42.36
Round  56, Train loss: 0.965, Test loss: 1.327, Test accuracy: 58.10
Round  56, Global train loss: 0.965, Global test loss: 1.897, Global test accuracy: 43.78
Round  57, Train loss: 0.873, Test loss: 1.367, Test accuracy: 57.78
Round  57, Global train loss: 0.873, Global test loss: 1.878, Global test accuracy: 46.46
Round  58, Train loss: 0.885, Test loss: 1.345, Test accuracy: 58.60
Round  58, Global train loss: 0.885, Global test loss: 1.910, Global test accuracy: 43.06
Round  59, Train loss: 0.786, Test loss: 1.360, Test accuracy: 58.72
Round  59, Global train loss: 0.786, Global test loss: 1.992, Global test accuracy: 42.52
Round  60, Train loss: 0.768, Test loss: 1.395, Test accuracy: 57.34
Round  60, Global train loss: 0.768, Global test loss: 1.701, Global test accuracy: 47.80
Round  61, Train loss: 0.781, Test loss: 1.408, Test accuracy: 57.20
Round  61, Global train loss: 0.781, Global test loss: 2.004, Global test accuracy: 41.36
Round  62, Train loss: 0.741, Test loss: 1.411, Test accuracy: 57.12
Round  62, Global train loss: 0.741, Global test loss: 1.834, Global test accuracy: 48.02
Round  63, Train loss: 0.796, Test loss: 1.404, Test accuracy: 57.80
Round  63, Global train loss: 0.796, Global test loss: 1.855, Global test accuracy: 47.84
Round  64, Train loss: 0.672, Test loss: 1.385, Test accuracy: 58.62
Round  64, Global train loss: 0.672, Global test loss: 1.917, Global test accuracy: 46.74
Round  65, Train loss: 0.755, Test loss: 1.435, Test accuracy: 58.04
Round  65, Global train loss: 0.755, Global test loss: 1.740, Global test accuracy: 49.50
Round  66, Train loss: 0.679, Test loss: 1.446, Test accuracy: 57.34
Round  66, Global train loss: 0.679, Global test loss: 1.896, Global test accuracy: 45.98
Round  67, Train loss: 0.747, Test loss: 1.390, Test accuracy: 58.28
Round  67, Global train loss: 0.747, Global test loss: 2.074, Global test accuracy: 43.44
Round  68, Train loss: 0.596, Test loss: 1.434, Test accuracy: 58.16
Round  68, Global train loss: 0.596, Global test loss: 2.007, Global test accuracy: 49.46
Round  69, Train loss: 0.629, Test loss: 1.474, Test accuracy: 57.48
Round  69, Global train loss: 0.629, Global test loss: 2.003, Global test accuracy: 46.96
Round  70, Train loss: 0.685, Test loss: 1.503, Test accuracy: 57.24
Round  70, Global train loss: 0.685, Global test loss: 2.199, Global test accuracy: 40.16
Round  71, Train loss: 0.635, Test loss: 1.563, Test accuracy: 56.98
Round  71, Global train loss: 0.635, Global test loss: 1.971, Global test accuracy: 45.04
Round  72, Train loss: 0.584, Test loss: 1.618, Test accuracy: 56.82
Round  72, Global train loss: 0.584, Global test loss: 2.178, Global test accuracy: 44.02
Round  73, Train loss: 0.614, Test loss: 1.608, Test accuracy: 57.56
Round  73, Global train loss: 0.614, Global test loss: 2.061, Global test accuracy: 48.52
Round  74, Train loss: 0.536, Test loss: 1.557, Test accuracy: 57.80
Round  74, Global train loss: 0.536, Global test loss: 1.992, Global test accuracy: 48.64
Round  75, Train loss: 0.556, Test loss: 1.554, Test accuracy: 58.32
Round  75, Global train loss: 0.556, Global test loss: 2.124, Global test accuracy: 47.42
Round  76, Train loss: 0.536, Test loss: 1.549, Test accuracy: 57.78
Round  76, Global train loss: 0.536, Global test loss: 1.750, Global test accuracy: 51.48
Round  77, Train loss: 0.512, Test loss: 1.637, Test accuracy: 57.40
Round  77, Global train loss: 0.512, Global test loss: 1.848, Global test accuracy: 50.56
Round  78, Train loss: 0.578, Test loss: 1.696, Test accuracy: 57.26
Round  78, Global train loss: 0.578, Global test loss: 2.179, Global test accuracy: 43.36
Round  79, Train loss: 0.487, Test loss: 1.726, Test accuracy: 56.74
Round  79, Global train loss: 0.487, Global test loss: 1.992, Global test accuracy: 48.54
Round  80, Train loss: 0.495, Test loss: 1.687, Test accuracy: 57.04
Round  80, Global train loss: 0.495, Global test loss: 2.039, Global test accuracy: 48.06
Round  81, Train loss: 0.442, Test loss: 1.731, Test accuracy: 56.48
Round  81, Global train loss: 0.442, Global test loss: 2.021, Global test accuracy: 49.00
Round  82, Train loss: 0.613, Test loss: 1.738, Test accuracy: 56.44
Round  82, Global train loss: 0.613, Global test loss: 2.263, Global test accuracy: 43.80
Round  83, Train loss: 0.408, Test loss: 1.751, Test accuracy: 56.46
Round  83, Global train loss: 0.408, Global test loss: 2.254, Global test accuracy: 44.02
Round  84, Train loss: 0.410, Test loss: 1.778, Test accuracy: 56.22
Round  84, Global train loss: 0.410, Global test loss: 2.285, Global test accuracy: 47.62
Round  85, Train loss: 0.401, Test loss: 1.781, Test accuracy: 56.60
Round  85, Global train loss: 0.401, Global test loss: 2.377, Global test accuracy: 44.94
Round  86, Train loss: 0.469, Test loss: 1.760, Test accuracy: 57.60
Round  86, Global train loss: 0.469, Global test loss: 2.284, Global test accuracy: 49.48
Round  87, Train loss: 0.507, Test loss: 1.768, Test accuracy: 56.58
Round  87, Global train loss: 0.507, Global test loss: 2.474, Global test accuracy: 40.00
Round  88, Train loss: 0.379, Test loss: 1.767, Test accuracy: 57.26
Round  88, Global train loss: 0.379, Global test loss: 2.305, Global test accuracy: 45.90
Round  89, Train loss: 0.345, Test loss: 1.726, Test accuracy: 57.60
Round  89, Global train loss: 0.345, Global test loss: 2.281, Global test accuracy: 48.10
Round  90, Train loss: 0.418, Test loss: 1.792, Test accuracy: 56.66
Round  90, Global train loss: 0.418, Global test loss: 2.257, Global test accuracy: 48.18
Round  91, Train loss: 0.465, Test loss: 1.806, Test accuracy: 56.12
Round  91, Global train loss: 0.465, Global test loss: 2.421, Global test accuracy: 42.86
Round  92, Train loss: 0.421, Test loss: 1.798, Test accuracy: 56.66
Round  92, Global train loss: 0.421, Global test loss: 2.282, Global test accuracy: 42.82
Round  93, Train loss: 0.336, Test loss: 1.798, Test accuracy: 57.00
Round  93, Global train loss: 0.336, Global test loss: 2.028, Global test accuracy: 51.10
Round  94, Train loss: 0.399, Test loss: 1.770, Test accuracy: 58.08
Round  94, Global train loss: 0.399, Global test loss: 2.146, Global test accuracy: 45.40
Round  95, Train loss: 0.452, Test loss: 1.776, Test accuracy: 57.94
Round  95, Global train loss: 0.452, Global test loss: 2.162, Global test accuracy: 48.60
Round  96, Train loss: 0.423, Test loss: 1.821, Test accuracy: 57.92
Round  96, Global train loss: 0.423, Global test loss: 2.290, Global test accuracy: 49.86
Round  97, Train loss: 0.334, Test loss: 1.854, Test accuracy: 57.40
Round  97, Global train loss: 0.334, Global test loss: 2.272, Global test accuracy: 46.76
Round  98, Train loss: 0.383, Test loss: 1.872, Test accuracy: 57.94
Round  98, Global train loss: 0.383, Global test loss: 2.351, Global test accuracy: 48.18
Round  99, Train loss: 0.261, Test loss: 1.902, Test accuracy: 57.92
Round  99, Global train loss: 0.261, Global test loss: 2.277, Global test accuracy: 53.94
Final Round, Train loss: 0.327, Test loss: 2.063, Test accuracy: 56.88
Final Round, Global train loss: 0.327, Global test loss: 2.277, Global test accuracy: 53.94
Average accuracy final 10 rounds: 57.364
Average global accuracy final 10 rounds: 47.769999999999996
1530.8694610595703
[4.0624823570251465, 7.783308744430542, 11.544253587722778, 15.328422546386719, 19.019046306610107, 22.751161575317383, 26.78390073776245, 30.95740008354187, 34.93519449234009, 38.987780809402466, 42.73414945602417, 46.652377128601074, 50.49505376815796, 54.05607557296753, 57.76271462440491, 61.53720021247864, 65.15819025039673, 68.96438384056091, 73.4431221485138, 77.32872009277344, 80.9383156299591, 84.63415622711182, 88.45936584472656, 92.06212496757507, 95.69613099098206, 99.47399687767029, 103.4373824596405, 107.08833956718445, 110.93676543235779, 114.6937358379364, 118.6013593673706, 122.30736541748047, 126.30241441726685, 130.04222583770752, 134.01412558555603, 137.70054078102112, 141.43768048286438, 145.24436569213867, 149.00875735282898, 152.6883420944214, 156.41712951660156, 160.13176774978638, 163.89894700050354, 168.14149260520935, 172.33922934532166, 176.18799090385437, 180.0341293811798, 184.03645849227905, 187.89830803871155, 191.81961965560913, 195.8681037425995, 199.92993092536926, 203.7656798362732, 207.73263597488403, 211.73008847236633, 215.66941380500793, 219.4608232975006, 223.25897645950317, 227.12559938430786, 230.89779806137085, 234.88349533081055, 238.77333807945251, 242.94171524047852, 246.94493508338928, 250.80707812309265, 254.6147301197052, 258.3457305431366, 262.22315192222595, 265.9900686740875, 269.8256425857544, 273.6935703754425, 277.56231021881104, 281.5045733451843, 285.3883605003357, 289.6347646713257, 293.61514949798584, 297.43195724487305, 301.2454283237457, 305.0012638568878, 308.8374094963074, 312.7001202106476, 316.64124488830566, 320.5335509777069, 324.3219928741455, 328.21283173561096, 332.0434367656708, 335.81860733032227, 339.8113579750061, 343.6641376018524, 347.4862217903137, 351.5533082485199, 355.4890196323395, 359.3439111709595, 363.31280636787415, 367.12930822372437, 371.13260793685913, 374.88560128211975, 378.6791274547577, 382.48551177978516, 386.28957438468933, 393.3150827884674]
[16.68, 32.68, 36.36, 37.56, 41.1, 40.48, 42.82, 49.2, 52.02, 51.14, 51.7, 54.96, 54.94, 54.76, 55.66, 57.6, 59.72, 59.72, 61.42, 61.66, 62.62, 63.52, 63.12, 62.62, 63.66, 63.84, 63.16, 63.12, 63.4, 63.24, 63.26, 63.52, 62.9, 63.04, 64.0, 63.84, 63.76, 63.9, 62.8, 62.36, 62.24, 63.08, 63.1, 62.12, 62.24, 61.72, 61.78, 62.36, 61.04, 61.36, 60.84, 60.54, 61.04, 60.44, 59.7, 59.48, 58.1, 57.78, 58.6, 58.72, 57.34, 57.2, 57.12, 57.8, 58.62, 58.04, 57.34, 58.28, 58.16, 57.48, 57.24, 56.98, 56.82, 57.56, 57.8, 58.32, 57.78, 57.4, 57.26, 56.74, 57.04, 56.48, 56.44, 56.46, 56.22, 56.6, 57.6, 56.58, 57.26, 57.6, 56.66, 56.12, 56.66, 57.0, 58.08, 57.94, 57.92, 57.4, 57.94, 57.92, 56.88]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.084, Test loss: 2.305, Test accuracy: 10.44
Round   0, Global train loss: 2.084, Global test loss: 2.395, Global test accuracy: 10.00
Round   1, Train loss: 1.828, Test loss: 1.931, Test accuracy: 32.76
Round   1, Global train loss: 1.828, Global test loss: 2.188, Global test accuracy: 29.20
Round   2, Train loss: 1.662, Test loss: 1.762, Test accuracy: 38.68
Round   2, Global train loss: 1.662, Global test loss: 2.050, Global test accuracy: 31.54
Round   3, Train loss: 1.632, Test loss: 1.713, Test accuracy: 40.08
Round   3, Global train loss: 1.632, Global test loss: 2.015, Global test accuracy: 29.06
Round   4, Train loss: 1.664, Test loss: 1.613, Test accuracy: 45.72
Round   4, Global train loss: 1.664, Global test loss: 2.016, Global test accuracy: 28.50
Round   5, Train loss: 1.777, Test loss: 1.595, Test accuracy: 47.48
Round   5, Global train loss: 1.777, Global test loss: 2.179, Global test accuracy: 23.52
Round   6, Train loss: 1.735, Test loss: 1.555, Test accuracy: 48.58
Round   6, Global train loss: 1.735, Global test loss: 2.145, Global test accuracy: 21.14
Round   7, Train loss: 1.719, Test loss: 1.400, Test accuracy: 52.70
Round   7, Global train loss: 1.719, Global test loss: 1.989, Global test accuracy: 31.00
Round   8, Train loss: 1.499, Test loss: 1.402, Test accuracy: 55.20
Round   8, Global train loss: 1.499, Global test loss: 1.966, Global test accuracy: 31.20
Round   9, Train loss: 1.645, Test loss: 1.428, Test accuracy: 53.96
Round   9, Global train loss: 1.645, Global test loss: 2.239, Global test accuracy: 18.02
Round  10, Train loss: 1.387, Test loss: 1.345, Test accuracy: 56.26
Round  10, Global train loss: 1.387, Global test loss: 1.994, Global test accuracy: 35.76
Round  11, Train loss: 1.668, Test loss: 1.271, Test accuracy: 59.68
Round  11, Global train loss: 1.668, Global test loss: 1.932, Global test accuracy: 44.42
Round  12, Train loss: 1.548, Test loss: 1.249, Test accuracy: 59.46
Round  12, Global train loss: 1.548, Global test loss: 2.119, Global test accuracy: 29.30
Round  13, Train loss: 1.615, Test loss: 1.226, Test accuracy: 60.72
Round  13, Global train loss: 1.615, Global test loss: 1.861, Global test accuracy: 37.68
Round  14, Train loss: 1.573, Test loss: 1.180, Test accuracy: 64.18
Round  14, Global train loss: 1.573, Global test loss: 2.210, Global test accuracy: 20.14
Round  15, Train loss: 1.470, Test loss: 1.173, Test accuracy: 64.92
Round  15, Global train loss: 1.470, Global test loss: 1.922, Global test accuracy: 36.14
Round  16, Train loss: 1.463, Test loss: 1.098, Test accuracy: 66.00
Round  16, Global train loss: 1.463, Global test loss: 1.739, Global test accuracy: 38.02
Round  17, Train loss: 1.354, Test loss: 1.123, Test accuracy: 65.90
Round  17, Global train loss: 1.354, Global test loss: 1.786, Global test accuracy: 37.50
Round  18, Train loss: 1.620, Test loss: 1.112, Test accuracy: 67.82
Round  18, Global train loss: 1.620, Global test loss: 1.971, Global test accuracy: 34.34
Round  19, Train loss: 1.631, Test loss: 1.145, Test accuracy: 67.12
Round  19, Global train loss: 1.631, Global test loss: 2.035, Global test accuracy: 23.32
Round  20, Train loss: 1.550, Test loss: 1.133, Test accuracy: 68.54
Round  20, Global train loss: 1.550, Global test loss: 2.115, Global test accuracy: 30.44
Round  21, Train loss: 1.511, Test loss: 1.084, Test accuracy: 67.88
Round  21, Global train loss: 1.511, Global test loss: 2.214, Global test accuracy: 23.38
Round  22, Train loss: 1.400, Test loss: 1.072, Test accuracy: 68.70
Round  22, Global train loss: 1.400, Global test loss: 1.955, Global test accuracy: 27.98
Round  23, Train loss: 1.544, Test loss: 1.081, Test accuracy: 68.40
Round  23, Global train loss: 1.544, Global test loss: 1.781, Global test accuracy: 41.34
Round  24, Train loss: 1.442, Test loss: 1.049, Test accuracy: 69.46
Round  24, Global train loss: 1.442, Global test loss: 2.058, Global test accuracy: 35.40
Round  25, Train loss: 1.358, Test loss: 1.005, Test accuracy: 68.76
Round  25, Global train loss: 1.358, Global test loss: 2.050, Global test accuracy: 31.14
Round  26, Train loss: 1.545, Test loss: 1.059, Test accuracy: 69.06
Round  26, Global train loss: 1.545, Global test loss: 1.963, Global test accuracy: 33.62
Round  27, Train loss: 1.245, Test loss: 1.029, Test accuracy: 69.26
Round  27, Global train loss: 1.245, Global test loss: 1.884, Global test accuracy: 36.04
Round  28, Train loss: 1.304, Test loss: 1.025, Test accuracy: 66.86
Round  28, Global train loss: 1.304, Global test loss: 1.983, Global test accuracy: 27.80
Round  29, Train loss: 1.385, Test loss: 1.013, Test accuracy: 69.52
Round  29, Global train loss: 1.385, Global test loss: 1.789, Global test accuracy: 34.60
Round  30, Train loss: 1.155, Test loss: 0.983, Test accuracy: 69.96
Round  30, Global train loss: 1.155, Global test loss: 1.767, Global test accuracy: 38.46
Round  31, Train loss: 1.078, Test loss: 0.976, Test accuracy: 70.22
Round  31, Global train loss: 1.078, Global test loss: 1.689, Global test accuracy: 38.30
Round  32, Train loss: 1.352, Test loss: 1.023, Test accuracy: 70.38
Round  32, Global train loss: 1.352, Global test loss: 1.802, Global test accuracy: 42.32
Round  33, Train loss: 1.340, Test loss: 0.997, Test accuracy: 71.24
Round  33, Global train loss: 1.340, Global test loss: 1.863, Global test accuracy: 35.04
Round  34, Train loss: 1.208, Test loss: 0.973, Test accuracy: 71.92
Round  34, Global train loss: 1.208, Global test loss: 1.719, Global test accuracy: 40.74
Round  35, Train loss: 1.241, Test loss: 0.967, Test accuracy: 72.14
Round  35, Global train loss: 1.241, Global test loss: 1.606, Global test accuracy: 50.86
Round  36, Train loss: 1.307, Test loss: 0.952, Test accuracy: 72.38
Round  36, Global train loss: 1.307, Global test loss: 1.825, Global test accuracy: 37.66
Round  37, Train loss: 1.346, Test loss: 0.949, Test accuracy: 72.40
Round  37, Global train loss: 1.346, Global test loss: 1.810, Global test accuracy: 40.00
Round  38, Train loss: 1.291, Test loss: 0.958, Test accuracy: 71.32
Round  38, Global train loss: 1.291, Global test loss: 1.815, Global test accuracy: 40.26
Round  39, Train loss: 1.035, Test loss: 0.942, Test accuracy: 72.22
Round  39, Global train loss: 1.035, Global test loss: 1.474, Global test accuracy: 54.88
Round  40, Train loss: 1.305, Test loss: 0.920, Test accuracy: 73.38
Round  40, Global train loss: 1.305, Global test loss: 1.893, Global test accuracy: 33.48
Round  41, Train loss: 1.203, Test loss: 0.986, Test accuracy: 70.72
Round  41, Global train loss: 1.203, Global test loss: 1.602, Global test accuracy: 46.46
Round  42, Train loss: 1.378, Test loss: 0.984, Test accuracy: 71.20
Round  42, Global train loss: 1.378, Global test loss: 1.926, Global test accuracy: 33.50
Round  43, Train loss: 1.335, Test loss: 0.997, Test accuracy: 70.24
Round  43, Global train loss: 1.335, Global test loss: 1.893, Global test accuracy: 38.50
Round  44, Train loss: 1.364, Test loss: 0.965, Test accuracy: 71.56
Round  44, Global train loss: 1.364, Global test loss: 1.799, Global test accuracy: 40.02
Round  45, Train loss: 1.204, Test loss: 0.944, Test accuracy: 71.02
Round  45, Global train loss: 1.204, Global test loss: 1.690, Global test accuracy: 45.86
Round  46, Train loss: 1.130, Test loss: 0.955, Test accuracy: 72.12
Round  46, Global train loss: 1.130, Global test loss: 1.541, Global test accuracy: 53.76
Round  47, Train loss: 1.099, Test loss: 0.924, Test accuracy: 70.96
Round  47, Global train loss: 1.099, Global test loss: 1.534, Global test accuracy: 52.48
Round  48, Train loss: 1.438, Test loss: 0.927, Test accuracy: 71.18
Round  48, Global train loss: 1.438, Global test loss: 1.865, Global test accuracy: 39.22
Round  49, Train loss: 1.057, Test loss: 0.917, Test accuracy: 72.74
Round  49, Global train loss: 1.057, Global test loss: 1.635, Global test accuracy: 46.50
Round  50, Train loss: 1.123, Test loss: 0.929, Test accuracy: 72.74
Round  50, Global train loss: 1.123, Global test loss: 1.615, Global test accuracy: 46.32
Round  51, Train loss: 1.460, Test loss: 0.956, Test accuracy: 71.94
Round  51, Global train loss: 1.460, Global test loss: 2.011, Global test accuracy: 32.92
Round  52, Train loss: 0.914, Test loss: 0.919, Test accuracy: 72.78
Round  52, Global train loss: 0.914, Global test loss: 1.440, Global test accuracy: 56.52
Round  53, Train loss: 1.022, Test loss: 0.917, Test accuracy: 71.44
Round  53, Global train loss: 1.022, Global test loss: 1.488, Global test accuracy: 54.56
Round  54, Train loss: 1.403, Test loss: 0.925, Test accuracy: 70.78
Round  54, Global train loss: 1.403, Global test loss: 1.892, Global test accuracy: 33.68
Round  55, Train loss: 0.957, Test loss: 0.938, Test accuracy: 71.34
Round  55, Global train loss: 0.957, Global test loss: 1.848, Global test accuracy: 41.84
Round  56, Train loss: 1.143, Test loss: 0.944, Test accuracy: 70.16
Round  56, Global train loss: 1.143, Global test loss: 1.822, Global test accuracy: 40.74
Round  57, Train loss: 1.105, Test loss: 0.930, Test accuracy: 71.10
Round  57, Global train loss: 1.105, Global test loss: 1.864, Global test accuracy: 48.14
Round  58, Train loss: 0.726, Test loss: 0.889, Test accuracy: 72.06
Round  58, Global train loss: 0.726, Global test loss: 1.596, Global test accuracy: 50.00
Round  59, Train loss: 1.175, Test loss: 0.913, Test accuracy: 71.88
Round  59, Global train loss: 1.175, Global test loss: 2.159, Global test accuracy: 32.74
Round  60, Train loss: 1.235, Test loss: 0.925, Test accuracy: 71.64
Round  60, Global train loss: 1.235, Global test loss: 1.883, Global test accuracy: 36.58
Round  61, Train loss: 0.897, Test loss: 0.922, Test accuracy: 70.86
Round  61, Global train loss: 0.897, Global test loss: 1.649, Global test accuracy: 51.02
Round  62, Train loss: 0.824, Test loss: 0.933, Test accuracy: 71.34
Round  62, Global train loss: 0.824, Global test loss: 1.431, Global test accuracy: 56.04
Round  63, Train loss: 1.049, Test loss: 0.938, Test accuracy: 70.10
Round  63, Global train loss: 1.049, Global test loss: 1.727, Global test accuracy: 40.82
Round  64, Train loss: 1.099, Test loss: 0.924, Test accuracy: 70.44
Round  64, Global train loss: 1.099, Global test loss: 2.100, Global test accuracy: 35.36
Round  65, Train loss: 0.987, Test loss: 0.913, Test accuracy: 70.98
Round  65, Global train loss: 0.987, Global test loss: 1.578, Global test accuracy: 49.06
Round  66, Train loss: 0.874, Test loss: 0.939, Test accuracy: 69.66
Round  66, Global train loss: 0.874, Global test loss: 1.668, Global test accuracy: 42.68
Round  67, Train loss: 0.839, Test loss: 0.945, Test accuracy: 69.78
Round  67, Global train loss: 0.839, Global test loss: 1.656, Global test accuracy: 46.80
Round  68, Train loss: 0.802, Test loss: 0.916, Test accuracy: 70.30
Round  68, Global train loss: 0.802, Global test loss: 1.845, Global test accuracy: 45.04
Round  69, Train loss: 0.939, Test loss: 0.906, Test accuracy: 71.14
Round  69, Global train loss: 0.939, Global test loss: 1.736, Global test accuracy: 41.74
Round  70, Train loss: 1.060, Test loss: 0.943, Test accuracy: 69.08
Round  70, Global train loss: 1.060, Global test loss: 1.685, Global test accuracy: 45.28
Round  71, Train loss: 0.907, Test loss: 0.974, Test accuracy: 68.12
Round  71, Global train loss: 0.907, Global test loss: 1.584, Global test accuracy: 44.80
Round  72, Train loss: 1.202, Test loss: 1.005, Test accuracy: 66.58
Round  72, Global train loss: 1.202, Global test loss: 1.964, Global test accuracy: 31.12
Round  73, Train loss: 1.004, Test loss: 0.930, Test accuracy: 69.86
Round  73, Global train loss: 1.004, Global test loss: 2.053, Global test accuracy: 33.98
Round  74, Train loss: 0.877, Test loss: 0.968, Test accuracy: 68.36
Round  74, Global train loss: 0.877, Global test loss: 1.544, Global test accuracy: 50.56
Round  75, Train loss: 0.564, Test loss: 0.918, Test accuracy: 70.22
Round  75, Global train loss: 0.564, Global test loss: 1.613, Global test accuracy: 51.90
Round  76, Train loss: 0.991, Test loss: 0.912, Test accuracy: 70.36
Round  76, Global train loss: 0.991, Global test loss: 1.675, Global test accuracy: 42.58
Round  77, Train loss: 1.105, Test loss: 0.907, Test accuracy: 70.14
Round  77, Global train loss: 1.105, Global test loss: 1.705, Global test accuracy: 37.96
Round  78, Train loss: 0.899, Test loss: 0.934, Test accuracy: 70.00
Round  78, Global train loss: 0.899, Global test loss: 1.551, Global test accuracy: 47.52
Round  79, Train loss: 0.872, Test loss: 0.935, Test accuracy: 69.88
Round  79, Global train loss: 0.872, Global test loss: 1.530, Global test accuracy: 49.12
Round  80, Train loss: 0.767, Test loss: 0.932, Test accuracy: 70.12
Round  80, Global train loss: 0.767, Global test loss: 1.664, Global test accuracy: 43.74
Round  81, Train loss: 0.891, Test loss: 0.917, Test accuracy: 70.42
Round  81, Global train loss: 0.891, Global test loss: 1.815, Global test accuracy: 37.90
Round  82, Train loss: 0.857, Test loss: 0.951, Test accuracy: 69.30
Round  82, Global train loss: 0.857, Global test loss: 1.975, Global test accuracy: 33.90
Round  83, Train loss: 0.868, Test loss: 0.990, Test accuracy: 67.34
Round  83, Global train loss: 0.868, Global test loss: 1.762, Global test accuracy: 37.88
Round  84, Train loss: 0.869, Test loss: 0.974, Test accuracy: 68.26
Round  84, Global train loss: 0.869, Global test loss: 2.066, Global test accuracy: 36.16
Round  85, Train loss: 0.982, Test loss: 1.014, Test accuracy: 66.64
Round  85, Global train loss: 0.982, Global test loss: 1.975, Global test accuracy: 32.70
Round  86, Train loss: 1.067, Test loss: 1.013, Test accuracy: 66.80
Round  86, Global train loss: 1.067, Global test loss: 2.406, Global test accuracy: 27.92
Round  87, Train loss: 0.856, Test loss: 0.986, Test accuracy: 66.64
Round  87, Global train loss: 0.856, Global test loss: 2.053, Global test accuracy: 37.38
Round  88, Train loss: 0.784, Test loss: 0.995, Test accuracy: 66.68
Round  88, Global train loss: 0.784, Global test loss: 2.012, Global test accuracy: 35.80
Round  89, Train loss: 0.767, Test loss: 1.007, Test accuracy: 66.82
Round  89, Global train loss: 0.767, Global test loss: 2.129, Global test accuracy: 36.08
Round  90, Train loss: 0.986, Test loss: 1.051, Test accuracy: 64.76
Round  90, Global train loss: 0.986, Global test loss: 2.399, Global test accuracy: 27.80
Round  91, Train loss: 0.896, Test loss: 1.053, Test accuracy: 65.48
Round  91, Global train loss: 0.896, Global test loss: 2.218, Global test accuracy: 33.88
Round  92, Train loss: 0.768, Test loss: 1.048, Test accuracy: 64.94
Round  92, Global train loss: 0.768, Global test loss: 1.739, Global test accuracy: 40.74
Round  93, Train loss: 0.805, Test loss: 1.014, Test accuracy: 65.90
Round  93, Global train loss: 0.805, Global test loss: 1.868, Global test accuracy: 35.84
Round  94, Train loss: 0.829, Test loss: 1.027, Test accuracy: 65.50
Round  94, Global train loss: 0.829, Global test loss: 1.667, Global test accuracy: 41.58
Round  95, Train loss: 0.793, Test loss: 1.001, Test accuracy: 66.24
Round  95, Global train loss: 0.793, Global test loss: 1.806, Global test accuracy: 44.18
Round  96, Train loss: 0.608, Test loss: 0.963, Test accuracy: 68.60
Round  96, Global train loss: 0.608, Global test loss: 1.854, Global test accuracy: 47.70
Round  97, Train loss: 0.702, Test loss: 1.003, Test accuracy: 66.74
Round  97, Global train loss: 0.702, Global test loss: 1.766, Global test accuracy: 41.26
Round  98, Train loss: 0.908, Test loss: 1.062, Test accuracy: 64.26
Round  98, Global train loss: 0.908, Global test loss: 2.540, Global test accuracy: 22.22
Round  99, Train loss: 0.849, Test loss: 1.087, Test accuracy: 63.56
Round  99, Global train loss: 0.849, Global test loss: 2.089, Global test accuracy: 34.50
Final Round, Train loss: 0.644, Test loss: 1.090, Test accuracy: 64.46
Final Round, Global train loss: 0.644, Global test loss: 2.089, Global test accuracy: 34.50
Average accuracy final 10 rounds: 65.598
846.7497777938843
[2.131289005279541, 3.957123279571533, 5.828802824020386, 7.58030104637146, 9.341112852096558, 11.079182386398315, 12.841127872467041, 14.802919387817383, 16.561774730682373, 18.323906660079956, 20.114718914031982, 21.99482297897339, 23.71982741355896, 25.520633220672607, 27.343131065368652, 29.034512996673584, 30.799907445907593, 32.620877504348755, 34.45675039291382, 36.20123791694641, 38.08111047744751, 39.896987199783325, 41.724098682403564, 43.64403200149536, 45.4842050075531, 47.216552734375, 49.00545859336853, 50.767714500427246, 52.54892158508301, 54.27661895751953, 56.15487885475159, 57.88205671310425, 59.63921666145325, 61.37938213348389, 63.163867712020874, 65.01130557060242, 66.75286793708801, 68.53393721580505, 70.26018524169922, 71.92274212837219, 73.74607253074646, 75.43927907943726, 77.22026777267456, 79.10066080093384, 81.23264646530151, 83.03645515441895, 84.7642011642456, 86.5588972568512, 88.31304931640625, 90.2685854434967, 92.04305624961853, 93.79467582702637, 95.66390204429626, 97.42131185531616, 99.13560271263123, 100.91014313697815, 102.66533923149109, 104.35995101928711, 106.20131230354309, 107.9286949634552, 109.68410277366638, 111.48203539848328, 113.22685885429382, 114.96370935440063, 116.62196183204651, 118.3689501285553, 120.04112601280212, 121.79334568977356, 123.44955062866211, 125.19497919082642, 126.86616730690002, 128.53007531166077, 130.08685755729675, 131.62922430038452, 133.216698884964, 134.74559235572815, 136.30727982521057, 137.84931707382202, 139.43732619285583, 140.99584078788757, 142.56010222434998, 144.10453271865845, 145.6637990474701, 147.21237421035767, 148.84847617149353, 150.4931218624115, 152.039124250412, 153.57914900779724, 155.0733859539032, 156.5859878063202, 158.1299238204956, 159.67154741287231, 161.18988251686096, 162.75074648857117, 164.3467230796814, 165.99518489837646, 167.61731958389282, 169.18161129951477, 170.77426075935364, 172.35813522338867, 174.94465899467468]
[10.44, 32.76, 38.68, 40.08, 45.72, 47.48, 48.58, 52.7, 55.2, 53.96, 56.26, 59.68, 59.46, 60.72, 64.18, 64.92, 66.0, 65.9, 67.82, 67.12, 68.54, 67.88, 68.7, 68.4, 69.46, 68.76, 69.06, 69.26, 66.86, 69.52, 69.96, 70.22, 70.38, 71.24, 71.92, 72.14, 72.38, 72.4, 71.32, 72.22, 73.38, 70.72, 71.2, 70.24, 71.56, 71.02, 72.12, 70.96, 71.18, 72.74, 72.74, 71.94, 72.78, 71.44, 70.78, 71.34, 70.16, 71.1, 72.06, 71.88, 71.64, 70.86, 71.34, 70.1, 70.44, 70.98, 69.66, 69.78, 70.3, 71.14, 69.08, 68.12, 66.58, 69.86, 68.36, 70.22, 70.36, 70.14, 70.0, 69.88, 70.12, 70.42, 69.3, 67.34, 68.26, 66.64, 66.8, 66.64, 66.68, 66.82, 64.76, 65.48, 64.94, 65.9, 65.5, 66.24, 68.6, 66.74, 64.26, 63.56, 64.46]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.067, Test loss: 1.932, Test accuracy: 26.76
Round   0, Global train loss: 2.067, Global test loss: 2.236, Global test accuracy: 22.42
Round   1, Train loss: 1.838, Test loss: 1.636, Test accuracy: 40.12
Round   1, Global train loss: 1.838, Global test loss: 2.148, Global test accuracy: 28.38
Round   2, Train loss: 1.749, Test loss: 1.517, Test accuracy: 44.08
Round   2, Global train loss: 1.749, Global test loss: 2.067, Global test accuracy: 34.40
Round   3, Train loss: 1.702, Test loss: 1.444, Test accuracy: 48.20
Round   3, Global train loss: 1.702, Global test loss: 2.021, Global test accuracy: 36.00
Round   4, Train loss: 1.668, Test loss: 1.390, Test accuracy: 52.48
Round   4, Global train loss: 1.668, Global test loss: 1.981, Global test accuracy: 38.66
Round   5, Train loss: 1.638, Test loss: 1.342, Test accuracy: 54.74
Round   5, Global train loss: 1.638, Global test loss: 1.944, Global test accuracy: 39.44
Round   6, Train loss: 1.613, Test loss: 1.308, Test accuracy: 56.58
Round   6, Global train loss: 1.613, Global test loss: 1.922, Global test accuracy: 40.32
Round   7, Train loss: 1.598, Test loss: 1.299, Test accuracy: 58.66
Round   7, Global train loss: 1.598, Global test loss: 1.907, Global test accuracy: 41.98
Round   8, Train loss: 1.578, Test loss: 1.267, Test accuracy: 60.38
Round   8, Global train loss: 1.578, Global test loss: 1.883, Global test accuracy: 42.42
Round   9, Train loss: 1.557, Test loss: 1.231, Test accuracy: 60.64
Round   9, Global train loss: 1.557, Global test loss: 1.856, Global test accuracy: 43.66
Round  10, Train loss: 1.460, Test loss: 1.239, Test accuracy: 60.10
Round  10, Global train loss: 1.460, Global test loss: 2.124, Global test accuracy: 35.84
Round  11, Train loss: 1.362, Test loss: 1.200, Test accuracy: 59.68
Round  11, Global train loss: 1.362, Global test loss: 2.061, Global test accuracy: 34.84
Round  12, Train loss: 1.353, Test loss: 1.195, Test accuracy: 58.32
Round  12, Global train loss: 1.353, Global test loss: 2.688, Global test accuracy: 22.08
Round  13, Train loss: 1.356, Test loss: 1.164, Test accuracy: 56.68
Round  13, Global train loss: 1.356, Global test loss: 2.123, Global test accuracy: 28.60
Round  14, Train loss: 1.361, Test loss: 1.184, Test accuracy: 58.38
Round  14, Global train loss: 1.361, Global test loss: 2.481, Global test accuracy: 17.62
Round  15, Train loss: 1.300, Test loss: 1.155, Test accuracy: 60.94
Round  15, Global train loss: 1.300, Global test loss: 2.141, Global test accuracy: 31.96
Round  16, Train loss: 1.315, Test loss: 1.180, Test accuracy: 62.72
Round  16, Global train loss: 1.315, Global test loss: 1.845, Global test accuracy: 30.66
Round  17, Train loss: 1.349, Test loss: 1.165, Test accuracy: 60.76
Round  17, Global train loss: 1.349, Global test loss: 1.936, Global test accuracy: 33.80
Round  18, Train loss: 1.340, Test loss: 1.124, Test accuracy: 62.28
Round  18, Global train loss: 1.340, Global test loss: 2.173, Global test accuracy: 20.58
Round  19, Train loss: 1.250, Test loss: 1.117, Test accuracy: 62.92
Round  19, Global train loss: 1.250, Global test loss: 2.006, Global test accuracy: 29.48
Round  20, Train loss: 1.339, Test loss: 1.094, Test accuracy: 63.36
Round  20, Global train loss: 1.339, Global test loss: 2.564, Global test accuracy: 28.48
Round  21, Train loss: 1.263, Test loss: 1.109, Test accuracy: 63.88
Round  21, Global train loss: 1.263, Global test loss: 2.380, Global test accuracy: 23.82
Round  22, Train loss: 1.283, Test loss: 1.127, Test accuracy: 62.60
Round  22, Global train loss: 1.283, Global test loss: 2.158, Global test accuracy: 18.16
Round  23, Train loss: 1.238, Test loss: 1.115, Test accuracy: 62.70
Round  23, Global train loss: 1.238, Global test loss: 1.978, Global test accuracy: 27.42
Round  24, Train loss: 1.267, Test loss: 1.111, Test accuracy: 62.58
Round  24, Global train loss: 1.267, Global test loss: 2.706, Global test accuracy: 22.60
Round  25, Train loss: 1.215, Test loss: 1.115, Test accuracy: 64.00
Round  25, Global train loss: 1.215, Global test loss: 2.213, Global test accuracy: 27.82
Round  26, Train loss: 1.258, Test loss: 1.087, Test accuracy: 65.44
Round  26, Global train loss: 1.258, Global test loss: 2.053, Global test accuracy: 25.56
Round  27, Train loss: 1.113, Test loss: 1.015, Test accuracy: 68.26
Round  27, Global train loss: 1.113, Global test loss: 1.822, Global test accuracy: 36.40
Round  28, Train loss: 1.236, Test loss: 1.074, Test accuracy: 64.12
Round  28, Global train loss: 1.236, Global test loss: 2.302, Global test accuracy: 19.30
Round  29, Train loss: 1.149, Test loss: 1.017, Test accuracy: 68.28
Round  29, Global train loss: 1.149, Global test loss: 1.734, Global test accuracy: 41.66
Round  30, Train loss: 1.301, Test loss: 1.054, Test accuracy: 66.66
Round  30, Global train loss: 1.301, Global test loss: 2.183, Global test accuracy: 19.70
Round  31, Train loss: 1.240, Test loss: 1.019, Test accuracy: 68.96
Round  31, Global train loss: 1.240, Global test loss: 2.009, Global test accuracy: 32.92
Round  32, Train loss: 1.171, Test loss: 1.080, Test accuracy: 66.94
Round  32, Global train loss: 1.171, Global test loss: 2.052, Global test accuracy: 39.62
Round  33, Train loss: 1.096, Test loss: 1.034, Test accuracy: 68.64
Round  33, Global train loss: 1.096, Global test loss: 2.153, Global test accuracy: 30.66
Round  34, Train loss: 1.224, Test loss: 1.008, Test accuracy: 69.00
Round  34, Global train loss: 1.224, Global test loss: 1.926, Global test accuracy: 37.76
Round  35, Train loss: 1.243, Test loss: 1.012, Test accuracy: 67.98
Round  35, Global train loss: 1.243, Global test loss: 1.906, Global test accuracy: 32.34
Round  36, Train loss: 1.064, Test loss: 0.975, Test accuracy: 70.54
Round  36, Global train loss: 1.064, Global test loss: 2.061, Global test accuracy: 31.58
Round  37, Train loss: 1.211, Test loss: 1.001, Test accuracy: 70.20
Round  37, Global train loss: 1.211, Global test loss: 1.961, Global test accuracy: 36.14
Round  38, Train loss: 1.151, Test loss: 1.033, Test accuracy: 68.52
Round  38, Global train loss: 1.151, Global test loss: 2.050, Global test accuracy: 32.58
Round  39, Train loss: 1.174, Test loss: 0.974, Test accuracy: 71.26
Round  39, Global train loss: 1.174, Global test loss: 1.691, Global test accuracy: 47.86
Round  40, Train loss: 1.199, Test loss: 0.995, Test accuracy: 68.88
Round  40, Global train loss: 1.199, Global test loss: 2.474, Global test accuracy: 28.30
Round  41, Train loss: 0.999, Test loss: 0.969, Test accuracy: 70.36
Round  41, Global train loss: 0.999, Global test loss: 1.667, Global test accuracy: 47.74
Round  42, Train loss: 1.085, Test loss: 0.979, Test accuracy: 70.46
Round  42, Global train loss: 1.085, Global test loss: 1.759, Global test accuracy: 37.86
Round  43, Train loss: 1.040, Test loss: 0.993, Test accuracy: 69.56
Round  43, Global train loss: 1.040, Global test loss: 1.737, Global test accuracy: 39.60
Round  44, Train loss: 1.141, Test loss: 1.028, Test accuracy: 68.34
Round  44, Global train loss: 1.141, Global test loss: 1.938, Global test accuracy: 34.34
Round  45, Train loss: 1.083, Test loss: 0.986, Test accuracy: 69.46
Round  45, Global train loss: 1.083, Global test loss: 1.769, Global test accuracy: 44.48
Round  46, Train loss: 1.094, Test loss: 0.935, Test accuracy: 71.34
Round  46, Global train loss: 1.094, Global test loss: 1.661, Global test accuracy: 50.06
Round  47, Train loss: 1.046, Test loss: 0.974, Test accuracy: 70.24
Round  47, Global train loss: 1.046, Global test loss: 1.683, Global test accuracy: 46.46
Round  48, Train loss: 1.074, Test loss: 0.950, Test accuracy: 69.76
Round  48, Global train loss: 1.074, Global test loss: 2.312, Global test accuracy: 38.16
Round  49, Train loss: 1.001, Test loss: 0.932, Test accuracy: 69.74
Round  49, Global train loss: 1.001, Global test loss: 1.728, Global test accuracy: 40.74
Round  50, Train loss: 1.039, Test loss: 0.914, Test accuracy: 70.74
Round  50, Global train loss: 1.039, Global test loss: 1.693, Global test accuracy: 40.20
Round  51, Train loss: 1.012, Test loss: 0.965, Test accuracy: 69.50
Round  51, Global train loss: 1.012, Global test loss: 2.298, Global test accuracy: 27.52
Round  52, Train loss: 1.078, Test loss: 0.951, Test accuracy: 70.86
Round  52, Global train loss: 1.078, Global test loss: 1.645, Global test accuracy: 46.02
Round  53, Train loss: 0.847, Test loss: 0.912, Test accuracy: 72.52
Round  53, Global train loss: 0.847, Global test loss: 1.622, Global test accuracy: 44.64
Round  54, Train loss: 0.984, Test loss: 0.925, Test accuracy: 69.74
Round  54, Global train loss: 0.984, Global test loss: 1.947, Global test accuracy: 38.56
Round  55, Train loss: 0.796, Test loss: 0.898, Test accuracy: 71.04
Round  55, Global train loss: 0.796, Global test loss: 1.626, Global test accuracy: 46.44
Round  56, Train loss: 1.006, Test loss: 0.946, Test accuracy: 69.92
Round  56, Global train loss: 1.006, Global test loss: 1.943, Global test accuracy: 37.26
Round  57, Train loss: 0.859, Test loss: 0.924, Test accuracy: 69.60
Round  57, Global train loss: 0.859, Global test loss: 1.933, Global test accuracy: 36.90
Round  58, Train loss: 0.851, Test loss: 0.916, Test accuracy: 70.56
Round  58, Global train loss: 0.851, Global test loss: 1.683, Global test accuracy: 48.76
Round  59, Train loss: 0.981, Test loss: 0.932, Test accuracy: 70.26
Round  59, Global train loss: 0.981, Global test loss: 2.449, Global test accuracy: 33.56
Round  60, Train loss: 0.919, Test loss: 0.978, Test accuracy: 68.44
Round  60, Global train loss: 0.919, Global test loss: 1.696, Global test accuracy: 40.64
Round  61, Train loss: 0.732, Test loss: 0.931, Test accuracy: 70.40
Round  61, Global train loss: 0.732, Global test loss: 1.593, Global test accuracy: 47.60
Round  62, Train loss: 0.956, Test loss: 0.932, Test accuracy: 70.30
Round  62, Global train loss: 0.956, Global test loss: 1.599, Global test accuracy: 49.06
Round  63, Train loss: 0.839, Test loss: 0.930, Test accuracy: 70.86
Round  63, Global train loss: 0.839, Global test loss: 1.675, Global test accuracy: 43.26
Round  64, Train loss: 0.907, Test loss: 0.941, Test accuracy: 70.98
Round  64, Global train loss: 0.907, Global test loss: 2.458, Global test accuracy: 32.92
Round  65, Train loss: 0.913, Test loss: 0.929, Test accuracy: 69.56
Round  65, Global train loss: 0.913, Global test loss: 1.645, Global test accuracy: 46.90
Round  66, Train loss: 0.984, Test loss: 0.929, Test accuracy: 69.70
Round  66, Global train loss: 0.984, Global test loss: 1.780, Global test accuracy: 40.20
Round  67, Train loss: 0.712, Test loss: 0.925, Test accuracy: 70.36
Round  67, Global train loss: 0.712, Global test loss: 1.538, Global test accuracy: 48.60
Round  68, Train loss: 0.860, Test loss: 0.938, Test accuracy: 69.32
Round  68, Global train loss: 0.860, Global test loss: 2.014, Global test accuracy: 41.06
Round  69, Train loss: 0.747, Test loss: 0.949, Test accuracy: 69.30
Round  69, Global train loss: 0.747, Global test loss: 1.658, Global test accuracy: 43.68
Round  70, Train loss: 0.705, Test loss: 0.973, Test accuracy: 68.58
Round  70, Global train loss: 0.705, Global test loss: 1.423, Global test accuracy: 53.38
Round  71, Train loss: 0.793, Test loss: 0.949, Test accuracy: 69.20
Round  71, Global train loss: 0.793, Global test loss: 1.765, Global test accuracy: 45.78
Round  72, Train loss: 0.798, Test loss: 0.973, Test accuracy: 68.54
Round  72, Global train loss: 0.798, Global test loss: 2.023, Global test accuracy: 34.22
Round  73, Train loss: 0.973, Test loss: 0.984, Test accuracy: 68.62
Round  73, Global train loss: 0.973, Global test loss: 2.446, Global test accuracy: 28.52
Round  74, Train loss: 0.894, Test loss: 0.955, Test accuracy: 69.20
Round  74, Global train loss: 0.894, Global test loss: 1.544, Global test accuracy: 48.32
Round  75, Train loss: 0.840, Test loss: 0.946, Test accuracy: 69.52
Round  75, Global train loss: 0.840, Global test loss: 1.751, Global test accuracy: 51.48
Round  76, Train loss: 0.814, Test loss: 0.973, Test accuracy: 68.08
Round  76, Global train loss: 0.814, Global test loss: 1.632, Global test accuracy: 43.92
Round  77, Train loss: 0.879, Test loss: 1.008, Test accuracy: 66.92
Round  77, Global train loss: 0.879, Global test loss: 1.801, Global test accuracy: 37.44
Round  78, Train loss: 0.886, Test loss: 0.972, Test accuracy: 68.54
Round  78, Global train loss: 0.886, Global test loss: 1.442, Global test accuracy: 54.82
Round  79, Train loss: 0.789, Test loss: 0.987, Test accuracy: 67.74
Round  79, Global train loss: 0.789, Global test loss: 1.874, Global test accuracy: 39.02
Round  80, Train loss: 0.565, Test loss: 0.938, Test accuracy: 69.14
Round  80, Global train loss: 0.565, Global test loss: 1.614, Global test accuracy: 47.28
Round  81, Train loss: 0.502, Test loss: 0.967, Test accuracy: 69.38
Round  81, Global train loss: 0.502, Global test loss: 1.539, Global test accuracy: 49.94
Round  82, Train loss: 0.484, Test loss: 0.959, Test accuracy: 68.56
Round  82, Global train loss: 0.484, Global test loss: 1.607, Global test accuracy: 49.44
Round  83, Train loss: 0.434, Test loss: 0.984, Test accuracy: 67.76
Round  83, Global train loss: 0.434, Global test loss: 1.614, Global test accuracy: 50.06
Round  84, Train loss: 0.418, Test loss: 0.989, Test accuracy: 68.00
Round  84, Global train loss: 0.418, Global test loss: 1.575, Global test accuracy: 51.02
Round  85, Train loss: 0.388, Test loss: 0.982, Test accuracy: 68.68
Round  85, Global train loss: 0.388, Global test loss: 1.594, Global test accuracy: 50.52
Round  86, Train loss: 0.363, Test loss: 1.006, Test accuracy: 67.18
Round  86, Global train loss: 0.363, Global test loss: 1.710, Global test accuracy: 50.06
Round  87, Train loss: 0.348, Test loss: 1.074, Test accuracy: 66.42
Round  87, Global train loss: 0.348, Global test loss: 1.679, Global test accuracy: 49.38
Round  88, Train loss: 0.345, Test loss: 1.034, Test accuracy: 65.82
Round  88, Global train loss: 0.345, Global test loss: 1.685, Global test accuracy: 49.44
Round  89, Train loss: 0.326, Test loss: 1.049, Test accuracy: 65.18
Round  89, Global train loss: 0.326, Global test loss: 1.723, Global test accuracy: 48.90
Round  90, Train loss: 0.308, Test loss: 1.032, Test accuracy: 66.92
Round  90, Global train loss: 0.308, Global test loss: 1.681, Global test accuracy: 49.94
Round  91, Train loss: 0.312, Test loss: 1.040, Test accuracy: 65.96
Round  91, Global train loss: 0.312, Global test loss: 1.728, Global test accuracy: 48.60
Round  92, Train loss: 0.297, Test loss: 1.041, Test accuracy: 66.32
Round  92, Global train loss: 0.297, Global test loss: 1.675, Global test accuracy: 51.14
Round  93, Train loss: 0.264, Test loss: 1.095, Test accuracy: 65.02
Round  93, Global train loss: 0.264, Global test loss: 1.852, Global test accuracy: 48.60
Round  94, Train loss: 0.272, Test loss: 1.077, Test accuracy: 65.40
Round  94, Global train loss: 0.272, Global test loss: 1.818, Global test accuracy: 48.74
Round  95, Train loss: 0.276, Test loss: 1.056, Test accuracy: 65.70
Round  95, Global train loss: 0.276, Global test loss: 1.793, Global test accuracy: 48.48
Round  96, Train loss: 0.244, Test loss: 1.063, Test accuracy: 66.36
Round  96, Global train loss: 0.244, Global test loss: 1.806, Global test accuracy: 49.54
Round  97, Train loss: 0.244, Test loss: 1.063, Test accuracy: 66.38
Round  97, Global train loss: 0.244, Global test loss: 1.752, Global test accuracy: 51.18
Round  98, Train loss: 0.228, Test loss: 1.071, Test accuracy: 65.52
Round  98, Global train loss: 0.228, Global test loss: 1.749, Global test accuracy: 51.34
Round  99, Train loss: 0.695, Test loss: 1.022, Test accuracy: 67.16
Round  99, Global train loss: 0.695, Global test loss: 1.439, Global test accuracy: 53.48
Final Round, Train loss: 0.679, Test loss: 1.009, Test accuracy: 68.20
Final Round, Global train loss: 0.679, Global test loss: 1.439, Global test accuracy: 53.48
Average accuracy final 10 rounds: 66.074
2145.761708021164
[2.19176983833313, 3.973803997039795, 5.708346128463745, 7.519932270050049, 9.271733283996582, 11.040710210800171, 12.852932691574097, 14.677716255187988, 16.467583894729614, 18.24484658241272, 24.474786043167114, 33.46652793884277, 42.34255599975586, 51.47196412086487, 60.81144738197327, 70.09360909461975, 79.36149835586548, 88.69022512435913, 98.01061511039734, 107.46678137779236, 116.8901960849762, 126.06739163398743, 135.17828583717346, 144.48640632629395, 153.7476613521576, 162.98319840431213, 172.42730164527893, 174.20065712928772, 183.49586367607117, 192.60180282592773, 201.84771275520325, 211.1470286846161, 220.31688451766968, 229.45788383483887, 238.7264051437378, 247.89460062980652, 256.93123269081116, 266.26705527305603, 275.32711911201477, 284.5388653278351, 293.90613174438477, 303.168420791626, 312.3131422996521, 321.53910660743713, 330.90659403800964, 340.20433282852173, 349.41823267936707, 358.68214559555054, 368.1248137950897, 377.5700788497925, 386.9301166534424, 396.5066945552826, 405.88623785972595, 415.1294574737549, 424.7300786972046, 426.60796213150024, 436.1946246623993, 445.82557559013367, 455.1148262023926, 464.5610234737396, 473.81196761131287, 482.8705961704254, 492.1609237194061, 501.37662720680237, 510.5498173236847, 519.6288714408875, 528.9249222278595, 537.9995183944702, 547.4003293514252, 556.5784187316895, 565.7218189239502, 574.9721999168396, 584.3217482566833, 593.5847861766815, 602.692408323288, 611.7370631694794, 620.4290971755981, 629.1662874221802, 637.9471950531006, 646.5116164684296, 648.1159942150116, 649.7528715133667, 651.315589427948, 652.847297668457, 654.3959262371063, 656.0548183917999, 657.5950672626495, 659.2455780506134, 660.8356165885925, 662.447357416153, 664.0612926483154, 665.6052296161652, 667.1317574977875, 668.7420737743378, 670.2942612171173, 671.8796236515045, 673.4405472278595, 675.055285692215, 676.6610877513885, 685.3941357135773, 694.7019286155701]
[26.76, 40.12, 44.08, 48.2, 52.48, 54.74, 56.58, 58.66, 60.38, 60.64, 60.1, 59.68, 58.32, 56.68, 58.38, 60.94, 62.72, 60.76, 62.28, 62.92, 63.36, 63.88, 62.6, 62.7, 62.58, 64.0, 65.44, 68.26, 64.12, 68.28, 66.66, 68.96, 66.94, 68.64, 69.0, 67.98, 70.54, 70.2, 68.52, 71.26, 68.88, 70.36, 70.46, 69.56, 68.34, 69.46, 71.34, 70.24, 69.76, 69.74, 70.74, 69.5, 70.86, 72.52, 69.74, 71.04, 69.92, 69.6, 70.56, 70.26, 68.44, 70.4, 70.3, 70.86, 70.98, 69.56, 69.7, 70.36, 69.32, 69.3, 68.58, 69.2, 68.54, 68.62, 69.2, 69.52, 68.08, 66.92, 68.54, 67.74, 69.14, 69.38, 68.56, 67.76, 68.0, 68.68, 67.18, 66.42, 65.82, 65.18, 66.92, 65.96, 66.32, 65.02, 65.4, 65.7, 66.36, 66.38, 65.52, 67.16, 68.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.904, Test loss: 2.091, Test accuracy: 20.38
Round   0, Global train loss: 1.904, Global test loss: 2.248, Global test accuracy: 19.20
Round   1, Train loss: 1.757, Test loss: 2.050, Test accuracy: 21.40
Round   1, Global train loss: 1.757, Global test loss: 2.424, Global test accuracy: 10.00
Round   2, Train loss: 1.801, Test loss: 1.863, Test accuracy: 33.44
Round   2, Global train loss: 1.801, Global test loss: 2.113, Global test accuracy: 30.22
Round   3, Train loss: 1.856, Test loss: 1.814, Test accuracy: 29.30
Round   3, Global train loss: 1.856, Global test loss: 2.323, Global test accuracy: 10.00
Round   4, Train loss: 1.917, Test loss: 1.773, Test accuracy: 31.02
Round   4, Global train loss: 1.917, Global test loss: 2.292, Global test accuracy: 14.30
Round   5, Train loss: 1.622, Test loss: 1.748, Test accuracy: 33.96
Round   5, Global train loss: 1.622, Global test loss: 2.188, Global test accuracy: 21.92
Round   6, Train loss: 1.905, Test loss: 1.614, Test accuracy: 37.86
Round   6, Global train loss: 1.905, Global test loss: 2.369, Global test accuracy: 13.90
Round   7, Train loss: 1.623, Test loss: 1.615, Test accuracy: 39.30
Round   7, Global train loss: 1.623, Global test loss: 2.001, Global test accuracy: 30.74
Round   8, Train loss: 1.672, Test loss: 1.602, Test accuracy: 39.12
Round   8, Global train loss: 1.672, Global test loss: 2.267, Global test accuracy: 21.86
Round   9, Train loss: 1.517, Test loss: 1.569, Test accuracy: 40.74
Round   9, Global train loss: 1.517, Global test loss: 2.114, Global test accuracy: 25.90
Round  10, Train loss: 1.837, Test loss: 1.546, Test accuracy: 40.38
Round  10, Global train loss: 1.837, Global test loss: 2.119, Global test accuracy: 26.08
Round  11, Train loss: 1.851, Test loss: 1.541, Test accuracy: 40.16
Round  11, Global train loss: 1.851, Global test loss: 2.341, Global test accuracy: 15.10
Round  12, Train loss: 1.466, Test loss: 1.528, Test accuracy: 41.44
Round  12, Global train loss: 1.466, Global test loss: 2.033, Global test accuracy: 26.76
Round  13, Train loss: 1.507, Test loss: 1.539, Test accuracy: 41.22
Round  13, Global train loss: 1.507, Global test loss: 2.084, Global test accuracy: 30.08
Round  14, Train loss: 1.534, Test loss: 1.523, Test accuracy: 41.16
Round  14, Global train loss: 1.534, Global test loss: 2.050, Global test accuracy: 29.10
Round  15, Train loss: 1.633, Test loss: 1.511, Test accuracy: 41.88
Round  15, Global train loss: 1.633, Global test loss: 2.152, Global test accuracy: 23.10
Round  16, Train loss: 1.480, Test loss: 1.511, Test accuracy: 42.22
Round  16, Global train loss: 1.480, Global test loss: 2.126, Global test accuracy: 25.92
Round  17, Train loss: 1.744, Test loss: 1.524, Test accuracy: 41.92
Round  17, Global train loss: 1.744, Global test loss: 2.214, Global test accuracy: 11.80
Round  18, Train loss: 1.771, Test loss: 1.522, Test accuracy: 41.94
Round  18, Global train loss: 1.771, Global test loss: 2.141, Global test accuracy: 28.70
Round  19, Train loss: 1.536, Test loss: 1.513, Test accuracy: 42.66
Round  19, Global train loss: 1.536, Global test loss: 2.251, Global test accuracy: 21.44
Round  20, Train loss: 1.669, Test loss: 1.515, Test accuracy: 42.28
Round  20, Global train loss: 1.669, Global test loss: 2.179, Global test accuracy: 23.80
Round  21, Train loss: 1.703, Test loss: 1.524, Test accuracy: 41.66
Round  21, Global train loss: 1.703, Global test loss: 2.375, Global test accuracy: 11.20
Round  22, Train loss: 1.796, Test loss: 1.537, Test accuracy: 41.18
Round  22, Global train loss: 1.796, Global test loss: 2.247, Global test accuracy: 21.00
Round  23, Train loss: 1.392, Test loss: 1.508, Test accuracy: 41.82
Round  23, Global train loss: 1.392, Global test loss: 2.039, Global test accuracy: 26.86
Round  24, Train loss: 1.215, Test loss: 1.536, Test accuracy: 41.02
Round  24, Global train loss: 1.215, Global test loss: 2.007, Global test accuracy: 30.94
Round  25, Train loss: 1.618, Test loss: 1.527, Test accuracy: 41.40
Round  25, Global train loss: 1.618, Global test loss: 2.280, Global test accuracy: 17.30
Round  26, Train loss: 1.567, Test loss: 1.538, Test accuracy: 41.58
Round  26, Global train loss: 1.567, Global test loss: 2.120, Global test accuracy: 27.70
Round  27, Train loss: 1.596, Test loss: 1.527, Test accuracy: 43.02
Round  27, Global train loss: 1.596, Global test loss: 2.259, Global test accuracy: 16.10
Round  28, Train loss: 1.801, Test loss: 1.522, Test accuracy: 42.66
Round  28, Global train loss: 1.801, Global test loss: 2.173, Global test accuracy: 21.88
Round  29, Train loss: 1.614, Test loss: 1.521, Test accuracy: 43.46
Round  29, Global train loss: 1.614, Global test loss: 2.177, Global test accuracy: 23.50
Round  30, Train loss: 1.721, Test loss: 1.541, Test accuracy: 41.82
Round  30, Global train loss: 1.721, Global test loss: 2.212, Global test accuracy: 19.12
Round  31, Train loss: 1.268, Test loss: 1.535, Test accuracy: 41.68
Round  31, Global train loss: 1.268, Global test loss: 2.170, Global test accuracy: 20.44
Round  32, Train loss: 1.471, Test loss: 1.514, Test accuracy: 41.46
Round  32, Global train loss: 1.471, Global test loss: 2.184, Global test accuracy: 21.54
Round  33, Train loss: 1.625, Test loss: 1.527, Test accuracy: 40.98
Round  33, Global train loss: 1.625, Global test loss: 2.257, Global test accuracy: 19.70
Round  34, Train loss: 1.581, Test loss: 1.529, Test accuracy: 40.92
Round  34, Global train loss: 1.581, Global test loss: 2.209, Global test accuracy: 10.98
Round  35, Train loss: 1.486, Test loss: 1.527, Test accuracy: 40.96
Round  35, Global train loss: 1.486, Global test loss: 2.134, Global test accuracy: 24.74
Round  36, Train loss: 1.450, Test loss: 1.548, Test accuracy: 39.52
Round  36, Global train loss: 1.450, Global test loss: 2.125, Global test accuracy: 26.20
Round  37, Train loss: 1.573, Test loss: 1.570, Test accuracy: 39.32
Round  37, Global train loss: 1.573, Global test loss: 2.296, Global test accuracy: 20.54
Round  38, Train loss: 1.427, Test loss: 1.559, Test accuracy: 40.32
Round  38, Global train loss: 1.427, Global test loss: 2.101, Global test accuracy: 28.04
Round  39, Train loss: 1.347, Test loss: 1.581, Test accuracy: 40.74
Round  39, Global train loss: 1.347, Global test loss: 2.162, Global test accuracy: 27.28
Round  40, Train loss: 1.432, Test loss: 1.569, Test accuracy: 39.84
Round  40, Global train loss: 1.432, Global test loss: 2.138, Global test accuracy: 22.40
Round  41, Train loss: 1.199, Test loss: 1.579, Test accuracy: 39.38
Round  41, Global train loss: 1.199, Global test loss: 2.112, Global test accuracy: 25.34
Round  42, Train loss: 1.491, Test loss: 1.601, Test accuracy: 40.02
Round  42, Global train loss: 1.491, Global test loss: 2.553, Global test accuracy: 19.80
Round  43, Train loss: 1.565, Test loss: 1.596, Test accuracy: 39.98
Round  43, Global train loss: 1.565, Global test loss: 2.454, Global test accuracy: 10.40
Round  44, Train loss: 1.516, Test loss: 1.612, Test accuracy: 40.30
Round  44, Global train loss: 1.516, Global test loss: 2.178, Global test accuracy: 22.46
Round  45, Train loss: 1.203, Test loss: 1.630, Test accuracy: 39.66
Round  45, Global train loss: 1.203, Global test loss: 2.260, Global test accuracy: 25.18
Round  46, Train loss: 1.200, Test loss: 1.633, Test accuracy: 40.80
Round  46, Global train loss: 1.200, Global test loss: 2.104, Global test accuracy: 26.02
Round  47, Train loss: 1.271, Test loss: 1.678, Test accuracy: 40.04
Round  47, Global train loss: 1.271, Global test loss: 2.116, Global test accuracy: 25.50
Round  48, Train loss: 1.336, Test loss: 1.689, Test accuracy: 38.24
Round  48, Global train loss: 1.336, Global test loss: 2.197, Global test accuracy: 21.20
Round  49, Train loss: 0.960, Test loss: 1.690, Test accuracy: 38.90
Round  49, Global train loss: 0.960, Global test loss: 2.188, Global test accuracy: 32.88
Round  50, Train loss: 1.119, Test loss: 1.692, Test accuracy: 39.34
Round  50, Global train loss: 1.119, Global test loss: 2.261, Global test accuracy: 22.34
Round  51, Train loss: 1.095, Test loss: 1.685, Test accuracy: 38.62
Round  51, Global train loss: 1.095, Global test loss: 2.140, Global test accuracy: 20.96
Round  52, Train loss: 1.304, Test loss: 1.692, Test accuracy: 39.22
Round  52, Global train loss: 1.304, Global test loss: 2.311, Global test accuracy: 15.00
Round  53, Train loss: 1.167, Test loss: 1.738, Test accuracy: 38.64
Round  53, Global train loss: 1.167, Global test loss: 2.151, Global test accuracy: 24.58
Round  54, Train loss: 1.147, Test loss: 1.747, Test accuracy: 39.20
Round  54, Global train loss: 1.147, Global test loss: 2.067, Global test accuracy: 32.74
Round  55, Train loss: 1.333, Test loss: 1.784, Test accuracy: 39.16
Round  55, Global train loss: 1.333, Global test loss: 2.366, Global test accuracy: 17.30
Round  56, Train loss: 0.896, Test loss: 1.817, Test accuracy: 39.50
Round  56, Global train loss: 0.896, Global test loss: 2.112, Global test accuracy: 24.34
Round  57, Train loss: 1.231, Test loss: 1.821, Test accuracy: 39.58
Round  57, Global train loss: 1.231, Global test loss: 2.416, Global test accuracy: 14.40
Round  58, Train loss: 1.094, Test loss: 1.832, Test accuracy: 39.30
Round  58, Global train loss: 1.094, Global test loss: 2.020, Global test accuracy: 30.28
Round  59, Train loss: 0.897, Test loss: 1.850, Test accuracy: 39.70
Round  59, Global train loss: 0.897, Global test loss: 2.159, Global test accuracy: 33.62
Round  60, Train loss: 1.023, Test loss: 1.899, Test accuracy: 38.36
Round  60, Global train loss: 1.023, Global test loss: 2.228, Global test accuracy: 23.28
Round  61, Train loss: 1.327, Test loss: 1.905, Test accuracy: 38.32
Round  61, Global train loss: 1.327, Global test loss: 2.450, Global test accuracy: 11.00
Round  62, Train loss: 1.130, Test loss: 1.964, Test accuracy: 38.26
Round  62, Global train loss: 1.130, Global test loss: 2.357, Global test accuracy: 16.40
Round  63, Train loss: 1.072, Test loss: 1.970, Test accuracy: 37.94
Round  63, Global train loss: 1.072, Global test loss: 2.278, Global test accuracy: 21.44
Round  64, Train loss: 0.911, Test loss: 2.013, Test accuracy: 37.12
Round  64, Global train loss: 0.911, Global test loss: 2.199, Global test accuracy: 19.30
Round  65, Train loss: 1.090, Test loss: 2.053, Test accuracy: 36.66
Round  65, Global train loss: 1.090, Global test loss: 2.404, Global test accuracy: 13.06
Round  66, Train loss: 0.958, Test loss: 2.085, Test accuracy: 37.16
Round  66, Global train loss: 0.958, Global test loss: 2.456, Global test accuracy: 11.24
Round  67, Train loss: 0.873, Test loss: 2.144, Test accuracy: 36.98
Round  67, Global train loss: 0.873, Global test loss: 2.070, Global test accuracy: 26.04
Round  68, Train loss: 0.979, Test loss: 2.135, Test accuracy: 37.14
Round  68, Global train loss: 0.979, Global test loss: 2.330, Global test accuracy: 12.90
Round  69, Train loss: 0.835, Test loss: 2.176, Test accuracy: 36.64
Round  69, Global train loss: 0.835, Global test loss: 2.105, Global test accuracy: 31.66
Round  70, Train loss: 0.838, Test loss: 2.211, Test accuracy: 36.92
Round  70, Global train loss: 0.838, Global test loss: 2.129, Global test accuracy: 27.06
Round  71, Train loss: 0.848, Test loss: 2.175, Test accuracy: 37.62
Round  71, Global train loss: 0.848, Global test loss: 2.249, Global test accuracy: 18.54
Round  72, Train loss: 0.554, Test loss: 2.239, Test accuracy: 38.12
Round  72, Global train loss: 0.554, Global test loss: 2.122, Global test accuracy: 24.96
Round  73, Train loss: 0.801, Test loss: 2.268, Test accuracy: 37.68
Round  73, Global train loss: 0.801, Global test loss: 2.229, Global test accuracy: 26.60
Round  74, Train loss: 0.984, Test loss: 2.293, Test accuracy: 37.22
Round  74, Global train loss: 0.984, Global test loss: 2.326, Global test accuracy: 19.36
Round  75, Train loss: 0.744, Test loss: 2.299, Test accuracy: 37.24
Round  75, Global train loss: 0.744, Global test loss: 2.213, Global test accuracy: 24.80
Round  76, Train loss: 0.691, Test loss: 2.298, Test accuracy: 37.10
Round  76, Global train loss: 0.691, Global test loss: 2.322, Global test accuracy: 14.96
Round  77, Train loss: 0.652, Test loss: 2.402, Test accuracy: 37.10
Round  77, Global train loss: 0.652, Global test loss: 2.186, Global test accuracy: 25.10
Round  78, Train loss: 0.695, Test loss: 2.464, Test accuracy: 36.52
Round  78, Global train loss: 0.695, Global test loss: 2.046, Global test accuracy: 28.42
Round  79, Train loss: 0.526, Test loss: 2.511, Test accuracy: 36.94
Round  79, Global train loss: 0.526, Global test loss: 2.131, Global test accuracy: 30.12
Round  80, Train loss: 0.637, Test loss: 2.540, Test accuracy: 37.74
Round  80, Global train loss: 0.637, Global test loss: 2.286, Global test accuracy: 17.84
Round  81, Train loss: 0.632, Test loss: 2.568, Test accuracy: 37.14
Round  81, Global train loss: 0.632, Global test loss: 2.410, Global test accuracy: 16.58
Round  82, Train loss: 0.521, Test loss: 2.669, Test accuracy: 36.72
Round  82, Global train loss: 0.521, Global test loss: 2.111, Global test accuracy: 25.06
Round  83, Train loss: 0.550, Test loss: 2.745, Test accuracy: 36.62
Round  83, Global train loss: 0.550, Global test loss: 2.167, Global test accuracy: 25.06
Round  84, Train loss: 0.638, Test loss: 2.725, Test accuracy: 35.92
Round  84, Global train loss: 0.638, Global test loss: 2.389, Global test accuracy: 15.20
Round  85, Train loss: 0.429, Test loss: 2.874, Test accuracy: 35.30
Round  85, Global train loss: 0.429, Global test loss: 2.270, Global test accuracy: 16.14
Round  86, Train loss: 0.509, Test loss: 2.909, Test accuracy: 35.52
Round  86, Global train loss: 0.509, Global test loss: 2.223, Global test accuracy: 20.96
Round  87, Train loss: 0.754, Test loss: 2.875, Test accuracy: 35.52
Round  87, Global train loss: 0.754, Global test loss: 2.285, Global test accuracy: 13.24
Round  88, Train loss: 0.510, Test loss: 2.941, Test accuracy: 35.50
Round  88, Global train loss: 0.510, Global test loss: 2.062, Global test accuracy: 28.60
Round  89, Train loss: 0.515, Test loss: 2.931, Test accuracy: 34.98
Round  89, Global train loss: 0.515, Global test loss: 2.363, Global test accuracy: 11.40
Round  90, Train loss: 0.367, Test loss: 2.982, Test accuracy: 34.44
Round  90, Global train loss: 0.367, Global test loss: 2.299, Global test accuracy: 30.74
Round  91, Train loss: 0.685, Test loss: 3.026, Test accuracy: 35.16
Round  91, Global train loss: 0.685, Global test loss: 2.567, Global test accuracy: 12.82
Round  92, Train loss: 0.730, Test loss: 3.027, Test accuracy: 35.06
Round  92, Global train loss: 0.730, Global test loss: 2.097, Global test accuracy: 25.40
Round  93, Train loss: 0.506, Test loss: 3.031, Test accuracy: 35.80
Round  93, Global train loss: 0.506, Global test loss: 2.223, Global test accuracy: 20.14
Round  94, Train loss: 0.387, Test loss: 2.980, Test accuracy: 36.14
Round  94, Global train loss: 0.387, Global test loss: 2.203, Global test accuracy: 20.30
Round  95, Train loss: 0.355, Test loss: 3.109, Test accuracy: 35.78
Round  95, Global train loss: 0.355, Global test loss: 2.115, Global test accuracy: 25.30
Round  96, Train loss: 0.387, Test loss: 3.119, Test accuracy: 35.76
Round  96, Global train loss: 0.387, Global test loss: 2.122, Global test accuracy: 24.78
Round  97, Train loss: 0.544, Test loss: 3.161, Test accuracy: 36.04
Round  97, Global train loss: 0.544, Global test loss: 2.467, Global test accuracy: 11.08
Round  98, Train loss: 0.410, Test loss: 3.152, Test accuracy: 36.24
Round  98, Global train loss: 0.410, Global test loss: 2.084, Global test accuracy: 23.12
Round  99, Train loss: 0.612, Test loss: 3.216, Test accuracy: 35.40
Round  99, Global train loss: 0.612, Global test loss: 2.168, Global test accuracy: 24.70
Final Round, Train loss: 0.411, Test loss: 3.526, Test accuracy: 35.32
Final Round, Global train loss: 0.411, Global test loss: 2.168, Global test accuracy: 24.70
Average accuracy final 10 rounds: 35.582 

Average global accuracy final 10 rounds: 21.838 

795.2873976230621
[1.5276188850402832, 3.0552377700805664, 4.25605845451355, 5.456879138946533, 6.710529088973999, 7.964179039001465, 9.161340951919556, 10.358502864837646, 11.531537771224976, 12.704572677612305, 13.919206619262695, 15.133840560913086, 16.41773748397827, 17.701634407043457, 18.927643060684204, 20.15365171432495, 21.358866453170776, 22.5640811920166, 23.786921501159668, 25.009761810302734, 26.251039505004883, 27.49231719970703, 28.752368211746216, 30.0124192237854, 31.206669807434082, 32.400920391082764, 33.58485960960388, 34.768798828125, 35.98559236526489, 37.202385902404785, 38.414854764938354, 39.627323627471924, 40.78665900230408, 41.94599437713623, 43.155754804611206, 44.36551523208618, 45.55511140823364, 46.7447075843811, 47.89419770240784, 49.04368782043457, 50.250415086746216, 51.45714235305786, 52.70334768295288, 53.9495530128479, 55.2289183139801, 56.508283615112305, 57.74525690078735, 58.9822301864624, 60.167601108551025, 61.35297203063965, 62.542914628982544, 63.73285722732544, 64.92256116867065, 66.11226511001587, 67.33969140052795, 68.56711769104004, 69.74622297286987, 70.9253282546997, 72.11240410804749, 73.29947996139526, 74.52761936187744, 75.75575876235962, 76.89900612831116, 78.0422534942627, 79.27137780189514, 80.50050210952759, 81.75250339508057, 83.00450468063354, 84.2060124874115, 85.40752029418945, 86.62364888191223, 87.83977746963501, 88.99714279174805, 90.15450811386108, 91.35531044006348, 92.55611276626587, 93.76555347442627, 94.97499418258667, 96.20678353309631, 97.43857288360596, 98.69751238822937, 99.95645189285278, 101.12541604042053, 102.29438018798828, 103.59074568748474, 104.8871111869812, 106.10784006118774, 107.32856893539429, 108.55817437171936, 109.78777980804443, 110.97094464302063, 112.15410947799683, 113.40262722969055, 114.65114498138428, 115.79546046257019, 116.9397759437561, 118.13821506500244, 119.33665418624878, 120.62788438796997, 121.91911458969116, 123.09111762046814, 124.26312065124512, 125.39425778388977, 126.52539491653442, 127.63727855682373, 128.74916219711304, 129.89102029800415, 131.03287839889526, 132.25771141052246, 133.48254442214966, 134.68609356880188, 135.8896427154541, 137.1307361125946, 138.3718295097351, 139.58314180374146, 140.7944540977478, 142.02011275291443, 143.24577140808105, 144.44582653045654, 145.64588165283203, 146.89249348640442, 148.1391053199768, 149.33167362213135, 150.5242419242859, 151.6966037750244, 152.86896562576294, 154.07117700576782, 155.2733883857727, 156.46263766288757, 157.65188694000244, 158.914892911911, 160.17789888381958, 161.39102697372437, 162.60415506362915, 163.79816913604736, 164.99218320846558, 166.2009551525116, 167.40972709655762, 168.63220357894897, 169.85468006134033, 171.03640055656433, 172.21812105178833, 173.47454261779785, 174.73096418380737, 175.8976182937622, 177.06427240371704, 178.31867122650146, 179.5730700492859, 180.75337195396423, 181.93367385864258, 183.19017624855042, 184.44667863845825, 185.70153975486755, 186.95640087127686, 188.15296602249146, 189.34953117370605, 190.5348711013794, 191.72021102905273, 192.87811923027039, 194.03602743148804, 195.29266333580017, 196.5492992401123, 197.73570561408997, 198.92211198806763, 200.07242107391357, 201.22273015975952, 202.41500639915466, 203.6072826385498, 204.77964758872986, 205.9520125389099, 207.14812803268433, 208.34424352645874, 209.50062918663025, 210.65701484680176, 211.8329119682312, 213.00880908966064, 214.22056031227112, 215.4323115348816, 216.58421349525452, 217.73611545562744, 218.93710660934448, 220.13809776306152, 221.3616590499878, 222.58522033691406, 223.80195355415344, 225.01868677139282, 226.19748497009277, 227.37628316879272, 228.63544464111328, 229.89460611343384, 231.13009548187256, 232.36558485031128, 233.63288021087646, 234.90017557144165, 236.115252494812, 237.33032941818237, 238.5528872013092, 239.77544498443604, 241.01567244529724, 242.25589990615845, 244.72281956672668, 247.18973922729492]
[20.38, 20.38, 21.4, 21.4, 33.44, 33.44, 29.3, 29.3, 31.02, 31.02, 33.96, 33.96, 37.86, 37.86, 39.3, 39.3, 39.12, 39.12, 40.74, 40.74, 40.38, 40.38, 40.16, 40.16, 41.44, 41.44, 41.22, 41.22, 41.16, 41.16, 41.88, 41.88, 42.22, 42.22, 41.92, 41.92, 41.94, 41.94, 42.66, 42.66, 42.28, 42.28, 41.66, 41.66, 41.18, 41.18, 41.82, 41.82, 41.02, 41.02, 41.4, 41.4, 41.58, 41.58, 43.02, 43.02, 42.66, 42.66, 43.46, 43.46, 41.82, 41.82, 41.68, 41.68, 41.46, 41.46, 40.98, 40.98, 40.92, 40.92, 40.96, 40.96, 39.52, 39.52, 39.32, 39.32, 40.32, 40.32, 40.74, 40.74, 39.84, 39.84, 39.38, 39.38, 40.02, 40.02, 39.98, 39.98, 40.3, 40.3, 39.66, 39.66, 40.8, 40.8, 40.04, 40.04, 38.24, 38.24, 38.9, 38.9, 39.34, 39.34, 38.62, 38.62, 39.22, 39.22, 38.64, 38.64, 39.2, 39.2, 39.16, 39.16, 39.5, 39.5, 39.58, 39.58, 39.3, 39.3, 39.7, 39.7, 38.36, 38.36, 38.32, 38.32, 38.26, 38.26, 37.94, 37.94, 37.12, 37.12, 36.66, 36.66, 37.16, 37.16, 36.98, 36.98, 37.14, 37.14, 36.64, 36.64, 36.92, 36.92, 37.62, 37.62, 38.12, 38.12, 37.68, 37.68, 37.22, 37.22, 37.24, 37.24, 37.1, 37.1, 37.1, 37.1, 36.52, 36.52, 36.94, 36.94, 37.74, 37.74, 37.14, 37.14, 36.72, 36.72, 36.62, 36.62, 35.92, 35.92, 35.3, 35.3, 35.52, 35.52, 35.52, 35.52, 35.5, 35.5, 34.98, 34.98, 34.44, 34.44, 35.16, 35.16, 35.06, 35.06, 35.8, 35.8, 36.14, 36.14, 35.78, 35.78, 35.76, 35.76, 36.04, 36.04, 36.24, 36.24, 35.4, 35.4, 35.32, 35.32]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.044, Test loss: 2.192, Test accuracy: 12.10
Round   0, Global train loss: 2.044, Global test loss: 2.320, Global test accuracy: 10.00
Round   1, Train loss: 1.856, Test loss: 2.193, Test accuracy: 16.20
Round   1, Global train loss: 1.856, Global test loss: 2.524, Global test accuracy: 10.00
Round   2, Train loss: 1.970, Test loss: 2.015, Test accuracy: 22.94
Round   2, Global train loss: 1.970, Global test loss: 2.289, Global test accuracy: 15.78
Round   3, Train loss: 1.815, Test loss: 1.879, Test accuracy: 25.38
Round   3, Global train loss: 1.815, Global test loss: 2.283, Global test accuracy: 15.04
Round   4, Train loss: 1.953, Test loss: 1.839, Test accuracy: 28.60
Round   4, Global train loss: 1.953, Global test loss: 2.249, Global test accuracy: 20.76
Round   5, Train loss: 1.840, Test loss: 1.837, Test accuracy: 29.24
Round   5, Global train loss: 1.840, Global test loss: 2.214, Global test accuracy: 20.60
Round   6, Train loss: 1.865, Test loss: 1.656, Test accuracy: 36.38
Round   6, Global train loss: 1.865, Global test loss: 2.194, Global test accuracy: 27.80
Round   7, Train loss: 1.766, Test loss: 1.658, Test accuracy: 36.56
Round   7, Global train loss: 1.766, Global test loss: 2.056, Global test accuracy: 26.50
Round   8, Train loss: 1.783, Test loss: 1.640, Test accuracy: 39.32
Round   8, Global train loss: 1.783, Global test loss: 2.213, Global test accuracy: 25.02
Round   9, Train loss: 1.781, Test loss: 1.613, Test accuracy: 40.54
Round   9, Global train loss: 1.781, Global test loss: 2.023, Global test accuracy: 28.84
Round  10, Train loss: 1.853, Test loss: 1.580, Test accuracy: 41.02
Round  10, Global train loss: 1.853, Global test loss: 1.938, Global test accuracy: 34.52
Round  11, Train loss: 1.901, Test loss: 1.573, Test accuracy: 40.04
Round  11, Global train loss: 1.901, Global test loss: 2.081, Global test accuracy: 27.50
Round  12, Train loss: 1.770, Test loss: 1.554, Test accuracy: 43.18
Round  12, Global train loss: 1.770, Global test loss: 2.056, Global test accuracy: 24.50
Round  13, Train loss: 1.768, Test loss: 1.571, Test accuracy: 44.22
Round  13, Global train loss: 1.768, Global test loss: 2.083, Global test accuracy: 31.00
Round  14, Train loss: 1.701, Test loss: 1.561, Test accuracy: 42.46
Round  14, Global train loss: 1.701, Global test loss: 1.991, Global test accuracy: 31.58
Round  15, Train loss: 1.793, Test loss: 1.551, Test accuracy: 42.88
Round  15, Global train loss: 1.793, Global test loss: 1.964, Global test accuracy: 36.06
Round  16, Train loss: 1.701, Test loss: 1.554, Test accuracy: 43.98
Round  16, Global train loss: 1.701, Global test loss: 1.954, Global test accuracy: 34.44
Round  17, Train loss: 1.671, Test loss: 1.551, Test accuracy: 46.78
Round  17, Global train loss: 1.671, Global test loss: 1.918, Global test accuracy: 36.72
Round  18, Train loss: 1.606, Test loss: 1.535, Test accuracy: 46.12
Round  18, Global train loss: 1.606, Global test loss: 1.942, Global test accuracy: 36.12
Round  19, Train loss: 1.844, Test loss: 1.532, Test accuracy: 45.74
Round  19, Global train loss: 1.844, Global test loss: 2.176, Global test accuracy: 24.48
Round  20, Train loss: 1.837, Test loss: 1.533, Test accuracy: 45.86
Round  20, Global train loss: 1.837, Global test loss: 1.940, Global test accuracy: 35.82
Round  21, Train loss: 1.659, Test loss: 1.526, Test accuracy: 46.74
Round  21, Global train loss: 1.659, Global test loss: 2.037, Global test accuracy: 30.80
Round  22, Train loss: 1.697, Test loss: 1.519, Test accuracy: 47.12
Round  22, Global train loss: 1.697, Global test loss: 1.912, Global test accuracy: 36.36
Round  23, Train loss: 1.558, Test loss: 1.509, Test accuracy: 48.58
Round  23, Global train loss: 1.558, Global test loss: 1.795, Global test accuracy: 36.94
Round  24, Train loss: 1.585, Test loss: 1.488, Test accuracy: 49.10
Round  24, Global train loss: 1.585, Global test loss: 1.789, Global test accuracy: 44.70
Round  25, Train loss: 1.590, Test loss: 1.488, Test accuracy: 48.60
Round  25, Global train loss: 1.590, Global test loss: 1.917, Global test accuracy: 36.84
Round  26, Train loss: 1.570, Test loss: 1.496, Test accuracy: 49.20
Round  26, Global train loss: 1.570, Global test loss: 1.820, Global test accuracy: 40.76
Round  27, Train loss: 1.635, Test loss: 1.460, Test accuracy: 50.96
Round  27, Global train loss: 1.635, Global test loss: 1.833, Global test accuracy: 40.24
Round  28, Train loss: 1.618, Test loss: 1.452, Test accuracy: 50.02
Round  28, Global train loss: 1.618, Global test loss: 1.881, Global test accuracy: 37.64
Round  29, Train loss: 1.748, Test loss: 1.445, Test accuracy: 49.14
Round  29, Global train loss: 1.748, Global test loss: 1.856, Global test accuracy: 39.36
Round  30, Train loss: 1.648, Test loss: 1.447, Test accuracy: 48.34
Round  30, Global train loss: 1.648, Global test loss: 2.029, Global test accuracy: 31.58
Round  31, Train loss: 1.687, Test loss: 1.450, Test accuracy: 47.66
Round  31, Global train loss: 1.687, Global test loss: 2.016, Global test accuracy: 31.10
Round  32, Train loss: 1.483, Test loss: 1.437, Test accuracy: 49.02
Round  32, Global train loss: 1.483, Global test loss: 1.868, Global test accuracy: 39.98
Round  33, Train loss: 1.538, Test loss: 1.452, Test accuracy: 47.80
Round  33, Global train loss: 1.538, Global test loss: 1.957, Global test accuracy: 32.68
Round  34, Train loss: 1.392, Test loss: 1.438, Test accuracy: 48.38
Round  34, Global train loss: 1.392, Global test loss: 1.757, Global test accuracy: 40.14
Round  35, Train loss: 1.610, Test loss: 1.442, Test accuracy: 48.20
Round  35, Global train loss: 1.610, Global test loss: 1.831, Global test accuracy: 40.32
Round  36, Train loss: 1.466, Test loss: 1.445, Test accuracy: 47.98
Round  36, Global train loss: 1.466, Global test loss: 1.970, Global test accuracy: 33.14
Round  37, Train loss: 1.473, Test loss: 1.449, Test accuracy: 47.88
Round  37, Global train loss: 1.473, Global test loss: 1.902, Global test accuracy: 35.50
Round  38, Train loss: 1.534, Test loss: 1.479, Test accuracy: 45.64
Round  38, Global train loss: 1.534, Global test loss: 2.088, Global test accuracy: 31.08
Round  39, Train loss: 1.513, Test loss: 1.486, Test accuracy: 46.40
Round  39, Global train loss: 1.513, Global test loss: 2.176, Global test accuracy: 26.02
Round  40, Train loss: 1.481, Test loss: 1.488, Test accuracy: 47.06
Round  40, Global train loss: 1.481, Global test loss: 2.060, Global test accuracy: 30.48
Round  41, Train loss: 1.415, Test loss: 1.498, Test accuracy: 46.22
Round  41, Global train loss: 1.415, Global test loss: 2.009, Global test accuracy: 32.14
Round  42, Train loss: 1.427, Test loss: 1.493, Test accuracy: 46.16
Round  42, Global train loss: 1.427, Global test loss: 2.262, Global test accuracy: 29.50
Round  43, Train loss: 1.462, Test loss: 1.506, Test accuracy: 45.66
Round  43, Global train loss: 1.462, Global test loss: 2.235, Global test accuracy: 27.74
Round  44, Train loss: 1.286, Test loss: 1.529, Test accuracy: 45.20
Round  44, Global train loss: 1.286, Global test loss: 1.937, Global test accuracy: 36.54
Round  45, Train loss: 1.367, Test loss: 1.547, Test accuracy: 43.90
Round  45, Global train loss: 1.367, Global test loss: 2.243, Global test accuracy: 32.70
Round  46, Train loss: 1.361, Test loss: 1.546, Test accuracy: 44.30
Round  46, Global train loss: 1.361, Global test loss: 2.161, Global test accuracy: 32.02
Round  47, Train loss: 1.371, Test loss: 1.590, Test accuracy: 42.52
Round  47, Global train loss: 1.371, Global test loss: 2.100, Global test accuracy: 29.74
Round  48, Train loss: 1.348, Test loss: 1.622, Test accuracy: 41.44
Round  48, Global train loss: 1.348, Global test loss: 2.030, Global test accuracy: 31.12
Round  49, Train loss: 1.245, Test loss: 1.623, Test accuracy: 43.02
Round  49, Global train loss: 1.245, Global test loss: 1.974, Global test accuracy: 38.64
Round  50, Train loss: 1.314, Test loss: 1.611, Test accuracy: 44.64
Round  50, Global train loss: 1.314, Global test loss: 2.248, Global test accuracy: 30.74
Round  51, Train loss: 1.336, Test loss: 1.650, Test accuracy: 44.80
Round  51, Global train loss: 1.336, Global test loss: 2.237, Global test accuracy: 26.24
Round  52, Train loss: 1.263, Test loss: 1.685, Test accuracy: 43.84
Round  52, Global train loss: 1.263, Global test loss: 2.197, Global test accuracy: 29.48
Round  53, Train loss: 1.255, Test loss: 1.698, Test accuracy: 44.02
Round  53, Global train loss: 1.255, Global test loss: 2.033, Global test accuracy: 30.78
Round  54, Train loss: 1.100, Test loss: 1.682, Test accuracy: 44.26
Round  54, Global train loss: 1.100, Global test loss: 2.101, Global test accuracy: 35.64
Round  55, Train loss: 1.198, Test loss: 1.737, Test accuracy: 42.84
Round  55, Global train loss: 1.198, Global test loss: 2.319, Global test accuracy: 31.82
Round  56, Train loss: 1.096, Test loss: 1.750, Test accuracy: 42.78
Round  56, Global train loss: 1.096, Global test loss: 2.209, Global test accuracy: 30.16
Round  57, Train loss: 1.198, Test loss: 1.732, Test accuracy: 42.82
Round  57, Global train loss: 1.198, Global test loss: 2.201, Global test accuracy: 30.82
Round  58, Train loss: 0.917, Test loss: 1.749, Test accuracy: 43.12
Round  58, Global train loss: 0.917, Global test loss: 2.072, Global test accuracy: 37.30
Round  59, Train loss: 1.186, Test loss: 1.807, Test accuracy: 41.80
Round  59, Global train loss: 1.186, Global test loss: 2.330, Global test accuracy: 31.88
Round  60, Train loss: 1.243, Test loss: 1.809, Test accuracy: 41.88
Round  60, Global train loss: 1.243, Global test loss: 2.041, Global test accuracy: 33.36
Round  61, Train loss: 1.022, Test loss: 1.877, Test accuracy: 40.92
Round  61, Global train loss: 1.022, Global test loss: 2.257, Global test accuracy: 30.92
Round  62, Train loss: 1.011, Test loss: 1.856, Test accuracy: 41.46
Round  62, Global train loss: 1.011, Global test loss: 2.375, Global test accuracy: 31.82
Round  63, Train loss: 1.054, Test loss: 1.860, Test accuracy: 42.18
Round  63, Global train loss: 1.054, Global test loss: 2.330, Global test accuracy: 32.72
Round  64, Train loss: 0.925, Test loss: 1.933, Test accuracy: 41.20
Round  64, Global train loss: 0.925, Global test loss: 2.369, Global test accuracy: 32.18
Round  65, Train loss: 0.922, Test loss: 1.944, Test accuracy: 40.96
Round  65, Global train loss: 0.922, Global test loss: 2.488, Global test accuracy: 32.12
Round  66, Train loss: 1.148, Test loss: 1.920, Test accuracy: 41.46
Round  66, Global train loss: 1.148, Global test loss: 2.856, Global test accuracy: 24.36
Round  67, Train loss: 0.906, Test loss: 1.959, Test accuracy: 40.32
Round  67, Global train loss: 0.906, Global test loss: 2.219, Global test accuracy: 35.72
Round  68, Train loss: 0.775, Test loss: 2.009, Test accuracy: 38.96
Round  68, Global train loss: 0.775, Global test loss: 2.399, Global test accuracy: 33.20
Round  69, Train loss: 0.847, Test loss: 2.024, Test accuracy: 39.42
Round  69, Global train loss: 0.847, Global test loss: 2.550, Global test accuracy: 29.86
Round  70, Train loss: 0.819, Test loss: 2.046, Test accuracy: 39.16
Round  70, Global train loss: 0.819, Global test loss: 2.391, Global test accuracy: 37.04
Round  71, Train loss: 0.856, Test loss: 2.091, Test accuracy: 39.78
Round  71, Global train loss: 0.856, Global test loss: 2.753, Global test accuracy: 28.42
Round  72, Train loss: 1.007, Test loss: 2.101, Test accuracy: 39.92
Round  72, Global train loss: 1.007, Global test loss: 2.373, Global test accuracy: 31.26
Round  73, Train loss: 0.818, Test loss: 2.135, Test accuracy: 40.32
Round  73, Global train loss: 0.818, Global test loss: 2.707, Global test accuracy: 29.22
Round  74, Train loss: 0.868, Test loss: 2.182, Test accuracy: 40.50
Round  74, Global train loss: 0.868, Global test loss: 2.549, Global test accuracy: 30.96
Round  75, Train loss: 0.655, Test loss: 2.216, Test accuracy: 40.56
Round  75, Global train loss: 0.655, Global test loss: 2.545, Global test accuracy: 37.34
Round  76, Train loss: 0.635, Test loss: 2.254, Test accuracy: 39.94
Round  76, Global train loss: 0.635, Global test loss: 2.861, Global test accuracy: 34.84
Round  77, Train loss: 0.711, Test loss: 2.380, Test accuracy: 38.40
Round  77, Global train loss: 0.711, Global test loss: 2.871, Global test accuracy: 32.68
Round  78, Train loss: 0.611, Test loss: 2.446, Test accuracy: 37.88
Round  78, Global train loss: 0.611, Global test loss: 2.480, Global test accuracy: 36.30
Round  79, Train loss: 0.886, Test loss: 2.462, Test accuracy: 37.78
Round  79, Global train loss: 0.886, Global test loss: 2.536, Global test accuracy: 33.82
Round  80, Train loss: 0.774, Test loss: 2.413, Test accuracy: 38.78
Round  80, Global train loss: 0.774, Global test loss: 2.801, Global test accuracy: 30.78
Round  81, Train loss: 0.547, Test loss: 2.440, Test accuracy: 38.44
Round  81, Global train loss: 0.547, Global test loss: 2.870, Global test accuracy: 32.94
Round  82, Train loss: 0.456, Test loss: 2.376, Test accuracy: 39.10
Round  82, Global train loss: 0.456, Global test loss: 2.594, Global test accuracy: 37.82
Round  83, Train loss: 0.707, Test loss: 2.312, Test accuracy: 40.54
Round  83, Global train loss: 0.707, Global test loss: 3.091, Global test accuracy: 31.58
Round  84, Train loss: 0.711, Test loss: 2.342, Test accuracy: 40.82
Round  84, Global train loss: 0.711, Global test loss: 2.985, Global test accuracy: 31.40
Round  85, Train loss: 0.837, Test loss: 2.366, Test accuracy: 41.02
Round  85, Global train loss: 0.837, Global test loss: 2.763, Global test accuracy: 29.60
Round  86, Train loss: 0.759, Test loss: 2.418, Test accuracy: 39.92
Round  86, Global train loss: 0.759, Global test loss: 2.632, Global test accuracy: 31.66
Round  87, Train loss: 0.772, Test loss: 2.545, Test accuracy: 39.30
Round  87, Global train loss: 0.772, Global test loss: 2.916, Global test accuracy: 28.92
Round  88, Train loss: 0.718, Test loss: 2.557, Test accuracy: 38.68
Round  88, Global train loss: 0.718, Global test loss: 2.488, Global test accuracy: 35.64
Round  89, Train loss: 0.470, Test loss: 2.528, Test accuracy: 38.62
Round  89, Global train loss: 0.470, Global test loss: 2.907, Global test accuracy: 34.00
Round  90, Train loss: 0.699, Test loss: 2.512, Test accuracy: 38.82
Round  90, Global train loss: 0.699, Global test loss: 2.599, Global test accuracy: 36.16
Round  91, Train loss: 0.689, Test loss: 2.509, Test accuracy: 38.90
Round  91, Global train loss: 0.689, Global test loss: 3.048, Global test accuracy: 28.92
Round  92, Train loss: 0.727, Test loss: 2.589, Test accuracy: 38.68
Round  92, Global train loss: 0.727, Global test loss: 2.762, Global test accuracy: 30.76
Round  93, Train loss: 0.476, Test loss: 2.615, Test accuracy: 38.66
Round  93, Global train loss: 0.476, Global test loss: 3.012, Global test accuracy: 32.92
Round  94, Train loss: 0.622, Test loss: 2.654, Test accuracy: 37.98
Round  94, Global train loss: 0.622, Global test loss: 3.037, Global test accuracy: 30.24
Round  95, Train loss: 0.755, Test loss: 2.687, Test accuracy: 38.24
Round  95, Global train loss: 0.755, Global test loss: 2.775, Global test accuracy: 28.68
Round  96, Train loss: 0.454, Test loss: 2.695, Test accuracy: 38.22
Round  96, Global train loss: 0.454, Global test loss: 3.083, Global test accuracy: 29.54
Round  97, Train loss: 0.815, Test loss: 2.663, Test accuracy: 38.40
Round  97, Global train loss: 0.815, Global test loss: 3.425, Global test accuracy: 22.62
Round  98, Train loss: 0.485, Test loss: 2.693, Test accuracy: 38.10
Round  98, Global train loss: 0.485, Global test loss: 3.090, Global test accuracy: 31.80
Round  99, Train loss: 0.706, Test loss: 2.696, Test accuracy: 39.12
Round  99, Global train loss: 0.706, Global test loss: 2.848, Global test accuracy: 29.02
Final Round, Train loss: 0.476, Test loss: 2.985, Test accuracy: 39.66
Final Round, Global train loss: 0.476, Global test loss: 2.848, Global test accuracy: 29.02
Average accuracy final 10 rounds: 38.512 

Average global accuracy final 10 rounds: 30.066 

783.6014904975891
[1.4866032600402832, 2.9732065200805664, 4.1736979484558105, 5.374189376831055, 6.49281644821167, 7.611443519592285, 8.729661703109741, 9.847879886627197, 10.955051183700562, 12.062222480773926, 13.263128519058228, 14.46403455734253, 15.616410493850708, 16.768786430358887, 17.92406988143921, 19.07935333251953, 20.18841791152954, 21.29748249053955, 22.427233695983887, 23.556984901428223, 24.77564764022827, 25.99431037902832, 27.17707371711731, 28.3598370552063, 29.610461950302124, 30.86108684539795, 32.05792021751404, 33.25475358963013, 34.413827419281006, 35.572901248931885, 36.72771167755127, 37.882522106170654, 39.04724955558777, 40.21197700500488, 41.451422929763794, 42.690868854522705, 43.869487285614014, 45.04810571670532, 46.290783166885376, 47.53346061706543, 48.677417039871216, 49.821373462677, 50.9882173538208, 52.1550612449646, 53.33463764190674, 54.51421403884888, 55.74142909049988, 56.96864414215088, 58.131787061691284, 59.29492998123169, 60.43063998222351, 61.56634998321533, 62.75862765312195, 63.950905323028564, 65.19617986679077, 66.44145441055298, 67.65317940711975, 68.86490440368652, 70.06088829040527, 71.25687217712402, 72.40150141716003, 73.54613065719604, 74.74379563331604, 75.94146060943604, 77.10987854003906, 78.27829647064209, 79.5187439918518, 80.75919151306152, 81.92450594902039, 83.08982038497925, 84.30730175971985, 85.52478313446045, 86.686363697052, 87.84794425964355, 89.00508975982666, 90.16223526000977, 91.29083967208862, 92.41944408416748, 93.6460952758789, 94.87274646759033, 96.05924677848816, 97.24574708938599, 98.40024375915527, 99.55474042892456, 100.73822784423828, 101.921715259552, 103.09845614433289, 104.27519702911377, 105.44717144966125, 106.61914587020874, 107.7655577659607, 108.91196966171265, 110.0373318195343, 111.16269397735596, 112.35497045516968, 113.5472469329834, 114.73766660690308, 115.92808628082275, 117.12341094017029, 118.31873559951782, 119.52619934082031, 120.7336630821228, 121.85431718826294, 122.97497129440308, 124.12321281433105, 125.27145433425903, 126.45292234420776, 127.6343903541565, 128.81357288360596, 129.99275541305542, 131.22007250785828, 132.44738960266113, 133.70328187942505, 134.95917415618896, 136.1244921684265, 137.28981018066406, 138.4916434288025, 139.69347667694092, 140.82470083236694, 141.95592498779297, 143.13390803337097, 144.31189107894897, 145.43639159202576, 146.56089210510254, 147.7497594356537, 148.93862676620483, 150.0491418838501, 151.15965700149536, 152.2732231616974, 153.3867893218994, 154.50760912895203, 155.62842893600464, 156.7310311794281, 157.83363342285156, 158.92980766296387, 160.02598190307617, 161.23399829864502, 162.44201469421387, 163.64339065551758, 164.8447666168213, 165.99177050590515, 167.138774394989, 168.36694025993347, 169.59510612487793, 170.78236889839172, 171.96963167190552, 173.08482670783997, 174.2000217437744, 175.38889837265015, 176.57777500152588, 177.72381925582886, 178.86986351013184, 180.02174878120422, 181.1736340522766, 182.30403017997742, 183.43442630767822, 184.62185621261597, 185.8092861175537, 186.9918396472931, 188.17439317703247, 189.32413387298584, 190.4738745689392, 191.66160798072815, 192.8493413925171, 193.99654865264893, 195.14375591278076, 196.2704198360443, 197.39708375930786, 198.6359145641327, 199.87474536895752, 201.06975865364075, 202.26477193832397, 203.4463930130005, 204.628014087677, 205.97338128089905, 207.3187484741211, 208.5876054763794, 209.8564624786377, 211.06421542167664, 212.27196836471558, 213.47014451026917, 214.66832065582275, 215.86671781539917, 217.0651149749756, 218.2654628753662, 219.46581077575684, 220.66860699653625, 221.87140321731567, 223.10165667533875, 224.33191013336182, 225.5811927318573, 226.83047533035278, 228.0071737766266, 229.1838722229004, 230.33144807815552, 231.47902393341064, 232.71300268173218, 233.9469814300537, 235.1005117893219, 236.2540421485901, 238.65974831581116, 241.06545448303223]
[12.1, 12.1, 16.2, 16.2, 22.94, 22.94, 25.38, 25.38, 28.6, 28.6, 29.24, 29.24, 36.38, 36.38, 36.56, 36.56, 39.32, 39.32, 40.54, 40.54, 41.02, 41.02, 40.04, 40.04, 43.18, 43.18, 44.22, 44.22, 42.46, 42.46, 42.88, 42.88, 43.98, 43.98, 46.78, 46.78, 46.12, 46.12, 45.74, 45.74, 45.86, 45.86, 46.74, 46.74, 47.12, 47.12, 48.58, 48.58, 49.1, 49.1, 48.6, 48.6, 49.2, 49.2, 50.96, 50.96, 50.02, 50.02, 49.14, 49.14, 48.34, 48.34, 47.66, 47.66, 49.02, 49.02, 47.8, 47.8, 48.38, 48.38, 48.2, 48.2, 47.98, 47.98, 47.88, 47.88, 45.64, 45.64, 46.4, 46.4, 47.06, 47.06, 46.22, 46.22, 46.16, 46.16, 45.66, 45.66, 45.2, 45.2, 43.9, 43.9, 44.3, 44.3, 42.52, 42.52, 41.44, 41.44, 43.02, 43.02, 44.64, 44.64, 44.8, 44.8, 43.84, 43.84, 44.02, 44.02, 44.26, 44.26, 42.84, 42.84, 42.78, 42.78, 42.82, 42.82, 43.12, 43.12, 41.8, 41.8, 41.88, 41.88, 40.92, 40.92, 41.46, 41.46, 42.18, 42.18, 41.2, 41.2, 40.96, 40.96, 41.46, 41.46, 40.32, 40.32, 38.96, 38.96, 39.42, 39.42, 39.16, 39.16, 39.78, 39.78, 39.92, 39.92, 40.32, 40.32, 40.5, 40.5, 40.56, 40.56, 39.94, 39.94, 38.4, 38.4, 37.88, 37.88, 37.78, 37.78, 38.78, 38.78, 38.44, 38.44, 39.1, 39.1, 40.54, 40.54, 40.82, 40.82, 41.02, 41.02, 39.92, 39.92, 39.3, 39.3, 38.68, 38.68, 38.62, 38.62, 38.82, 38.82, 38.9, 38.9, 38.68, 38.68, 38.66, 38.66, 37.98, 37.98, 38.24, 38.24, 38.22, 38.22, 38.4, 38.4, 38.1, 38.1, 39.12, 39.12, 39.66, 39.66]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.989, Test loss: 2.201, Test accuracy: 12.86
Round   0, Global train loss: 1.989, Global test loss: 2.315, Global test accuracy: 10.00
Round   1, Train loss: 1.878, Test loss: 2.111, Test accuracy: 19.30
Round   1, Global train loss: 1.878, Global test loss: 2.349, Global test accuracy: 11.26
Round   2, Train loss: 1.881, Test loss: 2.076, Test accuracy: 21.80
Round   2, Global train loss: 1.881, Global test loss: 2.368, Global test accuracy: 12.52
Round   3, Train loss: 1.938, Test loss: 1.875, Test accuracy: 26.26
Round   3, Global train loss: 1.938, Global test loss: 2.250, Global test accuracy: 16.80
Round   4, Train loss: 1.996, Test loss: 1.845, Test accuracy: 29.28
Round   4, Global train loss: 1.996, Global test loss: 2.252, Global test accuracy: 22.10
Round   5, Train loss: 1.843, Test loss: 1.803, Test accuracy: 31.24
Round   5, Global train loss: 1.843, Global test loss: 2.138, Global test accuracy: 24.22
Round   6, Train loss: 1.836, Test loss: 1.675, Test accuracy: 38.38
Round   6, Global train loss: 1.836, Global test loss: 2.044, Global test accuracy: 34.18
Round   7, Train loss: 1.893, Test loss: 1.674, Test accuracy: 37.04
Round   7, Global train loss: 1.893, Global test loss: 2.082, Global test accuracy: 24.82
Round   8, Train loss: 1.891, Test loss: 1.633, Test accuracy: 37.74
Round   8, Global train loss: 1.891, Global test loss: 2.006, Global test accuracy: 32.00
Round   9, Train loss: 1.777, Test loss: 1.626, Test accuracy: 38.60
Round   9, Global train loss: 1.777, Global test loss: 2.186, Global test accuracy: 20.42
Round  10, Train loss: 1.942, Test loss: 1.603, Test accuracy: 40.08
Round  10, Global train loss: 1.942, Global test loss: 2.120, Global test accuracy: 26.52
Round  11, Train loss: 1.913, Test loss: 1.586, Test accuracy: 42.52
Round  11, Global train loss: 1.913, Global test loss: 2.104, Global test accuracy: 30.22
Round  12, Train loss: 1.661, Test loss: 1.556, Test accuracy: 43.66
Round  12, Global train loss: 1.661, Global test loss: 1.965, Global test accuracy: 29.72
Round  13, Train loss: 1.828, Test loss: 1.538, Test accuracy: 44.32
Round  13, Global train loss: 1.828, Global test loss: 2.101, Global test accuracy: 32.98
Round  14, Train loss: 1.690, Test loss: 1.539, Test accuracy: 45.16
Round  14, Global train loss: 1.690, Global test loss: 1.984, Global test accuracy: 31.82
Round  15, Train loss: 1.710, Test loss: 1.518, Test accuracy: 48.62
Round  15, Global train loss: 1.710, Global test loss: 1.926, Global test accuracy: 37.34
Round  16, Train loss: 1.786, Test loss: 1.513, Test accuracy: 47.46
Round  16, Global train loss: 1.786, Global test loss: 2.054, Global test accuracy: 31.28
Round  17, Train loss: 1.686, Test loss: 1.519, Test accuracy: 47.72
Round  17, Global train loss: 1.686, Global test loss: 1.874, Global test accuracy: 41.16
Round  18, Train loss: 1.670, Test loss: 1.507, Test accuracy: 48.56
Round  18, Global train loss: 1.670, Global test loss: 1.936, Global test accuracy: 36.76
Round  19, Train loss: 1.735, Test loss: 1.505, Test accuracy: 48.50
Round  19, Global train loss: 1.735, Global test loss: 1.961, Global test accuracy: 36.30
Round  20, Train loss: 1.736, Test loss: 1.489, Test accuracy: 49.02
Round  20, Global train loss: 1.736, Global test loss: 1.840, Global test accuracy: 41.96
Round  21, Train loss: 1.773, Test loss: 1.485, Test accuracy: 50.14
Round  21, Global train loss: 1.773, Global test loss: 1.949, Global test accuracy: 36.84
Round  22, Train loss: 1.909, Test loss: 1.490, Test accuracy: 49.96
Round  22, Global train loss: 1.909, Global test loss: 1.971, Global test accuracy: 32.56
Round  23, Train loss: 1.747, Test loss: 1.496, Test accuracy: 47.98
Round  23, Global train loss: 1.747, Global test loss: 2.055, Global test accuracy: 26.44
Round  24, Train loss: 1.744, Test loss: 1.490, Test accuracy: 47.14
Round  24, Global train loss: 1.744, Global test loss: 2.061, Global test accuracy: 32.20
Round  25, Train loss: 1.760, Test loss: 1.518, Test accuracy: 45.20
Round  25, Global train loss: 1.760, Global test loss: 1.918, Global test accuracy: 34.78
Round  26, Train loss: 1.589, Test loss: 1.504, Test accuracy: 45.56
Round  26, Global train loss: 1.589, Global test loss: 1.976, Global test accuracy: 36.54
Round  27, Train loss: 1.698, Test loss: 1.491, Test accuracy: 47.56
Round  27, Global train loss: 1.698, Global test loss: 1.831, Global test accuracy: 37.86
Round  28, Train loss: 1.622, Test loss: 1.486, Test accuracy: 47.44
Round  28, Global train loss: 1.622, Global test loss: 1.950, Global test accuracy: 39.58
Round  29, Train loss: 1.655, Test loss: 1.499, Test accuracy: 46.74
Round  29, Global train loss: 1.655, Global test loss: 1.847, Global test accuracy: 40.66
Round  30, Train loss: 1.613, Test loss: 1.505, Test accuracy: 45.86
Round  30, Global train loss: 1.613, Global test loss: 1.998, Global test accuracy: 37.92
Round  31, Train loss: 1.591, Test loss: 1.495, Test accuracy: 46.64
Round  31, Global train loss: 1.591, Global test loss: 1.841, Global test accuracy: 40.26
Round  32, Train loss: 1.645, Test loss: 1.478, Test accuracy: 48.20
Round  32, Global train loss: 1.645, Global test loss: 1.912, Global test accuracy: 37.38
Round  33, Train loss: 1.786, Test loss: 1.473, Test accuracy: 48.62
Round  33, Global train loss: 1.786, Global test loss: 1.935, Global test accuracy: 34.00
Round  34, Train loss: 1.622, Test loss: 1.463, Test accuracy: 48.16
Round  34, Global train loss: 1.622, Global test loss: 1.962, Global test accuracy: 33.58
Round  35, Train loss: 1.404, Test loss: 1.462, Test accuracy: 48.52
Round  35, Global train loss: 1.404, Global test loss: 1.699, Global test accuracy: 45.08
Round  36, Train loss: 1.442, Test loss: 1.469, Test accuracy: 47.64
Round  36, Global train loss: 1.442, Global test loss: 1.845, Global test accuracy: 37.90
Round  37, Train loss: 1.743, Test loss: 1.470, Test accuracy: 47.42
Round  37, Global train loss: 1.743, Global test loss: 1.862, Global test accuracy: 36.48
Round  38, Train loss: 1.652, Test loss: 1.486, Test accuracy: 46.90
Round  38, Global train loss: 1.652, Global test loss: 1.919, Global test accuracy: 35.06
Round  39, Train loss: 1.510, Test loss: 1.502, Test accuracy: 45.72
Round  39, Global train loss: 1.510, Global test loss: 1.886, Global test accuracy: 32.92
Round  40, Train loss: 1.484, Test loss: 1.491, Test accuracy: 45.84
Round  40, Global train loss: 1.484, Global test loss: 1.875, Global test accuracy: 32.76
Round  41, Train loss: 1.377, Test loss: 1.476, Test accuracy: 45.68
Round  41, Global train loss: 1.377, Global test loss: 1.869, Global test accuracy: 38.12
Round  42, Train loss: 1.504, Test loss: 1.492, Test accuracy: 45.98
Round  42, Global train loss: 1.504, Global test loss: 1.879, Global test accuracy: 34.92
Round  43, Train loss: 1.368, Test loss: 1.481, Test accuracy: 46.38
Round  43, Global train loss: 1.368, Global test loss: 1.873, Global test accuracy: 40.68
Round  44, Train loss: 1.374, Test loss: 1.478, Test accuracy: 46.02
Round  44, Global train loss: 1.374, Global test loss: 1.901, Global test accuracy: 37.70
Round  45, Train loss: 1.424, Test loss: 1.491, Test accuracy: 46.02
Round  45, Global train loss: 1.424, Global test loss: 2.004, Global test accuracy: 33.78
Round  46, Train loss: 1.521, Test loss: 1.503, Test accuracy: 46.94
Round  46, Global train loss: 1.521, Global test loss: 1.922, Global test accuracy: 35.68
Round  47, Train loss: 1.134, Test loss: 1.524, Test accuracy: 46.12
Round  47, Global train loss: 1.134, Global test loss: 1.727, Global test accuracy: 43.90
Round  48, Train loss: 1.407, Test loss: 1.558, Test accuracy: 45.50
Round  48, Global train loss: 1.407, Global test loss: 1.828, Global test accuracy: 40.62
Round  49, Train loss: 1.524, Test loss: 1.563, Test accuracy: 44.24
Round  49, Global train loss: 1.524, Global test loss: 2.058, Global test accuracy: 32.12
Round  50, Train loss: 1.324, Test loss: 1.563, Test accuracy: 44.76
Round  50, Global train loss: 1.324, Global test loss: 2.128, Global test accuracy: 32.16
Round  51, Train loss: 1.271, Test loss: 1.554, Test accuracy: 45.18
Round  51, Global train loss: 1.271, Global test loss: 1.822, Global test accuracy: 40.16
Round  52, Train loss: 1.180, Test loss: 1.542, Test accuracy: 45.46
Round  52, Global train loss: 1.180, Global test loss: 1.756, Global test accuracy: 44.08
Round  53, Train loss: 1.233, Test loss: 1.534, Test accuracy: 45.86
Round  53, Global train loss: 1.233, Global test loss: 1.733, Global test accuracy: 43.36
Round  54, Train loss: 1.426, Test loss: 1.605, Test accuracy: 43.56
Round  54, Global train loss: 1.426, Global test loss: 2.000, Global test accuracy: 35.56
Round  55, Train loss: 1.073, Test loss: 1.655, Test accuracy: 43.24
Round  55, Global train loss: 1.073, Global test loss: 2.040, Global test accuracy: 37.48
Round  56, Train loss: 1.113, Test loss: 1.683, Test accuracy: 42.74
Round  56, Global train loss: 1.113, Global test loss: 1.934, Global test accuracy: 38.68
Round  57, Train loss: 1.248, Test loss: 1.661, Test accuracy: 43.80
Round  57, Global train loss: 1.248, Global test loss: 1.948, Global test accuracy: 38.46
Round  58, Train loss: 1.304, Test loss: 1.652, Test accuracy: 45.02
Round  58, Global train loss: 1.304, Global test loss: 2.117, Global test accuracy: 29.38
Round  59, Train loss: 1.227, Test loss: 1.685, Test accuracy: 44.60
Round  59, Global train loss: 1.227, Global test loss: 2.113, Global test accuracy: 30.88
Round  60, Train loss: 1.250, Test loss: 1.707, Test accuracy: 42.66
Round  60, Global train loss: 1.250, Global test loss: 2.058, Global test accuracy: 33.18
Round  61, Train loss: 0.979, Test loss: 1.714, Test accuracy: 44.06
Round  61, Global train loss: 0.979, Global test loss: 2.026, Global test accuracy: 35.38
Round  62, Train loss: 1.142, Test loss: 1.750, Test accuracy: 42.18
Round  62, Global train loss: 1.142, Global test loss: 2.117, Global test accuracy: 32.20
Round  63, Train loss: 1.161, Test loss: 1.749, Test accuracy: 42.32
Round  63, Global train loss: 1.161, Global test loss: 2.176, Global test accuracy: 34.30
Round  64, Train loss: 1.062, Test loss: 1.746, Test accuracy: 42.24
Round  64, Global train loss: 1.062, Global test loss: 2.117, Global test accuracy: 34.32
Round  65, Train loss: 1.084, Test loss: 1.779, Test accuracy: 42.06
Round  65, Global train loss: 1.084, Global test loss: 2.157, Global test accuracy: 31.74
Round  66, Train loss: 0.978, Test loss: 1.793, Test accuracy: 42.22
Round  66, Global train loss: 0.978, Global test loss: 2.126, Global test accuracy: 35.64
Round  67, Train loss: 1.152, Test loss: 1.822, Test accuracy: 41.96
Round  67, Global train loss: 1.152, Global test loss: 2.184, Global test accuracy: 30.46
Round  68, Train loss: 0.932, Test loss: 1.854, Test accuracy: 41.30
Round  68, Global train loss: 0.932, Global test loss: 2.325, Global test accuracy: 33.42
Round  69, Train loss: 1.091, Test loss: 1.884, Test accuracy: 41.64
Round  69, Global train loss: 1.091, Global test loss: 2.388, Global test accuracy: 26.94
Round  70, Train loss: 0.980, Test loss: 1.876, Test accuracy: 42.94
Round  70, Global train loss: 0.980, Global test loss: 2.229, Global test accuracy: 34.96
Round  71, Train loss: 0.869, Test loss: 1.881, Test accuracy: 42.86
Round  71, Global train loss: 0.869, Global test loss: 2.286, Global test accuracy: 33.92
Round  72, Train loss: 1.095, Test loss: 1.867, Test accuracy: 42.06
Round  72, Global train loss: 1.095, Global test loss: 2.281, Global test accuracy: 30.32
Round  73, Train loss: 0.762, Test loss: 1.927, Test accuracy: 42.04
Round  73, Global train loss: 0.762, Global test loss: 2.265, Global test accuracy: 37.04
Round  74, Train loss: 0.967, Test loss: 1.948, Test accuracy: 41.76
Round  74, Global train loss: 0.967, Global test loss: 2.222, Global test accuracy: 33.96
Round  75, Train loss: 0.869, Test loss: 1.941, Test accuracy: 41.58
Round  75, Global train loss: 0.869, Global test loss: 2.336, Global test accuracy: 33.56
Round  76, Train loss: 0.907, Test loss: 2.006, Test accuracy: 40.38
Round  76, Global train loss: 0.907, Global test loss: 2.652, Global test accuracy: 26.26
Round  77, Train loss: 0.784, Test loss: 2.048, Test accuracy: 40.76
Round  77, Global train loss: 0.784, Global test loss: 2.447, Global test accuracy: 34.66
Round  78, Train loss: 0.912, Test loss: 2.045, Test accuracy: 41.60
Round  78, Global train loss: 0.912, Global test loss: 2.700, Global test accuracy: 26.52
Round  79, Train loss: 0.932, Test loss: 2.088, Test accuracy: 40.86
Round  79, Global train loss: 0.932, Global test loss: 2.384, Global test accuracy: 31.66
Round  80, Train loss: 0.776, Test loss: 2.145, Test accuracy: 40.76
Round  80, Global train loss: 0.776, Global test loss: 2.479, Global test accuracy: 34.26
Round  81, Train loss: 0.810, Test loss: 2.184, Test accuracy: 39.36
Round  81, Global train loss: 0.810, Global test loss: 2.657, Global test accuracy: 27.36
Round  82, Train loss: 0.784, Test loss: 2.197, Test accuracy: 39.68
Round  82, Global train loss: 0.784, Global test loss: 2.771, Global test accuracy: 26.64
Round  83, Train loss: 0.855, Test loss: 2.161, Test accuracy: 41.08
Round  83, Global train loss: 0.855, Global test loss: 2.724, Global test accuracy: 28.36
Round  84, Train loss: 0.617, Test loss: 2.172, Test accuracy: 41.54
Round  84, Global train loss: 0.617, Global test loss: 2.587, Global test accuracy: 37.68
Round  85, Train loss: 0.833, Test loss: 2.184, Test accuracy: 40.98
Round  85, Global train loss: 0.833, Global test loss: 2.350, Global test accuracy: 34.64
Round  86, Train loss: 0.860, Test loss: 2.184, Test accuracy: 41.44
Round  86, Global train loss: 0.860, Global test loss: 2.380, Global test accuracy: 33.72
Round  87, Train loss: 0.658, Test loss: 2.174, Test accuracy: 41.72
Round  87, Global train loss: 0.658, Global test loss: 2.256, Global test accuracy: 37.80
Round  88, Train loss: 0.935, Test loss: 2.197, Test accuracy: 42.68
Round  88, Global train loss: 0.935, Global test loss: 2.555, Global test accuracy: 30.46
Round  89, Train loss: 0.588, Test loss: 2.172, Test accuracy: 42.44
Round  89, Global train loss: 0.588, Global test loss: 2.534, Global test accuracy: 34.48
Round  90, Train loss: 0.924, Test loss: 2.218, Test accuracy: 42.38
Round  90, Global train loss: 0.924, Global test loss: 2.795, Global test accuracy: 26.90
Round  91, Train loss: 0.579, Test loss: 2.252, Test accuracy: 41.80
Round  91, Global train loss: 0.579, Global test loss: 2.409, Global test accuracy: 36.92
Round  92, Train loss: 0.632, Test loss: 2.276, Test accuracy: 41.64
Round  92, Global train loss: 0.632, Global test loss: 2.485, Global test accuracy: 36.12
Round  93, Train loss: 0.583, Test loss: 2.351, Test accuracy: 41.50
Round  93, Global train loss: 0.583, Global test loss: 2.725, Global test accuracy: 33.46/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.605, Test loss: 2.460, Test accuracy: 40.20
Round  94, Global train loss: 0.605, Global test loss: 2.678, Global test accuracy: 34.56
Round  95, Train loss: 0.707, Test loss: 2.447, Test accuracy: 40.62
Round  95, Global train loss: 0.707, Global test loss: 2.562, Global test accuracy: 36.74
Round  96, Train loss: 0.560, Test loss: 2.490, Test accuracy: 39.70
Round  96, Global train loss: 0.560, Global test loss: 3.044, Global test accuracy: 32.88
Round  97, Train loss: 0.672, Test loss: 2.506, Test accuracy: 39.66
Round  97, Global train loss: 0.672, Global test loss: 2.648, Global test accuracy: 35.24
Round  98, Train loss: 0.698, Test loss: 2.441, Test accuracy: 40.98
Round  98, Global train loss: 0.698, Global test loss: 2.746, Global test accuracy: 31.84
Round  99, Train loss: 0.537, Test loss: 2.467, Test accuracy: 41.48
Round  99, Global train loss: 0.537, Global test loss: 2.408, Global test accuracy: 39.72
Final Round, Train loss: 0.528, Test loss: 2.777, Test accuracy: 38.70
Final Round, Global train loss: 0.528, Global test loss: 2.408, Global test accuracy: 39.72
Average accuracy final 10 rounds: 40.995999999999995 

Average global accuracy final 10 rounds: 34.438 

839.4200081825256
[1.5900845527648926, 3.180169105529785, 4.444431781768799, 5.7086944580078125, 6.9763853549957275, 8.244076251983643, 9.538694381713867, 10.833312511444092, 12.18488073348999, 13.536448955535889, 14.880386590957642, 16.224324226379395, 17.559798002243042, 18.89527177810669, 20.28220796585083, 21.66914415359497, 22.94330596923828, 24.217467784881592, 25.527531623840332, 26.837595462799072, 28.158251523971558, 29.478907585144043, 30.819215059280396, 32.15952253341675, 33.42424774169922, 34.68897294998169, 36.10793614387512, 37.526899337768555, 38.907238721847534, 40.287578105926514, 41.60054087638855, 42.913503646850586, 44.1571478843689, 45.40079212188721, 46.73973536491394, 48.078678607940674, 49.415727376937866, 50.75277614593506, 52.0831093788147, 53.413442611694336, 54.733397483825684, 56.05335235595703, 57.30749034881592, 58.561628341674805, 59.94321537017822, 61.32480239868164, 62.65191411972046, 63.97902584075928, 65.2924542427063, 66.60588264465332, 67.94731712341309, 69.28875160217285, 70.61244535446167, 71.93613910675049, 73.36244702339172, 74.78875494003296, 76.0804009437561, 77.37204694747925, 78.72729659080505, 80.08254623413086, 81.43847799301147, 82.79440975189209, 84.18652987480164, 85.57864999771118, 86.95472836494446, 88.33080673217773, 89.63435196876526, 90.93789720535278, 92.30453562736511, 93.67117404937744, 94.94567799568176, 96.22018194198608, 97.47226572036743, 98.72434949874878, 100.00061535835266, 101.27688121795654, 102.61254215240479, 103.94820308685303, 105.30615973472595, 106.66411638259888, 108.07001399993896, 109.47591161727905, 110.7981276512146, 112.12034368515015, 113.4807779788971, 114.84121227264404, 116.09723162651062, 117.3532509803772, 118.77671360969543, 120.20017623901367, 121.53425860404968, 122.8683409690857, 124.19945311546326, 125.53056526184082, 126.8357789516449, 128.14099264144897, 129.41960048675537, 130.69820833206177, 131.96781945228577, 133.23743057250977, 134.49307656288147, 135.74872255325317, 137.10453748703003, 138.46035242080688, 139.83332443237305, 141.2062964439392, 142.52858638763428, 143.85087633132935, 145.16218304634094, 146.47348976135254, 147.74199414253235, 149.01049852371216, 150.35979914665222, 151.70909976959229, 153.0720465183258, 154.43499326705933, 155.78222799301147, 157.12946271896362, 158.52311277389526, 159.9167628288269, 161.2707483768463, 162.62473392486572, 163.89429259300232, 165.16385126113892, 166.47991013526917, 167.7959690093994, 169.1122465133667, 170.42852401733398, 171.75297856330872, 173.07743310928345, 174.3474190235138, 175.61740493774414, 176.9330849647522, 178.24876499176025, 179.5571894645691, 180.86561393737793, 182.17217826843262, 183.4787425994873, 184.81011033058167, 186.14147806167603, 187.53986072540283, 188.93824338912964, 190.24411702156067, 191.5499906539917, 192.87546229362488, 194.20093393325806, 195.56443071365356, 196.92792749404907, 198.1911370754242, 199.45434665679932, 200.72025871276855, 201.9861707687378, 203.26131987571716, 204.53646898269653, 205.92267441749573, 207.30887985229492, 208.64452648162842, 209.9801731109619, 211.299307346344, 212.61844158172607, 213.92744278907776, 215.23644399642944, 216.5193965435028, 217.80234909057617, 219.06882548332214, 220.33530187606812, 221.66955709457397, 223.00381231307983, 224.33213186264038, 225.66045141220093, 227.0310037136078, 228.40155601501465, 229.71545433998108, 231.0293526649475, 232.37907195091248, 233.72879123687744, 235.00526070594788, 236.2817301750183, 237.58929824829102, 238.89686632156372, 240.24404406547546, 241.5912218093872, 242.92478466033936, 244.2583475112915, 245.57034468650818, 246.88234186172485, 248.25359201431274, 249.62484216690063, 250.92976593971252, 252.2346897125244, 253.5723476409912, 254.910005569458, 256.28428864479065, 257.6585717201233, 259.0380799770355, 260.41758823394775, 261.73553919792175, 263.05349016189575, 264.3429534435272, 265.6324167251587, 268.3502345085144, 271.0680522918701]
[12.86, 12.86, 19.3, 19.3, 21.8, 21.8, 26.26, 26.26, 29.28, 29.28, 31.24, 31.24, 38.38, 38.38, 37.04, 37.04, 37.74, 37.74, 38.6, 38.6, 40.08, 40.08, 42.52, 42.52, 43.66, 43.66, 44.32, 44.32, 45.16, 45.16, 48.62, 48.62, 47.46, 47.46, 47.72, 47.72, 48.56, 48.56, 48.5, 48.5, 49.02, 49.02, 50.14, 50.14, 49.96, 49.96, 47.98, 47.98, 47.14, 47.14, 45.2, 45.2, 45.56, 45.56, 47.56, 47.56, 47.44, 47.44, 46.74, 46.74, 45.86, 45.86, 46.64, 46.64, 48.2, 48.2, 48.62, 48.62, 48.16, 48.16, 48.52, 48.52, 47.64, 47.64, 47.42, 47.42, 46.9, 46.9, 45.72, 45.72, 45.84, 45.84, 45.68, 45.68, 45.98, 45.98, 46.38, 46.38, 46.02, 46.02, 46.02, 46.02, 46.94, 46.94, 46.12, 46.12, 45.5, 45.5, 44.24, 44.24, 44.76, 44.76, 45.18, 45.18, 45.46, 45.46, 45.86, 45.86, 43.56, 43.56, 43.24, 43.24, 42.74, 42.74, 43.8, 43.8, 45.02, 45.02, 44.6, 44.6, 42.66, 42.66, 44.06, 44.06, 42.18, 42.18, 42.32, 42.32, 42.24, 42.24, 42.06, 42.06, 42.22, 42.22, 41.96, 41.96, 41.3, 41.3, 41.64, 41.64, 42.94, 42.94, 42.86, 42.86, 42.06, 42.06, 42.04, 42.04, 41.76, 41.76, 41.58, 41.58, 40.38, 40.38, 40.76, 40.76, 41.6, 41.6, 40.86, 40.86, 40.76, 40.76, 39.36, 39.36, 39.68, 39.68, 41.08, 41.08, 41.54, 41.54, 40.98, 40.98, 41.44, 41.44, 41.72, 41.72, 42.68, 42.68, 42.44, 42.44, 42.38, 42.38, 41.8, 41.8, 41.64, 41.64, 41.5, 41.5, 40.2, 40.2, 40.62, 40.62, 39.7, 39.7, 39.66, 39.66, 40.98, 40.98, 41.48, 41.48, 38.7, 38.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.950, Test loss: 2.200, Test accuracy: 14.20
Round   0, Global train loss: 1.950, Global test loss: 2.332, Global test accuracy: 10.30
Round   1, Train loss: 1.828, Test loss: 2.018, Test accuracy: 23.82
Round   1, Global train loss: 1.828, Global test loss: 2.291, Global test accuracy: 14.20
Round   2, Train loss: 1.741, Test loss: 2.031, Test accuracy: 27.60
Round   2, Global train loss: 1.741, Global test loss: 2.347, Global test accuracy: 21.22
Round   3, Train loss: 1.897, Test loss: 1.826, Test accuracy: 28.26
Round   3, Global train loss: 1.897, Global test loss: 2.254, Global test accuracy: 13.84
Round   4, Train loss: 1.757, Test loss: 1.822, Test accuracy: 31.16
Round   4, Global train loss: 1.757, Global test loss: 2.384, Global test accuracy: 19.20
Round   5, Train loss: 1.551, Test loss: 1.719, Test accuracy: 35.22
Round   5, Global train loss: 1.551, Global test loss: 2.007, Global test accuracy: 34.64
Round   6, Train loss: 1.886, Test loss: 1.609, Test accuracy: 38.94
Round   6, Global train loss: 1.886, Global test loss: 2.041, Global test accuracy: 36.22
Round   7, Train loss: 1.655, Test loss: 1.617, Test accuracy: 39.06
Round   7, Global train loss: 1.655, Global test loss: 1.900, Global test accuracy: 34.34
Round   8, Train loss: 1.768, Test loss: 1.599, Test accuracy: 40.42
Round   8, Global train loss: 1.768, Global test loss: 1.938, Global test accuracy: 34.50
Round   9, Train loss: 1.615, Test loss: 1.571, Test accuracy: 44.18
Round   9, Global train loss: 1.615, Global test loss: 1.957, Global test accuracy: 32.74
Round  10, Train loss: 1.909, Test loss: 1.536, Test accuracy: 45.98
Round  10, Global train loss: 1.909, Global test loss: 2.068, Global test accuracy: 31.60
Round  11, Train loss: 1.699, Test loss: 1.510, Test accuracy: 46.74
Round  11, Global train loss: 1.699, Global test loss: 2.057, Global test accuracy: 32.16
Round  12, Train loss: 1.610, Test loss: 1.503, Test accuracy: 47.52
Round  12, Global train loss: 1.610, Global test loss: 1.873, Global test accuracy: 36.50
Round  13, Train loss: 1.674, Test loss: 1.493, Test accuracy: 47.48
Round  13, Global train loss: 1.674, Global test loss: 1.986, Global test accuracy: 41.24
Round  14, Train loss: 1.671, Test loss: 1.498, Test accuracy: 47.40
Round  14, Global train loss: 1.671, Global test loss: 1.832, Global test accuracy: 40.54
Round  15, Train loss: 1.663, Test loss: 1.477, Test accuracy: 48.00
Round  15, Global train loss: 1.663, Global test loss: 1.858, Global test accuracy: 40.76
Round  16, Train loss: 1.466, Test loss: 1.475, Test accuracy: 48.08
Round  16, Global train loss: 1.466, Global test loss: 1.855, Global test accuracy: 37.08
Round  17, Train loss: 1.965, Test loss: 1.448, Test accuracy: 48.46
Round  17, Global train loss: 1.965, Global test loss: 1.915, Global test accuracy: 39.42
Round  18, Train loss: 1.871, Test loss: 1.454, Test accuracy: 47.38
Round  18, Global train loss: 1.871, Global test loss: 1.984, Global test accuracy: 35.58
Round  19, Train loss: 1.425, Test loss: 1.454, Test accuracy: 47.96
Round  19, Global train loss: 1.425, Global test loss: 1.792, Global test accuracy: 42.02
Round  20, Train loss: 1.602, Test loss: 1.465, Test accuracy: 47.54
Round  20, Global train loss: 1.602, Global test loss: 1.837, Global test accuracy: 36.38
Round  21, Train loss: 1.715, Test loss: 1.462, Test accuracy: 49.52
Round  21, Global train loss: 1.715, Global test loss: 1.885, Global test accuracy: 40.22
Round  22, Train loss: 1.734, Test loss: 1.463, Test accuracy: 50.24
Round  22, Global train loss: 1.734, Global test loss: 1.887, Global test accuracy: 39.22
Round  23, Train loss: 1.507, Test loss: 1.440, Test accuracy: 50.82
Round  23, Global train loss: 1.507, Global test loss: 1.784, Global test accuracy: 41.64
Round  24, Train loss: 1.441, Test loss: 1.423, Test accuracy: 50.48
Round  24, Global train loss: 1.441, Global test loss: 1.847, Global test accuracy: 42.06
Round  25, Train loss: 1.716, Test loss: 1.427, Test accuracy: 50.50
Round  25, Global train loss: 1.716, Global test loss: 1.800, Global test accuracy: 44.10
Round  26, Train loss: 1.778, Test loss: 1.418, Test accuracy: 50.00
Round  26, Global train loss: 1.778, Global test loss: 2.003, Global test accuracy: 37.08
Round  27, Train loss: 1.527, Test loss: 1.436, Test accuracy: 49.96
Round  27, Global train loss: 1.527, Global test loss: 1.805, Global test accuracy: 41.40
Round  28, Train loss: 1.740, Test loss: 1.426, Test accuracy: 49.64
Round  28, Global train loss: 1.740, Global test loss: 2.031, Global test accuracy: 34.40
Round  29, Train loss: 1.518, Test loss: 1.415, Test accuracy: 50.46
Round  29, Global train loss: 1.518, Global test loss: 1.877, Global test accuracy: 37.66
Round  30, Train loss: 1.582, Test loss: 1.432, Test accuracy: 49.94
Round  30, Global train loss: 1.582, Global test loss: 2.140, Global test accuracy: 31.38
Round  31, Train loss: 1.098, Test loss: 1.428, Test accuracy: 50.66
Round  31, Global train loss: 1.098, Global test loss: 1.631, Global test accuracy: 48.36
Round  32, Train loss: 1.718, Test loss: 1.428, Test accuracy: 49.74
Round  32, Global train loss: 1.718, Global test loss: 1.957, Global test accuracy: 36.02
Round  33, Train loss: 1.598, Test loss: 1.447, Test accuracy: 48.90
Round  33, Global train loss: 1.598, Global test loss: 1.889, Global test accuracy: 38.20
Round  34, Train loss: 1.705, Test loss: 1.483, Test accuracy: 46.76
Round  34, Global train loss: 1.705, Global test loss: 1.983, Global test accuracy: 31.44
Round  35, Train loss: 1.648, Test loss: 1.500, Test accuracy: 46.06
Round  35, Global train loss: 1.648, Global test loss: 1.939, Global test accuracy: 34.82
Round  36, Train loss: 1.550, Test loss: 1.492, Test accuracy: 46.54
Round  36, Global train loss: 1.550, Global test loss: 1.998, Global test accuracy: 34.22
Round  37, Train loss: 1.500, Test loss: 1.469, Test accuracy: 47.16
Round  37, Global train loss: 1.500, Global test loss: 1.935, Global test accuracy: 39.08
Round  38, Train loss: 1.353, Test loss: 1.475, Test accuracy: 46.14
Round  38, Global train loss: 1.353, Global test loss: 2.017, Global test accuracy: 36.50
Round  39, Train loss: 1.380, Test loss: 1.456, Test accuracy: 47.34
Round  39, Global train loss: 1.380, Global test loss: 1.891, Global test accuracy: 38.18
Round  40, Train loss: 1.459, Test loss: 1.497, Test accuracy: 46.50
Round  40, Global train loss: 1.459, Global test loss: 2.078, Global test accuracy: 28.96
Round  41, Train loss: 1.510, Test loss: 1.499, Test accuracy: 46.38
Round  41, Global train loss: 1.510, Global test loss: 2.168, Global test accuracy: 31.84
Round  42, Train loss: 1.410, Test loss: 1.490, Test accuracy: 46.46
Round  42, Global train loss: 1.410, Global test loss: 2.112, Global test accuracy: 29.06
Round  43, Train loss: 1.388, Test loss: 1.514, Test accuracy: 45.48
Round  43, Global train loss: 1.388, Global test loss: 2.025, Global test accuracy: 36.02
Round  44, Train loss: 1.478, Test loss: 1.529, Test accuracy: 46.04
Round  44, Global train loss: 1.478, Global test loss: 2.176, Global test accuracy: 28.48
Round  45, Train loss: 1.236, Test loss: 1.564, Test accuracy: 45.18
Round  45, Global train loss: 1.236, Global test loss: 2.071, Global test accuracy: 36.48
Round  46, Train loss: 1.237, Test loss: 1.579, Test accuracy: 44.76
Round  46, Global train loss: 1.237, Global test loss: 1.890, Global test accuracy: 39.86
Round  47, Train loss: 1.367, Test loss: 1.539, Test accuracy: 45.28
Round  47, Global train loss: 1.367, Global test loss: 1.992, Global test accuracy: 33.36
Round  48, Train loss: 1.305, Test loss: 1.563, Test accuracy: 45.34
Round  48, Global train loss: 1.305, Global test loss: 2.250, Global test accuracy: 30.06
Round  49, Train loss: 1.166, Test loss: 1.634, Test accuracy: 43.06
Round  49, Global train loss: 1.166, Global test loss: 2.094, Global test accuracy: 36.08
Round  50, Train loss: 1.112, Test loss: 1.605, Test accuracy: 43.76
Round  50, Global train loss: 1.112, Global test loss: 2.236, Global test accuracy: 31.96
Round  51, Train loss: 1.271, Test loss: 1.638, Test accuracy: 42.90
Round  51, Global train loss: 1.271, Global test loss: 2.009, Global test accuracy: 38.26
Round  52, Train loss: 1.232, Test loss: 1.659, Test accuracy: 42.66
Round  52, Global train loss: 1.232, Global test loss: 2.051, Global test accuracy: 34.14
Round  53, Train loss: 1.041, Test loss: 1.708, Test accuracy: 42.14
Round  53, Global train loss: 1.041, Global test loss: 2.029, Global test accuracy: 36.14
Round  54, Train loss: 1.260, Test loss: 1.724, Test accuracy: 42.66
Round  54, Global train loss: 1.260, Global test loss: 2.273, Global test accuracy: 29.08
Round  55, Train loss: 1.206, Test loss: 1.723, Test accuracy: 42.04
Round  55, Global train loss: 1.206, Global test loss: 2.330, Global test accuracy: 31.20
Round  56, Train loss: 1.168, Test loss: 1.754, Test accuracy: 41.36
Round  56, Global train loss: 1.168, Global test loss: 2.365, Global test accuracy: 29.84
Round  57, Train loss: 1.003, Test loss: 1.768, Test accuracy: 41.68
Round  57, Global train loss: 1.003, Global test loss: 2.208, Global test accuracy: 37.26
Round  58, Train loss: 1.213, Test loss: 1.766, Test accuracy: 42.66
Round  58, Global train loss: 1.213, Global test loss: 2.357, Global test accuracy: 27.98
Round  59, Train loss: 1.013, Test loss: 1.825, Test accuracy: 41.40
Round  59, Global train loss: 1.013, Global test loss: 2.162, Global test accuracy: 34.82
Round  60, Train loss: 0.920, Test loss: 1.824, Test accuracy: 41.92
Round  60, Global train loss: 0.920, Global test loss: 2.012, Global test accuracy: 43.60
Round  61, Train loss: 1.038, Test loss: 1.846, Test accuracy: 41.56
Round  61, Global train loss: 1.038, Global test loss: 2.139, Global test accuracy: 34.96
Round  62, Train loss: 0.918, Test loss: 1.921, Test accuracy: 40.72
Round  62, Global train loss: 0.918, Global test loss: 2.172, Global test accuracy: 38.88
Round  63, Train loss: 1.150, Test loss: 1.912, Test accuracy: 41.84
Round  63, Global train loss: 1.150, Global test loss: 2.308, Global test accuracy: 35.00
Round  64, Train loss: 0.810, Test loss: 1.913, Test accuracy: 42.40
Round  64, Global train loss: 0.810, Global test loss: 2.265, Global test accuracy: 41.14
Round  65, Train loss: 1.008, Test loss: 1.885, Test accuracy: 42.40
Round  65, Global train loss: 1.008, Global test loss: 2.390, Global test accuracy: 31.04
Round  66, Train loss: 0.813, Test loss: 1.932, Test accuracy: 41.56
Round  66, Global train loss: 0.813, Global test loss: 2.069, Global test accuracy: 40.34
Round  67, Train loss: 1.006, Test loss: 1.975, Test accuracy: 41.00
Round  67, Global train loss: 1.006, Global test loss: 2.287, Global test accuracy: 31.14
Round  68, Train loss: 0.828, Test loss: 2.073, Test accuracy: 39.92
Round  68, Global train loss: 0.828, Global test loss: 2.792, Global test accuracy: 26.70
Round  69, Train loss: 0.932, Test loss: 2.034, Test accuracy: 40.72
Round  69, Global train loss: 0.932, Global test loss: 2.497, Global test accuracy: 27.96
Round  70, Train loss: 1.089, Test loss: 2.067, Test accuracy: 40.94
Round  70, Global train loss: 1.089, Global test loss: 2.597, Global test accuracy: 28.34
Round  71, Train loss: 0.869, Test loss: 2.125, Test accuracy: 39.20
Round  71, Global train loss: 0.869, Global test loss: 2.644, Global test accuracy: 29.34
Round  72, Train loss: 0.686, Test loss: 2.174, Test accuracy: 39.66
Round  72, Global train loss: 0.686, Global test loss: 2.231, Global test accuracy: 38.50
Round  73, Train loss: 0.861, Test loss: 2.097, Test accuracy: 40.74
Round  73, Global train loss: 0.861, Global test loss: 2.532, Global test accuracy: 33.08
Round  74, Train loss: 0.941, Test loss: 2.102, Test accuracy: 40.92
Round  74, Global train loss: 0.941, Global test loss: 2.240, Global test accuracy: 32.18
Round  75, Train loss: 0.799, Test loss: 2.121, Test accuracy: 41.14
Round  75, Global train loss: 0.799, Global test loss: 2.635, Global test accuracy: 32.44
Round  76, Train loss: 0.723, Test loss: 2.155, Test accuracy: 41.30
Round  76, Global train loss: 0.723, Global test loss: 2.759, Global test accuracy: 29.60
Round  77, Train loss: 0.644, Test loss: 2.195, Test accuracy: 42.22
Round  77, Global train loss: 0.644, Global test loss: 2.663, Global test accuracy: 35.52
Round  78, Train loss: 0.862, Test loss: 2.213, Test accuracy: 42.28
Round  78, Global train loss: 0.862, Global test loss: 2.727, Global test accuracy: 27.56
Round  79, Train loss: 0.639, Test loss: 2.180, Test accuracy: 41.82
Round  79, Global train loss: 0.639, Global test loss: 2.356, Global test accuracy: 38.22
Round  80, Train loss: 0.763, Test loss: 2.244, Test accuracy: 40.98
Round  80, Global train loss: 0.763, Global test loss: 2.677, Global test accuracy: 30.76
Round  81, Train loss: 0.642, Test loss: 2.283, Test accuracy: 40.60
Round  81, Global train loss: 0.642, Global test loss: 2.725, Global test accuracy: 29.66
Round  82, Train loss: 0.688, Test loss: 2.287, Test accuracy: 40.62
Round  82, Global train loss: 0.688, Global test loss: 2.984, Global test accuracy: 25.38
Round  83, Train loss: 0.657, Test loss: 2.295, Test accuracy: 41.60
Round  83, Global train loss: 0.657, Global test loss: 2.922, Global test accuracy: 31.80
Round  84, Train loss: 0.655, Test loss: 2.290, Test accuracy: 41.16
Round  84, Global train loss: 0.655, Global test loss: 2.733, Global test accuracy: 36.92
Round  85, Train loss: 0.451, Test loss: 2.305, Test accuracy: 41.46
Round  85, Global train loss: 0.451, Global test loss: 2.186, Global test accuracy: 46.78
Round  86, Train loss: 0.524, Test loss: 2.424, Test accuracy: 40.22
Round  86, Global train loss: 0.524, Global test loss: 2.368, Global test accuracy: 41.58
Round  87, Train loss: 0.743, Test loss: 2.369, Test accuracy: 41.04
Round  87, Global train loss: 0.743, Global test loss: 2.376, Global test accuracy: 36.16
Round  88, Train loss: 0.657, Test loss: 2.372, Test accuracy: 39.88
Round  88, Global train loss: 0.657, Global test loss: 2.487, Global test accuracy: 37.46
Round  89, Train loss: 0.534, Test loss: 2.321, Test accuracy: 41.90
Round  89, Global train loss: 0.534, Global test loss: 2.837, Global test accuracy: 31.28
Round  90, Train loss: 0.648, Test loss: 2.388, Test accuracy: 41.06
Round  90, Global train loss: 0.648, Global test loss: 2.504, Global test accuracy: 37.60
Round  91, Train loss: 0.614, Test loss: 2.392, Test accuracy: 40.64
Round  91, Global train loss: 0.614, Global test loss: 2.567, Global test accuracy: 35.50
Round  92, Train loss: 0.889, Test loss: 2.397, Test accuracy: 39.84
Round  92, Global train loss: 0.889, Global test loss: 2.765, Global test accuracy: 24.72
Round  93, Train loss: 0.661, Test loss: 2.433, Test accuracy: 39.92
Round  93, Global train loss: 0.661, Global test loss: 3.108, Global test accuracy: 24.64
Round  94, Train loss: 0.473, Test loss: 2.503, Test accuracy: 39.72
Round  94, Global train loss: 0.473, Global test loss: 2.796, Global test accuracy: 37.40
Round  95, Train loss: 0.489, Test loss: 2.456, Test accuracy: 40.88
Round  95, Global train loss: 0.489, Global test loss: 2.463, Global test accuracy: 41.50
Round  96, Train loss: 0.560, Test loss: 2.525, Test accuracy: 40.20
Round  96, Global train loss: 0.560, Global test loss: 3.040, Global test accuracy: 33.94
Round  97, Train loss: 0.595, Test loss: 2.531, Test accuracy: 40.00
Round  97, Global train loss: 0.595, Global test loss: 2.510, Global test accuracy: 39.96
Round  98, Train loss: 0.591, Test loss: 2.647, Test accuracy: 38.98
Round  98, Global train loss: 0.591, Global test loss: 2.704, Global test accuracy: 35.28
Round  99, Train loss: 0.722, Test loss: 2.623, Test accuracy: 39.04
Round  99, Global train loss: 0.722, Global test loss: 2.849, Global test accuracy: 28.12
Final Round, Train loss: 0.484, Test loss: 2.941, Test accuracy: 38.96
Final Round, Global train loss: 0.484, Global test loss: 2.849, Global test accuracy: 28.12
Average accuracy final 10 rounds: 40.02799999999999
Average global accuracy final 10 rounds: 33.866
1236.2718541622162
[3.222716808319092, 6.320688009262085, 9.313321828842163, 12.305925130844116, 15.298412322998047, 18.273590564727783, 21.356719493865967, 24.384076595306396, 27.404033660888672, 30.409841775894165, 33.40801763534546, 36.43514037132263, 39.48123502731323, 42.49934267997742, 45.48978662490845, 48.49048042297363, 51.288825273513794, 54.23500442504883, 57.14075565338135, 60.077354431152344, 63.09130239486694, 66.15018725395203, 69.17987847328186, 72.22901058197021, 75.24085021018982, 78.20335578918457, 81.2847375869751, 84.24573540687561, 87.21974635124207, 90.12757921218872, 93.1718053817749, 96.13803339004517, 99.19615888595581, 102.24940180778503, 105.36279606819153, 108.34271574020386, 111.46098971366882, 114.46316599845886, 117.48637771606445, 120.50916194915771, 123.57252478599548, 126.65171432495117, 129.52896332740784, 132.5922830104828, 135.70527601242065, 138.76772165298462, 141.82492089271545, 144.84761118888855, 147.88344025611877, 150.88301968574524, 153.90558910369873, 156.91143226623535, 159.86032700538635, 162.9283754825592, 165.87935066223145, 168.72420597076416, 171.5887529850006, 174.54200625419617, 177.4843349456787, 180.38187289237976, 183.4648699760437, 186.52661609649658, 189.59022903442383, 192.60191082954407, 195.60408663749695, 198.6593210697174, 201.69588208198547, 204.7998685836792, 207.84319686889648, 210.85628032684326, 213.99672055244446, 217.00214290618896, 220.00899243354797, 223.0139639377594, 226.13911080360413, 229.16179060935974, 232.26569199562073, 235.30601000785828, 238.32546663284302, 241.303950548172, 244.34804034233093, 247.44513821601868, 250.48232197761536, 253.52553176879883, 256.6012098789215, 259.6289758682251, 262.6786172389984, 265.64335775375366, 268.6224455833435, 271.6697714328766, 274.7825162410736, 277.8622727394104, 281.00007605552673, 283.9158093929291, 286.78807163238525, 289.6771900653839, 292.55849051475525, 295.6453444957733, 298.657746553421, 301.6312897205353, 306.9517288208008]
[14.2, 23.82, 27.6, 28.26, 31.16, 35.22, 38.94, 39.06, 40.42, 44.18, 45.98, 46.74, 47.52, 47.48, 47.4, 48.0, 48.08, 48.46, 47.38, 47.96, 47.54, 49.52, 50.24, 50.82, 50.48, 50.5, 50.0, 49.96, 49.64, 50.46, 49.94, 50.66, 49.74, 48.9, 46.76, 46.06, 46.54, 47.16, 46.14, 47.34, 46.5, 46.38, 46.46, 45.48, 46.04, 45.18, 44.76, 45.28, 45.34, 43.06, 43.76, 42.9, 42.66, 42.14, 42.66, 42.04, 41.36, 41.68, 42.66, 41.4, 41.92, 41.56, 40.72, 41.84, 42.4, 42.4, 41.56, 41.0, 39.92, 40.72, 40.94, 39.2, 39.66, 40.74, 40.92, 41.14, 41.3, 42.22, 42.28, 41.82, 40.98, 40.6, 40.62, 41.6, 41.16, 41.46, 40.22, 41.04, 39.88, 41.9, 41.06, 40.64, 39.84, 39.92, 39.72, 40.88, 40.2, 40.0, 38.98, 39.04, 38.96]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.151, Test loss: 2.282, Test accuracy: 10.02
Round   0, Global train loss: 2.151, Global test loss: 2.331, Global test accuracy: 10.00
Round   1, Train loss: 1.870, Test loss: 2.181, Test accuracy: 20.98
Round   1, Global train loss: 1.870, Global test loss: 2.406, Global test accuracy: 15.02
Round   2, Train loss: 1.899, Test loss: 2.071, Test accuracy: 25.20
Round   2, Global train loss: 1.899, Global test loss: 2.342, Global test accuracy: 17.98
Round   3, Train loss: 1.925, Test loss: 1.865, Test accuracy: 32.86
Round   3, Global train loss: 1.925, Global test loss: 2.256, Global test accuracy: 15.74
Round   4, Train loss: 1.925, Test loss: 1.855, Test accuracy: 34.60
Round   4, Global train loss: 1.925, Global test loss: 2.363, Global test accuracy: 17.98
Round   5, Train loss: 1.676, Test loss: 1.725, Test accuracy: 41.50
Round   5, Global train loss: 1.676, Global test loss: 2.065, Global test accuracy: 28.28
Round   6, Train loss: 1.933, Test loss: 1.689, Test accuracy: 45.06
Round   6, Global train loss: 1.933, Global test loss: 2.184, Global test accuracy: 24.70
Round   7, Train loss: 1.653, Test loss: 1.628, Test accuracy: 47.90
Round   7, Global train loss: 1.653, Global test loss: 2.129, Global test accuracy: 22.90
Round   8, Train loss: 1.785, Test loss: 1.612, Test accuracy: 47.26
Round   8, Global train loss: 1.785, Global test loss: 2.118, Global test accuracy: 27.20
Round   9, Train loss: 1.680, Test loss: 1.593, Test accuracy: 45.66
Round   9, Global train loss: 1.680, Global test loss: 2.371, Global test accuracy: 21.00
Round  10, Train loss: 1.959, Test loss: 1.595, Test accuracy: 46.14
Round  10, Global train loss: 1.959, Global test loss: 2.256, Global test accuracy: 10.00
Round  11, Train loss: 1.828, Test loss: 1.546, Test accuracy: 48.62
Round  11, Global train loss: 1.828, Global test loss: 2.324, Global test accuracy: 21.02
Round  12, Train loss: 1.682, Test loss: 1.564, Test accuracy: 49.02
Round  12, Global train loss: 1.682, Global test loss: 2.202, Global test accuracy: 27.10
Round  13, Train loss: 1.845, Test loss: 1.588, Test accuracy: 49.44
Round  13, Global train loss: 1.845, Global test loss: 2.146, Global test accuracy: 23.60
Round  14, Train loss: 1.652, Test loss: 1.521, Test accuracy: 48.80
Round  14, Global train loss: 1.652, Global test loss: 2.158, Global test accuracy: 26.22
Round  15, Train loss: 1.777, Test loss: 1.538, Test accuracy: 49.60
Round  15, Global train loss: 1.777, Global test loss: 2.172, Global test accuracy: 23.20
Round  16, Train loss: 1.559, Test loss: 1.550, Test accuracy: 50.72
Round  16, Global train loss: 1.559, Global test loss: 2.067, Global test accuracy: 25.60
Round  17, Train loss: 1.817, Test loss: 1.496, Test accuracy: 49.26
Round  17, Global train loss: 1.817, Global test loss: 2.119, Global test accuracy: 19.62
Round  18, Train loss: 1.885, Test loss: 1.531, Test accuracy: 48.72
Round  18, Global train loss: 1.885, Global test loss: 2.263, Global test accuracy: 13.10
Round  19, Train loss: 1.519, Test loss: 1.492, Test accuracy: 50.54
Round  19, Global train loss: 1.519, Global test loss: 2.032, Global test accuracy: 30.46
Round  20, Train loss: 1.749, Test loss: 1.466, Test accuracy: 50.96
Round  20, Global train loss: 1.749, Global test loss: 2.108, Global test accuracy: 26.80
Round  21, Train loss: 1.719, Test loss: 1.478, Test accuracy: 52.40
Round  21, Global train loss: 1.719, Global test loss: 2.090, Global test accuracy: 28.18
Round  22, Train loss: 1.787, Test loss: 1.488, Test accuracy: 50.46
Round  22, Global train loss: 1.787, Global test loss: 2.080, Global test accuracy: 23.94
Round  23, Train loss: 1.542, Test loss: 1.478, Test accuracy: 51.42
Round  23, Global train loss: 1.542, Global test loss: 2.272, Global test accuracy: 22.76
Round  24, Train loss: 1.548, Test loss: 1.497, Test accuracy: 50.96
Round  24, Global train loss: 1.548, Global test loss: 2.164, Global test accuracy: 33.60
Round  25, Train loss: 1.651, Test loss: 1.454, Test accuracy: 50.86
Round  25, Global train loss: 1.651, Global test loss: 2.068, Global test accuracy: 30.90
Round  26, Train loss: 1.917, Test loss: 1.432, Test accuracy: 49.70
Round  26, Global train loss: 1.917, Global test loss: 2.125, Global test accuracy: 27.62
Round  27, Train loss: 1.581, Test loss: 1.431, Test accuracy: 51.52
Round  27, Global train loss: 1.581, Global test loss: 2.007, Global test accuracy: 32.00
Round  28, Train loss: 1.911, Test loss: 1.429, Test accuracy: 51.72
Round  28, Global train loss: 1.911, Global test loss: 2.162, Global test accuracy: 19.14
Round  29, Train loss: 1.695, Test loss: 1.443, Test accuracy: 51.06
Round  29, Global train loss: 1.695, Global test loss: 2.070, Global test accuracy: 28.50
Round  30, Train loss: 1.788, Test loss: 1.432, Test accuracy: 51.40
Round  30, Global train loss: 1.788, Global test loss: 2.087, Global test accuracy: 32.10
Round  31, Train loss: 1.243, Test loss: 1.402, Test accuracy: 53.06
Round  31, Global train loss: 1.243, Global test loss: 1.737, Global test accuracy: 41.64
Round  32, Train loss: 1.751, Test loss: 1.381, Test accuracy: 53.40
Round  32, Global train loss: 1.751, Global test loss: 2.052, Global test accuracy: 25.32
Round  33, Train loss: 1.719, Test loss: 1.434, Test accuracy: 51.14
Round  33, Global train loss: 1.719, Global test loss: 2.054, Global test accuracy: 24.34
Round  34, Train loss: 1.674, Test loss: 1.423, Test accuracy: 50.96
Round  34, Global train loss: 1.674, Global test loss: 2.269, Global test accuracy: 17.54
Round  35, Train loss: 1.683, Test loss: 1.406, Test accuracy: 50.26
Round  35, Global train loss: 1.683, Global test loss: 1.995, Global test accuracy: 28.90
Round  36, Train loss: 1.791, Test loss: 1.411, Test accuracy: 48.94
Round  36, Global train loss: 1.791, Global test loss: 2.269, Global test accuracy: 19.54
Round  37, Train loss: 1.705, Test loss: 1.430, Test accuracy: 50.52
Round  37, Global train loss: 1.705, Global test loss: 2.038, Global test accuracy: 25.78
Round  38, Train loss: 1.678, Test loss: 1.409, Test accuracy: 50.56
Round  38, Global train loss: 1.678, Global test loss: 1.980, Global test accuracy: 26.52
Round  39, Train loss: 1.497, Test loss: 1.414, Test accuracy: 49.88
Round  39, Global train loss: 1.497, Global test loss: 1.920, Global test accuracy: 31.62
Round  40, Train loss: 1.630, Test loss: 1.422, Test accuracy: 49.94
Round  40, Global train loss: 1.630, Global test loss: 2.177, Global test accuracy: 18.98
Round  41, Train loss: 1.798, Test loss: 1.391, Test accuracy: 50.90
Round  41, Global train loss: 1.798, Global test loss: 2.298, Global test accuracy: 21.34
Round  42, Train loss: 1.517, Test loss: 1.390, Test accuracy: 51.60
Round  42, Global train loss: 1.517, Global test loss: 2.102, Global test accuracy: 28.96
Round  43, Train loss: 1.453, Test loss: 1.361, Test accuracy: 52.82
Round  43, Global train loss: 1.453, Global test loss: 2.093, Global test accuracy: 26.88
Round  44, Train loss: 1.796, Test loss: 1.392, Test accuracy: 51.10
Round  44, Global train loss: 1.796, Global test loss: 2.171, Global test accuracy: 23.74
Round  45, Train loss: 1.270, Test loss: 1.374, Test accuracy: 53.30
Round  45, Global train loss: 1.270, Global test loss: 2.232, Global test accuracy: 31.16
Round  46, Train loss: 1.630, Test loss: 1.387, Test accuracy: 52.06
Round  46, Global train loss: 1.630, Global test loss: 1.987, Global test accuracy: 24.10
Round  47, Train loss: 1.552, Test loss: 1.370, Test accuracy: 52.40
Round  47, Global train loss: 1.552, Global test loss: 1.993, Global test accuracy: 26.88
Round  48, Train loss: 1.616, Test loss: 1.361, Test accuracy: 51.56
Round  48, Global train loss: 1.616, Global test loss: 2.063, Global test accuracy: 27.56
Round  49, Train loss: 1.441, Test loss: 1.336, Test accuracy: 53.88
Round  49, Global train loss: 1.441, Global test loss: 2.151, Global test accuracy: 28.70
Round  50, Train loss: 1.239, Test loss: 1.372, Test accuracy: 52.40
Round  50, Global train loss: 1.239, Global test loss: 2.187, Global test accuracy: 33.42
Round  51, Train loss: 1.608, Test loss: 1.357, Test accuracy: 52.46
Round  51, Global train loss: 1.608, Global test loss: 2.031, Global test accuracy: 25.28
Round  52, Train loss: 1.367, Test loss: 1.324, Test accuracy: 53.14
Round  52, Global train loss: 1.367, Global test loss: 1.996, Global test accuracy: 30.46
Round  53, Train loss: 1.492, Test loss: 1.366, Test accuracy: 51.06
Round  53, Global train loss: 1.492, Global test loss: 2.023, Global test accuracy: 26.64
Round  54, Train loss: 1.663, Test loss: 1.395, Test accuracy: 49.18
Round  54, Global train loss: 1.663, Global test loss: 2.656, Global test accuracy: 16.30
Round  55, Train loss: 1.505, Test loss: 1.377, Test accuracy: 50.40
Round  55, Global train loss: 1.505, Global test loss: 2.046, Global test accuracy: 32.08
Round  56, Train loss: 1.660, Test loss: 1.366, Test accuracy: 51.08
Round  56, Global train loss: 1.660, Global test loss: 2.301, Global test accuracy: 23.06
Round  57, Train loss: 1.406, Test loss: 1.344, Test accuracy: 51.50
Round  57, Global train loss: 1.406, Global test loss: 2.077, Global test accuracy: 31.12
Round  58, Train loss: 1.666, Test loss: 1.369, Test accuracy: 49.60
Round  58, Global train loss: 1.666, Global test loss: 2.258, Global test accuracy: 16.02
Round  59, Train loss: 1.174, Test loss: 1.354, Test accuracy: 51.10
Round  59, Global train loss: 1.174, Global test loss: 2.144, Global test accuracy: 33.16
Round  60, Train loss: 1.125, Test loss: 1.329, Test accuracy: 51.88
Round  60, Global train loss: 1.125, Global test loss: 1.952, Global test accuracy: 31.16
Round  61, Train loss: 1.235, Test loss: 1.377, Test accuracy: 50.32
Round  61, Global train loss: 1.235, Global test loss: 2.121, Global test accuracy: 32.18
Round  62, Train loss: 1.311, Test loss: 1.345, Test accuracy: 51.26
Round  62, Global train loss: 1.311, Global test loss: 1.936, Global test accuracy: 34.10
Round  63, Train loss: 1.551, Test loss: 1.339, Test accuracy: 51.72
Round  63, Global train loss: 1.551, Global test loss: 2.032, Global test accuracy: 36.88
Round  64, Train loss: 1.274, Test loss: 1.319, Test accuracy: 52.50
Round  64, Global train loss: 1.274, Global test loss: 1.824, Global test accuracy: 41.80
Round  65, Train loss: 1.279, Test loss: 1.367, Test accuracy: 49.26
Round  65, Global train loss: 1.279, Global test loss: 1.954, Global test accuracy: 35.78
Round  66, Train loss: 0.888, Test loss: 1.317, Test accuracy: 53.18
Round  66, Global train loss: 0.888, Global test loss: 2.053, Global test accuracy: 36.98
Round  67, Train loss: 1.607, Test loss: 1.388, Test accuracy: 49.00
Round  67, Global train loss: 1.607, Global test loss: 2.220, Global test accuracy: 20.74
Round  68, Train loss: 1.335, Test loss: 1.381, Test accuracy: 49.50
Round  68, Global train loss: 1.335, Global test loss: 2.086, Global test accuracy: 28.24
Round  69, Train loss: 1.547, Test loss: 1.428, Test accuracy: 46.34
Round  69, Global train loss: 1.547, Global test loss: 2.667, Global test accuracy: 16.16
Round  70, Train loss: 1.581, Test loss: 1.395, Test accuracy: 47.48
Round  70, Global train loss: 1.581, Global test loss: 2.186, Global test accuracy: 27.22
Round  71, Train loss: 1.427, Test loss: 1.379, Test accuracy: 48.86
Round  71, Global train loss: 1.427, Global test loss: 2.045, Global test accuracy: 31.66
Round  72, Train loss: 1.229, Test loss: 1.387, Test accuracy: 48.38
Round  72, Global train loss: 1.229, Global test loss: 2.109, Global test accuracy: 33.30
Round  73, Train loss: 1.344, Test loss: 1.389, Test accuracy: 47.84
Round  73, Global train loss: 1.344, Global test loss: 2.076, Global test accuracy: 31.84
Round  74, Train loss: 1.225, Test loss: 1.389, Test accuracy: 47.44
Round  74, Global train loss: 1.225, Global test loss: 1.946, Global test accuracy: 32.18
Round  75, Train loss: 1.276, Test loss: 1.406, Test accuracy: 47.00
Round  75, Global train loss: 1.276, Global test loss: 2.010, Global test accuracy: 34.16
Round  76, Train loss: 1.331, Test loss: 1.413, Test accuracy: 46.86
Round  76, Global train loss: 1.331, Global test loss: 2.084, Global test accuracy: 30.90
Round  77, Train loss: 1.234, Test loss: 1.431, Test accuracy: 46.92
Round  77, Global train loss: 1.234, Global test loss: 2.180, Global test accuracy: 27.40
Round  78, Train loss: 1.446, Test loss: 1.444, Test accuracy: 45.44
Round  78, Global train loss: 1.446, Global test loss: 2.352, Global test accuracy: 18.16
Round  79, Train loss: 0.959, Test loss: 1.357, Test accuracy: 49.42
Round  79, Global train loss: 0.959, Global test loss: 1.869, Global test accuracy: 36.28
Round  80, Train loss: 1.346, Test loss: 1.408, Test accuracy: 47.50
Round  80, Global train loss: 1.346, Global test loss: 2.060, Global test accuracy: 31.14
Round  81, Train loss: 1.234, Test loss: 1.431, Test accuracy: 46.26
Round  81, Global train loss: 1.234, Global test loss: 2.044, Global test accuracy: 29.06
Round  82, Train loss: 1.330, Test loss: 1.477, Test accuracy: 44.26
Round  82, Global train loss: 1.330, Global test loss: 2.292, Global test accuracy: 21.60
Round  83, Train loss: 1.267, Test loss: 1.453, Test accuracy: 45.36
Round  83, Global train loss: 1.267, Global test loss: 2.610, Global test accuracy: 17.80
Round  84, Train loss: 1.103, Test loss: 1.414, Test accuracy: 47.78
Round  84, Global train loss: 1.103, Global test loss: 2.008, Global test accuracy: 38.00
Round  85, Train loss: 0.768, Test loss: 1.378, Test accuracy: 48.94
Round  85, Global train loss: 0.768, Global test loss: 1.695, Global test accuracy: 40.56
Round  86, Train loss: 0.880, Test loss: 1.376, Test accuracy: 49.38
Round  86, Global train loss: 0.880, Global test loss: 2.019, Global test accuracy: 32.18
Round  87, Train loss: 1.001, Test loss: 1.404, Test accuracy: 48.14
Round  87, Global train loss: 1.001, Global test loss: 2.029, Global test accuracy: 31.36
Round  88, Train loss: 1.064, Test loss: 1.426, Test accuracy: 48.04
Round  88, Global train loss: 1.064, Global test loss: 2.383, Global test accuracy: 29.28
Round  89, Train loss: 1.053, Test loss: 1.486, Test accuracy: 45.40
Round  89, Global train loss: 1.053, Global test loss: 2.257, Global test accuracy: 26.72
Round  90, Train loss: 1.029, Test loss: 1.445, Test accuracy: 46.60
Round  90, Global train loss: 1.029, Global test loss: 2.281, Global test accuracy: 30.50
Round  91, Train loss: 0.823, Test loss: 1.443, Test accuracy: 47.44
Round  91, Global train loss: 0.823, Global test loss: 2.137, Global test accuracy: 32.66
Round  92, Train loss: 1.196, Test loss: 1.461, Test accuracy: 46.52
Round  92, Global train loss: 1.196, Global test loss: 2.037, Global test accuracy: 26.62
Round  93, Train loss: 1.253, Test loss: 1.496, Test accuracy: 45.00
Round  93, Global train loss: 1.253, Global test loss: 2.277, Global test accuracy: 23.88
Round  94, Train loss: 0.976, Test loss: 1.472, Test accuracy: 45.98
Round  94, Global train loss: 0.976, Global test loss: 1.994, Global test accuracy: 32.64
Round  95, Train loss: 0.882, Test loss: 1.484, Test accuracy: 46.00
Round  95, Global train loss: 0.882, Global test loss: 1.849, Global test accuracy: 37.48
Round  96, Train loss: 1.120, Test loss: 1.503, Test accuracy: 45.80
Round  96, Global train loss: 1.120, Global test loss: 2.152, Global test accuracy: 35.06
Round  97, Train loss: 0.674, Test loss: 1.435, Test accuracy: 46.86
Round  97, Global train loss: 0.674, Global test loss: 2.254, Global test accuracy: 37.48
Round  98, Train loss: 1.145, Test loss: 1.460, Test accuracy: 46.50
Round  98, Global train loss: 1.145, Global test loss: 2.118, Global test accuracy: 26.08
Round  99, Train loss: 1.101, Test loss: 1.490, Test accuracy: 46.26
Round  99, Global train loss: 1.101, Global test loss: 1.972, Global test accuracy: 29.90
Final Round, Train loss: 0.923, Test loss: 1.526, Test accuracy: 46.02
Final Round, Global train loss: 0.923, Global test loss: 1.972, Global test accuracy: 29.90
Average accuracy final 10 rounds: 46.29599999999999
705.7289896011353
[1.671677827835083, 3.0544326305389404, 4.451457977294922, 5.821593523025513, 7.191652536392212, 8.574330806732178, 9.937063932418823, 11.316455602645874, 12.734711408615112, 14.141212224960327, 15.495588064193726, 16.86064863204956, 18.280359745025635, 19.66238784790039, 21.057940006256104, 22.487635374069214, 23.836477756500244, 25.200092792510986, 26.59211039543152, 27.931551456451416, 29.39333462715149, 30.85254693031311, 32.30101752281189, 33.670939207077026, 35.0625536441803, 36.46339678764343, 37.871009826660156, 39.28844428062439, 40.732906103134155, 42.11023712158203, 43.46986508369446, 44.877901554107666, 46.26702284812927, 47.683549880981445, 49.04800629615784, 50.4030544757843, 51.773818254470825, 53.17839813232422, 54.554362058639526, 55.98028111457825, 57.318068742752075, 58.67708730697632, 60.068642139434814, 61.47619962692261, 63.00331473350525, 64.362872838974, 65.7490165233612, 67.19356417655945, 68.5610179901123, 69.92185354232788, 71.32426428794861, 72.6941659450531, 74.08925294876099, 75.46441411972046, 76.81596350669861, 78.21791887283325, 79.6641857624054, 81.02971053123474, 82.36999869346619, 83.743812084198, 85.18491339683533, 86.6420521736145, 88.01887726783752, 89.38523817062378, 90.72320437431335, 92.10285377502441, 93.49641442298889, 94.92008566856384, 96.27566933631897, 97.61840510368347, 99.00265455245972, 100.37750816345215, 101.79785394668579, 103.19848227500916, 104.5764639377594, 105.970778465271, 107.37027096748352, 108.78934979438782, 110.16839909553528, 111.77672076225281, 113.11919379234314, 114.50672006607056, 115.89442873001099, 117.29203629493713, 118.68773436546326, 120.05379486083984, 121.41452193260193, 122.7965681552887, 124.20328617095947, 125.56319785118103, 126.94943642616272, 128.33924913406372, 129.69812107086182, 131.0902922153473, 132.46185064315796, 133.82888507843018, 135.15904426574707, 136.56246423721313, 137.99671077728271, 139.4268069267273, 141.69012451171875]
[10.02, 20.98, 25.2, 32.86, 34.6, 41.5, 45.06, 47.9, 47.26, 45.66, 46.14, 48.62, 49.02, 49.44, 48.8, 49.6, 50.72, 49.26, 48.72, 50.54, 50.96, 52.4, 50.46, 51.42, 50.96, 50.86, 49.7, 51.52, 51.72, 51.06, 51.4, 53.06, 53.4, 51.14, 50.96, 50.26, 48.94, 50.52, 50.56, 49.88, 49.94, 50.9, 51.6, 52.82, 51.1, 53.3, 52.06, 52.4, 51.56, 53.88, 52.4, 52.46, 53.14, 51.06, 49.18, 50.4, 51.08, 51.5, 49.6, 51.1, 51.88, 50.32, 51.26, 51.72, 52.5, 49.26, 53.18, 49.0, 49.5, 46.34, 47.48, 48.86, 48.38, 47.84, 47.44, 47.0, 46.86, 46.92, 45.44, 49.42, 47.5, 46.26, 44.26, 45.36, 47.78, 48.94, 49.38, 48.14, 48.04, 45.4, 46.6, 47.44, 46.52, 45.0, 45.98, 46.0, 45.8, 46.86, 46.5, 46.26, 46.02]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.091, Test loss: 2.035, Test accuracy: 24.12
Round   0, Global train loss: 2.091, Global test loss: 2.270, Global test accuracy: 16.90
Round   1, Train loss: 1.906, Test loss: 1.795, Test accuracy: 31.48
Round   1, Global train loss: 1.906, Global test loss: 2.215, Global test accuracy: 20.94
Round   2, Train loss: 1.841, Test loss: 1.703, Test accuracy: 33.98
Round   2, Global train loss: 1.841, Global test loss: 2.168, Global test accuracy: 24.80
Round   3, Train loss: 1.806, Test loss: 1.655, Test accuracy: 36.58
Round   3, Global train loss: 1.806, Global test loss: 2.143, Global test accuracy: 25.58
Round   4, Train loss: 1.784, Test loss: 1.630, Test accuracy: 38.72
Round   4, Global train loss: 1.784, Global test loss: 2.112, Global test accuracy: 27.38
Round   5, Train loss: 1.763, Test loss: 1.594, Test accuracy: 40.04
Round   5, Global train loss: 1.763, Global test loss: 2.082, Global test accuracy: 27.14
Round   6, Train loss: 1.746, Test loss: 1.569, Test accuracy: 39.42
Round   6, Global train loss: 1.746, Global test loss: 2.062, Global test accuracy: 31.14
Round   7, Train loss: 1.730, Test loss: 1.542, Test accuracy: 42.32
Round   7, Global train loss: 1.730, Global test loss: 2.041, Global test accuracy: 31.76
Round   8, Train loss: 1.714, Test loss: 1.530, Test accuracy: 43.30
Round   8, Global train loss: 1.714, Global test loss: 2.025, Global test accuracy: 30.74
Round   9, Train loss: 1.697, Test loss: 1.509, Test accuracy: 44.14
Round   9, Global train loss: 1.697, Global test loss: 2.007, Global test accuracy: 32.46
Round  10, Train loss: 1.788, Test loss: 1.533, Test accuracy: 44.52
Round  10, Global train loss: 1.788, Global test loss: 2.190, Global test accuracy: 15.38
Round  11, Train loss: 1.542, Test loss: 1.506, Test accuracy: 42.94
Round  11, Global train loss: 1.542, Global test loss: 2.615, Global test accuracy: 15.00
Round  12, Train loss: 1.399, Test loss: 1.502, Test accuracy: 40.82
Round  12, Global train loss: 1.399, Global test loss: 2.208, Global test accuracy: 19.26
Round  13, Train loss: 1.375, Test loss: 1.497, Test accuracy: 41.10
Round  13, Global train loss: 1.375, Global test loss: 2.336, Global test accuracy: 20.10
Round  14, Train loss: 1.407, Test loss: 1.529, Test accuracy: 36.92
Round  14, Global train loss: 1.407, Global test loss: 2.087, Global test accuracy: 28.40
Round  15, Train loss: 1.562, Test loss: 1.433, Test accuracy: 46.28
Round  15, Global train loss: 1.562, Global test loss: 2.038, Global test accuracy: 30.70
Round  16, Train loss: 1.398, Test loss: 1.469, Test accuracy: 42.40
Round  16, Global train loss: 1.398, Global test loss: 2.173, Global test accuracy: 19.78
Round  17, Train loss: 1.434, Test loss: 1.433, Test accuracy: 44.44
Round  17, Global train loss: 1.434, Global test loss: 1.940, Global test accuracy: 29.20
Round  18, Train loss: 1.325, Test loss: 1.405, Test accuracy: 47.90
Round  18, Global train loss: 1.325, Global test loss: 1.980, Global test accuracy: 29.20
Round  19, Train loss: 1.376, Test loss: 1.400, Test accuracy: 47.62
Round  19, Global train loss: 1.376, Global test loss: 2.211, Global test accuracy: 15.16
Round  20, Train loss: 1.533, Test loss: 1.411, Test accuracy: 47.50
Round  20, Global train loss: 1.533, Global test loss: 1.967, Global test accuracy: 28.80
Round  21, Train loss: 1.438, Test loss: 1.423, Test accuracy: 45.06
Round  21, Global train loss: 1.438, Global test loss: 2.485, Global test accuracy: 21.16
Round  22, Train loss: 1.528, Test loss: 1.439, Test accuracy: 44.72
Round  22, Global train loss: 1.528, Global test loss: 2.557, Global test accuracy: 13.30
Round  23, Train loss: 1.447, Test loss: 1.437, Test accuracy: 45.72
Round  23, Global train loss: 1.447, Global test loss: 2.260, Global test accuracy: 24.46
Round  24, Train loss: 1.404, Test loss: 1.394, Test accuracy: 47.80
Round  24, Global train loss: 1.404, Global test loss: 2.167, Global test accuracy: 26.50
Round  25, Train loss: 1.533, Test loss: 1.423, Test accuracy: 45.72
Round  25, Global train loss: 1.533, Global test loss: 2.466, Global test accuracy: 12.92
Round  26, Train loss: 1.138, Test loss: 1.389, Test accuracy: 51.92
Round  26, Global train loss: 1.138, Global test loss: 1.859, Global test accuracy: 40.22
Round  27, Train loss: 1.489, Test loss: 1.368, Test accuracy: 51.20
Round  27, Global train loss: 1.489, Global test loss: 2.119, Global test accuracy: 29.50
Round  28, Train loss: 1.224, Test loss: 1.366, Test accuracy: 52.58
Round  28, Global train loss: 1.224, Global test loss: 1.884, Global test accuracy: 37.76
Round  29, Train loss: 1.496, Test loss: 1.344, Test accuracy: 52.62
Round  29, Global train loss: 1.496, Global test loss: 1.930, Global test accuracy: 26.80
Round  30, Train loss: 1.270, Test loss: 1.377, Test accuracy: 51.56
Round  30, Global train loss: 1.270, Global test loss: 2.368, Global test accuracy: 20.22
Round  31, Train loss: 1.388, Test loss: 1.365, Test accuracy: 51.36
Round  31, Global train loss: 1.388, Global test loss: 2.008, Global test accuracy: 16.58
Round  32, Train loss: 1.281, Test loss: 1.367, Test accuracy: 51.52
Round  32, Global train loss: 1.281, Global test loss: 1.881, Global test accuracy: 33.64
Round  33, Train loss: 1.482, Test loss: 1.386, Test accuracy: 48.50
Round  33, Global train loss: 1.482, Global test loss: 2.504, Global test accuracy: 13.50
Round  34, Train loss: 1.432, Test loss: 1.359, Test accuracy: 50.28
Round  34, Global train loss: 1.432, Global test loss: 2.098, Global test accuracy: 30.58
Round  35, Train loss: 1.306, Test loss: 1.364, Test accuracy: 49.34
Round  35, Global train loss: 1.306, Global test loss: 1.802, Global test accuracy: 37.58
Round  36, Train loss: 1.186, Test loss: 1.343, Test accuracy: 51.38
Round  36, Global train loss: 1.186, Global test loss: 1.951, Global test accuracy: 33.80
Round  37, Train loss: 1.480, Test loss: 1.391, Test accuracy: 47.50
Round  37, Global train loss: 1.480, Global test loss: 2.597, Global test accuracy: 11.50
Round  38, Train loss: 1.473, Test loss: 1.412, Test accuracy: 46.30
Round  38, Global train loss: 1.473, Global test loss: 2.555, Global test accuracy: 18.60
Round  39, Train loss: 1.465, Test loss: 1.408, Test accuracy: 46.76
Round  39, Global train loss: 1.465, Global test loss: 2.406, Global test accuracy: 21.32
Round  40, Train loss: 1.469, Test loss: 1.432, Test accuracy: 44.56
Round  40, Global train loss: 1.469, Global test loss: 2.383, Global test accuracy: 16.60
Round  41, Train loss: 1.154, Test loss: 1.361, Test accuracy: 51.30
Round  41, Global train loss: 1.154, Global test loss: 1.942, Global test accuracy: 36.80
Round  42, Train loss: 1.414, Test loss: 1.414, Test accuracy: 47.66
Round  42, Global train loss: 1.414, Global test loss: 3.011, Global test accuracy: 16.64
Round  43, Train loss: 1.363, Test loss: 1.316, Test accuracy: 53.00
Round  43, Global train loss: 1.363, Global test loss: 1.998, Global test accuracy: 29.70
Round  44, Train loss: 1.081, Test loss: 1.321, Test accuracy: 52.20
Round  44, Global train loss: 1.081, Global test loss: 1.847, Global test accuracy: 39.08
Round  45, Train loss: 1.301, Test loss: 1.345, Test accuracy: 51.58
Round  45, Global train loss: 1.301, Global test loss: 2.330, Global test accuracy: 26.38
Round  46, Train loss: 1.413, Test loss: 1.373, Test accuracy: 50.54
Round  46, Global train loss: 1.413, Global test loss: 2.496, Global test accuracy: 19.30
Round  47, Train loss: 1.215, Test loss: 1.324, Test accuracy: 52.14
Round  47, Global train loss: 1.215, Global test loss: 1.783, Global test accuracy: 37.48
Round  48, Train loss: 1.178, Test loss: 1.332, Test accuracy: 52.90
Round  48, Global train loss: 1.178, Global test loss: 1.995, Global test accuracy: 29.60
Round  49, Train loss: 1.146, Test loss: 1.320, Test accuracy: 52.80
Round  49, Global train loss: 1.146, Global test loss: 1.818, Global test accuracy: 37.98
Round  50, Train loss: 1.344, Test loss: 1.390, Test accuracy: 48.06
Round  50, Global train loss: 1.344, Global test loss: 2.923, Global test accuracy: 17.16
Round  51, Train loss: 1.207, Test loss: 1.345, Test accuracy: 51.74
Round  51, Global train loss: 1.207, Global test loss: 2.155, Global test accuracy: 27.38
Round  52, Train loss: 1.206, Test loss: 1.303, Test accuracy: 53.88
Round  52, Global train loss: 1.206, Global test loss: 1.943, Global test accuracy: 32.42
Round  53, Train loss: 1.332, Test loss: 1.302, Test accuracy: 54.92
Round  53, Global train loss: 1.332, Global test loss: 1.905, Global test accuracy: 29.20
Round  54, Train loss: 1.328, Test loss: 1.333, Test accuracy: 52.48
Round  54, Global train loss: 1.328, Global test loss: 2.274, Global test accuracy: 28.56
Round  55, Train loss: 0.979, Test loss: 1.263, Test accuracy: 56.90
Round  55, Global train loss: 0.979, Global test loss: 1.806, Global test accuracy: 40.70
Round  56, Train loss: 0.985, Test loss: 1.290, Test accuracy: 54.62
Round  56, Global train loss: 0.985, Global test loss: 1.847, Global test accuracy: 39.30
Round  57, Train loss: 1.255, Test loss: 1.310, Test accuracy: 52.64
Round  57, Global train loss: 1.255, Global test loss: 2.492, Global test accuracy: 19.56
Round  58, Train loss: 1.224, Test loss: 1.362, Test accuracy: 49.08
Round  58, Global train loss: 1.224, Global test loss: 2.159, Global test accuracy: 21.72
Round  59, Train loss: 1.190, Test loss: 1.370, Test accuracy: 47.70
Round  59, Global train loss: 1.190, Global test loss: 2.351, Global test accuracy: 19.16
Round  60, Train loss: 1.296, Test loss: 1.321, Test accuracy: 50.98
Round  60, Global train loss: 1.296, Global test loss: 2.240, Global test accuracy: 14.14
Round  61, Train loss: 1.235, Test loss: 1.343, Test accuracy: 50.32
Round  61, Global train loss: 1.235, Global test loss: 2.179, Global test accuracy: 24.32
Round  62, Train loss: 1.223, Test loss: 1.326, Test accuracy: 51.52
Round  62, Global train loss: 1.223, Global test loss: 2.235, Global test accuracy: 28.80
Round  63, Train loss: 0.993, Test loss: 1.292, Test accuracy: 52.96
Round  63, Global train loss: 0.993, Global test loss: 2.139, Global test accuracy: 36.70
Round  64, Train loss: 1.169, Test loss: 1.297, Test accuracy: 52.94
Round  64, Global train loss: 1.169, Global test loss: 2.108, Global test accuracy: 32.62
Round  65, Train loss: 1.127, Test loss: 1.320, Test accuracy: 51.44
Round  65, Global train loss: 1.127, Global test loss: 2.455, Global test accuracy: 19.60
Round  66, Train loss: 1.158, Test loss: 1.367, Test accuracy: 48.38
Round  66, Global train loss: 1.158, Global test loss: 2.456, Global test accuracy: 20.00
Round  67, Train loss: 1.211, Test loss: 1.328, Test accuracy: 51.18
Round  67, Global train loss: 1.211, Global test loss: 1.983, Global test accuracy: 31.86
Round  68, Train loss: 0.992, Test loss: 1.304, Test accuracy: 52.52
Round  68, Global train loss: 0.992, Global test loss: 1.865, Global test accuracy: 34.50
Round  69, Train loss: 1.277, Test loss: 1.394, Test accuracy: 48.06
Round  69, Global train loss: 1.277, Global test loss: 2.375, Global test accuracy: 18.90
Round  70, Train loss: 0.822, Test loss: 1.273, Test accuracy: 53.84
Round  70, Global train loss: 0.822, Global test loss: 1.867, Global test accuracy: 42.38
Round  71, Train loss: 0.971, Test loss: 1.314, Test accuracy: 51.90
Round  71, Global train loss: 0.971, Global test loss: 2.375, Global test accuracy: 26.64
Round  72, Train loss: 1.236, Test loss: 1.416, Test accuracy: 46.40
Round  72, Global train loss: 1.236, Global test loss: 2.272, Global test accuracy: 17.72
Round  73, Train loss: 0.823, Test loss: 1.257, Test accuracy: 53.96
Round  73, Global train loss: 0.823, Global test loss: 1.911, Global test accuracy: 44.40
Round  74, Train loss: 1.210, Test loss: 1.371, Test accuracy: 48.80
Round  74, Global train loss: 1.210, Global test loss: 2.565, Global test accuracy: 17.70
Round  75, Train loss: 0.950, Test loss: 1.287, Test accuracy: 53.24
Round  75, Global train loss: 0.950, Global test loss: 1.715, Global test accuracy: 42.62
Round  76, Train loss: 0.980, Test loss: 1.346, Test accuracy: 50.66
Round  76, Global train loss: 0.980, Global test loss: 2.470, Global test accuracy: 21.80
Round  77, Train loss: 0.960, Test loss: 1.335, Test accuracy: 52.00
Round  77, Global train loss: 0.960, Global test loss: 1.984, Global test accuracy: 37.70
Round  78, Train loss: 1.136, Test loss: 1.344, Test accuracy: 50.72
Round  78, Global train loss: 1.136, Global test loss: 2.129, Global test accuracy: 26.84
Round  79, Train loss: 1.047, Test loss: 1.335, Test accuracy: 51.66
Round  79, Global train loss: 1.047, Global test loss: 1.808, Global test accuracy: 38.22
Round  80, Train loss: 0.756, Test loss: 1.264, Test accuracy: 55.24
Round  80, Global train loss: 0.756, Global test loss: 1.802, Global test accuracy: 44.80
Round  81, Train loss: 0.707, Test loss: 1.282, Test accuracy: 54.62
Round  81, Global train loss: 0.707, Global test loss: 1.799, Global test accuracy: 44.02
Round  82, Train loss: 0.671, Test loss: 1.315, Test accuracy: 54.72
Round  82, Global train loss: 0.671, Global test loss: 1.885, Global test accuracy: 44.78
Round  83, Train loss: 0.660, Test loss: 1.306, Test accuracy: 53.86
Round  83, Global train loss: 0.660, Global test loss: 1.830, Global test accuracy: 45.48
Round  84, Train loss: 0.625, Test loss: 1.327, Test accuracy: 53.04
Round  84, Global train loss: 0.625, Global test loss: 1.844, Global test accuracy: 44.82
Round  85, Train loss: 0.600, Test loss: 1.319, Test accuracy: 53.38
Round  85, Global train loss: 0.600, Global test loss: 1.862, Global test accuracy: 45.08
Round  86, Train loss: 0.582, Test loss: 1.330, Test accuracy: 53.12
Round  86, Global train loss: 0.582, Global test loss: 1.899, Global test accuracy: 44.20
Round  87, Train loss: 0.548, Test loss: 1.350, Test accuracy: 52.76
Round  87, Global train loss: 0.548, Global test loss: 1.952, Global test accuracy: 44.36
Round  88, Train loss: 0.534, Test loss: 1.364, Test accuracy: 52.48
Round  88, Global train loss: 0.534, Global test loss: 1.932, Global test accuracy: 44.22
Round  89, Train loss: 0.535, Test loss: 1.327, Test accuracy: 53.22
Round  89, Global train loss: 0.535, Global test loss: 1.929, Global test accuracy: 43.96
Round  90, Train loss: 0.527, Test loss: 1.357, Test accuracy: 52.02
Round  90, Global train loss: 0.527, Global test loss: 1.930, Global test accuracy: 44.76
Round  91, Train loss: 0.496, Test loss: 1.332, Test accuracy: 54.00
Round  91, Global train loss: 0.496, Global test loss: 1.998, Global test accuracy: 44.10
Round  92, Train loss: 0.492, Test loss: 1.335, Test accuracy: 54.10
Round  92, Global train loss: 0.492, Global test loss: 1.976, Global test accuracy: 45.46
Round  93, Train loss: 0.463, Test loss: 1.394, Test accuracy: 52.26
Round  93, Global train loss: 0.463, Global test loss: 2.052, Global test accuracy: 44.12
Round  94, Train loss: 0.450, Test loss: 1.395, Test accuracy: 52.42
Round  94, Global train loss: 0.450, Global test loss: 2.019, Global test accuracy: 45.76
Round  95, Train loss: 0.466, Test loss: 1.389, Test accuracy: 52.02
Round  95, Global train loss: 0.466, Global test loss: 1.982, Global test accuracy: 44.92
Round  96, Train loss: 0.437, Test loss: 1.396, Test accuracy: 53.46
Round  96, Global train loss: 0.437, Global test loss: 2.059, Global test accuracy: 45.36
Round  97, Train loss: 0.410, Test loss: 1.414, Test accuracy: 52.64
Round  97, Global train loss: 0.410, Global test loss: 2.094, Global test accuracy: 45.52
Round  98, Train loss: 0.407, Test loss: 1.429, Test accuracy: 51.72
Round  98, Global train loss: 0.407, Global test loss: 2.132, Global test accuracy: 43.68
Round  99, Train loss: 0.866, Test loss: 1.459, Test accuracy: 49.56
Round  99, Global train loss: 0.866, Global test loss: 1.750, Global test accuracy: 41.96
Final Round, Train loss: 0.825, Test loss: 1.492, Test accuracy: 49.04
Final Round, Global train loss: 0.825, Global test loss: 1.750, Global test accuracy: 41.96
Average accuracy final 10 rounds: 52.42000000000001
1972.4098386764526
[1.9673523902893066, 3.5541610717773438, 5.208708047866821, 7.032963752746582, 8.650346994400024, 10.239096641540527, 11.844526290893555, 13.405219078063965, 15.077324390411377, 16.7753324508667, 22.53033447265625, 31.003945112228394, 39.46508073806763, 48.070828914642334, 56.5648295879364, 65.09237456321716, 73.49220490455627, 82.08849120140076, 90.80828595161438, 99.24664640426636, 108.1010251045227, 116.9262547492981, 125.52849221229553, 134.0131425857544, 142.62965488433838, 150.94998264312744, 159.4159119129181, 167.99175095558167, 176.6073145866394, 185.01943588256836, 193.34461402893066, 201.8327693939209, 210.30850172042847, 218.8652744293213, 227.24921894073486, 235.7065896987915, 244.03266716003418, 252.56826043128967, 261.07853651046753, 269.5742745399475, 278.2475459575653, 286.4806332588196, 295.11833095550537, 303.4312810897827, 312.1321015357971, 320.68458366394043, 329.1351420879364, 337.65349078178406, 346.35870599746704, 354.88030552864075, 363.5704023838043, 371.822557926178, 380.27382922172546, 388.7178955078125, 397.26461911201477, 398.84480142593384, 407.4882011413574, 415.91059017181396, 424.62806582450867, 433.06463289260864, 441.64259815216064, 449.9914243221283, 458.33878564834595, 466.85672521591187, 475.43508195877075, 483.9399800300598, 492.332213640213, 501.08473348617554, 509.5175278186798, 518.1161878108978, 526.8380446434021, 535.3875913619995, 544.1649634838104, 552.6402959823608, 560.98877120018, 562.5819787979126, 571.0110964775085, 579.3858625888824, 587.6517539024353, 595.8710346221924, 597.491161108017, 599.0516333580017, 600.6053085327148, 602.1507315635681, 603.8029503822327, 605.4331362247467, 607.0679700374603, 608.6470994949341, 610.2193853855133, 611.9419384002686, 613.5680935382843, 615.1664147377014, 616.7776212692261, 618.4422478675842, 620.0562670230865, 621.6190969944, 623.1929550170898, 624.7685303688049, 626.378172159195, 634.8100919723511, 644.1640198230743]
[24.12, 31.48, 33.98, 36.58, 38.72, 40.04, 39.42, 42.32, 43.3, 44.14, 44.52, 42.94, 40.82, 41.1, 36.92, 46.28, 42.4, 44.44, 47.9, 47.62, 47.5, 45.06, 44.72, 45.72, 47.8, 45.72, 51.92, 51.2, 52.58, 52.62, 51.56, 51.36, 51.52, 48.5, 50.28, 49.34, 51.38, 47.5, 46.3, 46.76, 44.56, 51.3, 47.66, 53.0, 52.2, 51.58, 50.54, 52.14, 52.9, 52.8, 48.06, 51.74, 53.88, 54.92, 52.48, 56.9, 54.62, 52.64, 49.08, 47.7, 50.98, 50.32, 51.52, 52.96, 52.94, 51.44, 48.38, 51.18, 52.52, 48.06, 53.84, 51.9, 46.4, 53.96, 48.8, 53.24, 50.66, 52.0, 50.72, 51.66, 55.24, 54.62, 54.72, 53.86, 53.04, 53.38, 53.12, 52.76, 52.48, 53.22, 52.02, 54.0, 54.1, 52.26, 52.42, 52.02, 53.46, 52.64, 51.72, 49.56, 49.04]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.880, Test loss: 2.141, Test accuracy: 16.62
Round   0, Global train loss: 1.880, Global test loss: 2.297, Global test accuracy: 11.40
Round   1, Train loss: 1.854, Test loss: 2.060, Test accuracy: 21.88
Round   1, Global train loss: 1.854, Global test loss: 2.308, Global test accuracy: 13.70
Round   2, Train loss: 2.043, Test loss: 1.766, Test accuracy: 36.84
Round   2, Global train loss: 2.043, Global test loss: 2.200, Global test accuracy: 22.22
Round   3, Train loss: 1.851, Test loss: 1.746, Test accuracy: 40.72
Round   3, Global train loss: 1.851, Global test loss: 2.268, Global test accuracy: 19.70
Round   4, Train loss: 1.771, Test loss: 1.662, Test accuracy: 42.70
Round   4, Global train loss: 1.771, Global test loss: 2.195, Global test accuracy: 17.90
Round   5, Train loss: 1.867, Test loss: 1.627, Test accuracy: 47.06
Round   5, Global train loss: 1.867, Global test loss: 2.196, Global test accuracy: 22.92
Round   6, Train loss: 1.662, Test loss: 1.663, Test accuracy: 40.92
Round   6, Global train loss: 1.662, Global test loss: 2.291, Global test accuracy: 17.00
Round   7, Train loss: 1.771, Test loss: 1.509, Test accuracy: 49.04
Round   7, Global train loss: 1.771, Global test loss: 2.230, Global test accuracy: 22.50
Round   8, Train loss: 1.704, Test loss: 1.474, Test accuracy: 50.94
Round   8, Global train loss: 1.704, Global test loss: 2.153, Global test accuracy: 28.16
Round   9, Train loss: 1.795, Test loss: 1.496, Test accuracy: 50.48
Round   9, Global train loss: 1.795, Global test loss: 2.251, Global test accuracy: 22.12
Round  10, Train loss: 1.658, Test loss: 1.377, Test accuracy: 54.98
Round  10, Global train loss: 1.658, Global test loss: 2.161, Global test accuracy: 32.90
Round  11, Train loss: 1.758, Test loss: 1.369, Test accuracy: 55.70
Round  11, Global train loss: 1.758, Global test loss: 2.157, Global test accuracy: 21.20
Round  12, Train loss: 1.643, Test loss: 1.379, Test accuracy: 55.90
Round  12, Global train loss: 1.643, Global test loss: 2.197, Global test accuracy: 23.80
Round  13, Train loss: 1.798, Test loss: 1.355, Test accuracy: 56.94
Round  13, Global train loss: 1.798, Global test loss: 2.162, Global test accuracy: 31.28
Round  14, Train loss: 1.528, Test loss: 1.339, Test accuracy: 57.98
Round  14, Global train loss: 1.528, Global test loss: 2.107, Global test accuracy: 30.80
Round  15, Train loss: 1.692, Test loss: 1.341, Test accuracy: 57.30
Round  15, Global train loss: 1.692, Global test loss: 2.225, Global test accuracy: 22.20
Round  16, Train loss: 1.640, Test loss: 1.317, Test accuracy: 58.74
Round  16, Global train loss: 1.640, Global test loss: 2.149, Global test accuracy: 29.68
Round  17, Train loss: 1.645, Test loss: 1.306, Test accuracy: 59.56
Round  17, Global train loss: 1.645, Global test loss: 2.135, Global test accuracy: 26.30
Round  18, Train loss: 1.748, Test loss: 1.287, Test accuracy: 59.32
Round  18, Global train loss: 1.748, Global test loss: 2.260, Global test accuracy: 29.02
Round  19, Train loss: 1.465, Test loss: 1.286, Test accuracy: 60.04
Round  19, Global train loss: 1.465, Global test loss: 2.109, Global test accuracy: 33.20
Round  20, Train loss: 1.761, Test loss: 1.277, Test accuracy: 59.80
Round  20, Global train loss: 1.761, Global test loss: 2.129, Global test accuracy: 22.54
Round  21, Train loss: 1.293, Test loss: 1.268, Test accuracy: 59.72
Round  21, Global train loss: 1.293, Global test loss: 2.111, Global test accuracy: 26.78
Round  22, Train loss: 1.672, Test loss: 1.249, Test accuracy: 59.86
Round  22, Global train loss: 1.672, Global test loss: 2.142, Global test accuracy: 34.04
Round  23, Train loss: 1.295, Test loss: 1.229, Test accuracy: 60.22
Round  23, Global train loss: 1.295, Global test loss: 2.123, Global test accuracy: 32.90
Round  24, Train loss: 1.421, Test loss: 1.222, Test accuracy: 61.16
Round  24, Global train loss: 1.421, Global test loss: 2.170, Global test accuracy: 25.56
Round  25, Train loss: 1.429, Test loss: 1.203, Test accuracy: 61.66
Round  25, Global train loss: 1.429, Global test loss: 2.064, Global test accuracy: 35.16
Round  26, Train loss: 1.428, Test loss: 1.210, Test accuracy: 62.08
Round  26, Global train loss: 1.428, Global test loss: 2.058, Global test accuracy: 31.90
Round  27, Train loss: 1.557, Test loss: 1.209, Test accuracy: 61.38
Round  27, Global train loss: 1.557, Global test loss: 2.115, Global test accuracy: 29.38
Round  28, Train loss: 1.330, Test loss: 1.231, Test accuracy: 60.44
Round  28, Global train loss: 1.330, Global test loss: 2.138, Global test accuracy: 29.00
Round  29, Train loss: 1.338, Test loss: 1.223, Test accuracy: 60.54
Round  29, Global train loss: 1.338, Global test loss: 2.068, Global test accuracy: 29.24
Round  30, Train loss: 1.547, Test loss: 1.218, Test accuracy: 60.72
Round  30, Global train loss: 1.547, Global test loss: 2.203, Global test accuracy: 24.00
Round  31, Train loss: 1.544, Test loss: 1.230, Test accuracy: 60.26
Round  31, Global train loss: 1.544, Global test loss: 2.095, Global test accuracy: 29.02
Round  32, Train loss: 1.498, Test loss: 1.238, Test accuracy: 60.28
Round  32, Global train loss: 1.498, Global test loss: 2.094, Global test accuracy: 31.18
Round  33, Train loss: 1.553, Test loss: 1.235, Test accuracy: 60.00
Round  33, Global train loss: 1.553, Global test loss: 2.150, Global test accuracy: 22.12
Round  34, Train loss: 1.300, Test loss: 1.217, Test accuracy: 61.16
Round  34, Global train loss: 1.300, Global test loss: 2.149, Global test accuracy: 30.08
Round  35, Train loss: 1.514, Test loss: 1.223, Test accuracy: 60.68
Round  35, Global train loss: 1.514, Global test loss: 2.275, Global test accuracy: 24.52
Round  36, Train loss: 1.161, Test loss: 1.219, Test accuracy: 60.46
Round  36, Global train loss: 1.161, Global test loss: 2.098, Global test accuracy: 26.24
Round  37, Train loss: 1.381, Test loss: 1.221, Test accuracy: 60.12
Round  37, Global train loss: 1.381, Global test loss: 2.094, Global test accuracy: 32.02
Round  38, Train loss: 1.198, Test loss: 1.227, Test accuracy: 59.18
Round  38, Global train loss: 1.198, Global test loss: 2.153, Global test accuracy: 25.30
Round  39, Train loss: 1.219, Test loss: 1.224, Test accuracy: 59.42
Round  39, Global train loss: 1.219, Global test loss: 2.158, Global test accuracy: 25.70
Round  40, Train loss: 1.410, Test loss: 1.238, Test accuracy: 58.92
Round  40, Global train loss: 1.410, Global test loss: 2.179, Global test accuracy: 21.68
Round  41, Train loss: 1.010, Test loss: 1.253, Test accuracy: 58.56
Round  41, Global train loss: 1.010, Global test loss: 2.075, Global test accuracy: 30.26
Round  42, Train loss: 1.385, Test loss: 1.251, Test accuracy: 58.70
Round  42, Global train loss: 1.385, Global test loss: 2.185, Global test accuracy: 26.28
Round  43, Train loss: 1.335, Test loss: 1.267, Test accuracy: 57.66
Round  43, Global train loss: 1.335, Global test loss: 2.139, Global test accuracy: 22.46
Round  44, Train loss: 1.080, Test loss: 1.264, Test accuracy: 58.30
Round  44, Global train loss: 1.080, Global test loss: 2.108, Global test accuracy: 30.90
Round  45, Train loss: 1.211, Test loss: 1.304, Test accuracy: 57.22
Round  45, Global train loss: 1.211, Global test loss: 2.064, Global test accuracy: 27.12
Round  46, Train loss: 1.051, Test loss: 1.302, Test accuracy: 57.54
Round  46, Global train loss: 1.051, Global test loss: 2.139, Global test accuracy: 24.66
Round  47, Train loss: 0.964, Test loss: 1.317, Test accuracy: 57.08
Round  47, Global train loss: 0.964, Global test loss: 2.121, Global test accuracy: 25.26
Round  48, Train loss: 0.962, Test loss: 1.316, Test accuracy: 56.90
Round  48, Global train loss: 0.962, Global test loss: 2.036, Global test accuracy: 33.34
Round  49, Train loss: 0.907, Test loss: 1.332, Test accuracy: 56.70
Round  49, Global train loss: 0.907, Global test loss: 2.124, Global test accuracy: 27.56
Round  50, Train loss: 0.936, Test loss: 1.344, Test accuracy: 56.30
Round  50, Global train loss: 0.936, Global test loss: 2.041, Global test accuracy: 31.44
Round  51, Train loss: 0.696, Test loss: 1.358, Test accuracy: 56.40
Round  51, Global train loss: 0.696, Global test loss: 2.042, Global test accuracy: 30.42
Round  52, Train loss: 0.867, Test loss: 1.380, Test accuracy: 56.20
Round  52, Global train loss: 0.867, Global test loss: 2.125, Global test accuracy: 33.40
Round  53, Train loss: 0.880, Test loss: 1.411, Test accuracy: 56.34
Round  53, Global train loss: 0.880, Global test loss: 2.151, Global test accuracy: 28.84
Round  54, Train loss: 1.175, Test loss: 1.438, Test accuracy: 55.64
Round  54, Global train loss: 1.175, Global test loss: 2.136, Global test accuracy: 28.92
Round  55, Train loss: 0.911, Test loss: 1.424, Test accuracy: 55.58
Round  55, Global train loss: 0.911, Global test loss: 2.113, Global test accuracy: 30.10
Round  56, Train loss: 1.043, Test loss: 1.426, Test accuracy: 55.34
Round  56, Global train loss: 1.043, Global test loss: 2.116, Global test accuracy: 28.56
Round  57, Train loss: 0.746, Test loss: 1.497, Test accuracy: 55.72
Round  57, Global train loss: 0.746, Global test loss: 2.146, Global test accuracy: 28.00
Round  58, Train loss: 0.808, Test loss: 1.524, Test accuracy: 54.50
Round  58, Global train loss: 0.808, Global test loss: 2.096, Global test accuracy: 26.48
Round  59, Train loss: 0.783, Test loss: 1.546, Test accuracy: 53.48
Round  59, Global train loss: 0.783, Global test loss: 2.063, Global test accuracy: 30.18
Round  60, Train loss: 0.827, Test loss: 1.523, Test accuracy: 53.24
Round  60, Global train loss: 0.827, Global test loss: 2.080, Global test accuracy: 32.76
Round  61, Train loss: 0.991, Test loss: 1.531, Test accuracy: 52.64
Round  61, Global train loss: 0.991, Global test loss: 2.099, Global test accuracy: 27.14
Round  62, Train loss: 0.594, Test loss: 1.506, Test accuracy: 53.66
Round  62, Global train loss: 0.594, Global test loss: 2.050, Global test accuracy: 28.90
Round  63, Train loss: 0.993, Test loss: 1.518, Test accuracy: 53.74
Round  63, Global train loss: 0.993, Global test loss: 2.151, Global test accuracy: 22.40
Round  64, Train loss: 0.716, Test loss: 1.597, Test accuracy: 53.34
Round  64, Global train loss: 0.716, Global test loss: 2.203, Global test accuracy: 26.08
Round  65, Train loss: 0.567, Test loss: 1.626, Test accuracy: 52.30
Round  65, Global train loss: 0.567, Global test loss: 2.094, Global test accuracy: 31.34
Round  66, Train loss: 0.685, Test loss: 1.609, Test accuracy: 53.08
Round  66, Global train loss: 0.685, Global test loss: 2.033, Global test accuracy: 31.86
Round  67, Train loss: 0.914, Test loss: 1.628, Test accuracy: 54.10
Round  67, Global train loss: 0.914, Global test loss: 2.212, Global test accuracy: 29.14
Round  68, Train loss: 0.671, Test loss: 1.627, Test accuracy: 54.10
Round  68, Global train loss: 0.671, Global test loss: 2.104, Global test accuracy: 29.00
Round  69, Train loss: 0.652, Test loss: 1.661, Test accuracy: 53.10
Round  69, Global train loss: 0.652, Global test loss: 2.111, Global test accuracy: 30.18
Round  70, Train loss: 0.759, Test loss: 1.716, Test accuracy: 51.86
Round  70, Global train loss: 0.759, Global test loss: 2.138, Global test accuracy: 25.40
Round  71, Train loss: 0.606, Test loss: 1.749, Test accuracy: 52.26
Round  71, Global train loss: 0.606, Global test loss: 2.161, Global test accuracy: 28.38
Round  72, Train loss: 0.316, Test loss: 1.796, Test accuracy: 52.20
Round  72, Global train loss: 0.316, Global test loss: 2.008, Global test accuracy: 30.20
Round  73, Train loss: 0.631, Test loss: 1.834, Test accuracy: 52.00
Round  73, Global train loss: 0.631, Global test loss: 2.087, Global test accuracy: 28.30
Round  74, Train loss: 0.592, Test loss: 1.768, Test accuracy: 52.60
Round  74, Global train loss: 0.592, Global test loss: 2.093, Global test accuracy: 29.60
Round  75, Train loss: 0.571, Test loss: 1.796, Test accuracy: 51.46
Round  75, Global train loss: 0.571, Global test loss: 2.107, Global test accuracy: 28.52
Round  76, Train loss: 0.456, Test loss: 1.801, Test accuracy: 51.56
Round  76, Global train loss: 0.456, Global test loss: 2.086, Global test accuracy: 29.00
Round  77, Train loss: 0.421, Test loss: 1.806, Test accuracy: 52.22
Round  77, Global train loss: 0.421, Global test loss: 2.143, Global test accuracy: 28.16
Round  78, Train loss: 0.532, Test loss: 1.861, Test accuracy: 51.58
Round  78, Global train loss: 0.532, Global test loss: 2.178, Global test accuracy: 26.36
Round  79, Train loss: 0.330, Test loss: 1.925, Test accuracy: 51.22
Round  79, Global train loss: 0.330, Global test loss: 2.162, Global test accuracy: 30.98
Round  80, Train loss: 0.680, Test loss: 1.944, Test accuracy: 51.44
Round  80, Global train loss: 0.680, Global test loss: 2.220, Global test accuracy: 26.06
Round  81, Train loss: 0.618, Test loss: 1.955, Test accuracy: 51.40
Round  81, Global train loss: 0.618, Global test loss: 2.135, Global test accuracy: 26.38
Round  82, Train loss: 0.522, Test loss: 1.947, Test accuracy: 51.76
Round  82, Global train loss: 0.522, Global test loss: 2.118, Global test accuracy: 28.06
Round  83, Train loss: 0.439, Test loss: 2.007, Test accuracy: 50.78
Round  83, Global train loss: 0.439, Global test loss: 2.108, Global test accuracy: 29.24
Round  84, Train loss: 0.612, Test loss: 2.022, Test accuracy: 50.62
Round  84, Global train loss: 0.612, Global test loss: 2.181, Global test accuracy: 25.20
Round  85, Train loss: 0.668, Test loss: 2.061, Test accuracy: 49.46
Round  85, Global train loss: 0.668, Global test loss: 2.176, Global test accuracy: 26.20
Round  86, Train loss: 0.637, Test loss: 2.072, Test accuracy: 51.28
Round  86, Global train loss: 0.637, Global test loss: 2.192, Global test accuracy: 23.90
Round  87, Train loss: 0.517, Test loss: 2.093, Test accuracy: 50.74
Round  87, Global train loss: 0.517, Global test loss: 2.128, Global test accuracy: 32.68
Round  88, Train loss: 0.592, Test loss: 2.162, Test accuracy: 49.50
Round  88, Global train loss: 0.592, Global test loss: 2.260, Global test accuracy: 25.08
Round  89, Train loss: 0.389, Test loss: 2.171, Test accuracy: 49.58
Round  89, Global train loss: 0.389, Global test loss: 2.135, Global test accuracy: 26.10
Round  90, Train loss: 0.309, Test loss: 2.204, Test accuracy: 50.06
Round  90, Global train loss: 0.309, Global test loss: 2.000, Global test accuracy: 29.26
Round  91, Train loss: 0.226, Test loss: 2.242, Test accuracy: 49.90
Round  91, Global train loss: 0.226, Global test loss: 1.949, Global test accuracy: 39.10
Round  92, Train loss: 0.379, Test loss: 2.243, Test accuracy: 49.62
Round  92, Global train loss: 0.379, Global test loss: 2.105, Global test accuracy: 29.30
Round  93, Train loss: 0.489, Test loss: 2.219, Test accuracy: 50.16
Round  93, Global train loss: 0.489, Global test loss: 2.196, Global test accuracy: 21.74
Round  94, Train loss: 0.199, Test loss: 2.231, Test accuracy: 51.46
Round  94, Global train loss: 0.199, Global test loss: 1.973, Global test accuracy: 32.00
Round  95, Train loss: 0.404, Test loss: 2.233, Test accuracy: 51.22
Round  95, Global train loss: 0.404, Global test loss: 2.197, Global test accuracy: 27.26
Round  96, Train loss: 0.443, Test loss: 2.240, Test accuracy: 51.28
Round  96, Global train loss: 0.443, Global test loss: 2.170, Global test accuracy: 27.72
Round  97, Train loss: 0.187, Test loss: 2.259, Test accuracy: 50.62
Round  97, Global train loss: 0.187, Global test loss: 1.973, Global test accuracy: 32.86
Round  98, Train loss: 0.390, Test loss: 2.286, Test accuracy: 50.38
Round  98, Global train loss: 0.390, Global test loss: 2.249, Global test accuracy: 26.14
Round  99, Train loss: 0.357, Test loss: 2.312, Test accuracy: 49.96
Round  99, Global train loss: 0.357, Global test loss: 2.181, Global test accuracy: 23.72
Final Round, Train loss: 0.344, Test loss: 2.504, Test accuracy: 49.24
Final Round, Global train loss: 0.344, Global test loss: 2.181, Global test accuracy: 23.72
Average accuracy final 10 rounds: 50.466 

Average global accuracy final 10 rounds: 28.91 

785.9460582733154
[1.4443655014038086, 2.888731002807617, 4.050778865814209, 5.212826728820801, 6.37344217300415, 7.5340576171875, 8.687942266464233, 9.841826915740967, 11.042548656463623, 12.24327039718628, 13.372670650482178, 14.502070903778076, 15.717907190322876, 16.933743476867676, 18.080479383468628, 19.22721529006958, 20.39185118675232, 21.55648708343506, 22.755312204360962, 23.954137325286865, 25.149818181991577, 26.34549903869629, 27.578393936157227, 28.811288833618164, 29.947638034820557, 31.08398723602295, 32.212281942367554, 33.34057664871216, 34.52772641181946, 35.71487617492676, 36.931811809539795, 38.14874744415283, 39.3024046421051, 40.45606184005737, 41.63691186904907, 42.81776189804077, 44.09901714324951, 45.38027238845825, 46.56563973426819, 47.751007080078125, 48.98562526702881, 50.22024345397949, 51.37929725646973, 52.53835105895996, 53.71551251411438, 54.8926739692688, 56.05541157722473, 57.218149185180664, 58.36489915847778, 59.5116491317749, 60.73294472694397, 61.95424032211304, 63.18619704246521, 64.41815376281738, 65.59887790679932, 66.77960205078125, 67.93812155723572, 69.09664106369019, 70.26969861984253, 71.44275617599487, 72.6252932548523, 73.80783033370972, 75.11394381523132, 76.42005729675293, 77.58671998977661, 78.7533826828003, 79.9056830406189, 81.0579833984375, 82.22370672225952, 83.38943004608154, 84.56753158569336, 85.74563312530518, 86.90142393112183, 88.05721473693848, 89.30009651184082, 90.54297828674316, 91.72596955299377, 92.90896081924438, 94.08607077598572, 95.26318073272705, 96.45480036735535, 97.64642000198364, 98.79661846160889, 99.94681692123413, 101.16713833808899, 102.38745975494385, 103.6556510925293, 104.92384243011475, 106.09340786933899, 107.26297330856323, 108.53890538215637, 109.81483745574951, 111.01558947563171, 112.21634149551392, 113.52997970581055, 114.84361791610718, 116.06719613075256, 117.29077434539795, 118.4745306968689, 119.65828704833984, 120.8434145450592, 122.02854204177856, 123.1820023059845, 124.33546257019043, 125.58114671707153, 126.82683086395264, 127.99017691612244, 129.15352296829224, 130.34814953804016, 131.5427761077881, 132.69140577316284, 133.8400354385376, 134.99021911621094, 136.14040279388428, 137.30347418785095, 138.46654558181763, 139.6669750213623, 140.86740446090698, 142.05091786384583, 143.23443126678467, 144.46257495880127, 145.69071865081787, 146.88080215454102, 148.07088565826416, 149.2642583847046, 150.45763111114502, 151.62498450279236, 152.7923378944397, 153.94186758995056, 155.09139728546143, 156.222393989563, 157.35339069366455, 158.6269931793213, 159.90059566497803, 161.09608054161072, 162.2915654182434, 163.48298501968384, 164.67440462112427, 165.8803367614746, 167.08626890182495, 168.28351879119873, 169.4807686805725, 170.69152450561523, 171.90228033065796, 173.0822048187256, 174.2621293067932, 175.41827297210693, 176.57441663742065, 177.75196170806885, 178.92950677871704, 180.11976766586304, 181.31002855300903, 182.47772860527039, 183.64542865753174, 184.8116648197174, 185.97790098190308, 187.39404273033142, 188.81018447875977, 189.96587228775024, 191.12156009674072, 192.33120203018188, 193.54084396362305, 194.73765325546265, 195.93446254730225, 197.11770391464233, 198.30094528198242, 199.46663308143616, 200.6323208808899, 201.79283475875854, 202.9533486366272, 204.10439801216125, 205.2554473876953, 206.3828616142273, 207.51027584075928, 208.70949006080627, 209.90870428085327, 211.08516335487366, 212.26162242889404, 213.4154977798462, 214.56937313079834, 215.72432231903076, 216.87927150726318, 218.04830694198608, 219.21734237670898, 220.408509016037, 221.599675655365, 222.83446550369263, 224.06925535202026, 225.2638726234436, 226.45848989486694, 227.65048027038574, 228.84247064590454, 230.08971691131592, 231.3369631767273, 232.54794430732727, 233.75892543792725, 234.90701913833618, 236.05511283874512, 237.2257285118103, 238.3963441848755, 240.85649037361145, 243.3166365623474]
[16.62, 16.62, 21.88, 21.88, 36.84, 36.84, 40.72, 40.72, 42.7, 42.7, 47.06, 47.06, 40.92, 40.92, 49.04, 49.04, 50.94, 50.94, 50.48, 50.48, 54.98, 54.98, 55.7, 55.7, 55.9, 55.9, 56.94, 56.94, 57.98, 57.98, 57.3, 57.3, 58.74, 58.74, 59.56, 59.56, 59.32, 59.32, 60.04, 60.04, 59.8, 59.8, 59.72, 59.72, 59.86, 59.86, 60.22, 60.22, 61.16, 61.16, 61.66, 61.66, 62.08, 62.08, 61.38, 61.38, 60.44, 60.44, 60.54, 60.54, 60.72, 60.72, 60.26, 60.26, 60.28, 60.28, 60.0, 60.0, 61.16, 61.16, 60.68, 60.68, 60.46, 60.46, 60.12, 60.12, 59.18, 59.18, 59.42, 59.42, 58.92, 58.92, 58.56, 58.56, 58.7, 58.7, 57.66, 57.66, 58.3, 58.3, 57.22, 57.22, 57.54, 57.54, 57.08, 57.08, 56.9, 56.9, 56.7, 56.7, 56.3, 56.3, 56.4, 56.4, 56.2, 56.2, 56.34, 56.34, 55.64, 55.64, 55.58, 55.58, 55.34, 55.34, 55.72, 55.72, 54.5, 54.5, 53.48, 53.48, 53.24, 53.24, 52.64, 52.64, 53.66, 53.66, 53.74, 53.74, 53.34, 53.34, 52.3, 52.3, 53.08, 53.08, 54.1, 54.1, 54.1, 54.1, 53.1, 53.1, 51.86, 51.86, 52.26, 52.26, 52.2, 52.2, 52.0, 52.0, 52.6, 52.6, 51.46, 51.46, 51.56, 51.56, 52.22, 52.22, 51.58, 51.58, 51.22, 51.22, 51.44, 51.44, 51.4, 51.4, 51.76, 51.76, 50.78, 50.78, 50.62, 50.62, 49.46, 49.46, 51.28, 51.28, 50.74, 50.74, 49.5, 49.5, 49.58, 49.58, 50.06, 50.06, 49.9, 49.9, 49.62, 49.62, 50.16, 50.16, 51.46, 51.46, 51.22, 51.22, 51.28, 51.28, 50.62, 50.62, 50.38, 50.38, 49.96, 49.96, 49.24, 49.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.907, Test loss: 2.197, Test accuracy: 13.10
Round   0, Global train loss: 1.907, Global test loss: 2.334, Global test accuracy: 10.00
Round   1, Train loss: 1.907, Test loss: 2.088, Test accuracy: 20.32
Round   1, Global train loss: 1.907, Global test loss: 2.285, Global test accuracy: 16.20
Round   2, Train loss: 1.945, Test loss: 1.778, Test accuracy: 33.88
Round   2, Global train loss: 1.945, Global test loss: 2.186, Global test accuracy: 21.34
Round   3, Train loss: 1.834, Test loss: 1.766, Test accuracy: 38.48
Round   3, Global train loss: 1.834, Global test loss: 2.270, Global test accuracy: 23.70
Round   4, Train loss: 1.781, Test loss: 1.637, Test accuracy: 42.84
Round   4, Global train loss: 1.781, Global test loss: 2.095, Global test accuracy: 30.06
Round   5, Train loss: 1.862, Test loss: 1.603, Test accuracy: 44.40
Round   5, Global train loss: 1.862, Global test loss: 2.114, Global test accuracy: 30.38
Round   6, Train loss: 1.758, Test loss: 1.603, Test accuracy: 44.48
Round   6, Global train loss: 1.758, Global test loss: 2.052, Global test accuracy: 31.60
Round   7, Train loss: 1.816, Test loss: 1.490, Test accuracy: 48.92
Round   7, Global train loss: 1.816, Global test loss: 2.085, Global test accuracy: 23.26
Round   8, Train loss: 1.726, Test loss: 1.444, Test accuracy: 52.94
Round   8, Global train loss: 1.726, Global test loss: 1.939, Global test accuracy: 35.34
Round   9, Train loss: 1.763, Test loss: 1.443, Test accuracy: 52.64
Round   9, Global train loss: 1.763, Global test loss: 2.027, Global test accuracy: 35.20
Round  10, Train loss: 1.710, Test loss: 1.333, Test accuracy: 58.04
Round  10, Global train loss: 1.710, Global test loss: 1.862, Global test accuracy: 43.38
Round  11, Train loss: 1.695, Test loss: 1.303, Test accuracy: 58.52
Round  11, Global train loss: 1.695, Global test loss: 1.888, Global test accuracy: 39.34
Round  12, Train loss: 1.716, Test loss: 1.283, Test accuracy: 60.62
Round  12, Global train loss: 1.716, Global test loss: 1.926, Global test accuracy: 35.64
Round  13, Train loss: 1.678, Test loss: 1.270, Test accuracy: 60.60
Round  13, Global train loss: 1.678, Global test loss: 1.754, Global test accuracy: 43.38
Round  14, Train loss: 1.566, Test loss: 1.231, Test accuracy: 62.40
Round  14, Global train loss: 1.566, Global test loss: 1.723, Global test accuracy: 44.56
Round  15, Train loss: 1.572, Test loss: 1.219, Test accuracy: 62.62
Round  15, Global train loss: 1.572, Global test loss: 1.771, Global test accuracy: 44.46
Round  16, Train loss: 1.653, Test loss: 1.229, Test accuracy: 62.04
Round  16, Global train loss: 1.653, Global test loss: 1.763, Global test accuracy: 47.24
Round  17, Train loss: 1.560, Test loss: 1.224, Test accuracy: 63.10
Round  17, Global train loss: 1.560, Global test loss: 1.707, Global test accuracy: 45.98
Round  18, Train loss: 1.654, Test loss: 1.215, Test accuracy: 63.00
Round  18, Global train loss: 1.654, Global test loss: 1.836, Global test accuracy: 39.58
Round  19, Train loss: 1.578, Test loss: 1.212, Test accuracy: 61.82
Round  19, Global train loss: 1.578, Global test loss: 1.715, Global test accuracy: 43.46
Round  20, Train loss: 1.598, Test loss: 1.193, Test accuracy: 61.46
Round  20, Global train loss: 1.598, Global test loss: 1.674, Global test accuracy: 45.44
Round  21, Train loss: 1.492, Test loss: 1.173, Test accuracy: 62.22
Round  21, Global train loss: 1.492, Global test loss: 1.769, Global test accuracy: 43.26
Round  22, Train loss: 1.615, Test loss: 1.172, Test accuracy: 63.06
Round  22, Global train loss: 1.615, Global test loss: 1.705, Global test accuracy: 46.28
Round  23, Train loss: 1.397, Test loss: 1.164, Test accuracy: 62.66
Round  23, Global train loss: 1.397, Global test loss: 1.690, Global test accuracy: 49.12
Round  24, Train loss: 1.548, Test loss: 1.159, Test accuracy: 63.00
Round  24, Global train loss: 1.548, Global test loss: 1.644, Global test accuracy: 48.44
Round  25, Train loss: 1.444, Test loss: 1.153, Test accuracy: 63.24
Round  25, Global train loss: 1.444, Global test loss: 1.535, Global test accuracy: 52.22
Round  26, Train loss: 1.405, Test loss: 1.146, Test accuracy: 62.72
Round  26, Global train loss: 1.405, Global test loss: 1.499, Global test accuracy: 54.42
Round  27, Train loss: 1.541, Test loss: 1.155, Test accuracy: 61.96
Round  27, Global train loss: 1.541, Global test loss: 1.696, Global test accuracy: 45.22
Round  28, Train loss: 1.269, Test loss: 1.175, Test accuracy: 60.80
Round  28, Global train loss: 1.269, Global test loss: 1.699, Global test accuracy: 44.88
Round  29, Train loss: 1.415, Test loss: 1.167, Test accuracy: 61.62
Round  29, Global train loss: 1.415, Global test loss: 1.747, Global test accuracy: 44.10
Round  30, Train loss: 1.335, Test loss: 1.184, Test accuracy: 60.94
Round  30, Global train loss: 1.335, Global test loss: 1.717, Global test accuracy: 44.66
Round  31, Train loss: 1.316, Test loss: 1.199, Test accuracy: 59.98
Round  31, Global train loss: 1.316, Global test loss: 1.616, Global test accuracy: 49.12
Round  32, Train loss: 1.373, Test loss: 1.186, Test accuracy: 60.38
Round  32, Global train loss: 1.373, Global test loss: 1.699, Global test accuracy: 47.26
Round  33, Train loss: 1.310, Test loss: 1.177, Test accuracy: 60.86
Round  33, Global train loss: 1.310, Global test loss: 1.710, Global test accuracy: 43.58
Round  34, Train loss: 1.421, Test loss: 1.166, Test accuracy: 60.70
Round  34, Global train loss: 1.421, Global test loss: 1.812, Global test accuracy: 40.98
Round  35, Train loss: 1.242, Test loss: 1.154, Test accuracy: 60.68
Round  35, Global train loss: 1.242, Global test loss: 1.815, Global test accuracy: 42.68
Round  36, Train loss: 1.240, Test loss: 1.160, Test accuracy: 60.04
Round  36, Global train loss: 1.240, Global test loss: 1.766, Global test accuracy: 41.70
Round  37, Train loss: 1.235, Test loss: 1.187, Test accuracy: 59.08
Round  37, Global train loss: 1.235, Global test loss: 1.750, Global test accuracy: 45.20
Round  38, Train loss: 1.260, Test loss: 1.183, Test accuracy: 59.36
Round  38, Global train loss: 1.260, Global test loss: 1.779, Global test accuracy: 41.12
Round  39, Train loss: 1.233, Test loss: 1.188, Test accuracy: 59.40
Round  39, Global train loss: 1.233, Global test loss: 1.937, Global test accuracy: 38.54
Round  40, Train loss: 1.128, Test loss: 1.214, Test accuracy: 58.28
Round  40, Global train loss: 1.128, Global test loss: 1.773, Global test accuracy: 41.74
Round  41, Train loss: 1.242, Test loss: 1.218, Test accuracy: 58.14
Round  41, Global train loss: 1.242, Global test loss: 1.767, Global test accuracy: 45.10
Round  42, Train loss: 1.176, Test loss: 1.239, Test accuracy: 57.76
Round  42, Global train loss: 1.176, Global test loss: 1.783, Global test accuracy: 42.14
Round  43, Train loss: 1.260, Test loss: 1.239, Test accuracy: 58.22
Round  43, Global train loss: 1.260, Global test loss: 1.739, Global test accuracy: 46.38
Round  44, Train loss: 1.075, Test loss: 1.262, Test accuracy: 57.50
Round  44, Global train loss: 1.075, Global test loss: 1.869, Global test accuracy: 44.66
Round  45, Train loss: 1.085, Test loss: 1.296, Test accuracy: 56.80
Round  45, Global train loss: 1.085, Global test loss: 1.744, Global test accuracy: 44.10
Round  46, Train loss: 1.057, Test loss: 1.317, Test accuracy: 56.54
Round  46, Global train loss: 1.057, Global test loss: 1.816, Global test accuracy: 42.08
Round  47, Train loss: 1.074, Test loss: 1.323, Test accuracy: 56.66
Round  47, Global train loss: 1.074, Global test loss: 1.829, Global test accuracy: 42.68
Round  48, Train loss: 0.930, Test loss: 1.339, Test accuracy: 56.46
Round  48, Global train loss: 0.930, Global test loss: 1.729, Global test accuracy: 45.56
Round  49, Train loss: 0.982, Test loss: 1.343, Test accuracy: 56.36
Round  49, Global train loss: 0.982, Global test loss: 1.894, Global test accuracy: 40.58
Round  50, Train loss: 0.954, Test loss: 1.341, Test accuracy: 56.42
Round  50, Global train loss: 0.954, Global test loss: 1.799, Global test accuracy: 43.52
Round  51, Train loss: 0.950, Test loss: 1.356, Test accuracy: 56.28
Round  51, Global train loss: 0.950, Global test loss: 1.715, Global test accuracy: 47.30
Round  52, Train loss: 0.935, Test loss: 1.414, Test accuracy: 55.12
Round  52, Global train loss: 0.935, Global test loss: 2.013, Global test accuracy: 45.70
Round  53, Train loss: 0.827, Test loss: 1.413, Test accuracy: 54.44
Round  53, Global train loss: 0.827, Global test loss: 2.015, Global test accuracy: 41.52
Round  54, Train loss: 0.917, Test loss: 1.407, Test accuracy: 54.36
Round  54, Global train loss: 0.917, Global test loss: 1.911, Global test accuracy: 41.96
Round  55, Train loss: 0.819, Test loss: 1.440, Test accuracy: 54.34
Round  55, Global train loss: 0.819, Global test loss: 1.885, Global test accuracy: 45.64
Round  56, Train loss: 0.875, Test loss: 1.451, Test accuracy: 54.26
Round  56, Global train loss: 0.875, Global test loss: 1.968, Global test accuracy: 45.12
Round  57, Train loss: 0.755, Test loss: 1.462, Test accuracy: 54.32
Round  57, Global train loss: 0.755, Global test loss: 2.180, Global test accuracy: 42.06
Round  58, Train loss: 0.961, Test loss: 1.518, Test accuracy: 53.72
Round  58, Global train loss: 0.961, Global test loss: 1.881, Global test accuracy: 42.50
Round  59, Train loss: 0.792, Test loss: 1.558, Test accuracy: 53.26
Round  59, Global train loss: 0.792, Global test loss: 2.028, Global test accuracy: 42.58
Round  60, Train loss: 0.741, Test loss: 1.553, Test accuracy: 53.62
Round  60, Global train loss: 0.741, Global test loss: 2.024, Global test accuracy: 45.88
Round  61, Train loss: 0.808, Test loss: 1.627, Test accuracy: 53.42
Round  61, Global train loss: 0.808, Global test loss: 1.876, Global test accuracy: 47.44
Round  62, Train loss: 0.786, Test loss: 1.608, Test accuracy: 54.64
Round  62, Global train loss: 0.786, Global test loss: 2.000, Global test accuracy: 45.06
Round  63, Train loss: 0.701, Test loss: 1.636, Test accuracy: 53.56
Round  63, Global train loss: 0.701, Global test loss: 2.071, Global test accuracy: 42.40
Round  64, Train loss: 0.674, Test loss: 1.694, Test accuracy: 52.86
Round  64, Global train loss: 0.674, Global test loss: 2.258, Global test accuracy: 42.10
Round  65, Train loss: 0.725, Test loss: 1.740, Test accuracy: 52.04
Round  65, Global train loss: 0.725, Global test loss: 2.184, Global test accuracy: 43.78
Round  66, Train loss: 0.652, Test loss: 1.694, Test accuracy: 52.82
Round  66, Global train loss: 0.652, Global test loss: 2.047, Global test accuracy: 45.70
Round  67, Train loss: 0.689, Test loss: 1.717, Test accuracy: 53.12
Round  67, Global train loss: 0.689, Global test loss: 2.342, Global test accuracy: 37.86
Round  68, Train loss: 0.698, Test loss: 1.700, Test accuracy: 54.80
Round  68, Global train loss: 0.698, Global test loss: 2.099, Global test accuracy: 43.62
Round  69, Train loss: 0.549, Test loss: 1.738, Test accuracy: 54.46
Round  69, Global train loss: 0.549, Global test loss: 2.155, Global test accuracy: 44.52
Round  70, Train loss: 0.734, Test loss: 1.767, Test accuracy: 53.50
Round  70, Global train loss: 0.734, Global test loss: 2.189, Global test accuracy: 44.00
Round  71, Train loss: 0.593, Test loss: 1.813, Test accuracy: 53.16
Round  71, Global train loss: 0.593, Global test loss: 2.444, Global test accuracy: 40.34
Round  72, Train loss: 0.592, Test loss: 1.797, Test accuracy: 53.62
Round  72, Global train loss: 0.592, Global test loss: 2.220, Global test accuracy: 45.40
Round  73, Train loss: 0.496, Test loss: 1.819, Test accuracy: 53.02
Round  73, Global train loss: 0.496, Global test loss: 2.252, Global test accuracy: 45.18
Round  74, Train loss: 0.476, Test loss: 1.835, Test accuracy: 52.94
Round  74, Global train loss: 0.476, Global test loss: 2.356, Global test accuracy: 44.58
Round  75, Train loss: 0.624, Test loss: 1.851, Test accuracy: 53.64
Round  75, Global train loss: 0.624, Global test loss: 2.127, Global test accuracy: 44.98
Round  76, Train loss: 0.378, Test loss: 1.854, Test accuracy: 53.40
Round  76, Global train loss: 0.378, Global test loss: 2.400, Global test accuracy: 46.86
Round  77, Train loss: 0.463, Test loss: 1.888, Test accuracy: 53.76
Round  77, Global train loss: 0.463, Global test loss: 2.701, Global test accuracy: 42.40
Round  78, Train loss: 0.505, Test loss: 1.876, Test accuracy: 53.42
Round  78, Global train loss: 0.505, Global test loss: 2.551, Global test accuracy: 40.64
Round  79, Train loss: 0.391, Test loss: 1.887, Test accuracy: 53.26
Round  79, Global train loss: 0.391, Global test loss: 2.713, Global test accuracy: 41.90
Round  80, Train loss: 0.608, Test loss: 1.978, Test accuracy: 52.56
Round  80, Global train loss: 0.608, Global test loss: 2.572, Global test accuracy: 36.04
Round  81, Train loss: 0.556, Test loss: 1.975, Test accuracy: 52.62
Round  81, Global train loss: 0.556, Global test loss: 2.489, Global test accuracy: 39.00
Round  82, Train loss: 0.480, Test loss: 2.037, Test accuracy: 51.66
Round  82, Global train loss: 0.480, Global test loss: 2.557, Global test accuracy: 41.70
Round  83, Train loss: 0.517, Test loss: 2.059, Test accuracy: 50.94
Round  83, Global train loss: 0.517, Global test loss: 2.393, Global test accuracy: 41.54
Round  84, Train loss: 0.619, Test loss: 2.044, Test accuracy: 51.82
Round  84, Global train loss: 0.619, Global test loss: 2.318, Global test accuracy: 42.94
Round  85, Train loss: 0.551, Test loss: 1.981, Test accuracy: 53.52
Round  85, Global train loss: 0.551, Global test loss: 2.394, Global test accuracy: 42.84
Round  86, Train loss: 0.429, Test loss: 2.044, Test accuracy: 52.82
Round  86, Global train loss: 0.429, Global test loss: 2.677, Global test accuracy: 41.56
Round  87, Train loss: 0.618, Test loss: 2.001, Test accuracy: 54.20
Round  87, Global train loss: 0.618, Global test loss: 2.459, Global test accuracy: 39.94
Round  88, Train loss: 0.397, Test loss: 2.032, Test accuracy: 53.36
Round  88, Global train loss: 0.397, Global test loss: 2.798, Global test accuracy: 38.12
Round  89, Train loss: 0.440, Test loss: 2.079, Test accuracy: 52.56
Round  89, Global train loss: 0.440, Global test loss: 2.655, Global test accuracy: 42.02
Round  90, Train loss: 0.433, Test loss: 2.106, Test accuracy: 52.36
Round  90, Global train loss: 0.433, Global test loss: 2.324, Global test accuracy: 43.96
Round  91, Train loss: 0.400, Test loss: 2.145, Test accuracy: 51.64
Round  91, Global train loss: 0.400, Global test loss: 2.447, Global test accuracy: 41.18
Round  92, Train loss: 0.357, Test loss: 2.110, Test accuracy: 52.28
Round  92, Global train loss: 0.357, Global test loss: 2.711, Global test accuracy: 42.64
Round  93, Train loss: 0.397, Test loss: 2.152, Test accuracy: 51.68
Round  93, Global train loss: 0.397, Global test loss: 2.672, Global test accuracy: 40.56
Round  94, Train loss: 0.343, Test loss: 2.162, Test accuracy: 52.08
Round  94, Global train loss: 0.343, Global test loss: 2.438, Global test accuracy: 47.76
Round  95, Train loss: 0.523, Test loss: 2.166, Test accuracy: 51.64
Round  95, Global train loss: 0.523, Global test loss: 2.670, Global test accuracy: 42.04
Round  96, Train loss: 0.381, Test loss: 2.132, Test accuracy: 51.46
Round  96, Global train loss: 0.381, Global test loss: 2.693, Global test accuracy: 41.18
Round  97, Train loss: 0.339, Test loss: 2.139, Test accuracy: 51.28
Round  97, Global train loss: 0.339, Global test loss: 2.578, Global test accuracy: 45.30
Round  98, Train loss: 0.450, Test loss: 2.185, Test accuracy: 51.56
Round  98, Global train loss: 0.450, Global test loss: 3.054, Global test accuracy: 39.72
Round  99, Train loss: 0.419, Test loss: 2.210, Test accuracy: 51.22
Round  99, Global train loss: 0.419, Global test loss: 2.650, Global test accuracy: 42.56
Final Round, Train loss: 0.345, Test loss: 2.298, Test accuracy: 52.14
Final Round, Global train loss: 0.345, Global test loss: 2.650, Global test accuracy: 42.56
Average accuracy final 10 rounds: 51.72 

Average global accuracy final 10 rounds: 42.690000000000005 

787.1724720001221
[1.5160043239593506, 3.032008647918701, 4.254984140396118, 5.477959632873535, 6.637445688247681, 7.796931743621826, 8.996940851211548, 10.19694995880127, 11.443887710571289, 12.690825462341309, 14.064485788345337, 15.438146114349365, 16.649075746536255, 17.860005378723145, 19.04562783241272, 20.231250286102295, 21.416520833969116, 22.601791381835938, 23.79066014289856, 24.97952890396118, 26.22382164001465, 27.468114376068115, 28.654483556747437, 29.840852737426758, 31.03436303138733, 32.2278733253479, 33.357850790023804, 34.48782825469971, 35.65906500816345, 36.8303017616272, 38.00284457206726, 39.175387382507324, 40.35888195037842, 41.54237651824951, 42.70517373085022, 43.86797094345093, 45.015005588531494, 46.16204023361206, 47.31087827682495, 48.45971632003784, 49.693803787231445, 50.92789125442505, 52.108510971069336, 53.28913068771362, 54.4645049571991, 55.63987922668457, 56.82638955116272, 58.01289987564087, 59.1958532333374, 60.378806591033936, 61.561732053756714, 62.74465751647949, 63.94501042366028, 65.14536333084106, 66.36246728897095, 67.57957124710083, 68.73080897331238, 69.88204669952393, 71.06013488769531, 72.2382230758667, 73.43792581558228, 74.63762855529785, 75.82403302192688, 77.01043748855591, 78.21840810775757, 79.42637872695923, 80.60703086853027, 81.78768301010132, 82.99565148353577, 84.20361995697021, 85.37118697166443, 86.53875398635864, 87.69938945770264, 88.86002492904663, 90.01774096488953, 91.17545700073242, 92.37016296386719, 93.56486892700195, 94.8084659576416, 96.05206298828125, 97.22435760498047, 98.39665222167969, 99.56122279167175, 100.72579336166382, 101.8849778175354, 103.04416227340698, 104.34365940093994, 105.6431565284729, 106.87138843536377, 108.09962034225464, 109.33078789710999, 110.56195545196533, 111.76024460792542, 112.9585337638855, 114.14493107795715, 115.33132839202881, 116.60579252243042, 117.88025665283203, 119.05708503723145, 120.23391342163086, 121.46699070930481, 122.70006799697876, 124.01571726799011, 125.33136653900146, 126.44187450408936, 127.55238246917725, 128.8113226890564, 130.07026290893555, 131.25697946548462, 132.4436960220337, 133.61184525489807, 134.77999448776245, 135.9474232196808, 137.11485195159912, 138.342267036438, 139.56968212127686, 140.73494362831116, 141.90020513534546, 143.13736176490784, 144.37451839447021, 145.60217142105103, 146.82982444763184, 148.1186761856079, 149.40752792358398, 150.61045908927917, 151.81339025497437, 153.08082509040833, 154.34825992584229, 155.54387021064758, 156.73948049545288, 157.9342348575592, 159.12898921966553, 160.4267611503601, 161.7245330810547, 162.92200589179993, 164.11947870254517, 165.37440466880798, 166.6293306350708, 167.82418632507324, 169.01904201507568, 170.22464275360107, 171.43024349212646, 172.58645176887512, 173.74266004562378, 174.89367866516113, 176.0446972846985, 177.25151419639587, 178.45833110809326, 179.6299843788147, 180.80163764953613, 182.04751801490784, 183.29339838027954, 184.4857199192047, 185.67804145812988, 186.8736755847931, 188.0693097114563, 189.25772142410278, 190.44613313674927, 191.67967343330383, 192.9132137298584, 194.14710330963135, 195.3809928894043, 196.57501912117004, 197.7690453529358, 198.96893525123596, 200.16882514953613, 201.35133004188538, 202.53383493423462, 203.74947333335876, 204.9651117324829, 206.09083724021912, 207.21656274795532, 208.4794943332672, 209.7424259185791, 210.9244999885559, 212.10657405853271, 213.28056001663208, 214.45454597473145, 215.62474918365479, 216.79495239257812, 218.0119330883026, 219.2289137840271, 220.38283157348633, 221.53674936294556, 222.69490814208984, 223.85306692123413, 225.01481318473816, 226.1765594482422, 227.34251475334167, 228.50847005844116, 229.65361499786377, 230.79875993728638, 231.95869541168213, 233.11863088607788, 234.3280644416809, 235.53749799728394, 236.82412552833557, 238.1107530593872, 239.40707349777222, 240.70339393615723, 243.14084911346436, 245.57830429077148]
[13.1, 13.1, 20.32, 20.32, 33.88, 33.88, 38.48, 38.48, 42.84, 42.84, 44.4, 44.4, 44.48, 44.48, 48.92, 48.92, 52.94, 52.94, 52.64, 52.64, 58.04, 58.04, 58.52, 58.52, 60.62, 60.62, 60.6, 60.6, 62.4, 62.4, 62.62, 62.62, 62.04, 62.04, 63.1, 63.1, 63.0, 63.0, 61.82, 61.82, 61.46, 61.46, 62.22, 62.22, 63.06, 63.06, 62.66, 62.66, 63.0, 63.0, 63.24, 63.24, 62.72, 62.72, 61.96, 61.96, 60.8, 60.8, 61.62, 61.62, 60.94, 60.94, 59.98, 59.98, 60.38, 60.38, 60.86, 60.86, 60.7, 60.7, 60.68, 60.68, 60.04, 60.04, 59.08, 59.08, 59.36, 59.36, 59.4, 59.4, 58.28, 58.28, 58.14, 58.14, 57.76, 57.76, 58.22, 58.22, 57.5, 57.5, 56.8, 56.8, 56.54, 56.54, 56.66, 56.66, 56.46, 56.46, 56.36, 56.36, 56.42, 56.42, 56.28, 56.28, 55.12, 55.12, 54.44, 54.44, 54.36, 54.36, 54.34, 54.34, 54.26, 54.26, 54.32, 54.32, 53.72, 53.72, 53.26, 53.26, 53.62, 53.62, 53.42, 53.42, 54.64, 54.64, 53.56, 53.56, 52.86, 52.86, 52.04, 52.04, 52.82, 52.82, 53.12, 53.12, 54.8, 54.8, 54.46, 54.46, 53.5, 53.5, 53.16, 53.16, 53.62, 53.62, 53.02, 53.02, 52.94, 52.94, 53.64, 53.64, 53.4, 53.4, 53.76, 53.76, 53.42, 53.42, 53.26, 53.26, 52.56, 52.56, 52.62, 52.62, 51.66, 51.66, 50.94, 50.94, 51.82, 51.82, 53.52, 53.52, 52.82, 52.82, 54.2, 54.2, 53.36, 53.36, 52.56, 52.56, 52.36, 52.36, 51.64, 51.64, 52.28, 52.28, 51.68, 51.68, 52.08, 52.08, 51.64, 51.64, 51.46, 51.46, 51.28, 51.28, 51.56, 51.56, 51.22, 51.22, 52.14, 52.14]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.966, Test loss: 2.196, Test accuracy: 12.12
Round   0, Global train loss: 1.966, Global test loss: 2.325, Global test accuracy: 10.00
Round   1, Train loss: 1.959, Test loss: 2.138, Test accuracy: 18.44
Round   1, Global train loss: 1.959, Global test loss: 2.326, Global test accuracy: 15.70
Round   2, Train loss: 1.953, Test loss: 1.841, Test accuracy: 30.90
Round   2, Global train loss: 1.953, Global test loss: 2.228, Global test accuracy: 21.54
Round   3, Train loss: 1.918, Test loss: 1.794, Test accuracy: 35.12
Round   3, Global train loss: 1.918, Global test loss: 2.254, Global test accuracy: 21.40
Round   4, Train loss: 1.868, Test loss: 1.703, Test accuracy: 35.32
Round   4, Global train loss: 1.868, Global test loss: 2.108, Global test accuracy: 23.00
Round   5, Train loss: 1.876, Test loss: 1.694, Test accuracy: 38.42
Round   5, Global train loss: 1.876, Global test loss: 2.205, Global test accuracy: 25.12
Round   6, Train loss: 1.869, Test loss: 1.693, Test accuracy: 40.90
Round   6, Global train loss: 1.869, Global test loss: 2.154, Global test accuracy: 26.88
Round   7, Train loss: 1.809, Test loss: 1.557, Test accuracy: 46.70
Round   7, Global train loss: 1.809, Global test loss: 2.137, Global test accuracy: 25.72
Round   8, Train loss: 1.801, Test loss: 1.491, Test accuracy: 51.20
Round   8, Global train loss: 1.801, Global test loss: 1.977, Global test accuracy: 33.52
Round   9, Train loss: 1.822, Test loss: 1.511, Test accuracy: 49.12
Round   9, Global train loss: 1.822, Global test loss: 2.121, Global test accuracy: 30.80
Round  10, Train loss: 1.880, Test loss: 1.412, Test accuracy: 52.50
Round  10, Global train loss: 1.880, Global test loss: 2.020, Global test accuracy: 35.98
Round  11, Train loss: 1.806, Test loss: 1.385, Test accuracy: 54.48
Round  11, Global train loss: 1.806, Global test loss: 1.900, Global test accuracy: 40.20
Round  12, Train loss: 1.745, Test loss: 1.383, Test accuracy: 55.54
Round  12, Global train loss: 1.745, Global test loss: 2.005, Global test accuracy: 32.96
Round  13, Train loss: 1.835, Test loss: 1.374, Test accuracy: 56.70
Round  13, Global train loss: 1.835, Global test loss: 1.842, Global test accuracy: 42.60
Round  14, Train loss: 1.793, Test loss: 1.356, Test accuracy: 57.38
Round  14, Global train loss: 1.793, Global test loss: 1.845, Global test accuracy: 42.30
Round  15, Train loss: 1.750, Test loss: 1.352, Test accuracy: 58.10
Round  15, Global train loss: 1.750, Global test loss: 1.845, Global test accuracy: 41.18
Round  16, Train loss: 1.792, Test loss: 1.351, Test accuracy: 58.28
Round  16, Global train loss: 1.792, Global test loss: 1.907, Global test accuracy: 44.46
Round  17, Train loss: 1.710, Test loss: 1.350, Test accuracy: 58.32
Round  17, Global train loss: 1.710, Global test loss: 1.828, Global test accuracy: 42.58
Round  18, Train loss: 1.743, Test loss: 1.344, Test accuracy: 59.06
Round  18, Global train loss: 1.743, Global test loss: 1.948, Global test accuracy: 40.82
Round  19, Train loss: 1.709, Test loss: 1.329, Test accuracy: 59.64
Round  19, Global train loss: 1.709, Global test loss: 1.790, Global test accuracy: 46.60
Round  20, Train loss: 1.687, Test loss: 1.313, Test accuracy: 59.92
Round  20, Global train loss: 1.687, Global test loss: 1.814, Global test accuracy: 44.08
Round  21, Train loss: 1.664, Test loss: 1.289, Test accuracy: 59.68
Round  21, Global train loss: 1.664, Global test loss: 1.899, Global test accuracy: 36.20
Round  22, Train loss: 1.741, Test loss: 1.276, Test accuracy: 60.32
Round  22, Global train loss: 1.741, Global test loss: 1.782, Global test accuracy: 45.40
Round  23, Train loss: 1.727, Test loss: 1.275, Test accuracy: 61.10
Round  23, Global train loss: 1.727, Global test loss: 1.861, Global test accuracy: 48.98
Round  24, Train loss: 1.710, Test loss: 1.255, Test accuracy: 61.66
Round  24, Global train loss: 1.710, Global test loss: 1.745, Global test accuracy: 45.82
Round  25, Train loss: 1.643, Test loss: 1.262, Test accuracy: 60.94
Round  25, Global train loss: 1.643, Global test loss: 1.688, Global test accuracy: 48.92
Round  26, Train loss: 1.658, Test loss: 1.255, Test accuracy: 60.52
Round  26, Global train loss: 1.658, Global test loss: 1.659, Global test accuracy: 52.06
Round  27, Train loss: 1.611, Test loss: 1.230, Test accuracy: 61.66
Round  27, Global train loss: 1.611, Global test loss: 1.672, Global test accuracy: 50.80
Round  28, Train loss: 1.633, Test loss: 1.246, Test accuracy: 60.90
Round  28, Global train loss: 1.633, Global test loss: 1.701, Global test accuracy: 48.14
Round  29, Train loss: 1.620, Test loss: 1.224, Test accuracy: 62.42
Round  29, Global train loss: 1.620, Global test loss: 1.699, Global test accuracy: 46.86
Round  30, Train loss: 1.585, Test loss: 1.237, Test accuracy: 61.46
Round  30, Global train loss: 1.585, Global test loss: 1.706, Global test accuracy: 46.58
Round  31, Train loss: 1.546, Test loss: 1.237, Test accuracy: 61.82
Round  31, Global train loss: 1.546, Global test loss: 1.626, Global test accuracy: 48.74
Round  32, Train loss: 1.618, Test loss: 1.219, Test accuracy: 62.08
Round  32, Global train loss: 1.618, Global test loss: 1.716, Global test accuracy: 47.06
Round  33, Train loss: 1.536, Test loss: 1.224, Test accuracy: 62.00
Round  33, Global train loss: 1.536, Global test loss: 1.738, Global test accuracy: 43.68
Round  34, Train loss: 1.484, Test loss: 1.216, Test accuracy: 61.08
Round  34, Global train loss: 1.484, Global test loss: 1.726, Global test accuracy: 43.98
Round  35, Train loss: 1.522, Test loss: 1.216, Test accuracy: 60.48
Round  35, Global train loss: 1.522, Global test loss: 1.787, Global test accuracy: 43.68
Round  36, Train loss: 1.527, Test loss: 1.230, Test accuracy: 60.30
Round  36, Global train loss: 1.527, Global test loss: 1.695, Global test accuracy: 45.64
Round  37, Train loss: 1.511, Test loss: 1.222, Test accuracy: 60.88
Round  37, Global train loss: 1.511, Global test loss: 1.702, Global test accuracy: 45.88
Round  38, Train loss: 1.399, Test loss: 1.208, Test accuracy: 61.28
Round  38, Global train loss: 1.399, Global test loss: 1.715, Global test accuracy: 44.74
Round  39, Train loss: 1.429, Test loss: 1.204, Test accuracy: 61.70
Round  39, Global train loss: 1.429, Global test loss: 1.755, Global test accuracy: 43.72
Round  40, Train loss: 1.426, Test loss: 1.203, Test accuracy: 61.64
Round  40, Global train loss: 1.426, Global test loss: 1.613, Global test accuracy: 48.42
Round  41, Train loss: 1.514, Test loss: 1.214, Test accuracy: 60.30
Round  41, Global train loss: 1.514, Global test loss: 1.653, Global test accuracy: 49.04
Round  42, Train loss: 1.363, Test loss: 1.227, Test accuracy: 59.30
Round  42, Global train loss: 1.363, Global test loss: 1.633, Global test accuracy: 48.36
Round  43, Train loss: 1.395, Test loss: 1.213, Test accuracy: 59.14
Round  43, Global train loss: 1.395, Global test loss: 1.643, Global test accuracy: 50.20
Round  44, Train loss: 1.498, Test loss: 1.225, Test accuracy: 58.66
Round  44, Global train loss: 1.498, Global test loss: 1.770, Global test accuracy: 44.58
Round  45, Train loss: 1.367, Test loss: 1.212, Test accuracy: 59.66
Round  45, Global train loss: 1.367, Global test loss: 1.640, Global test accuracy: 47.72
Round  46, Train loss: 1.243, Test loss: 1.215, Test accuracy: 60.04
Round  46, Global train loss: 1.243, Global test loss: 1.622, Global test accuracy: 45.96
Round  47, Train loss: 1.250, Test loss: 1.220, Test accuracy: 59.30
Round  47, Global train loss: 1.250, Global test loss: 1.740, Global test accuracy: 43.20
Round  48, Train loss: 1.281, Test loss: 1.224, Test accuracy: 58.82
Round  48, Global train loss: 1.281, Global test loss: 1.585, Global test accuracy: 48.58
Round  49, Train loss: 1.299, Test loss: 1.222, Test accuracy: 59.50
Round  49, Global train loss: 1.299, Global test loss: 1.699, Global test accuracy: 44.60
Round  50, Train loss: 1.289, Test loss: 1.234, Test accuracy: 58.88
Round  50, Global train loss: 1.289, Global test loss: 1.671, Global test accuracy: 45.68
Round  51, Train loss: 1.388, Test loss: 1.245, Test accuracy: 58.70
Round  51, Global train loss: 1.388, Global test loss: 1.793, Global test accuracy: 43.36
Round  52, Train loss: 1.391, Test loss: 1.243, Test accuracy: 58.10
Round  52, Global train loss: 1.391, Global test loss: 1.910, Global test accuracy: 44.22
Round  53, Train loss: 1.281, Test loss: 1.245, Test accuracy: 57.52
Round  53, Global train loss: 1.281, Global test loss: 1.850, Global test accuracy: 41.98
Round  54, Train loss: 1.129, Test loss: 1.250, Test accuracy: 57.50
Round  54, Global train loss: 1.129, Global test loss: 1.657, Global test accuracy: 46.56
Round  55, Train loss: 1.313, Test loss: 1.266, Test accuracy: 57.44
Round  55, Global train loss: 1.313, Global test loss: 1.799, Global test accuracy: 43.20
Round  56, Train loss: 1.069, Test loss: 1.266, Test accuracy: 56.94
Round  56, Global train loss: 1.069, Global test loss: 1.636, Global test accuracy: 46.54
Round  57, Train loss: 1.189, Test loss: 1.264, Test accuracy: 57.40
Round  57, Global train loss: 1.189, Global test loss: 1.826, Global test accuracy: 44.70
Round  58, Train loss: 1.289, Test loss: 1.276, Test accuracy: 57.24
Round  58, Global train loss: 1.289, Global test loss: 1.837, Global test accuracy: 44.16
Round  59, Train loss: 1.130, Test loss: 1.303, Test accuracy: 56.00
Round  59, Global train loss: 1.130, Global test loss: 1.706, Global test accuracy: 45.18
Round  60, Train loss: 1.194, Test loss: 1.309, Test accuracy: 55.76
Round  60, Global train loss: 1.194, Global test loss: 1.762, Global test accuracy: 43.30
Round  61, Train loss: 1.032, Test loss: 1.314, Test accuracy: 56.38
Round  61, Global train loss: 1.032, Global test loss: 1.618, Global test accuracy: 47.60
Round  62, Train loss: 1.132, Test loss: 1.336, Test accuracy: 54.88
Round  62, Global train loss: 1.132, Global test loss: 1.772, Global test accuracy: 46.06
Round  63, Train loss: 1.062, Test loss: 1.356, Test accuracy: 54.70
Round  63, Global train loss: 1.062, Global test loss: 1.798, Global test accuracy: 42.04
Round  64, Train loss: 0.983, Test loss: 1.369, Test accuracy: 54.74
Round  64, Global train loss: 0.983, Global test loss: 1.831, Global test accuracy: 43.96
Round  65, Train loss: 1.033, Test loss: 1.385, Test accuracy: 54.50
Round  65, Global train loss: 1.033, Global test loss: 1.833, Global test accuracy: 42.50
Round  66, Train loss: 1.069, Test loss: 1.389, Test accuracy: 54.06
Round  66, Global train loss: 1.069, Global test loss: 1.845, Global test accuracy: 43.34
Round  67, Train loss: 1.029, Test loss: 1.395, Test accuracy: 54.74
Round  67, Global train loss: 1.029, Global test loss: 2.050, Global test accuracy: 37.78
Round  68, Train loss: 0.846, Test loss: 1.398, Test accuracy: 54.08
Round  68, Global train loss: 0.846, Global test loss: 1.927, Global test accuracy: 41.32
Round  69, Train loss: 0.965, Test loss: 1.415, Test accuracy: 54.38
Round  69, Global train loss: 0.965, Global test loss: 1.974, Global test accuracy: 38.58
Round  70, Train loss: 1.045, Test loss: 1.390, Test accuracy: 55.58
Round  70, Global train loss: 1.045, Global test loss: 1.880, Global test accuracy: 42.04
Round  71, Train loss: 0.890, Test loss: 1.402, Test accuracy: 55.64
Round  71, Global train loss: 0.890, Global test loss: 2.131, Global test accuracy: 40.52
Round  72, Train loss: 0.947, Test loss: 1.444, Test accuracy: 54.68
Round  72, Global train loss: 0.947, Global test loss: 2.053, Global test accuracy: 42.88
Round  73, Train loss: 0.784, Test loss: 1.512, Test accuracy: 54.30
Round  73, Global train loss: 0.784, Global test loss: 1.934, Global test accuracy: 42.40
Round  74, Train loss: 0.848, Test loss: 1.490, Test accuracy: 55.44
Round  74, Global train loss: 0.848, Global test loss: 1.965, Global test accuracy: 42.80
Round  75, Train loss: 0.783, Test loss: 1.508, Test accuracy: 55.32
Round  75, Global train loss: 0.783, Global test loss: 1.890, Global test accuracy: 43.94
Round  76, Train loss: 0.728, Test loss: 1.475, Test accuracy: 54.92
Round  76, Global train loss: 0.728, Global test loss: 2.006, Global test accuracy: 42.70
Round  77, Train loss: 0.775, Test loss: 1.505, Test accuracy: 55.46
Round  77, Global train loss: 0.775, Global test loss: 2.071, Global test accuracy: 42.80
Round  78, Train loss: 0.742, Test loss: 1.555, Test accuracy: 55.10
Round  78, Global train loss: 0.742, Global test loss: 2.190, Global test accuracy: 41.98
Round  79, Train loss: 0.702, Test loss: 1.552, Test accuracy: 54.58
Round  79, Global train loss: 0.702, Global test loss: 2.254, Global test accuracy: 39.20
Round  80, Train loss: 0.793, Test loss: 1.579, Test accuracy: 54.94
Round  80, Global train loss: 0.793, Global test loss: 2.151, Global test accuracy: 38.86
Round  81, Train loss: 0.707, Test loss: 1.638, Test accuracy: 53.04
Round  81, Global train loss: 0.707, Global test loss: 2.166, Global test accuracy: 39.20
Round  82, Train loss: 0.716, Test loss: 1.624, Test accuracy: 52.92
Round  82, Global train loss: 0.716, Global test loss: 2.103, Global test accuracy: 41.64
Round  83, Train loss: 0.684, Test loss: 1.712, Test accuracy: 51.72
Round  83, Global train loss: 0.684, Global test loss: 2.052, Global test accuracy: 41.64
Round  84, Train loss: 0.870, Test loss: 1.732, Test accuracy: 51.82
Round  84, Global train loss: 0.870, Global test loss: 2.154, Global test accuracy: 41.84
Round  85, Train loss: 0.834, Test loss: 1.771, Test accuracy: 51.08
Round  85, Global train loss: 0.834, Global test loss: 2.155, Global test accuracy: 41.56
Round  86, Train loss: 0.695, Test loss: 1.767, Test accuracy: 51.24
Round  86, Global train loss: 0.695, Global test loss: 2.264, Global test accuracy: 39.38
Round  87, Train loss: 0.855, Test loss: 1.736, Test accuracy: 52.26
Round  87, Global train loss: 0.855, Global test loss: 2.209, Global test accuracy: 38.44
Round  88, Train loss: 0.613, Test loss: 1.694, Test accuracy: 53.62
Round  88, Global train loss: 0.613, Global test loss: 2.573, Global test accuracy: 37.08
Round  89, Train loss: 0.617, Test loss: 1.761, Test accuracy: 52.82
Round  89, Global train loss: 0.617, Global test loss: 2.343, Global test accuracy: 41.12
Round  90, Train loss: 0.665, Test loss: 1.785, Test accuracy: 52.28
Round  90, Global train loss: 0.665, Global test loss: 2.071, Global test accuracy: 42.86
Round  91, Train loss: 0.694, Test loss: 1.792, Test accuracy: 53.38
Round  91, Global train loss: 0.694, Global test loss: 2.285, Global test accuracy: 41.64
Round  92, Train loss: 0.624, Test loss: 1.830, Test accuracy: 52.12
Round  92, Global train loss: 0.624, Global test loss: 2.326, Global test accuracy: 40.08
Round  93, Train loss: 0.580, Test loss: 1.825, Test accuracy: 52.12
Round  93, Global train loss: 0.580, Global test loss: 2.396, Global test accuracy: 39.42/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.621, Test loss: 1.841, Test accuracy: 51.98
Round  94, Global train loss: 0.621, Global test loss: 2.201, Global test accuracy: 42.22
Round  95, Train loss: 0.647, Test loss: 1.844, Test accuracy: 51.32
Round  95, Global train loss: 0.647, Global test loss: 2.277, Global test accuracy: 41.76
Round  96, Train loss: 0.582, Test loss: 1.863, Test accuracy: 51.34
Round  96, Global train loss: 0.582, Global test loss: 2.403, Global test accuracy: 42.02
Round  97, Train loss: 0.603, Test loss: 1.803, Test accuracy: 52.70
Round  97, Global train loss: 0.603, Global test loss: 2.143, Global test accuracy: 43.38
Round  98, Train loss: 0.521, Test loss: 1.900, Test accuracy: 51.96
Round  98, Global train loss: 0.521, Global test loss: 2.409, Global test accuracy: 43.84
Round  99, Train loss: 0.552, Test loss: 1.936, Test accuracy: 51.76
Round  99, Global train loss: 0.552, Global test loss: 2.352, Global test accuracy: 41.68
Final Round, Train loss: 0.497, Test loss: 2.077, Test accuracy: 51.04
Final Round, Global train loss: 0.497, Global test loss: 2.352, Global test accuracy: 41.68
Average accuracy final 10 rounds: 52.096000000000004 

Average global accuracy final 10 rounds: 41.89 

834.9559981822968
[1.5569298267364502, 3.1138596534729004, 4.437052965164185, 5.760246276855469, 7.050233364105225, 8.34022045135498, 9.62388300895691, 10.907545566558838, 12.199681282043457, 13.491816997528076, 14.786190509796143, 16.08056402206421, 17.38251543045044, 18.68446683883667, 20.110288381576538, 21.536109924316406, 22.831397533416748, 24.12668514251709, 25.45029354095459, 26.77390193939209, 28.17618417739868, 29.578466415405273, 30.874191761016846, 32.16991710662842, 33.463048219680786, 34.756179332733154, 36.04186201095581, 37.32754468917847, 38.621336936950684, 39.9151291847229, 41.17900776863098, 42.44288635253906, 43.72384977340698, 45.0048131942749, 46.30444526672363, 47.60407733917236, 48.87109088897705, 50.13810443878174, 51.42066812515259, 52.70323181152344, 54.09555411338806, 55.487876415252686, 56.959779024124146, 58.431681632995605, 59.883033752441406, 61.33438587188721, 62.788687229156494, 64.24298858642578, 65.69430899620056, 67.14562940597534, 68.5632791519165, 69.98092889785767, 71.41889238357544, 72.85685586929321, 74.28294014930725, 75.70902442932129, 77.16778445243835, 78.62654447555542, 80.13999247550964, 81.65344047546387, 83.13479113578796, 84.61614179611206, 85.98981928825378, 87.36349678039551, 88.8354971408844, 90.30749750137329, 91.65682649612427, 93.00615549087524, 94.3072464466095, 95.60833740234375, 96.86757016181946, 98.12680292129517, 99.42539644241333, 100.7239899635315, 102.02124619483948, 103.31850242614746, 104.59390306472778, 105.8693037033081, 107.23948383331299, 108.60966396331787, 109.88523030281067, 111.16079664230347, 112.5136969089508, 113.86659717559814, 115.17717981338501, 116.48776245117188, 117.80601954460144, 119.124276638031, 120.46194124221802, 121.79960584640503, 123.09782385826111, 124.39604187011719, 125.72727513313293, 127.05850839614868, 128.3869593143463, 129.71541023254395, 131.0250380039215, 132.33466577529907, 133.6950376033783, 135.05540943145752, 136.38671970367432, 137.7180299758911, 139.0377597808838, 140.35748958587646, 141.65123844146729, 142.9449872970581, 144.2758436203003, 145.60669994354248, 146.92269611358643, 148.23869228363037, 149.84166312217712, 151.44463396072388, 152.7343556880951, 154.0240774154663, 155.48815989494324, 156.95224237442017, 158.23625206947327, 159.52026176452637, 160.78316736221313, 162.0460729598999, 163.3675308227539, 164.6889886856079, 165.94209790229797, 167.19520711898804, 168.5166335105896, 169.83805990219116, 171.14734840393066, 172.45663690567017, 173.71040415763855, 174.96417140960693, 176.30018520355225, 177.63619899749756, 178.98226857185364, 180.32833814620972, 181.64313459396362, 182.95793104171753, 184.27632784843445, 185.59472465515137, 186.92600560188293, 188.2572865486145, 189.67571258544922, 191.09413862228394, 192.38263726234436, 193.67113590240479, 194.95114493370056, 196.23115396499634, 197.51942777633667, 198.807701587677, 200.07667541503906, 201.34564924240112, 202.63229775428772, 203.91894626617432, 205.21155333518982, 206.50416040420532, 207.8220386505127, 209.13991689682007, 210.42113590240479, 211.7023549079895, 212.95702695846558, 214.21169900894165, 215.50652265548706, 216.80134630203247, 218.15624380111694, 219.51114130020142, 220.78187942504883, 222.05261754989624, 223.3003692626953, 224.54812097549438, 225.84713768959045, 227.14615440368652, 228.69588708877563, 230.24561977386475, 231.63268208503723, 233.01974439620972, 234.3929238319397, 235.76610326766968, 237.0598120689392, 238.35352087020874, 239.60445857048035, 240.85539627075195, 242.1351809501648, 243.41496562957764, 244.68881273269653, 245.96265983581543, 247.34043836593628, 248.71821689605713, 250.00005269050598, 251.28188848495483, 252.5646936893463, 253.8474988937378, 255.17944931983948, 256.51139974594116, 257.78114128112793, 259.0508828163147, 260.3129301071167, 261.5749773979187, 262.83433389663696, 264.0936903953552, 265.4768662452698, 266.8600420951843, 269.57160115242004, 272.28316020965576]
[12.12, 12.12, 18.44, 18.44, 30.9, 30.9, 35.12, 35.12, 35.32, 35.32, 38.42, 38.42, 40.9, 40.9, 46.7, 46.7, 51.2, 51.2, 49.12, 49.12, 52.5, 52.5, 54.48, 54.48, 55.54, 55.54, 56.7, 56.7, 57.38, 57.38, 58.1, 58.1, 58.28, 58.28, 58.32, 58.32, 59.06, 59.06, 59.64, 59.64, 59.92, 59.92, 59.68, 59.68, 60.32, 60.32, 61.1, 61.1, 61.66, 61.66, 60.94, 60.94, 60.52, 60.52, 61.66, 61.66, 60.9, 60.9, 62.42, 62.42, 61.46, 61.46, 61.82, 61.82, 62.08, 62.08, 62.0, 62.0, 61.08, 61.08, 60.48, 60.48, 60.3, 60.3, 60.88, 60.88, 61.28, 61.28, 61.7, 61.7, 61.64, 61.64, 60.3, 60.3, 59.3, 59.3, 59.14, 59.14, 58.66, 58.66, 59.66, 59.66, 60.04, 60.04, 59.3, 59.3, 58.82, 58.82, 59.5, 59.5, 58.88, 58.88, 58.7, 58.7, 58.1, 58.1, 57.52, 57.52, 57.5, 57.5, 57.44, 57.44, 56.94, 56.94, 57.4, 57.4, 57.24, 57.24, 56.0, 56.0, 55.76, 55.76, 56.38, 56.38, 54.88, 54.88, 54.7, 54.7, 54.74, 54.74, 54.5, 54.5, 54.06, 54.06, 54.74, 54.74, 54.08, 54.08, 54.38, 54.38, 55.58, 55.58, 55.64, 55.64, 54.68, 54.68, 54.3, 54.3, 55.44, 55.44, 55.32, 55.32, 54.92, 54.92, 55.46, 55.46, 55.1, 55.1, 54.58, 54.58, 54.94, 54.94, 53.04, 53.04, 52.92, 52.92, 51.72, 51.72, 51.82, 51.82, 51.08, 51.08, 51.24, 51.24, 52.26, 52.26, 53.62, 53.62, 52.82, 52.82, 52.28, 52.28, 53.38, 53.38, 52.12, 52.12, 52.12, 52.12, 51.98, 51.98, 51.32, 51.32, 51.34, 51.34, 52.7, 52.7, 51.96, 51.96, 51.76, 51.76, 51.04, 51.04]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 1.918, Test loss: 2.223, Test accuracy: 13.80
Round   0, Global train loss: 1.918, Global test loss: 2.362, Global test accuracy: 10.00
Round   1, Train loss: 1.881, Test loss: 2.166, Test accuracy: 20.36
Round   1, Global train loss: 1.881, Global test loss: 2.366, Global test accuracy: 14.70
Round   2, Train loss: 1.945, Test loss: 1.787, Test accuracy: 35.26
Round   2, Global train loss: 1.945, Global test loss: 2.171, Global test accuracy: 20.68
Round   3, Train loss: 1.820, Test loss: 1.727, Test accuracy: 38.52
Round   3, Global train loss: 1.820, Global test loss: 2.173, Global test accuracy: 24.60
Round   4, Train loss: 1.789, Test loss: 1.631, Test accuracy: 41.12
Round   4, Global train loss: 1.789, Global test loss: 2.052, Global test accuracy: 26.90
Round   5, Train loss: 1.846, Test loss: 1.614, Test accuracy: 41.06
Round   5, Global train loss: 1.846, Global test loss: 2.069, Global test accuracy: 25.12
Round   6, Train loss: 1.769, Test loss: 1.625, Test accuracy: 43.76
Round   6, Global train loss: 1.769, Global test loss: 2.113, Global test accuracy: 29.90
Round   7, Train loss: 1.828, Test loss: 1.497, Test accuracy: 47.90
Round   7, Global train loss: 1.828, Global test loss: 2.223, Global test accuracy: 21.58
Round   8, Train loss: 1.748, Test loss: 1.421, Test accuracy: 50.36
Round   8, Global train loss: 1.748, Global test loss: 1.884, Global test accuracy: 35.04
Round   9, Train loss: 1.788, Test loss: 1.432, Test accuracy: 49.16
Round   9, Global train loss: 1.788, Global test loss: 1.969, Global test accuracy: 34.60
Round  10, Train loss: 1.688, Test loss: 1.339, Test accuracy: 52.50
Round  10, Global train loss: 1.688, Global test loss: 1.921, Global test accuracy: 38.54
Round  11, Train loss: 1.628, Test loss: 1.300, Test accuracy: 55.46
Round  11, Global train loss: 1.628, Global test loss: 1.808, Global test accuracy: 42.32
Round  12, Train loss: 1.773, Test loss: 1.280, Test accuracy: 58.04
Round  12, Global train loss: 1.773, Global test loss: 2.069, Global test accuracy: 27.26
Round  13, Train loss: 1.695, Test loss: 1.288, Test accuracy: 57.72
Round  13, Global train loss: 1.695, Global test loss: 1.784, Global test accuracy: 46.12
Round  14, Train loss: 1.612, Test loss: 1.262, Test accuracy: 58.20
Round  14, Global train loss: 1.612, Global test loss: 1.784, Global test accuracy: 43.86
Round  15, Train loss: 1.630, Test loss: 1.255, Test accuracy: 58.34
Round  15, Global train loss: 1.630, Global test loss: 1.778, Global test accuracy: 43.84
Round  16, Train loss: 1.585, Test loss: 1.235, Test accuracy: 59.40
Round  16, Global train loss: 1.585, Global test loss: 1.863, Global test accuracy: 43.12
Round  17, Train loss: 1.521, Test loss: 1.223, Test accuracy: 60.30
Round  17, Global train loss: 1.521, Global test loss: 1.743, Global test accuracy: 44.56
Round  18, Train loss: 1.573, Test loss: 1.236, Test accuracy: 59.92
Round  18, Global train loss: 1.573, Global test loss: 1.716, Global test accuracy: 45.72
Round  19, Train loss: 1.625, Test loss: 1.226, Test accuracy: 59.46
Round  19, Global train loss: 1.625, Global test loss: 1.743, Global test accuracy: 47.84
Round  20, Train loss: 1.614, Test loss: 1.235, Test accuracy: 59.86
Round  20, Global train loss: 1.614, Global test loss: 1.713, Global test accuracy: 46.64
Round  21, Train loss: 1.651, Test loss: 1.216, Test accuracy: 61.12
Round  21, Global train loss: 1.651, Global test loss: 1.917, Global test accuracy: 38.64
Round  22, Train loss: 1.639, Test loss: 1.199, Test accuracy: 61.24
Round  22, Global train loss: 1.639, Global test loss: 1.679, Global test accuracy: 46.78
Round  23, Train loss: 1.597, Test loss: 1.207, Test accuracy: 62.38
Round  23, Global train loss: 1.597, Global test loss: 1.901, Global test accuracy: 46.92
Round  24, Train loss: 1.404, Test loss: 1.192, Test accuracy: 63.16
Round  24, Global train loss: 1.404, Global test loss: 1.599, Global test accuracy: 52.10
Round  25, Train loss: 1.419, Test loss: 1.185, Test accuracy: 63.16
Round  25, Global train loss: 1.419, Global test loss: 1.555, Global test accuracy: 51.20
Round  26, Train loss: 1.578, Test loss: 1.180, Test accuracy: 63.56
Round  26, Global train loss: 1.578, Global test loss: 1.577, Global test accuracy: 52.68
Round  27, Train loss: 1.491, Test loss: 1.158, Test accuracy: 65.12
Round  27, Global train loss: 1.491, Global test loss: 1.612, Global test accuracy: 50.18
Round  28, Train loss: 1.546, Test loss: 1.146, Test accuracy: 64.06
Round  28, Global train loss: 1.546, Global test loss: 1.657, Global test accuracy: 48.20
Round  29, Train loss: 1.576, Test loss: 1.139, Test accuracy: 64.80
Round  29, Global train loss: 1.576, Global test loss: 1.750, Global test accuracy: 44.36
Round  30, Train loss: 1.458, Test loss: 1.143, Test accuracy: 63.78
Round  30, Global train loss: 1.458, Global test loss: 1.698, Global test accuracy: 41.48
Round  31, Train loss: 1.549, Test loss: 1.164, Test accuracy: 63.08
Round  31, Global train loss: 1.549, Global test loss: 1.623, Global test accuracy: 50.48
Round  32, Train loss: 1.229, Test loss: 1.161, Test accuracy: 62.64
Round  32, Global train loss: 1.229, Global test loss: 1.607, Global test accuracy: 48.94
Round  33, Train loss: 1.383, Test loss: 1.156, Test accuracy: 62.82
Round  33, Global train loss: 1.383, Global test loss: 1.531, Global test accuracy: 49.56
Round  34, Train loss: 1.557, Test loss: 1.148, Test accuracy: 63.02
Round  34, Global train loss: 1.557, Global test loss: 1.746, Global test accuracy: 43.42
Round  35, Train loss: 1.288, Test loss: 1.134, Test accuracy: 63.24
Round  35, Global train loss: 1.288, Global test loss: 1.710, Global test accuracy: 44.30
Round  36, Train loss: 1.288, Test loss: 1.138, Test accuracy: 62.50
Round  36, Global train loss: 1.288, Global test loss: 1.701, Global test accuracy: 46.02
Round  37, Train loss: 1.139, Test loss: 1.154, Test accuracy: 61.36
Round  37, Global train loss: 1.139, Global test loss: 1.527, Global test accuracy: 51.68
Round  38, Train loss: 1.302, Test loss: 1.172, Test accuracy: 59.98
Round  38, Global train loss: 1.302, Global test loss: 1.654, Global test accuracy: 45.66
Round  39, Train loss: 1.496, Test loss: 1.172, Test accuracy: 60.22
Round  39, Global train loss: 1.496, Global test loss: 1.852, Global test accuracy: 39.38
Round  40, Train loss: 1.313, Test loss: 1.214, Test accuracy: 58.54
Round  40, Global train loss: 1.313, Global test loss: 1.598, Global test accuracy: 45.38
Round  41, Train loss: 1.256, Test loss: 1.227, Test accuracy: 57.84
Round  41, Global train loss: 1.256, Global test loss: 1.599, Global test accuracy: 48.60
Round  42, Train loss: 1.132, Test loss: 1.217, Test accuracy: 58.64
Round  42, Global train loss: 1.132, Global test loss: 1.518, Global test accuracy: 50.52
Round  43, Train loss: 1.227, Test loss: 1.191, Test accuracy: 59.82
Round  43, Global train loss: 1.227, Global test loss: 1.582, Global test accuracy: 50.12
Round  44, Train loss: 1.234, Test loss: 1.207, Test accuracy: 58.80
Round  44, Global train loss: 1.234, Global test loss: 1.733, Global test accuracy: 47.12
Round  45, Train loss: 1.170, Test loss: 1.141, Test accuracy: 60.86
Round  45, Global train loss: 1.170, Global test loss: 1.485, Global test accuracy: 53.26
Round  46, Train loss: 1.265, Test loss: 1.157, Test accuracy: 60.68
Round  46, Global train loss: 1.265, Global test loss: 1.693, Global test accuracy: 43.12
Round  47, Train loss: 1.091, Test loss: 1.143, Test accuracy: 60.82
Round  47, Global train loss: 1.091, Global test loss: 1.664, Global test accuracy: 46.22
Round  48, Train loss: 1.214, Test loss: 1.152, Test accuracy: 60.86
Round  48, Global train loss: 1.214, Global test loss: 1.651, Global test accuracy: 47.06
Round  49, Train loss: 1.100, Test loss: 1.171, Test accuracy: 60.42
Round  49, Global train loss: 1.100, Global test loss: 1.700, Global test accuracy: 45.12
Round  50, Train loss: 0.931, Test loss: 1.233, Test accuracy: 59.16
Round  50, Global train loss: 0.931, Global test loss: 1.513, Global test accuracy: 51.42
Round  51, Train loss: 1.244, Test loss: 1.202, Test accuracy: 60.12
Round  51, Global train loss: 1.244, Global test loss: 1.716, Global test accuracy: 45.48
Round  52, Train loss: 1.215, Test loss: 1.280, Test accuracy: 57.10
Round  52, Global train loss: 1.215, Global test loss: 1.855, Global test accuracy: 43.60
Round  53, Train loss: 0.997, Test loss: 1.245, Test accuracy: 58.10
Round  53, Global train loss: 0.997, Global test loss: 1.735, Global test accuracy: 47.02
Round  54, Train loss: 0.976, Test loss: 1.255, Test accuracy: 57.80
Round  54, Global train loss: 0.976, Global test loss: 1.571, Global test accuracy: 48.24
Round  55, Train loss: 1.051, Test loss: 1.218, Test accuracy: 58.44
Round  55, Global train loss: 1.051, Global test loss: 1.635, Global test accuracy: 46.72
Round  56, Train loss: 1.038, Test loss: 1.214, Test accuracy: 59.02
Round  56, Global train loss: 1.038, Global test loss: 1.690, Global test accuracy: 45.30
Round  57, Train loss: 0.888, Test loss: 1.236, Test accuracy: 59.06
Round  57, Global train loss: 0.888, Global test loss: 1.815, Global test accuracy: 47.64
Round  58, Train loss: 1.058, Test loss: 1.254, Test accuracy: 58.16
Round  58, Global train loss: 1.058, Global test loss: 1.822, Global test accuracy: 45.30
Round  59, Train loss: 0.924, Test loss: 1.275, Test accuracy: 58.52
Round  59, Global train loss: 0.924, Global test loss: 1.656, Global test accuracy: 46.30
Round  60, Train loss: 0.833, Test loss: 1.264, Test accuracy: 58.90
Round  60, Global train loss: 0.833, Global test loss: 1.574, Global test accuracy: 52.54
Round  61, Train loss: 1.010, Test loss: 1.285, Test accuracy: 57.88
Round  61, Global train loss: 1.010, Global test loss: 1.640, Global test accuracy: 46.64
Round  62, Train loss: 0.833, Test loss: 1.289, Test accuracy: 58.04
Round  62, Global train loss: 0.833, Global test loss: 1.659, Global test accuracy: 48.86
Round  63, Train loss: 0.903, Test loss: 1.301, Test accuracy: 58.10
Round  63, Global train loss: 0.903, Global test loss: 1.705, Global test accuracy: 45.96
Round  64, Train loss: 0.811, Test loss: 1.329, Test accuracy: 58.30
Round  64, Global train loss: 0.811, Global test loss: 1.854, Global test accuracy: 45.66
Round  65, Train loss: 0.906, Test loss: 1.358, Test accuracy: 57.28
Round  65, Global train loss: 0.906, Global test loss: 1.742, Global test accuracy: 44.90
Round  66, Train loss: 0.793, Test loss: 1.358, Test accuracy: 57.18
Round  66, Global train loss: 0.793, Global test loss: 1.697, Global test accuracy: 46.98
Round  67, Train loss: 0.760, Test loss: 1.417, Test accuracy: 56.34
Round  67, Global train loss: 0.760, Global test loss: 1.936, Global test accuracy: 44.20
Round  68, Train loss: 0.847, Test loss: 1.410, Test accuracy: 56.54
Round  68, Global train loss: 0.847, Global test loss: 1.872, Global test accuracy: 42.16
Round  69, Train loss: 0.751, Test loss: 1.478, Test accuracy: 55.46
Round  69, Global train loss: 0.751, Global test loss: 2.048, Global test accuracy: 42.54
Round  70, Train loss: 0.842, Test loss: 1.496, Test accuracy: 55.58
Round  70, Global train loss: 0.842, Global test loss: 1.863, Global test accuracy: 44.66
Round  71, Train loss: 0.629, Test loss: 1.492, Test accuracy: 55.70
Round  71, Global train loss: 0.629, Global test loss: 1.984, Global test accuracy: 45.20
Round  72, Train loss: 0.767, Test loss: 1.503, Test accuracy: 56.24
Round  72, Global train loss: 0.767, Global test loss: 2.037, Global test accuracy: 41.24
Round  73, Train loss: 0.675, Test loss: 1.505, Test accuracy: 56.08
Round  73, Global train loss: 0.675, Global test loss: 1.904, Global test accuracy: 42.62
Round  74, Train loss: 0.597, Test loss: 1.534, Test accuracy: 55.34
Round  74, Global train loss: 0.597, Global test loss: 1.873, Global test accuracy: 44.18
Round  75, Train loss: 0.787, Test loss: 1.622, Test accuracy: 54.50
Round  75, Global train loss: 0.787, Global test loss: 1.954, Global test accuracy: 42.20
Round  76, Train loss: 0.590, Test loss: 1.553, Test accuracy: 55.24
Round  76, Global train loss: 0.590, Global test loss: 2.036, Global test accuracy: 42.88
Round  77, Train loss: 0.551, Test loss: 1.567, Test accuracy: 55.26
Round  77, Global train loss: 0.551, Global test loss: 2.055, Global test accuracy: 45.16
Round  78, Train loss: 0.596, Test loss: 1.531, Test accuracy: 55.82
Round  78, Global train loss: 0.596, Global test loss: 1.940, Global test accuracy: 44.68
Round  79, Train loss: 0.557, Test loss: 1.559, Test accuracy: 55.84
Round  79, Global train loss: 0.557, Global test loss: 2.298, Global test accuracy: 38.72
Round  80, Train loss: 0.728, Test loss: 1.533, Test accuracy: 56.06
Round  80, Global train loss: 0.728, Global test loss: 2.066, Global test accuracy: 39.80
Round  81, Train loss: 0.664, Test loss: 1.594, Test accuracy: 55.32
Round  81, Global train loss: 0.664, Global test loss: 2.250, Global test accuracy: 38.40
Round  82, Train loss: 0.541, Test loss: 1.619, Test accuracy: 54.34
Round  82, Global train loss: 0.541, Global test loss: 2.069, Global test accuracy: 43.22
Round  83, Train loss: 0.675, Test loss: 1.632, Test accuracy: 55.00
Round  83, Global train loss: 0.675, Global test loss: 2.122, Global test accuracy: 42.34
Round  84, Train loss: 0.684, Test loss: 1.624, Test accuracy: 56.00
Round  84, Global train loss: 0.684, Global test loss: 2.090, Global test accuracy: 41.48
Round  85, Train loss: 0.543, Test loss: 1.659, Test accuracy: 55.94
Round  85, Global train loss: 0.543, Global test loss: 2.077, Global test accuracy: 47.84
Round  86, Train loss: 0.533, Test loss: 1.684, Test accuracy: 54.74
Round  86, Global train loss: 0.533, Global test loss: 2.251, Global test accuracy: 43.22
Round  87, Train loss: 0.613, Test loss: 1.724, Test accuracy: 54.56
Round  87, Global train loss: 0.613, Global test loss: 2.195, Global test accuracy: 44.40
Round  88, Train loss: 0.434, Test loss: 1.713, Test accuracy: 54.22
Round  88, Global train loss: 0.434, Global test loss: 2.396, Global test accuracy: 43.06
Round  89, Train loss: 0.429, Test loss: 1.771, Test accuracy: 53.26
Round  89, Global train loss: 0.429, Global test loss: 2.175, Global test accuracy: 46.12
Round  90, Train loss: 0.562, Test loss: 1.756, Test accuracy: 53.54
Round  90, Global train loss: 0.562, Global test loss: 2.084, Global test accuracy: 40.94
Round  91, Train loss: 0.577, Test loss: 1.810, Test accuracy: 53.34
Round  91, Global train loss: 0.577, Global test loss: 2.279, Global test accuracy: 39.20
Round  92, Train loss: 0.485, Test loss: 1.798, Test accuracy: 53.62
Round  92, Global train loss: 0.485, Global test loss: 2.297, Global test accuracy: 43.48
Round  93, Train loss: 0.419, Test loss: 1.794, Test accuracy: 53.54
Round  93, Global train loss: 0.419, Global test loss: 2.156, Global test accuracy: 46.48
Round  94, Train loss: 0.475, Test loss: 1.804, Test accuracy: 53.42
Round  94, Global train loss: 0.475, Global test loss: 2.176, Global test accuracy: 39.92
Round  95, Train loss: 0.541, Test loss: 1.873, Test accuracy: 53.58
Round  95, Global train loss: 0.541, Global test loss: 2.277, Global test accuracy: 41.86
Round  96, Train loss: 0.396, Test loss: 1.844, Test accuracy: 53.10
Round  96, Global train loss: 0.396, Global test loss: 2.212, Global test accuracy: 45.68
Round  97, Train loss: 0.490, Test loss: 1.873, Test accuracy: 53.58
Round  97, Global train loss: 0.490, Global test loss: 2.161, Global test accuracy: 43.42
Round  98, Train loss: 0.469, Test loss: 1.826, Test accuracy: 54.84
Round  98, Global train loss: 0.469, Global test loss: 2.296, Global test accuracy: 46.40
Round  99, Train loss: 0.489, Test loss: 1.747, Test accuracy: 55.92
Round  99, Global train loss: 0.489, Global test loss: 2.308, Global test accuracy: 43.24
Final Round, Train loss: 0.399, Test loss: 2.094, Test accuracy: 52.52
Final Round, Global train loss: 0.399, Global test loss: 2.308, Global test accuracy: 43.24
Average accuracy final 10 rounds: 53.848
Average global accuracy final 10 rounds: 43.062
1200.3293073177338
[3.1783289909362793, 6.056813478469849, 8.927366018295288, 11.78929853439331, 14.636927366256714, 17.53279399871826, 20.407914400100708, 23.492778778076172, 26.677703857421875, 29.87606430053711, 32.81804442405701, 35.73693323135376, 38.694578886032104, 41.50123620033264, 44.34944558143616, 47.306318521499634, 50.18965673446655, 53.092965602874756, 56.15399098396301, 59.00706195831299, 61.885934591293335, 64.84217834472656, 67.81591963768005, 70.77132964134216, 73.71534061431885, 76.57831692695618, 79.64147114753723, 82.50818276405334, 85.54131197929382, 88.51620507240295, 91.34804511070251, 94.22887086868286, 97.1045401096344, 99.93128800392151, 102.72817015647888, 105.64140605926514, 108.5209846496582, 111.44627261161804, 114.30136775970459, 117.41746234893799, 120.2678050994873, 123.16163063049316, 125.99860548973083, 128.84613156318665, 131.7500729560852, 134.6394190788269, 137.6266486644745, 140.66839814186096, 143.73910999298096, 146.79797530174255, 149.82277846336365, 152.78096342086792, 155.67851185798645, 158.5848159790039, 161.3992371559143, 164.27230858802795, 167.14388179779053, 170.00580716133118, 172.81005597114563, 175.64196634292603, 178.54930996894836, 181.65221118927002, 184.560040473938, 187.4285831451416, 190.38017868995667, 193.24662733078003, 196.23888421058655, 199.2272138595581, 202.20742535591125, 205.2435600757599, 208.14646744728088, 211.23035883903503, 214.05357718467712, 216.9085395336151, 219.81230068206787, 222.70399236679077, 225.49411511421204, 228.3182818889618, 231.18501138687134, 234.08083510398865, 236.99922609329224, 239.8916952610016, 243.01608157157898, 245.90247583389282, 248.7539222240448, 251.63896441459656, 254.51753997802734, 257.42867612838745, 260.33568477630615, 263.22277212142944, 266.0182478427887, 268.90662598609924, 272.1384656429291, 275.3371820449829, 278.54094767570496, 281.9176161289215, 285.15615129470825, 288.3073105812073, 291.6180787086487, 294.77675127983093, 300.334105014801]
[13.8, 20.36, 35.26, 38.52, 41.12, 41.06, 43.76, 47.9, 50.36, 49.16, 52.5, 55.46, 58.04, 57.72, 58.2, 58.34, 59.4, 60.3, 59.92, 59.46, 59.86, 61.12, 61.24, 62.38, 63.16, 63.16, 63.56, 65.12, 64.06, 64.8, 63.78, 63.08, 62.64, 62.82, 63.02, 63.24, 62.5, 61.36, 59.98, 60.22, 58.54, 57.84, 58.64, 59.82, 58.8, 60.86, 60.68, 60.82, 60.86, 60.42, 59.16, 60.12, 57.1, 58.1, 57.8, 58.44, 59.02, 59.06, 58.16, 58.52, 58.9, 57.88, 58.04, 58.1, 58.3, 57.28, 57.18, 56.34, 56.54, 55.46, 55.58, 55.7, 56.24, 56.08, 55.34, 54.5, 55.24, 55.26, 55.82, 55.84, 56.06, 55.32, 54.34, 55.0, 56.0, 55.94, 54.74, 54.56, 54.22, 53.26, 53.54, 53.34, 53.62, 53.54, 53.42, 53.58, 53.1, 53.58, 54.84, 55.92, 52.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.094, Test loss: 2.262, Test accuracy: 12.84
Round   0, Global train loss: 2.094, Global test loss: 2.321, Global test accuracy: 10.60
Round   1, Train loss: 1.937, Test loss: 2.194, Test accuracy: 20.18
Round   1, Global train loss: 1.937, Global test loss: 2.342, Global test accuracy: 19.50
Round   2, Train loss: 1.986, Test loss: 1.869, Test accuracy: 30.32
Round   2, Global train loss: 1.986, Global test loss: 2.269, Global test accuracy: 18.06
Round   3, Train loss: 1.827, Test loss: 1.830, Test accuracy: 35.08
Round   3, Global train loss: 1.827, Global test loss: 2.236, Global test accuracy: 19.60
Round   4, Train loss: 1.847, Test loss: 1.744, Test accuracy: 39.06
Round   4, Global train loss: 1.847, Global test loss: 2.160, Global test accuracy: 19.44
Round   5, Train loss: 1.818, Test loss: 1.690, Test accuracy: 43.32
Round   5, Global train loss: 1.818, Global test loss: 2.206, Global test accuracy: 23.60
Round   6, Train loss: 1.749, Test loss: 1.685, Test accuracy: 41.32
Round   6, Global train loss: 1.749, Global test loss: 2.158, Global test accuracy: 23.60
Round   7, Train loss: 1.903, Test loss: 1.609, Test accuracy: 47.54
Round   7, Global train loss: 1.903, Global test loss: 2.266, Global test accuracy: 23.14
Round   8, Train loss: 1.775, Test loss: 1.495, Test accuracy: 51.56
Round   8, Global train loss: 1.775, Global test loss: 2.044, Global test accuracy: 24.78
Round   9, Train loss: 1.712, Test loss: 1.584, Test accuracy: 50.44
Round   9, Global train loss: 1.712, Global test loss: 2.108, Global test accuracy: 25.08
Round  10, Train loss: 1.783, Test loss: 1.470, Test accuracy: 51.96
Round  10, Global train loss: 1.783, Global test loss: 2.060, Global test accuracy: 34.84
Round  11, Train loss: 1.673, Test loss: 1.366, Test accuracy: 54.26
Round  11, Global train loss: 1.673, Global test loss: 1.989, Global test accuracy: 28.44
Round  12, Train loss: 1.831, Test loss: 1.362, Test accuracy: 56.64
Round  12, Global train loss: 1.831, Global test loss: 2.248, Global test accuracy: 25.22
Round  13, Train loss: 1.713, Test loss: 1.358, Test accuracy: 56.62
Round  13, Global train loss: 1.713, Global test loss: 1.984, Global test accuracy: 35.32
Round  14, Train loss: 1.664, Test loss: 1.379, Test accuracy: 56.20
Round  14, Global train loss: 1.664, Global test loss: 1.946, Global test accuracy: 37.18
Round  15, Train loss: 1.597, Test loss: 1.369, Test accuracy: 58.50
Round  15, Global train loss: 1.597, Global test loss: 1.945, Global test accuracy: 35.34
Round  16, Train loss: 1.557, Test loss: 1.334, Test accuracy: 58.74
Round  16, Global train loss: 1.557, Global test loss: 1.976, Global test accuracy: 36.10
Round  17, Train loss: 1.564, Test loss: 1.364, Test accuracy: 58.88
Round  17, Global train loss: 1.564, Global test loss: 1.941, Global test accuracy: 33.32
Round  18, Train loss: 1.693, Test loss: 1.287, Test accuracy: 59.90
Round  18, Global train loss: 1.693, Global test loss: 2.022, Global test accuracy: 36.04
Round  19, Train loss: 1.709, Test loss: 1.244, Test accuracy: 62.32
Round  19, Global train loss: 1.709, Global test loss: 1.985, Global test accuracy: 33.42
Round  20, Train loss: 1.733, Test loss: 1.280, Test accuracy: 61.70
Round  20, Global train loss: 1.733, Global test loss: 2.053, Global test accuracy: 30.60
Round  21, Train loss: 1.689, Test loss: 1.233, Test accuracy: 61.14
Round  21, Global train loss: 1.689, Global test loss: 2.138, Global test accuracy: 26.34
Round  22, Train loss: 1.666, Test loss: 1.218, Test accuracy: 62.10
Round  22, Global train loss: 1.666, Global test loss: 1.964, Global test accuracy: 34.86
Round  23, Train loss: 1.487, Test loss: 1.207, Test accuracy: 61.28
Round  23, Global train loss: 1.487, Global test loss: 1.899, Global test accuracy: 43.08
Round  24, Train loss: 1.621, Test loss: 1.229, Test accuracy: 63.78
Round  24, Global train loss: 1.621, Global test loss: 1.997, Global test accuracy: 26.20
Round  25, Train loss: 1.619, Test loss: 1.191, Test accuracy: 63.88
Round  25, Global train loss: 1.619, Global test loss: 1.887, Global test accuracy: 31.86
Round  26, Train loss: 1.644, Test loss: 1.187, Test accuracy: 64.36
Round  26, Global train loss: 1.644, Global test loss: 1.813, Global test accuracy: 39.36
Round  27, Train loss: 1.602, Test loss: 1.201, Test accuracy: 65.26
Round  27, Global train loss: 1.602, Global test loss: 1.921, Global test accuracy: 30.04
Round  28, Train loss: 1.579, Test loss: 1.186, Test accuracy: 63.98
Round  28, Global train loss: 1.579, Global test loss: 1.994, Global test accuracy: 31.94
Round  29, Train loss: 1.593, Test loss: 1.149, Test accuracy: 64.98
Round  29, Global train loss: 1.593, Global test loss: 2.008, Global test accuracy: 26.46
Round  30, Train loss: 1.423, Test loss: 1.145, Test accuracy: 65.18
Round  30, Global train loss: 1.423, Global test loss: 1.841, Global test accuracy: 35.72
Round  31, Train loss: 1.593, Test loss: 1.132, Test accuracy: 64.32
Round  31, Global train loss: 1.593, Global test loss: 1.889, Global test accuracy: 36.68
Round  32, Train loss: 1.490, Test loss: 1.175, Test accuracy: 65.16
Round  32, Global train loss: 1.490, Global test loss: 1.981, Global test accuracy: 33.62
Round  33, Train loss: 1.623, Test loss: 1.170, Test accuracy: 65.58
Round  33, Global train loss: 1.623, Global test loss: 1.973, Global test accuracy: 32.40
Round  34, Train loss: 1.627, Test loss: 1.174, Test accuracy: 65.08
Round  34, Global train loss: 1.627, Global test loss: 2.115, Global test accuracy: 24.86
Round  35, Train loss: 1.492, Test loss: 1.157, Test accuracy: 65.40
Round  35, Global train loss: 1.492, Global test loss: 2.047, Global test accuracy: 35.12
Round  36, Train loss: 1.413, Test loss: 1.172, Test accuracy: 65.00
Round  36, Global train loss: 1.413, Global test loss: 1.956, Global test accuracy: 33.18
Round  37, Train loss: 1.444, Test loss: 1.141, Test accuracy: 65.20
Round  37, Global train loss: 1.444, Global test loss: 1.961, Global test accuracy: 33.72
Round  38, Train loss: 1.457, Test loss: 1.154, Test accuracy: 65.52
Round  38, Global train loss: 1.457, Global test loss: 1.978, Global test accuracy: 28.90
Round  39, Train loss: 1.629, Test loss: 1.126, Test accuracy: 68.16
Round  39, Global train loss: 1.629, Global test loss: 2.093, Global test accuracy: 27.96
Round  40, Train loss: 1.565, Test loss: 1.181, Test accuracy: 65.80
Round  40, Global train loss: 1.565, Global test loss: 1.924, Global test accuracy: 32.50
Round  41, Train loss: 1.488, Test loss: 1.121, Test accuracy: 66.20
Round  41, Global train loss: 1.488, Global test loss: 2.071, Global test accuracy: 25.48
Round  42, Train loss: 1.445, Test loss: 1.120, Test accuracy: 66.94
Round  42, Global train loss: 1.445, Global test loss: 1.774, Global test accuracy: 44.62
Round  43, Train loss: 1.417, Test loss: 1.128, Test accuracy: 67.52
Round  43, Global train loss: 1.417, Global test loss: 1.889, Global test accuracy: 35.34
Round  44, Train loss: 1.401, Test loss: 1.058, Test accuracy: 68.74
Round  44, Global train loss: 1.401, Global test loss: 1.857, Global test accuracy: 42.98
Round  45, Train loss: 1.421, Test loss: 1.098, Test accuracy: 66.48
Round  45, Global train loss: 1.421, Global test loss: 1.771, Global test accuracy: 42.72
Round  46, Train loss: 1.471, Test loss: 1.155, Test accuracy: 67.66
Round  46, Global train loss: 1.471, Global test loss: 2.123, Global test accuracy: 25.34
Round  47, Train loss: 1.457, Test loss: 1.087, Test accuracy: 68.30
Round  47, Global train loss: 1.457, Global test loss: 2.010, Global test accuracy: 28.92
Round  48, Train loss: 1.464, Test loss: 1.100, Test accuracy: 67.24
Round  48, Global train loss: 1.464, Global test loss: 1.902, Global test accuracy: 29.24
Round  49, Train loss: 1.442, Test loss: 1.087, Test accuracy: 67.34
Round  49, Global train loss: 1.442, Global test loss: 2.121, Global test accuracy: 26.12
Round  50, Train loss: 1.350, Test loss: 1.101, Test accuracy: 67.34
Round  50, Global train loss: 1.350, Global test loss: 1.743, Global test accuracy: 39.40
Round  51, Train loss: 1.309, Test loss: 1.073, Test accuracy: 67.94
Round  51, Global train loss: 1.309, Global test loss: 1.858, Global test accuracy: 39.80
Round  52, Train loss: 1.293, Test loss: 1.033, Test accuracy: 67.18
Round  52, Global train loss: 1.293, Global test loss: 1.768, Global test accuracy: 48.96
Round  53, Train loss: 1.501, Test loss: 1.061, Test accuracy: 68.20
Round  53, Global train loss: 1.501, Global test loss: 2.028, Global test accuracy: 29.58
Round  54, Train loss: 1.450, Test loss: 1.052, Test accuracy: 68.68
Round  54, Global train loss: 1.450, Global test loss: 1.862, Global test accuracy: 39.14
Round  55, Train loss: 1.213, Test loss: 1.025, Test accuracy: 68.84
Round  55, Global train loss: 1.213, Global test loss: 1.637, Global test accuracy: 43.48
Round  56, Train loss: 1.380, Test loss: 1.022, Test accuracy: 68.72
Round  56, Global train loss: 1.380, Global test loss: 1.926, Global test accuracy: 37.62
Round  57, Train loss: 1.375, Test loss: 1.069, Test accuracy: 67.42
Round  57, Global train loss: 1.375, Global test loss: 1.955, Global test accuracy: 35.92
Round  58, Train loss: 1.252, Test loss: 1.084, Test accuracy: 68.24
Round  58, Global train loss: 1.252, Global test loss: 1.903, Global test accuracy: 32.98
Round  59, Train loss: 1.300, Test loss: 1.063, Test accuracy: 67.90
Round  59, Global train loss: 1.300, Global test loss: 1.759, Global test accuracy: 41.34
Round  60, Train loss: 1.397, Test loss: 1.045, Test accuracy: 67.52
Round  60, Global train loss: 1.397, Global test loss: 1.823, Global test accuracy: 43.90
Round  61, Train loss: 1.244, Test loss: 1.063, Test accuracy: 67.40
Round  61, Global train loss: 1.244, Global test loss: 1.625, Global test accuracy: 46.68
Round  62, Train loss: 1.304, Test loss: 1.061, Test accuracy: 67.00
Round  62, Global train loss: 1.304, Global test loss: 2.013, Global test accuracy: 30.22
Round  63, Train loss: 1.401, Test loss: 1.069, Test accuracy: 67.16
Round  63, Global train loss: 1.401, Global test loss: 1.845, Global test accuracy: 35.22
Round  64, Train loss: 1.335, Test loss: 1.115, Test accuracy: 66.02
Round  64, Global train loss: 1.335, Global test loss: 2.038, Global test accuracy: 26.18
Round  65, Train loss: 1.303, Test loss: 1.089, Test accuracy: 65.48
Round  65, Global train loss: 1.303, Global test loss: 2.001, Global test accuracy: 30.40
Round  66, Train loss: 1.219, Test loss: 1.068, Test accuracy: 66.74
Round  66, Global train loss: 1.219, Global test loss: 1.723, Global test accuracy: 42.54
Round  67, Train loss: 1.271, Test loss: 1.093, Test accuracy: 65.82
Round  67, Global train loss: 1.271, Global test loss: 1.837, Global test accuracy: 40.68
Round  68, Train loss: 1.270, Test loss: 1.096, Test accuracy: 66.48
Round  68, Global train loss: 1.270, Global test loss: 2.150, Global test accuracy: 26.68
Round  69, Train loss: 1.295, Test loss: 1.102, Test accuracy: 65.82
Round  69, Global train loss: 1.295, Global test loss: 1.874, Global test accuracy: 34.96
Round  70, Train loss: 1.084, Test loss: 1.034, Test accuracy: 67.50
Round  70, Global train loss: 1.084, Global test loss: 1.725, Global test accuracy: 41.48
Round  71, Train loss: 1.265, Test loss: 1.051, Test accuracy: 66.72
Round  71, Global train loss: 1.265, Global test loss: 2.082, Global test accuracy: 32.76
Round  72, Train loss: 1.161, Test loss: 1.078, Test accuracy: 64.90
Round  72, Global train loss: 1.161, Global test loss: 2.111, Global test accuracy: 30.40
Round  73, Train loss: 1.209, Test loss: 1.089, Test accuracy: 63.88
Round  73, Global train loss: 1.209, Global test loss: 1.812, Global test accuracy: 41.04
Round  74, Train loss: 1.211, Test loss: 1.095, Test accuracy: 64.02
Round  74, Global train loss: 1.211, Global test loss: 1.827, Global test accuracy: 37.04
Round  75, Train loss: 1.195, Test loss: 1.096, Test accuracy: 64.08
Round  75, Global train loss: 1.195, Global test loss: 2.247, Global test accuracy: 28.38
Round  76, Train loss: 1.082, Test loss: 1.113, Test accuracy: 63.78
Round  76, Global train loss: 1.082, Global test loss: 1.942, Global test accuracy: 36.72
Round  77, Train loss: 1.093, Test loss: 1.080, Test accuracy: 64.04
Round  77, Global train loss: 1.093, Global test loss: 1.973, Global test accuracy: 38.30
Round  78, Train loss: 1.158, Test loss: 1.102, Test accuracy: 63.06
Round  78, Global train loss: 1.158, Global test loss: 2.016, Global test accuracy: 29.62
Round  79, Train loss: 1.060, Test loss: 1.107, Test accuracy: 62.42
Round  79, Global train loss: 1.060, Global test loss: 1.917, Global test accuracy: 36.98
Round  80, Train loss: 1.245, Test loss: 1.117, Test accuracy: 62.74
Round  80, Global train loss: 1.245, Global test loss: 2.061, Global test accuracy: 30.14
Round  81, Train loss: 1.059, Test loss: 1.113, Test accuracy: 62.52
Round  81, Global train loss: 1.059, Global test loss: 1.945, Global test accuracy: 32.92
Round  82, Train loss: 1.109, Test loss: 1.111, Test accuracy: 63.64
Round  82, Global train loss: 1.109, Global test loss: 1.987, Global test accuracy: 35.72
Round  83, Train loss: 1.109, Test loss: 1.105, Test accuracy: 63.62
Round  83, Global train loss: 1.109, Global test loss: 2.224, Global test accuracy: 28.46
Round  84, Train loss: 1.030, Test loss: 1.107, Test accuracy: 62.58
Round  84, Global train loss: 1.030, Global test loss: 1.808, Global test accuracy: 43.96
Round  85, Train loss: 0.982, Test loss: 1.087, Test accuracy: 63.94
Round  85, Global train loss: 0.982, Global test loss: 1.738, Global test accuracy: 43.38
Round  86, Train loss: 0.911, Test loss: 1.122, Test accuracy: 63.26
Round  86, Global train loss: 0.911, Global test loss: 1.796, Global test accuracy: 38.80
Round  87, Train loss: 1.074, Test loss: 1.132, Test accuracy: 63.42
Round  87, Global train loss: 1.074, Global test loss: 1.857, Global test accuracy: 40.88
Round  88, Train loss: 0.963, Test loss: 1.115, Test accuracy: 63.78
Round  88, Global train loss: 0.963, Global test loss: 1.998, Global test accuracy: 39.24
Round  89, Train loss: 0.976, Test loss: 1.129, Test accuracy: 63.42
Round  89, Global train loss: 0.976, Global test loss: 1.966, Global test accuracy: 38.64
Round  90, Train loss: 1.013, Test loss: 1.120, Test accuracy: 62.88
Round  90, Global train loss: 1.013, Global test loss: 1.878, Global test accuracy: 35.56
Round  91, Train loss: 1.019, Test loss: 1.127, Test accuracy: 62.18
Round  91, Global train loss: 1.019, Global test loss: 1.931, Global test accuracy: 39.10
Round  92, Train loss: 1.008, Test loss: 1.149, Test accuracy: 61.68
Round  92, Global train loss: 1.008, Global test loss: 1.842, Global test accuracy: 38.38
Round  93, Train loss: 0.982, Test loss: 1.192, Test accuracy: 60.48
Round  93, Global train loss: 0.982, Global test loss: 1.856, Global test accuracy: 41.30
Round  94, Train loss: 0.909, Test loss: 1.163, Test accuracy: 61.76
Round  94, Global train loss: 0.909, Global test loss: 2.035, Global test accuracy: 35.10
Round  95, Train loss: 1.048, Test loss: 1.138, Test accuracy: 62.14
Round  95, Global train loss: 1.048, Global test loss: 2.143, Global test accuracy: 33.68
Round  96, Train loss: 0.887, Test loss: 1.184, Test accuracy: 59.44
Round  96, Global train loss: 0.887, Global test loss: 1.941, Global test accuracy: 38.52
Round  97, Train loss: 0.892, Test loss: 1.151, Test accuracy: 62.10
Round  97, Global train loss: 0.892, Global test loss: 1.995, Global test accuracy: 36.24
Round  98, Train loss: 0.963, Test loss: 1.149, Test accuracy: 62.70
Round  98, Global train loss: 0.963, Global test loss: 2.195, Global test accuracy: 33.88
Round  99, Train loss: 0.791, Test loss: 1.169, Test accuracy: 61.56
Round  99, Global train loss: 0.791, Global test loss: 1.825, Global test accuracy: 40.88
Final Round, Train loss: 0.844, Test loss: 1.181, Test accuracy: 61.20
Final Round, Global train loss: 0.844, Global test loss: 1.825, Global test accuracy: 40.88
Average accuracy final 10 rounds: 61.69200000000001
752.8704192638397
[1.8962581157684326, 3.3523285388946533, 4.91304612159729, 6.412678956985474, 7.869861602783203, 9.315069437026978, 10.776494979858398, 12.194195747375488, 13.703750848770142, 15.201227188110352, 16.664097547531128, 18.132190227508545, 19.591574907302856, 21.073939085006714, 22.548455715179443, 24.02276086807251, 25.531752347946167, 27.025756120681763, 28.484227895736694, 29.952300548553467, 31.383533239364624, 32.91320037841797, 34.386837005615234, 35.8551983833313, 37.35996603965759, 38.848827838897705, 40.29932260513306, 41.83305025100708, 43.41242218017578, 44.94913625717163, 46.460543632507324, 47.931626319885254, 49.40727782249451, 50.921844720840454, 52.39570713043213, 53.84407162666321, 55.30199646949768, 56.835638999938965, 58.30579495429993, 59.764042139053345, 61.23226618766785, 62.69968938827515, 64.16772103309631, 65.66590905189514, 67.17573976516724, 68.61865639686584, 70.06029677391052, 71.55691623687744, 73.01756167411804, 74.4782190322876, 75.96858882904053, 77.45103192329407, 78.9041862487793, 80.42891144752502, 81.90585446357727, 83.36927485466003, 84.8592734336853, 86.3283097743988, 87.77840495109558, 89.14146852493286, 90.59717297554016, 92.01300597190857, 93.3712010383606, 94.74935722351074, 96.2021255493164, 97.6197681427002, 99.09751677513123, 100.57175993919373, 102.04668688774109, 103.5135772228241, 105.0044891834259, 106.47443652153015, 107.9418272972107, 109.41541910171509, 110.85513281822205, 112.31993961334229, 113.73250555992126, 115.1846375465393, 116.66324710845947, 118.16864204406738, 119.64597535133362, 121.17628788948059, 122.63519811630249, 124.10204458236694, 125.55996251106262, 127.04952502250671, 128.48347973823547, 130.00738883018494, 131.4618046283722, 132.96093702316284, 134.39643359184265, 135.80722546577454, 137.28766560554504, 138.821861743927, 140.3975212574005, 141.8747799396515, 143.43348097801208, 144.9008219242096, 146.376042842865, 147.8621211051941, 150.285240650177]
[12.84, 20.18, 30.32, 35.08, 39.06, 43.32, 41.32, 47.54, 51.56, 50.44, 51.96, 54.26, 56.64, 56.62, 56.2, 58.5, 58.74, 58.88, 59.9, 62.32, 61.7, 61.14, 62.1, 61.28, 63.78, 63.88, 64.36, 65.26, 63.98, 64.98, 65.18, 64.32, 65.16, 65.58, 65.08, 65.4, 65.0, 65.2, 65.52, 68.16, 65.8, 66.2, 66.94, 67.52, 68.74, 66.48, 67.66, 68.3, 67.24, 67.34, 67.34, 67.94, 67.18, 68.2, 68.68, 68.84, 68.72, 67.42, 68.24, 67.9, 67.52, 67.4, 67.0, 67.16, 66.02, 65.48, 66.74, 65.82, 66.48, 65.82, 67.5, 66.72, 64.9, 63.88, 64.02, 64.08, 63.78, 64.04, 63.06, 62.42, 62.74, 62.52, 63.64, 63.62, 62.58, 63.94, 63.26, 63.42, 63.78, 63.42, 62.88, 62.18, 61.68, 60.48, 61.76, 62.14, 59.44, 62.1, 62.7, 61.56, 61.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.111, Test loss: 2.040, Test accuracy: 30.40
Round   0, Global train loss: 2.111, Global test loss: 2.257, Global test accuracy: 19.62
Round   1, Train loss: 1.923, Test loss: 1.724, Test accuracy: 36.80
Round   1, Global train loss: 1.923, Global test loss: 2.180, Global test accuracy: 27.10
Round   2, Train loss: 1.844, Test loss: 1.616, Test accuracy: 43.54
Round   2, Global train loss: 1.844, Global test loss: 2.121, Global test accuracy: 29.90
Round   3, Train loss: 1.813, Test loss: 1.565, Test accuracy: 45.00
Round   3, Global train loss: 1.813, Global test loss: 2.089, Global test accuracy: 34.52
Round   4, Train loss: 1.791, Test loss: 1.509, Test accuracy: 47.16
Round   4, Global train loss: 1.791, Global test loss: 2.058, Global test accuracy: 36.74
Round   5, Train loss: 1.774, Test loss: 1.479, Test accuracy: 48.98
Round   5, Global train loss: 1.774, Global test loss: 2.043, Global test accuracy: 36.52
Round   6, Train loss: 1.758, Test loss: 1.450, Test accuracy: 51.58
Round   6, Global train loss: 1.758, Global test loss: 2.025, Global test accuracy: 37.86
Round   7, Train loss: 1.743, Test loss: 1.443, Test accuracy: 53.14
Round   7, Global train loss: 1.743, Global test loss: 2.017, Global test accuracy: 39.32
Round   8, Train loss: 1.730, Test loss: 1.418, Test accuracy: 54.52
Round   8, Global train loss: 1.730, Global test loss: 2.000, Global test accuracy: 41.70
Round   9, Train loss: 1.714, Test loss: 1.359, Test accuracy: 55.68
Round   9, Global train loss: 1.714, Global test loss: 1.961, Global test accuracy: 42.42
Round  10, Train loss: 1.756, Test loss: 1.385, Test accuracy: 56.82
Round  10, Global train loss: 1.756, Global test loss: 2.072, Global test accuracy: 33.14
Round  11, Train loss: 1.388, Test loss: 1.285, Test accuracy: 57.44
Round  11, Global train loss: 1.388, Global test loss: 2.113, Global test accuracy: 23.40
Round  12, Train loss: 1.437, Test loss: 1.345, Test accuracy: 51.14
Round  12, Global train loss: 1.437, Global test loss: 2.532, Global test accuracy: 19.00
Round  13, Train loss: 1.419, Test loss: 1.301, Test accuracy: 55.52
Round  13, Global train loss: 1.419, Global test loss: 2.100, Global test accuracy: 28.02
Round  14, Train loss: 1.450, Test loss: 1.328, Test accuracy: 53.96
Round  14, Global train loss: 1.450, Global test loss: 2.083, Global test accuracy: 25.60
Round  15, Train loss: 1.458, Test loss: 1.302, Test accuracy: 57.24
Round  15, Global train loss: 1.458, Global test loss: 2.192, Global test accuracy: 25.60
Round  16, Train loss: 1.384, Test loss: 1.274, Test accuracy: 56.10
Round  16, Global train loss: 1.384, Global test loss: 2.142, Global test accuracy: 32.08
Round  17, Train loss: 1.343, Test loss: 1.242, Test accuracy: 58.06
Round  17, Global train loss: 1.343, Global test loss: 2.094, Global test accuracy: 25.40
Round  18, Train loss: 1.440, Test loss: 1.279, Test accuracy: 55.56
Round  18, Global train loss: 1.440, Global test loss: 2.114, Global test accuracy: 34.14
Round  19, Train loss: 1.376, Test loss: 1.275, Test accuracy: 54.70
Round  19, Global train loss: 1.376, Global test loss: 2.103, Global test accuracy: 27.96
Round  20, Train loss: 1.411, Test loss: 1.229, Test accuracy: 57.96
Round  20, Global train loss: 1.411, Global test loss: 1.922, Global test accuracy: 31.20
Round  21, Train loss: 1.402, Test loss: 1.269, Test accuracy: 53.36
Round  21, Global train loss: 1.402, Global test loss: 2.371, Global test accuracy: 18.56
Round  22, Train loss: 1.415, Test loss: 1.270, Test accuracy: 57.44
Round  22, Global train loss: 1.415, Global test loss: 1.957, Global test accuracy: 35.40
Round  23, Train loss: 1.447, Test loss: 1.255, Test accuracy: 56.46
Round  23, Global train loss: 1.447, Global test loss: 2.209, Global test accuracy: 38.20
Round  24, Train loss: 1.363, Test loss: 1.211, Test accuracy: 59.88
Round  24, Global train loss: 1.363, Global test loss: 1.958, Global test accuracy: 26.90
Round  25, Train loss: 1.320, Test loss: 1.182, Test accuracy: 58.78
Round  25, Global train loss: 1.320, Global test loss: 1.832, Global test accuracy: 34.02
Round  26, Train loss: 1.433, Test loss: 1.210, Test accuracy: 56.46
Round  26, Global train loss: 1.433, Global test loss: 1.888, Global test accuracy: 34.06
Round  27, Train loss: 1.386, Test loss: 1.217, Test accuracy: 60.94
Round  27, Global train loss: 1.386, Global test loss: 2.013, Global test accuracy: 22.58
Round  28, Train loss: 1.375, Test loss: 1.215, Test accuracy: 60.08
Round  28, Global train loss: 1.375, Global test loss: 2.117, Global test accuracy: 27.90
Round  29, Train loss: 1.372, Test loss: 1.226, Test accuracy: 59.98
Round  29, Global train loss: 1.372, Global test loss: 2.061, Global test accuracy: 32.28
Round  30, Train loss: 1.388, Test loss: 1.199, Test accuracy: 60.58
Round  30, Global train loss: 1.388, Global test loss: 2.313, Global test accuracy: 24.70
Round  31, Train loss: 1.376, Test loss: 1.197, Test accuracy: 59.36
Round  31, Global train loss: 1.376, Global test loss: 1.896, Global test accuracy: 33.82
Round  32, Train loss: 1.399, Test loss: 1.187, Test accuracy: 60.66
Round  32, Global train loss: 1.399, Global test loss: 2.002, Global test accuracy: 31.90
Round  33, Train loss: 1.468, Test loss: 1.175, Test accuracy: 63.86
Round  33, Global train loss: 1.468, Global test loss: 1.882, Global test accuracy: 31.64
Round  34, Train loss: 1.340, Test loss: 1.209, Test accuracy: 62.56
Round  34, Global train loss: 1.340, Global test loss: 2.181, Global test accuracy: 30.16
Round  35, Train loss: 1.383, Test loss: 1.159, Test accuracy: 62.24
Round  35, Global train loss: 1.383, Global test loss: 2.294, Global test accuracy: 31.76
Round  36, Train loss: 1.372, Test loss: 1.205, Test accuracy: 60.58
Round  36, Global train loss: 1.372, Global test loss: 2.187, Global test accuracy: 23.90
Round  37, Train loss: 1.338, Test loss: 1.147, Test accuracy: 63.42
Round  37, Global train loss: 1.338, Global test loss: 1.904, Global test accuracy: 36.00
Round  38, Train loss: 1.366, Test loss: 1.206, Test accuracy: 61.82
Round  38, Global train loss: 1.366, Global test loss: 2.262, Global test accuracy: 27.70
Round  39, Train loss: 1.342, Test loss: 1.189, Test accuracy: 61.40
Round  39, Global train loss: 1.342, Global test loss: 2.235, Global test accuracy: 28.52
Round  40, Train loss: 1.282, Test loss: 1.170, Test accuracy: 60.24
Round  40, Global train loss: 1.282, Global test loss: 1.934, Global test accuracy: 32.86
Round  41, Train loss: 1.260, Test loss: 1.152, Test accuracy: 62.72
Round  41, Global train loss: 1.260, Global test loss: 1.992, Global test accuracy: 33.88
Round  42, Train loss: 1.302, Test loss: 1.146, Test accuracy: 62.14
Round  42, Global train loss: 1.302, Global test loss: 2.051, Global test accuracy: 29.84
Round  43, Train loss: 1.195, Test loss: 1.121, Test accuracy: 62.86
Round  43, Global train loss: 1.195, Global test loss: 1.986, Global test accuracy: 32.28
Round  44, Train loss: 1.184, Test loss: 1.113, Test accuracy: 62.24
Round  44, Global train loss: 1.184, Global test loss: 2.121, Global test accuracy: 32.14
Round  45, Train loss: 1.324, Test loss: 1.146, Test accuracy: 61.50
Round  45, Global train loss: 1.324, Global test loss: 1.842, Global test accuracy: 39.36
Round  46, Train loss: 1.273, Test loss: 1.154, Test accuracy: 62.02
Round  46, Global train loss: 1.273, Global test loss: 2.294, Global test accuracy: 16.28
Round  47, Train loss: 1.166, Test loss: 1.136, Test accuracy: 64.08
Round  47, Global train loss: 1.166, Global test loss: 2.078, Global test accuracy: 27.94
Round  48, Train loss: 1.225, Test loss: 1.158, Test accuracy: 62.88
Round  48, Global train loss: 1.225, Global test loss: 1.910, Global test accuracy: 27.42
Round  49, Train loss: 1.169, Test loss: 1.177, Test accuracy: 63.06
Round  49, Global train loss: 1.169, Global test loss: 2.004, Global test accuracy: 29.32
Round  50, Train loss: 1.192, Test loss: 1.117, Test accuracy: 64.80
Round  50, Global train loss: 1.192, Global test loss: 1.863, Global test accuracy: 33.98
Round  51, Train loss: 1.258, Test loss: 1.133, Test accuracy: 64.26
Round  51, Global train loss: 1.258, Global test loss: 2.171, Global test accuracy: 28.60
Round  52, Train loss: 1.205, Test loss: 1.150, Test accuracy: 61.66
Round  52, Global train loss: 1.205, Global test loss: 2.119, Global test accuracy: 38.00
Round  53, Train loss: 1.140, Test loss: 1.123, Test accuracy: 63.02
Round  53, Global train loss: 1.140, Global test loss: 1.991, Global test accuracy: 30.96
Round  54, Train loss: 1.141, Test loss: 1.095, Test accuracy: 65.14
Round  54, Global train loss: 1.141, Global test loss: 1.855, Global test accuracy: 35.66
Round  55, Train loss: 1.217, Test loss: 1.132, Test accuracy: 63.02
Round  55, Global train loss: 1.217, Global test loss: 2.064, Global test accuracy: 30.50
Round  56, Train loss: 1.221, Test loss: 1.134, Test accuracy: 63.18
Round  56, Global train loss: 1.221, Global test loss: 2.054, Global test accuracy: 22.92
Round  57, Train loss: 1.145, Test loss: 1.129, Test accuracy: 62.00
Round  57, Global train loss: 1.145, Global test loss: 1.949, Global test accuracy: 39.24
Round  58, Train loss: 1.078, Test loss: 1.125, Test accuracy: 62.88
Round  58, Global train loss: 1.078, Global test loss: 2.268, Global test accuracy: 24.72
Round  59, Train loss: 1.143, Test loss: 1.153, Test accuracy: 62.22
Round  59, Global train loss: 1.143, Global test loss: 1.991, Global test accuracy: 32.62
Round  60, Train loss: 1.084, Test loss: 1.096, Test accuracy: 64.38
Round  60, Global train loss: 1.084, Global test loss: 1.744, Global test accuracy: 46.00
Round  61, Train loss: 1.114, Test loss: 1.119, Test accuracy: 63.84
Round  61, Global train loss: 1.114, Global test loss: 1.892, Global test accuracy: 37.64
Round  62, Train loss: 1.057, Test loss: 1.101, Test accuracy: 64.02
Round  62, Global train loss: 1.057, Global test loss: 1.901, Global test accuracy: 37.96
Round  63, Train loss: 1.096, Test loss: 1.102, Test accuracy: 63.58
Round  63, Global train loss: 1.096, Global test loss: 1.836, Global test accuracy: 33.52
Round  64, Train loss: 1.040, Test loss: 1.102, Test accuracy: 63.26
Round  64, Global train loss: 1.040, Global test loss: 2.102, Global test accuracy: 29.70
Round  65, Train loss: 1.140, Test loss: 1.111, Test accuracy: 63.58
Round  65, Global train loss: 1.140, Global test loss: 1.903, Global test accuracy: 36.08
Round  66, Train loss: 1.148, Test loss: 1.121, Test accuracy: 60.84
Round  66, Global train loss: 1.148, Global test loss: 1.877, Global test accuracy: 36.40
Round  67, Train loss: 1.171, Test loss: 1.133, Test accuracy: 61.66
Round  67, Global train loss: 1.171, Global test loss: 2.017, Global test accuracy: 37.22
Round  68, Train loss: 1.079, Test loss: 1.146, Test accuracy: 63.08
Round  68, Global train loss: 1.079, Global test loss: 2.359, Global test accuracy: 17.84
Round  69, Train loss: 1.100, Test loss: 1.105, Test accuracy: 63.06
Round  69, Global train loss: 1.100, Global test loss: 1.847, Global test accuracy: 36.88
Round  70, Train loss: 1.075, Test loss: 1.148, Test accuracy: 60.80
Round  70, Global train loss: 1.075, Global test loss: 2.031, Global test accuracy: 30.40
Round  71, Train loss: 1.040, Test loss: 1.108, Test accuracy: 62.54
Round  71, Global train loss: 1.040, Global test loss: 1.840, Global test accuracy: 40.22
Round  72, Train loss: 1.007, Test loss: 1.132, Test accuracy: 60.78
Round  72, Global train loss: 1.007, Global test loss: 2.070, Global test accuracy: 35.22
Round  73, Train loss: 1.056, Test loss: 1.138, Test accuracy: 61.06
Round  73, Global train loss: 1.056, Global test loss: 1.787, Global test accuracy: 39.26
Round  74, Train loss: 0.970, Test loss: 1.114, Test accuracy: 61.26
Round  74, Global train loss: 0.970, Global test loss: 1.836, Global test accuracy: 37.18
Round  75, Train loss: 1.040, Test loss: 1.164, Test accuracy: 60.18
Round  75, Global train loss: 1.040, Global test loss: 2.208, Global test accuracy: 20.68
Round  76, Train loss: 1.083, Test loss: 1.161, Test accuracy: 60.44
Round  76, Global train loss: 1.083, Global test loss: 1.953, Global test accuracy: 35.20
Round  77, Train loss: 0.893, Test loss: 1.104, Test accuracy: 62.58
Round  77, Global train loss: 0.893, Global test loss: 1.914, Global test accuracy: 42.64
Round  78, Train loss: 0.991, Test loss: 1.124, Test accuracy: 62.24
Round  78, Global train loss: 0.991, Global test loss: 2.047, Global test accuracy: 32.52
Round  79, Train loss: 0.974, Test loss: 1.133, Test accuracy: 61.40
Round  79, Global train loss: 0.974, Global test loss: 1.888, Global test accuracy: 38.70
Round  80, Train loss: 0.967, Test loss: 1.101, Test accuracy: 63.24
Round  80, Global train loss: 0.967, Global test loss: 1.760, Global test accuracy: 38.66
Round  81, Train loss: 0.894, Test loss: 1.105, Test accuracy: 62.24
Round  81, Global train loss: 0.894, Global test loss: 1.759, Global test accuracy: 38.40
Round  82, Train loss: 0.834, Test loss: 1.113, Test accuracy: 62.12
Round  82, Global train loss: 0.834, Global test loss: 1.812, Global test accuracy: 37.60
Round  83, Train loss: 0.796, Test loss: 1.185, Test accuracy: 59.76
Round  83, Global train loss: 0.796, Global test loss: 1.795, Global test accuracy: 39.14
Round  84, Train loss: 0.778, Test loss: 1.171, Test accuracy: 60.38
Round  84, Global train loss: 0.778, Global test loss: 1.836, Global test accuracy: 38.22
Round  85, Train loss: 0.724, Test loss: 1.199, Test accuracy: 59.00
Round  85, Global train loss: 0.724, Global test loss: 1.898, Global test accuracy: 37.04
Round  86, Train loss: 0.705, Test loss: 1.181, Test accuracy: 59.56
Round  86, Global train loss: 0.705, Global test loss: 1.883, Global test accuracy: 35.16
Round  87, Train loss: 0.662, Test loss: 1.180, Test accuracy: 60.14
Round  87, Global train loss: 0.662, Global test loss: 1.807, Global test accuracy: 38.90
Round  88, Train loss: 0.650, Test loss: 1.220, Test accuracy: 58.10
Round  88, Global train loss: 0.650, Global test loss: 1.872, Global test accuracy: 37.60
Round  89, Train loss: 0.625, Test loss: 1.238, Test accuracy: 57.88
Round  89, Global train loss: 0.625, Global test loss: 1.934, Global test accuracy: 37.22
Round  90, Train loss: 0.592, Test loss: 1.240, Test accuracy: 58.16
Round  90, Global train loss: 0.592, Global test loss: 1.996, Global test accuracy: 33.96
Round  91, Train loss: 0.564, Test loss: 1.292, Test accuracy: 55.78
Round  91, Global train loss: 0.564, Global test loss: 1.969, Global test accuracy: 35.80
Round  92, Train loss: 0.558, Test loss: 1.288, Test accuracy: 56.22
Round  92, Global train loss: 0.558, Global test loss: 1.910, Global test accuracy: 37.50
Round  93, Train loss: 0.535, Test loss: 1.256, Test accuracy: 57.64
Round  93, Global train loss: 0.535, Global test loss: 1.953, Global test accuracy: 36.52
Round  94, Train loss: 0.495, Test loss: 1.261, Test accuracy: 58.14
Round  94, Global train loss: 0.495, Global test loss: 2.033, Global test accuracy: 35.76
Round  95, Train loss: 0.507, Test loss: 1.296, Test accuracy: 57.64
Round  95, Global train loss: 0.507, Global test loss: 2.004, Global test accuracy: 37.86
Round  96, Train loss: 0.479, Test loss: 1.288, Test accuracy: 58.38
Round  96, Global train loss: 0.479, Global test loss: 2.053, Global test accuracy: 37.20
Round  97, Train loss: 0.452, Test loss: 1.293, Test accuracy: 57.48
Round  97, Global train loss: 0.452, Global test loss: 2.052, Global test accuracy: 39.22
Round  98, Train loss: 0.439, Test loss: 1.323, Test accuracy: 56.20
Round  98, Global train loss: 0.439, Global test loss: 2.154, Global test accuracy: 36.72
Round  99, Train loss: 0.805, Test loss: 1.276, Test accuracy: 57.80
Round  99, Global train loss: 0.805, Global test loss: 1.666, Global test accuracy: 44.44
Final Round, Train loss: 0.760, Test loss: 1.294, Test accuracy: 57.80
Final Round, Global train loss: 0.760, Global test loss: 1.666, Global test accuracy: 44.44
Average accuracy final 10 rounds: 57.343999999999994
2230.085331916809
[1.9556794166564941, 3.706913471221924, 5.393255233764648, 7.161593914031982, 8.888010025024414, 10.5552818775177, 12.190250396728516, 13.827538013458252, 15.465112447738647, 17.229396104812622, 22.90887451171875, 31.671346426010132, 40.49953055381775, 49.508764028549194, 58.30337071418762, 67.16390228271484, 75.95868968963623, 84.97208595275879, 93.80462431907654, 102.77563714981079, 111.59362292289734, 120.54018568992615, 129.47679090499878, 138.4221522808075, 147.26630401611328, 156.0600779056549, 164.76673483848572, 173.57508492469788, 182.48263335227966, 191.13473224639893, 199.84357738494873, 208.62558889389038, 217.9019136428833, 219.636164188385, 228.7715082168579, 237.99557638168335, 247.1782262325287, 256.0457627773285, 264.8881640434265, 273.7372591495514, 282.5553014278412, 290.7895336151123, 299.36284470558167, 308.3381540775299, 317.2747132778168, 326.2702851295471, 334.8322868347168, 343.6408989429474, 352.5977416038513, 361.5713336467743, 370.3406546115875, 379.2474298477173, 387.83627128601074, 396.8434853553772, 405.6520404815674, 414.51123094558716, 423.4743571281433, 432.51338052749634, 440.74196004867554, 449.19837832450867, 457.7352442741394, 466.30940866470337, 474.9484820365906, 483.5314438343048, 492.49000668525696, 501.24577832221985, 510.22684502601624, 518.8716442584991, 527.4288578033447, 536.0711328983307, 544.878947019577, 553.5943279266357, 562.2945449352264, 571.0041630268097, 579.721563577652, 588.2561354637146, 596.8952100276947, 605.0412859916687, 613.211446762085, 621.8718252182007, 623.5892066955566, 625.2704641819, 626.9300887584686, 628.6216998100281, 630.2993369102478, 631.9376533031464, 633.5423755645752, 635.1391654014587, 636.7664353847504, 638.579051733017, 640.2179453372955, 641.8806736469269, 643.5057129859924, 645.1611430644989, 646.836813211441, 648.4688649177551, 650.1736605167389, 651.8227632045746, 653.506011724472, 662.3003022670746, 672.2901048660278]
[30.4, 36.8, 43.54, 45.0, 47.16, 48.98, 51.58, 53.14, 54.52, 55.68, 56.82, 57.44, 51.14, 55.52, 53.96, 57.24, 56.1, 58.06, 55.56, 54.7, 57.96, 53.36, 57.44, 56.46, 59.88, 58.78, 56.46, 60.94, 60.08, 59.98, 60.58, 59.36, 60.66, 63.86, 62.56, 62.24, 60.58, 63.42, 61.82, 61.4, 60.24, 62.72, 62.14, 62.86, 62.24, 61.5, 62.02, 64.08, 62.88, 63.06, 64.8, 64.26, 61.66, 63.02, 65.14, 63.02, 63.18, 62.0, 62.88, 62.22, 64.38, 63.84, 64.02, 63.58, 63.26, 63.58, 60.84, 61.66, 63.08, 63.06, 60.8, 62.54, 60.78, 61.06, 61.26, 60.18, 60.44, 62.58, 62.24, 61.4, 63.24, 62.24, 62.12, 59.76, 60.38, 59.0, 59.56, 60.14, 58.1, 57.88, 58.16, 55.78, 56.22, 57.64, 58.14, 57.64, 58.38, 57.48, 56.2, 57.8, 57.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.022, Test loss: 2.229, Test accuracy: 13.34
Round   0, Global train loss: 2.022, Global test loss: 2.351, Global test accuracy: 14.00
Round   1, Train loss: 1.939, Test loss: 2.013, Test accuracy: 17.90
Round   1, Global train loss: 1.939, Global test loss: 2.311, Global test accuracy: 15.88
Round   2, Train loss: 1.847, Test loss: 2.016, Test accuracy: 17.94
Round   2, Global train loss: 1.847, Global test loss: 2.326, Global test accuracy: 13.88
Round   3, Train loss: 2.068, Test loss: 1.879, Test accuracy: 22.48
Round   3, Global train loss: 2.068, Global test loss: 2.279, Global test accuracy: 15.70
Round   4, Train loss: 1.885, Test loss: 1.903, Test accuracy: 21.20
Round   4, Global train loss: 1.885, Global test loss: 2.367, Global test accuracy: 10.94
Round   5, Train loss: 1.824, Test loss: 1.869, Test accuracy: 21.66
Round   5, Global train loss: 1.824, Global test loss: 2.342, Global test accuracy: 11.20
Round   6, Train loss: 1.914, Test loss: 1.857, Test accuracy: 25.04
Round   6, Global train loss: 1.914, Global test loss: 2.322, Global test accuracy: 15.00
Round   7, Train loss: 1.808, Test loss: 1.847, Test accuracy: 24.78
Round   7, Global train loss: 1.808, Global test loss: 2.308, Global test accuracy: 14.28
Round   8, Train loss: 1.891, Test loss: 1.841, Test accuracy: 25.52
Round   8, Global train loss: 1.891, Global test loss: 2.333, Global test accuracy: 18.66
Round   9, Train loss: 1.828, Test loss: 1.820, Test accuracy: 27.10
Round   9, Global train loss: 1.828, Global test loss: 2.478, Global test accuracy: 11.04
Round  10, Train loss: 1.794, Test loss: 1.781, Test accuracy: 27.80
Round  10, Global train loss: 1.794, Global test loss: 2.318, Global test accuracy: 10.00
Round  11, Train loss: 1.889, Test loss: 1.697, Test accuracy: 32.28
Round  11, Global train loss: 1.889, Global test loss: 2.281, Global test accuracy: 15.40
Round  12, Train loss: 1.772, Test loss: 1.677, Test accuracy: 34.00
Round  12, Global train loss: 1.772, Global test loss: 2.241, Global test accuracy: 13.20
Round  13, Train loss: 1.822, Test loss: 1.677, Test accuracy: 33.82
Round  13, Global train loss: 1.822, Global test loss: 2.358, Global test accuracy: 12.40
Round  14, Train loss: 1.866, Test loss: 1.668, Test accuracy: 34.24
Round  14, Global train loss: 1.866, Global test loss: 2.153, Global test accuracy: 29.30
Round  15, Train loss: 1.835, Test loss: 1.664, Test accuracy: 34.22
Round  15, Global train loss: 1.835, Global test loss: 2.417, Global test accuracy: 12.72
Round  16, Train loss: 1.645, Test loss: 1.662, Test accuracy: 35.14
Round  16, Global train loss: 1.645, Global test loss: 2.196, Global test accuracy: 19.38
Round  17, Train loss: 1.767, Test loss: 1.669, Test accuracy: 35.44
Round  17, Global train loss: 1.767, Global test loss: 2.218, Global test accuracy: 24.86
Round  18, Train loss: 1.526, Test loss: 1.668, Test accuracy: 35.36
Round  18, Global train loss: 1.526, Global test loss: 2.123, Global test accuracy: 25.90
Round  19, Train loss: 1.649, Test loss: 1.660, Test accuracy: 35.48
Round  19, Global train loss: 1.649, Global test loss: 2.159, Global test accuracy: 24.70
Round  20, Train loss: 1.563, Test loss: 1.645, Test accuracy: 36.58
Round  20, Global train loss: 1.563, Global test loss: 2.176, Global test accuracy: 20.00
Round  21, Train loss: 1.587, Test loss: 1.642, Test accuracy: 36.90
Round  21, Global train loss: 1.587, Global test loss: 2.231, Global test accuracy: 24.70
Round  22, Train loss: 1.637, Test loss: 1.654, Test accuracy: 36.04
Round  22, Global train loss: 1.637, Global test loss: 2.234, Global test accuracy: 19.70
Round  23, Train loss: 1.806, Test loss: 1.651, Test accuracy: 36.44
Round  23, Global train loss: 1.806, Global test loss: 2.314, Global test accuracy: 15.76
Round  24, Train loss: 1.798, Test loss: 1.630, Test accuracy: 35.98
Round  24, Global train loss: 1.798, Global test loss: 2.250, Global test accuracy: 19.74
Round  25, Train loss: 1.642, Test loss: 1.629, Test accuracy: 36.26
Round  25, Global train loss: 1.642, Global test loss: 2.325, Global test accuracy: 10.20
Round  26, Train loss: 1.442, Test loss: 1.608, Test accuracy: 37.04
Round  26, Global train loss: 1.442, Global test loss: 2.142, Global test accuracy: 22.86
Round  27, Train loss: 1.819, Test loss: 1.606, Test accuracy: 36.64
Round  27, Global train loss: 1.819, Global test loss: 2.271, Global test accuracy: 21.84
Round  28, Train loss: 1.385, Test loss: 1.613, Test accuracy: 35.54
Round  28, Global train loss: 1.385, Global test loss: 2.143, Global test accuracy: 21.46
Round  29, Train loss: 1.759, Test loss: 1.622, Test accuracy: 34.28
Round  29, Global train loss: 1.759, Global test loss: 2.336, Global test accuracy: 14.20
Round  30, Train loss: 1.668, Test loss: 1.636, Test accuracy: 34.54
Round  30, Global train loss: 1.668, Global test loss: 2.249, Global test accuracy: 21.00
Round  31, Train loss: 1.906, Test loss: 1.645, Test accuracy: 35.20
Round  31, Global train loss: 1.906, Global test loss: 2.289, Global test accuracy: 11.06
Round  32, Train loss: 1.422, Test loss: 1.641, Test accuracy: 35.76
Round  32, Global train loss: 1.422, Global test loss: 2.219, Global test accuracy: 27.76
Round  33, Train loss: 1.602, Test loss: 1.650, Test accuracy: 35.34
Round  33, Global train loss: 1.602, Global test loss: 2.314, Global test accuracy: 17.18
Round  34, Train loss: 1.537, Test loss: 1.635, Test accuracy: 35.40
Round  34, Global train loss: 1.537, Global test loss: 2.353, Global test accuracy: 18.66
Round  35, Train loss: 1.728, Test loss: 1.639, Test accuracy: 34.90
Round  35, Global train loss: 1.728, Global test loss: 2.236, Global test accuracy: 19.20
Round  36, Train loss: 1.505, Test loss: 1.631, Test accuracy: 35.30
Round  36, Global train loss: 1.505, Global test loss: 2.476, Global test accuracy: 15.80
Round  37, Train loss: 1.408, Test loss: 1.663, Test accuracy: 34.24
Round  37, Global train loss: 1.408, Global test loss: 2.147, Global test accuracy: 26.98
Round  38, Train loss: 1.288, Test loss: 1.670, Test accuracy: 34.72
Round  38, Global train loss: 1.288, Global test loss: 2.236, Global test accuracy: 25.06
Round  39, Train loss: 1.435, Test loss: 1.681, Test accuracy: 35.58
Round  39, Global train loss: 1.435, Global test loss: 2.341, Global test accuracy: 18.22
Round  40, Train loss: 1.422, Test loss: 1.695, Test accuracy: 35.16
Round  40, Global train loss: 1.422, Global test loss: 2.311, Global test accuracy: 13.36
Round  41, Train loss: 1.429, Test loss: 1.685, Test accuracy: 36.30
Round  41, Global train loss: 1.429, Global test loss: 2.326, Global test accuracy: 16.86
Round  42, Train loss: 1.215, Test loss: 1.701, Test accuracy: 35.52
Round  42, Global train loss: 1.215, Global test loss: 2.229, Global test accuracy: 22.94
Round  43, Train loss: 1.059, Test loss: 1.668, Test accuracy: 36.50
Round  43, Global train loss: 1.059, Global test loss: 2.140, Global test accuracy: 24.06
Round  44, Train loss: 1.741, Test loss: 1.683, Test accuracy: 35.04
Round  44, Global train loss: 1.741, Global test loss: 2.267, Global test accuracy: 15.14
Round  45, Train loss: 1.684, Test loss: 1.696, Test accuracy: 34.60
Round  45, Global train loss: 1.684, Global test loss: 2.372, Global test accuracy: 11.00
Round  46, Train loss: 1.723, Test loss: 1.682, Test accuracy: 35.04
Round  46, Global train loss: 1.723, Global test loss: 2.332, Global test accuracy: 17.46
Round  47, Train loss: 1.347, Test loss: 1.700, Test accuracy: 34.48
Round  47, Global train loss: 1.347, Global test loss: 2.220, Global test accuracy: 25.80
Round  48, Train loss: 1.666, Test loss: 1.724, Test accuracy: 34.52
Round  48, Global train loss: 1.666, Global test loss: 2.276, Global test accuracy: 13.12
Round  49, Train loss: 1.699, Test loss: 1.733, Test accuracy: 34.70
Round  49, Global train loss: 1.699, Global test loss: 2.192, Global test accuracy: 25.04
Round  50, Train loss: 0.962, Test loss: 1.747, Test accuracy: 34.78
Round  50, Global train loss: 0.962, Global test loss: 2.086, Global test accuracy: 28.42
Round  51, Train loss: 1.616, Test loss: 1.749, Test accuracy: 34.80
Round  51, Global train loss: 1.616, Global test loss: 2.285, Global test accuracy: 15.32
Round  52, Train loss: 1.555, Test loss: 1.780, Test accuracy: 33.58
Round  52, Global train loss: 1.555, Global test loss: 2.274, Global test accuracy: 20.36
Round  53, Train loss: 1.325, Test loss: 1.818, Test accuracy: 32.76
Round  53, Global train loss: 1.325, Global test loss: 2.202, Global test accuracy: 23.32
Round  54, Train loss: 1.540, Test loss: 1.811, Test accuracy: 32.80
Round  54, Global train loss: 1.540, Global test loss: 2.411, Global test accuracy: 9.88
Round  55, Train loss: 1.566, Test loss: 1.831, Test accuracy: 32.80
Round  55, Global train loss: 1.566, Global test loss: 2.350, Global test accuracy: 16.36
Round  56, Train loss: 1.239, Test loss: 1.870, Test accuracy: 33.06
Round  56, Global train loss: 1.239, Global test loss: 2.104, Global test accuracy: 30.22
Round  57, Train loss: 1.286, Test loss: 1.882, Test accuracy: 33.80
Round  57, Global train loss: 1.286, Global test loss: 2.307, Global test accuracy: 19.00
Round  58, Train loss: 1.220, Test loss: 1.932, Test accuracy: 32.76
Round  58, Global train loss: 1.220, Global test loss: 2.338, Global test accuracy: 23.22
Round  59, Train loss: 1.390, Test loss: 1.954, Test accuracy: 32.08
Round  59, Global train loss: 1.390, Global test loss: 2.335, Global test accuracy: 12.10
Round  60, Train loss: 1.465, Test loss: 1.997, Test accuracy: 31.44
Round  60, Global train loss: 1.465, Global test loss: 2.420, Global test accuracy: 11.60
Round  61, Train loss: 1.247, Test loss: 2.004, Test accuracy: 31.90
Round  61, Global train loss: 1.247, Global test loss: 2.341, Global test accuracy: 15.04
Round  62, Train loss: 0.786, Test loss: 2.035, Test accuracy: 30.68
Round  62, Global train loss: 0.786, Global test loss: 2.154, Global test accuracy: 22.72
Round  63, Train loss: 1.187, Test loss: 2.073, Test accuracy: 31.28
Round  63, Global train loss: 1.187, Global test loss: 2.347, Global test accuracy: 11.60
Round  64, Train loss: 0.899, Test loss: 2.092, Test accuracy: 31.46
Round  64, Global train loss: 0.899, Global test loss: 2.298, Global test accuracy: 15.62
Round  65, Train loss: 1.110, Test loss: 2.104, Test accuracy: 30.88
Round  65, Global train loss: 1.110, Global test loss: 2.242, Global test accuracy: 19.96
Round  66, Train loss: 1.274, Test loss: 2.144, Test accuracy: 30.82
Round  66, Global train loss: 1.274, Global test loss: 2.284, Global test accuracy: 17.68
Round  67, Train loss: 1.159, Test loss: 2.186, Test accuracy: 30.60
Round  67, Global train loss: 1.159, Global test loss: 2.429, Global test accuracy: 10.52
Round  68, Train loss: 0.718, Test loss: 2.202, Test accuracy: 30.64
Round  68, Global train loss: 0.718, Global test loss: 2.322, Global test accuracy: 20.02
Round  69, Train loss: 1.266, Test loss: 2.216, Test accuracy: 30.76
Round  69, Global train loss: 1.266, Global test loss: 2.356, Global test accuracy: 13.66
Round  70, Train loss: 1.220, Test loss: 2.236, Test accuracy: 30.60
Round  70, Global train loss: 1.220, Global test loss: 2.395, Global test accuracy: 10.18
Round  71, Train loss: 1.227, Test loss: 2.234, Test accuracy: 30.90
Round  71, Global train loss: 1.227, Global test loss: 2.364, Global test accuracy: 14.00
Round  72, Train loss: 1.137, Test loss: 2.259, Test accuracy: 30.64
Round  72, Global train loss: 1.137, Global test loss: 2.262, Global test accuracy: 19.30
Round  73, Train loss: 0.814, Test loss: 2.166, Test accuracy: 33.04
Round  73, Global train loss: 0.814, Global test loss: 2.133, Global test accuracy: 26.82
Round  74, Train loss: 1.127, Test loss: 2.166, Test accuracy: 33.12
Round  74, Global train loss: 1.127, Global test loss: 2.051, Global test accuracy: 30.30
Round  75, Train loss: 1.206, Test loss: 2.207, Test accuracy: 33.00
Round  75, Global train loss: 1.206, Global test loss: 2.247, Global test accuracy: 17.32
Round  76, Train loss: 1.024, Test loss: 2.226, Test accuracy: 32.96
Round  76, Global train loss: 1.024, Global test loss: 2.090, Global test accuracy: 27.70
Round  77, Train loss: 0.879, Test loss: 2.330, Test accuracy: 31.94
Round  77, Global train loss: 0.879, Global test loss: 2.406, Global test accuracy: 16.02
Round  78, Train loss: 0.819, Test loss: 2.361, Test accuracy: 32.50
Round  78, Global train loss: 0.819, Global test loss: 2.268, Global test accuracy: 23.30
Round  79, Train loss: 0.998, Test loss: 2.424, Test accuracy: 31.90
Round  79, Global train loss: 0.998, Global test loss: 2.360, Global test accuracy: 13.84
Round  80, Train loss: 0.805, Test loss: 2.447, Test accuracy: 31.72
Round  80, Global train loss: 0.805, Global test loss: 2.181, Global test accuracy: 24.86
Round  81, Train loss: 0.732, Test loss: 2.438, Test accuracy: 31.86
Round  81, Global train loss: 0.732, Global test loss: 2.062, Global test accuracy: 29.80
Round  82, Train loss: 1.002, Test loss: 2.496, Test accuracy: 31.92
Round  82, Global train loss: 1.002, Global test loss: 2.417, Global test accuracy: 9.30
Round  83, Train loss: 0.568, Test loss: 2.624, Test accuracy: 30.74
Round  83, Global train loss: 0.568, Global test loss: 2.039, Global test accuracy: 28.74
Round  84, Train loss: 0.889, Test loss: 2.651, Test accuracy: 31.22
Round  84, Global train loss: 0.889, Global test loss: 2.358, Global test accuracy: 13.00
Round  85, Train loss: 0.793, Test loss: 2.740, Test accuracy: 30.58
Round  85, Global train loss: 0.793, Global test loss: 2.135, Global test accuracy: 25.30
Round  86, Train loss: 0.392, Test loss: 2.636, Test accuracy: 32.24
Round  86, Global train loss: 0.392, Global test loss: 2.108, Global test accuracy: 24.66
Round  87, Train loss: 0.636, Test loss: 2.623, Test accuracy: 32.46
Round  87, Global train loss: 0.636, Global test loss: 2.349, Global test accuracy: 19.18
Round  88, Train loss: 0.529, Test loss: 2.771, Test accuracy: 32.48
Round  88, Global train loss: 0.529, Global test loss: 2.246, Global test accuracy: 21.42
Round  89, Train loss: 0.471, Test loss: 2.771, Test accuracy: 31.92
Round  89, Global train loss: 0.471, Global test loss: 2.057, Global test accuracy: 28.60
Round  90, Train loss: 0.544, Test loss: 2.808, Test accuracy: 32.74
Round  90, Global train loss: 0.544, Global test loss: 2.235, Global test accuracy: 20.60
Round  91, Train loss: 0.554, Test loss: 2.787, Test accuracy: 32.50
Round  91, Global train loss: 0.554, Global test loss: 2.108, Global test accuracy: 28.88
Round  92, Train loss: 0.858, Test loss: 2.861, Test accuracy: 31.90
Round  92, Global train loss: 0.858, Global test loss: 2.345, Global test accuracy: 14.54
Round  93, Train loss: 0.681, Test loss: 2.845, Test accuracy: 32.86
Round  93, Global train loss: 0.681, Global test loss: 2.264, Global test accuracy: 18.72
Round  94, Train loss: 0.810, Test loss: 2.892, Test accuracy: 31.76
Round  94, Global train loss: 0.810, Global test loss: 2.369, Global test accuracy: 20.50
Round  95, Train loss: 0.950, Test loss: 3.000, Test accuracy: 31.38
Round  95, Global train loss: 0.950, Global test loss: 2.328, Global test accuracy: 10.38
Round  96, Train loss: 0.600, Test loss: 2.993, Test accuracy: 30.66
Round  96, Global train loss: 0.600, Global test loss: 2.306, Global test accuracy: 18.98
Round  97, Train loss: 0.729, Test loss: 3.007, Test accuracy: 31.20
Round  97, Global train loss: 0.729, Global test loss: 2.329, Global test accuracy: 17.36
Round  98, Train loss: 0.657, Test loss: 3.080, Test accuracy: 31.22
Round  98, Global train loss: 0.657, Global test loss: 2.225, Global test accuracy: 20.48
Round  99, Train loss: 0.665, Test loss: 3.126, Test accuracy: 31.04
Round  99, Global train loss: 0.665, Global test loss: 2.384, Global test accuracy: 12.60
Final Round, Train loss: 0.577, Test loss: 3.511, Test accuracy: 30.52
Final Round, Global train loss: 0.577, Global test loss: 2.384, Global test accuracy: 12.60
Average accuracy final 10 rounds: 31.726 

Average global accuracy final 10 rounds: 18.304000000000006 

827.8129019737244
[1.645256519317627, 3.290513038635254, 4.557484149932861, 5.824455261230469, 7.15552544593811, 8.486595630645752, 9.727785587310791, 10.96897554397583, 12.20904541015625, 13.44911527633667, 14.725521564483643, 16.001927852630615, 17.24194574356079, 18.481963634490967, 19.715195417404175, 20.948427200317383, 22.160062074661255, 23.371696949005127, 24.649673461914062, 25.927649974822998, 27.16523766517639, 28.402825355529785, 29.668500185012817, 30.93417501449585, 32.186739921569824, 33.4393048286438, 34.5619854927063, 35.6846661567688, 36.82452034950256, 37.96437454223633, 39.13423538208008, 40.30409622192383, 41.47707271575928, 42.65004920959473, 43.82108688354492, 44.99212455749512, 46.17348623275757, 47.35484790802002, 48.622398853302, 49.889949798583984, 51.14002561569214, 52.39010143280029, 53.601330518722534, 54.812559604644775, 56.029974699020386, 57.247389793395996, 58.457329988479614, 59.66727018356323, 60.878602266311646, 62.08993434906006, 63.290738344192505, 64.49154233932495, 65.74706721305847, 67.00259208679199, 68.25436329841614, 69.50613451004028, 70.73630809783936, 71.96648168563843, 73.17719650268555, 74.38791131973267, 75.63364148139954, 76.8793716430664, 78.11654710769653, 79.35372257232666, 80.61322855949402, 81.87273454666138, 83.10736775398254, 84.34200096130371, 85.60062050819397, 86.85924005508423, 88.10115480422974, 89.34306955337524, 90.58921766281128, 91.83536577224731, 93.07118129730225, 94.30699682235718, 95.52417516708374, 96.7413535118103, 97.98818111419678, 99.23500871658325, 100.50090837478638, 101.7668080329895, 102.99506306648254, 104.22331809997559, 105.51022338867188, 106.79712867736816, 108.1171395778656, 109.43715047836304, 110.67998933792114, 111.92282819747925, 113.16549730300903, 114.40816640853882, 115.64524793624878, 116.88232946395874, 118.14476251602173, 119.40719556808472, 120.66361737251282, 121.92003917694092, 123.15400838851929, 124.38797760009766, 125.60868334770203, 126.8293890953064, 128.04886651039124, 129.26834392547607, 130.53671097755432, 131.80507802963257, 133.05501914024353, 134.3049602508545, 135.58717274665833, 136.86938524246216, 138.12346863746643, 139.3775520324707, 140.6273488998413, 141.8771457672119, 143.11619091033936, 144.3552360534668, 145.58349514007568, 146.81175422668457, 148.0742425918579, 149.33673095703125, 150.57799410820007, 151.8192572593689, 153.05124258995056, 154.28322792053223, 155.54528260231018, 156.80733728408813, 158.0339584350586, 159.26057958602905, 160.49677729606628, 161.73297500610352, 163.01114201545715, 164.2893090248108, 165.5597264766693, 166.83014392852783, 168.09783697128296, 169.3655300140381, 170.59162831306458, 171.81772661209106, 173.08389902114868, 174.3500714302063, 175.4822998046875, 176.6145281791687, 177.7326419353485, 178.85075569152832, 180.02833676338196, 181.2059178352356, 182.44153499603271, 183.67715215682983, 184.932959318161, 186.1887664794922, 187.33715915679932, 188.48555183410645, 189.75712060928345, 191.02868938446045, 192.30490636825562, 193.58112335205078, 194.85481095314026, 196.12849855422974, 197.32775354385376, 198.52700853347778, 199.74493789672852, 200.96286725997925, 202.212393283844, 203.46191930770874, 204.70783162117004, 205.95374393463135, 207.20040488243103, 208.4470658302307, 209.68146872520447, 210.91587162017822, 212.16972136497498, 213.42357110977173, 214.62881994247437, 215.834068775177, 217.04340648651123, 218.25274419784546, 219.51020550727844, 220.76766681671143, 222.0192892551422, 223.270911693573, 224.51759004592896, 225.7642683982849, 226.97758960723877, 228.19091081619263, 229.4464464187622, 230.7019820213318, 231.99200820922852, 233.28203439712524, 234.50295114517212, 235.723867893219, 236.9762144088745, 238.22856092453003, 239.4753942489624, 240.72222757339478, 241.94723105430603, 243.17223453521729, 244.40916085243225, 245.64608716964722, 246.86325430870056, 248.0804214477539, 250.58363723754883, 253.08685302734375]
[13.34, 13.34, 17.9, 17.9, 17.94, 17.94, 22.48, 22.48, 21.2, 21.2, 21.66, 21.66, 25.04, 25.04, 24.78, 24.78, 25.52, 25.52, 27.1, 27.1, 27.8, 27.8, 32.28, 32.28, 34.0, 34.0, 33.82, 33.82, 34.24, 34.24, 34.22, 34.22, 35.14, 35.14, 35.44, 35.44, 35.36, 35.36, 35.48, 35.48, 36.58, 36.58, 36.9, 36.9, 36.04, 36.04, 36.44, 36.44, 35.98, 35.98, 36.26, 36.26, 37.04, 37.04, 36.64, 36.64, 35.54, 35.54, 34.28, 34.28, 34.54, 34.54, 35.2, 35.2, 35.76, 35.76, 35.34, 35.34, 35.4, 35.4, 34.9, 34.9, 35.3, 35.3, 34.24, 34.24, 34.72, 34.72, 35.58, 35.58, 35.16, 35.16, 36.3, 36.3, 35.52, 35.52, 36.5, 36.5, 35.04, 35.04, 34.6, 34.6, 35.04, 35.04, 34.48, 34.48, 34.52, 34.52, 34.7, 34.7, 34.78, 34.78, 34.8, 34.8, 33.58, 33.58, 32.76, 32.76, 32.8, 32.8, 32.8, 32.8, 33.06, 33.06, 33.8, 33.8, 32.76, 32.76, 32.08, 32.08, 31.44, 31.44, 31.9, 31.9, 30.68, 30.68, 31.28, 31.28, 31.46, 31.46, 30.88, 30.88, 30.82, 30.82, 30.6, 30.6, 30.64, 30.64, 30.76, 30.76, 30.6, 30.6, 30.9, 30.9, 30.64, 30.64, 33.04, 33.04, 33.12, 33.12, 33.0, 33.0, 32.96, 32.96, 31.94, 31.94, 32.5, 32.5, 31.9, 31.9, 31.72, 31.72, 31.86, 31.86, 31.92, 31.92, 30.74, 30.74, 31.22, 31.22, 30.58, 30.58, 32.24, 32.24, 32.46, 32.46, 32.48, 32.48, 31.92, 31.92, 32.74, 32.74, 32.5, 32.5, 31.9, 31.9, 32.86, 32.86, 31.76, 31.76, 31.38, 31.38, 30.66, 30.66, 31.2, 31.2, 31.22, 31.22, 31.04, 31.04, 30.52, 30.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.013, Test loss: 2.199, Test accuracy: 14.34
Round   0, Global train loss: 2.013, Global test loss: 2.317, Global test accuracy: 15.50
Round   1, Train loss: 1.973, Test loss: 2.003, Test accuracy: 18.60
Round   1, Global train loss: 1.973, Global test loss: 2.292, Global test accuracy: 12.00
Round   2, Train loss: 1.865, Test loss: 2.001, Test accuracy: 20.86
Round   2, Global train loss: 1.865, Global test loss: 2.270, Global test accuracy: 21.66
Round   3, Train loss: 2.055, Test loss: 1.892, Test accuracy: 26.52
Round   3, Global train loss: 2.055, Global test loss: 2.294, Global test accuracy: 16.16
Round   4, Train loss: 1.847, Test loss: 1.887, Test accuracy: 26.08
Round   4, Global train loss: 1.847, Global test loss: 2.250, Global test accuracy: 15.60
Round   5, Train loss: 1.826, Test loss: 1.861, Test accuracy: 26.20
Round   5, Global train loss: 1.826, Global test loss: 2.208, Global test accuracy: 12.54
Round   6, Train loss: 2.068, Test loss: 1.861, Test accuracy: 28.08
Round   6, Global train loss: 2.068, Global test loss: 2.260, Global test accuracy: 14.32
Round   7, Train loss: 1.908, Test loss: 1.861, Test accuracy: 28.12
Round   7, Global train loss: 1.908, Global test loss: 2.238, Global test accuracy: 13.90
Round   8, Train loss: 1.896, Test loss: 1.834, Test accuracy: 28.88
Round   8, Global train loss: 1.896, Global test loss: 2.193, Global test accuracy: 17.48
Round   9, Train loss: 1.855, Test loss: 1.806, Test accuracy: 30.30
Round   9, Global train loss: 1.855, Global test loss: 2.245, Global test accuracy: 20.32
Round  10, Train loss: 2.002, Test loss: 1.797, Test accuracy: 30.66
Round  10, Global train loss: 2.002, Global test loss: 2.271, Global test accuracy: 16.74
Round  11, Train loss: 1.915, Test loss: 1.718, Test accuracy: 33.00
Round  11, Global train loss: 1.915, Global test loss: 2.239, Global test accuracy: 17.14
Round  12, Train loss: 1.878, Test loss: 1.714, Test accuracy: 32.24
Round  12, Global train loss: 1.878, Global test loss: 2.321, Global test accuracy: 18.90
Round  13, Train loss: 1.951, Test loss: 1.704, Test accuracy: 33.40
Round  13, Global train loss: 1.951, Global test loss: 2.236, Global test accuracy: 20.44
Round  14, Train loss: 1.847, Test loss: 1.678, Test accuracy: 35.62
Round  14, Global train loss: 1.847, Global test loss: 2.126, Global test accuracy: 29.00
Round  15, Train loss: 1.984, Test loss: 1.675, Test accuracy: 36.18
Round  15, Global train loss: 1.984, Global test loss: 2.269, Global test accuracy: 23.92
Round  16, Train loss: 1.917, Test loss: 1.668, Test accuracy: 36.52
Round  16, Global train loss: 1.917, Global test loss: 2.206, Global test accuracy: 21.80
Round  17, Train loss: 1.925, Test loss: 1.662, Test accuracy: 36.56
Round  17, Global train loss: 1.925, Global test loss: 2.092, Global test accuracy: 26.28
Round  18, Train loss: 1.844, Test loss: 1.665, Test accuracy: 37.10
Round  18, Global train loss: 1.844, Global test loss: 2.147, Global test accuracy: 25.16
Round  19, Train loss: 1.779, Test loss: 1.663, Test accuracy: 36.90
Round  19, Global train loss: 1.779, Global test loss: 2.303, Global test accuracy: 24.20
Round  20, Train loss: 1.816, Test loss: 1.660, Test accuracy: 38.20
Round  20, Global train loss: 1.816, Global test loss: 2.203, Global test accuracy: 20.20
Round  21, Train loss: 1.861, Test loss: 1.656, Test accuracy: 36.70
Round  21, Global train loss: 1.861, Global test loss: 2.105, Global test accuracy: 26.30
Round  22, Train loss: 1.818, Test loss: 1.662, Test accuracy: 37.56
Round  22, Global train loss: 1.818, Global test loss: 2.328, Global test accuracy: 25.26
Round  23, Train loss: 1.953, Test loss: 1.659, Test accuracy: 36.50
Round  23, Global train loss: 1.953, Global test loss: 2.170, Global test accuracy: 31.94
Round  24, Train loss: 1.829, Test loss: 1.656, Test accuracy: 36.64
Round  24, Global train loss: 1.829, Global test loss: 2.130, Global test accuracy: 27.66
Round  25, Train loss: 1.765, Test loss: 1.651, Test accuracy: 37.00
Round  25, Global train loss: 1.765, Global test loss: 2.080, Global test accuracy: 21.88
Round  26, Train loss: 1.876, Test loss: 1.658, Test accuracy: 38.60
Round  26, Global train loss: 1.876, Global test loss: 2.135, Global test accuracy: 26.46
Round  27, Train loss: 1.850, Test loss: 1.655, Test accuracy: 38.90
Round  27, Global train loss: 1.850, Global test loss: 2.039, Global test accuracy: 30.88
Round  28, Train loss: 1.838, Test loss: 1.653, Test accuracy: 39.22
Round  28, Global train loss: 1.838, Global test loss: 2.115, Global test accuracy: 27.08
Round  29, Train loss: 1.782, Test loss: 1.647, Test accuracy: 39.46
Round  29, Global train loss: 1.782, Global test loss: 2.083, Global test accuracy: 26.26
Round  30, Train loss: 1.828, Test loss: 1.645, Test accuracy: 38.42
Round  30, Global train loss: 1.828, Global test loss: 2.033, Global test accuracy: 30.12
Round  31, Train loss: 1.838, Test loss: 1.628, Test accuracy: 37.82
Round  31, Global train loss: 1.838, Global test loss: 2.073, Global test accuracy: 29.42
Round  32, Train loss: 1.784, Test loss: 1.610, Test accuracy: 38.68
Round  32, Global train loss: 1.784, Global test loss: 2.167, Global test accuracy: 28.46
Round  33, Train loss: 1.744, Test loss: 1.610, Test accuracy: 39.02
Round  33, Global train loss: 1.744, Global test loss: 2.078, Global test accuracy: 27.44
Round  34, Train loss: 1.801, Test loss: 1.619, Test accuracy: 38.10
Round  34, Global train loss: 1.801, Global test loss: 2.123, Global test accuracy: 27.70
Round  35, Train loss: 1.760, Test loss: 1.644, Test accuracy: 36.74
Round  35, Global train loss: 1.760, Global test loss: 2.050, Global test accuracy: 25.42
Round  36, Train loss: 1.840, Test loss: 1.663, Test accuracy: 35.52
Round  36, Global train loss: 1.840, Global test loss: 2.293, Global test accuracy: 19.92
Round  37, Train loss: 1.690, Test loss: 1.659, Test accuracy: 37.18
Round  37, Global train loss: 1.690, Global test loss: 2.065, Global test accuracy: 28.90
Round  38, Train loss: 1.716, Test loss: 1.620, Test accuracy: 37.86
Round  38, Global train loss: 1.716, Global test loss: 2.045, Global test accuracy: 29.32
Round  39, Train loss: 1.746, Test loss: 1.605, Test accuracy: 38.42
Round  39, Global train loss: 1.746, Global test loss: 2.172, Global test accuracy: 26.16
Round  40, Train loss: 1.715, Test loss: 1.639, Test accuracy: 37.16
Round  40, Global train loss: 1.715, Global test loss: 2.136, Global test accuracy: 21.48
Round  41, Train loss: 1.639, Test loss: 1.677, Test accuracy: 35.70
Round  41, Global train loss: 1.639, Global test loss: 2.068, Global test accuracy: 25.68
Round  42, Train loss: 1.668, Test loss: 1.671, Test accuracy: 35.56
Round  42, Global train loss: 1.668, Global test loss: 2.106, Global test accuracy: 22.32
Round  43, Train loss: 1.704, Test loss: 1.687, Test accuracy: 34.54
Round  43, Global train loss: 1.704, Global test loss: 2.189, Global test accuracy: 23.22
Round  44, Train loss: 1.673, Test loss: 1.683, Test accuracy: 35.22
Round  44, Global train loss: 1.673, Global test loss: 2.108, Global test accuracy: 27.64
Round  45, Train loss: 1.652, Test loss: 1.690, Test accuracy: 35.84
Round  45, Global train loss: 1.652, Global test loss: 2.354, Global test accuracy: 19.16
Round  46, Train loss: 1.600, Test loss: 1.675, Test accuracy: 35.52
Round  46, Global train loss: 1.600, Global test loss: 2.207, Global test accuracy: 26.56
Round  47, Train loss: 1.559, Test loss: 1.684, Test accuracy: 35.06
Round  47, Global train loss: 1.559, Global test loss: 2.419, Global test accuracy: 20.88
Round  48, Train loss: 1.572, Test loss: 1.692, Test accuracy: 35.74
Round  48, Global train loss: 1.572, Global test loss: 2.144, Global test accuracy: 27.16
Round  49, Train loss: 1.527, Test loss: 1.694, Test accuracy: 35.58
Round  49, Global train loss: 1.527, Global test loss: 2.006, Global test accuracy: 32.76
Round  50, Train loss: 1.561, Test loss: 1.708, Test accuracy: 36.48
Round  50, Global train loss: 1.561, Global test loss: 2.149, Global test accuracy: 27.88
Round  51, Train loss: 1.540, Test loss: 1.734, Test accuracy: 37.06
Round  51, Global train loss: 1.540, Global test loss: 2.151, Global test accuracy: 25.32
Round  52, Train loss: 1.515, Test loss: 1.789, Test accuracy: 36.06
Round  52, Global train loss: 1.515, Global test loss: 2.109, Global test accuracy: 28.24
Round  53, Train loss: 1.505, Test loss: 1.801, Test accuracy: 34.10
Round  53, Global train loss: 1.505, Global test loss: 2.134, Global test accuracy: 29.24
Round  54, Train loss: 1.536, Test loss: 1.805, Test accuracy: 34.22
Round  54, Global train loss: 1.536, Global test loss: 2.359, Global test accuracy: 21.78
Round  55, Train loss: 1.348, Test loss: 1.852, Test accuracy: 34.20
Round  55, Global train loss: 1.348, Global test loss: 2.406, Global test accuracy: 24.82
Round  56, Train loss: 1.372, Test loss: 1.847, Test accuracy: 34.24
Round  56, Global train loss: 1.372, Global test loss: 2.377, Global test accuracy: 25.20
Round  57, Train loss: 1.366, Test loss: 1.837, Test accuracy: 34.50
Round  57, Global train loss: 1.366, Global test loss: 2.306, Global test accuracy: 23.94
Round  58, Train loss: 1.405, Test loss: 1.854, Test accuracy: 34.66
Round  58, Global train loss: 1.405, Global test loss: 2.156, Global test accuracy: 30.86
Round  59, Train loss: 1.442, Test loss: 1.875, Test accuracy: 34.60
Round  59, Global train loss: 1.442, Global test loss: 2.284, Global test accuracy: 25.66
Round  60, Train loss: 1.357, Test loss: 1.900, Test accuracy: 33.62
Round  60, Global train loss: 1.357, Global test loss: 2.485, Global test accuracy: 21.18
Round  61, Train loss: 1.280, Test loss: 1.893, Test accuracy: 34.26
Round  61, Global train loss: 1.280, Global test loss: 2.543, Global test accuracy: 22.10
Round  62, Train loss: 1.400, Test loss: 1.971, Test accuracy: 32.80
Round  62, Global train loss: 1.400, Global test loss: 2.434, Global test accuracy: 20.94
Round  63, Train loss: 1.311, Test loss: 2.058, Test accuracy: 31.32
Round  63, Global train loss: 1.311, Global test loss: 2.552, Global test accuracy: 21.12
Round  64, Train loss: 1.254, Test loss: 2.032, Test accuracy: 31.82
Round  64, Global train loss: 1.254, Global test loss: 2.657, Global test accuracy: 18.50
Round  65, Train loss: 1.213, Test loss: 2.176, Test accuracy: 30.70
Round  65, Global train loss: 1.213, Global test loss: 2.575, Global test accuracy: 22.14
Round  66, Train loss: 1.149, Test loss: 2.196, Test accuracy: 31.50
Round  66, Global train loss: 1.149, Global test loss: 2.593, Global test accuracy: 23.24
Round  67, Train loss: 1.144, Test loss: 2.220, Test accuracy: 31.68
Round  67, Global train loss: 1.144, Global test loss: 2.875, Global test accuracy: 18.80
Round  68, Train loss: 1.204, Test loss: 2.223, Test accuracy: 32.16
Round  68, Global train loss: 1.204, Global test loss: 2.736, Global test accuracy: 19.58
Round  69, Train loss: 1.380, Test loss: 2.262, Test accuracy: 31.50
Round  69, Global train loss: 1.380, Global test loss: 2.451, Global test accuracy: 24.84
Round  70, Train loss: 1.060, Test loss: 2.270, Test accuracy: 30.92
Round  70, Global train loss: 1.060, Global test loss: 2.938, Global test accuracy: 18.24
Round  71, Train loss: 1.311, Test loss: 2.275, Test accuracy: 31.02
Round  71, Global train loss: 1.311, Global test loss: 2.520, Global test accuracy: 24.84
Round  72, Train loss: 0.993, Test loss: 2.266, Test accuracy: 31.82
Round  72, Global train loss: 0.993, Global test loss: 2.650, Global test accuracy: 25.66
Round  73, Train loss: 1.142, Test loss: 2.288, Test accuracy: 32.94
Round  73, Global train loss: 1.142, Global test loss: 2.828, Global test accuracy: 21.82
Round  74, Train loss: 1.065, Test loss: 2.238, Test accuracy: 33.20
Round  74, Global train loss: 1.065, Global test loss: 2.485, Global test accuracy: 30.38
Round  75, Train loss: 1.087, Test loss: 2.288, Test accuracy: 33.08
Round  75, Global train loss: 1.087, Global test loss: 2.503, Global test accuracy: 28.22
Round  76, Train loss: 1.003, Test loss: 2.353, Test accuracy: 32.88
Round  76, Global train loss: 1.003, Global test loss: 2.809, Global test accuracy: 24.94
Round  77, Train loss: 1.016, Test loss: 2.448, Test accuracy: 30.96
Round  77, Global train loss: 1.016, Global test loss: 2.848, Global test accuracy: 21.92
Round  78, Train loss: 1.182, Test loss: 2.484, Test accuracy: 31.34
Round  78, Global train loss: 1.182, Global test loss: 2.675, Global test accuracy: 21.86
Round  79, Train loss: 0.771, Test loss: 2.550, Test accuracy: 31.44
Round  79, Global train loss: 0.771, Global test loss: 2.982, Global test accuracy: 24.16
Round  80, Train loss: 1.006, Test loss: 2.596, Test accuracy: 31.36
Round  80, Global train loss: 1.006, Global test loss: 2.876, Global test accuracy: 27.72
Round  81, Train loss: 0.810, Test loss: 2.616, Test accuracy: 31.44
Round  81, Global train loss: 0.810, Global test loss: 2.867, Global test accuracy: 28.08
Round  82, Train loss: 0.890, Test loss: 2.574, Test accuracy: 31.10
Round  82, Global train loss: 0.890, Global test loss: 3.301, Global test accuracy: 20.46
Round  83, Train loss: 0.913, Test loss: 2.649, Test accuracy: 30.26
Round  83, Global train loss: 0.913, Global test loss: 2.829, Global test accuracy: 23.36
Round  84, Train loss: 0.749, Test loss: 2.673, Test accuracy: 30.76
Round  84, Global train loss: 0.749, Global test loss: 3.186, Global test accuracy: 24.10
Round  85, Train loss: 0.893, Test loss: 2.653, Test accuracy: 32.56
Round  85, Global train loss: 0.893, Global test loss: 2.971, Global test accuracy: 25.84
Round  86, Train loss: 0.889, Test loss: 2.733, Test accuracy: 31.76
Round  86, Global train loss: 0.889, Global test loss: 3.023, Global test accuracy: 20.82
Round  87, Train loss: 0.900, Test loss: 2.832, Test accuracy: 30.66
Round  87, Global train loss: 0.900, Global test loss: 3.036, Global test accuracy: 24.98
Round  88, Train loss: 0.803, Test loss: 2.783, Test accuracy: 31.60
Round  88, Global train loss: 0.803, Global test loss: 2.937, Global test accuracy: 26.18
Round  89, Train loss: 0.731, Test loss: 2.800, Test accuracy: 31.24
Round  89, Global train loss: 0.731, Global test loss: 2.962, Global test accuracy: 26.02
Round  90, Train loss: 0.727, Test loss: 2.905, Test accuracy: 30.78
Round  90, Global train loss: 0.727, Global test loss: 3.180, Global test accuracy: 24.10
Round  91, Train loss: 0.658, Test loss: 2.890, Test accuracy: 31.28
Round  91, Global train loss: 0.658, Global test loss: 3.443, Global test accuracy: 21.80
Round  92, Train loss: 0.778, Test loss: 2.966, Test accuracy: 31.14
Round  92, Global train loss: 0.778, Global test loss: 3.163, Global test accuracy: 26.00
Round  93, Train loss: 0.720, Test loss: 2.959, Test accuracy: 30.82
Round  93, Global train loss: 0.720, Global test loss: 3.108, Global test accuracy: 23.64
Round  94, Train loss: 0.989, Test loss: 2.917, Test accuracy: 31.40
Round  94, Global train loss: 0.989, Global test loss: 3.185, Global test accuracy: 20.68
Round  95, Train loss: 1.014, Test loss: 2.833, Test accuracy: 32.18
Round  95, Global train loss: 1.014, Global test loss: 2.784, Global test accuracy: 22.82
Round  96, Train loss: 0.647, Test loss: 2.953, Test accuracy: 31.90
Round  96, Global train loss: 0.647, Global test loss: 3.317, Global test accuracy: 25.56
Round  97, Train loss: 0.876, Test loss: 3.058, Test accuracy: 31.36
Round  97, Global train loss: 0.876, Global test loss: 3.347, Global test accuracy: 20.50
Round  98, Train loss: 0.573, Test loss: 3.144, Test accuracy: 30.86
Round  98, Global train loss: 0.573, Global test loss: 3.254, Global test accuracy: 26.98
Round  99, Train loss: 0.593, Test loss: 3.141, Test accuracy: 30.98
Round  99, Global train loss: 0.593, Global test loss: 3.460, Global test accuracy: 24.98
Final Round, Train loss: 0.620, Test loss: 3.279, Test accuracy: 32.28
Final Round, Global train loss: 0.620, Global test loss: 3.460, Global test accuracy: 24.98
Average accuracy final 10 rounds: 31.27 

Average global accuracy final 10 rounds: 23.706 

819.5391082763672
[1.4179704189300537, 2.8359408378601074, 4.054781913757324, 5.273622989654541, 6.47021222114563, 7.666801452636719, 8.936859369277954, 10.20691728591919, 11.40174150466919, 12.59656572341919, 13.771151781082153, 14.945737838745117, 16.195523738861084, 17.44530963897705, 18.65644097328186, 19.86757230758667, 21.083038806915283, 22.298505306243896, 23.455169677734375, 24.611834049224854, 25.772523641586304, 26.933213233947754, 28.149362087249756, 29.365510940551758, 30.533788442611694, 31.70206594467163, 32.88936996459961, 34.07667398452759, 35.313254594802856, 36.549835205078125, 37.73134422302246, 38.9128532409668, 40.11101937294006, 41.30918550491333, 42.46457123756409, 43.619956970214844, 44.83251976966858, 46.045082569122314, 47.280895948410034, 48.516709327697754, 49.69495630264282, 50.87320327758789, 52.04456949234009, 53.215935707092285, 54.479347944259644, 55.742760181427, 56.91291832923889, 58.08307647705078, 59.26769685745239, 60.452317237854004, 61.67445731163025, 62.896597385406494, 64.11882281303406, 65.34104824066162, 66.46674156188965, 67.59243488311768, 68.80989837646484, 70.02736186981201, 71.2048089504242, 72.38225603103638, 73.59643244743347, 74.81060886383057, 75.95346450805664, 77.09632015228271, 78.24746990203857, 79.39861965179443, 80.61043739318848, 81.82225513458252, 82.98378658294678, 84.14531803131104, 85.30604314804077, 86.46676826477051, 87.66160035133362, 88.85643243789673, 90.04306817054749, 91.22970390319824, 92.41385555267334, 93.59800720214844, 94.81435203552246, 96.03069686889648, 97.19450879096985, 98.35832071304321, 99.53151679039001, 100.70471286773682, 101.90324211120605, 103.1017713546753, 104.34033131599426, 105.57889127731323, 106.7359311580658, 107.89297103881836, 109.07323265075684, 110.25349426269531, 111.45227980613708, 112.65106534957886, 113.97789072990417, 115.30471611022949, 116.49801564216614, 117.69131517410278, 118.92226433753967, 120.15321350097656, 121.37593841552734, 122.59866333007812, 123.84128928184509, 125.08391523361206, 126.26428508758545, 127.44465494155884, 128.6430311203003, 129.84140729904175, 131.03224754333496, 132.22308778762817, 133.5700340270996, 134.91698026657104, 136.30111813545227, 137.6852560043335, 139.04742693901062, 140.40959787368774, 141.74391198158264, 143.07822608947754, 144.39528799057007, 145.7123498916626, 147.0770447254181, 148.44173955917358, 149.8088104724884, 151.17588138580322, 152.51121020317078, 153.84653902053833, 155.17786359786987, 156.50918817520142, 157.91545915603638, 159.32173013687134, 160.75767540931702, 162.1936206817627, 163.54283380508423, 164.89204692840576, 166.1855435371399, 167.47904014587402, 168.7340223789215, 169.989004611969, 171.2755753993988, 172.5621461868286, 173.84287905693054, 175.12361192703247, 176.36405539512634, 177.60449886322021, 178.88066267967224, 180.15682649612427, 181.5064413547516, 182.8560562133789, 184.14215660095215, 185.4282569885254, 186.67109847068787, 187.91393995285034, 189.19300055503845, 190.47206115722656, 191.7283444404602, 192.98462772369385, 194.272381067276, 195.56013441085815, 196.84797072410583, 198.13580703735352, 199.3185167312622, 200.5012264251709, 201.74651074409485, 202.9917950630188, 204.17094588279724, 205.35009670257568, 206.50809907913208, 207.66610145568848, 208.88858699798584, 210.1110725402832, 211.36260962486267, 212.61414670944214, 213.8501591682434, 215.08617162704468, 216.44730925559998, 217.80844688415527, 219.1124782562256, 220.4165096282959, 221.70052313804626, 222.98453664779663, 224.3033037185669, 225.62207078933716, 226.87321519851685, 228.12435960769653, 229.41080117225647, 230.6972427368164, 231.9663233757019, 233.2354040145874, 234.48376274108887, 235.73212146759033, 237.01250076293945, 238.29288005828857, 239.60281014442444, 240.9127402305603, 242.1539101600647, 243.3950800895691, 244.66820740699768, 245.94133472442627, 247.23123025894165, 248.52112579345703, 251.07980942726135, 253.63849306106567]
[14.34, 14.34, 18.6, 18.6, 20.86, 20.86, 26.52, 26.52, 26.08, 26.08, 26.2, 26.2, 28.08, 28.08, 28.12, 28.12, 28.88, 28.88, 30.3, 30.3, 30.66, 30.66, 33.0, 33.0, 32.24, 32.24, 33.4, 33.4, 35.62, 35.62, 36.18, 36.18, 36.52, 36.52, 36.56, 36.56, 37.1, 37.1, 36.9, 36.9, 38.2, 38.2, 36.7, 36.7, 37.56, 37.56, 36.5, 36.5, 36.64, 36.64, 37.0, 37.0, 38.6, 38.6, 38.9, 38.9, 39.22, 39.22, 39.46, 39.46, 38.42, 38.42, 37.82, 37.82, 38.68, 38.68, 39.02, 39.02, 38.1, 38.1, 36.74, 36.74, 35.52, 35.52, 37.18, 37.18, 37.86, 37.86, 38.42, 38.42, 37.16, 37.16, 35.7, 35.7, 35.56, 35.56, 34.54, 34.54, 35.22, 35.22, 35.84, 35.84, 35.52, 35.52, 35.06, 35.06, 35.74, 35.74, 35.58, 35.58, 36.48, 36.48, 37.06, 37.06, 36.06, 36.06, 34.1, 34.1, 34.22, 34.22, 34.2, 34.2, 34.24, 34.24, 34.5, 34.5, 34.66, 34.66, 34.6, 34.6, 33.62, 33.62, 34.26, 34.26, 32.8, 32.8, 31.32, 31.32, 31.82, 31.82, 30.7, 30.7, 31.5, 31.5, 31.68, 31.68, 32.16, 32.16, 31.5, 31.5, 30.92, 30.92, 31.02, 31.02, 31.82, 31.82, 32.94, 32.94, 33.2, 33.2, 33.08, 33.08, 32.88, 32.88, 30.96, 30.96, 31.34, 31.34, 31.44, 31.44, 31.36, 31.36, 31.44, 31.44, 31.1, 31.1, 30.26, 30.26, 30.76, 30.76, 32.56, 32.56, 31.76, 31.76, 30.66, 30.66, 31.6, 31.6, 31.24, 31.24, 30.78, 30.78, 31.28, 31.28, 31.14, 31.14, 30.82, 30.82, 31.4, 31.4, 32.18, 32.18, 31.9, 31.9, 31.36, 31.36, 30.86, 30.86, 30.98, 30.98, 32.28, 32.28]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
prox
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.131, Test loss: 2.270, Test accuracy: 10.82
Round   0, Global train loss: 2.131, Global test loss: 2.356, Global test accuracy: 10.90
Round   1, Train loss: 1.891, Test loss: 2.025, Test accuracy: 22.22
Round   1, Global train loss: 1.891, Global test loss: 2.259, Global test accuracy: 21.52
Round   2, Train loss: 1.865, Test loss: 2.043, Test accuracy: 21.88
Round   2, Global train loss: 1.865, Global test loss: 2.258, Global test accuracy: 21.68
Round   3, Train loss: 1.958, Test loss: 1.894, Test accuracy: 26.36
Round   3, Global train loss: 1.958, Global test loss: 2.219, Global test accuracy: 19.58
Round   4, Train loss: 1.938, Test loss: 1.905, Test accuracy: 27.84
Round   4, Global train loss: 1.938, Global test loss: 2.231, Global test accuracy: 24.38
Round   5, Train loss: 1.911, Test loss: 1.876, Test accuracy: 27.08
Round   5, Global train loss: 1.911, Global test loss: 2.250, Global test accuracy: 17.02
Round   6, Train loss: 2.009, Test loss: 1.816, Test accuracy: 31.64
Round   6, Global train loss: 2.009, Global test loss: 2.085, Global test accuracy: 30.36
Round   7, Train loss: 1.776, Test loss: 1.807, Test accuracy: 32.86
Round   7, Global train loss: 1.776, Global test loss: 2.085, Global test accuracy: 27.22
Round   8, Train loss: 1.877, Test loss: 1.803, Test accuracy: 31.44
Round   8, Global train loss: 1.877, Global test loss: 2.199, Global test accuracy: 20.94
Round   9, Train loss: 1.836, Test loss: 1.808, Test accuracy: 30.08
Round   9, Global train loss: 1.836, Global test loss: 2.392, Global test accuracy: 12.70
Round  10, Train loss: 1.779, Test loss: 1.780, Test accuracy: 32.10
Round  10, Global train loss: 1.779, Global test loss: 2.200, Global test accuracy: 21.90
Round  11, Train loss: 2.021, Test loss: 1.709, Test accuracy: 34.04
Round  11, Global train loss: 2.021, Global test loss: 2.145, Global test accuracy: 24.32
Round  12, Train loss: 1.872, Test loss: 1.712, Test accuracy: 33.26
Round  12, Global train loss: 1.872, Global test loss: 2.134, Global test accuracy: 24.10
Round  13, Train loss: 1.842, Test loss: 1.714, Test accuracy: 33.96
Round  13, Global train loss: 1.842, Global test loss: 2.007, Global test accuracy: 30.70
Round  14, Train loss: 1.926, Test loss: 1.705, Test accuracy: 36.14
Round  14, Global train loss: 1.926, Global test loss: 2.149, Global test accuracy: 26.62
Round  15, Train loss: 1.874, Test loss: 1.681, Test accuracy: 37.22
Round  15, Global train loss: 1.874, Global test loss: 2.155, Global test accuracy: 30.46
Round  16, Train loss: 1.789, Test loss: 1.674, Test accuracy: 34.14
Round  16, Global train loss: 1.789, Global test loss: 2.119, Global test accuracy: 25.70
Round  17, Train loss: 1.785, Test loss: 1.680, Test accuracy: 34.58
Round  17, Global train loss: 1.785, Global test loss: 1.969, Global test accuracy: 30.90
Round  18, Train loss: 1.837, Test loss: 1.669, Test accuracy: 34.78
Round  18, Global train loss: 1.837, Global test loss: 2.014, Global test accuracy: 26.48
Round  19, Train loss: 1.881, Test loss: 1.676, Test accuracy: 33.94
Round  19, Global train loss: 1.881, Global test loss: 2.103, Global test accuracy: 24.28
Round  20, Train loss: 1.761, Test loss: 1.673, Test accuracy: 35.60
Round  20, Global train loss: 1.761, Global test loss: 2.057, Global test accuracy: 26.62
Round  21, Train loss: 1.727, Test loss: 1.675, Test accuracy: 37.12
Round  21, Global train loss: 1.727, Global test loss: 2.072, Global test accuracy: 29.78
Round  22, Train loss: 1.950, Test loss: 1.668, Test accuracy: 37.18
Round  22, Global train loss: 1.950, Global test loss: 2.133, Global test accuracy: 26.10
Round  23, Train loss: 1.813, Test loss: 1.666, Test accuracy: 35.86
Round  23, Global train loss: 1.813, Global test loss: 1.946, Global test accuracy: 34.96
Round  24, Train loss: 1.694, Test loss: 1.649, Test accuracy: 35.80
Round  24, Global train loss: 1.694, Global test loss: 1.922, Global test accuracy: 36.08
Round  25, Train loss: 1.704, Test loss: 1.611, Test accuracy: 39.20
Round  25, Global train loss: 1.704, Global test loss: 1.911, Global test accuracy: 33.90
Round  26, Train loss: 1.769, Test loss: 1.600, Test accuracy: 41.46
Round  26, Global train loss: 1.769, Global test loss: 2.054, Global test accuracy: 31.98
Round  27, Train loss: 1.835, Test loss: 1.604, Test accuracy: 41.70
Round  27, Global train loss: 1.835, Global test loss: 1.974, Global test accuracy: 34.30
Round  28, Train loss: 1.741, Test loss: 1.608, Test accuracy: 40.32
Round  28, Global train loss: 1.741, Global test loss: 2.082, Global test accuracy: 28.18
Round  29, Train loss: 1.733, Test loss: 1.594, Test accuracy: 38.92
Round  29, Global train loss: 1.733, Global test loss: 2.096, Global test accuracy: 32.02
Round  30, Train loss: 1.777, Test loss: 1.595, Test accuracy: 40.00
Round  30, Global train loss: 1.777, Global test loss: 2.096, Global test accuracy: 30.10
Round  31, Train loss: 1.748, Test loss: 1.609, Test accuracy: 39.16
Round  31, Global train loss: 1.748, Global test loss: 2.056, Global test accuracy: 27.56
Round  32, Train loss: 1.620, Test loss: 1.600, Test accuracy: 40.22
Round  32, Global train loss: 1.620, Global test loss: 2.136, Global test accuracy: 30.72
Round  33, Train loss: 1.600, Test loss: 1.602, Test accuracy: 40.38
Round  33, Global train loss: 1.600, Global test loss: 1.928, Global test accuracy: 34.96
Round  34, Train loss: 1.684, Test loss: 1.595, Test accuracy: 39.54
Round  34, Global train loss: 1.684, Global test loss: 2.076, Global test accuracy: 32.22
Round  35, Train loss: 1.582, Test loss: 1.595, Test accuracy: 39.24
Round  35, Global train loss: 1.582, Global test loss: 1.863, Global test accuracy: 38.34
Round  36, Train loss: 1.814, Test loss: 1.599, Test accuracy: 38.14
Round  36, Global train loss: 1.814, Global test loss: 2.120, Global test accuracy: 27.90
Round  37, Train loss: 1.631, Test loss: 1.592, Test accuracy: 38.76
Round  37, Global train loss: 1.631, Global test loss: 1.984, Global test accuracy: 32.58
Round  38, Train loss: 1.589, Test loss: 1.590, Test accuracy: 38.96
Round  38, Global train loss: 1.589, Global test loss: 1.914, Global test accuracy: 36.68
Round  39, Train loss: 1.626, Test loss: 1.572, Test accuracy: 41.10
Round  39, Global train loss: 1.626, Global test loss: 2.006, Global test accuracy: 34.28
Round  40, Train loss: 1.617, Test loss: 1.600, Test accuracy: 39.82
Round  40, Global train loss: 1.617, Global test loss: 1.881, Global test accuracy: 37.84
Round  41, Train loss: 1.705, Test loss: 1.596, Test accuracy: 40.02
Round  41, Global train loss: 1.705, Global test loss: 2.019, Global test accuracy: 31.68
Round  42, Train loss: 1.416, Test loss: 1.577, Test accuracy: 40.84
Round  42, Global train loss: 1.416, Global test loss: 1.842, Global test accuracy: 41.10
Round  43, Train loss: 1.650, Test loss: 1.582, Test accuracy: 40.36
Round  43, Global train loss: 1.650, Global test loss: 2.050, Global test accuracy: 29.44
Round  44, Train loss: 1.849, Test loss: 1.578, Test accuracy: 40.48
Round  44, Global train loss: 1.849, Global test loss: 1.947, Global test accuracy: 32.48
Round  45, Train loss: 1.660, Test loss: 1.586, Test accuracy: 39.82
Round  45, Global train loss: 1.660, Global test loss: 1.940, Global test accuracy: 34.70
Round  46, Train loss: 1.642, Test loss: 1.602, Test accuracy: 39.72
Round  46, Global train loss: 1.642, Global test loss: 1.967, Global test accuracy: 32.10
Round  47, Train loss: 1.538, Test loss: 1.591, Test accuracy: 40.66
Round  47, Global train loss: 1.538, Global test loss: 2.039, Global test accuracy: 32.92
Round  48, Train loss: 1.530, Test loss: 1.581, Test accuracy: 40.68
Round  48, Global train loss: 1.530, Global test loss: 1.950, Global test accuracy: 32.36
Round  49, Train loss: 1.687, Test loss: 1.597, Test accuracy: 39.22
Round  49, Global train loss: 1.687, Global test loss: 1.936, Global test accuracy: 32.50
Round  50, Train loss: 1.603, Test loss: 1.619, Test accuracy: 37.62
Round  50, Global train loss: 1.603, Global test loss: 2.012, Global test accuracy: 28.78
Round  51, Train loss: 1.695, Test loss: 1.573, Test accuracy: 40.06
Round  51, Global train loss: 1.695, Global test loss: 1.982, Global test accuracy: 33.32
Round  52, Train loss: 1.546, Test loss: 1.609, Test accuracy: 39.08
Round  52, Global train loss: 1.546, Global test loss: 1.945, Global test accuracy: 32.36
Round  53, Train loss: 1.673, Test loss: 1.624, Test accuracy: 38.88
Round  53, Global train loss: 1.673, Global test loss: 2.156, Global test accuracy: 27.66
Round  54, Train loss: 1.496, Test loss: 1.635, Test accuracy: 39.32
Round  54, Global train loss: 1.496, Global test loss: 2.061, Global test accuracy: 32.10
Round  55, Train loss: 1.466, Test loss: 1.643, Test accuracy: 39.32
Round  55, Global train loss: 1.466, Global test loss: 2.037, Global test accuracy: 33.18
Round  56, Train loss: 1.401, Test loss: 1.689, Test accuracy: 38.30
Round  56, Global train loss: 1.401, Global test loss: 2.026, Global test accuracy: 31.10
Round  57, Train loss: 1.521, Test loss: 1.686, Test accuracy: 38.76
Round  57, Global train loss: 1.521, Global test loss: 2.156, Global test accuracy: 24.26
Round  58, Train loss: 1.496, Test loss: 1.699, Test accuracy: 38.36
Round  58, Global train loss: 1.496, Global test loss: 2.234, Global test accuracy: 26.42
Round  59, Train loss: 1.409, Test loss: 1.751, Test accuracy: 36.72
Round  59, Global train loss: 1.409, Global test loss: 2.070, Global test accuracy: 30.82
Round  60, Train loss: 1.485, Test loss: 1.802, Test accuracy: 36.06
Round  60, Global train loss: 1.485, Global test loss: 2.261, Global test accuracy: 26.18
Round  61, Train loss: 1.160, Test loss: 1.809, Test accuracy: 35.66
Round  61, Global train loss: 1.160, Global test loss: 2.112, Global test accuracy: 35.14
Round  62, Train loss: 1.439, Test loss: 1.831, Test accuracy: 35.52
Round  62, Global train loss: 1.439, Global test loss: 2.197, Global test accuracy: 28.98
Round  63, Train loss: 1.279, Test loss: 1.782, Test accuracy: 35.78
Round  63, Global train loss: 1.279, Global test loss: 2.222, Global test accuracy: 33.24
Round  64, Train loss: 1.174, Test loss: 1.799, Test accuracy: 35.82
Round  64, Global train loss: 1.174, Global test loss: 2.225, Global test accuracy: 32.58
Round  65, Train loss: 1.360, Test loss: 1.823, Test accuracy: 35.76
Round  65, Global train loss: 1.360, Global test loss: 2.245, Global test accuracy: 27.36
Round  66, Train loss: 1.205, Test loss: 1.874, Test accuracy: 35.36
Round  66, Global train loss: 1.205, Global test loss: 2.275, Global test accuracy: 30.68
Round  67, Train loss: 1.179, Test loss: 1.849, Test accuracy: 36.60
Round  67, Global train loss: 1.179, Global test loss: 2.540, Global test accuracy: 26.36
Round  68, Train loss: 1.108, Test loss: 1.940, Test accuracy: 35.54
Round  68, Global train loss: 1.108, Global test loss: 2.270, Global test accuracy: 31.84
Round  69, Train loss: 1.388, Test loss: 1.976, Test accuracy: 34.52
Round  69, Global train loss: 1.388, Global test loss: 2.154, Global test accuracy: 33.76
Round  70, Train loss: 1.139, Test loss: 2.026, Test accuracy: 34.38
Round  70, Global train loss: 1.139, Global test loss: 2.327, Global test accuracy: 30.78
Round  71, Train loss: 1.300, Test loss: 1.981, Test accuracy: 35.14
Round  71, Global train loss: 1.300, Global test loss: 2.238, Global test accuracy: 31.48
Round  72, Train loss: 1.067, Test loss: 1.984, Test accuracy: 35.42
Round  72, Global train loss: 1.067, Global test loss: 2.326, Global test accuracy: 29.24
Round  73, Train loss: 1.150, Test loss: 1.997, Test accuracy: 35.90
Round  73, Global train loss: 1.150, Global test loss: 2.258, Global test accuracy: 32.32
Round  74, Train loss: 1.308, Test loss: 2.038, Test accuracy: 34.90
Round  74, Global train loss: 1.308, Global test loss: 2.435, Global test accuracy: 24.40
Round  75, Train loss: 1.111, Test loss: 2.109, Test accuracy: 34.72
Round  75, Global train loss: 1.111, Global test loss: 2.270, Global test accuracy: 31.22
Round  76, Train loss: 1.260, Test loss: 2.075, Test accuracy: 35.92
Round  76, Global train loss: 1.260, Global test loss: 2.540, Global test accuracy: 25.26
Round  77, Train loss: 1.010, Test loss: 2.102, Test accuracy: 36.24
Round  77, Global train loss: 1.010, Global test loss: 2.578, Global test accuracy: 27.54
Round  78, Train loss: 1.221, Test loss: 2.112, Test accuracy: 35.48
Round  78, Global train loss: 1.221, Global test loss: 2.511, Global test accuracy: 26.20
Round  79, Train loss: 0.981, Test loss: 2.152, Test accuracy: 34.66
Round  79, Global train loss: 0.981, Global test loss: 2.834, Global test accuracy: 21.52
Round  80, Train loss: 1.081, Test loss: 2.267, Test accuracy: 33.94
Round  80, Global train loss: 1.081, Global test loss: 2.715, Global test accuracy: 28.82
Round  81, Train loss: 0.994, Test loss: 2.293, Test accuracy: 34.10
Round  81, Global train loss: 0.994, Global test loss: 2.659, Global test accuracy: 25.72
Round  82, Train loss: 0.976, Test loss: 2.298, Test accuracy: 33.86
Round  82, Global train loss: 0.976, Global test loss: 2.733, Global test accuracy: 26.58
Round  83, Train loss: 1.061, Test loss: 2.297, Test accuracy: 34.52
Round  83, Global train loss: 1.061, Global test loss: 2.497, Global test accuracy: 27.48
Round  84, Train loss: 0.911, Test loss: 2.323, Test accuracy: 34.44
Round  84, Global train loss: 0.911, Global test loss: 3.101, Global test accuracy: 22.88
Round  85, Train loss: 1.019, Test loss: 2.403, Test accuracy: 33.08
Round  85, Global train loss: 1.019, Global test loss: 2.866, Global test accuracy: 26.50
Round  86, Train loss: 0.967, Test loss: 2.426, Test accuracy: 33.04
Round  86, Global train loss: 0.967, Global test loss: 2.859, Global test accuracy: 23.54
Round  87, Train loss: 0.940, Test loss: 2.371, Test accuracy: 34.76
Round  87, Global train loss: 0.940, Global test loss: 2.641, Global test accuracy: 30.86
Round  88, Train loss: 0.805, Test loss: 2.415, Test accuracy: 34.00
Round  88, Global train loss: 0.805, Global test loss: 2.813, Global test accuracy: 30.12
Round  89, Train loss: 0.847, Test loss: 2.483, Test accuracy: 34.44
Round  89, Global train loss: 0.847, Global test loss: 2.983, Global test accuracy: 27.34
Round  90, Train loss: 0.760, Test loss: 2.437, Test accuracy: 34.40
Round  90, Global train loss: 0.760, Global test loss: 2.777, Global test accuracy: 29.42
Round  91, Train loss: 0.772, Test loss: 2.441, Test accuracy: 34.70
Round  91, Global train loss: 0.772, Global test loss: 2.774, Global test accuracy: 29.62
Round  92, Train loss: 0.846, Test loss: 2.512, Test accuracy: 33.42
Round  92, Global train loss: 0.846, Global test loss: 2.891, Global test accuracy: 27.68
Round  93, Train loss: 0.685, Test loss: 2.618, Test accuracy: 33.32
Round  93, Global train loss: 0.685, Global test loss: 2.822, Global test accuracy: 32.50/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 1.058, Test loss: 2.579, Test accuracy: 33.84
Round  94, Global train loss: 1.058, Global test loss: 2.950, Global test accuracy: 27.20
Round  95, Train loss: 1.082, Test loss: 2.614, Test accuracy: 34.04
Round  95, Global train loss: 1.082, Global test loss: 2.741, Global test accuracy: 27.34
Round  96, Train loss: 0.726, Test loss: 2.655, Test accuracy: 34.04
Round  96, Global train loss: 0.726, Global test loss: 2.899, Global test accuracy: 30.28
Round  97, Train loss: 0.751, Test loss: 2.729, Test accuracy: 33.72
Round  97, Global train loss: 0.751, Global test loss: 2.729, Global test accuracy: 36.26
Round  98, Train loss: 0.712, Test loss: 2.611, Test accuracy: 33.70
Round  98, Global train loss: 0.712, Global test loss: 2.880, Global test accuracy: 31.62
Round  99, Train loss: 0.682, Test loss: 2.654, Test accuracy: 33.26
Round  99, Global train loss: 0.682, Global test loss: 3.195, Global test accuracy: 25.16
Final Round, Train loss: 0.691, Test loss: 2.842, Test accuracy: 34.96
Final Round, Global train loss: 0.691, Global test loss: 3.195, Global test accuracy: 25.16
Average accuracy final 10 rounds: 33.844 

Average global accuracy final 10 rounds: 29.708 

829.3990650177002
[1.604048728942871, 3.208097457885742, 4.480655193328857, 5.753212928771973, 7.036328077316284, 8.319443225860596, 9.562562465667725, 10.805681705474854, 12.09297513961792, 13.380268573760986, 14.703991651535034, 16.027714729309082, 17.408401489257812, 18.789088249206543, 20.10964608192444, 21.430203914642334, 22.65090584754944, 23.871607780456543, 25.153923988342285, 26.436240196228027, 27.76652956008911, 29.096818923950195, 30.38219118118286, 31.667563438415527, 33.00241804122925, 34.33727264404297, 35.69090509414673, 37.04453754425049, 38.33590888977051, 39.62728023529053, 40.91126322746277, 42.19524621963501, 43.50913047790527, 44.82301473617554, 46.09519147872925, 47.36736822128296, 48.69416403770447, 50.02095985412598, 51.389951944351196, 52.758944034576416, 54.00745415687561, 55.255964279174805, 56.63334274291992, 58.01072120666504, 59.40319204330444, 60.79566287994385, 62.116599798202515, 63.43753671646118, 64.72932434082031, 66.02111196517944, 67.29846119880676, 68.57581043243408, 69.81709814071655, 71.05838584899902, 72.37852740287781, 73.69866895675659, 74.99298405647278, 76.28729915618896, 77.56795644760132, 78.84861373901367, 80.1990921497345, 81.54957056045532, 82.73645186424255, 83.92333316802979, 85.2456922531128, 86.5680513381958, 87.89107394218445, 89.2140965461731, 90.58137583732605, 91.948655128479, 93.29905223846436, 94.6494493484497, 96.11080431938171, 97.57215929031372, 98.88264393806458, 100.19312858581543, 101.46897602081299, 102.74482345581055, 104.03529357910156, 105.32576370239258, 106.59374809265137, 107.86173248291016, 109.18217444419861, 110.50261640548706, 111.89790439605713, 113.2931923866272, 114.58029866218567, 115.86740493774414, 117.16539120674133, 118.46337747573853, 119.79795479774475, 121.13253211975098, 122.49646139144897, 123.86039066314697, 125.20652484893799, 126.552659034729, 127.85335755348206, 129.1540560722351, 130.4904465675354, 131.8268370628357, 133.1211748123169, 134.4155125617981, 135.7180278301239, 137.0205430984497, 138.3625292778015, 139.70451545715332, 141.02173829078674, 142.33896112442017, 143.61963868141174, 144.90031623840332, 146.17833018302917, 147.45634412765503, 148.760803937912, 150.06526374816895, 151.38185667991638, 152.69844961166382, 154.0168948173523, 155.33534002304077, 156.68423986434937, 158.03313970565796, 159.3402669429779, 160.64739418029785, 161.9561152458191, 163.26483631134033, 164.7021734714508, 166.13951063156128, 167.41997909545898, 168.7004475593567, 169.95348048210144, 171.2065134048462, 172.53705167770386, 173.86758995056152, 175.22190499305725, 176.57622003555298, 177.9011585712433, 179.2260971069336, 180.53539443016052, 181.84469175338745, 183.10871624946594, 184.37274074554443, 185.59878826141357, 186.82483577728271, 188.14591336250305, 189.4669909477234, 190.78380250930786, 192.10061407089233, 193.40252900123596, 194.7044439315796, 195.95314502716064, 197.2018461227417, 198.46954679489136, 199.73724746704102, 201.0536403656006, 202.37003326416016, 203.67033863067627, 204.97064399719238, 206.32907938957214, 207.6875147819519, 208.98763418197632, 210.28775358200073, 211.5702953338623, 212.85283708572388, 214.25739812850952, 215.66195917129517, 216.99741458892822, 218.33287000656128, 219.7447328567505, 221.1565957069397, 222.5067639350891, 223.85693216323853, 225.17309308052063, 226.48925399780273, 227.72443914413452, 228.9596242904663, 230.31493520736694, 231.67024612426758, 233.0304663181305, 234.3906865119934, 235.78017020225525, 237.1696538925171, 238.4735460281372, 239.77743816375732, 241.05513453483582, 242.3328309059143, 243.56980681419373, 244.80678272247314, 246.0870978832245, 247.36741304397583, 248.69227743148804, 250.01714181900024, 251.31957244873047, 252.6220030784607, 253.97767543792725, 255.3333477973938, 256.60007524490356, 257.86680269241333, 259.21111035346985, 260.55541801452637, 261.841824054718, 263.12823009490967, 265.8193438053131, 268.51045751571655]
[10.82, 10.82, 22.22, 22.22, 21.88, 21.88, 26.36, 26.36, 27.84, 27.84, 27.08, 27.08, 31.64, 31.64, 32.86, 32.86, 31.44, 31.44, 30.08, 30.08, 32.1, 32.1, 34.04, 34.04, 33.26, 33.26, 33.96, 33.96, 36.14, 36.14, 37.22, 37.22, 34.14, 34.14, 34.58, 34.58, 34.78, 34.78, 33.94, 33.94, 35.6, 35.6, 37.12, 37.12, 37.18, 37.18, 35.86, 35.86, 35.8, 35.8, 39.2, 39.2, 41.46, 41.46, 41.7, 41.7, 40.32, 40.32, 38.92, 38.92, 40.0, 40.0, 39.16, 39.16, 40.22, 40.22, 40.38, 40.38, 39.54, 39.54, 39.24, 39.24, 38.14, 38.14, 38.76, 38.76, 38.96, 38.96, 41.1, 41.1, 39.82, 39.82, 40.02, 40.02, 40.84, 40.84, 40.36, 40.36, 40.48, 40.48, 39.82, 39.82, 39.72, 39.72, 40.66, 40.66, 40.68, 40.68, 39.22, 39.22, 37.62, 37.62, 40.06, 40.06, 39.08, 39.08, 38.88, 38.88, 39.32, 39.32, 39.32, 39.32, 38.3, 38.3, 38.76, 38.76, 38.36, 38.36, 36.72, 36.72, 36.06, 36.06, 35.66, 35.66, 35.52, 35.52, 35.78, 35.78, 35.82, 35.82, 35.76, 35.76, 35.36, 35.36, 36.6, 36.6, 35.54, 35.54, 34.52, 34.52, 34.38, 34.38, 35.14, 35.14, 35.42, 35.42, 35.9, 35.9, 34.9, 34.9, 34.72, 34.72, 35.92, 35.92, 36.24, 36.24, 35.48, 35.48, 34.66, 34.66, 33.94, 33.94, 34.1, 34.1, 33.86, 33.86, 34.52, 34.52, 34.44, 34.44, 33.08, 33.08, 33.04, 33.04, 34.76, 34.76, 34.0, 34.0, 34.44, 34.44, 34.4, 34.4, 34.7, 34.7, 33.42, 33.42, 33.32, 33.32, 33.84, 33.84, 34.04, 34.04, 34.04, 34.04, 33.72, 33.72, 33.7, 33.7, 33.26, 33.26, 34.96, 34.96]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
fedavg
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.105, Test loss: 2.252, Test accuracy: 11.18
Round   0, Global train loss: 2.105, Global test loss: 2.353, Global test accuracy: 10.00
Round   1, Train loss: 1.920, Test loss: 2.038, Test accuracy: 19.78
Round   1, Global train loss: 1.920, Global test loss: 2.341, Global test accuracy: 12.00
Round   2, Train loss: 1.833, Test loss: 2.028, Test accuracy: 24.88
Round   2, Global train loss: 1.833, Global test loss: 2.294, Global test accuracy: 18.30
Round   3, Train loss: 1.939, Test loss: 1.865, Test accuracy: 29.30
Round   3, Global train loss: 1.939, Global test loss: 2.249, Global test accuracy: 26.64
Round   4, Train loss: 1.805, Test loss: 1.893, Test accuracy: 27.04
Round   4, Global train loss: 1.805, Global test loss: 2.267, Global test accuracy: 18.66
Round   5, Train loss: 1.691, Test loss: 1.819, Test accuracy: 28.94
Round   5, Global train loss: 1.691, Global test loss: 2.153, Global test accuracy: 21.74
Round   6, Train loss: 1.957, Test loss: 1.808, Test accuracy: 30.64
Round   6, Global train loss: 1.957, Global test loss: 2.204, Global test accuracy: 20.00
Round   7, Train loss: 1.717, Test loss: 1.808, Test accuracy: 30.04
Round   7, Global train loss: 1.717, Global test loss: 2.206, Global test accuracy: 20.06
Round   8, Train loss: 1.605, Test loss: 1.801, Test accuracy: 30.32
Round   8, Global train loss: 1.605, Global test loss: 2.179, Global test accuracy: 23.18
Round   9, Train loss: 1.634, Test loss: 1.726, Test accuracy: 33.48
Round   9, Global train loss: 1.634, Global test loss: 2.036, Global test accuracy: 33.80
Round  10, Train loss: 1.951, Test loss: 1.741, Test accuracy: 34.26
Round  10, Global train loss: 1.951, Global test loss: 2.222, Global test accuracy: 24.02
Round  11, Train loss: 1.930, Test loss: 1.686, Test accuracy: 36.56
Round  11, Global train loss: 1.930, Global test loss: 2.229, Global test accuracy: 24.10
Round  12, Train loss: 1.985, Test loss: 1.671, Test accuracy: 37.74
Round  12, Global train loss: 1.985, Global test loss: 2.194, Global test accuracy: 23.70
Round  13, Train loss: 1.823, Test loss: 1.662, Test accuracy: 39.28
Round  13, Global train loss: 1.823, Global test loss: 2.355, Global test accuracy: 17.12
Round  14, Train loss: 1.901, Test loss: 1.657, Test accuracy: 39.34
Round  14, Global train loss: 1.901, Global test loss: 2.097, Global test accuracy: 28.90
Round  15, Train loss: 1.947, Test loss: 1.662, Test accuracy: 37.68
Round  15, Global train loss: 1.947, Global test loss: 2.271, Global test accuracy: 26.08
Round  16, Train loss: 1.959, Test loss: 1.682, Test accuracy: 36.66
Round  16, Global train loss: 1.959, Global test loss: 2.267, Global test accuracy: 26.90
Round  17, Train loss: 1.945, Test loss: 1.669, Test accuracy: 38.08
Round  17, Global train loss: 1.945, Global test loss: 2.142, Global test accuracy: 27.22
Round  18, Train loss: 1.915, Test loss: 1.668, Test accuracy: 37.00
Round  18, Global train loss: 1.915, Global test loss: 2.200, Global test accuracy: 17.84
Round  19, Train loss: 1.768, Test loss: 1.659, Test accuracy: 37.66
Round  19, Global train loss: 1.768, Global test loss: 2.155, Global test accuracy: 25.06
Round  20, Train loss: 1.816, Test loss: 1.643, Test accuracy: 38.58
Round  20, Global train loss: 1.816, Global test loss: 2.183, Global test accuracy: 24.46
Round  21, Train loss: 1.821, Test loss: 1.641, Test accuracy: 37.72
Round  21, Global train loss: 1.821, Global test loss: 2.182, Global test accuracy: 19.48
Round  22, Train loss: 1.798, Test loss: 1.664, Test accuracy: 35.62
Round  22, Global train loss: 1.798, Global test loss: 2.196, Global test accuracy: 24.80
Round  23, Train loss: 1.800, Test loss: 1.675, Test accuracy: 36.00
Round  23, Global train loss: 1.800, Global test loss: 2.347, Global test accuracy: 22.98
Round  24, Train loss: 1.591, Test loss: 1.665, Test accuracy: 36.82
Round  24, Global train loss: 1.591, Global test loss: 2.165, Global test accuracy: 29.72
Round  25, Train loss: 1.517, Test loss: 1.662, Test accuracy: 36.38
Round  25, Global train loss: 1.517, Global test loss: 2.185, Global test accuracy: 26.60
Round  26, Train loss: 1.898, Test loss: 1.671, Test accuracy: 36.98
Round  26, Global train loss: 1.898, Global test loss: 2.117, Global test accuracy: 28.58
Round  27, Train loss: 1.852, Test loss: 1.672, Test accuracy: 37.20
Round  27, Global train loss: 1.852, Global test loss: 2.076, Global test accuracy: 29.04
Round  28, Train loss: 1.852, Test loss: 1.661, Test accuracy: 37.12
Round  28, Global train loss: 1.852, Global test loss: 2.199, Global test accuracy: 24.72
Round  29, Train loss: 1.802, Test loss: 1.655, Test accuracy: 37.18
Round  29, Global train loss: 1.802, Global test loss: 2.223, Global test accuracy: 24.38
Round  30, Train loss: 1.856, Test loss: 1.655, Test accuracy: 37.98
Round  30, Global train loss: 1.856, Global test loss: 2.080, Global test accuracy: 26.84
Round  31, Train loss: 1.812, Test loss: 1.644, Test accuracy: 37.68
Round  31, Global train loss: 1.812, Global test loss: 2.155, Global test accuracy: 26.26
Round  32, Train loss: 1.736, Test loss: 1.630, Test accuracy: 37.74
Round  32, Global train loss: 1.736, Global test loss: 2.262, Global test accuracy: 22.60
Round  33, Train loss: 1.426, Test loss: 1.638, Test accuracy: 37.48
Round  33, Global train loss: 1.426, Global test loss: 2.248, Global test accuracy: 25.40
Round  34, Train loss: 1.497, Test loss: 1.624, Test accuracy: 38.52
Round  34, Global train loss: 1.497, Global test loss: 2.147, Global test accuracy: 29.46
Round  35, Train loss: 1.757, Test loss: 1.613, Test accuracy: 37.94
Round  35, Global train loss: 1.757, Global test loss: 2.088, Global test accuracy: 27.10
Round  36, Train loss: 1.802, Test loss: 1.633, Test accuracy: 37.00
Round  36, Global train loss: 1.802, Global test loss: 2.209, Global test accuracy: 26.28
Round  37, Train loss: 1.739, Test loss: 1.653, Test accuracy: 36.06
Round  37, Global train loss: 1.739, Global test loss: 2.160, Global test accuracy: 25.40
Round  38, Train loss: 1.651, Test loss: 1.667, Test accuracy: 36.08
Round  38, Global train loss: 1.651, Global test loss: 2.196, Global test accuracy: 22.30
Round  39, Train loss: 1.426, Test loss: 1.717, Test accuracy: 35.08
Round  39, Global train loss: 1.426, Global test loss: 2.221, Global test accuracy: 28.18
Round  40, Train loss: 1.649, Test loss: 1.660, Test accuracy: 36.24
Round  40, Global train loss: 1.649, Global test loss: 2.349, Global test accuracy: 19.58
Round  41, Train loss: 1.672, Test loss: 1.727, Test accuracy: 35.84
Round  41, Global train loss: 1.672, Global test loss: 2.302, Global test accuracy: 19.96
Round  42, Train loss: 1.551, Test loss: 1.731, Test accuracy: 34.88
Round  42, Global train loss: 1.551, Global test loss: 2.276, Global test accuracy: 22.16
Round  43, Train loss: 1.657, Test loss: 1.777, Test accuracy: 34.56
Round  43, Global train loss: 1.657, Global test loss: 2.297, Global test accuracy: 21.44
Round  44, Train loss: 1.463, Test loss: 1.825, Test accuracy: 34.18
Round  44, Global train loss: 1.463, Global test loss: 2.127, Global test accuracy: 27.52
Round  45, Train loss: 1.516, Test loss: 1.788, Test accuracy: 36.26
Round  45, Global train loss: 1.516, Global test loss: 2.599, Global test accuracy: 16.80
Round  46, Train loss: 1.341, Test loss: 1.829, Test accuracy: 35.84
Round  46, Global train loss: 1.341, Global test loss: 2.432, Global test accuracy: 24.56
Round  47, Train loss: 1.474, Test loss: 1.853, Test accuracy: 34.60
Round  47, Global train loss: 1.474, Global test loss: 2.590, Global test accuracy: 16.56
Round  48, Train loss: 1.527, Test loss: 1.831, Test accuracy: 34.30
Round  48, Global train loss: 1.527, Global test loss: 2.352, Global test accuracy: 18.78
Round  49, Train loss: 1.408, Test loss: 1.880, Test accuracy: 33.22
Round  49, Global train loss: 1.408, Global test loss: 2.303, Global test accuracy: 25.62
Round  50, Train loss: 1.489, Test loss: 1.893, Test accuracy: 32.60
Round  50, Global train loss: 1.489, Global test loss: 2.345, Global test accuracy: 19.66
Round  51, Train loss: 1.180, Test loss: 1.910, Test accuracy: 32.84
Round  51, Global train loss: 1.180, Global test loss: 2.160, Global test accuracy: 26.10
Round  52, Train loss: 1.448, Test loss: 1.936, Test accuracy: 33.14
Round  52, Global train loss: 1.448, Global test loss: 2.363, Global test accuracy: 21.44
Round  53, Train loss: 1.110, Test loss: 1.982, Test accuracy: 34.16
Round  53, Global train loss: 1.110, Global test loss: 2.145, Global test accuracy: 36.78
Round  54, Train loss: 1.396, Test loss: 1.996, Test accuracy: 35.58
Round  54, Global train loss: 1.396, Global test loss: 2.471, Global test accuracy: 23.20
Round  55, Train loss: 1.072, Test loss: 2.024, Test accuracy: 35.72
Round  55, Global train loss: 1.072, Global test loss: 2.523, Global test accuracy: 25.32
Round  56, Train loss: 1.308, Test loss: 2.008, Test accuracy: 35.54
Round  56, Global train loss: 1.308, Global test loss: 2.587, Global test accuracy: 23.64
Round  57, Train loss: 1.277, Test loss: 2.047, Test accuracy: 35.64
Round  57, Global train loss: 1.277, Global test loss: 2.625, Global test accuracy: 19.46
Round  58, Train loss: 1.107, Test loss: 2.059, Test accuracy: 35.14
Round  58, Global train loss: 1.107, Global test loss: 2.347, Global test accuracy: 29.60
Round  59, Train loss: 1.062, Test loss: 2.053, Test accuracy: 35.14
Round  59, Global train loss: 1.062, Global test loss: 2.410, Global test accuracy: 28.94
Round  60, Train loss: 1.252, Test loss: 2.061, Test accuracy: 34.36
Round  60, Global train loss: 1.252, Global test loss: 2.552, Global test accuracy: 20.66
Round  61, Train loss: 1.113, Test loss: 2.104, Test accuracy: 34.66
Round  61, Global train loss: 1.113, Global test loss: 2.685, Global test accuracy: 20.54
Round  62, Train loss: 1.296, Test loss: 2.156, Test accuracy: 33.30
Round  62, Global train loss: 1.296, Global test loss: 2.830, Global test accuracy: 18.90
Round  63, Train loss: 1.211, Test loss: 2.179, Test accuracy: 32.98
Round  63, Global train loss: 1.211, Global test loss: 2.753, Global test accuracy: 18.98
Round  64, Train loss: 1.069, Test loss: 2.303, Test accuracy: 32.56
Round  64, Global train loss: 1.069, Global test loss: 2.849, Global test accuracy: 17.32
Round  65, Train loss: 1.127, Test loss: 2.339, Test accuracy: 31.94
Round  65, Global train loss: 1.127, Global test loss: 2.792, Global test accuracy: 19.22
Round  66, Train loss: 1.055, Test loss: 2.390, Test accuracy: 32.14
Round  66, Global train loss: 1.055, Global test loss: 2.952, Global test accuracy: 18.04
Round  67, Train loss: 1.016, Test loss: 2.364, Test accuracy: 32.82
Round  67, Global train loss: 1.016, Global test loss: 3.168, Global test accuracy: 18.56
Round  68, Train loss: 1.081, Test loss: 2.488, Test accuracy: 32.00
Round  68, Global train loss: 1.081, Global test loss: 3.027, Global test accuracy: 18.28
Round  69, Train loss: 0.912, Test loss: 2.521, Test accuracy: 31.68
Round  69, Global train loss: 0.912, Global test loss: 2.480, Global test accuracy: 31.90
Round  70, Train loss: 0.958, Test loss: 2.459, Test accuracy: 32.72
Round  70, Global train loss: 0.958, Global test loss: 2.966, Global test accuracy: 21.48
Round  71, Train loss: 0.842, Test loss: 2.479, Test accuracy: 32.60
Round  71, Global train loss: 0.842, Global test loss: 2.503, Global test accuracy: 34.04
Round  72, Train loss: 0.951, Test loss: 2.519, Test accuracy: 32.96
Round  72, Global train loss: 0.951, Global test loss: 2.825, Global test accuracy: 23.40
Round  73, Train loss: 1.070, Test loss: 2.534, Test accuracy: 33.54
Round  73, Global train loss: 1.070, Global test loss: 3.027, Global test accuracy: 21.66
Round  74, Train loss: 0.975, Test loss: 2.619, Test accuracy: 32.58
Round  74, Global train loss: 0.975, Global test loss: 2.989, Global test accuracy: 23.16
Round  75, Train loss: 0.763, Test loss: 2.643, Test accuracy: 32.74
Round  75, Global train loss: 0.763, Global test loss: 2.740, Global test accuracy: 29.26
Round  76, Train loss: 0.894, Test loss: 2.691, Test accuracy: 32.94
Round  76, Global train loss: 0.894, Global test loss: 2.853, Global test accuracy: 24.96
Round  77, Train loss: 0.911, Test loss: 2.722, Test accuracy: 32.60
Round  77, Global train loss: 0.911, Global test loss: 3.076, Global test accuracy: 19.24
Round  78, Train loss: 0.827, Test loss: 2.646, Test accuracy: 33.56
Round  78, Global train loss: 0.827, Global test loss: 2.437, Global test accuracy: 31.58
Round  79, Train loss: 0.808, Test loss: 2.621, Test accuracy: 33.66
Round  79, Global train loss: 0.808, Global test loss: 2.962, Global test accuracy: 23.14
Round  80, Train loss: 0.868, Test loss: 2.590, Test accuracy: 33.56
Round  80, Global train loss: 0.868, Global test loss: 3.196, Global test accuracy: 24.72
Round  81, Train loss: 0.812, Test loss: 2.652, Test accuracy: 33.58
Round  81, Global train loss: 0.812, Global test loss: 3.196, Global test accuracy: 20.08
Round  82, Train loss: 0.802, Test loss: 2.731, Test accuracy: 34.34
Round  82, Global train loss: 0.802, Global test loss: 3.547, Global test accuracy: 20.36
Round  83, Train loss: 0.911, Test loss: 2.777, Test accuracy: 34.66
Round  83, Global train loss: 0.911, Global test loss: 3.279, Global test accuracy: 20.04
Round  84, Train loss: 0.722, Test loss: 2.833, Test accuracy: 34.20
Round  84, Global train loss: 0.722, Global test loss: 3.649, Global test accuracy: 19.36
Round  85, Train loss: 0.788, Test loss: 2.944, Test accuracy: 33.38
Round  85, Global train loss: 0.788, Global test loss: 3.363, Global test accuracy: 24.46
Round  86, Train loss: 0.808, Test loss: 2.854, Test accuracy: 34.04
Round  86, Global train loss: 0.808, Global test loss: 3.226, Global test accuracy: 21.46
Round  87, Train loss: 0.764, Test loss: 2.926, Test accuracy: 33.10
Round  87, Global train loss: 0.764, Global test loss: 3.241, Global test accuracy: 24.46
Round  88, Train loss: 0.740, Test loss: 2.845, Test accuracy: 34.06
Round  88, Global train loss: 0.740, Global test loss: 3.269, Global test accuracy: 20.28
Round  89, Train loss: 0.744, Test loss: 2.804, Test accuracy: 34.60
Round  89, Global train loss: 0.744, Global test loss: 3.300, Global test accuracy: 20.56
Round  90, Train loss: 0.686, Test loss: 2.916, Test accuracy: 34.14
Round  90, Global train loss: 0.686, Global test loss: 3.478, Global test accuracy: 21.58
Round  91, Train loss: 0.655, Test loss: 3.017, Test accuracy: 33.52
Round  91, Global train loss: 0.655, Global test loss: 3.673, Global test accuracy: 19.14
Round  92, Train loss: 0.619, Test loss: 3.101, Test accuracy: 33.44
Round  92, Global train loss: 0.619, Global test loss: 3.566, Global test accuracy: 23.26
Round  93, Train loss: 0.613, Test loss: 3.141, Test accuracy: 33.12
Round  93, Global train loss: 0.613, Global test loss: 3.592, Global test accuracy: 24.82
Round  94, Train loss: 0.665, Test loss: 3.041, Test accuracy: 33.22
Round  94, Global train loss: 0.665, Global test loss: 3.070, Global test accuracy: 31.00
Round  95, Train loss: 0.761, Test loss: 3.065, Test accuracy: 32.36
Round  95, Global train loss: 0.761, Global test loss: 2.752, Global test accuracy: 27.92
Round  96, Train loss: 0.555, Test loss: 3.016, Test accuracy: 31.92
Round  96, Global train loss: 0.555, Global test loss: 3.481, Global test accuracy: 25.50
Round  97, Train loss: 0.576, Test loss: 3.044, Test accuracy: 32.72
Round  97, Global train loss: 0.576, Global test loss: 3.170, Global test accuracy: 29.96
Round  98, Train loss: 0.584, Test loss: 3.007, Test accuracy: 32.96
Round  98, Global train loss: 0.584, Global test loss: 3.151, Global test accuracy: 27.44
Round  99, Train loss: 0.584, Test loss: 3.099, Test accuracy: 32.70
Round  99, Global train loss: 0.584, Global test loss: 3.404, Global test accuracy: 23.18
Final Round, Train loss: 0.501, Test loss: 3.502, Test accuracy: 33.96
Final Round, Global train loss: 0.501, Global test loss: 3.404, Global test accuracy: 23.18
Average accuracy final 10 rounds: 33.01
Average global accuracy final 10 rounds: 25.38
1115.155600309372
[3.1930348873138428, 6.137552976608276, 8.997328281402588, 11.851854085922241, 14.803472995758057, 17.915642499923706, 20.833069801330566, 23.78980565071106, 26.69280767440796, 29.5699942111969, 32.416651010513306, 35.27654790878296, 38.14242911338806, 40.97757172584534, 43.83928680419922, 46.96176719665527, 49.953932762145996, 52.86551022529602, 55.843055963516235, 58.6289541721344, 61.6555540561676, 64.72346138954163, 67.70869445800781, 70.64858341217041, 73.55198049545288, 76.49226474761963, 79.56537437438965, 82.4722990989685, 85.3441219329834, 88.09705543518066, 90.81369209289551, 93.46636509895325, 96.18847608566284, 98.90889263153076, 101.59404301643372, 104.27843737602234, 106.9516212940216, 109.81244969367981, 112.50046849250793, 115.26410746574402, 117.91129851341248, 120.59031748771667, 123.31345725059509, 125.97257876396179, 128.6663167476654, 131.29053854942322, 133.89632320404053, 136.5276975631714, 139.37550711631775, 141.99497890472412, 144.6538543701172, 147.26123309135437, 149.93218302726746, 152.6027729511261, 155.33379650115967, 158.05049204826355, 160.6606957912445, 163.291659116745, 165.87277555465698, 168.6215627193451, 171.19513463974, 173.74424123764038, 176.30332326889038, 178.8349256515503, 181.41402554512024, 183.99474239349365, 186.58959555625916, 189.17874598503113, 191.75401782989502, 194.3117196559906, 196.9424695968628, 199.53928184509277, 202.15501427650452, 204.78544855117798, 207.39102387428284, 210.01835083961487, 212.62488269805908, 215.1963746547699, 217.78075242042542, 220.38964223861694, 223.0551404953003, 225.7800862789154, 228.38353633880615, 230.99787592887878, 233.60445880889893, 236.2146611213684, 238.7957592010498, 241.3867950439453, 243.9920196533203, 246.59716653823853, 249.1972939968109, 251.79878664016724, 254.65845727920532, 257.27804684638977, 259.87352299690247, 262.4856324195862, 265.0957467556, 267.7078318595886, 270.32351899147034, 272.96084856987, 277.6165680885315]
[11.18, 19.78, 24.88, 29.3, 27.04, 28.94, 30.64, 30.04, 30.32, 33.48, 34.26, 36.56, 37.74, 39.28, 39.34, 37.68, 36.66, 38.08, 37.0, 37.66, 38.58, 37.72, 35.62, 36.0, 36.82, 36.38, 36.98, 37.2, 37.12, 37.18, 37.98, 37.68, 37.74, 37.48, 38.52, 37.94, 37.0, 36.06, 36.08, 35.08, 36.24, 35.84, 34.88, 34.56, 34.18, 36.26, 35.84, 34.6, 34.3, 33.22, 32.6, 32.84, 33.14, 34.16, 35.58, 35.72, 35.54, 35.64, 35.14, 35.14, 34.36, 34.66, 33.3, 32.98, 32.56, 31.94, 32.14, 32.82, 32.0, 31.68, 32.72, 32.6, 32.96, 33.54, 32.58, 32.74, 32.94, 32.6, 33.56, 33.66, 33.56, 33.58, 34.34, 34.66, 34.2, 33.38, 34.04, 33.1, 34.06, 34.6, 34.14, 33.52, 33.44, 33.12, 33.22, 32.36, 31.92, 32.72, 32.96, 32.7, 33.96]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.146, Test loss: 2.352, Test accuracy: 11.14
Round   0, Global train loss: 2.146, Global test loss: 2.401, Global test accuracy: 10.00
Round   1, Train loss: 2.067, Test loss: 2.120, Test accuracy: 21.08
Round   1, Global train loss: 2.067, Global test loss: 2.302, Global test accuracy: 17.84
Round   2, Train loss: 1.903, Test loss: 2.065, Test accuracy: 24.20
Round   2, Global train loss: 1.903, Global test loss: 2.271, Global test accuracy: 12.90
Round   3, Train loss: 2.106, Test loss: 1.959, Test accuracy: 22.56
Round   3, Global train loss: 2.106, Global test loss: 2.277, Global test accuracy: 13.40
Round   4, Train loss: 1.806, Test loss: 1.945, Test accuracy: 29.36
Round   4, Global train loss: 1.806, Global test loss: 2.415, Global test accuracy: 13.34
Round   5, Train loss: 1.815, Test loss: 1.853, Test accuracy: 32.90
Round   5, Global train loss: 1.815, Global test loss: 2.240, Global test accuracy: 22.56
Round   6, Train loss: 2.098, Test loss: 1.910, Test accuracy: 29.26
Round   6, Global train loss: 2.098, Global test loss: 2.238, Global test accuracy: 19.24
Round   7, Train loss: 1.887, Test loss: 1.843, Test accuracy: 33.44
Round   7, Global train loss: 1.887, Global test loss: 2.203, Global test accuracy: 19.96
Round   8, Train loss: 1.857, Test loss: 1.804, Test accuracy: 35.36
Round   8, Global train loss: 1.857, Global test loss: 2.196, Global test accuracy: 23.18
Round   9, Train loss: 1.781, Test loss: 1.750, Test accuracy: 38.44
Round   9, Global train loss: 1.781, Global test loss: 2.296, Global test accuracy: 21.02
Round  10, Train loss: 1.939, Test loss: 1.775, Test accuracy: 35.14
Round  10, Global train loss: 1.939, Global test loss: 2.222, Global test accuracy: 10.00
Round  11, Train loss: 2.038, Test loss: 1.709, Test accuracy: 37.24
Round  11, Global train loss: 2.038, Global test loss: 2.317, Global test accuracy: 12.00
Round  12, Train loss: 1.888, Test loss: 1.685, Test accuracy: 35.46
Round  12, Global train loss: 1.888, Global test loss: 2.333, Global test accuracy: 12.70
Round  13, Train loss: 1.936, Test loss: 1.707, Test accuracy: 36.20
Round  13, Global train loss: 1.936, Global test loss: 2.356, Global test accuracy: 19.50
Round  14, Train loss: 1.905, Test loss: 1.678, Test accuracy: 38.22
Round  14, Global train loss: 1.905, Global test loss: 2.335, Global test accuracy: 12.50
Round  15, Train loss: 2.064, Test loss: 1.716, Test accuracy: 38.10
Round  15, Global train loss: 2.064, Global test loss: 2.252, Global test accuracy: 14.36
Round  16, Train loss: 1.851, Test loss: 1.705, Test accuracy: 38.26
Round  16, Global train loss: 1.851, Global test loss: 2.175, Global test accuracy: 16.40
Round  17, Train loss: 1.846, Test loss: 1.677, Test accuracy: 38.64
Round  17, Global train loss: 1.846, Global test loss: 2.225, Global test accuracy: 18.72
Round  18, Train loss: 1.728, Test loss: 1.687, Test accuracy: 38.62
Round  18, Global train loss: 1.728, Global test loss: 2.145, Global test accuracy: 26.54
Round  19, Train loss: 1.850, Test loss: 1.673, Test accuracy: 38.78
Round  19, Global train loss: 1.850, Global test loss: 2.369, Global test accuracy: 16.60
Round  20, Train loss: 1.834, Test loss: 1.668, Test accuracy: 37.90
Round  20, Global train loss: 1.834, Global test loss: 2.420, Global test accuracy: 13.20
Round  21, Train loss: 1.764, Test loss: 1.634, Test accuracy: 40.36
Round  21, Global train loss: 1.764, Global test loss: 2.184, Global test accuracy: 23.94
Round  22, Train loss: 1.965, Test loss: 1.667, Test accuracy: 38.66
Round  22, Global train loss: 1.965, Global test loss: 2.377, Global test accuracy: 10.70
Round  23, Train loss: 2.026, Test loss: 1.652, Test accuracy: 38.00
Round  23, Global train loss: 2.026, Global test loss: 2.203, Global test accuracy: 26.62
Round  24, Train loss: 1.959, Test loss: 1.627, Test accuracy: 38.90
Round  24, Global train loss: 1.959, Global test loss: 2.239, Global test accuracy: 19.90
Round  25, Train loss: 1.686, Test loss: 1.609, Test accuracy: 41.76
Round  25, Global train loss: 1.686, Global test loss: 2.183, Global test accuracy: 24.26
Round  26, Train loss: 1.794, Test loss: 1.653, Test accuracy: 42.64
Round  26, Global train loss: 1.794, Global test loss: 2.128, Global test accuracy: 16.70
Round  27, Train loss: 1.962, Test loss: 1.620, Test accuracy: 41.76
Round  27, Global train loss: 1.962, Global test loss: 2.198, Global test accuracy: 18.30
Round  28, Train loss: 1.774, Test loss: 1.622, Test accuracy: 42.64
Round  28, Global train loss: 1.774, Global test loss: 2.117, Global test accuracy: 18.20
Round  29, Train loss: 1.824, Test loss: 1.634, Test accuracy: 41.78
Round  29, Global train loss: 1.824, Global test loss: 2.448, Global test accuracy: 20.20
Round  30, Train loss: 1.778, Test loss: 1.635, Test accuracy: 41.70
Round  30, Global train loss: 1.778, Global test loss: 2.172, Global test accuracy: 19.60
Round  31, Train loss: 1.917, Test loss: 1.639, Test accuracy: 40.16
Round  31, Global train loss: 1.917, Global test loss: 2.286, Global test accuracy: 14.30
Round  32, Train loss: 1.877, Test loss: 1.631, Test accuracy: 39.26
Round  32, Global train loss: 1.877, Global test loss: 2.258, Global test accuracy: 15.40
Round  33, Train loss: 1.732, Test loss: 1.570, Test accuracy: 41.86
Round  33, Global train loss: 1.732, Global test loss: 2.114, Global test accuracy: 24.60
Round  34, Train loss: 1.583, Test loss: 1.575, Test accuracy: 39.62
Round  34, Global train loss: 1.583, Global test loss: 2.119, Global test accuracy: 30.84
Round  35, Train loss: 1.864, Test loss: 1.577, Test accuracy: 41.00
Round  35, Global train loss: 1.864, Global test loss: 2.273, Global test accuracy: 24.20
Round  36, Train loss: 1.849, Test loss: 1.572, Test accuracy: 42.76
Round  36, Global train loss: 1.849, Global test loss: 2.252, Global test accuracy: 20.34
Round  37, Train loss: 1.800, Test loss: 1.561, Test accuracy: 41.18
Round  37, Global train loss: 1.800, Global test loss: 2.358, Global test accuracy: 18.10
Round  38, Train loss: 1.674, Test loss: 1.583, Test accuracy: 42.42
Round  38, Global train loss: 1.674, Global test loss: 2.105, Global test accuracy: 29.40
Round  39, Train loss: 1.542, Test loss: 1.553, Test accuracy: 43.48
Round  39, Global train loss: 1.542, Global test loss: 2.092, Global test accuracy: 31.42
Round  40, Train loss: 1.657, Test loss: 1.568, Test accuracy: 41.98
Round  40, Global train loss: 1.657, Global test loss: 2.189, Global test accuracy: 15.02
Round  41, Train loss: 1.613, Test loss: 1.584, Test accuracy: 42.60
Round  41, Global train loss: 1.613, Global test loss: 2.311, Global test accuracy: 18.06
Round  42, Train loss: 1.689, Test loss: 1.571, Test accuracy: 41.74
Round  42, Global train loss: 1.689, Global test loss: 2.063, Global test accuracy: 29.04
Round  43, Train loss: 1.671, Test loss: 1.585, Test accuracy: 42.24
Round  43, Global train loss: 1.671, Global test loss: 2.082, Global test accuracy: 20.50
Round  44, Train loss: 1.901, Test loss: 1.558, Test accuracy: 42.82
Round  44, Global train loss: 1.901, Global test loss: 2.215, Global test accuracy: 18.60
Round  45, Train loss: 1.860, Test loss: 1.580, Test accuracy: 42.64
Round  45, Global train loss: 1.860, Global test loss: 2.316, Global test accuracy: 19.80
Round  46, Train loss: 1.932, Test loss: 1.539, Test accuracy: 42.54
Round  46, Global train loss: 1.932, Global test loss: 2.229, Global test accuracy: 16.80
Round  47, Train loss: 1.731, Test loss: 1.558, Test accuracy: 41.74
Round  47, Global train loss: 1.731, Global test loss: 2.453, Global test accuracy: 20.80
Round  48, Train loss: 1.837, Test loss: 1.574, Test accuracy: 40.12
Round  48, Global train loss: 1.837, Global test loss: 2.267, Global test accuracy: 16.02
Round  49, Train loss: 1.854, Test loss: 1.558, Test accuracy: 41.30
Round  49, Global train loss: 1.854, Global test loss: 2.216, Global test accuracy: 17.60
Round  50, Train loss: 1.563, Test loss: 1.567, Test accuracy: 42.14
Round  50, Global train loss: 1.563, Global test loss: 2.037, Global test accuracy: 28.28
Round  51, Train loss: 1.635, Test loss: 1.537, Test accuracy: 43.82
Round  51, Global train loss: 1.635, Global test loss: 2.033, Global test accuracy: 29.76
Round  52, Train loss: 1.855, Test loss: 1.548, Test accuracy: 41.48
Round  52, Global train loss: 1.855, Global test loss: 2.212, Global test accuracy: 17.98
Round  53, Train loss: 1.598, Test loss: 1.518, Test accuracy: 43.18
Round  53, Global train loss: 1.598, Global test loss: 2.217, Global test accuracy: 29.50
Round  54, Train loss: 1.907, Test loss: 1.546, Test accuracy: 41.38
Round  54, Global train loss: 1.907, Global test loss: 2.238, Global test accuracy: 19.16
Round  55, Train loss: 1.866, Test loss: 1.544, Test accuracy: 41.52
Round  55, Global train loss: 1.866, Global test loss: 2.248, Global test accuracy: 17.20
Round  56, Train loss: 1.713, Test loss: 1.543, Test accuracy: 43.08
Round  56, Global train loss: 1.713, Global test loss: 2.328, Global test accuracy: 20.90
Round  57, Train loss: 1.645, Test loss: 1.560, Test accuracy: 42.68
Round  57, Global train loss: 1.645, Global test loss: 2.160, Global test accuracy: 19.58
Round  58, Train loss: 1.365, Test loss: 1.510, Test accuracy: 45.58
Round  58, Global train loss: 1.365, Global test loss: 2.173, Global test accuracy: 23.88
Round  59, Train loss: 1.604, Test loss: 1.519, Test accuracy: 44.50
Round  59, Global train loss: 1.604, Global test loss: 2.008, Global test accuracy: 31.64
Round  60, Train loss: 1.811, Test loss: 1.529, Test accuracy: 44.28
Round  60, Global train loss: 1.811, Global test loss: 2.217, Global test accuracy: 18.34
Round  61, Train loss: 1.791, Test loss: 1.539, Test accuracy: 41.08
Round  61, Global train loss: 1.791, Global test loss: 2.193, Global test accuracy: 24.92
Round  62, Train loss: 1.586, Test loss: 1.534, Test accuracy: 42.58
Round  62, Global train loss: 1.586, Global test loss: 2.035, Global test accuracy: 23.70
Round  63, Train loss: 1.727, Test loss: 1.522, Test accuracy: 42.92
Round  63, Global train loss: 1.727, Global test loss: 2.292, Global test accuracy: 20.04
Round  64, Train loss: 1.552, Test loss: 1.521, Test accuracy: 42.58
Round  64, Global train loss: 1.552, Global test loss: 2.093, Global test accuracy: 21.24
Round  65, Train loss: 1.455, Test loss: 1.567, Test accuracy: 40.56
Round  65, Global train loss: 1.455, Global test loss: 2.357, Global test accuracy: 18.48
Round  66, Train loss: 1.747, Test loss: 1.565, Test accuracy: 40.94
Round  66, Global train loss: 1.747, Global test loss: 2.224, Global test accuracy: 19.82
Round  67, Train loss: 1.666, Test loss: 1.574, Test accuracy: 40.12
Round  67, Global train loss: 1.666, Global test loss: 2.445, Global test accuracy: 17.16
Round  68, Train loss: 1.537, Test loss: 1.573, Test accuracy: 39.76
Round  68, Global train loss: 1.537, Global test loss: 2.181, Global test accuracy: 19.36
Round  69, Train loss: 1.565, Test loss: 1.518, Test accuracy: 43.12
Round  69, Global train loss: 1.565, Global test loss: 2.143, Global test accuracy: 23.98
Round  70, Train loss: 1.670, Test loss: 1.550, Test accuracy: 41.16
Round  70, Global train loss: 1.670, Global test loss: 2.399, Global test accuracy: 19.86
Round  71, Train loss: 1.522, Test loss: 1.531, Test accuracy: 42.72
Round  71, Global train loss: 1.522, Global test loss: 2.197, Global test accuracy: 24.16
Round  72, Train loss: 1.684, Test loss: 1.560, Test accuracy: 40.14
Round  72, Global train loss: 1.684, Global test loss: 2.257, Global test accuracy: 19.26
Round  73, Train loss: 1.666, Test loss: 1.576, Test accuracy: 38.70
Round  73, Global train loss: 1.666, Global test loss: 2.256, Global test accuracy: 26.82
Round  74, Train loss: 1.674, Test loss: 1.600, Test accuracy: 37.68
Round  74, Global train loss: 1.674, Global test loss: 2.458, Global test accuracy: 14.40
Round  75, Train loss: 1.401, Test loss: 1.552, Test accuracy: 40.60
Round  75, Global train loss: 1.401, Global test loss: 2.087, Global test accuracy: 30.28
Round  76, Train loss: 1.612, Test loss: 1.542, Test accuracy: 40.68
Round  76, Global train loss: 1.612, Global test loss: 2.518, Global test accuracy: 16.80
Round  77, Train loss: 1.693, Test loss: 1.570, Test accuracy: 39.06
Round  77, Global train loss: 1.693, Global test loss: 2.270, Global test accuracy: 19.28
Round  78, Train loss: 1.280, Test loss: 1.532, Test accuracy: 42.26
Round  78, Global train loss: 1.280, Global test loss: 2.060, Global test accuracy: 36.42
Round  79, Train loss: 1.653, Test loss: 1.561, Test accuracy: 39.46
Round  79, Global train loss: 1.653, Global test loss: 2.305, Global test accuracy: 17.46
Round  80, Train loss: 1.651, Test loss: 1.549, Test accuracy: 40.80
Round  80, Global train loss: 1.651, Global test loss: 2.475, Global test accuracy: 21.80
Round  81, Train loss: 1.554, Test loss: 1.570, Test accuracy: 39.20
Round  81, Global train loss: 1.554, Global test loss: 2.265, Global test accuracy: 17.42
Round  82, Train loss: 1.565, Test loss: 1.613, Test accuracy: 36.16
Round  82, Global train loss: 1.565, Global test loss: 2.519, Global test accuracy: 17.28
Round  83, Train loss: 1.385, Test loss: 1.592, Test accuracy: 39.30
Round  83, Global train loss: 1.385, Global test loss: 2.048, Global test accuracy: 29.22
Round  84, Train loss: 1.468, Test loss: 1.619, Test accuracy: 37.82
Round  84, Global train loss: 1.468, Global test loss: 2.620, Global test accuracy: 14.44
Round  85, Train loss: 1.571, Test loss: 1.622, Test accuracy: 38.12
Round  85, Global train loss: 1.571, Global test loss: 2.522, Global test accuracy: 17.80
Round  86, Train loss: 1.364, Test loss: 1.608, Test accuracy: 38.90
Round  86, Global train loss: 1.364, Global test loss: 2.056, Global test accuracy: 26.78
Round  87, Train loss: 1.417, Test loss: 1.582, Test accuracy: 40.14
Round  87, Global train loss: 1.417, Global test loss: 2.335, Global test accuracy: 18.62
Round  88, Train loss: 1.286, Test loss: 1.591, Test accuracy: 39.04
Round  88, Global train loss: 1.286, Global test loss: 2.139, Global test accuracy: 25.60
Round  89, Train loss: 1.242, Test loss: 1.602, Test accuracy: 39.16
Round  89, Global train loss: 1.242, Global test loss: 2.030, Global test accuracy: 28.62
Round  90, Train loss: 1.237, Test loss: 1.625, Test accuracy: 38.22
Round  90, Global train loss: 1.237, Global test loss: 2.245, Global test accuracy: 19.04
Round  91, Train loss: 1.406, Test loss: 1.652, Test accuracy: 36.74
Round  91, Global train loss: 1.406, Global test loss: 2.434, Global test accuracy: 18.78
Round  92, Train loss: 1.564, Test loss: 1.673, Test accuracy: 37.00
Round  92, Global train loss: 1.564, Global test loss: 2.440, Global test accuracy: 15.98
Round  93, Train loss: 1.444, Test loss: 1.674, Test accuracy: 36.76
Round  93, Global train loss: 1.444, Global test loss: 2.388, Global test accuracy: 20.58
Round  94, Train loss: 1.178, Test loss: 1.605, Test accuracy: 38.92
Round  94, Global train loss: 1.178, Global test loss: 2.181, Global test accuracy: 32.16
Round  95, Train loss: 1.318, Test loss: 1.623, Test accuracy: 37.74
Round  95, Global train loss: 1.318, Global test loss: 2.016, Global test accuracy: 29.24
Round  96, Train loss: 1.475, Test loss: 1.655, Test accuracy: 37.10
Round  96, Global train loss: 1.475, Global test loss: 2.407, Global test accuracy: 18.70
Round  97, Train loss: 1.209, Test loss: 1.663, Test accuracy: 36.74
Round  97, Global train loss: 1.209, Global test loss: 2.139, Global test accuracy: 27.32
Round  98, Train loss: 1.373, Test loss: 1.630, Test accuracy: 38.52
Round  98, Global train loss: 1.373, Global test loss: 2.416, Global test accuracy: 18.44
Round  99, Train loss: 1.408, Test loss: 1.673, Test accuracy: 36.42
Round  99, Global train loss: 1.408, Global test loss: 2.389, Global test accuracy: 18.00
Final Round, Train loss: 1.209, Test loss: 1.738, Test accuracy: 35.70
Final Round, Global train loss: 1.209, Global test loss: 2.389, Global test accuracy: 18.00
Average accuracy final 10 rounds: 37.416000000000004
671.7918772697449
[1.6957228183746338, 3.0678060054779053, 4.4497199058532715, 5.830629348754883, 7.216084957122803, 8.579409837722778, 9.954399824142456, 11.3741455078125, 12.763669490814209, 14.10298490524292, 15.479153394699097, 16.85710072517395, 18.23013401031494, 19.579243421554565, 20.96129536628723, 22.288341283798218, 23.646799564361572, 25.033016204833984, 26.3764488697052, 27.745701551437378, 29.11566996574402, 30.493685245513916, 31.859020709991455, 33.22837281227112, 34.608579874038696, 35.95268774032593, 37.309810638427734, 38.662827491760254, 40.00571393966675, 41.37761950492859, 42.781830072402954, 44.410789489746094, 45.74197697639465, 47.09485626220703, 48.46443200111389, 49.83594346046448, 51.076066970825195, 52.36557865142822, 53.65143322944641, 54.90762114524841, 56.15868163108826, 57.403342485427856, 58.65436935424805, 59.9029643535614, 61.16491103172302, 62.41604995727539, 63.661128520965576, 64.95144081115723, 66.16595888137817, 67.4128794670105, 68.64921426773071, 69.89315485954285, 71.15454912185669, 72.41693902015686, 73.67773151397705, 74.95197558403015, 76.23144268989563, 77.5116708278656, 78.81884860992432, 80.12855291366577, 81.43988490104675, 82.73331952095032, 84.03579688072205, 85.35787296295166, 86.64416742324829, 88.09828329086304, 89.69071078300476, 90.9711799621582, 92.25288391113281, 93.57384657859802, 94.8686671257019, 96.18541216850281, 97.46123313903809, 98.69850897789001, 99.94442629814148, 101.20416402816772, 102.46123385429382, 103.74220943450928, 105.01401686668396, 106.29265689849854, 107.55083298683167, 108.80921268463135, 110.08154964447021, 111.3034098148346, 112.5495092868805, 113.84423542022705, 115.15595865249634, 116.42412829399109, 117.69033789634705, 118.99334478378296, 120.29101610183716, 121.55896520614624, 122.84182286262512, 124.1119635105133, 125.38267421722412, 126.67858815193176, 127.9540786743164, 129.25905919075012, 130.53871941566467, 131.7973484992981, 134.09407591819763]
[11.14, 21.08, 24.2, 22.56, 29.36, 32.9, 29.26, 33.44, 35.36, 38.44, 35.14, 37.24, 35.46, 36.2, 38.22, 38.1, 38.26, 38.64, 38.62, 38.78, 37.9, 40.36, 38.66, 38.0, 38.9, 41.76, 42.64, 41.76, 42.64, 41.78, 41.7, 40.16, 39.26, 41.86, 39.62, 41.0, 42.76, 41.18, 42.42, 43.48, 41.98, 42.6, 41.74, 42.24, 42.82, 42.64, 42.54, 41.74, 40.12, 41.3, 42.14, 43.82, 41.48, 43.18, 41.38, 41.52, 43.08, 42.68, 45.58, 44.5, 44.28, 41.08, 42.58, 42.92, 42.58, 40.56, 40.94, 40.12, 39.76, 43.12, 41.16, 42.72, 40.14, 38.7, 37.68, 40.6, 40.68, 39.06, 42.26, 39.46, 40.8, 39.2, 36.16, 39.3, 37.82, 38.12, 38.9, 40.14, 39.04, 39.16, 38.22, 36.74, 37.0, 36.76, 38.92, 37.74, 37.1, 36.74, 38.52, 36.42, 35.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar100,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 1063434 (local), 1062144 (global); Percentage 99.88 (1062144/1063434)
learning rate, batch size: 0.01, 10
CNNCifar100(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (drop): Dropout(p=0.6, inplace=False)
  (conv2): Conv2d(64, 128, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=3200, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=10, bias=True)
)
Round   0, Train loss: 2.137, Test loss: 2.084, Test accuracy: 22.04
Round   0, Global train loss: 2.137, Global test loss: 2.290, Global test accuracy: 12.08
Round   1, Train loss: 1.992, Test loss: 1.868, Test accuracy: 23.00
Round   1, Global train loss: 1.992, Global test loss: 2.282, Global test accuracy: 12.90
Round   2, Train loss: 1.944, Test loss: 1.803, Test accuracy: 27.46
Round   2, Global train loss: 1.944, Global test loss: 2.263, Global test accuracy: 14.46
Round   3, Train loss: 1.920, Test loss: 1.764, Test accuracy: 30.24
Round   3, Global train loss: 1.920, Global test loss: 2.247, Global test accuracy: 14.94
Round   4, Train loss: 1.905, Test loss: 1.740, Test accuracy: 31.98
Round   4, Global train loss: 1.905, Global test loss: 2.244, Global test accuracy: 15.28
Round   5, Train loss: 1.891, Test loss: 1.719, Test accuracy: 32.28
Round   5, Global train loss: 1.891, Global test loss: 2.236, Global test accuracy: 15.74
Round   6, Train loss: 1.880, Test loss: 1.705, Test accuracy: 34.20
Round   6, Global train loss: 1.880, Global test loss: 2.226, Global test accuracy: 15.42
Round   7, Train loss: 1.871, Test loss: 1.703, Test accuracy: 34.88
Round   7, Global train loss: 1.871, Global test loss: 2.216, Global test accuracy: 14.54
Round   8, Train loss: 1.864, Test loss: 1.691, Test accuracy: 35.78
Round   8, Global train loss: 1.864, Global test loss: 2.208, Global test accuracy: 14.80
Round   9, Train loss: 1.856, Test loss: 1.684, Test accuracy: 36.02
Round   9, Global train loss: 1.856, Global test loss: 2.207, Global test accuracy: 13.56
Round  10, Train loss: 1.830, Test loss: 1.689, Test accuracy: 35.36
Round  10, Global train loss: 1.830, Global test loss: 2.514, Global test accuracy: 15.04
Round  11, Train loss: 1.589, Test loss: 1.625, Test accuracy: 33.66
Round  11, Global train loss: 1.589, Global test loss: 2.709, Global test accuracy: 11.80
Round  12, Train loss: 1.640, Test loss: 1.629, Test accuracy: 36.56
Round  12, Global train loss: 1.640, Global test loss: 2.195, Global test accuracy: 24.96
Round  13, Train loss: 1.672, Test loss: 1.627, Test accuracy: 35.70
Round  13, Global train loss: 1.672, Global test loss: 2.223, Global test accuracy: 28.56
Round  14, Train loss: 1.631, Test loss: 1.594, Test accuracy: 36.64
Round  14, Global train loss: 1.631, Global test loss: 2.270, Global test accuracy: 14.30
Round  15, Train loss: 1.513, Test loss: 1.599, Test accuracy: 33.78
Round  15, Global train loss: 1.513, Global test loss: 2.936, Global test accuracy: 11.78
Round  16, Train loss: 1.559, Test loss: 1.581, Test accuracy: 36.08
Round  16, Global train loss: 1.559, Global test loss: 2.617, Global test accuracy: 12.36
Round  17, Train loss: 1.639, Test loss: 1.600, Test accuracy: 36.40
Round  17, Global train loss: 1.639, Global test loss: 2.391, Global test accuracy: 12.72
Round  18, Train loss: 1.653, Test loss: 1.581, Test accuracy: 39.30
Round  18, Global train loss: 1.653, Global test loss: 2.055, Global test accuracy: 25.06
Round  19, Train loss: 1.613, Test loss: 1.580, Test accuracy: 37.80
Round  19, Global train loss: 1.613, Global test loss: 2.153, Global test accuracy: 23.20
Round  20, Train loss: 1.581, Test loss: 1.586, Test accuracy: 38.00
Round  20, Global train loss: 1.581, Global test loss: 2.138, Global test accuracy: 26.94
Round  21, Train loss: 1.628, Test loss: 1.558, Test accuracy: 40.48
Round  21, Global train loss: 1.628, Global test loss: 2.233, Global test accuracy: 18.26
Round  22, Train loss: 1.536, Test loss: 1.549, Test accuracy: 40.78
Round  22, Global train loss: 1.536, Global test loss: 2.506, Global test accuracy: 14.30
Round  23, Train loss: 1.565, Test loss: 1.561, Test accuracy: 39.82
Round  23, Global train loss: 1.565, Global test loss: 2.465, Global test accuracy: 14.22
Round  24, Train loss: 1.596, Test loss: 1.570, Test accuracy: 36.68
Round  24, Global train loss: 1.596, Global test loss: 2.429, Global test accuracy: 18.48
Round  25, Train loss: 1.577, Test loss: 1.577, Test accuracy: 35.28
Round  25, Global train loss: 1.577, Global test loss: 2.334, Global test accuracy: 24.54
Round  26, Train loss: 1.536, Test loss: 1.551, Test accuracy: 36.54
Round  26, Global train loss: 1.536, Global test loss: 2.467, Global test accuracy: 15.04
Round  27, Train loss: 1.579, Test loss: 1.553, Test accuracy: 36.86
Round  27, Global train loss: 1.579, Global test loss: 2.328, Global test accuracy: 21.26
Round  28, Train loss: 1.508, Test loss: 1.542, Test accuracy: 40.00
Round  28, Global train loss: 1.508, Global test loss: 2.426, Global test accuracy: 17.36
Round  29, Train loss: 1.667, Test loss: 1.547, Test accuracy: 39.68
Round  29, Global train loss: 1.667, Global test loss: 2.248, Global test accuracy: 21.10
Round  30, Train loss: 1.577, Test loss: 1.535, Test accuracy: 40.36
Round  30, Global train loss: 1.577, Global test loss: 2.438, Global test accuracy: 11.56
Round  31, Train loss: 1.570, Test loss: 1.533, Test accuracy: 38.54
Round  31, Global train loss: 1.570, Global test loss: 2.396, Global test accuracy: 14.00
Round  32, Train loss: 1.515, Test loss: 1.570, Test accuracy: 39.14
Round  32, Global train loss: 1.515, Global test loss: 2.292, Global test accuracy: 26.50
Round  33, Train loss: 1.488, Test loss: 1.573, Test accuracy: 38.74
Round  33, Global train loss: 1.488, Global test loss: 2.482, Global test accuracy: 14.10
Round  34, Train loss: 1.582, Test loss: 1.570, Test accuracy: 38.24
Round  34, Global train loss: 1.582, Global test loss: 2.498, Global test accuracy: 12.20
Round  35, Train loss: 1.618, Test loss: 1.552, Test accuracy: 37.26
Round  35, Global train loss: 1.618, Global test loss: 2.223, Global test accuracy: 21.78
Round  36, Train loss: 1.509, Test loss: 1.551, Test accuracy: 38.82
Round  36, Global train loss: 1.509, Global test loss: 2.893, Global test accuracy: 15.44
Round  37, Train loss: 1.537, Test loss: 1.558, Test accuracy: 40.96
Round  37, Global train loss: 1.537, Global test loss: 2.135, Global test accuracy: 27.06
Round  38, Train loss: 1.605, Test loss: 1.555, Test accuracy: 40.06
Round  38, Global train loss: 1.605, Global test loss: 2.167, Global test accuracy: 19.54
Round  39, Train loss: 1.559, Test loss: 1.571, Test accuracy: 40.36
Round  39, Global train loss: 1.559, Global test loss: 2.545, Global test accuracy: 11.86
Round  40, Train loss: 1.595, Test loss: 1.573, Test accuracy: 40.84
Round  40, Global train loss: 1.595, Global test loss: 2.182, Global test accuracy: 13.72
Round  41, Train loss: 1.588, Test loss: 1.553, Test accuracy: 41.52
Round  41, Global train loss: 1.588, Global test loss: 2.202, Global test accuracy: 18.54
Round  42, Train loss: 1.548, Test loss: 1.582, Test accuracy: 38.26
Round  42, Global train loss: 1.548, Global test loss: 2.326, Global test accuracy: 13.60
Round  43, Train loss: 1.442, Test loss: 1.571, Test accuracy: 38.50
Round  43, Global train loss: 1.442, Global test loss: 2.371, Global test accuracy: 18.44
Round  44, Train loss: 1.555, Test loss: 1.557, Test accuracy: 38.88
Round  44, Global train loss: 1.555, Global test loss: 2.193, Global test accuracy: 18.64
Round  45, Train loss: 1.505, Test loss: 1.509, Test accuracy: 41.64
Round  45, Global train loss: 1.505, Global test loss: 2.297, Global test accuracy: 18.98
Round  46, Train loss: 1.515, Test loss: 1.521, Test accuracy: 39.86
Round  46, Global train loss: 1.515, Global test loss: 2.530, Global test accuracy: 13.90
Round  47, Train loss: 1.469, Test loss: 1.545, Test accuracy: 40.46
Round  47, Global train loss: 1.469, Global test loss: 2.028, Global test accuracy: 33.60
Round  48, Train loss: 1.519, Test loss: 1.534, Test accuracy: 41.38
Round  48, Global train loss: 1.519, Global test loss: 2.375, Global test accuracy: 13.64
Round  49, Train loss: 1.541, Test loss: 1.541, Test accuracy: 38.44
Round  49, Global train loss: 1.541, Global test loss: 2.286, Global test accuracy: 17.82
Round  50, Train loss: 1.460, Test loss: 1.526, Test accuracy: 42.22
Round  50, Global train loss: 1.460, Global test loss: 1.956, Global test accuracy: 29.56
Round  51, Train loss: 1.460, Test loss: 1.526, Test accuracy: 41.70
Round  51, Global train loss: 1.460, Global test loss: 2.147, Global test accuracy: 13.94
Round  52, Train loss: 1.503, Test loss: 1.511, Test accuracy: 42.64
Round  52, Global train loss: 1.503, Global test loss: 2.248, Global test accuracy: 17.36
Round  53, Train loss: 1.453, Test loss: 1.532, Test accuracy: 41.10
Round  53, Global train loss: 1.453, Global test loss: 2.327, Global test accuracy: 21.88
Round  54, Train loss: 1.419, Test loss: 1.507, Test accuracy: 42.90
Round  54, Global train loss: 1.419, Global test loss: 2.687, Global test accuracy: 13.78
Round  55, Train loss: 1.463, Test loss: 1.516, Test accuracy: 41.02
Round  55, Global train loss: 1.463, Global test loss: 2.506, Global test accuracy: 17.26
Round  56, Train loss: 1.433, Test loss: 1.516, Test accuracy: 42.10
Round  56, Global train loss: 1.433, Global test loss: 2.061, Global test accuracy: 32.80
Round  57, Train loss: 1.481, Test loss: 1.549, Test accuracy: 39.44
Round  57, Global train loss: 1.481, Global test loss: 2.428, Global test accuracy: 14.78
Round  58, Train loss: 1.497, Test loss: 1.582, Test accuracy: 36.98
Round  58, Global train loss: 1.497, Global test loss: 2.505, Global test accuracy: 17.04
Round  59, Train loss: 1.419, Test loss: 1.635, Test accuracy: 35.16
Round  59, Global train loss: 1.419, Global test loss: 2.441, Global test accuracy: 16.06
Round  60, Train loss: 1.411, Test loss: 1.567, Test accuracy: 39.80
Round  60, Global train loss: 1.411, Global test loss: 2.421, Global test accuracy: 18.24
Round  61, Train loss: 1.509, Test loss: 1.552, Test accuracy: 40.84
Round  61, Global train loss: 1.509, Global test loss: 2.347, Global test accuracy: 23.68
Round  62, Train loss: 1.326, Test loss: 1.529, Test accuracy: 41.80
Round  62, Global train loss: 1.326, Global test loss: 2.336, Global test accuracy: 21.00
Round  63, Train loss: 1.405, Test loss: 1.544, Test accuracy: 40.36
Round  63, Global train loss: 1.405, Global test loss: 2.335, Global test accuracy: 24.82
Round  64, Train loss: 1.342, Test loss: 1.565, Test accuracy: 39.90
Round  64, Global train loss: 1.342, Global test loss: 2.600, Global test accuracy: 12.70
Round  65, Train loss: 1.450, Test loss: 1.557, Test accuracy: 39.62
Round  65, Global train loss: 1.450, Global test loss: 2.204, Global test accuracy: 21.48
Round  66, Train loss: 1.542, Test loss: 1.578, Test accuracy: 37.02
Round  66, Global train loss: 1.542, Global test loss: 2.275, Global test accuracy: 18.32
Round  67, Train loss: 1.349, Test loss: 1.547, Test accuracy: 39.22
Round  67, Global train loss: 1.349, Global test loss: 2.368, Global test accuracy: 20.66
Round  68, Train loss: 1.451, Test loss: 1.615, Test accuracy: 36.04
Round  68, Global train loss: 1.451, Global test loss: 2.569, Global test accuracy: 13.66
Round  69, Train loss: 1.460, Test loss: 1.614, Test accuracy: 35.60
Round  69, Global train loss: 1.460, Global test loss: 2.531, Global test accuracy: 16.44
Round  70, Train loss: 1.441, Test loss: 1.552, Test accuracy: 39.16
Round  70, Global train loss: 1.441, Global test loss: 2.273, Global test accuracy: 21.82
Round  71, Train loss: 1.533, Test loss: 1.597, Test accuracy: 36.32
Round  71, Global train loss: 1.533, Global test loss: 2.526, Global test accuracy: 14.08
Round  72, Train loss: 1.355, Test loss: 1.577, Test accuracy: 37.28
Round  72, Global train loss: 1.355, Global test loss: 2.257, Global test accuracy: 17.70
Round  73, Train loss: 1.362, Test loss: 1.557, Test accuracy: 40.48
Round  73, Global train loss: 1.362, Global test loss: 2.288, Global test accuracy: 28.58
Round  74, Train loss: 1.392, Test loss: 1.550, Test accuracy: 39.74
Round  74, Global train loss: 1.392, Global test loss: 2.132, Global test accuracy: 26.56
Round  75, Train loss: 1.364, Test loss: 1.582, Test accuracy: 37.88
Round  75, Global train loss: 1.364, Global test loss: 2.247, Global test accuracy: 19.16
Round  76, Train loss: 1.358, Test loss: 1.535, Test accuracy: 39.74
Round  76, Global train loss: 1.358, Global test loss: 1.979, Global test accuracy: 33.66
Round  77, Train loss: 1.376, Test loss: 1.600, Test accuracy: 36.66
Round  77, Global train loss: 1.376, Global test loss: 2.560, Global test accuracy: 16.58
Round  78, Train loss: 1.262, Test loss: 1.600, Test accuracy: 36.80
Round  78, Global train loss: 1.262, Global test loss: 2.529, Global test accuracy: 11.76
Round  79, Train loss: 1.363, Test loss: 1.621, Test accuracy: 35.68
Round  79, Global train loss: 1.363, Global test loss: 2.612, Global test accuracy: 13.06
Round  80, Train loss: 1.328, Test loss: 1.610, Test accuracy: 37.10
Round  80, Global train loss: 1.328, Global test loss: 2.205, Global test accuracy: 26.50
Round  81, Train loss: 1.267, Test loss: 1.599, Test accuracy: 38.18
Round  81, Global train loss: 1.267, Global test loss: 2.166, Global test accuracy: 28.02
Round  82, Train loss: 1.240, Test loss: 1.593, Test accuracy: 38.06
Round  82, Global train loss: 1.240, Global test loss: 2.153, Global test accuracy: 27.92
Round  83, Train loss: 1.215, Test loss: 1.596, Test accuracy: 38.30
Round  83, Global train loss: 1.215, Global test loss: 2.165, Global test accuracy: 28.28
Round  84, Train loss: 1.174, Test loss: 1.606, Test accuracy: 37.46
Round  84, Global train loss: 1.174, Global test loss: 2.163, Global test accuracy: 28.54
Round  85, Train loss: 1.155, Test loss: 1.604, Test accuracy: 37.56
Round  85, Global train loss: 1.155, Global test loss: 2.167, Global test accuracy: 29.06
Round  86, Train loss: 1.125, Test loss: 1.619, Test accuracy: 36.98
Round  86, Global train loss: 1.125, Global test loss: 2.189, Global test accuracy: 28.16
Round  87, Train loss: 1.095, Test loss: 1.611, Test accuracy: 38.02
Round  87, Global train loss: 1.095, Global test loss: 2.173, Global test accuracy: 27.78
Round  88, Train loss: 1.086, Test loss: 1.629, Test accuracy: 37.58
Round  88, Global train loss: 1.086, Global test loss: 2.230, Global test accuracy: 27.20
Round  89, Train loss: 1.040, Test loss: 1.639, Test accuracy: 37.64
Round  89, Global train loss: 1.040, Global test loss: 2.227, Global test accuracy: 27.70
Round  90, Train loss: 1.021, Test loss: 1.682, Test accuracy: 36.44
Round  90, Global train loss: 1.021, Global test loss: 2.278, Global test accuracy: 26.70
Round  91, Train loss: 0.993, Test loss: 1.679, Test accuracy: 36.42
Round  91, Global train loss: 0.993, Global test loss: 2.270, Global test accuracy: 26.88
Round  92, Train loss: 0.972, Test loss: 1.673, Test accuracy: 37.06
Round  92, Global train loss: 0.972, Global test loss: 2.265, Global test accuracy: 27.42
Round  93, Train loss: 0.949, Test loss: 1.677, Test accuracy: 36.34
Round  93, Global train loss: 0.949, Global test loss: 2.257, Global test accuracy: 27.22
Round  94, Train loss: 0.917, Test loss: 1.686, Test accuracy: 37.08
Round  94, Global train loss: 0.917, Global test loss: 2.276, Global test accuracy: 28.48
Round  95, Train loss: 0.908, Test loss: 1.707, Test accuracy: 35.66
Round  95, Global train loss: 0.908, Global test loss: 2.296, Global test accuracy: 26.12
Round  96, Train loss: 0.885, Test loss: 1.708, Test accuracy: 36.44
Round  96, Global train loss: 0.885, Global test loss: 2.346, Global test accuracy: 27.52
Round  97, Train loss: 0.854, Test loss: 1.741, Test accuracy: 35.42
Round  97, Global train loss: 0.854, Global test loss: 2.338, Global test accuracy: 26.30
Round  98, Train loss: 0.816, Test loss: 1.714, Test accuracy: 36.18
Round  98, Global train loss: 0.816, Global test loss: 2.292, Global test accuracy: 28.62
Round  99, Train loss: 1.127, Test loss: 1.706, Test accuracy: 37.82
Round  99, Global train loss: 1.127, Global test loss: 2.095, Global test accuracy: 25.50
Final Round, Train loss: 1.067, Test loss: 1.762, Test accuracy: 37.22
Final Round, Global train loss: 1.067, Global test loss: 2.095, Global test accuracy: 25.50
Average accuracy final 10 rounds: 36.486000000000004
1951.6833157539368
[1.9255516529083252, 3.534876823425293, 5.0914366245269775, 6.660383224487305, 8.251372575759888, 10.080390453338623, 11.645971775054932, 13.191704511642456, 14.7387535572052, 16.291590690612793, 21.672881364822388, 29.883865356445312, 38.03771638870239, 46.31990885734558, 54.46691155433655, 62.61592197418213, 70.58081150054932, 78.64320874214172, 86.73168063163757, 94.88569736480713, 102.94009375572205, 110.98045349121094, 119.17481684684753, 127.68618750572205, 135.69895315170288, 143.59651160240173, 151.66708636283875, 159.77925062179565, 167.86887764930725, 175.81702947616577, 183.83899021148682, 191.82787489891052, 199.85279202461243, 207.85338139533997, 215.81593871116638, 223.95882439613342, 231.9268491268158, 240.09041500091553, 248.13543725013733, 256.14426136016846, 264.1110517978668, 272.04624819755554, 280.3833718299866, 288.35601234436035, 296.40536999702454, 304.5117552280426, 312.8755741119385, 321.1275200843811, 329.12932205200195, 337.07487201690674, 345.29665184020996, 353.2749729156494, 361.42122745513916, 369.3133556842804, 377.20269894599915, 385.1836369037628, 393.06054306030273, 401.2174160480499, 409.1067547798157, 417.0018093585968, 424.91372060775757, 432.82622504234314, 440.84051489830017, 448.91548013687134, 456.89512872695923, 464.7733359336853, 472.5289840698242, 480.24331617355347, 487.6774437427521, 495.1154601573944, 502.6347653865814, 510.06577610969543, 517.6672608852386, 525.471755027771, 532.9241914749146, 540.3457381725311, 547.6760051250458, 555.0078322887421, 562.5557126998901, 570.0397698879242, 571.4899663925171, 572.9469480514526, 574.4048037528992, 575.8321349620819, 577.2911512851715, 578.745847940445, 580.188072681427, 581.625123500824, 583.0705690383911, 584.4974956512451, 585.9999470710754, 587.729154586792, 589.1856038570404, 590.6266465187073, 592.073593378067, 593.5322835445404, 594.992832660675, 596.4480895996094, 597.8924686908722, 605.5443255901337, 614.028783082962]
[22.04, 23.0, 27.46, 30.24, 31.98, 32.28, 34.2, 34.88, 35.78, 36.02, 35.36, 33.66, 36.56, 35.7, 36.64, 33.78, 36.08, 36.4, 39.3, 37.8, 38.0, 40.48, 40.78, 39.82, 36.68, 35.28, 36.54, 36.86, 40.0, 39.68, 40.36, 38.54, 39.14, 38.74, 38.24, 37.26, 38.82, 40.96, 40.06, 40.36, 40.84, 41.52, 38.26, 38.5, 38.88, 41.64, 39.86, 40.46, 41.38, 38.44, 42.22, 41.7, 42.64, 41.1, 42.9, 41.02, 42.1, 39.44, 36.98, 35.16, 39.8, 40.84, 41.8, 40.36, 39.9, 39.62, 37.02, 39.22, 36.04, 35.6, 39.16, 36.32, 37.28, 40.48, 39.74, 37.88, 39.74, 36.66, 36.8, 35.68, 37.1, 38.18, 38.06, 38.3, 37.46, 37.56, 36.98, 38.02, 37.58, 37.64, 36.44, 36.42, 37.06, 36.34, 37.08, 35.66, 36.44, 35.42, 36.18, 37.82, 37.22]
