nohup: ignoring input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 4, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.536, Test loss: 2.112, Test accuracy: 21.31
Round   0, Global train loss: 1.536, Global test loss: 2.365, Global test accuracy: 15.04
Round   1, Train loss: 1.430, Test loss: 1.616, Test accuracy: 35.19
Round   1, Global train loss: 1.430, Global test loss: 2.154, Global test accuracy: 22.70
Round   2, Train loss: 1.282, Test loss: 1.538, Test accuracy: 36.42
Round   2, Global train loss: 1.282, Global test loss: 2.247, Global test accuracy: 16.14
Round   3, Train loss: 1.314, Test loss: 1.421, Test accuracy: 39.79
Round   3, Global train loss: 1.314, Global test loss: 2.270, Global test accuracy: 18.76
Round   4, Train loss: 1.221, Test loss: 1.411, Test accuracy: 40.95
Round   4, Global train loss: 1.221, Global test loss: 2.220, Global test accuracy: 19.91
Round   5, Train loss: 1.196, Test loss: 1.413, Test accuracy: 42.46
Round   5, Global train loss: 1.196, Global test loss: 2.249, Global test accuracy: 21.91
Round   6, Train loss: 1.215, Test loss: 1.267, Test accuracy: 48.65
Round   6, Global train loss: 1.215, Global test loss: 2.273, Global test accuracy: 22.20
Round   7, Train loss: 1.325, Test loss: 1.230, Test accuracy: 47.38
Round   7, Global train loss: 1.325, Global test loss: 2.164, Global test accuracy: 23.70
Round   8, Train loss: 1.196, Test loss: 1.212, Test accuracy: 48.90
Round   8, Global train loss: 1.196, Global test loss: 2.165, Global test accuracy: 21.59
Round   9, Train loss: 1.138, Test loss: 1.216, Test accuracy: 48.71
Round   9, Global train loss: 1.138, Global test loss: 2.194, Global test accuracy: 20.65
Round  10, Train loss: 1.289, Test loss: 1.205, Test accuracy: 50.80
Round  10, Global train loss: 1.289, Global test loss: 2.164, Global test accuracy: 28.45
Round  11, Train loss: 1.185, Test loss: 1.197, Test accuracy: 49.84
Round  11, Global train loss: 1.185, Global test loss: 2.234, Global test accuracy: 19.09
Round  12, Train loss: 1.273, Test loss: 1.090, Test accuracy: 53.62
Round  12, Global train loss: 1.273, Global test loss: 2.137, Global test accuracy: 25.89
Round  13, Train loss: 1.281, Test loss: 1.086, Test accuracy: 53.19
Round  13, Global train loss: 1.281, Global test loss: 2.183, Global test accuracy: 29.84
Round  14, Train loss: 1.054, Test loss: 1.072, Test accuracy: 54.33
Round  14, Global train loss: 1.054, Global test loss: 2.129, Global test accuracy: 25.76
Round  15, Train loss: 1.102, Test loss: 1.070, Test accuracy: 55.42
Round  15, Global train loss: 1.102, Global test loss: 2.184, Global test accuracy: 20.18
Round  16, Train loss: 1.108, Test loss: 1.076, Test accuracy: 54.65
Round  16, Global train loss: 1.108, Global test loss: 2.069, Global test accuracy: 26.94
Round  17, Train loss: 1.046, Test loss: 1.066, Test accuracy: 55.23
Round  17, Global train loss: 1.046, Global test loss: 2.206, Global test accuracy: 26.39
Round  18, Train loss: 1.031, Test loss: 1.055, Test accuracy: 56.19
Round  18, Global train loss: 1.031, Global test loss: 2.103, Global test accuracy: 26.80
Round  19, Train loss: 1.103, Test loss: 1.050, Test accuracy: 56.35
Round  19, Global train loss: 1.103, Global test loss: 2.112, Global test accuracy: 23.64
Round  20, Train loss: 1.038, Test loss: 1.052, Test accuracy: 56.58
Round  20, Global train loss: 1.038, Global test loss: 2.393, Global test accuracy: 11.49
Round  21, Train loss: 1.143, Test loss: 1.054, Test accuracy: 56.91
Round  21, Global train loss: 1.143, Global test loss: 2.150, Global test accuracy: 24.23
Round  22, Train loss: 1.080, Test loss: 1.047, Test accuracy: 57.23
Round  22, Global train loss: 1.080, Global test loss: 2.152, Global test accuracy: 17.21
Round  23, Train loss: 1.086, Test loss: 1.039, Test accuracy: 57.49
Round  23, Global train loss: 1.086, Global test loss: 2.169, Global test accuracy: 28.24
Round  24, Train loss: 1.113, Test loss: 1.048, Test accuracy: 57.51
Round  24, Global train loss: 1.113, Global test loss: 2.154, Global test accuracy: 20.05
Round  25, Train loss: 0.963, Test loss: 1.053, Test accuracy: 57.74
Round  25, Global train loss: 0.963, Global test loss: 2.123, Global test accuracy: 21.09
Round  26, Train loss: 0.906, Test loss: 1.073, Test accuracy: 57.92
Round  26, Global train loss: 0.906, Global test loss: 2.195, Global test accuracy: 27.48
Round  27, Train loss: 0.914, Test loss: 1.073, Test accuracy: 57.76
Round  27, Global train loss: 0.914, Global test loss: 2.287, Global test accuracy: 17.04
Round  28, Train loss: 0.837, Test loss: 1.067, Test accuracy: 57.51
Round  28, Global train loss: 0.837, Global test loss: 2.043, Global test accuracy: 30.21
Round  29, Train loss: 0.994, Test loss: 1.061, Test accuracy: 57.69
Round  29, Global train loss: 0.994, Global test loss: 2.202, Global test accuracy: 23.09
Round  30, Train loss: 0.894, Test loss: 1.073, Test accuracy: 57.80
Round  30, Global train loss: 0.894, Global test loss: 2.097, Global test accuracy: 25.80
Round  31, Train loss: 0.766, Test loss: 1.081, Test accuracy: 57.88
Round  31, Global train loss: 0.766, Global test loss: 2.124, Global test accuracy: 26.09
Round  32, Train loss: 0.981, Test loss: 1.061, Test accuracy: 58.69
Round  32, Global train loss: 0.981, Global test loss: 2.269, Global test accuracy: 11.46
Round  33, Train loss: 0.961, Test loss: 1.074, Test accuracy: 58.65
Round  33, Global train loss: 0.961, Global test loss: 2.320, Global test accuracy: 18.51
Round  34, Train loss: 0.977, Test loss: 1.072, Test accuracy: 58.26
Round  34, Global train loss: 0.977, Global test loss: 2.129, Global test accuracy: 30.29
Round  35, Train loss: 0.929, Test loss: 1.093, Test accuracy: 57.86
Round  35, Global train loss: 0.929, Global test loss: 2.119, Global test accuracy: 26.54
Round  36, Train loss: 0.738, Test loss: 1.099, Test accuracy: 58.23
Round  36, Global train loss: 0.738, Global test loss: 2.149, Global test accuracy: 28.66
Round  37, Train loss: 0.674, Test loss: 1.134, Test accuracy: 58.24
Round  37, Global train loss: 0.674, Global test loss: 2.030, Global test accuracy: 30.12
Round  38, Train loss: 0.825, Test loss: 1.125, Test accuracy: 58.16
Round  38, Global train loss: 0.825, Global test loss: 2.568, Global test accuracy: 21.81
Round  39, Train loss: 0.788, Test loss: 1.140, Test accuracy: 58.48
Round  39, Global train loss: 0.788, Global test loss: 2.104, Global test accuracy: 26.77
Round  40, Train loss: 0.911, Test loss: 1.135, Test accuracy: 58.62
Round  40, Global train loss: 0.911, Global test loss: 2.098, Global test accuracy: 28.44
Round  41, Train loss: 0.842, Test loss: 1.137, Test accuracy: 58.04
Round  41, Global train loss: 0.842, Global test loss: 2.326, Global test accuracy: 18.35
Round  42, Train loss: 0.665, Test loss: 1.124, Test accuracy: 58.49
Round  42, Global train loss: 0.665, Global test loss: 2.109, Global test accuracy: 22.75
Round  43, Train loss: 0.621, Test loss: 1.180, Test accuracy: 57.73
Round  43, Global train loss: 0.621, Global test loss: 2.253, Global test accuracy: 22.60
Round  44, Train loss: 0.719, Test loss: 1.163, Test accuracy: 58.54
Round  44, Global train loss: 0.719, Global test loss: 2.184, Global test accuracy: 19.91
Round  45, Train loss: 0.606, Test loss: 1.175, Test accuracy: 58.24
Round  45, Global train loss: 0.606, Global test loss: 2.115, Global test accuracy: 23.74
Round  46, Train loss: 0.549, Test loss: 1.227, Test accuracy: 57.91
Round  46, Global train loss: 0.549, Global test loss: 2.063, Global test accuracy: 27.93
Round  47, Train loss: 0.707, Test loss: 1.234, Test accuracy: 57.71
Round  47, Global train loss: 0.707, Global test loss: 2.098, Global test accuracy: 28.85
Round  48, Train loss: 0.645, Test loss: 1.226, Test accuracy: 57.88
Round  48, Global train loss: 0.645, Global test loss: 2.119, Global test accuracy: 24.51
Round  49, Train loss: 0.549, Test loss: 1.231, Test accuracy: 58.19
Round  49, Global train loss: 0.549, Global test loss: 2.106, Global test accuracy: 27.24
Round  50, Train loss: 0.725, Test loss: 1.255, Test accuracy: 58.29
Round  50, Global train loss: 0.725, Global test loss: 2.173, Global test accuracy: 26.11
Round  51, Train loss: 0.533, Test loss: 1.263, Test accuracy: 57.88
Round  51, Global train loss: 0.533, Global test loss: 2.063, Global test accuracy: 25.76
Round  52, Train loss: 0.493, Test loss: 1.296, Test accuracy: 57.51
Round  52, Global train loss: 0.493, Global test loss: 2.041, Global test accuracy: 30.43
Round  53, Train loss: 0.557, Test loss: 1.329, Test accuracy: 56.56
Round  53, Global train loss: 0.557, Global test loss: 2.104, Global test accuracy: 23.64
Round  54, Train loss: 0.463, Test loss: 1.342, Test accuracy: 57.21
Round  54, Global train loss: 0.463, Global test loss: 2.241, Global test accuracy: 23.61
Round  55, Train loss: 0.412, Test loss: 1.365, Test accuracy: 56.81
Round  55, Global train loss: 0.412, Global test loss: 2.063, Global test accuracy: 28.71
Round  56, Train loss: 0.601, Test loss: 1.391, Test accuracy: 56.66
Round  56, Global train loss: 0.601, Global test loss: 2.142, Global test accuracy: 20.31
Round  57, Train loss: 0.471, Test loss: 1.390, Test accuracy: 57.20
Round  57, Global train loss: 0.471, Global test loss: 2.137, Global test accuracy: 23.71
Round  58, Train loss: 0.365, Test loss: 1.425, Test accuracy: 57.19
Round  58, Global train loss: 0.365, Global test loss: 2.113, Global test accuracy: 27.41
Round  59, Train loss: 0.468, Test loss: 1.439, Test accuracy: 57.05
Round  59, Global train loss: 0.468, Global test loss: 2.069, Global test accuracy: 25.20
Round  60, Train loss: 0.515, Test loss: 1.451, Test accuracy: 57.31
Round  60, Global train loss: 0.515, Global test loss: 2.084, Global test accuracy: 29.06
Round  61, Train loss: 0.450, Test loss: 1.466, Test accuracy: 57.65
Round  61, Global train loss: 0.450, Global test loss: 2.093, Global test accuracy: 29.10
Round  62, Train loss: 0.454, Test loss: 1.459, Test accuracy: 57.61
Round  62, Global train loss: 0.454, Global test loss: 2.133, Global test accuracy: 28.19
Round  63, Train loss: 0.300, Test loss: 1.489, Test accuracy: 57.86
Round  63, Global train loss: 0.300, Global test loss: 2.090, Global test accuracy: 22.82
Round  64, Train loss: 0.425, Test loss: 1.521, Test accuracy: 56.85
Round  64, Global train loss: 0.425, Global test loss: 2.042, Global test accuracy: 28.21
Round  65, Train loss: 0.393, Test loss: 1.580, Test accuracy: 56.50
Round  65, Global train loss: 0.393, Global test loss: 2.208, Global test accuracy: 25.29
Round  66, Train loss: 0.474, Test loss: 1.588, Test accuracy: 56.35
Round  66, Global train loss: 0.474, Global test loss: 2.127, Global test accuracy: 22.98
Round  67, Train loss: 0.380, Test loss: 1.617, Test accuracy: 56.35
Round  67, Global train loss: 0.380, Global test loss: 2.090, Global test accuracy: 24.77
Round  68, Train loss: 0.550, Test loss: 1.634, Test accuracy: 56.39
Round  68, Global train loss: 0.550, Global test loss: 2.111, Global test accuracy: 24.73
Round  69, Train loss: 0.376, Test loss: 1.658, Test accuracy: 55.67
Round  69, Global train loss: 0.376, Global test loss: 2.249, Global test accuracy: 15.16
Round  70, Train loss: 0.264, Test loss: 1.655, Test accuracy: 56.15
Round  70, Global train loss: 0.264, Global test loss: 2.154, Global test accuracy: 25.11
Round  71, Train loss: 0.273, Test loss: 1.642, Test accuracy: 56.56
Round  71, Global train loss: 0.273, Global test loss: 2.133, Global test accuracy: 26.30
Round  72, Train loss: 0.300, Test loss: 1.680, Test accuracy: 56.61
Round  72, Global train loss: 0.300, Global test loss: 1.973, Global test accuracy: 32.50
Round  73, Train loss: 0.328, Test loss: 1.689, Test accuracy: 56.52
Round  73, Global train loss: 0.328, Global test loss: 2.073, Global test accuracy: 30.68
Round  74, Train loss: 0.346, Test loss: 1.694, Test accuracy: 56.59
Round  74, Global train loss: 0.346, Global test loss: 2.230, Global test accuracy: 17.23
Round  75, Train loss: 0.292, Test loss: 1.702, Test accuracy: 56.90
Round  75, Global train loss: 0.292, Global test loss: 2.127, Global test accuracy: 29.55
Round  76, Train loss: 0.289, Test loss: 1.706, Test accuracy: 56.83
Round  76, Global train loss: 0.289, Global test loss: 2.098, Global test accuracy: 27.88
Round  77, Train loss: 0.234, Test loss: 1.720, Test accuracy: 57.08
Round  77, Global train loss: 0.234, Global test loss: 2.041, Global test accuracy: 26.71
Round  78, Train loss: 0.280, Test loss: 1.725, Test accuracy: 56.81
Round  78, Global train loss: 0.280, Global test loss: 2.075, Global test accuracy: 30.04
Round  79, Train loss: 0.348, Test loss: 1.746, Test accuracy: 56.71
Round  79, Global train loss: 0.348, Global test loss: 2.082, Global test accuracy: 26.34
Round  80, Train loss: 0.383, Test loss: 1.774, Test accuracy: 56.66
Round  80, Global train loss: 0.383, Global test loss: 2.107, Global test accuracy: 29.39
Round  81, Train loss: 0.306, Test loss: 1.839, Test accuracy: 56.08
Round  81, Global train loss: 0.306, Global test loss: 2.075, Global test accuracy: 27.54
Round  82, Train loss: 0.265, Test loss: 1.819, Test accuracy: 57.21
Round  82, Global train loss: 0.265, Global test loss: 2.034, Global test accuracy: 29.15
Round  83, Train loss: 0.249, Test loss: 1.872, Test accuracy: 56.81
Round  83, Global train loss: 0.249, Global test loss: 2.028, Global test accuracy: 27.43
Round  84, Train loss: 0.351, Test loss: 1.885, Test accuracy: 56.90
Round  84, Global train loss: 0.351, Global test loss: 2.053, Global test accuracy: 28.99
Round  85, Train loss: 0.180, Test loss: 1.890, Test accuracy: 57.21
Round  85, Global train loss: 0.180, Global test loss: 2.025, Global test accuracy: 29.77
Round  86, Train loss: 0.184, Test loss: 1.912, Test accuracy: 56.81
Round  86, Global train loss: 0.184, Global test loss: 1.980, Global test accuracy: 29.38
Round  87, Train loss: 0.320, Test loss: 2.044, Test accuracy: 55.90
Round  87, Global train loss: 0.320, Global test loss: 2.100, Global test accuracy: 24.85
Round  88, Train loss: 0.428, Test loss: 2.023, Test accuracy: 55.75
Round  88, Global train loss: 0.428, Global test loss: 2.137, Global test accuracy: 25.86
Round  89, Train loss: 0.277, Test loss: 2.102, Test accuracy: 55.11
Round  89, Global train loss: 0.277, Global test loss: 2.142, Global test accuracy: 23.70
Round  90, Train loss: 0.203, Test loss: 2.060, Test accuracy: 55.73
Round  90, Global train loss: 0.203, Global test loss: 2.095, Global test accuracy: 28.55
Round  91, Train loss: 0.220, Test loss: 2.026, Test accuracy: 55.95
Round  91, Global train loss: 0.220, Global test loss: 2.054, Global test accuracy: 27.15
Round  92, Train loss: 0.216, Test loss: 2.050, Test accuracy: 55.69
Round  92, Global train loss: 0.216, Global test loss: 2.087, Global test accuracy: 26.71
Round  93, Train loss: 0.319, Test loss: 2.091, Test accuracy: 55.67
Round  93, Global train loss: 0.319, Global test loss: 2.102, Global test accuracy: 29.02
Round  94, Train loss: 0.249, Test loss: 2.128, Test accuracy: 55.25
Round  94, Global train loss: 0.249, Global test loss: 2.122, Global test accuracy: 26.24
Round  95, Train loss: 0.204, Test loss: 2.174, Test accuracy: 55.61
Round  95, Global train loss: 0.204, Global test loss: 2.122, Global test accuracy: 25.80
Round  96, Train loss: 0.169, Test loss: 2.206, Test accuracy: 55.60
Round  96, Global train loss: 0.169, Global test loss: 2.070, Global test accuracy: 23.80
Round  97, Train loss: 0.183, Test loss: 2.170, Test accuracy: 55.91
Round  97, Global train loss: 0.183, Global test loss: 2.110, Global test accuracy: 29.00
Round  98, Train loss: 0.284, Test loss: 2.198, Test accuracy: 55.95
Round  98, Global train loss: 0.284, Global test loss: 2.153, Global test accuracy: 22.15
Round  99, Train loss: 0.157, Test loss: 2.200, Test accuracy: 55.73
Round  99, Global train loss: 0.157, Global test loss: 2.012, Global test accuracy: 30.77
Final Round, Train loss: 0.182, Test loss: 2.323, Test accuracy: 55.26
Final Round, Global train loss: 0.182, Global test loss: 2.012, Global test accuracy: 30.77
Average accuracy final 10 rounds: 55.70875 

Average global accuracy final 10 rounds: 26.92 

1452.7327094078064
[1.4769508838653564, 2.953901767730713, 4.359066486358643, 5.764231204986572, 7.016503572463989, 8.268775939941406, 9.466977596282959, 10.665179252624512, 11.994684219360352, 13.324189186096191, 14.716868162155151, 16.10954713821411, 17.444803476333618, 18.780059814453125, 20.25795865058899, 21.735857486724854, 22.887120008468628, 24.038382530212402, 25.728482723236084, 27.418582916259766, 28.56520175933838, 29.711820602416992, 31.233348846435547, 32.7548770904541, 34.01306891441345, 35.2712607383728, 36.560904026031494, 37.850547313690186, 39.29230999946594, 40.7340726852417, 42.27207064628601, 43.81006860733032, 45.03548002243042, 46.26089143753052, 47.925071001052856, 49.589250564575195, 50.78637194633484, 51.98349332809448, 53.32350182533264, 54.6635103225708, 55.91946983337402, 57.175429344177246, 58.40546655654907, 59.6355037689209, 60.871583461761475, 62.10766315460205, 63.35699462890625, 64.60632610321045, 65.99911379814148, 67.39190149307251, 68.58546233177185, 69.77902317047119, 70.9629077911377, 72.1467924118042, 73.39539051055908, 74.64398860931396, 75.92493844032288, 77.20588827133179, 78.36665892601013, 79.52742958068848, 80.89426350593567, 82.26109743118286, 83.66306948661804, 85.06504154205322, 86.29777646064758, 87.53051137924194, 88.808349609375, 90.08618783950806, 91.38261222839355, 92.67903661727905, 93.89567017555237, 95.11230373382568, 96.43248391151428, 97.75266408920288, 99.05528831481934, 100.35791254043579, 101.68307328224182, 103.00823402404785, 104.1528434753418, 105.29745292663574, 106.49188733100891, 107.68632173538208, 108.89634656906128, 110.10637140274048, 111.5730767250061, 113.03978204727173, 114.18632078170776, 115.3328595161438, 116.50743532180786, 117.68201112747192, 118.84120059013367, 120.00039005279541, 121.24842548370361, 122.49646091461182, 123.77922081947327, 125.06198072433472, 126.25891828536987, 127.45585584640503, 128.76227450370789, 130.06869316101074, 131.30185508728027, 132.5350170135498, 133.7668571472168, 134.9986972808838, 136.41066360473633, 137.82262992858887, 139.1367847919464, 140.45093965530396, 141.59982109069824, 142.74870252609253, 143.9130778312683, 145.0774531364441, 146.42043352127075, 147.7634139060974, 148.88065338134766, 149.9978928565979, 151.21163845062256, 152.42538404464722, 153.64005661010742, 154.85472917556763, 156.1026096343994, 157.3504900932312, 158.6094536781311, 159.868417263031, 160.98150372505188, 162.09459018707275, 163.3658766746521, 164.63716316223145, 165.92594623565674, 167.21472930908203, 168.43665218353271, 169.6585750579834, 170.77971768379211, 171.90086030960083, 173.09382247924805, 174.28678464889526, 175.4633777141571, 176.63997077941895, 177.86985850334167, 179.0997462272644, 180.36427974700928, 181.62881326675415, 182.98917651176453, 184.3495397567749, 185.51564764976501, 186.68175554275513, 187.8504614830017, 189.0191674232483, 190.26789140701294, 191.5166153907776, 192.68066120147705, 193.8447070121765, 195.00974297523499, 196.17477893829346, 197.3914966583252, 198.60821437835693, 199.74538564682007, 200.8825569152832, 202.12674188613892, 203.37092685699463, 204.55622553825378, 205.74152421951294, 207.0696358680725, 208.39774751663208, 209.601220369339, 210.8046932220459, 212.02226996421814, 213.23984670639038, 214.4607150554657, 215.68158340454102, 216.99005842208862, 218.29853343963623, 219.4883360862732, 220.67813873291016, 221.77760791778564, 222.87707710266113, 224.05863332748413, 225.24018955230713, 226.56471228599548, 227.88923501968384, 229.04896688461304, 230.20869874954224, 231.45739269256592, 232.7060866355896, 233.91568231582642, 235.12527799606323, 236.29777693748474, 237.47027587890625, 238.70608139038086, 239.94188690185547, 241.13291335105896, 242.32393980026245, 243.54120802879333, 244.75847625732422, 245.9898386001587, 247.22120094299316, 248.50711965560913, 249.7930383682251, 251.18420362472534, 252.5753688812256, 255.12991404533386, 257.68445920944214]
[21.3125, 21.3125, 35.1875, 35.1875, 36.425, 36.425, 39.7875, 39.7875, 40.95, 40.95, 42.4625, 42.4625, 48.65, 48.65, 47.375, 47.375, 48.9, 48.9, 48.7125, 48.7125, 50.8, 50.8, 49.8375, 49.8375, 53.625, 53.625, 53.1875, 53.1875, 54.325, 54.325, 55.425, 55.425, 54.65, 54.65, 55.225, 55.225, 56.1875, 56.1875, 56.35, 56.35, 56.575, 56.575, 56.9125, 56.9125, 57.225, 57.225, 57.4875, 57.4875, 57.5125, 57.5125, 57.7375, 57.7375, 57.925, 57.925, 57.7625, 57.7625, 57.5125, 57.5125, 57.6875, 57.6875, 57.8, 57.8, 57.875, 57.875, 58.6875, 58.6875, 58.65, 58.65, 58.2625, 58.2625, 57.8625, 57.8625, 58.225, 58.225, 58.2375, 58.2375, 58.1625, 58.1625, 58.475, 58.475, 58.625, 58.625, 58.0375, 58.0375, 58.4875, 58.4875, 57.725, 57.725, 58.5375, 58.5375, 58.2375, 58.2375, 57.9125, 57.9125, 57.7125, 57.7125, 57.875, 57.875, 58.1875, 58.1875, 58.2875, 58.2875, 57.875, 57.875, 57.5125, 57.5125, 56.5625, 56.5625, 57.2125, 57.2125, 56.8125, 56.8125, 56.6625, 56.6625, 57.2, 57.2, 57.1875, 57.1875, 57.05, 57.05, 57.3125, 57.3125, 57.65, 57.65, 57.6125, 57.6125, 57.8625, 57.8625, 56.85, 56.85, 56.5, 56.5, 56.35, 56.35, 56.35, 56.35, 56.3875, 56.3875, 55.675, 55.675, 56.15, 56.15, 56.5625, 56.5625, 56.6125, 56.6125, 56.525, 56.525, 56.5875, 56.5875, 56.9, 56.9, 56.825, 56.825, 57.075, 57.075, 56.8125, 56.8125, 56.7125, 56.7125, 56.6625, 56.6625, 56.075, 56.075, 57.2125, 57.2125, 56.8125, 56.8125, 56.9, 56.9, 57.2125, 57.2125, 56.8125, 56.8125, 55.9, 55.9, 55.75, 55.75, 55.1125, 55.1125, 55.725, 55.725, 55.95, 55.95, 55.6875, 55.6875, 55.675, 55.675, 55.25, 55.25, 55.6125, 55.6125, 55.6, 55.6, 55.9125, 55.9125, 55.95, 55.95, 55.725, 55.725, 55.2625, 55.2625]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 4, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.556, Test loss: 2.067, Test accuracy: 22.16
Round   0, Global train loss: 1.556, Global test loss: 2.298, Global test accuracy: 18.85
Round   1, Train loss: 1.381, Test loss: 1.607, Test accuracy: 36.09
Round   1, Global train loss: 1.381, Global test loss: 2.112, Global test accuracy: 24.25
Round   2, Train loss: 1.331, Test loss: 1.498, Test accuracy: 39.34
Round   2, Global train loss: 1.331, Global test loss: 2.126, Global test accuracy: 21.09
Round   3, Train loss: 1.315, Test loss: 1.366, Test accuracy: 43.39
Round   3, Global train loss: 1.315, Global test loss: 2.126, Global test accuracy: 23.81
Round   4, Train loss: 1.257, Test loss: 1.358, Test accuracy: 42.80
Round   4, Global train loss: 1.257, Global test loss: 2.090, Global test accuracy: 23.02
Round   5, Train loss: 1.191, Test loss: 1.282, Test accuracy: 48.44
Round   5, Global train loss: 1.191, Global test loss: 1.892, Global test accuracy: 31.45
Round   6, Train loss: 1.273, Test loss: 1.201, Test accuracy: 53.35
Round   6, Global train loss: 1.273, Global test loss: 2.079, Global test accuracy: 28.95
Round   7, Train loss: 1.341, Test loss: 1.126, Test accuracy: 55.42
Round   7, Global train loss: 1.341, Global test loss: 1.812, Global test accuracy: 35.39
Round   8, Train loss: 1.186, Test loss: 1.122, Test accuracy: 55.55
Round   8, Global train loss: 1.186, Global test loss: 1.814, Global test accuracy: 37.01
Round   9, Train loss: 1.164, Test loss: 1.134, Test accuracy: 55.35
Round   9, Global train loss: 1.164, Global test loss: 2.036, Global test accuracy: 32.38
Round  10, Train loss: 1.262, Test loss: 1.132, Test accuracy: 55.73
Round  10, Global train loss: 1.262, Global test loss: 1.936, Global test accuracy: 36.01
Round  11, Train loss: 1.160, Test loss: 1.095, Test accuracy: 56.27
Round  11, Global train loss: 1.160, Global test loss: 1.830, Global test accuracy: 33.38
Round  12, Train loss: 1.294, Test loss: 1.028, Test accuracy: 58.95
Round  12, Global train loss: 1.294, Global test loss: 1.894, Global test accuracy: 32.24
Round  13, Train loss: 1.274, Test loss: 1.039, Test accuracy: 58.24
Round  13, Global train loss: 1.274, Global test loss: 1.921, Global test accuracy: 32.71
Round  14, Train loss: 1.206, Test loss: 1.018, Test accuracy: 59.21
Round  14, Global train loss: 1.206, Global test loss: 1.755, Global test accuracy: 37.62
Round  15, Train loss: 1.201, Test loss: 1.022, Test accuracy: 58.17
Round  15, Global train loss: 1.201, Global test loss: 1.787, Global test accuracy: 37.80
Round  16, Train loss: 1.255, Test loss: 1.005, Test accuracy: 58.77
Round  16, Global train loss: 1.255, Global test loss: 1.699, Global test accuracy: 42.02
Round  17, Train loss: 1.084, Test loss: 1.009, Test accuracy: 58.70
Round  17, Global train loss: 1.084, Global test loss: 1.875, Global test accuracy: 35.89
Round  18, Train loss: 1.195, Test loss: 1.017, Test accuracy: 59.58
Round  18, Global train loss: 1.195, Global test loss: 1.748, Global test accuracy: 39.89
Round  19, Train loss: 1.203, Test loss: 1.004, Test accuracy: 60.09
Round  19, Global train loss: 1.203, Global test loss: 1.815, Global test accuracy: 34.15
Round  20, Train loss: 1.024, Test loss: 0.978, Test accuracy: 61.06
Round  20, Global train loss: 1.024, Global test loss: 1.779, Global test accuracy: 36.38
Round  21, Train loss: 1.202, Test loss: 0.984, Test accuracy: 61.60
Round  21, Global train loss: 1.202, Global test loss: 1.801, Global test accuracy: 37.44
Round  22, Train loss: 1.230, Test loss: 0.985, Test accuracy: 61.69
Round  22, Global train loss: 1.230, Global test loss: 1.777, Global test accuracy: 35.42
Round  23, Train loss: 1.012, Test loss: 0.985, Test accuracy: 61.56
Round  23, Global train loss: 1.012, Global test loss: 1.745, Global test accuracy: 41.81
Round  24, Train loss: 1.115, Test loss: 0.978, Test accuracy: 61.90
Round  24, Global train loss: 1.115, Global test loss: 1.711, Global test accuracy: 37.62
Round  25, Train loss: 1.078, Test loss: 0.969, Test accuracy: 62.39
Round  25, Global train loss: 1.078, Global test loss: 1.747, Global test accuracy: 39.71
Round  26, Train loss: 1.123, Test loss: 0.963, Test accuracy: 62.49
Round  26, Global train loss: 1.123, Global test loss: 1.854, Global test accuracy: 33.33
Round  27, Train loss: 1.014, Test loss: 0.981, Test accuracy: 61.69
Round  27, Global train loss: 1.014, Global test loss: 1.955, Global test accuracy: 32.89
Round  28, Train loss: 1.036, Test loss: 0.989, Test accuracy: 61.88
Round  28, Global train loss: 1.036, Global test loss: 1.510, Global test accuracy: 46.81
Round  29, Train loss: 1.139, Test loss: 0.980, Test accuracy: 61.64
Round  29, Global train loss: 1.139, Global test loss: 1.750, Global test accuracy: 39.00
Round  30, Train loss: 1.065, Test loss: 0.980, Test accuracy: 61.08
Round  30, Global train loss: 1.065, Global test loss: 1.610, Global test accuracy: 43.83
Round  31, Train loss: 0.941, Test loss: 0.972, Test accuracy: 61.49
Round  31, Global train loss: 0.941, Global test loss: 1.615, Global test accuracy: 44.77
Round  32, Train loss: 0.888, Test loss: 0.972, Test accuracy: 61.75
Round  32, Global train loss: 0.888, Global test loss: 1.626, Global test accuracy: 39.00
Round  33, Train loss: 1.164, Test loss: 0.961, Test accuracy: 62.20
Round  33, Global train loss: 1.164, Global test loss: 1.748, Global test accuracy: 38.70
Round  34, Train loss: 1.046, Test loss: 0.948, Test accuracy: 63.41
Round  34, Global train loss: 1.046, Global test loss: 1.576, Global test accuracy: 45.55
Round  35, Train loss: 1.185, Test loss: 0.947, Test accuracy: 63.48
Round  35, Global train loss: 1.185, Global test loss: 1.697, Global test accuracy: 40.81
Round  36, Train loss: 0.941, Test loss: 0.944, Test accuracy: 63.52
Round  36, Global train loss: 0.941, Global test loss: 1.605, Global test accuracy: 44.74
Round  37, Train loss: 0.889, Test loss: 0.949, Test accuracy: 63.08
Round  37, Global train loss: 0.889, Global test loss: 1.510, Global test accuracy: 48.45
Round  38, Train loss: 1.125, Test loss: 0.947, Test accuracy: 63.21
Round  38, Global train loss: 1.125, Global test loss: 1.918, Global test accuracy: 35.06
Round  39, Train loss: 0.948, Test loss: 0.938, Test accuracy: 63.81
Round  39, Global train loss: 0.948, Global test loss: 1.540, Global test accuracy: 45.05
Round  40, Train loss: 1.006, Test loss: 0.954, Test accuracy: 62.84
Round  40, Global train loss: 1.006, Global test loss: 1.593, Global test accuracy: 44.73
Round  41, Train loss: 0.919, Test loss: 0.962, Test accuracy: 62.04
Round  41, Global train loss: 0.919, Global test loss: 1.668, Global test accuracy: 40.19
Round  42, Train loss: 0.906, Test loss: 0.953, Test accuracy: 62.15
Round  42, Global train loss: 0.906, Global test loss: 1.504, Global test accuracy: 48.52
Round  43, Train loss: 0.814, Test loss: 0.951, Test accuracy: 62.11
Round  43, Global train loss: 0.814, Global test loss: 1.917, Global test accuracy: 38.25
Round  44, Train loss: 0.990, Test loss: 0.949, Test accuracy: 62.80
Round  44, Global train loss: 0.990, Global test loss: 1.628, Global test accuracy: 42.69
Round  45, Train loss: 0.755, Test loss: 0.962, Test accuracy: 62.27
Round  45, Global train loss: 0.755, Global test loss: 1.677, Global test accuracy: 43.40
Round  46, Train loss: 0.950, Test loss: 0.968, Test accuracy: 62.44
Round  46, Global train loss: 0.950, Global test loss: 1.610, Global test accuracy: 46.27
Round  47, Train loss: 0.940, Test loss: 0.987, Test accuracy: 61.73
Round  47, Global train loss: 0.940, Global test loss: 1.532, Global test accuracy: 47.10
Round  48, Train loss: 0.990, Test loss: 0.989, Test accuracy: 61.99
Round  48, Global train loss: 0.990, Global test loss: 1.582, Global test accuracy: 47.06
Round  49, Train loss: 0.938, Test loss: 0.989, Test accuracy: 61.77
Round  49, Global train loss: 0.938, Global test loss: 1.647, Global test accuracy: 44.42
Round  50, Train loss: 0.885, Test loss: 0.985, Test accuracy: 61.84
Round  50, Global train loss: 0.885, Global test loss: 1.580, Global test accuracy: 46.88
Round  51, Train loss: 0.946, Test loss: 0.973, Test accuracy: 62.69
Round  51, Global train loss: 0.946, Global test loss: 1.537, Global test accuracy: 48.94
Round  52, Train loss: 0.902, Test loss: 0.975, Test accuracy: 62.84
Round  52, Global train loss: 0.902, Global test loss: 1.563, Global test accuracy: 46.54
Round  53, Train loss: 0.924, Test loss: 0.985, Test accuracy: 62.52
Round  53, Global train loss: 0.924, Global test loss: 1.594, Global test accuracy: 45.56
Round  54, Train loss: 0.973, Test loss: 0.993, Test accuracy: 62.34
Round  54, Global train loss: 0.973, Global test loss: 1.793, Global test accuracy: 39.17
Round  55, Train loss: 0.776, Test loss: 1.023, Test accuracy: 61.30
Round  55, Global train loss: 0.776, Global test loss: 1.566, Global test accuracy: 45.83
Round  56, Train loss: 0.866, Test loss: 1.034, Test accuracy: 61.61
Round  56, Global train loss: 0.866, Global test loss: 1.559, Global test accuracy: 47.23
Round  57, Train loss: 0.867, Test loss: 1.015, Test accuracy: 62.02
Round  57, Global train loss: 0.867, Global test loss: 1.632, Global test accuracy: 46.76
Round  58, Train loss: 0.829, Test loss: 1.023, Test accuracy: 61.40
Round  58, Global train loss: 0.829, Global test loss: 1.758, Global test accuracy: 42.73
Round  59, Train loss: 0.886, Test loss: 1.027, Test accuracy: 61.34
Round  59, Global train loss: 0.886, Global test loss: 1.669, Global test accuracy: 44.42
Round  60, Train loss: 0.889, Test loss: 1.026, Test accuracy: 61.23
Round  60, Global train loss: 0.889, Global test loss: 1.574, Global test accuracy: 47.96
Round  61, Train loss: 0.903, Test loss: 1.037, Test accuracy: 60.77
Round  61, Global train loss: 0.903, Global test loss: 1.712, Global test accuracy: 43.91
Round  62, Train loss: 0.935, Test loss: 1.036, Test accuracy: 61.11
Round  62, Global train loss: 0.935, Global test loss: 1.744, Global test accuracy: 43.56
Round  63, Train loss: 0.723, Test loss: 1.018, Test accuracy: 62.44
Round  63, Global train loss: 0.723, Global test loss: 1.591, Global test accuracy: 47.31
Round  64, Train loss: 0.880, Test loss: 1.013, Test accuracy: 62.91
Round  64, Global train loss: 0.880, Global test loss: 1.640, Global test accuracy: 45.74
Round  65, Train loss: 0.702, Test loss: 1.007, Test accuracy: 63.31
Round  65, Global train loss: 0.702, Global test loss: 1.834, Global test accuracy: 42.51
Round  66, Train loss: 0.716, Test loss: 1.000, Test accuracy: 63.11
Round  66, Global train loss: 0.716, Global test loss: 1.606, Global test accuracy: 47.09
Round  67, Train loss: 0.755, Test loss: 1.004, Test accuracy: 62.92
Round  67, Global train loss: 0.755, Global test loss: 1.582, Global test accuracy: 47.51
Round  68, Train loss: 0.817, Test loss: 1.003, Test accuracy: 63.61
Round  68, Global train loss: 0.817, Global test loss: 1.537, Global test accuracy: 49.62
Round  69, Train loss: 0.687, Test loss: 1.033, Test accuracy: 63.00
Round  69, Global train loss: 0.687, Global test loss: 1.563, Global test accuracy: 48.33
Round  70, Train loss: 0.686, Test loss: 1.041, Test accuracy: 62.85
Round  70, Global train loss: 0.686, Global test loss: 1.737, Global test accuracy: 45.06
Round  71, Train loss: 0.628, Test loss: 1.043, Test accuracy: 62.64
Round  71, Global train loss: 0.628, Global test loss: 1.837, Global test accuracy: 44.30
Round  72, Train loss: 0.785, Test loss: 1.059, Test accuracy: 61.84
Round  72, Global train loss: 0.785, Global test loss: 1.502, Global test accuracy: 50.52
Round  73, Train loss: 0.700, Test loss: 1.049, Test accuracy: 61.99
Round  73, Global train loss: 0.700, Global test loss: 1.815, Global test accuracy: 43.55
Round  74, Train loss: 0.701, Test loss: 1.042, Test accuracy: 62.34
Round  74, Global train loss: 0.701, Global test loss: 1.680, Global test accuracy: 44.56
Round  75, Train loss: 0.757, Test loss: 1.036, Test accuracy: 63.16
Round  75, Global train loss: 0.757, Global test loss: 1.849, Global test accuracy: 42.29
Round  76, Train loss: 0.639, Test loss: 1.021, Test accuracy: 63.80
Round  76, Global train loss: 0.639, Global test loss: 1.727, Global test accuracy: 46.60
Round  77, Train loss: 0.704, Test loss: 1.051, Test accuracy: 62.91
Round  77, Global train loss: 0.704, Global test loss: 1.621, Global test accuracy: 48.27
Round  78, Train loss: 0.666, Test loss: 1.065, Test accuracy: 62.73
Round  78, Global train loss: 0.666, Global test loss: 1.568, Global test accuracy: 46.96
Round  79, Train loss: 0.682, Test loss: 1.083, Test accuracy: 62.51
Round  79, Global train loss: 0.682, Global test loss: 1.583, Global test accuracy: 48.94
Round  80, Train loss: 0.744, Test loss: 1.110, Test accuracy: 61.36
Round  80, Global train loss: 0.744, Global test loss: 1.693, Global test accuracy: 44.31
Round  81, Train loss: 0.739, Test loss: 1.095, Test accuracy: 62.02
Round  81, Global train loss: 0.739, Global test loss: 1.612, Global test accuracy: 46.99
Round  82, Train loss: 0.729, Test loss: 1.127, Test accuracy: 61.54
Round  82, Global train loss: 0.729, Global test loss: 1.735, Global test accuracy: 45.59
Round  83, Train loss: 0.612, Test loss: 1.125, Test accuracy: 60.91
Round  83, Global train loss: 0.612, Global test loss: 1.678, Global test accuracy: 48.15
Round  84, Train loss: 0.664, Test loss: 1.121, Test accuracy: 60.60
Round  84, Global train loss: 0.664, Global test loss: 1.600, Global test accuracy: 49.39
Round  85, Train loss: 0.657, Test loss: 1.137, Test accuracy: 61.17
Round  85, Global train loss: 0.657, Global test loss: 1.662, Global test accuracy: 47.54
Round  86, Train loss: 0.647, Test loss: 1.120, Test accuracy: 61.56
Round  86, Global train loss: 0.647, Global test loss: 1.703, Global test accuracy: 47.65
Round  87, Train loss: 0.758, Test loss: 1.129, Test accuracy: 61.46
Round  87, Global train loss: 0.758, Global test loss: 1.706, Global test accuracy: 45.11
Round  88, Train loss: 0.796, Test loss: 1.136, Test accuracy: 61.54
Round  88, Global train loss: 0.796, Global test loss: 1.832, Global test accuracy: 44.39
Round  89, Train loss: 0.602, Test loss: 1.127, Test accuracy: 61.95
Round  89, Global train loss: 0.602, Global test loss: 1.792, Global test accuracy: 44.76
Round  90, Train loss: 0.547, Test loss: 1.147, Test accuracy: 61.89
Round  90, Global train loss: 0.547, Global test loss: 1.786, Global test accuracy: 48.21
Round  91, Train loss: 0.538, Test loss: 1.148, Test accuracy: 61.75
Round  91, Global train loss: 0.538, Global test loss: 1.685, Global test accuracy: 48.60
Round  92, Train loss: 0.484, Test loss: 1.143, Test accuracy: 61.81
Round  92, Global train loss: 0.484, Global test loss: 1.798, Global test accuracy: 48.41
Round  93, Train loss: 0.628, Test loss: 1.138, Test accuracy: 61.73
Round  93, Global train loss: 0.628, Global test loss: 1.733, Global test accuracy: 48.50
Round  94, Train loss: 0.680, Test loss: 1.133, Test accuracy: 61.88
Round  94, Global train loss: 0.680, Global test loss: 1.746, Global test accuracy: 46.88
Round  95, Train loss: 0.577, Test loss: 1.147, Test accuracy: 61.45
Round  95, Global train loss: 0.577, Global test loss: 1.699, Global test accuracy: 47.36
Round  96, Train loss: 0.685, Test loss: 1.161, Test accuracy: 61.67
Round  96, Global train loss: 0.685, Global test loss: 1.747, Global test accuracy: 45.75
Round  97, Train loss: 0.504, Test loss: 1.173, Test accuracy: 61.56
Round  97, Global train loss: 0.504, Global test loss: 1.925, Global test accuracy: 45.85
Round  98, Train loss: 0.739, Test loss: 1.192, Test accuracy: 60.70
Round  98, Global train loss: 0.739, Global test loss: 1.811, Global test accuracy: 44.41
Round  99, Train loss: 0.614, Test loss: 1.206, Test accuracy: 60.48
Round  99, Global train loss: 0.614, Global test loss: 1.814, Global test accuracy: 45.88
Final Round, Train loss: 0.491, Test loss: 1.382, Test accuracy: 59.67
Final Round, Global train loss: 0.491, Global test loss: 1.814, Global test accuracy: 45.88
Average accuracy final 10 rounds: 61.49125 

Average global accuracy final 10 rounds: 46.98500000000001 

1482.0242409706116
[1.4916770458221436, 2.983354091644287, 4.1489644050598145, 5.314574718475342, 6.4971022605896, 7.679629802703857, 8.957227945327759, 10.23482608795166, 11.482584238052368, 12.730342388153076, 13.939220666885376, 15.148098945617676, 16.34818983078003, 17.548280715942383, 18.68292737007141, 19.81757402420044, 20.967339992523193, 22.117105960845947, 23.327277660369873, 24.5374493598938, 25.744664669036865, 26.95187997817993, 28.100164651870728, 29.248449325561523, 30.502779245376587, 31.75710916519165, 32.97091555595398, 34.18472194671631, 35.44988417625427, 36.715046405792236, 37.911550760269165, 39.108055114746094, 40.25584077835083, 41.403626441955566, 42.60062789916992, 43.79762935638428, 45.05567216873169, 46.3137149810791, 47.59245991706848, 48.87120485305786, 50.150349378585815, 51.42949390411377, 52.61814022064209, 53.80678653717041, 55.12631893157959, 56.44585132598877, 57.650171756744385, 58.8544921875, 60.040743589401245, 61.22699499130249, 62.37700629234314, 63.52701759338379, 64.90407609939575, 66.28113460540771, 67.60141730308533, 68.92170000076294, 70.18671441078186, 71.45172882080078, 72.75590467453003, 74.06008052825928, 75.43145847320557, 76.80283641815186, 77.94029545783997, 79.07775449752808, 80.26515626907349, 81.4525580406189, 82.57821488380432, 83.70387172698975, 84.87933945655823, 86.05480718612671, 87.27128481864929, 88.48776245117188, 89.75032877922058, 91.01289510726929, 92.37905883789062, 93.74522256851196, 95.02579116821289, 96.30635976791382, 97.59643006324768, 98.88650035858154, 100.07903909683228, 101.27157783508301, 102.55973482131958, 103.84789180755615, 105.19113421440125, 106.53437662124634, 107.84963941574097, 109.1649022102356, 110.37885904312134, 111.59281587600708, 112.8746063709259, 114.15639686584473, 115.30093097686768, 116.44546508789062, 117.65955567359924, 118.87364625930786, 120.1773362159729, 121.48102617263794, 122.71522808074951, 123.94942998886108, 125.16463923454285, 126.37984848022461, 127.5800633430481, 128.78027820587158, 130.07719779014587, 131.37411737442017, 132.58286929130554, 133.79162120819092, 135.06716346740723, 136.34270572662354, 137.6123549938202, 138.88200426101685, 140.17544078826904, 141.46887731552124, 142.70689940452576, 143.94492149353027, 145.25747513771057, 146.57002878189087, 147.7939920425415, 149.01795530319214, 150.25879836082458, 151.49964141845703, 152.64513564109802, 153.790629863739, 155.01214909553528, 156.23366832733154, 157.42326593399048, 158.6128635406494, 159.88388991355896, 161.1549162864685, 162.3772532939911, 163.59959030151367, 164.80779004096985, 166.01598978042603, 167.2149691581726, 168.4139485359192, 169.5995271205902, 170.78510570526123, 171.95709037780762, 173.129075050354, 174.35332536697388, 175.57757568359375, 177.1112415790558, 178.64490747451782, 179.76913690567017, 180.8933663368225, 182.13532400131226, 183.377281665802, 185.12624382972717, 186.87520599365234, 188.62737655639648, 190.37954711914062, 192.096670627594, 193.81379413604736, 195.5889813899994, 197.36416864395142, 199.12312030792236, 200.8820719718933, 202.57297921180725, 204.2638864517212, 205.65900206565857, 207.05411767959595, 208.26801133155823, 209.4819049835205, 210.89238381385803, 212.30286264419556, 213.58732056617737, 214.87177848815918, 216.10754942893982, 217.34332036972046, 218.73544025421143, 220.1275601387024, 221.31030917167664, 222.49305820465088, 223.90252709388733, 225.31199598312378, 226.63694047927856, 227.96188497543335, 229.45614886283875, 230.95041275024414, 232.25512266159058, 233.559832572937, 235.03857254981995, 236.51731252670288, 237.8601315021515, 239.2029504776001, 240.47074174880981, 241.73853302001953, 243.04837465286255, 244.35821628570557, 245.6425530910492, 246.92688989639282, 248.13775777816772, 249.34862565994263, 250.62250971794128, 251.89639377593994, 253.2269082069397, 254.55742263793945, 255.98592734336853, 257.4144320487976, 260.11965227127075, 262.8248724937439]
[22.1625, 22.1625, 36.0875, 36.0875, 39.3375, 39.3375, 43.3875, 43.3875, 42.8, 42.8, 48.4375, 48.4375, 53.35, 53.35, 55.425, 55.425, 55.55, 55.55, 55.35, 55.35, 55.725, 55.725, 56.275, 56.275, 58.95, 58.95, 58.2375, 58.2375, 59.2125, 59.2125, 58.175, 58.175, 58.775, 58.775, 58.7, 58.7, 59.575, 59.575, 60.0875, 60.0875, 61.0625, 61.0625, 61.6, 61.6, 61.6875, 61.6875, 61.5625, 61.5625, 61.9, 61.9, 62.3875, 62.3875, 62.4875, 62.4875, 61.6875, 61.6875, 61.875, 61.875, 61.6375, 61.6375, 61.075, 61.075, 61.4875, 61.4875, 61.75, 61.75, 62.2, 62.2, 63.4125, 63.4125, 63.475, 63.475, 63.525, 63.525, 63.075, 63.075, 63.2125, 63.2125, 63.8125, 63.8125, 62.8375, 62.8375, 62.0375, 62.0375, 62.15, 62.15, 62.1125, 62.1125, 62.8, 62.8, 62.275, 62.275, 62.4375, 62.4375, 61.725, 61.725, 61.9875, 61.9875, 61.775, 61.775, 61.8375, 61.8375, 62.6875, 62.6875, 62.8375, 62.8375, 62.525, 62.525, 62.3375, 62.3375, 61.3, 61.3, 61.6125, 61.6125, 62.025, 62.025, 61.4, 61.4, 61.3375, 61.3375, 61.225, 61.225, 60.775, 60.775, 61.1125, 61.1125, 62.4375, 62.4375, 62.9125, 62.9125, 63.3125, 63.3125, 63.1125, 63.1125, 62.925, 62.925, 63.6125, 63.6125, 63.0, 63.0, 62.85, 62.85, 62.6375, 62.6375, 61.8375, 61.8375, 61.9875, 61.9875, 62.3375, 62.3375, 63.1625, 63.1625, 63.8, 63.8, 62.9125, 62.9125, 62.725, 62.725, 62.5125, 62.5125, 61.3625, 61.3625, 62.025, 62.025, 61.5375, 61.5375, 60.9125, 60.9125, 60.6, 60.6, 61.175, 61.175, 61.5625, 61.5625, 61.4625, 61.4625, 61.5375, 61.5375, 61.95, 61.95, 61.8875, 61.8875, 61.75, 61.75, 61.8125, 61.8125, 61.725, 61.725, 61.875, 61.875, 61.45, 61.45, 61.675, 61.675, 61.5625, 61.5625, 60.7, 60.7, 60.475, 60.475, 59.675, 59.675]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 4, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.570, Test loss: 2.079, Test accuracy: 21.04
Round   0, Global train loss: 1.570, Global test loss: 2.315, Global test accuracy: 15.70
Round   1, Train loss: 1.450, Test loss: 1.671, Test accuracy: 33.86
Round   1, Global train loss: 1.450, Global test loss: 2.187, Global test accuracy: 23.34
Round   2, Train loss: 1.415, Test loss: 1.578, Test accuracy: 34.73
Round   2, Global train loss: 1.415, Global test loss: 2.224, Global test accuracy: 15.24
Round   3, Train loss: 1.372, Test loss: 1.433, Test accuracy: 38.61
Round   3, Global train loss: 1.372, Global test loss: 2.170, Global test accuracy: 18.74
Round   4, Train loss: 1.374, Test loss: 1.420, Test accuracy: 40.55
Round   4, Global train loss: 1.374, Global test loss: 2.135, Global test accuracy: 22.88
Round   5, Train loss: 1.287, Test loss: 1.369, Test accuracy: 43.34
Round   5, Global train loss: 1.287, Global test loss: 1.996, Global test accuracy: 26.30
Round   6, Train loss: 1.338, Test loss: 1.269, Test accuracy: 49.29
Round   6, Global train loss: 1.338, Global test loss: 2.248, Global test accuracy: 24.75
Round   7, Train loss: 1.326, Test loss: 1.173, Test accuracy: 51.86
Round   7, Global train loss: 1.326, Global test loss: 1.882, Global test accuracy: 28.02
Round   8, Train loss: 1.231, Test loss: 1.182, Test accuracy: 52.01
Round   8, Global train loss: 1.231, Global test loss: 1.872, Global test accuracy: 34.40
Round   9, Train loss: 1.266, Test loss: 1.194, Test accuracy: 52.83
Round   9, Global train loss: 1.266, Global test loss: 2.023, Global test accuracy: 31.06
Round  10, Train loss: 1.244, Test loss: 1.146, Test accuracy: 55.73
Round  10, Global train loss: 1.244, Global test loss: 1.928, Global test accuracy: 36.95
Round  11, Train loss: 1.297, Test loss: 1.147, Test accuracy: 54.59
Round  11, Global train loss: 1.297, Global test loss: 2.001, Global test accuracy: 27.16
Round  12, Train loss: 1.146, Test loss: 1.054, Test accuracy: 57.46
Round  12, Global train loss: 1.146, Global test loss: 1.854, Global test accuracy: 33.24
Round  13, Train loss: 1.180, Test loss: 1.032, Test accuracy: 59.16
Round  13, Global train loss: 1.180, Global test loss: 1.899, Global test accuracy: 32.58
Round  14, Train loss: 1.184, Test loss: 1.031, Test accuracy: 58.52
Round  14, Global train loss: 1.184, Global test loss: 1.756, Global test accuracy: 36.76
Round  15, Train loss: 1.178, Test loss: 1.023, Test accuracy: 59.01
Round  15, Global train loss: 1.178, Global test loss: 1.716, Global test accuracy: 40.15
Round  16, Train loss: 1.105, Test loss: 1.016, Test accuracy: 59.49
Round  16, Global train loss: 1.105, Global test loss: 1.682, Global test accuracy: 40.24
Round  17, Train loss: 1.149, Test loss: 0.983, Test accuracy: 60.38
Round  17, Global train loss: 1.149, Global test loss: 1.892, Global test accuracy: 34.61
Round  18, Train loss: 1.145, Test loss: 0.976, Test accuracy: 60.71
Round  18, Global train loss: 1.145, Global test loss: 1.710, Global test accuracy: 39.65
Round  19, Train loss: 1.200, Test loss: 0.973, Test accuracy: 60.40
Round  19, Global train loss: 1.200, Global test loss: 1.847, Global test accuracy: 31.85
Round  20, Train loss: 1.129, Test loss: 0.968, Test accuracy: 60.91
Round  20, Global train loss: 1.129, Global test loss: 1.694, Global test accuracy: 37.67
Round  21, Train loss: 1.136, Test loss: 0.968, Test accuracy: 61.08
Round  21, Global train loss: 1.136, Global test loss: 1.721, Global test accuracy: 40.01
Round  22, Train loss: 1.149, Test loss: 0.956, Test accuracy: 61.89
Round  22, Global train loss: 1.149, Global test loss: 1.798, Global test accuracy: 30.71
Round  23, Train loss: 1.186, Test loss: 0.949, Test accuracy: 62.54
Round  23, Global train loss: 1.186, Global test loss: 1.714, Global test accuracy: 42.33
Round  24, Train loss: 1.103, Test loss: 0.948, Test accuracy: 62.90
Round  24, Global train loss: 1.103, Global test loss: 1.696, Global test accuracy: 36.58
Round  25, Train loss: 1.043, Test loss: 0.957, Test accuracy: 63.09
Round  25, Global train loss: 1.043, Global test loss: 1.771, Global test accuracy: 36.96
Round  26, Train loss: 1.039, Test loss: 0.955, Test accuracy: 63.05
Round  26, Global train loss: 1.039, Global test loss: 1.852, Global test accuracy: 33.54
Round  27, Train loss: 1.061, Test loss: 0.965, Test accuracy: 62.54
Round  27, Global train loss: 1.061, Global test loss: 1.936, Global test accuracy: 30.16
Round  28, Train loss: 1.134, Test loss: 0.947, Test accuracy: 63.58
Round  28, Global train loss: 1.134, Global test loss: 1.582, Global test accuracy: 44.39
Round  29, Train loss: 1.141, Test loss: 0.938, Test accuracy: 64.00
Round  29, Global train loss: 1.141, Global test loss: 1.678, Global test accuracy: 40.23
Round  30, Train loss: 1.083, Test loss: 0.953, Test accuracy: 62.92
Round  30, Global train loss: 1.083, Global test loss: 1.564, Global test accuracy: 45.08
Round  31, Train loss: 1.082, Test loss: 0.962, Test accuracy: 62.76
Round  31, Global train loss: 1.082, Global test loss: 1.708, Global test accuracy: 39.69
Round  32, Train loss: 1.123, Test loss: 0.951, Test accuracy: 62.92
Round  32, Global train loss: 1.123, Global test loss: 1.609, Global test accuracy: 40.84
Round  33, Train loss: 1.003, Test loss: 0.940, Test accuracy: 64.05
Round  33, Global train loss: 1.003, Global test loss: 1.730, Global test accuracy: 39.26
Round  34, Train loss: 1.101, Test loss: 0.922, Test accuracy: 64.89
Round  34, Global train loss: 1.101, Global test loss: 1.590, Global test accuracy: 44.61
Round  35, Train loss: 1.059, Test loss: 0.935, Test accuracy: 64.51
Round  35, Global train loss: 1.059, Global test loss: 1.707, Global test accuracy: 40.80
Round  36, Train loss: 1.059, Test loss: 0.941, Test accuracy: 63.98
Round  36, Global train loss: 1.059, Global test loss: 1.651, Global test accuracy: 42.15
Round  37, Train loss: 1.042, Test loss: 0.962, Test accuracy: 62.95
Round  37, Global train loss: 1.042, Global test loss: 1.544, Global test accuracy: 45.51
Round  38, Train loss: 1.091, Test loss: 0.952, Test accuracy: 64.42
Round  38, Global train loss: 1.091, Global test loss: 1.964, Global test accuracy: 35.70
Round  39, Train loss: 1.014, Test loss: 0.952, Test accuracy: 64.20
Round  39, Global train loss: 1.014, Global test loss: 1.566, Global test accuracy: 45.69
Round  40, Train loss: 1.052, Test loss: 0.944, Test accuracy: 64.08
Round  40, Global train loss: 1.052, Global test loss: 1.582, Global test accuracy: 44.67
Round  41, Train loss: 1.112, Test loss: 0.944, Test accuracy: 63.44
Round  41, Global train loss: 1.112, Global test loss: 1.753, Global test accuracy: 39.50
Round  42, Train loss: 0.882, Test loss: 0.944, Test accuracy: 63.46
Round  42, Global train loss: 0.882, Global test loss: 1.509, Global test accuracy: 46.81
Round  43, Train loss: 0.965, Test loss: 0.964, Test accuracy: 62.38
Round  43, Global train loss: 0.965, Global test loss: 1.959, Global test accuracy: 34.05
Round  44, Train loss: 1.049, Test loss: 0.944, Test accuracy: 63.45
Round  44, Global train loss: 1.049, Global test loss: 1.641, Global test accuracy: 42.29
Round  45, Train loss: 0.954, Test loss: 0.954, Test accuracy: 63.29
Round  45, Global train loss: 0.954, Global test loss: 1.674, Global test accuracy: 42.16
Round  46, Train loss: 0.935, Test loss: 0.950, Test accuracy: 63.83
Round  46, Global train loss: 0.935, Global test loss: 1.714, Global test accuracy: 42.52
Round  47, Train loss: 1.070, Test loss: 0.954, Test accuracy: 63.33
Round  47, Global train loss: 1.070, Global test loss: 1.611, Global test accuracy: 45.33
Round  48, Train loss: 0.909, Test loss: 0.943, Test accuracy: 63.50
Round  48, Global train loss: 0.909, Global test loss: 1.614, Global test accuracy: 46.15
Round  49, Train loss: 1.115, Test loss: 0.947, Test accuracy: 63.45
Round  49, Global train loss: 1.115, Global test loss: 1.601, Global test accuracy: 45.20
Round  50, Train loss: 0.976, Test loss: 0.938, Test accuracy: 63.70
Round  50, Global train loss: 0.976, Global test loss: 1.554, Global test accuracy: 47.06
Round  51, Train loss: 0.957, Test loss: 0.930, Test accuracy: 64.06
Round  51, Global train loss: 0.957, Global test loss: 1.558, Global test accuracy: 46.79
Round  52, Train loss: 0.943, Test loss: 0.930, Test accuracy: 63.91
Round  52, Global train loss: 0.943, Global test loss: 1.577, Global test accuracy: 44.35
Round  53, Train loss: 1.027, Test loss: 0.936, Test accuracy: 63.44
Round  53, Global train loss: 1.027, Global test loss: 1.566, Global test accuracy: 45.64
Round  54, Train loss: 1.035, Test loss: 0.936, Test accuracy: 63.73
Round  54, Global train loss: 1.035, Global test loss: 1.732, Global test accuracy: 40.46
Round  55, Train loss: 0.871, Test loss: 0.940, Test accuracy: 64.22
Round  55, Global train loss: 0.871, Global test loss: 1.572, Global test accuracy: 46.81
Round  56, Train loss: 0.890, Test loss: 0.941, Test accuracy: 64.79
Round  56, Global train loss: 0.890, Global test loss: 1.525, Global test accuracy: 47.45
Round  57, Train loss: 0.870, Test loss: 0.963, Test accuracy: 63.75
Round  57, Global train loss: 0.870, Global test loss: 1.624, Global test accuracy: 46.64
Round  58, Train loss: 0.816, Test loss: 0.958, Test accuracy: 63.51
Round  58, Global train loss: 0.816, Global test loss: 1.627, Global test accuracy: 45.52
Round  59, Train loss: 0.977, Test loss: 0.976, Test accuracy: 63.20
Round  59, Global train loss: 0.977, Global test loss: 1.710, Global test accuracy: 42.99
Round  60, Train loss: 0.984, Test loss: 0.959, Test accuracy: 63.88
Round  60, Global train loss: 0.984, Global test loss: 1.614, Global test accuracy: 44.79
Round  61, Train loss: 0.909, Test loss: 0.959, Test accuracy: 63.71
Round  61, Global train loss: 0.909, Global test loss: 1.685, Global test accuracy: 42.99
Round  62, Train loss: 0.953, Test loss: 0.986, Test accuracy: 62.48
Round  62, Global train loss: 0.953, Global test loss: 1.801, Global test accuracy: 40.92
Round  63, Train loss: 0.846, Test loss: 0.969, Test accuracy: 62.99
Round  63, Global train loss: 0.846, Global test loss: 1.583, Global test accuracy: 46.48
Round  64, Train loss: 0.902, Test loss: 0.975, Test accuracy: 62.56
Round  64, Global train loss: 0.902, Global test loss: 1.635, Global test accuracy: 44.74
Round  65, Train loss: 0.833, Test loss: 0.975, Test accuracy: 63.04
Round  65, Global train loss: 0.833, Global test loss: 1.714, Global test accuracy: 44.80
Round  66, Train loss: 0.962, Test loss: 0.975, Test accuracy: 62.86
Round  66, Global train loss: 0.962, Global test loss: 1.623, Global test accuracy: 45.15
Round  67, Train loss: 0.922, Test loss: 0.988, Test accuracy: 62.99
Round  67, Global train loss: 0.922, Global test loss: 1.504, Global test accuracy: 48.77
Round  68, Train loss: 0.901, Test loss: 0.989, Test accuracy: 62.90
Round  68, Global train loss: 0.901, Global test loss: 1.572, Global test accuracy: 47.83
Round  69, Train loss: 0.808, Test loss: 0.976, Test accuracy: 62.91
Round  69, Global train loss: 0.808, Global test loss: 1.542, Global test accuracy: 47.84
Round  70, Train loss: 0.761, Test loss: 0.992, Test accuracy: 62.70
Round  70, Global train loss: 0.761, Global test loss: 1.602, Global test accuracy: 46.81
Round  71, Train loss: 0.892, Test loss: 0.987, Test accuracy: 62.86
Round  71, Global train loss: 0.892, Global test loss: 1.786, Global test accuracy: 42.02
Round  72, Train loss: 0.897, Test loss: 0.978, Test accuracy: 63.67
Round  72, Global train loss: 0.897, Global test loss: 1.538, Global test accuracy: 48.26
Round  73, Train loss: 0.851, Test loss: 0.985, Test accuracy: 63.30
Round  73, Global train loss: 0.851, Global test loss: 1.853, Global test accuracy: 38.94
Round  74, Train loss: 0.867, Test loss: 1.010, Test accuracy: 62.04
Round  74, Global train loss: 0.867, Global test loss: 1.631, Global test accuracy: 44.94
Round  75, Train loss: 0.766, Test loss: 1.004, Test accuracy: 62.80
Round  75, Global train loss: 0.766, Global test loss: 1.822, Global test accuracy: 41.16
Round  76, Train loss: 0.866, Test loss: 1.009, Test accuracy: 62.86
Round  76, Global train loss: 0.866, Global test loss: 1.670, Global test accuracy: 45.46
Round  77, Train loss: 0.716, Test loss: 0.972, Test accuracy: 64.03
Round  77, Global train loss: 0.716, Global test loss: 1.608, Global test accuracy: 47.23
Round  78, Train loss: 0.722, Test loss: 0.982, Test accuracy: 63.77
Round  78, Global train loss: 0.722, Global test loss: 1.603, Global test accuracy: 47.51
Round  79, Train loss: 0.896, Test loss: 1.006, Test accuracy: 62.86
Round  79, Global train loss: 0.896, Global test loss: 1.520, Global test accuracy: 50.04
Round  80, Train loss: 0.883, Test loss: 1.015, Test accuracy: 62.66
Round  80, Global train loss: 0.883, Global test loss: 1.758, Global test accuracy: 42.04
Round  81, Train loss: 0.825, Test loss: 1.018, Test accuracy: 62.27
Round  81, Global train loss: 0.825, Global test loss: 1.569, Global test accuracy: 47.38
Round  82, Train loss: 0.756, Test loss: 1.035, Test accuracy: 61.88
Round  82, Global train loss: 0.756, Global test loss: 1.680, Global test accuracy: 46.54
Round  83, Train loss: 0.704, Test loss: 1.042, Test accuracy: 62.15
Round  83, Global train loss: 0.704, Global test loss: 1.650, Global test accuracy: 47.14
Round  84, Train loss: 0.935, Test loss: 1.053, Test accuracy: 61.50
Round  84, Global train loss: 0.935, Global test loss: 1.670, Global test accuracy: 44.64
Round  85, Train loss: 0.766, Test loss: 1.049, Test accuracy: 62.23
Round  85, Global train loss: 0.766, Global test loss: 1.581, Global test accuracy: 48.11
Round  86, Train loss: 0.683, Test loss: 1.081, Test accuracy: 61.06
Round  86, Global train loss: 0.683, Global test loss: 1.748, Global test accuracy: 44.34
Round  87, Train loss: 0.674, Test loss: 1.086, Test accuracy: 61.29
Round  87, Global train loss: 0.674, Global test loss: 1.564, Global test accuracy: 48.70
Round  88, Train loss: 0.792, Test loss: 1.120, Test accuracy: 60.74
Round  88, Global train loss: 0.792, Global test loss: 1.737, Global test accuracy: 44.49
Round  89, Train loss: 0.820, Test loss: 1.149, Test accuracy: 59.31
Round  89, Global train loss: 0.820, Global test loss: 1.753, Global test accuracy: 43.69
Round  90, Train loss: 0.670, Test loss: 1.110, Test accuracy: 60.31
Round  90, Global train loss: 0.670, Global test loss: 1.727, Global test accuracy: 46.69
Round  91, Train loss: 0.719, Test loss: 1.082, Test accuracy: 61.05
Round  91, Global train loss: 0.719, Global test loss: 1.683, Global test accuracy: 46.84
Round  92, Train loss: 0.644, Test loss: 1.075, Test accuracy: 61.56
Round  92, Global train loss: 0.644, Global test loss: 1.667, Global test accuracy: 46.80/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  93, Train loss: 0.791, Test loss: 1.074, Test accuracy: 61.71
Round  93, Global train loss: 0.791, Global test loss: 1.834, Global test accuracy: 42.94
Round  94, Train loss: 0.683, Test loss: 1.091, Test accuracy: 61.71
Round  94, Global train loss: 0.683, Global test loss: 1.686, Global test accuracy: 47.12
Round  95, Train loss: 0.767, Test loss: 1.120, Test accuracy: 60.48
Round  95, Global train loss: 0.767, Global test loss: 1.663, Global test accuracy: 46.76
Round  96, Train loss: 0.739, Test loss: 1.110, Test accuracy: 61.31
Round  96, Global train loss: 0.739, Global test loss: 1.766, Global test accuracy: 44.12
Round  97, Train loss: 0.621, Test loss: 1.114, Test accuracy: 61.31
Round  97, Global train loss: 0.621, Global test loss: 1.919, Global test accuracy: 42.48
Round  98, Train loss: 0.679, Test loss: 1.097, Test accuracy: 62.10
Round  98, Global train loss: 0.679, Global test loss: 1.739, Global test accuracy: 44.12
Round  99, Train loss: 0.798, Test loss: 1.102, Test accuracy: 62.40
Round  99, Global train loss: 0.798, Global test loss: 1.714, Global test accuracy: 44.84
Final Round, Train loss: 0.581, Test loss: 1.186, Test accuracy: 61.42
Final Round, Global train loss: 0.581, Global test loss: 1.714, Global test accuracy: 44.84
Average accuracy final 10 rounds: 61.39500000000001 

Average global accuracy final 10 rounds: 45.27125 

1550.044908285141
[1.7004377841949463, 3.4008755683898926, 4.801259994506836, 6.201644420623779, 7.715071439743042, 9.228498458862305, 10.602678298950195, 11.976858139038086, 13.349620580673218, 14.72238302230835, 16.032949209213257, 17.343515396118164, 18.623271465301514, 19.903027534484863, 21.238551139831543, 22.574074745178223, 23.92417573928833, 25.274276733398438, 26.579772233963013, 27.885267734527588, 29.214096546173096, 30.542925357818604, 31.87634253501892, 33.20975971221924, 34.40327024459839, 35.59678077697754, 36.92717242240906, 38.257564067840576, 39.64209699630737, 41.02662992477417, 42.35976052284241, 43.692891120910645, 45.05699110031128, 46.421091079711914, 47.78381371498108, 49.146536350250244, 50.83567500114441, 52.524813652038574, 53.81865859031677, 55.11250352859497, 56.479713916778564, 57.84692430496216, 59.291141986846924, 60.73535966873169, 62.00268220901489, 63.270004749298096, 64.55142760276794, 65.8328504562378, 67.09162759780884, 68.35040473937988, 69.63649940490723, 70.92259407043457, 72.18749117851257, 73.45238828659058, 74.70134353637695, 75.95029878616333, 77.21322727203369, 78.47615575790405, 79.73988938331604, 81.00362300872803, 82.34677147865295, 83.68991994857788, 84.95288181304932, 86.21584367752075, 87.64302039146423, 89.07019710540771, 90.40145540237427, 91.73271369934082, 92.97955560684204, 94.22639751434326, 95.5047538280487, 96.78311014175415, 98.12932229042053, 99.47553443908691, 100.76349568367004, 102.05145692825317, 103.6199643611908, 105.18847179412842, 106.63990926742554, 108.09134674072266, 109.4203610420227, 110.74937534332275, 111.99972105026245, 113.25006675720215, 114.54723978042603, 115.8444128036499, 117.12527704238892, 118.40614128112793, 119.70875310897827, 121.01136493682861, 122.28540873527527, 123.55945253372192, 124.8616693019867, 126.16388607025146, 127.47468876838684, 128.78549146652222, 129.97185468673706, 131.1582179069519, 132.39340472221375, 133.6285915374756, 134.86591839790344, 136.1032452583313, 137.34991097450256, 138.59657669067383, 139.84809017181396, 141.0996036529541, 142.42622184753418, 143.75284004211426, 145.64981865882874, 147.5467972755432, 149.37078642845154, 151.19477558135986, 153.0089192390442, 154.82306289672852, 156.615571975708, 158.4080810546875, 160.21799540519714, 162.0279097557068, 163.89019083976746, 165.75247192382812, 167.63196396827698, 169.51145601272583, 171.4670283794403, 173.42260074615479, 175.3174569606781, 177.21231317520142, 178.60215735435486, 179.9920015335083, 181.36092567443848, 182.72984981536865, 184.10184788703918, 185.47384595870972, 186.85326290130615, 188.2326798439026, 189.633855342865, 191.0350308418274, 192.84817552566528, 194.66132020950317, 196.17689609527588, 197.69247198104858, 199.243905544281, 200.79533910751343, 202.41983222961426, 204.0443253517151, 205.52402925491333, 207.00373315811157, 208.43957424163818, 209.8754153251648, 211.31888818740845, 212.7623610496521, 214.2751123905182, 215.78786373138428, 217.2597336769104, 218.73160362243652, 220.06690168380737, 221.40219974517822, 222.88302755355835, 224.36385536193848, 225.6970362663269, 227.03021717071533, 228.43758869171143, 229.84496021270752, 231.2766215801239, 232.70828294754028, 234.13484263420105, 235.56140232086182, 236.85237646102905, 238.1433506011963, 239.70538663864136, 241.26742267608643, 242.62732338905334, 243.98722410202026, 245.32865262031555, 246.67008113861084, 248.1466155052185, 249.62314987182617, 251.12396383285522, 252.62477779388428, 254.14973735809326, 255.67469692230225, 257.00353717803955, 258.33237743377686, 259.86941838264465, 261.40645933151245, 262.8303949832916, 264.2543306350708, 265.80398416519165, 267.3536376953125, 268.89223551750183, 270.43083333969116, 271.84997153282166, 273.26910972595215, 274.78173446655273, 276.2943592071533, 277.67759013175964, 279.06082105636597, 280.70548009872437, 282.35013914108276, 284.0265328884125, 285.7029266357422, 288.58421444892883, 291.4655022621155]
[21.0375, 21.0375, 33.8625, 33.8625, 34.725, 34.725, 38.6125, 38.6125, 40.55, 40.55, 43.3375, 43.3375, 49.2875, 49.2875, 51.8625, 51.8625, 52.0125, 52.0125, 52.825, 52.825, 55.725, 55.725, 54.5875, 54.5875, 57.4625, 57.4625, 59.1625, 59.1625, 58.525, 58.525, 59.0125, 59.0125, 59.4875, 59.4875, 60.375, 60.375, 60.7125, 60.7125, 60.4, 60.4, 60.9125, 60.9125, 61.075, 61.075, 61.8875, 61.8875, 62.5375, 62.5375, 62.9, 62.9, 63.0875, 63.0875, 63.05, 63.05, 62.5375, 62.5375, 63.575, 63.575, 64.0, 64.0, 62.925, 62.925, 62.7625, 62.7625, 62.925, 62.925, 64.05, 64.05, 64.8875, 64.8875, 64.5125, 64.5125, 63.975, 63.975, 62.95, 62.95, 64.425, 64.425, 64.2, 64.2, 64.075, 64.075, 63.4375, 63.4375, 63.4625, 63.4625, 62.375, 62.375, 63.45, 63.45, 63.2875, 63.2875, 63.825, 63.825, 63.325, 63.325, 63.5, 63.5, 63.45, 63.45, 63.7, 63.7, 64.0625, 64.0625, 63.9125, 63.9125, 63.4375, 63.4375, 63.725, 63.725, 64.225, 64.225, 64.7875, 64.7875, 63.75, 63.75, 63.5125, 63.5125, 63.2, 63.2, 63.875, 63.875, 63.7125, 63.7125, 62.475, 62.475, 62.9875, 62.9875, 62.5625, 62.5625, 63.0375, 63.0375, 62.8625, 62.8625, 62.9875, 62.9875, 62.9, 62.9, 62.9125, 62.9125, 62.7, 62.7, 62.8625, 62.8625, 63.675, 63.675, 63.3, 63.3, 62.0375, 62.0375, 62.8, 62.8, 62.8625, 62.8625, 64.025, 64.025, 63.775, 63.775, 62.8625, 62.8625, 62.6625, 62.6625, 62.275, 62.275, 61.875, 61.875, 62.15, 62.15, 61.5, 61.5, 62.225, 62.225, 61.0625, 61.0625, 61.2875, 61.2875, 60.7375, 60.7375, 59.3125, 59.3125, 60.3125, 60.3125, 61.05, 61.05, 61.5625, 61.5625, 61.7125, 61.7125, 61.7125, 61.7125, 60.475, 60.475, 61.3125, 61.3125, 61.3125, 61.3125, 62.1, 62.1, 62.4, 62.4, 61.425, 61.425]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 4, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.545, Test loss: 2.082, Test accuracy: 17.89
Round   0, Global train loss: 1.545, Global test loss: 2.331, Global test accuracy: 13.45
Round   1, Train loss: 1.354, Test loss: 1.608, Test accuracy: 35.51
Round   1, Global train loss: 1.354, Global test loss: 2.119, Global test accuracy: 24.86
Round   2, Train loss: 1.342, Test loss: 1.534, Test accuracy: 36.98
Round   2, Global train loss: 1.342, Global test loss: 2.202, Global test accuracy: 19.43
Round   3, Train loss: 1.265, Test loss: 1.392, Test accuracy: 40.99
Round   3, Global train loss: 1.265, Global test loss: 2.095, Global test accuracy: 24.50
Round   4, Train loss: 1.194, Test loss: 1.412, Test accuracy: 40.35
Round   4, Global train loss: 1.194, Global test loss: 2.137, Global test accuracy: 23.18
Round   5, Train loss: 1.329, Test loss: 1.345, Test accuracy: 44.79
Round   5, Global train loss: 1.329, Global test loss: 1.975, Global test accuracy: 29.54
Round   6, Train loss: 1.143, Test loss: 1.266, Test accuracy: 49.56
Round   6, Global train loss: 1.143, Global test loss: 2.263, Global test accuracy: 24.16
Round   7, Train loss: 1.380, Test loss: 1.196, Test accuracy: 51.70
Round   7, Global train loss: 1.380, Global test loss: 1.876, Global test accuracy: 33.52
Round   8, Train loss: 1.165, Test loss: 1.214, Test accuracy: 51.41
Round   8, Global train loss: 1.165, Global test loss: 1.845, Global test accuracy: 37.42
Round   9, Train loss: 1.119, Test loss: 1.217, Test accuracy: 51.89
Round   9, Global train loss: 1.119, Global test loss: 2.019, Global test accuracy: 29.89
Round  10, Train loss: 1.142, Test loss: 1.207, Test accuracy: 53.69
Round  10, Global train loss: 1.142, Global test loss: 2.050, Global test accuracy: 35.23
Round  11, Train loss: 1.224, Test loss: 1.206, Test accuracy: 52.80
Round  11, Global train loss: 1.224, Global test loss: 2.033, Global test accuracy: 32.20
Round  12, Train loss: 1.205, Test loss: 1.110, Test accuracy: 55.38
Round  12, Global train loss: 1.205, Global test loss: 1.947, Global test accuracy: 32.59
Round  13, Train loss: 1.142, Test loss: 1.100, Test accuracy: 56.45
Round  13, Global train loss: 1.142, Global test loss: 1.990, Global test accuracy: 35.00
Round  14, Train loss: 1.118, Test loss: 1.120, Test accuracy: 55.31
Round  14, Global train loss: 1.118, Global test loss: 1.931, Global test accuracy: 34.11
Round  15, Train loss: 1.195, Test loss: 1.132, Test accuracy: 55.42
Round  15, Global train loss: 1.195, Global test loss: 1.895, Global test accuracy: 36.12
Round  16, Train loss: 1.182, Test loss: 1.141, Test accuracy: 55.54
Round  16, Global train loss: 1.182, Global test loss: 1.838, Global test accuracy: 41.54
Round  17, Train loss: 1.016, Test loss: 1.145, Test accuracy: 56.04
Round  17, Global train loss: 1.016, Global test loss: 2.126, Global test accuracy: 33.64
Round  18, Train loss: 1.053, Test loss: 1.136, Test accuracy: 57.11
Round  18, Global train loss: 1.053, Global test loss: 1.846, Global test accuracy: 37.40
Round  19, Train loss: 0.982, Test loss: 1.125, Test accuracy: 57.39
Round  19, Global train loss: 0.982, Global test loss: 1.961, Global test accuracy: 33.69
Round  20, Train loss: 1.241, Test loss: 1.098, Test accuracy: 59.04
Round  20, Global train loss: 1.241, Global test loss: 1.957, Global test accuracy: 29.70
Round  21, Train loss: 1.103, Test loss: 1.084, Test accuracy: 59.54
Round  21, Global train loss: 1.103, Global test loss: 1.860, Global test accuracy: 36.61
Round  22, Train loss: 1.115, Test loss: 1.086, Test accuracy: 59.62
Round  22, Global train loss: 1.115, Global test loss: 2.010, Global test accuracy: 26.75
Round  23, Train loss: 1.046, Test loss: 1.096, Test accuracy: 59.09
Round  23, Global train loss: 1.046, Global test loss: 1.817, Global test accuracy: 39.85
Round  24, Train loss: 1.154, Test loss: 1.104, Test accuracy: 59.08
Round  24, Global train loss: 1.154, Global test loss: 1.783, Global test accuracy: 38.34
Round  25, Train loss: 1.112, Test loss: 1.073, Test accuracy: 59.81
Round  25, Global train loss: 1.112, Global test loss: 1.880, Global test accuracy: 36.08
Round  26, Train loss: 1.061, Test loss: 1.086, Test accuracy: 59.58
Round  26, Global train loss: 1.061, Global test loss: 1.985, Global test accuracy: 34.30
Round  27, Train loss: 1.226, Test loss: 1.084, Test accuracy: 59.84
Round  27, Global train loss: 1.226, Global test loss: 2.001, Global test accuracy: 29.86
Round  28, Train loss: 1.016, Test loss: 1.090, Test accuracy: 59.09
Round  28, Global train loss: 1.016, Global test loss: 1.735, Global test accuracy: 43.65
Round  29, Train loss: 0.987, Test loss: 1.086, Test accuracy: 59.65
Round  29, Global train loss: 0.987, Global test loss: 1.985, Global test accuracy: 34.81
Round  30, Train loss: 1.078, Test loss: 1.085, Test accuracy: 59.74
Round  30, Global train loss: 1.078, Global test loss: 1.734, Global test accuracy: 42.39
Round  31, Train loss: 0.991, Test loss: 1.079, Test accuracy: 59.65
Round  31, Global train loss: 0.991, Global test loss: 1.773, Global test accuracy: 39.83
Round  32, Train loss: 1.081, Test loss: 1.057, Test accuracy: 60.25
Round  32, Global train loss: 1.081, Global test loss: 1.772, Global test accuracy: 35.61
Round  33, Train loss: 1.072, Test loss: 1.053, Test accuracy: 60.29
Round  33, Global train loss: 1.072, Global test loss: 1.905, Global test accuracy: 37.17
Round  34, Train loss: 1.034, Test loss: 1.047, Test accuracy: 60.54
Round  34, Global train loss: 1.034, Global test loss: 1.655, Global test accuracy: 43.46
Round  35, Train loss: 0.851, Test loss: 1.046, Test accuracy: 60.74
Round  35, Global train loss: 0.851, Global test loss: 1.944, Global test accuracy: 38.49
Round  36, Train loss: 0.953, Test loss: 1.054, Test accuracy: 60.67
Round  36, Global train loss: 0.953, Global test loss: 1.705, Global test accuracy: 42.42
Round  37, Train loss: 1.014, Test loss: 1.069, Test accuracy: 60.40
Round  37, Global train loss: 1.014, Global test loss: 1.652, Global test accuracy: 42.96
Round  38, Train loss: 0.868, Test loss: 1.064, Test accuracy: 60.24
Round  38, Global train loss: 0.868, Global test loss: 2.120, Global test accuracy: 33.95
Round  39, Train loss: 1.122, Test loss: 1.058, Test accuracy: 60.58
Round  39, Global train loss: 1.122, Global test loss: 1.769, Global test accuracy: 41.06
Round  40, Train loss: 0.971, Test loss: 1.069, Test accuracy: 60.65
Round  40, Global train loss: 0.971, Global test loss: 1.742, Global test accuracy: 41.20
Round  41, Train loss: 1.032, Test loss: 1.073, Test accuracy: 60.84
Round  41, Global train loss: 1.032, Global test loss: 1.886, Global test accuracy: 38.91
Round  42, Train loss: 1.119, Test loss: 1.097, Test accuracy: 59.96
Round  42, Global train loss: 1.119, Global test loss: 1.716, Global test accuracy: 43.71
Round  43, Train loss: 1.076, Test loss: 1.091, Test accuracy: 59.70
Round  43, Global train loss: 1.076, Global test loss: 2.071, Global test accuracy: 30.90
Round  44, Train loss: 1.106, Test loss: 1.075, Test accuracy: 59.70
Round  44, Global train loss: 1.106, Global test loss: 1.811, Global test accuracy: 38.01
Round  45, Train loss: 0.989, Test loss: 1.094, Test accuracy: 59.12
Round  45, Global train loss: 0.989, Global test loss: 1.890, Global test accuracy: 35.98
Round  46, Train loss: 0.873, Test loss: 1.111, Test accuracy: 58.50
Round  46, Global train loss: 0.873, Global test loss: 1.807, Global test accuracy: 40.16
Round  47, Train loss: 0.969, Test loss: 1.089, Test accuracy: 58.73
Round  47, Global train loss: 0.969, Global test loss: 1.694, Global test accuracy: 41.94
Round  48, Train loss: 0.890, Test loss: 1.073, Test accuracy: 59.33
Round  48, Global train loss: 0.890, Global test loss: 1.743, Global test accuracy: 42.74
Round  49, Train loss: 1.007, Test loss: 1.065, Test accuracy: 59.84
Round  49, Global train loss: 1.007, Global test loss: 1.688, Global test accuracy: 42.65
Round  50, Train loss: 0.883, Test loss: 1.115, Test accuracy: 58.70
Round  50, Global train loss: 0.883, Global test loss: 1.874, Global test accuracy: 38.95
Round  51, Train loss: 0.843, Test loss: 1.108, Test accuracy: 58.98
Round  51, Global train loss: 0.843, Global test loss: 1.717, Global test accuracy: 43.66
Round  52, Train loss: 0.907, Test loss: 1.116, Test accuracy: 58.67
Round  52, Global train loss: 0.907, Global test loss: 1.713, Global test accuracy: 42.21
Round  53, Train loss: 0.930, Test loss: 1.126, Test accuracy: 58.14
Round  53, Global train loss: 0.930, Global test loss: 1.722, Global test accuracy: 42.27
Round  54, Train loss: 0.791, Test loss: 1.120, Test accuracy: 58.54
Round  54, Global train loss: 0.791, Global test loss: 1.935, Global test accuracy: 36.16
Round  55, Train loss: 0.942, Test loss: 1.104, Test accuracy: 59.31
Round  55, Global train loss: 0.942, Global test loss: 1.719, Global test accuracy: 42.23
Round  56, Train loss: 0.841, Test loss: 1.110, Test accuracy: 59.17
Round  56, Global train loss: 0.841, Global test loss: 1.749, Global test accuracy: 42.12
Round  57, Train loss: 0.783, Test loss: 1.102, Test accuracy: 59.15
Round  57, Global train loss: 0.783, Global test loss: 1.759, Global test accuracy: 43.55
Round  58, Train loss: 0.906, Test loss: 1.091, Test accuracy: 59.54
Round  58, Global train loss: 0.906, Global test loss: 1.774, Global test accuracy: 41.51
Round  59, Train loss: 0.753, Test loss: 1.153, Test accuracy: 57.98
Round  59, Global train loss: 0.753, Global test loss: 1.769, Global test accuracy: 41.54
Round  60, Train loss: 0.900, Test loss: 1.147, Test accuracy: 57.99
Round  60, Global train loss: 0.900, Global test loss: 1.715, Global test accuracy: 42.55
Round  61, Train loss: 0.757, Test loss: 1.170, Test accuracy: 57.92
Round  61, Global train loss: 0.757, Global test loss: 1.920, Global test accuracy: 39.56
Round  62, Train loss: 0.764, Test loss: 1.163, Test accuracy: 58.42
Round  62, Global train loss: 0.764, Global test loss: 1.923, Global test accuracy: 42.56
Round  63, Train loss: 0.866, Test loss: 1.140, Test accuracy: 59.01
Round  63, Global train loss: 0.866, Global test loss: 1.667, Global test accuracy: 43.85
Round  64, Train loss: 0.765, Test loss: 1.098, Test accuracy: 59.79
Round  64, Global train loss: 0.765, Global test loss: 1.709, Global test accuracy: 44.10
Round  65, Train loss: 0.856, Test loss: 1.147, Test accuracy: 59.23
Round  65, Global train loss: 0.856, Global test loss: 1.898, Global test accuracy: 39.55
Round  66, Train loss: 0.732, Test loss: 1.151, Test accuracy: 59.54
Round  66, Global train loss: 0.732, Global test loss: 1.754, Global test accuracy: 41.79
Round  67, Train loss: 0.757, Test loss: 1.156, Test accuracy: 59.16
Round  67, Global train loss: 0.757, Global test loss: 1.718, Global test accuracy: 43.10
Round  68, Train loss: 0.721, Test loss: 1.146, Test accuracy: 59.35
Round  68, Global train loss: 0.721, Global test loss: 1.617, Global test accuracy: 47.25
Round  69, Train loss: 0.852, Test loss: 1.121, Test accuracy: 59.84
Round  69, Global train loss: 0.852, Global test loss: 1.677, Global test accuracy: 43.21
Round  70, Train loss: 0.697, Test loss: 1.121, Test accuracy: 60.09
Round  70, Global train loss: 0.697, Global test loss: 1.758, Global test accuracy: 43.39
Round  71, Train loss: 0.734, Test loss: 1.125, Test accuracy: 59.95
Round  71, Global train loss: 0.734, Global test loss: 1.934, Global test accuracy: 39.54
Round  72, Train loss: 0.785, Test loss: 1.114, Test accuracy: 60.35
Round  72, Global train loss: 0.785, Global test loss: 1.584, Global test accuracy: 47.31
Round  73, Train loss: 0.575, Test loss: 1.135, Test accuracy: 59.46
Round  73, Global train loss: 0.575, Global test loss: 1.822, Global test accuracy: 43.21
Round  74, Train loss: 0.754, Test loss: 1.133, Test accuracy: 59.40
Round  74, Global train loss: 0.754, Global test loss: 1.726, Global test accuracy: 43.23
Round  75, Train loss: 0.696, Test loss: 1.142, Test accuracy: 59.71
Round  75, Global train loss: 0.696, Global test loss: 1.820, Global test accuracy: 41.41
Round  76, Train loss: 0.507, Test loss: 1.150, Test accuracy: 59.65
Round  76, Global train loss: 0.507, Global test loss: 1.692, Global test accuracy: 47.12
Round  77, Train loss: 0.740, Test loss: 1.165, Test accuracy: 59.05
Round  77, Global train loss: 0.740, Global test loss: 1.700, Global test accuracy: 43.90
Round  78, Train loss: 0.877, Test loss: 1.160, Test accuracy: 59.27
Round  78, Global train loss: 0.877, Global test loss: 1.733, Global test accuracy: 43.24
Round  79, Train loss: 0.821, Test loss: 1.166, Test accuracy: 59.49
Round  79, Global train loss: 0.821, Global test loss: 1.743, Global test accuracy: 43.66
Round  80, Train loss: 0.618, Test loss: 1.172, Test accuracy: 59.64
Round  80, Global train loss: 0.618, Global test loss: 1.940, Global test accuracy: 42.08
Round  81, Train loss: 0.748, Test loss: 1.160, Test accuracy: 59.99
Round  81, Global train loss: 0.748, Global test loss: 1.640, Global test accuracy: 44.75
Round  82, Train loss: 0.547, Test loss: 1.179, Test accuracy: 60.29
Round  82, Global train loss: 0.547, Global test loss: 1.651, Global test accuracy: 47.46
Round  83, Train loss: 0.681, Test loss: 1.211, Test accuracy: 59.83
Round  83, Global train loss: 0.681, Global test loss: 1.834, Global test accuracy: 42.31
Round  84, Train loss: 0.612, Test loss: 1.195, Test accuracy: 59.70
Round  84, Global train loss: 0.612, Global test loss: 1.730, Global test accuracy: 46.17
Round  85, Train loss: 0.614, Test loss: 1.200, Test accuracy: 59.77
Round  85, Global train loss: 0.614, Global test loss: 1.646, Global test accuracy: 47.26
Round  86, Train loss: 0.530, Test loss: 1.183, Test accuracy: 60.05
Round  86, Global train loss: 0.530, Global test loss: 1.681, Global test accuracy: 46.70
Round  87, Train loss: 0.784, Test loss: 1.176, Test accuracy: 60.40
Round  87, Global train loss: 0.784, Global test loss: 1.670, Global test accuracy: 44.85
Round  88, Train loss: 0.666, Test loss: 1.192, Test accuracy: 59.88
Round  88, Global train loss: 0.666, Global test loss: 1.876, Global test accuracy: 42.67
Round  89, Train loss: 0.587, Test loss: 1.205, Test accuracy: 59.65
Round  89, Global train loss: 0.587, Global test loss: 1.783, Global test accuracy: 43.60
Round  90, Train loss: 0.643, Test loss: 1.205, Test accuracy: 60.00
Round  90, Global train loss: 0.643, Global test loss: 1.831, Global test accuracy: 45.44
Round  91, Train loss: 0.598, Test loss: 1.199, Test accuracy: 60.19
Round  91, Global train loss: 0.598, Global test loss: 1.821, Global test accuracy: 43.85
Round  92, Train loss: 0.641, Test loss: 1.219, Test accuracy: 60.00
Round  92, Global train loss: 0.641, Global test loss: 1.761, Global test accuracy: 45.65
Round  93, Train loss: 0.527, Test loss: 1.234, Test accuracy: 60.25
Round  93, Global train loss: 0.527, Global test loss: 1.896, Global test accuracy: 44.83
Round  94, Train loss: 0.576, Test loss: 1.255, Test accuracy: 60.12
Round  94, Global train loss: 0.576, Global test loss: 1.827, Global test accuracy: 45.38
Round  95, Train loss: 0.677, Test loss: 1.241, Test accuracy: 60.35
Round  95, Global train loss: 0.677, Global test loss: 1.834, Global test accuracy: 43.20
Round  96, Train loss: 0.544, Test loss: 1.263, Test accuracy: 60.26
Round  96, Global train loss: 0.544, Global test loss: 1.803, Global test accuracy: 44.02
Round  97, Train loss: 0.473, Test loss: 1.240, Test accuracy: 60.62
Round  97, Global train loss: 0.473, Global test loss: 1.782, Global test accuracy: 44.99
Round  98, Train loss: 0.680, Test loss: 1.225, Test accuracy: 60.61
Round  98, Global train loss: 0.680, Global test loss: 1.798, Global test accuracy: 44.62
Round  99, Train loss: 0.669, Test loss: 1.240, Test accuracy: 59.92
Round  99, Global train loss: 0.669, Global test loss: 1.806, Global test accuracy: 43.55
Final Round, Train loss: 0.480, Test loss: 1.473, Test accuracy: 59.33
Final Round, Global train loss: 0.480, Global test loss: 1.806, Global test accuracy: 43.55
Average accuracy final 10 rounds: 60.23375
Average global accuracy final 10 rounds: 44.552499999999995
2135.5184066295624
[2.8808975219726562, 6.348766803741455, 9.239001512527466, 12.052191257476807, 14.804641962051392, 17.60284662246704, 20.677644968032837, 23.795929431915283, 26.513458013534546, 29.40321969985962, 32.19882607460022, 34.99095296859741, 37.94120979309082, 40.89292573928833, 43.91669988632202, 46.65453028678894, 49.46279811859131, 52.465070486068726, 55.236334800720215, 58.02879548072815, 61.1134729385376, 64.04655122756958, 67.27841567993164, 70.30008387565613, 73.24749422073364, 75.95239305496216, 78.99107599258423, 82.62367129325867, 85.57133173942566, 88.8588285446167, 92.5197446346283, 95.32528567314148, 98.08908247947693, 100.7483537197113, 103.32168126106262, 106.03506374359131, 108.77148747444153, 111.38173341751099, 114.26260042190552, 116.95195007324219, 119.71748733520508, 122.35176825523376, 124.95660996437073, 127.87710094451904, 130.50057196617126, 133.19692420959473, 135.82416915893555, 138.37267804145813, 140.94315433502197, 143.58849120140076, 146.53678798675537, 149.20409512519836, 152.10413551330566, 154.85847449302673, 157.7323694229126, 160.35973119735718, 163.17461323738098, 165.88289427757263, 168.50315880775452, 171.21267676353455, 173.97908687591553, 176.82613110542297, 179.4111316204071, 181.98105597496033, 184.7241883277893, 187.3068449497223, 190.12548112869263, 192.79606080055237, 195.4483003616333, 198.15757727622986, 200.93845963478088, 203.690922498703, 206.41559624671936, 209.0667974948883, 211.71458745002747, 214.4105715751648, 217.11864256858826, 219.6522970199585, 222.32489705085754, 225.17800068855286, 227.7685079574585, 230.27170252799988, 232.93230485916138, 235.57610940933228, 238.11343598365784, 241.01876258850098, 243.74039959907532, 246.31444144248962, 249.0274031162262, 251.65572118759155, 254.38614463806152, 257.189444065094, 259.9005489349365, 262.38624835014343, 265.06961727142334, 267.8730671405792, 270.4373035430908, 272.9983115196228, 275.5782952308655, 278.2077085971832, 283.0207803249359]
[17.8875, 35.5125, 36.975, 40.9875, 40.35, 44.7875, 49.5625, 51.7, 51.4125, 51.8875, 53.6875, 52.8, 55.375, 56.45, 55.3125, 55.425, 55.5375, 56.0375, 57.1125, 57.3875, 59.0375, 59.5375, 59.625, 59.0875, 59.075, 59.8125, 59.575, 59.8375, 59.0875, 59.65, 59.7375, 59.65, 60.25, 60.2875, 60.5375, 60.7375, 60.675, 60.4, 60.2375, 60.575, 60.65, 60.8375, 59.9625, 59.7, 59.7, 59.125, 58.5, 58.725, 59.325, 59.8375, 58.7, 58.975, 58.675, 58.1375, 58.5375, 59.3125, 59.175, 59.15, 59.5375, 57.975, 57.9875, 57.925, 58.425, 59.0125, 59.7875, 59.225, 59.5375, 59.1625, 59.35, 59.8375, 60.0875, 59.95, 60.35, 59.4625, 59.4, 59.7125, 59.65, 59.05, 59.275, 59.4875, 59.6375, 59.9875, 60.2875, 59.825, 59.7, 59.775, 60.05, 60.4, 59.875, 59.65, 60.0, 60.1875, 60.0, 60.25, 60.125, 60.35, 60.2625, 60.625, 60.6125, 59.925, 59.325]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 4, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  14.8300
Round 1 global test acc  17.1900
Round 2 global test acc  16.6000
Round 3 global test acc  13.3100
Round 4 global test acc  19.8200
Round 5 global test acc  22.2000
Round 6 global test acc  20.0500
Round 7 global test acc  22.4800
Round 8 global test acc  15.8800
Round 9 global test acc  20.6000
Round 10 global test acc  23.8100
Round 11 global test acc  25.0000
Round 12 global test acc  19.4400
Round 13 global test acc  22.8100
Round 14 global test acc  25.3100
Round 15 global test acc  25.1600
Round 16 global test acc  22.7000
Round 17 global test acc  21.3000
Round 18 global test acc  29.4700
Round 19 global test acc  20.6900
Round 20 global test acc  19.4200
Round 21 global test acc  20.8200
Round 22 global test acc  23.7000
Round 23 global test acc  34.8900
Round 24 global test acc  23.1400
Round 25 global test acc  27.4900
Round 26 global test acc  29.1800
Round 27 global test acc  22.0000
Round 28 global test acc  36.2000
Round 29 global test acc  23.7200
Round 30 global test acc  25.7600
Round 31 global test acc  26.9500
Round 32 global test acc  22.5600
Round 33 global test acc  22.1400
Round 34 global test acc  29.6800
Round 35 global test acc  29.4300
Round 36 global test acc  37.4000
Round 37 global test acc  29.2500
Round 38 global test acc  35.7700
Round 39 global test acc  24.3300
Round 40 global test acc  28.5600
Round 41 global test acc  32.7200
Round 42 global test acc  25.2300
Round 43 global test acc  26.2000
Round 44 global test acc  24.9100
Round 45 global test acc  23.7700
Round 46 global test acc  27.9100
Round 47 global test acc  34.0300
Round 48 global test acc  25.2700
Round 49 global test acc  26.6700
Round 50 global test acc  25.0300
Round 51 global test acc  30.6000
Round 52 global test acc  26.0200
Round 53 global test acc  35.8800
Round 54 global test acc  28.9300
Round 55 global test acc  34.4200
Round 56 global test acc  30.5400
Round 57 global test acc  32.8900
Round 58 global test acc  24.0800
Round 59 global test acc  33.6900
Round 60 global test acc  29.0400
Round 61 global test acc  32.9900
Round 62 global test acc  27.3500
Round 63 global test acc  26.4600
Round 64 global test acc  25.3400
Round 65 global test acc  32.1900
Round 66 global test acc  42.2400
Round 67 global test acc  30.7800
Round 68 global test acc  35.2700
Round 69 global test acc  32.5200
Round 70 global test acc  32.1800
Round 71 global test acc  36.0600
Round 72 global test acc  31.4500
Round 73 global test acc  25.3500
Round 74 global test acc  27.3800
Round 75 global test acc  34.9000
Round 76 global test acc  32.4800
Round 77 global test acc  28.1000
Round 78 global test acc  29.3500
Round 79 global test acc  27.7700
Round 80 global test acc  28.3900
Round 81 global test acc  25.0800
Round 82 global test acc  24.9000
Round 83 global test acc  23.6700
Round 84 global test acc  25.0800
Round 85 global test acc  24.2300
Round 86 global test acc  23.6200
Round 87 global test acc  23.9000
Round 88 global test acc  23.8000
Round 89 global test acc  23.2600
Round 90 global test acc  22.8700
Round 91 global test acc  22.3300
Round 92 global test acc  22.0500
Round 93 global test acc  21.5700
Round 94 global test acc  21.6100
Round 95 global test acc  21.5300
Round 96 global test acc  21.3200
Round 97 global test acc  21.3700
Round 98 global test acc  21.4600
Round 99 global test acc  21.8100
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 4, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.888, Test loss: 2.247, Test accuracy: 21.61
Round   1, Train loss: 1.471, Test loss: 1.788, Test accuracy: 33.56
Round   2, Train loss: 1.412, Test loss: 1.706, Test accuracy: 34.86
Round   3, Train loss: 1.425, Test loss: 1.502, Test accuracy: 39.83
Round   4, Train loss: 1.361, Test loss: 1.493, Test accuracy: 40.20
Round   5, Train loss: 1.321, Test loss: 1.461, Test accuracy: 42.41
Round   6, Train loss: 1.384, Test loss: 1.332, Test accuracy: 48.58
Round   7, Train loss: 1.278, Test loss: 1.222, Test accuracy: 49.74
Round   8, Train loss: 1.258, Test loss: 1.207, Test accuracy: 51.77
Round   9, Train loss: 1.213, Test loss: 1.232, Test accuracy: 52.33
Round  10, Train loss: 1.241, Test loss: 1.219, Test accuracy: 55.45
Round  11, Train loss: 1.240, Test loss: 1.207, Test accuracy: 55.25
Round  12, Train loss: 1.223, Test loss: 1.037, Test accuracy: 59.05
Round  13, Train loss: 1.223, Test loss: 1.044, Test accuracy: 58.45
Round  14, Train loss: 1.276, Test loss: 1.033, Test accuracy: 59.98
Round  15, Train loss: 1.222, Test loss: 1.038, Test accuracy: 61.69
Round  16, Train loss: 1.166, Test loss: 1.030, Test accuracy: 61.38
Round  17, Train loss: 1.142, Test loss: 0.988, Test accuracy: 62.12
Round  18, Train loss: 1.197, Test loss: 0.968, Test accuracy: 62.16
Round  19, Train loss: 1.137, Test loss: 0.973, Test accuracy: 62.67
Round  20, Train loss: 1.089, Test loss: 0.965, Test accuracy: 63.55
Round  21, Train loss: 1.040, Test loss: 0.950, Test accuracy: 64.03
Round  22, Train loss: 1.133, Test loss: 0.958, Test accuracy: 63.80
Round  23, Train loss: 1.024, Test loss: 0.952, Test accuracy: 64.44
Round  24, Train loss: 1.002, Test loss: 0.926, Test accuracy: 64.61
Round  25, Train loss: 1.034, Test loss: 0.929, Test accuracy: 64.75
Round  26, Train loss: 1.041, Test loss: 0.911, Test accuracy: 65.17
Round  27, Train loss: 1.033, Test loss: 0.918, Test accuracy: 65.47
Round  28, Train loss: 1.147, Test loss: 0.925, Test accuracy: 65.85
Round  29, Train loss: 1.204, Test loss: 0.924, Test accuracy: 65.96
Round  30, Train loss: 1.149, Test loss: 0.914, Test accuracy: 66.45
Round  31, Train loss: 1.137, Test loss: 0.926, Test accuracy: 67.26
Round  32, Train loss: 0.991, Test loss: 0.908, Test accuracy: 67.14
Round  33, Train loss: 1.123, Test loss: 0.899, Test accuracy: 66.95
Round  34, Train loss: 1.013, Test loss: 0.908, Test accuracy: 67.40
Round  35, Train loss: 1.059, Test loss: 0.894, Test accuracy: 67.21
Round  36, Train loss: 0.993, Test loss: 0.890, Test accuracy: 67.14
Round  37, Train loss: 1.058, Test loss: 0.909, Test accuracy: 66.84
Round  38, Train loss: 1.126, Test loss: 0.880, Test accuracy: 67.16
Round  39, Train loss: 0.971, Test loss: 0.877, Test accuracy: 68.09
Round  40, Train loss: 0.997, Test loss: 0.870, Test accuracy: 67.72
Round  41, Train loss: 1.058, Test loss: 0.866, Test accuracy: 68.08
Round  42, Train loss: 0.963, Test loss: 0.856, Test accuracy: 68.64
Round  43, Train loss: 0.978, Test loss: 0.857, Test accuracy: 69.08
Round  44, Train loss: 1.084, Test loss: 0.867, Test accuracy: 68.67
Round  45, Train loss: 0.904, Test loss: 0.859, Test accuracy: 68.46
Round  46, Train loss: 1.047, Test loss: 0.864, Test accuracy: 68.70
Round  47, Train loss: 0.933, Test loss: 0.860, Test accuracy: 68.44
Round  48, Train loss: 1.057, Test loss: 0.857, Test accuracy: 68.49
Round  49, Train loss: 1.177, Test loss: 0.859, Test accuracy: 68.69
Round  50, Train loss: 0.852, Test loss: 0.843, Test accuracy: 69.67
Round  51, Train loss: 1.036, Test loss: 0.847, Test accuracy: 69.72
Round  52, Train loss: 1.011, Test loss: 0.843, Test accuracy: 69.72
Round  53, Train loss: 1.066, Test loss: 0.856, Test accuracy: 69.34
Round  54, Train loss: 1.102, Test loss: 0.843, Test accuracy: 70.16
Round  55, Train loss: 0.812, Test loss: 0.831, Test accuracy: 70.29
Round  56, Train loss: 0.990, Test loss: 0.833, Test accuracy: 69.51
Round  57, Train loss: 1.013, Test loss: 0.831, Test accuracy: 69.90
Round  58, Train loss: 0.933, Test loss: 0.837, Test accuracy: 70.26
Round  59, Train loss: 1.124, Test loss: 0.843, Test accuracy: 69.85
Round  60, Train loss: 1.050, Test loss: 0.840, Test accuracy: 69.95
Round  61, Train loss: 0.951, Test loss: 0.824, Test accuracy: 69.76
Round  62, Train loss: 1.138, Test loss: 0.844, Test accuracy: 69.55
Round  63, Train loss: 0.883, Test loss: 0.831, Test accuracy: 69.91
Round  64, Train loss: 0.958, Test loss: 0.821, Test accuracy: 70.49
Round  65, Train loss: 0.792, Test loss: 0.815, Test accuracy: 69.84
Round  66, Train loss: 0.924, Test loss: 0.807, Test accuracy: 70.30
Round  67, Train loss: 1.063, Test loss: 0.809, Test accuracy: 70.05
Round  68, Train loss: 0.952, Test loss: 0.819, Test accuracy: 70.30
Round  69, Train loss: 0.931, Test loss: 0.839, Test accuracy: 69.83
Round  70, Train loss: 1.013, Test loss: 0.823, Test accuracy: 70.59
Round  71, Train loss: 0.939, Test loss: 0.816, Test accuracy: 70.61
Round  72, Train loss: 0.979, Test loss: 0.812, Test accuracy: 70.46
Round  73, Train loss: 0.924, Test loss: 0.810, Test accuracy: 70.17
Round  74, Train loss: 0.950, Test loss: 0.815, Test accuracy: 70.60
Round  75, Train loss: 0.874, Test loss: 0.815, Test accuracy: 69.69
Round  76, Train loss: 1.070, Test loss: 0.824, Test accuracy: 69.47
Round  77, Train loss: 0.846, Test loss: 0.828, Test accuracy: 69.14
Round  78, Train loss: 0.695, Test loss: 0.819, Test accuracy: 70.08
Round  79, Train loss: 0.981, Test loss: 0.832, Test accuracy: 69.84
Round  80, Train loss: 0.782, Test loss: 0.818, Test accuracy: 70.24
Round  81, Train loss: 0.973, Test loss: 0.827, Test accuracy: 69.53
Round  82, Train loss: 0.985, Test loss: 0.812, Test accuracy: 70.04
Round  83, Train loss: 0.829, Test loss: 0.814, Test accuracy: 69.71
Round  84, Train loss: 0.963, Test loss: 0.819, Test accuracy: 69.58
Round  85, Train loss: 0.997, Test loss: 0.839, Test accuracy: 69.51
Round  86, Train loss: 0.837, Test loss: 0.824, Test accuracy: 69.71
Round  87, Train loss: 0.757, Test loss: 0.818, Test accuracy: 69.92
Round  88, Train loss: 0.802, Test loss: 0.814, Test accuracy: 70.05
Round  89, Train loss: 0.904, Test loss: 0.808, Test accuracy: 70.54
Round  90, Train loss: 0.752, Test loss: 0.812, Test accuracy: 69.91
Round  91, Train loss: 0.782, Test loss: 0.814, Test accuracy: 69.74
Round  92, Train loss: 0.712, Test loss: 0.817, Test accuracy: 69.80
Round  93, Train loss: 0.819, Test loss: 0.824, Test accuracy: 69.03
Round  94, Train loss: 0.878, Test loss: 0.826, Test accuracy: 69.26
Round  95, Train loss: 0.773, Test loss: 0.840, Test accuracy: 68.85
Round  96, Train loss: 0.935, Test loss: 0.833, Test accuracy: 69.00
Round  97, Train loss: 0.735, Test loss: 0.825, Test accuracy: 68.99
Round  98, Train loss: 0.756, Test loss: 0.819, Test accuracy: 69.76
Round  99, Train loss: 0.903, Test loss: 0.838, Test accuracy: 68.72
Final Round, Train loss: 0.765, Test loss: 0.830, Test accuracy: 69.11
Average accuracy final 10 rounds: 69.30624999999999
1107.972680091858
[1.631056785583496, 3.262235164642334, 4.516238451004028, 6.01959753036499, 7.365715503692627, 8.841009616851807, 10.190821170806885, 11.516031980514526, 12.864516258239746, 14.374729871749878, 15.688454866409302, 17.08857774734497, 18.37452244758606, 19.731274604797363, 21.037908792495728, 22.33392858505249, 23.711677074432373, 25.01549792289734, 26.3337824344635, 27.736358880996704, 29.171427011489868, 30.672937154769897, 32.097564935684204, 33.63976001739502, 34.97656059265137, 36.4087336063385, 37.712520122528076, 39.107261419296265, 40.44657874107361, 41.81578874588013, 43.116010427474976, 44.50568652153015, 45.93256330490112, 47.36852812767029, 48.712610721588135, 50.10611057281494, 51.52205681800842, 52.93881630897522, 54.38656783103943, 55.72466969490051, 57.10149621963501, 58.48747539520264, 59.81423044204712, 61.21285057067871, 62.532702922821045, 63.960402727127075, 65.40258502960205, 66.74648427963257, 68.14955520629883, 69.59142112731934, 70.88456225395203, 72.25203919410706, 73.72011256217957, 75.01833963394165, 76.44851994514465, 77.9243791103363, 79.23767852783203, 80.64462518692017, 82.03607249259949, 83.40709662437439, 84.78036117553711, 86.34163498878479, 87.73921251296997, 89.11158299446106, 90.62125897407532, 92.08236813545227, 93.42725682258606, 94.74469494819641, 96.01400566101074, 97.39910244941711, 98.84253978729248, 100.22366189956665, 101.61367344856262, 102.9585554599762, 104.4915452003479, 105.78747224807739, 107.15005159378052, 108.55022025108337, 109.93037462234497, 111.2903003692627, 113.24616599082947, 115.19743990898132, 117.12938046455383, 119.07189750671387, 120.89244842529297, 122.88426065444946, 124.89346599578857, 126.9139084815979, 128.9425950050354, 130.96863460540771, 133.02455949783325, 135.09490251541138, 136.94625806808472, 138.55852913856506, 140.15912127494812, 141.60694217681885, 143.08316898345947, 144.6066472530365, 146.21192002296448, 147.9596447944641, 151.18637561798096]
[21.6125, 33.5625, 34.8625, 39.825, 40.2, 42.4125, 48.575, 49.7375, 51.775, 52.325, 55.45, 55.25, 59.05, 58.45, 59.975, 61.6875, 61.375, 62.125, 62.1625, 62.675, 63.55, 64.025, 63.8, 64.4375, 64.6125, 64.75, 65.175, 65.475, 65.85, 65.9625, 66.45, 67.2625, 67.1375, 66.95, 67.4, 67.2125, 67.1375, 66.8375, 67.1625, 68.0875, 67.725, 68.075, 68.6375, 69.075, 68.675, 68.4625, 68.7, 68.4375, 68.4875, 68.6875, 69.675, 69.725, 69.725, 69.3375, 70.1625, 70.2875, 69.5125, 69.9, 70.2625, 69.85, 69.95, 69.7625, 69.55, 69.9125, 70.4875, 69.8375, 70.3, 70.05, 70.3, 69.825, 70.5875, 70.6125, 70.4625, 70.175, 70.6, 69.6875, 69.475, 69.1375, 70.075, 69.8375, 70.2375, 69.525, 70.0375, 69.7125, 69.575, 69.5125, 69.7125, 69.925, 70.05, 70.5375, 69.9125, 69.7375, 69.8, 69.025, 69.2625, 68.85, 69.0, 68.9875, 69.7625, 68.725, 69.1125]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 4, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.614, Test loss: 2.058, Test accuracy: 20.98
Round   0, Global train loss: 1.614, Global test loss: 2.282, Global test accuracy: 17.23
Round   1, Train loss: 1.370, Test loss: 1.612, Test accuracy: 33.09
Round   1, Global train loss: 1.370, Global test loss: 2.104, Global test accuracy: 19.70
Round   2, Train loss: 1.343, Test loss: 1.508, Test accuracy: 37.84
Round   2, Global train loss: 1.343, Global test loss: 2.072, Global test accuracy: 19.99
Round   3, Train loss: 1.376, Test loss: 1.395, Test accuracy: 40.94
Round   3, Global train loss: 1.376, Global test loss: 2.063, Global test accuracy: 24.12
Round   4, Train loss: 1.319, Test loss: 1.384, Test accuracy: 42.29
Round   4, Global train loss: 1.319, Global test loss: 2.042, Global test accuracy: 24.38
Round   5, Train loss: 1.368, Test loss: 1.325, Test accuracy: 47.86
Round   5, Global train loss: 1.368, Global test loss: 1.958, Global test accuracy: 30.32
Round   6, Train loss: 1.234, Test loss: 1.220, Test accuracy: 52.88
Round   6, Global train loss: 1.234, Global test loss: 2.125, Global test accuracy: 27.44
Round   7, Train loss: 1.269, Test loss: 1.144, Test accuracy: 54.75
Round   7, Global train loss: 1.269, Global test loss: 1.822, Global test accuracy: 33.73
Round   8, Train loss: 1.259, Test loss: 1.142, Test accuracy: 55.00
Round   8, Global train loss: 1.259, Global test loss: 1.891, Global test accuracy: 35.59
Round   9, Train loss: 1.270, Test loss: 1.131, Test accuracy: 55.85
Round   9, Global train loss: 1.270, Global test loss: 1.959, Global test accuracy: 31.73
Round  10, Train loss: 1.117, Test loss: 1.122, Test accuracy: 56.46
Round  10, Global train loss: 1.117, Global test loss: 1.888, Global test accuracy: 36.41
Round  11, Train loss: 1.170, Test loss: 1.104, Test accuracy: 56.62
Round  11, Global train loss: 1.170, Global test loss: 1.879, Global test accuracy: 32.11
Round  12, Train loss: 1.187, Test loss: 1.025, Test accuracy: 59.49
Round  12, Global train loss: 1.187, Global test loss: 1.928, Global test accuracy: 32.67
Round  13, Train loss: 1.007, Test loss: 1.024, Test accuracy: 58.88
Round  13, Global train loss: 1.007, Global test loss: 1.939, Global test accuracy: 34.40
Round  14, Train loss: 1.196, Test loss: 1.003, Test accuracy: 59.76
Round  14, Global train loss: 1.196, Global test loss: 1.763, Global test accuracy: 38.51
Round  15, Train loss: 1.296, Test loss: 0.989, Test accuracy: 60.76
Round  15, Global train loss: 1.296, Global test loss: 1.753, Global test accuracy: 39.70
Round  16, Train loss: 1.129, Test loss: 1.003, Test accuracy: 60.29
Round  16, Global train loss: 1.129, Global test loss: 1.672, Global test accuracy: 42.65
Round  17, Train loss: 1.250, Test loss: 0.994, Test accuracy: 60.75
Round  17, Global train loss: 1.250, Global test loss: 1.857, Global test accuracy: 37.04
Round  18, Train loss: 1.201, Test loss: 0.996, Test accuracy: 60.58
Round  18, Global train loss: 1.201, Global test loss: 1.812, Global test accuracy: 39.95
Round  19, Train loss: 1.106, Test loss: 0.993, Test accuracy: 60.99
Round  19, Global train loss: 1.106, Global test loss: 1.848, Global test accuracy: 33.66
Round  20, Train loss: 1.211, Test loss: 1.004, Test accuracy: 60.52
Round  20, Global train loss: 1.211, Global test loss: 1.802, Global test accuracy: 34.42
Round  21, Train loss: 1.079, Test loss: 0.990, Test accuracy: 61.09
Round  21, Global train loss: 1.079, Global test loss: 1.711, Global test accuracy: 41.41
Round  22, Train loss: 1.080, Test loss: 0.983, Test accuracy: 61.10
Round  22, Global train loss: 1.080, Global test loss: 1.786, Global test accuracy: 33.79
Round  23, Train loss: 1.004, Test loss: 0.976, Test accuracy: 61.45
Round  23, Global train loss: 1.004, Global test loss: 1.688, Global test accuracy: 42.92
Round  24, Train loss: 1.063, Test loss: 0.976, Test accuracy: 61.64
Round  24, Global train loss: 1.063, Global test loss: 1.664, Global test accuracy: 38.67
Round  25, Train loss: 1.044, Test loss: 0.971, Test accuracy: 62.62
Round  25, Global train loss: 1.044, Global test loss: 1.768, Global test accuracy: 40.73
Round  26, Train loss: 1.113, Test loss: 0.972, Test accuracy: 61.60
Round  26, Global train loss: 1.113, Global test loss: 1.808, Global test accuracy: 37.06
Round  27, Train loss: 1.111, Test loss: 0.975, Test accuracy: 61.45
Round  27, Global train loss: 1.111, Global test loss: 1.902, Global test accuracy: 34.49
Round  28, Train loss: 1.186, Test loss: 0.960, Test accuracy: 62.73
Round  28, Global train loss: 1.186, Global test loss: 1.584, Global test accuracy: 43.77
Round  29, Train loss: 0.942, Test loss: 0.964, Test accuracy: 62.54
Round  29, Global train loss: 0.942, Global test loss: 1.654, Global test accuracy: 41.70
Round  30, Train loss: 0.876, Test loss: 0.959, Test accuracy: 63.06
Round  30, Global train loss: 0.876, Global test loss: 1.526, Global test accuracy: 46.15
Round  31, Train loss: 1.044, Test loss: 0.976, Test accuracy: 62.15
Round  31, Global train loss: 1.044, Global test loss: 1.629, Global test accuracy: 44.55
Round  32, Train loss: 1.078, Test loss: 0.980, Test accuracy: 62.44
Round  32, Global train loss: 1.078, Global test loss: 1.640, Global test accuracy: 38.96
Round  33, Train loss: 0.972, Test loss: 0.981, Test accuracy: 62.58
Round  33, Global train loss: 0.972, Global test loss: 1.721, Global test accuracy: 41.15
Round  34, Train loss: 1.001, Test loss: 0.975, Test accuracy: 62.89
Round  34, Global train loss: 1.001, Global test loss: 1.559, Global test accuracy: 46.04
Round  35, Train loss: 0.866, Test loss: 0.990, Test accuracy: 63.06
Round  35, Global train loss: 0.866, Global test loss: 1.756, Global test accuracy: 41.58
Round  36, Train loss: 1.057, Test loss: 0.978, Test accuracy: 63.38
Round  36, Global train loss: 1.057, Global test loss: 1.649, Global test accuracy: 44.88
Round  37, Train loss: 0.935, Test loss: 0.966, Test accuracy: 64.12
Round  37, Global train loss: 0.935, Global test loss: 1.514, Global test accuracy: 47.86
Round  38, Train loss: 1.017, Test loss: 0.951, Test accuracy: 63.80
Round  38, Global train loss: 1.017, Global test loss: 2.072, Global test accuracy: 34.38
Round  39, Train loss: 1.189, Test loss: 0.973, Test accuracy: 63.26
Round  39, Global train loss: 1.189, Global test loss: 1.611, Global test accuracy: 45.50
Round  40, Train loss: 1.017, Test loss: 0.970, Test accuracy: 63.42
Round  40, Global train loss: 1.017, Global test loss: 1.580, Global test accuracy: 46.31
Round  41, Train loss: 0.971, Test loss: 0.953, Test accuracy: 64.33
Round  41, Global train loss: 0.971, Global test loss: 1.782, Global test accuracy: 38.01
Round  42, Train loss: 1.002, Test loss: 0.939, Test accuracy: 63.98
Round  42, Global train loss: 1.002, Global test loss: 1.539, Global test accuracy: 48.58
Round  43, Train loss: 1.000, Test loss: 0.966, Test accuracy: 63.08
Round  43, Global train loss: 1.000, Global test loss: 2.100, Global test accuracy: 32.91
Round  44, Train loss: 0.903, Test loss: 0.958, Test accuracy: 63.77
Round  44, Global train loss: 0.903, Global test loss: 1.664, Global test accuracy: 41.83
Round  45, Train loss: 1.051, Test loss: 0.949, Test accuracy: 63.88
Round  45, Global train loss: 1.051, Global test loss: 1.690, Global test accuracy: 42.19
Round  46, Train loss: 0.937, Test loss: 0.972, Test accuracy: 63.40
Round  46, Global train loss: 0.937, Global test loss: 1.645, Global test accuracy: 45.52
Round  47, Train loss: 1.012, Test loss: 0.961, Test accuracy: 64.15
Round  47, Global train loss: 1.012, Global test loss: 1.602, Global test accuracy: 46.09
Round  48, Train loss: 0.872, Test loss: 0.968, Test accuracy: 63.86
Round  48, Global train loss: 0.872, Global test loss: 1.641, Global test accuracy: 46.51
Round  49, Train loss: 0.922, Test loss: 0.957, Test accuracy: 63.49
Round  49, Global train loss: 0.922, Global test loss: 1.598, Global test accuracy: 45.92
Round  50, Train loss: 0.915, Test loss: 0.964, Test accuracy: 62.81
Round  50, Global train loss: 0.915, Global test loss: 1.627, Global test accuracy: 46.15
Round  51, Train loss: 0.914, Test loss: 0.966, Test accuracy: 63.01
Round  51, Global train loss: 0.914, Global test loss: 1.573, Global test accuracy: 47.50
Round  52, Train loss: 0.964, Test loss: 0.983, Test accuracy: 62.50
Round  52, Global train loss: 0.964, Global test loss: 1.593, Global test accuracy: 46.36
Round  53, Train loss: 0.821, Test loss: 1.004, Test accuracy: 61.70
Round  53, Global train loss: 0.821, Global test loss: 1.586, Global test accuracy: 47.00
Round  54, Train loss: 0.871, Test loss: 0.999, Test accuracy: 62.44
Round  54, Global train loss: 0.871, Global test loss: 1.860, Global test accuracy: 40.92
Round  55, Train loss: 0.899, Test loss: 0.999, Test accuracy: 62.41
Round  55, Global train loss: 0.899, Global test loss: 1.650, Global test accuracy: 45.15
Round  56, Train loss: 0.905, Test loss: 1.013, Test accuracy: 62.01
Round  56, Global train loss: 0.905, Global test loss: 1.639, Global test accuracy: 46.34
Round  57, Train loss: 0.793, Test loss: 1.021, Test accuracy: 62.09
Round  57, Global train loss: 0.793, Global test loss: 1.693, Global test accuracy: 45.76
Round  58, Train loss: 0.976, Test loss: 1.012, Test accuracy: 62.40
Round  58, Global train loss: 0.976, Global test loss: 1.737, Global test accuracy: 42.74
Round  59, Train loss: 0.872, Test loss: 1.025, Test accuracy: 62.38
Round  59, Global train loss: 0.872, Global test loss: 1.703, Global test accuracy: 44.91
Round  60, Train loss: 0.747, Test loss: 1.025, Test accuracy: 62.45
Round  60, Global train loss: 0.747, Global test loss: 1.614, Global test accuracy: 46.01
Round  61, Train loss: 0.753, Test loss: 1.048, Test accuracy: 62.04
Round  61, Global train loss: 0.753, Global test loss: 1.749, Global test accuracy: 44.31
Round  62, Train loss: 0.736, Test loss: 1.055, Test accuracy: 62.04
Round  62, Global train loss: 0.736, Global test loss: 1.757, Global test accuracy: 46.45
Round  63, Train loss: 0.926, Test loss: 1.034, Test accuracy: 62.58
Round  63, Global train loss: 0.926, Global test loss: 1.646, Global test accuracy: 45.02
Round  64, Train loss: 0.669, Test loss: 1.068, Test accuracy: 61.84
Round  64, Global train loss: 0.669, Global test loss: 1.647, Global test accuracy: 47.06
Round  65, Train loss: 0.752, Test loss: 1.066, Test accuracy: 61.99
Round  65, Global train loss: 0.752, Global test loss: 1.773, Global test accuracy: 43.59
Round  66, Train loss: 0.936, Test loss: 1.046, Test accuracy: 62.65
Round  66, Global train loss: 0.936, Global test loss: 1.597, Global test accuracy: 46.96
Round  67, Train loss: 0.762, Test loss: 1.050, Test accuracy: 62.51
Round  67, Global train loss: 0.762, Global test loss: 1.683, Global test accuracy: 45.06
Round  68, Train loss: 0.620, Test loss: 1.062, Test accuracy: 62.27
Round  68, Global train loss: 0.620, Global test loss: 1.581, Global test accuracy: 48.52
Round  69, Train loss: 0.712, Test loss: 1.071, Test accuracy: 61.64
Round  69, Global train loss: 0.712, Global test loss: 1.592, Global test accuracy: 47.20
Round  70, Train loss: 0.667, Test loss: 1.061, Test accuracy: 62.05
Round  70, Global train loss: 0.667, Global test loss: 1.785, Global test accuracy: 44.11
Round  71, Train loss: 0.816, Test loss: 1.060, Test accuracy: 62.51
Round  71, Global train loss: 0.816, Global test loss: 1.865, Global test accuracy: 41.38
Round  72, Train loss: 0.689, Test loss: 1.080, Test accuracy: 62.26
Round  72, Global train loss: 0.689, Global test loss: 1.534, Global test accuracy: 48.94
Round  73, Train loss: 0.829, Test loss: 1.094, Test accuracy: 61.91
Round  73, Global train loss: 0.829, Global test loss: 1.840, Global test accuracy: 42.85
Round  74, Train loss: 0.798, Test loss: 1.114, Test accuracy: 61.51
Round  74, Global train loss: 0.798, Global test loss: 1.803, Global test accuracy: 42.92
Round  75, Train loss: 0.782, Test loss: 1.131, Test accuracy: 61.21
Round  75, Global train loss: 0.782, Global test loss: 1.858, Global test accuracy: 42.85
Round  76, Train loss: 0.631, Test loss: 1.111, Test accuracy: 61.14
Round  76, Global train loss: 0.631, Global test loss: 1.756, Global test accuracy: 45.51
Round  77, Train loss: 0.775, Test loss: 1.103, Test accuracy: 61.52
Round  77, Global train loss: 0.775, Global test loss: 1.758, Global test accuracy: 43.80
Round  78, Train loss: 0.784, Test loss: 1.130, Test accuracy: 60.86
Round  78, Global train loss: 0.784, Global test loss: 1.665, Global test accuracy: 45.12
Round  79, Train loss: 0.707, Test loss: 1.128, Test accuracy: 61.51
Round  79, Global train loss: 0.707, Global test loss: 1.558, Global test accuracy: 49.21
Round  80, Train loss: 0.707, Test loss: 1.139, Test accuracy: 61.38
Round  80, Global train loss: 0.707, Global test loss: 1.779, Global test accuracy: 43.86
Round  81, Train loss: 0.734, Test loss: 1.138, Test accuracy: 61.46
Round  81, Global train loss: 0.734, Global test loss: 1.664, Global test accuracy: 46.12
Round  82, Train loss: 0.598, Test loss: 1.150, Test accuracy: 61.33
Round  82, Global train loss: 0.598, Global test loss: 1.773, Global test accuracy: 47.12
Round  83, Train loss: 0.748, Test loss: 1.182, Test accuracy: 60.36
Round  83, Global train loss: 0.748, Global test loss: 1.718, Global test accuracy: 45.71
Round  84, Train loss: 0.682, Test loss: 1.161, Test accuracy: 60.98
Round  84, Global train loss: 0.682, Global test loss: 1.694, Global test accuracy: 47.76
Round  85, Train loss: 0.721, Test loss: 1.142, Test accuracy: 61.79
Round  85, Global train loss: 0.721, Global test loss: 1.723, Global test accuracy: 45.71
Round  86, Train loss: 0.697, Test loss: 1.163, Test accuracy: 61.35
Round  86, Global train loss: 0.697, Global test loss: 1.799, Global test accuracy: 44.31
Round  87, Train loss: 0.659, Test loss: 1.184, Test accuracy: 60.52
Round  87, Global train loss: 0.659, Global test loss: 1.672, Global test accuracy: 46.16
Round  88, Train loss: 0.628, Test loss: 1.201, Test accuracy: 60.55
Round  88, Global train loss: 0.628, Global test loss: 1.806, Global test accuracy: 45.14
Round  89, Train loss: 0.626, Test loss: 1.200, Test accuracy: 60.14
Round  89, Global train loss: 0.626, Global test loss: 1.802, Global test accuracy: 44.34
Round  90, Train loss: 0.680, Test loss: 1.204, Test accuracy: 60.55
Round  90, Global train loss: 0.680, Global test loss: 1.795, Global test accuracy: 46.84
Round  91, Train loss: 0.724, Test loss: 1.200, Test accuracy: 60.73
Round  91, Global train loss: 0.724, Global test loss: 1.725, Global test accuracy: 45.42
Round  92, Train loss: 0.714, Test loss: 1.202, Test accuracy: 61.02
Round  92, Global train loss: 0.714, Global test loss: 1.798, Global test accuracy: 43.79
Round  93, Train loss: 0.627, Test loss: 1.202, Test accuracy: 61.00
Round  93, Global train loss: 0.627, Global test loss: 1.882, Global test accuracy: 43.90
Round  94, Train loss: 0.583, Test loss: 1.206, Test accuracy: 61.26
Round  94, Global train loss: 0.583, Global test loss: 1.821, Global test accuracy: 46.49
Round  95, Train loss: 0.719, Test loss: 1.189, Test accuracy: 62.10
Round  95, Global train loss: 0.719, Global test loss: 1.727, Global test accuracy: 45.38
Round  96, Train loss: 0.677, Test loss: 1.189, Test accuracy: 61.79
Round  96, Global train loss: 0.677, Global test loss: 1.784, Global test accuracy: 44.02
Round  97, Train loss: 0.612, Test loss: 1.219, Test accuracy: 60.88
Round  97, Global train loss: 0.612, Global test loss: 2.007, Global test accuracy: 43.09
Round  98, Train loss: 0.562, Test loss: 1.219, Test accuracy: 60.60
Round  98, Global train loss: 0.562, Global test loss: 1.901, Global test accuracy: 43.23
Round  99, Train loss: 0.592, Test loss: 1.209, Test accuracy: 61.16
Round  99, Global train loss: 0.592, Global test loss: 1.813, Global test accuracy: 45.08
Final Round, Train loss: 0.478, Test loss: 1.374, Test accuracy: 60.96
Final Round, Global train loss: 0.478, Global test loss: 1.813, Global test accuracy: 45.08
Average accuracy final 10 rounds: 61.10875
Average global accuracy final 10 rounds: 44.7225
1934.9064321517944
[1.7661702632904053, 2.9582741260528564, 4.1941187381744385, 5.457162618637085, 6.695383071899414, 8.049714803695679, 9.370788335800171, 10.586371660232544, 11.985491037368774, 13.11829662322998, 14.356400489807129, 15.524605989456177, 16.73919105529785, 17.992297172546387, 19.16261100769043, 20.41617774963379, 21.64111018180847, 22.879780769348145, 24.187500476837158, 25.539806604385376, 26.896161556243896, 29.90625238418579, 33.04279708862305, 35.998074769973755, 38.88451910018921, 41.85097646713257, 44.81457304954529, 47.842209339141846, 50.86109232902527, 54.02822494506836, 57.004520654678345, 59.90214681625366, 62.837727785110474, 65.85588836669922, 68.9112811088562, 71.90186405181885, 74.90252137184143, 77.85938167572021, 80.91987609863281, 84.07692646980286, 86.90191292762756, 89.75050234794617, 92.53077030181885, 95.4202401638031, 98.26851320266724, 101.15187692642212, 103.97503781318665, 106.75749683380127, 109.41083908081055, 112.10371398925781, 114.7767059803009, 117.44877934455872, 120.20040702819824, 122.95830583572388, 125.8038260936737, 128.59867119789124, 131.27633047103882, 134.0057876110077, 136.64458894729614, 139.40047693252563, 142.00275921821594, 144.56631350517273, 147.23114848136902, 149.86456155776978, 152.5943284034729, 155.32925057411194, 158.06317925453186, 160.76396441459656, 163.43806099891663, 166.19608306884766, 169.04536366462708, 171.90103483200073, 174.599454164505, 177.40562796592712, 180.1608510017395, 182.83070635795593, 185.5962314605713, 188.13660717010498, 190.86583852767944, 193.61046624183655, 196.34723377227783, 199.1418068408966, 201.74578762054443, 204.50176167488098, 207.29166102409363, 210.07718420028687, 212.83391070365906, 215.50986886024475, 218.3509590625763, 221.14141726493835, 224.2617313861847, 227.1505331993103, 229.8938009738922, 232.4833333492279, 235.16086745262146, 237.92003083229065, 240.54792547225952, 243.18845868110657, 245.89578986167908, 248.5494418144226, 250.96474599838257]
[20.975, 33.0875, 37.8375, 40.9375, 42.2875, 47.8625, 52.875, 54.75, 55.0, 55.85, 56.4625, 56.625, 59.4875, 58.875, 59.7625, 60.7625, 60.2875, 60.75, 60.575, 60.9875, 60.525, 61.0875, 61.1, 61.45, 61.6375, 62.625, 61.6, 61.45, 62.725, 62.5375, 63.0625, 62.15, 62.4375, 62.575, 62.8875, 63.0625, 63.375, 64.125, 63.8, 63.2625, 63.425, 64.325, 63.975, 63.075, 63.775, 63.875, 63.4, 64.15, 63.8625, 63.4875, 62.8125, 63.0125, 62.5, 61.7, 62.4375, 62.4125, 62.0125, 62.0875, 62.4, 62.375, 62.45, 62.0375, 62.0375, 62.575, 61.8375, 61.9875, 62.65, 62.5125, 62.275, 61.6375, 62.05, 62.5125, 62.2625, 61.9125, 61.5125, 61.2125, 61.1375, 61.525, 60.8625, 61.5125, 61.375, 61.4625, 61.325, 60.3625, 60.975, 61.7875, 61.35, 60.525, 60.55, 60.1375, 60.55, 60.725, 61.025, 61.0, 61.2625, 62.1, 61.7875, 60.875, 60.6, 61.1625, 60.9625]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 4, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.414, Test loss: 1.192, Test accuracy: 47.16
Round   0, Global train loss: 1.414, Global test loss: 2.202, Global test accuracy: 18.82
Round   1, Train loss: 1.307, Test loss: 1.112, Test accuracy: 53.41
Round   1, Global train loss: 1.307, Global test loss: 2.006, Global test accuracy: 25.75
Round   2, Train loss: 1.243, Test loss: 1.070, Test accuracy: 55.55
Round   2, Global train loss: 1.243, Global test loss: 1.867, Global test accuracy: 33.21
Round   3, Train loss: 1.195, Test loss: 1.019, Test accuracy: 58.31
Round   3, Global train loss: 1.195, Global test loss: 1.803, Global test accuracy: 35.24
Round   4, Train loss: 1.160, Test loss: 0.995, Test accuracy: 59.44
Round   4, Global train loss: 1.160, Global test loss: 1.738, Global test accuracy: 37.61
Round   5, Train loss: 1.129, Test loss: 1.008, Test accuracy: 58.94
Round   5, Global train loss: 1.129, Global test loss: 1.687, Global test accuracy: 40.41
Round   6, Train loss: 1.102, Test loss: 1.005, Test accuracy: 59.56
Round   6, Global train loss: 1.102, Global test loss: 1.661, Global test accuracy: 40.99
Round   7, Train loss: 1.076, Test loss: 0.976, Test accuracy: 60.67
Round   7, Global train loss: 1.076, Global test loss: 1.620, Global test accuracy: 42.25
Round   8, Train loss: 1.053, Test loss: 0.959, Test accuracy: 61.39
Round   8, Global train loss: 1.053, Global test loss: 1.590, Global test accuracy: 43.44
Round   9, Train loss: 1.026, Test loss: 0.963, Test accuracy: 61.77
Round   9, Global train loss: 1.026, Global test loss: 1.561, Global test accuracy: 44.40
Round  10, Train loss: 0.781, Test loss: 0.963, Test accuracy: 61.70
Round  10, Global train loss: 0.781, Global test loss: 1.767, Global test accuracy: 41.85
Round  11, Train loss: 0.864, Test loss: 0.951, Test accuracy: 62.35
Round  11, Global train loss: 0.864, Global test loss: 1.731, Global test accuracy: 38.23
Round  12, Train loss: 1.073, Test loss: 0.935, Test accuracy: 62.95
Round  12, Global train loss: 1.073, Global test loss: 1.749, Global test accuracy: 38.25
Round  13, Train loss: 0.977, Test loss: 0.948, Test accuracy: 62.33
Round  13, Global train loss: 0.977, Global test loss: 1.701, Global test accuracy: 41.20
Round  14, Train loss: 0.861, Test loss: 0.957, Test accuracy: 62.35
Round  14, Global train loss: 0.861, Global test loss: 1.699, Global test accuracy: 40.04
Round  15, Train loss: 0.878, Test loss: 0.964, Test accuracy: 61.96
Round  15, Global train loss: 0.878, Global test loss: 1.644, Global test accuracy: 43.39
Round  16, Train loss: 0.741, Test loss: 0.979, Test accuracy: 61.33
Round  16, Global train loss: 0.741, Global test loss: 1.513, Global test accuracy: 47.58
Round  17, Train loss: 0.997, Test loss: 0.997, Test accuracy: 61.06
Round  17, Global train loss: 0.997, Global test loss: 1.792, Global test accuracy: 41.86
Round  18, Train loss: 0.916, Test loss: 1.014, Test accuracy: 60.59
Round  18, Global train loss: 0.916, Global test loss: 1.782, Global test accuracy: 41.01
Round  19, Train loss: 0.836, Test loss: 1.054, Test accuracy: 60.12
Round  19, Global train loss: 0.836, Global test loss: 1.943, Global test accuracy: 37.56
Round  20, Train loss: 0.883, Test loss: 1.078, Test accuracy: 59.54
Round  20, Global train loss: 0.883, Global test loss: 1.853, Global test accuracy: 35.34
Round  21, Train loss: 0.812, Test loss: 1.102, Test accuracy: 59.08
Round  21, Global train loss: 0.812, Global test loss: 1.713, Global test accuracy: 44.71
Round  22, Train loss: 0.826, Test loss: 1.119, Test accuracy: 59.48
Round  22, Global train loss: 0.826, Global test loss: 1.858, Global test accuracy: 36.42
Round  23, Train loss: 0.676, Test loss: 1.120, Test accuracy: 59.60
Round  23, Global train loss: 0.676, Global test loss: 1.732, Global test accuracy: 44.44
Round  24, Train loss: 0.637, Test loss: 1.164, Test accuracy: 59.41
Round  24, Global train loss: 0.637, Global test loss: 1.672, Global test accuracy: 43.81
Round  25, Train loss: 0.758, Test loss: 1.169, Test accuracy: 59.74
Round  25, Global train loss: 0.758, Global test loss: 1.855, Global test accuracy: 39.75
Round  26, Train loss: 0.825, Test loss: 1.189, Test accuracy: 59.42
Round  26, Global train loss: 0.825, Global test loss: 1.990, Global test accuracy: 36.20
Round  27, Train loss: 0.783, Test loss: 1.189, Test accuracy: 59.74
Round  27, Global train loss: 0.783, Global test loss: 2.126, Global test accuracy: 33.46
Round  28, Train loss: 0.640, Test loss: 1.187, Test accuracy: 60.44
Round  28, Global train loss: 0.640, Global test loss: 1.630, Global test accuracy: 46.20
Round  29, Train loss: 0.497, Test loss: 1.199, Test accuracy: 60.27
Round  29, Global train loss: 0.497, Global test loss: 1.851, Global test accuracy: 43.41
Round  30, Train loss: 0.613, Test loss: 1.218, Test accuracy: 59.81
Round  30, Global train loss: 0.613, Global test loss: 1.681, Global test accuracy: 45.30
Round  31, Train loss: 0.682, Test loss: 1.235, Test accuracy: 59.73
Round  31, Global train loss: 0.682, Global test loss: 1.827, Global test accuracy: 41.41
Round  32, Train loss: 0.476, Test loss: 1.254, Test accuracy: 59.86
Round  32, Global train loss: 0.476, Global test loss: 1.832, Global test accuracy: 43.42
Round  33, Train loss: 0.671, Test loss: 1.308, Test accuracy: 59.15
Round  33, Global train loss: 0.671, Global test loss: 2.045, Global test accuracy: 38.29
Round  34, Train loss: 0.552, Test loss: 1.297, Test accuracy: 59.50
Round  34, Global train loss: 0.552, Global test loss: 1.813, Global test accuracy: 44.49
Round  35, Train loss: 0.502, Test loss: 1.324, Test accuracy: 59.55
Round  35, Global train loss: 0.502, Global test loss: 1.844, Global test accuracy: 44.52
Round  36, Train loss: 0.535, Test loss: 1.399, Test accuracy: 58.38
Round  36, Global train loss: 0.535, Global test loss: 1.844, Global test accuracy: 43.75
Round  37, Train loss: 0.618, Test loss: 1.410, Test accuracy: 59.20
Round  37, Global train loss: 0.618, Global test loss: 1.863, Global test accuracy: 41.70
Round  38, Train loss: 0.578, Test loss: 1.432, Test accuracy: 59.02
Round  38, Global train loss: 0.578, Global test loss: 2.360, Global test accuracy: 36.67
Round  39, Train loss: 0.546, Test loss: 1.421, Test accuracy: 59.02
Round  39, Global train loss: 0.546, Global test loss: 1.931, Global test accuracy: 42.11
Round  40, Train loss: 0.479, Test loss: 1.447, Test accuracy: 58.90
Round  40, Global train loss: 0.479, Global test loss: 1.922, Global test accuracy: 43.92
Round  41, Train loss: 0.442, Test loss: 1.472, Test accuracy: 59.15
Round  41, Global train loss: 0.442, Global test loss: 2.196, Global test accuracy: 41.34
Round  42, Train loss: 0.448, Test loss: 1.471, Test accuracy: 59.26
Round  42, Global train loss: 0.448, Global test loss: 1.867, Global test accuracy: 44.66
Round  43, Train loss: 0.634, Test loss: 1.461, Test accuracy: 59.08
Round  43, Global train loss: 0.634, Global test loss: 2.594, Global test accuracy: 31.50
Round  44, Train loss: 0.515, Test loss: 1.474, Test accuracy: 59.26
Round  44, Global train loss: 0.515, Global test loss: 2.100, Global test accuracy: 38.84
Round  45, Train loss: 0.484, Test loss: 1.482, Test accuracy: 58.86
Round  45, Global train loss: 0.484, Global test loss: 2.156, Global test accuracy: 39.70
Round  46, Train loss: 0.476, Test loss: 1.501, Test accuracy: 58.70
Round  46, Global train loss: 0.476, Global test loss: 2.138, Global test accuracy: 42.75
Round  47, Train loss: 0.408, Test loss: 1.508, Test accuracy: 58.12
Round  47, Global train loss: 0.408, Global test loss: 1.889, Global test accuracy: 44.52
Round  48, Train loss: 0.491, Test loss: 1.502, Test accuracy: 58.31
Round  48, Global train loss: 0.491, Global test loss: 1.992, Global test accuracy: 45.09
Round  49, Train loss: 0.410, Test loss: 1.484, Test accuracy: 59.16
Round  49, Global train loss: 0.410, Global test loss: 1.955, Global test accuracy: 45.25
Round  50, Train loss: 0.353, Test loss: 1.527, Test accuracy: 59.17
Round  50, Global train loss: 0.353, Global test loss: 2.033, Global test accuracy: 47.61
Round  51, Train loss: 0.338, Test loss: 1.522, Test accuracy: 59.39
Round  51, Global train loss: 0.338, Global test loss: 1.968, Global test accuracy: 47.55
Round  52, Train loss: 0.384, Test loss: 1.530, Test accuracy: 59.46
Round  52, Global train loss: 0.384, Global test loss: 1.895, Global test accuracy: 47.24
Round  53, Train loss: 0.463, Test loss: 1.574, Test accuracy: 59.34
Round  53, Global train loss: 0.463, Global test loss: 1.950, Global test accuracy: 44.02
Round  54, Train loss: 0.380, Test loss: 1.583, Test accuracy: 59.16
Round  54, Global train loss: 0.380, Global test loss: 2.203, Global test accuracy: 41.64
Round  55, Train loss: 0.398, Test loss: 1.560, Test accuracy: 59.49
Round  55, Global train loss: 0.398, Global test loss: 2.084, Global test accuracy: 43.16
Round  56, Train loss: 0.532, Test loss: 1.568, Test accuracy: 60.31
Round  56, Global train loss: 0.532, Global test loss: 2.233, Global test accuracy: 39.12
Round  57, Train loss: 0.344, Test loss: 1.602, Test accuracy: 59.96
Round  57, Global train loss: 0.344, Global test loss: 2.290, Global test accuracy: 42.61
Round  58, Train loss: 0.434, Test loss: 1.577, Test accuracy: 60.09
Round  58, Global train loss: 0.434, Global test loss: 2.276, Global test accuracy: 40.06
Round  59, Train loss: 0.408, Test loss: 1.586, Test accuracy: 60.33
Round  59, Global train loss: 0.408, Global test loss: 2.218, Global test accuracy: 41.29
Round  60, Train loss: 0.340, Test loss: 1.585, Test accuracy: 60.11
Round  60, Global train loss: 0.340, Global test loss: 2.127, Global test accuracy: 43.70
Round  61, Train loss: 0.347, Test loss: 1.581, Test accuracy: 60.01
Round  61, Global train loss: 0.347, Global test loss: 2.183, Global test accuracy: 44.92
Round  62, Train loss: 0.337, Test loss: 1.599, Test accuracy: 60.27
Round  62, Global train loss: 0.337, Global test loss: 2.307, Global test accuracy: 44.58
Round  63, Train loss: 0.364, Test loss: 1.646, Test accuracy: 59.71
Round  63, Global train loss: 0.364, Global test loss: 2.145, Global test accuracy: 43.27
Round  64, Train loss: 0.354, Test loss: 1.625, Test accuracy: 59.81
Round  64, Global train loss: 0.354, Global test loss: 2.061, Global test accuracy: 44.95
Round  65, Train loss: 0.381, Test loss: 1.627, Test accuracy: 59.99
Round  65, Global train loss: 0.381, Global test loss: 2.491, Global test accuracy: 39.49
Round  66, Train loss: 0.374, Test loss: 1.633, Test accuracy: 60.38
Round  66, Global train loss: 0.374, Global test loss: 2.177, Global test accuracy: 43.31
Round  67, Train loss: 0.428, Test loss: 1.654, Test accuracy: 60.54
Round  67, Global train loss: 0.428, Global test loss: 2.286, Global test accuracy: 40.71
Round  68, Train loss: 0.349, Test loss: 1.677, Test accuracy: 59.83
Round  68, Global train loss: 0.349, Global test loss: 2.067, Global test accuracy: 46.61
Round  69, Train loss: 0.268, Test loss: 1.664, Test accuracy: 59.95
Round  69, Global train loss: 0.268, Global test loss: 2.092, Global test accuracy: 45.75
Round  70, Train loss: 0.296, Test loss: 1.693, Test accuracy: 59.42
Round  70, Global train loss: 0.296, Global test loss: 2.266, Global test accuracy: 44.54
Round  71, Train loss: 0.403, Test loss: 1.705, Test accuracy: 59.45
Round  71, Global train loss: 0.403, Global test loss: 2.554, Global test accuracy: 39.12
Round  72, Train loss: 0.322, Test loss: 1.718, Test accuracy: 59.48
Round  72, Global train loss: 0.322, Global test loss: 2.122, Global test accuracy: 44.49
Round  73, Train loss: 0.348, Test loss: 1.761, Test accuracy: 58.89
Round  73, Global train loss: 0.348, Global test loss: 2.262, Global test accuracy: 44.70
Round  74, Train loss: 0.296, Test loss: 1.734, Test accuracy: 59.00
Round  74, Global train loss: 0.296, Global test loss: 2.271, Global test accuracy: 43.25
Round  75, Train loss: 0.310, Test loss: 1.733, Test accuracy: 59.27
Round  75, Global train loss: 0.310, Global test loss: 2.303, Global test accuracy: 43.83
Round  76, Train loss: 0.309, Test loss: 1.714, Test accuracy: 59.70
Round  76, Global train loss: 0.309, Global test loss: 2.274, Global test accuracy: 44.67
Round  77, Train loss: 0.288, Test loss: 1.711, Test accuracy: 59.15
Round  77, Global train loss: 0.288, Global test loss: 2.322, Global test accuracy: 42.60
Round  78, Train loss: 0.331, Test loss: 1.730, Test accuracy: 59.38
Round  78, Global train loss: 0.331, Global test loss: 2.275, Global test accuracy: 42.20
Round  79, Train loss: 0.310, Test loss: 1.755, Test accuracy: 59.09
Round  79, Global train loss: 0.310, Global test loss: 2.001, Global test accuracy: 46.71
Round  80, Train loss: 0.223, Test loss: 1.753, Test accuracy: 59.21
Round  80, Global train loss: 0.223, Global test loss: 2.028, Global test accuracy: 49.08
Round  81, Train loss: 0.195, Test loss: 1.743, Test accuracy: 59.21
Round  81, Global train loss: 0.195, Global test loss: 2.153, Global test accuracy: 48.15
Round  82, Train loss: 0.189, Test loss: 1.776, Test accuracy: 59.08
Round  82, Global train loss: 0.189, Global test loss: 2.152, Global test accuracy: 49.00
Round  83, Train loss: 0.177, Test loss: 1.767, Test accuracy: 59.60
Round  83, Global train loss: 0.177, Global test loss: 2.207, Global test accuracy: 48.52
Round  84, Train loss: 0.168, Test loss: 1.757, Test accuracy: 59.56
Round  84, Global train loss: 0.168, Global test loss: 2.203, Global test accuracy: 48.94
Round  85, Train loss: 0.173, Test loss: 1.774, Test accuracy: 59.66
Round  85, Global train loss: 0.173, Global test loss: 2.188, Global test accuracy: 49.75
Round  86, Train loss: 0.159, Test loss: 1.785, Test accuracy: 59.60
Round  86, Global train loss: 0.159, Global test loss: 2.204, Global test accuracy: 48.94
Round  87, Train loss: 0.150, Test loss: 1.809, Test accuracy: 59.16
Round  87, Global train loss: 0.150, Global test loss: 2.218, Global test accuracy: 49.12
Round  88, Train loss: 0.162, Test loss: 1.789, Test accuracy: 59.38
Round  88, Global train loss: 0.162, Global test loss: 2.230, Global test accuracy: 48.80
Round  89, Train loss: 0.143, Test loss: 1.804, Test accuracy: 59.33
Round  89, Global train loss: 0.143, Global test loss: 2.205, Global test accuracy: 49.81
Round  90, Train loss: 0.323, Test loss: 1.714, Test accuracy: 60.95
Round  90, Global train loss: 0.323, Global test loss: 1.968, Global test accuracy: 49.59
Round  91, Train loss: 0.285, Test loss: 1.759, Test accuracy: 60.05
Round  91, Global train loss: 0.285, Global test loss: 1.979, Global test accuracy: 48.94
Round  92, Train loss: 0.282, Test loss: 1.816, Test accuracy: 60.30
Round  92, Global train loss: 0.282, Global test loss: 1.986, Global test accuracy: 48.65
Round  93, Train loss: 0.273, Test loss: 1.818, Test accuracy: 60.06
Round  93, Global train loss: 0.273, Global test loss: 1.998, Global test accuracy: 48.49
Round  94, Train loss: 0.275, Test loss: 1.817, Test accuracy: 60.29
Round  94, Global train loss: 0.275, Global test loss: 2.027, Global test accuracy: 48.01
Round  95, Train loss: 0.257, Test loss: 1.826, Test accuracy: 60.38
Round  95, Global train loss: 0.257, Global test loss: 2.032, Global test accuracy: 47.75
Round  96, Train loss: 0.266, Test loss: 1.819, Test accuracy: 60.02
Round  96, Global train loss: 0.266, Global test loss: 2.012, Global test accuracy: 48.19
Round  97, Train loss: 0.262, Test loss: 1.872, Test accuracy: 59.88
Round  97, Global train loss: 0.262, Global test loss: 2.043, Global test accuracy: 47.67
Round  98, Train loss: 0.263, Test loss: 1.881, Test accuracy: 59.70
Round  98, Global train loss: 0.263, Global test loss: 2.021, Global test accuracy: 47.96
Round  99, Train loss: 0.255, Test loss: 1.883, Test accuracy: 59.55
Round  99, Global train loss: 0.255, Global test loss: 2.029, Global test accuracy: 47.91
Final Round, Train loss: 0.190, Test loss: 2.051, Test accuracy: 59.77
Final Round, Global train loss: 0.190, Global test loss: 2.029, Global test accuracy: 47.91
Average accuracy final 10 rounds: 60.1175
Average global accuracy final 10 rounds: 48.31625
2623.507268667221
[2.5500242710113525, 4.925979137420654, 7.462886810302734, 9.913786172866821, 12.452094554901123, 14.867674589157104, 17.305863857269287, 19.621257305145264, 22.244173526763916, 24.744731903076172, 27.35949206352234, 29.643503665924072, 32.08129334449768, 34.41488194465637, 36.90836524963379, 39.33090543746948, 41.65379452705383, 44.0973699092865, 46.44440460205078, 48.735732078552246, 51.112048864364624, 53.452540159225464, 55.900426387786865, 58.12074255943298, 60.35611081123352, 62.754883766174316, 65.25180006027222, 67.49582004547119, 69.82194495201111, 72.16583752632141, 74.47928833961487, 76.84074592590332, 79.33814525604248, 81.55164647102356, 83.81487822532654, 86.49643731117249, 88.93802261352539, 91.31706047058105, 93.78508687019348, 96.12872052192688, 98.44736075401306, 100.60701274871826, 102.92029666900635, 105.28171062469482, 107.70325016975403, 110.12089705467224, 112.56961965560913, 114.8953537940979, 117.24273204803467, 119.58067679405212, 121.93758201599121, 124.27855229377747, 126.65409541130066, 129.1515793800354, 131.452716588974, 133.79283356666565, 136.09215688705444, 138.43949174880981, 140.8245871067047, 143.1592767238617, 145.67572283744812, 147.96356630325317, 150.40331840515137, 152.7788209915161, 155.16821002960205, 157.56502747535706, 159.90671706199646, 162.13824462890625, 164.5645716190338, 166.88070130348206, 169.34238719940186, 171.77662110328674, 174.15547132492065, 176.50338196754456, 178.8071050643921, 181.22240161895752, 183.52823495864868, 185.91706466674805, 188.32742190361023, 190.57952904701233, 192.94262719154358, 195.76448106765747, 198.43607807159424, 200.72379565238953, 203.1318953037262, 205.40739035606384, 207.83758330345154, 210.3233335018158, 212.69124746322632, 215.20244908332825, 217.819806098938, 220.21132636070251, 222.7149965763092, 225.16123628616333, 227.57372975349426, 230.0966718196869, 232.5432252883911, 234.90435981750488, 237.33940625190735, 239.65225672721863, 244.4406008720398]
[47.1625, 53.4125, 55.55, 58.3125, 59.4375, 58.9375, 59.5625, 60.675, 61.3875, 61.775, 61.7, 62.35, 62.95, 62.325, 62.35, 61.9625, 61.325, 61.0625, 60.5875, 60.125, 59.5375, 59.075, 59.475, 59.6, 59.4125, 59.7375, 59.425, 59.7375, 60.4375, 60.275, 59.8125, 59.725, 59.8625, 59.15, 59.5, 59.55, 58.375, 59.2, 59.025, 59.025, 58.9, 59.15, 59.2625, 59.075, 59.2625, 58.8625, 58.7, 58.125, 58.3125, 59.1625, 59.175, 59.3875, 59.4625, 59.3375, 59.1625, 59.4875, 60.3125, 59.9625, 60.0875, 60.325, 60.1125, 60.0125, 60.275, 59.7125, 59.8125, 59.9875, 60.375, 60.5375, 59.825, 59.95, 59.425, 59.45, 59.475, 58.8875, 59.0, 59.275, 59.7, 59.15, 59.375, 59.0875, 59.2125, 59.2125, 59.075, 59.6, 59.5625, 59.6625, 59.6, 59.1625, 59.375, 59.325, 60.95, 60.05, 60.3, 60.0625, 60.2875, 60.375, 60.025, 59.875, 59.7, 59.55, 59.775]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 4, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.440, Test loss: 1.214, Test accuracy: 46.64
Round   0, Global train loss: 1.440, Global test loss: 2.212, Global test accuracy: 23.01
Round   1, Train loss: 1.338, Test loss: 1.122, Test accuracy: 52.48
Round   1, Global train loss: 1.338, Global test loss: 2.043, Global test accuracy: 27.49
Round   2, Train loss: 1.280, Test loss: 1.087, Test accuracy: 55.66
Round   2, Global train loss: 1.280, Global test loss: 1.903, Global test accuracy: 33.15
Round   3, Train loss: 1.235, Test loss: 1.030, Test accuracy: 58.59
Round   3, Global train loss: 1.235, Global test loss: 1.812, Global test accuracy: 35.44
Round   4, Train loss: 1.204, Test loss: 1.007, Test accuracy: 60.35
Round   4, Global train loss: 1.204, Global test loss: 1.741, Global test accuracy: 37.77
Round   5, Train loss: 1.181, Test loss: 1.000, Test accuracy: 61.08
Round   5, Global train loss: 1.181, Global test loss: 1.709, Global test accuracy: 38.64
Round   6, Train loss: 1.154, Test loss: 0.990, Test accuracy: 62.30
Round   6, Global train loss: 1.154, Global test loss: 1.669, Global test accuracy: 40.31
Round   7, Train loss: 1.130, Test loss: 0.984, Test accuracy: 60.44
Round   7, Global train loss: 1.130, Global test loss: 1.640, Global test accuracy: 40.99
Round   8, Train loss: 1.111, Test loss: 0.980, Test accuracy: 62.73
Round   8, Global train loss: 1.111, Global test loss: 1.609, Global test accuracy: 43.14
Round   9, Train loss: 1.087, Test loss: 0.974, Test accuracy: 61.66
Round   9, Global train loss: 1.087, Global test loss: 1.591, Global test accuracy: 44.49
Round  10, Train loss: 1.077, Test loss: 0.994, Test accuracy: 61.12
Round  10, Global train loss: 1.077, Global test loss: 1.764, Global test accuracy: 40.69
Round  11, Train loss: 0.967, Test loss: 0.971, Test accuracy: 62.00
Round  11, Global train loss: 0.967, Global test loss: 1.723, Global test accuracy: 39.45
Round  12, Train loss: 1.102, Test loss: 0.969, Test accuracy: 62.04
Round  12, Global train loss: 1.102, Global test loss: 1.743, Global test accuracy: 39.71
Round  13, Train loss: 1.012, Test loss: 0.973, Test accuracy: 61.91
Round  13, Global train loss: 1.012, Global test loss: 1.721, Global test accuracy: 39.99
Round  14, Train loss: 0.974, Test loss: 0.972, Test accuracy: 62.21
Round  14, Global train loss: 0.974, Global test loss: 1.676, Global test accuracy: 41.33
Round  15, Train loss: 1.120, Test loss: 0.986, Test accuracy: 61.70
Round  15, Global train loss: 1.120, Global test loss: 1.793, Global test accuracy: 37.73
Round  16, Train loss: 0.937, Test loss: 1.013, Test accuracy: 60.98
Round  16, Global train loss: 0.937, Global test loss: 1.659, Global test accuracy: 43.94
Round  17, Train loss: 0.983, Test loss: 1.027, Test accuracy: 60.00
Round  17, Global train loss: 0.983, Global test loss: 1.850, Global test accuracy: 39.58
Round  18, Train loss: 0.916, Test loss: 1.040, Test accuracy: 59.90
Round  18, Global train loss: 0.916, Global test loss: 1.710, Global test accuracy: 42.59
Round  19, Train loss: 0.822, Test loss: 1.057, Test accuracy: 60.30
Round  19, Global train loss: 0.822, Global test loss: 1.778, Global test accuracy: 40.77
Round  20, Train loss: 0.864, Test loss: 1.065, Test accuracy: 60.25
Round  20, Global train loss: 0.864, Global test loss: 1.830, Global test accuracy: 36.62
Round  21, Train loss: 0.743, Test loss: 1.101, Test accuracy: 59.44
Round  21, Global train loss: 0.743, Global test loss: 1.619, Global test accuracy: 47.10
Round  22, Train loss: 0.837, Test loss: 1.111, Test accuracy: 59.21
Round  22, Global train loss: 0.837, Global test loss: 1.668, Global test accuracy: 41.71
Round  23, Train loss: 0.716, Test loss: 1.112, Test accuracy: 59.55
Round  23, Global train loss: 0.716, Global test loss: 1.717, Global test accuracy: 43.44
Round  24, Train loss: 0.782, Test loss: 1.114, Test accuracy: 59.92
Round  24, Global train loss: 0.782, Global test loss: 1.635, Global test accuracy: 43.99
Round  25, Train loss: 0.669, Test loss: 1.143, Test accuracy: 59.16
Round  25, Global train loss: 0.669, Global test loss: 1.854, Global test accuracy: 39.88
Round  26, Train loss: 0.717, Test loss: 1.149, Test accuracy: 59.83
Round  26, Global train loss: 0.717, Global test loss: 2.058, Global test accuracy: 37.94
Round  27, Train loss: 0.765, Test loss: 1.174, Test accuracy: 59.60
Round  27, Global train loss: 0.765, Global test loss: 2.129, Global test accuracy: 33.62
Round  28, Train loss: 0.684, Test loss: 1.202, Test accuracy: 59.25
Round  28, Global train loss: 0.684, Global test loss: 1.650, Global test accuracy: 46.41
Round  29, Train loss: 0.670, Test loss: 1.205, Test accuracy: 59.54
Round  29, Global train loss: 0.670, Global test loss: 1.926, Global test accuracy: 40.50
Round  30, Train loss: 0.587, Test loss: 1.217, Test accuracy: 59.86
Round  30, Global train loss: 0.587, Global test loss: 1.671, Global test accuracy: 46.39
Round  31, Train loss: 0.680, Test loss: 1.234, Test accuracy: 59.61
Round  31, Global train loss: 0.680, Global test loss: 1.882, Global test accuracy: 41.60
Round  32, Train loss: 0.640, Test loss: 1.247, Test accuracy: 59.88
Round  32, Global train loss: 0.640, Global test loss: 1.752, Global test accuracy: 43.90
Round  33, Train loss: 0.682, Test loss: 1.261, Test accuracy: 59.25
Round  33, Global train loss: 0.682, Global test loss: 2.054, Global test accuracy: 38.31
Round  34, Train loss: 0.619, Test loss: 1.292, Test accuracy: 59.35
Round  34, Global train loss: 0.619, Global test loss: 1.785, Global test accuracy: 45.30
Round  35, Train loss: 0.503, Test loss: 1.289, Test accuracy: 59.62
Round  35, Global train loss: 0.503, Global test loss: 2.083, Global test accuracy: 42.29
Round  36, Train loss: 0.483, Test loss: 1.330, Test accuracy: 59.02
Round  36, Global train loss: 0.483, Global test loss: 1.875, Global test accuracy: 43.25
Round  37, Train loss: 0.517, Test loss: 1.324, Test accuracy: 59.40
Round  37, Global train loss: 0.517, Global test loss: 1.758, Global test accuracy: 46.70
Round  38, Train loss: 0.500, Test loss: 1.298, Test accuracy: 60.19
Round  38, Global train loss: 0.500, Global test loss: 2.436, Global test accuracy: 39.20
Round  39, Train loss: 0.590, Test loss: 1.326, Test accuracy: 59.73
Round  39, Global train loss: 0.590, Global test loss: 1.738, Global test accuracy: 44.89
Round  40, Train loss: 0.642, Test loss: 1.390, Test accuracy: 59.40
Round  40, Global train loss: 0.642, Global test loss: 1.942, Global test accuracy: 43.27
Round  41, Train loss: 0.479, Test loss: 1.427, Test accuracy: 58.40
Round  41, Global train loss: 0.479, Global test loss: 2.017, Global test accuracy: 42.10
Round  42, Train loss: 0.534, Test loss: 1.404, Test accuracy: 59.17
Round  42, Global train loss: 0.534, Global test loss: 1.888, Global test accuracy: 44.56
Round  43, Train loss: 0.539, Test loss: 1.434, Test accuracy: 58.77
Round  43, Global train loss: 0.539, Global test loss: 2.563, Global test accuracy: 35.05
Round  44, Train loss: 0.507, Test loss: 1.423, Test accuracy: 59.06
Round  44, Global train loss: 0.507, Global test loss: 2.037, Global test accuracy: 41.39
Round  45, Train loss: 0.461, Test loss: 1.429, Test accuracy: 58.99
Round  45, Global train loss: 0.461, Global test loss: 2.165, Global test accuracy: 39.49
Round  46, Train loss: 0.537, Test loss: 1.419, Test accuracy: 59.29
Round  46, Global train loss: 0.537, Global test loss: 2.186, Global test accuracy: 40.12
Round  47, Train loss: 0.519, Test loss: 1.420, Test accuracy: 59.94
Round  47, Global train loss: 0.519, Global test loss: 1.981, Global test accuracy: 43.88
Round  48, Train loss: 0.489, Test loss: 1.408, Test accuracy: 60.27
Round  48, Global train loss: 0.489, Global test loss: 2.023, Global test accuracy: 44.58
Round  49, Train loss: 0.435, Test loss: 1.431, Test accuracy: 60.61
Round  49, Global train loss: 0.435, Global test loss: 1.945, Global test accuracy: 44.62
Round  50, Train loss: 0.448, Test loss: 1.458, Test accuracy: 59.99
Round  50, Global train loss: 0.448, Global test loss: 2.050, Global test accuracy: 44.49
Round  51, Train loss: 0.393, Test loss: 1.490, Test accuracy: 59.76
Round  51, Global train loss: 0.393, Global test loss: 2.042, Global test accuracy: 43.99
Round  52, Train loss: 0.438, Test loss: 1.523, Test accuracy: 59.42
Round  52, Global train loss: 0.438, Global test loss: 2.050, Global test accuracy: 43.02
Round  53, Train loss: 0.411, Test loss: 1.538, Test accuracy: 59.25
Round  53, Global train loss: 0.411, Global test loss: 2.040, Global test accuracy: 43.51
Round  54, Train loss: 0.341, Test loss: 1.518, Test accuracy: 59.19
Round  54, Global train loss: 0.341, Global test loss: 2.289, Global test accuracy: 41.95
Round  55, Train loss: 0.374, Test loss: 1.491, Test accuracy: 59.83
Round  55, Global train loss: 0.374, Global test loss: 1.989, Global test accuracy: 45.34
Round  56, Train loss: 0.514, Test loss: 1.530, Test accuracy: 59.39
Round  56, Global train loss: 0.514, Global test loss: 2.217, Global test accuracy: 39.75
Round  57, Train loss: 0.356, Test loss: 1.549, Test accuracy: 58.39
Round  57, Global train loss: 0.356, Global test loss: 2.113, Global test accuracy: 44.50
Round  58, Train loss: 0.429, Test loss: 1.593, Test accuracy: 57.58
Round  58, Global train loss: 0.429, Global test loss: 2.259, Global test accuracy: 41.67
Round  59, Train loss: 0.344, Test loss: 1.565, Test accuracy: 58.46
Round  59, Global train loss: 0.344, Global test loss: 2.139, Global test accuracy: 45.26
Round  60, Train loss: 0.380, Test loss: 1.561, Test accuracy: 58.75
Round  60, Global train loss: 0.380, Global test loss: 2.090, Global test accuracy: 44.73
Round  61, Train loss: 0.445, Test loss: 1.578, Test accuracy: 59.42
Round  61, Global train loss: 0.445, Global test loss: 2.377, Global test accuracy: 42.35
Round  62, Train loss: 0.354, Test loss: 1.595, Test accuracy: 58.91
Round  62, Global train loss: 0.354, Global test loss: 2.329, Global test accuracy: 44.79
Round  63, Train loss: 0.356, Test loss: 1.582, Test accuracy: 59.20
Round  63, Global train loss: 0.356, Global test loss: 2.078, Global test accuracy: 44.62
Round  64, Train loss: 0.302, Test loss: 1.576, Test accuracy: 59.02
Round  64, Global train loss: 0.302, Global test loss: 2.018, Global test accuracy: 46.39
Round  65, Train loss: 0.354, Test loss: 1.564, Test accuracy: 59.52
Round  65, Global train loss: 0.354, Global test loss: 2.309, Global test accuracy: 42.20
Round  66, Train loss: 0.409, Test loss: 1.566, Test accuracy: 60.35
Round  66, Global train loss: 0.409, Global test loss: 2.154, Global test accuracy: 44.23
Round  67, Train loss: 0.353, Test loss: 1.603, Test accuracy: 60.20
Round  67, Global train loss: 0.353, Global test loss: 2.079, Global test accuracy: 45.33
Round  68, Train loss: 0.417, Test loss: 1.644, Test accuracy: 60.09
Round  68, Global train loss: 0.417, Global test loss: 2.033, Global test accuracy: 46.69
Round  69, Train loss: 0.357, Test loss: 1.684, Test accuracy: 59.88
Round  69, Global train loss: 0.357, Global test loss: 2.143, Global test accuracy: 42.55
Round  70, Train loss: 0.292, Test loss: 1.677, Test accuracy: 59.90
Round  70, Global train loss: 0.292, Global test loss: 2.296, Global test accuracy: 43.95
Round  71, Train loss: 0.354, Test loss: 1.646, Test accuracy: 60.45
Round  71, Global train loss: 0.354, Global test loss: 2.420, Global test accuracy: 41.85
Round  72, Train loss: 0.284, Test loss: 1.670, Test accuracy: 60.11
Round  72, Global train loss: 0.284, Global test loss: 1.961, Global test accuracy: 48.30
Round  73, Train loss: 0.413, Test loss: 1.637, Test accuracy: 60.59
Round  73, Global train loss: 0.413, Global test loss: 2.369, Global test accuracy: 42.15
Round  74, Train loss: 0.304, Test loss: 1.644, Test accuracy: 60.20
Round  74, Global train loss: 0.304, Global test loss: 2.324, Global test accuracy: 43.19
Round  75, Train loss: 0.279, Test loss: 1.670, Test accuracy: 60.21
Round  75, Global train loss: 0.279, Global test loss: 2.570, Global test accuracy: 41.99
Round  76, Train loss: 0.287, Test loss: 1.658, Test accuracy: 60.56
Round  76, Global train loss: 0.287, Global test loss: 2.315, Global test accuracy: 43.73
Round  77, Train loss: 0.290, Test loss: 1.678, Test accuracy: 60.54
Round  77, Global train loss: 0.290, Global test loss: 2.181, Global test accuracy: 44.86
Round  78, Train loss: 0.337, Test loss: 1.711, Test accuracy: 59.83
Round  78, Global train loss: 0.337, Global test loss: 2.181, Global test accuracy: 43.61
Round  79, Train loss: 0.398, Test loss: 1.750, Test accuracy: 59.48
Round  79, Global train loss: 0.398, Global test loss: 2.122, Global test accuracy: 43.99
Round  80, Train loss: 0.239, Test loss: 1.758, Test accuracy: 59.31
Round  80, Global train loss: 0.239, Global test loss: 1.991, Global test accuracy: 48.10
Round  81, Train loss: 0.220, Test loss: 1.723, Test accuracy: 60.00
Round  81, Global train loss: 0.220, Global test loss: 2.036, Global test accuracy: 48.66
Round  82, Train loss: 0.204, Test loss: 1.760, Test accuracy: 59.65
Round  82, Global train loss: 0.204, Global test loss: 2.072, Global test accuracy: 48.80
Round  83, Train loss: 0.196, Test loss: 1.797, Test accuracy: 59.64
Round  83, Global train loss: 0.196, Global test loss: 2.124, Global test accuracy: 48.62
Round  84, Train loss: 0.206, Test loss: 1.764, Test accuracy: 60.02
Round  84, Global train loss: 0.206, Global test loss: 2.089, Global test accuracy: 48.70
Round  85, Train loss: 0.184, Test loss: 1.746, Test accuracy: 59.83
Round  85, Global train loss: 0.184, Global test loss: 2.073, Global test accuracy: 49.15
Round  86, Train loss: 0.182, Test loss: 1.809, Test accuracy: 58.95
Round  86, Global train loss: 0.182, Global test loss: 2.108, Global test accuracy: 48.83
Round  87, Train loss: 0.173, Test loss: 1.779, Test accuracy: 60.27
Round  87, Global train loss: 0.173, Global test loss: 2.155, Global test accuracy: 48.83
Round  88, Train loss: 0.176, Test loss: 1.788, Test accuracy: 59.91
Round  88, Global train loss: 0.176, Global test loss: 2.181, Global test accuracy: 49.26
Round  89, Train loss: 0.176, Test loss: 1.800, Test accuracy: 60.01
Round  89, Global train loss: 0.176, Global test loss: 2.144, Global test accuracy: 48.76
Round  90, Train loss: 0.339, Test loss: 1.744, Test accuracy: 60.49
Round  90, Global train loss: 0.339, Global test loss: 1.992, Global test accuracy: 47.80
Round  91, Train loss: 0.309, Test loss: 1.783, Test accuracy: 60.50
Round  91, Global train loss: 0.309, Global test loss: 2.009, Global test accuracy: 47.21
Round  92, Train loss: 0.302, Test loss: 1.792, Test accuracy: 59.95
Round  92, Global train loss: 0.302, Global test loss: 2.003, Global test accuracy: 47.44
Round  93, Train loss: 0.288, Test loss: 1.818, Test accuracy: 60.39
Round  93, Global train loss: 0.288, Global test loss: 2.022, Global test accuracy: 47.19
Round  94, Train loss: 0.281, Test loss: 1.812, Test accuracy: 60.06
Round  94, Global train loss: 0.281, Global test loss: 2.041, Global test accuracy: 47.12
Round  95, Train loss: 0.280, Test loss: 1.822, Test accuracy: 59.74
Round  95, Global train loss: 0.280, Global test loss: 2.050, Global test accuracy: 47.17
Round  96, Train loss: 0.281, Test loss: 1.828, Test accuracy: 60.38
Round  96, Global train loss: 0.281, Global test loss: 2.060, Global test accuracy: 46.76
Round  97, Train loss: 0.278, Test loss: 1.800, Test accuracy: 60.02
Round  97, Global train loss: 0.278, Global test loss: 2.066, Global test accuracy: 47.27
Round  98, Train loss: 0.263, Test loss: 1.831, Test accuracy: 61.06
Round  98, Global train loss: 0.263, Global test loss: 2.104, Global test accuracy: 46.81
Round  99, Train loss: 0.265, Test loss: 1.823, Test accuracy: 60.41
Round  99, Global train loss: 0.265, Global test loss: 2.092, Global test accuracy: 46.73
Final Round, Train loss: 0.198, Test loss: 2.061, Test accuracy: 59.35
Final Round, Global train loss: 0.198, Global test loss: 2.092, Global test accuracy: 46.73
Average accuracy final 10 rounds: 60.300000000000004
Average global accuracy final 10 rounds: 47.15125
4459.548231601715
[2.7829065322875977, 5.1451122760772705, 7.565593481063843, 9.961703538894653, 12.513165712356567, 14.848222732543945, 17.325841903686523, 19.753456830978394, 22.26867985725403, 24.70108985900879, 26.993544340133667, 29.231247186660767, 31.442325353622437, 33.65506029129028, 36.18008780479431, 38.42928123474121, 40.96975374221802, 43.57589793205261, 46.38713026046753, 48.75680065155029, 51.06146168708801, 56.112669944763184, 61.26820945739746, 66.22018551826477, 71.37631344795227, 76.42586994171143, 81.63028717041016, 87.07213616371155, 92.22563743591309, 97.40885758399963, 102.59727501869202, 107.81251811981201, 112.92040038108826, 118.23938584327698, 123.31726288795471, 128.35129714012146, 134.73246717453003, 139.88088202476501, 145.12788677215576, 150.44281482696533, 155.60097074508667, 160.6565272808075, 165.8854250907898, 171.04599952697754, 176.3205988407135, 181.33414149284363, 186.5988154411316, 191.56027388572693, 196.84196734428406, 202.32258701324463, 207.77086186408997, 213.06148290634155, 218.25778985023499, 223.3190951347351, 228.8230059146881, 233.97227358818054, 239.16159224510193, 244.49446988105774, 249.69210290908813, 255.06173062324524, 260.7356219291687, 265.72584533691406, 270.8327646255493, 275.99600648880005, 281.232177734375, 286.24039483070374, 291.2840185165405, 296.32065415382385, 301.51631927490234, 306.88304901123047, 312.302042722702, 317.4009850025177, 322.45345520973206, 327.4663610458374, 332.9141631126404, 337.9043562412262, 343.06616497039795, 348.1483483314514, 353.8993442058563, 359.29041290283203, 364.49905729293823, 369.5039038658142, 374.6518726348877, 379.7681369781494, 384.91849970817566, 390.1971755027771, 395.323637008667, 400.4345848560333, 405.4921443462372, 410.6154832839966, 415.8077504634857, 421.17521619796753, 426.48710322380066, 432.60078263282776, 438.271630525589, 443.62150597572327, 449.29934096336365, 455.02198791503906, 460.5833885669708, 466.39067363739014, 471.0362546443939]
[46.6375, 52.475, 55.6625, 58.5875, 60.35, 61.075, 62.3, 60.4375, 62.725, 61.6625, 61.125, 62.0, 62.0375, 61.9125, 62.2125, 61.7, 60.975, 60.0, 59.9, 60.3, 60.25, 59.4375, 59.2125, 59.55, 59.925, 59.1625, 59.825, 59.6, 59.25, 59.5375, 59.8625, 59.6125, 59.875, 59.25, 59.35, 59.625, 59.025, 59.4, 60.1875, 59.725, 59.4, 58.4, 59.175, 58.775, 59.0625, 58.9875, 59.2875, 59.9375, 60.275, 60.6125, 59.9875, 59.7625, 59.425, 59.25, 59.1875, 59.825, 59.3875, 58.3875, 57.575, 58.4625, 58.75, 59.425, 58.9125, 59.2, 59.025, 59.525, 60.35, 60.2, 60.0875, 59.875, 59.9, 60.45, 60.1125, 60.5875, 60.2, 60.2125, 60.5625, 60.5375, 59.825, 59.475, 59.3125, 60.0, 59.65, 59.6375, 60.025, 59.825, 58.95, 60.275, 59.9125, 60.0125, 60.4875, 60.5, 59.95, 60.3875, 60.0625, 59.7375, 60.375, 60.025, 61.0625, 60.4125, 59.35]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 4, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.624, Test loss: 1.605, Test accuracy: 28.96
Round   1, Train loss: 1.355, Test loss: 1.247, Test accuracy: 43.31
Round   2, Train loss: 1.285, Test loss: 1.217, Test accuracy: 45.02
Round   3, Train loss: 1.239, Test loss: 1.129, Test accuracy: 49.40
Round   4, Train loss: 1.206, Test loss: 1.071, Test accuracy: 54.44
Round   5, Train loss: 1.179, Test loss: 1.055, Test accuracy: 54.76
Round   6, Train loss: 1.162, Test loss: 1.037, Test accuracy: 55.80
Round   7, Train loss: 1.147, Test loss: 1.026, Test accuracy: 57.89
Round   8, Train loss: 1.130, Test loss: 0.973, Test accuracy: 61.40
Round   9, Train loss: 1.115, Test loss: 0.985, Test accuracy: 59.56
Round  10, Train loss: 1.101, Test loss: 0.972, Test accuracy: 61.50
Round  11, Train loss: 1.088, Test loss: 0.968, Test accuracy: 60.89
Round  12, Train loss: 1.075, Test loss: 0.935, Test accuracy: 63.27
Round  13, Train loss: 1.061, Test loss: 0.926, Test accuracy: 64.65
Round  14, Train loss: 1.050, Test loss: 0.926, Test accuracy: 64.19
Round  15, Train loss: 1.038, Test loss: 0.915, Test accuracy: 65.86
Round  16, Train loss: 1.022, Test loss: 0.902, Test accuracy: 66.28
Round  17, Train loss: 1.007, Test loss: 0.899, Test accuracy: 65.71
Round  18, Train loss: 0.996, Test loss: 0.890, Test accuracy: 65.83
Round  19, Train loss: 0.982, Test loss: 0.877, Test accuracy: 67.40
Round  20, Train loss: 0.978, Test loss: 0.890, Test accuracy: 66.12
Round  21, Train loss: 1.080, Test loss: 0.892, Test accuracy: 66.17
Round  22, Train loss: 0.920, Test loss: 0.887, Test accuracy: 66.42
Round  23, Train loss: 0.883, Test loss: 0.886, Test accuracy: 66.26
Round  24, Train loss: 0.968, Test loss: 0.918, Test accuracy: 64.75
Round  25, Train loss: 0.867, Test loss: 0.893, Test accuracy: 65.45
Round  26, Train loss: 0.884, Test loss: 0.897, Test accuracy: 65.49
Round  27, Train loss: 0.905, Test loss: 0.906, Test accuracy: 65.12
Round  28, Train loss: 0.874, Test loss: 0.891, Test accuracy: 65.35
Round  29, Train loss: 0.947, Test loss: 0.928, Test accuracy: 63.79
Round  30, Train loss: 0.808, Test loss: 0.900, Test accuracy: 64.64
Round  31, Train loss: 0.727, Test loss: 0.908, Test accuracy: 64.41
Round  32, Train loss: 0.924, Test loss: 0.907, Test accuracy: 65.17
Round  33, Train loss: 0.854, Test loss: 0.905, Test accuracy: 65.59
Round  34, Train loss: 0.847, Test loss: 0.919, Test accuracy: 64.96
Round  35, Train loss: 0.784, Test loss: 0.907, Test accuracy: 66.17
Round  36, Train loss: 0.650, Test loss: 0.902, Test accuracy: 65.59
Round  37, Train loss: 0.729, Test loss: 0.918, Test accuracy: 64.75
Round  38, Train loss: 0.857, Test loss: 0.918, Test accuracy: 65.28
Round  39, Train loss: 0.831, Test loss: 0.941, Test accuracy: 64.28
Round  40, Train loss: 0.879, Test loss: 0.954, Test accuracy: 63.85
Round  41, Train loss: 0.880, Test loss: 0.966, Test accuracy: 63.85
Round  42, Train loss: 0.744, Test loss: 0.981, Test accuracy: 63.25
Round  43, Train loss: 0.681, Test loss: 0.977, Test accuracy: 63.69
Round  44, Train loss: 0.788, Test loss: 1.011, Test accuracy: 62.67
Round  45, Train loss: 0.647, Test loss: 1.004, Test accuracy: 62.41
Round  46, Train loss: 0.640, Test loss: 1.006, Test accuracy: 62.10
Round  47, Train loss: 0.753, Test loss: 1.019, Test accuracy: 61.75
Round  48, Train loss: 0.723, Test loss: 0.995, Test accuracy: 63.19
Round  49, Train loss: 0.668, Test loss: 1.011, Test accuracy: 62.50
Round  50, Train loss: 0.687, Test loss: 1.006, Test accuracy: 62.84
Round  51, Train loss: 0.544, Test loss: 1.015, Test accuracy: 63.11
Round  52, Train loss: 0.579, Test loss: 1.045, Test accuracy: 62.54
Round  53, Train loss: 0.665, Test loss: 1.029, Test accuracy: 62.91
Round  54, Train loss: 0.589, Test loss: 1.044, Test accuracy: 62.51
Round  55, Train loss: 0.584, Test loss: 1.067, Test accuracy: 61.54
Round  56, Train loss: 0.608, Test loss: 1.040, Test accuracy: 62.42
Round  57, Train loss: 0.575, Test loss: 1.041, Test accuracy: 63.04
Round  58, Train loss: 0.581, Test loss: 1.038, Test accuracy: 62.64
Round  59, Train loss: 0.550, Test loss: 1.047, Test accuracy: 63.08
Round  60, Train loss: 0.634, Test loss: 1.076, Test accuracy: 62.11
Round  61, Train loss: 0.593, Test loss: 1.055, Test accuracy: 62.94
Round  62, Train loss: 0.607, Test loss: 1.077, Test accuracy: 62.16
Round  63, Train loss: 0.538, Test loss: 1.090, Test accuracy: 62.85
Round  64, Train loss: 0.501, Test loss: 1.107, Test accuracy: 61.73
Round  65, Train loss: 0.527, Test loss: 1.094, Test accuracy: 61.85
Round  66, Train loss: 0.583, Test loss: 1.103, Test accuracy: 62.66
Round  67, Train loss: 0.503, Test loss: 1.124, Test accuracy: 62.71
Round  68, Train loss: 0.645, Test loss: 1.171, Test accuracy: 61.42
Round  69, Train loss: 0.521, Test loss: 1.172, Test accuracy: 61.64
Round  70, Train loss: 0.444, Test loss: 1.161, Test accuracy: 61.89
Round  71, Train loss: 0.401, Test loss: 1.157, Test accuracy: 60.92
Round  72, Train loss: 0.493, Test loss: 1.157, Test accuracy: 61.56
Round  73, Train loss: 0.444, Test loss: 1.173, Test accuracy: 61.81
Round  74, Train loss: 0.537, Test loss: 1.202, Test accuracy: 61.51
Round  75, Train loss: 0.501, Test loss: 1.236, Test accuracy: 59.44
Round  76, Train loss: 0.385, Test loss: 1.192, Test accuracy: 61.49
Round  77, Train loss: 0.433, Test loss: 1.201, Test accuracy: 61.08
Round  78, Train loss: 0.525, Test loss: 1.252, Test accuracy: 59.59
Round  79, Train loss: 0.571, Test loss: 1.249, Test accuracy: 60.40
Round  80, Train loss: 0.361, Test loss: 1.251, Test accuracy: 59.86
Round  81, Train loss: 0.342, Test loss: 1.283, Test accuracy: 59.36
Round  82, Train loss: 0.324, Test loss: 1.284, Test accuracy: 59.80
Round  83, Train loss: 0.312, Test loss: 1.287, Test accuracy: 59.91
Round  84, Train loss: 0.306, Test loss: 1.319, Test accuracy: 59.44
Round  85, Train loss: 0.286, Test loss: 1.315, Test accuracy: 59.17
Round  86, Train loss: 0.278, Test loss: 1.345, Test accuracy: 59.52
Round  87, Train loss: 0.272, Test loss: 1.338, Test accuracy: 59.62
Round  88, Train loss: 0.266, Test loss: 1.341, Test accuracy: 59.35
Round  89, Train loss: 0.260, Test loss: 1.350, Test accuracy: 59.39
Round  90, Train loss: 0.463, Test loss: 1.322, Test accuracy: 60.15
Round  91, Train loss: 0.438, Test loss: 1.326, Test accuracy: 60.10
Round  92, Train loss: 0.430, Test loss: 1.365, Test accuracy: 59.23
Round  93, Train loss: 0.423, Test loss: 1.354, Test accuracy: 59.10
Round  94, Train loss: 0.419, Test loss: 1.334, Test accuracy: 59.35
Round  95, Train loss: 0.415, Test loss: 1.356, Test accuracy: 59.40
Round  96, Train loss: 0.407, Test loss: 1.367, Test accuracy: 59.46
Round  97, Train loss: 0.401, Test loss: 1.392, Test accuracy: 59.40
Round  98, Train loss: 0.397, Test loss: 1.358, Test accuracy: 59.76
Round  99, Train loss: 0.396, Test loss: 1.377, Test accuracy: 59.71
Final Round, Train loss: 0.363, Test loss: 1.381, Test accuracy: 59.79
Average accuracy final 10 rounds: 59.56624999999999
3821.7058815956116
[2.5723423957824707, 4.960904598236084, 7.291829347610474, 9.601064205169678, 11.858241319656372, 14.168198585510254, 16.529383897781372, 18.712170600891113, 21.232486248016357, 23.79581904411316, 26.057051420211792, 28.216273069381714, 30.41901397705078, 32.65200853347778, 34.89977192878723, 37.24541449546814, 39.772082805633545, 41.970731019973755, 44.35407757759094, 46.53790760040283, 48.65463328361511, 52.772682666778564, 56.947267293930054, 61.347923278808594, 65.35826659202576, 69.96798086166382, 74.25068497657776, 78.89305424690247, 83.13185620307922, 87.60351800918579, 91.74185514450073, 95.8395607471466, 100.04549741744995, 104.12317705154419, 108.24055409431458, 112.35451555252075, 116.59202766418457, 120.943532705307, 125.25961875915527, 129.58548212051392, 134.13799166679382, 138.42528796195984, 142.5096230506897, 146.6779270172119, 150.90015864372253, 155.1306095123291, 159.47923398017883, 163.62465047836304, 167.96286153793335, 172.3076729774475, 176.45774364471436, 180.87353348731995, 185.2805163860321, 189.73580956459045, 193.94342184066772, 198.11889052391052, 202.27886986732483, 206.4213593006134, 210.6441993713379, 214.97402834892273, 219.11378359794617, 223.35231375694275, 227.44059228897095, 231.6258099079132, 235.93474221229553, 240.5164396762848, 244.76336073875427, 249.02435159683228, 253.195636510849, 257.54873394966125, 261.60935521125793, 265.76847863197327, 269.9412715435028, 274.1193542480469, 278.43336486816406, 282.63669657707214, 287.0869698524475, 291.4272298812866, 295.793372631073, 299.86066699028015, 304.0322377681732, 308.248233795166, 312.4079854488373, 316.5920352935791, 320.6993877887726, 325.19644260406494, 329.59512543678284, 333.82339334487915, 338.02540731430054, 342.23048400878906, 346.43066143989563, 350.96113300323486, 355.5212335586548, 359.74530816078186, 364.1040985584259, 368.3558542728424, 372.7235643863678, 377.2840974330902, 381.6473865509033, 385.95020937919617, 390.1071529388428]
[28.9625, 43.3125, 45.025, 49.4, 54.4375, 54.7625, 55.8, 57.8875, 61.4, 59.5625, 61.5, 60.8875, 63.275, 64.65, 64.1875, 65.8625, 66.275, 65.7125, 65.825, 67.4, 66.125, 66.175, 66.425, 66.2625, 64.75, 65.45, 65.4875, 65.125, 65.35, 63.7875, 64.6375, 64.4125, 65.175, 65.5875, 64.9625, 66.175, 65.5875, 64.75, 65.275, 64.275, 63.85, 63.85, 63.25, 63.6875, 62.675, 62.4125, 62.1, 61.75, 63.1875, 62.5, 62.8375, 63.1125, 62.5375, 62.9125, 62.5125, 61.5375, 62.425, 63.0375, 62.6375, 63.075, 62.1125, 62.9375, 62.1625, 62.85, 61.725, 61.85, 62.6625, 62.7125, 61.425, 61.6375, 61.8875, 60.925, 61.5625, 61.8125, 61.5125, 59.4375, 61.4875, 61.075, 59.5875, 60.4, 59.8625, 59.3625, 59.8, 59.9125, 59.4375, 59.175, 59.525, 59.625, 59.35, 59.3875, 60.15, 60.1, 59.225, 59.1, 59.35, 59.4, 59.4625, 59.4, 59.7625, 59.7125, 59.7875]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 4, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.639, Test loss: 1.619, Test accuracy: 36.75
Round   1, Train loss: 1.347, Test loss: 1.250, Test accuracy: 45.30
Round   2, Train loss: 1.266, Test loss: 1.158, Test accuracy: 49.19
Round   3, Train loss: 1.220, Test loss: 1.102, Test accuracy: 52.69
Round   4, Train loss: 1.190, Test loss: 1.073, Test accuracy: 55.77
Round   5, Train loss: 1.163, Test loss: 1.028, Test accuracy: 57.66
Round   6, Train loss: 1.142, Test loss: 1.013, Test accuracy: 58.31
Round   7, Train loss: 1.125, Test loss: 1.003, Test accuracy: 59.48
Round   8, Train loss: 1.108, Test loss: 0.956, Test accuracy: 62.98
Round   9, Train loss: 1.094, Test loss: 0.935, Test accuracy: 63.85
Round  10, Train loss: 1.004, Test loss: 0.932, Test accuracy: 64.31
Round  11, Train loss: 1.013, Test loss: 0.927, Test accuracy: 64.39
Round  12, Train loss: 1.061, Test loss: 0.923, Test accuracy: 64.40
Round  13, Train loss: 1.011, Test loss: 0.925, Test accuracy: 64.78
Round  14, Train loss: 0.947, Test loss: 0.929, Test accuracy: 64.51
Round  15, Train loss: 0.994, Test loss: 0.904, Test accuracy: 65.84
Round  16, Train loss: 0.873, Test loss: 0.902, Test accuracy: 65.45
Round  17, Train loss: 1.078, Test loss: 0.893, Test accuracy: 66.25
Round  18, Train loss: 1.027, Test loss: 0.871, Test accuracy: 66.69
Round  19, Train loss: 1.107, Test loss: 0.895, Test accuracy: 66.64
Round  20, Train loss: 0.969, Test loss: 0.870, Test accuracy: 66.74
Round  21, Train loss: 1.032, Test loss: 0.864, Test accuracy: 66.89
Round  22, Train loss: 0.966, Test loss: 0.864, Test accuracy: 67.14
Round  23, Train loss: 0.934, Test loss: 0.856, Test accuracy: 67.15
Round  24, Train loss: 0.891, Test loss: 0.864, Test accuracy: 66.76
Round  25, Train loss: 0.866, Test loss: 0.867, Test accuracy: 66.56
Round  26, Train loss: 0.975, Test loss: 0.859, Test accuracy: 66.76
Round  27, Train loss: 0.925, Test loss: 0.863, Test accuracy: 66.29
Round  28, Train loss: 0.909, Test loss: 0.862, Test accuracy: 67.05
Round  29, Train loss: 0.761, Test loss: 0.856, Test accuracy: 67.15
Round  30, Train loss: 0.762, Test loss: 0.855, Test accuracy: 66.94
Round  31, Train loss: 0.821, Test loss: 0.853, Test accuracy: 66.71
Round  32, Train loss: 0.766, Test loss: 0.853, Test accuracy: 67.05
Round  33, Train loss: 0.837, Test loss: 0.841, Test accuracy: 67.64
Round  34, Train loss: 0.907, Test loss: 0.864, Test accuracy: 66.17
Round  35, Train loss: 0.769, Test loss: 0.864, Test accuracy: 66.49
Round  36, Train loss: 0.845, Test loss: 0.878, Test accuracy: 66.28
Round  37, Train loss: 0.812, Test loss: 0.886, Test accuracy: 65.91
Round  38, Train loss: 0.861, Test loss: 0.884, Test accuracy: 65.88
Round  39, Train loss: 0.801, Test loss: 0.893, Test accuracy: 65.40
Round  40, Train loss: 0.806, Test loss: 0.871, Test accuracy: 66.53
Round  41, Train loss: 0.672, Test loss: 0.873, Test accuracy: 66.46
Round  42, Train loss: 0.683, Test loss: 0.876, Test accuracy: 66.46
Round  43, Train loss: 0.772, Test loss: 0.888, Test accuracy: 65.83
Round  44, Train loss: 0.705, Test loss: 0.900, Test accuracy: 65.14
Round  45, Train loss: 0.726, Test loss: 0.927, Test accuracy: 64.29
Round  46, Train loss: 0.663, Test loss: 0.899, Test accuracy: 65.41
Round  47, Train loss: 0.734, Test loss: 0.906, Test accuracy: 64.96
Round  48, Train loss: 0.647, Test loss: 0.883, Test accuracy: 65.39
Round  49, Train loss: 0.668, Test loss: 0.885, Test accuracy: 65.89
Round  50, Train loss: 0.658, Test loss: 0.900, Test accuracy: 65.78
Round  51, Train loss: 0.582, Test loss: 0.901, Test accuracy: 65.81
Round  52, Train loss: 0.584, Test loss: 0.926, Test accuracy: 64.76
Round  53, Train loss: 0.716, Test loss: 0.923, Test accuracy: 64.62
Round  54, Train loss: 0.641, Test loss: 0.951, Test accuracy: 63.80
Round  55, Train loss: 0.641, Test loss: 0.945, Test accuracy: 63.55
Round  56, Train loss: 0.709, Test loss: 0.954, Test accuracy: 63.96
Round  57, Train loss: 0.531, Test loss: 0.950, Test accuracy: 64.51
Round  58, Train loss: 0.619, Test loss: 0.932, Test accuracy: 64.88
Round  59, Train loss: 0.632, Test loss: 0.954, Test accuracy: 64.19
Round  60, Train loss: 0.507, Test loss: 0.940, Test accuracy: 64.78
Round  61, Train loss: 0.598, Test loss: 0.941, Test accuracy: 65.16
Round  62, Train loss: 0.549, Test loss: 0.943, Test accuracy: 64.86
Round  63, Train loss: 0.570, Test loss: 0.942, Test accuracy: 64.79
Round  64, Train loss: 0.562, Test loss: 0.951, Test accuracy: 63.45
Round  65, Train loss: 0.507, Test loss: 0.979, Test accuracy: 63.99
Round  66, Train loss: 0.655, Test loss: 0.987, Test accuracy: 63.58
Round  67, Train loss: 0.558, Test loss: 0.992, Test accuracy: 63.83
Round  68, Train loss: 0.520, Test loss: 0.968, Test accuracy: 64.74
Round  69, Train loss: 0.428, Test loss: 0.970, Test accuracy: 64.96
Round  70, Train loss: 0.412, Test loss: 0.978, Test accuracy: 64.85
Round  71, Train loss: 0.550, Test loss: 0.980, Test accuracy: 64.92
Round  72, Train loss: 0.470, Test loss: 0.985, Test accuracy: 64.70
Round  73, Train loss: 0.560, Test loss: 0.998, Test accuracy: 63.65
Round  74, Train loss: 0.467, Test loss: 0.987, Test accuracy: 64.61
Round  75, Train loss: 0.505, Test loss: 1.015, Test accuracy: 64.11
Round  76, Train loss: 0.425, Test loss: 1.010, Test accuracy: 64.35
Round  77, Train loss: 0.440, Test loss: 1.026, Test accuracy: 63.58
Round  78, Train loss: 0.535, Test loss: 1.038, Test accuracy: 62.39
Round  79, Train loss: 0.481, Test loss: 0.994, Test accuracy: 64.49
Round  80, Train loss: 0.358, Test loss: 0.992, Test accuracy: 64.95
Round  81, Train loss: 0.332, Test loss: 0.992, Test accuracy: 65.09
Round  82, Train loss: 0.320, Test loss: 0.992, Test accuracy: 65.34
Round  83, Train loss: 0.299, Test loss: 1.008, Test accuracy: 65.14
Round  84, Train loss: 0.297, Test loss: 1.017, Test accuracy: 65.33
Round  85, Train loss: 0.278, Test loss: 1.017, Test accuracy: 65.11
Round  86, Train loss: 0.270, Test loss: 1.029, Test accuracy: 64.45
Round  87, Train loss: 0.255, Test loss: 1.033, Test accuracy: 64.95
Round  88, Train loss: 0.250, Test loss: 1.034, Test accuracy: 65.00
Round  89, Train loss: 0.240, Test loss: 1.040, Test accuracy: 64.30
Round  90, Train loss: 0.461, Test loss: 1.035, Test accuracy: 64.50
Round  91, Train loss: 0.447, Test loss: 1.047, Test accuracy: 64.40
Round  92, Train loss: 0.432, Test loss: 1.052, Test accuracy: 64.10
Round  93, Train loss: 0.421, Test loss: 1.058, Test accuracy: 64.20
Round  94, Train loss: 0.422, Test loss: 1.064, Test accuracy: 63.40
Round  95, Train loss: 0.417, Test loss: 1.065, Test accuracy: 63.58
Round  96, Train loss: 0.407, Test loss: 1.081, Test accuracy: 63.69
Round  97, Train loss: 0.406, Test loss: 1.090, Test accuracy: 62.73
Round  98, Train loss: 0.404, Test loss: 1.118, Test accuracy: 61.74
Round  99, Train loss: 0.397, Test loss: 1.080, Test accuracy: 63.27
Final Round, Train loss: 0.395, Test loss: 1.105, Test accuracy: 63.16
Average accuracy final 10 rounds: 63.56
4023.543620109558
[2.9290223121643066, 5.7846314907073975, 8.729639530181885, 11.745644330978394, 14.910845279693604, 18.15328574180603, 20.858860731124878, 23.786558389663696, 26.63325262069702, 29.44605541229248, 32.459165811538696, 35.21292996406555, 37.866931200027466, 40.54905462265015, 43.24251079559326, 46.216729402542114, 48.89662504196167, 51.523438930511475, 54.22195911407471, 57.02785539627075, 59.71105742454529, 64.55066466331482, 69.5530035495758, 74.71146297454834, 79.67452597618103, 84.6050636768341, 89.19521880149841, 94.02371525764465, 98.93971824645996, 103.93217611312866, 108.75746440887451, 113.40923118591309, 118.2720422744751, 123.09958386421204, 127.90859961509705, 132.53662776947021, 136.99419355392456, 141.54627513885498, 146.12222123146057, 150.74199104309082, 155.22687792778015, 159.68647503852844, 164.08868288993835, 168.73920273780823, 173.15340113639832, 177.58844447135925, 182.43386554718018, 186.95332074165344, 191.48801469802856, 196.0093011856079, 200.85500311851501, 205.47766852378845, 210.17885994911194, 214.63195300102234, 219.1923086643219, 223.76030135154724, 228.5530607700348, 233.11766266822815, 237.7984459400177, 242.43594694137573, 246.95843172073364, 251.40913271903992, 256.0365011692047, 260.82180619239807, 265.54020977020264, 270.03175592422485, 274.4480082988739, 279.0477559566498, 283.62501883506775, 288.3304476737976, 293.0797326564789, 297.6106946468353, 302.3794755935669, 307.0649218559265, 311.8075370788574, 316.73661041259766, 321.67457389831543, 326.5756688117981, 331.31152725219727, 336.10053420066833, 340.92832946777344, 345.85013604164124, 350.71972942352295, 355.8684892654419, 360.6716067790985, 365.57037925720215, 370.34368109703064, 375.2957420349121, 380.2288353443146, 385.04987382888794, 390.36805987358093, 395.3152713775635, 400.29117155075073, 405.27599143981934, 410.17299795150757, 415.1727104187012, 420.3146975040436, 425.3229253292084, 430.2087616920471, 435.22437930107117, 439.4077649116516]
[36.75, 45.3, 49.1875, 52.6875, 55.775, 57.6625, 58.3125, 59.475, 62.975, 63.85, 64.3125, 64.3875, 64.4, 64.775, 64.5125, 65.8375, 65.45, 66.25, 66.6875, 66.6375, 66.7375, 66.8875, 67.1375, 67.15, 66.7625, 66.5625, 66.7625, 66.2875, 67.05, 67.15, 66.9375, 66.7125, 67.05, 67.6375, 66.175, 66.4875, 66.275, 65.9125, 65.875, 65.4, 66.525, 66.4625, 66.4625, 65.825, 65.1375, 64.2875, 65.4125, 64.9625, 65.3875, 65.8875, 65.775, 65.8125, 64.7625, 64.625, 63.8, 63.55, 63.9625, 64.5125, 64.875, 64.1875, 64.775, 65.1625, 64.8625, 64.7875, 63.45, 63.9875, 63.575, 63.825, 64.7375, 64.9625, 64.85, 64.925, 64.7, 63.65, 64.6125, 64.1125, 64.35, 63.575, 62.3875, 64.4875, 64.95, 65.0875, 65.3375, 65.1375, 65.325, 65.1125, 64.45, 64.95, 65.0, 64.3, 64.5, 64.4, 64.1, 64.2, 63.4, 63.575, 63.6875, 62.725, 61.7375, 63.275, 63.1625]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.675, Test loss: 2.065, Test accuracy: 21.60
Round   0, Global train loss: 1.675, Global test loss: 2.268, Global test accuracy: 17.91
Round   1, Train loss: 1.509, Test loss: 1.882, Test accuracy: 30.35
Round   1, Global train loss: 1.509, Global test loss: 2.225, Global test accuracy: 24.42
Round   2, Train loss: 1.518, Test loss: 1.645, Test accuracy: 33.86
Round   2, Global train loss: 1.518, Global test loss: 2.114, Global test accuracy: 22.71
Round   3, Train loss: 1.409, Test loss: 1.575, Test accuracy: 37.82
Round   3, Global train loss: 1.409, Global test loss: 2.198, Global test accuracy: 24.30
Round   4, Train loss: 1.435, Test loss: 1.470, Test accuracy: 40.59
Round   4, Global train loss: 1.435, Global test loss: 2.107, Global test accuracy: 25.79
Round   5, Train loss: 1.443, Test loss: 1.409, Test accuracy: 42.99
Round   5, Global train loss: 1.443, Global test loss: 2.118, Global test accuracy: 25.56
Round   6, Train loss: 1.393, Test loss: 1.305, Test accuracy: 46.25
Round   6, Global train loss: 1.393, Global test loss: 2.058, Global test accuracy: 20.97
Round   7, Train loss: 1.288, Test loss: 1.255, Test accuracy: 48.59
Round   7, Global train loss: 1.288, Global test loss: 2.009, Global test accuracy: 29.65
Round   8, Train loss: 1.232, Test loss: 1.252, Test accuracy: 48.60
Round   8, Global train loss: 1.232, Global test loss: 2.102, Global test accuracy: 22.06
Round   9, Train loss: 1.311, Test loss: 1.240, Test accuracy: 49.50
Round   9, Global train loss: 1.311, Global test loss: 2.111, Global test accuracy: 24.69
Round  10, Train loss: 1.231, Test loss: 1.213, Test accuracy: 51.00
Round  10, Global train loss: 1.231, Global test loss: 2.043, Global test accuracy: 34.42
Round  11, Train loss: 1.161, Test loss: 1.201, Test accuracy: 51.77
Round  11, Global train loss: 1.161, Global test loss: 2.099, Global test accuracy: 29.73
Round  12, Train loss: 1.240, Test loss: 1.192, Test accuracy: 52.06
Round  12, Global train loss: 1.240, Global test loss: 2.247, Global test accuracy: 25.51
Round  13, Train loss: 1.240, Test loss: 1.181, Test accuracy: 52.96
Round  13, Global train loss: 1.240, Global test loss: 2.256, Global test accuracy: 20.94
Round  14, Train loss: 1.193, Test loss: 1.179, Test accuracy: 53.15
Round  14, Global train loss: 1.193, Global test loss: 2.078, Global test accuracy: 28.79
Round  15, Train loss: 1.178, Test loss: 1.172, Test accuracy: 53.64
Round  15, Global train loss: 1.178, Global test loss: 2.065, Global test accuracy: 31.38
Round  16, Train loss: 1.220, Test loss: 1.169, Test accuracy: 54.12
Round  16, Global train loss: 1.220, Global test loss: 1.992, Global test accuracy: 29.28
Round  17, Train loss: 1.168, Test loss: 1.175, Test accuracy: 53.87
Round  17, Global train loss: 1.168, Global test loss: 2.095, Global test accuracy: 23.03
Round  18, Train loss: 1.116, Test loss: 1.181, Test accuracy: 53.96
Round  18, Global train loss: 1.116, Global test loss: 2.054, Global test accuracy: 25.08
Round  19, Train loss: 1.178, Test loss: 1.180, Test accuracy: 54.49
Round  19, Global train loss: 1.178, Global test loss: 2.012, Global test accuracy: 28.45
Round  20, Train loss: 1.021, Test loss: 1.186, Test accuracy: 54.27
Round  20, Global train loss: 1.021, Global test loss: 2.040, Global test accuracy: 28.41
Round  21, Train loss: 1.206, Test loss: 1.169, Test accuracy: 54.65
Round  21, Global train loss: 1.206, Global test loss: 1.963, Global test accuracy: 28.44
Round  22, Train loss: 1.065, Test loss: 1.181, Test accuracy: 54.56
Round  22, Global train loss: 1.065, Global test loss: 2.093, Global test accuracy: 28.36
Round  23, Train loss: 0.954, Test loss: 1.197, Test accuracy: 54.35
Round  23, Global train loss: 0.954, Global test loss: 2.051, Global test accuracy: 33.97
Round  24, Train loss: 1.086, Test loss: 1.195, Test accuracy: 55.17
Round  24, Global train loss: 1.086, Global test loss: 2.038, Global test accuracy: 27.60
Round  25, Train loss: 1.001, Test loss: 1.202, Test accuracy: 54.56
Round  25, Global train loss: 1.001, Global test loss: 1.988, Global test accuracy: 27.89
Round  26, Train loss: 0.958, Test loss: 1.210, Test accuracy: 54.93
Round  26, Global train loss: 0.958, Global test loss: 1.925, Global test accuracy: 36.09
Round  27, Train loss: 1.009, Test loss: 1.233, Test accuracy: 54.18
Round  27, Global train loss: 1.009, Global test loss: 2.101, Global test accuracy: 23.73
Round  28, Train loss: 0.980, Test loss: 1.218, Test accuracy: 54.55
Round  28, Global train loss: 0.980, Global test loss: 1.829, Global test accuracy: 35.77
Round  29, Train loss: 0.856, Test loss: 1.227, Test accuracy: 54.49
Round  29, Global train loss: 0.856, Global test loss: 1.992, Global test accuracy: 30.80
Round  30, Train loss: 0.890, Test loss: 1.224, Test accuracy: 54.45
Round  30, Global train loss: 0.890, Global test loss: 2.042, Global test accuracy: 26.71
Round  31, Train loss: 0.828, Test loss: 1.249, Test accuracy: 54.31
Round  31, Global train loss: 0.828, Global test loss: 1.960, Global test accuracy: 32.66
Round  32, Train loss: 0.804, Test loss: 1.262, Test accuracy: 54.43
Round  32, Global train loss: 0.804, Global test loss: 2.083, Global test accuracy: 21.89
Round  33, Train loss: 0.871, Test loss: 1.268, Test accuracy: 55.02
Round  33, Global train loss: 0.871, Global test loss: 2.005, Global test accuracy: 25.45
Round  34, Train loss: 0.706, Test loss: 1.287, Test accuracy: 54.80
Round  34, Global train loss: 0.706, Global test loss: 1.979, Global test accuracy: 28.04
Round  35, Train loss: 0.866, Test loss: 1.309, Test accuracy: 54.76
Round  35, Global train loss: 0.866, Global test loss: 2.013, Global test accuracy: 29.04
Round  36, Train loss: 0.948, Test loss: 1.317, Test accuracy: 55.07
Round  36, Global train loss: 0.948, Global test loss: 2.387, Global test accuracy: 23.08
Round  37, Train loss: 0.831, Test loss: 1.330, Test accuracy: 54.48
Round  37, Global train loss: 0.831, Global test loss: 2.012, Global test accuracy: 29.51
Round  38, Train loss: 0.896, Test loss: 1.332, Test accuracy: 54.28
Round  38, Global train loss: 0.896, Global test loss: 2.023, Global test accuracy: 28.06
Round  39, Train loss: 0.742, Test loss: 1.334, Test accuracy: 55.00
Round  39, Global train loss: 0.742, Global test loss: 1.873, Global test accuracy: 32.01
Round  40, Train loss: 0.727, Test loss: 1.363, Test accuracy: 54.74
Round  40, Global train loss: 0.727, Global test loss: 1.982, Global test accuracy: 32.73
Round  41, Train loss: 0.606, Test loss: 1.387, Test accuracy: 54.28
Round  41, Global train loss: 0.606, Global test loss: 1.968, Global test accuracy: 33.93
Round  42, Train loss: 0.725, Test loss: 1.412, Test accuracy: 54.25
Round  42, Global train loss: 0.725, Global test loss: 2.072, Global test accuracy: 23.06
Round  43, Train loss: 0.766, Test loss: 1.458, Test accuracy: 54.10
Round  43, Global train loss: 0.766, Global test loss: 2.136, Global test accuracy: 29.89
Round  44, Train loss: 0.546, Test loss: 1.461, Test accuracy: 54.18
Round  44, Global train loss: 0.546, Global test loss: 2.010, Global test accuracy: 28.22
Round  45, Train loss: 0.531, Test loss: 1.516, Test accuracy: 53.94
Round  45, Global train loss: 0.531, Global test loss: 2.055, Global test accuracy: 28.35
Round  46, Train loss: 0.777, Test loss: 1.513, Test accuracy: 53.55
Round  46, Global train loss: 0.777, Global test loss: 2.084, Global test accuracy: 24.23
Round  47, Train loss: 0.832, Test loss: 1.566, Test accuracy: 52.40
Round  47, Global train loss: 0.832, Global test loss: 1.947, Global test accuracy: 31.20
Round  48, Train loss: 0.624, Test loss: 1.591, Test accuracy: 52.35
Round  48, Global train loss: 0.624, Global test loss: 2.041, Global test accuracy: 27.58
Round  49, Train loss: 0.719, Test loss: 1.598, Test accuracy: 52.24
Round  49, Global train loss: 0.719, Global test loss: 1.917, Global test accuracy: 33.08
Round  50, Train loss: 0.670, Test loss: 1.618, Test accuracy: 52.02
Round  50, Global train loss: 0.670, Global test loss: 2.049, Global test accuracy: 26.08
Round  51, Train loss: 0.441, Test loss: 1.633, Test accuracy: 51.63
Round  51, Global train loss: 0.441, Global test loss: 2.017, Global test accuracy: 27.33
Round  52, Train loss: 0.463, Test loss: 1.672, Test accuracy: 51.96
Round  52, Global train loss: 0.463, Global test loss: 2.006, Global test accuracy: 28.91
Round  53, Train loss: 0.602, Test loss: 1.684, Test accuracy: 51.93
Round  53, Global train loss: 0.602, Global test loss: 2.066, Global test accuracy: 26.06
Round  54, Train loss: 0.522, Test loss: 1.665, Test accuracy: 52.28
Round  54, Global train loss: 0.522, Global test loss: 2.194, Global test accuracy: 21.02
Round  55, Train loss: 0.309, Test loss: 1.736, Test accuracy: 51.77
Round  55, Global train loss: 0.309, Global test loss: 2.264, Global test accuracy: 20.12
Round  56, Train loss: 0.498, Test loss: 1.747, Test accuracy: 52.20
Round  56, Global train loss: 0.498, Global test loss: 1.802, Global test accuracy: 36.18
Round  57, Train loss: 0.436, Test loss: 1.775, Test accuracy: 51.74
Round  57, Global train loss: 0.436, Global test loss: 1.972, Global test accuracy: 27.88
Round  58, Train loss: 0.605, Test loss: 1.777, Test accuracy: 51.86
Round  58, Global train loss: 0.605, Global test loss: 2.029, Global test accuracy: 26.60
Round  59, Train loss: 0.616, Test loss: 1.775, Test accuracy: 51.89
Round  59, Global train loss: 0.616, Global test loss: 1.922, Global test accuracy: 32.57
Round  60, Train loss: 0.492, Test loss: 1.815, Test accuracy: 51.06
Round  60, Global train loss: 0.492, Global test loss: 1.995, Global test accuracy: 31.90
Round  61, Train loss: 0.508, Test loss: 1.830, Test accuracy: 51.96
Round  61, Global train loss: 0.508, Global test loss: 1.979, Global test accuracy: 32.66
Round  62, Train loss: 0.480, Test loss: 1.880, Test accuracy: 51.49
Round  62, Global train loss: 0.480, Global test loss: 2.136, Global test accuracy: 25.52
Round  63, Train loss: 0.472, Test loss: 1.880, Test accuracy: 52.09
Round  63, Global train loss: 0.472, Global test loss: 2.072, Global test accuracy: 25.23
Round  64, Train loss: 0.520, Test loss: 1.910, Test accuracy: 52.33
Round  64, Global train loss: 0.520, Global test loss: 2.095, Global test accuracy: 27.18
Round  65, Train loss: 0.365, Test loss: 1.963, Test accuracy: 51.72
Round  65, Global train loss: 0.365, Global test loss: 2.032, Global test accuracy: 27.83
Round  66, Train loss: 0.346, Test loss: 1.995, Test accuracy: 52.30
Round  66, Global train loss: 0.346, Global test loss: 1.980, Global test accuracy: 29.14
Round  67, Train loss: 0.437, Test loss: 2.051, Test accuracy: 52.24
Round  67, Global train loss: 0.437, Global test loss: 2.006, Global test accuracy: 28.70
Round  68, Train loss: 0.223, Test loss: 2.070, Test accuracy: 52.02
Round  68, Global train loss: 0.223, Global test loss: 2.137, Global test accuracy: 27.43
Round  69, Train loss: 0.414, Test loss: 2.118, Test accuracy: 51.93
Round  69, Global train loss: 0.414, Global test loss: 1.998, Global test accuracy: 28.59
Round  70, Train loss: 0.323, Test loss: 2.131, Test accuracy: 51.63
Round  70, Global train loss: 0.323, Global test loss: 2.028, Global test accuracy: 26.38
Round  71, Train loss: 0.289, Test loss: 2.181, Test accuracy: 51.69
Round  71, Global train loss: 0.289, Global test loss: 2.091, Global test accuracy: 27.11
Round  72, Train loss: 0.331, Test loss: 2.217, Test accuracy: 51.40
Round  72, Global train loss: 0.331, Global test loss: 2.094, Global test accuracy: 24.99
Round  73, Train loss: 0.346, Test loss: 2.259, Test accuracy: 50.62
Round  73, Global train loss: 0.346, Global test loss: 1.962, Global test accuracy: 28.86
Round  74, Train loss: 0.278, Test loss: 2.233, Test accuracy: 50.94
Round  74, Global train loss: 0.278, Global test loss: 2.022, Global test accuracy: 28.23
Round  75, Train loss: 0.269, Test loss: 2.223, Test accuracy: 50.86
Round  75, Global train loss: 0.269, Global test loss: 2.089, Global test accuracy: 28.23
Round  76, Train loss: 0.362, Test loss: 2.221, Test accuracy: 51.47
Round  76, Global train loss: 0.362, Global test loss: 2.207, Global test accuracy: 29.30
Round  77, Train loss: 0.282, Test loss: 2.265, Test accuracy: 52.02
Round  77, Global train loss: 0.282, Global test loss: 1.933, Global test accuracy: 32.69
Round  78, Train loss: 0.264, Test loss: 2.304, Test accuracy: 51.27
Round  78, Global train loss: 0.264, Global test loss: 2.149, Global test accuracy: 25.37
Round  79, Train loss: 0.242, Test loss: 2.323, Test accuracy: 51.76
Round  79, Global train loss: 0.242, Global test loss: 1.985, Global test accuracy: 31.17
Round  80, Train loss: 0.309, Test loss: 2.344, Test accuracy: 51.45
Round  80, Global train loss: 0.309, Global test loss: 2.051, Global test accuracy: 27.69
Round  81, Train loss: 0.334, Test loss: 2.347, Test accuracy: 51.76
Round  81, Global train loss: 0.334, Global test loss: 2.190, Global test accuracy: 28.32
Round  82, Train loss: 0.258, Test loss: 2.382, Test accuracy: 51.42
Round  82, Global train loss: 0.258, Global test loss: 2.013, Global test accuracy: 32.74
Round  83, Train loss: 0.249, Test loss: 2.509, Test accuracy: 51.00
Round  83, Global train loss: 0.249, Global test loss: 2.057, Global test accuracy: 26.16
Round  84, Train loss: 0.225, Test loss: 2.525, Test accuracy: 50.70
Round  84, Global train loss: 0.225, Global test loss: 1.960, Global test accuracy: 32.63
Round  85, Train loss: 0.226, Test loss: 2.482, Test accuracy: 50.66
Round  85, Global train loss: 0.226, Global test loss: 2.062, Global test accuracy: 25.06
Round  86, Train loss: 0.297, Test loss: 2.505, Test accuracy: 50.23
Round  86, Global train loss: 0.297, Global test loss: 2.092, Global test accuracy: 26.03
Round  87, Train loss: 0.164, Test loss: 2.455, Test accuracy: 50.72
Round  87, Global train loss: 0.164, Global test loss: 2.025, Global test accuracy: 25.82
Round  88, Train loss: 0.201, Test loss: 2.558, Test accuracy: 50.60
Round  88, Global train loss: 0.201, Global test loss: 2.150, Global test accuracy: 25.36
Round  89, Train loss: 0.265, Test loss: 2.604, Test accuracy: 50.48
Round  89, Global train loss: 0.265, Global test loss: 2.152, Global test accuracy: 27.30
Round  90, Train loss: 0.193, Test loss: 2.606, Test accuracy: 50.66
Round  90, Global train loss: 0.193, Global test loss: 2.117, Global test accuracy: 24.85
Round  91, Train loss: 0.180, Test loss: 2.664, Test accuracy: 51.10
Round  91, Global train loss: 0.180, Global test loss: 2.188, Global test accuracy: 23.28
Round  92, Train loss: 0.193, Test loss: 2.608, Test accuracy: 50.95
Round  92, Global train loss: 0.193, Global test loss: 2.041, Global test accuracy: 31.18
Round  93, Train loss: 0.192, Test loss: 2.646, Test accuracy: 51.62
Round  93, Global train loss: 0.192, Global test loss: 2.039, Global test accuracy: 26.66
Round  94, Train loss: 0.172, Test loss: 2.654, Test accuracy: 51.70
Round  94, Global train loss: 0.172, Global test loss: 1.988, Global test accuracy: 29.17
Round  95, Train loss: 0.201, Test loss: 2.675, Test accuracy: 51.55
Round  95, Global train loss: 0.201, Global test loss: 2.033, Global test accuracy: 27.58
Round  96, Train loss: 0.177, Test loss: 2.712, Test accuracy: 51.68
Round  96, Global train loss: 0.177, Global test loss: 1.991, Global test accuracy: 28.99
Round  97, Train loss: 0.172, Test loss: 2.688, Test accuracy: 52.04
Round  97, Global train loss: 0.172, Global test loss: 2.057, Global test accuracy: 28.57
Round  98, Train loss: 0.178, Test loss: 2.695, Test accuracy: 51.56
Round  98, Global train loss: 0.178, Global test loss: 2.077, Global test accuracy: 25.16
Round  99, Train loss: 0.179, Test loss: 2.685, Test accuracy: 51.19
Round  99, Global train loss: 0.179, Global test loss: 2.128, Global test accuracy: 24.41
Final Round, Train loss: 0.173, Test loss: 2.765, Test accuracy: 51.05
Final Round, Global train loss: 0.173, Global test loss: 2.128, Global test accuracy: 24.41
Average accuracy final 10 rounds: 51.405 

Average global accuracy final 10 rounds: 26.985000000000003 

1826.5894148349762
[1.8705041408538818, 3.7410082817077637, 5.26703405380249, 6.793059825897217, 8.221555948257446, 9.650052070617676, 11.245594263076782, 12.841136455535889, 14.405650615692139, 15.970164775848389, 17.424800157546997, 18.879435539245605, 20.39807677268982, 21.916718006134033, 23.436680555343628, 24.956643104553223, 26.38274097442627, 27.808838844299316, 29.38317346572876, 30.957508087158203, 32.5425865650177, 34.1276650428772, 35.73651123046875, 37.3453574180603, 38.87705898284912, 40.40876054763794, 41.968748331069946, 43.52873611450195, 44.96032929420471, 46.39192247390747, 47.831828355789185, 49.2717342376709, 50.856406450271606, 52.441078662872314, 53.944021701812744, 55.446964740753174, 57.10151743888855, 58.756070137023926, 60.53890800476074, 62.32174587249756, 63.96631979942322, 65.61089372634888, 67.09933185577393, 68.58776998519897, 70.1697838306427, 71.75179767608643, 73.27365469932556, 74.7955117225647, 76.22319602966309, 77.65088033676147, 79.2141044139862, 80.77732849121094, 82.48662567138672, 84.1959228515625, 85.82846999168396, 87.46101713180542, 88.95492100715637, 90.44882488250732, 91.97105312347412, 93.49328136444092, 95.12387323379517, 96.75446510314941, 98.34186577796936, 99.9292664527893, 101.52877688407898, 103.12828731536865, 104.71946597099304, 106.31064462661743, 107.73572587966919, 109.16080713272095, 110.74752736091614, 112.33424758911133, 113.74715638160706, 115.16006517410278, 116.65985560417175, 118.15964603424072, 119.65956616401672, 121.15948629379272, 122.79367685317993, 124.42786741256714, 125.92787599563599, 127.42788457870483, 128.88402605056763, 130.34016752243042, 131.87061190605164, 133.40105628967285, 134.97081685066223, 136.5405774116516, 138.1743519306183, 139.80812644958496, 141.35737943649292, 142.90663242340088, 144.58244800567627, 146.25826358795166, 147.71783781051636, 149.17741203308105, 150.60399198532104, 152.03057193756104, 153.46394395828247, 154.8973159790039, 156.40784120559692, 157.91836643218994, 159.53846955299377, 161.1585726737976, 162.73781967163086, 164.3170666694641, 165.8923671245575, 167.46766757965088, 169.39199471473694, 171.316321849823, 172.70064449310303, 174.08496713638306, 175.77972722053528, 177.4744873046875, 179.1363010406494, 180.79811477661133, 182.35270404815674, 183.90729331970215, 185.55865669250488, 187.21002006530762, 188.6767418384552, 190.14346361160278, 191.6255943775177, 193.10772514343262, 194.66894626617432, 196.23016738891602, 197.81428623199463, 199.39840507507324, 200.84737086296082, 202.2963366508484, 203.75057458877563, 205.20481252670288, 206.67606616020203, 208.14731979370117, 209.61215472221375, 211.07698965072632, 212.7019064426422, 214.3268232345581, 215.7756416797638, 217.22446012496948, 218.6956386566162, 220.16681718826294, 221.602445602417, 223.03807401657104, 224.5268988609314, 226.01572370529175, 227.52300691604614, 229.03029012680054, 230.5532968044281, 232.07630348205566, 233.51055717468262, 234.94481086730957, 236.4815149307251, 238.01821899414062, 239.62180352210999, 241.22538805007935, 242.89066100120544, 244.55593395233154, 246.11611771583557, 247.6763014793396, 249.2684805393219, 250.8606595993042, 252.4635546207428, 254.0664496421814, 255.62812972068787, 257.18980979919434, 258.8116202354431, 260.4334306716919, 262.06683564186096, 263.70024061203003, 265.2002112865448, 266.70018196105957, 268.20708298683167, 269.71398401260376, 271.3134982585907, 272.91301250457764, 274.3723840713501, 275.83175563812256, 277.424822807312, 279.01788997650146, 280.4832332134247, 281.9485764503479, 283.46423077583313, 284.97988510131836, 286.51823139190674, 288.0565776824951, 289.9248683452606, 291.7931590080261, 293.43547320365906, 295.077787399292, 296.9637088775635, 298.84963035583496, 300.3163058757782, 301.78298139572144, 303.4013340473175, 305.0196866989136, 306.5181119441986, 308.01653718948364, 309.5870199203491, 311.1575026512146, 314.30769658088684, 317.4578905105591]
[21.6, 21.6, 30.35, 30.35, 33.86, 33.86, 37.82, 37.82, 40.59, 40.59, 42.99, 42.99, 46.25, 46.25, 48.59, 48.59, 48.6, 48.6, 49.5, 49.5, 51.0, 51.0, 51.77, 51.77, 52.06, 52.06, 52.96, 52.96, 53.15, 53.15, 53.64, 53.64, 54.12, 54.12, 53.87, 53.87, 53.96, 53.96, 54.49, 54.49, 54.27, 54.27, 54.65, 54.65, 54.56, 54.56, 54.35, 54.35, 55.17, 55.17, 54.56, 54.56, 54.93, 54.93, 54.18, 54.18, 54.55, 54.55, 54.49, 54.49, 54.45, 54.45, 54.31, 54.31, 54.43, 54.43, 55.02, 55.02, 54.8, 54.8, 54.76, 54.76, 55.07, 55.07, 54.48, 54.48, 54.28, 54.28, 55.0, 55.0, 54.74, 54.74, 54.28, 54.28, 54.25, 54.25, 54.1, 54.1, 54.18, 54.18, 53.94, 53.94, 53.55, 53.55, 52.4, 52.4, 52.35, 52.35, 52.24, 52.24, 52.02, 52.02, 51.63, 51.63, 51.96, 51.96, 51.93, 51.93, 52.28, 52.28, 51.77, 51.77, 52.2, 52.2, 51.74, 51.74, 51.86, 51.86, 51.89, 51.89, 51.06, 51.06, 51.96, 51.96, 51.49, 51.49, 52.09, 52.09, 52.33, 52.33, 51.72, 51.72, 52.3, 52.3, 52.24, 52.24, 52.02, 52.02, 51.93, 51.93, 51.63, 51.63, 51.69, 51.69, 51.4, 51.4, 50.62, 50.62, 50.94, 50.94, 50.86, 50.86, 51.47, 51.47, 52.02, 52.02, 51.27, 51.27, 51.76, 51.76, 51.45, 51.45, 51.76, 51.76, 51.42, 51.42, 51.0, 51.0, 50.7, 50.7, 50.66, 50.66, 50.23, 50.23, 50.72, 50.72, 50.6, 50.6, 50.48, 50.48, 50.66, 50.66, 51.1, 51.1, 50.95, 50.95, 51.62, 51.62, 51.7, 51.7, 51.55, 51.55, 51.68, 51.68, 52.04, 52.04, 51.56, 51.56, 51.19, 51.19, 51.05, 51.05]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.679, Test loss: 2.082, Test accuracy: 21.87
Round   0, Global train loss: 1.679, Global test loss: 2.284, Global test accuracy: 18.37
Round   1, Train loss: 1.544, Test loss: 1.885, Test accuracy: 30.10
Round   1, Global train loss: 1.544, Global test loss: 2.209, Global test accuracy: 24.92
Round   2, Train loss: 1.506, Test loss: 1.613, Test accuracy: 34.84
Round   2, Global train loss: 1.506, Global test loss: 1.965, Global test accuracy: 25.83
Round   3, Train loss: 1.498, Test loss: 1.556, Test accuracy: 39.21
Round   3, Global train loss: 1.498, Global test loss: 2.087, Global test accuracy: 26.71
Round   4, Train loss: 1.324, Test loss: 1.401, Test accuracy: 44.28
Round   4, Global train loss: 1.324, Global test loss: 1.848, Global test accuracy: 31.09
Round   5, Train loss: 1.515, Test loss: 1.379, Test accuracy: 45.52
Round   5, Global train loss: 1.515, Global test loss: 1.963, Global test accuracy: 28.96
Round   6, Train loss: 1.552, Test loss: 1.275, Test accuracy: 49.78
Round   6, Global train loss: 1.552, Global test loss: 1.864, Global test accuracy: 32.76
Round   7, Train loss: 1.253, Test loss: 1.218, Test accuracy: 52.26
Round   7, Global train loss: 1.253, Global test loss: 1.729, Global test accuracy: 37.96
Round   8, Train loss: 1.211, Test loss: 1.207, Test accuracy: 53.11
Round   8, Global train loss: 1.211, Global test loss: 1.833, Global test accuracy: 35.29
Round   9, Train loss: 1.250, Test loss: 1.197, Test accuracy: 53.98
Round   9, Global train loss: 1.250, Global test loss: 1.814, Global test accuracy: 36.06
Round  10, Train loss: 1.348, Test loss: 1.187, Test accuracy: 55.25
Round  10, Global train loss: 1.348, Global test loss: 1.730, Global test accuracy: 40.36
Round  11, Train loss: 1.092, Test loss: 1.179, Test accuracy: 55.88
Round  11, Global train loss: 1.092, Global test loss: 1.858, Global test accuracy: 37.57
Round  12, Train loss: 1.255, Test loss: 1.190, Test accuracy: 56.02
Round  12, Global train loss: 1.255, Global test loss: 1.948, Global test accuracy: 38.25
Round  13, Train loss: 1.169, Test loss: 1.158, Test accuracy: 57.15
Round  13, Global train loss: 1.169, Global test loss: 1.872, Global test accuracy: 35.13
Round  14, Train loss: 1.265, Test loss: 1.133, Test accuracy: 57.48
Round  14, Global train loss: 1.265, Global test loss: 1.808, Global test accuracy: 39.04
Round  15, Train loss: 1.223, Test loss: 1.126, Test accuracy: 57.97
Round  15, Global train loss: 1.223, Global test loss: 1.657, Global test accuracy: 45.96
Round  16, Train loss: 1.409, Test loss: 1.108, Test accuracy: 58.81
Round  16, Global train loss: 1.409, Global test loss: 1.671, Global test accuracy: 43.67
Round  17, Train loss: 1.302, Test loss: 1.112, Test accuracy: 59.16
Round  17, Global train loss: 1.302, Global test loss: 1.673, Global test accuracy: 42.90
Round  18, Train loss: 1.204, Test loss: 1.091, Test accuracy: 59.57
Round  18, Global train loss: 1.204, Global test loss: 1.680, Global test accuracy: 39.20
Round  19, Train loss: 1.334, Test loss: 1.086, Test accuracy: 60.14
Round  19, Global train loss: 1.334, Global test loss: 1.683, Global test accuracy: 43.48
Round  20, Train loss: 1.130, Test loss: 1.085, Test accuracy: 60.01
Round  20, Global train loss: 1.130, Global test loss: 1.675, Global test accuracy: 41.62
Round  21, Train loss: 1.160, Test loss: 1.078, Test accuracy: 60.49
Round  21, Global train loss: 1.160, Global test loss: 1.545, Global test accuracy: 44.86
Round  22, Train loss: 1.118, Test loss: 1.079, Test accuracy: 60.25
Round  22, Global train loss: 1.118, Global test loss: 1.523, Global test accuracy: 47.53
Round  23, Train loss: 1.065, Test loss: 1.072, Test accuracy: 60.59
Round  23, Global train loss: 1.065, Global test loss: 1.587, Global test accuracy: 45.06
Round  24, Train loss: 1.173, Test loss: 1.069, Test accuracy: 60.81
Round  24, Global train loss: 1.173, Global test loss: 1.560, Global test accuracy: 47.74
Round  25, Train loss: 1.197, Test loss: 1.059, Test accuracy: 61.36
Round  25, Global train loss: 1.197, Global test loss: 1.582, Global test accuracy: 48.20
Round  26, Train loss: 1.142, Test loss: 1.059, Test accuracy: 60.85
Round  26, Global train loss: 1.142, Global test loss: 1.442, Global test accuracy: 50.40
Round  27, Train loss: 1.243, Test loss: 1.059, Test accuracy: 60.85
Round  27, Global train loss: 1.243, Global test loss: 1.526, Global test accuracy: 48.70
Round  28, Train loss: 1.235, Test loss: 1.049, Test accuracy: 61.59
Round  28, Global train loss: 1.235, Global test loss: 1.449, Global test accuracy: 52.49
Round  29, Train loss: 1.135, Test loss: 1.030, Test accuracy: 62.08
Round  29, Global train loss: 1.135, Global test loss: 1.461, Global test accuracy: 49.92
Round  30, Train loss: 1.305, Test loss: 1.042, Test accuracy: 61.80
Round  30, Global train loss: 1.305, Global test loss: 1.607, Global test accuracy: 46.53
Round  31, Train loss: 1.145, Test loss: 1.048, Test accuracy: 61.86
Round  31, Global train loss: 1.145, Global test loss: 1.552, Global test accuracy: 47.37
Round  32, Train loss: 1.102, Test loss: 1.050, Test accuracy: 62.05
Round  32, Global train loss: 1.102, Global test loss: 1.544, Global test accuracy: 48.57
Round  33, Train loss: 1.081, Test loss: 1.053, Test accuracy: 61.32
Round  33, Global train loss: 1.081, Global test loss: 1.468, Global test accuracy: 50.35
Round  34, Train loss: 1.062, Test loss: 1.043, Test accuracy: 62.33
Round  34, Global train loss: 1.062, Global test loss: 1.458, Global test accuracy: 51.72
Round  35, Train loss: 0.997, Test loss: 1.054, Test accuracy: 61.71
Round  35, Global train loss: 0.997, Global test loss: 1.453, Global test accuracy: 51.02
Round  36, Train loss: 1.088, Test loss: 1.049, Test accuracy: 62.14
Round  36, Global train loss: 1.088, Global test loss: 1.899, Global test accuracy: 39.10
Round  37, Train loss: 1.213, Test loss: 1.049, Test accuracy: 61.93
Round  37, Global train loss: 1.213, Global test loss: 1.534, Global test accuracy: 47.52
Round  38, Train loss: 1.180, Test loss: 1.037, Test accuracy: 62.45
Round  38, Global train loss: 1.180, Global test loss: 1.532, Global test accuracy: 47.94
Round  39, Train loss: 1.047, Test loss: 1.026, Test accuracy: 63.01
Round  39, Global train loss: 1.047, Global test loss: 1.468, Global test accuracy: 49.68
Round  40, Train loss: 0.945, Test loss: 1.043, Test accuracy: 62.48
Round  40, Global train loss: 0.945, Global test loss: 1.467, Global test accuracy: 49.06
Round  41, Train loss: 1.044, Test loss: 1.048, Test accuracy: 61.77
Round  41, Global train loss: 1.044, Global test loss: 1.480, Global test accuracy: 51.04
Round  42, Train loss: 0.969, Test loss: 1.034, Test accuracy: 62.19
Round  42, Global train loss: 0.969, Global test loss: 1.419, Global test accuracy: 50.63
Round  43, Train loss: 1.097, Test loss: 1.040, Test accuracy: 61.69
Round  43, Global train loss: 1.097, Global test loss: 1.643, Global test accuracy: 45.62
Round  44, Train loss: 0.918, Test loss: 1.037, Test accuracy: 62.66
Round  44, Global train loss: 0.918, Global test loss: 1.466, Global test accuracy: 49.35
Round  45, Train loss: 0.870, Test loss: 1.042, Test accuracy: 62.83
Round  45, Global train loss: 0.870, Global test loss: 1.419, Global test accuracy: 53.44
Round  46, Train loss: 1.033, Test loss: 1.040, Test accuracy: 62.91
Round  46, Global train loss: 1.033, Global test loss: 1.464, Global test accuracy: 52.09
Round  47, Train loss: 1.117, Test loss: 1.045, Test accuracy: 62.46
Round  47, Global train loss: 1.117, Global test loss: 1.467, Global test accuracy: 52.29
Round  48, Train loss: 1.019, Test loss: 1.035, Test accuracy: 62.90
Round  48, Global train loss: 1.019, Global test loss: 1.434, Global test accuracy: 51.96
Round  49, Train loss: 1.098, Test loss: 1.045, Test accuracy: 62.76
Round  49, Global train loss: 1.098, Global test loss: 1.445, Global test accuracy: 52.03
Round  50, Train loss: 1.029, Test loss: 1.050, Test accuracy: 62.66
Round  50, Global train loss: 1.029, Global test loss: 1.564, Global test accuracy: 49.27
Round  51, Train loss: 0.976, Test loss: 1.053, Test accuracy: 62.48
Round  51, Global train loss: 0.976, Global test loss: 1.486, Global test accuracy: 50.40
Round  52, Train loss: 0.866, Test loss: 1.070, Test accuracy: 61.99
Round  52, Global train loss: 0.866, Global test loss: 1.419, Global test accuracy: 50.54
Round  53, Train loss: 0.830, Test loss: 1.071, Test accuracy: 61.84
Round  53, Global train loss: 0.830, Global test loss: 1.455, Global test accuracy: 51.63
Round  54, Train loss: 1.019, Test loss: 1.086, Test accuracy: 61.36
Round  54, Global train loss: 1.019, Global test loss: 1.651, Global test accuracy: 47.73
Round  55, Train loss: 0.842, Test loss: 1.082, Test accuracy: 61.64
Round  55, Global train loss: 0.842, Global test loss: 1.882, Global test accuracy: 42.72
Round  56, Train loss: 1.008, Test loss: 1.078, Test accuracy: 61.41
Round  56, Global train loss: 1.008, Global test loss: 1.428, Global test accuracy: 53.97
Round  57, Train loss: 0.775, Test loss: 1.116, Test accuracy: 60.34
Round  57, Global train loss: 0.775, Global test loss: 1.422, Global test accuracy: 52.28
Round  58, Train loss: 0.979, Test loss: 1.099, Test accuracy: 60.73
Round  58, Global train loss: 0.979, Global test loss: 1.481, Global test accuracy: 50.22
Round  59, Train loss: 0.967, Test loss: 1.094, Test accuracy: 61.03
Round  59, Global train loss: 0.967, Global test loss: 1.431, Global test accuracy: 52.96
Round  60, Train loss: 0.962, Test loss: 1.092, Test accuracy: 60.92
Round  60, Global train loss: 0.962, Global test loss: 1.518, Global test accuracy: 51.12
Round  61, Train loss: 0.896, Test loss: 1.087, Test accuracy: 61.53
Round  61, Global train loss: 0.896, Global test loss: 1.522, Global test accuracy: 49.74
Round  62, Train loss: 0.867, Test loss: 1.104, Test accuracy: 61.74
Round  62, Global train loss: 0.867, Global test loss: 1.682, Global test accuracy: 48.23
Round  63, Train loss: 0.875, Test loss: 1.111, Test accuracy: 61.45
Round  63, Global train loss: 0.875, Global test loss: 1.532, Global test accuracy: 49.01
Round  64, Train loss: 0.877, Test loss: 1.126, Test accuracy: 60.55
Round  64, Global train loss: 0.877, Global test loss: 1.644, Global test accuracy: 46.18
Round  65, Train loss: 0.904, Test loss: 1.125, Test accuracy: 60.97
Round  65, Global train loss: 0.904, Global test loss: 1.530, Global test accuracy: 49.36
Round  66, Train loss: 0.924, Test loss: 1.112, Test accuracy: 61.96
Round  66, Global train loss: 0.924, Global test loss: 1.437, Global test accuracy: 52.77
Round  67, Train loss: 0.881, Test loss: 1.128, Test accuracy: 61.47
Round  67, Global train loss: 0.881, Global test loss: 1.523, Global test accuracy: 50.90
Round  68, Train loss: 0.724, Test loss: 1.147, Test accuracy: 60.55
Round  68, Global train loss: 0.724, Global test loss: 1.694, Global test accuracy: 47.62
Round  69, Train loss: 0.828, Test loss: 1.147, Test accuracy: 61.02
Round  69, Global train loss: 0.828, Global test loss: 1.526, Global test accuracy: 50.49
Round  70, Train loss: 0.793, Test loss: 1.147, Test accuracy: 61.38
Round  70, Global train loss: 0.793, Global test loss: 1.715, Global test accuracy: 45.78
Round  71, Train loss: 0.615, Test loss: 1.138, Test accuracy: 61.78
Round  71, Global train loss: 0.615, Global test loss: 1.583, Global test accuracy: 53.13
Round  72, Train loss: 0.879, Test loss: 1.135, Test accuracy: 61.92
Round  72, Global train loss: 0.879, Global test loss: 1.559, Global test accuracy: 50.49
Round  73, Train loss: 0.835, Test loss: 1.132, Test accuracy: 61.83
Round  73, Global train loss: 0.835, Global test loss: 1.482, Global test accuracy: 51.57
Round  74, Train loss: 0.741, Test loss: 1.153, Test accuracy: 61.26
Round  74, Global train loss: 0.741, Global test loss: 1.468, Global test accuracy: 52.33
Round  75, Train loss: 0.739, Test loss: 1.157, Test accuracy: 61.48
Round  75, Global train loss: 0.739, Global test loss: 1.713, Global test accuracy: 48.24
Round  76, Train loss: 0.898, Test loss: 1.161, Test accuracy: 61.03
Round  76, Global train loss: 0.898, Global test loss: 1.681, Global test accuracy: 48.21
Round  77, Train loss: 0.906, Test loss: 1.177, Test accuracy: 60.78
Round  77, Global train loss: 0.906, Global test loss: 1.504, Global test accuracy: 51.35
Round  78, Train loss: 0.805, Test loss: 1.178, Test accuracy: 60.98
Round  78, Global train loss: 0.805, Global test loss: 1.673, Global test accuracy: 47.40
Round  79, Train loss: 0.773, Test loss: 1.209, Test accuracy: 60.12
Round  79, Global train loss: 0.773, Global test loss: 1.651, Global test accuracy: 48.78
Round  80, Train loss: 0.718, Test loss: 1.213, Test accuracy: 60.30
Round  80, Global train loss: 0.718, Global test loss: 1.586, Global test accuracy: 49.72
Round  81, Train loss: 0.890, Test loss: 1.216, Test accuracy: 60.54
Round  81, Global train loss: 0.890, Global test loss: 1.784, Global test accuracy: 45.58
Round  82, Train loss: 0.853, Test loss: 1.221, Test accuracy: 60.20
Round  82, Global train loss: 0.853, Global test loss: 1.595, Global test accuracy: 49.87
Round  83, Train loss: 0.691, Test loss: 1.229, Test accuracy: 59.73
Round  83, Global train loss: 0.691, Global test loss: 1.627, Global test accuracy: 50.29
Round  84, Train loss: 0.698, Test loss: 1.229, Test accuracy: 59.72
Round  84, Global train loss: 0.698, Global test loss: 1.484, Global test accuracy: 53.50
Round  85, Train loss: 0.764, Test loss: 1.233, Test accuracy: 59.94
Round  85, Global train loss: 0.764, Global test loss: 1.501, Global test accuracy: 52.43
Round  86, Train loss: 0.696, Test loss: 1.249, Test accuracy: 59.72
Round  86, Global train loss: 0.696, Global test loss: 1.633, Global test accuracy: 50.90
Round  87, Train loss: 0.679, Test loss: 1.253, Test accuracy: 59.42
Round  87, Global train loss: 0.679, Global test loss: 1.681, Global test accuracy: 50.41
Round  88, Train loss: 0.676, Test loss: 1.240, Test accuracy: 59.97
Round  88, Global train loss: 0.676, Global test loss: 1.664, Global test accuracy: 49.27
Round  89, Train loss: 0.788, Test loss: 1.234, Test accuracy: 60.38
Round  89, Global train loss: 0.788, Global test loss: 1.662, Global test accuracy: 49.74
Round  90, Train loss: 0.610, Test loss: 1.250, Test accuracy: 59.91
Round  90, Global train loss: 0.610, Global test loss: 1.753, Global test accuracy: 49.32
Round  91, Train loss: 0.678, Test loss: 1.242, Test accuracy: 59.95
Round  91, Global train loss: 0.678, Global test loss: 1.698, Global test accuracy: 49.86
Round  92, Train loss: 0.623, Test loss: 1.239, Test accuracy: 60.37
Round  92, Global train loss: 0.623, Global test loss: 1.573, Global test accuracy: 51.28
Round  93, Train loss: 0.803, Test loss: 1.251, Test accuracy: 60.24
Round  93, Global train loss: 0.803, Global test loss: 1.610, Global test accuracy: 49.88
Round  94, Train loss: 0.604, Test loss: 1.295, Test accuracy: 59.84
Round  94, Global train loss: 0.604, Global test loss: 1.600, Global test accuracy: 52.00
Round  95, Train loss: 0.754, Test loss: 1.322, Test accuracy: 59.32
Round  95, Global train loss: 0.754, Global test loss: 1.646, Global test accuracy: 49.67
Round  96, Train loss: 0.563, Test loss: 1.294, Test accuracy: 59.28
Round  96, Global train loss: 0.563, Global test loss: 1.553, Global test accuracy: 52.36
Round  97, Train loss: 0.622, Test loss: 1.286, Test accuracy: 59.99
Round  97, Global train loss: 0.622, Global test loss: 1.740, Global test accuracy: 49.98
Round  98, Train loss: 0.768, Test loss: 1.311, Test accuracy: 59.85
Round  98, Global train loss: 0.768, Global test loss: 1.602, Global test accuracy: 49.48
Round  99, Train loss: 0.734, Test loss: 1.307, Test accuracy: 60.00
Round  99, Global train loss: 0.734, Global test loss: 1.830, Global test accuracy: 46.22
Final Round, Train loss: 0.532, Test loss: 1.503, Test accuracy: 58.54
Final Round, Global train loss: 0.532, Global test loss: 1.830, Global test accuracy: 46.22
Average accuracy final 10 rounds: 59.875 

Average global accuracy final 10 rounds: 50.004999999999995 

1815.0372338294983
[1.9397478103637695, 3.879495620727539, 5.379202127456665, 6.878908634185791, 8.34740161895752, 9.815894603729248, 11.349359273910522, 12.882823944091797, 14.42421007156372, 15.965596199035645, 17.607884883880615, 19.250173568725586, 20.768309116363525, 22.286444664001465, 23.807727098464966, 25.329009532928467, 26.92501711845398, 28.521024703979492, 30.1760151386261, 31.831005573272705, 33.29418158531189, 34.757357597351074, 36.30697274208069, 37.8565878868103, 39.31350755691528, 40.770427227020264, 42.24387216567993, 43.7173171043396, 45.17263674736023, 46.62795639038086, 48.193230628967285, 49.75850486755371, 51.22688961029053, 52.695274353027344, 54.15300178527832, 55.6107292175293, 57.157376527786255, 58.70402383804321, 60.37286019325256, 62.041696548461914, 63.551798582077026, 65.06190061569214, 66.56512522697449, 68.06834983825684, 69.59670400619507, 71.1250581741333, 72.73050022125244, 74.33594226837158, 75.8972532749176, 77.45856428146362, 78.98864841461182, 80.51873254776001, 82.15131974220276, 83.78390693664551, 85.39668083190918, 87.00945472717285, 88.46958041191101, 89.92970609664917, 91.39654183387756, 92.86337757110596, 94.25490808486938, 95.64643859863281, 97.17229056358337, 98.69814252853394, 100.18789386749268, 101.67764520645142, 103.14485597610474, 104.61206674575806, 106.21999502182007, 107.82792329788208, 109.36268067359924, 110.8974380493164, 112.44236135482788, 113.98728466033936, 115.51668000221252, 117.0460753440857, 118.46524810791016, 119.88442087173462, 121.5510790348053, 123.21773719787598, 124.67634391784668, 126.13495063781738, 127.64505076408386, 129.15515089035034, 130.80236053466797, 132.4495701789856, 134.00949120521545, 135.5694122314453, 137.15165328979492, 138.73389434814453, 140.24221682548523, 141.75053930282593, 143.23279118537903, 144.71504306793213, 146.35791563987732, 148.0007882118225, 149.43743324279785, 150.8740782737732, 152.49261689186096, 154.11115550994873, 155.6605179309845, 157.20988035202026, 158.85261297225952, 160.49534559249878, 162.14060354232788, 163.78586149215698, 165.25842905044556, 166.73099660873413, 168.18645310401917, 169.6419095993042, 171.1397886276245, 172.63766765594482, 174.0763816833496, 175.5150957107544, 177.10880970954895, 178.7025237083435, 180.1779682636261, 181.6534128189087, 183.14473485946655, 184.6360569000244, 186.07946753501892, 187.52287817001343, 188.99347567558289, 190.46407318115234, 191.91264009475708, 193.36120700836182, 194.94940757751465, 196.53760814666748, 198.03854203224182, 199.53947591781616, 200.98030400276184, 202.42113208770752, 203.84393668174744, 205.26674127578735, 206.79444670677185, 208.32215213775635, 209.93436884880066, 211.54658555984497, 213.13463425636292, 214.72268295288086, 216.1877989768982, 217.65291500091553, 219.28494572639465, 220.91697645187378, 222.56235313415527, 224.20772981643677, 225.71150422096252, 227.21527862548828, 228.85241770744324, 230.4895567893982, 231.95501255989075, 233.4204683303833, 234.9126319885254, 236.40479564666748, 238.1367712020874, 239.86874675750732, 241.40505504608154, 242.94136333465576, 244.3711564540863, 245.80094957351685, 247.3280110359192, 248.85507249832153, 250.39212346076965, 251.92917442321777, 253.5839228630066, 255.2386713027954, 256.7988758087158, 258.35908031463623, 259.83953070640564, 261.31998109817505, 262.7320566177368, 264.1441321372986, 265.6720368862152, 267.19994163513184, 268.7684886455536, 270.33703565597534, 271.85936999320984, 273.38170433044434, 274.9852759838104, 276.5888476371765, 278.0581283569336, 279.5274090766907, 281.01432824134827, 282.50124740600586, 283.9832384586334, 285.465229511261, 287.0126881599426, 288.56014680862427, 290.0221471786499, 291.48414754867554, 292.9644365310669, 294.44472551345825, 295.92984533309937, 297.4149651527405, 298.9130845069885, 300.4112038612366, 302.0680694580078, 303.72493505477905, 305.16639018058777, 306.6078453063965, 309.6933174133301, 312.7787895202637]
[21.87, 21.87, 30.1, 30.1, 34.84, 34.84, 39.21, 39.21, 44.28, 44.28, 45.52, 45.52, 49.78, 49.78, 52.26, 52.26, 53.11, 53.11, 53.98, 53.98, 55.25, 55.25, 55.88, 55.88, 56.02, 56.02, 57.15, 57.15, 57.48, 57.48, 57.97, 57.97, 58.81, 58.81, 59.16, 59.16, 59.57, 59.57, 60.14, 60.14, 60.01, 60.01, 60.49, 60.49, 60.25, 60.25, 60.59, 60.59, 60.81, 60.81, 61.36, 61.36, 60.85, 60.85, 60.85, 60.85, 61.59, 61.59, 62.08, 62.08, 61.8, 61.8, 61.86, 61.86, 62.05, 62.05, 61.32, 61.32, 62.33, 62.33, 61.71, 61.71, 62.14, 62.14, 61.93, 61.93, 62.45, 62.45, 63.01, 63.01, 62.48, 62.48, 61.77, 61.77, 62.19, 62.19, 61.69, 61.69, 62.66, 62.66, 62.83, 62.83, 62.91, 62.91, 62.46, 62.46, 62.9, 62.9, 62.76, 62.76, 62.66, 62.66, 62.48, 62.48, 61.99, 61.99, 61.84, 61.84, 61.36, 61.36, 61.64, 61.64, 61.41, 61.41, 60.34, 60.34, 60.73, 60.73, 61.03, 61.03, 60.92, 60.92, 61.53, 61.53, 61.74, 61.74, 61.45, 61.45, 60.55, 60.55, 60.97, 60.97, 61.96, 61.96, 61.47, 61.47, 60.55, 60.55, 61.02, 61.02, 61.38, 61.38, 61.78, 61.78, 61.92, 61.92, 61.83, 61.83, 61.26, 61.26, 61.48, 61.48, 61.03, 61.03, 60.78, 60.78, 60.98, 60.98, 60.12, 60.12, 60.3, 60.3, 60.54, 60.54, 60.2, 60.2, 59.73, 59.73, 59.72, 59.72, 59.94, 59.94, 59.72, 59.72, 59.42, 59.42, 59.97, 59.97, 60.38, 60.38, 59.91, 59.91, 59.95, 59.95, 60.37, 60.37, 60.24, 60.24, 59.84, 59.84, 59.32, 59.32, 59.28, 59.28, 59.99, 59.99, 59.85, 59.85, 60.0, 60.0, 58.54, 58.54]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.770, Test loss: 2.080, Test accuracy: 22.27
Round   0, Global train loss: 1.770, Global test loss: 2.265, Global test accuracy: 19.44
Round   1, Train loss: 1.619, Test loss: 1.952, Test accuracy: 27.34
Round   1, Global train loss: 1.619, Global test loss: 2.273, Global test accuracy: 22.88
Round   2, Train loss: 1.641, Test loss: 1.718, Test accuracy: 31.50
Round   2, Global train loss: 1.641, Global test loss: 2.097, Global test accuracy: 24.32
Round   3, Train loss: 1.518, Test loss: 1.643, Test accuracy: 33.21
Round   3, Global train loss: 1.518, Global test loss: 2.180, Global test accuracy: 22.76
Round   4, Train loss: 1.481, Test loss: 1.524, Test accuracy: 37.57
Round   4, Global train loss: 1.481, Global test loss: 1.946, Global test accuracy: 28.78
Round   5, Train loss: 1.391, Test loss: 1.467, Test accuracy: 39.73
Round   5, Global train loss: 1.391, Global test loss: 1.973, Global test accuracy: 26.72
Round   6, Train loss: 1.528, Test loss: 1.353, Test accuracy: 45.43
Round   6, Global train loss: 1.528, Global test loss: 1.877, Global test accuracy: 33.03
Round   7, Train loss: 1.407, Test loss: 1.275, Test accuracy: 48.78
Round   7, Global train loss: 1.407, Global test loss: 1.807, Global test accuracy: 35.79
Round   8, Train loss: 1.333, Test loss: 1.253, Test accuracy: 50.36
Round   8, Global train loss: 1.333, Global test loss: 1.912, Global test accuracy: 30.22
Round   9, Train loss: 1.412, Test loss: 1.242, Test accuracy: 51.04
Round   9, Global train loss: 1.412, Global test loss: 1.841, Global test accuracy: 37.49
Round  10, Train loss: 1.403, Test loss: 1.193, Test accuracy: 53.46
Round  10, Global train loss: 1.403, Global test loss: 1.772, Global test accuracy: 39.66
Round  11, Train loss: 1.293, Test loss: 1.185, Test accuracy: 54.56
Round  11, Global train loss: 1.293, Global test loss: 1.849, Global test accuracy: 35.86
Round  12, Train loss: 1.465, Test loss: 1.179, Test accuracy: 54.74
Round  12, Global train loss: 1.465, Global test loss: 2.036, Global test accuracy: 35.56
Round  13, Train loss: 1.343, Test loss: 1.186, Test accuracy: 53.54
Round  13, Global train loss: 1.343, Global test loss: 1.864, Global test accuracy: 33.98
Round  14, Train loss: 1.165, Test loss: 1.181, Test accuracy: 54.33
Round  14, Global train loss: 1.165, Global test loss: 1.814, Global test accuracy: 39.55
Round  15, Train loss: 1.416, Test loss: 1.170, Test accuracy: 55.17
Round  15, Global train loss: 1.416, Global test loss: 1.747, Global test accuracy: 43.64
Round  16, Train loss: 1.418, Test loss: 1.154, Test accuracy: 56.23
Round  16, Global train loss: 1.418, Global test loss: 1.752, Global test accuracy: 40.33
Round  17, Train loss: 1.361, Test loss: 1.152, Test accuracy: 55.93
Round  17, Global train loss: 1.361, Global test loss: 1.715, Global test accuracy: 39.84
Round  18, Train loss: 1.326, Test loss: 1.137, Test accuracy: 56.64
Round  18, Global train loss: 1.326, Global test loss: 1.720, Global test accuracy: 38.13
Round  19, Train loss: 1.384, Test loss: 1.140, Test accuracy: 57.23
Round  19, Global train loss: 1.384, Global test loss: 1.717, Global test accuracy: 42.12
Round  20, Train loss: 1.071, Test loss: 1.135, Test accuracy: 57.30
Round  20, Global train loss: 1.071, Global test loss: 1.618, Global test accuracy: 43.65
Round  21, Train loss: 1.114, Test loss: 1.133, Test accuracy: 57.74
Round  21, Global train loss: 1.114, Global test loss: 1.539, Global test accuracy: 44.97
Round  22, Train loss: 1.326, Test loss: 1.128, Test accuracy: 58.65
Round  22, Global train loss: 1.326, Global test loss: 1.647, Global test accuracy: 44.13
Round  23, Train loss: 1.347, Test loss: 1.109, Test accuracy: 58.80
Round  23, Global train loss: 1.347, Global test loss: 1.657, Global test accuracy: 44.07
Round  24, Train loss: 1.279, Test loss: 1.097, Test accuracy: 59.53
Round  24, Global train loss: 1.279, Global test loss: 1.649, Global test accuracy: 43.93
Round  25, Train loss: 1.295, Test loss: 1.086, Test accuracy: 59.74
Round  25, Global train loss: 1.295, Global test loss: 1.636, Global test accuracy: 48.38
Round  26, Train loss: 1.085, Test loss: 1.099, Test accuracy: 58.86
Round  26, Global train loss: 1.085, Global test loss: 1.498, Global test accuracy: 46.75
Round  27, Train loss: 1.383, Test loss: 1.084, Test accuracy: 59.12
Round  27, Global train loss: 1.383, Global test loss: 1.601, Global test accuracy: 46.64
Round  28, Train loss: 1.116, Test loss: 1.060, Test accuracy: 60.69
Round  28, Global train loss: 1.116, Global test loss: 1.441, Global test accuracy: 51.43
Round  29, Train loss: 1.125, Test loss: 1.051, Test accuracy: 61.18
Round  29, Global train loss: 1.125, Global test loss: 1.514, Global test accuracy: 48.16
Round  30, Train loss: 1.319, Test loss: 1.062, Test accuracy: 61.05
Round  30, Global train loss: 1.319, Global test loss: 1.632, Global test accuracy: 43.24
Round  31, Train loss: 1.218, Test loss: 1.046, Test accuracy: 61.47
Round  31, Global train loss: 1.218, Global test loss: 1.585, Global test accuracy: 45.49
Round  32, Train loss: 1.309, Test loss: 1.059, Test accuracy: 60.48
Round  32, Global train loss: 1.309, Global test loss: 1.588, Global test accuracy: 48.17
Round  33, Train loss: 1.148, Test loss: 1.071, Test accuracy: 60.41
Round  33, Global train loss: 1.148, Global test loss: 1.471, Global test accuracy: 48.94
Round  34, Train loss: 1.159, Test loss: 1.069, Test accuracy: 60.33
Round  34, Global train loss: 1.159, Global test loss: 1.489, Global test accuracy: 50.14
Round  35, Train loss: 1.082, Test loss: 1.047, Test accuracy: 61.54
Round  35, Global train loss: 1.082, Global test loss: 1.454, Global test accuracy: 51.56
Round  36, Train loss: 1.380, Test loss: 1.044, Test accuracy: 61.45
Round  36, Global train loss: 1.380, Global test loss: 1.810, Global test accuracy: 40.86
Round  37, Train loss: 1.106, Test loss: 1.047, Test accuracy: 61.71
Round  37, Global train loss: 1.106, Global test loss: 1.479, Global test accuracy: 48.39
Round  38, Train loss: 1.200, Test loss: 1.049, Test accuracy: 61.99
Round  38, Global train loss: 1.200, Global test loss: 1.574, Global test accuracy: 44.07
Round  39, Train loss: 1.007, Test loss: 1.045, Test accuracy: 61.94
Round  39, Global train loss: 1.007, Global test loss: 1.473, Global test accuracy: 48.31
Round  40, Train loss: 1.156, Test loss: 1.070, Test accuracy: 60.79
Round  40, Global train loss: 1.156, Global test loss: 1.469, Global test accuracy: 50.00
Round  41, Train loss: 1.145, Test loss: 1.047, Test accuracy: 62.17
Round  41, Global train loss: 1.145, Global test loss: 1.525, Global test accuracy: 50.44
Round  42, Train loss: 0.939, Test loss: 1.027, Test accuracy: 62.72
Round  42, Global train loss: 0.939, Global test loss: 1.431, Global test accuracy: 50.41
Round  43, Train loss: 1.050, Test loss: 1.030, Test accuracy: 62.60
Round  43, Global train loss: 1.050, Global test loss: 1.646, Global test accuracy: 45.18
Round  44, Train loss: 1.095, Test loss: 1.027, Test accuracy: 62.32
Round  44, Global train loss: 1.095, Global test loss: 1.434, Global test accuracy: 50.87
Round  45, Train loss: 1.165, Test loss: 1.043, Test accuracy: 61.70
Round  45, Global train loss: 1.165, Global test loss: 1.542, Global test accuracy: 49.96
Round  46, Train loss: 1.181, Test loss: 1.034, Test accuracy: 61.86
Round  46, Global train loss: 1.181, Global test loss: 1.566, Global test accuracy: 47.63
Round  47, Train loss: 0.993, Test loss: 1.040, Test accuracy: 61.92
Round  47, Global train loss: 0.993, Global test loss: 1.358, Global test accuracy: 54.79
Round  48, Train loss: 1.122, Test loss: 1.023, Test accuracy: 62.35
Round  48, Global train loss: 1.122, Global test loss: 1.492, Global test accuracy: 48.41
Round  49, Train loss: 1.103, Test loss: 1.027, Test accuracy: 62.63
Round  49, Global train loss: 1.103, Global test loss: 1.441, Global test accuracy: 50.26
Round  50, Train loss: 0.988, Test loss: 1.028, Test accuracy: 62.35
Round  50, Global train loss: 0.988, Global test loss: 1.491, Global test accuracy: 49.39
Round  51, Train loss: 1.060, Test loss: 1.051, Test accuracy: 61.54
Round  51, Global train loss: 1.060, Global test loss: 1.479, Global test accuracy: 49.54
Round  52, Train loss: 0.922, Test loss: 1.039, Test accuracy: 62.46
Round  52, Global train loss: 0.922, Global test loss: 1.454, Global test accuracy: 49.39
Round  53, Train loss: 0.952, Test loss: 1.032, Test accuracy: 62.68
Round  53, Global train loss: 0.952, Global test loss: 1.446, Global test accuracy: 50.45
Round  54, Train loss: 1.167, Test loss: 1.032, Test accuracy: 62.52
Round  54, Global train loss: 1.167, Global test loss: 1.559, Global test accuracy: 48.48
Round  55, Train loss: 1.117, Test loss: 1.042, Test accuracy: 62.17
Round  55, Global train loss: 1.117, Global test loss: 1.765, Global test accuracy: 42.07
Round  56, Train loss: 0.892, Test loss: 1.060, Test accuracy: 61.75
Round  56, Global train loss: 0.892, Global test loss: 1.378, Global test accuracy: 53.33
Round  57, Train loss: 0.932, Test loss: 1.064, Test accuracy: 61.55
Round  57, Global train loss: 0.932, Global test loss: 1.401, Global test accuracy: 52.10
Round  58, Train loss: 0.991, Test loss: 1.075, Test accuracy: 60.98
Round  58, Global train loss: 0.991, Global test loss: 1.460, Global test accuracy: 50.00
Round  59, Train loss: 0.756, Test loss: 1.066, Test accuracy: 61.40
Round  59, Global train loss: 0.756, Global test loss: 1.477, Global test accuracy: 49.40
Round  60, Train loss: 0.896, Test loss: 1.057, Test accuracy: 61.36
Round  60, Global train loss: 0.896, Global test loss: 1.343, Global test accuracy: 54.81
Round  61, Train loss: 0.957, Test loss: 1.065, Test accuracy: 61.19
Round  61, Global train loss: 0.957, Global test loss: 1.400, Global test accuracy: 52.33
Round  62, Train loss: 0.972, Test loss: 1.068, Test accuracy: 60.96
Round  62, Global train loss: 0.972, Global test loss: 1.468, Global test accuracy: 51.95
Round  63, Train loss: 1.036, Test loss: 1.079, Test accuracy: 60.55
Round  63, Global train loss: 1.036, Global test loss: 1.521, Global test accuracy: 48.63
Round  64, Train loss: 0.747, Test loss: 1.098, Test accuracy: 60.44
Round  64, Global train loss: 0.747, Global test loss: 1.485, Global test accuracy: 49.89
Round  65, Train loss: 0.922, Test loss: 1.059, Test accuracy: 61.51
Round  65, Global train loss: 0.922, Global test loss: 1.432, Global test accuracy: 49.91
Round  66, Train loss: 0.825, Test loss: 1.051, Test accuracy: 62.14
Round  66, Global train loss: 0.825, Global test loss: 1.313, Global test accuracy: 55.27
Round  67, Train loss: 1.049, Test loss: 1.063, Test accuracy: 61.67
Round  67, Global train loss: 1.049, Global test loss: 1.436, Global test accuracy: 52.23
Round  68, Train loss: 0.801, Test loss: 1.078, Test accuracy: 61.80
Round  68, Global train loss: 0.801, Global test loss: 1.550, Global test accuracy: 49.13
Round  69, Train loss: 0.953, Test loss: 1.077, Test accuracy: 61.49
Round  69, Global train loss: 0.953, Global test loss: 1.409, Global test accuracy: 51.93
Round  70, Train loss: 0.804, Test loss: 1.074, Test accuracy: 61.46
Round  70, Global train loss: 0.804, Global test loss: 1.646, Global test accuracy: 47.73
Round  71, Train loss: 0.941, Test loss: 1.077, Test accuracy: 61.55
Round  71, Global train loss: 0.941, Global test loss: 1.430, Global test accuracy: 53.13
Round  72, Train loss: 1.080, Test loss: 1.078, Test accuracy: 61.97
Round  72, Global train loss: 1.080, Global test loss: 1.582, Global test accuracy: 48.07
Round  73, Train loss: 0.756, Test loss: 1.080, Test accuracy: 61.87
Round  73, Global train loss: 0.756, Global test loss: 1.459, Global test accuracy: 51.61
Round  74, Train loss: 0.802, Test loss: 1.096, Test accuracy: 61.54
Round  74, Global train loss: 0.802, Global test loss: 1.367, Global test accuracy: 53.95
Round  75, Train loss: 0.851, Test loss: 1.113, Test accuracy: 61.22
Round  75, Global train loss: 0.851, Global test loss: 1.675, Global test accuracy: 48.94
Round  76, Train loss: 1.003, Test loss: 1.111, Test accuracy: 61.29
Round  76, Global train loss: 1.003, Global test loss: 1.602, Global test accuracy: 48.87
Round  77, Train loss: 0.855, Test loss: 1.107, Test accuracy: 61.18
Round  77, Global train loss: 0.855, Global test loss: 1.443, Global test accuracy: 51.76
Round  78, Train loss: 0.723, Test loss: 1.106, Test accuracy: 61.51
Round  78, Global train loss: 0.723, Global test loss: 1.472, Global test accuracy: 51.60
Round  79, Train loss: 0.653, Test loss: 1.119, Test accuracy: 61.16
Round  79, Global train loss: 0.653, Global test loss: 1.405, Global test accuracy: 53.87
Round  80, Train loss: 0.774, Test loss: 1.123, Test accuracy: 61.28
Round  80, Global train loss: 0.774, Global test loss: 1.507, Global test accuracy: 52.20
Round  81, Train loss: 0.786, Test loss: 1.158, Test accuracy: 60.52
Round  81, Global train loss: 0.786, Global test loss: 1.746, Global test accuracy: 45.32
Round  82, Train loss: 0.773, Test loss: 1.152, Test accuracy: 60.66
Round  82, Global train loss: 0.773, Global test loss: 1.391, Global test accuracy: 54.77
Round  83, Train loss: 1.016, Test loss: 1.158, Test accuracy: 60.40
Round  83, Global train loss: 1.016, Global test loss: 1.544, Global test accuracy: 49.78
Round  84, Train loss: 0.712, Test loss: 1.128, Test accuracy: 61.09
Round  84, Global train loss: 0.712, Global test loss: 1.462, Global test accuracy: 52.30
Round  85, Train loss: 0.903, Test loss: 1.120, Test accuracy: 61.25
Round  85, Global train loss: 0.903, Global test loss: 1.451, Global test accuracy: 53.09
Round  86, Train loss: 0.789, Test loss: 1.134, Test accuracy: 60.77
Round  86, Global train loss: 0.789, Global test loss: 1.574, Global test accuracy: 50.49
Round  87, Train loss: 0.844, Test loss: 1.114, Test accuracy: 61.25
Round  87, Global train loss: 0.844, Global test loss: 1.447, Global test accuracy: 53.50
Round  88, Train loss: 0.729, Test loss: 1.136, Test accuracy: 60.74
Round  88, Global train loss: 0.729, Global test loss: 1.632, Global test accuracy: 47.86
Round  89, Train loss: 0.802, Test loss: 1.159, Test accuracy: 60.34
Round  89, Global train loss: 0.802, Global test loss: 1.542, Global test accuracy: 50.80
Round  90, Train loss: 0.751, Test loss: 1.155, Test accuracy: 60.48
Round  90, Global train loss: 0.751, Global test loss: 1.718, Global test accuracy: 48.37
Round  91, Train loss: 0.726, Test loss: 1.152, Test accuracy: 61.19
Round  91, Global train loss: 0.726, Global test loss: 1.571, Global test accuracy: 51.45
Round  92, Train loss: 0.590, Test loss: 1.174, Test accuracy: 60.93
Round  92, Global train loss: 0.590, Global test loss: 1.569, Global test accuracy: 51.68/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  93, Train loss: 0.663, Test loss: 1.162, Test accuracy: 60.73
Round  93, Global train loss: 0.663, Global test loss: 1.442, Global test accuracy: 52.73
Round  94, Train loss: 0.546, Test loss: 1.178, Test accuracy: 60.83
Round  94, Global train loss: 0.546, Global test loss: 1.446, Global test accuracy: 54.48
Round  95, Train loss: 0.800, Test loss: 1.166, Test accuracy: 60.90
Round  95, Global train loss: 0.800, Global test loss: 1.404, Global test accuracy: 53.83
Round  96, Train loss: 0.590, Test loss: 1.172, Test accuracy: 60.90
Round  96, Global train loss: 0.590, Global test loss: 1.366, Global test accuracy: 55.61
Round  97, Train loss: 0.591, Test loss: 1.186, Test accuracy: 60.52
Round  97, Global train loss: 0.591, Global test loss: 1.626, Global test accuracy: 51.05
Round  98, Train loss: 0.796, Test loss: 1.184, Test accuracy: 60.37
Round  98, Global train loss: 0.796, Global test loss: 1.415, Global test accuracy: 53.51
Round  99, Train loss: 0.876, Test loss: 1.202, Test accuracy: 60.31
Round  99, Global train loss: 0.876, Global test loss: 1.676, Global test accuracy: 46.64
Final Round, Train loss: 0.630, Test loss: 1.279, Test accuracy: 60.04
Final Round, Global train loss: 0.630, Global test loss: 1.676, Global test accuracy: 46.64
Average accuracy final 10 rounds: 60.716 

Average global accuracy final 10 rounds: 51.934999999999995 

1863.9972672462463
[2.061211347579956, 4.122422695159912, 5.82777738571167, 7.533132076263428, 9.115087509155273, 10.69704294204712, 12.251226663589478, 13.805410385131836, 15.599591732025146, 17.393773078918457, 19.012881994247437, 20.631990909576416, 22.195743560791016, 23.759496212005615, 25.71966242790222, 27.679828643798828, 29.29172921180725, 30.903629779815674, 32.718350648880005, 34.533071517944336, 36.042274713516235, 37.551477909088135, 39.1165714263916, 40.68166494369507, 42.316564083099365, 43.95146322250366, 45.57254505157471, 47.19362688064575, 48.942737102508545, 50.69184732437134, 52.417378187179565, 54.14290904998779, 55.669135093688965, 57.19536113739014, 58.758716106414795, 60.32207107543945, 62.13902425765991, 63.95597743988037, 65.61115431785583, 67.2663311958313, 68.83936858177185, 70.4124059677124, 71.95496416091919, 73.49752235412598, 75.09574913978577, 76.69397592544556, 78.2821409702301, 79.87030601501465, 81.50993633270264, 83.14956665039062, 84.74981474876404, 86.35006284713745, 87.98846769332886, 89.62687253952026, 91.20456194877625, 92.78225135803223, 94.28589081764221, 95.7895302772522, 97.56229066848755, 99.3350510597229, 100.90950775146484, 102.48396444320679, 104.06680393218994, 105.6496434211731, 107.15737986564636, 108.66511631011963, 110.38910460472107, 112.11309289932251, 113.71087169647217, 115.30865049362183, 116.92021322250366, 118.5317759513855, 120.23701000213623, 121.94224405288696, 123.67586755752563, 125.4094910621643, 126.89203119277954, 128.37457132339478, 129.96160244941711, 131.54863357543945, 133.13443279266357, 134.7202320098877, 136.30693364143372, 137.89363527297974, 139.62171840667725, 141.34980154037476, 142.92926692962646, 144.50873231887817, 146.14765048027039, 147.7865686416626, 149.545348405838, 151.30412817001343, 152.87148237228394, 154.43883657455444, 156.0545220375061, 157.67020750045776, 159.1985502243042, 160.72689294815063, 162.2911274433136, 163.85536193847656, 165.61749029159546, 167.37961864471436, 169.00097513198853, 170.6223316192627, 172.20054054260254, 173.77874946594238, 175.41250228881836, 177.04625511169434, 178.61359858512878, 180.18094205856323, 181.72911429405212, 183.27728652954102, 184.96835827827454, 186.65943002700806, 188.31406211853027, 189.9686942100525, 191.74275398254395, 193.5168137550354, 195.13888597488403, 196.76095819473267, 198.3472113609314, 199.93346452713013, 201.50967955589294, 203.08589458465576, 204.64081025123596, 206.19572591781616, 208.47895646095276, 210.76218700408936, 212.39200377464294, 214.02182054519653, 215.5457742214203, 217.06972789764404, 218.61915159225464, 220.16857528686523, 221.8120720386505, 223.4555687904358, 225.05809783935547, 226.66062688827515, 228.25842261314392, 229.8562183380127, 231.46280193328857, 233.06938552856445, 234.6372480392456, 236.20511054992676, 237.7035813331604, 239.20205211639404, 240.80776715278625, 242.41348218917847, 244.1038098335266, 245.79413747787476, 247.36344361305237, 248.93274974822998, 250.57899594306946, 252.22524213790894, 253.84069633483887, 255.4561505317688, 257.1228280067444, 258.78950548171997, 260.42937755584717, 262.06924962997437, 263.6633925437927, 265.2575354576111, 266.83719301223755, 268.416850566864, 270.0779597759247, 271.73906898498535, 273.68623542785645, 275.63340187072754, 277.1909441947937, 278.74848651885986, 280.25901675224304, 281.7695469856262, 283.44934821128845, 285.1291494369507, 286.80015683174133, 288.471164226532, 290.23942708969116, 292.00768995285034, 293.6075601577759, 295.2074303627014, 296.7804000377655, 298.3533697128296, 300.00149726867676, 301.6496248245239, 303.2478356361389, 304.8460464477539, 306.55232310295105, 308.2585997581482, 309.8055839538574, 311.35256814956665, 312.89866161346436, 314.44475507736206, 316.033488035202, 317.622220993042, 319.3858902454376, 321.14955949783325, 322.77287888526917, 324.3961982727051, 325.9852714538574, 327.57434463500977, 330.771452665329, 333.9685606956482]
[22.27, 22.27, 27.34, 27.34, 31.5, 31.5, 33.21, 33.21, 37.57, 37.57, 39.73, 39.73, 45.43, 45.43, 48.78, 48.78, 50.36, 50.36, 51.04, 51.04, 53.46, 53.46, 54.56, 54.56, 54.74, 54.74, 53.54, 53.54, 54.33, 54.33, 55.17, 55.17, 56.23, 56.23, 55.93, 55.93, 56.64, 56.64, 57.23, 57.23, 57.3, 57.3, 57.74, 57.74, 58.65, 58.65, 58.8, 58.8, 59.53, 59.53, 59.74, 59.74, 58.86, 58.86, 59.12, 59.12, 60.69, 60.69, 61.18, 61.18, 61.05, 61.05, 61.47, 61.47, 60.48, 60.48, 60.41, 60.41, 60.33, 60.33, 61.54, 61.54, 61.45, 61.45, 61.71, 61.71, 61.99, 61.99, 61.94, 61.94, 60.79, 60.79, 62.17, 62.17, 62.72, 62.72, 62.6, 62.6, 62.32, 62.32, 61.7, 61.7, 61.86, 61.86, 61.92, 61.92, 62.35, 62.35, 62.63, 62.63, 62.35, 62.35, 61.54, 61.54, 62.46, 62.46, 62.68, 62.68, 62.52, 62.52, 62.17, 62.17, 61.75, 61.75, 61.55, 61.55, 60.98, 60.98, 61.4, 61.4, 61.36, 61.36, 61.19, 61.19, 60.96, 60.96, 60.55, 60.55, 60.44, 60.44, 61.51, 61.51, 62.14, 62.14, 61.67, 61.67, 61.8, 61.8, 61.49, 61.49, 61.46, 61.46, 61.55, 61.55, 61.97, 61.97, 61.87, 61.87, 61.54, 61.54, 61.22, 61.22, 61.29, 61.29, 61.18, 61.18, 61.51, 61.51, 61.16, 61.16, 61.28, 61.28, 60.52, 60.52, 60.66, 60.66, 60.4, 60.4, 61.09, 61.09, 61.25, 61.25, 60.77, 60.77, 61.25, 61.25, 60.74, 60.74, 60.34, 60.34, 60.48, 60.48, 61.19, 61.19, 60.93, 60.93, 60.73, 60.73, 60.83, 60.83, 60.9, 60.9, 60.9, 60.9, 60.52, 60.52, 60.37, 60.37, 60.31, 60.31, 60.04, 60.04]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.649, Test loss: 2.161, Test accuracy: 17.45
Round   0, Global train loss: 1.649, Global test loss: 2.352, Global test accuracy: 13.20
Round   1, Train loss: 1.475, Test loss: 1.938, Test accuracy: 27.08
Round   1, Global train loss: 1.475, Global test loss: 2.255, Global test accuracy: 21.68
Round   2, Train loss: 1.576, Test loss: 1.690, Test accuracy: 32.72
Round   2, Global train loss: 1.576, Global test loss: 2.089, Global test accuracy: 21.33
Round   3, Train loss: 1.436, Test loss: 1.618, Test accuracy: 37.14
Round   3, Global train loss: 1.436, Global test loss: 2.126, Global test accuracy: 25.54
Round   4, Train loss: 1.372, Test loss: 1.493, Test accuracy: 41.18
Round   4, Global train loss: 1.372, Global test loss: 1.976, Global test accuracy: 28.08
Round   5, Train loss: 1.238, Test loss: 1.452, Test accuracy: 43.17
Round   5, Global train loss: 1.238, Global test loss: 2.018, Global test accuracy: 28.06
Round   6, Train loss: 1.303, Test loss: 1.347, Test accuracy: 46.87
Round   6, Global train loss: 1.303, Global test loss: 1.860, Global test accuracy: 34.25
Round   7, Train loss: 1.383, Test loss: 1.292, Test accuracy: 48.93
Round   7, Global train loss: 1.383, Global test loss: 1.835, Global test accuracy: 34.92
Round   8, Train loss: 1.159, Test loss: 1.255, Test accuracy: 50.21
Round   8, Global train loss: 1.159, Global test loss: 1.849, Global test accuracy: 34.89
Round   9, Train loss: 1.267, Test loss: 1.236, Test accuracy: 51.64
Round   9, Global train loss: 1.267, Global test loss: 1.895, Global test accuracy: 36.41
Round  10, Train loss: 1.288, Test loss: 1.211, Test accuracy: 53.05
Round  10, Global train loss: 1.288, Global test loss: 1.807, Global test accuracy: 40.01
Round  11, Train loss: 1.321, Test loss: 1.209, Test accuracy: 53.46
Round  11, Global train loss: 1.321, Global test loss: 1.865, Global test accuracy: 37.65
Round  12, Train loss: 1.252, Test loss: 1.214, Test accuracy: 53.36
Round  12, Global train loss: 1.252, Global test loss: 2.135, Global test accuracy: 35.22
Round  13, Train loss: 1.183, Test loss: 1.202, Test accuracy: 53.69
Round  13, Global train loss: 1.183, Global test loss: 2.001, Global test accuracy: 32.19
Round  14, Train loss: 1.106, Test loss: 1.211, Test accuracy: 53.72
Round  14, Global train loss: 1.106, Global test loss: 1.875, Global test accuracy: 38.98
Round  15, Train loss: 1.057, Test loss: 1.200, Test accuracy: 53.90
Round  15, Global train loss: 1.057, Global test loss: 1.716, Global test accuracy: 44.33
Round  16, Train loss: 1.248, Test loss: 1.175, Test accuracy: 55.74
Round  16, Global train loss: 1.248, Global test loss: 1.743, Global test accuracy: 40.64
Round  17, Train loss: 1.072, Test loss: 1.158, Test accuracy: 56.17
Round  17, Global train loss: 1.072, Global test loss: 1.761, Global test accuracy: 40.58
Round  18, Train loss: 1.174, Test loss: 1.162, Test accuracy: 56.18
Round  18, Global train loss: 1.174, Global test loss: 1.771, Global test accuracy: 38.85
Round  19, Train loss: 1.199, Test loss: 1.167, Test accuracy: 56.05
Round  19, Global train loss: 1.199, Global test loss: 1.826, Global test accuracy: 39.02
Round  20, Train loss: 1.051, Test loss: 1.160, Test accuracy: 55.58
Round  20, Global train loss: 1.051, Global test loss: 1.628, Global test accuracy: 43.36
Round  21, Train loss: 1.149, Test loss: 1.152, Test accuracy: 56.08
Round  21, Global train loss: 1.149, Global test loss: 1.592, Global test accuracy: 44.56
Round  22, Train loss: 1.160, Test loss: 1.141, Test accuracy: 56.82
Round  22, Global train loss: 1.160, Global test loss: 1.752, Global test accuracy: 42.49
Round  23, Train loss: 1.137, Test loss: 1.140, Test accuracy: 56.94
Round  23, Global train loss: 1.137, Global test loss: 1.688, Global test accuracy: 44.49
Round  24, Train loss: 1.157, Test loss: 1.134, Test accuracy: 57.63
Round  24, Global train loss: 1.157, Global test loss: 1.602, Global test accuracy: 46.47
Round  25, Train loss: 1.182, Test loss: 1.125, Test accuracy: 58.80
Round  25, Global train loss: 1.182, Global test loss: 1.610, Global test accuracy: 48.11
Round  26, Train loss: 1.090, Test loss: 1.136, Test accuracy: 57.67
Round  26, Global train loss: 1.090, Global test loss: 1.489, Global test accuracy: 48.49
Round  27, Train loss: 1.188, Test loss: 1.123, Test accuracy: 58.64
Round  27, Global train loss: 1.188, Global test loss: 1.610, Global test accuracy: 45.96
Round  28, Train loss: 0.967, Test loss: 1.111, Test accuracy: 59.10
Round  28, Global train loss: 0.967, Global test loss: 1.429, Global test accuracy: 51.10
Round  29, Train loss: 0.934, Test loss: 1.099, Test accuracy: 59.60
Round  29, Global train loss: 0.934, Global test loss: 1.503, Global test accuracy: 49.01
Round  30, Train loss: 1.141, Test loss: 1.092, Test accuracy: 59.86
Round  30, Global train loss: 1.141, Global test loss: 1.568, Global test accuracy: 45.82
Round  31, Train loss: 1.208, Test loss: 1.098, Test accuracy: 59.67
Round  31, Global train loss: 1.208, Global test loss: 1.675, Global test accuracy: 44.80
Round  32, Train loss: 1.146, Test loss: 1.104, Test accuracy: 59.86
Round  32, Global train loss: 1.146, Global test loss: 1.637, Global test accuracy: 46.81
Round  33, Train loss: 1.088, Test loss: 1.094, Test accuracy: 60.14
Round  33, Global train loss: 1.088, Global test loss: 1.560, Global test accuracy: 47.57
Round  34, Train loss: 0.886, Test loss: 1.109, Test accuracy: 59.98
Round  34, Global train loss: 0.886, Global test loss: 1.487, Global test accuracy: 50.36
Round  35, Train loss: 1.028, Test loss: 1.102, Test accuracy: 60.00
Round  35, Global train loss: 1.028, Global test loss: 1.458, Global test accuracy: 51.05
Round  36, Train loss: 0.945, Test loss: 1.101, Test accuracy: 60.34
Round  36, Global train loss: 0.945, Global test loss: 1.848, Global test accuracy: 43.61
Round  37, Train loss: 1.039, Test loss: 1.101, Test accuracy: 60.21
Round  37, Global train loss: 1.039, Global test loss: 1.517, Global test accuracy: 48.54
Round  38, Train loss: 1.121, Test loss: 1.116, Test accuracy: 60.33
Round  38, Global train loss: 1.121, Global test loss: 1.573, Global test accuracy: 47.33
Round  39, Train loss: 1.065, Test loss: 1.118, Test accuracy: 59.96
Round  39, Global train loss: 1.065, Global test loss: 1.461, Global test accuracy: 50.94
Round  40, Train loss: 1.121, Test loss: 1.108, Test accuracy: 60.26
Round  40, Global train loss: 1.121, Global test loss: 1.561, Global test accuracy: 49.06
Round  41, Train loss: 1.091, Test loss: 1.089, Test accuracy: 61.11
Round  41, Global train loss: 1.091, Global test loss: 1.568, Global test accuracy: 50.34
Round  42, Train loss: 0.957, Test loss: 1.082, Test accuracy: 60.88
Round  42, Global train loss: 0.957, Global test loss: 1.533, Global test accuracy: 48.66
Round  43, Train loss: 0.988, Test loss: 1.102, Test accuracy: 60.51
Round  43, Global train loss: 0.988, Global test loss: 1.736, Global test accuracy: 46.70
Round  44, Train loss: 0.862, Test loss: 1.092, Test accuracy: 60.85
Round  44, Global train loss: 0.862, Global test loss: 1.426, Global test accuracy: 51.71
Round  45, Train loss: 0.881, Test loss: 1.080, Test accuracy: 61.97
Round  45, Global train loss: 0.881, Global test loss: 1.459, Global test accuracy: 53.49
Round  46, Train loss: 0.776, Test loss: 1.067, Test accuracy: 62.53
Round  46, Global train loss: 0.776, Global test loss: 1.484, Global test accuracy: 52.05
Round  47, Train loss: 0.857, Test loss: 1.086, Test accuracy: 62.26
Round  47, Global train loss: 0.857, Global test loss: 1.365, Global test accuracy: 54.49
Round  48, Train loss: 0.991, Test loss: 1.102, Test accuracy: 61.78
Round  48, Global train loss: 0.991, Global test loss: 1.535, Global test accuracy: 48.97
Round  49, Train loss: 1.035, Test loss: 1.119, Test accuracy: 61.56
Round  49, Global train loss: 1.035, Global test loss: 1.467, Global test accuracy: 51.88
Round  50, Train loss: 0.909, Test loss: 1.100, Test accuracy: 61.78
Round  50, Global train loss: 0.909, Global test loss: 1.495, Global test accuracy: 49.54
Round  51, Train loss: 0.802, Test loss: 1.090, Test accuracy: 61.96
Round  51, Global train loss: 0.802, Global test loss: 1.467, Global test accuracy: 51.49
Round  52, Train loss: 0.986, Test loss: 1.107, Test accuracy: 61.54
Round  52, Global train loss: 0.986, Global test loss: 1.508, Global test accuracy: 49.89
Round  53, Train loss: 0.860, Test loss: 1.093, Test accuracy: 61.74
Round  53, Global train loss: 0.860, Global test loss: 1.407, Global test accuracy: 53.71
Round  54, Train loss: 0.929, Test loss: 1.105, Test accuracy: 61.45
Round  54, Global train loss: 0.929, Global test loss: 1.602, Global test accuracy: 48.52
Round  55, Train loss: 0.799, Test loss: 1.090, Test accuracy: 61.82
Round  55, Global train loss: 0.799, Global test loss: 1.777, Global test accuracy: 44.89
Round  56, Train loss: 0.823, Test loss: 1.133, Test accuracy: 60.98
Round  56, Global train loss: 0.823, Global test loss: 1.355, Global test accuracy: 54.05
Round  57, Train loss: 0.859, Test loss: 1.161, Test accuracy: 60.67
Round  57, Global train loss: 0.859, Global test loss: 1.602, Global test accuracy: 48.76
Round  58, Train loss: 1.030, Test loss: 1.146, Test accuracy: 60.90
Round  58, Global train loss: 1.030, Global test loss: 1.499, Global test accuracy: 50.87
Round  59, Train loss: 0.909, Test loss: 1.171, Test accuracy: 60.28
Round  59, Global train loss: 0.909, Global test loss: 1.491, Global test accuracy: 50.91
Round  60, Train loss: 0.793, Test loss: 1.168, Test accuracy: 60.65
Round  60, Global train loss: 0.793, Global test loss: 1.508, Global test accuracy: 50.86
Round  61, Train loss: 0.890, Test loss: 1.146, Test accuracy: 60.52
Round  61, Global train loss: 0.890, Global test loss: 1.548, Global test accuracy: 49.99
Round  62, Train loss: 0.759, Test loss: 1.163, Test accuracy: 60.19
Round  62, Global train loss: 0.759, Global test loss: 1.564, Global test accuracy: 51.84
Round  63, Train loss: 0.956, Test loss: 1.160, Test accuracy: 60.69
Round  63, Global train loss: 0.956, Global test loss: 1.618, Global test accuracy: 47.47
Round  64, Train loss: 0.747, Test loss: 1.165, Test accuracy: 60.89
Round  64, Global train loss: 0.747, Global test loss: 1.630, Global test accuracy: 48.20
Round  65, Train loss: 0.988, Test loss: 1.168, Test accuracy: 60.87
Round  65, Global train loss: 0.988, Global test loss: 1.600, Global test accuracy: 49.03
Round  66, Train loss: 0.638, Test loss: 1.176, Test accuracy: 60.38
Round  66, Global train loss: 0.638, Global test loss: 1.413, Global test accuracy: 55.20
Round  67, Train loss: 0.849, Test loss: 1.229, Test accuracy: 59.58
Round  67, Global train loss: 0.849, Global test loss: 1.499, Global test accuracy: 52.97
Round  68, Train loss: 0.734, Test loss: 1.242, Test accuracy: 59.85
Round  68, Global train loss: 0.734, Global test loss: 1.725, Global test accuracy: 47.16
Round  69, Train loss: 0.703, Test loss: 1.225, Test accuracy: 59.68
Round  69, Global train loss: 0.703, Global test loss: 1.548, Global test accuracy: 50.92
Round  70, Train loss: 0.775, Test loss: 1.249, Test accuracy: 59.26
Round  70, Global train loss: 0.775, Global test loss: 1.685, Global test accuracy: 47.93
Round  71, Train loss: 0.700, Test loss: 1.236, Test accuracy: 59.48
Round  71, Global train loss: 0.700, Global test loss: 1.528, Global test accuracy: 52.52
Round  72, Train loss: 0.793, Test loss: 1.251, Test accuracy: 59.09
Round  72, Global train loss: 0.793, Global test loss: 1.565, Global test accuracy: 51.13
Round  73, Train loss: 0.796, Test loss: 1.229, Test accuracy: 59.83
Round  73, Global train loss: 0.796, Global test loss: 1.479, Global test accuracy: 52.44
Round  74, Train loss: 0.799, Test loss: 1.235, Test accuracy: 59.89
Round  74, Global train loss: 0.799, Global test loss: 1.560, Global test accuracy: 51.56
Round  75, Train loss: 0.823, Test loss: 1.237, Test accuracy: 60.00
Round  75, Global train loss: 0.823, Global test loss: 1.824, Global test accuracy: 45.94
Round  76, Train loss: 0.761, Test loss: 1.243, Test accuracy: 60.05
Round  76, Global train loss: 0.761, Global test loss: 1.692, Global test accuracy: 49.73
Round  77, Train loss: 0.642, Test loss: 1.241, Test accuracy: 60.13
Round  77, Global train loss: 0.642, Global test loss: 1.460, Global test accuracy: 54.01
Round  78, Train loss: 0.671, Test loss: 1.232, Test accuracy: 60.20
Round  78, Global train loss: 0.671, Global test loss: 1.583, Global test accuracy: 51.23
Round  79, Train loss: 0.556, Test loss: 1.237, Test accuracy: 59.86
Round  79, Global train loss: 0.556, Global test loss: 1.479, Global test accuracy: 53.25
Round  80, Train loss: 0.789, Test loss: 1.187, Test accuracy: 61.02
Round  80, Global train loss: 0.789, Global test loss: 1.520, Global test accuracy: 51.46
Round  81, Train loss: 0.768, Test loss: 1.235, Test accuracy: 60.74
Round  81, Global train loss: 0.768, Global test loss: 1.723, Global test accuracy: 47.59
Round  82, Train loss: 0.703, Test loss: 1.238, Test accuracy: 60.92
Round  82, Global train loss: 0.703, Global test loss: 1.472, Global test accuracy: 53.75
Round  83, Train loss: 0.773, Test loss: 1.250, Test accuracy: 60.25
Round  83, Global train loss: 0.773, Global test loss: 1.586, Global test accuracy: 52.19
Round  84, Train loss: 0.682, Test loss: 1.241, Test accuracy: 60.11
Round  84, Global train loss: 0.682, Global test loss: 1.600, Global test accuracy: 50.97
Round  85, Train loss: 0.744, Test loss: 1.235, Test accuracy: 60.08
Round  85, Global train loss: 0.744, Global test loss: 1.441, Global test accuracy: 54.45
Round  86, Train loss: 0.653, Test loss: 1.221, Test accuracy: 60.71
Round  86, Global train loss: 0.653, Global test loss: 1.568, Global test accuracy: 52.91
Round  87, Train loss: 0.744, Test loss: 1.235, Test accuracy: 60.54
Round  87, Global train loss: 0.744, Global test loss: 1.528, Global test accuracy: 53.29
Round  88, Train loss: 0.841, Test loss: 1.220, Test accuracy: 60.81
Round  88, Global train loss: 0.841, Global test loss: 1.773, Global test accuracy: 45.24
Round  89, Train loss: 0.772, Test loss: 1.215, Test accuracy: 60.97
Round  89, Global train loss: 0.772, Global test loss: 1.678, Global test accuracy: 49.09
Round  90, Train loss: 0.699, Test loss: 1.253, Test accuracy: 59.80
Round  90, Global train loss: 0.699, Global test loss: 1.747, Global test accuracy: 47.70
Round  91, Train loss: 0.580, Test loss: 1.312, Test accuracy: 59.46
Round  91, Global train loss: 0.580, Global test loss: 1.746, Global test accuracy: 51.01
Round  92, Train loss: 0.620, Test loss: 1.290, Test accuracy: 59.78
Round  92, Global train loss: 0.620, Global test loss: 1.555, Global test accuracy: 52.80
Round  93, Train loss: 0.571, Test loss: 1.271, Test accuracy: 59.74
Round  93, Global train loss: 0.571, Global test loss: 1.468, Global test accuracy: 54.54
Round  94, Train loss: 0.604, Test loss: 1.271, Test accuracy: 60.40
Round  94, Global train loss: 0.604, Global test loss: 1.536, Global test accuracy: 52.70
Round  95, Train loss: 0.631, Test loss: 1.252, Test accuracy: 61.09
Round  95, Global train loss: 0.631, Global test loss: 1.455, Global test accuracy: 54.35
Round  96, Train loss: 0.577, Test loss: 1.268, Test accuracy: 60.56
Round  96, Global train loss: 0.577, Global test loss: 1.463, Global test accuracy: 53.79
Round  97, Train loss: 0.618, Test loss: 1.284, Test accuracy: 60.52
Round  97, Global train loss: 0.618, Global test loss: 1.646, Global test accuracy: 51.47
Round  98, Train loss: 0.686, Test loss: 1.259, Test accuracy: 60.52
Round  98, Global train loss: 0.686, Global test loss: 1.481, Global test accuracy: 53.50
Round  99, Train loss: 0.644, Test loss: 1.295, Test accuracy: 59.99
Round  99, Global train loss: 0.644, Global test loss: 1.770, Global test accuracy: 50.52
Final Round, Train loss: 0.528, Test loss: 1.453, Test accuracy: 59.89
Final Round, Global train loss: 0.528, Global test loss: 1.770, Global test accuracy: 50.52
Average accuracy final 10 rounds: 60.18599999999999
Average global accuracy final 10 rounds: 52.238
2699.2837867736816
[3.6327764987945557, 7.047969579696655, 10.4613196849823, 14.01555609703064, 17.674147129058838, 21.319888830184937, 24.798069953918457, 28.22993803024292, 31.66755437850952, 35.1929395198822, 38.6896436214447, 42.09680438041687, 45.630712270736694, 48.9399299621582, 52.38117742538452, 55.80419397354126, 59.242473125457764, 62.77402591705322, 66.32304692268372, 69.71981024742126, 73.21555304527283, 76.5684015750885, 80.13272666931152, 83.72766947746277, 87.15596461296082, 90.7562050819397, 94.2928957939148, 97.6320276260376, 100.99849820137024, 104.49052286148071, 108.01350212097168, 111.30702066421509, 114.83896040916443, 118.31171131134033, 121.90404629707336, 125.39986729621887, 129.30044746398926, 132.87748432159424, 136.31571221351624, 139.67309713363647, 142.83829975128174, 146.2464349269867, 149.59916758537292, 152.84181904792786, 156.2214744091034, 159.61476731300354, 163.15874099731445, 166.5053267478943, 169.9308693408966, 173.41399478912354, 176.93458771705627, 180.8130762577057, 184.29960179328918, 187.71329307556152, 191.08930158615112, 194.43430542945862, 197.79957175254822, 201.1373188495636, 204.56092476844788, 208.09212946891785, 211.45703029632568, 214.90796065330505, 218.20809864997864, 221.72041654586792, 224.96201395988464, 228.39028358459473, 231.67875957489014, 234.98588609695435, 238.3474898338318, 241.72750329971313, 244.9311499595642, 248.3003487586975, 251.80414128303528, 255.0910680294037, 258.6188018321991, 262.1676309108734, 265.52798557281494, 268.8407201766968, 272.27035307884216, 275.83833861351013, 279.29110455513, 282.7658293247223, 286.1079032421112, 289.482709646225, 292.76708817481995, 296.11587834358215, 299.505558013916, 302.9448733329773, 306.23548650741577, 309.64198112487793, 313.125657081604, 316.5484790802002, 320.0911238193512, 323.54692363739014, 326.9137382507324, 330.20220971107483, 333.54907608032227, 336.8198924064636, 340.27257442474365, 343.67405819892883, 349.9816744327545]
[17.45, 27.08, 32.72, 37.14, 41.18, 43.17, 46.87, 48.93, 50.21, 51.64, 53.05, 53.46, 53.36, 53.69, 53.72, 53.9, 55.74, 56.17, 56.18, 56.05, 55.58, 56.08, 56.82, 56.94, 57.63, 58.8, 57.67, 58.64, 59.1, 59.6, 59.86, 59.67, 59.86, 60.14, 59.98, 60.0, 60.34, 60.21, 60.33, 59.96, 60.26, 61.11, 60.88, 60.51, 60.85, 61.97, 62.53, 62.26, 61.78, 61.56, 61.78, 61.96, 61.54, 61.74, 61.45, 61.82, 60.98, 60.67, 60.9, 60.28, 60.65, 60.52, 60.19, 60.69, 60.89, 60.87, 60.38, 59.58, 59.85, 59.68, 59.26, 59.48, 59.09, 59.83, 59.89, 60.0, 60.05, 60.13, 60.2, 59.86, 61.02, 60.74, 60.92, 60.25, 60.11, 60.08, 60.71, 60.54, 60.81, 60.97, 59.8, 59.46, 59.78, 59.74, 60.4, 61.09, 60.56, 60.52, 60.52, 59.99, 59.89]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  17.0300
Round 1 global test acc  18.2100
Round 2 global test acc  16.8400
Round 3 global test acc  22.5200
Round 4 global test acc  17.3200
Round 5 global test acc  18.6100
Round 6 global test acc  23.3900
Round 7 global test acc  22.7200
Round 8 global test acc  22.5100
Round 9 global test acc  23.1300
Round 10 global test acc  28.8200
Round 11 global test acc  24.8200
Round 12 global test acc  27.6200
Round 13 global test acc  29.6600
Round 14 global test acc  29.7700
Round 15 global test acc  27.8400
Round 16 global test acc  29.4200
Round 17 global test acc  33.6200
Round 18 global test acc  22.4100
Round 19 global test acc  29.3900
Round 20 global test acc  34.8700
Round 21 global test acc  36.5500
Round 22 global test acc  30.7400
Round 23 global test acc  29.7900
Round 24 global test acc  29.2700
Round 25 global test acc  31.6500
Round 26 global test acc  30.0600
Round 27 global test acc  33.0300
Round 28 global test acc  32.3100
Round 29 global test acc  33.7300
Round 30 global test acc  36.9600
Round 31 global test acc  30.7900
Round 32 global test acc  37.4900
Round 33 global test acc  34.4700
Round 34 global test acc  31.2200
Round 35 global test acc  30.6700
Round 36 global test acc  34.4600
Round 37 global test acc  31.1100
Round 38 global test acc  36.4300
Round 39 global test acc  31.7200
Round 40 global test acc  28.7600
Round 41 global test acc  33.4800
Round 42 global test acc  34.1100
Round 43 global test acc  32.0300
Round 44 global test acc  30.6100
Round 45 global test acc  34.6000
Round 46 global test acc  37.1600
Round 47 global test acc  30.5200
Round 48 global test acc  30.0100
Round 49 global test acc  33.6100
Round 50 global test acc  32.1000
Round 51 global test acc  28.2600
Round 52 global test acc  34.6400
Round 53 global test acc  38.8300
Round 54 global test acc  30.1000
Round 55 global test acc  32.7400
Round 56 global test acc  36.2500
Round 57 global test acc  34.3000
Round 58 global test acc  35.5300
Round 59 global test acc  32.7200
Round 60 global test acc  34.1500
Round 61 global test acc  38.4300
Round 62 global test acc  34.6400
Round 63 global test acc  37.3800
Round 64 global test acc  35.8900
Round 65 global test acc  39.5600
Round 66 global test acc  30.6100
Round 67 global test acc  42.0100
Round 68 global test acc  39.9100
Round 69 global test acc  35.0100
Round 70 global test acc  36.2200
Round 71 global test acc  39.7700
Round 72 global test acc  37.6000
Round 73 global test acc  36.8600
Round 74 global test acc  35.9500
Round 75 global test acc  36.0600
Round 76 global test acc  39.8500
Round 77 global test acc  34.6300
Round 78 global test acc  36.2400
Round 79 global test acc  35.5700
Round 80 global test acc  31.8300
Round 81 global test acc  30.5700
Round 82 global test acc  29.0100
Round 83 global test acc  27.5500
Round 84 global test acc  26.2000
Round 85 global test acc  26.2300
Round 86 global test acc  25.0300
Round 87 global test acc  23.3000
Round 88 global test acc  23.3200
Round 89 global test acc  22.4600
Round 90 global test acc  22.3700
Round 91 global test acc  22.3000
Round 92 global test acc  22.1700
Round 93 global test acc  21.9700
Round 94 global test acc  21.4900
Round 95 global test acc  21.2800
Round 96 global test acc  21.3700
Round 97 global test acc  21.2700
Round 98 global test acc  21.1800
Round 99 global test acc  21.0900
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.977, Test loss: 2.191, Test accuracy: 16.91
Round   1, Train loss: 1.632, Test loss: 2.097, Test accuracy: 25.92
Round   2, Train loss: 1.609, Test loss: 1.781, Test accuracy: 28.34
Round   3, Train loss: 1.508, Test loss: 1.684, Test accuracy: 36.24
Round   4, Train loss: 1.384, Test loss: 1.444, Test accuracy: 43.24
Round   5, Train loss: 1.365, Test loss: 1.384, Test accuracy: 45.84
Round   6, Train loss: 1.385, Test loss: 1.252, Test accuracy: 51.12
Round   7, Train loss: 1.377, Test loss: 1.223, Test accuracy: 51.15
Round   8, Train loss: 1.285, Test loss: 1.187, Test accuracy: 53.73
Round   9, Train loss: 1.367, Test loss: 1.189, Test accuracy: 54.25
Round  10, Train loss: 1.420, Test loss: 1.161, Test accuracy: 56.05
Round  11, Train loss: 1.335, Test loss: 1.152, Test accuracy: 56.13
Round  12, Train loss: 1.347, Test loss: 1.148, Test accuracy: 56.78
Round  13, Train loss: 1.214, Test loss: 1.149, Test accuracy: 57.65
Round  14, Train loss: 1.208, Test loss: 1.129, Test accuracy: 57.81
Round  15, Train loss: 1.201, Test loss: 1.120, Test accuracy: 58.41
Round  16, Train loss: 1.267, Test loss: 1.100, Test accuracy: 58.33
Round  17, Train loss: 1.236, Test loss: 1.087, Test accuracy: 59.37
Round  18, Train loss: 1.078, Test loss: 1.085, Test accuracy: 59.98
Round  19, Train loss: 1.216, Test loss: 1.096, Test accuracy: 59.83
Round  20, Train loss: 1.115, Test loss: 1.090, Test accuracy: 61.06
Round  21, Train loss: 1.138, Test loss: 1.058, Test accuracy: 62.01
Round  22, Train loss: 1.244, Test loss: 1.048, Test accuracy: 62.81
Round  23, Train loss: 1.139, Test loss: 1.033, Test accuracy: 62.87
Round  24, Train loss: 1.206, Test loss: 1.050, Test accuracy: 62.09
Round  25, Train loss: 1.368, Test loss: 1.053, Test accuracy: 62.62
Round  26, Train loss: 1.176, Test loss: 1.002, Test accuracy: 64.34
Round  27, Train loss: 1.331, Test loss: 1.025, Test accuracy: 63.98
Round  28, Train loss: 1.139, Test loss: 1.016, Test accuracy: 63.91
Round  29, Train loss: 1.034, Test loss: 1.022, Test accuracy: 63.47
Round  30, Train loss: 1.288, Test loss: 1.019, Test accuracy: 64.65
Round  31, Train loss: 1.158, Test loss: 1.003, Test accuracy: 63.72
Round  32, Train loss: 1.251, Test loss: 0.990, Test accuracy: 64.53
Round  33, Train loss: 1.125, Test loss: 1.010, Test accuracy: 64.09
Round  34, Train loss: 1.094, Test loss: 0.999, Test accuracy: 64.08
Round  35, Train loss: 0.988, Test loss: 0.973, Test accuracy: 64.73
Round  36, Train loss: 1.126, Test loss: 0.973, Test accuracy: 65.47
Round  37, Train loss: 1.080, Test loss: 0.986, Test accuracy: 66.18
Round  38, Train loss: 1.285, Test loss: 0.992, Test accuracy: 65.96
Round  39, Train loss: 1.155, Test loss: 0.983, Test accuracy: 65.99
Round  40, Train loss: 1.138, Test loss: 0.972, Test accuracy: 66.15
Round  41, Train loss: 1.341, Test loss: 0.958, Test accuracy: 66.61
Round  42, Train loss: 1.018, Test loss: 0.955, Test accuracy: 67.28
Round  43, Train loss: 1.171, Test loss: 0.952, Test accuracy: 67.56
Round  44, Train loss: 0.934, Test loss: 0.944, Test accuracy: 67.53
Round  45, Train loss: 1.133, Test loss: 0.927, Test accuracy: 67.74
Round  46, Train loss: 1.042, Test loss: 0.923, Test accuracy: 67.90
Round  47, Train loss: 1.038, Test loss: 0.931, Test accuracy: 67.57
Round  48, Train loss: 1.075, Test loss: 0.924, Test accuracy: 67.79
Round  49, Train loss: 1.229, Test loss: 0.946, Test accuracy: 67.66
Round  50, Train loss: 0.965, Test loss: 0.927, Test accuracy: 68.17
Round  51, Train loss: 0.992, Test loss: 0.918, Test accuracy: 67.74
Round  52, Train loss: 1.120, Test loss: 0.922, Test accuracy: 67.91
Round  53, Train loss: 1.007, Test loss: 0.938, Test accuracy: 68.33
Round  54, Train loss: 1.204, Test loss: 0.951, Test accuracy: 67.65
Round  55, Train loss: 0.998, Test loss: 0.932, Test accuracy: 67.56
Round  56, Train loss: 1.084, Test loss: 0.926, Test accuracy: 67.22
Round  57, Train loss: 0.972, Test loss: 0.927, Test accuracy: 67.17
Round  58, Train loss: 1.203, Test loss: 0.903, Test accuracy: 68.26
Round  59, Train loss: 1.108, Test loss: 0.901, Test accuracy: 69.01
Round  60, Train loss: 0.895, Test loss: 0.900, Test accuracy: 69.34
Round  61, Train loss: 1.049, Test loss: 0.893, Test accuracy: 69.06
Round  62, Train loss: 1.000, Test loss: 0.901, Test accuracy: 69.16
Round  63, Train loss: 1.268, Test loss: 0.908, Test accuracy: 69.10
Round  64, Train loss: 0.948, Test loss: 0.881, Test accuracy: 70.03
Round  65, Train loss: 1.170, Test loss: 0.899, Test accuracy: 68.91
Round  66, Train loss: 0.941, Test loss: 0.878, Test accuracy: 69.42
Round  67, Train loss: 1.065, Test loss: 0.891, Test accuracy: 69.35
Round  68, Train loss: 0.801, Test loss: 0.885, Test accuracy: 69.69
Round  69, Train loss: 0.831, Test loss: 0.872, Test accuracy: 69.64
Round  70, Train loss: 0.908, Test loss: 0.895, Test accuracy: 69.02
Round  71, Train loss: 0.918, Test loss: 0.875, Test accuracy: 69.97
Round  72, Train loss: 1.056, Test loss: 0.879, Test accuracy: 69.39
Round  73, Train loss: 1.024, Test loss: 0.883, Test accuracy: 69.15
Round  74, Train loss: 0.903, Test loss: 0.882, Test accuracy: 69.11
Round  75, Train loss: 1.067, Test loss: 0.888, Test accuracy: 68.80
Round  76, Train loss: 1.026, Test loss: 0.884, Test accuracy: 69.34
Round  77, Train loss: 0.987, Test loss: 0.883, Test accuracy: 69.12
Round  78, Train loss: 0.788, Test loss: 0.895, Test accuracy: 69.25
Round  79, Train loss: 0.865, Test loss: 0.888, Test accuracy: 69.39
Round  80, Train loss: 0.994, Test loss: 0.879, Test accuracy: 69.23
Round  81, Train loss: 1.074, Test loss: 0.885, Test accuracy: 68.87
Round  82, Train loss: 0.805, Test loss: 0.875, Test accuracy: 69.50
Round  83, Train loss: 1.058, Test loss: 0.892, Test accuracy: 69.00
Round  84, Train loss: 0.850, Test loss: 0.871, Test accuracy: 69.84
Round  85, Train loss: 1.078, Test loss: 0.873, Test accuracy: 69.66
Round  86, Train loss: 0.952, Test loss: 0.886, Test accuracy: 69.06
Round  87, Train loss: 1.031, Test loss: 0.896, Test accuracy: 68.56
Round  88, Train loss: 0.978, Test loss: 0.897, Test accuracy: 68.95
Round  89, Train loss: 1.040, Test loss: 0.900, Test accuracy: 68.45
Round  90, Train loss: 0.951, Test loss: 0.884, Test accuracy: 68.76
Round  91, Train loss: 0.920, Test loss: 0.900, Test accuracy: 68.56
Round  92, Train loss: 0.797, Test loss: 0.891, Test accuracy: 69.23
Round  93, Train loss: 0.760, Test loss: 0.863, Test accuracy: 70.23
Round  94, Train loss: 0.624, Test loss: 0.864, Test accuracy: 69.89
Round  95, Train loss: 0.920, Test loss: 0.876, Test accuracy: 68.93
Round  96, Train loss: 0.769, Test loss: 0.868, Test accuracy: 69.32
Round  97, Train loss: 0.903, Test loss: 0.878, Test accuracy: 69.23
Round  98, Train loss: 0.919, Test loss: 0.872, Test accuracy: 69.51
Round  99, Train loss: 0.960, Test loss: 0.883, Test accuracy: 68.86
Final Round, Train loss: 0.821, Test loss: 0.890, Test accuracy: 68.55
Average accuracy final 10 rounds: 69.25200000000001
1328.505882024765
[2.0110831260681152, 3.7334418296813965, 5.483489274978638, 7.337179183959961, 8.97103476524353, 10.569904804229736, 12.375901937484741, 14.226965188980103, 15.945226669311523, 17.653196573257446, 19.2722487449646, 21.12632393836975, 22.90211248397827, 24.568089246749878, 26.184017181396484, 28.273298025131226, 30.029900312423706, 32.04679489135742, 33.82758331298828, 35.62706923484802, 37.422504901885986, 39.06052875518799, 40.71948838233948, 42.361966133117676, 44.015361070632935, 45.68602657318115, 47.60835909843445, 49.257163763046265, 51.164944887161255, 52.89446425437927, 54.63996982574463, 56.45558452606201, 58.213303089141846, 59.906760454177856, 61.70050024986267, 63.41634750366211, 65.0721206665039, 66.90782189369202, 68.7245078086853, 70.4055655002594, 72.0443754196167, 73.81113791465759, 75.60867834091187, 77.34926581382751, 79.21150207519531, 80.96669673919678, 82.64402174949646, 84.46630024909973, 86.17618465423584, 87.81632447242737, 89.5221197605133, 91.27130365371704, 93.08938145637512, 94.96509289741516, 96.87984848022461, 98.68548679351807, 100.41132116317749, 102.11479926109314, 103.8603584766388, 105.59352016448975, 107.34802651405334, 109.08482241630554, 111.16473412513733, 112.93323874473572, 114.71353363990784, 116.60327434539795, 118.39847421646118, 120.07580375671387, 121.94466257095337, 123.77528190612793, 125.56341814994812, 127.14599370956421, 128.80318975448608, 130.56346940994263, 132.42037200927734, 134.14807271957397, 135.90465927124023, 137.8062870502472, 139.58504819869995, 141.36607933044434, 143.09499406814575, 144.8511471748352, 146.6424641609192, 148.43428564071655, 150.23203039169312, 152.07299900054932, 153.7427580356598, 155.47556614875793, 157.31360864639282, 158.912855386734, 160.59749913215637, 162.2696771621704, 163.99416851997375, 165.89441442489624, 167.75126791000366, 169.4712197780609, 171.23665809631348, 173.08349084854126, 174.74052333831787, 176.40533018112183, 179.223534822464]
[16.91, 25.92, 28.34, 36.24, 43.24, 45.84, 51.12, 51.15, 53.73, 54.25, 56.05, 56.13, 56.78, 57.65, 57.81, 58.41, 58.33, 59.37, 59.98, 59.83, 61.06, 62.01, 62.81, 62.87, 62.09, 62.62, 64.34, 63.98, 63.91, 63.47, 64.65, 63.72, 64.53, 64.09, 64.08, 64.73, 65.47, 66.18, 65.96, 65.99, 66.15, 66.61, 67.28, 67.56, 67.53, 67.74, 67.9, 67.57, 67.79, 67.66, 68.17, 67.74, 67.91, 68.33, 67.65, 67.56, 67.22, 67.17, 68.26, 69.01, 69.34, 69.06, 69.16, 69.1, 70.03, 68.91, 69.42, 69.35, 69.69, 69.64, 69.02, 69.97, 69.39, 69.15, 69.11, 68.8, 69.34, 69.12, 69.25, 69.39, 69.23, 68.87, 69.5, 69.0, 69.84, 69.66, 69.06, 68.56, 68.95, 68.45, 68.76, 68.56, 69.23, 70.23, 69.89, 68.93, 69.32, 69.23, 69.51, 68.86, 68.55]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.697, Test loss: 2.070, Test accuracy: 20.85
Round   0, Global train loss: 1.697, Global test loss: 2.269, Global test accuracy: 17.36
Round   1, Train loss: 1.531, Test loss: 1.899, Test accuracy: 29.74
Round   1, Global train loss: 1.531, Global test loss: 2.237, Global test accuracy: 24.62
Round   2, Train loss: 1.576, Test loss: 1.639, Test accuracy: 34.35
Round   2, Global train loss: 1.576, Global test loss: 2.031, Global test accuracy: 25.31
Round   3, Train loss: 1.402, Test loss: 1.589, Test accuracy: 37.67
Round   3, Global train loss: 1.402, Global test loss: 2.177, Global test accuracy: 24.66
Round   4, Train loss: 1.533, Test loss: 1.447, Test accuracy: 42.54
Round   4, Global train loss: 1.533, Global test loss: 1.926, Global test accuracy: 29.28
Round   5, Train loss: 1.460, Test loss: 1.423, Test accuracy: 42.96
Round   5, Global train loss: 1.460, Global test loss: 2.040, Global test accuracy: 26.96
Round   6, Train loss: 1.393, Test loss: 1.290, Test accuracy: 48.78
Round   6, Global train loss: 1.393, Global test loss: 1.828, Global test accuracy: 34.66
Round   7, Train loss: 1.330, Test loss: 1.222, Test accuracy: 51.16
Round   7, Global train loss: 1.330, Global test loss: 1.745, Global test accuracy: 38.03
Round   8, Train loss: 1.393, Test loss: 1.205, Test accuracy: 52.11
Round   8, Global train loss: 1.393, Global test loss: 1.856, Global test accuracy: 34.40
Round   9, Train loss: 1.420, Test loss: 1.193, Test accuracy: 52.54
Round   9, Global train loss: 1.420, Global test loss: 1.855, Global test accuracy: 35.59
Round  10, Train loss: 1.337, Test loss: 1.166, Test accuracy: 53.94
Round  10, Global train loss: 1.337, Global test loss: 1.778, Global test accuracy: 37.58
Round  11, Train loss: 1.228, Test loss: 1.169, Test accuracy: 54.12
Round  11, Global train loss: 1.228, Global test loss: 1.819, Global test accuracy: 38.10
Round  12, Train loss: 1.254, Test loss: 1.155, Test accuracy: 54.70
Round  12, Global train loss: 1.254, Global test loss: 1.944, Global test accuracy: 38.81
Round  13, Train loss: 1.265, Test loss: 1.145, Test accuracy: 55.53
Round  13, Global train loss: 1.265, Global test loss: 1.898, Global test accuracy: 33.30
Round  14, Train loss: 1.354, Test loss: 1.149, Test accuracy: 55.61
Round  14, Global train loss: 1.354, Global test loss: 1.791, Global test accuracy: 39.86
Round  15, Train loss: 1.270, Test loss: 1.134, Test accuracy: 56.27
Round  15, Global train loss: 1.270, Global test loss: 1.692, Global test accuracy: 43.77
Round  16, Train loss: 1.417, Test loss: 1.122, Test accuracy: 57.03
Round  16, Global train loss: 1.417, Global test loss: 1.766, Global test accuracy: 40.40
Round  17, Train loss: 1.322, Test loss: 1.114, Test accuracy: 56.98
Round  17, Global train loss: 1.322, Global test loss: 1.666, Global test accuracy: 42.67
Round  18, Train loss: 1.301, Test loss: 1.115, Test accuracy: 57.11
Round  18, Global train loss: 1.301, Global test loss: 1.708, Global test accuracy: 40.41
Round  19, Train loss: 1.249, Test loss: 1.102, Test accuracy: 57.47
Round  19, Global train loss: 1.249, Global test loss: 1.627, Global test accuracy: 43.80
Round  20, Train loss: 1.335, Test loss: 1.094, Test accuracy: 58.08
Round  20, Global train loss: 1.335, Global test loss: 1.657, Global test accuracy: 44.21
Round  21, Train loss: 1.146, Test loss: 1.087, Test accuracy: 58.93
Round  21, Global train loss: 1.146, Global test loss: 1.508, Global test accuracy: 48.45
Round  22, Train loss: 1.240, Test loss: 1.077, Test accuracy: 60.31
Round  22, Global train loss: 1.240, Global test loss: 1.585, Global test accuracy: 46.38
Round  23, Train loss: 1.083, Test loss: 1.075, Test accuracy: 60.44
Round  23, Global train loss: 1.083, Global test loss: 1.571, Global test accuracy: 44.54
Round  24, Train loss: 1.279, Test loss: 1.080, Test accuracy: 60.36
Round  24, Global train loss: 1.279, Global test loss: 1.582, Global test accuracy: 47.31
Round  25, Train loss: 1.167, Test loss: 1.077, Test accuracy: 60.45
Round  25, Global train loss: 1.167, Global test loss: 1.558, Global test accuracy: 49.05
Round  26, Train loss: 1.220, Test loss: 1.051, Test accuracy: 60.93
Round  26, Global train loss: 1.220, Global test loss: 1.496, Global test accuracy: 50.60
Round  27, Train loss: 1.070, Test loss: 1.049, Test accuracy: 61.50
Round  27, Global train loss: 1.070, Global test loss: 1.450, Global test accuracy: 51.18
Round  28, Train loss: 1.075, Test loss: 1.054, Test accuracy: 61.31
Round  28, Global train loss: 1.075, Global test loss: 1.407, Global test accuracy: 52.85
Round  29, Train loss: 1.142, Test loss: 1.053, Test accuracy: 61.68
Round  29, Global train loss: 1.142, Global test loss: 1.468, Global test accuracy: 50.21
Round  30, Train loss: 1.093, Test loss: 1.046, Test accuracy: 62.07
Round  30, Global train loss: 1.093, Global test loss: 1.549, Global test accuracy: 45.92
Round  31, Train loss: 1.159, Test loss: 1.039, Test accuracy: 62.31
Round  31, Global train loss: 1.159, Global test loss: 1.518, Global test accuracy: 48.82
Round  32, Train loss: 0.974, Test loss: 1.028, Test accuracy: 62.23
Round  32, Global train loss: 0.974, Global test loss: 1.438, Global test accuracy: 52.05
Round  33, Train loss: 1.208, Test loss: 1.020, Test accuracy: 62.30
Round  33, Global train loss: 1.208, Global test loss: 1.481, Global test accuracy: 50.51
Round  34, Train loss: 1.131, Test loss: 1.029, Test accuracy: 61.84
Round  34, Global train loss: 1.131, Global test loss: 1.450, Global test accuracy: 52.08
Round  35, Train loss: 0.951, Test loss: 1.029, Test accuracy: 62.05
Round  35, Global train loss: 0.951, Global test loss: 1.413, Global test accuracy: 51.32
Round  36, Train loss: 1.052, Test loss: 1.035, Test accuracy: 61.99
Round  36, Global train loss: 1.052, Global test loss: 1.892, Global test accuracy: 39.67
Round  37, Train loss: 1.028, Test loss: 1.043, Test accuracy: 61.68
Round  37, Global train loss: 1.028, Global test loss: 1.432, Global test accuracy: 50.48
Round  38, Train loss: 1.326, Test loss: 1.047, Test accuracy: 61.38
Round  38, Global train loss: 1.326, Global test loss: 1.652, Global test accuracy: 42.97
Round  39, Train loss: 0.963, Test loss: 1.046, Test accuracy: 61.07
Round  39, Global train loss: 0.963, Global test loss: 1.403, Global test accuracy: 51.66
Round  40, Train loss: 1.045, Test loss: 1.052, Test accuracy: 61.20
Round  40, Global train loss: 1.045, Global test loss: 1.408, Global test accuracy: 52.69
Round  41, Train loss: 1.048, Test loss: 1.051, Test accuracy: 61.52
Round  41, Global train loss: 1.048, Global test loss: 1.490, Global test accuracy: 51.74
Round  42, Train loss: 1.040, Test loss: 1.054, Test accuracy: 61.25
Round  42, Global train loss: 1.040, Global test loss: 1.448, Global test accuracy: 50.70
Round  43, Train loss: 1.171, Test loss: 1.052, Test accuracy: 61.22
Round  43, Global train loss: 1.171, Global test loss: 1.708, Global test accuracy: 45.37
Round  44, Train loss: 1.011, Test loss: 1.053, Test accuracy: 61.46
Round  44, Global train loss: 1.011, Global test loss: 1.473, Global test accuracy: 49.51
Round  45, Train loss: 0.912, Test loss: 1.059, Test accuracy: 61.50
Round  45, Global train loss: 0.912, Global test loss: 1.490, Global test accuracy: 50.67
Round  46, Train loss: 0.901, Test loss: 1.062, Test accuracy: 61.20
Round  46, Global train loss: 0.901, Global test loss: 1.528, Global test accuracy: 49.36
Round  47, Train loss: 0.896, Test loss: 1.045, Test accuracy: 62.02
Round  47, Global train loss: 0.896, Global test loss: 1.365, Global test accuracy: 53.49
Round  48, Train loss: 1.069, Test loss: 1.034, Test accuracy: 62.44
Round  48, Global train loss: 1.069, Global test loss: 1.458, Global test accuracy: 51.44
Round  49, Train loss: 0.961, Test loss: 1.061, Test accuracy: 61.46
Round  49, Global train loss: 0.961, Global test loss: 1.424, Global test accuracy: 53.22
Round  50, Train loss: 0.946, Test loss: 1.068, Test accuracy: 61.23
Round  50, Global train loss: 0.946, Global test loss: 1.501, Global test accuracy: 50.88
Round  51, Train loss: 1.030, Test loss: 1.061, Test accuracy: 61.75
Round  51, Global train loss: 1.030, Global test loss: 1.506, Global test accuracy: 49.74
Round  52, Train loss: 0.923, Test loss: 1.066, Test accuracy: 61.61
Round  52, Global train loss: 0.923, Global test loss: 1.440, Global test accuracy: 52.21
Round  53, Train loss: 1.167, Test loss: 1.056, Test accuracy: 62.09
Round  53, Global train loss: 1.167, Global test loss: 1.521, Global test accuracy: 49.91
Round  54, Train loss: 0.964, Test loss: 1.069, Test accuracy: 61.94
Round  54, Global train loss: 0.964, Global test loss: 1.602, Global test accuracy: 48.14
Round  55, Train loss: 0.894, Test loss: 1.068, Test accuracy: 61.78
Round  55, Global train loss: 0.894, Global test loss: 1.749, Global test accuracy: 45.35
Round  56, Train loss: 0.861, Test loss: 1.074, Test accuracy: 61.08
Round  56, Global train loss: 0.861, Global test loss: 1.371, Global test accuracy: 54.55
Round  57, Train loss: 1.032, Test loss: 1.073, Test accuracy: 61.29
Round  57, Global train loss: 1.032, Global test loss: 1.472, Global test accuracy: 50.59
Round  58, Train loss: 0.832, Test loss: 1.107, Test accuracy: 61.22
Round  58, Global train loss: 0.832, Global test loss: 1.540, Global test accuracy: 49.39
Round  59, Train loss: 0.882, Test loss: 1.119, Test accuracy: 60.90
Round  59, Global train loss: 0.882, Global test loss: 1.457, Global test accuracy: 51.90
Round  60, Train loss: 0.776, Test loss: 1.114, Test accuracy: 61.19
Round  60, Global train loss: 0.776, Global test loss: 1.432, Global test accuracy: 53.24
Round  61, Train loss: 0.790, Test loss: 1.116, Test accuracy: 61.12
Round  61, Global train loss: 0.790, Global test loss: 1.414, Global test accuracy: 52.42
Round  62, Train loss: 0.909, Test loss: 1.111, Test accuracy: 61.65
Round  62, Global train loss: 0.909, Global test loss: 1.613, Global test accuracy: 48.41
Round  63, Train loss: 0.931, Test loss: 1.131, Test accuracy: 61.27
Round  63, Global train loss: 0.931, Global test loss: 1.562, Global test accuracy: 48.63
Round  64, Train loss: 0.936, Test loss: 1.131, Test accuracy: 61.53
Round  64, Global train loss: 0.936, Global test loss: 1.624, Global test accuracy: 47.68
Round  65, Train loss: 0.922, Test loss: 1.136, Test accuracy: 61.33
Round  65, Global train loss: 0.922, Global test loss: 1.496, Global test accuracy: 50.50
Round  66, Train loss: 0.825, Test loss: 1.157, Test accuracy: 60.76
Round  66, Global train loss: 0.825, Global test loss: 1.471, Global test accuracy: 52.66
Round  67, Train loss: 0.807, Test loss: 1.166, Test accuracy: 60.48
Round  67, Global train loss: 0.807, Global test loss: 1.457, Global test accuracy: 52.64
Round  68, Train loss: 0.739, Test loss: 1.158, Test accuracy: 60.73
Round  68, Global train loss: 0.739, Global test loss: 1.608, Global test accuracy: 48.43
Round  69, Train loss: 0.793, Test loss: 1.163, Test accuracy: 60.71
Round  69, Global train loss: 0.793, Global test loss: 1.462, Global test accuracy: 52.15
Round  70, Train loss: 0.639, Test loss: 1.169, Test accuracy: 60.44
Round  70, Global train loss: 0.639, Global test loss: 1.584, Global test accuracy: 49.91
Round  71, Train loss: 0.897, Test loss: 1.170, Test accuracy: 60.70
Round  71, Global train loss: 0.897, Global test loss: 1.571, Global test accuracy: 50.15
Round  72, Train loss: 0.699, Test loss: 1.184, Test accuracy: 60.04
Round  72, Global train loss: 0.699, Global test loss: 1.585, Global test accuracy: 51.05
Round  73, Train loss: 0.790, Test loss: 1.182, Test accuracy: 59.91
Round  73, Global train loss: 0.790, Global test loss: 1.423, Global test accuracy: 54.23
Round  74, Train loss: 0.686, Test loss: 1.203, Test accuracy: 59.75
Round  74, Global train loss: 0.686, Global test loss: 1.422, Global test accuracy: 53.53
Round  75, Train loss: 0.689, Test loss: 1.214, Test accuracy: 59.87
Round  75, Global train loss: 0.689, Global test loss: 1.653, Global test accuracy: 50.25
Round  76, Train loss: 0.681, Test loss: 1.196, Test accuracy: 60.58
Round  76, Global train loss: 0.681, Global test loss: 1.689, Global test accuracy: 50.22
Round  77, Train loss: 0.711, Test loss: 1.208, Test accuracy: 60.91
Round  77, Global train loss: 0.711, Global test loss: 1.454, Global test accuracy: 53.09
Round  78, Train loss: 0.835, Test loss: 1.189, Test accuracy: 61.39
Round  78, Global train loss: 0.835, Global test loss: 1.631, Global test accuracy: 50.19
Round  79, Train loss: 0.691, Test loss: 1.185, Test accuracy: 61.71
Round  79, Global train loss: 0.691, Global test loss: 1.559, Global test accuracy: 52.13
Round  80, Train loss: 0.790, Test loss: 1.185, Test accuracy: 61.22
Round  80, Global train loss: 0.790, Global test loss: 1.575, Global test accuracy: 50.27
Round  81, Train loss: 0.881, Test loss: 1.194, Test accuracy: 61.52
Round  81, Global train loss: 0.881, Global test loss: 1.798, Global test accuracy: 45.49
Round  82, Train loss: 0.637, Test loss: 1.198, Test accuracy: 61.15
Round  82, Global train loss: 0.637, Global test loss: 1.505, Global test accuracy: 54.63
Round  83, Train loss: 0.748, Test loss: 1.234, Test accuracy: 60.65
Round  83, Global train loss: 0.748, Global test loss: 1.505, Global test accuracy: 52.54
Round  84, Train loss: 0.790, Test loss: 1.224, Test accuracy: 61.06
Round  84, Global train loss: 0.790, Global test loss: 1.508, Global test accuracy: 51.91
Round  85, Train loss: 0.753, Test loss: 1.220, Test accuracy: 61.14
Round  85, Global train loss: 0.753, Global test loss: 1.510, Global test accuracy: 53.36
Round  86, Train loss: 0.769, Test loss: 1.207, Test accuracy: 61.69
Round  86, Global train loss: 0.769, Global test loss: 1.674, Global test accuracy: 50.11
Round  87, Train loss: 0.774, Test loss: 1.220, Test accuracy: 61.42
Round  87, Global train loss: 0.774, Global test loss: 1.567, Global test accuracy: 52.16
Round  88, Train loss: 0.788, Test loss: 1.246, Test accuracy: 60.54
Round  88, Global train loss: 0.788, Global test loss: 1.703, Global test accuracy: 47.52
Round  89, Train loss: 0.653, Test loss: 1.271, Test accuracy: 60.46
Round  89, Global train loss: 0.653, Global test loss: 1.700, Global test accuracy: 51.49
Round  90, Train loss: 0.727, Test loss: 1.275, Test accuracy: 60.27
Round  90, Global train loss: 0.727, Global test loss: 1.738, Global test accuracy: 49.74
Round  91, Train loss: 0.702, Test loss: 1.280, Test accuracy: 60.14
Round  91, Global train loss: 0.702, Global test loss: 1.732, Global test accuracy: 48.30
Round  92, Train loss: 0.681, Test loss: 1.290, Test accuracy: 59.97
Round  92, Global train loss: 0.681, Global test loss: 1.769, Global test accuracy: 48.73
Round  93, Train loss: 0.692, Test loss: 1.299, Test accuracy: 59.46
Round  93, Global train loss: 0.692, Global test loss: 1.605, Global test accuracy: 52.12
Round  94, Train loss: 0.583, Test loss: 1.292, Test accuracy: 59.94
Round  94, Global train loss: 0.583, Global test loss: 1.568, Global test accuracy: 53.00
Round  95, Train loss: 0.852, Test loss: 1.286, Test accuracy: 60.38
Round  95, Global train loss: 0.852, Global test loss: 1.624, Global test accuracy: 48.67
Round  96, Train loss: 0.662, Test loss: 1.318, Test accuracy: 59.35
Round  96, Global train loss: 0.662, Global test loss: 1.575, Global test accuracy: 50.78
Round  97, Train loss: 0.781, Test loss: 1.290, Test accuracy: 60.00
Round  97, Global train loss: 0.781, Global test loss: 1.746, Global test accuracy: 47.21
Round  98, Train loss: 0.598, Test loss: 1.301, Test accuracy: 60.20
Round  98, Global train loss: 0.598, Global test loss: 1.545, Global test accuracy: 52.42
Round  99, Train loss: 0.746, Test loss: 1.326, Test accuracy: 60.02
Round  99, Global train loss: 0.746, Global test loss: 1.777, Global test accuracy: 48.50
Final Round, Train loss: 0.543, Test loss: 1.469, Test accuracy: 59.67
Final Round, Global train loss: 0.543, Global test loss: 1.777, Global test accuracy: 48.50
Average accuracy final 10 rounds: 59.97300000000001
Average global accuracy final 10 rounds: 49.947
2406.7640404701233
[1.7463133335113525, 3.2659897804260254, 4.7247843742370605, 6.1693127155303955, 7.724111795425415, 9.163620471954346, 10.688062191009521, 12.09095549583435, 13.540150880813599, 15.210129737854004, 16.713491201400757, 18.20926332473755, 19.674440383911133, 21.186464071273804, 22.809624433517456, 24.41961431503296, 25.99962019920349, 27.448364734649658, 29.04780340194702, 30.536043882369995, 31.8829984664917, 35.20879769325256, 38.464940309524536, 41.792723655700684, 45.09569334983826, 48.35690355300903, 51.67031192779541, 55.03325009346008, 58.23178791999817, 61.593236446380615, 65.02762961387634, 68.62933540344238, 71.97712898254395, 75.44341254234314, 78.72035336494446, 82.13226795196533, 85.38244795799255, 88.75180435180664, 92.12348079681396, 95.39298295974731, 98.98910188674927, 102.24841713905334, 105.67555975914001, 109.1672875881195, 112.61363363265991, 115.98027753829956, 119.25024914741516, 122.44181418418884, 125.7339551448822, 129.14725017547607, 132.5482382774353, 135.6895101070404, 139.10610723495483, 142.36931562423706, 145.71144890785217, 148.9543342590332, 152.23187041282654, 155.6274495124817, 159.00672006607056, 162.25177454948425, 165.58715534210205, 168.92436265945435, 172.32217931747437, 175.89563536643982, 179.34341764450073, 182.77723813056946, 186.1289882659912, 189.87593865394592, 193.36551594734192, 197.051433801651, 200.4639654159546, 203.88932871818542, 207.17911219596863, 210.74345302581787, 214.21636033058167, 218.39588332176208, 222.54592108726501, 226.82503819465637, 231.11064839363098, 235.50149178504944, 239.78567147254944, 244.040776014328, 247.33523988723755, 251.50173783302307, 255.40229034423828, 258.8438365459442, 262.74986743927, 266.3371014595032, 269.79899048805237, 273.08454871177673, 276.2911567687988, 279.4960358142853, 283.08877062797546, 286.418719291687, 289.68701100349426, 293.1180064678192, 296.6309669017792, 300.4901354312897, 303.93402767181396, 307.18775510787964, 310.2114748954773]
[20.85, 29.74, 34.35, 37.67, 42.54, 42.96, 48.78, 51.16, 52.11, 52.54, 53.94, 54.12, 54.7, 55.53, 55.61, 56.27, 57.03, 56.98, 57.11, 57.47, 58.08, 58.93, 60.31, 60.44, 60.36, 60.45, 60.93, 61.5, 61.31, 61.68, 62.07, 62.31, 62.23, 62.3, 61.84, 62.05, 61.99, 61.68, 61.38, 61.07, 61.2, 61.52, 61.25, 61.22, 61.46, 61.5, 61.2, 62.02, 62.44, 61.46, 61.23, 61.75, 61.61, 62.09, 61.94, 61.78, 61.08, 61.29, 61.22, 60.9, 61.19, 61.12, 61.65, 61.27, 61.53, 61.33, 60.76, 60.48, 60.73, 60.71, 60.44, 60.7, 60.04, 59.91, 59.75, 59.87, 60.58, 60.91, 61.39, 61.71, 61.22, 61.52, 61.15, 60.65, 61.06, 61.14, 61.69, 61.42, 60.54, 60.46, 60.27, 60.14, 59.97, 59.46, 59.94, 60.38, 59.35, 60.0, 60.2, 60.02, 59.67]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.608, Test loss: 1.389, Test accuracy: 41.20
Round   0, Global train loss: 1.608, Global test loss: 2.211, Global test accuracy: 19.58
Round   1, Train loss: 1.480, Test loss: 1.298, Test accuracy: 46.89
Round   1, Global train loss: 1.480, Global test loss: 1.983, Global test accuracy: 28.52
Round   2, Train loss: 1.395, Test loss: 1.226, Test accuracy: 50.96
Round   2, Global train loss: 1.395, Global test loss: 1.825, Global test accuracy: 34.84
Round   3, Train loss: 1.343, Test loss: 1.189, Test accuracy: 53.84
Round   3, Global train loss: 1.343, Global test loss: 1.736, Global test accuracy: 38.21
Round   4, Train loss: 1.306, Test loss: 1.164, Test accuracy: 54.66
Round   4, Global train loss: 1.306, Global test loss: 1.674, Global test accuracy: 41.23
Round   5, Train loss: 1.274, Test loss: 1.149, Test accuracy: 55.74
Round   5, Global train loss: 1.274, Global test loss: 1.628, Global test accuracy: 43.10
Round   6, Train loss: 1.247, Test loss: 1.141, Test accuracy: 56.45
Round   6, Global train loss: 1.247, Global test loss: 1.589, Global test accuracy: 45.50
Round   7, Train loss: 1.221, Test loss: 1.119, Test accuracy: 57.70
Round   7, Global train loss: 1.221, Global test loss: 1.551, Global test accuracy: 46.72
Round   8, Train loss: 1.191, Test loss: 1.108, Test accuracy: 58.23
Round   8, Global train loss: 1.191, Global test loss: 1.510, Global test accuracy: 48.40
Round   9, Train loss: 1.163, Test loss: 1.097, Test accuracy: 58.60
Round   9, Global train loss: 1.163, Global test loss: 1.492, Global test accuracy: 49.41
Round  10, Train loss: 1.050, Test loss: 1.094, Test accuracy: 59.02
Round  10, Global train loss: 1.050, Global test loss: 1.648, Global test accuracy: 46.81
Round  11, Train loss: 1.033, Test loss: 1.092, Test accuracy: 58.95
Round  11, Global train loss: 1.033, Global test loss: 1.697, Global test accuracy: 42.61
Round  12, Train loss: 1.052, Test loss: 1.092, Test accuracy: 59.49
Round  12, Global train loss: 1.052, Global test loss: 1.783, Global test accuracy: 43.23
Round  13, Train loss: 0.987, Test loss: 1.116, Test accuracy: 59.18
Round  13, Global train loss: 0.987, Global test loss: 1.752, Global test accuracy: 40.76
Round  14, Train loss: 0.866, Test loss: 1.128, Test accuracy: 59.17
Round  14, Global train loss: 0.866, Global test loss: 1.714, Global test accuracy: 45.04
Round  15, Train loss: 0.991, Test loss: 1.136, Test accuracy: 58.62
Round  15, Global train loss: 0.991, Global test loss: 1.570, Global test accuracy: 48.01
Round  16, Train loss: 1.090, Test loss: 1.156, Test accuracy: 58.49
Round  16, Global train loss: 1.090, Global test loss: 1.594, Global test accuracy: 44.44
Round  17, Train loss: 0.931, Test loss: 1.188, Test accuracy: 58.02
Round  17, Global train loss: 0.931, Global test loss: 1.550, Global test accuracy: 46.97
Round  18, Train loss: 0.986, Test loss: 1.177, Test accuracy: 57.70
Round  18, Global train loss: 0.986, Global test loss: 1.649, Global test accuracy: 43.90
Round  19, Train loss: 0.831, Test loss: 1.200, Test accuracy: 58.65
Round  19, Global train loss: 0.831, Global test loss: 1.617, Global test accuracy: 47.14
Round  20, Train loss: 0.773, Test loss: 1.221, Test accuracy: 58.45
Round  20, Global train loss: 0.773, Global test loss: 1.587, Global test accuracy: 49.25
Round  21, Train loss: 1.007, Test loss: 1.248, Test accuracy: 57.04
Round  21, Global train loss: 1.007, Global test loss: 1.531, Global test accuracy: 47.54
Round  22, Train loss: 0.819, Test loss: 1.288, Test accuracy: 56.28
Round  22, Global train loss: 0.819, Global test loss: 1.597, Global test accuracy: 48.07
Round  23, Train loss: 0.908, Test loss: 1.294, Test accuracy: 56.39
Round  23, Global train loss: 0.908, Global test loss: 1.681, Global test accuracy: 44.67
Round  24, Train loss: 0.772, Test loss: 1.304, Test accuracy: 56.60
Round  24, Global train loss: 0.772, Global test loss: 1.609, Global test accuracy: 46.79
Round  25, Train loss: 0.940, Test loss: 1.296, Test accuracy: 56.40
Round  25, Global train loss: 0.940, Global test loss: 1.653, Global test accuracy: 46.99
Round  26, Train loss: 0.727, Test loss: 1.309, Test accuracy: 56.49
Round  26, Global train loss: 0.727, Global test loss: 1.475, Global test accuracy: 51.93
Round  27, Train loss: 0.769, Test loss: 1.331, Test accuracy: 56.68
Round  27, Global train loss: 0.769, Global test loss: 1.577, Global test accuracy: 49.25
Round  28, Train loss: 0.752, Test loss: 1.349, Test accuracy: 56.81
Round  28, Global train loss: 0.752, Global test loss: 1.483, Global test accuracy: 52.63
Round  29, Train loss: 0.752, Test loss: 1.352, Test accuracy: 56.80
Round  29, Global train loss: 0.752, Global test loss: 1.619, Global test accuracy: 48.68
Round  30, Train loss: 0.731, Test loss: 1.341, Test accuracy: 57.42
Round  30, Global train loss: 0.731, Global test loss: 1.722, Global test accuracy: 44.70
Round  31, Train loss: 0.681, Test loss: 1.383, Test accuracy: 56.80
Round  31, Global train loss: 0.681, Global test loss: 1.775, Global test accuracy: 45.43
Round  32, Train loss: 0.723, Test loss: 1.415, Test accuracy: 56.02
Round  32, Global train loss: 0.723, Global test loss: 1.849, Global test accuracy: 44.12
Round  33, Train loss: 0.707, Test loss: 1.436, Test accuracy: 56.27
Round  33, Global train loss: 0.707, Global test loss: 1.588, Global test accuracy: 48.99
Round  34, Train loss: 0.473, Test loss: 1.435, Test accuracy: 56.31
Round  34, Global train loss: 0.473, Global test loss: 1.709, Global test accuracy: 50.71
Round  35, Train loss: 0.645, Test loss: 1.454, Test accuracy: 56.24
Round  35, Global train loss: 0.645, Global test loss: 1.645, Global test accuracy: 50.22
Round  36, Train loss: 0.738, Test loss: 1.474, Test accuracy: 56.30
Round  36, Global train loss: 0.738, Global test loss: 2.289, Global test accuracy: 38.11
Round  37, Train loss: 0.663, Test loss: 1.500, Test accuracy: 56.17
Round  37, Global train loss: 0.663, Global test loss: 1.750, Global test accuracy: 46.70
Round  38, Train loss: 0.748, Test loss: 1.507, Test accuracy: 56.64
Round  38, Global train loss: 0.748, Global test loss: 1.885, Global test accuracy: 43.20
Round  39, Train loss: 0.471, Test loss: 1.523, Test accuracy: 56.87
Round  39, Global train loss: 0.471, Global test loss: 1.690, Global test accuracy: 49.78
Round  40, Train loss: 0.628, Test loss: 1.500, Test accuracy: 57.59
Round  40, Global train loss: 0.628, Global test loss: 1.752, Global test accuracy: 48.85
Round  41, Train loss: 0.506, Test loss: 1.539, Test accuracy: 57.28
Round  41, Global train loss: 0.506, Global test loss: 1.755, Global test accuracy: 51.47
Round  42, Train loss: 0.521, Test loss: 1.540, Test accuracy: 57.31
Round  42, Global train loss: 0.521, Global test loss: 1.666, Global test accuracy: 50.92
Round  43, Train loss: 0.614, Test loss: 1.572, Test accuracy: 57.05
Round  43, Global train loss: 0.614, Global test loss: 2.171, Global test accuracy: 45.71
Round  44, Train loss: 0.610, Test loss: 1.567, Test accuracy: 57.23
Round  44, Global train loss: 0.610, Global test loss: 1.733, Global test accuracy: 47.71
Round  45, Train loss: 0.452, Test loss: 1.598, Test accuracy: 56.63
Round  45, Global train loss: 0.452, Global test loss: 1.766, Global test accuracy: 51.28
Round  46, Train loss: 0.681, Test loss: 1.597, Test accuracy: 56.54
Round  46, Global train loss: 0.681, Global test loss: 1.950, Global test accuracy: 42.97
Round  47, Train loss: 0.620, Test loss: 1.588, Test accuracy: 56.83
Round  47, Global train loss: 0.620, Global test loss: 1.730, Global test accuracy: 46.82
Round  48, Train loss: 0.491, Test loss: 1.614, Test accuracy: 56.83
Round  48, Global train loss: 0.491, Global test loss: 1.798, Global test accuracy: 50.01
Round  49, Train loss: 0.543, Test loss: 1.638, Test accuracy: 56.61
Round  49, Global train loss: 0.543, Global test loss: 1.766, Global test accuracy: 48.48
Round  50, Train loss: 0.558, Test loss: 1.641, Test accuracy: 56.60
Round  50, Global train loss: 0.558, Global test loss: 1.963, Global test accuracy: 45.34
Round  51, Train loss: 0.457, Test loss: 1.690, Test accuracy: 56.01
Round  51, Global train loss: 0.457, Global test loss: 1.887, Global test accuracy: 46.94
Round  52, Train loss: 0.589, Test loss: 1.687, Test accuracy: 56.47
Round  52, Global train loss: 0.589, Global test loss: 1.849, Global test accuracy: 47.00
Round  53, Train loss: 0.513, Test loss: 1.709, Test accuracy: 56.17
Round  53, Global train loss: 0.513, Global test loss: 1.889, Global test accuracy: 48.06
Round  54, Train loss: 0.542, Test loss: 1.693, Test accuracy: 56.37
Round  54, Global train loss: 0.542, Global test loss: 2.071, Global test accuracy: 44.44
Round  55, Train loss: 0.468, Test loss: 1.689, Test accuracy: 56.52
Round  55, Global train loss: 0.468, Global test loss: 2.328, Global test accuracy: 41.24
Round  56, Train loss: 0.481, Test loss: 1.719, Test accuracy: 56.46
Round  56, Global train loss: 0.481, Global test loss: 1.769, Global test accuracy: 49.90
Round  57, Train loss: 0.477, Test loss: 1.725, Test accuracy: 56.71
Round  57, Global train loss: 0.477, Global test loss: 1.953, Global test accuracy: 47.19
Round  58, Train loss: 0.563, Test loss: 1.719, Test accuracy: 56.71
Round  58, Global train loss: 0.563, Global test loss: 1.924, Global test accuracy: 46.13
Round  59, Train loss: 0.637, Test loss: 1.758, Test accuracy: 56.06
Round  59, Global train loss: 0.637, Global test loss: 1.921, Global test accuracy: 44.28
Round  60, Train loss: 0.444, Test loss: 1.751, Test accuracy: 56.31
Round  60, Global train loss: 0.444, Global test loss: 2.057, Global test accuracy: 46.90
Round  61, Train loss: 0.473, Test loss: 1.768, Test accuracy: 56.33
Round  61, Global train loss: 0.473, Global test loss: 2.032, Global test accuracy: 46.13
Round  62, Train loss: 0.479, Test loss: 1.819, Test accuracy: 56.12
Round  62, Global train loss: 0.479, Global test loss: 2.280, Global test accuracy: 45.06
Round  63, Train loss: 0.540, Test loss: 1.826, Test accuracy: 56.23
Round  63, Global train loss: 0.540, Global test loss: 2.014, Global test accuracy: 45.14
Round  64, Train loss: 0.453, Test loss: 1.787, Test accuracy: 55.96
Round  64, Global train loss: 0.453, Global test loss: 2.167, Global test accuracy: 43.96
Round  65, Train loss: 0.505, Test loss: 1.770, Test accuracy: 56.15
Round  65, Global train loss: 0.505, Global test loss: 1.976, Global test accuracy: 47.39
Round  66, Train loss: 0.399, Test loss: 1.784, Test accuracy: 56.54
Round  66, Global train loss: 0.399, Global test loss: 1.908, Global test accuracy: 48.85
Round  67, Train loss: 0.572, Test loss: 1.762, Test accuracy: 57.09
Round  67, Global train loss: 0.572, Global test loss: 1.955, Global test accuracy: 44.68
Round  68, Train loss: 0.403, Test loss: 1.786, Test accuracy: 56.88
Round  68, Global train loss: 0.403, Global test loss: 2.235, Global test accuracy: 44.80
Round  69, Train loss: 0.503, Test loss: 1.814, Test accuracy: 56.87
Round  69, Global train loss: 0.503, Global test loss: 1.964, Global test accuracy: 46.95
Round  70, Train loss: 0.448, Test loss: 1.793, Test accuracy: 57.40
Round  70, Global train loss: 0.448, Global test loss: 2.435, Global test accuracy: 39.70
Round  71, Train loss: 0.429, Test loss: 1.768, Test accuracy: 57.57
Round  71, Global train loss: 0.429, Global test loss: 2.085, Global test accuracy: 47.20
Round  72, Train loss: 0.397, Test loss: 1.782, Test accuracy: 57.78
Round  72, Global train loss: 0.397, Global test loss: 2.081, Global test accuracy: 47.18
Round  73, Train loss: 0.556, Test loss: 1.840, Test accuracy: 56.83
Round  73, Global train loss: 0.556, Global test loss: 1.964, Global test accuracy: 45.32
Round  74, Train loss: 0.462, Test loss: 1.871, Test accuracy: 56.40
Round  74, Global train loss: 0.462, Global test loss: 2.035, Global test accuracy: 44.74
Round  75, Train loss: 0.381, Test loss: 1.876, Test accuracy: 55.92
Round  75, Global train loss: 0.381, Global test loss: 2.415, Global test accuracy: 43.89
Round  76, Train loss: 0.438, Test loss: 1.876, Test accuracy: 55.94
Round  76, Global train loss: 0.438, Global test loss: 2.330, Global test accuracy: 44.25
Round  77, Train loss: 0.478, Test loss: 1.883, Test accuracy: 56.53
Round  77, Global train loss: 0.478, Global test loss: 2.128, Global test accuracy: 44.44
Round  78, Train loss: 0.399, Test loss: 1.876, Test accuracy: 56.76
Round  78, Global train loss: 0.399, Global test loss: 2.297, Global test accuracy: 44.40
Round  79, Train loss: 0.370, Test loss: 1.860, Test accuracy: 57.02
Round  79, Global train loss: 0.370, Global test loss: 2.177, Global test accuracy: 44.87
Round  80, Train loss: 0.332, Test loss: 1.887, Test accuracy: 57.34
Round  80, Global train loss: 0.332, Global test loss: 1.857, Global test accuracy: 53.27
Round  81, Train loss: 0.293, Test loss: 1.918, Test accuracy: 56.95
Round  81, Global train loss: 0.293, Global test loss: 1.925, Global test accuracy: 52.63
Round  82, Train loss: 0.267, Test loss: 1.922, Test accuracy: 57.13
Round  82, Global train loss: 0.267, Global test loss: 1.857, Global test accuracy: 53.99
Round  83, Train loss: 0.247, Test loss: 1.943, Test accuracy: 56.83
Round  83, Global train loss: 0.247, Global test loss: 1.864, Global test accuracy: 54.06
Round  84, Train loss: 0.243, Test loss: 1.947, Test accuracy: 56.97
Round  84, Global train loss: 0.243, Global test loss: 1.884, Global test accuracy: 54.58
Round  85, Train loss: 0.234, Test loss: 1.949, Test accuracy: 57.20
Round  85, Global train loss: 0.234, Global test loss: 1.931, Global test accuracy: 54.20
Round  86, Train loss: 0.226, Test loss: 1.960, Test accuracy: 57.34
Round  86, Global train loss: 0.226, Global test loss: 1.930, Global test accuracy: 54.09
Round  87, Train loss: 0.217, Test loss: 1.979, Test accuracy: 56.99
Round  87, Global train loss: 0.217, Global test loss: 1.941, Global test accuracy: 53.88
Round  88, Train loss: 0.218, Test loss: 1.974, Test accuracy: 56.33
Round  88, Global train loss: 0.218, Global test loss: 1.934, Global test accuracy: 54.69
Round  89, Train loss: 0.207, Test loss: 1.974, Test accuracy: 57.05
Round  89, Global train loss: 0.207, Global test loss: 1.938, Global test accuracy: 54.37
Round  90, Train loss: 0.409, Test loss: 1.933, Test accuracy: 57.54
Round  90, Global train loss: 0.409, Global test loss: 1.806, Global test accuracy: 52.95
Round  91, Train loss: 0.376, Test loss: 1.984, Test accuracy: 57.10
Round  91, Global train loss: 0.376, Global test loss: 1.800, Global test accuracy: 52.91
Round  92, Train loss: 0.366, Test loss: 1.888, Test accuracy: 56.93
Round  92, Global train loss: 0.366, Global test loss: 1.784, Global test accuracy: 52.38
Round  93, Train loss: 0.352, Test loss: 1.926, Test accuracy: 57.75
Round  93, Global train loss: 0.352, Global test loss: 1.807, Global test accuracy: 52.38
Round  94, Train loss: 0.356, Test loss: 1.978, Test accuracy: 57.02
Round  94, Global train loss: 0.356, Global test loss: 1.814, Global test accuracy: 52.58
Round  95, Train loss: 0.349, Test loss: 2.010, Test accuracy: 56.12
Round  95, Global train loss: 0.349, Global test loss: 1.849, Global test accuracy: 51.65
Round  96, Train loss: 0.342, Test loss: 2.000, Test accuracy: 57.07
Round  96, Global train loss: 0.342, Global test loss: 1.842, Global test accuracy: 51.83
Round  97, Train loss: 0.335, Test loss: 1.999, Test accuracy: 56.94
Round  97, Global train loss: 0.335, Global test loss: 1.861, Global test accuracy: 51.47
Round  98, Train loss: 0.337, Test loss: 1.971, Test accuracy: 57.68
Round  98, Global train loss: 0.337, Global test loss: 1.846, Global test accuracy: 51.80
Round  99, Train loss: 0.340, Test loss: 2.005, Test accuracy: 57.12
Round  99, Global train loss: 0.340, Global test loss: 1.857, Global test accuracy: 51.20
Final Round, Train loss: 0.250, Test loss: 2.242, Test accuracy: 57.42
Final Round, Global train loss: 0.250, Global test loss: 1.857, Global test accuracy: 51.20
Average accuracy final 10 rounds: 57.126999999999995
Average global accuracy final 10 rounds: 52.11499999999999
3274.8964059352875
[3.2359249591827393, 6.008593559265137, 9.127630949020386, 12.131684303283691, 15.224843263626099, 18.816059827804565, 21.756200790405273, 25.11924934387207, 28.712809801101685, 32.15953969955444, 34.989227294921875, 37.7549033164978, 40.50366544723511, 43.523175954818726, 46.55854415893555, 49.253826379776, 51.981629371643066, 54.5945508480072, 57.51337933540344, 60.49435091018677, 63.71042513847351, 66.57897639274597, 69.23245573043823, 72.1792573928833, 75.16250419616699, 77.79984927177429, 80.63158297538757, 83.19428873062134, 86.23251152038574, 89.71785092353821, 92.53437924385071, 95.43850588798523, 98.38771486282349, 101.19867777824402, 104.76156401634216, 107.49845147132874, 110.5153648853302, 113.56209754943848, 116.9616277217865, 120.25625467300415, 122.94206833839417, 126.34525895118713, 129.48401737213135, 132.56367540359497, 135.82808017730713, 138.588440656662, 141.9443736076355, 144.91416835784912, 147.95792841911316, 151.0301537513733, 153.79097962379456, 156.55671095848083, 159.49621963500977, 162.47237610816956, 165.30384254455566, 168.21643257141113, 171.21860671043396, 174.2859616279602, 177.3006136417389, 180.29866886138916, 183.2293779850006, 186.42644619941711, 189.34678649902344, 192.20413851737976, 195.23738622665405, 199.15070176124573, 202.57939887046814, 205.16349244117737, 207.9644420146942, 210.74819016456604, 213.78992533683777, 216.77424693107605, 219.76120471954346, 222.51203274726868, 225.0705509185791, 228.2990484237671, 231.28607177734375, 234.15305042266846, 237.513610124588, 240.45213174819946, 243.53740572929382, 246.48756170272827, 249.37865567207336, 252.66128492355347, 255.85421228408813, 259.52815222740173, 262.62273597717285, 265.65953612327576, 268.7218277454376, 271.7143623828888, 275.7365379333496, 278.7887282371521, 282.47262024879456, 286.07331800460815, 289.0860254764557, 292.0912535190582, 295.09642028808594, 297.8497483730316, 301.10907912254333, 304.72728276252747, 311.08092427253723]
[41.2, 46.89, 50.96, 53.84, 54.66, 55.74, 56.45, 57.7, 58.23, 58.6, 59.02, 58.95, 59.49, 59.18, 59.17, 58.62, 58.49, 58.02, 57.7, 58.65, 58.45, 57.04, 56.28, 56.39, 56.6, 56.4, 56.49, 56.68, 56.81, 56.8, 57.42, 56.8, 56.02, 56.27, 56.31, 56.24, 56.3, 56.17, 56.64, 56.87, 57.59, 57.28, 57.31, 57.05, 57.23, 56.63, 56.54, 56.83, 56.83, 56.61, 56.6, 56.01, 56.47, 56.17, 56.37, 56.52, 56.46, 56.71, 56.71, 56.06, 56.31, 56.33, 56.12, 56.23, 55.96, 56.15, 56.54, 57.09, 56.88, 56.87, 57.4, 57.57, 57.78, 56.83, 56.4, 55.92, 55.94, 56.53, 56.76, 57.02, 57.34, 56.95, 57.13, 56.83, 56.97, 57.2, 57.34, 56.99, 56.33, 57.05, 57.54, 57.1, 56.93, 57.75, 57.02, 56.12, 57.07, 56.94, 57.68, 57.12, 57.42]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.609, Test loss: 1.401, Test accuracy: 40.19
Round   0, Global train loss: 1.609, Global test loss: 2.181, Global test accuracy: 21.25
Round   1, Train loss: 1.475, Test loss: 1.287, Test accuracy: 47.35
Round   1, Global train loss: 1.475, Global test loss: 1.958, Global test accuracy: 28.36
Round   2, Train loss: 1.395, Test loss: 1.212, Test accuracy: 52.65
Round   2, Global train loss: 1.395, Global test loss: 1.826, Global test accuracy: 34.58
Round   3, Train loss: 1.343, Test loss: 1.188, Test accuracy: 54.75
Round   3, Global train loss: 1.343, Global test loss: 1.735, Global test accuracy: 36.85
Round   4, Train loss: 1.305, Test loss: 1.166, Test accuracy: 55.87
Round   4, Global train loss: 1.305, Global test loss: 1.676, Global test accuracy: 40.47
Round   5, Train loss: 1.272, Test loss: 1.137, Test accuracy: 56.96
Round   5, Global train loss: 1.272, Global test loss: 1.623, Global test accuracy: 43.62
Round   6, Train loss: 1.243, Test loss: 1.129, Test accuracy: 57.50
Round   6, Global train loss: 1.243, Global test loss: 1.585, Global test accuracy: 45.94
Round   7, Train loss: 1.212, Test loss: 1.135, Test accuracy: 56.61
Round   7, Global train loss: 1.212, Global test loss: 1.547, Global test accuracy: 47.63
Round   8, Train loss: 1.184, Test loss: 1.117, Test accuracy: 57.49
Round   8, Global train loss: 1.184, Global test loss: 1.512, Global test accuracy: 49.10
Round   9, Train loss: 1.154, Test loss: 1.126, Test accuracy: 57.42
Round   9, Global train loss: 1.154, Global test loss: 1.493, Global test accuracy: 49.51
Round  10, Train loss: 1.123, Test loss: 1.133, Test accuracy: 57.62
Round  10, Global train loss: 1.123, Global test loss: 1.725, Global test accuracy: 43.77
Round  11, Train loss: 0.987, Test loss: 1.154, Test accuracy: 56.99
Round  11, Global train loss: 0.987, Global test loss: 1.809, Global test accuracy: 42.21
Round  12, Train loss: 1.093, Test loss: 1.156, Test accuracy: 56.82
Round  12, Global train loss: 1.093, Global test loss: 1.811, Global test accuracy: 42.75
Round  13, Train loss: 0.995, Test loss: 1.168, Test accuracy: 56.80
Round  13, Global train loss: 0.995, Global test loss: 1.870, Global test accuracy: 38.03
Round  14, Train loss: 0.935, Test loss: 1.171, Test accuracy: 56.91
Round  14, Global train loss: 0.935, Global test loss: 1.682, Global test accuracy: 44.86
Round  15, Train loss: 0.874, Test loss: 1.182, Test accuracy: 56.85
Round  15, Global train loss: 0.874, Global test loss: 1.668, Global test accuracy: 46.24
Round  16, Train loss: 1.012, Test loss: 1.187, Test accuracy: 57.23
Round  16, Global train loss: 1.012, Global test loss: 1.562, Global test accuracy: 46.44
Round  17, Train loss: 0.898, Test loss: 1.194, Test accuracy: 57.15
Round  17, Global train loss: 0.898, Global test loss: 1.609, Global test accuracy: 46.11
Round  18, Train loss: 0.897, Test loss: 1.188, Test accuracy: 57.37
Round  18, Global train loss: 0.897, Global test loss: 1.672, Global test accuracy: 42.39
Round  19, Train loss: 0.923, Test loss: 1.212, Test accuracy: 57.33
Round  19, Global train loss: 0.923, Global test loss: 1.681, Global test accuracy: 45.28
Round  20, Train loss: 0.758, Test loss: 1.257, Test accuracy: 57.20
Round  20, Global train loss: 0.758, Global test loss: 1.617, Global test accuracy: 47.43
Round  21, Train loss: 0.865, Test loss: 1.246, Test accuracy: 57.63
Round  21, Global train loss: 0.865, Global test loss: 1.554, Global test accuracy: 48.19
Round  22, Train loss: 0.834, Test loss: 1.302, Test accuracy: 56.58
Round  22, Global train loss: 0.834, Global test loss: 1.680, Global test accuracy: 46.57
Round  23, Train loss: 0.710, Test loss: 1.315, Test accuracy: 56.88
Round  23, Global train loss: 0.710, Global test loss: 1.801, Global test accuracy: 44.16
Round  24, Train loss: 0.817, Test loss: 1.328, Test accuracy: 56.86
Round  24, Global train loss: 0.817, Global test loss: 1.628, Global test accuracy: 46.21
Round  25, Train loss: 0.826, Test loss: 1.361, Test accuracy: 56.57
Round  25, Global train loss: 0.826, Global test loss: 1.670, Global test accuracy: 46.57
Round  26, Train loss: 0.905, Test loss: 1.379, Test accuracy: 55.77
Round  26, Global train loss: 0.905, Global test loss: 1.604, Global test accuracy: 47.08
Round  27, Train loss: 0.624, Test loss: 1.361, Test accuracy: 55.61
Round  27, Global train loss: 0.624, Global test loss: 1.652, Global test accuracy: 48.79
Round  28, Train loss: 0.726, Test loss: 1.400, Test accuracy: 55.36
Round  28, Global train loss: 0.726, Global test loss: 1.583, Global test accuracy: 49.23
Round  29, Train loss: 0.540, Test loss: 1.396, Test accuracy: 55.81
Round  29, Global train loss: 0.540, Global test loss: 1.778, Global test accuracy: 47.81
Round  30, Train loss: 0.663, Test loss: 1.431, Test accuracy: 56.13
Round  30, Global train loss: 0.663, Global test loss: 1.865, Global test accuracy: 42.60
Round  31, Train loss: 0.766, Test loss: 1.463, Test accuracy: 55.82
Round  31, Global train loss: 0.766, Global test loss: 1.786, Global test accuracy: 43.74
Round  32, Train loss: 0.642, Test loss: 1.497, Test accuracy: 55.31
Round  32, Global train loss: 0.642, Global test loss: 1.849, Global test accuracy: 45.63
Round  33, Train loss: 0.748, Test loss: 1.512, Test accuracy: 55.57
Round  33, Global train loss: 0.748, Global test loss: 1.729, Global test accuracy: 44.82
Round  34, Train loss: 0.517, Test loss: 1.512, Test accuracy: 55.98
Round  34, Global train loss: 0.517, Global test loss: 1.791, Global test accuracy: 47.83
Round  35, Train loss: 0.551, Test loss: 1.543, Test accuracy: 56.25
Round  35, Global train loss: 0.551, Global test loss: 1.686, Global test accuracy: 49.83
Round  36, Train loss: 0.652, Test loss: 1.576, Test accuracy: 56.33
Round  36, Global train loss: 0.652, Global test loss: 2.348, Global test accuracy: 37.78
Round  37, Train loss: 0.630, Test loss: 1.553, Test accuracy: 56.56
Round  37, Global train loss: 0.630, Global test loss: 1.898, Global test accuracy: 43.77
Round  38, Train loss: 0.647, Test loss: 1.540, Test accuracy: 56.76
Round  38, Global train loss: 0.647, Global test loss: 1.945, Global test accuracy: 42.66
Round  39, Train loss: 0.620, Test loss: 1.572, Test accuracy: 55.59
Round  39, Global train loss: 0.620, Global test loss: 1.816, Global test accuracy: 45.87
Round  40, Train loss: 0.545, Test loss: 1.583, Test accuracy: 55.21
Round  40, Global train loss: 0.545, Global test loss: 1.811, Global test accuracy: 47.06
Round  41, Train loss: 0.590, Test loss: 1.612, Test accuracy: 55.43
Round  41, Global train loss: 0.590, Global test loss: 1.926, Global test accuracy: 45.49
Round  42, Train loss: 0.531, Test loss: 1.617, Test accuracy: 55.42
Round  42, Global train loss: 0.531, Global test loss: 1.880, Global test accuracy: 46.68
Round  43, Train loss: 0.463, Test loss: 1.641, Test accuracy: 55.54
Round  43, Global train loss: 0.463, Global test loss: 2.399, Global test accuracy: 44.48
Round  44, Train loss: 0.630, Test loss: 1.655, Test accuracy: 56.39
Round  44, Global train loss: 0.630, Global test loss: 1.856, Global test accuracy: 45.46
Round  45, Train loss: 0.436, Test loss: 1.664, Test accuracy: 56.21
Round  45, Global train loss: 0.436, Global test loss: 1.845, Global test accuracy: 48.98
Round  46, Train loss: 0.591, Test loss: 1.656, Test accuracy: 56.47
Round  46, Global train loss: 0.591, Global test loss: 1.961, Global test accuracy: 44.54
Round  47, Train loss: 0.620, Test loss: 1.659, Test accuracy: 56.93
Round  47, Global train loss: 0.620, Global test loss: 1.917, Global test accuracy: 43.84
Round  48, Train loss: 0.570, Test loss: 1.643, Test accuracy: 57.14
Round  48, Global train loss: 0.570, Global test loss: 2.030, Global test accuracy: 42.63
Round  49, Train loss: 0.565, Test loss: 1.675, Test accuracy: 57.01
Round  49, Global train loss: 0.565, Global test loss: 1.966, Global test accuracy: 42.38
Round  50, Train loss: 0.569, Test loss: 1.722, Test accuracy: 56.51
Round  50, Global train loss: 0.569, Global test loss: 2.047, Global test accuracy: 42.40
Round  51, Train loss: 0.501, Test loss: 1.733, Test accuracy: 56.19
Round  51, Global train loss: 0.501, Global test loss: 2.189, Global test accuracy: 39.84
Round  52, Train loss: 0.429, Test loss: 1.715, Test accuracy: 56.36
Round  52, Global train loss: 0.429, Global test loss: 1.954, Global test accuracy: 46.90
Round  53, Train loss: 0.512, Test loss: 1.737, Test accuracy: 55.90
Round  53, Global train loss: 0.512, Global test loss: 1.972, Global test accuracy: 46.78
Round  54, Train loss: 0.466, Test loss: 1.760, Test accuracy: 56.09
Round  54, Global train loss: 0.466, Global test loss: 2.196, Global test accuracy: 45.00
Round  55, Train loss: 0.362, Test loss: 1.754, Test accuracy: 56.26
Round  55, Global train loss: 0.362, Global test loss: 2.471, Global test accuracy: 42.34
Round  56, Train loss: 0.519, Test loss: 1.764, Test accuracy: 56.13
Round  56, Global train loss: 0.519, Global test loss: 1.913, Global test accuracy: 46.78
Round  57, Train loss: 0.550, Test loss: 1.769, Test accuracy: 56.04
Round  57, Global train loss: 0.550, Global test loss: 1.975, Global test accuracy: 45.67
Round  58, Train loss: 0.521, Test loss: 1.785, Test accuracy: 55.81
Round  58, Global train loss: 0.521, Global test loss: 2.165, Global test accuracy: 42.52
Round  59, Train loss: 0.485, Test loss: 1.798, Test accuracy: 55.82
Round  59, Global train loss: 0.485, Global test loss: 1.971, Global test accuracy: 44.84
Round  60, Train loss: 0.465, Test loss: 1.842, Test accuracy: 55.13
Round  60, Global train loss: 0.465, Global test loss: 2.059, Global test accuracy: 46.16
Round  61, Train loss: 0.433, Test loss: 1.862, Test accuracy: 55.42
Round  61, Global train loss: 0.433, Global test loss: 2.113, Global test accuracy: 46.37
Round  62, Train loss: 0.414, Test loss: 1.845, Test accuracy: 55.38
Round  62, Global train loss: 0.414, Global test loss: 2.291, Global test accuracy: 44.28
Round  63, Train loss: 0.528, Test loss: 1.823, Test accuracy: 55.81
Round  63, Global train loss: 0.528, Global test loss: 2.207, Global test accuracy: 41.28
Round  64, Train loss: 0.462, Test loss: 1.864, Test accuracy: 55.43
Round  64, Global train loss: 0.462, Global test loss: 2.356, Global test accuracy: 41.05
Round  65, Train loss: 0.436, Test loss: 1.871, Test accuracy: 55.42
Round  65, Global train loss: 0.436, Global test loss: 2.146, Global test accuracy: 45.60
Round  66, Train loss: 0.421, Test loss: 1.890, Test accuracy: 55.27
Round  66, Global train loss: 0.421, Global test loss: 1.980, Global test accuracy: 45.53
Round  67, Train loss: 0.475, Test loss: 1.906, Test accuracy: 55.40
Round  67, Global train loss: 0.475, Global test loss: 2.074, Global test accuracy: 45.22
Round  68, Train loss: 0.436, Test loss: 1.895, Test accuracy: 55.60
Round  68, Global train loss: 0.436, Global test loss: 2.323, Global test accuracy: 42.21
Round  69, Train loss: 0.514, Test loss: 1.916, Test accuracy: 55.82
Round  69, Global train loss: 0.514, Global test loss: 2.158, Global test accuracy: 41.30
Round  70, Train loss: 0.417, Test loss: 1.912, Test accuracy: 56.22
Round  70, Global train loss: 0.417, Global test loss: 2.322, Global test accuracy: 40.58
Round  71, Train loss: 0.446, Test loss: 1.936, Test accuracy: 56.15
Round  71, Global train loss: 0.446, Global test loss: 2.259, Global test accuracy: 43.56
Round  72, Train loss: 0.393, Test loss: 1.926, Test accuracy: 56.30
Round  72, Global train loss: 0.393, Global test loss: 2.169, Global test accuracy: 45.46
Round  73, Train loss: 0.426, Test loss: 1.925, Test accuracy: 56.31
Round  73, Global train loss: 0.426, Global test loss: 2.115, Global test accuracy: 45.69
Round  74, Train loss: 0.366, Test loss: 1.945, Test accuracy: 56.40
Round  74, Global train loss: 0.366, Global test loss: 2.076, Global test accuracy: 46.60
Round  75, Train loss: 0.399, Test loss: 1.921, Test accuracy: 56.43
Round  75, Global train loss: 0.399, Global test loss: 2.513, Global test accuracy: 41.21
Round  76, Train loss: 0.421, Test loss: 1.939, Test accuracy: 56.59
Round  76, Global train loss: 0.421, Global test loss: 2.414, Global test accuracy: 43.62
Round  77, Train loss: 0.351, Test loss: 1.926, Test accuracy: 56.59
Round  77, Global train loss: 0.351, Global test loss: 2.077, Global test accuracy: 47.79
Round  78, Train loss: 0.428, Test loss: 1.916, Test accuracy: 56.71
Round  78, Global train loss: 0.428, Global test loss: 2.341, Global test accuracy: 42.86
Round  79, Train loss: 0.361, Test loss: 1.936, Test accuracy: 56.72
Round  79, Global train loss: 0.361, Global test loss: 2.187, Global test accuracy: 44.80
Round  80, Train loss: 0.309, Test loss: 1.989, Test accuracy: 56.11
Round  80, Global train loss: 0.309, Global test loss: 2.158, Global test accuracy: 47.88
Round  81, Train loss: 0.303, Test loss: 1.935, Test accuracy: 57.40
Round  81, Global train loss: 0.303, Global test loss: 2.134, Global test accuracy: 48.05
Round  82, Train loss: 0.269, Test loss: 1.912, Test accuracy: 57.57
Round  82, Global train loss: 0.269, Global test loss: 2.162, Global test accuracy: 49.25
Round  83, Train loss: 0.249, Test loss: 2.000, Test accuracy: 56.76
Round  83, Global train loss: 0.249, Global test loss: 2.224, Global test accuracy: 48.99
Round  84, Train loss: 0.246, Test loss: 1.968, Test accuracy: 57.08
Round  84, Global train loss: 0.246, Global test loss: 2.234, Global test accuracy: 48.29
Round  85, Train loss: 0.240, Test loss: 1.955, Test accuracy: 57.09
Round  85, Global train loss: 0.240, Global test loss: 2.182, Global test accuracy: 49.33
Round  86, Train loss: 0.230, Test loss: 1.945, Test accuracy: 57.19
Round  86, Global train loss: 0.230, Global test loss: 2.230, Global test accuracy: 49.04
Round  87, Train loss: 0.219, Test loss: 1.975, Test accuracy: 57.29
Round  87, Global train loss: 0.219, Global test loss: 2.202, Global test accuracy: 49.65
Round  88, Train loss: 0.218, Test loss: 1.979, Test accuracy: 57.03
Round  88, Global train loss: 0.218, Global test loss: 2.258, Global test accuracy: 48.47
Round  89, Train loss: 0.209, Test loss: 2.002, Test accuracy: 57.02
Round  89, Global train loss: 0.209, Global test loss: 2.276, Global test accuracy: 48.97
Round  90, Train loss: 0.394, Test loss: 1.992, Test accuracy: 56.11
Round  90, Global train loss: 0.394, Global test loss: 1.953, Global test accuracy: 48.96
Round  91, Train loss: 0.362, Test loss: 2.005, Test accuracy: 56.27
Round  91, Global train loss: 0.362, Global test loss: 1.935, Global test accuracy: 49.49
Round  92, Train loss: 0.353, Test loss: 1.979, Test accuracy: 56.82
Round  92, Global train loss: 0.353, Global test loss: 1.941, Global test accuracy: 49.15
Round  93, Train loss: 0.343, Test loss: 1.981, Test accuracy: 56.50
Round  93, Global train loss: 0.343, Global test loss: 1.944, Global test accuracy: 49.30
Round  94, Train loss: 0.338, Test loss: 2.017, Test accuracy: 57.37
Round  94, Global train loss: 0.338, Global test loss: 1.945, Global test accuracy: 49.08
Round  95, Train loss: 0.334, Test loss: 2.037, Test accuracy: 56.76
Round  95, Global train loss: 0.334, Global test loss: 1.952, Global test accuracy: 48.87
Round  96, Train loss: 0.329, Test loss: 2.012, Test accuracy: 57.12
Round  96, Global train loss: 0.329, Global test loss: 1.949, Global test accuracy: 49.13
Round  97, Train loss: 0.325, Test loss: 2.013, Test accuracy: 56.01
Round  97, Global train loss: 0.325, Global test loss: 1.961, Global test accuracy: 49.02
Round  98, Train loss: 0.320, Test loss: 2.091, Test accuracy: 55.81
Round  98, Global train loss: 0.320, Global test loss: 1.966, Global test accuracy: 48.66
Round  99, Train loss: 0.320, Test loss: 2.076, Test accuracy: 56.69
Round  99, Global train loss: 0.320, Global test loss: 1.978, Global test accuracy: 49.64
Final Round, Train loss: 0.235, Test loss: 2.264, Test accuracy: 56.45
Final Round, Global train loss: 0.235, Global test loss: 1.978, Global test accuracy: 49.64
Average accuracy final 10 rounds: 56.54600000000001
Average global accuracy final 10 rounds: 49.129999999999995
4864.627176523209
[3.2295563220977783, 6.192638635635376, 9.318226337432861, 11.633838653564453, 14.415332555770874, 17.348447561264038, 19.95415449142456, 22.86561894416809, 25.96565270423889, 30.069727420806885, 32.93616962432861, 35.990307569503784, 39.11673426628113, 42.163968563079834, 44.88597559928894, 47.385990381240845, 49.35785913467407, 51.344531297683716, 53.624327421188354, 55.99040412902832, 58.008718490600586, 63.899476289749146, 69.17521667480469, 75.17021441459656, 80.42855072021484, 86.72232222557068, 92.96250748634338, 98.24194025993347, 104.33619618415833, 109.50296473503113, 115.59713768959045, 121.23012280464172, 126.40653896331787, 132.25099110603333, 137.28418588638306, 143.4671015739441, 149.24802017211914, 155.46511363983154, 161.5953209400177, 167.65811705589294, 174.28803825378418, 180.39419603347778, 186.6844503879547, 193.16360425949097, 199.3787705898285, 205.940776348114, 212.32767271995544, 218.56448554992676, 225.38404250144958, 231.4375865459442, 237.98566007614136, 244.72157168388367, 250.90515184402466, 257.6943550109863, 263.9516613483429, 270.0614855289459, 276.98716497421265, 283.08469915390015, 289.5793488025665, 296.59955525398254, 302.81518816947937, 309.755606174469, 315.9919002056122, 322.50283789634705, 328.9885151386261, 335.12306571006775, 341.6391360759735, 348.3030846118927, 354.5577609539032, 361.78272461891174, 367.9498288631439, 374.3363492488861, 381.0778901576996, 387.2426989078522, 393.8764407634735, 400.6483509540558, 407.0054614543915, 414.6643385887146, 421.5035011768341, 427.7737936973572, 434.08296179771423, 441.0865228176117, 447.703736782074, 453.3355221748352, 459.2571840286255, 465.63590383529663, 471.35374689102173, 477.41396403312683, 482.5871696472168, 488.5777084827423, 494.3951573371887, 500.1953570842743, 505.86533999443054, 511.9194383621216, 517.9565260410309, 523.6726357936859, 529.665854215622, 535.3447864055634, 541.0318169593811, 547.3793940544128, 552.0013384819031]
[40.19, 47.35, 52.65, 54.75, 55.87, 56.96, 57.5, 56.61, 57.49, 57.42, 57.62, 56.99, 56.82, 56.8, 56.91, 56.85, 57.23, 57.15, 57.37, 57.33, 57.2, 57.63, 56.58, 56.88, 56.86, 56.57, 55.77, 55.61, 55.36, 55.81, 56.13, 55.82, 55.31, 55.57, 55.98, 56.25, 56.33, 56.56, 56.76, 55.59, 55.21, 55.43, 55.42, 55.54, 56.39, 56.21, 56.47, 56.93, 57.14, 57.01, 56.51, 56.19, 56.36, 55.9, 56.09, 56.26, 56.13, 56.04, 55.81, 55.82, 55.13, 55.42, 55.38, 55.81, 55.43, 55.42, 55.27, 55.4, 55.6, 55.82, 56.22, 56.15, 56.3, 56.31, 56.4, 56.43, 56.59, 56.59, 56.71, 56.72, 56.11, 57.4, 57.57, 56.76, 57.08, 57.09, 57.19, 57.29, 57.03, 57.02, 56.11, 56.27, 56.82, 56.5, 57.37, 56.76, 57.12, 56.01, 55.81, 56.69, 56.45]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.738, Test loss: 1.743, Test accuracy: 26.78
Round   1, Train loss: 1.501, Test loss: 1.439, Test accuracy: 38.85
Round   2, Train loss: 1.410, Test loss: 1.325, Test accuracy: 43.67
Round   3, Train loss: 1.349, Test loss: 1.251, Test accuracy: 48.67
Round   4, Train loss: 1.302, Test loss: 1.178, Test accuracy: 53.19
Round   5, Train loss: 1.269, Test loss: 1.126, Test accuracy: 56.42
Round   6, Train loss: 1.240, Test loss: 1.101, Test accuracy: 57.14
Round   7, Train loss: 1.215, Test loss: 1.073, Test accuracy: 59.33
Round   8, Train loss: 1.195, Test loss: 1.049, Test accuracy: 59.53
Round   9, Train loss: 1.174, Test loss: 1.037, Test accuracy: 61.42
Round  10, Train loss: 1.157, Test loss: 1.035, Test accuracy: 60.72
Round  11, Train loss: 1.136, Test loss: 1.014, Test accuracy: 62.08
Round  12, Train loss: 1.119, Test loss: 0.985, Test accuracy: 63.33
Round  13, Train loss: 1.100, Test loss: 0.981, Test accuracy: 63.65
Round  14, Train loss: 1.084, Test loss: 0.994, Test accuracy: 62.45
Round  15, Train loss: 1.063, Test loss: 0.963, Test accuracy: 64.23
Round  16, Train loss: 1.043, Test loss: 0.946, Test accuracy: 64.62
Round  17, Train loss: 1.028, Test loss: 0.946, Test accuracy: 65.41
Round  18, Train loss: 1.009, Test loss: 0.940, Test accuracy: 65.81
Round  19, Train loss: 0.994, Test loss: 0.960, Test accuracy: 64.68
Round  20, Train loss: 0.924, Test loss: 0.962, Test accuracy: 64.92
Round  21, Train loss: 1.011, Test loss: 0.937, Test accuracy: 65.55
Round  22, Train loss: 0.895, Test loss: 0.925, Test accuracy: 66.03
Round  23, Train loss: 0.988, Test loss: 0.924, Test accuracy: 65.80
Round  24, Train loss: 0.893, Test loss: 0.935, Test accuracy: 65.23
Round  25, Train loss: 0.955, Test loss: 0.931, Test accuracy: 65.71
Round  26, Train loss: 0.965, Test loss: 0.945, Test accuracy: 64.82
Round  27, Train loss: 0.933, Test loss: 0.950, Test accuracy: 65.31
Round  28, Train loss: 0.883, Test loss: 0.944, Test accuracy: 65.34
Round  29, Train loss: 0.885, Test loss: 0.959, Test accuracy: 64.81
Round  30, Train loss: 0.966, Test loss: 0.965, Test accuracy: 64.81
Round  31, Train loss: 0.841, Test loss: 0.956, Test accuracy: 64.94
Round  32, Train loss: 0.808, Test loss: 0.954, Test accuracy: 66.05
Round  33, Train loss: 0.796, Test loss: 0.970, Test accuracy: 65.34
Round  34, Train loss: 0.781, Test loss: 1.004, Test accuracy: 64.34
Round  35, Train loss: 0.768, Test loss: 0.974, Test accuracy: 65.25
Round  36, Train loss: 0.621, Test loss: 0.967, Test accuracy: 65.50
Round  37, Train loss: 0.728, Test loss: 0.985, Test accuracy: 64.61
Round  38, Train loss: 0.852, Test loss: 1.004, Test accuracy: 64.60
Round  39, Train loss: 0.808, Test loss: 0.992, Test accuracy: 65.24
Round  40, Train loss: 0.738, Test loss: 0.986, Test accuracy: 65.47
Round  41, Train loss: 0.660, Test loss: 0.980, Test accuracy: 65.40
Round  42, Train loss: 0.534, Test loss: 0.964, Test accuracy: 65.82
Round  43, Train loss: 0.860, Test loss: 1.000, Test accuracy: 64.91
Round  44, Train loss: 0.755, Test loss: 1.017, Test accuracy: 64.10
Round  45, Train loss: 0.670, Test loss: 1.039, Test accuracy: 64.49
Round  46, Train loss: 0.550, Test loss: 1.030, Test accuracy: 64.70
Round  47, Train loss: 0.642, Test loss: 1.033, Test accuracy: 64.26
Round  48, Train loss: 0.721, Test loss: 1.040, Test accuracy: 63.77
Round  49, Train loss: 0.609, Test loss: 1.044, Test accuracy: 64.27
Round  50, Train loss: 0.729, Test loss: 1.078, Test accuracy: 63.30
Round  51, Train loss: 0.643, Test loss: 1.075, Test accuracy: 63.32
Round  52, Train loss: 0.806, Test loss: 1.079, Test accuracy: 63.33
Round  53, Train loss: 0.691, Test loss: 1.129, Test accuracy: 62.74
Round  54, Train loss: 0.597, Test loss: 1.090, Test accuracy: 63.31
Round  55, Train loss: 0.400, Test loss: 1.097, Test accuracy: 62.98
Round  56, Train loss: 0.637, Test loss: 1.129, Test accuracy: 62.13
Round  57, Train loss: 0.550, Test loss: 1.100, Test accuracy: 62.79
Round  58, Train loss: 0.730, Test loss: 1.121, Test accuracy: 62.85
Round  59, Train loss: 0.619, Test loss: 1.111, Test accuracy: 62.85
Round  60, Train loss: 0.618, Test loss: 1.151, Test accuracy: 62.19
Round  61, Train loss: 0.624, Test loss: 1.162, Test accuracy: 62.14
Round  62, Train loss: 0.512, Test loss: 1.162, Test accuracy: 61.99
Round  63, Train loss: 0.651, Test loss: 1.169, Test accuracy: 62.05
Round  64, Train loss: 0.537, Test loss: 1.160, Test accuracy: 62.08
Round  65, Train loss: 0.607, Test loss: 1.138, Test accuracy: 61.87
Round  66, Train loss: 0.419, Test loss: 1.156, Test accuracy: 62.51
Round  67, Train loss: 0.678, Test loss: 1.187, Test accuracy: 62.17
Round  68, Train loss: 0.613, Test loss: 1.174, Test accuracy: 62.13
Round  69, Train loss: 0.649, Test loss: 1.223, Test accuracy: 60.93
Round  70, Train loss: 0.529, Test loss: 1.205, Test accuracy: 60.99
Round  71, Train loss: 0.580, Test loss: 1.209, Test accuracy: 61.41
Round  72, Train loss: 0.529, Test loss: 1.256, Test accuracy: 61.02
Round  73, Train loss: 0.637, Test loss: 1.227, Test accuracy: 61.13
Round  74, Train loss: 0.512, Test loss: 1.239, Test accuracy: 60.93
Round  75, Train loss: 0.614, Test loss: 1.307, Test accuracy: 59.89
Round  76, Train loss: 0.485, Test loss: 1.260, Test accuracy: 60.62
Round  77, Train loss: 0.557, Test loss: 1.297, Test accuracy: 60.69
Round  78, Train loss: 0.440, Test loss: 1.272, Test accuracy: 60.33
Round  79, Train loss: 0.418, Test loss: 1.278, Test accuracy: 60.77
Round  80, Train loss: 0.337, Test loss: 1.238, Test accuracy: 61.82
Round  81, Train loss: 0.312, Test loss: 1.267, Test accuracy: 61.37
Round  82, Train loss: 0.287, Test loss: 1.264, Test accuracy: 61.96
Round  83, Train loss: 0.286, Test loss: 1.288, Test accuracy: 61.27
Round  84, Train loss: 0.280, Test loss: 1.272, Test accuracy: 62.55
Round  85, Train loss: 0.252, Test loss: 1.289, Test accuracy: 62.28
Round  86, Train loss: 0.258, Test loss: 1.299, Test accuracy: 62.31
Round  87, Train loss: 0.251, Test loss: 1.312, Test accuracy: 62.05
Round  88, Train loss: 0.238, Test loss: 1.311, Test accuracy: 61.91
Round  89, Train loss: 0.235, Test loss: 1.334, Test accuracy: 61.62
Round  90, Train loss: 0.495, Test loss: 1.315, Test accuracy: 61.01
Round  91, Train loss: 0.473, Test loss: 1.352, Test accuracy: 60.45
Round  92, Train loss: 0.460, Test loss: 1.342, Test accuracy: 61.00
Round  93, Train loss: 0.456, Test loss: 1.364, Test accuracy: 60.43
Round  94, Train loss: 0.447, Test loss: 1.388, Test accuracy: 60.10
Round  95, Train loss: 0.440, Test loss: 1.360, Test accuracy: 60.84
Round  96, Train loss: 0.439, Test loss: 1.395, Test accuracy: 59.91
Round  97, Train loss: 0.437, Test loss: 1.373, Test accuracy: 60.75
Round  98, Train loss: 0.423, Test loss: 1.386, Test accuracy: 60.63
Round  99, Train loss: 0.437, Test loss: 1.447, Test accuracy: 59.92
Final Round, Train loss: 0.412, Test loss: 1.382, Test accuracy: 60.32
Average accuracy final 10 rounds: 60.504000000000005
4133.34881067276
[2.7116518020629883, 5.132999420166016, 7.575345516204834, 9.720816612243652, 12.228466033935547, 15.001084327697754, 17.53090262413025, 19.666549682617188, 22.111711263656616, 24.458184242248535, 26.589759588241577, 28.985155820846558, 31.63805842399597, 34.15098309516907, 36.303834199905396, 38.63065528869629, 41.378536224365234, 43.714091777801514, 46.04889678955078, 48.372833251953125, 50.67193937301636, 55.68112373352051, 59.62657690048218, 63.618618965148926, 68.36569452285767, 72.39684200286865, 76.97971677780151, 81.01500725746155, 85.75441074371338, 89.99405169487, 94.028311252594, 98.5778968334198, 102.59082579612732, 106.79961395263672, 110.83887147903442, 114.94751739501953, 119.17117381095886, 123.20040535926819, 127.91089701652527, 131.8738293647766, 136.1853380203247, 140.16703486442566, 144.140629529953, 148.59990859031677, 152.580552816391, 157.10574889183044, 161.55368065834045, 166.6442530155182, 171.24880957603455, 176.12149715423584, 180.82270455360413, 185.4330916404724, 190.49225902557373, 195.12431812286377, 199.8849766254425, 204.47819662094116, 209.34097385406494, 213.98270654678345, 218.93076467514038, 223.5057384967804, 228.71962881088257, 233.3477373123169, 238.67840003967285, 243.3495421409607, 248.7026083469391, 253.7351851463318, 258.7183909416199, 264.3245964050293, 268.96480321884155, 275.0271153450012, 279.6673023700714, 284.75197172164917, 289.37577986717224, 294.7886161804199, 299.44651317596436, 304.74485778808594, 309.409485578537, 314.34737062454224, 318.91567397117615, 324.12605237960815, 328.7717773914337, 333.6709203720093, 338.75506019592285, 343.77443170547485, 348.7228581905365, 353.42395663261414, 358.3024260997772, 363.27635526657104, 368.2597405910492, 372.97852540016174, 378.2118606567383, 383.44963908195496, 388.7187056541443, 394.1195924282074, 399.62029123306274, 404.9117863178253, 410.4596152305603, 415.6917760372162, 421.1770496368408, 426.61538195610046, 431.31084871292114]
[26.78, 38.85, 43.67, 48.67, 53.19, 56.42, 57.14, 59.33, 59.53, 61.42, 60.72, 62.08, 63.33, 63.65, 62.45, 64.23, 64.62, 65.41, 65.81, 64.68, 64.92, 65.55, 66.03, 65.8, 65.23, 65.71, 64.82, 65.31, 65.34, 64.81, 64.81, 64.94, 66.05, 65.34, 64.34, 65.25, 65.5, 64.61, 64.6, 65.24, 65.47, 65.4, 65.82, 64.91, 64.1, 64.49, 64.7, 64.26, 63.77, 64.27, 63.3, 63.32, 63.33, 62.74, 63.31, 62.98, 62.13, 62.79, 62.85, 62.85, 62.19, 62.14, 61.99, 62.05, 62.08, 61.87, 62.51, 62.17, 62.13, 60.93, 60.99, 61.41, 61.02, 61.13, 60.93, 59.89, 60.62, 60.69, 60.33, 60.77, 61.82, 61.37, 61.96, 61.27, 62.55, 62.28, 62.31, 62.05, 61.91, 61.62, 61.01, 60.45, 61.0, 60.43, 60.1, 60.84, 59.91, 60.75, 60.63, 59.92, 60.32]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.780, Test loss: 1.675, Test accuracy: 34.31
Round   1, Train loss: 1.508, Test loss: 1.403, Test accuracy: 41.42
Round   2, Train loss: 1.418, Test loss: 1.281, Test accuracy: 46.32
Round   3, Train loss: 1.359, Test loss: 1.211, Test accuracy: 51.23
Round   4, Train loss: 1.318, Test loss: 1.161, Test accuracy: 54.00
Round   5, Train loss: 1.292, Test loss: 1.136, Test accuracy: 56.83
Round   6, Train loss: 1.270, Test loss: 1.125, Test accuracy: 57.61
Round   7, Train loss: 1.250, Test loss: 1.083, Test accuracy: 59.06
Round   8, Train loss: 1.233, Test loss: 1.072, Test accuracy: 60.89
Round   9, Train loss: 1.216, Test loss: 1.028, Test accuracy: 61.77
Round  10, Train loss: 1.041, Test loss: 1.000, Test accuracy: 62.27
Round  11, Train loss: 1.075, Test loss: 0.989, Test accuracy: 63.08
Round  12, Train loss: 1.266, Test loss: 1.016, Test accuracy: 62.89
Round  13, Train loss: 1.071, Test loss: 0.979, Test accuracy: 63.86
Round  14, Train loss: 0.944, Test loss: 0.946, Test accuracy: 64.38
Round  15, Train loss: 0.986, Test loss: 0.947, Test accuracy: 65.10
Round  16, Train loss: 1.352, Test loss: 0.978, Test accuracy: 63.79
Round  17, Train loss: 1.141, Test loss: 0.968, Test accuracy: 65.55
Round  18, Train loss: 1.203, Test loss: 0.977, Test accuracy: 64.82
Round  19, Train loss: 1.052, Test loss: 0.956, Test accuracy: 65.69
Round  20, Train loss: 0.978, Test loss: 0.941, Test accuracy: 65.61
Round  21, Train loss: 1.058, Test loss: 0.938, Test accuracy: 66.18
Round  22, Train loss: 1.000, Test loss: 0.930, Test accuracy: 65.80
Round  23, Train loss: 1.104, Test loss: 0.950, Test accuracy: 65.12
Round  24, Train loss: 0.886, Test loss: 0.917, Test accuracy: 65.79
Round  25, Train loss: 1.053, Test loss: 0.919, Test accuracy: 66.32
Round  26, Train loss: 1.038, Test loss: 0.915, Test accuracy: 66.70
Round  27, Train loss: 0.994, Test loss: 0.913, Test accuracy: 66.64
Round  28, Train loss: 0.783, Test loss: 0.894, Test accuracy: 67.00
Round  29, Train loss: 0.929, Test loss: 0.915, Test accuracy: 66.86
Round  30, Train loss: 1.008, Test loss: 0.912, Test accuracy: 66.76
Round  31, Train loss: 1.013, Test loss: 0.929, Test accuracy: 66.09
Round  32, Train loss: 0.970, Test loss: 0.918, Test accuracy: 66.27
Round  33, Train loss: 1.019, Test loss: 0.913, Test accuracy: 66.52
Round  34, Train loss: 0.730, Test loss: 0.891, Test accuracy: 67.24
Round  35, Train loss: 0.928, Test loss: 0.916, Test accuracy: 67.10
Round  36, Train loss: 0.953, Test loss: 0.953, Test accuracy: 65.23
Round  37, Train loss: 0.883, Test loss: 0.920, Test accuracy: 66.12
Round  38, Train loss: 0.975, Test loss: 0.936, Test accuracy: 65.52
Round  39, Train loss: 0.682, Test loss: 0.900, Test accuracy: 66.86
Round  40, Train loss: 0.786, Test loss: 0.908, Test accuracy: 66.00
Round  41, Train loss: 0.661, Test loss: 0.891, Test accuracy: 67.37
Round  42, Train loss: 0.836, Test loss: 0.919, Test accuracy: 66.73
Round  43, Train loss: 0.785, Test loss: 0.919, Test accuracy: 66.56
Round  44, Train loss: 0.870, Test loss: 0.953, Test accuracy: 65.24
Round  45, Train loss: 0.715, Test loss: 0.949, Test accuracy: 65.22
Round  46, Train loss: 0.826, Test loss: 0.957, Test accuracy: 65.27
Round  47, Train loss: 0.884, Test loss: 0.967, Test accuracy: 64.34
Round  48, Train loss: 0.898, Test loss: 0.991, Test accuracy: 64.20
Round  49, Train loss: 0.761, Test loss: 0.988, Test accuracy: 64.11
Round  50, Train loss: 0.887, Test loss: 1.009, Test accuracy: 62.62
Round  51, Train loss: 0.775, Test loss: 0.999, Test accuracy: 63.15
Round  52, Train loss: 0.823, Test loss: 0.974, Test accuracy: 63.81
Round  53, Train loss: 0.626, Test loss: 0.941, Test accuracy: 65.10
Round  54, Train loss: 0.664, Test loss: 0.944, Test accuracy: 65.06
Round  55, Train loss: 0.745, Test loss: 1.002, Test accuracy: 63.24
Round  56, Train loss: 0.582, Test loss: 0.958, Test accuracy: 65.11
Round  57, Train loss: 0.643, Test loss: 0.939, Test accuracy: 65.99
Round  58, Train loss: 0.754, Test loss: 0.976, Test accuracy: 64.78
Round  59, Train loss: 0.776, Test loss: 0.987, Test accuracy: 64.48
Round  60, Train loss: 0.694, Test loss: 0.999, Test accuracy: 63.80
Round  61, Train loss: 0.533, Test loss: 0.969, Test accuracy: 64.91
Round  62, Train loss: 0.556, Test loss: 0.968, Test accuracy: 65.02
Round  63, Train loss: 0.820, Test loss: 1.007, Test accuracy: 63.93
Round  64, Train loss: 0.519, Test loss: 0.965, Test accuracy: 65.04
Round  65, Train loss: 0.726, Test loss: 0.971, Test accuracy: 64.66
Round  66, Train loss: 0.567, Test loss: 0.989, Test accuracy: 64.18
Round  67, Train loss: 0.691, Test loss: 1.012, Test accuracy: 63.83
Round  68, Train loss: 0.621, Test loss: 1.001, Test accuracy: 63.65
Round  69, Train loss: 0.719, Test loss: 1.051, Test accuracy: 62.53
Round  70, Train loss: 0.710, Test loss: 1.098, Test accuracy: 61.44
Round  71, Train loss: 0.647, Test loss: 1.053, Test accuracy: 62.25
Round  72, Train loss: 0.630, Test loss: 1.052, Test accuracy: 62.82
Round  73, Train loss: 0.705, Test loss: 1.052, Test accuracy: 62.47
Round  74, Train loss: 0.603, Test loss: 1.030, Test accuracy: 63.03
Round  75, Train loss: 0.564, Test loss: 1.034, Test accuracy: 63.03
Round  76, Train loss: 0.557, Test loss: 1.039, Test accuracy: 63.43
Round  77, Train loss: 0.612, Test loss: 1.047, Test accuracy: 63.12
Round  78, Train loss: 0.580, Test loss: 1.061, Test accuracy: 62.28
Round  79, Train loss: 0.478, Test loss: 1.058, Test accuracy: 62.45
Round  80, Train loss: 0.395, Test loss: 0.998, Test accuracy: 65.10
Round  81, Train loss: 0.367, Test loss: 0.990, Test accuracy: 65.58
Round  82, Train loss: 0.352, Test loss: 0.990, Test accuracy: 65.28
Round  83, Train loss: 0.341, Test loss: 0.975, Test accuracy: 65.80
Round  84, Train loss: 0.319, Test loss: 0.983, Test accuracy: 66.20
Round  85, Train loss: 0.304, Test loss: 0.991, Test accuracy: 65.81
Round  86, Train loss: 0.300, Test loss: 1.009, Test accuracy: 66.08
Round  87, Train loss: 0.294, Test loss: 0.981, Test accuracy: 66.83
Round  88, Train loss: 0.284, Test loss: 0.993, Test accuracy: 65.98
Round  89, Train loss: 0.276, Test loss: 0.998, Test accuracy: 65.79
Round  90, Train loss: 0.541, Test loss: 1.038, Test accuracy: 64.23
Round  91, Train loss: 0.522, Test loss: 1.061, Test accuracy: 64.02
Round  92, Train loss: 0.511, Test loss: 1.063, Test accuracy: 63.63
Round  93, Train loss: 0.510, Test loss: 1.075, Test accuracy: 63.66
Round  94, Train loss: 0.488, Test loss: 1.072, Test accuracy: 63.34
Round  95, Train loss: 0.486, Test loss: 1.081, Test accuracy: 63.20
Round  96, Train loss: 0.486, Test loss: 1.084, Test accuracy: 63.65
Round  97, Train loss: 0.483, Test loss: 1.092, Test accuracy: 63.20
Round  98, Train loss: 0.481, Test loss: 1.113, Test accuracy: 62.39
Round  99, Train loss: 0.471, Test loss: 1.093, Test accuracy: 63.22
Final Round, Train loss: 0.491, Test loss: 1.114, Test accuracy: 62.72
Average accuracy final 10 rounds: 63.454
4947.684578418732
[3.240696907043457, 6.31226658821106, 9.271666288375854, 12.270098686218262, 15.432936191558838, 18.365323781967163, 21.701801538467407, 24.727939128875732, 27.884818077087402, 31.054993391036987, 33.90650820732117, 36.58793258666992, 39.24471664428711, 42.50908350944519, 45.25010418891907, 47.88360857963562, 50.51906442642212, 53.455212116241455, 56.0734224319458, 58.695013999938965, 61.26726031303406, 67.77871656417847, 73.64163780212402, 80.2447440624237, 87.3069498538971, 93.98620104789734, 100.97043919563293, 106.9822678565979, 113.66761994361877, 119.76194548606873, 126.34567904472351, 132.96216011047363, 138.95443439483643, 146.1035554409027, 152.08486461639404, 158.73395419120789, 165.23474216461182, 172.01529097557068, 178.33218431472778, 184.73309421539307, 191.1720986366272, 197.40223240852356, 204.31735968589783, 210.87929582595825, 217.34584307670593, 223.8919334411621, 230.34871315956116, 236.80060267448425, 243.29535722732544, 249.66443729400635, 256.0023543834686, 262.50415658950806, 269.15812945365906, 275.4486186504364, 281.9654595851898, 288.19364380836487, 294.49265003204346, 300.9736113548279, 307.27926754951477, 313.53343391418457, 319.44270491600037, 325.2269916534424, 330.93250155448914, 336.7716896533966, 342.8877091407776, 348.88583302497864, 354.6733980178833, 360.64570116996765, 366.40962862968445, 372.67054080963135, 378.8037271499634, 384.49633049964905, 390.17100977897644, 396.05679726600647, 401.93661403656006, 407.7880480289459, 414.0045835971832, 420.1407742500305, 425.8471338748932, 431.8673710823059, 437.75397181510925, 443.81215715408325, 449.6173348426819, 455.67770433425903, 461.67193126678467, 467.95024514198303, 474.45042729377747, 481.06546235084534, 487.3945457935333, 494.0385582447052, 500.20928049087524, 506.94215297698975, 513.6186330318451, 520.628674030304, 527.2808713912964, 533.725777387619, 540.3892595767975, 547.0092256069183, 553.6441648006439, 559.8325433731079, 564.2995522022247]
[34.31, 41.42, 46.32, 51.23, 54.0, 56.83, 57.61, 59.06, 60.89, 61.77, 62.27, 63.08, 62.89, 63.86, 64.38, 65.1, 63.79, 65.55, 64.82, 65.69, 65.61, 66.18, 65.8, 65.12, 65.79, 66.32, 66.7, 66.64, 67.0, 66.86, 66.76, 66.09, 66.27, 66.52, 67.24, 67.1, 65.23, 66.12, 65.52, 66.86, 66.0, 67.37, 66.73, 66.56, 65.24, 65.22, 65.27, 64.34, 64.2, 64.11, 62.62, 63.15, 63.81, 65.1, 65.06, 63.24, 65.11, 65.99, 64.78, 64.48, 63.8, 64.91, 65.02, 63.93, 65.04, 64.66, 64.18, 63.83, 63.65, 62.53, 61.44, 62.25, 62.82, 62.47, 63.03, 63.03, 63.43, 63.12, 62.28, 62.45, 65.1, 65.58, 65.28, 65.8, 66.2, 65.81, 66.08, 66.83, 65.98, 65.79, 64.23, 64.02, 63.63, 63.66, 63.34, 63.2, 63.65, 63.2, 62.39, 63.22, 62.72]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.832, Test loss: 2.048, Test accuracy: 18.03
Round   0, Global train loss: 1.832, Global test loss: 2.201, Global test accuracy: 14.05
Round   1, Train loss: 1.733, Test loss: 1.919, Test accuracy: 26.47
Round   1, Global train loss: 1.733, Global test loss: 2.208, Global test accuracy: 19.39
Round   2, Train loss: 1.570, Test loss: 1.814, Test accuracy: 31.65
Round   2, Global train loss: 1.570, Global test loss: 2.133, Global test accuracy: 26.09
Round   3, Train loss: 1.702, Test loss: 1.682, Test accuracy: 37.55
Round   3, Global train loss: 1.702, Global test loss: 2.043, Global test accuracy: 30.49
Round   4, Train loss: 1.569, Test loss: 1.603, Test accuracy: 38.37
Round   4, Global train loss: 1.569, Global test loss: 1.918, Global test accuracy: 28.70
Round   5, Train loss: 1.487, Test loss: 1.449, Test accuracy: 44.20
Round   5, Global train loss: 1.487, Global test loss: 1.800, Global test accuracy: 37.98
Round   6, Train loss: 1.536, Test loss: 1.424, Test accuracy: 45.32
Round   6, Global train loss: 1.536, Global test loss: 1.962, Global test accuracy: 30.75
Round   7, Train loss: 1.456, Test loss: 1.415, Test accuracy: 45.69
Round   7, Global train loss: 1.456, Global test loss: 2.079, Global test accuracy: 24.57
Round   8, Train loss: 1.563, Test loss: 1.345, Test accuracy: 48.66
Round   8, Global train loss: 1.563, Global test loss: 2.015, Global test accuracy: 27.48
Round   9, Train loss: 1.362, Test loss: 1.334, Test accuracy: 49.48
Round   9, Global train loss: 1.362, Global test loss: 1.971, Global test accuracy: 27.55
Round  10, Train loss: 1.436, Test loss: 1.332, Test accuracy: 49.79
Round  10, Global train loss: 1.436, Global test loss: 1.998, Global test accuracy: 29.79
Round  11, Train loss: 1.298, Test loss: 1.349, Test accuracy: 49.34
Round  11, Global train loss: 1.298, Global test loss: 1.916, Global test accuracy: 33.52
Round  12, Train loss: 1.498, Test loss: 1.330, Test accuracy: 50.31
Round  12, Global train loss: 1.498, Global test loss: 1.897, Global test accuracy: 34.08
Round  13, Train loss: 1.254, Test loss: 1.332, Test accuracy: 49.74
Round  13, Global train loss: 1.254, Global test loss: 1.804, Global test accuracy: 37.43
Round  14, Train loss: 1.411, Test loss: 1.329, Test accuracy: 49.64
Round  14, Global train loss: 1.411, Global test loss: 1.940, Global test accuracy: 35.08
Round  15, Train loss: 1.323, Test loss: 1.341, Test accuracy: 49.67
Round  15, Global train loss: 1.323, Global test loss: 1.922, Global test accuracy: 33.75
Round  16, Train loss: 1.320, Test loss: 1.344, Test accuracy: 49.65
Round  16, Global train loss: 1.320, Global test loss: 1.889, Global test accuracy: 31.51
Round  17, Train loss: 1.391, Test loss: 1.339, Test accuracy: 49.79
Round  17, Global train loss: 1.391, Global test loss: 1.824, Global test accuracy: 37.55
Round  18, Train loss: 1.269, Test loss: 1.335, Test accuracy: 50.31
Round  18, Global train loss: 1.269, Global test loss: 1.898, Global test accuracy: 37.46
Round  19, Train loss: 1.187, Test loss: 1.318, Test accuracy: 50.38
Round  19, Global train loss: 1.187, Global test loss: 1.923, Global test accuracy: 30.55
Round  20, Train loss: 1.190, Test loss: 1.336, Test accuracy: 50.60
Round  20, Global train loss: 1.190, Global test loss: 1.816, Global test accuracy: 39.83
Round  21, Train loss: 1.001, Test loss: 1.352, Test accuracy: 50.73
Round  21, Global train loss: 1.001, Global test loss: 1.807, Global test accuracy: 38.13
Round  22, Train loss: 1.172, Test loss: 1.345, Test accuracy: 50.83
Round  22, Global train loss: 1.172, Global test loss: 1.864, Global test accuracy: 37.87
Round  23, Train loss: 1.153, Test loss: 1.352, Test accuracy: 50.93
Round  23, Global train loss: 1.153, Global test loss: 2.007, Global test accuracy: 31.49
Round  24, Train loss: 1.211, Test loss: 1.340, Test accuracy: 51.55
Round  24, Global train loss: 1.211, Global test loss: 1.900, Global test accuracy: 34.22
Round  25, Train loss: 1.158, Test loss: 1.347, Test accuracy: 51.39
Round  25, Global train loss: 1.158, Global test loss: 1.891, Global test accuracy: 38.23
Round  26, Train loss: 1.237, Test loss: 1.341, Test accuracy: 51.60
Round  26, Global train loss: 1.237, Global test loss: 1.799, Global test accuracy: 40.07
Round  27, Train loss: 0.961, Test loss: 1.364, Test accuracy: 51.17
Round  27, Global train loss: 0.961, Global test loss: 1.800, Global test accuracy: 38.43
Round  28, Train loss: 0.978, Test loss: 1.373, Test accuracy: 51.04
Round  28, Global train loss: 0.978, Global test loss: 1.740, Global test accuracy: 38.53
Round  29, Train loss: 1.042, Test loss: 1.407, Test accuracy: 50.48
Round  29, Global train loss: 1.042, Global test loss: 1.770, Global test accuracy: 38.62
Round  30, Train loss: 0.994, Test loss: 1.401, Test accuracy: 50.33
Round  30, Global train loss: 0.994, Global test loss: 1.892, Global test accuracy: 33.20
Round  31, Train loss: 1.027, Test loss: 1.404, Test accuracy: 50.63
Round  31, Global train loss: 1.027, Global test loss: 1.901, Global test accuracy: 31.43
Round  32, Train loss: 0.840, Test loss: 1.448, Test accuracy: 50.12
Round  32, Global train loss: 0.840, Global test loss: 1.906, Global test accuracy: 31.87
Round  33, Train loss: 0.966, Test loss: 1.444, Test accuracy: 50.60
Round  33, Global train loss: 0.966, Global test loss: 1.860, Global test accuracy: 40.37
Round  34, Train loss: 0.791, Test loss: 1.461, Test accuracy: 50.18
Round  34, Global train loss: 0.791, Global test loss: 1.798, Global test accuracy: 40.43
Round  35, Train loss: 0.909, Test loss: 1.488, Test accuracy: 50.37
Round  35, Global train loss: 0.909, Global test loss: 1.759, Global test accuracy: 37.11
Round  36, Train loss: 0.952, Test loss: 1.500, Test accuracy: 50.33
Round  36, Global train loss: 0.952, Global test loss: 2.026, Global test accuracy: 23.85
Round  37, Train loss: 1.003, Test loss: 1.529, Test accuracy: 49.61
Round  37, Global train loss: 1.003, Global test loss: 1.919, Global test accuracy: 34.13
Round  38, Train loss: 0.755, Test loss: 1.542, Test accuracy: 49.51
Round  38, Global train loss: 0.755, Global test loss: 1.895, Global test accuracy: 34.77
Round  39, Train loss: 0.835, Test loss: 1.572, Test accuracy: 49.17
Round  39, Global train loss: 0.835, Global test loss: 1.823, Global test accuracy: 35.10
Round  40, Train loss: 0.796, Test loss: 1.595, Test accuracy: 49.16
Round  40, Global train loss: 0.796, Global test loss: 1.884, Global test accuracy: 38.12
Round  41, Train loss: 0.830, Test loss: 1.635, Test accuracy: 48.82
Round  41, Global train loss: 0.830, Global test loss: 2.018, Global test accuracy: 31.61
Round  42, Train loss: 0.563, Test loss: 1.677, Test accuracy: 48.55
Round  42, Global train loss: 0.563, Global test loss: 1.814, Global test accuracy: 35.62
Round  43, Train loss: 0.511, Test loss: 1.655, Test accuracy: 49.23
Round  43, Global train loss: 0.511, Global test loss: 1.956, Global test accuracy: 26.97
Round  44, Train loss: 0.628, Test loss: 1.662, Test accuracy: 49.09
Round  44, Global train loss: 0.628, Global test loss: 1.749, Global test accuracy: 39.29
Round  45, Train loss: 0.748, Test loss: 1.700, Test accuracy: 49.54
Round  45, Global train loss: 0.748, Global test loss: 1.887, Global test accuracy: 31.32
Round  46, Train loss: 0.672, Test loss: 1.735, Test accuracy: 49.84
Round  46, Global train loss: 0.672, Global test loss: 2.003, Global test accuracy: 30.36
Round  47, Train loss: 0.630, Test loss: 1.789, Test accuracy: 49.32
Round  47, Global train loss: 0.630, Global test loss: 1.688, Global test accuracy: 41.40
Round  48, Train loss: 0.749, Test loss: 1.785, Test accuracy: 49.62
Round  48, Global train loss: 0.749, Global test loss: 1.911, Global test accuracy: 32.93
Round  49, Train loss: 0.487, Test loss: 1.823, Test accuracy: 49.07
Round  49, Global train loss: 0.487, Global test loss: 1.849, Global test accuracy: 36.60
Round  50, Train loss: 0.571, Test loss: 1.873, Test accuracy: 49.16
Round  50, Global train loss: 0.571, Global test loss: 1.876, Global test accuracy: 38.52
Round  51, Train loss: 0.598, Test loss: 1.894, Test accuracy: 48.61
Round  51, Global train loss: 0.598, Global test loss: 1.988, Global test accuracy: 34.13
Round  52, Train loss: 0.598, Test loss: 1.913, Test accuracy: 48.38
Round  52, Global train loss: 0.598, Global test loss: 1.885, Global test accuracy: 36.25
Round  53, Train loss: 0.361, Test loss: 1.988, Test accuracy: 48.26
Round  53, Global train loss: 0.361, Global test loss: 1.952, Global test accuracy: 34.48
Round  54, Train loss: 0.643, Test loss: 2.026, Test accuracy: 47.92
Round  54, Global train loss: 0.643, Global test loss: 1.746, Global test accuracy: 41.48
Round  55, Train loss: 0.512, Test loss: 2.046, Test accuracy: 48.17
Round  55, Global train loss: 0.512, Global test loss: 1.780, Global test accuracy: 38.28
Round  56, Train loss: 0.550, Test loss: 2.060, Test accuracy: 48.30
Round  56, Global train loss: 0.550, Global test loss: 1.888, Global test accuracy: 35.28
Round  57, Train loss: 0.673, Test loss: 2.063, Test accuracy: 48.82
Round  57, Global train loss: 0.673, Global test loss: 1.927, Global test accuracy: 35.05
Round  58, Train loss: 0.595, Test loss: 2.088, Test accuracy: 48.68
Round  58, Global train loss: 0.595, Global test loss: 2.052, Global test accuracy: 28.13
Round  59, Train loss: 0.571, Test loss: 2.123, Test accuracy: 48.39
Round  59, Global train loss: 0.571, Global test loss: 1.862, Global test accuracy: 34.67
Round  60, Train loss: 0.431, Test loss: 2.165, Test accuracy: 48.38
Round  60, Global train loss: 0.431, Global test loss: 1.837, Global test accuracy: 39.48
Round  61, Train loss: 0.453, Test loss: 2.207, Test accuracy: 48.12
Round  61, Global train loss: 0.453, Global test loss: 1.833, Global test accuracy: 33.62
Round  62, Train loss: 0.468, Test loss: 2.259, Test accuracy: 48.09
Round  62, Global train loss: 0.468, Global test loss: 1.891, Global test accuracy: 33.91
Round  63, Train loss: 0.488, Test loss: 2.289, Test accuracy: 48.14
Round  63, Global train loss: 0.488, Global test loss: 1.854, Global test accuracy: 36.26
Round  64, Train loss: 0.337, Test loss: 2.257, Test accuracy: 48.31
Round  64, Global train loss: 0.337, Global test loss: 1.725, Global test accuracy: 40.10
Round  65, Train loss: 0.371, Test loss: 2.287, Test accuracy: 48.55
Round  65, Global train loss: 0.371, Global test loss: 1.872, Global test accuracy: 36.13
Round  66, Train loss: 0.370, Test loss: 2.327, Test accuracy: 48.32
Round  66, Global train loss: 0.370, Global test loss: 1.735, Global test accuracy: 36.94
Round  67, Train loss: 0.383, Test loss: 2.351, Test accuracy: 48.27
Round  67, Global train loss: 0.383, Global test loss: 1.880, Global test accuracy: 35.33
Round  68, Train loss: 0.288, Test loss: 2.393, Test accuracy: 48.12
Round  68, Global train loss: 0.288, Global test loss: 1.985, Global test accuracy: 28.19
Round  69, Train loss: 0.281, Test loss: 2.413, Test accuracy: 48.09
Round  69, Global train loss: 0.281, Global test loss: 1.852, Global test accuracy: 38.84
Round  70, Train loss: 0.301, Test loss: 2.411, Test accuracy: 48.62
Round  70, Global train loss: 0.301, Global test loss: 1.901, Global test accuracy: 34.67
Round  71, Train loss: 0.381, Test loss: 2.406, Test accuracy: 48.52
Round  71, Global train loss: 0.381, Global test loss: 1.968, Global test accuracy: 30.43
Round  72, Train loss: 0.329, Test loss: 2.462, Test accuracy: 48.22
Round  72, Global train loss: 0.329, Global test loss: 1.988, Global test accuracy: 32.43
Round  73, Train loss: 0.308, Test loss: 2.494, Test accuracy: 48.48
Round  73, Global train loss: 0.308, Global test loss: 1.922, Global test accuracy: 28.53
Round  74, Train loss: 0.329, Test loss: 2.541, Test accuracy: 48.49
Round  74, Global train loss: 0.329, Global test loss: 1.763, Global test accuracy: 39.14
Round  75, Train loss: 0.332, Test loss: 2.538, Test accuracy: 48.58
Round  75, Global train loss: 0.332, Global test loss: 1.856, Global test accuracy: 35.19
Round  76, Train loss: 0.335, Test loss: 2.511, Test accuracy: 49.26
Round  76, Global train loss: 0.335, Global test loss: 1.952, Global test accuracy: 33.22
Round  77, Train loss: 0.319, Test loss: 2.546, Test accuracy: 49.14
Round  77, Global train loss: 0.319, Global test loss: 1.940, Global test accuracy: 36.03
Round  78, Train loss: 0.256, Test loss: 2.538, Test accuracy: 49.22
Round  78, Global train loss: 0.256, Global test loss: 1.874, Global test accuracy: 29.91
Round  79, Train loss: 0.379, Test loss: 2.558, Test accuracy: 49.02
Round  79, Global train loss: 0.379, Global test loss: 1.929, Global test accuracy: 34.34
Round  80, Train loss: 0.339, Test loss: 2.576, Test accuracy: 49.01
Round  80, Global train loss: 0.339, Global test loss: 1.806, Global test accuracy: 38.22
Round  81, Train loss: 0.232, Test loss: 2.585, Test accuracy: 48.53
Round  81, Global train loss: 0.232, Global test loss: 1.814, Global test accuracy: 34.90
Round  82, Train loss: 0.297, Test loss: 2.644, Test accuracy: 48.40
Round  82, Global train loss: 0.297, Global test loss: 2.008, Global test accuracy: 31.48
Round  83, Train loss: 0.189, Test loss: 2.681, Test accuracy: 48.19
Round  83, Global train loss: 0.189, Global test loss: 1.996, Global test accuracy: 24.89
Round  84, Train loss: 0.246, Test loss: 2.681, Test accuracy: 48.28
Round  84, Global train loss: 0.246, Global test loss: 2.048, Global test accuracy: 28.01
Round  85, Train loss: 0.253, Test loss: 2.699, Test accuracy: 47.95
Round  85, Global train loss: 0.253, Global test loss: 1.912, Global test accuracy: 34.98
Round  86, Train loss: 0.226, Test loss: 2.724, Test accuracy: 48.13
Round  86, Global train loss: 0.226, Global test loss: 1.827, Global test accuracy: 38.07
Round  87, Train loss: 0.248, Test loss: 2.775, Test accuracy: 47.73
Round  87, Global train loss: 0.248, Global test loss: 1.874, Global test accuracy: 36.60
Round  88, Train loss: 0.276, Test loss: 2.772, Test accuracy: 47.76
Round  88, Global train loss: 0.276, Global test loss: 1.970, Global test accuracy: 27.88
Round  89, Train loss: 0.213, Test loss: 2.778, Test accuracy: 48.02
Round  89, Global train loss: 0.213, Global test loss: 1.884, Global test accuracy: 36.10
Round  90, Train loss: 0.201, Test loss: 2.857, Test accuracy: 47.77
Round  90, Global train loss: 0.201, Global test loss: 1.965, Global test accuracy: 31.86
Round  91, Train loss: 0.268, Test loss: 2.858, Test accuracy: 47.61
Round  91, Global train loss: 0.268, Global test loss: 1.966, Global test accuracy: 33.67
Round  92, Train loss: 0.204, Test loss: 2.934, Test accuracy: 47.92
Round  92, Global train loss: 0.204, Global test loss: 1.897, Global test accuracy: 33.62
Round  93, Train loss: 0.201, Test loss: 2.954, Test accuracy: 48.20
Round  93, Global train loss: 0.201, Global test loss: 1.997, Global test accuracy: 29.69
Round  94, Train loss: 0.176, Test loss: 2.942, Test accuracy: 48.42
Round  94, Global train loss: 0.176, Global test loss: 1.887, Global test accuracy: 35.09
Round  95, Train loss: 0.184, Test loss: 2.989, Test accuracy: 48.02
Round  95, Global train loss: 0.184, Global test loss: 1.936, Global test accuracy: 33.09
Round  96, Train loss: 0.217, Test loss: 2.958, Test accuracy: 48.18
Round  96, Global train loss: 0.217, Global test loss: 1.802, Global test accuracy: 38.94
Round  97, Train loss: 0.208, Test loss: 3.061, Test accuracy: 47.93
Round  97, Global train loss: 0.208, Global test loss: 1.917, Global test accuracy: 32.90
Round  98, Train loss: 0.173, Test loss: 3.082, Test accuracy: 47.71
Round  98, Global train loss: 0.173, Global test loss: 2.034, Global test accuracy: 27.67
Round  99, Train loss: 0.160, Test loss: 3.089, Test accuracy: 48.11
Round  99, Global train loss: 0.160, Global test loss: 1.845, Global test accuracy: 35.77
Final Round, Train loss: 0.170, Test loss: 3.210, Test accuracy: 48.18
Final Round, Global train loss: 0.170, Global test loss: 1.845, Global test accuracy: 35.77
Average accuracy final 10 rounds: 47.98833333333334 

Average global accuracy final 10 rounds: 33.23 

1775.8060855865479
[1.6795213222503662, 3.3590426445007324, 4.637386322021484, 5.915729999542236, 7.234812498092651, 8.553894996643066, 9.823652982711792, 11.093410968780518, 12.388858318328857, 13.684305667877197, 14.96386456489563, 16.243423461914062, 17.493432760238647, 18.743442058563232, 20.014160871505737, 21.284879684448242, 22.54901623725891, 23.81315279006958, 25.096781253814697, 26.380409717559814, 27.676166534423828, 28.971923351287842, 30.254405736923218, 31.536888122558594, 32.85255455970764, 34.16822099685669, 35.47203016281128, 36.77583932876587, 38.05063486099243, 39.325430393218994, 40.63780236244202, 41.95017433166504, 43.27648162841797, 44.6027889251709, 45.93121385574341, 47.25963878631592, 48.54209351539612, 49.82454824447632, 51.114702463150024, 52.40485668182373, 53.69783306121826, 54.99080944061279, 56.27489161491394, 57.55897378921509, 58.816007137298584, 60.07304048538208, 61.368592739105225, 62.66414499282837, 63.950395584106445, 65.23664617538452, 66.51559066772461, 67.7945351600647, 69.07068967819214, 70.34684419631958, 71.61188817024231, 72.87693214416504, 74.1770007610321, 75.47706937789917, 76.76942706108093, 78.0617847442627, 79.33942222595215, 80.6170597076416, 81.88772535324097, 83.15839099884033, 84.44112730026245, 85.72386360168457, 86.98940181732178, 88.25494003295898, 89.56587648391724, 90.87681293487549, 92.13999652862549, 93.40318012237549, 94.70941877365112, 96.01565742492676, 97.30447769165039, 98.59329795837402, 99.90276980400085, 101.21224164962769, 102.50396585464478, 103.79569005966187, 105.06988739967346, 106.34408473968506, 107.6170482635498, 108.89001178741455, 110.16297245025635, 111.43593311309814, 112.74927163124084, 114.06261014938354, 115.32000589370728, 116.577401638031, 117.87708902359009, 119.17677640914917, 120.45613431930542, 121.73549222946167, 123.01223421096802, 124.28897619247437, 125.5807249546051, 126.87247371673584, 128.1689808368683, 129.46548795700073, 130.72851181030273, 131.99153566360474, 133.26816940307617, 134.5448031425476, 135.82660293579102, 137.10840272903442, 138.41232419013977, 139.71624565124512, 141.0082015991211, 142.30015754699707, 143.59515571594238, 144.8901538848877, 146.1739330291748, 147.4577121734619, 148.78147292137146, 150.105233669281, 151.4232623577118, 152.74129104614258, 154.02622628211975, 155.31116151809692, 156.65412712097168, 157.99709272384644, 159.28670024871826, 160.5763077735901, 161.885977268219, 163.1956467628479, 164.515727519989, 165.83580827713013, 167.12892365455627, 168.42203903198242, 169.73599362373352, 171.04994821548462, 172.3512225151062, 173.65249681472778, 174.95112442970276, 176.24975204467773, 177.55406737327576, 178.85838270187378, 180.28573060035706, 181.71307849884033, 183.20974349975586, 184.7064085006714, 186.15480279922485, 187.60319709777832, 189.11323928833008, 190.62328147888184, 191.95591068267822, 193.2885398864746, 194.5827338695526, 195.87692785263062, 197.1436676979065, 198.41040754318237, 199.76069569587708, 201.11098384857178, 202.40490889549255, 203.69883394241333, 204.97241282463074, 206.24599170684814, 207.57164645195007, 208.897301197052, 210.21435451507568, 211.53140783309937, 212.86751103401184, 214.20361423492432, 215.49424123764038, 216.78486824035645, 218.10588359832764, 219.42689895629883, 220.76078939437866, 222.0946798324585, 223.4001715183258, 224.70566320419312, 225.9742090702057, 227.24275493621826, 228.52837467193604, 229.8139944076538, 231.07748126983643, 232.34096813201904, 233.6279480457306, 234.91492795944214, 236.2164146900177, 237.51790142059326, 238.81880736351013, 240.119713306427, 241.42324042320251, 242.72676753997803, 243.98288679122925, 245.23900604248047, 246.51322650909424, 247.787446975708, 249.0907850265503, 250.39412307739258, 251.65680122375488, 252.9194793701172, 254.24850296974182, 255.57752656936646, 256.8735148906708, 258.1695032119751, 259.44185090065, 260.71419858932495, 262.88055872917175, 265.04691886901855]
[18.033333333333335, 18.033333333333335, 26.466666666666665, 26.466666666666665, 31.65, 31.65, 37.55, 37.55, 38.36666666666667, 38.36666666666667, 44.2, 44.2, 45.31666666666667, 45.31666666666667, 45.69166666666667, 45.69166666666667, 48.65833333333333, 48.65833333333333, 49.483333333333334, 49.483333333333334, 49.791666666666664, 49.791666666666664, 49.34166666666667, 49.34166666666667, 50.30833333333333, 50.30833333333333, 49.74166666666667, 49.74166666666667, 49.641666666666666, 49.641666666666666, 49.675, 49.675, 49.65, 49.65, 49.791666666666664, 49.791666666666664, 50.30833333333333, 50.30833333333333, 50.375, 50.375, 50.6, 50.6, 50.733333333333334, 50.733333333333334, 50.833333333333336, 50.833333333333336, 50.93333333333333, 50.93333333333333, 51.55, 51.55, 51.391666666666666, 51.391666666666666, 51.6, 51.6, 51.166666666666664, 51.166666666666664, 51.041666666666664, 51.041666666666664, 50.483333333333334, 50.483333333333334, 50.333333333333336, 50.333333333333336, 50.63333333333333, 50.63333333333333, 50.125, 50.125, 50.6, 50.6, 50.18333333333333, 50.18333333333333, 50.36666666666667, 50.36666666666667, 50.333333333333336, 50.333333333333336, 49.608333333333334, 49.608333333333334, 49.50833333333333, 49.50833333333333, 49.175, 49.175, 49.15833333333333, 49.15833333333333, 48.81666666666667, 48.81666666666667, 48.55, 48.55, 49.233333333333334, 49.233333333333334, 49.09166666666667, 49.09166666666667, 49.541666666666664, 49.541666666666664, 49.84166666666667, 49.84166666666667, 49.31666666666667, 49.31666666666667, 49.61666666666667, 49.61666666666667, 49.06666666666667, 49.06666666666667, 49.15833333333333, 49.15833333333333, 48.608333333333334, 48.608333333333334, 48.375, 48.375, 48.25833333333333, 48.25833333333333, 47.916666666666664, 47.916666666666664, 48.175, 48.175, 48.3, 48.3, 48.81666666666667, 48.81666666666667, 48.68333333333333, 48.68333333333333, 48.391666666666666, 48.391666666666666, 48.375, 48.375, 48.11666666666667, 48.11666666666667, 48.09166666666667, 48.09166666666667, 48.141666666666666, 48.141666666666666, 48.30833333333333, 48.30833333333333, 48.55, 48.55, 48.31666666666667, 48.31666666666667, 48.266666666666666, 48.266666666666666, 48.11666666666667, 48.11666666666667, 48.09166666666667, 48.09166666666667, 48.61666666666667, 48.61666666666667, 48.516666666666666, 48.516666666666666, 48.21666666666667, 48.21666666666667, 48.475, 48.475, 48.49166666666667, 48.49166666666667, 48.575, 48.575, 49.25833333333333, 49.25833333333333, 49.141666666666666, 49.141666666666666, 49.21666666666667, 49.21666666666667, 49.025, 49.025, 49.00833333333333, 49.00833333333333, 48.53333333333333, 48.53333333333333, 48.4, 48.4, 48.19166666666667, 48.19166666666667, 48.28333333333333, 48.28333333333333, 47.95, 47.95, 48.13333333333333, 48.13333333333333, 47.733333333333334, 47.733333333333334, 47.75833333333333, 47.75833333333333, 48.016666666666666, 48.016666666666666, 47.775, 47.775, 47.608333333333334, 47.608333333333334, 47.925, 47.925, 48.2, 48.2, 48.425, 48.425, 48.016666666666666, 48.016666666666666, 48.18333333333333, 48.18333333333333, 47.93333333333333, 47.93333333333333, 47.708333333333336, 47.708333333333336, 48.108333333333334, 48.108333333333334, 48.18333333333333, 48.18333333333333]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.897, Test loss: 2.099, Test accuracy: 14.60
Round   0, Global train loss: 1.897, Global test loss: 2.236, Global test accuracy: 11.76
Round   1, Train loss: 1.705, Test loss: 1.885, Test accuracy: 26.14
Round   1, Global train loss: 1.705, Global test loss: 2.109, Global test accuracy: 22.29
Round   2, Train loss: 1.704, Test loss: 1.805, Test accuracy: 31.77
Round   2, Global train loss: 1.704, Global test loss: 2.093, Global test accuracy: 27.18
Round   3, Train loss: 1.576, Test loss: 1.645, Test accuracy: 39.11
Round   3, Global train loss: 1.576, Global test loss: 1.957, Global test accuracy: 33.30
Round   4, Train loss: 1.697, Test loss: 1.561, Test accuracy: 41.02
Round   4, Global train loss: 1.697, Global test loss: 1.911, Global test accuracy: 32.52
Round   5, Train loss: 1.626, Test loss: 1.423, Test accuracy: 45.15
Round   5, Global train loss: 1.626, Global test loss: 1.787, Global test accuracy: 39.81
Round   6, Train loss: 1.474, Test loss: 1.409, Test accuracy: 46.42
Round   6, Global train loss: 1.474, Global test loss: 1.692, Global test accuracy: 40.33
Round   7, Train loss: 1.427, Test loss: 1.392, Test accuracy: 46.73
Round   7, Global train loss: 1.427, Global test loss: 1.770, Global test accuracy: 35.14
Round   8, Train loss: 1.530, Test loss: 1.316, Test accuracy: 51.06
Round   8, Global train loss: 1.530, Global test loss: 1.642, Global test accuracy: 44.02
Round   9, Train loss: 1.455, Test loss: 1.297, Test accuracy: 51.35
Round   9, Global train loss: 1.455, Global test loss: 1.629, Global test accuracy: 41.98
Round  10, Train loss: 1.480, Test loss: 1.284, Test accuracy: 51.79
Round  10, Global train loss: 1.480, Global test loss: 1.695, Global test accuracy: 39.18
Round  11, Train loss: 1.449, Test loss: 1.282, Test accuracy: 52.35
Round  11, Global train loss: 1.449, Global test loss: 1.585, Global test accuracy: 47.01
Round  12, Train loss: 1.370, Test loss: 1.262, Test accuracy: 53.43
Round  12, Global train loss: 1.370, Global test loss: 1.649, Global test accuracy: 44.76
Round  13, Train loss: 1.559, Test loss: 1.255, Test accuracy: 53.92
Round  13, Global train loss: 1.559, Global test loss: 1.642, Global test accuracy: 47.71
Round  14, Train loss: 1.408, Test loss: 1.239, Test accuracy: 54.82
Round  14, Global train loss: 1.408, Global test loss: 1.585, Global test accuracy: 47.94
Round  15, Train loss: 1.389, Test loss: 1.209, Test accuracy: 56.17
Round  15, Global train loss: 1.389, Global test loss: 1.630, Global test accuracy: 46.48
Round  16, Train loss: 1.280, Test loss: 1.219, Test accuracy: 55.92
Round  16, Global train loss: 1.280, Global test loss: 1.516, Global test accuracy: 47.27
Round  17, Train loss: 1.466, Test loss: 1.204, Test accuracy: 56.27
Round  17, Global train loss: 1.466, Global test loss: 1.583, Global test accuracy: 47.78
Round  18, Train loss: 1.242, Test loss: 1.205, Test accuracy: 55.92
Round  18, Global train loss: 1.242, Global test loss: 1.443, Global test accuracy: 52.42
Round  19, Train loss: 1.373, Test loss: 1.168, Test accuracy: 58.23
Round  19, Global train loss: 1.373, Global test loss: 1.501, Global test accuracy: 50.12
Round  20, Train loss: 1.352, Test loss: 1.163, Test accuracy: 58.27
Round  20, Global train loss: 1.352, Global test loss: 1.481, Global test accuracy: 52.80
Round  21, Train loss: 1.293, Test loss: 1.166, Test accuracy: 58.11
Round  21, Global train loss: 1.293, Global test loss: 1.467, Global test accuracy: 53.22
Round  22, Train loss: 1.339, Test loss: 1.166, Test accuracy: 58.61
Round  22, Global train loss: 1.339, Global test loss: 1.521, Global test accuracy: 51.69
Round  23, Train loss: 1.309, Test loss: 1.155, Test accuracy: 59.38
Round  23, Global train loss: 1.309, Global test loss: 1.499, Global test accuracy: 52.88
Round  24, Train loss: 1.137, Test loss: 1.163, Test accuracy: 59.27
Round  24, Global train loss: 1.137, Global test loss: 1.393, Global test accuracy: 54.69
Round  25, Train loss: 1.252, Test loss: 1.164, Test accuracy: 59.19
Round  25, Global train loss: 1.252, Global test loss: 1.386, Global test accuracy: 55.35
Round  26, Train loss: 1.240, Test loss: 1.147, Test accuracy: 59.52
Round  26, Global train loss: 1.240, Global test loss: 1.317, Global test accuracy: 57.60
Round  27, Train loss: 1.270, Test loss: 1.133, Test accuracy: 60.45
Round  27, Global train loss: 1.270, Global test loss: 1.428, Global test accuracy: 52.94
Round  28, Train loss: 1.255, Test loss: 1.128, Test accuracy: 60.46
Round  28, Global train loss: 1.255, Global test loss: 1.410, Global test accuracy: 54.00
Round  29, Train loss: 1.243, Test loss: 1.120, Test accuracy: 60.35
Round  29, Global train loss: 1.243, Global test loss: 1.391, Global test accuracy: 56.55
Round  30, Train loss: 1.067, Test loss: 1.115, Test accuracy: 60.80
Round  30, Global train loss: 1.067, Global test loss: 1.325, Global test accuracy: 57.34
Round  31, Train loss: 1.180, Test loss: 1.109, Test accuracy: 60.67
Round  31, Global train loss: 1.180, Global test loss: 1.336, Global test accuracy: 56.29
Round  32, Train loss: 1.235, Test loss: 1.112, Test accuracy: 60.62
Round  32, Global train loss: 1.235, Global test loss: 1.421, Global test accuracy: 54.58
Round  33, Train loss: 1.136, Test loss: 1.114, Test accuracy: 60.40
Round  33, Global train loss: 1.136, Global test loss: 1.354, Global test accuracy: 57.04
Round  34, Train loss: 1.396, Test loss: 1.118, Test accuracy: 60.17
Round  34, Global train loss: 1.396, Global test loss: 1.501, Global test accuracy: 54.93
Round  35, Train loss: 1.242, Test loss: 1.105, Test accuracy: 61.01
Round  35, Global train loss: 1.242, Global test loss: 1.427, Global test accuracy: 52.98
Round  36, Train loss: 1.215, Test loss: 1.107, Test accuracy: 60.86
Round  36, Global train loss: 1.215, Global test loss: 1.423, Global test accuracy: 52.34
Round  37, Train loss: 1.093, Test loss: 1.110, Test accuracy: 61.00
Round  37, Global train loss: 1.093, Global test loss: 1.367, Global test accuracy: 55.32
Round  38, Train loss: 1.080, Test loss: 1.119, Test accuracy: 60.30
Round  38, Global train loss: 1.080, Global test loss: 1.394, Global test accuracy: 54.05
Round  39, Train loss: 1.178, Test loss: 1.122, Test accuracy: 60.48
Round  39, Global train loss: 1.178, Global test loss: 1.365, Global test accuracy: 56.00
Round  40, Train loss: 1.020, Test loss: 1.127, Test accuracy: 60.54
Round  40, Global train loss: 1.020, Global test loss: 1.282, Global test accuracy: 58.65
Round  41, Train loss: 1.107, Test loss: 1.137, Test accuracy: 60.58
Round  41, Global train loss: 1.107, Global test loss: 1.347, Global test accuracy: 55.27
Round  42, Train loss: 1.123, Test loss: 1.147, Test accuracy: 60.17
Round  42, Global train loss: 1.123, Global test loss: 1.377, Global test accuracy: 56.69
Round  43, Train loss: 1.165, Test loss: 1.162, Test accuracy: 59.50
Round  43, Global train loss: 1.165, Global test loss: 1.431, Global test accuracy: 54.80
Round  44, Train loss: 1.205, Test loss: 1.179, Test accuracy: 58.98
Round  44, Global train loss: 1.205, Global test loss: 1.399, Global test accuracy: 56.87
Round  45, Train loss: 1.101, Test loss: 1.183, Test accuracy: 58.41
Round  45, Global train loss: 1.101, Global test loss: 1.485, Global test accuracy: 51.53
Round  46, Train loss: 1.077, Test loss: 1.170, Test accuracy: 58.93
Round  46, Global train loss: 1.077, Global test loss: 1.419, Global test accuracy: 54.91
Round  47, Train loss: 1.175, Test loss: 1.173, Test accuracy: 59.33
Round  47, Global train loss: 1.175, Global test loss: 1.464, Global test accuracy: 53.44
Round  48, Train loss: 0.876, Test loss: 1.188, Test accuracy: 59.23
Round  48, Global train loss: 0.876, Global test loss: 1.238, Global test accuracy: 60.08
Round  49, Train loss: 1.023, Test loss: 1.187, Test accuracy: 59.59
Round  49, Global train loss: 1.023, Global test loss: 1.463, Global test accuracy: 53.97
Round  50, Train loss: 0.833, Test loss: 1.185, Test accuracy: 59.67
Round  50, Global train loss: 0.833, Global test loss: 1.392, Global test accuracy: 56.17
Round  51, Train loss: 0.998, Test loss: 1.197, Test accuracy: 59.10
Round  51, Global train loss: 0.998, Global test loss: 1.372, Global test accuracy: 55.10
Round  52, Train loss: 1.080, Test loss: 1.201, Test accuracy: 58.88
Round  52, Global train loss: 1.080, Global test loss: 1.360, Global test accuracy: 55.43
Round  53, Train loss: 0.912, Test loss: 1.190, Test accuracy: 59.47
Round  53, Global train loss: 0.912, Global test loss: 1.522, Global test accuracy: 52.62
Round  54, Train loss: 1.023, Test loss: 1.214, Test accuracy: 58.83
Round  54, Global train loss: 1.023, Global test loss: 1.347, Global test accuracy: 56.39
Round  55, Train loss: 0.897, Test loss: 1.219, Test accuracy: 58.51
Round  55, Global train loss: 0.897, Global test loss: 1.363, Global test accuracy: 56.17
Round  56, Train loss: 1.037, Test loss: 1.196, Test accuracy: 59.14
Round  56, Global train loss: 1.037, Global test loss: 1.267, Global test accuracy: 59.09
Round  57, Train loss: 0.881, Test loss: 1.189, Test accuracy: 59.53
Round  57, Global train loss: 0.881, Global test loss: 1.327, Global test accuracy: 56.44
Round  58, Train loss: 0.891, Test loss: 1.195, Test accuracy: 59.73
Round  58, Global train loss: 0.891, Global test loss: 1.399, Global test accuracy: 55.80
Round  59, Train loss: 0.978, Test loss: 1.192, Test accuracy: 59.80
Round  59, Global train loss: 0.978, Global test loss: 1.358, Global test accuracy: 55.81
Round  60, Train loss: 1.097, Test loss: 1.181, Test accuracy: 60.62
Round  60, Global train loss: 1.097, Global test loss: 1.429, Global test accuracy: 55.32
Round  61, Train loss: 0.913, Test loss: 1.190, Test accuracy: 60.18
Round  61, Global train loss: 0.913, Global test loss: 1.335, Global test accuracy: 57.63
Round  62, Train loss: 0.977, Test loss: 1.208, Test accuracy: 59.52
Round  62, Global train loss: 0.977, Global test loss: 1.405, Global test accuracy: 55.31
Round  63, Train loss: 0.836, Test loss: 1.220, Test accuracy: 59.17
Round  63, Global train loss: 0.836, Global test loss: 1.275, Global test accuracy: 58.94
Round  64, Train loss: 1.013, Test loss: 1.233, Test accuracy: 58.92
Round  64, Global train loss: 1.013, Global test loss: 1.352, Global test accuracy: 57.15
Round  65, Train loss: 1.017, Test loss: 1.249, Test accuracy: 58.86
Round  65, Global train loss: 1.017, Global test loss: 1.443, Global test accuracy: 55.61
Round  66, Train loss: 0.742, Test loss: 1.254, Test accuracy: 58.74
Round  66, Global train loss: 0.742, Global test loss: 1.317, Global test accuracy: 58.57
Round  67, Train loss: 0.906, Test loss: 1.269, Test accuracy: 58.58
Round  67, Global train loss: 0.906, Global test loss: 1.487, Global test accuracy: 53.83
Round  68, Train loss: 0.781, Test loss: 1.279, Test accuracy: 58.44
Round  68, Global train loss: 0.781, Global test loss: 1.571, Global test accuracy: 52.55
Round  69, Train loss: 0.792, Test loss: 1.279, Test accuracy: 58.37
Round  69, Global train loss: 0.792, Global test loss: 1.338, Global test accuracy: 58.24
Round  70, Train loss: 1.056, Test loss: 1.291, Test accuracy: 58.31
Round  70, Global train loss: 1.056, Global test loss: 1.495, Global test accuracy: 54.35
Round  71, Train loss: 0.803, Test loss: 1.283, Test accuracy: 58.84
Round  71, Global train loss: 0.803, Global test loss: 1.461, Global test accuracy: 55.28
Round  72, Train loss: 0.777, Test loss: 1.277, Test accuracy: 59.02
Round  72, Global train loss: 0.777, Global test loss: 1.565, Global test accuracy: 52.48
Round  73, Train loss: 0.850, Test loss: 1.307, Test accuracy: 58.27
Round  73, Global train loss: 0.850, Global test loss: 1.515, Global test accuracy: 52.72
Round  74, Train loss: 1.075, Test loss: 1.322, Test accuracy: 57.63
Round  74, Global train loss: 1.075, Global test loss: 1.504, Global test accuracy: 52.13
Round  75, Train loss: 0.793, Test loss: 1.331, Test accuracy: 57.33
Round  75, Global train loss: 0.793, Global test loss: 1.387, Global test accuracy: 56.67
Round  76, Train loss: 0.806, Test loss: 1.333, Test accuracy: 57.56
Round  76, Global train loss: 0.806, Global test loss: 1.481, Global test accuracy: 53.82
Round  77, Train loss: 0.752, Test loss: 1.312, Test accuracy: 57.57
Round  77, Global train loss: 0.752, Global test loss: 1.335, Global test accuracy: 57.58
Round  78, Train loss: 0.925, Test loss: 1.285, Test accuracy: 58.29
Round  78, Global train loss: 0.925, Global test loss: 1.403, Global test accuracy: 55.83
Round  79, Train loss: 0.925, Test loss: 1.317, Test accuracy: 57.81
Round  79, Global train loss: 0.925, Global test loss: 1.466, Global test accuracy: 52.96
Round  80, Train loss: 0.785, Test loss: 1.356, Test accuracy: 57.55
Round  80, Global train loss: 0.785, Global test loss: 1.427, Global test accuracy: 56.69
Round  81, Train loss: 0.887, Test loss: 1.362, Test accuracy: 57.28
Round  81, Global train loss: 0.887, Global test loss: 1.571, Global test accuracy: 51.39
Round  82, Train loss: 0.767, Test loss: 1.392, Test accuracy: 56.77
Round  82, Global train loss: 0.767, Global test loss: 1.595, Global test accuracy: 52.23
Round  83, Train loss: 0.901, Test loss: 1.397, Test accuracy: 56.77
Round  83, Global train loss: 0.901, Global test loss: 1.451, Global test accuracy: 54.35
Round  84, Train loss: 0.891, Test loss: 1.422, Test accuracy: 56.94
Round  84, Global train loss: 0.891, Global test loss: 1.693, Global test accuracy: 47.02
Round  85, Train loss: 0.763, Test loss: 1.422, Test accuracy: 56.87
Round  85, Global train loss: 0.763, Global test loss: 1.384, Global test accuracy: 56.38
Round  86, Train loss: 0.694, Test loss: 1.414, Test accuracy: 57.22
Round  86, Global train loss: 0.694, Global test loss: 1.337, Global test accuracy: 58.58
Round  87, Train loss: 0.956, Test loss: 1.419, Test accuracy: 57.35
Round  87, Global train loss: 0.956, Global test loss: 1.660, Global test accuracy: 49.24
Round  88, Train loss: 0.739, Test loss: 1.446, Test accuracy: 57.14
Round  88, Global train loss: 0.739, Global test loss: 1.514, Global test accuracy: 54.19
Round  89, Train loss: 0.768, Test loss: 1.417, Test accuracy: 57.33
Round  89, Global train loss: 0.768, Global test loss: 1.487, Global test accuracy: 54.77
Round  90, Train loss: 0.653, Test loss: 1.426, Test accuracy: 57.14
Round  90, Global train loss: 0.653, Global test loss: 1.473, Global test accuracy: 55.92
Round  91, Train loss: 0.688, Test loss: 1.425, Test accuracy: 56.99
Round  91, Global train loss: 0.688, Global test loss: 1.570, Global test accuracy: 55.50
Round  92, Train loss: 0.613, Test loss: 1.418, Test accuracy: 57.60
Round  92, Global train loss: 0.613, Global test loss: 1.475, Global test accuracy: 57.79
Round  93, Train loss: 0.768, Test loss: 1.415, Test accuracy: 58.02
Round  93, Global train loss: 0.768, Global test loss: 1.530, Global test accuracy: 53.54
Round  94, Train loss: 0.572, Test loss: 1.433, Test accuracy: 57.59
Round  94, Global train loss: 0.572, Global test loss: 1.484, Global test accuracy: 57.05
Round  95, Train loss: 0.713, Test loss: 1.421, Test accuracy: 57.92
Round  95, Global train loss: 0.713, Global test loss: 1.383, Global test accuracy: 57.25
Round  96, Train loss: 0.728, Test loss: 1.430, Test accuracy: 57.67
Round  96, Global train loss: 0.728, Global test loss: 1.509, Global test accuracy: 56.78
Round  97, Train loss: 0.723, Test loss: 1.430, Test accuracy: 57.70
Round  97, Global train loss: 0.723, Global test loss: 1.589, Global test accuracy: 55.28
Round  98, Train loss: 0.783, Test loss: 1.428, Test accuracy: 57.72
Round  98, Global train loss: 0.783, Global test loss: 1.636, Global test accuracy: 52.05
Round  99, Train loss: 0.574, Test loss: 1.460, Test accuracy: 57.42
Round  99, Global train loss: 0.574, Global test loss: 1.424, Global test accuracy: 57.11
Final Round, Train loss: 0.556, Test loss: 1.652, Test accuracy: 56.77
Final Round, Global train loss: 0.556, Global test loss: 1.424, Global test accuracy: 57.11
Average accuracy final 10 rounds: 57.57666666666667 

Average global accuracy final 10 rounds: 55.8275 

1756.4466798305511
[1.721217155456543, 3.442434310913086, 4.891569137573242, 6.340703964233398, 7.600113153457642, 8.859522342681885, 10.077505826950073, 11.295489311218262, 12.563875675201416, 13.83226203918457, 15.079501390457153, 16.326740741729736, 17.5609610080719, 18.795181274414062, 20.098744869232178, 21.402308464050293, 22.68643093109131, 23.970553398132324, 25.256484031677246, 26.542414665222168, 27.86517643928528, 29.18793821334839, 30.45748281478882, 31.727027416229248, 32.966089963912964, 34.20515251159668, 35.497257709503174, 36.78936290740967, 38.061803579330444, 39.33424425125122, 40.60586142539978, 41.87747859954834, 43.13007950782776, 44.38268041610718, 45.682992935180664, 46.98330545425415, 48.25467872619629, 49.52605199813843, 50.78610038757324, 52.04614877700806, 53.322853803634644, 54.59955883026123, 55.89678740501404, 57.194015979766846, 58.493942975997925, 59.793869972229004, 61.0839741230011, 62.37407827377319, 63.6583034992218, 64.94252872467041, 66.20784711837769, 67.47316551208496, 68.73525071144104, 69.99733591079712, 71.29684281349182, 72.59634971618652, 73.85980343818665, 75.12325716018677, 76.38688230514526, 77.65050745010376, 78.9211573600769, 80.19180727005005, 81.472989320755, 82.75417137145996, 84.05364918708801, 85.35312700271606, 86.62088012695312, 87.88863325119019, 89.16463208198547, 90.44063091278076, 91.71441125869751, 92.98819160461426, 94.26549530029297, 95.54279899597168, 96.837735414505, 98.13267183303833, 99.42301344871521, 100.71335506439209, 101.97377371788025, 103.23419237136841, 104.51438975334167, 105.79458713531494, 107.03680086135864, 108.27901458740234, 109.56380844116211, 110.84860229492188, 112.09519100189209, 113.3417797088623, 114.64530754089355, 115.9488353729248, 117.2450110912323, 118.5411868095398, 119.8317801952362, 121.12237358093262, 122.4020721912384, 123.68177080154419, 125.00845861434937, 126.33514642715454, 127.67276906967163, 129.01039171218872, 130.31280636787415, 131.61522102355957, 132.96329045295715, 134.31135988235474, 135.63014435768127, 136.9489288330078, 138.269704580307, 139.5904803276062, 140.912029504776, 142.2335786819458, 143.54314255714417, 144.85270643234253, 146.1545386314392, 147.4563708305359, 148.74891352653503, 150.04145622253418, 151.3366949558258, 152.63193368911743, 153.88716650009155, 155.14239931106567, 156.45635557174683, 157.77031183242798, 159.05455350875854, 160.3387951850891, 161.64810609817505, 162.957417011261, 164.23153114318848, 165.50564527511597, 166.77559280395508, 168.0455403327942, 169.35046362876892, 170.65538692474365, 171.9300000667572, 173.20461320877075, 174.50634264945984, 175.80807209014893, 177.11325883865356, 178.4184455871582, 179.70384049415588, 180.98923540115356, 182.28938364982605, 183.58953189849854, 184.91194987297058, 186.23436784744263, 187.54371762275696, 188.8530673980713, 190.14395713806152, 191.43484687805176, 192.73009967803955, 194.02535247802734, 195.30997395515442, 196.5945954322815, 197.89091873168945, 199.1872420310974, 200.52200841903687, 201.85677480697632, 203.1850380897522, 204.51330137252808, 205.8006989955902, 207.08809661865234, 208.40256714820862, 209.7170376777649, 211.00931787490845, 212.301598072052, 213.61289358139038, 214.92418909072876, 216.2134382724762, 217.50268745422363, 218.80409812927246, 220.1055088043213, 221.38424563407898, 222.66298246383667, 223.9688081741333, 225.27463388442993, 226.59638285636902, 227.9181318283081, 229.19320130348206, 230.468270778656, 231.71873450279236, 232.9691982269287, 234.25477123260498, 235.54034423828125, 236.84303617477417, 238.1457281112671, 239.44437551498413, 240.74302291870117, 242.06782746315002, 243.39263200759888, 244.67598724365234, 245.9593424797058, 247.23783564567566, 248.5163288116455, 249.79991030693054, 251.08349180221558, 252.39881205558777, 253.71413230895996, 255.00724458694458, 256.3003568649292, 257.56074714660645, 258.8211374282837, 260.9408140182495, 263.06049060821533]
[14.6, 14.6, 26.141666666666666, 26.141666666666666, 31.766666666666666, 31.766666666666666, 39.108333333333334, 39.108333333333334, 41.025, 41.025, 45.15, 45.15, 46.416666666666664, 46.416666666666664, 46.733333333333334, 46.733333333333334, 51.05833333333333, 51.05833333333333, 51.35, 51.35, 51.791666666666664, 51.791666666666664, 52.35, 52.35, 53.43333333333333, 53.43333333333333, 53.916666666666664, 53.916666666666664, 54.81666666666667, 54.81666666666667, 56.175, 56.175, 55.916666666666664, 55.916666666666664, 56.275, 56.275, 55.925, 55.925, 58.233333333333334, 58.233333333333334, 58.266666666666666, 58.266666666666666, 58.108333333333334, 58.108333333333334, 58.608333333333334, 58.608333333333334, 59.375, 59.375, 59.275, 59.275, 59.19166666666667, 59.19166666666667, 59.525, 59.525, 60.45, 60.45, 60.458333333333336, 60.458333333333336, 60.35, 60.35, 60.8, 60.8, 60.675, 60.675, 60.61666666666667, 60.61666666666667, 60.4, 60.4, 60.175, 60.175, 61.00833333333333, 61.00833333333333, 60.858333333333334, 60.858333333333334, 61.0, 61.0, 60.3, 60.3, 60.475, 60.475, 60.541666666666664, 60.541666666666664, 60.583333333333336, 60.583333333333336, 60.166666666666664, 60.166666666666664, 59.5, 59.5, 58.975, 58.975, 58.40833333333333, 58.40833333333333, 58.93333333333333, 58.93333333333333, 59.333333333333336, 59.333333333333336, 59.233333333333334, 59.233333333333334, 59.59166666666667, 59.59166666666667, 59.666666666666664, 59.666666666666664, 59.1, 59.1, 58.88333333333333, 58.88333333333333, 59.46666666666667, 59.46666666666667, 58.833333333333336, 58.833333333333336, 58.50833333333333, 58.50833333333333, 59.141666666666666, 59.141666666666666, 59.53333333333333, 59.53333333333333, 59.725, 59.725, 59.8, 59.8, 60.61666666666667, 60.61666666666667, 60.18333333333333, 60.18333333333333, 59.516666666666666, 59.516666666666666, 59.175, 59.175, 58.925, 58.925, 58.858333333333334, 58.858333333333334, 58.74166666666667, 58.74166666666667, 58.575, 58.575, 58.44166666666667, 58.44166666666667, 58.36666666666667, 58.36666666666667, 58.30833333333333, 58.30833333333333, 58.84166666666667, 58.84166666666667, 59.016666666666666, 59.016666666666666, 58.266666666666666, 58.266666666666666, 57.63333333333333, 57.63333333333333, 57.333333333333336, 57.333333333333336, 57.55833333333333, 57.55833333333333, 57.56666666666667, 57.56666666666667, 58.291666666666664, 58.291666666666664, 57.80833333333333, 57.80833333333333, 57.55, 57.55, 57.28333333333333, 57.28333333333333, 56.775, 56.775, 56.766666666666666, 56.766666666666666, 56.94166666666667, 56.94166666666667, 56.86666666666667, 56.86666666666667, 57.21666666666667, 57.21666666666667, 57.35, 57.35, 57.141666666666666, 57.141666666666666, 57.325, 57.325, 57.141666666666666, 57.141666666666666, 56.99166666666667, 56.99166666666667, 57.6, 57.6, 58.016666666666666, 58.016666666666666, 57.59166666666667, 57.59166666666667, 57.925, 57.925, 57.666666666666664, 57.666666666666664, 57.7, 57.7, 57.71666666666667, 57.71666666666667, 57.416666666666664, 57.416666666666664, 56.766666666666666, 56.766666666666666]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.879, Test loss: 2.079, Test accuracy: 19.81
Round   0, Global train loss: 1.879, Global test loss: 2.227, Global test accuracy: 17.22
Round   1, Train loss: 1.731, Test loss: 1.901, Test accuracy: 27.91
Round   1, Global train loss: 1.731, Global test loss: 2.136, Global test accuracy: 23.73
Round   2, Train loss: 1.743, Test loss: 1.842, Test accuracy: 31.40
Round   2, Global train loss: 1.743, Global test loss: 2.106, Global test accuracy: 26.56
Round   3, Train loss: 1.678, Test loss: 1.651, Test accuracy: 39.26
Round   3, Global train loss: 1.678, Global test loss: 1.921, Global test accuracy: 33.57
Round   4, Train loss: 1.568, Test loss: 1.587, Test accuracy: 39.79
Round   4, Global train loss: 1.568, Global test loss: 1.878, Global test accuracy: 30.95
Round   5, Train loss: 1.671, Test loss: 1.443, Test accuracy: 44.91
Round   5, Global train loss: 1.671, Global test loss: 1.785, Global test accuracy: 37.98
Round   6, Train loss: 1.559, Test loss: 1.421, Test accuracy: 45.66
Round   6, Global train loss: 1.559, Global test loss: 1.705, Global test accuracy: 39.93
Round   7, Train loss: 1.548, Test loss: 1.406, Test accuracy: 46.76
Round   7, Global train loss: 1.548, Global test loss: 1.820, Global test accuracy: 33.12
Round   8, Train loss: 1.437, Test loss: 1.332, Test accuracy: 49.99
Round   8, Global train loss: 1.437, Global test loss: 1.644, Global test accuracy: 43.20
Round   9, Train loss: 1.478, Test loss: 1.319, Test accuracy: 51.48
Round   9, Global train loss: 1.478, Global test loss: 1.672, Global test accuracy: 38.70
Round  10, Train loss: 1.465, Test loss: 1.309, Test accuracy: 51.94
Round  10, Global train loss: 1.465, Global test loss: 1.652, Global test accuracy: 38.72
Round  11, Train loss: 1.559, Test loss: 1.306, Test accuracy: 51.98
Round  11, Global train loss: 1.559, Global test loss: 1.583, Global test accuracy: 46.77
Round  12, Train loss: 1.474, Test loss: 1.292, Test accuracy: 52.31
Round  12, Global train loss: 1.474, Global test loss: 1.628, Global test accuracy: 43.80
Round  13, Train loss: 1.411, Test loss: 1.280, Test accuracy: 53.52
Round  13, Global train loss: 1.411, Global test loss: 1.543, Global test accuracy: 47.28
Round  14, Train loss: 1.473, Test loss: 1.264, Test accuracy: 54.69
Round  14, Global train loss: 1.473, Global test loss: 1.574, Global test accuracy: 47.91
Round  15, Train loss: 1.367, Test loss: 1.256, Test accuracy: 54.73
Round  15, Global train loss: 1.367, Global test loss: 1.586, Global test accuracy: 44.76
Round  16, Train loss: 1.522, Test loss: 1.240, Test accuracy: 55.82
Round  16, Global train loss: 1.522, Global test loss: 1.583, Global test accuracy: 45.65
Round  17, Train loss: 1.487, Test loss: 1.248, Test accuracy: 54.99
Round  17, Global train loss: 1.487, Global test loss: 1.602, Global test accuracy: 45.91
Round  18, Train loss: 1.480, Test loss: 1.248, Test accuracy: 54.35
Round  18, Global train loss: 1.480, Global test loss: 1.525, Global test accuracy: 49.67
Round  19, Train loss: 1.366, Test loss: 1.209, Test accuracy: 56.19
Round  19, Global train loss: 1.366, Global test loss: 1.489, Global test accuracy: 48.93
Round  20, Train loss: 1.400, Test loss: 1.206, Test accuracy: 56.74
Round  20, Global train loss: 1.400, Global test loss: 1.431, Global test accuracy: 52.08
Round  21, Train loss: 1.330, Test loss: 1.193, Test accuracy: 57.07
Round  21, Global train loss: 1.330, Global test loss: 1.485, Global test accuracy: 48.65
Round  22, Train loss: 1.519, Test loss: 1.184, Test accuracy: 58.11
Round  22, Global train loss: 1.519, Global test loss: 1.599, Global test accuracy: 49.64
Round  23, Train loss: 1.189, Test loss: 1.178, Test accuracy: 58.31
Round  23, Global train loss: 1.189, Global test loss: 1.437, Global test accuracy: 52.94
Round  24, Train loss: 1.440, Test loss: 1.176, Test accuracy: 58.47
Round  24, Global train loss: 1.440, Global test loss: 1.501, Global test accuracy: 52.21
Round  25, Train loss: 1.297, Test loss: 1.164, Test accuracy: 58.88
Round  25, Global train loss: 1.297, Global test loss: 1.404, Global test accuracy: 53.81
Round  26, Train loss: 1.260, Test loss: 1.155, Test accuracy: 59.15
Round  26, Global train loss: 1.260, Global test loss: 1.358, Global test accuracy: 55.52
Round  27, Train loss: 1.322, Test loss: 1.123, Test accuracy: 60.50
Round  27, Global train loss: 1.322, Global test loss: 1.341, Global test accuracy: 55.81
Round  28, Train loss: 1.232, Test loss: 1.135, Test accuracy: 60.50
Round  28, Global train loss: 1.232, Global test loss: 1.348, Global test accuracy: 54.69
Round  29, Train loss: 1.376, Test loss: 1.124, Test accuracy: 60.96
Round  29, Global train loss: 1.376, Global test loss: 1.436, Global test accuracy: 54.96
Round  30, Train loss: 1.295, Test loss: 1.109, Test accuracy: 61.62
Round  30, Global train loss: 1.295, Global test loss: 1.410, Global test accuracy: 54.71
Round  31, Train loss: 1.392, Test loss: 1.104, Test accuracy: 61.83
Round  31, Global train loss: 1.392, Global test loss: 1.442, Global test accuracy: 53.61
Round  32, Train loss: 1.331, Test loss: 1.105, Test accuracy: 61.85
Round  32, Global train loss: 1.331, Global test loss: 1.444, Global test accuracy: 55.18
Round  33, Train loss: 1.390, Test loss: 1.104, Test accuracy: 62.01
Round  33, Global train loss: 1.390, Global test loss: 1.436, Global test accuracy: 55.88
Round  34, Train loss: 1.218, Test loss: 1.104, Test accuracy: 62.17
Round  34, Global train loss: 1.218, Global test loss: 1.368, Global test accuracy: 55.91
Round  35, Train loss: 1.261, Test loss: 1.124, Test accuracy: 61.14
Round  35, Global train loss: 1.261, Global test loss: 1.365, Global test accuracy: 55.77
Round  36, Train loss: 1.273, Test loss: 1.131, Test accuracy: 60.62
Round  36, Global train loss: 1.273, Global test loss: 1.411, Global test accuracy: 52.07
Round  37, Train loss: 1.347, Test loss: 1.117, Test accuracy: 60.92
Round  37, Global train loss: 1.347, Global test loss: 1.519, Global test accuracy: 52.26
Round  38, Train loss: 1.252, Test loss: 1.119, Test accuracy: 60.78
Round  38, Global train loss: 1.252, Global test loss: 1.417, Global test accuracy: 53.51
Round  39, Train loss: 1.131, Test loss: 1.115, Test accuracy: 60.58
Round  39, Global train loss: 1.131, Global test loss: 1.330, Global test accuracy: 56.42
Round  40, Train loss: 1.388, Test loss: 1.117, Test accuracy: 60.61
Round  40, Global train loss: 1.388, Global test loss: 1.367, Global test accuracy: 57.77
Round  41, Train loss: 1.219, Test loss: 1.119, Test accuracy: 60.88
Round  41, Global train loss: 1.219, Global test loss: 1.347, Global test accuracy: 56.30
Round  42, Train loss: 1.173, Test loss: 1.126, Test accuracy: 60.85
Round  42, Global train loss: 1.173, Global test loss: 1.349, Global test accuracy: 57.64
Round  43, Train loss: 1.070, Test loss: 1.120, Test accuracy: 61.18
Round  43, Global train loss: 1.070, Global test loss: 1.351, Global test accuracy: 55.44
Round  44, Train loss: 1.068, Test loss: 1.121, Test accuracy: 61.32
Round  44, Global train loss: 1.068, Global test loss: 1.301, Global test accuracy: 58.19
Round  45, Train loss: 1.057, Test loss: 1.132, Test accuracy: 60.76
Round  45, Global train loss: 1.057, Global test loss: 1.352, Global test accuracy: 55.15
Round  46, Train loss: 1.227, Test loss: 1.114, Test accuracy: 61.35
Round  46, Global train loss: 1.227, Global test loss: 1.395, Global test accuracy: 54.42
Round  47, Train loss: 1.111, Test loss: 1.128, Test accuracy: 60.61
Round  47, Global train loss: 1.111, Global test loss: 1.389, Global test accuracy: 55.85
Round  48, Train loss: 1.243, Test loss: 1.120, Test accuracy: 61.03
Round  48, Global train loss: 1.243, Global test loss: 1.395, Global test accuracy: 55.48
Round  49, Train loss: 1.075, Test loss: 1.120, Test accuracy: 61.52
Round  49, Global train loss: 1.075, Global test loss: 1.315, Global test accuracy: 57.44
Round  50, Train loss: 1.087, Test loss: 1.135, Test accuracy: 61.26
Round  50, Global train loss: 1.087, Global test loss: 1.309, Global test accuracy: 57.08
Round  51, Train loss: 1.202, Test loss: 1.142, Test accuracy: 60.67
Round  51, Global train loss: 1.202, Global test loss: 1.404, Global test accuracy: 54.48
Round  52, Train loss: 1.104, Test loss: 1.131, Test accuracy: 61.26
Round  52, Global train loss: 1.104, Global test loss: 1.313, Global test accuracy: 57.83
Round  53, Train loss: 1.132, Test loss: 1.137, Test accuracy: 60.91
Round  53, Global train loss: 1.132, Global test loss: 1.477, Global test accuracy: 53.47
Round  54, Train loss: 1.117, Test loss: 1.136, Test accuracy: 61.02
Round  54, Global train loss: 1.117, Global test loss: 1.360, Global test accuracy: 57.00
Round  55, Train loss: 1.173, Test loss: 1.150, Test accuracy: 60.63
Round  55, Global train loss: 1.173, Global test loss: 1.412, Global test accuracy: 55.49
Round  56, Train loss: 1.112, Test loss: 1.164, Test accuracy: 59.96
Round  56, Global train loss: 1.112, Global test loss: 1.292, Global test accuracy: 59.12
Round  57, Train loss: 1.029, Test loss: 1.155, Test accuracy: 60.17
Round  57, Global train loss: 1.029, Global test loss: 1.341, Global test accuracy: 55.54
Round  58, Train loss: 1.160, Test loss: 1.163, Test accuracy: 59.62
Round  58, Global train loss: 1.160, Global test loss: 1.463, Global test accuracy: 51.95
Round  59, Train loss: 1.016, Test loss: 1.170, Test accuracy: 59.88
Round  59, Global train loss: 1.016, Global test loss: 1.304, Global test accuracy: 57.67
Round  60, Train loss: 1.003, Test loss: 1.163, Test accuracy: 60.17
Round  60, Global train loss: 1.003, Global test loss: 1.282, Global test accuracy: 59.41
Round  61, Train loss: 0.974, Test loss: 1.177, Test accuracy: 59.59
Round  61, Global train loss: 0.974, Global test loss: 1.259, Global test accuracy: 58.02
Round  62, Train loss: 1.009, Test loss: 1.193, Test accuracy: 59.29
Round  62, Global train loss: 1.009, Global test loss: 1.327, Global test accuracy: 57.58
Round  63, Train loss: 1.183, Test loss: 1.179, Test accuracy: 59.66
Round  63, Global train loss: 1.183, Global test loss: 1.331, Global test accuracy: 57.79
Round  64, Train loss: 1.042, Test loss: 1.185, Test accuracy: 59.83
Round  64, Global train loss: 1.042, Global test loss: 1.305, Global test accuracy: 59.17
Round  65, Train loss: 0.865, Test loss: 1.171, Test accuracy: 59.87
Round  65, Global train loss: 0.865, Global test loss: 1.323, Global test accuracy: 57.89
Round  66, Train loss: 1.033, Test loss: 1.152, Test accuracy: 60.37
Round  66, Global train loss: 1.033, Global test loss: 1.305, Global test accuracy: 59.23
Round  67, Train loss: 0.887, Test loss: 1.143, Test accuracy: 60.72
Round  67, Global train loss: 0.887, Global test loss: 1.447, Global test accuracy: 55.19
Round  68, Train loss: 0.880, Test loss: 1.153, Test accuracy: 60.59
Round  68, Global train loss: 0.880, Global test loss: 1.480, Global test accuracy: 53.77
Round  69, Train loss: 1.033, Test loss: 1.175, Test accuracy: 59.94
Round  69, Global train loss: 1.033, Global test loss: 1.337, Global test accuracy: 57.08
Round  70, Train loss: 0.983, Test loss: 1.178, Test accuracy: 60.17
Round  70, Global train loss: 0.983, Global test loss: 1.406, Global test accuracy: 56.73
Round  71, Train loss: 0.737, Test loss: 1.210, Test accuracy: 59.48
Round  71, Global train loss: 0.737, Global test loss: 1.309, Global test accuracy: 58.05
Round  72, Train loss: 0.978, Test loss: 1.201, Test accuracy: 59.79
Round  72, Global train loss: 0.978, Global test loss: 1.398, Global test accuracy: 55.58
Round  73, Train loss: 0.697, Test loss: 1.206, Test accuracy: 59.79
Round  73, Global train loss: 0.697, Global test loss: 1.286, Global test accuracy: 58.15
Round  74, Train loss: 0.939, Test loss: 1.211, Test accuracy: 59.40
Round  74, Global train loss: 0.939, Global test loss: 1.361, Global test accuracy: 57.38
Round  75, Train loss: 0.902, Test loss: 1.207, Test accuracy: 59.79
Round  75, Global train loss: 0.902, Global test loss: 1.248, Global test accuracy: 60.45
Round  76, Train loss: 1.021, Test loss: 1.200, Test accuracy: 59.98
Round  76, Global train loss: 1.021, Global test loss: 1.371, Global test accuracy: 56.41
Round  77, Train loss: 0.843, Test loss: 1.227, Test accuracy: 59.39
Round  77, Global train loss: 0.843, Global test loss: 1.275, Global test accuracy: 58.76
Round  78, Train loss: 1.007, Test loss: 1.225, Test accuracy: 59.02
Round  78, Global train loss: 1.007, Global test loss: 1.404, Global test accuracy: 55.36
Round  79, Train loss: 0.884, Test loss: 1.226, Test accuracy: 59.17
Round  79, Global train loss: 0.884, Global test loss: 1.330, Global test accuracy: 57.79
Round  80, Train loss: 0.983, Test loss: 1.219, Test accuracy: 59.48
Round  80, Global train loss: 0.983, Global test loss: 1.354, Global test accuracy: 56.84
Round  81, Train loss: 0.931, Test loss: 1.230, Test accuracy: 59.25
Round  81, Global train loss: 0.931, Global test loss: 1.425, Global test accuracy: 54.56
Round  82, Train loss: 0.893, Test loss: 1.219, Test accuracy: 59.56
Round  82, Global train loss: 0.893, Global test loss: 1.470, Global test accuracy: 53.27
Round  83, Train loss: 0.828, Test loss: 1.218, Test accuracy: 59.87
Round  83, Global train loss: 0.828, Global test loss: 1.319, Global test accuracy: 58.27
Round  84, Train loss: 0.805, Test loss: 1.236, Test accuracy: 59.98
Round  84, Global train loss: 0.805, Global test loss: 1.596, Global test accuracy: 52.10
Round  85, Train loss: 0.945, Test loss: 1.247, Test accuracy: 59.52
Round  85, Global train loss: 0.945, Global test loss: 1.419, Global test accuracy: 55.88
Round  86, Train loss: 1.003, Test loss: 1.231, Test accuracy: 60.39
Round  86, Global train loss: 1.003, Global test loss: 1.357, Global test accuracy: 56.37
Round  87, Train loss: 0.875, Test loss: 1.227, Test accuracy: 60.28
Round  87, Global train loss: 0.875, Global test loss: 1.496, Global test accuracy: 55.38
Round  88, Train loss: 0.846, Test loss: 1.251, Test accuracy: 59.44
Round  88, Global train loss: 0.846, Global test loss: 1.344, Global test accuracy: 56.39
Round  89, Train loss: 0.729, Test loss: 1.262, Test accuracy: 59.54
Round  89, Global train loss: 0.729, Global test loss: 1.320, Global test accuracy: 58.88
Round  90, Train loss: 0.930, Test loss: 1.275, Test accuracy: 58.95
Round  90, Global train loss: 0.930, Global test loss: 1.465, Global test accuracy: 53.13
Round  91, Train loss: 0.864, Test loss: 1.274, Test accuracy: 58.59
Round  91, Global train loss: 0.864, Global test loss: 1.435, Global test accuracy: 54.94
Round  92, Train loss: 0.915, Test loss: 1.298, Test accuracy: 58.45
Round  92, Global train loss: 0.915, Global test loss: 1.560, Global test accuracy: 51.77
Round  93, Train loss: 0.759, Test loss: 1.300, Test accuracy: 58.68
Round  93, Global train loss: 0.759, Global test loss: 1.478, Global test accuracy: 55.72
Round  94, Train loss: 0.882, Test loss: 1.295, Test accuracy: 59.01
Round  94, Global train loss: 0.882, Global test loss: 1.502, Global test accuracy: 52.59
Round  95, Train loss: 0.725, Test loss: 1.309, Test accuracy: 58.82
Round  95, Global train loss: 0.725, Global test loss: 1.302, Global test accuracy: 59.25
Round  96, Train loss: 0.862, Test loss: 1.314, Test accuracy: 58.84
Round  96, Global train loss: 0.862, Global test loss: 1.419, Global test accuracy: 56.63
Round  97, Train loss: 0.870, Test loss: 1.315, Test accuracy: 58.72
Round  97, Global train loss: 0.870, Global test loss: 1.584, Global test accuracy: 53.83
Round  98, Train loss: 0.669, Test loss: 1.297, Test accuracy: 59.08
Round  98, Global train loss: 0.669, Global test loss: 1.397, Global test accuracy: 57.32
Round  99, Train loss: 0.800, Test loss: 1.318, Test accuracy: 58.40
Round  99, Global train loss: 0.800, Global test loss: 1.415, Global test accuracy: 55.04
Final Round, Train loss: 0.656, Test loss: 1.432, Test accuracy: 58.65
Final Round, Global train loss: 0.656, Global test loss: 1.415, Global test accuracy: 55.04
Average accuracy final 10 rounds: 58.75333333333333 

Average global accuracy final 10 rounds: 55.022499999999994 

1848.6143395900726
[1.8525714874267578, 3.7051429748535156, 5.300342082977295, 6.895541191101074, 8.44973111152649, 10.003921031951904, 11.605548858642578, 13.207176685333252, 14.609373807907104, 16.011570930480957, 17.403599500656128, 18.7956280708313, 20.179617881774902, 21.563607692718506, 22.979353666305542, 24.395099639892578, 25.78956389427185, 27.184028148651123, 28.622831344604492, 30.06163454055786, 31.469736099243164, 32.87783765792847, 34.27442002296448, 35.67100238800049, 37.08715891838074, 38.503315448760986, 39.90681838989258, 41.31032133102417, 42.70440745353699, 44.098493576049805, 45.516475200653076, 46.93445682525635, 48.374143838882446, 49.813830852508545, 51.23572826385498, 52.657625675201416, 54.134228467941284, 55.61083126068115, 57.00900602340698, 58.40718078613281, 59.86505651473999, 61.32293224334717, 62.77425026893616, 64.22556829452515, 65.66424036026001, 67.10291242599487, 68.52739024162292, 69.95186805725098, 71.35636377334595, 72.76085948944092, 74.11532545089722, 75.46979141235352, 76.92219185829163, 78.37459230422974, 79.79101634025574, 81.20744037628174, 82.64626216888428, 84.08508396148682, 85.5083360671997, 86.9315881729126, 88.36510896682739, 89.79862976074219, 91.2150182723999, 92.63140678405762, 94.03954339027405, 95.44767999649048, 96.83110523223877, 98.21453046798706, 99.60960698127747, 101.00468349456787, 102.42430639266968, 103.84392929077148, 105.29125142097473, 106.73857355117798, 108.12920999526978, 109.51984643936157, 110.90812826156616, 112.29641008377075, 113.71024060249329, 115.12407112121582, 116.52891063690186, 117.93375015258789, 119.31211972236633, 120.69048929214478, 122.06897568702698, 123.44746208190918, 124.8399486541748, 126.23243522644043, 127.61704802513123, 129.00166082382202, 130.37708592414856, 131.7525110244751, 133.15904808044434, 134.56558513641357, 135.9832479953766, 137.4009108543396, 138.82839179039001, 140.25587272644043, 141.6556911468506, 143.05550956726074, 144.4468216896057, 145.83813381195068, 147.23276281356812, 148.62739181518555, 149.99871683120728, 151.370041847229, 152.77015376091003, 154.17026567459106, 155.53812980651855, 156.90599393844604, 158.29211497306824, 159.67823600769043, 161.07148838043213, 162.46474075317383, 163.8479175567627, 165.23109436035156, 166.63069248199463, 168.0302906036377, 169.42292094230652, 170.81555128097534, 172.25355124473572, 173.6915512084961, 175.11266255378723, 176.53377389907837, 177.93163919448853, 179.32950448989868, 180.7000379562378, 182.0705714225769, 183.4754204750061, 184.8802695274353, 186.32510805130005, 187.7699465751648, 189.15593433380127, 190.54192209243774, 191.97820281982422, 193.4144835472107, 194.88250994682312, 196.35053634643555, 197.74749493598938, 199.1444535255432, 200.53424191474915, 201.92403030395508, 203.39039254188538, 204.85675477981567, 206.26015996932983, 207.663565158844, 209.07067394256592, 210.47778272628784, 211.87184405326843, 213.26590538024902, 214.68674230575562, 216.1075792312622, 217.6055200099945, 219.1034607887268, 220.57292366027832, 222.04238653182983, 223.4663200378418, 224.89025354385376, 226.31060242652893, 227.7309513092041, 229.15908479690552, 230.58721828460693, 231.97663187980652, 233.3660454750061, 234.75934958457947, 236.15265369415283, 237.58133912086487, 239.0100245475769, 240.4366455078125, 241.8632664680481, 243.29210925102234, 244.72095203399658, 246.13858199119568, 247.55621194839478, 248.94116306304932, 250.32611417770386, 251.70556831359863, 253.0850224494934, 254.47036600112915, 255.8557095527649, 257.2620701789856, 258.6684308052063, 260.09203028678894, 261.5156297683716, 262.9286723136902, 264.3417148590088, 265.7672417163849, 267.192768573761, 268.65291357040405, 270.1130585670471, 271.5462806224823, 272.9795026779175, 274.346928358078, 275.7143540382385, 277.12588572502136, 278.5374174118042, 279.9353983402252, 281.33337926864624, 282.7191171646118, 284.1048550605774, 286.5156810283661, 288.9265069961548]
[19.808333333333334, 19.808333333333334, 27.908333333333335, 27.908333333333335, 31.4, 31.4, 39.25833333333333, 39.25833333333333, 39.791666666666664, 39.791666666666664, 44.90833333333333, 44.90833333333333, 45.65833333333333, 45.65833333333333, 46.75833333333333, 46.75833333333333, 49.99166666666667, 49.99166666666667, 51.475, 51.475, 51.94166666666667, 51.94166666666667, 51.983333333333334, 51.983333333333334, 52.30833333333333, 52.30833333333333, 53.525, 53.525, 54.69166666666667, 54.69166666666667, 54.725, 54.725, 55.81666666666667, 55.81666666666667, 54.99166666666667, 54.99166666666667, 54.35, 54.35, 56.19166666666667, 56.19166666666667, 56.74166666666667, 56.74166666666667, 57.06666666666667, 57.06666666666667, 58.108333333333334, 58.108333333333334, 58.30833333333333, 58.30833333333333, 58.46666666666667, 58.46666666666667, 58.88333333333333, 58.88333333333333, 59.15, 59.15, 60.5, 60.5, 60.5, 60.5, 60.958333333333336, 60.958333333333336, 61.625, 61.625, 61.833333333333336, 61.833333333333336, 61.85, 61.85, 62.00833333333333, 62.00833333333333, 62.175, 62.175, 61.141666666666666, 61.141666666666666, 60.625, 60.625, 60.925, 60.925, 60.78333333333333, 60.78333333333333, 60.575, 60.575, 60.608333333333334, 60.608333333333334, 60.875, 60.875, 60.85, 60.85, 61.18333333333333, 61.18333333333333, 61.31666666666667, 61.31666666666667, 60.75833333333333, 60.75833333333333, 61.35, 61.35, 60.608333333333334, 60.608333333333334, 61.03333333333333, 61.03333333333333, 61.516666666666666, 61.516666666666666, 61.25833333333333, 61.25833333333333, 60.675, 60.675, 61.25833333333333, 61.25833333333333, 60.90833333333333, 60.90833333333333, 61.025, 61.025, 60.63333333333333, 60.63333333333333, 59.958333333333336, 59.958333333333336, 60.175, 60.175, 59.61666666666667, 59.61666666666667, 59.88333333333333, 59.88333333333333, 60.175, 60.175, 59.59166666666667, 59.59166666666667, 59.291666666666664, 59.291666666666664, 59.65833333333333, 59.65833333333333, 59.825, 59.825, 59.86666666666667, 59.86666666666667, 60.36666666666667, 60.36666666666667, 60.71666666666667, 60.71666666666667, 60.59166666666667, 60.59166666666667, 59.94166666666667, 59.94166666666667, 60.175, 60.175, 59.483333333333334, 59.483333333333334, 59.791666666666664, 59.791666666666664, 59.791666666666664, 59.791666666666664, 59.4, 59.4, 59.791666666666664, 59.791666666666664, 59.975, 59.975, 59.391666666666666, 59.391666666666666, 59.016666666666666, 59.016666666666666, 59.175, 59.175, 59.483333333333334, 59.483333333333334, 59.25, 59.25, 59.55833333333333, 59.55833333333333, 59.86666666666667, 59.86666666666667, 59.983333333333334, 59.983333333333334, 59.525, 59.525, 60.391666666666666, 60.391666666666666, 60.28333333333333, 60.28333333333333, 59.44166666666667, 59.44166666666667, 59.541666666666664, 59.541666666666664, 58.95, 58.95, 58.59166666666667, 58.59166666666667, 58.45, 58.45, 58.68333333333333, 58.68333333333333, 59.00833333333333, 59.00833333333333, 58.81666666666667, 58.81666666666667, 58.84166666666667, 58.84166666666667, 58.71666666666667, 58.71666666666667, 59.075, 59.075, 58.4, 58.4, 58.65, 58.65]/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.853, Test loss: 2.109, Test accuracy: 16.98
Round   0, Global train loss: 1.853, Global test loss: 2.250, Global test accuracy: 13.72
Round   1, Train loss: 1.692, Test loss: 1.939, Test accuracy: 24.93
Round   1, Global train loss: 1.692, Global test loss: 2.169, Global test accuracy: 19.57
Round   2, Train loss: 1.655, Test loss: 1.883, Test accuracy: 31.73
Round   2, Global train loss: 1.655, Global test loss: 2.173, Global test accuracy: 28.52
Round   3, Train loss: 1.522, Test loss: 1.672, Test accuracy: 37.42
Round   3, Global train loss: 1.522, Global test loss: 1.912, Global test accuracy: 33.17
Round   4, Train loss: 1.581, Test loss: 1.592, Test accuracy: 39.46
Round   4, Global train loss: 1.581, Global test loss: 1.889, Global test accuracy: 32.47
Round   5, Train loss: 1.612, Test loss: 1.474, Test accuracy: 43.08
Round   5, Global train loss: 1.612, Global test loss: 1.832, Global test accuracy: 39.38
Round   6, Train loss: 1.362, Test loss: 1.448, Test accuracy: 45.65
Round   6, Global train loss: 1.362, Global test loss: 1.763, Global test accuracy: 40.03
Round   7, Train loss: 1.388, Test loss: 1.438, Test accuracy: 46.39
Round   7, Global train loss: 1.388, Global test loss: 1.758, Global test accuracy: 38.67
Round   8, Train loss: 1.631, Test loss: 1.368, Test accuracy: 50.22
Round   8, Global train loss: 1.631, Global test loss: 1.709, Global test accuracy: 40.36
Round   9, Train loss: 1.472, Test loss: 1.348, Test accuracy: 51.16
Round   9, Global train loss: 1.472, Global test loss: 1.714, Global test accuracy: 40.37
Round  10, Train loss: 1.438, Test loss: 1.340, Test accuracy: 51.35
Round  10, Global train loss: 1.438, Global test loss: 1.785, Global test accuracy: 38.16
Round  11, Train loss: 1.302, Test loss: 1.352, Test accuracy: 51.06
Round  11, Global train loss: 1.302, Global test loss: 1.706, Global test accuracy: 43.90
Round  12, Train loss: 1.308, Test loss: 1.346, Test accuracy: 51.91
Round  12, Global train loss: 1.308, Global test loss: 1.803, Global test accuracy: 44.78
Round  13, Train loss: 1.444, Test loss: 1.343, Test accuracy: 52.77
Round  13, Global train loss: 1.444, Global test loss: 1.719, Global test accuracy: 45.23
Round  14, Train loss: 1.305, Test loss: 1.323, Test accuracy: 53.89
Round  14, Global train loss: 1.305, Global test loss: 1.641, Global test accuracy: 46.89
Round  15, Train loss: 1.405, Test loss: 1.327, Test accuracy: 53.99
Round  15, Global train loss: 1.405, Global test loss: 1.690, Global test accuracy: 45.55
Round  16, Train loss: 1.228, Test loss: 1.327, Test accuracy: 53.98
Round  16, Global train loss: 1.228, Global test loss: 1.753, Global test accuracy: 43.08
Round  17, Train loss: 1.346, Test loss: 1.314, Test accuracy: 55.02
Round  17, Global train loss: 1.346, Global test loss: 1.793, Global test accuracy: 43.33
Round  18, Train loss: 1.127, Test loss: 1.309, Test accuracy: 55.70
Round  18, Global train loss: 1.127, Global test loss: 1.635, Global test accuracy: 47.62
Round  19, Train loss: 1.256, Test loss: 1.306, Test accuracy: 56.37
Round  19, Global train loss: 1.256, Global test loss: 1.565, Global test accuracy: 49.97
Round  20, Train loss: 1.373, Test loss: 1.295, Test accuracy: 56.65
Round  20, Global train loss: 1.373, Global test loss: 1.619, Global test accuracy: 50.11
Round  21, Train loss: 1.300, Test loss: 1.274, Test accuracy: 57.06
Round  21, Global train loss: 1.300, Global test loss: 1.599, Global test accuracy: 48.37
Round  22, Train loss: 1.291, Test loss: 1.282, Test accuracy: 57.17
Round  22, Global train loss: 1.291, Global test loss: 1.700, Global test accuracy: 49.37
Round  23, Train loss: 1.214, Test loss: 1.260, Test accuracy: 57.76
Round  23, Global train loss: 1.214, Global test loss: 1.545, Global test accuracy: 51.08
Round  24, Train loss: 1.170, Test loss: 1.254, Test accuracy: 57.78
Round  24, Global train loss: 1.170, Global test loss: 1.596, Global test accuracy: 51.21
Round  25, Train loss: 1.366, Test loss: 1.270, Test accuracy: 57.91
Round  25, Global train loss: 1.366, Global test loss: 1.563, Global test accuracy: 51.90
Round  26, Train loss: 1.208, Test loss: 1.252, Test accuracy: 58.65
Round  26, Global train loss: 1.208, Global test loss: 1.459, Global test accuracy: 54.87
Round  27, Train loss: 1.154, Test loss: 1.285, Test accuracy: 57.58
Round  27, Global train loss: 1.154, Global test loss: 1.605, Global test accuracy: 50.46
Round  28, Train loss: 1.396, Test loss: 1.278, Test accuracy: 57.83
Round  28, Global train loss: 1.396, Global test loss: 1.627, Global test accuracy: 48.90
Round  29, Train loss: 1.254, Test loss: 1.297, Test accuracy: 57.35
Round  29, Global train loss: 1.254, Global test loss: 1.648, Global test accuracy: 47.95
Round  30, Train loss: 1.176, Test loss: 1.285, Test accuracy: 57.69
Round  30, Global train loss: 1.176, Global test loss: 1.488, Global test accuracy: 51.65
Round  31, Train loss: 1.204, Test loss: 1.260, Test accuracy: 58.11
Round  31, Global train loss: 1.204, Global test loss: 1.529, Global test accuracy: 51.26
Round  32, Train loss: 1.059, Test loss: 1.257, Test accuracy: 57.77
Round  32, Global train loss: 1.059, Global test loss: 1.550, Global test accuracy: 52.02
Round  33, Train loss: 0.965, Test loss: 1.267, Test accuracy: 57.95
Round  33, Global train loss: 0.965, Global test loss: 1.509, Global test accuracy: 53.26
Round  34, Train loss: 1.012, Test loss: 1.259, Test accuracy: 58.62
Round  34, Global train loss: 1.012, Global test loss: 1.419, Global test accuracy: 55.37
Round  35, Train loss: 1.272, Test loss: 1.249, Test accuracy: 58.60
Round  35, Global train loss: 1.272, Global test loss: 1.538, Global test accuracy: 51.74
Round  36, Train loss: 1.209, Test loss: 1.242, Test accuracy: 58.44
Round  36, Global train loss: 1.209, Global test loss: 1.432, Global test accuracy: 52.42
Round  37, Train loss: 1.099, Test loss: 1.203, Test accuracy: 59.18
Round  37, Global train loss: 1.099, Global test loss: 1.475, Global test accuracy: 53.12
Round  38, Train loss: 1.317, Test loss: 1.205, Test accuracy: 59.00
Round  38, Global train loss: 1.317, Global test loss: 1.591, Global test accuracy: 50.06
Round  39, Train loss: 1.321, Test loss: 1.195, Test accuracy: 59.18
Round  39, Global train loss: 1.321, Global test loss: 1.458, Global test accuracy: 53.18
Round  40, Train loss: 1.035, Test loss: 1.205, Test accuracy: 58.64
Round  40, Global train loss: 1.035, Global test loss: 1.355, Global test accuracy: 57.10
Round  41, Train loss: 1.055, Test loss: 1.219, Test accuracy: 58.49
Round  41, Global train loss: 1.055, Global test loss: 1.354, Global test accuracy: 56.27
Round  42, Train loss: 0.998, Test loss: 1.205, Test accuracy: 58.86
Round  42, Global train loss: 0.998, Global test loss: 1.445, Global test accuracy: 53.83
Round  43, Train loss: 1.019, Test loss: 1.186, Test accuracy: 59.50
Round  43, Global train loss: 1.019, Global test loss: 1.432, Global test accuracy: 51.82
Round  44, Train loss: 1.035, Test loss: 1.208, Test accuracy: 58.81
Round  44, Global train loss: 1.035, Global test loss: 1.378, Global test accuracy: 55.66
Round  45, Train loss: 1.018, Test loss: 1.203, Test accuracy: 58.92
Round  45, Global train loss: 1.018, Global test loss: 1.434, Global test accuracy: 52.65
Round  46, Train loss: 0.984, Test loss: 1.211, Test accuracy: 58.60
Round  46, Global train loss: 0.984, Global test loss: 1.505, Global test accuracy: 51.77
Round  47, Train loss: 1.143, Test loss: 1.207, Test accuracy: 59.10
Round  47, Global train loss: 1.143, Global test loss: 1.421, Global test accuracy: 54.33
Round  48, Train loss: 0.826, Test loss: 1.201, Test accuracy: 59.53
Round  48, Global train loss: 0.826, Global test loss: 1.330, Global test accuracy: 56.85
Round  49, Train loss: 1.071, Test loss: 1.197, Test accuracy: 59.74
Round  49, Global train loss: 1.071, Global test loss: 1.476, Global test accuracy: 52.88
Round  50, Train loss: 1.027, Test loss: 1.182, Test accuracy: 60.34
Round  50, Global train loss: 1.027, Global test loss: 1.499, Global test accuracy: 52.65
Round  51, Train loss: 0.974, Test loss: 1.179, Test accuracy: 60.23
Round  51, Global train loss: 0.974, Global test loss: 1.455, Global test accuracy: 53.67
Round  52, Train loss: 1.191, Test loss: 1.189, Test accuracy: 60.03
Round  52, Global train loss: 1.191, Global test loss: 1.395, Global test accuracy: 56.27
Round  53, Train loss: 1.001, Test loss: 1.209, Test accuracy: 59.28
Round  53, Global train loss: 1.001, Global test loss: 1.588, Global test accuracy: 51.83
Round  54, Train loss: 1.017, Test loss: 1.209, Test accuracy: 59.38
Round  54, Global train loss: 1.017, Global test loss: 1.353, Global test accuracy: 56.14
Round  55, Train loss: 1.121, Test loss: 1.229, Test accuracy: 58.22
Round  55, Global train loss: 1.121, Global test loss: 1.486, Global test accuracy: 52.93
Round  56, Train loss: 1.003, Test loss: 1.228, Test accuracy: 58.00
Round  56, Global train loss: 1.003, Global test loss: 1.325, Global test accuracy: 56.84
Round  57, Train loss: 1.001, Test loss: 1.229, Test accuracy: 58.28
Round  57, Global train loss: 1.001, Global test loss: 1.401, Global test accuracy: 55.12
Round  58, Train loss: 0.778, Test loss: 1.216, Test accuracy: 58.66
Round  58, Global train loss: 0.778, Global test loss: 1.442, Global test accuracy: 55.08
Round  59, Train loss: 1.083, Test loss: 1.228, Test accuracy: 58.39
Round  59, Global train loss: 1.083, Global test loss: 1.381, Global test accuracy: 54.90
Round  60, Train loss: 0.876, Test loss: 1.227, Test accuracy: 58.69
Round  60, Global train loss: 0.876, Global test loss: 1.282, Global test accuracy: 59.21
Round  61, Train loss: 1.013, Test loss: 1.252, Test accuracy: 57.82
Round  61, Global train loss: 1.013, Global test loss: 1.366, Global test accuracy: 56.02
Round  62, Train loss: 0.967, Test loss: 1.246, Test accuracy: 57.79
Round  62, Global train loss: 0.967, Global test loss: 1.380, Global test accuracy: 55.95
Round  63, Train loss: 1.093, Test loss: 1.244, Test accuracy: 58.02
Round  63, Global train loss: 1.093, Global test loss: 1.339, Global test accuracy: 57.72
Round  64, Train loss: 0.874, Test loss: 1.248, Test accuracy: 57.76
Round  64, Global train loss: 0.874, Global test loss: 1.286, Global test accuracy: 58.56
Round  65, Train loss: 0.948, Test loss: 1.265, Test accuracy: 57.75
Round  65, Global train loss: 0.948, Global test loss: 1.408, Global test accuracy: 56.97
Round  66, Train loss: 0.877, Test loss: 1.259, Test accuracy: 57.73
Round  66, Global train loss: 0.877, Global test loss: 1.361, Global test accuracy: 56.95
Round  67, Train loss: 0.720, Test loss: 1.268, Test accuracy: 58.06
Round  67, Global train loss: 0.720, Global test loss: 1.492, Global test accuracy: 56.06
Round  68, Train loss: 0.848, Test loss: 1.283, Test accuracy: 57.91
Round  68, Global train loss: 0.848, Global test loss: 1.648, Global test accuracy: 51.00
Round  69, Train loss: 0.782, Test loss: 1.272, Test accuracy: 58.90
Round  69, Global train loss: 0.782, Global test loss: 1.323, Global test accuracy: 58.98
Round  70, Train loss: 0.823, Test loss: 1.265, Test accuracy: 58.90
Round  70, Global train loss: 0.823, Global test loss: 1.440, Global test accuracy: 56.81
Round  71, Train loss: 0.902, Test loss: 1.262, Test accuracy: 58.88
Round  71, Global train loss: 0.902, Global test loss: 1.411, Global test accuracy: 57.26
Round  72, Train loss: 0.884, Test loss: 1.281, Test accuracy: 58.81
Round  72, Global train loss: 0.884, Global test loss: 1.522, Global test accuracy: 53.12
Round  73, Train loss: 0.962, Test loss: 1.277, Test accuracy: 58.86
Round  73, Global train loss: 0.962, Global test loss: 1.460, Global test accuracy: 53.17
Round  74, Train loss: 0.855, Test loss: 1.262, Test accuracy: 58.98
Round  74, Global train loss: 0.855, Global test loss: 1.382, Global test accuracy: 57.53
Round  75, Train loss: 0.891, Test loss: 1.266, Test accuracy: 59.22
Round  75, Global train loss: 0.891, Global test loss: 1.363, Global test accuracy: 57.52
Round  76, Train loss: 0.805, Test loss: 1.279, Test accuracy: 59.19
Round  76, Global train loss: 0.805, Global test loss: 1.363, Global test accuracy: 56.65
Round  77, Train loss: 0.759, Test loss: 1.284, Test accuracy: 59.07
Round  77, Global train loss: 0.759, Global test loss: 1.306, Global test accuracy: 58.58
Round  78, Train loss: 0.808, Test loss: 1.297, Test accuracy: 58.67
Round  78, Global train loss: 0.808, Global test loss: 1.355, Global test accuracy: 57.02
Round  79, Train loss: 0.984, Test loss: 1.297, Test accuracy: 58.84
Round  79, Global train loss: 0.984, Global test loss: 1.428, Global test accuracy: 55.33
Round  80, Train loss: 0.680, Test loss: 1.297, Test accuracy: 58.51
Round  80, Global train loss: 0.680, Global test loss: 1.407, Global test accuracy: 59.12
Round  81, Train loss: 0.885, Test loss: 1.298, Test accuracy: 58.71
Round  81, Global train loss: 0.885, Global test loss: 1.476, Global test accuracy: 54.55
Round  82, Train loss: 0.879, Test loss: 1.292, Test accuracy: 59.68
Round  82, Global train loss: 0.879, Global test loss: 1.567, Global test accuracy: 52.13
Round  83, Train loss: 0.855, Test loss: 1.290, Test accuracy: 59.93
Round  83, Global train loss: 0.855, Global test loss: 1.396, Global test accuracy: 56.30
Round  84, Train loss: 0.760, Test loss: 1.330, Test accuracy: 59.73
Round  84, Global train loss: 0.760, Global test loss: 1.572, Global test accuracy: 51.73
Round  85, Train loss: 0.961, Test loss: 1.338, Test accuracy: 59.47
Round  85, Global train loss: 0.961, Global test loss: 1.427, Global test accuracy: 56.37
Round  86, Train loss: 0.960, Test loss: 1.317, Test accuracy: 60.22
Round  86, Global train loss: 0.960, Global test loss: 1.416, Global test accuracy: 55.66
Round  87, Train loss: 0.865, Test loss: 1.327, Test accuracy: 60.30
Round  87, Global train loss: 0.865, Global test loss: 1.518, Global test accuracy: 53.58
Round  88, Train loss: 0.707, Test loss: 1.344, Test accuracy: 59.90
Round  88, Global train loss: 0.707, Global test loss: 1.394, Global test accuracy: 57.44
Round  89, Train loss: 0.839, Test loss: 1.324, Test accuracy: 60.09
Round  89, Global train loss: 0.839, Global test loss: 1.383, Global test accuracy: 57.43
Round  90, Train loss: 0.709, Test loss: 1.313, Test accuracy: 59.72
Round  90, Global train loss: 0.709, Global test loss: 1.384, Global test accuracy: 57.63
Round  91, Train loss: 0.690, Test loss: 1.341, Test accuracy: 59.80
Round  91, Global train loss: 0.690, Global test loss: 1.547, Global test accuracy: 55.72
Round  92, Train loss: 0.577, Test loss: 1.347, Test accuracy: 60.03
Round  92, Global train loss: 0.577, Global test loss: 1.458, Global test accuracy: 57.04
Round  93, Train loss: 0.826, Test loss: 1.348, Test accuracy: 59.45
Round  93, Global train loss: 0.826, Global test loss: 1.512, Global test accuracy: 55.55
Round  94, Train loss: 0.670, Test loss: 1.363, Test accuracy: 59.31
Round  94, Global train loss: 0.670, Global test loss: 1.422, Global test accuracy: 56.53
Round  95, Train loss: 0.616, Test loss: 1.378, Test accuracy: 59.17
Round  95, Global train loss: 0.616, Global test loss: 1.289, Global test accuracy: 60.23
Round  96, Train loss: 0.815, Test loss: 1.402, Test accuracy: 58.77
Round  96, Global train loss: 0.815, Global test loss: 1.516, Global test accuracy: 56.77
Round  97, Train loss: 0.736, Test loss: 1.389, Test accuracy: 59.02
Round  97, Global train loss: 0.736, Global test loss: 1.576, Global test accuracy: 56.99
Round  98, Train loss: 0.777, Test loss: 1.377, Test accuracy: 59.28
Round  98, Global train loss: 0.777, Global test loss: 1.448, Global test accuracy: 55.60
Round  99, Train loss: 0.693, Test loss: 1.381, Test accuracy: 58.91
Round  99, Global train loss: 0.693, Global test loss: 1.435, Global test accuracy: 56.12
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1612, in filter_data
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * 0.9))]
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1612, in <listcomp>
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * 0.9))]
IndexError: list index out of range
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  17.2100
Round 1 global test acc  16.6700
Round 2 global test acc  15.9400
Round 3 global test acc  20.0600
Round 4 global test acc  25.7000
Round 5 global test acc  28.0600
Round 6 global test acc  24.4500
Round 7 global test acc  32.4400
Round 8 global test acc  29.0900
Round 9 global test acc  29.1100
Round 10 global test acc  29.7200
Round 11 global test acc  29.4600
Round 12 global test acc  38.5900
Round 13 global test acc  35.9500
Round 14 global test acc  31.8200
Round 15 global test acc  29.2100
Round 16 global test acc  32.2800
Round 17 global test acc  34.1000
Round 18 global test acc  33.6200
Round 19 global test acc  33.5300
Round 20 global test acc  31.2300
Round 21 global test acc  33.2200
Round 22 global test acc  32.3000
Round 23 global test acc  31.5500
Round 24 global test acc  31.4200
Round 25 global test acc  32.4100
Round 26 global test acc  36.8900
Round 27 global test acc  36.6000
Round 28 global test acc  35.4100
Round 29 global test acc  32.8500
Round 30 global test acc  36.3800
Round 31 global test acc  38.6400
Round 32 global test acc  39.3400
Round 33 global test acc  41.8000
Round 34 global test acc  38.1200
Round 35 global test acc  36.4000
Round 36 global test acc  35.1900
Round 37 global test acc  37.0100
Round 38 global test acc  38.5000
Round 39 global test acc  40.9000
Round 40 global test acc  40.4600
Round 41 global test acc  39.6600
Round 42 global test acc  34.7500
Round 43 global test acc  38.2200
Round 44 global test acc  40.9300
Round 45 global test acc  41.5600
Round 46 global test acc  48.5600
Round 47 global test acc  39.3600
Round 48 global test acc  37.1700
Round 49 global test acc  39.3000
Round 50 global test acc  34.6400
Round 51 global test acc  40.9500
Round 52 global test acc  43.6400
Round 53 global test acc  38.6500
Round 54 global test acc  44.1200
Round 55 global test acc  40.6500
Round 56 global test acc  37.8500
Round 57 global test acc  46.5100
Round 58 global test acc  42.0300
Round 59 global test acc  36.6200
Round 60 global test acc  45.7200
Round 61 global test acc  40.9800
Round 62 global test acc  35.8600
Round 63 global test acc  41.3800
Round 64 global test acc  39.3400
Round 65 global test acc  42.5300
Round 66 global test acc  39.3600
Round 67 global test acc  37.7500
Round 68 global test acc  37.7000
Round 69 global test acc  43.0600
Round 70 global test acc  44.7700
Round 71 global test acc  42.4300
Round 72 global test acc  41.7200
Round 73 global test acc  42.7200
Round 74 global test acc  45.1400
Round 75 global test acc  44.6100
Round 76 global test acc  43.9200
Round 77 global test acc  45.2400
Round 78 global test acc  42.8800
Round 79 global test acc  37.2100
Round 80 global test acc  35.6700
Round 81 global test acc  33.6400
Round 82 global test acc  32.3800
Round 83 global test acc  32.7200
Round 84 global test acc  31.2600
Round 85 global test acc  31.0900
Round 86 global test acc  30.9600
Round 87 global test acc  29.9900
Round 88 global test acc  28.9400
Round 89 global test acc  28.3900
Round 90 global test acc  28.3400
Round 91 global test acc  30.7700
Round 92 global test acc  30.6200
Round 93 global test acc  29.5300
Round 94 global test acc  28.7500
Round 95 global test acc  28.4000
Round 96 global test acc  28.5900
Round 97 global test acc  27.1800
Round 98 global test acc  25.8300
Round 99 global test acc  25.5300
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.042, Test loss: 2.155, Test accuracy: 13.98
Round   1, Train loss: 1.814, Test loss: 2.051, Test accuracy: 23.10
Round   2, Train loss: 1.685, Test loss: 1.912, Test accuracy: 28.93
Round   3, Train loss: 1.692, Test loss: 1.741, Test accuracy: 36.32
Round   4, Train loss: 1.695, Test loss: 1.625, Test accuracy: 38.83
Round   5, Train loss: 1.528, Test loss: 1.422, Test accuracy: 44.92
Round   6, Train loss: 1.537, Test loss: 1.385, Test accuracy: 47.87
Round   7, Train loss: 1.433, Test loss: 1.392, Test accuracy: 47.62
Round   8, Train loss: 1.618, Test loss: 1.311, Test accuracy: 52.11
Round   9, Train loss: 1.339, Test loss: 1.274, Test accuracy: 54.04
Round  10, Train loss: 1.492, Test loss: 1.264, Test accuracy: 54.30
Round  11, Train loss: 1.385, Test loss: 1.248, Test accuracy: 55.13
Round  12, Train loss: 1.506, Test loss: 1.260, Test accuracy: 55.67
Round  13, Train loss: 1.473, Test loss: 1.258, Test accuracy: 56.83
Round  14, Train loss: 1.445, Test loss: 1.202, Test accuracy: 57.99
Round  15, Train loss: 1.505, Test loss: 1.239, Test accuracy: 57.99
Round  16, Train loss: 1.366, Test loss: 1.210, Test accuracy: 58.72
Round  17, Train loss: 1.539, Test loss: 1.205, Test accuracy: 58.98
Round  18, Train loss: 1.357, Test loss: 1.200, Test accuracy: 59.34
Round  19, Train loss: 1.260, Test loss: 1.145, Test accuracy: 59.75
Round  20, Train loss: 1.397, Test loss: 1.165, Test accuracy: 60.39
Round  21, Train loss: 1.244, Test loss: 1.154, Test accuracy: 60.13
Round  22, Train loss: 1.471, Test loss: 1.158, Test accuracy: 61.54
Round  23, Train loss: 1.381, Test loss: 1.122, Test accuracy: 62.19
Round  24, Train loss: 1.275, Test loss: 1.099, Test accuracy: 62.64
Round  25, Train loss: 1.368, Test loss: 1.085, Test accuracy: 63.27
Round  26, Train loss: 1.451, Test loss: 1.099, Test accuracy: 63.24
Round  27, Train loss: 1.362, Test loss: 1.099, Test accuracy: 63.27
Round  28, Train loss: 1.394, Test loss: 1.093, Test accuracy: 63.49
Round  29, Train loss: 1.274, Test loss: 1.085, Test accuracy: 64.24
Round  30, Train loss: 1.112, Test loss: 1.065, Test accuracy: 64.61
Round  31, Train loss: 1.356, Test loss: 1.084, Test accuracy: 64.34
Round  32, Train loss: 1.282, Test loss: 1.077, Test accuracy: 64.14
Round  33, Train loss: 0.988, Test loss: 1.057, Test accuracy: 64.47
Round  34, Train loss: 1.318, Test loss: 1.044, Test accuracy: 64.77
Round  35, Train loss: 1.431, Test loss: 1.066, Test accuracy: 65.53
Round  36, Train loss: 1.357, Test loss: 1.039, Test accuracy: 65.55
Round  37, Train loss: 1.168, Test loss: 1.033, Test accuracy: 66.75
Round  38, Train loss: 1.185, Test loss: 1.013, Test accuracy: 66.30
Round  39, Train loss: 1.272, Test loss: 1.032, Test accuracy: 67.03
Round  40, Train loss: 1.122, Test loss: 1.025, Test accuracy: 67.29
Round  41, Train loss: 1.269, Test loss: 1.008, Test accuracy: 67.06
Round  42, Train loss: 1.189, Test loss: 1.004, Test accuracy: 67.53
Round  43, Train loss: 1.000, Test loss: 1.004, Test accuracy: 67.35
Round  44, Train loss: 1.264, Test loss: 1.008, Test accuracy: 67.30
Round  45, Train loss: 1.238, Test loss: 0.989, Test accuracy: 67.08
Round  46, Train loss: 1.123, Test loss: 0.980, Test accuracy: 67.22
Round  47, Train loss: 1.222, Test loss: 0.975, Test accuracy: 67.65
Round  48, Train loss: 1.103, Test loss: 0.979, Test accuracy: 68.19
Round  49, Train loss: 1.226, Test loss: 0.990, Test accuracy: 67.97
Round  50, Train loss: 0.984, Test loss: 0.961, Test accuracy: 68.34
Round  51, Train loss: 1.193, Test loss: 0.969, Test accuracy: 69.01
Round  52, Train loss: 1.352, Test loss: 0.979, Test accuracy: 69.25
Round  53, Train loss: 1.197, Test loss: 0.970, Test accuracy: 69.04
Round  54, Train loss: 1.204, Test loss: 0.963, Test accuracy: 69.51
Round  55, Train loss: 1.269, Test loss: 0.957, Test accuracy: 69.23
Round  56, Train loss: 1.002, Test loss: 0.947, Test accuracy: 68.78
Round  57, Train loss: 1.212, Test loss: 0.955, Test accuracy: 68.98
Round  58, Train loss: 1.152, Test loss: 0.949, Test accuracy: 69.42
Round  59, Train loss: 1.170, Test loss: 0.939, Test accuracy: 69.40
Round  60, Train loss: 1.140, Test loss: 0.956, Test accuracy: 69.33
Round  61, Train loss: 1.181, Test loss: 0.951, Test accuracy: 69.77
Round  62, Train loss: 1.112, Test loss: 0.934, Test accuracy: 70.24
Round  63, Train loss: 1.167, Test loss: 0.932, Test accuracy: 70.53
Round  64, Train loss: 1.000, Test loss: 0.932, Test accuracy: 69.64
Round  65, Train loss: 1.049, Test loss: 0.924, Test accuracy: 69.28
Round  66, Train loss: 0.893, Test loss: 0.921, Test accuracy: 69.73
Round  67, Train loss: 1.132, Test loss: 0.909, Test accuracy: 69.80
Round  68, Train loss: 0.887, Test loss: 0.910, Test accuracy: 69.90
Round  69, Train loss: 0.969, Test loss: 0.930, Test accuracy: 69.85
Round  70, Train loss: 1.020, Test loss: 0.908, Test accuracy: 69.77
Round  71, Train loss: 1.122, Test loss: 0.921, Test accuracy: 68.98
Round  72, Train loss: 0.906, Test loss: 0.920, Test accuracy: 69.69
Round  73, Train loss: 0.969, Test loss: 0.908, Test accuracy: 69.83
Round  74, Train loss: 1.096, Test loss: 0.930, Test accuracy: 69.53
Round  75, Train loss: 1.096, Test loss: 0.931, Test accuracy: 69.47
Round  76, Train loss: 1.187, Test loss: 0.940, Test accuracy: 69.58
Round  77, Train loss: 1.153, Test loss: 0.939, Test accuracy: 68.93
Round  78, Train loss: 0.822, Test loss: 0.917, Test accuracy: 69.91
Round  79, Train loss: 1.316, Test loss: 0.928, Test accuracy: 69.52
Round  80, Train loss: 0.973, Test loss: 0.925, Test accuracy: 68.96
Round  81, Train loss: 1.070, Test loss: 0.938, Test accuracy: 68.95
Round  82, Train loss: 1.011, Test loss: 0.920, Test accuracy: 69.60
Round  83, Train loss: 0.967, Test loss: 0.921, Test accuracy: 69.33
Round  84, Train loss: 1.129, Test loss: 0.945, Test accuracy: 68.37
Round  85, Train loss: 1.161, Test loss: 0.943, Test accuracy: 68.14
Round  86, Train loss: 0.910, Test loss: 0.926, Test accuracy: 69.17
Round  87, Train loss: 1.120, Test loss: 0.940, Test accuracy: 68.64
Round  88, Train loss: 0.893, Test loss: 0.932, Test accuracy: 68.87
Round  89, Train loss: 1.099, Test loss: 0.935, Test accuracy: 68.43
Round  90, Train loss: 0.853, Test loss: 0.930, Test accuracy: 68.67
Round  91, Train loss: 1.036, Test loss: 0.950, Test accuracy: 67.77
Round  92, Train loss: 0.729, Test loss: 0.937, Test accuracy: 68.20
Round  93, Train loss: 1.140, Test loss: 0.949, Test accuracy: 67.65
Round  94, Train loss: 0.823, Test loss: 0.941, Test accuracy: 67.97
Round  95, Train loss: 0.842, Test loss: 0.941, Test accuracy: 67.98
Round  96, Train loss: 0.897, Test loss: 0.939, Test accuracy: 68.39
Round  97, Train loss: 1.007, Test loss: 0.947, Test accuracy: 67.76
Round  98, Train loss: 0.959, Test loss: 0.940, Test accuracy: 68.19
Round  99, Train loss: 0.836, Test loss: 0.937, Test accuracy: 68.26
Final Round, Train loss: 0.869, Test loss: 0.951, Test accuracy: 67.94
Average accuracy final 10 rounds: 68.08416666666666
1253.4803130626678
[1.951425552368164, 3.654789447784424, 5.319068670272827, 6.86025071144104, 8.412466287612915, 9.92088508605957, 11.44185471534729, 12.976142406463623, 14.508023262023926, 16.05896234512329, 17.543781757354736, 19.094510316848755, 20.591498374938965, 22.13880205154419, 23.682698011398315, 25.245708465576172, 26.758909702301025, 28.26837182044983, 29.79178547859192, 31.305016040802002, 32.84082770347595, 34.33151865005493, 35.85404348373413, 37.38929080963135, 38.91006565093994, 40.48974657058716, 42.06352424621582, 43.654367208480835, 45.16680669784546, 46.65446352958679, 48.26085186004639, 49.831722259521484, 51.37832689285278, 52.93872570991516, 54.48351836204529, 55.996947050094604, 57.56521964073181, 59.12688064575195, 60.63208746910095, 62.1917040348053, 63.724316120147705, 65.25985360145569, 66.79958629608154, 68.38889074325562, 69.88981819152832, 71.37905526161194, 72.9588303565979, 74.51784372329712, 76.07000875473022, 77.6302752494812, 79.18805122375488, 80.72963905334473, 82.37618160247803, 84.01747727394104, 85.59382367134094, 87.1967043876648, 88.77172017097473, 90.36573243141174, 91.95283555984497, 93.5496301651001, 95.17486667633057, 96.72515606880188, 98.28826713562012, 99.85322427749634, 101.50072026252747, 103.02192568778992, 104.65752267837524, 106.20858120918274, 107.76650857925415, 109.29275345802307, 110.81688165664673, 112.33348655700684, 113.88297605514526, 115.42877149581909, 116.99030303955078, 118.61979842185974, 120.16152215003967, 121.67574334144592, 123.17415404319763, 124.68296480178833, 126.23604559898376, 127.82815718650818, 129.37060165405273, 130.97474575042725, 132.492493391037, 134.06110644340515, 135.5833294391632, 137.09333157539368, 138.61637115478516, 140.13436365127563, 141.62894225120544, 143.16302824020386, 144.76604175567627, 146.35854268074036, 147.95286226272583, 149.555979013443, 151.11193561553955, 152.65763092041016, 154.20669150352478, 155.76621270179749, 157.8828935623169]
[13.983333333333333, 23.1, 28.925, 36.31666666666667, 38.833333333333336, 44.916666666666664, 47.86666666666667, 47.625, 52.108333333333334, 54.041666666666664, 54.3, 55.13333333333333, 55.666666666666664, 56.825, 57.99166666666667, 57.99166666666667, 58.71666666666667, 58.975, 59.34166666666667, 59.75, 60.391666666666666, 60.13333333333333, 61.541666666666664, 62.19166666666667, 62.641666666666666, 63.275, 63.24166666666667, 63.266666666666666, 63.49166666666667, 64.24166666666666, 64.60833333333333, 64.34166666666667, 64.14166666666667, 64.46666666666667, 64.76666666666667, 65.525, 65.55, 66.75, 66.3, 67.03333333333333, 67.29166666666667, 67.05833333333334, 67.53333333333333, 67.35, 67.3, 67.075, 67.225, 67.65, 68.19166666666666, 67.96666666666667, 68.34166666666667, 69.00833333333334, 69.25, 69.04166666666667, 69.50833333333334, 69.23333333333333, 68.78333333333333, 68.98333333333333, 69.41666666666667, 69.4, 69.325, 69.76666666666667, 70.24166666666666, 70.53333333333333, 69.64166666666667, 69.28333333333333, 69.73333333333333, 69.8, 69.9, 69.85, 69.76666666666667, 68.98333333333333, 69.69166666666666, 69.83333333333333, 69.53333333333333, 69.475, 69.575, 68.93333333333334, 69.90833333333333, 69.51666666666667, 68.95833333333333, 68.95, 69.6, 69.33333333333333, 68.36666666666666, 68.14166666666667, 69.16666666666667, 68.64166666666667, 68.86666666666666, 68.43333333333334, 68.675, 67.76666666666667, 68.2, 67.65, 67.96666666666667, 67.98333333333333, 68.39166666666667, 67.75833333333334, 68.19166666666666, 68.25833333333334, 67.94166666666666]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.854, Test loss: 2.063, Test accuracy: 19.15
Round   0, Global train loss: 1.854, Global test loss: 2.207, Global test accuracy: 15.61
Round   1, Train loss: 1.728, Test loss: 1.856, Test accuracy: 28.46
Round   1, Global train loss: 1.728, Global test loss: 2.077, Global test accuracy: 24.13
Round   2, Train loss: 1.707, Test loss: 1.828, Test accuracy: 32.57
Round   2, Global train loss: 1.707, Global test loss: 2.122, Global test accuracy: 27.62
Round   3, Train loss: 1.704, Test loss: 1.664, Test accuracy: 39.02
Round   3, Global train loss: 1.704, Global test loss: 1.949, Global test accuracy: 34.22
Round   4, Train loss: 1.695, Test loss: 1.552, Test accuracy: 42.25
Round   4, Global train loss: 1.695, Global test loss: 1.885, Global test accuracy: 32.67
Round   5, Train loss: 1.594, Test loss: 1.418, Test accuracy: 46.64
Round   5, Global train loss: 1.594, Global test loss: 1.765, Global test accuracy: 40.04
Round   6, Train loss: 1.494, Test loss: 1.394, Test accuracy: 47.88
Round   6, Global train loss: 1.494, Global test loss: 1.730, Global test accuracy: 39.41
Round   7, Train loss: 1.482, Test loss: 1.390, Test accuracy: 48.37
Round   7, Global train loss: 1.482, Global test loss: 1.830, Global test accuracy: 33.48
Round   8, Train loss: 1.454, Test loss: 1.297, Test accuracy: 52.48
Round   8, Global train loss: 1.454, Global test loss: 1.597, Global test accuracy: 45.88
Round   9, Train loss: 1.364, Test loss: 1.286, Test accuracy: 53.02
Round   9, Global train loss: 1.364, Global test loss: 1.590, Global test accuracy: 42.13
Round  10, Train loss: 1.524, Test loss: 1.282, Test accuracy: 53.53
Round  10, Global train loss: 1.524, Global test loss: 1.699, Global test accuracy: 37.92
Round  11, Train loss: 1.303, Test loss: 1.255, Test accuracy: 54.25
Round  11, Global train loss: 1.303, Global test loss: 1.549, Global test accuracy: 46.12
Round  12, Train loss: 1.319, Test loss: 1.227, Test accuracy: 55.42
Round  12, Global train loss: 1.319, Global test loss: 1.595, Global test accuracy: 46.91
Round  13, Train loss: 1.453, Test loss: 1.215, Test accuracy: 55.74
Round  13, Global train loss: 1.453, Global test loss: 1.558, Global test accuracy: 47.98
Round  14, Train loss: 1.448, Test loss: 1.205, Test accuracy: 56.12
Round  14, Global train loss: 1.448, Global test loss: 1.550, Global test accuracy: 49.12
Round  15, Train loss: 1.516, Test loss: 1.193, Test accuracy: 57.00
Round  15, Global train loss: 1.516, Global test loss: 1.600, Global test accuracy: 47.42
Round  16, Train loss: 1.302, Test loss: 1.177, Test accuracy: 57.25
Round  16, Global train loss: 1.302, Global test loss: 1.504, Global test accuracy: 48.08
Round  17, Train loss: 1.390, Test loss: 1.170, Test accuracy: 57.48
Round  17, Global train loss: 1.390, Global test loss: 1.535, Global test accuracy: 48.16
Round  18, Train loss: 1.237, Test loss: 1.160, Test accuracy: 58.41
Round  18, Global train loss: 1.237, Global test loss: 1.400, Global test accuracy: 53.34
Round  19, Train loss: 1.291, Test loss: 1.133, Test accuracy: 59.83
Round  19, Global train loss: 1.291, Global test loss: 1.444, Global test accuracy: 51.54
Round  20, Train loss: 1.375, Test loss: 1.123, Test accuracy: 60.67
Round  20, Global train loss: 1.375, Global test loss: 1.428, Global test accuracy: 53.41
Round  21, Train loss: 1.250, Test loss: 1.125, Test accuracy: 60.80
Round  21, Global train loss: 1.250, Global test loss: 1.375, Global test accuracy: 54.81
Round  22, Train loss: 1.207, Test loss: 1.132, Test accuracy: 60.52
Round  22, Global train loss: 1.207, Global test loss: 1.523, Global test accuracy: 51.74
Round  23, Train loss: 1.253, Test loss: 1.124, Test accuracy: 60.89
Round  23, Global train loss: 1.253, Global test loss: 1.413, Global test accuracy: 54.93
Round  24, Train loss: 1.292, Test loss: 1.118, Test accuracy: 61.16
Round  24, Global train loss: 1.292, Global test loss: 1.457, Global test accuracy: 54.02
Round  25, Train loss: 1.301, Test loss: 1.120, Test accuracy: 61.38
Round  25, Global train loss: 1.301, Global test loss: 1.321, Global test accuracy: 57.37
Round  26, Train loss: 1.259, Test loss: 1.115, Test accuracy: 61.42
Round  26, Global train loss: 1.259, Global test loss: 1.318, Global test accuracy: 57.22
Round  27, Train loss: 1.365, Test loss: 1.112, Test accuracy: 61.39
Round  27, Global train loss: 1.365, Global test loss: 1.430, Global test accuracy: 54.09
Round  28, Train loss: 1.359, Test loss: 1.096, Test accuracy: 61.48
Round  28, Global train loss: 1.359, Global test loss: 1.407, Global test accuracy: 53.91
Round  29, Train loss: 1.229, Test loss: 1.090, Test accuracy: 61.64
Round  29, Global train loss: 1.229, Global test loss: 1.356, Global test accuracy: 56.11
Round  30, Train loss: 1.101, Test loss: 1.094, Test accuracy: 61.93
Round  30, Global train loss: 1.101, Global test loss: 1.343, Global test accuracy: 56.15
Round  31, Train loss: 1.345, Test loss: 1.100, Test accuracy: 61.50
Round  31, Global train loss: 1.345, Global test loss: 1.400, Global test accuracy: 53.75
Round  32, Train loss: 1.168, Test loss: 1.106, Test accuracy: 61.62
Round  32, Global train loss: 1.168, Global test loss: 1.429, Global test accuracy: 53.84
Round  33, Train loss: 1.080, Test loss: 1.101, Test accuracy: 61.88
Round  33, Global train loss: 1.080, Global test loss: 1.304, Global test accuracy: 57.86
Round  34, Train loss: 1.223, Test loss: 1.110, Test accuracy: 61.40
Round  34, Global train loss: 1.223, Global test loss: 1.394, Global test accuracy: 56.27
Round  35, Train loss: 1.287, Test loss: 1.110, Test accuracy: 61.76
Round  35, Global train loss: 1.287, Global test loss: 1.428, Global test accuracy: 53.56
Round  36, Train loss: 1.241, Test loss: 1.110, Test accuracy: 61.59
Round  36, Global train loss: 1.241, Global test loss: 1.457, Global test accuracy: 50.83
Round  37, Train loss: 1.012, Test loss: 1.110, Test accuracy: 61.36
Round  37, Global train loss: 1.012, Global test loss: 1.363, Global test accuracy: 56.02
Round  38, Train loss: 1.042, Test loss: 1.135, Test accuracy: 60.50
Round  38, Global train loss: 1.042, Global test loss: 1.369, Global test accuracy: 53.70
Round  39, Train loss: 1.033, Test loss: 1.142, Test accuracy: 60.42
Round  39, Global train loss: 1.033, Global test loss: 1.300, Global test accuracy: 57.38
Round  40, Train loss: 1.109, Test loss: 1.135, Test accuracy: 60.71
Round  40, Global train loss: 1.109, Global test loss: 1.275, Global test accuracy: 59.48
Round  41, Train loss: 1.057, Test loss: 1.106, Test accuracy: 61.80
Round  41, Global train loss: 1.057, Global test loss: 1.254, Global test accuracy: 59.30
Round  42, Train loss: 1.113, Test loss: 1.121, Test accuracy: 61.54
Round  42, Global train loss: 1.113, Global test loss: 1.377, Global test accuracy: 55.87
Round  43, Train loss: 0.963, Test loss: 1.125, Test accuracy: 61.91
Round  43, Global train loss: 0.963, Global test loss: 1.284, Global test accuracy: 58.10
Round  44, Train loss: 1.221, Test loss: 1.138, Test accuracy: 61.06
Round  44, Global train loss: 1.221, Global test loss: 1.414, Global test accuracy: 54.98
Round  45, Train loss: 1.100, Test loss: 1.146, Test accuracy: 60.91
Round  45, Global train loss: 1.100, Global test loss: 1.455, Global test accuracy: 53.50
Round  46, Train loss: 1.094, Test loss: 1.157, Test accuracy: 60.32
Round  46, Global train loss: 1.094, Global test loss: 1.419, Global test accuracy: 55.77
Round  47, Train loss: 1.056, Test loss: 1.161, Test accuracy: 60.40
Round  47, Global train loss: 1.056, Global test loss: 1.356, Global test accuracy: 56.30
Round  48, Train loss: 0.944, Test loss: 1.185, Test accuracy: 59.77
Round  48, Global train loss: 0.944, Global test loss: 1.319, Global test accuracy: 57.17
Round  49, Train loss: 1.149, Test loss: 1.158, Test accuracy: 60.58
Round  49, Global train loss: 1.149, Global test loss: 1.477, Global test accuracy: 53.60
Round  50, Train loss: 0.955, Test loss: 1.172, Test accuracy: 60.16
Round  50, Global train loss: 0.955, Global test loss: 1.396, Global test accuracy: 54.46
Round  51, Train loss: 0.855, Test loss: 1.193, Test accuracy: 59.84
Round  51, Global train loss: 0.855, Global test loss: 1.354, Global test accuracy: 56.15
Round  52, Train loss: 1.075, Test loss: 1.199, Test accuracy: 59.70
Round  52, Global train loss: 1.075, Global test loss: 1.372, Global test accuracy: 56.08
Round  53, Train loss: 1.059, Test loss: 1.214, Test accuracy: 59.42
Round  53, Global train loss: 1.059, Global test loss: 1.627, Global test accuracy: 49.59
Round  54, Train loss: 0.999, Test loss: 1.216, Test accuracy: 59.16
Round  54, Global train loss: 0.999, Global test loss: 1.329, Global test accuracy: 56.48
Round  55, Train loss: 1.000, Test loss: 1.217, Test accuracy: 59.16
Round  55, Global train loss: 1.000, Global test loss: 1.401, Global test accuracy: 55.30
Round  56, Train loss: 0.918, Test loss: 1.202, Test accuracy: 59.68
Round  56, Global train loss: 0.918, Global test loss: 1.266, Global test accuracy: 59.03
Round  57, Train loss: 1.118, Test loss: 1.199, Test accuracy: 59.78
Round  57, Global train loss: 1.118, Global test loss: 1.437, Global test accuracy: 53.18
Round  58, Train loss: 0.947, Test loss: 1.191, Test accuracy: 59.67
Round  58, Global train loss: 0.947, Global test loss: 1.507, Global test accuracy: 52.49
Round  59, Train loss: 0.973, Test loss: 1.201, Test accuracy: 59.31
Round  59, Global train loss: 0.973, Global test loss: 1.354, Global test accuracy: 56.31
Round  60, Train loss: 0.868, Test loss: 1.232, Test accuracy: 58.54
Round  60, Global train loss: 0.868, Global test loss: 1.352, Global test accuracy: 57.86
Round  61, Train loss: 1.118, Test loss: 1.221, Test accuracy: 58.79
Round  61, Global train loss: 1.118, Global test loss: 1.369, Global test accuracy: 56.08
Round  62, Train loss: 0.827, Test loss: 1.238, Test accuracy: 58.41
Round  62, Global train loss: 0.827, Global test loss: 1.333, Global test accuracy: 57.78
Round  63, Train loss: 0.990, Test loss: 1.239, Test accuracy: 58.16
Round  63, Global train loss: 0.990, Global test loss: 1.291, Global test accuracy: 58.27
Round  64, Train loss: 0.885, Test loss: 1.245, Test accuracy: 58.78
Round  64, Global train loss: 0.885, Global test loss: 1.327, Global test accuracy: 58.62
Round  65, Train loss: 0.774, Test loss: 1.260, Test accuracy: 58.52
Round  65, Global train loss: 0.774, Global test loss: 1.352, Global test accuracy: 58.47
Round  66, Train loss: 0.877, Test loss: 1.274, Test accuracy: 57.86
Round  66, Global train loss: 0.877, Global test loss: 1.315, Global test accuracy: 57.95
Round  67, Train loss: 0.816, Test loss: 1.286, Test accuracy: 57.15
Round  67, Global train loss: 0.816, Global test loss: 1.449, Global test accuracy: 53.73
Round  68, Train loss: 0.929, Test loss: 1.283, Test accuracy: 57.82
Round  68, Global train loss: 0.929, Global test loss: 1.555, Global test accuracy: 52.39
Round  69, Train loss: 0.728, Test loss: 1.284, Test accuracy: 58.31
Round  69, Global train loss: 0.728, Global test loss: 1.311, Global test accuracy: 59.31
Round  70, Train loss: 0.893, Test loss: 1.285, Test accuracy: 58.89
Round  70, Global train loss: 0.893, Global test loss: 1.435, Global test accuracy: 55.90
Round  71, Train loss: 0.906, Test loss: 1.315, Test accuracy: 58.65
Round  71, Global train loss: 0.906, Global test loss: 1.428, Global test accuracy: 55.19
Round  72, Train loss: 0.764, Test loss: 1.321, Test accuracy: 58.38
Round  72, Global train loss: 0.764, Global test loss: 1.553, Global test accuracy: 52.42
Round  73, Train loss: 0.758, Test loss: 1.306, Test accuracy: 58.79
Round  73, Global train loss: 0.758, Global test loss: 1.382, Global test accuracy: 55.98
Round  74, Train loss: 0.779, Test loss: 1.332, Test accuracy: 58.22
Round  74, Global train loss: 0.779, Global test loss: 1.435, Global test accuracy: 56.75
Round  75, Train loss: 0.971, Test loss: 1.347, Test accuracy: 58.30
Round  75, Global train loss: 0.971, Global test loss: 1.356, Global test accuracy: 57.37
Round  76, Train loss: 0.822, Test loss: 1.331, Test accuracy: 58.64
Round  76, Global train loss: 0.822, Global test loss: 1.451, Global test accuracy: 54.40
Round  77, Train loss: 0.790, Test loss: 1.329, Test accuracy: 58.68
Round  77, Global train loss: 0.790, Global test loss: 1.368, Global test accuracy: 57.12
Round  78, Train loss: 0.757, Test loss: 1.328, Test accuracy: 58.99
Round  78, Global train loss: 0.757, Global test loss: 1.367, Global test accuracy: 57.77
Round  79, Train loss: 0.881, Test loss: 1.336, Test accuracy: 58.47
Round  79, Global train loss: 0.881, Global test loss: 1.391, Global test accuracy: 55.68
Round  80, Train loss: 0.890, Test loss: 1.337, Test accuracy: 58.44
Round  80, Global train loss: 0.890, Global test loss: 1.439, Global test accuracy: 56.32
Round  81, Train loss: 0.924, Test loss: 1.330, Test accuracy: 58.46
Round  81, Global train loss: 0.924, Global test loss: 1.575, Global test accuracy: 51.40
Round  82, Train loss: 0.668, Test loss: 1.343, Test accuracy: 58.18
Round  82, Global train loss: 0.668, Global test loss: 1.594, Global test accuracy: 53.90
Round  83, Train loss: 0.755, Test loss: 1.363, Test accuracy: 57.58
Round  83, Global train loss: 0.755, Global test loss: 1.422, Global test accuracy: 55.99
Round  84, Train loss: 0.686, Test loss: 1.345, Test accuracy: 58.21
Round  84, Global train loss: 0.686, Global test loss: 1.500, Global test accuracy: 53.52
Round  85, Train loss: 0.770, Test loss: 1.374, Test accuracy: 57.73
Round  85, Global train loss: 0.770, Global test loss: 1.433, Global test accuracy: 56.48
Round  86, Train loss: 0.748, Test loss: 1.387, Test accuracy: 58.06
Round  86, Global train loss: 0.748, Global test loss: 1.309, Global test accuracy: 59.56
Round  87, Train loss: 0.700, Test loss: 1.374, Test accuracy: 58.33
Round  87, Global train loss: 0.700, Global test loss: 1.562, Global test accuracy: 54.46
Round  88, Train loss: 0.653, Test loss: 1.390, Test accuracy: 58.17
Round  88, Global train loss: 0.653, Global test loss: 1.352, Global test accuracy: 59.05
Round  89, Train loss: 0.777, Test loss: 1.369, Test accuracy: 58.77
Round  89, Global train loss: 0.777, Global test loss: 1.391, Global test accuracy: 57.58
Round  90, Train loss: 0.589, Test loss: 1.367, Test accuracy: 58.72
Round  90, Global train loss: 0.589, Global test loss: 1.431, Global test accuracy: 57.38
Round  91, Train loss: 0.965, Test loss: 1.384, Test accuracy: 58.19
Round  91, Global train loss: 0.965, Global test loss: 1.605, Global test accuracy: 51.75
Round  92, Train loss: 0.625, Test loss: 1.381, Test accuracy: 58.38
Round  92, Global train loss: 0.625, Global test loss: 1.504, Global test accuracy: 55.80
Round  93, Train loss: 0.825, Test loss: 1.402, Test accuracy: 58.48
Round  93, Global train loss: 0.825, Global test loss: 1.525, Global test accuracy: 54.18
Round  94, Train loss: 0.640, Test loss: 1.412, Test accuracy: 58.29
Round  94, Global train loss: 0.640, Global test loss: 1.463, Global test accuracy: 56.38
Round  95, Train loss: 0.610, Test loss: 1.440, Test accuracy: 57.99
Round  95, Global train loss: 0.610, Global test loss: 1.351, Global test accuracy: 59.48
Round  96, Train loss: 0.843, Test loss: 1.439, Test accuracy: 57.86
Round  96, Global train loss: 0.843, Global test loss: 1.549, Global test accuracy: 55.02
Round  97, Train loss: 0.798, Test loss: 1.440, Test accuracy: 57.87
Round  97, Global train loss: 0.798, Global test loss: 1.624, Global test accuracy: 53.38
Round  98, Train loss: 0.678, Test loss: 1.438, Test accuracy: 57.74
Round  98, Global train loss: 0.678, Global test loss: 1.487, Global test accuracy: 56.52
Round  99, Train loss: 0.672, Test loss: 1.446, Test accuracy: 58.27
Round  99, Global train loss: 0.672, Global test loss: 1.415, Global test accuracy: 57.83
Final Round, Train loss: 0.540, Test loss: 1.634, Test accuracy: 58.27
Final Round, Global train loss: 0.540, Global test loss: 1.415, Global test accuracy: 57.83
Average accuracy final 10 rounds: 58.17833333333334
Average global accuracy final 10 rounds: 55.76999999999999
2834.9107282161713
[1.7368555068969727, 3.207017183303833, 4.562674045562744, 5.899271726608276, 7.248640298843384, 8.590663433074951, 9.939585447311401, 11.282657861709595, 12.605173110961914, 13.921182632446289, 15.239485502243042, 16.58764958381653, 17.91225004196167, 19.24839973449707, 20.594311952590942, 21.946441173553467, 23.279793977737427, 24.606825351715088, 25.953339099884033, 27.27904987335205, 28.65338110923767, 33.26012110710144, 37.44333577156067, 41.849385023117065, 46.05305051803589, 50.36100506782532, 54.62345767021179, 58.78950262069702, 63.20388197898865, 67.47134065628052, 71.68257331848145, 76.14067959785461, 80.54431748390198, 85.14223599433899, 89.65558195114136, 94.10069251060486, 98.74366402626038, 103.43385410308838, 107.86478304862976, 112.35470056533813, 116.65999579429626, 121.40184712409973, 125.78545641899109, 130.32913494110107, 134.78454661369324, 139.04376888275146, 143.9688582420349, 148.35029339790344, 152.7925090789795, 157.11352157592773, 161.45720052719116, 165.9256682395935, 170.28087496757507, 174.72128653526306, 179.1737880706787, 183.59728503227234, 187.94543719291687, 192.23413252830505, 196.4256591796875, 201.11077547073364, 205.52310347557068, 209.96545433998108, 214.51011872291565, 218.87313413619995, 223.59635710716248, 227.86656141281128, 232.33744835853577, 236.88907957077026, 241.29460787773132, 245.92002391815186, 250.29824256896973, 254.7107903957367, 259.2016649246216, 263.8225927352905, 268.31487679481506, 272.7421233654022, 277.06547951698303, 281.460652589798, 285.9753098487854, 290.87473011016846, 295.4774043560028, 299.7722692489624, 304.6505699157715, 309.16882133483887, 313.68404030799866, 318.16759061813354, 322.5838317871094, 326.98957347869873, 331.46179604530334, 335.74939012527466, 340.2469620704651, 344.45909428596497, 348.80811381340027, 353.23439621925354, 357.6709063053131, 361.98233914375305, 366.2836399078369, 370.532701253891, 374.83778047561646, 379.29428696632385, 381.5144236087799]
[19.15, 28.458333333333332, 32.56666666666667, 39.016666666666666, 42.25, 46.641666666666666, 47.875, 48.36666666666667, 52.483333333333334, 53.016666666666666, 53.53333333333333, 54.25, 55.425, 55.74166666666667, 56.11666666666667, 57.0, 57.25, 57.475, 58.40833333333333, 59.833333333333336, 60.666666666666664, 60.8, 60.525, 60.891666666666666, 61.15833333333333, 61.38333333333333, 61.416666666666664, 61.391666666666666, 61.475, 61.641666666666666, 61.93333333333333, 61.5, 61.625, 61.875, 61.4, 61.75833333333333, 61.59166666666667, 61.358333333333334, 60.5, 60.425, 60.708333333333336, 61.8, 61.541666666666664, 61.90833333333333, 61.05833333333333, 60.90833333333333, 60.31666666666667, 60.4, 59.766666666666666, 60.575, 60.15833333333333, 59.84166666666667, 59.7, 59.425, 59.15833333333333, 59.15833333333333, 59.68333333333333, 59.78333333333333, 59.666666666666664, 59.30833333333333, 58.541666666666664, 58.791666666666664, 58.40833333333333, 58.15833333333333, 58.78333333333333, 58.525, 57.858333333333334, 57.15, 57.81666666666667, 58.30833333333333, 58.891666666666666, 58.65, 58.38333333333333, 58.791666666666664, 58.21666666666667, 58.3, 58.641666666666666, 58.68333333333333, 58.99166666666667, 58.46666666666667, 58.44166666666667, 58.458333333333336, 58.18333333333333, 57.583333333333336, 58.208333333333336, 57.733333333333334, 58.05833333333333, 58.333333333333336, 58.166666666666664, 58.766666666666666, 58.71666666666667, 58.19166666666667, 58.375, 58.483333333333334, 58.291666666666664, 57.99166666666667, 57.858333333333334, 57.86666666666667, 57.74166666666667, 58.266666666666666, 58.275]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.762, Test loss: 1.535, Test accuracy: 37.35
Round   0, Global train loss: 1.762, Global test loss: 2.138, Global test accuracy: 24.03
Round   1, Train loss: 1.620, Test loss: 1.412, Test accuracy: 44.99
Round   1, Global train loss: 1.620, Global test loss: 1.854, Global test accuracy: 35.88
Round   2, Train loss: 1.534, Test loss: 1.342, Test accuracy: 49.67
Round   2, Global train loss: 1.534, Global test loss: 1.707, Global test accuracy: 41.62
Round   3, Train loss: 1.472, Test loss: 1.294, Test accuracy: 51.83
Round   3, Global train loss: 1.472, Global test loss: 1.601, Global test accuracy: 45.79
Round   4, Train loss: 1.426, Test loss: 1.263, Test accuracy: 53.12
Round   4, Global train loss: 1.426, Global test loss: 1.541, Global test accuracy: 48.20
Round   5, Train loss: 1.386, Test loss: 1.226, Test accuracy: 54.53
Round   5, Global train loss: 1.386, Global test loss: 1.488, Global test accuracy: 50.99
Round   6, Train loss: 1.344, Test loss: 1.242, Test accuracy: 54.83
Round   6, Global train loss: 1.344, Global test loss: 1.445, Global test accuracy: 52.33
Round   7, Train loss: 1.301, Test loss: 1.230, Test accuracy: 55.77
Round   7, Global train loss: 1.301, Global test loss: 1.389, Global test accuracy: 53.63
Round   8, Train loss: 1.257, Test loss: 1.232, Test accuracy: 55.58
Round   8, Global train loss: 1.257, Global test loss: 1.376, Global test accuracy: 54.98
Round   9, Train loss: 1.219, Test loss: 1.231, Test accuracy: 56.33
Round   9, Global train loss: 1.219, Global test loss: 1.363, Global test accuracy: 55.87
Round  10, Train loss: 1.209, Test loss: 1.243, Test accuracy: 55.90
Round  10, Global train loss: 1.209, Global test loss: 1.538, Global test accuracy: 45.69
Round  11, Train loss: 1.071, Test loss: 1.253, Test accuracy: 55.42
Round  11, Global train loss: 1.071, Global test loss: 1.411, Global test accuracy: 51.72
Round  12, Train loss: 0.961, Test loss: 1.236, Test accuracy: 56.08
Round  12, Global train loss: 0.961, Global test loss: 1.482, Global test accuracy: 50.64
Round  13, Train loss: 0.976, Test loss: 1.253, Test accuracy: 56.09
Round  13, Global train loss: 0.976, Global test loss: 1.395, Global test accuracy: 53.58
Round  14, Train loss: 1.197, Test loss: 1.265, Test accuracy: 55.74
Round  14, Global train loss: 1.197, Global test loss: 1.467, Global test accuracy: 52.16
Round  15, Train loss: 0.943, Test loss: 1.283, Test accuracy: 55.23
Round  15, Global train loss: 0.943, Global test loss: 1.468, Global test accuracy: 50.83
Round  16, Train loss: 0.908, Test loss: 1.295, Test accuracy: 55.97
Round  16, Global train loss: 0.908, Global test loss: 1.496, Global test accuracy: 51.35
Round  17, Train loss: 0.996, Test loss: 1.325, Test accuracy: 55.81
Round  17, Global train loss: 0.996, Global test loss: 1.567, Global test accuracy: 50.52
Round  18, Train loss: 0.871, Test loss: 1.344, Test accuracy: 55.59
Round  18, Global train loss: 0.871, Global test loss: 1.416, Global test accuracy: 53.89
Round  19, Train loss: 0.897, Test loss: 1.345, Test accuracy: 56.40
Round  19, Global train loss: 0.897, Global test loss: 1.518, Global test accuracy: 50.73
Round  20, Train loss: 0.789, Test loss: 1.364, Test accuracy: 56.90
Round  20, Global train loss: 0.789, Global test loss: 1.379, Global test accuracy: 54.30
Round  21, Train loss: 0.818, Test loss: 1.384, Test accuracy: 56.36
Round  21, Global train loss: 0.818, Global test loss: 1.474, Global test accuracy: 53.23
Round  22, Train loss: 0.811, Test loss: 1.410, Test accuracy: 55.87
Round  22, Global train loss: 0.811, Global test loss: 1.633, Global test accuracy: 52.57
Round  23, Train loss: 1.071, Test loss: 1.438, Test accuracy: 55.68
Round  23, Global train loss: 1.071, Global test loss: 1.699, Global test accuracy: 47.34
Round  24, Train loss: 0.803, Test loss: 1.457, Test accuracy: 55.43
Round  24, Global train loss: 0.803, Global test loss: 1.497, Global test accuracy: 53.08
Round  25, Train loss: 0.776, Test loss: 1.464, Test accuracy: 55.44
Round  25, Global train loss: 0.776, Global test loss: 1.370, Global test accuracy: 55.23
Round  26, Train loss: 0.735, Test loss: 1.498, Test accuracy: 54.94
Round  26, Global train loss: 0.735, Global test loss: 1.408, Global test accuracy: 55.70
Round  27, Train loss: 0.670, Test loss: 1.520, Test accuracy: 54.89
Round  27, Global train loss: 0.670, Global test loss: 1.517, Global test accuracy: 54.19
Round  28, Train loss: 0.725, Test loss: 1.541, Test accuracy: 54.76
Round  28, Global train loss: 0.725, Global test loss: 1.475, Global test accuracy: 54.30
Round  29, Train loss: 0.803, Test loss: 1.546, Test accuracy: 55.09
Round  29, Global train loss: 0.803, Global test loss: 1.595, Global test accuracy: 51.78
Round  30, Train loss: 0.811, Test loss: 1.569, Test accuracy: 54.98
Round  30, Global train loss: 0.811, Global test loss: 1.651, Global test accuracy: 48.38
Round  31, Train loss: 0.652, Test loss: 1.575, Test accuracy: 55.38
Round  31, Global train loss: 0.652, Global test loss: 1.574, Global test accuracy: 52.04
Round  32, Train loss: 0.619, Test loss: 1.604, Test accuracy: 54.84
Round  32, Global train loss: 0.619, Global test loss: 1.645, Global test accuracy: 53.48
Round  33, Train loss: 0.627, Test loss: 1.616, Test accuracy: 54.89
Round  33, Global train loss: 0.627, Global test loss: 1.649, Global test accuracy: 51.55
Round  34, Train loss: 0.758, Test loss: 1.670, Test accuracy: 54.48
Round  34, Global train loss: 0.758, Global test loss: 1.757, Global test accuracy: 48.61
Round  35, Train loss: 0.597, Test loss: 1.676, Test accuracy: 54.30
Round  35, Global train loss: 0.597, Global test loss: 1.734, Global test accuracy: 50.58
Round  36, Train loss: 0.825, Test loss: 1.674, Test accuracy: 54.68
Round  36, Global train loss: 0.825, Global test loss: 1.714, Global test accuracy: 47.67
Round  37, Train loss: 0.627, Test loss: 1.660, Test accuracy: 55.02
Round  37, Global train loss: 0.627, Global test loss: 1.708, Global test accuracy: 51.68
Round  38, Train loss: 0.544, Test loss: 1.682, Test accuracy: 55.47
Round  38, Global train loss: 0.544, Global test loss: 1.690, Global test accuracy: 53.05
Round  39, Train loss: 0.726, Test loss: 1.691, Test accuracy: 54.93
Round  39, Global train loss: 0.726, Global test loss: 1.714, Global test accuracy: 48.19
Round  40, Train loss: 0.629, Test loss: 1.678, Test accuracy: 54.90
Round  40, Global train loss: 0.629, Global test loss: 1.617, Global test accuracy: 51.97
Round  41, Train loss: 0.677, Test loss: 1.700, Test accuracy: 55.17
Round  41, Global train loss: 0.677, Global test loss: 1.633, Global test accuracy: 51.02
Round  42, Train loss: 0.588, Test loss: 1.722, Test accuracy: 55.20
Round  42, Global train loss: 0.588, Global test loss: 1.781, Global test accuracy: 51.27
Round  43, Train loss: 0.557, Test loss: 1.702, Test accuracy: 56.10
Round  43, Global train loss: 0.557, Global test loss: 1.663, Global test accuracy: 52.78
Round  44, Train loss: 0.620, Test loss: 1.722, Test accuracy: 56.19
Round  44, Global train loss: 0.620, Global test loss: 1.744, Global test accuracy: 50.52
Round  45, Train loss: 0.591, Test loss: 1.776, Test accuracy: 55.64
Round  45, Global train loss: 0.591, Global test loss: 1.870, Global test accuracy: 48.20
Round  46, Train loss: 0.605, Test loss: 1.778, Test accuracy: 55.68
Round  46, Global train loss: 0.605, Global test loss: 1.892, Global test accuracy: 49.17
Round  47, Train loss: 0.579, Test loss: 1.801, Test accuracy: 55.46
Round  47, Global train loss: 0.579, Global test loss: 1.785, Global test accuracy: 49.46
Round  48, Train loss: 0.581, Test loss: 1.804, Test accuracy: 56.03
Round  48, Global train loss: 0.581, Global test loss: 1.803, Global test accuracy: 50.12
Round  49, Train loss: 0.480, Test loss: 1.779, Test accuracy: 56.70
Round  49, Global train loss: 0.480, Global test loss: 1.902, Global test accuracy: 51.33
Round  50, Train loss: 0.549, Test loss: 1.788, Test accuracy: 56.38
Round  50, Global train loss: 0.549, Global test loss: 1.754, Global test accuracy: 53.15
Round  51, Train loss: 0.520, Test loss: 1.803, Test accuracy: 56.29
Round  51, Global train loss: 0.520, Global test loss: 1.780, Global test accuracy: 52.59
Round  52, Train loss: 0.634, Test loss: 1.835, Test accuracy: 56.09
Round  52, Global train loss: 0.634, Global test loss: 1.821, Global test accuracy: 49.42
Round  53, Train loss: 0.543, Test loss: 1.875, Test accuracy: 55.74
Round  53, Global train loss: 0.543, Global test loss: 2.079, Global test accuracy: 47.11
Round  54, Train loss: 0.563, Test loss: 1.850, Test accuracy: 55.46
Round  54, Global train loss: 0.563, Global test loss: 1.677, Global test accuracy: 52.23
Round  55, Train loss: 0.469, Test loss: 1.875, Test accuracy: 55.06
Round  55, Global train loss: 0.469, Global test loss: 1.740, Global test accuracy: 54.36
Round  56, Train loss: 0.603, Test loss: 1.866, Test accuracy: 55.58
Round  56, Global train loss: 0.603, Global test loss: 1.642, Global test accuracy: 52.11
Round  57, Train loss: 0.551, Test loss: 1.885, Test accuracy: 55.02
Round  57, Global train loss: 0.551, Global test loss: 1.764, Global test accuracy: 50.27
Round  58, Train loss: 0.478, Test loss: 1.889, Test accuracy: 55.08
Round  58, Global train loss: 0.478, Global test loss: 1.985, Global test accuracy: 49.20
Round  59, Train loss: 0.420, Test loss: 1.912, Test accuracy: 55.05
Round  59, Global train loss: 0.420, Global test loss: 1.672, Global test accuracy: 54.84
Round  60, Train loss: 0.488, Test loss: 1.942, Test accuracy: 54.77
Round  60, Global train loss: 0.488, Global test loss: 1.740, Global test accuracy: 53.14
Round  61, Train loss: 0.591, Test loss: 1.932, Test accuracy: 54.66
Round  61, Global train loss: 0.591, Global test loss: 1.738, Global test accuracy: 51.14
Round  62, Train loss: 0.442, Test loss: 1.934, Test accuracy: 55.06
Round  62, Global train loss: 0.442, Global test loss: 1.785, Global test accuracy: 52.91
Round  63, Train loss: 0.606, Test loss: 1.930, Test accuracy: 55.35
Round  63, Global train loss: 0.606, Global test loss: 1.652, Global test accuracy: 53.28
Round  64, Train loss: 0.515, Test loss: 1.920, Test accuracy: 55.72
Round  64, Global train loss: 0.515, Global test loss: 1.852, Global test accuracy: 49.90
Round  65, Train loss: 0.579, Test loss: 1.896, Test accuracy: 55.85
Round  65, Global train loss: 0.579, Global test loss: 1.958, Global test accuracy: 48.61
Round  66, Train loss: 0.389, Test loss: 1.912, Test accuracy: 55.59
Round  66, Global train loss: 0.389, Global test loss: 1.759, Global test accuracy: 54.74
Round  67, Train loss: 0.454, Test loss: 1.912, Test accuracy: 55.80
Round  67, Global train loss: 0.454, Global test loss: 2.046, Global test accuracy: 50.97
Round  68, Train loss: 0.388, Test loss: 1.923, Test accuracy: 55.64
Round  68, Global train loss: 0.388, Global test loss: 2.133, Global test accuracy: 49.12
Round  69, Train loss: 0.472, Test loss: 1.931, Test accuracy: 55.89
Round  69, Global train loss: 0.472, Global test loss: 1.849, Global test accuracy: 53.60
Round  70, Train loss: 0.515, Test loss: 1.914, Test accuracy: 56.14
Round  70, Global train loss: 0.515, Global test loss: 1.945, Global test accuracy: 49.21
Round  71, Train loss: 0.469, Test loss: 1.936, Test accuracy: 56.01
Round  71, Global train loss: 0.469, Global test loss: 1.792, Global test accuracy: 51.87
Round  72, Train loss: 0.457, Test loss: 1.956, Test accuracy: 56.08
Round  72, Global train loss: 0.457, Global test loss: 2.091, Global test accuracy: 49.87
Round  73, Train loss: 0.370, Test loss: 1.969, Test accuracy: 55.39
Round  73, Global train loss: 0.370, Global test loss: 1.866, Global test accuracy: 51.60
Round  74, Train loss: 0.535, Test loss: 1.952, Test accuracy: 55.54
Round  74, Global train loss: 0.535, Global test loss: 2.029, Global test accuracy: 46.99
Round  75, Train loss: 0.525, Test loss: 1.956, Test accuracy: 55.70
Round  75, Global train loss: 0.525, Global test loss: 1.845, Global test accuracy: 50.92
Round  76, Train loss: 0.433, Test loss: 1.974, Test accuracy: 55.75
Round  76, Global train loss: 0.433, Global test loss: 1.878, Global test accuracy: 51.44
Round  77, Train loss: 0.425, Test loss: 2.025, Test accuracy: 55.41
Round  77, Global train loss: 0.425, Global test loss: 1.761, Global test accuracy: 53.83
Round  78, Train loss: 0.446, Test loss: 2.010, Test accuracy: 55.53
Round  78, Global train loss: 0.446, Global test loss: 1.877, Global test accuracy: 51.23
Round  79, Train loss: 0.456, Test loss: 2.029, Test accuracy: 55.74
Round  79, Global train loss: 0.456, Global test loss: 1.791, Global test accuracy: 53.23
Round  80, Train loss: 0.315, Test loss: 2.058, Test accuracy: 55.38
Round  80, Global train loss: 0.315, Global test loss: 1.774, Global test accuracy: 56.27
Round  81, Train loss: 0.280, Test loss: 2.106, Test accuracy: 55.33
Round  81, Global train loss: 0.280, Global test loss: 1.875, Global test accuracy: 55.37
Round  82, Train loss: 0.264, Test loss: 2.094, Test accuracy: 55.45
Round  82, Global train loss: 0.264, Global test loss: 1.872, Global test accuracy: 55.81
Round  83, Train loss: 0.264, Test loss: 2.123, Test accuracy: 55.05
Round  83, Global train loss: 0.264, Global test loss: 1.848, Global test accuracy: 56.22
Round  84, Train loss: 0.248, Test loss: 2.115, Test accuracy: 55.41
Round  84, Global train loss: 0.248, Global test loss: 1.821, Global test accuracy: 55.98
Round  85, Train loss: 0.242, Test loss: 2.081, Test accuracy: 55.77
Round  85, Global train loss: 0.242, Global test loss: 1.862, Global test accuracy: 56.64
Round  86, Train loss: 0.234, Test loss: 2.118, Test accuracy: 55.49
Round  86, Global train loss: 0.234, Global test loss: 1.897, Global test accuracy: 56.29
Round  87, Train loss: 0.226, Test loss: 2.111, Test accuracy: 55.95
Round  87, Global train loss: 0.226, Global test loss: 1.909, Global test accuracy: 56.38
Round  88, Train loss: 0.229, Test loss: 2.105, Test accuracy: 55.92
Round  88, Global train loss: 0.229, Global test loss: 1.916, Global test accuracy: 56.49
Round  89, Train loss: 0.219, Test loss: 2.115, Test accuracy: 55.65
Round  89, Global train loss: 0.219, Global test loss: 1.934, Global test accuracy: 56.15
Round  90, Train loss: 0.457, Test loss: 2.052, Test accuracy: 56.42
Round  90, Global train loss: 0.457, Global test loss: 1.669, Global test accuracy: 55.91
Round  91, Train loss: 0.415, Test loss: 2.017, Test accuracy: 56.23
Round  91, Global train loss: 0.415, Global test loss: 1.690, Global test accuracy: 55.57
Round  92, Train loss: 0.396, Test loss: 2.093, Test accuracy: 55.28
Round  92, Global train loss: 0.396, Global test loss: 1.698, Global test accuracy: 55.59
Round  93, Train loss: 0.393, Test loss: 2.061, Test accuracy: 56.11
Round  93, Global train loss: 0.393, Global test loss: 1.714, Global test accuracy: 54.86
Round  94, Train loss: 0.387, Test loss: 2.094, Test accuracy: 56.07
Round  94, Global train loss: 0.387, Global test loss: 1.719, Global test accuracy: 55.05
Round  95, Train loss: 0.378, Test loss: 2.159, Test accuracy: 55.88
Round  95, Global train loss: 0.378, Global test loss: 1.734, Global test accuracy: 54.80
Round  96, Train loss: 0.372, Test loss: 2.153, Test accuracy: 55.53
Round  96, Global train loss: 0.372, Global test loss: 1.731, Global test accuracy: 54.92
Round  97, Train loss: 0.377, Test loss: 2.098, Test accuracy: 56.27
Round  97, Global train loss: 0.377, Global test loss: 1.734, Global test accuracy: 55.31
Round  98, Train loss: 0.372, Test loss: 2.137, Test accuracy: 55.62
Round  98, Global train loss: 0.372, Global test loss: 1.726, Global test accuracy: 54.89
Round  99, Train loss: 0.373, Test loss: 2.132, Test accuracy: 55.16
Round  99, Global train loss: 0.373, Global test loss: 1.732, Global test accuracy: 54.68
Final Round, Train loss: 0.250, Test loss: 2.430, Test accuracy: 55.19
Final Round, Global train loss: 0.250, Global test loss: 1.732, Global test accuracy: 54.68
Average accuracy final 10 rounds: 55.85666666666667
Average global accuracy final 10 rounds: 55.15833333333334
3041.1714222431183
[3.1012461185455322, 6.033745527267456, 8.972032308578491, 11.530265808105469, 14.095985174179077, 16.667238235473633, 19.235212564468384, 21.818884134292603, 24.421777963638306, 27.021318197250366, 29.581501007080078, 32.123892068862915, 34.6953444480896, 37.24722361564636, 39.84910464286804, 42.408957719802856, 44.94064807891846, 47.485780000686646, 50.02449631690979, 52.569634199142456, 55.110069274902344, 57.69776511192322, 60.264995098114014, 62.80406928062439, 65.36553812026978, 67.95782947540283, 70.52357745170593, 73.44027590751648, 76.00372099876404, 78.53910040855408, 81.09484052658081, 83.67629718780518, 86.23944306373596, 88.812340259552, 91.34927916526794, 93.8925256729126, 96.43541097640991, 98.98562455177307, 101.5198106765747, 104.08205723762512, 106.64712023735046, 109.17556929588318, 111.69335985183716, 114.25851941108704, 116.82105207443237, 119.360267162323, 121.89453601837158, 124.41166043281555, 126.91391205787659, 129.4827880859375, 132.01580381393433, 134.54256963729858, 137.0904471874237, 139.64610743522644, 142.19088649749756, 144.73381066322327, 147.26998138427734, 149.8194727897644, 152.39150881767273, 154.90934467315674, 157.46891808509827, 159.9925332069397, 162.52886581420898, 165.06831860542297, 167.59974479675293, 170.1585545539856, 172.69157934188843, 175.1943838596344, 177.74842071533203, 180.27766370773315, 182.79505395889282, 185.3229422569275, 187.87289881706238, 190.40639233589172, 192.97377634048462, 195.51600170135498, 198.03281497955322, 200.58770084381104, 203.12569165229797, 205.66614151000977, 208.2130184173584, 210.74755311012268, 213.3189299106598, 215.8529658317566, 218.44229221343994, 220.997407913208, 223.57229113578796, 226.10508370399475, 228.6203682422638, 231.1507670879364, 233.7136070728302, 236.31315112113953, 238.8827269077301, 241.49576592445374, 244.07929849624634, 246.68249344825745, 249.2987322807312, 251.91023182868958, 254.53809189796448, 257.1664638519287, 261.47885727882385]
[37.35, 44.99166666666667, 49.675, 51.833333333333336, 53.125, 54.53333333333333, 54.825, 55.766666666666666, 55.575, 56.333333333333336, 55.9, 55.425, 56.075, 56.09166666666667, 55.74166666666667, 55.233333333333334, 55.96666666666667, 55.80833333333333, 55.59166666666667, 56.4, 56.9, 56.358333333333334, 55.86666666666667, 55.68333333333333, 55.43333333333333, 55.44166666666667, 54.94166666666667, 54.891666666666666, 54.75833333333333, 55.09166666666667, 54.983333333333334, 55.38333333333333, 54.84166666666667, 54.891666666666666, 54.483333333333334, 54.3, 54.68333333333333, 55.025, 55.46666666666667, 54.93333333333333, 54.9, 55.166666666666664, 55.2, 56.1, 56.19166666666667, 55.641666666666666, 55.68333333333333, 55.458333333333336, 56.03333333333333, 56.7, 56.375, 56.291666666666664, 56.09166666666667, 55.74166666666667, 55.458333333333336, 55.05833333333333, 55.575, 55.025, 55.083333333333336, 55.05, 54.775, 54.65833333333333, 55.05833333333333, 55.35, 55.71666666666667, 55.85, 55.59166666666667, 55.8, 55.641666666666666, 55.891666666666666, 56.141666666666666, 56.00833333333333, 56.083333333333336, 55.391666666666666, 55.541666666666664, 55.7, 55.75, 55.40833333333333, 55.53333333333333, 55.74166666666667, 55.375, 55.325, 55.45, 55.05, 55.40833333333333, 55.766666666666666, 55.49166666666667, 55.95, 55.925, 55.65, 56.416666666666664, 56.233333333333334, 55.28333333333333, 56.108333333333334, 56.06666666666667, 55.88333333333333, 55.53333333333333, 56.266666666666666, 55.61666666666667, 55.15833333333333, 55.19166666666667]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.767, Test loss: 1.501, Test accuracy: 39.62
Round   0, Global train loss: 1.767, Global test loss: 2.119, Global test accuracy: 24.51
Round   1, Train loss: 1.625, Test loss: 1.384, Test accuracy: 47.46
Round   1, Global train loss: 1.625, Global test loss: 1.866, Global test accuracy: 33.92
Round   2, Train loss: 1.541, Test loss: 1.349, Test accuracy: 49.82
Round   2, Global train loss: 1.541, Global test loss: 1.713, Global test accuracy: 42.31
Round   3, Train loss: 1.487, Test loss: 1.305, Test accuracy: 52.00
Round   3, Global train loss: 1.487, Global test loss: 1.637, Global test accuracy: 45.53
Round   4, Train loss: 1.445, Test loss: 1.282, Test accuracy: 52.92
Round   4, Global train loss: 1.445, Global test loss: 1.566, Global test accuracy: 48.76
Round   5, Train loss: 1.406, Test loss: 1.247, Test accuracy: 54.26
Round   5, Global train loss: 1.406, Global test loss: 1.510, Global test accuracy: 51.08
Round   6, Train loss: 1.364, Test loss: 1.226, Test accuracy: 55.51
Round   6, Global train loss: 1.364, Global test loss: 1.450, Global test accuracy: 52.99
Round   7, Train loss: 1.323, Test loss: 1.241, Test accuracy: 55.08
Round   7, Global train loss: 1.323, Global test loss: 1.440, Global test accuracy: 53.73
Round   8, Train loss: 1.283, Test loss: 1.228, Test accuracy: 55.83
Round   8, Global train loss: 1.283, Global test loss: 1.389, Global test accuracy: 54.99
Round   9, Train loss: 1.243, Test loss: 1.244, Test accuracy: 54.92
Round   9, Global train loss: 1.243, Global test loss: 1.376, Global test accuracy: 55.98
Round  10, Train loss: 1.258, Test loss: 1.248, Test accuracy: 55.09
Round  10, Global train loss: 1.258, Global test loss: 1.489, Global test accuracy: 50.95
Round  11, Train loss: 1.181, Test loss: 1.252, Test accuracy: 54.74
Round  11, Global train loss: 1.181, Global test loss: 1.442, Global test accuracy: 52.04
Round  12, Train loss: 1.232, Test loss: 1.248, Test accuracy: 55.24
Round  12, Global train loss: 1.232, Global test loss: 1.569, Global test accuracy: 47.39
Round  13, Train loss: 1.242, Test loss: 1.284, Test accuracy: 54.13
Round  13, Global train loss: 1.242, Global test loss: 1.563, Global test accuracy: 48.42
Round  14, Train loss: 1.047, Test loss: 1.293, Test accuracy: 54.47
Round  14, Global train loss: 1.047, Global test loss: 1.448, Global test accuracy: 52.68
Round  15, Train loss: 1.158, Test loss: 1.300, Test accuracy: 54.52
Round  15, Global train loss: 1.158, Global test loss: 1.572, Global test accuracy: 49.65
Round  16, Train loss: 1.011, Test loss: 1.330, Test accuracy: 53.91
Round  16, Global train loss: 1.011, Global test loss: 1.558, Global test accuracy: 49.14
Round  17, Train loss: 1.145, Test loss: 1.354, Test accuracy: 53.69
Round  17, Global train loss: 1.145, Global test loss: 1.709, Global test accuracy: 45.62
Round  18, Train loss: 0.955, Test loss: 1.387, Test accuracy: 53.85
Round  18, Global train loss: 0.955, Global test loss: 1.490, Global test accuracy: 52.12
Round  19, Train loss: 0.897, Test loss: 1.406, Test accuracy: 53.60
Round  19, Global train loss: 0.897, Global test loss: 1.539, Global test accuracy: 50.86
Round  20, Train loss: 0.979, Test loss: 1.417, Test accuracy: 54.02
Round  20, Global train loss: 0.979, Global test loss: 1.513, Global test accuracy: 50.20
Round  21, Train loss: 0.784, Test loss: 1.449, Test accuracy: 53.95
Round  21, Global train loss: 0.784, Global test loss: 1.490, Global test accuracy: 52.83
Round  22, Train loss: 0.901, Test loss: 1.471, Test accuracy: 53.51
Round  22, Global train loss: 0.901, Global test loss: 1.683, Global test accuracy: 49.14
Round  23, Train loss: 0.843, Test loss: 1.483, Test accuracy: 53.10
Round  23, Global train loss: 0.843, Global test loss: 1.607, Global test accuracy: 51.40
Round  24, Train loss: 0.898, Test loss: 1.504, Test accuracy: 53.13
Round  24, Global train loss: 0.898, Global test loss: 1.649, Global test accuracy: 50.13
Round  25, Train loss: 0.898, Test loss: 1.512, Test accuracy: 53.51
Round  25, Global train loss: 0.898, Global test loss: 1.457, Global test accuracy: 52.21
Round  26, Train loss: 0.887, Test loss: 1.545, Test accuracy: 53.27
Round  26, Global train loss: 0.887, Global test loss: 1.523, Global test accuracy: 51.63
Round  27, Train loss: 0.752, Test loss: 1.582, Test accuracy: 52.28
Round  27, Global train loss: 0.752, Global test loss: 1.536, Global test accuracy: 50.86
Round  28, Train loss: 0.707, Test loss: 1.589, Test accuracy: 52.17
Round  28, Global train loss: 0.707, Global test loss: 1.509, Global test accuracy: 51.78
Round  29, Train loss: 0.779, Test loss: 1.630, Test accuracy: 52.20
Round  29, Global train loss: 0.779, Global test loss: 1.664, Global test accuracy: 49.81
Round  30, Train loss: 0.841, Test loss: 1.637, Test accuracy: 52.25
Round  30, Global train loss: 0.841, Global test loss: 1.780, Global test accuracy: 46.58
Round  31, Train loss: 0.670, Test loss: 1.630, Test accuracy: 51.98
Round  31, Global train loss: 0.670, Global test loss: 1.561, Global test accuracy: 52.16
Round  32, Train loss: 0.747, Test loss: 1.623, Test accuracy: 53.02
Round  32, Global train loss: 0.747, Global test loss: 1.688, Global test accuracy: 48.83
Round  33, Train loss: 0.770, Test loss: 1.651, Test accuracy: 53.02
Round  33, Global train loss: 0.770, Global test loss: 1.703, Global test accuracy: 47.13
Round  34, Train loss: 0.685, Test loss: 1.683, Test accuracy: 52.82
Round  34, Global train loss: 0.685, Global test loss: 1.745, Global test accuracy: 49.30
Round  35, Train loss: 0.703, Test loss: 1.713, Test accuracy: 52.77
Round  35, Global train loss: 0.703, Global test loss: 1.763, Global test accuracy: 47.67
Round  36, Train loss: 0.559, Test loss: 1.726, Test accuracy: 52.98
Round  36, Global train loss: 0.559, Global test loss: 1.644, Global test accuracy: 50.68
Round  37, Train loss: 0.784, Test loss: 1.737, Test accuracy: 53.06
Round  37, Global train loss: 0.784, Global test loss: 1.770, Global test accuracy: 47.67
Round  38, Train loss: 0.608, Test loss: 1.738, Test accuracy: 53.80
Round  38, Global train loss: 0.608, Global test loss: 1.735, Global test accuracy: 50.51
Round  39, Train loss: 0.674, Test loss: 1.761, Test accuracy: 54.25
Round  39, Global train loss: 0.674, Global test loss: 1.733, Global test accuracy: 49.91
Round  40, Train loss: 0.689, Test loss: 1.797, Test accuracy: 54.07
Round  40, Global train loss: 0.689, Global test loss: 1.685, Global test accuracy: 49.04
Round  41, Train loss: 0.594, Test loss: 1.825, Test accuracy: 53.98
Round  41, Global train loss: 0.594, Global test loss: 1.650, Global test accuracy: 49.78
Round  42, Train loss: 0.582, Test loss: 1.829, Test accuracy: 53.66
Round  42, Global train loss: 0.582, Global test loss: 1.645, Global test accuracy: 52.96
Round  43, Train loss: 0.573, Test loss: 1.842, Test accuracy: 53.37
Round  43, Global train loss: 0.573, Global test loss: 1.754, Global test accuracy: 50.07
Round  44, Train loss: 0.602, Test loss: 1.874, Test accuracy: 53.27
Round  44, Global train loss: 0.602, Global test loss: 1.772, Global test accuracy: 50.36
Round  45, Train loss: 0.584, Test loss: 1.887, Test accuracy: 53.12
Round  45, Global train loss: 0.584, Global test loss: 1.869, Global test accuracy: 47.17
Round  46, Train loss: 0.622, Test loss: 1.891, Test accuracy: 53.13
Round  46, Global train loss: 0.622, Global test loss: 1.852, Global test accuracy: 47.44
Round  47, Train loss: 0.544, Test loss: 1.898, Test accuracy: 53.04
Round  47, Global train loss: 0.544, Global test loss: 1.918, Global test accuracy: 48.21
Round  48, Train loss: 0.606, Test loss: 1.884, Test accuracy: 53.08
Round  48, Global train loss: 0.606, Global test loss: 1.749, Global test accuracy: 49.91
Round  49, Train loss: 0.538, Test loss: 1.870, Test accuracy: 53.80
Round  49, Global train loss: 0.538, Global test loss: 1.940, Global test accuracy: 48.49
Round  50, Train loss: 0.509, Test loss: 1.879, Test accuracy: 53.88
Round  50, Global train loss: 0.509, Global test loss: 1.769, Global test accuracy: 51.07
Round  51, Train loss: 0.517, Test loss: 1.903, Test accuracy: 53.83
Round  51, Global train loss: 0.517, Global test loss: 1.773, Global test accuracy: 50.42
Round  52, Train loss: 0.603, Test loss: 1.919, Test accuracy: 53.67
Round  52, Global train loss: 0.603, Global test loss: 1.746, Global test accuracy: 50.19
Round  53, Train loss: 0.487, Test loss: 1.948, Test accuracy: 53.58
Round  53, Global train loss: 0.487, Global test loss: 2.048, Global test accuracy: 47.47
Round  54, Train loss: 0.588, Test loss: 1.963, Test accuracy: 53.36
Round  54, Global train loss: 0.588, Global test loss: 1.747, Global test accuracy: 50.27
Round  55, Train loss: 0.562, Test loss: 1.939, Test accuracy: 53.71
Round  55, Global train loss: 0.562, Global test loss: 1.810, Global test accuracy: 49.79
Round  56, Train loss: 0.485, Test loss: 1.946, Test accuracy: 53.56
Round  56, Global train loss: 0.485, Global test loss: 1.548, Global test accuracy: 53.67
Round  57, Train loss: 0.426, Test loss: 1.984, Test accuracy: 53.67
Round  57, Global train loss: 0.426, Global test loss: 1.713, Global test accuracy: 53.70
Round  58, Train loss: 0.588, Test loss: 1.965, Test accuracy: 54.10
Round  58, Global train loss: 0.588, Global test loss: 2.020, Global test accuracy: 46.12
Round  59, Train loss: 0.524, Test loss: 1.967, Test accuracy: 54.17
Round  59, Global train loss: 0.524, Global test loss: 1.689, Global test accuracy: 51.08
Round  60, Train loss: 0.521, Test loss: 1.956, Test accuracy: 53.93
Round  60, Global train loss: 0.521, Global test loss: 1.835, Global test accuracy: 49.51
Round  61, Train loss: 0.411, Test loss: 1.939, Test accuracy: 54.20
Round  61, Global train loss: 0.411, Global test loss: 1.680, Global test accuracy: 54.17
Round  62, Train loss: 0.502, Test loss: 1.964, Test accuracy: 54.22
Round  62, Global train loss: 0.502, Global test loss: 1.861, Global test accuracy: 50.39
Round  63, Train loss: 0.511, Test loss: 1.980, Test accuracy: 54.34
Round  63, Global train loss: 0.511, Global test loss: 1.617, Global test accuracy: 54.62
Round  64, Train loss: 0.518, Test loss: 1.944, Test accuracy: 54.90
Round  64, Global train loss: 0.518, Global test loss: 1.808, Global test accuracy: 49.60
Round  65, Train loss: 0.486, Test loss: 1.938, Test accuracy: 55.17
Round  65, Global train loss: 0.486, Global test loss: 1.867, Global test accuracy: 51.98
Round  66, Train loss: 0.507, Test loss: 1.969, Test accuracy: 54.29
Round  66, Global train loss: 0.507, Global test loss: 1.779, Global test accuracy: 50.74
Round  67, Train loss: 0.490, Test loss: 2.002, Test accuracy: 54.33
Round  67, Global train loss: 0.490, Global test loss: 2.128, Global test accuracy: 46.47
Round  68, Train loss: 0.354, Test loss: 1.968, Test accuracy: 54.39
Round  68, Global train loss: 0.354, Global test loss: 2.044, Global test accuracy: 50.62
Round  69, Train loss: 0.498, Test loss: 1.957, Test accuracy: 54.58
Round  69, Global train loss: 0.498, Global test loss: 1.753, Global test accuracy: 52.44
Round  70, Train loss: 0.497, Test loss: 1.947, Test accuracy: 54.74
Round  70, Global train loss: 0.497, Global test loss: 1.986, Global test accuracy: 49.12
Round  71, Train loss: 0.351, Test loss: 1.967, Test accuracy: 54.75
Round  71, Global train loss: 0.351, Global test loss: 1.875, Global test accuracy: 53.92
Round  72, Train loss: 0.430, Test loss: 1.986, Test accuracy: 54.90
Round  72, Global train loss: 0.430, Global test loss: 1.963, Global test accuracy: 50.25
Round  73, Train loss: 0.359, Test loss: 1.984, Test accuracy: 55.18
Round  73, Global train loss: 0.359, Global test loss: 1.855, Global test accuracy: 52.73
Round  74, Train loss: 0.542, Test loss: 2.016, Test accuracy: 54.97
Round  74, Global train loss: 0.542, Global test loss: 1.992, Global test accuracy: 47.74
Round  75, Train loss: 0.462, Test loss: 2.001, Test accuracy: 55.47
Round  75, Global train loss: 0.462, Global test loss: 1.796, Global test accuracy: 51.38
Round  76, Train loss: 0.482, Test loss: 1.986, Test accuracy: 55.22
Round  76, Global train loss: 0.482, Global test loss: 1.925, Global test accuracy: 49.11
Round  77, Train loss: 0.446, Test loss: 2.003, Test accuracy: 55.13
Round  77, Global train loss: 0.446, Global test loss: 1.786, Global test accuracy: 51.61
Round  78, Train loss: 0.414, Test loss: 1.980, Test accuracy: 55.30
Round  78, Global train loss: 0.414, Global test loss: 1.798, Global test accuracy: 52.33
Round  79, Train loss: 0.429, Test loss: 2.024, Test accuracy: 55.15
Round  79, Global train loss: 0.429, Global test loss: 1.775, Global test accuracy: 52.27
Round  80, Train loss: 0.317, Test loss: 2.070, Test accuracy: 54.81
Round  80, Global train loss: 0.317, Global test loss: 1.710, Global test accuracy: 55.41
Round  81, Train loss: 0.296, Test loss: 2.041, Test accuracy: 55.11
Round  81, Global train loss: 0.296, Global test loss: 1.698, Global test accuracy: 55.93
Round  82, Train loss: 0.274, Test loss: 2.057, Test accuracy: 55.58
Round  82, Global train loss: 0.274, Global test loss: 1.759, Global test accuracy: 56.27
Round  83, Train loss: 0.266, Test loss: 2.094, Test accuracy: 55.00
Round  83, Global train loss: 0.266, Global test loss: 1.800, Global test accuracy: 56.42
Round  84, Train loss: 0.254, Test loss: 2.056, Test accuracy: 55.28
Round  84, Global train loss: 0.254, Global test loss: 1.782, Global test accuracy: 56.48
Round  85, Train loss: 0.249, Test loss: 2.037, Test accuracy: 55.92
Round  85, Global train loss: 0.249, Global test loss: 1.732, Global test accuracy: 57.08
Round  86, Train loss: 0.248, Test loss: 2.100, Test accuracy: 55.41
Round  86, Global train loss: 0.248, Global test loss: 1.770, Global test accuracy: 56.54
Round  87, Train loss: 0.245, Test loss: 2.069, Test accuracy: 55.60
Round  87, Global train loss: 0.245, Global test loss: 1.806, Global test accuracy: 56.19
Round  88, Train loss: 0.229, Test loss: 2.105, Test accuracy: 55.34
Round  88, Global train loss: 0.229, Global test loss: 1.790, Global test accuracy: 57.29
Round  89, Train loss: 0.228, Test loss: 2.124, Test accuracy: 55.45
Round  89, Global train loss: 0.228, Global test loss: 1.791, Global test accuracy: 57.53
Round  90, Train loss: 0.461, Test loss: 2.027, Test accuracy: 55.68
Round  90, Global train loss: 0.461, Global test loss: 1.615, Global test accuracy: 56.41
Round  91, Train loss: 0.417, Test loss: 2.114, Test accuracy: 54.79
Round  91, Global train loss: 0.417, Global test loss: 1.648, Global test accuracy: 55.58
Round  92, Train loss: 0.409, Test loss: 2.112, Test accuracy: 54.20
Round  92, Global train loss: 0.409, Global test loss: 1.655, Global test accuracy: 55.26
Round  93, Train loss: 0.397, Test loss: 2.096, Test accuracy: 55.11
Round  93, Global train loss: 0.397, Global test loss: 1.675, Global test accuracy: 55.17
Round  94, Train loss: 0.392, Test loss: 2.142, Test accuracy: 54.76
Round  94, Global train loss: 0.392, Global test loss: 1.672, Global test accuracy: 55.58
Round  95, Train loss: 0.385, Test loss: 2.086, Test accuracy: 55.65
Round  95, Global train loss: 0.385, Global test loss: 1.686, Global test accuracy: 55.11
Round  96, Train loss: 0.380, Test loss: 2.159, Test accuracy: 54.87
Round  96, Global train loss: 0.380, Global test loss: 1.694, Global test accuracy: 54.86
Round  97, Train loss: 0.377, Test loss: 2.187, Test accuracy: 54.08
Round  97, Global train loss: 0.377, Global test loss: 1.696, Global test accuracy: 54.77
Round  98, Train loss: 0.369, Test loss: 2.150, Test accuracy: 55.61
Round  98, Global train loss: 0.369, Global test loss: 1.707, Global test accuracy: 55.15
Round  99, Train loss: 0.371, Test loss: 2.151, Test accuracy: 54.39
Round  99, Global train loss: 0.371, Global test loss: 1.717, Global test accuracy: 54.53
Final Round, Train loss: 0.252, Test loss: 2.448, Test accuracy: 54.32
Final Round, Global train loss: 0.252, Global test loss: 1.717, Global test accuracy: 54.53
Average accuracy final 10 rounds: 54.91416666666667
Average global accuracy final 10 rounds: 55.24166666666667
5971.44721698761
[3.2143073081970215, 6.210549354553223, 8.830365657806396, 11.455620050430298, 14.034081935882568, 16.674733877182007, 19.280765533447266, 21.89936137199402, 24.479495525360107, 27.061620712280273, 29.63613533973694, 32.245750427246094, 34.90834999084473, 37.566327810287476, 40.156357288360596, 42.74014616012573, 45.361847162246704, 47.93060612678528, 50.50464224815369, 53.13758301734924, 55.71369409561157, 64.59916591644287, 73.62873005867004, 82.8455879688263, 91.9870707988739, 101.11181974411011, 110.26352405548096, 119.30924153327942, 128.2679579257965, 137.22643280029297, 146.0909435749054, 155.60107612609863, 164.66647028923035, 173.97994208335876, 183.0699384212494, 191.59060859680176, 200.17336177825928, 207.1461045742035, 214.06849098205566, 221.03322672843933, 228.00573992729187, 235.0113763809204, 242.03568363189697, 249.04305458068848, 256.040061712265, 263.04535484313965, 270.0550138950348, 277.2141673564911, 284.19919633865356, 291.18355417251587, 298.16982650756836, 305.19011425971985, 312.1801047325134, 319.11085391044617, 326.01713705062866, 332.8947033882141, 339.7796120643616, 346.6622223854065, 353.5247220993042, 360.4117772579193, 367.7531931400299, 375.06650590896606, 382.4360764026642, 389.77156019210815, 397.140620470047, 404.47111558914185, 411.820529460907, 419.1487464904785, 426.564026594162, 433.89207792282104, 441.2251076698303, 448.5122628211975, 455.50289249420166, 462.44970703125, 469.4222049713135, 476.4220595359802, 483.332236289978, 490.2999131679535, 497.3021502494812, 504.2328836917877, 511.2161214351654, 518.1352074146271, 525.1362454891205, 532.1353387832642, 539.1283423900604, 546.1250102519989, 552.4510445594788, 558.6737332344055, 564.9045805931091, 571.1290657520294, 577.3589825630188, 583.6374907493591, 589.9122009277344, 596.7597579956055, 603.6807298660278, 610.5524990558624, 617.4271576404572, 624.311555147171, 631.1701283454895, 638.0355727672577, 642.1722867488861]
[39.61666666666667, 47.458333333333336, 49.81666666666667, 52.0, 52.916666666666664, 54.25833333333333, 55.50833333333333, 55.075, 55.825, 54.916666666666664, 55.09166666666667, 54.74166666666667, 55.24166666666667, 54.13333333333333, 54.46666666666667, 54.516666666666666, 53.90833333333333, 53.69166666666667, 53.85, 53.6, 54.016666666666666, 53.95, 53.50833333333333, 53.1, 53.13333333333333, 53.50833333333333, 53.275, 52.28333333333333, 52.175, 52.2, 52.25, 51.975, 53.016666666666666, 53.016666666666666, 52.81666666666667, 52.766666666666666, 52.983333333333334, 53.05833333333333, 53.8, 54.25, 54.06666666666667, 53.975, 53.65833333333333, 53.36666666666667, 53.275, 53.11666666666667, 53.13333333333333, 53.041666666666664, 53.075, 53.8, 53.88333333333333, 53.825, 53.666666666666664, 53.575, 53.358333333333334, 53.708333333333336, 53.55833333333333, 53.666666666666664, 54.1, 54.166666666666664, 53.93333333333333, 54.2, 54.21666666666667, 54.34166666666667, 54.9, 55.166666666666664, 54.291666666666664, 54.325, 54.391666666666666, 54.583333333333336, 54.74166666666667, 54.75, 54.9, 55.18333333333333, 54.96666666666667, 55.46666666666667, 55.21666666666667, 55.13333333333333, 55.3, 55.15, 54.80833333333333, 55.108333333333334, 55.575, 55.0, 55.28333333333333, 55.925, 55.40833333333333, 55.6, 55.34166666666667, 55.45, 55.68333333333333, 54.791666666666664, 54.2, 55.108333333333334, 54.75833333333333, 55.65, 54.86666666666667, 54.083333333333336, 55.608333333333334, 54.391666666666666, 54.31666666666667]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.899, Test loss: 1.865, Test accuracy: 26.96
Round   1, Train loss: 1.689, Test loss: 1.519, Test accuracy: 39.48
Round   2, Train loss: 1.595, Test loss: 1.403, Test accuracy: 44.27
Round   3, Train loss: 1.532, Test loss: 1.333, Test accuracy: 49.23
Round   4, Train loss: 1.487, Test loss: 1.262, Test accuracy: 52.27
Round   5, Train loss: 1.456, Test loss: 1.235, Test accuracy: 53.90
Round   6, Train loss: 1.425, Test loss: 1.196, Test accuracy: 56.55
Round   7, Train loss: 1.401, Test loss: 1.183, Test accuracy: 57.74
Round   8, Train loss: 1.377, Test loss: 1.154, Test accuracy: 58.72
Round   9, Train loss: 1.354, Test loss: 1.130, Test accuracy: 60.31
Round  10, Train loss: 1.331, Test loss: 1.124, Test accuracy: 60.20
Round  11, Train loss: 1.308, Test loss: 1.086, Test accuracy: 62.65
Round  12, Train loss: 1.286, Test loss: 1.067, Test accuracy: 62.33
Round  13, Train loss: 1.265, Test loss: 1.062, Test accuracy: 62.95
Round  14, Train loss: 1.242, Test loss: 1.077, Test accuracy: 62.42
Round  15, Train loss: 1.224, Test loss: 1.067, Test accuracy: 63.59
Round  16, Train loss: 1.202, Test loss: 1.050, Test accuracy: 63.33
Round  17, Train loss: 1.183, Test loss: 1.034, Test accuracy: 63.99
Round  18, Train loss: 1.163, Test loss: 1.043, Test accuracy: 64.03
Round  19, Train loss: 1.144, Test loss: 1.036, Test accuracy: 63.63
Round  20, Train loss: 1.254, Test loss: 1.055, Test accuracy: 63.25
Round  21, Train loss: 1.228, Test loss: 1.061, Test accuracy: 62.68
Round  22, Train loss: 0.970, Test loss: 1.026, Test accuracy: 63.88
Round  23, Train loss: 1.104, Test loss: 1.044, Test accuracy: 63.08
Round  24, Train loss: 1.125, Test loss: 1.035, Test accuracy: 63.21
Round  25, Train loss: 0.938, Test loss: 1.036, Test accuracy: 63.29
Round  26, Train loss: 0.973, Test loss: 1.019, Test accuracy: 64.16
Round  27, Train loss: 1.043, Test loss: 1.036, Test accuracy: 63.67
Round  28, Train loss: 0.857, Test loss: 1.040, Test accuracy: 63.49
Round  29, Train loss: 1.103, Test loss: 1.070, Test accuracy: 61.93
Round  30, Train loss: 0.912, Test loss: 1.068, Test accuracy: 62.25
Round  31, Train loss: 1.129, Test loss: 1.091, Test accuracy: 61.84
Round  32, Train loss: 0.949, Test loss: 1.085, Test accuracy: 62.15
Round  33, Train loss: 1.076, Test loss: 1.135, Test accuracy: 60.77
Round  34, Train loss: 1.017, Test loss: 1.114, Test accuracy: 61.55
Round  35, Train loss: 0.857, Test loss: 1.101, Test accuracy: 61.66
Round  36, Train loss: 0.957, Test loss: 1.093, Test accuracy: 62.36
Round  37, Train loss: 0.825, Test loss: 1.098, Test accuracy: 62.71
Round  38, Train loss: 0.902, Test loss: 1.117, Test accuracy: 62.01
Round  39, Train loss: 0.876, Test loss: 1.124, Test accuracy: 62.02
Round  40, Train loss: 0.896, Test loss: 1.138, Test accuracy: 62.19
Round  41, Train loss: 0.824, Test loss: 1.106, Test accuracy: 62.38
Round  42, Train loss: 1.014, Test loss: 1.164, Test accuracy: 61.02
Round  43, Train loss: 0.900, Test loss: 1.220, Test accuracy: 59.86
Round  44, Train loss: 0.846, Test loss: 1.209, Test accuracy: 60.00
Round  45, Train loss: 0.745, Test loss: 1.208, Test accuracy: 59.88
Round  46, Train loss: 0.928, Test loss: 1.234, Test accuracy: 58.83
Round  47, Train loss: 0.706, Test loss: 1.193, Test accuracy: 60.58
Round  48, Train loss: 0.757, Test loss: 1.202, Test accuracy: 59.94
Round  49, Train loss: 0.827, Test loss: 1.270, Test accuracy: 58.80
Round  50, Train loss: 0.764, Test loss: 1.235, Test accuracy: 59.02
Round  51, Train loss: 0.867, Test loss: 1.227, Test accuracy: 60.56
Round  52, Train loss: 0.728, Test loss: 1.218, Test accuracy: 59.70
Round  53, Train loss: 0.709, Test loss: 1.268, Test accuracy: 59.24
Round  54, Train loss: 0.716, Test loss: 1.229, Test accuracy: 60.58
Round  55, Train loss: 0.807, Test loss: 1.279, Test accuracy: 59.49
Round  56, Train loss: 0.720, Test loss: 1.276, Test accuracy: 58.73
Round  57, Train loss: 0.698, Test loss: 1.301, Test accuracy: 58.39
Round  58, Train loss: 0.687, Test loss: 1.307, Test accuracy: 57.84
Round  59, Train loss: 0.738, Test loss: 1.318, Test accuracy: 58.30
Round  60, Train loss: 0.755, Test loss: 1.327, Test accuracy: 57.56
Round  61, Train loss: 0.765, Test loss: 1.329, Test accuracy: 58.05
Round  62, Train loss: 0.659, Test loss: 1.357, Test accuracy: 57.99
Round  63, Train loss: 0.610, Test loss: 1.292, Test accuracy: 59.04
Round  64, Train loss: 0.589, Test loss: 1.302, Test accuracy: 59.17
Round  65, Train loss: 0.701, Test loss: 1.324, Test accuracy: 59.17
Round  66, Train loss: 0.758, Test loss: 1.379, Test accuracy: 57.88
Round  67, Train loss: 0.728, Test loss: 1.407, Test accuracy: 57.39
Round  68, Train loss: 0.630, Test loss: 1.440, Test accuracy: 56.81
Round  69, Train loss: 0.730, Test loss: 1.425, Test accuracy: 56.99
Round  70, Train loss: 0.664, Test loss: 1.408, Test accuracy: 56.66
Round  71, Train loss: 0.661, Test loss: 1.461, Test accuracy: 56.51
Round  72, Train loss: 0.643, Test loss: 1.455, Test accuracy: 56.71
Round  73, Train loss: 0.674, Test loss: 1.468, Test accuracy: 56.50
Round  74, Train loss: 0.554, Test loss: 1.416, Test accuracy: 56.82
Round  75, Train loss: 0.481, Test loss: 1.409, Test accuracy: 57.43
Round  76, Train loss: 0.619, Test loss: 1.426, Test accuracy: 57.58
Round  77, Train loss: 0.558, Test loss: 1.406, Test accuracy: 57.67
Round  78, Train loss: 0.649, Test loss: 1.441, Test accuracy: 57.02
Round  79, Train loss: 0.570, Test loss: 1.469, Test accuracy: 56.95
Round  80, Train loss: 0.450, Test loss: 1.425, Test accuracy: 57.97
Round  81, Train loss: 0.420, Test loss: 1.433, Test accuracy: 57.38
Round  82, Train loss: 0.399, Test loss: 1.454, Test accuracy: 57.65
Round  83, Train loss: 0.391, Test loss: 1.477, Test accuracy: 57.62
Round  84, Train loss: 0.385, Test loss: 1.473, Test accuracy: 57.73
Round  85, Train loss: 0.369, Test loss: 1.508, Test accuracy: 57.05
Round  86, Train loss: 0.349, Test loss: 1.513, Test accuracy: 57.73
Round  87, Train loss: 0.360, Test loss: 1.507, Test accuracy: 57.37
Round  88, Train loss: 0.353, Test loss: 1.534, Test accuracy: 57.56
Round  89, Train loss: 0.342, Test loss: 1.539, Test accuracy: 57.50
Round  90, Train loss: 0.599, Test loss: 1.505, Test accuracy: 57.29
Round  91, Train loss: 0.567, Test loss: 1.544, Test accuracy: 57.05
Round  92, Train loss: 0.557, Test loss: 1.533, Test accuracy: 56.76
Round  93, Train loss: 0.553, Test loss: 1.563, Test accuracy: 56.25
Round  94, Train loss: 0.532, Test loss: 1.576, Test accuracy: 57.30
Round  95, Train loss: 0.537, Test loss: 1.570, Test accuracy: 56.47
Round  96, Train loss: 0.523, Test loss: 1.614, Test accuracy: 56.44
Round  97, Train loss: 0.523, Test loss: 1.578, Test accuracy: 56.32
Round  98, Train loss: 0.522, Test loss: 1.586, Test accuracy: 56.40
Round  99, Train loss: 0.516, Test loss: 1.610, Test accuracy: 55.73
Final Round, Train loss: 0.484, Test loss: 1.579, Test accuracy: 56.83
Average accuracy final 10 rounds: 56.60083333333333
4544.902144670486
[2.9315876960754395, 5.2274792194366455, 7.5270445346832275, 9.801040649414062, 12.101279258728027, 14.38018274307251, 16.682358026504517, 18.958688497543335, 21.44614887237549, 23.943562269210815, 26.45402216911316, 28.958189487457275, 31.45541477203369, 33.96851348876953, 36.46352243423462, 38.95940852165222, 41.429319620132446, 43.72378849983215, 46.0128390789032, 48.308619022369385, 50.60672950744629, 55.54768633842468, 60.45437955856323, 65.38596940040588, 70.29711747169495, 75.22610211372375, 80.15073919296265, 85.0727767944336, 89.98611068725586, 94.92885994911194, 99.85935878753662, 104.80204820632935, 109.70754408836365, 114.60377144813538, 119.5176465511322, 124.45064353942871, 129.34912514686584, 134.2554225921631, 139.24137091636658, 144.1747705936432, 149.0735092163086, 153.96213364601135, 158.87488675117493, 163.76743292808533, 168.66475439071655, 173.5704686641693, 178.48270392417908, 183.44346570968628, 188.35933876037598, 193.25276398658752, 198.1428029537201, 203.06800198554993, 208.37979078292847, 213.691547870636, 218.9525740146637, 224.1501429080963, 229.4655418395996, 234.85203170776367, 240.2534260749817, 245.6090064048767, 250.98410868644714, 256.48678755760193, 261.8003280162811, 267.32823300361633, 272.7060823440552, 278.23258543014526, 283.5726487636566, 288.86736607551575, 294.2547221183777, 299.6225674152374, 305.1349422931671, 310.4938039779663, 315.85714387893677, 321.15372133255005, 326.4617500305176, 331.8039722442627, 336.86140275001526, 342.1319570541382, 347.22777557373047, 352.18881845474243, 357.16381645202637, 362.0640435218811, 367.0273516178131, 372.0184667110443, 376.83368706703186, 381.7795374393463, 386.5792045593262, 391.53932452201843, 396.5133934020996, 401.34622383117676, 406.30833888053894, 411.14443039894104, 416.14198088645935, 421.19227504730225, 426.4176502227783, 431.62817883491516, 436.7972421646118, 441.9603359699249, 447.1708278656006, 452.365398645401, 455.95906925201416]
[26.958333333333332, 39.483333333333334, 44.266666666666666, 49.233333333333334, 52.275, 53.9, 56.55, 57.74166666666667, 58.71666666666667, 60.30833333333333, 60.2, 62.65, 62.325, 62.95, 62.416666666666664, 63.59166666666667, 63.325, 63.99166666666667, 64.03333333333333, 63.63333333333333, 63.25, 62.68333333333333, 63.875, 63.075, 63.208333333333336, 63.291666666666664, 64.15833333333333, 63.675, 63.49166666666667, 61.93333333333333, 62.25, 61.84166666666667, 62.15, 60.775, 61.55, 61.65833333333333, 62.358333333333334, 62.708333333333336, 62.00833333333333, 62.025, 62.19166666666667, 62.38333333333333, 61.016666666666666, 59.858333333333334, 60.0, 59.875, 58.833333333333336, 60.583333333333336, 59.94166666666667, 58.8, 59.025, 60.55833333333333, 59.7, 59.24166666666667, 60.583333333333336, 59.49166666666667, 58.725, 58.391666666666666, 57.84166666666667, 58.3, 57.55833333333333, 58.05, 57.99166666666667, 59.041666666666664, 59.175, 59.175, 57.88333333333333, 57.391666666666666, 56.80833333333333, 56.99166666666667, 56.65833333333333, 56.50833333333333, 56.708333333333336, 56.5, 56.81666666666667, 57.43333333333333, 57.583333333333336, 57.675, 57.025, 56.95, 57.96666666666667, 57.38333333333333, 57.65, 57.61666666666667, 57.733333333333334, 57.05, 57.725, 57.36666666666667, 57.55833333333333, 57.5, 57.291666666666664, 57.05, 56.75833333333333, 56.25, 57.3, 56.46666666666667, 56.44166666666667, 56.31666666666667, 56.4, 55.733333333333334, 56.825]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.908, Test loss: 1.821, Test accuracy: 32.07
Round   1, Train loss: 1.664, Test loss: 1.480, Test accuracy: 43.05
Round   2, Train loss: 1.555, Test loss: 1.363, Test accuracy: 49.52
Round   3, Train loss: 1.493, Test loss: 1.284, Test accuracy: 52.55
Round   4, Train loss: 1.451, Test loss: 1.247, Test accuracy: 55.46
Round   5, Train loss: 1.417, Test loss: 1.189, Test accuracy: 57.23
Round   6, Train loss: 1.388, Test loss: 1.168, Test accuracy: 58.02
Round   7, Train loss: 1.364, Test loss: 1.141, Test accuracy: 60.06
Round   8, Train loss: 1.338, Test loss: 1.123, Test accuracy: 60.08
Round   9, Train loss: 1.313, Test loss: 1.118, Test accuracy: 61.67
Round  10, Train loss: 1.326, Test loss: 1.130, Test accuracy: 61.02
Round  11, Train loss: 1.293, Test loss: 1.159, Test accuracy: 58.87
Round  12, Train loss: 1.182, Test loss: 1.098, Test accuracy: 61.23
Round  13, Train loss: 1.354, Test loss: 1.115, Test accuracy: 61.32
Round  14, Train loss: 1.366, Test loss: 1.088, Test accuracy: 62.88
Round  15, Train loss: 1.236, Test loss: 1.058, Test accuracy: 63.08
Round  16, Train loss: 1.112, Test loss: 1.017, Test accuracy: 63.94
Round  17, Train loss: 1.111, Test loss: 1.019, Test accuracy: 64.12
Round  18, Train loss: 1.051, Test loss: 1.005, Test accuracy: 64.90
Round  19, Train loss: 1.032, Test loss: 0.982, Test accuracy: 65.75
Round  20, Train loss: 1.223, Test loss: 0.981, Test accuracy: 65.53
Round  21, Train loss: 1.067, Test loss: 0.980, Test accuracy: 65.45
Round  22, Train loss: 1.038, Test loss: 0.957, Test accuracy: 66.44
Round  23, Train loss: 1.107, Test loss: 0.964, Test accuracy: 66.83
Round  24, Train loss: 1.025, Test loss: 0.935, Test accuracy: 67.38
Round  25, Train loss: 1.320, Test loss: 0.965, Test accuracy: 67.07
Round  26, Train loss: 0.986, Test loss: 0.954, Test accuracy: 67.16
Round  27, Train loss: 1.088, Test loss: 0.950, Test accuracy: 67.79
Round  28, Train loss: 1.156, Test loss: 0.968, Test accuracy: 67.07
Round  29, Train loss: 0.847, Test loss: 0.927, Test accuracy: 68.61
Round  30, Train loss: 1.055, Test loss: 0.949, Test accuracy: 67.39
Round  31, Train loss: 0.949, Test loss: 0.942, Test accuracy: 67.24
Round  32, Train loss: 1.063, Test loss: 0.960, Test accuracy: 66.75
Round  33, Train loss: 1.029, Test loss: 0.978, Test accuracy: 65.99
Round  34, Train loss: 0.989, Test loss: 0.974, Test accuracy: 66.21
Round  35, Train loss: 0.893, Test loss: 0.965, Test accuracy: 66.61
Round  36, Train loss: 1.111, Test loss: 0.969, Test accuracy: 66.46
Round  37, Train loss: 0.867, Test loss: 0.942, Test accuracy: 67.22
Round  38, Train loss: 0.781, Test loss: 0.954, Test accuracy: 67.07
Round  39, Train loss: 0.918, Test loss: 0.965, Test accuracy: 66.66
Round  40, Train loss: 0.714, Test loss: 0.941, Test accuracy: 67.20
Round  41, Train loss: 1.097, Test loss: 0.992, Test accuracy: 65.54
Round  42, Train loss: 0.731, Test loss: 0.961, Test accuracy: 66.61
Round  43, Train loss: 0.928, Test loss: 1.003, Test accuracy: 64.53
Round  44, Train loss: 0.757, Test loss: 0.974, Test accuracy: 66.45
Round  45, Train loss: 0.704, Test loss: 0.962, Test accuracy: 66.68
Round  46, Train loss: 0.931, Test loss: 0.999, Test accuracy: 65.00
Round  47, Train loss: 0.840, Test loss: 1.006, Test accuracy: 65.21
Round  48, Train loss: 0.835, Test loss: 0.984, Test accuracy: 65.92
Round  49, Train loss: 0.805, Test loss: 1.015, Test accuracy: 64.67
Round  50, Train loss: 0.951, Test loss: 1.031, Test accuracy: 63.92
Round  51, Train loss: 0.818, Test loss: 1.021, Test accuracy: 64.68
Round  52, Train loss: 0.936, Test loss: 1.036, Test accuracy: 63.82
Round  53, Train loss: 0.744, Test loss: 1.037, Test accuracy: 63.98
Round  54, Train loss: 0.822, Test loss: 1.035, Test accuracy: 63.83
Round  55, Train loss: 0.463, Test loss: 0.975, Test accuracy: 66.64
Round  56, Train loss: 0.798, Test loss: 1.010, Test accuracy: 65.65
Round  57, Train loss: 0.758, Test loss: 1.027, Test accuracy: 65.34
Round  58, Train loss: 0.748, Test loss: 1.043, Test accuracy: 64.83
Round  59, Train loss: 0.724, Test loss: 1.040, Test accuracy: 64.97
Round  60, Train loss: 0.807, Test loss: 1.077, Test accuracy: 63.12
Round  61, Train loss: 0.709, Test loss: 1.047, Test accuracy: 63.89
Round  62, Train loss: 0.580, Test loss: 1.040, Test accuracy: 64.22
Round  63, Train loss: 0.694, Test loss: 1.026, Test accuracy: 64.58
Round  64, Train loss: 0.730, Test loss: 1.063, Test accuracy: 63.04
Round  65, Train loss: 0.737, Test loss: 1.059, Test accuracy: 63.67
Round  66, Train loss: 0.586, Test loss: 1.027, Test accuracy: 65.31
Round  67, Train loss: 0.647, Test loss: 1.019, Test accuracy: 65.34
Round  68, Train loss: 0.514, Test loss: 1.038, Test accuracy: 65.11
Round  69, Train loss: 0.607, Test loss: 1.035, Test accuracy: 65.04
Round  70, Train loss: 0.761, Test loss: 1.086, Test accuracy: 63.33
Round  71, Train loss: 0.639, Test loss: 1.074, Test accuracy: 63.13
Round  72, Train loss: 0.716, Test loss: 1.107, Test accuracy: 62.15
Round  73, Train loss: 0.637, Test loss: 1.140, Test accuracy: 61.45
Round  74, Train loss: 0.705, Test loss: 1.104, Test accuracy: 63.08
Round  75, Train loss: 0.718, Test loss: 1.090, Test accuracy: 63.48
Round  76, Train loss: 0.588, Test loss: 1.082, Test accuracy: 63.47
Round  77, Train loss: 0.604, Test loss: 1.107, Test accuracy: 63.48
Round  78, Train loss: 0.538, Test loss: 1.084, Test accuracy: 63.74
Round  79, Train loss: 0.617, Test loss: 1.079, Test accuracy: 64.26
Round  80, Train loss: 0.418, Test loss: 1.023, Test accuracy: 65.72
Round  81, Train loss: 0.385, Test loss: 1.020, Test accuracy: 65.99
Round  82, Train loss: 0.360, Test loss: 1.035, Test accuracy: 65.88
Round  83, Train loss: 0.354, Test loss: 1.016, Test accuracy: 66.22
Round  84, Train loss: 0.346, Test loss: 1.035, Test accuracy: 66.06
Round  85, Train loss: 0.331, Test loss: 1.034, Test accuracy: 65.68
Round  86, Train loss: 0.320, Test loss: 1.047, Test accuracy: 65.38
Round  87, Train loss: 0.311, Test loss: 1.046, Test accuracy: 65.76
Round  88, Train loss: 0.304, Test loss: 1.052, Test accuracy: 65.93
Round  89, Train loss: 0.310, Test loss: 1.048, Test accuracy: 65.52
Round  90, Train loss: 0.620, Test loss: 1.075, Test accuracy: 63.93
Round  91, Train loss: 0.590, Test loss: 1.105, Test accuracy: 63.42
Round  92, Train loss: 0.580, Test loss: 1.109, Test accuracy: 63.51
Round  93, Train loss: 0.564, Test loss: 1.107, Test accuracy: 63.61
Round  94, Train loss: 0.559, Test loss: 1.117, Test accuracy: 63.94
Round  95, Train loss: 0.555, Test loss: 1.126, Test accuracy: 62.91
Round  96, Train loss: 0.550, Test loss: 1.131, Test accuracy: 63.08
Round  97, Train loss: 0.541, Test loss: 1.138, Test accuracy: 63.31
Round  98, Train loss: 0.539, Test loss: 1.133, Test accuracy: 63.20
Round  99, Train loss: 0.538, Test loss: 1.143, Test accuracy: 62.79
Final Round, Train loss: 0.543, Test loss: 1.147, Test accuracy: 63.06
Average accuracy final 10 rounds: 63.37
4805.227016210556
[3.5148568153381348, 6.685569524765015, 9.850929975509644, 13.014044046401978, 16.179527759552002, 19.346700429916382, 22.523231983184814, 25.684335947036743, 28.849968910217285, 32.0294406414032, 35.20400524139404, 38.3765389919281, 41.54610872268677, 44.719977378845215, 47.89078688621521, 51.0591402053833, 54.22981095314026, 57.38730597496033, 60.551674127578735, 63.71858882904053, 66.88632822036743, 72.95602607727051, 78.71757531166077, 84.41818618774414, 90.15479063987732, 95.92563581466675, 101.7048168182373, 107.53605437278748, 113.28990387916565, 118.80071067810059, 124.30202579498291, 129.80889058113098, 135.30228471755981, 141.06735801696777, 146.89146208763123, 152.41498160362244, 157.93857097625732, 163.52152371406555, 169.08001041412354, 174.6690948009491, 180.22395586967468, 185.64947080612183, 191.20506477355957, 196.62093448638916, 202.18465995788574, 207.76012873649597, 213.2007713317871, 218.69326782226562, 224.2571029663086, 229.79235339164734, 235.2648184299469, 240.8329620361328, 246.34371519088745, 251.90331768989563, 257.3953766822815, 262.77743792533875, 268.172575712204, 273.56028938293457, 278.9602265357971, 284.4485487937927, 289.8688340187073, 295.58750009536743, 301.048859834671, 306.5119812488556, 312.04945135116577, 317.5945773124695, 323.1100151538849, 328.5815019607544, 334.1109712123871, 339.5253252983093, 344.99694561958313, 350.43453764915466, 355.90544414520264, 361.3133294582367, 366.71064281463623, 372.04847025871277, 377.55738615989685, 383.0569281578064, 388.7443296909332, 394.3904905319214, 400.054824590683, 405.67825293540955, 411.3042230606079, 417.013699054718, 422.72939801216125, 428.43098068237305, 434.15724658966064, 439.838582277298, 445.5754511356354, 451.2411334514618, 456.92400455474854, 462.6330966949463, 468.36038732528687, 474.08569741249084, 479.83387541770935, 485.51594161987305, 491.24490547180176, 496.9855625629425, 502.7046353816986, 508.67989015579224, 512.7386202812195]
[32.06666666666667, 43.05, 49.516666666666666, 52.55, 55.458333333333336, 57.225, 58.016666666666666, 60.05833333333333, 60.075, 61.675, 61.025, 58.86666666666667, 61.225, 61.31666666666667, 62.875, 63.075, 63.94166666666667, 64.11666666666666, 64.9, 65.75, 65.53333333333333, 65.45, 66.44166666666666, 66.825, 67.38333333333334, 67.06666666666666, 67.15833333333333, 67.79166666666667, 67.06666666666666, 68.60833333333333, 67.39166666666667, 67.24166666666666, 66.75, 65.99166666666666, 66.20833333333333, 66.60833333333333, 66.45833333333333, 67.21666666666667, 67.06666666666666, 66.65833333333333, 67.2, 65.54166666666667, 66.60833333333333, 64.53333333333333, 66.45, 66.68333333333334, 65.0, 65.20833333333333, 65.925, 64.66666666666667, 63.916666666666664, 64.68333333333334, 63.81666666666667, 63.975, 63.833333333333336, 66.64166666666667, 65.65, 65.34166666666667, 64.83333333333333, 64.975, 63.125, 63.891666666666666, 64.225, 64.575, 63.041666666666664, 63.666666666666664, 65.30833333333334, 65.34166666666667, 65.10833333333333, 65.04166666666667, 63.325, 63.13333333333333, 62.15, 61.45, 63.075, 63.475, 63.46666666666667, 63.475, 63.74166666666667, 64.25833333333334, 65.725, 65.99166666666666, 65.88333333333334, 66.225, 66.05833333333334, 65.68333333333334, 65.38333333333334, 65.75833333333334, 65.93333333333334, 65.51666666666667, 63.93333333333333, 63.425, 63.50833333333333, 63.608333333333334, 63.94166666666667, 62.90833333333333, 63.075, 63.30833333333333, 63.2, 62.791666666666664, 63.05833333333333]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.813, Test loss: 2.068, Test accuracy: 22.29
Round   0, Global train loss: 1.813, Global test loss: 2.223, Global test accuracy: 19.82
Round   1, Train loss: 1.680, Test loss: 1.829, Test accuracy: 29.31
Round   1, Global train loss: 1.680, Global test loss: 2.096, Global test accuracy: 24.58
Round   2, Train loss: 1.719, Test loss: 1.778, Test accuracy: 31.91
Round   2, Global train loss: 1.719, Global test loss: 2.129, Global test accuracy: 24.37
Round   3, Train loss: 1.565, Test loss: 1.741, Test accuracy: 34.23
Round   3, Global train loss: 1.565, Global test loss: 2.129, Global test accuracy: 23.93
Round   4, Train loss: 1.564, Test loss: 1.606, Test accuracy: 38.22
Round   4, Global train loss: 1.564, Global test loss: 1.988, Global test accuracy: 27.99
Round   5, Train loss: 1.611, Test loss: 1.483, Test accuracy: 42.02
Round   5, Global train loss: 1.611, Global test loss: 1.951, Global test accuracy: 25.75
Round   6, Train loss: 1.472, Test loss: 1.459, Test accuracy: 44.06
Round   6, Global train loss: 1.472, Global test loss: 2.043, Global test accuracy: 30.52
Round   7, Train loss: 1.524, Test loss: 1.446, Test accuracy: 44.57
Round   7, Global train loss: 1.524, Global test loss: 2.083, Global test accuracy: 22.17
Round   8, Train loss: 1.581, Test loss: 1.387, Test accuracy: 47.36
Round   8, Global train loss: 1.581, Global test loss: 2.005, Global test accuracy: 34.43
Round   9, Train loss: 1.450, Test loss: 1.376, Test accuracy: 48.40
Round   9, Global train loss: 1.450, Global test loss: 1.989, Global test accuracy: 31.35
Round  10, Train loss: 1.344, Test loss: 1.394, Test accuracy: 47.41
Round  10, Global train loss: 1.344, Global test loss: 1.966, Global test accuracy: 38.22
Round  11, Train loss: 1.340, Test loss: 1.381, Test accuracy: 47.49
Round  11, Global train loss: 1.340, Global test loss: 2.030, Global test accuracy: 29.07
Round  12, Train loss: 1.412, Test loss: 1.361, Test accuracy: 48.56
Round  12, Global train loss: 1.412, Global test loss: 1.968, Global test accuracy: 28.51
Round  13, Train loss: 1.421, Test loss: 1.359, Test accuracy: 49.12
Round  13, Global train loss: 1.421, Global test loss: 1.979, Global test accuracy: 30.10
Round  14, Train loss: 1.434, Test loss: 1.363, Test accuracy: 49.49
Round  14, Global train loss: 1.434, Global test loss: 2.014, Global test accuracy: 30.03
Round  15, Train loss: 1.436, Test loss: 1.351, Test accuracy: 49.73
Round  15, Global train loss: 1.436, Global test loss: 2.027, Global test accuracy: 29.60
Round  16, Train loss: 1.535, Test loss: 1.352, Test accuracy: 50.17
Round  16, Global train loss: 1.535, Global test loss: 2.057, Global test accuracy: 29.91
Round  17, Train loss: 1.301, Test loss: 1.341, Test accuracy: 50.20
Round  17, Global train loss: 1.301, Global test loss: 2.025, Global test accuracy: 29.49
Round  18, Train loss: 1.351, Test loss: 1.337, Test accuracy: 50.50
Round  18, Global train loss: 1.351, Global test loss: 2.010, Global test accuracy: 31.47
Round  19, Train loss: 1.260, Test loss: 1.342, Test accuracy: 50.37
Round  19, Global train loss: 1.260, Global test loss: 2.028, Global test accuracy: 22.26
Round  20, Train loss: 1.221, Test loss: 1.368, Test accuracy: 49.48
Round  20, Global train loss: 1.221, Global test loss: 1.921, Global test accuracy: 36.04
Round  21, Train loss: 1.154, Test loss: 1.385, Test accuracy: 49.21
Round  21, Global train loss: 1.154, Global test loss: 1.941, Global test accuracy: 33.83
Round  22, Train loss: 1.224, Test loss: 1.381, Test accuracy: 49.71
Round  22, Global train loss: 1.224, Global test loss: 1.868, Global test accuracy: 39.67
Round  23, Train loss: 1.092, Test loss: 1.371, Test accuracy: 50.33
Round  23, Global train loss: 1.092, Global test loss: 1.918, Global test accuracy: 36.05
Round  24, Train loss: 1.231, Test loss: 1.361, Test accuracy: 50.81
Round  24, Global train loss: 1.231, Global test loss: 2.072, Global test accuracy: 27.72
Round  25, Train loss: 1.199, Test loss: 1.363, Test accuracy: 50.68
Round  25, Global train loss: 1.199, Global test loss: 1.957, Global test accuracy: 30.88
Round  26, Train loss: 1.115, Test loss: 1.375, Test accuracy: 50.86
Round  26, Global train loss: 1.115, Global test loss: 1.939, Global test accuracy: 30.94
Round  27, Train loss: 0.876, Test loss: 1.395, Test accuracy: 50.64
Round  27, Global train loss: 0.876, Global test loss: 2.008, Global test accuracy: 28.59
Round  28, Train loss: 0.999, Test loss: 1.404, Test accuracy: 50.78
Round  28, Global train loss: 0.999, Global test loss: 1.872, Global test accuracy: 34.89
Round  29, Train loss: 1.170, Test loss: 1.418, Test accuracy: 50.67
Round  29, Global train loss: 1.170, Global test loss: 1.954, Global test accuracy: 32.03
Round  30, Train loss: 1.255, Test loss: 1.437, Test accuracy: 50.41
Round  30, Global train loss: 1.255, Global test loss: 2.024, Global test accuracy: 33.19
Round  31, Train loss: 1.096, Test loss: 1.467, Test accuracy: 49.79
Round  31, Global train loss: 1.096, Global test loss: 1.850, Global test accuracy: 37.72
Round  32, Train loss: 0.947, Test loss: 1.481, Test accuracy: 49.82
Round  32, Global train loss: 0.947, Global test loss: 1.966, Global test accuracy: 31.94
Round  33, Train loss: 1.160, Test loss: 1.488, Test accuracy: 49.75
Round  33, Global train loss: 1.160, Global test loss: 2.089, Global test accuracy: 24.26
Round  34, Train loss: 0.943, Test loss: 1.511, Test accuracy: 49.59
Round  34, Global train loss: 0.943, Global test loss: 2.028, Global test accuracy: 31.32
Round  35, Train loss: 0.764, Test loss: 1.516, Test accuracy: 49.77
Round  35, Global train loss: 0.764, Global test loss: 1.818, Global test accuracy: 33.32
Round  36, Train loss: 0.892, Test loss: 1.545, Test accuracy: 49.53
Round  36, Global train loss: 0.892, Global test loss: 1.905, Global test accuracy: 36.27
Round  37, Train loss: 0.943, Test loss: 1.563, Test accuracy: 49.21
Round  37, Global train loss: 0.943, Global test loss: 1.890, Global test accuracy: 38.32
Round  38, Train loss: 0.967, Test loss: 1.587, Test accuracy: 49.22
Round  38, Global train loss: 0.967, Global test loss: 1.871, Global test accuracy: 37.42
Round  39, Train loss: 0.817, Test loss: 1.617, Test accuracy: 48.73
Round  39, Global train loss: 0.817, Global test loss: 1.900, Global test accuracy: 37.17
Round  40, Train loss: 0.968, Test loss: 1.632, Test accuracy: 48.31
Round  40, Global train loss: 0.968, Global test loss: 2.117, Global test accuracy: 25.42
Round  41, Train loss: 0.691, Test loss: 1.634, Test accuracy: 48.98
Round  41, Global train loss: 0.691, Global test loss: 2.115, Global test accuracy: 25.43
Round  42, Train loss: 0.630, Test loss: 1.647, Test accuracy: 49.35
Round  42, Global train loss: 0.630, Global test loss: 1.897, Global test accuracy: 37.27
Round  43, Train loss: 0.655, Test loss: 1.709, Test accuracy: 48.65
Round  43, Global train loss: 0.655, Global test loss: 2.000, Global test accuracy: 33.18
Round  44, Train loss: 0.710, Test loss: 1.741, Test accuracy: 48.77
Round  44, Global train loss: 0.710, Global test loss: 1.993, Global test accuracy: 32.70
Round  45, Train loss: 0.658, Test loss: 1.763, Test accuracy: 48.65
Round  45, Global train loss: 0.658, Global test loss: 1.932, Global test accuracy: 31.70
Round  46, Train loss: 0.696, Test loss: 1.792, Test accuracy: 48.28
Round  46, Global train loss: 0.696, Global test loss: 2.020, Global test accuracy: 26.90
Round  47, Train loss: 0.703, Test loss: 1.837, Test accuracy: 47.91
Round  47, Global train loss: 0.703, Global test loss: 1.870, Global test accuracy: 38.11
Round  48, Train loss: 0.824, Test loss: 1.885, Test accuracy: 47.91
Round  48, Global train loss: 0.824, Global test loss: 2.007, Global test accuracy: 33.36
Round  49, Train loss: 0.453, Test loss: 1.924, Test accuracy: 48.23
Round  49, Global train loss: 0.453, Global test loss: 1.955, Global test accuracy: 29.60
Round  50, Train loss: 0.578, Test loss: 1.978, Test accuracy: 47.98
Round  50, Global train loss: 0.578, Global test loss: 1.948, Global test accuracy: 32.03
Round  51, Train loss: 0.651, Test loss: 1.993, Test accuracy: 47.73
Round  51, Global train loss: 0.651, Global test loss: 2.146, Global test accuracy: 25.15
Round  52, Train loss: 0.513, Test loss: 2.033, Test accuracy: 47.88
Round  52, Global train loss: 0.513, Global test loss: 2.032, Global test accuracy: 25.11
Round  53, Train loss: 0.542, Test loss: 2.059, Test accuracy: 47.42
Round  53, Global train loss: 0.542, Global test loss: 2.104, Global test accuracy: 23.17
Round  54, Train loss: 0.538, Test loss: 2.062, Test accuracy: 47.90
Round  54, Global train loss: 0.538, Global test loss: 1.880, Global test accuracy: 40.32
Round  55, Train loss: 0.570, Test loss: 2.105, Test accuracy: 47.83
Round  55, Global train loss: 0.570, Global test loss: 1.923, Global test accuracy: 33.96
Round  56, Train loss: 0.495, Test loss: 2.127, Test accuracy: 48.11
Round  56, Global train loss: 0.495, Global test loss: 1.924, Global test accuracy: 36.01
Round  57, Train loss: 0.494, Test loss: 2.129, Test accuracy: 48.18
Round  57, Global train loss: 0.494, Global test loss: 1.842, Global test accuracy: 35.08
Round  58, Train loss: 0.528, Test loss: 2.170, Test accuracy: 48.24
Round  58, Global train loss: 0.528, Global test loss: 1.910, Global test accuracy: 33.93
Round  59, Train loss: 0.439, Test loss: 2.189, Test accuracy: 48.02
Round  59, Global train loss: 0.439, Global test loss: 1.976, Global test accuracy: 28.86
Round  60, Train loss: 0.475, Test loss: 2.233, Test accuracy: 48.11
Round  60, Global train loss: 0.475, Global test loss: 2.089, Global test accuracy: 25.12
Round  61, Train loss: 0.334, Test loss: 2.325, Test accuracy: 47.62
Round  61, Global train loss: 0.334, Global test loss: 1.967, Global test accuracy: 35.83
Round  62, Train loss: 0.463, Test loss: 2.392, Test accuracy: 47.02
Round  62, Global train loss: 0.463, Global test loss: 1.987, Global test accuracy: 25.72
Round  63, Train loss: 0.415, Test loss: 2.408, Test accuracy: 46.77
Round  63, Global train loss: 0.415, Global test loss: 1.893, Global test accuracy: 31.73
Round  64, Train loss: 0.414, Test loss: 2.404, Test accuracy: 46.94
Round  64, Global train loss: 0.414, Global test loss: 2.025, Global test accuracy: 29.79
Round  65, Train loss: 0.412, Test loss: 2.385, Test accuracy: 47.69
Round  65, Global train loss: 0.412, Global test loss: 2.059, Global test accuracy: 30.21
Round  66, Train loss: 0.433, Test loss: 2.401, Test accuracy: 47.38
Round  66, Global train loss: 0.433, Global test loss: 1.934, Global test accuracy: 37.46
Round  67, Train loss: 0.361, Test loss: 2.419, Test accuracy: 46.99
Round  67, Global train loss: 0.361, Global test loss: 1.898, Global test accuracy: 37.17
Round  68, Train loss: 0.302, Test loss: 2.442, Test accuracy: 47.22
Round  68, Global train loss: 0.302, Global test loss: 1.801, Global test accuracy: 39.70
Round  69, Train loss: 0.347, Test loss: 2.488, Test accuracy: 47.14
Round  69, Global train loss: 0.347, Global test loss: 2.117, Global test accuracy: 25.52
Round  70, Train loss: 0.322, Test loss: 2.481, Test accuracy: 47.73
Round  70, Global train loss: 0.322, Global test loss: 1.910, Global test accuracy: 33.48
Round  71, Train loss: 0.242, Test loss: 2.546, Test accuracy: 47.27
Round  71, Global train loss: 0.242, Global test loss: 1.844, Global test accuracy: 35.08
Round  72, Train loss: 0.350, Test loss: 2.573, Test accuracy: 47.21
Round  72, Global train loss: 0.350, Global test loss: 2.018, Global test accuracy: 29.57
Round  73, Train loss: 0.233, Test loss: 2.596, Test accuracy: 46.90
Round  73, Global train loss: 0.233, Global test loss: 1.831, Global test accuracy: 40.02
Round  74, Train loss: 0.300, Test loss: 2.637, Test accuracy: 46.58
Round  74, Global train loss: 0.300, Global test loss: 1.983, Global test accuracy: 28.59
Round  75, Train loss: 0.295, Test loss: 2.676, Test accuracy: 46.61
Round  75, Global train loss: 0.295, Global test loss: 2.004, Global test accuracy: 31.34
Round  76, Train loss: 0.331, Test loss: 2.707, Test accuracy: 46.76
Round  76, Global train loss: 0.331, Global test loss: 1.941, Global test accuracy: 32.81
Round  77, Train loss: 0.302, Test loss: 2.735, Test accuracy: 47.09
Round  77, Global train loss: 0.302, Global test loss: 1.975, Global test accuracy: 35.59
Round  78, Train loss: 0.289, Test loss: 2.773, Test accuracy: 47.16
Round  78, Global train loss: 0.289, Global test loss: 2.020, Global test accuracy: 29.21
Round  79, Train loss: 0.240, Test loss: 2.724, Test accuracy: 47.27
Round  79, Global train loss: 0.240, Global test loss: 1.972, Global test accuracy: 31.33
Round  80, Train loss: 0.259, Test loss: 2.707, Test accuracy: 47.85
Round  80, Global train loss: 0.259, Global test loss: 2.089, Global test accuracy: 25.05
Round  81, Train loss: 0.198, Test loss: 2.692, Test accuracy: 47.92
Round  81, Global train loss: 0.198, Global test loss: 1.861, Global test accuracy: 31.38
Round  82, Train loss: 0.281, Test loss: 2.714, Test accuracy: 47.94
Round  82, Global train loss: 0.281, Global test loss: 1.985, Global test accuracy: 33.89
Round  83, Train loss: 0.234, Test loss: 2.753, Test accuracy: 48.08
Round  83, Global train loss: 0.234, Global test loss: 2.034, Global test accuracy: 30.52
Round  84, Train loss: 0.211, Test loss: 2.775, Test accuracy: 47.47
Round  84, Global train loss: 0.211, Global test loss: 2.043, Global test accuracy: 26.47
Round  85, Train loss: 0.236, Test loss: 2.851, Test accuracy: 47.61
Round  85, Global train loss: 0.236, Global test loss: 1.978, Global test accuracy: 33.97
Round  86, Train loss: 0.281, Test loss: 2.885, Test accuracy: 47.52
Round  86, Global train loss: 0.281, Global test loss: 2.069, Global test accuracy: 26.62
Round  87, Train loss: 0.247, Test loss: 2.875, Test accuracy: 47.55
Round  87, Global train loss: 0.247, Global test loss: 1.915, Global test accuracy: 33.03
Round  88, Train loss: 0.223, Test loss: 2.881, Test accuracy: 47.57
Round  88, Global train loss: 0.223, Global test loss: 1.996, Global test accuracy: 31.82
Round  89, Train loss: 0.185, Test loss: 2.909, Test accuracy: 47.76
Round  89, Global train loss: 0.185, Global test loss: 2.000, Global test accuracy: 28.91
Round  90, Train loss: 0.229, Test loss: 2.901, Test accuracy: 47.81
Round  90, Global train loss: 0.229, Global test loss: 2.071, Global test accuracy: 27.84
Round  91, Train loss: 0.215, Test loss: 2.907, Test accuracy: 47.71
Round  91, Global train loss: 0.215, Global test loss: 2.050, Global test accuracy: 26.39
Round  92, Train loss: 0.259, Test loss: 2.929, Test accuracy: 48.17
Round  92, Global train loss: 0.259, Global test loss: 2.034, Global test accuracy: 26.04
Round  93, Train loss: 0.168, Test loss: 2.962, Test accuracy: 48.40
Round  93, Global train loss: 0.168, Global test loss: 2.062, Global test accuracy: 28.73
Round  94, Train loss: 0.239, Test loss: 2.985, Test accuracy: 47.66
Round  94, Global train loss: 0.239, Global test loss: 2.004, Global test accuracy: 32.56
Round  95, Train loss: 0.148, Test loss: 3.055, Test accuracy: 47.12
Round  95, Global train loss: 0.148, Global test loss: 1.975, Global test accuracy: 33.75
Round  96, Train loss: 0.227, Test loss: 3.053, Test accuracy: 47.71
Round  96, Global train loss: 0.227, Global test loss: 2.016, Global test accuracy: 33.49
Round  97, Train loss: 0.243, Test loss: 3.086, Test accuracy: 47.88
Round  97, Global train loss: 0.243, Global test loss: 2.071, Global test accuracy: 27.04
Round  98, Train loss: 0.126, Test loss: 3.097, Test accuracy: 47.86
Round  98, Global train loss: 0.126, Global test loss: 2.003, Global test accuracy: 29.22
Round  99, Train loss: 0.155, Test loss: 3.044, Test accuracy: 48.10
Round  99, Global train loss: 0.155, Global test loss: 1.895, Global test accuracy: 36.43
Final Round, Train loss: 0.161, Test loss: 3.263, Test accuracy: 48.09
Final Round, Global train loss: 0.161, Global test loss: 1.895, Global test accuracy: 36.43
Average accuracy final 10 rounds: 47.84166666666667 

Average global accuracy final 10 rounds: 30.149166666666666 

1688.5132789611816
[1.672959566116333, 3.345919132232666, 4.745591878890991, 6.145264625549316, 7.543690919876099, 8.94211721420288, 10.341111898422241, 11.740106582641602, 13.137275457382202, 14.534444332122803, 15.935051441192627, 17.33565855026245, 18.735836029052734, 20.136013507843018, 21.539023876190186, 22.942034244537354, 24.340259313583374, 25.738484382629395, 26.99441123008728, 28.250338077545166, 29.639341831207275, 31.028345584869385, 32.41647410392761, 33.80460262298584, 35.20009255409241, 36.595582485198975, 37.81099033355713, 39.02639818191528, 40.22779679298401, 41.429195404052734, 42.62831449508667, 43.827433586120605, 45.02516293525696, 46.22289228439331, 47.422943115234375, 48.62299394607544, 49.82068848609924, 51.01838302612305, 52.20373010635376, 53.38907718658447, 54.57398509979248, 55.75889301300049, 56.94975781440735, 58.14062261581421, 59.33954119682312, 60.53845977783203, 61.743927240371704, 62.94939470291138, 64.13938498497009, 65.32937526702881, 66.52628970146179, 67.72320413589478, 69.10360527038574, 70.48400640487671, 71.87250137329102, 73.26099634170532, 74.65929985046387, 76.05760335922241, 77.44876289367676, 78.8399224281311, 80.22575259208679, 81.61158275604248, 83.00242328643799, 84.3932638168335, 85.78095722198486, 87.16865062713623, 88.55842900276184, 89.94820737838745, 91.34083485603333, 92.7334623336792, 94.11704730987549, 95.50063228607178, 96.90095257759094, 98.30127286911011, 99.69922375679016, 101.09717464447021, 102.48486304283142, 103.87255144119263, 105.26208353042603, 106.65161561965942, 108.03582406044006, 109.4200325012207, 110.80068707466125, 112.1813416481018, 113.57172966003418, 114.96211767196655, 116.35062432289124, 117.73913097381592, 119.1268744468689, 120.51461791992188, 121.90383958816528, 123.29306125640869, 124.6813292503357, 126.0695972442627, 127.46148204803467, 128.85336685180664, 130.22829413414001, 131.6032214164734, 132.98356318473816, 134.36390495300293, 135.7510540485382, 137.1382031440735, 138.52937388420105, 139.9205446243286, 141.30760097503662, 142.69465732574463, 144.0714237689972, 145.44819021224976, 146.83517742156982, 148.2221646308899, 149.60929083824158, 150.99641704559326, 152.38747310638428, 153.7785291671753, 155.1561963558197, 156.5338635444641, 157.91003108024597, 159.28619861602783, 160.67278599739075, 162.05937337875366, 163.43226385116577, 164.80515432357788, 166.18579769134521, 167.56644105911255, 168.93137669563293, 170.29631233215332, 171.6620044708252, 173.02769660949707, 174.38752937316895, 175.74736213684082, 177.1087188720703, 178.4700756072998, 179.8404483795166, 181.2108211517334, 182.5806119441986, 183.95040273666382, 185.30904722213745, 186.66769170761108, 188.03377556800842, 189.39985942840576, 190.78266263008118, 192.1654658317566, 193.55318236351013, 194.94089889526367, 196.3260200023651, 197.71114110946655, 199.0929925441742, 200.47484397888184, 201.85825991630554, 203.24167585372925, 204.62704348564148, 206.0124111175537, 207.39332461357117, 208.77423810958862, 210.16041326522827, 211.54658842086792, 212.9281632900238, 214.3097381591797, 215.69255566596985, 217.07537317276, 218.4492325782776, 219.82309198379517, 221.19501066207886, 222.56692934036255, 223.94847989082336, 225.33003044128418, 226.70222163200378, 228.0744128227234, 229.4545111656189, 230.8346095085144, 232.01911187171936, 233.20361423492432, 234.3808696269989, 235.5581250190735, 236.7410442829132, 237.92396354675293, 239.1083357334137, 240.29270792007446, 241.47220134735107, 242.65169477462769, 243.8345377445221, 245.0173807144165, 246.19926595687866, 247.38115119934082, 248.56611108779907, 249.75107097625732, 250.93869614601135, 252.12632131576538, 253.31297874450684, 254.4996361732483, 255.67967009544373, 256.85970401763916, 258.04381823539734, 259.2279324531555, 260.41342639923096, 261.5989203453064, 262.78816056251526, 263.9774007797241, 265.1645755767822, 266.35175037384033, 268.32888197898865, 270.30601358413696]
[22.291666666666668, 22.291666666666668, 29.308333333333334, 29.308333333333334, 31.908333333333335, 31.908333333333335, 34.225, 34.225, 38.21666666666667, 38.21666666666667, 42.025, 42.025, 44.05833333333333, 44.05833333333333, 44.56666666666667, 44.56666666666667, 47.358333333333334, 47.358333333333334, 48.4, 48.4, 47.40833333333333, 47.40833333333333, 47.49166666666667, 47.49166666666667, 48.55833333333333, 48.55833333333333, 49.125, 49.125, 49.49166666666667, 49.49166666666667, 49.733333333333334, 49.733333333333334, 50.175, 50.175, 50.2, 50.2, 50.5, 50.5, 50.36666666666667, 50.36666666666667, 49.483333333333334, 49.483333333333334, 49.208333333333336, 49.208333333333336, 49.708333333333336, 49.708333333333336, 50.333333333333336, 50.333333333333336, 50.80833333333333, 50.80833333333333, 50.68333333333333, 50.68333333333333, 50.858333333333334, 50.858333333333334, 50.641666666666666, 50.641666666666666, 50.78333333333333, 50.78333333333333, 50.675, 50.675, 50.40833333333333, 50.40833333333333, 49.791666666666664, 49.791666666666664, 49.81666666666667, 49.81666666666667, 49.75, 49.75, 49.59166666666667, 49.59166666666667, 49.775, 49.775, 49.53333333333333, 49.53333333333333, 49.208333333333336, 49.208333333333336, 49.21666666666667, 49.21666666666667, 48.733333333333334, 48.733333333333334, 48.30833333333333, 48.30833333333333, 48.975, 48.975, 49.35, 49.35, 48.65, 48.65, 48.775, 48.775, 48.65, 48.65, 48.28333333333333, 48.28333333333333, 47.90833333333333, 47.90833333333333, 47.90833333333333, 47.90833333333333, 48.233333333333334, 48.233333333333334, 47.975, 47.975, 47.725, 47.725, 47.88333333333333, 47.88333333333333, 47.416666666666664, 47.416666666666664, 47.9, 47.9, 47.825, 47.825, 48.108333333333334, 48.108333333333334, 48.18333333333333, 48.18333333333333, 48.24166666666667, 48.24166666666667, 48.016666666666666, 48.016666666666666, 48.108333333333334, 48.108333333333334, 47.625, 47.625, 47.025, 47.025, 46.766666666666666, 46.766666666666666, 46.94166666666667, 46.94166666666667, 47.69166666666667, 47.69166666666667, 47.38333333333333, 47.38333333333333, 46.99166666666667, 46.99166666666667, 47.21666666666667, 47.21666666666667, 47.141666666666666, 47.141666666666666, 47.725, 47.725, 47.266666666666666, 47.266666666666666, 47.208333333333336, 47.208333333333336, 46.9, 46.9, 46.575, 46.575, 46.608333333333334, 46.608333333333334, 46.75833333333333, 46.75833333333333, 47.09166666666667, 47.09166666666667, 47.15833333333333, 47.15833333333333, 47.266666666666666, 47.266666666666666, 47.85, 47.85, 47.916666666666664, 47.916666666666664, 47.94166666666667, 47.94166666666667, 48.083333333333336, 48.083333333333336, 47.46666666666667, 47.46666666666667, 47.608333333333334, 47.608333333333334, 47.525, 47.525, 47.55, 47.55, 47.56666666666667, 47.56666666666667, 47.75833333333333, 47.75833333333333, 47.80833333333333, 47.80833333333333, 47.708333333333336, 47.708333333333336, 48.175, 48.175, 48.4, 48.4, 47.65833333333333, 47.65833333333333, 47.11666666666667, 47.11666666666667, 47.708333333333336, 47.708333333333336, 47.88333333333333, 47.88333333333333, 47.858333333333334, 47.858333333333334, 48.1, 48.1, 48.09166666666667, 48.09166666666667]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 13, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.746, Test loss: 2.012, Test accuracy: 24.34
Round   0, Global train loss: 1.746, Global test loss: 2.183, Global test accuracy: 20.24
Round   1, Train loss: 1.784, Test loss: 1.775, Test accuracy: 32.70
Round   1, Global train loss: 1.784, Global test loss: 2.056, Global test accuracy: 25.84
Round   2, Train loss: 1.558, Test loss: 1.664, Test accuracy: 35.49
Round   2, Global train loss: 1.558, Global test loss: 1.913, Global test accuracy: 27.69
Round   3, Train loss: 1.598, Test loss: 1.648, Test accuracy: 38.21
Round   3, Global train loss: 1.598, Global test loss: 1.944, Global test accuracy: 30.36
Round   4, Train loss: 1.555, Test loss: 1.512, Test accuracy: 42.28
Round   4, Global train loss: 1.555, Global test loss: 1.835, Global test accuracy: 33.79
Round   5, Train loss: 1.550, Test loss: 1.407, Test accuracy: 46.31
Round   5, Global train loss: 1.550, Global test loss: 1.802, Global test accuracy: 34.17
Round   6, Train loss: 1.475, Test loss: 1.366, Test accuracy: 49.08
Round   6, Global train loss: 1.475, Global test loss: 1.660, Global test accuracy: 42.00
Round   7, Train loss: 1.358, Test loss: 1.355, Test accuracy: 48.94
Round   7, Global train loss: 1.358, Global test loss: 1.632, Global test accuracy: 40.99
Round   8, Train loss: 1.650, Test loss: 1.316, Test accuracy: 50.91
Round   8, Global train loss: 1.650, Global test loss: 1.749, Global test accuracy: 44.21
Round   9, Train loss: 1.471, Test loss: 1.316, Test accuracy: 51.68
Round   9, Global train loss: 1.471, Global test loss: 1.630, Global test accuracy: 45.28
Round  10, Train loss: 1.370, Test loss: 1.294, Test accuracy: 52.67
Round  10, Global train loss: 1.370, Global test loss: 1.528, Global test accuracy: 48.19
Round  11, Train loss: 1.205, Test loss: 1.296, Test accuracy: 52.90
Round  11, Global train loss: 1.205, Global test loss: 1.458, Global test accuracy: 49.13
Round  12, Train loss: 1.447, Test loss: 1.281, Test accuracy: 54.12
Round  12, Global train loss: 1.447, Global test loss: 1.594, Global test accuracy: 44.82
Round  13, Train loss: 1.423, Test loss: 1.245, Test accuracy: 55.17
Round  13, Global train loss: 1.423, Global test loss: 1.599, Global test accuracy: 46.11
Round  14, Train loss: 1.264, Test loss: 1.220, Test accuracy: 55.75
Round  14, Global train loss: 1.264, Global test loss: 1.503, Global test accuracy: 46.73
Round  15, Train loss: 1.355, Test loss: 1.220, Test accuracy: 55.93
Round  15, Global train loss: 1.355, Global test loss: 1.521, Global test accuracy: 48.73
Round  16, Train loss: 1.302, Test loss: 1.207, Test accuracy: 56.77
Round  16, Global train loss: 1.302, Global test loss: 1.470, Global test accuracy: 51.57
Round  17, Train loss: 1.328, Test loss: 1.201, Test accuracy: 56.90
Round  17, Global train loss: 1.328, Global test loss: 1.524, Global test accuracy: 46.15
Round  18, Train loss: 1.355, Test loss: 1.186, Test accuracy: 57.32
Round  18, Global train loss: 1.355, Global test loss: 1.515, Global test accuracy: 50.51
Round  19, Train loss: 1.296, Test loss: 1.159, Test accuracy: 59.02
Round  19, Global train loss: 1.296, Global test loss: 1.432, Global test accuracy: 51.53
Round  20, Train loss: 1.350, Test loss: 1.153, Test accuracy: 59.71
Round  20, Global train loss: 1.350, Global test loss: 1.436, Global test accuracy: 55.62
Round  21, Train loss: 1.162, Test loss: 1.171, Test accuracy: 59.33
Round  21, Global train loss: 1.162, Global test loss: 1.326, Global test accuracy: 56.81
Round  22, Train loss: 1.233, Test loss: 1.170, Test accuracy: 59.37
Round  22, Global train loss: 1.233, Global test loss: 1.332, Global test accuracy: 57.53
Round  23, Train loss: 1.326, Test loss: 1.156, Test accuracy: 59.77
Round  23, Global train loss: 1.326, Global test loss: 1.413, Global test accuracy: 55.08
Round  24, Train loss: 1.324, Test loss: 1.143, Test accuracy: 60.29
Round  24, Global train loss: 1.324, Global test loss: 1.509, Global test accuracy: 50.33
Round  25, Train loss: 1.138, Test loss: 1.137, Test accuracy: 60.74
Round  25, Global train loss: 1.138, Global test loss: 1.410, Global test accuracy: 54.01
Round  26, Train loss: 1.330, Test loss: 1.116, Test accuracy: 61.34
Round  26, Global train loss: 1.330, Global test loss: 1.427, Global test accuracy: 54.79
Round  27, Train loss: 1.100, Test loss: 1.123, Test accuracy: 60.65
Round  27, Global train loss: 1.100, Global test loss: 1.464, Global test accuracy: 52.84
Round  28, Train loss: 1.096, Test loss: 1.119, Test accuracy: 60.63
Round  28, Global train loss: 1.096, Global test loss: 1.421, Global test accuracy: 51.76
Round  29, Train loss: 1.297, Test loss: 1.111, Test accuracy: 61.16
Round  29, Global train loss: 1.297, Global test loss: 1.437, Global test accuracy: 52.59
Round  30, Train loss: 1.256, Test loss: 1.101, Test accuracy: 61.57
Round  30, Global train loss: 1.256, Global test loss: 1.428, Global test accuracy: 53.06
Round  31, Train loss: 1.238, Test loss: 1.102, Test accuracy: 61.58
Round  31, Global train loss: 1.238, Global test loss: 1.361, Global test accuracy: 57.31
Round  32, Train loss: 0.987, Test loss: 1.112, Test accuracy: 61.43
Round  32, Global train loss: 0.987, Global test loss: 1.252, Global test accuracy: 58.54
Round  33, Train loss: 1.116, Test loss: 1.112, Test accuracy: 61.42
Round  33, Global train loss: 1.116, Global test loss: 1.316, Global test accuracy: 56.22
Round  34, Train loss: 0.999, Test loss: 1.127, Test accuracy: 61.12
Round  34, Global train loss: 0.999, Global test loss: 1.279, Global test accuracy: 57.42
Round  35, Train loss: 1.133, Test loss: 1.123, Test accuracy: 61.05
Round  35, Global train loss: 1.133, Global test loss: 1.298, Global test accuracy: 58.62
Round  36, Train loss: 1.071, Test loss: 1.122, Test accuracy: 61.35
Round  36, Global train loss: 1.071, Global test loss: 1.272, Global test accuracy: 58.94
Round  37, Train loss: 1.194, Test loss: 1.120, Test accuracy: 61.42
Round  37, Global train loss: 1.194, Global test loss: 1.348, Global test accuracy: 57.14
Round  38, Train loss: 1.202, Test loss: 1.106, Test accuracy: 61.87
Round  38, Global train loss: 1.202, Global test loss: 1.364, Global test accuracy: 57.11
Round  39, Train loss: 1.247, Test loss: 1.110, Test accuracy: 61.60
Round  39, Global train loss: 1.247, Global test loss: 1.493, Global test accuracy: 51.35
Round  40, Train loss: 1.118, Test loss: 1.112, Test accuracy: 61.57
Round  40, Global train loss: 1.118, Global test loss: 1.339, Global test accuracy: 56.48
Round  41, Train loss: 0.863, Test loss: 1.136, Test accuracy: 60.86
Round  41, Global train loss: 0.863, Global test loss: 1.427, Global test accuracy: 53.67
Round  42, Train loss: 0.996, Test loss: 1.149, Test accuracy: 60.51
Round  42, Global train loss: 0.996, Global test loss: 1.273, Global test accuracy: 57.77
Round  43, Train loss: 0.857, Test loss: 1.141, Test accuracy: 61.00
Round  43, Global train loss: 0.857, Global test loss: 1.354, Global test accuracy: 56.85
Round  44, Train loss: 1.064, Test loss: 1.158, Test accuracy: 60.54
Round  44, Global train loss: 1.064, Global test loss: 1.392, Global test accuracy: 55.33
Round  45, Train loss: 1.047, Test loss: 1.166, Test accuracy: 59.87
Round  45, Global train loss: 1.047, Global test loss: 1.348, Global test accuracy: 56.31
Round  46, Train loss: 0.921, Test loss: 1.173, Test accuracy: 59.67
Round  46, Global train loss: 0.921, Global test loss: 1.266, Global test accuracy: 58.05
Round  47, Train loss: 1.103, Test loss: 1.162, Test accuracy: 60.42
Round  47, Global train loss: 1.103, Global test loss: 1.470, Global test accuracy: 53.46
Round  48, Train loss: 0.970, Test loss: 1.162, Test accuracy: 60.48
Round  48, Global train loss: 0.970, Global test loss: 1.314, Global test accuracy: 56.19
Round  49, Train loss: 0.902, Test loss: 1.169, Test accuracy: 60.65
Round  49, Global train loss: 0.902, Global test loss: 1.357, Global test accuracy: 54.94
Round  50, Train loss: 1.010, Test loss: 1.180, Test accuracy: 60.33
Round  50, Global train loss: 1.010, Global test loss: 1.385, Global test accuracy: 55.23
Round  51, Train loss: 0.926, Test loss: 1.173, Test accuracy: 60.56
Round  51, Global train loss: 0.926, Global test loss: 1.313, Global test accuracy: 58.00
Round  52, Train loss: 0.911, Test loss: 1.173, Test accuracy: 60.48
Round  52, Global train loss: 0.911, Global test loss: 1.330, Global test accuracy: 56.18
Round  53, Train loss: 0.828, Test loss: 1.167, Test accuracy: 60.75
Round  53, Global train loss: 0.828, Global test loss: 1.254, Global test accuracy: 58.38
Round  54, Train loss: 1.035, Test loss: 1.163, Test accuracy: 61.12
Round  54, Global train loss: 1.035, Global test loss: 1.286, Global test accuracy: 58.59
Round  55, Train loss: 1.190, Test loss: 1.169, Test accuracy: 60.92
Round  55, Global train loss: 1.190, Global test loss: 1.438, Global test accuracy: 54.63
Round  56, Train loss: 0.798, Test loss: 1.201, Test accuracy: 59.98
Round  56, Global train loss: 0.798, Global test loss: 1.235, Global test accuracy: 59.73
Round  57, Train loss: 1.160, Test loss: 1.193, Test accuracy: 60.56
Round  57, Global train loss: 1.160, Global test loss: 1.416, Global test accuracy: 55.40
Round  58, Train loss: 0.884, Test loss: 1.193, Test accuracy: 60.45
Round  58, Global train loss: 0.884, Global test loss: 1.289, Global test accuracy: 57.88
Round  59, Train loss: 1.020, Test loss: 1.222, Test accuracy: 59.38
Round  59, Global train loss: 1.020, Global test loss: 1.435, Global test accuracy: 54.24
Round  60, Train loss: 0.855, Test loss: 1.226, Test accuracy: 59.52
Round  60, Global train loss: 0.855, Global test loss: 1.442, Global test accuracy: 53.50
Round  61, Train loss: 0.968, Test loss: 1.221, Test accuracy: 59.39
Round  61, Global train loss: 0.968, Global test loss: 1.503, Global test accuracy: 53.02
Round  62, Train loss: 1.002, Test loss: 1.226, Test accuracy: 59.58
Round  62, Global train loss: 1.002, Global test loss: 1.441, Global test accuracy: 53.17
Round  63, Train loss: 0.933, Test loss: 1.230, Test accuracy: 59.39
Round  63, Global train loss: 0.933, Global test loss: 1.496, Global test accuracy: 51.70
Round  64, Train loss: 0.858, Test loss: 1.242, Test accuracy: 59.19
Round  64, Global train loss: 0.858, Global test loss: 1.414, Global test accuracy: 55.87
Round  65, Train loss: 0.827, Test loss: 1.272, Test accuracy: 58.81
Round  65, Global train loss: 0.827, Global test loss: 1.435, Global test accuracy: 56.36
Round  66, Train loss: 1.006, Test loss: 1.278, Test accuracy: 58.90
Round  66, Global train loss: 1.006, Global test loss: 1.421, Global test accuracy: 54.48
Round  67, Train loss: 0.846, Test loss: 1.306, Test accuracy: 58.91
Round  67, Global train loss: 0.846, Global test loss: 1.335, Global test accuracy: 57.17
Round  68, Train loss: 0.825, Test loss: 1.330, Test accuracy: 58.31
Round  68, Global train loss: 0.825, Global test loss: 1.443, Global test accuracy: 54.86
Round  69, Train loss: 0.717, Test loss: 1.328, Test accuracy: 58.48
Round  69, Global train loss: 0.717, Global test loss: 1.264, Global test accuracy: 59.59
Round  70, Train loss: 0.649, Test loss: 1.309, Test accuracy: 58.99
Round  70, Global train loss: 0.649, Global test loss: 1.293, Global test accuracy: 59.91
Round  71, Train loss: 0.919, Test loss: 1.309, Test accuracy: 59.38
Round  71, Global train loss: 0.919, Global test loss: 1.433, Global test accuracy: 55.48
Round  72, Train loss: 0.850, Test loss: 1.299, Test accuracy: 59.11
Round  72, Global train loss: 0.850, Global test loss: 1.369, Global test accuracy: 56.08
Round  73, Train loss: 0.790, Test loss: 1.292, Test accuracy: 59.64
Round  73, Global train loss: 0.790, Global test loss: 1.498, Global test accuracy: 54.38
Round  74, Train loss: 0.748, Test loss: 1.291, Test accuracy: 59.65
Round  74, Global train loss: 0.748, Global test loss: 1.370, Global test accuracy: 56.81
Round  75, Train loss: 0.823, Test loss: 1.332, Test accuracy: 58.58
Round  75, Global train loss: 0.823, Global test loss: 1.401, Global test accuracy: 57.08
Round  76, Train loss: 0.856, Test loss: 1.334, Test accuracy: 58.87
Round  76, Global train loss: 0.856, Global test loss: 1.384, Global test accuracy: 56.90
Round  77, Train loss: 0.879, Test loss: 1.322, Test accuracy: 59.08
Round  77, Global train loss: 0.879, Global test loss: 1.545, Global test accuracy: 51.76
Round  78, Train loss: 0.781, Test loss: 1.344, Test accuracy: 58.79
Round  78, Global train loss: 0.781, Global test loss: 1.570, Global test accuracy: 53.58
Round  79, Train loss: 0.902, Test loss: 1.350, Test accuracy: 58.39
Round  79, Global train loss: 0.902, Global test loss: 1.537, Global test accuracy: 52.14
Round  80, Train loss: 0.778, Test loss: 1.345, Test accuracy: 58.27
Round  80, Global train loss: 0.778, Global test loss: 1.537, Global test accuracy: 52.60
Round  81, Train loss: 0.661, Test loss: 1.337, Test accuracy: 58.38
Round  81, Global train loss: 0.661, Global test loss: 1.375, Global test accuracy: 57.57
Round  82, Train loss: 0.918, Test loss: 1.342, Test accuracy: 58.68
Round  82, Global train loss: 0.918, Global test loss: 1.595, Global test accuracy: 52.36
Round  83, Train loss: 0.634, Test loss: 1.326, Test accuracy: 59.44
Round  83, Global train loss: 0.634, Global test loss: 1.428, Global test accuracy: 58.42
Round  84, Train loss: 0.669, Test loss: 1.332, Test accuracy: 59.45
Round  84, Global train loss: 0.669, Global test loss: 1.423, Global test accuracy: 56.92
Round  85, Train loss: 0.802, Test loss: 1.336, Test accuracy: 59.29
Round  85, Global train loss: 0.802, Global test loss: 1.520, Global test accuracy: 54.81
Round  86, Train loss: 0.780, Test loss: 1.348, Test accuracy: 59.60
Round  86, Global train loss: 0.780, Global test loss: 1.545, Global test accuracy: 53.29
Round  87, Train loss: 0.783, Test loss: 1.371, Test accuracy: 58.79
Round  87, Global train loss: 0.783, Global test loss: 1.563, Global test accuracy: 53.06
Round  88, Train loss: 0.771, Test loss: 1.376, Test accuracy: 58.73
Round  88, Global train loss: 0.771, Global test loss: 1.610, Global test accuracy: 53.56
Round  89, Train loss: 0.752, Test loss: 1.382, Test accuracy: 58.80
Round  89, Global train loss: 0.752, Global test loss: 1.441, Global test accuracy: 55.72
Round  90, Train loss: 0.663, Test loss: 1.411, Test accuracy: 58.33
Round  90, Global train loss: 0.663, Global test loss: 1.394, Global test accuracy: 57.48
Round  91, Train loss: 0.790, Test loss: 1.444, Test accuracy: 58.05
Round  91, Global train loss: 0.790, Global test loss: 1.585, Global test accuracy: 52.77
Round  92, Train loss: 0.776, Test loss: 1.436, Test accuracy: 58.41
Round  92, Global train loss: 0.776, Global test loss: 1.567, Global test accuracy: 52.76
Round  93, Train loss: 0.740, Test loss: 1.408, Test accuracy: 58.71
Round  93, Global train loss: 0.740, Global test loss: 1.463, Global test accuracy: 55.52
Round  94, Train loss: 0.703, Test loss: 1.456, Test accuracy: 57.77
Round  94, Global train loss: 0.703, Global test loss: 1.548, Global test accuracy: 53.33
Round  95, Train loss: 0.686, Test loss: 1.433, Test accuracy: 57.66
Round  95, Global train loss: 0.686, Global test loss: 1.473, Global test accuracy: 56.56
Round  96, Train loss: 0.800, Test loss: 1.425, Test accuracy: 58.46
Round  96, Global train loss: 0.800, Global test loss: 1.642, Global test accuracy: 51.39
Round  97, Train loss: 0.716, Test loss: 1.451, Test accuracy: 58.12
Round  97, Global train loss: 0.716, Global test loss: 1.444, Global test accuracy: 55.75
Round  98, Train loss: 0.610, Test loss: 1.455, Test accuracy: 57.90
Round  98, Global train loss: 0.610, Global test loss: 1.542, Global test accuracy: 54.88
Round  99, Train loss: 0.764, Test loss: 1.461, Test accuracy: 57.87
Round  99, Global train loss: 0.764, Global test loss: 1.608, Global test accuracy: 51.99
Final Round, Train loss: 0.541, Test loss: 1.670, Test accuracy: 57.62
Final Round, Global train loss: 0.541, Global test loss: 1.608, Global test accuracy: 51.99
Average accuracy final 10 rounds: 58.12583333333333 

Average global accuracy final 10 rounds: 54.24166666666666 

1670.9604778289795
[1.6369099617004395, 3.273819923400879, 4.629180192947388, 5.9845404624938965, 7.34778356552124, 8.711026668548584, 10.068545818328857, 11.42606496810913, 12.784335374832153, 14.142605781555176, 15.501259565353394, 16.85991334915161, 18.21929168701172, 19.578670024871826, 20.937108516693115, 22.295547008514404, 23.65315890312195, 25.010770797729492, 26.37564468383789, 27.74051856994629, 29.095686197280884, 30.45085382461548, 31.797313690185547, 33.143773555755615, 34.48715090751648, 35.830528259277344, 37.176209449768066, 38.52189064025879, 39.874194622039795, 41.2264986038208, 42.57129096984863, 43.916083335876465, 45.26464581489563, 46.613208293914795, 47.96311140060425, 49.3130145072937, 50.658310651779175, 52.00360679626465, 53.352017402648926, 54.7004280090332, 56.04479718208313, 57.38916635513306, 58.57189226150513, 59.7546181678772, 60.9373300075531, 62.120041847229004, 63.594844579696655, 65.0696473121643, 66.54917669296265, 68.02870607376099, 69.24747800827026, 70.46624994277954, 71.67676496505737, 72.8872799873352, 74.09906673431396, 75.31085348129272, 76.5218915939331, 77.73292970657349, 78.94414234161377, 80.15535497665405, 81.3649697303772, 82.57458448410034, 83.78300499916077, 84.99142551422119, 86.20182824134827, 87.41223096847534, 88.62405061721802, 89.8358702659607, 91.04522681236267, 92.25458335876465, 93.46299862861633, 94.67141389846802, 95.88438391685486, 97.0973539352417, 98.52357983589172, 99.94980573654175, 101.3797390460968, 102.80967235565186, 104.24366211891174, 105.67765188217163, 107.09879279136658, 108.51993370056152, 109.94651103019714, 111.37308835983276, 112.79602265357971, 114.21895694732666, 115.64783215522766, 117.07670736312866, 118.49101781845093, 119.9053282737732, 121.32590222358704, 122.74647617340088, 124.17740178108215, 125.60832738876343, 127.04228401184082, 128.4762406349182, 129.70079708099365, 130.9253535270691, 132.14651322364807, 133.36767292022705, 134.59319257736206, 135.81871223449707, 137.04452466964722, 138.27033710479736, 139.49353647232056, 140.71673583984375, 141.94100904464722, 143.16528224945068, 144.37647652626038, 145.58767080307007, 146.79923057556152, 148.01079034805298, 149.2322540283203, 150.45371770858765, 151.67426538467407, 152.8948130607605, 154.11193704605103, 155.32906103134155, 156.55133366584778, 157.773606300354, 158.99519062042236, 160.21677494049072, 161.43381237983704, 162.65084981918335, 163.87085366249084, 165.09085750579834, 166.31451439857483, 167.53817129135132, 168.749906539917, 169.96164178848267, 171.1717975139618, 172.38195323944092, 173.59728002548218, 174.81260681152344, 176.0362458229065, 177.25988483428955, 178.48187446594238, 179.70386409759521, 180.91658186912537, 182.12929964065552, 183.34444284439087, 184.55958604812622, 185.78414487838745, 187.00870370864868, 188.23215913772583, 189.45561456680298, 190.68329238891602, 191.91097021102905, 193.13714718818665, 194.36332416534424, 195.589293718338, 196.8152632713318, 198.03810000419617, 199.26093673706055, 200.48742985725403, 201.7139229774475, 202.9379162788391, 204.1619095802307, 205.37626695632935, 206.59062433242798, 207.8166470527649, 209.0426697731018, 210.2603404521942, 211.47801113128662, 212.69745135307312, 213.91689157485962, 215.13611388206482, 216.35533618927002, 217.5728738307953, 218.79041147232056, 220.00744366645813, 221.2244758605957, 222.440922498703, 223.6573691368103, 224.87002539634705, 226.0826816558838, 227.30477285385132, 228.52686405181885, 229.74802136421204, 230.96917867660522, 232.1886088848114, 233.40803909301758, 234.61945414543152, 235.83086919784546, 237.0440149307251, 238.25716066360474, 239.47123289108276, 240.6853051185608, 241.8956904411316, 243.1060757637024, 244.31724548339844, 245.52841520309448, 246.93195343017578, 248.33549165725708, 249.7481780052185, 251.16086435317993, 252.5642855167389, 253.96770668029785, 255.40754795074463, 256.8473892211914, 259.20539569854736, 261.5634021759033]
[24.341666666666665, 24.341666666666665, 32.7, 32.7, 35.49166666666667, 35.49166666666667, 38.208333333333336, 38.208333333333336, 42.28333333333333, 42.28333333333333, 46.30833333333333, 46.30833333333333, 49.075, 49.075, 48.94166666666667, 48.94166666666667, 50.90833333333333, 50.90833333333333, 51.68333333333333, 51.68333333333333, 52.675, 52.675, 52.9, 52.9, 54.125, 54.125, 55.175, 55.175, 55.75, 55.75, 55.93333333333333, 55.93333333333333, 56.775, 56.775, 56.9, 56.9, 57.31666666666667, 57.31666666666667, 59.016666666666666, 59.016666666666666, 59.708333333333336, 59.708333333333336, 59.333333333333336, 59.333333333333336, 59.36666666666667, 59.36666666666667, 59.766666666666666, 59.766666666666666, 60.291666666666664, 60.291666666666664, 60.74166666666667, 60.74166666666667, 61.34166666666667, 61.34166666666667, 60.65, 60.65, 60.63333333333333, 60.63333333333333, 61.15833333333333, 61.15833333333333, 61.56666666666667, 61.56666666666667, 61.575, 61.575, 61.43333333333333, 61.43333333333333, 61.416666666666664, 61.416666666666664, 61.11666666666667, 61.11666666666667, 61.05, 61.05, 61.35, 61.35, 61.425, 61.425, 61.86666666666667, 61.86666666666667, 61.6, 61.6, 61.56666666666667, 61.56666666666667, 60.858333333333334, 60.858333333333334, 60.50833333333333, 60.50833333333333, 61.0, 61.0, 60.541666666666664, 60.541666666666664, 59.86666666666667, 59.86666666666667, 59.675, 59.675, 60.416666666666664, 60.416666666666664, 60.483333333333334, 60.483333333333334, 60.65, 60.65, 60.325, 60.325, 60.55833333333333, 60.55833333333333, 60.475, 60.475, 60.75, 60.75, 61.11666666666667, 61.11666666666667, 60.916666666666664, 60.916666666666664, 59.983333333333334, 59.983333333333334, 60.55833333333333, 60.55833333333333, 60.45, 60.45, 59.375, 59.375, 59.516666666666666, 59.516666666666666, 59.391666666666666, 59.391666666666666, 59.583333333333336, 59.583333333333336, 59.391666666666666, 59.391666666666666, 59.19166666666667, 59.19166666666667, 58.80833333333333, 58.80833333333333, 58.9, 58.9, 58.90833333333333, 58.90833333333333, 58.30833333333333, 58.30833333333333, 58.475, 58.475, 58.99166666666667, 58.99166666666667, 59.38333333333333, 59.38333333333333, 59.108333333333334, 59.108333333333334, 59.641666666666666, 59.641666666666666, 59.65, 59.65, 58.575, 58.575, 58.86666666666667, 58.86666666666667, 59.075, 59.075, 58.791666666666664, 58.791666666666664, 58.391666666666666, 58.391666666666666, 58.266666666666666, 58.266666666666666, 58.375, 58.375, 58.68333333333333, 58.68333333333333, 59.44166666666667, 59.44166666666667, 59.45, 59.45, 59.291666666666664, 59.291666666666664, 59.6, 59.6, 58.791666666666664, 58.791666666666664, 58.733333333333334, 58.733333333333334, 58.8, 58.8, 58.325, 58.325, 58.05, 58.05, 58.40833333333333, 58.40833333333333, 58.708333333333336, 58.708333333333336, 57.766666666666666, 57.766666666666666, 57.65833333333333, 57.65833333333333, 58.458333333333336, 58.458333333333336, 58.11666666666667, 58.11666666666667, 57.9, 57.9, 57.86666666666667, 57.86666666666667, 57.625, 57.625]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.796, Test loss: 2.046, Test accuracy: 21.80
Round   0, Global train loss: 1.796, Global test loss: 2.199, Global test accuracy: 19.48
Round   1, Train loss: 1.696, Test loss: 1.821, Test accuracy: 29.13
Round   1, Global train loss: 1.696, Global test loss: 2.082, Global test accuracy: 24.57
Round   2, Train loss: 1.651, Test loss: 1.690, Test accuracy: 32.81
Round   2, Global train loss: 1.651, Global test loss: 1.951, Global test accuracy: 24.77
Round   3, Train loss: 1.571, Test loss: 1.654, Test accuracy: 37.01
Round   3, Global train loss: 1.571, Global test loss: 1.919, Global test accuracy: 30.24
Round   4, Train loss: 1.698, Test loss: 1.556, Test accuracy: 40.81
Round   4, Global train loss: 1.698, Global test loss: 1.855, Global test accuracy: 34.64
Round   5, Train loss: 1.646, Test loss: 1.453, Test accuracy: 44.83
Round   5, Global train loss: 1.646, Global test loss: 1.832, Global test accuracy: 32.46
Round   6, Train loss: 1.458, Test loss: 1.428, Test accuracy: 46.41
Round   6, Global train loss: 1.458, Global test loss: 1.691, Global test accuracy: 39.98
Round   7, Train loss: 1.492, Test loss: 1.407, Test accuracy: 47.53
Round   7, Global train loss: 1.492, Global test loss: 1.725, Global test accuracy: 37.14
Round   8, Train loss: 1.608, Test loss: 1.339, Test accuracy: 50.21
Round   8, Global train loss: 1.608, Global test loss: 1.743, Global test accuracy: 41.78
Round   9, Train loss: 1.443, Test loss: 1.329, Test accuracy: 51.57
Round   9, Global train loss: 1.443, Global test loss: 1.584, Global test accuracy: 45.54
Round  10, Train loss: 1.462, Test loss: 1.309, Test accuracy: 52.76
Round  10, Global train loss: 1.462, Global test loss: 1.551, Global test accuracy: 46.23
Round  11, Train loss: 1.278, Test loss: 1.279, Test accuracy: 53.90
Round  11, Global train loss: 1.278, Global test loss: 1.532, Global test accuracy: 45.28
Round  12, Train loss: 1.417, Test loss: 1.291, Test accuracy: 53.67
Round  12, Global train loss: 1.417, Global test loss: 1.608, Global test accuracy: 42.93
Round  13, Train loss: 1.465, Test loss: 1.285, Test accuracy: 54.02
Round  13, Global train loss: 1.465, Global test loss: 1.630, Global test accuracy: 42.00
Round  14, Train loss: 1.578, Test loss: 1.278, Test accuracy: 54.01
Round  14, Global train loss: 1.578, Global test loss: 1.612, Global test accuracy: 45.48
Round  15, Train loss: 1.438, Test loss: 1.257, Test accuracy: 55.13
Round  15, Global train loss: 1.438, Global test loss: 1.577, Global test accuracy: 45.91
Round  16, Train loss: 1.464, Test loss: 1.254, Test accuracy: 55.51
Round  16, Global train loss: 1.464, Global test loss: 1.573, Global test accuracy: 47.33
Round  17, Train loss: 1.462, Test loss: 1.241, Test accuracy: 55.88
Round  17, Global train loss: 1.462, Global test loss: 1.629, Global test accuracy: 43.08
Round  18, Train loss: 1.377, Test loss: 1.233, Test accuracy: 56.29
Round  18, Global train loss: 1.377, Global test loss: 1.512, Global test accuracy: 50.58
Round  19, Train loss: 1.193, Test loss: 1.218, Test accuracy: 56.79
Round  19, Global train loss: 1.193, Global test loss: 1.432, Global test accuracy: 49.05
Round  20, Train loss: 1.440, Test loss: 1.190, Test accuracy: 58.01
Round  20, Global train loss: 1.440, Global test loss: 1.439, Global test accuracy: 51.06
Round  21, Train loss: 1.344, Test loss: 1.185, Test accuracy: 57.98
Round  21, Global train loss: 1.344, Global test loss: 1.428, Global test accuracy: 52.02
Round  22, Train loss: 1.327, Test loss: 1.192, Test accuracy: 57.59
Round  22, Global train loss: 1.327, Global test loss: 1.395, Global test accuracy: 54.25
Round  23, Train loss: 1.376, Test loss: 1.178, Test accuracy: 58.19
Round  23, Global train loss: 1.376, Global test loss: 1.439, Global test accuracy: 53.52
Round  24, Train loss: 1.333, Test loss: 1.170, Test accuracy: 58.73
Round  24, Global train loss: 1.333, Global test loss: 1.452, Global test accuracy: 50.97
Round  25, Train loss: 1.353, Test loss: 1.152, Test accuracy: 59.38
Round  25, Global train loss: 1.353, Global test loss: 1.447, Global test accuracy: 52.82
Round  26, Train loss: 1.121, Test loss: 1.144, Test accuracy: 60.08
Round  26, Global train loss: 1.121, Global test loss: 1.357, Global test accuracy: 53.51
Round  27, Train loss: 1.196, Test loss: 1.130, Test accuracy: 60.75
Round  27, Global train loss: 1.196, Global test loss: 1.488, Global test accuracy: 49.37
Round  28, Train loss: 1.383, Test loss: 1.127, Test accuracy: 60.55
Round  28, Global train loss: 1.383, Global test loss: 1.453, Global test accuracy: 51.99
Round  29, Train loss: 1.555, Test loss: 1.123, Test accuracy: 60.75
Round  29, Global train loss: 1.555, Global test loss: 1.520, Global test accuracy: 51.92
Round  30, Train loss: 1.420, Test loss: 1.132, Test accuracy: 61.12
Round  30, Global train loss: 1.420, Global test loss: 1.511, Global test accuracy: 52.93
Round  31, Train loss: 1.375, Test loss: 1.142, Test accuracy: 60.95
Round  31, Global train loss: 1.375, Global test loss: 1.450, Global test accuracy: 53.68
Round  32, Train loss: 1.113, Test loss: 1.157, Test accuracy: 60.60
Round  32, Global train loss: 1.113, Global test loss: 1.337, Global test accuracy: 55.45
Round  33, Train loss: 1.233, Test loss: 1.139, Test accuracy: 60.87
Round  33, Global train loss: 1.233, Global test loss: 1.413, Global test accuracy: 50.42
Round  34, Train loss: 1.189, Test loss: 1.138, Test accuracy: 60.51
Round  34, Global train loss: 1.189, Global test loss: 1.371, Global test accuracy: 53.40
Round  35, Train loss: 1.256, Test loss: 1.138, Test accuracy: 60.11
Round  35, Global train loss: 1.256, Global test loss: 1.335, Global test accuracy: 56.28
Round  36, Train loss: 1.270, Test loss: 1.124, Test accuracy: 60.42
Round  36, Global train loss: 1.270, Global test loss: 1.361, Global test accuracy: 56.26
Round  37, Train loss: 1.205, Test loss: 1.118, Test accuracy: 60.67
Round  37, Global train loss: 1.205, Global test loss: 1.353, Global test accuracy: 55.50
Round  38, Train loss: 1.410, Test loss: 1.101, Test accuracy: 61.17
Round  38, Global train loss: 1.410, Global test loss: 1.426, Global test accuracy: 54.92
Round  39, Train loss: 1.334, Test loss: 1.115, Test accuracy: 60.60
Round  39, Global train loss: 1.334, Global test loss: 1.488, Global test accuracy: 53.54
Round  40, Train loss: 1.168, Test loss: 1.122, Test accuracy: 60.81
Round  40, Global train loss: 1.168, Global test loss: 1.352, Global test accuracy: 55.09
Round  41, Train loss: 0.995, Test loss: 1.129, Test accuracy: 60.48
Round  41, Global train loss: 0.995, Global test loss: 1.421, Global test accuracy: 53.01
Round  42, Train loss: 1.117, Test loss: 1.134, Test accuracy: 60.62
Round  42, Global train loss: 1.117, Global test loss: 1.295, Global test accuracy: 56.85
Round  43, Train loss: 1.093, Test loss: 1.119, Test accuracy: 60.72
Round  43, Global train loss: 1.093, Global test loss: 1.340, Global test accuracy: 55.72
Round  44, Train loss: 1.046, Test loss: 1.137, Test accuracy: 60.53
Round  44, Global train loss: 1.046, Global test loss: 1.348, Global test accuracy: 55.38
Round  45, Train loss: 1.065, Test loss: 1.122, Test accuracy: 60.73
Round  45, Global train loss: 1.065, Global test loss: 1.312, Global test accuracy: 55.80
Round  46, Train loss: 1.258, Test loss: 1.123, Test accuracy: 60.57
Round  46, Global train loss: 1.258, Global test loss: 1.310, Global test accuracy: 57.17
Round  47, Train loss: 1.400, Test loss: 1.113, Test accuracy: 60.69
Round  47, Global train loss: 1.400, Global test loss: 1.514, Global test accuracy: 52.70
Round  48, Train loss: 1.104, Test loss: 1.146, Test accuracy: 59.67
Round  48, Global train loss: 1.104, Global test loss: 1.335, Global test accuracy: 55.94
Round  49, Train loss: 1.126, Test loss: 1.148, Test accuracy: 60.02
Round  49, Global train loss: 1.126, Global test loss: 1.349, Global test accuracy: 54.76
Round  50, Train loss: 1.243, Test loss: 1.145, Test accuracy: 60.62
Round  50, Global train loss: 1.243, Global test loss: 1.434, Global test accuracy: 52.92
Round  51, Train loss: 0.941, Test loss: 1.140, Test accuracy: 60.73
Round  51, Global train loss: 0.941, Global test loss: 1.338, Global test accuracy: 55.95
Round  52, Train loss: 1.011, Test loss: 1.142, Test accuracy: 60.57
Round  52, Global train loss: 1.011, Global test loss: 1.344, Global test accuracy: 56.56
Round  53, Train loss: 1.075, Test loss: 1.145, Test accuracy: 60.81
Round  53, Global train loss: 1.075, Global test loss: 1.282, Global test accuracy: 58.58
Round  54, Train loss: 0.925, Test loss: 1.137, Test accuracy: 61.06
Round  54, Global train loss: 0.925, Global test loss: 1.241, Global test accuracy: 58.88
Round  55, Train loss: 1.222, Test loss: 1.154, Test accuracy: 60.20
Round  55, Global train loss: 1.222, Global test loss: 1.378, Global test accuracy: 55.49
Round  56, Train loss: 0.887, Test loss: 1.159, Test accuracy: 60.26
Round  56, Global train loss: 0.887, Global test loss: 1.242, Global test accuracy: 59.02
Round  57, Train loss: 1.110, Test loss: 1.151, Test accuracy: 60.38
Round  57, Global train loss: 1.110, Global test loss: 1.312, Global test accuracy: 57.82
Round  58, Train loss: 0.933, Test loss: 1.125, Test accuracy: 61.34
Round  58, Global train loss: 0.933, Global test loss: 1.207, Global test accuracy: 59.77
Round  59, Train loss: 0.937, Test loss: 1.150, Test accuracy: 60.62
Round  59, Global train loss: 0.937, Global test loss: 1.331, Global test accuracy: 56.88
Round  60, Train loss: 0.965, Test loss: 1.161, Test accuracy: 60.52
Round  60, Global train loss: 0.965, Global test loss: 1.378, Global test accuracy: 54.86
Round  61, Train loss: 1.189, Test loss: 1.160, Test accuracy: 60.24
Round  61, Global train loss: 1.189, Global test loss: 1.434, Global test accuracy: 54.20
Round  62, Train loss: 0.916, Test loss: 1.157, Test accuracy: 61.15
Round  62, Global train loss: 0.916, Global test loss: 1.333, Global test accuracy: 56.18
Round  63, Train loss: 1.168, Test loss: 1.164, Test accuracy: 60.64
Round  63, Global train loss: 1.168, Global test loss: 1.365, Global test accuracy: 56.55
Round  64, Train loss: 0.966, Test loss: 1.180, Test accuracy: 60.40
Round  64, Global train loss: 0.966, Global test loss: 1.373, Global test accuracy: 55.90
Round  65, Train loss: 0.995, Test loss: 1.182, Test accuracy: 60.02
Round  65, Global train loss: 0.995, Global test loss: 1.400, Global test accuracy: 56.90
Round  66, Train loss: 1.036, Test loss: 1.177, Test accuracy: 60.12
Round  66, Global train loss: 1.036, Global test loss: 1.342, Global test accuracy: 56.95
Round  67, Train loss: 0.942, Test loss: 1.161, Test accuracy: 60.76
Round  67, Global train loss: 0.942, Global test loss: 1.281, Global test accuracy: 57.99
Round  68, Train loss: 0.963, Test loss: 1.155, Test accuracy: 61.02
Round  68, Global train loss: 0.963, Global test loss: 1.356, Global test accuracy: 56.37
Round  69, Train loss: 0.830, Test loss: 1.181, Test accuracy: 60.39
Round  69, Global train loss: 0.830, Global test loss: 1.251, Global test accuracy: 59.21
Round  70, Train loss: 0.917, Test loss: 1.188, Test accuracy: 60.37
Round  70, Global train loss: 0.917, Global test loss: 1.294, Global test accuracy: 58.22
Round  71, Train loss: 0.956, Test loss: 1.193, Test accuracy: 60.08
Round  71, Global train loss: 0.956, Global test loss: 1.331, Global test accuracy: 57.02
Round  72, Train loss: 0.886, Test loss: 1.200, Test accuracy: 59.84
Round  72, Global train loss: 0.886, Global test loss: 1.272, Global test accuracy: 57.68
Round  73, Train loss: 0.915, Test loss: 1.211, Test accuracy: 59.89
Round  73, Global train loss: 0.915, Global test loss: 1.381, Global test accuracy: 56.67
Round  74, Train loss: 0.921, Test loss: 1.224, Test accuracy: 59.42
Round  74, Global train loss: 0.921, Global test loss: 1.297, Global test accuracy: 58.79
Round  75, Train loss: 0.922, Test loss: 1.226, Test accuracy: 59.63
Round  75, Global train loss: 0.922, Global test loss: 1.364, Global test accuracy: 58.08
Round  76, Train loss: 0.931, Test loss: 1.216, Test accuracy: 60.20
Round  76, Global train loss: 0.931, Global test loss: 1.273, Global test accuracy: 58.39
Round  77, Train loss: 0.752, Test loss: 1.217, Test accuracy: 60.04
Round  77, Global train loss: 0.752, Global test loss: 1.326, Global test accuracy: 58.14
Round  78, Train loss: 0.885, Test loss: 1.230, Test accuracy: 59.88
Round  78, Global train loss: 0.885, Global test loss: 1.399, Global test accuracy: 56.83
Round  79, Train loss: 0.917, Test loss: 1.246, Test accuracy: 58.94
Round  79, Global train loss: 0.917, Global test loss: 1.346, Global test accuracy: 57.77
Round  80, Train loss: 0.871, Test loss: 1.236, Test accuracy: 59.13
Round  80, Global train loss: 0.871, Global test loss: 1.424, Global test accuracy: 54.02
Round  81, Train loss: 0.827, Test loss: 1.226, Test accuracy: 59.81
Round  81, Global train loss: 0.827, Global test loss: 1.356, Global test accuracy: 56.88
Round  82, Train loss: 0.967, Test loss: 1.258, Test accuracy: 59.42
Round  82, Global train loss: 0.967, Global test loss: 1.379, Global test accuracy: 56.45
Round  83, Train loss: 0.829, Test loss: 1.256, Test accuracy: 59.82
Round  83, Global train loss: 0.829, Global test loss: 1.379, Global test accuracy: 57.66
Round  84, Train loss: 0.698, Test loss: 1.262, Test accuracy: 59.75
Round  84, Global train loss: 0.698, Global test loss: 1.350, Global test accuracy: 57.88
Round  85, Train loss: 0.815, Test loss: 1.254, Test accuracy: 59.91
Round  85, Global train loss: 0.815, Global test loss: 1.356, Global test accuracy: 58.07
Round  86, Train loss: 1.025, Test loss: 1.239, Test accuracy: 60.27
Round  86, Global train loss: 1.025, Global test loss: 1.415, Global test accuracy: 54.22
Round  87, Train loss: 0.876, Test loss: 1.241, Test accuracy: 59.62
Round  87, Global train loss: 0.876, Global test loss: 1.430, Global test accuracy: 55.17
Round  88, Train loss: 0.763, Test loss: 1.235, Test accuracy: 60.26
Round  88, Global train loss: 0.763, Global test loss: 1.484, Global test accuracy: 56.20
Round  89, Train loss: 0.792, Test loss: 1.263, Test accuracy: 59.83
Round  89, Global train loss: 0.792, Global test loss: 1.298, Global test accuracy: 59.10
Round  90, Train loss: 0.602, Test loss: 1.284, Test accuracy: 59.48
Round  90, Global train loss: 0.602, Global test loss: 1.282, Global test accuracy: 60.74
Round  91, Train loss: 0.848, Test loss: 1.285, Test accuracy: 59.23
Round  91, Global train loss: 0.848, Global test loss: 1.428, Global test accuracy: 54.97
Round  92, Train loss: 0.819, Test loss: 1.279, Test accuracy: 58.79
Round  92, Global train loss: 0.819, Global test loss: 1.470, Global test accuracy: 53.72
Round  93, Train loss: 0.852, Test loss: 1.310, Test accuracy: 58.33
Round  93, Global train loss: 0.852, Global test loss: 1.311, Global test accuracy: 58.67
Round  94, Train loss: 0.740, Test loss: 1.306, Test accuracy: 58.82
Round  94, Global train loss: 0.740, Global test loss: 1.424, Global test accuracy: 56.95
Round  95, Train loss: 0.694, Test loss: 1.298, Test accuracy: 59.38
Round  95, Global train loss: 0.694, Global test loss: 1.434, Global test accuracy: 57.74
Round  96, Train loss: 0.993, Test loss: 1.298, Test accuracy: 59.16
Round  96, Global train loss: 0.993, Global test loss: 1.530, Global test accuracy: 52.00
Round  97, Train loss: 0.956, Test loss: 1.296, Test accuracy: 59.63
Round  97, Global train loss: 0.956, Global test loss: 1.465, Global test accuracy: 54.23
Round  98, Train loss: 0.614, Test loss: 1.298, Test accuracy: 59.36
Round  98, Global train loss: 0.614, Global test loss: 1.425, Global test accuracy: 56.83
Round  99, Train loss: 0.756, Test loss: 1.302, Test accuracy: 59.73
Round  99, Global train loss: 0.756, Global test loss: 1.403, Global test accuracy: 57.27
Final Round, Train loss: 0.666, Test loss: 1.450, Test accuracy: 58.05
Final Round, Global train loss: 0.666, Global test loss: 1.403, Global test accuracy: 57.27
Average accuracy final 10 rounds: 59.19 

Average global accuracy final 10 rounds: 56.31166666666667 

1719.8320002555847
[1.733292818069458, 3.466585636138916, 4.968245506286621, 6.469905376434326, 7.972032070159912, 9.474158763885498, 10.976147651672363, 12.478136539459229, 13.984252214431763, 15.490367889404297, 16.813997983932495, 18.137628078460693, 19.44833731651306, 20.75904655456543, 22.068849802017212, 23.378653049468994, 24.68800926208496, 25.997365474700928, 27.312678337097168, 28.627991199493408, 29.935895681381226, 31.243800163269043, 32.55492639541626, 33.86605262756348, 35.17592096328735, 36.48578929901123, 37.79330229759216, 39.100815296173096, 40.40879511833191, 41.71677494049072, 43.026750564575195, 44.33672618865967, 45.64663124084473, 46.956536293029785, 48.2661657333374, 49.57579517364502, 50.88599133491516, 52.1961874961853, 53.50843358039856, 54.820679664611816, 56.132166385650635, 57.44365310668945, 58.7525372505188, 60.061421394348145, 61.368624448776245, 62.675827503204346, 63.98664355278015, 65.29745960235596, 66.61104655265808, 67.9246335029602, 69.23151087760925, 70.5383882522583, 71.84422969818115, 73.150071144104, 74.46474647521973, 75.77942180633545, 77.08772277832031, 78.39602375030518, 79.70141744613647, 81.00681114196777, 82.31479954719543, 83.6227879524231, 84.93039751052856, 86.23800706863403, 87.54400753974915, 88.85000801086426, 90.16287612915039, 91.47574424743652, 92.9753258228302, 94.47490739822388, 95.97527718544006, 97.47564697265625, 98.97874975204468, 100.4818525314331, 101.9416618347168, 103.40147113800049, 104.71161413192749, 106.02175712585449, 107.33346343040466, 108.64516973495483, 109.95476484298706, 111.26435995101929, 112.57350087165833, 113.88264179229736, 115.1907811164856, 116.49892044067383, 117.80883622169495, 119.11875200271606, 120.42597198486328, 121.7331919670105, 123.04283428192139, 124.35247659683228, 125.65943360328674, 126.96639060974121, 128.28067469596863, 129.59495878219604, 130.90744400024414, 132.21992921829224, 133.53160691261292, 134.8432846069336, 136.15235710144043, 137.46142959594727, 138.96133589744568, 140.4612421989441, 141.9639286994934, 143.46661520004272, 144.9685263633728, 146.47043752670288, 147.97388458251953, 149.47733163833618, 150.9837465286255, 152.4901614189148, 153.9987404346466, 155.50731945037842, 157.0144944190979, 158.52166938781738, 160.027086019516, 161.5325026512146, 163.03709435462952, 164.54168605804443, 166.04594922065735, 167.55021238327026, 169.05312061309814, 170.55602884292603, 172.0609269142151, 173.56582498550415, 175.06745743751526, 176.56908988952637, 178.07728934288025, 179.58548879623413, 180.9469609260559, 182.30843305587769, 183.61890578269958, 184.92937850952148, 186.2403826713562, 187.55138683319092, 188.8716061115265, 190.19182538986206, 191.5118989944458, 192.83197259902954, 194.15265202522278, 195.47333145141602, 196.7939260005951, 198.11452054977417, 199.42546129226685, 200.73640203475952, 202.04796981811523, 203.35953760147095, 204.67140769958496, 205.98327779769897, 207.30399107933044, 208.6247043609619, 209.948077917099, 211.27145147323608, 212.59478855133057, 213.91812562942505, 215.23807191848755, 216.55801820755005, 217.87647914886475, 219.19494009017944, 220.51716327667236, 221.83938646316528, 223.15126872062683, 224.46315097808838, 225.81625628471375, 227.1693615913391, 228.47973251342773, 229.79010343551636, 231.10191297531128, 232.4137225151062, 233.73403525352478, 235.05434799194336, 236.38167881965637, 237.70900964736938, 239.03377151489258, 240.35853338241577, 241.68150401115417, 243.00447463989258, 244.3278923034668, 245.65130996704102, 246.97335004806519, 248.29539012908936, 249.60484218597412, 250.9142942428589, 252.22322058677673, 253.53214693069458, 254.84416508674622, 256.15618324279785, 257.47474694252014, 258.79331064224243, 260.11428809165955, 261.43526554107666, 262.75894832611084, 264.082631111145, 265.39535331726074, 266.70807552337646, 268.02564430236816, 269.34321308135986, 270.6664786338806, 271.98974418640137, 274.19226908683777, 276.39479398727417]
[21.8, 21.8, 29.133333333333333, 29.133333333333333, 32.80833333333333, 32.80833333333333, 37.00833333333333, 37.00833333333333, 40.80833333333333, 40.80833333333333, 44.833333333333336, 44.833333333333336, 46.40833333333333, 46.40833333333333, 47.53333333333333, 47.53333333333333, 50.208333333333336, 50.208333333333336, 51.56666666666667, 51.56666666666667, 52.75833333333333, 52.75833333333333, 53.9, 53.9, 53.666666666666664, 53.666666666666664, 54.025, 54.025, 54.00833333333333, 54.00833333333333, 55.13333333333333, 55.13333333333333, 55.50833333333333, 55.50833333333333, 55.875, 55.875, 56.291666666666664, 56.291666666666664, 56.791666666666664, 56.791666666666664, 58.00833333333333, 58.00833333333333, 57.983333333333334, 57.983333333333334, 57.59166666666667, 57.59166666666667, 58.19166666666667, 58.19166666666667, 58.733333333333334, 58.733333333333334, 59.38333333333333, 59.38333333333333, 60.075, 60.075, 60.75, 60.75, 60.55, 60.55, 60.75, 60.75, 61.125, 61.125, 60.95, 60.95, 60.6, 60.6, 60.86666666666667, 60.86666666666667, 60.50833333333333, 60.50833333333333, 60.108333333333334, 60.108333333333334, 60.416666666666664, 60.416666666666664, 60.675, 60.675, 61.175, 61.175, 60.6, 60.6, 60.80833333333333, 60.80833333333333, 60.483333333333334, 60.483333333333334, 60.61666666666667, 60.61666666666667, 60.71666666666667, 60.71666666666667, 60.53333333333333, 60.53333333333333, 60.733333333333334, 60.733333333333334, 60.56666666666667, 60.56666666666667, 60.69166666666667, 60.69166666666667, 59.666666666666664, 59.666666666666664, 60.025, 60.025, 60.61666666666667, 60.61666666666667, 60.733333333333334, 60.733333333333334, 60.56666666666667, 60.56666666666667, 60.80833333333333, 60.80833333333333, 61.05833333333333, 61.05833333333333, 60.2, 60.2, 60.25833333333333, 60.25833333333333, 60.375, 60.375, 61.34166666666667, 61.34166666666667, 60.625, 60.625, 60.525, 60.525, 60.24166666666667, 60.24166666666667, 61.15, 61.15, 60.641666666666666, 60.641666666666666, 60.4, 60.4, 60.016666666666666, 60.016666666666666, 60.11666666666667, 60.11666666666667, 60.75833333333333, 60.75833333333333, 61.016666666666666, 61.016666666666666, 60.391666666666666, 60.391666666666666, 60.36666666666667, 60.36666666666667, 60.083333333333336, 60.083333333333336, 59.84166666666667, 59.84166666666667, 59.891666666666666, 59.891666666666666, 59.425, 59.425, 59.63333333333333, 59.63333333333333, 60.2, 60.2, 60.041666666666664, 60.041666666666664, 59.875, 59.875, 58.94166666666667, 58.94166666666667, 59.13333333333333, 59.13333333333333, 59.80833333333333, 59.80833333333333, 59.425, 59.425, 59.81666666666667, 59.81666666666667, 59.75, 59.75, 59.90833333333333, 59.90833333333333, 60.266666666666666, 60.266666666666666, 59.625, 59.625, 60.25833333333333, 60.25833333333333, 59.833333333333336, 59.833333333333336, 59.483333333333334, 59.483333333333334, 59.233333333333334, 59.233333333333334, 58.791666666666664, 58.791666666666664, 58.325, 58.325, 58.81666666666667, 58.81666666666667, 59.375, 59.375, 59.15833333333333, 59.15833333333333, 59.63333333333333, 59.63333333333333, 59.358333333333334, 59.358333333333334, 59.725, 59.725, 58.05, 58.05]/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.803, Test loss: 2.067, Test accuracy: 22.99
Round   0, Global train loss: 1.803, Global test loss: 2.213, Global test accuracy: 20.62
Round   1, Train loss: 1.695, Test loss: 1.871, Test accuracy: 27.74
Round   1, Global train loss: 1.695, Global test loss: 2.145, Global test accuracy: 20.17
Round   2, Train loss: 1.620, Test loss: 1.743, Test accuracy: 33.21
Round   2, Global train loss: 1.620, Global test loss: 1.993, Global test accuracy: 27.45
Round   3, Train loss: 1.628, Test loss: 1.705, Test accuracy: 36.41
Round   3, Global train loss: 1.628, Global test loss: 1.991, Global test accuracy: 30.89
Round   4, Train loss: 1.586, Test loss: 1.590, Test accuracy: 39.35
Round   4, Global train loss: 1.586, Global test loss: 1.915, Global test accuracy: 32.40
Round   5, Train loss: 1.529, Test loss: 1.504, Test accuracy: 42.56
Round   5, Global train loss: 1.529, Global test loss: 1.925, Global test accuracy: 30.49
Round   6, Train loss: 1.544, Test loss: 1.450, Test accuracy: 45.25
Round   6, Global train loss: 1.544, Global test loss: 1.856, Global test accuracy: 34.57
Round   7, Train loss: 1.468, Test loss: 1.444, Test accuracy: 46.22
Round   7, Global train loss: 1.468, Global test loss: 1.872, Global test accuracy: 33.03
Round   8, Train loss: 1.381, Test loss: 1.365, Test accuracy: 49.40
Round   8, Global train loss: 1.381, Global test loss: 1.769, Global test accuracy: 42.40
Round   9, Train loss: 1.345, Test loss: 1.346, Test accuracy: 50.37
Round   9, Global train loss: 1.345, Global test loss: 1.692, Global test accuracy: 43.09
Round  10, Train loss: 1.452, Test loss: 1.340, Test accuracy: 51.26
Round  10, Global train loss: 1.452, Global test loss: 1.645, Global test accuracy: 44.77
Round  11, Train loss: 1.451, Test loss: 1.324, Test accuracy: 51.88
Round  11, Global train loss: 1.451, Global test loss: 1.708, Global test accuracy: 42.54
Round  12, Train loss: 1.291, Test loss: 1.318, Test accuracy: 52.51
Round  12, Global train loss: 1.291, Global test loss: 1.833, Global test accuracy: 38.00
Round  13, Train loss: 1.312, Test loss: 1.323, Test accuracy: 52.39
Round  13, Global train loss: 1.312, Global test loss: 1.744, Global test accuracy: 43.34
Round  14, Train loss: 1.376, Test loss: 1.321, Test accuracy: 53.23
Round  14, Global train loss: 1.376, Global test loss: 1.665, Global test accuracy: 43.10
Round  15, Train loss: 1.195, Test loss: 1.316, Test accuracy: 53.70
Round  15, Global train loss: 1.195, Global test loss: 1.708, Global test accuracy: 43.20
Round  16, Train loss: 1.262, Test loss: 1.315, Test accuracy: 53.94
Round  16, Global train loss: 1.262, Global test loss: 1.678, Global test accuracy: 42.79
Round  17, Train loss: 1.343, Test loss: 1.323, Test accuracy: 53.56
Round  17, Global train loss: 1.343, Global test loss: 1.645, Global test accuracy: 44.41
Round  18, Train loss: 1.147, Test loss: 1.311, Test accuracy: 53.98
Round  18, Global train loss: 1.147, Global test loss: 1.616, Global test accuracy: 47.67
Round  19, Train loss: 1.093, Test loss: 1.300, Test accuracy: 55.05
Round  19, Global train loss: 1.093, Global test loss: 1.548, Global test accuracy: 48.33
Round  20, Train loss: 1.255, Test loss: 1.269, Test accuracy: 56.23
Round  20, Global train loss: 1.255, Global test loss: 1.468, Global test accuracy: 52.48
Round  21, Train loss: 1.231, Test loss: 1.256, Test accuracy: 56.71
Round  21, Global train loss: 1.231, Global test loss: 1.536, Global test accuracy: 51.40
Round  22, Train loss: 1.315, Test loss: 1.260, Test accuracy: 56.85
Round  22, Global train loss: 1.315, Global test loss: 1.506, Global test accuracy: 52.88
Round  23, Train loss: 1.354, Test loss: 1.235, Test accuracy: 57.86
Round  23, Global train loss: 1.354, Global test loss: 1.548, Global test accuracy: 52.98
Round  24, Train loss: 1.278, Test loss: 1.239, Test accuracy: 57.58
Round  24, Global train loss: 1.278, Global test loss: 1.615, Global test accuracy: 48.21
Round  25, Train loss: 1.240, Test loss: 1.231, Test accuracy: 57.78
Round  25, Global train loss: 1.240, Global test loss: 1.576, Global test accuracy: 50.38
Round  26, Train loss: 1.186, Test loss: 1.251, Test accuracy: 57.50
Round  26, Global train loss: 1.186, Global test loss: 1.544, Global test accuracy: 52.40
Round  27, Train loss: 1.104, Test loss: 1.231, Test accuracy: 58.06
Round  27, Global train loss: 1.104, Global test loss: 1.558, Global test accuracy: 49.59
Round  28, Train loss: 1.179, Test loss: 1.232, Test accuracy: 57.87
Round  28, Global train loss: 1.179, Global test loss: 1.579, Global test accuracy: 47.73
Round  29, Train loss: 1.145, Test loss: 1.209, Test accuracy: 58.62
Round  29, Global train loss: 1.145, Global test loss: 1.477, Global test accuracy: 52.05
Round  30, Train loss: 1.369, Test loss: 1.218, Test accuracy: 58.59
Round  30, Global train loss: 1.369, Global test loss: 1.669, Global test accuracy: 48.13
Round  31, Train loss: 1.083, Test loss: 1.205, Test accuracy: 59.39
Round  31, Global train loss: 1.083, Global test loss: 1.471, Global test accuracy: 53.97
Round  32, Train loss: 1.153, Test loss: 1.206, Test accuracy: 59.42
Round  32, Global train loss: 1.153, Global test loss: 1.516, Global test accuracy: 52.63
Round  33, Train loss: 1.080, Test loss: 1.247, Test accuracy: 58.04
Round  33, Global train loss: 1.080, Global test loss: 1.491, Global test accuracy: 52.52
Round  34, Train loss: 1.188, Test loss: 1.276, Test accuracy: 57.53
Round  34, Global train loss: 1.188, Global test loss: 1.669, Global test accuracy: 48.16
Round  35, Train loss: 0.965, Test loss: 1.275, Test accuracy: 57.81
Round  35, Global train loss: 0.965, Global test loss: 1.381, Global test accuracy: 56.63
Round  36, Train loss: 1.081, Test loss: 1.251, Test accuracy: 58.56
Round  36, Global train loss: 1.081, Global test loss: 1.493, Global test accuracy: 54.25
Round  37, Train loss: 1.227, Test loss: 1.239, Test accuracy: 58.62
Round  37, Global train loss: 1.227, Global test loss: 1.527, Global test accuracy: 53.48
Round  38, Train loss: 0.944, Test loss: 1.231, Test accuracy: 58.79
Round  38, Global train loss: 0.944, Global test loss: 1.495, Global test accuracy: 54.42
Round  39, Train loss: 1.076, Test loss: 1.239, Test accuracy: 58.84
Round  39, Global train loss: 1.076, Global test loss: 1.655, Global test accuracy: 51.17
Round  40, Train loss: 0.894, Test loss: 1.239, Test accuracy: 58.79
Round  40, Global train loss: 0.894, Global test loss: 1.438, Global test accuracy: 53.40
Round  41, Train loss: 0.962, Test loss: 1.247, Test accuracy: 58.87
Round  41, Global train loss: 0.962, Global test loss: 1.599, Global test accuracy: 50.34
Round  42, Train loss: 1.096, Test loss: 1.265, Test accuracy: 58.33
Round  42, Global train loss: 1.096, Global test loss: 1.414, Global test accuracy: 55.98
Round  43, Train loss: 1.039, Test loss: 1.252, Test accuracy: 58.46
Round  43, Global train loss: 1.039, Global test loss: 1.585, Global test accuracy: 54.08
Round  44, Train loss: 1.080, Test loss: 1.239, Test accuracy: 58.76
Round  44, Global train loss: 1.080, Global test loss: 1.571, Global test accuracy: 52.66
Round  45, Train loss: 0.972, Test loss: 1.229, Test accuracy: 58.94
Round  45, Global train loss: 0.972, Global test loss: 1.401, Global test accuracy: 56.03
Round  46, Train loss: 0.979, Test loss: 1.214, Test accuracy: 59.52
Round  46, Global train loss: 0.979, Global test loss: 1.337, Global test accuracy: 56.34
Round  47, Train loss: 0.974, Test loss: 1.214, Test accuracy: 59.51
Round  47, Global train loss: 0.974, Global test loss: 1.500, Global test accuracy: 54.67
Round  48, Train loss: 1.053, Test loss: 1.224, Test accuracy: 59.04
Round  48, Global train loss: 1.053, Global test loss: 1.442, Global test accuracy: 54.33
Round  49, Train loss: 0.892, Test loss: 1.245, Test accuracy: 58.61
Round  49, Global train loss: 0.892, Global test loss: 1.362, Global test accuracy: 56.95
Round  50, Train loss: 0.926, Test loss: 1.259, Test accuracy: 58.77
Round  50, Global train loss: 0.926, Global test loss: 1.496, Global test accuracy: 54.24
Round  51, Train loss: 0.817, Test loss: 1.251, Test accuracy: 58.98
Round  51, Global train loss: 0.817, Global test loss: 1.440, Global test accuracy: 55.27
Round  52, Train loss: 1.074, Test loss: 1.264, Test accuracy: 58.15
Round  52, Global train loss: 1.074, Global test loss: 1.428, Global test accuracy: 55.79
Round  53, Train loss: 0.923, Test loss: 1.263, Test accuracy: 58.27
Round  53, Global train loss: 0.923, Global test loss: 1.412, Global test accuracy: 55.63
Round  54, Train loss: 1.089, Test loss: 1.275, Test accuracy: 58.27
Round  54, Global train loss: 1.089, Global test loss: 1.519, Global test accuracy: 53.95
Round  55, Train loss: 0.831, Test loss: 1.270, Test accuracy: 58.50
Round  55, Global train loss: 0.831, Global test loss: 1.378, Global test accuracy: 55.93
Round  56, Train loss: 1.063, Test loss: 1.243, Test accuracy: 59.52
Round  56, Global train loss: 1.063, Global test loss: 1.442, Global test accuracy: 56.34
Round  57, Train loss: 0.836, Test loss: 1.245, Test accuracy: 59.75
Round  57, Global train loss: 0.836, Global test loss: 1.410, Global test accuracy: 57.00
Round  58, Train loss: 0.968, Test loss: 1.259, Test accuracy: 59.52
Round  58, Global train loss: 0.968, Global test loss: 1.388, Global test accuracy: 56.49
Round  59, Train loss: 0.852, Test loss: 1.266, Test accuracy: 59.61
Round  59, Global train loss: 0.852, Global test loss: 1.517, Global test accuracy: 55.05
Round  60, Train loss: 0.767, Test loss: 1.267, Test accuracy: 59.48
Round  60, Global train loss: 0.767, Global test loss: 1.499, Global test accuracy: 54.73
Round  61, Train loss: 1.012, Test loss: 1.279, Test accuracy: 59.50
Round  61, Global train loss: 1.012, Global test loss: 1.563, Global test accuracy: 54.04
Round  62, Train loss: 0.649, Test loss: 1.271, Test accuracy: 59.73
Round  62, Global train loss: 0.649, Global test loss: 1.401, Global test accuracy: 56.77
Round  63, Train loss: 0.959, Test loss: 1.260, Test accuracy: 59.62
Round  63, Global train loss: 0.959, Global test loss: 1.379, Global test accuracy: 55.60
Round  64, Train loss: 0.919, Test loss: 1.263, Test accuracy: 59.23
Round  64, Global train loss: 0.919, Global test loss: 1.462, Global test accuracy: 55.93
Round  65, Train loss: 0.909, Test loss: 1.283, Test accuracy: 58.62
Round  65, Global train loss: 0.909, Global test loss: 1.541, Global test accuracy: 55.16
Round  66, Train loss: 0.892, Test loss: 1.283, Test accuracy: 58.56
Round  66, Global train loss: 0.892, Global test loss: 1.619, Global test accuracy: 52.27
Round  67, Train loss: 0.931, Test loss: 1.292, Test accuracy: 58.24
Round  67, Global train loss: 0.931, Global test loss: 1.449, Global test accuracy: 55.20
Round  68, Train loss: 0.763, Test loss: 1.329, Test accuracy: 58.15
Round  68, Global train loss: 0.763, Global test loss: 1.529, Global test accuracy: 55.15
Round  69, Train loss: 0.973, Test loss: 1.326, Test accuracy: 58.41
Round  69, Global train loss: 0.973, Global test loss: 1.424, Global test accuracy: 55.74
Round  70, Train loss: 0.976, Test loss: 1.330, Test accuracy: 58.49
Round  70, Global train loss: 0.976, Global test loss: 1.522, Global test accuracy: 53.48
Round  71, Train loss: 0.707, Test loss: 1.326, Test accuracy: 58.39
Round  71, Global train loss: 0.707, Global test loss: 1.477, Global test accuracy: 56.39
Round  72, Train loss: 0.847, Test loss: 1.331, Test accuracy: 58.45
Round  72, Global train loss: 0.847, Global test loss: 1.453, Global test accuracy: 55.77
Round  73, Train loss: 0.726, Test loss: 1.337, Test accuracy: 58.60
Round  73, Global train loss: 0.726, Global test loss: 1.557, Global test accuracy: 56.58
Round  74, Train loss: 0.985, Test loss: 1.333, Test accuracy: 58.29
Round  74, Global train loss: 0.985, Global test loss: 1.508, Global test accuracy: 52.44
Round  75, Train loss: 0.913, Test loss: 1.351, Test accuracy: 58.07
Round  75, Global train loss: 0.913, Global test loss: 1.580, Global test accuracy: 53.37
Round  76, Train loss: 0.717, Test loss: 1.361, Test accuracy: 58.00
Round  76, Global train loss: 0.717, Global test loss: 1.371, Global test accuracy: 57.30
Round  77, Train loss: 0.735, Test loss: 1.365, Test accuracy: 57.59
Round  77, Global train loss: 0.735, Global test loss: 1.497, Global test accuracy: 55.56
Round  78, Train loss: 0.782, Test loss: 1.346, Test accuracy: 57.94
Round  78, Global train loss: 0.782, Global test loss: 1.501, Global test accuracy: 55.27
Round  79, Train loss: 0.717, Test loss: 1.347, Test accuracy: 57.58
Round  79, Global train loss: 0.717, Global test loss: 1.426, Global test accuracy: 56.93
Round  80, Train loss: 0.932, Test loss: 1.340, Test accuracy: 57.63
Round  80, Global train loss: 0.932, Global test loss: 1.602, Global test accuracy: 50.66
Round  81, Train loss: 0.927, Test loss: 1.349, Test accuracy: 57.43
Round  81, Global train loss: 0.927, Global test loss: 1.539, Global test accuracy: 51.83
Round  82, Train loss: 0.682, Test loss: 1.358, Test accuracy: 57.48
Round  82, Global train loss: 0.682, Global test loss: 1.546, Global test accuracy: 55.12
Round  83, Train loss: 0.809, Test loss: 1.345, Test accuracy: 58.13
Round  83, Global train loss: 0.809, Global test loss: 1.523, Global test accuracy: 55.26
Round  84, Train loss: 0.628, Test loss: 1.352, Test accuracy: 58.48
Round  84, Global train loss: 0.628, Global test loss: 1.437, Global test accuracy: 56.43
Round  85, Train loss: 0.877, Test loss: 1.369, Test accuracy: 58.11
Round  85, Global train loss: 0.877, Global test loss: 1.579, Global test accuracy: 53.37
Round  86, Train loss: 0.657, Test loss: 1.348, Test accuracy: 58.61
Round  86, Global train loss: 0.657, Global test loss: 1.488, Global test accuracy: 55.27
Round  87, Train loss: 0.733, Test loss: 1.341, Test accuracy: 59.08
Round  87, Global train loss: 0.733, Global test loss: 1.472, Global test accuracy: 55.27
Round  88, Train loss: 0.896, Test loss: 1.343, Test accuracy: 59.03
Round  88, Global train loss: 0.896, Global test loss: 1.729, Global test accuracy: 49.81
Round  89, Train loss: 0.683, Test loss: 1.374, Test accuracy: 58.48
Round  89, Global train loss: 0.683, Global test loss: 1.392, Global test accuracy: 56.94
Round  90, Train loss: 0.725, Test loss: 1.385, Test accuracy: 58.11
Round  90, Global train loss: 0.725, Global test loss: 1.402, Global test accuracy: 56.76
Round  91, Train loss: 0.771, Test loss: 1.373, Test accuracy: 58.17
Round  91, Global train loss: 0.771, Global test loss: 1.578, Global test accuracy: 53.13
Round  92, Train loss: 0.713, Test loss: 1.360, Test accuracy: 58.47
Round  92, Global train loss: 0.713, Global test loss: 1.563, Global test accuracy: 54.16
Round  93, Train loss: 0.718, Test loss: 1.354, Test accuracy: 58.91
Round  93, Global train loss: 0.718, Global test loss: 1.410, Global test accuracy: 56.90
Round  94, Train loss: 0.650, Test loss: 1.388, Test accuracy: 58.00
Round  94, Global train loss: 0.650, Global test loss: 1.539, Global test accuracy: 55.18
Round  95, Train loss: 0.766, Test loss: 1.373, Test accuracy: 58.23
Round  95, Global train loss: 0.766, Global test loss: 1.528, Global test accuracy: 55.42
Round  96, Train loss: 0.862, Test loss: 1.365, Test accuracy: 58.58
Round  96, Global train loss: 0.862, Global test loss: 1.731, Global test accuracy: 49.34
Round  97, Train loss: 0.841, Test loss: 1.380, Test accuracy: 58.62
Round  97, Global train loss: 0.841, Global test loss: 1.538, Global test accuracy: 53.61
Round  98, Train loss: 0.567, Test loss: 1.400, Test accuracy: 58.25
Round  98, Global train loss: 0.567, Global test loss: 1.513, Global test accuracy: 56.49
Round  99, Train loss: 0.653, Test loss: 1.374, Test accuracy: 58.96
Round  99, Global train loss: 0.653, Global test loss: 1.547, Global test accuracy: 56.06
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1612, in filter_data
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * 0.9))]
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1612, in <listcomp>
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * 0.9))]
IndexError: list index out of range
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  15.9100
Round 1 global test acc  17.5400
Round 2 global test acc  24.1800
Round 3 global test acc  25.9200
Round 4 global test acc  26.3100
Round 5 global test acc  22.0400
Round 6 global test acc  22.3600
Round 7 global test acc  32.7500
Round 8 global test acc  28.4600
Round 9 global test acc  25.3200
Round 10 global test acc  28.7000
Round 11 global test acc  31.7800
Round 12 global test acc  30.4800
Round 13 global test acc  33.5800
Round 14 global test acc  26.6700
Round 15 global test acc  30.1100
Round 16 global test acc  33.6400
Round 17 global test acc  30.6900
Round 18 global test acc  32.0200
Round 19 global test acc  39.3600
Round 20 global test acc  37.5200
Round 21 global test acc  34.9500
Round 22 global test acc  33.7000
Round 23 global test acc  37.1600
Round 24 global test acc  34.0900
Round 25 global test acc  36.1400
Round 26 global test acc  34.8000
Round 27 global test acc  41.0800
Round 28 global test acc  36.6600
Round 29 global test acc  41.6100
Round 30 global test acc  35.4900
Round 31 global test acc  37.0200
Round 32 global test acc  35.9100
Round 33 global test acc  36.5400
Round 34 global test acc  35.6000
Round 35 global test acc  39.6600
Round 36 global test acc  37.0400
Round 37 global test acc  39.8500
Round 38 global test acc  39.6500
Round 39 global test acc  37.7700
Round 40 global test acc  36.1100
Round 41 global test acc  35.7100
Round 42 global test acc  43.0200
Round 43 global test acc  37.6600
Round 44 global test acc  40.3400
Round 45 global test acc  41.0000
Round 46 global test acc  43.0300
Round 47 global test acc  40.0000
Round 48 global test acc  43.1400
Round 49 global test acc  39.0600
Round 50 global test acc  35.3900
Round 51 global test acc  37.0200
Round 52 global test acc  38.8000
Round 53 global test acc  35.1800
Round 54 global test acc  39.7600
Round 55 global test acc  42.3600
Round 56 global test acc  37.4100
Round 57 global test acc  40.1100
Round 58 global test acc  39.4700
Round 59 global test acc  43.0600
Round 60 global test acc  37.3500
Round 61 global test acc  41.3800
Round 62 global test acc  44.2400
Round 63 global test acc  40.4400
Round 64 global test acc  41.0000
Round 65 global test acc  37.2700
Round 66 global test acc  41.4700
Round 67 global test acc  40.1700
Round 68 global test acc  44.4700
Round 69 global test acc  41.1200
Round 70 global test acc  39.2800
Round 71 global test acc  42.2900
Round 72 global test acc  39.1400
Round 73 global test acc  41.8800
Round 74 global test acc  44.3500
Round 75 global test acc  47.2500
Round 76 global test acc  44.2800
Round 77 global test acc  39.4700
Round 78 global test acc  43.5300
Round 79 global test acc  40.7400
Round 80 global test acc  41.1200
Round 81 global test acc  37.2600
Round 82 global test acc  38.7800
Round 83 global test acc  36.6100
Round 84 global test acc  37.2700
Round 85 global test acc  38.8800
Round 86 global test acc  38.3700
Round 87 global test acc  36.3500
Round 88 global test acc  36.3600
Round 89 global test acc  37.7900
Round 90 global test acc  37.9100
Round 91 global test acc  36.8100
Round 92 global test acc  37.6900
Round 93 global test acc  37.1500
Round 94 global test acc  37.0200
Round 95 global test acc  36.1400
Round 96 global test acc  36.5900
Round 97 global test acc  36.5300
Round 98 global test acc  36.1100
Round 99 global test acc  36.2100
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.052, Test loss: 2.195, Test accuracy: 18.74
Round   1, Train loss: 1.762, Test loss: 1.949, Test accuracy: 27.32
Round   2, Train loss: 1.678, Test loss: 1.790, Test accuracy: 31.37
Round   3, Train loss: 1.640, Test loss: 1.777, Test accuracy: 35.04
Round   4, Train loss: 1.642, Test loss: 1.615, Test accuracy: 40.00
Round   5, Train loss: 1.712, Test loss: 1.507, Test accuracy: 44.88
Round   6, Train loss: 1.521, Test loss: 1.400, Test accuracy: 48.76
Round   7, Train loss: 1.458, Test loss: 1.364, Test accuracy: 50.13
Round   8, Train loss: 1.547, Test loss: 1.315, Test accuracy: 52.31
Round   9, Train loss: 1.477, Test loss: 1.313, Test accuracy: 54.52
Round  10, Train loss: 1.469, Test loss: 1.271, Test accuracy: 55.14
Round  11, Train loss: 1.375, Test loss: 1.268, Test accuracy: 55.69
Round  12, Train loss: 1.480, Test loss: 1.247, Test accuracy: 57.02
Round  13, Train loss: 1.499, Test loss: 1.255, Test accuracy: 56.90
Round  14, Train loss: 1.545, Test loss: 1.228, Test accuracy: 57.71
Round  15, Train loss: 1.325, Test loss: 1.198, Test accuracy: 58.39
Round  16, Train loss: 1.467, Test loss: 1.213, Test accuracy: 57.58
Round  17, Train loss: 1.539, Test loss: 1.222, Test accuracy: 57.62
Round  18, Train loss: 1.420, Test loss: 1.228, Test accuracy: 57.23
Round  19, Train loss: 1.338, Test loss: 1.164, Test accuracy: 59.71
Round  20, Train loss: 1.414, Test loss: 1.150, Test accuracy: 62.06
Round  21, Train loss: 1.390, Test loss: 1.163, Test accuracy: 61.68
Round  22, Train loss: 1.422, Test loss: 1.173, Test accuracy: 62.15
Round  23, Train loss: 1.313, Test loss: 1.126, Test accuracy: 62.47
Round  24, Train loss: 1.190, Test loss: 1.082, Test accuracy: 63.44
Round  25, Train loss: 1.271, Test loss: 1.090, Test accuracy: 64.33
Round  26, Train loss: 1.248, Test loss: 1.076, Test accuracy: 64.40
Round  27, Train loss: 1.428, Test loss: 1.096, Test accuracy: 64.91
Round  28, Train loss: 1.225, Test loss: 1.074, Test accuracy: 64.93
Round  29, Train loss: 1.462, Test loss: 1.058, Test accuracy: 65.12
Round  30, Train loss: 1.187, Test loss: 1.054, Test accuracy: 64.99
Round  31, Train loss: 1.371, Test loss: 1.066, Test accuracy: 65.45
Round  32, Train loss: 1.198, Test loss: 1.051, Test accuracy: 65.71
Round  33, Train loss: 1.342, Test loss: 1.053, Test accuracy: 65.93
Round  34, Train loss: 1.304, Test loss: 1.031, Test accuracy: 65.25
Round  35, Train loss: 1.384, Test loss: 1.032, Test accuracy: 66.17
Round  36, Train loss: 1.405, Test loss: 1.079, Test accuracy: 66.10
Round  37, Train loss: 1.311, Test loss: 1.025, Test accuracy: 66.78
Round  38, Train loss: 1.395, Test loss: 1.040, Test accuracy: 67.02
Round  39, Train loss: 1.273, Test loss: 1.036, Test accuracy: 67.31
Round  40, Train loss: 1.201, Test loss: 0.999, Test accuracy: 67.51
Round  41, Train loss: 1.247, Test loss: 1.007, Test accuracy: 67.66
Round  42, Train loss: 1.254, Test loss: 0.995, Test accuracy: 68.08
Round  43, Train loss: 1.116, Test loss: 0.996, Test accuracy: 68.28
Round  44, Train loss: 1.138, Test loss: 0.990, Test accuracy: 68.29
Round  45, Train loss: 1.125, Test loss: 0.979, Test accuracy: 68.43
Round  46, Train loss: 1.199, Test loss: 0.980, Test accuracy: 67.85
Round  47, Train loss: 1.250, Test loss: 0.994, Test accuracy: 67.88
Round  48, Train loss: 1.066, Test loss: 0.976, Test accuracy: 68.42
Round  49, Train loss: 1.151, Test loss: 0.972, Test accuracy: 68.67
Round  50, Train loss: 1.141, Test loss: 0.969, Test accuracy: 68.80
Round  51, Train loss: 1.131, Test loss: 0.977, Test accuracy: 68.47
Round  52, Train loss: 1.107, Test loss: 0.973, Test accuracy: 68.88
Round  53, Train loss: 1.067, Test loss: 0.975, Test accuracy: 68.82
Round  54, Train loss: 1.078, Test loss: 0.961, Test accuracy: 69.15
Round  55, Train loss: 1.250, Test loss: 0.963, Test accuracy: 69.59
Round  56, Train loss: 1.060, Test loss: 0.962, Test accuracy: 69.72
Round  57, Train loss: 1.228, Test loss: 0.969, Test accuracy: 69.11
Round  58, Train loss: 1.101, Test loss: 0.958, Test accuracy: 69.32
Round  59, Train loss: 1.290, Test loss: 0.982, Test accuracy: 68.88
Round  60, Train loss: 1.167, Test loss: 0.971, Test accuracy: 69.38
Round  61, Train loss: 1.115, Test loss: 0.946, Test accuracy: 70.04
Round  62, Train loss: 1.157, Test loss: 0.969, Test accuracy: 69.02
Round  63, Train loss: 1.190, Test loss: 0.960, Test accuracy: 69.97
Round  64, Train loss: 1.023, Test loss: 0.936, Test accuracy: 69.71
Round  65, Train loss: 1.003, Test loss: 0.932, Test accuracy: 70.25
Round  66, Train loss: 1.158, Test loss: 0.943, Test accuracy: 69.47
Round  67, Train loss: 1.053, Test loss: 0.932, Test accuracy: 69.74
Round  68, Train loss: 0.997, Test loss: 0.941, Test accuracy: 69.39
Round  69, Train loss: 0.843, Test loss: 0.924, Test accuracy: 70.15
Round  70, Train loss: 1.082, Test loss: 0.929, Test accuracy: 70.31
Round  71, Train loss: 1.088, Test loss: 0.941, Test accuracy: 70.16
Round  72, Train loss: 1.116, Test loss: 0.945, Test accuracy: 70.02
Round  73, Train loss: 1.063, Test loss: 0.953, Test accuracy: 69.35
Round  74, Train loss: 1.082, Test loss: 0.934, Test accuracy: 70.37
Round  75, Train loss: 0.943, Test loss: 0.923, Test accuracy: 70.01
Round  76, Train loss: 1.127, Test loss: 0.927, Test accuracy: 69.90
Round  77, Train loss: 0.851, Test loss: 0.924, Test accuracy: 69.73
Round  78, Train loss: 0.997, Test loss: 0.930, Test accuracy: 69.50
Round  79, Train loss: 1.299, Test loss: 0.934, Test accuracy: 69.94
Round  80, Train loss: 1.209, Test loss: 0.936, Test accuracy: 69.25
Round  81, Train loss: 1.099, Test loss: 0.938, Test accuracy: 69.78
Round  82, Train loss: 1.006, Test loss: 0.939, Test accuracy: 69.46
Round  83, Train loss: 0.893, Test loss: 0.941, Test accuracy: 69.78
Round  84, Train loss: 1.125, Test loss: 0.950, Test accuracy: 69.00
Round  85, Train loss: 0.857, Test loss: 0.924, Test accuracy: 69.65
Round  86, Train loss: 0.891, Test loss: 0.914, Test accuracy: 70.16
Round  87, Train loss: 1.136, Test loss: 0.925, Test accuracy: 69.23
Round  88, Train loss: 0.963, Test loss: 0.917, Test accuracy: 69.44
Round  89, Train loss: 0.842, Test loss: 0.921, Test accuracy: 69.64
Round  90, Train loss: 0.807, Test loss: 0.914, Test accuracy: 69.77
Round  91, Train loss: 1.061, Test loss: 0.917, Test accuracy: 69.61
Round  92, Train loss: 0.873, Test loss: 0.910, Test accuracy: 69.83
Round  93, Train loss: 1.123, Test loss: 0.942, Test accuracy: 68.82
Round  94, Train loss: 0.721, Test loss: 0.919, Test accuracy: 69.13
Round  95, Train loss: 0.902, Test loss: 0.932, Test accuracy: 68.96
Round  96, Train loss: 0.852, Test loss: 0.918, Test accuracy: 69.44
Round  97, Train loss: 0.924, Test loss: 0.909, Test accuracy: 69.73
Round  98, Train loss: 0.867, Test loss: 0.932, Test accuracy: 69.35
Round  99, Train loss: 0.885, Test loss: 0.930, Test accuracy: 69.25
Final Round, Train loss: 0.927, Test loss: 0.934, Test accuracy: 68.86
Average accuracy final 10 rounds: 69.38833333333335
1182.18270778656
[1.8317196369171143, 3.371220111846924, 4.899874687194824, 6.481590509414673, 8.066369771957397, 9.647052764892578, 11.235419750213623, 12.810756206512451, 14.389314889907837, 15.965219020843506, 17.537158966064453, 19.113259315490723, 20.683690786361694, 22.257399082183838, 23.83546757698059, 25.414891242980957, 26.986106395721436, 28.57215189933777, 30.169148921966553, 31.75745677947998, 33.34211444854736, 34.78280329704285, 36.182496547698975, 37.582653522491455, 38.982309103012085, 40.382038593292236, 41.782036781311035, 43.18271207809448, 44.58296084403992, 45.98051929473877, 47.38266086578369, 48.784019470214844, 50.1844379901886, 51.58368945121765, 52.984174728393555, 54.38493990898132, 55.784854888916016, 57.18465495109558, 58.58635115623474, 59.989989280700684, 61.389952659606934, 62.79024314880371, 64.19177389144897, 65.59322786331177, 66.99422693252563, 68.3937566280365, 69.79342317581177, 71.1950957775116, 72.61941909790039, 74.05310440063477, 75.48218107223511, 76.91460037231445, 78.34911060333252, 79.77710151672363, 81.20819544792175, 82.64535236358643, 84.08120799064636, 85.51443886756897, 86.94838070869446, 88.38058137893677, 89.81110978126526, 91.245197057724, 92.65583825111389, 94.06625366210938, 95.47892642021179, 96.88798379898071, 98.29700016975403, 99.70167827606201, 101.10884737968445, 102.49776220321655, 103.88702940940857, 105.2827582359314, 106.67372465133667, 108.06400060653687, 109.4573085308075, 110.84912061691284, 112.23911356925964, 113.6304178237915, 115.02230739593506, 116.40957999229431, 117.79796695709229, 119.19209718704224, 120.58467125892639, 121.97446274757385, 123.36470556259155, 124.76059198379517, 126.15734481811523, 127.55116868019104, 128.94046139717102, 130.32716584205627, 131.7196364402771, 133.11371779441833, 134.50850319862366, 135.90769147872925, 137.29898166656494, 138.69010424613953, 140.08038020133972, 141.4737150669098, 142.8633689880371, 144.25403261184692, 146.1435112953186]
[18.741666666666667, 27.325, 31.366666666666667, 35.041666666666664, 40.0, 44.88333333333333, 48.75833333333333, 50.13333333333333, 52.30833333333333, 54.525, 55.141666666666666, 55.69166666666667, 57.016666666666666, 56.9, 57.708333333333336, 58.391666666666666, 57.583333333333336, 57.625, 57.225, 59.708333333333336, 62.05833333333333, 61.68333333333333, 62.15, 62.46666666666667, 63.44166666666667, 64.325, 64.4, 64.90833333333333, 64.93333333333334, 65.125, 64.99166666666666, 65.45, 65.70833333333333, 65.93333333333334, 65.25, 66.175, 66.1, 66.775, 67.01666666666667, 67.30833333333334, 67.50833333333334, 67.65833333333333, 68.08333333333333, 68.28333333333333, 68.29166666666667, 68.43333333333334, 67.85, 67.88333333333334, 68.425, 68.66666666666667, 68.8, 68.475, 68.88333333333334, 68.81666666666666, 69.15, 69.59166666666667, 69.725, 69.10833333333333, 69.31666666666666, 68.88333333333334, 69.375, 70.04166666666667, 69.01666666666667, 69.96666666666667, 69.70833333333333, 70.25, 69.46666666666667, 69.74166666666666, 69.39166666666667, 70.15, 70.30833333333334, 70.15833333333333, 70.01666666666667, 69.35, 70.36666666666666, 70.00833333333334, 69.9, 69.73333333333333, 69.5, 69.94166666666666, 69.25, 69.775, 69.45833333333333, 69.775, 69.0, 69.65, 70.15833333333333, 69.23333333333333, 69.44166666666666, 69.64166666666667, 69.76666666666667, 69.60833333333333, 69.825, 68.81666666666666, 69.13333333333334, 68.95833333333333, 69.44166666666666, 69.73333333333333, 69.35, 69.25, 68.85833333333333]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.830, Test loss: 2.099, Test accuracy: 20.33
Round   0, Global train loss: 1.830, Global test loss: 2.253, Global test accuracy: 17.45
Round   1, Train loss: 1.730, Test loss: 1.808, Test accuracy: 29.94
Round   1, Global train loss: 1.730, Global test loss: 2.064, Global test accuracy: 25.52
Round   2, Train loss: 1.690, Test loss: 1.714, Test accuracy: 32.71
Round   2, Global train loss: 1.690, Global test loss: 1.991, Global test accuracy: 25.25
Round   3, Train loss: 1.579, Test loss: 1.680, Test accuracy: 36.40
Round   3, Global train loss: 1.579, Global test loss: 1.993, Global test accuracy: 28.48
Round   4, Train loss: 1.534, Test loss: 1.534, Test accuracy: 42.09
Round   4, Global train loss: 1.534, Global test loss: 1.831, Global test accuracy: 37.42
Round   5, Train loss: 1.620, Test loss: 1.426, Test accuracy: 45.25
Round   5, Global train loss: 1.620, Global test loss: 1.854, Global test accuracy: 31.07
Round   6, Train loss: 1.368, Test loss: 1.388, Test accuracy: 47.57
Round   6, Global train loss: 1.368, Global test loss: 1.661, Global test accuracy: 40.33
Round   7, Train loss: 1.400, Test loss: 1.363, Test accuracy: 48.52
Round   7, Global train loss: 1.400, Global test loss: 1.657, Global test accuracy: 40.75
Round   8, Train loss: 1.586, Test loss: 1.310, Test accuracy: 50.44
Round   8, Global train loss: 1.586, Global test loss: 1.716, Global test accuracy: 43.97
Round   9, Train loss: 1.419, Test loss: 1.311, Test accuracy: 50.72
Round   9, Global train loss: 1.419, Global test loss: 1.598, Global test accuracy: 44.62
Round  10, Train loss: 1.324, Test loss: 1.283, Test accuracy: 52.19
Round  10, Global train loss: 1.324, Global test loss: 1.506, Global test accuracy: 48.00
Round  11, Train loss: 1.288, Test loss: 1.258, Test accuracy: 53.73
Round  11, Global train loss: 1.288, Global test loss: 1.495, Global test accuracy: 47.32
Round  12, Train loss: 1.350, Test loss: 1.245, Test accuracy: 55.08
Round  12, Global train loss: 1.350, Global test loss: 1.593, Global test accuracy: 43.54
Round  13, Train loss: 1.436, Test loss: 1.238, Test accuracy: 55.78
Round  13, Global train loss: 1.436, Global test loss: 1.616, Global test accuracy: 45.05
Round  14, Train loss: 1.430, Test loss: 1.207, Test accuracy: 57.58
Round  14, Global train loss: 1.430, Global test loss: 1.499, Global test accuracy: 50.61
Round  15, Train loss: 1.306, Test loss: 1.205, Test accuracy: 57.86
Round  15, Global train loss: 1.306, Global test loss: 1.536, Global test accuracy: 44.88
Round  16, Train loss: 1.487, Test loss: 1.199, Test accuracy: 58.25
Round  16, Global train loss: 1.487, Global test loss: 1.572, Global test accuracy: 49.35
Round  17, Train loss: 1.234, Test loss: 1.185, Test accuracy: 58.37
Round  17, Global train loss: 1.234, Global test loss: 1.508, Global test accuracy: 47.23
Round  18, Train loss: 1.357, Test loss: 1.184, Test accuracy: 58.00
Round  18, Global train loss: 1.357, Global test loss: 1.474, Global test accuracy: 51.34
Round  19, Train loss: 1.313, Test loss: 1.169, Test accuracy: 59.10
Round  19, Global train loss: 1.313, Global test loss: 1.415, Global test accuracy: 53.10
Round  20, Train loss: 1.200, Test loss: 1.164, Test accuracy: 59.27
Round  20, Global train loss: 1.200, Global test loss: 1.369, Global test accuracy: 53.92
Round  21, Train loss: 1.272, Test loss: 1.148, Test accuracy: 59.66
Round  21, Global train loss: 1.272, Global test loss: 1.392, Global test accuracy: 54.70
Round  22, Train loss: 1.321, Test loss: 1.146, Test accuracy: 59.98
Round  22, Global train loss: 1.321, Global test loss: 1.401, Global test accuracy: 55.46
Round  23, Train loss: 1.125, Test loss: 1.142, Test accuracy: 59.92
Round  23, Global train loss: 1.125, Global test loss: 1.319, Global test accuracy: 57.01
Round  24, Train loss: 1.248, Test loss: 1.152, Test accuracy: 59.46
Round  24, Global train loss: 1.248, Global test loss: 1.481, Global test accuracy: 48.89
Round  25, Train loss: 1.252, Test loss: 1.141, Test accuracy: 59.89
Round  25, Global train loss: 1.252, Global test loss: 1.448, Global test accuracy: 52.70
Round  26, Train loss: 1.318, Test loss: 1.126, Test accuracy: 60.76
Round  26, Global train loss: 1.318, Global test loss: 1.433, Global test accuracy: 54.60
Round  27, Train loss: 1.009, Test loss: 1.133, Test accuracy: 60.77
Round  27, Global train loss: 1.009, Global test loss: 1.486, Global test accuracy: 50.87
Round  28, Train loss: 1.185, Test loss: 1.130, Test accuracy: 61.05
Round  28, Global train loss: 1.185, Global test loss: 1.425, Global test accuracy: 52.67
Round  29, Train loss: 1.292, Test loss: 1.134, Test accuracy: 60.80
Round  29, Global train loss: 1.292, Global test loss: 1.405, Global test accuracy: 54.72
Round  30, Train loss: 1.264, Test loss: 1.139, Test accuracy: 60.53
Round  30, Global train loss: 1.264, Global test loss: 1.467, Global test accuracy: 53.48
Round  31, Train loss: 1.359, Test loss: 1.129, Test accuracy: 60.68
Round  31, Global train loss: 1.359, Global test loss: 1.421, Global test accuracy: 56.30
Round  32, Train loss: 1.190, Test loss: 1.142, Test accuracy: 60.08
Round  32, Global train loss: 1.190, Global test loss: 1.360, Global test accuracy: 56.79
Round  33, Train loss: 1.234, Test loss: 1.141, Test accuracy: 60.12
Round  33, Global train loss: 1.234, Global test loss: 1.474, Global test accuracy: 51.11
Round  34, Train loss: 1.107, Test loss: 1.155, Test accuracy: 59.57
Round  34, Global train loss: 1.107, Global test loss: 1.352, Global test accuracy: 55.51
Round  35, Train loss: 1.044, Test loss: 1.152, Test accuracy: 60.17
Round  35, Global train loss: 1.044, Global test loss: 1.270, Global test accuracy: 58.63
Round  36, Train loss: 1.278, Test loss: 1.140, Test accuracy: 60.65
Round  36, Global train loss: 1.278, Global test loss: 1.384, Global test accuracy: 58.58
Round  37, Train loss: 1.270, Test loss: 1.154, Test accuracy: 59.88
Round  37, Global train loss: 1.270, Global test loss: 1.480, Global test accuracy: 54.04
Round  38, Train loss: 1.313, Test loss: 1.149, Test accuracy: 59.77
Round  38, Global train loss: 1.313, Global test loss: 1.477, Global test accuracy: 53.80
Round  39, Train loss: 1.237, Test loss: 1.160, Test accuracy: 59.49
Round  39, Global train loss: 1.237, Global test loss: 1.549, Global test accuracy: 51.86
Round  40, Train loss: 1.166, Test loss: 1.146, Test accuracy: 60.38
Round  40, Global train loss: 1.166, Global test loss: 1.453, Global test accuracy: 52.83
Round  41, Train loss: 0.997, Test loss: 1.160, Test accuracy: 59.86
Round  41, Global train loss: 0.997, Global test loss: 1.476, Global test accuracy: 52.80
Round  42, Train loss: 1.105, Test loss: 1.171, Test accuracy: 59.58
Round  42, Global train loss: 1.105, Global test loss: 1.305, Global test accuracy: 57.57
Round  43, Train loss: 1.067, Test loss: 1.168, Test accuracy: 59.49
Round  43, Global train loss: 1.067, Global test loss: 1.458, Global test accuracy: 54.42
Round  44, Train loss: 1.070, Test loss: 1.189, Test accuracy: 58.88
Round  44, Global train loss: 1.070, Global test loss: 1.435, Global test accuracy: 54.08
Round  45, Train loss: 0.933, Test loss: 1.189, Test accuracy: 59.16
Round  45, Global train loss: 0.933, Global test loss: 1.370, Global test accuracy: 55.83
Round  46, Train loss: 0.943, Test loss: 1.181, Test accuracy: 59.62
Round  46, Global train loss: 0.943, Global test loss: 1.245, Global test accuracy: 58.65
Round  47, Train loss: 1.071, Test loss: 1.171, Test accuracy: 60.14
Round  47, Global train loss: 1.071, Global test loss: 1.459, Global test accuracy: 54.16
Round  48, Train loss: 1.083, Test loss: 1.186, Test accuracy: 59.99
Round  48, Global train loss: 1.083, Global test loss: 1.355, Global test accuracy: 56.58
Round  49, Train loss: 0.847, Test loss: 1.181, Test accuracy: 59.88
Round  49, Global train loss: 0.847, Global test loss: 1.339, Global test accuracy: 55.25
Round  50, Train loss: 0.929, Test loss: 1.174, Test accuracy: 60.38
Round  50, Global train loss: 0.929, Global test loss: 1.379, Global test accuracy: 55.18
Round  51, Train loss: 1.141, Test loss: 1.178, Test accuracy: 59.86
Round  51, Global train loss: 1.141, Global test loss: 1.433, Global test accuracy: 54.10
Round  52, Train loss: 0.935, Test loss: 1.204, Test accuracy: 59.55
Round  52, Global train loss: 0.935, Global test loss: 1.371, Global test accuracy: 57.17
Round  53, Train loss: 0.984, Test loss: 1.202, Test accuracy: 59.98
Round  53, Global train loss: 0.984, Global test loss: 1.365, Global test accuracy: 56.00
Round  54, Train loss: 1.115, Test loss: 1.202, Test accuracy: 60.00
Round  54, Global train loss: 1.115, Global test loss: 1.378, Global test accuracy: 56.84
Round  55, Train loss: 1.122, Test loss: 1.193, Test accuracy: 60.26
Round  55, Global train loss: 1.122, Global test loss: 1.484, Global test accuracy: 52.40
Round  56, Train loss: 0.982, Test loss: 1.208, Test accuracy: 59.89
Round  56, Global train loss: 0.982, Global test loss: 1.336, Global test accuracy: 57.45
Round  57, Train loss: 0.985, Test loss: 1.218, Test accuracy: 59.52
Round  57, Global train loss: 0.985, Global test loss: 1.368, Global test accuracy: 56.65
Round  58, Train loss: 0.902, Test loss: 1.235, Test accuracy: 58.85
Round  58, Global train loss: 0.902, Global test loss: 1.296, Global test accuracy: 57.98
Round  59, Train loss: 1.043, Test loss: 1.228, Test accuracy: 59.11
Round  59, Global train loss: 1.043, Global test loss: 1.440, Global test accuracy: 54.93
Round  60, Train loss: 0.959, Test loss: 1.223, Test accuracy: 59.58
Round  60, Global train loss: 0.959, Global test loss: 1.476, Global test accuracy: 53.60
Round  61, Train loss: 0.793, Test loss: 1.237, Test accuracy: 59.56
Round  61, Global train loss: 0.793, Global test loss: 1.468, Global test accuracy: 55.45
Round  62, Train loss: 1.000, Test loss: 1.254, Test accuracy: 58.45
Round  62, Global train loss: 1.000, Global test loss: 1.455, Global test accuracy: 53.41
Round  63, Train loss: 0.856, Test loss: 1.259, Test accuracy: 58.76
Round  63, Global train loss: 0.856, Global test loss: 1.405, Global test accuracy: 55.83
Round  64, Train loss: 0.931, Test loss: 1.272, Test accuracy: 58.58
Round  64, Global train loss: 0.931, Global test loss: 1.523, Global test accuracy: 52.96
Round  65, Train loss: 0.916, Test loss: 1.275, Test accuracy: 58.94
Round  65, Global train loss: 0.916, Global test loss: 1.471, Global test accuracy: 56.50
Round  66, Train loss: 1.124, Test loss: 1.271, Test accuracy: 59.04
Round  66, Global train loss: 1.124, Global test loss: 1.530, Global test accuracy: 52.39
Round  67, Train loss: 0.745, Test loss: 1.287, Test accuracy: 58.92
Round  67, Global train loss: 0.745, Global test loss: 1.339, Global test accuracy: 57.59
Round  68, Train loss: 0.849, Test loss: 1.287, Test accuracy: 59.17
Round  68, Global train loss: 0.849, Global test loss: 1.456, Global test accuracy: 55.88
Round  69, Train loss: 0.754, Test loss: 1.301, Test accuracy: 58.90
Round  69, Global train loss: 0.754, Global test loss: 1.248, Global test accuracy: 59.54
Round  70, Train loss: 0.820, Test loss: 1.314, Test accuracy: 58.60
Round  70, Global train loss: 0.820, Global test loss: 1.318, Global test accuracy: 58.92
Round  71, Train loss: 0.751, Test loss: 1.309, Test accuracy: 58.68
Round  71, Global train loss: 0.751, Global test loss: 1.361, Global test accuracy: 58.18
Round  72, Train loss: 0.966, Test loss: 1.307, Test accuracy: 58.51
Round  72, Global train loss: 0.966, Global test loss: 1.377, Global test accuracy: 56.22
Round  73, Train loss: 0.794, Test loss: 1.313, Test accuracy: 58.46
Round  73, Global train loss: 0.794, Global test loss: 1.511, Global test accuracy: 55.87
Round  74, Train loss: 0.734, Test loss: 1.340, Test accuracy: 58.01
Round  74, Global train loss: 0.734, Global test loss: 1.325, Global test accuracy: 57.58
Round  75, Train loss: 0.798, Test loss: 1.354, Test accuracy: 57.48
Round  75, Global train loss: 0.798, Global test loss: 1.386, Global test accuracy: 58.46
Round  76, Train loss: 0.898, Test loss: 1.330, Test accuracy: 58.34
Round  76, Global train loss: 0.898, Global test loss: 1.413, Global test accuracy: 55.92
Round  77, Train loss: 0.913, Test loss: 1.330, Test accuracy: 58.62
Round  77, Global train loss: 0.913, Global test loss: 1.539, Global test accuracy: 52.98
Round  78, Train loss: 0.859, Test loss: 1.320, Test accuracy: 59.17
Round  78, Global train loss: 0.859, Global test loss: 1.642, Global test accuracy: 50.92
Round  79, Train loss: 0.798, Test loss: 1.320, Test accuracy: 59.37
Round  79, Global train loss: 0.798, Global test loss: 1.461, Global test accuracy: 55.19
Round  80, Train loss: 0.675, Test loss: 1.333, Test accuracy: 59.02
Round  80, Global train loss: 0.675, Global test loss: 1.645, Global test accuracy: 51.67
Round  81, Train loss: 0.667, Test loss: 1.325, Test accuracy: 58.71
Round  81, Global train loss: 0.667, Global test loss: 1.361, Global test accuracy: 57.61
Round  82, Train loss: 0.840, Test loss: 1.351, Test accuracy: 58.18
Round  82, Global train loss: 0.840, Global test loss: 1.560, Global test accuracy: 52.90
Round  83, Train loss: 0.899, Test loss: 1.364, Test accuracy: 58.18
Round  83, Global train loss: 0.899, Global test loss: 1.495, Global test accuracy: 55.34
Round  84, Train loss: 0.771, Test loss: 1.392, Test accuracy: 57.83
Round  84, Global train loss: 0.771, Global test loss: 1.527, Global test accuracy: 53.23
Round  85, Train loss: 0.814, Test loss: 1.406, Test accuracy: 57.49
Round  85, Global train loss: 0.814, Global test loss: 1.527, Global test accuracy: 55.15
Round  86, Train loss: 0.746, Test loss: 1.427, Test accuracy: 57.56
Round  86, Global train loss: 0.746, Global test loss: 1.530, Global test accuracy: 54.20
Round  87, Train loss: 0.781, Test loss: 1.430, Test accuracy: 57.67
Round  87, Global train loss: 0.781, Global test loss: 1.489, Global test accuracy: 55.19
Round  88, Train loss: 0.655, Test loss: 1.443, Test accuracy: 57.73
Round  88, Global train loss: 0.655, Global test loss: 1.614, Global test accuracy: 54.49
Round  89, Train loss: 0.631, Test loss: 1.391, Test accuracy: 58.56
Round  89, Global train loss: 0.631, Global test loss: 1.383, Global test accuracy: 58.59
Round  90, Train loss: 0.753, Test loss: 1.407, Test accuracy: 58.46
Round  90, Global train loss: 0.753, Global test loss: 1.396, Global test accuracy: 57.02
Round  91, Train loss: 0.742, Test loss: 1.393, Test accuracy: 58.50
Round  91, Global train loss: 0.742, Global test loss: 1.520, Global test accuracy: 54.68
Round  92, Train loss: 0.707, Test loss: 1.380, Test accuracy: 58.77
Round  92, Global train loss: 0.707, Global test loss: 1.548, Global test accuracy: 54.35
Round  93, Train loss: 0.734, Test loss: 1.386, Test accuracy: 58.29
Round  93, Global train loss: 0.734, Global test loss: 1.428, Global test accuracy: 57.27
Round  94, Train loss: 0.698, Test loss: 1.428, Test accuracy: 57.83
Round  94, Global train loss: 0.698, Global test loss: 1.596, Global test accuracy: 53.45
Round  95, Train loss: 0.658, Test loss: 1.415, Test accuracy: 58.12
Round  95, Global train loss: 0.658, Global test loss: 1.532, Global test accuracy: 56.20
Round  96, Train loss: 0.749, Test loss: 1.429, Test accuracy: 57.73
Round  96, Global train loss: 0.749, Global test loss: 1.685, Global test accuracy: 51.64
Round  97, Train loss: 0.719, Test loss: 1.453, Test accuracy: 57.31
Round  97, Global train loss: 0.719, Global test loss: 1.471, Global test accuracy: 56.30
Round  98, Train loss: 0.564, Test loss: 1.460, Test accuracy: 56.93
Round  98, Global train loss: 0.564, Global test loss: 1.537, Global test accuracy: 56.48
Round  99, Train loss: 0.788, Test loss: 1.463, Test accuracy: 57.27
Round  99, Global train loss: 0.788, Global test loss: 1.642, Global test accuracy: 52.09
Final Round, Train loss: 0.555, Test loss: 1.653, Test accuracy: 57.33
Final Round, Global train loss: 0.555, Global test loss: 1.642, Global test accuracy: 52.09
Average accuracy final 10 rounds: 57.920833333333334
Average global accuracy final 10 rounds: 54.94833333333334
2344.3705909252167
[1.6687941551208496, 3.0561554431915283, 4.437494277954102, 5.822285175323486, 7.208002090454102, 8.596189498901367, 9.986436367034912, 11.360216617584229, 12.73509669303894, 14.113481283187866, 15.290695667266846, 16.468005657196045, 17.645681619644165, 18.827332496643066, 20.00668954849243, 21.18705940246582, 22.389739274978638, 23.627260446548462, 24.87356925010681, 26.055468797683716, 27.23589539527893, 30.266046047210693, 33.28240251541138, 36.29149317741394, 39.31243300437927, 42.327324628829956, 45.66987109184265, 49.076003313064575, 52.49575328826904, 55.8603515625, 59.24290442466736, 62.643818616867065, 66.06342959403992, 69.46425533294678, 72.84652757644653, 76.21345567703247, 79.4317376613617, 82.85733819007874, 86.29115319252014, 89.69609642028809, 93.09144043922424, 96.51768970489502, 99.93569207191467, 103.34926962852478, 106.77469396591187, 110.18574571609497, 113.60901927947998, 116.97870302200317, 120.34996747970581, 123.82828664779663, 127.42598390579224, 131.00543856620789, 134.55655002593994, 138.11892747879028, 141.6466953754425, 145.2868037223816, 148.83123874664307, 152.42034530639648, 155.97251844406128, 159.6138515472412, 163.1634259223938, 166.7063286304474, 170.35161352157593, 173.88453364372253, 177.4073028564453, 181.02460598945618, 184.59384083747864, 188.1742877960205, 191.72598481178284, 195.336980342865, 198.85581231117249, 202.42031145095825, 206.01820397377014, 209.6050398349762, 213.22330832481384, 216.80770707130432, 220.37209224700928, 223.94682812690735, 227.52186155319214, 231.0806987285614, 234.67936897277832, 238.30138182640076, 241.86974358558655, 245.37301206588745, 249.00286531448364, 252.59867548942566, 256.1819016933441, 259.79861068725586, 263.3844347000122, 266.9654166698456, 270.5302152633667, 274.11711406707764, 277.42892146110535, 280.83724784851074, 284.23255372047424, 287.63675355911255, 291.03709149360657, 294.4413664340973, 297.50358271598816, 300.5715346336365, 302.5565731525421]
[20.333333333333332, 29.941666666666666, 32.708333333333336, 36.4, 42.09166666666667, 45.25, 47.56666666666667, 48.516666666666666, 50.44166666666667, 50.71666666666667, 52.19166666666667, 53.725, 55.083333333333336, 55.78333333333333, 57.583333333333336, 57.858333333333334, 58.25, 58.36666666666667, 58.0, 59.1, 59.266666666666666, 59.65833333333333, 59.975, 59.925, 59.458333333333336, 59.891666666666666, 60.75833333333333, 60.775, 61.05, 60.8, 60.53333333333333, 60.68333333333333, 60.075, 60.125, 59.56666666666667, 60.175, 60.65, 59.875, 59.766666666666666, 59.49166666666667, 60.375, 59.858333333333334, 59.575, 59.49166666666667, 58.875, 59.15833333333333, 59.61666666666667, 60.141666666666666, 59.99166666666667, 59.88333333333333, 60.38333333333333, 59.858333333333334, 59.55, 59.983333333333334, 60.0, 60.25833333333333, 59.891666666666666, 59.516666666666666, 58.85, 59.108333333333334, 59.575, 59.55833333333333, 58.45, 58.75833333333333, 58.575, 58.94166666666667, 59.041666666666664, 58.916666666666664, 59.175, 58.9, 58.6, 58.68333333333333, 58.50833333333333, 58.458333333333336, 58.00833333333333, 57.483333333333334, 58.34166666666667, 58.61666666666667, 59.175, 59.36666666666667, 59.025, 58.708333333333336, 58.18333333333333, 58.18333333333333, 57.833333333333336, 57.49166666666667, 57.55833333333333, 57.675, 57.725, 58.55833333333333, 58.458333333333336, 58.5, 58.775, 58.291666666666664, 57.825, 58.11666666666667, 57.725, 57.30833333333333, 56.93333333333333, 57.275, 57.333333333333336]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.750, Test loss: 1.513, Test accuracy: 39.40
Round   0, Global train loss: 1.750, Global test loss: 2.140, Global test accuracy: 27.14
Round   1, Train loss: 1.608, Test loss: 1.392, Test accuracy: 47.03
Round   1, Global train loss: 1.608, Global test loss: 1.859, Global test accuracy: 35.42
Round   2, Train loss: 1.519, Test loss: 1.329, Test accuracy: 50.00
Round   2, Global train loss: 1.519, Global test loss: 1.720, Global test accuracy: 40.00
Round   3, Train loss: 1.466, Test loss: 1.291, Test accuracy: 51.97
Round   3, Global train loss: 1.466, Global test loss: 1.617, Global test accuracy: 44.32
Round   4, Train loss: 1.420, Test loss: 1.268, Test accuracy: 53.68
Round   4, Global train loss: 1.420, Global test loss: 1.565, Global test accuracy: 46.65
Round   5, Train loss: 1.381, Test loss: 1.253, Test accuracy: 54.17
Round   5, Global train loss: 1.381, Global test loss: 1.524, Global test accuracy: 48.55
Round   6, Train loss: 1.342, Test loss: 1.232, Test accuracy: 54.97
Round   6, Global train loss: 1.342, Global test loss: 1.482, Global test accuracy: 50.18
Round   7, Train loss: 1.301, Test loss: 1.210, Test accuracy: 56.83
Round   7, Global train loss: 1.301, Global test loss: 1.450, Global test accuracy: 51.67
Round   8, Train loss: 1.266, Test loss: 1.224, Test accuracy: 55.61
Round   8, Global train loss: 1.266, Global test loss: 1.408, Global test accuracy: 52.92
Round   9, Train loss: 1.230, Test loss: 1.220, Test accuracy: 56.43
Round   9, Global train loss: 1.230, Global test loss: 1.385, Global test accuracy: 54.10
Round  10, Train loss: 1.313, Test loss: 1.210, Test accuracy: 56.46
Round  10, Global train loss: 1.313, Global test loss: 1.451, Global test accuracy: 52.71
Round  11, Train loss: 1.214, Test loss: 1.213, Test accuracy: 56.63
Round  11, Global train loss: 1.214, Global test loss: 1.463, Global test accuracy: 51.73
Round  12, Train loss: 1.105, Test loss: 1.223, Test accuracy: 56.36
Round  12, Global train loss: 1.105, Global test loss: 1.533, Global test accuracy: 49.11
Round  13, Train loss: 1.197, Test loss: 1.251, Test accuracy: 55.22
Round  13, Global train loss: 1.197, Global test loss: 1.550, Global test accuracy: 48.39
Round  14, Train loss: 1.243, Test loss: 1.275, Test accuracy: 55.09
Round  14, Global train loss: 1.243, Global test loss: 1.527, Global test accuracy: 50.50
Round  15, Train loss: 1.031, Test loss: 1.287, Test accuracy: 54.67
Round  15, Global train loss: 1.031, Global test loss: 1.467, Global test accuracy: 51.40
Round  16, Train loss: 1.066, Test loss: 1.325, Test accuracy: 53.92
Round  16, Global train loss: 1.066, Global test loss: 1.535, Global test accuracy: 50.67
Round  17, Train loss: 0.925, Test loss: 1.315, Test accuracy: 54.40
Round  17, Global train loss: 0.925, Global test loss: 1.573, Global test accuracy: 48.88
Round  18, Train loss: 0.919, Test loss: 1.332, Test accuracy: 54.52
Round  18, Global train loss: 0.919, Global test loss: 1.486, Global test accuracy: 52.01
Round  19, Train loss: 0.966, Test loss: 1.337, Test accuracy: 54.73
Round  19, Global train loss: 0.966, Global test loss: 1.515, Global test accuracy: 50.29
Round  20, Train loss: 1.034, Test loss: 1.353, Test accuracy: 55.68
Round  20, Global train loss: 1.034, Global test loss: 1.473, Global test accuracy: 51.81
Round  21, Train loss: 0.983, Test loss: 1.378, Test accuracy: 55.23
Round  21, Global train loss: 0.983, Global test loss: 1.507, Global test accuracy: 51.43
Round  22, Train loss: 0.841, Test loss: 1.422, Test accuracy: 54.54
Round  22, Global train loss: 0.841, Global test loss: 1.438, Global test accuracy: 53.14
Round  23, Train loss: 0.843, Test loss: 1.452, Test accuracy: 54.36
Round  23, Global train loss: 0.843, Global test loss: 1.429, Global test accuracy: 55.23
Round  24, Train loss: 0.844, Test loss: 1.465, Test accuracy: 54.78
Round  24, Global train loss: 0.844, Global test loss: 1.663, Global test accuracy: 48.84
Round  25, Train loss: 0.870, Test loss: 1.469, Test accuracy: 54.88
Round  25, Global train loss: 0.870, Global test loss: 1.532, Global test accuracy: 51.71
Round  26, Train loss: 0.676, Test loss: 1.490, Test accuracy: 54.91
Round  26, Global train loss: 0.676, Global test loss: 1.482, Global test accuracy: 55.56
Round  27, Train loss: 0.776, Test loss: 1.497, Test accuracy: 55.20
Round  27, Global train loss: 0.776, Global test loss: 1.751, Global test accuracy: 49.09
Round  28, Train loss: 0.691, Test loss: 1.516, Test accuracy: 55.13
Round  28, Global train loss: 0.691, Global test loss: 1.598, Global test accuracy: 52.04
Round  29, Train loss: 0.668, Test loss: 1.519, Test accuracy: 54.97
Round  29, Global train loss: 0.668, Global test loss: 1.570, Global test accuracy: 53.66
Round  30, Train loss: 0.804, Test loss: 1.547, Test accuracy: 54.87
Round  30, Global train loss: 0.804, Global test loss: 1.649, Global test accuracy: 51.78
Round  31, Train loss: 0.739, Test loss: 1.547, Test accuracy: 54.85
Round  31, Global train loss: 0.739, Global test loss: 1.452, Global test accuracy: 54.44
Round  32, Train loss: 0.571, Test loss: 1.568, Test accuracy: 54.56
Round  32, Global train loss: 0.571, Global test loss: 1.489, Global test accuracy: 55.08
Round  33, Train loss: 0.816, Test loss: 1.585, Test accuracy: 54.72
Round  33, Global train loss: 0.816, Global test loss: 1.648, Global test accuracy: 49.62
Round  34, Train loss: 0.796, Test loss: 1.600, Test accuracy: 54.57
Round  34, Global train loss: 0.796, Global test loss: 1.624, Global test accuracy: 49.86
Round  35, Train loss: 0.649, Test loss: 1.626, Test accuracy: 54.62
Round  35, Global train loss: 0.649, Global test loss: 1.593, Global test accuracy: 52.72
Round  36, Train loss: 0.750, Test loss: 1.641, Test accuracy: 54.82
Round  36, Global train loss: 0.750, Global test loss: 1.569, Global test accuracy: 52.75
Round  37, Train loss: 0.603, Test loss: 1.631, Test accuracy: 55.42
Round  37, Global train loss: 0.603, Global test loss: 1.592, Global test accuracy: 55.19
Round  38, Train loss: 0.652, Test loss: 1.642, Test accuracy: 55.10
Round  38, Global train loss: 0.652, Global test loss: 1.707, Global test accuracy: 51.24
Round  39, Train loss: 0.465, Test loss: 1.651, Test accuracy: 55.24
Round  39, Global train loss: 0.465, Global test loss: 1.851, Global test accuracy: 53.73
Round  40, Train loss: 0.616, Test loss: 1.646, Test accuracy: 55.38
Round  40, Global train loss: 0.616, Global test loss: 1.609, Global test accuracy: 54.07
Round  41, Train loss: 0.670, Test loss: 1.661, Test accuracy: 55.53
Round  41, Global train loss: 0.670, Global test loss: 1.834, Global test accuracy: 49.42
Round  42, Train loss: 0.641, Test loss: 1.658, Test accuracy: 55.67
Round  42, Global train loss: 0.641, Global test loss: 1.607, Global test accuracy: 54.13
Round  43, Train loss: 0.602, Test loss: 1.673, Test accuracy: 55.16
Round  43, Global train loss: 0.602, Global test loss: 1.750, Global test accuracy: 52.62
Round  44, Train loss: 0.704, Test loss: 1.679, Test accuracy: 55.08
Round  44, Global train loss: 0.704, Global test loss: 1.811, Global test accuracy: 49.42
Round  45, Train loss: 0.710, Test loss: 1.699, Test accuracy: 55.76
Round  45, Global train loss: 0.710, Global test loss: 1.795, Global test accuracy: 49.27
Round  46, Train loss: 0.640, Test loss: 1.718, Test accuracy: 55.53
Round  46, Global train loss: 0.640, Global test loss: 1.669, Global test accuracy: 50.03
Round  47, Train loss: 0.541, Test loss: 1.724, Test accuracy: 55.52
Round  47, Global train loss: 0.541, Global test loss: 1.798, Global test accuracy: 51.42
Round  48, Train loss: 0.693, Test loss: 1.774, Test accuracy: 54.91
Round  48, Global train loss: 0.693, Global test loss: 1.710, Global test accuracy: 49.63
Round  49, Train loss: 0.561, Test loss: 1.761, Test accuracy: 55.03
Round  49, Global train loss: 0.561, Global test loss: 1.836, Global test accuracy: 48.92
Round  50, Train loss: 0.686, Test loss: 1.782, Test accuracy: 54.98
Round  50, Global train loss: 0.686, Global test loss: 1.779, Global test accuracy: 49.31
Round  51, Train loss: 0.561, Test loss: 1.777, Test accuracy: 55.42
Round  51, Global train loss: 0.561, Global test loss: 1.854, Global test accuracy: 49.40
Round  52, Train loss: 0.486, Test loss: 1.773, Test accuracy: 55.61
Round  52, Global train loss: 0.486, Global test loss: 1.680, Global test accuracy: 54.72
Round  53, Train loss: 0.455, Test loss: 1.789, Test accuracy: 55.38
Round  53, Global train loss: 0.455, Global test loss: 1.642, Global test accuracy: 54.23
Round  54, Train loss: 0.449, Test loss: 1.762, Test accuracy: 55.83
Round  54, Global train loss: 0.449, Global test loss: 1.658, Global test accuracy: 56.13
Round  55, Train loss: 0.472, Test loss: 1.769, Test accuracy: 55.92
Round  55, Global train loss: 0.472, Global test loss: 1.704, Global test accuracy: 54.29
Round  56, Train loss: 0.541, Test loss: 1.794, Test accuracy: 55.36
Round  56, Global train loss: 0.541, Global test loss: 1.632, Global test accuracy: 54.37
Round  57, Train loss: 0.592, Test loss: 1.779, Test accuracy: 55.54
Round  57, Global train loss: 0.592, Global test loss: 1.593, Global test accuracy: 53.41
Round  58, Train loss: 0.544, Test loss: 1.790, Test accuracy: 55.38
Round  58, Global train loss: 0.544, Global test loss: 1.654, Global test accuracy: 51.12
Round  59, Train loss: 0.525, Test loss: 1.794, Test accuracy: 55.16
Round  59, Global train loss: 0.525, Global test loss: 1.845, Global test accuracy: 49.90
Round  60, Train loss: 0.496, Test loss: 1.806, Test accuracy: 55.26
Round  60, Global train loss: 0.496, Global test loss: 1.963, Global test accuracy: 47.88
Round  61, Train loss: 0.585, Test loss: 1.814, Test accuracy: 55.62
Round  61, Global train loss: 0.585, Global test loss: 1.829, Global test accuracy: 50.67
Round  62, Train loss: 0.490, Test loss: 1.843, Test accuracy: 55.33
Round  62, Global train loss: 0.490, Global test loss: 1.924, Global test accuracy: 48.72
Round  63, Train loss: 0.482, Test loss: 1.804, Test accuracy: 55.87
Round  63, Global train loss: 0.482, Global test loss: 1.694, Global test accuracy: 52.71
Round  64, Train loss: 0.474, Test loss: 1.826, Test accuracy: 56.27
Round  64, Global train loss: 0.474, Global test loss: 1.962, Global test accuracy: 51.17
Round  65, Train loss: 0.553, Test loss: 1.859, Test accuracy: 55.89
Round  65, Global train loss: 0.553, Global test loss: 1.920, Global test accuracy: 51.38
Round  66, Train loss: 0.477, Test loss: 1.876, Test accuracy: 56.08
Round  66, Global train loss: 0.477, Global test loss: 1.878, Global test accuracy: 52.92
Round  67, Train loss: 0.589, Test loss: 1.895, Test accuracy: 55.84
Round  67, Global train loss: 0.589, Global test loss: 1.804, Global test accuracy: 50.44
Round  68, Train loss: 0.459, Test loss: 1.886, Test accuracy: 55.92
Round  68, Global train loss: 0.459, Global test loss: 1.920, Global test accuracy: 50.76
Round  69, Train loss: 0.521, Test loss: 1.903, Test accuracy: 56.02
Round  69, Global train loss: 0.521, Global test loss: 1.736, Global test accuracy: 52.86
Round  70, Train loss: 0.468, Test loss: 1.888, Test accuracy: 56.59
Round  70, Global train loss: 0.468, Global test loss: 1.692, Global test accuracy: 53.77
Round  71, Train loss: 0.504, Test loss: 1.879, Test accuracy: 56.41
Round  71, Global train loss: 0.504, Global test loss: 1.754, Global test accuracy: 51.59
Round  72, Train loss: 0.520, Test loss: 1.873, Test accuracy: 56.37
Round  72, Global train loss: 0.520, Global test loss: 1.747, Global test accuracy: 52.27
Round  73, Train loss: 0.444, Test loss: 1.923, Test accuracy: 56.23
Round  73, Global train loss: 0.444, Global test loss: 1.934, Global test accuracy: 50.94
Round  74, Train loss: 0.467, Test loss: 1.941, Test accuracy: 55.77
Round  74, Global train loss: 0.467, Global test loss: 1.797, Global test accuracy: 52.47
Round  75, Train loss: 0.493, Test loss: 1.942, Test accuracy: 55.18
Round  75, Global train loss: 0.493, Global test loss: 1.871, Global test accuracy: 51.56
Round  76, Train loss: 0.479, Test loss: 1.962, Test accuracy: 55.09
Round  76, Global train loss: 0.479, Global test loss: 1.733, Global test accuracy: 53.53
Round  77, Train loss: 0.406, Test loss: 1.976, Test accuracy: 55.00
Round  77, Global train loss: 0.406, Global test loss: 1.878, Global test accuracy: 53.42
Round  78, Train loss: 0.490, Test loss: 1.965, Test accuracy: 54.77
Round  78, Global train loss: 0.490, Global test loss: 2.016, Global test accuracy: 49.32
Round  79, Train loss: 0.452, Test loss: 1.959, Test accuracy: 55.08
Round  79, Global train loss: 0.452, Global test loss: 1.988, Global test accuracy: 50.38
Round  80, Train loss: 0.322, Test loss: 1.967, Test accuracy: 56.02
Round  80, Global train loss: 0.322, Global test loss: 1.708, Global test accuracy: 57.41
Round  81, Train loss: 0.299, Test loss: 1.973, Test accuracy: 55.88
Round  81, Global train loss: 0.299, Global test loss: 1.690, Global test accuracy: 57.49
Round  82, Train loss: 0.285, Test loss: 1.979, Test accuracy: 56.04
Round  82, Global train loss: 0.285, Global test loss: 1.730, Global test accuracy: 57.90
Round  83, Train loss: 0.271, Test loss: 1.974, Test accuracy: 55.67
Round  83, Global train loss: 0.271, Global test loss: 1.739, Global test accuracy: 57.44
Round  84, Train loss: 0.257, Test loss: 1.985, Test accuracy: 56.39
Round  84, Global train loss: 0.257, Global test loss: 1.764, Global test accuracy: 58.12
Round  85, Train loss: 0.256, Test loss: 2.023, Test accuracy: 56.43
Round  85, Global train loss: 0.256, Global test loss: 1.751, Global test accuracy: 58.17
Round  86, Train loss: 0.248, Test loss: 1.976, Test accuracy: 56.26
Round  86, Global train loss: 0.248, Global test loss: 1.763, Global test accuracy: 58.13
Round  87, Train loss: 0.228, Test loss: 1.996, Test accuracy: 56.20
Round  87, Global train loss: 0.228, Global test loss: 1.798, Global test accuracy: 58.32
Round  88, Train loss: 0.235, Test loss: 2.011, Test accuracy: 56.02
Round  88, Global train loss: 0.235, Global test loss: 1.778, Global test accuracy: 58.31
Round  89, Train loss: 0.227, Test loss: 2.016, Test accuracy: 56.09
Round  89, Global train loss: 0.227, Global test loss: 1.826, Global test accuracy: 58.16
Round  90, Train loss: 0.471, Test loss: 2.031, Test accuracy: 56.18
Round  90, Global train loss: 0.471, Global test loss: 1.641, Global test accuracy: 56.61
Round  91, Train loss: 0.430, Test loss: 1.990, Test accuracy: 56.36
Round  91, Global train loss: 0.430, Global test loss: 1.659, Global test accuracy: 56.02
Round  92, Train loss: 0.420, Test loss: 2.014, Test accuracy: 56.44
Round  92, Global train loss: 0.420, Global test loss: 1.670, Global test accuracy: 55.46
Round  93, Train loss: 0.410, Test loss: 2.030, Test accuracy: 55.61
Round  93, Global train loss: 0.410, Global test loss: 1.685, Global test accuracy: 55.57
Round  94, Train loss: 0.404, Test loss: 2.059, Test accuracy: 56.10
Round  94, Global train loss: 0.404, Global test loss: 1.692, Global test accuracy: 54.77
Round  95, Train loss: 0.404, Test loss: 2.043, Test accuracy: 55.72
Round  95, Global train loss: 0.404, Global test loss: 1.687, Global test accuracy: 55.97
Round  96, Train loss: 0.393, Test loss: 2.053, Test accuracy: 55.68
Round  96, Global train loss: 0.393, Global test loss: 1.712, Global test accuracy: 55.06
Round  97, Train loss: 0.394, Test loss: 2.092, Test accuracy: 55.32
Round  97, Global train loss: 0.394, Global test loss: 1.700, Global test accuracy: 55.40
Round  98, Train loss: 0.384, Test loss: 2.119, Test accuracy: 54.86
Round  98, Global train loss: 0.384, Global test loss: 1.734, Global test accuracy: 54.84
Round  99, Train loss: 0.387, Test loss: 2.072, Test accuracy: 55.41
Round  99, Global train loss: 0.387, Global test loss: 1.725, Global test accuracy: 54.70
Final Round, Train loss: 0.260, Test loss: 2.323, Test accuracy: 55.80
Final Round, Global train loss: 0.260, Global test loss: 1.725, Global test accuracy: 54.70
Average accuracy final 10 rounds: 55.7675
Average global accuracy final 10 rounds: 55.43833333333333
2798.26695227623
[2.985358715057373, 5.737170696258545, 8.092752695083618, 10.440669059753418, 12.790587902069092, 15.143006086349487, 17.497902393341064, 19.839088678359985, 22.180476427078247, 24.522122383117676, 26.872764110565186, 29.237544536590576, 31.581218242645264, 33.93695402145386, 36.288733959198, 38.64624261856079, 40.999112606048584, 43.3497838973999, 45.710816860198975, 48.07179021835327, 50.42504096031189, 52.772693157196045, 55.12601709365845, 57.481303453445435, 59.83533596992493, 62.19095253944397, 64.54586791992188, 66.89183020591736, 69.24058842658997, 71.59395146369934, 73.93861174583435, 76.28249454498291, 78.62648701667786, 80.97544598579407, 83.30952191352844, 85.65212345123291, 88.0055832862854, 90.34138917922974, 92.692706823349, 95.03291535377502, 97.37568402290344, 99.72089123725891, 102.0680627822876, 104.4214220046997, 106.76530122756958, 109.11035585403442, 111.44189167022705, 113.77334880828857, 116.10207772254944, 118.44922018051147, 120.79901766777039, 123.12941193580627, 125.45924234390259, 127.78536748886108, 130.11240077018738, 132.43775725364685, 134.76611590385437, 137.09451460838318, 139.42450404167175, 141.7598521709442, 144.09379172325134, 146.43125081062317, 148.76593923568726, 151.11951875686646, 153.4547507762909, 155.78511452674866, 158.11750173568726, 160.46326851844788, 162.79622864723206, 165.12897872924805, 167.46775674819946, 169.79842233657837, 172.1321702003479, 174.46636509895325, 176.80039715766907, 179.12909054756165, 181.47602343559265, 183.8225405216217, 186.15669012069702, 188.48955607414246, 190.82504725456238, 193.15828251838684, 195.4933693408966, 197.8257761001587, 200.15952968597412, 202.4965238571167, 204.83025312423706, 207.16440773010254, 209.49951839447021, 211.83384561538696, 214.16596961021423, 216.49933075904846, 218.83781671524048, 221.17730736732483, 223.5141475200653, 225.84599685668945, 228.1785340309143, 230.51365160942078, 232.85262322425842, 235.19010472297668, 239.08060765266418]
[39.4, 47.03333333333333, 50.0, 51.96666666666667, 53.68333333333333, 54.175, 54.96666666666667, 56.833333333333336, 55.608333333333334, 56.43333333333333, 56.458333333333336, 56.63333333333333, 56.358333333333334, 55.21666666666667, 55.09166666666667, 54.666666666666664, 53.925, 54.4, 54.525, 54.725, 55.68333333333333, 55.225, 54.541666666666664, 54.358333333333334, 54.78333333333333, 54.875, 54.90833333333333, 55.2, 55.13333333333333, 54.96666666666667, 54.86666666666667, 54.85, 54.55833333333333, 54.71666666666667, 54.56666666666667, 54.625, 54.81666666666667, 55.416666666666664, 55.1, 55.24166666666667, 55.375, 55.53333333333333, 55.675, 55.15833333333333, 55.083333333333336, 55.75833333333333, 55.53333333333333, 55.516666666666666, 54.90833333333333, 55.03333333333333, 54.983333333333334, 55.425, 55.608333333333334, 55.38333333333333, 55.825, 55.925, 55.358333333333334, 55.541666666666664, 55.375, 55.15833333333333, 55.25833333333333, 55.625, 55.325, 55.86666666666667, 56.275, 55.891666666666666, 56.083333333333336, 55.84166666666667, 55.916666666666664, 56.016666666666666, 56.59166666666667, 56.40833333333333, 56.36666666666667, 56.233333333333334, 55.775, 55.18333333333333, 55.09166666666667, 55.0, 54.766666666666666, 55.075, 56.025, 55.88333333333333, 56.041666666666664, 55.666666666666664, 56.391666666666666, 56.43333333333333, 56.25833333333333, 56.2, 56.025, 56.09166666666667, 56.18333333333333, 56.358333333333334, 56.44166666666667, 55.608333333333334, 56.1, 55.71666666666667, 55.68333333333333, 55.31666666666667, 54.858333333333334, 55.40833333333333, 55.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.765, Test loss: 1.531, Test accuracy: 38.16
Round   0, Global train loss: 1.765, Global test loss: 2.133, Global test accuracy: 20.37
Round   1, Train loss: 1.624, Test loss: 1.419, Test accuracy: 45.77
Round   1, Global train loss: 1.624, Global test loss: 1.890, Global test accuracy: 33.02
Round   2, Train loss: 1.540, Test loss: 1.338, Test accuracy: 49.76
Round   2, Global train loss: 1.540, Global test loss: 1.739, Global test accuracy: 39.67
Round   3, Train loss: 1.479, Test loss: 1.285, Test accuracy: 53.38
Round   3, Global train loss: 1.479, Global test loss: 1.643, Global test accuracy: 44.03
Round   4, Train loss: 1.432, Test loss: 1.260, Test accuracy: 54.02
Round   4, Global train loss: 1.432, Global test loss: 1.560, Global test accuracy: 46.96
Round   5, Train loss: 1.387, Test loss: 1.228, Test accuracy: 55.53
Round   5, Global train loss: 1.387, Global test loss: 1.497, Global test accuracy: 49.66
Round   6, Train loss: 1.343, Test loss: 1.221, Test accuracy: 56.17
Round   6, Global train loss: 1.343, Global test loss: 1.462, Global test accuracy: 50.91
Round   7, Train loss: 1.305, Test loss: 1.187, Test accuracy: 57.08
Round   7, Global train loss: 1.305, Global test loss: 1.417, Global test accuracy: 52.29
Round   8, Train loss: 1.267, Test loss: 1.234, Test accuracy: 55.73
Round   8, Global train loss: 1.267, Global test loss: 1.385, Global test accuracy: 54.07
Round   9, Train loss: 1.225, Test loss: 1.200, Test accuracy: 56.88
Round   9, Global train loss: 1.225, Global test loss: 1.346, Global test accuracy: 55.42
Round  10, Train loss: 1.142, Test loss: 1.218, Test accuracy: 56.04
Round  10, Global train loss: 1.142, Global test loss: 1.338, Global test accuracy: 55.17
Round  11, Train loss: 1.188, Test loss: 1.217, Test accuracy: 56.67
Round  11, Global train loss: 1.188, Global test loss: 1.359, Global test accuracy: 54.38
Round  12, Train loss: 1.162, Test loss: 1.205, Test accuracy: 56.86
Round  12, Global train loss: 1.162, Global test loss: 1.457, Global test accuracy: 51.27
Round  13, Train loss: 1.310, Test loss: 1.217, Test accuracy: 56.79
Round  13, Global train loss: 1.310, Global test loss: 1.575, Global test accuracy: 48.31
Round  14, Train loss: 1.128, Test loss: 1.251, Test accuracy: 56.49
Round  14, Global train loss: 1.128, Global test loss: 1.445, Global test accuracy: 53.58
Round  15, Train loss: 1.065, Test loss: 1.264, Test accuracy: 56.32
Round  15, Global train loss: 1.065, Global test loss: 1.441, Global test accuracy: 52.67
Round  16, Train loss: 1.041, Test loss: 1.281, Test accuracy: 56.37
Round  16, Global train loss: 1.041, Global test loss: 1.466, Global test accuracy: 51.09
Round  17, Train loss: 1.099, Test loss: 1.290, Test accuracy: 56.18
Round  17, Global train loss: 1.099, Global test loss: 1.618, Global test accuracy: 46.61
Round  18, Train loss: 0.899, Test loss: 1.305, Test accuracy: 56.00
Round  18, Global train loss: 0.899, Global test loss: 1.452, Global test accuracy: 53.62
Round  19, Train loss: 0.774, Test loss: 1.334, Test accuracy: 55.62
Round  19, Global train loss: 0.774, Global test loss: 1.374, Global test accuracy: 55.01
Round  20, Train loss: 1.061, Test loss: 1.375, Test accuracy: 55.26
Round  20, Global train loss: 1.061, Global test loss: 1.452, Global test accuracy: 53.08
Round  21, Train loss: 0.864, Test loss: 1.381, Test accuracy: 55.45
Round  21, Global train loss: 0.864, Global test loss: 1.394, Global test accuracy: 55.52
Round  22, Train loss: 0.989, Test loss: 1.420, Test accuracy: 54.92
Round  22, Global train loss: 0.989, Global test loss: 1.505, Global test accuracy: 51.88
Round  23, Train loss: 0.843, Test loss: 1.439, Test accuracy: 55.35
Round  23, Global train loss: 0.843, Global test loss: 1.440, Global test accuracy: 55.53
Round  24, Train loss: 0.926, Test loss: 1.474, Test accuracy: 55.11
Round  24, Global train loss: 0.926, Global test loss: 1.634, Global test accuracy: 49.55
Round  25, Train loss: 0.782, Test loss: 1.501, Test accuracy: 54.89
Round  25, Global train loss: 0.782, Global test loss: 1.494, Global test accuracy: 54.31
Round  26, Train loss: 0.741, Test loss: 1.519, Test accuracy: 54.52
Round  26, Global train loss: 0.741, Global test loss: 1.493, Global test accuracy: 54.15
Round  27, Train loss: 0.673, Test loss: 1.514, Test accuracy: 54.95
Round  27, Global train loss: 0.673, Global test loss: 1.692, Global test accuracy: 51.52
Round  28, Train loss: 0.773, Test loss: 1.520, Test accuracy: 55.23
Round  28, Global train loss: 0.773, Global test loss: 1.592, Global test accuracy: 51.85
Round  29, Train loss: 0.895, Test loss: 1.544, Test accuracy: 55.08
Round  29, Global train loss: 0.895, Global test loss: 1.676, Global test accuracy: 48.12
Round  30, Train loss: 0.841, Test loss: 1.584, Test accuracy: 54.99
Round  30, Global train loss: 0.841, Global test loss: 1.709, Global test accuracy: 48.70
Round  31, Train loss: 0.775, Test loss: 1.602, Test accuracy: 55.21
Round  31, Global train loss: 0.775, Global test loss: 1.538, Global test accuracy: 53.83
Round  32, Train loss: 0.700, Test loss: 1.635, Test accuracy: 54.48
Round  32, Global train loss: 0.700, Global test loss: 1.635, Global test accuracy: 51.64
Round  33, Train loss: 0.662, Test loss: 1.640, Test accuracy: 54.81
Round  33, Global train loss: 0.662, Global test loss: 1.672, Global test accuracy: 50.78
Round  34, Train loss: 0.725, Test loss: 1.668, Test accuracy: 54.33
Round  34, Global train loss: 0.725, Global test loss: 1.592, Global test accuracy: 52.48
Round  35, Train loss: 0.670, Test loss: 1.659, Test accuracy: 54.73
Round  35, Global train loss: 0.670, Global test loss: 1.598, Global test accuracy: 52.30
Round  36, Train loss: 0.649, Test loss: 1.632, Test accuracy: 55.33
Round  36, Global train loss: 0.649, Global test loss: 1.572, Global test accuracy: 55.32
Round  37, Train loss: 0.704, Test loss: 1.629, Test accuracy: 55.71
Round  37, Global train loss: 0.704, Global test loss: 1.622, Global test accuracy: 53.19
Round  38, Train loss: 0.695, Test loss: 1.672, Test accuracy: 55.58
Round  38, Global train loss: 0.695, Global test loss: 1.734, Global test accuracy: 49.46
Round  39, Train loss: 0.711, Test loss: 1.687, Test accuracy: 55.29
Round  39, Global train loss: 0.711, Global test loss: 1.814, Global test accuracy: 49.21
Round  40, Train loss: 0.604, Test loss: 1.684, Test accuracy: 54.98
Round  40, Global train loss: 0.604, Global test loss: 1.722, Global test accuracy: 50.98
Round  41, Train loss: 0.515, Test loss: 1.717, Test accuracy: 54.89
Round  41, Global train loss: 0.515, Global test loss: 1.825, Global test accuracy: 52.19
Round  42, Train loss: 0.684, Test loss: 1.714, Test accuracy: 55.16
Round  42, Global train loss: 0.684, Global test loss: 1.616, Global test accuracy: 53.23
Round  43, Train loss: 0.575, Test loss: 1.711, Test accuracy: 55.49
Round  43, Global train loss: 0.575, Global test loss: 1.840, Global test accuracy: 52.26
Round  44, Train loss: 0.633, Test loss: 1.759, Test accuracy: 54.18
Round  44, Global train loss: 0.633, Global test loss: 1.768, Global test accuracy: 51.68
Round  45, Train loss: 0.556, Test loss: 1.775, Test accuracy: 54.81
Round  45, Global train loss: 0.556, Global test loss: 1.711, Global test accuracy: 53.41
Round  46, Train loss: 0.647, Test loss: 1.802, Test accuracy: 55.16
Round  46, Global train loss: 0.647, Global test loss: 1.644, Global test accuracy: 51.63
Round  47, Train loss: 0.644, Test loss: 1.800, Test accuracy: 55.96
Round  47, Global train loss: 0.644, Global test loss: 1.929, Global test accuracy: 48.15
Round  48, Train loss: 0.589, Test loss: 1.805, Test accuracy: 55.69
Round  48, Global train loss: 0.589, Global test loss: 1.681, Global test accuracy: 52.23
Round  49, Train loss: 0.619, Test loss: 1.790, Test accuracy: 55.06
Round  49, Global train loss: 0.619, Global test loss: 1.823, Global test accuracy: 48.04
Round  50, Train loss: 0.534, Test loss: 1.772, Test accuracy: 55.06
Round  50, Global train loss: 0.534, Global test loss: 1.719, Global test accuracy: 53.44
Round  51, Train loss: 0.581, Test loss: 1.774, Test accuracy: 54.93
Round  51, Global train loss: 0.581, Global test loss: 1.758, Global test accuracy: 50.46
Round  52, Train loss: 0.579, Test loss: 1.788, Test accuracy: 54.70
Round  52, Global train loss: 0.579, Global test loss: 1.755, Global test accuracy: 51.43
Round  53, Train loss: 0.508, Test loss: 1.807, Test accuracy: 55.17
Round  53, Global train loss: 0.508, Global test loss: 1.740, Global test accuracy: 51.06
Round  54, Train loss: 0.530, Test loss: 1.824, Test accuracy: 55.14
Round  54, Global train loss: 0.530, Global test loss: 1.652, Global test accuracy: 53.42
Round  55, Train loss: 0.643, Test loss: 1.851, Test accuracy: 54.97
Round  55, Global train loss: 0.643, Global test loss: 1.866, Global test accuracy: 48.40
Round  56, Train loss: 0.441, Test loss: 1.853, Test accuracy: 54.95
Round  56, Global train loss: 0.441, Global test loss: 1.638, Global test accuracy: 56.16
Round  57, Train loss: 0.421, Test loss: 1.852, Test accuracy: 55.42
Round  57, Global train loss: 0.421, Global test loss: 1.595, Global test accuracy: 57.32
Round  58, Train loss: 0.470, Test loss: 1.860, Test accuracy: 54.75
Round  58, Global train loss: 0.470, Global test loss: 1.564, Global test accuracy: 56.18
Round  59, Train loss: 0.473, Test loss: 1.865, Test accuracy: 55.06
Round  59, Global train loss: 0.473, Global test loss: 1.750, Global test accuracy: 54.87
Round  60, Train loss: 0.521, Test loss: 1.881, Test accuracy: 54.97
Round  60, Global train loss: 0.521, Global test loss: 1.805, Global test accuracy: 51.48
Round  61, Train loss: 0.478, Test loss: 1.880, Test accuracy: 55.15
Round  61, Global train loss: 0.478, Global test loss: 1.876, Global test accuracy: 52.77
Round  62, Train loss: 0.491, Test loss: 1.865, Test accuracy: 55.60
Round  62, Global train loss: 0.491, Global test loss: 1.792, Global test accuracy: 52.17
Round  63, Train loss: 0.468, Test loss: 1.875, Test accuracy: 55.86
Round  63, Global train loss: 0.468, Global test loss: 1.753, Global test accuracy: 52.85
Round  64, Train loss: 0.564, Test loss: 1.900, Test accuracy: 54.83
Round  64, Global train loss: 0.564, Global test loss: 1.945, Global test accuracy: 48.48
Round  65, Train loss: 0.511, Test loss: 1.938, Test accuracy: 54.75
Round  65, Global train loss: 0.511, Global test loss: 1.893, Global test accuracy: 52.22
Round  66, Train loss: 0.514, Test loss: 1.942, Test accuracy: 55.11
Round  66, Global train loss: 0.514, Global test loss: 1.892, Global test accuracy: 50.30
Round  67, Train loss: 0.528, Test loss: 1.914, Test accuracy: 55.59
Round  67, Global train loss: 0.528, Global test loss: 1.745, Global test accuracy: 52.44
Round  68, Train loss: 0.368, Test loss: 1.964, Test accuracy: 55.06
Round  68, Global train loss: 0.368, Global test loss: 1.825, Global test accuracy: 54.07
Round  69, Train loss: 0.552, Test loss: 1.947, Test accuracy: 55.67
Round  69, Global train loss: 0.552, Global test loss: 1.732, Global test accuracy: 52.28
Round  70, Train loss: 0.444, Test loss: 1.933, Test accuracy: 55.46
Round  70, Global train loss: 0.444, Global test loss: 1.742, Global test accuracy: 54.51
Round  71, Train loss: 0.337, Test loss: 1.905, Test accuracy: 55.77
Round  71, Global train loss: 0.337, Global test loss: 1.752, Global test accuracy: 57.73
Round  72, Train loss: 0.452, Test loss: 1.904, Test accuracy: 56.32
Round  72, Global train loss: 0.452, Global test loss: 1.712, Global test accuracy: 54.17
Round  73, Train loss: 0.375, Test loss: 1.909, Test accuracy: 56.59
Round  73, Global train loss: 0.375, Global test loss: 1.910, Global test accuracy: 54.70
Round  74, Train loss: 0.508, Test loss: 1.906, Test accuracy: 57.08
Round  74, Global train loss: 0.508, Global test loss: 1.737, Global test accuracy: 54.22
Round  75, Train loss: 0.405, Test loss: 1.934, Test accuracy: 56.88
Round  75, Global train loss: 0.405, Global test loss: 1.853, Global test accuracy: 54.39
Round  76, Train loss: 0.473, Test loss: 1.934, Test accuracy: 57.10
Round  76, Global train loss: 0.473, Global test loss: 1.736, Global test accuracy: 54.05
Round  77, Train loss: 0.361, Test loss: 1.952, Test accuracy: 56.88
Round  77, Global train loss: 0.361, Global test loss: 1.806, Global test accuracy: 55.13
Round  78, Train loss: 0.481, Test loss: 1.935, Test accuracy: 56.57
Round  78, Global train loss: 0.481, Global test loss: 2.092, Global test accuracy: 50.80
Round  79, Train loss: 0.416, Test loss: 1.951, Test accuracy: 56.03
Round  79, Global train loss: 0.416, Global test loss: 1.877, Global test accuracy: 52.79
Round  80, Train loss: 0.310, Test loss: 1.973, Test accuracy: 55.83
Round  80, Global train loss: 0.310, Global test loss: 1.754, Global test accuracy: 57.63
Round  81, Train loss: 0.275, Test loss: 2.016, Test accuracy: 56.08
Round  81, Global train loss: 0.275, Global test loss: 1.764, Global test accuracy: 58.59
Round  82, Train loss: 0.265, Test loss: 2.009, Test accuracy: 56.45
Round  82, Global train loss: 0.265, Global test loss: 1.802, Global test accuracy: 58.40
Round  83, Train loss: 0.257, Test loss: 2.032, Test accuracy: 56.18
Round  83, Global train loss: 0.257, Global test loss: 1.761, Global test accuracy: 58.77
Round  84, Train loss: 0.250, Test loss: 1.988, Test accuracy: 56.77
Round  84, Global train loss: 0.250, Global test loss: 1.798, Global test accuracy: 58.62
Round  85, Train loss: 0.245, Test loss: 2.022, Test accuracy: 56.49
Round  85, Global train loss: 0.245, Global test loss: 1.812, Global test accuracy: 58.73
Round  86, Train loss: 0.240, Test loss: 2.045, Test accuracy: 55.96
Round  86, Global train loss: 0.240, Global test loss: 1.797, Global test accuracy: 58.49
Round  87, Train loss: 0.237, Test loss: 2.018, Test accuracy: 56.62
Round  87, Global train loss: 0.237, Global test loss: 1.844, Global test accuracy: 58.34
Round  88, Train loss: 0.222, Test loss: 2.037, Test accuracy: 56.37
Round  88, Global train loss: 0.222, Global test loss: 1.819, Global test accuracy: 59.30
Round  89, Train loss: 0.224, Test loss: 2.037, Test accuracy: 56.40
Round  89, Global train loss: 0.224, Global test loss: 1.863, Global test accuracy: 58.97
Round  90, Train loss: 0.467, Test loss: 1.970, Test accuracy: 56.10
Round  90, Global train loss: 0.467, Global test loss: 1.648, Global test accuracy: 56.73
Round  91, Train loss: 0.420, Test loss: 2.026, Test accuracy: 56.40
Round  91, Global train loss: 0.420, Global test loss: 1.664, Global test accuracy: 56.75
Round  92, Train loss: 0.407, Test loss: 2.024, Test accuracy: 57.16
Round  92, Global train loss: 0.407, Global test loss: 1.685, Global test accuracy: 56.33
Round  93, Train loss: 0.402, Test loss: 2.015, Test accuracy: 56.85
Round  93, Global train loss: 0.402, Global test loss: 1.672, Global test accuracy: 56.81
Round  94, Train loss: 0.398, Test loss: 2.041, Test accuracy: 56.25
Round  94, Global train loss: 0.398, Global test loss: 1.693, Global test accuracy: 55.73
Round  95, Train loss: 0.388, Test loss: 2.087, Test accuracy: 55.17
Round  95, Global train loss: 0.388, Global test loss: 1.691, Global test accuracy: 56.41
Round  96, Train loss: 0.382, Test loss: 2.010, Test accuracy: 56.78
Round  96, Global train loss: 0.382, Global test loss: 1.699, Global test accuracy: 56.38
Round  97, Train loss: 0.382, Test loss: 2.107, Test accuracy: 55.72
Round  97, Global train loss: 0.382, Global test loss: 1.702, Global test accuracy: 56.12
Round  98, Train loss: 0.377, Test loss: 2.053, Test accuracy: 56.94
Round  98, Global train loss: 0.377, Global test loss: 1.712, Global test accuracy: 56.65
Round  99, Train loss: 0.375, Test loss: 2.071, Test accuracy: 56.07
Round  99, Global train loss: 0.375, Global test loss: 1.731, Global test accuracy: 56.01
Final Round, Train loss: 0.253, Test loss: 2.290, Test accuracy: 56.42
Final Round, Global train loss: 0.253, Global test loss: 1.731, Global test accuracy: 56.01
Average accuracy final 10 rounds: 56.343333333333334
Average global accuracy final 10 rounds: 56.39083333333333
5700.463495731354
[3.004777669906616, 5.764235496520996, 8.52823519706726, 11.30858325958252, 14.091938018798828, 16.89724373817444, 19.700336456298828, 22.10097050666809, 24.503934383392334, 26.924895524978638, 29.31438183784485, 31.697248220443726, 34.09033918380737, 36.47998762130737, 38.867958068847656, 41.25783085823059, 43.645439863204956, 46.03302812576294, 48.42108368873596, 50.81062650680542, 53.19307518005371, 60.31812763214111, 67.42593574523926, 74.59401154518127, 81.74506044387817, 88.88644075393677, 95.99455499649048, 103.11893129348755, 110.27137327194214, 116.98806095123291, 123.73357319831848, 130.45118260383606, 137.19023823738098, 143.93290257453918, 150.65172815322876, 157.3469979763031, 164.37897539138794, 171.42778897285461, 178.47190928459167, 185.5611231327057, 192.73279333114624, 199.82448482513428, 206.95797967910767, 214.0395872592926, 221.15093994140625, 228.25082898139954, 235.3183581829071, 242.3441801071167, 249.39328742027283, 256.59518122673035, 263.7579417228699, 270.9411840438843, 278.14896512031555, 285.30622005462646, 292.48650336265564, 299.6627848148346, 306.84377813339233, 314.0152921676636, 321.1150586605072, 328.2685673236847, 335.41958689689636, 342.5147428512573, 349.25956416130066, 355.9290065765381, 362.57576274871826, 369.2578499317169, 375.931512594223, 382.59028458595276, 389.2927372455597, 396.02740716934204, 402.7371988296509, 409.4614667892456, 416.1433298587799, 422.840859413147, 429.5411696434021, 436.23126888275146, 442.9152100086212, 449.62859416007996, 456.35807514190674, 463.02762269973755, 469.7061507701874, 476.39794659614563, 483.10555124282837, 489.8330557346344, 496.5548975467682, 503.24313378334045, 509.9589202404022, 516.705237865448, 523.4147303104401, 530.1402747631073, 536.8602211475372, 543.9993362426758, 550.4508240222931, 556.9445848464966, 563.4650013446808, 569.9684326648712, 576.5056354999542, 583.0271947383881, 589.9523482322693, 596.9634401798248, 600.9018230438232]
[38.15833333333333, 45.775, 49.75833333333333, 53.375, 54.016666666666666, 55.53333333333333, 56.175, 57.083333333333336, 55.725, 56.875, 56.041666666666664, 56.666666666666664, 56.858333333333334, 56.791666666666664, 56.49166666666667, 56.31666666666667, 56.36666666666667, 56.18333333333333, 56.0, 55.61666666666667, 55.25833333333333, 55.45, 54.925, 55.35, 55.108333333333334, 54.891666666666666, 54.516666666666666, 54.95, 55.233333333333334, 55.083333333333336, 54.99166666666667, 55.208333333333336, 54.475, 54.80833333333333, 54.325, 54.725, 55.325, 55.708333333333336, 55.575, 55.291666666666664, 54.975, 54.891666666666666, 55.15833333333333, 55.49166666666667, 54.18333333333333, 54.80833333333333, 55.15833333333333, 55.958333333333336, 55.69166666666667, 55.05833333333333, 55.05833333333333, 54.93333333333333, 54.7, 55.166666666666664, 55.141666666666666, 54.96666666666667, 54.95, 55.416666666666664, 54.75, 55.05833333333333, 54.96666666666667, 55.15, 55.6, 55.858333333333334, 54.825, 54.75, 55.108333333333334, 55.59166666666667, 55.05833333333333, 55.666666666666664, 55.458333333333336, 55.775, 56.31666666666667, 56.59166666666667, 57.083333333333336, 56.88333333333333, 57.1, 56.88333333333333, 56.56666666666667, 56.03333333333333, 55.825, 56.083333333333336, 56.45, 56.18333333333333, 56.775, 56.49166666666667, 55.958333333333336, 56.625, 56.36666666666667, 56.4, 56.1, 56.4, 57.15833333333333, 56.85, 56.25, 55.166666666666664, 56.78333333333333, 55.71666666666667, 56.94166666666667, 56.06666666666667, 56.416666666666664]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.894, Test loss: 1.820, Test accuracy: 25.18
Round   1, Train loss: 1.676, Test loss: 1.537, Test accuracy: 37.27
Round   2, Train loss: 1.584, Test loss: 1.427, Test accuracy: 42.99
Round   3, Train loss: 1.520, Test loss: 1.330, Test accuracy: 49.35
Round   4, Train loss: 1.475, Test loss: 1.282, Test accuracy: 52.52
Round   5, Train loss: 1.437, Test loss: 1.242, Test accuracy: 53.80
Round   6, Train loss: 1.410, Test loss: 1.185, Test accuracy: 58.01
Round   7, Train loss: 1.384, Test loss: 1.177, Test accuracy: 57.06
Round   8, Train loss: 1.362, Test loss: 1.163, Test accuracy: 58.07
Round   9, Train loss: 1.342, Test loss: 1.138, Test accuracy: 60.09
Round  10, Train loss: 1.316, Test loss: 1.124, Test accuracy: 60.07
Round  11, Train loss: 1.295, Test loss: 1.093, Test accuracy: 62.34
Round  12, Train loss: 1.275, Test loss: 1.083, Test accuracy: 62.77
Round  13, Train loss: 1.255, Test loss: 1.088, Test accuracy: 62.28
Round  14, Train loss: 1.239, Test loss: 1.070, Test accuracy: 62.92
Round  15, Train loss: 1.220, Test loss: 1.066, Test accuracy: 62.91
Round  16, Train loss: 1.201, Test loss: 1.069, Test accuracy: 62.56
Round  17, Train loss: 1.180, Test loss: 1.051, Test accuracy: 63.34
Round  18, Train loss: 1.163, Test loss: 1.034, Test accuracy: 64.78
Round  19, Train loss: 1.145, Test loss: 1.024, Test accuracy: 64.97
Round  20, Train loss: 1.167, Test loss: 1.039, Test accuracy: 63.73
Round  21, Train loss: 1.134, Test loss: 1.050, Test accuracy: 63.26
Round  22, Train loss: 1.260, Test loss: 1.059, Test accuracy: 63.07
Round  23, Train loss: 0.938, Test loss: 1.028, Test accuracy: 64.14
Round  24, Train loss: 1.163, Test loss: 1.045, Test accuracy: 63.11
Round  25, Train loss: 0.996, Test loss: 1.037, Test accuracy: 63.97
Round  26, Train loss: 1.144, Test loss: 1.054, Test accuracy: 63.67
Round  27, Train loss: 1.047, Test loss: 1.054, Test accuracy: 63.41
Round  28, Train loss: 0.998, Test loss: 1.050, Test accuracy: 63.08
Round  29, Train loss: 1.075, Test loss: 1.045, Test accuracy: 63.88
Round  30, Train loss: 1.037, Test loss: 1.041, Test accuracy: 63.58
Round  31, Train loss: 0.949, Test loss: 1.065, Test accuracy: 63.10
Round  32, Train loss: 0.975, Test loss: 1.053, Test accuracy: 63.75
Round  33, Train loss: 1.009, Test loss: 1.078, Test accuracy: 63.02
Round  34, Train loss: 0.852, Test loss: 1.063, Test accuracy: 63.17
Round  35, Train loss: 0.976, Test loss: 1.056, Test accuracy: 63.80
Round  36, Train loss: 0.937, Test loss: 1.088, Test accuracy: 62.77
Round  37, Train loss: 1.107, Test loss: 1.102, Test accuracy: 62.60
Round  38, Train loss: 0.955, Test loss: 1.097, Test accuracy: 62.73
Round  39, Train loss: 0.908, Test loss: 1.103, Test accuracy: 62.81
Round  40, Train loss: 0.850, Test loss: 1.103, Test accuracy: 62.74
Round  41, Train loss: 0.903, Test loss: 1.125, Test accuracy: 61.25
Round  42, Train loss: 0.912, Test loss: 1.103, Test accuracy: 62.43
Round  43, Train loss: 0.763, Test loss: 1.130, Test accuracy: 61.77
Round  44, Train loss: 0.832, Test loss: 1.125, Test accuracy: 61.87
Round  45, Train loss: 0.844, Test loss: 1.159, Test accuracy: 61.56
Round  46, Train loss: 0.832, Test loss: 1.156, Test accuracy: 61.38
Round  47, Train loss: 0.787, Test loss: 1.155, Test accuracy: 61.58
Round  48, Train loss: 0.861, Test loss: 1.201, Test accuracy: 60.55
Round  49, Train loss: 0.829, Test loss: 1.198, Test accuracy: 60.59
Round  50, Train loss: 0.757, Test loss: 1.175, Test accuracy: 61.10
Round  51, Train loss: 0.871, Test loss: 1.224, Test accuracy: 59.98
Round  52, Train loss: 0.840, Test loss: 1.192, Test accuracy: 60.88
Round  53, Train loss: 0.623, Test loss: 1.195, Test accuracy: 61.22
Round  54, Train loss: 0.884, Test loss: 1.206, Test accuracy: 60.88
Round  55, Train loss: 0.779, Test loss: 1.208, Test accuracy: 61.25
Round  56, Train loss: 0.846, Test loss: 1.222, Test accuracy: 60.79
Round  57, Train loss: 0.680, Test loss: 1.244, Test accuracy: 60.58
Round  58, Train loss: 0.778, Test loss: 1.235, Test accuracy: 60.54
Round  59, Train loss: 0.857, Test loss: 1.254, Test accuracy: 59.99
Round  60, Train loss: 0.711, Test loss: 1.281, Test accuracy: 59.30
Round  61, Train loss: 0.585, Test loss: 1.266, Test accuracy: 59.25
Round  62, Train loss: 0.802, Test loss: 1.281, Test accuracy: 60.10
Round  63, Train loss: 0.683, Test loss: 1.271, Test accuracy: 59.63
Round  64, Train loss: 0.752, Test loss: 1.332, Test accuracy: 58.16
Round  65, Train loss: 0.713, Test loss: 1.306, Test accuracy: 58.72
Round  66, Train loss: 0.791, Test loss: 1.321, Test accuracy: 58.43
Round  67, Train loss: 0.729, Test loss: 1.345, Test accuracy: 58.98
Round  68, Train loss: 0.584, Test loss: 1.345, Test accuracy: 58.62
Round  69, Train loss: 0.729, Test loss: 1.381, Test accuracy: 58.63
Round  70, Train loss: 0.640, Test loss: 1.331, Test accuracy: 58.79
Round  71, Train loss: 0.546, Test loss: 1.350, Test accuracy: 58.61
Round  72, Train loss: 0.743, Test loss: 1.394, Test accuracy: 58.06
Round  73, Train loss: 0.617, Test loss: 1.418, Test accuracy: 58.21
Round  74, Train loss: 0.681, Test loss: 1.358, Test accuracy: 58.27
Round  75, Train loss: 0.619, Test loss: 1.370, Test accuracy: 58.61
Round  76, Train loss: 0.655, Test loss: 1.368, Test accuracy: 58.86
Round  77, Train loss: 0.570, Test loss: 1.407, Test accuracy: 57.92
Round  78, Train loss: 0.680, Test loss: 1.413, Test accuracy: 58.14
Round  79, Train loss: 0.653, Test loss: 1.382, Test accuracy: 58.27
Round  80, Train loss: 0.478, Test loss: 1.354, Test accuracy: 58.99
Round  81, Train loss: 0.427, Test loss: 1.383, Test accuracy: 58.98
Round  82, Train loss: 0.425, Test loss: 1.408, Test accuracy: 58.60
Round  83, Train loss: 0.394, Test loss: 1.419, Test accuracy: 58.39
Round  84, Train loss: 0.388, Test loss: 1.437, Test accuracy: 58.25
Round  85, Train loss: 0.380, Test loss: 1.414, Test accuracy: 59.00
Round  86, Train loss: 0.374, Test loss: 1.425, Test accuracy: 58.45
Round  87, Train loss: 0.364, Test loss: 1.477, Test accuracy: 57.95
Round  88, Train loss: 0.361, Test loss: 1.479, Test accuracy: 57.93
Round  89, Train loss: 0.354, Test loss: 1.490, Test accuracy: 58.09
Round  90, Train loss: 0.602, Test loss: 1.476, Test accuracy: 57.38
Round  91, Train loss: 0.576, Test loss: 1.454, Test accuracy: 58.08
Round  92, Train loss: 0.563, Test loss: 1.483, Test accuracy: 57.72
Round  93, Train loss: 0.561, Test loss: 1.487, Test accuracy: 57.81
Round  94, Train loss: 0.547, Test loss: 1.488, Test accuracy: 57.54
Round  95, Train loss: 0.542, Test loss: 1.511, Test accuracy: 57.96
Round  96, Train loss: 0.537, Test loss: 1.471, Test accuracy: 58.32
Round  97, Train loss: 0.533, Test loss: 1.497, Test accuracy: 58.47
Round  98, Train loss: 0.528, Test loss: 1.517, Test accuracy: 57.92
Round  99, Train loss: 0.527, Test loss: 1.522, Test accuracy: 57.88
Final Round, Train loss: 0.498, Test loss: 1.526, Test accuracy: 57.95
Average accuracy final 10 rounds: 57.906666666666666
4510.246361494064
[2.8040857315063477, 5.317680835723877, 7.83203125, 10.3658287525177, 12.88180422782898, 15.403855800628662, 17.939149618148804, 20.454195022583008, 22.981729984283447, 25.513701915740967, 28.047149419784546, 30.589493989944458, 33.129902362823486, 35.67009997367859, 38.2088680267334, 40.7292742729187, 43.246729612350464, 45.76728057861328, 48.30648136138916, 50.853076457977295, 53.371952056884766, 58.71292448043823, 64.06592512130737, 69.40613889694214, 74.66848349571228, 79.92942023277283, 85.24051475524902, 90.11109256744385, 94.84761691093445, 99.60459113121033, 104.37558841705322, 109.18389415740967, 113.94908452033997, 118.77466249465942, 123.73768758773804, 128.72591757774353, 133.69590187072754, 138.6939799785614, 143.74378561973572, 148.80805015563965, 153.83030796051025, 158.89727091789246, 163.91989374160767, 168.98409795761108, 173.96568870544434, 179.02297163009644, 184.11720490455627, 189.16184854507446, 194.1985878944397, 199.24723935127258, 204.2395875453949, 209.28954672813416, 214.34589672088623, 219.3837673664093, 224.4270350933075, 229.51076912879944, 234.53094959259033, 239.51162981987, 244.4870524406433, 249.49519395828247, 254.49797987937927, 259.51892828941345, 264.49789476394653, 269.4861869812012, 274.5101375579834, 279.52369451522827, 284.5049657821655, 289.49586749076843, 294.4792323112488, 299.01060605049133, 303.59317207336426, 308.1404254436493, 312.56573820114136, 316.97535467147827, 321.3960711956024, 325.80699920654297, 330.19780564308167, 334.5961618423462, 339.0177752971649, 343.4178719520569, 348.1012854576111, 352.7880268096924, 357.49092650413513, 362.415105342865, 367.39887261390686, 372.15351486206055, 376.867360830307, 381.57405829429626, 386.2570970058441, 390.89941787719727, 395.8511309623718, 400.9614281654358, 406.14056611061096, 411.3011095523834, 416.44058108329773, 421.54421210289, 426.5891978740692, 431.5079004764557, 436.38802218437195, 441.2560844421387, 444.8212263584137]
[25.175, 37.266666666666666, 42.99166666666667, 49.35, 52.516666666666666, 53.8, 58.00833333333333, 57.05833333333333, 58.06666666666667, 60.09166666666667, 60.06666666666667, 62.34166666666667, 62.775, 62.28333333333333, 62.925, 62.90833333333333, 62.55833333333333, 63.34166666666667, 64.775, 64.96666666666667, 63.725, 63.25833333333333, 63.06666666666667, 64.14166666666667, 63.108333333333334, 63.96666666666667, 63.666666666666664, 63.40833333333333, 63.075, 63.875, 63.575, 63.1, 63.75, 63.025, 63.166666666666664, 63.8, 62.766666666666666, 62.6, 62.733333333333334, 62.80833333333333, 62.74166666666667, 61.25, 62.43333333333333, 61.766666666666666, 61.86666666666667, 61.55833333333333, 61.375, 61.583333333333336, 60.55, 60.59166666666667, 61.1, 59.983333333333334, 60.875, 61.21666666666667, 60.875, 61.25, 60.791666666666664, 60.583333333333336, 60.541666666666664, 59.99166666666667, 59.3, 59.25, 60.1, 59.63333333333333, 58.15833333333333, 58.71666666666667, 58.43333333333333, 58.975, 58.625, 58.63333333333333, 58.791666666666664, 58.608333333333334, 58.05833333333333, 58.208333333333336, 58.275, 58.608333333333334, 58.858333333333334, 57.916666666666664, 58.141666666666666, 58.266666666666666, 58.99166666666667, 58.983333333333334, 58.6, 58.391666666666666, 58.25, 59.0, 58.45, 57.95, 57.93333333333333, 58.09166666666667, 57.38333333333333, 58.075, 57.71666666666667, 57.80833333333333, 57.541666666666664, 57.958333333333336, 58.31666666666667, 58.46666666666667, 57.916666666666664, 57.88333333333333, 57.95]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 6, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.912, Test loss: 1.835, Test accuracy: 31.15
Round   1, Train loss: 1.669, Test loss: 1.514, Test accuracy: 40.71
Round   2, Train loss: 1.566, Test loss: 1.393, Test accuracy: 47.75
Round   3, Train loss: 1.508, Test loss: 1.314, Test accuracy: 51.34
Round   4, Train loss: 1.465, Test loss: 1.252, Test accuracy: 54.34
Round   5, Train loss: 1.434, Test loss: 1.216, Test accuracy: 56.36
Round   6, Train loss: 1.403, Test loss: 1.192, Test accuracy: 58.33
Round   7, Train loss: 1.378, Test loss: 1.173, Test accuracy: 59.76
Round   8, Train loss: 1.350, Test loss: 1.131, Test accuracy: 60.33
Round   9, Train loss: 1.325, Test loss: 1.121, Test accuracy: 60.82
Round  10, Train loss: 1.269, Test loss: 1.111, Test accuracy: 60.92
Round  11, Train loss: 1.292, Test loss: 1.111, Test accuracy: 61.42
Round  12, Train loss: 1.192, Test loss: 1.096, Test accuracy: 62.14
Round  13, Train loss: 1.224, Test loss: 1.083, Test accuracy: 62.76
Round  14, Train loss: 1.283, Test loss: 1.064, Test accuracy: 63.23
Round  15, Train loss: 1.355, Test loss: 1.045, Test accuracy: 63.66
Round  16, Train loss: 1.416, Test loss: 1.086, Test accuracy: 63.27
Round  17, Train loss: 1.103, Test loss: 1.050, Test accuracy: 64.17
Round  18, Train loss: 1.188, Test loss: 1.029, Test accuracy: 64.70
Round  19, Train loss: 1.349, Test loss: 1.047, Test accuracy: 65.40
Round  20, Train loss: 1.048, Test loss: 1.019, Test accuracy: 65.18
Round  21, Train loss: 1.134, Test loss: 1.017, Test accuracy: 65.70
Round  22, Train loss: 0.982, Test loss: 0.986, Test accuracy: 66.31
Round  23, Train loss: 1.195, Test loss: 0.996, Test accuracy: 66.34
Round  24, Train loss: 1.164, Test loss: 0.997, Test accuracy: 66.22
Round  25, Train loss: 1.036, Test loss: 0.988, Test accuracy: 66.40
Round  26, Train loss: 1.161, Test loss: 1.019, Test accuracy: 65.65
Round  27, Train loss: 0.943, Test loss: 0.976, Test accuracy: 66.47
Round  28, Train loss: 0.972, Test loss: 0.975, Test accuracy: 66.46
Round  29, Train loss: 1.058, Test loss: 0.993, Test accuracy: 65.97
Round  30, Train loss: 1.114, Test loss: 0.997, Test accuracy: 65.82
Round  31, Train loss: 1.047, Test loss: 0.987, Test accuracy: 66.08
Round  32, Train loss: 1.014, Test loss: 1.013, Test accuracy: 65.24
Round  33, Train loss: 1.087, Test loss: 1.018, Test accuracy: 64.92
Round  34, Train loss: 1.007, Test loss: 1.006, Test accuracy: 65.60
Round  35, Train loss: 0.817, Test loss: 0.968, Test accuracy: 66.72
Round  36, Train loss: 0.952, Test loss: 0.971, Test accuracy: 66.41
Round  37, Train loss: 0.800, Test loss: 0.953, Test accuracy: 67.13
Round  38, Train loss: 0.865, Test loss: 0.980, Test accuracy: 66.57
Round  39, Train loss: 0.868, Test loss: 0.981, Test accuracy: 66.67
Round  40, Train loss: 1.010, Test loss: 1.034, Test accuracy: 64.21
Round  41, Train loss: 0.901, Test loss: 1.022, Test accuracy: 64.42
Round  42, Train loss: 0.942, Test loss: 1.016, Test accuracy: 65.56
Round  43, Train loss: 0.875, Test loss: 1.041, Test accuracy: 64.89
Round  44, Train loss: 0.907, Test loss: 1.039, Test accuracy: 64.44
Round  45, Train loss: 0.794, Test loss: 1.014, Test accuracy: 65.13
Round  46, Train loss: 0.915, Test loss: 1.029, Test accuracy: 64.41
Round  47, Train loss: 0.735, Test loss: 1.009, Test accuracy: 65.09
Round  48, Train loss: 0.960, Test loss: 1.042, Test accuracy: 64.36
Round  49, Train loss: 0.764, Test loss: 1.041, Test accuracy: 64.79
Round  50, Train loss: 0.769, Test loss: 1.037, Test accuracy: 64.59
Round  51, Train loss: 0.954, Test loss: 1.085, Test accuracy: 62.98
Round  52, Train loss: 0.849, Test loss: 1.055, Test accuracy: 64.66
Round  53, Train loss: 0.841, Test loss: 1.092, Test accuracy: 63.02
Round  54, Train loss: 0.844, Test loss: 1.059, Test accuracy: 64.24
Round  55, Train loss: 0.828, Test loss: 1.074, Test accuracy: 63.99
Round  56, Train loss: 0.822, Test loss: 1.093, Test accuracy: 62.49
Round  57, Train loss: 0.760, Test loss: 1.046, Test accuracy: 64.34
Round  58, Train loss: 0.797, Test loss: 1.073, Test accuracy: 63.27
Round  59, Train loss: 0.702, Test loss: 1.066, Test accuracy: 64.06
Round  60, Train loss: 0.839, Test loss: 1.135, Test accuracy: 61.75
Round  61, Train loss: 0.676, Test loss: 1.075, Test accuracy: 64.47
Round  62, Train loss: 0.742, Test loss: 1.117, Test accuracy: 62.75
Round  63, Train loss: 0.694, Test loss: 1.064, Test accuracy: 64.49
Round  64, Train loss: 0.670, Test loss: 1.063, Test accuracy: 63.90
Round  65, Train loss: 0.886, Test loss: 1.163, Test accuracy: 61.71
Round  66, Train loss: 0.755, Test loss: 1.137, Test accuracy: 62.40
Round  67, Train loss: 0.760, Test loss: 1.127, Test accuracy: 62.56
Round  68, Train loss: 0.692, Test loss: 1.129, Test accuracy: 62.28
Round  69, Train loss: 0.796, Test loss: 1.192, Test accuracy: 60.67
Round  70, Train loss: 0.738, Test loss: 1.150, Test accuracy: 61.70
Round  71, Train loss: 0.690, Test loss: 1.154, Test accuracy: 61.98
Round  72, Train loss: 0.703, Test loss: 1.154, Test accuracy: 61.47
Round  73, Train loss: 0.589, Test loss: 1.133, Test accuracy: 62.92
Round  74, Train loss: 0.641, Test loss: 1.099, Test accuracy: 63.62
Round  75, Train loss: 0.650, Test loss: 1.133, Test accuracy: 62.76
Round  76, Train loss: 0.685, Test loss: 1.105, Test accuracy: 63.53
Round  77, Train loss: 0.720, Test loss: 1.186, Test accuracy: 61.11
Round  78, Train loss: 0.633, Test loss: 1.162, Test accuracy: 61.92
Round  79, Train loss: 0.538, Test loss: 1.128, Test accuracy: 63.34
Round  80, Train loss: 0.474, Test loss: 1.087, Test accuracy: 64.79
Round  81, Train loss: 0.439, Test loss: 1.089, Test accuracy: 64.83
Round  82, Train loss: 0.424, Test loss: 1.085, Test accuracy: 64.94
Round  83, Train loss: 0.412, Test loss: 1.104, Test accuracy: 64.65
Round  84, Train loss: 0.405, Test loss: 1.103, Test accuracy: 64.22
Round  85, Train loss: 0.388, Test loss: 1.100, Test accuracy: 64.57
Round  86, Train loss: 0.378, Test loss: 1.104, Test accuracy: 64.35
Round  87, Train loss: 0.375, Test loss: 1.106, Test accuracy: 64.59
Round  88, Train loss: 0.356, Test loss: 1.112, Test accuracy: 64.61
Round  89, Train loss: 0.354, Test loss: 1.108, Test accuracy: 64.54
Round  90, Train loss: 0.626, Test loss: 1.151, Test accuracy: 62.87
Round  91, Train loss: 0.601, Test loss: 1.167, Test accuracy: 62.88
Round  92, Train loss: 0.588, Test loss: 1.171, Test accuracy: 62.68
Round  93, Train loss: 0.580, Test loss: 1.191, Test accuracy: 62.19
Round  94, Train loss: 0.574, Test loss: 1.188, Test accuracy: 62.47
Round  95, Train loss: 0.568, Test loss: 1.187, Test accuracy: 62.23
Round  96, Train loss: 0.561, Test loss: 1.191, Test accuracy: 62.29
Round  97, Train loss: 0.557, Test loss: 1.206, Test accuracy: 61.63
Round  98, Train loss: 0.556, Test loss: 1.196, Test accuracy: 62.14
Round  99, Train loss: 0.552, Test loss: 1.220, Test accuracy: 61.21
Final Round, Train loss: 0.570, Test loss: 1.228, Test accuracy: 61.13
Average accuracy final 10 rounds: 62.25999999999999
4757.63692688942
[3.5497279167175293, 6.756481170654297, 9.953049898147583, 13.166468858718872, 16.379278421401978, 19.587601900100708, 22.764838457107544, 25.97003149986267, 29.146639823913574, 32.32748317718506, 35.50613474845886, 38.678579807281494, 41.85848259925842, 45.05626726150513, 48.266337156295776, 51.43156623840332, 54.62910437583923, 57.83209037780762, 61.038995027542114, 64.22624707221985, 67.39878129959106, 73.39855813980103, 79.40909671783447, 85.40887403488159, 91.45845890045166, 97.4150493144989, 103.14281797409058, 108.90573048591614, 114.6699423789978, 120.40106654167175, 126.14629936218262, 131.92254495620728, 137.51269793510437, 142.92540526390076, 148.33521032333374, 153.78424954414368, 159.2887623310089, 164.8018298149109, 170.24220156669617, 175.68691444396973, 181.11813640594482, 186.57342052459717, 191.995609998703, 197.4646806716919, 202.91075563430786, 208.41080617904663, 213.82764673233032, 219.23286080360413, 224.63137030601501, 230.05475854873657, 235.49753141403198, 240.9939842224121, 246.4445095062256, 251.88447070121765, 257.32548427581787, 262.7962508201599, 268.2934808731079, 273.7942535877228, 279.2787621021271, 284.7680914402008, 289.8789310455322, 295.0256118774414, 300.20373487472534, 305.40930819511414, 310.61285185813904, 315.8409869670868, 321.1185767650604, 326.3726975917816, 331.62282133102417, 336.8387575149536, 342.051326751709, 347.41557788848877, 352.9341084957123, 358.4123501777649, 363.96208572387695, 369.46180868148804, 374.921847820282, 380.4659934043884, 385.9585807323456, 391.463116645813, 396.97051191329956, 402.5228292942047, 408.03663325309753, 413.52966570854187, 419.0614652633667, 424.6149642467499, 430.15161967277527, 435.69846296310425, 441.2380647659302, 446.79852747917175, 452.34768629074097, 457.9408550262451, 463.2165298461914, 468.51455330848694, 473.7915756702423, 479.27705931663513, 485.1032178401947, 490.9287793636322, 496.7371301651001, 502.5278809070587, 506.55448722839355]
[31.15, 40.708333333333336, 47.75, 51.34166666666667, 54.34166666666667, 56.358333333333334, 58.333333333333336, 59.75833333333333, 60.333333333333336, 60.81666666666667, 60.916666666666664, 61.416666666666664, 62.141666666666666, 62.75833333333333, 63.233333333333334, 63.65833333333333, 63.266666666666666, 64.175, 64.7, 65.4, 65.18333333333334, 65.7, 66.30833333333334, 66.34166666666667, 66.21666666666667, 66.4, 65.65, 66.46666666666667, 66.45833333333333, 65.975, 65.81666666666666, 66.075, 65.24166666666666, 64.925, 65.6, 66.725, 66.40833333333333, 67.13333333333334, 66.56666666666666, 66.66666666666667, 64.20833333333333, 64.425, 65.55833333333334, 64.89166666666667, 64.44166666666666, 65.13333333333334, 64.40833333333333, 65.09166666666667, 64.35833333333333, 64.79166666666667, 64.59166666666667, 62.983333333333334, 64.65833333333333, 63.025, 64.24166666666666, 63.99166666666667, 62.49166666666667, 64.34166666666667, 63.266666666666666, 64.05833333333334, 61.75, 64.46666666666667, 62.75, 64.49166666666666, 63.9, 61.708333333333336, 62.4, 62.55833333333333, 62.28333333333333, 60.675, 61.7, 61.975, 61.46666666666667, 62.925, 63.61666666666667, 62.75833333333333, 63.53333333333333, 61.108333333333334, 61.925, 63.34166666666667, 64.79166666666667, 64.825, 64.94166666666666, 64.65, 64.225, 64.56666666666666, 64.35, 64.59166666666667, 64.60833333333333, 64.54166666666667, 62.86666666666667, 62.88333333333333, 62.68333333333333, 62.19166666666667, 62.46666666666667, 62.233333333333334, 62.291666666666664, 61.63333333333333, 62.141666666666666, 61.208333333333336, 61.13333333333333]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 7, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.953, Test loss: 2.067, Test accuracy: 23.14
Round   0, Global train loss: 1.953, Global test loss: 2.180, Global test accuracy: 20.38
Round   1, Train loss: 1.926, Test loss: 1.959, Test accuracy: 27.64
Round   1, Global train loss: 1.926, Global test loss: 2.150, Global test accuracy: 24.66
Round   2, Train loss: 1.896, Test loss: 1.858, Test accuracy: 30.07
Round   2, Global train loss: 1.896, Global test loss: 2.110, Global test accuracy: 24.40
Round   3, Train loss: 1.815, Test loss: 1.768, Test accuracy: 32.40
Round   3, Global train loss: 1.815, Global test loss: 2.004, Global test accuracy: 25.97
Round   4, Train loss: 1.740, Test loss: 1.680, Test accuracy: 35.35
Round   4, Global train loss: 1.740, Global test loss: 1.973, Global test accuracy: 28.54
Round   5, Train loss: 1.704, Test loss: 1.621, Test accuracy: 37.59
Round   5, Global train loss: 1.704, Global test loss: 1.945, Global test accuracy: 30.38
Round   6, Train loss: 1.642, Test loss: 1.594, Test accuracy: 39.27
Round   6, Global train loss: 1.642, Global test loss: 2.015, Global test accuracy: 26.27
Round   7, Train loss: 1.751, Test loss: 1.583, Test accuracy: 39.77
Round   7, Global train loss: 1.751, Global test loss: 2.032, Global test accuracy: 32.65
Round   8, Train loss: 1.677, Test loss: 1.585, Test accuracy: 39.92
Round   8, Global train loss: 1.677, Global test loss: 1.999, Global test accuracy: 25.50
Round   9, Train loss: 1.713, Test loss: 1.569, Test accuracy: 40.82
Round   9, Global train loss: 1.713, Global test loss: 1.936, Global test accuracy: 32.14
Round  10, Train loss: 1.583, Test loss: 1.555, Test accuracy: 41.13
Round  10, Global train loss: 1.583, Global test loss: 1.969, Global test accuracy: 31.06
Round  11, Train loss: 1.575, Test loss: 1.547, Test accuracy: 41.24
Round  11, Global train loss: 1.575, Global test loss: 1.987, Global test accuracy: 28.98
Round  12, Train loss: 1.544, Test loss: 1.546, Test accuracy: 41.54
Round  12, Global train loss: 1.544, Global test loss: 1.995, Global test accuracy: 27.86
Round  13, Train loss: 1.460, Test loss: 1.527, Test accuracy: 42.49
Round  13, Global train loss: 1.460, Global test loss: 1.928, Global test accuracy: 28.04
Round  14, Train loss: 1.599, Test loss: 1.536, Test accuracy: 42.54
Round  14, Global train loss: 1.599, Global test loss: 1.960, Global test accuracy: 29.27
Round  15, Train loss: 1.615, Test loss: 1.524, Test accuracy: 43.49
Round  15, Global train loss: 1.615, Global test loss: 1.895, Global test accuracy: 35.55
Round  16, Train loss: 1.311, Test loss: 1.545, Test accuracy: 43.19
Round  16, Global train loss: 1.311, Global test loss: 1.828, Global test accuracy: 35.55
Round  17, Train loss: 1.477, Test loss: 1.554, Test accuracy: 43.06
Round  17, Global train loss: 1.477, Global test loss: 1.872, Global test accuracy: 34.44
Round  18, Train loss: 1.380, Test loss: 1.541, Test accuracy: 43.33
Round  18, Global train loss: 1.380, Global test loss: 1.876, Global test accuracy: 30.39
Round  19, Train loss: 1.394, Test loss: 1.536, Test accuracy: 43.64
Round  19, Global train loss: 1.394, Global test loss: 1.904, Global test accuracy: 28.16
Round  20, Train loss: 1.373, Test loss: 1.552, Test accuracy: 43.37
Round  20, Global train loss: 1.373, Global test loss: 1.873, Global test accuracy: 32.44
Round  21, Train loss: 1.270, Test loss: 1.575, Test accuracy: 43.71
Round  21, Global train loss: 1.270, Global test loss: 1.805, Global test accuracy: 38.11
Round  22, Train loss: 1.532, Test loss: 1.584, Test accuracy: 43.43
Round  22, Global train loss: 1.532, Global test loss: 2.027, Global test accuracy: 26.82
Round  23, Train loss: 1.455, Test loss: 1.580, Test accuracy: 43.59
Round  23, Global train loss: 1.455, Global test loss: 1.956, Global test accuracy: 28.65
Round  24, Train loss: 1.317, Test loss: 1.574, Test accuracy: 44.45
Round  24, Global train loss: 1.317, Global test loss: 1.937, Global test accuracy: 32.24
Round  25, Train loss: 0.942, Test loss: 1.591, Test accuracy: 44.24
Round  25, Global train loss: 0.942, Global test loss: 1.848, Global test accuracy: 34.86
Round  26, Train loss: 1.309, Test loss: 1.611, Test accuracy: 44.00
Round  26, Global train loss: 1.309, Global test loss: 1.907, Global test accuracy: 32.28
Round  27, Train loss: 1.182, Test loss: 1.615, Test accuracy: 43.74
Round  27, Global train loss: 1.182, Global test loss: 1.845, Global test accuracy: 32.37
Round  28, Train loss: 1.189, Test loss: 1.632, Test accuracy: 43.91
Round  28, Global train loss: 1.189, Global test loss: 2.013, Global test accuracy: 27.10
Round  29, Train loss: 1.123, Test loss: 1.651, Test accuracy: 43.87
Round  29, Global train loss: 1.123, Global test loss: 1.875, Global test accuracy: 32.74
Round  30, Train loss: 1.143, Test loss: 1.656, Test accuracy: 44.32
Round  30, Global train loss: 1.143, Global test loss: 1.807, Global test accuracy: 37.02
Round  31, Train loss: 1.004, Test loss: 1.678, Test accuracy: 44.06
Round  31, Global train loss: 1.004, Global test loss: 1.711, Global test accuracy: 40.18
Round  32, Train loss: 1.229, Test loss: 1.696, Test accuracy: 44.08
Round  32, Global train loss: 1.229, Global test loss: 1.863, Global test accuracy: 33.07
Round  33, Train loss: 0.940, Test loss: 1.721, Test accuracy: 43.94
Round  33, Global train loss: 0.940, Global test loss: 1.815, Global test accuracy: 34.26
Round  34, Train loss: 0.986, Test loss: 1.742, Test accuracy: 43.84
Round  34, Global train loss: 0.986, Global test loss: 1.762, Global test accuracy: 36.26
Round  35, Train loss: 1.219, Test loss: 1.774, Test accuracy: 42.84
Round  35, Global train loss: 1.219, Global test loss: 1.970, Global test accuracy: 31.81
Round  36, Train loss: 1.047, Test loss: 1.788, Test accuracy: 42.96
Round  36, Global train loss: 1.047, Global test loss: 1.975, Global test accuracy: 31.59
Round  37, Train loss: 1.330, Test loss: 1.811, Test accuracy: 42.90
Round  37, Global train loss: 1.330, Global test loss: 1.887, Global test accuracy: 34.10
Round  38, Train loss: 0.933, Test loss: 1.824, Test accuracy: 42.86
Round  38, Global train loss: 0.933, Global test loss: 1.880, Global test accuracy: 29.76
Round  39, Train loss: 1.130, Test loss: 1.875, Test accuracy: 42.32
Round  39, Global train loss: 1.130, Global test loss: 1.899, Global test accuracy: 32.78
Round  40, Train loss: 0.998, Test loss: 1.914, Test accuracy: 41.99
Round  40, Global train loss: 0.998, Global test loss: 1.826, Global test accuracy: 37.59
Round  41, Train loss: 0.797, Test loss: 1.952, Test accuracy: 41.81
Round  41, Global train loss: 0.797, Global test loss: 1.717, Global test accuracy: 38.16
Round  42, Train loss: 0.928, Test loss: 1.955, Test accuracy: 42.16
Round  42, Global train loss: 0.928, Global test loss: 1.915, Global test accuracy: 28.51
Round  43, Train loss: 0.938, Test loss: 1.978, Test accuracy: 42.34
Round  43, Global train loss: 0.938, Global test loss: 1.966, Global test accuracy: 30.74
Round  44, Train loss: 0.798, Test loss: 2.031, Test accuracy: 42.23
Round  44, Global train loss: 0.798, Global test loss: 1.940, Global test accuracy: 31.64
Round  45, Train loss: 0.949, Test loss: 2.058, Test accuracy: 42.41
Round  45, Global train loss: 0.949, Global test loss: 1.938, Global test accuracy: 32.14
Round  46, Train loss: 0.775, Test loss: 2.129, Test accuracy: 42.27
Round  46, Global train loss: 0.775, Global test loss: 1.873, Global test accuracy: 33.19
Round  47, Train loss: 0.530, Test loss: 2.133, Test accuracy: 42.09
Round  47, Global train loss: 0.530, Global test loss: 1.767, Global test accuracy: 40.73
Round  48, Train loss: 0.730, Test loss: 2.175, Test accuracy: 41.99
Round  48, Global train loss: 0.730, Global test loss: 1.833, Global test accuracy: 36.61
Round  49, Train loss: 0.555, Test loss: 2.202, Test accuracy: 42.00
Round  49, Global train loss: 0.555, Global test loss: 1.713, Global test accuracy: 38.41
Round  50, Train loss: 0.500, Test loss: 2.237, Test accuracy: 42.70
Round  50, Global train loss: 0.500, Global test loss: 1.819, Global test accuracy: 37.23
Round  51, Train loss: 0.702, Test loss: 2.310, Test accuracy: 42.08
Round  51, Global train loss: 0.702, Global test loss: 1.923, Global test accuracy: 29.18
Round  52, Train loss: 0.753, Test loss: 2.336, Test accuracy: 41.97
Round  52, Global train loss: 0.753, Global test loss: 1.846, Global test accuracy: 32.61
Round  53, Train loss: 0.726, Test loss: 2.378, Test accuracy: 41.20
Round  53, Global train loss: 0.726, Global test loss: 1.922, Global test accuracy: 29.43
Round  54, Train loss: 0.628, Test loss: 2.390, Test accuracy: 41.14
Round  54, Global train loss: 0.628, Global test loss: 1.940, Global test accuracy: 29.42
Round  55, Train loss: 0.586, Test loss: 2.422, Test accuracy: 41.39
Round  55, Global train loss: 0.586, Global test loss: 1.858, Global test accuracy: 32.27
Round  56, Train loss: 0.641, Test loss: 2.463, Test accuracy: 41.61
Round  56, Global train loss: 0.641, Global test loss: 1.929, Global test accuracy: 26.02
Round  57, Train loss: 0.634, Test loss: 2.464, Test accuracy: 41.19
Round  57, Global train loss: 0.634, Global test loss: 1.857, Global test accuracy: 34.99
Round  58, Train loss: 0.740, Test loss: 2.500, Test accuracy: 41.00
Round  58, Global train loss: 0.740, Global test loss: 1.857, Global test accuracy: 34.61
Round  59, Train loss: 0.359, Test loss: 2.516, Test accuracy: 41.40
Round  59, Global train loss: 0.359, Global test loss: 1.798, Global test accuracy: 37.09
Round  60, Train loss: 0.612, Test loss: 2.528, Test accuracy: 41.59
Round  60, Global train loss: 0.612, Global test loss: 1.891, Global test accuracy: 32.71
Round  61, Train loss: 0.539, Test loss: 2.571, Test accuracy: 41.24
Round  61, Global train loss: 0.539, Global test loss: 1.834, Global test accuracy: 35.02
Round  62, Train loss: 0.557, Test loss: 2.643, Test accuracy: 41.36
Round  62, Global train loss: 0.557, Global test loss: 1.793, Global test accuracy: 37.36
Round  63, Train loss: 0.504, Test loss: 2.672, Test accuracy: 41.56
Round  63, Global train loss: 0.504, Global test loss: 1.821, Global test accuracy: 35.59
Round  64, Train loss: 0.539, Test loss: 2.734, Test accuracy: 41.36
Round  64, Global train loss: 0.539, Global test loss: 1.955, Global test accuracy: 26.50
Round  65, Train loss: 0.437, Test loss: 2.732, Test accuracy: 42.01
Round  65, Global train loss: 0.437, Global test loss: 1.922, Global test accuracy: 33.22
Round  66, Train loss: 0.507, Test loss: 2.752, Test accuracy: 42.41
Round  66, Global train loss: 0.507, Global test loss: 1.883, Global test accuracy: 34.08
Round  67, Train loss: 0.422, Test loss: 2.825, Test accuracy: 42.00
Round  67, Global train loss: 0.422, Global test loss: 2.012, Global test accuracy: 29.05
Round  68, Train loss: 0.416, Test loss: 2.860, Test accuracy: 41.54
Round  68, Global train loss: 0.416, Global test loss: 1.874, Global test accuracy: 33.65
Round  69, Train loss: 0.379, Test loss: 2.896, Test accuracy: 40.89
Round  69, Global train loss: 0.379, Global test loss: 1.940, Global test accuracy: 33.99
Round  70, Train loss: 0.374, Test loss: 2.912, Test accuracy: 40.97
Round  70, Global train loss: 0.374, Global test loss: 1.945, Global test accuracy: 26.39
Round  71, Train loss: 0.384, Test loss: 2.939, Test accuracy: 41.10
Round  71, Global train loss: 0.384, Global test loss: 1.918, Global test accuracy: 33.10
Round  72, Train loss: 0.490, Test loss: 2.989, Test accuracy: 41.24
Round  72, Global train loss: 0.490, Global test loss: 1.942, Global test accuracy: 29.99
Round  73, Train loss: 0.476, Test loss: 3.048, Test accuracy: 41.44
Round  73, Global train loss: 0.476, Global test loss: 1.909, Global test accuracy: 32.09
Round  74, Train loss: 0.384, Test loss: 3.037, Test accuracy: 41.51
Round  74, Global train loss: 0.384, Global test loss: 1.948, Global test accuracy: 32.09
Round  75, Train loss: 0.392, Test loss: 3.086, Test accuracy: 41.39
Round  75, Global train loss: 0.392, Global test loss: 1.936, Global test accuracy: 33.35
Round  76, Train loss: 0.364, Test loss: 3.105, Test accuracy: 41.18
Round  76, Global train loss: 0.364, Global test loss: 2.040, Global test accuracy: 28.91
Round  77, Train loss: 0.383, Test loss: 3.127, Test accuracy: 40.71
Round  77, Global train loss: 0.383, Global test loss: 1.956, Global test accuracy: 27.81
Round  78, Train loss: 0.288, Test loss: 3.180, Test accuracy: 41.13
Round  78, Global train loss: 0.288, Global test loss: 1.778, Global test accuracy: 35.22
Round  79, Train loss: 0.333, Test loss: 3.204, Test accuracy: 41.39
Round  79, Global train loss: 0.333, Global test loss: 1.862, Global test accuracy: 36.51
Round  80, Train loss: 0.436, Test loss: 3.294, Test accuracy: 41.04
Round  80, Global train loss: 0.436, Global test loss: 1.933, Global test accuracy: 30.58
Round  81, Train loss: 0.366, Test loss: 3.343, Test accuracy: 40.88
Round  81, Global train loss: 0.366, Global test loss: 1.970, Global test accuracy: 28.35
Round  82, Train loss: 0.336, Test loss: 3.389, Test accuracy: 40.79
Round  82, Global train loss: 0.336, Global test loss: 1.949, Global test accuracy: 30.73
Round  83, Train loss: 0.287, Test loss: 3.383, Test accuracy: 40.59
Round  83, Global train loss: 0.287, Global test loss: 1.875, Global test accuracy: 33.77
Round  84, Train loss: 0.359, Test loss: 3.384, Test accuracy: 41.14
Round  84, Global train loss: 0.359, Global test loss: 1.970, Global test accuracy: 30.48
Round  85, Train loss: 0.386, Test loss: 3.381, Test accuracy: 40.99
Round  85, Global train loss: 0.386, Global test loss: 2.029, Global test accuracy: 28.89
Round  86, Train loss: 0.251, Test loss: 3.422, Test accuracy: 40.84
Round  86, Global train loss: 0.251, Global test loss: 1.971, Global test accuracy: 28.05
Round  87, Train loss: 0.259, Test loss: 3.425, Test accuracy: 40.74
Round  87, Global train loss: 0.259, Global test loss: 1.831, Global test accuracy: 34.61
Round  88, Train loss: 0.284, Test loss: 3.472, Test accuracy: 41.39
Round  88, Global train loss: 0.284, Global test loss: 1.852, Global test accuracy: 37.14
Round  89, Train loss: 0.295, Test loss: 3.470, Test accuracy: 41.70
Round  89, Global train loss: 0.295, Global test loss: 2.029, Global test accuracy: 26.62
Round  90, Train loss: 0.256, Test loss: 3.464, Test accuracy: 41.64
Round  90, Global train loss: 0.256, Global test loss: 1.854, Global test accuracy: 33.37
Round  91, Train loss: 0.194, Test loss: 3.496, Test accuracy: 41.76
Round  91, Global train loss: 0.194, Global test loss: 1.829, Global test accuracy: 33.40
Round  92, Train loss: 0.313, Test loss: 3.550, Test accuracy: 41.61
Round  92, Global train loss: 0.313, Global test loss: 1.947, Global test accuracy: 30.76
Round  93, Train loss: 0.167, Test loss: 3.579, Test accuracy: 41.51
Round  93, Global train loss: 0.167, Global test loss: 1.761, Global test accuracy: 39.58
Round  94, Train loss: 0.350, Test loss: 3.537, Test accuracy: 41.93
Round  94, Global train loss: 0.350, Global test loss: 2.017, Global test accuracy: 28.13
Round  95, Train loss: 0.187, Test loss: 3.578, Test accuracy: 41.29
Round  95, Global train loss: 0.187, Global test loss: 1.801, Global test accuracy: 34.06
Round  96, Train loss: 0.257, Test loss: 3.609, Test accuracy: 41.49
Round  96, Global train loss: 0.257, Global test loss: 1.926, Global test accuracy: 30.61
Round  97, Train loss: 0.178, Test loss: 3.593, Test accuracy: 41.59
Round  97, Global train loss: 0.178, Global test loss: 1.874, Global test accuracy: 37.90
Round  98, Train loss: 0.264, Test loss: 3.618, Test accuracy: 41.83
Round  98, Global train loss: 0.264, Global test loss: 1.883, Global test accuracy: 31.74
Round  99, Train loss: 0.198, Test loss: 3.701, Test accuracy: 41.53
Round  99, Global train loss: 0.198, Global test loss: 1.932, Global test accuracy: 31.47
Final Round, Train loss: 0.203, Test loss: 3.969, Test accuracy: 41.18
Final Round, Global train loss: 0.203, Global test loss: 1.932, Global test accuracy: 31.47
Average accuracy final 10 rounds: 41.61642857142858 

Average global accuracy final 10 rounds: 33.10142857142857 

1893.399852514267
[1.907883644104004, 3.815767288208008, 5.442513465881348, 7.0692596435546875, 8.691874265670776, 10.314488887786865, 11.929195642471313, 13.543902397155762, 15.160679578781128, 16.777456760406494, 18.394792556762695, 20.012128353118896, 21.62950110435486, 23.24687385559082, 24.85952353477478, 26.47217321395874, 28.084750652313232, 29.697328090667725, 31.310859203338623, 32.92439031600952, 34.54272198677063, 36.16105365753174, 37.7734215259552, 39.38578939437866, 41.002890825271606, 42.61999225616455, 44.23698091506958, 45.85396957397461, 47.46934914588928, 49.084728717803955, 50.694358587265015, 52.303988456726074, 53.91907739639282, 55.53416633605957, 57.15027046203613, 58.766374588012695, 60.37296772003174, 61.97956085205078, 63.589595079422, 65.19962930679321, 66.81288504600525, 68.42614078521729, 70.04136490821838, 71.65658903121948, 73.26949071884155, 74.88239240646362, 76.49314904212952, 78.10390567779541, 79.70134329795837, 81.29878091812134, 82.81080198287964, 84.32282304763794, 85.83589696884155, 87.34897089004517, 88.72994685173035, 90.11092281341553, 91.49390006065369, 92.87687730789185, 94.25691366195679, 95.63695001602173, 97.01774644851685, 98.39854288101196, 99.7797520160675, 101.16096115112305, 102.54104256629944, 103.92112398147583, 105.3026475906372, 106.68417119979858, 108.06544375419617, 109.44671630859375, 110.8278501033783, 112.20898389816284, 113.5934190750122, 114.97785425186157, 116.3610532283783, 117.74425220489502, 119.12232279777527, 120.50039339065552, 121.88121724128723, 123.26204109191895, 124.64230871200562, 126.02257633209229, 127.40056920051575, 128.7785620689392, 130.16039037704468, 131.54221868515015, 132.92159366607666, 134.30096864700317, 135.6804609298706, 137.05995321273804, 138.43849539756775, 139.81703758239746, 141.19987273216248, 142.5827078819275, 143.95790600776672, 145.33310413360596, 146.71343684196472, 148.0937695503235, 149.47440266609192, 150.85503578186035, 152.23741102218628, 153.6197862625122, 155.00069117546082, 156.38159608840942, 157.7596046924591, 159.1376132965088, 160.51625394821167, 161.89489459991455, 163.2776222229004, 164.66034984588623, 166.04313588142395, 167.42592191696167, 168.80539655685425, 170.18487119674683, 171.56388068199158, 172.94289016723633, 174.32264041900635, 175.70239067077637, 177.08310532569885, 178.46381998062134, 179.84296536445618, 181.22211074829102, 182.60199642181396, 183.9818820953369, 185.359965801239, 186.7380495071411, 188.11748433113098, 189.49691915512085, 190.87744998931885, 192.25798082351685, 193.63926720619202, 195.0205535888672, 196.40087008476257, 197.78118658065796, 199.16016006469727, 200.53913354873657, 201.9198031425476, 203.30047273635864, 204.67675256729126, 206.05303239822388, 207.43027305603027, 208.80751371383667, 210.18610382080078, 211.5646939277649, 212.94183015823364, 214.3189663887024, 215.69730520248413, 217.07564401626587, 218.4510622024536, 219.82648038864136, 221.20746159553528, 222.5884428024292, 223.97086572647095, 225.3532886505127, 226.73142266273499, 228.10955667495728, 229.4854826927185, 230.86140871047974, 232.23979258537292, 233.6181764602661, 234.9985795021057, 236.3789825439453, 237.7623794078827, 239.14577627182007, 240.52292704582214, 241.90007781982422, 243.2780566215515, 244.6560354232788, 246.03510999679565, 247.4141845703125, 248.78800415992737, 250.16182374954224, 251.5354597568512, 252.90909576416016, 254.28632044792175, 255.66354513168335, 257.0409755706787, 258.4184060096741, 259.79911041259766, 261.17981481552124, 262.5606038570404, 263.94139289855957, 265.3181827068329, 266.6949725151062, 268.07299399375916, 269.4510154724121, 270.8320424556732, 272.2130694389343, 273.59232926368713, 274.97158908843994, 276.3497483730316, 277.7279076576233, 279.1057150363922, 280.48352241516113, 281.85783100128174, 283.23213958740234, 284.6071960926056, 285.98225259780884, 287.3578579425812, 288.7334632873535, 290.69992899894714, 292.66639471054077]
[23.142857142857142, 23.142857142857142, 27.635714285714286, 27.635714285714286, 30.071428571428573, 30.071428571428573, 32.4, 32.4, 35.35, 35.35, 37.59285714285714, 37.59285714285714, 39.27142857142857, 39.27142857142857, 39.77142857142857, 39.77142857142857, 39.92142857142857, 39.92142857142857, 40.82142857142857, 40.82142857142857, 41.128571428571426, 41.128571428571426, 41.23571428571429, 41.23571428571429, 41.535714285714285, 41.535714285714285, 42.48571428571429, 42.48571428571429, 42.535714285714285, 42.535714285714285, 43.48571428571429, 43.48571428571429, 43.19285714285714, 43.19285714285714, 43.05714285714286, 43.05714285714286, 43.32857142857143, 43.32857142857143, 43.642857142857146, 43.642857142857146, 43.371428571428574, 43.371428571428574, 43.714285714285715, 43.714285714285715, 43.42857142857143, 43.42857142857143, 43.59285714285714, 43.59285714285714, 44.45, 44.45, 44.24285714285714, 44.24285714285714, 44.0, 44.0, 43.73571428571429, 43.73571428571429, 43.90714285714286, 43.90714285714286, 43.871428571428574, 43.871428571428574, 44.32142857142857, 44.32142857142857, 44.06428571428572, 44.06428571428572, 44.07857142857143, 44.07857142857143, 43.93571428571428, 43.93571428571428, 43.83571428571429, 43.83571428571429, 42.83571428571429, 42.83571428571429, 42.957142857142856, 42.957142857142856, 42.9, 42.9, 42.857142857142854, 42.857142857142854, 42.32142857142857, 42.32142857142857, 41.99285714285714, 41.99285714285714, 41.81428571428572, 41.81428571428572, 42.15714285714286, 42.15714285714286, 42.34285714285714, 42.34285714285714, 42.22857142857143, 42.22857142857143, 42.40714285714286, 42.40714285714286, 42.27142857142857, 42.27142857142857, 42.09285714285714, 42.09285714285714, 41.99285714285714, 41.99285714285714, 42.0, 42.0, 42.7, 42.7, 42.07857142857143, 42.07857142857143, 41.97142857142857, 41.97142857142857, 41.2, 41.2, 41.142857142857146, 41.142857142857146, 41.392857142857146, 41.392857142857146, 41.607142857142854, 41.607142857142854, 41.18571428571428, 41.18571428571428, 41.0, 41.0, 41.4, 41.4, 41.59285714285714, 41.59285714285714, 41.23571428571429, 41.23571428571429, 41.357142857142854, 41.357142857142854, 41.55714285714286, 41.55714285714286, 41.357142857142854, 41.357142857142854, 42.00714285714286, 42.00714285714286, 42.40714285714286, 42.40714285714286, 42.0, 42.0, 41.535714285714285, 41.535714285714285, 40.892857142857146, 40.892857142857146, 40.97142857142857, 40.97142857142857, 41.1, 41.1, 41.23571428571429, 41.23571428571429, 41.43571428571428, 41.43571428571428, 41.51428571428571, 41.51428571428571, 41.392857142857146, 41.392857142857146, 41.17857142857143, 41.17857142857143, 40.714285714285715, 40.714285714285715, 41.128571428571426, 41.128571428571426, 41.392857142857146, 41.392857142857146, 41.035714285714285, 41.035714285714285, 40.878571428571426, 40.878571428571426, 40.792857142857144, 40.792857142857144, 40.59285714285714, 40.59285714285714, 41.135714285714286, 41.135714285714286, 40.99285714285714, 40.99285714285714, 40.83571428571429, 40.83571428571429, 40.73571428571429, 40.73571428571429, 41.385714285714286, 41.385714285714286, 41.7, 41.7, 41.635714285714286, 41.635714285714286, 41.75714285714286, 41.75714285714286, 41.614285714285714, 41.614285714285714, 41.50714285714286, 41.50714285714286, 41.92857142857143, 41.92857142857143, 41.292857142857144, 41.292857142857144, 41.48571428571429, 41.48571428571429, 41.58571428571429, 41.58571428571429, 41.82857142857143, 41.82857142857143, 41.52857142857143, 41.52857142857143, 41.17857142857143, 41.17857142857143]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 7, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.958, Test loss: 2.084, Test accuracy: 20.42
Round   0, Global train loss: 1.958, Global test loss: 2.197, Global test accuracy: 18.01
Round   1, Train loss: 1.906, Test loss: 1.937, Test accuracy: 27.44
Round   1, Global train loss: 1.906, Global test loss: 2.092, Global test accuracy: 24.25
Round   2, Train loss: 1.818, Test loss: 1.840, Test accuracy: 30.19
Round   2, Global train loss: 1.818, Global test loss: 2.024, Global test accuracy: 26.45
Round   3, Train loss: 1.733, Test loss: 1.703, Test accuracy: 35.14
Round   3, Global train loss: 1.733, Global test loss: 1.828, Global test accuracy: 34.09
Round   4, Train loss: 1.703, Test loss: 1.622, Test accuracy: 38.84
Round   4, Global train loss: 1.703, Global test loss: 1.853, Global test accuracy: 35.12
Round   5, Train loss: 1.575, Test loss: 1.585, Test accuracy: 39.95
Round   5, Global train loss: 1.575, Global test loss: 1.806, Global test accuracy: 34.59
Round   6, Train loss: 1.727, Test loss: 1.544, Test accuracy: 42.36
Round   6, Global train loss: 1.727, Global test loss: 1.724, Global test accuracy: 39.51
Round   7, Train loss: 1.547, Test loss: 1.517, Test accuracy: 44.29
Round   7, Global train loss: 1.547, Global test loss: 1.597, Global test accuracy: 44.92
Round   8, Train loss: 1.748, Test loss: 1.487, Test accuracy: 45.76
Round   8, Global train loss: 1.748, Global test loss: 1.704, Global test accuracy: 40.40
Round   9, Train loss: 1.657, Test loss: 1.468, Test accuracy: 46.65
Round   9, Global train loss: 1.657, Global test loss: 1.655, Global test accuracy: 43.96
Round  10, Train loss: 1.650, Test loss: 1.449, Test accuracy: 48.06
Round  10, Global train loss: 1.650, Global test loss: 1.655, Global test accuracy: 44.20
Round  11, Train loss: 1.625, Test loss: 1.447, Test accuracy: 47.82
Round  11, Global train loss: 1.625, Global test loss: 1.604, Global test accuracy: 45.36
Round  12, Train loss: 1.699, Test loss: 1.418, Test accuracy: 48.86
Round  12, Global train loss: 1.699, Global test loss: 1.712, Global test accuracy: 40.38
Round  13, Train loss: 1.573, Test loss: 1.406, Test accuracy: 49.45
Round  13, Global train loss: 1.573, Global test loss: 1.618, Global test accuracy: 43.39
Round  14, Train loss: 1.600, Test loss: 1.394, Test accuracy: 49.79
Round  14, Global train loss: 1.600, Global test loss: 1.573, Global test accuracy: 47.43
Round  15, Train loss: 1.433, Test loss: 1.374, Test accuracy: 51.12
Round  15, Global train loss: 1.433, Global test loss: 1.479, Global test accuracy: 49.00
Round  16, Train loss: 1.677, Test loss: 1.367, Test accuracy: 51.59
Round  16, Global train loss: 1.677, Global test loss: 1.625, Global test accuracy: 46.04
Round  17, Train loss: 1.585, Test loss: 1.360, Test accuracy: 51.90
Round  17, Global train loss: 1.585, Global test loss: 1.549, Global test accuracy: 49.61
Round  18, Train loss: 1.453, Test loss: 1.358, Test accuracy: 51.96
Round  18, Global train loss: 1.453, Global test loss: 1.513, Global test accuracy: 49.34
Round  19, Train loss: 1.494, Test loss: 1.359, Test accuracy: 52.19
Round  19, Global train loss: 1.494, Global test loss: 1.499, Global test accuracy: 51.16
Round  20, Train loss: 1.499, Test loss: 1.352, Test accuracy: 52.55
Round  20, Global train loss: 1.499, Global test loss: 1.567, Global test accuracy: 47.07
Round  21, Train loss: 1.497, Test loss: 1.351, Test accuracy: 52.65
Round  21, Global train loss: 1.497, Global test loss: 1.450, Global test accuracy: 51.90
Round  22, Train loss: 1.515, Test loss: 1.345, Test accuracy: 52.89
Round  22, Global train loss: 1.515, Global test loss: 1.585, Global test accuracy: 45.87
Round  23, Train loss: 1.455, Test loss: 1.342, Test accuracy: 52.59
Round  23, Global train loss: 1.455, Global test loss: 1.483, Global test accuracy: 51.20
Round  24, Train loss: 1.348, Test loss: 1.344, Test accuracy: 52.59
Round  24, Global train loss: 1.348, Global test loss: 1.407, Global test accuracy: 52.90
Round  25, Train loss: 1.391, Test loss: 1.340, Test accuracy: 52.64
Round  25, Global train loss: 1.391, Global test loss: 1.502, Global test accuracy: 50.63
Round  26, Train loss: 1.550, Test loss: 1.332, Test accuracy: 53.01
Round  26, Global train loss: 1.550, Global test loss: 1.540, Global test accuracy: 50.05
Round  27, Train loss: 1.461, Test loss: 1.327, Test accuracy: 53.09
Round  27, Global train loss: 1.461, Global test loss: 1.541, Global test accuracy: 48.53
Round  28, Train loss: 1.466, Test loss: 1.336, Test accuracy: 52.89
Round  28, Global train loss: 1.466, Global test loss: 1.565, Global test accuracy: 47.72
Round  29, Train loss: 1.419, Test loss: 1.336, Test accuracy: 52.84
Round  29, Global train loss: 1.419, Global test loss: 1.571, Global test accuracy: 49.76
Round  30, Train loss: 1.201, Test loss: 1.359, Test accuracy: 52.67
Round  30, Global train loss: 1.201, Global test loss: 1.470, Global test accuracy: 51.50
Round  31, Train loss: 1.243, Test loss: 1.357, Test accuracy: 52.62
Round  31, Global train loss: 1.243, Global test loss: 1.322, Global test accuracy: 55.49
Round  32, Train loss: 1.341, Test loss: 1.354, Test accuracy: 52.58
Round  32, Global train loss: 1.341, Global test loss: 1.455, Global test accuracy: 51.80
Round  33, Train loss: 1.365, Test loss: 1.359, Test accuracy: 52.49
Round  33, Global train loss: 1.365, Global test loss: 1.430, Global test accuracy: 52.72
Round  34, Train loss: 1.202, Test loss: 1.368, Test accuracy: 52.63
Round  34, Global train loss: 1.202, Global test loss: 1.349, Global test accuracy: 54.00
Round  35, Train loss: 1.194, Test loss: 1.363, Test accuracy: 53.33
Round  35, Global train loss: 1.194, Global test loss: 1.448, Global test accuracy: 50.87
Round  36, Train loss: 1.389, Test loss: 1.358, Test accuracy: 53.43
Round  36, Global train loss: 1.389, Global test loss: 1.564, Global test accuracy: 48.68
Round  37, Train loss: 1.191, Test loss: 1.344, Test accuracy: 53.69
Round  37, Global train loss: 1.191, Global test loss: 1.398, Global test accuracy: 52.69
Round  38, Train loss: 1.069, Test loss: 1.358, Test accuracy: 53.61
Round  38, Global train loss: 1.069, Global test loss: 1.286, Global test accuracy: 56.01
Round  39, Train loss: 1.183, Test loss: 1.352, Test accuracy: 53.89
Round  39, Global train loss: 1.183, Global test loss: 1.447, Global test accuracy: 51.19
Round  40, Train loss: 1.111, Test loss: 1.362, Test accuracy: 53.72
Round  40, Global train loss: 1.111, Global test loss: 1.328, Global test accuracy: 55.29
Round  41, Train loss: 1.198, Test loss: 1.382, Test accuracy: 53.08
Round  41, Global train loss: 1.198, Global test loss: 1.371, Global test accuracy: 55.12
Round  42, Train loss: 1.320, Test loss: 1.401, Test accuracy: 52.46
Round  42, Global train loss: 1.320, Global test loss: 1.504, Global test accuracy: 49.49
Round  43, Train loss: 1.215, Test loss: 1.419, Test accuracy: 52.09
Round  43, Global train loss: 1.215, Global test loss: 1.450, Global test accuracy: 52.01
Round  44, Train loss: 1.083, Test loss: 1.408, Test accuracy: 52.10
Round  44, Global train loss: 1.083, Global test loss: 1.456, Global test accuracy: 51.48
Round  45, Train loss: 1.089, Test loss: 1.410, Test accuracy: 52.08
Round  45, Global train loss: 1.089, Global test loss: 1.456, Global test accuracy: 51.26
Round  46, Train loss: 1.087, Test loss: 1.428, Test accuracy: 52.11
Round  46, Global train loss: 1.087, Global test loss: 1.456, Global test accuracy: 51.56
Round  47, Train loss: 1.128, Test loss: 1.429, Test accuracy: 52.60
Round  47, Global train loss: 1.128, Global test loss: 1.516, Global test accuracy: 52.56
Round  48, Train loss: 0.894, Test loss: 1.432, Test accuracy: 52.78
Round  48, Global train loss: 0.894, Global test loss: 1.464, Global test accuracy: 55.16
Round  49, Train loss: 1.132, Test loss: 1.423, Test accuracy: 53.11
Round  49, Global train loss: 1.132, Global test loss: 1.361, Global test accuracy: 54.80
Round  50, Train loss: 1.185, Test loss: 1.443, Test accuracy: 52.65
Round  50, Global train loss: 1.185, Global test loss: 1.512, Global test accuracy: 52.11
Round  51, Train loss: 1.181, Test loss: 1.433, Test accuracy: 53.39
Round  51, Global train loss: 1.181, Global test loss: 1.449, Global test accuracy: 51.20
Round  52, Train loss: 1.208, Test loss: 1.432, Test accuracy: 53.61
Round  52, Global train loss: 1.208, Global test loss: 1.492, Global test accuracy: 49.90
Round  53, Train loss: 1.274, Test loss: 1.442, Test accuracy: 53.06
Round  53, Global train loss: 1.274, Global test loss: 1.591, Global test accuracy: 46.89
Round  54, Train loss: 1.191, Test loss: 1.464, Test accuracy: 52.86
Round  54, Global train loss: 1.191, Global test loss: 1.640, Global test accuracy: 45.81
Round  55, Train loss: 1.067, Test loss: 1.482, Test accuracy: 52.43
Round  55, Global train loss: 1.067, Global test loss: 1.433, Global test accuracy: 52.69
Round  56, Train loss: 1.096, Test loss: 1.467, Test accuracy: 52.74
Round  56, Global train loss: 1.096, Global test loss: 1.462, Global test accuracy: 51.66
Round  57, Train loss: 0.957, Test loss: 1.450, Test accuracy: 53.04
Round  57, Global train loss: 0.957, Global test loss: 1.456, Global test accuracy: 52.51
Round  58, Train loss: 1.008, Test loss: 1.453, Test accuracy: 52.64
Round  58, Global train loss: 1.008, Global test loss: 1.441, Global test accuracy: 52.55
Round  59, Train loss: 1.043, Test loss: 1.466, Test accuracy: 52.49
Round  59, Global train loss: 1.043, Global test loss: 1.414, Global test accuracy: 53.76
Round  60, Train loss: 0.956, Test loss: 1.471, Test accuracy: 52.39
Round  60, Global train loss: 0.956, Global test loss: 1.453, Global test accuracy: 52.82
Round  61, Train loss: 0.970, Test loss: 1.495, Test accuracy: 52.37
Round  61, Global train loss: 0.970, Global test loss: 1.546, Global test accuracy: 50.89
Round  62, Train loss: 0.883, Test loss: 1.492, Test accuracy: 52.84
Round  62, Global train loss: 0.883, Global test loss: 1.326, Global test accuracy: 57.30
Round  63, Train loss: 0.898, Test loss: 1.512, Test accuracy: 52.35
Round  63, Global train loss: 0.898, Global test loss: 1.435, Global test accuracy: 53.95
Round  64, Train loss: 1.056, Test loss: 1.505, Test accuracy: 52.39
Round  64, Global train loss: 1.056, Global test loss: 1.470, Global test accuracy: 52.32
Round  65, Train loss: 0.886, Test loss: 1.524, Test accuracy: 52.46
Round  65, Global train loss: 0.886, Global test loss: 1.496, Global test accuracy: 52.84
Round  66, Train loss: 0.940, Test loss: 1.540, Test accuracy: 52.09
Round  66, Global train loss: 0.940, Global test loss: 1.545, Global test accuracy: 50.04
Round  67, Train loss: 0.930, Test loss: 1.552, Test accuracy: 52.39
Round  67, Global train loss: 0.930, Global test loss: 1.470, Global test accuracy: 52.69
Round  68, Train loss: 0.996, Test loss: 1.582, Test accuracy: 51.89
Round  68, Global train loss: 0.996, Global test loss: 1.471, Global test accuracy: 52.21
Round  69, Train loss: 0.834, Test loss: 1.583, Test accuracy: 51.91
Round  69, Global train loss: 0.834, Global test loss: 1.600, Global test accuracy: 51.28
Round  70, Train loss: 1.090, Test loss: 1.562, Test accuracy: 52.51
Round  70, Global train loss: 1.090, Global test loss: 1.550, Global test accuracy: 48.97
Round  71, Train loss: 0.825, Test loss: 1.532, Test accuracy: 52.88
Round  71, Global train loss: 0.825, Global test loss: 1.463, Global test accuracy: 53.95
Round  72, Train loss: 0.959, Test loss: 1.569, Test accuracy: 52.59
Round  72, Global train loss: 0.959, Global test loss: 1.588, Global test accuracy: 49.99
Round  73, Train loss: 0.950, Test loss: 1.571, Test accuracy: 52.35
Round  73, Global train loss: 0.950, Global test loss: 1.581, Global test accuracy: 49.89
Round  74, Train loss: 0.804, Test loss: 1.569, Test accuracy: 52.36
Round  74, Global train loss: 0.804, Global test loss: 1.580, Global test accuracy: 51.16
Round  75, Train loss: 0.852, Test loss: 1.568, Test accuracy: 52.26
Round  75, Global train loss: 0.852, Global test loss: 1.401, Global test accuracy: 53.89
Round  76, Train loss: 0.884, Test loss: 1.601, Test accuracy: 52.19
Round  76, Global train loss: 0.884, Global test loss: 1.664, Global test accuracy: 48.61
Round  77, Train loss: 1.056, Test loss: 1.599, Test accuracy: 52.44
Round  77, Global train loss: 1.056, Global test loss: 1.524, Global test accuracy: 50.23
Round  78, Train loss: 0.937, Test loss: 1.604, Test accuracy: 52.64
Round  78, Global train loss: 0.937, Global test loss: 1.586, Global test accuracy: 49.00
Round  79, Train loss: 0.697, Test loss: 1.631, Test accuracy: 52.17
Round  79, Global train loss: 0.697, Global test loss: 1.531, Global test accuracy: 54.39
Round  80, Train loss: 0.831, Test loss: 1.626, Test accuracy: 52.47
Round  80, Global train loss: 0.831, Global test loss: 1.465, Global test accuracy: 53.45
Round  81, Train loss: 0.841, Test loss: 1.641, Test accuracy: 52.23
Round  81, Global train loss: 0.841, Global test loss: 1.443, Global test accuracy: 54.40
Round  82, Train loss: 0.809, Test loss: 1.619, Test accuracy: 52.64
Round  82, Global train loss: 0.809, Global test loss: 1.427, Global test accuracy: 54.67
Round  83, Train loss: 0.999, Test loss: 1.620, Test accuracy: 52.68
Round  83, Global train loss: 0.999, Global test loss: 1.442, Global test accuracy: 52.98
Round  84, Train loss: 0.789, Test loss: 1.619, Test accuracy: 52.56
Round  84, Global train loss: 0.789, Global test loss: 1.722, Global test accuracy: 48.53
Round  85, Train loss: 0.720, Test loss: 1.639, Test accuracy: 52.46
Round  85, Global train loss: 0.720, Global test loss: 1.647, Global test accuracy: 49.72
Round  86, Train loss: 1.003, Test loss: 1.639, Test accuracy: 52.52
Round  86, Global train loss: 1.003, Global test loss: 1.706, Global test accuracy: 46.42
Round  87, Train loss: 0.998, Test loss: 1.669, Test accuracy: 52.42
Round  87, Global train loss: 0.998, Global test loss: 1.687, Global test accuracy: 48.03
Round  88, Train loss: 0.719, Test loss: 1.693, Test accuracy: 52.14
Round  88, Global train loss: 0.719, Global test loss: 1.506, Global test accuracy: 54.36
Round  89, Train loss: 0.894, Test loss: 1.696, Test accuracy: 51.57
Round  89, Global train loss: 0.894, Global test loss: 1.503, Global test accuracy: 51.79
Round  90, Train loss: 0.965, Test loss: 1.686, Test accuracy: 51.86
Round  90, Global train loss: 0.965, Global test loss: 1.662, Global test accuracy: 47.88
Round  91, Train loss: 0.903, Test loss: 1.670, Test accuracy: 52.06
Round  91, Global train loss: 0.903, Global test loss: 1.607, Global test accuracy: 50.11
Round  92, Train loss: 0.892, Test loss: 1.670, Test accuracy: 52.51
Round  92, Global train loss: 0.892, Global test loss: 1.577, Global test accuracy: 50.70
Round  93, Train loss: 0.881, Test loss: 1.668, Test accuracy: 52.55
Round  93, Global train loss: 0.881, Global test loss: 1.518, Global test accuracy: 53.26
Round  94, Train loss: 0.824, Test loss: 1.690, Test accuracy: 51.81
Round  94, Global train loss: 0.824, Global test loss: 1.669, Global test accuracy: 48.92
Round  95, Train loss: 0.814, Test loss: 1.700, Test accuracy: 52.33
Round  95, Global train loss: 0.814, Global test loss: 1.571, Global test accuracy: 52.28
Round  96, Train loss: 0.749, Test loss: 1.693, Test accuracy: 52.27
Round  96, Global train loss: 0.749, Global test loss: 1.444, Global test accuracy: 55.08
Round  97, Train loss: 0.747, Test loss: 1.692, Test accuracy: 52.41
Round  97, Global train loss: 0.747, Global test loss: 1.567, Global test accuracy: 55.30
Round  98, Train loss: 0.800, Test loss: 1.691, Test accuracy: 52.24
Round  98, Global train loss: 0.800, Global test loss: 1.456, Global test accuracy: 54.39
Round  99, Train loss: 0.878, Test loss: 1.683, Test accuracy: 52.33
Round  99, Global train loss: 0.878, Global test loss: 1.713, Global test accuracy: 47.85
Final Round, Train loss: 0.572, Test loss: 1.967, Test accuracy: 51.99
Final Round, Global train loss: 0.572, Global test loss: 1.713, Global test accuracy: 47.85
Average accuracy final 10 rounds: 52.239285714285714 

Average global accuracy final 10 rounds: 51.57642857142858 

2025.1760320663452
[1.8958213329315186, 3.791642665863037, 5.403308868408203, 7.014975070953369, 8.622550249099731, 10.230125427246094, 11.8420250415802, 13.453924655914307, 15.068639516830444, 16.683354377746582, 18.303407669067383, 19.923460960388184, 21.530935525894165, 23.138410091400146, 24.743993282318115, 26.349576473236084, 27.949993133544922, 29.55040979385376, 31.16191792488098, 32.7734260559082, 34.39260196685791, 36.01177787780762, 37.63346982002258, 39.25516176223755, 40.887617349624634, 42.52007293701172, 44.154534339904785, 45.78899574279785, 47.428224086761475, 49.0674524307251, 50.70548224449158, 52.34351205825806, 53.99019432067871, 55.636876583099365, 57.27460193634033, 58.9123272895813, 60.55327820777893, 62.19422912597656, 63.83387875556946, 65.47352838516235, 67.12137389183044, 68.76921939849854, 70.41173839569092, 72.0542573928833, 73.69379901885986, 75.33334064483643, 76.97508406639099, 78.61682748794556, 80.24856758117676, 81.88030767440796, 83.52071380615234, 85.16111993789673, 86.79578948020935, 88.43045902252197, 90.06305694580078, 91.69565486907959, 93.33147764205933, 94.96730041503906, 96.60600876808167, 98.24471712112427, 99.87630152702332, 101.50788593292236, 103.14437747001648, 104.7808690071106, 106.42071294784546, 108.06055688858032, 109.69654107093811, 111.3325252532959, 112.9735004901886, 114.6144757270813, 116.24872088432312, 117.88296604156494, 119.52336406707764, 121.16376209259033, 122.79567837715149, 124.42759466171265, 126.06205081939697, 127.6965069770813, 129.33165192604065, 130.966796875, 132.60255002975464, 134.23830318450928, 135.87477040290833, 137.51123762130737, 139.15248799324036, 140.79373836517334, 142.4284863471985, 144.06323432922363, 145.6999535560608, 147.33667278289795, 148.9713077545166, 150.60594272613525, 152.24326467514038, 153.8805866241455, 155.51628851890564, 157.15199041366577, 158.78998398780823, 160.42797756195068, 162.06206822395325, 163.6961588859558, 165.33167171478271, 166.96718454360962, 168.60318517684937, 170.2391858100891, 171.87960171699524, 173.52001762390137, 175.1521577835083, 176.78429794311523, 178.41773414611816, 180.0511703491211, 181.69016122817993, 183.32915210723877, 184.962229013443, 186.59530591964722, 188.22625494003296, 189.8572039604187, 191.48802089691162, 193.11883783340454, 194.74912762641907, 196.3794174194336, 198.0135989189148, 199.647780418396, 201.28020119667053, 202.91262197494507, 204.54359912872314, 206.17457628250122, 207.8085196018219, 209.44246292114258, 211.07976651191711, 212.71707010269165, 214.35541677474976, 215.99376344680786, 217.6298942565918, 219.26602506637573, 220.89784336090088, 222.52966165542603, 224.14807534217834, 225.76648902893066, 227.36928057670593, 228.9720721244812, 230.5046215057373, 232.0371708869934, 233.5688886642456, 235.1006064414978, 236.63597583770752, 238.17134523391724, 239.7037959098816, 241.23624658584595, 242.8717803955078, 244.50731420516968, 246.13632559776306, 247.76533699035645, 249.40227627754211, 251.03921556472778, 252.67517828941345, 254.31114101409912, 255.9405484199524, 257.56995582580566, 259.20198249816895, 260.8340091705322, 262.46789288520813, 264.10177659988403, 265.730313539505, 267.358850479126, 268.98911356925964, 270.6193766593933, 272.24841499328613, 273.87745332717896, 275.511039018631, 277.144624710083, 278.7783887386322, 280.4121527671814, 282.05105686187744, 283.6899609565735, 285.3280131816864, 286.9660654067993, 288.6082637310028, 290.2504620552063, 291.88248443603516, 293.514506816864, 295.1489899158478, 296.78347301483154, 298.41737246513367, 300.0512719154358, 301.68857312202454, 303.3258743286133, 304.9635601043701, 306.60124588012695, 308.23633790016174, 309.87142992019653, 311.50366854667664, 313.13590717315674, 314.7799048423767, 316.4239025115967, 318.0638391971588, 319.70377588272095, 321.34220457077026, 322.9806332588196, 324.6162374019623, 326.251841545105, 328.5903651714325, 330.92888879776]
[20.42142857142857, 20.42142857142857, 27.435714285714287, 27.435714285714287, 30.192857142857143, 30.192857142857143, 35.135714285714286, 35.135714285714286, 38.84285714285714, 38.84285714285714, 39.95, 39.95, 42.357142857142854, 42.357142857142854, 44.285714285714285, 44.285714285714285, 45.75714285714286, 45.75714285714286, 46.65, 46.65, 48.06428571428572, 48.06428571428572, 47.82142857142857, 47.82142857142857, 48.857142857142854, 48.857142857142854, 49.45, 49.45, 49.785714285714285, 49.785714285714285, 51.121428571428574, 51.121428571428574, 51.59285714285714, 51.59285714285714, 51.9, 51.9, 51.957142857142856, 51.957142857142856, 52.18571428571428, 52.18571428571428, 52.55, 52.55, 52.65, 52.65, 52.885714285714286, 52.885714285714286, 52.59285714285714, 52.59285714285714, 52.59285714285714, 52.59285714285714, 52.635714285714286, 52.635714285714286, 53.01428571428571, 53.01428571428571, 53.08571428571429, 53.08571428571429, 52.892857142857146, 52.892857142857146, 52.84285714285714, 52.84285714285714, 52.67142857142857, 52.67142857142857, 52.621428571428574, 52.621428571428574, 52.57857142857143, 52.57857142857143, 52.49285714285714, 52.49285714285714, 52.628571428571426, 52.628571428571426, 53.32857142857143, 53.32857142857143, 53.42857142857143, 53.42857142857143, 53.68571428571428, 53.68571428571428, 53.614285714285714, 53.614285714285714, 53.892857142857146, 53.892857142857146, 53.72142857142857, 53.72142857142857, 53.07857142857143, 53.07857142857143, 52.464285714285715, 52.464285714285715, 52.09285714285714, 52.09285714285714, 52.1, 52.1, 52.07857142857143, 52.07857142857143, 52.107142857142854, 52.107142857142854, 52.6, 52.6, 52.77857142857143, 52.77857142857143, 53.107142857142854, 53.107142857142854, 52.65, 52.65, 53.392857142857146, 53.392857142857146, 53.607142857142854, 53.607142857142854, 53.06428571428572, 53.06428571428572, 52.864285714285714, 52.864285714285714, 52.42857142857143, 52.42857142857143, 52.73571428571429, 52.73571428571429, 53.035714285714285, 53.035714285714285, 52.635714285714286, 52.635714285714286, 52.48571428571429, 52.48571428571429, 52.392857142857146, 52.392857142857146, 52.371428571428574, 52.371428571428574, 52.84285714285714, 52.84285714285714, 52.35, 52.35, 52.385714285714286, 52.385714285714286, 52.464285714285715, 52.464285714285715, 52.08571428571429, 52.08571428571429, 52.392857142857146, 52.392857142857146, 51.892857142857146, 51.892857142857146, 51.90714285714286, 51.90714285714286, 52.50714285714286, 52.50714285714286, 52.878571428571426, 52.878571428571426, 52.58571428571429, 52.58571428571429, 52.35, 52.35, 52.357142857142854, 52.357142857142854, 52.26428571428571, 52.26428571428571, 52.19285714285714, 52.19285714285714, 52.43571428571428, 52.43571428571428, 52.635714285714286, 52.635714285714286, 52.17142857142857, 52.17142857142857, 52.47142857142857, 52.47142857142857, 52.22857142857143, 52.22857142857143, 52.642857142857146, 52.642857142857146, 52.67857142857143, 52.67857142857143, 52.56428571428572, 52.56428571428572, 52.457142857142856, 52.457142857142856, 52.52142857142857, 52.52142857142857, 52.42142857142857, 52.42142857142857, 52.135714285714286, 52.135714285714286, 51.57142857142857, 51.57142857142857, 51.864285714285714, 51.864285714285714, 52.06428571428572, 52.06428571428572, 52.51428571428571, 52.51428571428571, 52.55, 52.55, 51.81428571428572, 51.81428571428572, 52.32857142857143, 52.32857142857143, 52.27142857142857, 52.27142857142857, 52.41428571428571, 52.41428571428571, 52.24285714285714, 52.24285714285714, 52.32857142857143, 52.32857142857143, 51.98571428571429, 51.98571428571429]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 7, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.970, Test loss: 2.111, Test accuracy: 21.91
Round   0, Global train loss: 1.970, Global test loss: 2.216, Global test accuracy: 21.35
Round   1, Train loss: 1.919, Test loss: 1.969, Test accuracy: 25.66
Round   1, Global train loss: 1.919, Global test loss: 2.107, Global test accuracy: 23.63
Round   2, Train loss: 1.913, Test loss: 1.868, Test accuracy: 30.49
Round   2, Global train loss: 1.913, Global test loss: 2.045, Global test accuracy: 26.73
Round   3, Train loss: 1.847, Test loss: 1.767, Test accuracy: 32.69
Round   3, Global train loss: 1.847, Global test loss: 1.903, Global test accuracy: 30.25
Round   4, Train loss: 1.788, Test loss: 1.672, Test accuracy: 36.74
Round   4, Global train loss: 1.788, Global test loss: 1.875, Global test accuracy: 32.69
Round   5, Train loss: 1.772, Test loss: 1.639, Test accuracy: 37.93
Round   5, Global train loss: 1.772, Global test loss: 1.912, Global test accuracy: 29.64
Round   6, Train loss: 1.749, Test loss: 1.605, Test accuracy: 39.92
Round   6, Global train loss: 1.749, Global test loss: 1.748, Global test accuracy: 38.74
Round   7, Train loss: 1.655, Test loss: 1.591, Test accuracy: 40.46
Round   7, Global train loss: 1.655, Global test loss: 1.683, Global test accuracy: 41.90
Round   8, Train loss: 1.785, Test loss: 1.569, Test accuracy: 42.42
Round   8, Global train loss: 1.785, Global test loss: 1.763, Global test accuracy: 38.27
Round   9, Train loss: 1.735, Test loss: 1.542, Test accuracy: 44.28
Round   9, Global train loss: 1.735, Global test loss: 1.768, Global test accuracy: 39.47
Round  10, Train loss: 1.705, Test loss: 1.527, Test accuracy: 45.51
Round  10, Global train loss: 1.705, Global test loss: 1.731, Global test accuracy: 40.99
Round  11, Train loss: 1.718, Test loss: 1.529, Test accuracy: 45.63
Round  11, Global train loss: 1.718, Global test loss: 1.710, Global test accuracy: 42.93
Round  12, Train loss: 1.655, Test loss: 1.488, Test accuracy: 47.21
Round  12, Global train loss: 1.655, Global test loss: 1.685, Global test accuracy: 41.66
Round  13, Train loss: 1.576, Test loss: 1.480, Test accuracy: 47.71
Round  13, Global train loss: 1.576, Global test loss: 1.631, Global test accuracy: 42.72
Round  14, Train loss: 1.705, Test loss: 1.457, Test accuracy: 49.24
Round  14, Global train loss: 1.705, Global test loss: 1.666, Global test accuracy: 44.17
Round  15, Train loss: 1.605, Test loss: 1.433, Test accuracy: 50.29
Round  15, Global train loss: 1.605, Global test loss: 1.578, Global test accuracy: 47.16
Round  16, Train loss: 1.645, Test loss: 1.417, Test accuracy: 51.19
Round  16, Global train loss: 1.645, Global test loss: 1.628, Global test accuracy: 46.96
Round  17, Train loss: 1.675, Test loss: 1.417, Test accuracy: 50.76
Round  17, Global train loss: 1.675, Global test loss: 1.604, Global test accuracy: 48.63
Round  18, Train loss: 1.574, Test loss: 1.417, Test accuracy: 50.67
Round  18, Global train loss: 1.574, Global test loss: 1.573, Global test accuracy: 46.66
Round  19, Train loss: 1.575, Test loss: 1.411, Test accuracy: 50.99
Round  19, Global train loss: 1.575, Global test loss: 1.510, Global test accuracy: 51.38
Round  20, Train loss: 1.666, Test loss: 1.379, Test accuracy: 52.56
Round  20, Global train loss: 1.666, Global test loss: 1.628, Global test accuracy: 46.69
Round  21, Train loss: 1.569, Test loss: 1.378, Test accuracy: 52.02
Round  21, Global train loss: 1.569, Global test loss: 1.520, Global test accuracy: 51.46
Round  22, Train loss: 1.712, Test loss: 1.373, Test accuracy: 51.98
Round  22, Global train loss: 1.712, Global test loss: 1.645, Global test accuracy: 47.01
Round  23, Train loss: 1.496, Test loss: 1.376, Test accuracy: 51.86
Round  23, Global train loss: 1.496, Global test loss: 1.513, Global test accuracy: 49.48
Round  24, Train loss: 1.463, Test loss: 1.370, Test accuracy: 52.23
Round  24, Global train loss: 1.463, Global test loss: 1.435, Global test accuracy: 53.69
Round  25, Train loss: 1.392, Test loss: 1.366, Test accuracy: 52.24
Round  25, Global train loss: 1.392, Global test loss: 1.485, Global test accuracy: 51.07
Round  26, Train loss: 1.563, Test loss: 1.359, Test accuracy: 52.47
Round  26, Global train loss: 1.563, Global test loss: 1.535, Global test accuracy: 49.68
Round  27, Train loss: 1.425, Test loss: 1.340, Test accuracy: 53.31
Round  27, Global train loss: 1.425, Global test loss: 1.521, Global test accuracy: 49.50
Round  28, Train loss: 1.464, Test loss: 1.333, Test accuracy: 53.69
Round  28, Global train loss: 1.464, Global test loss: 1.534, Global test accuracy: 47.59
Round  29, Train loss: 1.400, Test loss: 1.336, Test accuracy: 53.62
Round  29, Global train loss: 1.400, Global test loss: 1.541, Global test accuracy: 50.11
Round  30, Train loss: 1.430, Test loss: 1.336, Test accuracy: 53.51
Round  30, Global train loss: 1.430, Global test loss: 1.501, Global test accuracy: 51.11
Round  31, Train loss: 1.522, Test loss: 1.325, Test accuracy: 54.22
Round  31, Global train loss: 1.522, Global test loss: 1.435, Global test accuracy: 55.50
Round  32, Train loss: 1.347, Test loss: 1.311, Test accuracy: 54.87
Round  32, Global train loss: 1.347, Global test loss: 1.416, Global test accuracy: 53.01
Round  33, Train loss: 1.252, Test loss: 1.305, Test accuracy: 55.21
Round  33, Global train loss: 1.252, Global test loss: 1.343, Global test accuracy: 55.52
Round  34, Train loss: 1.581, Test loss: 1.295, Test accuracy: 55.50
Round  34, Global train loss: 1.581, Global test loss: 1.509, Global test accuracy: 51.52
Round  35, Train loss: 1.469, Test loss: 1.302, Test accuracy: 55.14
Round  35, Global train loss: 1.469, Global test loss: 1.509, Global test accuracy: 51.05
Round  36, Train loss: 1.483, Test loss: 1.298, Test accuracy: 55.51
Round  36, Global train loss: 1.483, Global test loss: 1.526, Global test accuracy: 49.79
Round  37, Train loss: 1.269, Test loss: 1.293, Test accuracy: 55.87
Round  37, Global train loss: 1.269, Global test loss: 1.357, Global test accuracy: 55.32
Round  38, Train loss: 1.273, Test loss: 1.291, Test accuracy: 55.97
Round  38, Global train loss: 1.273, Global test loss: 1.367, Global test accuracy: 54.43
Round  39, Train loss: 1.505, Test loss: 1.293, Test accuracy: 55.52
Round  39, Global train loss: 1.505, Global test loss: 1.479, Global test accuracy: 52.13
Round  40, Train loss: 1.255, Test loss: 1.304, Test accuracy: 55.21
Round  40, Global train loss: 1.255, Global test loss: 1.368, Global test accuracy: 55.21
Round  41, Train loss: 1.445, Test loss: 1.307, Test accuracy: 55.05
Round  41, Global train loss: 1.445, Global test loss: 1.425, Global test accuracy: 54.99
Round  42, Train loss: 1.282, Test loss: 1.303, Test accuracy: 55.24
Round  42, Global train loss: 1.282, Global test loss: 1.406, Global test accuracy: 52.77
Round  43, Train loss: 1.319, Test loss: 1.297, Test accuracy: 55.52
Round  43, Global train loss: 1.319, Global test loss: 1.398, Global test accuracy: 54.74
Round  44, Train loss: 1.305, Test loss: 1.298, Test accuracy: 55.44
Round  44, Global train loss: 1.305, Global test loss: 1.443, Global test accuracy: 51.67
Round  45, Train loss: 1.393, Test loss: 1.302, Test accuracy: 55.33
Round  45, Global train loss: 1.393, Global test loss: 1.476, Global test accuracy: 51.10
Round  46, Train loss: 1.467, Test loss: 1.301, Test accuracy: 55.51
Round  46, Global train loss: 1.467, Global test loss: 1.535, Global test accuracy: 50.61
Round  47, Train loss: 1.249, Test loss: 1.309, Test accuracy: 55.45
Round  47, Global train loss: 1.249, Global test loss: 1.483, Global test accuracy: 54.00
Round  48, Train loss: 1.216, Test loss: 1.304, Test accuracy: 55.56
Round  48, Global train loss: 1.216, Global test loss: 1.437, Global test accuracy: 53.73
Round  49, Train loss: 1.357, Test loss: 1.298, Test accuracy: 55.96
Round  49, Global train loss: 1.357, Global test loss: 1.427, Global test accuracy: 55.56
Round  50, Train loss: 1.214, Test loss: 1.302, Test accuracy: 55.94
Round  50, Global train loss: 1.214, Global test loss: 1.461, Global test accuracy: 54.25
Round  51, Train loss: 1.365, Test loss: 1.317, Test accuracy: 55.47
Round  51, Global train loss: 1.365, Global test loss: 1.445, Global test accuracy: 53.61
Round  52, Train loss: 1.217, Test loss: 1.328, Test accuracy: 55.20
Round  52, Global train loss: 1.217, Global test loss: 1.401, Global test accuracy: 53.89
Round  53, Train loss: 1.166, Test loss: 1.341, Test accuracy: 54.66
Round  53, Global train loss: 1.166, Global test loss: 1.383, Global test accuracy: 54.44
Round  54, Train loss: 1.265, Test loss: 1.343, Test accuracy: 54.89
Round  54, Global train loss: 1.265, Global test loss: 1.437, Global test accuracy: 53.66
Round  55, Train loss: 1.015, Test loss: 1.356, Test accuracy: 54.51
Round  55, Global train loss: 1.015, Global test loss: 1.377, Global test accuracy: 54.81
Round  56, Train loss: 1.192, Test loss: 1.368, Test accuracy: 53.71
Round  56, Global train loss: 1.192, Global test loss: 1.383, Global test accuracy: 54.50
Round  57, Train loss: 1.098, Test loss: 1.363, Test accuracy: 54.16
Round  57, Global train loss: 1.098, Global test loss: 1.382, Global test accuracy: 54.73
Round  58, Train loss: 1.164, Test loss: 1.351, Test accuracy: 54.63
Round  58, Global train loss: 1.164, Global test loss: 1.356, Global test accuracy: 55.25
Round  59, Train loss: 1.147, Test loss: 1.367, Test accuracy: 53.89
Round  59, Global train loss: 1.147, Global test loss: 1.364, Global test accuracy: 55.96
Round  60, Train loss: 1.138, Test loss: 1.359, Test accuracy: 54.49
Round  60, Global train loss: 1.138, Global test loss: 1.373, Global test accuracy: 53.86
Round  61, Train loss: 1.146, Test loss: 1.360, Test accuracy: 54.54
Round  61, Global train loss: 1.146, Global test loss: 1.437, Global test accuracy: 52.90
Round  62, Train loss: 0.972, Test loss: 1.367, Test accuracy: 54.59
Round  62, Global train loss: 0.972, Global test loss: 1.281, Global test accuracy: 58.68
Round  63, Train loss: 1.206, Test loss: 1.368, Test accuracy: 54.51
Round  63, Global train loss: 1.206, Global test loss: 1.434, Global test accuracy: 54.02
Round  64, Train loss: 1.115, Test loss: 1.360, Test accuracy: 54.81
Round  64, Global train loss: 1.115, Global test loss: 1.341, Global test accuracy: 55.64
Round  65, Train loss: 1.177, Test loss: 1.371, Test accuracy: 54.42
Round  65, Global train loss: 1.177, Global test loss: 1.459, Global test accuracy: 52.94
Round  66, Train loss: 1.190, Test loss: 1.370, Test accuracy: 54.42
Round  66, Global train loss: 1.190, Global test loss: 1.467, Global test accuracy: 51.55
Round  67, Train loss: 1.140, Test loss: 1.374, Test accuracy: 54.31
Round  67, Global train loss: 1.140, Global test loss: 1.431, Global test accuracy: 53.34
Round  68, Train loss: 1.185, Test loss: 1.392, Test accuracy: 54.09
Round  68, Global train loss: 1.185, Global test loss: 1.428, Global test accuracy: 53.21
Round  69, Train loss: 1.095, Test loss: 1.407, Test accuracy: 53.74
Round  69, Global train loss: 1.095, Global test loss: 1.557, Global test accuracy: 50.86
Round  70, Train loss: 1.119, Test loss: 1.400, Test accuracy: 53.84
Round  70, Global train loss: 1.119, Global test loss: 1.386, Global test accuracy: 54.59
Round  71, Train loss: 0.981, Test loss: 1.381, Test accuracy: 54.31
Round  71, Global train loss: 0.981, Global test loss: 1.404, Global test accuracy: 54.24
Round  72, Train loss: 1.071, Test loss: 1.402, Test accuracy: 54.06
Round  72, Global train loss: 1.071, Global test loss: 1.486, Global test accuracy: 51.11
Round  73, Train loss: 1.204, Test loss: 1.414, Test accuracy: 53.91
Round  73, Global train loss: 1.204, Global test loss: 1.535, Global test accuracy: 50.64
Round  74, Train loss: 0.990, Test loss: 1.418, Test accuracy: 54.11
Round  74, Global train loss: 0.990, Global test loss: 1.551, Global test accuracy: 50.00
Round  75, Train loss: 1.097, Test loss: 1.433, Test accuracy: 54.05
Round  75, Global train loss: 1.097, Global test loss: 1.399, Global test accuracy: 54.45
Round  76, Train loss: 1.009, Test loss: 1.431, Test accuracy: 53.89
Round  76, Global train loss: 1.009, Global test loss: 1.552, Global test accuracy: 50.43
Round  77, Train loss: 1.161, Test loss: 1.437, Test accuracy: 53.82
Round  77, Global train loss: 1.161, Global test loss: 1.434, Global test accuracy: 53.70
Round  78, Train loss: 0.961, Test loss: 1.424, Test accuracy: 53.66
Round  78, Global train loss: 0.961, Global test loss: 1.470, Global test accuracy: 52.36
Round  79, Train loss: 1.054, Test loss: 1.448, Test accuracy: 53.61
Round  79, Global train loss: 1.054, Global test loss: 1.487, Global test accuracy: 52.63
Round  80, Train loss: 0.918, Test loss: 1.472, Test accuracy: 53.05
Round  80, Global train loss: 0.918, Global test loss: 1.396, Global test accuracy: 55.29
Round  81, Train loss: 1.065, Test loss: 1.473, Test accuracy: 52.99
Round  81, Global train loss: 1.065, Global test loss: 1.436, Global test accuracy: 54.16
Round  82, Train loss: 0.819, Test loss: 1.473, Test accuracy: 52.87
Round  82, Global train loss: 0.819, Global test loss: 1.337, Global test accuracy: 57.90
Round  83, Train loss: 1.160, Test loss: 1.458, Test accuracy: 53.52
Round  83, Global train loss: 1.160, Global test loss: 1.442, Global test accuracy: 52.60
Round  84, Train loss: 0.903, Test loss: 1.453, Test accuracy: 53.79
Round  84, Global train loss: 0.903, Global test loss: 1.538, Global test accuracy: 51.12
Round  85, Train loss: 0.944, Test loss: 1.479, Test accuracy: 53.76
Round  85, Global train loss: 0.944, Global test loss: 1.544, Global test accuracy: 50.96
Round  86, Train loss: 0.813, Test loss: 1.519, Test accuracy: 53.54
Round  86, Global train loss: 0.813, Global test loss: 1.419, Global test accuracy: 54.31
Round  87, Train loss: 1.134, Test loss: 1.522, Test accuracy: 53.41
Round  87, Global train loss: 1.134, Global test loss: 1.514, Global test accuracy: 51.85
Round  88, Train loss: 0.862, Test loss: 1.507, Test accuracy: 53.76
Round  88, Global train loss: 0.862, Global test loss: 1.416, Global test accuracy: 54.61
Round  89, Train loss: 0.925, Test loss: 1.499, Test accuracy: 53.41
Round  89, Global train loss: 0.925, Global test loss: 1.393, Global test accuracy: 54.66
Round  90, Train loss: 0.915, Test loss: 1.504, Test accuracy: 53.30
Round  90, Global train loss: 0.915, Global test loss: 1.457, Global test accuracy: 53.83
Round  91, Train loss: 0.895, Test loss: 1.507, Test accuracy: 53.84
Round  91, Global train loss: 0.895, Global test loss: 1.486, Global test accuracy: 53.74
Round  92, Train loss: 1.064, Test loss: 1.515, Test accuracy: 53.27
Round  92, Global train loss: 1.064, Global test loss: 1.526, Global test accuracy: 51.76
Round  93, Train loss: 1.060, Test loss: 1.514, Test accuracy: 53.41
Round  93, Global train loss: 1.060, Global test loss: 1.522, Global test accuracy: 52.28
Round  94, Train loss: 0.918, Test loss: 1.522, Test accuracy: 53.02
Round  94, Global train loss: 0.918, Global test loss: 1.534, Global test accuracy: 51.64
Round  95, Train loss: 0.924, Test loss: 1.554, Test accuracy: 53.14
Round  95, Global train loss: 0.924, Global test loss: 1.520, Global test accuracy: 51.59
Round  96, Train loss: 0.745, Test loss: 1.566, Test accuracy: 52.80
Round  96, Global train loss: 0.745, Global test loss: 1.375, Global test accuracy: 56.30
Round  97, Train loss: 0.915, Test loss: 1.562, Test accuracy: 52.76
Round  97, Global train loss: 0.915, Global test loss: 1.542, Global test accuracy: 53.27
Round  98, Train loss: 0.912, Test loss: 1.558, Test accuracy: 53.19
Round  98, Global train loss: 0.912, Global test loss: 1.407, Global test accuracy: 56.12
Round  99, Train loss: 0.877, Test loss: 1.576, Test accuracy: 52.85
Round  99, Global train loss: 0.877, Global test loss: 1.587, Global test accuracy: 51.36
Final Round, Train loss: 0.707, Test loss: 1.727, Test accuracy: 52.19
Final Round, Global train loss: 0.707, Global test loss: 1.587, Global test accuracy: 51.36
Average accuracy final 10 rounds: 53.158571428571435 

Average global accuracy final 10 rounds: 53.189285714285724 

2070.3712508678436
[1.9970777034759521, 3.9941554069519043, 5.725577354431152, 7.4569993019104, 9.18706727027893, 10.917135238647461, 12.659635543823242, 14.402135848999023, 16.146526098251343, 17.890916347503662, 19.63187336921692, 21.372830390930176, 23.112386226654053, 24.85194206237793, 26.595271825790405, 28.33860158920288, 30.076659202575684, 31.814716815948486, 33.555437326431274, 35.29615783691406, 37.040627002716064, 38.785096168518066, 40.5263249874115, 42.26755380630493, 44.01275634765625, 45.75795888900757, 47.49839687347412, 49.238834857940674, 50.97877025604248, 52.71870565414429, 54.46232295036316, 56.20594024658203, 57.920716285705566, 59.6354923248291, 61.37093377113342, 63.106375217437744, 64.8493640422821, 66.59235286712646, 68.33271479606628, 70.0730767250061, 71.81148529052734, 73.54989385604858, 75.293612241745, 77.0373306274414, 78.77393126487732, 80.51053190231323, 82.24521040916443, 83.97988891601562, 85.714106798172, 87.44832468032837, 89.18818545341492, 90.92804622650146, 92.67082333564758, 94.4136004447937, 96.15195345878601, 97.89030647277832, 99.62675738334656, 101.3632082939148, 103.10416150093079, 104.84511470794678, 106.58298444747925, 108.32085418701172, 110.06120538711548, 111.80155658721924, 113.53761196136475, 115.27366733551025, 117.00900840759277, 118.7443494796753, 120.46571850776672, 122.18708753585815, 123.90405988693237, 125.62103223800659, 127.2603018283844, 128.8995714187622, 130.53917574882507, 132.17878007888794, 133.91082096099854, 135.64286184310913, 137.3786153793335, 139.11436891555786, 140.8464241027832, 142.57847929000854, 144.30732989311218, 146.03618049621582, 147.77066445350647, 149.50514841079712, 151.23815727233887, 152.97116613388062, 154.70556688308716, 156.4399676322937, 158.1767098903656, 159.9134521484375, 161.6532759666443, 163.39309978485107, 165.13317894935608, 166.87325811386108, 168.59914660453796, 170.32503509521484, 172.05322790145874, 173.78142070770264, 175.50878620147705, 177.23615169525146, 178.9620497226715, 180.68794775009155, 182.3252980709076, 183.96264839172363, 185.6715269088745, 187.3804054260254, 189.1162850856781, 190.8521647453308, 192.58328080177307, 194.31439685821533, 196.04203367233276, 197.7696704864502, 199.50297284126282, 201.23627519607544, 202.94756650924683, 204.6588578224182, 206.36998200416565, 208.0811061859131, 209.789785861969, 211.4984655380249, 213.2130525112152, 214.92763948440552, 216.64179706573486, 218.3559546470642, 220.07550978660583, 221.79506492614746, 223.52649116516113, 225.2579174041748, 226.99126410484314, 228.72461080551147, 230.4599461555481, 232.19528150558472, 233.92129158973694, 235.64730167388916, 237.371440410614, 239.09557914733887, 240.82366299629211, 242.55174684524536, 244.28281235694885, 246.01387786865234, 247.73991894721985, 249.46596002578735, 251.1885232925415, 252.91108655929565, 254.63902282714844, 256.3669590950012, 258.0901093482971, 259.813259601593, 261.5403733253479, 263.2674870491028, 264.9886784553528, 266.7098698616028, 268.4327754974365, 270.15568113327026, 271.88222432136536, 273.60876750946045, 275.33993887901306, 277.0711102485657, 278.80282258987427, 280.53453493118286, 282.2608063220978, 283.9870777130127, 285.7115144729614, 287.43595123291016, 289.16757106781006, 290.89919090270996, 292.6217715740204, 294.3443522453308, 296.0738613605499, 297.80337047576904, 299.53325057029724, 301.26313066482544, 302.98749828338623, 304.711865901947, 306.44084334373474, 308.16982078552246, 309.8959150314331, 311.62200927734375, 313.3461468219757, 315.07028436660767, 316.7965269088745, 318.52276945114136, 320.2505645751953, 321.97835969924927, 323.7081410884857, 325.43792247772217, 327.16019320487976, 328.88246393203735, 330.60975527763367, 332.33704662323, 334.0672929286957, 335.7975392341614, 337.5232951641083, 339.2490510940552, 340.95155024528503, 342.6540493965149, 344.3830146789551, 346.11197996139526, 348.5790514945984, 351.0461230278015]
[21.90714285714286, 21.90714285714286, 25.664285714285715, 25.664285714285715, 30.492857142857144, 30.492857142857144, 32.69285714285714, 32.69285714285714, 36.73571428571429, 36.73571428571429, 37.92857142857143, 37.92857142857143, 39.92142857142857, 39.92142857142857, 40.464285714285715, 40.464285714285715, 42.42142857142857, 42.42142857142857, 44.27857142857143, 44.27857142857143, 45.50714285714286, 45.50714285714286, 45.628571428571426, 45.628571428571426, 47.207142857142856, 47.207142857142856, 47.707142857142856, 47.707142857142856, 49.24285714285714, 49.24285714285714, 50.292857142857144, 50.292857142857144, 51.19285714285714, 51.19285714285714, 50.76428571428571, 50.76428571428571, 50.67142857142857, 50.67142857142857, 50.98571428571429, 50.98571428571429, 52.55714285714286, 52.55714285714286, 52.02142857142857, 52.02142857142857, 51.97857142857143, 51.97857142857143, 51.857142857142854, 51.857142857142854, 52.22857142857143, 52.22857142857143, 52.24285714285714, 52.24285714285714, 52.47142857142857, 52.47142857142857, 53.31428571428572, 53.31428571428572, 53.68571428571428, 53.68571428571428, 53.621428571428574, 53.621428571428574, 53.51428571428571, 53.51428571428571, 54.22142857142857, 54.22142857142857, 54.871428571428574, 54.871428571428574, 55.214285714285715, 55.214285714285715, 55.5, 55.5, 55.142857142857146, 55.142857142857146, 55.50714285714286, 55.50714285714286, 55.871428571428574, 55.871428571428574, 55.97142857142857, 55.97142857142857, 55.52142857142857, 55.52142857142857, 55.207142857142856, 55.207142857142856, 55.05, 55.05, 55.23571428571429, 55.23571428571429, 55.52142857142857, 55.52142857142857, 55.44285714285714, 55.44285714285714, 55.32857142857143, 55.32857142857143, 55.50714285714286, 55.50714285714286, 55.45, 55.45, 55.56428571428572, 55.56428571428572, 55.957142857142856, 55.957142857142856, 55.94285714285714, 55.94285714285714, 55.47142857142857, 55.47142857142857, 55.2, 55.2, 54.65714285714286, 54.65714285714286, 54.885714285714286, 54.885714285714286, 54.50714285714286, 54.50714285714286, 53.714285714285715, 53.714285714285715, 54.15714285714286, 54.15714285714286, 54.628571428571426, 54.628571428571426, 53.892857142857146, 53.892857142857146, 54.49285714285714, 54.49285714285714, 54.535714285714285, 54.535714285714285, 54.58571428571429, 54.58571428571429, 54.50714285714286, 54.50714285714286, 54.80714285714286, 54.80714285714286, 54.42142857142857, 54.42142857142857, 54.42142857142857, 54.42142857142857, 54.31428571428572, 54.31428571428572, 54.09285714285714, 54.09285714285714, 53.74285714285714, 53.74285714285714, 53.84285714285714, 53.84285714285714, 54.31428571428572, 54.31428571428572, 54.06428571428572, 54.06428571428572, 53.91428571428571, 53.91428571428571, 54.114285714285714, 54.114285714285714, 54.05, 54.05, 53.892857142857146, 53.892857142857146, 53.82142857142857, 53.82142857142857, 53.65714285714286, 53.65714285714286, 53.607142857142854, 53.607142857142854, 53.05, 53.05, 52.98571428571429, 52.98571428571429, 52.871428571428574, 52.871428571428574, 53.52142857142857, 53.52142857142857, 53.792857142857144, 53.792857142857144, 53.76428571428571, 53.76428571428571, 53.542857142857144, 53.542857142857144, 53.40714285714286, 53.40714285714286, 53.76428571428571, 53.76428571428571, 53.41428571428571, 53.41428571428571, 53.3, 53.3, 53.83571428571429, 53.83571428571429, 53.27142857142857, 53.27142857142857, 53.41428571428571, 53.41428571428571, 53.02142857142857, 53.02142857142857, 53.142857142857146, 53.142857142857146, 52.8, 52.8, 52.76428571428571, 52.76428571428571, 53.18571428571428, 53.18571428571428, 52.85, 52.85, 52.19285714285714, 52.19285714285714]/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 7, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.987, Test loss: 2.154, Test accuracy: 17.76
Round   0, Global train loss: 1.987, Global test loss: 2.255, Global test accuracy: 15.33
Round   1, Train loss: 1.878, Test loss: 2.094, Test accuracy: 21.46
Round   1, Global train loss: 1.878, Global test loss: 2.266, Global test accuracy: 18.16
Round   2, Train loss: 1.878, Test loss: 2.004, Test accuracy: 26.38
Round   2, Global train loss: 1.878, Global test loss: 2.193, Global test accuracy: 23.81
Round   3, Train loss: 1.737, Test loss: 1.894, Test accuracy: 30.08
Round   3, Global train loss: 1.737, Global test loss: 2.038, Global test accuracy: 29.38
Round   4, Train loss: 1.827, Test loss: 1.799, Test accuracy: 34.82
Round   4, Global train loss: 1.827, Global test loss: 2.033, Global test accuracy: 28.31
Round   5, Train loss: 1.619, Test loss: 1.741, Test accuracy: 36.96
Round   5, Global train loss: 1.619, Global test loss: 2.012, Global test accuracy: 30.66
Round   6, Train loss: 1.677, Test loss: 1.686, Test accuracy: 39.29
Round   6, Global train loss: 1.677, Global test loss: 1.871, Global test accuracy: 33.73
Round   7, Train loss: 1.684, Test loss: 1.679, Test accuracy: 40.19
Round   7, Global train loss: 1.684, Global test loss: 1.837, Global test accuracy: 36.01
Round   8, Train loss: 1.682, Test loss: 1.648, Test accuracy: 40.62
Round   8, Global train loss: 1.682, Global test loss: 1.813, Global test accuracy: 35.20
Round   9, Train loss: 1.629, Test loss: 1.626, Test accuracy: 41.63
Round   9, Global train loss: 1.629, Global test loss: 1.902, Global test accuracy: 35.99
Round  10, Train loss: 1.580, Test loss: 1.626, Test accuracy: 42.11
Round  10, Global train loss: 1.580, Global test loss: 1.791, Global test accuracy: 37.86
Round  11, Train loss: 1.577, Test loss: 1.608, Test accuracy: 42.95
Round  11, Global train loss: 1.577, Global test loss: 1.766, Global test accuracy: 40.53
Round  12, Train loss: 1.587, Test loss: 1.574, Test accuracy: 44.44
Round  12, Global train loss: 1.587, Global test loss: 1.661, Global test accuracy: 41.98
Round  13, Train loss: 1.547, Test loss: 1.559, Test accuracy: 44.93
Round  13, Global train loss: 1.547, Global test loss: 1.698, Global test accuracy: 40.24
Round  14, Train loss: 1.716, Test loss: 1.532, Test accuracy: 45.62
Round  14, Global train loss: 1.716, Global test loss: 1.781, Global test accuracy: 41.68
Round  15, Train loss: 1.640, Test loss: 1.525, Test accuracy: 45.92
Round  15, Global train loss: 1.640, Global test loss: 1.726, Global test accuracy: 44.34
Round  16, Train loss: 1.511, Test loss: 1.526, Test accuracy: 46.46
Round  16, Global train loss: 1.511, Global test loss: 1.732, Global test accuracy: 42.17
Round  17, Train loss: 1.461, Test loss: 1.510, Test accuracy: 47.34
Round  17, Global train loss: 1.461, Global test loss: 1.628, Global test accuracy: 46.35
Round  18, Train loss: 1.483, Test loss: 1.488, Test accuracy: 47.95
Round  18, Global train loss: 1.483, Global test loss: 1.663, Global test accuracy: 43.97
Round  19, Train loss: 1.409, Test loss: 1.493, Test accuracy: 47.99
Round  19, Global train loss: 1.409, Global test loss: 1.605, Global test accuracy: 48.26
Round  20, Train loss: 1.444, Test loss: 1.481, Test accuracy: 48.93
Round  20, Global train loss: 1.444, Global test loss: 1.676, Global test accuracy: 44.90
Round  21, Train loss: 1.459, Test loss: 1.484, Test accuracy: 49.11
Round  21, Global train loss: 1.459, Global test loss: 1.609, Global test accuracy: 47.19
Round  22, Train loss: 1.454, Test loss: 1.501, Test accuracy: 48.44
Round  22, Global train loss: 1.454, Global test loss: 1.761, Global test accuracy: 42.06
Round  23, Train loss: 1.392, Test loss: 1.519, Test accuracy: 47.90
Round  23, Global train loss: 1.392, Global test loss: 1.637, Global test accuracy: 46.09
Round  24, Train loss: 1.490, Test loss: 1.540, Test accuracy: 47.54
Round  24, Global train loss: 1.490, Global test loss: 1.646, Global test accuracy: 47.18
Round  25, Train loss: 1.198, Test loss: 1.535, Test accuracy: 47.82
Round  25, Global train loss: 1.198, Global test loss: 1.547, Global test accuracy: 46.56
Round  26, Train loss: 1.454, Test loss: 1.500, Test accuracy: 48.56
Round  26, Global train loss: 1.454, Global test loss: 1.669, Global test accuracy: 43.48
Round  27, Train loss: 1.354, Test loss: 1.496, Test accuracy: 48.99
Round  27, Global train loss: 1.354, Global test loss: 1.640, Global test accuracy: 46.58
Round  28, Train loss: 1.448, Test loss: 1.494, Test accuracy: 49.18
Round  28, Global train loss: 1.448, Global test loss: 1.772, Global test accuracy: 46.46
Round  29, Train loss: 1.320, Test loss: 1.524, Test accuracy: 49.21
Round  29, Global train loss: 1.320, Global test loss: 1.755, Global test accuracy: 47.07
Round  30, Train loss: 1.235, Test loss: 1.542, Test accuracy: 49.43
Round  30, Global train loss: 1.235, Global test loss: 1.642, Global test accuracy: 49.36
Round  31, Train loss: 1.247, Test loss: 1.539, Test accuracy: 49.71
Round  31, Global train loss: 1.247, Global test loss: 1.537, Global test accuracy: 51.98
Round  32, Train loss: 1.210, Test loss: 1.566, Test accuracy: 50.03
Round  32, Global train loss: 1.210, Global test loss: 1.652, Global test accuracy: 48.61
Round  33, Train loss: 1.360, Test loss: 1.578, Test accuracy: 49.94
Round  33, Global train loss: 1.360, Global test loss: 1.698, Global test accuracy: 47.61
Round  34, Train loss: 1.268, Test loss: 1.575, Test accuracy: 49.73
Round  34, Global train loss: 1.268, Global test loss: 1.688, Global test accuracy: 46.80
Round  35, Train loss: 1.415, Test loss: 1.592, Test accuracy: 49.89
Round  35, Global train loss: 1.415, Global test loss: 1.733, Global test accuracy: 45.26
Round  36, Train loss: 1.155, Test loss: 1.627, Test accuracy: 49.63
Round  36, Global train loss: 1.155, Global test loss: 1.856, Global test accuracy: 46.90
Round  37, Train loss: 1.396, Test loss: 1.632, Test accuracy: 49.70
Round  37, Global train loss: 1.396, Global test loss: 1.769, Global test accuracy: 46.91
Round  38, Train loss: 1.135, Test loss: 1.655, Test accuracy: 49.70
Round  38, Global train loss: 1.135, Global test loss: 1.564, Global test accuracy: 50.84
Round  39, Train loss: 1.167, Test loss: 1.634, Test accuracy: 50.27
Round  39, Global train loss: 1.167, Global test loss: 1.675, Global test accuracy: 50.13
Round  40, Train loss: 1.168, Test loss: 1.638, Test accuracy: 50.56
Round  40, Global train loss: 1.168, Global test loss: 1.650, Global test accuracy: 49.90
Round  41, Train loss: 1.010, Test loss: 1.667, Test accuracy: 50.05
Round  41, Global train loss: 1.010, Global test loss: 1.552, Global test accuracy: 52.59
Round  42, Train loss: 1.318, Test loss: 1.664, Test accuracy: 49.71
Round  42, Global train loss: 1.318, Global test loss: 1.821, Global test accuracy: 44.74
Round  43, Train loss: 1.134, Test loss: 1.654, Test accuracy: 49.56
Round  43, Global train loss: 1.134, Global test loss: 1.627, Global test accuracy: 51.24
Round  44, Train loss: 1.254, Test loss: 1.694, Test accuracy: 48.83
Round  44, Global train loss: 1.254, Global test loss: 1.941, Global test accuracy: 42.34
Round  45, Train loss: 1.184, Test loss: 1.701, Test accuracy: 49.02
Round  45, Global train loss: 1.184, Global test loss: 1.885, Global test accuracy: 44.63
Round  46, Train loss: 0.985, Test loss: 1.713, Test accuracy: 48.82
Round  46, Global train loss: 0.985, Global test loss: 1.781, Global test accuracy: 48.56
Round  47, Train loss: 1.139, Test loss: 1.710, Test accuracy: 49.19
Round  47, Global train loss: 1.139, Global test loss: 1.760, Global test accuracy: 48.98
Round  48, Train loss: 1.068, Test loss: 1.740, Test accuracy: 48.58
Round  48, Global train loss: 1.068, Global test loss: 1.766, Global test accuracy: 49.20
Round  49, Train loss: 0.941, Test loss: 1.725, Test accuracy: 49.06
Round  49, Global train loss: 0.941, Global test loss: 1.546, Global test accuracy: 52.86
Round  50, Train loss: 1.072, Test loss: 1.715, Test accuracy: 49.79
Round  50, Global train loss: 1.072, Global test loss: 1.713, Global test accuracy: 50.66
Round  51, Train loss: 1.032, Test loss: 1.737, Test accuracy: 50.04
Round  51, Global train loss: 1.032, Global test loss: 1.699, Global test accuracy: 48.73
Round  52, Train loss: 1.111, Test loss: 1.767, Test accuracy: 49.69
Round  52, Global train loss: 1.111, Global test loss: 1.776, Global test accuracy: 45.94
Round  53, Train loss: 1.102, Test loss: 1.744, Test accuracy: 49.89
Round  53, Global train loss: 1.102, Global test loss: 1.758, Global test accuracy: 46.46
Round  54, Train loss: 0.943, Test loss: 1.779, Test accuracy: 49.41
Round  54, Global train loss: 0.943, Global test loss: 1.809, Global test accuracy: 47.74
Round  55, Train loss: 1.026, Test loss: 1.773, Test accuracy: 49.23
Round  55, Global train loss: 1.026, Global test loss: 1.674, Global test accuracy: 50.08
Round  56, Train loss: 0.907, Test loss: 1.770, Test accuracy: 49.45
Round  56, Global train loss: 0.907, Global test loss: 1.625, Global test accuracy: 50.33
Round  57, Train loss: 0.986, Test loss: 1.745, Test accuracy: 50.01
Round  57, Global train loss: 0.986, Global test loss: 1.680, Global test accuracy: 49.68
Round  58, Train loss: 0.941, Test loss: 1.767, Test accuracy: 49.31
Round  58, Global train loss: 0.941, Global test loss: 1.760, Global test accuracy: 50.21
Round  59, Train loss: 0.920, Test loss: 1.818, Test accuracy: 49.28
Round  59, Global train loss: 0.920, Global test loss: 1.663, Global test accuracy: 50.99
Round  60, Train loss: 1.060, Test loss: 1.787, Test accuracy: 49.90
Round  60, Global train loss: 1.060, Global test loss: 1.882, Global test accuracy: 45.91
Round  61, Train loss: 1.143, Test loss: 1.804, Test accuracy: 49.61
Round  61, Global train loss: 1.143, Global test loss: 2.021, Global test accuracy: 41.79
Round  62, Train loss: 0.962, Test loss: 1.810, Test accuracy: 49.37
Round  62, Global train loss: 0.962, Global test loss: 1.662, Global test accuracy: 51.14
Round  63, Train loss: 0.956, Test loss: 1.819, Test accuracy: 49.34
Round  63, Global train loss: 0.956, Global test loss: 1.784, Global test accuracy: 48.58
Round  64, Train loss: 0.886, Test loss: 1.844, Test accuracy: 48.96
Round  64, Global train loss: 0.886, Global test loss: 1.646, Global test accuracy: 51.38
Round  65, Train loss: 0.977, Test loss: 1.826, Test accuracy: 49.06
Round  65, Global train loss: 0.977, Global test loss: 1.761, Global test accuracy: 49.47
Round  66, Train loss: 0.960, Test loss: 1.841, Test accuracy: 49.46
Round  66, Global train loss: 0.960, Global test loss: 1.902, Global test accuracy: 46.62
Round  67, Train loss: 0.869, Test loss: 1.873, Test accuracy: 49.44
Round  67, Global train loss: 0.869, Global test loss: 1.809, Global test accuracy: 50.41
Round  68, Train loss: 0.897, Test loss: 1.883, Test accuracy: 49.39
Round  68, Global train loss: 0.897, Global test loss: 1.607, Global test accuracy: 51.93
Round  69, Train loss: 0.728, Test loss: 1.891, Test accuracy: 49.66
Round  69, Global train loss: 0.728, Global test loss: 1.953, Global test accuracy: 49.44
Round  70, Train loss: 0.849, Test loss: 1.898, Test accuracy: 49.79
Round  70, Global train loss: 0.849, Global test loss: 1.595, Global test accuracy: 51.74
Round  71, Train loss: 1.023, Test loss: 1.905, Test accuracy: 49.73
Round  71, Global train loss: 1.023, Global test loss: 1.944, Global test accuracy: 45.00
Round  72, Train loss: 0.825, Test loss: 1.944, Test accuracy: 49.55
Round  72, Global train loss: 0.825, Global test loss: 1.914, Global test accuracy: 48.38
Round  73, Train loss: 0.834, Test loss: 1.934, Test accuracy: 49.42
Round  73, Global train loss: 0.834, Global test loss: 1.976, Global test accuracy: 47.32
Round  74, Train loss: 0.843, Test loss: 1.916, Test accuracy: 49.33
Round  74, Global train loss: 0.843, Global test loss: 1.883, Global test accuracy: 47.44
Round  75, Train loss: 0.947, Test loss: 1.905, Test accuracy: 49.40
Round  75, Global train loss: 0.947, Global test loss: 1.779, Global test accuracy: 47.59
Round  76, Train loss: 0.893, Test loss: 1.937, Test accuracy: 48.96
Round  76, Global train loss: 0.893, Global test loss: 2.009, Global test accuracy: 45.72
Round  77, Train loss: 0.777, Test loss: 1.944, Test accuracy: 48.83
Round  77, Global train loss: 0.777, Global test loss: 1.736, Global test accuracy: 51.29
Round  78, Train loss: 0.727, Test loss: 1.969, Test accuracy: 48.44
Round  78, Global train loss: 0.727, Global test loss: 1.817, Global test accuracy: 50.33
Round  79, Train loss: 0.871, Test loss: 1.938, Test accuracy: 49.24
Round  79, Global train loss: 0.871, Global test loss: 1.825, Global test accuracy: 49.24
Round  80, Train loss: 0.963, Test loss: 1.909, Test accuracy: 49.31
Round  80, Global train loss: 0.963, Global test loss: 1.848, Global test accuracy: 46.01
Round  81, Train loss: 0.911, Test loss: 1.915, Test accuracy: 49.36
Round  81, Global train loss: 0.911, Global test loss: 1.834, Global test accuracy: 48.71
Round  82, Train loss: 0.877, Test loss: 1.934, Test accuracy: 49.53
Round  82, Global train loss: 0.877, Global test loss: 1.836, Global test accuracy: 48.30
Round  83, Train loss: 0.838, Test loss: 1.919, Test accuracy: 50.11
Round  83, Global train loss: 0.838, Global test loss: 1.670, Global test accuracy: 51.54
Round  84, Train loss: 0.833, Test loss: 1.920, Test accuracy: 50.04
Round  84, Global train loss: 0.833, Global test loss: 2.109, Global test accuracy: 44.36
Round  85, Train loss: 0.785, Test loss: 1.946, Test accuracy: 49.91
Round  85, Global train loss: 0.785, Global test loss: 2.001, Global test accuracy: 43.70
Round  86, Train loss: 0.784, Test loss: 1.939, Test accuracy: 50.02
Round  86, Global train loss: 0.784, Global test loss: 1.840, Global test accuracy: 47.19
Round  87, Train loss: 0.730, Test loss: 1.932, Test accuracy: 49.61
Round  87, Global train loss: 0.730, Global test loss: 1.625, Global test accuracy: 52.29
Round  88, Train loss: 0.884, Test loss: 1.949, Test accuracy: 49.36
Round  88, Global train loss: 0.884, Global test loss: 1.852, Global test accuracy: 47.73
Round  89, Train loss: 0.936, Test loss: 1.923, Test accuracy: 49.69
Round  89, Global train loss: 0.936, Global test loss: 1.693, Global test accuracy: 48.36
Round  90, Train loss: 0.787, Test loss: 1.953, Test accuracy: 49.29
Round  90, Global train loss: 0.787, Global test loss: 1.778, Global test accuracy: 49.27
Round  91, Train loss: 0.762, Test loss: 1.943, Test accuracy: 48.99
Round  91, Global train loss: 0.762, Global test loss: 1.798, Global test accuracy: 49.20
Round  92, Train loss: 0.815, Test loss: 1.931, Test accuracy: 49.56
Round  92, Global train loss: 0.815, Global test loss: 1.806, Global test accuracy: 50.34
Round  93, Train loss: 0.711, Test loss: 1.932, Test accuracy: 49.50
Round  93, Global train loss: 0.711, Global test loss: 1.701, Global test accuracy: 52.26
Round  94, Train loss: 0.913, Test loss: 1.916, Test accuracy: 49.80
Round  94, Global train loss: 0.913, Global test loss: 2.013, Global test accuracy: 44.31
Round  95, Train loss: 0.648, Test loss: 1.934, Test accuracy: 49.46
Round  95, Global train loss: 0.648, Global test loss: 1.694, Global test accuracy: 52.31
Round  96, Train loss: 0.809, Test loss: 1.902, Test accuracy: 50.01
Round  96, Global train loss: 0.809, Global test loss: 1.693, Global test accuracy: 50.28
Round  97, Train loss: 0.757, Test loss: 1.907, Test accuracy: 50.10
Round  97, Global train loss: 0.757, Global test loss: 1.769, Global test accuracy: 52.05
Round  98, Train loss: 0.844, Test loss: 1.938, Test accuracy: 49.56
Round  98, Global train loss: 0.844, Global test loss: 1.778, Global test accuracy: 48.68
Round  99, Train loss: 0.782, Test loss: 1.995, Test accuracy: 49.40
Round  99, Global train loss: 0.782, Global test loss: 2.009, Global test accuracy: 47.69
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1612, in filter_data
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * 0.9))]
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1612, in <listcomp>
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * 0.9))]
IndexError: list index out of range
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 7, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  15.2300
Round 1 global test acc  26.6100
Round 2 global test acc  28.7700
Round 3 global test acc  27.6500
Round 4 global test acc  31.0100
Round 5 global test acc  30.9300
Round 6 global test acc  29.8300
Round 7 global test acc  29.8400
Round 8 global test acc  31.0000
Round 9 global test acc  32.7100
Round 10 global test acc  33.1000
Round 11 global test acc  33.8700
Round 12 global test acc  36.0000
Round 13 global test acc  35.0900
Round 14 global test acc  36.8800
Round 15 global test acc  38.5500
Round 16 global test acc  38.8600
Round 17 global test acc  33.7700
Round 18 global test acc  37.5500
Round 19 global test acc  39.3000
Round 20 global test acc  37.4800
Round 21 global test acc  40.6800
Round 22 global test acc  37.2200
Round 23 global test acc  39.3900
Round 24 global test acc  38.7900
Round 25 global test acc  37.0400
Round 26 global test acc  42.1100
Round 27 global test acc  41.0700
Round 28 global test acc  42.3100
Round 29 global test acc  40.0100
Round 30 global test acc  39.5400
Round 31 global test acc  37.2200
Round 32 global test acc  42.8900
Round 33 global test acc  41.4300
Round 34 global test acc  43.6100
Round 35 global test acc  41.8300
Round 36 global test acc  43.0300
Round 37 global test acc  39.0300
Round 38 global test acc  42.4700
Round 39 global test acc  41.3600
Round 40 global test acc  39.9200
Round 41 global test acc  40.1500
Round 42 global test acc  42.7500
Round 43 global test acc  42.7100
Round 44 global test acc  44.6300
Round 45 global test acc  44.2100
Round 46 global test acc  40.0300
Round 47 global test acc  45.5100
Round 48 global test acc  45.8200
Round 49 global test acc  40.1600
Round 50 global test acc  45.2500
Round 51 global test acc  43.1600
Round 52 global test acc  44.8800
Round 53 global test acc  40.5300
Round 54 global test acc  42.3000
Round 55 global test acc  40.9100
Round 56 global test acc  41.1700
Round 57 global test acc  40.0500
Round 58 global test acc  42.8300
Round 59 global test acc  44.1200
Round 60 global test acc  46.2400
Round 61 global test acc  41.4700
Round 62 global test acc  47.5100
Round 63 global test acc  46.7500
Round 64 global test acc  41.0900
Round 65 global test acc  45.4000
Round 66 global test acc  43.7400
Round 67 global test acc  40.3700
Round 68 global test acc  41.8400
Round 69 global test acc  44.1600
Round 70 global test acc  43.1600
Round 71 global test acc  43.6800
Round 72 global test acc  43.1200
Round 73 global test acc  42.4400
Round 74 global test acc  42.4700
Round 75 global test acc  42.4600
Round 76 global test acc  41.9100
Round 77 global test acc  51.6100
Round 78 global test acc  44.8400
Round 79 global test acc  43.9500
Round 80 global test acc  44.0300
Round 81 global test acc  44.2400
Round 82 global test acc  44.6600
Round 83 global test acc  44.0300
Round 84 global test acc  42.5700
Round 85 global test acc  39.9100
Round 86 global test acc  40.8000
Round 87 global test acc  44.0400
Round 88 global test acc  44.1100
Round 89 global test acc  44.0600
Round 90 global test acc  43.6800
Round 91 global test acc  43.6600
Round 92 global test acc  42.4200
Round 93 global test acc  40.7500
Round 94 global test acc  40.5400
Round 95 global test acc  40.6500
Round 96 global test acc  40.3000
Round 97 global test acc  40.8500
Round 98 global test acc  40.9500
Round 99 global test acc  40.2000
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 7, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.145, Test loss: 2.196, Test accuracy: 18.23
Round   1, Train loss: 1.961, Test loss: 2.080, Test accuracy: 22.62
Round   2, Train loss: 1.961, Test loss: 2.012, Test accuracy: 25.24
Round   3, Train loss: 1.895, Test loss: 1.856, Test accuracy: 29.77
Round   4, Train loss: 1.774, Test loss: 1.677, Test accuracy: 37.81
Round   5, Train loss: 1.689, Test loss: 1.574, Test accuracy: 41.74
Round   6, Train loss: 1.818, Test loss: 1.571, Test accuracy: 42.83
Round   7, Train loss: 1.689, Test loss: 1.523, Test accuracy: 44.02
Round   8, Train loss: 1.793, Test loss: 1.521, Test accuracy: 45.76
Round   9, Train loss: 1.684, Test loss: 1.499, Test accuracy: 47.34
Round  10, Train loss: 1.762, Test loss: 1.516, Test accuracy: 47.21
Round  11, Train loss: 1.726, Test loss: 1.515, Test accuracy: 47.71
Round  12, Train loss: 1.789, Test loss: 1.479, Test accuracy: 48.27
Round  13, Train loss: 1.653, Test loss: 1.444, Test accuracy: 48.59
Round  14, Train loss: 1.657, Test loss: 1.430, Test accuracy: 50.05
Round  15, Train loss: 1.553, Test loss: 1.376, Test accuracy: 51.52
Round  16, Train loss: 1.647, Test loss: 1.400, Test accuracy: 52.01
Round  17, Train loss: 1.626, Test loss: 1.388, Test accuracy: 52.76
Round  18, Train loss: 1.406, Test loss: 1.349, Test accuracy: 53.18
Round  19, Train loss: 1.685, Test loss: 1.368, Test accuracy: 53.59
Round  20, Train loss: 1.602, Test loss: 1.352, Test accuracy: 54.19
Round  21, Train loss: 1.574, Test loss: 1.340, Test accuracy: 54.76
Round  22, Train loss: 1.653, Test loss: 1.360, Test accuracy: 54.24
Round  23, Train loss: 1.596, Test loss: 1.318, Test accuracy: 54.82
Round  24, Train loss: 1.561, Test loss: 1.291, Test accuracy: 55.66
Round  25, Train loss: 1.412, Test loss: 1.265, Test accuracy: 56.67
Round  26, Train loss: 1.757, Test loss: 1.309, Test accuracy: 56.21
Round  27, Train loss: 1.544, Test loss: 1.297, Test accuracy: 56.44
Round  28, Train loss: 1.555, Test loss: 1.289, Test accuracy: 56.91
Round  29, Train loss: 1.524, Test loss: 1.271, Test accuracy: 57.06
Round  30, Train loss: 1.215, Test loss: 1.242, Test accuracy: 57.57
Round  31, Train loss: 1.417, Test loss: 1.211, Test accuracy: 58.61
Round  32, Train loss: 1.513, Test loss: 1.219, Test accuracy: 58.89
Round  33, Train loss: 1.552, Test loss: 1.239, Test accuracy: 58.67
Round  34, Train loss: 1.443, Test loss: 1.209, Test accuracy: 59.32
Round  35, Train loss: 1.479, Test loss: 1.214, Test accuracy: 59.90
Round  36, Train loss: 1.447, Test loss: 1.199, Test accuracy: 59.88
Round  37, Train loss: 1.512, Test loss: 1.202, Test accuracy: 60.69
Round  38, Train loss: 1.323, Test loss: 1.193, Test accuracy: 60.54
Round  39, Train loss: 1.440, Test loss: 1.197, Test accuracy: 61.08
Round  40, Train loss: 1.363, Test loss: 1.195, Test accuracy: 60.59
Round  41, Train loss: 1.341, Test loss: 1.182, Test accuracy: 60.78
Round  42, Train loss: 1.652, Test loss: 1.188, Test accuracy: 61.56
Round  43, Train loss: 1.365, Test loss: 1.186, Test accuracy: 60.73
Round  44, Train loss: 1.507, Test loss: 1.177, Test accuracy: 61.12
Round  45, Train loss: 1.314, Test loss: 1.149, Test accuracy: 60.96
Round  46, Train loss: 1.263, Test loss: 1.149, Test accuracy: 61.53
Round  47, Train loss: 1.230, Test loss: 1.139, Test accuracy: 62.79
Round  48, Train loss: 1.185, Test loss: 1.124, Test accuracy: 62.99
Round  49, Train loss: 1.358, Test loss: 1.140, Test accuracy: 62.86
Round  50, Train loss: 1.175, Test loss: 1.129, Test accuracy: 61.97
Round  51, Train loss: 1.599, Test loss: 1.155, Test accuracy: 62.21
Round  52, Train loss: 1.529, Test loss: 1.160, Test accuracy: 62.66
Round  53, Train loss: 1.464, Test loss: 1.131, Test accuracy: 62.91
Round  54, Train loss: 1.433, Test loss: 1.137, Test accuracy: 62.69
Round  55, Train loss: 1.325, Test loss: 1.143, Test accuracy: 62.06
Round  56, Train loss: 1.203, Test loss: 1.138, Test accuracy: 62.39
Round  57, Train loss: 1.322, Test loss: 1.139, Test accuracy: 62.39
Round  58, Train loss: 1.365, Test loss: 1.131, Test accuracy: 61.84
Round  59, Train loss: 1.265, Test loss: 1.122, Test accuracy: 62.74
Round  60, Train loss: 1.241, Test loss: 1.121, Test accuracy: 63.29
Round  61, Train loss: 1.337, Test loss: 1.124, Test accuracy: 62.80
Round  62, Train loss: 1.211, Test loss: 1.113, Test accuracy: 63.61
Round  63, Train loss: 1.126, Test loss: 1.096, Test accuracy: 63.93
Round  64, Train loss: 1.352, Test loss: 1.101, Test accuracy: 64.01
Round  65, Train loss: 1.115, Test loss: 1.093, Test accuracy: 64.32
Round  66, Train loss: 1.319, Test loss: 1.119, Test accuracy: 62.82
Round  67, Train loss: 1.147, Test loss: 1.093, Test accuracy: 63.70
Round  68, Train loss: 1.200, Test loss: 1.085, Test accuracy: 63.80
Round  69, Train loss: 1.109, Test loss: 1.107, Test accuracy: 63.06
Round  70, Train loss: 1.324, Test loss: 1.085, Test accuracy: 63.67
Round  71, Train loss: 1.218, Test loss: 1.091, Test accuracy: 63.43
Round  72, Train loss: 1.373, Test loss: 1.112, Test accuracy: 63.21
Round  73, Train loss: 1.302, Test loss: 1.114, Test accuracy: 63.11
Round  74, Train loss: 1.201, Test loss: 1.127, Test accuracy: 62.74
Round  75, Train loss: 1.180, Test loss: 1.108, Test accuracy: 63.33
Round  76, Train loss: 1.243, Test loss: 1.108, Test accuracy: 63.17
Round  77, Train loss: 1.311, Test loss: 1.110, Test accuracy: 62.76
Round  78, Train loss: 1.303, Test loss: 1.132, Test accuracy: 61.58
Round  79, Train loss: 1.020, Test loss: 1.101, Test accuracy: 63.11
Round  80, Train loss: 1.150, Test loss: 1.097, Test accuracy: 63.64
Round  81, Train loss: 1.103, Test loss: 1.096, Test accuracy: 63.56
Round  82, Train loss: 1.023, Test loss: 1.094, Test accuracy: 64.04
Round  83, Train loss: 1.250, Test loss: 1.095, Test accuracy: 63.56
Round  84, Train loss: 1.289, Test loss: 1.121, Test accuracy: 61.91
Round  85, Train loss: 1.117, Test loss: 1.131, Test accuracy: 61.62
Round  86, Train loss: 1.306, Test loss: 1.130, Test accuracy: 61.81
Round  87, Train loss: 1.233, Test loss: 1.113, Test accuracy: 62.21
Round  88, Train loss: 1.061, Test loss: 1.109, Test accuracy: 62.50
Round  89, Train loss: 1.394, Test loss: 1.123, Test accuracy: 62.11
Round  90, Train loss: 1.178, Test loss: 1.132, Test accuracy: 61.71
Round  91, Train loss: 1.221, Test loss: 1.134, Test accuracy: 61.56
Round  92, Train loss: 1.193, Test loss: 1.120, Test accuracy: 62.27
Round  93, Train loss: 1.108, Test loss: 1.103, Test accuracy: 62.66
Round  94, Train loss: 1.115, Test loss: 1.106, Test accuracy: 62.74
Round  95, Train loss: 1.139, Test loss: 1.115, Test accuracy: 62.32
Round  96, Train loss: 1.169, Test loss: 1.127, Test accuracy: 61.68
Round  97, Train loss: 0.883, Test loss: 1.087, Test accuracy: 62.95
Round  98, Train loss: 1.134, Test loss: 1.093, Test accuracy: 62.82
Round  99, Train loss: 1.177, Test loss: 1.132, Test accuracy: 61.25
Final Round, Train loss: 1.023, Test loss: 1.142, Test accuracy: 61.09
Average accuracy final 10 rounds: 62.19571428571429
1362.7706406116486
[2.050156593322754, 3.854560375213623, 5.659231424331665, 7.463581323623657, 9.266866445541382, 11.076345682144165, 12.86498498916626, 14.654595136642456, 16.446202516555786, 18.23908829689026, 20.026544332504272, 21.819209337234497, 23.612410306930542, 25.40137505531311, 27.1891610622406, 28.97848391532898, 30.77102541923523, 32.556373596191406, 34.34911131858826, 36.13994312286377, 37.93306636810303, 39.56009554862976, 41.18233680725098, 42.80032181739807, 44.41448950767517, 46.02732586860657, 47.64573669433594, 49.27115201950073, 50.88465690612793, 52.5151641368866, 54.12729454040527, 55.74154353141785, 57.370619773864746, 58.99014472961426, 60.61815667152405, 62.24760317802429, 63.879379749298096, 65.50409603118896, 67.13896632194519, 68.78141713142395, 70.42357611656189, 72.06703758239746, 73.71696257591248, 75.36206436157227, 77.00192856788635, 78.64141893386841, 80.27701950073242, 81.91277575492859, 83.5597288608551, 85.21045398712158, 86.86827039718628, 88.51845288276672, 90.15553188323975, 91.79225635528564, 93.42955136299133, 95.06622767448425, 96.70363593101501, 98.35363221168518, 100.00262928009033, 101.65613174438477, 103.30108737945557, 104.94942736625671, 106.60015416145325, 108.25014996528625, 109.89775848388672, 111.53336262702942, 113.17069482803345, 114.8057119846344, 116.44202041625977, 118.09392166137695, 119.73219442367554, 121.37217664718628, 123.00687098503113, 124.63980555534363, 126.27805471420288, 127.91121864318848, 129.5439167022705, 131.17778611183167, 132.82312893867493, 134.46555519104004, 136.09862112998962, 137.7326786518097, 139.36817908287048, 141.00269675254822, 142.63777375221252, 144.2700002193451, 145.90160274505615, 147.53391313552856, 149.1679379940033, 150.8034529685974, 152.4379527568817, 154.07375645637512, 155.70958709716797, 157.34633231163025, 158.98103427886963, 160.62880516052246, 162.27517676353455, 163.919175863266, 165.56177473068237, 167.2096724510193, 169.14429593086243]
[18.228571428571428, 22.62142857142857, 25.235714285714284, 29.771428571428572, 37.80714285714286, 41.74285714285714, 42.82857142857143, 44.02142857142857, 45.75714285714286, 47.33571428571429, 47.207142857142856, 47.707142857142856, 48.27142857142857, 48.59285714285714, 50.05, 51.52142857142857, 52.01428571428571, 52.76428571428571, 53.17857142857143, 53.59285714285714, 54.18571428571428, 54.75714285714286, 54.24285714285714, 54.82142857142857, 55.65714285714286, 56.67142857142857, 56.207142857142856, 56.43571428571428, 56.90714285714286, 57.05714285714286, 57.57142857142857, 58.614285714285714, 58.892857142857146, 58.67142857142857, 59.32142857142857, 59.9, 59.878571428571426, 60.68571428571428, 60.542857142857144, 61.07857142857143, 60.58571428571429, 60.77857142857143, 61.55714285714286, 60.72857142857143, 61.121428571428574, 60.957142857142856, 61.52857142857143, 62.785714285714285, 62.98571428571429, 62.857142857142854, 61.97142857142857, 62.214285714285715, 62.66428571428571, 62.91428571428571, 62.68571428571428, 62.06428571428572, 62.392857142857146, 62.392857142857146, 61.84285714285714, 62.74285714285714, 63.292857142857144, 62.8, 63.607142857142854, 63.92857142857143, 64.01428571428572, 64.32142857142857, 62.82142857142857, 63.7, 63.8, 63.06428571428572, 63.67142857142857, 63.42857142857143, 63.207142857142856, 63.107142857142854, 62.74285714285714, 63.32857142857143, 63.17142857142857, 62.75714285714286, 61.57857142857143, 63.107142857142854, 63.642857142857146, 63.56428571428572, 64.03571428571429, 63.55714285714286, 61.91428571428571, 61.621428571428574, 61.81428571428572, 62.214285714285715, 62.5, 62.107142857142854, 61.707142857142856, 61.55714285714286, 62.27142857142857, 62.66428571428571, 62.73571428571429, 62.32142857142857, 61.67857142857143, 62.95, 62.82142857142857, 61.25, 61.09285714285714]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 7, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.004, Test loss: 2.121, Test accuracy: 19.59
Round   0, Global train loss: 2.004, Global test loss: 2.232, Global test accuracy: 17.23
Round   1, Train loss: 1.911, Test loss: 1.974, Test accuracy: 25.82
Round   1, Global train loss: 1.911, Global test loss: 2.146, Global test accuracy: 22.21
Round   2, Train loss: 1.905, Test loss: 1.835, Test accuracy: 30.83
Round   2, Global train loss: 1.905, Global test loss: 2.031, Global test accuracy: 27.16
Round   3, Train loss: 1.855, Test loss: 1.737, Test accuracy: 33.91
Round   3, Global train loss: 1.855, Global test loss: 1.895, Global test accuracy: 32.21
Round   4, Train loss: 1.732, Test loss: 1.624, Test accuracy: 39.03
Round   4, Global train loss: 1.732, Global test loss: 1.862, Global test accuracy: 33.06
Round   5, Train loss: 1.713, Test loss: 1.582, Test accuracy: 40.76
Round   5, Global train loss: 1.713, Global test loss: 1.871, Global test accuracy: 32.51
Round   6, Train loss: 1.814, Test loss: 1.554, Test accuracy: 42.49
Round   6, Global train loss: 1.814, Global test loss: 1.790, Global test accuracy: 39.88
Round   7, Train loss: 1.711, Test loss: 1.523, Test accuracy: 44.16
Round   7, Global train loss: 1.711, Global test loss: 1.698, Global test accuracy: 42.52
Round   8, Train loss: 1.709, Test loss: 1.511, Test accuracy: 44.57
Round   8, Global train loss: 1.709, Global test loss: 1.682, Global test accuracy: 39.59
Round   9, Train loss: 1.615, Test loss: 1.493, Test accuracy: 44.94
Round   9, Global train loss: 1.615, Global test loss: 1.663, Global test accuracy: 43.05
Round  10, Train loss: 1.655, Test loss: 1.472, Test accuracy: 46.09
Round  10, Global train loss: 1.655, Global test loss: 1.663, Global test accuracy: 43.69
Round  11, Train loss: 1.690, Test loss: 1.455, Test accuracy: 46.92
Round  11, Global train loss: 1.690, Global test loss: 1.649, Global test accuracy: 45.76
Round  12, Train loss: 1.655, Test loss: 1.412, Test accuracy: 48.78
Round  12, Global train loss: 1.655, Global test loss: 1.640, Global test accuracy: 43.92
Round  13, Train loss: 1.507, Test loss: 1.404, Test accuracy: 49.74
Round  13, Global train loss: 1.507, Global test loss: 1.564, Global test accuracy: 43.48
Round  14, Train loss: 1.675, Test loss: 1.391, Test accuracy: 50.86
Round  14, Global train loss: 1.675, Global test loss: 1.657, Global test accuracy: 45.53
Round  15, Train loss: 1.450, Test loss: 1.371, Test accuracy: 51.81
Round  15, Global train loss: 1.450, Global test loss: 1.449, Global test accuracy: 51.01
Round  16, Train loss: 1.515, Test loss: 1.357, Test accuracy: 52.76
Round  16, Global train loss: 1.515, Global test loss: 1.532, Global test accuracy: 49.20
Round  17, Train loss: 1.424, Test loss: 1.357, Test accuracy: 52.16
Round  17, Global train loss: 1.424, Global test loss: 1.443, Global test accuracy: 50.97
Round  18, Train loss: 1.341, Test loss: 1.341, Test accuracy: 52.43
Round  18, Global train loss: 1.341, Global test loss: 1.424, Global test accuracy: 50.69
Round  19, Train loss: 1.463, Test loss: 1.347, Test accuracy: 52.37
Round  19, Global train loss: 1.463, Global test loss: 1.424, Global test accuracy: 52.81
Round  20, Train loss: 1.501, Test loss: 1.330, Test accuracy: 53.27
Round  20, Global train loss: 1.501, Global test loss: 1.507, Global test accuracy: 49.14
Round  21, Train loss: 1.565, Test loss: 1.324, Test accuracy: 53.39
Round  21, Global train loss: 1.565, Global test loss: 1.507, Global test accuracy: 52.89
Round  22, Train loss: 1.425, Test loss: 1.321, Test accuracy: 53.54
Round  22, Global train loss: 1.425, Global test loss: 1.505, Global test accuracy: 49.05
Round  23, Train loss: 1.393, Test loss: 1.295, Test accuracy: 54.49
Round  23, Global train loss: 1.393, Global test loss: 1.439, Global test accuracy: 50.87
Round  24, Train loss: 1.551, Test loss: 1.292, Test accuracy: 54.86
Round  24, Global train loss: 1.551, Global test loss: 1.461, Global test accuracy: 54.36
Round  25, Train loss: 1.390, Test loss: 1.304, Test accuracy: 55.24
Round  25, Global train loss: 1.390, Global test loss: 1.474, Global test accuracy: 51.54
Round  26, Train loss: 1.388, Test loss: 1.306, Test accuracy: 54.88
Round  26, Global train loss: 1.388, Global test loss: 1.462, Global test accuracy: 50.84
Round  27, Train loss: 1.400, Test loss: 1.310, Test accuracy: 54.36
Round  27, Global train loss: 1.400, Global test loss: 1.436, Global test accuracy: 51.91
Round  28, Train loss: 1.276, Test loss: 1.303, Test accuracy: 54.89
Round  28, Global train loss: 1.276, Global test loss: 1.493, Global test accuracy: 49.81
Round  29, Train loss: 1.150, Test loss: 1.299, Test accuracy: 54.66
Round  29, Global train loss: 1.150, Global test loss: 1.423, Global test accuracy: 53.69
Round  30, Train loss: 1.036, Test loss: 1.275, Test accuracy: 55.46
Round  30, Global train loss: 1.036, Global test loss: 1.346, Global test accuracy: 53.71
Round  31, Train loss: 1.350, Test loss: 1.288, Test accuracy: 55.05
Round  31, Global train loss: 1.350, Global test loss: 1.341, Global test accuracy: 57.32
Round  32, Train loss: 1.272, Test loss: 1.302, Test accuracy: 54.46
Round  32, Global train loss: 1.272, Global test loss: 1.418, Global test accuracy: 52.69
Round  33, Train loss: 1.212, Test loss: 1.309, Test accuracy: 54.79
Round  33, Global train loss: 1.212, Global test loss: 1.356, Global test accuracy: 54.44
Round  34, Train loss: 1.321, Test loss: 1.309, Test accuracy: 54.89
Round  34, Global train loss: 1.321, Global test loss: 1.440, Global test accuracy: 52.76
Round  35, Train loss: 1.442, Test loss: 1.300, Test accuracy: 54.84
Round  35, Global train loss: 1.442, Global test loss: 1.549, Global test accuracy: 48.81
Round  36, Train loss: 1.090, Test loss: 1.320, Test accuracy: 54.94
Round  36, Global train loss: 1.090, Global test loss: 1.450, Global test accuracy: 52.63
Round  37, Train loss: 1.218, Test loss: 1.328, Test accuracy: 55.17
Round  37, Global train loss: 1.218, Global test loss: 1.354, Global test accuracy: 55.61
Round  38, Train loss: 1.130, Test loss: 1.334, Test accuracy: 54.22
Round  38, Global train loss: 1.130, Global test loss: 1.281, Global test accuracy: 57.53
Round  39, Train loss: 1.044, Test loss: 1.323, Test accuracy: 54.40
Round  39, Global train loss: 1.044, Global test loss: 1.405, Global test accuracy: 54.29
Round  40, Train loss: 1.062, Test loss: 1.327, Test accuracy: 54.96
Round  40, Global train loss: 1.062, Global test loss: 1.284, Global test accuracy: 58.04
Round  41, Train loss: 1.047, Test loss: 1.328, Test accuracy: 54.90
Round  41, Global train loss: 1.047, Global test loss: 1.278, Global test accuracy: 57.45
Round  42, Train loss: 1.144, Test loss: 1.324, Test accuracy: 55.09
Round  42, Global train loss: 1.144, Global test loss: 1.342, Global test accuracy: 54.62
Round  43, Train loss: 1.124, Test loss: 1.333, Test accuracy: 55.41
Round  43, Global train loss: 1.124, Global test loss: 1.329, Global test accuracy: 55.29
Round  44, Train loss: 1.143, Test loss: 1.361, Test accuracy: 54.86
Round  44, Global train loss: 1.143, Global test loss: 1.484, Global test accuracy: 51.64
Round  45, Train loss: 1.275, Test loss: 1.361, Test accuracy: 54.77
Round  45, Global train loss: 1.275, Global test loss: 1.536, Global test accuracy: 49.41
Round  46, Train loss: 1.157, Test loss: 1.365, Test accuracy: 55.09
Round  46, Global train loss: 1.157, Global test loss: 1.465, Global test accuracy: 51.44
Round  47, Train loss: 1.068, Test loss: 1.375, Test accuracy: 54.89
Round  47, Global train loss: 1.068, Global test loss: 1.513, Global test accuracy: 53.71
Round  48, Train loss: 1.083, Test loss: 1.408, Test accuracy: 54.19
Round  48, Global train loss: 1.083, Global test loss: 1.473, Global test accuracy: 54.25
Round  49, Train loss: 1.190, Test loss: 1.411, Test accuracy: 54.38
Round  49, Global train loss: 1.190, Global test loss: 1.412, Global test accuracy: 55.09
Round  50, Train loss: 0.987, Test loss: 1.400, Test accuracy: 54.94
Round  50, Global train loss: 0.987, Global test loss: 1.404, Global test accuracy: 55.59
Round  51, Train loss: 1.139, Test loss: 1.413, Test accuracy: 54.69
Round  51, Global train loss: 1.139, Global test loss: 1.421, Global test accuracy: 53.61
Round  52, Train loss: 1.136, Test loss: 1.428, Test accuracy: 54.36
Round  52, Global train loss: 1.136, Global test loss: 1.451, Global test accuracy: 51.71
Round  53, Train loss: 0.983, Test loss: 1.436, Test accuracy: 54.09
Round  53, Global train loss: 0.983, Global test loss: 1.416, Global test accuracy: 53.84
Round  54, Train loss: 0.886, Test loss: 1.461, Test accuracy: 53.59
Round  54, Global train loss: 0.886, Global test loss: 1.454, Global test accuracy: 52.42
Round  55, Train loss: 1.039, Test loss: 1.473, Test accuracy: 53.92
Round  55, Global train loss: 1.039, Global test loss: 1.439, Global test accuracy: 54.03
Round  56, Train loss: 0.928, Test loss: 1.487, Test accuracy: 53.98
Round  56, Global train loss: 0.928, Global test loss: 1.338, Global test accuracy: 56.73
Round  57, Train loss: 0.934, Test loss: 1.494, Test accuracy: 53.94
Round  57, Global train loss: 0.934, Global test loss: 1.452, Global test accuracy: 53.97
Round  58, Train loss: 1.157, Test loss: 1.501, Test accuracy: 53.56
Round  58, Global train loss: 1.157, Global test loss: 1.517, Global test accuracy: 51.42
Round  59, Train loss: 1.074, Test loss: 1.506, Test accuracy: 53.45
Round  59, Global train loss: 1.074, Global test loss: 1.440, Global test accuracy: 54.06
Round  60, Train loss: 1.000, Test loss: 1.495, Test accuracy: 53.84
Round  60, Global train loss: 1.000, Global test loss: 1.526, Global test accuracy: 51.58
Round  61, Train loss: 1.078, Test loss: 1.494, Test accuracy: 53.89
Round  61, Global train loss: 1.078, Global test loss: 1.609, Global test accuracy: 48.26
Round  62, Train loss: 1.030, Test loss: 1.500, Test accuracy: 53.25
Round  62, Global train loss: 1.030, Global test loss: 1.399, Global test accuracy: 55.12
Round  63, Train loss: 0.958, Test loss: 1.486, Test accuracy: 53.23
Round  63, Global train loss: 0.958, Global test loss: 1.470, Global test accuracy: 53.61
Round  64, Train loss: 0.812, Test loss: 1.496, Test accuracy: 52.79
Round  64, Global train loss: 0.812, Global test loss: 1.383, Global test accuracy: 55.63
Round  65, Train loss: 0.955, Test loss: 1.490, Test accuracy: 53.44
Round  65, Global train loss: 0.955, Global test loss: 1.509, Global test accuracy: 53.28
Round  66, Train loss: 0.955, Test loss: 1.513, Test accuracy: 53.44
Round  66, Global train loss: 0.955, Global test loss: 1.522, Global test accuracy: 51.31
Round  67, Train loss: 0.911, Test loss: 1.508, Test accuracy: 53.66
Round  67, Global train loss: 0.911, Global test loss: 1.454, Global test accuracy: 53.75
Round  68, Train loss: 1.103, Test loss: 1.531, Test accuracy: 53.31
Round  68, Global train loss: 1.103, Global test loss: 1.459, Global test accuracy: 53.19
Round  69, Train loss: 0.820, Test loss: 1.545, Test accuracy: 53.51
Round  69, Global train loss: 0.820, Global test loss: 1.616, Global test accuracy: 52.44
Round  70, Train loss: 1.001, Test loss: 1.558, Test accuracy: 53.07
Round  70, Global train loss: 1.001, Global test loss: 1.452, Global test accuracy: 52.98
Round  71, Train loss: 0.842, Test loss: 1.564, Test accuracy: 53.26
Round  71, Global train loss: 0.842, Global test loss: 1.516, Global test accuracy: 53.25
Round  72, Train loss: 0.932, Test loss: 1.562, Test accuracy: 52.99
Round  72, Global train loss: 0.932, Global test loss: 1.544, Global test accuracy: 51.85
Round  73, Train loss: 0.923, Test loss: 1.585, Test accuracy: 52.71
Round  73, Global train loss: 0.923, Global test loss: 1.614, Global test accuracy: 49.59
Round  74, Train loss: 0.824, Test loss: 1.596, Test accuracy: 52.84
Round  74, Global train loss: 0.824, Global test loss: 1.584, Global test accuracy: 51.23
Round  75, Train loss: 0.917, Test loss: 1.586, Test accuracy: 52.59
Round  75, Global train loss: 0.917, Global test loss: 1.468, Global test accuracy: 53.55
Round  76, Train loss: 0.834, Test loss: 1.573, Test accuracy: 53.59
Round  76, Global train loss: 0.834, Global test loss: 1.666, Global test accuracy: 50.46
Round  77, Train loss: 0.902, Test loss: 1.582, Test accuracy: 53.74
Round  77, Global train loss: 0.902, Global test loss: 1.473, Global test accuracy: 54.17
Round  78, Train loss: 0.923, Test loss: 1.593, Test accuracy: 53.25
Round  78, Global train loss: 0.923, Global test loss: 1.603, Global test accuracy: 49.44
Round  79, Train loss: 0.919, Test loss: 1.605, Test accuracy: 52.59
Round  79, Global train loss: 0.919, Global test loss: 1.580, Global test accuracy: 51.89
Round  80, Train loss: 0.833, Test loss: 1.618, Test accuracy: 52.01
Round  80, Global train loss: 0.833, Global test loss: 1.520, Global test accuracy: 52.61
Round  81, Train loss: 0.942, Test loss: 1.611, Test accuracy: 52.49
Round  81, Global train loss: 0.942, Global test loss: 1.532, Global test accuracy: 52.70
Round  82, Train loss: 0.778, Test loss: 1.622, Test accuracy: 52.77
Round  82, Global train loss: 0.778, Global test loss: 1.448, Global test accuracy: 55.69
Round  83, Train loss: 0.961, Test loss: 1.627, Test accuracy: 53.03
Round  83, Global train loss: 0.961, Global test loss: 1.454, Global test accuracy: 54.21
Round  84, Train loss: 0.726, Test loss: 1.627, Test accuracy: 53.02
Round  84, Global train loss: 0.726, Global test loss: 1.700, Global test accuracy: 49.91
Round  85, Train loss: 0.802, Test loss: 1.621, Test accuracy: 53.51
Round  85, Global train loss: 0.802, Global test loss: 1.705, Global test accuracy: 48.70
Round  86, Train loss: 0.765, Test loss: 1.629, Test accuracy: 52.94
Round  86, Global train loss: 0.765, Global test loss: 1.572, Global test accuracy: 51.65
Round  87, Train loss: 0.756, Test loss: 1.640, Test accuracy: 52.81
Round  87, Global train loss: 0.756, Global test loss: 1.451, Global test accuracy: 55.94
Round  88, Train loss: 0.790, Test loss: 1.668, Test accuracy: 52.54
Round  88, Global train loss: 0.790, Global test loss: 1.504, Global test accuracy: 53.11
Round  89, Train loss: 1.001, Test loss: 1.692, Test accuracy: 52.15
Round  89, Global train loss: 1.001, Global test loss: 1.546, Global test accuracy: 50.65
Round  90, Train loss: 0.850, Test loss: 1.703, Test accuracy: 52.21
Round  90, Global train loss: 0.850, Global test loss: 1.562, Global test accuracy: 52.11
Round  91, Train loss: 0.817, Test loss: 1.706, Test accuracy: 52.49
Round  91, Global train loss: 0.817, Global test loss: 1.589, Global test accuracy: 52.26
Round  92, Train loss: 0.928, Test loss: 1.723, Test accuracy: 52.51
Round  92, Global train loss: 0.928, Global test loss: 1.639, Global test accuracy: 50.27
Round  93, Train loss: 0.936, Test loss: 1.705, Test accuracy: 52.61
Round  93, Global train loss: 0.936, Global test loss: 1.631, Global test accuracy: 50.90
Round  94, Train loss: 0.850, Test loss: 1.729, Test accuracy: 51.86
Round  94, Global train loss: 0.850, Global test loss: 1.623, Global test accuracy: 49.68
Round  95, Train loss: 0.869, Test loss: 1.752, Test accuracy: 51.71
Round  95, Global train loss: 0.869, Global test loss: 1.654, Global test accuracy: 49.66
Round  96, Train loss: 0.855, Test loss: 1.736, Test accuracy: 51.66
Round  96, Global train loss: 0.855, Global test loss: 1.562, Global test accuracy: 52.00
Round  97, Train loss: 0.834, Test loss: 1.748, Test accuracy: 51.32
Round  97, Global train loss: 0.834, Global test loss: 1.666, Global test accuracy: 51.98
Round  98, Train loss: 0.808, Test loss: 1.758, Test accuracy: 51.23
Round  98, Global train loss: 0.808, Global test loss: 1.493, Global test accuracy: 53.54
Round  99, Train loss: 0.740, Test loss: 1.786, Test accuracy: 51.17
Round  99, Global train loss: 0.740, Global test loss: 1.731, Global test accuracy: 50.74
Final Round, Train loss: 0.580, Test loss: 2.007, Test accuracy: 51.03
Final Round, Global train loss: 0.580, Global test loss: 1.731, Global test accuracy: 50.74
Average accuracy final 10 rounds: 51.87714285714286
Average global accuracy final 10 rounds: 51.31285714285715
2757.596365213394
[1.867649793624878, 3.4493284225463867, 5.019430875778198, 6.585923671722412, 8.156483888626099, 9.752672672271729, 11.357819557189941, 12.961254358291626, 14.555280447006226, 16.153151988983154, 17.73608708381653, 19.31936812400818, 20.91076374053955, 22.50133991241455, 23.86302423477173, 25.227550745010376, 26.590864896774292, 27.95236849784851, 29.313138484954834, 30.674376249313354, 32.03575015068054, 35.89191746711731, 39.75906562805176, 43.57831001281738, 47.43429446220398, 51.297398805618286, 55.11139678955078, 59.211305141448975, 63.32682704925537, 67.40103769302368, 71.49842619895935, 75.58317494392395, 79.71936345100403, 83.82144045829773, 87.94314813613892, 92.093106508255, 96.19869184494019, 100.30747866630554, 104.47179293632507, 108.562579870224, 112.64353466033936, 116.74924802780151, 120.85516667366028, 124.92313933372498, 129.02257704734802, 133.1543161869049, 137.28580498695374, 141.43042254447937, 145.59146094322205, 149.7062747478485, 153.7946081161499, 157.9346888065338, 162.30513668060303, 166.65095949172974, 171.00178217887878, 175.36748051643372, 179.72349500656128, 184.0776207447052, 188.43723964691162, 192.76200437545776, 197.10188031196594, 201.41897225379944, 205.76440715789795, 209.9600121974945, 214.03634929656982, 217.9356288909912, 221.7848973274231, 225.69089555740356, 229.51354026794434, 233.41104078292847, 237.30852437019348, 241.1545112133026, 245.11036467552185, 248.97100973129272, 252.87286400794983, 256.8011200428009, 260.7105073928833, 264.63102531433105, 268.5200650691986, 272.41231966018677, 276.3173315525055, 280.22278881073, 284.0799379348755, 287.9768919944763, 291.8941946029663, 295.787584066391, 299.67560958862305, 303.53921008110046, 307.45278692245483, 311.3043441772461, 315.2076630592346, 319.07761812210083, 322.9835216999054, 326.82211470603943, 330.69387650489807, 334.5921630859375, 338.4831883907318, 342.37180733680725, 346.27838802337646, 350.21079897880554, 352.1612470149994]
[19.585714285714285, 25.821428571428573, 30.82857142857143, 33.91428571428571, 39.02857142857143, 40.76428571428571, 42.48571428571429, 44.15714285714286, 44.57142857142857, 44.93571428571428, 46.08571428571429, 46.92142857142857, 48.77857142857143, 49.73571428571429, 50.864285714285714, 51.80714285714286, 52.75714285714286, 52.16428571428571, 52.42857142857143, 52.371428571428574, 53.27142857142857, 53.392857142857146, 53.535714285714285, 54.48571428571429, 54.864285714285714, 55.23571428571429, 54.878571428571426, 54.364285714285714, 54.892857142857146, 54.65714285714286, 55.457142857142856, 55.05, 54.457142857142856, 54.792857142857144, 54.892857142857146, 54.84285714285714, 54.93571428571428, 55.17142857142857, 54.22142857142857, 54.4, 54.957142857142856, 54.9, 55.09285714285714, 55.41428571428571, 54.864285714285714, 54.77142857142857, 55.08571428571429, 54.892857142857146, 54.19285714285714, 54.378571428571426, 54.93571428571428, 54.68571428571428, 54.357142857142854, 54.08571428571429, 53.58571428571429, 53.92142857142857, 53.97857142857143, 53.93571428571428, 53.55714285714286, 53.45, 53.83571428571429, 53.885714285714286, 53.25, 53.22857142857143, 52.792857142857144, 53.43571428571428, 53.44285714285714, 53.65714285714286, 53.30714285714286, 53.51428571428571, 53.07142857142857, 53.25714285714286, 52.99285714285714, 52.707142857142856, 52.83571428571429, 52.58571428571429, 53.58571428571429, 53.73571428571429, 53.25, 52.59285714285714, 52.01428571428571, 52.49285714285714, 52.77142857142857, 53.02857142857143, 53.02142857142857, 53.51428571428571, 52.94285714285714, 52.80714285714286, 52.535714285714285, 52.15, 52.214285714285715, 52.49285714285714, 52.50714285714286, 52.614285714285714, 51.857142857142854, 51.707142857142856, 51.65714285714286, 51.32142857142857, 51.22857142857143, 51.17142857142857, 51.02857142857143]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 7, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.909, Test loss: 1.688, Test accuracy: 35.45
Round   0, Global train loss: 1.909, Global test loss: 2.157, Global test accuracy: 26.04
Round   1, Train loss: 1.772, Test loss: 1.558, Test accuracy: 40.54
Round   1, Global train loss: 1.772, Global test loss: 1.867, Global test accuracy: 33.48
Round   2, Train loss: 1.683, Test loss: 1.482, Test accuracy: 45.77
Round   2, Global train loss: 1.683, Global test loss: 1.721, Global test accuracy: 41.32
Round   3, Train loss: 1.626, Test loss: 1.438, Test accuracy: 47.39
Round   3, Global train loss: 1.626, Global test loss: 1.639, Global test accuracy: 43.95
Round   4, Train loss: 1.579, Test loss: 1.410, Test accuracy: 48.87
Round   4, Global train loss: 1.579, Global test loss: 1.586, Global test accuracy: 46.98
Round   5, Train loss: 1.535, Test loss: 1.383, Test accuracy: 50.14
Round   5, Global train loss: 1.535, Global test loss: 1.531, Global test accuracy: 49.56
Round   6, Train loss: 1.490, Test loss: 1.392, Test accuracy: 50.59
Round   6, Global train loss: 1.490, Global test loss: 1.485, Global test accuracy: 51.56
Round   7, Train loss: 1.448, Test loss: 1.377, Test accuracy: 51.10
Round   7, Global train loss: 1.448, Global test loss: 1.450, Global test accuracy: 52.79
Round   8, Train loss: 1.405, Test loss: 1.378, Test accuracy: 51.23
Round   8, Global train loss: 1.405, Global test loss: 1.415, Global test accuracy: 53.66
Round   9, Train loss: 1.360, Test loss: 1.410, Test accuracy: 50.36
Round   9, Global train loss: 1.360, Global test loss: 1.407, Global test accuracy: 53.91
Round  10, Train loss: 1.301, Test loss: 1.423, Test accuracy: 50.25
Round  10, Global train loss: 1.301, Global test loss: 1.538, Global test accuracy: 46.98
Round  11, Train loss: 1.317, Test loss: 1.428, Test accuracy: 50.14
Round  11, Global train loss: 1.317, Global test loss: 1.507, Global test accuracy: 48.51
Round  12, Train loss: 1.269, Test loss: 1.449, Test accuracy: 50.02
Round  12, Global train loss: 1.269, Global test loss: 1.492, Global test accuracy: 48.74
Round  13, Train loss: 1.137, Test loss: 1.480, Test accuracy: 49.70
Round  13, Global train loss: 1.137, Global test loss: 1.432, Global test accuracy: 50.94
Round  14, Train loss: 1.055, Test loss: 1.504, Test accuracy: 49.89
Round  14, Global train loss: 1.055, Global test loss: 1.449, Global test accuracy: 51.06
Round  15, Train loss: 1.100, Test loss: 1.519, Test accuracy: 49.61
Round  15, Global train loss: 1.100, Global test loss: 1.369, Global test accuracy: 54.31
Round  16, Train loss: 1.027, Test loss: 1.515, Test accuracy: 50.19
Round  16, Global train loss: 1.027, Global test loss: 1.430, Global test accuracy: 52.89
Round  17, Train loss: 1.041, Test loss: 1.519, Test accuracy: 51.01
Round  17, Global train loss: 1.041, Global test loss: 1.394, Global test accuracy: 52.14
Round  18, Train loss: 1.069, Test loss: 1.565, Test accuracy: 50.06
Round  18, Global train loss: 1.069, Global test loss: 1.473, Global test accuracy: 50.81
Round  19, Train loss: 0.891, Test loss: 1.576, Test accuracy: 49.57
Round  19, Global train loss: 0.891, Global test loss: 1.432, Global test accuracy: 50.87
Round  20, Train loss: 0.896, Test loss: 1.634, Test accuracy: 48.91
Round  20, Global train loss: 0.896, Global test loss: 1.529, Global test accuracy: 50.69
Round  21, Train loss: 0.973, Test loss: 1.634, Test accuracy: 49.58
Round  21, Global train loss: 0.973, Global test loss: 1.439, Global test accuracy: 53.54
Round  22, Train loss: 0.917, Test loss: 1.641, Test accuracy: 50.04
Round  22, Global train loss: 0.917, Global test loss: 1.577, Global test accuracy: 49.23
Round  23, Train loss: 0.990, Test loss: 1.648, Test accuracy: 50.48
Round  23, Global train loss: 0.990, Global test loss: 1.519, Global test accuracy: 50.15
Round  24, Train loss: 0.960, Test loss: 1.668, Test accuracy: 50.62
Round  24, Global train loss: 0.960, Global test loss: 1.509, Global test accuracy: 50.74
Round  25, Train loss: 1.055, Test loss: 1.707, Test accuracy: 50.15
Round  25, Global train loss: 1.055, Global test loss: 1.597, Global test accuracy: 50.54
Round  26, Train loss: 0.984, Test loss: 1.744, Test accuracy: 49.96
Round  26, Global train loss: 0.984, Global test loss: 1.738, Global test accuracy: 44.91
Round  27, Train loss: 0.885, Test loss: 1.782, Test accuracy: 49.78
Round  27, Global train loss: 0.885, Global test loss: 1.667, Global test accuracy: 46.99
Round  28, Train loss: 0.645, Test loss: 1.834, Test accuracy: 49.46
Round  28, Global train loss: 0.645, Global test loss: 1.735, Global test accuracy: 50.11
Round  29, Train loss: 0.886, Test loss: 1.849, Test accuracy: 49.11
Round  29, Global train loss: 0.886, Global test loss: 1.724, Global test accuracy: 47.95
Round  30, Train loss: 0.915, Test loss: 1.848, Test accuracy: 49.18
Round  30, Global train loss: 0.915, Global test loss: 1.670, Global test accuracy: 49.51
Round  31, Train loss: 0.977, Test loss: 1.846, Test accuracy: 49.91
Round  31, Global train loss: 0.977, Global test loss: 1.676, Global test accuracy: 48.09
Round  32, Train loss: 0.816, Test loss: 1.875, Test accuracy: 49.45
Round  32, Global train loss: 0.816, Global test loss: 1.614, Global test accuracy: 51.16
Round  33, Train loss: 0.746, Test loss: 1.923, Test accuracy: 49.19
Round  33, Global train loss: 0.746, Global test loss: 1.663, Global test accuracy: 49.51
Round  34, Train loss: 0.764, Test loss: 1.927, Test accuracy: 49.29
Round  34, Global train loss: 0.764, Global test loss: 1.642, Global test accuracy: 51.17
Round  35, Train loss: 0.717, Test loss: 1.933, Test accuracy: 49.99
Round  35, Global train loss: 0.717, Global test loss: 1.705, Global test accuracy: 49.79
Round  36, Train loss: 0.751, Test loss: 1.946, Test accuracy: 50.07
Round  36, Global train loss: 0.751, Global test loss: 1.803, Global test accuracy: 48.70
Round  37, Train loss: 0.662, Test loss: 1.964, Test accuracy: 49.78
Round  37, Global train loss: 0.662, Global test loss: 1.564, Global test accuracy: 52.92
Round  38, Train loss: 0.935, Test loss: 1.974, Test accuracy: 49.69
Round  38, Global train loss: 0.935, Global test loss: 1.710, Global test accuracy: 47.24
Round  39, Train loss: 0.678, Test loss: 1.986, Test accuracy: 49.63
Round  39, Global train loss: 0.678, Global test loss: 1.813, Global test accuracy: 48.58
Round  40, Train loss: 0.768, Test loss: 1.987, Test accuracy: 49.82
Round  40, Global train loss: 0.768, Global test loss: 1.779, Global test accuracy: 47.44
Round  41, Train loss: 0.670, Test loss: 2.014, Test accuracy: 49.32
Round  41, Global train loss: 0.670, Global test loss: 1.699, Global test accuracy: 50.26
Round  42, Train loss: 0.575, Test loss: 2.037, Test accuracy: 49.14
Round  42, Global train loss: 0.575, Global test loss: 1.801, Global test accuracy: 49.81
Round  43, Train loss: 0.687, Test loss: 2.072, Test accuracy: 48.88
Round  43, Global train loss: 0.687, Global test loss: 1.687, Global test accuracy: 50.61
Round  44, Train loss: 0.629, Test loss: 2.109, Test accuracy: 48.87
Round  44, Global train loss: 0.629, Global test loss: 1.963, Global test accuracy: 47.45
Round  45, Train loss: 0.643, Test loss: 2.107, Test accuracy: 49.13
Round  45, Global train loss: 0.643, Global test loss: 1.838, Global test accuracy: 48.01
Round  46, Train loss: 0.695, Test loss: 2.097, Test accuracy: 49.32
Round  46, Global train loss: 0.695, Global test loss: 1.842, Global test accuracy: 48.19
Round  47, Train loss: 0.721, Test loss: 2.083, Test accuracy: 49.04
Round  47, Global train loss: 0.721, Global test loss: 1.903, Global test accuracy: 50.64
Round  48, Train loss: 0.689, Test loss: 2.104, Test accuracy: 49.58
Round  48, Global train loss: 0.689, Global test loss: 1.956, Global test accuracy: 48.75
Round  49, Train loss: 0.743, Test loss: 2.114, Test accuracy: 50.34
Round  49, Global train loss: 0.743, Global test loss: 1.781, Global test accuracy: 49.94
Round  50, Train loss: 0.582, Test loss: 2.140, Test accuracy: 49.28
Round  50, Global train loss: 0.582, Global test loss: 1.920, Global test accuracy: 49.96
Round  51, Train loss: 0.604, Test loss: 2.166, Test accuracy: 49.31
Round  51, Global train loss: 0.604, Global test loss: 1.838, Global test accuracy: 48.63
Round  52, Train loss: 0.525, Test loss: 2.181, Test accuracy: 49.02
Round  52, Global train loss: 0.525, Global test loss: 1.788, Global test accuracy: 51.44
Round  53, Train loss: 0.629, Test loss: 2.168, Test accuracy: 49.66
Round  53, Global train loss: 0.629, Global test loss: 1.910, Global test accuracy: 47.02
Round  54, Train loss: 0.494, Test loss: 2.230, Test accuracy: 49.00
Round  54, Global train loss: 0.494, Global test loss: 1.959, Global test accuracy: 48.04
Round  55, Train loss: 0.700, Test loss: 2.227, Test accuracy: 49.16
Round  55, Global train loss: 0.700, Global test loss: 1.830, Global test accuracy: 47.19
Round  56, Train loss: 0.602, Test loss: 2.229, Test accuracy: 49.32
Round  56, Global train loss: 0.602, Global test loss: 1.838, Global test accuracy: 49.13
Round  57, Train loss: 0.664, Test loss: 2.262, Test accuracy: 48.66
Round  57, Global train loss: 0.664, Global test loss: 1.891, Global test accuracy: 46.95
Round  58, Train loss: 0.541, Test loss: 2.275, Test accuracy: 48.46
Round  58, Global train loss: 0.541, Global test loss: 1.857, Global test accuracy: 50.01
Round  59, Train loss: 0.677, Test loss: 2.244, Test accuracy: 48.86
Round  59, Global train loss: 0.677, Global test loss: 1.826, Global test accuracy: 49.10
Round  60, Train loss: 0.562, Test loss: 2.239, Test accuracy: 48.91
Round  60, Global train loss: 0.562, Global test loss: 2.005, Global test accuracy: 47.79
Round  61, Train loss: 0.480, Test loss: 2.214, Test accuracy: 49.04
Round  61, Global train loss: 0.480, Global test loss: 1.959, Global test accuracy: 50.89
Round  62, Train loss: 0.611, Test loss: 2.220, Test accuracy: 49.46
Round  62, Global train loss: 0.611, Global test loss: 1.763, Global test accuracy: 51.99
Round  63, Train loss: 0.494, Test loss: 2.231, Test accuracy: 49.73
Round  63, Global train loss: 0.494, Global test loss: 1.808, Global test accuracy: 53.51
Round  64, Train loss: 0.620, Test loss: 2.236, Test accuracy: 50.31
Round  64, Global train loss: 0.620, Global test loss: 1.911, Global test accuracy: 48.69
Round  65, Train loss: 0.576, Test loss: 2.258, Test accuracy: 50.27
Round  65, Global train loss: 0.576, Global test loss: 1.990, Global test accuracy: 48.39
Round  66, Train loss: 0.565, Test loss: 2.238, Test accuracy: 50.46
Round  66, Global train loss: 0.565, Global test loss: 1.962, Global test accuracy: 47.76
Round  67, Train loss: 0.626, Test loss: 2.240, Test accuracy: 50.31
Round  67, Global train loss: 0.626, Global test loss: 1.957, Global test accuracy: 47.32
Round  68, Train loss: 0.596, Test loss: 2.280, Test accuracy: 49.99
Round  68, Global train loss: 0.596, Global test loss: 1.843, Global test accuracy: 49.74
Round  69, Train loss: 0.511, Test loss: 2.296, Test accuracy: 49.83
Round  69, Global train loss: 0.511, Global test loss: 2.114, Global test accuracy: 46.23
Round  70, Train loss: 0.573, Test loss: 2.305, Test accuracy: 49.43
Round  70, Global train loss: 0.573, Global test loss: 1.944, Global test accuracy: 47.27
Round  71, Train loss: 0.589, Test loss: 2.296, Test accuracy: 49.73
Round  71, Global train loss: 0.589, Global test loss: 2.011, Global test accuracy: 46.99
Round  72, Train loss: 0.437, Test loss: 2.309, Test accuracy: 49.71
Round  72, Global train loss: 0.437, Global test loss: 1.962, Global test accuracy: 50.04
Round  73, Train loss: 0.531, Test loss: 2.330, Test accuracy: 50.11
Round  73, Global train loss: 0.531, Global test loss: 2.042, Global test accuracy: 47.13
Round  74, Train loss: 0.499, Test loss: 2.369, Test accuracy: 49.65
Round  74, Global train loss: 0.499, Global test loss: 2.047, Global test accuracy: 48.23
Round  75, Train loss: 0.606, Test loss: 2.404, Test accuracy: 49.01
Round  75, Global train loss: 0.606, Global test loss: 1.927, Global test accuracy: 47.29
Round  76, Train loss: 0.500, Test loss: 2.363, Test accuracy: 49.09
Round  76, Global train loss: 0.500, Global test loss: 2.180, Global test accuracy: 45.29
Round  77, Train loss: 0.538, Test loss: 2.346, Test accuracy: 49.06
Round  77, Global train loss: 0.538, Global test loss: 1.950, Global test accuracy: 49.24
Round  78, Train loss: 0.474, Test loss: 2.387, Test accuracy: 49.16
Round  78, Global train loss: 0.474, Global test loss: 2.000, Global test accuracy: 48.61
Round  79, Train loss: 0.546, Test loss: 2.363, Test accuracy: 49.42
Round  79, Global train loss: 0.546, Global test loss: 1.970, Global test accuracy: 49.43
Round  80, Train loss: 0.371, Test loss: 2.398, Test accuracy: 49.32
Round  80, Global train loss: 0.371, Global test loss: 1.996, Global test accuracy: 51.99
Round  81, Train loss: 0.338, Test loss: 2.397, Test accuracy: 48.70
Round  81, Global train loss: 0.338, Global test loss: 2.001, Global test accuracy: 51.84
Round  82, Train loss: 0.319, Test loss: 2.391, Test accuracy: 49.13
Round  82, Global train loss: 0.319, Global test loss: 2.006, Global test accuracy: 52.60
Round  83, Train loss: 0.300, Test loss: 2.422, Test accuracy: 48.94
Round  83, Global train loss: 0.300, Global test loss: 2.024, Global test accuracy: 51.82
Round  84, Train loss: 0.288, Test loss: 2.443, Test accuracy: 49.46
Round  84, Global train loss: 0.288, Global test loss: 2.089, Global test accuracy: 51.97
Round  85, Train loss: 0.282, Test loss: 2.452, Test accuracy: 48.93
Round  85, Global train loss: 0.282, Global test loss: 2.070, Global test accuracy: 52.61
Round  86, Train loss: 0.278, Test loss: 2.475, Test accuracy: 49.11
Round  86, Global train loss: 0.278, Global test loss: 2.123, Global test accuracy: 51.93
Round  87, Train loss: 0.273, Test loss: 2.514, Test accuracy: 49.12
Round  87, Global train loss: 0.273, Global test loss: 2.141, Global test accuracy: 52.08
Round  88, Train loss: 0.267, Test loss: 2.492, Test accuracy: 48.95
Round  88, Global train loss: 0.267, Global test loss: 2.067, Global test accuracy: 52.89
Round  89, Train loss: 0.259, Test loss: 2.478, Test accuracy: 49.05
Round  89, Global train loss: 0.259, Global test loss: 2.130, Global test accuracy: 53.19
Round  90, Train loss: 0.535, Test loss: 2.359, Test accuracy: 50.30
Round  90, Global train loss: 0.535, Global test loss: 1.773, Global test accuracy: 53.39
Round  91, Train loss: 0.486, Test loss: 2.449, Test accuracy: 50.43
Round  91, Global train loss: 0.486, Global test loss: 1.792, Global test accuracy: 52.96
Round  92, Train loss: 0.476, Test loss: 2.429, Test accuracy: 50.18
Round  92, Global train loss: 0.476, Global test loss: 1.785, Global test accuracy: 52.71
Round  93, Train loss: 0.464, Test loss: 2.371, Test accuracy: 50.47
Round  93, Global train loss: 0.464, Global test loss: 1.799, Global test accuracy: 52.49
Round  94, Train loss: 0.460, Test loss: 2.486, Test accuracy: 50.53
Round  94, Global train loss: 0.460, Global test loss: 1.828, Global test accuracy: 52.26
Round  95, Train loss: 0.459, Test loss: 2.463, Test accuracy: 49.68
Round  95, Global train loss: 0.459, Global test loss: 1.818, Global test accuracy: 51.74
Round  96, Train loss: 0.451, Test loss: 2.485, Test accuracy: 49.99
Round  96, Global train loss: 0.451, Global test loss: 1.816, Global test accuracy: 52.23
Round  97, Train loss: 0.445, Test loss: 2.489, Test accuracy: 50.20
Round  97, Global train loss: 0.445, Global test loss: 1.836, Global test accuracy: 52.64
Round  98, Train loss: 0.443, Test loss: 2.491, Test accuracy: 49.68
Round  98, Global train loss: 0.443, Global test loss: 1.853, Global test accuracy: 52.26
Round  99, Train loss: 0.439, Test loss: 2.512, Test accuracy: 50.15
Round  99, Global train loss: 0.439, Global test loss: 1.842, Global test accuracy: 52.26
Final Round, Train loss: 0.273, Test loss: 2.875, Test accuracy: 50.36
Final Round, Global train loss: 0.273, Global test loss: 1.842, Global test accuracy: 52.26
Average accuracy final 10 rounds: 50.160000000000004
Average global accuracy final 10 rounds: 52.49357142857144
3414.1235632896423
[3.4255354404449463, 6.631528377532959, 9.830729007720947, 13.018773317337036, 16.223544359207153, 19.426696062088013, 22.63363242149353, 25.843782424926758, 29.081223726272583, 32.31497931480408, 35.54447031021118, 38.76791071891785, 41.99898934364319, 45.223833084106445, 48.448970794677734, 51.679038763046265, 54.91074538230896, 58.136900901794434, 61.36405801773071, 64.59613800048828, 67.82509326934814, 71.05593371391296, 73.87029910087585, 76.68144941329956, 79.49314427375793, 82.30563974380493, 85.11416506767273, 87.92715406417847, 90.73660135269165, 93.54356360435486, 96.33651804924011, 99.13099765777588, 101.92469358444214, 104.71649241447449, 107.51432371139526, 110.30834197998047, 113.10493874549866, 115.90514898300171, 118.70053267478943, 121.49477410316467, 124.29158782958984, 127.08783841133118, 129.88085532188416, 132.67713284492493, 135.47538304328918, 138.27249789237976, 141.06724977493286, 143.8421778678894, 146.6157944202423, 149.38736772537231, 152.1625943183899, 154.93842244148254, 157.69984602928162, 160.46143460273743, 163.2192702293396, 165.98385405540466, 168.74750423431396, 171.5021677017212, 174.25920248031616, 177.0159032344818, 179.77457904815674, 182.53665328025818, 185.29271268844604, 188.05162358283997, 190.8060212135315, 193.56432342529297, 196.3222141265869, 199.08797931671143, 201.86663603782654, 204.64165806770325, 207.41161060333252, 210.18420481681824, 212.9495346546173, 215.71532821655273, 218.484765291214, 221.25121450424194, 224.01756834983826, 226.78938603401184, 229.54795384407043, 232.31806111335754, 235.08503317832947, 237.8579707145691, 240.62785077095032, 243.407888174057, 246.1851851940155, 248.97512578964233, 251.77131032943726, 254.56144547462463, 257.35282039642334, 260.1722984313965, 263.0716407299042, 265.9136779308319, 268.76653003692627, 271.5807566642761, 274.4361298084259, 277.2289969921112, 280.11582040786743, 282.95762753486633, 285.71820998191833, 288.50560879707336, 292.44571232795715]
[35.45, 40.535714285714285, 45.77142857142857, 47.392857142857146, 48.871428571428574, 50.135714285714286, 50.58571428571429, 51.1, 51.22857142857143, 50.364285714285714, 50.25, 50.142857142857146, 50.02142857142857, 49.7, 49.892857142857146, 49.614285714285714, 50.18571428571428, 51.00714285714286, 50.05714285714286, 49.57142857142857, 48.90714285714286, 49.57857142857143, 50.042857142857144, 50.47857142857143, 50.621428571428574, 50.15, 49.964285714285715, 49.77857142857143, 49.457142857142856, 49.114285714285714, 49.17857142857143, 49.91428571428571, 49.45, 49.19285714285714, 49.292857142857144, 49.98571428571429, 50.07142857142857, 49.77857142857143, 49.69285714285714, 49.628571428571426, 49.82142857142857, 49.32142857142857, 49.142857142857146, 48.878571428571426, 48.871428571428574, 49.128571428571426, 49.32142857142857, 49.042857142857144, 49.57857142857143, 50.34285714285714, 49.27857142857143, 49.30714285714286, 49.02142857142857, 49.66428571428571, 49.0, 49.16428571428571, 49.32142857142857, 48.65714285714286, 48.457142857142856, 48.864285714285714, 48.90714285714286, 49.035714285714285, 49.457142857142856, 49.72857142857143, 50.31428571428572, 50.27142857142857, 50.457142857142856, 50.30714285714286, 49.98571428571429, 49.82857142857143, 49.42857142857143, 49.72857142857143, 49.714285714285715, 50.107142857142854, 49.65, 49.00714285714286, 49.08571428571429, 49.05714285714286, 49.15714285714286, 49.42142857142857, 49.32142857142857, 48.7, 49.128571428571426, 48.94285714285714, 49.464285714285715, 48.92857142857143, 49.114285714285714, 49.121428571428574, 48.95, 49.05, 50.3, 50.42857142857143, 50.17857142857143, 50.47142857142857, 50.52857142857143, 49.67857142857143, 49.98571428571429, 50.2, 49.67857142857143, 50.15, 50.364285714285714]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 7, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.898, Test loss: 1.689, Test accuracy: 33.79
Round   0, Global train loss: 1.898, Global test loss: 2.139, Global test accuracy: 24.35
Round   1, Train loss: 1.768, Test loss: 1.577, Test accuracy: 40.71
Round   1, Global train loss: 1.768, Global test loss: 1.888, Global test accuracy: 33.42
Round   2, Train loss: 1.688, Test loss: 1.494, Test accuracy: 45.22
Round   2, Global train loss: 1.688, Global test loss: 1.749, Global test accuracy: 38.44
Round   3, Train loss: 1.630, Test loss: 1.471, Test accuracy: 46.60
Round   3, Global train loss: 1.630, Global test loss: 1.667, Global test accuracy: 43.60
Round   4, Train loss: 1.578, Test loss: 1.410, Test accuracy: 48.51
Round   4, Global train loss: 1.578, Global test loss: 1.603, Global test accuracy: 45.83
Round   5, Train loss: 1.536, Test loss: 1.428, Test accuracy: 49.26
Round   5, Global train loss: 1.536, Global test loss: 1.549, Global test accuracy: 48.41
Round   6, Train loss: 1.494, Test loss: 1.403, Test accuracy: 49.37
Round   6, Global train loss: 1.494, Global test loss: 1.511, Global test accuracy: 50.34
Round   7, Train loss: 1.448, Test loss: 1.411, Test accuracy: 49.75
Round   7, Global train loss: 1.448, Global test loss: 1.463, Global test accuracy: 51.71
Round   8, Train loss: 1.407, Test loss: 1.398, Test accuracy: 50.33
Round   8, Global train loss: 1.407, Global test loss: 1.442, Global test accuracy: 52.94
Round   9, Train loss: 1.361, Test loss: 1.398, Test accuracy: 51.04
Round   9, Global train loss: 1.361, Global test loss: 1.420, Global test accuracy: 53.44
Round  10, Train loss: 1.372, Test loss: 1.402, Test accuracy: 51.11
Round  10, Global train loss: 1.372, Global test loss: 1.554, Global test accuracy: 46.77
Round  11, Train loss: 1.271, Test loss: 1.426, Test accuracy: 50.91
Round  11, Global train loss: 1.271, Global test loss: 1.492, Global test accuracy: 49.44
Round  12, Train loss: 1.406, Test loss: 1.446, Test accuracy: 50.46
Round  12, Global train loss: 1.406, Global test loss: 1.625, Global test accuracy: 44.92
Round  13, Train loss: 1.324, Test loss: 1.452, Test accuracy: 50.70
Round  13, Global train loss: 1.324, Global test loss: 1.519, Global test accuracy: 49.04
Round  14, Train loss: 1.163, Test loss: 1.482, Test accuracy: 50.06
Round  14, Global train loss: 1.163, Global test loss: 1.543, Global test accuracy: 49.81
Round  15, Train loss: 1.057, Test loss: 1.521, Test accuracy: 49.36
Round  15, Global train loss: 1.057, Global test loss: 1.387, Global test accuracy: 53.39
Round  16, Train loss: 1.041, Test loss: 1.544, Test accuracy: 49.36
Round  16, Global train loss: 1.041, Global test loss: 1.490, Global test accuracy: 49.61
Round  17, Train loss: 0.979, Test loss: 1.573, Test accuracy: 49.23
Round  17, Global train loss: 0.979, Global test loss: 1.443, Global test accuracy: 52.07
Round  18, Train loss: 1.152, Test loss: 1.602, Test accuracy: 48.36
Round  18, Global train loss: 1.152, Global test loss: 1.550, Global test accuracy: 49.56
Round  19, Train loss: 1.057, Test loss: 1.627, Test accuracy: 48.66
Round  19, Global train loss: 1.057, Global test loss: 1.498, Global test accuracy: 50.44
Round  20, Train loss: 1.033, Test loss: 1.666, Test accuracy: 48.09
Round  20, Global train loss: 1.033, Global test loss: 1.603, Global test accuracy: 47.89
Round  21, Train loss: 0.953, Test loss: 1.696, Test accuracy: 48.71
Round  21, Global train loss: 0.953, Global test loss: 1.468, Global test accuracy: 52.20
Round  22, Train loss: 0.863, Test loss: 1.730, Test accuracy: 48.69
Round  22, Global train loss: 0.863, Global test loss: 1.641, Global test accuracy: 48.11
Round  23, Train loss: 1.020, Test loss: 1.724, Test accuracy: 48.95
Round  23, Global train loss: 1.020, Global test loss: 1.593, Global test accuracy: 49.50
Round  24, Train loss: 1.120, Test loss: 1.747, Test accuracy: 49.29
Round  24, Global train loss: 1.120, Global test loss: 1.622, Global test accuracy: 46.86
Round  25, Train loss: 0.944, Test loss: 1.774, Test accuracy: 49.40
Round  25, Global train loss: 0.944, Global test loss: 1.626, Global test accuracy: 49.98
Round  26, Train loss: 0.835, Test loss: 1.803, Test accuracy: 49.22
Round  26, Global train loss: 0.835, Global test loss: 1.669, Global test accuracy: 48.71
Round  27, Train loss: 0.964, Test loss: 1.837, Test accuracy: 48.65
Round  27, Global train loss: 0.964, Global test loss: 1.684, Global test accuracy: 47.04
Round  28, Train loss: 0.868, Test loss: 1.864, Test accuracy: 48.41
Round  28, Global train loss: 0.868, Global test loss: 1.807, Global test accuracy: 46.59
Round  29, Train loss: 0.682, Test loss: 1.896, Test accuracy: 48.39
Round  29, Global train loss: 0.682, Global test loss: 1.709, Global test accuracy: 51.21
Round  30, Train loss: 0.799, Test loss: 1.938, Test accuracy: 48.10
Round  30, Global train loss: 0.799, Global test loss: 1.684, Global test accuracy: 51.10
Round  31, Train loss: 0.860, Test loss: 1.958, Test accuracy: 48.13
Round  31, Global train loss: 0.860, Global test loss: 1.583, Global test accuracy: 51.20
Round  32, Train loss: 0.668, Test loss: 1.975, Test accuracy: 48.00
Round  32, Global train loss: 0.668, Global test loss: 1.634, Global test accuracy: 52.41
Round  33, Train loss: 0.760, Test loss: 1.951, Test accuracy: 48.88
Round  33, Global train loss: 0.760, Global test loss: 1.681, Global test accuracy: 49.96
Round  34, Train loss: 0.757, Test loss: 1.973, Test accuracy: 48.90
Round  34, Global train loss: 0.757, Global test loss: 1.745, Global test accuracy: 48.77
Round  35, Train loss: 0.779, Test loss: 1.996, Test accuracy: 48.40
Round  35, Global train loss: 0.779, Global test loss: 1.814, Global test accuracy: 47.00
Round  36, Train loss: 0.735, Test loss: 1.996, Test accuracy: 48.32
Round  36, Global train loss: 0.735, Global test loss: 1.861, Global test accuracy: 47.22
Round  37, Train loss: 0.697, Test loss: 1.985, Test accuracy: 48.64
Round  37, Global train loss: 0.697, Global test loss: 1.646, Global test accuracy: 52.32
Round  38, Train loss: 0.814, Test loss: 2.029, Test accuracy: 48.32
Round  38, Global train loss: 0.814, Global test loss: 1.616, Global test accuracy: 51.80