nohup: ignoring input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.641, Test loss: 2.181, Test accuracy: 24.37
Round   0, Global train loss: 1.641, Global test loss: 2.357, Global test accuracy: 22.28
Round   1, Train loss: 1.428, Test loss: 1.765, Test accuracy: 32.46
Round   1, Global train loss: 1.428, Global test loss: 2.087, Global test accuracy: 27.11
Round   2, Train loss: 1.318, Test loss: 1.533, Test accuracy: 38.62
Round   2, Global train loss: 1.318, Global test loss: 2.025, Global test accuracy: 28.58
Round   3, Train loss: 1.290, Test loss: 1.331, Test accuracy: 44.95
Round   3, Global train loss: 1.290, Global test loss: 2.023, Global test accuracy: 27.60
Round   4, Train loss: 1.208, Test loss: 1.204, Test accuracy: 48.80
Round   4, Global train loss: 1.208, Global test loss: 2.132, Global test accuracy: 26.63
Round   5, Train loss: 1.094, Test loss: 1.171, Test accuracy: 50.55
Round   5, Global train loss: 1.094, Global test loss: 2.167, Global test accuracy: 27.73
Round   6, Train loss: 1.090, Test loss: 1.144, Test accuracy: 52.31
Round   6, Global train loss: 1.090, Global test loss: 1.993, Global test accuracy: 33.36
Round   7, Train loss: 1.083, Test loss: 1.124, Test accuracy: 53.95
Round   7, Global train loss: 1.083, Global test loss: 2.021, Global test accuracy: 30.62
Round   8, Train loss: 1.154, Test loss: 1.096, Test accuracy: 56.06
Round   8, Global train loss: 1.154, Global test loss: 2.160, Global test accuracy: 27.29
Round   9, Train loss: 1.028, Test loss: 1.083, Test accuracy: 56.66
Round   9, Global train loss: 1.028, Global test loss: 1.903, Global test accuracy: 29.54
Round  10, Train loss: 0.993, Test loss: 1.069, Test accuracy: 57.17
Round  10, Global train loss: 0.993, Global test loss: 2.077, Global test accuracy: 28.09
Round  11, Train loss: 0.996, Test loss: 1.045, Test accuracy: 57.55
Round  11, Global train loss: 0.996, Global test loss: 1.969, Global test accuracy: 34.36
Round  12, Train loss: 0.930, Test loss: 1.041, Test accuracy: 58.00
Round  12, Global train loss: 0.930, Global test loss: 1.993, Global test accuracy: 31.06
Round  13, Train loss: 0.886, Test loss: 1.038, Test accuracy: 58.63
Round  13, Global train loss: 0.886, Global test loss: 1.977, Global test accuracy: 31.93
Round  14, Train loss: 0.854, Test loss: 1.039, Test accuracy: 59.16
Round  14, Global train loss: 0.854, Global test loss: 1.930, Global test accuracy: 31.59
Round  15, Train loss: 0.818, Test loss: 1.031, Test accuracy: 59.78
Round  15, Global train loss: 0.818, Global test loss: 1.935, Global test accuracy: 34.64
Round  16, Train loss: 0.781, Test loss: 1.041, Test accuracy: 59.38
Round  16, Global train loss: 0.781, Global test loss: 1.741, Global test accuracy: 36.39
Round  17, Train loss: 0.878, Test loss: 1.037, Test accuracy: 60.16
Round  17, Global train loss: 0.878, Global test loss: 1.886, Global test accuracy: 33.13
Round  18, Train loss: 0.749, Test loss: 1.032, Test accuracy: 60.53
Round  18, Global train loss: 0.749, Global test loss: 2.438, Global test accuracy: 28.24
Round  19, Train loss: 0.822, Test loss: 1.048, Test accuracy: 59.96
Round  19, Global train loss: 0.822, Global test loss: 2.122, Global test accuracy: 30.64
Round  20, Train loss: 0.733, Test loss: 1.037, Test accuracy: 60.26
Round  20, Global train loss: 0.733, Global test loss: 1.767, Global test accuracy: 38.14
Round  21, Train loss: 0.649, Test loss: 1.044, Test accuracy: 60.26
Round  21, Global train loss: 0.649, Global test loss: 2.011, Global test accuracy: 32.57
Round  22, Train loss: 0.715, Test loss: 1.042, Test accuracy: 60.98
Round  22, Global train loss: 0.715, Global test loss: 2.373, Global test accuracy: 32.29
Round  23, Train loss: 0.710, Test loss: 1.039, Test accuracy: 61.49
Round  23, Global train loss: 0.710, Global test loss: 1.930, Global test accuracy: 35.58
Round  24, Train loss: 0.614, Test loss: 1.062, Test accuracy: 61.60
Round  24, Global train loss: 0.614, Global test loss: 2.263, Global test accuracy: 31.18
Round  25, Train loss: 0.650, Test loss: 1.045, Test accuracy: 62.43
Round  25, Global train loss: 0.650, Global test loss: 1.784, Global test accuracy: 35.77
Round  26, Train loss: 0.587, Test loss: 1.066, Test accuracy: 62.01
Round  26, Global train loss: 0.587, Global test loss: 1.905, Global test accuracy: 38.89
Round  27, Train loss: 0.588, Test loss: 1.079, Test accuracy: 62.18
Round  27, Global train loss: 0.588, Global test loss: 2.023, Global test accuracy: 26.01
Round  28, Train loss: 0.635, Test loss: 1.088, Test accuracy: 62.18
Round  28, Global train loss: 0.635, Global test loss: 2.109, Global test accuracy: 27.19
Round  29, Train loss: 0.708, Test loss: 1.086, Test accuracy: 62.81
Round  29, Global train loss: 0.708, Global test loss: 1.906, Global test accuracy: 32.68
Round  30, Train loss: 0.628, Test loss: 1.073, Test accuracy: 63.19
Round  30, Global train loss: 0.628, Global test loss: 1.751, Global test accuracy: 39.58
Round  31, Train loss: 0.596, Test loss: 1.102, Test accuracy: 62.77
Round  31, Global train loss: 0.596, Global test loss: 1.955, Global test accuracy: 30.88
Round  32, Train loss: 0.517, Test loss: 1.112, Test accuracy: 62.63
Round  32, Global train loss: 0.517, Global test loss: 1.871, Global test accuracy: 35.56
Round  33, Train loss: 0.603, Test loss: 1.117, Test accuracy: 62.92
Round  33, Global train loss: 0.603, Global test loss: 2.242, Global test accuracy: 30.32
Round  34, Train loss: 0.571, Test loss: 1.106, Test accuracy: 63.41
Round  34, Global train loss: 0.571, Global test loss: 1.892, Global test accuracy: 32.30
Round  35, Train loss: 0.491, Test loss: 1.108, Test accuracy: 63.50
Round  35, Global train loss: 0.491, Global test loss: 2.098, Global test accuracy: 26.88
Round  36, Train loss: 0.583, Test loss: 1.114, Test accuracy: 63.45
Round  36, Global train loss: 0.583, Global test loss: 1.764, Global test accuracy: 33.21
Round  37, Train loss: 0.471, Test loss: 1.142, Test accuracy: 63.11
Round  37, Global train loss: 0.471, Global test loss: 2.730, Global test accuracy: 34.02
Round  38, Train loss: 0.447, Test loss: 1.155, Test accuracy: 63.53
Round  38, Global train loss: 0.447, Global test loss: 2.100, Global test accuracy: 31.16
Round  39, Train loss: 0.411, Test loss: 1.162, Test accuracy: 63.91
Round  39, Global train loss: 0.411, Global test loss: 2.056, Global test accuracy: 27.93
Round  40, Train loss: 0.453, Test loss: 1.160, Test accuracy: 63.88
Round  40, Global train loss: 0.453, Global test loss: 1.771, Global test accuracy: 36.42
Round  41, Train loss: 0.379, Test loss: 1.223, Test accuracy: 63.09
Round  41, Global train loss: 0.379, Global test loss: 1.888, Global test accuracy: 35.01
Round  42, Train loss: 0.327, Test loss: 1.245, Test accuracy: 62.92
Round  42, Global train loss: 0.327, Global test loss: 1.930, Global test accuracy: 34.42
Round  43, Train loss: 0.411, Test loss: 1.262, Test accuracy: 63.18
Round  43, Global train loss: 0.411, Global test loss: 2.139, Global test accuracy: 29.87
Round  44, Train loss: 0.374, Test loss: 1.263, Test accuracy: 63.63
Round  44, Global train loss: 0.374, Global test loss: 1.825, Global test accuracy: 36.42
Round  45, Train loss: 0.439, Test loss: 1.304, Test accuracy: 63.34
Round  45, Global train loss: 0.439, Global test loss: 2.435, Global test accuracy: 29.41
Round  46, Train loss: 0.387, Test loss: 1.294, Test accuracy: 63.43
Round  46, Global train loss: 0.387, Global test loss: 1.963, Global test accuracy: 31.49
Round  47, Train loss: 0.377, Test loss: 1.309, Test accuracy: 63.40
Round  47, Global train loss: 0.377, Global test loss: 1.936, Global test accuracy: 29.43
Round  48, Train loss: 0.305, Test loss: 1.338, Test accuracy: 63.31
Round  48, Global train loss: 0.305, Global test loss: 2.122, Global test accuracy: 31.03
Round  49, Train loss: 0.375, Test loss: 1.328, Test accuracy: 63.30
Round  49, Global train loss: 0.375, Global test loss: 1.910, Global test accuracy: 32.57
Round  50, Train loss: 0.304, Test loss: 1.343, Test accuracy: 63.35
Round  50, Global train loss: 0.304, Global test loss: 1.909, Global test accuracy: 30.22
Round  51, Train loss: 0.235, Test loss: 1.411, Test accuracy: 63.21
Round  51, Global train loss: 0.235, Global test loss: 2.146, Global test accuracy: 29.14
Round  52, Train loss: 0.303, Test loss: 1.413, Test accuracy: 63.75
Round  52, Global train loss: 0.303, Global test loss: 2.434, Global test accuracy: 29.52
Round  53, Train loss: 0.268, Test loss: 1.410, Test accuracy: 63.53
Round  53, Global train loss: 0.268, Global test loss: 2.499, Global test accuracy: 33.90
Round  54, Train loss: 0.249, Test loss: 1.437, Test accuracy: 63.83
Round  54, Global train loss: 0.249, Global test loss: 2.473, Global test accuracy: 31.12
Round  55, Train loss: 0.188, Test loss: 1.481, Test accuracy: 63.07
Round  55, Global train loss: 0.188, Global test loss: 2.274, Global test accuracy: 32.52
Round  56, Train loss: 0.241, Test loss: 1.499, Test accuracy: 63.69
Round  56, Global train loss: 0.241, Global test loss: 2.129, Global test accuracy: 35.51
Round  57, Train loss: 0.357, Test loss: 1.511, Test accuracy: 63.45
Round  57, Global train loss: 0.357, Global test loss: 1.910, Global test accuracy: 31.36
Round  58, Train loss: 0.286, Test loss: 1.512, Test accuracy: 63.42
Round  58, Global train loss: 0.286, Global test loss: 1.722, Global test accuracy: 36.81
Round  59, Train loss: 0.243, Test loss: 1.489, Test accuracy: 63.99
Round  59, Global train loss: 0.243, Global test loss: 2.156, Global test accuracy: 28.87
Round  60, Train loss: 0.259, Test loss: 1.516, Test accuracy: 63.88
Round  60, Global train loss: 0.259, Global test loss: 2.068, Global test accuracy: 36.56
Round  61, Train loss: 0.246, Test loss: 1.528, Test accuracy: 64.28
Round  61, Global train loss: 0.246, Global test loss: 2.088, Global test accuracy: 31.28
Round  62, Train loss: 0.240, Test loss: 1.566, Test accuracy: 63.88
Round  62, Global train loss: 0.240, Global test loss: 1.792, Global test accuracy: 33.43
Round  63, Train loss: 0.190, Test loss: 1.568, Test accuracy: 63.95
Round  63, Global train loss: 0.190, Global test loss: 2.033, Global test accuracy: 33.19
Round  64, Train loss: 0.229, Test loss: 1.629, Test accuracy: 64.23
Round  64, Global train loss: 0.229, Global test loss: 1.899, Global test accuracy: 31.84
Round  65, Train loss: 0.172, Test loss: 1.630, Test accuracy: 64.35
Round  65, Global train loss: 0.172, Global test loss: 2.050, Global test accuracy: 32.71
Round  66, Train loss: 0.226, Test loss: 1.622, Test accuracy: 64.58
Round  66, Global train loss: 0.226, Global test loss: 2.047, Global test accuracy: 25.26
Round  67, Train loss: 0.167, Test loss: 1.613, Test accuracy: 64.41
Round  67, Global train loss: 0.167, Global test loss: 2.413, Global test accuracy: 33.61
Round  68, Train loss: 0.169, Test loss: 1.647, Test accuracy: 64.08
Round  68, Global train loss: 0.169, Global test loss: 2.035, Global test accuracy: 33.98
Round  69, Train loss: 0.155, Test loss: 1.646, Test accuracy: 64.40
Round  69, Global train loss: 0.155, Global test loss: 2.342, Global test accuracy: 33.43
Round  70, Train loss: 0.179, Test loss: 1.656, Test accuracy: 64.06
Round  70, Global train loss: 0.179, Global test loss: 1.871, Global test accuracy: 34.93
Round  71, Train loss: 0.202, Test loss: 1.670, Test accuracy: 63.74
Round  71, Global train loss: 0.202, Global test loss: 1.884, Global test accuracy: 33.70
Round  72, Train loss: 0.193, Test loss: 1.723, Test accuracy: 63.99
Round  72, Global train loss: 0.193, Global test loss: 2.111, Global test accuracy: 31.50
Round  73, Train loss: 0.170, Test loss: 1.741, Test accuracy: 64.08
Round  73, Global train loss: 0.170, Global test loss: 1.851, Global test accuracy: 38.35
Round  74, Train loss: 0.145, Test loss: 1.756, Test accuracy: 63.83
Round  74, Global train loss: 0.145, Global test loss: 2.064, Global test accuracy: 29.52
Round  75, Train loss: 0.187, Test loss: 1.784, Test accuracy: 63.59
Round  75, Global train loss: 0.187, Global test loss: 1.848, Global test accuracy: 33.78
Round  76, Train loss: 0.185, Test loss: 1.750, Test accuracy: 64.19
Round  76, Global train loss: 0.185, Global test loss: 1.872, Global test accuracy: 32.33
Round  77, Train loss: 0.195, Test loss: 1.731, Test accuracy: 64.53
Round  77, Global train loss: 0.195, Global test loss: 2.046, Global test accuracy: 29.37
Round  78, Train loss: 0.148, Test loss: 1.801, Test accuracy: 64.29
Round  78, Global train loss: 0.148, Global test loss: 1.794, Global test accuracy: 38.95
Round  79, Train loss: 0.190, Test loss: 1.757, Test accuracy: 64.18
Round  79, Global train loss: 0.190, Global test loss: 2.135, Global test accuracy: 35.08
Round  80, Train loss: 0.129, Test loss: 1.758, Test accuracy: 64.15
Round  80, Global train loss: 0.129, Global test loss: 2.348, Global test accuracy: 30.52
Round  81, Train loss: 0.156, Test loss: 1.773, Test accuracy: 64.06
Round  81, Global train loss: 0.156, Global test loss: 1.815, Global test accuracy: 38.55
Round  82, Train loss: 0.146, Test loss: 1.769, Test accuracy: 64.43
Round  82, Global train loss: 0.146, Global test loss: 1.886, Global test accuracy: 35.24
Round  83, Train loss: 0.169, Test loss: 1.749, Test accuracy: 64.50
Round  83, Global train loss: 0.169, Global test loss: 2.145, Global test accuracy: 31.45
Round  84, Train loss: 0.133, Test loss: 1.788, Test accuracy: 64.03
Round  84, Global train loss: 0.133, Global test loss: 2.090, Global test accuracy: 39.87
Round  85, Train loss: 0.125, Test loss: 1.794, Test accuracy: 64.32
Round  85, Global train loss: 0.125, Global test loss: 1.761, Global test accuracy: 37.44
Round  86, Train loss: 0.112, Test loss: 1.847, Test accuracy: 64.13
Round  86, Global train loss: 0.112, Global test loss: 2.254, Global test accuracy: 26.81
Round  87, Train loss: 0.117, Test loss: 1.865, Test accuracy: 63.99
Round  87, Global train loss: 0.117, Global test loss: 2.210, Global test accuracy: 33.52
Round  88, Train loss: 0.100, Test loss: 1.852, Test accuracy: 64.13
Round  88, Global train loss: 0.100, Global test loss: 2.297, Global test accuracy: 30.04
Round  89, Train loss: 0.125, Test loss: 1.875, Test accuracy: 64.44
Round  89, Global train loss: 0.125, Global test loss: 1.831, Global test accuracy: 36.55
Round  90, Train loss: 0.106, Test loss: 1.922, Test accuracy: 64.34
Round  90, Global train loss: 0.106, Global test loss: 2.045, Global test accuracy: 34.52
Round  91, Train loss: 0.110, Test loss: 1.927, Test accuracy: 64.10
Round  91, Global train loss: 0.110, Global test loss: 1.996, Global test accuracy: 32.84
Round  92, Train loss: 0.107, Test loss: 1.931, Test accuracy: 64.16
Round  92, Global train loss: 0.107, Global test loss: 1.863, Global test accuracy: 35.81
Round  93, Train loss: 0.132, Test loss: 1.938, Test accuracy: 64.18
Round  93, Global train loss: 0.132, Global test loss: 2.126, Global test accuracy: 28.63
Round  94, Train loss: 0.144, Test loss: 1.920, Test accuracy: 64.70
Round  94, Global train loss: 0.144, Global test loss: 1.896, Global test accuracy: 35.15
Round  95, Train loss: 0.090, Test loss: 1.961, Test accuracy: 64.66
Round  95, Global train loss: 0.090, Global test loss: 1.985, Global test accuracy: 33.52
Round  96, Train loss: 0.088, Test loss: 1.992, Test accuracy: 64.74
Round  96, Global train loss: 0.088, Global test loss: 1.828, Global test accuracy: 36.01
Round  97, Train loss: 0.129, Test loss: 1.985, Test accuracy: 64.64
Round  97, Global train loss: 0.129, Global test loss: 2.077, Global test accuracy: 29.79
Round  98, Train loss: 0.104, Test loss: 2.032, Test accuracy: 64.53
Round  98, Global train loss: 0.104, Global test loss: 1.826, Global test accuracy: 39.27
Round  99, Train loss: 0.091, Test loss: 2.050, Test accuracy: 64.37
Round  99, Global train loss: 0.091, Global test loss: 2.660, Global test accuracy: 29.98
Final Round, Train loss: 0.099, Test loss: 2.079, Test accuracy: 63.60
Final Round, Global train loss: 0.099, Global test loss: 2.660, Global test accuracy: 29.98
Average accuracy final 10 rounds: 64.442 

Average global accuracy final 10 rounds: 33.552 

1318.6020727157593
[1.3785765171051025, 2.757153034210205, 3.894353151321411, 5.031553268432617, 6.17095685005188, 7.310360431671143, 8.449622869491577, 9.588885307312012, 10.726981163024902, 11.865077018737793, 13.008920431137085, 14.152763843536377, 15.292832136154175, 16.432900428771973, 17.568169832229614, 18.703439235687256, 19.838165998458862, 20.97289276123047, 22.110035181045532, 23.247177600860596, 24.37935781478882, 25.51153802871704, 26.6418399810791, 27.772141933441162, 28.900469303131104, 30.028796672821045, 31.156439781188965, 32.284082889556885, 33.41050577163696, 34.53692865371704, 35.661946296691895, 36.78696393966675, 37.9166202545166, 39.046276569366455, 40.18394374847412, 41.32161092758179, 42.45448040962219, 43.5873498916626, 44.72020387649536, 45.853057861328125, 46.99315881729126, 48.133259773254395, 49.26458215713501, 50.395904541015625, 51.52879309654236, 52.66168165206909, 53.79119372367859, 54.920705795288086, 56.05576968193054, 57.190833568573, 58.32546854019165, 59.4601035118103, 60.59628248214722, 61.73246145248413, 62.869110107421875, 64.00575876235962, 65.12677788734436, 66.2477970123291, 67.36964559555054, 68.49149417877197, 69.61386466026306, 70.73623514175415, 71.86540293693542, 72.9945707321167, 74.1218318939209, 75.2490930557251, 76.37386894226074, 77.49864482879639, 78.61949563026428, 79.74034643173218, 80.86106991767883, 81.98179340362549, 83.10087418556213, 84.21995496749878, 85.3394341468811, 86.45891332626343, 87.58027744293213, 88.70164155960083, 89.82672810554504, 90.95181465148926, 92.07569909095764, 93.19958353042603, 94.32058048248291, 95.4415774345398, 96.56884336471558, 97.69610929489136, 98.82048296928406, 99.94485664367676, 101.070969581604, 102.19708251953125, 103.31687688827515, 104.43667125701904, 105.56930184364319, 106.70193243026733, 107.83051204681396, 108.9590916633606, 110.09292459487915, 111.2267575263977, 112.35793662071228, 113.48911571502686, 114.61124014854431, 115.73336458206177, 116.85331296920776, 117.97326135635376, 119.0959837436676, 120.21870613098145, 121.33881115913391, 122.45891618728638, 123.5811858177185, 124.70345544815063, 125.8317346572876, 126.96001386642456, 128.08905267715454, 129.21809148788452, 130.3403069972992, 131.46252250671387, 132.591379404068, 133.72023630142212, 134.8399531841278, 135.9596700668335, 137.0805323123932, 138.20139455795288, 139.3237748146057, 140.44615507125854, 141.57130098342896, 142.69644689559937, 143.81350088119507, 144.93055486679077, 145.88876605033875, 146.84697723388672, 147.80737709999084, 148.76777696609497, 149.72596526145935, 150.68415355682373, 151.64197516441345, 152.59979677200317, 153.55685925483704, 154.5139217376709, 155.47224831581116, 156.43057489395142, 157.39659595489502, 158.36261701583862, 159.3181631565094, 160.27370929718018, 161.2313733100891, 162.18903732299805, 163.14689230918884, 164.10474729537964, 165.06264185905457, 166.0205364227295, 166.97783589363098, 167.93513536453247, 168.89365243911743, 169.8521695137024, 170.81257128715515, 171.7729730606079, 172.73300647735596, 173.693039894104, 174.65341091156006, 175.6137819290161, 176.57059359550476, 177.5274052619934, 178.48558950424194, 179.44377374649048, 180.39989185333252, 181.35600996017456, 182.312824010849, 183.26963806152344, 184.228502035141, 185.18736600875854, 186.14294028282166, 187.09851455688477, 188.05507683753967, 189.01163911819458, 189.96892881393433, 190.92621850967407, 191.88311743736267, 192.84001636505127, 193.8275125026703, 194.8150086402893, 195.77084803581238, 196.72668743133545, 197.69649982452393, 198.6663122177124, 199.62411046028137, 200.58190870285034, 201.53990054130554, 202.49789237976074, 203.4549150466919, 204.41193771362305, 205.3702712059021, 206.32860469818115, 207.28410696983337, 208.2396092414856, 209.20814061164856, 210.17667198181152, 211.13273859024048, 212.08880519866943, 213.04925203323364, 214.00969886779785, 215.92445969581604, 217.83922052383423]
[24.37, 24.37, 32.46, 32.46, 38.62, 38.62, 44.95, 44.95, 48.8, 48.8, 50.55, 50.55, 52.31, 52.31, 53.95, 53.95, 56.06, 56.06, 56.66, 56.66, 57.17, 57.17, 57.55, 57.55, 58.0, 58.0, 58.63, 58.63, 59.16, 59.16, 59.78, 59.78, 59.38, 59.38, 60.16, 60.16, 60.53, 60.53, 59.96, 59.96, 60.26, 60.26, 60.26, 60.26, 60.98, 60.98, 61.49, 61.49, 61.6, 61.6, 62.43, 62.43, 62.01, 62.01, 62.18, 62.18, 62.18, 62.18, 62.81, 62.81, 63.19, 63.19, 62.77, 62.77, 62.63, 62.63, 62.92, 62.92, 63.41, 63.41, 63.5, 63.5, 63.45, 63.45, 63.11, 63.11, 63.53, 63.53, 63.91, 63.91, 63.88, 63.88, 63.09, 63.09, 62.92, 62.92, 63.18, 63.18, 63.63, 63.63, 63.34, 63.34, 63.43, 63.43, 63.4, 63.4, 63.31, 63.31, 63.3, 63.3, 63.35, 63.35, 63.21, 63.21, 63.75, 63.75, 63.53, 63.53, 63.83, 63.83, 63.07, 63.07, 63.69, 63.69, 63.45, 63.45, 63.42, 63.42, 63.99, 63.99, 63.88, 63.88, 64.28, 64.28, 63.88, 63.88, 63.95, 63.95, 64.23, 64.23, 64.35, 64.35, 64.58, 64.58, 64.41, 64.41, 64.08, 64.08, 64.4, 64.4, 64.06, 64.06, 63.74, 63.74, 63.99, 63.99, 64.08, 64.08, 63.83, 63.83, 63.59, 63.59, 64.19, 64.19, 64.53, 64.53, 64.29, 64.29, 64.18, 64.18, 64.15, 64.15, 64.06, 64.06, 64.43, 64.43, 64.5, 64.5, 64.03, 64.03, 64.32, 64.32, 64.13, 64.13, 63.99, 63.99, 64.13, 64.13, 64.44, 64.44, 64.34, 64.34, 64.1, 64.1, 64.16, 64.16, 64.18, 64.18, 64.7, 64.7, 64.66, 64.66, 64.74, 64.74, 64.64, 64.64, 64.53, 64.53, 64.37, 64.37, 63.6, 63.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.633, Test loss: 1.973, Test accuracy: 25.55
Round   0, Global train loss: 1.633, Global test loss: 2.185, Global test accuracy: 22.12
Round   1, Train loss: 1.422, Test loss: 1.811, Test accuracy: 32.28
Round   1, Global train loss: 1.422, Global test loss: 2.140, Global test accuracy: 26.80
Round   2, Train loss: 1.360, Test loss: 1.555, Test accuracy: 37.06
Round   2, Global train loss: 1.360, Global test loss: 2.026, Global test accuracy: 26.53
Round   3, Train loss: 1.237, Test loss: 1.444, Test accuracy: 42.98
Round   3, Global train loss: 1.237, Global test loss: 1.955, Global test accuracy: 28.61
Round   4, Train loss: 1.173, Test loss: 1.362, Test accuracy: 46.19
Round   4, Global train loss: 1.173, Global test loss: 1.861, Global test accuracy: 33.08
Round   5, Train loss: 1.127, Test loss: 1.278, Test accuracy: 48.93
Round   5, Global train loss: 1.127, Global test loss: 2.010, Global test accuracy: 30.93
Round   6, Train loss: 1.104, Test loss: 1.207, Test accuracy: 50.50
Round   6, Global train loss: 1.104, Global test loss: 1.667, Global test accuracy: 38.42
Round   7, Train loss: 1.025, Test loss: 1.119, Test accuracy: 54.08
Round   7, Global train loss: 1.025, Global test loss: 1.631, Global test accuracy: 40.48
Round   8, Train loss: 1.029, Test loss: 1.039, Test accuracy: 58.44
Round   8, Global train loss: 1.029, Global test loss: 1.670, Global test accuracy: 41.99
Round   9, Train loss: 1.009, Test loss: 1.037, Test accuracy: 58.39
Round   9, Global train loss: 1.009, Global test loss: 1.525, Global test accuracy: 44.09
Round  10, Train loss: 0.986, Test loss: 1.020, Test accuracy: 59.09
Round  10, Global train loss: 0.986, Global test loss: 1.477, Global test accuracy: 43.69
Round  11, Train loss: 0.989, Test loss: 0.991, Test accuracy: 60.28
Round  11, Global train loss: 0.989, Global test loss: 1.578, Global test accuracy: 42.36
Round  12, Train loss: 0.864, Test loss: 0.978, Test accuracy: 60.65
Round  12, Global train loss: 0.864, Global test loss: 1.700, Global test accuracy: 41.31
Round  13, Train loss: 0.903, Test loss: 0.946, Test accuracy: 62.34
Round  13, Global train loss: 0.903, Global test loss: 1.549, Global test accuracy: 47.09
Round  14, Train loss: 0.832, Test loss: 0.949, Test accuracy: 62.49
Round  14, Global train loss: 0.832, Global test loss: 1.657, Global test accuracy: 46.08
Round  15, Train loss: 0.849, Test loss: 0.939, Test accuracy: 63.32
Round  15, Global train loss: 0.849, Global test loss: 1.637, Global test accuracy: 46.79
Round  16, Train loss: 0.850, Test loss: 0.950, Test accuracy: 62.99
Round  16, Global train loss: 0.850, Global test loss: 1.505, Global test accuracy: 45.42
Round  17, Train loss: 0.859, Test loss: 0.924, Test accuracy: 63.80
Round  17, Global train loss: 0.859, Global test loss: 1.332, Global test accuracy: 51.85
Round  18, Train loss: 0.900, Test loss: 0.877, Test accuracy: 65.96
Round  18, Global train loss: 0.900, Global test loss: 1.330, Global test accuracy: 51.85
Round  19, Train loss: 0.808, Test loss: 0.879, Test accuracy: 66.31
Round  19, Global train loss: 0.808, Global test loss: 1.441, Global test accuracy: 50.63
Round  20, Train loss: 0.813, Test loss: 0.885, Test accuracy: 66.15
Round  20, Global train loss: 0.813, Global test loss: 1.433, Global test accuracy: 49.54
Round  21, Train loss: 0.739, Test loss: 0.877, Test accuracy: 66.74
Round  21, Global train loss: 0.739, Global test loss: 1.705, Global test accuracy: 45.48
Round  22, Train loss: 0.814, Test loss: 0.875, Test accuracy: 67.33
Round  22, Global train loss: 0.814, Global test loss: 1.305, Global test accuracy: 54.41
Round  23, Train loss: 0.775, Test loss: 0.856, Test accuracy: 67.93
Round  23, Global train loss: 0.775, Global test loss: 1.457, Global test accuracy: 49.32
Round  24, Train loss: 0.748, Test loss: 0.853, Test accuracy: 68.20
Round  24, Global train loss: 0.748, Global test loss: 1.387, Global test accuracy: 53.67
Round  25, Train loss: 0.774, Test loss: 0.827, Test accuracy: 69.32
Round  25, Global train loss: 0.774, Global test loss: 1.498, Global test accuracy: 49.11
Round  26, Train loss: 0.647, Test loss: 0.827, Test accuracy: 69.16
Round  26, Global train loss: 0.647, Global test loss: 1.355, Global test accuracy: 54.45
Round  27, Train loss: 0.703, Test loss: 0.817, Test accuracy: 69.52
Round  27, Global train loss: 0.703, Global test loss: 1.224, Global test accuracy: 56.49
Round  28, Train loss: 0.660, Test loss: 0.826, Test accuracy: 69.47
Round  28, Global train loss: 0.660, Global test loss: 1.326, Global test accuracy: 54.95
Round  29, Train loss: 0.637, Test loss: 0.832, Test accuracy: 69.75
Round  29, Global train loss: 0.637, Global test loss: 1.396, Global test accuracy: 52.95
Round  30, Train loss: 0.627, Test loss: 0.837, Test accuracy: 69.58
Round  30, Global train loss: 0.627, Global test loss: 1.494, Global test accuracy: 50.09
Round  31, Train loss: 0.616, Test loss: 0.842, Test accuracy: 69.78
Round  31, Global train loss: 0.616, Global test loss: 1.288, Global test accuracy: 56.21
Round  32, Train loss: 0.591, Test loss: 0.849, Test accuracy: 69.23
Round  32, Global train loss: 0.591, Global test loss: 1.304, Global test accuracy: 57.17
Round  33, Train loss: 0.710, Test loss: 0.844, Test accuracy: 69.29
Round  33, Global train loss: 0.710, Global test loss: 1.186, Global test accuracy: 57.11
Round  34, Train loss: 0.673, Test loss: 0.856, Test accuracy: 69.29
Round  34, Global train loss: 0.673, Global test loss: 1.171, Global test accuracy: 58.78
Round  35, Train loss: 0.621, Test loss: 0.839, Test accuracy: 70.04
Round  35, Global train loss: 0.621, Global test loss: 1.114, Global test accuracy: 61.99
Round  36, Train loss: 0.561, Test loss: 0.844, Test accuracy: 70.13
Round  36, Global train loss: 0.561, Global test loss: 1.253, Global test accuracy: 57.86
Round  37, Train loss: 0.553, Test loss: 0.826, Test accuracy: 70.96
Round  37, Global train loss: 0.553, Global test loss: 1.355, Global test accuracy: 54.86
Round  38, Train loss: 0.565, Test loss: 0.818, Test accuracy: 71.00
Round  38, Global train loss: 0.565, Global test loss: 1.280, Global test accuracy: 58.69
Round  39, Train loss: 0.596, Test loss: 0.826, Test accuracy: 70.69
Round  39, Global train loss: 0.596, Global test loss: 1.329, Global test accuracy: 55.31
Round  40, Train loss: 0.555, Test loss: 0.833, Test accuracy: 70.94
Round  40, Global train loss: 0.555, Global test loss: 1.218, Global test accuracy: 59.36
Round  41, Train loss: 0.536, Test loss: 0.843, Test accuracy: 70.69
Round  41, Global train loss: 0.536, Global test loss: 1.162, Global test accuracy: 60.15
Round  42, Train loss: 0.604, Test loss: 0.840, Test accuracy: 70.72
Round  42, Global train loss: 0.604, Global test loss: 1.205, Global test accuracy: 57.89
Round  43, Train loss: 0.490, Test loss: 0.840, Test accuracy: 70.67
Round  43, Global train loss: 0.490, Global test loss: 1.164, Global test accuracy: 60.57
Round  44, Train loss: 0.519, Test loss: 0.825, Test accuracy: 71.31
Round  44, Global train loss: 0.519, Global test loss: 1.324, Global test accuracy: 56.97
Round  45, Train loss: 0.520, Test loss: 0.831, Test accuracy: 71.62
Round  45, Global train loss: 0.520, Global test loss: 1.115, Global test accuracy: 62.19
Round  46, Train loss: 0.504, Test loss: 0.828, Test accuracy: 71.73
Round  46, Global train loss: 0.504, Global test loss: 1.081, Global test accuracy: 63.16
Round  47, Train loss: 0.502, Test loss: 0.843, Test accuracy: 71.55
Round  47, Global train loss: 0.502, Global test loss: 1.302, Global test accuracy: 59.07
Round  48, Train loss: 0.490, Test loss: 0.841, Test accuracy: 71.58
Round  48, Global train loss: 0.490, Global test loss: 1.299, Global test accuracy: 59.78
Round  49, Train loss: 0.432, Test loss: 0.826, Test accuracy: 72.36
Round  49, Global train loss: 0.432, Global test loss: 1.299, Global test accuracy: 58.96
Round  50, Train loss: 0.478, Test loss: 0.811, Test accuracy: 72.97
Round  50, Global train loss: 0.478, Global test loss: 1.247, Global test accuracy: 57.54
Round  51, Train loss: 0.563, Test loss: 0.815, Test accuracy: 72.96
Round  51, Global train loss: 0.563, Global test loss: 1.204, Global test accuracy: 60.26
Round  52, Train loss: 0.486, Test loss: 0.808, Test accuracy: 72.88
Round  52, Global train loss: 0.486, Global test loss: 1.159, Global test accuracy: 61.49
Round  53, Train loss: 0.446, Test loss: 0.801, Test accuracy: 72.53
Round  53, Global train loss: 0.446, Global test loss: 1.251, Global test accuracy: 59.27
Round  54, Train loss: 0.422, Test loss: 0.813, Test accuracy: 72.45
Round  54, Global train loss: 0.422, Global test loss: 1.251, Global test accuracy: 60.24
Round  55, Train loss: 0.446, Test loss: 0.814, Test accuracy: 72.76
Round  55, Global train loss: 0.446, Global test loss: 1.211, Global test accuracy: 60.99
Round  56, Train loss: 0.438, Test loss: 0.815, Test accuracy: 72.76
Round  56, Global train loss: 0.438, Global test loss: 1.490, Global test accuracy: 55.44
Round  57, Train loss: 0.461, Test loss: 0.830, Test accuracy: 72.60
Round  57, Global train loss: 0.461, Global test loss: 1.168, Global test accuracy: 62.09
Round  58, Train loss: 0.476, Test loss: 0.825, Test accuracy: 73.19
Round  58, Global train loss: 0.476, Global test loss: 1.210, Global test accuracy: 59.50
Round  59, Train loss: 0.440, Test loss: 0.815, Test accuracy: 73.52
Round  59, Global train loss: 0.440, Global test loss: 1.248, Global test accuracy: 60.74
Round  60, Train loss: 0.469, Test loss: 0.819, Test accuracy: 73.04
Round  60, Global train loss: 0.469, Global test loss: 1.089, Global test accuracy: 63.70
Round  61, Train loss: 0.466, Test loss: 0.822, Test accuracy: 72.81
Round  61, Global train loss: 0.466, Global test loss: 1.224, Global test accuracy: 60.91
Round  62, Train loss: 0.406, Test loss: 0.839, Test accuracy: 73.10
Round  62, Global train loss: 0.406, Global test loss: 1.214, Global test accuracy: 61.93
Round  63, Train loss: 0.372, Test loss: 0.839, Test accuracy: 72.98
Round  63, Global train loss: 0.372, Global test loss: 1.292, Global test accuracy: 62.16
Round  64, Train loss: 0.405, Test loss: 0.844, Test accuracy: 72.83
Round  64, Global train loss: 0.405, Global test loss: 1.187, Global test accuracy: 63.08
Round  65, Train loss: 0.387, Test loss: 0.848, Test accuracy: 72.96
Round  65, Global train loss: 0.387, Global test loss: 1.263, Global test accuracy: 60.17
Round  66, Train loss: 0.443, Test loss: 0.863, Test accuracy: 72.76
Round  66, Global train loss: 0.443, Global test loss: 1.273, Global test accuracy: 60.33
Round  67, Train loss: 0.428, Test loss: 0.838, Test accuracy: 73.34
Round  67, Global train loss: 0.428, Global test loss: 1.115, Global test accuracy: 63.03
Round  68, Train loss: 0.414, Test loss: 0.847, Test accuracy: 73.36
Round  68, Global train loss: 0.414, Global test loss: 1.173, Global test accuracy: 62.41
Round  69, Train loss: 0.387, Test loss: 0.874, Test accuracy: 73.09
Round  69, Global train loss: 0.387, Global test loss: 1.153, Global test accuracy: 63.66
Round  70, Train loss: 0.418, Test loss: 0.881, Test accuracy: 72.87
Round  70, Global train loss: 0.418, Global test loss: 1.334, Global test accuracy: 59.66
Round  71, Train loss: 0.353, Test loss: 0.876, Test accuracy: 72.80
Round  71, Global train loss: 0.353, Global test loss: 1.425, Global test accuracy: 58.64
Round  72, Train loss: 0.418, Test loss: 0.881, Test accuracy: 72.94
Round  72, Global train loss: 0.418, Global test loss: 1.297, Global test accuracy: 61.24
Round  73, Train loss: 0.342, Test loss: 0.882, Test accuracy: 72.88
Round  73, Global train loss: 0.342, Global test loss: 1.415, Global test accuracy: 60.68
Round  74, Train loss: 0.357, Test loss: 0.886, Test accuracy: 73.02
Round  74, Global train loss: 0.357, Global test loss: 1.275, Global test accuracy: 62.61
Round  75, Train loss: 0.348, Test loss: 0.874, Test accuracy: 73.60
Round  75, Global train loss: 0.348, Global test loss: 1.144, Global test accuracy: 64.35
Round  76, Train loss: 0.375, Test loss: 0.867, Test accuracy: 73.83
Round  76, Global train loss: 0.375, Global test loss: 1.280, Global test accuracy: 62.02
Round  77, Train loss: 0.362, Test loss: 0.867, Test accuracy: 73.98
Round  77, Global train loss: 0.362, Global test loss: 1.261, Global test accuracy: 61.81
Round  78, Train loss: 0.407, Test loss: 0.840, Test accuracy: 74.68
Round  78, Global train loss: 0.407, Global test loss: 1.126, Global test accuracy: 64.03
Round  79, Train loss: 0.334, Test loss: 0.846, Test accuracy: 74.28
Round  79, Global train loss: 0.334, Global test loss: 1.196, Global test accuracy: 63.86
Round  80, Train loss: 0.350, Test loss: 0.847, Test accuracy: 74.38
Round  80, Global train loss: 0.350, Global test loss: 1.185, Global test accuracy: 63.41
Round  81, Train loss: 0.395, Test loss: 0.842, Test accuracy: 74.79
Round  81, Global train loss: 0.395, Global test loss: 1.144, Global test accuracy: 64.26
Round  82, Train loss: 0.414, Test loss: 0.849, Test accuracy: 74.47
Round  82, Global train loss: 0.414, Global test loss: 1.301, Global test accuracy: 61.85
Round  83, Train loss: 0.330, Test loss: 0.866, Test accuracy: 74.29
Round  83, Global train loss: 0.330, Global test loss: 1.203, Global test accuracy: 62.36
Round  84, Train loss: 0.338, Test loss: 0.870, Test accuracy: 74.59
Round  84, Global train loss: 0.338, Global test loss: 1.227, Global test accuracy: 61.90
Round  85, Train loss: 0.325, Test loss: 0.867, Test accuracy: 74.62
Round  85, Global train loss: 0.325, Global test loss: 1.127, Global test accuracy: 65.08
Round  86, Train loss: 0.315, Test loss: 0.867, Test accuracy: 74.80
Round  86, Global train loss: 0.315, Global test loss: 1.141, Global test accuracy: 64.82
Round  87, Train loss: 0.341, Test loss: 0.879, Test accuracy: 74.58
Round  87, Global train loss: 0.341, Global test loss: 1.150, Global test accuracy: 64.00
Round  88, Train loss: 0.348, Test loss: 0.892, Test accuracy: 74.28
Round  88, Global train loss: 0.348, Global test loss: 1.319, Global test accuracy: 62.33
Round  89, Train loss: 0.297, Test loss: 0.885, Test accuracy: 74.38
Round  89, Global train loss: 0.297, Global test loss: 1.613, Global test accuracy: 59.02
Round  90, Train loss: 0.331, Test loss: 0.891, Test accuracy: 74.25
Round  90, Global train loss: 0.331, Global test loss: 1.110, Global test accuracy: 65.78
Round  91, Train loss: 0.304, Test loss: 0.912, Test accuracy: 74.00
Round  91, Global train loss: 0.304, Global test loss: 1.257, Global test accuracy: 62.82
Round  92, Train loss: 0.312, Test loss: 0.906, Test accuracy: 74.31
Round  92, Global train loss: 0.312, Global test loss: 1.235, Global test accuracy: 61.51
Round  93, Train loss: 0.305, Test loss: 0.903, Test accuracy: 74.36
Round  93, Global train loss: 0.305, Global test loss: 1.185, Global test accuracy: 64.84
Round  94, Train loss: 0.323, Test loss: 0.883, Test accuracy: 74.57
Round  94, Global train loss: 0.323, Global test loss: 1.407, Global test accuracy: 61.13
Round  95, Train loss: 0.267, Test loss: 0.890, Test accuracy: 74.42
Round  95, Global train loss: 0.267, Global test loss: 1.278, Global test accuracy: 63.28
Round  96, Train loss: 0.360, Test loss: 0.895, Test accuracy: 74.50
Round  96, Global train loss: 0.360, Global test loss: 1.236, Global test accuracy: 63.21
Round  97, Train loss: 0.293, Test loss: 0.884, Test accuracy: 74.61
Round  97, Global train loss: 0.293, Global test loss: 1.437, Global test accuracy: 59.64
Round  98, Train loss: 0.311, Test loss: 0.884, Test accuracy: 74.92
Round  98, Global train loss: 0.311, Global test loss: 1.173, Global test accuracy: 65.16
Round  99, Train loss: 0.297, Test loss: 0.889, Test accuracy: 74.69
Round  99, Global train loss: 0.297, Global test loss: 1.186, Global test accuracy: 65.16
Final Round, Train loss: 0.235, Test loss: 1.009, Test accuracy: 73.90
Final Round, Global train loss: 0.235, Global test loss: 1.186, Global test accuracy: 65.16
Average accuracy final 10 rounds: 74.463 

Average global accuracy final 10 rounds: 63.25299999999999 

1278.0972390174866
[1.3638696670532227, 2.7277393341064453, 3.8487584590911865, 4.969777584075928, 6.093372344970703, 7.2169671058654785, 8.339543581008911, 9.462120056152344, 10.583521842956543, 11.704923629760742, 12.832383871078491, 13.95984411239624, 15.080057621002197, 16.200271129608154, 17.317532777786255, 18.434794425964355, 19.55116629600525, 20.667538166046143, 21.78885006904602, 22.9101619720459, 24.034551858901978, 25.158941745758057, 26.28298568725586, 27.407029628753662, 28.525370836257935, 29.643712043762207, 30.764439344406128, 31.88516664505005, 32.99937152862549, 34.11357641220093, 35.07625865936279, 36.03894090652466, 36.99899435043335, 37.95904779434204, 38.915934562683105, 39.87282133102417, 40.836238622665405, 41.79965591430664, 42.76586389541626, 43.73207187652588, 44.70218563079834, 45.6722993850708, 46.63645911216736, 47.600618839263916, 48.55902934074402, 49.51743984222412, 50.4767689704895, 51.43609809875488, 52.39415264129639, 53.35220718383789, 54.317633390426636, 55.28305959701538, 56.2512788772583, 57.21949815750122, 58.17823672294617, 59.13697528839111, 60.1017427444458, 61.06651020050049, 62.03372526168823, 63.00094032287598, 63.96984386444092, 64.93874740600586, 65.90257430076599, 66.86640119552612, 67.82330751419067, 68.78021383285522, 69.7436830997467, 70.70715236663818, 71.66555690765381, 72.62396144866943, 73.58315253257751, 74.5423436164856, 75.49886655807495, 76.4553894996643, 77.41227531433105, 78.3691611289978, 79.32616472244263, 80.28316831588745, 81.24022960662842, 82.19729089736938, 83.15629267692566, 84.11529445648193, 85.07350420951843, 86.03171396255493, 86.99610614776611, 87.9604983329773, 88.92572903633118, 89.89095973968506, 90.85667967796326, 91.82239961624146, 92.78938245773315, 93.75636529922485, 94.72486901283264, 95.69337272644043, 96.65607261657715, 97.61877250671387, 98.588707447052, 99.55864238739014, 100.52401304244995, 101.48938369750977, 102.4619369506836, 103.43449020385742, 104.4046688079834, 105.37484741210938, 106.3408567905426, 107.30686616897583, 108.2721917629242, 109.23751735687256, 110.20418691635132, 111.17085647583008, 112.13579630851746, 113.10073614120483, 114.06655621528625, 115.03237628936768, 115.99803185462952, 116.96368741989136, 117.92065405845642, 118.87762069702148, 119.84107899665833, 120.80453729629517, 121.76570272445679, 122.72686815261841, 123.696706533432, 124.6665449142456, 125.63414740562439, 126.60174989700317, 127.55821180343628, 128.51467370986938, 129.47204899787903, 130.42942428588867, 131.3862898349762, 132.34315538406372, 133.30044174194336, 134.257728099823, 135.21708416938782, 136.17644023895264, 137.14099287986755, 138.10554552078247, 139.06478095054626, 140.02401638031006, 140.98877263069153, 141.953528881073, 142.9214370250702, 143.88934516906738, 144.8476414680481, 145.8059377670288, 146.76712489128113, 147.72831201553345, 148.68809628486633, 149.64788055419922, 150.6137707233429, 151.57966089248657, 152.53741645812988, 153.4951720237732, 154.46366596221924, 155.43215990066528, 156.39658427238464, 157.361008644104, 158.32743549346924, 159.29386234283447, 160.2588038444519, 161.22374534606934, 162.19170880317688, 163.15967226028442, 164.1272006034851, 165.0947289466858, 166.06788086891174, 167.0410327911377, 168.00816321372986, 168.97529363632202, 169.93150424957275, 170.8877148628235, 171.85324263572693, 172.81877040863037, 173.78550338745117, 174.75223636627197, 175.71831631660461, 176.68439626693726, 177.64958500862122, 178.61477375030518, 179.57995319366455, 180.54513263702393, 181.51300239562988, 182.48087215423584, 183.43661451339722, 184.3923568725586, 185.35202145576477, 186.31168603897095, 187.2723639011383, 188.23304176330566, 189.19926857948303, 190.1654953956604, 191.1370189189911, 192.10854244232178, 193.066899061203, 194.02525568008423, 194.9826476573944, 195.9400396347046, 196.90101313591003, 197.86198663711548, 199.7900710105896, 201.71815538406372]
[25.55, 25.55, 32.28, 32.28, 37.06, 37.06, 42.98, 42.98, 46.19, 46.19, 48.93, 48.93, 50.5, 50.5, 54.08, 54.08, 58.44, 58.44, 58.39, 58.39, 59.09, 59.09, 60.28, 60.28, 60.65, 60.65, 62.34, 62.34, 62.49, 62.49, 63.32, 63.32, 62.99, 62.99, 63.8, 63.8, 65.96, 65.96, 66.31, 66.31, 66.15, 66.15, 66.74, 66.74, 67.33, 67.33, 67.93, 67.93, 68.2, 68.2, 69.32, 69.32, 69.16, 69.16, 69.52, 69.52, 69.47, 69.47, 69.75, 69.75, 69.58, 69.58, 69.78, 69.78, 69.23, 69.23, 69.29, 69.29, 69.29, 69.29, 70.04, 70.04, 70.13, 70.13, 70.96, 70.96, 71.0, 71.0, 70.69, 70.69, 70.94, 70.94, 70.69, 70.69, 70.72, 70.72, 70.67, 70.67, 71.31, 71.31, 71.62, 71.62, 71.73, 71.73, 71.55, 71.55, 71.58, 71.58, 72.36, 72.36, 72.97, 72.97, 72.96, 72.96, 72.88, 72.88, 72.53, 72.53, 72.45, 72.45, 72.76, 72.76, 72.76, 72.76, 72.6, 72.6, 73.19, 73.19, 73.52, 73.52, 73.04, 73.04, 72.81, 72.81, 73.1, 73.1, 72.98, 72.98, 72.83, 72.83, 72.96, 72.96, 72.76, 72.76, 73.34, 73.34, 73.36, 73.36, 73.09, 73.09, 72.87, 72.87, 72.8, 72.8, 72.94, 72.94, 72.88, 72.88, 73.02, 73.02, 73.6, 73.6, 73.83, 73.83, 73.98, 73.98, 74.68, 74.68, 74.28, 74.28, 74.38, 74.38, 74.79, 74.79, 74.47, 74.47, 74.29, 74.29, 74.59, 74.59, 74.62, 74.62, 74.8, 74.8, 74.58, 74.58, 74.28, 74.28, 74.38, 74.38, 74.25, 74.25, 74.0, 74.0, 74.31, 74.31, 74.36, 74.36, 74.57, 74.57, 74.42, 74.42, 74.5, 74.5, 74.61, 74.61, 74.92, 74.92, 74.69, 74.69, 73.9, 73.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.625, Test loss: 2.048, Test accuracy: 24.03
Round   0, Global train loss: 1.625, Global test loss: 2.248, Global test accuracy: 21.11
Round   1, Train loss: 1.471, Test loss: 1.695, Test accuracy: 34.00
Round   1, Global train loss: 1.471, Global test loss: 2.060, Global test accuracy: 25.95
Round   2, Train loss: 1.362, Test loss: 1.542, Test accuracy: 38.84
Round   2, Global train loss: 1.362, Global test loss: 2.055, Global test accuracy: 25.50
Round   3, Train loss: 1.278, Test loss: 1.415, Test accuracy: 43.58
Round   3, Global train loss: 1.278, Global test loss: 1.859, Global test accuracy: 30.96
Round   4, Train loss: 1.174, Test loss: 1.321, Test accuracy: 47.30
Round   4, Global train loss: 1.174, Global test loss: 1.772, Global test accuracy: 35.36
Round   5, Train loss: 1.150, Test loss: 1.271, Test accuracy: 49.70
Round   5, Global train loss: 1.150, Global test loss: 1.763, Global test accuracy: 36.04
Round   6, Train loss: 1.121, Test loss: 1.211, Test accuracy: 51.75
Round   6, Global train loss: 1.121, Global test loss: 1.945, Global test accuracy: 33.85
Round   7, Train loss: 1.110, Test loss: 1.133, Test accuracy: 54.45
Round   7, Global train loss: 1.110, Global test loss: 1.732, Global test accuracy: 38.82
Round   8, Train loss: 1.061, Test loss: 1.098, Test accuracy: 55.95
Round   8, Global train loss: 1.061, Global test loss: 1.571, Global test accuracy: 43.35
Round   9, Train loss: 1.046, Test loss: 1.083, Test accuracy: 56.49
Round   9, Global train loss: 1.046, Global test loss: 1.530, Global test accuracy: 44.41
Round  10, Train loss: 1.023, Test loss: 1.044, Test accuracy: 58.21
Round  10, Global train loss: 1.023, Global test loss: 1.627, Global test accuracy: 40.18
Round  11, Train loss: 1.000, Test loss: 1.017, Test accuracy: 59.55
Round  11, Global train loss: 1.000, Global test loss: 1.698, Global test accuracy: 40.61
Round  12, Train loss: 1.007, Test loss: 1.005, Test accuracy: 59.95
Round  12, Global train loss: 1.007, Global test loss: 1.612, Global test accuracy: 43.85
Round  13, Train loss: 1.010, Test loss: 1.001, Test accuracy: 60.11
Round  13, Global train loss: 1.010, Global test loss: 1.482, Global test accuracy: 45.59
Round  14, Train loss: 0.933, Test loss: 0.981, Test accuracy: 61.26
Round  14, Global train loss: 0.933, Global test loss: 1.460, Global test accuracy: 47.31
Round  15, Train loss: 0.947, Test loss: 0.973, Test accuracy: 61.56
Round  15, Global train loss: 0.947, Global test loss: 1.550, Global test accuracy: 42.57
Round  16, Train loss: 0.915, Test loss: 0.956, Test accuracy: 62.77
Round  16, Global train loss: 0.915, Global test loss: 1.481, Global test accuracy: 43.99
Round  17, Train loss: 0.842, Test loss: 0.964, Test accuracy: 62.50
Round  17, Global train loss: 0.842, Global test loss: 1.357, Global test accuracy: 51.24
Round  18, Train loss: 0.867, Test loss: 0.932, Test accuracy: 64.07
Round  18, Global train loss: 0.867, Global test loss: 1.521, Global test accuracy: 46.78
Round  19, Train loss: 0.864, Test loss: 0.918, Test accuracy: 64.48
Round  19, Global train loss: 0.864, Global test loss: 1.323, Global test accuracy: 52.60
Round  20, Train loss: 0.898, Test loss: 0.905, Test accuracy: 64.87
Round  20, Global train loss: 0.898, Global test loss: 1.512, Global test accuracy: 45.87
Round  21, Train loss: 0.796, Test loss: 0.909, Test accuracy: 64.83
Round  21, Global train loss: 0.796, Global test loss: 1.721, Global test accuracy: 40.90
Round  22, Train loss: 0.833, Test loss: 0.899, Test accuracy: 65.25
Round  22, Global train loss: 0.833, Global test loss: 1.326, Global test accuracy: 51.54
Round  23, Train loss: 0.847, Test loss: 0.874, Test accuracy: 66.34
Round  23, Global train loss: 0.847, Global test loss: 1.349, Global test accuracy: 51.32
Round  24, Train loss: 0.795, Test loss: 0.873, Test accuracy: 66.32
Round  24, Global train loss: 0.795, Global test loss: 1.490, Global test accuracy: 47.93
Round  25, Train loss: 0.810, Test loss: 0.870, Test accuracy: 67.00
Round  25, Global train loss: 0.810, Global test loss: 1.254, Global test accuracy: 55.33
Round  26, Train loss: 0.725, Test loss: 0.853, Test accuracy: 67.36
Round  26, Global train loss: 0.725, Global test loss: 1.224, Global test accuracy: 57.62
Round  27, Train loss: 0.815, Test loss: 0.851, Test accuracy: 67.33
Round  27, Global train loss: 0.815, Global test loss: 1.295, Global test accuracy: 53.04
Round  28, Train loss: 0.790, Test loss: 0.880, Test accuracy: 66.32
Round  28, Global train loss: 0.790, Global test loss: 1.219, Global test accuracy: 56.17
Round  29, Train loss: 0.783, Test loss: 0.881, Test accuracy: 66.45
Round  29, Global train loss: 0.783, Global test loss: 1.253, Global test accuracy: 54.51
Round  30, Train loss: 0.716, Test loss: 0.858, Test accuracy: 67.58
Round  30, Global train loss: 0.716, Global test loss: 1.373, Global test accuracy: 51.27
Round  31, Train loss: 0.690, Test loss: 0.847, Test accuracy: 67.57
Round  31, Global train loss: 0.690, Global test loss: 1.281, Global test accuracy: 54.82
Round  32, Train loss: 0.689, Test loss: 0.847, Test accuracy: 68.06
Round  32, Global train loss: 0.689, Global test loss: 1.222, Global test accuracy: 54.75
Round  33, Train loss: 0.650, Test loss: 0.851, Test accuracy: 68.28
Round  33, Global train loss: 0.650, Global test loss: 1.366, Global test accuracy: 53.80
Round  34, Train loss: 0.745, Test loss: 0.860, Test accuracy: 68.13
Round  34, Global train loss: 0.745, Global test loss: 1.273, Global test accuracy: 53.91
Round  35, Train loss: 0.664, Test loss: 0.844, Test accuracy: 68.84
Round  35, Global train loss: 0.664, Global test loss: 1.242, Global test accuracy: 57.39
Round  36, Train loss: 0.644, Test loss: 0.819, Test accuracy: 69.27
Round  36, Global train loss: 0.644, Global test loss: 1.241, Global test accuracy: 55.76
Round  37, Train loss: 0.624, Test loss: 0.812, Test accuracy: 69.59
Round  37, Global train loss: 0.624, Global test loss: 1.141, Global test accuracy: 59.27
Round  38, Train loss: 0.678, Test loss: 0.804, Test accuracy: 69.81
Round  38, Global train loss: 0.678, Global test loss: 1.142, Global test accuracy: 59.24
Round  39, Train loss: 0.610, Test loss: 0.795, Test accuracy: 69.97
Round  39, Global train loss: 0.610, Global test loss: 1.248, Global test accuracy: 57.72
Round  40, Train loss: 0.594, Test loss: 0.804, Test accuracy: 70.33
Round  40, Global train loss: 0.594, Global test loss: 1.311, Global test accuracy: 55.88
Round  41, Train loss: 0.673, Test loss: 0.798, Test accuracy: 70.88
Round  41, Global train loss: 0.673, Global test loss: 1.094, Global test accuracy: 61.33
Round  42, Train loss: 0.616, Test loss: 0.808, Test accuracy: 70.48
Round  42, Global train loss: 0.616, Global test loss: 1.391, Global test accuracy: 54.15
Round  43, Train loss: 0.578, Test loss: 0.811, Test accuracy: 70.19
Round  43, Global train loss: 0.578, Global test loss: 1.281, Global test accuracy: 56.84
Round  44, Train loss: 0.615, Test loss: 0.803, Test accuracy: 70.61
Round  44, Global train loss: 0.615, Global test loss: 1.143, Global test accuracy: 59.25
Round  45, Train loss: 0.546, Test loss: 0.804, Test accuracy: 71.03
Round  45, Global train loss: 0.546, Global test loss: 1.223, Global test accuracy: 58.42
Round  46, Train loss: 0.597, Test loss: 0.815, Test accuracy: 70.26
Round  46, Global train loss: 0.597, Global test loss: 1.128, Global test accuracy: 60.68
Round  47, Train loss: 0.565, Test loss: 0.806, Test accuracy: 70.73
Round  47, Global train loss: 0.565, Global test loss: 1.162, Global test accuracy: 59.49
Round  48, Train loss: 0.531, Test loss: 0.823, Test accuracy: 70.25
Round  48, Global train loss: 0.531, Global test loss: 1.206, Global test accuracy: 58.90
Round  49, Train loss: 0.589, Test loss: 0.802, Test accuracy: 70.79
Round  49, Global train loss: 0.589, Global test loss: 1.188, Global test accuracy: 60.22
Round  50, Train loss: 0.508, Test loss: 0.811, Test accuracy: 70.86
Round  50, Global train loss: 0.508, Global test loss: 1.378, Global test accuracy: 58.24
Round  51, Train loss: 0.492, Test loss: 0.815, Test accuracy: 70.68
Round  51, Global train loss: 0.492, Global test loss: 1.182, Global test accuracy: 59.70
Round  52, Train loss: 0.615, Test loss: 0.823, Test accuracy: 70.89
Round  52, Global train loss: 0.615, Global test loss: 1.250, Global test accuracy: 59.00
Round  53, Train loss: 0.542, Test loss: 0.811, Test accuracy: 71.55
Round  53, Global train loss: 0.542, Global test loss: 1.224, Global test accuracy: 59.85
Round  54, Train loss: 0.505, Test loss: 0.792, Test accuracy: 72.21
Round  54, Global train loss: 0.505, Global test loss: 1.198, Global test accuracy: 60.68
Round  55, Train loss: 0.487, Test loss: 0.808, Test accuracy: 71.96
Round  55, Global train loss: 0.487, Global test loss: 1.152, Global test accuracy: 60.65
Round  56, Train loss: 0.496, Test loss: 0.818, Test accuracy: 71.84
Round  56, Global train loss: 0.496, Global test loss: 1.320, Global test accuracy: 56.30
Round  57, Train loss: 0.522, Test loss: 0.833, Test accuracy: 71.63
Round  57, Global train loss: 0.522, Global test loss: 1.179, Global test accuracy: 60.64
Round  58, Train loss: 0.445, Test loss: 0.820, Test accuracy: 71.84
Round  58, Global train loss: 0.445, Global test loss: 1.238, Global test accuracy: 60.26
Round  59, Train loss: 0.520, Test loss: 0.823, Test accuracy: 71.67
Round  59, Global train loss: 0.520, Global test loss: 1.240, Global test accuracy: 58.37
Round  60, Train loss: 0.446, Test loss: 0.838, Test accuracy: 71.24
Round  60, Global train loss: 0.446, Global test loss: 1.163, Global test accuracy: 60.54
Round  61, Train loss: 0.450, Test loss: 0.833, Test accuracy: 71.70
Round  61, Global train loss: 0.450, Global test loss: 1.155, Global test accuracy: 61.49
Round  62, Train loss: 0.467, Test loss: 0.853, Test accuracy: 71.27
Round  62, Global train loss: 0.467, Global test loss: 1.165, Global test accuracy: 61.70
Round  63, Train loss: 0.512, Test loss: 0.833, Test accuracy: 72.17
Round  63, Global train loss: 0.512, Global test loss: 1.173, Global test accuracy: 61.31
Round  64, Train loss: 0.432, Test loss: 0.829, Test accuracy: 72.30
Round  64, Global train loss: 0.432, Global test loss: 1.253, Global test accuracy: 59.85
Round  65, Train loss: 0.392, Test loss: 0.822, Test accuracy: 72.52
Round  65, Global train loss: 0.392, Global test loss: 1.288, Global test accuracy: 59.47
Round  66, Train loss: 0.497, Test loss: 0.813, Test accuracy: 72.83
Round  66, Global train loss: 0.497, Global test loss: 1.065, Global test accuracy: 63.84
Round  67, Train loss: 0.439, Test loss: 0.832, Test accuracy: 72.43
Round  67, Global train loss: 0.439, Global test loss: 1.248, Global test accuracy: 59.80
Round  68, Train loss: 0.426, Test loss: 0.848, Test accuracy: 72.09
Round  68, Global train loss: 0.426, Global test loss: 1.186, Global test accuracy: 61.48
Round  69, Train loss: 0.432, Test loss: 0.847, Test accuracy: 72.16
Round  69, Global train loss: 0.432, Global test loss: 1.193, Global test accuracy: 62.04
Round  70, Train loss: 0.379, Test loss: 0.826, Test accuracy: 72.75
Round  70, Global train loss: 0.379, Global test loss: 1.145, Global test accuracy: 62.51
Round  71, Train loss: 0.460, Test loss: 0.813, Test accuracy: 72.90
Round  71, Global train loss: 0.460, Global test loss: 1.131, Global test accuracy: 62.56
Round  72, Train loss: 0.484, Test loss: 0.805, Test accuracy: 73.13
Round  72, Global train loss: 0.484, Global test loss: 1.106, Global test accuracy: 62.41
Round  73, Train loss: 0.435, Test loss: 0.802, Test accuracy: 73.36
Round  73, Global train loss: 0.435, Global test loss: 1.209, Global test accuracy: 61.32
Round  74, Train loss: 0.447, Test loss: 0.816, Test accuracy: 73.32
Round  74, Global train loss: 0.447, Global test loss: 1.057, Global test accuracy: 64.02
Round  75, Train loss: 0.417, Test loss: 0.799, Test accuracy: 73.76
Round  75, Global train loss: 0.417, Global test loss: 1.281, Global test accuracy: 59.97
Round  76, Train loss: 0.387, Test loss: 0.834, Test accuracy: 73.13
Round  76, Global train loss: 0.387, Global test loss: 1.284, Global test accuracy: 60.00
Round  77, Train loss: 0.383, Test loss: 0.812, Test accuracy: 73.48
Round  77, Global train loss: 0.383, Global test loss: 1.130, Global test accuracy: 64.58
Round  78, Train loss: 0.411, Test loss: 0.822, Test accuracy: 73.60
Round  78, Global train loss: 0.411, Global test loss: 1.383, Global test accuracy: 60.12
Round  79, Train loss: 0.440, Test loss: 0.809, Test accuracy: 73.83
Round  79, Global train loss: 0.440, Global test loss: 1.374, Global test accuracy: 57.28
Round  80, Train loss: 0.401, Test loss: 0.818, Test accuracy: 73.65
Round  80, Global train loss: 0.401, Global test loss: 1.200, Global test accuracy: 62.13
Round  81, Train loss: 0.439, Test loss: 0.829, Test accuracy: 73.88
Round  81, Global train loss: 0.439, Global test loss: 1.086, Global test accuracy: 64.09
Round  82, Train loss: 0.391, Test loss: 0.829, Test accuracy: 74.22
Round  82, Global train loss: 0.391, Global test loss: 1.239, Global test accuracy: 61.88
Round  83, Train loss: 0.396, Test loss: 0.865, Test accuracy: 73.40
Round  83, Global train loss: 0.396, Global test loss: 1.097, Global test accuracy: 64.38
Round  84, Train loss: 0.391, Test loss: 0.861, Test accuracy: 73.52
Round  84, Global train loss: 0.391, Global test loss: 1.095, Global test accuracy: 64.13
Round  85, Train loss: 0.405, Test loss: 0.873, Test accuracy: 73.28
Round  85, Global train loss: 0.405, Global test loss: 1.061, Global test accuracy: 64.59
Round  86, Train loss: 0.451, Test loss: 0.861, Test accuracy: 73.83
Round  86, Global train loss: 0.451, Global test loss: 1.223, Global test accuracy: 62.32
Round  87, Train loss: 0.388, Test loss: 0.864, Test accuracy: 73.93
Round  87, Global train loss: 0.388, Global test loss: 1.143, Global test accuracy: 63.61
Round  88, Train loss: 0.421, Test loss: 0.851, Test accuracy: 73.89
Round  88, Global train loss: 0.421, Global test loss: 1.197, Global test accuracy: 61.98
Round  89, Train loss: 0.378, Test loss: 0.842, Test accuracy: 73.97
Round  89, Global train loss: 0.378, Global test loss: 1.133, Global test accuracy: 64.12
Round  90, Train loss: 0.384, Test loss: 0.849, Test accuracy: 73.78
Round  90, Global train loss: 0.384, Global test loss: 1.103, Global test accuracy: 64.47
Round  91, Train loss: 0.381, Test loss: 0.834, Test accuracy: 73.86
Round  91, Global train loss: 0.381, Global test loss: 1.133, Global test accuracy: 63.76
Round  92, Train loss: 0.377, Test loss: 0.843, Test accuracy: 74.06
Round  92, Global train loss: 0.377, Global test loss: 1.155, Global test accuracy: 62.95
Round  93, Train loss: 0.351, Test loss: 0.838, Test accuracy: 74.37
Round  93, Global train loss: 0.351, Global test loss: 1.211, Global test accuracy: 63.35
Round  94, Train loss: 0.361, Test loss: 0.853, Test accuracy: 74.09
Round  94, Global train loss: 0.361, Global test loss: 1.182, Global test accuracy: 62.68
Round  95, Train loss: 0.362, Test loss: 0.880, Test accuracy: 73.46
Round  95, Global train loss: 0.362, Global test loss: 1.091, Global test accuracy: 64.68/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 0.365, Test loss: 0.894, Test accuracy: 73.15
Round  96, Global train loss: 0.365, Global test loss: 1.351, Global test accuracy: 60.09
Round  97, Train loss: 0.373, Test loss: 0.876, Test accuracy: 73.54
Round  97, Global train loss: 0.373, Global test loss: 1.282, Global test accuracy: 61.70
Round  98, Train loss: 0.383, Test loss: 0.878, Test accuracy: 73.71
Round  98, Global train loss: 0.383, Global test loss: 1.233, Global test accuracy: 62.50
Round  99, Train loss: 0.372, Test loss: 0.888, Test accuracy: 73.18
Round  99, Global train loss: 0.372, Global test loss: 1.182, Global test accuracy: 63.33
Final Round, Train loss: 0.292, Test loss: 0.882, Test accuracy: 74.78
Final Round, Global train loss: 0.292, Global test loss: 1.182, Global test accuracy: 63.33
Average accuracy final 10 rounds: 73.72 

Average global accuracy final 10 rounds: 62.95100000000001 

1320.756192445755
[1.44150710105896, 2.88301420211792, 4.083025932312012, 5.2830376625061035, 6.485673904418945, 7.688310146331787, 8.895350933074951, 10.102391719818115, 11.308781147003174, 12.515170574188232, 13.716669797897339, 14.918169021606445, 16.131397247314453, 17.34462547302246, 18.547895669937134, 19.751165866851807, 20.789047241210938, 21.82692861557007, 22.864067316055298, 23.901206016540527, 24.936851739883423, 25.97249746322632, 27.007282257080078, 28.042067050933838, 29.077824592590332, 30.113582134246826, 31.150940418243408, 32.18829870223999, 33.22480916976929, 34.261319637298584, 35.29779934883118, 36.33427906036377, 37.37152361869812, 38.40876817703247, 39.442728757858276, 40.47668933868408, 41.51243591308594, 42.54818248748779, 43.5837504863739, 44.61931848526001, 45.65627121925354, 46.69322395324707, 47.731040477752686, 48.7688570022583, 49.812216997146606, 50.85557699203491, 51.89394783973694, 52.932318687438965, 53.970547676086426, 55.00877666473389, 56.04709506034851, 57.085413455963135, 58.12284207344055, 59.16027069091797, 60.20172715187073, 61.243183612823486, 62.27795648574829, 63.312729358673096, 64.34790182113647, 65.38307428359985, 66.41986155509949, 67.45664882659912, 68.4963321685791, 69.53601551055908, 70.57174158096313, 71.60746765136719, 72.64374995231628, 73.68003225326538, 74.7170524597168, 75.75407266616821, 76.7961699962616, 77.83826732635498, 78.8776068687439, 79.91694641113281, 80.95278215408325, 81.98861789703369, 83.02587032318115, 84.06312274932861, 85.0992705821991, 86.13541841506958, 87.17044854164124, 88.20547866821289, 89.24389123916626, 90.28230381011963, 91.31971788406372, 92.35713195800781, 93.39622235298157, 94.43531274795532, 95.47339010238647, 96.51146745681763, 97.54742980003357, 98.58339214324951, 99.62063217163086, 100.6578722000122, 101.69934725761414, 102.74082231521606, 103.78061366081238, 104.82040500640869, 105.85472083091736, 106.88903665542603, 107.92311191558838, 108.95718717575073, 110.00019764900208, 111.04320812225342, 112.08190131187439, 113.12059450149536, 114.15478873252869, 115.18898296356201, 116.22538733482361, 117.2617917060852, 118.29680681228638, 119.33182191848755, 120.36788606643677, 121.40395021438599, 122.44121885299683, 123.47848749160767, 124.51397562026978, 125.54946374893188, 126.58361291885376, 127.61776208877563, 128.65485548973083, 129.69194889068604, 130.72790050506592, 131.7638521194458, 132.8001832962036, 133.83651447296143, 134.87367987632751, 135.9108452796936, 136.9494206905365, 137.9879961013794, 139.02568745613098, 140.06337881088257, 141.09969472885132, 142.13601064682007, 143.17713236808777, 144.21825408935547, 145.25574493408203, 146.2932357788086, 147.32906007766724, 148.36488437652588, 149.40220499038696, 150.43952560424805, 151.47433638572693, 152.5091471672058, 153.57775044441223, 154.64635372161865, 155.68457651138306, 156.72279930114746, 157.7576870918274, 158.79257488250732, 159.83117127418518, 160.86976766586304, 161.90487623214722, 162.9399847984314, 163.97569751739502, 165.01141023635864, 166.05220460891724, 167.09299898147583, 168.13137340545654, 169.16974782943726, 170.21767210960388, 171.2655963897705, 172.3106038570404, 173.3556113243103, 174.39542150497437, 175.43523168563843, 176.4776873588562, 177.52014303207397, 178.56243252754211, 179.60472202301025, 180.64891839027405, 181.69311475753784, 182.7336721420288, 183.77422952651978, 184.81549263000488, 185.85675573349, 186.89431953430176, 187.93188333511353, 188.96951365470886, 190.0071439743042, 191.0489308834076, 192.090717792511, 193.13936400413513, 194.18801021575928, 195.2323820590973, 196.2767539024353, 197.33012986183167, 198.38350582122803, 199.43193340301514, 200.48036098480225, 201.5257053375244, 202.57104969024658, 203.616557598114, 204.66206550598145, 205.69939756393433, 206.7367296218872, 207.77624225616455, 208.8157548904419, 209.86322259902954, 210.9106903076172, 212.9981710910797, 215.08565187454224]
[24.03, 24.03, 34.0, 34.0, 38.84, 38.84, 43.58, 43.58, 47.3, 47.3, 49.7, 49.7, 51.75, 51.75, 54.45, 54.45, 55.95, 55.95, 56.49, 56.49, 58.21, 58.21, 59.55, 59.55, 59.95, 59.95, 60.11, 60.11, 61.26, 61.26, 61.56, 61.56, 62.77, 62.77, 62.5, 62.5, 64.07, 64.07, 64.48, 64.48, 64.87, 64.87, 64.83, 64.83, 65.25, 65.25, 66.34, 66.34, 66.32, 66.32, 67.0, 67.0, 67.36, 67.36, 67.33, 67.33, 66.32, 66.32, 66.45, 66.45, 67.58, 67.58, 67.57, 67.57, 68.06, 68.06, 68.28, 68.28, 68.13, 68.13, 68.84, 68.84, 69.27, 69.27, 69.59, 69.59, 69.81, 69.81, 69.97, 69.97, 70.33, 70.33, 70.88, 70.88, 70.48, 70.48, 70.19, 70.19, 70.61, 70.61, 71.03, 71.03, 70.26, 70.26, 70.73, 70.73, 70.25, 70.25, 70.79, 70.79, 70.86, 70.86, 70.68, 70.68, 70.89, 70.89, 71.55, 71.55, 72.21, 72.21, 71.96, 71.96, 71.84, 71.84, 71.63, 71.63, 71.84, 71.84, 71.67, 71.67, 71.24, 71.24, 71.7, 71.7, 71.27, 71.27, 72.17, 72.17, 72.3, 72.3, 72.52, 72.52, 72.83, 72.83, 72.43, 72.43, 72.09, 72.09, 72.16, 72.16, 72.75, 72.75, 72.9, 72.9, 73.13, 73.13, 73.36, 73.36, 73.32, 73.32, 73.76, 73.76, 73.13, 73.13, 73.48, 73.48, 73.6, 73.6, 73.83, 73.83, 73.65, 73.65, 73.88, 73.88, 74.22, 74.22, 73.4, 73.4, 73.52, 73.52, 73.28, 73.28, 73.83, 73.83, 73.93, 73.93, 73.89, 73.89, 73.97, 73.97, 73.78, 73.78, 73.86, 73.86, 74.06, 74.06, 74.37, 74.37, 74.09, 74.09, 73.46, 73.46, 73.15, 73.15, 73.54, 73.54, 73.71, 73.71, 73.18, 73.18, 74.78, 74.78]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.613, Test loss: 2.155, Test accuracy: 23.35
Round   0, Global train loss: 1.613, Global test loss: 2.328, Global test accuracy: 20.19
Round   1, Train loss: 1.418, Test loss: 1.861, Test accuracy: 33.43
Round   1, Global train loss: 1.418, Global test loss: 2.294, Global test accuracy: 25.47
Round   2, Train loss: 1.321, Test loss: 1.624, Test accuracy: 38.69
Round   2, Global train loss: 1.321, Global test loss: 2.227, Global test accuracy: 25.64
Round   3, Train loss: 1.239, Test loss: 1.383, Test accuracy: 44.70
Round   3, Global train loss: 1.239, Global test loss: 1.890, Global test accuracy: 33.70
Round   4, Train loss: 1.185, Test loss: 1.294, Test accuracy: 47.40
Round   4, Global train loss: 1.185, Global test loss: 1.788, Global test accuracy: 36.57
Round   5, Train loss: 1.107, Test loss: 1.319, Test accuracy: 48.38
Round   5, Global train loss: 1.107, Global test loss: 2.000, Global test accuracy: 32.22
Round   6, Train loss: 1.098, Test loss: 1.227, Test accuracy: 51.52
Round   6, Global train loss: 1.098, Global test loss: 1.782, Global test accuracy: 35.51
Round   7, Train loss: 1.052, Test loss: 1.181, Test accuracy: 53.45
Round   7, Global train loss: 1.052, Global test loss: 1.761, Global test accuracy: 38.21
Round   8, Train loss: 0.991, Test loss: 1.126, Test accuracy: 55.41
Round   8, Global train loss: 0.991, Global test loss: 1.625, Global test accuracy: 41.87
Round   9, Train loss: 0.996, Test loss: 1.088, Test accuracy: 56.19
Round   9, Global train loss: 0.996, Global test loss: 1.576, Global test accuracy: 43.36
Round  10, Train loss: 0.993, Test loss: 1.052, Test accuracy: 58.58
Round  10, Global train loss: 0.993, Global test loss: 1.840, Global test accuracy: 36.41
Round  11, Train loss: 0.941, Test loss: 1.039, Test accuracy: 59.68
Round  11, Global train loss: 0.941, Global test loss: 1.650, Global test accuracy: 43.19
Round  12, Train loss: 0.931, Test loss: 1.003, Test accuracy: 61.61
Round  12, Global train loss: 0.931, Global test loss: 1.588, Global test accuracy: 43.27
Round  13, Train loss: 0.915, Test loss: 1.005, Test accuracy: 61.56
Round  13, Global train loss: 0.915, Global test loss: 1.691, Global test accuracy: 43.48
Round  14, Train loss: 0.911, Test loss: 0.958, Test accuracy: 62.97
Round  14, Global train loss: 0.911, Global test loss: 1.763, Global test accuracy: 39.97
Round  15, Train loss: 0.877, Test loss: 0.944, Test accuracy: 63.51
Round  15, Global train loss: 0.877, Global test loss: 1.516, Global test accuracy: 47.94
Round  16, Train loss: 0.870, Test loss: 0.930, Test accuracy: 64.41
Round  16, Global train loss: 0.870, Global test loss: 1.473, Global test accuracy: 46.91
Round  17, Train loss: 0.855, Test loss: 0.925, Test accuracy: 64.28
Round  17, Global train loss: 0.855, Global test loss: 1.381, Global test accuracy: 49.63
Round  18, Train loss: 0.764, Test loss: 0.921, Test accuracy: 64.77
Round  18, Global train loss: 0.764, Global test loss: 1.499, Global test accuracy: 48.02
Round  19, Train loss: 0.781, Test loss: 0.922, Test accuracy: 64.64
Round  19, Global train loss: 0.781, Global test loss: 1.368, Global test accuracy: 51.74
Round  20, Train loss: 0.826, Test loss: 0.920, Test accuracy: 64.65
Round  20, Global train loss: 0.826, Global test loss: 1.379, Global test accuracy: 49.96
Round  21, Train loss: 0.822, Test loss: 0.912, Test accuracy: 65.69
Round  21, Global train loss: 0.822, Global test loss: 1.771, Global test accuracy: 46.07
Round  22, Train loss: 0.774, Test loss: 0.929, Test accuracy: 65.34
Round  22, Global train loss: 0.774, Global test loss: 1.406, Global test accuracy: 52.41
Round  23, Train loss: 0.748, Test loss: 0.907, Test accuracy: 65.99
Round  23, Global train loss: 0.748, Global test loss: 1.450, Global test accuracy: 50.52
Round  24, Train loss: 0.780, Test loss: 0.903, Test accuracy: 65.78
Round  24, Global train loss: 0.780, Global test loss: 1.241, Global test accuracy: 54.55
Round  25, Train loss: 0.749, Test loss: 0.879, Test accuracy: 66.79
Round  25, Global train loss: 0.749, Global test loss: 1.283, Global test accuracy: 53.68
Round  26, Train loss: 0.737, Test loss: 0.882, Test accuracy: 67.36
Round  26, Global train loss: 0.737, Global test loss: 1.493, Global test accuracy: 49.03
Round  27, Train loss: 0.686, Test loss: 0.879, Test accuracy: 67.83
Round  27, Global train loss: 0.686, Global test loss: 1.198, Global test accuracy: 57.63
Round  28, Train loss: 0.672, Test loss: 0.872, Test accuracy: 68.32
Round  28, Global train loss: 0.672, Global test loss: 1.284, Global test accuracy: 55.78
Round  29, Train loss: 0.704, Test loss: 0.868, Test accuracy: 68.56
Round  29, Global train loss: 0.704, Global test loss: 1.306, Global test accuracy: 53.60
Round  30, Train loss: 0.677, Test loss: 0.888, Test accuracy: 68.24
Round  30, Global train loss: 0.677, Global test loss: 1.337, Global test accuracy: 54.27
Round  31, Train loss: 0.602, Test loss: 0.878, Test accuracy: 68.37
Round  31, Global train loss: 0.602, Global test loss: 1.564, Global test accuracy: 50.12
Round  32, Train loss: 0.673, Test loss: 0.883, Test accuracy: 68.47
Round  32, Global train loss: 0.673, Global test loss: 1.287, Global test accuracy: 54.38
Round  33, Train loss: 0.689, Test loss: 0.869, Test accuracy: 68.82
Round  33, Global train loss: 0.689, Global test loss: 1.267, Global test accuracy: 56.18
Round  34, Train loss: 0.663, Test loss: 0.878, Test accuracy: 68.67
Round  34, Global train loss: 0.663, Global test loss: 1.355, Global test accuracy: 53.70
Round  35, Train loss: 0.589, Test loss: 0.848, Test accuracy: 69.36
Round  35, Global train loss: 0.589, Global test loss: 1.253, Global test accuracy: 56.61
Round  36, Train loss: 0.597, Test loss: 0.859, Test accuracy: 69.47
Round  36, Global train loss: 0.597, Global test loss: 1.412, Global test accuracy: 53.55
Round  37, Train loss: 0.615, Test loss: 0.877, Test accuracy: 68.77
Round  37, Global train loss: 0.615, Global test loss: 1.412, Global test accuracy: 54.25
Round  38, Train loss: 0.560, Test loss: 0.889, Test accuracy: 68.68
Round  38, Global train loss: 0.560, Global test loss: 1.280, Global test accuracy: 56.41
Round  39, Train loss: 0.568, Test loss: 0.875, Test accuracy: 69.05
Round  39, Global train loss: 0.568, Global test loss: 1.241, Global test accuracy: 57.44
Round  40, Train loss: 0.541, Test loss: 0.880, Test accuracy: 69.05
Round  40, Global train loss: 0.541, Global test loss: 1.366, Global test accuracy: 55.37
Round  41, Train loss: 0.559, Test loss: 0.880, Test accuracy: 69.31
Round  41, Global train loss: 0.559, Global test loss: 1.369, Global test accuracy: 57.08
Round  42, Train loss: 0.565, Test loss: 0.897, Test accuracy: 69.67
Round  42, Global train loss: 0.565, Global test loss: 1.334, Global test accuracy: 54.57
Round  43, Train loss: 0.539, Test loss: 0.895, Test accuracy: 69.82
Round  43, Global train loss: 0.539, Global test loss: 1.260, Global test accuracy: 58.10
Round  44, Train loss: 0.528, Test loss: 0.890, Test accuracy: 70.28
Round  44, Global train loss: 0.528, Global test loss: 1.298, Global test accuracy: 57.11
Round  45, Train loss: 0.507, Test loss: 0.891, Test accuracy: 70.18
Round  45, Global train loss: 0.507, Global test loss: 1.384, Global test accuracy: 55.28
Round  46, Train loss: 0.469, Test loss: 0.877, Test accuracy: 70.75
Round  46, Global train loss: 0.469, Global test loss: 1.396, Global test accuracy: 56.96
Round  47, Train loss: 0.507, Test loss: 0.869, Test accuracy: 70.66
Round  47, Global train loss: 0.507, Global test loss: 1.190, Global test accuracy: 61.15
Round  48, Train loss: 0.516, Test loss: 0.872, Test accuracy: 70.84
Round  48, Global train loss: 0.516, Global test loss: 1.113, Global test accuracy: 62.24
Round  49, Train loss: 0.428, Test loss: 0.868, Test accuracy: 70.88
Round  49, Global train loss: 0.428, Global test loss: 1.426, Global test accuracy: 57.84
Round  50, Train loss: 0.476, Test loss: 0.880, Test accuracy: 71.14
Round  50, Global train loss: 0.476, Global test loss: 1.389, Global test accuracy: 55.87
Round  51, Train loss: 0.479, Test loss: 0.881, Test accuracy: 71.09
Round  51, Global train loss: 0.479, Global test loss: 1.259, Global test accuracy: 59.05
Round  52, Train loss: 0.535, Test loss: 0.876, Test accuracy: 71.05
Round  52, Global train loss: 0.535, Global test loss: 1.133, Global test accuracy: 61.31
Round  53, Train loss: 0.472, Test loss: 0.897, Test accuracy: 70.86
Round  53, Global train loss: 0.472, Global test loss: 1.473, Global test accuracy: 54.73
Round  54, Train loss: 0.452, Test loss: 0.901, Test accuracy: 70.99
Round  54, Global train loss: 0.452, Global test loss: 1.149, Global test accuracy: 62.18
Round  55, Train loss: 0.430, Test loss: 0.900, Test accuracy: 70.74
Round  55, Global train loss: 0.430, Global test loss: 1.175, Global test accuracy: 61.19
Round  56, Train loss: 0.391, Test loss: 0.895, Test accuracy: 70.92
Round  56, Global train loss: 0.391, Global test loss: 1.482, Global test accuracy: 55.85
Round  57, Train loss: 0.446, Test loss: 0.878, Test accuracy: 71.59
Round  57, Global train loss: 0.446, Global test loss: 1.172, Global test accuracy: 62.02
Round  58, Train loss: 0.385, Test loss: 0.890, Test accuracy: 71.53
Round  58, Global train loss: 0.385, Global test loss: 1.203, Global test accuracy: 61.75
Round  59, Train loss: 0.470, Test loss: 0.899, Test accuracy: 71.73
Round  59, Global train loss: 0.470, Global test loss: 1.468, Global test accuracy: 56.94
Round  60, Train loss: 0.502, Test loss: 0.886, Test accuracy: 72.22
Round  60, Global train loss: 0.502, Global test loss: 1.171, Global test accuracy: 60.98
Round  61, Train loss: 0.378, Test loss: 0.888, Test accuracy: 72.24
Round  61, Global train loss: 0.378, Global test loss: 1.184, Global test accuracy: 62.00
Round  62, Train loss: 0.437, Test loss: 0.919, Test accuracy: 71.57
Round  62, Global train loss: 0.437, Global test loss: 1.257, Global test accuracy: 60.14
Round  63, Train loss: 0.372, Test loss: 0.886, Test accuracy: 72.42
Round  63, Global train loss: 0.372, Global test loss: 1.114, Global test accuracy: 62.85
Round  64, Train loss: 0.380, Test loss: 0.852, Test accuracy: 72.76
Round  64, Global train loss: 0.380, Global test loss: 1.179, Global test accuracy: 62.12
Round  65, Train loss: 0.437, Test loss: 0.863, Test accuracy: 72.58
Round  65, Global train loss: 0.437, Global test loss: 1.141, Global test accuracy: 61.87
Round  66, Train loss: 0.390, Test loss: 0.892, Test accuracy: 72.31
Round  66, Global train loss: 0.390, Global test loss: 1.377, Global test accuracy: 58.18
Round  67, Train loss: 0.406, Test loss: 0.876, Test accuracy: 72.73
Round  67, Global train loss: 0.406, Global test loss: 1.202, Global test accuracy: 61.73
Round  68, Train loss: 0.403, Test loss: 0.887, Test accuracy: 72.64
Round  68, Global train loss: 0.403, Global test loss: 1.314, Global test accuracy: 58.80
Round  69, Train loss: 0.385, Test loss: 0.915, Test accuracy: 72.37
Round  69, Global train loss: 0.385, Global test loss: 1.231, Global test accuracy: 61.59
Round  70, Train loss: 0.390, Test loss: 0.902, Test accuracy: 72.71
Round  70, Global train loss: 0.390, Global test loss: 1.156, Global test accuracy: 63.92
Round  71, Train loss: 0.396, Test loss: 0.912, Test accuracy: 72.46
Round  71, Global train loss: 0.396, Global test loss: 1.281, Global test accuracy: 62.01
Round  72, Train loss: 0.334, Test loss: 0.912, Test accuracy: 72.45
Round  72, Global train loss: 0.334, Global test loss: 1.322, Global test accuracy: 60.70
Round  73, Train loss: 0.357, Test loss: 0.910, Test accuracy: 72.67
Round  73, Global train loss: 0.357, Global test loss: 1.109, Global test accuracy: 64.92
Round  74, Train loss: 0.415, Test loss: 0.908, Test accuracy: 72.68
Round  74, Global train loss: 0.415, Global test loss: 1.231, Global test accuracy: 62.00
Round  75, Train loss: 0.401, Test loss: 0.935, Test accuracy: 72.07
Round  75, Global train loss: 0.401, Global test loss: 1.280, Global test accuracy: 59.19
Round  76, Train loss: 0.392, Test loss: 0.944, Test accuracy: 72.06
Round  76, Global train loss: 0.392, Global test loss: 1.113, Global test accuracy: 63.48
Round  77, Train loss: 0.356, Test loss: 0.954, Test accuracy: 71.87
Round  77, Global train loss: 0.356, Global test loss: 1.158, Global test accuracy: 63.12
Round  78, Train loss: 0.352, Test loss: 0.956, Test accuracy: 72.07
Round  78, Global train loss: 0.352, Global test loss: 1.280, Global test accuracy: 61.15
Round  79, Train loss: 0.418, Test loss: 0.967, Test accuracy: 71.82
Round  79, Global train loss: 0.418, Global test loss: 1.392, Global test accuracy: 57.69
Round  80, Train loss: 0.326, Test loss: 0.940, Test accuracy: 72.32
Round  80, Global train loss: 0.326, Global test loss: 1.162, Global test accuracy: 64.10
Round  81, Train loss: 0.372, Test loss: 0.941, Test accuracy: 72.56
Round  81, Global train loss: 0.372, Global test loss: 1.191, Global test accuracy: 63.36
Round  82, Train loss: 0.326, Test loss: 0.943, Test accuracy: 72.63
Round  82, Global train loss: 0.326, Global test loss: 1.255, Global test accuracy: 62.65
Round  83, Train loss: 0.334, Test loss: 0.939, Test accuracy: 72.61
Round  83, Global train loss: 0.334, Global test loss: 1.449, Global test accuracy: 57.87
Round  84, Train loss: 0.377, Test loss: 0.922, Test accuracy: 73.02
Round  84, Global train loss: 0.377, Global test loss: 1.284, Global test accuracy: 60.69
Round  85, Train loss: 0.355, Test loss: 0.929, Test accuracy: 72.85
Round  85, Global train loss: 0.355, Global test loss: 1.156, Global test accuracy: 64.70
Round  86, Train loss: 0.384, Test loss: 0.935, Test accuracy: 72.81
Round  86, Global train loss: 0.384, Global test loss: 1.216, Global test accuracy: 62.11
Round  87, Train loss: 0.341, Test loss: 0.919, Test accuracy: 73.09
Round  87, Global train loss: 0.341, Global test loss: 1.255, Global test accuracy: 61.14
Round  88, Train loss: 0.314, Test loss: 0.949, Test accuracy: 72.77
Round  88, Global train loss: 0.314, Global test loss: 1.254, Global test accuracy: 62.34
Round  89, Train loss: 0.273, Test loss: 0.950, Test accuracy: 73.08
Round  89, Global train loss: 0.273, Global test loss: 1.216, Global test accuracy: 64.11
Round  90, Train loss: 0.297, Test loss: 0.952, Test accuracy: 73.16
Round  90, Global train loss: 0.297, Global test loss: 1.300, Global test accuracy: 62.93
Round  91, Train loss: 0.303, Test loss: 0.940, Test accuracy: 73.55
Round  91, Global train loss: 0.303, Global test loss: 1.424, Global test accuracy: 58.37
Round  92, Train loss: 0.301, Test loss: 0.951, Test accuracy: 73.37
Round  92, Global train loss: 0.301, Global test loss: 1.323, Global test accuracy: 60.83
Round  93, Train loss: 0.280, Test loss: 0.947, Test accuracy: 73.39
Round  93, Global train loss: 0.280, Global test loss: 1.242, Global test accuracy: 62.46
Round  94, Train loss: 0.276, Test loss: 0.963, Test accuracy: 73.32
Round  94, Global train loss: 0.276, Global test loss: 1.226, Global test accuracy: 62.97
Round  95, Train loss: 0.291, Test loss: 0.961, Test accuracy: 73.21
Round  95, Global train loss: 0.291, Global test loss: 1.463, Global test accuracy: 59.20
Round  96, Train loss: 0.353, Test loss: 0.972, Test accuracy: 73.27
Round  96, Global train loss: 0.353, Global test loss: 1.172, Global test accuracy: 64.96
Round  97, Train loss: 0.255, Test loss: 0.983, Test accuracy: 73.40
Round  97, Global train loss: 0.255, Global test loss: 1.578, Global test accuracy: 59.88
Round  98, Train loss: 0.294, Test loss: 0.965, Test accuracy: 74.04
Round  98, Global train loss: 0.294, Global test loss: 1.288, Global test accuracy: 64.08
Round  99, Train loss: 0.287, Test loss: 0.975, Test accuracy: 74.05
Round  99, Global train loss: 0.287, Global test loss: 1.429, Global test accuracy: 60.25
Final Round, Train loss: 0.238, Test loss: 1.052, Test accuracy: 72.87
Final Round, Global train loss: 0.238, Global test loss: 1.429, Global test accuracy: 60.25
Average accuracy final 10 rounds: 73.476
Average global accuracy final 10 rounds: 61.593
1816.5943944454193
[2.6438674926757812, 5.0707526206970215, 7.502881050109863, 9.950192928314209, 12.4291832447052, 14.870993852615356, 17.315062522888184, 19.764867067337036, 22.220659971237183, 24.66914463043213, 27.123127222061157, 29.563629865646362, 31.723175048828125, 33.88691234588623, 36.04576539993286, 38.20558428764343, 40.36424708366394, 42.511372804641724, 44.675421953201294, 46.82173800468445, 48.98703145980835, 51.14981269836426, 53.31005597114563, 55.469722032547, 57.62959575653076, 59.790480852127075, 61.93774700164795, 64.08348989486694, 66.22594094276428, 68.37809109687805, 70.5266809463501, 72.67709851264954, 74.83782744407654, 77.00386309623718, 79.16602182388306, 81.32854008674622, 83.49042391777039, 85.65172290802002, 87.81414270401001, 89.95541596412659, 92.10161256790161, 94.2497410774231, 96.39583110809326, 98.54342842102051, 100.68698477745056, 102.82889175415039, 104.97454786300659, 107.13511991500854, 109.30033206939697, 111.46218204498291, 113.6254186630249, 115.79098153114319, 117.93285059928894, 120.07596969604492, 122.21962404251099, 124.36774587631226, 126.51323795318604, 128.67656755447388, 130.84244203567505, 133.00714492797852, 135.15229749679565, 137.31961464881897, 139.48510122299194, 141.65113949775696, 143.81220602989197, 145.9797489643097, 148.14441657066345, 150.28621459007263, 152.43137311935425, 154.57694554328918, 156.721453666687, 158.86411714553833, 161.00956773757935, 163.17286229133606, 165.34004735946655, 167.5124819278717, 169.6779613494873, 171.83724236488342, 173.9806408882141, 176.12285089492798, 178.26709723472595, 180.41453313827515, 182.57135367393494, 184.7279269695282, 186.87071776390076, 189.03011083602905, 191.18096470832825, 193.33719778060913, 195.49887681007385, 197.6956868171692, 199.84684801101685, 201.98666429519653, 204.14524602890015, 206.30816864967346, 208.47154259681702, 210.63443636894226, 212.79846119880676, 214.96334958076477, 217.1109540462494, 219.25357484817505, 223.10858392715454]
[23.35, 33.43, 38.69, 44.7, 47.4, 48.38, 51.52, 53.45, 55.41, 56.19, 58.58, 59.68, 61.61, 61.56, 62.97, 63.51, 64.41, 64.28, 64.77, 64.64, 64.65, 65.69, 65.34, 65.99, 65.78, 66.79, 67.36, 67.83, 68.32, 68.56, 68.24, 68.37, 68.47, 68.82, 68.67, 69.36, 69.47, 68.77, 68.68, 69.05, 69.05, 69.31, 69.67, 69.82, 70.28, 70.18, 70.75, 70.66, 70.84, 70.88, 71.14, 71.09, 71.05, 70.86, 70.99, 70.74, 70.92, 71.59, 71.53, 71.73, 72.22, 72.24, 71.57, 72.42, 72.76, 72.58, 72.31, 72.73, 72.64, 72.37, 72.71, 72.46, 72.45, 72.67, 72.68, 72.07, 72.06, 71.87, 72.07, 71.82, 72.32, 72.56, 72.63, 72.61, 73.02, 72.85, 72.81, 73.09, 72.77, 73.08, 73.16, 73.55, 73.37, 73.39, 73.32, 73.21, 73.27, 73.4, 74.04, 74.05, 72.87]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  10.0000
Round 1 global test acc  20.2900
Round 2 global test acc  22.0500
Round 3 global test acc  25.0100
Round 4 global test acc  23.7200
Round 5 global test acc  29.9600
Round 6 global test acc  28.7900
Round 7 global test acc  27.3900
Round 8 global test acc  30.6800
Round 9 global test acc  30.5300
Round 10 global test acc  29.0700
Round 11 global test acc  29.9700
Round 12 global test acc  29.2600
Round 13 global test acc  29.3900
Round 14 global test acc  38.0400
Round 15 global test acc  29.9600
Round 16 global test acc  31.0800
Round 17 global test acc  30.5700
Round 18 global test acc  37.6600
Round 19 global test acc  33.1500
Round 20 global test acc  31.1500
Round 21 global test acc  34.0400
Round 22 global test acc  35.7100
Round 23 global test acc  34.3200
Round 24 global test acc  31.9000
Round 25 global test acc  30.8700
Round 26 global test acc  42.7800
Round 27 global test acc  36.5500
Round 28 global test acc  40.0300
Round 29 global test acc  37.7500
Round 30 global test acc  35.1300
Round 31 global test acc  34.7400
Round 32 global test acc  30.6100
Round 33 global test acc  35.0500
Round 34 global test acc  33.7900
Round 35 global test acc  43.8000
Round 36 global test acc  38.0200
Round 37 global test acc  35.6300
Round 38 global test acc  36.4700
Round 39 global test acc  44.3200
Round 40 global test acc  40.6000
Round 41 global test acc  43.4100
Round 42 global test acc  39.6400
Round 43 global test acc  36.8100
Round 44 global test acc  40.2900
Round 45 global test acc  46.0800
Round 46 global test acc  35.8200
Round 47 global test acc  38.1600
Round 48 global test acc  37.1600
Round 49 global test acc  42.3500
Round 50 global test acc  39.0100
Round 51 global test acc  45.8000
Round 52 global test acc  41.7800
Round 53 global test acc  36.8200
Round 54 global test acc  38.9000
Round 55 global test acc  40.7200
Round 56 global test acc  39.1500
Round 57 global test acc  45.1400
Round 58 global test acc  40.6900
Round 59 global test acc  44.1500
Round 60 global test acc  36.5600
Round 61 global test acc  43.1900
Round 62 global test acc  40.5400
Round 63 global test acc  45.0400
Round 64 global test acc  44.0100
Round 65 global test acc  43.8500
Round 66 global test acc  39.0400
Round 67 global test acc  42.0000
Round 68 global test acc  38.2100
Round 69 global test acc  40.5200
Round 70 global test acc  42.7500
Round 71 global test acc  44.7400
Round 72 global test acc  34.8900
Round 73 global test acc  37.7600
Round 74 global test acc  43.6600
Round 75 global test acc  43.8200
Round 76 global test acc  45.5300
Round 77 global test acc  41.5400
Round 78 global test acc  41.9800
Round 79 global test acc  45.2500
Round 80 global test acc  42.0300
Round 81 global test acc  37.9300
Round 82 global test acc  35.4600
Round 83 global test acc  33.0500
Round 84 global test acc  31.9200
Round 85 global test acc  31.0900
Round 86 global test acc  30.8700
Round 87 global test acc  29.8900
Round 88 global test acc  29.0600
Round 89 global test acc  28.7000
Round 90 global test acc  25.4100
Round 91 global test acc  25.0100
Round 92 global test acc  23.5600
Round 93 global test acc  23.1900
Round 94 global test acc  22.4600
Round 95 global test acc  22.2300
Round 96 global test acc  21.1700
Round 97 global test acc  21.0400
Round 98 global test acc  20.3500
Round 99 global test acc  19.7600
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.958, Test loss: 2.174, Test accuracy: 14.32
Round   1, Train loss: 1.549, Test loss: 2.044, Test accuracy: 24.55
Round   2, Train loss: 1.423, Test loss: 1.694, Test accuracy: 31.94
Round   3, Train loss: 1.320, Test loss: 1.511, Test accuracy: 44.29
Round   4, Train loss: 1.227, Test loss: 1.233, Test accuracy: 50.05
Round   5, Train loss: 1.153, Test loss: 1.236, Test accuracy: 51.22
Round   6, Train loss: 1.080, Test loss: 1.201, Test accuracy: 53.80
Round   7, Train loss: 1.069, Test loss: 1.178, Test accuracy: 55.80
Round   8, Train loss: 1.054, Test loss: 1.123, Test accuracy: 56.68
Round   9, Train loss: 1.127, Test loss: 0.988, Test accuracy: 61.47
Round  10, Train loss: 0.980, Test loss: 0.978, Test accuracy: 61.14
Round  11, Train loss: 1.053, Test loss: 0.951, Test accuracy: 62.66
Round  12, Train loss: 0.973, Test loss: 0.935, Test accuracy: 62.57
Round  13, Train loss: 0.967, Test loss: 0.921, Test accuracy: 62.77
Round  14, Train loss: 0.919, Test loss: 0.919, Test accuracy: 63.04
Round  15, Train loss: 0.924, Test loss: 0.903, Test accuracy: 64.58
Round  16, Train loss: 0.954, Test loss: 0.871, Test accuracy: 65.20
Round  17, Train loss: 0.919, Test loss: 0.865, Test accuracy: 65.60
Round  18, Train loss: 0.864, Test loss: 0.848, Test accuracy: 66.42
Round  19, Train loss: 0.865, Test loss: 0.840, Test accuracy: 66.93
Round  20, Train loss: 0.812, Test loss: 0.850, Test accuracy: 66.93
Round  21, Train loss: 0.907, Test loss: 0.825, Test accuracy: 68.15
Round  22, Train loss: 0.868, Test loss: 0.823, Test accuracy: 67.97
Round  23, Train loss: 0.860, Test loss: 0.809, Test accuracy: 68.66
Round  24, Train loss: 0.844, Test loss: 0.799, Test accuracy: 68.77
Round  25, Train loss: 0.772, Test loss: 0.796, Test accuracy: 69.59
Round  26, Train loss: 0.842, Test loss: 0.783, Test accuracy: 70.56
Round  27, Train loss: 0.814, Test loss: 0.785, Test accuracy: 69.52
Round  28, Train loss: 0.778, Test loss: 0.761, Test accuracy: 70.37
Round  29, Train loss: 0.772, Test loss: 0.749, Test accuracy: 70.90
Round  30, Train loss: 0.735, Test loss: 0.750, Test accuracy: 70.52
Round  31, Train loss: 0.762, Test loss: 0.751, Test accuracy: 70.56
Round  32, Train loss: 0.741, Test loss: 0.739, Test accuracy: 71.12
Round  33, Train loss: 0.695, Test loss: 0.750, Test accuracy: 70.54
Round  34, Train loss: 0.716, Test loss: 0.728, Test accuracy: 71.79
Round  35, Train loss: 0.752, Test loss: 0.714, Test accuracy: 72.19
Round  36, Train loss: 0.767, Test loss: 0.716, Test accuracy: 72.44
Round  37, Train loss: 0.691, Test loss: 0.698, Test accuracy: 73.28
Round  38, Train loss: 0.732, Test loss: 0.700, Test accuracy: 73.20
Round  39, Train loss: 0.696, Test loss: 0.708, Test accuracy: 72.86
Round  40, Train loss: 0.648, Test loss: 0.695, Test accuracy: 73.01
Round  41, Train loss: 0.706, Test loss: 0.705, Test accuracy: 73.11
Round  42, Train loss: 0.722, Test loss: 0.717, Test accuracy: 72.07
Round  43, Train loss: 0.699, Test loss: 0.704, Test accuracy: 73.24
Round  44, Train loss: 0.670, Test loss: 0.711, Test accuracy: 72.48
Round  45, Train loss: 0.687, Test loss: 0.694, Test accuracy: 73.42
Round  46, Train loss: 0.641, Test loss: 0.682, Test accuracy: 73.60
Round  47, Train loss: 0.667, Test loss: 0.676, Test accuracy: 74.00
Round  48, Train loss: 0.596, Test loss: 0.676, Test accuracy: 73.96
Round  49, Train loss: 0.620, Test loss: 0.686, Test accuracy: 73.67
Round  50, Train loss: 0.650, Test loss: 0.674, Test accuracy: 74.19
Round  51, Train loss: 0.643, Test loss: 0.654, Test accuracy: 74.96
Round  52, Train loss: 0.586, Test loss: 0.648, Test accuracy: 75.20
Round  53, Train loss: 0.615, Test loss: 0.647, Test accuracy: 75.21
Round  54, Train loss: 0.618, Test loss: 0.656, Test accuracy: 74.95
Round  55, Train loss: 0.584, Test loss: 0.652, Test accuracy: 75.23
Round  56, Train loss: 0.564, Test loss: 0.651, Test accuracy: 75.91
Round  57, Train loss: 0.566, Test loss: 0.641, Test accuracy: 76.16
Round  58, Train loss: 0.576, Test loss: 0.636, Test accuracy: 76.10
Round  59, Train loss: 0.610, Test loss: 0.648, Test accuracy: 75.55
Round  60, Train loss: 0.535, Test loss: 0.638, Test accuracy: 76.00
Round  61, Train loss: 0.515, Test loss: 0.648, Test accuracy: 75.58
Round  62, Train loss: 0.572, Test loss: 0.643, Test accuracy: 76.02
Round  63, Train loss: 0.525, Test loss: 0.644, Test accuracy: 75.59
Round  64, Train loss: 0.493, Test loss: 0.636, Test accuracy: 76.25
Round  65, Train loss: 0.499, Test loss: 0.633, Test accuracy: 76.54
Round  66, Train loss: 0.542, Test loss: 0.634, Test accuracy: 76.22
Round  67, Train loss: 0.494, Test loss: 0.631, Test accuracy: 76.34
Round  68, Train loss: 0.517, Test loss: 0.629, Test accuracy: 76.34
Round  69, Train loss: 0.490, Test loss: 0.631, Test accuracy: 76.40
Round  70, Train loss: 0.445, Test loss: 0.634, Test accuracy: 76.23
Round  71, Train loss: 0.526, Test loss: 0.632, Test accuracy: 76.46
Round  72, Train loss: 0.501, Test loss: 0.627, Test accuracy: 76.77
Round  73, Train loss: 0.490, Test loss: 0.625, Test accuracy: 77.05
Round  74, Train loss: 0.529, Test loss: 0.623, Test accuracy: 76.94
Round  75, Train loss: 0.520, Test loss: 0.629, Test accuracy: 76.86
Round  76, Train loss: 0.473, Test loss: 0.632, Test accuracy: 76.50
Round  77, Train loss: 0.474, Test loss: 0.625, Test accuracy: 76.99
Round  78, Train loss: 0.409, Test loss: 0.633, Test accuracy: 76.97
Round  79, Train loss: 0.448, Test loss: 0.626, Test accuracy: 77.02
Round  80, Train loss: 0.464, Test loss: 0.627, Test accuracy: 76.91
Round  81, Train loss: 0.433, Test loss: 0.633, Test accuracy: 76.57
Round  82, Train loss: 0.381, Test loss: 0.620, Test accuracy: 77.36
Round  83, Train loss: 0.424, Test loss: 0.628, Test accuracy: 76.94
Round  84, Train loss: 0.548, Test loss: 0.624, Test accuracy: 77.58
Round  85, Train loss: 0.400, Test loss: 0.616, Test accuracy: 77.38
Round  86, Train loss: 0.440, Test loss: 0.613, Test accuracy: 77.54
Round  87, Train loss: 0.445, Test loss: 0.621, Test accuracy: 77.14
Round  88, Train loss: 0.433, Test loss: 0.619, Test accuracy: 77.39
Round  89, Train loss: 0.449, Test loss: 0.628, Test accuracy: 77.08
Round  90, Train loss: 0.418, Test loss: 0.616, Test accuracy: 77.76
Round  91, Train loss: 0.404, Test loss: 0.621, Test accuracy: 77.38
Round  92, Train loss: 0.376, Test loss: 0.627, Test accuracy: 77.06
Round  93, Train loss: 0.400, Test loss: 0.618, Test accuracy: 77.32
Round  94, Train loss: 0.391, Test loss: 0.633, Test accuracy: 76.76
Round  95, Train loss: 0.442, Test loss: 0.618, Test accuracy: 77.47
Round  96, Train loss: 0.426, Test loss: 0.630, Test accuracy: 77.28
Round  97, Train loss: 0.357, Test loss: 0.627, Test accuracy: 77.23
Round  98, Train loss: 0.356, Test loss: 0.626, Test accuracy: 77.68
Round  99, Train loss: 0.450, Test loss: 0.625, Test accuracy: 77.23
Final Round, Train loss: 0.352, Test loss: 0.627, Test accuracy: 77.51
Average accuracy final 10 rounds: 77.317
997.755090713501
[1.5910801887512207, 2.849008321762085, 4.108215808868408, 5.374431610107422, 6.639394283294678, 7.904866695404053, 9.167183876037598, 10.426487684249878, 11.686493158340454, 12.947843313217163, 14.207985877990723, 15.469642162322998, 16.735440492630005, 17.987414836883545, 19.187575817108154, 20.37449860572815, 21.55529499053955, 22.734538316726685, 23.917829275131226, 25.09591269493103, 26.343069791793823, 27.599045276641846, 28.854285717010498, 30.109028100967407, 31.362111806869507, 32.621108531951904, 33.88019824028015, 35.135947704315186, 36.390347480773926, 37.64638042449951, 38.903249740600586, 40.16057848930359, 41.43327069282532, 42.69003629684448, 43.94530892372131, 45.18308115005493, 46.47709035873413, 47.74305510520935, 48.99099349975586, 50.24094605445862, 51.4943790435791, 52.748180627822876, 53.9969801902771, 55.2499840259552, 56.50141501426697, 57.75068497657776, 58.99982500076294, 60.24581480026245, 61.500497579574585, 62.745765924453735, 63.98785877227783, 65.22978258132935, 66.4765260219574, 67.71106100082397, 68.95766496658325, 70.20145463943481, 71.44808602333069, 72.6905267238617, 73.93211841583252, 75.17249703407288, 76.42280793190002, 77.67059779167175, 78.9218761920929, 80.16926431655884, 81.42119789123535, 82.67104649543762, 83.92291283607483, 85.16987490653992, 86.42145490646362, 87.67189598083496, 88.92152738571167, 90.16870474815369, 91.41788077354431, 92.66843605041504, 93.92072463035583, 95.17073512077332, 96.4031331539154, 97.63960599899292, 98.87897396087646, 100.11442041397095, 101.35361909866333, 102.59716796875, 103.84222412109375, 105.08877897262573, 106.33921551704407, 107.57669162750244, 108.82208132743835, 110.0677421092987, 111.31931209564209, 112.56683540344238, 113.81357073783875, 115.05835485458374, 116.2992205619812, 117.5524172782898, 118.80931997299194, 120.06394052505493, 121.32218480110168, 122.60416913032532, 123.84753441810608, 125.11666941642761, 127.0510094165802]
[14.32, 24.55, 31.94, 44.29, 50.05, 51.22, 53.8, 55.8, 56.68, 61.47, 61.14, 62.66, 62.57, 62.77, 63.04, 64.58, 65.2, 65.6, 66.42, 66.93, 66.93, 68.15, 67.97, 68.66, 68.77, 69.59, 70.56, 69.52, 70.37, 70.9, 70.52, 70.56, 71.12, 70.54, 71.79, 72.19, 72.44, 73.28, 73.2, 72.86, 73.01, 73.11, 72.07, 73.24, 72.48, 73.42, 73.6, 74.0, 73.96, 73.67, 74.19, 74.96, 75.2, 75.21, 74.95, 75.23, 75.91, 76.16, 76.1, 75.55, 76.0, 75.58, 76.02, 75.59, 76.25, 76.54, 76.22, 76.34, 76.34, 76.4, 76.23, 76.46, 76.77, 77.05, 76.94, 76.86, 76.5, 76.99, 76.97, 77.02, 76.91, 76.57, 77.36, 76.94, 77.58, 77.38, 77.54, 77.14, 77.39, 77.08, 77.76, 77.38, 77.06, 77.32, 76.76, 77.47, 77.28, 77.23, 77.68, 77.23, 77.51]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.603, Test loss: 1.999, Test accuracy: 22.21
Round   0, Global train loss: 1.603, Global test loss: 2.217, Global test accuracy: 17.65
Round   1, Train loss: 1.427, Test loss: 1.905, Test accuracy: 30.53
Round   1, Global train loss: 1.427, Global test loss: 2.264, Global test accuracy: 23.06
Round   2, Train loss: 1.314, Test loss: 1.591, Test accuracy: 39.77
Round   2, Global train loss: 1.314, Global test loss: 2.115, Global test accuracy: 26.70
Round   3, Train loss: 1.216, Test loss: 1.554, Test accuracy: 41.70
Round   3, Global train loss: 1.216, Global test loss: 2.074, Global test accuracy: 30.13
Round   4, Train loss: 1.180, Test loss: 1.447, Test accuracy: 44.74
Round   4, Global train loss: 1.180, Global test loss: 2.065, Global test accuracy: 29.98
Round   5, Train loss: 1.160, Test loss: 1.222, Test accuracy: 51.69
Round   5, Global train loss: 1.160, Global test loss: 1.694, Global test accuracy: 37.94
Round   6, Train loss: 1.076, Test loss: 1.137, Test accuracy: 55.15
Round   6, Global train loss: 1.076, Global test loss: 1.599, Global test accuracy: 41.40
Round   7, Train loss: 1.023, Test loss: 1.170, Test accuracy: 54.39
Round   7, Global train loss: 1.023, Global test loss: 1.733, Global test accuracy: 39.63
Round   8, Train loss: 1.023, Test loss: 1.170, Test accuracy: 54.81
Round   8, Global train loss: 1.023, Global test loss: 1.838, Global test accuracy: 36.69
Round   9, Train loss: 1.035, Test loss: 1.089, Test accuracy: 57.09
Round   9, Global train loss: 1.035, Global test loss: 1.698, Global test accuracy: 40.74
Round  10, Train loss: 0.895, Test loss: 1.075, Test accuracy: 58.42
Round  10, Global train loss: 0.895, Global test loss: 1.933, Global test accuracy: 40.10
Round  11, Train loss: 1.001, Test loss: 1.039, Test accuracy: 59.33
Round  11, Global train loss: 1.001, Global test loss: 1.751, Global test accuracy: 38.62
Round  12, Train loss: 0.949, Test loss: 1.019, Test accuracy: 59.90
Round  12, Global train loss: 0.949, Global test loss: 1.401, Global test accuracy: 48.80
Round  13, Train loss: 0.888, Test loss: 0.970, Test accuracy: 62.06
Round  13, Global train loss: 0.888, Global test loss: 1.565, Global test accuracy: 46.87
Round  14, Train loss: 0.927, Test loss: 0.959, Test accuracy: 62.62
Round  14, Global train loss: 0.927, Global test loss: 1.345, Global test accuracy: 51.06
Round  15, Train loss: 0.871, Test loss: 0.935, Test accuracy: 64.25
Round  15, Global train loss: 0.871, Global test loss: 1.663, Global test accuracy: 44.17
Round  16, Train loss: 0.840, Test loss: 0.920, Test accuracy: 64.87
Round  16, Global train loss: 0.840, Global test loss: 1.557, Global test accuracy: 48.49
Round  17, Train loss: 0.808, Test loss: 0.911, Test accuracy: 65.05
Round  17, Global train loss: 0.808, Global test loss: 1.370, Global test accuracy: 49.87
Round  18, Train loss: 0.877, Test loss: 0.897, Test accuracy: 65.91
Round  18, Global train loss: 0.877, Global test loss: 1.332, Global test accuracy: 50.85
Round  19, Train loss: 0.752, Test loss: 0.867, Test accuracy: 66.93
Round  19, Global train loss: 0.752, Global test loss: 1.292, Global test accuracy: 53.74
Round  20, Train loss: 0.745, Test loss: 0.856, Test accuracy: 67.33
Round  20, Global train loss: 0.745, Global test loss: 1.539, Global test accuracy: 47.71
Round  21, Train loss: 0.765, Test loss: 0.843, Test accuracy: 68.10
Round  21, Global train loss: 0.765, Global test loss: 1.631, Global test accuracy: 44.18
Round  22, Train loss: 0.720, Test loss: 0.859, Test accuracy: 67.91
Round  22, Global train loss: 0.720, Global test loss: 1.264, Global test accuracy: 54.98
Round  23, Train loss: 0.717, Test loss: 0.868, Test accuracy: 67.23
Round  23, Global train loss: 0.717, Global test loss: 1.513, Global test accuracy: 47.78
Round  24, Train loss: 0.745, Test loss: 0.876, Test accuracy: 67.44
Round  24, Global train loss: 0.745, Global test loss: 1.212, Global test accuracy: 57.45
Round  25, Train loss: 0.708, Test loss: 0.869, Test accuracy: 67.96
Round  25, Global train loss: 0.708, Global test loss: 1.355, Global test accuracy: 52.15
Round  26, Train loss: 0.701, Test loss: 0.875, Test accuracy: 68.28
Round  26, Global train loss: 0.701, Global test loss: 1.282, Global test accuracy: 55.08
Round  27, Train loss: 0.667, Test loss: 0.843, Test accuracy: 68.96
Round  27, Global train loss: 0.667, Global test loss: 1.294, Global test accuracy: 52.55
Round  28, Train loss: 0.643, Test loss: 0.828, Test accuracy: 69.56
Round  28, Global train loss: 0.643, Global test loss: 1.365, Global test accuracy: 54.40
Round  29, Train loss: 0.624, Test loss: 0.822, Test accuracy: 70.20
Round  29, Global train loss: 0.624, Global test loss: 1.361, Global test accuracy: 53.39
Round  30, Train loss: 0.659, Test loss: 0.821, Test accuracy: 70.28
Round  30, Global train loss: 0.659, Global test loss: 1.215, Global test accuracy: 57.17
Round  31, Train loss: 0.576, Test loss: 0.823, Test accuracy: 70.21
Round  31, Global train loss: 0.576, Global test loss: 1.228, Global test accuracy: 57.48
Round  32, Train loss: 0.583, Test loss: 0.814, Test accuracy: 70.65
Round  32, Global train loss: 0.583, Global test loss: 1.447, Global test accuracy: 51.56
Round  33, Train loss: 0.648, Test loss: 0.806, Test accuracy: 71.31
Round  33, Global train loss: 0.648, Global test loss: 1.204, Global test accuracy: 59.25
Round  34, Train loss: 0.628, Test loss: 0.802, Test accuracy: 71.21
Round  34, Global train loss: 0.628, Global test loss: 1.306, Global test accuracy: 55.94
Round  35, Train loss: 0.556, Test loss: 0.816, Test accuracy: 70.90
Round  35, Global train loss: 0.556, Global test loss: 1.171, Global test accuracy: 59.80
Round  36, Train loss: 0.558, Test loss: 0.811, Test accuracy: 71.24
Round  36, Global train loss: 0.558, Global test loss: 1.205, Global test accuracy: 58.69
Round  37, Train loss: 0.600, Test loss: 0.808, Test accuracy: 71.51
Round  37, Global train loss: 0.600, Global test loss: 1.162, Global test accuracy: 60.40
Round  38, Train loss: 0.563, Test loss: 0.789, Test accuracy: 72.02
Round  38, Global train loss: 0.563, Global test loss: 1.127, Global test accuracy: 60.86
Round  39, Train loss: 0.480, Test loss: 0.798, Test accuracy: 71.82
Round  39, Global train loss: 0.480, Global test loss: 1.375, Global test accuracy: 57.10
Round  40, Train loss: 0.579, Test loss: 0.805, Test accuracy: 71.60
Round  40, Global train loss: 0.579, Global test loss: 1.299, Global test accuracy: 56.27
Round  41, Train loss: 0.515, Test loss: 0.795, Test accuracy: 72.30
Round  41, Global train loss: 0.515, Global test loss: 1.376, Global test accuracy: 57.16
Round  42, Train loss: 0.554, Test loss: 0.840, Test accuracy: 71.16
Round  42, Global train loss: 0.554, Global test loss: 1.136, Global test accuracy: 61.04
Round  43, Train loss: 0.462, Test loss: 0.833, Test accuracy: 71.45
Round  43, Global train loss: 0.462, Global test loss: 1.178, Global test accuracy: 61.54
Round  44, Train loss: 0.601, Test loss: 0.825, Test accuracy: 71.93
Round  44, Global train loss: 0.601, Global test loss: 1.120, Global test accuracy: 61.22
Round  45, Train loss: 0.514, Test loss: 0.837, Test accuracy: 71.59
Round  45, Global train loss: 0.514, Global test loss: 1.215, Global test accuracy: 60.06
Round  46, Train loss: 0.471, Test loss: 0.858, Test accuracy: 71.33
Round  46, Global train loss: 0.471, Global test loss: 1.249, Global test accuracy: 58.75
Round  47, Train loss: 0.598, Test loss: 0.854, Test accuracy: 71.59
Round  47, Global train loss: 0.598, Global test loss: 1.192, Global test accuracy: 60.19
Round  48, Train loss: 0.491, Test loss: 0.849, Test accuracy: 71.58
Round  48, Global train loss: 0.491, Global test loss: 1.240, Global test accuracy: 59.32
Round  49, Train loss: 0.487, Test loss: 0.850, Test accuracy: 71.71
Round  49, Global train loss: 0.487, Global test loss: 1.167, Global test accuracy: 60.80
Round  50, Train loss: 0.412, Test loss: 0.828, Test accuracy: 72.53
Round  50, Global train loss: 0.412, Global test loss: 1.136, Global test accuracy: 63.12
Round  51, Train loss: 0.429, Test loss: 0.838, Test accuracy: 72.35
Round  51, Global train loss: 0.429, Global test loss: 1.300, Global test accuracy: 57.79
Round  52, Train loss: 0.459, Test loss: 0.828, Test accuracy: 72.94
Round  52, Global train loss: 0.459, Global test loss: 1.249, Global test accuracy: 59.88
Round  53, Train loss: 0.445, Test loss: 0.816, Test accuracy: 72.97
Round  53, Global train loss: 0.445, Global test loss: 1.341, Global test accuracy: 58.57
Round  54, Train loss: 0.465, Test loss: 0.811, Test accuracy: 72.71
Round  54, Global train loss: 0.465, Global test loss: 1.224, Global test accuracy: 61.22
Round  55, Train loss: 0.458, Test loss: 0.803, Test accuracy: 73.17
Round  55, Global train loss: 0.458, Global test loss: 1.124, Global test accuracy: 62.59
Round  56, Train loss: 0.462, Test loss: 0.796, Test accuracy: 73.57
Round  56, Global train loss: 0.462, Global test loss: 1.049, Global test accuracy: 64.71
Round  57, Train loss: 0.440, Test loss: 0.800, Test accuracy: 73.50
Round  57, Global train loss: 0.440, Global test loss: 1.199, Global test accuracy: 60.34
Round  58, Train loss: 0.413, Test loss: 0.795, Test accuracy: 73.76
Round  58, Global train loss: 0.413, Global test loss: 1.316, Global test accuracy: 58.77
Round  59, Train loss: 0.422, Test loss: 0.809, Test accuracy: 73.69
Round  59, Global train loss: 0.422, Global test loss: 1.222, Global test accuracy: 60.18
Round  60, Train loss: 0.398, Test loss: 0.799, Test accuracy: 73.97
Round  60, Global train loss: 0.398, Global test loss: 1.101, Global test accuracy: 64.00
Round  61, Train loss: 0.342, Test loss: 0.801, Test accuracy: 73.84
Round  61, Global train loss: 0.342, Global test loss: 1.345, Global test accuracy: 60.28
Round  62, Train loss: 0.420, Test loss: 0.825, Test accuracy: 73.78
Round  62, Global train loss: 0.420, Global test loss: 1.148, Global test accuracy: 62.81
Round  63, Train loss: 0.383, Test loss: 0.808, Test accuracy: 74.49
Round  63, Global train loss: 0.383, Global test loss: 1.345, Global test accuracy: 61.09
Round  64, Train loss: 0.453, Test loss: 0.801, Test accuracy: 74.91
Round  64, Global train loss: 0.453, Global test loss: 1.099, Global test accuracy: 63.01
Round  65, Train loss: 0.397, Test loss: 0.797, Test accuracy: 74.68
Round  65, Global train loss: 0.397, Global test loss: 1.179, Global test accuracy: 64.39
Round  66, Train loss: 0.361, Test loss: 0.815, Test accuracy: 74.52
Round  66, Global train loss: 0.361, Global test loss: 1.305, Global test accuracy: 61.65
Round  67, Train loss: 0.374, Test loss: 0.816, Test accuracy: 74.69
Round  67, Global train loss: 0.374, Global test loss: 1.326, Global test accuracy: 60.07
Round  68, Train loss: 0.416, Test loss: 0.798, Test accuracy: 74.87
Round  68, Global train loss: 0.416, Global test loss: 1.154, Global test accuracy: 63.05
Round  69, Train loss: 0.348, Test loss: 0.785, Test accuracy: 74.95
Round  69, Global train loss: 0.348, Global test loss: 1.246, Global test accuracy: 61.61
Round  70, Train loss: 0.366, Test loss: 0.809, Test accuracy: 74.58
Round  70, Global train loss: 0.366, Global test loss: 1.172, Global test accuracy: 63.47
Round  71, Train loss: 0.365, Test loss: 0.826, Test accuracy: 74.54
Round  71, Global train loss: 0.365, Global test loss: 1.132, Global test accuracy: 62.72
Round  72, Train loss: 0.417, Test loss: 0.816, Test accuracy: 74.58
Round  72, Global train loss: 0.417, Global test loss: 1.183, Global test accuracy: 62.95
Round  73, Train loss: 0.396, Test loss: 0.825, Test accuracy: 74.66
Round  73, Global train loss: 0.396, Global test loss: 1.089, Global test accuracy: 64.87
Round  74, Train loss: 0.323, Test loss: 0.816, Test accuracy: 75.01
Round  74, Global train loss: 0.323, Global test loss: 1.120, Global test accuracy: 66.10
Round  75, Train loss: 0.376, Test loss: 0.815, Test accuracy: 75.37
Round  75, Global train loss: 0.376, Global test loss: 1.009, Global test accuracy: 67.42
Round  76, Train loss: 0.365, Test loss: 0.824, Test accuracy: 75.36
Round  76, Global train loss: 0.365, Global test loss: 1.115, Global test accuracy: 64.97
Round  77, Train loss: 0.316, Test loss: 0.840, Test accuracy: 75.12
Round  77, Global train loss: 0.316, Global test loss: 1.179, Global test accuracy: 64.91
Round  78, Train loss: 0.292, Test loss: 0.824, Test accuracy: 75.30
Round  78, Global train loss: 0.292, Global test loss: 1.346, Global test accuracy: 62.33
Round  79, Train loss: 0.374, Test loss: 0.841, Test accuracy: 75.09
Round  79, Global train loss: 0.374, Global test loss: 1.100, Global test accuracy: 65.66
Round  80, Train loss: 0.358, Test loss: 0.864, Test accuracy: 74.82
Round  80, Global train loss: 0.358, Global test loss: 1.126, Global test accuracy: 65.52
Round  81, Train loss: 0.317, Test loss: 0.888, Test accuracy: 74.47
Round  81, Global train loss: 0.317, Global test loss: 1.127, Global test accuracy: 65.17
Round  82, Train loss: 0.340, Test loss: 0.884, Test accuracy: 74.48
Round  82, Global train loss: 0.340, Global test loss: 1.164, Global test accuracy: 65.69
Round  83, Train loss: 0.328, Test loss: 0.879, Test accuracy: 74.61
Round  83, Global train loss: 0.328, Global test loss: 1.266, Global test accuracy: 63.26
Round  84, Train loss: 0.307, Test loss: 0.886, Test accuracy: 74.65
Round  84, Global train loss: 0.307, Global test loss: 1.155, Global test accuracy: 66.05
Round  85, Train loss: 0.327, Test loss: 0.876, Test accuracy: 74.76
Round  85, Global train loss: 0.327, Global test loss: 1.333, Global test accuracy: 61.22
Round  86, Train loss: 0.300, Test loss: 0.880, Test accuracy: 74.80
Round  86, Global train loss: 0.300, Global test loss: 1.066, Global test accuracy: 67.87
Round  87, Train loss: 0.302, Test loss: 0.865, Test accuracy: 74.86
Round  87, Global train loss: 0.302, Global test loss: 1.222, Global test accuracy: 64.79
Round  88, Train loss: 0.345, Test loss: 0.849, Test accuracy: 74.86
Round  88, Global train loss: 0.345, Global test loss: 1.099, Global test accuracy: 65.81
Round  89, Train loss: 0.289, Test loss: 0.868, Test accuracy: 74.59
Round  89, Global train loss: 0.289, Global test loss: 1.147, Global test accuracy: 65.50
Round  90, Train loss: 0.290, Test loss: 0.857, Test accuracy: 75.07
Round  90, Global train loss: 0.290, Global test loss: 1.247, Global test accuracy: 64.06
Round  91, Train loss: 0.269, Test loss: 0.866, Test accuracy: 74.91
Round  91, Global train loss: 0.269, Global test loss: 1.109, Global test accuracy: 67.24
Round  92, Train loss: 0.312, Test loss: 0.872, Test accuracy: 75.04
Round  92, Global train loss: 0.312, Global test loss: 1.231, Global test accuracy: 64.64
Round  93, Train loss: 0.322, Test loss: 0.899, Test accuracy: 74.61
Round  93, Global train loss: 0.322, Global test loss: 1.217, Global test accuracy: 64.62
Round  94, Train loss: 0.312, Test loss: 0.904, Test accuracy: 74.93
Round  94, Global train loss: 0.312, Global test loss: 1.202, Global test accuracy: 65.09
Round  95, Train loss: 0.281, Test loss: 0.895, Test accuracy: 75.11
Round  95, Global train loss: 0.281, Global test loss: 1.335, Global test accuracy: 62.46
Round  96, Train loss: 0.269, Test loss: 0.886, Test accuracy: 75.61
Round  96, Global train loss: 0.269, Global test loss: 1.365, Global test accuracy: 62.61
Round  97, Train loss: 0.302, Test loss: 0.878, Test accuracy: 75.39
Round  97, Global train loss: 0.302, Global test loss: 1.166, Global test accuracy: 65.34
Round  98, Train loss: 0.277, Test loss: 0.893, Test accuracy: 74.99
Round  98, Global train loss: 0.277, Global test loss: 1.337, Global test accuracy: 63.13
Round  99, Train loss: 0.273, Test loss: 0.904, Test accuracy: 74.75
Round  99, Global train loss: 0.273, Global test loss: 1.211, Global test accuracy: 65.99
Final Round, Train loss: 0.225, Test loss: 0.951, Test accuracy: 75.65
Final Round, Global train loss: 0.225, Global test loss: 1.211, Global test accuracy: 65.99
Average accuracy final 10 rounds: 75.041
Average global accuracy final 10 rounds: 64.518
1645.0905158519745
[1.3657755851745605, 2.4842159748077393, 3.594167947769165, 4.718158006668091, 5.8413238525390625, 6.971047878265381, 8.101654767990112, 9.229213953018188, 10.360325813293457, 11.47071647644043, 12.696180820465088, 13.748193264007568, 14.799461841583252, 15.899418592453003, 17.001103162765503, 18.097575664520264, 19.19812560081482, 20.29738688468933, 21.39526891708374, 22.504504919052124, 23.45493483543396, 25.533336400985718, 27.60619878768921, 29.67437481880188, 31.74621081352234, 33.81853890419006, 35.89121150970459, 37.963534355163574, 40.037161350250244, 42.1091251373291, 44.18334078788757, 46.2644157409668, 48.34652352333069, 50.430883169174194, 52.50440239906311, 54.57601237297058, 56.6459321975708, 58.78884530067444, 61.14369773864746, 63.46114158630371, 65.9008162021637, 68.22907543182373, 70.43422746658325, 72.63008904457092, 74.83434700965881, 77.02690267562866, 79.26649928092957, 81.58454012870789, 83.88688278198242, 86.1706154346466, 88.51447629928589, 90.80430126190186, 93.11298727989197, 95.42737579345703, 97.70400643348694, 99.9504702091217, 102.24825191497803, 104.49709892272949, 106.76583313941956, 109.0361020565033, 111.42154836654663, 113.74521470069885, 116.0846951007843, 118.39853382110596, 120.70699191093445, 123.01395320892334, 125.29266405105591, 127.49655485153198, 129.6857316493988, 131.8882896900177, 134.0762116909027, 136.2734317779541, 138.49631524085999, 140.69917845726013, 142.88148307800293, 145.0896236896515, 147.26436471939087, 149.4773712158203, 151.7161340713501, 153.9225058555603, 156.1493878364563, 158.26786708831787, 160.4025285243988, 162.53176617622375, 164.6361563205719, 166.72874546051025, 168.8337254524231, 170.94918823242188, 173.05081009864807, 175.15681171417236, 177.28485083580017, 179.42712378501892, 181.53005385398865, 183.64044642448425, 185.75022649765015, 187.8850908279419, 190.00249075889587, 192.11417198181152, 194.2240605354309, 196.33207416534424, 198.49352025985718]
[22.21, 30.53, 39.77, 41.7, 44.74, 51.69, 55.15, 54.39, 54.81, 57.09, 58.42, 59.33, 59.9, 62.06, 62.62, 64.25, 64.87, 65.05, 65.91, 66.93, 67.33, 68.1, 67.91, 67.23, 67.44, 67.96, 68.28, 68.96, 69.56, 70.2, 70.28, 70.21, 70.65, 71.31, 71.21, 70.9, 71.24, 71.51, 72.02, 71.82, 71.6, 72.3, 71.16, 71.45, 71.93, 71.59, 71.33, 71.59, 71.58, 71.71, 72.53, 72.35, 72.94, 72.97, 72.71, 73.17, 73.57, 73.5, 73.76, 73.69, 73.97, 73.84, 73.78, 74.49, 74.91, 74.68, 74.52, 74.69, 74.87, 74.95, 74.58, 74.54, 74.58, 74.66, 75.01, 75.37, 75.36, 75.12, 75.3, 75.09, 74.82, 74.47, 74.48, 74.61, 74.65, 74.76, 74.8, 74.86, 74.86, 74.59, 75.07, 74.91, 75.04, 74.61, 74.93, 75.11, 75.61, 75.39, 74.99, 74.75, 75.65]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.454, Test loss: 1.256, Test accuracy: 47.13
Round   0, Global train loss: 1.454, Global test loss: 2.101, Global test accuracy: 29.98
Round   1, Train loss: 1.224, Test loss: 1.113, Test accuracy: 54.52
Round   1, Global train loss: 1.224, Global test loss: 1.804, Global test accuracy: 33.78
Round   2, Train loss: 1.083, Test loss: 1.045, Test accuracy: 58.01
Round   2, Global train loss: 1.083, Global test loss: 1.640, Global test accuracy: 39.03
Round   3, Train loss: 1.001, Test loss: 0.998, Test accuracy: 61.12
Round   3, Global train loss: 1.001, Global test loss: 1.516, Global test accuracy: 43.90
Round   4, Train loss: 0.941, Test loss: 0.995, Test accuracy: 61.64
Round   4, Global train loss: 0.941, Global test loss: 1.452, Global test accuracy: 45.93
Round   5, Train loss: 0.890, Test loss: 0.956, Test accuracy: 63.77
Round   5, Global train loss: 0.890, Global test loss: 1.399, Global test accuracy: 49.21
Round   6, Train loss: 0.836, Test loss: 0.978, Test accuracy: 63.37
Round   6, Global train loss: 0.836, Global test loss: 1.346, Global test accuracy: 51.03
Round   7, Train loss: 0.788, Test loss: 0.966, Test accuracy: 64.38
Round   7, Global train loss: 0.788, Global test loss: 1.290, Global test accuracy: 53.78
Round   8, Train loss: 0.748, Test loss: 0.921, Test accuracy: 66.41
Round   8, Global train loss: 0.748, Global test loss: 1.260, Global test accuracy: 54.54
Round   9, Train loss: 0.711, Test loss: 0.953, Test accuracy: 66.35
Round   9, Global train loss: 0.711, Global test loss: 1.224, Global test accuracy: 56.39
Round  10, Train loss: 0.654, Test loss: 0.948, Test accuracy: 66.98
Round  10, Global train loss: 0.654, Global test loss: 1.335, Global test accuracy: 53.04
Round  11, Train loss: 0.654, Test loss: 0.963, Test accuracy: 66.97
Round  11, Global train loss: 0.654, Global test loss: 1.533, Global test accuracy: 50.43
Round  12, Train loss: 0.622, Test loss: 0.948, Test accuracy: 67.23
Round  12, Global train loss: 0.622, Global test loss: 1.310, Global test accuracy: 54.67
Round  13, Train loss: 0.559, Test loss: 0.964, Test accuracy: 67.20
Round  13, Global train loss: 0.559, Global test loss: 1.494, Global test accuracy: 52.54
Round  14, Train loss: 0.584, Test loss: 0.957, Test accuracy: 67.27
Round  14, Global train loss: 0.584, Global test loss: 1.316, Global test accuracy: 56.35
Round  15, Train loss: 0.544, Test loss: 0.942, Test accuracy: 68.19
Round  15, Global train loss: 0.544, Global test loss: 1.303, Global test accuracy: 56.55
Round  16, Train loss: 0.490, Test loss: 0.961, Test accuracy: 68.35
Round  16, Global train loss: 0.490, Global test loss: 1.574, Global test accuracy: 53.03
Round  17, Train loss: 0.491, Test loss: 0.957, Test accuracy: 68.48
Round  17, Global train loss: 0.491, Global test loss: 1.222, Global test accuracy: 58.56
Round  18, Train loss: 0.510, Test loss: 0.944, Test accuracy: 68.98
Round  18, Global train loss: 0.510, Global test loss: 1.238, Global test accuracy: 57.98
Round  19, Train loss: 0.518, Test loss: 0.951, Test accuracy: 69.52
Round  19, Global train loss: 0.518, Global test loss: 1.198, Global test accuracy: 59.56
Round  20, Train loss: 0.419, Test loss: 0.953, Test accuracy: 69.80
Round  20, Global train loss: 0.419, Global test loss: 1.143, Global test accuracy: 62.38
Round  21, Train loss: 0.437, Test loss: 0.953, Test accuracy: 69.68
Round  21, Global train loss: 0.437, Global test loss: 1.150, Global test accuracy: 62.08
Round  22, Train loss: 0.441, Test loss: 0.954, Test accuracy: 70.02
Round  22, Global train loss: 0.441, Global test loss: 1.557, Global test accuracy: 52.18
Round  23, Train loss: 0.394, Test loss: 0.966, Test accuracy: 70.02
Round  23, Global train loss: 0.394, Global test loss: 1.427, Global test accuracy: 55.72
Round  24, Train loss: 0.375, Test loss: 0.960, Test accuracy: 70.20
Round  24, Global train loss: 0.375, Global test loss: 1.456, Global test accuracy: 59.28
Round  25, Train loss: 0.455, Test loss: 0.958, Test accuracy: 70.91
Round  25, Global train loss: 0.455, Global test loss: 1.163, Global test accuracy: 62.81
Round  26, Train loss: 0.366, Test loss: 0.969, Test accuracy: 70.76
Round  26, Global train loss: 0.366, Global test loss: 1.201, Global test accuracy: 62.48
Round  27, Train loss: 0.397, Test loss: 0.962, Test accuracy: 70.95
Round  27, Global train loss: 0.397, Global test loss: 1.501, Global test accuracy: 57.07
Round  28, Train loss: 0.403, Test loss: 0.980, Test accuracy: 71.20
Round  28, Global train loss: 0.403, Global test loss: 1.359, Global test accuracy: 58.33
Round  29, Train loss: 0.349, Test loss: 1.013, Test accuracy: 71.08
Round  29, Global train loss: 0.349, Global test loss: 1.371, Global test accuracy: 57.28
Round  30, Train loss: 0.360, Test loss: 0.991, Test accuracy: 71.41
Round  30, Global train loss: 0.360, Global test loss: 1.192, Global test accuracy: 62.49
Round  31, Train loss: 0.388, Test loss: 0.999, Test accuracy: 71.31
Round  31, Global train loss: 0.388, Global test loss: 1.190, Global test accuracy: 63.12
Round  32, Train loss: 0.313, Test loss: 0.995, Test accuracy: 71.42
Round  32, Global train loss: 0.313, Global test loss: 1.444, Global test accuracy: 59.99
Round  33, Train loss: 0.336, Test loss: 1.011, Test accuracy: 71.61
Round  33, Global train loss: 0.336, Global test loss: 1.322, Global test accuracy: 61.54
Round  34, Train loss: 0.320, Test loss: 1.003, Test accuracy: 72.00
Round  34, Global train loss: 0.320, Global test loss: 1.217, Global test accuracy: 63.82
Round  35, Train loss: 0.357, Test loss: 1.009, Test accuracy: 72.29
Round  35, Global train loss: 0.357, Global test loss: 1.654, Global test accuracy: 54.43
Round  36, Train loss: 0.313, Test loss: 1.016, Test accuracy: 72.82
Round  36, Global train loss: 0.313, Global test loss: 1.467, Global test accuracy: 58.76
Round  37, Train loss: 0.305, Test loss: 1.027, Test accuracy: 72.62
Round  37, Global train loss: 0.305, Global test loss: 1.327, Global test accuracy: 63.18
Round  38, Train loss: 0.296, Test loss: 1.019, Test accuracy: 72.54
Round  38, Global train loss: 0.296, Global test loss: 1.516, Global test accuracy: 58.73
Round  39, Train loss: 0.264, Test loss: 1.018, Test accuracy: 72.83
Round  39, Global train loss: 0.264, Global test loss: 1.497, Global test accuracy: 60.95
Round  40, Train loss: 0.339, Test loss: 1.002, Test accuracy: 73.31
Round  40, Global train loss: 0.339, Global test loss: 1.302, Global test accuracy: 61.56
Round  41, Train loss: 0.307, Test loss: 1.015, Test accuracy: 73.28
Round  41, Global train loss: 0.307, Global test loss: 1.185, Global test accuracy: 64.54
Round  42, Train loss: 0.256, Test loss: 1.016, Test accuracy: 73.42
Round  42, Global train loss: 0.256, Global test loss: 1.821, Global test accuracy: 55.78
Round  43, Train loss: 0.271, Test loss: 1.037, Test accuracy: 73.38
Round  43, Global train loss: 0.271, Global test loss: 1.368, Global test accuracy: 63.06
Round  44, Train loss: 0.262, Test loss: 1.001, Test accuracy: 73.91
Round  44, Global train loss: 0.262, Global test loss: 1.383, Global test accuracy: 62.20
Round  45, Train loss: 0.275, Test loss: 1.000, Test accuracy: 73.91
Round  45, Global train loss: 0.275, Global test loss: 1.346, Global test accuracy: 62.31
Round  46, Train loss: 0.240, Test loss: 1.039, Test accuracy: 73.28
Round  46, Global train loss: 0.240, Global test loss: 1.536, Global test accuracy: 60.80
Round  47, Train loss: 0.257, Test loss: 1.063, Test accuracy: 73.38
Round  47, Global train loss: 0.257, Global test loss: 1.232, Global test accuracy: 64.99
Round  48, Train loss: 0.218, Test loss: 1.055, Test accuracy: 73.57
Round  48, Global train loss: 0.218, Global test loss: 1.481, Global test accuracy: 62.74
Round  49, Train loss: 0.307, Test loss: 1.072, Test accuracy: 73.49
Round  49, Global train loss: 0.307, Global test loss: 1.374, Global test accuracy: 61.24
Round  50, Train loss: 0.254, Test loss: 1.077, Test accuracy: 73.54
Round  50, Global train loss: 0.254, Global test loss: 1.449, Global test accuracy: 60.44
Round  51, Train loss: 0.261, Test loss: 1.086, Test accuracy: 73.77
Round  51, Global train loss: 0.261, Global test loss: 1.324, Global test accuracy: 62.51
Round  52, Train loss: 0.223, Test loss: 1.084, Test accuracy: 73.86
Round  52, Global train loss: 0.223, Global test loss: 1.340, Global test accuracy: 63.13
Round  53, Train loss: 0.220, Test loss: 1.077, Test accuracy: 74.10
Round  53, Global train loss: 0.220, Global test loss: 1.361, Global test accuracy: 64.82
Round  54, Train loss: 0.212, Test loss: 1.062, Test accuracy: 74.02
Round  54, Global train loss: 0.212, Global test loss: 1.340, Global test accuracy: 64.84
Round  55, Train loss: 0.202, Test loss: 1.065, Test accuracy: 73.92
Round  55, Global train loss: 0.202, Global test loss: 1.352, Global test accuracy: 64.06
Round  56, Train loss: 0.234, Test loss: 1.067, Test accuracy: 73.66
Round  56, Global train loss: 0.234, Global test loss: 1.566, Global test accuracy: 60.40
Round  57, Train loss: 0.241, Test loss: 1.059, Test accuracy: 74.02
Round  57, Global train loss: 0.241, Global test loss: 1.445, Global test accuracy: 62.39
Round  58, Train loss: 0.215, Test loss: 1.060, Test accuracy: 73.94
Round  58, Global train loss: 0.215, Global test loss: 1.493, Global test accuracy: 61.37
Round  59, Train loss: 0.228, Test loss: 1.077, Test accuracy: 74.31
Round  59, Global train loss: 0.228, Global test loss: 1.289, Global test accuracy: 64.40
Round  60, Train loss: 0.193, Test loss: 1.075, Test accuracy: 74.34
Round  60, Global train loss: 0.193, Global test loss: 1.396, Global test accuracy: 63.40
Round  61, Train loss: 0.245, Test loss: 1.081, Test accuracy: 74.42
Round  61, Global train loss: 0.245, Global test loss: 1.433, Global test accuracy: 61.70
Round  62, Train loss: 0.202, Test loss: 1.056, Test accuracy: 74.63
Round  62, Global train loss: 0.202, Global test loss: 1.539, Global test accuracy: 60.80
Round  63, Train loss: 0.185, Test loss: 1.048, Test accuracy: 74.45
Round  63, Global train loss: 0.185, Global test loss: 1.317, Global test accuracy: 65.03
Round  64, Train loss: 0.240, Test loss: 1.081, Test accuracy: 74.09
Round  64, Global train loss: 0.240, Global test loss: 1.392, Global test accuracy: 64.27
Round  65, Train loss: 0.202, Test loss: 1.081, Test accuracy: 74.27
Round  65, Global train loss: 0.202, Global test loss: 1.590, Global test accuracy: 60.95
Round  66, Train loss: 0.191, Test loss: 1.086, Test accuracy: 74.49
Round  66, Global train loss: 0.191, Global test loss: 1.516, Global test accuracy: 62.80
Round  67, Train loss: 0.174, Test loss: 1.077, Test accuracy: 74.49
Round  67, Global train loss: 0.174, Global test loss: 1.413, Global test accuracy: 65.45
Round  68, Train loss: 0.188, Test loss: 1.062, Test accuracy: 74.63
Round  68, Global train loss: 0.188, Global test loss: 1.476, Global test accuracy: 63.00
Round  69, Train loss: 0.176, Test loss: 1.076, Test accuracy: 74.38
Round  69, Global train loss: 0.176, Global test loss: 1.633, Global test accuracy: 61.56
Round  70, Train loss: 0.168, Test loss: 1.076, Test accuracy: 74.17
Round  70, Global train loss: 0.168, Global test loss: 1.329, Global test accuracy: 64.33
Round  71, Train loss: 0.183, Test loss: 1.102, Test accuracy: 74.01
Round  71, Global train loss: 0.183, Global test loss: 1.549, Global test accuracy: 60.86
Round  72, Train loss: 0.208, Test loss: 1.110, Test accuracy: 74.39
Round  72, Global train loss: 0.208, Global test loss: 1.447, Global test accuracy: 63.15
Round  73, Train loss: 0.178, Test loss: 1.081, Test accuracy: 75.04
Round  73, Global train loss: 0.178, Global test loss: 1.304, Global test accuracy: 67.07
Round  74, Train loss: 0.179, Test loss: 1.085, Test accuracy: 74.41
Round  74, Global train loss: 0.179, Global test loss: 1.471, Global test accuracy: 63.05
Round  75, Train loss: 0.183, Test loss: 1.078, Test accuracy: 74.84
Round  75, Global train loss: 0.183, Global test loss: 1.315, Global test accuracy: 65.35
Round  76, Train loss: 0.173, Test loss: 1.102, Test accuracy: 74.73
Round  76, Global train loss: 0.173, Global test loss: 1.329, Global test accuracy: 66.01
Round  77, Train loss: 0.183, Test loss: 1.102, Test accuracy: 74.51
Round  77, Global train loss: 0.183, Global test loss: 1.503, Global test accuracy: 63.90
Round  78, Train loss: 0.159, Test loss: 1.090, Test accuracy: 74.95
Round  78, Global train loss: 0.159, Global test loss: 1.545, Global test accuracy: 61.93
Round  79, Train loss: 0.164, Test loss: 1.111, Test accuracy: 74.37
Round  79, Global train loss: 0.164, Global test loss: 1.486, Global test accuracy: 62.29
Round  80, Train loss: 0.136, Test loss: 1.131, Test accuracy: 74.17
Round  80, Global train loss: 0.136, Global test loss: 1.435, Global test accuracy: 64.83
Round  81, Train loss: 0.124, Test loss: 1.145, Test accuracy: 74.36
Round  81, Global train loss: 0.124, Global test loss: 1.513, Global test accuracy: 64.90
Round  82, Train loss: 0.116, Test loss: 1.126, Test accuracy: 74.71
Round  82, Global train loss: 0.116, Global test loss: 1.537, Global test accuracy: 64.47
Round  83, Train loss: 0.117, Test loss: 1.141, Test accuracy: 74.33
Round  83, Global train loss: 0.117, Global test loss: 1.497, Global test accuracy: 65.17
Round  84, Train loss: 0.108, Test loss: 1.132, Test accuracy: 74.99
Round  84, Global train loss: 0.108, Global test loss: 1.570, Global test accuracy: 64.91
Round  85, Train loss: 0.107, Test loss: 1.172, Test accuracy: 74.04
Round  85, Global train loss: 0.107, Global test loss: 1.513, Global test accuracy: 65.37
Round  86, Train loss: 0.105, Test loss: 1.157, Test accuracy: 74.31
Round  86, Global train loss: 0.105, Global test loss: 1.601, Global test accuracy: 64.99
Round  87, Train loss: 0.104, Test loss: 1.174, Test accuracy: 74.39
Round  87, Global train loss: 0.104, Global test loss: 1.564, Global test accuracy: 65.14
Round  88, Train loss: 0.098, Test loss: 1.157, Test accuracy: 74.68
Round  88, Global train loss: 0.098, Global test loss: 1.600, Global test accuracy: 64.89
Round  89, Train loss: 0.093, Test loss: 1.165, Test accuracy: 74.59
Round  89, Global train loss: 0.093, Global test loss: 1.601, Global test accuracy: 65.39
Round  90, Train loss: 0.178, Test loss: 1.175, Test accuracy: 75.24
Round  90, Global train loss: 0.178, Global test loss: 1.276, Global test accuracy: 68.04
Round  91, Train loss: 0.162, Test loss: 1.170, Test accuracy: 74.74
Round  91, Global train loss: 0.162, Global test loss: 1.250, Global test accuracy: 68.42
Round  92, Train loss: 0.153, Test loss: 1.153, Test accuracy: 75.35
Round  92, Global train loss: 0.153, Global test loss: 1.241, Global test accuracy: 68.97
Round  93, Train loss: 0.149, Test loss: 1.195, Test accuracy: 74.69
Round  93, Global train loss: 0.149, Global test loss: 1.238, Global test accuracy: 68.58
Round  94, Train loss: 0.147, Test loss: 1.099, Test accuracy: 75.60
Round  94, Global train loss: 0.147, Global test loss: 1.245, Global test accuracy: 68.84
Round  95, Train loss: 0.145, Test loss: 1.198, Test accuracy: 74.79
Round  95, Global train loss: 0.145, Global test loss: 1.242, Global test accuracy: 68.40
Round  96, Train loss: 0.142, Test loss: 1.161, Test accuracy: 75.23
Round  96, Global train loss: 0.142, Global test loss: 1.257, Global test accuracy: 68.33
Round  97, Train loss: 0.140, Test loss: 1.156, Test accuracy: 75.31
Round  97, Global train loss: 0.140, Global test loss: 1.243, Global test accuracy: 68.17
Round  98, Train loss: 0.141, Test loss: 1.150, Test accuracy: 75.39
Round  98, Global train loss: 0.141, Global test loss: 1.260, Global test accuracy: 68.10
Round  99, Train loss: 0.136, Test loss: 1.141, Test accuracy: 75.52
Round  99, Global train loss: 0.136, Global test loss: 1.239, Global test accuracy: 68.51
Final Round, Train loss: 0.105, Test loss: 1.268, Test accuracy: 75.26
Final Round, Global train loss: 0.105, Global test loss: 1.239, Global test accuracy: 68.51
Average accuracy final 10 rounds: 75.186
Average global accuracy final 10 rounds: 68.436
2274.070975780487
[2.486670732498169, 4.657726764678955, 6.6098504066467285, 8.526490926742554, 10.457314491271973, 12.38393259048462, 14.38149094581604, 16.318898916244507, 18.276522636413574, 20.26689577102661, 22.23362922668457, 24.20818543434143, 26.145925283432007, 28.076730251312256, 29.98992681503296, 31.91434597969055, 33.85702466964722, 35.78001618385315, 37.73217439651489, 39.660374879837036, 41.58204650878906, 43.49002003669739, 45.40951681137085, 47.322792530059814, 49.2672598361969, 51.18499302864075, 53.109867095947266, 55.03854751586914, 56.95641016960144, 58.86942005157471, 60.801350593566895, 62.72696805000305, 64.64935207366943, 66.57945466041565, 68.4978575706482, 70.43075823783875, 72.3574275970459, 74.2847170829773, 76.21572804450989, 78.14722919464111, 80.09876489639282, 82.01529741287231, 83.96160340309143, 85.87832880020142, 87.79507374763489, 89.70356726646423, 91.64900636672974, 93.5579195022583, 95.48357224464417, 97.42324471473694, 99.34582829475403, 101.2954728603363, 103.21635174751282, 105.13573694229126, 107.0900936126709, 109.00721788406372, 110.96652150154114, 112.88624715805054, 114.82675313949585, 116.74599385261536, 118.64708185195923, 120.58645033836365, 122.50788593292236, 124.45107078552246, 126.39717197418213, 128.32161283493042, 130.2440140247345, 132.17722082138062, 134.14447569847107, 136.06606125831604, 137.98507976531982, 139.90029644966125, 141.82070517539978, 143.7323396205902, 145.65350222587585, 147.57404732704163, 149.51510763168335, 151.4386110305786, 153.37972736358643, 155.32130098342896, 157.2532877922058, 159.2082679271698, 161.13568258285522, 163.07445883750916, 165.03859210014343, 166.96841979026794, 168.90140080451965, 170.8412413597107, 172.76652193069458, 174.69899606704712, 176.680739402771, 178.6221055984497, 180.60108280181885, 182.54875540733337, 184.51028299331665, 186.43691778182983, 188.3603196144104, 190.29693746566772, 192.21079325675964, 194.13413071632385, 198.004643201828]
[47.13, 54.52, 58.01, 61.12, 61.64, 63.77, 63.37, 64.38, 66.41, 66.35, 66.98, 66.97, 67.23, 67.2, 67.27, 68.19, 68.35, 68.48, 68.98, 69.52, 69.8, 69.68, 70.02, 70.02, 70.2, 70.91, 70.76, 70.95, 71.2, 71.08, 71.41, 71.31, 71.42, 71.61, 72.0, 72.29, 72.82, 72.62, 72.54, 72.83, 73.31, 73.28, 73.42, 73.38, 73.91, 73.91, 73.28, 73.38, 73.57, 73.49, 73.54, 73.77, 73.86, 74.1, 74.02, 73.92, 73.66, 74.02, 73.94, 74.31, 74.34, 74.42, 74.63, 74.45, 74.09, 74.27, 74.49, 74.49, 74.63, 74.38, 74.17, 74.01, 74.39, 75.04, 74.41, 74.84, 74.73, 74.51, 74.95, 74.37, 74.17, 74.36, 74.71, 74.33, 74.99, 74.04, 74.31, 74.39, 74.68, 74.59, 75.24, 74.74, 75.35, 74.69, 75.6, 74.79, 75.23, 75.31, 75.39, 75.52, 75.26]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.469, Test loss: 1.246, Test accuracy: 47.14
Round   0, Global train loss: 1.469, Global test loss: 2.090, Global test accuracy: 29.72
Round   1, Train loss: 1.233, Test loss: 1.107, Test accuracy: 55.71
Round   1, Global train loss: 1.233, Global test loss: 1.834, Global test accuracy: 33.03
Round   2, Train loss: 1.098, Test loss: 1.042, Test accuracy: 58.51
Round   2, Global train loss: 1.098, Global test loss: 1.669, Global test accuracy: 38.01
Round   3, Train loss: 1.012, Test loss: 1.003, Test accuracy: 61.02
Round   3, Global train loss: 1.012, Global test loss: 1.547, Global test accuracy: 42.59
Round   4, Train loss: 0.944, Test loss: 1.014, Test accuracy: 60.50
Round   4, Global train loss: 0.944, Global test loss: 1.455, Global test accuracy: 46.79
Round   5, Train loss: 0.884, Test loss: 0.966, Test accuracy: 63.00
Round   5, Global train loss: 0.884, Global test loss: 1.402, Global test accuracy: 48.52
Round   6, Train loss: 0.833, Test loss: 0.926, Test accuracy: 65.31
Round   6, Global train loss: 0.833, Global test loss: 1.338, Global test accuracy: 50.77
Round   7, Train loss: 0.789, Test loss: 0.916, Test accuracy: 65.58
Round   7, Global train loss: 0.789, Global test loss: 1.276, Global test accuracy: 53.61
Round   8, Train loss: 0.746, Test loss: 0.969, Test accuracy: 64.63
Round   8, Global train loss: 0.746, Global test loss: 1.236, Global test accuracy: 55.34
Round   9, Train loss: 0.709, Test loss: 0.919, Test accuracy: 66.10
Round   9, Global train loss: 0.709, Global test loss: 1.211, Global test accuracy: 56.58
Round  10, Train loss: 0.678, Test loss: 0.915, Test accuracy: 66.30
Round  10, Global train loss: 0.678, Global test loss: 1.342, Global test accuracy: 52.63
Round  11, Train loss: 0.655, Test loss: 0.918, Test accuracy: 66.68
Round  11, Global train loss: 0.655, Global test loss: 1.336, Global test accuracy: 52.35
Round  12, Train loss: 0.642, Test loss: 0.905, Test accuracy: 67.17
Round  12, Global train loss: 0.642, Global test loss: 1.598, Global test accuracy: 49.94
Round  13, Train loss: 0.600, Test loss: 0.918, Test accuracy: 67.10
Round  13, Global train loss: 0.600, Global test loss: 1.270, Global test accuracy: 55.71
Round  14, Train loss: 0.604, Test loss: 0.906, Test accuracy: 67.61
Round  14, Global train loss: 0.604, Global test loss: 1.364, Global test accuracy: 53.70
Round  15, Train loss: 0.584, Test loss: 0.905, Test accuracy: 68.27
Round  15, Global train loss: 0.584, Global test loss: 1.229, Global test accuracy: 57.41
Round  16, Train loss: 0.509, Test loss: 0.913, Test accuracy: 68.83
Round  16, Global train loss: 0.509, Global test loss: 1.456, Global test accuracy: 53.27
Round  17, Train loss: 0.517, Test loss: 0.917, Test accuracy: 69.19
Round  17, Global train loss: 0.517, Global test loss: 1.360, Global test accuracy: 58.25
Round  18, Train loss: 0.477, Test loss: 0.939, Test accuracy: 68.86
Round  18, Global train loss: 0.477, Global test loss: 1.267, Global test accuracy: 57.79
Round  19, Train loss: 0.458, Test loss: 0.944, Test accuracy: 69.27
Round  19, Global train loss: 0.458, Global test loss: 1.633, Global test accuracy: 54.18
Round  20, Train loss: 0.479, Test loss: 0.939, Test accuracy: 69.78
Round  20, Global train loss: 0.479, Global test loss: 1.387, Global test accuracy: 56.60
Round  21, Train loss: 0.402, Test loss: 0.952, Test accuracy: 69.84
Round  21, Global train loss: 0.402, Global test loss: 1.279, Global test accuracy: 59.48
Round  22, Train loss: 0.403, Test loss: 0.942, Test accuracy: 70.08
Round  22, Global train loss: 0.403, Global test loss: 1.602, Global test accuracy: 54.03
Round  23, Train loss: 0.444, Test loss: 0.945, Test accuracy: 70.63
Round  23, Global train loss: 0.444, Global test loss: 1.278, Global test accuracy: 57.66
Round  24, Train loss: 0.441, Test loss: 0.933, Test accuracy: 71.28
Round  24, Global train loss: 0.441, Global test loss: 1.246, Global test accuracy: 60.48
Round  25, Train loss: 0.401, Test loss: 0.950, Test accuracy: 71.42
Round  25, Global train loss: 0.401, Global test loss: 1.229, Global test accuracy: 59.70
Round  26, Train loss: 0.353, Test loss: 0.928, Test accuracy: 72.07
Round  26, Global train loss: 0.353, Global test loss: 1.482, Global test accuracy: 57.52
Round  27, Train loss: 0.364, Test loss: 0.949, Test accuracy: 71.76
Round  27, Global train loss: 0.364, Global test loss: 1.326, Global test accuracy: 59.89
Round  28, Train loss: 0.352, Test loss: 0.956, Test accuracy: 72.05
Round  28, Global train loss: 0.352, Global test loss: 1.368, Global test accuracy: 58.79
Round  29, Train loss: 0.314, Test loss: 0.947, Test accuracy: 72.01
Round  29, Global train loss: 0.314, Global test loss: 1.338, Global test accuracy: 59.57
Round  30, Train loss: 0.281, Test loss: 0.964, Test accuracy: 72.09
Round  30, Global train loss: 0.281, Global test loss: 1.492, Global test accuracy: 59.26
Round  31, Train loss: 0.344, Test loss: 0.944, Test accuracy: 72.47
Round  31, Global train loss: 0.344, Global test loss: 1.338, Global test accuracy: 59.89
Round  32, Train loss: 0.355, Test loss: 0.953, Test accuracy: 72.65
Round  32, Global train loss: 0.355, Global test loss: 1.316, Global test accuracy: 58.81
Round  33, Train loss: 0.345, Test loss: 0.971, Test accuracy: 73.16
Round  33, Global train loss: 0.345, Global test loss: 1.393, Global test accuracy: 58.43
Round  34, Train loss: 0.290, Test loss: 0.994, Test accuracy: 73.21
Round  34, Global train loss: 0.290, Global test loss: 1.390, Global test accuracy: 61.33
Round  35, Train loss: 0.296, Test loss: 0.997, Test accuracy: 72.95
Round  35, Global train loss: 0.296, Global test loss: 1.369, Global test accuracy: 61.95
Round  36, Train loss: 0.300, Test loss: 1.021, Test accuracy: 72.93
Round  36, Global train loss: 0.300, Global test loss: 1.357, Global test accuracy: 60.75
Round  37, Train loss: 0.333, Test loss: 1.018, Test accuracy: 72.84
Round  37, Global train loss: 0.333, Global test loss: 1.357, Global test accuracy: 60.46
Round  38, Train loss: 0.273, Test loss: 1.041, Test accuracy: 72.72
Round  38, Global train loss: 0.273, Global test loss: 1.146, Global test accuracy: 65.38
Round  39, Train loss: 0.295, Test loss: 1.027, Test accuracy: 73.15
Round  39, Global train loss: 0.295, Global test loss: 1.341, Global test accuracy: 62.90
Round  40, Train loss: 0.265, Test loss: 1.028, Test accuracy: 73.54
Round  40, Global train loss: 0.265, Global test loss: 1.431, Global test accuracy: 61.11
Round  41, Train loss: 0.234, Test loss: 1.056, Test accuracy: 73.26
Round  41, Global train loss: 0.234, Global test loss: 1.551, Global test accuracy: 59.35
Round  42, Train loss: 0.241, Test loss: 1.053, Test accuracy: 73.40
Round  42, Global train loss: 0.241, Global test loss: 1.510, Global test accuracy: 61.07
Round  43, Train loss: 0.259, Test loss: 1.051, Test accuracy: 73.41
Round  43, Global train loss: 0.259, Global test loss: 1.283, Global test accuracy: 63.48
Round  44, Train loss: 0.252, Test loss: 1.029, Test accuracy: 73.28
Round  44, Global train loss: 0.252, Global test loss: 1.306, Global test accuracy: 63.15
Round  45, Train loss: 0.256, Test loss: 1.049, Test accuracy: 73.28
Round  45, Global train loss: 0.256, Global test loss: 1.416, Global test accuracy: 61.02
Round  46, Train loss: 0.236, Test loss: 1.079, Test accuracy: 73.25
Round  46, Global train loss: 0.236, Global test loss: 1.636, Global test accuracy: 59.44
Round  47, Train loss: 0.233, Test loss: 1.074, Test accuracy: 72.98
Round  47, Global train loss: 0.233, Global test loss: 1.575, Global test accuracy: 59.55
Round  48, Train loss: 0.250, Test loss: 1.084, Test accuracy: 73.26
Round  48, Global train loss: 0.250, Global test loss: 1.571, Global test accuracy: 60.08
Round  49, Train loss: 0.238, Test loss: 1.087, Test accuracy: 73.13
Round  49, Global train loss: 0.238, Global test loss: 1.488, Global test accuracy: 61.05
Round  50, Train loss: 0.235, Test loss: 1.084, Test accuracy: 73.61
Round  50, Global train loss: 0.235, Global test loss: 1.664, Global test accuracy: 59.69
Round  51, Train loss: 0.243, Test loss: 1.081, Test accuracy: 73.64
Round  51, Global train loss: 0.243, Global test loss: 1.385, Global test accuracy: 63.63
Round  52, Train loss: 0.238, Test loss: 1.059, Test accuracy: 73.95
Round  52, Global train loss: 0.238, Global test loss: 1.377, Global test accuracy: 62.55
Round  53, Train loss: 0.261, Test loss: 1.046, Test accuracy: 74.19
Round  53, Global train loss: 0.261, Global test loss: 1.554, Global test accuracy: 59.14
Round  54, Train loss: 0.230, Test loss: 1.038, Test accuracy: 74.47
Round  54, Global train loss: 0.230, Global test loss: 1.322, Global test accuracy: 63.16
Round  55, Train loss: 0.229, Test loss: 1.058, Test accuracy: 74.30
Round  55, Global train loss: 0.229, Global test loss: 1.268, Global test accuracy: 63.91
Round  56, Train loss: 0.182, Test loss: 1.076, Test accuracy: 74.05
Round  56, Global train loss: 0.182, Global test loss: 1.456, Global test accuracy: 61.22
Round  57, Train loss: 0.232, Test loss: 1.093, Test accuracy: 74.00
Round  57, Global train loss: 0.232, Global test loss: 1.399, Global test accuracy: 62.65
Round  58, Train loss: 0.197, Test loss: 1.041, Test accuracy: 74.58
Round  58, Global train loss: 0.197, Global test loss: 1.516, Global test accuracy: 61.89
Round  59, Train loss: 0.236, Test loss: 1.033, Test accuracy: 74.52
Round  59, Global train loss: 0.236, Global test loss: 1.302, Global test accuracy: 64.83
Round  60, Train loss: 0.204, Test loss: 1.048, Test accuracy: 74.25
Round  60, Global train loss: 0.204, Global test loss: 1.317, Global test accuracy: 63.73
Round  61, Train loss: 0.196, Test loss: 1.054, Test accuracy: 74.42
Round  61, Global train loss: 0.196, Global test loss: 1.318, Global test accuracy: 63.61
Round  62, Train loss: 0.204, Test loss: 1.041, Test accuracy: 74.83
Round  62, Global train loss: 0.204, Global test loss: 1.307, Global test accuracy: 64.71
Round  63, Train loss: 0.175, Test loss: 1.036, Test accuracy: 75.06
Round  63, Global train loss: 0.175, Global test loss: 1.775, Global test accuracy: 58.84
Round  64, Train loss: 0.171, Test loss: 1.071, Test accuracy: 74.74
Round  64, Global train loss: 0.171, Global test loss: 1.598, Global test accuracy: 60.83
Round  65, Train loss: 0.226, Test loss: 1.083, Test accuracy: 74.73
Round  65, Global train loss: 0.226, Global test loss: 1.640, Global test accuracy: 59.78
Round  66, Train loss: 0.187, Test loss: 1.108, Test accuracy: 74.50
Round  66, Global train loss: 0.187, Global test loss: 1.480, Global test accuracy: 63.12
Round  67, Train loss: 0.229, Test loss: 1.101, Test accuracy: 74.72
Round  67, Global train loss: 0.229, Global test loss: 1.557, Global test accuracy: 60.16
Round  68, Train loss: 0.174, Test loss: 1.106, Test accuracy: 74.60
Round  68, Global train loss: 0.174, Global test loss: 1.293, Global test accuracy: 64.39
Round  69, Train loss: 0.185, Test loss: 1.094, Test accuracy: 74.53
Round  69, Global train loss: 0.185, Global test loss: 1.536, Global test accuracy: 62.31
Round  70, Train loss: 0.235, Test loss: 1.094, Test accuracy: 74.54
Round  70, Global train loss: 0.235, Global test loss: 1.421, Global test accuracy: 62.64
Round  71, Train loss: 0.188, Test loss: 1.091, Test accuracy: 74.63
Round  71, Global train loss: 0.188, Global test loss: 1.395, Global test accuracy: 64.53
Round  72, Train loss: 0.171, Test loss: 1.089, Test accuracy: 74.77
Round  72, Global train loss: 0.171, Global test loss: 1.325, Global test accuracy: 65.01
Round  73, Train loss: 0.184, Test loss: 1.113, Test accuracy: 74.55
Round  73, Global train loss: 0.184, Global test loss: 1.682, Global test accuracy: 60.63
Round  74, Train loss: 0.174, Test loss: 1.109, Test accuracy: 74.82
Round  74, Global train loss: 0.174, Global test loss: 1.525, Global test accuracy: 62.45
Round  75, Train loss: 0.209, Test loss: 1.108, Test accuracy: 74.88
Round  75, Global train loss: 0.209, Global test loss: 1.478, Global test accuracy: 61.67
Round  76, Train loss: 0.189, Test loss: 1.132, Test accuracy: 74.63
Round  76, Global train loss: 0.189, Global test loss: 1.622, Global test accuracy: 61.01
Round  77, Train loss: 0.156, Test loss: 1.124, Test accuracy: 74.92
Round  77, Global train loss: 0.156, Global test loss: 1.402, Global test accuracy: 65.26
Round  78, Train loss: 0.182, Test loss: 1.132, Test accuracy: 75.10
Round  78, Global train loss: 0.182, Global test loss: 1.329, Global test accuracy: 66.00
Round  79, Train loss: 0.157, Test loss: 1.102, Test accuracy: 75.77
Round  79, Global train loss: 0.157, Global test loss: 1.506, Global test accuracy: 63.04
Round  80, Train loss: 0.128, Test loss: 1.121, Test accuracy: 75.46
Round  80, Global train loss: 0.128, Global test loss: 1.420, Global test accuracy: 65.25
Round  81, Train loss: 0.118, Test loss: 1.128, Test accuracy: 74.87
Round  81, Global train loss: 0.118, Global test loss: 1.443, Global test accuracy: 65.14
Round  82, Train loss: 0.123, Test loss: 1.107, Test accuracy: 75.95
Round  82, Global train loss: 0.123, Global test loss: 1.449, Global test accuracy: 65.36
Round  83, Train loss: 0.115, Test loss: 1.145, Test accuracy: 75.13
Round  83, Global train loss: 0.115, Global test loss: 1.457, Global test accuracy: 65.15
Round  84, Train loss: 0.110, Test loss: 1.152, Test accuracy: 75.29
Round  84, Global train loss: 0.110, Global test loss: 1.446, Global test accuracy: 65.22
Round  85, Train loss: 0.108, Test loss: 1.152, Test accuracy: 75.13
Round  85, Global train loss: 0.108, Global test loss: 1.406, Global test accuracy: 65.43
Round  86, Train loss: 0.100, Test loss: 1.159, Test accuracy: 75.60
Round  86, Global train loss: 0.100, Global test loss: 1.490, Global test accuracy: 65.09
Round  87, Train loss: 0.097, Test loss: 1.165, Test accuracy: 75.05
Round  87, Global train loss: 0.097, Global test loss: 1.481, Global test accuracy: 64.85
Round  88, Train loss: 0.091, Test loss: 1.172, Test accuracy: 75.71
Round  88, Global train loss: 0.091, Global test loss: 1.557, Global test accuracy: 64.46
Round  89, Train loss: 0.098, Test loss: 1.161, Test accuracy: 75.48
Round  89, Global train loss: 0.098, Global test loss: 1.534, Global test accuracy: 64.78
Round  90, Train loss: 0.172, Test loss: 1.178, Test accuracy: 74.69
Round  90, Global train loss: 0.172, Global test loss: 1.278, Global test accuracy: 67.62
Round  91, Train loss: 0.154, Test loss: 1.157, Test accuracy: 75.36
Round  91, Global train loss: 0.154, Global test loss: 1.265, Global test accuracy: 67.97
Round  92, Train loss: 0.152, Test loss: 1.179, Test accuracy: 75.16
Round  92, Global train loss: 0.152, Global test loss: 1.255, Global test accuracy: 67.76
Round  93, Train loss: 0.147, Test loss: 1.130, Test accuracy: 75.47
Round  93, Global train loss: 0.147, Global test loss: 1.267, Global test accuracy: 67.83
Round  94, Train loss: 0.138, Test loss: 1.181, Test accuracy: 75.01
Round  94, Global train loss: 0.138, Global test loss: 1.290, Global test accuracy: 68.04
Round  95, Train loss: 0.143, Test loss: 1.234, Test accuracy: 74.07
Round  95, Global train loss: 0.143, Global test loss: 1.283, Global test accuracy: 67.64
Round  96, Train loss: 0.134, Test loss: 1.174, Test accuracy: 75.22
Round  96, Global train loss: 0.134, Global test loss: 1.284, Global test accuracy: 68.29
Round  97, Train loss: 0.136, Test loss: 1.202, Test accuracy: 74.94
Round  97, Global train loss: 0.136, Global test loss: 1.293, Global test accuracy: 68.29
Round  98, Train loss: 0.132, Test loss: 1.159, Test accuracy: 76.09
Round  98, Global train loss: 0.132, Global test loss: 1.305, Global test accuracy: 68.18
Round  99, Train loss: 0.132, Test loss: 1.157, Test accuracy: 76.05
Round  99, Global train loss: 0.132, Global test loss: 1.308, Global test accuracy: 68.01
Final Round, Train loss: 0.102, Test loss: 1.308, Test accuracy: 74.95
Final Round, Global train loss: 0.102, Global test loss: 1.308, Global test accuracy: 68.01
Average accuracy final 10 rounds: 75.206
Average global accuracy final 10 rounds: 67.96300000000001
3722.8710532188416
[2.4884347915649414, 4.615693807601929, 6.51803994178772, 8.422884225845337, 10.320487022399902, 12.230346918106079, 14.141546726226807, 16.045329809188843, 17.950072050094604, 19.868837594985962, 21.772061109542847, 23.682390928268433, 25.584644079208374, 27.490281581878662, 29.39157223701477, 31.307905912399292, 33.22255086898804, 35.13955473899841, 37.06129026412964, 38.98093390464783, 40.912583351135254, 45.069316148757935, 49.21702861785889, 53.33409142494202, 57.47178792953491, 61.8467972278595, 66.25488591194153, 70.43552303314209, 74.78385758399963, 79.1352105140686, 83.50043940544128, 87.68110203742981, 91.78954696655273, 95.89549207687378, 100.00093698501587, 104.1104667186737, 108.22598934173584, 112.33671283721924, 116.43728232383728, 120.5349190235138, 124.63523840904236, 128.73745322227478, 132.83782315254211, 137.05745434761047, 141.4238612651825, 145.77329397201538, 149.92279529571533, 154.09033250808716, 158.1971035003662, 162.3045620918274, 166.40682721138, 170.51493048667908, 174.6239137649536, 178.74161410331726, 182.8588662147522, 186.9674265384674, 191.12138843536377, 195.27989721298218, 199.43344163894653, 203.5883891582489, 207.74297332763672, 211.84611463546753, 215.9568543434143, 220.13143038749695, 224.27881121635437, 228.4182152748108, 232.53692603111267, 236.65434622764587, 240.760817527771, 244.87726211547852, 248.99075031280518, 253.1148657798767, 257.23506236076355, 261.35373401641846, 265.46900272369385, 269.5850410461426, 273.6955232620239, 277.8064389228821, 281.9202890396118, 286.0898654460907, 290.218768119812, 294.332731962204, 298.4414463043213, 302.57785081863403, 306.73975706100464, 310.8773624897003, 315.0160446166992, 319.1351201534271, 323.2976257801056, 327.77760434150696, 332.273681640625, 336.4343388080597, 340.58720350265503, 344.74383521080017, 348.9791202545166, 353.1029987335205, 357.2096962928772, 361.6708493232727, 365.7746443748474, 369.99518299102783, 373.8135085105896]
[47.14, 55.71, 58.51, 61.02, 60.5, 63.0, 65.31, 65.58, 64.63, 66.1, 66.3, 66.68, 67.17, 67.1, 67.61, 68.27, 68.83, 69.19, 68.86, 69.27, 69.78, 69.84, 70.08, 70.63, 71.28, 71.42, 72.07, 71.76, 72.05, 72.01, 72.09, 72.47, 72.65, 73.16, 73.21, 72.95, 72.93, 72.84, 72.72, 73.15, 73.54, 73.26, 73.4, 73.41, 73.28, 73.28, 73.25, 72.98, 73.26, 73.13, 73.61, 73.64, 73.95, 74.19, 74.47, 74.3, 74.05, 74.0, 74.58, 74.52, 74.25, 74.42, 74.83, 75.06, 74.74, 74.73, 74.5, 74.72, 74.6, 74.53, 74.54, 74.63, 74.77, 74.55, 74.82, 74.88, 74.63, 74.92, 75.1, 75.77, 75.46, 74.87, 75.95, 75.13, 75.29, 75.13, 75.6, 75.05, 75.71, 75.48, 74.69, 75.36, 75.16, 75.47, 75.01, 74.07, 75.22, 74.94, 76.09, 76.05, 74.95]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.678, Test loss: 1.670, Test accuracy: 31.51
Round   1, Train loss: 1.329, Test loss: 1.286, Test accuracy: 44.44
Round   2, Train loss: 1.159, Test loss: 1.131, Test accuracy: 52.76
Round   3, Train loss: 1.065, Test loss: 1.037, Test accuracy: 57.57
Round   4, Train loss: 1.005, Test loss: 1.001, Test accuracy: 59.57
Round   5, Train loss: 0.957, Test loss: 0.945, Test accuracy: 62.38
Round   6, Train loss: 0.915, Test loss: 0.907, Test accuracy: 64.03
Round   7, Train loss: 0.877, Test loss: 0.883, Test accuracy: 64.65
Round   8, Train loss: 0.837, Test loss: 0.857, Test accuracy: 65.63
Round   9, Train loss: 0.811, Test loss: 0.854, Test accuracy: 66.26
Round  10, Train loss: 0.778, Test loss: 0.811, Test accuracy: 67.49
Round  11, Train loss: 0.751, Test loss: 0.795, Test accuracy: 69.07
Round  12, Train loss: 0.723, Test loss: 0.773, Test accuracy: 69.70
Round  13, Train loss: 0.698, Test loss: 0.797, Test accuracy: 68.99
Round  14, Train loss: 0.671, Test loss: 0.756, Test accuracy: 70.62
Round  15, Train loss: 0.654, Test loss: 0.769, Test accuracy: 70.46
Round  16, Train loss: 0.631, Test loss: 0.748, Test accuracy: 71.44
Round  17, Train loss: 0.611, Test loss: 0.740, Test accuracy: 72.10
Round  18, Train loss: 0.596, Test loss: 0.746, Test accuracy: 72.00
Round  19, Train loss: 0.579, Test loss: 0.725, Test accuracy: 72.72
Round  20, Train loss: 0.548, Test loss: 0.736, Test accuracy: 71.98
Round  21, Train loss: 0.558, Test loss: 0.758, Test accuracy: 71.52
Round  22, Train loss: 0.534, Test loss: 0.769, Test accuracy: 71.58
Round  23, Train loss: 0.517, Test loss: 0.758, Test accuracy: 72.21
Round  24, Train loss: 0.486, Test loss: 0.761, Test accuracy: 72.08
Round  25, Train loss: 0.497, Test loss: 0.736, Test accuracy: 73.32
Round  26, Train loss: 0.481, Test loss: 0.742, Test accuracy: 73.42
Round  27, Train loss: 0.527, Test loss: 0.736, Test accuracy: 73.65
Round  28, Train loss: 0.503, Test loss: 0.720, Test accuracy: 74.30
Round  29, Train loss: 0.464, Test loss: 0.741, Test accuracy: 73.77
Round  30, Train loss: 0.467, Test loss: 0.747, Test accuracy: 73.83
Round  31, Train loss: 0.385, Test loss: 0.763, Test accuracy: 73.46
Round  32, Train loss: 0.425, Test loss: 0.749, Test accuracy: 73.83
Round  33, Train loss: 0.425, Test loss: 0.767, Test accuracy: 73.30
Round  34, Train loss: 0.428, Test loss: 0.765, Test accuracy: 73.43
Round  35, Train loss: 0.407, Test loss: 0.752, Test accuracy: 73.89
Round  36, Train loss: 0.377, Test loss: 0.753, Test accuracy: 73.81
Round  37, Train loss: 0.412, Test loss: 0.744, Test accuracy: 74.35
Round  38, Train loss: 0.435, Test loss: 0.773, Test accuracy: 74.33
Round  39, Train loss: 0.353, Test loss: 0.756, Test accuracy: 74.83
Round  40, Train loss: 0.409, Test loss: 0.750, Test accuracy: 74.85
Round  41, Train loss: 0.396, Test loss: 0.754, Test accuracy: 74.60
Round  42, Train loss: 0.408, Test loss: 0.749, Test accuracy: 75.13
Round  43, Train loss: 0.359, Test loss: 0.740, Test accuracy: 75.32
Round  44, Train loss: 0.365, Test loss: 0.779, Test accuracy: 74.45
Round  45, Train loss: 0.313, Test loss: 0.796, Test accuracy: 74.57
Round  46, Train loss: 0.362, Test loss: 0.784, Test accuracy: 74.54
Round  47, Train loss: 0.317, Test loss: 0.783, Test accuracy: 74.63
Round  48, Train loss: 0.316, Test loss: 0.797, Test accuracy: 74.38
Round  49, Train loss: 0.305, Test loss: 0.832, Test accuracy: 74.18
Round  50, Train loss: 0.332, Test loss: 0.799, Test accuracy: 74.45
Round  51, Train loss: 0.317, Test loss: 0.810, Test accuracy: 74.39
Round  52, Train loss: 0.322, Test loss: 0.796, Test accuracy: 74.67
Round  53, Train loss: 0.358, Test loss: 0.808, Test accuracy: 74.52
Round  54, Train loss: 0.297, Test loss: 0.805, Test accuracy: 74.79
Round  55, Train loss: 0.298, Test loss: 0.843, Test accuracy: 74.39
Round  56, Train loss: 0.326, Test loss: 0.841, Test accuracy: 74.51
Round  57, Train loss: 0.258, Test loss: 0.823, Test accuracy: 75.07
Round  58, Train loss: 0.281, Test loss: 0.821, Test accuracy: 75.13
Round  59, Train loss: 0.289, Test loss: 0.800, Test accuracy: 75.68
Round  60, Train loss: 0.329, Test loss: 0.798, Test accuracy: 75.73
Round  61, Train loss: 0.285, Test loss: 0.829, Test accuracy: 75.33
Round  62, Train loss: 0.246, Test loss: 0.824, Test accuracy: 75.39
Round  63, Train loss: 0.262, Test loss: 0.836, Test accuracy: 75.06
Round  64, Train loss: 0.270, Test loss: 0.840, Test accuracy: 75.15
Round  65, Train loss: 0.291, Test loss: 0.818, Test accuracy: 75.56
Round  66, Train loss: 0.254, Test loss: 0.805, Test accuracy: 75.64
Round  67, Train loss: 0.248, Test loss: 0.830, Test accuracy: 75.12
Round  68, Train loss: 0.219, Test loss: 0.843, Test accuracy: 75.53
Round  69, Train loss: 0.332, Test loss: 0.840, Test accuracy: 75.28
Round  70, Train loss: 0.307, Test loss: 0.830, Test accuracy: 75.59
Round  71, Train loss: 0.236, Test loss: 0.859, Test accuracy: 75.70
Round  72, Train loss: 0.227, Test loss: 0.869, Test accuracy: 75.45
Round  73, Train loss: 0.280, Test loss: 0.846, Test accuracy: 75.98
Round  74, Train loss: 0.233, Test loss: 0.842, Test accuracy: 75.77
Round  75, Train loss: 0.201, Test loss: 0.869, Test accuracy: 75.31
Round  76, Train loss: 0.281, Test loss: 0.862, Test accuracy: 75.80
Round  77, Train loss: 0.266, Test loss: 0.874, Test accuracy: 75.56
Round  78, Train loss: 0.222, Test loss: 0.864, Test accuracy: 75.71
Round  79, Train loss: 0.220, Test loss: 0.914, Test accuracy: 75.55
Round  80, Train loss: 0.177, Test loss: 0.883, Test accuracy: 75.74
Round  81, Train loss: 0.179, Test loss: 0.906, Test accuracy: 75.44
Round  82, Train loss: 0.161, Test loss: 0.896, Test accuracy: 75.69
Round  83, Train loss: 0.160, Test loss: 0.885, Test accuracy: 75.93
Round  84, Train loss: 0.146, Test loss: 0.921, Test accuracy: 75.58
Round  85, Train loss: 0.137, Test loss: 0.918, Test accuracy: 76.10
Round  86, Train loss: 0.138, Test loss: 0.927, Test accuracy: 75.93
Round  87, Train loss: 0.140, Test loss: 0.926, Test accuracy: 75.71
Round  88, Train loss: 0.125, Test loss: 0.941, Test accuracy: 75.77
Round  89, Train loss: 0.118, Test loss: 0.971, Test accuracy: 75.68
Round  90, Train loss: 0.238, Test loss: 0.897, Test accuracy: 75.75
Round  91, Train loss: 0.215, Test loss: 0.891, Test accuracy: 76.28
Round  92, Train loss: 0.201, Test loss: 0.904, Test accuracy: 75.91
Round  93, Train loss: 0.203, Test loss: 0.884, Test accuracy: 76.32
Round  94, Train loss: 0.195, Test loss: 0.914, Test accuracy: 76.03
Round  95, Train loss: 0.196, Test loss: 0.888, Test accuracy: 76.31
Round  96, Train loss: 0.188, Test loss: 0.898, Test accuracy: 76.41
Round  97, Train loss: 0.187, Test loss: 0.910, Test accuracy: 76.31
Round  98, Train loss: 0.180, Test loss: 0.925, Test accuracy: 76.14
Round  99, Train loss: 0.184, Test loss: 0.921, Test accuracy: 76.32
Final Round, Train loss: 0.140, Test loss: 0.899, Test accuracy: 76.92
Average accuracy final 10 rounds: 76.178
3056.66233086586
[2.24680495262146, 4.057748079299927, 5.861889839172363, 7.666933059692383, 9.466920614242554, 11.274587154388428, 13.090830326080322, 14.893430948257446, 16.712613344192505, 18.52536678314209, 20.31921148300171, 22.107816457748413, 23.919249296188354, 25.708290100097656, 27.52274990081787, 29.323066234588623, 31.113994359970093, 32.910202741622925, 34.71219229698181, 36.51587152481079, 38.30966544151306, 41.4643018245697, 44.606335401535034, 47.743372440338135, 50.89093518257141, 54.02817893028259, 57.32305669784546, 60.61697506904602, 63.93623876571655, 67.0777735710144, 70.23528742790222, 73.38997077941895, 76.55802297592163, 79.71511888504028, 82.87279534339905, 86.03204298019409, 89.19361734390259, 92.31762433052063, 95.50682806968689, 98.6752061843872, 101.83434462547302, 104.9531180858612, 108.11117720603943, 111.27668070793152, 114.43052768707275, 117.59088897705078, 120.73388957977295, 123.886958360672, 127.03071308135986, 130.1686179637909, 133.32253909111023, 136.47325325012207, 139.58684301376343, 142.70591473579407, 145.84957575798035, 148.9920289516449, 152.13517379760742, 155.28046798706055, 158.41873455047607, 161.55531883239746, 164.69687604904175, 167.83795595169067, 170.99320006370544, 174.11258745193481, 177.22997665405273, 180.43179631233215, 183.54942274093628, 186.6654176712036, 189.78100514411926, 192.8952910900116, 196.00797605514526, 199.12547397613525, 202.2390902042389, 205.354754447937, 208.46328115463257, 211.5766143798828, 214.85491013526917, 218.13903951644897, 221.4318253993988, 224.54512643814087, 227.6657793521881, 230.7862572669983, 233.90717935562134, 237.0519495010376, 240.16919827461243, 243.29002332687378, 246.4722397327423, 249.59443306922913, 252.72673106193542, 255.85537266731262, 259.002170085907, 262.11707878112793, 265.2393307685852, 268.35815691947937, 271.48746633529663, 274.60820412635803, 277.79823088645935, 280.92513275146484, 284.0474989414215, 287.19557189941406, 290.68964552879333]
[31.51, 44.44, 52.76, 57.57, 59.57, 62.38, 64.03, 64.65, 65.63, 66.26, 67.49, 69.07, 69.7, 68.99, 70.62, 70.46, 71.44, 72.1, 72.0, 72.72, 71.98, 71.52, 71.58, 72.21, 72.08, 73.32, 73.42, 73.65, 74.3, 73.77, 73.83, 73.46, 73.83, 73.3, 73.43, 73.89, 73.81, 74.35, 74.33, 74.83, 74.85, 74.6, 75.13, 75.32, 74.45, 74.57, 74.54, 74.63, 74.38, 74.18, 74.45, 74.39, 74.67, 74.52, 74.79, 74.39, 74.51, 75.07, 75.13, 75.68, 75.73, 75.33, 75.39, 75.06, 75.15, 75.56, 75.64, 75.12, 75.53, 75.28, 75.59, 75.7, 75.45, 75.98, 75.77, 75.31, 75.8, 75.56, 75.71, 75.55, 75.74, 75.44, 75.69, 75.93, 75.58, 76.1, 75.93, 75.71, 75.77, 75.68, 75.75, 76.28, 75.91, 76.32, 76.03, 76.31, 76.41, 76.31, 76.14, 76.32, 76.92]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.685, Test loss: 1.641, Test accuracy: 36.84
Round   1, Train loss: 1.309, Test loss: 1.234, Test accuracy: 48.84
Round   2, Train loss: 1.127, Test loss: 1.071, Test accuracy: 56.59
Round   3, Train loss: 1.044, Test loss: 1.007, Test accuracy: 59.84
Round   4, Train loss: 0.993, Test loss: 0.969, Test accuracy: 60.62
Round   5, Train loss: 0.950, Test loss: 0.935, Test accuracy: 62.51
Round   6, Train loss: 0.913, Test loss: 0.908, Test accuracy: 63.92
Round   7, Train loss: 0.880, Test loss: 0.884, Test accuracy: 64.30
Round   8, Train loss: 0.845, Test loss: 0.861, Test accuracy: 66.11
Round   9, Train loss: 0.811, Test loss: 0.833, Test accuracy: 67.32
Round  10, Train loss: 0.785, Test loss: 0.833, Test accuracy: 67.65
Round  11, Train loss: 0.739, Test loss: 0.818, Test accuracy: 68.37
Round  12, Train loss: 0.689, Test loss: 0.808, Test accuracy: 69.12
Round  13, Train loss: 0.739, Test loss: 0.771, Test accuracy: 69.87
Round  14, Train loss: 0.693, Test loss: 0.779, Test accuracy: 69.55
Round  15, Train loss: 0.608, Test loss: 0.756, Test accuracy: 70.84
Round  16, Train loss: 0.615, Test loss: 0.756, Test accuracy: 70.65
Round  17, Train loss: 0.742, Test loss: 0.727, Test accuracy: 71.96
Round  18, Train loss: 0.588, Test loss: 0.726, Test accuracy: 72.13
Round  19, Train loss: 0.592, Test loss: 0.711, Test accuracy: 72.58
Round  20, Train loss: 0.626, Test loss: 0.710, Test accuracy: 72.72
Round  21, Train loss: 0.583, Test loss: 0.703, Test accuracy: 72.98
Round  22, Train loss: 0.560, Test loss: 0.697, Test accuracy: 73.08
Round  23, Train loss: 0.508, Test loss: 0.683, Test accuracy: 73.59
Round  24, Train loss: 0.606, Test loss: 0.680, Test accuracy: 74.24
Round  25, Train loss: 0.543, Test loss: 0.677, Test accuracy: 73.98
Round  26, Train loss: 0.535, Test loss: 0.676, Test accuracy: 74.45
Round  27, Train loss: 0.548, Test loss: 0.676, Test accuracy: 74.12
Round  28, Train loss: 0.468, Test loss: 0.665, Test accuracy: 74.36
Round  29, Train loss: 0.447, Test loss: 0.660, Test accuracy: 74.68
Round  30, Train loss: 0.415, Test loss: 0.679, Test accuracy: 74.42
Round  31, Train loss: 0.464, Test loss: 0.664, Test accuracy: 75.39
Round  32, Train loss: 0.372, Test loss: 0.685, Test accuracy: 74.31
Round  33, Train loss: 0.443, Test loss: 0.676, Test accuracy: 74.63
Round  34, Train loss: 0.456, Test loss: 0.668, Test accuracy: 75.31
Round  35, Train loss: 0.410, Test loss: 0.672, Test accuracy: 75.31
Round  36, Train loss: 0.366, Test loss: 0.666, Test accuracy: 75.53
Round  37, Train loss: 0.385, Test loss: 0.669, Test accuracy: 75.63
Round  38, Train loss: 0.417, Test loss: 0.668, Test accuracy: 75.41
Round  39, Train loss: 0.378, Test loss: 0.669, Test accuracy: 75.14
Round  40, Train loss: 0.454, Test loss: 0.673, Test accuracy: 75.16
Round  41, Train loss: 0.355, Test loss: 0.666, Test accuracy: 75.72
Round  42, Train loss: 0.317, Test loss: 0.686, Test accuracy: 75.26
Round  43, Train loss: 0.440, Test loss: 0.655, Test accuracy: 75.94
Round  44, Train loss: 0.379, Test loss: 0.654, Test accuracy: 76.21
Round  45, Train loss: 0.318, Test loss: 0.662, Test accuracy: 75.98
Round  46, Train loss: 0.295, Test loss: 0.656, Test accuracy: 76.39
Round  47, Train loss: 0.350, Test loss: 0.643, Test accuracy: 76.73
Round  48, Train loss: 0.350, Test loss: 0.655, Test accuracy: 76.36
Round  49, Train loss: 0.345, Test loss: 0.662, Test accuracy: 76.67
Round  50, Train loss: 0.330, Test loss: 0.654, Test accuracy: 76.83
Round  51, Train loss: 0.338, Test loss: 0.644, Test accuracy: 77.44
Round  52, Train loss: 0.297, Test loss: 0.660, Test accuracy: 76.58
Round  53, Train loss: 0.343, Test loss: 0.643, Test accuracy: 77.16
Round  54, Train loss: 0.282, Test loss: 0.653, Test accuracy: 76.85
Round  55, Train loss: 0.310, Test loss: 0.657, Test accuracy: 76.62
Round  56, Train loss: 0.311, Test loss: 0.657, Test accuracy: 76.53
Round  57, Train loss: 0.311, Test loss: 0.669, Test accuracy: 76.27
Round  58, Train loss: 0.254, Test loss: 0.673, Test accuracy: 76.72
Round  59, Train loss: 0.291, Test loss: 0.668, Test accuracy: 76.76
Round  60, Train loss: 0.330, Test loss: 0.673, Test accuracy: 76.80
Round  61, Train loss: 0.287, Test loss: 0.689, Test accuracy: 76.57
Round  62, Train loss: 0.317, Test loss: 0.663, Test accuracy: 77.04
Round  63, Train loss: 0.253, Test loss: 0.661, Test accuracy: 77.05
Round  64, Train loss: 0.248, Test loss: 0.666, Test accuracy: 77.20
Round  65, Train loss: 0.311, Test loss: 0.651, Test accuracy: 77.01
Round  66, Train loss: 0.285, Test loss: 0.641, Test accuracy: 77.50
Round  67, Train loss: 0.279, Test loss: 0.643, Test accuracy: 77.45
Round  68, Train loss: 0.252, Test loss: 0.640, Test accuracy: 77.89
Round  69, Train loss: 0.239, Test loss: 0.647, Test accuracy: 77.60
Round  70, Train loss: 0.254, Test loss: 0.658, Test accuracy: 77.47
Round  71, Train loss: 0.219, Test loss: 0.695, Test accuracy: 77.00
Round  72, Train loss: 0.228, Test loss: 0.667, Test accuracy: 77.58
Round  73, Train loss: 0.228, Test loss: 0.666, Test accuracy: 77.36
Round  74, Train loss: 0.190, Test loss: 0.662, Test accuracy: 77.77
Round  75, Train loss: 0.254, Test loss: 0.665, Test accuracy: 77.65
Round  76, Train loss: 0.221, Test loss: 0.658, Test accuracy: 78.02
Round  77, Train loss: 0.229, Test loss: 0.657, Test accuracy: 77.59
Round  78, Train loss: 0.197, Test loss: 0.681, Test accuracy: 77.47
Round  79, Train loss: 0.279, Test loss: 0.675, Test accuracy: 77.35
Round  80, Train loss: 0.188, Test loss: 0.672, Test accuracy: 78.12
Round  81, Train loss: 0.165, Test loss: 0.663, Test accuracy: 78.10
Round  82, Train loss: 0.162, Test loss: 0.660, Test accuracy: 78.17
Round  83, Train loss: 0.147, Test loss: 0.669, Test accuracy: 77.92
Round  84, Train loss: 0.150, Test loss: 0.678, Test accuracy: 77.72
Round  85, Train loss: 0.142, Test loss: 0.673, Test accuracy: 78.21
Round  86, Train loss: 0.132, Test loss: 0.672, Test accuracy: 78.24
Round  87, Train loss: 0.136, Test loss: 0.678, Test accuracy: 77.74
Round  88, Train loss: 0.131, Test loss: 0.688, Test accuracy: 77.63
Round  89, Train loss: 0.131, Test loss: 0.681, Test accuracy: 77.93
Round  90, Train loss: 0.224, Test loss: 0.677, Test accuracy: 78.00
Round  91, Train loss: 0.209, Test loss: 0.678, Test accuracy: 78.16
Round  92, Train loss: 0.205, Test loss: 0.665, Test accuracy: 78.43
Round  93, Train loss: 0.203, Test loss: 0.687, Test accuracy: 78.12
Round  94, Train loss: 0.196, Test loss: 0.685, Test accuracy: 78.21
Round  95, Train loss: 0.195, Test loss: 0.675, Test accuracy: 78.54
Round  96, Train loss: 0.195, Test loss: 0.672, Test accuracy: 78.33
Round  97, Train loss: 0.193, Test loss: 0.685, Test accuracy: 78.31
Round  98, Train loss: 0.191, Test loss: 0.678, Test accuracy: 78.42
Round  99, Train loss: 0.190, Test loss: 0.681, Test accuracy: 78.32
Final Round, Train loss: 0.154, Test loss: 0.672, Test accuracy: 78.71
Average accuracy final 10 rounds: 78.28399999999999
3358.6137697696686
[2.8482003211975098, 5.369287490844727, 7.8850321769714355, 10.128102779388428, 12.392542839050293, 14.634352207183838, 16.87267756462097, 19.113471031188965, 21.37361478805542, 23.630446195602417, 25.88941216468811, 28.143898963928223, 30.40127182006836, 32.657856941223145, 34.91320252418518, 37.171396017074585, 39.430652379989624, 41.686930418014526, 43.94250965118408, 46.19682860374451, 48.456775426864624, 52.23937940597534, 56.01186680793762, 59.77247095108032, 63.526949882507324, 67.28394055366516, 71.05033278465271, 74.8094973564148, 78.56137442588806, 82.32471990585327, 86.09899020195007, 89.85338354110718, 93.61023092269897, 97.42816805839539, 101.19663977622986, 104.96285152435303, 108.73282718658447, 112.50303435325623, 116.27803611755371, 120.03940677642822, 123.79755568504333, 127.56514263153076, 131.33264684677124, 135.09817385673523, 138.86639142036438, 142.63428354263306, 146.40526461601257, 150.1757709980011, 153.94326829910278, 157.7091908454895, 161.47492837905884, 165.2464256286621, 169.02481341362, 172.79807090759277, 176.56641793251038, 180.33765864372253, 184.10334014892578, 187.94945287704468, 191.7218520641327, 195.4921360015869, 199.2636842727661, 203.03108143806458, 206.79785227775574, 210.56605792045593, 214.33168029785156, 218.09995555877686, 221.86683106422424, 225.63207292556763, 229.40056991577148, 233.17469477653503, 236.93649554252625, 240.70460963249207, 244.47249341011047, 248.24327492713928, 252.01160407066345, 255.78504467010498, 259.6210141181946, 263.38599920272827, 267.15364956855774, 270.9107151031494, 274.67132210731506, 278.44783568382263, 282.22019481658936, 285.98924136161804, 289.76583218574524, 293.537385225296, 297.32815384864807, 301.0993528366089, 304.8765685558319, 308.67153882980347, 312.51584482192993, 316.3017773628235, 320.1023817062378, 323.89686346054077, 327.6796290874481, 331.4505455493927, 335.2724459171295, 339.05186557769775, 342.9016799926758, 346.6921937465668, 350.4136209487915]
[36.84, 48.84, 56.59, 59.84, 60.62, 62.51, 63.92, 64.3, 66.11, 67.32, 67.65, 68.37, 69.12, 69.87, 69.55, 70.84, 70.65, 71.96, 72.13, 72.58, 72.72, 72.98, 73.08, 73.59, 74.24, 73.98, 74.45, 74.12, 74.36, 74.68, 74.42, 75.39, 74.31, 74.63, 75.31, 75.31, 75.53, 75.63, 75.41, 75.14, 75.16, 75.72, 75.26, 75.94, 76.21, 75.98, 76.39, 76.73, 76.36, 76.67, 76.83, 77.44, 76.58, 77.16, 76.85, 76.62, 76.53, 76.27, 76.72, 76.76, 76.8, 76.57, 77.04, 77.05, 77.2, 77.01, 77.5, 77.45, 77.89, 77.6, 77.47, 77.0, 77.58, 77.36, 77.77, 77.65, 78.02, 77.59, 77.47, 77.35, 78.12, 78.1, 78.17, 77.92, 77.72, 78.21, 78.24, 77.74, 77.63, 77.93, 78.0, 78.16, 78.43, 78.12, 78.21, 78.54, 78.33, 78.31, 78.42, 78.32, 78.71]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.645, Test loss: 2.017, Test accuracy: 27.09
Round   0, Global train loss: 1.645, Global test loss: 2.201, Global test accuracy: 24.40
Round   1, Train loss: 1.453, Test loss: 1.804, Test accuracy: 35.67
Round   1, Global train loss: 1.453, Global test loss: 2.100, Global test accuracy: 29.37
Round   2, Train loss: 1.375, Test loss: 1.546, Test accuracy: 41.49
Round   2, Global train loss: 1.375, Global test loss: 2.020, Global test accuracy: 31.12
Round   3, Train loss: 1.390, Test loss: 1.455, Test accuracy: 45.45
Round   3, Global train loss: 1.390, Global test loss: 2.047, Global test accuracy: 32.34
Round   4, Train loss: 1.210, Test loss: 1.371, Test accuracy: 48.15
Round   4, Global train loss: 1.210, Global test loss: 1.952, Global test accuracy: 30.81
Round   5, Train loss: 1.203, Test loss: 1.310, Test accuracy: 48.59
Round   5, Global train loss: 1.203, Global test loss: 1.899, Global test accuracy: 31.28
Round   6, Train loss: 1.238, Test loss: 1.277, Test accuracy: 50.18
Round   6, Global train loss: 1.238, Global test loss: 1.920, Global test accuracy: 32.98
Round   7, Train loss: 1.263, Test loss: 1.184, Test accuracy: 52.49
Round   7, Global train loss: 1.263, Global test loss: 1.956, Global test accuracy: 32.15
Round   8, Train loss: 1.218, Test loss: 1.143, Test accuracy: 54.36
Round   8, Global train loss: 1.218, Global test loss: 1.992, Global test accuracy: 23.19
Round   9, Train loss: 1.173, Test loss: 1.135, Test accuracy: 55.30
Round   9, Global train loss: 1.173, Global test loss: 2.007, Global test accuracy: 32.25
Round  10, Train loss: 1.192, Test loss: 1.119, Test accuracy: 55.58
Round  10, Global train loss: 1.192, Global test loss: 1.960, Global test accuracy: 33.81
Round  11, Train loss: 1.020, Test loss: 1.117, Test accuracy: 56.06
Round  11, Global train loss: 1.020, Global test loss: 2.064, Global test accuracy: 29.85
Round  12, Train loss: 1.105, Test loss: 1.093, Test accuracy: 57.10
Round  12, Global train loss: 1.105, Global test loss: 1.930, Global test accuracy: 31.52
Round  13, Train loss: 1.142, Test loss: 1.080, Test accuracy: 58.20
Round  13, Global train loss: 1.142, Global test loss: 1.946, Global test accuracy: 28.51
Round  14, Train loss: 1.022, Test loss: 1.074, Test accuracy: 58.17
Round  14, Global train loss: 1.022, Global test loss: 2.000, Global test accuracy: 25.12
Round  15, Train loss: 0.973, Test loss: 1.080, Test accuracy: 58.59
Round  15, Global train loss: 0.973, Global test loss: 1.805, Global test accuracy: 35.89
Round  16, Train loss: 0.963, Test loss: 1.076, Test accuracy: 59.05
Round  16, Global train loss: 0.963, Global test loss: 1.847, Global test accuracy: 37.79
Round  17, Train loss: 0.947, Test loss: 1.060, Test accuracy: 59.85
Round  17, Global train loss: 0.947, Global test loss: 1.866, Global test accuracy: 36.97
Round  18, Train loss: 0.899, Test loss: 1.074, Test accuracy: 60.01
Round  18, Global train loss: 0.899, Global test loss: 1.919, Global test accuracy: 36.52
Round  19, Train loss: 0.865, Test loss: 1.080, Test accuracy: 59.80
Round  19, Global train loss: 0.865, Global test loss: 1.845, Global test accuracy: 36.24
Round  20, Train loss: 0.851, Test loss: 1.077, Test accuracy: 60.26
Round  20, Global train loss: 0.851, Global test loss: 2.021, Global test accuracy: 26.44
Round  21, Train loss: 0.875, Test loss: 1.077, Test accuracy: 60.05
Round  21, Global train loss: 0.875, Global test loss: 2.066, Global test accuracy: 31.52
Round  22, Train loss: 0.933, Test loss: 1.073, Test accuracy: 59.99
Round  22, Global train loss: 0.933, Global test loss: 1.889, Global test accuracy: 33.44
Round  23, Train loss: 1.001, Test loss: 1.063, Test accuracy: 60.48
Round  23, Global train loss: 1.001, Global test loss: 1.939, Global test accuracy: 33.75
Round  24, Train loss: 0.899, Test loss: 1.065, Test accuracy: 60.81
Round  24, Global train loss: 0.899, Global test loss: 1.842, Global test accuracy: 37.46
Round  25, Train loss: 0.826, Test loss: 1.083, Test accuracy: 60.34
Round  25, Global train loss: 0.826, Global test loss: 2.102, Global test accuracy: 28.69
Round  26, Train loss: 0.803, Test loss: 1.077, Test accuracy: 60.91
Round  26, Global train loss: 0.803, Global test loss: 1.984, Global test accuracy: 29.20
Round  27, Train loss: 0.766, Test loss: 1.130, Test accuracy: 59.81
Round  27, Global train loss: 0.766, Global test loss: 1.820, Global test accuracy: 42.98
Round  28, Train loss: 0.753, Test loss: 1.132, Test accuracy: 60.47
Round  28, Global train loss: 0.753, Global test loss: 1.970, Global test accuracy: 26.13
Round  29, Train loss: 0.745, Test loss: 1.141, Test accuracy: 60.16
Round  29, Global train loss: 0.745, Global test loss: 1.789, Global test accuracy: 40.88
Round  30, Train loss: 0.685, Test loss: 1.164, Test accuracy: 60.26
Round  30, Global train loss: 0.685, Global test loss: 1.776, Global test accuracy: 37.22
Round  31, Train loss: 0.553, Test loss: 1.144, Test accuracy: 60.82
Round  31, Global train loss: 0.553, Global test loss: 1.926, Global test accuracy: 33.71
Round  32, Train loss: 0.582, Test loss: 1.157, Test accuracy: 60.93
Round  32, Global train loss: 0.582, Global test loss: 1.945, Global test accuracy: 32.56
Round  33, Train loss: 0.662, Test loss: 1.145, Test accuracy: 60.94
Round  33, Global train loss: 0.662, Global test loss: 1.882, Global test accuracy: 31.37
Round  34, Train loss: 0.702, Test loss: 1.170, Test accuracy: 60.90
Round  34, Global train loss: 0.702, Global test loss: 1.854, Global test accuracy: 36.80
Round  35, Train loss: 0.589, Test loss: 1.201, Test accuracy: 60.30
Round  35, Global train loss: 0.589, Global test loss: 2.223, Global test accuracy: 26.67
Round  36, Train loss: 0.718, Test loss: 1.222, Test accuracy: 60.13
Round  36, Global train loss: 0.718, Global test loss: 2.011, Global test accuracy: 33.39
Round  37, Train loss: 0.548, Test loss: 1.234, Test accuracy: 60.13
Round  37, Global train loss: 0.548, Global test loss: 1.865, Global test accuracy: 35.51
Round  38, Train loss: 0.648, Test loss: 1.264, Test accuracy: 60.04
Round  38, Global train loss: 0.648, Global test loss: 1.861, Global test accuracy: 39.68
Round  39, Train loss: 0.553, Test loss: 1.283, Test accuracy: 60.15
Round  39, Global train loss: 0.553, Global test loss: 1.994, Global test accuracy: 32.95
Round  40, Train loss: 0.425, Test loss: 1.307, Test accuracy: 59.72
Round  40, Global train loss: 0.425, Global test loss: 1.976, Global test accuracy: 34.41
Round  41, Train loss: 0.502, Test loss: 1.328, Test accuracy: 60.22
Round  41, Global train loss: 0.502, Global test loss: 2.320, Global test accuracy: 28.90
Round  42, Train loss: 0.528, Test loss: 1.345, Test accuracy: 60.03
Round  42, Global train loss: 0.528, Global test loss: 1.861, Global test accuracy: 30.96
Round  43, Train loss: 0.447, Test loss: 1.328, Test accuracy: 60.32
Round  43, Global train loss: 0.447, Global test loss: 1.784, Global test accuracy: 36.97
Round  44, Train loss: 0.405, Test loss: 1.336, Test accuracy: 60.74
Round  44, Global train loss: 0.405, Global test loss: 1.770, Global test accuracy: 34.29
Round  45, Train loss: 0.313, Test loss: 1.350, Test accuracy: 60.62
Round  45, Global train loss: 0.313, Global test loss: 1.814, Global test accuracy: 33.48
Round  46, Train loss: 0.548, Test loss: 1.372, Test accuracy: 60.53
Round  46, Global train loss: 0.548, Global test loss: 1.937, Global test accuracy: 33.53
Round  47, Train loss: 0.348, Test loss: 1.397, Test accuracy: 60.42
Round  47, Global train loss: 0.348, Global test loss: 2.006, Global test accuracy: 38.39
Round  48, Train loss: 0.405, Test loss: 1.425, Test accuracy: 60.47
Round  48, Global train loss: 0.405, Global test loss: 2.133, Global test accuracy: 24.87
Round  49, Train loss: 0.406, Test loss: 1.448, Test accuracy: 59.71
Round  49, Global train loss: 0.406, Global test loss: 1.991, Global test accuracy: 35.56
Round  50, Train loss: 0.432, Test loss: 1.463, Test accuracy: 60.14
Round  50, Global train loss: 0.432, Global test loss: 1.834, Global test accuracy: 38.56
Round  51, Train loss: 0.525, Test loss: 1.495, Test accuracy: 59.82
Round  51, Global train loss: 0.525, Global test loss: 1.932, Global test accuracy: 34.53
Round  52, Train loss: 0.373, Test loss: 1.497, Test accuracy: 60.30
Round  52, Global train loss: 0.373, Global test loss: 2.280, Global test accuracy: 31.94
Round  53, Train loss: 0.415, Test loss: 1.521, Test accuracy: 59.79
Round  53, Global train loss: 0.415, Global test loss: 1.949, Global test accuracy: 36.91
Round  54, Train loss: 0.360, Test loss: 1.520, Test accuracy: 60.28
Round  54, Global train loss: 0.360, Global test loss: 1.886, Global test accuracy: 35.86
Round  55, Train loss: 0.289, Test loss: 1.574, Test accuracy: 60.85
Round  55, Global train loss: 0.289, Global test loss: 1.945, Global test accuracy: 37.76
Round  56, Train loss: 0.291, Test loss: 1.627, Test accuracy: 60.50
Round  56, Global train loss: 0.291, Global test loss: 1.752, Global test accuracy: 41.54
Round  57, Train loss: 0.312, Test loss: 1.629, Test accuracy: 60.78
Round  57, Global train loss: 0.312, Global test loss: 1.924, Global test accuracy: 33.61
Round  58, Train loss: 0.294, Test loss: 1.677, Test accuracy: 60.55
Round  58, Global train loss: 0.294, Global test loss: 2.028, Global test accuracy: 29.92
Round  59, Train loss: 0.302, Test loss: 1.719, Test accuracy: 59.65
Round  59, Global train loss: 0.302, Global test loss: 1.877, Global test accuracy: 30.51
Round  60, Train loss: 0.324, Test loss: 1.714, Test accuracy: 60.06
Round  60, Global train loss: 0.324, Global test loss: 2.023, Global test accuracy: 26.32
Round  61, Train loss: 0.385, Test loss: 1.738, Test accuracy: 59.83
Round  61, Global train loss: 0.385, Global test loss: 2.149, Global test accuracy: 30.36
Round  62, Train loss: 0.312, Test loss: 1.780, Test accuracy: 59.58
Round  62, Global train loss: 0.312, Global test loss: 1.981, Global test accuracy: 34.42
Round  63, Train loss: 0.332, Test loss: 1.822, Test accuracy: 59.27
Round  63, Global train loss: 0.332, Global test loss: 2.057, Global test accuracy: 27.48
Round  64, Train loss: 0.196, Test loss: 1.834, Test accuracy: 59.19
Round  64, Global train loss: 0.196, Global test loss: 1.744, Global test accuracy: 37.64
Round  65, Train loss: 0.264, Test loss: 1.797, Test accuracy: 59.68
Round  65, Global train loss: 0.264, Global test loss: 2.007, Global test accuracy: 27.06
Round  66, Train loss: 0.189, Test loss: 1.848, Test accuracy: 59.23
Round  66, Global train loss: 0.189, Global test loss: 2.159, Global test accuracy: 25.03
Round  67, Train loss: 0.231, Test loss: 1.806, Test accuracy: 59.73
Round  67, Global train loss: 0.231, Global test loss: 2.058, Global test accuracy: 29.93
Round  68, Train loss: 0.255, Test loss: 1.835, Test accuracy: 59.21
Round  68, Global train loss: 0.255, Global test loss: 1.919, Global test accuracy: 37.38
Round  69, Train loss: 0.253, Test loss: 1.827, Test accuracy: 59.72
Round  69, Global train loss: 0.253, Global test loss: 1.864, Global test accuracy: 35.50
Round  70, Train loss: 0.235, Test loss: 1.822, Test accuracy: 60.24
Round  70, Global train loss: 0.235, Global test loss: 1.891, Global test accuracy: 38.28
Round  71, Train loss: 0.227, Test loss: 1.834, Test accuracy: 59.99
Round  71, Global train loss: 0.227, Global test loss: 1.943, Global test accuracy: 36.21
Round  72, Train loss: 0.168, Test loss: 1.852, Test accuracy: 60.54
Round  72, Global train loss: 0.168, Global test loss: 1.760, Global test accuracy: 38.35
Round  73, Train loss: 0.212, Test loss: 1.873, Test accuracy: 60.27
Round  73, Global train loss: 0.212, Global test loss: 2.268, Global test accuracy: 26.96
Round  74, Train loss: 0.259, Test loss: 1.916, Test accuracy: 59.82
Round  74, Global train loss: 0.259, Global test loss: 1.854, Global test accuracy: 39.61
Round  75, Train loss: 0.169, Test loss: 1.936, Test accuracy: 59.88
Round  75, Global train loss: 0.169, Global test loss: 1.940, Global test accuracy: 27.03
Round  76, Train loss: 0.154, Test loss: 1.915, Test accuracy: 60.10
Round  76, Global train loss: 0.154, Global test loss: 2.367, Global test accuracy: 35.74
Round  77, Train loss: 0.234, Test loss: 1.925, Test accuracy: 60.25
Round  77, Global train loss: 0.234, Global test loss: 1.994, Global test accuracy: 27.60
Round  78, Train loss: 0.185, Test loss: 1.984, Test accuracy: 60.53
Round  78, Global train loss: 0.185, Global test loss: 2.114, Global test accuracy: 34.42
Round  79, Train loss: 0.155, Test loss: 2.027, Test accuracy: 60.02
Round  79, Global train loss: 0.155, Global test loss: 2.064, Global test accuracy: 32.90
Round  80, Train loss: 0.178, Test loss: 2.070, Test accuracy: 59.87
Round  80, Global train loss: 0.178, Global test loss: 1.752, Global test accuracy: 39.36
Round  81, Train loss: 0.186, Test loss: 2.076, Test accuracy: 59.24
Round  81, Global train loss: 0.186, Global test loss: 2.047, Global test accuracy: 28.54
Round  82, Train loss: 0.183, Test loss: 2.117, Test accuracy: 58.93
Round  82, Global train loss: 0.183, Global test loss: 1.859, Global test accuracy: 37.28
Round  83, Train loss: 0.195, Test loss: 2.074, Test accuracy: 59.71
Round  83, Global train loss: 0.195, Global test loss: 1.923, Global test accuracy: 33.36
Round  84, Train loss: 0.157, Test loss: 2.087, Test accuracy: 59.80
Round  84, Global train loss: 0.157, Global test loss: 1.979, Global test accuracy: 31.75
Round  85, Train loss: 0.125, Test loss: 2.108, Test accuracy: 60.05
Round  85, Global train loss: 0.125, Global test loss: 2.110, Global test accuracy: 24.49
Round  86, Train loss: 0.193, Test loss: 2.108, Test accuracy: 60.88
Round  86, Global train loss: 0.193, Global test loss: 1.949, Global test accuracy: 32.05
Round  87, Train loss: 0.151, Test loss: 2.167, Test accuracy: 60.57
Round  87, Global train loss: 0.151, Global test loss: 2.008, Global test accuracy: 31.93
Round  88, Train loss: 0.125, Test loss: 2.194, Test accuracy: 60.11
Round  88, Global train loss: 0.125, Global test loss: 1.753, Global test accuracy: 41.78
Round  89, Train loss: 0.161, Test loss: 2.192, Test accuracy: 59.83
Round  89, Global train loss: 0.161, Global test loss: 1.999, Global test accuracy: 34.65
Round  90, Train loss: 0.137, Test loss: 2.198, Test accuracy: 59.60
Round  90, Global train loss: 0.137, Global test loss: 1.913, Global test accuracy: 32.83
Round  91, Train loss: 0.113, Test loss: 2.199, Test accuracy: 59.58
Round  91, Global train loss: 0.113, Global test loss: 1.856, Global test accuracy: 39.17
Round  92, Train loss: 0.138, Test loss: 2.218, Test accuracy: 60.31
Round  92, Global train loss: 0.138, Global test loss: 1.845, Global test accuracy: 33.36
Round  93, Train loss: 0.104, Test loss: 2.248, Test accuracy: 61.08
Round  93, Global train loss: 0.104, Global test loss: 1.908, Global test accuracy: 34.24
Round  94, Train loss: 0.122, Test loss: 2.295, Test accuracy: 60.87
Round  94, Global train loss: 0.122, Global test loss: 2.240, Global test accuracy: 37.54
Round  95, Train loss: 0.123, Test loss: 2.239, Test accuracy: 60.89
Round  95, Global train loss: 0.123, Global test loss: 1.827, Global test accuracy: 32.65
Round  96, Train loss: 0.124, Test loss: 2.251, Test accuracy: 60.71
Round  96, Global train loss: 0.124, Global test loss: 1.955, Global test accuracy: 35.78
Round  97, Train loss: 0.149, Test loss: 2.303, Test accuracy: 60.35
Round  97, Global train loss: 0.149, Global test loss: 1.850, Global test accuracy: 36.55
Round  98, Train loss: 0.110, Test loss: 2.298, Test accuracy: 60.41
Round  98, Global train loss: 0.110, Global test loss: 1.880, Global test accuracy: 32.15
Round  99, Train loss: 0.078, Test loss: 2.291, Test accuracy: 60.05
Round  99, Global train loss: 0.078, Global test loss: 2.032, Global test accuracy: 35.38
Final Round, Train loss: 0.123, Test loss: 2.373, Test accuracy: 58.81
Final Round, Global train loss: 0.123, Global test loss: 2.032, Global test accuracy: 35.38
Average accuracy final 10 rounds: 60.385 

Average global accuracy final 10 rounds: 34.965 

1289.0232129096985
[1.4278080463409424, 2.8556160926818848, 3.9807450771331787, 5.105874061584473, 6.234052896499634, 7.362231731414795, 8.490528345108032, 9.61882495880127, 10.745299816131592, 11.871774673461914, 12.998520374298096, 14.125266075134277, 15.250422954559326, 16.375579833984375, 17.501545190811157, 18.62751054763794, 19.761083126068115, 20.89465570449829, 22.020690441131592, 23.146725177764893, 24.27031421661377, 25.393903255462646, 26.518783569335938, 27.64366388320923, 28.775646924972534, 29.90762996673584, 31.039336442947388, 32.171042919158936, 33.29764127731323, 34.42423963546753, 35.55299735069275, 36.68175506591797, 37.81512784957886, 38.948500633239746, 40.07386136054993, 41.19922208786011, 42.334458112716675, 43.46969413757324, 44.608375787734985, 45.74705743789673, 46.87024784088135, 47.99343824386597, 49.12351632118225, 50.253594398498535, 51.38069677352905, 52.50779914855957, 53.63499450683594, 54.762189865112305, 55.88053774833679, 56.99888563156128, 58.11785387992859, 59.2368221282959, 60.35787582397461, 61.47892951965332, 62.60287833213806, 63.7268271446228, 64.69089126586914, 65.65495538711548, 66.62504172325134, 67.5951280593872, 68.55894351005554, 69.52275896072388, 70.4894437789917, 71.45612859725952, 72.42184805870056, 73.3875675201416, 74.35227847099304, 75.31698942184448, 76.28196620941162, 77.24694299697876, 78.21931624412537, 79.19168949127197, 80.15636491775513, 81.12104034423828, 82.08364295959473, 83.04624557495117, 84.0110399723053, 84.97583436965942, 85.93993663787842, 86.90403890609741, 87.86819458007812, 88.83235025405884, 89.79680800437927, 90.7612657546997, 91.72522258758545, 92.68917942047119, 93.65302228927612, 94.61686515808105, 95.5797073841095, 96.54254961013794, 97.50597524642944, 98.46940088272095, 99.43409872055054, 100.39879655838013, 101.36508560180664, 102.33137464523315, 103.2973153591156, 104.26325607299805, 105.22821259498596, 106.19316911697388, 107.16217398643494, 108.131178855896, 109.09605503082275, 110.06093120574951, 111.0238893032074, 111.98684740066528, 112.94970536231995, 113.91256332397461, 114.88146495819092, 115.85036659240723, 116.81701183319092, 117.78365707397461, 118.75170660018921, 119.71975612640381, 120.68476605415344, 121.64977598190308, 122.61733388900757, 123.58489179611206, 124.55049920082092, 125.51610660552979, 126.48326206207275, 127.45041751861572, 128.41558241844177, 129.38074731826782, 130.35953879356384, 131.33833026885986, 132.30378127098083, 133.2692322731018, 134.2315285205841, 135.1938247680664, 136.1582043170929, 137.12258386611938, 138.0893430709839, 139.0561022758484, 140.02327346801758, 140.99044466018677, 141.95707654953003, 142.9237084388733, 143.88909101486206, 144.85447359085083, 145.82028603553772, 146.7860984802246, 147.75186681747437, 148.71763515472412, 149.68257355690002, 150.64751195907593, 151.6135537624359, 152.5795955657959, 153.54430890083313, 154.50902223587036, 155.4782338142395, 156.44744539260864, 157.41422986984253, 158.38101434707642, 159.3496057987213, 160.3181972503662, 161.28312253952026, 162.24804782867432, 163.21515583992004, 164.18226385116577, 165.14854502677917, 166.11482620239258, 167.0928511619568, 168.070876121521, 169.0368890762329, 170.00290203094482, 170.97052597999573, 171.93814992904663, 172.90518617630005, 173.87222242355347, 174.83721041679382, 175.80219841003418, 176.76672267913818, 177.7312469482422, 178.69396948814392, 179.65669202804565, 180.62039852142334, 181.58410501480103, 182.54865169525146, 183.5131983757019, 184.47730493545532, 185.44141149520874, 186.40723299980164, 187.37305450439453, 188.33921837806702, 189.3053822517395, 190.27018809318542, 191.23499393463135, 192.20038032531738, 193.16576671600342, 194.13092374801636, 195.0960807800293, 196.06107592582703, 197.02607107162476, 197.98933219909668, 198.9525933265686, 199.91744589805603, 200.88229846954346, 201.84676837921143, 202.8112382888794, 204.7395761013031, 206.6679139137268]
[27.09, 27.09, 35.67, 35.67, 41.49, 41.49, 45.45, 45.45, 48.15, 48.15, 48.59, 48.59, 50.18, 50.18, 52.49, 52.49, 54.36, 54.36, 55.3, 55.3, 55.58, 55.58, 56.06, 56.06, 57.1, 57.1, 58.2, 58.2, 58.17, 58.17, 58.59, 58.59, 59.05, 59.05, 59.85, 59.85, 60.01, 60.01, 59.8, 59.8, 60.26, 60.26, 60.05, 60.05, 59.99, 59.99, 60.48, 60.48, 60.81, 60.81, 60.34, 60.34, 60.91, 60.91, 59.81, 59.81, 60.47, 60.47, 60.16, 60.16, 60.26, 60.26, 60.82, 60.82, 60.93, 60.93, 60.94, 60.94, 60.9, 60.9, 60.3, 60.3, 60.13, 60.13, 60.13, 60.13, 60.04, 60.04, 60.15, 60.15, 59.72, 59.72, 60.22, 60.22, 60.03, 60.03, 60.32, 60.32, 60.74, 60.74, 60.62, 60.62, 60.53, 60.53, 60.42, 60.42, 60.47, 60.47, 59.71, 59.71, 60.14, 60.14, 59.82, 59.82, 60.3, 60.3, 59.79, 59.79, 60.28, 60.28, 60.85, 60.85, 60.5, 60.5, 60.78, 60.78, 60.55, 60.55, 59.65, 59.65, 60.06, 60.06, 59.83, 59.83, 59.58, 59.58, 59.27, 59.27, 59.19, 59.19, 59.68, 59.68, 59.23, 59.23, 59.73, 59.73, 59.21, 59.21, 59.72, 59.72, 60.24, 60.24, 59.99, 59.99, 60.54, 60.54, 60.27, 60.27, 59.82, 59.82, 59.88, 59.88, 60.1, 60.1, 60.25, 60.25, 60.53, 60.53, 60.02, 60.02, 59.87, 59.87, 59.24, 59.24, 58.93, 58.93, 59.71, 59.71, 59.8, 59.8, 60.05, 60.05, 60.88, 60.88, 60.57, 60.57, 60.11, 60.11, 59.83, 59.83, 59.6, 59.6, 59.58, 59.58, 60.31, 60.31, 61.08, 61.08, 60.87, 60.87, 60.89, 60.89, 60.71, 60.71, 60.35, 60.35, 60.41, 60.41, 60.05, 60.05, 58.81, 58.81]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.659, Test loss: 2.071, Test accuracy: 21.45
Round   0, Global train loss: 1.659, Global test loss: 2.264, Global test accuracy: 16.30
Round   1, Train loss: 1.409, Test loss: 1.862, Test accuracy: 35.86
Round   1, Global train loss: 1.409, Global test loss: 2.166, Global test accuracy: 29.45
Round   2, Train loss: 1.321, Test loss: 1.519, Test accuracy: 42.89
Round   2, Global train loss: 1.321, Global test loss: 1.931, Global test accuracy: 35.00
Round   3, Train loss: 1.267, Test loss: 1.386, Test accuracy: 47.20
Round   3, Global train loss: 1.267, Global test loss: 1.884, Global test accuracy: 36.35
Round   4, Train loss: 1.187, Test loss: 1.297, Test accuracy: 49.28
Round   4, Global train loss: 1.187, Global test loss: 1.721, Global test accuracy: 36.55
Round   5, Train loss: 1.122, Test loss: 1.245, Test accuracy: 50.78
Round   5, Global train loss: 1.122, Global test loss: 1.688, Global test accuracy: 38.04
Round   6, Train loss: 1.139, Test loss: 1.153, Test accuracy: 54.42
Round   6, Global train loss: 1.139, Global test loss: 1.629, Global test accuracy: 42.93
Round   7, Train loss: 1.189, Test loss: 1.071, Test accuracy: 57.96
Round   7, Global train loss: 1.189, Global test loss: 1.661, Global test accuracy: 41.89
Round   8, Train loss: 1.092, Test loss: 1.011, Test accuracy: 60.26
Round   8, Global train loss: 1.092, Global test loss: 1.590, Global test accuracy: 40.75
Round   9, Train loss: 1.073, Test loss: 0.991, Test accuracy: 61.17
Round   9, Global train loss: 1.073, Global test loss: 1.665, Global test accuracy: 40.64
Round  10, Train loss: 0.995, Test loss: 0.979, Test accuracy: 61.78
Round  10, Global train loss: 0.995, Global test loss: 1.570, Global test accuracy: 46.89
Round  11, Train loss: 1.000, Test loss: 0.977, Test accuracy: 62.71
Round  11, Global train loss: 1.000, Global test loss: 1.605, Global test accuracy: 40.66
Round  12, Train loss: 0.952, Test loss: 0.972, Test accuracy: 62.98
Round  12, Global train loss: 0.952, Global test loss: 1.517, Global test accuracy: 48.18
Round  13, Train loss: 1.060, Test loss: 0.932, Test accuracy: 65.16
Round  13, Global train loss: 1.060, Global test loss: 1.406, Global test accuracy: 48.98
Round  14, Train loss: 0.975, Test loss: 0.921, Test accuracy: 65.11
Round  14, Global train loss: 0.975, Global test loss: 1.424, Global test accuracy: 49.47
Round  15, Train loss: 0.897, Test loss: 0.917, Test accuracy: 65.26
Round  15, Global train loss: 0.897, Global test loss: 1.298, Global test accuracy: 55.14
Round  16, Train loss: 0.865, Test loss: 0.913, Test accuracy: 65.45
Round  16, Global train loss: 0.865, Global test loss: 1.428, Global test accuracy: 50.02
Round  17, Train loss: 0.941, Test loss: 0.898, Test accuracy: 66.57
Round  17, Global train loss: 0.941, Global test loss: 1.391, Global test accuracy: 49.32
Round  18, Train loss: 0.849, Test loss: 0.899, Test accuracy: 65.91
Round  18, Global train loss: 0.849, Global test loss: 1.406, Global test accuracy: 51.59
Round  19, Train loss: 0.818, Test loss: 0.875, Test accuracy: 67.18
Round  19, Global train loss: 0.818, Global test loss: 1.292, Global test accuracy: 53.36
Round  20, Train loss: 0.828, Test loss: 0.867, Test accuracy: 67.45
Round  20, Global train loss: 0.828, Global test loss: 1.354, Global test accuracy: 53.40
Round  21, Train loss: 0.867, Test loss: 0.867, Test accuracy: 67.51
Round  21, Global train loss: 0.867, Global test loss: 1.366, Global test accuracy: 53.16
Round  22, Train loss: 0.820, Test loss: 0.892, Test accuracy: 67.30
Round  22, Global train loss: 0.820, Global test loss: 1.367, Global test accuracy: 51.24
Round  23, Train loss: 0.769, Test loss: 0.874, Test accuracy: 67.70
Round  23, Global train loss: 0.769, Global test loss: 1.263, Global test accuracy: 56.77
Round  24, Train loss: 0.739, Test loss: 0.842, Test accuracy: 69.09
Round  24, Global train loss: 0.739, Global test loss: 1.288, Global test accuracy: 54.98
Round  25, Train loss: 0.770, Test loss: 0.850, Test accuracy: 68.64
Round  25, Global train loss: 0.770, Global test loss: 1.460, Global test accuracy: 52.51
Round  26, Train loss: 0.781, Test loss: 0.838, Test accuracy: 68.90
Round  26, Global train loss: 0.781, Global test loss: 1.175, Global test accuracy: 57.80
Round  27, Train loss: 0.670, Test loss: 0.836, Test accuracy: 69.41
Round  27, Global train loss: 0.670, Global test loss: 1.255, Global test accuracy: 59.66
Round  28, Train loss: 0.822, Test loss: 0.832, Test accuracy: 70.16
Round  28, Global train loss: 0.822, Global test loss: 1.241, Global test accuracy: 55.82
Round  29, Train loss: 0.729, Test loss: 0.838, Test accuracy: 69.71
Round  29, Global train loss: 0.729, Global test loss: 1.200, Global test accuracy: 59.08
Round  30, Train loss: 0.715, Test loss: 0.841, Test accuracy: 69.82
Round  30, Global train loss: 0.715, Global test loss: 1.203, Global test accuracy: 57.58
Round  31, Train loss: 0.674, Test loss: 0.835, Test accuracy: 69.91
Round  31, Global train loss: 0.674, Global test loss: 1.392, Global test accuracy: 54.33
Round  32, Train loss: 0.655, Test loss: 0.832, Test accuracy: 70.21
Round  32, Global train loss: 0.655, Global test loss: 1.188, Global test accuracy: 59.96
Round  33, Train loss: 0.634, Test loss: 0.820, Test accuracy: 70.83
Round  33, Global train loss: 0.634, Global test loss: 1.286, Global test accuracy: 54.99
Round  34, Train loss: 0.614, Test loss: 0.843, Test accuracy: 70.20
Round  34, Global train loss: 0.614, Global test loss: 1.203, Global test accuracy: 58.43
Round  35, Train loss: 0.680, Test loss: 0.839, Test accuracy: 70.47
Round  35, Global train loss: 0.680, Global test loss: 1.421, Global test accuracy: 51.40
Round  36, Train loss: 0.657, Test loss: 0.839, Test accuracy: 70.95
Round  36, Global train loss: 0.657, Global test loss: 1.257, Global test accuracy: 58.49
Round  37, Train loss: 0.651, Test loss: 0.824, Test accuracy: 71.43
Round  37, Global train loss: 0.651, Global test loss: 1.177, Global test accuracy: 59.55
Round  38, Train loss: 0.552, Test loss: 0.806, Test accuracy: 71.69
Round  38, Global train loss: 0.552, Global test loss: 1.252, Global test accuracy: 58.76
Round  39, Train loss: 0.688, Test loss: 0.802, Test accuracy: 72.06
Round  39, Global train loss: 0.688, Global test loss: 1.170, Global test accuracy: 59.28
Round  40, Train loss: 0.555, Test loss: 0.782, Test accuracy: 72.73
Round  40, Global train loss: 0.555, Global test loss: 1.402, Global test accuracy: 56.37
Round  41, Train loss: 0.631, Test loss: 0.782, Test accuracy: 72.41
Round  41, Global train loss: 0.631, Global test loss: 1.414, Global test accuracy: 55.76
Round  42, Train loss: 0.633, Test loss: 0.795, Test accuracy: 72.21
Round  42, Global train loss: 0.633, Global test loss: 1.211, Global test accuracy: 57.70
Round  43, Train loss: 0.504, Test loss: 0.799, Test accuracy: 72.44
Round  43, Global train loss: 0.504, Global test loss: 1.165, Global test accuracy: 61.21
Round  44, Train loss: 0.573, Test loss: 0.797, Test accuracy: 72.11
Round  44, Global train loss: 0.573, Global test loss: 1.105, Global test accuracy: 62.33
Round  45, Train loss: 0.528, Test loss: 0.813, Test accuracy: 71.98
Round  45, Global train loss: 0.528, Global test loss: 1.094, Global test accuracy: 63.22
Round  46, Train loss: 0.573, Test loss: 0.827, Test accuracy: 72.19
Round  46, Global train loss: 0.573, Global test loss: 1.180, Global test accuracy: 61.79
Round  47, Train loss: 0.501, Test loss: 0.833, Test accuracy: 72.37
Round  47, Global train loss: 0.501, Global test loss: 1.257, Global test accuracy: 59.19
Round  48, Train loss: 0.571, Test loss: 0.838, Test accuracy: 72.62
Round  48, Global train loss: 0.571, Global test loss: 1.215, Global test accuracy: 59.96
Round  49, Train loss: 0.531, Test loss: 0.873, Test accuracy: 71.90
Round  49, Global train loss: 0.531, Global test loss: 1.280, Global test accuracy: 58.30
Round  50, Train loss: 0.555, Test loss: 0.861, Test accuracy: 71.95
Round  50, Global train loss: 0.555, Global test loss: 1.114, Global test accuracy: 62.99
Round  51, Train loss: 0.489, Test loss: 0.855, Test accuracy: 72.07
Round  51, Global train loss: 0.489, Global test loss: 1.267, Global test accuracy: 61.65
Round  52, Train loss: 0.596, Test loss: 0.855, Test accuracy: 72.35
Round  52, Global train loss: 0.596, Global test loss: 1.416, Global test accuracy: 54.88
Round  53, Train loss: 0.453, Test loss: 0.855, Test accuracy: 72.42
Round  53, Global train loss: 0.453, Global test loss: 1.345, Global test accuracy: 58.90
Round  54, Train loss: 0.492, Test loss: 0.857, Test accuracy: 72.36
Round  54, Global train loss: 0.492, Global test loss: 1.187, Global test accuracy: 61.95
Round  55, Train loss: 0.445, Test loss: 0.886, Test accuracy: 72.02
Round  55, Global train loss: 0.445, Global test loss: 1.267, Global test accuracy: 59.42
Round  56, Train loss: 0.413, Test loss: 0.890, Test accuracy: 71.94
Round  56, Global train loss: 0.413, Global test loss: 1.125, Global test accuracy: 63.64
Round  57, Train loss: 0.414, Test loss: 0.915, Test accuracy: 71.82
Round  57, Global train loss: 0.414, Global test loss: 1.292, Global test accuracy: 59.66
Round  58, Train loss: 0.509, Test loss: 0.899, Test accuracy: 72.54
Round  58, Global train loss: 0.509, Global test loss: 1.140, Global test accuracy: 62.20
Round  59, Train loss: 0.551, Test loss: 0.878, Test accuracy: 72.76
Round  59, Global train loss: 0.551, Global test loss: 1.174, Global test accuracy: 61.29
Round  60, Train loss: 0.534, Test loss: 0.844, Test accuracy: 73.42
Round  60, Global train loss: 0.534, Global test loss: 1.362, Global test accuracy: 56.98
Round  61, Train loss: 0.443, Test loss: 0.843, Test accuracy: 73.70
Round  61, Global train loss: 0.443, Global test loss: 1.355, Global test accuracy: 59.62
Round  62, Train loss: 0.429, Test loss: 0.858, Test accuracy: 73.16
Round  62, Global train loss: 0.429, Global test loss: 1.310, Global test accuracy: 60.62
Round  63, Train loss: 0.488, Test loss: 0.879, Test accuracy: 72.71
Round  63, Global train loss: 0.488, Global test loss: 1.362, Global test accuracy: 57.91
Round  64, Train loss: 0.472, Test loss: 0.883, Test accuracy: 72.48
Round  64, Global train loss: 0.472, Global test loss: 1.100, Global test accuracy: 63.29
Round  65, Train loss: 0.548, Test loss: 0.875, Test accuracy: 72.38
Round  65, Global train loss: 0.548, Global test loss: 1.337, Global test accuracy: 56.89
Round  66, Train loss: 0.441, Test loss: 0.869, Test accuracy: 72.86
Round  66, Global train loss: 0.441, Global test loss: 1.378, Global test accuracy: 55.75
Round  67, Train loss: 0.440, Test loss: 0.878, Test accuracy: 73.03
Round  67, Global train loss: 0.440, Global test loss: 1.459, Global test accuracy: 54.30
Round  68, Train loss: 0.436, Test loss: 0.883, Test accuracy: 73.21
Round  68, Global train loss: 0.436, Global test loss: 1.406, Global test accuracy: 59.58
Round  69, Train loss: 0.422, Test loss: 0.894, Test accuracy: 72.90
Round  69, Global train loss: 0.422, Global test loss: 1.199, Global test accuracy: 62.93
Round  70, Train loss: 0.454, Test loss: 0.901, Test accuracy: 72.53
Round  70, Global train loss: 0.454, Global test loss: 1.269, Global test accuracy: 61.68
Round  71, Train loss: 0.401, Test loss: 0.883, Test accuracy: 73.23
Round  71, Global train loss: 0.401, Global test loss: 1.241, Global test accuracy: 60.77
Round  72, Train loss: 0.352, Test loss: 0.879, Test accuracy: 73.58
Round  72, Global train loss: 0.352, Global test loss: 1.154, Global test accuracy: 63.65
Round  73, Train loss: 0.448, Test loss: 0.895, Test accuracy: 73.43
Round  73, Global train loss: 0.448, Global test loss: 1.280, Global test accuracy: 60.37
Round  74, Train loss: 0.350, Test loss: 0.909, Test accuracy: 73.37
Round  74, Global train loss: 0.350, Global test loss: 1.298, Global test accuracy: 61.55
Round  75, Train loss: 0.392, Test loss: 0.899, Test accuracy: 73.62
Round  75, Global train loss: 0.392, Global test loss: 1.278, Global test accuracy: 60.22
Round  76, Train loss: 0.315, Test loss: 0.901, Test accuracy: 74.06
Round  76, Global train loss: 0.315, Global test loss: 1.533, Global test accuracy: 58.92
Round  77, Train loss: 0.441, Test loss: 0.916, Test accuracy: 73.74
Round  77, Global train loss: 0.441, Global test loss: 1.171, Global test accuracy: 63.08
Round  78, Train loss: 0.354, Test loss: 0.908, Test accuracy: 73.88
Round  78, Global train loss: 0.354, Global test loss: 1.399, Global test accuracy: 60.91
Round  79, Train loss: 0.345, Test loss: 0.909, Test accuracy: 73.82
Round  79, Global train loss: 0.345, Global test loss: 1.240, Global test accuracy: 63.09
Round  80, Train loss: 0.345, Test loss: 0.918, Test accuracy: 73.81
Round  80, Global train loss: 0.345, Global test loss: 1.213, Global test accuracy: 63.79
Round  81, Train loss: 0.480, Test loss: 0.914, Test accuracy: 73.63
Round  81, Global train loss: 0.480, Global test loss: 1.216, Global test accuracy: 61.56
Round  82, Train loss: 0.311, Test loss: 0.902, Test accuracy: 73.93
Round  82, Global train loss: 0.311, Global test loss: 1.295, Global test accuracy: 63.13
Round  83, Train loss: 0.327, Test loss: 0.938, Test accuracy: 73.50
Round  83, Global train loss: 0.327, Global test loss: 1.252, Global test accuracy: 62.16
Round  84, Train loss: 0.402, Test loss: 0.953, Test accuracy: 73.69
Round  84, Global train loss: 0.402, Global test loss: 1.307, Global test accuracy: 61.07
Round  85, Train loss: 0.395, Test loss: 0.941, Test accuracy: 73.89
Round  85, Global train loss: 0.395, Global test loss: 1.257, Global test accuracy: 61.01
Round  86, Train loss: 0.379, Test loss: 0.949, Test accuracy: 73.69
Round  86, Global train loss: 0.379, Global test loss: 1.326, Global test accuracy: 61.14
Round  87, Train loss: 0.398, Test loss: 0.939, Test accuracy: 73.67
Round  87, Global train loss: 0.398, Global test loss: 1.416, Global test accuracy: 58.57
Round  88, Train loss: 0.380, Test loss: 0.954, Test accuracy: 73.13
Round  88, Global train loss: 0.380, Global test loss: 1.164, Global test accuracy: 64.33
Round  89, Train loss: 0.376, Test loss: 0.960, Test accuracy: 72.60
Round  89, Global train loss: 0.376, Global test loss: 1.418, Global test accuracy: 58.81
Round  90, Train loss: 0.406, Test loss: 0.956, Test accuracy: 72.73
Round  90, Global train loss: 0.406, Global test loss: 1.280, Global test accuracy: 61.52
Round  91, Train loss: 0.368, Test loss: 0.986, Test accuracy: 72.36
Round  91, Global train loss: 0.368, Global test loss: 1.245, Global test accuracy: 62.48
Round  92, Train loss: 0.328, Test loss: 0.964, Test accuracy: 72.20
Round  92, Global train loss: 0.328, Global test loss: 1.167, Global test accuracy: 63.63
Round  93, Train loss: 0.352, Test loss: 0.944, Test accuracy: 72.70
Round  93, Global train loss: 0.352, Global test loss: 1.355, Global test accuracy: 60.45
Round  94, Train loss: 0.303, Test loss: 0.941, Test accuracy: 72.89
Round  94, Global train loss: 0.303, Global test loss: 1.578, Global test accuracy: 58.32
Round  95, Train loss: 0.345, Test loss: 0.937, Test accuracy: 73.47
Round  95, Global train loss: 0.345, Global test loss: 1.187, Global test accuracy: 63.16
Round  96, Train loss: 0.368, Test loss: 0.926, Test accuracy: 73.86
Round  96, Global train loss: 0.368, Global test loss: 1.283, Global test accuracy: 62.21
Round  97, Train loss: 0.292, Test loss: 0.903, Test accuracy: 74.13
Round  97, Global train loss: 0.292, Global test loss: 1.201, Global test accuracy: 64.76
Round  98, Train loss: 0.362, Test loss: 0.903, Test accuracy: 74.33
Round  98, Global train loss: 0.362, Global test loss: 1.273, Global test accuracy: 63.21
Round  99, Train loss: 0.317, Test loss: 0.933, Test accuracy: 74.20
Round  99, Global train loss: 0.317, Global test loss: 1.228, Global test accuracy: 63.61
Final Round, Train loss: 0.263, Test loss: 1.036, Test accuracy: 74.04
Final Round, Global train loss: 0.263, Global test loss: 1.228, Global test accuracy: 63.61
Average accuracy final 10 rounds: 73.28699999999999 

Average global accuracy final 10 rounds: 62.335 

1360.8772101402283
[1.426630973815918, 2.853261947631836, 3.9896183013916016, 5.125974655151367, 6.262512922286987, 7.399051189422607, 8.533873558044434, 9.66869592666626, 10.801469564437866, 11.934243202209473, 13.102622747421265, 14.271002292633057, 15.401669263839722, 16.532336235046387, 17.667457818984985, 18.802579402923584, 19.937702894210815, 21.072826385498047, 22.205703496932983, 23.33858060836792, 24.47041392326355, 25.60224723815918, 26.735494136810303, 27.868741035461426, 29.003329753875732, 30.13791847229004, 31.263187885284424, 32.38845729827881, 33.52045035362244, 34.652443408966064, 35.77658176422119, 36.90072011947632, 38.025468826293945, 39.15021753311157, 40.28173828125, 41.41325902938843, 42.55179810523987, 43.69033718109131, 44.824301958084106, 45.958266735076904, 47.092036724090576, 48.22580671310425, 49.354976654052734, 50.48414659500122, 51.61414194107056, 52.74413728713989, 53.87506103515625, 55.00598478317261, 56.14457178115845, 57.28315877914429, 58.4149112701416, 59.546663761138916, 60.68267107009888, 61.81867837905884, 62.95451021194458, 64.09034204483032, 65.22225952148438, 66.35417699813843, 67.49073624610901, 68.62729549407959, 69.75434041023254, 70.8813853263855, 72.0130250453949, 73.1446647644043, 74.27357172966003, 75.40247869491577, 76.54045104980469, 77.6784234046936, 78.82445025444031, 79.97047710418701, 81.10251808166504, 82.23455905914307, 83.36471772193909, 84.49487638473511, 85.62564659118652, 86.75641679763794, 87.88195276260376, 89.00748872756958, 90.12576985359192, 91.24405097961426, 92.36431503295898, 93.48457908630371, 94.60777115821838, 95.73096323013306, 96.85630631446838, 97.98164939880371, 99.10931444168091, 100.2369794845581, 101.36353492736816, 102.49009037017822, 103.61152696609497, 104.73296356201172, 105.86220788955688, 106.99145221710205, 108.11414217948914, 109.23683214187622, 110.35999655723572, 111.48316097259521, 112.6105010509491, 113.73784112930298, 114.85923314094543, 115.98062515258789, 117.11070442199707, 118.24078369140625, 119.36562132835388, 120.49045896530151, 121.61753487586975, 122.74461078643799, 123.87024116516113, 124.99587154388428, 126.12139463424683, 127.24691772460938, 128.3753945827484, 129.50387144088745, 130.62776136398315, 131.75165128707886, 132.88836240768433, 134.0250735282898, 135.15699338912964, 136.28891324996948, 137.4200427532196, 138.55117225646973, 139.68373155593872, 140.81629085540771, 141.9507737159729, 143.0852565765381, 144.22168445587158, 145.35811233520508, 146.48972177505493, 147.62133121490479, 148.75513982772827, 149.88894844055176, 151.02678084373474, 152.16461324691772, 153.29433798789978, 154.42406272888184, 155.56166005134583, 156.69925737380981, 157.82332730293274, 158.94739723205566, 160.0788698196411, 161.21034240722656, 162.34162163734436, 163.47290086746216, 164.60160994529724, 165.73031902313232, 166.86309432983398, 167.99586963653564, 169.12774682044983, 170.259624004364, 171.39878845214844, 172.53795289993286, 173.67149472236633, 174.8050365447998, 175.93830513954163, 177.07157373428345, 178.20936751365662, 179.34716129302979, 180.48105716705322, 181.61495304107666, 182.7449288368225, 183.87490463256836, 184.99491429328918, 186.11492395401, 187.2356560230255, 188.35638809204102, 189.4759476184845, 190.59550714492798, 191.7117145061493, 192.8279218673706, 193.9477162361145, 195.0675106048584, 196.1894953250885, 197.3114800453186, 198.42833137512207, 199.54518270492554, 200.66474080085754, 201.78429889678955, 202.89984965324402, 204.0154004096985, 205.18120908737183, 206.34701776504517, 207.47169589996338, 208.5963740348816, 209.71955823898315, 210.84274244308472, 211.96658062934875, 213.0904188156128, 214.20483541488647, 215.31925201416016, 216.436110496521, 217.55296897888184, 218.67035913467407, 219.7877492904663, 220.9054045677185, 222.0230598449707, 223.1461353302002, 224.2692108154297, 225.38700795173645, 226.5048050880432, 228.75751781463623, 231.01023054122925]
[21.45, 21.45, 35.86, 35.86, 42.89, 42.89, 47.2, 47.2, 49.28, 49.28, 50.78, 50.78, 54.42, 54.42, 57.96, 57.96, 60.26, 60.26, 61.17, 61.17, 61.78, 61.78, 62.71, 62.71, 62.98, 62.98, 65.16, 65.16, 65.11, 65.11, 65.26, 65.26, 65.45, 65.45, 66.57, 66.57, 65.91, 65.91, 67.18, 67.18, 67.45, 67.45, 67.51, 67.51, 67.3, 67.3, 67.7, 67.7, 69.09, 69.09, 68.64, 68.64, 68.9, 68.9, 69.41, 69.41, 70.16, 70.16, 69.71, 69.71, 69.82, 69.82, 69.91, 69.91, 70.21, 70.21, 70.83, 70.83, 70.2, 70.2, 70.47, 70.47, 70.95, 70.95, 71.43, 71.43, 71.69, 71.69, 72.06, 72.06, 72.73, 72.73, 72.41, 72.41, 72.21, 72.21, 72.44, 72.44, 72.11, 72.11, 71.98, 71.98, 72.19, 72.19, 72.37, 72.37, 72.62, 72.62, 71.9, 71.9, 71.95, 71.95, 72.07, 72.07, 72.35, 72.35, 72.42, 72.42, 72.36, 72.36, 72.02, 72.02, 71.94, 71.94, 71.82, 71.82, 72.54, 72.54, 72.76, 72.76, 73.42, 73.42, 73.7, 73.7, 73.16, 73.16, 72.71, 72.71, 72.48, 72.48, 72.38, 72.38, 72.86, 72.86, 73.03, 73.03, 73.21, 73.21, 72.9, 72.9, 72.53, 72.53, 73.23, 73.23, 73.58, 73.58, 73.43, 73.43, 73.37, 73.37, 73.62, 73.62, 74.06, 74.06, 73.74, 73.74, 73.88, 73.88, 73.82, 73.82, 73.81, 73.81, 73.63, 73.63, 73.93, 73.93, 73.5, 73.5, 73.69, 73.69, 73.89, 73.89, 73.69, 73.69, 73.67, 73.67, 73.13, 73.13, 72.6, 72.6, 72.73, 72.73, 72.36, 72.36, 72.2, 72.2, 72.7, 72.7, 72.89, 72.89, 73.47, 73.47, 73.86, 73.86, 74.13, 74.13, 74.33, 74.33, 74.2, 74.2, 74.04, 74.04]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.643, Test loss: 2.008, Test accuracy: 24.27
Round   0, Global train loss: 1.643, Global test loss: 2.195, Global test accuracy: 19.78
Round   1, Train loss: 1.455, Test loss: 1.846, Test accuracy: 35.30
Round   1, Global train loss: 1.455, Global test loss: 2.122, Global test accuracy: 29.65
Round   2, Train loss: 1.294, Test loss: 1.605, Test accuracy: 41.77
Round   2, Global train loss: 1.294, Global test loss: 2.079, Global test accuracy: 34.06
Round   3, Train loss: 1.250, Test loss: 1.437, Test accuracy: 44.74
Round   3, Global train loss: 1.250, Global test loss: 1.979, Global test accuracy: 35.28
Round   4, Train loss: 1.239, Test loss: 1.319, Test accuracy: 47.80
Round   4, Global train loss: 1.239, Global test loss: 1.751, Global test accuracy: 35.39
Round   5, Train loss: 1.172, Test loss: 1.271, Test accuracy: 49.51
Round   5, Global train loss: 1.172, Global test loss: 1.765, Global test accuracy: 35.64
Round   6, Train loss: 1.106, Test loss: 1.186, Test accuracy: 53.53
Round   6, Global train loss: 1.106, Global test loss: 1.677, Global test accuracy: 40.40
Round   7, Train loss: 1.194, Test loss: 1.086, Test accuracy: 57.09
Round   7, Global train loss: 1.194, Global test loss: 1.661, Global test accuracy: 37.82
Round   8, Train loss: 1.135, Test loss: 1.051, Test accuracy: 57.82
Round   8, Global train loss: 1.135, Global test loss: 1.649, Global test accuracy: 40.14
Round   9, Train loss: 1.064, Test loss: 1.040, Test accuracy: 58.09
Round   9, Global train loss: 1.064, Global test loss: 1.703, Global test accuracy: 41.29
Round  10, Train loss: 1.040, Test loss: 1.002, Test accuracy: 60.23
Round  10, Global train loss: 1.040, Global test loss: 1.616, Global test accuracy: 44.79
Round  11, Train loss: 1.031, Test loss: 1.016, Test accuracy: 59.86
Round  11, Global train loss: 1.031, Global test loss: 1.580, Global test accuracy: 43.65
Round  12, Train loss: 1.017, Test loss: 0.997, Test accuracy: 60.73
Round  12, Global train loss: 1.017, Global test loss: 1.524, Global test accuracy: 46.04
Round  13, Train loss: 1.065, Test loss: 0.977, Test accuracy: 62.52
Round  13, Global train loss: 1.065, Global test loss: 1.397, Global test accuracy: 49.12
Round  14, Train loss: 1.068, Test loss: 0.957, Test accuracy: 63.39
Round  14, Global train loss: 1.068, Global test loss: 1.386, Global test accuracy: 49.70
Round  15, Train loss: 0.923, Test loss: 0.939, Test accuracy: 63.60
Round  15, Global train loss: 0.923, Global test loss: 1.339, Global test accuracy: 52.47
Round  16, Train loss: 0.967, Test loss: 0.924, Test accuracy: 64.66
Round  16, Global train loss: 0.967, Global test loss: 1.403, Global test accuracy: 49.86
Round  17, Train loss: 0.981, Test loss: 0.929, Test accuracy: 64.50
Round  17, Global train loss: 0.981, Global test loss: 1.379, Global test accuracy: 50.05
Round  18, Train loss: 0.915, Test loss: 0.928, Test accuracy: 64.70
Round  18, Global train loss: 0.915, Global test loss: 1.427, Global test accuracy: 49.61
Round  19, Train loss: 0.920, Test loss: 0.916, Test accuracy: 65.64
Round  19, Global train loss: 0.920, Global test loss: 1.335, Global test accuracy: 51.36
Round  20, Train loss: 0.921, Test loss: 0.900, Test accuracy: 66.03
Round  20, Global train loss: 0.921, Global test loss: 1.373, Global test accuracy: 50.96
Round  21, Train loss: 0.868, Test loss: 0.886, Test accuracy: 66.73
Round  21, Global train loss: 0.868, Global test loss: 1.377, Global test accuracy: 51.23
Round  22, Train loss: 0.849, Test loss: 0.900, Test accuracy: 66.36
Round  22, Global train loss: 0.849, Global test loss: 1.296, Global test accuracy: 52.56
Round  23, Train loss: 0.791, Test loss: 0.884, Test accuracy: 66.75
Round  23, Global train loss: 0.791, Global test loss: 1.311, Global test accuracy: 52.38
Round  24, Train loss: 0.835, Test loss: 0.878, Test accuracy: 67.07
Round  24, Global train loss: 0.835, Global test loss: 1.294, Global test accuracy: 53.97
Round  25, Train loss: 0.874, Test loss: 0.873, Test accuracy: 67.47
Round  25, Global train loss: 0.874, Global test loss: 1.450, Global test accuracy: 52.61
Round  26, Train loss: 0.854, Test loss: 0.841, Test accuracy: 68.77
Round  26, Global train loss: 0.854, Global test loss: 1.300, Global test accuracy: 52.48
Round  27, Train loss: 0.747, Test loss: 0.853, Test accuracy: 68.59
Round  27, Global train loss: 0.747, Global test loss: 1.217, Global test accuracy: 57.22
Round  28, Train loss: 0.849, Test loss: 0.852, Test accuracy: 68.69
Round  28, Global train loss: 0.849, Global test loss: 1.264, Global test accuracy: 54.42
Round  29, Train loss: 0.800, Test loss: 0.853, Test accuracy: 68.93
Round  29, Global train loss: 0.800, Global test loss: 1.231, Global test accuracy: 58.31
Round  30, Train loss: 0.694, Test loss: 0.860, Test accuracy: 68.37
Round  30, Global train loss: 0.694, Global test loss: 1.242, Global test accuracy: 56.59
Round  31, Train loss: 0.765, Test loss: 0.849, Test accuracy: 68.44
Round  31, Global train loss: 0.765, Global test loss: 1.288, Global test accuracy: 54.85
Round  32, Train loss: 0.733, Test loss: 0.830, Test accuracy: 69.05
Round  32, Global train loss: 0.733, Global test loss: 1.171, Global test accuracy: 58.66
Round  33, Train loss: 0.744, Test loss: 0.829, Test accuracy: 69.31
Round  33, Global train loss: 0.744, Global test loss: 1.275, Global test accuracy: 54.82
Round  34, Train loss: 0.665, Test loss: 0.816, Test accuracy: 69.79
Round  34, Global train loss: 0.665, Global test loss: 1.272, Global test accuracy: 55.77
Round  35, Train loss: 0.815, Test loss: 0.803, Test accuracy: 70.51
Round  35, Global train loss: 0.815, Global test loss: 1.314, Global test accuracy: 52.65
Round  36, Train loss: 0.670, Test loss: 0.789, Test accuracy: 71.21
Round  36, Global train loss: 0.670, Global test loss: 1.246, Global test accuracy: 56.80
Round  37, Train loss: 0.706, Test loss: 0.784, Test accuracy: 71.18
Round  37, Global train loss: 0.706, Global test loss: 1.207, Global test accuracy: 56.78
Round  38, Train loss: 0.619, Test loss: 0.787, Test accuracy: 70.74
Round  38, Global train loss: 0.619, Global test loss: 1.197, Global test accuracy: 58.29
Round  39, Train loss: 0.724, Test loss: 0.790, Test accuracy: 70.75
Round  39, Global train loss: 0.724, Global test loss: 1.127, Global test accuracy: 60.02
Round  40, Train loss: 0.628, Test loss: 0.801, Test accuracy: 70.39
Round  40, Global train loss: 0.628, Global test loss: 1.364, Global test accuracy: 54.79
Round  41, Train loss: 0.711, Test loss: 0.794, Test accuracy: 70.66
Round  41, Global train loss: 0.711, Global test loss: 1.350, Global test accuracy: 56.40
Round  42, Train loss: 0.693, Test loss: 0.821, Test accuracy: 70.19
Round  42, Global train loss: 0.693, Global test loss: 1.174, Global test accuracy: 56.97
Round  43, Train loss: 0.638, Test loss: 0.803, Test accuracy: 71.08
Round  43, Global train loss: 0.638, Global test loss: 1.212, Global test accuracy: 58.06
Round  44, Train loss: 0.625, Test loss: 0.816, Test accuracy: 71.14
Round  44, Global train loss: 0.625, Global test loss: 1.087, Global test accuracy: 61.46
Round  45, Train loss: 0.567, Test loss: 0.812, Test accuracy: 71.30
Round  45, Global train loss: 0.567, Global test loss: 1.086, Global test accuracy: 62.70
Round  46, Train loss: 0.603, Test loss: 0.826, Test accuracy: 70.75
Round  46, Global train loss: 0.603, Global test loss: 1.164, Global test accuracy: 60.01
Round  47, Train loss: 0.618, Test loss: 0.814, Test accuracy: 71.44
Round  47, Global train loss: 0.618, Global test loss: 1.234, Global test accuracy: 58.76
Round  48, Train loss: 0.622, Test loss: 0.797, Test accuracy: 72.28
Round  48, Global train loss: 0.622, Global test loss: 1.229, Global test accuracy: 58.28
Round  49, Train loss: 0.614, Test loss: 0.782, Test accuracy: 72.04
Round  49, Global train loss: 0.614, Global test loss: 1.232, Global test accuracy: 57.75
Round  50, Train loss: 0.590, Test loss: 0.779, Test accuracy: 72.72
Round  50, Global train loss: 0.590, Global test loss: 1.113, Global test accuracy: 61.75
Round  51, Train loss: 0.531, Test loss: 0.788, Test accuracy: 72.39
Round  51, Global train loss: 0.531, Global test loss: 1.203, Global test accuracy: 60.78
Round  52, Train loss: 0.687, Test loss: 0.816, Test accuracy: 71.57
Round  52, Global train loss: 0.687, Global test loss: 1.306, Global test accuracy: 55.77
Round  53, Train loss: 0.505, Test loss: 0.830, Test accuracy: 71.38
Round  53, Global train loss: 0.505, Global test loss: 1.267, Global test accuracy: 58.93
Round  54, Train loss: 0.520, Test loss: 0.820, Test accuracy: 71.60
Round  54, Global train loss: 0.520, Global test loss: 1.167, Global test accuracy: 61.54
Round  55, Train loss: 0.553, Test loss: 0.824, Test accuracy: 71.81
Round  55, Global train loss: 0.553, Global test loss: 1.196, Global test accuracy: 60.00
Round  56, Train loss: 0.515, Test loss: 0.808, Test accuracy: 72.38
Round  56, Global train loss: 0.515, Global test loss: 1.153, Global test accuracy: 61.87
Round  57, Train loss: 0.508, Test loss: 0.808, Test accuracy: 71.85
Round  57, Global train loss: 0.508, Global test loss: 1.234, Global test accuracy: 59.06
Round  58, Train loss: 0.577, Test loss: 0.819, Test accuracy: 72.14
Round  58, Global train loss: 0.577, Global test loss: 1.078, Global test accuracy: 63.22
Round  59, Train loss: 0.553, Test loss: 0.806, Test accuracy: 72.60
Round  59, Global train loss: 0.553, Global test loss: 1.162, Global test accuracy: 61.21
Round  60, Train loss: 0.552, Test loss: 0.840, Test accuracy: 71.92
Round  60, Global train loss: 0.552, Global test loss: 1.292, Global test accuracy: 57.43
Round  61, Train loss: 0.492, Test loss: 0.823, Test accuracy: 72.55
Round  61, Global train loss: 0.492, Global test loss: 1.248, Global test accuracy: 59.88
Round  62, Train loss: 0.499, Test loss: 0.825, Test accuracy: 72.07
Round  62, Global train loss: 0.499, Global test loss: 1.265, Global test accuracy: 59.10
Round  63, Train loss: 0.498, Test loss: 0.804, Test accuracy: 72.67
Round  63, Global train loss: 0.498, Global test loss: 1.238, Global test accuracy: 59.51
Round  64, Train loss: 0.525, Test loss: 0.801, Test accuracy: 72.66
Round  64, Global train loss: 0.525, Global test loss: 1.083, Global test accuracy: 63.34
Round  65, Train loss: 0.539, Test loss: 0.802, Test accuracy: 72.83
Round  65, Global train loss: 0.539, Global test loss: 1.197, Global test accuracy: 59.56
Round  66, Train loss: 0.514, Test loss: 0.825, Test accuracy: 72.66
Round  66, Global train loss: 0.514, Global test loss: 1.277, Global test accuracy: 57.35
Round  67, Train loss: 0.495, Test loss: 0.813, Test accuracy: 73.07
Round  67, Global train loss: 0.495, Global test loss: 1.288, Global test accuracy: 57.47
Round  68, Train loss: 0.471, Test loss: 0.828, Test accuracy: 72.99
Round  68, Global train loss: 0.471, Global test loss: 1.271, Global test accuracy: 59.96
Round  69, Train loss: 0.450, Test loss: 0.843, Test accuracy: 72.78
Round  69, Global train loss: 0.450, Global test loss: 1.144, Global test accuracy: 63.13
Round  70, Train loss: 0.440, Test loss: 0.842, Test accuracy: 73.11
Round  70, Global train loss: 0.440, Global test loss: 1.201, Global test accuracy: 61.30
Round  71, Train loss: 0.396, Test loss: 0.860, Test accuracy: 73.04
Round  71, Global train loss: 0.396, Global test loss: 1.170, Global test accuracy: 61.61
Round  72, Train loss: 0.454, Test loss: 0.847, Test accuracy: 73.08
Round  72, Global train loss: 0.454, Global test loss: 1.167, Global test accuracy: 62.25
Round  73, Train loss: 0.509, Test loss: 0.850, Test accuracy: 72.96
Round  73, Global train loss: 0.509, Global test loss: 1.182, Global test accuracy: 61.64
Round  74, Train loss: 0.408, Test loss: 0.830, Test accuracy: 73.76
Round  74, Global train loss: 0.408, Global test loss: 1.181, Global test accuracy: 62.80
Round  75, Train loss: 0.468, Test loss: 0.860, Test accuracy: 72.62
Round  75, Global train loss: 0.468, Global test loss: 1.197, Global test accuracy: 61.28
Round  76, Train loss: 0.430, Test loss: 0.842, Test accuracy: 73.10
Round  76, Global train loss: 0.430, Global test loss: 1.380, Global test accuracy: 60.12
Round  77, Train loss: 0.437, Test loss: 0.856, Test accuracy: 72.95
Round  77, Global train loss: 0.437, Global test loss: 1.145, Global test accuracy: 62.56
Round  78, Train loss: 0.416, Test loss: 0.847, Test accuracy: 73.25
Round  78, Global train loss: 0.416, Global test loss: 1.269, Global test accuracy: 62.05
Round  79, Train loss: 0.391, Test loss: 0.844, Test accuracy: 73.53
Round  79, Global train loss: 0.391, Global test loss: 1.222, Global test accuracy: 62.79
Round  80, Train loss: 0.399, Test loss: 0.845, Test accuracy: 73.51
Round  80, Global train loss: 0.399, Global test loss: 1.139, Global test accuracy: 64.24
Round  81, Train loss: 0.494, Test loss: 0.869, Test accuracy: 73.32
Round  81, Global train loss: 0.494, Global test loss: 1.151, Global test accuracy: 62.73
Round  82, Train loss: 0.369, Test loss: 0.863, Test accuracy: 73.66
Round  82, Global train loss: 0.369, Global test loss: 1.206, Global test accuracy: 63.70
Round  83, Train loss: 0.369, Test loss: 0.867, Test accuracy: 73.47
Round  83, Global train loss: 0.369, Global test loss: 1.240, Global test accuracy: 62.37
Round  84, Train loss: 0.421, Test loss: 0.870, Test accuracy: 73.69
Round  84, Global train loss: 0.421, Global test loss: 1.363, Global test accuracy: 59.84
Round  85, Train loss: 0.411, Test loss: 0.868, Test accuracy: 73.94
Round  85, Global train loss: 0.411, Global test loss: 1.208, Global test accuracy: 61.75
Round  86, Train loss: 0.381, Test loss: 0.864, Test accuracy: 73.92
Round  86, Global train loss: 0.381, Global test loss: 1.221, Global test accuracy: 63.35
Round  87, Train loss: 0.446, Test loss: 0.870, Test accuracy: 73.66
Round  87, Global train loss: 0.446, Global test loss: 1.269, Global test accuracy: 61.22
Round  88, Train loss: 0.416, Test loss: 0.867, Test accuracy: 73.51
Round  88, Global train loss: 0.416, Global test loss: 1.095, Global test accuracy: 65.58
Round  89, Train loss: 0.389, Test loss: 0.866, Test accuracy: 73.52
Round  89, Global train loss: 0.389, Global test loss: 1.224, Global test accuracy: 62.80
Round  90, Train loss: 0.421, Test loss: 0.874, Test accuracy: 73.36
Round  90, Global train loss: 0.421, Global test loss: 1.207, Global test accuracy: 62.83
Round  91, Train loss: 0.435, Test loss: 0.886, Test accuracy: 73.51
Round  91, Global train loss: 0.435, Global test loss: 1.199, Global test accuracy: 62.25
Round  92, Train loss: 0.397, Test loss: 0.891, Test accuracy: 73.51
Round  92, Global train loss: 0.397, Global test loss: 1.120, Global test accuracy: 63.54
Round  93, Train loss: 0.383, Test loss: 0.898, Test accuracy: 73.33
Round  93, Global train loss: 0.383, Global test loss: 1.208, Global test accuracy: 61.68
Round  94, Train loss: 0.347, Test loss: 0.907, Test accuracy: 73.23
Round  94, Global train loss: 0.347, Global test loss: 1.519, Global test accuracy: 58.82/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.388, Test loss: 0.926, Test accuracy: 73.11
Round  95, Global train loss: 0.388, Global test loss: 1.146, Global test accuracy: 63.22
Round  96, Train loss: 0.393, Test loss: 0.919, Test accuracy: 73.08
Round  96, Global train loss: 0.393, Global test loss: 1.307, Global test accuracy: 61.13
Round  97, Train loss: 0.302, Test loss: 0.933, Test accuracy: 73.16
Round  97, Global train loss: 0.302, Global test loss: 1.203, Global test accuracy: 63.64
Round  98, Train loss: 0.402, Test loss: 0.925, Test accuracy: 73.70
Round  98, Global train loss: 0.402, Global test loss: 1.190, Global test accuracy: 64.17
Round  99, Train loss: 0.332, Test loss: 0.940, Test accuracy: 73.41
Round  99, Global train loss: 0.332, Global test loss: 1.211, Global test accuracy: 63.13
Final Round, Train loss: 0.293, Test loss: 0.974, Test accuracy: 73.52
Final Round, Global train loss: 0.293, Global test loss: 1.211, Global test accuracy: 63.13
Average accuracy final 10 rounds: 73.34 

Average global accuracy final 10 rounds: 62.441 

1357.6371994018555
[1.4483327865600586, 2.896665573120117, 4.094765663146973, 5.292865753173828, 6.474222421646118, 7.655579090118408, 8.83586072921753, 10.01614236831665, 11.216744422912598, 12.417346477508545, 13.56302285194397, 14.708699226379395, 15.859293460845947, 17.0098876953125, 18.201857566833496, 19.393827438354492, 20.56054449081421, 21.727261543273926, 22.874336004257202, 24.02141046524048, 25.209723949432373, 26.398037433624268, 27.564193964004517, 28.730350494384766, 29.896455764770508, 31.06256103515625, 32.24918031692505, 33.43579959869385, 34.60862898826599, 35.781458377838135, 36.94853472709656, 38.11561107635498, 39.277244567871094, 40.43887805938721, 41.58440709114075, 42.72993612289429, 43.901190519332886, 45.072444915771484, 46.25463938713074, 47.43683385848999, 48.588024616241455, 49.73921537399292, 50.91373085975647, 52.08824634552002, 53.24816274642944, 54.40807914733887, 55.58160948753357, 56.75513982772827, 57.928064584732056, 59.10098934173584, 60.25953412055969, 61.418078899383545, 62.59742736816406, 63.77677583694458, 64.93408036231995, 66.09138488769531, 67.22675275802612, 68.36212062835693, 69.5305392742157, 70.69895792007446, 71.87290215492249, 73.04684638977051, 74.22222447395325, 75.39760255813599, 76.60991525650024, 77.8222279548645, 79.00907230377197, 80.19591665267944, 81.35245108604431, 82.50898551940918, 83.7182924747467, 84.92759943008423, 86.10701131820679, 87.28642320632935, 88.46818709373474, 89.64995098114014, 90.78170680999756, 91.91346263885498, 93.07004499435425, 94.22662734985352, 95.40628981590271, 96.5859522819519, 97.7923846244812, 98.9988169670105, 100.21285915374756, 101.42690134048462, 102.62743616104126, 103.8279709815979, 105.0190019607544, 106.21003293991089, 107.40663170814514, 108.6032304763794, 109.80246496200562, 111.00169944763184, 112.20396494865417, 113.40623044967651, 114.60944700241089, 115.81266355514526, 117.01658964157104, 118.22051572799683, 119.42256164550781, 120.6246075630188, 121.82441425323486, 123.02422094345093, 124.2258129119873, 125.42740488052368, 126.63111996650696, 127.83483505249023, 129.0371437072754, 130.23945236206055, 131.43944191932678, 132.63943147659302, 133.83960819244385, 135.03978490829468, 136.23776030540466, 137.43573570251465, 138.62860584259033, 139.82147598266602, 140.8971827030182, 141.97288942337036, 143.01366209983826, 144.05443477630615, 145.09513139724731, 146.13582801818848, 147.17479538917542, 148.21376276016235, 149.2577486038208, 150.30173444747925, 151.34200310707092, 152.3822717666626, 153.42378759384155, 154.4653034210205, 155.50878882408142, 156.55227422714233, 157.59216165542603, 158.63204908370972, 159.67575860023499, 160.71946811676025, 161.7629725933075, 162.80647706985474, 163.84512948989868, 164.88378190994263, 165.92130541801453, 166.95882892608643, 168.01397562026978, 169.06912231445312, 170.10961747169495, 171.15011262893677, 172.2057750225067, 173.26143741607666, 174.3605625629425, 175.45968770980835, 176.49860787391663, 177.5375280380249, 178.58207726478577, 179.62662649154663, 180.66380143165588, 181.70097637176514, 182.74325966835022, 183.7855429649353, 184.82400584220886, 185.86246871948242, 186.90188217163086, 187.9412956237793, 188.9967885017395, 190.0522813796997, 191.09173202514648, 192.13118267059326, 193.16986989974976, 194.20855712890625, 195.24543929100037, 196.28232145309448, 197.31932473182678, 198.35632801055908, 199.39119505882263, 200.42606210708618, 201.46367812156677, 202.50129413604736, 203.5679054260254, 204.63451671600342, 205.67200756072998, 206.70949840545654, 207.74713563919067, 208.7847728729248, 209.8295452594757, 210.8743176460266, 211.97391414642334, 213.07351064682007, 214.11102986335754, 215.14854907989502, 216.19074869155884, 217.23294830322266, 218.26960396766663, 219.3062596321106, 220.3821840286255, 221.45810842514038, 222.49521231651306, 223.53231620788574, 224.57240271568298, 225.61248922348022, 227.7400221824646, 229.86755514144897]
[24.27, 24.27, 35.3, 35.3, 41.77, 41.77, 44.74, 44.74, 47.8, 47.8, 49.51, 49.51, 53.53, 53.53, 57.09, 57.09, 57.82, 57.82, 58.09, 58.09, 60.23, 60.23, 59.86, 59.86, 60.73, 60.73, 62.52, 62.52, 63.39, 63.39, 63.6, 63.6, 64.66, 64.66, 64.5, 64.5, 64.7, 64.7, 65.64, 65.64, 66.03, 66.03, 66.73, 66.73, 66.36, 66.36, 66.75, 66.75, 67.07, 67.07, 67.47, 67.47, 68.77, 68.77, 68.59, 68.59, 68.69, 68.69, 68.93, 68.93, 68.37, 68.37, 68.44, 68.44, 69.05, 69.05, 69.31, 69.31, 69.79, 69.79, 70.51, 70.51, 71.21, 71.21, 71.18, 71.18, 70.74, 70.74, 70.75, 70.75, 70.39, 70.39, 70.66, 70.66, 70.19, 70.19, 71.08, 71.08, 71.14, 71.14, 71.3, 71.3, 70.75, 70.75, 71.44, 71.44, 72.28, 72.28, 72.04, 72.04, 72.72, 72.72, 72.39, 72.39, 71.57, 71.57, 71.38, 71.38, 71.6, 71.6, 71.81, 71.81, 72.38, 72.38, 71.85, 71.85, 72.14, 72.14, 72.6, 72.6, 71.92, 71.92, 72.55, 72.55, 72.07, 72.07, 72.67, 72.67, 72.66, 72.66, 72.83, 72.83, 72.66, 72.66, 73.07, 73.07, 72.99, 72.99, 72.78, 72.78, 73.11, 73.11, 73.04, 73.04, 73.08, 73.08, 72.96, 72.96, 73.76, 73.76, 72.62, 72.62, 73.1, 73.1, 72.95, 72.95, 73.25, 73.25, 73.53, 73.53, 73.51, 73.51, 73.32, 73.32, 73.66, 73.66, 73.47, 73.47, 73.69, 73.69, 73.94, 73.94, 73.92, 73.92, 73.66, 73.66, 73.51, 73.51, 73.52, 73.52, 73.36, 73.36, 73.51, 73.51, 73.51, 73.51, 73.33, 73.33, 73.23, 73.23, 73.11, 73.11, 73.08, 73.08, 73.16, 73.16, 73.7, 73.7, 73.41, 73.41, 73.52, 73.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.609, Test loss: 2.015, Test accuracy: 27.47
Round   0, Global train loss: 1.609, Global test loss: 2.203, Global test accuracy: 24.91
Round   1, Train loss: 1.422, Test loss: 1.835, Test accuracy: 34.21
Round   1, Global train loss: 1.422, Global test loss: 2.089, Global test accuracy: 29.57
Round   2, Train loss: 1.271, Test loss: 1.562, Test accuracy: 41.99
Round   2, Global train loss: 1.271, Global test loss: 1.991, Global test accuracy: 35.23
Round   3, Train loss: 1.208, Test loss: 1.431, Test accuracy: 44.91
Round   3, Global train loss: 1.208, Global test loss: 1.983, Global test accuracy: 34.54
Round   4, Train loss: 1.164, Test loss: 1.281, Test accuracy: 49.21
Round   4, Global train loss: 1.164, Global test loss: 1.690, Global test accuracy: 39.03
Round   5, Train loss: 1.097, Test loss: 1.262, Test accuracy: 50.13
Round   5, Global train loss: 1.097, Global test loss: 1.747, Global test accuracy: 36.76
Round   6, Train loss: 1.059, Test loss: 1.188, Test accuracy: 53.51
Round   6, Global train loss: 1.059, Global test loss: 1.636, Global test accuracy: 41.78
Round   7, Train loss: 1.099, Test loss: 1.087, Test accuracy: 57.29
Round   7, Global train loss: 1.099, Global test loss: 1.700, Global test accuracy: 38.47
Round   8, Train loss: 1.046, Test loss: 1.021, Test accuracy: 59.53
Round   8, Global train loss: 1.046, Global test loss: 1.635, Global test accuracy: 39.92
Round   9, Train loss: 0.989, Test loss: 0.992, Test accuracy: 60.61
Round   9, Global train loss: 0.989, Global test loss: 1.679, Global test accuracy: 40.12
Round  10, Train loss: 0.935, Test loss: 1.001, Test accuracy: 60.38
Round  10, Global train loss: 0.935, Global test loss: 1.689, Global test accuracy: 43.29
Round  11, Train loss: 0.955, Test loss: 0.981, Test accuracy: 61.00
Round  11, Global train loss: 0.955, Global test loss: 1.708, Global test accuracy: 41.86
Round  12, Train loss: 0.892, Test loss: 0.972, Test accuracy: 61.89
Round  12, Global train loss: 0.892, Global test loss: 1.630, Global test accuracy: 44.79
Round  13, Train loss: 0.973, Test loss: 0.987, Test accuracy: 61.81
Round  13, Global train loss: 0.973, Global test loss: 1.489, Global test accuracy: 45.31
Round  14, Train loss: 0.962, Test loss: 0.966, Test accuracy: 62.49
Round  14, Global train loss: 0.962, Global test loss: 1.463, Global test accuracy: 46.86
Round  15, Train loss: 0.856, Test loss: 0.957, Test accuracy: 63.25
Round  15, Global train loss: 0.856, Global test loss: 1.332, Global test accuracy: 52.67
Round  16, Train loss: 0.847, Test loss: 0.967, Test accuracy: 62.86
Round  16, Global train loss: 0.847, Global test loss: 1.495, Global test accuracy: 46.91
Round  17, Train loss: 0.855, Test loss: 0.945, Test accuracy: 63.63
Round  17, Global train loss: 0.855, Global test loss: 1.400, Global test accuracy: 49.90
Round  18, Train loss: 0.805, Test loss: 0.952, Test accuracy: 63.86
Round  18, Global train loss: 0.805, Global test loss: 1.551, Global test accuracy: 47.98
Round  19, Train loss: 0.808, Test loss: 0.938, Test accuracy: 64.18
Round  19, Global train loss: 0.808, Global test loss: 1.364, Global test accuracy: 50.83
Round  20, Train loss: 0.796, Test loss: 0.934, Test accuracy: 65.15
Round  20, Global train loss: 0.796, Global test loss: 1.435, Global test accuracy: 50.18
Round  21, Train loss: 0.787, Test loss: 0.916, Test accuracy: 66.46
Round  21, Global train loss: 0.787, Global test loss: 1.357, Global test accuracy: 54.10
Round  22, Train loss: 0.765, Test loss: 0.899, Test accuracy: 66.92
Round  22, Global train loss: 0.765, Global test loss: 1.338, Global test accuracy: 52.02
Round  23, Train loss: 0.730, Test loss: 0.855, Test accuracy: 68.26
Round  23, Global train loss: 0.730, Global test loss: 1.301, Global test accuracy: 54.51
Round  24, Train loss: 0.725, Test loss: 0.845, Test accuracy: 68.78
Round  24, Global train loss: 0.725, Global test loss: 1.311, Global test accuracy: 53.39
Round  25, Train loss: 0.723, Test loss: 0.847, Test accuracy: 68.71
Round  25, Global train loss: 0.723, Global test loss: 1.491, Global test accuracy: 52.16
Round  26, Train loss: 0.770, Test loss: 0.848, Test accuracy: 68.78
Round  26, Global train loss: 0.770, Global test loss: 1.244, Global test accuracy: 55.02
Round  27, Train loss: 0.654, Test loss: 0.839, Test accuracy: 69.29
Round  27, Global train loss: 0.654, Global test loss: 1.264, Global test accuracy: 57.92
Round  28, Train loss: 0.737, Test loss: 0.848, Test accuracy: 69.37
Round  28, Global train loss: 0.737, Global test loss: 1.286, Global test accuracy: 53.99
Round  29, Train loss: 0.680, Test loss: 0.832, Test accuracy: 69.80
Round  29, Global train loss: 0.680, Global test loss: 1.215, Global test accuracy: 58.13
Round  30, Train loss: 0.594, Test loss: 0.838, Test accuracy: 69.59
Round  30, Global train loss: 0.594, Global test loss: 1.303, Global test accuracy: 55.62
Round  31, Train loss: 0.624, Test loss: 0.816, Test accuracy: 70.30
Round  31, Global train loss: 0.624, Global test loss: 1.399, Global test accuracy: 52.21
Round  32, Train loss: 0.606, Test loss: 0.847, Test accuracy: 69.74
Round  32, Global train loss: 0.606, Global test loss: 1.271, Global test accuracy: 58.15
Round  33, Train loss: 0.610, Test loss: 0.847, Test accuracy: 70.06
Round  33, Global train loss: 0.610, Global test loss: 1.367, Global test accuracy: 52.93
Round  34, Train loss: 0.566, Test loss: 0.846, Test accuracy: 70.26
Round  34, Global train loss: 0.566, Global test loss: 1.270, Global test accuracy: 56.32
Round  35, Train loss: 0.671, Test loss: 0.847, Test accuracy: 70.40
Round  35, Global train loss: 0.671, Global test loss: 1.514, Global test accuracy: 49.91
Round  36, Train loss: 0.582, Test loss: 0.837, Test accuracy: 70.64
Round  36, Global train loss: 0.582, Global test loss: 1.325, Global test accuracy: 56.55
Round  37, Train loss: 0.608, Test loss: 0.853, Test accuracy: 70.09
Round  37, Global train loss: 0.608, Global test loss: 1.226, Global test accuracy: 57.52
Round  38, Train loss: 0.532, Test loss: 0.836, Test accuracy: 70.47
Round  38, Global train loss: 0.532, Global test loss: 1.305, Global test accuracy: 56.47
Round  39, Train loss: 0.637, Test loss: 0.826, Test accuracy: 71.15
Round  39, Global train loss: 0.637, Global test loss: 1.173, Global test accuracy: 59.24
Round  40, Train loss: 0.510, Test loss: 0.814, Test accuracy: 71.44
Round  40, Global train loss: 0.510, Global test loss: 1.423, Global test accuracy: 55.91
Round  41, Train loss: 0.575, Test loss: 0.817, Test accuracy: 71.83
Round  41, Global train loss: 0.575, Global test loss: 1.423, Global test accuracy: 55.43
Round  42, Train loss: 0.607, Test loss: 0.819, Test accuracy: 71.82
Round  42, Global train loss: 0.607, Global test loss: 1.175, Global test accuracy: 59.20
Round  43, Train loss: 0.520, Test loss: 0.806, Test accuracy: 71.98
Round  43, Global train loss: 0.520, Global test loss: 1.178, Global test accuracy: 59.90
Round  44, Train loss: 0.510, Test loss: 0.820, Test accuracy: 72.31
Round  44, Global train loss: 0.510, Global test loss: 1.170, Global test accuracy: 60.21
Round  45, Train loss: 0.483, Test loss: 0.833, Test accuracy: 72.36
Round  45, Global train loss: 0.483, Global test loss: 1.141, Global test accuracy: 61.83
Round  46, Train loss: 0.555, Test loss: 0.835, Test accuracy: 72.25
Round  46, Global train loss: 0.555, Global test loss: 1.202, Global test accuracy: 60.41
Round  47, Train loss: 0.469, Test loss: 0.857, Test accuracy: 72.10
Round  47, Global train loss: 0.469, Global test loss: 1.285, Global test accuracy: 58.52
Round  48, Train loss: 0.522, Test loss: 0.865, Test accuracy: 72.16
Round  48, Global train loss: 0.522, Global test loss: 1.288, Global test accuracy: 58.20
Round  49, Train loss: 0.456, Test loss: 0.842, Test accuracy: 72.48
Round  49, Global train loss: 0.456, Global test loss: 1.296, Global test accuracy: 58.90
Round  50, Train loss: 0.504, Test loss: 0.854, Test accuracy: 72.18
Round  50, Global train loss: 0.504, Global test loss: 1.154, Global test accuracy: 62.08
Round  51, Train loss: 0.474, Test loss: 0.834, Test accuracy: 72.91
Round  51, Global train loss: 0.474, Global test loss: 1.298, Global test accuracy: 60.54
Round  52, Train loss: 0.539, Test loss: 0.856, Test accuracy: 72.62
Round  52, Global train loss: 0.539, Global test loss: 1.664, Global test accuracy: 52.01
Round  53, Train loss: 0.424, Test loss: 0.862, Test accuracy: 72.06
Round  53, Global train loss: 0.424, Global test loss: 1.298, Global test accuracy: 59.89
Round  54, Train loss: 0.463, Test loss: 0.860, Test accuracy: 71.94
Round  54, Global train loss: 0.463, Global test loss: 1.260, Global test accuracy: 60.77
Round  55, Train loss: 0.436, Test loss: 0.849, Test accuracy: 72.66
Round  55, Global train loss: 0.436, Global test loss: 1.264, Global test accuracy: 59.80
Round  56, Train loss: 0.423, Test loss: 0.844, Test accuracy: 72.78
Round  56, Global train loss: 0.423, Global test loss: 1.153, Global test accuracy: 62.96
Round  57, Train loss: 0.415, Test loss: 0.849, Test accuracy: 72.78
Round  57, Global train loss: 0.415, Global test loss: 1.287, Global test accuracy: 60.00
Round  58, Train loss: 0.480, Test loss: 0.825, Test accuracy: 73.58
Round  58, Global train loss: 0.480, Global test loss: 1.192, Global test accuracy: 60.72
Round  59, Train loss: 0.457, Test loss: 0.830, Test accuracy: 73.99
Round  59, Global train loss: 0.457, Global test loss: 1.187, Global test accuracy: 61.76
Round  60, Train loss: 0.469, Test loss: 0.827, Test accuracy: 74.12
Round  60, Global train loss: 0.469, Global test loss: 1.338, Global test accuracy: 59.16
Round  61, Train loss: 0.417, Test loss: 0.830, Test accuracy: 73.99
Round  61, Global train loss: 0.417, Global test loss: 1.441, Global test accuracy: 58.07
Round  62, Train loss: 0.416, Test loss: 0.833, Test accuracy: 74.00
Round  62, Global train loss: 0.416, Global test loss: 1.227, Global test accuracy: 61.27
Round  63, Train loss: 0.415, Test loss: 0.837, Test accuracy: 73.62
Round  63, Global train loss: 0.415, Global test loss: 1.376, Global test accuracy: 58.08
Round  64, Train loss: 0.435, Test loss: 0.855, Test accuracy: 73.59
Round  64, Global train loss: 0.435, Global test loss: 1.100, Global test accuracy: 64.00
Round  65, Train loss: 0.484, Test loss: 0.855, Test accuracy: 73.34
Round  65, Global train loss: 0.484, Global test loss: 1.326, Global test accuracy: 58.01
Round  66, Train loss: 0.406, Test loss: 0.836, Test accuracy: 74.22
Round  66, Global train loss: 0.406, Global test loss: 1.328, Global test accuracy: 57.79
Round  67, Train loss: 0.422, Test loss: 0.824, Test accuracy: 74.44
Round  67, Global train loss: 0.422, Global test loss: 1.398, Global test accuracy: 56.31
Round  68, Train loss: 0.390, Test loss: 0.823, Test accuracy: 74.67
Round  68, Global train loss: 0.390, Global test loss: 1.370, Global test accuracy: 60.54
Round  69, Train loss: 0.400, Test loss: 0.824, Test accuracy: 74.54
Round  69, Global train loss: 0.400, Global test loss: 1.160, Global test accuracy: 63.53
Round  70, Train loss: 0.365, Test loss: 0.843, Test accuracy: 74.42
Round  70, Global train loss: 0.365, Global test loss: 1.225, Global test accuracy: 62.40
Round  71, Train loss: 0.333, Test loss: 0.854, Test accuracy: 74.61
Round  71, Global train loss: 0.333, Global test loss: 1.171, Global test accuracy: 63.11
Round  72, Train loss: 0.350, Test loss: 0.846, Test accuracy: 74.60
Round  72, Global train loss: 0.350, Global test loss: 1.154, Global test accuracy: 63.14
Round  73, Train loss: 0.423, Test loss: 0.876, Test accuracy: 74.17
Round  73, Global train loss: 0.423, Global test loss: 1.411, Global test accuracy: 58.21
Round  74, Train loss: 0.337, Test loss: 0.916, Test accuracy: 73.38
Round  74, Global train loss: 0.337, Global test loss: 1.388, Global test accuracy: 60.29
Round  75, Train loss: 0.376, Test loss: 0.901, Test accuracy: 73.83
Round  75, Global train loss: 0.376, Global test loss: 1.208, Global test accuracy: 61.83
Round  76, Train loss: 0.320, Test loss: 0.899, Test accuracy: 74.01
Round  76, Global train loss: 0.320, Global test loss: 1.670, Global test accuracy: 57.17
Round  77, Train loss: 0.379, Test loss: 0.893, Test accuracy: 74.21
Round  77, Global train loss: 0.379, Global test loss: 1.154, Global test accuracy: 64.31
Round  78, Train loss: 0.338, Test loss: 0.875, Test accuracy: 74.04
Round  78, Global train loss: 0.338, Global test loss: 1.431, Global test accuracy: 59.64
Round  79, Train loss: 0.321, Test loss: 0.884, Test accuracy: 74.04
Round  79, Global train loss: 0.321, Global test loss: 1.406, Global test accuracy: 60.89
Round  80, Train loss: 0.326, Test loss: 0.879, Test accuracy: 74.53
Round  80, Global train loss: 0.326, Global test loss: 1.223, Global test accuracy: 63.40
Round  81, Train loss: 0.389, Test loss: 0.864, Test accuracy: 74.68
Round  81, Global train loss: 0.389, Global test loss: 1.277, Global test accuracy: 60.63
Round  82, Train loss: 0.313, Test loss: 0.892, Test accuracy: 74.13
Round  82, Global train loss: 0.313, Global test loss: 1.327, Global test accuracy: 62.68
Round  83, Train loss: 0.297, Test loss: 0.898, Test accuracy: 74.47
Round  83, Global train loss: 0.297, Global test loss: 1.286, Global test accuracy: 62.06
Round  84, Train loss: 0.344, Test loss: 0.915, Test accuracy: 74.17
Round  84, Global train loss: 0.344, Global test loss: 1.352, Global test accuracy: 60.86
Round  85, Train loss: 0.367, Test loss: 0.915, Test accuracy: 74.29
Round  85, Global train loss: 0.367, Global test loss: 1.312, Global test accuracy: 60.14
Round  86, Train loss: 0.334, Test loss: 0.878, Test accuracy: 75.08
Round  86, Global train loss: 0.334, Global test loss: 1.337, Global test accuracy: 61.64
Round  87, Train loss: 0.342, Test loss: 0.894, Test accuracy: 74.72
Round  87, Global train loss: 0.342, Global test loss: 1.440, Global test accuracy: 58.20
Round  88, Train loss: 0.342, Test loss: 0.890, Test accuracy: 74.69
Round  88, Global train loss: 0.342, Global test loss: 1.147, Global test accuracy: 65.22
Round  89, Train loss: 0.323, Test loss: 0.913, Test accuracy: 74.70
Round  89, Global train loss: 0.323, Global test loss: 1.417, Global test accuracy: 60.29
Round  90, Train loss: 0.354, Test loss: 0.875, Test accuracy: 75.28
Round  90, Global train loss: 0.354, Global test loss: 1.335, Global test accuracy: 60.72
Round  91, Train loss: 0.349, Test loss: 0.874, Test accuracy: 75.61
Round  91, Global train loss: 0.349, Global test loss: 1.215, Global test accuracy: 63.15
Round  92, Train loss: 0.332, Test loss: 0.856, Test accuracy: 75.56
Round  92, Global train loss: 0.332, Global test loss: 1.147, Global test accuracy: 64.49
Round  93, Train loss: 0.298, Test loss: 0.877, Test accuracy: 75.28
Round  93, Global train loss: 0.298, Global test loss: 1.351, Global test accuracy: 61.28
Round  94, Train loss: 0.292, Test loss: 0.873, Test accuracy: 75.21
Round  94, Global train loss: 0.292, Global test loss: 1.637, Global test accuracy: 58.72
Round  95, Train loss: 0.315, Test loss: 0.875, Test accuracy: 75.24
Round  95, Global train loss: 0.315, Global test loss: 1.181, Global test accuracy: 62.75
Round  96, Train loss: 0.321, Test loss: 0.882, Test accuracy: 75.24
Round  96, Global train loss: 0.321, Global test loss: 1.259, Global test accuracy: 62.40
Round  97, Train loss: 0.250, Test loss: 0.865, Test accuracy: 75.71
Round  97, Global train loss: 0.250, Global test loss: 1.217, Global test accuracy: 65.00
Round  98, Train loss: 0.319, Test loss: 0.907, Test accuracy: 75.02
Round  98, Global train loss: 0.319, Global test loss: 1.323, Global test accuracy: 62.08
Round  99, Train loss: 0.282, Test loss: 0.903, Test accuracy: 75.08
Round  99, Global train loss: 0.282, Global test loss: 1.160, Global test accuracy: 64.57
Final Round, Train loss: 0.230, Test loss: 1.011, Test accuracy: 74.59
Final Round, Global train loss: 0.230, Global test loss: 1.160, Global test accuracy: 64.57
Average accuracy final 10 rounds: 75.323
Average global accuracy final 10 rounds: 62.516
1853.203881263733
[2.705300807952881, 5.15347957611084, 7.609212875366211, 10.072749137878418, 12.531262636184692, 14.99040699005127, 17.444777250289917, 19.897647619247437, 22.35675859451294, 24.817769527435303, 27.28016972541809, 29.748719453811646, 32.20688509941101, 34.66866493225098, 37.102675676345825, 39.541956424713135, 41.980633020401, 44.41719722747803, 46.854398012161255, 49.28593897819519, 51.71442413330078, 54.15274429321289, 56.60203957557678, 59.053590536117554, 61.501646280288696, 63.92608094215393, 66.35401177406311, 68.80538272857666, 71.24787545204163, 73.69085955619812, 76.13050699234009, 78.58366346359253, 81.02734684944153, 83.47450828552246, 85.92505979537964, 88.3782434463501, 90.8309428691864, 93.28004479408264, 95.40928363800049, 97.53836131095886, 99.67257261276245, 101.80487418174744, 103.93637156486511, 106.07053446769714, 108.20267128944397, 110.33759355545044, 112.4756817817688, 114.61274266242981, 116.74742007255554, 118.88133358955383, 121.0142650604248, 123.14696764945984, 125.28007340431213, 127.41192364692688, 129.5454638004303, 131.67812323570251, 133.816392660141, 135.95173978805542, 138.0940065383911, 140.2342758178711, 142.3666045665741, 144.50395226478577, 146.6398961544037, 148.77259707450867, 150.90684509277344, 153.04068541526794, 155.17328310012817, 157.30820083618164, 159.43981385231018, 161.57491517066956, 163.70973992347717, 165.8404803276062, 167.9746870994568, 170.10835123062134, 172.24065589904785, 174.37212491035461, 176.504221200943, 178.63810348510742, 180.7713086605072, 182.90877676010132, 185.04302334785461, 187.17615032196045, 189.31125235557556, 191.44792437553406, 193.58234119415283, 195.7170262336731, 197.85164308547974, 199.98912239074707, 202.1241159439087, 204.26542687416077, 206.40295505523682, 208.53931427001953, 210.6773431301117, 212.8142831325531, 214.9544916152954, 217.09070897102356, 219.22958278656006, 221.36847138404846, 223.50529098510742, 225.64276003837585, 229.5076060295105]
[27.47, 34.21, 41.99, 44.91, 49.21, 50.13, 53.51, 57.29, 59.53, 60.61, 60.38, 61.0, 61.89, 61.81, 62.49, 63.25, 62.86, 63.63, 63.86, 64.18, 65.15, 66.46, 66.92, 68.26, 68.78, 68.71, 68.78, 69.29, 69.37, 69.8, 69.59, 70.3, 69.74, 70.06, 70.26, 70.4, 70.64, 70.09, 70.47, 71.15, 71.44, 71.83, 71.82, 71.98, 72.31, 72.36, 72.25, 72.1, 72.16, 72.48, 72.18, 72.91, 72.62, 72.06, 71.94, 72.66, 72.78, 72.78, 73.58, 73.99, 74.12, 73.99, 74.0, 73.62, 73.59, 73.34, 74.22, 74.44, 74.67, 74.54, 74.42, 74.61, 74.6, 74.17, 73.38, 73.83, 74.01, 74.21, 74.04, 74.04, 74.53, 74.68, 74.13, 74.47, 74.17, 74.29, 75.08, 74.72, 74.69, 74.7, 75.28, 75.61, 75.56, 75.28, 75.21, 75.24, 75.24, 75.71, 75.02, 75.08, 74.59]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  17.9000
Round 1 global test acc  20.7000
Round 2 global test acc  23.9800
Round 3 global test acc  24.5500
Round 4 global test acc  23.8000
Round 5 global test acc  22.7600
Round 6 global test acc  27.3600
Round 7 global test acc  30.9800
Round 8 global test acc  25.9900
Round 9 global test acc  33.9400
Round 10 global test acc  26.9700
Round 11 global test acc  28.2800
Round 12 global test acc  33.1700
Round 13 global test acc  38.3300
Round 14 global test acc  33.5900
Round 15 global test acc  34.2700
Round 16 global test acc  27.9500
Round 17 global test acc  25.8900
Round 18 global test acc  40.7100
Round 19 global test acc  30.3400
Round 20 global test acc  30.4800
Round 21 global test acc  35.7900
Round 22 global test acc  32.7500
Round 23 global test acc  38.1500
Round 24 global test acc  32.3100
Round 25 global test acc  39.6900
Round 26 global test acc  38.0500
Round 27 global test acc  35.5600
Round 28 global test acc  36.5300
Round 29 global test acc  40.8300
Round 30 global test acc  43.2600
Round 31 global test acc  36.2900
Round 32 global test acc  35.5300
Round 33 global test acc  28.7800
Round 34 global test acc  34.9100
Round 35 global test acc  36.0100
Round 36 global test acc  43.3100
Round 37 global test acc  39.2500
Round 38 global test acc  39.0900
Round 39 global test acc  35.8100
Round 40 global test acc  48.3500
Round 41 global test acc  37.8500
Round 42 global test acc  39.0300
Round 43 global test acc  41.1700
Round 44 global test acc  33.5500
Round 45 global test acc  44.8800
Round 46 global test acc  42.9800
Round 47 global test acc  36.3400
Round 48 global test acc  40.5600
Round 49 global test acc  44.4600
Round 50 global test acc  33.8500
Round 51 global test acc  41.0000
Round 52 global test acc  40.2700
Round 53 global test acc  42.5400
Round 54 global test acc  41.5500
Round 55 global test acc  42.3600
Round 56 global test acc  37.5900
Round 57 global test acc  46.0400
Round 58 global test acc  43.9200
Round 59 global test acc  44.7000
Round 60 global test acc  43.7100
Round 61 global test acc  40.2300
Round 62 global test acc  38.5700
Round 63 global test acc  36.7600
Round 64 global test acc  43.5000
Round 65 global test acc  34.1000
Round 66 global test acc  43.4100
Round 67 global test acc  39.9500
Round 68 global test acc  43.2200
Round 69 global test acc  45.7600
Round 70 global test acc  39.4500
Round 71 global test acc  45.5700
Round 72 global test acc  36.3200
Round 73 global test acc  47.1500
Round 74 global test acc  37.0800
Round 75 global test acc  41.3700
Round 76 global test acc  44.8400
Round 77 global test acc  41.5800
Round 78 global test acc  42.7700
Round 79 global test acc  45.5800
Round 80 global test acc  40.9300
Round 81 global test acc  37.7600
Round 82 global test acc  35.7000
Round 83 global test acc  34.2900
Round 84 global test acc  32.3500
Round 85 global test acc  29.9700
Round 86 global test acc  28.9400
Round 87 global test acc  27.8100
Round 88 global test acc  26.8700
Round 89 global test acc  26.0100
Round 90 global test acc  26.1600
Round 91 global test acc  25.8700
Round 92 global test acc  25.5100
Round 93 global test acc  25.5800
Round 94 global test acc  25.6900
Round 95 global test acc  25.5800
Round 96 global test acc  25.2600
Round 97 global test acc  25.1500
Round 98 global test acc  25.5500
Round 99 global test acc  25.2600
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.944, Test loss: 2.167, Test accuracy: 18.90
Round   1, Train loss: 1.533, Test loss: 1.992, Test accuracy: 31.11
Round   2, Train loss: 1.364, Test loss: 1.666, Test accuracy: 41.36
Round   3, Train loss: 1.322, Test loss: 1.516, Test accuracy: 44.31
Round   4, Train loss: 1.207, Test loss: 1.366, Test accuracy: 47.80
Round   5, Train loss: 1.169, Test loss: 1.327, Test accuracy: 48.21
Round   6, Train loss: 1.114, Test loss: 1.219, Test accuracy: 53.25
Round   7, Train loss: 1.152, Test loss: 1.073, Test accuracy: 57.72
Round   8, Train loss: 1.099, Test loss: 1.023, Test accuracy: 59.10
Round   9, Train loss: 1.081, Test loss: 0.991, Test accuracy: 60.22
Round  10, Train loss: 1.024, Test loss: 0.972, Test accuracy: 61.60
Round  11, Train loss: 0.987, Test loss: 0.949, Test accuracy: 62.58
Round  12, Train loss: 0.975, Test loss: 0.917, Test accuracy: 63.39
Round  13, Train loss: 1.058, Test loss: 0.898, Test accuracy: 64.06
Round  14, Train loss: 1.025, Test loss: 0.891, Test accuracy: 65.66
Round  15, Train loss: 0.915, Test loss: 0.883, Test accuracy: 66.74
Round  16, Train loss: 0.946, Test loss: 0.864, Test accuracy: 66.68
Round  17, Train loss: 0.972, Test loss: 0.850, Test accuracy: 67.41
Round  18, Train loss: 0.922, Test loss: 0.841, Test accuracy: 68.11
Round  19, Train loss: 0.887, Test loss: 0.832, Test accuracy: 68.12
Round  20, Train loss: 0.896, Test loss: 0.817, Test accuracy: 68.17
Round  21, Train loss: 0.867, Test loss: 0.807, Test accuracy: 68.52
Round  22, Train loss: 0.844, Test loss: 0.813, Test accuracy: 67.64
Round  23, Train loss: 0.830, Test loss: 0.801, Test accuracy: 68.57
Round  24, Train loss: 0.795, Test loss: 0.792, Test accuracy: 69.08
Round  25, Train loss: 0.831, Test loss: 0.771, Test accuracy: 70.26
Round  26, Train loss: 0.847, Test loss: 0.777, Test accuracy: 70.11
Round  27, Train loss: 0.723, Test loss: 0.772, Test accuracy: 70.31
Round  28, Train loss: 0.839, Test loss: 0.759, Test accuracy: 70.55
Round  29, Train loss: 0.785, Test loss: 0.746, Test accuracy: 71.63
Round  30, Train loss: 0.743, Test loss: 0.745, Test accuracy: 71.93
Round  31, Train loss: 0.756, Test loss: 0.739, Test accuracy: 71.79
Round  32, Train loss: 0.742, Test loss: 0.734, Test accuracy: 71.66
Round  33, Train loss: 0.738, Test loss: 0.725, Test accuracy: 72.26
Round  34, Train loss: 0.685, Test loss: 0.715, Test accuracy: 73.10
Round  35, Train loss: 0.820, Test loss: 0.708, Test accuracy: 73.09
Round  36, Train loss: 0.693, Test loss: 0.703, Test accuracy: 73.21
Round  37, Train loss: 0.727, Test loss: 0.695, Test accuracy: 73.40
Round  38, Train loss: 0.644, Test loss: 0.700, Test accuracy: 73.23
Round  39, Train loss: 0.755, Test loss: 0.706, Test accuracy: 72.85
Round  40, Train loss: 0.630, Test loss: 0.701, Test accuracy: 73.24
Round  41, Train loss: 0.757, Test loss: 0.696, Test accuracy: 73.45
Round  42, Train loss: 0.682, Test loss: 0.691, Test accuracy: 74.12
Round  43, Train loss: 0.607, Test loss: 0.686, Test accuracy: 74.11
Round  44, Train loss: 0.630, Test loss: 0.674, Test accuracy: 74.51
Round  45, Train loss: 0.588, Test loss: 0.673, Test accuracy: 74.58
Round  46, Train loss: 0.678, Test loss: 0.674, Test accuracy: 74.83
Round  47, Train loss: 0.626, Test loss: 0.664, Test accuracy: 75.03
Round  48, Train loss: 0.634, Test loss: 0.667, Test accuracy: 74.75
Round  49, Train loss: 0.614, Test loss: 0.667, Test accuracy: 74.84
Round  50, Train loss: 0.697, Test loss: 0.663, Test accuracy: 75.03
Round  51, Train loss: 0.632, Test loss: 0.662, Test accuracy: 74.96
Round  52, Train loss: 0.682, Test loss: 0.663, Test accuracy: 75.37
Round  53, Train loss: 0.556, Test loss: 0.660, Test accuracy: 75.17
Round  54, Train loss: 0.554, Test loss: 0.658, Test accuracy: 75.30
Round  55, Train loss: 0.583, Test loss: 0.653, Test accuracy: 75.36
Round  56, Train loss: 0.538, Test loss: 0.651, Test accuracy: 75.82
Round  57, Train loss: 0.522, Test loss: 0.651, Test accuracy: 75.89
Round  58, Train loss: 0.637, Test loss: 0.649, Test accuracy: 75.95
Round  59, Train loss: 0.578, Test loss: 0.639, Test accuracy: 76.58
Round  60, Train loss: 0.579, Test loss: 0.654, Test accuracy: 75.72
Round  61, Train loss: 0.581, Test loss: 0.648, Test accuracy: 76.06
Round  62, Train loss: 0.574, Test loss: 0.639, Test accuracy: 76.40
Round  63, Train loss: 0.559, Test loss: 0.645, Test accuracy: 76.43
Round  64, Train loss: 0.593, Test loss: 0.637, Test accuracy: 76.59
Round  65, Train loss: 0.588, Test loss: 0.632, Test accuracy: 76.66
Round  66, Train loss: 0.541, Test loss: 0.643, Test accuracy: 76.31
Round  67, Train loss: 0.515, Test loss: 0.630, Test accuracy: 76.81
Round  68, Train loss: 0.575, Test loss: 0.630, Test accuracy: 76.77
Round  69, Train loss: 0.481, Test loss: 0.625, Test accuracy: 77.30
Round  70, Train loss: 0.486, Test loss: 0.627, Test accuracy: 77.13
Round  71, Train loss: 0.484, Test loss: 0.629, Test accuracy: 77.09
Round  72, Train loss: 0.480, Test loss: 0.637, Test accuracy: 76.80
Round  73, Train loss: 0.551, Test loss: 0.628, Test accuracy: 77.28
Round  74, Train loss: 0.448, Test loss: 0.628, Test accuracy: 77.11
Round  75, Train loss: 0.458, Test loss: 0.631, Test accuracy: 76.87
Round  76, Train loss: 0.466, Test loss: 0.643, Test accuracy: 76.46
Round  77, Train loss: 0.505, Test loss: 0.623, Test accuracy: 76.88
Round  78, Train loss: 0.513, Test loss: 0.627, Test accuracy: 77.27
Round  79, Train loss: 0.473, Test loss: 0.642, Test accuracy: 76.96
Round  80, Train loss: 0.435, Test loss: 0.631, Test accuracy: 77.41
Round  81, Train loss: 0.540, Test loss: 0.639, Test accuracy: 77.03
Round  82, Train loss: 0.393, Test loss: 0.637, Test accuracy: 76.85
Round  83, Train loss: 0.446, Test loss: 0.636, Test accuracy: 77.31
Round  84, Train loss: 0.453, Test loss: 0.644, Test accuracy: 76.63
Round  85, Train loss: 0.454, Test loss: 0.646, Test accuracy: 76.39
Round  86, Train loss: 0.433, Test loss: 0.632, Test accuracy: 76.96
Round  87, Train loss: 0.438, Test loss: 0.633, Test accuracy: 77.09
Round  88, Train loss: 0.488, Test loss: 0.638, Test accuracy: 76.79
Round  89, Train loss: 0.488, Test loss: 0.632, Test accuracy: 77.01
Round  90, Train loss: 0.452, Test loss: 0.630, Test accuracy: 77.32
Round  91, Train loss: 0.425, Test loss: 0.629, Test accuracy: 77.32
Round  92, Train loss: 0.415, Test loss: 0.631, Test accuracy: 77.73
Round  93, Train loss: 0.421, Test loss: 0.633, Test accuracy: 77.21
Round  94, Train loss: 0.398, Test loss: 0.632, Test accuracy: 77.50
Round  95, Train loss: 0.400, Test loss: 0.632, Test accuracy: 77.41
Round  96, Train loss: 0.446, Test loss: 0.626, Test accuracy: 77.83
Round  97, Train loss: 0.363, Test loss: 0.635, Test accuracy: 77.78
Round  98, Train loss: 0.473, Test loss: 0.640, Test accuracy: 77.71
Round  99, Train loss: 0.352, Test loss: 0.631, Test accuracy: 77.69
Final Round, Train loss: 0.337, Test loss: 0.632, Test accuracy: 77.87
Average accuracy final 10 rounds: 77.55
920.6068739891052
[1.6078174114227295, 2.8620657920837402, 4.058201313018799, 5.250397682189941, 6.444250106811523, 7.640313148498535, 8.869287729263306, 9.989734888076782, 11.10819149017334, 12.21339225769043, 13.317898035049438, 14.428654193878174, 15.53326940536499, 16.64057493209839, 17.747809410095215, 18.859752893447876, 19.979417324066162, 21.099202632904053, 22.217278003692627, 23.33608078956604, 24.455252408981323, 25.573081493377686, 26.689857244491577, 27.807095766067505, 28.92310070991516, 30.04116201400757, 31.155372142791748, 32.26487708091736, 33.37243318557739, 34.480666160583496, 35.59634447097778, 36.71346378326416, 37.83244323730469, 38.94965124130249, 40.06630253791809, 41.182953119277954, 42.30249524116516, 43.42071509361267, 44.526451110839844, 45.6427276134491, 46.76026940345764, 47.872349977493286, 48.97928166389465, 50.08390498161316, 51.18946290016174, 52.29577851295471, 53.40451121330261, 54.51898813247681, 55.64578866958618, 56.756288051605225, 57.865200996398926, 58.972548961639404, 60.081568002700806, 61.190833568573, 62.299546003341675, 63.41240048408508, 64.5211672782898, 65.62706518173218, 66.73512196540833, 67.85182404518127, 68.96469116210938, 70.07840156555176, 71.19151878356934, 72.30593991279602, 73.41780161857605, 74.53069114685059, 75.64292550086975, 76.75465941429138, 77.866206407547, 78.97180771827698, 80.07756209373474, 81.18229937553406, 82.29039907455444, 83.3987283706665, 84.5049798488617, 85.61055541038513, 86.71658396720886, 87.82555103302002, 88.94008946418762, 90.05668640136719, 91.17175531387329, 92.28492093086243, 93.39530205726624, 94.50575232505798, 95.61174178123474, 96.7174801826477, 97.82393097877502, 98.92787504196167, 100.03207993507385, 101.1454963684082, 102.25772881507874, 103.37177872657776, 104.48120832443237, 105.58805084228516, 106.69694709777832, 107.80338859558105, 108.91001534461975, 110.01522016525269, 111.12957859039307, 112.2436957359314, 114.07371687889099]
[18.9, 31.11, 41.36, 44.31, 47.8, 48.21, 53.25, 57.72, 59.1, 60.22, 61.6, 62.58, 63.39, 64.06, 65.66, 66.74, 66.68, 67.41, 68.11, 68.12, 68.17, 68.52, 67.64, 68.57, 69.08, 70.26, 70.11, 70.31, 70.55, 71.63, 71.93, 71.79, 71.66, 72.26, 73.1, 73.09, 73.21, 73.4, 73.23, 72.85, 73.24, 73.45, 74.12, 74.11, 74.51, 74.58, 74.83, 75.03, 74.75, 74.84, 75.03, 74.96, 75.37, 75.17, 75.3, 75.36, 75.82, 75.89, 75.95, 76.58, 75.72, 76.06, 76.4, 76.43, 76.59, 76.66, 76.31, 76.81, 76.77, 77.3, 77.13, 77.09, 76.8, 77.28, 77.11, 76.87, 76.46, 76.88, 77.27, 76.96, 77.41, 77.03, 76.85, 77.31, 76.63, 76.39, 76.96, 77.09, 76.79, 77.01, 77.32, 77.32, 77.73, 77.21, 77.5, 77.41, 77.83, 77.78, 77.71, 77.69, 77.87]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.612, Test loss: 2.014, Test accuracy: 25.07
Round   0, Global train loss: 1.612, Global test loss: 2.211, Global test accuracy: 20.81
Round   1, Train loss: 1.417, Test loss: 1.784, Test accuracy: 36.85
Round   1, Global train loss: 1.417, Global test loss: 2.063, Global test accuracy: 30.77
Round   2, Train loss: 1.261, Test loss: 1.549, Test accuracy: 44.16
Round   2, Global train loss: 1.261, Global test loss: 2.019, Global test accuracy: 35.05
Round   3, Train loss: 1.223, Test loss: 1.399, Test accuracy: 46.51
Round   3, Global train loss: 1.223, Global test loss: 1.980, Global test accuracy: 34.31
Round   4, Train loss: 1.178, Test loss: 1.266, Test accuracy: 49.91
Round   4, Global train loss: 1.178, Global test loss: 1.694, Global test accuracy: 37.07
Round   5, Train loss: 1.113, Test loss: 1.212, Test accuracy: 52.54
Round   5, Global train loss: 1.113, Global test loss: 1.681, Global test accuracy: 39.61
Round   6, Train loss: 1.040, Test loss: 1.137, Test accuracy: 55.71
Round   6, Global train loss: 1.040, Global test loss: 1.621, Global test accuracy: 42.66
Round   7, Train loss: 1.112, Test loss: 1.045, Test accuracy: 59.24
Round   7, Global train loss: 1.112, Global test loss: 1.706, Global test accuracy: 39.49
Round   8, Train loss: 1.030, Test loss: 0.985, Test accuracy: 61.47
Round   8, Global train loss: 1.030, Global test loss: 1.557, Global test accuracy: 43.03
Round   9, Train loss: 0.992, Test loss: 0.962, Test accuracy: 62.61
Round   9, Global train loss: 0.992, Global test loss: 1.561, Global test accuracy: 43.83
Round  10, Train loss: 0.921, Test loss: 0.943, Test accuracy: 63.33
Round  10, Global train loss: 0.921, Global test loss: 1.512, Global test accuracy: 47.04
Round  11, Train loss: 0.936, Test loss: 0.933, Test accuracy: 63.70
Round  11, Global train loss: 0.936, Global test loss: 1.566, Global test accuracy: 44.61
Round  12, Train loss: 0.883, Test loss: 0.918, Test accuracy: 64.58
Round  12, Global train loss: 0.883, Global test loss: 1.547, Global test accuracy: 47.14
Round  13, Train loss: 0.987, Test loss: 0.898, Test accuracy: 65.11
Round  13, Global train loss: 0.987, Global test loss: 1.430, Global test accuracy: 46.75
Round  14, Train loss: 0.942, Test loss: 0.903, Test accuracy: 65.67
Round  14, Global train loss: 0.942, Global test loss: 1.398, Global test accuracy: 49.36
Round  15, Train loss: 0.852, Test loss: 0.885, Test accuracy: 66.33
Round  15, Global train loss: 0.852, Global test loss: 1.259, Global test accuracy: 55.83
Round  16, Train loss: 0.861, Test loss: 0.872, Test accuracy: 66.96
Round  16, Global train loss: 0.861, Global test loss: 1.331, Global test accuracy: 51.86
Round  17, Train loss: 0.870, Test loss: 0.879, Test accuracy: 66.44
Round  17, Global train loss: 0.870, Global test loss: 1.366, Global test accuracy: 50.17
Round  18, Train loss: 0.814, Test loss: 0.885, Test accuracy: 66.59
Round  18, Global train loss: 0.814, Global test loss: 1.422, Global test accuracy: 50.90
Round  19, Train loss: 0.805, Test loss: 0.877, Test accuracy: 67.17
Round  19, Global train loss: 0.805, Global test loss: 1.264, Global test accuracy: 54.07
Round  20, Train loss: 0.799, Test loss: 0.881, Test accuracy: 66.98
Round  20, Global train loss: 0.799, Global test loss: 1.353, Global test accuracy: 53.25
Round  21, Train loss: 0.778, Test loss: 0.862, Test accuracy: 67.76
Round  21, Global train loss: 0.778, Global test loss: 1.319, Global test accuracy: 54.76
Round  22, Train loss: 0.752, Test loss: 0.865, Test accuracy: 67.82
Round  22, Global train loss: 0.752, Global test loss: 1.276, Global test accuracy: 53.93
Round  23, Train loss: 0.713, Test loss: 0.829, Test accuracy: 69.18
Round  23, Global train loss: 0.713, Global test loss: 1.318, Global test accuracy: 54.65
Round  24, Train loss: 0.747, Test loss: 0.815, Test accuracy: 69.89
Round  24, Global train loss: 0.747, Global test loss: 1.269, Global test accuracy: 54.81
Round  25, Train loss: 0.707, Test loss: 0.818, Test accuracy: 70.02
Round  25, Global train loss: 0.707, Global test loss: 1.424, Global test accuracy: 53.21
Round  26, Train loss: 0.774, Test loss: 0.808, Test accuracy: 70.25
Round  26, Global train loss: 0.774, Global test loss: 1.195, Global test accuracy: 57.53
Round  27, Train loss: 0.657, Test loss: 0.817, Test accuracy: 70.06
Round  27, Global train loss: 0.657, Global test loss: 1.200, Global test accuracy: 59.60
Round  28, Train loss: 0.754, Test loss: 0.812, Test accuracy: 70.53
Round  28, Global train loss: 0.754, Global test loss: 1.316, Global test accuracy: 52.49
Round  29, Train loss: 0.679, Test loss: 0.821, Test accuracy: 70.35
Round  29, Global train loss: 0.679, Global test loss: 1.203, Global test accuracy: 59.05
Round  30, Train loss: 0.608, Test loss: 0.813, Test accuracy: 70.72
Round  30, Global train loss: 0.608, Global test loss: 1.277, Global test accuracy: 57.34
Round  31, Train loss: 0.642, Test loss: 0.812, Test accuracy: 71.10
Round  31, Global train loss: 0.642, Global test loss: 1.401, Global test accuracy: 53.00
Round  32, Train loss: 0.612, Test loss: 0.817, Test accuracy: 71.03
Round  32, Global train loss: 0.612, Global test loss: 1.184, Global test accuracy: 59.60
Round  33, Train loss: 0.615, Test loss: 0.801, Test accuracy: 71.55
Round  33, Global train loss: 0.615, Global test loss: 1.285, Global test accuracy: 54.68
Round  34, Train loss: 0.553, Test loss: 0.825, Test accuracy: 71.31
Round  34, Global train loss: 0.553, Global test loss: 1.229, Global test accuracy: 58.07
Round  35, Train loss: 0.678, Test loss: 0.830, Test accuracy: 71.40
Round  35, Global train loss: 0.678, Global test loss: 1.492, Global test accuracy: 49.39
Round  36, Train loss: 0.559, Test loss: 0.834, Test accuracy: 71.10
Round  36, Global train loss: 0.559, Global test loss: 1.240, Global test accuracy: 58.28
Round  37, Train loss: 0.621, Test loss: 0.832, Test accuracy: 71.27
Round  37, Global train loss: 0.621, Global test loss: 1.182, Global test accuracy: 59.29
Round  38, Train loss: 0.544, Test loss: 0.817, Test accuracy: 71.97
Round  38, Global train loss: 0.544, Global test loss: 1.304, Global test accuracy: 56.71
Round  39, Train loss: 0.648, Test loss: 0.816, Test accuracy: 71.77
Round  39, Global train loss: 0.648, Global test loss: 1.177, Global test accuracy: 58.94
Round  40, Train loss: 0.514, Test loss: 0.819, Test accuracy: 71.93
Round  40, Global train loss: 0.514, Global test loss: 1.369, Global test accuracy: 56.23
Round  41, Train loss: 0.609, Test loss: 0.810, Test accuracy: 72.08
Round  41, Global train loss: 0.609, Global test loss: 1.451, Global test accuracy: 55.71
Round  42, Train loss: 0.590, Test loss: 0.803, Test accuracy: 72.35
Round  42, Global train loss: 0.590, Global test loss: 1.124, Global test accuracy: 60.37
Round  43, Train loss: 0.530, Test loss: 0.801, Test accuracy: 72.29
Round  43, Global train loss: 0.530, Global test loss: 1.170, Global test accuracy: 60.06
Round  44, Train loss: 0.522, Test loss: 0.801, Test accuracy: 72.68
Round  44, Global train loss: 0.522, Global test loss: 1.146, Global test accuracy: 60.44
Round  45, Train loss: 0.477, Test loss: 0.819, Test accuracy: 72.34
Round  45, Global train loss: 0.477, Global test loss: 1.121, Global test accuracy: 62.52
Round  46, Train loss: 0.565, Test loss: 0.818, Test accuracy: 72.57
Round  46, Global train loss: 0.565, Global test loss: 1.161, Global test accuracy: 61.51
Round  47, Train loss: 0.499, Test loss: 0.823, Test accuracy: 72.69
Round  47, Global train loss: 0.499, Global test loss: 1.305, Global test accuracy: 58.78
Round  48, Train loss: 0.547, Test loss: 0.831, Test accuracy: 72.22
Round  48, Global train loss: 0.547, Global test loss: 1.239, Global test accuracy: 59.22
Round  49, Train loss: 0.451, Test loss: 0.835, Test accuracy: 72.25
Round  49, Global train loss: 0.451, Global test loss: 1.345, Global test accuracy: 58.39
Round  50, Train loss: 0.526, Test loss: 0.838, Test accuracy: 72.35
Round  50, Global train loss: 0.526, Global test loss: 1.111, Global test accuracy: 63.50
Round  51, Train loss: 0.490, Test loss: 0.826, Test accuracy: 72.61
Round  51, Global train loss: 0.490, Global test loss: 1.164, Global test accuracy: 61.73
Round  52, Train loss: 0.536, Test loss: 0.838, Test accuracy: 72.17
Round  52, Global train loss: 0.536, Global test loss: 1.577, Global test accuracy: 53.45
Round  53, Train loss: 0.419, Test loss: 0.840, Test accuracy: 72.63
Round  53, Global train loss: 0.419, Global test loss: 1.288, Global test accuracy: 60.17
Round  54, Train loss: 0.451, Test loss: 0.845, Test accuracy: 72.92
Round  54, Global train loss: 0.451, Global test loss: 1.218, Global test accuracy: 61.93
Round  55, Train loss: 0.453, Test loss: 0.848, Test accuracy: 72.83
Round  55, Global train loss: 0.453, Global test loss: 1.241, Global test accuracy: 60.11
Round  56, Train loss: 0.426, Test loss: 0.853, Test accuracy: 73.09
Round  56, Global train loss: 0.426, Global test loss: 1.142, Global test accuracy: 62.78
Round  57, Train loss: 0.444, Test loss: 0.854, Test accuracy: 73.28
Round  57, Global train loss: 0.444, Global test loss: 1.287, Global test accuracy: 59.90
Round  58, Train loss: 0.497, Test loss: 0.841, Test accuracy: 73.36
Round  58, Global train loss: 0.497, Global test loss: 1.164, Global test accuracy: 61.64
Round  59, Train loss: 0.463, Test loss: 0.839, Test accuracy: 73.61
Round  59, Global train loss: 0.463, Global test loss: 1.220, Global test accuracy: 60.62
Round  60, Train loss: 0.465, Test loss: 0.832, Test accuracy: 73.38
Round  60, Global train loss: 0.465, Global test loss: 1.404, Global test accuracy: 56.95
Round  61, Train loss: 0.431, Test loss: 0.846, Test accuracy: 73.42
Round  61, Global train loss: 0.431, Global test loss: 1.430, Global test accuracy: 57.29
Round  62, Train loss: 0.443, Test loss: 0.841, Test accuracy: 73.63
Round  62, Global train loss: 0.443, Global test loss: 1.232, Global test accuracy: 61.05
Round  63, Train loss: 0.421, Test loss: 0.857, Test accuracy: 73.50
Round  63, Global train loss: 0.421, Global test loss: 1.301, Global test accuracy: 58.90
Round  64, Train loss: 0.459, Test loss: 0.872, Test accuracy: 73.44
Round  64, Global train loss: 0.459, Global test loss: 1.084, Global test accuracy: 62.95
Round  65, Train loss: 0.470, Test loss: 0.896, Test accuracy: 73.06
Round  65, Global train loss: 0.470, Global test loss: 1.335, Global test accuracy: 57.81
Round  66, Train loss: 0.409, Test loss: 0.889, Test accuracy: 73.13
Round  66, Global train loss: 0.409, Global test loss: 1.331, Global test accuracy: 56.90
Round  67, Train loss: 0.421, Test loss: 0.887, Test accuracy: 72.68
Round  67, Global train loss: 0.421, Global test loss: 1.277, Global test accuracy: 58.46
Round  68, Train loss: 0.405, Test loss: 0.882, Test accuracy: 72.76
Round  68, Global train loss: 0.405, Global test loss: 1.307, Global test accuracy: 60.72
Round  69, Train loss: 0.401, Test loss: 0.856, Test accuracy: 73.21
Round  69, Global train loss: 0.401, Global test loss: 1.159, Global test accuracy: 63.87
Round  70, Train loss: 0.380, Test loss: 0.844, Test accuracy: 73.42
Round  70, Global train loss: 0.380, Global test loss: 1.207, Global test accuracy: 63.45
Round  71, Train loss: 0.373, Test loss: 0.846, Test accuracy: 73.29
Round  71, Global train loss: 0.373, Global test loss: 1.140, Global test accuracy: 63.95
Round  72, Train loss: 0.380, Test loss: 0.860, Test accuracy: 73.07
Round  72, Global train loss: 0.380, Global test loss: 1.140, Global test accuracy: 62.55
Round  73, Train loss: 0.430, Test loss: 0.869, Test accuracy: 73.24
Round  73, Global train loss: 0.430, Global test loss: 1.276, Global test accuracy: 59.63
Round  74, Train loss: 0.359, Test loss: 0.870, Test accuracy: 73.49
Round  74, Global train loss: 0.359, Global test loss: 1.324, Global test accuracy: 60.86
Round  75, Train loss: 0.385, Test loss: 0.888, Test accuracy: 73.42
Round  75, Global train loss: 0.385, Global test loss: 1.265, Global test accuracy: 61.12
Round  76, Train loss: 0.341, Test loss: 0.876, Test accuracy: 73.83
Round  76, Global train loss: 0.341, Global test loss: 1.494, Global test accuracy: 58.89
Round  77, Train loss: 0.387, Test loss: 0.896, Test accuracy: 73.75
Round  77, Global train loss: 0.387, Global test loss: 1.159, Global test accuracy: 63.21
Round  78, Train loss: 0.355, Test loss: 0.899, Test accuracy: 73.88
Round  78, Global train loss: 0.355, Global test loss: 1.410, Global test accuracy: 60.45
Round  79, Train loss: 0.344, Test loss: 0.901, Test accuracy: 73.88
Round  79, Global train loss: 0.344, Global test loss: 1.239, Global test accuracy: 62.95
Round  80, Train loss: 0.335, Test loss: 0.900, Test accuracy: 73.84
Round  80, Global train loss: 0.335, Global test loss: 1.210, Global test accuracy: 63.62
Round  81, Train loss: 0.398, Test loss: 0.879, Test accuracy: 74.20
Round  81, Global train loss: 0.398, Global test loss: 1.310, Global test accuracy: 59.46
Round  82, Train loss: 0.318, Test loss: 0.899, Test accuracy: 74.11
Round  82, Global train loss: 0.318, Global test loss: 1.265, Global test accuracy: 63.06
Round  83, Train loss: 0.326, Test loss: 0.910, Test accuracy: 73.85
Round  83, Global train loss: 0.326, Global test loss: 1.220, Global test accuracy: 62.51
Round  84, Train loss: 0.330, Test loss: 0.928, Test accuracy: 73.39
Round  84, Global train loss: 0.330, Global test loss: 1.295, Global test accuracy: 61.47
Round  85, Train loss: 0.366, Test loss: 0.923, Test accuracy: 73.48
Round  85, Global train loss: 0.366, Global test loss: 1.268, Global test accuracy: 60.42
Round  86, Train loss: 0.339, Test loss: 0.914, Test accuracy: 73.63
Round  86, Global train loss: 0.339, Global test loss: 1.297, Global test accuracy: 61.87
Round  87, Train loss: 0.352, Test loss: 0.897, Test accuracy: 73.55
Round  87, Global train loss: 0.352, Global test loss: 1.443, Global test accuracy: 58.12
Round  88, Train loss: 0.362, Test loss: 0.885, Test accuracy: 73.67
Round  88, Global train loss: 0.362, Global test loss: 1.141, Global test accuracy: 65.17
Round  89, Train loss: 0.355, Test loss: 0.887, Test accuracy: 74.10
Round  89, Global train loss: 0.355, Global test loss: 1.418, Global test accuracy: 59.34
Round  90, Train loss: 0.351, Test loss: 0.920, Test accuracy: 74.05
Round  90, Global train loss: 0.351, Global test loss: 1.294, Global test accuracy: 60.98
Round  91, Train loss: 0.348, Test loss: 0.916, Test accuracy: 74.27
Round  91, Global train loss: 0.348, Global test loss: 1.216, Global test accuracy: 62.25
Round  92, Train loss: 0.335, Test loss: 0.900, Test accuracy: 74.66
Round  92, Global train loss: 0.335, Global test loss: 1.156, Global test accuracy: 63.52
Round  93, Train loss: 0.324, Test loss: 0.914, Test accuracy: 74.82
Round  93, Global train loss: 0.324, Global test loss: 1.224, Global test accuracy: 63.49
Round  94, Train loss: 0.299, Test loss: 0.903, Test accuracy: 74.72
Round  94, Global train loss: 0.299, Global test loss: 1.504, Global test accuracy: 60.00
Round  95, Train loss: 0.317, Test loss: 0.924, Test accuracy: 74.65
Round  95, Global train loss: 0.317, Global test loss: 1.221, Global test accuracy: 62.92
Round  96, Train loss: 0.346, Test loss: 0.911, Test accuracy: 74.75
Round  96, Global train loss: 0.346, Global test loss: 1.262, Global test accuracy: 62.46
Round  97, Train loss: 0.267, Test loss: 0.919, Test accuracy: 74.65
Round  97, Global train loss: 0.267, Global test loss: 1.263, Global test accuracy: 63.37
Round  98, Train loss: 0.341, Test loss: 0.936, Test accuracy: 74.26
Round  98, Global train loss: 0.341, Global test loss: 1.303, Global test accuracy: 62.14
Round  99, Train loss: 0.280, Test loss: 0.928, Test accuracy: 74.68
Round  99, Global train loss: 0.280, Global test loss: 1.234, Global test accuracy: 63.59
Final Round, Train loss: 0.245, Test loss: 0.981, Test accuracy: 74.82
Final Round, Global train loss: 0.245, Global test loss: 1.234, Global test accuracy: 63.59
Average accuracy final 10 rounds: 74.551
Average global accuracy final 10 rounds: 62.472
1680.0010352134705
[1.364954948425293, 2.473339319229126, 3.5808217525482178, 4.690155506134033, 5.8005499839782715, 6.9117326736450195, 8.017767190933228, 9.139876127243042, 10.259047269821167, 11.378628492355347, 12.495134115219116, 13.618680000305176, 14.731543779373169, 15.849802732467651, 16.96999764442444, 18.08977746963501, 19.197136402130127, 20.304814100265503, 21.414600610733032, 22.521607160568237, 23.630066871643066, 25.892937183380127, 28.12961173057556, 30.364352226257324, 32.60238862037659, 34.85165023803711, 37.12128281593323, 39.3916175365448, 41.65883541107178, 43.93463706970215, 46.20622491836548, 48.485984325408936, 50.75941753387451, 53.03063344955444, 55.29861259460449, 57.57426738739014, 59.84340786933899, 62.11070799827576, 64.38177466392517, 66.6498167514801, 69.0109851360321, 71.2866005897522, 73.56232213973999, 75.82822918891907, 78.0999801158905, 80.37093448638916, 82.65395617485046, 84.92544531822205, 87.1956045627594, 89.47175860404968, 91.7399513721466, 93.99148941040039, 96.24389696121216, 98.49862265586853, 100.75161957740784, 103.01000595092773, 105.26561093330383, 107.5110547542572, 109.75966620445251, 112.00894045829773, 114.24792265892029, 116.49702644348145, 118.74999785423279, 121.00040912628174, 123.24500370025635, 125.49323081970215, 127.74390959739685, 130.00209641456604, 132.25179815292358, 134.5032799243927, 136.76034998893738, 139.01366233825684, 141.34206461906433, 143.60385942459106, 145.85291957855225, 148.10690665245056, 150.36178374290466, 152.61434864997864, 154.86326670646667, 157.1152663230896, 159.3658790588379, 161.61819195747375, 163.88068413734436, 166.13811707496643, 168.37470483779907, 170.57626223564148, 172.84723591804504, 175.11364316940308, 177.37775230407715, 179.64849376678467, 181.91454005241394, 184.1840205192566, 186.4525351524353, 188.72270703315735, 190.9664933681488, 193.211092710495, 195.45878744125366, 197.70413160324097, 199.9473738670349, 202.19673132896423, 204.41720581054688]
[25.07, 36.85, 44.16, 46.51, 49.91, 52.54, 55.71, 59.24, 61.47, 62.61, 63.33, 63.7, 64.58, 65.11, 65.67, 66.33, 66.96, 66.44, 66.59, 67.17, 66.98, 67.76, 67.82, 69.18, 69.89, 70.02, 70.25, 70.06, 70.53, 70.35, 70.72, 71.1, 71.03, 71.55, 71.31, 71.4, 71.1, 71.27, 71.97, 71.77, 71.93, 72.08, 72.35, 72.29, 72.68, 72.34, 72.57, 72.69, 72.22, 72.25, 72.35, 72.61, 72.17, 72.63, 72.92, 72.83, 73.09, 73.28, 73.36, 73.61, 73.38, 73.42, 73.63, 73.5, 73.44, 73.06, 73.13, 72.68, 72.76, 73.21, 73.42, 73.29, 73.07, 73.24, 73.49, 73.42, 73.83, 73.75, 73.88, 73.88, 73.84, 74.2, 74.11, 73.85, 73.39, 73.48, 73.63, 73.55, 73.67, 74.1, 74.05, 74.27, 74.66, 74.82, 74.72, 74.65, 74.75, 74.65, 74.26, 74.68, 74.82]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.496, Test loss: 1.255, Test accuracy: 47.54
Round   0, Global train loss: 1.496, Global test loss: 2.124, Global test accuracy: 27.46
Round   1, Train loss: 1.272, Test loss: 1.109, Test accuracy: 55.70
Round   1, Global train loss: 1.272, Global test loss: 1.784, Global test accuracy: 36.19
Round   2, Train loss: 1.128, Test loss: 1.020, Test accuracy: 60.42
Round   2, Global train loss: 1.128, Global test loss: 1.596, Global test accuracy: 42.53
Round   3, Train loss: 1.038, Test loss: 0.995, Test accuracy: 61.68
Round   3, Global train loss: 1.038, Global test loss: 1.513, Global test accuracy: 45.17
Round   4, Train loss: 0.976, Test loss: 0.972, Test accuracy: 63.16
Round   4, Global train loss: 0.976, Global test loss: 1.429, Global test accuracy: 47.53
Round   5, Train loss: 0.923, Test loss: 0.968, Test accuracy: 63.72
Round   5, Global train loss: 0.923, Global test loss: 1.363, Global test accuracy: 49.89
Round   6, Train loss: 0.872, Test loss: 0.946, Test accuracy: 65.29
Round   6, Global train loss: 0.872, Global test loss: 1.318, Global test accuracy: 51.93
Round   7, Train loss: 0.822, Test loss: 0.901, Test accuracy: 66.70
Round   7, Global train loss: 0.822, Global test loss: 1.268, Global test accuracy: 54.03
Round   8, Train loss: 0.778, Test loss: 0.924, Test accuracy: 66.72
Round   8, Global train loss: 0.778, Global test loss: 1.222, Global test accuracy: 56.53
Round   9, Train loss: 0.742, Test loss: 0.925, Test accuracy: 66.48
Round   9, Global train loss: 0.742, Global test loss: 1.203, Global test accuracy: 56.97
Round  10, Train loss: 0.676, Test loss: 0.909, Test accuracy: 67.21
Round  10, Global train loss: 0.676, Global test loss: 1.476, Global test accuracy: 50.48
Round  11, Train loss: 0.684, Test loss: 0.910, Test accuracy: 67.65
Round  11, Global train loss: 0.684, Global test loss: 1.529, Global test accuracy: 50.36
Round  12, Train loss: 0.646, Test loss: 0.911, Test accuracy: 67.85
Round  12, Global train loss: 0.646, Global test loss: 1.453, Global test accuracy: 52.98
Round  13, Train loss: 0.692, Test loss: 0.909, Test accuracy: 68.39
Round  13, Global train loss: 0.692, Global test loss: 1.250, Global test accuracy: 55.27
Round  14, Train loss: 0.638, Test loss: 0.914, Test accuracy: 69.06
Round  14, Global train loss: 0.638, Global test loss: 1.286, Global test accuracy: 55.52
Round  15, Train loss: 0.557, Test loss: 0.913, Test accuracy: 68.84
Round  15, Global train loss: 0.557, Global test loss: 1.146, Global test accuracy: 60.57
Round  16, Train loss: 0.520, Test loss: 0.915, Test accuracy: 69.39
Round  16, Global train loss: 0.520, Global test loss: 1.349, Global test accuracy: 55.08
Round  17, Train loss: 0.586, Test loss: 0.924, Test accuracy: 69.76
Round  17, Global train loss: 0.586, Global test loss: 1.246, Global test accuracy: 57.23
Round  18, Train loss: 0.520, Test loss: 0.940, Test accuracy: 69.84
Round  18, Global train loss: 0.520, Global test loss: 1.390, Global test accuracy: 57.18
Round  19, Train loss: 0.523, Test loss: 0.940, Test accuracy: 70.24
Round  19, Global train loss: 0.523, Global test loss: 1.298, Global test accuracy: 56.98
Round  20, Train loss: 0.515, Test loss: 0.951, Test accuracy: 70.49
Round  20, Global train loss: 0.515, Global test loss: 1.398, Global test accuracy: 55.22
Round  21, Train loss: 0.500, Test loss: 0.970, Test accuracy: 70.34
Round  21, Global train loss: 0.500, Global test loss: 1.517, Global test accuracy: 55.47
Round  22, Train loss: 0.460, Test loss: 0.974, Test accuracy: 70.54
Round  22, Global train loss: 0.460, Global test loss: 1.306, Global test accuracy: 58.51
Round  23, Train loss: 0.422, Test loss: 0.978, Test accuracy: 70.69
Round  23, Global train loss: 0.422, Global test loss: 1.264, Global test accuracy: 61.18
Round  24, Train loss: 0.433, Test loss: 0.990, Test accuracy: 70.74
Round  24, Global train loss: 0.433, Global test loss: 1.300, Global test accuracy: 59.63
Round  25, Train loss: 0.469, Test loss: 0.976, Test accuracy: 71.46
Round  25, Global train loss: 0.469, Global test loss: 1.524, Global test accuracy: 55.41
Round  26, Train loss: 0.445, Test loss: 0.977, Test accuracy: 71.91
Round  26, Global train loss: 0.445, Global test loss: 1.242, Global test accuracy: 59.01
Round  27, Train loss: 0.395, Test loss: 0.996, Test accuracy: 71.47
Round  27, Global train loss: 0.395, Global test loss: 1.406, Global test accuracy: 59.55
Round  28, Train loss: 0.413, Test loss: 1.026, Test accuracy: 70.99
Round  28, Global train loss: 0.413, Global test loss: 1.547, Global test accuracy: 55.33
Round  29, Train loss: 0.355, Test loss: 1.030, Test accuracy: 71.18
Round  29, Global train loss: 0.355, Global test loss: 1.350, Global test accuracy: 59.90
Round  30, Train loss: 0.334, Test loss: 1.042, Test accuracy: 71.18
Round  30, Global train loss: 0.334, Global test loss: 1.359, Global test accuracy: 59.01
Round  31, Train loss: 0.363, Test loss: 1.043, Test accuracy: 71.56
Round  31, Global train loss: 0.363, Global test loss: 1.569, Global test accuracy: 54.33
Round  32, Train loss: 0.358, Test loss: 1.037, Test accuracy: 71.68
Round  32, Global train loss: 0.358, Global test loss: 1.341, Global test accuracy: 60.36
Round  33, Train loss: 0.348, Test loss: 1.058, Test accuracy: 71.70
Round  33, Global train loss: 0.348, Global test loss: 1.454, Global test accuracy: 56.39
Round  34, Train loss: 0.307, Test loss: 1.069, Test accuracy: 71.46
Round  34, Global train loss: 0.307, Global test loss: 1.409, Global test accuracy: 58.91
Round  35, Train loss: 0.384, Test loss: 1.060, Test accuracy: 71.55
Round  35, Global train loss: 0.384, Global test loss: 1.738, Global test accuracy: 52.51
Round  36, Train loss: 0.324, Test loss: 1.080, Test accuracy: 71.69
Round  36, Global train loss: 0.324, Global test loss: 1.386, Global test accuracy: 58.95
Round  37, Train loss: 0.348, Test loss: 1.078, Test accuracy: 71.51
Round  37, Global train loss: 0.348, Global test loss: 1.316, Global test accuracy: 60.54
Round  38, Train loss: 0.277, Test loss: 1.064, Test accuracy: 71.54
Round  38, Global train loss: 0.277, Global test loss: 1.505, Global test accuracy: 58.94
Round  39, Train loss: 0.386, Test loss: 1.073, Test accuracy: 71.87
Round  39, Global train loss: 0.386, Global test loss: 1.325, Global test accuracy: 60.18
Round  40, Train loss: 0.319, Test loss: 1.055, Test accuracy: 72.13
Round  40, Global train loss: 0.319, Global test loss: 1.565, Global test accuracy: 58.07
Round  41, Train loss: 0.344, Test loss: 1.088, Test accuracy: 71.94
Round  41, Global train loss: 0.344, Global test loss: 1.787, Global test accuracy: 54.96
Round  42, Train loss: 0.316, Test loss: 1.105, Test accuracy: 71.75
Round  42, Global train loss: 0.316, Global test loss: 1.350, Global test accuracy: 60.09
Round  43, Train loss: 0.286, Test loss: 1.126, Test accuracy: 71.65
Round  43, Global train loss: 0.286, Global test loss: 1.416, Global test accuracy: 59.80
Round  44, Train loss: 0.259, Test loss: 1.124, Test accuracy: 72.07
Round  44, Global train loss: 0.259, Global test loss: 1.382, Global test accuracy: 59.68
Round  45, Train loss: 0.257, Test loss: 1.141, Test accuracy: 71.71
Round  45, Global train loss: 0.257, Global test loss: 1.274, Global test accuracy: 63.17
Round  46, Train loss: 0.294, Test loss: 1.141, Test accuracy: 72.09
Round  46, Global train loss: 0.294, Global test loss: 1.395, Global test accuracy: 60.63
Round  47, Train loss: 0.299, Test loss: 1.118, Test accuracy: 72.57
Round  47, Global train loss: 0.299, Global test loss: 1.639, Global test accuracy: 57.81
Round  48, Train loss: 0.312, Test loss: 1.088, Test accuracy: 72.94
Round  48, Global train loss: 0.312, Global test loss: 1.512, Global test accuracy: 58.16
Round  49, Train loss: 0.233, Test loss: 1.095, Test accuracy: 72.77
Round  49, Global train loss: 0.233, Global test loss: 1.592, Global test accuracy: 58.45
Round  50, Train loss: 0.274, Test loss: 1.095, Test accuracy: 72.76
Round  50, Global train loss: 0.274, Global test loss: 1.334, Global test accuracy: 63.53
Round  51, Train loss: 0.246, Test loss: 1.091, Test accuracy: 72.80
Round  51, Global train loss: 0.246, Global test loss: 1.467, Global test accuracy: 62.12
Round  52, Train loss: 0.271, Test loss: 1.122, Test accuracy: 72.84
Round  52, Global train loss: 0.271, Global test loss: 1.915, Global test accuracy: 56.03
Round  53, Train loss: 0.244, Test loss: 1.117, Test accuracy: 73.04
Round  53, Global train loss: 0.244, Global test loss: 1.568, Global test accuracy: 59.59
Round  54, Train loss: 0.247, Test loss: 1.124, Test accuracy: 73.00
Round  54, Global train loss: 0.247, Global test loss: 1.493, Global test accuracy: 61.60
Round  55, Train loss: 0.249, Test loss: 1.130, Test accuracy: 73.07
Round  55, Global train loss: 0.249, Global test loss: 1.580, Global test accuracy: 58.15
Round  56, Train loss: 0.246, Test loss: 1.147, Test accuracy: 72.78
Round  56, Global train loss: 0.246, Global test loss: 1.405, Global test accuracy: 61.31
Round  57, Train loss: 0.247, Test loss: 1.155, Test accuracy: 72.69
Round  57, Global train loss: 0.247, Global test loss: 1.562, Global test accuracy: 60.30
Round  58, Train loss: 0.264, Test loss: 1.166, Test accuracy: 72.60
Round  58, Global train loss: 0.264, Global test loss: 1.445, Global test accuracy: 60.79
Round  59, Train loss: 0.245, Test loss: 1.158, Test accuracy: 73.08
Round  59, Global train loss: 0.245, Global test loss: 1.453, Global test accuracy: 60.78
Round  60, Train loss: 0.239, Test loss: 1.180, Test accuracy: 73.06
Round  60, Global train loss: 0.239, Global test loss: 1.758, Global test accuracy: 57.13
Round  61, Train loss: 0.227, Test loss: 1.198, Test accuracy: 72.66
Round  61, Global train loss: 0.227, Global test loss: 1.652, Global test accuracy: 59.38
Round  62, Train loss: 0.226, Test loss: 1.165, Test accuracy: 72.83
Round  62, Global train loss: 0.226, Global test loss: 1.565, Global test accuracy: 59.48
Round  63, Train loss: 0.221, Test loss: 1.164, Test accuracy: 73.16
Round  63, Global train loss: 0.221, Global test loss: 1.766, Global test accuracy: 57.38
Round  64, Train loss: 0.225, Test loss: 1.180, Test accuracy: 72.96
Round  64, Global train loss: 0.225, Global test loss: 1.332, Global test accuracy: 62.81
Round  65, Train loss: 0.258, Test loss: 1.199, Test accuracy: 72.83
Round  65, Global train loss: 0.258, Global test loss: 1.598, Global test accuracy: 59.23
Round  66, Train loss: 0.223, Test loss: 1.197, Test accuracy: 72.97
Round  66, Global train loss: 0.223, Global test loss: 1.701, Global test accuracy: 56.11
Round  67, Train loss: 0.239, Test loss: 1.198, Test accuracy: 73.06
Round  67, Global train loss: 0.239, Global test loss: 1.642, Global test accuracy: 58.86
Round  68, Train loss: 0.198, Test loss: 1.200, Test accuracy: 73.08
Round  68, Global train loss: 0.198, Global test loss: 1.680, Global test accuracy: 61.24
Round  69, Train loss: 0.222, Test loss: 1.196, Test accuracy: 72.82
Round  69, Global train loss: 0.222, Global test loss: 1.541, Global test accuracy: 61.10
Round  70, Train loss: 0.209, Test loss: 1.205, Test accuracy: 72.77
Round  70, Global train loss: 0.209, Global test loss: 1.669, Global test accuracy: 61.50
Round  71, Train loss: 0.179, Test loss: 1.203, Test accuracy: 73.03
Round  71, Global train loss: 0.179, Global test loss: 1.504, Global test accuracy: 61.63
Round  72, Train loss: 0.194, Test loss: 1.203, Test accuracy: 73.29
Round  72, Global train loss: 0.194, Global test loss: 1.456, Global test accuracy: 62.51
Round  73, Train loss: 0.218, Test loss: 1.196, Test accuracy: 73.71
Round  73, Global train loss: 0.218, Global test loss: 1.644, Global test accuracy: 60.21
Round  74, Train loss: 0.171, Test loss: 1.198, Test accuracy: 73.61
Round  74, Global train loss: 0.171, Global test loss: 1.658, Global test accuracy: 61.67
Round  75, Train loss: 0.195, Test loss: 1.173, Test accuracy: 73.81
Round  75, Global train loss: 0.195, Global test loss: 1.648, Global test accuracy: 60.21
Round  76, Train loss: 0.174, Test loss: 1.212, Test accuracy: 73.13
Round  76, Global train loss: 0.174, Global test loss: 2.156, Global test accuracy: 57.03
Round  77, Train loss: 0.193, Test loss: 1.242, Test accuracy: 72.87
Round  77, Global train loss: 0.193, Global test loss: 1.513, Global test accuracy: 61.63
Round  78, Train loss: 0.186, Test loss: 1.240, Test accuracy: 73.08
Round  78, Global train loss: 0.186, Global test loss: 1.786, Global test accuracy: 59.85
Round  79, Train loss: 0.181, Test loss: 1.223, Test accuracy: 73.45
Round  79, Global train loss: 0.181, Global test loss: 1.642, Global test accuracy: 60.93
Round  80, Train loss: 0.146, Test loss: 1.249, Test accuracy: 73.62
Round  80, Global train loss: 0.146, Global test loss: 1.683, Global test accuracy: 62.18
Round  81, Train loss: 0.139, Test loss: 1.215, Test accuracy: 73.86
Round  81, Global train loss: 0.139, Global test loss: 1.719, Global test accuracy: 62.47
Round  82, Train loss: 0.130, Test loss: 1.196, Test accuracy: 74.12
Round  82, Global train loss: 0.130, Global test loss: 1.754, Global test accuracy: 62.79
Round  83, Train loss: 0.128, Test loss: 1.233, Test accuracy: 73.39
Round  83, Global train loss: 0.128, Global test loss: 1.757, Global test accuracy: 62.64
Round  84, Train loss: 0.118, Test loss: 1.220, Test accuracy: 73.85
Round  84, Global train loss: 0.118, Global test loss: 1.752, Global test accuracy: 62.71
Round  85, Train loss: 0.121, Test loss: 1.207, Test accuracy: 73.87
Round  85, Global train loss: 0.121, Global test loss: 1.780, Global test accuracy: 62.72
Round  86, Train loss: 0.108, Test loss: 1.233, Test accuracy: 74.05
Round  86, Global train loss: 0.108, Global test loss: 1.796, Global test accuracy: 62.97
Round  87, Train loss: 0.106, Test loss: 1.222, Test accuracy: 74.37
Round  87, Global train loss: 0.106, Global test loss: 1.872, Global test accuracy: 62.95
Round  88, Train loss: 0.099, Test loss: 1.299, Test accuracy: 73.35
Round  88, Global train loss: 0.099, Global test loss: 1.889, Global test accuracy: 62.80
Round  89, Train loss: 0.104, Test loss: 1.283, Test accuracy: 74.08
Round  89, Global train loss: 0.104, Global test loss: 1.917, Global test accuracy: 62.25
Round  90, Train loss: 0.196, Test loss: 1.264, Test accuracy: 73.71
Round  90, Global train loss: 0.196, Global test loss: 1.406, Global test accuracy: 64.60
Round  91, Train loss: 0.169, Test loss: 1.250, Test accuracy: 74.54
Round  91, Global train loss: 0.169, Global test loss: 1.382, Global test accuracy: 65.67
Round  92, Train loss: 0.170, Test loss: 1.281, Test accuracy: 73.76
Round  92, Global train loss: 0.170, Global test loss: 1.367, Global test accuracy: 65.68
Round  93, Train loss: 0.159, Test loss: 1.305, Test accuracy: 73.68
Round  93, Global train loss: 0.159, Global test loss: 1.389, Global test accuracy: 65.54
Round  94, Train loss: 0.162, Test loss: 1.289, Test accuracy: 73.67
Round  94, Global train loss: 0.162, Global test loss: 1.374, Global test accuracy: 65.90
Round  95, Train loss: 0.159, Test loss: 1.258, Test accuracy: 73.54
Round  95, Global train loss: 0.159, Global test loss: 1.363, Global test accuracy: 65.88
Round  96, Train loss: 0.153, Test loss: 1.255, Test accuracy: 74.66
Round  96, Global train loss: 0.153, Global test loss: 1.389, Global test accuracy: 65.28
Round  97, Train loss: 0.153, Test loss: 1.238, Test accuracy: 73.77
Round  97, Global train loss: 0.153, Global test loss: 1.388, Global test accuracy: 65.66
Round  98, Train loss: 0.153, Test loss: 1.295, Test accuracy: 74.14
Round  98, Global train loss: 0.153, Global test loss: 1.383, Global test accuracy: 65.82
Round  99, Train loss: 0.144, Test loss: 1.288, Test accuracy: 74.04
Round  99, Global train loss: 0.144, Global test loss: 1.402, Global test accuracy: 65.83
Final Round, Train loss: 0.115, Test loss: 1.373, Test accuracy: 73.60
Final Round, Global train loss: 0.115, Global test loss: 1.402, Global test accuracy: 65.83
Average accuracy final 10 rounds: 73.951
Average global accuracy final 10 rounds: 65.58600000000001
2387.290019750595
[2.490523338317871, 4.7176618576049805, 6.946768045425415, 9.179608821868896, 11.406437397003174, 13.636343240737915, 15.86139440536499, 18.086474895477295, 20.304471015930176, 22.52072238922119, 24.72134256362915, 26.927184581756592, 29.124292373657227, 31.323511600494385, 33.523438692092896, 35.730324268341064, 37.947237968444824, 40.17298078536987, 42.39895677566528, 44.63036775588989, 46.85362792015076, 49.080073833465576, 51.30692195892334, 53.522860527038574, 55.747828006744385, 57.9695827960968, 60.19871401786804, 62.42802929878235, 64.64142394065857, 66.85220646858215, 69.0624327659607, 71.29557728767395, 73.52468657493591, 75.75566959381104, 77.97824788093567, 80.20252847671509, 82.43589925765991, 84.66842865943909, 86.89736104011536, 89.13263726234436, 91.357990026474, 93.59049105644226, 95.82031345367432, 98.04651236534119, 100.26951932907104, 102.49085783958435, 104.71947240829468, 106.94897055625916, 109.16830730438232, 111.06857252120972, 112.9708662033081, 114.87178659439087, 116.77463030815125, 118.67534685134888, 120.57568335533142, 122.47862720489502, 124.3824257850647, 126.28660678863525, 128.1910789012909, 130.0926902294159, 131.99570417404175, 133.89767217636108, 135.79698634147644, 137.70046210289001, 139.60443139076233, 141.50582695007324, 143.40671610832214, 145.30862617492676, 147.21087884902954, 149.11604928970337, 151.02074909210205, 152.9242913722992, 154.82821893692017, 156.73307132720947, 158.63249158859253, 160.53374338150024, 162.4331512451172, 164.33446145057678, 166.23806643486023, 168.1404266357422, 170.04346227645874, 171.9443802833557, 173.84591627120972, 175.74836230278015, 177.6489839553833, 179.54752159118652, 181.44814944267273, 183.3519504070282, 185.25704216957092, 187.15953612327576, 189.06598210334778, 190.9682502746582, 192.88786506652832, 194.8102924823761, 196.71892094612122, 198.62690806388855, 200.53248238563538, 202.43873262405396, 204.34381985664368, 206.24749159812927, 210.0559573173523]
[47.54, 55.7, 60.42, 61.68, 63.16, 63.72, 65.29, 66.7, 66.72, 66.48, 67.21, 67.65, 67.85, 68.39, 69.06, 68.84, 69.39, 69.76, 69.84, 70.24, 70.49, 70.34, 70.54, 70.69, 70.74, 71.46, 71.91, 71.47, 70.99, 71.18, 71.18, 71.56, 71.68, 71.7, 71.46, 71.55, 71.69, 71.51, 71.54, 71.87, 72.13, 71.94, 71.75, 71.65, 72.07, 71.71, 72.09, 72.57, 72.94, 72.77, 72.76, 72.8, 72.84, 73.04, 73.0, 73.07, 72.78, 72.69, 72.6, 73.08, 73.06, 72.66, 72.83, 73.16, 72.96, 72.83, 72.97, 73.06, 73.08, 72.82, 72.77, 73.03, 73.29, 73.71, 73.61, 73.81, 73.13, 72.87, 73.08, 73.45, 73.62, 73.86, 74.12, 73.39, 73.85, 73.87, 74.05, 74.37, 73.35, 74.08, 73.71, 74.54, 73.76, 73.68, 73.67, 73.54, 74.66, 73.77, 74.14, 74.04, 73.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.476, Test loss: 1.240, Test accuracy: 49.04
Round   0, Global train loss: 1.476, Global test loss: 2.026, Global test accuracy: 28.02
Round   1, Train loss: 1.259, Test loss: 1.104, Test accuracy: 56.53
Round   1, Global train loss: 1.259, Global test loss: 1.767, Global test accuracy: 34.66
Round   2, Train loss: 1.129, Test loss: 1.030, Test accuracy: 59.57
Round   2, Global train loss: 1.129, Global test loss: 1.601, Global test accuracy: 41.59
Round   3, Train loss: 1.046, Test loss: 1.001, Test accuracy: 61.12
Round   3, Global train loss: 1.046, Global test loss: 1.490, Global test accuracy: 45.80
Round   4, Train loss: 0.982, Test loss: 0.959, Test accuracy: 64.09
Round   4, Global train loss: 0.982, Global test loss: 1.416, Global test accuracy: 48.29
Round   5, Train loss: 0.925, Test loss: 0.918, Test accuracy: 64.94
Round   5, Global train loss: 0.925, Global test loss: 1.337, Global test accuracy: 51.59
Round   6, Train loss: 0.872, Test loss: 0.958, Test accuracy: 65.25
Round   6, Global train loss: 0.872, Global test loss: 1.294, Global test accuracy: 52.98
Round   7, Train loss: 0.824, Test loss: 0.946, Test accuracy: 65.37
Round   7, Global train loss: 0.824, Global test loss: 1.254, Global test accuracy: 54.46
Round   8, Train loss: 0.785, Test loss: 0.916, Test accuracy: 66.79
Round   8, Global train loss: 0.785, Global test loss: 1.236, Global test accuracy: 55.47
Round   9, Train loss: 0.748, Test loss: 0.894, Test accuracy: 67.98
Round   9, Global train loss: 0.748, Global test loss: 1.187, Global test accuracy: 57.54
Round  10, Train loss: 0.680, Test loss: 0.900, Test accuracy: 67.99
Round  10, Global train loss: 0.680, Global test loss: 1.418, Global test accuracy: 51.94
Round  11, Train loss: 0.740, Test loss: 0.905, Test accuracy: 68.24
Round  11, Global train loss: 0.740, Global test loss: 1.417, Global test accuracy: 50.86
Round  12, Train loss: 0.643, Test loss: 0.894, Test accuracy: 68.76
Round  12, Global train loss: 0.643, Global test loss: 1.403, Global test accuracy: 53.42
Round  13, Train loss: 0.659, Test loss: 0.886, Test accuracy: 69.04
Round  13, Global train loss: 0.659, Global test loss: 1.237, Global test accuracy: 56.86
Round  14, Train loss: 0.668, Test loss: 0.909, Test accuracy: 68.71
Round  14, Global train loss: 0.668, Global test loss: 1.195, Global test accuracy: 58.49
Round  15, Train loss: 0.513, Test loss: 0.909, Test accuracy: 68.80
Round  15, Global train loss: 0.513, Global test loss: 1.178, Global test accuracy: 61.06
Round  16, Train loss: 0.509, Test loss: 0.937, Test accuracy: 68.35
Round  16, Global train loss: 0.509, Global test loss: 1.375, Global test accuracy: 55.84
Round  17, Train loss: 0.572, Test loss: 0.940, Test accuracy: 69.18
Round  17, Global train loss: 0.572, Global test loss: 1.232, Global test accuracy: 58.23
Round  18, Train loss: 0.512, Test loss: 0.951, Test accuracy: 68.91
Round  18, Global train loss: 0.512, Global test loss: 1.340, Global test accuracy: 57.07
Round  19, Train loss: 0.508, Test loss: 0.936, Test accuracy: 69.76
Round  19, Global train loss: 0.508, Global test loss: 1.205, Global test accuracy: 59.02
Round  20, Train loss: 0.518, Test loss: 0.963, Test accuracy: 69.61
Round  20, Global train loss: 0.518, Global test loss: 1.308, Global test accuracy: 57.02
Round  21, Train loss: 0.553, Test loss: 0.969, Test accuracy: 69.65
Round  21, Global train loss: 0.553, Global test loss: 1.366, Global test accuracy: 56.21
Round  22, Train loss: 0.490, Test loss: 0.989, Test accuracy: 70.05
Round  22, Global train loss: 0.490, Global test loss: 1.301, Global test accuracy: 57.24
Round  23, Train loss: 0.459, Test loss: 0.987, Test accuracy: 70.62
Round  23, Global train loss: 0.459, Global test loss: 1.288, Global test accuracy: 60.45
Round  24, Train loss: 0.441, Test loss: 0.995, Test accuracy: 70.74
Round  24, Global train loss: 0.441, Global test loss: 1.227, Global test accuracy: 59.94
Round  25, Train loss: 0.458, Test loss: 0.977, Test accuracy: 71.01
Round  25, Global train loss: 0.458, Global test loss: 1.392, Global test accuracy: 56.81
Round  26, Train loss: 0.426, Test loss: 0.976, Test accuracy: 71.24
Round  26, Global train loss: 0.426, Global test loss: 1.177, Global test accuracy: 60.56
Round  27, Train loss: 0.384, Test loss: 0.972, Test accuracy: 71.42
Round  27, Global train loss: 0.384, Global test loss: 1.316, Global test accuracy: 61.27
Round  28, Train loss: 0.439, Test loss: 0.972, Test accuracy: 71.28
Round  28, Global train loss: 0.439, Global test loss: 1.402, Global test accuracy: 55.59
Round  29, Train loss: 0.347, Test loss: 0.979, Test accuracy: 71.61
Round  29, Global train loss: 0.347, Global test loss: 1.330, Global test accuracy: 61.14
Round  30, Train loss: 0.346, Test loss: 1.017, Test accuracy: 71.31
Round  30, Global train loss: 0.346, Global test loss: 1.385, Global test accuracy: 59.43
Round  31, Train loss: 0.350, Test loss: 1.007, Test accuracy: 71.34
Round  31, Global train loss: 0.350, Global test loss: 1.486, Global test accuracy: 56.46
Round  32, Train loss: 0.350, Test loss: 1.010, Test accuracy: 71.84
Round  32, Global train loss: 0.350, Global test loss: 1.326, Global test accuracy: 60.35
Round  33, Train loss: 0.334, Test loss: 1.006, Test accuracy: 71.54
Round  33, Global train loss: 0.334, Global test loss: 1.286, Global test accuracy: 60.81
Round  34, Train loss: 0.316, Test loss: 1.000, Test accuracy: 72.15
Round  34, Global train loss: 0.316, Global test loss: 1.350, Global test accuracy: 60.12
Round  35, Train loss: 0.398, Test loss: 1.027, Test accuracy: 72.36
Round  35, Global train loss: 0.398, Global test loss: 1.513, Global test accuracy: 56.09
Round  36, Train loss: 0.343, Test loss: 1.040, Test accuracy: 72.15
Round  36, Global train loss: 0.343, Global test loss: 1.415, Global test accuracy: 59.54
Round  37, Train loss: 0.367, Test loss: 1.039, Test accuracy: 72.60
Round  37, Global train loss: 0.367, Global test loss: 1.225, Global test accuracy: 62.72
Round  38, Train loss: 0.289, Test loss: 1.039, Test accuracy: 72.67
Round  38, Global train loss: 0.289, Global test loss: 1.421, Global test accuracy: 60.43
Round  39, Train loss: 0.410, Test loss: 1.034, Test accuracy: 72.54
Round  39, Global train loss: 0.410, Global test loss: 1.226, Global test accuracy: 61.00
Round  40, Train loss: 0.325, Test loss: 1.048, Test accuracy: 72.68
Round  40, Global train loss: 0.325, Global test loss: 1.473, Global test accuracy: 59.01
Round  41, Train loss: 0.345, Test loss: 1.052, Test accuracy: 73.18
Round  41, Global train loss: 0.345, Global test loss: 1.523, Global test accuracy: 57.70
Round  42, Train loss: 0.308, Test loss: 1.023, Test accuracy: 73.50
Round  42, Global train loss: 0.308, Global test loss: 1.287, Global test accuracy: 62.37
Round  43, Train loss: 0.282, Test loss: 1.017, Test accuracy: 74.16
Round  43, Global train loss: 0.282, Global test loss: 1.280, Global test accuracy: 61.96
Round  44, Train loss: 0.270, Test loss: 1.002, Test accuracy: 74.07
Round  44, Global train loss: 0.270, Global test loss: 1.302, Global test accuracy: 61.41
Round  45, Train loss: 0.259, Test loss: 1.026, Test accuracy: 73.17
Round  45, Global train loss: 0.259, Global test loss: 1.271, Global test accuracy: 62.05
Round  46, Train loss: 0.295, Test loss: 1.035, Test accuracy: 73.58
Round  46, Global train loss: 0.295, Global test loss: 1.350, Global test accuracy: 62.37
Round  47, Train loss: 0.278, Test loss: 1.020, Test accuracy: 73.68
Round  47, Global train loss: 0.278, Global test loss: 1.368, Global test accuracy: 62.26
Round  48, Train loss: 0.309, Test loss: 1.028, Test accuracy: 73.66
Round  48, Global train loss: 0.309, Global test loss: 1.263, Global test accuracy: 62.58
Round  49, Train loss: 0.256, Test loss: 1.049, Test accuracy: 73.41
Round  49, Global train loss: 0.256, Global test loss: 1.421, Global test accuracy: 61.08
Round  50, Train loss: 0.293, Test loss: 1.033, Test accuracy: 73.41
Round  50, Global train loss: 0.293, Global test loss: 1.265, Global test accuracy: 63.70
Round  51, Train loss: 0.256, Test loss: 1.052, Test accuracy: 73.10
Round  51, Global train loss: 0.256, Global test loss: 1.401, Global test accuracy: 64.08
Round  52, Train loss: 0.297, Test loss: 1.044, Test accuracy: 73.57
Round  52, Global train loss: 0.297, Global test loss: 1.782, Global test accuracy: 55.92
Round  53, Train loss: 0.232, Test loss: 1.047, Test accuracy: 73.58
Round  53, Global train loss: 0.232, Global test loss: 1.431, Global test accuracy: 61.39
Round  54, Train loss: 0.274, Test loss: 1.056, Test accuracy: 73.48
Round  54, Global train loss: 0.274, Global test loss: 1.358, Global test accuracy: 63.15
Round  55, Train loss: 0.254, Test loss: 1.068, Test accuracy: 73.41
Round  55, Global train loss: 0.254, Global test loss: 1.433, Global test accuracy: 61.37
Round  56, Train loss: 0.241, Test loss: 1.070, Test accuracy: 73.41
Round  56, Global train loss: 0.241, Global test loss: 1.222, Global test accuracy: 64.78
Round  57, Train loss: 0.255, Test loss: 1.087, Test accuracy: 72.76
Round  57, Global train loss: 0.255, Global test loss: 1.393, Global test accuracy: 61.00
Round  58, Train loss: 0.252, Test loss: 1.089, Test accuracy: 73.08
Round  58, Global train loss: 0.252, Global test loss: 1.340, Global test accuracy: 62.71
Round  59, Train loss: 0.253, Test loss: 1.091, Test accuracy: 73.28
Round  59, Global train loss: 0.253, Global test loss: 1.407, Global test accuracy: 61.59
Round  60, Train loss: 0.234, Test loss: 1.096, Test accuracy: 73.59
Round  60, Global train loss: 0.234, Global test loss: 1.762, Global test accuracy: 56.74
Round  61, Train loss: 0.251, Test loss: 1.136, Test accuracy: 73.32
Round  61, Global train loss: 0.251, Global test loss: 1.634, Global test accuracy: 60.01
Round  62, Train loss: 0.206, Test loss: 1.123, Test accuracy: 73.52
Round  62, Global train loss: 0.206, Global test loss: 1.486, Global test accuracy: 61.58
Round  63, Train loss: 0.232, Test loss: 1.134, Test accuracy: 73.73
Round  63, Global train loss: 0.232, Global test loss: 1.467, Global test accuracy: 62.22
Round  64, Train loss: 0.220, Test loss: 1.136, Test accuracy: 73.59
Round  64, Global train loss: 0.220, Global test loss: 1.308, Global test accuracy: 63.20
Round  65, Train loss: 0.273, Test loss: 1.122, Test accuracy: 73.85
Round  65, Global train loss: 0.273, Global test loss: 1.625, Global test accuracy: 58.96
Round  66, Train loss: 0.214, Test loss: 1.109, Test accuracy: 73.83
Round  66, Global train loss: 0.214, Global test loss: 1.582, Global test accuracy: 58.50
Round  67, Train loss: 0.251, Test loss: 1.092, Test accuracy: 74.26
Round  67, Global train loss: 0.251, Global test loss: 1.624, Global test accuracy: 58.79
Round  68, Train loss: 0.236, Test loss: 1.110, Test accuracy: 73.98
Round  68, Global train loss: 0.236, Global test loss: 1.711, Global test accuracy: 59.11
Round  69, Train loss: 0.221, Test loss: 1.145, Test accuracy: 73.63
Round  69, Global train loss: 0.221, Global test loss: 1.443, Global test accuracy: 63.46
Round  70, Train loss: 0.222, Test loss: 1.161, Test accuracy: 73.83
Round  70, Global train loss: 0.222, Global test loss: 1.581, Global test accuracy: 62.19
Round  71, Train loss: 0.182, Test loss: 1.148, Test accuracy: 74.13
Round  71, Global train loss: 0.182, Global test loss: 1.510, Global test accuracy: 62.76
Round  72, Train loss: 0.197, Test loss: 1.161, Test accuracy: 73.98
Round  72, Global train loss: 0.197, Global test loss: 1.425, Global test accuracy: 62.32
Round  73, Train loss: 0.235, Test loss: 1.153, Test accuracy: 74.24
Round  73, Global train loss: 0.235, Global test loss: 1.565, Global test accuracy: 59.37
Round  74, Train loss: 0.179, Test loss: 1.138, Test accuracy: 74.51
Round  74, Global train loss: 0.179, Global test loss: 1.524, Global test accuracy: 62.12
Round  75, Train loss: 0.193, Test loss: 1.153, Test accuracy: 74.26
Round  75, Global train loss: 0.193, Global test loss: 1.529, Global test accuracy: 61.35
Round  76, Train loss: 0.160, Test loss: 1.150, Test accuracy: 74.32
Round  76, Global train loss: 0.160, Global test loss: 2.008, Global test accuracy: 59.10
Round  77, Train loss: 0.197, Test loss: 1.156, Test accuracy: 73.97
Round  77, Global train loss: 0.197, Global test loss: 1.498, Global test accuracy: 62.45
Round  78, Train loss: 0.195, Test loss: 1.156, Test accuracy: 74.13
Round  78, Global train loss: 0.195, Global test loss: 1.631, Global test accuracy: 61.90
Round  79, Train loss: 0.162, Test loss: 1.181, Test accuracy: 73.88
Round  79, Global train loss: 0.162, Global test loss: 1.532, Global test accuracy: 63.74
Round  80, Train loss: 0.156, Test loss: 1.168, Test accuracy: 74.30
Round  80, Global train loss: 0.156, Global test loss: 1.478, Global test accuracy: 64.14
Round  81, Train loss: 0.143, Test loss: 1.155, Test accuracy: 74.57
Round  81, Global train loss: 0.143, Global test loss: 1.621, Global test accuracy: 63.78
Round  82, Train loss: 0.134, Test loss: 1.168, Test accuracy: 74.06
Round  82, Global train loss: 0.134, Global test loss: 1.647, Global test accuracy: 63.80
Round  83, Train loss: 0.124, Test loss: 1.166, Test accuracy: 74.91
Round  83, Global train loss: 0.124, Global test loss: 1.693, Global test accuracy: 64.21
Round  84, Train loss: 0.122, Test loss: 1.192, Test accuracy: 74.28
Round  84, Global train loss: 0.122, Global test loss: 1.728, Global test accuracy: 63.33
Round  85, Train loss: 0.110, Test loss: 1.206, Test accuracy: 73.76
Round  85, Global train loss: 0.110, Global test loss: 1.761, Global test accuracy: 63.15
Round  86, Train loss: 0.119, Test loss: 1.205, Test accuracy: 74.13
Round  86, Global train loss: 0.119, Global test loss: 1.741, Global test accuracy: 63.64
Round  87, Train loss: 0.106, Test loss: 1.216, Test accuracy: 74.29
Round  87, Global train loss: 0.106, Global test loss: 1.741, Global test accuracy: 63.76
Round  88, Train loss: 0.110, Test loss: 1.204, Test accuracy: 74.34
Round  88, Global train loss: 0.110, Global test loss: 1.777, Global test accuracy: 63.69
Round  89, Train loss: 0.097, Test loss: 1.236, Test accuracy: 74.04
Round  89, Global train loss: 0.097, Global test loss: 1.776, Global test accuracy: 63.94
Round  90, Train loss: 0.200, Test loss: 1.218, Test accuracy: 73.99
Round  90, Global train loss: 0.200, Global test loss: 1.329, Global test accuracy: 65.87
Round  91, Train loss: 0.180, Test loss: 1.225, Test accuracy: 73.93
Round  91, Global train loss: 0.180, Global test loss: 1.309, Global test accuracy: 65.78
Round  92, Train loss: 0.169, Test loss: 1.203, Test accuracy: 74.53
Round  92, Global train loss: 0.169, Global test loss: 1.303, Global test accuracy: 66.02
Round  93, Train loss: 0.165, Test loss: 1.194, Test accuracy: 74.50
Round  93, Global train loss: 0.165, Global test loss: 1.322, Global test accuracy: 65.83
Round  94, Train loss: 0.166, Test loss: 1.238, Test accuracy: 74.24
Round  94, Global train loss: 0.166, Global test loss: 1.323, Global test accuracy: 65.80
Round  95, Train loss: 0.164, Test loss: 1.258, Test accuracy: 74.18
Round  95, Global train loss: 0.164, Global test loss: 1.315, Global test accuracy: 65.93
Round  96, Train loss: 0.160, Test loss: 1.202, Test accuracy: 74.61
Round  96, Global train loss: 0.160, Global test loss: 1.295, Global test accuracy: 65.86
Round  97, Train loss: 0.160, Test loss: 1.226, Test accuracy: 74.28
Round  97, Global train loss: 0.160, Global test loss: 1.302, Global test accuracy: 66.01
Round  98, Train loss: 0.157, Test loss: 1.223, Test accuracy: 74.77
Round  98, Global train loss: 0.157, Global test loss: 1.322, Global test accuracy: 66.50
Round  99, Train loss: 0.149, Test loss: 1.217, Test accuracy: 74.68
Round  99, Global train loss: 0.149, Global test loss: 1.331, Global test accuracy: 65.71
Final Round, Train loss: 0.119, Test loss: 1.312, Test accuracy: 74.73
Final Round, Global train loss: 0.119, Global test loss: 1.331, Global test accuracy: 65.71
Average accuracy final 10 rounds: 74.371
Average global accuracy final 10 rounds: 65.931
3956.424703836441
[2.5088260173797607, 4.720783472061157, 6.998050928115845, 9.274767637252808, 11.55500316619873, 13.866431713104248, 16.101567029953003, 18.344120979309082, 20.603383541107178, 22.84649419784546, 25.08781623840332, 27.3300678730011, 29.572722911834717, 31.823561906814575, 34.05970215797424, 36.420926570892334, 38.65757393836975, 40.90162920951843, 43.13714122772217, 45.367934465408325, 47.6067430973053, 52.09517788887024, 56.58114171028137, 61.08106780052185, 65.57753801345825, 70.07682847976685, 74.56439447402954, 79.04937410354614, 83.55339217185974, 88.0419008731842, 92.5180869102478, 97.10027265548706, 101.59359622001648, 106.12682104110718, 110.67199277877808, 115.172283411026, 119.65691256523132, 124.15138959884644, 128.64428877830505, 133.12812757492065, 137.61854529380798, 142.1069939136505, 146.59763598442078, 151.09880781173706, 155.59205389022827, 160.0841679573059, 164.58094930648804, 169.12829518318176, 173.65225434303284, 178.1724729537964, 182.7025706768036, 187.2339689731598, 191.79039764404297, 196.34512329101562, 200.89240407943726, 205.45254850387573, 210.012362241745, 214.55535864830017, 219.08477401733398, 223.60045075416565, 228.11687707901, 232.68055272102356, 237.22865176200867, 241.80527234077454, 246.31560754776, 250.83191204071045, 255.38211512565613, 259.917359828949, 264.4399802684784, 268.97368717193604, 273.48730301856995, 278.05737471580505, 282.6302499771118, 287.17919754981995, 291.71188402175903, 296.28590154647827, 300.84174036979675, 305.38854026794434, 309.9276876449585, 314.5308849811554, 319.1102132797241, 323.6783652305603, 328.2388026714325, 332.81906032562256, 337.3430244922638, 341.5021667480469, 345.6424186229706, 349.787926197052, 353.9642884731293, 358.1692225933075, 362.33037543296814, 366.5055923461914, 370.6545045375824, 374.8237974643707, 379.03301787376404, 383.1992013454437, 387.34075450897217, 391.48312640190125, 395.62644243240356, 399.82906317710876, 403.66855549812317]
[49.04, 56.53, 59.57, 61.12, 64.09, 64.94, 65.25, 65.37, 66.79, 67.98, 67.99, 68.24, 68.76, 69.04, 68.71, 68.8, 68.35, 69.18, 68.91, 69.76, 69.61, 69.65, 70.05, 70.62, 70.74, 71.01, 71.24, 71.42, 71.28, 71.61, 71.31, 71.34, 71.84, 71.54, 72.15, 72.36, 72.15, 72.6, 72.67, 72.54, 72.68, 73.18, 73.5, 74.16, 74.07, 73.17, 73.58, 73.68, 73.66, 73.41, 73.41, 73.1, 73.57, 73.58, 73.48, 73.41, 73.41, 72.76, 73.08, 73.28, 73.59, 73.32, 73.52, 73.73, 73.59, 73.85, 73.83, 74.26, 73.98, 73.63, 73.83, 74.13, 73.98, 74.24, 74.51, 74.26, 74.32, 73.97, 74.13, 73.88, 74.3, 74.57, 74.06, 74.91, 74.28, 73.76, 74.13, 74.29, 74.34, 74.04, 73.99, 73.93, 74.53, 74.5, 74.24, 74.18, 74.61, 74.28, 74.77, 74.68, 74.73]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.720, Test loss: 1.669, Test accuracy: 35.29
Round   1, Train loss: 1.365, Test loss: 1.301, Test accuracy: 45.72
Round   2, Train loss: 1.211, Test loss: 1.122, Test accuracy: 55.52
Round   3, Train loss: 1.116, Test loss: 1.063, Test accuracy: 58.37
Round   4, Train loss: 1.055, Test loss: 0.985, Test accuracy: 61.01
Round   5, Train loss: 1.001, Test loss: 0.960, Test accuracy: 61.96
Round   6, Train loss: 0.962, Test loss: 0.921, Test accuracy: 63.96
Round   7, Train loss: 0.923, Test loss: 0.890, Test accuracy: 65.42
Round   8, Train loss: 0.891, Test loss: 0.862, Test accuracy: 66.16
Round   9, Train loss: 0.857, Test loss: 0.851, Test accuracy: 67.15
Round  10, Train loss: 0.831, Test loss: 0.839, Test accuracy: 67.82
Round  11, Train loss: 0.801, Test loss: 0.824, Test accuracy: 67.82
Round  12, Train loss: 0.775, Test loss: 0.808, Test accuracy: 69.09
Round  13, Train loss: 0.750, Test loss: 0.785, Test accuracy: 70.03
Round  14, Train loss: 0.729, Test loss: 0.780, Test accuracy: 70.03
Round  15, Train loss: 0.706, Test loss: 0.776, Test accuracy: 70.14
Round  16, Train loss: 0.688, Test loss: 0.753, Test accuracy: 71.85
Round  17, Train loss: 0.663, Test loss: 0.758, Test accuracy: 71.49
Round  18, Train loss: 0.652, Test loss: 0.760, Test accuracy: 71.27
Round  19, Train loss: 0.634, Test loss: 0.750, Test accuracy: 71.80
Round  20, Train loss: 0.647, Test loss: 0.753, Test accuracy: 72.26
Round  21, Train loss: 0.635, Test loss: 0.761, Test accuracy: 72.41
Round  22, Train loss: 0.571, Test loss: 0.745, Test accuracy: 72.70
Round  23, Train loss: 0.591, Test loss: 0.748, Test accuracy: 72.88
Round  24, Train loss: 0.575, Test loss: 0.750, Test accuracy: 72.78
Round  25, Train loss: 0.611, Test loss: 0.762, Test accuracy: 72.32
Round  26, Train loss: 0.655, Test loss: 0.760, Test accuracy: 72.91
Round  27, Train loss: 0.511, Test loss: 0.758, Test accuracy: 72.72
Round  28, Train loss: 0.603, Test loss: 0.749, Test accuracy: 73.28
Round  29, Train loss: 0.549, Test loss: 0.761, Test accuracy: 73.44
Round  30, Train loss: 0.471, Test loss: 0.802, Test accuracy: 72.98
Round  31, Train loss: 0.497, Test loss: 0.769, Test accuracy: 73.38
Round  32, Train loss: 0.490, Test loss: 0.805, Test accuracy: 73.02
Round  33, Train loss: 0.438, Test loss: 0.779, Test accuracy: 73.09
Round  34, Train loss: 0.387, Test loss: 0.786, Test accuracy: 73.22
Round  35, Train loss: 0.541, Test loss: 0.782, Test accuracy: 73.17
Round  36, Train loss: 0.455, Test loss: 0.767, Test accuracy: 73.84
Round  37, Train loss: 0.453, Test loss: 0.764, Test accuracy: 74.19
Round  38, Train loss: 0.372, Test loss: 0.786, Test accuracy: 73.56
Round  39, Train loss: 0.456, Test loss: 0.754, Test accuracy: 74.20
Round  40, Train loss: 0.386, Test loss: 0.763, Test accuracy: 74.41
Round  41, Train loss: 0.458, Test loss: 0.764, Test accuracy: 74.69
Round  42, Train loss: 0.498, Test loss: 0.770, Test accuracy: 74.45
Round  43, Train loss: 0.432, Test loss: 0.784, Test accuracy: 73.97
Round  44, Train loss: 0.379, Test loss: 0.793, Test accuracy: 74.56
Round  45, Train loss: 0.366, Test loss: 0.807, Test accuracy: 74.76
Round  46, Train loss: 0.414, Test loss: 0.791, Test accuracy: 75.34
Round  47, Train loss: 0.354, Test loss: 0.801, Test accuracy: 75.03
Round  48, Train loss: 0.435, Test loss: 0.773, Test accuracy: 74.56
Round  49, Train loss: 0.326, Test loss: 0.804, Test accuracy: 74.24
Round  50, Train loss: 0.351, Test loss: 0.787, Test accuracy: 75.23
Round  51, Train loss: 0.371, Test loss: 0.806, Test accuracy: 75.07
Round  52, Train loss: 0.422, Test loss: 0.783, Test accuracy: 74.74
Round  53, Train loss: 0.325, Test loss: 0.820, Test accuracy: 74.89
Round  54, Train loss: 0.351, Test loss: 0.793, Test accuracy: 74.76
Round  55, Train loss: 0.328, Test loss: 0.789, Test accuracy: 75.23
Round  56, Train loss: 0.319, Test loss: 0.813, Test accuracy: 74.83
Round  57, Train loss: 0.345, Test loss: 0.804, Test accuracy: 74.90
Round  58, Train loss: 0.361, Test loss: 0.798, Test accuracy: 75.19
Round  59, Train loss: 0.367, Test loss: 0.804, Test accuracy: 75.02
Round  60, Train loss: 0.358, Test loss: 0.813, Test accuracy: 75.34
Round  61, Train loss: 0.326, Test loss: 0.809, Test accuracy: 75.70
Round  62, Train loss: 0.308, Test loss: 0.832, Test accuracy: 75.38
Round  63, Train loss: 0.327, Test loss: 0.813, Test accuracy: 75.82
Round  64, Train loss: 0.322, Test loss: 0.809, Test accuracy: 75.43
Round  65, Train loss: 0.368, Test loss: 0.829, Test accuracy: 75.48
Round  66, Train loss: 0.298, Test loss: 0.854, Test accuracy: 74.94
Round  67, Train loss: 0.320, Test loss: 0.846, Test accuracy: 75.42
Round  68, Train loss: 0.292, Test loss: 0.857, Test accuracy: 75.17
Round  69, Train loss: 0.339, Test loss: 0.835, Test accuracy: 74.99
Round  70, Train loss: 0.293, Test loss: 0.861, Test accuracy: 74.71
Round  71, Train loss: 0.241, Test loss: 0.871, Test accuracy: 74.76
Round  72, Train loss: 0.242, Test loss: 0.892, Test accuracy: 75.04
Round  73, Train loss: 0.340, Test loss: 0.868, Test accuracy: 75.08
Round  74, Train loss: 0.237, Test loss: 0.886, Test accuracy: 74.95
Round  75, Train loss: 0.277, Test loss: 0.903, Test accuracy: 74.68
Round  76, Train loss: 0.251, Test loss: 0.883, Test accuracy: 74.86
Round  77, Train loss: 0.281, Test loss: 0.902, Test accuracy: 75.15
Round  78, Train loss: 0.235, Test loss: 0.871, Test accuracy: 74.64
Round  79, Train loss: 0.244, Test loss: 0.888, Test accuracy: 75.12
Round  80, Train loss: 0.194, Test loss: 0.868, Test accuracy: 75.21
Round  81, Train loss: 0.198, Test loss: 0.874, Test accuracy: 75.02
Round  82, Train loss: 0.174, Test loss: 0.888, Test accuracy: 75.57
Round  83, Train loss: 0.167, Test loss: 0.933, Test accuracy: 74.85
Round  84, Train loss: 0.163, Test loss: 0.907, Test accuracy: 75.27
Round  85, Train loss: 0.155, Test loss: 0.936, Test accuracy: 75.62
Round  86, Train loss: 0.154, Test loss: 0.931, Test accuracy: 75.39
Round  87, Train loss: 0.156, Test loss: 0.937, Test accuracy: 74.99
Round  88, Train loss: 0.148, Test loss: 0.955, Test accuracy: 74.81
Round  89, Train loss: 0.136, Test loss: 0.953, Test accuracy: 75.15
Round  90, Train loss: 0.252, Test loss: 0.913, Test accuracy: 74.94
Round  91, Train loss: 0.234, Test loss: 0.914, Test accuracy: 74.96
Round  92, Train loss: 0.231, Test loss: 0.941, Test accuracy: 75.16
Round  93, Train loss: 0.223, Test loss: 0.924, Test accuracy: 75.13
Round  94, Train loss: 0.229, Test loss: 0.906, Test accuracy: 75.45
Round  95, Train loss: 0.219, Test loss: 0.904, Test accuracy: 75.48
Round  96, Train loss: 0.210, Test loss: 0.934, Test accuracy: 75.15
Round  97, Train loss: 0.219, Test loss: 0.933, Test accuracy: 75.59
Round  98, Train loss: 0.220, Test loss: 0.949, Test accuracy: 74.82
Round  99, Train loss: 0.209, Test loss: 0.904, Test accuracy: 76.00
Final Round, Train loss: 0.166, Test loss: 0.915, Test accuracy: 75.95
Average accuracy final 10 rounds: 75.268
3103.519377708435
[2.300485372543335, 4.300868988037109, 6.30872368812561, 8.30467438697815, 10.308310270309448, 12.31455945968628, 14.31843090057373, 16.317566394805908, 18.12133526802063, 19.92275595664978, 21.721723079681396, 23.519922494888306, 25.32059144973755, 27.118627548217773, 28.919577598571777, 30.719916343688965, 32.611772537231445, 34.40977501869202, 36.20408272743225, 38.002111196517944, 39.79989171028137, 42.981165170669556, 46.14286279678345, 49.304354667663574, 52.4569046497345, 55.61298894882202, 58.76640343666077, 61.918686628341675, 65.0712378025055, 68.22474980354309, 71.39124345779419, 74.55201864242554, 77.726327419281, 80.87802791595459, 84.04214763641357, 87.20921111106873, 90.37731742858887, 93.54565167427063, 96.80536699295044, 99.97729349136353, 103.14677691459656, 106.30007696151733, 109.46119976043701, 112.64601612091064, 115.8114767074585, 118.98581838607788, 122.15137720108032, 125.31691932678223, 128.48092555999756, 131.6469850540161, 134.81752562522888, 137.98098802566528, 141.14213848114014, 144.2778251171112, 147.44309258460999, 150.60636854171753, 153.76955270767212, 156.93077945709229, 160.070787191391, 163.23605847358704, 166.4059419631958, 169.56990432739258, 172.73002004623413, 175.8923671245575, 179.04949688911438, 182.2457013130188, 185.3882598876953, 188.5399284362793, 191.70051312446594, 194.84734582901, 197.97759532928467, 201.1302146911621, 204.29403018951416, 207.46089148521423, 210.63070845603943, 213.7945535182953, 216.95228576660156, 220.11126923561096, 223.26546907424927, 226.427551984787, 229.61065316200256, 232.77193427085876, 235.93730521202087, 239.09378504753113, 242.2982416152954, 245.4592158794403, 248.6886956691742, 251.84971523284912, 255.01133823394775, 258.1936218738556, 261.37263202667236, 264.5349643230438, 267.7152304649353, 270.8858196735382, 274.0924303531647, 277.28013491630554, 280.5077667236328, 283.69791865348816, 286.8774993419647, 290.0521037578583, 293.52439045906067]
[35.29, 45.72, 55.52, 58.37, 61.01, 61.96, 63.96, 65.42, 66.16, 67.15, 67.82, 67.82, 69.09, 70.03, 70.03, 70.14, 71.85, 71.49, 71.27, 71.8, 72.26, 72.41, 72.7, 72.88, 72.78, 72.32, 72.91, 72.72, 73.28, 73.44, 72.98, 73.38, 73.02, 73.09, 73.22, 73.17, 73.84, 74.19, 73.56, 74.2, 74.41, 74.69, 74.45, 73.97, 74.56, 74.76, 75.34, 75.03, 74.56, 74.24, 75.23, 75.07, 74.74, 74.89, 74.76, 75.23, 74.83, 74.9, 75.19, 75.02, 75.34, 75.7, 75.38, 75.82, 75.43, 75.48, 74.94, 75.42, 75.17, 74.99, 74.71, 74.76, 75.04, 75.08, 74.95, 74.68, 74.86, 75.15, 74.64, 75.12, 75.21, 75.02, 75.57, 74.85, 75.27, 75.62, 75.39, 74.99, 74.81, 75.15, 74.94, 74.96, 75.16, 75.13, 75.45, 75.48, 75.15, 75.59, 74.82, 76.0, 75.95]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.707, Test loss: 1.633, Test accuracy: 42.29
Round   1, Train loss: 1.322, Test loss: 1.231, Test accuracy: 50.92
Round   2, Train loss: 1.161, Test loss: 1.109, Test accuracy: 54.60
Round   3, Train loss: 1.069, Test loss: 1.013, Test accuracy: 59.71
Round   4, Train loss: 1.010, Test loss: 0.956, Test accuracy: 61.99
Round   5, Train loss: 0.960, Test loss: 0.930, Test accuracy: 62.98
Round   6, Train loss: 0.921, Test loss: 0.881, Test accuracy: 65.63
Round   7, Train loss: 0.881, Test loss: 0.856, Test accuracy: 65.74
Round   8, Train loss: 0.852, Test loss: 0.833, Test accuracy: 67.33
Round   9, Train loss: 0.816, Test loss: 0.819, Test accuracy: 67.97
Round  10, Train loss: 0.733, Test loss: 0.808, Test accuracy: 68.18
Round  11, Train loss: 0.750, Test loss: 0.822, Test accuracy: 67.54
Round  12, Train loss: 0.721, Test loss: 0.806, Test accuracy: 68.48
Round  13, Train loss: 0.838, Test loss: 0.778, Test accuracy: 69.74
Round  14, Train loss: 0.759, Test loss: 0.771, Test accuracy: 70.49
Round  15, Train loss: 0.673, Test loss: 0.764, Test accuracy: 70.47
Round  16, Train loss: 0.680, Test loss: 0.748, Test accuracy: 71.01
Round  17, Train loss: 0.714, Test loss: 0.741, Test accuracy: 71.80
Round  18, Train loss: 0.651, Test loss: 0.740, Test accuracy: 71.50
Round  19, Train loss: 0.643, Test loss: 0.739, Test accuracy: 71.44
Round  20, Train loss: 0.605, Test loss: 0.719, Test accuracy: 72.58
Round  21, Train loss: 0.600, Test loss: 0.704, Test accuracy: 73.17
Round  22, Train loss: 0.591, Test loss: 0.699, Test accuracy: 73.56
Round  23, Train loss: 0.540, Test loss: 0.705, Test accuracy: 73.43
Round  24, Train loss: 0.573, Test loss: 0.691, Test accuracy: 73.25
Round  25, Train loss: 0.543, Test loss: 0.697, Test accuracy: 73.35
Round  26, Train loss: 0.574, Test loss: 0.706, Test accuracy: 73.43
Round  27, Train loss: 0.479, Test loss: 0.678, Test accuracy: 74.65
Round  28, Train loss: 0.559, Test loss: 0.679, Test accuracy: 74.77
Round  29, Train loss: 0.488, Test loss: 0.684, Test accuracy: 74.38
Round  30, Train loss: 0.449, Test loss: 0.691, Test accuracy: 74.66
Round  31, Train loss: 0.459, Test loss: 0.691, Test accuracy: 74.49
Round  32, Train loss: 0.429, Test loss: 0.691, Test accuracy: 74.51
Round  33, Train loss: 0.461, Test loss: 0.681, Test accuracy: 74.88
Round  34, Train loss: 0.403, Test loss: 0.690, Test accuracy: 75.02
Round  35, Train loss: 0.529, Test loss: 0.678, Test accuracy: 75.17
Round  36, Train loss: 0.396, Test loss: 0.672, Test accuracy: 75.35
Round  37, Train loss: 0.474, Test loss: 0.660, Test accuracy: 75.52
Round  38, Train loss: 0.375, Test loss: 0.658, Test accuracy: 76.05
Round  39, Train loss: 0.513, Test loss: 0.649, Test accuracy: 75.90
Round  40, Train loss: 0.375, Test loss: 0.652, Test accuracy: 76.11
Round  41, Train loss: 0.472, Test loss: 0.662, Test accuracy: 76.03
Round  42, Train loss: 0.411, Test loss: 0.667, Test accuracy: 75.86
Round  43, Train loss: 0.370, Test loss: 0.671, Test accuracy: 76.23
Round  44, Train loss: 0.358, Test loss: 0.663, Test accuracy: 75.95
Round  45, Train loss: 0.312, Test loss: 0.669, Test accuracy: 76.29
Round  46, Train loss: 0.420, Test loss: 0.683, Test accuracy: 75.93
Round  47, Train loss: 0.376, Test loss: 0.673, Test accuracy: 76.31
Round  48, Train loss: 0.410, Test loss: 0.667, Test accuracy: 76.70
Round  49, Train loss: 0.304, Test loss: 0.671, Test accuracy: 76.79
Round  50, Train loss: 0.383, Test loss: 0.672, Test accuracy: 76.37
Round  51, Train loss: 0.366, Test loss: 0.674, Test accuracy: 76.87
Round  52, Train loss: 0.376, Test loss: 0.675, Test accuracy: 76.73
Round  53, Train loss: 0.297, Test loss: 0.690, Test accuracy: 76.24
Round  54, Train loss: 0.342, Test loss: 0.670, Test accuracy: 76.63
Round  55, Train loss: 0.358, Test loss: 0.669, Test accuracy: 77.13
Round  56, Train loss: 0.320, Test loss: 0.680, Test accuracy: 76.80
Round  57, Train loss: 0.299, Test loss: 0.671, Test accuracy: 77.08
Round  58, Train loss: 0.358, Test loss: 0.674, Test accuracy: 76.98
Round  59, Train loss: 0.321, Test loss: 0.693, Test accuracy: 76.75
Round  60, Train loss: 0.327, Test loss: 0.693, Test accuracy: 76.98
Round  61, Train loss: 0.290, Test loss: 0.673, Test accuracy: 77.13
Round  62, Train loss: 0.322, Test loss: 0.690, Test accuracy: 76.57
Round  63, Train loss: 0.301, Test loss: 0.688, Test accuracy: 76.94
Round  64, Train loss: 0.325, Test loss: 0.685, Test accuracy: 76.92
Round  65, Train loss: 0.324, Test loss: 0.688, Test accuracy: 77.10
Round  66, Train loss: 0.310, Test loss: 0.694, Test accuracy: 76.65
Round  67, Train loss: 0.285, Test loss: 0.707, Test accuracy: 76.36
Round  68, Train loss: 0.297, Test loss: 0.698, Test accuracy: 76.65
Round  69, Train loss: 0.286, Test loss: 0.699, Test accuracy: 76.83
Round  70, Train loss: 0.248, Test loss: 0.687, Test accuracy: 76.85
Round  71, Train loss: 0.274, Test loss: 0.711, Test accuracy: 76.67
Round  72, Train loss: 0.265, Test loss: 0.707, Test accuracy: 76.34
Round  73, Train loss: 0.302, Test loss: 0.687, Test accuracy: 77.09
Round  74, Train loss: 0.233, Test loss: 0.706, Test accuracy: 76.61
Round  75, Train loss: 0.247, Test loss: 0.709, Test accuracy: 76.86
Round  76, Train loss: 0.244, Test loss: 0.712, Test accuracy: 76.84
Round  77, Train loss: 0.253, Test loss: 0.714, Test accuracy: 76.32
Round  78, Train loss: 0.258, Test loss: 0.722, Test accuracy: 76.15
Round  79, Train loss: 0.254, Test loss: 0.721, Test accuracy: 76.24
Round  80, Train loss: 0.196, Test loss: 0.703, Test accuracy: 76.78
Round  81, Train loss: 0.189, Test loss: 0.709, Test accuracy: 76.73
Round  82, Train loss: 0.170, Test loss: 0.705, Test accuracy: 76.94
Round  83, Train loss: 0.166, Test loss: 0.711, Test accuracy: 77.04
Round  84, Train loss: 0.154, Test loss: 0.718, Test accuracy: 76.77
Round  85, Train loss: 0.150, Test loss: 0.730, Test accuracy: 76.70
Round  86, Train loss: 0.138, Test loss: 0.727, Test accuracy: 76.89
Round  87, Train loss: 0.135, Test loss: 0.728, Test accuracy: 76.90
Round  88, Train loss: 0.143, Test loss: 0.739, Test accuracy: 76.42
Round  89, Train loss: 0.126, Test loss: 0.738, Test accuracy: 76.54
Round  90, Train loss: 0.235, Test loss: 0.707, Test accuracy: 76.97
Round  91, Train loss: 0.222, Test loss: 0.717, Test accuracy: 76.63
Round  92, Train loss: 0.213, Test loss: 0.712, Test accuracy: 77.12
Round  93, Train loss: 0.207, Test loss: 0.705, Test accuracy: 77.71
Round  94, Train loss: 0.210, Test loss: 0.717, Test accuracy: 76.96
Round  95, Train loss: 0.204, Test loss: 0.723, Test accuracy: 76.94
Round  96, Train loss: 0.206, Test loss: 0.725, Test accuracy: 76.95
Round  97, Train loss: 0.201, Test loss: 0.721, Test accuracy: 77.32
Round  98, Train loss: 0.199, Test loss: 0.733, Test accuracy: 77.01
Round  99, Train loss: 0.198, Test loss: 0.726, Test accuracy: 77.24
Final Round, Train loss: 0.167, Test loss: 0.727, Test accuracy: 77.68
Average accuracy final 10 rounds: 77.085
3361.7427401542664
[2.89229154586792, 5.37873649597168, 7.646135091781616, 9.911632061004639, 12.166932106018066, 14.428759813308716, 16.69281315803528, 18.953391790390015, 21.214657306671143, 23.470301628112793, 25.727035999298096, 27.988048553466797, 30.24975609779358, 32.50176525115967, 34.762890577316284, 37.027992248535156, 39.291927099227905, 41.55358076095581, 43.81294107437134, 46.09547281265259, 48.37705874443054, 52.16904258728027, 55.963667154312134, 59.70238208770752, 63.48173642158508, 67.26243305206299, 71.02833580970764, 74.80650568008423, 78.55232572555542, 82.28850436210632, 86.0776252746582, 89.85626649856567, 93.63522982597351, 97.51050591468811, 101.30920028686523, 105.09715604782104, 108.88578677177429, 112.67513418197632, 116.46532940864563, 120.25965738296509, 124.05874443054199, 127.85225892066956, 131.6404790878296, 135.44262146949768, 139.23732495307922, 143.0346326828003, 146.83510613441467, 150.6277060508728, 154.36723947525024, 158.11262726783752, 161.86240434646606, 165.6150152683258, 169.36430048942566, 173.11096572875977, 176.85510087013245, 180.59554386138916, 184.34222555160522, 188.15072178840637, 191.8987832069397, 195.64125156402588, 199.37931609153748, 203.12331533432007, 206.86788415908813, 210.6160032749176, 214.36207628250122, 218.15910625457764, 221.95712661743164, 225.73476839065552, 229.4875099658966, 233.23385286331177, 236.98319792747498, 240.73753786087036, 244.4892861843109, 248.24903082847595, 252.01577520370483, 255.7453510761261, 259.5734896659851, 263.33014130592346, 267.0943670272827, 270.84726190567017, 274.6404812335968, 278.43619775772095, 282.2260513305664, 286.0183365345001, 289.80916261672974, 293.60243010520935, 297.39963936805725, 301.19386529922485, 304.9896881580353, 308.78832626342773, 312.65127515792847, 316.4488060474396, 320.2433452606201, 324.04285645484924, 327.84077429771423, 331.63448333740234, 335.4290542602539, 339.22636914253235, 343.0877904891968, 346.87803888320923, 350.6373755931854]
[42.29, 50.92, 54.6, 59.71, 61.99, 62.98, 65.63, 65.74, 67.33, 67.97, 68.18, 67.54, 68.48, 69.74, 70.49, 70.47, 71.01, 71.8, 71.5, 71.44, 72.58, 73.17, 73.56, 73.43, 73.25, 73.35, 73.43, 74.65, 74.77, 74.38, 74.66, 74.49, 74.51, 74.88, 75.02, 75.17, 75.35, 75.52, 76.05, 75.9, 76.11, 76.03, 75.86, 76.23, 75.95, 76.29, 75.93, 76.31, 76.7, 76.79, 76.37, 76.87, 76.73, 76.24, 76.63, 77.13, 76.8, 77.08, 76.98, 76.75, 76.98, 77.13, 76.57, 76.94, 76.92, 77.1, 76.65, 76.36, 76.65, 76.83, 76.85, 76.67, 76.34, 77.09, 76.61, 76.86, 76.84, 76.32, 76.15, 76.24, 76.78, 76.73, 76.94, 77.04, 76.77, 76.7, 76.89, 76.9, 76.42, 76.54, 76.97, 76.63, 77.12, 77.71, 76.96, 76.94, 76.95, 77.32, 77.01, 77.24, 77.68]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.679, Test loss: 2.036, Test accuracy: 25.35
Round   0, Global train loss: 1.679, Global test loss: 2.186, Global test accuracy: 24.08
Round   1, Train loss: 1.436, Test loss: 1.832, Test accuracy: 30.03
Round   1, Global train loss: 1.436, Global test loss: 2.159, Global test accuracy: 24.15
Round   2, Train loss: 1.422, Test loss: 1.591, Test accuracy: 36.70
Round   2, Global train loss: 1.422, Global test loss: 1.962, Global test accuracy: 29.49
Round   3, Train loss: 1.473, Test loss: 1.555, Test accuracy: 37.52
Round   3, Global train loss: 1.473, Global test loss: 2.012, Global test accuracy: 29.37
Round   4, Train loss: 1.476, Test loss: 1.433, Test accuracy: 40.76
Round   4, Global train loss: 1.476, Global test loss: 2.003, Global test accuracy: 28.15
Round   5, Train loss: 1.270, Test loss: 1.401, Test accuracy: 41.85
Round   5, Global train loss: 1.270, Global test loss: 1.939, Global test accuracy: 34.07
Round   6, Train loss: 1.351, Test loss: 1.397, Test accuracy: 43.16
Round   6, Global train loss: 1.351, Global test loss: 2.094, Global test accuracy: 24.36
Round   7, Train loss: 1.241, Test loss: 1.422, Test accuracy: 43.12
Round   7, Global train loss: 1.241, Global test loss: 2.068, Global test accuracy: 27.14
Round   8, Train loss: 1.192, Test loss: 1.379, Test accuracy: 44.33
Round   8, Global train loss: 1.192, Global test loss: 1.908, Global test accuracy: 31.72
Round   9, Train loss: 1.220, Test loss: 1.343, Test accuracy: 45.76
Round   9, Global train loss: 1.220, Global test loss: 2.080, Global test accuracy: 25.36
Round  10, Train loss: 1.253, Test loss: 1.312, Test accuracy: 46.19
Round  10, Global train loss: 1.253, Global test loss: 1.898, Global test accuracy: 32.89
Round  11, Train loss: 1.156, Test loss: 1.322, Test accuracy: 47.72
Round  11, Global train loss: 1.156, Global test loss: 2.038, Global test accuracy: 30.59
Round  12, Train loss: 1.032, Test loss: 1.254, Test accuracy: 49.52
Round  12, Global train loss: 1.032, Global test loss: 1.949, Global test accuracy: 31.30
Round  13, Train loss: 1.092, Test loss: 1.233, Test accuracy: 50.29
Round  13, Global train loss: 1.092, Global test loss: 1.908, Global test accuracy: 31.33
Round  14, Train loss: 1.151, Test loss: 1.223, Test accuracy: 50.80
Round  14, Global train loss: 1.151, Global test loss: 1.931, Global test accuracy: 28.41
Round  15, Train loss: 1.211, Test loss: 1.207, Test accuracy: 52.07
Round  15, Global train loss: 1.211, Global test loss: 1.961, Global test accuracy: 29.30
Round  16, Train loss: 0.960, Test loss: 1.232, Test accuracy: 51.32
Round  16, Global train loss: 0.960, Global test loss: 1.852, Global test accuracy: 32.11
Round  17, Train loss: 1.174, Test loss: 1.246, Test accuracy: 50.29
Round  17, Global train loss: 1.174, Global test loss: 1.973, Global test accuracy: 29.25
Round  18, Train loss: 0.971, Test loss: 1.241, Test accuracy: 51.03
Round  18, Global train loss: 0.971, Global test loss: 2.003, Global test accuracy: 27.82
Round  19, Train loss: 0.967, Test loss: 1.241, Test accuracy: 51.18
Round  19, Global train loss: 0.967, Global test loss: 2.092, Global test accuracy: 23.13
Round  20, Train loss: 1.054, Test loss: 1.228, Test accuracy: 52.04
Round  20, Global train loss: 1.054, Global test loss: 2.042, Global test accuracy: 30.14
Round  21, Train loss: 0.855, Test loss: 1.235, Test accuracy: 51.90
Round  21, Global train loss: 0.855, Global test loss: 1.881, Global test accuracy: 31.88
Round  22, Train loss: 1.184, Test loss: 1.253, Test accuracy: 51.05
Round  22, Global train loss: 1.184, Global test loss: 1.971, Global test accuracy: 30.58
Round  23, Train loss: 0.860, Test loss: 1.261, Test accuracy: 51.37
Round  23, Global train loss: 0.860, Global test loss: 1.976, Global test accuracy: 29.88
Round  24, Train loss: 1.063, Test loss: 1.272, Test accuracy: 51.07
Round  24, Global train loss: 1.063, Global test loss: 1.989, Global test accuracy: 30.47
Round  25, Train loss: 1.027, Test loss: 1.282, Test accuracy: 51.31
Round  25, Global train loss: 1.027, Global test loss: 1.922, Global test accuracy: 30.30
Round  26, Train loss: 0.797, Test loss: 1.297, Test accuracy: 51.37
Round  26, Global train loss: 0.797, Global test loss: 1.918, Global test accuracy: 32.83
Round  27, Train loss: 1.023, Test loss: 1.295, Test accuracy: 51.74
Round  27, Global train loss: 1.023, Global test loss: 2.010, Global test accuracy: 27.88
Round  28, Train loss: 0.874, Test loss: 1.307, Test accuracy: 52.04
Round  28, Global train loss: 0.874, Global test loss: 1.908, Global test accuracy: 36.16
Round  29, Train loss: 0.642, Test loss: 1.317, Test accuracy: 51.88
Round  29, Global train loss: 0.642, Global test loss: 1.999, Global test accuracy: 29.86
Round  30, Train loss: 1.031, Test loss: 1.331, Test accuracy: 52.03
Round  30, Global train loss: 1.031, Global test loss: 2.092, Global test accuracy: 31.95
Round  31, Train loss: 0.701, Test loss: 1.356, Test accuracy: 51.78
Round  31, Global train loss: 0.701, Global test loss: 1.871, Global test accuracy: 34.44
Round  32, Train loss: 0.725, Test loss: 1.353, Test accuracy: 52.50
Round  32, Global train loss: 0.725, Global test loss: 1.951, Global test accuracy: 31.54
Round  33, Train loss: 0.880, Test loss: 1.393, Test accuracy: 51.90
Round  33, Global train loss: 0.880, Global test loss: 1.947, Global test accuracy: 29.39
Round  34, Train loss: 0.748, Test loss: 1.411, Test accuracy: 52.07
Round  34, Global train loss: 0.748, Global test loss: 1.894, Global test accuracy: 35.02
Round  35, Train loss: 0.807, Test loss: 1.428, Test accuracy: 51.96
Round  35, Global train loss: 0.807, Global test loss: 1.870, Global test accuracy: 27.14
Round  36, Train loss: 0.861, Test loss: 1.429, Test accuracy: 52.14
Round  36, Global train loss: 0.861, Global test loss: 1.947, Global test accuracy: 31.70
Round  37, Train loss: 0.724, Test loss: 1.447, Test accuracy: 52.19
Round  37, Global train loss: 0.724, Global test loss: 1.906, Global test accuracy: 32.27
Round  38, Train loss: 0.663, Test loss: 1.494, Test accuracy: 51.60
Round  38, Global train loss: 0.663, Global test loss: 1.927, Global test accuracy: 34.28
Round  39, Train loss: 0.528, Test loss: 1.512, Test accuracy: 51.65
Round  39, Global train loss: 0.528, Global test loss: 1.976, Global test accuracy: 32.64
Round  40, Train loss: 0.481, Test loss: 1.513, Test accuracy: 52.15
Round  40, Global train loss: 0.481, Global test loss: 1.929, Global test accuracy: 30.37
Round  41, Train loss: 0.702, Test loss: 1.517, Test accuracy: 52.16
Round  41, Global train loss: 0.702, Global test loss: 1.902, Global test accuracy: 31.85
Round  42, Train loss: 0.516, Test loss: 1.567, Test accuracy: 52.06
Round  42, Global train loss: 0.516, Global test loss: 1.969, Global test accuracy: 29.62
Round  43, Train loss: 0.539, Test loss: 1.575, Test accuracy: 51.93
Round  43, Global train loss: 0.539, Global test loss: 1.843, Global test accuracy: 35.61
Round  44, Train loss: 0.564, Test loss: 1.584, Test accuracy: 52.27
Round  44, Global train loss: 0.564, Global test loss: 1.933, Global test accuracy: 32.10
Round  45, Train loss: 0.734, Test loss: 1.610, Test accuracy: 52.39
Round  45, Global train loss: 0.734, Global test loss: 1.881, Global test accuracy: 32.87
Round  46, Train loss: 0.460, Test loss: 1.626, Test accuracy: 52.19
Round  46, Global train loss: 0.460, Global test loss: 1.905, Global test accuracy: 35.38
Round  47, Train loss: 0.374, Test loss: 1.624, Test accuracy: 52.63
Round  47, Global train loss: 0.374, Global test loss: 1.946, Global test accuracy: 33.11
Round  48, Train loss: 0.659, Test loss: 1.660, Test accuracy: 53.01
Round  48, Global train loss: 0.659, Global test loss: 1.984, Global test accuracy: 27.95
Round  49, Train loss: 0.697, Test loss: 1.706, Test accuracy: 52.63
Round  49, Global train loss: 0.697, Global test loss: 1.914, Global test accuracy: 33.18
Round  50, Train loss: 0.617, Test loss: 1.774, Test accuracy: 51.98
Round  50, Global train loss: 0.617, Global test loss: 2.020, Global test accuracy: 32.05
Round  51, Train loss: 0.376, Test loss: 1.816, Test accuracy: 51.94
Round  51, Global train loss: 0.376, Global test loss: 1.975, Global test accuracy: 33.63
Round  52, Train loss: 0.467, Test loss: 1.808, Test accuracy: 52.23
Round  52, Global train loss: 0.467, Global test loss: 1.962, Global test accuracy: 33.18
Round  53, Train loss: 0.378, Test loss: 1.798, Test accuracy: 52.53
Round  53, Global train loss: 0.378, Global test loss: 1.925, Global test accuracy: 34.16
Round  54, Train loss: 0.453, Test loss: 1.860, Test accuracy: 52.15
Round  54, Global train loss: 0.453, Global test loss: 1.926, Global test accuracy: 32.63
Round  55, Train loss: 0.349, Test loss: 1.876, Test accuracy: 51.85
Round  55, Global train loss: 0.349, Global test loss: 2.029, Global test accuracy: 30.38
Round  56, Train loss: 0.450, Test loss: 1.892, Test accuracy: 52.03
Round  56, Global train loss: 0.450, Global test loss: 1.970, Global test accuracy: 32.94
Round  57, Train loss: 0.376, Test loss: 1.938, Test accuracy: 52.46
Round  57, Global train loss: 0.376, Global test loss: 2.063, Global test accuracy: 24.80
Round  58, Train loss: 0.338, Test loss: 1.934, Test accuracy: 52.97
Round  58, Global train loss: 0.338, Global test loss: 2.097, Global test accuracy: 28.01
Round  59, Train loss: 0.505, Test loss: 1.963, Test accuracy: 52.67
Round  59, Global train loss: 0.505, Global test loss: 1.923, Global test accuracy: 30.54
Round  60, Train loss: 0.510, Test loss: 1.985, Test accuracy: 52.28
Round  60, Global train loss: 0.510, Global test loss: 1.910, Global test accuracy: 32.09
Round  61, Train loss: 0.506, Test loss: 1.994, Test accuracy: 52.95
Round  61, Global train loss: 0.506, Global test loss: 2.009, Global test accuracy: 26.19
Round  62, Train loss: 0.401, Test loss: 2.007, Test accuracy: 52.89
Round  62, Global train loss: 0.401, Global test loss: 1.835, Global test accuracy: 34.99
Round  63, Train loss: 0.246, Test loss: 2.059, Test accuracy: 52.40
Round  63, Global train loss: 0.246, Global test loss: 1.923, Global test accuracy: 30.77
Round  64, Train loss: 0.371, Test loss: 2.086, Test accuracy: 52.06
Round  64, Global train loss: 0.371, Global test loss: 1.914, Global test accuracy: 33.55
Round  65, Train loss: 0.266, Test loss: 2.152, Test accuracy: 52.01
Round  65, Global train loss: 0.266, Global test loss: 1.937, Global test accuracy: 30.89
Round  66, Train loss: 0.426, Test loss: 2.192, Test accuracy: 51.71
Round  66, Global train loss: 0.426, Global test loss: 2.036, Global test accuracy: 29.75
Round  67, Train loss: 0.245, Test loss: 2.191, Test accuracy: 51.75
Round  67, Global train loss: 0.245, Global test loss: 1.927, Global test accuracy: 33.21
Round  68, Train loss: 0.397, Test loss: 2.226, Test accuracy: 51.67
Round  68, Global train loss: 0.397, Global test loss: 2.037, Global test accuracy: 29.64
Round  69, Train loss: 0.271, Test loss: 2.256, Test accuracy: 51.31
Round  69, Global train loss: 0.271, Global test loss: 2.164, Global test accuracy: 32.26
Round  70, Train loss: 0.305, Test loss: 2.258, Test accuracy: 52.27
Round  70, Global train loss: 0.305, Global test loss: 1.954, Global test accuracy: 31.51
Round  71, Train loss: 0.250, Test loss: 2.241, Test accuracy: 53.03
Round  71, Global train loss: 0.250, Global test loss: 1.955, Global test accuracy: 31.64
Round  72, Train loss: 0.306, Test loss: 2.265, Test accuracy: 52.61
Round  72, Global train loss: 0.306, Global test loss: 2.072, Global test accuracy: 26.46
Round  73, Train loss: 0.245, Test loss: 2.318, Test accuracy: 52.41
Round  73, Global train loss: 0.245, Global test loss: 2.096, Global test accuracy: 32.04
Round  74, Train loss: 0.321, Test loss: 2.311, Test accuracy: 52.61
Round  74, Global train loss: 0.321, Global test loss: 2.013, Global test accuracy: 29.90
Round  75, Train loss: 0.197, Test loss: 2.355, Test accuracy: 52.58
Round  75, Global train loss: 0.197, Global test loss: 2.128, Global test accuracy: 29.51
Round  76, Train loss: 0.244, Test loss: 2.414, Test accuracy: 52.13
Round  76, Global train loss: 0.244, Global test loss: 1.803, Global test accuracy: 36.89
Round  77, Train loss: 0.187, Test loss: 2.481, Test accuracy: 51.64
Round  77, Global train loss: 0.187, Global test loss: 1.882, Global test accuracy: 33.16
Round  78, Train loss: 0.230, Test loss: 2.439, Test accuracy: 52.30
Round  78, Global train loss: 0.230, Global test loss: 2.169, Global test accuracy: 26.83
Round  79, Train loss: 0.199, Test loss: 2.408, Test accuracy: 52.54
Round  79, Global train loss: 0.199, Global test loss: 1.861, Global test accuracy: 34.08
Round  80, Train loss: 0.236, Test loss: 2.444, Test accuracy: 52.73
Round  80, Global train loss: 0.236, Global test loss: 1.859, Global test accuracy: 30.04
Round  81, Train loss: 0.227, Test loss: 2.445, Test accuracy: 52.44
Round  81, Global train loss: 0.227, Global test loss: 1.841, Global test accuracy: 35.32
Round  82, Train loss: 0.196, Test loss: 2.479, Test accuracy: 52.60
Round  82, Global train loss: 0.196, Global test loss: 2.080, Global test accuracy: 28.94
Round  83, Train loss: 0.162, Test loss: 2.524, Test accuracy: 52.59
Round  83, Global train loss: 0.162, Global test loss: 2.349, Global test accuracy: 22.68
Round  84, Train loss: 0.205, Test loss: 2.548, Test accuracy: 52.16
Round  84, Global train loss: 0.205, Global test loss: 1.956, Global test accuracy: 34.72
Round  85, Train loss: 0.262, Test loss: 2.551, Test accuracy: 52.46
Round  85, Global train loss: 0.262, Global test loss: 2.017, Global test accuracy: 28.09
Round  86, Train loss: 0.186, Test loss: 2.619, Test accuracy: 52.36
Round  86, Global train loss: 0.186, Global test loss: 2.066, Global test accuracy: 28.11
Round  87, Train loss: 0.240, Test loss: 2.627, Test accuracy: 52.62
Round  87, Global train loss: 0.240, Global test loss: 1.913, Global test accuracy: 32.22
Round  88, Train loss: 0.167, Test loss: 2.647, Test accuracy: 52.70
Round  88, Global train loss: 0.167, Global test loss: 2.060, Global test accuracy: 23.71
Round  89, Train loss: 0.148, Test loss: 2.614, Test accuracy: 52.96
Round  89, Global train loss: 0.148, Global test loss: 1.946, Global test accuracy: 32.99
Round  90, Train loss: 0.231, Test loss: 2.680, Test accuracy: 53.19
Round  90, Global train loss: 0.231, Global test loss: 2.068, Global test accuracy: 27.62
Round  91, Train loss: 0.142, Test loss: 2.718, Test accuracy: 53.37
Round  91, Global train loss: 0.142, Global test loss: 2.178, Global test accuracy: 22.97
Round  92, Train loss: 0.179, Test loss: 2.813, Test accuracy: 53.02
Round  92, Global train loss: 0.179, Global test loss: 1.852, Global test accuracy: 36.82
Round  93, Train loss: 0.241, Test loss: 2.736, Test accuracy: 53.06
Round  93, Global train loss: 0.241, Global test loss: 1.952, Global test accuracy: 30.02
Round  94, Train loss: 0.155, Test loss: 2.708, Test accuracy: 52.95
Round  94, Global train loss: 0.155, Global test loss: 1.878, Global test accuracy: 36.26
Round  95, Train loss: 0.171, Test loss: 2.790, Test accuracy: 52.83
Round  95, Global train loss: 0.171, Global test loss: 2.068, Global test accuracy: 21.96
Round  96, Train loss: 0.216, Test loss: 2.782, Test accuracy: 52.86
Round  96, Global train loss: 0.216, Global test loss: 1.925, Global test accuracy: 33.31
Round  97, Train loss: 0.159, Test loss: 2.861, Test accuracy: 52.83
Round  97, Global train loss: 0.159, Global test loss: 1.949, Global test accuracy: 29.09
Round  98, Train loss: 0.179, Test loss: 2.869, Test accuracy: 52.82
Round  98, Global train loss: 0.179, Global test loss: 1.898, Global test accuracy: 33.09
Round  99, Train loss: 0.143, Test loss: 2.851, Test accuracy: 52.40
Round  99, Global train loss: 0.143, Global test loss: 2.080, Global test accuracy: 25.82
Final Round, Train loss: 0.145, Test loss: 2.857, Test accuracy: 53.44
Final Round, Global train loss: 0.145, Global test loss: 2.080, Global test accuracy: 25.82
Average accuracy final 10 rounds: 52.933 

Average global accuracy final 10 rounds: 29.695999999999998 

1290.3737626075745
[1.396416425704956, 2.792832851409912, 3.917593479156494, 5.042354106903076, 6.173656463623047, 7.304958820343018, 8.42858624458313, 9.552213668823242, 10.682116031646729, 11.812018394470215, 12.947172403335571, 14.082326412200928, 15.217801094055176, 16.353275775909424, 17.488439083099365, 18.623602390289307, 19.758570909500122, 20.893539428710938, 22.032238960266113, 23.17093849182129, 24.30250835418701, 25.434078216552734, 26.564350843429565, 27.694623470306396, 28.824500560760498, 29.9543776512146, 31.07969331741333, 32.20500898361206, 33.326322078704834, 34.44763517379761, 35.574915647506714, 36.70219612121582, 37.82499098777771, 38.9477858543396, 40.07342457771301, 41.199063301086426, 42.313660860061646, 43.428258419036865, 44.438753843307495, 45.449249267578125, 46.41519522666931, 47.3811411857605, 48.346497774124146, 49.31185436248779, 50.28010821342468, 51.24836206436157, 52.20908045768738, 53.169798851013184, 54.12911677360535, 55.08843469619751, 56.054818630218506, 57.0212025642395, 57.98139452934265, 58.9415864944458, 59.90017080307007, 60.858755111694336, 61.82059144973755, 62.78242778778076, 63.74415612220764, 64.70588445663452, 65.677663564682, 66.64944267272949, 67.6204903125763, 68.5915379524231, 69.55429935455322, 70.51706075668335, 71.48975563049316, 72.46245050430298, 73.43466329574585, 74.40687608718872, 75.3733320236206, 76.33978796005249, 77.30876636505127, 78.27774477005005, 79.24957346916199, 80.22140216827393, 81.19068932533264, 82.15997648239136, 83.12916231155396, 84.09834814071655, 85.06813383102417, 86.03791952133179, 87.00971746444702, 87.98151540756226, 88.95228815078735, 89.92306089401245, 90.89673066139221, 91.87040042877197, 92.84521341323853, 93.82002639770508, 94.78722286224365, 95.75441932678223, 96.71950769424438, 97.68459606170654, 98.65662813186646, 99.62866020202637, 100.59937405586243, 101.57008790969849, 102.54084062576294, 103.51159334182739, 104.48493480682373, 105.45827627182007, 106.42816758155823, 107.39805889129639, 108.36775779724121, 109.33745670318604, 110.3024833202362, 111.26750993728638, 112.23688793182373, 113.20626592636108, 114.17042469978333, 115.13458347320557, 116.10193276405334, 117.06928205490112, 118.0344226360321, 118.99956321716309, 119.9644284248352, 120.92929363250732, 121.89235663414001, 122.8554196357727, 123.81655597686768, 124.77769231796265, 125.74741768836975, 126.71714305877686, 127.68933582305908, 128.6615285873413, 129.62858176231384, 130.59563493728638, 131.5621781349182, 132.52872133255005, 133.4967291355133, 134.46473693847656, 135.43025064468384, 136.3957643508911, 137.36582136154175, 138.33587837219238, 139.29606246948242, 140.25624656677246, 141.22556066513062, 142.19487476348877, 143.16299390792847, 144.13111305236816, 145.09494853019714, 146.05878400802612, 147.02698135375977, 147.9951786994934, 148.96111011505127, 149.92704153060913, 150.89743852615356, 151.867835521698, 152.84038281440735, 153.8129301071167, 154.7812581062317, 155.74958610534668, 156.7186164855957, 157.68764686584473, 158.655992269516, 159.62433767318726, 160.59446573257446, 161.56459379196167, 162.53255581855774, 163.5005178451538, 164.46874618530273, 165.43697452545166, 166.40376615524292, 167.37055778503418, 168.33620762825012, 169.30185747146606, 170.27030491828918, 171.2387523651123, 172.20019102096558, 173.16162967681885, 174.13665866851807, 175.11168766021729, 176.07472681999207, 177.03776597976685, 178.0038824081421, 178.96999883651733, 179.94499492645264, 180.91999101638794, 181.88834762573242, 182.8567042350769, 183.8267114162445, 184.7967185974121, 185.75975799560547, 186.72279739379883, 187.68500113487244, 188.64720487594604, 189.6150941848755, 190.58298349380493, 191.55445218086243, 192.52592086791992, 193.49454617500305, 194.46317148208618, 195.4377143383026, 196.41225719451904, 197.37648272514343, 198.34070825576782, 199.31484699249268, 200.28898572921753, 202.23055458068848, 204.17212343215942]
[25.35, 25.35, 30.03, 30.03, 36.7, 36.7, 37.52, 37.52, 40.76, 40.76, 41.85, 41.85, 43.16, 43.16, 43.12, 43.12, 44.33, 44.33, 45.76, 45.76, 46.19, 46.19, 47.72, 47.72, 49.52, 49.52, 50.29, 50.29, 50.8, 50.8, 52.07, 52.07, 51.32, 51.32, 50.29, 50.29, 51.03, 51.03, 51.18, 51.18, 52.04, 52.04, 51.9, 51.9, 51.05, 51.05, 51.37, 51.37, 51.07, 51.07, 51.31, 51.31, 51.37, 51.37, 51.74, 51.74, 52.04, 52.04, 51.88, 51.88, 52.03, 52.03, 51.78, 51.78, 52.5, 52.5, 51.9, 51.9, 52.07, 52.07, 51.96, 51.96, 52.14, 52.14, 52.19, 52.19, 51.6, 51.6, 51.65, 51.65, 52.15, 52.15, 52.16, 52.16, 52.06, 52.06, 51.93, 51.93, 52.27, 52.27, 52.39, 52.39, 52.19, 52.19, 52.63, 52.63, 53.01, 53.01, 52.63, 52.63, 51.98, 51.98, 51.94, 51.94, 52.23, 52.23, 52.53, 52.53, 52.15, 52.15, 51.85, 51.85, 52.03, 52.03, 52.46, 52.46, 52.97, 52.97, 52.67, 52.67, 52.28, 52.28, 52.95, 52.95, 52.89, 52.89, 52.4, 52.4, 52.06, 52.06, 52.01, 52.01, 51.71, 51.71, 51.75, 51.75, 51.67, 51.67, 51.31, 51.31, 52.27, 52.27, 53.03, 53.03, 52.61, 52.61, 52.41, 52.41, 52.61, 52.61, 52.58, 52.58, 52.13, 52.13, 51.64, 51.64, 52.3, 52.3, 52.54, 52.54, 52.73, 52.73, 52.44, 52.44, 52.6, 52.6, 52.59, 52.59, 52.16, 52.16, 52.46, 52.46, 52.36, 52.36, 52.62, 52.62, 52.7, 52.7, 52.96, 52.96, 53.19, 53.19, 53.37, 53.37, 53.02, 53.02, 53.06, 53.06, 52.95, 52.95, 52.83, 52.83, 52.86, 52.86, 52.83, 52.83, 52.82, 52.82, 52.4, 52.4, 53.44, 53.44]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.625, Test loss: 2.063, Test accuracy: 26.18
Round   0, Global train loss: 1.625, Global test loss: 2.254, Global test accuracy: 22.75
Round   1, Train loss: 1.471, Test loss: 1.874, Test accuracy: 30.27
Round   1, Global train loss: 1.471, Global test loss: 2.263, Global test accuracy: 22.82
Round   2, Train loss: 1.409, Test loss: 1.566, Test accuracy: 37.59
Round   2, Global train loss: 1.409, Global test loss: 2.018, Global test accuracy: 28.46
Round   3, Train loss: 1.308, Test loss: 1.491, Test accuracy: 42.02
Round   3, Global train loss: 1.308, Global test loss: 1.965, Global test accuracy: 33.00
Round   4, Train loss: 1.217, Test loss: 1.338, Test accuracy: 47.26
Round   4, Global train loss: 1.217, Global test loss: 1.878, Global test accuracy: 35.80
Round   5, Train loss: 1.223, Test loss: 1.217, Test accuracy: 50.82
Round   5, Global train loss: 1.223, Global test loss: 1.667, Global test accuracy: 41.03
Round   6, Train loss: 1.178, Test loss: 1.209, Test accuracy: 52.22
Round   6, Global train loss: 1.178, Global test loss: 1.911, Global test accuracy: 32.53
Round   7, Train loss: 1.052, Test loss: 1.204, Test accuracy: 51.65
Round   7, Global train loss: 1.052, Global test loss: 1.757, Global test accuracy: 32.84
Round   8, Train loss: 1.128, Test loss: 1.155, Test accuracy: 54.93
Round   8, Global train loss: 1.128, Global test loss: 1.620, Global test accuracy: 43.48
Round   9, Train loss: 1.172, Test loss: 1.134, Test accuracy: 55.48
Round   9, Global train loss: 1.172, Global test loss: 1.707, Global test accuracy: 40.98
Round  10, Train loss: 1.096, Test loss: 1.086, Test accuracy: 56.91
Round  10, Global train loss: 1.096, Global test loss: 1.464, Global test accuracy: 47.13
Round  11, Train loss: 1.086, Test loss: 1.081, Test accuracy: 57.62
Round  11, Global train loss: 1.086, Global test loss: 1.593, Global test accuracy: 41.84
Round  12, Train loss: 0.952, Test loss: 1.031, Test accuracy: 58.78
Round  12, Global train loss: 0.952, Global test loss: 1.525, Global test accuracy: 45.86
Round  13, Train loss: 0.908, Test loss: 1.014, Test accuracy: 60.13
Round  13, Global train loss: 0.908, Global test loss: 1.602, Global test accuracy: 44.34
Round  14, Train loss: 0.976, Test loss: 0.996, Test accuracy: 61.54
Round  14, Global train loss: 0.976, Global test loss: 1.464, Global test accuracy: 46.83
Round  15, Train loss: 0.967, Test loss: 0.979, Test accuracy: 62.20
Round  15, Global train loss: 0.967, Global test loss: 1.574, Global test accuracy: 43.70
Round  16, Train loss: 0.831, Test loss: 0.969, Test accuracy: 62.39
Round  16, Global train loss: 0.831, Global test loss: 1.345, Global test accuracy: 50.75
Round  17, Train loss: 0.963, Test loss: 0.964, Test accuracy: 62.47
Round  17, Global train loss: 0.963, Global test loss: 1.416, Global test accuracy: 50.17
Round  18, Train loss: 0.810, Test loss: 0.959, Test accuracy: 63.06
Round  18, Global train loss: 0.810, Global test loss: 1.401, Global test accuracy: 49.90
Round  19, Train loss: 0.850, Test loss: 0.965, Test accuracy: 63.25
Round  19, Global train loss: 0.850, Global test loss: 1.455, Global test accuracy: 49.69
Round  20, Train loss: 0.818, Test loss: 0.959, Test accuracy: 63.57
Round  20, Global train loss: 0.818, Global test loss: 1.562, Global test accuracy: 46.76
Round  21, Train loss: 0.865, Test loss: 0.966, Test accuracy: 63.46
Round  21, Global train loss: 0.865, Global test loss: 1.408, Global test accuracy: 49.01
Round  22, Train loss: 0.842, Test loss: 0.963, Test accuracy: 63.81
Round  22, Global train loss: 0.842, Global test loss: 1.398, Global test accuracy: 49.99
Round  23, Train loss: 0.789, Test loss: 0.948, Test accuracy: 64.65
Round  23, Global train loss: 0.789, Global test loss: 1.511, Global test accuracy: 49.26
Round  24, Train loss: 0.808, Test loss: 0.924, Test accuracy: 65.45
Round  24, Global train loss: 0.808, Global test loss: 1.526, Global test accuracy: 47.23
Round  25, Train loss: 0.873, Test loss: 0.916, Test accuracy: 65.80
Round  25, Global train loss: 0.873, Global test loss: 1.258, Global test accuracy: 56.27
Round  26, Train loss: 0.782, Test loss: 0.894, Test accuracy: 66.88
Round  26, Global train loss: 0.782, Global test loss: 1.298, Global test accuracy: 54.29
Round  27, Train loss: 0.775, Test loss: 0.896, Test accuracy: 66.71
Round  27, Global train loss: 0.775, Global test loss: 1.385, Global test accuracy: 52.75
Round  28, Train loss: 0.761, Test loss: 0.905, Test accuracy: 66.61
Round  28, Global train loss: 0.761, Global test loss: 1.256, Global test accuracy: 56.11
Round  29, Train loss: 0.828, Test loss: 0.895, Test accuracy: 67.14
Round  29, Global train loss: 0.828, Global test loss: 1.297, Global test accuracy: 54.84
Round  30, Train loss: 0.635, Test loss: 0.899, Test accuracy: 67.55
Round  30, Global train loss: 0.635, Global test loss: 1.607, Global test accuracy: 47.72
Round  31, Train loss: 0.760, Test loss: 0.895, Test accuracy: 67.52
Round  31, Global train loss: 0.760, Global test loss: 1.177, Global test accuracy: 58.59
Round  32, Train loss: 0.754, Test loss: 0.901, Test accuracy: 67.65
Round  32, Global train loss: 0.754, Global test loss: 1.282, Global test accuracy: 56.18
Round  33, Train loss: 0.776, Test loss: 0.896, Test accuracy: 67.71
Round  33, Global train loss: 0.776, Global test loss: 1.228, Global test accuracy: 57.97
Round  34, Train loss: 0.657, Test loss: 0.906, Test accuracy: 67.58
Round  34, Global train loss: 0.657, Global test loss: 1.223, Global test accuracy: 58.63
Round  35, Train loss: 0.708, Test loss: 0.905, Test accuracy: 67.50
Round  35, Global train loss: 0.708, Global test loss: 1.154, Global test accuracy: 59.85
Round  36, Train loss: 0.645, Test loss: 0.896, Test accuracy: 67.48
Round  36, Global train loss: 0.645, Global test loss: 1.299, Global test accuracy: 57.55
Round  37, Train loss: 0.639, Test loss: 0.907, Test accuracy: 67.34
Round  37, Global train loss: 0.639, Global test loss: 1.396, Global test accuracy: 55.96
Round  38, Train loss: 0.641, Test loss: 0.913, Test accuracy: 67.69
Round  38, Global train loss: 0.641, Global test loss: 1.163, Global test accuracy: 60.00
Round  39, Train loss: 0.599, Test loss: 0.934, Test accuracy: 67.21
Round  39, Global train loss: 0.599, Global test loss: 1.454, Global test accuracy: 55.03
Round  40, Train loss: 0.600, Test loss: 0.915, Test accuracy: 67.88
Round  40, Global train loss: 0.600, Global test loss: 1.195, Global test accuracy: 58.50
Round  41, Train loss: 0.723, Test loss: 0.917, Test accuracy: 68.01
Round  41, Global train loss: 0.723, Global test loss: 1.222, Global test accuracy: 57.85
Round  42, Train loss: 0.548, Test loss: 0.902, Test accuracy: 68.54
Round  42, Global train loss: 0.548, Global test loss: 1.278, Global test accuracy: 58.75
Round  43, Train loss: 0.556, Test loss: 0.901, Test accuracy: 68.48
Round  43, Global train loss: 0.556, Global test loss: 1.193, Global test accuracy: 60.37
Round  44, Train loss: 0.667, Test loss: 0.914, Test accuracy: 68.39
Round  44, Global train loss: 0.667, Global test loss: 1.315, Global test accuracy: 55.85
Round  45, Train loss: 0.584, Test loss: 0.925, Test accuracy: 68.39
Round  45, Global train loss: 0.584, Global test loss: 1.258, Global test accuracy: 57.63
Round  46, Train loss: 0.650, Test loss: 0.940, Test accuracy: 68.01
Round  46, Global train loss: 0.650, Global test loss: 1.162, Global test accuracy: 59.88
Round  47, Train loss: 0.596, Test loss: 0.938, Test accuracy: 68.42
Round  47, Global train loss: 0.596, Global test loss: 1.216, Global test accuracy: 59.84
Round  48, Train loss: 0.609, Test loss: 0.911, Test accuracy: 69.13
Round  48, Global train loss: 0.609, Global test loss: 1.262, Global test accuracy: 59.09
Round  49, Train loss: 0.614, Test loss: 0.897, Test accuracy: 69.61
Round  49, Global train loss: 0.614, Global test loss: 1.428, Global test accuracy: 54.26
Round  50, Train loss: 0.535, Test loss: 0.907, Test accuracy: 69.42
Round  50, Global train loss: 0.535, Global test loss: 1.437, Global test accuracy: 55.70
Round  51, Train loss: 0.573, Test loss: 0.903, Test accuracy: 69.60
Round  51, Global train loss: 0.573, Global test loss: 1.200, Global test accuracy: 59.78
Round  52, Train loss: 0.568, Test loss: 0.907, Test accuracy: 69.99
Round  52, Global train loss: 0.568, Global test loss: 1.205, Global test accuracy: 59.16
Round  53, Train loss: 0.556, Test loss: 0.904, Test accuracy: 69.97
Round  53, Global train loss: 0.556, Global test loss: 1.279, Global test accuracy: 59.25
Round  54, Train loss: 0.495, Test loss: 0.900, Test accuracy: 70.39
Round  54, Global train loss: 0.495, Global test loss: 1.254, Global test accuracy: 59.34
Round  55, Train loss: 0.486, Test loss: 0.891, Test accuracy: 70.51
Round  55, Global train loss: 0.486, Global test loss: 1.298, Global test accuracy: 58.00
Round  56, Train loss: 0.462, Test loss: 0.899, Test accuracy: 70.73
Round  56, Global train loss: 0.462, Global test loss: 1.505, Global test accuracy: 57.43
Round  57, Train loss: 0.586, Test loss: 0.902, Test accuracy: 70.51
Round  57, Global train loss: 0.586, Global test loss: 1.138, Global test accuracy: 61.69
Round  58, Train loss: 0.454, Test loss: 0.904, Test accuracy: 70.41
Round  58, Global train loss: 0.454, Global test loss: 1.372, Global test accuracy: 58.43
Round  59, Train loss: 0.546, Test loss: 0.907, Test accuracy: 70.33
Round  59, Global train loss: 0.546, Global test loss: 1.245, Global test accuracy: 60.25
Round  60, Train loss: 0.491, Test loss: 0.916, Test accuracy: 70.10
Round  60, Global train loss: 0.491, Global test loss: 1.261, Global test accuracy: 59.57
Round  61, Train loss: 0.415, Test loss: 0.952, Test accuracy: 69.41
Round  61, Global train loss: 0.415, Global test loss: 1.400, Global test accuracy: 56.72
Round  62, Train loss: 0.525, Test loss: 0.937, Test accuracy: 69.94
Round  62, Global train loss: 0.525, Global test loss: 1.118, Global test accuracy: 62.68
Round  63, Train loss: 0.404, Test loss: 0.939, Test accuracy: 70.16
Round  63, Global train loss: 0.404, Global test loss: 1.170, Global test accuracy: 62.99
Round  64, Train loss: 0.536, Test loss: 0.959, Test accuracy: 69.88
Round  64, Global train loss: 0.536, Global test loss: 1.225, Global test accuracy: 60.96
Round  65, Train loss: 0.422, Test loss: 0.983, Test accuracy: 69.43
Round  65, Global train loss: 0.422, Global test loss: 1.234, Global test accuracy: 61.47
Round  66, Train loss: 0.432, Test loss: 0.962, Test accuracy: 69.75
Round  66, Global train loss: 0.432, Global test loss: 1.403, Global test accuracy: 58.99
Round  67, Train loss: 0.457, Test loss: 0.964, Test accuracy: 69.64
Round  67, Global train loss: 0.457, Global test loss: 1.238, Global test accuracy: 61.43
Round  68, Train loss: 0.387, Test loss: 0.952, Test accuracy: 70.41
Round  68, Global train loss: 0.387, Global test loss: 1.387, Global test accuracy: 59.14
Round  69, Train loss: 0.493, Test loss: 0.947, Test accuracy: 70.70
Round  69, Global train loss: 0.493, Global test loss: 1.459, Global test accuracy: 56.04
Round  70, Train loss: 0.460, Test loss: 0.968, Test accuracy: 70.11
Round  70, Global train loss: 0.460, Global test loss: 1.279, Global test accuracy: 59.35
Round  71, Train loss: 0.439, Test loss: 0.962, Test accuracy: 70.46
Round  71, Global train loss: 0.439, Global test loss: 1.393, Global test accuracy: 58.84
Round  72, Train loss: 0.342, Test loss: 0.959, Test accuracy: 70.77
Round  72, Global train loss: 0.342, Global test loss: 1.393, Global test accuracy: 60.25
Round  73, Train loss: 0.430, Test loss: 0.960, Test accuracy: 70.80
Round  73, Global train loss: 0.430, Global test loss: 1.422, Global test accuracy: 58.12
Round  74, Train loss: 0.491, Test loss: 0.967, Test accuracy: 70.76
Round  74, Global train loss: 0.491, Global test loss: 1.334, Global test accuracy: 59.49
Round  75, Train loss: 0.395, Test loss: 0.972, Test accuracy: 70.68
Round  75, Global train loss: 0.395, Global test loss: 1.353, Global test accuracy: 60.97
Round  76, Train loss: 0.469, Test loss: 0.961, Test accuracy: 71.27
Round  76, Global train loss: 0.469, Global test loss: 1.193, Global test accuracy: 62.31
Round  77, Train loss: 0.484, Test loss: 0.971, Test accuracy: 70.81
Round  77, Global train loss: 0.484, Global test loss: 1.145, Global test accuracy: 63.03
Round  78, Train loss: 0.475, Test loss: 0.957, Test accuracy: 71.03
Round  78, Global train loss: 0.475, Global test loss: 1.282, Global test accuracy: 60.40
Round  79, Train loss: 0.447, Test loss: 0.975, Test accuracy: 70.62
Round  79, Global train loss: 0.447, Global test loss: 1.239, Global test accuracy: 61.60
Round  80, Train loss: 0.354, Test loss: 0.977, Test accuracy: 70.52
Round  80, Global train loss: 0.354, Global test loss: 1.264, Global test accuracy: 60.84
Round  81, Train loss: 0.338, Test loss: 0.982, Test accuracy: 70.87
Round  81, Global train loss: 0.338, Global test loss: 1.240, Global test accuracy: 62.78
Round  82, Train loss: 0.416, Test loss: 0.966, Test accuracy: 71.09
Round  82, Global train loss: 0.416, Global test loss: 1.322, Global test accuracy: 59.86
Round  83, Train loss: 0.389, Test loss: 0.981, Test accuracy: 70.97
Round  83, Global train loss: 0.389, Global test loss: 1.380, Global test accuracy: 61.64
Round  84, Train loss: 0.371, Test loss: 0.979, Test accuracy: 71.05
Round  84, Global train loss: 0.371, Global test loss: 1.329, Global test accuracy: 60.77
Round  85, Train loss: 0.379, Test loss: 0.984, Test accuracy: 71.12
Round  85, Global train loss: 0.379, Global test loss: 1.257, Global test accuracy: 62.33
Round  86, Train loss: 0.386, Test loss: 0.992, Test accuracy: 70.98
Round  86, Global train loss: 0.386, Global test loss: 1.354, Global test accuracy: 61.73
Round  87, Train loss: 0.435, Test loss: 0.985, Test accuracy: 71.23
Round  87, Global train loss: 0.435, Global test loss: 1.205, Global test accuracy: 63.41
Round  88, Train loss: 0.384, Test loss: 0.987, Test accuracy: 70.81
Round  88, Global train loss: 0.384, Global test loss: 1.205, Global test accuracy: 63.56
Round  89, Train loss: 0.432, Test loss: 0.994, Test accuracy: 70.86
Round  89, Global train loss: 0.432, Global test loss: 1.358, Global test accuracy: 59.78
Round  90, Train loss: 0.336, Test loss: 1.007, Test accuracy: 70.74
Round  90, Global train loss: 0.336, Global test loss: 1.320, Global test accuracy: 60.93
Round  91, Train loss: 0.328, Test loss: 0.990, Test accuracy: 71.41
Round  91, Global train loss: 0.328, Global test loss: 1.413, Global test accuracy: 61.14
Round  92, Train loss: 0.398, Test loss: 0.999, Test accuracy: 71.89
Round  92, Global train loss: 0.398, Global test loss: 1.383, Global test accuracy: 61.57
Round  93, Train loss: 0.424, Test loss: 1.010, Test accuracy: 71.25
Round  93, Global train loss: 0.424, Global test loss: 1.292, Global test accuracy: 61.73
Round  94, Train loss: 0.350, Test loss: 1.001, Test accuracy: 71.44
Round  94, Global train loss: 0.350, Global test loss: 1.389, Global test accuracy: 59.42
Round  95, Train loss: 0.316, Test loss: 1.008, Test accuracy: 71.18
Round  95, Global train loss: 0.316, Global test loss: 1.346, Global test accuracy: 62.42
Round  96, Train loss: 0.383, Test loss: 1.012, Test accuracy: 71.29
Round  96, Global train loss: 0.383, Global test loss: 1.423, Global test accuracy: 60.82
Round  97, Train loss: 0.443, Test loss: 1.012, Test accuracy: 71.53
Round  97, Global train loss: 0.443, Global test loss: 1.408, Global test accuracy: 60.42
Round  98, Train loss: 0.363, Test loss: 1.005, Test accuracy: 71.57
Round  98, Global train loss: 0.363, Global test loss: 1.458, Global test accuracy: 60.87
Round  99, Train loss: 0.373, Test loss: 1.021, Test accuracy: 71.21
Round  99, Global train loss: 0.373, Global test loss: 1.227, Global test accuracy: 63.41
Final Round, Train loss: 0.282, Test loss: 1.126, Test accuracy: 70.69
Final Round, Global train loss: 0.282, Global test loss: 1.227, Global test accuracy: 63.41
Average accuracy final 10 rounds: 71.351 

Average global accuracy final 10 rounds: 61.273 

1323.3523869514465
[1.3871040344238281, 2.7742080688476562, 3.897528648376465, 5.020849227905273, 6.140240669250488, 7.259632110595703, 8.374794721603394, 9.489957332611084, 10.603294610977173, 11.716631889343262, 12.823100566864014, 13.929569244384766, 15.05003571510315, 16.170502185821533, 17.304258346557617, 18.4380145072937, 19.56759023666382, 20.697165966033936, 21.830522060394287, 22.96387815475464, 24.100539922714233, 25.237201690673828, 26.391350984573364, 27.5455002784729, 28.67696189880371, 29.80842351913452, 30.936412811279297, 32.06440210342407, 33.186336278915405, 34.30827045440674, 35.447588205337524, 36.58690595626831, 37.72363877296448, 38.860371589660645, 39.978270292282104, 41.096168994903564, 42.218348026275635, 43.340527057647705, 44.460384368896484, 45.580241680145264, 46.70779514312744, 47.83534860610962, 48.96304130554199, 50.090734004974365, 51.218169927597046, 52.34560585021973, 53.47463536262512, 54.60366487503052, 55.74172306060791, 56.8797812461853, 58.00392770767212, 59.128074169158936, 60.24648332595825, 61.36489248275757, 62.487727880477905, 63.61056327819824, 64.73217535018921, 65.85378742218018, 66.9835376739502, 68.11328792572021, 69.2342848777771, 70.35528182983398, 71.47770714759827, 72.60013246536255, 73.72297406196594, 74.84581565856934, 75.96936440467834, 77.09291315078735, 78.2123806476593, 79.33184814453125, 80.4605929851532, 81.58933782577515, 82.71978855133057, 83.85023927688599, 84.97502660751343, 86.09981393814087, 87.22777652740479, 88.3557391166687, 89.48489284515381, 90.61404657363892, 91.73900198936462, 92.86395740509033, 93.99190950393677, 95.1198616027832, 96.24825096130371, 97.37664031982422, 98.50630283355713, 99.63596534729004, 100.76962113380432, 101.9032769203186, 103.03012681007385, 104.1569766998291, 105.28101873397827, 106.40506076812744, 107.52948522567749, 108.65390968322754, 109.78122520446777, 110.90854072570801, 112.02503156661987, 113.14152240753174, 114.27313327789307, 115.4047441482544, 116.53220224380493, 117.65966033935547, 118.78572177886963, 119.91178321838379, 121.04239225387573, 122.17300128936768, 123.29267001152039, 124.4123387336731, 125.53320670127869, 126.65407466888428, 127.7764401435852, 128.89880561828613, 130.01796770095825, 131.13712978363037, 132.25964260101318, 133.382155418396, 134.5042119026184, 135.62626838684082, 136.75232481956482, 137.87838125228882, 139.00146794319153, 140.12455463409424, 141.25896382331848, 142.39337301254272, 143.52132654190063, 144.64928007125854, 145.77404522895813, 146.89881038665771, 147.85113501548767, 148.80345964431763, 149.75546264648438, 150.70746564865112, 151.6609959602356, 152.61452627182007, 153.56588578224182, 154.51724529266357, 155.46939659118652, 156.42154788970947, 157.37637782096863, 158.33120775222778, 159.28906154632568, 160.24691534042358, 161.22576904296875, 162.20462274551392, 163.1663944721222, 164.12816619873047, 165.10154962539673, 166.074933052063, 167.02789855003357, 167.98086404800415, 168.93416452407837, 169.8874650001526, 170.87901163101196, 171.87055826187134, 172.8237659931183, 173.77697372436523, 174.72958374023438, 175.68219375610352, 176.63437390327454, 177.58655405044556, 178.53820967674255, 179.48986530303955, 180.44310903549194, 181.39635276794434, 182.34767317771912, 183.2989935874939, 184.27862191200256, 185.25825023651123, 186.20913290977478, 187.16001558303833, 188.1118974685669, 189.06377935409546, 190.0148799419403, 190.96598052978516, 191.91856622695923, 192.8711519241333, 193.82431554794312, 194.77747917175293, 195.7301745414734, 196.68286991119385, 197.63560557365417, 198.5883412361145, 199.54100131988525, 200.493661403656, 201.44771337509155, 202.4017653465271, 203.34677052497864, 204.29177570343018, 205.23370265960693, 206.1756296157837, 207.12850642204285, 208.081383228302, 209.0238447189331, 209.9663062095642, 210.9190149307251, 211.871723651886, 212.8439564704895, 213.81618928909302, 215.73997282981873, 217.66375637054443]
[26.18, 26.18, 30.27, 30.27, 37.59, 37.59, 42.02, 42.02, 47.26, 47.26, 50.82, 50.82, 52.22, 52.22, 51.65, 51.65, 54.93, 54.93, 55.48, 55.48, 56.91, 56.91, 57.62, 57.62, 58.78, 58.78, 60.13, 60.13, 61.54, 61.54, 62.2, 62.2, 62.39, 62.39, 62.47, 62.47, 63.06, 63.06, 63.25, 63.25, 63.57, 63.57, 63.46, 63.46, 63.81, 63.81, 64.65, 64.65, 65.45, 65.45, 65.8, 65.8, 66.88, 66.88, 66.71, 66.71, 66.61, 66.61, 67.14, 67.14, 67.55, 67.55, 67.52, 67.52, 67.65, 67.65, 67.71, 67.71, 67.58, 67.58, 67.5, 67.5, 67.48, 67.48, 67.34, 67.34, 67.69, 67.69, 67.21, 67.21, 67.88, 67.88, 68.01, 68.01, 68.54, 68.54, 68.48, 68.48, 68.39, 68.39, 68.39, 68.39, 68.01, 68.01, 68.42, 68.42, 69.13, 69.13, 69.61, 69.61, 69.42, 69.42, 69.6, 69.6, 69.99, 69.99, 69.97, 69.97, 70.39, 70.39, 70.51, 70.51, 70.73, 70.73, 70.51, 70.51, 70.41, 70.41, 70.33, 70.33, 70.1, 70.1, 69.41, 69.41, 69.94, 69.94, 70.16, 70.16, 69.88, 69.88, 69.43, 69.43, 69.75, 69.75, 69.64, 69.64, 70.41, 70.41, 70.7, 70.7, 70.11, 70.11, 70.46, 70.46, 70.77, 70.77, 70.8, 70.8, 70.76, 70.76, 70.68, 70.68, 71.27, 71.27, 70.81, 70.81, 71.03, 71.03, 70.62, 70.62, 70.52, 70.52, 70.87, 70.87, 71.09, 71.09, 70.97, 70.97, 71.05, 71.05, 71.12, 71.12, 70.98, 70.98, 71.23, 71.23, 70.81, 70.81, 70.86, 70.86, 70.74, 70.74, 71.41, 71.41, 71.89, 71.89, 71.25, 71.25, 71.44, 71.44, 71.18, 71.18, 71.29, 71.29, 71.53, 71.53, 71.57, 71.57, 71.21, 71.21, 70.69, 70.69]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.649, Test loss: 2.038, Test accuracy: 22.35
Round   0, Global train loss: 1.649, Global test loss: 2.219, Global test accuracy: 17.33
Round   1, Train loss: 1.480, Test loss: 1.890, Test accuracy: 31.56
Round   1, Global train loss: 1.480, Global test loss: 2.237, Global test accuracy: 26.24
Round   2, Train loss: 1.482, Test loss: 1.593, Test accuracy: 37.29
Round   2, Global train loss: 1.482, Global test loss: 1.942, Global test accuracy: 30.14
Round   3, Train loss: 1.386, Test loss: 1.537, Test accuracy: 40.84
Round   3, Global train loss: 1.386, Global test loss: 1.962, Global test accuracy: 33.96
Round   4, Train loss: 1.275, Test loss: 1.401, Test accuracy: 44.99
Round   4, Global train loss: 1.275, Global test loss: 1.855, Global test accuracy: 33.25
Round   5, Train loss: 1.260, Test loss: 1.293, Test accuracy: 47.77
Round   5, Global train loss: 1.260, Global test loss: 1.647, Global test accuracy: 40.38
Round   6, Train loss: 1.223, Test loss: 1.268, Test accuracy: 49.94
Round   6, Global train loss: 1.223, Global test loss: 1.812, Global test accuracy: 32.32
Round   7, Train loss: 1.108, Test loss: 1.244, Test accuracy: 50.88
Round   7, Global train loss: 1.108, Global test loss: 1.742, Global test accuracy: 33.62
Round   8, Train loss: 1.240, Test loss: 1.204, Test accuracy: 53.60
Round   8, Global train loss: 1.240, Global test loss: 1.591, Global test accuracy: 45.11
Round   9, Train loss: 1.324, Test loss: 1.192, Test accuracy: 54.12
Round   9, Global train loss: 1.324, Global test loss: 1.654, Global test accuracy: 42.72
Round  10, Train loss: 1.241, Test loss: 1.176, Test accuracy: 53.91
Round  10, Global train loss: 1.241, Global test loss: 1.571, Global test accuracy: 42.51
Round  11, Train loss: 1.145, Test loss: 1.170, Test accuracy: 54.68
Round  11, Global train loss: 1.145, Global test loss: 1.664, Global test accuracy: 40.25
Round  12, Train loss: 1.037, Test loss: 1.102, Test accuracy: 57.27
Round  12, Global train loss: 1.037, Global test loss: 1.597, Global test accuracy: 40.86
Round  13, Train loss: 0.998, Test loss: 1.099, Test accuracy: 57.18
Round  13, Global train loss: 0.998, Global test loss: 1.596, Global test accuracy: 43.40
Round  14, Train loss: 1.038, Test loss: 1.084, Test accuracy: 58.28
Round  14, Global train loss: 1.038, Global test loss: 1.473, Global test accuracy: 45.51
Round  15, Train loss: 0.977, Test loss: 1.091, Test accuracy: 58.05
Round  15, Global train loss: 0.977, Global test loss: 1.574, Global test accuracy: 43.15
Round  16, Train loss: 0.935, Test loss: 1.086, Test accuracy: 58.03
Round  16, Global train loss: 0.935, Global test loss: 1.415, Global test accuracy: 49.21
Round  17, Train loss: 1.026, Test loss: 1.068, Test accuracy: 58.90
Round  17, Global train loss: 1.026, Global test loss: 1.455, Global test accuracy: 48.83
Round  18, Train loss: 0.910, Test loss: 1.070, Test accuracy: 59.22
Round  18, Global train loss: 0.910, Global test loss: 1.424, Global test accuracy: 48.65
Round  19, Train loss: 0.990, Test loss: 1.060, Test accuracy: 60.08
Round  19, Global train loss: 0.990, Global test loss: 1.497, Global test accuracy: 46.72
Round  20, Train loss: 0.990, Test loss: 1.044, Test accuracy: 60.71
Round  20, Global train loss: 0.990, Global test loss: 1.540, Global test accuracy: 47.29
Round  21, Train loss: 0.935, Test loss: 1.036, Test accuracy: 61.24
Round  21, Global train loss: 0.935, Global test loss: 1.401, Global test accuracy: 48.62
Round  22, Train loss: 0.998, Test loss: 1.018, Test accuracy: 62.10
Round  22, Global train loss: 0.998, Global test loss: 1.467, Global test accuracy: 47.94
Round  23, Train loss: 0.982, Test loss: 1.006, Test accuracy: 62.50
Round  23, Global train loss: 0.982, Global test loss: 1.468, Global test accuracy: 47.99
Round  24, Train loss: 0.908, Test loss: 0.995, Test accuracy: 62.67
Round  24, Global train loss: 0.908, Global test loss: 1.582, Global test accuracy: 44.84
Round  25, Train loss: 1.041, Test loss: 0.993, Test accuracy: 62.59
Round  25, Global train loss: 1.041, Global test loss: 1.407, Global test accuracy: 51.95
Round  26, Train loss: 0.861, Test loss: 0.995, Test accuracy: 63.09
Round  26, Global train loss: 0.861, Global test loss: 1.343, Global test accuracy: 52.79
Round  27, Train loss: 0.902, Test loss: 0.987, Test accuracy: 63.44
Round  27, Global train loss: 0.902, Global test loss: 1.434, Global test accuracy: 50.30
Round  28, Train loss: 0.948, Test loss: 0.977, Test accuracy: 63.83
Round  28, Global train loss: 0.948, Global test loss: 1.319, Global test accuracy: 53.21
Round  29, Train loss: 0.972, Test loss: 0.975, Test accuracy: 63.92
Round  29, Global train loss: 0.972, Global test loss: 1.347, Global test accuracy: 52.82
Round  30, Train loss: 0.730, Test loss: 0.973, Test accuracy: 64.31
Round  30, Global train loss: 0.730, Global test loss: 1.601, Global test accuracy: 46.18
Round  31, Train loss: 0.799, Test loss: 0.960, Test accuracy: 64.89
Round  31, Global train loss: 0.799, Global test loss: 1.275, Global test accuracy: 55.45
Round  32, Train loss: 0.836, Test loss: 0.959, Test accuracy: 65.12
Round  32, Global train loss: 0.836, Global test loss: 1.352, Global test accuracy: 52.39
Round  33, Train loss: 0.880, Test loss: 0.960, Test accuracy: 64.99
Round  33, Global train loss: 0.880, Global test loss: 1.280, Global test accuracy: 55.35
Round  34, Train loss: 0.811, Test loss: 0.958, Test accuracy: 65.02
Round  34, Global train loss: 0.811, Global test loss: 1.265, Global test accuracy: 55.40
Round  35, Train loss: 0.893, Test loss: 0.961, Test accuracy: 64.78
Round  35, Global train loss: 0.893, Global test loss: 1.211, Global test accuracy: 57.99
Round  36, Train loss: 0.775, Test loss: 0.959, Test accuracy: 65.17
Round  36, Global train loss: 0.775, Global test loss: 1.305, Global test accuracy: 55.91
Round  37, Train loss: 0.807, Test loss: 0.974, Test accuracy: 64.40
Round  37, Global train loss: 0.807, Global test loss: 1.415, Global test accuracy: 52.92
Round  38, Train loss: 0.830, Test loss: 0.964, Test accuracy: 64.95
Round  38, Global train loss: 0.830, Global test loss: 1.247, Global test accuracy: 56.34
Round  39, Train loss: 0.733, Test loss: 0.968, Test accuracy: 65.25
Round  39, Global train loss: 0.733, Global test loss: 1.517, Global test accuracy: 52.80
Round  40, Train loss: 0.734, Test loss: 0.959, Test accuracy: 65.49
Round  40, Global train loss: 0.734, Global test loss: 1.219, Global test accuracy: 57.57
Round  41, Train loss: 0.788, Test loss: 0.968, Test accuracy: 65.21
Round  41, Global train loss: 0.788, Global test loss: 1.326, Global test accuracy: 55.11
Round  42, Train loss: 0.663, Test loss: 0.963, Test accuracy: 65.24
Round  42, Global train loss: 0.663, Global test loss: 1.259, Global test accuracy: 56.96
Round  43, Train loss: 0.720, Test loss: 0.957, Test accuracy: 65.44
Round  43, Global train loss: 0.720, Global test loss: 1.224, Global test accuracy: 57.64
Round  44, Train loss: 0.808, Test loss: 0.971, Test accuracy: 65.98
Round  44, Global train loss: 0.808, Global test loss: 1.341, Global test accuracy: 54.01
Round  45, Train loss: 0.727, Test loss: 0.977, Test accuracy: 65.84
Round  45, Global train loss: 0.727, Global test loss: 1.224, Global test accuracy: 57.62
Round  46, Train loss: 0.818, Test loss: 0.987, Test accuracy: 65.35
Round  46, Global train loss: 0.818, Global test loss: 1.195, Global test accuracy: 58.06
Round  47, Train loss: 0.748, Test loss: 0.982, Test accuracy: 65.93
Round  47, Global train loss: 0.748, Global test loss: 1.227, Global test accuracy: 58.19
Round  48, Train loss: 0.823, Test loss: 0.973, Test accuracy: 66.25
Round  48, Global train loss: 0.823, Global test loss: 1.338, Global test accuracy: 55.67
Round  49, Train loss: 0.650, Test loss: 0.985, Test accuracy: 66.22
Round  49, Global train loss: 0.650, Global test loss: 1.345, Global test accuracy: 55.26
Round  50, Train loss: 0.641, Test loss: 1.015, Test accuracy: 65.66
Round  50, Global train loss: 0.641, Global test loss: 1.441, Global test accuracy: 53.56
Round  51, Train loss: 0.653, Test loss: 0.999, Test accuracy: 66.58
Round  51, Global train loss: 0.653, Global test loss: 1.166, Global test accuracy: 60.03
Round  52, Train loss: 0.783, Test loss: 1.010, Test accuracy: 66.50
Round  52, Global train loss: 0.783, Global test loss: 1.229, Global test accuracy: 57.42
Round  53, Train loss: 0.696, Test loss: 0.973, Test accuracy: 67.23
Round  53, Global train loss: 0.696, Global test loss: 1.318, Global test accuracy: 57.09
Round  54, Train loss: 0.560, Test loss: 0.971, Test accuracy: 66.92
Round  54, Global train loss: 0.560, Global test loss: 1.327, Global test accuracy: 56.58
Round  55, Train loss: 0.634, Test loss: 0.972, Test accuracy: 67.10
Round  55, Global train loss: 0.634, Global test loss: 1.256, Global test accuracy: 57.69
Round  56, Train loss: 0.583, Test loss: 0.993, Test accuracy: 66.98
Round  56, Global train loss: 0.583, Global test loss: 1.405, Global test accuracy: 56.18
Round  57, Train loss: 0.782, Test loss: 0.990, Test accuracy: 66.70
Round  57, Global train loss: 0.782, Global test loss: 1.189, Global test accuracy: 59.02
Round  58, Train loss: 0.564, Test loss: 0.969, Test accuracy: 67.42
Round  58, Global train loss: 0.564, Global test loss: 1.329, Global test accuracy: 56.99
Round  59, Train loss: 0.610, Test loss: 0.978, Test accuracy: 67.34
Round  59, Global train loss: 0.610, Global test loss: 1.279, Global test accuracy: 58.25
Round  60, Train loss: 0.603, Test loss: 0.985, Test accuracy: 67.28
Round  60, Global train loss: 0.603, Global test loss: 1.260, Global test accuracy: 58.09
Round  61, Train loss: 0.512, Test loss: 0.974, Test accuracy: 67.69
Round  61, Global train loss: 0.512, Global test loss: 1.356, Global test accuracy: 56.28
Round  62, Train loss: 0.610, Test loss: 0.990, Test accuracy: 67.53
Round  62, Global train loss: 0.610, Global test loss: 1.186, Global test accuracy: 60.18
Round  63, Train loss: 0.540, Test loss: 0.986, Test accuracy: 67.61
Round  63, Global train loss: 0.540, Global test loss: 1.166, Global test accuracy: 61.39
Round  64, Train loss: 0.603, Test loss: 0.984, Test accuracy: 67.71
Round  64, Global train loss: 0.603, Global test loss: 1.163, Global test accuracy: 60.62
Round  65, Train loss: 0.540, Test loss: 0.994, Test accuracy: 67.58
Round  65, Global train loss: 0.540, Global test loss: 1.256, Global test accuracy: 59.28
Round  66, Train loss: 0.491, Test loss: 1.018, Test accuracy: 67.08
Round  66, Global train loss: 0.491, Global test loss: 1.370, Global test accuracy: 57.62
Round  67, Train loss: 0.509, Test loss: 1.020, Test accuracy: 66.77
Round  67, Global train loss: 0.509, Global test loss: 1.303, Global test accuracy: 58.15
Round  68, Train loss: 0.504, Test loss: 1.018, Test accuracy: 66.99
Round  68, Global train loss: 0.504, Global test loss: 1.420, Global test accuracy: 55.06
Round  69, Train loss: 0.633, Test loss: 1.009, Test accuracy: 67.36
Round  69, Global train loss: 0.633, Global test loss: 1.313, Global test accuracy: 57.39
Round  70, Train loss: 0.481, Test loss: 0.986, Test accuracy: 67.97
Round  70, Global train loss: 0.481, Global test loss: 1.336, Global test accuracy: 57.59
Round  71, Train loss: 0.502, Test loss: 0.996, Test accuracy: 67.77
Round  71, Global train loss: 0.502, Global test loss: 1.396, Global test accuracy: 56.67
Round  72, Train loss: 0.454, Test loss: 1.014, Test accuracy: 67.32
Round  72, Global train loss: 0.454, Global test loss: 1.368, Global test accuracy: 58.36
Round  73, Train loss: 0.483, Test loss: 1.007, Test accuracy: 67.60
Round  73, Global train loss: 0.483, Global test loss: 1.357, Global test accuracy: 57.97
Round  74, Train loss: 0.639, Test loss: 1.013, Test accuracy: 67.29
Round  74, Global train loss: 0.639, Global test loss: 1.366, Global test accuracy: 56.74
Round  75, Train loss: 0.509, Test loss: 1.011, Test accuracy: 67.62
Round  75, Global train loss: 0.509, Global test loss: 1.351, Global test accuracy: 58.92
Round  76, Train loss: 0.600, Test loss: 1.009, Test accuracy: 67.84
Round  76, Global train loss: 0.600, Global test loss: 1.186, Global test accuracy: 61.17
Round  77, Train loss: 0.536, Test loss: 1.010, Test accuracy: 67.58
Round  77, Global train loss: 0.536, Global test loss: 1.204, Global test accuracy: 61.54
Round  78, Train loss: 0.646, Test loss: 1.018, Test accuracy: 67.49
Round  78, Global train loss: 0.646, Global test loss: 1.246, Global test accuracy: 60.11
Round  79, Train loss: 0.511, Test loss: 1.025, Test accuracy: 67.77
Round  79, Global train loss: 0.511, Global test loss: 1.213, Global test accuracy: 59.94
Round  80, Train loss: 0.415, Test loss: 1.042, Test accuracy: 67.67
Round  80, Global train loss: 0.415, Global test loss: 1.320, Global test accuracy: 57.87
Round  81, Train loss: 0.439, Test loss: 1.041, Test accuracy: 67.72
Round  81, Global train loss: 0.439, Global test loss: 1.295, Global test accuracy: 59.69
Round  82, Train loss: 0.522, Test loss: 1.049, Test accuracy: 67.78
Round  82, Global train loss: 0.522, Global test loss: 1.296, Global test accuracy: 59.85
Round  83, Train loss: 0.558, Test loss: 1.054, Test accuracy: 67.44
Round  83, Global train loss: 0.558, Global test loss: 1.357, Global test accuracy: 59.97
Round  84, Train loss: 0.495, Test loss: 1.046, Test accuracy: 67.96
Round  84, Global train loss: 0.495, Global test loss: 1.360, Global test accuracy: 58.85
Round  85, Train loss: 0.497, Test loss: 1.037, Test accuracy: 68.43
Round  85, Global train loss: 0.497, Global test loss: 1.228, Global test accuracy: 61.98
Round  86, Train loss: 0.549, Test loss: 1.038, Test accuracy: 68.50
Round  86, Global train loss: 0.549, Global test loss: 1.386, Global test accuracy: 58.41
Round  87, Train loss: 0.483, Test loss: 1.041, Test accuracy: 68.42
Round  87, Global train loss: 0.483, Global test loss: 1.297, Global test accuracy: 60.28
Round  88, Train loss: 0.551, Test loss: 1.052, Test accuracy: 68.58
Round  88, Global train loss: 0.551, Global test loss: 1.267, Global test accuracy: 60.32
Round  89, Train loss: 0.468, Test loss: 1.046, Test accuracy: 68.75
Round  89, Global train loss: 0.468, Global test loss: 1.383, Global test accuracy: 58.88
Round  90, Train loss: 0.431, Test loss: 1.054, Test accuracy: 68.51
Round  90, Global train loss: 0.431, Global test loss: 1.310, Global test accuracy: 60.43
Round  91, Train loss: 0.473, Test loss: 1.048, Test accuracy: 68.57
Round  91, Global train loss: 0.473, Global test loss: 1.402, Global test accuracy: 59.11
Round  92, Train loss: 0.538, Test loss: 1.073, Test accuracy: 68.14
Round  92, Global train loss: 0.538, Global test loss: 1.369, Global test accuracy: 58.42
Round  93, Train loss: 0.464, Test loss: 1.082, Test accuracy: 67.96
Round  93, Global train loss: 0.464, Global test loss: 1.288, Global test accuracy: 60.39
Round  94, Train loss: 0.468, Test loss: 1.083, Test accuracy: 68.18
Round  94, Global train loss: 0.468, Global test loss: 1.376, Global test accuracy: 58.86/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.424, Test loss: 1.080, Test accuracy: 68.32
Round  95, Global train loss: 0.424, Global test loss: 1.355, Global test accuracy: 61.27
Round  96, Train loss: 0.524, Test loss: 1.061, Test accuracy: 68.80
Round  96, Global train loss: 0.524, Global test loss: 1.368, Global test accuracy: 59.99
Round  97, Train loss: 0.541, Test loss: 1.054, Test accuracy: 68.70
Round  97, Global train loss: 0.541, Global test loss: 1.410, Global test accuracy: 58.89
Round  98, Train loss: 0.453, Test loss: 1.065, Test accuracy: 68.43
Round  98, Global train loss: 0.453, Global test loss: 1.409, Global test accuracy: 59.68
Round  99, Train loss: 0.505, Test loss: 1.022, Test accuracy: 68.96
Round  99, Global train loss: 0.505, Global test loss: 1.285, Global test accuracy: 61.01
Final Round, Train loss: 0.371, Test loss: 1.127, Test accuracy: 68.67
Final Round, Global train loss: 0.371, Global test loss: 1.285, Global test accuracy: 61.01
Average accuracy final 10 rounds: 68.457 

Average global accuracy final 10 rounds: 59.80500000000001 

1326.2641608715057
[1.477463960647583, 2.954927921295166, 4.16658878326416, 5.378249645233154, 6.577484130859375, 7.776718616485596, 8.984354972839355, 10.191991329193115, 11.392992734909058, 12.593994140625, 13.799591541290283, 15.005188941955566, 16.210655689239502, 17.416122436523438, 18.617752075195312, 19.819381713867188, 21.022159337997437, 22.224936962127686, 23.434632301330566, 24.644327640533447, 25.85256338119507, 27.06079912185669, 28.270639657974243, 29.480480194091797, 30.683680295944214, 31.88688039779663, 33.09311604499817, 34.29935169219971, 35.510236501693726, 36.721121311187744, 37.926660776138306, 39.13220024108887, 40.34702253341675, 41.56184482574463, 42.7759895324707, 43.99013423919678, 45.189836263656616, 46.389538288116455, 47.58713364601135, 48.78472900390625, 49.984923362731934, 51.18511772155762, 52.388922929763794, 53.59272813796997, 54.79895615577698, 56.005184173583984, 57.20842123031616, 58.41165828704834, 59.62269949913025, 60.83374071121216, 62.03878140449524, 63.24382209777832, 64.27112579345703, 65.29842948913574, 66.32452058792114, 67.35061168670654, 68.38167405128479, 69.41273641586304, 70.44550728797913, 71.47827816009521, 72.51133847236633, 73.54439878463745, 74.57795143127441, 75.61150407791138, 76.64337253570557, 77.67524099349976, 78.70515275001526, 79.73506450653076, 80.76530599594116, 81.79554748535156, 82.83012509346008, 83.8647027015686, 84.90046191215515, 85.9362211227417, 86.97131657600403, 88.00641202926636, 89.03935027122498, 90.0722885131836, 91.10602498054504, 92.1397614479065, 93.1731915473938, 94.2066216468811, 95.23956418037415, 96.27250671386719, 97.30695295333862, 98.34139919281006, 99.37786412239075, 100.41432905197144, 101.44655275344849, 102.47877645492554, 103.51096773147583, 104.54315900802612, 105.57921409606934, 106.61526918411255, 107.64939403533936, 108.68351888656616, 109.71579575538635, 110.74807262420654, 111.77553534507751, 112.80299806594849, 113.8363151550293, 114.86963224411011, 115.89789319038391, 116.92615413665771, 117.95687961578369, 118.98760509490967, 120.02166771888733, 121.05573034286499, 122.09171104431152, 123.12769174575806, 124.16213750839233, 125.19658327102661, 126.23211193084717, 127.26764059066772, 128.3025677204132, 129.3374948501587, 130.37268018722534, 131.407865524292, 132.44180750846863, 133.47574949264526, 134.5110559463501, 135.54636240005493, 136.57914924621582, 137.6119360923767, 138.64582753181458, 139.67971897125244, 140.71534848213196, 141.75097799301147, 142.78529834747314, 143.81961870193481, 144.85399889945984, 145.88837909698486, 146.9245834350586, 147.96078777313232, 148.99573755264282, 150.03068733215332, 151.06609535217285, 152.10150337219238, 153.13699340820312, 154.17248344421387, 155.205806016922, 156.23912858963013, 157.27225756645203, 158.30538654327393, 159.3399248123169, 160.37446308135986, 161.40937852859497, 162.44429397583008, 163.4779496192932, 164.51160526275635, 165.54662919044495, 166.58165311813354, 167.61596250534058, 168.6502718925476, 169.6858615875244, 170.72145128250122, 171.7535262107849, 172.7856011390686, 173.8182077407837, 174.85081434249878, 175.88437867164612, 176.91794300079346, 177.94856214523315, 178.97918128967285, 180.01448106765747, 181.0497808456421, 182.083340883255, 183.11690092086792, 184.1498727798462, 185.18284463882446, 186.21891069412231, 187.25497674942017, 188.2906448841095, 189.32631301879883, 190.36208391189575, 191.39785480499268, 192.43101382255554, 193.4641728401184, 194.496728181839, 195.52928352355957, 196.56330251693726, 197.59732151031494, 198.63014912605286, 199.66297674179077, 200.6947524547577, 201.7265281677246, 202.75976872444153, 203.79300928115845, 204.82524967193604, 205.85749006271362, 206.8892946243286, 207.9210991859436, 208.95555353164673, 209.99000787734985, 211.02592253684998, 212.0618371963501, 213.09581780433655, 214.129798412323, 215.16255688667297, 216.19531536102295, 218.2595546245575, 220.32379388809204]
[22.35, 22.35, 31.56, 31.56, 37.29, 37.29, 40.84, 40.84, 44.99, 44.99, 47.77, 47.77, 49.94, 49.94, 50.88, 50.88, 53.6, 53.6, 54.12, 54.12, 53.91, 53.91, 54.68, 54.68, 57.27, 57.27, 57.18, 57.18, 58.28, 58.28, 58.05, 58.05, 58.03, 58.03, 58.9, 58.9, 59.22, 59.22, 60.08, 60.08, 60.71, 60.71, 61.24, 61.24, 62.1, 62.1, 62.5, 62.5, 62.67, 62.67, 62.59, 62.59, 63.09, 63.09, 63.44, 63.44, 63.83, 63.83, 63.92, 63.92, 64.31, 64.31, 64.89, 64.89, 65.12, 65.12, 64.99, 64.99, 65.02, 65.02, 64.78, 64.78, 65.17, 65.17, 64.4, 64.4, 64.95, 64.95, 65.25, 65.25, 65.49, 65.49, 65.21, 65.21, 65.24, 65.24, 65.44, 65.44, 65.98, 65.98, 65.84, 65.84, 65.35, 65.35, 65.93, 65.93, 66.25, 66.25, 66.22, 66.22, 65.66, 65.66, 66.58, 66.58, 66.5, 66.5, 67.23, 67.23, 66.92, 66.92, 67.1, 67.1, 66.98, 66.98, 66.7, 66.7, 67.42, 67.42, 67.34, 67.34, 67.28, 67.28, 67.69, 67.69, 67.53, 67.53, 67.61, 67.61, 67.71, 67.71, 67.58, 67.58, 67.08, 67.08, 66.77, 66.77, 66.99, 66.99, 67.36, 67.36, 67.97, 67.97, 67.77, 67.77, 67.32, 67.32, 67.6, 67.6, 67.29, 67.29, 67.62, 67.62, 67.84, 67.84, 67.58, 67.58, 67.49, 67.49, 67.77, 67.77, 67.67, 67.67, 67.72, 67.72, 67.78, 67.78, 67.44, 67.44, 67.96, 67.96, 68.43, 68.43, 68.5, 68.5, 68.42, 68.42, 68.58, 68.58, 68.75, 68.75, 68.51, 68.51, 68.57, 68.57, 68.14, 68.14, 67.96, 67.96, 68.18, 68.18, 68.32, 68.32, 68.8, 68.8, 68.7, 68.7, 68.43, 68.43, 68.96, 68.96, 68.67, 68.67]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.563, Test loss: 2.046, Test accuracy: 25.29
Round   0, Global train loss: 1.563, Global test loss: 2.199, Global test accuracy: 21.74
Round   1, Train loss: 1.445, Test loss: 1.915, Test accuracy: 29.35
Round   1, Global train loss: 1.445, Global test loss: 2.238, Global test accuracy: 23.61
Round   2, Train loss: 1.483, Test loss: 1.619, Test accuracy: 36.95
Round   2, Global train loss: 1.483, Global test loss: 2.002, Global test accuracy: 29.61
Round   3, Train loss: 1.322, Test loss: 1.593, Test accuracy: 40.32
Round   3, Global train loss: 1.322, Global test loss: 2.060, Global test accuracy: 33.68
Round   4, Train loss: 1.224, Test loss: 1.458, Test accuracy: 44.38
Round   4, Global train loss: 1.224, Global test loss: 1.946, Global test accuracy: 34.80
Round   5, Train loss: 1.212, Test loss: 1.319, Test accuracy: 47.34
Round   5, Global train loss: 1.212, Global test loss: 1.681, Global test accuracy: 40.26
Round   6, Train loss: 1.135, Test loss: 1.307, Test accuracy: 49.45
Round   6, Global train loss: 1.135, Global test loss: 1.834, Global test accuracy: 35.86
Round   7, Train loss: 1.109, Test loss: 1.291, Test accuracy: 49.84
Round   7, Global train loss: 1.109, Global test loss: 1.831, Global test accuracy: 33.91
Round   8, Train loss: 1.156, Test loss: 1.250, Test accuracy: 52.37
Round   8, Global train loss: 1.156, Global test loss: 1.624, Global test accuracy: 42.81
Round   9, Train loss: 1.188, Test loss: 1.204, Test accuracy: 54.57
Round   9, Global train loss: 1.188, Global test loss: 1.787, Global test accuracy: 39.07
Round  10, Train loss: 1.118, Test loss: 1.171, Test accuracy: 54.86
Round  10, Global train loss: 1.118, Global test loss: 1.567, Global test accuracy: 43.05
Round  11, Train loss: 1.068, Test loss: 1.180, Test accuracy: 55.65
Round  11, Global train loss: 1.068, Global test loss: 1.857, Global test accuracy: 38.52
Round  12, Train loss: 0.981, Test loss: 1.111, Test accuracy: 57.54
Round  12, Global train loss: 0.981, Global test loss: 1.611, Global test accuracy: 42.47
Round  13, Train loss: 0.956, Test loss: 1.094, Test accuracy: 58.01
Round  13, Global train loss: 0.956, Global test loss: 1.666, Global test accuracy: 43.72
Round  14, Train loss: 1.018, Test loss: 1.083, Test accuracy: 58.67
Round  14, Global train loss: 1.018, Global test loss: 1.517, Global test accuracy: 46.34
Round  15, Train loss: 0.961, Test loss: 1.095, Test accuracy: 58.97
Round  15, Global train loss: 0.961, Global test loss: 1.705, Global test accuracy: 43.23
Round  16, Train loss: 0.877, Test loss: 1.089, Test accuracy: 59.32
Round  16, Global train loss: 0.877, Global test loss: 1.457, Global test accuracy: 49.43
Round  17, Train loss: 0.911, Test loss: 1.100, Test accuracy: 58.96
Round  17, Global train loss: 0.911, Global test loss: 1.659, Global test accuracy: 44.84
Round  18, Train loss: 0.885, Test loss: 1.084, Test accuracy: 59.48
Round  18, Global train loss: 0.885, Global test loss: 1.507, Global test accuracy: 46.63
Round  19, Train loss: 0.912, Test loss: 1.072, Test accuracy: 60.01
Round  19, Global train loss: 0.912, Global test loss: 1.607, Global test accuracy: 45.25
Round  20, Train loss: 0.896, Test loss: 1.089, Test accuracy: 59.71
Round  20, Global train loss: 0.896, Global test loss: 1.707, Global test accuracy: 44.15
Round  21, Train loss: 0.870, Test loss: 1.092, Test accuracy: 59.59
Round  21, Global train loss: 0.870, Global test loss: 1.575, Global test accuracy: 44.78
Round  22, Train loss: 0.936, Test loss: 1.053, Test accuracy: 60.98
Round  22, Global train loss: 0.936, Global test loss: 1.587, Global test accuracy: 46.14
Round  23, Train loss: 0.919, Test loss: 1.045, Test accuracy: 61.48
Round  23, Global train loss: 0.919, Global test loss: 1.648, Global test accuracy: 44.03
Round  24, Train loss: 0.821, Test loss: 1.037, Test accuracy: 61.98
Round  24, Global train loss: 0.821, Global test loss: 1.625, Global test accuracy: 45.66
Round  25, Train loss: 0.910, Test loss: 1.036, Test accuracy: 62.40
Round  25, Global train loss: 0.910, Global test loss: 1.379, Global test accuracy: 51.23
Round  26, Train loss: 0.745, Test loss: 1.016, Test accuracy: 63.36
Round  26, Global train loss: 0.745, Global test loss: 1.447, Global test accuracy: 50.29
Round  27, Train loss: 0.807, Test loss: 1.013, Test accuracy: 63.88
Round  27, Global train loss: 0.807, Global test loss: 1.548, Global test accuracy: 47.25
Round  28, Train loss: 0.823, Test loss: 0.999, Test accuracy: 64.36
Round  28, Global train loss: 0.823, Global test loss: 1.349, Global test accuracy: 53.15
Round  29, Train loss: 0.876, Test loss: 1.020, Test accuracy: 63.80
Round  29, Global train loss: 0.876, Global test loss: 1.460, Global test accuracy: 49.63
Round  30, Train loss: 0.695, Test loss: 1.009, Test accuracy: 64.00
Round  30, Global train loss: 0.695, Global test loss: 1.697, Global test accuracy: 46.07
Round  31, Train loss: 0.780, Test loss: 1.002, Test accuracy: 64.15
Round  31, Global train loss: 0.780, Global test loss: 1.361, Global test accuracy: 51.87
Round  32, Train loss: 0.810, Test loss: 0.997, Test accuracy: 64.24
Round  32, Global train loss: 0.810, Global test loss: 1.418, Global test accuracy: 52.39
Round  33, Train loss: 0.710, Test loss: 1.011, Test accuracy: 63.86
Round  33, Global train loss: 0.710, Global test loss: 1.355, Global test accuracy: 53.50
Round  34, Train loss: 0.715, Test loss: 1.003, Test accuracy: 64.59
Round  34, Global train loss: 0.715, Global test loss: 1.307, Global test accuracy: 55.39
Round  35, Train loss: 0.777, Test loss: 0.994, Test accuracy: 64.85
Round  35, Global train loss: 0.777, Global test loss: 1.264, Global test accuracy: 55.56
Round  36, Train loss: 0.706, Test loss: 1.021, Test accuracy: 64.88
Round  36, Global train loss: 0.706, Global test loss: 1.448, Global test accuracy: 53.75
Round  37, Train loss: 0.683, Test loss: 1.028, Test accuracy: 64.53
Round  37, Global train loss: 0.683, Global test loss: 1.550, Global test accuracy: 51.79
Round  38, Train loss: 0.661, Test loss: 1.030, Test accuracy: 64.57
Round  38, Global train loss: 0.661, Global test loss: 1.339, Global test accuracy: 54.55
Round  39, Train loss: 0.694, Test loss: 1.041, Test accuracy: 64.48
Round  39, Global train loss: 0.694, Global test loss: 1.529, Global test accuracy: 51.06
Round  40, Train loss: 0.743, Test loss: 1.014, Test accuracy: 65.23
Round  40, Global train loss: 0.743, Global test loss: 1.330, Global test accuracy: 55.51
Round  41, Train loss: 0.756, Test loss: 1.031, Test accuracy: 65.07
Round  41, Global train loss: 0.756, Global test loss: 1.444, Global test accuracy: 52.35
Round  42, Train loss: 0.612, Test loss: 1.034, Test accuracy: 65.13
Round  42, Global train loss: 0.612, Global test loss: 1.374, Global test accuracy: 54.58
Round  43, Train loss: 0.665, Test loss: 1.048, Test accuracy: 64.74
Round  43, Global train loss: 0.665, Global test loss: 1.298, Global test accuracy: 55.53
Round  44, Train loss: 0.728, Test loss: 1.019, Test accuracy: 65.44
Round  44, Global train loss: 0.728, Global test loss: 1.449, Global test accuracy: 53.24
Round  45, Train loss: 0.653, Test loss: 0.998, Test accuracy: 66.39
Round  45, Global train loss: 0.653, Global test loss: 1.279, Global test accuracy: 57.05
Round  46, Train loss: 0.672, Test loss: 0.984, Test accuracy: 66.84
Round  46, Global train loss: 0.672, Global test loss: 1.244, Global test accuracy: 57.99
Round  47, Train loss: 0.685, Test loss: 0.973, Test accuracy: 67.22
Round  47, Global train loss: 0.685, Global test loss: 1.324, Global test accuracy: 54.70
Round  48, Train loss: 0.624, Test loss: 0.971, Test accuracy: 67.21
Round  48, Global train loss: 0.624, Global test loss: 1.346, Global test accuracy: 56.40
Round  49, Train loss: 0.620, Test loss: 0.987, Test accuracy: 67.10
Round  49, Global train loss: 0.620, Global test loss: 1.487, Global test accuracy: 53.08
Round  50, Train loss: 0.500, Test loss: 1.016, Test accuracy: 66.67
Round  50, Global train loss: 0.500, Global test loss: 1.516, Global test accuracy: 54.39
Round  51, Train loss: 0.595, Test loss: 1.003, Test accuracy: 66.61
Round  51, Global train loss: 0.595, Global test loss: 1.354, Global test accuracy: 56.21
Round  52, Train loss: 0.623, Test loss: 0.992, Test accuracy: 66.63
Round  52, Global train loss: 0.623, Global test loss: 1.357, Global test accuracy: 55.90
Round  53, Train loss: 0.671, Test loss: 0.983, Test accuracy: 66.58
Round  53, Global train loss: 0.671, Global test loss: 1.361, Global test accuracy: 55.37
Round  54, Train loss: 0.532, Test loss: 1.004, Test accuracy: 66.23
Round  54, Global train loss: 0.532, Global test loss: 1.408, Global test accuracy: 54.84
Round  55, Train loss: 0.657, Test loss: 1.029, Test accuracy: 65.89
Round  55, Global train loss: 0.657, Global test loss: 1.367, Global test accuracy: 54.97
Round  56, Train loss: 0.520, Test loss: 1.019, Test accuracy: 66.18
Round  56, Global train loss: 0.520, Global test loss: 1.511, Global test accuracy: 56.18
Round  57, Train loss: 0.622, Test loss: 1.021, Test accuracy: 66.26
Round  57, Global train loss: 0.622, Global test loss: 1.283, Global test accuracy: 57.58
Round  58, Train loss: 0.518, Test loss: 1.046, Test accuracy: 66.01
Round  58, Global train loss: 0.518, Global test loss: 1.389, Global test accuracy: 55.72
Round  59, Train loss: 0.554, Test loss: 1.039, Test accuracy: 66.20
Round  59, Global train loss: 0.554, Global test loss: 1.428, Global test accuracy: 55.65
Round  60, Train loss: 0.526, Test loss: 1.034, Test accuracy: 66.73
Round  60, Global train loss: 0.526, Global test loss: 1.289, Global test accuracy: 58.17
Round  61, Train loss: 0.479, Test loss: 1.032, Test accuracy: 66.82
Round  61, Global train loss: 0.479, Global test loss: 1.446, Global test accuracy: 54.93
Round  62, Train loss: 0.499, Test loss: 1.038, Test accuracy: 66.62
Round  62, Global train loss: 0.499, Global test loss: 1.211, Global test accuracy: 59.24
Round  63, Train loss: 0.431, Test loss: 1.035, Test accuracy: 66.84
Round  63, Global train loss: 0.431, Global test loss: 1.215, Global test accuracy: 60.06
Round  64, Train loss: 0.494, Test loss: 1.028, Test accuracy: 67.37
Round  64, Global train loss: 0.494, Global test loss: 1.259, Global test accuracy: 59.07
Round  65, Train loss: 0.518, Test loss: 1.007, Test accuracy: 67.73
Round  65, Global train loss: 0.518, Global test loss: 1.281, Global test accuracy: 58.98
Round  66, Train loss: 0.421, Test loss: 1.017, Test accuracy: 67.90
Round  66, Global train loss: 0.421, Global test loss: 1.485, Global test accuracy: 57.36
Round  67, Train loss: 0.472, Test loss: 1.050, Test accuracy: 67.46
Round  67, Global train loss: 0.472, Global test loss: 1.374, Global test accuracy: 58.24
Round  68, Train loss: 0.438, Test loss: 1.016, Test accuracy: 68.44
Round  68, Global train loss: 0.438, Global test loss: 1.408, Global test accuracy: 57.93
Round  69, Train loss: 0.596, Test loss: 1.022, Test accuracy: 68.33
Round  69, Global train loss: 0.596, Global test loss: 1.508, Global test accuracy: 55.15
Round  70, Train loss: 0.457, Test loss: 1.045, Test accuracy: 68.40
Round  70, Global train loss: 0.457, Global test loss: 1.429, Global test accuracy: 57.80
Round  71, Train loss: 0.435, Test loss: 1.069, Test accuracy: 67.93
Round  71, Global train loss: 0.435, Global test loss: 1.523, Global test accuracy: 57.74
Round  72, Train loss: 0.435, Test loss: 1.033, Test accuracy: 68.77
Round  72, Global train loss: 0.435, Global test loss: 1.387, Global test accuracy: 59.96
Round  73, Train loss: 0.430, Test loss: 1.055, Test accuracy: 68.46
Round  73, Global train loss: 0.430, Global test loss: 1.578, Global test accuracy: 55.34
Round  74, Train loss: 0.521, Test loss: 1.049, Test accuracy: 68.25
Round  74, Global train loss: 0.521, Global test loss: 1.453, Global test accuracy: 56.03
Round  75, Train loss: 0.473, Test loss: 1.081, Test accuracy: 67.58
Round  75, Global train loss: 0.473, Global test loss: 1.507, Global test accuracy: 55.86
Round  76, Train loss: 0.470, Test loss: 1.103, Test accuracy: 67.30
Round  76, Global train loss: 0.470, Global test loss: 1.269, Global test accuracy: 59.58
Round  77, Train loss: 0.523, Test loss: 1.098, Test accuracy: 67.47
Round  77, Global train loss: 0.523, Global test loss: 1.297, Global test accuracy: 58.63
Round  78, Train loss: 0.579, Test loss: 1.077, Test accuracy: 67.89
Round  78, Global train loss: 0.579, Global test loss: 1.431, Global test accuracy: 55.45
Round  79, Train loss: 0.502, Test loss: 1.092, Test accuracy: 67.43
Round  79, Global train loss: 0.502, Global test loss: 1.311, Global test accuracy: 58.31
Round  80, Train loss: 0.410, Test loss: 1.081, Test accuracy: 67.66
Round  80, Global train loss: 0.410, Global test loss: 1.427, Global test accuracy: 55.94
Round  81, Train loss: 0.358, Test loss: 1.056, Test accuracy: 68.35
Round  81, Global train loss: 0.358, Global test loss: 1.365, Global test accuracy: 58.00
Round  82, Train loss: 0.418, Test loss: 1.049, Test accuracy: 69.03
Round  82, Global train loss: 0.418, Global test loss: 1.397, Global test accuracy: 57.78
Round  83, Train loss: 0.474, Test loss: 1.043, Test accuracy: 69.29
Round  83, Global train loss: 0.474, Global test loss: 1.441, Global test accuracy: 57.50
Round  84, Train loss: 0.423, Test loss: 1.052, Test accuracy: 69.13
Round  84, Global train loss: 0.423, Global test loss: 1.507, Global test accuracy: 57.05
Round  85, Train loss: 0.358, Test loss: 1.059, Test accuracy: 68.84
Round  85, Global train loss: 0.358, Global test loss: 1.336, Global test accuracy: 60.19
Round  86, Train loss: 0.383, Test loss: 1.076, Test accuracy: 68.65
Round  86, Global train loss: 0.383, Global test loss: 1.419, Global test accuracy: 58.60
Round  87, Train loss: 0.378, Test loss: 1.061, Test accuracy: 68.80
Round  87, Global train loss: 0.378, Global test loss: 1.256, Global test accuracy: 60.64
Round  88, Train loss: 0.418, Test loss: 1.077, Test accuracy: 68.56
Round  88, Global train loss: 0.418, Global test loss: 1.321, Global test accuracy: 59.59
Round  89, Train loss: 0.459, Test loss: 1.094, Test accuracy: 68.38
Round  89, Global train loss: 0.459, Global test loss: 1.421, Global test accuracy: 58.15
Round  90, Train loss: 0.356, Test loss: 1.098, Test accuracy: 68.64
Round  90, Global train loss: 0.356, Global test loss: 1.376, Global test accuracy: 59.20
Round  91, Train loss: 0.380, Test loss: 1.096, Test accuracy: 68.55
Round  91, Global train loss: 0.380, Global test loss: 1.451, Global test accuracy: 58.22
Round  92, Train loss: 0.514, Test loss: 1.111, Test accuracy: 68.18
Round  92, Global train loss: 0.514, Global test loss: 1.425, Global test accuracy: 58.02
Round  93, Train loss: 0.396, Test loss: 1.141, Test accuracy: 68.19
Round  93, Global train loss: 0.396, Global test loss: 1.411, Global test accuracy: 57.95
Round  94, Train loss: 0.409, Test loss: 1.126, Test accuracy: 68.70
Round  94, Global train loss: 0.409, Global test loss: 1.387, Global test accuracy: 57.73
Round  95, Train loss: 0.379, Test loss: 1.126, Test accuracy: 68.50
Round  95, Global train loss: 0.379, Global test loss: 1.473, Global test accuracy: 59.61
Round  96, Train loss: 0.465, Test loss: 1.143, Test accuracy: 67.71
Round  96, Global train loss: 0.465, Global test loss: 1.498, Global test accuracy: 58.60
Round  97, Train loss: 0.489, Test loss: 1.121, Test accuracy: 68.14
Round  97, Global train loss: 0.489, Global test loss: 1.530, Global test accuracy: 56.31
Round  98, Train loss: 0.414, Test loss: 1.128, Test accuracy: 68.13
Round  98, Global train loss: 0.414, Global test loss: 1.499, Global test accuracy: 58.32
Round  99, Train loss: 0.387, Test loss: 1.152, Test accuracy: 68.28
Round  99, Global train loss: 0.387, Global test loss: 1.329, Global test accuracy: 60.61
Final Round, Train loss: 0.322, Test loss: 1.243, Test accuracy: 67.85
Final Round, Global train loss: 0.322, Global test loss: 1.329, Global test accuracy: 60.61
Average accuracy final 10 rounds: 68.302
Average global accuracy final 10 rounds: 58.457
1853.1801266670227
[2.689704656600952, 5.1378889083862305, 7.610732555389404, 10.09301209449768, 12.5536470413208, 15.028941631317139, 17.496431589126587, 19.976208209991455, 22.447954416275024, 24.91943621635437, 27.379963636398315, 29.860046863555908, 32.34844398498535, 34.817710399627686, 37.27430248260498, 39.72773599624634, 42.214264154434204, 44.7004234790802, 47.178832054138184, 49.65258836746216, 52.131118297576904, 54.60911417007446, 57.08998417854309, 59.562044858932495, 62.033448934555054, 64.49568271636963, 66.95342063903809, 69.4145519733429, 71.55940914154053, 73.70209455490112, 75.85124373435974, 78.074636220932, 80.23893737792969, 82.40252089500427, 84.56843447685242, 86.7241837978363, 88.88527321815491, 91.04818534851074, 93.21689438819885, 95.37463927268982, 97.54071760177612, 99.70090436935425, 101.86661553382874, 104.02311849594116, 106.1827039718628, 108.34337282180786, 110.50850510597229, 112.67408537864685, 114.84270215034485, 117.00340628623962, 119.16293907165527, 121.32841038703918, 123.49768733978271, 125.6623022556305, 127.82937502861023, 129.99462056159973, 132.15670323371887, 134.31797885894775, 136.48333168029785, 138.6483871936798, 140.8125340938568, 142.98060202598572, 145.14969277381897, 147.31616711616516, 149.48067593574524, 151.64378714561462, 153.80570125579834, 155.96847486495972, 158.13600611686707, 160.30597376823425, 162.46829891204834, 164.6361517906189, 166.8022882938385, 168.9653196334839, 171.13215017318726, 173.2935402393341, 175.454660654068, 177.61906504631042, 179.78329992294312, 181.94775533676147, 184.1103174686432, 186.27720427513123, 188.43713998794556, 190.6034665107727, 192.77299857139587, 194.934828042984, 197.09757041931152, 199.25892615318298, 201.423433303833, 203.58619785308838, 205.75304985046387, 207.91720151901245, 210.0792257785797, 212.23989009857178, 214.39589595794678, 216.55431747436523, 218.714581489563, 220.8801715373993, 223.04070258140564, 225.19983911514282, 229.0757131576538]
[25.29, 29.35, 36.95, 40.32, 44.38, 47.34, 49.45, 49.84, 52.37, 54.57, 54.86, 55.65, 57.54, 58.01, 58.67, 58.97, 59.32, 58.96, 59.48, 60.01, 59.71, 59.59, 60.98, 61.48, 61.98, 62.4, 63.36, 63.88, 64.36, 63.8, 64.0, 64.15, 64.24, 63.86, 64.59, 64.85, 64.88, 64.53, 64.57, 64.48, 65.23, 65.07, 65.13, 64.74, 65.44, 66.39, 66.84, 67.22, 67.21, 67.1, 66.67, 66.61, 66.63, 66.58, 66.23, 65.89, 66.18, 66.26, 66.01, 66.2, 66.73, 66.82, 66.62, 66.84, 67.37, 67.73, 67.9, 67.46, 68.44, 68.33, 68.4, 67.93, 68.77, 68.46, 68.25, 67.58, 67.3, 67.47, 67.89, 67.43, 67.66, 68.35, 69.03, 69.29, 69.13, 68.84, 68.65, 68.8, 68.56, 68.38, 68.64, 68.55, 68.18, 68.19, 68.7, 68.5, 67.71, 68.14, 68.13, 68.28, 67.85]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  16.7300
Round 1 global test acc  18.0000
Round 2 global test acc  22.3500
Round 3 global test acc  24.1400
Round 4 global test acc  26.2900
Round 5 global test acc  27.9300
Round 6 global test acc  25.0100
Round 7 global test acc  27.0900
Round 8 global test acc  28.2300
Round 9 global test acc  27.3100
Round 10 global test acc  31.4700
Round 11 global test acc  25.5600
Round 12 global test acc  31.5200
Round 13 global test acc  33.2400
Round 14 global test acc  26.7500
Round 15 global test acc  31.0100
Round 16 global test acc  31.5500
Round 17 global test acc  29.7900
Round 18 global test acc  30.0100
Round 19 global test acc  44.3900
Round 20 global test acc  40.5300
Round 21 global test acc  33.0500
Round 22 global test acc  31.6100
Round 23 global test acc  33.3300
Round 24 global test acc  36.8700
Round 25 global test acc  42.9800
Round 26 global test acc  29.6500
Round 27 global test acc  38.9900
Round 28 global test acc  30.6400
Round 29 global test acc  38.7400
Round 30 global test acc  41.7800
Round 31 global test acc  40.9200
Round 32 global test acc  41.6700
Round 33 global test acc  36.9000
Round 34 global test acc  41.0600
Round 35 global test acc  34.8200
Round 36 global test acc  41.4700
Round 37 global test acc  35.2500
Round 38 global test acc  38.3600
Round 39 global test acc  36.2600
Round 40 global test acc  46.1200
Round 41 global test acc  36.7200
Round 42 global test acc  35.0100
Round 43 global test acc  40.2600
Round 44 global test acc  36.0200
Round 45 global test acc  36.5000
Round 46 global test acc  37.1400
Round 47 global test acc  38.0800
Round 48 global test acc  40.4000
Round 49 global test acc  39.9900
Round 50 global test acc  38.9500
Round 51 global test acc  42.7700
Round 52 global test acc  35.2100
Round 53 global test acc  39.3700
Round 54 global test acc  35.0100
Round 55 global test acc  50.0500
Round 56 global test acc  43.0500
Round 57 global test acc  36.0300
Round 58 global test acc  48.6800
Round 59 global test acc  43.4800
Round 60 global test acc  46.2300
Round 61 global test acc  40.2300
Round 62 global test acc  38.6000
Round 63 global test acc  37.7900
Round 64 global test acc  36.7500
Round 65 global test acc  37.4600
Round 66 global test acc  44.1100
Round 67 global test acc  44.4100
Round 68 global test acc  41.0300
Round 69 global test acc  55.4300
Round 70 global test acc  42.8900
Round 71 global test acc  49.3500
Round 72 global test acc  45.0100
Round 73 global test acc  42.4900
Round 74 global test acc  44.0700
Round 75 global test acc  44.8000
Round 76 global test acc  45.6200
Round 77 global test acc  44.1900
Round 78 global test acc  37.8100
Round 79 global test acc  43.5300
Round 80 global test acc  40.7900
Round 81 global test acc  36.1600
Round 82 global test acc  33.0700
Round 83 global test acc  31.9600
Round 84 global test acc  31.7700
Round 85 global test acc  30.1600
Round 86 global test acc  28.4300
Round 87 global test acc  27.9200
Round 88 global test acc  27.8900
Round 89 global test acc  28.4200
Round 90 global test acc  27.9400
Round 91 global test acc  28.2600
Round 92 global test acc  27.4900
Round 93 global test acc  27.5000
Round 94 global test acc  28.1100
Round 95 global test acc  28.9800
Round 96 global test acc  29.8000
Round 97 global test acc  29.0200
Round 98 global test acc  28.8700
Round 99 global test acc  28.9700
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.959, Test loss: 2.103, Test accuracy: 24.96
Round   1, Train loss: 1.494, Test loss: 1.992, Test accuracy: 29.97
Round   2, Train loss: 1.509, Test loss: 1.674, Test accuracy: 36.00
Round   3, Train loss: 1.379, Test loss: 1.579, Test accuracy: 41.79
Round   4, Train loss: 1.288, Test loss: 1.400, Test accuracy: 46.59
Round   5, Train loss: 1.223, Test loss: 1.253, Test accuracy: 50.32
Round   6, Train loss: 1.223, Test loss: 1.267, Test accuracy: 51.41
Round   7, Train loss: 1.132, Test loss: 1.278, Test accuracy: 51.15
Round   8, Train loss: 1.216, Test loss: 1.235, Test accuracy: 51.73
Round   9, Train loss: 1.237, Test loss: 1.144, Test accuracy: 55.93
Round  10, Train loss: 1.100, Test loss: 1.092, Test accuracy: 56.89
Round  11, Train loss: 1.146, Test loss: 1.103, Test accuracy: 58.06
Round  12, Train loss: 1.066, Test loss: 1.013, Test accuracy: 60.46
Round  13, Train loss: 1.062, Test loss: 0.990, Test accuracy: 61.55
Round  14, Train loss: 0.984, Test loss: 0.984, Test accuracy: 61.59
Round  15, Train loss: 1.033, Test loss: 0.967, Test accuracy: 63.09
Round  16, Train loss: 0.947, Test loss: 0.954, Test accuracy: 64.09
Round  17, Train loss: 0.986, Test loss: 0.955, Test accuracy: 63.62
Round  18, Train loss: 0.895, Test loss: 0.923, Test accuracy: 64.15
Round  19, Train loss: 1.004, Test loss: 0.922, Test accuracy: 64.72
Round  20, Train loss: 0.901, Test loss: 0.898, Test accuracy: 65.57
Round  21, Train loss: 0.915, Test loss: 0.909, Test accuracy: 65.51
Round  22, Train loss: 0.890, Test loss: 0.898, Test accuracy: 65.69
Round  23, Train loss: 0.885, Test loss: 0.886, Test accuracy: 65.81
Round  24, Train loss: 0.908, Test loss: 0.874, Test accuracy: 66.23
Round  25, Train loss: 0.930, Test loss: 0.883, Test accuracy: 66.06
Round  26, Train loss: 0.886, Test loss: 0.857, Test accuracy: 66.82
Round  27, Train loss: 0.873, Test loss: 0.847, Test accuracy: 66.99
Round  28, Train loss: 0.818, Test loss: 0.860, Test accuracy: 66.86
Round  29, Train loss: 0.885, Test loss: 0.856, Test accuracy: 67.36
Round  30, Train loss: 0.751, Test loss: 0.824, Test accuracy: 68.25
Round  31, Train loss: 0.809, Test loss: 0.823, Test accuracy: 68.35
Round  32, Train loss: 0.858, Test loss: 0.821, Test accuracy: 68.29
Round  33, Train loss: 0.833, Test loss: 0.802, Test accuracy: 69.48
Round  34, Train loss: 0.756, Test loss: 0.796, Test accuracy: 69.67
Round  35, Train loss: 0.769, Test loss: 0.793, Test accuracy: 69.60
Round  36, Train loss: 0.773, Test loss: 0.803, Test accuracy: 69.42
Round  37, Train loss: 0.757, Test loss: 0.800, Test accuracy: 68.96
Round  38, Train loss: 0.715, Test loss: 0.791, Test accuracy: 69.08
Round  39, Train loss: 0.758, Test loss: 0.778, Test accuracy: 69.61
Round  40, Train loss: 0.755, Test loss: 0.777, Test accuracy: 69.79
Round  41, Train loss: 0.757, Test loss: 0.769, Test accuracy: 70.35
Round  42, Train loss: 0.676, Test loss: 0.775, Test accuracy: 70.06
Round  43, Train loss: 0.663, Test loss: 0.771, Test accuracy: 70.50
Round  44, Train loss: 0.734, Test loss: 0.765, Test accuracy: 70.95
Round  45, Train loss: 0.658, Test loss: 0.768, Test accuracy: 70.28
Round  46, Train loss: 0.724, Test loss: 0.775, Test accuracy: 70.32
Round  47, Train loss: 0.761, Test loss: 0.754, Test accuracy: 70.97
Round  48, Train loss: 0.700, Test loss: 0.758, Test accuracy: 70.82
Round  49, Train loss: 0.738, Test loss: 0.761, Test accuracy: 71.09
Round  50, Train loss: 0.667, Test loss: 0.752, Test accuracy: 71.04
Round  51, Train loss: 0.649, Test loss: 0.759, Test accuracy: 71.05
Round  52, Train loss: 0.662, Test loss: 0.752, Test accuracy: 71.47
Round  53, Train loss: 0.717, Test loss: 0.747, Test accuracy: 71.67
Round  54, Train loss: 0.662, Test loss: 0.735, Test accuracy: 71.76
Round  55, Train loss: 0.644, Test loss: 0.739, Test accuracy: 71.52
Round  56, Train loss: 0.636, Test loss: 0.742, Test accuracy: 71.61
Round  57, Train loss: 0.720, Test loss: 0.736, Test accuracy: 72.06
Round  58, Train loss: 0.634, Test loss: 0.732, Test accuracy: 72.10
Round  59, Train loss: 0.630, Test loss: 0.732, Test accuracy: 71.97
Round  60, Train loss: 0.575, Test loss: 0.734, Test accuracy: 71.60
Round  61, Train loss: 0.510, Test loss: 0.722, Test accuracy: 71.92
Round  62, Train loss: 0.579, Test loss: 0.721, Test accuracy: 72.35
Round  63, Train loss: 0.567, Test loss: 0.720, Test accuracy: 72.23
Round  64, Train loss: 0.613, Test loss: 0.720, Test accuracy: 72.63
Round  65, Train loss: 0.581, Test loss: 0.724, Test accuracy: 72.63
Round  66, Train loss: 0.545, Test loss: 0.719, Test accuracy: 72.88
Round  67, Train loss: 0.534, Test loss: 0.728, Test accuracy: 72.13
Round  68, Train loss: 0.510, Test loss: 0.724, Test accuracy: 73.00
Round  69, Train loss: 0.638, Test loss: 0.712, Test accuracy: 72.86
Round  70, Train loss: 0.589, Test loss: 0.716, Test accuracy: 72.93
Round  71, Train loss: 0.593, Test loss: 0.717, Test accuracy: 73.02
Round  72, Train loss: 0.494, Test loss: 0.711, Test accuracy: 72.88
Round  73, Train loss: 0.491, Test loss: 0.709, Test accuracy: 72.90
Round  74, Train loss: 0.557, Test loss: 0.708, Test accuracy: 73.73
Round  75, Train loss: 0.560, Test loss: 0.698, Test accuracy: 73.93
Round  76, Train loss: 0.630, Test loss: 0.706, Test accuracy: 73.73
Round  77, Train loss: 0.571, Test loss: 0.705, Test accuracy: 73.66
Round  78, Train loss: 0.565, Test loss: 0.698, Test accuracy: 73.65
Round  79, Train loss: 0.572, Test loss: 0.702, Test accuracy: 74.17
Round  80, Train loss: 0.461, Test loss: 0.708, Test accuracy: 73.34
Round  81, Train loss: 0.481, Test loss: 0.705, Test accuracy: 73.61
Round  82, Train loss: 0.517, Test loss: 0.700, Test accuracy: 73.85
Round  83, Train loss: 0.562, Test loss: 0.711, Test accuracy: 73.59
Round  84, Train loss: 0.547, Test loss: 0.707, Test accuracy: 73.61
Round  85, Train loss: 0.481, Test loss: 0.708, Test accuracy: 73.63
Round  86, Train loss: 0.476, Test loss: 0.717, Test accuracy: 73.33
Round  87, Train loss: 0.498, Test loss: 0.700, Test accuracy: 74.04
Round  88, Train loss: 0.470, Test loss: 0.710, Test accuracy: 74.16
Round  89, Train loss: 0.525, Test loss: 0.706, Test accuracy: 73.96
Round  90, Train loss: 0.444, Test loss: 0.700, Test accuracy: 74.16
Round  91, Train loss: 0.452, Test loss: 0.701, Test accuracy: 74.36
Round  92, Train loss: 0.544, Test loss: 0.705, Test accuracy: 73.86
Round  93, Train loss: 0.454, Test loss: 0.701, Test accuracy: 73.77
Round  94, Train loss: 0.425, Test loss: 0.703, Test accuracy: 74.07
Round  95, Train loss: 0.467, Test loss: 0.704, Test accuracy: 73.90
Round  96, Train loss: 0.522, Test loss: 0.706, Test accuracy: 74.06
Round  97, Train loss: 0.514, Test loss: 0.699, Test accuracy: 73.91
Round  98, Train loss: 0.506, Test loss: 0.705, Test accuracy: 74.24
Round  99, Train loss: 0.459, Test loss: 0.703, Test accuracy: 74.14
Final Round, Train loss: 0.402, Test loss: 0.716, Test accuracy: 73.83
Average accuracy final 10 rounds: 74.047
919.3540744781494
[1.493476390838623, 2.6882874965667725, 3.886901378631592, 5.088866472244263, 6.3334715366363525, 7.57979941368103, 8.82982587814331, 10.087937116622925, 11.338369846343994, 12.598877191543579, 13.852458477020264, 15.103370189666748, 16.348626613616943, 17.594366550445557, 18.852027893066406, 20.10826802253723, 21.211733102798462, 22.31450057029724, 23.414297103881836, 24.512988328933716, 25.61505436897278, 26.713517665863037, 27.817322731018066, 28.926309823989868, 30.028250455856323, 31.14061403274536, 32.25148248672485, 33.35504961013794, 34.45196223258972, 35.551836252212524, 36.64791941642761, 37.761677503585815, 38.857099294662476, 39.95685386657715, 41.05179452896118, 42.15170121192932, 43.263362407684326, 44.361611127853394, 45.45804476737976, 46.55336260795593, 47.64690017700195, 48.74322295188904, 49.84107708930969, 50.952845096588135, 52.06037354469299, 53.16076064109802, 54.26060128211975, 55.35905575752258, 56.455605030059814, 57.55454134941101, 58.648590087890625, 59.74720025062561, 60.84649157524109, 61.95254302024841, 63.061808586120605, 64.17300748825073, 65.27859807014465, 66.37791776657104, 67.47847485542297, 68.57413291931152, 69.67573237419128, 70.77824640274048, 71.88330078125, 72.9887866973877, 74.0823426246643, 75.17524909973145, 76.27893304824829, 77.38783550262451, 78.48481726646423, 79.58033418655396, 80.68119764328003, 81.7867124080658, 82.89559245109558, 84.00825548171997, 85.10939764976501, 86.21085453033447, 87.31335091590881, 88.42000007629395, 89.5296802520752, 90.63471293449402, 91.74422359466553, 92.85356163978577, 93.96016097068787, 95.07175707817078, 96.17887854576111, 97.29007863998413, 98.39987373352051, 99.51043057441711, 100.60084891319275, 101.70454406738281, 102.79569840431213, 103.8959653377533, 105.00132989883423, 106.11010956764221, 107.20857739448547, 108.31949543952942, 109.41326141357422, 110.5102219581604, 111.60962247848511, 112.70843696594238, 114.53561663627625]
[24.96, 29.97, 36.0, 41.79, 46.59, 50.32, 51.41, 51.15, 51.73, 55.93, 56.89, 58.06, 60.46, 61.55, 61.59, 63.09, 64.09, 63.62, 64.15, 64.72, 65.57, 65.51, 65.69, 65.81, 66.23, 66.06, 66.82, 66.99, 66.86, 67.36, 68.25, 68.35, 68.29, 69.48, 69.67, 69.6, 69.42, 68.96, 69.08, 69.61, 69.79, 70.35, 70.06, 70.5, 70.95, 70.28, 70.32, 70.97, 70.82, 71.09, 71.04, 71.05, 71.47, 71.67, 71.76, 71.52, 71.61, 72.06, 72.1, 71.97, 71.6, 71.92, 72.35, 72.23, 72.63, 72.63, 72.88, 72.13, 73.0, 72.86, 72.93, 73.02, 72.88, 72.9, 73.73, 73.93, 73.73, 73.66, 73.65, 74.17, 73.34, 73.61, 73.85, 73.59, 73.61, 73.63, 73.33, 74.04, 74.16, 73.96, 74.16, 74.36, 73.86, 73.77, 74.07, 73.9, 74.06, 73.91, 74.24, 74.14, 73.83]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.701, Test loss: 2.087, Test accuracy: 25.26
Round   0, Global train loss: 1.701, Global test loss: 2.260, Global test accuracy: 22.51
Round   1, Train loss: 1.431, Test loss: 1.940, Test accuracy: 30.05
Round   1, Global train loss: 1.431, Global test loss: 2.326, Global test accuracy: 24.33
Round   2, Train loss: 1.462, Test loss: 1.593, Test accuracy: 37.09
Round   2, Global train loss: 1.462, Global test loss: 2.006, Global test accuracy: 27.86
Round   3, Train loss: 1.397, Test loss: 1.501, Test accuracy: 42.17
Round   3, Global train loss: 1.397, Global test loss: 1.937, Global test accuracy: 35.37
Round   4, Train loss: 1.283, Test loss: 1.352, Test accuracy: 47.14
Round   4, Global train loss: 1.283, Global test loss: 1.866, Global test accuracy: 34.66
Round   5, Train loss: 1.292, Test loss: 1.278, Test accuracy: 48.25
Round   5, Global train loss: 1.292, Global test loss: 1.683, Global test accuracy: 40.46
Round   6, Train loss: 1.172, Test loss: 1.261, Test accuracy: 50.27
Round   6, Global train loss: 1.172, Global test loss: 1.851, Global test accuracy: 34.32
Round   7, Train loss: 1.055, Test loss: 1.251, Test accuracy: 50.17
Round   7, Global train loss: 1.055, Global test loss: 1.730, Global test accuracy: 34.35
Round   8, Train loss: 1.194, Test loss: 1.197, Test accuracy: 53.48
Round   8, Global train loss: 1.194, Global test loss: 1.656, Global test accuracy: 41.81
Round   9, Train loss: 1.155, Test loss: 1.156, Test accuracy: 55.25
Round   9, Global train loss: 1.155, Global test loss: 1.674, Global test accuracy: 41.48
Round  10, Train loss: 1.148, Test loss: 1.109, Test accuracy: 56.36
Round  10, Global train loss: 1.148, Global test loss: 1.552, Global test accuracy: 45.76
Round  11, Train loss: 1.080, Test loss: 1.125, Test accuracy: 56.66
Round  11, Global train loss: 1.080, Global test loss: 1.717, Global test accuracy: 40.48
Round  12, Train loss: 1.072, Test loss: 1.043, Test accuracy: 59.53
Round  12, Global train loss: 1.072, Global test loss: 1.531, Global test accuracy: 43.80
Round  13, Train loss: 0.993, Test loss: 1.038, Test accuracy: 59.85
Round  13, Global train loss: 0.993, Global test loss: 1.594, Global test accuracy: 44.11
Round  14, Train loss: 1.037, Test loss: 1.047, Test accuracy: 59.72
Round  14, Global train loss: 1.037, Global test loss: 1.494, Global test accuracy: 45.87
Round  15, Train loss: 1.004, Test loss: 1.023, Test accuracy: 60.78
Round  15, Global train loss: 1.004, Global test loss: 1.575, Global test accuracy: 43.60
Round  16, Train loss: 0.879, Test loss: 1.013, Test accuracy: 61.20
Round  16, Global train loss: 0.879, Global test loss: 1.352, Global test accuracy: 51.69
Round  17, Train loss: 1.055, Test loss: 1.008, Test accuracy: 60.91
Round  17, Global train loss: 1.055, Global test loss: 1.430, Global test accuracy: 51.35
Round  18, Train loss: 0.850, Test loss: 1.007, Test accuracy: 61.08
Round  18, Global train loss: 0.850, Global test loss: 1.470, Global test accuracy: 47.86
Round  19, Train loss: 0.894, Test loss: 0.988, Test accuracy: 62.13
Round  19, Global train loss: 0.894, Global test loss: 1.515, Global test accuracy: 47.43
Round  20, Train loss: 0.822, Test loss: 0.975, Test accuracy: 62.75
Round  20, Global train loss: 0.822, Global test loss: 1.555, Global test accuracy: 48.42
Round  21, Train loss: 0.915, Test loss: 0.974, Test accuracy: 63.37
Round  21, Global train loss: 0.915, Global test loss: 1.438, Global test accuracy: 47.42
Round  22, Train loss: 0.872, Test loss: 0.950, Test accuracy: 64.61
Round  22, Global train loss: 0.872, Global test loss: 1.465, Global test accuracy: 47.50
Round  23, Train loss: 0.891, Test loss: 0.946, Test accuracy: 65.01
Round  23, Global train loss: 0.891, Global test loss: 1.446, Global test accuracy: 49.69
Round  24, Train loss: 0.822, Test loss: 0.948, Test accuracy: 65.08
Round  24, Global train loss: 0.822, Global test loss: 1.524, Global test accuracy: 46.98
Round  25, Train loss: 0.882, Test loss: 0.967, Test accuracy: 64.45
Round  25, Global train loss: 0.882, Global test loss: 1.335, Global test accuracy: 53.28
Round  26, Train loss: 0.798, Test loss: 0.961, Test accuracy: 64.74
Round  26, Global train loss: 0.798, Global test loss: 1.364, Global test accuracy: 51.97
Round  27, Train loss: 0.748, Test loss: 0.939, Test accuracy: 65.58
Round  27, Global train loss: 0.748, Global test loss: 1.410, Global test accuracy: 50.60
Round  28, Train loss: 0.733, Test loss: 0.944, Test accuracy: 65.42
Round  28, Global train loss: 0.733, Global test loss: 1.250, Global test accuracy: 55.68
Round  29, Train loss: 0.832, Test loss: 0.942, Test accuracy: 65.01
Round  29, Global train loss: 0.832, Global test loss: 1.304, Global test accuracy: 53.81
Round  30, Train loss: 0.694, Test loss: 0.945, Test accuracy: 64.87
Round  30, Global train loss: 0.694, Global test loss: 1.480, Global test accuracy: 48.88
Round  31, Train loss: 0.809, Test loss: 0.917, Test accuracy: 66.09
Round  31, Global train loss: 0.809, Global test loss: 1.315, Global test accuracy: 53.83
Round  32, Train loss: 0.761, Test loss: 0.921, Test accuracy: 66.07
Round  32, Global train loss: 0.761, Global test loss: 1.382, Global test accuracy: 52.64
Round  33, Train loss: 0.756, Test loss: 0.921, Test accuracy: 66.60
Round  33, Global train loss: 0.756, Global test loss: 1.215, Global test accuracy: 57.69
Round  34, Train loss: 0.805, Test loss: 0.938, Test accuracy: 66.03
Round  34, Global train loss: 0.805, Global test loss: 1.305, Global test accuracy: 55.50
Round  35, Train loss: 0.727, Test loss: 0.941, Test accuracy: 65.92
Round  35, Global train loss: 0.727, Global test loss: 1.235, Global test accuracy: 56.98
Round  36, Train loss: 0.746, Test loss: 0.937, Test accuracy: 65.82
Round  36, Global train loss: 0.746, Global test loss: 1.272, Global test accuracy: 57.11
Round  37, Train loss: 0.745, Test loss: 0.963, Test accuracy: 65.62
Round  37, Global train loss: 0.745, Global test loss: 1.365, Global test accuracy: 55.55
Round  38, Train loss: 0.701, Test loss: 0.960, Test accuracy: 65.49
Round  38, Global train loss: 0.701, Global test loss: 1.220, Global test accuracy: 57.53
Round  39, Train loss: 0.608, Test loss: 0.939, Test accuracy: 66.30
Round  39, Global train loss: 0.608, Global test loss: 1.456, Global test accuracy: 54.61
Round  40, Train loss: 0.607, Test loss: 0.947, Test accuracy: 66.18
Round  40, Global train loss: 0.607, Global test loss: 1.193, Global test accuracy: 59.08
Round  41, Train loss: 0.699, Test loss: 0.958, Test accuracy: 66.05
Round  41, Global train loss: 0.699, Global test loss: 1.246, Global test accuracy: 56.38
Round  42, Train loss: 0.638, Test loss: 0.949, Test accuracy: 66.45
Round  42, Global train loss: 0.638, Global test loss: 1.289, Global test accuracy: 56.65
Round  43, Train loss: 0.697, Test loss: 0.963, Test accuracy: 65.96
Round  43, Global train loss: 0.697, Global test loss: 1.219, Global test accuracy: 58.13
Round  44, Train loss: 0.727, Test loss: 0.960, Test accuracy: 66.80
Round  44, Global train loss: 0.727, Global test loss: 1.342, Global test accuracy: 54.91
Round  45, Train loss: 0.643, Test loss: 0.956, Test accuracy: 66.71
Round  45, Global train loss: 0.643, Global test loss: 1.328, Global test accuracy: 54.51
Round  46, Train loss: 0.656, Test loss: 0.947, Test accuracy: 67.28
Round  46, Global train loss: 0.656, Global test loss: 1.224, Global test accuracy: 57.58
Round  47, Train loss: 0.628, Test loss: 0.940, Test accuracy: 67.89
Round  47, Global train loss: 0.628, Global test loss: 1.298, Global test accuracy: 56.74
Round  48, Train loss: 0.673, Test loss: 0.928, Test accuracy: 67.82
Round  48, Global train loss: 0.673, Global test loss: 1.316, Global test accuracy: 56.17
Round  49, Train loss: 0.664, Test loss: 0.946, Test accuracy: 67.66
Round  49, Global train loss: 0.664, Global test loss: 1.370, Global test accuracy: 54.65
Round  50, Train loss: 0.509, Test loss: 0.974, Test accuracy: 67.03
Round  50, Global train loss: 0.509, Global test loss: 1.512, Global test accuracy: 54.07
Round  51, Train loss: 0.708, Test loss: 0.980, Test accuracy: 66.98
Round  51, Global train loss: 0.708, Global test loss: 1.188, Global test accuracy: 59.25
Round  52, Train loss: 0.634, Test loss: 1.007, Test accuracy: 66.63
Round  52, Global train loss: 0.634, Global test loss: 1.370, Global test accuracy: 55.15
Round  53, Train loss: 0.569, Test loss: 0.991, Test accuracy: 67.16
Round  53, Global train loss: 0.569, Global test loss: 1.361, Global test accuracy: 57.12
Round  54, Train loss: 0.540, Test loss: 0.999, Test accuracy: 67.22
Round  54, Global train loss: 0.540, Global test loss: 1.270, Global test accuracy: 57.37
Round  55, Train loss: 0.582, Test loss: 0.976, Test accuracy: 68.02
Round  55, Global train loss: 0.582, Global test loss: 1.227, Global test accuracy: 58.65
Round  56, Train loss: 0.476, Test loss: 0.977, Test accuracy: 68.02
Round  56, Global train loss: 0.476, Global test loss: 1.449, Global test accuracy: 57.46
Round  57, Train loss: 0.559, Test loss: 0.977, Test accuracy: 68.10
Round  57, Global train loss: 0.559, Global test loss: 1.240, Global test accuracy: 58.55
Round  58, Train loss: 0.502, Test loss: 0.982, Test accuracy: 68.14
Round  58, Global train loss: 0.502, Global test loss: 1.353, Global test accuracy: 56.73
Round  59, Train loss: 0.596, Test loss: 0.976, Test accuracy: 68.16
Round  59, Global train loss: 0.596, Global test loss: 1.330, Global test accuracy: 56.38
Round  60, Train loss: 0.576, Test loss: 0.964, Test accuracy: 68.44
Round  60, Global train loss: 0.576, Global test loss: 1.311, Global test accuracy: 56.86
Round  61, Train loss: 0.481, Test loss: 0.964, Test accuracy: 68.72
Round  61, Global train loss: 0.481, Global test loss: 1.340, Global test accuracy: 57.58
Round  62, Train loss: 0.540, Test loss: 0.975, Test accuracy: 68.81
Round  62, Global train loss: 0.540, Global test loss: 1.239, Global test accuracy: 59.51
Round  63, Train loss: 0.422, Test loss: 0.977, Test accuracy: 68.79
Round  63, Global train loss: 0.422, Global test loss: 1.203, Global test accuracy: 61.42
Round  64, Train loss: 0.641, Test loss: 0.994, Test accuracy: 68.28
Round  64, Global train loss: 0.641, Global test loss: 1.227, Global test accuracy: 60.53
Round  65, Train loss: 0.436, Test loss: 0.987, Test accuracy: 68.42
Round  65, Global train loss: 0.436, Global test loss: 1.252, Global test accuracy: 60.11
Round  66, Train loss: 0.435, Test loss: 0.977, Test accuracy: 68.41
Round  66, Global train loss: 0.435, Global test loss: 1.371, Global test accuracy: 58.92
Round  67, Train loss: 0.439, Test loss: 0.973, Test accuracy: 68.98
Round  67, Global train loss: 0.439, Global test loss: 1.263, Global test accuracy: 60.79
Round  68, Train loss: 0.414, Test loss: 0.993, Test accuracy: 68.65
Round  68, Global train loss: 0.414, Global test loss: 1.400, Global test accuracy: 58.60
Round  69, Train loss: 0.567, Test loss: 0.996, Test accuracy: 68.87
Round  69, Global train loss: 0.567, Global test loss: 1.443, Global test accuracy: 55.48
Round  70, Train loss: 0.489, Test loss: 0.998, Test accuracy: 68.92
Round  70, Global train loss: 0.489, Global test loss: 1.297, Global test accuracy: 58.95
Round  71, Train loss: 0.487, Test loss: 1.012, Test accuracy: 68.60
Round  71, Global train loss: 0.487, Global test loss: 1.392, Global test accuracy: 57.21
Round  72, Train loss: 0.409, Test loss: 1.029, Test accuracy: 68.15
Round  72, Global train loss: 0.409, Global test loss: 1.393, Global test accuracy: 57.76
Round  73, Train loss: 0.393, Test loss: 1.027, Test accuracy: 68.49
Round  73, Global train loss: 0.393, Global test loss: 1.415, Global test accuracy: 58.28
Round  74, Train loss: 0.461, Test loss: 1.027, Test accuracy: 68.51
Round  74, Global train loss: 0.461, Global test loss: 1.367, Global test accuracy: 58.37
Round  75, Train loss: 0.413, Test loss: 1.032, Test accuracy: 68.56
Round  75, Global train loss: 0.413, Global test loss: 1.338, Global test accuracy: 60.21
Round  76, Train loss: 0.502, Test loss: 1.027, Test accuracy: 68.84
Round  76, Global train loss: 0.502, Global test loss: 1.305, Global test accuracy: 58.88
Round  77, Train loss: 0.486, Test loss: 1.019, Test accuracy: 68.71
Round  77, Global train loss: 0.486, Global test loss: 1.222, Global test accuracy: 61.00
Round  78, Train loss: 0.475, Test loss: 1.043, Test accuracy: 68.27
Round  78, Global train loss: 0.475, Global test loss: 1.328, Global test accuracy: 58.98
Round  79, Train loss: 0.446, Test loss: 1.066, Test accuracy: 67.87
Round  79, Global train loss: 0.446, Global test loss: 1.295, Global test accuracy: 59.66
Round  80, Train loss: 0.433, Test loss: 1.031, Test accuracy: 68.58
Round  80, Global train loss: 0.433, Global test loss: 1.305, Global test accuracy: 59.27
Round  81, Train loss: 0.396, Test loss: 1.066, Test accuracy: 68.27
Round  81, Global train loss: 0.396, Global test loss: 1.314, Global test accuracy: 59.40
Round  82, Train loss: 0.386, Test loss: 1.098, Test accuracy: 67.79
Round  82, Global train loss: 0.386, Global test loss: 1.369, Global test accuracy: 59.33
Round  83, Train loss: 0.438, Test loss: 1.083, Test accuracy: 68.02
Round  83, Global train loss: 0.438, Global test loss: 1.417, Global test accuracy: 59.02
Round  84, Train loss: 0.507, Test loss: 1.057, Test accuracy: 68.73
Round  84, Global train loss: 0.507, Global test loss: 1.337, Global test accuracy: 59.41
Round  85, Train loss: 0.373, Test loss: 1.077, Test accuracy: 68.62
Round  85, Global train loss: 0.373, Global test loss: 1.233, Global test accuracy: 61.84
Round  86, Train loss: 0.466, Test loss: 1.107, Test accuracy: 67.90
Round  86, Global train loss: 0.466, Global test loss: 1.429, Global test accuracy: 58.25
Round  87, Train loss: 0.399, Test loss: 1.115, Test accuracy: 68.15
Round  87, Global train loss: 0.399, Global test loss: 1.320, Global test accuracy: 59.82
Round  88, Train loss: 0.377, Test loss: 1.097, Test accuracy: 68.40
Round  88, Global train loss: 0.377, Global test loss: 1.278, Global test accuracy: 60.54
Round  89, Train loss: 0.394, Test loss: 1.084, Test accuracy: 68.68
Round  89, Global train loss: 0.394, Global test loss: 1.412, Global test accuracy: 59.06
Round  90, Train loss: 0.357, Test loss: 1.097, Test accuracy: 68.33
Round  90, Global train loss: 0.357, Global test loss: 1.320, Global test accuracy: 60.55
Round  91, Train loss: 0.321, Test loss: 1.096, Test accuracy: 68.39
Round  91, Global train loss: 0.321, Global test loss: 1.414, Global test accuracy: 59.36
Round  92, Train loss: 0.483, Test loss: 1.095, Test accuracy: 68.78
Round  92, Global train loss: 0.483, Global test loss: 1.325, Global test accuracy: 61.12
Round  93, Train loss: 0.395, Test loss: 1.087, Test accuracy: 69.18
Round  93, Global train loss: 0.395, Global test loss: 1.418, Global test accuracy: 57.46
Round  94, Train loss: 0.377, Test loss: 1.052, Test accuracy: 69.39
Round  94, Global train loss: 0.377, Global test loss: 1.412, Global test accuracy: 58.47
Round  95, Train loss: 0.368, Test loss: 1.071, Test accuracy: 69.27
Round  95, Global train loss: 0.368, Global test loss: 1.394, Global test accuracy: 60.29
Round  96, Train loss: 0.494, Test loss: 1.074, Test accuracy: 69.04
Round  96, Global train loss: 0.494, Global test loss: 1.394, Global test accuracy: 58.82
Round  97, Train loss: 0.489, Test loss: 1.081, Test accuracy: 68.86
Round  97, Global train loss: 0.489, Global test loss: 1.373, Global test accuracy: 59.90
Round  98, Train loss: 0.411, Test loss: 1.102, Test accuracy: 69.11
Round  98, Global train loss: 0.411, Global test loss: 1.462, Global test accuracy: 58.69
Round  99, Train loss: 0.380, Test loss: 1.108, Test accuracy: 68.96
Round  99, Global train loss: 0.380, Global test loss: 1.308, Global test accuracy: 61.64
Final Round, Train loss: 0.307, Test loss: 1.219, Test accuracy: 69.10
Final Round, Global train loss: 0.307, Global test loss: 1.308, Global test accuracy: 61.64
Average accuracy final 10 rounds: 68.93100000000001
Average global accuracy final 10 rounds: 59.63000000000001
1690.7167239189148
[1.3834013938903809, 2.514193534851074, 3.6463756561279297, 4.782185316085815, 5.916773080825806, 7.057433366775513, 8.195784330368042, 9.334591388702393, 10.467926740646362, 11.60457968711853, 12.74063777923584, 13.885985851287842, 15.025670289993286, 16.163843154907227, 17.30266785621643, 18.438191652297974, 19.57287335395813, 20.709373474121094, 21.848241090774536, 22.98138976097107, 24.1160409450531, 26.402080297470093, 28.68604588508606, 30.973270416259766, 33.2533802986145, 35.5343120098114, 37.816153049468994, 40.094950675964355, 42.353168964385986, 44.615394830703735, 46.89103436470032, 49.181459188461304, 51.456905126571655, 53.73723125457764, 56.025062084198, 58.29257917404175, 60.55048608779907, 62.81940221786499, 65.10044932365417, 67.4009096622467, 69.77015948295593, 72.03586983680725, 74.29458475112915, 76.5458812713623, 78.82902026176453, 81.11186575889587, 83.39555978775024, 85.64457941055298, 87.90516185760498, 90.16755604743958, 92.42455554008484, 94.68585658073425, 96.94523215293884, 99.20983719825745, 101.47463250160217, 103.73926973342896, 105.99991393089294, 108.2586498260498, 110.52658987045288, 112.79115343093872, 115.04935336112976, 117.32172060012817, 119.5905499458313, 121.86128544807434, 124.12565898895264, 126.39277935028076, 128.66213250160217, 130.93498730659485, 133.19290614128113, 135.4485366344452, 137.70612454414368, 139.964341878891, 142.2841637134552, 144.54451751708984, 146.8041055202484, 149.057448387146, 151.31869745254517, 153.57410383224487, 155.83959650993347, 158.10298562049866, 160.36943006515503, 162.62417912483215, 164.8925666809082, 167.15321040153503, 169.41924738883972, 171.6882221698761, 173.9524118900299, 176.2205150127411, 178.47916078567505, 180.74155688285828, 183.0090913772583, 185.27642941474915, 187.53719830513, 189.7986137866974, 192.05766105651855, 194.31704926490784, 196.56892609596252, 198.82497096061707, 201.07695531845093, 203.32784843444824, 205.5930848121643]
[25.26, 30.05, 37.09, 42.17, 47.14, 48.25, 50.27, 50.17, 53.48, 55.25, 56.36, 56.66, 59.53, 59.85, 59.72, 60.78, 61.2, 60.91, 61.08, 62.13, 62.75, 63.37, 64.61, 65.01, 65.08, 64.45, 64.74, 65.58, 65.42, 65.01, 64.87, 66.09, 66.07, 66.6, 66.03, 65.92, 65.82, 65.62, 65.49, 66.3, 66.18, 66.05, 66.45, 65.96, 66.8, 66.71, 67.28, 67.89, 67.82, 67.66, 67.03, 66.98, 66.63, 67.16, 67.22, 68.02, 68.02, 68.1, 68.14, 68.16, 68.44, 68.72, 68.81, 68.79, 68.28, 68.42, 68.41, 68.98, 68.65, 68.87, 68.92, 68.6, 68.15, 68.49, 68.51, 68.56, 68.84, 68.71, 68.27, 67.87, 68.58, 68.27, 67.79, 68.02, 68.73, 68.62, 67.9, 68.15, 68.4, 68.68, 68.33, 68.39, 68.78, 69.18, 69.39, 69.27, 69.04, 68.86, 69.11, 68.96, 69.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.480, Test loss: 1.261, Test accuracy: 46.76
Round   0, Global train loss: 1.480, Global test loss: 2.063, Global test accuracy: 25.41
Round   1, Train loss: 1.266, Test loss: 1.127, Test accuracy: 53.66
Round   1, Global train loss: 1.266, Global test loss: 1.781, Global test accuracy: 31.28
Round   2, Train loss: 1.144, Test loss: 1.093, Test accuracy: 55.98
Round   2, Global train loss: 1.144, Global test loss: 1.665, Global test accuracy: 37.98
Round   3, Train loss: 1.068, Test loss: 1.046, Test accuracy: 58.25
Round   3, Global train loss: 1.068, Global test loss: 1.610, Global test accuracy: 40.23
Round   4, Train loss: 1.010, Test loss: 1.035, Test accuracy: 60.39
Round   4, Global train loss: 1.010, Global test loss: 1.538, Global test accuracy: 43.57
Round   5, Train loss: 0.953, Test loss: 1.009, Test accuracy: 60.65
Round   5, Global train loss: 0.953, Global test loss: 1.475, Global test accuracy: 46.34
Round   6, Train loss: 0.901, Test loss: 1.018, Test accuracy: 61.70
Round   6, Global train loss: 0.901, Global test loss: 1.392, Global test accuracy: 49.36
Round   7, Train loss: 0.859, Test loss: 0.999, Test accuracy: 62.88
Round   7, Global train loss: 0.859, Global test loss: 1.368, Global test accuracy: 50.89
Round   8, Train loss: 0.818, Test loss: 0.983, Test accuracy: 63.82
Round   8, Global train loss: 0.818, Global test loss: 1.336, Global test accuracy: 52.35
Round   9, Train loss: 0.780, Test loss: 1.005, Test accuracy: 64.11
Round   9, Global train loss: 0.780, Global test loss: 1.298, Global test accuracy: 54.63
Round  10, Train loss: 0.814, Test loss: 1.022, Test accuracy: 64.09
Round  10, Global train loss: 0.814, Global test loss: 1.248, Global test accuracy: 56.43
Round  11, Train loss: 0.729, Test loss: 1.018, Test accuracy: 64.34
Round  11, Global train loss: 0.729, Global test loss: 1.483, Global test accuracy: 50.30
Round  12, Train loss: 0.653, Test loss: 0.988, Test accuracy: 64.94
Round  12, Global train loss: 0.653, Global test loss: 1.486, Global test accuracy: 50.19
Round  13, Train loss: 0.614, Test loss: 0.996, Test accuracy: 65.05
Round  13, Global train loss: 0.614, Global test loss: 1.420, Global test accuracy: 53.10
Round  14, Train loss: 0.615, Test loss: 0.999, Test accuracy: 65.27
Round  14, Global train loss: 0.615, Global test loss: 1.379, Global test accuracy: 53.48
Round  15, Train loss: 0.649, Test loss: 1.018, Test accuracy: 65.61
Round  15, Global train loss: 0.649, Global test loss: 1.563, Global test accuracy: 50.91
Round  16, Train loss: 0.547, Test loss: 1.036, Test accuracy: 64.96
Round  16, Global train loss: 0.547, Global test loss: 1.267, Global test accuracy: 57.26
Round  17, Train loss: 0.620, Test loss: 1.047, Test accuracy: 64.93
Round  17, Global train loss: 0.620, Global test loss: 1.472, Global test accuracy: 52.80
Round  18, Train loss: 0.476, Test loss: 1.077, Test accuracy: 64.66
Round  18, Global train loss: 0.476, Global test loss: 1.324, Global test accuracy: 56.17
Round  19, Train loss: 0.544, Test loss: 1.070, Test accuracy: 65.33
Round  19, Global train loss: 0.544, Global test loss: 1.426, Global test accuracy: 55.39
Round  20, Train loss: 0.493, Test loss: 1.074, Test accuracy: 65.37
Round  20, Global train loss: 0.493, Global test loss: 1.575, Global test accuracy: 54.04
Round  21, Train loss: 0.475, Test loss: 1.098, Test accuracy: 65.10
Round  21, Global train loss: 0.475, Global test loss: 1.442, Global test accuracy: 54.13
Round  22, Train loss: 0.514, Test loss: 1.103, Test accuracy: 65.60
Round  22, Global train loss: 0.514, Global test loss: 1.559, Global test accuracy: 52.33
Round  23, Train loss: 0.478, Test loss: 1.108, Test accuracy: 65.70
Round  23, Global train loss: 0.478, Global test loss: 1.422, Global test accuracy: 55.19
Round  24, Train loss: 0.484, Test loss: 1.111, Test accuracy: 66.43
Round  24, Global train loss: 0.484, Global test loss: 1.559, Global test accuracy: 53.22
Round  25, Train loss: 0.559, Test loss: 1.130, Test accuracy: 66.48
Round  25, Global train loss: 0.559, Global test loss: 1.300, Global test accuracy: 58.26
Round  26, Train loss: 0.436, Test loss: 1.115, Test accuracy: 66.92
Round  26, Global train loss: 0.436, Global test loss: 1.335, Global test accuracy: 58.77
Round  27, Train loss: 0.453, Test loss: 1.104, Test accuracy: 67.62
Round  27, Global train loss: 0.453, Global test loss: 1.484, Global test accuracy: 55.64
Round  28, Train loss: 0.407, Test loss: 1.133, Test accuracy: 67.58
Round  28, Global train loss: 0.407, Global test loss: 1.343, Global test accuracy: 58.63
Round  29, Train loss: 0.426, Test loss: 1.148, Test accuracy: 67.36
Round  29, Global train loss: 0.426, Global test loss: 1.396, Global test accuracy: 57.69
Round  30, Train loss: 0.342, Test loss: 1.128, Test accuracy: 67.65
Round  30, Global train loss: 0.342, Global test loss: 1.712, Global test accuracy: 54.67
Round  31, Train loss: 0.416, Test loss: 1.117, Test accuracy: 68.32
Round  31, Global train loss: 0.416, Global test loss: 1.304, Global test accuracy: 58.59
Round  32, Train loss: 0.409, Test loss: 1.129, Test accuracy: 68.56
Round  32, Global train loss: 0.409, Global test loss: 1.485, Global test accuracy: 56.89
Round  33, Train loss: 0.444, Test loss: 1.150, Test accuracy: 68.38
Round  33, Global train loss: 0.444, Global test loss: 1.433, Global test accuracy: 57.30
Round  34, Train loss: 0.375, Test loss: 1.173, Test accuracy: 68.47
Round  34, Global train loss: 0.375, Global test loss: 1.282, Global test accuracy: 61.17
Round  35, Train loss: 0.398, Test loss: 1.172, Test accuracy: 68.28
Round  35, Global train loss: 0.398, Global test loss: 1.357, Global test accuracy: 59.86
Round  36, Train loss: 0.368, Test loss: 1.158, Test accuracy: 68.60
Round  36, Global train loss: 0.368, Global test loss: 1.450, Global test accuracy: 60.05
Round  37, Train loss: 0.372, Test loss: 1.177, Test accuracy: 68.48
Round  37, Global train loss: 0.372, Global test loss: 1.558, Global test accuracy: 57.49
Round  38, Train loss: 0.323, Test loss: 1.190, Test accuracy: 68.59
Round  38, Global train loss: 0.323, Global test loss: 1.342, Global test accuracy: 60.71
Round  39, Train loss: 0.351, Test loss: 1.199, Test accuracy: 68.48
Round  39, Global train loss: 0.351, Global test loss: 1.727, Global test accuracy: 55.56
Round  40, Train loss: 0.338, Test loss: 1.189, Test accuracy: 68.78
Round  40, Global train loss: 0.338, Global test loss: 1.323, Global test accuracy: 60.60
Round  41, Train loss: 0.355, Test loss: 1.208, Test accuracy: 68.75
Round  41, Global train loss: 0.355, Global test loss: 1.471, Global test accuracy: 59.11
Round  42, Train loss: 0.278, Test loss: 1.221, Test accuracy: 68.49
Round  42, Global train loss: 0.278, Global test loss: 1.445, Global test accuracy: 60.58
Round  43, Train loss: 0.327, Test loss: 1.212, Test accuracy: 69.02
Round  43, Global train loss: 0.327, Global test loss: 1.320, Global test accuracy: 61.92
Round  44, Train loss: 0.340, Test loss: 1.252, Test accuracy: 68.70
Round  44, Global train loss: 0.340, Global test loss: 1.394, Global test accuracy: 59.32
Round  45, Train loss: 0.281, Test loss: 1.238, Test accuracy: 68.92
Round  45, Global train loss: 0.281, Global test loss: 1.483, Global test accuracy: 59.34
Round  46, Train loss: 0.327, Test loss: 1.217, Test accuracy: 69.16
Round  46, Global train loss: 0.327, Global test loss: 1.303, Global test accuracy: 61.84
Round  47, Train loss: 0.339, Test loss: 1.211, Test accuracy: 69.16
Round  47, Global train loss: 0.339, Global test loss: 1.493, Global test accuracy: 58.58
Round  48, Train loss: 0.305, Test loss: 1.209, Test accuracy: 69.60
Round  48, Global train loss: 0.305, Global test loss: 1.483, Global test accuracy: 60.70
Round  49, Train loss: 0.324, Test loss: 1.205, Test accuracy: 69.82
Round  49, Global train loss: 0.324, Global test loss: 1.630, Global test accuracy: 57.74
Round  50, Train loss: 0.287, Test loss: 1.200, Test accuracy: 69.99
Round  50, Global train loss: 0.287, Global test loss: 1.770, Global test accuracy: 56.64
Round  51, Train loss: 0.267, Test loss: 1.219, Test accuracy: 69.59
Round  51, Global train loss: 0.267, Global test loss: 1.454, Global test accuracy: 60.81
Round  52, Train loss: 0.274, Test loss: 1.253, Test accuracy: 69.57
Round  52, Global train loss: 0.274, Global test loss: 1.520, Global test accuracy: 58.97
Round  53, Train loss: 0.320, Test loss: 1.248, Test accuracy: 69.27
Round  53, Global train loss: 0.320, Global test loss: 1.601, Global test accuracy: 58.62
Round  54, Train loss: 0.272, Test loss: 1.250, Test accuracy: 69.71
Round  54, Global train loss: 0.272, Global test loss: 1.505, Global test accuracy: 59.95
Round  55, Train loss: 0.269, Test loss: 1.266, Test accuracy: 69.53
Round  55, Global train loss: 0.269, Global test loss: 1.532, Global test accuracy: 59.89
Round  56, Train loss: 0.265, Test loss: 1.266, Test accuracy: 69.83
Round  56, Global train loss: 0.265, Global test loss: 1.715, Global test accuracy: 59.25
Round  57, Train loss: 0.305, Test loss: 1.305, Test accuracy: 69.29
Round  57, Global train loss: 0.305, Global test loss: 1.395, Global test accuracy: 61.63
Round  58, Train loss: 0.255, Test loss: 1.276, Test accuracy: 69.86
Round  58, Global train loss: 0.255, Global test loss: 1.496, Global test accuracy: 59.78
Round  59, Train loss: 0.255, Test loss: 1.275, Test accuracy: 70.05
Round  59, Global train loss: 0.255, Global test loss: 1.590, Global test accuracy: 59.73
Round  60, Train loss: 0.237, Test loss: 1.294, Test accuracy: 70.23
Round  60, Global train loss: 0.237, Global test loss: 1.563, Global test accuracy: 59.40
Round  61, Train loss: 0.201, Test loss: 1.340, Test accuracy: 70.10
Round  61, Global train loss: 0.201, Global test loss: 1.696, Global test accuracy: 58.71
Round  62, Train loss: 0.269, Test loss: 1.341, Test accuracy: 69.96
Round  62, Global train loss: 0.269, Global test loss: 1.438, Global test accuracy: 61.53
Round  63, Train loss: 0.243, Test loss: 1.362, Test accuracy: 69.65
Round  63, Global train loss: 0.243, Global test loss: 1.430, Global test accuracy: 61.30
Round  64, Train loss: 0.270, Test loss: 1.345, Test accuracy: 69.74
Round  64, Global train loss: 0.270, Global test loss: 1.547, Global test accuracy: 60.60
Round  65, Train loss: 0.236, Test loss: 1.338, Test accuracy: 69.67
Round  65, Global train loss: 0.236, Global test loss: 1.437, Global test accuracy: 61.89
Round  66, Train loss: 0.211, Test loss: 1.297, Test accuracy: 69.77
Round  66, Global train loss: 0.211, Global test loss: 1.697, Global test accuracy: 59.45
Round  67, Train loss: 0.207, Test loss: 1.315, Test accuracy: 69.31
Round  67, Global train loss: 0.207, Global test loss: 1.574, Global test accuracy: 60.67
Round  68, Train loss: 0.182, Test loss: 1.303, Test accuracy: 70.07
Round  68, Global train loss: 0.182, Global test loss: 1.749, Global test accuracy: 59.99
Round  69, Train loss: 0.274, Test loss: 1.280, Test accuracy: 70.39
Round  69, Global train loss: 0.274, Global test loss: 1.584, Global test accuracy: 60.13
Round  70, Train loss: 0.220, Test loss: 1.296, Test accuracy: 70.10
Round  70, Global train loss: 0.220, Global test loss: 1.576, Global test accuracy: 60.22
Round  71, Train loss: 0.222, Test loss: 1.307, Test accuracy: 70.05
Round  71, Global train loss: 0.222, Global test loss: 1.649, Global test accuracy: 60.08
Round  72, Train loss: 0.192, Test loss: 1.288, Test accuracy: 70.23
Round  72, Global train loss: 0.192, Global test loss: 1.571, Global test accuracy: 61.93
Round  73, Train loss: 0.195, Test loss: 1.311, Test accuracy: 70.19
Round  73, Global train loss: 0.195, Global test loss: 1.680, Global test accuracy: 60.04
Round  74, Train loss: 0.234, Test loss: 1.314, Test accuracy: 70.10
Round  74, Global train loss: 0.234, Global test loss: 1.736, Global test accuracy: 59.03
Round  75, Train loss: 0.238, Test loss: 1.322, Test accuracy: 70.07
Round  75, Global train loss: 0.238, Global test loss: 1.606, Global test accuracy: 60.28
Round  76, Train loss: 0.240, Test loss: 1.316, Test accuracy: 70.32
Round  76, Global train loss: 0.240, Global test loss: 1.475, Global test accuracy: 60.82
Round  77, Train loss: 0.232, Test loss: 1.352, Test accuracy: 70.25
Round  77, Global train loss: 0.232, Global test loss: 1.531, Global test accuracy: 60.82
Round  78, Train loss: 0.231, Test loss: 1.356, Test accuracy: 70.36
Round  78, Global train loss: 0.231, Global test loss: 1.598, Global test accuracy: 60.89
Round  79, Train loss: 0.247, Test loss: 1.341, Test accuracy: 70.39
Round  79, Global train loss: 0.247, Global test loss: 1.478, Global test accuracy: 60.07
Round  80, Train loss: 0.175, Test loss: 1.342, Test accuracy: 70.39
Round  80, Global train loss: 0.175, Global test loss: 1.450, Global test accuracy: 62.45
Round  81, Train loss: 0.151, Test loss: 1.367, Test accuracy: 70.26
Round  81, Global train loss: 0.151, Global test loss: 1.551, Global test accuracy: 62.23
Round  82, Train loss: 0.147, Test loss: 1.370, Test accuracy: 70.02
Round  82, Global train loss: 0.147, Global test loss: 1.555, Global test accuracy: 62.77
Round  83, Train loss: 0.142, Test loss: 1.380, Test accuracy: 70.11
Round  83, Global train loss: 0.142, Global test loss: 1.550, Global test accuracy: 62.99
Round  84, Train loss: 0.138, Test loss: 1.372, Test accuracy: 70.41
Round  84, Global train loss: 0.138, Global test loss: 1.564, Global test accuracy: 62.72
Round  85, Train loss: 0.127, Test loss: 1.358, Test accuracy: 70.71
Round  85, Global train loss: 0.127, Global test loss: 1.593, Global test accuracy: 63.15
Round  86, Train loss: 0.129, Test loss: 1.391, Test accuracy: 69.77
Round  86, Global train loss: 0.129, Global test loss: 1.582, Global test accuracy: 63.08
Round  87, Train loss: 0.117, Test loss: 1.373, Test accuracy: 70.48
Round  87, Global train loss: 0.117, Global test loss: 1.606, Global test accuracy: 62.72
Round  88, Train loss: 0.126, Test loss: 1.383, Test accuracy: 70.39
Round  88, Global train loss: 0.126, Global test loss: 1.579, Global test accuracy: 62.94
Round  89, Train loss: 0.110, Test loss: 1.411, Test accuracy: 70.29
Round  89, Global train loss: 0.110, Global test loss: 1.601, Global test accuracy: 63.02
Round  90, Train loss: 0.218, Test loss: 1.368, Test accuracy: 71.08
Round  90, Global train loss: 0.218, Global test loss: 1.415, Global test accuracy: 62.95
Round  91, Train loss: 0.187, Test loss: 1.409, Test accuracy: 70.07
Round  91, Global train loss: 0.187, Global test loss: 1.398, Global test accuracy: 64.27
Round  92, Train loss: 0.189, Test loss: 1.374, Test accuracy: 70.83
Round  92, Global train loss: 0.189, Global test loss: 1.402, Global test accuracy: 64.15
Round  93, Train loss: 0.179, Test loss: 1.388, Test accuracy: 70.87
Round  93, Global train loss: 0.179, Global test loss: 1.405, Global test accuracy: 64.27
Round  94, Train loss: 0.181, Test loss: 1.357, Test accuracy: 71.05
Round  94, Global train loss: 0.181, Global test loss: 1.383, Global test accuracy: 64.07
Round  95, Train loss: 0.173, Test loss: 1.356, Test accuracy: 71.47
Round  95, Global train loss: 0.173, Global test loss: 1.385, Global test accuracy: 64.07
Round  96, Train loss: 0.175, Test loss: 1.425, Test accuracy: 70.65
Round  96, Global train loss: 0.175, Global test loss: 1.426, Global test accuracy: 64.02
Round  97, Train loss: 0.171, Test loss: 1.380, Test accuracy: 71.22
Round  97, Global train loss: 0.171, Global test loss: 1.413, Global test accuracy: 64.53
Round  98, Train loss: 0.168, Test loss: 1.478, Test accuracy: 70.10
Round  98, Global train loss: 0.168, Global test loss: 1.419, Global test accuracy: 64.39
Round  99, Train loss: 0.175, Test loss: 1.393, Test accuracy: 70.97
Round  99, Global train loss: 0.175, Global test loss: 1.406, Global test accuracy: 63.80
Final Round, Train loss: 0.132, Test loss: 1.532, Test accuracy: 70.85
Final Round, Global train loss: 0.132, Global test loss: 1.406, Global test accuracy: 63.80
Average accuracy final 10 rounds: 70.83099999999999
Average global accuracy final 10 rounds: 64.052
2304.674130678177
[2.5281474590301514, 4.768243312835693, 6.941926956176758, 9.125938653945923, 11.287259340286255, 13.214353561401367, 15.152368068695068, 17.08897614479065, 19.021377086639404, 20.95781922340393, 22.892322063446045, 24.810919761657715, 26.744853973388672, 28.662816047668457, 30.59459114074707, 32.52871775627136, 34.46846842765808, 36.400808811187744, 38.33631253242493, 40.26778817176819, 42.203311920166016, 44.13946080207825, 46.07690715789795, 47.99913239479065, 49.923402547836304, 51.8445200920105, 53.767420530319214, 55.6909396648407, 57.61437511444092, 59.55113649368286, 61.48871731758118, 63.427167654037476, 65.36706709861755, 67.3020350933075, 69.24387955665588, 71.18488931655884, 73.10383534431458, 75.02298617362976, 76.94097304344177, 78.85658693313599, 80.77292108535767, 82.6896767616272, 84.60584545135498, 86.5231442451477, 88.44299697875977, 90.36281442642212, 92.28312849998474, 94.20746397972107, 96.12904286384583, 98.04431319236755, 99.96201252937317, 101.87750267982483, 103.79696607589722, 105.71540641784668, 107.63282299041748, 109.54828906059265, 111.46367883682251, 113.38083028793335, 115.29740786552429, 117.2927234172821, 119.20724725723267, 121.12204146385193, 123.03811025619507, 124.95414304733276, 126.86929893493652, 128.78896760940552, 130.70793223381042, 132.62808465957642, 134.55571603775024, 136.4841034412384, 138.40305280685425, 140.3314769268036, 142.25828051567078, 144.17498779296875, 146.10991883277893, 148.038090467453, 149.96545433998108, 151.88258028030396, 153.80080461502075, 155.73440670967102, 157.64991331100464, 159.58006882667542, 161.51102542877197, 163.44546175003052, 165.3837025165558, 167.31470274925232, 169.2489230632782, 171.18458533287048, 173.1130509376526, 175.1014187335968, 177.03424859046936, 178.96797800064087, 180.9001383781433, 182.8312849998474, 184.7659616470337, 186.70232963562012, 188.63807129859924, 190.57440996170044, 192.51035356521606, 194.44797778129578, 198.34196281433105]
[46.76, 53.66, 55.98, 58.25, 60.39, 60.65, 61.7, 62.88, 63.82, 64.11, 64.09, 64.34, 64.94, 65.05, 65.27, 65.61, 64.96, 64.93, 64.66, 65.33, 65.37, 65.1, 65.6, 65.7, 66.43, 66.48, 66.92, 67.62, 67.58, 67.36, 67.65, 68.32, 68.56, 68.38, 68.47, 68.28, 68.6, 68.48, 68.59, 68.48, 68.78, 68.75, 68.49, 69.02, 68.7, 68.92, 69.16, 69.16, 69.6, 69.82, 69.99, 69.59, 69.57, 69.27, 69.71, 69.53, 69.83, 69.29, 69.86, 70.05, 70.23, 70.1, 69.96, 69.65, 69.74, 69.67, 69.77, 69.31, 70.07, 70.39, 70.1, 70.05, 70.23, 70.19, 70.1, 70.07, 70.32, 70.25, 70.36, 70.39, 70.39, 70.26, 70.02, 70.11, 70.41, 70.71, 69.77, 70.48, 70.39, 70.29, 71.08, 70.07, 70.83, 70.87, 71.05, 71.47, 70.65, 71.22, 70.1, 70.97, 70.85]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.548, Test loss: 1.331, Test accuracy: 45.05
Round   0, Global train loss: 1.548, Global test loss: 2.113, Global test accuracy: 24.86
Round   1, Train loss: 1.346, Test loss: 1.219, Test accuracy: 51.19
Round   1, Global train loss: 1.346, Global test loss: 1.825, Global test accuracy: 32.38
Round   2, Train loss: 1.223, Test loss: 1.167, Test accuracy: 54.64
Round   2, Global train loss: 1.223, Global test loss: 1.706, Global test accuracy: 37.11
Round   3, Train loss: 1.150, Test loss: 1.109, Test accuracy: 56.95
Round   3, Global train loss: 1.150, Global test loss: 1.636, Global test accuracy: 39.36
Round   4, Train loss: 1.093, Test loss: 1.095, Test accuracy: 58.32
Round   4, Global train loss: 1.093, Global test loss: 1.541, Global test accuracy: 44.42
Round   5, Train loss: 1.040, Test loss: 1.085, Test accuracy: 58.74
Round   5, Global train loss: 1.040, Global test loss: 1.495, Global test accuracy: 45.78
Round   6, Train loss: 0.995, Test loss: 1.103, Test accuracy: 59.13
Round   6, Global train loss: 0.995, Global test loss: 1.436, Global test accuracy: 49.20
Round   7, Train loss: 0.951, Test loss: 1.080, Test accuracy: 59.98
Round   7, Global train loss: 0.951, Global test loss: 1.390, Global test accuracy: 50.81
Round   8, Train loss: 0.909, Test loss: 1.068, Test accuracy: 60.35
Round   8, Global train loss: 0.909, Global test loss: 1.357, Global test accuracy: 52.33
Round   9, Train loss: 0.872, Test loss: 1.090, Test accuracy: 60.79
Round   9, Global train loss: 0.872, Global test loss: 1.344, Global test accuracy: 52.63
Round  10, Train loss: 0.814, Test loss: 1.081, Test accuracy: 61.00
Round  10, Global train loss: 0.814, Global test loss: 1.311, Global test accuracy: 53.41
Round  11, Train loss: 0.818, Test loss: 1.066, Test accuracy: 61.52
Round  11, Global train loss: 0.818, Global test loss: 1.570, Global test accuracy: 48.22
Round  12, Train loss: 0.710, Test loss: 1.072, Test accuracy: 62.08
Round  12, Global train loss: 0.710, Global test loss: 1.540, Global test accuracy: 49.42
Round  13, Train loss: 0.693, Test loss: 1.086, Test accuracy: 62.04
Round  13, Global train loss: 0.693, Global test loss: 1.576, Global test accuracy: 49.63
Round  14, Train loss: 0.645, Test loss: 1.092, Test accuracy: 62.64
Round  14, Global train loss: 0.645, Global test loss: 1.395, Global test accuracy: 52.89
Round  15, Train loss: 0.720, Test loss: 1.122, Test accuracy: 62.18
Round  15, Global train loss: 0.720, Global test loss: 1.613, Global test accuracy: 48.02
Round  16, Train loss: 0.616, Test loss: 1.101, Test accuracy: 62.88
Round  16, Global train loss: 0.616, Global test loss: 1.300, Global test accuracy: 56.04
Round  17, Train loss: 0.637, Test loss: 1.112, Test accuracy: 63.18
Round  17, Global train loss: 0.637, Global test loss: 1.482, Global test accuracy: 52.61
Round  18, Train loss: 0.592, Test loss: 1.146, Test accuracy: 62.80
Round  18, Global train loss: 0.592, Global test loss: 1.433, Global test accuracy: 54.16
Round  19, Train loss: 0.677, Test loss: 1.126, Test accuracy: 63.35
Round  19, Global train loss: 0.677, Global test loss: 1.471, Global test accuracy: 54.02
Round  20, Train loss: 0.612, Test loss: 1.144, Test accuracy: 63.29
Round  20, Global train loss: 0.612, Global test loss: 1.608, Global test accuracy: 53.10
Round  21, Train loss: 0.556, Test loss: 1.167, Test accuracy: 62.95
Round  21, Global train loss: 0.556, Global test loss: 1.464, Global test accuracy: 53.18
Round  22, Train loss: 0.549, Test loss: 1.167, Test accuracy: 63.57
Round  22, Global train loss: 0.549, Global test loss: 1.610, Global test accuracy: 51.71
Round  23, Train loss: 0.618, Test loss: 1.182, Test accuracy: 63.86
Round  23, Global train loss: 0.618, Global test loss: 1.383, Global test accuracy: 55.04
Round  24, Train loss: 0.547, Test loss: 1.193, Test accuracy: 63.56
Round  24, Global train loss: 0.547, Global test loss: 1.676, Global test accuracy: 50.22
Round  25, Train loss: 0.631, Test loss: 1.241, Test accuracy: 63.56
Round  25, Global train loss: 0.631, Global test loss: 1.433, Global test accuracy: 54.03
Round  26, Train loss: 0.494, Test loss: 1.241, Test accuracy: 63.88
Round  26, Global train loss: 0.494, Global test loss: 1.389, Global test accuracy: 56.04
Round  27, Train loss: 0.495, Test loss: 1.240, Test accuracy: 64.15
Round  27, Global train loss: 0.495, Global test loss: 1.450, Global test accuracy: 55.28
Round  28, Train loss: 0.483, Test loss: 1.272, Test accuracy: 64.25
Round  28, Global train loss: 0.483, Global test loss: 1.386, Global test accuracy: 57.03
Round  29, Train loss: 0.521, Test loss: 1.276, Test accuracy: 64.20
Round  29, Global train loss: 0.521, Global test loss: 1.505, Global test accuracy: 54.68
Round  30, Train loss: 0.418, Test loss: 1.287, Test accuracy: 64.30
Round  30, Global train loss: 0.418, Global test loss: 1.840, Global test accuracy: 50.73
Round  31, Train loss: 0.428, Test loss: 1.286, Test accuracy: 64.52
Round  31, Global train loss: 0.428, Global test loss: 1.467, Global test accuracy: 55.48
Round  32, Train loss: 0.462, Test loss: 1.294, Test accuracy: 64.49
Round  32, Global train loss: 0.462, Global test loss: 1.573, Global test accuracy: 55.61
Round  33, Train loss: 0.439, Test loss: 1.296, Test accuracy: 64.94
Round  33, Global train loss: 0.439, Global test loss: 1.421, Global test accuracy: 56.67
Round  34, Train loss: 0.435, Test loss: 1.289, Test accuracy: 65.36
Round  34, Global train loss: 0.435, Global test loss: 1.320, Global test accuracy: 59.54
Round  35, Train loss: 0.360, Test loss: 1.305, Test accuracy: 65.51
Round  35, Global train loss: 0.360, Global test loss: 1.420, Global test accuracy: 58.74
Round  36, Train loss: 0.391, Test loss: 1.357, Test accuracy: 65.03
Round  36, Global train loss: 0.391, Global test loss: 1.580, Global test accuracy: 57.34
Round  37, Train loss: 0.395, Test loss: 1.357, Test accuracy: 65.13
Round  37, Global train loss: 0.395, Global test loss: 1.587, Global test accuracy: 56.35
Round  38, Train loss: 0.324, Test loss: 1.365, Test accuracy: 64.82
Round  38, Global train loss: 0.324, Global test loss: 1.385, Global test accuracy: 60.09
Round  39, Train loss: 0.373, Test loss: 1.366, Test accuracy: 64.91
Round  39, Global train loss: 0.373, Global test loss: 1.630, Global test accuracy: 56.03
Round  40, Train loss: 0.436, Test loss: 1.367, Test accuracy: 64.81
Round  40, Global train loss: 0.436, Global test loss: 1.419, Global test accuracy: 58.71
Round  41, Train loss: 0.378, Test loss: 1.374, Test accuracy: 64.88
Round  41, Global train loss: 0.378, Global test loss: 1.605, Global test accuracy: 56.56
Round  42, Train loss: 0.317, Test loss: 1.398, Test accuracy: 65.05
Round  42, Global train loss: 0.317, Global test loss: 1.565, Global test accuracy: 57.83
Round  43, Train loss: 0.340, Test loss: 1.363, Test accuracy: 65.78
Round  43, Global train loss: 0.340, Global test loss: 1.481, Global test accuracy: 57.68
Round  44, Train loss: 0.458, Test loss: 1.390, Test accuracy: 65.48
Round  44, Global train loss: 0.458, Global test loss: 1.594, Global test accuracy: 55.06
Round  45, Train loss: 0.306, Test loss: 1.392, Test accuracy: 65.57
Round  45, Global train loss: 0.306, Global test loss: 1.554, Global test accuracy: 57.06
Round  46, Train loss: 0.425, Test loss: 1.426, Test accuracy: 65.66
Round  46, Global train loss: 0.425, Global test loss: 1.476, Global test accuracy: 57.66
Round  47, Train loss: 0.347, Test loss: 1.451, Test accuracy: 65.44
Round  47, Global train loss: 0.347, Global test loss: 1.544, Global test accuracy: 57.60
Round  48, Train loss: 0.357, Test loss: 1.438, Test accuracy: 65.84
Round  48, Global train loss: 0.357, Global test loss: 1.542, Global test accuracy: 58.73
Round  49, Train loss: 0.393, Test loss: 1.439, Test accuracy: 65.59
Round  49, Global train loss: 0.393, Global test loss: 1.812, Global test accuracy: 54.26
Round  50, Train loss: 0.249, Test loss: 1.438, Test accuracy: 65.82
Round  50, Global train loss: 0.249, Global test loss: 1.903, Global test accuracy: 54.72
Round  51, Train loss: 0.296, Test loss: 1.440, Test accuracy: 65.73
Round  51, Global train loss: 0.296, Global test loss: 1.554, Global test accuracy: 58.33
Round  52, Train loss: 0.332, Test loss: 1.458, Test accuracy: 65.81
Round  52, Global train loss: 0.332, Global test loss: 1.711, Global test accuracy: 56.42
Round  53, Train loss: 0.333, Test loss: 1.476, Test accuracy: 65.72
Round  53, Global train loss: 0.333, Global test loss: 1.562, Global test accuracy: 58.41
Round  54, Train loss: 0.344, Test loss: 1.488, Test accuracy: 66.01
Round  54, Global train loss: 0.344, Global test loss: 1.617, Global test accuracy: 57.11
Round  55, Train loss: 0.310, Test loss: 1.492, Test accuracy: 65.77
Round  55, Global train loss: 0.310, Global test loss: 1.638, Global test accuracy: 56.91
Round  56, Train loss: 0.265, Test loss: 1.483, Test accuracy: 66.28
Round  56, Global train loss: 0.265, Global test loss: 1.897, Global test accuracy: 55.98
Round  57, Train loss: 0.375, Test loss: 1.441, Test accuracy: 66.61
Round  57, Global train loss: 0.375, Global test loss: 1.529, Global test accuracy: 58.05
Round  58, Train loss: 0.298, Test loss: 1.442, Test accuracy: 66.56
Round  58, Global train loss: 0.298, Global test loss: 1.643, Global test accuracy: 57.80
Round  59, Train loss: 0.293, Test loss: 1.453, Test accuracy: 66.76
Round  59, Global train loss: 0.293, Global test loss: 1.759, Global test accuracy: 56.70
Round  60, Train loss: 0.253, Test loss: 1.468, Test accuracy: 66.62
Round  60, Global train loss: 0.253, Global test loss: 1.646, Global test accuracy: 57.84
Round  61, Train loss: 0.250, Test loss: 1.460, Test accuracy: 66.64
Round  61, Global train loss: 0.250, Global test loss: 1.739, Global test accuracy: 55.99
Round  62, Train loss: 0.304, Test loss: 1.487, Test accuracy: 66.51
Round  62, Global train loss: 0.304, Global test loss: 1.484, Global test accuracy: 58.83
Round  63, Train loss: 0.278, Test loss: 1.488, Test accuracy: 66.61
Round  63, Global train loss: 0.278, Global test loss: 1.527, Global test accuracy: 58.30
Round  64, Train loss: 0.291, Test loss: 1.532, Test accuracy: 66.44
Round  64, Global train loss: 0.291, Global test loss: 1.624, Global test accuracy: 58.04
Round  65, Train loss: 0.312, Test loss: 1.550, Test accuracy: 66.24
Round  65, Global train loss: 0.312, Global test loss: 1.801, Global test accuracy: 55.60
Round  66, Train loss: 0.235, Test loss: 1.541, Test accuracy: 66.18
Round  66, Global train loss: 0.235, Global test loss: 1.908, Global test accuracy: 56.16
Round  67, Train loss: 0.251, Test loss: 1.520, Test accuracy: 66.66
Round  67, Global train loss: 0.251, Global test loss: 1.685, Global test accuracy: 57.62
Round  68, Train loss: 0.245, Test loss: 1.502, Test accuracy: 66.78
Round  68, Global train loss: 0.245, Global test loss: 1.850, Global test accuracy: 56.22
Round  69, Train loss: 0.338, Test loss: 1.502, Test accuracy: 66.64
Round  69, Global train loss: 0.338, Global test loss: 1.698, Global test accuracy: 57.08
Round  70, Train loss: 0.268, Test loss: 1.496, Test accuracy: 66.45
Round  70, Global train loss: 0.268, Global test loss: 1.698, Global test accuracy: 57.12
Round  71, Train loss: 0.243, Test loss: 1.514, Test accuracy: 66.75
Round  71, Global train loss: 0.243, Global test loss: 1.755, Global test accuracy: 57.31
Round  72, Train loss: 0.215, Test loss: 1.499, Test accuracy: 66.81
Round  72, Global train loss: 0.215, Global test loss: 1.650, Global test accuracy: 58.84
Round  73, Train loss: 0.236, Test loss: 1.497, Test accuracy: 66.88
Round  73, Global train loss: 0.236, Global test loss: 1.739, Global test accuracy: 57.85
Round  74, Train loss: 0.268, Test loss: 1.512, Test accuracy: 67.05
Round  74, Global train loss: 0.268, Global test loss: 1.851, Global test accuracy: 55.12
Round  75, Train loss: 0.244, Test loss: 1.519, Test accuracy: 67.24
Round  75, Global train loss: 0.244, Global test loss: 1.747, Global test accuracy: 58.00
Round  76, Train loss: 0.287, Test loss: 1.519, Test accuracy: 67.07
Round  76, Global train loss: 0.287, Global test loss: 1.667, Global test accuracy: 56.81
Round  77, Train loss: 0.260, Test loss: 1.513, Test accuracy: 66.76
Round  77, Global train loss: 0.260, Global test loss: 1.622, Global test accuracy: 58.60
Round  78, Train loss: 0.253, Test loss: 1.541, Test accuracy: 66.76
Round  78, Global train loss: 0.253, Global test loss: 1.811, Global test accuracy: 57.62
Round  79, Train loss: 0.270, Test loss: 1.531, Test accuracy: 66.85
Round  79, Global train loss: 0.270, Global test loss: 1.576, Global test accuracy: 59.00
Round  80, Train loss: 0.202, Test loss: 1.523, Test accuracy: 66.99
Round  80, Global train loss: 0.202, Global test loss: 1.546, Global test accuracy: 60.93
Round  81, Train loss: 0.177, Test loss: 1.562, Test accuracy: 66.79
Round  81, Global train loss: 0.177, Global test loss: 1.589, Global test accuracy: 61.05
Round  82, Train loss: 0.160, Test loss: 1.566, Test accuracy: 66.80
Round  82, Global train loss: 0.160, Global test loss: 1.592, Global test accuracy: 61.20
Round  83, Train loss: 0.152, Test loss: 1.578, Test accuracy: 66.93
Round  83, Global train loss: 0.152, Global test loss: 1.666, Global test accuracy: 60.63
Round  84, Train loss: 0.148, Test loss: 1.569, Test accuracy: 67.08
Round  84, Global train loss: 0.148, Global test loss: 1.701, Global test accuracy: 60.22
Round  85, Train loss: 0.150, Test loss: 1.573, Test accuracy: 66.74
Round  85, Global train loss: 0.150, Global test loss: 1.671, Global test accuracy: 59.98
Round  86, Train loss: 0.140, Test loss: 1.597, Test accuracy: 66.50
Round  86, Global train loss: 0.140, Global test loss: 1.745, Global test accuracy: 59.90
Round  87, Train loss: 0.135, Test loss: 1.589, Test accuracy: 67.07
Round  87, Global train loss: 0.135, Global test loss: 1.738, Global test accuracy: 60.39
Round  88, Train loss: 0.136, Test loss: 1.628, Test accuracy: 66.83
Round  88, Global train loss: 0.136, Global test loss: 1.725, Global test accuracy: 60.77
Round  89, Train loss: 0.127, Test loss: 1.601, Test accuracy: 67.11
Round  89, Global train loss: 0.127, Global test loss: 1.738, Global test accuracy: 60.97
Round  90, Train loss: 0.244, Test loss: 1.650, Test accuracy: 66.74
Round  90, Global train loss: 0.244, Global test loss: 1.534, Global test accuracy: 61.26
Round  91, Train loss: 0.219, Test loss: 1.572, Test accuracy: 67.47
Round  91, Global train loss: 0.219, Global test loss: 1.520, Global test accuracy: 61.38
Round  92, Train loss: 0.208, Test loss: 1.693, Test accuracy: 66.88
Round  92, Global train loss: 0.208, Global test loss: 1.515, Global test accuracy: 61.36
Round  93, Train loss: 0.211, Test loss: 1.678, Test accuracy: 66.38
Round  93, Global train loss: 0.211, Global test loss: 1.526, Global test accuracy: 61.25
Round  94, Train loss: 0.206, Test loss: 1.542, Test accuracy: 67.61
Round  94, Global train loss: 0.206, Global test loss: 1.516, Global test accuracy: 61.18
Round  95, Train loss: 0.200, Test loss: 1.633, Test accuracy: 67.07
Round  95, Global train loss: 0.200, Global test loss: 1.517, Global test accuracy: 61.39
Round  96, Train loss: 0.196, Test loss: 1.637, Test accuracy: 67.36
Round  96, Global train loss: 0.196, Global test loss: 1.541, Global test accuracy: 61.41
Round  97, Train loss: 0.191, Test loss: 1.642, Test accuracy: 67.79
Round  97, Global train loss: 0.191, Global test loss: 1.553, Global test accuracy: 62.06
Round  98, Train loss: 0.200, Test loss: 1.677, Test accuracy: 66.73
Round  98, Global train loss: 0.200, Global test loss: 1.522, Global test accuracy: 61.84
Round  99, Train loss: 0.187, Test loss: 1.653, Test accuracy: 67.66
Round  99, Global train loss: 0.187, Global test loss: 1.559, Global test accuracy: 61.47
Final Round, Train loss: 0.143, Test loss: 1.831, Test accuracy: 67.36
Final Round, Global train loss: 0.143, Global test loss: 1.559, Global test accuracy: 61.47
Average accuracy final 10 rounds: 67.16900000000001
Average global accuracy final 10 rounds: 61.46
3777.8846974372864
[2.5331344604492188, 4.794525146484375, 7.046172857284546, 9.299184560775757, 11.549019575119019, 13.801791667938232, 16.06154203414917, 18.302364826202393, 20.551080465316772, 22.8115656375885, 25.054322481155396, 27.2895827293396, 29.519968032836914, 31.412527799606323, 33.30630135536194, 35.201072454452515, 37.093857526779175, 38.98438382148743, 40.87313270568848, 42.76606035232544, 44.659953594207764, 48.78751254081726, 52.91783905029297, 57.05041217803955, 61.180631160736084, 65.31833076477051, 69.45666241645813, 73.58591842651367, 77.70526242256165, 81.8664870262146, 86.00388479232788, 90.22681260108948, 94.36300921440125, 98.49308753013611, 102.6235921382904, 106.75386953353882, 110.8885657787323, 115.0160903930664, 119.1441867351532, 123.26836776733398, 127.39579105377197, 131.52803587913513, 135.65110278129578, 139.77771139144897, 143.90948796272278, 148.0432002544403, 152.17277693748474, 156.3673918247223, 160.4945924282074, 164.62222623825073, 168.75070118904114, 172.87114357948303, 176.9945719242096, 181.1236116886139, 185.25922298431396, 189.39725255966187, 193.53409337997437, 197.66220951080322, 201.78818774223328, 205.91078162193298, 210.0432994365692, 214.1756100654602, 218.31038904190063, 222.5104274749756, 226.6492419242859, 230.78328824043274, 234.9166305065155, 239.05008029937744, 243.18698596954346, 247.3212592601776, 251.46782994270325, 255.60413360595703, 259.7336766719818, 263.8709149360657, 268.01001596450806, 272.13694024086, 276.26958322525024, 280.39657402038574, 284.5348210334778, 288.73945331573486, 292.86522245407104, 297.0041844844818, 301.13711285591125, 305.2740354537964, 309.4083912372589, 313.5428521633148, 317.6726219654083, 321.8278257846832, 325.96817922592163, 330.15844988822937, 334.3020167350769, 338.4297523498535, 342.5765929222107, 346.77063751220703, 351.02226519584656, 355.218697309494, 359.4337544441223, 363.624059677124, 367.8319339752197, 372.03658628463745, 375.8231084346771]
[45.05, 51.19, 54.64, 56.95, 58.32, 58.74, 59.13, 59.98, 60.35, 60.79, 61.0, 61.52, 62.08, 62.04, 62.64, 62.18, 62.88, 63.18, 62.8, 63.35, 63.29, 62.95, 63.57, 63.86, 63.56, 63.56, 63.88, 64.15, 64.25, 64.2, 64.3, 64.52, 64.49, 64.94, 65.36, 65.51, 65.03, 65.13, 64.82, 64.91, 64.81, 64.88, 65.05, 65.78, 65.48, 65.57, 65.66, 65.44, 65.84, 65.59, 65.82, 65.73, 65.81, 65.72, 66.01, 65.77, 66.28, 66.61, 66.56, 66.76, 66.62, 66.64, 66.51, 66.61, 66.44, 66.24, 66.18, 66.66, 66.78, 66.64, 66.45, 66.75, 66.81, 66.88, 67.05, 67.24, 67.07, 66.76, 66.76, 66.85, 66.99, 66.79, 66.8, 66.93, 67.08, 66.74, 66.5, 67.07, 66.83, 67.11, 66.74, 67.47, 66.88, 66.38, 67.61, 67.07, 67.36, 67.79, 66.73, 67.66, 67.36]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.714, Test loss: 1.709, Test accuracy: 29.47
Round   1, Train loss: 1.413, Test loss: 1.396, Test accuracy: 41.19
Round   2, Train loss: 1.261, Test loss: 1.246, Test accuracy: 48.80
Round   3, Train loss: 1.160, Test loss: 1.169, Test accuracy: 52.47
Round   4, Train loss: 1.100, Test loss: 1.099, Test accuracy: 55.05
Round   5, Train loss: 1.054, Test loss: 1.056, Test accuracy: 57.69
Round   6, Train loss: 1.018, Test loss: 1.035, Test accuracy: 58.58
Round   7, Train loss: 0.980, Test loss: 1.007, Test accuracy: 60.42
Round   8, Train loss: 0.950, Test loss: 0.964, Test accuracy: 62.08
Round   9, Train loss: 0.918, Test loss: 0.973, Test accuracy: 61.48
Round  10, Train loss: 0.892, Test loss: 0.960, Test accuracy: 61.97
Round  11, Train loss: 0.865, Test loss: 0.949, Test accuracy: 62.88
Round  12, Train loss: 0.840, Test loss: 0.935, Test accuracy: 63.99
Round  13, Train loss: 0.814, Test loss: 0.901, Test accuracy: 65.47
Round  14, Train loss: 0.792, Test loss: 0.880, Test accuracy: 66.38
Round  15, Train loss: 0.771, Test loss: 0.884, Test accuracy: 66.32
Round  16, Train loss: 0.754, Test loss: 0.893, Test accuracy: 66.27
Round  17, Train loss: 0.733, Test loss: 0.865, Test accuracy: 67.06
Round  18, Train loss: 0.714, Test loss: 0.870, Test accuracy: 67.37
Round  19, Train loss: 0.697, Test loss: 0.865, Test accuracy: 67.49
Round  20, Train loss: 0.667, Test loss: 0.874, Test accuracy: 67.33
Round  21, Train loss: 0.635, Test loss: 0.875, Test accuracy: 67.16
Round  22, Train loss: 0.683, Test loss: 0.879, Test accuracy: 67.37
Round  23, Train loss: 0.639, Test loss: 0.889, Test accuracy: 67.17
Round  24, Train loss: 0.575, Test loss: 0.888, Test accuracy: 67.52
Round  25, Train loss: 0.710, Test loss: 0.929, Test accuracy: 67.17
Round  26, Train loss: 0.587, Test loss: 0.877, Test accuracy: 68.19
Round  27, Train loss: 0.655, Test loss: 0.874, Test accuracy: 68.93
Round  28, Train loss: 0.638, Test loss: 0.877, Test accuracy: 68.51
Round  29, Train loss: 0.698, Test loss: 0.890, Test accuracy: 68.47
Round  30, Train loss: 0.468, Test loss: 0.869, Test accuracy: 69.09
Round  31, Train loss: 0.599, Test loss: 0.873, Test accuracy: 68.99
Round  32, Train loss: 0.592, Test loss: 0.902, Test accuracy: 68.62
Round  33, Train loss: 0.505, Test loss: 0.859, Test accuracy: 69.96
Round  34, Train loss: 0.533, Test loss: 0.873, Test accuracy: 69.97
Round  35, Train loss: 0.542, Test loss: 0.875, Test accuracy: 69.70
Round  36, Train loss: 0.515, Test loss: 0.898, Test accuracy: 69.70
Round  37, Train loss: 0.509, Test loss: 0.924, Test accuracy: 69.77
Round  38, Train loss: 0.486, Test loss: 0.914, Test accuracy: 70.03
Round  39, Train loss: 0.437, Test loss: 0.879, Test accuracy: 70.14
Round  40, Train loss: 0.531, Test loss: 0.895, Test accuracy: 69.44
Round  41, Train loss: 0.532, Test loss: 0.923, Test accuracy: 68.75
Round  42, Train loss: 0.393, Test loss: 0.914, Test accuracy: 69.54
Round  43, Train loss: 0.446, Test loss: 0.902, Test accuracy: 69.94
Round  44, Train loss: 0.535, Test loss: 0.911, Test accuracy: 70.12
Round  45, Train loss: 0.469, Test loss: 0.923, Test accuracy: 70.06
Round  46, Train loss: 0.462, Test loss: 0.923, Test accuracy: 70.12
Round  47, Train loss: 0.432, Test loss: 0.927, Test accuracy: 70.17
Round  48, Train loss: 0.481, Test loss: 0.949, Test accuracy: 69.63
Round  49, Train loss: 0.426, Test loss: 0.895, Test accuracy: 70.14
Round  50, Train loss: 0.338, Test loss: 0.937, Test accuracy: 69.95
Round  51, Train loss: 0.434, Test loss: 0.979, Test accuracy: 69.64
Round  52, Train loss: 0.393, Test loss: 0.999, Test accuracy: 69.51
Round  53, Train loss: 0.433, Test loss: 0.971, Test accuracy: 70.10
Round  54, Train loss: 0.346, Test loss: 0.984, Test accuracy: 70.22
Round  55, Train loss: 0.395, Test loss: 0.966, Test accuracy: 69.87
Round  56, Train loss: 0.370, Test loss: 0.987, Test accuracy: 70.43
Round  57, Train loss: 0.437, Test loss: 0.952, Test accuracy: 70.63
Round  58, Train loss: 0.328, Test loss: 0.948, Test accuracy: 70.60
Round  59, Train loss: 0.358, Test loss: 0.980, Test accuracy: 70.08
Round  60, Train loss: 0.365, Test loss: 0.973, Test accuracy: 70.44
Round  61, Train loss: 0.365, Test loss: 0.985, Test accuracy: 70.81
Round  62, Train loss: 0.371, Test loss: 0.990, Test accuracy: 70.57
Round  63, Train loss: 0.302, Test loss: 1.015, Test accuracy: 70.57
Round  64, Train loss: 0.346, Test loss: 1.007, Test accuracy: 70.39
Round  65, Train loss: 0.353, Test loss: 1.026, Test accuracy: 70.65
Round  66, Train loss: 0.284, Test loss: 1.010, Test accuracy: 70.78
Round  67, Train loss: 0.363, Test loss: 1.025, Test accuracy: 70.36
Round  68, Train loss: 0.315, Test loss: 1.017, Test accuracy: 70.19
Round  69, Train loss: 0.372, Test loss: 0.992, Test accuracy: 70.58
Round  70, Train loss: 0.285, Test loss: 1.000, Test accuracy: 70.46
Round  71, Train loss: 0.285, Test loss: 1.014, Test accuracy: 70.60
Round  72, Train loss: 0.244, Test loss: 1.018, Test accuracy: 70.06
Round  73, Train loss: 0.275, Test loss: 1.019, Test accuracy: 71.01
Round  74, Train loss: 0.312, Test loss: 1.046, Test accuracy: 70.27
Round  75, Train loss: 0.300, Test loss: 1.049, Test accuracy: 70.84
Round  76, Train loss: 0.329, Test loss: 1.025, Test accuracy: 70.64
Round  77, Train loss: 0.340, Test loss: 1.068, Test accuracy: 70.43
Round  78, Train loss: 0.354, Test loss: 1.039, Test accuracy: 71.18
Round  79, Train loss: 0.333, Test loss: 1.079, Test accuracy: 70.47
Round  80, Train loss: 0.225, Test loss: 1.022, Test accuracy: 70.96
Round  81, Train loss: 0.194, Test loss: 1.045, Test accuracy: 71.17
Round  82, Train loss: 0.183, Test loss: 1.060, Test accuracy: 71.18
Round  83, Train loss: 0.176, Test loss: 1.052, Test accuracy: 71.76
Round  84, Train loss: 0.172, Test loss: 1.058, Test accuracy: 71.41
Round  85, Train loss: 0.165, Test loss: 1.056, Test accuracy: 71.16
Round  86, Train loss: 0.160, Test loss: 1.052, Test accuracy: 71.37
Round  87, Train loss: 0.149, Test loss: 1.062, Test accuracy: 71.74
Round  88, Train loss: 0.146, Test loss: 1.102, Test accuracy: 71.66
Round  89, Train loss: 0.151, Test loss: 1.095, Test accuracy: 71.26
Round  90, Train loss: 0.290, Test loss: 1.066, Test accuracy: 71.32
Round  91, Train loss: 0.267, Test loss: 1.087, Test accuracy: 71.09
Round  92, Train loss: 0.263, Test loss: 1.099, Test accuracy: 70.60
Round  93, Train loss: 0.259, Test loss: 1.118, Test accuracy: 70.41
Round  94, Train loss: 0.256, Test loss: 1.092, Test accuracy: 71.24
Round  95, Train loss: 0.255, Test loss: 1.076, Test accuracy: 71.45
Round  96, Train loss: 0.248, Test loss: 1.099, Test accuracy: 71.36
Round  97, Train loss: 0.252, Test loss: 1.089, Test accuracy: 71.01
Round  98, Train loss: 0.236, Test loss: 1.118, Test accuracy: 71.13
Round  99, Train loss: 0.236, Test loss: 1.105, Test accuracy: 71.36
Final Round, Train loss: 0.201, Test loss: 1.097, Test accuracy: 71.21
Average accuracy final 10 rounds: 71.09700000000001
3114.9965806007385
[2.285839319229126, 4.263162612915039, 6.236859321594238, 8.216438293457031, 10.185755252838135, 12.155076265335083, 14.127603530883789, 15.912622451782227, 17.69884967803955, 19.486865043640137, 21.271626234054565, 23.057271003723145, 24.84586811065674, 26.630018949508667, 28.417309284210205, 30.20425581932068, 31.99090600013733, 33.77941370010376, 35.56172442436218, 37.34072494506836, 39.107478618621826, 42.238994121551514, 45.3462336063385, 48.47412037849426, 51.60232067108154, 54.73289132118225, 57.86353635787964, 61.200923442840576, 64.54949021339417, 67.8978500366211, 71.23934960365295, 74.58270001411438, 77.90694189071655, 81.22695779800415, 84.56426739692688, 87.9107985496521, 91.25394368171692, 94.59980511665344, 97.99949765205383, 101.34668326377869, 104.69058156013489, 108.00583696365356, 111.32898044586182, 114.67322015762329, 118.02357077598572, 121.36802077293396, 124.72518396377563, 128.07389497756958, 131.4073405265808, 134.75609683990479, 138.10020804405212, 141.450612783432, 144.79147672653198, 148.1136360168457, 151.4538917541504, 154.79206466674805, 158.1269292831421, 161.47045230865479, 164.81804633140564, 168.1336841583252, 171.47168803215027, 174.81513261795044, 178.16176319122314, 181.51335954666138, 184.9229917526245, 188.26053738594055, 191.59477496147156, 194.9181478023529, 198.24453568458557, 201.5766155719757, 204.92542362213135, 208.24633502960205, 211.35374355316162, 214.46137690544128, 217.5674695968628, 220.66881823539734, 223.77105402946472, 226.87652897834778, 229.98407101631165, 233.09008741378784, 236.19488883018494, 239.30170679092407, 242.4120466709137, 245.51619839668274, 248.62133526802063, 251.73492050170898, 254.91469621658325, 258.0256643295288, 261.1340563297272, 264.23819494247437, 267.34463334083557, 270.4519054889679, 273.5598487854004, 276.66632080078125, 279.783739566803, 282.8952167034149, 286.0698575973511, 289.18473839759827, 292.2963716983795, 295.4080204963684, 298.86311531066895]
[29.47, 41.19, 48.8, 52.47, 55.05, 57.69, 58.58, 60.42, 62.08, 61.48, 61.97, 62.88, 63.99, 65.47, 66.38, 66.32, 66.27, 67.06, 67.37, 67.49, 67.33, 67.16, 67.37, 67.17, 67.52, 67.17, 68.19, 68.93, 68.51, 68.47, 69.09, 68.99, 68.62, 69.96, 69.97, 69.7, 69.7, 69.77, 70.03, 70.14, 69.44, 68.75, 69.54, 69.94, 70.12, 70.06, 70.12, 70.17, 69.63, 70.14, 69.95, 69.64, 69.51, 70.1, 70.22, 69.87, 70.43, 70.63, 70.6, 70.08, 70.44, 70.81, 70.57, 70.57, 70.39, 70.65, 70.78, 70.36, 70.19, 70.58, 70.46, 70.6, 70.06, 71.01, 70.27, 70.84, 70.64, 70.43, 71.18, 70.47, 70.96, 71.17, 71.18, 71.76, 71.41, 71.16, 71.37, 71.74, 71.66, 71.26, 71.32, 71.09, 70.6, 70.41, 71.24, 71.45, 71.36, 71.01, 71.13, 71.36, 71.21]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.726, Test loss: 1.662, Test accuracy: 33.86
Round   1, Train loss: 1.377, Test loss: 1.311, Test accuracy: 44.09
Round   2, Train loss: 1.214, Test loss: 1.160, Test accuracy: 53.63
Round   3, Train loss: 1.117, Test loss: 1.077, Test accuracy: 56.06
Round   4, Train loss: 1.061, Test loss: 1.040, Test accuracy: 57.58
Round   5, Train loss: 1.014, Test loss: 1.014, Test accuracy: 59.07
Round   6, Train loss: 0.974, Test loss: 0.974, Test accuracy: 61.64
Round   7, Train loss: 0.935, Test loss: 0.937, Test accuracy: 63.38
Round   8, Train loss: 0.902, Test loss: 0.921, Test accuracy: 63.63
Round   9, Train loss: 0.873, Test loss: 0.893, Test accuracy: 65.71
Round  10, Train loss: 0.849, Test loss: 0.879, Test accuracy: 65.62
Round  11, Train loss: 0.851, Test loss: 0.880, Test accuracy: 65.51
Round  12, Train loss: 0.755, Test loss: 0.869, Test accuracy: 66.00
Round  13, Train loss: 0.767, Test loss: 0.864, Test accuracy: 65.82
Round  14, Train loss: 0.775, Test loss: 0.847, Test accuracy: 67.12
Round  15, Train loss: 0.771, Test loss: 0.856, Test accuracy: 66.66
Round  16, Train loss: 0.665, Test loss: 0.829, Test accuracy: 68.31
Round  17, Train loss: 0.758, Test loss: 0.824, Test accuracy: 68.55
Round  18, Train loss: 0.583, Test loss: 0.824, Test accuracy: 68.36
Round  19, Train loss: 0.659, Test loss: 0.804, Test accuracy: 69.42
Round  20, Train loss: 0.623, Test loss: 0.806, Test accuracy: 69.63
Round  21, Train loss: 0.632, Test loss: 0.791, Test accuracy: 70.05
Round  22, Train loss: 0.646, Test loss: 0.799, Test accuracy: 69.96
Round  23, Train loss: 0.649, Test loss: 0.771, Test accuracy: 70.79
Round  24, Train loss: 0.561, Test loss: 0.771, Test accuracy: 70.52
Round  25, Train loss: 0.629, Test loss: 0.762, Test accuracy: 71.32
Round  26, Train loss: 0.551, Test loss: 0.766, Test accuracy: 71.12
Round  27, Train loss: 0.594, Test loss: 0.759, Test accuracy: 71.88
Round  28, Train loss: 0.564, Test loss: 0.761, Test accuracy: 72.12
Round  29, Train loss: 0.638, Test loss: 0.767, Test accuracy: 72.02
Round  30, Train loss: 0.445, Test loss: 0.762, Test accuracy: 71.95
Round  31, Train loss: 0.559, Test loss: 0.763, Test accuracy: 71.64
Round  32, Train loss: 0.555, Test loss: 0.767, Test accuracy: 71.55
Round  33, Train loss: 0.489, Test loss: 0.751, Test accuracy: 72.25
Round  34, Train loss: 0.531, Test loss: 0.754, Test accuracy: 72.24
Round  35, Train loss: 0.514, Test loss: 0.766, Test accuracy: 72.07
Round  36, Train loss: 0.467, Test loss: 0.767, Test accuracy: 72.39
Round  37, Train loss: 0.509, Test loss: 0.773, Test accuracy: 72.68
Round  38, Train loss: 0.495, Test loss: 0.765, Test accuracy: 72.69
Round  39, Train loss: 0.421, Test loss: 0.751, Test accuracy: 73.20
Round  40, Train loss: 0.454, Test loss: 0.749, Test accuracy: 73.37
Round  41, Train loss: 0.497, Test loss: 0.747, Test accuracy: 73.76
Round  42, Train loss: 0.374, Test loss: 0.737, Test accuracy: 73.31
Round  43, Train loss: 0.440, Test loss: 0.745, Test accuracy: 73.29
Round  44, Train loss: 0.504, Test loss: 0.746, Test accuracy: 73.84
Round  45, Train loss: 0.406, Test loss: 0.749, Test accuracy: 73.56
Round  46, Train loss: 0.429, Test loss: 0.751, Test accuracy: 73.40
Round  47, Train loss: 0.426, Test loss: 0.747, Test accuracy: 73.84
Round  48, Train loss: 0.457, Test loss: 0.738, Test accuracy: 74.34
Round  49, Train loss: 0.412, Test loss: 0.743, Test accuracy: 74.29
Round  50, Train loss: 0.333, Test loss: 0.749, Test accuracy: 73.90
Round  51, Train loss: 0.447, Test loss: 0.764, Test accuracy: 73.75
Round  52, Train loss: 0.408, Test loss: 0.772, Test accuracy: 74.31
Round  53, Train loss: 0.398, Test loss: 0.772, Test accuracy: 73.77
Round  54, Train loss: 0.335, Test loss: 0.779, Test accuracy: 73.75
Round  55, Train loss: 0.409, Test loss: 0.781, Test accuracy: 73.27
Round  56, Train loss: 0.334, Test loss: 0.777, Test accuracy: 73.43
Round  57, Train loss: 0.373, Test loss: 0.764, Test accuracy: 73.75
Round  58, Train loss: 0.310, Test loss: 0.767, Test accuracy: 73.77
Round  59, Train loss: 0.359, Test loss: 0.771, Test accuracy: 73.78
Round  60, Train loss: 0.346, Test loss: 0.780, Test accuracy: 73.53
Round  61, Train loss: 0.313, Test loss: 0.787, Test accuracy: 73.55
Round  62, Train loss: 0.339, Test loss: 0.779, Test accuracy: 73.29
Round  63, Train loss: 0.259, Test loss: 0.788, Test accuracy: 73.75
Round  64, Train loss: 0.377, Test loss: 0.795, Test accuracy: 73.55
Round  65, Train loss: 0.290, Test loss: 0.773, Test accuracy: 74.01
Round  66, Train loss: 0.271, Test loss: 0.805, Test accuracy: 73.70
Round  67, Train loss: 0.319, Test loss: 0.787, Test accuracy: 73.89
Round  68, Train loss: 0.266, Test loss: 0.779, Test accuracy: 74.08
Round  69, Train loss: 0.401, Test loss: 0.771, Test accuracy: 74.21
Round  70, Train loss: 0.282, Test loss: 0.780, Test accuracy: 74.06
Round  71, Train loss: 0.313, Test loss: 0.784, Test accuracy: 74.27
Round  72, Train loss: 0.240, Test loss: 0.767, Test accuracy: 74.58
Round  73, Train loss: 0.271, Test loss: 0.773, Test accuracy: 74.56
Round  74, Train loss: 0.295, Test loss: 0.769, Test accuracy: 74.56
Round  75, Train loss: 0.278, Test loss: 0.755, Test accuracy: 74.76
Round  76, Train loss: 0.287, Test loss: 0.768, Test accuracy: 74.58
Round  77, Train loss: 0.310, Test loss: 0.797, Test accuracy: 74.29
Round  78, Train loss: 0.337, Test loss: 0.797, Test accuracy: 74.34
Round  79, Train loss: 0.302, Test loss: 0.801, Test accuracy: 74.07
Round  80, Train loss: 0.208, Test loss: 0.789, Test accuracy: 74.48
Round  81, Train loss: 0.192, Test loss: 0.782, Test accuracy: 74.71
Round  82, Train loss: 0.183, Test loss: 0.778, Test accuracy: 74.42
Round  83, Train loss: 0.171, Test loss: 0.787, Test accuracy: 74.57
Round  84, Train loss: 0.163, Test loss: 0.786, Test accuracy: 74.69
Round  85, Train loss: 0.160, Test loss: 0.806, Test accuracy: 74.28
Round  86, Train loss: 0.155, Test loss: 0.809, Test accuracy: 74.25
Round  87, Train loss: 0.154, Test loss: 0.786, Test accuracy: 74.50
Round  88, Train loss: 0.142, Test loss: 0.809, Test accuracy: 74.32
Round  89, Train loss: 0.139, Test loss: 0.818, Test accuracy: 74.20
Round  90, Train loss: 0.277, Test loss: 0.788, Test accuracy: 74.93
Round  91, Train loss: 0.267, Test loss: 0.785, Test accuracy: 74.85
Round  92, Train loss: 0.250, Test loss: 0.772, Test accuracy: 75.10
Round  93, Train loss: 0.246, Test loss: 0.781, Test accuracy: 75.16
Round  94, Train loss: 0.245, Test loss: 0.775, Test accuracy: 74.96
Round  95, Train loss: 0.245, Test loss: 0.775, Test accuracy: 75.38
Round  96, Train loss: 0.246, Test loss: 0.780, Test accuracy: 74.91
Round  97, Train loss: 0.236, Test loss: 0.796, Test accuracy: 75.24
Round  98, Train loss: 0.234, Test loss: 0.799, Test accuracy: 75.06
Round  99, Train loss: 0.235, Test loss: 0.795, Test accuracy: 75.52
Final Round, Train loss: 0.208, Test loss: 0.799, Test accuracy: 75.46
Average accuracy final 10 rounds: 75.11099999999999
3469.478879213333
[2.7603766918182373, 5.299431085586548, 7.850120306015015, 10.413960218429565, 12.973219394683838, 15.529962062835693, 18.08193874359131, 20.639539003372192, 23.18744945526123, 25.740336418151855, 28.282247304916382, 30.82243323326111, 33.369277477264404, 35.92164993286133, 38.47478723526001, 41.02850890159607, 43.580103635787964, 46.13513517379761, 48.6856529712677, 51.23691964149475, 53.785752296447754, 57.8672981262207, 61.94094657897949, 66.01410102844238, 70.10956120491028, 74.20772767066956, 78.30897307395935, 82.36389875411987, 86.4538836479187, 90.54360461235046, 94.63440537452698, 98.73418712615967, 102.83618950843811, 106.973384141922, 111.02015137672424, 115.10065603256226, 119.15663313865662, 123.24798440933228, 127.34417390823364, 131.4192705154419, 135.5120770931244, 139.61104345321655, 143.69979214668274, 147.79110407829285, 151.58511996269226, 155.38268518447876, 159.17506980895996, 162.95912504196167, 166.70791578292847, 170.48885679244995, 174.27640199661255, 178.021625995636, 181.8092212677002, 185.56280088424683, 189.35418391227722, 193.13955211639404, 196.92845153808594, 200.88872408866882, 204.6739182472229, 208.4759566783905, 212.3714244365692, 216.1128957271576, 219.88479804992676, 223.6710708141327, 227.41291213035583, 231.15544891357422, 234.89412021636963, 238.68269228935242, 242.46248173713684, 246.24757027626038, 249.9917676448822, 253.72758293151855, 257.4683265686035, 261.25871324539185, 265.04335618019104, 268.8491098880768, 272.66326427459717, 276.40041041374207, 280.14164996147156, 283.8831853866577, 287.62619137763977, 291.3633472919464, 295.12178683280945, 298.8647005558014, 302.6098427772522, 306.3691780567169, 310.12344121932983, 313.87699723243713, 317.6355211734772, 321.44136929512024, 325.2885160446167, 329.0814528465271, 332.867338180542, 336.6515018939972, 340.43947529792786, 344.231808423996, 348.06519627571106, 351.9028284549713, 355.7478926181793, 359.53636598587036, 363.53299140930176]
[33.86, 44.09, 53.63, 56.06, 57.58, 59.07, 61.64, 63.38, 63.63, 65.71, 65.62, 65.51, 66.0, 65.82, 67.12, 66.66, 68.31, 68.55, 68.36, 69.42, 69.63, 70.05, 69.96, 70.79, 70.52, 71.32, 71.12, 71.88, 72.12, 72.02, 71.95, 71.64, 71.55, 72.25, 72.24, 72.07, 72.39, 72.68, 72.69, 73.2, 73.37, 73.76, 73.31, 73.29, 73.84, 73.56, 73.4, 73.84, 74.34, 74.29, 73.9, 73.75, 74.31, 73.77, 73.75, 73.27, 73.43, 73.75, 73.77, 73.78, 73.53, 73.55, 73.29, 73.75, 73.55, 74.01, 73.7, 73.89, 74.08, 74.21, 74.06, 74.27, 74.58, 74.56, 74.56, 74.76, 74.58, 74.29, 74.34, 74.07, 74.48, 74.71, 74.42, 74.57, 74.69, 74.28, 74.25, 74.5, 74.32, 74.2, 74.93, 74.85, 75.1, 75.16, 74.96, 75.38, 74.91, 75.24, 75.06, 75.52, 75.46]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.681, Test loss: 2.024, Test accuracy: 24.33
Round   0, Global train loss: 1.681, Global test loss: 2.203, Global test accuracy: 21.57
Round   1, Train loss: 1.508, Test loss: 1.776, Test accuracy: 33.24
Round   1, Global train loss: 1.508, Global test loss: 2.076, Global test accuracy: 28.49
Round   2, Train loss: 1.483, Test loss: 1.613, Test accuracy: 38.00
Round   2, Global train loss: 1.483, Global test loss: 2.048, Global test accuracy: 29.36
Round   3, Train loss: 1.463, Test loss: 1.533, Test accuracy: 37.54
Round   3, Global train loss: 1.463, Global test loss: 2.075, Global test accuracy: 21.86
Round   4, Train loss: 1.435, Test loss: 1.444, Test accuracy: 43.94
Round   4, Global train loss: 1.435, Global test loss: 2.147, Global test accuracy: 27.24
Round   5, Train loss: 1.410, Test loss: 1.442, Test accuracy: 43.60
Round   5, Global train loss: 1.410, Global test loss: 2.100, Global test accuracy: 30.17
Round   6, Train loss: 1.256, Test loss: 1.400, Test accuracy: 45.86
Round   6, Global train loss: 1.256, Global test loss: 2.106, Global test accuracy: 23.75
Round   7, Train loss: 1.426, Test loss: 1.409, Test accuracy: 46.24
Round   7, Global train loss: 1.426, Global test loss: 2.161, Global test accuracy: 24.24
Round   8, Train loss: 1.341, Test loss: 1.377, Test accuracy: 46.65
Round   8, Global train loss: 1.341, Global test loss: 2.037, Global test accuracy: 30.49
Round   9, Train loss: 1.315, Test loss: 1.308, Test accuracy: 48.43
Round   9, Global train loss: 1.315, Global test loss: 2.000, Global test accuracy: 26.18
Round  10, Train loss: 1.201, Test loss: 1.265, Test accuracy: 50.19
Round  10, Global train loss: 1.201, Global test loss: 1.969, Global test accuracy: 28.29
Round  11, Train loss: 1.217, Test loss: 1.278, Test accuracy: 50.27
Round  11, Global train loss: 1.217, Global test loss: 2.045, Global test accuracy: 29.10
Round  12, Train loss: 1.340, Test loss: 1.226, Test accuracy: 52.49
Round  12, Global train loss: 1.340, Global test loss: 2.026, Global test accuracy: 28.46
Round  13, Train loss: 1.236, Test loss: 1.227, Test accuracy: 52.86
Round  13, Global train loss: 1.236, Global test loss: 2.023, Global test accuracy: 28.74
Round  14, Train loss: 0.994, Test loss: 1.209, Test accuracy: 53.09
Round  14, Global train loss: 0.994, Global test loss: 1.962, Global test accuracy: 32.66
Round  15, Train loss: 1.182, Test loss: 1.217, Test accuracy: 53.20
Round  15, Global train loss: 1.182, Global test loss: 2.103, Global test accuracy: 25.29
Round  16, Train loss: 1.064, Test loss: 1.207, Test accuracy: 54.18
Round  16, Global train loss: 1.064, Global test loss: 1.932, Global test accuracy: 32.92
Round  17, Train loss: 1.206, Test loss: 1.212, Test accuracy: 54.57
Round  17, Global train loss: 1.206, Global test loss: 2.044, Global test accuracy: 29.61
Round  18, Train loss: 1.102, Test loss: 1.194, Test accuracy: 54.95
Round  18, Global train loss: 1.102, Global test loss: 1.861, Global test accuracy: 32.06
Round  19, Train loss: 1.055, Test loss: 1.206, Test accuracy: 54.75
Round  19, Global train loss: 1.055, Global test loss: 1.896, Global test accuracy: 33.51
Round  20, Train loss: 1.075, Test loss: 1.190, Test accuracy: 55.82
Round  20, Global train loss: 1.075, Global test loss: 2.057, Global test accuracy: 27.36
Round  21, Train loss: 1.036, Test loss: 1.178, Test accuracy: 56.45
Round  21, Global train loss: 1.036, Global test loss: 1.984, Global test accuracy: 32.38
Round  22, Train loss: 0.928, Test loss: 1.187, Test accuracy: 55.89
Round  22, Global train loss: 0.928, Global test loss: 1.919, Global test accuracy: 33.80
Round  23, Train loss: 1.033, Test loss: 1.184, Test accuracy: 56.37
Round  23, Global train loss: 1.033, Global test loss: 1.979, Global test accuracy: 31.01
Round  24, Train loss: 0.949, Test loss: 1.188, Test accuracy: 56.82
Round  24, Global train loss: 0.949, Global test loss: 1.893, Global test accuracy: 32.79
Round  25, Train loss: 0.993, Test loss: 1.197, Test accuracy: 56.49
Round  25, Global train loss: 0.993, Global test loss: 1.922, Global test accuracy: 29.04
Round  26, Train loss: 1.035, Test loss: 1.218, Test accuracy: 55.74
Round  26, Global train loss: 1.035, Global test loss: 1.950, Global test accuracy: 35.61
Round  27, Train loss: 1.015, Test loss: 1.221, Test accuracy: 55.51
Round  27, Global train loss: 1.015, Global test loss: 2.129, Global test accuracy: 31.71
Round  28, Train loss: 0.729, Test loss: 1.237, Test accuracy: 55.44
Round  28, Global train loss: 0.729, Global test loss: 1.840, Global test accuracy: 32.14
Round  29, Train loss: 0.763, Test loss: 1.246, Test accuracy: 55.22
Round  29, Global train loss: 0.763, Global test loss: 2.096, Global test accuracy: 27.93
Round  30, Train loss: 0.801, Test loss: 1.263, Test accuracy: 55.01
Round  30, Global train loss: 0.801, Global test loss: 1.916, Global test accuracy: 25.63
Round  31, Train loss: 0.742, Test loss: 1.264, Test accuracy: 55.26
Round  31, Global train loss: 0.742, Global test loss: 2.030, Global test accuracy: 31.76
Round  32, Train loss: 0.740, Test loss: 1.289, Test accuracy: 54.96
Round  32, Global train loss: 0.740, Global test loss: 2.131, Global test accuracy: 29.78
Round  33, Train loss: 0.938, Test loss: 1.312, Test accuracy: 55.07
Round  33, Global train loss: 0.938, Global test loss: 2.106, Global test accuracy: 22.02
Round  34, Train loss: 0.699, Test loss: 1.327, Test accuracy: 54.77
Round  34, Global train loss: 0.699, Global test loss: 1.992, Global test accuracy: 29.57
Round  35, Train loss: 0.798, Test loss: 1.334, Test accuracy: 54.93
Round  35, Global train loss: 0.798, Global test loss: 2.192, Global test accuracy: 17.87
Round  36, Train loss: 0.685, Test loss: 1.347, Test accuracy: 54.82
Round  36, Global train loss: 0.685, Global test loss: 2.009, Global test accuracy: 28.88
Round  37, Train loss: 0.860, Test loss: 1.372, Test accuracy: 54.78
Round  37, Global train loss: 0.860, Global test loss: 1.918, Global test accuracy: 35.91
Round  38, Train loss: 0.709, Test loss: 1.402, Test accuracy: 54.23
Round  38, Global train loss: 0.709, Global test loss: 1.843, Global test accuracy: 34.91
Round  39, Train loss: 0.777, Test loss: 1.390, Test accuracy: 54.85
Round  39, Global train loss: 0.777, Global test loss: 1.909, Global test accuracy: 32.61
Round  40, Train loss: 0.637, Test loss: 1.403, Test accuracy: 54.75
Round  40, Global train loss: 0.637, Global test loss: 1.939, Global test accuracy: 33.56
Round  41, Train loss: 0.768, Test loss: 1.408, Test accuracy: 55.70
Round  41, Global train loss: 0.768, Global test loss: 1.945, Global test accuracy: 32.91
Round  42, Train loss: 0.596, Test loss: 1.429, Test accuracy: 55.85
Round  42, Global train loss: 0.596, Global test loss: 1.949, Global test accuracy: 28.68
Round  43, Train loss: 0.738, Test loss: 1.439, Test accuracy: 55.07
Round  43, Global train loss: 0.738, Global test loss: 1.890, Global test accuracy: 33.59
Round  44, Train loss: 0.622, Test loss: 1.469, Test accuracy: 55.24
Round  44, Global train loss: 0.622, Global test loss: 2.035, Global test accuracy: 30.82
Round  45, Train loss: 0.487, Test loss: 1.467, Test accuracy: 55.14
Round  45, Global train loss: 0.487, Global test loss: 1.800, Global test accuracy: 35.22
Round  46, Train loss: 0.630, Test loss: 1.497, Test accuracy: 54.56
Round  46, Global train loss: 0.630, Global test loss: 1.925, Global test accuracy: 29.24
Round  47, Train loss: 0.751, Test loss: 1.513, Test accuracy: 54.82
Round  47, Global train loss: 0.751, Global test loss: 2.134, Global test accuracy: 25.87
Round  48, Train loss: 0.633, Test loss: 1.550, Test accuracy: 54.40
Round  48, Global train loss: 0.633, Global test loss: 1.863, Global test accuracy: 35.28
Round  49, Train loss: 0.633, Test loss: 1.581, Test accuracy: 54.33
Round  49, Global train loss: 0.633, Global test loss: 2.171, Global test accuracy: 26.07
Round  50, Train loss: 0.611, Test loss: 1.603, Test accuracy: 54.23
Round  50, Global train loss: 0.611, Global test loss: 1.946, Global test accuracy: 29.49
Round  51, Train loss: 0.410, Test loss: 1.626, Test accuracy: 54.30
Round  51, Global train loss: 0.410, Global test loss: 1.940, Global test accuracy: 34.95
Round  52, Train loss: 0.492, Test loss: 1.631, Test accuracy: 54.36
Round  52, Global train loss: 0.492, Global test loss: 2.010, Global test accuracy: 29.37
Round  53, Train loss: 0.601, Test loss: 1.632, Test accuracy: 54.52
Round  53, Global train loss: 0.601, Global test loss: 1.923, Global test accuracy: 30.18
Round  54, Train loss: 0.502, Test loss: 1.626, Test accuracy: 54.96
Round  54, Global train loss: 0.502, Global test loss: 1.898, Global test accuracy: 35.67
Round  55, Train loss: 0.555, Test loss: 1.655, Test accuracy: 54.91
Round  55, Global train loss: 0.555, Global test loss: 1.942, Global test accuracy: 32.47
Round  56, Train loss: 0.488, Test loss: 1.687, Test accuracy: 54.77
Round  56, Global train loss: 0.488, Global test loss: 1.883, Global test accuracy: 33.39
Round  57, Train loss: 0.379, Test loss: 1.761, Test accuracy: 53.47
Round  57, Global train loss: 0.379, Global test loss: 1.912, Global test accuracy: 31.28
Round  58, Train loss: 0.517, Test loss: 1.778, Test accuracy: 53.52
Round  58, Global train loss: 0.517, Global test loss: 1.995, Global test accuracy: 31.18
Round  59, Train loss: 0.502, Test loss: 1.825, Test accuracy: 53.18
Round  59, Global train loss: 0.502, Global test loss: 2.013, Global test accuracy: 30.17
Round  60, Train loss: 0.318, Test loss: 1.884, Test accuracy: 53.45
Round  60, Global train loss: 0.318, Global test loss: 1.904, Global test accuracy: 32.27
Round  61, Train loss: 0.313, Test loss: 1.873, Test accuracy: 53.84
Round  61, Global train loss: 0.313, Global test loss: 1.854, Global test accuracy: 36.49
Round  62, Train loss: 0.372, Test loss: 1.902, Test accuracy: 54.60
Round  62, Global train loss: 0.372, Global test loss: 2.161, Global test accuracy: 26.98
Round  63, Train loss: 0.333, Test loss: 1.897, Test accuracy: 54.58
Round  63, Global train loss: 0.333, Global test loss: 1.930, Global test accuracy: 32.81
Round  64, Train loss: 0.394, Test loss: 1.927, Test accuracy: 54.61
Round  64, Global train loss: 0.394, Global test loss: 2.170, Global test accuracy: 23.97
Round  65, Train loss: 0.298, Test loss: 1.931, Test accuracy: 54.38
Round  65, Global train loss: 0.298, Global test loss: 1.831, Global test accuracy: 33.76
Round  66, Train loss: 0.306, Test loss: 1.955, Test accuracy: 54.03
Round  66, Global train loss: 0.306, Global test loss: 2.027, Global test accuracy: 30.34
Round  67, Train loss: 0.171, Test loss: 1.961, Test accuracy: 53.94
Round  67, Global train loss: 0.171, Global test loss: 1.857, Global test accuracy: 37.78
Round  68, Train loss: 0.245, Test loss: 1.981, Test accuracy: 53.88
Round  68, Global train loss: 0.245, Global test loss: 1.904, Global test accuracy: 34.18
Round  69, Train loss: 0.508, Test loss: 2.025, Test accuracy: 53.64
Round  69, Global train loss: 0.508, Global test loss: 1.897, Global test accuracy: 33.91
Round  70, Train loss: 0.280, Test loss: 2.067, Test accuracy: 53.87
Round  70, Global train loss: 0.280, Global test loss: 2.246, Global test accuracy: 28.14
Round  71, Train loss: 0.439, Test loss: 2.066, Test accuracy: 54.19
Round  71, Global train loss: 0.439, Global test loss: 2.003, Global test accuracy: 30.97
Round  72, Train loss: 0.277, Test loss: 2.070, Test accuracy: 54.17
Round  72, Global train loss: 0.277, Global test loss: 1.934, Global test accuracy: 30.87
Round  73, Train loss: 0.242, Test loss: 2.052, Test accuracy: 54.41
Round  73, Global train loss: 0.242, Global test loss: 1.813, Global test accuracy: 38.73
Round  74, Train loss: 0.254, Test loss: 2.107, Test accuracy: 53.98
Round  74, Global train loss: 0.254, Global test loss: 1.944, Global test accuracy: 28.09
Round  75, Train loss: 0.337, Test loss: 2.170, Test accuracy: 53.81
Round  75, Global train loss: 0.337, Global test loss: 1.978, Global test accuracy: 29.21
Round  76, Train loss: 0.309, Test loss: 2.176, Test accuracy: 53.62
Round  76, Global train loss: 0.309, Global test loss: 2.101, Global test accuracy: 26.97
Round  77, Train loss: 0.227, Test loss: 2.140, Test accuracy: 54.06
Round  77, Global train loss: 0.227, Global test loss: 1.998, Global test accuracy: 32.92
Round  78, Train loss: 0.284, Test loss: 2.133, Test accuracy: 54.27
Round  78, Global train loss: 0.284, Global test loss: 2.040, Global test accuracy: 28.12
Round  79, Train loss: 0.304, Test loss: 2.165, Test accuracy: 54.33
Round  79, Global train loss: 0.304, Global test loss: 1.905, Global test accuracy: 33.70
Round  80, Train loss: 0.223, Test loss: 2.225, Test accuracy: 54.03
Round  80, Global train loss: 0.223, Global test loss: 1.991, Global test accuracy: 31.85
Round  81, Train loss: 0.291, Test loss: 2.237, Test accuracy: 54.24
Round  81, Global train loss: 0.291, Global test loss: 2.102, Global test accuracy: 26.06
Round  82, Train loss: 0.299, Test loss: 2.249, Test accuracy: 53.94
Round  82, Global train loss: 0.299, Global test loss: 1.906, Global test accuracy: 33.14
Round  83, Train loss: 0.176, Test loss: 2.274, Test accuracy: 53.70
Round  83, Global train loss: 0.176, Global test loss: 1.968, Global test accuracy: 34.63
Round  84, Train loss: 0.321, Test loss: 2.310, Test accuracy: 53.57
Round  84, Global train loss: 0.321, Global test loss: 1.958, Global test accuracy: 31.13
Round  85, Train loss: 0.215, Test loss: 2.352, Test accuracy: 54.11
Round  85, Global train loss: 0.215, Global test loss: 2.070, Global test accuracy: 28.48
Round  86, Train loss: 0.216, Test loss: 2.405, Test accuracy: 53.29
Round  86, Global train loss: 0.216, Global test loss: 1.977, Global test accuracy: 33.65
Round  87, Train loss: 0.217, Test loss: 2.359, Test accuracy: 53.72
Round  87, Global train loss: 0.217, Global test loss: 1.869, Global test accuracy: 34.05
Round  88, Train loss: 0.163, Test loss: 2.375, Test accuracy: 53.59
Round  88, Global train loss: 0.163, Global test loss: 1.880, Global test accuracy: 32.99
Round  89, Train loss: 0.229, Test loss: 2.460, Test accuracy: 53.15
Round  89, Global train loss: 0.229, Global test loss: 1.927, Global test accuracy: 35.12
Round  90, Train loss: 0.200, Test loss: 2.467, Test accuracy: 52.88
Round  90, Global train loss: 0.200, Global test loss: 1.981, Global test accuracy: 28.87
Round  91, Train loss: 0.163, Test loss: 2.402, Test accuracy: 53.47
Round  91, Global train loss: 0.163, Global test loss: 1.813, Global test accuracy: 34.89
Round  92, Train loss: 0.309, Test loss: 2.466, Test accuracy: 53.68
Round  92, Global train loss: 0.309, Global test loss: 1.988, Global test accuracy: 32.27
Round  93, Train loss: 0.129, Test loss: 2.554, Test accuracy: 53.25
Round  93, Global train loss: 0.129, Global test loss: 2.097, Global test accuracy: 31.25
Round  94, Train loss: 0.151, Test loss: 2.554, Test accuracy: 53.23
Round  94, Global train loss: 0.151, Global test loss: 1.987, Global test accuracy: 30.55
Round  95, Train loss: 0.150, Test loss: 2.558, Test accuracy: 53.39
Round  95, Global train loss: 0.150, Global test loss: 2.070, Global test accuracy: 33.95
Round  96, Train loss: 0.191, Test loss: 2.520, Test accuracy: 53.85
Round  96, Global train loss: 0.191, Global test loss: 2.165, Global test accuracy: 23.72
Round  97, Train loss: 0.235, Test loss: 2.515, Test accuracy: 54.51
Round  97, Global train loss: 0.235, Global test loss: 1.974, Global test accuracy: 32.61
Round  98, Train loss: 0.151, Test loss: 2.588, Test accuracy: 54.02
Round  98, Global train loss: 0.151, Global test loss: 2.043, Global test accuracy: 31.70
Round  99, Train loss: 0.123, Test loss: 2.627, Test accuracy: 53.83
Round  99, Global train loss: 0.123, Global test loss: 2.008, Global test accuracy: 27.90
Final Round, Train loss: 0.150, Test loss: 2.666, Test accuracy: 54.61
Final Round, Global train loss: 0.150, Global test loss: 2.008, Global test accuracy: 27.90
Average accuracy final 10 rounds: 53.611000000000004 

Average global accuracy final 10 rounds: 30.771 

1317.6839060783386
[1.4039638042449951, 2.8079276084899902, 3.9495081901550293, 5.091088771820068, 6.2320966720581055, 7.373104572296143, 8.50919485092163, 9.64528512954712, 10.787030458450317, 11.928775787353516, 13.077499151229858, 14.226222515106201, 15.374560594558716, 16.52289867401123, 17.662039756774902, 18.801180839538574, 19.94051480293274, 21.079848766326904, 22.222728967666626, 23.365609169006348, 24.510173559188843, 25.654737949371338, 26.796777486801147, 27.938817024230957, 29.08043098449707, 30.222044944763184, 31.36161971092224, 32.5011944770813, 33.6467547416687, 34.7923150062561, 35.935675621032715, 37.079036235809326, 38.21739435195923, 39.35575246810913, 40.49638605117798, 41.637019634246826, 42.77952170372009, 43.92202377319336, 45.06653904914856, 46.21105432510376, 47.35358166694641, 48.49610900878906, 49.63293504714966, 50.769761085510254, 51.91541838645935, 53.06107568740845, 54.20237445831299, 55.34367322921753, 56.4876983165741, 57.631723403930664, 58.76675224304199, 59.90178108215332, 61.040156841278076, 62.17853260040283, 63.314574003219604, 64.45061540603638, 65.59005641937256, 66.72949743270874, 67.86799573898315, 69.00649404525757, 70.15009593963623, 71.29369783401489, 72.43371200561523, 73.57372617721558, 74.70552682876587, 75.83732748031616, 76.97071719169617, 78.10410690307617, 79.24642634391785, 80.38874578475952, 81.52833414077759, 82.66792249679565, 83.81268048286438, 84.9574384689331, 86.09779715538025, 87.23815584182739, 88.38039803504944, 89.52264022827148, 90.6635091304779, 91.80437803268433, 92.93606066703796, 94.0677433013916, 95.20144510269165, 96.3351469039917, 97.4663736820221, 98.59760046005249, 99.73236894607544, 100.86713743209839, 101.9975790977478, 103.12802076339722, 104.2660756111145, 105.40413045883179, 106.53882646560669, 107.67352247238159, 108.81130385398865, 109.9490852355957, 111.08682513237, 112.22456502914429, 113.36329746246338, 114.50202989578247, 115.64119458198547, 116.78035926818848, 117.92113184928894, 119.0619044303894, 120.01594185829163, 120.96997928619385, 121.9256501197815, 122.88132095336914, 123.8347680568695, 124.78821516036987, 125.74184322357178, 126.69547128677368, 127.6464011669159, 128.5973310470581, 129.55081248283386, 130.50429391860962, 131.45790648460388, 132.41151905059814, 133.36362671852112, 134.3157343864441, 135.26851391792297, 136.22129344940186, 137.17660760879517, 138.13192176818848, 139.08573842048645, 140.03955507278442, 140.99542880058289, 141.95130252838135, 142.90526866912842, 143.8592348098755, 144.81288504600525, 145.766535282135, 146.71965336799622, 147.67277145385742, 148.62674617767334, 149.58072090148926, 150.53506565093994, 151.48941040039062, 152.44425654411316, 153.3991026878357, 154.35307598114014, 155.30704927444458, 156.26132464408875, 157.2156000137329, 158.1700563430786, 159.12451267242432, 160.07916927337646, 161.0338258743286, 161.99074792861938, 162.94766998291016, 163.9056248664856, 164.86357975006104, 165.8188669681549, 166.77415418624878, 167.7291100025177, 168.68406581878662, 169.63894891738892, 170.5938320159912, 171.55120968818665, 172.50858736038208, 173.46181988716125, 174.41505241394043, 175.3712296485901, 176.32740688323975, 177.2859241962433, 178.24444150924683, 179.2035939693451, 180.16274642944336, 181.11395406723022, 182.0651617050171, 183.01842284202576, 183.97168397903442, 184.93032693862915, 185.88896989822388, 186.84519815444946, 187.80142641067505, 188.7568805217743, 189.71233463287354, 190.67128777503967, 191.6302409172058, 192.59121656417847, 193.55219221115112, 194.51066875457764, 195.46914529800415, 196.43014359474182, 197.3911418914795, 198.3539309501648, 199.3167200088501, 200.27063536643982, 201.22455072402954, 202.18440461158752, 203.1442584991455, 204.1057517528534, 205.06724500656128, 206.02168726921082, 206.97612953186035, 207.93021249771118, 208.884295463562, 209.84326601028442, 210.80223655700684, 212.72347950935364, 214.64472246170044]
[24.33, 24.33, 33.24, 33.24, 38.0, 38.0, 37.54, 37.54, 43.94, 43.94, 43.6, 43.6, 45.86, 45.86, 46.24, 46.24, 46.65, 46.65, 48.43, 48.43, 50.19, 50.19, 50.27, 50.27, 52.49, 52.49, 52.86, 52.86, 53.09, 53.09, 53.2, 53.2, 54.18, 54.18, 54.57, 54.57, 54.95, 54.95, 54.75, 54.75, 55.82, 55.82, 56.45, 56.45, 55.89, 55.89, 56.37, 56.37, 56.82, 56.82, 56.49, 56.49, 55.74, 55.74, 55.51, 55.51, 55.44, 55.44, 55.22, 55.22, 55.01, 55.01, 55.26, 55.26, 54.96, 54.96, 55.07, 55.07, 54.77, 54.77, 54.93, 54.93, 54.82, 54.82, 54.78, 54.78, 54.23, 54.23, 54.85, 54.85, 54.75, 54.75, 55.7, 55.7, 55.85, 55.85, 55.07, 55.07, 55.24, 55.24, 55.14, 55.14, 54.56, 54.56, 54.82, 54.82, 54.4, 54.4, 54.33, 54.33, 54.23, 54.23, 54.3, 54.3, 54.36, 54.36, 54.52, 54.52, 54.96, 54.96, 54.91, 54.91, 54.77, 54.77, 53.47, 53.47, 53.52, 53.52, 53.18, 53.18, 53.45, 53.45, 53.84, 53.84, 54.6, 54.6, 54.58, 54.58, 54.61, 54.61, 54.38, 54.38, 54.03, 54.03, 53.94, 53.94, 53.88, 53.88, 53.64, 53.64, 53.87, 53.87, 54.19, 54.19, 54.17, 54.17, 54.41, 54.41, 53.98, 53.98, 53.81, 53.81, 53.62, 53.62, 54.06, 54.06, 54.27, 54.27, 54.33, 54.33, 54.03, 54.03, 54.24, 54.24, 53.94, 53.94, 53.7, 53.7, 53.57, 53.57, 54.11, 54.11, 53.29, 53.29, 53.72, 53.72, 53.59, 53.59, 53.15, 53.15, 52.88, 52.88, 53.47, 53.47, 53.68, 53.68, 53.25, 53.25, 53.23, 53.23, 53.39, 53.39, 53.85, 53.85, 54.51, 54.51, 54.02, 54.02, 53.83, 53.83, 54.61, 54.61]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.689, Test loss: 1.984, Test accuracy: 26.80
Round   0, Global train loss: 1.689, Global test loss: 2.185, Global test accuracy: 24.31
Round   1, Train loss: 1.455, Test loss: 1.738, Test accuracy: 34.16
Round   1, Global train loss: 1.455, Global test loss: 2.014, Global test accuracy: 30.27
Round   2, Train loss: 1.381, Test loss: 1.584, Test accuracy: 37.99
Round   2, Global train loss: 1.381, Global test loss: 1.983, Global test accuracy: 28.48
Round   3, Train loss: 1.310, Test loss: 1.459, Test accuracy: 42.02
Round   3, Global train loss: 1.310, Global test loss: 1.978, Global test accuracy: 27.97
Round   4, Train loss: 1.281, Test loss: 1.343, Test accuracy: 46.46
Round   4, Global train loss: 1.281, Global test loss: 1.910, Global test accuracy: 34.46
Round   5, Train loss: 1.284, Test loss: 1.327, Test accuracy: 46.35
Round   5, Global train loss: 1.284, Global test loss: 1.807, Global test accuracy: 37.17
Round   6, Train loss: 1.163, Test loss: 1.271, Test accuracy: 49.52
Round   6, Global train loss: 1.163, Global test loss: 1.788, Global test accuracy: 40.17
Round   7, Train loss: 1.159, Test loss: 1.275, Test accuracy: 50.74
Round   7, Global train loss: 1.159, Global test loss: 2.060, Global test accuracy: 33.26
Round   8, Train loss: 1.167, Test loss: 1.219, Test accuracy: 51.93
Round   8, Global train loss: 1.167, Global test loss: 1.729, Global test accuracy: 40.03
Round   9, Train loss: 1.065, Test loss: 1.117, Test accuracy: 56.03
Round   9, Global train loss: 1.065, Global test loss: 1.661, Global test accuracy: 40.53
Round  10, Train loss: 1.048, Test loss: 1.095, Test accuracy: 56.57
Round  10, Global train loss: 1.048, Global test loss: 1.499, Global test accuracy: 43.87
Round  11, Train loss: 1.008, Test loss: 1.075, Test accuracy: 58.66
Round  11, Global train loss: 1.008, Global test loss: 1.631, Global test accuracy: 41.12
Round  12, Train loss: 1.002, Test loss: 1.024, Test accuracy: 60.66
Round  12, Global train loss: 1.002, Global test loss: 1.509, Global test accuracy: 43.80
Round  13, Train loss: 0.941, Test loss: 1.015, Test accuracy: 61.07
Round  13, Global train loss: 0.941, Global test loss: 1.566, Global test accuracy: 44.44
Round  14, Train loss: 1.007, Test loss: 0.990, Test accuracy: 62.03
Round  14, Global train loss: 1.007, Global test loss: 1.503, Global test accuracy: 44.65
Round  15, Train loss: 0.984, Test loss: 0.984, Test accuracy: 62.49
Round  15, Global train loss: 0.984, Global test loss: 1.624, Global test accuracy: 44.63
Round  16, Train loss: 0.940, Test loss: 0.976, Test accuracy: 62.40
Round  16, Global train loss: 0.940, Global test loss: 1.616, Global test accuracy: 45.68
Round  17, Train loss: 0.906, Test loss: 0.977, Test accuracy: 62.88
Round  17, Global train loss: 0.906, Global test loss: 1.343, Global test accuracy: 51.83
Round  18, Train loss: 0.929, Test loss: 0.962, Test accuracy: 63.76
Round  18, Global train loss: 0.929, Global test loss: 1.418, Global test accuracy: 48.60
Round  19, Train loss: 0.852, Test loss: 0.951, Test accuracy: 64.46
Round  19, Global train loss: 0.852, Global test loss: 1.577, Global test accuracy: 44.50
Round  20, Train loss: 0.864, Test loss: 0.950, Test accuracy: 64.43
Round  20, Global train loss: 0.864, Global test loss: 1.420, Global test accuracy: 49.75
Round  21, Train loss: 0.903, Test loss: 0.923, Test accuracy: 65.63
Round  21, Global train loss: 0.903, Global test loss: 1.410, Global test accuracy: 48.98
Round  22, Train loss: 0.836, Test loss: 0.904, Test accuracy: 66.59
Round  22, Global train loss: 0.836, Global test loss: 1.334, Global test accuracy: 52.18
Round  23, Train loss: 0.845, Test loss: 0.892, Test accuracy: 67.13
Round  23, Global train loss: 0.845, Global test loss: 1.211, Global test accuracy: 57.54
Round  24, Train loss: 0.736, Test loss: 0.894, Test accuracy: 67.33
Round  24, Global train loss: 0.736, Global test loss: 1.420, Global test accuracy: 52.18
Round  25, Train loss: 0.753, Test loss: 0.885, Test accuracy: 67.99
Round  25, Global train loss: 0.753, Global test loss: 1.253, Global test accuracy: 56.00
Round  26, Train loss: 0.817, Test loss: 0.887, Test accuracy: 68.26
Round  26, Global train loss: 0.817, Global test loss: 1.289, Global test accuracy: 54.60
Round  27, Train loss: 0.748, Test loss: 0.881, Test accuracy: 68.43
Round  27, Global train loss: 0.748, Global test loss: 1.545, Global test accuracy: 48.33
Round  28, Train loss: 0.718, Test loss: 0.879, Test accuracy: 68.47
Round  28, Global train loss: 0.718, Global test loss: 1.213, Global test accuracy: 58.17
Round  29, Train loss: 0.767, Test loss: 0.884, Test accuracy: 68.61
Round  29, Global train loss: 0.767, Global test loss: 1.376, Global test accuracy: 52.41
Round  30, Train loss: 0.707, Test loss: 0.882, Test accuracy: 68.50
Round  30, Global train loss: 0.707, Global test loss: 1.330, Global test accuracy: 54.23
Round  31, Train loss: 0.733, Test loss: 0.876, Test accuracy: 68.48
Round  31, Global train loss: 0.733, Global test loss: 1.324, Global test accuracy: 52.15
Round  32, Train loss: 0.671, Test loss: 0.876, Test accuracy: 68.73
Round  32, Global train loss: 0.671, Global test loss: 1.315, Global test accuracy: 54.88
Round  33, Train loss: 0.708, Test loss: 0.875, Test accuracy: 68.84
Round  33, Global train loss: 0.708, Global test loss: 1.288, Global test accuracy: 53.72
Round  34, Train loss: 0.710, Test loss: 0.867, Test accuracy: 69.19
Round  34, Global train loss: 0.710, Global test loss: 1.349, Global test accuracy: 52.88
Round  35, Train loss: 0.678, Test loss: 0.876, Test accuracy: 69.07
Round  35, Global train loss: 0.678, Global test loss: 1.228, Global test accuracy: 57.05
Round  36, Train loss: 0.619, Test loss: 0.875, Test accuracy: 69.42
Round  36, Global train loss: 0.619, Global test loss: 1.311, Global test accuracy: 55.02
Round  37, Train loss: 0.624, Test loss: 0.887, Test accuracy: 69.03
Round  37, Global train loss: 0.624, Global test loss: 1.150, Global test accuracy: 60.92
Round  38, Train loss: 0.628, Test loss: 0.881, Test accuracy: 69.12
Round  38, Global train loss: 0.628, Global test loss: 1.185, Global test accuracy: 59.09
Round  39, Train loss: 0.581, Test loss: 0.887, Test accuracy: 69.37
Round  39, Global train loss: 0.581, Global test loss: 1.140, Global test accuracy: 60.79
Round  40, Train loss: 0.640, Test loss: 0.870, Test accuracy: 69.61
Round  40, Global train loss: 0.640, Global test loss: 1.334, Global test accuracy: 56.33
Round  41, Train loss: 0.659, Test loss: 0.873, Test accuracy: 69.75
Round  41, Global train loss: 0.659, Global test loss: 1.164, Global test accuracy: 60.01
Round  42, Train loss: 0.638, Test loss: 0.886, Test accuracy: 69.16
Round  42, Global train loss: 0.638, Global test loss: 1.286, Global test accuracy: 55.95
Round  43, Train loss: 0.606, Test loss: 0.874, Test accuracy: 69.55
Round  43, Global train loss: 0.606, Global test loss: 1.255, Global test accuracy: 57.88
Round  44, Train loss: 0.624, Test loss: 0.867, Test accuracy: 69.87
Round  44, Global train loss: 0.624, Global test loss: 1.191, Global test accuracy: 59.94
Round  45, Train loss: 0.604, Test loss: 0.892, Test accuracy: 69.46
Round  45, Global train loss: 0.604, Global test loss: 1.145, Global test accuracy: 60.80
Round  46, Train loss: 0.617, Test loss: 0.901, Test accuracy: 69.70
Round  46, Global train loss: 0.617, Global test loss: 1.176, Global test accuracy: 60.55
Round  47, Train loss: 0.559, Test loss: 0.916, Test accuracy: 69.53
Round  47, Global train loss: 0.559, Global test loss: 1.316, Global test accuracy: 58.08
Round  48, Train loss: 0.567, Test loss: 0.894, Test accuracy: 69.75
Round  48, Global train loss: 0.567, Global test loss: 1.092, Global test accuracy: 62.79
Round  49, Train loss: 0.602, Test loss: 0.888, Test accuracy: 69.64
Round  49, Global train loss: 0.602, Global test loss: 1.306, Global test accuracy: 55.84
Round  50, Train loss: 0.459, Test loss: 0.895, Test accuracy: 69.43
Round  50, Global train loss: 0.459, Global test loss: 1.119, Global test accuracy: 62.43
Round  51, Train loss: 0.564, Test loss: 0.889, Test accuracy: 69.85
Round  51, Global train loss: 0.564, Global test loss: 1.174, Global test accuracy: 60.13
Round  52, Train loss: 0.508, Test loss: 0.902, Test accuracy: 69.89
Round  52, Global train loss: 0.508, Global test loss: 1.209, Global test accuracy: 60.48
Round  53, Train loss: 0.507, Test loss: 0.902, Test accuracy: 69.75
Round  53, Global train loss: 0.507, Global test loss: 1.160, Global test accuracy: 61.98
Round  54, Train loss: 0.507, Test loss: 0.893, Test accuracy: 70.38
Round  54, Global train loss: 0.507, Global test loss: 1.196, Global test accuracy: 60.89
Round  55, Train loss: 0.528, Test loss: 0.901, Test accuracy: 70.12
Round  55, Global train loss: 0.528, Global test loss: 1.228, Global test accuracy: 59.53
Round  56, Train loss: 0.422, Test loss: 0.901, Test accuracy: 70.44
Round  56, Global train loss: 0.422, Global test loss: 1.202, Global test accuracy: 61.28
Round  57, Train loss: 0.490, Test loss: 0.888, Test accuracy: 70.81
Round  57, Global train loss: 0.490, Global test loss: 1.141, Global test accuracy: 62.41
Round  58, Train loss: 0.522, Test loss: 0.907, Test accuracy: 70.50
Round  58, Global train loss: 0.522, Global test loss: 1.360, Global test accuracy: 56.98
Round  59, Train loss: 0.556, Test loss: 0.911, Test accuracy: 70.45
Round  59, Global train loss: 0.556, Global test loss: 1.248, Global test accuracy: 58.66
Round  60, Train loss: 0.527, Test loss: 0.918, Test accuracy: 70.42
Round  60, Global train loss: 0.527, Global test loss: 1.170, Global test accuracy: 61.08
Round  61, Train loss: 0.520, Test loss: 0.917, Test accuracy: 70.33
Round  61, Global train loss: 0.520, Global test loss: 1.172, Global test accuracy: 61.46
Round  62, Train loss: 0.547, Test loss: 0.897, Test accuracy: 71.15
Round  62, Global train loss: 0.547, Global test loss: 1.350, Global test accuracy: 57.13
Round  63, Train loss: 0.427, Test loss: 0.904, Test accuracy: 71.13
Round  63, Global train loss: 0.427, Global test loss: 1.187, Global test accuracy: 61.72
Round  64, Train loss: 0.487, Test loss: 0.905, Test accuracy: 71.02
Round  64, Global train loss: 0.487, Global test loss: 1.260, Global test accuracy: 58.97
Round  65, Train loss: 0.426, Test loss: 0.930, Test accuracy: 71.10
Round  65, Global train loss: 0.426, Global test loss: 1.247, Global test accuracy: 60.95
Round  66, Train loss: 0.419, Test loss: 0.929, Test accuracy: 70.82
Round  66, Global train loss: 0.419, Global test loss: 1.298, Global test accuracy: 59.29
Round  67, Train loss: 0.426, Test loss: 0.917, Test accuracy: 70.68
Round  67, Global train loss: 0.426, Global test loss: 1.242, Global test accuracy: 60.49
Round  68, Train loss: 0.411, Test loss: 0.915, Test accuracy: 70.73
Round  68, Global train loss: 0.411, Global test loss: 1.231, Global test accuracy: 60.29
Round  69, Train loss: 0.500, Test loss: 0.918, Test accuracy: 71.01
Round  69, Global train loss: 0.500, Global test loss: 1.109, Global test accuracy: 63.61
Round  70, Train loss: 0.446, Test loss: 0.927, Test accuracy: 70.98
Round  70, Global train loss: 0.446, Global test loss: 1.388, Global test accuracy: 57.06
Round  71, Train loss: 0.414, Test loss: 0.942, Test accuracy: 70.86
Round  71, Global train loss: 0.414, Global test loss: 1.293, Global test accuracy: 60.43
Round  72, Train loss: 0.425, Test loss: 0.944, Test accuracy: 70.83
Round  72, Global train loss: 0.425, Global test loss: 1.256, Global test accuracy: 60.63
Round  73, Train loss: 0.406, Test loss: 0.921, Test accuracy: 71.57
Round  73, Global train loss: 0.406, Global test loss: 1.172, Global test accuracy: 62.70
Round  74, Train loss: 0.427, Test loss: 0.929, Test accuracy: 71.67
Round  74, Global train loss: 0.427, Global test loss: 1.207, Global test accuracy: 62.25
Round  75, Train loss: 0.422, Test loss: 0.949, Test accuracy: 70.80
Round  75, Global train loss: 0.422, Global test loss: 1.321, Global test accuracy: 59.23
Round  76, Train loss: 0.445, Test loss: 0.964, Test accuracy: 70.30
Round  76, Global train loss: 0.445, Global test loss: 1.184, Global test accuracy: 61.98
Round  77, Train loss: 0.396, Test loss: 0.951, Test accuracy: 70.78
Round  77, Global train loss: 0.396, Global test loss: 1.232, Global test accuracy: 61.66
Round  78, Train loss: 0.463, Test loss: 0.938, Test accuracy: 71.62
Round  78, Global train loss: 0.463, Global test loss: 1.186, Global test accuracy: 62.54
Round  79, Train loss: 0.408, Test loss: 0.940, Test accuracy: 71.85
Round  79, Global train loss: 0.408, Global test loss: 1.189, Global test accuracy: 62.19
Round  80, Train loss: 0.417, Test loss: 0.932, Test accuracy: 71.81
Round  80, Global train loss: 0.417, Global test loss: 1.221, Global test accuracy: 61.34
Round  81, Train loss: 0.400, Test loss: 0.974, Test accuracy: 71.11
Round  81, Global train loss: 0.400, Global test loss: 1.263, Global test accuracy: 61.26
Round  82, Train loss: 0.397, Test loss: 0.966, Test accuracy: 71.41
Round  82, Global train loss: 0.397, Global test loss: 1.208, Global test accuracy: 63.05
Round  83, Train loss: 0.364, Test loss: 0.968, Test accuracy: 71.25
Round  83, Global train loss: 0.364, Global test loss: 1.254, Global test accuracy: 62.30
Round  84, Train loss: 0.362, Test loss: 0.981, Test accuracy: 70.91
Round  84, Global train loss: 0.362, Global test loss: 1.141, Global test accuracy: 64.42
Round  85, Train loss: 0.375, Test loss: 0.983, Test accuracy: 70.89
Round  85, Global train loss: 0.375, Global test loss: 1.222, Global test accuracy: 62.33
Round  86, Train loss: 0.358, Test loss: 0.979, Test accuracy: 71.38
Round  86, Global train loss: 0.358, Global test loss: 1.345, Global test accuracy: 60.66
Round  87, Train loss: 0.361, Test loss: 0.977, Test accuracy: 71.49
Round  87, Global train loss: 0.361, Global test loss: 1.176, Global test accuracy: 63.75
Round  88, Train loss: 0.361, Test loss: 0.978, Test accuracy: 71.55
Round  88, Global train loss: 0.361, Global test loss: 1.226, Global test accuracy: 62.69
Round  89, Train loss: 0.368, Test loss: 0.968, Test accuracy: 71.64
Round  89, Global train loss: 0.368, Global test loss: 1.349, Global test accuracy: 59.30
Round  90, Train loss: 0.399, Test loss: 0.980, Test accuracy: 71.64
Round  90, Global train loss: 0.399, Global test loss: 1.291, Global test accuracy: 60.70
Round  91, Train loss: 0.327, Test loss: 0.997, Test accuracy: 72.05
Round  91, Global train loss: 0.327, Global test loss: 1.276, Global test accuracy: 62.65
Round  92, Train loss: 0.412, Test loss: 0.991, Test accuracy: 72.18
Round  92, Global train loss: 0.412, Global test loss: 1.383, Global test accuracy: 59.80
Round  93, Train loss: 0.397, Test loss: 0.997, Test accuracy: 71.81
Round  93, Global train loss: 0.397, Global test loss: 1.305, Global test accuracy: 59.72
Round  94, Train loss: 0.398, Test loss: 1.015, Test accuracy: 71.42
Round  94, Global train loss: 0.398, Global test loss: 1.205, Global test accuracy: 62.86
Round  95, Train loss: 0.349, Test loss: 1.020, Test accuracy: 71.73
Round  95, Global train loss: 0.349, Global test loss: 1.560, Global test accuracy: 57.35
Round  96, Train loss: 0.388, Test loss: 1.037, Test accuracy: 71.23
Round  96, Global train loss: 0.388, Global test loss: 1.268, Global test accuracy: 61.74
Round  97, Train loss: 0.414, Test loss: 1.046, Test accuracy: 71.20
Round  97, Global train loss: 0.414, Global test loss: 1.300, Global test accuracy: 60.71
Round  98, Train loss: 0.351, Test loss: 1.068, Test accuracy: 70.93
Round  98, Global train loss: 0.351, Global test loss: 1.279, Global test accuracy: 61.78
Round  99, Train loss: 0.332, Test loss: 1.077, Test accuracy: 70.74
Round  99, Global train loss: 0.332, Global test loss: 1.315, Global test accuracy: 61.39
Final Round, Train loss: 0.282, Test loss: 1.106, Test accuracy: 71.25
Final Round, Global train loss: 0.282, Global test loss: 1.315, Global test accuracy: 61.39
Average accuracy final 10 rounds: 71.493 

Average global accuracy final 10 rounds: 60.87 

1248.4077503681183
[1.3974223136901855, 2.794844627380371, 3.9276349544525146, 5.060425281524658, 6.186961889266968, 7.313498497009277, 8.438354015350342, 9.563209533691406, 10.706060647964478, 11.848911762237549, 12.799158096313477, 13.749404430389404, 14.691901206970215, 15.634397983551025, 16.58165740966797, 17.528916835784912, 18.47755789756775, 19.426198959350586, 20.3764488697052, 21.326698780059814, 22.27530264854431, 23.22390651702881, 24.1659939289093, 25.108081340789795, 26.052908658981323, 26.99773597717285, 27.948402404785156, 28.89906883239746, 29.8478741645813, 30.796679496765137, 31.743837118148804, 32.69099473953247, 33.638264179229736, 34.585533618927, 35.53016233444214, 36.474791049957275, 37.41697287559509, 38.35915470123291, 39.30050015449524, 40.24184560775757, 41.18238639831543, 42.12292718887329, 43.06763172149658, 44.01233625411987, 44.95296549797058, 45.89359474182129, 46.83965587615967, 47.78571701049805, 48.73303723335266, 49.680357456207275, 50.62316823005676, 51.56597900390625, 52.50789546966553, 53.449811935424805, 54.39795160293579, 55.34609127044678, 56.293292760849, 57.24049425125122, 58.18911957740784, 59.13774490356445, 60.08216857910156, 61.02659225463867, 61.98494601249695, 62.943299770355225, 63.88420295715332, 64.82510614395142, 65.76622247695923, 66.70733880996704, 67.64761686325073, 68.58789491653442, 69.52908492088318, 70.47027492523193, 71.411367893219, 72.35246086120605, 73.29154992103577, 74.23063898086548, 75.17026162147522, 76.10988426208496, 77.05254554748535, 77.99520683288574, 78.93946194648743, 79.88371706008911, 80.82793760299683, 81.77215814590454, 82.71487665176392, 83.65759515762329, 84.59858083724976, 85.53956651687622, 86.47989964485168, 87.42023277282715, 88.36143851280212, 89.3026442527771, 90.24777698516846, 91.19290971755981, 92.13369941711426, 93.0744891166687, 94.01630091667175, 94.9581127166748, 95.89740180969238, 96.83669090270996, 97.77612018585205, 98.71554946899414, 99.67272424697876, 100.62989902496338, 101.57112169265747, 102.51234436035156, 103.4520354270935, 104.39172649383545, 105.33237028121948, 106.27301406860352, 107.2127525806427, 108.15249109268188, 109.09267687797546, 110.03286266326904, 110.9738838672638, 111.91490507125854, 112.85667610168457, 113.7984471321106, 114.73994994163513, 115.68145275115967, 116.62260055541992, 117.56374835968018, 118.50415062904358, 119.44455289840698, 120.38393902778625, 121.32332515716553, 122.26425909996033, 123.20519304275513, 124.14652585983276, 125.0878586769104, 126.03104281425476, 126.97422695159912, 127.91791725158691, 128.8616075515747, 129.8056058883667, 130.7496042251587, 131.69226384162903, 132.63492345809937, 133.57405543327332, 134.51318740844727, 135.45501804351807, 136.39684867858887, 137.33859181404114, 138.2803349494934, 139.22540402412415, 140.17047309875488, 141.11198544502258, 142.05349779129028, 142.99542427062988, 143.93735074996948, 144.8796513080597, 145.8219518661499, 146.76346278190613, 147.70497369766235, 148.6513216495514, 149.59766960144043, 150.54038763046265, 151.48310565948486, 152.42491602897644, 153.36672639846802, 154.30812764167786, 155.2495288848877, 156.2215428352356, 157.1935567855835, 158.13694834709167, 159.08033990859985, 160.01918077468872, 160.9580216407776, 161.89858388900757, 162.83914613723755, 163.78136229515076, 164.72357845306396, 165.6653220653534, 166.60706567764282, 167.55017733573914, 168.49328899383545, 169.43911814689636, 170.38494729995728, 171.32983422279358, 172.27472114562988, 173.21788597106934, 174.1610507965088, 175.1004056930542, 176.0397605895996, 176.9789080619812, 177.9180555343628, 178.85942435264587, 179.80079317092896, 180.74389123916626, 181.68698930740356, 182.6270477771759, 183.56710624694824, 184.5083634853363, 185.44962072372437, 186.38931345939636, 187.32900619506836, 188.26895809173584, 189.20890998840332, 190.15057492256165, 191.09223985671997, 192.97551584243774, 194.85879182815552]
[26.8, 26.8, 34.16, 34.16, 37.99, 37.99, 42.02, 42.02, 46.46, 46.46, 46.35, 46.35, 49.52, 49.52, 50.74, 50.74, 51.93, 51.93, 56.03, 56.03, 56.57, 56.57, 58.66, 58.66, 60.66, 60.66, 61.07, 61.07, 62.03, 62.03, 62.49, 62.49, 62.4, 62.4, 62.88, 62.88, 63.76, 63.76, 64.46, 64.46, 64.43, 64.43, 65.63, 65.63, 66.59, 66.59, 67.13, 67.13, 67.33, 67.33, 67.99, 67.99, 68.26, 68.26, 68.43, 68.43, 68.47, 68.47, 68.61, 68.61, 68.5, 68.5, 68.48, 68.48, 68.73, 68.73, 68.84, 68.84, 69.19, 69.19, 69.07, 69.07, 69.42, 69.42, 69.03, 69.03, 69.12, 69.12, 69.37, 69.37, 69.61, 69.61, 69.75, 69.75, 69.16, 69.16, 69.55, 69.55, 69.87, 69.87, 69.46, 69.46, 69.7, 69.7, 69.53, 69.53, 69.75, 69.75, 69.64, 69.64, 69.43, 69.43, 69.85, 69.85, 69.89, 69.89, 69.75, 69.75, 70.38, 70.38, 70.12, 70.12, 70.44, 70.44, 70.81, 70.81, 70.5, 70.5, 70.45, 70.45, 70.42, 70.42, 70.33, 70.33, 71.15, 71.15, 71.13, 71.13, 71.02, 71.02, 71.1, 71.1, 70.82, 70.82, 70.68, 70.68, 70.73, 70.73, 71.01, 71.01, 70.98, 70.98, 70.86, 70.86, 70.83, 70.83, 71.57, 71.57, 71.67, 71.67, 70.8, 70.8, 70.3, 70.3, 70.78, 70.78, 71.62, 71.62, 71.85, 71.85, 71.81, 71.81, 71.11, 71.11, 71.41, 71.41, 71.25, 71.25, 70.91, 70.91, 70.89, 70.89, 71.38, 71.38, 71.49, 71.49, 71.55, 71.55, 71.64, 71.64, 71.64, 71.64, 72.05, 72.05, 72.18, 72.18, 71.81, 71.81, 71.42, 71.42, 71.73, 71.73, 71.23, 71.23, 71.2, 71.2, 70.93, 70.93, 70.74, 70.74, 71.25, 71.25]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.676, Test loss: 1.990, Test accuracy: 29.44
Round   0, Global train loss: 1.676, Global test loss: 2.182, Global test accuracy: 27.30
Round   1, Train loss: 1.504, Test loss: 1.777, Test accuracy: 32.66
Round   1, Global train loss: 1.504, Global test loss: 2.056, Global test accuracy: 26.51
Round   2, Train loss: 1.332, Test loss: 1.608, Test accuracy: 38.86
Round   2, Global train loss: 1.332, Global test loss: 2.001, Global test accuracy: 30.88
Round   3, Train loss: 1.291, Test loss: 1.472, Test accuracy: 41.28
Round   3, Global train loss: 1.291, Global test loss: 1.953, Global test accuracy: 26.88
Round   4, Train loss: 1.305, Test loss: 1.348, Test accuracy: 46.53
Round   4, Global train loss: 1.305, Global test loss: 1.867, Global test accuracy: 33.98
Round   5, Train loss: 1.243, Test loss: 1.335, Test accuracy: 46.77
Round   5, Global train loss: 1.243, Global test loss: 1.780, Global test accuracy: 38.57
Round   6, Train loss: 1.236, Test loss: 1.286, Test accuracy: 48.90
Round   6, Global train loss: 1.236, Global test loss: 1.733, Global test accuracy: 39.16
Round   7, Train loss: 1.185, Test loss: 1.299, Test accuracy: 50.35
Round   7, Global train loss: 1.185, Global test loss: 1.987, Global test accuracy: 32.67
Round   8, Train loss: 1.130, Test loss: 1.238, Test accuracy: 51.85
Round   8, Global train loss: 1.130, Global test loss: 1.748, Global test accuracy: 39.27
Round   9, Train loss: 1.120, Test loss: 1.134, Test accuracy: 55.57
Round   9, Global train loss: 1.120, Global test loss: 1.622, Global test accuracy: 41.07
Round  10, Train loss: 1.122, Test loss: 1.130, Test accuracy: 55.69
Round  10, Global train loss: 1.122, Global test loss: 1.537, Global test accuracy: 41.96
Round  11, Train loss: 0.996, Test loss: 1.125, Test accuracy: 56.59
Round  11, Global train loss: 0.996, Global test loss: 1.575, Global test accuracy: 41.91
Round  12, Train loss: 1.036, Test loss: 1.076, Test accuracy: 58.40
Round  12, Global train loss: 1.036, Global test loss: 1.550, Global test accuracy: 45.03
Round  13, Train loss: 0.959, Test loss: 1.058, Test accuracy: 59.19
Round  13, Global train loss: 0.959, Global test loss: 1.644, Global test accuracy: 42.36
Round  14, Train loss: 1.029, Test loss: 1.044, Test accuracy: 59.92
Round  14, Global train loss: 1.029, Global test loss: 1.506, Global test accuracy: 45.55
Round  15, Train loss: 0.977, Test loss: 1.022, Test accuracy: 60.96
Round  15, Global train loss: 0.977, Global test loss: 1.647, Global test accuracy: 43.26
Round  16, Train loss: 0.992, Test loss: 1.015, Test accuracy: 61.44
Round  16, Global train loss: 0.992, Global test loss: 1.560, Global test accuracy: 44.96
Round  17, Train loss: 0.918, Test loss: 0.995, Test accuracy: 62.24
Round  17, Global train loss: 0.918, Global test loss: 1.453, Global test accuracy: 47.46
Round  18, Train loss: 0.952, Test loss: 0.964, Test accuracy: 63.76
Round  18, Global train loss: 0.952, Global test loss: 1.480, Global test accuracy: 45.97
Round  19, Train loss: 0.882, Test loss: 0.958, Test accuracy: 63.98
Round  19, Global train loss: 0.882, Global test loss: 1.648, Global test accuracy: 42.16
Round  20, Train loss: 0.924, Test loss: 0.953, Test accuracy: 64.51
Round  20, Global train loss: 0.924, Global test loss: 1.475, Global test accuracy: 47.69
Round  21, Train loss: 0.902, Test loss: 0.945, Test accuracy: 64.73
Round  21, Global train loss: 0.902, Global test loss: 1.419, Global test accuracy: 47.76
Round  22, Train loss: 0.962, Test loss: 0.925, Test accuracy: 65.22
Round  22, Global train loss: 0.962, Global test loss: 1.299, Global test accuracy: 51.63
Round  23, Train loss: 0.928, Test loss: 0.910, Test accuracy: 66.14
Round  23, Global train loss: 0.928, Global test loss: 1.271, Global test accuracy: 54.51
Round  24, Train loss: 0.905, Test loss: 0.918, Test accuracy: 65.58
Round  24, Global train loss: 0.905, Global test loss: 1.336, Global test accuracy: 52.10
Round  25, Train loss: 0.882, Test loss: 0.898, Test accuracy: 66.33
Round  25, Global train loss: 0.882, Global test loss: 1.348, Global test accuracy: 51.81
Round  26, Train loss: 0.833, Test loss: 0.891, Test accuracy: 67.12
Round  26, Global train loss: 0.833, Global test loss: 1.287, Global test accuracy: 53.52
Round  27, Train loss: 0.903, Test loss: 0.896, Test accuracy: 67.42
Round  27, Global train loss: 0.903, Global test loss: 1.364, Global test accuracy: 50.73
Round  28, Train loss: 0.831, Test loss: 0.895, Test accuracy: 67.48
Round  28, Global train loss: 0.831, Global test loss: 1.253, Global test accuracy: 55.64
Round  29, Train loss: 0.786, Test loss: 0.890, Test accuracy: 67.49
Round  29, Global train loss: 0.786, Global test loss: 1.372, Global test accuracy: 52.48
Round  30, Train loss: 0.853, Test loss: 0.881, Test accuracy: 67.89
Round  30, Global train loss: 0.853, Global test loss: 1.227, Global test accuracy: 56.50
Round  31, Train loss: 0.771, Test loss: 0.877, Test accuracy: 67.86
Round  31, Global train loss: 0.771, Global test loss: 1.259, Global test accuracy: 53.16
Round  32, Train loss: 0.693, Test loss: 0.886, Test accuracy: 67.68
Round  32, Global train loss: 0.693, Global test loss: 1.399, Global test accuracy: 51.07
Round  33, Train loss: 0.856, Test loss: 0.903, Test accuracy: 67.50
Round  33, Global train loss: 0.856, Global test loss: 1.299, Global test accuracy: 53.69
Round  34, Train loss: 0.738, Test loss: 0.906, Test accuracy: 67.59
Round  34, Global train loss: 0.738, Global test loss: 1.358, Global test accuracy: 53.69
Round  35, Train loss: 0.799, Test loss: 0.877, Test accuracy: 68.62
Round  35, Global train loss: 0.799, Global test loss: 1.175, Global test accuracy: 58.71
Round  36, Train loss: 0.716, Test loss: 0.864, Test accuracy: 69.06
Round  36, Global train loss: 0.716, Global test loss: 1.325, Global test accuracy: 53.67
Round  37, Train loss: 0.720, Test loss: 0.878, Test accuracy: 68.33
Round  37, Global train loss: 0.720, Global test loss: 1.148, Global test accuracy: 60.82
Round  38, Train loss: 0.718, Test loss: 0.878, Test accuracy: 68.57
Round  38, Global train loss: 0.718, Global test loss: 1.169, Global test accuracy: 59.97
Round  39, Train loss: 0.672, Test loss: 0.879, Test accuracy: 68.47
Round  39, Global train loss: 0.672, Global test loss: 1.198, Global test accuracy: 58.83
Round  40, Train loss: 0.685, Test loss: 0.878, Test accuracy: 68.35
Round  40, Global train loss: 0.685, Global test loss: 1.291, Global test accuracy: 56.45
Round  41, Train loss: 0.698, Test loss: 0.871, Test accuracy: 68.82
Round  41, Global train loss: 0.698, Global test loss: 1.156, Global test accuracy: 59.91
Round  42, Train loss: 0.660, Test loss: 0.900, Test accuracy: 68.32
Round  42, Global train loss: 0.660, Global test loss: 1.253, Global test accuracy: 56.91
Round  43, Train loss: 0.610, Test loss: 0.897, Test accuracy: 68.44
Round  43, Global train loss: 0.610, Global test loss: 1.291, Global test accuracy: 56.95
Round  44, Train loss: 0.689, Test loss: 0.908, Test accuracy: 68.25
Round  44, Global train loss: 0.689, Global test loss: 1.242, Global test accuracy: 57.98
Round  45, Train loss: 0.669, Test loss: 0.901, Test accuracy: 68.51
Round  45, Global train loss: 0.669, Global test loss: 1.129, Global test accuracy: 61.38
Round  46, Train loss: 0.741, Test loss: 0.884, Test accuracy: 69.44
Round  46, Global train loss: 0.741, Global test loss: 1.178, Global test accuracy: 58.88
Round  47, Train loss: 0.599, Test loss: 0.887, Test accuracy: 69.20
Round  47, Global train loss: 0.599, Global test loss: 1.364, Global test accuracy: 56.42
Round  48, Train loss: 0.661, Test loss: 0.883, Test accuracy: 69.40
Round  48, Global train loss: 0.661, Global test loss: 1.129, Global test accuracy: 61.62
Round  49, Train loss: 0.650, Test loss: 0.881, Test accuracy: 69.33
Round  49, Global train loss: 0.650, Global test loss: 1.253, Global test accuracy: 56.82
Round  50, Train loss: 0.642, Test loss: 0.872, Test accuracy: 69.88
Round  50, Global train loss: 0.642, Global test loss: 1.132, Global test accuracy: 61.29
Round  51, Train loss: 0.510, Test loss: 0.881, Test accuracy: 69.99
Round  51, Global train loss: 0.510, Global test loss: 1.148, Global test accuracy: 61.85
Round  52, Train loss: 0.639, Test loss: 0.889, Test accuracy: 70.01
Round  52, Global train loss: 0.639, Global test loss: 1.176, Global test accuracy: 59.52
Round  53, Train loss: 0.595, Test loss: 0.891, Test accuracy: 70.11
Round  53, Global train loss: 0.595, Global test loss: 1.183, Global test accuracy: 61.00
Round  54, Train loss: 0.608, Test loss: 0.875, Test accuracy: 70.60
Round  54, Global train loss: 0.608, Global test loss: 1.164, Global test accuracy: 60.57
Round  55, Train loss: 0.546, Test loss: 0.886, Test accuracy: 70.05
Round  55, Global train loss: 0.546, Global test loss: 1.205, Global test accuracy: 59.92
Round  56, Train loss: 0.547, Test loss: 0.894, Test accuracy: 69.96
Round  56, Global train loss: 0.547, Global test loss: 1.189, Global test accuracy: 61.19
Round  57, Train loss: 0.603, Test loss: 0.888, Test accuracy: 70.36
Round  57, Global train loss: 0.603, Global test loss: 1.104, Global test accuracy: 62.53
Round  58, Train loss: 0.534, Test loss: 0.886, Test accuracy: 70.62
Round  58, Global train loss: 0.534, Global test loss: 1.276, Global test accuracy: 58.95
Round  59, Train loss: 0.575, Test loss: 0.868, Test accuracy: 70.89
Round  59, Global train loss: 0.575, Global test loss: 1.234, Global test accuracy: 58.97
Round  60, Train loss: 0.549, Test loss: 0.880, Test accuracy: 70.86
Round  60, Global train loss: 0.549, Global test loss: 1.142, Global test accuracy: 61.28
Round  61, Train loss: 0.539, Test loss: 0.885, Test accuracy: 70.68
Round  61, Global train loss: 0.539, Global test loss: 1.130, Global test accuracy: 62.16
Round  62, Train loss: 0.608, Test loss: 0.888, Test accuracy: 70.99
Round  62, Global train loss: 0.608, Global test loss: 1.326, Global test accuracy: 57.38
Round  63, Train loss: 0.525, Test loss: 0.902, Test accuracy: 70.46
Round  63, Global train loss: 0.525, Global test loss: 1.174, Global test accuracy: 60.89
Round  64, Train loss: 0.505, Test loss: 0.935, Test accuracy: 69.91
Round  64, Global train loss: 0.505, Global test loss: 1.240, Global test accuracy: 60.09
Round  65, Train loss: 0.523, Test loss: 0.930, Test accuracy: 70.50
Round  65, Global train loss: 0.523, Global test loss: 1.172, Global test accuracy: 61.61
Round  66, Train loss: 0.498, Test loss: 0.905, Test accuracy: 71.34
Round  66, Global train loss: 0.498, Global test loss: 1.160, Global test accuracy: 62.20
Round  67, Train loss: 0.500, Test loss: 0.898, Test accuracy: 71.61
Round  67, Global train loss: 0.500, Global test loss: 1.174, Global test accuracy: 62.71
Round  68, Train loss: 0.470, Test loss: 0.940, Test accuracy: 70.52
Round  68, Global train loss: 0.470, Global test loss: 1.175, Global test accuracy: 62.07
Round  69, Train loss: 0.562, Test loss: 0.960, Test accuracy: 70.28
Round  69, Global train loss: 0.562, Global test loss: 1.126, Global test accuracy: 63.05
Round  70, Train loss: 0.482, Test loss: 0.942, Test accuracy: 71.25
Round  70, Global train loss: 0.482, Global test loss: 1.300, Global test accuracy: 58.08
Round  71, Train loss: 0.416, Test loss: 0.910, Test accuracy: 71.58
Round  71, Global train loss: 0.416, Global test loss: 1.307, Global test accuracy: 60.92
Round  72, Train loss: 0.426, Test loss: 0.925, Test accuracy: 71.13
Round  72, Global train loss: 0.426, Global test loss: 1.282, Global test accuracy: 61.25
Round  73, Train loss: 0.519, Test loss: 0.916, Test accuracy: 71.57
Round  73, Global train loss: 0.519, Global test loss: 1.097, Global test accuracy: 64.13
Round  74, Train loss: 0.583, Test loss: 0.918, Test accuracy: 71.42
Round  74, Global train loss: 0.583, Global test loss: 1.139, Global test accuracy: 61.95
Round  75, Train loss: 0.508, Test loss: 0.910, Test accuracy: 70.95
Round  75, Global train loss: 0.508, Global test loss: 1.227, Global test accuracy: 60.57
Round  76, Train loss: 0.498, Test loss: 0.917, Test accuracy: 70.69
Round  76, Global train loss: 0.498, Global test loss: 1.184, Global test accuracy: 61.65
Round  77, Train loss: 0.487, Test loss: 0.916, Test accuracy: 71.12
Round  77, Global train loss: 0.487, Global test loss: 1.183, Global test accuracy: 62.16
Round  78, Train loss: 0.498, Test loss: 0.899, Test accuracy: 71.80
Round  78, Global train loss: 0.498, Global test loss: 1.197, Global test accuracy: 62.02
Round  79, Train loss: 0.472, Test loss: 0.927, Test accuracy: 71.78
Round  79, Global train loss: 0.472, Global test loss: 1.233, Global test accuracy: 62.20
Round  80, Train loss: 0.456, Test loss: 0.916, Test accuracy: 71.79
Round  80, Global train loss: 0.456, Global test loss: 1.177, Global test accuracy: 62.85
Round  81, Train loss: 0.457, Test loss: 0.923, Test accuracy: 71.79
Round  81, Global train loss: 0.457, Global test loss: 1.267, Global test accuracy: 61.20
Round  82, Train loss: 0.500, Test loss: 0.929, Test accuracy: 71.31
Round  82, Global train loss: 0.500, Global test loss: 1.208, Global test accuracy: 61.89
Round  83, Train loss: 0.399, Test loss: 0.919, Test accuracy: 71.72
Round  83, Global train loss: 0.399, Global test loss: 1.249, Global test accuracy: 60.99
Round  84, Train loss: 0.397, Test loss: 0.936, Test accuracy: 71.37
Round  84, Global train loss: 0.397, Global test loss: 1.110, Global test accuracy: 65.14
Round  85, Train loss: 0.523, Test loss: 0.956, Test accuracy: 71.13
Round  85, Global train loss: 0.523, Global test loss: 1.211, Global test accuracy: 61.46
Round  86, Train loss: 0.443, Test loss: 0.957, Test accuracy: 71.03
Round  86, Global train loss: 0.443, Global test loss: 1.304, Global test accuracy: 59.90
Round  87, Train loss: 0.418, Test loss: 0.962, Test accuracy: 71.43
Round  87, Global train loss: 0.418, Global test loss: 1.178, Global test accuracy: 63.24
Round  88, Train loss: 0.455, Test loss: 0.978, Test accuracy: 71.35
Round  88, Global train loss: 0.455, Global test loss: 1.201, Global test accuracy: 62.46
Round  89, Train loss: 0.415, Test loss: 0.946, Test accuracy: 71.81
Round  89, Global train loss: 0.415, Global test loss: 1.268, Global test accuracy: 62.21
Round  90, Train loss: 0.467, Test loss: 0.970, Test accuracy: 71.42
Round  90, Global train loss: 0.467, Global test loss: 1.253, Global test accuracy: 60.60
Round  91, Train loss: 0.434, Test loss: 0.966, Test accuracy: 71.58
Round  91, Global train loss: 0.434, Global test loss: 1.186, Global test accuracy: 63.20
Round  92, Train loss: 0.395, Test loss: 1.003, Test accuracy: 71.03
Round  92, Global train loss: 0.395, Global test loss: 1.404, Global test accuracy: 60.22
Round  93, Train loss: 0.462, Test loss: 0.987, Test accuracy: 71.55
Round  93, Global train loss: 0.462, Global test loss: 1.302, Global test accuracy: 60.40/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.413, Test loss: 1.018, Test accuracy: 70.94
Round  94, Global train loss: 0.413, Global test loss: 1.264, Global test accuracy: 61.77
Round  95, Train loss: 0.406, Test loss: 1.033, Test accuracy: 70.48
Round  95, Global train loss: 0.406, Global test loss: 1.414, Global test accuracy: 58.05
Round  96, Train loss: 0.362, Test loss: 1.004, Test accuracy: 71.18
Round  96, Global train loss: 0.362, Global test loss: 1.335, Global test accuracy: 60.63
Round  97, Train loss: 0.414, Test loss: 1.009, Test accuracy: 70.69
Round  97, Global train loss: 0.414, Global test loss: 1.412, Global test accuracy: 60.36
Round  98, Train loss: 0.381, Test loss: 1.015, Test accuracy: 70.54
Round  98, Global train loss: 0.381, Global test loss: 1.215, Global test accuracy: 63.18
Round  99, Train loss: 0.408, Test loss: 1.012, Test accuracy: 70.92
Round  99, Global train loss: 0.408, Global test loss: 1.320, Global test accuracy: 60.99
Final Round, Train loss: 0.318, Test loss: 1.073, Test accuracy: 70.99
Final Round, Global train loss: 0.318, Global test loss: 1.320, Global test accuracy: 60.99
Average accuracy final 10 rounds: 71.03300000000002 

Average global accuracy final 10 rounds: 60.94 

1386.1642334461212
[1.4554839134216309, 2.9109678268432617, 4.108750104904175, 5.306532382965088, 6.506965398788452, 7.707398414611816, 8.912743091583252, 10.118087768554688, 11.319931030273438, 12.521774291992188, 13.715338230133057, 14.908902168273926, 16.09980869293213, 17.290715217590332, 18.484159231185913, 19.677603244781494, 20.86968684196472, 22.06177043914795, 23.25372290611267, 24.445675373077393, 25.641571521759033, 26.837467670440674, 28.030307054519653, 29.223146438598633, 30.428306102752686, 31.63346576690674, 32.82877564430237, 34.024085521698, 35.21430802345276, 36.40453052520752, 37.59644055366516, 38.7883505821228, 39.98020577430725, 41.1720609664917, 42.368521213531494, 43.56498146057129, 44.763755559921265, 45.96252965927124, 47.168851375579834, 48.37517309188843, 49.56674599647522, 50.75831890106201, 51.957104206085205, 53.1558895111084, 54.35070753097534, 55.545525550842285, 56.740373373031616, 57.93522119522095, 59.131797075271606, 60.328372955322266, 61.523791551589966, 62.719210147857666, 63.91775393486023, 65.1162977218628, 66.31780624389648, 67.51931476593018, 68.71219158172607, 69.90506839752197, 71.10020303726196, 72.29533767700195, 73.5024094581604, 74.70948123931885, 75.90848302841187, 77.10748481750488, 78.30688738822937, 79.50628995895386, 80.69838356971741, 81.89047718048096, 83.08688354492188, 84.2832899093628, 85.47686338424683, 86.67043685913086, 87.84817624092102, 89.02591562271118, 90.20790982246399, 91.3899040222168, 92.58396291732788, 93.77802181243896, 94.97175645828247, 96.16549110412598, 97.35643553733826, 98.54737997055054, 99.73868155479431, 100.92998313903809, 102.12003922462463, 103.31009531021118, 104.50206279754639, 105.69403028488159, 106.88622570037842, 108.07842111587524, 109.26393294334412, 110.44944477081299, 111.63335347175598, 112.81726217269897, 114.00416016578674, 115.19105815887451, 116.3771562576294, 117.56325435638428, 118.75790190696716, 119.95254945755005, 121.14245247840881, 122.33235549926758, 123.52330374717712, 124.71425199508667, 125.91064858436584, 127.10704517364502, 128.29391527175903, 129.48078536987305, 130.67063212394714, 131.86047887802124, 133.04852938652039, 134.23657989501953, 135.42232823371887, 136.6080765724182, 137.793274641037, 138.97847270965576, 140.16411781311035, 141.34976291656494, 142.53008794784546, 143.71041297912598, 144.89215755462646, 146.07390213012695, 147.2722008228302, 148.47049951553345, 149.66288304328918, 150.85526657104492, 152.04585576057434, 153.23644495010376, 154.41974568367004, 155.60304641723633, 156.78495073318481, 157.9668550491333, 159.15620517730713, 160.34555530548096, 161.5349280834198, 162.72430086135864, 163.91887712478638, 165.1134533882141, 166.30792951583862, 167.50240564346313, 168.69636464118958, 169.89032363891602, 171.07753086090088, 172.26473808288574, 173.4650297164917, 174.66532135009766, 175.93261647224426, 177.19991159439087, 178.40765357017517, 179.61539554595947, 180.81831121444702, 182.02122688293457, 183.20955348014832, 184.39788007736206, 185.58296275138855, 186.76804542541504, 187.9517366886139, 189.13542795181274, 190.31828141212463, 191.50113487243652, 192.69333505630493, 193.88553524017334, 195.07175612449646, 196.25797700881958, 197.45389437675476, 198.64981174468994, 199.8412218093872, 201.03263187408447, 202.2237901687622, 203.41494846343994, 204.6018521785736, 205.78875589370728, 206.9770143032074, 208.16527271270752, 209.3509805202484, 210.5366883277893, 211.72396993637085, 212.9112515449524, 214.09930849075317, 215.28736543655396, 216.47616171836853, 217.6649580001831, 218.69005513191223, 219.71515226364136, 220.7407078742981, 221.76626348495483, 222.79131031036377, 223.8163571357727, 224.8492865562439, 225.8822159767151, 226.91021823883057, 227.93822050094604, 228.96664428710938, 229.9950680732727, 231.02355885505676, 232.05204963684082, 233.08133101463318, 234.11061239242554, 235.13728404045105, 236.16395568847656, 238.23092484474182, 240.29789400100708]
[29.44, 29.44, 32.66, 32.66, 38.86, 38.86, 41.28, 41.28, 46.53, 46.53, 46.77, 46.77, 48.9, 48.9, 50.35, 50.35, 51.85, 51.85, 55.57, 55.57, 55.69, 55.69, 56.59, 56.59, 58.4, 58.4, 59.19, 59.19, 59.92, 59.92, 60.96, 60.96, 61.44, 61.44, 62.24, 62.24, 63.76, 63.76, 63.98, 63.98, 64.51, 64.51, 64.73, 64.73, 65.22, 65.22, 66.14, 66.14, 65.58, 65.58, 66.33, 66.33, 67.12, 67.12, 67.42, 67.42, 67.48, 67.48, 67.49, 67.49, 67.89, 67.89, 67.86, 67.86, 67.68, 67.68, 67.5, 67.5, 67.59, 67.59, 68.62, 68.62, 69.06, 69.06, 68.33, 68.33, 68.57, 68.57, 68.47, 68.47, 68.35, 68.35, 68.82, 68.82, 68.32, 68.32, 68.44, 68.44, 68.25, 68.25, 68.51, 68.51, 69.44, 69.44, 69.2, 69.2, 69.4, 69.4, 69.33, 69.33, 69.88, 69.88, 69.99, 69.99, 70.01, 70.01, 70.11, 70.11, 70.6, 70.6, 70.05, 70.05, 69.96, 69.96, 70.36, 70.36, 70.62, 70.62, 70.89, 70.89, 70.86, 70.86, 70.68, 70.68, 70.99, 70.99, 70.46, 70.46, 69.91, 69.91, 70.5, 70.5, 71.34, 71.34, 71.61, 71.61, 70.52, 70.52, 70.28, 70.28, 71.25, 71.25, 71.58, 71.58, 71.13, 71.13, 71.57, 71.57, 71.42, 71.42, 70.95, 70.95, 70.69, 70.69, 71.12, 71.12, 71.8, 71.8, 71.78, 71.78, 71.79, 71.79, 71.79, 71.79, 71.31, 71.31, 71.72, 71.72, 71.37, 71.37, 71.13, 71.13, 71.03, 71.03, 71.43, 71.43, 71.35, 71.35, 71.81, 71.81, 71.42, 71.42, 71.58, 71.58, 71.03, 71.03, 71.55, 71.55, 70.94, 70.94, 70.48, 70.48, 71.18, 71.18, 70.69, 70.69, 70.54, 70.54, 70.92, 70.92, 70.99, 70.99]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.638, Test loss: 2.052, Test accuracy: 24.43
Round   0, Global train loss: 1.638, Global test loss: 2.228, Global test accuracy: 21.68
Round   1, Train loss: 1.465, Test loss: 1.777, Test accuracy: 32.43
Round   1, Global train loss: 1.465, Global test loss: 2.041, Global test accuracy: 25.93
Round   2, Train loss: 1.340, Test loss: 1.596, Test accuracy: 38.33
Round   2, Global train loss: 1.340, Global test loss: 1.950, Global test accuracy: 30.57
Round   3, Train loss: 1.311, Test loss: 1.451, Test accuracy: 42.11
Round   3, Global train loss: 1.311, Global test loss: 1.890, Global test accuracy: 30.17
Round   4, Train loss: 1.266, Test loss: 1.358, Test accuracy: 46.68
Round   4, Global train loss: 1.266, Global test loss: 1.976, Global test accuracy: 34.31
Round   5, Train loss: 1.210, Test loss: 1.357, Test accuracy: 46.98
Round   5, Global train loss: 1.210, Global test loss: 1.942, Global test accuracy: 36.14
Round   6, Train loss: 1.178, Test loss: 1.289, Test accuracy: 49.50
Round   6, Global train loss: 1.178, Global test loss: 1.844, Global test accuracy: 38.72
Round   7, Train loss: 1.135, Test loss: 1.291, Test accuracy: 51.34
Round   7, Global train loss: 1.135, Global test loss: 2.173, Global test accuracy: 33.20
Round   8, Train loss: 1.106, Test loss: 1.265, Test accuracy: 51.65
Round   8, Global train loss: 1.106, Global test loss: 1.942, Global test accuracy: 38.36
Round   9, Train loss: 1.078, Test loss: 1.157, Test accuracy: 55.07
Round   9, Global train loss: 1.078, Global test loss: 1.735, Global test accuracy: 39.78
Round  10, Train loss: 1.166, Test loss: 1.134, Test accuracy: 55.65
Round  10, Global train loss: 1.166, Global test loss: 1.579, Global test accuracy: 41.72
Round  11, Train loss: 0.999, Test loss: 1.135, Test accuracy: 56.45
Round  11, Global train loss: 0.999, Global test loss: 1.674, Global test accuracy: 40.88
Round  12, Train loss: 1.060, Test loss: 1.054, Test accuracy: 59.43
Round  12, Global train loss: 1.060, Global test loss: 1.675, Global test accuracy: 40.91
Round  13, Train loss: 0.958, Test loss: 1.058, Test accuracy: 59.24
Round  13, Global train loss: 0.958, Global test loss: 1.626, Global test accuracy: 44.67
Round  14, Train loss: 1.002, Test loss: 1.072, Test accuracy: 58.97
Round  14, Global train loss: 1.002, Global test loss: 1.569, Global test accuracy: 43.14
Round  15, Train loss: 0.990, Test loss: 1.059, Test accuracy: 59.63
Round  15, Global train loss: 0.990, Global test loss: 1.714, Global test accuracy: 43.47
Round  16, Train loss: 0.929, Test loss: 1.057, Test accuracy: 59.99
Round  16, Global train loss: 0.929, Global test loss: 1.683, Global test accuracy: 43.91
Round  17, Train loss: 0.915, Test loss: 1.051, Test accuracy: 60.47
Round  17, Global train loss: 0.915, Global test loss: 1.457, Global test accuracy: 47.50
Round  18, Train loss: 0.967, Test loss: 1.035, Test accuracy: 61.40
Round  18, Global train loss: 0.967, Global test loss: 1.522, Global test accuracy: 44.26
Round  19, Train loss: 0.889, Test loss: 1.018, Test accuracy: 62.07
Round  19, Global train loss: 0.889, Global test loss: 1.650, Global test accuracy: 42.64
Round  20, Train loss: 0.858, Test loss: 0.995, Test accuracy: 63.23
Round  20, Global train loss: 0.858, Global test loss: 1.509, Global test accuracy: 46.51
Round  21, Train loss: 0.824, Test loss: 0.996, Test accuracy: 63.36
Round  21, Global train loss: 0.824, Global test loss: 1.520, Global test accuracy: 46.24
Round  22, Train loss: 0.951, Test loss: 0.978, Test accuracy: 64.12
Round  22, Global train loss: 0.951, Global test loss: 1.353, Global test accuracy: 50.96
Round  23, Train loss: 0.861, Test loss: 0.958, Test accuracy: 65.14
Round  23, Global train loss: 0.861, Global test loss: 1.287, Global test accuracy: 54.03
Round  24, Train loss: 0.808, Test loss: 0.964, Test accuracy: 65.29
Round  24, Global train loss: 0.808, Global test loss: 1.345, Global test accuracy: 51.84
Round  25, Train loss: 0.844, Test loss: 0.958, Test accuracy: 65.58
Round  25, Global train loss: 0.844, Global test loss: 1.338, Global test accuracy: 51.95
Round  26, Train loss: 0.821, Test loss: 0.963, Test accuracy: 65.67
Round  26, Global train loss: 0.821, Global test loss: 1.321, Global test accuracy: 52.82
Round  27, Train loss: 0.766, Test loss: 0.969, Test accuracy: 65.82
Round  27, Global train loss: 0.766, Global test loss: 1.680, Global test accuracy: 45.39
Round  28, Train loss: 0.759, Test loss: 0.969, Test accuracy: 66.21
Round  28, Global train loss: 0.759, Global test loss: 1.248, Global test accuracy: 56.25
Round  29, Train loss: 0.701, Test loss: 0.950, Test accuracy: 66.59
Round  29, Global train loss: 0.701, Global test loss: 1.528, Global test accuracy: 49.65
Round  30, Train loss: 0.858, Test loss: 0.943, Test accuracy: 66.95
Round  30, Global train loss: 0.858, Global test loss: 1.245, Global test accuracy: 55.29
Round  31, Train loss: 0.669, Test loss: 0.957, Test accuracy: 66.87
Round  31, Global train loss: 0.669, Global test loss: 1.417, Global test accuracy: 50.86
Round  32, Train loss: 0.644, Test loss: 0.975, Test accuracy: 66.59
Round  32, Global train loss: 0.644, Global test loss: 1.459, Global test accuracy: 50.98
Round  33, Train loss: 0.834, Test loss: 0.982, Test accuracy: 66.62
Round  33, Global train loss: 0.834, Global test loss: 1.377, Global test accuracy: 52.01
Round  34, Train loss: 0.761, Test loss: 0.947, Test accuracy: 67.40
Round  34, Global train loss: 0.761, Global test loss: 1.437, Global test accuracy: 50.32
Round  35, Train loss: 0.787, Test loss: 0.932, Test accuracy: 67.95
Round  35, Global train loss: 0.787, Global test loss: 1.260, Global test accuracy: 56.17
Round  36, Train loss: 0.743, Test loss: 0.912, Test accuracy: 68.18
Round  36, Global train loss: 0.743, Global test loss: 1.368, Global test accuracy: 52.44
Round  37, Train loss: 0.750, Test loss: 0.907, Test accuracy: 68.58
Round  37, Global train loss: 0.750, Global test loss: 1.262, Global test accuracy: 56.44
Round  38, Train loss: 0.697, Test loss: 0.913, Test accuracy: 68.89
Round  38, Global train loss: 0.697, Global test loss: 1.236, Global test accuracy: 57.93
Round  39, Train loss: 0.642, Test loss: 0.924, Test accuracy: 68.32
Round  39, Global train loss: 0.642, Global test loss: 1.219, Global test accuracy: 57.96
Round  40, Train loss: 0.616, Test loss: 0.925, Test accuracy: 68.27
Round  40, Global train loss: 0.616, Global test loss: 1.348, Global test accuracy: 55.19
Round  41, Train loss: 0.631, Test loss: 0.941, Test accuracy: 67.67
Round  41, Global train loss: 0.631, Global test loss: 1.265, Global test accuracy: 57.90
Round  42, Train loss: 0.570, Test loss: 0.952, Test accuracy: 67.99
Round  42, Global train loss: 0.570, Global test loss: 1.409, Global test accuracy: 54.30
Round  43, Train loss: 0.659, Test loss: 0.937, Test accuracy: 67.98
Round  43, Global train loss: 0.659, Global test loss: 1.298, Global test accuracy: 56.66
Round  44, Train loss: 0.707, Test loss: 0.935, Test accuracy: 68.02
Round  44, Global train loss: 0.707, Global test loss: 1.302, Global test accuracy: 56.69
Round  45, Train loss: 0.689, Test loss: 0.950, Test accuracy: 67.87
Round  45, Global train loss: 0.689, Global test loss: 1.206, Global test accuracy: 59.15
Round  46, Train loss: 0.710, Test loss: 0.954, Test accuracy: 67.81
Round  46, Global train loss: 0.710, Global test loss: 1.216, Global test accuracy: 58.23
Round  47, Train loss: 0.580, Test loss: 0.956, Test accuracy: 68.19
Round  47, Global train loss: 0.580, Global test loss: 1.385, Global test accuracy: 56.59
Round  48, Train loss: 0.644, Test loss: 0.975, Test accuracy: 68.21
Round  48, Global train loss: 0.644, Global test loss: 1.226, Global test accuracy: 59.12
Round  49, Train loss: 0.665, Test loss: 0.970, Test accuracy: 68.29
Round  49, Global train loss: 0.665, Global test loss: 1.324, Global test accuracy: 56.09
Round  50, Train loss: 0.552, Test loss: 0.965, Test accuracy: 67.97
Round  50, Global train loss: 0.552, Global test loss: 1.166, Global test accuracy: 60.70
Round  51, Train loss: 0.498, Test loss: 0.950, Test accuracy: 68.67
Round  51, Global train loss: 0.498, Global test loss: 1.256, Global test accuracy: 58.74
Round  52, Train loss: 0.565, Test loss: 0.964, Test accuracy: 68.61
Round  52, Global train loss: 0.565, Global test loss: 1.272, Global test accuracy: 57.95
Round  53, Train loss: 0.582, Test loss: 0.973, Test accuracy: 68.30
Round  53, Global train loss: 0.582, Global test loss: 1.241, Global test accuracy: 59.79
Round  54, Train loss: 0.564, Test loss: 0.962, Test accuracy: 68.75
Round  54, Global train loss: 0.564, Global test loss: 1.252, Global test accuracy: 58.91
Round  55, Train loss: 0.541, Test loss: 0.949, Test accuracy: 69.37
Round  55, Global train loss: 0.541, Global test loss: 1.299, Global test accuracy: 59.40
Round  56, Train loss: 0.527, Test loss: 0.948, Test accuracy: 69.55
Round  56, Global train loss: 0.527, Global test loss: 1.239, Global test accuracy: 60.57
Round  57, Train loss: 0.581, Test loss: 0.970, Test accuracy: 69.28
Round  57, Global train loss: 0.581, Global test loss: 1.203, Global test accuracy: 60.76
Round  58, Train loss: 0.502, Test loss: 0.984, Test accuracy: 68.72
Round  58, Global train loss: 0.502, Global test loss: 1.454, Global test accuracy: 55.32
Round  59, Train loss: 0.591, Test loss: 1.013, Test accuracy: 68.48
Round  59, Global train loss: 0.591, Global test loss: 1.327, Global test accuracy: 57.36
Round  60, Train loss: 0.534, Test loss: 1.018, Test accuracy: 68.61
Round  60, Global train loss: 0.534, Global test loss: 1.296, Global test accuracy: 58.32
Round  61, Train loss: 0.498, Test loss: 0.999, Test accuracy: 68.91
Round  61, Global train loss: 0.498, Global test loss: 1.265, Global test accuracy: 59.73
Round  62, Train loss: 0.574, Test loss: 1.022, Test accuracy: 68.40
Round  62, Global train loss: 0.574, Global test loss: 1.483, Global test accuracy: 54.45
Round  63, Train loss: 0.492, Test loss: 1.020, Test accuracy: 68.99
Round  63, Global train loss: 0.492, Global test loss: 1.322, Global test accuracy: 58.38
Round  64, Train loss: 0.547, Test loss: 1.043, Test accuracy: 68.35
Round  64, Global train loss: 0.547, Global test loss: 1.408, Global test accuracy: 56.47
Round  65, Train loss: 0.546, Test loss: 1.036, Test accuracy: 68.27
Round  65, Global train loss: 0.546, Global test loss: 1.206, Global test accuracy: 60.25
Round  66, Train loss: 0.487, Test loss: 1.018, Test accuracy: 68.78
Round  66, Global train loss: 0.487, Global test loss: 1.326, Global test accuracy: 58.47
Round  67, Train loss: 0.419, Test loss: 1.022, Test accuracy: 69.20
Round  67, Global train loss: 0.419, Global test loss: 1.316, Global test accuracy: 59.31
Round  68, Train loss: 0.526, Test loss: 1.031, Test accuracy: 68.93
Round  68, Global train loss: 0.526, Global test loss: 1.222, Global test accuracy: 60.28
Round  69, Train loss: 0.524, Test loss: 1.019, Test accuracy: 69.32
Round  69, Global train loss: 0.524, Global test loss: 1.195, Global test accuracy: 61.39
Round  70, Train loss: 0.512, Test loss: 1.018, Test accuracy: 69.75
Round  70, Global train loss: 0.512, Global test loss: 1.381, Global test accuracy: 56.75
Round  71, Train loss: 0.407, Test loss: 1.020, Test accuracy: 69.88
Round  71, Global train loss: 0.407, Global test loss: 1.460, Global test accuracy: 57.32
Round  72, Train loss: 0.428, Test loss: 1.012, Test accuracy: 69.70
Round  72, Global train loss: 0.428, Global test loss: 1.319, Global test accuracy: 60.36
Round  73, Train loss: 0.451, Test loss: 1.030, Test accuracy: 69.37
Round  73, Global train loss: 0.451, Global test loss: 1.199, Global test accuracy: 61.31
Round  74, Train loss: 0.470, Test loss: 1.005, Test accuracy: 69.65
Round  74, Global train loss: 0.470, Global test loss: 1.268, Global test accuracy: 60.71
Round  75, Train loss: 0.506, Test loss: 1.035, Test accuracy: 69.39
Round  75, Global train loss: 0.506, Global test loss: 1.358, Global test accuracy: 59.12
Round  76, Train loss: 0.397, Test loss: 1.016, Test accuracy: 69.58
Round  76, Global train loss: 0.397, Global test loss: 1.325, Global test accuracy: 60.35
Round  77, Train loss: 0.487, Test loss: 1.027, Test accuracy: 69.44
Round  77, Global train loss: 0.487, Global test loss: 1.282, Global test accuracy: 59.85
Round  78, Train loss: 0.447, Test loss: 1.028, Test accuracy: 69.52
Round  78, Global train loss: 0.447, Global test loss: 1.336, Global test accuracy: 59.92
Round  79, Train loss: 0.499, Test loss: 1.031, Test accuracy: 69.28
Round  79, Global train loss: 0.499, Global test loss: 1.306, Global test accuracy: 59.29
Round  80, Train loss: 0.468, Test loss: 1.016, Test accuracy: 69.69
Round  80, Global train loss: 0.468, Global test loss: 1.331, Global test accuracy: 59.53
Round  81, Train loss: 0.467, Test loss: 1.020, Test accuracy: 69.80
Round  81, Global train loss: 0.467, Global test loss: 1.398, Global test accuracy: 58.52
Round  82, Train loss: 0.463, Test loss: 1.013, Test accuracy: 69.94
Round  82, Global train loss: 0.463, Global test loss: 1.273, Global test accuracy: 60.40
Round  83, Train loss: 0.406, Test loss: 1.038, Test accuracy: 69.89
Round  83, Global train loss: 0.406, Global test loss: 1.308, Global test accuracy: 60.54
Round  84, Train loss: 0.407, Test loss: 1.023, Test accuracy: 70.08
Round  84, Global train loss: 0.407, Global test loss: 1.207, Global test accuracy: 62.62
Round  85, Train loss: 0.490, Test loss: 1.040, Test accuracy: 69.66
Round  85, Global train loss: 0.490, Global test loss: 1.327, Global test accuracy: 59.44
Round  86, Train loss: 0.386, Test loss: 1.035, Test accuracy: 69.80
Round  86, Global train loss: 0.386, Global test loss: 1.352, Global test accuracy: 60.15
Round  87, Train loss: 0.381, Test loss: 1.029, Test accuracy: 70.04
Round  87, Global train loss: 0.381, Global test loss: 1.223, Global test accuracy: 62.39
Round  88, Train loss: 0.430, Test loss: 1.055, Test accuracy: 69.59
Round  88, Global train loss: 0.430, Global test loss: 1.300, Global test accuracy: 60.02
Round  89, Train loss: 0.413, Test loss: 1.061, Test accuracy: 69.50
Round  89, Global train loss: 0.413, Global test loss: 1.505, Global test accuracy: 56.81
Round  90, Train loss: 0.424, Test loss: 1.064, Test accuracy: 69.71
Round  90, Global train loss: 0.424, Global test loss: 1.359, Global test accuracy: 59.03
Round  91, Train loss: 0.426, Test loss: 1.087, Test accuracy: 69.41
Round  91, Global train loss: 0.426, Global test loss: 1.290, Global test accuracy: 60.91
Round  92, Train loss: 0.420, Test loss: 1.098, Test accuracy: 69.35
Round  92, Global train loss: 0.420, Global test loss: 1.495, Global test accuracy: 58.02
Round  93, Train loss: 0.430, Test loss: 1.109, Test accuracy: 69.35
Round  93, Global train loss: 0.430, Global test loss: 1.430, Global test accuracy: 58.41
Round  94, Train loss: 0.378, Test loss: 1.103, Test accuracy: 69.41
Round  94, Global train loss: 0.378, Global test loss: 1.324, Global test accuracy: 61.00
Round  95, Train loss: 0.412, Test loss: 1.098, Test accuracy: 69.87
Round  95, Global train loss: 0.412, Global test loss: 1.612, Global test accuracy: 55.82
Round  96, Train loss: 0.398, Test loss: 1.135, Test accuracy: 69.41
Round  96, Global train loss: 0.398, Global test loss: 1.391, Global test accuracy: 60.87
Round  97, Train loss: 0.422, Test loss: 1.141, Test accuracy: 69.14
Round  97, Global train loss: 0.422, Global test loss: 1.405, Global test accuracy: 59.58
Round  98, Train loss: 0.362, Test loss: 1.119, Test accuracy: 69.60
Round  98, Global train loss: 0.362, Global test loss: 1.387, Global test accuracy: 60.35
Round  99, Train loss: 0.388, Test loss: 1.113, Test accuracy: 69.66
Round  99, Global train loss: 0.388, Global test loss: 1.325, Global test accuracy: 61.81
Final Round, Train loss: 0.303, Test loss: 1.208, Test accuracy: 70.29
Final Round, Global train loss: 0.303, Global test loss: 1.325, Global test accuracy: 61.81
Average accuracy final 10 rounds: 69.491
Average global accuracy final 10 rounds: 59.58
1852.4709498882294
[2.6803157329559326, 5.141578435897827, 7.610618829727173, 10.081477403640747, 12.548003911972046, 15.035559892654419, 17.521119832992554, 19.979207515716553, 22.453667879104614, 24.89988398551941, 27.344691514968872, 29.793556928634644, 32.242642402648926, 34.694291830062866, 37.154695987701416, 39.63053274154663, 42.111067056655884, 44.59485220909119, 47.0760612487793, 49.55279278755188, 52.026127576828, 54.506102561950684, 56.97980856895447, 59.45252275466919, 61.91118669509888, 64.37866187095642, 66.53540706634521, 68.69341444969177, 70.84920954704285, 73.0056369304657, 75.15329837799072, 77.29753351211548, 79.4385175704956, 81.57991647720337, 83.73948192596436, 85.90189719200134, 88.05601453781128, 90.21851825714111, 92.37568163871765, 94.53020191192627, 96.67809414863586, 98.83940601348877, 101.00366735458374, 103.16260528564453, 105.32785177230835, 107.4833517074585, 109.63589906692505, 111.78460335731506, 113.93167066574097, 116.36177682876587, 118.78393983840942, 121.19349932670593, 123.62978553771973, 126.06338572502136, 128.47733116149902, 130.89181423187256, 133.03171968460083, 135.16874408721924, 137.30798649787903, 139.4528591632843, 141.59610390663147, 143.73610544204712, 145.87532424926758, 148.01305961608887, 150.15091276168823, 152.29038214683533, 154.43737649917603, 156.58279967308044, 158.72426581382751, 160.87016987800598, 163.01302218437195, 165.15768194198608, 167.30127215385437, 169.4531524181366, 171.59472751617432, 173.73661589622498, 175.87959456443787, 178.02306938171387, 180.16421031951904, 182.30344605445862, 184.450345993042, 186.59699177742004, 188.75819444656372, 190.92648720741272, 193.08817863464355, 195.25019669532776, 197.41195249557495, 199.57639122009277, 201.73765230178833, 203.8985185623169, 206.06349754333496, 208.2097098827362, 210.35192036628723, 212.49304747581482, 214.63258957862854, 216.77219009399414, 218.9176516532898, 221.05568194389343, 223.19516396522522, 225.33891034126282, 229.21588444709778]
[24.43, 32.43, 38.33, 42.11, 46.68, 46.98, 49.5, 51.34, 51.65, 55.07, 55.65, 56.45, 59.43, 59.24, 58.97, 59.63, 59.99, 60.47, 61.4, 62.07, 63.23, 63.36, 64.12, 65.14, 65.29, 65.58, 65.67, 65.82, 66.21, 66.59, 66.95, 66.87, 66.59, 66.62, 67.4, 67.95, 68.18, 68.58, 68.89, 68.32, 68.27, 67.67, 67.99, 67.98, 68.02, 67.87, 67.81, 68.19, 68.21, 68.29, 67.97, 68.67, 68.61, 68.3, 68.75, 69.37, 69.55, 69.28, 68.72, 68.48, 68.61, 68.91, 68.4, 68.99, 68.35, 68.27, 68.78, 69.2, 68.93, 69.32, 69.75, 69.88, 69.7, 69.37, 69.65, 69.39, 69.58, 69.44, 69.52, 69.28, 69.69, 69.8, 69.94, 69.89, 70.08, 69.66, 69.8, 70.04, 69.59, 69.5, 69.71, 69.41, 69.35, 69.35, 69.41, 69.87, 69.41, 69.14, 69.6, 69.66, 70.29]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  16.7500
Round 1 global test acc  19.7400
Round 2 global test acc  17.2300
Round 3 global test acc  26.3300
Round 4 global test acc  22.8300
Round 5 global test acc  26.2300
Round 6 global test acc  27.0000
Round 7 global test acc  28.0500
Round 8 global test acc  32.0200
Round 9 global test acc  34.7900
Round 10 global test acc  29.8700
Round 11 global test acc  27.4100
Round 12 global test acc  38.6500
Round 13 global test acc  29.8400
Round 14 global test acc  29.7900
Round 15 global test acc  29.6800
Round 16 global test acc  25.4400
Round 17 global test acc  31.5700
Round 18 global test acc  33.6100
Round 19 global test acc  38.3500
Round 20 global test acc  35.1300
Round 21 global test acc  36.2700
Round 22 global test acc  38.5200
Round 23 global test acc  32.2300
Round 24 global test acc  32.1100
Round 25 global test acc  35.7700
Round 26 global test acc  38.6100
Round 27 global test acc  30.4000
Round 28 global test acc  34.6900
Round 29 global test acc  37.9300
Round 30 global test acc  33.2600
Round 31 global test acc  36.4000
Round 32 global test acc  34.8800
Round 33 global test acc  39.4300
Round 34 global test acc  38.2000
Round 35 global test acc  39.4100
Round 36 global test acc  33.6700
Round 37 global test acc  36.7400
Round 38 global test acc  35.4800
Round 39 global test acc  39.8400
Round 40 global test acc  37.3500
Round 41 global test acc  36.2600
Round 42 global test acc  42.2200
Round 43 global test acc  47.6100
Round 44 global test acc  47.5500
Round 45 global test acc  34.1000
Round 46 global test acc  36.2300
Round 47 global test acc  37.3600
Round 48 global test acc  42.8300
Round 49 global test acc  43.3300
Round 50 global test acc  39.6500
Round 51 global test acc  33.3500
Round 52 global test acc  39.7900
Round 53 global test acc  45.0700
Round 54 global test acc  38.7300
Round 55 global test acc  40.4700
Round 56 global test acc  38.2100
Round 57 global test acc  39.6900
Round 58 global test acc  36.4200
Round 59 global test acc  42.9800
Round 60 global test acc  38.7300
Round 61 global test acc  36.4400
Round 62 global test acc  42.4400
Round 63 global test acc  41.3800
Round 64 global test acc  49.3600
Round 65 global test acc  37.4600
Round 66 global test acc  47.9600
Round 67 global test acc  41.9000
Round 68 global test acc  50.5600
Round 69 global test acc  39.9200
Round 70 global test acc  40.4600
Round 71 global test acc  42.0200
Round 72 global test acc  36.6500
Round 73 global test acc  42.1000
Round 74 global test acc  43.7500
Round 75 global test acc  44.4600
Round 76 global test acc  35.1900
Round 77 global test acc  51.8700
Round 78 global test acc  52.6300
Round 79 global test acc  52.7800
Round 80 global test acc  51.4800
Round 81 global test acc  49.5300
Round 82 global test acc  45.6500
Round 83 global test acc  42.8600
Round 84 global test acc  41.3800
Round 85 global test acc  39.8100
Round 86 global test acc  39.2000
Round 87 global test acc  37.7100
Round 88 global test acc  35.7700
Round 89 global test acc  33.0900
Round 90 global test acc  33.1900
Round 91 global test acc  30.9400
Round 92 global test acc  29.4400
Round 93 global test acc  28.1600
Round 94 global test acc  28.2700
Round 95 global test acc  27.3200
Round 96 global test acc  26.8900
Round 97 global test acc  25.7100
Round 98 global test acc  25.2700
Round 99 global test acc  24.3300
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.928, Test loss: 2.132, Test accuracy: 18.68
Round   1, Train loss: 1.512, Test loss: 1.849, Test accuracy: 31.13
Round   2, Train loss: 1.373, Test loss: 1.641, Test accuracy: 37.61
Round   3, Train loss: 1.320, Test loss: 1.522, Test accuracy: 40.45
Round   4, Train loss: 1.318, Test loss: 1.382, Test accuracy: 46.16
Round   5, Train loss: 1.268, Test loss: 1.378, Test accuracy: 47.36
Round   6, Train loss: 1.256, Test loss: 1.289, Test accuracy: 50.65
Round   7, Train loss: 1.204, Test loss: 1.324, Test accuracy: 51.02
Round   8, Train loss: 1.201, Test loss: 1.286, Test accuracy: 50.78
Round   9, Train loss: 1.178, Test loss: 1.130, Test accuracy: 55.18
Round  10, Train loss: 1.112, Test loss: 1.089, Test accuracy: 57.03
Round  11, Train loss: 1.060, Test loss: 1.121, Test accuracy: 56.31
Round  12, Train loss: 1.080, Test loss: 1.042, Test accuracy: 59.78
Round  13, Train loss: 1.021, Test loss: 1.012, Test accuracy: 60.62
Round  14, Train loss: 1.034, Test loss: 1.007, Test accuracy: 61.39
Round  15, Train loss: 1.105, Test loss: 1.004, Test accuracy: 60.86
Round  16, Train loss: 1.028, Test loss: 0.998, Test accuracy: 61.68
Round  17, Train loss: 0.976, Test loss: 0.963, Test accuracy: 62.41
Round  18, Train loss: 1.022, Test loss: 0.927, Test accuracy: 64.19
Round  19, Train loss: 0.971, Test loss: 0.939, Test accuracy: 63.65
Round  20, Train loss: 0.961, Test loss: 0.911, Test accuracy: 64.90
Round  21, Train loss: 0.959, Test loss: 0.909, Test accuracy: 65.23
Round  22, Train loss: 1.028, Test loss: 0.904, Test accuracy: 65.74
Round  23, Train loss: 0.963, Test loss: 0.876, Test accuracy: 65.98
Round  24, Train loss: 1.014, Test loss: 0.871, Test accuracy: 67.08
Round  25, Train loss: 0.922, Test loss: 0.866, Test accuracy: 66.78
Round  26, Train loss: 0.915, Test loss: 0.849, Test accuracy: 67.55
Round  27, Train loss: 0.918, Test loss: 0.848, Test accuracy: 67.98
Round  28, Train loss: 0.883, Test loss: 0.850, Test accuracy: 67.62
Round  29, Train loss: 0.888, Test loss: 0.847, Test accuracy: 67.60
Round  30, Train loss: 0.889, Test loss: 0.824, Test accuracy: 68.84
Round  31, Train loss: 0.799, Test loss: 0.818, Test accuracy: 68.47
Round  32, Train loss: 0.857, Test loss: 0.808, Test accuracy: 69.21
Round  33, Train loss: 0.959, Test loss: 0.806, Test accuracy: 69.63
Round  34, Train loss: 0.742, Test loss: 0.791, Test accuracy: 69.96
Round  35, Train loss: 0.855, Test loss: 0.794, Test accuracy: 69.70
Round  36, Train loss: 0.734, Test loss: 0.780, Test accuracy: 70.66
Round  37, Train loss: 0.722, Test loss: 0.776, Test accuracy: 70.29
Round  38, Train loss: 0.795, Test loss: 0.767, Test accuracy: 71.01
Round  39, Train loss: 0.683, Test loss: 0.767, Test accuracy: 71.01
Round  40, Train loss: 0.792, Test loss: 0.765, Test accuracy: 70.89
Round  41, Train loss: 0.820, Test loss: 0.762, Test accuracy: 71.16
Round  42, Train loss: 0.704, Test loss: 0.761, Test accuracy: 71.43
Round  43, Train loss: 0.647, Test loss: 0.742, Test accuracy: 71.97
Round  44, Train loss: 0.804, Test loss: 0.742, Test accuracy: 72.28
Round  45, Train loss: 0.746, Test loss: 0.743, Test accuracy: 72.38
Round  46, Train loss: 0.890, Test loss: 0.741, Test accuracy: 72.24
Round  47, Train loss: 0.661, Test loss: 0.745, Test accuracy: 72.28
Round  48, Train loss: 0.736, Test loss: 0.735, Test accuracy: 72.46
Round  49, Train loss: 0.863, Test loss: 0.722, Test accuracy: 73.35
Round  50, Train loss: 0.644, Test loss: 0.723, Test accuracy: 73.67
Round  51, Train loss: 0.629, Test loss: 0.721, Test accuracy: 73.63
Round  52, Train loss: 0.752, Test loss: 0.713, Test accuracy: 73.77
Round  53, Train loss: 0.592, Test loss: 0.710, Test accuracy: 73.54
Round  54, Train loss: 0.742, Test loss: 0.707, Test accuracy: 73.74
Round  55, Train loss: 0.715, Test loss: 0.721, Test accuracy: 73.48
Round  56, Train loss: 0.550, Test loss: 0.710, Test accuracy: 73.80
Round  57, Train loss: 0.741, Test loss: 0.714, Test accuracy: 73.87
Round  58, Train loss: 0.699, Test loss: 0.716, Test accuracy: 73.92
Round  59, Train loss: 0.702, Test loss: 0.700, Test accuracy: 74.11
Round  60, Train loss: 0.661, Test loss: 0.696, Test accuracy: 74.41
Round  61, Train loss: 0.614, Test loss: 0.705, Test accuracy: 74.20
Round  62, Train loss: 0.684, Test loss: 0.708, Test accuracy: 73.92
Round  63, Train loss: 0.620, Test loss: 0.702, Test accuracy: 74.25
Round  64, Train loss: 0.604, Test loss: 0.703, Test accuracy: 74.24
Round  65, Train loss: 0.679, Test loss: 0.700, Test accuracy: 74.41
Round  66, Train loss: 0.658, Test loss: 0.704, Test accuracy: 74.62
Round  67, Train loss: 0.559, Test loss: 0.690, Test accuracy: 74.97
Round  68, Train loss: 0.555, Test loss: 0.703, Test accuracy: 74.61
Round  69, Train loss: 0.630, Test loss: 0.703, Test accuracy: 74.24
Round  70, Train loss: 0.704, Test loss: 0.696, Test accuracy: 74.85
Round  71, Train loss: 0.553, Test loss: 0.700, Test accuracy: 74.52
Round  72, Train loss: 0.559, Test loss: 0.691, Test accuracy: 74.88
Round  73, Train loss: 0.607, Test loss: 0.691, Test accuracy: 75.00
Round  74, Train loss: 0.679, Test loss: 0.698, Test accuracy: 75.20
Round  75, Train loss: 0.583, Test loss: 0.692, Test accuracy: 74.71
Round  76, Train loss: 0.655, Test loss: 0.700, Test accuracy: 74.80
Round  77, Train loss: 0.590, Test loss: 0.699, Test accuracy: 74.91
Round  78, Train loss: 0.619, Test loss: 0.707, Test accuracy: 74.90
Round  79, Train loss: 0.568, Test loss: 0.701, Test accuracy: 75.44
Round  80, Train loss: 0.561, Test loss: 0.690, Test accuracy: 75.44
Round  81, Train loss: 0.505, Test loss: 0.723, Test accuracy: 74.18
Round  82, Train loss: 0.572, Test loss: 0.703, Test accuracy: 75.09
Round  83, Train loss: 0.530, Test loss: 0.698, Test accuracy: 74.93
Round  84, Train loss: 0.527, Test loss: 0.697, Test accuracy: 74.65
Round  85, Train loss: 0.621, Test loss: 0.694, Test accuracy: 75.33
Round  86, Train loss: 0.508, Test loss: 0.696, Test accuracy: 75.04
Round  87, Train loss: 0.516, Test loss: 0.690, Test accuracy: 75.22
Round  88, Train loss: 0.536, Test loss: 0.693, Test accuracy: 75.11
Round  89, Train loss: 0.471, Test loss: 0.696, Test accuracy: 75.05
Round  90, Train loss: 0.588, Test loss: 0.702, Test accuracy: 74.93
Round  91, Train loss: 0.608, Test loss: 0.696, Test accuracy: 75.40
Round  92, Train loss: 0.461, Test loss: 0.692, Test accuracy: 75.48
Round  93, Train loss: 0.553, Test loss: 0.699, Test accuracy: 75.11
Round  94, Train loss: 0.576, Test loss: 0.703, Test accuracy: 74.94
Round  95, Train loss: 0.518, Test loss: 0.699, Test accuracy: 75.10
Round  96, Train loss: 0.510, Test loss: 0.705, Test accuracy: 74.96
Round  97, Train loss: 0.511, Test loss: 0.699, Test accuracy: 75.63
Round  98, Train loss: 0.439, Test loss: 0.703, Test accuracy: 75.42
Round  99, Train loss: 0.480, Test loss: 0.707, Test accuracy: 75.00
Final Round, Train loss: 0.437, Test loss: 0.708, Test accuracy: 75.26
Average accuracy final 10 rounds: 75.197
978.3710649013519
[1.611945390701294, 2.8825390338897705, 4.097124814987183, 5.372282981872559, 6.650675535202026, 7.925101280212402, 9.20134449005127, 10.472675800323486, 11.759697675704956, 13.038435220718384, 14.313820600509644, 15.594207286834717, 16.869338989257812, 18.147042274475098, 19.42219090461731, 20.694286346435547, 21.96944522857666, 23.246110916137695, 24.519285440444946, 25.793288946151733, 27.064024925231934, 28.336838722229004, 29.613207817077637, 30.884845733642578, 32.15771722793579, 33.4345064163208, 34.707366704940796, 35.97973418235779, 37.25194716453552, 38.525043964385986, 39.79443120956421, 41.06835079193115, 42.342875242233276, 43.6186420917511, 44.89203858375549, 46.17371439933777, 47.447519302368164, 48.72378349304199, 49.998491048812866, 51.265063524246216, 52.533860206604004, 53.80027794837952, 55.06840538978577, 56.337175369262695, 57.60910511016846, 58.883216857910156, 60.16635513305664, 61.448721408843994, 62.71916341781616, 63.99047350883484, 65.25968337059021, 66.53044033050537, 67.80423712730408, 69.0773606300354, 70.35100984573364, 71.62382125854492, 72.75154256820679, 73.88275289535522, 75.01728701591492, 76.14399695396423, 77.2724540233612, 78.40059018135071, 79.52977633476257, 80.66071319580078, 81.78887510299683, 82.91778612136841, 84.0504744052887, 85.18069672584534, 86.30895829200745, 87.43920063972473, 88.56953811645508, 89.70108413696289, 90.8257007598877, 91.9432430267334, 93.06273603439331, 94.18381190299988, 95.30549335479736, 96.42391467094421, 97.54336214065552, 98.66693162918091, 99.78738164901733, 100.91533994674683, 102.04611396789551, 103.17367887496948, 104.30411553382874, 105.43577980995178, 106.56460857391357, 107.69243669509888, 108.8209707736969, 109.95188426971436, 111.07844996452332, 112.19661974906921, 113.3171157836914, 114.43608593940735, 115.5576753616333, 116.68437194824219, 117.8165602684021, 118.94736886024475, 120.08372783660889, 121.2152726650238, 123.07693600654602]
[18.68, 31.13, 37.61, 40.45, 46.16, 47.36, 50.65, 51.02, 50.78, 55.18, 57.03, 56.31, 59.78, 60.62, 61.39, 60.86, 61.68, 62.41, 64.19, 63.65, 64.9, 65.23, 65.74, 65.98, 67.08, 66.78, 67.55, 67.98, 67.62, 67.6, 68.84, 68.47, 69.21, 69.63, 69.96, 69.7, 70.66, 70.29, 71.01, 71.01, 70.89, 71.16, 71.43, 71.97, 72.28, 72.38, 72.24, 72.28, 72.46, 73.35, 73.67, 73.63, 73.77, 73.54, 73.74, 73.48, 73.8, 73.87, 73.92, 74.11, 74.41, 74.2, 73.92, 74.25, 74.24, 74.41, 74.62, 74.97, 74.61, 74.24, 74.85, 74.52, 74.88, 75.0, 75.2, 74.71, 74.8, 74.91, 74.9, 75.44, 75.44, 74.18, 75.09, 74.93, 74.65, 75.33, 75.04, 75.22, 75.11, 75.05, 74.93, 75.4, 75.48, 75.11, 74.94, 75.1, 74.96, 75.63, 75.42, 75.0, 75.26]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.620, Test loss: 1.983, Test accuracy: 28.96
Round   0, Global train loss: 1.620, Global test loss: 2.182, Global test accuracy: 26.21
Round   1, Train loss: 1.448, Test loss: 1.737, Test accuracy: 33.76
Round   1, Global train loss: 1.448, Global test loss: 2.022, Global test accuracy: 26.86
Round   2, Train loss: 1.341, Test loss: 1.525, Test accuracy: 40.21
Round   2, Global train loss: 1.341, Global test loss: 1.905, Global test accuracy: 31.03
Round   3, Train loss: 1.284, Test loss: 1.434, Test accuracy: 42.95
Round   3, Global train loss: 1.284, Global test loss: 1.943, Global test accuracy: 28.08
Round   4, Train loss: 1.245, Test loss: 1.316, Test accuracy: 48.49
Round   4, Global train loss: 1.245, Global test loss: 2.019, Global test accuracy: 33.19
Round   5, Train loss: 1.197, Test loss: 1.311, Test accuracy: 48.93
Round   5, Global train loss: 1.197, Global test loss: 1.868, Global test accuracy: 37.81
Round   6, Train loss: 1.178, Test loss: 1.249, Test accuracy: 50.99
Round   6, Global train loss: 1.178, Global test loss: 1.784, Global test accuracy: 38.62
Round   7, Train loss: 1.141, Test loss: 1.270, Test accuracy: 51.92
Round   7, Global train loss: 1.141, Global test loss: 2.013, Global test accuracy: 32.83
Round   8, Train loss: 1.109, Test loss: 1.226, Test accuracy: 52.72
Round   8, Global train loss: 1.109, Global test loss: 1.763, Global test accuracy: 39.67
Round   9, Train loss: 1.076, Test loss: 1.122, Test accuracy: 56.23
Round   9, Global train loss: 1.076, Global test loss: 1.606, Global test accuracy: 41.98
Round  10, Train loss: 1.035, Test loss: 1.082, Test accuracy: 57.56
Round  10, Global train loss: 1.035, Global test loss: 1.492, Global test accuracy: 45.50
Round  11, Train loss: 1.035, Test loss: 1.086, Test accuracy: 58.23
Round  11, Global train loss: 1.035, Global test loss: 1.631, Global test accuracy: 41.70
Round  12, Train loss: 0.929, Test loss: 1.018, Test accuracy: 60.45
Round  12, Global train loss: 0.929, Global test loss: 1.581, Global test accuracy: 43.68
Round  13, Train loss: 0.931, Test loss: 1.012, Test accuracy: 61.08
Round  13, Global train loss: 0.931, Global test loss: 1.577, Global test accuracy: 45.36
Round  14, Train loss: 0.972, Test loss: 0.998, Test accuracy: 61.87
Round  14, Global train loss: 0.972, Global test loss: 1.504, Global test accuracy: 45.23
Round  15, Train loss: 0.954, Test loss: 1.001, Test accuracy: 61.95
Round  15, Global train loss: 0.954, Global test loss: 1.693, Global test accuracy: 43.49
Round  16, Train loss: 0.892, Test loss: 1.003, Test accuracy: 62.20
Round  16, Global train loss: 0.892, Global test loss: 1.653, Global test accuracy: 45.29
Round  17, Train loss: 0.902, Test loss: 0.988, Test accuracy: 62.52
Round  17, Global train loss: 0.902, Global test loss: 1.413, Global test accuracy: 49.39
Round  18, Train loss: 0.930, Test loss: 0.971, Test accuracy: 63.53
Round  18, Global train loss: 0.930, Global test loss: 1.473, Global test accuracy: 46.89
Round  19, Train loss: 0.867, Test loss: 0.944, Test accuracy: 64.47
Round  19, Global train loss: 0.867, Global test loss: 1.565, Global test accuracy: 44.41
Round  20, Train loss: 0.928, Test loss: 0.929, Test accuracy: 64.95
Round  20, Global train loss: 0.928, Global test loss: 1.487, Global test accuracy: 46.65
Round  21, Train loss: 0.858, Test loss: 0.933, Test accuracy: 64.67
Round  21, Global train loss: 0.858, Global test loss: 1.461, Global test accuracy: 47.83
Round  22, Train loss: 0.872, Test loss: 0.931, Test accuracy: 64.75
Round  22, Global train loss: 0.872, Global test loss: 1.341, Global test accuracy: 51.74
Round  23, Train loss: 0.844, Test loss: 0.926, Test accuracy: 65.48
Round  23, Global train loss: 0.844, Global test loss: 1.261, Global test accuracy: 55.38
Round  24, Train loss: 0.768, Test loss: 0.937, Test accuracy: 65.49
Round  24, Global train loss: 0.768, Global test loss: 1.405, Global test accuracy: 52.07
Round  25, Train loss: 0.782, Test loss: 0.914, Test accuracy: 66.14
Round  25, Global train loss: 0.782, Global test loss: 1.300, Global test accuracy: 53.21
Round  26, Train loss: 0.783, Test loss: 0.913, Test accuracy: 66.41
Round  26, Global train loss: 0.783, Global test loss: 1.334, Global test accuracy: 53.16
Round  27, Train loss: 0.739, Test loss: 0.902, Test accuracy: 67.22
Round  27, Global train loss: 0.739, Global test loss: 1.473, Global test accuracy: 49.40
Round  28, Train loss: 0.755, Test loss: 0.909, Test accuracy: 67.23
Round  28, Global train loss: 0.755, Global test loss: 1.281, Global test accuracy: 55.49
Round  29, Train loss: 0.759, Test loss: 0.888, Test accuracy: 68.15
Round  29, Global train loss: 0.759, Global test loss: 1.408, Global test accuracy: 51.46
Round  30, Train loss: 0.753, Test loss: 0.874, Test accuracy: 68.48
Round  30, Global train loss: 0.753, Global test loss: 1.285, Global test accuracy: 54.19
Round  31, Train loss: 0.672, Test loss: 0.878, Test accuracy: 68.29
Round  31, Global train loss: 0.672, Global test loss: 1.448, Global test accuracy: 49.42
Round  32, Train loss: 0.684, Test loss: 0.877, Test accuracy: 68.17
Round  32, Global train loss: 0.684, Global test loss: 1.400, Global test accuracy: 51.46
Round  33, Train loss: 0.712, Test loss: 0.895, Test accuracy: 67.94
Round  33, Global train loss: 0.712, Global test loss: 1.329, Global test accuracy: 52.13
Round  34, Train loss: 0.668, Test loss: 0.900, Test accuracy: 68.08
Round  34, Global train loss: 0.668, Global test loss: 1.461, Global test accuracy: 50.65
Round  35, Train loss: 0.696, Test loss: 0.889, Test accuracy: 68.92
Round  35, Global train loss: 0.696, Global test loss: 1.244, Global test accuracy: 56.59
Round  36, Train loss: 0.646, Test loss: 0.902, Test accuracy: 68.19
Round  36, Global train loss: 0.646, Global test loss: 1.420, Global test accuracy: 51.21
Round  37, Train loss: 0.596, Test loss: 0.882, Test accuracy: 69.26
Round  37, Global train loss: 0.596, Global test loss: 1.203, Global test accuracy: 59.13
Round  38, Train loss: 0.627, Test loss: 0.883, Test accuracy: 69.36
Round  38, Global train loss: 0.627, Global test loss: 1.188, Global test accuracy: 59.04
Round  39, Train loss: 0.632, Test loss: 0.892, Test accuracy: 69.07
Round  39, Global train loss: 0.632, Global test loss: 1.238, Global test accuracy: 58.27
Round  40, Train loss: 0.653, Test loss: 0.894, Test accuracy: 69.53
Round  40, Global train loss: 0.653, Global test loss: 1.314, Global test accuracy: 56.65
Round  41, Train loss: 0.624, Test loss: 0.877, Test accuracy: 69.97
Round  41, Global train loss: 0.624, Global test loss: 1.243, Global test accuracy: 58.01
Round  42, Train loss: 0.629, Test loss: 0.876, Test accuracy: 69.85
Round  42, Global train loss: 0.629, Global test loss: 1.401, Global test accuracy: 53.16
Round  43, Train loss: 0.580, Test loss: 0.885, Test accuracy: 69.83
Round  43, Global train loss: 0.580, Global test loss: 1.300, Global test accuracy: 57.59
Round  44, Train loss: 0.620, Test loss: 0.886, Test accuracy: 69.66
Round  44, Global train loss: 0.620, Global test loss: 1.238, Global test accuracy: 58.10
Round  45, Train loss: 0.581, Test loss: 0.882, Test accuracy: 70.31
Round  45, Global train loss: 0.581, Global test loss: 1.192, Global test accuracy: 59.68
Round  46, Train loss: 0.619, Test loss: 0.877, Test accuracy: 70.19
Round  46, Global train loss: 0.619, Global test loss: 1.272, Global test accuracy: 57.47
Round  47, Train loss: 0.594, Test loss: 0.906, Test accuracy: 70.02
Round  47, Global train loss: 0.594, Global test loss: 1.404, Global test accuracy: 56.33
Round  48, Train loss: 0.572, Test loss: 0.914, Test accuracy: 69.81
Round  48, Global train loss: 0.572, Global test loss: 1.130, Global test accuracy: 61.88
Round  49, Train loss: 0.589, Test loss: 0.913, Test accuracy: 69.75
Round  49, Global train loss: 0.589, Global test loss: 1.423, Global test accuracy: 53.17
Round  50, Train loss: 0.499, Test loss: 0.918, Test accuracy: 69.91
Round  50, Global train loss: 0.499, Global test loss: 1.199, Global test accuracy: 59.60
Round  51, Train loss: 0.504, Test loss: 0.916, Test accuracy: 69.96
Round  51, Global train loss: 0.504, Global test loss: 1.274, Global test accuracy: 58.26
Round  52, Train loss: 0.539, Test loss: 0.900, Test accuracy: 70.54
Round  52, Global train loss: 0.539, Global test loss: 1.269, Global test accuracy: 57.47
Round  53, Train loss: 0.542, Test loss: 0.896, Test accuracy: 70.38
Round  53, Global train loss: 0.542, Global test loss: 1.231, Global test accuracy: 59.96
Round  54, Train loss: 0.508, Test loss: 0.893, Test accuracy: 70.71
Round  54, Global train loss: 0.508, Global test loss: 1.333, Global test accuracy: 57.24
Round  55, Train loss: 0.506, Test loss: 0.913, Test accuracy: 70.31
Round  55, Global train loss: 0.506, Global test loss: 1.260, Global test accuracy: 60.27
Round  56, Train loss: 0.466, Test loss: 0.919, Test accuracy: 70.34
Round  56, Global train loss: 0.466, Global test loss: 1.218, Global test accuracy: 60.68
Round  57, Train loss: 0.542, Test loss: 0.915, Test accuracy: 70.34
Round  57, Global train loss: 0.542, Global test loss: 1.201, Global test accuracy: 60.15
Round  58, Train loss: 0.528, Test loss: 0.931, Test accuracy: 69.47
Round  58, Global train loss: 0.528, Global test loss: 1.400, Global test accuracy: 56.20
Round  59, Train loss: 0.566, Test loss: 0.930, Test accuracy: 70.15
Round  59, Global train loss: 0.566, Global test loss: 1.317, Global test accuracy: 58.28
Round  60, Train loss: 0.496, Test loss: 0.947, Test accuracy: 69.87
Round  60, Global train loss: 0.496, Global test loss: 1.219, Global test accuracy: 60.01
Round  61, Train loss: 0.505, Test loss: 0.941, Test accuracy: 70.38
Round  61, Global train loss: 0.505, Global test loss: 1.270, Global test accuracy: 59.01
Round  62, Train loss: 0.515, Test loss: 0.978, Test accuracy: 69.82
Round  62, Global train loss: 0.515, Global test loss: 1.428, Global test accuracy: 55.51
Round  63, Train loss: 0.460, Test loss: 0.951, Test accuracy: 70.18
Round  63, Global train loss: 0.460, Global test loss: 1.229, Global test accuracy: 60.90
Round  64, Train loss: 0.445, Test loss: 0.961, Test accuracy: 69.85
Round  64, Global train loss: 0.445, Global test loss: 1.405, Global test accuracy: 58.40
Round  65, Train loss: 0.461, Test loss: 0.951, Test accuracy: 70.31
Round  65, Global train loss: 0.461, Global test loss: 1.252, Global test accuracy: 60.96
Round  66, Train loss: 0.455, Test loss: 0.950, Test accuracy: 70.28
Round  66, Global train loss: 0.455, Global test loss: 1.370, Global test accuracy: 57.77
Round  67, Train loss: 0.425, Test loss: 0.962, Test accuracy: 70.10
Round  67, Global train loss: 0.425, Global test loss: 1.285, Global test accuracy: 60.47
Round  68, Train loss: 0.437, Test loss: 0.962, Test accuracy: 70.06
Round  68, Global train loss: 0.437, Global test loss: 1.265, Global test accuracy: 60.32
Round  69, Train loss: 0.507, Test loss: 0.962, Test accuracy: 70.31
Round  69, Global train loss: 0.507, Global test loss: 1.159, Global test accuracy: 62.50
Round  70, Train loss: 0.430, Test loss: 0.971, Test accuracy: 70.49
Round  70, Global train loss: 0.430, Global test loss: 1.445, Global test accuracy: 55.91
Round  71, Train loss: 0.405, Test loss: 0.991, Test accuracy: 70.08
Round  71, Global train loss: 0.405, Global test loss: 1.447, Global test accuracy: 58.08
Round  72, Train loss: 0.440, Test loss: 0.996, Test accuracy: 70.24
Round  72, Global train loss: 0.440, Global test loss: 1.324, Global test accuracy: 60.41
Round  73, Train loss: 0.433, Test loss: 0.995, Test accuracy: 70.33
Round  73, Global train loss: 0.433, Global test loss: 1.235, Global test accuracy: 61.39
Round  74, Train loss: 0.458, Test loss: 1.006, Test accuracy: 70.53
Round  74, Global train loss: 0.458, Global test loss: 1.329, Global test accuracy: 59.68
Round  75, Train loss: 0.452, Test loss: 0.979, Test accuracy: 70.54
Round  75, Global train loss: 0.452, Global test loss: 1.305, Global test accuracy: 60.31
Round  76, Train loss: 0.420, Test loss: 0.974, Test accuracy: 70.97
Round  76, Global train loss: 0.420, Global test loss: 1.270, Global test accuracy: 60.73
Round  77, Train loss: 0.392, Test loss: 0.975, Test accuracy: 70.91
Round  77, Global train loss: 0.392, Global test loss: 1.248, Global test accuracy: 61.09
Round  78, Train loss: 0.467, Test loss: 1.008, Test accuracy: 70.61
Round  78, Global train loss: 0.467, Global test loss: 1.273, Global test accuracy: 61.14
Round  79, Train loss: 0.381, Test loss: 1.045, Test accuracy: 69.92
Round  79, Global train loss: 0.381, Global test loss: 1.267, Global test accuracy: 61.88
Round  80, Train loss: 0.387, Test loss: 1.044, Test accuracy: 70.34
Round  80, Global train loss: 0.387, Global test loss: 1.332, Global test accuracy: 60.39
Round  81, Train loss: 0.380, Test loss: 1.051, Test accuracy: 70.17
Round  81, Global train loss: 0.380, Global test loss: 1.437, Global test accuracy: 59.18
Round  82, Train loss: 0.406, Test loss: 1.028, Test accuracy: 70.89
Round  82, Global train loss: 0.406, Global test loss: 1.241, Global test accuracy: 61.70
Round  83, Train loss: 0.413, Test loss: 1.034, Test accuracy: 70.78
Round  83, Global train loss: 0.413, Global test loss: 1.298, Global test accuracy: 61.26
Round  84, Train loss: 0.353, Test loss: 1.020, Test accuracy: 71.18
Round  84, Global train loss: 0.353, Global test loss: 1.202, Global test accuracy: 63.59
Round  85, Train loss: 0.390, Test loss: 1.011, Test accuracy: 71.42
Round  85, Global train loss: 0.390, Global test loss: 1.318, Global test accuracy: 60.40
Round  86, Train loss: 0.363, Test loss: 1.024, Test accuracy: 70.98
Round  86, Global train loss: 0.363, Global test loss: 1.338, Global test accuracy: 60.41
Round  87, Train loss: 0.365, Test loss: 1.011, Test accuracy: 71.36
Round  87, Global train loss: 0.365, Global test loss: 1.214, Global test accuracy: 63.43
Round  88, Train loss: 0.377, Test loss: 1.001, Test accuracy: 71.75
Round  88, Global train loss: 0.377, Global test loss: 1.258, Global test accuracy: 62.53
Round  89, Train loss: 0.360, Test loss: 1.007, Test accuracy: 71.35
Round  89, Global train loss: 0.360, Global test loss: 1.414, Global test accuracy: 59.53
Round  90, Train loss: 0.394, Test loss: 1.021, Test accuracy: 71.22
Round  90, Global train loss: 0.394, Global test loss: 1.304, Global test accuracy: 60.93
Round  91, Train loss: 0.337, Test loss: 1.025, Test accuracy: 71.59
Round  91, Global train loss: 0.337, Global test loss: 1.291, Global test accuracy: 62.41
Round  92, Train loss: 0.377, Test loss: 1.038, Test accuracy: 71.54
Round  92, Global train loss: 0.377, Global test loss: 1.475, Global test accuracy: 59.25
Round  93, Train loss: 0.367, Test loss: 1.047, Test accuracy: 71.51
Round  93, Global train loss: 0.367, Global test loss: 1.328, Global test accuracy: 60.81
Round  94, Train loss: 0.354, Test loss: 1.038, Test accuracy: 71.56
Round  94, Global train loss: 0.354, Global test loss: 1.313, Global test accuracy: 61.24
Round  95, Train loss: 0.351, Test loss: 1.048, Test accuracy: 71.64
Round  95, Global train loss: 0.351, Global test loss: 1.618, Global test accuracy: 55.58
Round  96, Train loss: 0.366, Test loss: 1.049, Test accuracy: 71.93
Round  96, Global train loss: 0.366, Global test loss: 1.353, Global test accuracy: 60.91
Round  97, Train loss: 0.388, Test loss: 1.048, Test accuracy: 71.73
Round  97, Global train loss: 0.388, Global test loss: 1.426, Global test accuracy: 59.21
Round  98, Train loss: 0.364, Test loss: 1.058, Test accuracy: 71.50
Round  98, Global train loss: 0.364, Global test loss: 1.365, Global test accuracy: 60.74
Round  99, Train loss: 0.338, Test loss: 1.067, Test accuracy: 71.47
Round  99, Global train loss: 0.338, Global test loss: 1.337, Global test accuracy: 61.44
Final Round, Train loss: 0.274, Test loss: 1.170, Test accuracy: 71.67
Final Round, Global train loss: 0.274, Global test loss: 1.337, Global test accuracy: 61.44
Average accuracy final 10 rounds: 71.56900000000002
Average global accuracy final 10 rounds: 60.251999999999995
1612.8622000217438
[1.426429271697998, 2.5661022663116455, 3.7013378143310547, 4.837566614151001, 5.820871591567993, 6.8102943897247314, 7.7956647872924805, 8.77805471420288, 9.765886783599854, 10.751229286193848, 11.734840154647827, 12.71742844581604, 13.699140071868896, 14.689554452896118, 15.672976016998291, 16.653126001358032, 17.63495945930481, 18.61681842803955, 19.59875464439392, 20.58385396003723, 21.56849217414856, 23.717726469039917, 25.851486444473267, 27.98227310180664, 30.1153781414032, 32.245842695236206, 34.37968969345093, 36.51222062110901, 38.64602470397949, 40.77682638168335, 42.907878160476685, 45.037678241729736, 47.173893213272095, 49.3058021068573, 51.43892741203308, 53.57178068161011, 55.7110481262207, 57.84239959716797, 59.97287964820862, 62.10382628440857, 64.33092904090881, 66.46463799476624, 68.59730958938599, 70.73016691207886, 72.8629059791565, 74.99589729309082, 77.12869143486023, 79.257159948349, 81.41441917419434, 83.54661107063293, 85.68185687065125, 87.83503127098083, 89.99918580055237, 92.14395570755005, 94.28096103668213, 96.42508792877197, 98.55649709701538, 100.69381046295166, 102.84899711608887, 104.98375082015991, 107.11590909957886, 109.24546003341675, 111.39121460914612, 113.55119252204895, 115.68656897544861, 117.8403959274292, 119.97960209846497, 122.11027646064758, 124.23774814605713, 126.37227129936218, 128.52093052864075, 130.6492280960083, 132.85793709754944, 135.00351405143738, 137.12430620193481, 139.25019431114197, 141.37606573104858, 143.5018789768219, 145.64373397827148, 147.76693892478943, 149.8955864906311, 152.02247095108032, 154.14714527130127, 156.27188777923584, 158.40140533447266, 160.52766847610474, 162.651917219162, 164.77638959884644, 166.90149807929993, 169.02708864212036, 171.15349006652832, 173.27807807922363, 175.40435361862183, 177.53478837013245, 179.66143989562988, 181.78632164001465, 183.91512751579285, 186.04772973060608, 188.1717426776886, 190.3064844608307, 192.26074719429016]
[28.96, 33.76, 40.21, 42.95, 48.49, 48.93, 50.99, 51.92, 52.72, 56.23, 57.56, 58.23, 60.45, 61.08, 61.87, 61.95, 62.2, 62.52, 63.53, 64.47, 64.95, 64.67, 64.75, 65.48, 65.49, 66.14, 66.41, 67.22, 67.23, 68.15, 68.48, 68.29, 68.17, 67.94, 68.08, 68.92, 68.19, 69.26, 69.36, 69.07, 69.53, 69.97, 69.85, 69.83, 69.66, 70.31, 70.19, 70.02, 69.81, 69.75, 69.91, 69.96, 70.54, 70.38, 70.71, 70.31, 70.34, 70.34, 69.47, 70.15, 69.87, 70.38, 69.82, 70.18, 69.85, 70.31, 70.28, 70.1, 70.06, 70.31, 70.49, 70.08, 70.24, 70.33, 70.53, 70.54, 70.97, 70.91, 70.61, 69.92, 70.34, 70.17, 70.89, 70.78, 71.18, 71.42, 70.98, 71.36, 71.75, 71.35, 71.22, 71.59, 71.54, 71.51, 71.56, 71.64, 71.93, 71.73, 71.5, 71.47, 71.67]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.479, Test loss: 1.275, Test accuracy: 46.04
Round   0, Global train loss: 1.479, Global test loss: 2.118, Global test accuracy: 28.81
Round   1, Train loss: 1.274, Test loss: 1.145, Test accuracy: 52.73
Round   1, Global train loss: 1.274, Global test loss: 1.811, Global test accuracy: 35.25
Round   2, Train loss: 1.144, Test loss: 1.086, Test accuracy: 57.23
Round   2, Global train loss: 1.144, Global test loss: 1.667, Global test accuracy: 38.85
Round   3, Train loss: 1.065, Test loss: 1.050, Test accuracy: 59.30
Round   3, Global train loss: 1.065, Global test loss: 1.587, Global test accuracy: 40.80
Round   4, Train loss: 1.007, Test loss: 1.021, Test accuracy: 60.62
Round   4, Global train loss: 1.007, Global test loss: 1.510, Global test accuracy: 43.04
Round   5, Train loss: 0.946, Test loss: 1.003, Test accuracy: 62.07
Round   5, Global train loss: 0.946, Global test loss: 1.450, Global test accuracy: 45.23
Round   6, Train loss: 0.899, Test loss: 1.001, Test accuracy: 63.15
Round   6, Global train loss: 0.899, Global test loss: 1.397, Global test accuracy: 47.82
Round   7, Train loss: 0.850, Test loss: 1.012, Test accuracy: 63.11
Round   7, Global train loss: 0.850, Global test loss: 1.353, Global test accuracy: 49.85
Round   8, Train loss: 0.807, Test loss: 0.991, Test accuracy: 63.61
Round   8, Global train loss: 0.807, Global test loss: 1.299, Global test accuracy: 52.61
Round   9, Train loss: 0.769, Test loss: 0.980, Test accuracy: 64.86
Round   9, Global train loss: 0.769, Global test loss: 1.269, Global test accuracy: 53.43
Round  10, Train loss: 0.708, Test loss: 0.983, Test accuracy: 64.76
Round  10, Global train loss: 0.708, Global test loss: 1.276, Global test accuracy: 54.31
Round  11, Train loss: 0.665, Test loss: 0.979, Test accuracy: 65.34
Round  11, Global train loss: 0.665, Global test loss: 1.436, Global test accuracy: 50.84
Round  12, Train loss: 0.674, Test loss: 0.997, Test accuracy: 65.24
Round  12, Global train loss: 0.674, Global test loss: 1.521, Global test accuracy: 49.11
Round  13, Train loss: 0.616, Test loss: 0.999, Test accuracy: 65.21
Round  13, Global train loss: 0.616, Global test loss: 1.540, Global test accuracy: 50.59
Round  14, Train loss: 0.626, Test loss: 1.008, Test accuracy: 65.35
Round  14, Global train loss: 0.626, Global test loss: 1.446, Global test accuracy: 51.03
Round  15, Train loss: 0.587, Test loss: 1.025, Test accuracy: 65.51
Round  15, Global train loss: 0.587, Global test loss: 1.600, Global test accuracy: 50.06
Round  16, Train loss: 0.563, Test loss: 1.026, Test accuracy: 65.81
Round  16, Global train loss: 0.563, Global test loss: 1.564, Global test accuracy: 51.43
Round  17, Train loss: 0.541, Test loss: 1.015, Test accuracy: 66.39
Round  17, Global train loss: 0.541, Global test loss: 1.282, Global test accuracy: 57.04
Round  18, Train loss: 0.591, Test loss: 1.036, Test accuracy: 66.72
Round  18, Global train loss: 0.591, Global test loss: 1.412, Global test accuracy: 52.86
Round  19, Train loss: 0.495, Test loss: 1.050, Test accuracy: 66.48
Round  19, Global train loss: 0.495, Global test loss: 1.677, Global test accuracy: 49.97
Round  20, Train loss: 0.517, Test loss: 1.062, Test accuracy: 66.94
Round  20, Global train loss: 0.517, Global test loss: 1.487, Global test accuracy: 54.13
Round  21, Train loss: 0.464, Test loss: 1.056, Test accuracy: 67.33
Round  21, Global train loss: 0.464, Global test loss: 1.469, Global test accuracy: 54.02
Round  22, Train loss: 0.552, Test loss: 1.057, Test accuracy: 67.79
Round  22, Global train loss: 0.552, Global test loss: 1.259, Global test accuracy: 58.11
Round  23, Train loss: 0.501, Test loss: 1.067, Test accuracy: 68.04
Round  23, Global train loss: 0.501, Global test loss: 1.241, Global test accuracy: 59.09
Round  24, Train loss: 0.433, Test loss: 1.076, Test accuracy: 67.80
Round  24, Global train loss: 0.433, Global test loss: 1.464, Global test accuracy: 56.16
Round  25, Train loss: 0.416, Test loss: 1.100, Test accuracy: 67.87
Round  25, Global train loss: 0.416, Global test loss: 1.346, Global test accuracy: 58.58
Round  26, Train loss: 0.447, Test loss: 1.077, Test accuracy: 68.86
Round  26, Global train loss: 0.447, Global test loss: 1.312, Global test accuracy: 58.98
Round  27, Train loss: 0.400, Test loss: 1.091, Test accuracy: 68.80
Round  27, Global train loss: 0.400, Global test loss: 1.685, Global test accuracy: 52.30
Round  28, Train loss: 0.364, Test loss: 1.086, Test accuracy: 69.45
Round  28, Global train loss: 0.364, Global test loss: 1.304, Global test accuracy: 60.35
Round  29, Train loss: 0.356, Test loss: 1.089, Test accuracy: 69.37
Round  29, Global train loss: 0.356, Global test loss: 1.527, Global test accuracy: 57.26
Round  30, Train loss: 0.456, Test loss: 1.116, Test accuracy: 69.38
Round  30, Global train loss: 0.456, Global test loss: 1.343, Global test accuracy: 58.94
Round  31, Train loss: 0.336, Test loss: 1.123, Test accuracy: 69.27
Round  31, Global train loss: 0.336, Global test loss: 1.578, Global test accuracy: 55.17
Round  32, Train loss: 0.314, Test loss: 1.106, Test accuracy: 70.01
Round  32, Global train loss: 0.314, Global test loss: 1.525, Global test accuracy: 58.14
Round  33, Train loss: 0.394, Test loss: 1.122, Test accuracy: 69.89
Round  33, Global train loss: 0.394, Global test loss: 1.414, Global test accuracy: 57.53
Round  34, Train loss: 0.383, Test loss: 1.130, Test accuracy: 69.67
Round  34, Global train loss: 0.383, Global test loss: 1.598, Global test accuracy: 53.53
Round  35, Train loss: 0.354, Test loss: 1.158, Test accuracy: 69.34
Round  35, Global train loss: 0.354, Global test loss: 1.368, Global test accuracy: 59.35
Round  36, Train loss: 0.331, Test loss: 1.153, Test accuracy: 69.77
Round  36, Global train loss: 0.331, Global test loss: 1.617, Global test accuracy: 55.25
Round  37, Train loss: 0.331, Test loss: 1.174, Test accuracy: 69.74
Round  37, Global train loss: 0.331, Global test loss: 1.387, Global test accuracy: 59.68
Round  38, Train loss: 0.334, Test loss: 1.170, Test accuracy: 70.17
Round  38, Global train loss: 0.334, Global test loss: 1.363, Global test accuracy: 59.98
Round  39, Train loss: 0.295, Test loss: 1.152, Test accuracy: 70.73
Round  39, Global train loss: 0.295, Global test loss: 1.473, Global test accuracy: 59.92
Round  40, Train loss: 0.290, Test loss: 1.170, Test accuracy: 70.49
Round  40, Global train loss: 0.290, Global test loss: 1.573, Global test accuracy: 58.84
Round  41, Train loss: 0.296, Test loss: 1.172, Test accuracy: 70.58
Round  41, Global train loss: 0.296, Global test loss: 1.401, Global test accuracy: 61.87
Round  42, Train loss: 0.284, Test loss: 1.195, Test accuracy: 70.72
Round  42, Global train loss: 0.284, Global test loss: 1.657, Global test accuracy: 57.46
Round  43, Train loss: 0.305, Test loss: 1.196, Test accuracy: 70.15
Round  43, Global train loss: 0.305, Global test loss: 1.581, Global test accuracy: 56.62
Round  44, Train loss: 0.356, Test loss: 1.193, Test accuracy: 70.28
Round  44, Global train loss: 0.356, Global test loss: 1.434, Global test accuracy: 58.99
Round  45, Train loss: 0.299, Test loss: 1.207, Test accuracy: 70.30
Round  45, Global train loss: 0.299, Global test loss: 1.357, Global test accuracy: 60.57
Round  46, Train loss: 0.317, Test loss: 1.210, Test accuracy: 70.20
Round  46, Global train loss: 0.317, Global test loss: 1.395, Global test accuracy: 61.40
Round  47, Train loss: 0.270, Test loss: 1.235, Test accuracy: 70.16
Round  47, Global train loss: 0.270, Global test loss: 1.698, Global test accuracy: 58.36
Round  48, Train loss: 0.298, Test loss: 1.214, Test accuracy: 70.52
Round  48, Global train loss: 0.298, Global test loss: 1.327, Global test accuracy: 62.21
Round  49, Train loss: 0.324, Test loss: 1.245, Test accuracy: 70.82
Round  49, Global train loss: 0.324, Global test loss: 1.565, Global test accuracy: 58.49
Round  50, Train loss: 0.243, Test loss: 1.264, Test accuracy: 70.42
Round  50, Global train loss: 0.243, Global test loss: 1.427, Global test accuracy: 61.68
Round  51, Train loss: 0.237, Test loss: 1.255, Test accuracy: 70.39
Round  51, Global train loss: 0.237, Global test loss: 1.468, Global test accuracy: 61.78
Round  52, Train loss: 0.269, Test loss: 1.274, Test accuracy: 70.68
Round  52, Global train loss: 0.269, Global test loss: 1.497, Global test accuracy: 59.40
Round  53, Train loss: 0.264, Test loss: 1.262, Test accuracy: 70.90
Round  53, Global train loss: 0.264, Global test loss: 1.565, Global test accuracy: 60.41
Round  54, Train loss: 0.262, Test loss: 1.306, Test accuracy: 70.55
Round  54, Global train loss: 0.262, Global test loss: 1.517, Global test accuracy: 60.56
Round  55, Train loss: 0.257, Test loss: 1.279, Test accuracy: 70.65
Round  55, Global train loss: 0.257, Global test loss: 1.487, Global test accuracy: 61.46
Round  56, Train loss: 0.237, Test loss: 1.275, Test accuracy: 70.90
Round  56, Global train loss: 0.237, Global test loss: 1.489, Global test accuracy: 60.91
Round  57, Train loss: 0.248, Test loss: 1.252, Test accuracy: 70.94
Round  57, Global train loss: 0.248, Global test loss: 1.343, Global test accuracy: 62.85
Round  58, Train loss: 0.237, Test loss: 1.253, Test accuracy: 71.00
Round  58, Global train loss: 0.237, Global test loss: 1.641, Global test accuracy: 59.12
Round  59, Train loss: 0.264, Test loss: 1.247, Test accuracy: 71.19
Round  59, Global train loss: 0.264, Global test loss: 1.614, Global test accuracy: 59.60
Round  60, Train loss: 0.240, Test loss: 1.247, Test accuracy: 71.35
Round  60, Global train loss: 0.240, Global test loss: 1.483, Global test accuracy: 60.27
Round  61, Train loss: 0.229, Test loss: 1.255, Test accuracy: 71.20
Round  61, Global train loss: 0.229, Global test loss: 1.523, Global test accuracy: 60.45
Round  62, Train loss: 0.254, Test loss: 1.303, Test accuracy: 70.65
Round  62, Global train loss: 0.254, Global test loss: 1.881, Global test accuracy: 56.28
Round  63, Train loss: 0.209, Test loss: 1.287, Test accuracy: 71.33
Round  63, Global train loss: 0.209, Global test loss: 1.589, Global test accuracy: 60.17
Round  64, Train loss: 0.216, Test loss: 1.280, Test accuracy: 71.51
Round  64, Global train loss: 0.216, Global test loss: 1.609, Global test accuracy: 59.37
Round  65, Train loss: 0.230, Test loss: 1.303, Test accuracy: 71.37
Round  65, Global train loss: 0.230, Global test loss: 1.496, Global test accuracy: 61.83
Round  66, Train loss: 0.214, Test loss: 1.310, Test accuracy: 71.16
Round  66, Global train loss: 0.214, Global test loss: 1.595, Global test accuracy: 60.55
Round  67, Train loss: 0.201, Test loss: 1.291, Test accuracy: 71.21
Round  67, Global train loss: 0.201, Global test loss: 1.593, Global test accuracy: 59.90
Round  68, Train loss: 0.194, Test loss: 1.283, Test accuracy: 71.75
Round  68, Global train loss: 0.194, Global test loss: 1.550, Global test accuracy: 60.63
Round  69, Train loss: 0.271, Test loss: 1.275, Test accuracy: 71.55
Round  69, Global train loss: 0.271, Global test loss: 1.461, Global test accuracy: 62.92
Round  70, Train loss: 0.203, Test loss: 1.284, Test accuracy: 71.28
Round  70, Global train loss: 0.203, Global test loss: 1.787, Global test accuracy: 57.11
Round  71, Train loss: 0.192, Test loss: 1.323, Test accuracy: 71.51
Round  71, Global train loss: 0.192, Global test loss: 1.800, Global test accuracy: 58.97
Round  72, Train loss: 0.192, Test loss: 1.316, Test accuracy: 71.65
Round  72, Global train loss: 0.192, Global test loss: 1.660, Global test accuracy: 59.62
Round  73, Train loss: 0.223, Test loss: 1.313, Test accuracy: 71.39
Round  73, Global train loss: 0.223, Global test loss: 1.476, Global test accuracy: 61.39
Round  74, Train loss: 0.225, Test loss: 1.307, Test accuracy: 71.35
Round  74, Global train loss: 0.225, Global test loss: 1.522, Global test accuracy: 61.17
Round  75, Train loss: 0.223, Test loss: 1.264, Test accuracy: 71.96
Round  75, Global train loss: 0.223, Global test loss: 1.578, Global test accuracy: 60.33
Round  76, Train loss: 0.192, Test loss: 1.266, Test accuracy: 71.71
Round  76, Global train loss: 0.192, Global test loss: 1.583, Global test accuracy: 61.15
Round  77, Train loss: 0.195, Test loss: 1.251, Test accuracy: 71.86
Round  77, Global train loss: 0.195, Global test loss: 1.551, Global test accuracy: 61.04
Round  78, Train loss: 0.205, Test loss: 1.257, Test accuracy: 71.62
Round  78, Global train loss: 0.205, Global test loss: 1.590, Global test accuracy: 60.81
Round  79, Train loss: 0.203, Test loss: 1.276, Test accuracy: 71.79
Round  79, Global train loss: 0.203, Global test loss: 1.567, Global test accuracy: 62.28
Round  80, Train loss: 0.162, Test loss: 1.299, Test accuracy: 72.01
Round  80, Global train loss: 0.162, Global test loss: 1.491, Global test accuracy: 62.93
Round  81, Train loss: 0.149, Test loss: 1.281, Test accuracy: 72.05
Round  81, Global train loss: 0.149, Global test loss: 1.464, Global test accuracy: 63.84
Round  82, Train loss: 0.137, Test loss: 1.307, Test accuracy: 72.02
Round  82, Global train loss: 0.137, Global test loss: 1.539, Global test accuracy: 62.80
Round  83, Train loss: 0.134, Test loss: 1.293, Test accuracy: 71.96
Round  83, Global train loss: 0.134, Global test loss: 1.585, Global test accuracy: 62.27
Round  84, Train loss: 0.121, Test loss: 1.316, Test accuracy: 72.06
Round  84, Global train loss: 0.121, Global test loss: 1.624, Global test accuracy: 62.21
Round  85, Train loss: 0.133, Test loss: 1.343, Test accuracy: 71.99
Round  85, Global train loss: 0.133, Global test loss: 1.622, Global test accuracy: 63.09
Round  86, Train loss: 0.124, Test loss: 1.328, Test accuracy: 71.96
Round  86, Global train loss: 0.124, Global test loss: 1.657, Global test accuracy: 62.67
Round  87, Train loss: 0.116, Test loss: 1.338, Test accuracy: 71.92
Round  87, Global train loss: 0.116, Global test loss: 1.610, Global test accuracy: 62.87
Round  88, Train loss: 0.107, Test loss: 1.342, Test accuracy: 72.31
Round  88, Global train loss: 0.107, Global test loss: 1.688, Global test accuracy: 62.67
Round  89, Train loss: 0.112, Test loss: 1.360, Test accuracy: 71.74
Round  89, Global train loss: 0.112, Global test loss: 1.691, Global test accuracy: 62.66
Round  90, Train loss: 0.194, Test loss: 1.402, Test accuracy: 71.49
Round  90, Global train loss: 0.194, Global test loss: 1.441, Global test accuracy: 64.41
Round  91, Train loss: 0.171, Test loss: 1.405, Test accuracy: 72.01
Round  91, Global train loss: 0.171, Global test loss: 1.451, Global test accuracy: 64.46
Round  92, Train loss: 0.170, Test loss: 1.359, Test accuracy: 72.58
Round  92, Global train loss: 0.170, Global test loss: 1.427, Global test accuracy: 64.47
Round  93, Train loss: 0.166, Test loss: 1.362, Test accuracy: 72.48
Round  93, Global train loss: 0.166, Global test loss: 1.439, Global test accuracy: 64.64
Round  94, Train loss: 0.164, Test loss: 1.353, Test accuracy: 72.53
Round  94, Global train loss: 0.164, Global test loss: 1.436, Global test accuracy: 64.61
Round  95, Train loss: 0.156, Test loss: 1.421, Test accuracy: 72.17
Round  95, Global train loss: 0.156, Global test loss: 1.444, Global test accuracy: 64.97
Round  96, Train loss: 0.155, Test loss: 1.396, Test accuracy: 72.26
Round  96, Global train loss: 0.155, Global test loss: 1.447, Global test accuracy: 64.76
Round  97, Train loss: 0.158, Test loss: 1.408, Test accuracy: 71.98
Round  97, Global train loss: 0.158, Global test loss: 1.438, Global test accuracy: 65.04
Round  98, Train loss: 0.149, Test loss: 1.383, Test accuracy: 71.65
Round  98, Global train loss: 0.149, Global test loss: 1.458, Global test accuracy: 65.15
Round  99, Train loss: 0.153, Test loss: 1.412, Test accuracy: 71.97
Round  99, Global train loss: 0.153, Global test loss: 1.476, Global test accuracy: 64.51
Final Round, Train loss: 0.117, Test loss: 1.493, Test accuracy: 72.15
Final Round, Global train loss: 0.117, Global test loss: 1.476, Global test accuracy: 64.51
Average accuracy final 10 rounds: 72.11200000000001
Average global accuracy final 10 rounds: 64.702
2392.4470357894897
[2.5453274250030518, 4.801809787750244, 7.069473743438721, 9.341623783111572, 11.466294765472412, 13.381380796432495, 15.297553300857544, 17.217692852020264, 19.482654809951782, 21.755897760391235, 24.024217128753662, 26.285091638565063, 28.56052803993225, 30.819291591644287, 33.07463192939758, 35.33520793914795, 37.589131355285645, 39.8559787273407, 42.130850315093994, 44.398542165756226, 46.65862488746643, 48.92864656448364, 51.19163942337036, 53.446941614151, 55.71480321884155, 57.97597289085388, 60.23423099517822, 62.49306583404541, 64.76173329353333, 66.73022103309631, 68.63550519943237, 70.56231808662415, 72.49059700965881, 74.41828989982605, 76.34811449050903, 78.27215647697449, 80.17966675758362, 82.08917498588562, 83.99165368080139, 85.91793322563171, 87.82478713989258, 89.73140096664429, 91.63695621490479, 93.54806089401245, 95.45094037055969, 97.35994553565979, 99.28559160232544, 101.18704891204834, 103.0997884273529, 105.01410603523254, 106.93377232551575, 108.83994579315186, 110.75434160232544, 112.68275833129883, 114.61400318145752, 116.51406764984131, 118.43760657310486, 120.3494975566864, 122.25932884216309, 124.16702628135681, 126.07223081588745, 127.97029995918274, 129.87623262405396, 131.78193926811218, 133.68297696113586, 135.60623955726624, 137.52771592140198, 139.4513020515442, 141.3581259250641, 143.27710485458374, 145.17773723602295, 147.085551738739, 149.01143193244934, 150.91897344589233, 152.83543348312378, 154.7422456741333, 156.66673302650452, 158.5953996181488, 160.51145839691162, 162.42006993293762, 164.34135675430298, 166.61101961135864, 168.8727262020111, 171.13106274604797, 173.3935308456421, 175.65523505210876, 177.9085555076599, 180.172039270401, 182.43973088264465, 184.6966986656189, 186.9575891494751, 189.2317521572113, 191.50801396369934, 193.77936053276062, 195.70976424217224, 197.6371397972107, 199.55747294425964, 201.47077751159668, 203.39793348312378, 205.3290159702301, 209.19557642936707]
[46.04, 52.73, 57.23, 59.3, 60.62, 62.07, 63.15, 63.11, 63.61, 64.86, 64.76, 65.34, 65.24, 65.21, 65.35, 65.51, 65.81, 66.39, 66.72, 66.48, 66.94, 67.33, 67.79, 68.04, 67.8, 67.87, 68.86, 68.8, 69.45, 69.37, 69.38, 69.27, 70.01, 69.89, 69.67, 69.34, 69.77, 69.74, 70.17, 70.73, 70.49, 70.58, 70.72, 70.15, 70.28, 70.3, 70.2, 70.16, 70.52, 70.82, 70.42, 70.39, 70.68, 70.9, 70.55, 70.65, 70.9, 70.94, 71.0, 71.19, 71.35, 71.2, 70.65, 71.33, 71.51, 71.37, 71.16, 71.21, 71.75, 71.55, 71.28, 71.51, 71.65, 71.39, 71.35, 71.96, 71.71, 71.86, 71.62, 71.79, 72.01, 72.05, 72.02, 71.96, 72.06, 71.99, 71.96, 71.92, 72.31, 71.74, 71.49, 72.01, 72.58, 72.48, 72.53, 72.17, 72.26, 71.98, 71.65, 71.97, 72.15]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.514, Test loss: 1.278, Test accuracy: 47.12
Round   0, Global train loss: 1.514, Global test loss: 2.089, Global test accuracy: 29.33
Round   1, Train loss: 1.310, Test loss: 1.166, Test accuracy: 53.27
Round   1, Global train loss: 1.310, Global test loss: 1.818, Global test accuracy: 35.06
Round   2, Train loss: 1.193, Test loss: 1.122, Test accuracy: 56.18
Round   2, Global train loss: 1.193, Global test loss: 1.674, Global test accuracy: 38.97
Round   3, Train loss: 1.113, Test loss: 1.053, Test accuracy: 59.56
Round   3, Global train loss: 1.113, Global test loss: 1.578, Global test accuracy: 42.29
Round   4, Train loss: 1.053, Test loss: 1.051, Test accuracy: 60.35
Round   4, Global train loss: 1.053, Global test loss: 1.503, Global test accuracy: 44.96
Round   5, Train loss: 0.998, Test loss: 1.035, Test accuracy: 61.21
Round   5, Global train loss: 0.998, Global test loss: 1.432, Global test accuracy: 48.24
Round   6, Train loss: 0.944, Test loss: 1.003, Test accuracy: 62.62
Round   6, Global train loss: 0.944, Global test loss: 1.377, Global test accuracy: 49.85
Round   7, Train loss: 0.896, Test loss: 1.022, Test accuracy: 62.57
Round   7, Global train loss: 0.896, Global test loss: 1.337, Global test accuracy: 51.51
Round   8, Train loss: 0.851, Test loss: 0.999, Test accuracy: 63.67
Round   8, Global train loss: 0.851, Global test loss: 1.283, Global test accuracy: 53.69
Round   9, Train loss: 0.809, Test loss: 0.980, Test accuracy: 64.75
Round   9, Global train loss: 0.809, Global test loss: 1.261, Global test accuracy: 54.75
Round  10, Train loss: 0.764, Test loss: 0.978, Test accuracy: 65.24
Round  10, Global train loss: 0.764, Global test loss: 1.334, Global test accuracy: 52.52
Round  11, Train loss: 0.717, Test loss: 0.962, Test accuracy: 65.89
Round  11, Global train loss: 0.717, Global test loss: 1.383, Global test accuracy: 52.61
Round  12, Train loss: 0.672, Test loss: 0.965, Test accuracy: 65.80
Round  12, Global train loss: 0.672, Global test loss: 1.424, Global test accuracy: 50.75
Round  13, Train loss: 0.625, Test loss: 0.975, Test accuracy: 66.29
Round  13, Global train loss: 0.625, Global test loss: 1.487, Global test accuracy: 52.26
Round  14, Train loss: 0.697, Test loss: 0.983, Test accuracy: 66.69
Round  14, Global train loss: 0.697, Global test loss: 1.320, Global test accuracy: 53.67
Round  15, Train loss: 0.601, Test loss: 1.001, Test accuracy: 66.97
Round  15, Global train loss: 0.601, Global test loss: 1.555, Global test accuracy: 52.06
Round  16, Train loss: 0.652, Test loss: 0.990, Test accuracy: 67.32
Round  16, Global train loss: 0.652, Global test loss: 1.507, Global test accuracy: 51.67
Round  17, Train loss: 0.534, Test loss: 0.998, Test accuracy: 67.54
Round  17, Global train loss: 0.534, Global test loss: 1.286, Global test accuracy: 57.20
Round  18, Train loss: 0.594, Test loss: 1.030, Test accuracy: 67.00
Round  18, Global train loss: 0.594, Global test loss: 1.388, Global test accuracy: 54.07
Round  19, Train loss: 0.534, Test loss: 1.037, Test accuracy: 67.27
Round  19, Global train loss: 0.534, Global test loss: 1.588, Global test accuracy: 51.09
Round  20, Train loss: 0.571, Test loss: 1.032, Test accuracy: 67.71
Round  20, Global train loss: 0.571, Global test loss: 1.468, Global test accuracy: 54.55
Round  21, Train loss: 0.532, Test loss: 1.048, Test accuracy: 68.02
Round  21, Global train loss: 0.532, Global test loss: 1.358, Global test accuracy: 55.66
Round  22, Train loss: 0.527, Test loss: 1.044, Test accuracy: 68.30
Round  22, Global train loss: 0.527, Global test loss: 1.388, Global test accuracy: 55.17
Round  23, Train loss: 0.537, Test loss: 1.079, Test accuracy: 67.68
Round  23, Global train loss: 0.537, Global test loss: 1.240, Global test accuracy: 60.08
Round  24, Train loss: 0.419, Test loss: 1.073, Test accuracy: 68.33
Round  24, Global train loss: 0.419, Global test loss: 1.586, Global test accuracy: 54.94
Round  25, Train loss: 0.425, Test loss: 1.115, Test accuracy: 67.90
Round  25, Global train loss: 0.425, Global test loss: 1.332, Global test accuracy: 57.94
Round  26, Train loss: 0.497, Test loss: 1.127, Test accuracy: 68.04
Round  26, Global train loss: 0.497, Global test loss: 1.350, Global test accuracy: 58.98
Round  27, Train loss: 0.444, Test loss: 1.125, Test accuracy: 67.96
Round  27, Global train loss: 0.444, Global test loss: 1.536, Global test accuracy: 54.83
Round  28, Train loss: 0.405, Test loss: 1.139, Test accuracy: 68.18
Round  28, Global train loss: 0.405, Global test loss: 1.367, Global test accuracy: 58.73
Round  29, Train loss: 0.426, Test loss: 1.128, Test accuracy: 68.34
Round  29, Global train loss: 0.426, Global test loss: 1.458, Global test accuracy: 57.55
Round  30, Train loss: 0.437, Test loss: 1.125, Test accuracy: 68.64
Round  30, Global train loss: 0.437, Global test loss: 1.499, Global test accuracy: 56.01
Round  31, Train loss: 0.377, Test loss: 1.124, Test accuracy: 69.06
Round  31, Global train loss: 0.377, Global test loss: 1.447, Global test accuracy: 56.94
Round  32, Train loss: 0.342, Test loss: 1.161, Test accuracy: 68.52
Round  32, Global train loss: 0.342, Global test loss: 1.552, Global test accuracy: 56.35
Round  33, Train loss: 0.435, Test loss: 1.176, Test accuracy: 68.72
Round  33, Global train loss: 0.435, Global test loss: 1.501, Global test accuracy: 56.11
Round  34, Train loss: 0.413, Test loss: 1.170, Test accuracy: 69.05
Round  34, Global train loss: 0.413, Global test loss: 1.604, Global test accuracy: 53.86
Round  35, Train loss: 0.405, Test loss: 1.198, Test accuracy: 68.67
Round  35, Global train loss: 0.405, Global test loss: 1.527, Global test accuracy: 56.99
Round  36, Train loss: 0.340, Test loss: 1.245, Test accuracy: 67.72
Round  36, Global train loss: 0.340, Global test loss: 1.627, Global test accuracy: 53.73
Round  37, Train loss: 0.365, Test loss: 1.218, Test accuracy: 68.35
Round  37, Global train loss: 0.365, Global test loss: 1.417, Global test accuracy: 58.66
Round  38, Train loss: 0.346, Test loss: 1.219, Test accuracy: 68.50
Round  38, Global train loss: 0.346, Global test loss: 1.384, Global test accuracy: 59.46
Round  39, Train loss: 0.350, Test loss: 1.225, Test accuracy: 69.02
Round  39, Global train loss: 0.350, Global test loss: 1.477, Global test accuracy: 58.51
Round  40, Train loss: 0.334, Test loss: 1.224, Test accuracy: 69.27
Round  40, Global train loss: 0.334, Global test loss: 1.652, Global test accuracy: 58.29
Round  41, Train loss: 0.306, Test loss: 1.215, Test accuracy: 69.38
Round  41, Global train loss: 0.306, Global test loss: 1.456, Global test accuracy: 60.25
Round  42, Train loss: 0.318, Test loss: 1.210, Test accuracy: 69.55
Round  42, Global train loss: 0.318, Global test loss: 1.501, Global test accuracy: 57.42
Round  43, Train loss: 0.302, Test loss: 1.200, Test accuracy: 69.45
Round  43, Global train loss: 0.302, Global test loss: 1.527, Global test accuracy: 57.96
Round  44, Train loss: 0.341, Test loss: 1.215, Test accuracy: 69.23
Round  44, Global train loss: 0.341, Global test loss: 1.461, Global test accuracy: 59.43
Round  45, Train loss: 0.289, Test loss: 1.237, Test accuracy: 69.25
Round  45, Global train loss: 0.289, Global test loss: 1.393, Global test accuracy: 60.17
Round  46, Train loss: 0.325, Test loss: 1.255, Test accuracy: 69.03
Round  46, Global train loss: 0.325, Global test loss: 1.494, Global test accuracy: 59.02
Round  47, Train loss: 0.302, Test loss: 1.263, Test accuracy: 69.48
Round  47, Global train loss: 0.302, Global test loss: 1.741, Global test accuracy: 56.52
Round  48, Train loss: 0.298, Test loss: 1.240, Test accuracy: 69.83
Round  48, Global train loss: 0.298, Global test loss: 1.319, Global test accuracy: 61.81
Round  49, Train loss: 0.314, Test loss: 1.246, Test accuracy: 69.12
Round  49, Global train loss: 0.314, Global test loss: 1.642, Global test accuracy: 57.05
Round  50, Train loss: 0.267, Test loss: 1.245, Test accuracy: 69.26
Round  50, Global train loss: 0.267, Global test loss: 1.404, Global test accuracy: 61.41
Round  51, Train loss: 0.238, Test loss: 1.252, Test accuracy: 69.68
Round  51, Global train loss: 0.238, Global test loss: 1.460, Global test accuracy: 61.42
Round  52, Train loss: 0.275, Test loss: 1.292, Test accuracy: 69.22
Round  52, Global train loss: 0.275, Global test loss: 1.541, Global test accuracy: 59.79
Round  53, Train loss: 0.298, Test loss: 1.262, Test accuracy: 69.39
Round  53, Global train loss: 0.298, Global test loss: 1.441, Global test accuracy: 60.58
Round  54, Train loss: 0.271, Test loss: 1.270, Test accuracy: 69.60
Round  54, Global train loss: 0.271, Global test loss: 1.561, Global test accuracy: 58.84
Round  55, Train loss: 0.259, Test loss: 1.294, Test accuracy: 69.88
Round  55, Global train loss: 0.259, Global test loss: 1.577, Global test accuracy: 59.59
Round  56, Train loss: 0.236, Test loss: 1.308, Test accuracy: 69.87
Round  56, Global train loss: 0.236, Global test loss: 1.470, Global test accuracy: 62.04
Round  57, Train loss: 0.271, Test loss: 1.298, Test accuracy: 70.33
Round  57, Global train loss: 0.271, Global test loss: 1.458, Global test accuracy: 61.10
Round  58, Train loss: 0.259, Test loss: 1.281, Test accuracy: 70.44
Round  58, Global train loss: 0.259, Global test loss: 1.717, Global test accuracy: 57.74
Round  59, Train loss: 0.283, Test loss: 1.301, Test accuracy: 70.49
Round  59, Global train loss: 0.283, Global test loss: 1.625, Global test accuracy: 58.27
Round  60, Train loss: 0.240, Test loss: 1.303, Test accuracy: 70.63
Round  60, Global train loss: 0.240, Global test loss: 1.501, Global test accuracy: 60.06
Round  61, Train loss: 0.243, Test loss: 1.315, Test accuracy: 70.51
Round  61, Global train loss: 0.243, Global test loss: 1.519, Global test accuracy: 60.60
Round  62, Train loss: 0.288, Test loss: 1.299, Test accuracy: 70.89
Round  62, Global train loss: 0.288, Global test loss: 1.736, Global test accuracy: 57.77
Round  63, Train loss: 0.240, Test loss: 1.297, Test accuracy: 70.81
Round  63, Global train loss: 0.240, Global test loss: 1.600, Global test accuracy: 59.98
Round  64, Train loss: 0.248, Test loss: 1.295, Test accuracy: 70.95
Round  64, Global train loss: 0.248, Global test loss: 1.702, Global test accuracy: 57.10
Round  65, Train loss: 0.222, Test loss: 1.305, Test accuracy: 70.29
Round  65, Global train loss: 0.222, Global test loss: 1.615, Global test accuracy: 59.17
Round  66, Train loss: 0.228, Test loss: 1.292, Test accuracy: 70.40
Round  66, Global train loss: 0.228, Global test loss: 1.607, Global test accuracy: 59.86
Round  67, Train loss: 0.218, Test loss: 1.321, Test accuracy: 70.46
Round  67, Global train loss: 0.218, Global test loss: 1.691, Global test accuracy: 58.67
Round  68, Train loss: 0.197, Test loss: 1.299, Test accuracy: 70.77
Round  68, Global train loss: 0.197, Global test loss: 1.612, Global test accuracy: 59.30
Round  69, Train loss: 0.307, Test loss: 1.299, Test accuracy: 70.74
Round  69, Global train loss: 0.307, Global test loss: 1.391, Global test accuracy: 62.44
Round  70, Train loss: 0.209, Test loss: 1.303, Test accuracy: 71.06
Round  70, Global train loss: 0.209, Global test loss: 1.810, Global test accuracy: 56.20
Round  71, Train loss: 0.195, Test loss: 1.327, Test accuracy: 70.90
Round  71, Global train loss: 0.195, Global test loss: 1.826, Global test accuracy: 58.48
Round  72, Train loss: 0.220, Test loss: 1.327, Test accuracy: 70.47
Round  72, Global train loss: 0.220, Global test loss: 1.733, Global test accuracy: 58.68
Round  73, Train loss: 0.239, Test loss: 1.333, Test accuracy: 70.32
Round  73, Global train loss: 0.239, Global test loss: 1.522, Global test accuracy: 60.81
Round  74, Train loss: 0.249, Test loss: 1.332, Test accuracy: 70.73
Round  74, Global train loss: 0.249, Global test loss: 1.641, Global test accuracy: 58.80
Round  75, Train loss: 0.239, Test loss: 1.313, Test accuracy: 70.57
Round  75, Global train loss: 0.239, Global test loss: 1.541, Global test accuracy: 60.70
Round  76, Train loss: 0.209, Test loss: 1.327, Test accuracy: 70.46
Round  76, Global train loss: 0.209, Global test loss: 1.614, Global test accuracy: 59.42
Round  77, Train loss: 0.207, Test loss: 1.330, Test accuracy: 70.81
Round  77, Global train loss: 0.207, Global test loss: 1.593, Global test accuracy: 59.65
Round  78, Train loss: 0.234, Test loss: 1.339, Test accuracy: 70.80
Round  78, Global train loss: 0.234, Global test loss: 1.632, Global test accuracy: 60.16
Round  79, Train loss: 0.204, Test loss: 1.369, Test accuracy: 70.50
Round  79, Global train loss: 0.204, Global test loss: 1.504, Global test accuracy: 61.37
Round  80, Train loss: 0.160, Test loss: 1.375, Test accuracy: 70.84
Round  80, Global train loss: 0.160, Global test loss: 1.489, Global test accuracy: 62.93
Round  81, Train loss: 0.146, Test loss: 1.342, Test accuracy: 71.22
Round  81, Global train loss: 0.146, Global test loss: 1.501, Global test accuracy: 63.29
Round  82, Train loss: 0.144, Test loss: 1.376, Test accuracy: 71.26
Round  82, Global train loss: 0.144, Global test loss: 1.531, Global test accuracy: 63.14
Round  83, Train loss: 0.138, Test loss: 1.366, Test accuracy: 71.14
Round  83, Global train loss: 0.138, Global test loss: 1.559, Global test accuracy: 63.00
Round  84, Train loss: 0.132, Test loss: 1.361, Test accuracy: 71.29
Round  84, Global train loss: 0.132, Global test loss: 1.551, Global test accuracy: 63.12
Round  85, Train loss: 0.127, Test loss: 1.426, Test accuracy: 70.84
Round  85, Global train loss: 0.127, Global test loss: 1.561, Global test accuracy: 63.03
Round  86, Train loss: 0.128, Test loss: 1.358, Test accuracy: 71.56
Round  86, Global train loss: 0.128, Global test loss: 1.566, Global test accuracy: 62.95
Round  87, Train loss: 0.117, Test loss: 1.380, Test accuracy: 71.18
Round  87, Global train loss: 0.117, Global test loss: 1.609, Global test accuracy: 62.83
Round  88, Train loss: 0.117, Test loss: 1.411, Test accuracy: 70.94
Round  88, Global train loss: 0.117, Global test loss: 1.592, Global test accuracy: 62.89
Round  89, Train loss: 0.121, Test loss: 1.416, Test accuracy: 70.89
Round  89, Global train loss: 0.121, Global test loss: 1.577, Global test accuracy: 63.17
Round  90, Train loss: 0.207, Test loss: 1.400, Test accuracy: 70.83
Round  90, Global train loss: 0.207, Global test loss: 1.449, Global test accuracy: 63.82
Round  91, Train loss: 0.192, Test loss: 1.435, Test accuracy: 71.17
Round  91, Global train loss: 0.192, Global test loss: 1.439, Global test accuracy: 63.55
Round  92, Train loss: 0.180, Test loss: 1.374, Test accuracy: 71.37
Round  92, Global train loss: 0.180, Global test loss: 1.433, Global test accuracy: 63.97
Round  93, Train loss: 0.176, Test loss: 1.393, Test accuracy: 71.31
Round  93, Global train loss: 0.176, Global test loss: 1.438, Global test accuracy: 64.09
Round  94, Train loss: 0.170, Test loss: 1.405, Test accuracy: 71.35
Round  94, Global train loss: 0.170, Global test loss: 1.443, Global test accuracy: 64.07
Round  95, Train loss: 0.176, Test loss: 1.422, Test accuracy: 70.98
Round  95, Global train loss: 0.176, Global test loss: 1.426, Global test accuracy: 63.91
Round  96, Train loss: 0.169, Test loss: 1.432, Test accuracy: 71.41
Round  96, Global train loss: 0.169, Global test loss: 1.442, Global test accuracy: 63.87
Round  97, Train loss: 0.172, Test loss: 1.417, Test accuracy: 71.66
Round  97, Global train loss: 0.172, Global test loss: 1.451, Global test accuracy: 64.27
Round  98, Train loss: 0.167, Test loss: 1.438, Test accuracy: 70.77
Round  98, Global train loss: 0.167, Global test loss: 1.453, Global test accuracy: 63.65
Round  99, Train loss: 0.163, Test loss: 1.443, Test accuracy: 71.00
Round  99, Global train loss: 0.163, Global test loss: 1.455, Global test accuracy: 63.69
Final Round, Train loss: 0.127, Test loss: 1.520, Test accuracy: 71.32
Final Round, Global train loss: 0.127, Global test loss: 1.455, Global test accuracy: 63.69
Average accuracy final 10 rounds: 71.18499999999999
Average global accuracy final 10 rounds: 63.889
3725.8497767448425
[2.469735622406006, 4.671705961227417, 6.861339330673218, 9.06281328201294, 11.264150857925415, 13.464496374130249, 15.673246383666992, 17.55144762992859, 19.42813205718994, 21.30669093132019, 23.182130098342896, 25.06823205947876, 26.944205284118652, 28.82581114768982, 30.705034494400024, 32.57746481895447, 34.45316815376282, 36.3320529460907, 38.21294021606445, 40.09407877922058, 41.97047424316406, 46.06269073486328, 50.14662027359009, 54.23263692855835, 58.318379163742065, 62.416516065597534, 66.50615763664246, 70.617271900177, 74.7058093547821, 78.79656958580017, 82.88242363929749, 87.06941795349121, 91.1626570224762, 95.25242900848389, 99.34133839607239, 103.43045473098755, 107.52108073234558, 111.6102352142334, 115.6958737373352, 119.77070879936218, 123.85864973068237, 127.94563126564026, 132.03388905525208, 136.12073278427124, 140.2075617313385, 144.30073308944702, 148.39938688278198, 152.56467461585999, 156.69659972190857, 160.82824802398682, 164.9574944972992, 169.07970094680786, 173.21419763565063, 177.3221685886383, 181.45287537574768, 185.54735469818115, 189.64931511878967, 193.78170943260193, 197.91740322113037, 202.01983189582825, 206.1495726108551, 210.27848625183105, 214.4102499485016, 218.61353826522827, 222.75188374519348, 226.85374450683594, 230.9408736228943, 235.07611274719238, 239.2076919078827, 243.29343581199646, 247.38332223892212, 251.51942563056946, 255.66047477722168, 259.7937002182007, 263.92874813079834, 268.06024980545044, 272.19232392311096, 276.30039381980896, 280.4349112510681, 284.6456289291382, 288.778697013855, 292.91250133514404, 297.03851675987244, 301.1682586669922, 305.292578458786, 309.3803162574768, 313.5107626914978, 317.599632024765, 321.728009223938, 325.88503766059875, 330.02154874801636, 334.1151442527771, 338.251416683197, 342.38021659851074, 346.5491542816162, 350.6930103302002, 354.83333349227905, 358.9674029350281, 363.10024785995483, 367.2590193748474, 371.0395324230194]
[47.12, 53.27, 56.18, 59.56, 60.35, 61.21, 62.62, 62.57, 63.67, 64.75, 65.24, 65.89, 65.8, 66.29, 66.69, 66.97, 67.32, 67.54, 67.0, 67.27, 67.71, 68.02, 68.3, 67.68, 68.33, 67.9, 68.04, 67.96, 68.18, 68.34, 68.64, 69.06, 68.52, 68.72, 69.05, 68.67, 67.72, 68.35, 68.5, 69.02, 69.27, 69.38, 69.55, 69.45, 69.23, 69.25, 69.03, 69.48, 69.83, 69.12, 69.26, 69.68, 69.22, 69.39, 69.6, 69.88, 69.87, 70.33, 70.44, 70.49, 70.63, 70.51, 70.89, 70.81, 70.95, 70.29, 70.4, 70.46, 70.77, 70.74, 71.06, 70.9, 70.47, 70.32, 70.73, 70.57, 70.46, 70.81, 70.8, 70.5, 70.84, 71.22, 71.26, 71.14, 71.29, 70.84, 71.56, 71.18, 70.94, 70.89, 70.83, 71.17, 71.37, 71.31, 71.35, 70.98, 71.41, 71.66, 70.77, 71.0, 71.32]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.711, Test loss: 1.707, Test accuracy: 30.18
Round   1, Train loss: 1.416, Test loss: 1.383, Test accuracy: 40.53
Round   2, Train loss: 1.276, Test loss: 1.222, Test accuracy: 48.79
Round   3, Train loss: 1.177, Test loss: 1.138, Test accuracy: 53.19
Round   4, Train loss: 1.111, Test loss: 1.060, Test accuracy: 57.44
Round   5, Train loss: 1.063, Test loss: 1.013, Test accuracy: 59.57
Round   6, Train loss: 1.023, Test loss: 1.004, Test accuracy: 60.45
Round   7, Train loss: 0.983, Test loss: 0.961, Test accuracy: 62.17
Round   8, Train loss: 0.951, Test loss: 0.962, Test accuracy: 62.32
Round   9, Train loss: 0.918, Test loss: 0.922, Test accuracy: 64.37
Round  10, Train loss: 0.889, Test loss: 0.930, Test accuracy: 63.38
Round  11, Train loss: 0.860, Test loss: 0.880, Test accuracy: 66.45
Round  12, Train loss: 0.831, Test loss: 0.870, Test accuracy: 66.44
Round  13, Train loss: 0.804, Test loss: 0.863, Test accuracy: 66.75
Round  14, Train loss: 0.779, Test loss: 0.852, Test accuracy: 67.84
Round  15, Train loss: 0.756, Test loss: 0.840, Test accuracy: 68.29
Round  16, Train loss: 0.733, Test loss: 0.829, Test accuracy: 68.71
Round  17, Train loss: 0.709, Test loss: 0.815, Test accuracy: 70.02
Round  18, Train loss: 0.694, Test loss: 0.828, Test accuracy: 69.40
Round  19, Train loss: 0.673, Test loss: 0.796, Test accuracy: 70.54
Round  20, Train loss: 0.628, Test loss: 0.803, Test accuracy: 70.36
Round  21, Train loss: 0.700, Test loss: 0.824, Test accuracy: 70.26
Round  22, Train loss: 0.639, Test loss: 0.801, Test accuracy: 71.01
Round  23, Train loss: 0.595, Test loss: 0.837, Test accuracy: 70.06
Round  24, Train loss: 0.571, Test loss: 0.867, Test accuracy: 70.05
Round  25, Train loss: 0.616, Test loss: 0.836, Test accuracy: 71.06
Round  26, Train loss: 0.624, Test loss: 0.803, Test accuracy: 71.20
Round  27, Train loss: 0.566, Test loss: 0.822, Test accuracy: 71.26
Round  28, Train loss: 0.517, Test loss: 0.833, Test accuracy: 71.54
Round  29, Train loss: 0.567, Test loss: 0.840, Test accuracy: 71.91
Round  30, Train loss: 0.539, Test loss: 0.794, Test accuracy: 72.55
Round  31, Train loss: 0.610, Test loss: 0.839, Test accuracy: 71.72
Round  32, Train loss: 0.491, Test loss: 0.799, Test accuracy: 72.81
Round  33, Train loss: 0.574, Test loss: 0.808, Test accuracy: 72.08
Round  34, Train loss: 0.504, Test loss: 0.818, Test accuracy: 72.33
Round  35, Train loss: 0.530, Test loss: 0.845, Test accuracy: 72.37
Round  36, Train loss: 0.505, Test loss: 0.842, Test accuracy: 72.51
Round  37, Train loss: 0.467, Test loss: 0.838, Test accuracy: 72.28
Round  38, Train loss: 0.432, Test loss: 0.832, Test accuracy: 72.59
Round  39, Train loss: 0.449, Test loss: 0.843, Test accuracy: 72.13
Round  40, Train loss: 0.437, Test loss: 0.855, Test accuracy: 72.08
Round  41, Train loss: 0.439, Test loss: 0.859, Test accuracy: 72.53
Round  42, Train loss: 0.460, Test loss: 0.837, Test accuracy: 73.05
Round  43, Train loss: 0.426, Test loss: 0.863, Test accuracy: 73.06
Round  44, Train loss: 0.420, Test loss: 0.846, Test accuracy: 72.59
Round  45, Train loss: 0.429, Test loss: 0.856, Test accuracy: 73.26
Round  46, Train loss: 0.442, Test loss: 0.851, Test accuracy: 72.71
Round  47, Train loss: 0.419, Test loss: 0.898, Test accuracy: 72.27
Round  48, Train loss: 0.369, Test loss: 0.883, Test accuracy: 72.53
Round  49, Train loss: 0.432, Test loss: 0.874, Test accuracy: 72.76
Round  50, Train loss: 0.364, Test loss: 0.893, Test accuracy: 72.18
Round  51, Train loss: 0.367, Test loss: 0.923, Test accuracy: 72.72
Round  52, Train loss: 0.334, Test loss: 0.905, Test accuracy: 72.21
Round  53, Train loss: 0.385, Test loss: 0.901, Test accuracy: 73.16
Round  54, Train loss: 0.362, Test loss: 0.889, Test accuracy: 73.78
Round  55, Train loss: 0.320, Test loss: 0.893, Test accuracy: 73.39
Round  56, Train loss: 0.338, Test loss: 0.895, Test accuracy: 72.98
Round  57, Train loss: 0.335, Test loss: 0.905, Test accuracy: 72.67
Round  58, Train loss: 0.341, Test loss: 0.909, Test accuracy: 72.70
Round  59, Train loss: 0.383, Test loss: 0.932, Test accuracy: 72.24
Round  60, Train loss: 0.380, Test loss: 0.927, Test accuracy: 72.82
Round  61, Train loss: 0.359, Test loss: 0.932, Test accuracy: 73.00
Round  62, Train loss: 0.421, Test loss: 0.903, Test accuracy: 73.59
Round  63, Train loss: 0.327, Test loss: 0.901, Test accuracy: 73.45
Round  64, Train loss: 0.328, Test loss: 0.956, Test accuracy: 72.91
Round  65, Train loss: 0.294, Test loss: 0.944, Test accuracy: 73.18
Round  66, Train loss: 0.289, Test loss: 0.914, Test accuracy: 73.02
Round  67, Train loss: 0.300, Test loss: 0.949, Test accuracy: 72.83
Round  68, Train loss: 0.269, Test loss: 0.942, Test accuracy: 72.89
Round  69, Train loss: 0.339, Test loss: 0.899, Test accuracy: 73.29
Round  70, Train loss: 0.287, Test loss: 0.929, Test accuracy: 73.08
Round  71, Train loss: 0.242, Test loss: 0.951, Test accuracy: 73.26
Round  72, Train loss: 0.283, Test loss: 0.939, Test accuracy: 73.36
Round  73, Train loss: 0.273, Test loss: 0.926, Test accuracy: 73.85
Round  74, Train loss: 0.304, Test loss: 0.936, Test accuracy: 73.00
Round  75, Train loss: 0.316, Test loss: 0.963, Test accuracy: 73.45
Round  76, Train loss: 0.305, Test loss: 0.979, Test accuracy: 73.00
Round  77, Train loss: 0.305, Test loss: 0.963, Test accuracy: 72.80
Round  78, Train loss: 0.318, Test loss: 0.963, Test accuracy: 72.72
Round  79, Train loss: 0.296, Test loss: 1.008, Test accuracy: 72.23
Round  80, Train loss: 0.223, Test loss: 0.978, Test accuracy: 72.58
Round  81, Train loss: 0.210, Test loss: 0.995, Test accuracy: 72.96
Round  82, Train loss: 0.186, Test loss: 1.009, Test accuracy: 72.46
Round  83, Train loss: 0.191, Test loss: 1.013, Test accuracy: 73.08
Round  84, Train loss: 0.181, Test loss: 1.031, Test accuracy: 72.59
Round  85, Train loss: 0.172, Test loss: 1.026, Test accuracy: 72.70
Round  86, Train loss: 0.173, Test loss: 0.995, Test accuracy: 73.19
Round  87, Train loss: 0.161, Test loss: 1.031, Test accuracy: 72.95
Round  88, Train loss: 0.155, Test loss: 1.034, Test accuracy: 73.16
Round  89, Train loss: 0.143, Test loss: 1.038, Test accuracy: 73.52
Round  90, Train loss: 0.265, Test loss: 1.033, Test accuracy: 72.88
Round  91, Train loss: 0.238, Test loss: 1.035, Test accuracy: 73.34
Round  92, Train loss: 0.244, Test loss: 1.037, Test accuracy: 72.99
Round  93, Train loss: 0.229, Test loss: 1.032, Test accuracy: 73.55
Round  94, Train loss: 0.233, Test loss: 1.046, Test accuracy: 73.24
Round  95, Train loss: 0.221, Test loss: 1.038, Test accuracy: 73.31
Round  96, Train loss: 0.222, Test loss: 1.053, Test accuracy: 73.31
Round  97, Train loss: 0.226, Test loss: 1.049, Test accuracy: 73.19
Round  98, Train loss: 0.213, Test loss: 1.038, Test accuracy: 73.62
Round  99, Train loss: 0.220, Test loss: 1.080, Test accuracy: 72.80
Final Round, Train loss: 0.167, Test loss: 1.052, Test accuracy: 73.40
Average accuracy final 10 rounds: 73.22300000000001
3104.6146602630615
[2.30079984664917, 4.300109624862671, 6.29466438293457, 8.292884111404419, 10.29089093208313, 12.283539772033691, 14.281731367111206, 16.276345014572144, 18.2515811920166, 20.244017362594604, 22.235129833221436, 24.222211599349976, 26.22316074371338, 28.21837615966797, 30.208682775497437, 32.01102614402771, 33.8071665763855, 35.609068393707275, 37.44318342208862, 39.24681496620178, 41.047911167144775, 44.204307079315186, 47.339675426483154, 50.48073434829712, 53.62762761116028, 56.75872039794922, 59.89804029464722, 63.025116205215454, 66.1607551574707, 69.27423620223999, 72.38127374649048, 75.48897743225098, 78.59945011138916, 81.72200393676758, 84.8279664516449, 87.94465208053589, 91.05730271339417, 94.16461396217346, 97.36154317855835, 100.48638391494751, 103.62361240386963, 106.73411202430725, 109.83935165405273, 112.94656300544739, 116.05814599990845, 119.16620326042175, 122.27640223503113, 125.38711619377136, 128.49745225906372, 131.60416316986084, 134.71334385871887, 137.82194566726685, 140.93995189666748, 144.04950976371765, 147.1572630405426, 150.26313257217407, 153.36572170257568, 156.47305631637573, 159.58313298225403, 162.7248818874359, 165.82690477371216, 168.93032336235046, 172.0324900150299, 175.139301776886, 178.31409239768982, 181.42635798454285, 184.53131580352783, 187.63425207138062, 190.73888421058655, 193.8453929424286, 196.95309472084045, 200.05718898773193, 203.16452193260193, 206.27758193016052, 209.41229891777039, 212.52170395851135, 215.68427348136902, 218.79860377311707, 221.9080843925476, 225.05609273910522, 228.16710138320923, 231.2806692123413, 234.39757990837097, 237.5635986328125, 240.72677445411682, 243.86416101455688, 247.07506465911865, 250.23783206939697, 253.38500499725342, 256.5192403793335, 259.6619679927826, 262.79856300354004, 265.9626929759979, 269.1082739830017, 272.2657856941223, 275.4555187225342, 278.67023825645447, 281.81639862060547, 284.96213269233704, 288.10799050331116, 291.65025997161865]
[30.18, 40.53, 48.79, 53.19, 57.44, 59.57, 60.45, 62.17, 62.32, 64.37, 63.38, 66.45, 66.44, 66.75, 67.84, 68.29, 68.71, 70.02, 69.4, 70.54, 70.36, 70.26, 71.01, 70.06, 70.05, 71.06, 71.2, 71.26, 71.54, 71.91, 72.55, 71.72, 72.81, 72.08, 72.33, 72.37, 72.51, 72.28, 72.59, 72.13, 72.08, 72.53, 73.05, 73.06, 72.59, 73.26, 72.71, 72.27, 72.53, 72.76, 72.18, 72.72, 72.21, 73.16, 73.78, 73.39, 72.98, 72.67, 72.7, 72.24, 72.82, 73.0, 73.59, 73.45, 72.91, 73.18, 73.02, 72.83, 72.89, 73.29, 73.08, 73.26, 73.36, 73.85, 73.0, 73.45, 73.0, 72.8, 72.72, 72.23, 72.58, 72.96, 72.46, 73.08, 72.59, 72.7, 73.19, 72.95, 73.16, 73.52, 72.88, 73.34, 72.99, 73.55, 73.24, 73.31, 73.31, 73.19, 73.62, 72.8, 73.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.716, Test loss: 1.660, Test accuracy: 32.09
Round   1, Train loss: 1.353, Test loss: 1.298, Test accuracy: 46.24
Round   2, Train loss: 1.189, Test loss: 1.151, Test accuracy: 51.78
Round   3, Train loss: 1.103, Test loss: 1.082, Test accuracy: 55.43
Round   4, Train loss: 1.045, Test loss: 1.018, Test accuracy: 59.04
Round   5, Train loss: 1.004, Test loss: 0.996, Test accuracy: 59.71
Round   6, Train loss: 0.963, Test loss: 0.960, Test accuracy: 61.74
Round   7, Train loss: 0.924, Test loss: 0.935, Test accuracy: 62.44
Round   8, Train loss: 0.895, Test loss: 0.904, Test accuracy: 64.17
Round   9, Train loss: 0.862, Test loss: 0.876, Test accuracy: 65.52
Round  10, Train loss: 0.811, Test loss: 0.867, Test accuracy: 66.04
Round  11, Train loss: 0.782, Test loss: 0.864, Test accuracy: 66.11
Round  12, Train loss: 0.729, Test loss: 0.833, Test accuracy: 67.63
Round  13, Train loss: 0.736, Test loss: 0.824, Test accuracy: 67.85
Round  14, Train loss: 0.745, Test loss: 0.808, Test accuracy: 68.49
Round  15, Train loss: 0.728, Test loss: 0.812, Test accuracy: 68.86
Round  16, Train loss: 0.687, Test loss: 0.799, Test accuracy: 69.48
Round  17, Train loss: 0.654, Test loss: 0.773, Test accuracy: 70.18
Round  18, Train loss: 0.719, Test loss: 0.771, Test accuracy: 70.17
Round  19, Train loss: 0.632, Test loss: 0.761, Test accuracy: 70.75
Round  20, Train loss: 0.680, Test loss: 0.747, Test accuracy: 71.62
Round  21, Train loss: 0.613, Test loss: 0.749, Test accuracy: 71.55
Round  22, Train loss: 0.651, Test loss: 0.743, Test accuracy: 71.93
Round  23, Train loss: 0.604, Test loss: 0.740, Test accuracy: 72.20
Round  24, Train loss: 0.542, Test loss: 0.744, Test accuracy: 72.12
Round  25, Train loss: 0.543, Test loss: 0.739, Test accuracy: 72.94
Round  26, Train loss: 0.574, Test loss: 0.723, Test accuracy: 72.99
Round  27, Train loss: 0.534, Test loss: 0.739, Test accuracy: 72.69
Round  28, Train loss: 0.501, Test loss: 0.737, Test accuracy: 72.67
Round  29, Train loss: 0.487, Test loss: 0.725, Test accuracy: 73.63
Round  30, Train loss: 0.547, Test loss: 0.708, Test accuracy: 74.41
Round  31, Train loss: 0.439, Test loss: 0.714, Test accuracy: 74.10
Round  32, Train loss: 0.418, Test loss: 0.722, Test accuracy: 73.58
Round  33, Train loss: 0.519, Test loss: 0.721, Test accuracy: 73.96
Round  34, Train loss: 0.473, Test loss: 0.711, Test accuracy: 74.38
Round  35, Train loss: 0.471, Test loss: 0.717, Test accuracy: 74.02
Round  36, Train loss: 0.434, Test loss: 0.726, Test accuracy: 74.43
Round  37, Train loss: 0.419, Test loss: 0.716, Test accuracy: 74.68
Round  38, Train loss: 0.432, Test loss: 0.712, Test accuracy: 74.53
Round  39, Train loss: 0.411, Test loss: 0.728, Test accuracy: 73.96
Round  40, Train loss: 0.419, Test loss: 0.719, Test accuracy: 74.17
Round  41, Train loss: 0.415, Test loss: 0.743, Test accuracy: 74.30
Round  42, Train loss: 0.422, Test loss: 0.734, Test accuracy: 74.22
Round  43, Train loss: 0.399, Test loss: 0.721, Test accuracy: 74.69
Round  44, Train loss: 0.414, Test loss: 0.732, Test accuracy: 74.59
Round  45, Train loss: 0.408, Test loss: 0.721, Test accuracy: 74.94
Round  46, Train loss: 0.394, Test loss: 0.711, Test accuracy: 74.97
Round  47, Train loss: 0.369, Test loss: 0.715, Test accuracy: 75.41
Round  48, Train loss: 0.376, Test loss: 0.719, Test accuracy: 75.48
Round  49, Train loss: 0.390, Test loss: 0.707, Test accuracy: 75.79
Round  50, Train loss: 0.333, Test loss: 0.721, Test accuracy: 75.22
Round  51, Train loss: 0.307, Test loss: 0.727, Test accuracy: 75.33
Round  52, Train loss: 0.332, Test loss: 0.733, Test accuracy: 75.32
Round  53, Train loss: 0.349, Test loss: 0.737, Test accuracy: 75.30
Round  54, Train loss: 0.326, Test loss: 0.727, Test accuracy: 75.34
Round  55, Train loss: 0.325, Test loss: 0.732, Test accuracy: 75.10
Round  56, Train loss: 0.307, Test loss: 0.728, Test accuracy: 75.26
Round  57, Train loss: 0.317, Test loss: 0.723, Test accuracy: 75.37
Round  58, Train loss: 0.330, Test loss: 0.718, Test accuracy: 75.99
Round  59, Train loss: 0.378, Test loss: 0.722, Test accuracy: 76.13
Round  60, Train loss: 0.325, Test loss: 0.721, Test accuracy: 75.93
Round  61, Train loss: 0.320, Test loss: 0.726, Test accuracy: 76.12
Round  62, Train loss: 0.338, Test loss: 0.741, Test accuracy: 75.55
Round  63, Train loss: 0.294, Test loss: 0.736, Test accuracy: 75.81
Round  64, Train loss: 0.284, Test loss: 0.738, Test accuracy: 75.76
Round  65, Train loss: 0.297, Test loss: 0.730, Test accuracy: 75.48
Round  66, Train loss: 0.305, Test loss: 0.753, Test accuracy: 75.15
Round  67, Train loss: 0.267, Test loss: 0.743, Test accuracy: 75.61
Round  68, Train loss: 0.269, Test loss: 0.758, Test accuracy: 76.09
Round  69, Train loss: 0.346, Test loss: 0.745, Test accuracy: 75.77
Round  70, Train loss: 0.268, Test loss: 0.763, Test accuracy: 75.73
Round  71, Train loss: 0.263, Test loss: 0.785, Test accuracy: 75.19
Round  72, Train loss: 0.279, Test loss: 0.780, Test accuracy: 75.38
Round  73, Train loss: 0.284, Test loss: 0.780, Test accuracy: 74.67
Round  74, Train loss: 0.276, Test loss: 0.775, Test accuracy: 75.32
Round  75, Train loss: 0.291, Test loss: 0.750, Test accuracy: 76.04
Round  76, Train loss: 0.245, Test loss: 0.741, Test accuracy: 76.66
Round  77, Train loss: 0.245, Test loss: 0.746, Test accuracy: 76.04
Round  78, Train loss: 0.287, Test loss: 0.742, Test accuracy: 75.80
Round  79, Train loss: 0.242, Test loss: 0.756, Test accuracy: 75.84
Round  80, Train loss: 0.211, Test loss: 0.743, Test accuracy: 76.08
Round  81, Train loss: 0.198, Test loss: 0.745, Test accuracy: 76.17
Round  82, Train loss: 0.188, Test loss: 0.761, Test accuracy: 76.16
Round  83, Train loss: 0.185, Test loss: 0.772, Test accuracy: 75.87
Round  84, Train loss: 0.172, Test loss: 0.775, Test accuracy: 75.63
Round  85, Train loss: 0.167, Test loss: 0.772, Test accuracy: 75.94
Round  86, Train loss: 0.160, Test loss: 0.770, Test accuracy: 76.15
Round  87, Train loss: 0.158, Test loss: 0.779, Test accuracy: 75.78
Round  88, Train loss: 0.144, Test loss: 0.775, Test accuracy: 76.11
Round  89, Train loss: 0.144, Test loss: 0.781, Test accuracy: 75.77
Round  90, Train loss: 0.236, Test loss: 0.751, Test accuracy: 76.23
Round  91, Train loss: 0.221, Test loss: 0.741, Test accuracy: 77.17
Round  92, Train loss: 0.224, Test loss: 0.758, Test accuracy: 76.49
Round  93, Train loss: 0.212, Test loss: 0.764, Test accuracy: 76.53
Round  94, Train loss: 0.211, Test loss: 0.751, Test accuracy: 76.80
Round  95, Train loss: 0.208, Test loss: 0.765, Test accuracy: 76.71
Round  96, Train loss: 0.205, Test loss: 0.760, Test accuracy: 76.45
Round  97, Train loss: 0.207, Test loss: 0.761, Test accuracy: 76.50
Round  98, Train loss: 0.199, Test loss: 0.765, Test accuracy: 76.64
Round  99, Train loss: 0.199, Test loss: 0.786, Test accuracy: 76.29
Final Round, Train loss: 0.168, Test loss: 0.775, Test accuracy: 76.88
Average accuracy final 10 rounds: 76.581
3455.9348270893097
[2.8932816982269287, 5.439697265625, 7.98778223991394, 10.536219358444214, 13.083364009857178, 15.641103506088257, 18.18510890007019, 20.742854595184326, 23.28805685043335, 25.830508708953857, 28.395894289016724, 30.960614442825317, 33.50729584693909, 36.03874588012695, 38.58648180961609, 41.13510036468506, 43.66580939292908, 46.195881366729736, 48.737876653671265, 51.278321743011475, 53.81607365608215, 57.89446401596069, 61.97571873664856, 65.99380302429199, 70.05495238304138, 74.1225893497467, 78.19096612930298, 82.23466205596924, 86.30649995803833, 90.36908841133118, 94.42802667617798, 98.49231553077698, 102.58448791503906, 106.74501943588257, 110.77010011672974, 114.79936718940735, 118.82651925086975, 122.90270280838013, 126.96754193305969, 130.99505376815796, 135.02417874336243, 139.09147191047668, 143.15853786468506, 147.2334656715393, 151.29181337356567, 155.34761381149292, 159.4180359840393, 163.42655181884766, 167.19442296028137, 170.97033309936523, 174.76458501815796, 178.47395968437195, 182.23381519317627, 185.9555320739746, 189.67031168937683, 193.40932488441467, 197.13012290000916, 200.91461658477783, 204.67957258224487, 208.45014834403992, 212.218670129776, 215.98531675338745, 219.756756067276, 223.5243320465088, 227.29018926620483, 231.0516300201416, 234.81687879562378, 238.53995203971863, 242.27505922317505, 246.02668046951294, 249.74487972259521, 253.51332116127014, 257.2815749645233, 261.00286507606506, 264.7150344848633, 268.47653341293335, 272.3229892253876, 276.0846710205078, 279.8507282733917, 283.6083445549011, 287.37265253067017, 291.13679599761963, 294.90838408470154, 298.675005197525, 302.4400882720947, 306.16476368904114, 309.92632007598877, 313.6915695667267, 317.4563858509064, 321.1816129684448, 325.02006340026855, 328.78436160087585, 332.5574848651886, 336.3243601322174, 340.0905673503876, 343.8526201248169, 347.6116099357605, 351.3748321533203, 355.1701955795288, 358.90553617477417, 362.5740065574646]
[32.09, 46.24, 51.78, 55.43, 59.04, 59.71, 61.74, 62.44, 64.17, 65.52, 66.04, 66.11, 67.63, 67.85, 68.49, 68.86, 69.48, 70.18, 70.17, 70.75, 71.62, 71.55, 71.93, 72.2, 72.12, 72.94, 72.99, 72.69, 72.67, 73.63, 74.41, 74.1, 73.58, 73.96, 74.38, 74.02, 74.43, 74.68, 74.53, 73.96, 74.17, 74.3, 74.22, 74.69, 74.59, 74.94, 74.97, 75.41, 75.48, 75.79, 75.22, 75.33, 75.32, 75.3, 75.34, 75.1, 75.26, 75.37, 75.99, 76.13, 75.93, 76.12, 75.55, 75.81, 75.76, 75.48, 75.15, 75.61, 76.09, 75.77, 75.73, 75.19, 75.38, 74.67, 75.32, 76.04, 76.66, 76.04, 75.8, 75.84, 76.08, 76.17, 76.16, 75.87, 75.63, 75.94, 76.15, 75.78, 76.11, 75.77, 76.23, 77.17, 76.49, 76.53, 76.8, 76.71, 76.45, 76.5, 76.64, 76.29, 76.88]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.746, Test loss: 2.125, Test accuracy: 21.54
Round   0, Global train loss: 1.746, Global test loss: 2.305, Global test accuracy: 18.91
Round   1, Train loss: 1.499, Test loss: 1.795, Test accuracy: 31.66
Round   1, Global train loss: 1.499, Global test loss: 2.090, Global test accuracy: 26.35
Round   2, Train loss: 1.569, Test loss: 1.692, Test accuracy: 32.20
Round   2, Global train loss: 1.569, Global test loss: 2.073, Global test accuracy: 23.85
Round   3, Train loss: 1.560, Test loss: 1.635, Test accuracy: 33.59
Round   3, Global train loss: 1.560, Global test loss: 2.248, Global test accuracy: 18.44
Round   4, Train loss: 1.398, Test loss: 1.482, Test accuracy: 37.98
Round   4, Global train loss: 1.398, Global test loss: 2.194, Global test accuracy: 21.72
Round   5, Train loss: 1.541, Test loss: 1.465, Test accuracy: 39.44
Round   5, Global train loss: 1.541, Global test loss: 2.103, Global test accuracy: 26.68
Round   6, Train loss: 1.469, Test loss: 1.399, Test accuracy: 41.25
Round   6, Global train loss: 1.469, Global test loss: 2.136, Global test accuracy: 20.32
Round   7, Train loss: 1.334, Test loss: 1.394, Test accuracy: 42.80
Round   7, Global train loss: 1.334, Global test loss: 2.114, Global test accuracy: 20.45
Round   8, Train loss: 1.213, Test loss: 1.409, Test accuracy: 43.12
Round   8, Global train loss: 1.213, Global test loss: 2.186, Global test accuracy: 27.39
Round   9, Train loss: 1.284, Test loss: 1.395, Test accuracy: 43.65
Round   9, Global train loss: 1.284, Global test loss: 2.080, Global test accuracy: 26.85
Round  10, Train loss: 1.528, Test loss: 1.366, Test accuracy: 45.14
Round  10, Global train loss: 1.528, Global test loss: 2.189, Global test accuracy: 15.89
Round  11, Train loss: 1.298, Test loss: 1.386, Test accuracy: 45.66
Round  11, Global train loss: 1.298, Global test loss: 2.134, Global test accuracy: 26.14
Round  12, Train loss: 1.369, Test loss: 1.382, Test accuracy: 44.70
Round  12, Global train loss: 1.369, Global test loss: 2.207, Global test accuracy: 12.84
Round  13, Train loss: 1.322, Test loss: 1.338, Test accuracy: 46.87
Round  13, Global train loss: 1.322, Global test loss: 2.092, Global test accuracy: 25.43
Round  14, Train loss: 1.148, Test loss: 1.332, Test accuracy: 47.13
Round  14, Global train loss: 1.148, Global test loss: 2.110, Global test accuracy: 26.54
Round  15, Train loss: 1.359, Test loss: 1.328, Test accuracy: 47.23
Round  15, Global train loss: 1.359, Global test loss: 2.214, Global test accuracy: 28.21
Round  16, Train loss: 1.032, Test loss: 1.339, Test accuracy: 47.97
Round  16, Global train loss: 1.032, Global test loss: 2.027, Global test accuracy: 22.70
Round  17, Train loss: 1.340, Test loss: 1.334, Test accuracy: 48.11
Round  17, Global train loss: 1.340, Global test loss: 2.163, Global test accuracy: 31.13
Round  18, Train loss: 1.199, Test loss: 1.340, Test accuracy: 48.21
Round  18, Global train loss: 1.199, Global test loss: 2.124, Global test accuracy: 29.04
Round  19, Train loss: 0.995, Test loss: 1.325, Test accuracy: 48.95
Round  19, Global train loss: 0.995, Global test loss: 2.023, Global test accuracy: 28.19
Round  20, Train loss: 1.435, Test loss: 1.324, Test accuracy: 48.55
Round  20, Global train loss: 1.435, Global test loss: 2.155, Global test accuracy: 23.29
Round  21, Train loss: 1.288, Test loss: 1.321, Test accuracy: 48.57
Round  21, Global train loss: 1.288, Global test loss: 2.201, Global test accuracy: 26.44
Round  22, Train loss: 1.416, Test loss: 1.329, Test accuracy: 48.55
Round  22, Global train loss: 1.416, Global test loss: 2.230, Global test accuracy: 23.15
Round  23, Train loss: 1.247, Test loss: 1.334, Test accuracy: 48.34
Round  23, Global train loss: 1.247, Global test loss: 2.069, Global test accuracy: 28.53
Round  24, Train loss: 1.129, Test loss: 1.335, Test accuracy: 48.24
Round  24, Global train loss: 1.129, Global test loss: 2.053, Global test accuracy: 25.08
Round  25, Train loss: 1.073, Test loss: 1.333, Test accuracy: 48.76
Round  25, Global train loss: 1.073, Global test loss: 2.067, Global test accuracy: 29.26
Round  26, Train loss: 0.910, Test loss: 1.357, Test accuracy: 48.11
Round  26, Global train loss: 0.910, Global test loss: 2.017, Global test accuracy: 30.73
Round  27, Train loss: 1.027, Test loss: 1.364, Test accuracy: 47.75
Round  27, Global train loss: 1.027, Global test loss: 1.988, Global test accuracy: 29.76
Round  28, Train loss: 0.864, Test loss: 1.382, Test accuracy: 47.68
Round  28, Global train loss: 0.864, Global test loss: 2.130, Global test accuracy: 28.60
Round  29, Train loss: 1.045, Test loss: 1.400, Test accuracy: 47.72
Round  29, Global train loss: 1.045, Global test loss: 1.919, Global test accuracy: 32.71
Round  30, Train loss: 0.979, Test loss: 1.413, Test accuracy: 47.66
Round  30, Global train loss: 0.979, Global test loss: 1.999, Global test accuracy: 26.35
Round  31, Train loss: 0.855, Test loss: 1.440, Test accuracy: 47.26
Round  31, Global train loss: 0.855, Global test loss: 1.971, Global test accuracy: 28.95
Round  32, Train loss: 0.977, Test loss: 1.460, Test accuracy: 47.66
Round  32, Global train loss: 0.977, Global test loss: 2.065, Global test accuracy: 28.09
Round  33, Train loss: 1.209, Test loss: 1.468, Test accuracy: 47.40
Round  33, Global train loss: 1.209, Global test loss: 2.144, Global test accuracy: 28.31
Round  34, Train loss: 1.054, Test loss: 1.496, Test accuracy: 47.82
Round  34, Global train loss: 1.054, Global test loss: 2.082, Global test accuracy: 29.88
Round  35, Train loss: 0.775, Test loss: 1.484, Test accuracy: 47.86
Round  35, Global train loss: 0.775, Global test loss: 1.915, Global test accuracy: 27.67
Round  36, Train loss: 0.875, Test loss: 1.510, Test accuracy: 47.35
Round  36, Global train loss: 0.875, Global test loss: 2.078, Global test accuracy: 22.64
Round  37, Train loss: 0.874, Test loss: 1.511, Test accuracy: 47.73
Round  37, Global train loss: 0.874, Global test loss: 2.157, Global test accuracy: 25.07
Round  38, Train loss: 0.817, Test loss: 1.544, Test accuracy: 47.53
Round  38, Global train loss: 0.817, Global test loss: 2.046, Global test accuracy: 29.50
Round  39, Train loss: 0.991, Test loss: 1.604, Test accuracy: 46.38
Round  39, Global train loss: 0.991, Global test loss: 2.123, Global test accuracy: 22.77
Round  40, Train loss: 0.906, Test loss: 1.610, Test accuracy: 46.89
Round  40, Global train loss: 0.906, Global test loss: 1.999, Global test accuracy: 32.56
Round  41, Train loss: 0.786, Test loss: 1.639, Test accuracy: 47.36
Round  41, Global train loss: 0.786, Global test loss: 1.928, Global test accuracy: 34.83
Round  42, Train loss: 0.703, Test loss: 1.656, Test accuracy: 47.62
Round  42, Global train loss: 0.703, Global test loss: 1.999, Global test accuracy: 32.13
Round  43, Train loss: 0.692, Test loss: 1.675, Test accuracy: 46.81
Round  43, Global train loss: 0.692, Global test loss: 2.056, Global test accuracy: 31.45
Round  44, Train loss: 0.823, Test loss: 1.702, Test accuracy: 46.57
Round  44, Global train loss: 0.823, Global test loss: 2.066, Global test accuracy: 24.60
Round  45, Train loss: 0.706, Test loss: 1.691, Test accuracy: 46.05
Round  45, Global train loss: 0.706, Global test loss: 2.047, Global test accuracy: 26.99
Round  46, Train loss: 0.805, Test loss: 1.769, Test accuracy: 46.28
Round  46, Global train loss: 0.805, Global test loss: 2.085, Global test accuracy: 31.86
Round  47, Train loss: 0.808, Test loss: 1.765, Test accuracy: 46.99
Round  47, Global train loss: 0.808, Global test loss: 2.091, Global test accuracy: 24.41
Round  48, Train loss: 0.545, Test loss: 1.803, Test accuracy: 46.70
Round  48, Global train loss: 0.545, Global test loss: 1.978, Global test accuracy: 32.07
Round  49, Train loss: 0.670, Test loss: 1.821, Test accuracy: 46.77
Round  49, Global train loss: 0.670, Global test loss: 2.062, Global test accuracy: 27.27
Round  50, Train loss: 0.856, Test loss: 1.892, Test accuracy: 46.55
Round  50, Global train loss: 0.856, Global test loss: 2.103, Global test accuracy: 30.19
Round  51, Train loss: 0.543, Test loss: 1.939, Test accuracy: 46.29
Round  51, Global train loss: 0.543, Global test loss: 2.011, Global test accuracy: 28.06
Round  52, Train loss: 0.714, Test loss: 1.954, Test accuracy: 46.51
Round  52, Global train loss: 0.714, Global test loss: 1.965, Global test accuracy: 33.34
Round  53, Train loss: 0.662, Test loss: 1.959, Test accuracy: 46.63
Round  53, Global train loss: 0.662, Global test loss: 2.108, Global test accuracy: 26.87
Round  54, Train loss: 0.826, Test loss: 1.988, Test accuracy: 46.59
Round  54, Global train loss: 0.826, Global test loss: 2.194, Global test accuracy: 22.68
Round  55, Train loss: 0.475, Test loss: 2.005, Test accuracy: 46.22
Round  55, Global train loss: 0.475, Global test loss: 1.938, Global test accuracy: 31.39
Round  56, Train loss: 0.591, Test loss: 2.010, Test accuracy: 46.43
Round  56, Global train loss: 0.591, Global test loss: 2.029, Global test accuracy: 26.94
Round  57, Train loss: 0.561, Test loss: 2.053, Test accuracy: 46.98
Round  57, Global train loss: 0.561, Global test loss: 2.106, Global test accuracy: 21.51
Round  58, Train loss: 0.436, Test loss: 2.079, Test accuracy: 47.00
Round  58, Global train loss: 0.436, Global test loss: 2.053, Global test accuracy: 26.24
Round  59, Train loss: 0.368, Test loss: 2.144, Test accuracy: 46.77
Round  59, Global train loss: 0.368, Global test loss: 2.074, Global test accuracy: 28.64
Round  60, Train loss: 0.680, Test loss: 2.175, Test accuracy: 46.27
Round  60, Global train loss: 0.680, Global test loss: 2.056, Global test accuracy: 30.37
Round  61, Train loss: 0.541, Test loss: 2.211, Test accuracy: 46.39
Round  61, Global train loss: 0.541, Global test loss: 2.074, Global test accuracy: 30.71
Round  62, Train loss: 0.561, Test loss: 2.245, Test accuracy: 45.86
Round  62, Global train loss: 0.561, Global test loss: 2.032, Global test accuracy: 33.63
Round  63, Train loss: 0.386, Test loss: 2.228, Test accuracy: 45.75
Round  63, Global train loss: 0.386, Global test loss: 1.883, Global test accuracy: 30.93
Round  64, Train loss: 0.366, Test loss: 2.271, Test accuracy: 46.25
Round  64, Global train loss: 0.366, Global test loss: 2.030, Global test accuracy: 32.02
Round  65, Train loss: 0.455, Test loss: 2.266, Test accuracy: 46.61
Round  65, Global train loss: 0.455, Global test loss: 1.907, Global test accuracy: 29.67
Round  66, Train loss: 0.471, Test loss: 2.310, Test accuracy: 46.90
Round  66, Global train loss: 0.471, Global test loss: 2.088, Global test accuracy: 29.03
Round  67, Train loss: 0.558, Test loss: 2.386, Test accuracy: 46.17
Round  67, Global train loss: 0.558, Global test loss: 2.075, Global test accuracy: 26.72
Round  68, Train loss: 0.396, Test loss: 2.459, Test accuracy: 46.40
Round  68, Global train loss: 0.396, Global test loss: 2.192, Global test accuracy: 23.95
Round  69, Train loss: 0.450, Test loss: 2.485, Test accuracy: 46.14
Round  69, Global train loss: 0.450, Global test loss: 2.107, Global test accuracy: 22.94
Round  70, Train loss: 0.244, Test loss: 2.562, Test accuracy: 45.86
Round  70, Global train loss: 0.244, Global test loss: 2.028, Global test accuracy: 27.32
Round  71, Train loss: 0.295, Test loss: 2.576, Test accuracy: 46.31
Round  71, Global train loss: 0.295, Global test loss: 1.973, Global test accuracy: 30.69
Round  72, Train loss: 0.461, Test loss: 2.629, Test accuracy: 46.56
Round  72, Global train loss: 0.461, Global test loss: 2.156, Global test accuracy: 22.68
Round  73, Train loss: 0.303, Test loss: 2.588, Test accuracy: 46.61
Round  73, Global train loss: 0.303, Global test loss: 2.066, Global test accuracy: 29.27
Round  74, Train loss: 0.449, Test loss: 2.626, Test accuracy: 46.74
Round  74, Global train loss: 0.449, Global test loss: 2.118, Global test accuracy: 24.16
Round  75, Train loss: 0.333, Test loss: 2.629, Test accuracy: 46.56
Round  75, Global train loss: 0.333, Global test loss: 1.968, Global test accuracy: 24.68
Round  76, Train loss: 0.330, Test loss: 2.685, Test accuracy: 46.30
Round  76, Global train loss: 0.330, Global test loss: 2.059, Global test accuracy: 28.88
Round  77, Train loss: 0.306, Test loss: 2.759, Test accuracy: 46.63
Round  77, Global train loss: 0.306, Global test loss: 2.069, Global test accuracy: 31.16
Round  78, Train loss: 0.263, Test loss: 2.801, Test accuracy: 46.04
Round  78, Global train loss: 0.263, Global test loss: 2.100, Global test accuracy: 24.66
Round  79, Train loss: 0.353, Test loss: 2.907, Test accuracy: 45.32
Round  79, Global train loss: 0.353, Global test loss: 2.103, Global test accuracy: 27.01
Round  80, Train loss: 0.163, Test loss: 2.883, Test accuracy: 45.83
Round  80, Global train loss: 0.163, Global test loss: 1.956, Global test accuracy: 34.38
Round  81, Train loss: 0.219, Test loss: 2.853, Test accuracy: 46.43
Round  81, Global train loss: 0.219, Global test loss: 1.965, Global test accuracy: 30.49
Round  82, Train loss: 0.290, Test loss: 2.846, Test accuracy: 46.50
Round  82, Global train loss: 0.290, Global test loss: 2.074, Global test accuracy: 28.95
Round  83, Train loss: 0.285, Test loss: 2.943, Test accuracy: 46.32
Round  83, Global train loss: 0.285, Global test loss: 1.999, Global test accuracy: 28.72
Round  84, Train loss: 0.282, Test loss: 2.970, Test accuracy: 46.04
Round  84, Global train loss: 0.282, Global test loss: 2.146, Global test accuracy: 23.92
Round  85, Train loss: 0.201, Test loss: 2.955, Test accuracy: 45.93
Round  85, Global train loss: 0.201, Global test loss: 2.002, Global test accuracy: 33.27
Round  86, Train loss: 0.223, Test loss: 3.020, Test accuracy: 45.44
Round  86, Global train loss: 0.223, Global test loss: 2.024, Global test accuracy: 33.19
Round  87, Train loss: 0.271, Test loss: 2.961, Test accuracy: 45.95
Round  87, Global train loss: 0.271, Global test loss: 2.112, Global test accuracy: 24.77
Round  88, Train loss: 0.243, Test loss: 2.990, Test accuracy: 46.24
Round  88, Global train loss: 0.243, Global test loss: 2.146, Global test accuracy: 30.85
Round  89, Train loss: 0.288, Test loss: 3.060, Test accuracy: 45.79
Round  89, Global train loss: 0.288, Global test loss: 2.118, Global test accuracy: 26.95
Round  90, Train loss: 0.189, Test loss: 3.033, Test accuracy: 45.98
Round  90, Global train loss: 0.189, Global test loss: 1.885, Global test accuracy: 29.36
Round  91, Train loss: 0.224, Test loss: 3.065, Test accuracy: 45.89
Round  91, Global train loss: 0.224, Global test loss: 2.156, Global test accuracy: 22.41
Round  92, Train loss: 0.217, Test loss: 2.990, Test accuracy: 46.09
Round  92, Global train loss: 0.217, Global test loss: 2.009, Global test accuracy: 28.43
Round  93, Train loss: 0.217, Test loss: 3.057, Test accuracy: 46.26
Round  93, Global train loss: 0.217, Global test loss: 2.054, Global test accuracy: 26.23
Round  94, Train loss: 0.218, Test loss: 3.024, Test accuracy: 46.22
Round  94, Global train loss: 0.218, Global test loss: 2.092, Global test accuracy: 29.61
Round  95, Train loss: 0.208, Test loss: 3.069, Test accuracy: 45.87
Round  95, Global train loss: 0.208, Global test loss: 2.038, Global test accuracy: 26.51
Round  96, Train loss: 0.240, Test loss: 3.113, Test accuracy: 46.19
Round  96, Global train loss: 0.240, Global test loss: 2.138, Global test accuracy: 29.62
Round  97, Train loss: 0.165, Test loss: 3.190, Test accuracy: 46.52
Round  97, Global train loss: 0.165, Global test loss: 1.925, Global test accuracy: 33.51
Round  98, Train loss: 0.208, Test loss: 3.222, Test accuracy: 46.54
Round  98, Global train loss: 0.208, Global test loss: 2.139, Global test accuracy: 24.04
Round  99, Train loss: 0.177, Test loss: 3.293, Test accuracy: 45.99
Round  99, Global train loss: 0.177, Global test loss: 2.045, Global test accuracy: 27.31
Final Round, Train loss: 0.172, Test loss: 3.382, Test accuracy: 47.33
Final Round, Global train loss: 0.172, Global test loss: 2.045, Global test accuracy: 27.31
Average accuracy final 10 rounds: 46.155 

Average global accuracy final 10 rounds: 27.703000000000003 

1291.3834719657898
[1.3811571598052979, 2.7623143196105957, 3.865030527114868, 4.967746734619141, 6.071108818054199, 7.174470901489258, 8.30325984954834, 9.432048797607422, 10.554204225540161, 11.6763596534729, 12.795153617858887, 13.913947582244873, 15.035176038742065, 16.156404495239258, 17.277839183807373, 18.39927387237549, 19.51777672767639, 20.636279582977295, 21.757302045822144, 22.878324508666992, 23.997579336166382, 25.11683416366577, 26.238524913787842, 27.360215663909912, 28.47333526611328, 29.58645486831665, 30.69798231124878, 31.809509754180908, 32.91827702522278, 34.02704429626465, 35.12209963798523, 36.21715497970581, 37.332032442092896, 38.44690990447998, 39.561429262161255, 40.67594861984253, 41.79667615890503, 42.91740369796753, 44.03247928619385, 45.147554874420166, 46.265446186065674, 47.38333749771118, 48.50231409072876, 49.62129068374634, 50.744699478149414, 51.86810827255249, 52.987826108932495, 54.1075439453125, 55.2322359085083, 56.3569278717041, 57.46937561035156, 58.58182334899902, 59.69253492355347, 60.80324649810791, 61.91427159309387, 63.025296688079834, 64.14272475242615, 65.26015281677246, 66.37497520446777, 67.48979759216309, 68.60900259017944, 69.7282075881958, 70.84790349006653, 71.96759939193726, 73.09001207351685, 74.21242475509644, 75.3214955329895, 76.43056631088257, 77.5460376739502, 78.66150903701782, 79.77829003334045, 80.89507102966309, 82.0081353187561, 83.12119960784912, 84.23503041267395, 85.34886121749878, 86.45887327194214, 87.5688853263855, 88.67338275909424, 89.77788019180298, 90.89158654212952, 92.00529289245605, 93.1188371181488, 94.23238134384155, 95.34704279899597, 96.46170425415039, 97.41264057159424, 98.36357688903809, 99.31761169433594, 100.27164649963379, 101.22450304031372, 102.17735958099365, 103.12719511985779, 104.07703065872192, 105.03061151504517, 105.98419237136841, 106.93362522125244, 107.88305807113647, 108.83369040489197, 109.78432273864746, 110.73795676231384, 111.69159078598022, 112.64118695259094, 113.59078311920166, 114.53985476493835, 115.48892641067505, 116.44055438041687, 117.39218235015869, 118.34300684928894, 119.29383134841919, 120.24698758125305, 121.20014381408691, 122.15527987480164, 123.11041593551636, 124.06050372123718, 125.01059150695801, 125.95841479301453, 126.90623807907104, 127.85661005973816, 128.80698204040527, 129.7604525089264, 130.7139229774475, 131.66487383842468, 132.61582469940186, 133.56344532966614, 134.51106595993042, 135.45162796974182, 136.39218997955322, 137.34423661231995, 138.29628324508667, 139.2444760799408, 140.19266891479492, 141.14281296730042, 142.0929570198059, 143.0413830280304, 143.98980903625488, 144.93750929832458, 145.8852095603943, 146.8349096775055, 147.7846097946167, 148.7332468032837, 149.68188381195068, 150.63052558898926, 151.57916736602783, 152.52887225151062, 153.4785771369934, 154.42977261543274, 155.38096809387207, 156.32768201828003, 157.274395942688, 158.2247986793518, 159.17520141601562, 160.13380455970764, 161.09240770339966, 162.0536572933197, 163.01490688323975, 163.97603607177734, 164.93716526031494, 165.88668608665466, 166.83620691299438, 167.78702211380005, 168.7378373146057, 169.68835306167603, 170.63886880874634, 171.59056735038757, 172.5422658920288, 173.50067687034607, 174.45908784866333, 175.4076178073883, 176.35614776611328, 177.30362224578857, 178.25109672546387, 179.20801520347595, 180.16493368148804, 181.12659788131714, 182.08826208114624, 183.0479428768158, 184.00762367248535, 184.96789503097534, 185.92816638946533, 186.8881003856659, 187.84803438186646, 188.8071358203888, 189.76623725891113, 190.72675561904907, 191.687273979187, 192.64885759353638, 193.61044120788574, 194.56007266044617, 195.5097041130066, 196.46602129936218, 197.42233848571777, 198.38155245780945, 199.34076642990112, 200.29905700683594, 201.25734758377075, 202.21576070785522, 203.1741738319397, 204.1320984363556, 205.09002304077148, 207.00884175300598, 208.92766046524048]
[21.54, 21.54, 31.66, 31.66, 32.2, 32.2, 33.59, 33.59, 37.98, 37.98, 39.44, 39.44, 41.25, 41.25, 42.8, 42.8, 43.12, 43.12, 43.65, 43.65, 45.14, 45.14, 45.66, 45.66, 44.7, 44.7, 46.87, 46.87, 47.13, 47.13, 47.23, 47.23, 47.97, 47.97, 48.11, 48.11, 48.21, 48.21, 48.95, 48.95, 48.55, 48.55, 48.57, 48.57, 48.55, 48.55, 48.34, 48.34, 48.24, 48.24, 48.76, 48.76, 48.11, 48.11, 47.75, 47.75, 47.68, 47.68, 47.72, 47.72, 47.66, 47.66, 47.26, 47.26, 47.66, 47.66, 47.4, 47.4, 47.82, 47.82, 47.86, 47.86, 47.35, 47.35, 47.73, 47.73, 47.53, 47.53, 46.38, 46.38, 46.89, 46.89, 47.36, 47.36, 47.62, 47.62, 46.81, 46.81, 46.57, 46.57, 46.05, 46.05, 46.28, 46.28, 46.99, 46.99, 46.7, 46.7, 46.77, 46.77, 46.55, 46.55, 46.29, 46.29, 46.51, 46.51, 46.63, 46.63, 46.59, 46.59, 46.22, 46.22, 46.43, 46.43, 46.98, 46.98, 47.0, 47.0, 46.77, 46.77, 46.27, 46.27, 46.39, 46.39, 45.86, 45.86, 45.75, 45.75, 46.25, 46.25, 46.61, 46.61, 46.9, 46.9, 46.17, 46.17, 46.4, 46.4, 46.14, 46.14, 45.86, 45.86, 46.31, 46.31, 46.56, 46.56, 46.61, 46.61, 46.74, 46.74, 46.56, 46.56, 46.3, 46.3, 46.63, 46.63, 46.04, 46.04, 45.32, 45.32, 45.83, 45.83, 46.43, 46.43, 46.5, 46.5, 46.32, 46.32, 46.04, 46.04, 45.93, 45.93, 45.44, 45.44, 45.95, 45.95, 46.24, 46.24, 45.79, 45.79, 45.98, 45.98, 45.89, 45.89, 46.09, 46.09, 46.26, 46.26, 46.22, 46.22, 45.87, 45.87, 46.19, 46.19, 46.52, 46.52, 46.54, 46.54, 45.99, 45.99, 47.33, 47.33]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.626, Test loss: 1.998, Test accuracy: 25.09
Round   0, Global train loss: 1.626, Global test loss: 2.194, Global test accuracy: 20.30
Round   1, Train loss: 1.601, Test loss: 1.745, Test accuracy: 33.88
Round   1, Global train loss: 1.601, Global test loss: 2.014, Global test accuracy: 28.21
Round   2, Train loss: 1.320, Test loss: 1.655, Test accuracy: 38.07
Round   2, Global train loss: 1.320, Global test loss: 2.069, Global test accuracy: 27.27
Round   3, Train loss: 1.251, Test loss: 1.482, Test accuracy: 44.55
Round   3, Global train loss: 1.251, Global test loss: 2.005, Global test accuracy: 31.16
Round   4, Train loss: 1.277, Test loss: 1.307, Test accuracy: 49.47
Round   4, Global train loss: 1.277, Global test loss: 1.831, Global test accuracy: 34.28
Round   5, Train loss: 1.244, Test loss: 1.264, Test accuracy: 52.47
Round   5, Global train loss: 1.244, Global test loss: 1.749, Global test accuracy: 36.65
Round   6, Train loss: 1.234, Test loss: 1.197, Test accuracy: 55.08
Round   6, Global train loss: 1.234, Global test loss: 1.631, Global test accuracy: 40.48
Round   7, Train loss: 1.117, Test loss: 1.167, Test accuracy: 55.81
Round   7, Global train loss: 1.117, Global test loss: 1.745, Global test accuracy: 37.29
Round   8, Train loss: 1.132, Test loss: 1.170, Test accuracy: 55.81
Round   8, Global train loss: 1.132, Global test loss: 1.758, Global test accuracy: 36.05
Round   9, Train loss: 1.122, Test loss: 1.160, Test accuracy: 57.05
Round   9, Global train loss: 1.122, Global test loss: 1.636, Global test accuracy: 46.22
Round  10, Train loss: 1.084, Test loss: 1.093, Test accuracy: 59.33
Round  10, Global train loss: 1.084, Global test loss: 1.497, Global test accuracy: 46.98
Round  11, Train loss: 1.114, Test loss: 1.109, Test accuracy: 58.39
Round  11, Global train loss: 1.114, Global test loss: 1.496, Global test accuracy: 47.08
Round  12, Train loss: 1.108, Test loss: 1.087, Test accuracy: 59.54
Round  12, Global train loss: 1.108, Global test loss: 1.597, Global test accuracy: 43.78
Round  13, Train loss: 0.979, Test loss: 1.050, Test accuracy: 60.75
Round  13, Global train loss: 0.979, Global test loss: 1.514, Global test accuracy: 45.36
Round  14, Train loss: 0.986, Test loss: 1.039, Test accuracy: 61.53
Round  14, Global train loss: 0.986, Global test loss: 1.581, Global test accuracy: 47.08
Round  15, Train loss: 0.950, Test loss: 1.050, Test accuracy: 60.99
Round  15, Global train loss: 0.950, Global test loss: 1.599, Global test accuracy: 45.25
Round  16, Train loss: 0.949, Test loss: 1.047, Test accuracy: 61.41
Round  16, Global train loss: 0.949, Global test loss: 1.482, Global test accuracy: 46.08
Round  17, Train loss: 0.970, Test loss: 1.024, Test accuracy: 62.23
Round  17, Global train loss: 0.970, Global test loss: 1.524, Global test accuracy: 48.50
Round  18, Train loss: 1.032, Test loss: 1.029, Test accuracy: 62.35
Round  18, Global train loss: 1.032, Global test loss: 1.509, Global test accuracy: 47.58
Round  19, Train loss: 0.865, Test loss: 0.997, Test accuracy: 63.69
Round  19, Global train loss: 0.865, Global test loss: 1.418, Global test accuracy: 50.24
Round  20, Train loss: 0.952, Test loss: 1.001, Test accuracy: 63.72
Round  20, Global train loss: 0.952, Global test loss: 1.328, Global test accuracy: 55.45
Round  21, Train loss: 0.911, Test loss: 0.984, Test accuracy: 64.37
Round  21, Global train loss: 0.911, Global test loss: 1.523, Global test accuracy: 48.85
Round  22, Train loss: 0.824, Test loss: 0.976, Test accuracy: 64.59
Round  22, Global train loss: 0.824, Global test loss: 1.563, Global test accuracy: 49.32
Round  23, Train loss: 0.870, Test loss: 0.990, Test accuracy: 64.43
Round  23, Global train loss: 0.870, Global test loss: 1.430, Global test accuracy: 52.19
Round  24, Train loss: 0.818, Test loss: 0.987, Test accuracy: 64.98
Round  24, Global train loss: 0.818, Global test loss: 1.382, Global test accuracy: 54.60
Round  25, Train loss: 0.904, Test loss: 0.968, Test accuracy: 65.34
Round  25, Global train loss: 0.904, Global test loss: 1.364, Global test accuracy: 53.96
Round  26, Train loss: 0.890, Test loss: 0.971, Test accuracy: 65.38
Round  26, Global train loss: 0.890, Global test loss: 1.412, Global test accuracy: 53.97
Round  27, Train loss: 0.937, Test loss: 0.947, Test accuracy: 65.89
Round  27, Global train loss: 0.937, Global test loss: 1.309, Global test accuracy: 54.77
Round  28, Train loss: 0.820, Test loss: 0.956, Test accuracy: 65.73
Round  28, Global train loss: 0.820, Global test loss: 1.382, Global test accuracy: 53.40
Round  29, Train loss: 0.856, Test loss: 0.971, Test accuracy: 65.51
Round  29, Global train loss: 0.856, Global test loss: 1.231, Global test accuracy: 58.36
Round  30, Train loss: 0.724, Test loss: 0.971, Test accuracy: 65.96
Round  30, Global train loss: 0.724, Global test loss: 1.477, Global test accuracy: 51.84
Round  31, Train loss: 0.685, Test loss: 0.973, Test accuracy: 65.68
Round  31, Global train loss: 0.685, Global test loss: 1.350, Global test accuracy: 53.51
Round  32, Train loss: 0.735, Test loss: 0.969, Test accuracy: 65.77
Round  32, Global train loss: 0.735, Global test loss: 1.269, Global test accuracy: 56.81
Round  33, Train loss: 0.799, Test loss: 0.982, Test accuracy: 65.28
Round  33, Global train loss: 0.799, Global test loss: 1.271, Global test accuracy: 56.60
Round  34, Train loss: 0.642, Test loss: 0.992, Test accuracy: 64.96
Round  34, Global train loss: 0.642, Global test loss: 1.311, Global test accuracy: 57.16
Round  35, Train loss: 0.730, Test loss: 0.969, Test accuracy: 66.10
Round  35, Global train loss: 0.730, Global test loss: 1.186, Global test accuracy: 59.32
Round  36, Train loss: 0.728, Test loss: 0.989, Test accuracy: 65.78
Round  36, Global train loss: 0.728, Global test loss: 1.207, Global test accuracy: 58.88
Round  37, Train loss: 0.801, Test loss: 1.000, Test accuracy: 65.72
Round  37, Global train loss: 0.801, Global test loss: 1.245, Global test accuracy: 57.17
Round  38, Train loss: 0.684, Test loss: 0.986, Test accuracy: 66.00
Round  38, Global train loss: 0.684, Global test loss: 1.337, Global test accuracy: 56.21
Round  39, Train loss: 0.677, Test loss: 0.972, Test accuracy: 66.44
Round  39, Global train loss: 0.677, Global test loss: 1.254, Global test accuracy: 58.04
Round  40, Train loss: 0.674, Test loss: 0.963, Test accuracy: 66.83
Round  40, Global train loss: 0.674, Global test loss: 1.206, Global test accuracy: 59.24
Round  41, Train loss: 0.575, Test loss: 0.960, Test accuracy: 67.33
Round  41, Global train loss: 0.575, Global test loss: 1.349, Global test accuracy: 57.52
Round  42, Train loss: 0.688, Test loss: 0.959, Test accuracy: 67.74
Round  42, Global train loss: 0.688, Global test loss: 1.266, Global test accuracy: 58.34
Round  43, Train loss: 0.736, Test loss: 0.980, Test accuracy: 67.27
Round  43, Global train loss: 0.736, Global test loss: 1.269, Global test accuracy: 58.11
Round  44, Train loss: 0.722, Test loss: 0.972, Test accuracy: 67.24
Round  44, Global train loss: 0.722, Global test loss: 1.180, Global test accuracy: 59.82
Round  45, Train loss: 0.661, Test loss: 0.996, Test accuracy: 67.01
Round  45, Global train loss: 0.661, Global test loss: 1.305, Global test accuracy: 58.23
Round  46, Train loss: 0.610, Test loss: 0.978, Test accuracy: 67.71
Round  46, Global train loss: 0.610, Global test loss: 1.204, Global test accuracy: 59.38
Round  47, Train loss: 0.701, Test loss: 0.985, Test accuracy: 67.88
Round  47, Global train loss: 0.701, Global test loss: 1.309, Global test accuracy: 55.96
Round  48, Train loss: 0.667, Test loss: 0.988, Test accuracy: 67.77
Round  48, Global train loss: 0.667, Global test loss: 1.313, Global test accuracy: 57.44
Round  49, Train loss: 0.633, Test loss: 0.976, Test accuracy: 67.90
Round  49, Global train loss: 0.633, Global test loss: 1.430, Global test accuracy: 54.45
Round  50, Train loss: 0.516, Test loss: 0.995, Test accuracy: 67.51
Round  50, Global train loss: 0.516, Global test loss: 1.351, Global test accuracy: 58.10
Round  51, Train loss: 0.605, Test loss: 0.962, Test accuracy: 68.25
Round  51, Global train loss: 0.605, Global test loss: 1.324, Global test accuracy: 57.16
Round  52, Train loss: 0.600, Test loss: 0.992, Test accuracy: 67.80
Round  52, Global train loss: 0.600, Global test loss: 1.222, Global test accuracy: 60.64
Round  53, Train loss: 0.539, Test loss: 0.988, Test accuracy: 68.04
Round  53, Global train loss: 0.539, Global test loss: 1.328, Global test accuracy: 56.85
Round  54, Train loss: 0.568, Test loss: 0.985, Test accuracy: 68.26
Round  54, Global train loss: 0.568, Global test loss: 1.200, Global test accuracy: 59.98
Round  55, Train loss: 0.646, Test loss: 0.981, Test accuracy: 68.07
Round  55, Global train loss: 0.646, Global test loss: 1.222, Global test accuracy: 59.63
Round  56, Train loss: 0.677, Test loss: 1.011, Test accuracy: 67.62
Round  56, Global train loss: 0.677, Global test loss: 1.284, Global test accuracy: 56.92
Round  57, Train loss: 0.571, Test loss: 1.018, Test accuracy: 67.29
Round  57, Global train loss: 0.571, Global test loss: 1.183, Global test accuracy: 60.59
Round  58, Train loss: 0.562, Test loss: 1.022, Test accuracy: 67.16
Round  58, Global train loss: 0.562, Global test loss: 1.331, Global test accuracy: 57.76
Round  59, Train loss: 0.550, Test loss: 1.029, Test accuracy: 67.28
Round  59, Global train loss: 0.550, Global test loss: 1.200, Global test accuracy: 61.08
Round  60, Train loss: 0.548, Test loss: 1.020, Test accuracy: 67.63
Round  60, Global train loss: 0.548, Global test loss: 1.364, Global test accuracy: 58.31
Round  61, Train loss: 0.464, Test loss: 1.021, Test accuracy: 68.21
Round  61, Global train loss: 0.464, Global test loss: 1.251, Global test accuracy: 60.62
Round  62, Train loss: 0.427, Test loss: 1.037, Test accuracy: 68.35
Round  62, Global train loss: 0.427, Global test loss: 1.447, Global test accuracy: 56.27
Round  63, Train loss: 0.486, Test loss: 1.020, Test accuracy: 68.32
Round  63, Global train loss: 0.486, Global test loss: 1.131, Global test accuracy: 63.90
Round  64, Train loss: 0.573, Test loss: 1.031, Test accuracy: 67.77
Round  64, Global train loss: 0.573, Global test loss: 1.365, Global test accuracy: 59.90
Round  65, Train loss: 0.380, Test loss: 1.040, Test accuracy: 67.85
Round  65, Global train loss: 0.380, Global test loss: 1.223, Global test accuracy: 63.18
Round  66, Train loss: 0.463, Test loss: 1.025, Test accuracy: 68.45
Round  66, Global train loss: 0.463, Global test loss: 1.262, Global test accuracy: 61.88
Round  67, Train loss: 0.532, Test loss: 1.027, Test accuracy: 68.27
Round  67, Global train loss: 0.532, Global test loss: 1.457, Global test accuracy: 57.75
Round  68, Train loss: 0.479, Test loss: 1.045, Test accuracy: 68.30
Round  68, Global train loss: 0.479, Global test loss: 1.276, Global test accuracy: 60.01
Round  69, Train loss: 0.550, Test loss: 1.025, Test accuracy: 68.88
Round  69, Global train loss: 0.550, Global test loss: 1.251, Global test accuracy: 61.03
Round  70, Train loss: 0.531, Test loss: 1.022, Test accuracy: 69.34
Round  70, Global train loss: 0.531, Global test loss: 1.350, Global test accuracy: 59.52
Round  71, Train loss: 0.440, Test loss: 1.030, Test accuracy: 69.22
Round  71, Global train loss: 0.440, Global test loss: 1.310, Global test accuracy: 60.60
Round  72, Train loss: 0.388, Test loss: 1.056, Test accuracy: 68.77
Round  72, Global train loss: 0.388, Global test loss: 1.418, Global test accuracy: 57.69
Round  73, Train loss: 0.481, Test loss: 1.039, Test accuracy: 68.83
Round  73, Global train loss: 0.481, Global test loss: 1.304, Global test accuracy: 59.93
Round  74, Train loss: 0.455, Test loss: 1.028, Test accuracy: 68.92
Round  74, Global train loss: 0.455, Global test loss: 1.183, Global test accuracy: 62.83
Round  75, Train loss: 0.514, Test loss: 1.041, Test accuracy: 69.09
Round  75, Global train loss: 0.514, Global test loss: 1.235, Global test accuracy: 60.82
Round  76, Train loss: 0.385, Test loss: 1.066, Test accuracy: 68.40
Round  76, Global train loss: 0.385, Global test loss: 1.429, Global test accuracy: 56.93
Round  77, Train loss: 0.355, Test loss: 1.084, Test accuracy: 68.47
Round  77, Global train loss: 0.355, Global test loss: 1.490, Global test accuracy: 59.00
Round  78, Train loss: 0.383, Test loss: 1.096, Test accuracy: 68.20
Round  78, Global train loss: 0.383, Global test loss: 1.301, Global test accuracy: 60.46
Round  79, Train loss: 0.527, Test loss: 1.096, Test accuracy: 68.38
Round  79, Global train loss: 0.527, Global test loss: 1.398, Global test accuracy: 58.76
Round  80, Train loss: 0.475, Test loss: 1.104, Test accuracy: 68.62
Round  80, Global train loss: 0.475, Global test loss: 1.312, Global test accuracy: 60.75
Round  81, Train loss: 0.536, Test loss: 1.136, Test accuracy: 68.45
Round  81, Global train loss: 0.536, Global test loss: 1.436, Global test accuracy: 57.33
Round  82, Train loss: 0.393, Test loss: 1.106, Test accuracy: 68.92
Round  82, Global train loss: 0.393, Global test loss: 1.221, Global test accuracy: 62.43
Round  83, Train loss: 0.386, Test loss: 1.108, Test accuracy: 68.53
Round  83, Global train loss: 0.386, Global test loss: 1.364, Global test accuracy: 60.45
Round  84, Train loss: 0.361, Test loss: 1.083, Test accuracy: 69.17
Round  84, Global train loss: 0.361, Global test loss: 1.462, Global test accuracy: 58.95
Round  85, Train loss: 0.339, Test loss: 1.075, Test accuracy: 69.08
Round  85, Global train loss: 0.339, Global test loss: 1.531, Global test accuracy: 57.94
Round  86, Train loss: 0.451, Test loss: 1.098, Test accuracy: 69.41
Round  86, Global train loss: 0.451, Global test loss: 1.342, Global test accuracy: 60.60
Round  87, Train loss: 0.361, Test loss: 1.057, Test accuracy: 69.96
Round  87, Global train loss: 0.361, Global test loss: 1.346, Global test accuracy: 60.79
Round  88, Train loss: 0.470, Test loss: 1.068, Test accuracy: 69.67
Round  88, Global train loss: 0.470, Global test loss: 1.403, Global test accuracy: 60.66
Round  89, Train loss: 0.387, Test loss: 1.065, Test accuracy: 69.63
Round  89, Global train loss: 0.387, Global test loss: 1.349, Global test accuracy: 61.09
Round  90, Train loss: 0.478, Test loss: 1.079, Test accuracy: 69.00
Round  90, Global train loss: 0.478, Global test loss: 1.240, Global test accuracy: 61.58
Round  91, Train loss: 0.401, Test loss: 1.075, Test accuracy: 69.41
Round  91, Global train loss: 0.401, Global test loss: 1.292, Global test accuracy: 61.58
Round  92, Train loss: 0.372, Test loss: 1.072, Test accuracy: 70.26
Round  92, Global train loss: 0.372, Global test loss: 1.388, Global test accuracy: 60.52
Round  93, Train loss: 0.452, Test loss: 1.067, Test accuracy: 70.41
Round  93, Global train loss: 0.452, Global test loss: 1.226, Global test accuracy: 63.15
Round  94, Train loss: 0.440, Test loss: 1.087, Test accuracy: 69.53
Round  94, Global train loss: 0.440, Global test loss: 1.300, Global test accuracy: 61.13
Round  95, Train loss: 0.462, Test loss: 1.087, Test accuracy: 69.29
Round  95, Global train loss: 0.462, Global test loss: 1.246, Global test accuracy: 62.26
Round  96, Train loss: 0.348, Test loss: 1.097, Test accuracy: 69.34
Round  96, Global train loss: 0.348, Global test loss: 1.567, Global test accuracy: 58.72
Round  97, Train loss: 0.428, Test loss: 1.113, Test accuracy: 69.03
Round  97, Global train loss: 0.428, Global test loss: 1.253, Global test accuracy: 63.45
Round  98, Train loss: 0.502, Test loss: 1.121, Test accuracy: 69.23
Round  98, Global train loss: 0.502, Global test loss: 1.294, Global test accuracy: 61.52
Round  99, Train loss: 0.421, Test loss: 1.140, Test accuracy: 69.38
Round  99, Global train loss: 0.421, Global test loss: 1.243, Global test accuracy: 62.37
Final Round, Train loss: 0.303, Test loss: 1.249, Test accuracy: 68.92
Final Round, Global train loss: 0.303, Global test loss: 1.243, Global test accuracy: 62.37
Average accuracy final 10 rounds: 69.488 

Average global accuracy final 10 rounds: 61.628 

1309.7168397903442
[1.3839776515960693, 2.7679553031921387, 3.871246099472046, 4.974536895751953, 6.080253839492798, 7.185970783233643, 8.29293417930603, 9.399897575378418, 10.505429029464722, 11.610960483551025, 12.718336343765259, 13.825712203979492, 14.947657346725464, 16.069602489471436, 17.194414138793945, 18.319225788116455, 19.44117546081543, 20.563125133514404, 21.68757438659668, 22.812023639678955, 23.935797929763794, 25.059572219848633, 26.183868169784546, 27.30816411972046, 28.440286874771118, 29.572409629821777, 30.705408334732056, 31.838407039642334, 32.96963572502136, 34.10086441040039, 35.23036861419678, 36.359872817993164, 37.48351740837097, 38.60716199874878, 39.73124361038208, 40.85532522201538, 41.98805832862854, 43.1207914352417, 44.24286937713623, 45.36494731903076, 46.4842472076416, 47.60354709625244, 48.73265480995178, 49.86176252365112, 50.99704456329346, 52.13232660293579, 53.25634956359863, 54.380372524261475, 55.501224756240845, 56.622076988220215, 57.7452552318573, 58.868433475494385, 59.98485803604126, 61.101282596588135, 62.05383825302124, 63.006393909454346, 63.950262784957886, 64.89413166046143, 65.83937382698059, 66.78461599349976, 67.72803330421448, 68.6714506149292, 69.61331582069397, 70.55518102645874, 71.503741979599, 72.45230293273926, 73.40480756759644, 74.35731220245361, 75.30946016311646, 76.2616081237793, 77.21398663520813, 78.16636514663696, 79.11946058273315, 80.07255601882935, 81.0246512889862, 81.97674655914307, 82.92928695678711, 83.88182735443115, 84.83425188064575, 85.78667640686035, 86.73799991607666, 87.68932342529297, 88.63950753211975, 89.58969163894653, 90.54142665863037, 91.49316167831421, 92.4402768611908, 93.38739204406738, 94.33168816566467, 95.27598428726196, 96.22681951522827, 97.17765474319458, 98.13060140609741, 99.08354806900024, 100.03235697746277, 100.9811658859253, 101.93319821357727, 102.88523054122925, 103.8376157283783, 104.79000091552734, 105.73515701293945, 106.68031311035156, 107.62448215484619, 108.56865119934082, 109.51445889472961, 110.46026659011841, 111.41188430786133, 112.36350202560425, 113.31564545631409, 114.26778888702393, 115.22169971466064, 116.17561054229736, 117.12898659706116, 118.08236265182495, 119.03424739837646, 119.98613214492798, 120.93379211425781, 121.88145208358765, 122.83438920974731, 123.78732633590698, 124.74008822441101, 125.69285011291504, 126.6451768875122, 127.59750366210938, 128.5497510433197, 129.50199842453003, 130.4522933959961, 131.40258836746216, 132.35536909103394, 133.3081498146057, 134.2709949016571, 135.2338399887085, 136.18798303604126, 137.14212608337402, 138.09644031524658, 139.05075454711914, 140.00307416915894, 140.95539379119873, 141.90815830230713, 142.86092281341553, 143.81345891952515, 144.76599502563477, 145.71914196014404, 146.67228889465332, 147.6278874874115, 148.58348608016968, 149.53715538978577, 150.49082469940186, 151.44424676895142, 152.39766883850098, 153.51484441757202, 154.63201999664307, 155.74055242538452, 156.84908485412598, 157.96354866027832, 159.07801246643066, 160.18834590911865, 161.29867935180664, 162.41303372383118, 163.5273880958557, 164.64218473434448, 165.75698137283325, 166.8720088005066, 167.98703622817993, 169.09605503082275, 170.20507383346558, 171.33057856559753, 172.4560832977295, 173.5675983428955, 174.67911338806152, 175.79122018814087, 176.90332698822021, 178.01567196846008, 179.12801694869995, 180.2407088279724, 181.35340070724487, 182.46977996826172, 183.58615922927856, 184.6933445930481, 185.80052995681763, 186.91450333595276, 188.0284767150879, 189.15069890022278, 190.27292108535767, 191.3804748058319, 192.48802852630615, 193.61104536056519, 194.73406219482422, 195.84691643714905, 196.95977067947388, 198.07435655593872, 199.18894243240356, 200.30351543426514, 201.4180884361267, 202.5281159877777, 203.6381435394287, 204.75709795951843, 205.87605237960815, 206.98191046714783, 208.0877685546875, 210.31690907478333, 212.54604959487915]
[25.09, 25.09, 33.88, 33.88, 38.07, 38.07, 44.55, 44.55, 49.47, 49.47, 52.47, 52.47, 55.08, 55.08, 55.81, 55.81, 55.81, 55.81, 57.05, 57.05, 59.33, 59.33, 58.39, 58.39, 59.54, 59.54, 60.75, 60.75, 61.53, 61.53, 60.99, 60.99, 61.41, 61.41, 62.23, 62.23, 62.35, 62.35, 63.69, 63.69, 63.72, 63.72, 64.37, 64.37, 64.59, 64.59, 64.43, 64.43, 64.98, 64.98, 65.34, 65.34, 65.38, 65.38, 65.89, 65.89, 65.73, 65.73, 65.51, 65.51, 65.96, 65.96, 65.68, 65.68, 65.77, 65.77, 65.28, 65.28, 64.96, 64.96, 66.1, 66.1, 65.78, 65.78, 65.72, 65.72, 66.0, 66.0, 66.44, 66.44, 66.83, 66.83, 67.33, 67.33, 67.74, 67.74, 67.27, 67.27, 67.24, 67.24, 67.01, 67.01, 67.71, 67.71, 67.88, 67.88, 67.77, 67.77, 67.9, 67.9, 67.51, 67.51, 68.25, 68.25, 67.8, 67.8, 68.04, 68.04, 68.26, 68.26, 68.07, 68.07, 67.62, 67.62, 67.29, 67.29, 67.16, 67.16, 67.28, 67.28, 67.63, 67.63, 68.21, 68.21, 68.35, 68.35, 68.32, 68.32, 67.77, 67.77, 67.85, 67.85, 68.45, 68.45, 68.27, 68.27, 68.3, 68.3, 68.88, 68.88, 69.34, 69.34, 69.22, 69.22, 68.77, 68.77, 68.83, 68.83, 68.92, 68.92, 69.09, 69.09, 68.4, 68.4, 68.47, 68.47, 68.2, 68.2, 68.38, 68.38, 68.62, 68.62, 68.45, 68.45, 68.92, 68.92, 68.53, 68.53, 69.17, 69.17, 69.08, 69.08, 69.41, 69.41, 69.96, 69.96, 69.67, 69.67, 69.63, 69.63, 69.0, 69.0, 69.41, 69.41, 70.26, 70.26, 70.41, 70.41, 69.53, 69.53, 69.29, 69.29, 69.34, 69.34, 69.03, 69.03, 69.23, 69.23, 69.38, 69.38, 68.92, 68.92]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.657, Test loss: 1.965, Test accuracy: 27.42
Round   0, Global train loss: 1.657, Global test loss: 2.164, Global test accuracy: 22.96
Round   1, Train loss: 1.492, Test loss: 1.742, Test accuracy: 32.78
Round   1, Global train loss: 1.492, Global test loss: 2.049, Global test accuracy: 25.07
Round   2, Train loss: 1.299, Test loss: 1.621, Test accuracy: 37.37
Round   2, Global train loss: 1.299, Global test loss: 2.060, Global test accuracy: 26.58
Round   3, Train loss: 1.286, Test loss: 1.512, Test accuracy: 42.06
Round   3, Global train loss: 1.286, Global test loss: 2.123, Global test accuracy: 27.82
Round   4, Train loss: 1.235, Test loss: 1.315, Test accuracy: 46.50
Round   4, Global train loss: 1.235, Global test loss: 1.935, Global test accuracy: 26.93
Round   5, Train loss: 1.221, Test loss: 1.276, Test accuracy: 49.39
Round   5, Global train loss: 1.221, Global test loss: 1.825, Global test accuracy: 32.24
Round   6, Train loss: 1.196, Test loss: 1.189, Test accuracy: 52.77
Round   6, Global train loss: 1.196, Global test loss: 1.626, Global test accuracy: 42.26
Round   7, Train loss: 1.136, Test loss: 1.153, Test accuracy: 53.86
Round   7, Global train loss: 1.136, Global test loss: 1.695, Global test accuracy: 39.49
Round   8, Train loss: 1.148, Test loss: 1.155, Test accuracy: 53.94
Round   8, Global train loss: 1.148, Global test loss: 1.778, Global test accuracy: 34.16
Round   9, Train loss: 1.079, Test loss: 1.136, Test accuracy: 55.44
Round   9, Global train loss: 1.079, Global test loss: 1.695, Global test accuracy: 41.26
Round  10, Train loss: 1.085, Test loss: 1.078, Test accuracy: 57.96
Round  10, Global train loss: 1.085, Global test loss: 1.560, Global test accuracy: 44.95
Round  11, Train loss: 1.072, Test loss: 1.095, Test accuracy: 57.85
Round  11, Global train loss: 1.072, Global test loss: 1.537, Global test accuracy: 43.67
Round  12, Train loss: 0.974, Test loss: 1.069, Test accuracy: 59.59
Round  12, Global train loss: 0.974, Global test loss: 1.550, Global test accuracy: 43.94
Round  13, Train loss: 1.020, Test loss: 1.021, Test accuracy: 61.13
Round  13, Global train loss: 1.020, Global test loss: 1.502, Global test accuracy: 44.79
Round  14, Train loss: 0.919, Test loss: 1.039, Test accuracy: 60.79
Round  14, Global train loss: 0.919, Global test loss: 1.618, Global test accuracy: 45.85
Round  15, Train loss: 0.964, Test loss: 1.044, Test accuracy: 60.38
Round  15, Global train loss: 0.964, Global test loss: 1.759, Global test accuracy: 40.74
Round  16, Train loss: 1.003, Test loss: 1.024, Test accuracy: 61.09
Round  16, Global train loss: 1.003, Global test loss: 1.505, Global test accuracy: 46.06
Round  17, Train loss: 0.831, Test loss: 1.025, Test accuracy: 60.73
Round  17, Global train loss: 0.831, Global test loss: 1.585, Global test accuracy: 46.34
Round  18, Train loss: 0.891, Test loss: 1.015, Test accuracy: 61.29
Round  18, Global train loss: 0.891, Global test loss: 1.545, Global test accuracy: 46.51
Round  19, Train loss: 0.987, Test loss: 0.988, Test accuracy: 62.07
Round  19, Global train loss: 0.987, Global test loss: 1.468, Global test accuracy: 48.09
Round  20, Train loss: 0.841, Test loss: 0.970, Test accuracy: 63.04
Round  20, Global train loss: 0.841, Global test loss: 1.387, Global test accuracy: 51.26
Round  21, Train loss: 0.798, Test loss: 0.982, Test accuracy: 62.87
Round  21, Global train loss: 0.798, Global test loss: 1.548, Global test accuracy: 47.82
Round  22, Train loss: 0.846, Test loss: 0.962, Test accuracy: 63.62
Round  22, Global train loss: 0.846, Global test loss: 1.524, Global test accuracy: 49.29
Round  23, Train loss: 0.806, Test loss: 0.975, Test accuracy: 63.20
Round  23, Global train loss: 0.806, Global test loss: 1.399, Global test accuracy: 51.70
Round  24, Train loss: 0.814, Test loss: 0.945, Test accuracy: 64.38
Round  24, Global train loss: 0.814, Global test loss: 1.346, Global test accuracy: 54.37
Round  25, Train loss: 0.863, Test loss: 0.954, Test accuracy: 64.57
Round  25, Global train loss: 0.863, Global test loss: 1.392, Global test accuracy: 52.27
Round  26, Train loss: 0.868, Test loss: 0.926, Test accuracy: 65.25
Round  26, Global train loss: 0.868, Global test loss: 1.370, Global test accuracy: 53.29
Round  27, Train loss: 0.865, Test loss: 0.903, Test accuracy: 66.12
Round  27, Global train loss: 0.865, Global test loss: 1.330, Global test accuracy: 53.34
Round  28, Train loss: 0.774, Test loss: 0.922, Test accuracy: 65.59
Round  28, Global train loss: 0.774, Global test loss: 1.469, Global test accuracy: 48.94
Round  29, Train loss: 0.829, Test loss: 0.913, Test accuracy: 66.42
Round  29, Global train loss: 0.829, Global test loss: 1.228, Global test accuracy: 58.03
Round  30, Train loss: 0.787, Test loss: 0.912, Test accuracy: 66.75
Round  30, Global train loss: 0.787, Global test loss: 1.504, Global test accuracy: 48.67
Round  31, Train loss: 0.744, Test loss: 0.912, Test accuracy: 67.24
Round  31, Global train loss: 0.744, Global test loss: 1.359, Global test accuracy: 53.57
Round  32, Train loss: 0.761, Test loss: 0.926, Test accuracy: 66.99
Round  32, Global train loss: 0.761, Global test loss: 1.332, Global test accuracy: 54.05
Round  33, Train loss: 0.777, Test loss: 0.912, Test accuracy: 67.07
Round  33, Global train loss: 0.777, Global test loss: 1.265, Global test accuracy: 56.27
Round  34, Train loss: 0.734, Test loss: 0.910, Test accuracy: 67.29
Round  34, Global train loss: 0.734, Global test loss: 1.392, Global test accuracy: 52.83
Round  35, Train loss: 0.777, Test loss: 0.915, Test accuracy: 67.10
Round  35, Global train loss: 0.777, Global test loss: 1.303, Global test accuracy: 54.50
Round  36, Train loss: 0.743, Test loss: 0.888, Test accuracy: 68.09
Round  36, Global train loss: 0.743, Global test loss: 1.235, Global test accuracy: 57.94
Round  37, Train loss: 0.746, Test loss: 0.918, Test accuracy: 67.22
Round  37, Global train loss: 0.746, Global test loss: 1.329, Global test accuracy: 53.57
Round  38, Train loss: 0.791, Test loss: 0.899, Test accuracy: 68.01
Round  38, Global train loss: 0.791, Global test loss: 1.283, Global test accuracy: 54.81
Round  39, Train loss: 0.704, Test loss: 0.877, Test accuracy: 68.88
Round  39, Global train loss: 0.704, Global test loss: 1.249, Global test accuracy: 57.47
Round  40, Train loss: 0.688, Test loss: 0.886, Test accuracy: 68.74
Round  40, Global train loss: 0.688, Global test loss: 1.208, Global test accuracy: 58.98
Round  41, Train loss: 0.585, Test loss: 0.904, Test accuracy: 67.89
Round  41, Global train loss: 0.585, Global test loss: 1.264, Global test accuracy: 58.17
Round  42, Train loss: 0.687, Test loss: 0.882, Test accuracy: 68.69
Round  42, Global train loss: 0.687, Global test loss: 1.304, Global test accuracy: 56.12
Round  43, Train loss: 0.732, Test loss: 0.885, Test accuracy: 68.01
Round  43, Global train loss: 0.732, Global test loss: 1.294, Global test accuracy: 55.10
Round  44, Train loss: 0.676, Test loss: 0.899, Test accuracy: 67.90
Round  44, Global train loss: 0.676, Global test loss: 1.150, Global test accuracy: 60.32
Round  45, Train loss: 0.630, Test loss: 0.885, Test accuracy: 68.32
Round  45, Global train loss: 0.630, Global test loss: 1.255, Global test accuracy: 58.28
Round  46, Train loss: 0.680, Test loss: 0.889, Test accuracy: 68.49
Round  46, Global train loss: 0.680, Global test loss: 1.197, Global test accuracy: 59.27
Round  47, Train loss: 0.652, Test loss: 0.880, Test accuracy: 69.18
Round  47, Global train loss: 0.652, Global test loss: 1.230, Global test accuracy: 57.87
Round  48, Train loss: 0.632, Test loss: 0.887, Test accuracy: 69.18
Round  48, Global train loss: 0.632, Global test loss: 1.306, Global test accuracy: 56.84
Round  49, Train loss: 0.667, Test loss: 0.871, Test accuracy: 69.66
Round  49, Global train loss: 0.667, Global test loss: 1.413, Global test accuracy: 53.38
Round  50, Train loss: 0.578, Test loss: 0.878, Test accuracy: 69.51
Round  50, Global train loss: 0.578, Global test loss: 1.256, Global test accuracy: 58.49
Round  51, Train loss: 0.602, Test loss: 0.899, Test accuracy: 68.69
Round  51, Global train loss: 0.602, Global test loss: 1.243, Global test accuracy: 57.74
Round  52, Train loss: 0.599, Test loss: 0.909, Test accuracy: 68.25
Round  52, Global train loss: 0.599, Global test loss: 1.224, Global test accuracy: 58.41
Round  53, Train loss: 0.651, Test loss: 0.906, Test accuracy: 68.53
Round  53, Global train loss: 0.651, Global test loss: 1.241, Global test accuracy: 56.34
Round  54, Train loss: 0.568, Test loss: 0.914, Test accuracy: 68.36
Round  54, Global train loss: 0.568, Global test loss: 1.181, Global test accuracy: 59.55
Round  55, Train loss: 0.645, Test loss: 0.895, Test accuracy: 69.10
Round  55, Global train loss: 0.645, Global test loss: 1.216, Global test accuracy: 58.65
Round  56, Train loss: 0.604, Test loss: 0.889, Test accuracy: 69.56
Round  56, Global train loss: 0.604, Global test loss: 1.179, Global test accuracy: 60.11
Round  57, Train loss: 0.606, Test loss: 0.905, Test accuracy: 69.50
Round  57, Global train loss: 0.606, Global test loss: 1.173, Global test accuracy: 59.74
Round  58, Train loss: 0.577, Test loss: 0.886, Test accuracy: 69.89
Round  58, Global train loss: 0.577, Global test loss: 1.247, Global test accuracy: 58.43
Round  59, Train loss: 0.546, Test loss: 0.884, Test accuracy: 70.44
Round  59, Global train loss: 0.546, Global test loss: 1.207, Global test accuracy: 59.94
Round  60, Train loss: 0.565, Test loss: 0.894, Test accuracy: 70.36
Round  60, Global train loss: 0.565, Global test loss: 1.278, Global test accuracy: 58.34
Round  61, Train loss: 0.510, Test loss: 0.885, Test accuracy: 70.72
Round  61, Global train loss: 0.510, Global test loss: 1.214, Global test accuracy: 60.38
Round  62, Train loss: 0.570, Test loss: 0.900, Test accuracy: 70.38
Round  62, Global train loss: 0.570, Global test loss: 1.287, Global test accuracy: 58.31
Round  63, Train loss: 0.560, Test loss: 0.902, Test accuracy: 70.35
Round  63, Global train loss: 0.560, Global test loss: 1.140, Global test accuracy: 62.33
Round  64, Train loss: 0.555, Test loss: 0.915, Test accuracy: 70.33
Round  64, Global train loss: 0.555, Global test loss: 1.362, Global test accuracy: 57.99
Round  65, Train loss: 0.488, Test loss: 0.950, Test accuracy: 69.33
Round  65, Global train loss: 0.488, Global test loss: 1.150, Global test accuracy: 62.42
Round  66, Train loss: 0.502, Test loss: 0.943, Test accuracy: 69.48
Round  66, Global train loss: 0.502, Global test loss: 1.249, Global test accuracy: 60.08
Round  67, Train loss: 0.506, Test loss: 0.955, Test accuracy: 69.32
Round  67, Global train loss: 0.506, Global test loss: 1.407, Global test accuracy: 57.82
Round  68, Train loss: 0.517, Test loss: 0.948, Test accuracy: 69.62
Round  68, Global train loss: 0.517, Global test loss: 1.348, Global test accuracy: 57.33
Round  69, Train loss: 0.552, Test loss: 0.929, Test accuracy: 69.78
Round  69, Global train loss: 0.552, Global test loss: 1.235, Global test accuracy: 59.92
Round  70, Train loss: 0.549, Test loss: 0.937, Test accuracy: 69.58
Round  70, Global train loss: 0.549, Global test loss: 1.252, Global test accuracy: 59.01
Round  71, Train loss: 0.502, Test loss: 0.945, Test accuracy: 69.37
Round  71, Global train loss: 0.502, Global test loss: 1.286, Global test accuracy: 58.82
Round  72, Train loss: 0.486, Test loss: 0.959, Test accuracy: 69.54
Round  72, Global train loss: 0.486, Global test loss: 1.290, Global test accuracy: 58.14
Round  73, Train loss: 0.534, Test loss: 0.948, Test accuracy: 69.54
Round  73, Global train loss: 0.534, Global test loss: 1.278, Global test accuracy: 59.15
Round  74, Train loss: 0.446, Test loss: 0.955, Test accuracy: 69.33
Round  74, Global train loss: 0.446, Global test loss: 1.200, Global test accuracy: 61.79
Round  75, Train loss: 0.515, Test loss: 0.939, Test accuracy: 69.53
Round  75, Global train loss: 0.515, Global test loss: 1.209, Global test accuracy: 60.58
Round  76, Train loss: 0.445, Test loss: 0.968, Test accuracy: 69.30
Round  76, Global train loss: 0.445, Global test loss: 1.280, Global test accuracy: 59.02
Round  77, Train loss: 0.421, Test loss: 0.945, Test accuracy: 69.95
Round  77, Global train loss: 0.421, Global test loss: 1.383, Global test accuracy: 58.99
Round  78, Train loss: 0.448, Test loss: 0.964, Test accuracy: 69.22
Round  78, Global train loss: 0.448, Global test loss: 1.197, Global test accuracy: 61.70
Round  79, Train loss: 0.415, Test loss: 0.969, Test accuracy: 69.51
Round  79, Global train loss: 0.415, Global test loss: 1.320, Global test accuracy: 61.38
Round  80, Train loss: 0.517, Test loss: 0.973, Test accuracy: 70.09
Round  80, Global train loss: 0.517, Global test loss: 1.249, Global test accuracy: 61.64
Round  81, Train loss: 0.480, Test loss: 0.964, Test accuracy: 70.54
Round  81, Global train loss: 0.480, Global test loss: 1.200, Global test accuracy: 61.14
Round  82, Train loss: 0.510, Test loss: 0.951, Test accuracy: 70.71
Round  82, Global train loss: 0.510, Global test loss: 1.316, Global test accuracy: 59.26
Round  83, Train loss: 0.443, Test loss: 0.980, Test accuracy: 70.66
Round  83, Global train loss: 0.443, Global test loss: 1.305, Global test accuracy: 60.40
Round  84, Train loss: 0.390, Test loss: 0.952, Test accuracy: 70.86
Round  84, Global train loss: 0.390, Global test loss: 1.280, Global test accuracy: 60.68
Round  85, Train loss: 0.404, Test loss: 0.968, Test accuracy: 70.40
Round  85, Global train loss: 0.404, Global test loss: 1.433, Global test accuracy: 57.14
Round  86, Train loss: 0.441, Test loss: 0.968, Test accuracy: 70.60
Round  86, Global train loss: 0.441, Global test loss: 1.405, Global test accuracy: 58.32
Round  87, Train loss: 0.347, Test loss: 0.981, Test accuracy: 70.46
Round  87, Global train loss: 0.347, Global test loss: 1.335, Global test accuracy: 60.47
Round  88, Train loss: 0.459, Test loss: 0.977, Test accuracy: 70.72
Round  88, Global train loss: 0.459, Global test loss: 1.407, Global test accuracy: 58.72
Round  89, Train loss: 0.376, Test loss: 0.963, Test accuracy: 71.44
Round  89, Global train loss: 0.376, Global test loss: 1.285, Global test accuracy: 60.88
Round  90, Train loss: 0.482, Test loss: 0.947, Test accuracy: 71.49
Round  90, Global train loss: 0.482, Global test loss: 1.255, Global test accuracy: 60.76
Round  91, Train loss: 0.380, Test loss: 0.955, Test accuracy: 71.12
Round  91, Global train loss: 0.380, Global test loss: 1.234, Global test accuracy: 62.05
Round  92, Train loss: 0.376, Test loss: 0.984, Test accuracy: 70.83
Round  92, Global train loss: 0.376, Global test loss: 1.348, Global test accuracy: 60.71
Round  93, Train loss: 0.441, Test loss: 0.985, Test accuracy: 71.22
Round  93, Global train loss: 0.441, Global test loss: 1.231, Global test accuracy: 61.68/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.460, Test loss: 1.006, Test accuracy: 70.68
Round  94, Global train loss: 0.460, Global test loss: 1.329, Global test accuracy: 59.13
Round  95, Train loss: 0.400, Test loss: 0.998, Test accuracy: 70.81
Round  95, Global train loss: 0.400, Global test loss: 1.246, Global test accuracy: 62.42
Round  96, Train loss: 0.388, Test loss: 0.988, Test accuracy: 70.74
Round  96, Global train loss: 0.388, Global test loss: 1.543, Global test accuracy: 57.54
Round  97, Train loss: 0.397, Test loss: 0.977, Test accuracy: 71.03
Round  97, Global train loss: 0.397, Global test loss: 1.233, Global test accuracy: 62.77
Round  98, Train loss: 0.479, Test loss: 0.994, Test accuracy: 70.77
Round  98, Global train loss: 0.479, Global test loss: 1.241, Global test accuracy: 61.20
Round  99, Train loss: 0.444, Test loss: 1.016, Test accuracy: 70.17
Round  99, Global train loss: 0.444, Global test loss: 1.238, Global test accuracy: 62.22
Final Round, Train loss: 0.330, Test loss: 1.062, Test accuracy: 71.14
Final Round, Global train loss: 0.330, Global test loss: 1.238, Global test accuracy: 62.22
Average accuracy final 10 rounds: 70.886 

Average global accuracy final 10 rounds: 61.047999999999995 

1313.388235092163
[1.4033033847808838, 2.8066067695617676, 3.940385341644287, 5.074163913726807, 6.258392095565796, 7.442620277404785, 8.630197286605835, 9.817774295806885, 10.945634603500366, 12.073494911193848, 13.195279598236084, 14.31706428527832, 15.443227529525757, 16.569390773773193, 17.766374111175537, 18.96335744857788, 20.163450002670288, 21.363542556762695, 22.56262516975403, 23.76170778274536, 24.955986499786377, 26.150265216827393, 27.345386028289795, 28.540506839752197, 29.737802743911743, 30.93509864807129, 32.144055128097534, 33.35301160812378, 34.562583923339844, 35.77215623855591, 36.97469139099121, 38.177226543426514, 39.38002610206604, 40.582825660705566, 41.65082931518555, 42.71883296966553, 43.749541997909546, 44.780251026153564, 45.81105017662048, 46.8418493270874, 47.8608512878418, 48.87985324859619, 49.90896201133728, 50.93807077407837, 51.95950388908386, 52.980937004089355, 54.00271701812744, 55.02449703216553, 56.044759035110474, 57.06502103805542, 58.096171140670776, 59.12732124328613, 60.14973282814026, 61.172144412994385, 62.19457936286926, 63.21701431274414, 64.2389440536499, 65.26087379455566, 66.28439211845398, 67.3079104423523, 68.33056402206421, 69.35321760177612, 70.37750244140625, 71.40178728103638, 72.42294311523438, 73.44409894943237, 74.46633815765381, 75.48857736587524, 76.51002955436707, 77.53148174285889, 78.55755662918091, 79.58363151550293, 80.60379600524902, 81.62396049499512, 82.64480543136597, 83.66565036773682, 84.68582534790039, 85.70600032806396, 86.73560619354248, 87.765212059021, 88.79677867889404, 89.82834529876709, 90.85413813591003, 91.87993097305298, 92.9018907546997, 93.92385053634644, 94.94387984275818, 95.96390914916992, 96.98670101165771, 98.00949287414551, 99.03064799308777, 100.05180311203003, 101.07953143119812, 102.10725975036621, 103.13085675239563, 104.15445375442505, 105.1840295791626, 106.21360540390015, 107.23721218109131, 108.26081895828247, 109.2816264629364, 110.30243396759033, 111.32238936424255, 112.34234476089478, 113.36310529708862, 114.38386583328247, 115.4148952960968, 116.44592475891113, 117.46345329284668, 118.48098182678223, 119.4994592666626, 120.51793670654297, 121.54307723045349, 122.56821775436401, 123.59322476387024, 124.61823177337646, 125.64074373245239, 126.66325569152832, 127.68585014343262, 128.7084445953369, 129.73109221458435, 130.7537398338318, 131.77895283699036, 132.80416584014893, 133.83411383628845, 134.86406183242798, 135.88477301597595, 136.90548419952393, 137.93016839027405, 138.95485258102417, 139.98579049110413, 141.01672840118408, 142.04039764404297, 143.06406688690186, 144.08833241462708, 145.1125979423523, 146.1369400024414, 147.16128206253052, 148.18607807159424, 149.21087408065796, 150.24402689933777, 151.27717971801758, 152.3258843421936, 153.37458896636963, 154.39533472061157, 155.41608047485352, 156.44091057777405, 157.46574068069458, 158.4899423122406, 159.51414394378662, 160.53936338424683, 161.56458282470703, 162.58969402313232, 163.61480522155762, 164.63944578170776, 165.6640863418579, 166.68411684036255, 167.7041473388672, 168.72464632987976, 169.74514532089233, 170.7667224407196, 171.78829956054688, 172.80937218666077, 173.83044481277466, 174.8527591228485, 175.87507343292236, 176.90134716033936, 177.92762088775635, 178.94919323921204, 179.97076559066772, 180.99068021774292, 182.01059484481812, 183.04151129722595, 184.0724277496338, 185.0933976173401, 186.1143674850464, 187.16654348373413, 188.21871948242188, 189.48164653778076, 190.74457359313965, 191.92060685157776, 193.09664011001587, 194.261488199234, 195.42633628845215, 196.59671068191528, 197.76708507537842, 198.9335343837738, 200.0999836921692, 201.32734513282776, 202.55470657348633, 203.7762131690979, 204.99771976470947, 206.18815517425537, 207.37859058380127, 208.49265575408936, 209.60672092437744, 210.81241297721863, 212.01810503005981, 213.2816677093506, 214.54523038864136, 216.8854033946991, 219.22557640075684]
[27.42, 27.42, 32.78, 32.78, 37.37, 37.37, 42.06, 42.06, 46.5, 46.5, 49.39, 49.39, 52.77, 52.77, 53.86, 53.86, 53.94, 53.94, 55.44, 55.44, 57.96, 57.96, 57.85, 57.85, 59.59, 59.59, 61.13, 61.13, 60.79, 60.79, 60.38, 60.38, 61.09, 61.09, 60.73, 60.73, 61.29, 61.29, 62.07, 62.07, 63.04, 63.04, 62.87, 62.87, 63.62, 63.62, 63.2, 63.2, 64.38, 64.38, 64.57, 64.57, 65.25, 65.25, 66.12, 66.12, 65.59, 65.59, 66.42, 66.42, 66.75, 66.75, 67.24, 67.24, 66.99, 66.99, 67.07, 67.07, 67.29, 67.29, 67.1, 67.1, 68.09, 68.09, 67.22, 67.22, 68.01, 68.01, 68.88, 68.88, 68.74, 68.74, 67.89, 67.89, 68.69, 68.69, 68.01, 68.01, 67.9, 67.9, 68.32, 68.32, 68.49, 68.49, 69.18, 69.18, 69.18, 69.18, 69.66, 69.66, 69.51, 69.51, 68.69, 68.69, 68.25, 68.25, 68.53, 68.53, 68.36, 68.36, 69.1, 69.1, 69.56, 69.56, 69.5, 69.5, 69.89, 69.89, 70.44, 70.44, 70.36, 70.36, 70.72, 70.72, 70.38, 70.38, 70.35, 70.35, 70.33, 70.33, 69.33, 69.33, 69.48, 69.48, 69.32, 69.32, 69.62, 69.62, 69.78, 69.78, 69.58, 69.58, 69.37, 69.37, 69.54, 69.54, 69.54, 69.54, 69.33, 69.33, 69.53, 69.53, 69.3, 69.3, 69.95, 69.95, 69.22, 69.22, 69.51, 69.51, 70.09, 70.09, 70.54, 70.54, 70.71, 70.71, 70.66, 70.66, 70.86, 70.86, 70.4, 70.4, 70.6, 70.6, 70.46, 70.46, 70.72, 70.72, 71.44, 71.44, 71.49, 71.49, 71.12, 71.12, 70.83, 70.83, 71.22, 71.22, 70.68, 70.68, 70.81, 70.81, 70.74, 70.74, 71.03, 71.03, 70.77, 70.77, 70.17, 70.17, 71.14, 71.14]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.550, Test loss: 2.022, Test accuracy: 27.95
Round   0, Global train loss: 1.550, Global test loss: 2.228, Global test accuracy: 23.66
Round   1, Train loss: 1.469, Test loss: 1.720, Test accuracy: 32.35
Round   1, Global train loss: 1.469, Global test loss: 2.044, Global test accuracy: 22.84
Round   2, Train loss: 1.317, Test loss: 1.567, Test accuracy: 39.95
Round   2, Global train loss: 1.317, Global test loss: 1.917, Global test accuracy: 31.52
Round   3, Train loss: 1.173, Test loss: 1.486, Test accuracy: 44.36
Round   3, Global train loss: 1.173, Global test loss: 2.126, Global test accuracy: 29.90
Round   4, Train loss: 1.190, Test loss: 1.321, Test accuracy: 47.73
Round   4, Global train loss: 1.190, Global test loss: 1.952, Global test accuracy: 27.99
Round   5, Train loss: 1.167, Test loss: 1.270, Test accuracy: 51.01
Round   5, Global train loss: 1.167, Global test loss: 1.907, Global test accuracy: 33.90
Round   6, Train loss: 1.076, Test loss: 1.197, Test accuracy: 53.63
Round   6, Global train loss: 1.076, Global test loss: 1.623, Global test accuracy: 42.31
Round   7, Train loss: 1.069, Test loss: 1.178, Test accuracy: 54.61
Round   7, Global train loss: 1.069, Global test loss: 1.716, Global test accuracy: 38.16
Round   8, Train loss: 1.093, Test loss: 1.193, Test accuracy: 53.93
Round   8, Global train loss: 1.093, Global test loss: 1.824, Global test accuracy: 34.27
Round   9, Train loss: 1.007, Test loss: 1.157, Test accuracy: 56.43
Round   9, Global train loss: 1.007, Global test loss: 1.659, Global test accuracy: 42.10
Round  10, Train loss: 0.994, Test loss: 1.113, Test accuracy: 57.88
Round  10, Global train loss: 0.994, Global test loss: 1.599, Global test accuracy: 44.77
Round  11, Train loss: 1.036, Test loss: 1.118, Test accuracy: 57.29
Round  11, Global train loss: 1.036, Global test loss: 1.537, Global test accuracy: 45.06
Round  12, Train loss: 1.045, Test loss: 1.097, Test accuracy: 59.15
Round  12, Global train loss: 1.045, Global test loss: 1.582, Global test accuracy: 45.60
Round  13, Train loss: 0.929, Test loss: 1.063, Test accuracy: 60.28
Round  13, Global train loss: 0.929, Global test loss: 1.592, Global test accuracy: 42.45
Round  14, Train loss: 0.872, Test loss: 1.040, Test accuracy: 60.88
Round  14, Global train loss: 0.872, Global test loss: 1.612, Global test accuracy: 43.99
Round  15, Train loss: 0.902, Test loss: 1.027, Test accuracy: 61.00
Round  15, Global train loss: 0.902, Global test loss: 1.864, Global test accuracy: 40.03
Round  16, Train loss: 0.833, Test loss: 1.015, Test accuracy: 61.77
Round  16, Global train loss: 0.833, Global test loss: 1.477, Global test accuracy: 47.86
Round  17, Train loss: 0.863, Test loss: 1.016, Test accuracy: 61.97
Round  17, Global train loss: 0.863, Global test loss: 1.557, Global test accuracy: 47.04
Round  18, Train loss: 0.940, Test loss: 1.011, Test accuracy: 62.22
Round  18, Global train loss: 0.940, Global test loss: 1.486, Global test accuracy: 47.61
Round  19, Train loss: 0.839, Test loss: 1.018, Test accuracy: 62.82
Round  19, Global train loss: 0.839, Global test loss: 1.507, Global test accuracy: 46.42
Round  20, Train loss: 0.878, Test loss: 0.993, Test accuracy: 63.43
Round  20, Global train loss: 0.878, Global test loss: 1.352, Global test accuracy: 53.23
Round  21, Train loss: 0.836, Test loss: 0.977, Test accuracy: 64.17
Round  21, Global train loss: 0.836, Global test loss: 1.603, Global test accuracy: 47.85
Round  22, Train loss: 0.753, Test loss: 0.962, Test accuracy: 64.70
Round  22, Global train loss: 0.753, Global test loss: 1.541, Global test accuracy: 49.66
Round  23, Train loss: 0.875, Test loss: 0.948, Test accuracy: 65.26
Round  23, Global train loss: 0.875, Global test loss: 1.371, Global test accuracy: 52.92
Round  24, Train loss: 0.773, Test loss: 0.943, Test accuracy: 65.37
Round  24, Global train loss: 0.773, Global test loss: 1.408, Global test accuracy: 52.12
Round  25, Train loss: 0.732, Test loss: 0.958, Test accuracy: 65.13
Round  25, Global train loss: 0.732, Global test loss: 1.282, Global test accuracy: 57.49
Round  26, Train loss: 0.808, Test loss: 0.937, Test accuracy: 65.79
Round  26, Global train loss: 0.808, Global test loss: 1.358, Global test accuracy: 54.10
Round  27, Train loss: 0.785, Test loss: 0.940, Test accuracy: 65.87
Round  27, Global train loss: 0.785, Global test loss: 1.287, Global test accuracy: 55.77
Round  28, Train loss: 0.701, Test loss: 0.923, Test accuracy: 66.75
Round  28, Global train loss: 0.701, Global test loss: 1.470, Global test accuracy: 50.06
Round  29, Train loss: 0.771, Test loss: 0.923, Test accuracy: 67.13
Round  29, Global train loss: 0.771, Global test loss: 1.261, Global test accuracy: 56.92
Round  30, Train loss: 0.717, Test loss: 0.906, Test accuracy: 67.58
Round  30, Global train loss: 0.717, Global test loss: 1.464, Global test accuracy: 50.32
Round  31, Train loss: 0.676, Test loss: 0.910, Test accuracy: 67.43
Round  31, Global train loss: 0.676, Global test loss: 1.385, Global test accuracy: 54.62
Round  32, Train loss: 0.723, Test loss: 0.943, Test accuracy: 67.08
Round  32, Global train loss: 0.723, Global test loss: 1.419, Global test accuracy: 52.97
Round  33, Train loss: 0.682, Test loss: 0.945, Test accuracy: 66.83
Round  33, Global train loss: 0.682, Global test loss: 1.229, Global test accuracy: 57.89
Round  34, Train loss: 0.604, Test loss: 0.938, Test accuracy: 67.14
Round  34, Global train loss: 0.604, Global test loss: 1.361, Global test accuracy: 55.80
Round  35, Train loss: 0.664, Test loss: 0.942, Test accuracy: 67.37
Round  35, Global train loss: 0.664, Global test loss: 1.240, Global test accuracy: 57.27
Round  36, Train loss: 0.598, Test loss: 0.956, Test accuracy: 67.04
Round  36, Global train loss: 0.598, Global test loss: 1.197, Global test accuracy: 59.25
Round  37, Train loss: 0.654, Test loss: 0.940, Test accuracy: 67.59
Round  37, Global train loss: 0.654, Global test loss: 1.231, Global test accuracy: 57.03
Round  38, Train loss: 0.612, Test loss: 0.941, Test accuracy: 68.07
Round  38, Global train loss: 0.612, Global test loss: 1.257, Global test accuracy: 57.88
Round  39, Train loss: 0.588, Test loss: 0.951, Test accuracy: 67.63
Round  39, Global train loss: 0.588, Global test loss: 1.230, Global test accuracy: 58.62
Round  40, Train loss: 0.666, Test loss: 0.928, Test accuracy: 68.27
Round  40, Global train loss: 0.666, Global test loss: 1.233, Global test accuracy: 58.36
Round  41, Train loss: 0.553, Test loss: 0.946, Test accuracy: 68.25
Round  41, Global train loss: 0.553, Global test loss: 1.313, Global test accuracy: 57.11
Round  42, Train loss: 0.608, Test loss: 0.949, Test accuracy: 68.31
Round  42, Global train loss: 0.608, Global test loss: 1.256, Global test accuracy: 57.41
Round  43, Train loss: 0.629, Test loss: 0.938, Test accuracy: 68.52
Round  43, Global train loss: 0.629, Global test loss: 1.320, Global test accuracy: 53.86
Round  44, Train loss: 0.638, Test loss: 0.925, Test accuracy: 68.96
Round  44, Global train loss: 0.638, Global test loss: 1.138, Global test accuracy: 61.06
Round  45, Train loss: 0.541, Test loss: 0.915, Test accuracy: 69.41
Round  45, Global train loss: 0.541, Global test loss: 1.276, Global test accuracy: 58.34
Round  46, Train loss: 0.532, Test loss: 0.930, Test accuracy: 69.10
Round  46, Global train loss: 0.532, Global test loss: 1.242, Global test accuracy: 59.09
Round  47, Train loss: 0.648, Test loss: 0.941, Test accuracy: 69.26
Round  47, Global train loss: 0.648, Global test loss: 1.221, Global test accuracy: 58.49
Round  48, Train loss: 0.659, Test loss: 0.924, Test accuracy: 69.53
Round  48, Global train loss: 0.659, Global test loss: 1.516, Global test accuracy: 52.28
Round  49, Train loss: 0.566, Test loss: 0.950, Test accuracy: 68.94
Round  49, Global train loss: 0.566, Global test loss: 1.550, Global test accuracy: 51.79
Round  50, Train loss: 0.498, Test loss: 0.942, Test accuracy: 69.11
Round  50, Global train loss: 0.498, Global test loss: 1.382, Global test accuracy: 57.56
Round  51, Train loss: 0.562, Test loss: 0.951, Test accuracy: 68.88
Round  51, Global train loss: 0.562, Global test loss: 1.332, Global test accuracy: 56.31
Round  52, Train loss: 0.584, Test loss: 0.955, Test accuracy: 68.71
Round  52, Global train loss: 0.584, Global test loss: 1.299, Global test accuracy: 56.82
Round  53, Train loss: 0.505, Test loss: 0.953, Test accuracy: 68.79
Round  53, Global train loss: 0.505, Global test loss: 1.248, Global test accuracy: 58.09
Round  54, Train loss: 0.518, Test loss: 0.941, Test accuracy: 69.05
Round  54, Global train loss: 0.518, Global test loss: 1.191, Global test accuracy: 60.64
Round  55, Train loss: 0.553, Test loss: 0.935, Test accuracy: 69.51
Round  55, Global train loss: 0.553, Global test loss: 1.216, Global test accuracy: 59.49
Round  56, Train loss: 0.552, Test loss: 0.949, Test accuracy: 69.66
Round  56, Global train loss: 0.552, Global test loss: 1.213, Global test accuracy: 60.06
Round  57, Train loss: 0.460, Test loss: 0.934, Test accuracy: 70.19
Round  57, Global train loss: 0.460, Global test loss: 1.220, Global test accuracy: 60.08
Round  58, Train loss: 0.496, Test loss: 0.927, Test accuracy: 70.40
Round  58, Global train loss: 0.496, Global test loss: 1.283, Global test accuracy: 57.55
Round  59, Train loss: 0.475, Test loss: 0.929, Test accuracy: 70.46
Round  59, Global train loss: 0.475, Global test loss: 1.237, Global test accuracy: 59.28
Round  60, Train loss: 0.434, Test loss: 0.952, Test accuracy: 70.09
Round  60, Global train loss: 0.434, Global test loss: 1.331, Global test accuracy: 58.61
Round  61, Train loss: 0.399, Test loss: 0.936, Test accuracy: 70.25
Round  61, Global train loss: 0.399, Global test loss: 1.276, Global test accuracy: 60.70
Round  62, Train loss: 0.402, Test loss: 0.944, Test accuracy: 70.39
Round  62, Global train loss: 0.402, Global test loss: 1.365, Global test accuracy: 58.82
Round  63, Train loss: 0.446, Test loss: 0.956, Test accuracy: 70.11
Round  63, Global train loss: 0.446, Global test loss: 1.146, Global test accuracy: 63.18
Round  64, Train loss: 0.489, Test loss: 0.958, Test accuracy: 70.07
Round  64, Global train loss: 0.489, Global test loss: 1.342, Global test accuracy: 58.28
Round  65, Train loss: 0.433, Test loss: 0.937, Test accuracy: 70.43
Round  65, Global train loss: 0.433, Global test loss: 1.158, Global test accuracy: 62.77
Round  66, Train loss: 0.425, Test loss: 0.942, Test accuracy: 70.67
Round  66, Global train loss: 0.425, Global test loss: 1.358, Global test accuracy: 58.69
Round  67, Train loss: 0.507, Test loss: 0.963, Test accuracy: 70.17
Round  67, Global train loss: 0.507, Global test loss: 1.456, Global test accuracy: 57.52
Round  68, Train loss: 0.452, Test loss: 0.956, Test accuracy: 70.10
Round  68, Global train loss: 0.452, Global test loss: 1.460, Global test accuracy: 56.17
Round  69, Train loss: 0.556, Test loss: 0.949, Test accuracy: 70.31
Round  69, Global train loss: 0.556, Global test loss: 1.294, Global test accuracy: 58.85
Round  70, Train loss: 0.432, Test loss: 0.935, Test accuracy: 70.85
Round  70, Global train loss: 0.432, Global test loss: 1.312, Global test accuracy: 57.03
Round  71, Train loss: 0.425, Test loss: 0.943, Test accuracy: 70.90
Round  71, Global train loss: 0.425, Global test loss: 1.381, Global test accuracy: 57.94
Round  72, Train loss: 0.378, Test loss: 0.951, Test accuracy: 70.52
Round  72, Global train loss: 0.378, Global test loss: 1.268, Global test accuracy: 60.09
Round  73, Train loss: 0.446, Test loss: 0.966, Test accuracy: 70.19
Round  73, Global train loss: 0.446, Global test loss: 1.399, Global test accuracy: 57.60
Round  74, Train loss: 0.387, Test loss: 0.975, Test accuracy: 70.62
Round  74, Global train loss: 0.387, Global test loss: 1.206, Global test accuracy: 63.04
Round  75, Train loss: 0.442, Test loss: 1.001, Test accuracy: 70.23
Round  75, Global train loss: 0.442, Global test loss: 1.226, Global test accuracy: 61.27
Round  76, Train loss: 0.395, Test loss: 0.986, Test accuracy: 70.70
Round  76, Global train loss: 0.395, Global test loss: 1.222, Global test accuracy: 61.61
Round  77, Train loss: 0.329, Test loss: 0.993, Test accuracy: 70.73
Round  77, Global train loss: 0.329, Global test loss: 1.487, Global test accuracy: 59.38
Round  78, Train loss: 0.371, Test loss: 1.009, Test accuracy: 70.19
Round  78, Global train loss: 0.371, Global test loss: 1.283, Global test accuracy: 61.77
Round  79, Train loss: 0.493, Test loss: 0.976, Test accuracy: 70.68
Round  79, Global train loss: 0.493, Global test loss: 1.306, Global test accuracy: 60.75
Round  80, Train loss: 0.473, Test loss: 0.979, Test accuracy: 70.96
Round  80, Global train loss: 0.473, Global test loss: 1.346, Global test accuracy: 60.29
Round  81, Train loss: 0.407, Test loss: 0.987, Test accuracy: 71.03
Round  81, Global train loss: 0.407, Global test loss: 1.240, Global test accuracy: 60.51
Round  82, Train loss: 0.392, Test loss: 0.983, Test accuracy: 71.09
Round  82, Global train loss: 0.392, Global test loss: 1.297, Global test accuracy: 61.05
Round  83, Train loss: 0.400, Test loss: 1.005, Test accuracy: 70.89
Round  83, Global train loss: 0.400, Global test loss: 1.435, Global test accuracy: 58.95
Round  84, Train loss: 0.333, Test loss: 1.036, Test accuracy: 70.85
Round  84, Global train loss: 0.333, Global test loss: 1.305, Global test accuracy: 61.45
Round  85, Train loss: 0.345, Test loss: 1.024, Test accuracy: 70.82
Round  85, Global train loss: 0.345, Global test loss: 1.355, Global test accuracy: 59.77
Round  86, Train loss: 0.424, Test loss: 1.019, Test accuracy: 70.94
Round  86, Global train loss: 0.424, Global test loss: 1.382, Global test accuracy: 58.94
Round  87, Train loss: 0.352, Test loss: 1.014, Test accuracy: 71.21
Round  87, Global train loss: 0.352, Global test loss: 1.358, Global test accuracy: 61.15
Round  88, Train loss: 0.381, Test loss: 1.028, Test accuracy: 70.86
Round  88, Global train loss: 0.381, Global test loss: 1.409, Global test accuracy: 59.56
Round  89, Train loss: 0.338, Test loss: 1.025, Test accuracy: 70.96
Round  89, Global train loss: 0.338, Global test loss: 1.369, Global test accuracy: 60.59
Round  90, Train loss: 0.415, Test loss: 1.044, Test accuracy: 71.04
Round  90, Global train loss: 0.415, Global test loss: 1.364, Global test accuracy: 58.27
Round  91, Train loss: 0.368, Test loss: 1.046, Test accuracy: 71.13
Round  91, Global train loss: 0.368, Global test loss: 1.316, Global test accuracy: 61.28
Round  92, Train loss: 0.356, Test loss: 1.061, Test accuracy: 70.42
Round  92, Global train loss: 0.356, Global test loss: 1.433, Global test accuracy: 59.34
Round  93, Train loss: 0.373, Test loss: 1.039, Test accuracy: 70.74
Round  93, Global train loss: 0.373, Global test loss: 1.232, Global test accuracy: 62.46
Round  94, Train loss: 0.333, Test loss: 1.046, Test accuracy: 70.52
Round  94, Global train loss: 0.333, Global test loss: 1.283, Global test accuracy: 61.49
Round  95, Train loss: 0.468, Test loss: 1.055, Test accuracy: 70.79
Round  95, Global train loss: 0.468, Global test loss: 1.281, Global test accuracy: 60.42
Round  96, Train loss: 0.301, Test loss: 1.038, Test accuracy: 71.47
Round  96, Global train loss: 0.301, Global test loss: 1.548, Global test accuracy: 58.55
Round  97, Train loss: 0.384, Test loss: 1.054, Test accuracy: 71.16
Round  97, Global train loss: 0.384, Global test loss: 1.238, Global test accuracy: 62.67
Round  98, Train loss: 0.465, Test loss: 1.055, Test accuracy: 71.40
Round  98, Global train loss: 0.465, Global test loss: 1.296, Global test accuracy: 60.82
Round  99, Train loss: 0.355, Test loss: 1.064, Test accuracy: 70.79
Round  99, Global train loss: 0.355, Global test loss: 1.182, Global test accuracy: 62.82
Final Round, Train loss: 0.285, Test loss: 1.176, Test accuracy: 70.93
Final Round, Global train loss: 0.285, Global test loss: 1.182, Global test accuracy: 62.82
Average accuracy final 10 rounds: 70.946
Average global accuracy final 10 rounds: 60.812
1895.9412281513214
[2.6173644065856934, 5.138729810714722, 7.575498819351196, 10.058327198028564, 12.562335729598999, 14.963224649429321, 17.46369457244873, 19.896966457366943, 22.385441064834595, 24.80594491958618, 27.28979516029358, 29.754446744918823, 32.242026805877686, 34.70487833023071, 37.194135665893555, 39.69067621231079, 42.17869782447815, 44.69670820236206, 47.13410258293152, 49.65705609321594, 52.1865758895874, 54.691925048828125, 57.22328424453735, 59.689329862594604, 62.238831758499146, 64.6933171749115, 67.19325613975525, 69.63169598579407, 72.15347981452942, 74.66721034049988, 77.08692288398743, 79.53741335868835, 82.07052946090698, 84.62011504173279, 87.14454007148743, 89.67511987686157, 92.16328763961792, 94.68094778060913, 97.17365336418152, 99.69799709320068, 102.19435024261475, 104.68378186225891, 107.04959750175476, 109.39340806007385, 111.81235480308533, 114.20911192893982, 116.56528949737549, 118.9208915233612, 121.2525041103363, 123.60641694068909, 126.02298188209534, 128.37440991401672, 130.75739884376526, 133.1611840724945, 135.53408694267273, 137.9248435497284, 140.31189966201782, 142.63591074943542, 145.00925135612488, 147.36848497390747, 149.6831409931183, 152.0520474910736, 154.40032410621643, 156.69491529464722, 159.03837084770203, 161.3986804485321, 163.75272727012634, 166.1444730758667, 168.48276805877686, 170.81707882881165, 173.16482949256897, 175.51508045196533, 177.93642163276672, 180.32905173301697, 182.72121667861938, 185.00340390205383, 187.34292578697205, 189.71397304534912, 192.01097011566162, 194.415629863739, 196.7659764289856, 199.12184405326843, 201.46692299842834, 203.8087387084961, 206.17625832557678, 208.51829504966736, 210.84892439842224, 213.20624899864197, 215.55413389205933, 217.91935658454895, 220.25490617752075, 222.57037806510925, 224.95489048957825, 227.3032546043396, 229.61595249176025, 231.94839429855347, 234.3064670562744, 236.6477210521698, 238.9790976047516, 241.31915807724, 245.41509103775024]
[27.95, 32.35, 39.95, 44.36, 47.73, 51.01, 53.63, 54.61, 53.93, 56.43, 57.88, 57.29, 59.15, 60.28, 60.88, 61.0, 61.77, 61.97, 62.22, 62.82, 63.43, 64.17, 64.7, 65.26, 65.37, 65.13, 65.79, 65.87, 66.75, 67.13, 67.58, 67.43, 67.08, 66.83, 67.14, 67.37, 67.04, 67.59, 68.07, 67.63, 68.27, 68.25, 68.31, 68.52, 68.96, 69.41, 69.1, 69.26, 69.53, 68.94, 69.11, 68.88, 68.71, 68.79, 69.05, 69.51, 69.66, 70.19, 70.4, 70.46, 70.09, 70.25, 70.39, 70.11, 70.07, 70.43, 70.67, 70.17, 70.1, 70.31, 70.85, 70.9, 70.52, 70.19, 70.62, 70.23, 70.7, 70.73, 70.19, 70.68, 70.96, 71.03, 71.09, 70.89, 70.85, 70.82, 70.94, 71.21, 70.86, 70.96, 71.04, 71.13, 70.42, 70.74, 70.52, 70.79, 71.47, 71.16, 71.4, 70.79, 70.93]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  10.0000
Round 1 global test acc  26.0000
Round 2 global test acc  23.6500
Round 3 global test acc  32.5600
Round 4 global test acc  26.6600
Round 5 global test acc  29.9400
Round 6 global test acc  31.6800
Round 7 global test acc  27.6300
Round 8 global test acc  32.8300
Round 9 global test acc  20.6600
Round 10 global test acc  32.9300
Round 11 global test acc  26.4700
Round 12 global test acc  33.2800
Round 13 global test acc  36.2600
Round 14 global test acc  28.4700
Round 15 global test acc  33.2200
Round 16 global test acc  34.2000
Round 17 global test acc  31.1500
Round 18 global test acc  32.1700
Round 19 global test acc  35.4400
Round 20 global test acc  36.8000
Round 21 global test acc  36.3800
Round 22 global test acc  33.5600
Round 23 global test acc  36.7100
Round 24 global test acc  34.2200
Round 25 global test acc  36.6500
Round 26 global test acc  38.1700
Round 27 global test acc  42.4400
Round 28 global test acc  36.1700
Round 29 global test acc  39.6500
Round 30 global test acc  33.4600
Round 31 global test acc  40.1400
Round 32 global test acc  37.8800
Round 33 global test acc  37.6700
Round 34 global test acc  39.9100
Round 35 global test acc  43.6300
Round 36 global test acc  35.8300
Round 37 global test acc  35.4200
Round 38 global test acc  38.8100
Round 39 global test acc  42.9100
Round 40 global test acc  38.2800
Round 41 global test acc  35.8600
Round 42 global test acc  38.3100
Round 43 global test acc  42.1200
Round 44 global test acc  40.0000
Round 45 global test acc  36.6300
Round 46 global test acc  36.7500
Round 47 global test acc  33.9400
Round 48 global test acc  34.1600
Round 49 global test acc  41.9600
Round 50 global test acc  43.4500
Round 51 global test acc  46.1300
Round 52 global test acc  36.8100
Round 53 global test acc  39.9000
Round 54 global test acc  39.0000
Round 55 global test acc  42.6600
Round 56 global test acc  38.9700
Round 57 global test acc  50.9400
Round 58 global test acc  36.4600
Round 59 global test acc  43.8400
Round 60 global test acc  42.3000
Round 61 global test acc  47.6900
Round 62 global test acc  44.3300
Round 63 global test acc  42.3600
Round 64 global test acc  40.8400
Round 65 global test acc  39.0000
Round 66 global test acc  36.0900
Round 67 global test acc  45.4400
Round 68 global test acc  37.6800
Round 69 global test acc  41.7300
Round 70 global test acc  39.8800
Round 71 global test acc  40.9400
Round 72 global test acc  44.5500
Round 73 global test acc  43.1500
Round 74 global test acc  39.6200
Round 75 global test acc  39.1500
Round 76 global test acc  38.8900
Round 77 global test acc  49.7300
Round 78 global test acc  45.0200
Round 79 global test acc  45.6800
Round 80 global test acc  42.2500
Round 81 global test acc  40.5500
Round 82 global test acc  40.1900
Round 83 global test acc  38.9900
Round 84 global test acc  35.9400
Round 85 global test acc  34.6900
Round 86 global test acc  31.5800
Round 87 global test acc  31.3000
Round 88 global test acc  30.7600
Round 89 global test acc  29.5200
Round 90 global test acc  27.7300
Round 91 global test acc  27.5100
Round 92 global test acc  24.3800
Round 93 global test acc  23.7800
Round 94 global test acc  23.2400
Round 95 global test acc  23.3400
Round 96 global test acc  22.6700
Round 97 global test acc  22.0200
Round 98 global test acc  21.5300
Round 99 global test acc  21.3700
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.965, Test loss: 2.114, Test accuracy: 25.41
Round   1, Train loss: 1.593, Test loss: 1.872, Test accuracy: 31.37
Round   2, Train loss: 1.354, Test loss: 1.719, Test accuracy: 38.57
Round   3, Train loss: 1.266, Test loss: 1.533, Test accuracy: 42.47
Round   4, Train loss: 1.268, Test loss: 1.308, Test accuracy: 47.97
Round   5, Train loss: 1.208, Test loss: 1.204, Test accuracy: 52.93
Round   6, Train loss: 1.162, Test loss: 1.108, Test accuracy: 56.08
Round   7, Train loss: 1.083, Test loss: 1.088, Test accuracy: 56.79
Round   8, Train loss: 1.174, Test loss: 1.094, Test accuracy: 56.53
Round   9, Train loss: 1.067, Test loss: 1.081, Test accuracy: 58.88
Round  10, Train loss: 1.000, Test loss: 0.992, Test accuracy: 60.91
Round  11, Train loss: 1.060, Test loss: 1.035, Test accuracy: 59.57
Round  12, Train loss: 1.004, Test loss: 1.002, Test accuracy: 60.84
Round  13, Train loss: 1.008, Test loss: 0.940, Test accuracy: 63.20
Round  14, Train loss: 0.942, Test loss: 0.935, Test accuracy: 63.80
Round  15, Train loss: 0.899, Test loss: 0.914, Test accuracy: 63.47
Round  16, Train loss: 0.929, Test loss: 0.909, Test accuracy: 63.80
Round  17, Train loss: 0.838, Test loss: 0.878, Test accuracy: 65.38
Round  18, Train loss: 0.908, Test loss: 0.869, Test accuracy: 66.14
Round  19, Train loss: 0.871, Test loss: 0.850, Test accuracy: 66.72
Round  20, Train loss: 0.886, Test loss: 0.852, Test accuracy: 66.94
Round  21, Train loss: 0.772, Test loss: 0.827, Test accuracy: 67.57
Round  22, Train loss: 0.818, Test loss: 0.820, Test accuracy: 67.97
Round  23, Train loss: 0.789, Test loss: 0.807, Test accuracy: 68.84
Round  24, Train loss: 0.810, Test loss: 0.801, Test accuracy: 69.10
Round  25, Train loss: 0.816, Test loss: 0.796, Test accuracy: 69.37
Round  26, Train loss: 0.758, Test loss: 0.795, Test accuracy: 69.30
Round  27, Train loss: 0.835, Test loss: 0.784, Test accuracy: 69.74
Round  28, Train loss: 0.760, Test loss: 0.785, Test accuracy: 69.82
Round  29, Train loss: 0.756, Test loss: 0.770, Test accuracy: 70.16
Round  30, Train loss: 0.771, Test loss: 0.767, Test accuracy: 70.15
Round  31, Train loss: 0.751, Test loss: 0.758, Test accuracy: 70.41
Round  32, Train loss: 0.773, Test loss: 0.746, Test accuracy: 71.26
Round  33, Train loss: 0.806, Test loss: 0.740, Test accuracy: 71.59
Round  34, Train loss: 0.633, Test loss: 0.742, Test accuracy: 71.13
Round  35, Train loss: 0.712, Test loss: 0.728, Test accuracy: 72.50
Round  36, Train loss: 0.696, Test loss: 0.723, Test accuracy: 72.51
Round  37, Train loss: 0.800, Test loss: 0.729, Test accuracy: 72.24
Round  38, Train loss: 0.721, Test loss: 0.712, Test accuracy: 72.96
Round  39, Train loss: 0.692, Test loss: 0.716, Test accuracy: 72.89
Round  40, Train loss: 0.646, Test loss: 0.720, Test accuracy: 72.68
Round  41, Train loss: 0.587, Test loss: 0.720, Test accuracy: 72.70
Round  42, Train loss: 0.665, Test loss: 0.703, Test accuracy: 73.50
Round  43, Train loss: 0.682, Test loss: 0.701, Test accuracy: 73.71
Round  44, Train loss: 0.668, Test loss: 0.689, Test accuracy: 73.99
Round  45, Train loss: 0.579, Test loss: 0.693, Test accuracy: 73.56
Round  46, Train loss: 0.582, Test loss: 0.697, Test accuracy: 73.89
Round  47, Train loss: 0.688, Test loss: 0.679, Test accuracy: 74.25
Round  48, Train loss: 0.607, Test loss: 0.678, Test accuracy: 74.23
Round  49, Train loss: 0.661, Test loss: 0.670, Test accuracy: 74.45
Round  50, Train loss: 0.538, Test loss: 0.680, Test accuracy: 74.20
Round  51, Train loss: 0.570, Test loss: 0.679, Test accuracy: 74.29
Round  52, Train loss: 0.687, Test loss: 0.669, Test accuracy: 74.48
Round  53, Train loss: 0.615, Test loss: 0.673, Test accuracy: 74.94
Round  54, Train loss: 0.624, Test loss: 0.680, Test accuracy: 74.47
Round  55, Train loss: 0.642, Test loss: 0.668, Test accuracy: 74.71
Round  56, Train loss: 0.635, Test loss: 0.659, Test accuracy: 75.41
Round  57, Train loss: 0.563, Test loss: 0.658, Test accuracy: 75.11
Round  58, Train loss: 0.650, Test loss: 0.663, Test accuracy: 75.37
Round  59, Train loss: 0.618, Test loss: 0.650, Test accuracy: 76.04
Round  60, Train loss: 0.508, Test loss: 0.651, Test accuracy: 75.71
Round  61, Train loss: 0.444, Test loss: 0.650, Test accuracy: 75.76
Round  62, Train loss: 0.479, Test loss: 0.649, Test accuracy: 75.76
Round  63, Train loss: 0.605, Test loss: 0.648, Test accuracy: 75.64
Round  64, Train loss: 0.461, Test loss: 0.647, Test accuracy: 75.75
Round  65, Train loss: 0.470, Test loss: 0.645, Test accuracy: 75.88
Round  66, Train loss: 0.540, Test loss: 0.656, Test accuracy: 75.87
Round  67, Train loss: 0.469, Test loss: 0.641, Test accuracy: 76.20
Round  68, Train loss: 0.519, Test loss: 0.649, Test accuracy: 76.10
Round  69, Train loss: 0.484, Test loss: 0.637, Test accuracy: 76.42
Round  70, Train loss: 0.563, Test loss: 0.637, Test accuracy: 76.06
Round  71, Train loss: 0.473, Test loss: 0.644, Test accuracy: 76.05
Round  72, Train loss: 0.508, Test loss: 0.666, Test accuracy: 75.16
Round  73, Train loss: 0.549, Test loss: 0.648, Test accuracy: 76.14
Round  74, Train loss: 0.493, Test loss: 0.648, Test accuracy: 75.89
Round  75, Train loss: 0.483, Test loss: 0.653, Test accuracy: 75.76
Round  76, Train loss: 0.462, Test loss: 0.641, Test accuracy: 76.37
Round  77, Train loss: 0.379, Test loss: 0.634, Test accuracy: 76.59
Round  78, Train loss: 0.495, Test loss: 0.637, Test accuracy: 76.39
Round  79, Train loss: 0.454, Test loss: 0.639, Test accuracy: 76.44
Round  80, Train loss: 0.462, Test loss: 0.628, Test accuracy: 76.83
Round  81, Train loss: 0.551, Test loss: 0.621, Test accuracy: 77.05
Round  82, Train loss: 0.398, Test loss: 0.629, Test accuracy: 76.98
Round  83, Train loss: 0.463, Test loss: 0.631, Test accuracy: 76.42
Round  84, Train loss: 0.451, Test loss: 0.645, Test accuracy: 76.29
Round  85, Train loss: 0.379, Test loss: 0.644, Test accuracy: 76.54
Round  86, Train loss: 0.366, Test loss: 0.635, Test accuracy: 76.94
Round  87, Train loss: 0.396, Test loss: 0.641, Test accuracy: 76.84
Round  88, Train loss: 0.380, Test loss: 0.647, Test accuracy: 76.44
Round  89, Train loss: 0.403, Test loss: 0.635, Test accuracy: 76.53
Round  90, Train loss: 0.527, Test loss: 0.644, Test accuracy: 76.65
Round  91, Train loss: 0.425, Test loss: 0.645, Test accuracy: 76.58
Round  92, Train loss: 0.411, Test loss: 0.634, Test accuracy: 76.91
Round  93, Train loss: 0.453, Test loss: 0.633, Test accuracy: 77.06
Round  94, Train loss: 0.429, Test loss: 0.635, Test accuracy: 76.77
Round  95, Train loss: 0.454, Test loss: 0.637, Test accuracy: 76.74
Round  96, Train loss: 0.358, Test loss: 0.642, Test accuracy: 76.56
Round  97, Train loss: 0.443, Test loss: 0.632, Test accuracy: 76.77
Round  98, Train loss: 0.435, Test loss: 0.639, Test accuracy: 76.72
Round  99, Train loss: 0.437, Test loss: 0.630, Test accuracy: 77.35
Final Round, Train loss: 0.348, Test loss: 0.634, Test accuracy: 77.55
Average accuracy final 10 rounds: 76.81099999999999
1024.0187456607819
[1.517090082168579, 2.841885805130005, 4.166158199310303, 5.488440275192261, 6.7625391483306885, 8.076764822006226, 9.412568807601929, 10.720735311508179, 12.042237043380737, 13.255724668502808, 14.50496506690979, 15.78748083114624, 17.000330209732056, 18.27842617034912, 19.58893895149231, 20.953423261642456, 22.267568588256836, 23.530407428741455, 24.873642921447754, 26.1745343208313, 27.5347957611084, 28.89878249168396, 30.216739416122437, 31.50333285331726, 32.84337115287781, 34.15141201019287, 35.46439599990845, 36.824650287628174, 38.1550567150116, 39.4682776927948, 40.75795602798462, 42.055166721343994, 43.39765739440918, 44.725863456726074, 46.058995962142944, 47.40106201171875, 48.76833128929138, 50.08700680732727, 51.44819521903992, 52.84064817428589, 54.18601727485657, 55.53996562957764, 56.88618230819702, 58.22213792800903, 59.55220293998718, 60.87233114242554, 62.187110900878906, 63.51048541069031, 64.80286073684692, 66.11595582962036, 67.45557570457458, 68.81213021278381, 70.16965055465698, 71.4854257106781, 72.85080528259277, 74.19485926628113, 75.49127864837646, 76.83700060844421, 78.26899814605713, 79.66803026199341, 81.09216928482056, 82.4383192062378, 83.81533718109131, 85.23594164848328, 86.63136720657349, 88.0300281047821, 89.45829367637634, 90.83219313621521, 92.26881194114685, 93.73437786102295, 95.15298056602478, 96.53004860877991, 97.96364188194275, 99.4199812412262, 100.82142996788025, 102.09642362594604, 103.48704695701599, 104.87341547012329, 106.28116750717163, 107.6851978302002, 109.10370802879333, 110.48193883895874, 111.86182880401611, 113.22081589698792, 114.59159207344055, 115.95920538902283, 117.30123472213745, 118.56570100784302, 119.88807225227356, 121.14983892440796, 122.47714114189148, 123.76647925376892, 125.02781963348389, 126.2998161315918, 127.56456327438354, 128.72829461097717, 129.88593816757202, 131.18099522590637, 132.53605103492737, 133.8868691921234, 135.95252180099487]
[25.41, 31.37, 38.57, 42.47, 47.97, 52.93, 56.08, 56.79, 56.53, 58.88, 60.91, 59.57, 60.84, 63.2, 63.8, 63.47, 63.8, 65.38, 66.14, 66.72, 66.94, 67.57, 67.97, 68.84, 69.1, 69.37, 69.3, 69.74, 69.82, 70.16, 70.15, 70.41, 71.26, 71.59, 71.13, 72.5, 72.51, 72.24, 72.96, 72.89, 72.68, 72.7, 73.5, 73.71, 73.99, 73.56, 73.89, 74.25, 74.23, 74.45, 74.2, 74.29, 74.48, 74.94, 74.47, 74.71, 75.41, 75.11, 75.37, 76.04, 75.71, 75.76, 75.76, 75.64, 75.75, 75.88, 75.87, 76.2, 76.1, 76.42, 76.06, 76.05, 75.16, 76.14, 75.89, 75.76, 76.37, 76.59, 76.39, 76.44, 76.83, 77.05, 76.98, 76.42, 76.29, 76.54, 76.94, 76.84, 76.44, 76.53, 76.65, 76.58, 76.91, 77.06, 76.77, 76.74, 76.56, 76.77, 76.72, 77.35, 77.55]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.590, Test loss: 1.937, Test accuracy: 27.26
Round   0, Global train loss: 1.590, Global test loss: 2.140, Global test accuracy: 22.74
Round   1, Train loss: 1.453, Test loss: 1.680, Test accuracy: 34.96
Round   1, Global train loss: 1.453, Global test loss: 2.019, Global test accuracy: 26.46
Round   2, Train loss: 1.322, Test loss: 1.555, Test accuracy: 39.52
Round   2, Global train loss: 1.322, Global test loss: 1.997, Global test accuracy: 26.97
Round   3, Train loss: 1.221, Test loss: 1.424, Test accuracy: 44.99
Round   3, Global train loss: 1.221, Global test loss: 2.013, Global test accuracy: 30.22
Round   4, Train loss: 1.221, Test loss: 1.270, Test accuracy: 48.42
Round   4, Global train loss: 1.221, Global test loss: 1.932, Global test accuracy: 29.41
Round   5, Train loss: 1.188, Test loss: 1.231, Test accuracy: 52.41
Round   5, Global train loss: 1.188, Global test loss: 1.819, Global test accuracy: 35.11
Round   6, Train loss: 1.160, Test loss: 1.177, Test accuracy: 54.15
Round   6, Global train loss: 1.160, Global test loss: 1.565, Global test accuracy: 44.57
Round   7, Train loss: 1.028, Test loss: 1.164, Test accuracy: 54.00
Round   7, Global train loss: 1.028, Global test loss: 1.782, Global test accuracy: 38.30
Round   8, Train loss: 1.188, Test loss: 1.162, Test accuracy: 54.93
Round   8, Global train loss: 1.188, Global test loss: 1.808, Global test accuracy: 35.71
Round   9, Train loss: 1.093, Test loss: 1.137, Test accuracy: 56.87
Round   9, Global train loss: 1.093, Global test loss: 1.641, Global test accuracy: 42.66
Round  10, Train loss: 1.028, Test loss: 1.084, Test accuracy: 58.84
Round  10, Global train loss: 1.028, Global test loss: 1.534, Global test accuracy: 46.01
Round  11, Train loss: 1.054, Test loss: 1.099, Test accuracy: 58.27
Round  11, Global train loss: 1.054, Global test loss: 1.513, Global test accuracy: 43.96
Round  12, Train loss: 1.047, Test loss: 1.059, Test accuracy: 60.09
Round  12, Global train loss: 1.047, Global test loss: 1.516, Global test accuracy: 44.93
Round  13, Train loss: 0.980, Test loss: 1.023, Test accuracy: 61.41
Round  13, Global train loss: 0.980, Global test loss: 1.507, Global test accuracy: 46.55
Round  14, Train loss: 0.960, Test loss: 1.021, Test accuracy: 61.39
Round  14, Global train loss: 0.960, Global test loss: 1.671, Global test accuracy: 44.95
Round  15, Train loss: 0.908, Test loss: 1.031, Test accuracy: 61.11
Round  15, Global train loss: 0.908, Global test loss: 1.982, Global test accuracy: 38.43
Round  16, Train loss: 0.896, Test loss: 1.009, Test accuracy: 61.77
Round  16, Global train loss: 0.896, Global test loss: 1.415, Global test accuracy: 50.99
Round  17, Train loss: 0.891, Test loss: 0.988, Test accuracy: 63.17
Round  17, Global train loss: 0.891, Global test loss: 1.560, Global test accuracy: 48.02
Round  18, Train loss: 0.934, Test loss: 0.983, Test accuracy: 63.37
Round  18, Global train loss: 0.934, Global test loss: 1.464, Global test accuracy: 49.35
Round  19, Train loss: 0.938, Test loss: 0.951, Test accuracy: 64.46
Round  19, Global train loss: 0.938, Global test loss: 1.438, Global test accuracy: 48.49
Round  20, Train loss: 0.895, Test loss: 0.948, Test accuracy: 64.47
Round  20, Global train loss: 0.895, Global test loss: 1.316, Global test accuracy: 55.07
Round  21, Train loss: 0.797, Test loss: 0.965, Test accuracy: 64.26
Round  21, Global train loss: 0.797, Global test loss: 1.837, Global test accuracy: 44.98
Round  22, Train loss: 0.853, Test loss: 0.954, Test accuracy: 65.00
Round  22, Global train loss: 0.853, Global test loss: 1.481, Global test accuracy: 51.36
Round  23, Train loss: 0.829, Test loss: 0.956, Test accuracy: 65.18
Round  23, Global train loss: 0.829, Global test loss: 1.341, Global test accuracy: 55.00
Round  24, Train loss: 0.758, Test loss: 0.955, Test accuracy: 65.33
Round  24, Global train loss: 0.758, Global test loss: 1.379, Global test accuracy: 54.52
Round  25, Train loss: 0.730, Test loss: 0.964, Test accuracy: 65.08
Round  25, Global train loss: 0.730, Global test loss: 1.345, Global test accuracy: 54.89
Round  26, Train loss: 0.740, Test loss: 0.932, Test accuracy: 66.02
Round  26, Global train loss: 0.740, Global test loss: 1.347, Global test accuracy: 55.06
Round  27, Train loss: 0.804, Test loss: 0.935, Test accuracy: 66.18
Round  27, Global train loss: 0.804, Global test loss: 1.229, Global test accuracy: 57.14
Round  28, Train loss: 0.695, Test loss: 0.946, Test accuracy: 66.15
Round  28, Global train loss: 0.695, Global test loss: 1.466, Global test accuracy: 50.04
Round  29, Train loss: 0.759, Test loss: 0.944, Test accuracy: 66.22
Round  29, Global train loss: 0.759, Global test loss: 1.164, Global test accuracy: 60.20
Round  30, Train loss: 0.843, Test loss: 0.939, Test accuracy: 66.49
Round  30, Global train loss: 0.843, Global test loss: 1.452, Global test accuracy: 51.92
Round  31, Train loss: 0.718, Test loss: 0.952, Test accuracy: 66.50
Round  31, Global train loss: 0.718, Global test loss: 1.342, Global test accuracy: 55.08
Round  32, Train loss: 0.846, Test loss: 0.961, Test accuracy: 66.23
Round  32, Global train loss: 0.846, Global test loss: 1.284, Global test accuracy: 57.10
Round  33, Train loss: 0.731, Test loss: 0.959, Test accuracy: 66.24
Round  33, Global train loss: 0.731, Global test loss: 1.263, Global test accuracy: 57.52
Round  34, Train loss: 0.601, Test loss: 0.947, Test accuracy: 67.00
Round  34, Global train loss: 0.601, Global test loss: 1.390, Global test accuracy: 56.09
Round  35, Train loss: 0.705, Test loss: 0.934, Test accuracy: 67.67
Round  35, Global train loss: 0.705, Global test loss: 1.231, Global test accuracy: 57.97
Round  36, Train loss: 0.597, Test loss: 0.943, Test accuracy: 67.25
Round  36, Global train loss: 0.597, Global test loss: 1.328, Global test accuracy: 57.30
Round  37, Train loss: 0.622, Test loss: 0.951, Test accuracy: 67.00
Round  37, Global train loss: 0.622, Global test loss: 1.264, Global test accuracy: 57.47
Round  38, Train loss: 0.672, Test loss: 0.955, Test accuracy: 67.43
Round  38, Global train loss: 0.672, Global test loss: 1.189, Global test accuracy: 59.32
Round  39, Train loss: 0.565, Test loss: 0.956, Test accuracy: 68.14
Round  39, Global train loss: 0.565, Global test loss: 1.273, Global test accuracy: 58.18
Round  40, Train loss: 0.613, Test loss: 0.955, Test accuracy: 67.82
Round  40, Global train loss: 0.613, Global test loss: 1.191, Global test accuracy: 59.78
Round  41, Train loss: 0.686, Test loss: 0.949, Test accuracy: 67.85
Round  41, Global train loss: 0.686, Global test loss: 1.278, Global test accuracy: 59.08
Round  42, Train loss: 0.706, Test loss: 0.937, Test accuracy: 67.98
Round  42, Global train loss: 0.706, Global test loss: 1.266, Global test accuracy: 58.17
Round  43, Train loss: 0.535, Test loss: 0.913, Test accuracy: 68.49
Round  43, Global train loss: 0.535, Global test loss: 1.242, Global test accuracy: 58.06
Round  44, Train loss: 0.585, Test loss: 0.916, Test accuracy: 68.76
Round  44, Global train loss: 0.585, Global test loss: 1.107, Global test accuracy: 62.41
Round  45, Train loss: 0.574, Test loss: 0.896, Test accuracy: 69.41
Round  45, Global train loss: 0.574, Global test loss: 1.229, Global test accuracy: 59.19
Round  46, Train loss: 0.587, Test loss: 0.925, Test accuracy: 68.71
Round  46, Global train loss: 0.587, Global test loss: 1.229, Global test accuracy: 59.89
Round  47, Train loss: 0.553, Test loss: 0.922, Test accuracy: 68.99
Round  47, Global train loss: 0.553, Global test loss: 1.288, Global test accuracy: 57.77
Round  48, Train loss: 0.672, Test loss: 0.923, Test accuracy: 69.05
Round  48, Global train loss: 0.672, Global test loss: 1.343, Global test accuracy: 56.56
Round  49, Train loss: 0.622, Test loss: 0.946, Test accuracy: 68.30
Round  49, Global train loss: 0.622, Global test loss: 1.396, Global test accuracy: 54.88
Round  50, Train loss: 0.533, Test loss: 0.936, Test accuracy: 68.77
Round  50, Global train loss: 0.533, Global test loss: 1.274, Global test accuracy: 58.59
Round  51, Train loss: 0.561, Test loss: 0.921, Test accuracy: 69.22
Round  51, Global train loss: 0.561, Global test loss: 1.266, Global test accuracy: 59.20
Round  52, Train loss: 0.587, Test loss: 0.926, Test accuracy: 69.48
Round  52, Global train loss: 0.587, Global test loss: 1.197, Global test accuracy: 60.54
Round  53, Train loss: 0.516, Test loss: 0.940, Test accuracy: 69.60
Round  53, Global train loss: 0.516, Global test loss: 1.213, Global test accuracy: 60.17
Round  54, Train loss: 0.519, Test loss: 0.933, Test accuracy: 69.89
Round  54, Global train loss: 0.519, Global test loss: 1.128, Global test accuracy: 62.51
Round  55, Train loss: 0.519, Test loss: 0.936, Test accuracy: 69.37
Round  55, Global train loss: 0.519, Global test loss: 1.186, Global test accuracy: 60.83
Round  56, Train loss: 0.504, Test loss: 0.940, Test accuracy: 69.54
Round  56, Global train loss: 0.504, Global test loss: 1.197, Global test accuracy: 60.73
Round  57, Train loss: 0.478, Test loss: 0.945, Test accuracy: 69.44
Round  57, Global train loss: 0.478, Global test loss: 1.141, Global test accuracy: 63.05
Round  58, Train loss: 0.573, Test loss: 0.956, Test accuracy: 69.31
Round  58, Global train loss: 0.573, Global test loss: 1.376, Global test accuracy: 55.41
Round  59, Train loss: 0.509, Test loss: 0.957, Test accuracy: 69.60
Round  59, Global train loss: 0.509, Global test loss: 1.242, Global test accuracy: 59.88
Round  60, Train loss: 0.536, Test loss: 0.966, Test accuracy: 69.60
Round  60, Global train loss: 0.536, Global test loss: 1.346, Global test accuracy: 59.02
Round  61, Train loss: 0.431, Test loss: 0.962, Test accuracy: 69.27
Round  61, Global train loss: 0.431, Global test loss: 1.279, Global test accuracy: 61.43
Round  62, Train loss: 0.440, Test loss: 0.980, Test accuracy: 69.49
Round  62, Global train loss: 0.440, Global test loss: 1.369, Global test accuracy: 59.69
Round  63, Train loss: 0.577, Test loss: 0.985, Test accuracy: 69.51
Round  63, Global train loss: 0.577, Global test loss: 1.209, Global test accuracy: 60.22
Round  64, Train loss: 0.521, Test loss: 1.002, Test accuracy: 69.39
Round  64, Global train loss: 0.521, Global test loss: 1.342, Global test accuracy: 59.14
Round  65, Train loss: 0.503, Test loss: 1.000, Test accuracy: 69.15
Round  65, Global train loss: 0.503, Global test loss: 1.219, Global test accuracy: 60.98
Round  66, Train loss: 0.487, Test loss: 0.987, Test accuracy: 69.68
Round  66, Global train loss: 0.487, Global test loss: 1.320, Global test accuracy: 59.23
Round  67, Train loss: 0.456, Test loss: 0.959, Test accuracy: 70.31
Round  67, Global train loss: 0.456, Global test loss: 1.447, Global test accuracy: 58.54
Round  68, Train loss: 0.455, Test loss: 0.978, Test accuracy: 69.86
Round  68, Global train loss: 0.455, Global test loss: 1.376, Global test accuracy: 58.78
Round  69, Train loss: 0.389, Test loss: 0.998, Test accuracy: 69.89
Round  69, Global train loss: 0.389, Global test loss: 1.300, Global test accuracy: 60.14
Round  70, Train loss: 0.525, Test loss: 1.020, Test accuracy: 69.62
Round  70, Global train loss: 0.525, Global test loss: 1.293, Global test accuracy: 58.84
Round  71, Train loss: 0.428, Test loss: 1.014, Test accuracy: 69.83
Round  71, Global train loss: 0.428, Global test loss: 1.365, Global test accuracy: 59.59
Round  72, Train loss: 0.392, Test loss: 1.038, Test accuracy: 69.23
Round  72, Global train loss: 0.392, Global test loss: 1.307, Global test accuracy: 60.74
Round  73, Train loss: 0.442, Test loss: 1.062, Test accuracy: 69.11
Round  73, Global train loss: 0.442, Global test loss: 1.525, Global test accuracy: 56.31
Round  74, Train loss: 0.427, Test loss: 1.059, Test accuracy: 69.19
Round  74, Global train loss: 0.427, Global test loss: 1.217, Global test accuracy: 62.38
Round  75, Train loss: 0.375, Test loss: 1.044, Test accuracy: 69.46
Round  75, Global train loss: 0.375, Global test loss: 1.243, Global test accuracy: 61.91
Round  76, Train loss: 0.429, Test loss: 1.041, Test accuracy: 69.40
Round  76, Global train loss: 0.429, Global test loss: 1.323, Global test accuracy: 58.88
Round  77, Train loss: 0.371, Test loss: 1.043, Test accuracy: 69.62
Round  77, Global train loss: 0.371, Global test loss: 1.538, Global test accuracy: 58.21
Round  78, Train loss: 0.447, Test loss: 1.027, Test accuracy: 70.02
Round  78, Global train loss: 0.447, Global test loss: 1.417, Global test accuracy: 58.13
Round  79, Train loss: 0.359, Test loss: 1.033, Test accuracy: 70.29
Round  79, Global train loss: 0.359, Global test loss: 1.384, Global test accuracy: 60.78
Round  80, Train loss: 0.495, Test loss: 1.056, Test accuracy: 69.86
Round  80, Global train loss: 0.495, Global test loss: 1.355, Global test accuracy: 59.71
Round  81, Train loss: 0.433, Test loss: 1.036, Test accuracy: 69.97
Round  81, Global train loss: 0.433, Global test loss: 1.314, Global test accuracy: 59.87
Round  82, Train loss: 0.339, Test loss: 1.032, Test accuracy: 69.99
Round  82, Global train loss: 0.339, Global test loss: 1.332, Global test accuracy: 61.47
Round  83, Train loss: 0.377, Test loss: 1.049, Test accuracy: 69.80
Round  83, Global train loss: 0.377, Global test loss: 1.412, Global test accuracy: 60.17
Round  84, Train loss: 0.369, Test loss: 1.067, Test accuracy: 69.51
Round  84, Global train loss: 0.369, Global test loss: 1.309, Global test accuracy: 61.14
Round  85, Train loss: 0.353, Test loss: 1.093, Test accuracy: 69.20
Round  85, Global train loss: 0.353, Global test loss: 1.502, Global test accuracy: 58.32
Round  86, Train loss: 0.306, Test loss: 1.103, Test accuracy: 69.15
Round  86, Global train loss: 0.306, Global test loss: 1.360, Global test accuracy: 61.91
Round  87, Train loss: 0.327, Test loss: 1.099, Test accuracy: 69.08
Round  87, Global train loss: 0.327, Global test loss: 1.310, Global test accuracy: 62.70
Round  88, Train loss: 0.418, Test loss: 1.078, Test accuracy: 69.57
Round  88, Global train loss: 0.418, Global test loss: 1.427, Global test accuracy: 60.49
Round  89, Train loss: 0.409, Test loss: 1.068, Test accuracy: 69.85
Round  89, Global train loss: 0.409, Global test loss: 1.304, Global test accuracy: 61.55
Round  90, Train loss: 0.383, Test loss: 1.056, Test accuracy: 70.50
Round  90, Global train loss: 0.383, Global test loss: 1.256, Global test accuracy: 61.92
Round  91, Train loss: 0.323, Test loss: 1.068, Test accuracy: 70.58
Round  91, Global train loss: 0.323, Global test loss: 1.261, Global test accuracy: 62.64
Round  92, Train loss: 0.392, Test loss: 1.062, Test accuracy: 70.67
Round  92, Global train loss: 0.392, Global test loss: 1.321, Global test accuracy: 62.38
Round  93, Train loss: 0.414, Test loss: 1.089, Test accuracy: 70.39
Round  93, Global train loss: 0.414, Global test loss: 1.285, Global test accuracy: 62.40
Round  94, Train loss: 0.354, Test loss: 1.094, Test accuracy: 69.95
Round  94, Global train loss: 0.354, Global test loss: 1.393, Global test accuracy: 60.14
Round  95, Train loss: 0.334, Test loss: 1.100, Test accuracy: 70.09
Round  95, Global train loss: 0.334, Global test loss: 1.172, Global test accuracy: 65.16
Round  96, Train loss: 0.290, Test loss: 1.112, Test accuracy: 69.88
Round  96, Global train loss: 0.290, Global test loss: 1.543, Global test accuracy: 59.37
Round  97, Train loss: 0.474, Test loss: 1.089, Test accuracy: 70.68
Round  97, Global train loss: 0.474, Global test loss: 1.377, Global test accuracy: 60.12
Round  98, Train loss: 0.360, Test loss: 1.074, Test accuracy: 70.94
Round  98, Global train loss: 0.360, Global test loss: 1.353, Global test accuracy: 61.69
Round  99, Train loss: 0.384, Test loss: 1.113, Test accuracy: 70.70
Round  99, Global train loss: 0.384, Global test loss: 1.338, Global test accuracy: 61.76
Final Round, Train loss: 0.276, Test loss: 1.214, Test accuracy: 70.04
Final Round, Global train loss: 0.276, Global test loss: 1.338, Global test accuracy: 61.76
Average accuracy final 10 rounds: 70.43799999999999
Average global accuracy final 10 rounds: 61.757999999999996
1650.0523567199707
[1.390871524810791, 2.5622198581695557, 3.748900890350342, 4.939349174499512, 6.118452072143555, 7.338648319244385, 8.41566276550293, 9.575288534164429, 10.748037576675415, 11.89368486404419, 13.065203666687012, 14.184470891952515, 15.37070608139038, 16.543909072875977, 17.667542695999146, 18.78951621055603, 19.91952347755432, 21.046514987945557, 22.130224466323853, 23.314494609832764, 24.475388288497925, 26.864991188049316, 29.218710899353027, 31.5131413936615, 33.83858036994934, 36.13036751747131, 38.33392810821533, 40.53233861923218, 42.733638763427734, 44.90187096595764, 47.117029428482056, 49.33021664619446, 51.53265690803528, 53.73170518875122, 55.96110486984253, 58.163432598114014, 60.36673617362976, 62.58641529083252, 64.81070876121521, 67.0265543460846, 69.22150707244873, 71.42626094818115, 73.6159610748291, 75.80802011489868, 78.02288866043091, 80.22099256515503, 82.43052792549133, 84.5987298488617, 86.79687714576721, 89.03285384178162, 91.2924690246582, 93.55317616462708, 95.8337459564209, 98.14478206634521, 100.35469436645508, 102.64667129516602, 104.96194243431091, 107.24505090713501, 109.54082083702087, 111.84503674507141, 114.12950491905212, 116.39494919776917, 118.66549134254456, 120.92236137390137, 123.1656813621521, 125.3846960067749, 127.637366771698, 129.88181161880493, 132.12083220481873, 134.37842893600464, 136.6750705242157, 138.95847845077515, 141.22087717056274, 143.52284264564514, 145.7930507659912, 148.04534792900085, 150.2898805141449, 152.57332253456116, 154.81761741638184, 157.02306985855103, 159.2505853176117, 161.48680782318115, 163.95074200630188, 166.33844566345215, 168.8456130027771, 171.21408343315125, 173.70266938209534, 176.11286044120789, 178.506427526474, 180.97685718536377, 183.320969581604, 185.677063703537, 188.06130409240723, 190.53358793258667, 192.99764227867126, 195.45674324035645, 197.90609765052795, 200.34707617759705, 202.71914625167847, 205.25222396850586, 207.6072690486908]
[27.26, 34.96, 39.52, 44.99, 48.42, 52.41, 54.15, 54.0, 54.93, 56.87, 58.84, 58.27, 60.09, 61.41, 61.39, 61.11, 61.77, 63.17, 63.37, 64.46, 64.47, 64.26, 65.0, 65.18, 65.33, 65.08, 66.02, 66.18, 66.15, 66.22, 66.49, 66.5, 66.23, 66.24, 67.0, 67.67, 67.25, 67.0, 67.43, 68.14, 67.82, 67.85, 67.98, 68.49, 68.76, 69.41, 68.71, 68.99, 69.05, 68.3, 68.77, 69.22, 69.48, 69.6, 69.89, 69.37, 69.54, 69.44, 69.31, 69.6, 69.6, 69.27, 69.49, 69.51, 69.39, 69.15, 69.68, 70.31, 69.86, 69.89, 69.62, 69.83, 69.23, 69.11, 69.19, 69.46, 69.4, 69.62, 70.02, 70.29, 69.86, 69.97, 69.99, 69.8, 69.51, 69.2, 69.15, 69.08, 69.57, 69.85, 70.5, 70.58, 70.67, 70.39, 69.95, 70.09, 69.88, 70.68, 70.94, 70.7, 70.04]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.518, Test loss: 1.296, Test accuracy: 46.77
Round   0, Global train loss: 1.518, Global test loss: 2.107, Global test accuracy: 30.43
Round   1, Train loss: 1.309, Test loss: 1.171, Test accuracy: 54.49
Round   1, Global train loss: 1.309, Global test loss: 1.855, Global test accuracy: 36.01
Round   2, Train loss: 1.191, Test loss: 1.146, Test accuracy: 56.69
Round   2, Global train loss: 1.191, Global test loss: 1.705, Global test accuracy: 39.39
Round   3, Train loss: 1.118, Test loss: 1.089, Test accuracy: 58.74
Round   3, Global train loss: 1.118, Global test loss: 1.569, Global test accuracy: 43.67
Round   4, Train loss: 1.063, Test loss: 1.067, Test accuracy: 60.29
Round   4, Global train loss: 1.063, Global test loss: 1.491, Global test accuracy: 46.84
Round   5, Train loss: 1.013, Test loss: 1.053, Test accuracy: 61.30
Round   5, Global train loss: 1.013, Global test loss: 1.461, Global test accuracy: 48.25
Round   6, Train loss: 0.964, Test loss: 1.035, Test accuracy: 61.84
Round   6, Global train loss: 0.964, Global test loss: 1.384, Global test accuracy: 51.28
Round   7, Train loss: 0.923, Test loss: 1.030, Test accuracy: 62.23
Round   7, Global train loss: 0.923, Global test loss: 1.336, Global test accuracy: 53.01
Round   8, Train loss: 0.881, Test loss: 1.043, Test accuracy: 62.91
Round   8, Global train loss: 0.881, Global test loss: 1.306, Global test accuracy: 54.08
Round   9, Train loss: 0.842, Test loss: 1.066, Test accuracy: 62.32
Round   9, Global train loss: 0.842, Global test loss: 1.274, Global test accuracy: 54.80
Round  10, Train loss: 0.763, Test loss: 1.056, Test accuracy: 62.60
Round  10, Global train loss: 0.763, Global test loss: 1.499, Global test accuracy: 50.99
Round  11, Train loss: 0.942, Test loss: 1.057, Test accuracy: 62.90
Round  11, Global train loss: 0.942, Global test loss: 1.408, Global test accuracy: 51.28
Round  12, Train loss: 0.664, Test loss: 1.055, Test accuracy: 63.46
Round  12, Global train loss: 0.664, Global test loss: 1.388, Global test accuracy: 52.82
Round  13, Train loss: 0.778, Test loss: 1.070, Test accuracy: 63.88
Round  13, Global train loss: 0.778, Global test loss: 1.481, Global test accuracy: 50.26
Round  14, Train loss: 0.690, Test loss: 1.067, Test accuracy: 63.97
Round  14, Global train loss: 0.690, Global test loss: 1.545, Global test accuracy: 51.46
Round  15, Train loss: 0.606, Test loss: 1.062, Test accuracy: 63.87
Round  15, Global train loss: 0.606, Global test loss: 1.983, Global test accuracy: 46.18
Round  16, Train loss: 0.690, Test loss: 1.058, Test accuracy: 64.34
Round  16, Global train loss: 0.690, Global test loss: 1.317, Global test accuracy: 54.78
Round  17, Train loss: 0.573, Test loss: 1.081, Test accuracy: 64.48
Round  17, Global train loss: 0.573, Global test loss: 1.579, Global test accuracy: 51.83
Round  18, Train loss: 0.649, Test loss: 1.100, Test accuracy: 64.52
Round  18, Global train loss: 0.649, Global test loss: 1.663, Global test accuracy: 49.45
Round  19, Train loss: 0.661, Test loss: 1.110, Test accuracy: 65.16
Round  19, Global train loss: 0.661, Global test loss: 1.456, Global test accuracy: 53.67
Round  20, Train loss: 0.583, Test loss: 1.138, Test accuracy: 64.91
Round  20, Global train loss: 0.583, Global test loss: 1.389, Global test accuracy: 55.96
Round  21, Train loss: 0.524, Test loss: 1.141, Test accuracy: 65.35
Round  21, Global train loss: 0.524, Global test loss: 1.786, Global test accuracy: 49.82
Round  22, Train loss: 0.519, Test loss: 1.154, Test accuracy: 65.83
Round  22, Global train loss: 0.519, Global test loss: 1.755, Global test accuracy: 51.88
Round  23, Train loss: 0.532, Test loss: 1.159, Test accuracy: 65.87
Round  23, Global train loss: 0.532, Global test loss: 1.500, Global test accuracy: 54.62
Round  24, Train loss: 0.586, Test loss: 1.179, Test accuracy: 65.88
Round  24, Global train loss: 0.586, Global test loss: 1.504, Global test accuracy: 55.19
Round  25, Train loss: 0.577, Test loss: 1.242, Test accuracy: 65.15
Round  25, Global train loss: 0.577, Global test loss: 1.461, Global test accuracy: 55.74
Round  26, Train loss: 0.525, Test loss: 1.240, Test accuracy: 65.50
Round  26, Global train loss: 0.525, Global test loss: 1.596, Global test accuracy: 53.51
Round  27, Train loss: 0.473, Test loss: 1.293, Test accuracy: 64.91
Round  27, Global train loss: 0.473, Global test loss: 1.394, Global test accuracy: 56.14
Round  28, Train loss: 0.408, Test loss: 1.292, Test accuracy: 65.66
Round  28, Global train loss: 0.408, Global test loss: 1.685, Global test accuracy: 53.00
Round  29, Train loss: 0.499, Test loss: 1.254, Test accuracy: 66.59
Round  29, Global train loss: 0.499, Global test loss: 1.414, Global test accuracy: 57.74
Round  30, Train loss: 0.491, Test loss: 1.252, Test accuracy: 66.29
Round  30, Global train loss: 0.491, Global test loss: 1.559, Global test accuracy: 54.13
Round  31, Train loss: 0.439, Test loss: 1.306, Test accuracy: 65.76
Round  31, Global train loss: 0.439, Global test loss: 1.593, Global test accuracy: 55.16
Round  32, Train loss: 0.446, Test loss: 1.313, Test accuracy: 65.97
Round  32, Global train loss: 0.446, Global test loss: 1.471, Global test accuracy: 57.35
Round  33, Train loss: 0.508, Test loss: 1.324, Test accuracy: 65.91
Round  33, Global train loss: 0.508, Global test loss: 1.599, Global test accuracy: 54.30
Round  34, Train loss: 0.418, Test loss: 1.368, Test accuracy: 65.36
Round  34, Global train loss: 0.418, Global test loss: 1.748, Global test accuracy: 54.17
Round  35, Train loss: 0.433, Test loss: 1.379, Test accuracy: 65.27
Round  35, Global train loss: 0.433, Global test loss: 1.403, Global test accuracy: 57.38
Round  36, Train loss: 0.417, Test loss: 1.382, Test accuracy: 65.64
Round  36, Global train loss: 0.417, Global test loss: 1.498, Global test accuracy: 56.60
Round  37, Train loss: 0.420, Test loss: 1.343, Test accuracy: 66.70
Round  37, Global train loss: 0.420, Global test loss: 1.664, Global test accuracy: 52.34
Round  38, Train loss: 0.422, Test loss: 1.343, Test accuracy: 66.91
Round  38, Global train loss: 0.422, Global test loss: 1.474, Global test accuracy: 56.56
Round  39, Train loss: 0.335, Test loss: 1.392, Test accuracy: 66.18
Round  39, Global train loss: 0.335, Global test loss: 1.531, Global test accuracy: 57.30
Round  40, Train loss: 0.389, Test loss: 1.376, Test accuracy: 66.34
Round  40, Global train loss: 0.389, Global test loss: 1.516, Global test accuracy: 56.56
Round  41, Train loss: 0.315, Test loss: 1.342, Test accuracy: 66.68
Round  41, Global train loss: 0.315, Global test loss: 1.570, Global test accuracy: 58.35
Round  42, Train loss: 0.417, Test loss: 1.369, Test accuracy: 66.29
Round  42, Global train loss: 0.417, Global test loss: 1.641, Global test accuracy: 55.40
Round  43, Train loss: 0.362, Test loss: 1.384, Test accuracy: 66.07
Round  43, Global train loss: 0.362, Global test loss: 1.855, Global test accuracy: 53.76
Round  44, Train loss: 0.334, Test loss: 1.368, Test accuracy: 66.45
Round  44, Global train loss: 0.334, Global test loss: 1.469, Global test accuracy: 57.73
Round  45, Train loss: 0.305, Test loss: 1.416, Test accuracy: 66.34
Round  45, Global train loss: 0.305, Global test loss: 1.692, Global test accuracy: 57.83
Round  46, Train loss: 0.343, Test loss: 1.451, Test accuracy: 65.93
Round  46, Global train loss: 0.343, Global test loss: 1.600, Global test accuracy: 57.26
Round  47, Train loss: 0.355, Test loss: 1.427, Test accuracy: 66.49
Round  47, Global train loss: 0.355, Global test loss: 1.540, Global test accuracy: 56.88
Round  48, Train loss: 0.283, Test loss: 1.442, Test accuracy: 66.55
Round  48, Global train loss: 0.283, Global test loss: 1.804, Global test accuracy: 56.40
Round  49, Train loss: 0.342, Test loss: 1.427, Test accuracy: 66.45
Round  49, Global train loss: 0.342, Global test loss: 1.663, Global test accuracy: 56.36
Round  50, Train loss: 0.289, Test loss: 1.396, Test accuracy: 67.05
Round  50, Global train loss: 0.289, Global test loss: 1.765, Global test accuracy: 57.06
Round  51, Train loss: 0.306, Test loss: 1.394, Test accuracy: 67.48
Round  51, Global train loss: 0.306, Global test loss: 1.490, Global test accuracy: 58.26
Round  52, Train loss: 0.288, Test loss: 1.424, Test accuracy: 67.23
Round  52, Global train loss: 0.288, Global test loss: 1.510, Global test accuracy: 57.61
Round  53, Train loss: 0.326, Test loss: 1.477, Test accuracy: 67.08
Round  53, Global train loss: 0.326, Global test loss: 1.875, Global test accuracy: 53.81
Round  54, Train loss: 0.265, Test loss: 1.440, Test accuracy: 67.49
Round  54, Global train loss: 0.265, Global test loss: 1.746, Global test accuracy: 56.06
Round  55, Train loss: 0.290, Test loss: 1.419, Test accuracy: 67.15
Round  55, Global train loss: 0.290, Global test loss: 1.538, Global test accuracy: 57.40
Round  56, Train loss: 0.301, Test loss: 1.442, Test accuracy: 67.20
Round  56, Global train loss: 0.301, Global test loss: 1.533, Global test accuracy: 58.55
Round  57, Train loss: 0.271, Test loss: 1.471, Test accuracy: 67.05
Round  57, Global train loss: 0.271, Global test loss: 1.598, Global test accuracy: 58.25
Round  58, Train loss: 0.286, Test loss: 1.456, Test accuracy: 67.36
Round  58, Global train loss: 0.286, Global test loss: 1.716, Global test accuracy: 56.77
Round  59, Train loss: 0.322, Test loss: 1.451, Test accuracy: 67.14
Round  59, Global train loss: 0.322, Global test loss: 1.619, Global test accuracy: 57.41
Round  60, Train loss: 0.335, Test loss: 1.497, Test accuracy: 66.82
Round  60, Global train loss: 0.335, Global test loss: 1.823, Global test accuracy: 56.21
Round  61, Train loss: 0.267, Test loss: 1.490, Test accuracy: 67.01
Round  61, Global train loss: 0.267, Global test loss: 1.822, Global test accuracy: 57.68
Round  62, Train loss: 0.216, Test loss: 1.502, Test accuracy: 67.25
Round  62, Global train loss: 0.216, Global test loss: 1.987, Global test accuracy: 55.64
Round  63, Train loss: 0.306, Test loss: 1.525, Test accuracy: 67.03
Round  63, Global train loss: 0.306, Global test loss: 1.614, Global test accuracy: 57.92
Round  64, Train loss: 0.265, Test loss: 1.497, Test accuracy: 67.71
Round  64, Global train loss: 0.265, Global test loss: 2.005, Global test accuracy: 55.64
Round  65, Train loss: 0.239, Test loss: 1.529, Test accuracy: 67.35
Round  65, Global train loss: 0.239, Global test loss: 1.677, Global test accuracy: 58.57
Round  66, Train loss: 0.213, Test loss: 1.518, Test accuracy: 67.76
Round  66, Global train loss: 0.213, Global test loss: 1.724, Global test accuracy: 58.96
Round  67, Train loss: 0.271, Test loss: 1.518, Test accuracy: 67.62
Round  67, Global train loss: 0.271, Global test loss: 2.001, Global test accuracy: 56.30
Round  68, Train loss: 0.250, Test loss: 1.545, Test accuracy: 67.55
Round  68, Global train loss: 0.250, Global test loss: 1.806, Global test accuracy: 57.54
Round  69, Train loss: 0.226, Test loss: 1.550, Test accuracy: 67.27
Round  69, Global train loss: 0.226, Global test loss: 1.786, Global test accuracy: 57.83
Round  70, Train loss: 0.347, Test loss: 1.543, Test accuracy: 67.47
Round  70, Global train loss: 0.347, Global test loss: 1.856, Global test accuracy: 53.89
Round  71, Train loss: 0.227, Test loss: 1.530, Test accuracy: 67.63
Round  71, Global train loss: 0.227, Global test loss: 1.769, Global test accuracy: 57.29
Round  72, Train loss: 0.240, Test loss: 1.577, Test accuracy: 67.27
Round  72, Global train loss: 0.240, Global test loss: 1.866, Global test accuracy: 55.78
Round  73, Train loss: 0.268, Test loss: 1.587, Test accuracy: 67.14
Round  73, Global train loss: 0.268, Global test loss: 1.913, Global test accuracy: 54.25
Round  74, Train loss: 0.254, Test loss: 1.620, Test accuracy: 66.68
Round  74, Global train loss: 0.254, Global test loss: 1.661, Global test accuracy: 58.86
Round  75, Train loss: 0.236, Test loss: 1.624, Test accuracy: 66.73
Round  75, Global train loss: 0.236, Global test loss: 1.696, Global test accuracy: 57.78
Round  76, Train loss: 0.231, Test loss: 1.630, Test accuracy: 66.69
Round  76, Global train loss: 0.231, Global test loss: 1.863, Global test accuracy: 56.70
Round  77, Train loss: 0.224, Test loss: 1.613, Test accuracy: 67.13
Round  77, Global train loss: 0.224, Global test loss: 1.968, Global test accuracy: 56.86
Round  78, Train loss: 0.266, Test loss: 1.628, Test accuracy: 66.96
Round  78, Global train loss: 0.266, Global test loss: 1.952, Global test accuracy: 54.24
Round  79, Train loss: 0.210, Test loss: 1.653, Test accuracy: 66.65
Round  79, Global train loss: 0.210, Global test loss: 1.911, Global test accuracy: 58.45
Round  80, Train loss: 0.166, Test loss: 1.618, Test accuracy: 66.71
Round  80, Global train loss: 0.166, Global test loss: 1.873, Global test accuracy: 59.00
Round  81, Train loss: 0.146, Test loss: 1.633, Test accuracy: 67.04
Round  81, Global train loss: 0.146, Global test loss: 1.799, Global test accuracy: 59.27
Round  82, Train loss: 0.140, Test loss: 1.658, Test accuracy: 67.30
Round  82, Global train loss: 0.140, Global test loss: 1.808, Global test accuracy: 59.54
Round  83, Train loss: 0.131, Test loss: 1.658, Test accuracy: 67.26
Round  83, Global train loss: 0.131, Global test loss: 1.864, Global test accuracy: 58.90
Round  84, Train loss: 0.135, Test loss: 1.657, Test accuracy: 66.99
Round  84, Global train loss: 0.135, Global test loss: 1.843, Global test accuracy: 59.36
Round  85, Train loss: 0.128, Test loss: 1.648, Test accuracy: 66.88
Round  85, Global train loss: 0.128, Global test loss: 1.879, Global test accuracy: 59.58
Round  86, Train loss: 0.118, Test loss: 1.670, Test accuracy: 66.85
Round  86, Global train loss: 0.118, Global test loss: 1.906, Global test accuracy: 59.01
Round  87, Train loss: 0.118, Test loss: 1.691, Test accuracy: 67.11
Round  87, Global train loss: 0.118, Global test loss: 1.965, Global test accuracy: 59.33
Round  88, Train loss: 0.110, Test loss: 1.665, Test accuracy: 67.05
Round  88, Global train loss: 0.110, Global test loss: 1.935, Global test accuracy: 59.61
Round  89, Train loss: 0.106, Test loss: 1.696, Test accuracy: 67.03
Round  89, Global train loss: 0.106, Global test loss: 1.918, Global test accuracy: 59.84
Round  90, Train loss: 0.239, Test loss: 1.637, Test accuracy: 67.99
Round  90, Global train loss: 0.239, Global test loss: 1.583, Global test accuracy: 60.69
Round  91, Train loss: 0.211, Test loss: 1.659, Test accuracy: 68.10
Round  91, Global train loss: 0.211, Global test loss: 1.581, Global test accuracy: 60.72
Round  92, Train loss: 0.206, Test loss: 1.607, Test accuracy: 68.50
Round  92, Global train loss: 0.206, Global test loss: 1.562, Global test accuracy: 61.10
Round  93, Train loss: 0.204, Test loss: 1.607, Test accuracy: 67.92
Round  93, Global train loss: 0.204, Global test loss: 1.573, Global test accuracy: 60.89
Round  94, Train loss: 0.196, Test loss: 1.626, Test accuracy: 67.93
Round  94, Global train loss: 0.196, Global test loss: 1.580, Global test accuracy: 60.73
Round  95, Train loss: 0.196, Test loss: 1.668, Test accuracy: 67.38
Round  95, Global train loss: 0.196, Global test loss: 1.578, Global test accuracy: 61.09
Round  96, Train loss: 0.191, Test loss: 1.656, Test accuracy: 67.29
Round  96, Global train loss: 0.191, Global test loss: 1.580, Global test accuracy: 61.50
Round  97, Train loss: 0.195, Test loss: 1.692, Test accuracy: 67.63
Round  97, Global train loss: 0.195, Global test loss: 1.613, Global test accuracy: 60.89
Round  98, Train loss: 0.189, Test loss: 1.660, Test accuracy: 68.46
Round  98, Global train loss: 0.189, Global test loss: 1.582, Global test accuracy: 61.25
Round  99, Train loss: 0.186, Test loss: 1.702, Test accuracy: 67.71
Round  99, Global train loss: 0.186, Global test loss: 1.610, Global test accuracy: 60.79
Final Round, Train loss: 0.141, Test loss: 1.848, Test accuracy: 67.93
Final Round, Global train loss: 0.141, Global test loss: 1.610, Global test accuracy: 60.79
Average accuracy final 10 rounds: 67.89099999999999
Average global accuracy final 10 rounds: 60.965
2523.4991447925568
[2.6101770401000977, 4.9694554805755615, 7.321850299835205, 9.716032028198242, 12.092660188674927, 14.442366600036621, 16.815717697143555, 19.215351104736328, 21.58150625228882, 23.974534273147583, 26.310248374938965, 28.651795864105225, 31.011950731277466, 33.34529209136963, 35.519405126571655, 37.749125957489014, 39.92226576805115, 42.10463738441467, 44.358858585357666, 46.59128999710083, 48.98766255378723, 51.33372211456299, 53.683401584625244, 56.01556444168091, 58.392054319381714, 60.76195788383484, 63.02603602409363, 65.3249568939209, 67.63175678253174, 69.95939302444458, 72.25997114181519, 74.59896874427795, 76.75432991981506, 78.88041234016418, 81.2131667137146, 83.39841604232788, 85.56916761398315, 87.89386343955994, 90.21259617805481, 92.43529725074768, 94.74165511131287, 97.12174963951111, 99.47433733940125, 101.84424543380737, 104.15404319763184, 106.39567232131958, 108.54200434684753, 110.71066522598267, 113.1109471321106, 115.3016939163208, 117.64584374427795, 119.92930030822754, 122.1162428855896, 124.32725977897644, 126.67466950416565, 129.0333104133606, 131.38042092323303, 133.75006532669067, 136.1175343990326, 138.55179286003113, 140.75590205192566, 142.9541118144989, 145.1554718017578, 147.3530571460724, 149.52854585647583, 151.66455125808716, 153.80805206298828, 156.01222825050354, 158.24342131614685, 160.4372913837433, 162.43924283981323, 164.4804503917694, 166.61265897750854, 168.72786164283752, 170.8516936302185, 173.04028224945068, 175.25266098976135, 177.48793601989746, 179.6792459487915, 181.7688112258911, 183.98972630500793, 186.23952102661133, 188.3291540145874, 190.60609245300293, 192.78772354125977, 195.181058883667, 197.4745533466339, 199.61793160438538, 201.69083404541016, 203.74678659439087, 205.85078644752502, 208.1106894016266, 210.24291920661926, 212.54484677314758, 214.85390710830688, 217.1992518901825, 219.4792172908783, 221.6426501274109, 223.78198981285095, 226.09679532051086, 230.58522057533264]
[46.77, 54.49, 56.69, 58.74, 60.29, 61.3, 61.84, 62.23, 62.91, 62.32, 62.6, 62.9, 63.46, 63.88, 63.97, 63.87, 64.34, 64.48, 64.52, 65.16, 64.91, 65.35, 65.83, 65.87, 65.88, 65.15, 65.5, 64.91, 65.66, 66.59, 66.29, 65.76, 65.97, 65.91, 65.36, 65.27, 65.64, 66.7, 66.91, 66.18, 66.34, 66.68, 66.29, 66.07, 66.45, 66.34, 65.93, 66.49, 66.55, 66.45, 67.05, 67.48, 67.23, 67.08, 67.49, 67.15, 67.2, 67.05, 67.36, 67.14, 66.82, 67.01, 67.25, 67.03, 67.71, 67.35, 67.76, 67.62, 67.55, 67.27, 67.47, 67.63, 67.27, 67.14, 66.68, 66.73, 66.69, 67.13, 66.96, 66.65, 66.71, 67.04, 67.3, 67.26, 66.99, 66.88, 66.85, 67.11, 67.05, 67.03, 67.99, 68.1, 68.5, 67.92, 67.93, 67.38, 67.29, 67.63, 68.46, 67.71, 67.93]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.477, Test loss: 1.257, Test accuracy: 47.40
Round   0, Global train loss: 1.477, Global test loss: 2.052, Global test accuracy: 27.67
Round   1, Train loss: 1.248, Test loss: 1.114, Test accuracy: 55.45
Round   1, Global train loss: 1.248, Global test loss: 1.827, Global test accuracy: 35.27
Round   2, Train loss: 1.127, Test loss: 1.054, Test accuracy: 58.68
Round   2, Global train loss: 1.127, Global test loss: 1.658, Global test accuracy: 39.78
Round   3, Train loss: 1.051, Test loss: 1.054, Test accuracy: 59.54
Round   3, Global train loss: 1.051, Global test loss: 1.564, Global test accuracy: 43.33
Round   4, Train loss: 0.989, Test loss: 1.024, Test accuracy: 60.84
Round   4, Global train loss: 0.989, Global test loss: 1.498, Global test accuracy: 46.20
Round   5, Train loss: 0.933, Test loss: 0.975, Test accuracy: 63.36
Round   5, Global train loss: 0.933, Global test loss: 1.424, Global test accuracy: 49.66
Round   6, Train loss: 0.884, Test loss: 0.957, Test accuracy: 64.21
Round   6, Global train loss: 0.884, Global test loss: 1.356, Global test accuracy: 52.18
Round   7, Train loss: 0.841, Test loss: 0.961, Test accuracy: 64.73
Round   7, Global train loss: 0.841, Global test loss: 1.311, Global test accuracy: 54.03
Round   8, Train loss: 0.798, Test loss: 0.945, Test accuracy: 65.95
Round   8, Global train loss: 0.798, Global test loss: 1.282, Global test accuracy: 54.94
Round   9, Train loss: 0.760, Test loss: 0.961, Test accuracy: 65.44
Round   9, Global train loss: 0.760, Global test loss: 1.258, Global test accuracy: 56.25
Round  10, Train loss: 0.694, Test loss: 0.952, Test accuracy: 66.01
Round  10, Global train loss: 0.694, Global test loss: 1.428, Global test accuracy: 52.73
Round  11, Train loss: 0.710, Test loss: 0.951, Test accuracy: 66.62
Round  11, Global train loss: 0.710, Global test loss: 1.333, Global test accuracy: 53.30
Round  12, Train loss: 0.600, Test loss: 0.953, Test accuracy: 66.58
Round  12, Global train loss: 0.600, Global test loss: 1.342, Global test accuracy: 54.36
Round  13, Train loss: 0.647, Test loss: 0.955, Test accuracy: 67.27
Round  13, Global train loss: 0.647, Global test loss: 1.395, Global test accuracy: 51.87
Round  14, Train loss: 0.612, Test loss: 0.969, Test accuracy: 67.58
Round  14, Global train loss: 0.612, Global test loss: 1.514, Global test accuracy: 51.69
Round  15, Train loss: 0.581, Test loss: 0.998, Test accuracy: 67.02
Round  15, Global train loss: 0.581, Global test loss: 1.854, Global test accuracy: 48.16
Round  16, Train loss: 0.557, Test loss: 1.001, Test accuracy: 67.18
Round  16, Global train loss: 0.557, Global test loss: 1.337, Global test accuracy: 53.66
Round  17, Train loss: 0.476, Test loss: 0.977, Test accuracy: 67.59
Round  17, Global train loss: 0.476, Global test loss: 1.646, Global test accuracy: 52.31
Round  18, Train loss: 0.529, Test loss: 0.982, Test accuracy: 68.25
Round  18, Global train loss: 0.529, Global test loss: 1.485, Global test accuracy: 52.80
Round  19, Train loss: 0.540, Test loss: 1.005, Test accuracy: 67.92
Round  19, Global train loss: 0.540, Global test loss: 1.321, Global test accuracy: 57.06
Round  20, Train loss: 0.463, Test loss: 1.020, Test accuracy: 68.05
Round  20, Global train loss: 0.463, Global test loss: 1.323, Global test accuracy: 57.97
Round  21, Train loss: 0.447, Test loss: 1.061, Test accuracy: 67.53
Round  21, Global train loss: 0.447, Global test loss: 1.615, Global test accuracy: 53.40
Round  22, Train loss: 0.452, Test loss: 1.052, Test accuracy: 68.50
Round  22, Global train loss: 0.452, Global test loss: 1.618, Global test accuracy: 54.45
Round  23, Train loss: 0.379, Test loss: 1.050, Test accuracy: 68.50
Round  23, Global train loss: 0.379, Global test loss: 1.421, Global test accuracy: 57.64
Round  24, Train loss: 0.453, Test loss: 1.034, Test accuracy: 68.80
Round  24, Global train loss: 0.453, Global test loss: 1.388, Global test accuracy: 57.59
Round  25, Train loss: 0.476, Test loss: 1.028, Test accuracy: 69.33
Round  25, Global train loss: 0.476, Global test loss: 1.308, Global test accuracy: 58.59
Round  26, Train loss: 0.417, Test loss: 1.053, Test accuracy: 69.11
Round  26, Global train loss: 0.417, Global test loss: 1.385, Global test accuracy: 58.32
Round  27, Train loss: 0.485, Test loss: 1.051, Test accuracy: 69.97
Round  27, Global train loss: 0.485, Global test loss: 1.305, Global test accuracy: 58.47
Round  28, Train loss: 0.389, Test loss: 1.048, Test accuracy: 70.14
Round  28, Global train loss: 0.389, Global test loss: 1.445, Global test accuracy: 56.78
Round  29, Train loss: 0.356, Test loss: 1.054, Test accuracy: 70.27
Round  29, Global train loss: 0.356, Global test loss: 1.281, Global test accuracy: 62.02
Round  30, Train loss: 0.406, Test loss: 1.058, Test accuracy: 70.11
Round  30, Global train loss: 0.406, Global test loss: 1.510, Global test accuracy: 57.01
Round  31, Train loss: 0.374, Test loss: 1.076, Test accuracy: 69.80
Round  31, Global train loss: 0.374, Global test loss: 1.380, Global test accuracy: 59.84
Round  32, Train loss: 0.379, Test loss: 1.063, Test accuracy: 70.37
Round  32, Global train loss: 0.379, Global test loss: 1.449, Global test accuracy: 57.66
Round  33, Train loss: 0.339, Test loss: 1.081, Test accuracy: 70.42
Round  33, Global train loss: 0.339, Global test loss: 1.349, Global test accuracy: 60.47
Round  34, Train loss: 0.296, Test loss: 1.121, Test accuracy: 70.55
Round  34, Global train loss: 0.296, Global test loss: 1.574, Global test accuracy: 59.21
Round  35, Train loss: 0.391, Test loss: 1.142, Test accuracy: 70.23
Round  35, Global train loss: 0.391, Global test loss: 1.252, Global test accuracy: 60.55
Round  36, Train loss: 0.330, Test loss: 1.144, Test accuracy: 70.65
Round  36, Global train loss: 0.330, Global test loss: 1.331, Global test accuracy: 61.20
Round  37, Train loss: 0.388, Test loss: 1.127, Test accuracy: 71.09
Round  37, Global train loss: 0.388, Global test loss: 1.269, Global test accuracy: 61.34
Round  38, Train loss: 0.417, Test loss: 1.139, Test accuracy: 71.32
Round  38, Global train loss: 0.417, Global test loss: 1.438, Global test accuracy: 58.77
Round  39, Train loss: 0.299, Test loss: 1.149, Test accuracy: 71.08
Round  39, Global train loss: 0.299, Global test loss: 1.397, Global test accuracy: 60.65
Round  40, Train loss: 0.295, Test loss: 1.161, Test accuracy: 70.81
Round  40, Global train loss: 0.295, Global test loss: 1.373, Global test accuracy: 61.53
Round  41, Train loss: 0.281, Test loss: 1.156, Test accuracy: 70.96
Round  41, Global train loss: 0.281, Global test loss: 1.446, Global test accuracy: 60.76
Round  42, Train loss: 0.302, Test loss: 1.139, Test accuracy: 71.23
Round  42, Global train loss: 0.302, Global test loss: 1.496, Global test accuracy: 59.84
Round  43, Train loss: 0.367, Test loss: 1.161, Test accuracy: 71.15
Round  43, Global train loss: 0.367, Global test loss: 1.530, Global test accuracy: 56.97
Round  44, Train loss: 0.282, Test loss: 1.167, Test accuracy: 71.09
Round  44, Global train loss: 0.282, Global test loss: 1.332, Global test accuracy: 61.08
Round  45, Train loss: 0.286, Test loss: 1.187, Test accuracy: 70.85
Round  45, Global train loss: 0.286, Global test loss: 1.482, Global test accuracy: 60.77
Round  46, Train loss: 0.261, Test loss: 1.170, Test accuracy: 70.37
Round  46, Global train loss: 0.261, Global test loss: 1.378, Global test accuracy: 61.35
Round  47, Train loss: 0.352, Test loss: 1.175, Test accuracy: 70.47
Round  47, Global train loss: 0.352, Global test loss: 1.537, Global test accuracy: 57.44
Round  48, Train loss: 0.298, Test loss: 1.177, Test accuracy: 71.04
Round  48, Global train loss: 0.298, Global test loss: 1.574, Global test accuracy: 59.35
Round  49, Train loss: 0.252, Test loss: 1.194, Test accuracy: 70.93
Round  49, Global train loss: 0.252, Global test loss: 1.786, Global test accuracy: 56.08
Round  50, Train loss: 0.264, Test loss: 1.177, Test accuracy: 71.09
Round  50, Global train loss: 0.264, Global test loss: 1.546, Global test accuracy: 60.20
Round  51, Train loss: 0.227, Test loss: 1.203, Test accuracy: 70.87
Round  51, Global train loss: 0.227, Global test loss: 1.499, Global test accuracy: 60.79
Round  52, Train loss: 0.288, Test loss: 1.209, Test accuracy: 70.95
Round  52, Global train loss: 0.288, Global test loss: 1.514, Global test accuracy: 59.79
Round  53, Train loss: 0.276, Test loss: 1.198, Test accuracy: 71.12
Round  53, Global train loss: 0.276, Global test loss: 1.585, Global test accuracy: 57.58
Round  54, Train loss: 0.240, Test loss: 1.174, Test accuracy: 71.82
Round  54, Global train loss: 0.240, Global test loss: 1.443, Global test accuracy: 61.56
Round  55, Train loss: 0.320, Test loss: 1.221, Test accuracy: 71.44
Round  55, Global train loss: 0.320, Global test loss: 1.537, Global test accuracy: 59.59
Round  56, Train loss: 0.242, Test loss: 1.255, Test accuracy: 71.09
Round  56, Global train loss: 0.242, Global test loss: 1.512, Global test accuracy: 59.49
Round  57, Train loss: 0.256, Test loss: 1.267, Test accuracy: 71.22
Round  57, Global train loss: 0.256, Global test loss: 1.416, Global test accuracy: 61.09
Round  58, Train loss: 0.259, Test loss: 1.266, Test accuracy: 71.12
Round  58, Global train loss: 0.259, Global test loss: 1.486, Global test accuracy: 60.03
Round  59, Train loss: 0.213, Test loss: 1.271, Test accuracy: 71.17
Round  59, Global train loss: 0.213, Global test loss: 1.417, Global test accuracy: 62.69
Round  60, Train loss: 0.268, Test loss: 1.246, Test accuracy: 71.34
Round  60, Global train loss: 0.268, Global test loss: 1.580, Global test accuracy: 60.51
Round  61, Train loss: 0.182, Test loss: 1.253, Test accuracy: 71.52
Round  61, Global train loss: 0.182, Global test loss: 1.567, Global test accuracy: 61.67
Round  62, Train loss: 0.201, Test loss: 1.281, Test accuracy: 71.25
Round  62, Global train loss: 0.201, Global test loss: 1.758, Global test accuracy: 58.60
Round  63, Train loss: 0.244, Test loss: 1.266, Test accuracy: 71.13
Round  63, Global train loss: 0.244, Global test loss: 1.390, Global test accuracy: 63.47
Round  64, Train loss: 0.236, Test loss: 1.275, Test accuracy: 70.91
Round  64, Global train loss: 0.236, Global test loss: 1.791, Global test accuracy: 59.37
Round  65, Train loss: 0.221, Test loss: 1.315, Test accuracy: 70.57
Round  65, Global train loss: 0.221, Global test loss: 1.449, Global test accuracy: 63.11
Round  66, Train loss: 0.187, Test loss: 1.294, Test accuracy: 70.83
Round  66, Global train loss: 0.187, Global test loss: 1.590, Global test accuracy: 61.67
Round  67, Train loss: 0.231, Test loss: 1.300, Test accuracy: 71.21
Round  67, Global train loss: 0.231, Global test loss: 1.855, Global test accuracy: 58.75
Round  68, Train loss: 0.204, Test loss: 1.281, Test accuracy: 71.76
Round  68, Global train loss: 0.204, Global test loss: 1.617, Global test accuracy: 61.17
Round  69, Train loss: 0.259, Test loss: 1.288, Test accuracy: 71.71
Round  69, Global train loss: 0.259, Global test loss: 1.582, Global test accuracy: 60.05
Round  70, Train loss: 0.265, Test loss: 1.256, Test accuracy: 72.27
Round  70, Global train loss: 0.265, Global test loss: 1.638, Global test accuracy: 59.26
Round  71, Train loss: 0.210, Test loss: 1.275, Test accuracy: 72.01
Round  71, Global train loss: 0.210, Global test loss: 1.594, Global test accuracy: 60.34
Round  72, Train loss: 0.193, Test loss: 1.294, Test accuracy: 71.67
Round  72, Global train loss: 0.193, Global test loss: 1.632, Global test accuracy: 60.38
Round  73, Train loss: 0.220, Test loss: 1.323, Test accuracy: 71.51
Round  73, Global train loss: 0.220, Global test loss: 1.665, Global test accuracy: 59.52
Round  74, Train loss: 0.182, Test loss: 1.290, Test accuracy: 72.25
Round  74, Global train loss: 0.182, Global test loss: 1.409, Global test accuracy: 64.26
Round  75, Train loss: 0.210, Test loss: 1.312, Test accuracy: 72.31
Round  75, Global train loss: 0.210, Global test loss: 1.558, Global test accuracy: 60.97
Round  76, Train loss: 0.173, Test loss: 1.350, Test accuracy: 71.90
Round  76, Global train loss: 0.173, Global test loss: 1.639, Global test accuracy: 61.72
Round  77, Train loss: 0.142, Test loss: 1.310, Test accuracy: 72.09
Round  77, Global train loss: 0.142, Global test loss: 1.924, Global test accuracy: 59.47
Round  78, Train loss: 0.163, Test loss: 1.304, Test accuracy: 72.23
Round  78, Global train loss: 0.163, Global test loss: 1.609, Global test accuracy: 61.29
Round  79, Train loss: 0.187, Test loss: 1.334, Test accuracy: 72.21
Round  79, Global train loss: 0.187, Global test loss: 1.675, Global test accuracy: 61.69
Round  80, Train loss: 0.150, Test loss: 1.346, Test accuracy: 71.88
Round  80, Global train loss: 0.150, Global test loss: 1.585, Global test accuracy: 63.35
Round  81, Train loss: 0.123, Test loss: 1.341, Test accuracy: 72.14
Round  81, Global train loss: 0.123, Global test loss: 1.609, Global test accuracy: 63.33
Round  82, Train loss: 0.125, Test loss: 1.397, Test accuracy: 71.66
Round  82, Global train loss: 0.125, Global test loss: 1.614, Global test accuracy: 63.47
Round  83, Train loss: 0.123, Test loss: 1.375, Test accuracy: 72.19
Round  83, Global train loss: 0.123, Global test loss: 1.634, Global test accuracy: 63.41
Round  84, Train loss: 0.113, Test loss: 1.374, Test accuracy: 72.17
Round  84, Global train loss: 0.113, Global test loss: 1.666, Global test accuracy: 63.35
Round  85, Train loss: 0.110, Test loss: 1.379, Test accuracy: 72.11
Round  85, Global train loss: 0.110, Global test loss: 1.670, Global test accuracy: 63.27
Round  86, Train loss: 0.104, Test loss: 1.345, Test accuracy: 72.74
Round  86, Global train loss: 0.104, Global test loss: 1.717, Global test accuracy: 62.54
Round  87, Train loss: 0.111, Test loss: 1.406, Test accuracy: 72.20
Round  87, Global train loss: 0.111, Global test loss: 1.754, Global test accuracy: 62.72
Round  88, Train loss: 0.096, Test loss: 1.400, Test accuracy: 72.07
Round  88, Global train loss: 0.096, Global test loss: 1.769, Global test accuracy: 62.95
Round  89, Train loss: 0.104, Test loss: 1.377, Test accuracy: 72.26
Round  89, Global train loss: 0.104, Global test loss: 1.696, Global test accuracy: 63.30
Round  90, Train loss: 0.201, Test loss: 1.353, Test accuracy: 72.13
Round  90, Global train loss: 0.201, Global test loss: 1.459, Global test accuracy: 64.49
Round  91, Train loss: 0.180, Test loss: 1.349, Test accuracy: 72.25
Round  91, Global train loss: 0.180, Global test loss: 1.433, Global test accuracy: 64.79
Round  92, Train loss: 0.169, Test loss: 1.372, Test accuracy: 72.23
Round  92, Global train loss: 0.169, Global test loss: 1.441, Global test accuracy: 64.59
Round  93, Train loss: 0.164, Test loss: 1.375, Test accuracy: 72.45
Round  93, Global train loss: 0.164, Global test loss: 1.454, Global test accuracy: 65.04
Round  94, Train loss: 0.165, Test loss: 1.398, Test accuracy: 71.98
Round  94, Global train loss: 0.165, Global test loss: 1.430, Global test accuracy: 64.85
Round  95, Train loss: 0.166, Test loss: 1.358, Test accuracy: 72.81
Round  95, Global train loss: 0.166, Global test loss: 1.458, Global test accuracy: 64.43
Round  96, Train loss: 0.161, Test loss: 1.392, Test accuracy: 71.95
Round  96, Global train loss: 0.161, Global test loss: 1.460, Global test accuracy: 64.46
Round  97, Train loss: 0.164, Test loss: 1.398, Test accuracy: 72.18
Round  97, Global train loss: 0.164, Global test loss: 1.440, Global test accuracy: 64.89
Round  98, Train loss: 0.162, Test loss: 1.423, Test accuracy: 71.84
Round  98, Global train loss: 0.162, Global test loss: 1.445, Global test accuracy: 64.77
Round  99, Train loss: 0.158, Test loss: 1.414, Test accuracy: 72.15
Round  99, Global train loss: 0.158, Global test loss: 1.431, Global test accuracy: 65.06
Final Round, Train loss: 0.118, Test loss: 1.515, Test accuracy: 72.14
Final Round, Global train loss: 0.118, Global test loss: 1.431, Global test accuracy: 65.06
Average accuracy final 10 rounds: 72.197
Average global accuracy final 10 rounds: 64.737
4096.0363030433655
[2.482037305831909, 4.820085763931274, 7.0916478633880615, 9.432453155517578, 11.66034483909607, 13.776747703552246, 16.105563402175903, 18.480777502059937, 20.757805585861206, 23.095802068710327, 25.386138200759888, 27.66424059867859, 29.89647150039673, 32.12691783905029, 34.267016649246216, 36.55027937889099, 38.826273918151855, 41.17516756057739, 43.24507212638855, 45.461934328079224, 47.64842772483826, 52.204665184020996, 56.76856064796448, 61.444820165634155, 66.09111404418945, 70.72441530227661, 75.36304116249084, 79.95454812049866, 84.53909707069397, 89.30604839324951, 94.19774746894836, 99.04548573493958, 103.69834399223328, 108.36136245727539, 113.18812894821167, 117.97894239425659, 122.81374263763428, 127.46560168266296, 132.20127058029175, 136.9237494468689, 141.57787489891052, 146.3369846343994, 151.16762280464172, 155.70921802520752, 160.17947387695312, 164.72602033615112, 169.20683670043945, 173.72971272468567, 178.24501490592957, 182.81345653533936, 187.63737106323242, 192.28748893737793, 196.9596347808838, 201.65710496902466, 206.37019538879395, 211.07519626617432, 215.7305769920349, 220.43038296699524, 225.16391897201538, 229.72687315940857, 234.29765057563782, 238.74598121643066, 243.19441676139832, 247.71221446990967, 252.17315673828125, 256.73770809173584, 261.4216978549957, 266.1279528141022, 270.53362226486206, 275.17992424964905, 279.9396047592163, 284.56261801719666, 289.15525555610657, 293.7067549228668, 298.36007833480835, 303.0810811519623, 307.83502316474915, 312.46580934524536, 317.488037109375, 322.3053615093231, 327.12525248527527, 331.7752830982208, 336.527704000473, 341.3667585849762, 346.4418716430664, 351.11025857925415, 355.7312831878662, 360.4181754589081, 365.11191987991333, 369.8637089729309, 374.5628831386566, 379.28797125816345, 384.08255410194397, 388.77491641044617, 394.0570638179779, 399.38488149642944, 404.4885914325714, 409.81799268722534, 415.2273166179657, 420.80033898353577, 426.12813091278076]
[47.4, 55.45, 58.68, 59.54, 60.84, 63.36, 64.21, 64.73, 65.95, 65.44, 66.01, 66.62, 66.58, 67.27, 67.58, 67.02, 67.18, 67.59, 68.25, 67.92, 68.05, 67.53, 68.5, 68.5, 68.8, 69.33, 69.11, 69.97, 70.14, 70.27, 70.11, 69.8, 70.37, 70.42, 70.55, 70.23, 70.65, 71.09, 71.32, 71.08, 70.81, 70.96, 71.23, 71.15, 71.09, 70.85, 70.37, 70.47, 71.04, 70.93, 71.09, 70.87, 70.95, 71.12, 71.82, 71.44, 71.09, 71.22, 71.12, 71.17, 71.34, 71.52, 71.25, 71.13, 70.91, 70.57, 70.83, 71.21, 71.76, 71.71, 72.27, 72.01, 71.67, 71.51, 72.25, 72.31, 71.9, 72.09, 72.23, 72.21, 71.88, 72.14, 71.66, 72.19, 72.17, 72.11, 72.74, 72.2, 72.07, 72.26, 72.13, 72.25, 72.23, 72.45, 71.98, 72.81, 71.95, 72.18, 71.84, 72.15, 72.14]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.666, Test loss: 1.646, Test accuracy: 32.73
Round   1, Train loss: 1.321, Test loss: 1.315, Test accuracy: 43.50
Round   2, Train loss: 1.185, Test loss: 1.204, Test accuracy: 50.27
Round   3, Train loss: 1.097, Test loss: 1.129, Test accuracy: 54.61
Round   4, Train loss: 1.043, Test loss: 1.041, Test accuracy: 58.91
Round   5, Train loss: 0.999, Test loss: 1.019, Test accuracy: 60.21
Round   6, Train loss: 0.965, Test loss: 1.009, Test accuracy: 60.38
Round   7, Train loss: 0.930, Test loss: 0.949, Test accuracy: 63.38
Round   8, Train loss: 0.900, Test loss: 0.956, Test accuracy: 62.67
Round   9, Train loss: 0.870, Test loss: 0.927, Test accuracy: 63.91
Round  10, Train loss: 0.843, Test loss: 0.913, Test accuracy: 64.96
Round  11, Train loss: 0.814, Test loss: 0.895, Test accuracy: 64.79
Round  12, Train loss: 0.792, Test loss: 0.890, Test accuracy: 66.11
Round  13, Train loss: 0.768, Test loss: 0.855, Test accuracy: 67.54
Round  14, Train loss: 0.744, Test loss: 0.864, Test accuracy: 67.17
Round  15, Train loss: 0.720, Test loss: 0.841, Test accuracy: 68.23
Round  16, Train loss: 0.708, Test loss: 0.848, Test accuracy: 67.94
Round  17, Train loss: 0.686, Test loss: 0.863, Test accuracy: 67.65
Round  18, Train loss: 0.668, Test loss: 0.826, Test accuracy: 68.88
Round  19, Train loss: 0.650, Test loss: 0.826, Test accuracy: 68.94
Round  20, Train loss: 0.638, Test loss: 0.874, Test accuracy: 68.16
Round  21, Train loss: 0.565, Test loss: 0.875, Test accuracy: 68.31
Round  22, Train loss: 0.616, Test loss: 0.870, Test accuracy: 68.74
Round  23, Train loss: 0.602, Test loss: 0.854, Test accuracy: 67.98
Round  24, Train loss: 0.562, Test loss: 0.831, Test accuracy: 69.64
Round  25, Train loss: 0.509, Test loss: 0.825, Test accuracy: 69.68
Round  26, Train loss: 0.597, Test loss: 0.821, Test accuracy: 70.18
Round  27, Train loss: 0.531, Test loss: 0.800, Test accuracy: 70.79
Round  28, Train loss: 0.456, Test loss: 0.814, Test accuracy: 70.75
Round  29, Train loss: 0.589, Test loss: 0.806, Test accuracy: 70.61
Round  30, Train loss: 0.529, Test loss: 0.836, Test accuracy: 70.78
Round  31, Train loss: 0.459, Test loss: 0.849, Test accuracy: 70.07
Round  32, Train loss: 0.518, Test loss: 0.866, Test accuracy: 70.23
Round  33, Train loss: 0.517, Test loss: 0.882, Test accuracy: 70.12
Round  34, Train loss: 0.446, Test loss: 0.897, Test accuracy: 70.22
Round  35, Train loss: 0.433, Test loss: 0.867, Test accuracy: 70.54
Round  36, Train loss: 0.433, Test loss: 0.876, Test accuracy: 70.91
Round  37, Train loss: 0.447, Test loss: 0.887, Test accuracy: 71.03
Round  38, Train loss: 0.516, Test loss: 0.890, Test accuracy: 70.83
Round  39, Train loss: 0.429, Test loss: 0.921, Test accuracy: 70.62
Round  40, Train loss: 0.467, Test loss: 0.902, Test accuracy: 70.71
Round  41, Train loss: 0.368, Test loss: 0.877, Test accuracy: 70.95
Round  42, Train loss: 0.415, Test loss: 0.896, Test accuracy: 70.64
Round  43, Train loss: 0.521, Test loss: 0.901, Test accuracy: 70.71
Round  44, Train loss: 0.476, Test loss: 0.894, Test accuracy: 71.30
Round  45, Train loss: 0.336, Test loss: 0.891, Test accuracy: 71.96
Round  46, Train loss: 0.368, Test loss: 0.908, Test accuracy: 70.72
Round  47, Train loss: 0.544, Test loss: 0.937, Test accuracy: 70.53
Round  48, Train loss: 0.460, Test loss: 0.906, Test accuracy: 71.03
Round  49, Train loss: 0.370, Test loss: 0.913, Test accuracy: 71.54
Round  50, Train loss: 0.377, Test loss: 0.928, Test accuracy: 71.18
Round  51, Train loss: 0.374, Test loss: 0.919, Test accuracy: 71.12
Round  52, Train loss: 0.392, Test loss: 0.924, Test accuracy: 71.34
Round  53, Train loss: 0.381, Test loss: 0.987, Test accuracy: 70.47
Round  54, Train loss: 0.360, Test loss: 0.977, Test accuracy: 70.52
Round  55, Train loss: 0.381, Test loss: 0.973, Test accuracy: 71.28
Round  56, Train loss: 0.446, Test loss: 0.968, Test accuracy: 70.85
Round  57, Train loss: 0.317, Test loss: 0.964, Test accuracy: 71.15
Round  58, Train loss: 0.321, Test loss: 0.951, Test accuracy: 71.90
Round  59, Train loss: 0.267, Test loss: 0.923, Test accuracy: 71.73
Round  60, Train loss: 0.345, Test loss: 0.919, Test accuracy: 72.46
Round  61, Train loss: 0.277, Test loss: 0.950, Test accuracy: 71.59
Round  62, Train loss: 0.303, Test loss: 0.966, Test accuracy: 72.06
Round  63, Train loss: 0.287, Test loss: 0.962, Test accuracy: 71.75
Round  64, Train loss: 0.266, Test loss: 0.927, Test accuracy: 72.18
Round  65, Train loss: 0.319, Test loss: 0.961, Test accuracy: 71.62
Round  66, Train loss: 0.274, Test loss: 0.991, Test accuracy: 71.58
Round  67, Train loss: 0.400, Test loss: 0.987, Test accuracy: 71.80
Round  68, Train loss: 0.269, Test loss: 1.013, Test accuracy: 71.79
Round  69, Train loss: 0.388, Test loss: 1.005, Test accuracy: 72.18
Round  70, Train loss: 0.305, Test loss: 0.982, Test accuracy: 72.33
Round  71, Train loss: 0.249, Test loss: 1.040, Test accuracy: 72.70
Round  72, Train loss: 0.275, Test loss: 1.041, Test accuracy: 71.78
Round  73, Train loss: 0.300, Test loss: 1.000, Test accuracy: 71.62
Round  74, Train loss: 0.293, Test loss: 1.024, Test accuracy: 71.09
Round  75, Train loss: 0.349, Test loss: 1.043, Test accuracy: 70.73
Round  76, Train loss: 0.265, Test loss: 1.096, Test accuracy: 71.15
Round  77, Train loss: 0.232, Test loss: 1.079, Test accuracy: 71.11
Round  78, Train loss: 0.235, Test loss: 1.094, Test accuracy: 71.11
Round  79, Train loss: 0.313, Test loss: 1.088, Test accuracy: 71.50
Round  80, Train loss: 0.200, Test loss: 1.024, Test accuracy: 72.28
Round  81, Train loss: 0.174, Test loss: 1.058, Test accuracy: 72.16
Round  82, Train loss: 0.174, Test loss: 1.065, Test accuracy: 71.90
Round  83, Train loss: 0.157, Test loss: 1.092, Test accuracy: 71.68
Round  84, Train loss: 0.161, Test loss: 1.105, Test accuracy: 71.94
Round  85, Train loss: 0.147, Test loss: 1.108, Test accuracy: 71.88
Round  86, Train loss: 0.148, Test loss: 1.092, Test accuracy: 72.07
Round  87, Train loss: 0.142, Test loss: 1.111, Test accuracy: 71.94
Round  88, Train loss: 0.140, Test loss: 1.133, Test accuracy: 72.11
Round  89, Train loss: 0.138, Test loss: 1.146, Test accuracy: 71.60
Round  90, Train loss: 0.272, Test loss: 1.089, Test accuracy: 71.91
Round  91, Train loss: 0.251, Test loss: 1.096, Test accuracy: 72.35
Round  92, Train loss: 0.252, Test loss: 1.076, Test accuracy: 72.53
Round  93, Train loss: 0.243, Test loss: 1.080, Test accuracy: 72.42
Round  94, Train loss: 0.236, Test loss: 1.107, Test accuracy: 71.83
Round  95, Train loss: 0.247, Test loss: 1.103, Test accuracy: 72.02
Round  96, Train loss: 0.234, Test loss: 1.153, Test accuracy: 71.25
Round  97, Train loss: 0.235, Test loss: 1.132, Test accuracy: 71.95
Round  98, Train loss: 0.226, Test loss: 1.105, Test accuracy: 72.17
Round  99, Train loss: 0.224, Test loss: 1.137, Test accuracy: 71.85
Final Round, Train loss: 0.184, Test loss: 1.123, Test accuracy: 72.33
Average accuracy final 10 rounds: 72.028
3504.5487859249115
[2.4519879817962646, 5.114678144454956, 7.877557277679443, 10.667349576950073, 13.328525304794312, 15.92885136604309, 18.696460008621216, 21.120412588119507, 23.634066343307495, 26.158108472824097, 28.374738454818726, 30.661843299865723, 33.015872955322266, 35.32555627822876, 37.6643922328949, 39.873125314712524, 42.157435178756714, 44.522337913513184, 46.80125713348389, 49.05110311508179, 51.1872034072876, 54.875492334365845, 58.76516890525818, 62.271970987319946, 66.12618708610535, 69.65948820114136, 73.93364810943604, 78.27970719337463, 82.59184074401855, 86.87234044075012, 91.01018404960632, 95.23858952522278, 99.32943058013916, 103.3970456123352, 107.55270886421204, 111.61474180221558, 115.82958626747131, 120.07010960578918, 124.18433785438538, 128.28055357933044, 132.41480469703674, 136.7313687801361, 140.78407216072083, 144.98399829864502, 149.10766744613647, 153.09625005722046, 157.2818660736084, 161.39264678955078, 165.46229720115662, 169.340589761734, 172.8454511165619, 176.4151530265808, 180.01526260375977, 183.5947208404541, 187.28123807907104, 190.82696104049683, 194.30790972709656, 198.41770768165588, 202.55292177200317, 206.83404231071472, 211.0668284893036, 215.2270791530609, 219.35382771492004, 223.43656611442566, 227.5272159576416, 231.82707834243774, 235.9575970172882, 239.89939880371094, 243.81516790390015, 247.84556317329407, 251.6734275817871, 255.43155670166016, 259.3306550979614, 263.1768114566803, 267.32408714294434, 271.28533601760864, 275.4001364707947, 279.59852719306946, 283.88568234443665, 288.193706035614, 292.57329630851746, 296.7366716861725, 300.897558927536, 305.1086163520813, 309.40486097335815, 312.98683309555054, 316.7428741455078, 320.6866297721863, 324.5612530708313, 328.2848608493805, 332.1566298007965, 336.04506969451904, 339.6608636379242, 343.28489661216736, 347.86301136016846, 351.9255576133728, 355.3864161968231, 359.06330847740173, 362.27064847946167, 365.45888566970825, 368.9545159339905]
[32.73, 43.5, 50.27, 54.61, 58.91, 60.21, 60.38, 63.38, 62.67, 63.91, 64.96, 64.79, 66.11, 67.54, 67.17, 68.23, 67.94, 67.65, 68.88, 68.94, 68.16, 68.31, 68.74, 67.98, 69.64, 69.68, 70.18, 70.79, 70.75, 70.61, 70.78, 70.07, 70.23, 70.12, 70.22, 70.54, 70.91, 71.03, 70.83, 70.62, 70.71, 70.95, 70.64, 70.71, 71.3, 71.96, 70.72, 70.53, 71.03, 71.54, 71.18, 71.12, 71.34, 70.47, 70.52, 71.28, 70.85, 71.15, 71.9, 71.73, 72.46, 71.59, 72.06, 71.75, 72.18, 71.62, 71.58, 71.8, 71.79, 72.18, 72.33, 72.7, 71.78, 71.62, 71.09, 70.73, 71.15, 71.11, 71.11, 71.5, 72.28, 72.16, 71.9, 71.68, 71.94, 71.88, 72.07, 71.94, 72.11, 71.6, 71.91, 72.35, 72.53, 72.42, 71.83, 72.02, 71.25, 71.95, 72.17, 71.85, 72.33]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 13, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.687, Test loss: 1.646, Test accuracy: 37.11
Round   1, Train loss: 1.318, Test loss: 1.256, Test accuracy: 48.45
Round   2, Train loss: 1.162, Test loss: 1.154, Test accuracy: 52.79
Round   3, Train loss: 1.080, Test loss: 1.055, Test accuracy: 57.69
Round   4, Train loss: 1.022, Test loss: 0.996, Test accuracy: 60.77
Round   5, Train loss: 0.980, Test loss: 0.960, Test accuracy: 62.29
Round   6, Train loss: 0.936, Test loss: 0.935, Test accuracy: 64.32
Round   7, Train loss: 0.897, Test loss: 0.898, Test accuracy: 65.14
Round   8, Train loss: 0.869, Test loss: 0.902, Test accuracy: 65.31
Round   9, Train loss: 0.834, Test loss: 0.858, Test accuracy: 66.65
Round  10, Train loss: 0.811, Test loss: 0.861, Test accuracy: 66.44
Round  11, Train loss: 0.893, Test loss: 0.838, Test accuracy: 67.36
Round  12, Train loss: 0.698, Test loss: 0.820, Test accuracy: 68.11
Round  13, Train loss: 0.817, Test loss: 0.817, Test accuracy: 68.95
Round  14, Train loss: 0.712, Test loss: 0.797, Test accuracy: 70.29
Round  15, Train loss: 0.643, Test loss: 0.812, Test accuracy: 69.29
Round  16, Train loss: 0.695, Test loss: 0.808, Test accuracy: 69.39
Round  17, Train loss: 0.602, Test loss: 0.803, Test accuracy: 70.18
Round  18, Train loss: 0.671, Test loss: 0.791, Test accuracy: 70.44
Round  19, Train loss: 0.655, Test loss: 0.770, Test accuracy: 70.78
Round  20, Train loss: 0.616, Test loss: 0.775, Test accuracy: 70.93
Round  21, Train loss: 0.486, Test loss: 0.759, Test accuracy: 71.37
Round  22, Train loss: 0.604, Test loss: 0.776, Test accuracy: 70.70
Round  23, Train loss: 0.528, Test loss: 0.760, Test accuracy: 71.69
Round  24, Train loss: 0.608, Test loss: 0.746, Test accuracy: 72.08
Round  25, Train loss: 0.617, Test loss: 0.743, Test accuracy: 72.53
Round  26, Train loss: 0.471, Test loss: 0.730, Test accuracy: 73.06
Round  27, Train loss: 0.538, Test loss: 0.723, Test accuracy: 73.44
Round  28, Train loss: 0.510, Test loss: 0.729, Test accuracy: 73.28
Round  29, Train loss: 0.470, Test loss: 0.705, Test accuracy: 74.43
Round  30, Train loss: 0.568, Test loss: 0.699, Test accuracy: 74.80
Round  31, Train loss: 0.535, Test loss: 0.720, Test accuracy: 74.32
Round  32, Train loss: 0.465, Test loss: 0.720, Test accuracy: 74.69
Round  33, Train loss: 0.491, Test loss: 0.697, Test accuracy: 75.35
Round  34, Train loss: 0.350, Test loss: 0.702, Test accuracy: 74.98
Round  35, Train loss: 0.496, Test loss: 0.700, Test accuracy: 75.21
Round  36, Train loss: 0.447, Test loss: 0.726, Test accuracy: 74.39
Round  37, Train loss: 0.496, Test loss: 0.720, Test accuracy: 74.46
Round  38, Train loss: 0.617, Test loss: 0.716, Test accuracy: 74.69
Round  39, Train loss: 0.356, Test loss: 0.722, Test accuracy: 74.86
Round  40, Train loss: 0.354, Test loss: 0.706, Test accuracy: 75.67
Round  41, Train loss: 0.326, Test loss: 0.681, Test accuracy: 75.99
Round  42, Train loss: 0.424, Test loss: 0.683, Test accuracy: 75.60
Round  43, Train loss: 0.470, Test loss: 0.708, Test accuracy: 75.15
Round  44, Train loss: 0.414, Test loss: 0.703, Test accuracy: 75.36
Round  45, Train loss: 0.372, Test loss: 0.699, Test accuracy: 75.80
Round  46, Train loss: 0.390, Test loss: 0.705, Test accuracy: 75.04
Round  47, Train loss: 0.451, Test loss: 0.712, Test accuracy: 75.55
Round  48, Train loss: 0.390, Test loss: 0.693, Test accuracy: 75.90
Round  49, Train loss: 0.379, Test loss: 0.714, Test accuracy: 75.27
Round  50, Train loss: 0.314, Test loss: 0.713, Test accuracy: 75.90
Round  51, Train loss: 0.325, Test loss: 0.717, Test accuracy: 75.49
Round  52, Train loss: 0.418, Test loss: 0.759, Test accuracy: 73.92
Round  53, Train loss: 0.428, Test loss: 0.733, Test accuracy: 75.02
Round  54, Train loss: 0.352, Test loss: 0.748, Test accuracy: 74.66
Round  55, Train loss: 0.365, Test loss: 0.725, Test accuracy: 75.05
Round  56, Train loss: 0.323, Test loss: 0.716, Test accuracy: 75.71
Round  57, Train loss: 0.397, Test loss: 0.733, Test accuracy: 75.42
Round  58, Train loss: 0.394, Test loss: 0.729, Test accuracy: 75.55
Round  59, Train loss: 0.354, Test loss: 0.740, Test accuracy: 75.22
Round  60, Train loss: 0.309, Test loss: 0.739, Test accuracy: 75.31
Round  61, Train loss: 0.246, Test loss: 0.726, Test accuracy: 75.51
Round  62, Train loss: 0.263, Test loss: 0.760, Test accuracy: 74.90
Round  63, Train loss: 0.339, Test loss: 0.748, Test accuracy: 75.12
Round  64, Train loss: 0.257, Test loss: 0.727, Test accuracy: 75.76
Round  65, Train loss: 0.309, Test loss: 0.726, Test accuracy: 75.83
Round  66, Train loss: 0.250, Test loss: 0.719, Test accuracy: 75.97
Round  67, Train loss: 0.270, Test loss: 0.718, Test accuracy: 76.15
Round  68, Train loss: 0.303, Test loss: 0.729, Test accuracy: 76.12
Round  69, Train loss: 0.340, Test loss: 0.720, Test accuracy: 76.27
Round  70, Train loss: 0.337, Test loss: 0.709, Test accuracy: 76.92
Round  71, Train loss: 0.264, Test loss: 0.713, Test accuracy: 76.48
Round  72, Train loss: 0.298, Test loss: 0.737, Test accuracy: 75.66
Round  73, Train loss: 0.292, Test loss: 0.748, Test accuracy: 76.02
Round  74, Train loss: 0.279, Test loss: 0.750, Test accuracy: 75.53
Round  75, Train loss: 0.288, Test loss: 0.762, Test accuracy: 75.46
Round  76, Train loss: 0.224, Test loss: 0.768, Test accuracy: 75.37
Round  77, Train loss: 0.192, Test loss: 0.756, Test accuracy: 75.37
Round  78, Train loss: 0.227, Test loss: 0.756, Test accuracy: 75.24
Round  79, Train loss: 0.209, Test loss: 0.754, Test accuracy: 75.22
Round  80, Train loss: 0.162, Test loss: 0.730, Test accuracy: 76.08
Round  81, Train loss: 0.152, Test loss: 0.754, Test accuracy: 75.56
Round  82, Train loss: 0.149, Test loss: 0.754, Test accuracy: 75.66
Round  83, Train loss: 0.140, Test loss: 0.754, Test accuracy: 75.93
Round  84, Train loss: 0.134, Test loss: 0.759, Test accuracy: 75.73
Round  85, Train loss: 0.134, Test loss: 0.771, Test accuracy: 75.49
Round  86, Train loss: 0.127, Test loss: 0.763, Test accuracy: 75.75
Round  87, Train loss: 0.115, Test loss: 0.762, Test accuracy: 75.94
Round  88, Train loss: 0.121, Test loss: 0.763, Test accuracy: 75.57
Round  89, Train loss: 0.116, Test loss: 0.764, Test accuracy: 75.86
Round  90, Train loss: 0.254, Test loss: 0.739, Test accuracy: 76.69
Round  91, Train loss: 0.245, Test loss: 0.746, Test accuracy: 76.61
Round  92, Train loss: 0.238, Test loss: 0.751, Test accuracy: 76.63
Round  93, Train loss: 0.229, Test loss: 0.752, Test accuracy: 76.53
Round  94, Train loss: 0.227, Test loss: 0.758, Test accuracy: 76.02
Round  95, Train loss: 0.230, Test loss: 0.759, Test accuracy: 76.43
Round  96, Train loss: 0.222, Test loss: 0.768, Test accuracy: 76.08
Round  97, Train loss: 0.215, Test loss: 0.760, Test accuracy: 76.51
Round  98, Train loss: 0.214, Test loss: 0.765, Test accuracy: 76.27
Round  99, Train loss: 0.211, Test loss: 0.787, Test accuracy: 76.31
Final Round, Train loss: 0.182, Test loss: 0.775, Test accuracy: 76.52
Average accuracy final 10 rounds: 76.408
3429.3563084602356
[2.8502824306488037, 5.401220321655273, 7.9566755294799805, 10.610754251480103, 13.148231506347656, 15.413892030715942, 17.688796997070312, 19.962862253189087, 22.23042607307434, 24.504138469696045, 26.776000022888184, 29.04229164123535, 31.314876079559326, 33.57197856903076, 35.83427357673645, 38.0985152721405, 40.36482381820679, 42.626425981521606, 44.88520264625549, 47.1452853679657, 49.68073129653931, 53.735575437545776, 57.78139853477478, 61.77807092666626, 65.71518778800964, 69.77224397659302, 73.83676624298096, 77.89891767501831, 81.96052932739258, 86.03642296791077, 90.09376764297485, 94.1533637046814, 98.22629570960999, 102.37932062149048, 106.44999861717224, 110.50669836997986, 114.56240892410278, 118.62418913841248, 122.68977046012878, 126.64266109466553, 130.58071756362915, 134.50859117507935, 138.54612135887146, 142.606920003891, 146.6695795059204, 150.73077821731567, 154.78293561935425, 158.834290266037, 162.88697719573975, 166.9479238986969, 170.9973659515381, 175.05326175689697, 178.9850480556488, 182.91294527053833, 186.8360345363617, 190.7578740119934, 194.82327151298523, 198.9399971961975, 203.00745463371277, 206.7900276184082, 210.58477592468262, 214.36020755767822, 218.12264108657837, 221.9227011203766, 225.66044354438782, 229.43862318992615, 233.20129323005676, 236.99378371238708, 240.80024123191833, 244.57843041419983, 248.36330151557922, 252.1065695285797, 255.84923720359802, 259.61442494392395, 263.36064410209656, 267.1006588935852, 270.91571378707886, 274.66311144828796, 278.40430545806885, 282.1427218914032, 285.89252829551697, 289.64031505584717, 293.3852415084839, 297.13042402267456, 300.87543988227844, 304.61655473709106, 308.3546245098114, 312.10382056236267, 315.85469794273376, 319.64024233818054, 323.44637417793274, 327.2281973361969, 330.9892632961273, 334.7681829929352, 338.53778767585754, 342.34614396095276, 346.13029313087463, 349.91145157814026, 353.7218985557556, 357.50261521339417, 361.2223823070526]
[37.11, 48.45, 52.79, 57.69, 60.77, 62.29, 64.32, 65.14, 65.31, 66.65, 66.44, 67.36, 68.11, 68.95, 70.29, 69.29, 69.39, 70.18, 70.44, 70.78, 70.93, 71.37, 70.7, 71.69, 72.08, 72.53, 73.06, 73.44, 73.28, 74.43, 74.8, 74.32, 74.69, 75.35, 74.98, 75.21, 74.39, 74.46, 74.69, 74.86, 75.67, 75.99, 75.6, 75.15, 75.36, 75.8, 75.04, 75.55, 75.9, 75.27, 75.9, 75.49, 73.92, 75.02, 74.66, 75.05, 75.71, 75.42, 75.55, 75.22, 75.31, 75.51, 74.9, 75.12, 75.76, 75.83, 75.97, 76.15, 76.12, 76.27, 76.92, 76.48, 75.66, 76.02, 75.53, 75.46, 75.37, 75.37, 75.24, 75.22, 76.08, 75.56, 75.66, 75.93, 75.73, 75.49, 75.75, 75.94, 75.57, 75.86, 76.69, 76.61, 76.63, 76.53, 76.02, 76.43, 76.08, 76.51, 76.27, 76.31, 76.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.707, Test loss: 2.050, Test accuracy: 20.28
Round   0, Global train loss: 1.707, Global test loss: 2.256, Global test accuracy: 16.26
Round   1, Train loss: 1.603, Test loss: 1.790, Test accuracy: 26.48
Round   1, Global train loss: 1.603, Global test loss: 2.190, Global test accuracy: 16.99
Round   2, Train loss: 1.439, Test loss: 1.579, Test accuracy: 36.18
Round   2, Global train loss: 1.439, Global test loss: 2.138, Global test accuracy: 25.06
Round   3, Train loss: 1.477, Test loss: 1.531, Test accuracy: 36.88
Round   3, Global train loss: 1.477, Global test loss: 2.166, Global test accuracy: 22.82
Round   4, Train loss: 1.485, Test loss: 1.398, Test accuracy: 42.75
Round   4, Global train loss: 1.485, Global test loss: 2.096, Global test accuracy: 23.09
Round   5, Train loss: 1.458, Test loss: 1.380, Test accuracy: 43.95
Round   5, Global train loss: 1.458, Global test loss: 2.146, Global test accuracy: 24.73
Round   6, Train loss: 1.533, Test loss: 1.364, Test accuracy: 45.44
Round   6, Global train loss: 1.533, Global test loss: 2.224, Global test accuracy: 15.33
Round   7, Train loss: 1.300, Test loss: 1.311, Test accuracy: 47.36
Round   7, Global train loss: 1.300, Global test loss: 2.058, Global test accuracy: 28.93
Round   8, Train loss: 1.374, Test loss: 1.296, Test accuracy: 48.39
Round   8, Global train loss: 1.374, Global test loss: 2.102, Global test accuracy: 28.63
Round   9, Train loss: 1.392, Test loss: 1.287, Test accuracy: 48.28
Round   9, Global train loss: 1.392, Global test loss: 2.081, Global test accuracy: 29.88
Round  10, Train loss: 1.295, Test loss: 1.274, Test accuracy: 49.41
Round  10, Global train loss: 1.295, Global test loss: 2.033, Global test accuracy: 26.14
Round  11, Train loss: 1.165, Test loss: 1.250, Test accuracy: 50.01
Round  11, Global train loss: 1.165, Global test loss: 2.028, Global test accuracy: 29.95
Round  12, Train loss: 1.208, Test loss: 1.237, Test accuracy: 51.01
Round  12, Global train loss: 1.208, Global test loss: 2.111, Global test accuracy: 22.25
Round  13, Train loss: 1.198, Test loss: 1.224, Test accuracy: 51.86
Round  13, Global train loss: 1.198, Global test loss: 1.969, Global test accuracy: 33.06
Round  14, Train loss: 1.202, Test loss: 1.215, Test accuracy: 52.44
Round  14, Global train loss: 1.202, Global test loss: 2.204, Global test accuracy: 23.88
Round  15, Train loss: 1.276, Test loss: 1.211, Test accuracy: 52.71
Round  15, Global train loss: 1.276, Global test loss: 2.162, Global test accuracy: 25.58
Round  16, Train loss: 1.239, Test loss: 1.212, Test accuracy: 52.72
Round  16, Global train loss: 1.239, Global test loss: 2.065, Global test accuracy: 23.78
Round  17, Train loss: 1.237, Test loss: 1.211, Test accuracy: 52.14
Round  17, Global train loss: 1.237, Global test loss: 2.047, Global test accuracy: 29.38
Round  18, Train loss: 1.234, Test loss: 1.220, Test accuracy: 52.06
Round  18, Global train loss: 1.234, Global test loss: 1.977, Global test accuracy: 31.44
Round  19, Train loss: 0.968, Test loss: 1.220, Test accuracy: 52.61
Round  19, Global train loss: 0.968, Global test loss: 1.992, Global test accuracy: 35.12
Round  20, Train loss: 1.273, Test loss: 1.220, Test accuracy: 52.63
Round  20, Global train loss: 1.273, Global test loss: 1.972, Global test accuracy: 35.74
Round  21, Train loss: 1.059, Test loss: 1.217, Test accuracy: 52.77
Round  21, Global train loss: 1.059, Global test loss: 2.033, Global test accuracy: 22.52
Round  22, Train loss: 1.358, Test loss: 1.198, Test accuracy: 53.53
Round  22, Global train loss: 1.358, Global test loss: 2.154, Global test accuracy: 17.76
Round  23, Train loss: 0.939, Test loss: 1.214, Test accuracy: 53.60
Round  23, Global train loss: 0.939, Global test loss: 1.980, Global test accuracy: 30.65
Round  24, Train loss: 1.152, Test loss: 1.215, Test accuracy: 53.54
Round  24, Global train loss: 1.152, Global test loss: 2.122, Global test accuracy: 24.36
Round  25, Train loss: 0.958, Test loss: 1.222, Test accuracy: 53.89
Round  25, Global train loss: 0.958, Global test loss: 2.115, Global test accuracy: 26.62
Round  26, Train loss: 1.006, Test loss: 1.242, Test accuracy: 53.61
Round  26, Global train loss: 1.006, Global test loss: 2.004, Global test accuracy: 34.81
Round  27, Train loss: 1.033, Test loss: 1.233, Test accuracy: 54.27
Round  27, Global train loss: 1.033, Global test loss: 2.072, Global test accuracy: 22.97
Round  28, Train loss: 1.059, Test loss: 1.234, Test accuracy: 54.80
Round  28, Global train loss: 1.059, Global test loss: 2.069, Global test accuracy: 30.32
Round  29, Train loss: 0.891, Test loss: 1.238, Test accuracy: 55.00
Round  29, Global train loss: 0.891, Global test loss: 1.932, Global test accuracy: 33.48
Round  30, Train loss: 1.111, Test loss: 1.242, Test accuracy: 54.55
Round  30, Global train loss: 1.111, Global test loss: 2.129, Global test accuracy: 27.70
Round  31, Train loss: 0.973, Test loss: 1.242, Test accuracy: 54.79
Round  31, Global train loss: 0.973, Global test loss: 2.066, Global test accuracy: 22.85
Round  32, Train loss: 1.171, Test loss: 1.255, Test accuracy: 54.57
Round  32, Global train loss: 1.171, Global test loss: 2.087, Global test accuracy: 29.62
Round  33, Train loss: 0.870, Test loss: 1.265, Test accuracy: 54.78
Round  33, Global train loss: 0.870, Global test loss: 1.908, Global test accuracy: 37.30
Round  34, Train loss: 0.900, Test loss: 1.266, Test accuracy: 54.76
Round  34, Global train loss: 0.900, Global test loss: 2.029, Global test accuracy: 26.96
Round  35, Train loss: 0.933, Test loss: 1.275, Test accuracy: 54.94
Round  35, Global train loss: 0.933, Global test loss: 2.125, Global test accuracy: 22.83
Round  36, Train loss: 0.799, Test loss: 1.308, Test accuracy: 54.64
Round  36, Global train loss: 0.799, Global test loss: 2.108, Global test accuracy: 24.36
Round  37, Train loss: 0.825, Test loss: 1.323, Test accuracy: 54.59
Round  37, Global train loss: 0.825, Global test loss: 2.069, Global test accuracy: 28.05
Round  38, Train loss: 0.662, Test loss: 1.309, Test accuracy: 54.51
Round  38, Global train loss: 0.662, Global test loss: 1.954, Global test accuracy: 33.10
Round  39, Train loss: 0.711, Test loss: 1.335, Test accuracy: 54.76
Round  39, Global train loss: 0.711, Global test loss: 2.025, Global test accuracy: 27.33
Round  40, Train loss: 0.759, Test loss: 1.370, Test accuracy: 54.39
Round  40, Global train loss: 0.759, Global test loss: 2.128, Global test accuracy: 21.81
Round  41, Train loss: 0.752, Test loss: 1.399, Test accuracy: 54.45
Round  41, Global train loss: 0.752, Global test loss: 2.100, Global test accuracy: 20.53
Round  42, Train loss: 0.954, Test loss: 1.388, Test accuracy: 54.11
Round  42, Global train loss: 0.954, Global test loss: 2.091, Global test accuracy: 28.84
Round  43, Train loss: 0.584, Test loss: 1.403, Test accuracy: 54.20
Round  43, Global train loss: 0.584, Global test loss: 1.942, Global test accuracy: 35.61
Round  44, Train loss: 0.603, Test loss: 1.398, Test accuracy: 54.08
Round  44, Global train loss: 0.603, Global test loss: 2.026, Global test accuracy: 25.90
Round  45, Train loss: 0.977, Test loss: 1.418, Test accuracy: 54.21
Round  45, Global train loss: 0.977, Global test loss: 2.124, Global test accuracy: 25.00
Round  46, Train loss: 0.661, Test loss: 1.472, Test accuracy: 54.26
Round  46, Global train loss: 0.661, Global test loss: 1.961, Global test accuracy: 30.25
Round  47, Train loss: 0.565, Test loss: 1.475, Test accuracy: 54.56
Round  47, Global train loss: 0.565, Global test loss: 1.972, Global test accuracy: 26.34
Round  48, Train loss: 0.469, Test loss: 1.500, Test accuracy: 54.28
Round  48, Global train loss: 0.469, Global test loss: 2.073, Global test accuracy: 26.49
Round  49, Train loss: 0.682, Test loss: 1.516, Test accuracy: 53.86
Round  49, Global train loss: 0.682, Global test loss: 2.007, Global test accuracy: 27.23
Round  50, Train loss: 0.839, Test loss: 1.534, Test accuracy: 53.12
Round  50, Global train loss: 0.839, Global test loss: 2.169, Global test accuracy: 20.44
Round  51, Train loss: 0.688, Test loss: 1.538, Test accuracy: 53.23
Round  51, Global train loss: 0.688, Global test loss: 2.047, Global test accuracy: 25.41
Round  52, Train loss: 0.666, Test loss: 1.571, Test accuracy: 52.88
Round  52, Global train loss: 0.666, Global test loss: 2.036, Global test accuracy: 26.70
Round  53, Train loss: 0.492, Test loss: 1.610, Test accuracy: 52.66
Round  53, Global train loss: 0.492, Global test loss: 1.961, Global test accuracy: 33.75
Round  54, Train loss: 0.643, Test loss: 1.623, Test accuracy: 53.31
Round  54, Global train loss: 0.643, Global test loss: 2.134, Global test accuracy: 20.87
Round  55, Train loss: 0.508, Test loss: 1.647, Test accuracy: 53.04
Round  55, Global train loss: 0.508, Global test loss: 1.955, Global test accuracy: 36.11
Round  56, Train loss: 0.442, Test loss: 1.698, Test accuracy: 52.81
Round  56, Global train loss: 0.442, Global test loss: 1.998, Global test accuracy: 25.71
Round  57, Train loss: 0.498, Test loss: 1.687, Test accuracy: 52.45
Round  57, Global train loss: 0.498, Global test loss: 1.944, Global test accuracy: 31.29
Round  58, Train loss: 0.697, Test loss: 1.714, Test accuracy: 52.78
Round  58, Global train loss: 0.697, Global test loss: 2.145, Global test accuracy: 25.36
Round  59, Train loss: 0.584, Test loss: 1.724, Test accuracy: 52.58
Round  59, Global train loss: 0.584, Global test loss: 2.055, Global test accuracy: 26.88
Round  60, Train loss: 0.334, Test loss: 1.797, Test accuracy: 52.02
Round  60, Global train loss: 0.334, Global test loss: 2.125, Global test accuracy: 25.11
Round  61, Train loss: 0.360, Test loss: 1.805, Test accuracy: 52.30
Round  61, Global train loss: 0.360, Global test loss: 1.944, Global test accuracy: 32.98
Round  62, Train loss: 0.309, Test loss: 1.820, Test accuracy: 52.65
Round  62, Global train loss: 0.309, Global test loss: 2.057, Global test accuracy: 27.55
Round  63, Train loss: 0.556, Test loss: 1.862, Test accuracy: 52.57
Round  63, Global train loss: 0.556, Global test loss: 2.066, Global test accuracy: 27.63
Round  64, Train loss: 0.311, Test loss: 1.886, Test accuracy: 52.73
Round  64, Global train loss: 0.311, Global test loss: 1.948, Global test accuracy: 33.77
Round  65, Train loss: 0.439, Test loss: 1.916, Test accuracy: 52.23
Round  65, Global train loss: 0.439, Global test loss: 2.042, Global test accuracy: 28.37
Round  66, Train loss: 0.492, Test loss: 1.918, Test accuracy: 52.97
Round  66, Global train loss: 0.492, Global test loss: 2.068, Global test accuracy: 27.69
Round  67, Train loss: 0.303, Test loss: 1.933, Test accuracy: 52.60
Round  67, Global train loss: 0.303, Global test loss: 2.007, Global test accuracy: 27.13
Round  68, Train loss: 0.553, Test loss: 1.994, Test accuracy: 51.75
Round  68, Global train loss: 0.553, Global test loss: 2.138, Global test accuracy: 22.15
Round  69, Train loss: 0.440, Test loss: 1.972, Test accuracy: 51.82
Round  69, Global train loss: 0.440, Global test loss: 2.134, Global test accuracy: 25.39
Round  70, Train loss: 0.394, Test loss: 1.997, Test accuracy: 52.20
Round  70, Global train loss: 0.394, Global test loss: 2.169, Global test accuracy: 15.97
Round  71, Train loss: 0.327, Test loss: 2.012, Test accuracy: 52.15
Round  71, Global train loss: 0.327, Global test loss: 2.073, Global test accuracy: 24.94
Round  72, Train loss: 0.353, Test loss: 2.027, Test accuracy: 52.16
Round  72, Global train loss: 0.353, Global test loss: 1.961, Global test accuracy: 28.47
Round  73, Train loss: 0.382, Test loss: 2.052, Test accuracy: 52.31
Round  73, Global train loss: 0.382, Global test loss: 2.151, Global test accuracy: 20.74
Round  74, Train loss: 0.273, Test loss: 2.090, Test accuracy: 51.96
Round  74, Global train loss: 0.273, Global test loss: 2.056, Global test accuracy: 24.42
Round  75, Train loss: 0.328, Test loss: 2.058, Test accuracy: 52.39
Round  75, Global train loss: 0.328, Global test loss: 2.127, Global test accuracy: 21.66
Round  76, Train loss: 0.330, Test loss: 2.098, Test accuracy: 52.02
Round  76, Global train loss: 0.330, Global test loss: 2.058, Global test accuracy: 28.85
Round  77, Train loss: 0.285, Test loss: 2.114, Test accuracy: 52.35
Round  77, Global train loss: 0.285, Global test loss: 1.967, Global test accuracy: 34.89
Round  78, Train loss: 0.254, Test loss: 2.177, Test accuracy: 52.13
Round  78, Global train loss: 0.254, Global test loss: 2.042, Global test accuracy: 26.25
Round  79, Train loss: 0.272, Test loss: 2.180, Test accuracy: 53.06
Round  79, Global train loss: 0.272, Global test loss: 1.939, Global test accuracy: 29.83
Round  80, Train loss: 0.483, Test loss: 2.218, Test accuracy: 52.14
Round  80, Global train loss: 0.483, Global test loss: 2.082, Global test accuracy: 26.50
Round  81, Train loss: 0.301, Test loss: 2.248, Test accuracy: 51.84
Round  81, Global train loss: 0.301, Global test loss: 2.005, Global test accuracy: 30.06
Round  82, Train loss: 0.407, Test loss: 2.248, Test accuracy: 51.55
Round  82, Global train loss: 0.407, Global test loss: 2.075, Global test accuracy: 24.72
Round  83, Train loss: 0.278, Test loss: 2.294, Test accuracy: 51.40
Round  83, Global train loss: 0.278, Global test loss: 2.128, Global test accuracy: 26.95
Round  84, Train loss: 0.271, Test loss: 2.325, Test accuracy: 51.35
Round  84, Global train loss: 0.271, Global test loss: 2.029, Global test accuracy: 31.32
Round  85, Train loss: 0.321, Test loss: 2.327, Test accuracy: 51.29
Round  85, Global train loss: 0.321, Global test loss: 2.134, Global test accuracy: 22.79
Round  86, Train loss: 0.265, Test loss: 2.345, Test accuracy: 51.41
Round  86, Global train loss: 0.265, Global test loss: 2.156, Global test accuracy: 20.35
Round  87, Train loss: 0.193, Test loss: 2.303, Test accuracy: 51.35
Round  87, Global train loss: 0.193, Global test loss: 2.051, Global test accuracy: 23.79
Round  88, Train loss: 0.302, Test loss: 2.326, Test accuracy: 51.52
Round  88, Global train loss: 0.302, Global test loss: 1.990, Global test accuracy: 27.99
Round  89, Train loss: 0.168, Test loss: 2.367, Test accuracy: 51.03
Round  89, Global train loss: 0.168, Global test loss: 1.890, Global test accuracy: 32.84
Round  90, Train loss: 0.206, Test loss: 2.394, Test accuracy: 51.17
Round  90, Global train loss: 0.206, Global test loss: 1.977, Global test accuracy: 26.26
Round  91, Train loss: 0.244, Test loss: 2.424, Test accuracy: 51.43
Round  91, Global train loss: 0.244, Global test loss: 1.977, Global test accuracy: 30.29
Round  92, Train loss: 0.204, Test loss: 2.481, Test accuracy: 51.30
Round  92, Global train loss: 0.204, Global test loss: 2.170, Global test accuracy: 16.74
Round  93, Train loss: 0.204, Test loss: 2.545, Test accuracy: 51.03
Round  93, Global train loss: 0.204, Global test loss: 2.084, Global test accuracy: 24.21
Round  94, Train loss: 0.220, Test loss: 2.532, Test accuracy: 51.13
Round  94, Global train loss: 0.220, Global test loss: 2.119, Global test accuracy: 19.37
Round  95, Train loss: 0.215, Test loss: 2.581, Test accuracy: 51.14
Round  95, Global train loss: 0.215, Global test loss: 2.120, Global test accuracy: 23.14
Round  96, Train loss: 0.225, Test loss: 2.584, Test accuracy: 51.18
Round  96, Global train loss: 0.225, Global test loss: 1.950, Global test accuracy: 31.82
Round  97, Train loss: 0.257, Test loss: 2.538, Test accuracy: 51.28
Round  97, Global train loss: 0.257, Global test loss: 2.051, Global test accuracy: 28.22
Round  98, Train loss: 0.178, Test loss: 2.551, Test accuracy: 51.87
Round  98, Global train loss: 0.178, Global test loss: 2.011, Global test accuracy: 29.11
Round  99, Train loss: 0.244, Test loss: 2.572, Test accuracy: 51.28
Round  99, Global train loss: 0.244, Global test loss: 2.025, Global test accuracy: 29.62
Final Round, Train loss: 0.200, Test loss: 2.741, Test accuracy: 51.74
Final Round, Global train loss: 0.200, Global test loss: 2.025, Global test accuracy: 29.62
Average accuracy final 10 rounds: 51.281 

Average global accuracy final 10 rounds: 25.878 

1358.998471736908
[1.3930325508117676, 2.786065101623535, 3.9059324264526367, 5.025799751281738, 6.155474901199341, 7.285150051116943, 8.410687446594238, 9.536224842071533, 10.653093338012695, 11.769961833953857, 12.881831884384155, 13.993701934814453, 15.130563497543335, 16.267425060272217, 17.40238618850708, 18.537347316741943, 19.62191605567932, 20.7064847946167, 21.74954319000244, 22.792601585388184, 23.892086029052734, 24.991570472717285, 26.100994348526, 27.210418224334717, 28.301857233047485, 29.393296241760254, 30.48882555961609, 31.584354877471924, 32.688791036605835, 33.793227195739746, 34.899561166763306, 36.005895137786865, 37.09397530555725, 38.18205547332764, 39.290863275527954, 40.39967107772827, 41.51181387901306, 42.62395668029785, 43.73598575592041, 44.84801483154297, 45.95605397224426, 47.06409311294556, 48.175148487091064, 49.28620386123657, 50.3975031375885, 51.50880241394043, 52.62439203262329, 53.73998165130615, 54.859395265579224, 55.978808879852295, 57.08906412124634, 58.19931936264038, 59.30765414237976, 60.41598892211914, 61.530478954315186, 62.64496898651123, 63.75311636924744, 64.86126375198364, 65.96945643424988, 67.07764911651611, 68.18349719047546, 69.28934526443481, 70.39706420898438, 71.50478315353394, 72.62070345878601, 73.73662376403809, 74.84741234779358, 75.95820093154907, 77.06464076042175, 78.17108058929443, 79.27582335472107, 80.3805661201477, 81.48766469955444, 82.59476327896118, 83.70270204544067, 84.81064081192017, 85.91762828826904, 87.02461576461792, 88.12983679771423, 89.23505783081055, 90.35524082183838, 91.47542381286621, 92.588871717453, 93.7023196220398, 94.79072451591492, 95.87912940979004, 96.98572850227356, 98.09232759475708, 99.1863944530487, 100.28046131134033, 101.37161421775818, 102.46276712417603, 103.56121468544006, 104.6596622467041, 105.75757765769958, 106.85549306869507, 107.95878100395203, 109.06206893920898, 110.15295791625977, 111.24384689331055, 112.47420310974121, 113.70455932617188, 114.86372113227844, 116.02288293838501, 117.24588370323181, 118.46888446807861, 119.65479040145874, 120.84069633483887, 122.0147819519043, 123.18886756896973, 124.3749189376831, 125.56097030639648, 126.69653391838074, 127.83209753036499, 128.9711811542511, 130.1102647781372, 131.2395715713501, 132.368878364563, 133.51649117469788, 134.66410398483276, 135.79651021957397, 136.92891645431519, 138.08999705314636, 139.25107765197754, 140.36695337295532, 141.4828290939331, 142.67697477340698, 143.87112045288086, 145.06400513648987, 146.25688982009888, 147.45295667648315, 148.64902353286743, 149.88926553726196, 151.1295075416565, 152.3134024143219, 153.4972972869873, 154.53494834899902, 155.57259941101074, 156.61793756484985, 157.66327571868896, 158.74275135993958, 159.82222700119019, 160.89733982086182, 161.97245264053345, 163.01421904563904, 164.05598545074463, 165.09911847114563, 166.14225149154663, 167.19398593902588, 168.24572038650513, 169.28739714622498, 170.32907390594482, 171.3843297958374, 172.43958568572998, 173.47189378738403, 174.5042018890381, 175.5905830860138, 176.6769642829895, 177.71537494659424, 178.75378561019897, 179.79090905189514, 180.8280324935913, 181.86953568458557, 182.91103887557983, 183.95152044296265, 184.99200201034546, 186.03131699562073, 187.070631980896, 188.1066436767578, 189.14265537261963, 190.17876601219177, 191.21487665176392, 192.25187802314758, 193.28887939453125, 194.3298840522766, 195.37088871002197, 196.55867648124695, 197.74646425247192, 198.9605667591095, 200.17466926574707, 201.24624228477478, 202.3178153038025, 203.53229212760925, 204.74676895141602, 205.91828203201294, 207.08979511260986, 208.26470637321472, 209.43961763381958, 210.6090805530548, 211.77854347229004, 212.82942366600037, 213.8803038597107, 214.94655966758728, 216.01281547546387, 217.05260276794434, 218.0923900604248, 219.12284636497498, 220.15330266952515, 221.1860740184784, 222.21884536743164, 224.58886623382568, 226.95888710021973]
[20.28, 20.28, 26.48, 26.48, 36.18, 36.18, 36.88, 36.88, 42.75, 42.75, 43.95, 43.95, 45.44, 45.44, 47.36, 47.36, 48.39, 48.39, 48.28, 48.28, 49.41, 49.41, 50.01, 50.01, 51.01, 51.01, 51.86, 51.86, 52.44, 52.44, 52.71, 52.71, 52.72, 52.72, 52.14, 52.14, 52.06, 52.06, 52.61, 52.61, 52.63, 52.63, 52.77, 52.77, 53.53, 53.53, 53.6, 53.6, 53.54, 53.54, 53.89, 53.89, 53.61, 53.61, 54.27, 54.27, 54.8, 54.8, 55.0, 55.0, 54.55, 54.55, 54.79, 54.79, 54.57, 54.57, 54.78, 54.78, 54.76, 54.76, 54.94, 54.94, 54.64, 54.64, 54.59, 54.59, 54.51, 54.51, 54.76, 54.76, 54.39, 54.39, 54.45, 54.45, 54.11, 54.11, 54.2, 54.2, 54.08, 54.08, 54.21, 54.21, 54.26, 54.26, 54.56, 54.56, 54.28, 54.28, 53.86, 53.86, 53.12, 53.12, 53.23, 53.23, 52.88, 52.88, 52.66, 52.66, 53.31, 53.31, 53.04, 53.04, 52.81, 52.81, 52.45, 52.45, 52.78, 52.78, 52.58, 52.58, 52.02, 52.02, 52.3, 52.3, 52.65, 52.65, 52.57, 52.57, 52.73, 52.73, 52.23, 52.23, 52.97, 52.97, 52.6, 52.6, 51.75, 51.75, 51.82, 51.82, 52.2, 52.2, 52.15, 52.15, 52.16, 52.16, 52.31, 52.31, 51.96, 51.96, 52.39, 52.39, 52.02, 52.02, 52.35, 52.35, 52.13, 52.13, 53.06, 53.06, 52.14, 52.14, 51.84, 51.84, 51.55, 51.55, 51.4, 51.4, 51.35, 51.35, 51.29, 51.29, 51.41, 51.41, 51.35, 51.35, 51.52, 51.52, 51.03, 51.03, 51.17, 51.17, 51.43, 51.43, 51.3, 51.3, 51.03, 51.03, 51.13, 51.13, 51.14, 51.14, 51.18, 51.18, 51.28, 51.28, 51.87, 51.87, 51.28, 51.28, 51.74, 51.74]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 13, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.643, Test loss: 2.003, Test accuracy: 25.87
Round   0, Global train loss: 1.643, Global test loss: 2.213, Global test accuracy: 21.27
Round   1, Train loss: 1.554, Test loss: 1.752, Test accuracy: 32.39
Round   1, Global train loss: 1.554, Global test loss: 2.148, Global test accuracy: 22.51
Round   2, Train loss: 1.339, Test loss: 1.479, Test accuracy: 41.99
Round   2, Global train loss: 1.339, Global test loss: 1.982, Global test accuracy: 30.02
Round   3, Train loss: 1.335, Test loss: 1.398, Test accuracy: 44.64
Round   3, Global train loss: 1.335, Global test loss: 1.889, Global test accuracy: 31.68
Round   4, Train loss: 1.314, Test loss: 1.256, Test accuracy: 50.31
Round   4, Global train loss: 1.314, Global test loss: 1.726, Global test accuracy: 38.61
Round   5, Train loss: 1.176, Test loss: 1.225, Test accuracy: 52.24
Round   5, Global train loss: 1.176, Global test loss: 1.724, Global test accuracy: 38.83
Round   6, Train loss: 1.216, Test loss: 1.178, Test accuracy: 54.47
Round   6, Global train loss: 1.216, Global test loss: 1.698, Global test accuracy: 38.99
Round   7, Train loss: 1.114, Test loss: 1.119, Test accuracy: 55.88
Round   7, Global train loss: 1.114, Global test loss: 1.661, Global test accuracy: 41.11
Round   8, Train loss: 1.022, Test loss: 1.108, Test accuracy: 56.29
Round   8, Global train loss: 1.022, Global test loss: 1.612, Global test accuracy: 43.74
Round   9, Train loss: 1.165, Test loss: 1.108, Test accuracy: 56.36
Round   9, Global train loss: 1.165, Global test loss: 1.511, Global test accuracy: 45.70
Round  10, Train loss: 1.121, Test loss: 1.083, Test accuracy: 57.62
Round  10, Global train loss: 1.121, Global test loss: 1.491, Global test accuracy: 47.97
Round  11, Train loss: 1.044, Test loss: 1.057, Test accuracy: 59.20
Round  11, Global train loss: 1.044, Global test loss: 1.447, Global test accuracy: 49.74
Round  12, Train loss: 1.014, Test loss: 1.030, Test accuracy: 60.28
Round  12, Global train loss: 1.014, Global test loss: 1.484, Global test accuracy: 47.56
Round  13, Train loss: 1.034, Test loss: 1.004, Test accuracy: 61.93
Round  13, Global train loss: 1.034, Global test loss: 1.487, Global test accuracy: 47.25
Round  14, Train loss: 1.019, Test loss: 1.004, Test accuracy: 61.85
Round  14, Global train loss: 1.019, Global test loss: 1.479, Global test accuracy: 47.65
Round  15, Train loss: 1.027, Test loss: 1.003, Test accuracy: 62.07
Round  15, Global train loss: 1.027, Global test loss: 1.488, Global test accuracy: 45.88
Round  16, Train loss: 0.961, Test loss: 1.008, Test accuracy: 61.92
Round  16, Global train loss: 0.961, Global test loss: 1.484, Global test accuracy: 47.01
Round  17, Train loss: 0.996, Test loss: 1.011, Test accuracy: 62.26
Round  17, Global train loss: 0.996, Global test loss: 1.475, Global test accuracy: 48.85
Round  18, Train loss: 0.981, Test loss: 1.000, Test accuracy: 62.71
Round  18, Global train loss: 0.981, Global test loss: 1.348, Global test accuracy: 52.39
Round  19, Train loss: 0.835, Test loss: 0.990, Test accuracy: 63.07
Round  19, Global train loss: 0.835, Global test loss: 1.539, Global test accuracy: 47.94
Round  20, Train loss: 0.919, Test loss: 0.961, Test accuracy: 64.12
Round  20, Global train loss: 0.919, Global test loss: 1.341, Global test accuracy: 51.71
Round  21, Train loss: 0.957, Test loss: 0.960, Test accuracy: 64.35
Round  21, Global train loss: 0.957, Global test loss: 1.286, Global test accuracy: 54.30
Round  22, Train loss: 0.864, Test loss: 0.946, Test accuracy: 65.43
Round  22, Global train loss: 0.864, Global test loss: 1.337, Global test accuracy: 53.24
Round  23, Train loss: 0.799, Test loss: 0.943, Test accuracy: 65.76
Round  23, Global train loss: 0.799, Global test loss: 1.375, Global test accuracy: 51.24
Round  24, Train loss: 0.824, Test loss: 0.959, Test accuracy: 65.65
Round  24, Global train loss: 0.824, Global test loss: 1.430, Global test accuracy: 52.24
Round  25, Train loss: 0.765, Test loss: 0.957, Test accuracy: 65.78
Round  25, Global train loss: 0.765, Global test loss: 1.530, Global test accuracy: 51.49
Round  26, Train loss: 0.778, Test loss: 0.948, Test accuracy: 66.13
Round  26, Global train loss: 0.778, Global test loss: 1.360, Global test accuracy: 53.77
Round  27, Train loss: 0.775, Test loss: 0.925, Test accuracy: 66.83
Round  27, Global train loss: 0.775, Global test loss: 1.228, Global test accuracy: 56.81
Round  28, Train loss: 0.808, Test loss: 0.926, Test accuracy: 66.75
Round  28, Global train loss: 0.808, Global test loss: 1.295, Global test accuracy: 55.87
Round  29, Train loss: 0.836, Test loss: 0.935, Test accuracy: 67.17
Round  29, Global train loss: 0.836, Global test loss: 1.255, Global test accuracy: 55.93
Round  30, Train loss: 0.821, Test loss: 0.916, Test accuracy: 67.72
Round  30, Global train loss: 0.821, Global test loss: 1.315, Global test accuracy: 53.85
Round  31, Train loss: 0.733, Test loss: 0.914, Test accuracy: 68.09
Round  31, Global train loss: 0.733, Global test loss: 1.204, Global test accuracy: 58.45
Round  32, Train loss: 0.877, Test loss: 0.925, Test accuracy: 68.00
Round  32, Global train loss: 0.877, Global test loss: 1.281, Global test accuracy: 56.76
Round  33, Train loss: 0.745, Test loss: 0.942, Test accuracy: 67.55
Round  33, Global train loss: 0.745, Global test loss: 1.316, Global test accuracy: 55.19
Round  34, Train loss: 0.773, Test loss: 0.960, Test accuracy: 67.22
Round  34, Global train loss: 0.773, Global test loss: 1.365, Global test accuracy: 54.31
Round  35, Train loss: 0.736, Test loss: 0.927, Test accuracy: 68.51
Round  35, Global train loss: 0.736, Global test loss: 1.366, Global test accuracy: 53.12
Round  36, Train loss: 0.698, Test loss: 0.930, Test accuracy: 68.19
Round  36, Global train loss: 0.698, Global test loss: 1.334, Global test accuracy: 55.77
Round  37, Train loss: 0.746, Test loss: 0.933, Test accuracy: 68.50
Round  37, Global train loss: 0.746, Global test loss: 1.264, Global test accuracy: 57.34
Round  38, Train loss: 0.620, Test loss: 0.949, Test accuracy: 68.12
Round  38, Global train loss: 0.620, Global test loss: 1.317, Global test accuracy: 56.95
Round  39, Train loss: 0.673, Test loss: 0.927, Test accuracy: 68.68
Round  39, Global train loss: 0.673, Global test loss: 1.365, Global test accuracy: 53.83
Round  40, Train loss: 0.746, Test loss: 0.923, Test accuracy: 68.79
Round  40, Global train loss: 0.746, Global test loss: 1.308, Global test accuracy: 55.86
Round  41, Train loss: 0.773, Test loss: 0.918, Test accuracy: 69.21
Round  41, Global train loss: 0.773, Global test loss: 1.329, Global test accuracy: 53.86
Round  42, Train loss: 0.742, Test loss: 0.926, Test accuracy: 69.17
Round  42, Global train loss: 0.742, Global test loss: 1.180, Global test accuracy: 59.70
Round  43, Train loss: 0.616, Test loss: 0.935, Test accuracy: 69.09
Round  43, Global train loss: 0.616, Global test loss: 1.250, Global test accuracy: 58.04
Round  44, Train loss: 0.631, Test loss: 0.929, Test accuracy: 69.52
Round  44, Global train loss: 0.631, Global test loss: 1.322, Global test accuracy: 56.64
Round  45, Train loss: 0.767, Test loss: 0.914, Test accuracy: 69.88
Round  45, Global train loss: 0.767, Global test loss: 1.163, Global test accuracy: 60.19
Round  46, Train loss: 0.648, Test loss: 0.907, Test accuracy: 70.40
Round  46, Global train loss: 0.648, Global test loss: 1.265, Global test accuracy: 57.80
Round  47, Train loss: 0.600, Test loss: 0.920, Test accuracy: 69.87
Round  47, Global train loss: 0.600, Global test loss: 1.267, Global test accuracy: 57.29
Round  48, Train loss: 0.561, Test loss: 0.916, Test accuracy: 69.97
Round  48, Global train loss: 0.561, Global test loss: 1.404, Global test accuracy: 56.47
Round  49, Train loss: 0.546, Test loss: 0.924, Test accuracy: 69.70
Round  49, Global train loss: 0.546, Global test loss: 1.362, Global test accuracy: 56.79
Round  50, Train loss: 0.735, Test loss: 0.919, Test accuracy: 70.08
Round  50, Global train loss: 0.735, Global test loss: 1.292, Global test accuracy: 55.64
Round  51, Train loss: 0.506, Test loss: 0.934, Test accuracy: 69.97
Round  51, Global train loss: 0.506, Global test loss: 1.234, Global test accuracy: 60.83
Round  52, Train loss: 0.669, Test loss: 0.937, Test accuracy: 69.94
Round  52, Global train loss: 0.669, Global test loss: 1.161, Global test accuracy: 60.99
Round  53, Train loss: 0.577, Test loss: 0.932, Test accuracy: 70.20
Round  53, Global train loss: 0.577, Global test loss: 1.175, Global test accuracy: 60.53
Round  54, Train loss: 0.622, Test loss: 0.926, Test accuracy: 70.61
Round  54, Global train loss: 0.622, Global test loss: 1.241, Global test accuracy: 58.52
Round  55, Train loss: 0.555, Test loss: 0.925, Test accuracy: 71.01
Round  55, Global train loss: 0.555, Global test loss: 1.281, Global test accuracy: 59.98
Round  56, Train loss: 0.500, Test loss: 0.939, Test accuracy: 70.67
Round  56, Global train loss: 0.500, Global test loss: 1.275, Global test accuracy: 58.52
Round  57, Train loss: 0.526, Test loss: 0.963, Test accuracy: 70.02
Round  57, Global train loss: 0.526, Global test loss: 1.234, Global test accuracy: 61.00
Round  58, Train loss: 0.642, Test loss: 0.972, Test accuracy: 69.61
Round  58, Global train loss: 0.642, Global test loss: 1.277, Global test accuracy: 57.80
Round  59, Train loss: 0.556, Test loss: 0.962, Test accuracy: 70.14
Round  59, Global train loss: 0.556, Global test loss: 1.136, Global test accuracy: 63.00
Round  60, Train loss: 0.588, Test loss: 0.967, Test accuracy: 70.00
Round  60, Global train loss: 0.588, Global test loss: 1.249, Global test accuracy: 59.89
Round  61, Train loss: 0.544, Test loss: 0.973, Test accuracy: 70.29
Round  61, Global train loss: 0.544, Global test loss: 1.217, Global test accuracy: 61.78
Round  62, Train loss: 0.448, Test loss: 0.941, Test accuracy: 70.96
Round  62, Global train loss: 0.448, Global test loss: 1.298, Global test accuracy: 59.81
Round  63, Train loss: 0.497, Test loss: 0.969, Test accuracy: 70.34
Round  63, Global train loss: 0.497, Global test loss: 1.266, Global test accuracy: 60.67
Round  64, Train loss: 0.439, Test loss: 0.949, Test accuracy: 70.44
Round  64, Global train loss: 0.439, Global test loss: 1.279, Global test accuracy: 60.98
Round  65, Train loss: 0.519, Test loss: 0.965, Test accuracy: 70.21
Round  65, Global train loss: 0.519, Global test loss: 1.257, Global test accuracy: 60.66
Round  66, Train loss: 0.544, Test loss: 0.977, Test accuracy: 70.55
Round  66, Global train loss: 0.544, Global test loss: 1.275, Global test accuracy: 60.78
Round  67, Train loss: 0.451, Test loss: 0.994, Test accuracy: 70.46
Round  67, Global train loss: 0.451, Global test loss: 1.217, Global test accuracy: 63.04
Round  68, Train loss: 0.584, Test loss: 0.994, Test accuracy: 70.42
Round  68, Global train loss: 0.584, Global test loss: 1.304, Global test accuracy: 58.81
Round  69, Train loss: 0.470, Test loss: 0.975, Test accuracy: 71.04
Round  69, Global train loss: 0.470, Global test loss: 1.237, Global test accuracy: 60.74
Round  70, Train loss: 0.460, Test loss: 0.974, Test accuracy: 71.18
Round  70, Global train loss: 0.460, Global test loss: 1.227, Global test accuracy: 61.52
Round  71, Train loss: 0.443, Test loss: 0.964, Test accuracy: 71.13
Round  71, Global train loss: 0.443, Global test loss: 1.207, Global test accuracy: 61.80
Round  72, Train loss: 0.578, Test loss: 0.950, Test accuracy: 71.61
Round  72, Global train loss: 0.578, Global test loss: 1.153, Global test accuracy: 62.75
Round  73, Train loss: 0.446, Test loss: 0.973, Test accuracy: 71.75
Round  73, Global train loss: 0.446, Global test loss: 1.365, Global test accuracy: 60.38
Round  74, Train loss: 0.466, Test loss: 0.974, Test accuracy: 71.64
Round  74, Global train loss: 0.466, Global test loss: 1.209, Global test accuracy: 62.03
Round  75, Train loss: 0.416, Test loss: 0.981, Test accuracy: 72.02
Round  75, Global train loss: 0.416, Global test loss: 1.234, Global test accuracy: 63.06
Round  76, Train loss: 0.416, Test loss: 0.984, Test accuracy: 71.57
Round  76, Global train loss: 0.416, Global test loss: 1.263, Global test accuracy: 62.25
Round  77, Train loss: 0.424, Test loss: 1.015, Test accuracy: 71.39
Round  77, Global train loss: 0.424, Global test loss: 1.599, Global test accuracy: 57.85
Round  78, Train loss: 0.418, Test loss: 1.041, Test accuracy: 70.79
Round  78, Global train loss: 0.418, Global test loss: 1.286, Global test accuracy: 61.76
Round  79, Train loss: 0.518, Test loss: 1.048, Test accuracy: 70.89
Round  79, Global train loss: 0.518, Global test loss: 1.170, Global test accuracy: 62.01
Round  80, Train loss: 0.516, Test loss: 1.025, Test accuracy: 71.17
Round  80, Global train loss: 0.516, Global test loss: 1.191, Global test accuracy: 61.80
Round  81, Train loss: 0.391, Test loss: 1.030, Test accuracy: 71.53
Round  81, Global train loss: 0.391, Global test loss: 1.313, Global test accuracy: 61.61
Round  82, Train loss: 0.399, Test loss: 1.062, Test accuracy: 70.61
Round  82, Global train loss: 0.399, Global test loss: 1.413, Global test accuracy: 59.73
Round  83, Train loss: 0.446, Test loss: 1.029, Test accuracy: 71.03
Round  83, Global train loss: 0.446, Global test loss: 1.328, Global test accuracy: 61.78
Round  84, Train loss: 0.365, Test loss: 1.048, Test accuracy: 70.74
Round  84, Global train loss: 0.365, Global test loss: 1.707, Global test accuracy: 58.09
Round  85, Train loss: 0.540, Test loss: 1.020, Test accuracy: 71.40
Round  85, Global train loss: 0.540, Global test loss: 1.277, Global test accuracy: 61.44
Round  86, Train loss: 0.383, Test loss: 1.028, Test accuracy: 71.21
Round  86, Global train loss: 0.383, Global test loss: 1.398, Global test accuracy: 60.01
Round  87, Train loss: 0.434, Test loss: 1.043, Test accuracy: 70.73
Round  87, Global train loss: 0.434, Global test loss: 1.264, Global test accuracy: 62.99
Round  88, Train loss: 0.417, Test loss: 1.064, Test accuracy: 70.29
Round  88, Global train loss: 0.417, Global test loss: 1.349, Global test accuracy: 60.37
Round  89, Train loss: 0.355, Test loss: 1.071, Test accuracy: 70.42
Round  89, Global train loss: 0.355, Global test loss: 1.265, Global test accuracy: 62.22
Round  90, Train loss: 0.411, Test loss: 1.059, Test accuracy: 70.35
Round  90, Global train loss: 0.411, Global test loss: 1.237, Global test accuracy: 63.11
Round  91, Train loss: 0.510, Test loss: 1.004, Test accuracy: 71.51
Round  91, Global train loss: 0.510, Global test loss: 1.245, Global test accuracy: 62.20
Round  92, Train loss: 0.439, Test loss: 0.995, Test accuracy: 72.05
Round  92, Global train loss: 0.439, Global test loss: 1.313, Global test accuracy: 61.33
Round  93, Train loss: 0.418, Test loss: 1.019, Test accuracy: 71.97
Round  93, Global train loss: 0.418, Global test loss: 1.313, Global test accuracy: 61.09
Round  94, Train loss: 0.389, Test loss: 1.027, Test accuracy: 71.76
Round  94, Global train loss: 0.389, Global test loss: 1.223, Global test accuracy: 63.19
Round  95, Train loss: 0.329, Test loss: 1.036, Test accuracy: 71.60
Round  95, Global train loss: 0.329, Global test loss: 1.289, Global test accuracy: 63.29
Round  96, Train loss: 0.421, Test loss: 1.041, Test accuracy: 71.05
Round  96, Global train loss: 0.421, Global test loss: 1.220, Global test accuracy: 63.25
Round  97, Train loss: 0.400, Test loss: 1.042, Test accuracy: 71.38
Round  97, Global train loss: 0.400, Global test loss: 1.237, Global test accuracy: 62.80
Round  98, Train loss: 0.392, Test loss: 1.030, Test accuracy: 71.66
Round  98, Global train loss: 0.392, Global test loss: 1.247, Global test accuracy: 63.75
Round  99, Train loss: 0.357, Test loss: 1.033, Test accuracy: 71.24
Round  99, Global train loss: 0.357, Global test loss: 1.395, Global test accuracy: 61.33
Final Round, Train loss: 0.315, Test loss: 1.183, Test accuracy: 71.42
Final Round, Global train loss: 0.315, Global test loss: 1.395, Global test accuracy: 61.33
Average accuracy final 10 rounds: 71.45699999999998 

Average global accuracy final 10 rounds: 62.534000000000006 

1493.2124514579773
[1.573328971862793, 3.146657943725586, 4.436894178390503, 5.72713041305542, 7.007819414138794, 8.288508415222168, 9.585453748703003, 10.882399082183838, 12.177174806594849, 13.47195053100586, 14.740408897399902, 16.008867263793945, 17.319547176361084, 18.630227088928223, 19.93259572982788, 21.23496437072754, 22.534303188323975, 23.83364200592041, 25.110421419143677, 26.387200832366943, 27.680773735046387, 28.97434663772583, 30.24362063407898, 31.51289463043213, 32.78794264793396, 34.06299066543579, 35.34879159927368, 36.63459253311157, 37.92626714706421, 39.217941761016846, 40.48367738723755, 41.74941301345825, 43.02448296546936, 44.29955291748047, 45.58761191368103, 46.87567090988159, 48.15297555923462, 49.43028020858765, 50.72988271713257, 52.02948522567749, 53.322458267211914, 54.61543130874634, 55.90497612953186, 57.19452095031738, 58.4858193397522, 59.77711772918701, 61.054957151412964, 62.332796573638916, 63.62322998046875, 64.91366338729858, 66.21684288978577, 67.52002239227295, 68.81234645843506, 70.10467052459717, 71.41595602035522, 72.72724151611328, 74.03621506690979, 75.3451886177063, 76.64924502372742, 77.95330142974854, 79.27355313301086, 80.5938048362732, 81.88492131233215, 83.17603778839111, 84.4616379737854, 85.74723815917969, 87.07305765151978, 88.39887714385986, 89.70827889442444, 91.01768064498901, 92.32757782936096, 93.63747501373291, 94.94334268569946, 96.24921035766602, 97.5809211730957, 98.91263198852539, 100.22410035133362, 101.53556871414185, 102.84851837158203, 104.16146802902222, 105.49842643737793, 106.83538484573364, 108.16759991645813, 109.49981498718262, 110.84053468704224, 112.18125438690186, 113.50725173950195, 114.83324909210205, 116.16057801246643, 117.48790693283081, 118.82171940803528, 120.15553188323975, 121.4931492805481, 122.83076667785645, 124.15973567962646, 125.48870468139648, 126.80736565589905, 128.1260266304016, 129.44861841201782, 130.77121019363403, 132.08171391487122, 133.3922176361084, 134.70355319976807, 136.01488876342773, 137.32917976379395, 138.64347076416016, 139.95506167411804, 141.26665258407593, 142.5593228340149, 143.85199308395386, 145.17612266540527, 146.5002522468567, 147.80599641799927, 149.11174058914185, 150.4115767478943, 151.71141290664673, 153.0359389781952, 154.36046504974365, 155.66891431808472, 156.97736358642578, 158.28877234458923, 159.60018110275269, 160.8987159729004, 162.1972508430481, 163.51722121238708, 164.83719158172607, 166.12809371948242, 167.41899585723877, 168.71486282348633, 170.0107297897339, 171.29830360412598, 172.58587741851807, 173.87178874015808, 175.1577000617981, 176.4607367515564, 177.7637734413147, 179.06502032279968, 180.36626720428467, 181.67458033561707, 182.98289346694946, 184.27219486236572, 185.56149625778198, 186.86093592643738, 188.16037559509277, 189.4667103290558, 190.7730450630188, 192.06301927566528, 193.35299348831177, 194.6267876625061, 195.90058183670044, 197.21900987625122, 198.537437915802, 199.8227870464325, 201.108136177063, 202.38610124588013, 203.66406631469727, 204.9897496700287, 206.3154330253601, 207.6430685520172, 208.97070407867432, 210.28340029716492, 211.59609651565552, 212.93415665626526, 214.272216796875, 215.59972524642944, 216.9272336959839, 218.22496056556702, 219.52268743515015, 220.83592534065247, 222.14916324615479, 223.44426369667053, 224.73936414718628, 226.0606667995453, 227.3819694519043, 228.69115233421326, 230.00033521652222, 231.29818320274353, 232.59603118896484, 233.9238405227661, 235.25164985656738, 236.548654794693, 237.8456597328186, 239.15572142601013, 240.46578311920166, 241.77940845489502, 243.09303379058838, 244.38440585136414, 245.6757779121399, 246.9769480228424, 248.27811813354492, 249.60041213035583, 250.92270612716675, 252.19621443748474, 253.46972274780273, 254.76980113983154, 256.06987953186035, 257.3959274291992, 258.7219753265381, 260.0412561893463, 261.36053705215454, 263.971782207489, 266.5830273628235]
[25.87, 25.87, 32.39, 32.39, 41.99, 41.99, 44.64, 44.64, 50.31, 50.31, 52.24, 52.24, 54.47, 54.47, 55.88, 55.88, 56.29, 56.29, 56.36, 56.36, 57.62, 57.62, 59.2, 59.2, 60.28, 60.28, 61.93, 61.93, 61.85, 61.85, 62.07, 62.07, 61.92, 61.92, 62.26, 62.26, 62.71, 62.71, 63.07, 63.07, 64.12, 64.12, 64.35, 64.35, 65.43, 65.43, 65.76, 65.76, 65.65, 65.65, 65.78, 65.78, 66.13, 66.13, 66.83, 66.83, 66.75, 66.75, 67.17, 67.17, 67.72, 67.72, 68.09, 68.09, 68.0, 68.0, 67.55, 67.55, 67.22, 67.22, 68.51, 68.51, 68.19, 68.19, 68.5, 68.5, 68.12, 68.12, 68.68, 68.68, 68.79, 68.79, 69.21, 69.21, 69.17, 69.17, 69.09, 69.09, 69.52, 69.52, 69.88, 69.88, 70.4, 70.4, 69.87, 69.87, 69.97, 69.97, 69.7, 69.7, 70.08, 70.08, 69.97, 69.97, 69.94, 69.94, 70.2, 70.2, 70.61, 70.61, 71.01, 71.01, 70.67, 70.67, 70.02, 70.02, 69.61, 69.61, 70.14, 70.14, 70.0, 70.0, 70.29, 70.29, 70.96, 70.96, 70.34, 70.34, 70.44, 70.44, 70.21, 70.21, 70.55, 70.55, 70.46, 70.46, 70.42, 70.42, 71.04, 71.04, 71.18, 71.18, 71.13, 71.13, 71.61, 71.61, 71.75, 71.75, 71.64, 71.64, 72.02, 72.02, 71.57, 71.57, 71.39, 71.39, 70.79, 70.79, 70.89, 70.89, 71.17, 71.17, 71.53, 71.53, 70.61, 70.61, 71.03, 71.03, 70.74, 70.74, 71.4, 71.4, 71.21, 71.21, 70.73, 70.73, 70.29, 70.29, 70.42, 70.42, 70.35, 70.35, 71.51, 71.51, 72.05, 72.05, 71.97, 71.97, 71.76, 71.76, 71.6, 71.6, 71.05, 71.05, 71.38, 71.38, 71.66, 71.66, 71.24, 71.24, 71.42, 71.42]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.632, Test loss: 2.029, Test accuracy: 21.76
Round   0, Global train loss: 1.632, Global test loss: 2.211, Global test accuracy: 18.18
Round   1, Train loss: 1.496, Test loss: 1.735, Test accuracy: 28.74
Round   1, Global train loss: 1.496, Global test loss: 2.116, Global test accuracy: 18.93
Round   2, Train loss: 1.370, Test loss: 1.465, Test accuracy: 40.91
Round   2, Global train loss: 1.370, Global test loss: 1.945, Global test accuracy: 31.27
Round   3, Train loss: 1.340, Test loss: 1.395, Test accuracy: 42.99
Round   3, Global train loss: 1.340, Global test loss: 1.855, Global test accuracy: 30.87
Round   4, Train loss: 1.304, Test loss: 1.284, Test accuracy: 48.09
Round   4, Global train loss: 1.304, Global test loss: 1.860, Global test accuracy: 28.69
Round   5, Train loss: 1.178, Test loss: 1.252, Test accuracy: 49.80
Round   5, Global train loss: 1.178, Global test loss: 1.770, Global test accuracy: 35.38
Round   6, Train loss: 1.181, Test loss: 1.210, Test accuracy: 51.98
Round   6, Global train loss: 1.181, Global test loss: 1.740, Global test accuracy: 35.68
Round   7, Train loss: 1.212, Test loss: 1.146, Test accuracy: 54.76
Round   7, Global train loss: 1.212, Global test loss: 1.613, Global test accuracy: 40.64
Round   8, Train loss: 1.067, Test loss: 1.116, Test accuracy: 55.99
Round   8, Global train loss: 1.067, Global test loss: 1.585, Global test accuracy: 41.64
Round   9, Train loss: 1.123, Test loss: 1.111, Test accuracy: 56.30
Round   9, Global train loss: 1.123, Global test loss: 1.552, Global test accuracy: 42.91
Round  10, Train loss: 1.125, Test loss: 1.087, Test accuracy: 57.11
Round  10, Global train loss: 1.125, Global test loss: 1.526, Global test accuracy: 44.03
Round  11, Train loss: 1.120, Test loss: 1.059, Test accuracy: 59.26
Round  11, Global train loss: 1.120, Global test loss: 1.470, Global test accuracy: 48.04
Round  12, Train loss: 1.075, Test loss: 1.027, Test accuracy: 60.29
Round  12, Global train loss: 1.075, Global test loss: 1.539, Global test accuracy: 45.76
Round  13, Train loss: 1.144, Test loss: 1.015, Test accuracy: 60.81
Round  13, Global train loss: 1.144, Global test loss: 1.559, Global test accuracy: 46.00
Round  14, Train loss: 1.085, Test loss: 1.017, Test accuracy: 61.23
Round  14, Global train loss: 1.085, Global test loss: 1.548, Global test accuracy: 41.39
Round  15, Train loss: 1.027, Test loss: 1.011, Test accuracy: 61.03
Round  15, Global train loss: 1.027, Global test loss: 1.553, Global test accuracy: 44.69
Round  16, Train loss: 0.984, Test loss: 1.008, Test accuracy: 61.71
Round  16, Global train loss: 0.984, Global test loss: 1.475, Global test accuracy: 46.77
Round  17, Train loss: 1.007, Test loss: 0.995, Test accuracy: 62.35
Round  17, Global train loss: 1.007, Global test loss: 1.400, Global test accuracy: 49.85
Round  18, Train loss: 0.968, Test loss: 0.978, Test accuracy: 63.16
Round  18, Global train loss: 0.968, Global test loss: 1.354, Global test accuracy: 50.78
Round  19, Train loss: 0.908, Test loss: 0.992, Test accuracy: 62.09
Round  19, Global train loss: 0.908, Global test loss: 1.539, Global test accuracy: 46.59
Round  20, Train loss: 1.018, Test loss: 0.971, Test accuracy: 63.20
Round  20, Global train loss: 1.018, Global test loss: 1.340, Global test accuracy: 52.00
Round  21, Train loss: 0.976, Test loss: 0.967, Test accuracy: 63.40
Round  21, Global train loss: 0.976, Global test loss: 1.359, Global test accuracy: 50.58
Round  22, Train loss: 0.913, Test loss: 0.959, Test accuracy: 64.35
Round  22, Global train loss: 0.913, Global test loss: 1.399, Global test accuracy: 49.67
Round  23, Train loss: 0.898, Test loss: 0.965, Test accuracy: 64.03
Round  23, Global train loss: 0.898, Global test loss: 1.388, Global test accuracy: 49.69
Round  24, Train loss: 0.798, Test loss: 0.948, Test accuracy: 64.67
Round  24, Global train loss: 0.798, Global test loss: 1.383, Global test accuracy: 52.38
Round  25, Train loss: 0.883, Test loss: 0.940, Test accuracy: 65.10
Round  25, Global train loss: 0.883, Global test loss: 1.509, Global test accuracy: 48.57
Round  26, Train loss: 0.869, Test loss: 0.935, Test accuracy: 65.40
Round  26, Global train loss: 0.869, Global test loss: 1.418, Global test accuracy: 50.13
Round  27, Train loss: 0.879, Test loss: 0.930, Test accuracy: 65.52
Round  27, Global train loss: 0.879, Global test loss: 1.272, Global test accuracy: 54.47
Round  28, Train loss: 0.841, Test loss: 0.926, Test accuracy: 65.88
Round  28, Global train loss: 0.841, Global test loss: 1.290, Global test accuracy: 53.92
Round  29, Train loss: 0.851, Test loss: 0.915, Test accuracy: 66.49
Round  29, Global train loss: 0.851, Global test loss: 1.220, Global test accuracy: 57.14
Round  30, Train loss: 0.827, Test loss: 0.904, Test accuracy: 66.82
Round  30, Global train loss: 0.827, Global test loss: 1.351, Global test accuracy: 51.74
Round  31, Train loss: 0.852, Test loss: 0.890, Test accuracy: 67.26
Round  31, Global train loss: 0.852, Global test loss: 1.212, Global test accuracy: 57.08
Round  32, Train loss: 0.810, Test loss: 0.901, Test accuracy: 66.84
Round  32, Global train loss: 0.810, Global test loss: 1.276, Global test accuracy: 55.84
Round  33, Train loss: 0.862, Test loss: 0.905, Test accuracy: 66.92
Round  33, Global train loss: 0.862, Global test loss: 1.308, Global test accuracy: 55.25
Round  34, Train loss: 0.844, Test loss: 0.908, Test accuracy: 67.06
Round  34, Global train loss: 0.844, Global test loss: 1.340, Global test accuracy: 54.82
Round  35, Train loss: 0.858, Test loss: 0.906, Test accuracy: 67.34
Round  35, Global train loss: 0.858, Global test loss: 1.301, Global test accuracy: 54.13
Round  36, Train loss: 0.764, Test loss: 0.904, Test accuracy: 67.39
Round  36, Global train loss: 0.764, Global test loss: 1.357, Global test accuracy: 52.47
Round  37, Train loss: 0.788, Test loss: 0.897, Test accuracy: 67.83
Round  37, Global train loss: 0.788, Global test loss: 1.223, Global test accuracy: 56.76
Round  38, Train loss: 0.734, Test loss: 0.889, Test accuracy: 68.62
Round  38, Global train loss: 0.734, Global test loss: 1.292, Global test accuracy: 55.29
Round  39, Train loss: 0.761, Test loss: 0.897, Test accuracy: 68.71
Round  39, Global train loss: 0.761, Global test loss: 1.345, Global test accuracy: 52.98
Round  40, Train loss: 0.785, Test loss: 0.882, Test accuracy: 68.85
Round  40, Global train loss: 0.785, Global test loss: 1.304, Global test accuracy: 53.99
Round  41, Train loss: 0.794, Test loss: 0.868, Test accuracy: 69.18
Round  41, Global train loss: 0.794, Global test loss: 1.214, Global test accuracy: 56.97
Round  42, Train loss: 0.781, Test loss: 0.868, Test accuracy: 69.20
Round  42, Global train loss: 0.781, Global test loss: 1.169, Global test accuracy: 58.90
Round  43, Train loss: 0.759, Test loss: 0.868, Test accuracy: 69.16
Round  43, Global train loss: 0.759, Global test loss: 1.242, Global test accuracy: 56.74
Round  44, Train loss: 0.662, Test loss: 0.869, Test accuracy: 69.19
Round  44, Global train loss: 0.662, Global test loss: 1.354, Global test accuracy: 54.09
Round  45, Train loss: 0.725, Test loss: 0.866, Test accuracy: 69.55
Round  45, Global train loss: 0.725, Global test loss: 1.150, Global test accuracy: 59.44
Round  46, Train loss: 0.780, Test loss: 0.877, Test accuracy: 69.25
Round  46, Global train loss: 0.780, Global test loss: 1.219, Global test accuracy: 57.66
Round  47, Train loss: 0.716, Test loss: 0.863, Test accuracy: 69.63
Round  47, Global train loss: 0.716, Global test loss: 1.346, Global test accuracy: 54.95
Round  48, Train loss: 0.660, Test loss: 0.879, Test accuracy: 69.02
Round  48, Global train loss: 0.660, Global test loss: 1.392, Global test accuracy: 52.54
Round  49, Train loss: 0.642, Test loss: 0.880, Test accuracy: 69.26
Round  49, Global train loss: 0.642, Global test loss: 1.256, Global test accuracy: 56.23
Round  50, Train loss: 0.670, Test loss: 0.864, Test accuracy: 69.99
Round  50, Global train loss: 0.670, Global test loss: 1.210, Global test accuracy: 58.66
Round  51, Train loss: 0.654, Test loss: 0.874, Test accuracy: 69.92
Round  51, Global train loss: 0.654, Global test loss: 1.157, Global test accuracy: 60.57
Round  52, Train loss: 0.652, Test loss: 0.865, Test accuracy: 70.36
Round  52, Global train loss: 0.652, Global test loss: 1.103, Global test accuracy: 62.13
Round  53, Train loss: 0.679, Test loss: 0.872, Test accuracy: 70.49
Round  53, Global train loss: 0.679, Global test loss: 1.223, Global test accuracy: 58.44
Round  54, Train loss: 0.600, Test loss: 0.871, Test accuracy: 70.30
Round  54, Global train loss: 0.600, Global test loss: 1.241, Global test accuracy: 58.81
Round  55, Train loss: 0.630, Test loss: 0.890, Test accuracy: 70.23
Round  55, Global train loss: 0.630, Global test loss: 1.281, Global test accuracy: 57.98
Round  56, Train loss: 0.618, Test loss: 0.905, Test accuracy: 69.68
Round  56, Global train loss: 0.618, Global test loss: 1.291, Global test accuracy: 56.89
Round  57, Train loss: 0.613, Test loss: 0.891, Test accuracy: 69.88
Round  57, Global train loss: 0.613, Global test loss: 1.153, Global test accuracy: 61.35
Round  58, Train loss: 0.673, Test loss: 0.899, Test accuracy: 69.96
Round  58, Global train loss: 0.673, Global test loss: 1.209, Global test accuracy: 58.41
Round  59, Train loss: 0.585, Test loss: 0.898, Test accuracy: 70.29
Round  59, Global train loss: 0.585, Global test loss: 1.157, Global test accuracy: 61.12
Round  60, Train loss: 0.662, Test loss: 0.890, Test accuracy: 70.34
Round  60, Global train loss: 0.662, Global test loss: 1.266, Global test accuracy: 57.10
Round  61, Train loss: 0.596, Test loss: 0.887, Test accuracy: 70.28
Round  61, Global train loss: 0.596, Global test loss: 1.157, Global test accuracy: 60.48
Round  62, Train loss: 0.515, Test loss: 0.904, Test accuracy: 70.07
Round  62, Global train loss: 0.515, Global test loss: 1.299, Global test accuracy: 58.56
Round  63, Train loss: 0.558, Test loss: 0.904, Test accuracy: 70.08
Round  63, Global train loss: 0.558, Global test loss: 1.155, Global test accuracy: 61.66
Round  64, Train loss: 0.559, Test loss: 0.899, Test accuracy: 70.52
Round  64, Global train loss: 0.559, Global test loss: 1.250, Global test accuracy: 59.25
Round  65, Train loss: 0.572, Test loss: 0.894, Test accuracy: 70.54
Round  65, Global train loss: 0.572, Global test loss: 1.224, Global test accuracy: 59.35
Round  66, Train loss: 0.527, Test loss: 0.883, Test accuracy: 70.91
Round  66, Global train loss: 0.527, Global test loss: 1.176, Global test accuracy: 60.26
Round  67, Train loss: 0.485, Test loss: 0.892, Test accuracy: 70.78
Round  67, Global train loss: 0.485, Global test loss: 1.177, Global test accuracy: 62.08
Round  68, Train loss: 0.522, Test loss: 0.903, Test accuracy: 70.64
Round  68, Global train loss: 0.522, Global test loss: 1.142, Global test accuracy: 62.18
Round  69, Train loss: 0.542, Test loss: 0.901, Test accuracy: 70.77
Round  69, Global train loss: 0.542, Global test loss: 1.278, Global test accuracy: 58.48
Round  70, Train loss: 0.475, Test loss: 0.906, Test accuracy: 70.42
Round  70, Global train loss: 0.475, Global test loss: 1.151, Global test accuracy: 63.01
Round  71, Train loss: 0.516, Test loss: 0.902, Test accuracy: 70.87
Round  71, Global train loss: 0.516, Global test loss: 1.150, Global test accuracy: 62.41
Round  72, Train loss: 0.633, Test loss: 0.905, Test accuracy: 70.84
Round  72, Global train loss: 0.633, Global test loss: 1.126, Global test accuracy: 62.34
Round  73, Train loss: 0.455, Test loss: 0.911, Test accuracy: 70.68
Round  73, Global train loss: 0.455, Global test loss: 1.241, Global test accuracy: 61.10
Round  74, Train loss: 0.541, Test loss: 0.914, Test accuracy: 70.36
Round  74, Global train loss: 0.541, Global test loss: 1.113, Global test accuracy: 63.56
Round  75, Train loss: 0.476, Test loss: 0.903, Test accuracy: 70.43
Round  75, Global train loss: 0.476, Global test loss: 1.176, Global test accuracy: 62.04
Round  76, Train loss: 0.502, Test loss: 0.902, Test accuracy: 70.58
Round  76, Global train loss: 0.502, Global test loss: 1.231, Global test accuracy: 61.13
Round  77, Train loss: 0.466, Test loss: 0.911, Test accuracy: 70.16
Round  77, Global train loss: 0.466, Global test loss: 1.415, Global test accuracy: 57.77
Round  78, Train loss: 0.500, Test loss: 0.912, Test accuracy: 70.73
Round  78, Global train loss: 0.500, Global test loss: 1.210, Global test accuracy: 60.55
Round  79, Train loss: 0.599, Test loss: 0.943, Test accuracy: 70.08
Round  79, Global train loss: 0.599, Global test loss: 1.174, Global test accuracy: 60.86
Round  80, Train loss: 0.564, Test loss: 0.933, Test accuracy: 70.44
Round  80, Global train loss: 0.564, Global test loss: 1.154, Global test accuracy: 62.07
Round  81, Train loss: 0.405, Test loss: 0.936, Test accuracy: 70.68
Round  81, Global train loss: 0.405, Global test loss: 1.227, Global test accuracy: 61.74
Round  82, Train loss: 0.514, Test loss: 0.920, Test accuracy: 71.09
Round  82, Global train loss: 0.514, Global test loss: 1.190, Global test accuracy: 62.02
Round  83, Train loss: 0.543, Test loss: 0.930, Test accuracy: 70.86
Round  83, Global train loss: 0.543, Global test loss: 1.241, Global test accuracy: 60.69
Round  84, Train loss: 0.445, Test loss: 0.916, Test accuracy: 71.02
Round  84, Global train loss: 0.445, Global test loss: 1.487, Global test accuracy: 57.98
Round  85, Train loss: 0.489, Test loss: 0.910, Test accuracy: 71.11
Round  85, Global train loss: 0.489, Global test loss: 1.191, Global test accuracy: 62.31
Round  86, Train loss: 0.404, Test loss: 0.928, Test accuracy: 70.93
Round  86, Global train loss: 0.404, Global test loss: 1.273, Global test accuracy: 60.64
Round  87, Train loss: 0.493, Test loss: 0.931, Test accuracy: 71.13
Round  87, Global train loss: 0.493, Global test loss: 1.246, Global test accuracy: 60.96
Round  88, Train loss: 0.533, Test loss: 0.928, Test accuracy: 71.01
Round  88, Global train loss: 0.533, Global test loss: 1.197, Global test accuracy: 61.68
Round  89, Train loss: 0.482, Test loss: 0.949, Test accuracy: 70.71
Round  89, Global train loss: 0.482, Global test loss: 1.221, Global test accuracy: 61.36
Round  90, Train loss: 0.441, Test loss: 0.939, Test accuracy: 70.84
Round  90, Global train loss: 0.441, Global test loss: 1.112, Global test accuracy: 63.85
Round  91, Train loss: 0.507, Test loss: 0.942, Test accuracy: 70.90
Round  91, Global train loss: 0.507, Global test loss: 1.171, Global test accuracy: 62.25
Round  92, Train loss: 0.456, Test loss: 0.938, Test accuracy: 70.99
Round  92, Global train loss: 0.456, Global test loss: 1.244, Global test accuracy: 60.32/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  93, Train loss: 0.513, Test loss: 0.932, Test accuracy: 71.38
Round  93, Global train loss: 0.513, Global test loss: 1.253, Global test accuracy: 60.60
Round  94, Train loss: 0.484, Test loss: 0.961, Test accuracy: 71.25
Round  94, Global train loss: 0.484, Global test loss: 1.172, Global test accuracy: 62.86
Round  95, Train loss: 0.396, Test loss: 0.953, Test accuracy: 71.28
Round  95, Global train loss: 0.396, Global test loss: 1.205, Global test accuracy: 63.47
Round  96, Train loss: 0.448, Test loss: 0.966, Test accuracy: 71.44
Round  96, Global train loss: 0.448, Global test loss: 1.219, Global test accuracy: 62.99
Round  97, Train loss: 0.481, Test loss: 0.976, Test accuracy: 71.16
Round  97, Global train loss: 0.481, Global test loss: 1.137, Global test accuracy: 63.19
Round  98, Train loss: 0.456, Test loss: 0.968, Test accuracy: 71.58
Round  98, Global train loss: 0.456, Global test loss: 1.182, Global test accuracy: 63.25
Round  99, Train loss: 0.402, Test loss: 0.989, Test accuracy: 71.68
Round  99, Global train loss: 0.402, Global test loss: 1.264, Global test accuracy: 62.86
Final Round, Train loss: 0.364, Test loss: 0.991, Test accuracy: 72.15
Final Round, Global train loss: 0.364, Global test loss: 1.264, Global test accuracy: 62.86
Average accuracy final 10 rounds: 71.25 

Average global accuracy final 10 rounds: 62.56400000000001 

1377.871141910553
[1.497985601425171, 2.995971202850342, 4.2350754737854, 5.474179744720459, 6.700942277908325, 7.927704811096191, 9.184027194976807, 10.440349578857422, 11.674531936645508, 12.908714294433594, 14.133279800415039, 15.357845306396484, 16.576810836791992, 17.7957763671875, 19.025332927703857, 20.254889488220215, 21.472895860671997, 22.69090223312378, 23.932663202285767, 25.174424171447754, 26.395028591156006, 27.615633010864258, 28.837292432785034, 30.05895185470581, 31.2790207862854, 32.49908971786499, 33.71325087547302, 34.927412033081055, 36.15390610694885, 37.38040018081665, 38.60069680213928, 39.820993423461914, 41.040101051330566, 42.25920867919922, 43.47278451919556, 44.686360359191895, 45.92230772972107, 47.158255100250244, 48.40983772277832, 49.6614203453064, 50.898842573165894, 52.13626480102539, 53.36924362182617, 54.60222244262695, 55.834125995635986, 57.06602954864502, 58.30027532577515, 59.53452110290527, 60.71872687339783, 61.90293264389038, 63.08650851249695, 64.27008438110352, 65.45787978172302, 66.64567518234253, 67.8354012966156, 69.02512741088867, 70.20881962776184, 71.39251184463501, 72.57669353485107, 73.76087522506714, 74.95703673362732, 76.1531982421875, 77.33613443374634, 78.51907062530518, 79.70188426971436, 80.88469791412354, 82.07277774810791, 83.26085758209229, 84.45510458946228, 85.64935159683228, 86.84089398384094, 88.03243637084961, 89.22860169410706, 90.4247670173645, 91.60605907440186, 92.78735113143921, 93.96754288673401, 95.14773464202881, 96.17836809158325, 97.2090015411377, 98.23776817321777, 99.26653480529785, 100.29259943962097, 101.31866407394409, 102.34429836273193, 103.36993265151978, 104.40480399131775, 105.43967533111572, 106.47307252883911, 107.5064697265625, 108.54489398002625, 109.58331823348999, 110.61889553070068, 111.65447282791138, 112.68035793304443, 113.70624303817749, 114.74207615852356, 115.77790927886963, 116.80706548690796, 117.83622169494629, 118.87429332733154, 119.9123649597168, 120.94894695281982, 121.98552894592285, 123.01656317710876, 124.04759740829468, 125.08138608932495, 126.11517477035522, 127.14165306091309, 128.16813135147095, 129.19701075553894, 130.22589015960693, 131.2614986896515, 132.29710721969604, 133.3296914100647, 134.36227560043335, 135.39210605621338, 136.4219365119934, 137.45409107208252, 138.48624563217163, 139.5145184993744, 140.54279136657715, 141.5681653022766, 142.59353923797607, 143.61561250686646, 144.63768577575684, 145.65830087661743, 146.67891597747803, 147.70367074012756, 148.7284255027771, 149.75375843048096, 150.77909135818481, 151.804381608963, 152.8296718597412, 153.85195016860962, 154.87422847747803, 155.89760613441467, 156.92098379135132, 157.9447054862976, 158.9684271812439, 159.98802590370178, 161.00762462615967, 162.027813911438, 163.0480031967163, 164.0693120956421, 165.09062099456787, 166.11241459846497, 167.13420820236206, 168.3131034374237, 169.49199867248535, 170.67382431030273, 171.85564994812012, 173.03938341140747, 174.22311687469482, 175.40400385856628, 176.58489084243774, 177.75999879837036, 178.93510675430298, 180.1140730381012, 181.2930393218994, 182.46846652030945, 183.64389371871948, 184.8407804965973, 186.0376672744751, 187.23476696014404, 188.431866645813, 189.61583065986633, 190.79979467391968, 192.00565314292908, 193.21151161193848, 194.44123768806458, 195.67096376419067, 196.85905122756958, 198.0471386909485, 199.23586630821228, 200.42459392547607, 201.65676474571228, 202.8889355659485, 204.10745310783386, 205.32597064971924, 206.5449240207672, 207.76387739181519, 208.9541609287262, 210.1444444656372, 211.37729167938232, 212.61013889312744, 213.8386709690094, 215.06720304489136, 216.28111386299133, 217.4950246810913, 218.6701216697693, 219.84521865844727, 221.02836513519287, 222.21151161193848, 223.43528509140015, 224.65905857086182, 225.88419151306152, 227.10932445526123, 228.31355023384094, 229.51777601242065, 231.97337818145752, 234.42898035049438]
[21.76, 21.76, 28.74, 28.74, 40.91, 40.91, 42.99, 42.99, 48.09, 48.09, 49.8, 49.8, 51.98, 51.98, 54.76, 54.76, 55.99, 55.99, 56.3, 56.3, 57.11, 57.11, 59.26, 59.26, 60.29, 60.29, 60.81, 60.81, 61.23, 61.23, 61.03, 61.03, 61.71, 61.71, 62.35, 62.35, 63.16, 63.16, 62.09, 62.09, 63.2, 63.2, 63.4, 63.4, 64.35, 64.35, 64.03, 64.03, 64.67, 64.67, 65.1, 65.1, 65.4, 65.4, 65.52, 65.52, 65.88, 65.88, 66.49, 66.49, 66.82, 66.82, 67.26, 67.26, 66.84, 66.84, 66.92, 66.92, 67.06, 67.06, 67.34, 67.34, 67.39, 67.39, 67.83, 67.83, 68.62, 68.62, 68.71, 68.71, 68.85, 68.85, 69.18, 69.18, 69.2, 69.2, 69.16, 69.16, 69.19, 69.19, 69.55, 69.55, 69.25, 69.25, 69.63, 69.63, 69.02, 69.02, 69.26, 69.26, 69.99, 69.99, 69.92, 69.92, 70.36, 70.36, 70.49, 70.49, 70.3, 70.3, 70.23, 70.23, 69.68, 69.68, 69.88, 69.88, 69.96, 69.96, 70.29, 70.29, 70.34, 70.34, 70.28, 70.28, 70.07, 70.07, 70.08, 70.08, 70.52, 70.52, 70.54, 70.54, 70.91, 70.91, 70.78, 70.78, 70.64, 70.64, 70.77, 70.77, 70.42, 70.42, 70.87, 70.87, 70.84, 70.84, 70.68, 70.68, 70.36, 70.36, 70.43, 70.43, 70.58, 70.58, 70.16, 70.16, 70.73, 70.73, 70.08, 70.08, 70.44, 70.44, 70.68, 70.68, 71.09, 71.09, 70.86, 70.86, 71.02, 71.02, 71.11, 71.11, 70.93, 70.93, 71.13, 71.13, 71.01, 71.01, 70.71, 70.71, 70.84, 70.84, 70.9, 70.9, 70.99, 70.99, 71.38, 71.38, 71.25, 71.25, 71.28, 71.28, 71.44, 71.44, 71.16, 71.16, 71.58, 71.58, 71.68, 71.68, 72.15, 72.15]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.603, Test loss: 2.030, Test accuracy: 24.80
Round   0, Global train loss: 1.603, Global test loss: 2.222, Global test accuracy: 21.14
Round   1, Train loss: 1.526, Test loss: 1.770, Test accuracy: 28.44
Round   1, Global train loss: 1.526, Global test loss: 2.178, Global test accuracy: 17.57
Round   2, Train loss: 1.381, Test loss: 1.532, Test accuracy: 40.67
Round   2, Global train loss: 1.381, Global test loss: 2.092, Global test accuracy: 30.90
Round   3, Train loss: 1.266, Test loss: 1.419, Test accuracy: 43.29
Round   3, Global train loss: 1.266, Global test loss: 1.930, Global test accuracy: 29.62
Round   4, Train loss: 1.280, Test loss: 1.286, Test accuracy: 48.15
Round   4, Global train loss: 1.280, Global test loss: 1.890, Global test accuracy: 28.94
Round   5, Train loss: 1.188, Test loss: 1.229, Test accuracy: 50.72
Round   5, Global train loss: 1.188, Global test loss: 1.729, Global test accuracy: 37.33
Round   6, Train loss: 1.124, Test loss: 1.171, Test accuracy: 54.12
Round   6, Global train loss: 1.124, Global test loss: 1.744, Global test accuracy: 36.05
Round   7, Train loss: 1.100, Test loss: 1.105, Test accuracy: 56.31
Round   7, Global train loss: 1.100, Global test loss: 1.660, Global test accuracy: 41.14
Round   8, Train loss: 1.013, Test loss: 1.106, Test accuracy: 56.28
Round   8, Global train loss: 1.013, Global test loss: 1.658, Global test accuracy: 42.16
Round   9, Train loss: 1.045, Test loss: 1.106, Test accuracy: 56.35
Round   9, Global train loss: 1.045, Global test loss: 1.507, Global test accuracy: 45.65
Round  10, Train loss: 1.107, Test loss: 1.091, Test accuracy: 57.48
Round  10, Global train loss: 1.107, Global test loss: 1.604, Global test accuracy: 42.39
Round  11, Train loss: 1.028, Test loss: 1.060, Test accuracy: 58.37
Round  11, Global train loss: 1.028, Global test loss: 1.526, Global test accuracy: 46.83
Round  12, Train loss: 1.002, Test loss: 1.047, Test accuracy: 59.81
Round  12, Global train loss: 1.002, Global test loss: 1.650, Global test accuracy: 42.92
Round  13, Train loss: 1.038, Test loss: 1.020, Test accuracy: 60.56
Round  13, Global train loss: 1.038, Global test loss: 1.603, Global test accuracy: 44.78
Round  14, Train loss: 1.019, Test loss: 1.022, Test accuracy: 60.43
Round  14, Global train loss: 1.019, Global test loss: 1.555, Global test accuracy: 43.27
Round  15, Train loss: 0.989, Test loss: 1.008, Test accuracy: 61.35
Round  15, Global train loss: 0.989, Global test loss: 1.543, Global test accuracy: 45.52
Round  16, Train loss: 0.983, Test loss: 1.005, Test accuracy: 61.69
Round  16, Global train loss: 0.983, Global test loss: 1.467, Global test accuracy: 48.89
Round  17, Train loss: 1.003, Test loss: 1.011, Test accuracy: 61.72
Round  17, Global train loss: 1.003, Global test loss: 1.453, Global test accuracy: 47.31
Round  18, Train loss: 0.998, Test loss: 1.001, Test accuracy: 62.54
Round  18, Global train loss: 0.998, Global test loss: 1.396, Global test accuracy: 48.97
Round  19, Train loss: 0.852, Test loss: 0.997, Test accuracy: 62.78
Round  19, Global train loss: 0.852, Global test loss: 1.590, Global test accuracy: 46.48
Round  20, Train loss: 0.944, Test loss: 0.987, Test accuracy: 63.26
Round  20, Global train loss: 0.944, Global test loss: 1.337, Global test accuracy: 52.48
Round  21, Train loss: 0.976, Test loss: 1.010, Test accuracy: 62.86
Round  21, Global train loss: 0.976, Global test loss: 1.375, Global test accuracy: 49.82
Round  22, Train loss: 0.809, Test loss: 1.007, Test accuracy: 62.96
Round  22, Global train loss: 0.809, Global test loss: 1.364, Global test accuracy: 50.94
Round  23, Train loss: 0.843, Test loss: 1.004, Test accuracy: 63.67
Round  23, Global train loss: 0.843, Global test loss: 1.480, Global test accuracy: 48.34
Round  24, Train loss: 0.776, Test loss: 0.995, Test accuracy: 64.10
Round  24, Global train loss: 0.776, Global test loss: 1.497, Global test accuracy: 49.37
Round  25, Train loss: 0.779, Test loss: 0.999, Test accuracy: 63.86
Round  25, Global train loss: 0.779, Global test loss: 1.551, Global test accuracy: 49.98
Round  26, Train loss: 0.712, Test loss: 0.964, Test accuracy: 64.97
Round  26, Global train loss: 0.712, Global test loss: 1.461, Global test accuracy: 51.39
Round  27, Train loss: 0.743, Test loss: 0.984, Test accuracy: 64.72
Round  27, Global train loss: 0.743, Global test loss: 1.320, Global test accuracy: 53.84
Round  28, Train loss: 0.743, Test loss: 0.956, Test accuracy: 65.77
Round  28, Global train loss: 0.743, Global test loss: 1.379, Global test accuracy: 52.26
Round  29, Train loss: 0.771, Test loss: 0.940, Test accuracy: 66.18
Round  29, Global train loss: 0.771, Global test loss: 1.276, Global test accuracy: 56.09
Round  30, Train loss: 0.721, Test loss: 0.918, Test accuracy: 66.97
Round  30, Global train loss: 0.721, Global test loss: 1.441, Global test accuracy: 51.31
Round  31, Train loss: 0.735, Test loss: 0.914, Test accuracy: 67.06
Round  31, Global train loss: 0.735, Global test loss: 1.302, Global test accuracy: 55.62
Round  32, Train loss: 0.726, Test loss: 0.917, Test accuracy: 67.09
Round  32, Global train loss: 0.726, Global test loss: 1.339, Global test accuracy: 55.66
Round  33, Train loss: 0.757, Test loss: 0.906, Test accuracy: 67.36
Round  33, Global train loss: 0.757, Global test loss: 1.293, Global test accuracy: 55.84
Round  34, Train loss: 0.737, Test loss: 0.913, Test accuracy: 67.44
Round  34, Global train loss: 0.737, Global test loss: 1.392, Global test accuracy: 54.76
Round  35, Train loss: 0.727, Test loss: 0.912, Test accuracy: 67.55
Round  35, Global train loss: 0.727, Global test loss: 1.318, Global test accuracy: 55.19
Round  36, Train loss: 0.696, Test loss: 0.905, Test accuracy: 67.68
Round  36, Global train loss: 0.696, Global test loss: 1.460, Global test accuracy: 52.72
Round  37, Train loss: 0.704, Test loss: 0.892, Test accuracy: 68.39
Round  37, Global train loss: 0.704, Global test loss: 1.246, Global test accuracy: 56.32
Round  38, Train loss: 0.613, Test loss: 0.908, Test accuracy: 68.04
Round  38, Global train loss: 0.613, Global test loss: 1.381, Global test accuracy: 52.51
Round  39, Train loss: 0.635, Test loss: 0.909, Test accuracy: 68.15
Round  39, Global train loss: 0.635, Global test loss: 1.373, Global test accuracy: 53.59
Round  40, Train loss: 0.642, Test loss: 0.906, Test accuracy: 68.30
Round  40, Global train loss: 0.642, Global test loss: 1.369, Global test accuracy: 53.17
Round  41, Train loss: 0.783, Test loss: 0.903, Test accuracy: 68.52
Round  41, Global train loss: 0.783, Global test loss: 1.262, Global test accuracy: 55.69
Round  42, Train loss: 0.688, Test loss: 0.908, Test accuracy: 68.56
Round  42, Global train loss: 0.688, Global test loss: 1.161, Global test accuracy: 60.04
Round  43, Train loss: 0.603, Test loss: 0.915, Test accuracy: 68.23
Round  43, Global train loss: 0.603, Global test loss: 1.324, Global test accuracy: 56.06
Round  44, Train loss: 0.609, Test loss: 0.913, Test accuracy: 68.72
Round  44, Global train loss: 0.609, Global test loss: 1.364, Global test accuracy: 54.75
Round  45, Train loss: 0.704, Test loss: 0.919, Test accuracy: 69.10
Round  45, Global train loss: 0.704, Global test loss: 1.159, Global test accuracy: 59.95
Round  46, Train loss: 0.619, Test loss: 0.922, Test accuracy: 68.74
Round  46, Global train loss: 0.619, Global test loss: 1.361, Global test accuracy: 55.31
Round  47, Train loss: 0.591, Test loss: 0.927, Test accuracy: 69.00
Round  47, Global train loss: 0.591, Global test loss: 1.366, Global test accuracy: 54.96
Round  48, Train loss: 0.555, Test loss: 0.932, Test accuracy: 69.08
Round  48, Global train loss: 0.555, Global test loss: 1.472, Global test accuracy: 53.20
Round  49, Train loss: 0.567, Test loss: 0.927, Test accuracy: 69.23
Round  49, Global train loss: 0.567, Global test loss: 1.379, Global test accuracy: 55.90
Round  50, Train loss: 0.659, Test loss: 0.953, Test accuracy: 68.74
Round  50, Global train loss: 0.659, Global test loss: 1.252, Global test accuracy: 57.95
Round  51, Train loss: 0.526, Test loss: 0.946, Test accuracy: 68.99
Round  51, Global train loss: 0.526, Global test loss: 1.272, Global test accuracy: 59.59
Round  52, Train loss: 0.643, Test loss: 0.937, Test accuracy: 69.56
Round  52, Global train loss: 0.643, Global test loss: 1.152, Global test accuracy: 60.93
Round  53, Train loss: 0.527, Test loss: 0.961, Test accuracy: 69.33
Round  53, Global train loss: 0.527, Global test loss: 1.208, Global test accuracy: 59.75
Round  54, Train loss: 0.611, Test loss: 0.960, Test accuracy: 69.01
Round  54, Global train loss: 0.611, Global test loss: 1.267, Global test accuracy: 57.97
Round  55, Train loss: 0.571, Test loss: 0.941, Test accuracy: 70.34
Round  55, Global train loss: 0.571, Global test loss: 1.277, Global test accuracy: 58.74
Round  56, Train loss: 0.536, Test loss: 0.936, Test accuracy: 70.15
Round  56, Global train loss: 0.536, Global test loss: 1.311, Global test accuracy: 57.12
Round  57, Train loss: 0.505, Test loss: 0.913, Test accuracy: 70.58
Round  57, Global train loss: 0.505, Global test loss: 1.269, Global test accuracy: 59.35
Round  58, Train loss: 0.644, Test loss: 0.915, Test accuracy: 70.42
Round  58, Global train loss: 0.644, Global test loss: 1.237, Global test accuracy: 58.83
Round  59, Train loss: 0.535, Test loss: 0.906, Test accuracy: 70.79
Round  59, Global train loss: 0.535, Global test loss: 1.247, Global test accuracy: 60.20
Round  60, Train loss: 0.582, Test loss: 0.929, Test accuracy: 70.64
Round  60, Global train loss: 0.582, Global test loss: 1.347, Global test accuracy: 57.27
Round  61, Train loss: 0.503, Test loss: 0.922, Test accuracy: 70.74
Round  61, Global train loss: 0.503, Global test loss: 1.242, Global test accuracy: 59.84
Round  62, Train loss: 0.488, Test loss: 0.922, Test accuracy: 70.69
Round  62, Global train loss: 0.488, Global test loss: 1.310, Global test accuracy: 58.31
Round  63, Train loss: 0.488, Test loss: 0.957, Test accuracy: 70.14
Round  63, Global train loss: 0.488, Global test loss: 1.307, Global test accuracy: 59.20
Round  64, Train loss: 0.459, Test loss: 0.961, Test accuracy: 69.90
Round  64, Global train loss: 0.459, Global test loss: 1.367, Global test accuracy: 58.21
Round  65, Train loss: 0.469, Test loss: 0.954, Test accuracy: 70.25
Round  65, Global train loss: 0.469, Global test loss: 1.233, Global test accuracy: 60.62
Round  66, Train loss: 0.492, Test loss: 0.947, Test accuracy: 70.31
Round  66, Global train loss: 0.492, Global test loss: 1.293, Global test accuracy: 59.98
Round  67, Train loss: 0.430, Test loss: 0.955, Test accuracy: 70.65
Round  67, Global train loss: 0.430, Global test loss: 1.211, Global test accuracy: 61.28
Round  68, Train loss: 0.511, Test loss: 0.973, Test accuracy: 70.67
Round  68, Global train loss: 0.511, Global test loss: 1.295, Global test accuracy: 58.72
Round  69, Train loss: 0.484, Test loss: 0.970, Test accuracy: 70.80
Round  69, Global train loss: 0.484, Global test loss: 1.423, Global test accuracy: 56.85
Round  70, Train loss: 0.447, Test loss: 0.949, Test accuracy: 70.70
Round  70, Global train loss: 0.447, Global test loss: 1.190, Global test accuracy: 62.09
Round  71, Train loss: 0.436, Test loss: 0.973, Test accuracy: 70.40
Round  71, Global train loss: 0.436, Global test loss: 1.216, Global test accuracy: 61.52
Round  72, Train loss: 0.544, Test loss: 0.966, Test accuracy: 70.35
Round  72, Global train loss: 0.544, Global test loss: 1.225, Global test accuracy: 60.78
Round  73, Train loss: 0.430, Test loss: 0.979, Test accuracy: 70.19
Round  73, Global train loss: 0.430, Global test loss: 1.272, Global test accuracy: 60.19
Round  74, Train loss: 0.492, Test loss: 0.973, Test accuracy: 70.65
Round  74, Global train loss: 0.492, Global test loss: 1.189, Global test accuracy: 61.98
Round  75, Train loss: 0.373, Test loss: 0.965, Test accuracy: 71.13
Round  75, Global train loss: 0.373, Global test loss: 1.234, Global test accuracy: 62.40
Round  76, Train loss: 0.405, Test loss: 0.965, Test accuracy: 70.73
Round  76, Global train loss: 0.405, Global test loss: 1.271, Global test accuracy: 61.10
Round  77, Train loss: 0.379, Test loss: 0.972, Test accuracy: 71.04
Round  77, Global train loss: 0.379, Global test loss: 1.605, Global test accuracy: 57.34
Round  78, Train loss: 0.468, Test loss: 0.987, Test accuracy: 70.53
Round  78, Global train loss: 0.468, Global test loss: 1.278, Global test accuracy: 61.61
Round  79, Train loss: 0.526, Test loss: 0.993, Test accuracy: 70.67
Round  79, Global train loss: 0.526, Global test loss: 1.211, Global test accuracy: 60.78
Round  80, Train loss: 0.544, Test loss: 1.001, Test accuracy: 70.92
Round  80, Global train loss: 0.544, Global test loss: 1.223, Global test accuracy: 61.65
Round  81, Train loss: 0.386, Test loss: 0.999, Test accuracy: 71.04
Round  81, Global train loss: 0.386, Global test loss: 1.288, Global test accuracy: 61.22
Round  82, Train loss: 0.383, Test loss: 1.002, Test accuracy: 70.86
Round  82, Global train loss: 0.383, Global test loss: 1.415, Global test accuracy: 58.97
Round  83, Train loss: 0.413, Test loss: 1.013, Test accuracy: 70.59
Round  83, Global train loss: 0.413, Global test loss: 1.392, Global test accuracy: 59.22
Round  84, Train loss: 0.340, Test loss: 1.016, Test accuracy: 70.69
Round  84, Global train loss: 0.340, Global test loss: 1.635, Global test accuracy: 58.33
Round  85, Train loss: 0.477, Test loss: 1.003, Test accuracy: 71.07
Round  85, Global train loss: 0.477, Global test loss: 1.251, Global test accuracy: 61.04
Round  86, Train loss: 0.404, Test loss: 1.032, Test accuracy: 70.98
Round  86, Global train loss: 0.404, Global test loss: 1.340, Global test accuracy: 60.18
Round  87, Train loss: 0.463, Test loss: 1.017, Test accuracy: 71.18
Round  87, Global train loss: 0.463, Global test loss: 1.323, Global test accuracy: 60.71
Round  88, Train loss: 0.443, Test loss: 1.028, Test accuracy: 70.99
Round  88, Global train loss: 0.443, Global test loss: 1.360, Global test accuracy: 59.11
Round  89, Train loss: 0.418, Test loss: 1.014, Test accuracy: 70.98
Round  89, Global train loss: 0.418, Global test loss: 1.245, Global test accuracy: 62.21
Round  90, Train loss: 0.439, Test loss: 1.006, Test accuracy: 71.38
Round  90, Global train loss: 0.439, Global test loss: 1.208, Global test accuracy: 61.94
Round  91, Train loss: 0.424, Test loss: 1.001, Test accuracy: 71.61
Round  91, Global train loss: 0.424, Global test loss: 1.219, Global test accuracy: 62.35
Round  92, Train loss: 0.449, Test loss: 1.011, Test accuracy: 71.58
Round  92, Global train loss: 0.449, Global test loss: 1.425, Global test accuracy: 58.20
Round  93, Train loss: 0.436, Test loss: 1.007, Test accuracy: 71.54
Round  93, Global train loss: 0.436, Global test loss: 1.405, Global test accuracy: 58.31
Round  94, Train loss: 0.406, Test loss: 1.028, Test accuracy: 71.17
Round  94, Global train loss: 0.406, Global test loss: 1.274, Global test accuracy: 61.64
Round  95, Train loss: 0.368, Test loss: 1.064, Test accuracy: 70.54
Round  95, Global train loss: 0.368, Global test loss: 1.276, Global test accuracy: 62.37
Round  96, Train loss: 0.421, Test loss: 1.057, Test accuracy: 70.52
Round  96, Global train loss: 0.421, Global test loss: 1.239, Global test accuracy: 62.39
Round  97, Train loss: 0.374, Test loss: 1.038, Test accuracy: 71.24
Round  97, Global train loss: 0.374, Global test loss: 1.246, Global test accuracy: 62.58
Round  98, Train loss: 0.386, Test loss: 1.059, Test accuracy: 71.03
Round  98, Global train loss: 0.386, Global test loss: 1.321, Global test accuracy: 61.71
Round  99, Train loss: 0.362, Test loss: 1.042, Test accuracy: 71.39
Round  99, Global train loss: 0.362, Global test loss: 1.379, Global test accuracy: 61.36
Final Round, Train loss: 0.304, Test loss: 1.166, Test accuracy: 70.98
Final Round, Global train loss: 0.304, Global test loss: 1.379, Global test accuracy: 61.36
Average accuracy final 10 rounds: 71.2
Average global accuracy final 10 rounds: 61.285000000000004
2005.193166255951
[2.719733953475952, 5.219722747802734, 7.711611986160278, 10.141493797302246, 12.623674392700195, 15.13161849975586, 17.573561191558838, 20.080570220947266, 22.58272361755371, 25.016406774520874, 27.538856267929077, 30.058520555496216, 32.50588846206665, 35.017504930496216, 37.52101540565491, 39.96113419532776, 42.471500873565674, 44.955583810806274, 47.3774950504303, 49.865424394607544, 52.361279010772705, 54.82691240310669, 57.31145715713501, 59.7999153137207, 62.29478931427002, 64.78482985496521, 67.27409768104553, 69.75333309173584, 72.26800966262817, 74.79958248138428, 77.31815481185913, 79.82443928718567, 82.34087085723877, 84.83086109161377, 87.32722759246826, 89.84354257583618, 92.33104610443115, 94.82559013366699, 97.34939098358154, 99.85965776443481, 102.347177028656, 104.86710143089294, 107.39343166351318, 109.83541655540466, 112.3240385055542, 114.80429601669312, 117.23654174804688, 119.73371148109436, 122.21854043006897, 124.6429967880249, 127.1392765045166, 129.6277368068695, 132.05572199821472, 134.56538701057434, 137.06850266456604, 139.55010414123535, 142.04340410232544, 144.54856181144714, 147.079731464386, 149.58230113983154, 152.0843551158905, 154.55975341796875, 157.04591464996338, 159.60803413391113, 162.07532215118408, 164.54259371757507, 167.05430698394775, 169.54584383964539, 171.99467611312866, 174.50129580497742, 176.99103951454163, 179.4299521446228, 181.92935061454773, 184.4328157901764, 186.86845803260803, 189.36067962646484, 191.88779377937317, 194.32939338684082, 196.8339684009552, 199.3425748348236, 201.81849551200867, 204.30640959739685, 206.8125922679901, 209.30256581306458, 211.8090100288391, 214.32232475280762, 216.83219623565674, 219.328537940979, 221.833167552948, 224.34417080879211, 226.79869294166565, 229.31168222427368, 231.7972388267517, 234.21530628204346, 236.75676679611206, 239.24060249328613, 241.6545605659485, 244.14880919456482, 246.64756560325623, 249.05799889564514, 253.63538265228271]
[24.8, 28.44, 40.67, 43.29, 48.15, 50.72, 54.12, 56.31, 56.28, 56.35, 57.48, 58.37, 59.81, 60.56, 60.43, 61.35, 61.69, 61.72, 62.54, 62.78, 63.26, 62.86, 62.96, 63.67, 64.1, 63.86, 64.97, 64.72, 65.77, 66.18, 66.97, 67.06, 67.09, 67.36, 67.44, 67.55, 67.68, 68.39, 68.04, 68.15, 68.3, 68.52, 68.56, 68.23, 68.72, 69.1, 68.74, 69.0, 69.08, 69.23, 68.74, 68.99, 69.56, 69.33, 69.01, 70.34, 70.15, 70.58, 70.42, 70.79, 70.64, 70.74, 70.69, 70.14, 69.9, 70.25, 70.31, 70.65, 70.67, 70.8, 70.7, 70.4, 70.35, 70.19, 70.65, 71.13, 70.73, 71.04, 70.53, 70.67, 70.92, 71.04, 70.86, 70.59, 70.69, 71.07, 70.98, 71.18, 70.99, 70.98, 71.38, 71.61, 71.58, 71.54, 71.17, 70.54, 70.52, 71.24, 71.03, 71.39, 70.98]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  17.6000
Round 1 global test acc  13.1400
Round 2 global test acc  20.9000
Round 3 global test acc  24.0500
Round 4 global test acc  22.3100
Round 5 global test acc  27.6100
Round 6 global test acc  29.0100
Round 7 global test acc  25.1100
Round 8 global test acc  28.0600
Round 9 global test acc  34.8800
Round 10 global test acc  32.3400
Round 11 global test acc  34.9500
Round 12 global test acc  30.8300
Round 13 global test acc  30.7700
Round 14 global test acc  38.5600
Round 15 global test acc  34.6500
Round 16 global test acc  31.9000
Round 17 global test acc  36.2200
Round 18 global test acc  37.6900
Round 19 global test acc  33.1100
Round 20 global test acc  31.7900
Round 21 global test acc  37.4100
Round 22 global test acc  34.5100
Round 23 global test acc  37.1900
Round 24 global test acc  38.2100
Round 25 global test acc  32.8500
Round 26 global test acc  39.2500
Round 27 global test acc  34.8400
Round 28 global test acc  38.8600
Round 29 global test acc  42.1200
Round 30 global test acc  44.0200
Round 31 global test acc  39.3300
Round 32 global test acc  34.7200
Round 33 global test acc  36.5600
Round 34 global test acc  34.9400
Round 35 global test acc  37.7900
Round 36 global test acc  40.3900
Round 37 global test acc  40.0100
Round 38 global test acc  42.4900
Round 39 global test acc  35.0800
Round 40 global test acc  40.0400
Round 41 global test acc  46.7000
Round 42 global test acc  46.2800
Round 43 global test acc  41.1800
Round 44 global test acc  37.9700
Round 45 global test acc  41.0200
Round 46 global test acc  43.8900
Round 47 global test acc  42.3800
Round 48 global test acc  47.5800
Round 49 global test acc  43.1500
Round 50 global test acc  41.2900
Round 51 global test acc  42.5200
Round 52 global test acc  41.4900
Round 53 global test acc  38.9400
Round 54 global test acc  40.3900
Round 55 global test acc  38.6000
Round 56 global test acc  38.7000
Round 57 global test acc  47.9400
Round 58 global test acc  39.6500
Round 59 global test acc  38.4600
Round 60 global test acc  42.0800
Round 61 global test acc  43.1300
Round 62 global test acc  45.1000
Round 63 global test acc  43.2900
Round 64 global test acc  43.2300
Round 65 global test acc  47.9000
Round 66 global test acc  48.6300
Round 67 global test acc  44.6500
Round 68 global test acc  42.7500
Round 69 global test acc  41.1000
Round 70 global test acc  49.5200
Round 71 global test acc  45.5900
Round 72 global test acc  41.8500
Round 73 global test acc  48.6700
Round 74 global test acc  43.2500
Round 75 global test acc  41.5500
Round 76 global test acc  38.9200
Round 77 global test acc  41.6900
Round 78 global test acc  42.8200
Round 79 global test acc  39.7400
Round 80 global test acc  39.4000
Round 81 global test acc  37.8700
Round 82 global test acc  34.9500
Round 83 global test acc  31.2200
Round 84 global test acc  30.8500
Round 85 global test acc  30.6700
Round 86 global test acc  28.9500
Round 87 global test acc  28.4700
Round 88 global test acc  26.7800
Round 89 global test acc  26.6900
Round 90 global test acc  25.1700
Round 91 global test acc  24.5400
Round 92 global test acc  23.7700
Round 93 global test acc  24.3200
Round 94 global test acc  24.4000
Round 95 global test acc  24.3300
Round 96 global test acc  23.6600
Round 97 global test acc  22.7500
Round 98 global test acc  22.5400
Round 99 global test acc  22.9800
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.972, Test loss: 2.140, Test accuracy: 20.32
Round   1, Train loss: 1.633, Test loss: 1.902, Test accuracy: 27.28
Round   2, Train loss: 1.482, Test loss: 1.609, Test accuracy: 40.62
Round   3, Train loss: 1.423, Test loss: 1.474, Test accuracy: 44.66
Round   4, Train loss: 1.364, Test loss: 1.304, Test accuracy: 50.69
Round   5, Train loss: 1.246, Test loss: 1.236, Test accuracy: 53.72
Round   6, Train loss: 1.226, Test loss: 1.211, Test accuracy: 53.85
Round   7, Train loss: 1.188, Test loss: 1.112, Test accuracy: 56.88
Round   8, Train loss: 1.089, Test loss: 1.100, Test accuracy: 57.71
Round   9, Train loss: 1.132, Test loss: 1.078, Test accuracy: 59.16
Round  10, Train loss: 1.146, Test loss: 1.068, Test accuracy: 58.93
Round  11, Train loss: 1.125, Test loss: 1.035, Test accuracy: 60.22
Round  12, Train loss: 1.121, Test loss: 1.022, Test accuracy: 61.09
Round  13, Train loss: 1.096, Test loss: 1.015, Test accuracy: 61.01
Round  14, Train loss: 0.961, Test loss: 0.982, Test accuracy: 62.56
Round  15, Train loss: 1.066, Test loss: 0.973, Test accuracy: 63.00
Round  16, Train loss: 1.021, Test loss: 0.958, Test accuracy: 64.14
Round  17, Train loss: 1.100, Test loss: 0.963, Test accuracy: 63.54
Round  18, Train loss: 0.990, Test loss: 0.936, Test accuracy: 64.08
Round  19, Train loss: 0.966, Test loss: 0.923, Test accuracy: 65.71
Round  20, Train loss: 1.001, Test loss: 0.897, Test accuracy: 66.82
Round  21, Train loss: 0.926, Test loss: 0.897, Test accuracy: 67.63
Round  22, Train loss: 0.957, Test loss: 0.864, Test accuracy: 68.59
Round  23, Train loss: 0.969, Test loss: 0.862, Test accuracy: 68.48
Round  24, Train loss: 0.995, Test loss: 0.856, Test accuracy: 68.37
Round  25, Train loss: 0.863, Test loss: 0.852, Test accuracy: 69.03
Round  26, Train loss: 0.903, Test loss: 0.839, Test accuracy: 69.29
Round  27, Train loss: 0.854, Test loss: 0.841, Test accuracy: 69.47
Round  28, Train loss: 0.912, Test loss: 0.821, Test accuracy: 70.16
Round  29, Train loss: 0.946, Test loss: 0.818, Test accuracy: 69.77
Round  30, Train loss: 0.924, Test loss: 0.818, Test accuracy: 69.68
Round  31, Train loss: 0.880, Test loss: 0.807, Test accuracy: 70.15
Round  32, Train loss: 0.925, Test loss: 0.805, Test accuracy: 70.76
Round  33, Train loss: 0.842, Test loss: 0.803, Test accuracy: 70.38
Round  34, Train loss: 0.860, Test loss: 0.801, Test accuracy: 70.70
Round  35, Train loss: 0.939, Test loss: 0.786, Test accuracy: 71.13
Round  36, Train loss: 0.793, Test loss: 0.770, Test accuracy: 71.54
Round  37, Train loss: 0.825, Test loss: 0.763, Test accuracy: 71.96
Round  38, Train loss: 0.815, Test loss: 0.765, Test accuracy: 72.25
Round  39, Train loss: 0.850, Test loss: 0.764, Test accuracy: 71.94
Round  40, Train loss: 0.883, Test loss: 0.765, Test accuracy: 72.32
Round  41, Train loss: 0.852, Test loss: 0.769, Test accuracy: 72.27
Round  42, Train loss: 0.904, Test loss: 0.759, Test accuracy: 72.43
Round  43, Train loss: 0.806, Test loss: 0.751, Test accuracy: 72.30
Round  44, Train loss: 0.776, Test loss: 0.754, Test accuracy: 72.66
Round  45, Train loss: 0.771, Test loss: 0.738, Test accuracy: 72.79
Round  46, Train loss: 0.809, Test loss: 0.732, Test accuracy: 73.54
Round  47, Train loss: 0.741, Test loss: 0.740, Test accuracy: 73.00
Round  48, Train loss: 0.701, Test loss: 0.737, Test accuracy: 73.29
Round  49, Train loss: 0.647, Test loss: 0.727, Test accuracy: 73.57
Round  50, Train loss: 0.796, Test loss: 0.728, Test accuracy: 73.71
Round  51, Train loss: 0.621, Test loss: 0.717, Test accuracy: 73.72
Round  52, Train loss: 0.767, Test loss: 0.711, Test accuracy: 74.32
Round  53, Train loss: 0.698, Test loss: 0.719, Test accuracy: 74.22
Round  54, Train loss: 0.709, Test loss: 0.727, Test accuracy: 74.00
Round  55, Train loss: 0.763, Test loss: 0.716, Test accuracy: 73.75
Round  56, Train loss: 0.661, Test loss: 0.703, Test accuracy: 74.54
Round  57, Train loss: 0.621, Test loss: 0.703, Test accuracy: 74.59
Round  58, Train loss: 0.746, Test loss: 0.699, Test accuracy: 74.65
Round  59, Train loss: 0.623, Test loss: 0.703, Test accuracy: 74.49
Round  60, Train loss: 0.696, Test loss: 0.703, Test accuracy: 74.72
Round  61, Train loss: 0.619, Test loss: 0.705, Test accuracy: 74.46
Round  62, Train loss: 0.676, Test loss: 0.703, Test accuracy: 75.03
Round  63, Train loss: 0.621, Test loss: 0.698, Test accuracy: 74.98
Round  64, Train loss: 0.652, Test loss: 0.700, Test accuracy: 74.81
Round  65, Train loss: 0.613, Test loss: 0.701, Test accuracy: 74.75
Round  66, Train loss: 0.769, Test loss: 0.694, Test accuracy: 75.13
Round  67, Train loss: 0.595, Test loss: 0.692, Test accuracy: 74.74
Round  68, Train loss: 0.664, Test loss: 0.691, Test accuracy: 75.35
Round  69, Train loss: 0.599, Test loss: 0.692, Test accuracy: 75.40
Round  70, Train loss: 0.687, Test loss: 0.692, Test accuracy: 75.11
Round  71, Train loss: 0.681, Test loss: 0.693, Test accuracy: 75.17
Round  72, Train loss: 0.567, Test loss: 0.691, Test accuracy: 75.31
Round  73, Train loss: 0.668, Test loss: 0.682, Test accuracy: 75.53
Round  74, Train loss: 0.629, Test loss: 0.683, Test accuracy: 75.42
Round  75, Train loss: 0.542, Test loss: 0.689, Test accuracy: 75.12
Round  76, Train loss: 0.619, Test loss: 0.688, Test accuracy: 75.52
Round  77, Train loss: 0.542, Test loss: 0.689, Test accuracy: 75.50
Round  78, Train loss: 0.567, Test loss: 0.683, Test accuracy: 75.40
Round  79, Train loss: 0.621, Test loss: 0.690, Test accuracy: 75.35
Round  80, Train loss: 0.616, Test loss: 0.681, Test accuracy: 75.99
Round  81, Train loss: 0.538, Test loss: 0.686, Test accuracy: 75.38
Round  82, Train loss: 0.480, Test loss: 0.681, Test accuracy: 76.17
Round  83, Train loss: 0.506, Test loss: 0.680, Test accuracy: 75.71
Round  84, Train loss: 0.470, Test loss: 0.676, Test accuracy: 76.29
Round  85, Train loss: 0.629, Test loss: 0.676, Test accuracy: 76.23
Round  86, Train loss: 0.529, Test loss: 0.686, Test accuracy: 75.99
Round  87, Train loss: 0.521, Test loss: 0.677, Test accuracy: 76.26
Round  88, Train loss: 0.611, Test loss: 0.675, Test accuracy: 76.20
Round  89, Train loss: 0.537, Test loss: 0.671, Test accuracy: 76.48
Round  90, Train loss: 0.524, Test loss: 0.689, Test accuracy: 75.88
Round  91, Train loss: 0.541, Test loss: 0.687, Test accuracy: 75.81
Round  92, Train loss: 0.537, Test loss: 0.692, Test accuracy: 75.55
Round  93, Train loss: 0.568, Test loss: 0.674, Test accuracy: 76.45
Round  94, Train loss: 0.574, Test loss: 0.676, Test accuracy: 76.41
Round  95, Train loss: 0.491, Test loss: 0.682, Test accuracy: 75.91
Round  96, Train loss: 0.485, Test loss: 0.671, Test accuracy: 76.38
Round  97, Train loss: 0.539, Test loss: 0.677, Test accuracy: 76.31
Round  98, Train loss: 0.470, Test loss: 0.664, Test accuracy: 76.86
Round  99, Train loss: 0.481, Test loss: 0.683, Test accuracy: 76.42
Final Round, Train loss: 0.451, Test loss: 0.682, Test accuracy: 76.69
Average accuracy final 10 rounds: 76.198
982.2702887058258
[1.6490192413330078, 2.9721434116363525, 4.234870672225952, 5.503981113433838, 6.8015148639678955, 8.115201473236084, 9.42471194267273, 10.730384588241577, 12.022068977355957, 13.282907724380493, 14.548600196838379, 15.84915542602539, 17.15622568130493, 18.479588508605957, 19.780689477920532, 21.044957637786865, 22.32146954536438, 23.646836042404175, 24.962863206863403, 26.283807516098022, 27.60389733314514, 28.86599373817444, 30.132949590682983, 31.433352947235107, 32.73213052749634, 34.04523253440857, 35.352327823638916, 36.60965371131897, 37.87143683433533, 39.15709972381592, 40.46334958076477, 41.767003297805786, 43.07613015174866, 44.336833238601685, 45.59821391105652, 46.89315128326416, 48.21619415283203, 49.402382135391235, 50.57999348640442, 51.76378154754639, 52.895904302597046, 54.02713894844055, 55.1957311630249, 56.36697602272034, 57.541831493377686, 58.72811937332153, 59.918355226516724, 61.047062158584595, 62.16479444503784, 63.33977150917053, 64.51479768753052, 65.6890242099762, 66.86677360534668, 68.03374528884888, 69.15153193473816, 70.27389097213745, 71.45199608802795, 72.62128448486328, 73.8065140247345, 75.11337375640869, 76.37271976470947, 77.63378953933716, 78.92801332473755, 80.24097299575806, 81.56753206253052, 82.8814697265625, 84.18931889533997, 85.44861149787903, 86.70427751541138, 88.01234817504883, 89.19133973121643, 90.36715483665466, 91.54575562477112, 92.66174268722534, 93.78036546707153, 94.95231461524963, 96.1291835308075, 97.31493782997131, 98.483314037323, 99.6605544090271, 100.78003001213074, 101.89926767349243, 103.06726121902466, 104.24576449394226, 105.43611812591553, 106.7146098613739, 107.90504360198975, 109.03243732452393, 110.15039443969727, 111.32420945167542, 112.53266668319702, 113.71428442001343, 114.89354658126831, 116.06582880020142, 117.1856095790863, 118.30717086791992, 119.47708463668823, 120.65226674079895, 121.8352267742157, 123.00431275367737, 124.99580097198486]
[20.32, 27.28, 40.62, 44.66, 50.69, 53.72, 53.85, 56.88, 57.71, 59.16, 58.93, 60.22, 61.09, 61.01, 62.56, 63.0, 64.14, 63.54, 64.08, 65.71, 66.82, 67.63, 68.59, 68.48, 68.37, 69.03, 69.29, 69.47, 70.16, 69.77, 69.68, 70.15, 70.76, 70.38, 70.7, 71.13, 71.54, 71.96, 72.25, 71.94, 72.32, 72.27, 72.43, 72.3, 72.66, 72.79, 73.54, 73.0, 73.29, 73.57, 73.71, 73.72, 74.32, 74.22, 74.0, 73.75, 74.54, 74.59, 74.65, 74.49, 74.72, 74.46, 75.03, 74.98, 74.81, 74.75, 75.13, 74.74, 75.35, 75.4, 75.11, 75.17, 75.31, 75.53, 75.42, 75.12, 75.52, 75.5, 75.4, 75.35, 75.99, 75.38, 76.17, 75.71, 76.29, 76.23, 75.99, 76.26, 76.2, 76.48, 75.88, 75.81, 75.55, 76.45, 76.41, 75.91, 76.38, 76.31, 76.86, 76.42, 76.69]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.691, Test loss: 2.027, Test accuracy: 24.85
Round   0, Global train loss: 1.691, Global test loss: 2.222, Global test accuracy: 21.60
Round   1, Train loss: 1.488, Test loss: 1.737, Test accuracy: 29.93
Round   1, Global train loss: 1.488, Global test loss: 2.135, Global test accuracy: 20.15
Round   2, Train loss: 1.374, Test loss: 1.505, Test accuracy: 39.28
Round   2, Global train loss: 1.374, Global test loss: 2.023, Global test accuracy: 28.78
Round   3, Train loss: 1.334, Test loss: 1.443, Test accuracy: 42.12
Round   3, Global train loss: 1.334, Global test loss: 1.981, Global test accuracy: 29.00
Round   4, Train loss: 1.243, Test loss: 1.295, Test accuracy: 47.91
Round   4, Global train loss: 1.243, Global test loss: 1.776, Global test accuracy: 34.11
Round   5, Train loss: 1.133, Test loss: 1.237, Test accuracy: 50.38
Round   5, Global train loss: 1.133, Global test loss: 1.747, Global test accuracy: 37.07
Round   6, Train loss: 1.293, Test loss: 1.198, Test accuracy: 52.99
Round   6, Global train loss: 1.293, Global test loss: 1.798, Global test accuracy: 35.27
Round   7, Train loss: 1.261, Test loss: 1.140, Test accuracy: 55.34
Round   7, Global train loss: 1.261, Global test loss: 1.616, Global test accuracy: 42.87
Round   8, Train loss: 1.098, Test loss: 1.136, Test accuracy: 55.86
Round   8, Global train loss: 1.098, Global test loss: 1.623, Global test accuracy: 41.28
Round   9, Train loss: 1.175, Test loss: 1.118, Test accuracy: 56.70
Round   9, Global train loss: 1.175, Global test loss: 1.531, Global test accuracy: 45.51
Round  10, Train loss: 1.181, Test loss: 1.101, Test accuracy: 57.40
Round  10, Global train loss: 1.181, Global test loss: 1.550, Global test accuracy: 43.70
Round  11, Train loss: 1.200, Test loss: 1.061, Test accuracy: 59.80
Round  11, Global train loss: 1.200, Global test loss: 1.526, Global test accuracy: 46.74
Round  12, Train loss: 1.042, Test loss: 1.034, Test accuracy: 60.93
Round  12, Global train loss: 1.042, Global test loss: 1.583, Global test accuracy: 44.92
Round  13, Train loss: 1.008, Test loss: 1.019, Test accuracy: 61.23
Round  13, Global train loss: 1.008, Global test loss: 1.575, Global test accuracy: 45.82
Round  14, Train loss: 0.957, Test loss: 1.010, Test accuracy: 61.78
Round  14, Global train loss: 0.957, Global test loss: 1.590, Global test accuracy: 43.83
Round  15, Train loss: 1.017, Test loss: 1.003, Test accuracy: 61.92
Round  15, Global train loss: 1.017, Global test loss: 1.602, Global test accuracy: 44.27
Round  16, Train loss: 1.082, Test loss: 1.012, Test accuracy: 61.84
Round  16, Global train loss: 1.082, Global test loss: 1.470, Global test accuracy: 47.14
Round  17, Train loss: 1.049, Test loss: 1.009, Test accuracy: 61.89
Round  17, Global train loss: 1.049, Global test loss: 1.431, Global test accuracy: 49.38
Round  18, Train loss: 1.094, Test loss: 1.003, Test accuracy: 62.53
Round  18, Global train loss: 1.094, Global test loss: 1.408, Global test accuracy: 50.37
Round  19, Train loss: 0.869, Test loss: 0.989, Test accuracy: 63.18
Round  19, Global train loss: 0.869, Global test loss: 1.587, Global test accuracy: 47.58
Round  20, Train loss: 1.009, Test loss: 0.981, Test accuracy: 63.20
Round  20, Global train loss: 1.009, Global test loss: 1.349, Global test accuracy: 52.77
Round  21, Train loss: 0.975, Test loss: 0.979, Test accuracy: 63.43
Round  21, Global train loss: 0.975, Global test loss: 1.363, Global test accuracy: 51.58
Round  22, Train loss: 0.967, Test loss: 0.956, Test accuracy: 64.82
Round  22, Global train loss: 0.967, Global test loss: 1.403, Global test accuracy: 50.41
Round  23, Train loss: 0.940, Test loss: 0.943, Test accuracy: 65.68
Round  23, Global train loss: 0.940, Global test loss: 1.424, Global test accuracy: 49.32
Round  24, Train loss: 0.909, Test loss: 0.942, Test accuracy: 65.72
Round  24, Global train loss: 0.909, Global test loss: 1.470, Global test accuracy: 48.38
Round  25, Train loss: 0.885, Test loss: 0.940, Test accuracy: 65.95
Round  25, Global train loss: 0.885, Global test loss: 1.509, Global test accuracy: 50.23
Round  26, Train loss: 0.830, Test loss: 0.934, Test accuracy: 66.07
Round  26, Global train loss: 0.830, Global test loss: 1.388, Global test accuracy: 51.51
Round  27, Train loss: 0.768, Test loss: 0.935, Test accuracy: 66.09
Round  27, Global train loss: 0.768, Global test loss: 1.308, Global test accuracy: 54.19
Round  28, Train loss: 0.963, Test loss: 0.933, Test accuracy: 66.77
Round  28, Global train loss: 0.963, Global test loss: 1.351, Global test accuracy: 52.55
Round  29, Train loss: 0.812, Test loss: 0.943, Test accuracy: 66.92
Round  29, Global train loss: 0.812, Global test loss: 1.272, Global test accuracy: 55.50
Round  30, Train loss: 0.865, Test loss: 0.970, Test accuracy: 66.46
Round  30, Global train loss: 0.865, Global test loss: 1.356, Global test accuracy: 52.88
Round  31, Train loss: 0.746, Test loss: 0.959, Test accuracy: 66.37
Round  31, Global train loss: 0.746, Global test loss: 1.245, Global test accuracy: 56.97
Round  32, Train loss: 0.901, Test loss: 0.952, Test accuracy: 66.57
Round  32, Global train loss: 0.901, Global test loss: 1.304, Global test accuracy: 55.09
Round  33, Train loss: 0.883, Test loss: 0.953, Test accuracy: 66.33
Round  33, Global train loss: 0.883, Global test loss: 1.303, Global test accuracy: 54.59
Round  34, Train loss: 0.893, Test loss: 0.958, Test accuracy: 66.28
Round  34, Global train loss: 0.893, Global test loss: 1.353, Global test accuracy: 54.70
Round  35, Train loss: 0.918, Test loss: 0.934, Test accuracy: 66.99
Round  35, Global train loss: 0.918, Global test loss: 1.334, Global test accuracy: 54.87
Round  36, Train loss: 0.713, Test loss: 0.926, Test accuracy: 67.35
Round  36, Global train loss: 0.713, Global test loss: 1.453, Global test accuracy: 52.95
Round  37, Train loss: 0.779, Test loss: 0.916, Test accuracy: 67.84
Round  37, Global train loss: 0.779, Global test loss: 1.263, Global test accuracy: 57.02
Round  38, Train loss: 0.704, Test loss: 0.918, Test accuracy: 67.66
Round  38, Global train loss: 0.704, Global test loss: 1.260, Global test accuracy: 56.91
Round  39, Train loss: 0.654, Test loss: 0.919, Test accuracy: 68.02
Round  39, Global train loss: 0.654, Global test loss: 1.370, Global test accuracy: 52.55
Round  40, Train loss: 0.720, Test loss: 0.951, Test accuracy: 67.38
Round  40, Global train loss: 0.720, Global test loss: 1.388, Global test accuracy: 53.40
Round  41, Train loss: 0.806, Test loss: 0.921, Test accuracy: 67.90
Round  41, Global train loss: 0.806, Global test loss: 1.249, Global test accuracy: 56.68
Round  42, Train loss: 0.918, Test loss: 0.936, Test accuracy: 67.78
Round  42, Global train loss: 0.918, Global test loss: 1.272, Global test accuracy: 57.18
Round  43, Train loss: 0.753, Test loss: 0.928, Test accuracy: 68.04
Round  43, Global train loss: 0.753, Global test loss: 1.300, Global test accuracy: 56.92
Round  44, Train loss: 0.656, Test loss: 0.921, Test accuracy: 68.41
Round  44, Global train loss: 0.656, Global test loss: 1.441, Global test accuracy: 53.02
Round  45, Train loss: 0.749, Test loss: 0.923, Test accuracy: 68.57
Round  45, Global train loss: 0.749, Global test loss: 1.200, Global test accuracy: 59.00
Round  46, Train loss: 0.658, Test loss: 0.928, Test accuracy: 68.41
Round  46, Global train loss: 0.658, Global test loss: 1.243, Global test accuracy: 58.75
Round  47, Train loss: 0.573, Test loss: 0.945, Test accuracy: 68.23
Round  47, Global train loss: 0.573, Global test loss: 1.410, Global test accuracy: 54.40
Round  48, Train loss: 0.612, Test loss: 0.934, Test accuracy: 69.00
Round  48, Global train loss: 0.612, Global test loss: 1.505, Global test accuracy: 53.13
Round  49, Train loss: 0.511, Test loss: 0.930, Test accuracy: 69.24
Round  49, Global train loss: 0.511, Global test loss: 1.294, Global test accuracy: 57.85
Round  50, Train loss: 0.708, Test loss: 0.934, Test accuracy: 68.78
Round  50, Global train loss: 0.708, Global test loss: 1.230, Global test accuracy: 58.24
Round  51, Train loss: 0.533, Test loss: 0.939, Test accuracy: 68.92
Round  51, Global train loss: 0.533, Global test loss: 1.279, Global test accuracy: 59.06
Round  52, Train loss: 0.633, Test loss: 0.954, Test accuracy: 68.62
Round  52, Global train loss: 0.633, Global test loss: 1.113, Global test accuracy: 62.34
Round  53, Train loss: 0.600, Test loss: 0.956, Test accuracy: 68.76
Round  53, Global train loss: 0.600, Global test loss: 1.205, Global test accuracy: 59.61
Round  54, Train loss: 0.557, Test loss: 0.951, Test accuracy: 69.02
Round  54, Global train loss: 0.557, Global test loss: 1.294, Global test accuracy: 58.28
Round  55, Train loss: 0.707, Test loss: 0.950, Test accuracy: 68.89
Round  55, Global train loss: 0.707, Global test loss: 1.311, Global test accuracy: 58.18
Round  56, Train loss: 0.491, Test loss: 0.925, Test accuracy: 69.57
Round  56, Global train loss: 0.491, Global test loss: 1.338, Global test accuracy: 57.04
Round  57, Train loss: 0.537, Test loss: 0.932, Test accuracy: 69.13
Round  57, Global train loss: 0.537, Global test loss: 1.261, Global test accuracy: 60.14
Round  58, Train loss: 0.725, Test loss: 0.940, Test accuracy: 69.74
Round  58, Global train loss: 0.725, Global test loss: 1.288, Global test accuracy: 58.63
Round  59, Train loss: 0.553, Test loss: 0.944, Test accuracy: 69.53
Round  59, Global train loss: 0.553, Global test loss: 1.224, Global test accuracy: 60.89
Round  60, Train loss: 0.679, Test loss: 0.944, Test accuracy: 69.62
Round  60, Global train loss: 0.679, Global test loss: 1.444, Global test accuracy: 54.94
Round  61, Train loss: 0.523, Test loss: 0.970, Test accuracy: 68.84
Round  61, Global train loss: 0.523, Global test loss: 1.299, Global test accuracy: 58.80
Round  62, Train loss: 0.460, Test loss: 0.968, Test accuracy: 69.14
Round  62, Global train loss: 0.460, Global test loss: 1.351, Global test accuracy: 57.00
Round  63, Train loss: 0.584, Test loss: 0.967, Test accuracy: 69.32
Round  63, Global train loss: 0.584, Global test loss: 1.318, Global test accuracy: 58.32
Round  64, Train loss: 0.542, Test loss: 0.968, Test accuracy: 69.62
Round  64, Global train loss: 0.542, Global test loss: 1.349, Global test accuracy: 59.07
Round  65, Train loss: 0.518, Test loss: 0.969, Test accuracy: 69.64
Round  65, Global train loss: 0.518, Global test loss: 1.249, Global test accuracy: 59.95
Round  66, Train loss: 0.624, Test loss: 0.949, Test accuracy: 70.25
Round  66, Global train loss: 0.624, Global test loss: 1.318, Global test accuracy: 57.87
Round  67, Train loss: 0.438, Test loss: 0.954, Test accuracy: 70.05
Round  67, Global train loss: 0.438, Global test loss: 1.266, Global test accuracy: 60.37
Round  68, Train loss: 0.576, Test loss: 0.967, Test accuracy: 69.92
Round  68, Global train loss: 0.576, Global test loss: 1.199, Global test accuracy: 61.43
Round  69, Train loss: 0.449, Test loss: 0.954, Test accuracy: 70.24
Round  69, Global train loss: 0.449, Global test loss: 1.384, Global test accuracy: 58.48
Round  70, Train loss: 0.508, Test loss: 0.951, Test accuracy: 70.64
Round  70, Global train loss: 0.508, Global test loss: 1.306, Global test accuracy: 60.35
Round  71, Train loss: 0.493, Test loss: 0.967, Test accuracy: 70.44
Round  71, Global train loss: 0.493, Global test loss: 1.173, Global test accuracy: 62.49
Round  72, Train loss: 0.532, Test loss: 0.965, Test accuracy: 70.78
Round  72, Global train loss: 0.532, Global test loss: 1.262, Global test accuracy: 60.89
Round  73, Train loss: 0.479, Test loss: 0.990, Test accuracy: 70.36
Round  73, Global train loss: 0.479, Global test loss: 1.332, Global test accuracy: 59.55
Round  74, Train loss: 0.527, Test loss: 0.965, Test accuracy: 70.63
Round  74, Global train loss: 0.527, Global test loss: 1.167, Global test accuracy: 62.55
Round  75, Train loss: 0.471, Test loss: 0.968, Test accuracy: 70.50
Round  75, Global train loss: 0.471, Global test loss: 1.241, Global test accuracy: 61.61
Round  76, Train loss: 0.520, Test loss: 0.990, Test accuracy: 70.45
Round  76, Global train loss: 0.520, Global test loss: 1.351, Global test accuracy: 59.60
Round  77, Train loss: 0.476, Test loss: 1.027, Test accuracy: 69.27
Round  77, Global train loss: 0.476, Global test loss: 1.437, Global test accuracy: 57.71
Round  78, Train loss: 0.558, Test loss: 1.036, Test accuracy: 69.09
Round  78, Global train loss: 0.558, Global test loss: 1.247, Global test accuracy: 61.99
Round  79, Train loss: 0.592, Test loss: 1.057, Test accuracy: 68.49
Round  79, Global train loss: 0.592, Global test loss: 1.244, Global test accuracy: 60.33
Round  80, Train loss: 0.523, Test loss: 1.055, Test accuracy: 68.84
Round  80, Global train loss: 0.523, Global test loss: 1.197, Global test accuracy: 63.03
Round  81, Train loss: 0.394, Test loss: 1.056, Test accuracy: 68.64
Round  81, Global train loss: 0.394, Global test loss: 1.334, Global test accuracy: 60.86
Round  82, Train loss: 0.422, Test loss: 1.045, Test accuracy: 69.10
Round  82, Global train loss: 0.422, Global test loss: 1.427, Global test accuracy: 60.05
Round  83, Train loss: 0.474, Test loss: 1.042, Test accuracy: 69.25
Round  83, Global train loss: 0.474, Global test loss: 1.374, Global test accuracy: 61.57
Round  84, Train loss: 0.432, Test loss: 1.003, Test accuracy: 70.25
Round  84, Global train loss: 0.432, Global test loss: 1.615, Global test accuracy: 58.24
Round  85, Train loss: 0.477, Test loss: 1.021, Test accuracy: 69.86
Round  85, Global train loss: 0.477, Global test loss: 1.277, Global test accuracy: 61.82
Round  86, Train loss: 0.410, Test loss: 1.017, Test accuracy: 69.99
Round  86, Global train loss: 0.410, Global test loss: 1.312, Global test accuracy: 61.25
Round  87, Train loss: 0.475, Test loss: 1.026, Test accuracy: 70.49
Round  87, Global train loss: 0.475, Global test loss: 1.427, Global test accuracy: 59.06
Round  88, Train loss: 0.494, Test loss: 1.022, Test accuracy: 70.49
Round  88, Global train loss: 0.494, Global test loss: 1.288, Global test accuracy: 60.70
Round  89, Train loss: 0.420, Test loss: 1.034, Test accuracy: 70.78
Round  89, Global train loss: 0.420, Global test loss: 1.401, Global test accuracy: 59.63
Round  90, Train loss: 0.443, Test loss: 1.041, Test accuracy: 70.44
Round  90, Global train loss: 0.443, Global test loss: 1.270, Global test accuracy: 61.12
Round  91, Train loss: 0.550, Test loss: 1.034, Test accuracy: 70.55
Round  91, Global train loss: 0.550, Global test loss: 1.240, Global test accuracy: 62.95
Round  92, Train loss: 0.454, Test loss: 1.014, Test accuracy: 71.18
Round  92, Global train loss: 0.454, Global test loss: 1.537, Global test accuracy: 57.10
Round  93, Train loss: 0.505, Test loss: 1.031, Test accuracy: 70.68
Round  93, Global train loss: 0.505, Global test loss: 1.310, Global test accuracy: 60.10
Round  94, Train loss: 0.426, Test loss: 1.027, Test accuracy: 70.62
Round  94, Global train loss: 0.426, Global test loss: 1.257, Global test accuracy: 63.08
Round  95, Train loss: 0.362, Test loss: 1.034, Test accuracy: 70.60
Round  95, Global train loss: 0.362, Global test loss: 1.270, Global test accuracy: 64.22
Round  96, Train loss: 0.479, Test loss: 1.092, Test accuracy: 69.37
Round  96, Global train loss: 0.479, Global test loss: 1.254, Global test accuracy: 62.16
Round  97, Train loss: 0.450, Test loss: 1.058, Test accuracy: 70.10
Round  97, Global train loss: 0.450, Global test loss: 1.276, Global test accuracy: 61.82
Round  98, Train loss: 0.435, Test loss: 1.061, Test accuracy: 70.13
Round  98, Global train loss: 0.435, Global test loss: 1.338, Global test accuracy: 61.61
Round  99, Train loss: 0.400, Test loss: 1.088, Test accuracy: 69.87
Round  99, Global train loss: 0.400, Global test loss: 1.340, Global test accuracy: 61.61
Final Round, Train loss: 0.343, Test loss: 1.219, Test accuracy: 69.54
Final Round, Global train loss: 0.343, Global test loss: 1.340, Global test accuracy: 61.61
Average accuracy final 10 rounds: 70.354
Average global accuracy final 10 rounds: 61.577000000000005
1684.555278301239
[1.4697284698486328, 2.6507790088653564, 3.776911497116089, 4.891639947891235, 6.048627853393555, 7.263978719711304, 8.445448160171509, 9.626001358032227, 10.74495267868042, 11.902485847473145, 13.087057113647461, 14.26180362701416, 15.429196119308472, 16.621062517166138, 17.787386178970337, 18.95871090888977, 20.147420406341553, 21.303144454956055, 22.483360290527344, 23.595369815826416, 24.7053120136261, 27.07187843322754, 29.421683311462402, 31.69686532020569, 34.02030563354492, 36.352057456970215, 38.69755721092224, 40.947368144989014, 43.29870963096619, 45.643786907196045, 47.76521110534668, 49.98547005653381, 52.20243716239929, 54.4423553943634, 56.56058621406555, 58.766531229019165, 60.997798919677734, 63.22272777557373, 65.38650918006897, 67.60772585868835, 69.89937281608582, 72.01999521255493, 74.23582053184509, 76.46202564239502, 78.69039702415466, 80.80224108695984, 83.03083658218384, 85.22870326042175, 87.44801950454712, 89.60361671447754, 91.812490940094, 94.01834392547607, 96.13161993026733, 98.34296226501465, 100.57121515274048, 102.77331852912903, 104.88986039161682, 107.10889220237732, 109.30725932121277, 111.51630282402039, 113.71750688552856, 115.92226529121399, 118.17104291915894, 120.28513693809509, 122.50581073760986, 124.71307444572449, 126.9184193611145, 129.01403617858887, 131.21561217308044, 133.3982162475586, 135.5468876361847, 137.71299934387207, 140.12640142440796, 142.48135709762573, 144.6807382106781, 147.0263524055481, 149.39551711082458, 151.73943185806274, 154.00112223625183, 156.3531482219696, 158.70496487617493, 160.93525552749634, 163.26746487617493, 165.58210682868958, 167.95820665359497, 170.20177626609802, 172.58820366859436, 174.96449756622314, 177.2325940132141, 179.56184840202332, 181.94025301933289, 184.26498985290527, 186.50081658363342, 188.89139604568481, 191.19921970367432, 193.42519545555115, 195.68761348724365, 198.03136706352234, 200.40566205978394, 202.64369201660156, 205.01136827468872]
[24.85, 29.93, 39.28, 42.12, 47.91, 50.38, 52.99, 55.34, 55.86, 56.7, 57.4, 59.8, 60.93, 61.23, 61.78, 61.92, 61.84, 61.89, 62.53, 63.18, 63.2, 63.43, 64.82, 65.68, 65.72, 65.95, 66.07, 66.09, 66.77, 66.92, 66.46, 66.37, 66.57, 66.33, 66.28, 66.99, 67.35, 67.84, 67.66, 68.02, 67.38, 67.9, 67.78, 68.04, 68.41, 68.57, 68.41, 68.23, 69.0, 69.24, 68.78, 68.92, 68.62, 68.76, 69.02, 68.89, 69.57, 69.13, 69.74, 69.53, 69.62, 68.84, 69.14, 69.32, 69.62, 69.64, 70.25, 70.05, 69.92, 70.24, 70.64, 70.44, 70.78, 70.36, 70.63, 70.5, 70.45, 69.27, 69.09, 68.49, 68.84, 68.64, 69.1, 69.25, 70.25, 69.86, 69.99, 70.49, 70.49, 70.78, 70.44, 70.55, 71.18, 70.68, 70.62, 70.6, 69.37, 70.1, 70.13, 69.87, 69.54]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.502, Test loss: 1.289, Test accuracy: 46.33
Round   0, Global train loss: 1.502, Global test loss: 2.099, Global test accuracy: 26.73
Round   1, Train loss: 1.280, Test loss: 1.152, Test accuracy: 54.13
Round   1, Global train loss: 1.280, Global test loss: 1.799, Global test accuracy: 37.27
Round   2, Train loss: 1.150, Test loss: 1.059, Test accuracy: 57.86
Round   2, Global train loss: 1.150, Global test loss: 1.638, Global test accuracy: 41.36
Round   3, Train loss: 1.073, Test loss: 1.047, Test accuracy: 59.32
Round   3, Global train loss: 1.073, Global test loss: 1.539, Global test accuracy: 45.81
Round   4, Train loss: 1.015, Test loss: 1.003, Test accuracy: 61.28
Round   4, Global train loss: 1.015, Global test loss: 1.468, Global test accuracy: 47.91
Round   5, Train loss: 0.964, Test loss: 1.005, Test accuracy: 62.23
Round   5, Global train loss: 0.964, Global test loss: 1.413, Global test accuracy: 49.91
Round   6, Train loss: 0.918, Test loss: 0.987, Test accuracy: 63.50
Round   6, Global train loss: 0.918, Global test loss: 1.367, Global test accuracy: 52.31
Round   7, Train loss: 0.875, Test loss: 0.984, Test accuracy: 64.41
Round   7, Global train loss: 0.875, Global test loss: 1.318, Global test accuracy: 54.16
Round   8, Train loss: 0.835, Test loss: 0.968, Test accuracy: 65.22
Round   8, Global train loss: 0.835, Global test loss: 1.294, Global test accuracy: 55.43
Round   9, Train loss: 0.797, Test loss: 0.973, Test accuracy: 65.39
Round   9, Global train loss: 0.797, Global test loss: 1.255, Global test accuracy: 57.41
Round  10, Train loss: 0.805, Test loss: 0.997, Test accuracy: 65.60
Round  10, Global train loss: 0.805, Global test loss: 1.269, Global test accuracy: 55.45
Round  11, Train loss: 0.748, Test loss: 1.000, Test accuracy: 66.05
Round  11, Global train loss: 0.748, Global test loss: 1.332, Global test accuracy: 55.11
Round  12, Train loss: 0.657, Test loss: 1.008, Test accuracy: 66.02
Round  12, Global train loss: 0.657, Global test loss: 1.463, Global test accuracy: 54.02
Round  13, Train loss: 0.678, Test loss: 0.964, Test accuracy: 67.16
Round  13, Global train loss: 0.678, Global test loss: 1.418, Global test accuracy: 52.79
Round  14, Train loss: 0.623, Test loss: 0.966, Test accuracy: 67.07
Round  14, Global train loss: 0.623, Global test loss: 1.459, Global test accuracy: 52.08
Round  15, Train loss: 0.581, Test loss: 0.990, Test accuracy: 66.95
Round  15, Global train loss: 0.581, Global test loss: 1.515, Global test accuracy: 52.41
Round  16, Train loss: 0.613, Test loss: 0.974, Test accuracy: 67.65
Round  16, Global train loss: 0.613, Global test loss: 1.312, Global test accuracy: 56.92
Round  17, Train loss: 0.589, Test loss: 0.982, Test accuracy: 67.91
Round  17, Global train loss: 0.589, Global test loss: 1.319, Global test accuracy: 55.69
Round  18, Train loss: 0.607, Test loss: 0.990, Test accuracy: 68.27
Round  18, Global train loss: 0.607, Global test loss: 1.323, Global test accuracy: 55.63
Round  19, Train loss: 0.486, Test loss: 1.010, Test accuracy: 68.04
Round  19, Global train loss: 0.486, Global test loss: 1.582, Global test accuracy: 54.11
Round  20, Train loss: 0.526, Test loss: 1.002, Test accuracy: 68.68
Round  20, Global train loss: 0.526, Global test loss: 1.304, Global test accuracy: 58.49
Round  21, Train loss: 0.484, Test loss: 1.029, Test accuracy: 68.50
Round  21, Global train loss: 0.484, Global test loss: 1.347, Global test accuracy: 56.95
Round  22, Train loss: 0.594, Test loss: 1.045, Test accuracy: 68.54
Round  22, Global train loss: 0.594, Global test loss: 1.319, Global test accuracy: 57.34
Round  23, Train loss: 0.441, Test loss: 1.038, Test accuracy: 68.75
Round  23, Global train loss: 0.441, Global test loss: 1.465, Global test accuracy: 55.73
Round  24, Train loss: 0.459, Test loss: 1.030, Test accuracy: 68.73
Round  24, Global train loss: 0.459, Global test loss: 1.458, Global test accuracy: 55.69
Round  25, Train loss: 0.433, Test loss: 1.027, Test accuracy: 69.30
Round  25, Global train loss: 0.433, Global test loss: 1.708, Global test accuracy: 55.65
Round  26, Train loss: 0.425, Test loss: 1.047, Test accuracy: 69.22
Round  26, Global train loss: 0.425, Global test loss: 1.530, Global test accuracy: 57.11
Round  27, Train loss: 0.421, Test loss: 1.054, Test accuracy: 69.54
Round  27, Global train loss: 0.421, Global test loss: 1.334, Global test accuracy: 59.82
Round  28, Train loss: 0.459, Test loss: 1.049, Test accuracy: 69.57
Round  28, Global train loss: 0.459, Global test loss: 1.371, Global test accuracy: 58.14
Round  29, Train loss: 0.402, Test loss: 1.059, Test accuracy: 69.25
Round  29, Global train loss: 0.402, Global test loss: 1.350, Global test accuracy: 59.95
Round  30, Train loss: 0.385, Test loss: 1.074, Test accuracy: 69.47
Round  30, Global train loss: 0.385, Global test loss: 1.500, Global test accuracy: 57.14
Round  31, Train loss: 0.443, Test loss: 1.084, Test accuracy: 69.54
Round  31, Global train loss: 0.443, Global test loss: 1.243, Global test accuracy: 61.70
Round  32, Train loss: 0.396, Test loss: 1.115, Test accuracy: 69.64
Round  32, Global train loss: 0.396, Global test loss: 1.376, Global test accuracy: 60.50
Round  33, Train loss: 0.371, Test loss: 1.092, Test accuracy: 70.14
Round  33, Global train loss: 0.371, Global test loss: 1.350, Global test accuracy: 60.93
Round  34, Train loss: 0.365, Test loss: 1.128, Test accuracy: 69.88
Round  34, Global train loss: 0.365, Global test loss: 1.466, Global test accuracy: 58.93
Round  35, Train loss: 0.375, Test loss: 1.128, Test accuracy: 69.94
Round  35, Global train loss: 0.375, Global test loss: 1.450, Global test accuracy: 58.19
Round  36, Train loss: 0.387, Test loss: 1.116, Test accuracy: 70.56
Round  36, Global train loss: 0.387, Global test loss: 1.624, Global test accuracy: 56.03
Round  37, Train loss: 0.392, Test loss: 1.135, Test accuracy: 70.16
Round  37, Global train loss: 0.392, Global test loss: 1.363, Global test accuracy: 60.02
Round  38, Train loss: 0.315, Test loss: 1.129, Test accuracy: 70.44
Round  38, Global train loss: 0.315, Global test loss: 1.487, Global test accuracy: 59.47
Round  39, Train loss: 0.345, Test loss: 1.127, Test accuracy: 71.03
Round  39, Global train loss: 0.345, Global test loss: 1.513, Global test accuracy: 58.00
Round  40, Train loss: 0.317, Test loss: 1.167, Test accuracy: 70.80
Round  40, Global train loss: 0.317, Global test loss: 1.523, Global test accuracy: 58.67
Round  41, Train loss: 0.357, Test loss: 1.154, Test accuracy: 70.65
Round  41, Global train loss: 0.357, Global test loss: 1.383, Global test accuracy: 59.75
Round  42, Train loss: 0.332, Test loss: 1.169, Test accuracy: 70.87
Round  42, Global train loss: 0.332, Global test loss: 1.320, Global test accuracy: 61.08
Round  43, Train loss: 0.298, Test loss: 1.169, Test accuracy: 71.30
Round  43, Global train loss: 0.298, Global test loss: 1.496, Global test accuracy: 60.41
Round  44, Train loss: 0.318, Test loss: 1.144, Test accuracy: 71.79
Round  44, Global train loss: 0.318, Global test loss: 1.532, Global test accuracy: 58.36
Round  45, Train loss: 0.395, Test loss: 1.125, Test accuracy: 72.03
Round  45, Global train loss: 0.395, Global test loss: 1.301, Global test accuracy: 60.57
Round  46, Train loss: 0.304, Test loss: 1.163, Test accuracy: 71.55
Round  46, Global train loss: 0.304, Global test loss: 1.502, Global test accuracy: 59.65
Round  47, Train loss: 0.307, Test loss: 1.177, Test accuracy: 71.30
Round  47, Global train loss: 0.307, Global test loss: 1.492, Global test accuracy: 59.31
Round  48, Train loss: 0.264, Test loss: 1.172, Test accuracy: 71.20
Round  48, Global train loss: 0.264, Global test loss: 1.738, Global test accuracy: 56.63
Round  49, Train loss: 0.347, Test loss: 1.201, Test accuracy: 70.88
Round  49, Global train loss: 0.347, Global test loss: 1.547, Global test accuracy: 58.39
Round  50, Train loss: 0.336, Test loss: 1.221, Test accuracy: 70.87
Round  50, Global train loss: 0.336, Global test loss: 1.516, Global test accuracy: 58.05
Round  51, Train loss: 0.265, Test loss: 1.224, Test accuracy: 71.18
Round  51, Global train loss: 0.265, Global test loss: 1.496, Global test accuracy: 61.36
Round  52, Train loss: 0.273, Test loss: 1.237, Test accuracy: 71.19
Round  52, Global train loss: 0.273, Global test loss: 1.270, Global test accuracy: 64.31
Round  53, Train loss: 0.277, Test loss: 1.210, Test accuracy: 71.18
Round  53, Global train loss: 0.277, Global test loss: 1.366, Global test accuracy: 61.95
Round  54, Train loss: 0.281, Test loss: 1.218, Test accuracy: 71.10
Round  54, Global train loss: 0.281, Global test loss: 1.461, Global test accuracy: 60.83
Round  55, Train loss: 0.277, Test loss: 1.222, Test accuracy: 71.44
Round  55, Global train loss: 0.277, Global test loss: 1.507, Global test accuracy: 60.89
Round  56, Train loss: 0.267, Test loss: 1.269, Test accuracy: 70.80
Round  56, Global train loss: 0.267, Global test loss: 1.610, Global test accuracy: 59.08
Round  57, Train loss: 0.252, Test loss: 1.252, Test accuracy: 71.19
Round  57, Global train loss: 0.252, Global test loss: 1.471, Global test accuracy: 61.11
Round  58, Train loss: 0.325, Test loss: 1.243, Test accuracy: 71.55
Round  58, Global train loss: 0.325, Global test loss: 1.459, Global test accuracy: 59.46
Round  59, Train loss: 0.305, Test loss: 1.214, Test accuracy: 72.21
Round  59, Global train loss: 0.305, Global test loss: 1.405, Global test accuracy: 61.34
Round  60, Train loss: 0.265, Test loss: 1.257, Test accuracy: 71.45
Round  60, Global train loss: 0.265, Global test loss: 1.814, Global test accuracy: 56.03
Round  61, Train loss: 0.258, Test loss: 1.248, Test accuracy: 71.69
Round  61, Global train loss: 0.258, Global test loss: 1.505, Global test accuracy: 61.02
Round  62, Train loss: 0.211, Test loss: 1.229, Test accuracy: 72.03
Round  62, Global train loss: 0.211, Global test loss: 1.595, Global test accuracy: 60.68
Round  63, Train loss: 0.261, Test loss: 1.205, Test accuracy: 72.16
Round  63, Global train loss: 0.261, Global test loss: 1.466, Global test accuracy: 60.87
Round  64, Train loss: 0.212, Test loss: 1.215, Test accuracy: 72.19
Round  64, Global train loss: 0.212, Global test loss: 1.608, Global test accuracy: 60.81
Round  65, Train loss: 0.239, Test loss: 1.231, Test accuracy: 72.07
Round  65, Global train loss: 0.239, Global test loss: 1.550, Global test accuracy: 60.44
Round  66, Train loss: 0.244, Test loss: 1.231, Test accuracy: 71.81
Round  66, Global train loss: 0.244, Global test loss: 1.545, Global test accuracy: 61.59
Round  67, Train loss: 0.203, Test loss: 1.225, Test accuracy: 71.87
Round  67, Global train loss: 0.203, Global test loss: 1.483, Global test accuracy: 63.15
Round  68, Train loss: 0.243, Test loss: 1.251, Test accuracy: 71.92
Round  68, Global train loss: 0.243, Global test loss: 1.423, Global test accuracy: 62.88
Round  69, Train loss: 0.260, Test loss: 1.234, Test accuracy: 72.30
Round  69, Global train loss: 0.260, Global test loss: 1.516, Global test accuracy: 59.60
Round  70, Train loss: 0.190, Test loss: 1.244, Test accuracy: 72.10
Round  70, Global train loss: 0.190, Global test loss: 1.461, Global test accuracy: 62.94
Round  71, Train loss: 0.179, Test loss: 1.240, Test accuracy: 72.31
Round  71, Global train loss: 0.179, Global test loss: 1.424, Global test accuracy: 63.11
Round  72, Train loss: 0.264, Test loss: 1.245, Test accuracy: 72.36
Round  72, Global train loss: 0.264, Global test loss: 1.453, Global test accuracy: 61.55
Round  73, Train loss: 0.208, Test loss: 1.259, Test accuracy: 72.32
Round  73, Global train loss: 0.208, Global test loss: 1.490, Global test accuracy: 62.69
Round  74, Train loss: 0.199, Test loss: 1.234, Test accuracy: 72.48
Round  74, Global train loss: 0.199, Global test loss: 1.422, Global test accuracy: 63.81
Round  75, Train loss: 0.202, Test loss: 1.228, Test accuracy: 72.61
Round  75, Global train loss: 0.202, Global test loss: 1.450, Global test accuracy: 63.01
Round  76, Train loss: 0.182, Test loss: 1.240, Test accuracy: 72.31
Round  76, Global train loss: 0.182, Global test loss: 1.610, Global test accuracy: 62.05
Round  77, Train loss: 0.192, Test loss: 1.265, Test accuracy: 72.48
Round  77, Global train loss: 0.192, Global test loss: 1.849, Global test accuracy: 60.15
Round  78, Train loss: 0.206, Test loss: 1.280, Test accuracy: 72.66
Round  78, Global train loss: 0.206, Global test loss: 1.562, Global test accuracy: 62.25
Round  79, Train loss: 0.210, Test loss: 1.309, Test accuracy: 72.59
Round  79, Global train loss: 0.210, Global test loss: 1.462, Global test accuracy: 63.18
Round  80, Train loss: 0.152, Test loss: 1.307, Test accuracy: 72.29
Round  80, Global train loss: 0.152, Global test loss: 1.479, Global test accuracy: 64.15
Round  81, Train loss: 0.140, Test loss: 1.339, Test accuracy: 72.22
Round  81, Global train loss: 0.140, Global test loss: 1.520, Global test accuracy: 64.38
Round  82, Train loss: 0.129, Test loss: 1.321, Test accuracy: 72.55
Round  82, Global train loss: 0.129, Global test loss: 1.561, Global test accuracy: 64.12
Round  83, Train loss: 0.137, Test loss: 1.303, Test accuracy: 72.36
Round  83, Global train loss: 0.137, Global test loss: 1.533, Global test accuracy: 63.73
Round  84, Train loss: 0.123, Test loss: 1.325, Test accuracy: 72.36
Round  84, Global train loss: 0.123, Global test loss: 1.607, Global test accuracy: 63.97
Round  85, Train loss: 0.127, Test loss: 1.335, Test accuracy: 72.33
Round  85, Global train loss: 0.127, Global test loss: 1.582, Global test accuracy: 64.04
Round  86, Train loss: 0.128, Test loss: 1.341, Test accuracy: 71.87
Round  86, Global train loss: 0.128, Global test loss: 1.564, Global test accuracy: 64.32
Round  87, Train loss: 0.110, Test loss: 1.349, Test accuracy: 72.22
Round  87, Global train loss: 0.110, Global test loss: 1.659, Global test accuracy: 63.44
Round  88, Train loss: 0.115, Test loss: 1.359, Test accuracy: 72.54
Round  88, Global train loss: 0.115, Global test loss: 1.634, Global test accuracy: 63.43
Round  89, Train loss: 0.117, Test loss: 1.370, Test accuracy: 72.12
Round  89, Global train loss: 0.117, Global test loss: 1.644, Global test accuracy: 62.99
Round  90, Train loss: 0.225, Test loss: 1.357, Test accuracy: 71.84
Round  90, Global train loss: 0.225, Global test loss: 1.345, Global test accuracy: 65.17
Round  91, Train loss: 0.203, Test loss: 1.315, Test accuracy: 72.58
Round  91, Global train loss: 0.203, Global test loss: 1.338, Global test accuracy: 65.50
Round  92, Train loss: 0.197, Test loss: 1.316, Test accuracy: 72.97
Round  92, Global train loss: 0.197, Global test loss: 1.334, Global test accuracy: 65.29
Round  93, Train loss: 0.188, Test loss: 1.329, Test accuracy: 71.93
Round  93, Global train loss: 0.188, Global test loss: 1.317, Global test accuracy: 65.39
Round  94, Train loss: 0.184, Test loss: 1.337, Test accuracy: 72.70
Round  94, Global train loss: 0.184, Global test loss: 1.314, Global test accuracy: 65.97
Round  95, Train loss: 0.181, Test loss: 1.370, Test accuracy: 72.29
Round  95, Global train loss: 0.181, Global test loss: 1.336, Global test accuracy: 65.51
Round  96, Train loss: 0.176, Test loss: 1.309, Test accuracy: 72.84
Round  96, Global train loss: 0.176, Global test loss: 1.328, Global test accuracy: 65.22
Round  97, Train loss: 0.176, Test loss: 1.346, Test accuracy: 72.58
Round  97, Global train loss: 0.176, Global test loss: 1.362, Global test accuracy: 64.96
Round  98, Train loss: 0.182, Test loss: 1.336, Test accuracy: 72.23
Round  98, Global train loss: 0.182, Global test loss: 1.334, Global test accuracy: 65.10
Round  99, Train loss: 0.171, Test loss: 1.356, Test accuracy: 72.82
Round  99, Global train loss: 0.171, Global test loss: 1.360, Global test accuracy: 64.80
Final Round, Train loss: 0.134, Test loss: 1.484, Test accuracy: 72.15
Final Round, Global train loss: 0.134, Global test loss: 1.360, Global test accuracy: 64.80
Average accuracy final 10 rounds: 72.47800000000001
Average global accuracy final 10 rounds: 65.291
2343.2548308372498
[2.4912757873535156, 4.790808916091919, 7.152130603790283, 9.500393867492676, 11.77064323425293, 14.055369853973389, 16.33091640472412, 18.598270177841187, 20.895981788635254, 23.266045093536377, 25.511412620544434, 27.69603204727173, 30.004031896591187, 32.380571365356445, 34.457186698913574, 36.68938660621643, 38.96720337867737, 41.213374376297, 43.403308391571045, 45.64481210708618, 47.90838646888733, 49.88853335380554, 51.78282570838928, 53.77320909500122, 55.78184270858765, 57.817378759384155, 59.76166892051697, 61.74112153053284, 63.727850675582886, 65.65200591087341, 67.59965324401855, 69.57843065261841, 71.55273914337158, 73.46916651725769, 75.41225910186768, 77.3894476890564, 79.37262773513794, 81.28767371177673, 83.25820183753967, 85.2487096786499, 87.29368424415588, 89.2067039012909, 91.19164729118347, 93.1785364151001, 95.17917156219482, 97.07971429824829, 99.05241298675537, 101.04256415367126, 102.93559980392456, 104.82729625701904, 106.72186970710754, 108.61725997924805, 110.50941824913025, 112.40261006355286, 114.31820440292358, 116.23390293121338, 118.14779138565063, 120.06379270553589, 121.95970368385315, 123.8563597202301, 125.75175619125366, 127.65013575553894, 129.5628616809845, 131.47686529159546, 133.3768663406372, 135.26922297477722, 137.16209888458252, 139.07229685783386, 140.98302149772644, 142.88673329353333, 144.8034315109253, 146.69943714141846, 148.6026303768158, 150.49756789207458, 152.4714698791504, 154.36681604385376, 156.2586076259613, 158.1506223678589, 160.0442340373993, 161.93556213378906, 163.8311746120453, 165.72406125068665, 167.6138424873352, 169.5078661441803, 171.3984785079956, 173.2900824546814, 175.30775380134583, 177.22381019592285, 179.1127541065216, 181.0013964176178, 182.89395904541016, 184.89470219612122, 186.78740310668945, 188.68921208381653, 190.58154201507568, 192.47695112228394, 194.3729748725891, 196.26752495765686, 198.25039291381836, 200.23107028007507, 204.05514883995056]
[46.33, 54.13, 57.86, 59.32, 61.28, 62.23, 63.5, 64.41, 65.22, 65.39, 65.6, 66.05, 66.02, 67.16, 67.07, 66.95, 67.65, 67.91, 68.27, 68.04, 68.68, 68.5, 68.54, 68.75, 68.73, 69.3, 69.22, 69.54, 69.57, 69.25, 69.47, 69.54, 69.64, 70.14, 69.88, 69.94, 70.56, 70.16, 70.44, 71.03, 70.8, 70.65, 70.87, 71.3, 71.79, 72.03, 71.55, 71.3, 71.2, 70.88, 70.87, 71.18, 71.19, 71.18, 71.1, 71.44, 70.8, 71.19, 71.55, 72.21, 71.45, 71.69, 72.03, 72.16, 72.19, 72.07, 71.81, 71.87, 71.92, 72.3, 72.1, 72.31, 72.36, 72.32, 72.48, 72.61, 72.31, 72.48, 72.66, 72.59, 72.29, 72.22, 72.55, 72.36, 72.36, 72.33, 71.87, 72.22, 72.54, 72.12, 71.84, 72.58, 72.97, 71.93, 72.7, 72.29, 72.84, 72.58, 72.23, 72.82, 72.15]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.515, Test loss: 1.274, Test accuracy: 46.43
Round   0, Global train loss: 1.515, Global test loss: 2.120, Global test accuracy: 27.02
Round   1, Train loss: 1.285, Test loss: 1.177, Test accuracy: 53.65
Round   1, Global train loss: 1.285, Global test loss: 1.810, Global test accuracy: 38.22
Round   2, Train loss: 1.157, Test loss: 1.063, Test accuracy: 58.04
Round   2, Global train loss: 1.157, Global test loss: 1.631, Global test accuracy: 42.64
Round   3, Train loss: 1.074, Test loss: 1.067, Test accuracy: 58.37
Round   3, Global train loss: 1.074, Global test loss: 1.533, Global test accuracy: 46.14
Round   4, Train loss: 1.014, Test loss: 1.003, Test accuracy: 61.14
Round   4, Global train loss: 1.014, Global test loss: 1.458, Global test accuracy: 48.36
Round   5, Train loss: 0.960, Test loss: 1.031, Test accuracy: 61.58
Round   5, Global train loss: 0.960, Global test loss: 1.403, Global test accuracy: 50.11
Round   6, Train loss: 0.914, Test loss: 0.996, Test accuracy: 63.78
Round   6, Global train loss: 0.914, Global test loss: 1.355, Global test accuracy: 52.61
Round   7, Train loss: 0.868, Test loss: 0.984, Test accuracy: 64.08
Round   7, Global train loss: 0.868, Global test loss: 1.314, Global test accuracy: 52.94
Round   8, Train loss: 0.833, Test loss: 0.963, Test accuracy: 64.94
Round   8, Global train loss: 0.833, Global test loss: 1.278, Global test accuracy: 54.62
Round   9, Train loss: 0.791, Test loss: 0.967, Test accuracy: 65.42
Round   9, Global train loss: 0.791, Global test loss: 1.249, Global test accuracy: 56.00
Round  10, Train loss: 0.745, Test loss: 0.987, Test accuracy: 65.24
Round  10, Global train loss: 0.745, Global test loss: 1.333, Global test accuracy: 52.76
Round  11, Train loss: 0.691, Test loss: 0.997, Test accuracy: 65.44
Round  11, Global train loss: 0.691, Global test loss: 1.338, Global test accuracy: 55.70
Round  12, Train loss: 0.682, Test loss: 1.004, Test accuracy: 65.30
Round  12, Global train loss: 0.682, Global test loss: 1.442, Global test accuracy: 53.26
Round  13, Train loss: 0.764, Test loss: 0.991, Test accuracy: 65.51
Round  13, Global train loss: 0.764, Global test loss: 1.329, Global test accuracy: 53.75
Round  14, Train loss: 0.696, Test loss: 0.989, Test accuracy: 65.91
Round  14, Global train loss: 0.696, Global test loss: 1.355, Global test accuracy: 53.98
Round  15, Train loss: 0.645, Test loss: 1.003, Test accuracy: 66.00
Round  15, Global train loss: 0.645, Global test loss: 1.422, Global test accuracy: 53.11
Round  16, Train loss: 0.588, Test loss: 1.001, Test accuracy: 66.54
Round  16, Global train loss: 0.588, Global test loss: 1.418, Global test accuracy: 53.01
Round  17, Train loss: 0.579, Test loss: 1.007, Test accuracy: 67.00
Round  17, Global train loss: 0.579, Global test loss: 1.410, Global test accuracy: 53.26
Round  18, Train loss: 0.586, Test loss: 1.009, Test accuracy: 67.52
Round  18, Global train loss: 0.586, Global test loss: 1.345, Global test accuracy: 55.07
Round  19, Train loss: 0.504, Test loss: 1.023, Test accuracy: 67.46
Round  19, Global train loss: 0.504, Global test loss: 1.553, Global test accuracy: 52.19
Round  20, Train loss: 0.524, Test loss: 1.019, Test accuracy: 67.24
Round  20, Global train loss: 0.524, Global test loss: 1.324, Global test accuracy: 55.91
Round  21, Train loss: 0.527, Test loss: 1.024, Test accuracy: 67.98
Round  21, Global train loss: 0.527, Global test loss: 1.361, Global test accuracy: 55.63
Round  22, Train loss: 0.545, Test loss: 1.026, Test accuracy: 68.52
Round  22, Global train loss: 0.545, Global test loss: 1.332, Global test accuracy: 55.72
Round  23, Train loss: 0.441, Test loss: 1.021, Test accuracy: 68.63
Round  23, Global train loss: 0.441, Global test loss: 1.534, Global test accuracy: 54.34
Round  24, Train loss: 0.457, Test loss: 1.040, Test accuracy: 68.54
Round  24, Global train loss: 0.457, Global test loss: 1.498, Global test accuracy: 54.13
Round  25, Train loss: 0.483, Test loss: 1.038, Test accuracy: 69.00
Round  25, Global train loss: 0.483, Global test loss: 1.697, Global test accuracy: 54.06
Round  26, Train loss: 0.422, Test loss: 1.045, Test accuracy: 68.76
Round  26, Global train loss: 0.422, Global test loss: 1.499, Global test accuracy: 55.99
Round  27, Train loss: 0.408, Test loss: 1.057, Test accuracy: 68.95
Round  27, Global train loss: 0.408, Global test loss: 1.333, Global test accuracy: 58.51
Round  28, Train loss: 0.428, Test loss: 1.070, Test accuracy: 69.22
Round  28, Global train loss: 0.428, Global test loss: 1.425, Global test accuracy: 57.01
Round  29, Train loss: 0.451, Test loss: 1.073, Test accuracy: 69.38
Round  29, Global train loss: 0.451, Global test loss: 1.252, Global test accuracy: 60.70
Round  30, Train loss: 0.393, Test loss: 1.050, Test accuracy: 69.60
Round  30, Global train loss: 0.393, Global test loss: 1.573, Global test accuracy: 54.89
Round  31, Train loss: 0.373, Test loss: 1.069, Test accuracy: 69.60
Round  31, Global train loss: 0.373, Global test loss: 1.327, Global test accuracy: 60.58
Round  32, Train loss: 0.434, Test loss: 1.093, Test accuracy: 69.46
Round  32, Global train loss: 0.434, Global test loss: 1.377, Global test accuracy: 58.28
Round  33, Train loss: 0.413, Test loss: 1.108, Test accuracy: 69.23
Round  33, Global train loss: 0.413, Global test loss: 1.390, Global test accuracy: 59.02
Round  34, Train loss: 0.418, Test loss: 1.138, Test accuracy: 69.53
Round  34, Global train loss: 0.418, Global test loss: 1.441, Global test accuracy: 57.64
Round  35, Train loss: 0.393, Test loss: 1.134, Test accuracy: 69.89
Round  35, Global train loss: 0.393, Global test loss: 1.581, Global test accuracy: 56.16
Round  36, Train loss: 0.352, Test loss: 1.143, Test accuracy: 69.94
Round  36, Global train loss: 0.352, Global test loss: 1.619, Global test accuracy: 56.34
Round  37, Train loss: 0.345, Test loss: 1.142, Test accuracy: 70.10
Round  37, Global train loss: 0.345, Global test loss: 1.467, Global test accuracy: 58.79
Round  38, Train loss: 0.332, Test loss: 1.140, Test accuracy: 70.26
Round  38, Global train loss: 0.332, Global test loss: 1.516, Global test accuracy: 58.09
Round  39, Train loss: 0.329, Test loss: 1.132, Test accuracy: 70.28
Round  39, Global train loss: 0.329, Global test loss: 1.673, Global test accuracy: 54.85
Round  40, Train loss: 0.366, Test loss: 1.125, Test accuracy: 70.50
Round  40, Global train loss: 0.366, Global test loss: 1.525, Global test accuracy: 56.51
Round  41, Train loss: 0.358, Test loss: 1.140, Test accuracy: 70.76
Round  41, Global train loss: 0.358, Global test loss: 1.487, Global test accuracy: 57.44
Round  42, Train loss: 0.362, Test loss: 1.153, Test accuracy: 70.74
Round  42, Global train loss: 0.362, Global test loss: 1.345, Global test accuracy: 59.54
Round  43, Train loss: 0.344, Test loss: 1.146, Test accuracy: 70.51
Round  43, Global train loss: 0.344, Global test loss: 1.562, Global test accuracy: 58.22
Round  44, Train loss: 0.289, Test loss: 1.188, Test accuracy: 70.15
Round  44, Global train loss: 0.289, Global test loss: 1.706, Global test accuracy: 55.86
Round  45, Train loss: 0.339, Test loss: 1.170, Test accuracy: 70.52
Round  45, Global train loss: 0.339, Global test loss: 1.368, Global test accuracy: 59.99
Round  46, Train loss: 0.339, Test loss: 1.195, Test accuracy: 70.51
Round  46, Global train loss: 0.339, Global test loss: 1.456, Global test accuracy: 58.63
Round  47, Train loss: 0.274, Test loss: 1.188, Test accuracy: 70.23
Round  47, Global train loss: 0.274, Global test loss: 1.571, Global test accuracy: 57.36
Round  48, Train loss: 0.272, Test loss: 1.194, Test accuracy: 70.48
Round  48, Global train loss: 0.272, Global test loss: 1.864, Global test accuracy: 55.41
Round  49, Train loss: 0.277, Test loss: 1.184, Test accuracy: 70.75
Round  49, Global train loss: 0.277, Global test loss: 1.511, Global test accuracy: 59.38
Round  50, Train loss: 0.312, Test loss: 1.178, Test accuracy: 70.91
Round  50, Global train loss: 0.312, Global test loss: 1.533, Global test accuracy: 58.42
Round  51, Train loss: 0.270, Test loss: 1.168, Test accuracy: 71.47
Round  51, Global train loss: 0.270, Global test loss: 1.497, Global test accuracy: 60.40
Round  52, Train loss: 0.290, Test loss: 1.176, Test accuracy: 71.38
Round  52, Global train loss: 0.290, Global test loss: 1.339, Global test accuracy: 61.48
Round  53, Train loss: 0.274, Test loss: 1.169, Test accuracy: 71.75
Round  53, Global train loss: 0.274, Global test loss: 1.458, Global test accuracy: 60.27
Round  54, Train loss: 0.270, Test loss: 1.178, Test accuracy: 71.52
Round  54, Global train loss: 0.270, Global test loss: 1.555, Global test accuracy: 58.03
Round  55, Train loss: 0.298, Test loss: 1.200, Test accuracy: 71.59
Round  55, Global train loss: 0.298, Global test loss: 1.512, Global test accuracy: 59.38
Round  56, Train loss: 0.234, Test loss: 1.242, Test accuracy: 70.93
Round  56, Global train loss: 0.234, Global test loss: 1.675, Global test accuracy: 58.41
Round  57, Train loss: 0.250, Test loss: 1.246, Test accuracy: 70.75
Round  57, Global train loss: 0.250, Global test loss: 1.544, Global test accuracy: 60.05
Round  58, Train loss: 0.284, Test loss: 1.237, Test accuracy: 70.70
Round  58, Global train loss: 0.284, Global test loss: 1.542, Global test accuracy: 59.15
Round  59, Train loss: 0.234, Test loss: 1.238, Test accuracy: 70.99
Round  59, Global train loss: 0.234, Global test loss: 1.475, Global test accuracy: 62.00
Round  60, Train loss: 0.261, Test loss: 1.225, Test accuracy: 71.43
Round  60, Global train loss: 0.261, Global test loss: 1.688, Global test accuracy: 58.11
Round  61, Train loss: 0.272, Test loss: 1.226, Test accuracy: 71.66
Round  61, Global train loss: 0.272, Global test loss: 1.467, Global test accuracy: 60.65
Round  62, Train loss: 0.213, Test loss: 1.225, Test accuracy: 71.64
Round  62, Global train loss: 0.213, Global test loss: 1.634, Global test accuracy: 58.91
Round  63, Train loss: 0.246, Test loss: 1.221, Test accuracy: 71.78
Round  63, Global train loss: 0.246, Global test loss: 1.579, Global test accuracy: 60.59
Round  64, Train loss: 0.226, Test loss: 1.261, Test accuracy: 71.23
Round  64, Global train loss: 0.226, Global test loss: 1.763, Global test accuracy: 58.96
Round  65, Train loss: 0.230, Test loss: 1.239, Test accuracy: 71.38
Round  65, Global train loss: 0.230, Global test loss: 1.545, Global test accuracy: 59.53
Round  66, Train loss: 0.243, Test loss: 1.269, Test accuracy: 71.41
Round  66, Global train loss: 0.243, Global test loss: 1.551, Global test accuracy: 60.78
Round  67, Train loss: 0.188, Test loss: 1.280, Test accuracy: 71.64
Round  67, Global train loss: 0.188, Global test loss: 1.511, Global test accuracy: 61.54
Round  68, Train loss: 0.249, Test loss: 1.284, Test accuracy: 71.77
Round  68, Global train loss: 0.249, Global test loss: 1.436, Global test accuracy: 61.65
Round  69, Train loss: 0.201, Test loss: 1.277, Test accuracy: 71.53
Round  69, Global train loss: 0.201, Global test loss: 1.594, Global test accuracy: 59.74
Round  70, Train loss: 0.187, Test loss: 1.269, Test accuracy: 71.75
Round  70, Global train loss: 0.187, Global test loss: 1.510, Global test accuracy: 62.76
Round  71, Train loss: 0.188, Test loss: 1.285, Test accuracy: 71.70
Round  71, Global train loss: 0.188, Global test loss: 1.500, Global test accuracy: 62.00
Round  72, Train loss: 0.287, Test loss: 1.275, Test accuracy: 71.92
Round  72, Global train loss: 0.287, Global test loss: 1.490, Global test accuracy: 60.81
Round  73, Train loss: 0.188, Test loss: 1.265, Test accuracy: 71.74
Round  73, Global train loss: 0.188, Global test loss: 1.633, Global test accuracy: 60.56
Round  74, Train loss: 0.195, Test loss: 1.251, Test accuracy: 71.87
Round  74, Global train loss: 0.195, Global test loss: 1.451, Global test accuracy: 62.69
Round  75, Train loss: 0.192, Test loss: 1.266, Test accuracy: 71.91
Round  75, Global train loss: 0.192, Global test loss: 1.521, Global test accuracy: 62.78
Round  76, Train loss: 0.211, Test loss: 1.327, Test accuracy: 71.71
Round  76, Global train loss: 0.211, Global test loss: 1.634, Global test accuracy: 61.26
Round  77, Train loss: 0.220, Test loss: 1.295, Test accuracy: 72.22
Round  77, Global train loss: 0.220, Global test loss: 1.801, Global test accuracy: 59.33
Round  78, Train loss: 0.217, Test loss: 1.316, Test accuracy: 72.12
Round  78, Global train loss: 0.217, Global test loss: 1.542, Global test accuracy: 61.53
Round  79, Train loss: 0.239, Test loss: 1.274, Test accuracy: 72.36
Round  79, Global train loss: 0.239, Global test loss: 1.443, Global test accuracy: 61.07
Round  80, Train loss: 0.161, Test loss: 1.299, Test accuracy: 71.86
Round  80, Global train loss: 0.161, Global test loss: 1.435, Global test accuracy: 64.09
Round  81, Train loss: 0.153, Test loss: 1.276, Test accuracy: 72.21
Round  81, Global train loss: 0.153, Global test loss: 1.475, Global test accuracy: 63.66
Round  82, Train loss: 0.142, Test loss: 1.322, Test accuracy: 71.66
Round  82, Global train loss: 0.142, Global test loss: 1.521, Global test accuracy: 63.75
Round  83, Train loss: 0.139, Test loss: 1.325, Test accuracy: 71.73
Round  83, Global train loss: 0.139, Global test loss: 1.497, Global test accuracy: 64.19
Round  84, Train loss: 0.136, Test loss: 1.330, Test accuracy: 71.50
Round  84, Global train loss: 0.136, Global test loss: 1.497, Global test accuracy: 63.42
Round  85, Train loss: 0.130, Test loss: 1.284, Test accuracy: 71.93
Round  85, Global train loss: 0.130, Global test loss: 1.531, Global test accuracy: 63.31
Round  86, Train loss: 0.127, Test loss: 1.298, Test accuracy: 72.10
Round  86, Global train loss: 0.127, Global test loss: 1.556, Global test accuracy: 63.30
Round  87, Train loss: 0.124, Test loss: 1.340, Test accuracy: 72.03
Round  87, Global train loss: 0.124, Global test loss: 1.570, Global test accuracy: 63.01
Round  88, Train loss: 0.116, Test loss: 1.316, Test accuracy: 71.91
Round  88, Global train loss: 0.116, Global test loss: 1.547, Global test accuracy: 63.27
Round  89, Train loss: 0.118, Test loss: 1.320, Test accuracy: 72.11
Round  89, Global train loss: 0.118, Global test loss: 1.599, Global test accuracy: 63.09
Round  90, Train loss: 0.205, Test loss: 1.352, Test accuracy: 72.12
Round  90, Global train loss: 0.205, Global test loss: 1.405, Global test accuracy: 63.58
Round  91, Train loss: 0.194, Test loss: 1.328, Test accuracy: 72.24
Round  91, Global train loss: 0.194, Global test loss: 1.369, Global test accuracy: 63.55
Round  92, Train loss: 0.187, Test loss: 1.311, Test accuracy: 72.23
Round  92, Global train loss: 0.187, Global test loss: 1.392, Global test accuracy: 63.70
Round  93, Train loss: 0.184, Test loss: 1.336, Test accuracy: 72.67
Round  93, Global train loss: 0.184, Global test loss: 1.386, Global test accuracy: 64.08
Round  94, Train loss: 0.184, Test loss: 1.347, Test accuracy: 72.18
Round  94, Global train loss: 0.184, Global test loss: 1.410, Global test accuracy: 64.17
Round  95, Train loss: 0.175, Test loss: 1.386, Test accuracy: 71.97
Round  95, Global train loss: 0.175, Global test loss: 1.419, Global test accuracy: 64.12
Round  96, Train loss: 0.168, Test loss: 1.377, Test accuracy: 71.95
Round  96, Global train loss: 0.168, Global test loss: 1.420, Global test accuracy: 64.36
Round  97, Train loss: 0.172, Test loss: 1.379, Test accuracy: 72.02
Round  97, Global train loss: 0.172, Global test loss: 1.406, Global test accuracy: 64.27
Round  98, Train loss: 0.167, Test loss: 1.364, Test accuracy: 72.20
Round  98, Global train loss: 0.167, Global test loss: 1.418, Global test accuracy: 64.01
Round  99, Train loss: 0.166, Test loss: 1.336, Test accuracy: 72.95
Round  99, Global train loss: 0.166, Global test loss: 1.407, Global test accuracy: 64.47
Final Round, Train loss: 0.126, Test loss: 1.467, Test accuracy: 72.57
Final Round, Global train loss: 0.126, Global test loss: 1.407, Global test accuracy: 64.47
Average accuracy final 10 rounds: 72.253
Average global accuracy final 10 rounds: 64.031
3735.2144379615784
[2.5305256843566895, 4.462196588516235, 6.388620853424072, 8.306990385055542, 10.238767385482788, 12.168691635131836, 14.10780668258667, 16.04085397720337, 17.968085765838623, 19.8824942111969, 21.812777996063232, 23.744215965270996, 25.674524545669556, 27.60851526260376, 29.540628671646118, 31.474160194396973, 33.39036154747009, 35.30415892601013, 37.2176456451416, 39.1267204284668, 41.03550934791565, 45.193992376327515, 49.32557415962219, 53.45597767829895, 57.5865843296051, 61.72054696083069, 65.86566925048828, 70.00699472427368, 74.14004802703857, 78.27614140510559, 82.41933369636536, 86.63163781166077, 90.77020573616028, 94.92038798332214, 99.05319499969482, 103.18777513504028, 107.33371019363403, 111.49836945533752, 115.62667512893677, 119.80970668792725, 123.99051070213318, 128.10672450065613, 132.22920083999634, 136.35370445251465, 140.471088886261, 144.59744238853455, 148.72611355781555, 152.9202265739441, 157.05316710472107, 161.16517853736877, 165.3392436504364, 169.5177357196808, 173.6995928287506, 177.877338886261, 182.05918645858765, 186.24277234077454, 190.42246174812317, 194.60995078086853, 198.7941870689392, 202.9786036014557, 207.15819931030273, 211.34159207344055, 215.52389693260193, 219.79501795768738, 223.98575377464294, 228.17415380477905, 232.35677409172058, 236.5408067703247, 240.72449851036072, 244.8532030582428, 249.0070779323578, 253.191801071167, 257.333904504776, 261.49624133110046, 265.6807563304901, 269.8663115501404, 274.05175161361694, 278.2803204059601, 282.4147045612335, 286.6075179576874, 290.7470908164978, 294.9360861778259, 299.07457065582275, 303.22029304504395, 307.3616898059845, 311.5009925365448, 315.6363904476166, 319.7738835811615, 323.9099724292755, 328.11441946029663, 332.25416254997253, 336.3956778049469, 340.54133701324463, 344.6886122226715, 348.90532326698303, 353.09943675994873, 357.28192234039307, 361.4654793739319, 365.64882922172546, 369.8874852657318, 373.74269461631775]
[46.43, 53.65, 58.04, 58.37, 61.14, 61.58, 63.78, 64.08, 64.94, 65.42, 65.24, 65.44, 65.3, 65.51, 65.91, 66.0, 66.54, 67.0, 67.52, 67.46, 67.24, 67.98, 68.52, 68.63, 68.54, 69.0, 68.76, 68.95, 69.22, 69.38, 69.6, 69.6, 69.46, 69.23, 69.53, 69.89, 69.94, 70.1, 70.26, 70.28, 70.5, 70.76, 70.74, 70.51, 70.15, 70.52, 70.51, 70.23, 70.48, 70.75, 70.91, 71.47, 71.38, 71.75, 71.52, 71.59, 70.93, 70.75, 70.7, 70.99, 71.43, 71.66, 71.64, 71.78, 71.23, 71.38, 71.41, 71.64, 71.77, 71.53, 71.75, 71.7, 71.92, 71.74, 71.87, 71.91, 71.71, 72.22, 72.12, 72.36, 71.86, 72.21, 71.66, 71.73, 71.5, 71.93, 72.1, 72.03, 71.91, 72.11, 72.12, 72.24, 72.23, 72.67, 72.18, 71.97, 71.95, 72.02, 72.2, 72.95, 72.57]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.734, Test loss: 1.811, Test accuracy: 33.98
Round   1, Train loss: 1.386, Test loss: 1.325, Test accuracy: 43.64
Round   2, Train loss: 1.236, Test loss: 1.171, Test accuracy: 51.97
Round   3, Train loss: 1.144, Test loss: 1.112, Test accuracy: 54.99
Round   4, Train loss: 1.084, Test loss: 1.043, Test accuracy: 58.22
Round   5, Train loss: 1.039, Test loss: 1.004, Test accuracy: 60.60
Round   6, Train loss: 1.000, Test loss: 0.964, Test accuracy: 62.53
Round   7, Train loss: 0.967, Test loss: 0.949, Test accuracy: 63.44
Round   8, Train loss: 0.935, Test loss: 0.921, Test accuracy: 64.68
Round   9, Train loss: 0.903, Test loss: 0.904, Test accuracy: 64.82
Round  10, Train loss: 0.877, Test loss: 0.875, Test accuracy: 66.79
Round  11, Train loss: 0.851, Test loss: 0.868, Test accuracy: 66.90
Round  12, Train loss: 0.823, Test loss: 0.852, Test accuracy: 67.60
Round  13, Train loss: 0.803, Test loss: 0.840, Test accuracy: 68.15
Round  14, Train loss: 0.780, Test loss: 0.819, Test accuracy: 69.34
Round  15, Train loss: 0.754, Test loss: 0.830, Test accuracy: 68.87
Round  16, Train loss: 0.737, Test loss: 0.810, Test accuracy: 69.90
Round  17, Train loss: 0.716, Test loss: 0.789, Test accuracy: 70.23
Round  18, Train loss: 0.699, Test loss: 0.814, Test accuracy: 69.43
Round  19, Train loss: 0.680, Test loss: 0.802, Test accuracy: 70.85
Round  20, Train loss: 0.688, Test loss: 0.812, Test accuracy: 70.54
Round  21, Train loss: 0.700, Test loss: 0.799, Test accuracy: 71.09
Round  22, Train loss: 0.591, Test loss: 0.833, Test accuracy: 69.81
Round  23, Train loss: 0.651, Test loss: 0.796, Test accuracy: 71.42
Round  24, Train loss: 0.604, Test loss: 0.810, Test accuracy: 71.49
Round  25, Train loss: 0.597, Test loss: 0.820, Test accuracy: 71.31
Round  26, Train loss: 0.505, Test loss: 0.799, Test accuracy: 72.18
Round  27, Train loss: 0.545, Test loss: 0.787, Test accuracy: 72.00
Round  28, Train loss: 0.571, Test loss: 0.800, Test accuracy: 71.48
Round  29, Train loss: 0.650, Test loss: 0.788, Test accuracy: 72.25
Round  30, Train loss: 0.491, Test loss: 0.783, Test accuracy: 72.59
Round  31, Train loss: 0.564, Test loss: 0.793, Test accuracy: 72.31
Round  32, Train loss: 0.516, Test loss: 0.820, Test accuracy: 71.65
Round  33, Train loss: 0.521, Test loss: 0.811, Test accuracy: 71.93
Round  34, Train loss: 0.533, Test loss: 0.816, Test accuracy: 71.78
Round  35, Train loss: 0.535, Test loss: 0.830, Test accuracy: 71.33
Round  36, Train loss: 0.534, Test loss: 0.849, Test accuracy: 71.62
Round  37, Train loss: 0.500, Test loss: 0.824, Test accuracy: 72.41
Round  38, Train loss: 0.452, Test loss: 0.816, Test accuracy: 72.68
Round  39, Train loss: 0.431, Test loss: 0.848, Test accuracy: 71.98
Round  40, Train loss: 0.474, Test loss: 0.804, Test accuracy: 72.96
Round  41, Train loss: 0.535, Test loss: 0.811, Test accuracy: 73.07
Round  42, Train loss: 0.480, Test loss: 0.814, Test accuracy: 72.97
Round  43, Train loss: 0.443, Test loss: 0.816, Test accuracy: 73.27
Round  44, Train loss: 0.437, Test loss: 0.864, Test accuracy: 72.39
Round  45, Train loss: 0.469, Test loss: 0.838, Test accuracy: 72.27
Round  46, Train loss: 0.413, Test loss: 0.824, Test accuracy: 72.51
Round  47, Train loss: 0.405, Test loss: 0.867, Test accuracy: 72.26
Round  48, Train loss: 0.370, Test loss: 0.866, Test accuracy: 72.68
Round  49, Train loss: 0.418, Test loss: 0.908, Test accuracy: 72.46
Round  50, Train loss: 0.428, Test loss: 0.865, Test accuracy: 72.47
Round  51, Train loss: 0.374, Test loss: 0.868, Test accuracy: 72.59
Round  52, Train loss: 0.422, Test loss: 0.859, Test accuracy: 72.87
Round  53, Train loss: 0.371, Test loss: 0.883, Test accuracy: 72.69
Round  54, Train loss: 0.351, Test loss: 0.880, Test accuracy: 72.49
Round  55, Train loss: 0.428, Test loss: 0.879, Test accuracy: 72.46
Round  56, Train loss: 0.351, Test loss: 0.872, Test accuracy: 73.15
Round  57, Train loss: 0.387, Test loss: 0.892, Test accuracy: 72.97
Round  58, Train loss: 0.424, Test loss: 0.884, Test accuracy: 73.19
Round  59, Train loss: 0.352, Test loss: 0.865, Test accuracy: 73.44
Round  60, Train loss: 0.398, Test loss: 0.901, Test accuracy: 72.83
Round  61, Train loss: 0.332, Test loss: 0.893, Test accuracy: 73.05
Round  62, Train loss: 0.333, Test loss: 0.898, Test accuracy: 72.95
Round  63, Train loss: 0.329, Test loss: 0.891, Test accuracy: 73.56
Round  64, Train loss: 0.310, Test loss: 0.935, Test accuracy: 72.73
Round  65, Train loss: 0.275, Test loss: 0.916, Test accuracy: 73.63
Round  66, Train loss: 0.354, Test loss: 0.896, Test accuracy: 74.10
Round  67, Train loss: 0.303, Test loss: 0.912, Test accuracy: 73.56
Round  68, Train loss: 0.357, Test loss: 0.888, Test accuracy: 73.59
Round  69, Train loss: 0.350, Test loss: 0.951, Test accuracy: 72.45
Round  70, Train loss: 0.278, Test loss: 0.930, Test accuracy: 73.50
Round  71, Train loss: 0.269, Test loss: 0.955, Test accuracy: 73.33
Round  72, Train loss: 0.343, Test loss: 0.901, Test accuracy: 73.34
Round  73, Train loss: 0.250, Test loss: 0.907, Test accuracy: 74.03
Round  74, Train loss: 0.321, Test loss: 0.963, Test accuracy: 72.96
Round  75, Train loss: 0.275, Test loss: 0.938, Test accuracy: 73.70
Round  76, Train loss: 0.238, Test loss: 0.918, Test accuracy: 73.79
Round  77, Train loss: 0.276, Test loss: 0.950, Test accuracy: 73.19
Round  78, Train loss: 0.327, Test loss: 0.976, Test accuracy: 72.54
Round  79, Train loss: 0.341, Test loss: 0.953, Test accuracy: 73.32
Round  80, Train loss: 0.229, Test loss: 0.936, Test accuracy: 73.69
Round  81, Train loss: 0.207, Test loss: 0.968, Test accuracy: 73.43
Round  82, Train loss: 0.196, Test loss: 0.965, Test accuracy: 73.41
Round  83, Train loss: 0.185, Test loss: 0.977, Test accuracy: 73.61
Round  84, Train loss: 0.178, Test loss: 0.987, Test accuracy: 73.83
Round  85, Train loss: 0.164, Test loss: 1.013, Test accuracy: 73.54
Round  86, Train loss: 0.169, Test loss: 1.041, Test accuracy: 73.47
Round  87, Train loss: 0.169, Test loss: 1.038, Test accuracy: 72.94
Round  88, Train loss: 0.159, Test loss: 1.048, Test accuracy: 73.58
Round  89, Train loss: 0.162, Test loss: 1.039, Test accuracy: 73.28
Round  90, Train loss: 0.288, Test loss: 1.015, Test accuracy: 73.16
Round  91, Train loss: 0.264, Test loss: 0.996, Test accuracy: 73.59
Round  92, Train loss: 0.257, Test loss: 1.017, Test accuracy: 73.44
Round  93, Train loss: 0.249, Test loss: 1.006, Test accuracy: 73.73
Round  94, Train loss: 0.246, Test loss: 1.000, Test accuracy: 73.80
Round  95, Train loss: 0.250, Test loss: 1.032, Test accuracy: 73.37
Round  96, Train loss: 0.241, Test loss: 1.004, Test accuracy: 73.64
Round  97, Train loss: 0.240, Test loss: 1.040, Test accuracy: 73.54
Round  98, Train loss: 0.232, Test loss: 1.036, Test accuracy: 73.38
Round  99, Train loss: 0.231, Test loss: 1.013, Test accuracy: 73.85
Final Round, Train loss: 0.187, Test loss: 1.003, Test accuracy: 74.24
Average accuracy final 10 rounds: 73.55
3149.63489818573
[2.327617645263672, 4.35797119140625, 6.375818252563477, 8.398719787597656, 10.437134742736816, 12.460247039794922, 14.498522520065308, 16.538277626037598, 18.580149173736572, 20.616798400878906, 22.430664539337158, 24.24529480934143, 26.0606632232666, 27.878190517425537, 29.692537307739258, 31.50896954536438, 33.32587122917175, 35.14361071586609, 36.96160006523132, 38.7823588848114, 40.598830699920654, 43.78497815132141, 46.95473599433899, 50.15519833564758, 53.362427949905396, 56.57352423667908, 59.779011726379395, 62.98092436790466, 66.18651223182678, 69.3918821811676, 72.59673070907593, 75.80663275718689, 78.98604965209961, 82.15842843055725, 85.3632640838623, 88.56795525550842, 91.76381850242615, 94.98039054870605, 98.232586145401, 101.43252086639404, 104.63924717903137, 107.82380843162537, 111.00932598114014, 114.21905183792114, 117.42907047271729, 120.59333920478821, 123.76017475128174, 126.96908450126648, 130.1786949634552, 133.39192271232605, 136.59576034545898, 139.7993516921997, 143.0095555782318, 146.2167100906372, 149.42405247688293, 152.6253514289856, 155.8304898738861, 159.03467679023743, 162.23557591438293, 165.43946886062622, 168.6408953666687, 171.84487915039062, 175.04126620292664, 178.241379737854, 181.50267434120178, 184.7013967037201, 187.90157914161682, 191.10495400428772, 194.30556416511536, 197.50488424301147, 200.70472979545593, 203.9113450050354, 207.11620664596558, 210.31209635734558, 213.51749515533447, 216.72436499595642, 219.92536902427673, 223.13295578956604, 226.32953095436096, 229.52678561210632, 232.7400381565094, 235.93311047554016, 239.1278579235077, 242.32765293121338, 245.5265336036682, 248.72277688980103, 251.9882514476776, 255.18490529060364, 258.3976857662201, 261.5905900001526, 264.7913076877594, 267.98800253868103, 271.18270659446716, 274.38913202285767, 277.5905511379242, 280.7978057861328, 284.0689630508423, 287.2890212535858, 290.48914217948914, 293.6908402442932, 297.1269881725311]
[33.98, 43.64, 51.97, 54.99, 58.22, 60.6, 62.53, 63.44, 64.68, 64.82, 66.79, 66.9, 67.6, 68.15, 69.34, 68.87, 69.9, 70.23, 69.43, 70.85, 70.54, 71.09, 69.81, 71.42, 71.49, 71.31, 72.18, 72.0, 71.48, 72.25, 72.59, 72.31, 71.65, 71.93, 71.78, 71.33, 71.62, 72.41, 72.68, 71.98, 72.96, 73.07, 72.97, 73.27, 72.39, 72.27, 72.51, 72.26, 72.68, 72.46, 72.47, 72.59, 72.87, 72.69, 72.49, 72.46, 73.15, 72.97, 73.19, 73.44, 72.83, 73.05, 72.95, 73.56, 72.73, 73.63, 74.1, 73.56, 73.59, 72.45, 73.5, 73.33, 73.34, 74.03, 72.96, 73.7, 73.79, 73.19, 72.54, 73.32, 73.69, 73.43, 73.41, 73.61, 73.83, 73.54, 73.47, 72.94, 73.58, 73.28, 73.16, 73.59, 73.44, 73.73, 73.8, 73.37, 73.64, 73.54, 73.38, 73.85, 74.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.751, Test loss: 1.705, Test accuracy: 36.39
Round   1, Train loss: 1.404, Test loss: 1.306, Test accuracy: 47.16
Round   2, Train loss: 1.248, Test loss: 1.168, Test accuracy: 53.33
Round   3, Train loss: 1.166, Test loss: 1.088, Test accuracy: 56.84
Round   4, Train loss: 1.108, Test loss: 1.036, Test accuracy: 59.60
Round   5, Train loss: 1.066, Test loss: 0.992, Test accuracy: 61.52
Round   6, Train loss: 1.025, Test loss: 0.966, Test accuracy: 62.79
Round   7, Train loss: 0.991, Test loss: 0.926, Test accuracy: 64.72
Round   8, Train loss: 0.960, Test loss: 0.901, Test accuracy: 66.09
Round   9, Train loss: 0.934, Test loss: 0.877, Test accuracy: 67.00
Round  10, Train loss: 0.960, Test loss: 0.880, Test accuracy: 67.58
Round  11, Train loss: 0.886, Test loss: 0.878, Test accuracy: 67.03
Round  12, Train loss: 0.856, Test loss: 0.843, Test accuracy: 68.32
Round  13, Train loss: 0.856, Test loss: 0.842, Test accuracy: 68.26
Round  14, Train loss: 0.812, Test loss: 0.826, Test accuracy: 69.07
Round  15, Train loss: 0.822, Test loss: 0.837, Test accuracy: 68.67
Round  16, Train loss: 0.774, Test loss: 0.804, Test accuracy: 69.60
Round  17, Train loss: 0.810, Test loss: 0.812, Test accuracy: 69.68
Round  18, Train loss: 0.858, Test loss: 0.796, Test accuracy: 70.21
Round  19, Train loss: 0.633, Test loss: 0.796, Test accuracy: 70.60
Round  20, Train loss: 0.719, Test loss: 0.799, Test accuracy: 70.16
Round  21, Train loss: 0.788, Test loss: 0.807, Test accuracy: 70.46
Round  22, Train loss: 0.655, Test loss: 0.763, Test accuracy: 72.12
Round  23, Train loss: 0.674, Test loss: 0.760, Test accuracy: 72.83
Round  24, Train loss: 0.597, Test loss: 0.748, Test accuracy: 72.72
Round  25, Train loss: 0.598, Test loss: 0.767, Test accuracy: 72.30
Round  26, Train loss: 0.566, Test loss: 0.766, Test accuracy: 72.22
Round  27, Train loss: 0.545, Test loss: 0.749, Test accuracy: 72.60
Round  28, Train loss: 0.654, Test loss: 0.739, Test accuracy: 73.41
Round  29, Train loss: 0.577, Test loss: 0.738, Test accuracy: 73.67
Round  30, Train loss: 0.656, Test loss: 0.752, Test accuracy: 73.17
Round  31, Train loss: 0.569, Test loss: 0.745, Test accuracy: 73.68
Round  32, Train loss: 0.673, Test loss: 0.741, Test accuracy: 73.82
Round  33, Train loss: 0.616, Test loss: 0.755, Test accuracy: 73.52
Round  34, Train loss: 0.551, Test loss: 0.755, Test accuracy: 73.75
Round  35, Train loss: 0.520, Test loss: 0.733, Test accuracy: 74.14
Round  36, Train loss: 0.549, Test loss: 0.745, Test accuracy: 74.31
Round  37, Train loss: 0.517, Test loss: 0.729, Test accuracy: 74.93
Round  38, Train loss: 0.408, Test loss: 0.739, Test accuracy: 74.64
Round  39, Train loss: 0.420, Test loss: 0.753, Test accuracy: 74.36
Round  40, Train loss: 0.469, Test loss: 0.728, Test accuracy: 74.77
Round  41, Train loss: 0.595, Test loss: 0.718, Test accuracy: 75.13
Round  42, Train loss: 0.578, Test loss: 0.721, Test accuracy: 75.05
Round  43, Train loss: 0.447, Test loss: 0.708, Test accuracy: 75.62
Round  44, Train loss: 0.481, Test loss: 0.708, Test accuracy: 75.69
Round  45, Train loss: 0.553, Test loss: 0.719, Test accuracy: 75.79
Round  46, Train loss: 0.449, Test loss: 0.730, Test accuracy: 75.34
Round  47, Train loss: 0.439, Test loss: 0.723, Test accuracy: 75.56
Round  48, Train loss: 0.428, Test loss: 0.726, Test accuracy: 75.79
Round  49, Train loss: 0.394, Test loss: 0.725, Test accuracy: 76.19
Round  50, Train loss: 0.549, Test loss: 0.709, Test accuracy: 76.12
Round  51, Train loss: 0.350, Test loss: 0.725, Test accuracy: 76.14
Round  52, Train loss: 0.492, Test loss: 0.730, Test accuracy: 75.68
Round  53, Train loss: 0.396, Test loss: 0.720, Test accuracy: 75.64
Round  54, Train loss: 0.466, Test loss: 0.724, Test accuracy: 75.76
Round  55, Train loss: 0.431, Test loss: 0.737, Test accuracy: 75.84
Round  56, Train loss: 0.368, Test loss: 0.731, Test accuracy: 75.43
Round  57, Train loss: 0.365, Test loss: 0.742, Test accuracy: 75.47
Round  58, Train loss: 0.500, Test loss: 0.735, Test accuracy: 75.62
Round  59, Train loss: 0.393, Test loss: 0.734, Test accuracy: 75.90
Round  60, Train loss: 0.441, Test loss: 0.755, Test accuracy: 75.40
Round  61, Train loss: 0.338, Test loss: 0.768, Test accuracy: 75.05
Round  62, Train loss: 0.331, Test loss: 0.750, Test accuracy: 75.33
Round  63, Train loss: 0.401, Test loss: 0.751, Test accuracy: 76.01
Round  64, Train loss: 0.317, Test loss: 0.749, Test accuracy: 76.04
Round  65, Train loss: 0.292, Test loss: 0.746, Test accuracy: 75.76
Round  66, Train loss: 0.405, Test loss: 0.732, Test accuracy: 76.62
Round  67, Train loss: 0.290, Test loss: 0.726, Test accuracy: 76.20
Round  68, Train loss: 0.422, Test loss: 0.755, Test accuracy: 76.35
Round  69, Train loss: 0.341, Test loss: 0.768, Test accuracy: 76.30
Round  70, Train loss: 0.326, Test loss: 0.791, Test accuracy: 75.90
Round  71, Train loss: 0.317, Test loss: 0.783, Test accuracy: 76.24
Round  72, Train loss: 0.432, Test loss: 0.784, Test accuracy: 75.97
Round  73, Train loss: 0.308, Test loss: 0.775, Test accuracy: 75.99
Round  74, Train loss: 0.325, Test loss: 0.779, Test accuracy: 75.88
Round  75, Train loss: 0.295, Test loss: 0.797, Test accuracy: 75.51
Round  76, Train loss: 0.309, Test loss: 0.795, Test accuracy: 75.84
Round  77, Train loss: 0.277, Test loss: 0.790, Test accuracy: 75.47
Round  78, Train loss: 0.336, Test loss: 0.795, Test accuracy: 75.69
Round  79, Train loss: 0.393, Test loss: 0.784, Test accuracy: 75.74
Round  80, Train loss: 0.234, Test loss: 0.764, Test accuracy: 76.05
Round  81, Train loss: 0.221, Test loss: 0.762, Test accuracy: 76.53
Round  82, Train loss: 0.206, Test loss: 0.769, Test accuracy: 76.22
Round  83, Train loss: 0.200, Test loss: 0.776, Test accuracy: 76.21
Round  84, Train loss: 0.196, Test loss: 0.783, Test accuracy: 75.98
Round  85, Train loss: 0.191, Test loss: 0.775, Test accuracy: 76.33
Round  86, Train loss: 0.179, Test loss: 0.783, Test accuracy: 75.97
Round  87, Train loss: 0.172, Test loss: 0.788, Test accuracy: 75.91
Round  88, Train loss: 0.167, Test loss: 0.793, Test accuracy: 75.55
Round  89, Train loss: 0.170, Test loss: 0.787, Test accuracy: 76.24
Round  90, Train loss: 0.305, Test loss: 0.794, Test accuracy: 76.03
Round  91, Train loss: 0.286, Test loss: 0.792, Test accuracy: 76.07
Round  92, Train loss: 0.281, Test loss: 0.785, Test accuracy: 76.01
Round  93, Train loss: 0.272, Test loss: 0.775, Test accuracy: 76.54
Round  94, Train loss: 0.271, Test loss: 0.805, Test accuracy: 76.12
Round  95, Train loss: 0.263, Test loss: 0.806, Test accuracy: 76.47
Round  96, Train loss: 0.261, Test loss: 0.802, Test accuracy: 76.42
Round  97, Train loss: 0.263, Test loss: 0.787, Test accuracy: 76.62
Round  98, Train loss: 0.259, Test loss: 0.804, Test accuracy: 76.11
Round  99, Train loss: 0.250, Test loss: 0.803, Test accuracy: 76.45
Final Round, Train loss: 0.231, Test loss: 0.801, Test accuracy: 76.55
Average accuracy final 10 rounds: 76.28399999999999
3594.9463868141174
[2.8794190883636475, 5.413138389587402, 7.936798334121704, 10.489171981811523, 13.013598918914795, 15.537469387054443, 18.06113576889038, 20.58225727081299, 23.109710931777954, 25.630277156829834, 28.149379014968872, 30.669474840164185, 33.19355583190918, 35.70886492729187, 38.22531342506409, 40.74115514755249, 43.25838232040405, 45.77195072174072, 48.29014778137207, 50.80601739883423, 53.321550369262695, 57.3420512676239, 61.365864992141724, 65.37682604789734, 69.39507865905762, 73.40749669075012, 77.42303991317749, 81.43475890159607, 85.45766711235046, 89.47904825210571, 93.5086658000946, 97.53670120239258, 101.56470203399658, 105.65011739730835, 109.70564579963684, 113.73257279396057, 117.76683163642883, 121.79977107048035, 125.82382011413574, 129.85709047317505, 133.88483452796936, 137.90407705307007, 141.93866205215454, 145.97974038124084, 150.00133895874023, 154.0215175151825, 158.0375690460205, 162.10234117507935, 166.16736721992493, 170.23665022850037, 174.28944897651672, 178.35556483268738, 182.40449690818787, 186.44999408721924, 190.47616291046143, 194.53069400787354, 198.57468843460083, 202.70182991027832, 206.7476258277893, 210.81017875671387, 214.867360830307, 218.89408707618713, 222.9614133834839, 227.03242325782776, 231.0505087375641, 235.07276368141174, 239.13336730003357, 243.19047021865845, 247.2465624809265, 251.31672191619873, 255.3877456188202, 259.4491801261902, 263.51540970802307, 267.57306456565857, 271.58480954170227, 275.6275465488434, 279.7608323097229, 283.8251383304596, 287.88591957092285, 291.95392394065857, 296.02098393440247, 300.08833050727844, 304.15995049476624, 308.239869594574, 312.31746101379395, 316.33952498435974, 320.40487241744995, 324.46400356292725, 328.53405261039734, 332.60279154777527, 336.68355679512024, 340.7695400714874, 344.84202098846436, 348.9113554954529, 352.9845972061157, 357.04197812080383, 361.104709148407, 365.18133664131165, 369.25271582603455, 373.32884192466736, 377.21700286865234]
[36.39, 47.16, 53.33, 56.84, 59.6, 61.52, 62.79, 64.72, 66.09, 67.0, 67.58, 67.03, 68.32, 68.26, 69.07, 68.67, 69.6, 69.68, 70.21, 70.6, 70.16, 70.46, 72.12, 72.83, 72.72, 72.3, 72.22, 72.6, 73.41, 73.67, 73.17, 73.68, 73.82, 73.52, 73.75, 74.14, 74.31, 74.93, 74.64, 74.36, 74.77, 75.13, 75.05, 75.62, 75.69, 75.79, 75.34, 75.56, 75.79, 76.19, 76.12, 76.14, 75.68, 75.64, 75.76, 75.84, 75.43, 75.47, 75.62, 75.9, 75.4, 75.05, 75.33, 76.01, 76.04, 75.76, 76.62, 76.2, 76.35, 76.3, 75.9, 76.24, 75.97, 75.99, 75.88, 75.51, 75.84, 75.47, 75.69, 75.74, 76.05, 76.53, 76.22, 76.21, 75.98, 76.33, 75.97, 75.91, 75.55, 76.24, 76.03, 76.07, 76.01, 76.54, 76.12, 76.47, 76.42, 76.62, 76.11, 76.45, 76.55]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.785, Test loss: 2.103, Test accuracy: 23.02
Round   0, Global train loss: 1.785, Global test loss: 2.250, Global test accuracy: 23.99
Round   1, Train loss: 1.592, Test loss: 1.973, Test accuracy: 25.44
Round   1, Global train loss: 1.592, Global test loss: 2.199, Global test accuracy: 23.24
Round   2, Train loss: 1.550, Test loss: 1.820, Test accuracy: 31.50
Round   2, Global train loss: 1.550, Global test loss: 2.195, Global test accuracy: 28.34
Round   3, Train loss: 1.460, Test loss: 1.670, Test accuracy: 34.11
Round   3, Global train loss: 1.460, Global test loss: 2.216, Global test accuracy: 29.68
Round   4, Train loss: 1.395, Test loss: 1.556, Test accuracy: 34.67
Round   4, Global train loss: 1.395, Global test loss: 2.022, Global test accuracy: 29.49
Round   5, Train loss: 1.576, Test loss: 1.509, Test accuracy: 35.58
Round   5, Global train loss: 1.576, Global test loss: 2.161, Global test accuracy: 25.47
Round   6, Train loss: 1.480, Test loss: 1.456, Test accuracy: 37.41
Round   6, Global train loss: 1.480, Global test loss: 2.124, Global test accuracy: 27.47
Round   7, Train loss: 1.511, Test loss: 1.451, Test accuracy: 38.28
Round   7, Global train loss: 1.511, Global test loss: 2.103, Global test accuracy: 23.87
Round   8, Train loss: 1.543, Test loss: 1.436, Test accuracy: 38.87
Round   8, Global train loss: 1.543, Global test loss: 2.062, Global test accuracy: 29.87
Round   9, Train loss: 1.686, Test loss: 1.438, Test accuracy: 39.00
Round   9, Global train loss: 1.686, Global test loss: 2.401, Global test accuracy: 21.99
Round  10, Train loss: 1.543, Test loss: 1.433, Test accuracy: 40.71
Round  10, Global train loss: 1.543, Global test loss: 2.175, Global test accuracy: 30.15
Round  11, Train loss: 1.241, Test loss: 1.428, Test accuracy: 41.22
Round  11, Global train loss: 1.241, Global test loss: 2.015, Global test accuracy: 29.75
Round  12, Train loss: 1.338, Test loss: 1.426, Test accuracy: 41.62
Round  12, Global train loss: 1.338, Global test loss: 2.029, Global test accuracy: 36.89
Round  13, Train loss: 1.394, Test loss: 1.425, Test accuracy: 42.08
Round  13, Global train loss: 1.394, Global test loss: 2.098, Global test accuracy: 27.68
Round  14, Train loss: 1.250, Test loss: 1.409, Test accuracy: 42.53
Round  14, Global train loss: 1.250, Global test loss: 2.155, Global test accuracy: 30.70
Round  15, Train loss: 1.473, Test loss: 1.413, Test accuracy: 41.89
Round  15, Global train loss: 1.473, Global test loss: 2.165, Global test accuracy: 26.19
Round  16, Train loss: 1.374, Test loss: 1.425, Test accuracy: 42.18
Round  16, Global train loss: 1.374, Global test loss: 2.038, Global test accuracy: 30.34
Round  17, Train loss: 1.487, Test loss: 1.416, Test accuracy: 42.85
Round  17, Global train loss: 1.487, Global test loss: 2.107, Global test accuracy: 29.26
Round  18, Train loss: 1.398, Test loss: 1.407, Test accuracy: 43.19
Round  18, Global train loss: 1.398, Global test loss: 2.085, Global test accuracy: 33.89
Round  19, Train loss: 1.184, Test loss: 1.408, Test accuracy: 43.65
Round  19, Global train loss: 1.184, Global test loss: 2.069, Global test accuracy: 30.11
Round  20, Train loss: 1.481, Test loss: 1.417, Test accuracy: 42.27
Round  20, Global train loss: 1.481, Global test loss: 2.227, Global test accuracy: 23.31
Round  21, Train loss: 1.337, Test loss: 1.426, Test accuracy: 41.48
Round  21, Global train loss: 1.337, Global test loss: 2.089, Global test accuracy: 27.51
Round  22, Train loss: 0.982, Test loss: 1.422, Test accuracy: 42.43
Round  22, Global train loss: 0.982, Global test loss: 2.211, Global test accuracy: 30.81
Round  23, Train loss: 1.171, Test loss: 1.408, Test accuracy: 43.33
Round  23, Global train loss: 1.171, Global test loss: 1.990, Global test accuracy: 34.23
Round  24, Train loss: 1.392, Test loss: 1.414, Test accuracy: 42.93
Round  24, Global train loss: 1.392, Global test loss: 2.238, Global test accuracy: 25.43
Round  25, Train loss: 1.219, Test loss: 1.415, Test accuracy: 42.49
Round  25, Global train loss: 1.219, Global test loss: 1.999, Global test accuracy: 29.22
Round  26, Train loss: 1.100, Test loss: 1.421, Test accuracy: 43.28
Round  26, Global train loss: 1.100, Global test loss: 2.048, Global test accuracy: 31.18
Round  27, Train loss: 0.950, Test loss: 1.438, Test accuracy: 42.81
Round  27, Global train loss: 0.950, Global test loss: 2.000, Global test accuracy: 33.45
Round  28, Train loss: 1.377, Test loss: 1.438, Test accuracy: 43.02
Round  28, Global train loss: 1.377, Global test loss: 2.105, Global test accuracy: 33.32
Round  29, Train loss: 1.420, Test loss: 1.450, Test accuracy: 42.50
Round  29, Global train loss: 1.420, Global test loss: 2.144, Global test accuracy: 31.16
Round  30, Train loss: 1.372, Test loss: 1.451, Test accuracy: 42.88
Round  30, Global train loss: 1.372, Global test loss: 2.102, Global test accuracy: 30.25
Round  31, Train loss: 0.771, Test loss: 1.454, Test accuracy: 43.13
Round  31, Global train loss: 0.771, Global test loss: 2.059, Global test accuracy: 32.17
Round  32, Train loss: 1.067, Test loss: 1.486, Test accuracy: 42.54
Round  32, Global train loss: 1.067, Global test loss: 2.112, Global test accuracy: 29.45
Round  33, Train loss: 1.204, Test loss: 1.497, Test accuracy: 43.04
Round  33, Global train loss: 1.204, Global test loss: 1.999, Global test accuracy: 32.48
Round  34, Train loss: 0.896, Test loss: 1.516, Test accuracy: 42.90
Round  34, Global train loss: 0.896, Global test loss: 1.918, Global test accuracy: 33.98
Round  35, Train loss: 0.812, Test loss: 1.518, Test accuracy: 42.81
Round  35, Global train loss: 0.812, Global test loss: 1.975, Global test accuracy: 33.71
Round  36, Train loss: 0.995, Test loss: 1.554, Test accuracy: 42.64
Round  36, Global train loss: 0.995, Global test loss: 2.026, Global test accuracy: 31.07
Round  37, Train loss: 1.134, Test loss: 1.571, Test accuracy: 42.18
Round  37, Global train loss: 1.134, Global test loss: 2.083, Global test accuracy: 29.33
Round  38, Train loss: 1.544, Test loss: 1.576, Test accuracy: 41.95
Round  38, Global train loss: 1.544, Global test loss: 2.228, Global test accuracy: 22.02
Round  39, Train loss: 0.993, Test loss: 1.574, Test accuracy: 41.95
Round  39, Global train loss: 0.993, Global test loss: 2.053, Global test accuracy: 25.64
Round  40, Train loss: 0.754, Test loss: 1.570, Test accuracy: 42.24
Round  40, Global train loss: 0.754, Global test loss: 2.030, Global test accuracy: 29.77
Round  41, Train loss: 0.983, Test loss: 1.609, Test accuracy: 42.88
Round  41, Global train loss: 0.983, Global test loss: 2.084, Global test accuracy: 31.03
Round  42, Train loss: 1.206, Test loss: 1.620, Test accuracy: 42.35
Round  42, Global train loss: 1.206, Global test loss: 2.193, Global test accuracy: 28.75
Round  43, Train loss: 0.761, Test loss: 1.624, Test accuracy: 41.71
Round  43, Global train loss: 0.761, Global test loss: 1.943, Global test accuracy: 32.53
Round  44, Train loss: 1.070, Test loss: 1.631, Test accuracy: 42.40
Round  44, Global train loss: 1.070, Global test loss: 2.039, Global test accuracy: 32.84
Round  45, Train loss: 1.048, Test loss: 1.663, Test accuracy: 42.04
Round  45, Global train loss: 1.048, Global test loss: 2.071, Global test accuracy: 26.92
Round  46, Train loss: 0.657, Test loss: 1.699, Test accuracy: 41.93
Round  46, Global train loss: 0.657, Global test loss: 2.033, Global test accuracy: 32.85
Round  47, Train loss: 0.995, Test loss: 1.746, Test accuracy: 41.91
Round  47, Global train loss: 0.995, Global test loss: 2.013, Global test accuracy: 32.81
Round  48, Train loss: 0.441, Test loss: 1.775, Test accuracy: 42.52
Round  48, Global train loss: 0.441, Global test loss: 2.178, Global test accuracy: 30.01
Round  49, Train loss: 0.769, Test loss: 1.752, Test accuracy: 42.77
Round  49, Global train loss: 0.769, Global test loss: 2.035, Global test accuracy: 31.18
Round  50, Train loss: 0.991, Test loss: 1.752, Test accuracy: 43.24
Round  50, Global train loss: 0.991, Global test loss: 2.035, Global test accuracy: 29.90
Round  51, Train loss: 1.054, Test loss: 1.802, Test accuracy: 41.98
Round  51, Global train loss: 1.054, Global test loss: 2.158, Global test accuracy: 32.33
Round  52, Train loss: 0.890, Test loss: 1.842, Test accuracy: 42.92
Round  52, Global train loss: 0.890, Global test loss: 2.118, Global test accuracy: 26.81
Round  53, Train loss: 1.080, Test loss: 1.865, Test accuracy: 42.03
Round  53, Global train loss: 1.080, Global test loss: 2.210, Global test accuracy: 26.58
Round  54, Train loss: 0.974, Test loss: 1.910, Test accuracy: 42.26
Round  54, Global train loss: 0.974, Global test loss: 2.051, Global test accuracy: 33.25
Round  55, Train loss: 0.863, Test loss: 1.957, Test accuracy: 41.95
Round  55, Global train loss: 0.863, Global test loss: 2.105, Global test accuracy: 25.46
Round  56, Train loss: 1.000, Test loss: 1.942, Test accuracy: 42.52
Round  56, Global train loss: 1.000, Global test loss: 2.109, Global test accuracy: 32.71
Round  57, Train loss: 0.818, Test loss: 1.984, Test accuracy: 42.34
Round  57, Global train loss: 0.818, Global test loss: 2.070, Global test accuracy: 27.01
Round  58, Train loss: 0.795, Test loss: 2.057, Test accuracy: 41.39
Round  58, Global train loss: 0.795, Global test loss: 2.074, Global test accuracy: 28.96
Round  59, Train loss: 0.680, Test loss: 2.053, Test accuracy: 41.66
Round  59, Global train loss: 0.680, Global test loss: 2.004, Global test accuracy: 31.11
Round  60, Train loss: 0.670, Test loss: 2.103, Test accuracy: 41.79
Round  60, Global train loss: 0.670, Global test loss: 2.104, Global test accuracy: 28.22
Round  61, Train loss: 0.594, Test loss: 2.152, Test accuracy: 41.89
Round  61, Global train loss: 0.594, Global test loss: 2.037, Global test accuracy: 31.90
Round  62, Train loss: 0.627, Test loss: 2.186, Test accuracy: 40.89
Round  62, Global train loss: 0.627, Global test loss: 2.161, Global test accuracy: 24.49
Round  63, Train loss: 0.635, Test loss: 2.184, Test accuracy: 40.85
Round  63, Global train loss: 0.635, Global test loss: 2.008, Global test accuracy: 30.68
Round  64, Train loss: 0.710, Test loss: 2.206, Test accuracy: 41.18
Round  64, Global train loss: 0.710, Global test loss: 1.938, Global test accuracy: 32.98
Round  65, Train loss: 0.904, Test loss: 2.235, Test accuracy: 40.86
Round  65, Global train loss: 0.904, Global test loss: 2.102, Global test accuracy: 28.61
Round  66, Train loss: 0.384, Test loss: 2.294, Test accuracy: 40.66
Round  66, Global train loss: 0.384, Global test loss: 1.948, Global test accuracy: 34.03
Round  67, Train loss: 0.779, Test loss: 2.323, Test accuracy: 40.94
Round  67, Global train loss: 0.779, Global test loss: 2.162, Global test accuracy: 26.67
Round  68, Train loss: 0.714, Test loss: 2.353, Test accuracy: 41.01
Round  68, Global train loss: 0.714, Global test loss: 2.179, Global test accuracy: 30.65
Round  69, Train loss: 0.437, Test loss: 2.387, Test accuracy: 40.84
Round  69, Global train loss: 0.437, Global test loss: 2.102, Global test accuracy: 31.91
Round  70, Train loss: 0.670, Test loss: 2.474, Test accuracy: 40.60
Round  70, Global train loss: 0.670, Global test loss: 2.058, Global test accuracy: 31.64
Round  71, Train loss: 0.544, Test loss: 2.463, Test accuracy: 41.02
Round  71, Global train loss: 0.544, Global test loss: 2.098, Global test accuracy: 28.02
Round  72, Train loss: 0.330, Test loss: 2.545, Test accuracy: 40.59
Round  72, Global train loss: 0.330, Global test loss: 1.939, Global test accuracy: 32.67
Round  73, Train loss: 0.388, Test loss: 2.573, Test accuracy: 40.52
Round  73, Global train loss: 0.388, Global test loss: 2.017, Global test accuracy: 33.76
Round  74, Train loss: 0.438, Test loss: 2.557, Test accuracy: 40.97
Round  74, Global train loss: 0.438, Global test loss: 2.099, Global test accuracy: 29.59
Round  75, Train loss: 0.339, Test loss: 2.600, Test accuracy: 40.96
Round  75, Global train loss: 0.339, Global test loss: 1.985, Global test accuracy: 33.76
Round  76, Train loss: 0.499, Test loss: 2.651, Test accuracy: 40.87
Round  76, Global train loss: 0.499, Global test loss: 2.038, Global test accuracy: 29.96
Round  77, Train loss: 0.389, Test loss: 2.661, Test accuracy: 40.69
Round  77, Global train loss: 0.389, Global test loss: 2.091, Global test accuracy: 29.80
Round  78, Train loss: 0.327, Test loss: 2.673, Test accuracy: 40.42
Round  78, Global train loss: 0.327, Global test loss: 2.061, Global test accuracy: 31.48
Round  79, Train loss: 0.365, Test loss: 2.787, Test accuracy: 39.99
Round  79, Global train loss: 0.365, Global test loss: 2.098, Global test accuracy: 33.30
Round  80, Train loss: 0.516, Test loss: 2.842, Test accuracy: 40.17
Round  80, Global train loss: 0.516, Global test loss: 2.187, Global test accuracy: 27.74
Round  81, Train loss: 0.353, Test loss: 2.849, Test accuracy: 40.31
Round  81, Global train loss: 0.353, Global test loss: 2.178, Global test accuracy: 29.47
Round  82, Train loss: 0.453, Test loss: 2.861, Test accuracy: 40.72
Round  82, Global train loss: 0.453, Global test loss: 2.063, Global test accuracy: 29.94
Round  83, Train loss: 0.329, Test loss: 2.877, Test accuracy: 40.72
Round  83, Global train loss: 0.329, Global test loss: 2.080, Global test accuracy: 29.14
Round  84, Train loss: 0.329, Test loss: 2.918, Test accuracy: 40.47
Round  84, Global train loss: 0.329, Global test loss: 2.016, Global test accuracy: 31.26
Round  85, Train loss: 0.445, Test loss: 2.978, Test accuracy: 40.51
Round  85, Global train loss: 0.445, Global test loss: 2.139, Global test accuracy: 27.15
Round  86, Train loss: 0.284, Test loss: 2.973, Test accuracy: 40.50
Round  86, Global train loss: 0.284, Global test loss: 2.111, Global test accuracy: 29.63
Round  87, Train loss: 0.303, Test loss: 3.007, Test accuracy: 40.92
Round  87, Global train loss: 0.303, Global test loss: 2.044, Global test accuracy: 30.61
Round  88, Train loss: 0.442, Test loss: 2.996, Test accuracy: 41.33
Round  88, Global train loss: 0.442, Global test loss: 2.090, Global test accuracy: 28.95
Round  89, Train loss: 0.272, Test loss: 3.003, Test accuracy: 41.22
Round  89, Global train loss: 0.272, Global test loss: 2.024, Global test accuracy: 30.81
Round  90, Train loss: 0.383, Test loss: 3.037, Test accuracy: 41.34
Round  90, Global train loss: 0.383, Global test loss: 2.150, Global test accuracy: 24.54
Round  91, Train loss: 0.343, Test loss: 3.123, Test accuracy: 41.37
Round  91, Global train loss: 0.343, Global test loss: 2.096, Global test accuracy: 29.90
Round  92, Train loss: 0.288, Test loss: 3.140, Test accuracy: 41.52
Round  92, Global train loss: 0.288, Global test loss: 2.054, Global test accuracy: 32.07
Round  93, Train loss: 0.289, Test loss: 3.188, Test accuracy: 41.85
Round  93, Global train loss: 0.289, Global test loss: 2.084, Global test accuracy: 28.99
Round  94, Train loss: 0.289, Test loss: 3.199, Test accuracy: 41.57
Round  94, Global train loss: 0.289, Global test loss: 2.017, Global test accuracy: 30.57
Round  95, Train loss: 0.413, Test loss: 3.257, Test accuracy: 41.17
Round  95, Global train loss: 0.413, Global test loss: 2.157, Global test accuracy: 28.48
Round  96, Train loss: 0.131, Test loss: 3.273, Test accuracy: 41.34
Round  96, Global train loss: 0.131, Global test loss: 1.988, Global test accuracy: 33.11
Round  97, Train loss: 0.269, Test loss: 3.280, Test accuracy: 41.30
Round  97, Global train loss: 0.269, Global test loss: 2.085, Global test accuracy: 25.63
Round  98, Train loss: 0.231, Test loss: 3.330, Test accuracy: 40.97
Round  98, Global train loss: 0.231, Global test loss: 2.074, Global test accuracy: 28.91
Round  99, Train loss: 0.258, Test loss: 3.393, Test accuracy: 40.83
Round  99, Global train loss: 0.258, Global test loss: 1.992, Global test accuracy: 32.28
Final Round, Train loss: 0.246, Test loss: 3.643, Test accuracy: 40.12
Final Round, Global train loss: 0.246, Global test loss: 1.992, Global test accuracy: 32.28
Average accuracy final 10 rounds: 41.32600000000001 

Average global accuracy final 10 rounds: 29.448 

1251.1510713100433
[1.3644802570343018, 2.7289605140686035, 3.8359391689300537, 4.942917823791504, 6.05054783821106, 7.158177852630615, 8.267349004745483, 9.376520156860352, 10.493264436721802, 11.610008716583252, 12.726225137710571, 13.84244155883789, 14.889658689498901, 15.936875820159912, 16.890680074691772, 17.844484329223633, 18.799588441848755, 19.754692554473877, 20.70892071723938, 21.663148880004883, 22.617711782455444, 23.572274684906006, 24.523151874542236, 25.474029064178467, 26.419182300567627, 27.364335536956787, 28.31726360321045, 29.27019166946411, 30.226527214050293, 31.182862758636475, 32.14047074317932, 33.09807872772217, 34.05527138710022, 35.01246404647827, 35.97076344490051, 36.929062843322754, 37.88158464431763, 38.8341064453125, 39.80237007141113, 40.770633697509766, 41.73843598365784, 42.70623826980591, 43.6622257232666, 44.618213176727295, 45.58463788032532, 46.55106258392334, 47.50181770324707, 48.4525728225708, 49.4049277305603, 50.357282638549805, 51.310955286026, 52.2646279335022, 53.21923875808716, 54.17384958267212, 55.13416862487793, 56.09448766708374, 57.04712700843811, 57.99976634979248, 58.96761465072632, 59.935462951660156, 60.891456604003906, 61.847450256347656, 62.79863500595093, 63.7498197555542, 64.70850896835327, 65.66719818115234, 66.61263680458069, 67.55807542800903, 68.51116967201233, 69.46426391601562, 70.4098756313324, 71.35548734664917, 72.32226514816284, 73.28904294967651, 74.25317668914795, 75.21731042861938, 76.16850209236145, 77.11969375610352, 78.06465482711792, 79.00961589813232, 79.95181727409363, 80.89401865005493, 81.83772468566895, 82.78143072128296, 83.73133420944214, 84.68123769760132, 85.63470458984375, 86.58817148208618, 87.5414969921112, 88.49482250213623, 89.45331120491028, 90.41179990768433, 91.35996580123901, 92.3081316947937, 93.25441789627075, 94.2007040977478, 95.14786100387573, 96.09501791000366, 97.03977060317993, 97.9845232963562, 98.92685055732727, 99.86917781829834, 100.81154656410217, 101.753915309906, 102.70502400398254, 103.65613269805908, 104.60898780822754, 105.561842918396, 106.5114676952362, 107.46109247207642, 108.41118264198303, 109.36127281188965, 110.31505298614502, 111.26883316040039, 112.22257661819458, 113.17632007598877, 114.1269600391388, 115.07760000228882, 116.03088712692261, 116.9841742515564, 117.93493342399597, 118.88569259643555, 119.83871746063232, 120.7917423248291, 121.74512004852295, 122.6984977722168, 123.65240359306335, 124.60630941390991, 125.55602645874023, 126.50574350357056, 127.4559006690979, 128.40605783462524, 129.35012412071228, 130.29419040679932, 131.23837971687317, 132.18256902694702, 133.13478446006775, 134.08699989318848, 135.03009915351868, 135.97319841384888, 136.91666197776794, 137.860125541687, 138.80385398864746, 139.7475824356079, 140.69074273109436, 141.6339030265808, 142.58686780929565, 143.5398325920105, 144.4901897907257, 145.44054698944092, 146.38515996932983, 147.32977294921875, 148.27675223350525, 149.22373151779175, 150.17074060440063, 151.11774969100952, 152.06055569648743, 153.00336170196533, 153.9502251148224, 154.89708852767944, 155.8349597454071, 156.77283096313477, 157.7066831588745, 158.64053535461426, 159.5822470188141, 160.52395868301392, 161.46770071983337, 162.41144275665283, 163.36241054534912, 164.3133783340454, 165.26784920692444, 166.22232007980347, 167.16580033302307, 168.10928058624268, 169.0527787208557, 169.99627685546875, 170.9321482181549, 171.86801958084106, 172.80520105361938, 173.7423825263977, 174.68892335891724, 175.63546419143677, 176.57841610908508, 177.5213680267334, 178.4638955593109, 179.40642309188843, 180.34218788146973, 181.27795267105103, 182.21413111686707, 183.1503095626831, 184.0869665145874, 185.0236234664917, 185.96414923667908, 186.90467500686646, 187.84697842597961, 188.78928184509277, 189.72660613059998, 190.66393041610718, 191.60464644432068, 192.54536247253418, 194.4261269569397, 196.30689144134521]
[23.02, 23.02, 25.44, 25.44, 31.5, 31.5, 34.11, 34.11, 34.67, 34.67, 35.58, 35.58, 37.41, 37.41, 38.28, 38.28, 38.87, 38.87, 39.0, 39.0, 40.71, 40.71, 41.22, 41.22, 41.62, 41.62, 42.08, 42.08, 42.53, 42.53, 41.89, 41.89, 42.18, 42.18, 42.85, 42.85, 43.19, 43.19, 43.65, 43.65, 42.27, 42.27, 41.48, 41.48, 42.43, 42.43, 43.33, 43.33, 42.93, 42.93, 42.49, 42.49, 43.28, 43.28, 42.81, 42.81, 43.02, 43.02, 42.5, 42.5, 42.88, 42.88, 43.13, 43.13, 42.54, 42.54, 43.04, 43.04, 42.9, 42.9, 42.81, 42.81, 42.64, 42.64, 42.18, 42.18, 41.95, 41.95, 41.95, 41.95, 42.24, 42.24, 42.88, 42.88, 42.35, 42.35, 41.71, 41.71, 42.4, 42.4, 42.04, 42.04, 41.93, 41.93, 41.91, 41.91, 42.52, 42.52, 42.77, 42.77, 43.24, 43.24, 41.98, 41.98, 42.92, 42.92, 42.03, 42.03, 42.26, 42.26, 41.95, 41.95, 42.52, 42.52, 42.34, 42.34, 41.39, 41.39, 41.66, 41.66, 41.79, 41.79, 41.89, 41.89, 40.89, 40.89, 40.85, 40.85, 41.18, 41.18, 40.86, 40.86, 40.66, 40.66, 40.94, 40.94, 41.01, 41.01, 40.84, 40.84, 40.6, 40.6, 41.02, 41.02, 40.59, 40.59, 40.52, 40.52, 40.97, 40.97, 40.96, 40.96, 40.87, 40.87, 40.69, 40.69, 40.42, 40.42, 39.99, 39.99, 40.17, 40.17, 40.31, 40.31, 40.72, 40.72, 40.72, 40.72, 40.47, 40.47, 40.51, 40.51, 40.5, 40.5, 40.92, 40.92, 41.33, 41.33, 41.22, 41.22, 41.34, 41.34, 41.37, 41.37, 41.52, 41.52, 41.85, 41.85, 41.57, 41.57, 41.17, 41.17, 41.34, 41.34, 41.3, 41.3, 40.97, 40.97, 40.83, 40.83, 40.12, 40.12]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.636, Test loss: 2.058, Test accuracy: 30.06
Round   0, Global train loss: 1.636, Global test loss: 2.220, Global test accuracy: 28.16
Round   1, Train loss: 1.427, Test loss: 1.862, Test accuracy: 36.46
Round   1, Global train loss: 1.427, Global test loss: 2.161, Global test accuracy: 31.35
Round   2, Train loss: 1.364, Test loss: 1.605, Test accuracy: 40.60
Round   2, Global train loss: 1.364, Global test loss: 2.021, Global test accuracy: 29.89
Round   3, Train loss: 1.358, Test loss: 1.424, Test accuracy: 43.89
Round   3, Global train loss: 1.358, Global test loss: 1.949, Global test accuracy: 33.20
Round   4, Train loss: 1.194, Test loss: 1.309, Test accuracy: 47.77
Round   4, Global train loss: 1.194, Global test loss: 1.809, Global test accuracy: 36.92
Round   5, Train loss: 1.164, Test loss: 1.205, Test accuracy: 51.46
Round   5, Global train loss: 1.164, Global test loss: 1.651, Global test accuracy: 43.08
Round   6, Train loss: 1.306, Test loss: 1.132, Test accuracy: 54.98
Round   6, Global train loss: 1.306, Global test loss: 1.720, Global test accuracy: 38.30
Round   7, Train loss: 1.205, Test loss: 1.125, Test accuracy: 56.04
Round   7, Global train loss: 1.205, Global test loss: 1.583, Global test accuracy: 45.22
Round   8, Train loss: 1.155, Test loss: 1.079, Test accuracy: 57.95
Round   8, Global train loss: 1.155, Global test loss: 1.489, Global test accuracy: 50.38
Round   9, Train loss: 0.903, Test loss: 1.064, Test accuracy: 59.29
Round   9, Global train loss: 0.903, Global test loss: 1.788, Global test accuracy: 46.59
Round  10, Train loss: 0.971, Test loss: 1.069, Test accuracy: 59.25
Round  10, Global train loss: 0.971, Global test loss: 1.676, Global test accuracy: 49.01
Round  11, Train loss: 1.080, Test loss: 1.053, Test accuracy: 60.31
Round  11, Global train loss: 1.080, Global test loss: 1.510, Global test accuracy: 51.05
Round  12, Train loss: 1.035, Test loss: 1.053, Test accuracy: 60.22
Round  12, Global train loss: 1.035, Global test loss: 1.586, Global test accuracy: 51.20
Round  13, Train loss: 0.866, Test loss: 1.035, Test accuracy: 61.31
Round  13, Global train loss: 0.866, Global test loss: 1.470, Global test accuracy: 50.30
Round  14, Train loss: 1.088, Test loss: 1.013, Test accuracy: 62.12
Round  14, Global train loss: 1.088, Global test loss: 1.465, Global test accuracy: 49.37
Round  15, Train loss: 0.903, Test loss: 0.990, Test accuracy: 63.06
Round  15, Global train loss: 0.903, Global test loss: 1.403, Global test accuracy: 52.92
Round  16, Train loss: 0.829, Test loss: 0.990, Test accuracy: 63.19
Round  16, Global train loss: 0.829, Global test loss: 1.263, Global test accuracy: 56.07
Round  17, Train loss: 0.891, Test loss: 0.994, Test accuracy: 63.48
Round  17, Global train loss: 0.891, Global test loss: 1.305, Global test accuracy: 54.82
Round  18, Train loss: 0.908, Test loss: 0.982, Test accuracy: 64.28
Round  18, Global train loss: 0.908, Global test loss: 1.453, Global test accuracy: 53.13
Round  19, Train loss: 0.907, Test loss: 0.976, Test accuracy: 64.51
Round  19, Global train loss: 0.907, Global test loss: 1.318, Global test accuracy: 55.13
Round  20, Train loss: 0.781, Test loss: 0.958, Test accuracy: 64.98
Round  20, Global train loss: 0.781, Global test loss: 1.440, Global test accuracy: 54.52
Round  21, Train loss: 0.916, Test loss: 0.949, Test accuracy: 65.26
Round  21, Global train loss: 0.916, Global test loss: 1.299, Global test accuracy: 54.82
Round  22, Train loss: 0.790, Test loss: 0.930, Test accuracy: 66.10
Round  22, Global train loss: 0.790, Global test loss: 1.300, Global test accuracy: 55.82
Round  23, Train loss: 0.829, Test loss: 0.926, Test accuracy: 66.37
Round  23, Global train loss: 0.829, Global test loss: 1.281, Global test accuracy: 58.05
Round  24, Train loss: 0.667, Test loss: 0.937, Test accuracy: 66.08
Round  24, Global train loss: 0.667, Global test loss: 1.549, Global test accuracy: 56.07
Round  25, Train loss: 0.849, Test loss: 0.932, Test accuracy: 66.82
Round  25, Global train loss: 0.849, Global test loss: 1.267, Global test accuracy: 58.28
Round  26, Train loss: 0.778, Test loss: 0.936, Test accuracy: 66.58
Round  26, Global train loss: 0.778, Global test loss: 1.287, Global test accuracy: 57.42
Round  27, Train loss: 0.812, Test loss: 0.917, Test accuracy: 67.75
Round  27, Global train loss: 0.812, Global test loss: 1.265, Global test accuracy: 57.16
Round  28, Train loss: 0.842, Test loss: 0.916, Test accuracy: 67.83
Round  28, Global train loss: 0.842, Global test loss: 1.367, Global test accuracy: 55.00
Round  29, Train loss: 0.711, Test loss: 0.910, Test accuracy: 68.08
Round  29, Global train loss: 0.711, Global test loss: 1.345, Global test accuracy: 57.61
Round  30, Train loss: 0.775, Test loss: 0.914, Test accuracy: 67.59
Round  30, Global train loss: 0.775, Global test loss: 1.400, Global test accuracy: 56.20
Round  31, Train loss: 0.916, Test loss: 0.925, Test accuracy: 67.52
Round  31, Global train loss: 0.916, Global test loss: 1.226, Global test accuracy: 58.98
Round  32, Train loss: 0.747, Test loss: 0.909, Test accuracy: 67.97
Round  32, Global train loss: 0.747, Global test loss: 1.274, Global test accuracy: 57.60
Round  33, Train loss: 0.670, Test loss: 0.900, Test accuracy: 68.72
Round  33, Global train loss: 0.670, Global test loss: 1.206, Global test accuracy: 59.96
Round  34, Train loss: 0.796, Test loss: 0.894, Test accuracy: 68.87
Round  34, Global train loss: 0.796, Global test loss: 1.197, Global test accuracy: 61.15
Round  35, Train loss: 0.676, Test loss: 0.898, Test accuracy: 68.52
Round  35, Global train loss: 0.676, Global test loss: 1.237, Global test accuracy: 58.95
Round  36, Train loss: 0.645, Test loss: 0.898, Test accuracy: 68.74
Round  36, Global train loss: 0.645, Global test loss: 1.236, Global test accuracy: 61.94
Round  37, Train loss: 0.653, Test loss: 0.909, Test accuracy: 68.65
Round  37, Global train loss: 0.653, Global test loss: 1.269, Global test accuracy: 58.98
Round  38, Train loss: 0.695, Test loss: 0.914, Test accuracy: 68.75
Round  38, Global train loss: 0.695, Global test loss: 1.382, Global test accuracy: 56.64
Round  39, Train loss: 0.694, Test loss: 0.927, Test accuracy: 68.56
Round  39, Global train loss: 0.694, Global test loss: 1.276, Global test accuracy: 59.58
Round  40, Train loss: 0.727, Test loss: 0.944, Test accuracy: 68.03
Round  40, Global train loss: 0.727, Global test loss: 1.270, Global test accuracy: 58.67
Round  41, Train loss: 0.641, Test loss: 0.928, Test accuracy: 68.65
Round  41, Global train loss: 0.641, Global test loss: 1.254, Global test accuracy: 58.95
Round  42, Train loss: 0.526, Test loss: 0.920, Test accuracy: 69.18
Round  42, Global train loss: 0.526, Global test loss: 1.517, Global test accuracy: 57.07
Round  43, Train loss: 0.744, Test loss: 0.905, Test accuracy: 69.92
Round  43, Global train loss: 0.744, Global test loss: 1.132, Global test accuracy: 61.75
Round  44, Train loss: 0.531, Test loss: 0.929, Test accuracy: 69.34
Round  44, Global train loss: 0.531, Global test loss: 1.174, Global test accuracy: 61.52
Round  45, Train loss: 0.621, Test loss: 0.916, Test accuracy: 69.97
Round  45, Global train loss: 0.621, Global test loss: 1.140, Global test accuracy: 62.39
Round  46, Train loss: 0.648, Test loss: 0.925, Test accuracy: 70.06
Round  46, Global train loss: 0.648, Global test loss: 1.178, Global test accuracy: 62.88
Round  47, Train loss: 0.667, Test loss: 0.954, Test accuracy: 69.21
Round  47, Global train loss: 0.667, Global test loss: 1.112, Global test accuracy: 63.42
Round  48, Train loss: 0.612, Test loss: 0.959, Test accuracy: 68.90
Round  48, Global train loss: 0.612, Global test loss: 1.202, Global test accuracy: 61.15
Round  49, Train loss: 0.611, Test loss: 0.937, Test accuracy: 69.35
Round  49, Global train loss: 0.611, Global test loss: 1.239, Global test accuracy: 60.34
Round  50, Train loss: 0.538, Test loss: 0.920, Test accuracy: 69.50
Round  50, Global train loss: 0.538, Global test loss: 1.187, Global test accuracy: 62.04
Round  51, Train loss: 0.461, Test loss: 0.939, Test accuracy: 69.67
Round  51, Global train loss: 0.461, Global test loss: 1.557, Global test accuracy: 60.09
Round  52, Train loss: 0.544, Test loss: 0.939, Test accuracy: 69.61
Round  52, Global train loss: 0.544, Global test loss: 1.362, Global test accuracy: 60.38
Round  53, Train loss: 0.486, Test loss: 0.943, Test accuracy: 69.53
Round  53, Global train loss: 0.486, Global test loss: 1.342, Global test accuracy: 60.66
Round  54, Train loss: 0.502, Test loss: 0.945, Test accuracy: 69.43
Round  54, Global train loss: 0.502, Global test loss: 1.149, Global test accuracy: 63.25
Round  55, Train loss: 0.425, Test loss: 0.919, Test accuracy: 70.04
Round  55, Global train loss: 0.425, Global test loss: 1.471, Global test accuracy: 59.56
Round  56, Train loss: 0.529, Test loss: 0.908, Test accuracy: 70.49
Round  56, Global train loss: 0.529, Global test loss: 1.412, Global test accuracy: 59.82
Round  57, Train loss: 0.604, Test loss: 0.890, Test accuracy: 71.03
Round  57, Global train loss: 0.604, Global test loss: 1.211, Global test accuracy: 61.58
Round  58, Train loss: 0.471, Test loss: 0.892, Test accuracy: 71.14
Round  58, Global train loss: 0.471, Global test loss: 1.162, Global test accuracy: 62.45
Round  59, Train loss: 0.573, Test loss: 0.932, Test accuracy: 70.08
Round  59, Global train loss: 0.573, Global test loss: 1.241, Global test accuracy: 62.48
Round  60, Train loss: 0.425, Test loss: 0.931, Test accuracy: 69.97
Round  60, Global train loss: 0.425, Global test loss: 1.171, Global test accuracy: 63.26
Round  61, Train loss: 0.470, Test loss: 0.952, Test accuracy: 69.72
Round  61, Global train loss: 0.470, Global test loss: 1.565, Global test accuracy: 57.93
Round  62, Train loss: 0.463, Test loss: 0.959, Test accuracy: 69.60
Round  62, Global train loss: 0.463, Global test loss: 1.371, Global test accuracy: 60.68
Round  63, Train loss: 0.568, Test loss: 0.949, Test accuracy: 70.47
Round  63, Global train loss: 0.568, Global test loss: 1.201, Global test accuracy: 63.88
Round  64, Train loss: 0.522, Test loss: 0.938, Test accuracy: 70.77
Round  64, Global train loss: 0.522, Global test loss: 1.160, Global test accuracy: 63.45
Round  65, Train loss: 0.542, Test loss: 0.954, Test accuracy: 70.46
Round  65, Global train loss: 0.542, Global test loss: 1.429, Global test accuracy: 58.88
Round  66, Train loss: 0.459, Test loss: 0.971, Test accuracy: 70.44
Round  66, Global train loss: 0.459, Global test loss: 1.205, Global test accuracy: 63.90
Round  67, Train loss: 0.457, Test loss: 0.988, Test accuracy: 70.19
Round  67, Global train loss: 0.457, Global test loss: 1.356, Global test accuracy: 60.76
Round  68, Train loss: 0.452, Test loss: 0.983, Test accuracy: 70.07
Round  68, Global train loss: 0.452, Global test loss: 1.440, Global test accuracy: 60.37
Round  69, Train loss: 0.445, Test loss: 0.976, Test accuracy: 70.57
Round  69, Global train loss: 0.445, Global test loss: 1.218, Global test accuracy: 62.87
Round  70, Train loss: 0.474, Test loss: 1.002, Test accuracy: 70.05
Round  70, Global train loss: 0.474, Global test loss: 1.407, Global test accuracy: 60.09
Round  71, Train loss: 0.430, Test loss: 0.987, Test accuracy: 70.42
Round  71, Global train loss: 0.430, Global test loss: 1.263, Global test accuracy: 61.60
Round  72, Train loss: 0.468, Test loss: 0.989, Test accuracy: 70.58
Round  72, Global train loss: 0.468, Global test loss: 1.178, Global test accuracy: 64.22
Round  73, Train loss: 0.399, Test loss: 0.973, Test accuracy: 70.89
Round  73, Global train loss: 0.399, Global test loss: 1.221, Global test accuracy: 63.51
Round  74, Train loss: 0.352, Test loss: 0.963, Test accuracy: 71.26
Round  74, Global train loss: 0.352, Global test loss: 1.287, Global test accuracy: 62.29
Round  75, Train loss: 0.453, Test loss: 0.955, Test accuracy: 71.17
Round  75, Global train loss: 0.453, Global test loss: 1.244, Global test accuracy: 62.38
Round  76, Train loss: 0.434, Test loss: 0.936, Test accuracy: 71.81
Round  76, Global train loss: 0.434, Global test loss: 1.309, Global test accuracy: 62.26
Round  77, Train loss: 0.438, Test loss: 0.968, Test accuracy: 71.21
Round  77, Global train loss: 0.438, Global test loss: 1.340, Global test accuracy: 62.45
Round  78, Train loss: 0.439, Test loss: 0.966, Test accuracy: 71.52
Round  78, Global train loss: 0.439, Global test loss: 1.274, Global test accuracy: 63.29
Round  79, Train loss: 0.425, Test loss: 0.982, Test accuracy: 71.43
Round  79, Global train loss: 0.425, Global test loss: 1.323, Global test accuracy: 62.58
Round  80, Train loss: 0.343, Test loss: 0.988, Test accuracy: 71.41
Round  80, Global train loss: 0.343, Global test loss: 1.556, Global test accuracy: 60.38
Round  81, Train loss: 0.430, Test loss: 0.993, Test accuracy: 71.68
Round  81, Global train loss: 0.430, Global test loss: 1.399, Global test accuracy: 60.72
Round  82, Train loss: 0.416, Test loss: 0.996, Test accuracy: 71.23
Round  82, Global train loss: 0.416, Global test loss: 1.414, Global test accuracy: 60.76
Round  83, Train loss: 0.343, Test loss: 1.034, Test accuracy: 70.57
Round  83, Global train loss: 0.343, Global test loss: 1.340, Global test accuracy: 62.31
Round  84, Train loss: 0.450, Test loss: 1.047, Test accuracy: 70.35
Round  84, Global train loss: 0.450, Global test loss: 1.190, Global test accuracy: 63.43
Round  85, Train loss: 0.328, Test loss: 1.047, Test accuracy: 70.80
Round  85, Global train loss: 0.328, Global test loss: 1.261, Global test accuracy: 65.03
Round  86, Train loss: 0.503, Test loss: 1.041, Test accuracy: 71.01
Round  86, Global train loss: 0.503, Global test loss: 1.201, Global test accuracy: 63.41
Round  87, Train loss: 0.314, Test loss: 1.020, Test accuracy: 71.59
Round  87, Global train loss: 0.314, Global test loss: 1.374, Global test accuracy: 62.14
Round  88, Train loss: 0.370, Test loss: 1.008, Test accuracy: 71.91
Round  88, Global train loss: 0.370, Global test loss: 1.220, Global test accuracy: 64.96
Round  89, Train loss: 0.365, Test loss: 1.007, Test accuracy: 71.85
Round  89, Global train loss: 0.365, Global test loss: 1.343, Global test accuracy: 62.00
Round  90, Train loss: 0.372, Test loss: 1.017, Test accuracy: 71.86
Round  90, Global train loss: 0.372, Global test loss: 1.125, Global test accuracy: 65.89
Round  91, Train loss: 0.380, Test loss: 1.038, Test accuracy: 71.51
Round  91, Global train loss: 0.380, Global test loss: 1.249, Global test accuracy: 63.62
Round  92, Train loss: 0.361, Test loss: 1.053, Test accuracy: 71.23
Round  92, Global train loss: 0.361, Global test loss: 1.237, Global test accuracy: 64.32
Round  93, Train loss: 0.437, Test loss: 1.032, Test accuracy: 71.53
Round  93, Global train loss: 0.437, Global test loss: 1.294, Global test accuracy: 62.70
Round  94, Train loss: 0.348, Test loss: 1.027, Test accuracy: 71.61
Round  94, Global train loss: 0.348, Global test loss: 1.200, Global test accuracy: 65.46
Round  95, Train loss: 0.311, Test loss: 1.035, Test accuracy: 71.72
Round  95, Global train loss: 0.311, Global test loss: 1.363, Global test accuracy: 64.01
Round  96, Train loss: 0.318, Test loss: 1.023, Test accuracy: 71.58
Round  96, Global train loss: 0.318, Global test loss: 1.326, Global test accuracy: 63.37
Round  97, Train loss: 0.432, Test loss: 1.023, Test accuracy: 71.58
Round  97, Global train loss: 0.432, Global test loss: 1.317, Global test accuracy: 62.79
Round  98, Train loss: 0.336, Test loss: 1.039, Test accuracy: 71.50
Round  98, Global train loss: 0.336, Global test loss: 1.374, Global test accuracy: 62.87
Round  99, Train loss: 0.327, Test loss: 1.062, Test accuracy: 71.44
Round  99, Global train loss: 0.327, Global test loss: 1.252, Global test accuracy: 65.12
Final Round, Train loss: 0.290, Test loss: 1.153, Test accuracy: 70.97
Final Round, Global train loss: 0.290, Global test loss: 1.252, Global test accuracy: 65.12
Average accuracy final 10 rounds: 71.55600000000001 

Average global accuracy final 10 rounds: 64.01499999999999 

1267.7725808620453
[1.3971116542816162, 2.7942233085632324, 3.8018059730529785, 4.809388637542725, 5.770117282867432, 6.730845928192139, 7.695900917053223, 8.660955905914307, 9.626329898834229, 10.59170389175415, 11.55905032157898, 12.526396751403809, 13.486003160476685, 14.44560956954956, 15.40262508392334, 16.35964059829712, 17.316884756088257, 18.274128913879395, 19.232982397079468, 20.19183588027954, 21.14829969406128, 22.104763507843018, 23.06784462928772, 24.030925750732422, 24.99717378616333, 25.96342182159424, 26.93037486076355, 27.89732789993286, 28.8563129901886, 29.815298080444336, 30.779104471206665, 31.742910861968994, 32.710299253463745, 33.677687644958496, 34.64314079284668, 35.60859394073486, 36.574299335479736, 37.54000473022461, 38.49846935272217, 39.45693397521973, 40.42143797874451, 41.38594198226929, 42.353193283081055, 43.32044458389282, 44.27823781967163, 45.23603105545044, 46.200698137283325, 47.16536521911621, 48.131242513656616, 49.09711980819702, 50.06334662437439, 51.02957344055176, 51.996089220047, 52.962604999542236, 53.928906202316284, 54.89520740509033, 55.85300922393799, 56.810811042785645, 57.77364921569824, 58.73648738861084, 59.704594135284424, 60.67270088195801, 61.63862466812134, 62.60454845428467, 63.56931209564209, 64.53407573699951, 65.49999594688416, 66.4659161567688, 67.4264144897461, 68.38691282272339, 69.34906053543091, 70.31120824813843, 71.27001190185547, 72.22881555557251, 73.19194555282593, 74.15507555007935, 75.12150955200195, 76.08794355392456, 77.04588294029236, 78.00382232666016, 78.96039819717407, 79.91697406768799, 80.8798098564148, 81.8426456451416, 82.80843472480774, 83.77422380447388, 84.74083948135376, 85.70745515823364, 86.66477108001709, 87.62208700180054, 88.58378720283508, 89.54548740386963, 90.50865435600281, 91.47182130813599, 92.43701004981995, 93.4021987915039, 94.36635637283325, 95.3305139541626, 96.29435634613037, 97.25819873809814, 98.21640944480896, 99.17462015151978, 100.13060545921326, 101.08659076690674, 102.04517793655396, 103.00376510620117, 103.96142792701721, 104.91909074783325, 105.87737464904785, 106.83565855026245, 107.79383111000061, 108.75200366973877, 109.70933723449707, 110.66667079925537, 111.62569260597229, 112.58471441268921, 113.5441837310791, 114.503653049469, 115.46026277542114, 116.41687250137329, 117.3777494430542, 118.33862638473511, 119.30130243301392, 120.26397848129272, 121.2282509803772, 122.19252347946167, 123.1577365398407, 124.12294960021973, 125.08831763267517, 126.05368566513062, 127.01281261444092, 127.97193956375122, 128.92931413650513, 129.88668870925903, 130.84505081176758, 131.80341291427612, 132.7605164051056, 133.71761989593506, 134.6749713420868, 135.63232278823853, 136.58987998962402, 137.54743719100952, 138.50716924667358, 139.46690130233765, 140.43162369728088, 141.39634609222412, 142.35347294807434, 143.31059980392456, 144.26827096939087, 145.22594213485718, 146.1826024055481, 147.139262676239, 148.0992283821106, 149.05919408798218, 150.02411007881165, 150.9890260696411, 151.95020127296448, 152.91137647628784, 153.87781620025635, 154.84425592422485, 155.80947041511536, 156.77468490600586, 157.73730325698853, 158.6999216079712, 159.65676879882812, 160.61361598968506, 161.5745198726654, 162.53542375564575, 163.5003204345703, 164.46521711349487, 165.42895531654358, 166.39269351959229, 167.35087728500366, 168.30906105041504, 169.26810812950134, 170.22715520858765, 171.18454265594482, 172.141930103302, 173.0999710559845, 174.058012008667, 175.01570749282837, 175.97340297698975, 176.9300446510315, 177.88668632507324, 178.847562789917, 179.80843925476074, 180.77245259284973, 181.73646593093872, 182.70034503936768, 183.66422414779663, 184.6217041015625, 185.57918405532837, 186.53858757019043, 187.4979910850525, 188.46034407615662, 189.42269706726074, 190.38671040534973, 191.35072374343872, 192.31382203102112, 193.27692031860352, 195.20206570625305, 197.1272110939026]
[30.06, 30.06, 36.46, 36.46, 40.6, 40.6, 43.89, 43.89, 47.77, 47.77, 51.46, 51.46, 54.98, 54.98, 56.04, 56.04, 57.95, 57.95, 59.29, 59.29, 59.25, 59.25, 60.31, 60.31, 60.22, 60.22, 61.31, 61.31, 62.12, 62.12, 63.06, 63.06, 63.19, 63.19, 63.48, 63.48, 64.28, 64.28, 64.51, 64.51, 64.98, 64.98, 65.26, 65.26, 66.1, 66.1, 66.37, 66.37, 66.08, 66.08, 66.82, 66.82, 66.58, 66.58, 67.75, 67.75, 67.83, 67.83, 68.08, 68.08, 67.59, 67.59, 67.52, 67.52, 67.97, 67.97, 68.72, 68.72, 68.87, 68.87, 68.52, 68.52, 68.74, 68.74, 68.65, 68.65, 68.75, 68.75, 68.56, 68.56, 68.03, 68.03, 68.65, 68.65, 69.18, 69.18, 69.92, 69.92, 69.34, 69.34, 69.97, 69.97, 70.06, 70.06, 69.21, 69.21, 68.9, 68.9, 69.35, 69.35, 69.5, 69.5, 69.67, 69.67, 69.61, 69.61, 69.53, 69.53, 69.43, 69.43, 70.04, 70.04, 70.49, 70.49, 71.03, 71.03, 71.14, 71.14, 70.08, 70.08, 69.97, 69.97, 69.72, 69.72, 69.6, 69.6, 70.47, 70.47, 70.77, 70.77, 70.46, 70.46, 70.44, 70.44, 70.19, 70.19, 70.07, 70.07, 70.57, 70.57, 70.05, 70.05, 70.42, 70.42, 70.58, 70.58, 70.89, 70.89, 71.26, 71.26, 71.17, 71.17, 71.81, 71.81, 71.21, 71.21, 71.52, 71.52, 71.43, 71.43, 71.41, 71.41, 71.68, 71.68, 71.23, 71.23, 70.57, 70.57, 70.35, 70.35, 70.8, 70.8, 71.01, 71.01, 71.59, 71.59, 71.91, 71.91, 71.85, 71.85, 71.86, 71.86, 71.51, 71.51, 71.23, 71.23, 71.53, 71.53, 71.61, 71.61, 71.72, 71.72, 71.58, 71.58, 71.58, 71.58, 71.5, 71.5, 71.44, 71.44, 70.97, 70.97]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.642, Test loss: 2.027, Test accuracy: 28.90
Round   0, Global train loss: 1.642, Global test loss: 2.179, Global test accuracy: 28.08
Round   1, Train loss: 1.452, Test loss: 1.879, Test accuracy: 34.29
Round   1, Global train loss: 1.452, Global test loss: 2.163, Global test accuracy: 29.81
Round   2, Train loss: 1.351, Test loss: 1.687, Test accuracy: 38.51
Round   2, Global train loss: 1.351, Global test loss: 2.133, Global test accuracy: 29.18
Round   3, Train loss: 1.328, Test loss: 1.497, Test accuracy: 42.14
Round   3, Global train loss: 1.328, Global test loss: 2.083, Global test accuracy: 31.24
Round   4, Train loss: 1.268, Test loss: 1.354, Test accuracy: 46.45
Round   4, Global train loss: 1.268, Global test loss: 1.835, Global test accuracy: 35.48
Round   5, Train loss: 1.346, Test loss: 1.282, Test accuracy: 49.52
Round   5, Global train loss: 1.346, Global test loss: 1.664, Global test accuracy: 41.19
Round   6, Train loss: 1.267, Test loss: 1.209, Test accuracy: 52.79
Round   6, Global train loss: 1.267, Global test loss: 1.730, Global test accuracy: 37.88
Round   7, Train loss: 1.234, Test loss: 1.161, Test accuracy: 54.50
Round   7, Global train loss: 1.234, Global test loss: 1.638, Global test accuracy: 44.44
Round   8, Train loss: 1.149, Test loss: 1.132, Test accuracy: 56.91
Round   8, Global train loss: 1.149, Global test loss: 1.558, Global test accuracy: 43.71
Round   9, Train loss: 1.022, Test loss: 1.099, Test accuracy: 58.18
Round   9, Global train loss: 1.022, Global test loss: 1.734, Global test accuracy: 45.42
Round  10, Train loss: 1.057, Test loss: 1.080, Test accuracy: 59.27
Round  10, Global train loss: 1.057, Global test loss: 1.685, Global test accuracy: 47.66
Round  11, Train loss: 1.049, Test loss: 1.083, Test accuracy: 59.59
Round  11, Global train loss: 1.049, Global test loss: 1.476, Global test accuracy: 49.32
Round  12, Train loss: 1.051, Test loss: 1.063, Test accuracy: 60.63
Round  12, Global train loss: 1.051, Global test loss: 1.593, Global test accuracy: 48.21
Round  13, Train loss: 0.938, Test loss: 1.042, Test accuracy: 61.34
Round  13, Global train loss: 0.938, Global test loss: 1.477, Global test accuracy: 49.17
Round  14, Train loss: 1.115, Test loss: 1.035, Test accuracy: 60.96
Round  14, Global train loss: 1.115, Global test loss: 1.559, Global test accuracy: 44.76
Round  15, Train loss: 1.070, Test loss: 1.019, Test accuracy: 61.75
Round  15, Global train loss: 1.070, Global test loss: 1.468, Global test accuracy: 49.47
Round  16, Train loss: 0.982, Test loss: 0.998, Test accuracy: 62.37
Round  16, Global train loss: 0.982, Global test loss: 1.365, Global test accuracy: 51.56
Round  17, Train loss: 1.096, Test loss: 0.973, Test accuracy: 63.29
Round  17, Global train loss: 1.096, Global test loss: 1.404, Global test accuracy: 51.31
Round  18, Train loss: 0.961, Test loss: 0.956, Test accuracy: 63.88
Round  18, Global train loss: 0.961, Global test loss: 1.464, Global test accuracy: 53.00
Round  19, Train loss: 1.022, Test loss: 0.937, Test accuracy: 64.76
Round  19, Global train loss: 1.022, Global test loss: 1.427, Global test accuracy: 51.98
Round  20, Train loss: 0.963, Test loss: 0.929, Test accuracy: 65.23
Round  20, Global train loss: 0.963, Global test loss: 1.427, Global test accuracy: 52.93
Round  21, Train loss: 1.045, Test loss: 0.914, Test accuracy: 65.95
Round  21, Global train loss: 1.045, Global test loss: 1.359, Global test accuracy: 54.87
Round  22, Train loss: 0.813, Test loss: 0.903, Test accuracy: 67.00
Round  22, Global train loss: 0.813, Global test loss: 1.443, Global test accuracy: 52.89
Round  23, Train loss: 0.866, Test loss: 0.905, Test accuracy: 66.64
Round  23, Global train loss: 0.866, Global test loss: 1.338, Global test accuracy: 55.53
Round  24, Train loss: 0.731, Test loss: 0.919, Test accuracy: 66.24
Round  24, Global train loss: 0.731, Global test loss: 1.536, Global test accuracy: 56.83
Round  25, Train loss: 0.810, Test loss: 0.910, Test accuracy: 66.44
Round  25, Global train loss: 0.810, Global test loss: 1.370, Global test accuracy: 53.61
Round  26, Train loss: 0.877, Test loss: 0.884, Test accuracy: 67.53
Round  26, Global train loss: 0.877, Global test loss: 1.266, Global test accuracy: 57.29
Round  27, Train loss: 0.763, Test loss: 0.866, Test accuracy: 68.40
Round  27, Global train loss: 0.763, Global test loss: 1.326, Global test accuracy: 54.89
Round  28, Train loss: 0.872, Test loss: 0.864, Test accuracy: 68.64
Round  28, Global train loss: 0.872, Global test loss: 1.183, Global test accuracy: 59.41
Round  29, Train loss: 0.692, Test loss: 0.866, Test accuracy: 68.59
Round  29, Global train loss: 0.692, Global test loss: 1.227, Global test accuracy: 59.31
Round  30, Train loss: 0.818, Test loss: 0.880, Test accuracy: 68.18
Round  30, Global train loss: 0.818, Global test loss: 1.341, Global test accuracy: 57.70
Round  31, Train loss: 0.889, Test loss: 0.884, Test accuracy: 68.00
Round  31, Global train loss: 0.889, Global test loss: 1.247, Global test accuracy: 57.06
Round  32, Train loss: 0.775, Test loss: 0.868, Test accuracy: 68.67
Round  32, Global train loss: 0.775, Global test loss: 1.244, Global test accuracy: 57.46
Round  33, Train loss: 0.807, Test loss: 0.866, Test accuracy: 68.74
Round  33, Global train loss: 0.807, Global test loss: 1.246, Global test accuracy: 59.22
Round  34, Train loss: 0.786, Test loss: 0.859, Test accuracy: 68.86
Round  34, Global train loss: 0.786, Global test loss: 1.141, Global test accuracy: 61.47
Round  35, Train loss: 0.764, Test loss: 0.847, Test accuracy: 69.61
Round  35, Global train loss: 0.764, Global test loss: 1.202, Global test accuracy: 59.46
Round  36, Train loss: 0.695, Test loss: 0.842, Test accuracy: 69.88
Round  36, Global train loss: 0.695, Global test loss: 1.181, Global test accuracy: 61.54
Round  37, Train loss: 0.702, Test loss: 0.866, Test accuracy: 69.33
Round  37, Global train loss: 0.702, Global test loss: 1.292, Global test accuracy: 58.40
Round  38, Train loss: 0.826, Test loss: 0.865, Test accuracy: 69.46
Round  38, Global train loss: 0.826, Global test loss: 1.251, Global test accuracy: 59.34
Round  39, Train loss: 0.732, Test loss: 0.861, Test accuracy: 69.89
Round  39, Global train loss: 0.732, Global test loss: 1.210, Global test accuracy: 60.31
Round  40, Train loss: 0.717, Test loss: 0.842, Test accuracy: 70.52
Round  40, Global train loss: 0.717, Global test loss: 1.315, Global test accuracy: 58.53
Round  41, Train loss: 0.707, Test loss: 0.851, Test accuracy: 70.34
Round  41, Global train loss: 0.707, Global test loss: 1.255, Global test accuracy: 59.44
Round  42, Train loss: 0.564, Test loss: 0.848, Test accuracy: 70.36
Round  42, Global train loss: 0.564, Global test loss: 1.443, Global test accuracy: 58.32
Round  43, Train loss: 0.729, Test loss: 0.847, Test accuracy: 70.91
Round  43, Global train loss: 0.729, Global test loss: 1.182, Global test accuracy: 60.15
Round  44, Train loss: 0.739, Test loss: 0.825, Test accuracy: 71.44
Round  44, Global train loss: 0.739, Global test loss: 1.192, Global test accuracy: 60.86
Round  45, Train loss: 0.756, Test loss: 0.835, Test accuracy: 71.35
Round  45, Global train loss: 0.756, Global test loss: 1.107, Global test accuracy: 62.57
Round  46, Train loss: 0.629, Test loss: 0.840, Test accuracy: 71.29
Round  46, Global train loss: 0.629, Global test loss: 1.162, Global test accuracy: 61.55
Round  47, Train loss: 0.686, Test loss: 0.837, Test accuracy: 71.33
Round  47, Global train loss: 0.686, Global test loss: 1.116, Global test accuracy: 62.67
Round  48, Train loss: 0.592, Test loss: 0.846, Test accuracy: 71.28
Round  48, Global train loss: 0.592, Global test loss: 1.194, Global test accuracy: 60.94
Round  49, Train loss: 0.621, Test loss: 0.844, Test accuracy: 71.37
Round  49, Global train loss: 0.621, Global test loss: 1.162, Global test accuracy: 61.84
Round  50, Train loss: 0.681, Test loss: 0.842, Test accuracy: 71.27
Round  50, Global train loss: 0.681, Global test loss: 1.147, Global test accuracy: 63.16
Round  51, Train loss: 0.495, Test loss: 0.833, Test accuracy: 71.46
Round  51, Global train loss: 0.495, Global test loss: 1.424, Global test accuracy: 61.26
Round  52, Train loss: 0.537, Test loss: 0.840, Test accuracy: 71.26
Round  52, Global train loss: 0.537, Global test loss: 1.264, Global test accuracy: 61.59
Round  53, Train loss: 0.625, Test loss: 0.824, Test accuracy: 71.91
Round  53, Global train loss: 0.625, Global test loss: 1.206, Global test accuracy: 61.75
Round  54, Train loss: 0.681, Test loss: 0.836, Test accuracy: 71.41
Round  54, Global train loss: 0.681, Global test loss: 1.128, Global test accuracy: 63.80
Round  55, Train loss: 0.505, Test loss: 0.822, Test accuracy: 71.95
Round  55, Global train loss: 0.505, Global test loss: 1.286, Global test accuracy: 61.61
Round  56, Train loss: 0.522, Test loss: 0.805, Test accuracy: 72.65
Round  56, Global train loss: 0.522, Global test loss: 1.330, Global test accuracy: 61.63
Round  57, Train loss: 0.674, Test loss: 0.825, Test accuracy: 72.20
Round  57, Global train loss: 0.674, Global test loss: 1.118, Global test accuracy: 63.78
Round  58, Train loss: 0.542, Test loss: 0.826, Test accuracy: 72.34
Round  58, Global train loss: 0.542, Global test loss: 1.130, Global test accuracy: 63.80
Round  59, Train loss: 0.584, Test loss: 0.856, Test accuracy: 71.32
Round  59, Global train loss: 0.584, Global test loss: 1.141, Global test accuracy: 64.23
Round  60, Train loss: 0.532, Test loss: 0.851, Test accuracy: 71.46
Round  60, Global train loss: 0.532, Global test loss: 1.087, Global test accuracy: 64.73
Round  61, Train loss: 0.389, Test loss: 0.859, Test accuracy: 71.59
Round  61, Global train loss: 0.389, Global test loss: 1.581, Global test accuracy: 58.86
Round  62, Train loss: 0.507, Test loss: 0.876, Test accuracy: 70.87
Round  62, Global train loss: 0.507, Global test loss: 1.313, Global test accuracy: 61.73
Round  63, Train loss: 0.513, Test loss: 0.879, Test accuracy: 71.28
Round  63, Global train loss: 0.513, Global test loss: 1.221, Global test accuracy: 63.43
Round  64, Train loss: 0.553, Test loss: 0.857, Test accuracy: 71.78
Round  64, Global train loss: 0.553, Global test loss: 1.027, Global test accuracy: 66.65
Round  65, Train loss: 0.563, Test loss: 0.855, Test accuracy: 71.81
Round  65, Global train loss: 0.563, Global test loss: 1.323, Global test accuracy: 61.27
Round  66, Train loss: 0.514, Test loss: 0.881, Test accuracy: 71.14
Round  66, Global train loss: 0.514, Global test loss: 1.118, Global test accuracy: 64.17
Round  67, Train loss: 0.636, Test loss: 0.904, Test accuracy: 71.20
Round  67, Global train loss: 0.636, Global test loss: 1.272, Global test accuracy: 61.46
Round  68, Train loss: 0.577, Test loss: 0.896, Test accuracy: 71.33
Round  68, Global train loss: 0.577, Global test loss: 1.283, Global test accuracy: 61.99
Round  69, Train loss: 0.596, Test loss: 0.900, Test accuracy: 71.88
Round  69, Global train loss: 0.596, Global test loss: 1.170, Global test accuracy: 63.71
Round  70, Train loss: 0.517, Test loss: 0.902, Test accuracy: 71.68
Round  70, Global train loss: 0.517, Global test loss: 1.178, Global test accuracy: 63.37
Round  71, Train loss: 0.536, Test loss: 0.863, Test accuracy: 72.85
Round  71, Global train loss: 0.536, Global test loss: 1.179, Global test accuracy: 62.36
Round  72, Train loss: 0.413, Test loss: 0.859, Test accuracy: 72.93
Round  72, Global train loss: 0.413, Global test loss: 1.087, Global test accuracy: 66.67
Round  73, Train loss: 0.411, Test loss: 0.873, Test accuracy: 72.78
Round  73, Global train loss: 0.411, Global test loss: 1.138, Global test accuracy: 65.47
Round  74, Train loss: 0.446, Test loss: 0.872, Test accuracy: 72.57
Round  74, Global train loss: 0.446, Global test loss: 1.168, Global test accuracy: 63.98
Round  75, Train loss: 0.573, Test loss: 0.879, Test accuracy: 72.40
Round  75, Global train loss: 0.573, Global test loss: 1.198, Global test accuracy: 62.81
Round  76, Train loss: 0.395, Test loss: 0.886, Test accuracy: 72.36
Round  76, Global train loss: 0.395, Global test loss: 1.323, Global test accuracy: 62.48
Round  77, Train loss: 0.457, Test loss: 0.881, Test accuracy: 72.54
Round  77, Global train loss: 0.457, Global test loss: 1.361, Global test accuracy: 62.45
Round  78, Train loss: 0.472, Test loss: 0.869, Test accuracy: 73.00
Round  78, Global train loss: 0.472, Global test loss: 1.254, Global test accuracy: 63.14
Round  79, Train loss: 0.515, Test loss: 0.895, Test accuracy: 72.08
Round  79, Global train loss: 0.515, Global test loss: 1.258, Global test accuracy: 62.51
Round  80, Train loss: 0.366, Test loss: 0.891, Test accuracy: 71.90
Round  80, Global train loss: 0.366, Global test loss: 1.484, Global test accuracy: 60.59
Round  81, Train loss: 0.459, Test loss: 0.885, Test accuracy: 72.14
Round  81, Global train loss: 0.459, Global test loss: 1.251, Global test accuracy: 63.95
Round  82, Train loss: 0.415, Test loss: 0.888, Test accuracy: 72.31
Round  82, Global train loss: 0.415, Global test loss: 1.345, Global test accuracy: 61.92
Round  83, Train loss: 0.418, Test loss: 0.928, Test accuracy: 71.83
Round  83, Global train loss: 0.418, Global test loss: 1.232, Global test accuracy: 64.08
Round  84, Train loss: 0.629, Test loss: 0.920, Test accuracy: 72.22
Round  84, Global train loss: 0.629, Global test loss: 1.192, Global test accuracy: 62.73
Round  85, Train loss: 0.337, Test loss: 0.904, Test accuracy: 72.51
Round  85, Global train loss: 0.337, Global test loss: 1.243, Global test accuracy: 65.13
Round  86, Train loss: 0.570, Test loss: 0.930, Test accuracy: 72.56
Round  86, Global train loss: 0.570, Global test loss: 1.128, Global test accuracy: 64.14
Round  87, Train loss: 0.419, Test loss: 0.907, Test accuracy: 72.60
Round  87, Global train loss: 0.419, Global test loss: 1.281, Global test accuracy: 63.05
Round  88, Train loss: 0.422, Test loss: 0.908, Test accuracy: 72.37
Round  88, Global train loss: 0.422, Global test loss: 1.217, Global test accuracy: 64.75
Round  89, Train loss: 0.379, Test loss: 0.932, Test accuracy: 71.99
Round  89, Global train loss: 0.379, Global test loss: 1.218, Global test accuracy: 65.40
Round  90, Train loss: 0.502, Test loss: 0.961, Test accuracy: 71.79
Round  90, Global train loss: 0.502, Global test loss: 1.158, Global test accuracy: 65.37
Round  91, Train loss: 0.542, Test loss: 0.945, Test accuracy: 72.23
Round  91, Global train loss: 0.542, Global test loss: 1.235, Global test accuracy: 63.97
Round  92, Train loss: 0.452, Test loss: 0.972, Test accuracy: 71.71
Round  92, Global train loss: 0.452, Global test loss: 1.205, Global test accuracy: 64.25/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  93, Train loss: 0.433, Test loss: 0.949, Test accuracy: 72.26
Round  93, Global train loss: 0.433, Global test loss: 1.203, Global test accuracy: 64.41
Round  94, Train loss: 0.384, Test loss: 0.923, Test accuracy: 72.95
Round  94, Global train loss: 0.384, Global test loss: 1.174, Global test accuracy: 65.64
Round  95, Train loss: 0.353, Test loss: 0.917, Test accuracy: 72.77
Round  95, Global train loss: 0.353, Global test loss: 1.258, Global test accuracy: 65.07
Round  96, Train loss: 0.352, Test loss: 0.903, Test accuracy: 73.22
Round  96, Global train loss: 0.352, Global test loss: 1.213, Global test accuracy: 65.76
Round  97, Train loss: 0.446, Test loss: 0.928, Test accuracy: 73.08
Round  97, Global train loss: 0.446, Global test loss: 1.244, Global test accuracy: 64.17
Round  98, Train loss: 0.418, Test loss: 0.939, Test accuracy: 73.11
Round  98, Global train loss: 0.418, Global test loss: 1.288, Global test accuracy: 63.81
Round  99, Train loss: 0.416, Test loss: 0.946, Test accuracy: 72.95
Round  99, Global train loss: 0.416, Global test loss: 1.314, Global test accuracy: 63.05
Final Round, Train loss: 0.342, Test loss: 1.023, Test accuracy: 71.76
Final Round, Global train loss: 0.342, Global test loss: 1.314, Global test accuracy: 63.05
Average accuracy final 10 rounds: 72.60700000000001 

Average global accuracy final 10 rounds: 64.55000000000001 

1366.011165857315
[1.4648816585540771, 2.9297633171081543, 4.1305248737335205, 5.331286430358887, 6.500072240829468, 7.668858051300049, 8.817543506622314, 9.96622896194458, 11.106121301651001, 12.246013641357422, 13.384741306304932, 14.523468971252441, 15.718945980072021, 16.9144229888916, 18.113967418670654, 19.313511848449707, 20.512333154678345, 21.711154460906982, 22.9120671749115, 24.112979888916016, 25.303754091262817, 26.49452829360962, 27.685797691345215, 28.87706708908081, 30.056861877441406, 31.236656665802002, 32.41922116279602, 33.60178565979004, 34.79300141334534, 35.984217166900635, 37.17955207824707, 38.374886989593506, 39.56975531578064, 40.76462364196777, 41.96228384971619, 43.1599440574646, 44.35261130332947, 45.545278549194336, 46.72857856750488, 47.91187858581543, 49.11301779747009, 50.314157009124756, 51.52272415161133, 52.7312912940979, 53.92953848838806, 55.12778568267822, 56.32336664199829, 57.51894760131836, 58.713359117507935, 59.90777063369751, 61.10923457145691, 62.31069850921631, 63.50107026100159, 64.69144201278687, 65.88766670227051, 67.08389139175415, 68.27473211288452, 69.46557283401489, 70.6485424041748, 71.83151197433472, 73.02213406562805, 74.21275615692139, 75.40934896469116, 76.60594177246094, 77.79740142822266, 78.98886108398438, 80.18570590019226, 81.38255071640015, 82.5734338760376, 83.76431703567505, 84.948566198349, 86.13281536102295, 87.32450795173645, 88.51620054244995, 89.71627998352051, 90.91635942459106, 92.10827684402466, 93.30019426345825, 94.49803066253662, 95.69586706161499, 96.88131070137024, 98.06675434112549, 99.25247716903687, 100.43819999694824, 101.63245415687561, 102.82670831680298, 104.02656173706055, 105.22641515731812, 106.42461848258972, 107.62282180786133, 108.81967520713806, 110.0165286064148, 111.211181640625, 112.4058346748352, 113.60419487953186, 114.80255508422852, 116.00148177146912, 117.20040845870972, 118.39267253875732, 119.58493661880493, 120.77921080589294, 121.97348499298096, 123.17424511909485, 124.37500524520874, 125.56510257720947, 126.7551999092102, 127.93865776062012, 129.12211561203003, 130.30625772476196, 131.4903998374939, 132.67536997795105, 133.8603401184082, 135.05865240097046, 136.25696468353271, 137.45147371292114, 138.64598274230957, 139.84108710289001, 141.03619146347046, 142.11052227020264, 143.18485307693481, 144.21771907806396, 145.25058507919312, 146.28214740753174, 147.31370973587036, 148.34665870666504, 149.37960767745972, 150.4175443649292, 151.45548105239868, 152.4913785457611, 153.52727603912354, 154.5591630935669, 155.59105014801025, 156.62281847000122, 157.6545867919922, 158.68532586097717, 159.71606492996216, 160.7464485168457, 161.77683210372925, 162.80842757225037, 163.84002304077148, 164.8717679977417, 165.9035129547119, 166.93826603889465, 167.9730191230774, 169.01013708114624, 170.0472550392151, 171.0820083618164, 172.11676168441772, 173.1516091823578, 174.18645668029785, 175.2200689315796, 176.25368118286133, 177.289404630661, 178.3251280784607, 179.36151313781738, 180.39789819717407, 181.43371605873108, 182.4695339202881, 183.5057783126831, 184.54202270507812, 185.57727551460266, 186.6125283241272, 187.6480770111084, 188.6836256980896, 189.71796298027039, 190.75230026245117, 191.78378200531006, 192.81526374816895, 193.8489806652069, 194.88269758224487, 195.91369223594666, 196.94468688964844, 197.9785861968994, 199.0124855041504, 200.04949593544006, 201.08650636672974, 202.1222174167633, 203.15792846679688, 204.19021010398865, 205.22249174118042, 206.25554037094116, 207.2885890007019, 208.32119488716125, 209.3538007736206, 210.38955736160278, 211.42531394958496, 212.45503997802734, 213.48476600646973, 214.51453733444214, 215.54430866241455, 216.58023500442505, 217.61616134643555, 218.65347170829773, 219.6907820701599, 220.72258281707764, 221.75438356399536, 222.78528785705566, 223.81619215011597, 224.8458924293518, 225.87559270858765, 227.941575050354, 230.00755739212036]
[28.9, 28.9, 34.29, 34.29, 38.51, 38.51, 42.14, 42.14, 46.45, 46.45, 49.52, 49.52, 52.79, 52.79, 54.5, 54.5, 56.91, 56.91, 58.18, 58.18, 59.27, 59.27, 59.59, 59.59, 60.63, 60.63, 61.34, 61.34, 60.96, 60.96, 61.75, 61.75, 62.37, 62.37, 63.29, 63.29, 63.88, 63.88, 64.76, 64.76, 65.23, 65.23, 65.95, 65.95, 67.0, 67.0, 66.64, 66.64, 66.24, 66.24, 66.44, 66.44, 67.53, 67.53, 68.4, 68.4, 68.64, 68.64, 68.59, 68.59, 68.18, 68.18, 68.0, 68.0, 68.67, 68.67, 68.74, 68.74, 68.86, 68.86, 69.61, 69.61, 69.88, 69.88, 69.33, 69.33, 69.46, 69.46, 69.89, 69.89, 70.52, 70.52, 70.34, 70.34, 70.36, 70.36, 70.91, 70.91, 71.44, 71.44, 71.35, 71.35, 71.29, 71.29, 71.33, 71.33, 71.28, 71.28, 71.37, 71.37, 71.27, 71.27, 71.46, 71.46, 71.26, 71.26, 71.91, 71.91, 71.41, 71.41, 71.95, 71.95, 72.65, 72.65, 72.2, 72.2, 72.34, 72.34, 71.32, 71.32, 71.46, 71.46, 71.59, 71.59, 70.87, 70.87, 71.28, 71.28, 71.78, 71.78, 71.81, 71.81, 71.14, 71.14, 71.2, 71.2, 71.33, 71.33, 71.88, 71.88, 71.68, 71.68, 72.85, 72.85, 72.93, 72.93, 72.78, 72.78, 72.57, 72.57, 72.4, 72.4, 72.36, 72.36, 72.54, 72.54, 73.0, 73.0, 72.08, 72.08, 71.9, 71.9, 72.14, 72.14, 72.31, 72.31, 71.83, 71.83, 72.22, 72.22, 72.51, 72.51, 72.56, 72.56, 72.6, 72.6, 72.37, 72.37, 71.99, 71.99, 71.79, 71.79, 72.23, 72.23, 71.71, 71.71, 72.26, 72.26, 72.95, 72.95, 72.77, 72.77, 73.22, 73.22, 73.08, 73.08, 73.11, 73.11, 72.95, 72.95, 71.76, 71.76]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.559, Test loss: 2.107, Test accuracy: 27.77
Round   0, Global train loss: 1.559, Global test loss: 2.276, Global test accuracy: 25.90
Round   1, Train loss: 1.422, Test loss: 1.884, Test accuracy: 33.53
Round   1, Global train loss: 1.422, Global test loss: 2.112, Global test accuracy: 29.80
Round   2, Train loss: 1.354, Test loss: 1.681, Test accuracy: 38.64
Round   2, Global train loss: 1.354, Global test loss: 2.144, Global test accuracy: 29.40
Round   3, Train loss: 1.312, Test loss: 1.499, Test accuracy: 42.22
Round   3, Global train loss: 1.312, Global test loss: 2.107, Global test accuracy: 32.31
Round   4, Train loss: 1.191, Test loss: 1.349, Test accuracy: 46.14
Round   4, Global train loss: 1.191, Global test loss: 1.827, Global test accuracy: 35.30
Round   5, Train loss: 1.266, Test loss: 1.267, Test accuracy: 49.23
Round   5, Global train loss: 1.266, Global test loss: 1.646, Global test accuracy: 41.99
Round   6, Train loss: 1.186, Test loss: 1.210, Test accuracy: 52.93
Round   6, Global train loss: 1.186, Global test loss: 1.771, Global test accuracy: 38.65
Round   7, Train loss: 1.146, Test loss: 1.169, Test accuracy: 54.66
Round   7, Global train loss: 1.146, Global test loss: 1.672, Global test accuracy: 42.68
Round   8, Train loss: 1.135, Test loss: 1.147, Test accuracy: 56.17
Round   8, Global train loss: 1.135, Global test loss: 1.480, Global test accuracy: 48.68
Round   9, Train loss: 1.027, Test loss: 1.105, Test accuracy: 57.67
Round   9, Global train loss: 1.027, Global test loss: 1.729, Global test accuracy: 47.27
Round  10, Train loss: 0.973, Test loss: 1.102, Test accuracy: 58.03
Round  10, Global train loss: 0.973, Global test loss: 1.790, Global test accuracy: 48.01
Round  11, Train loss: 0.992, Test loss: 1.069, Test accuracy: 59.74
Round  11, Global train loss: 0.992, Global test loss: 1.408, Global test accuracy: 52.25
Round  12, Train loss: 0.896, Test loss: 1.043, Test accuracy: 60.72
Round  12, Global train loss: 0.896, Global test loss: 1.623, Global test accuracy: 48.17
Round  13, Train loss: 0.914, Test loss: 1.046, Test accuracy: 60.94
Round  13, Global train loss: 0.914, Global test loss: 1.481, Global test accuracy: 49.85
Round  14, Train loss: 0.993, Test loss: 1.011, Test accuracy: 62.65
Round  14, Global train loss: 0.993, Global test loss: 1.498, Global test accuracy: 48.53
Round  15, Train loss: 0.984, Test loss: 1.000, Test accuracy: 62.83
Round  15, Global train loss: 0.984, Global test loss: 1.442, Global test accuracy: 51.25
Round  16, Train loss: 0.932, Test loss: 1.007, Test accuracy: 63.16
Round  16, Global train loss: 0.932, Global test loss: 1.374, Global test accuracy: 52.40
Round  17, Train loss: 1.057, Test loss: 0.986, Test accuracy: 64.01
Round  17, Global train loss: 1.057, Global test loss: 1.315, Global test accuracy: 54.78
Round  18, Train loss: 0.875, Test loss: 0.980, Test accuracy: 63.94
Round  18, Global train loss: 0.875, Global test loss: 1.510, Global test accuracy: 52.97
Round  19, Train loss: 0.932, Test loss: 0.977, Test accuracy: 64.17
Round  19, Global train loss: 0.932, Global test loss: 1.375, Global test accuracy: 53.73
Round  20, Train loss: 0.883, Test loss: 0.976, Test accuracy: 64.28
Round  20, Global train loss: 0.883, Global test loss: 1.459, Global test accuracy: 53.21
Round  21, Train loss: 0.868, Test loss: 0.979, Test accuracy: 64.88
Round  21, Global train loss: 0.868, Global test loss: 1.271, Global test accuracy: 56.92
Round  22, Train loss: 0.745, Test loss: 0.963, Test accuracy: 65.51
Round  22, Global train loss: 0.745, Global test loss: 1.551, Global test accuracy: 51.67
Round  23, Train loss: 0.735, Test loss: 0.964, Test accuracy: 65.78
Round  23, Global train loss: 0.735, Global test loss: 1.252, Global test accuracy: 59.09
Round  24, Train loss: 0.650, Test loss: 0.949, Test accuracy: 66.04
Round  24, Global train loss: 0.650, Global test loss: 1.664, Global test accuracy: 54.70
Round  25, Train loss: 0.766, Test loss: 0.942, Test accuracy: 66.78
Round  25, Global train loss: 0.766, Global test loss: 1.362, Global test accuracy: 55.18
Round  26, Train loss: 0.776, Test loss: 0.922, Test accuracy: 67.29
Round  26, Global train loss: 0.776, Global test loss: 1.311, Global test accuracy: 56.98
Round  27, Train loss: 0.706, Test loss: 0.898, Test accuracy: 67.98
Round  27, Global train loss: 0.706, Global test loss: 1.315, Global test accuracy: 56.74
Round  28, Train loss: 0.842, Test loss: 0.895, Test accuracy: 67.74
Round  28, Global train loss: 0.842, Global test loss: 1.197, Global test accuracy: 59.12
Round  29, Train loss: 0.753, Test loss: 0.907, Test accuracy: 67.58
Round  29, Global train loss: 0.753, Global test loss: 1.312, Global test accuracy: 58.09
Round  30, Train loss: 0.887, Test loss: 0.915, Test accuracy: 67.65
Round  30, Global train loss: 0.887, Global test loss: 1.240, Global test accuracy: 58.46
Round  31, Train loss: 0.682, Test loss: 0.935, Test accuracy: 67.27
Round  31, Global train loss: 0.682, Global test loss: 1.358, Global test accuracy: 56.06
Round  32, Train loss: 0.708, Test loss: 0.914, Test accuracy: 68.19
Round  32, Global train loss: 0.708, Global test loss: 1.299, Global test accuracy: 56.81
Round  33, Train loss: 0.767, Test loss: 0.894, Test accuracy: 68.99
Round  33, Global train loss: 0.767, Global test loss: 1.284, Global test accuracy: 58.11
Round  34, Train loss: 0.695, Test loss: 0.897, Test accuracy: 68.87
Round  34, Global train loss: 0.695, Global test loss: 1.201, Global test accuracy: 60.61
Round  35, Train loss: 0.726, Test loss: 0.905, Test accuracy: 68.68
Round  35, Global train loss: 0.726, Global test loss: 1.235, Global test accuracy: 59.41
Round  36, Train loss: 0.613, Test loss: 0.913, Test accuracy: 68.23
Round  36, Global train loss: 0.613, Global test loss: 1.214, Global test accuracy: 60.95
Round  37, Train loss: 0.712, Test loss: 0.910, Test accuracy: 68.42
Round  37, Global train loss: 0.712, Global test loss: 1.220, Global test accuracy: 59.14
Round  38, Train loss: 0.770, Test loss: 0.917, Test accuracy: 68.29
Round  38, Global train loss: 0.770, Global test loss: 1.286, Global test accuracy: 58.49
Round  39, Train loss: 0.641, Test loss: 0.907, Test accuracy: 68.38
Round  39, Global train loss: 0.641, Global test loss: 1.277, Global test accuracy: 58.47
Round  40, Train loss: 0.592, Test loss: 0.926, Test accuracy: 68.35
Round  40, Global train loss: 0.592, Global test loss: 1.234, Global test accuracy: 60.35
Round  41, Train loss: 0.573, Test loss: 0.913, Test accuracy: 68.75
Round  41, Global train loss: 0.573, Global test loss: 1.355, Global test accuracy: 59.56
Round  42, Train loss: 0.575, Test loss: 0.894, Test accuracy: 69.15
Round  42, Global train loss: 0.575, Global test loss: 1.433, Global test accuracy: 57.89
Round  43, Train loss: 0.567, Test loss: 0.897, Test accuracy: 69.30
Round  43, Global train loss: 0.567, Global test loss: 1.148, Global test accuracy: 62.32
Round  44, Train loss: 0.669, Test loss: 0.917, Test accuracy: 69.14
Round  44, Global train loss: 0.669, Global test loss: 1.171, Global test accuracy: 61.78
Round  45, Train loss: 0.673, Test loss: 0.906, Test accuracy: 69.57
Round  45, Global train loss: 0.673, Global test loss: 1.176, Global test accuracy: 62.00
Round  46, Train loss: 0.545, Test loss: 0.919, Test accuracy: 69.68
Round  46, Global train loss: 0.545, Global test loss: 1.242, Global test accuracy: 60.83
Round  47, Train loss: 0.600, Test loss: 0.941, Test accuracy: 69.36
Round  47, Global train loss: 0.600, Global test loss: 1.170, Global test accuracy: 62.03
Round  48, Train loss: 0.557, Test loss: 0.953, Test accuracy: 69.35
Round  48, Global train loss: 0.557, Global test loss: 1.236, Global test accuracy: 60.68
Round  49, Train loss: 0.610, Test loss: 0.953, Test accuracy: 69.36
Round  49, Global train loss: 0.610, Global test loss: 1.158, Global test accuracy: 61.94
Round  50, Train loss: 0.597, Test loss: 0.970, Test accuracy: 68.97
Round  50, Global train loss: 0.597, Global test loss: 1.212, Global test accuracy: 61.38
Round  51, Train loss: 0.439, Test loss: 0.954, Test accuracy: 69.56
Round  51, Global train loss: 0.439, Global test loss: 1.527, Global test accuracy: 59.33
Round  52, Train loss: 0.529, Test loss: 0.947, Test accuracy: 69.92
Round  52, Global train loss: 0.529, Global test loss: 1.460, Global test accuracy: 59.19
Round  53, Train loss: 0.558, Test loss: 0.955, Test accuracy: 69.70
Round  53, Global train loss: 0.558, Global test loss: 1.407, Global test accuracy: 58.47
Round  54, Train loss: 0.499, Test loss: 0.962, Test accuracy: 69.61
Round  54, Global train loss: 0.499, Global test loss: 1.199, Global test accuracy: 62.13
Round  55, Train loss: 0.415, Test loss: 0.949, Test accuracy: 69.54
Round  55, Global train loss: 0.415, Global test loss: 1.435, Global test accuracy: 60.43
Round  56, Train loss: 0.482, Test loss: 0.936, Test accuracy: 70.38
Round  56, Global train loss: 0.482, Global test loss: 1.356, Global test accuracy: 60.88
Round  57, Train loss: 0.685, Test loss: 0.901, Test accuracy: 71.23
Round  57, Global train loss: 0.685, Global test loss: 1.210, Global test accuracy: 60.83
Round  58, Train loss: 0.485, Test loss: 0.914, Test accuracy: 71.00
Round  58, Global train loss: 0.485, Global test loss: 1.225, Global test accuracy: 62.00
Round  59, Train loss: 0.535, Test loss: 0.930, Test accuracy: 70.55
Round  59, Global train loss: 0.535, Global test loss: 1.139, Global test accuracy: 63.87
Round  60, Train loss: 0.492, Test loss: 0.946, Test accuracy: 70.09
Round  60, Global train loss: 0.492, Global test loss: 1.128, Global test accuracy: 62.93
Round  61, Train loss: 0.379, Test loss: 0.967, Test accuracy: 69.62
Round  61, Global train loss: 0.379, Global test loss: 1.551, Global test accuracy: 58.95
Round  62, Train loss: 0.376, Test loss: 0.940, Test accuracy: 70.33
Round  62, Global train loss: 0.376, Global test loss: 1.365, Global test accuracy: 61.58
Round  63, Train loss: 0.537, Test loss: 0.928, Test accuracy: 70.58
Round  63, Global train loss: 0.537, Global test loss: 1.252, Global test accuracy: 62.30
Round  64, Train loss: 0.637, Test loss: 0.916, Test accuracy: 71.12
Round  64, Global train loss: 0.637, Global test loss: 1.131, Global test accuracy: 63.60
Round  65, Train loss: 0.546, Test loss: 0.920, Test accuracy: 70.93
Round  65, Global train loss: 0.546, Global test loss: 1.347, Global test accuracy: 60.07
Round  66, Train loss: 0.446, Test loss: 0.916, Test accuracy: 70.96
Round  66, Global train loss: 0.446, Global test loss: 1.112, Global test accuracy: 65.09
Round  67, Train loss: 0.516, Test loss: 0.908, Test accuracy: 71.16
Round  67, Global train loss: 0.516, Global test loss: 1.265, Global test accuracy: 61.49
Round  68, Train loss: 0.528, Test loss: 0.919, Test accuracy: 71.19
Round  68, Global train loss: 0.528, Global test loss: 1.460, Global test accuracy: 59.84
Round  69, Train loss: 0.519, Test loss: 0.921, Test accuracy: 71.35
Round  69, Global train loss: 0.519, Global test loss: 1.266, Global test accuracy: 61.05
Round  70, Train loss: 0.498, Test loss: 0.923, Test accuracy: 71.74
Round  70, Global train loss: 0.498, Global test loss: 1.271, Global test accuracy: 62.69
Round  71, Train loss: 0.504, Test loss: 0.937, Test accuracy: 71.21
Round  71, Global train loss: 0.504, Global test loss: 1.209, Global test accuracy: 62.47
Round  72, Train loss: 0.436, Test loss: 0.961, Test accuracy: 70.94
Round  72, Global train loss: 0.436, Global test loss: 1.215, Global test accuracy: 63.48
Round  73, Train loss: 0.461, Test loss: 0.948, Test accuracy: 71.30
Round  73, Global train loss: 0.461, Global test loss: 1.279, Global test accuracy: 62.83
Round  74, Train loss: 0.484, Test loss: 0.982, Test accuracy: 70.72
Round  74, Global train loss: 0.484, Global test loss: 1.374, Global test accuracy: 60.48
Round  75, Train loss: 0.447, Test loss: 0.984, Test accuracy: 70.69
Round  75, Global train loss: 0.447, Global test loss: 1.184, Global test accuracy: 63.50
Round  76, Train loss: 0.369, Test loss: 1.004, Test accuracy: 70.94
Round  76, Global train loss: 0.369, Global test loss: 1.460, Global test accuracy: 60.89
Round  77, Train loss: 0.366, Test loss: 1.005, Test accuracy: 70.98
Round  77, Global train loss: 0.366, Global test loss: 1.430, Global test accuracy: 60.75
Round  78, Train loss: 0.381, Test loss: 0.993, Test accuracy: 71.44
Round  78, Global train loss: 0.381, Global test loss: 1.397, Global test accuracy: 61.35
Round  79, Train loss: 0.421, Test loss: 1.008, Test accuracy: 71.18
Round  79, Global train loss: 0.421, Global test loss: 1.354, Global test accuracy: 62.05
Round  80, Train loss: 0.335, Test loss: 0.996, Test accuracy: 71.16
Round  80, Global train loss: 0.335, Global test loss: 1.420, Global test accuracy: 61.96
Round  81, Train loss: 0.439, Test loss: 0.989, Test accuracy: 71.49
Round  81, Global train loss: 0.439, Global test loss: 1.411, Global test accuracy: 60.60
Round  82, Train loss: 0.437, Test loss: 0.996, Test accuracy: 71.05
Round  82, Global train loss: 0.437, Global test loss: 1.347, Global test accuracy: 61.61
Round  83, Train loss: 0.425, Test loss: 1.019, Test accuracy: 70.97
Round  83, Global train loss: 0.425, Global test loss: 1.281, Global test accuracy: 62.25
Round  84, Train loss: 0.549, Test loss: 1.004, Test accuracy: 71.44
Round  84, Global train loss: 0.549, Global test loss: 1.161, Global test accuracy: 63.86
Round  85, Train loss: 0.435, Test loss: 1.003, Test accuracy: 71.30
Round  85, Global train loss: 0.435, Global test loss: 1.377, Global test accuracy: 61.45
Round  86, Train loss: 0.490, Test loss: 1.029, Test accuracy: 71.04
Round  86, Global train loss: 0.490, Global test loss: 1.260, Global test accuracy: 62.73
Round  87, Train loss: 0.364, Test loss: 1.015, Test accuracy: 70.64
Round  87, Global train loss: 0.364, Global test loss: 1.266, Global test accuracy: 63.28
Round  88, Train loss: 0.366, Test loss: 1.019, Test accuracy: 70.66
Round  88, Global train loss: 0.366, Global test loss: 1.303, Global test accuracy: 62.89
Round  89, Train loss: 0.419, Test loss: 1.015, Test accuracy: 70.77
Round  89, Global train loss: 0.419, Global test loss: 1.227, Global test accuracy: 63.91
Round  90, Train loss: 0.427, Test loss: 1.055, Test accuracy: 70.64
Round  90, Global train loss: 0.427, Global test loss: 1.153, Global test accuracy: 64.47
Round  91, Train loss: 0.451, Test loss: 1.044, Test accuracy: 71.09
Round  91, Global train loss: 0.451, Global test loss: 1.194, Global test accuracy: 64.34
Round  92, Train loss: 0.335, Test loss: 1.063, Test accuracy: 70.86
Round  92, Global train loss: 0.335, Global test loss: 1.214, Global test accuracy: 64.57
Round  93, Train loss: 0.411, Test loss: 1.077, Test accuracy: 70.67
Round  93, Global train loss: 0.411, Global test loss: 1.281, Global test accuracy: 62.84
Round  94, Train loss: 0.366, Test loss: 1.061, Test accuracy: 70.56
Round  94, Global train loss: 0.366, Global test loss: 1.227, Global test accuracy: 63.55
Round  95, Train loss: 0.323, Test loss: 1.056, Test accuracy: 70.86
Round  95, Global train loss: 0.323, Global test loss: 1.389, Global test accuracy: 62.47
Round  96, Train loss: 0.329, Test loss: 1.028, Test accuracy: 71.60
Round  96, Global train loss: 0.329, Global test loss: 1.263, Global test accuracy: 64.31
Round  97, Train loss: 0.378, Test loss: 1.024, Test accuracy: 71.50
Round  97, Global train loss: 0.378, Global test loss: 1.193, Global test accuracy: 65.00
Round  98, Train loss: 0.419, Test loss: 1.028, Test accuracy: 71.28
Round  98, Global train loss: 0.419, Global test loss: 1.357, Global test accuracy: 62.00
Round  99, Train loss: 0.377, Test loss: 1.015, Test accuracy: 71.44
Round  99, Global train loss: 0.377, Global test loss: 1.232, Global test accuracy: 64.36
Final Round, Train loss: 0.287, Test loss: 1.177, Test accuracy: 70.82
Final Round, Global train loss: 0.287, Global test loss: 1.232, Global test accuracy: 64.36
Average accuracy final 10 rounds: 71.05
Average global accuracy final 10 rounds: 63.791000000000004
1844.6030519008636
[2.7114884853363037, 5.170783519744873, 7.63344931602478, 10.094128370285034, 12.552915573120117, 15.023947954177856, 17.49931788444519, 19.986631631851196, 22.470558404922485, 24.93165111541748, 27.394332885742188, 29.86532688140869, 32.34880208969116, 34.80607795715332, 37.26907515525818, 39.752161264419556, 42.20023584365845, 44.66964888572693, 47.14531683921814, 49.60611057281494, 52.054927110672, 54.52505612373352, 56.98102951049805, 59.44913291931152, 61.89738917350769, 64.3579626083374, 66.80683779716492, 69.27123236656189, 71.74817252159119, 74.21347212791443, 76.36421585083008, 78.49806189537048, 80.65412282943726, 82.80765795707703, 84.96225094795227, 87.15182948112488, 89.31287717819214, 91.45764017105103, 93.58963418006897, 95.72380948066711, 97.87339305877686, 100.0048315525055, 102.13902115821838, 104.28046989440918, 106.43564248085022, 108.60440587997437, 110.75656986236572, 112.89082169532776, 115.02309584617615, 117.15618991851807, 119.30216574668884, 121.43370223045349, 123.58679008483887, 125.74135398864746, 127.87454533576965, 130.0313196182251, 132.19162130355835, 134.33993530273438, 136.4903883934021, 138.64257431030273, 140.7953748703003, 142.93824195861816, 145.0891900062561, 147.2404909133911, 149.39217686653137, 151.5233714580536, 153.66251707077026, 155.815025806427, 157.95450043678284, 160.10645866394043, 162.26090955734253, 164.39399409294128, 166.53125762939453, 168.67263293266296, 170.80806922912598, 172.96042370796204, 175.0943124294281, 177.23903036117554, 179.37557339668274, 181.51485967636108, 183.65161752700806, 185.78590631484985, 187.92054319381714, 190.0557963848114, 192.19125199317932, 194.32678055763245, 196.46131443977356, 198.6180567741394, 200.77631092071533, 202.9249439239502, 205.1262011528015, 207.264652967453, 209.4046971797943, 211.54544830322266, 213.68087482452393, 215.81949496269226, 217.95963335037231, 220.09609413146973, 222.25083422660828, 224.438090801239, 228.3245153427124]
[27.77, 33.53, 38.64, 42.22, 46.14, 49.23, 52.93, 54.66, 56.17, 57.67, 58.03, 59.74, 60.72, 60.94, 62.65, 62.83, 63.16, 64.01, 63.94, 64.17, 64.28, 64.88, 65.51, 65.78, 66.04, 66.78, 67.29, 67.98, 67.74, 67.58, 67.65, 67.27, 68.19, 68.99, 68.87, 68.68, 68.23, 68.42, 68.29, 68.38, 68.35, 68.75, 69.15, 69.3, 69.14, 69.57, 69.68, 69.36, 69.35, 69.36, 68.97, 69.56, 69.92, 69.7, 69.61, 69.54, 70.38, 71.23, 71.0, 70.55, 70.09, 69.62, 70.33, 70.58, 71.12, 70.93, 70.96, 71.16, 71.19, 71.35, 71.74, 71.21, 70.94, 71.3, 70.72, 70.69, 70.94, 70.98, 71.44, 71.18, 71.16, 71.49, 71.05, 70.97, 71.44, 71.3, 71.04, 70.64, 70.66, 70.77, 70.64, 71.09, 70.86, 70.67, 70.56, 70.86, 71.6, 71.5, 71.28, 71.44, 70.82]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  16.6200
Round 1 global test acc  13.8500
Round 2 global test acc  25.5300
Round 3 global test acc  22.1100
Round 4 global test acc  23.2500
Round 5 global test acc  25.8900
Round 6 global test acc  27.1300
Round 7 global test acc  29.2900
Round 8 global test acc  30.7000
Round 9 global test acc  34.8100
Round 10 global test acc  31.9700
Round 11 global test acc  32.7800
Round 12 global test acc  35.7400
Round 13 global test acc  33.8700
Round 14 global test acc  30.5600
Round 15 global test acc  34.7400
Round 16 global test acc  32.4400
Round 17 global test acc  30.1000
Round 18 global test acc  33.9900
Round 19 global test acc  37.1800
Round 20 global test acc  38.1100
Round 21 global test acc  35.0300
Round 22 global test acc  36.6300
Round 23 global test acc  36.2600
Round 24 global test acc  35.8100
Round 25 global test acc  40.4000
Round 26 global test acc  39.7500
Round 27 global test acc  42.5600
Round 28 global test acc  37.6000
Round 29 global test acc  34.5200
Round 30 global test acc  37.2900
Round 31 global test acc  37.1600
Round 32 global test acc  43.2100
Round 33 global test acc  36.8000
Round 34 global test acc  34.0000
Round 35 global test acc  36.2700
Round 36 global test acc  37.2200
Round 37 global test acc  39.2600
Round 38 global test acc  38.5700
Round 39 global test acc  44.4700
Round 40 global test acc  46.7200
Round 41 global test acc  46.5000
Round 42 global test acc  37.0200
Round 43 global test acc  37.7000
Round 44 global test acc  36.9300
Round 45 global test acc  43.7300
Round 46 global test acc  40.2000
Round 47 global test acc  39.5100
Round 48 global test acc  42.5400
Round 49 global test acc  47.0200
Round 50 global test acc  44.0000
Round 51 global test acc  38.3600
Round 52 global test acc  43.3100
Round 53 global test acc  43.9500
Round 54 global test acc  42.6700
Round 55 global test acc  44.1900
Round 56 global test acc  48.0000
Round 57 global test acc  43.2100
Round 58 global test acc  43.2100
Round 59 global test acc  46.1600
Round 60 global test acc  43.5300
Round 61 global test acc  40.1800
Round 62 global test acc  39.5400
Round 63 global test acc  37.8600
Round 64 global test acc  47.2500
Round 65 global test acc  46.2400
Round 66 global test acc  38.9100
Round 67 global test acc  44.8200
Round 68 global test acc  47.1000
Round 69 global test acc  45.9900
Round 70 global test acc  44.2900
Round 71 global test acc  39.7200
Round 72 global test acc  39.3300
Round 73 global test acc  41.4800
Round 74 global test acc  44.7800
Round 75 global test acc  44.4800
Round 76 global test acc  49.2500
Round 77 global test acc  45.2600
Round 78 global test acc  43.5600
Round 79 global test acc  47.2500
Round 80 global test acc  42.9700
Round 81 global test acc  41.0100
Round 82 global test acc  40.5200
Round 83 global test acc  38.4200
Round 84 global test acc  39.4300
Round 85 global test acc  38.4400
Round 86 global test acc  36.8200
Round 87 global test acc  35.9300
Round 88 global test acc  34.3100
Round 89 global test acc  31.7900
Round 90 global test acc  31.3100
Round 91 global test acc  30.6300
Round 92 global test acc  29.3200
Round 93 global test acc  27.3400
Round 94 global test acc  26.4600
Round 95 global test acc  25.2100
Round 96 global test acc  24.6600
Round 97 global test acc  23.7500
Round 98 global test acc  23.9400
Round 99 global test acc  23.0800
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.991, Test loss: 2.131, Test accuracy: 23.26
Round   1, Train loss: 1.584, Test loss: 2.026, Test accuracy: 32.39
Round   2, Train loss: 1.470, Test loss: 1.760, Test accuracy: 35.00
Round   3, Train loss: 1.500, Test loss: 1.632, Test accuracy: 38.20
Round   4, Train loss: 1.413, Test loss: 1.473, Test accuracy: 42.82
Round   5, Train loss: 1.452, Test loss: 1.374, Test accuracy: 46.35
Round   6, Train loss: 1.383, Test loss: 1.273, Test accuracy: 50.89
Round   7, Train loss: 1.244, Test loss: 1.203, Test accuracy: 53.71
Round   8, Train loss: 1.305, Test loss: 1.167, Test accuracy: 55.42
Round   9, Train loss: 1.205, Test loss: 1.133, Test accuracy: 57.39
Round  10, Train loss: 1.263, Test loss: 1.115, Test accuracy: 57.39
Round  11, Train loss: 1.269, Test loss: 1.106, Test accuracy: 57.75
Round  12, Train loss: 1.234, Test loss: 1.086, Test accuracy: 59.30
Round  13, Train loss: 1.191, Test loss: 1.075, Test accuracy: 59.67
Round  14, Train loss: 1.124, Test loss: 1.065, Test accuracy: 60.05
Round  15, Train loss: 1.199, Test loss: 1.045, Test accuracy: 61.56
Round  16, Train loss: 1.089, Test loss: 1.049, Test accuracy: 61.65
Round  17, Train loss: 1.197, Test loss: 1.049, Test accuracy: 60.95
Round  18, Train loss: 1.088, Test loss: 1.023, Test accuracy: 62.01
Round  19, Train loss: 1.164, Test loss: 1.025, Test accuracy: 62.54
Round  20, Train loss: 1.073, Test loss: 0.998, Test accuracy: 63.21
Round  21, Train loss: 1.183, Test loss: 0.980, Test accuracy: 64.02
Round  22, Train loss: 1.082, Test loss: 0.987, Test accuracy: 64.20
Round  23, Train loss: 1.156, Test loss: 0.976, Test accuracy: 64.17
Round  24, Train loss: 1.057, Test loss: 0.975, Test accuracy: 64.37
Round  25, Train loss: 1.111, Test loss: 0.948, Test accuracy: 65.35
Round  26, Train loss: 1.022, Test loss: 0.943, Test accuracy: 65.76
Round  27, Train loss: 0.994, Test loss: 0.938, Test accuracy: 66.54
Round  28, Train loss: 1.017, Test loss: 0.922, Test accuracy: 66.21
Round  29, Train loss: 0.881, Test loss: 0.932, Test accuracy: 65.57
Round  30, Train loss: 0.915, Test loss: 0.916, Test accuracy: 66.28
Round  31, Train loss: 1.050, Test loss: 0.905, Test accuracy: 67.76
Round  32, Train loss: 0.906, Test loss: 0.883, Test accuracy: 68.58
Round  33, Train loss: 0.921, Test loss: 0.879, Test accuracy: 68.40
Round  34, Train loss: 1.108, Test loss: 0.885, Test accuracy: 68.25
Round  35, Train loss: 0.901, Test loss: 0.881, Test accuracy: 68.45
Round  36, Train loss: 0.945, Test loss: 0.882, Test accuracy: 68.62
Round  37, Train loss: 0.824, Test loss: 0.871, Test accuracy: 68.41
Round  38, Train loss: 0.878, Test loss: 0.860, Test accuracy: 69.25
Round  39, Train loss: 0.891, Test loss: 0.857, Test accuracy: 69.18
Round  40, Train loss: 0.939, Test loss: 0.860, Test accuracy: 69.38
Round  41, Train loss: 0.834, Test loss: 0.856, Test accuracy: 69.04
Round  42, Train loss: 0.729, Test loss: 0.845, Test accuracy: 69.50
Round  43, Train loss: 0.988, Test loss: 0.849, Test accuracy: 69.92
Round  44, Train loss: 0.878, Test loss: 0.839, Test accuracy: 70.53
Round  45, Train loss: 0.893, Test loss: 0.840, Test accuracy: 70.41
Round  46, Train loss: 0.838, Test loss: 0.837, Test accuracy: 70.46
Round  47, Train loss: 0.798, Test loss: 0.837, Test accuracy: 70.05
Round  48, Train loss: 0.878, Test loss: 0.828, Test accuracy: 71.00
Round  49, Train loss: 0.879, Test loss: 0.826, Test accuracy: 71.32
Round  50, Train loss: 0.978, Test loss: 0.831, Test accuracy: 70.63
Round  51, Train loss: 0.738, Test loss: 0.823, Test accuracy: 70.99
Round  52, Train loss: 0.770, Test loss: 0.832, Test accuracy: 71.14
Round  53, Train loss: 0.912, Test loss: 0.815, Test accuracy: 71.33
Round  54, Train loss: 0.860, Test loss: 0.817, Test accuracy: 71.22
Round  55, Train loss: 0.774, Test loss: 0.825, Test accuracy: 70.31
Round  56, Train loss: 0.768, Test loss: 0.820, Test accuracy: 70.66
Round  57, Train loss: 0.826, Test loss: 0.814, Test accuracy: 71.27
Round  58, Train loss: 0.807, Test loss: 0.817, Test accuracy: 71.39
Round  59, Train loss: 0.821, Test loss: 0.809, Test accuracy: 71.56
Round  60, Train loss: 0.814, Test loss: 0.809, Test accuracy: 71.12
Round  61, Train loss: 0.786, Test loss: 0.802, Test accuracy: 71.74
Round  62, Train loss: 0.826, Test loss: 0.816, Test accuracy: 70.82
Round  63, Train loss: 0.672, Test loss: 0.829, Test accuracy: 70.20
Round  64, Train loss: 0.746, Test loss: 0.817, Test accuracy: 70.75
Round  65, Train loss: 0.679, Test loss: 0.810, Test accuracy: 71.14
Round  66, Train loss: 0.852, Test loss: 0.811, Test accuracy: 70.75
Round  67, Train loss: 0.816, Test loss: 0.804, Test accuracy: 71.33
Round  68, Train loss: 0.712, Test loss: 0.803, Test accuracy: 71.41
Round  69, Train loss: 0.728, Test loss: 0.811, Test accuracy: 70.97
Round  70, Train loss: 0.710, Test loss: 0.818, Test accuracy: 70.74
Round  71, Train loss: 0.786, Test loss: 0.816, Test accuracy: 71.30
Round  72, Train loss: 0.766, Test loss: 0.804, Test accuracy: 71.78
Round  73, Train loss: 0.694, Test loss: 0.808, Test accuracy: 71.10
Round  74, Train loss: 0.662, Test loss: 0.807, Test accuracy: 71.13
Round  75, Train loss: 0.846, Test loss: 0.807, Test accuracy: 71.44
Round  76, Train loss: 0.614, Test loss: 0.799, Test accuracy: 71.54
Round  77, Train loss: 0.816, Test loss: 0.797, Test accuracy: 71.76
Round  78, Train loss: 0.661, Test loss: 0.806, Test accuracy: 71.54
Round  79, Train loss: 0.664, Test loss: 0.807, Test accuracy: 71.38
Round  80, Train loss: 0.661, Test loss: 0.804, Test accuracy: 71.62
Round  81, Train loss: 0.636, Test loss: 0.806, Test accuracy: 71.61
Round  82, Train loss: 0.583, Test loss: 0.805, Test accuracy: 71.78
Round  83, Train loss: 0.592, Test loss: 0.803, Test accuracy: 71.34
Round  84, Train loss: 0.780, Test loss: 0.812, Test accuracy: 70.93
Round  85, Train loss: 0.484, Test loss: 0.793, Test accuracy: 71.96
Round  86, Train loss: 0.685, Test loss: 0.807, Test accuracy: 71.35
Round  87, Train loss: 0.617, Test loss: 0.807, Test accuracy: 71.23
Round  88, Train loss: 0.601, Test loss: 0.809, Test accuracy: 71.33
Round  89, Train loss: 0.615, Test loss: 0.804, Test accuracy: 71.47
Round  90, Train loss: 0.704, Test loss: 0.803, Test accuracy: 71.66
Round  91, Train loss: 0.676, Test loss: 0.799, Test accuracy: 72.15
Round  92, Train loss: 0.701, Test loss: 0.815, Test accuracy: 71.11
Round  93, Train loss: 0.553, Test loss: 0.793, Test accuracy: 71.94
Round  94, Train loss: 0.535, Test loss: 0.800, Test accuracy: 71.90
Round  95, Train loss: 0.535, Test loss: 0.798, Test accuracy: 72.15
Round  96, Train loss: 0.643, Test loss: 0.797, Test accuracy: 72.17
Round  97, Train loss: 0.670, Test loss: 0.804, Test accuracy: 71.42
Round  98, Train loss: 0.630, Test loss: 0.810, Test accuracy: 71.01
Round  99, Train loss: 0.657, Test loss: 0.817, Test accuracy: 71.38
Final Round, Train loss: 0.542, Test loss: 0.816, Test accuracy: 72.01
Average accuracy final 10 rounds: 71.68900000000001
939.3523211479187
[1.5246145725250244, 2.7390923500061035, 3.9391062259674072, 5.178968667984009, 6.425952196121216, 7.682916641235352, 8.938487768173218, 10.190351486206055, 11.444718837738037, 12.700193643569946, 13.941187620162964, 15.186782836914062, 16.438336849212646, 17.69086241722107, 18.945894956588745, 20.198492765426636, 21.454329252243042, 22.707576751708984, 23.961891174316406, 25.209076642990112, 26.45786714553833, 27.704500198364258, 28.95657706260681, 30.217077255249023, 31.47196936607361, 32.72850275039673, 33.98509478569031, 35.24409365653992, 36.50060749053955, 37.758994817733765, 39.01455903053284, 40.26974081993103, 41.52542495727539, 42.78136944770813, 43.880128622055054, 44.97838616371155, 46.078136920928955, 47.177008628845215, 48.27702498435974, 49.37728238105774, 50.47613477706909, 51.57597637176514, 52.676947593688965, 53.77507257461548, 54.87613892555237, 55.97776222229004, 57.07894492149353, 58.179972410202026, 59.28276324272156, 60.38278675079346, 61.48384237289429, 62.585830211639404, 63.68721055984497, 64.78959774971008, 65.89220333099365, 66.99387550354004, 68.0946695804596, 69.19732403755188, 70.29871010780334, 71.39887309074402, 72.50065279006958, 73.6019024848938, 74.70320391654968, 75.8040885925293, 76.90525913238525, 78.00789737701416, 79.1100287437439, 80.21084332466125, 81.31156206130981, 82.41192770004272, 83.5110273361206, 84.61031556129456, 85.71118497848511, 86.81196641921997, 87.912437915802, 89.01334953308105, 90.11285209655762, 91.2114372253418, 92.31130361557007, 93.40973281860352, 94.50755095481873, 95.60561800003052, 96.70463275909424, 97.80427026748657, 98.90506649017334, 100.01463723182678, 101.12304329872131, 102.22283148765564, 103.32276487350464, 104.42256617546082, 105.53139328956604, 106.64322900772095, 107.7505111694336, 108.85905432701111, 109.95864391326904, 111.06533432006836, 112.17281866073608, 113.27918648719788, 114.38596773147583, 115.49192690849304, 117.31260871887207]
[23.26, 32.39, 35.0, 38.2, 42.82, 46.35, 50.89, 53.71, 55.42, 57.39, 57.39, 57.75, 59.3, 59.67, 60.05, 61.56, 61.65, 60.95, 62.01, 62.54, 63.21, 64.02, 64.2, 64.17, 64.37, 65.35, 65.76, 66.54, 66.21, 65.57, 66.28, 67.76, 68.58, 68.4, 68.25, 68.45, 68.62, 68.41, 69.25, 69.18, 69.38, 69.04, 69.5, 69.92, 70.53, 70.41, 70.46, 70.05, 71.0, 71.32, 70.63, 70.99, 71.14, 71.33, 71.22, 70.31, 70.66, 71.27, 71.39, 71.56, 71.12, 71.74, 70.82, 70.2, 70.75, 71.14, 70.75, 71.33, 71.41, 70.97, 70.74, 71.3, 71.78, 71.1, 71.13, 71.44, 71.54, 71.76, 71.54, 71.38, 71.62, 71.61, 71.78, 71.34, 70.93, 71.96, 71.35, 71.23, 71.33, 71.47, 71.66, 72.15, 71.11, 71.94, 71.9, 72.15, 72.17, 71.42, 71.01, 71.38, 72.01]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.686, Test loss: 2.021, Test accuracy: 29.09
Round   0, Global train loss: 1.686, Global test loss: 2.156, Global test accuracy: 27.90
Round   1, Train loss: 1.450, Test loss: 1.842, Test accuracy: 34.55
Round   1, Global train loss: 1.450, Global test loss: 2.067, Global test accuracy: 30.82
Round   2, Train loss: 1.341, Test loss: 1.636, Test accuracy: 38.67
Round   2, Global train loss: 1.341, Global test loss: 2.014, Global test accuracy: 29.28
Round   3, Train loss: 1.334, Test loss: 1.496, Test accuracy: 42.31
Round   3, Global train loss: 1.334, Global test loss: 2.058, Global test accuracy: 33.49
Round   4, Train loss: 1.316, Test loss: 1.364, Test accuracy: 47.46
Round   4, Global train loss: 1.316, Global test loss: 1.738, Global test accuracy: 39.79
Round   5, Train loss: 1.200, Test loss: 1.291, Test accuracy: 49.70
Round   5, Global train loss: 1.200, Global test loss: 1.643, Global test accuracy: 40.30
Round   6, Train loss: 1.199, Test loss: 1.209, Test accuracy: 53.60
Round   6, Global train loss: 1.199, Global test loss: 1.614, Global test accuracy: 40.94
Round   7, Train loss: 1.333, Test loss: 1.178, Test accuracy: 54.68
Round   7, Global train loss: 1.333, Global test loss: 1.603, Global test accuracy: 44.15
Round   8, Train loss: 1.194, Test loss: 1.136, Test accuracy: 57.30
Round   8, Global train loss: 1.194, Global test loss: 1.461, Global test accuracy: 49.76
Round   9, Train loss: 0.981, Test loss: 1.111, Test accuracy: 58.03
Round   9, Global train loss: 0.981, Global test loss: 1.591, Global test accuracy: 48.42
Round  10, Train loss: 1.063, Test loss: 1.093, Test accuracy: 59.23
Round  10, Global train loss: 1.063, Global test loss: 1.550, Global test accuracy: 50.52
Round  11, Train loss: 0.948, Test loss: 1.073, Test accuracy: 60.35
Round  11, Global train loss: 0.948, Global test loss: 1.433, Global test accuracy: 50.21
Round  12, Train loss: 1.102, Test loss: 1.048, Test accuracy: 61.08
Round  12, Global train loss: 1.102, Global test loss: 1.424, Global test accuracy: 51.39
Round  13, Train loss: 0.953, Test loss: 1.033, Test accuracy: 61.62
Round  13, Global train loss: 0.953, Global test loss: 1.423, Global test accuracy: 50.44
Round  14, Train loss: 1.112, Test loss: 1.020, Test accuracy: 62.10
Round  14, Global train loss: 1.112, Global test loss: 1.379, Global test accuracy: 50.30
Round  15, Train loss: 0.935, Test loss: 1.005, Test accuracy: 62.70
Round  15, Global train loss: 0.935, Global test loss: 1.505, Global test accuracy: 51.70
Round  16, Train loss: 0.913, Test loss: 0.998, Test accuracy: 62.89
Round  16, Global train loss: 0.913, Global test loss: 1.314, Global test accuracy: 53.44
Round  17, Train loss: 0.939, Test loss: 0.976, Test accuracy: 63.96
Round  17, Global train loss: 0.939, Global test loss: 1.291, Global test accuracy: 55.02
Round  18, Train loss: 0.982, Test loss: 0.976, Test accuracy: 64.20
Round  18, Global train loss: 0.982, Global test loss: 1.411, Global test accuracy: 52.74
Round  19, Train loss: 0.977, Test loss: 0.995, Test accuracy: 63.78
Round  19, Global train loss: 0.977, Global test loss: 1.330, Global test accuracy: 54.49
Round  20, Train loss: 0.973, Test loss: 0.991, Test accuracy: 63.98
Round  20, Global train loss: 0.973, Global test loss: 1.351, Global test accuracy: 54.89
Round  21, Train loss: 0.950, Test loss: 0.983, Test accuracy: 64.83
Round  21, Global train loss: 0.950, Global test loss: 1.246, Global test accuracy: 58.63
Round  22, Train loss: 0.783, Test loss: 0.963, Test accuracy: 65.62
Round  22, Global train loss: 0.783, Global test loss: 1.426, Global test accuracy: 53.44
Round  23, Train loss: 0.785, Test loss: 0.955, Test accuracy: 65.85
Round  23, Global train loss: 0.785, Global test loss: 1.266, Global test accuracy: 58.39
Round  24, Train loss: 0.902, Test loss: 0.957, Test accuracy: 65.37
Round  24, Global train loss: 0.902, Global test loss: 1.358, Global test accuracy: 58.37
Round  25, Train loss: 0.768, Test loss: 0.950, Test accuracy: 65.61
Round  25, Global train loss: 0.768, Global test loss: 1.220, Global test accuracy: 59.98
Round  26, Train loss: 0.803, Test loss: 0.945, Test accuracy: 65.49
Round  26, Global train loss: 0.803, Global test loss: 1.271, Global test accuracy: 58.04
Round  27, Train loss: 0.764, Test loss: 0.943, Test accuracy: 66.11
Round  27, Global train loss: 0.764, Global test loss: 1.328, Global test accuracy: 55.94
Round  28, Train loss: 0.660, Test loss: 0.935, Test accuracy: 66.56
Round  28, Global train loss: 0.660, Global test loss: 1.195, Global test accuracy: 61.08
Round  29, Train loss: 0.645, Test loss: 0.925, Test accuracy: 67.16
Round  29, Global train loss: 0.645, Global test loss: 1.295, Global test accuracy: 59.44
Round  30, Train loss: 0.646, Test loss: 0.923, Test accuracy: 67.11
Round  30, Global train loss: 0.646, Global test loss: 1.343, Global test accuracy: 58.00
Round  31, Train loss: 0.847, Test loss: 0.919, Test accuracy: 67.42
Round  31, Global train loss: 0.847, Global test loss: 1.225, Global test accuracy: 59.72
Round  32, Train loss: 0.781, Test loss: 0.925, Test accuracy: 67.62
Round  32, Global train loss: 0.781, Global test loss: 1.222, Global test accuracy: 58.33
Round  33, Train loss: 0.854, Test loss: 0.942, Test accuracy: 67.43
Round  33, Global train loss: 0.854, Global test loss: 1.203, Global test accuracy: 60.00
Round  34, Train loss: 0.706, Test loss: 0.933, Test accuracy: 67.87
Round  34, Global train loss: 0.706, Global test loss: 1.144, Global test accuracy: 62.07
Round  35, Train loss: 0.736, Test loss: 0.958, Test accuracy: 67.25
Round  35, Global train loss: 0.736, Global test loss: 1.319, Global test accuracy: 59.07
Round  36, Train loss: 0.842, Test loss: 0.919, Test accuracy: 68.06
Round  36, Global train loss: 0.842, Global test loss: 1.210, Global test accuracy: 61.83
Round  37, Train loss: 0.643, Test loss: 0.899, Test accuracy: 68.29
Round  37, Global train loss: 0.643, Global test loss: 1.144, Global test accuracy: 62.65
Round  38, Train loss: 0.698, Test loss: 0.920, Test accuracy: 68.19
Round  38, Global train loss: 0.698, Global test loss: 1.311, Global test accuracy: 57.95
Round  39, Train loss: 0.741, Test loss: 0.918, Test accuracy: 68.07
Round  39, Global train loss: 0.741, Global test loss: 1.266, Global test accuracy: 59.00
Round  40, Train loss: 0.661, Test loss: 0.937, Test accuracy: 67.67
Round  40, Global train loss: 0.661, Global test loss: 1.327, Global test accuracy: 58.68
Round  41, Train loss: 0.736, Test loss: 0.946, Test accuracy: 67.65
Round  41, Global train loss: 0.736, Global test loss: 1.203, Global test accuracy: 60.81
Round  42, Train loss: 0.523, Test loss: 0.965, Test accuracy: 67.66
Round  42, Global train loss: 0.523, Global test loss: 1.396, Global test accuracy: 57.91
Round  43, Train loss: 0.645, Test loss: 0.948, Test accuracy: 68.02
Round  43, Global train loss: 0.645, Global test loss: 1.152, Global test accuracy: 62.13
Round  44, Train loss: 0.689, Test loss: 0.958, Test accuracy: 67.83
Round  44, Global train loss: 0.689, Global test loss: 1.116, Global test accuracy: 62.63
Round  45, Train loss: 0.714, Test loss: 0.946, Test accuracy: 68.84
Round  45, Global train loss: 0.714, Global test loss: 1.174, Global test accuracy: 61.56
Round  46, Train loss: 0.691, Test loss: 0.941, Test accuracy: 68.84
Round  46, Global train loss: 0.691, Global test loss: 1.189, Global test accuracy: 61.20
Round  47, Train loss: 0.662, Test loss: 0.949, Test accuracy: 68.39
Round  47, Global train loss: 0.662, Global test loss: 1.140, Global test accuracy: 62.53
Round  48, Train loss: 0.613, Test loss: 0.952, Test accuracy: 68.43
Round  48, Global train loss: 0.613, Global test loss: 1.199, Global test accuracy: 61.56
Round  49, Train loss: 0.564, Test loss: 0.934, Test accuracy: 68.58
Round  49, Global train loss: 0.564, Global test loss: 1.245, Global test accuracy: 59.99
Round  50, Train loss: 0.629, Test loss: 0.959, Test accuracy: 68.05
Round  50, Global train loss: 0.629, Global test loss: 1.289, Global test accuracy: 58.75
Round  51, Train loss: 0.609, Test loss: 0.967, Test accuracy: 68.28
Round  51, Global train loss: 0.609, Global test loss: 1.337, Global test accuracy: 60.37
Round  52, Train loss: 0.550, Test loss: 0.956, Test accuracy: 68.47
Round  52, Global train loss: 0.550, Global test loss: 1.186, Global test accuracy: 62.02
Round  53, Train loss: 0.485, Test loss: 0.957, Test accuracy: 68.55
Round  53, Global train loss: 0.485, Global test loss: 1.209, Global test accuracy: 62.54
Round  54, Train loss: 0.546, Test loss: 0.959, Test accuracy: 68.81
Round  54, Global train loss: 0.546, Global test loss: 1.133, Global test accuracy: 62.89
Round  55, Train loss: 0.627, Test loss: 0.964, Test accuracy: 69.01
Round  55, Global train loss: 0.627, Global test loss: 1.302, Global test accuracy: 60.33
Round  56, Train loss: 0.494, Test loss: 0.982, Test accuracy: 68.58
Round  56, Global train loss: 0.494, Global test loss: 1.323, Global test accuracy: 61.28
Round  57, Train loss: 0.529, Test loss: 0.996, Test accuracy: 67.87
Round  57, Global train loss: 0.529, Global test loss: 1.196, Global test accuracy: 61.93
Round  58, Train loss: 0.534, Test loss: 0.993, Test accuracy: 68.29
Round  58, Global train loss: 0.534, Global test loss: 1.132, Global test accuracy: 63.80
Round  59, Train loss: 0.445, Test loss: 0.977, Test accuracy: 69.20
Round  59, Global train loss: 0.445, Global test loss: 1.239, Global test accuracy: 63.42
Round  60, Train loss: 0.450, Test loss: 1.013, Test accuracy: 68.87
Round  60, Global train loss: 0.450, Global test loss: 1.204, Global test accuracy: 62.97
Round  61, Train loss: 0.436, Test loss: 0.999, Test accuracy: 68.90
Round  61, Global train loss: 0.436, Global test loss: 1.522, Global test accuracy: 58.86
Round  62, Train loss: 0.537, Test loss: 0.968, Test accuracy: 69.58
Round  62, Global train loss: 0.537, Global test loss: 1.267, Global test accuracy: 61.11
Round  63, Train loss: 0.494, Test loss: 0.961, Test accuracy: 69.82
Round  63, Global train loss: 0.494, Global test loss: 1.147, Global test accuracy: 64.35
Round  64, Train loss: 0.478, Test loss: 0.947, Test accuracy: 70.05
Round  64, Global train loss: 0.478, Global test loss: 1.128, Global test accuracy: 64.85
Round  65, Train loss: 0.483, Test loss: 0.952, Test accuracy: 70.18
Round  65, Global train loss: 0.483, Global test loss: 1.381, Global test accuracy: 59.65
Round  66, Train loss: 0.514, Test loss: 0.993, Test accuracy: 69.70
Round  66, Global train loss: 0.514, Global test loss: 1.175, Global test accuracy: 62.88
Round  67, Train loss: 0.572, Test loss: 1.009, Test accuracy: 69.41
Round  67, Global train loss: 0.572, Global test loss: 1.276, Global test accuracy: 60.49
Round  68, Train loss: 0.508, Test loss: 1.042, Test accuracy: 69.10
Round  68, Global train loss: 0.508, Global test loss: 1.323, Global test accuracy: 60.96
Round  69, Train loss: 0.561, Test loss: 1.032, Test accuracy: 69.37
Round  69, Global train loss: 0.561, Global test loss: 1.353, Global test accuracy: 58.22
Round  70, Train loss: 0.482, Test loss: 1.020, Test accuracy: 69.49
Round  70, Global train loss: 0.482, Global test loss: 1.251, Global test accuracy: 62.28
Round  71, Train loss: 0.471, Test loss: 1.039, Test accuracy: 69.43
Round  71, Global train loss: 0.471, Global test loss: 1.212, Global test accuracy: 63.46
Round  72, Train loss: 0.405, Test loss: 1.048, Test accuracy: 69.39
Round  72, Global train loss: 0.405, Global test loss: 1.150, Global test accuracy: 65.30
Round  73, Train loss: 0.348, Test loss: 1.060, Test accuracy: 69.31
Round  73, Global train loss: 0.348, Global test loss: 1.311, Global test accuracy: 63.01
Round  74, Train loss: 0.475, Test loss: 1.076, Test accuracy: 68.89
Round  74, Global train loss: 0.475, Global test loss: 1.269, Global test accuracy: 61.83
Round  75, Train loss: 0.457, Test loss: 1.058, Test accuracy: 69.04
Round  75, Global train loss: 0.457, Global test loss: 1.219, Global test accuracy: 63.28
Round  76, Train loss: 0.405, Test loss: 1.062, Test accuracy: 69.43
Round  76, Global train loss: 0.405, Global test loss: 1.406, Global test accuracy: 60.62
Round  77, Train loss: 0.360, Test loss: 1.064, Test accuracy: 69.63
Round  77, Global train loss: 0.360, Global test loss: 1.399, Global test accuracy: 61.09
Round  78, Train loss: 0.551, Test loss: 1.110, Test accuracy: 69.16
Round  78, Global train loss: 0.551, Global test loss: 1.362, Global test accuracy: 59.19
Round  79, Train loss: 0.453, Test loss: 1.054, Test accuracy: 70.13
Round  79, Global train loss: 0.453, Global test loss: 1.278, Global test accuracy: 63.07
Round  80, Train loss: 0.366, Test loss: 1.058, Test accuracy: 69.95
Round  80, Global train loss: 0.366, Global test loss: 1.299, Global test accuracy: 62.89
Round  81, Train loss: 0.421, Test loss: 1.062, Test accuracy: 69.64
Round  81, Global train loss: 0.421, Global test loss: 1.353, Global test accuracy: 62.42
Round  82, Train loss: 0.407, Test loss: 1.065, Test accuracy: 69.52
Round  82, Global train loss: 0.407, Global test loss: 1.521, Global test accuracy: 58.34
Round  83, Train loss: 0.403, Test loss: 1.076, Test accuracy: 69.82
Round  83, Global train loss: 0.403, Global test loss: 1.349, Global test accuracy: 62.87
Round  84, Train loss: 0.485, Test loss: 1.078, Test accuracy: 69.69
Round  84, Global train loss: 0.485, Global test loss: 1.190, Global test accuracy: 63.58
Round  85, Train loss: 0.351, Test loss: 1.079, Test accuracy: 69.55
Round  85, Global train loss: 0.351, Global test loss: 1.277, Global test accuracy: 64.06
Round  86, Train loss: 0.504, Test loss: 1.081, Test accuracy: 69.54
Round  86, Global train loss: 0.504, Global test loss: 1.180, Global test accuracy: 62.66
Round  87, Train loss: 0.398, Test loss: 1.087, Test accuracy: 69.27
Round  87, Global train loss: 0.398, Global test loss: 1.414, Global test accuracy: 61.45
Round  88, Train loss: 0.409, Test loss: 1.068, Test accuracy: 69.12
Round  88, Global train loss: 0.409, Global test loss: 1.177, Global test accuracy: 64.40
Round  89, Train loss: 0.313, Test loss: 1.111, Test accuracy: 68.72
Round  89, Global train loss: 0.313, Global test loss: 1.314, Global test accuracy: 63.61
Round  90, Train loss: 0.392, Test loss: 1.119, Test accuracy: 69.10
Round  90, Global train loss: 0.392, Global test loss: 1.132, Global test accuracy: 64.94
Round  91, Train loss: 0.354, Test loss: 1.113, Test accuracy: 69.28
Round  91, Global train loss: 0.354, Global test loss: 1.411, Global test accuracy: 62.14
Round  92, Train loss: 0.358, Test loss: 1.116, Test accuracy: 69.59
Round  92, Global train loss: 0.358, Global test loss: 1.252, Global test accuracy: 63.82
Round  93, Train loss: 0.339, Test loss: 1.138, Test accuracy: 69.45
Round  93, Global train loss: 0.339, Global test loss: 1.338, Global test accuracy: 63.00
Round  94, Train loss: 0.455, Test loss: 1.113, Test accuracy: 69.98
Round  94, Global train loss: 0.455, Global test loss: 1.151, Global test accuracy: 65.14
Round  95, Train loss: 0.330, Test loss: 1.112, Test accuracy: 70.14
Round  95, Global train loss: 0.330, Global test loss: 1.396, Global test accuracy: 62.67
Round  96, Train loss: 0.338, Test loss: 1.099, Test accuracy: 70.46
Round  96, Global train loss: 0.338, Global test loss: 1.375, Global test accuracy: 62.59
Round  97, Train loss: 0.332, Test loss: 1.130, Test accuracy: 69.85
Round  97, Global train loss: 0.332, Global test loss: 1.251, Global test accuracy: 63.86
Round  98, Train loss: 0.460, Test loss: 1.168, Test accuracy: 69.34
Round  98, Global train loss: 0.460, Global test loss: 1.273, Global test accuracy: 62.82
Round  99, Train loss: 0.426, Test loss: 1.150, Test accuracy: 69.38
Round  99, Global train loss: 0.426, Global test loss: 1.237, Global test accuracy: 63.29
Final Round, Train loss: 0.298, Test loss: 1.282, Test accuracy: 69.22
Final Round, Global train loss: 0.298, Global test loss: 1.237, Global test accuracy: 63.29
Average accuracy final 10 rounds: 69.657
Average global accuracy final 10 rounds: 63.427
1640.984044790268
[1.4047644138336182, 2.5418596267700195, 3.680100679397583, 4.820074558258057, 5.964938640594482, 7.104996681213379, 8.238958597183228, 9.374707460403442, 10.509530067443848, 11.647257804870605, 12.781470537185669, 13.917455196380615, 15.052453994750977, 16.18699288368225, 17.326578378677368, 18.463329076766968, 19.599836587905884, 20.73914909362793, 21.875359535217285, 23.007944583892822, 24.138538360595703, 26.41757035255432, 28.69115662574768, 30.956098318099976, 33.20775604248047, 35.458556175231934, 37.7107834815979, 39.990097522735596, 42.261330127716064, 44.52338933944702, 46.80505037307739, 49.08632826805115, 51.364407539367676, 53.63475036621094, 55.903424978256226, 58.16153168678284, 60.41918444633484, 62.68625235557556, 64.94764256477356, 67.21964502334595, 69.58033061027527, 71.86346483230591, 74.13316750526428, 76.39040446281433, 78.64778447151184, 80.90686392784119, 83.18235850334167, 85.45653939247131, 87.72966623306274, 90.00492882728577, 92.28402829170227, 94.56168508529663, 96.82951354980469, 99.08609747886658, 101.34783005714417, 103.60055351257324, 105.87798023223877, 108.15382122993469, 110.42582678794861, 112.69655275344849, 114.97365045547485, 117.26079797744751, 119.54327154159546, 121.6099123954773, 123.67698502540588, 125.74536466598511, 127.81311821937561, 129.88455605506897, 131.9541370868683, 134.02008485794067, 136.08771133422852, 138.15378737449646, 140.28615736961365, 142.35102796554565, 144.4200677871704, 146.48650741577148, 148.5533709526062, 150.62044525146484, 152.68975496292114, 154.75928950309753, 156.83106780052185, 158.89907550811768, 160.96732187271118, 163.03518652915955, 165.10015225410461, 167.1920783519745, 169.2853729724884, 171.35153007507324, 173.41852974891663, 175.51306867599487, 177.60585641860962, 179.6775779724121, 181.74697399139404, 183.81465077400208, 185.8792004585266, 187.94563555717468, 190.0102469921112, 192.07503533363342, 194.1409170627594, 196.2100682258606, 198.11180710792542]
[29.09, 34.55, 38.67, 42.31, 47.46, 49.7, 53.6, 54.68, 57.3, 58.03, 59.23, 60.35, 61.08, 61.62, 62.1, 62.7, 62.89, 63.96, 64.2, 63.78, 63.98, 64.83, 65.62, 65.85, 65.37, 65.61, 65.49, 66.11, 66.56, 67.16, 67.11, 67.42, 67.62, 67.43, 67.87, 67.25, 68.06, 68.29, 68.19, 68.07, 67.67, 67.65, 67.66, 68.02, 67.83, 68.84, 68.84, 68.39, 68.43, 68.58, 68.05, 68.28, 68.47, 68.55, 68.81, 69.01, 68.58, 67.87, 68.29, 69.2, 68.87, 68.9, 69.58, 69.82, 70.05, 70.18, 69.7, 69.41, 69.1, 69.37, 69.49, 69.43, 69.39, 69.31, 68.89, 69.04, 69.43, 69.63, 69.16, 70.13, 69.95, 69.64, 69.52, 69.82, 69.69, 69.55, 69.54, 69.27, 69.12, 68.72, 69.1, 69.28, 69.59, 69.45, 69.98, 70.14, 70.46, 69.85, 69.34, 69.38, 69.22]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.549, Test loss: 1.351, Test accuracy: 44.75
Round   0, Global train loss: 1.549, Global test loss: 2.051, Global test accuracy: 30.84
Round   1, Train loss: 1.358, Test loss: 1.239, Test accuracy: 52.14
Round   1, Global train loss: 1.358, Global test loss: 1.789, Global test accuracy: 36.91
Round   2, Train loss: 1.250, Test loss: 1.173, Test accuracy: 55.58
Round   2, Global train loss: 1.250, Global test loss: 1.652, Global test accuracy: 41.29
Round   3, Train loss: 1.169, Test loss: 1.124, Test accuracy: 57.22
Round   3, Global train loss: 1.169, Global test loss: 1.534, Global test accuracy: 45.82
Round   4, Train loss: 1.109, Test loss: 1.102, Test accuracy: 59.40
Round   4, Global train loss: 1.109, Global test loss: 1.465, Global test accuracy: 48.47
Round   5, Train loss: 1.051, Test loss: 1.077, Test accuracy: 60.27
Round   5, Global train loss: 1.051, Global test loss: 1.410, Global test accuracy: 50.94
Round   6, Train loss: 1.002, Test loss: 1.064, Test accuracy: 61.22
Round   6, Global train loss: 1.002, Global test loss: 1.369, Global test accuracy: 52.35
Round   7, Train loss: 0.955, Test loss: 1.061, Test accuracy: 62.10
Round   7, Global train loss: 0.955, Global test loss: 1.310, Global test accuracy: 54.27
Round   8, Train loss: 0.912, Test loss: 1.091, Test accuracy: 61.00
Round   8, Global train loss: 0.912, Global test loss: 1.282, Global test accuracy: 55.72
Round   9, Train loss: 0.872, Test loss: 1.092, Test accuracy: 61.60
Round   9, Global train loss: 0.872, Global test loss: 1.261, Global test accuracy: 57.06
Round  10, Train loss: 0.672, Test loss: 1.086, Test accuracy: 61.76
Round  10, Global train loss: 0.672, Global test loss: 1.575, Global test accuracy: 54.00
Round  11, Train loss: 0.812, Test loss: 1.085, Test accuracy: 62.08
Round  11, Global train loss: 0.812, Global test loss: 1.317, Global test accuracy: 56.61
Round  12, Train loss: 0.733, Test loss: 1.086, Test accuracy: 62.30
Round  12, Global train loss: 0.733, Global test loss: 1.400, Global test accuracy: 54.04
Round  13, Train loss: 0.770, Test loss: 1.077, Test accuracy: 62.88
Round  13, Global train loss: 0.770, Global test loss: 1.366, Global test accuracy: 55.64
Round  14, Train loss: 0.787, Test loss: 1.069, Test accuracy: 63.49
Round  14, Global train loss: 0.787, Global test loss: 1.416, Global test accuracy: 53.47
Round  15, Train loss: 0.629, Test loss: 1.069, Test accuracy: 64.02
Round  15, Global train loss: 0.629, Global test loss: 1.490, Global test accuracy: 56.76
Round  16, Train loss: 0.740, Test loss: 1.083, Test accuracy: 64.53
Round  16, Global train loss: 0.740, Global test loss: 1.264, Global test accuracy: 58.53
Round  17, Train loss: 0.681, Test loss: 1.085, Test accuracy: 64.94
Round  17, Global train loss: 0.681, Global test loss: 1.319, Global test accuracy: 57.21
Round  18, Train loss: 0.605, Test loss: 1.109, Test accuracy: 64.55
Round  18, Global train loss: 0.605, Global test loss: 1.443, Global test accuracy: 56.76
Round  19, Train loss: 0.612, Test loss: 1.136, Test accuracy: 64.26
Round  19, Global train loss: 0.612, Global test loss: 1.336, Global test accuracy: 57.97
Round  20, Train loss: 0.654, Test loss: 1.155, Test accuracy: 64.27
Round  20, Global train loss: 0.654, Global test loss: 1.383, Global test accuracy: 56.91
Round  21, Train loss: 0.684, Test loss: 1.168, Test accuracy: 64.24
Round  21, Global train loss: 0.684, Global test loss: 1.226, Global test accuracy: 60.06
Round  22, Train loss: 0.530, Test loss: 1.178, Test accuracy: 64.17
Round  22, Global train loss: 0.530, Global test loss: 1.520, Global test accuracy: 56.57
Round  23, Train loss: 0.456, Test loss: 1.216, Test accuracy: 64.01
Round  23, Global train loss: 0.456, Global test loss: 1.339, Global test accuracy: 60.70
Round  24, Train loss: 0.507, Test loss: 1.225, Test accuracy: 64.15
Round  24, Global train loss: 0.507, Global test loss: 1.638, Global test accuracy: 58.80
Round  25, Train loss: 0.443, Test loss: 1.225, Test accuracy: 64.49
Round  25, Global train loss: 0.443, Global test loss: 1.384, Global test accuracy: 60.40
Round  26, Train loss: 0.554, Test loss: 1.284, Test accuracy: 64.02
Round  26, Global train loss: 0.554, Global test loss: 1.481, Global test accuracy: 57.46
Round  27, Train loss: 0.500, Test loss: 1.250, Test accuracy: 64.44
Round  27, Global train loss: 0.500, Global test loss: 1.405, Global test accuracy: 58.07
Round  28, Train loss: 0.459, Test loss: 1.264, Test accuracy: 63.96
Round  28, Global train loss: 0.459, Global test loss: 1.298, Global test accuracy: 61.59
Round  29, Train loss: 0.478, Test loss: 1.274, Test accuracy: 63.79
Round  29, Global train loss: 0.478, Global test loss: 1.485, Global test accuracy: 57.69
Round  30, Train loss: 0.428, Test loss: 1.291, Test accuracy: 63.83
Round  30, Global train loss: 0.428, Global test loss: 1.498, Global test accuracy: 59.83
Round  31, Train loss: 0.459, Test loss: 1.286, Test accuracy: 64.56
Round  31, Global train loss: 0.459, Global test loss: 1.439, Global test accuracy: 58.84
Round  32, Train loss: 0.498, Test loss: 1.267, Test accuracy: 65.38
Round  32, Global train loss: 0.498, Global test loss: 1.517, Global test accuracy: 57.08
Round  33, Train loss: 0.490, Test loss: 1.291, Test accuracy: 65.29
Round  33, Global train loss: 0.490, Global test loss: 1.554, Global test accuracy: 58.52
Round  34, Train loss: 0.378, Test loss: 1.306, Test accuracy: 65.52
Round  34, Global train loss: 0.378, Global test loss: 1.284, Global test accuracy: 63.07
Round  35, Train loss: 0.447, Test loss: 1.313, Test accuracy: 65.54
Round  35, Global train loss: 0.447, Global test loss: 1.485, Global test accuracy: 59.26
Round  36, Train loss: 0.418, Test loss: 1.296, Test accuracy: 65.20
Round  36, Global train loss: 0.418, Global test loss: 1.485, Global test accuracy: 60.57
Round  37, Train loss: 0.442, Test loss: 1.301, Test accuracy: 65.21
Round  37, Global train loss: 0.442, Global test loss: 1.543, Global test accuracy: 57.82
Round  38, Train loss: 0.509, Test loss: 1.289, Test accuracy: 65.90
Round  38, Global train loss: 0.509, Global test loss: 1.396, Global test accuracy: 59.99
Round  39, Train loss: 0.394, Test loss: 1.348, Test accuracy: 65.77
Round  39, Global train loss: 0.394, Global test loss: 1.439, Global test accuracy: 60.71
Round  40, Train loss: 0.315, Test loss: 1.339, Test accuracy: 66.25
Round  40, Global train loss: 0.315, Global test loss: 1.618, Global test accuracy: 60.54
Round  41, Train loss: 0.419, Test loss: 1.319, Test accuracy: 66.53
Round  41, Global train loss: 0.419, Global test loss: 1.604, Global test accuracy: 57.98
Round  42, Train loss: 0.303, Test loss: 1.379, Test accuracy: 65.61
Round  42, Global train loss: 0.303, Global test loss: 1.799, Global test accuracy: 58.89
Round  43, Train loss: 0.429, Test loss: 1.385, Test accuracy: 65.92
Round  43, Global train loss: 0.429, Global test loss: 1.398, Global test accuracy: 60.16
Round  44, Train loss: 0.424, Test loss: 1.421, Test accuracy: 65.70
Round  44, Global train loss: 0.424, Global test loss: 1.574, Global test accuracy: 57.91
Round  45, Train loss: 0.413, Test loss: 1.421, Test accuracy: 65.86
Round  45, Global train loss: 0.413, Global test loss: 1.474, Global test accuracy: 59.15
Round  46, Train loss: 0.376, Test loss: 1.386, Test accuracy: 66.48
Round  46, Global train loss: 0.376, Global test loss: 1.481, Global test accuracy: 60.97
Round  47, Train loss: 0.292, Test loss: 1.395, Test accuracy: 66.31
Round  47, Global train loss: 0.292, Global test loss: 1.492, Global test accuracy: 61.46
Round  48, Train loss: 0.377, Test loss: 1.418, Test accuracy: 66.05
Round  48, Global train loss: 0.377, Global test loss: 1.513, Global test accuracy: 60.54
Round  49, Train loss: 0.376, Test loss: 1.432, Test accuracy: 66.37
Round  49, Global train loss: 0.376, Global test loss: 1.481, Global test accuracy: 60.73
Round  50, Train loss: 0.406, Test loss: 1.440, Test accuracy: 66.28
Round  50, Global train loss: 0.406, Global test loss: 1.586, Global test accuracy: 57.82
Round  51, Train loss: 0.269, Test loss: 1.450, Test accuracy: 66.39
Round  51, Global train loss: 0.269, Global test loss: 1.926, Global test accuracy: 58.65
Round  52, Train loss: 0.285, Test loss: 1.450, Test accuracy: 66.48
Round  52, Global train loss: 0.285, Global test loss: 1.763, Global test accuracy: 58.99
Round  53, Train loss: 0.303, Test loss: 1.433, Test accuracy: 66.77
Round  53, Global train loss: 0.303, Global test loss: 1.702, Global test accuracy: 60.74
Round  54, Train loss: 0.319, Test loss: 1.460, Test accuracy: 66.72
Round  54, Global train loss: 0.319, Global test loss: 1.488, Global test accuracy: 60.33
Round  55, Train loss: 0.273, Test loss: 1.487, Test accuracy: 66.64
Round  55, Global train loss: 0.273, Global test loss: 1.747, Global test accuracy: 60.50
Round  56, Train loss: 0.272, Test loss: 1.505, Test accuracy: 66.71
Round  56, Global train loss: 0.272, Global test loss: 1.710, Global test accuracy: 60.37
Round  57, Train loss: 0.418, Test loss: 1.473, Test accuracy: 66.52
Round  57, Global train loss: 0.418, Global test loss: 1.598, Global test accuracy: 57.78
Round  58, Train loss: 0.292, Test loss: 1.487, Test accuracy: 66.58
Round  58, Global train loss: 0.292, Global test loss: 1.488, Global test accuracy: 61.50
Round  59, Train loss: 0.216, Test loss: 1.513, Test accuracy: 66.44
Round  59, Global train loss: 0.216, Global test loss: 1.662, Global test accuracy: 62.55
Round  60, Train loss: 0.279, Test loss: 1.519, Test accuracy: 66.48
Round  60, Global train loss: 0.279, Global test loss: 1.522, Global test accuracy: 61.14
Round  61, Train loss: 0.258, Test loss: 1.536, Test accuracy: 66.13
Round  61, Global train loss: 0.258, Global test loss: 1.908, Global test accuracy: 58.35
Round  62, Train loss: 0.216, Test loss: 1.528, Test accuracy: 66.48
Round  62, Global train loss: 0.216, Global test loss: 1.685, Global test accuracy: 60.60
Round  63, Train loss: 0.254, Test loss: 1.511, Test accuracy: 66.48
Round  63, Global train loss: 0.254, Global test loss: 1.666, Global test accuracy: 62.47
Round  64, Train loss: 0.369, Test loss: 1.493, Test accuracy: 66.86
Round  64, Global train loss: 0.369, Global test loss: 1.447, Global test accuracy: 61.28
Round  65, Train loss: 0.272, Test loss: 1.471, Test accuracy: 67.27
Round  65, Global train loss: 0.272, Global test loss: 1.623, Global test accuracy: 60.07
Round  66, Train loss: 0.308, Test loss: 1.521, Test accuracy: 66.67
Round  66, Global train loss: 0.308, Global test loss: 1.522, Global test accuracy: 61.34
Round  67, Train loss: 0.320, Test loss: 1.524, Test accuracy: 66.58
Round  67, Global train loss: 0.320, Global test loss: 1.705, Global test accuracy: 58.37
Round  68, Train loss: 0.299, Test loss: 1.490, Test accuracy: 67.04
Round  68, Global train loss: 0.299, Global test loss: 1.858, Global test accuracy: 56.75
Round  69, Train loss: 0.322, Test loss: 1.472, Test accuracy: 67.09
Round  69, Global train loss: 0.322, Global test loss: 1.620, Global test accuracy: 58.05
Round  70, Train loss: 0.247, Test loss: 1.494, Test accuracy: 67.15
Round  70, Global train loss: 0.247, Global test loss: 1.665, Global test accuracy: 60.08
Round  71, Train loss: 0.226, Test loss: 1.483, Test accuracy: 67.37
Round  71, Global train loss: 0.226, Global test loss: 1.555, Global test accuracy: 61.77
Round  72, Train loss: 0.266, Test loss: 1.489, Test accuracy: 67.47
Round  72, Global train loss: 0.266, Global test loss: 1.608, Global test accuracy: 61.59
Round  73, Train loss: 0.255, Test loss: 1.497, Test accuracy: 67.34
Round  73, Global train loss: 0.255, Global test loss: 1.595, Global test accuracy: 60.05
Round  74, Train loss: 0.249, Test loss: 1.516, Test accuracy: 67.22
Round  74, Global train loss: 0.249, Global test loss: 1.712, Global test accuracy: 60.99
Round  75, Train loss: 0.282, Test loss: 1.507, Test accuracy: 67.35
Round  75, Global train loss: 0.282, Global test loss: 1.716, Global test accuracy: 58.05
Round  76, Train loss: 0.213, Test loss: 1.507, Test accuracy: 67.55
Round  76, Global train loss: 0.213, Global test loss: 1.748, Global test accuracy: 60.80
Round  77, Train loss: 0.265, Test loss: 1.571, Test accuracy: 67.23
Round  77, Global train loss: 0.265, Global test loss: 1.701, Global test accuracy: 61.00
Round  78, Train loss: 0.247, Test loss: 1.568, Test accuracy: 67.18
Round  78, Global train loss: 0.247, Global test loss: 1.771, Global test accuracy: 60.88
Round  79, Train loss: 0.243, Test loss: 1.569, Test accuracy: 66.91
Round  79, Global train loss: 0.243, Global test loss: 1.728, Global test accuracy: 60.27
Round  80, Train loss: 0.186, Test loss: 1.595, Test accuracy: 66.80
Round  80, Global train loss: 0.186, Global test loss: 1.673, Global test accuracy: 62.89
Round  81, Train loss: 0.163, Test loss: 1.605, Test accuracy: 66.97
Round  81, Global train loss: 0.163, Global test loss: 1.732, Global test accuracy: 63.23
Round  82, Train loss: 0.156, Test loss: 1.584, Test accuracy: 66.55
Round  82, Global train loss: 0.156, Global test loss: 1.691, Global test accuracy: 63.35
Round  83, Train loss: 0.148, Test loss: 1.573, Test accuracy: 67.19
Round  83, Global train loss: 0.148, Global test loss: 1.742, Global test accuracy: 63.34
Round  84, Train loss: 0.142, Test loss: 1.629, Test accuracy: 66.75
Round  84, Global train loss: 0.142, Global test loss: 1.822, Global test accuracy: 62.94
Round  85, Train loss: 0.137, Test loss: 1.630, Test accuracy: 66.62
Round  85, Global train loss: 0.137, Global test loss: 1.806, Global test accuracy: 63.35
Round  86, Train loss: 0.138, Test loss: 1.614, Test accuracy: 66.69
Round  86, Global train loss: 0.138, Global test loss: 1.822, Global test accuracy: 63.13
Round  87, Train loss: 0.130, Test loss: 1.637, Test accuracy: 67.04
Round  87, Global train loss: 0.130, Global test loss: 1.855, Global test accuracy: 62.74
Round  88, Train loss: 0.125, Test loss: 1.649, Test accuracy: 66.76
Round  88, Global train loss: 0.125, Global test loss: 1.838, Global test accuracy: 62.96
Round  89, Train loss: 0.120, Test loss: 1.639, Test accuracy: 66.95
Round  89, Global train loss: 0.120, Global test loss: 1.905, Global test accuracy: 62.54
Round  90, Train loss: 0.264, Test loss: 1.605, Test accuracy: 66.97
Round  90, Global train loss: 0.264, Global test loss: 1.517, Global test accuracy: 63.56
Round  91, Train loss: 0.235, Test loss: 1.607, Test accuracy: 67.32
Round  91, Global train loss: 0.235, Global test loss: 1.500, Global test accuracy: 63.75
Round  92, Train loss: 0.222, Test loss: 1.636, Test accuracy: 67.03
Round  92, Global train loss: 0.222, Global test loss: 1.494, Global test accuracy: 63.60
Round  93, Train loss: 0.221, Test loss: 1.643, Test accuracy: 67.10
Round  93, Global train loss: 0.221, Global test loss: 1.492, Global test accuracy: 63.74
Round  94, Train loss: 0.218, Test loss: 1.677, Test accuracy: 66.76
Round  94, Global train loss: 0.218, Global test loss: 1.493, Global test accuracy: 63.45
Round  95, Train loss: 0.211, Test loss: 1.646, Test accuracy: 67.54
Round  95, Global train loss: 0.211, Global test loss: 1.496, Global test accuracy: 63.74
Round  96, Train loss: 0.204, Test loss: 1.788, Test accuracy: 66.35
Round  96, Global train loss: 0.204, Global test loss: 1.535, Global test accuracy: 63.55
Round  97, Train loss: 0.210, Test loss: 1.669, Test accuracy: 67.36
Round  97, Global train loss: 0.210, Global test loss: 1.538, Global test accuracy: 63.31
Round  98, Train loss: 0.207, Test loss: 1.663, Test accuracy: 67.32
Round  98, Global train loss: 0.207, Global test loss: 1.535, Global test accuracy: 63.27
Round  99, Train loss: 0.203, Test loss: 1.665, Test accuracy: 66.66
Round  99, Global train loss: 0.203, Global test loss: 1.499, Global test accuracy: 63.63
Final Round, Train loss: 0.148, Test loss: 1.904, Test accuracy: 66.94
Final Round, Global train loss: 0.148, Global test loss: 1.499, Global test accuracy: 63.63
Average accuracy final 10 rounds: 67.041
Average global accuracy final 10 rounds: 63.56
2283.3333563804626
[2.3795135021209717, 4.64107346534729, 6.89838719367981, 9.152301788330078, 11.405593395233154, 13.309565544128418, 15.21328616142273, 17.118268728256226, 19.02507495880127, 20.931631803512573, 22.838591814041138, 24.740970849990845, 26.64380383491516, 28.547503232955933, 30.451577186584473, 32.356826305389404, 34.26198101043701, 36.1647310256958, 38.05643033981323, 39.945316314697266, 41.83731985092163, 43.73974132537842, 45.647836208343506, 47.543241024017334, 49.44971585273743, 51.35587978363037, 53.26522254943848, 55.158578395843506, 57.05383276939392, 58.95907807350159, 60.86403727531433, 62.769927978515625, 64.67246985435486, 66.90135097503662, 69.1374785900116, 71.02635288238525, 72.9172089099884, 74.80690789222717, 76.69858932495117, 78.59203577041626, 80.48611378669739, 82.38120937347412, 84.27310514450073, 86.16928315162659, 88.07988929748535, 89.97353959083557, 91.86778998374939, 93.7636456489563, 95.65654349327087, 97.55018281936646, 99.44236040115356, 101.33278775215149, 103.2253201007843, 105.11645913124084, 107.01519012451172, 108.90964365005493, 110.80395221710205, 112.69606614112854, 114.58849120140076, 116.62250423431396, 118.66142416000366, 120.69527578353882, 122.60508728027344, 124.49811053276062, 126.39080882072449, 128.28812980651855, 130.18100309371948, 132.07482314109802, 133.9668471813202, 135.85949754714966, 137.7516279220581, 139.64926958084106, 141.54407024383545, 143.43700623512268, 145.33190846443176, 147.22667860984802, 149.11765050888062, 151.01118087768555, 152.90443205833435, 154.79340410232544, 156.68272066116333, 158.57569932937622, 160.47210502624512, 162.36806082725525, 164.26381731033325, 166.15772080421448, 168.13475823402405, 170.02936339378357, 171.92395567893982, 173.81904435157776, 175.7135467529297, 177.6080002784729, 179.50489950180054, 181.40187311172485, 183.29727268218994, 185.1921796798706, 187.098379611969, 189.00518417358398, 190.9112138748169, 192.82040333747864, 196.63589787483215]
[44.75, 52.14, 55.58, 57.22, 59.4, 60.27, 61.22, 62.1, 61.0, 61.6, 61.76, 62.08, 62.3, 62.88, 63.49, 64.02, 64.53, 64.94, 64.55, 64.26, 64.27, 64.24, 64.17, 64.01, 64.15, 64.49, 64.02, 64.44, 63.96, 63.79, 63.83, 64.56, 65.38, 65.29, 65.52, 65.54, 65.2, 65.21, 65.9, 65.77, 66.25, 66.53, 65.61, 65.92, 65.7, 65.86, 66.48, 66.31, 66.05, 66.37, 66.28, 66.39, 66.48, 66.77, 66.72, 66.64, 66.71, 66.52, 66.58, 66.44, 66.48, 66.13, 66.48, 66.48, 66.86, 67.27, 66.67, 66.58, 67.04, 67.09, 67.15, 67.37, 67.47, 67.34, 67.22, 67.35, 67.55, 67.23, 67.18, 66.91, 66.8, 66.97, 66.55, 67.19, 66.75, 66.62, 66.69, 67.04, 66.76, 66.95, 66.97, 67.32, 67.03, 67.1, 66.76, 67.54, 66.35, 67.36, 67.32, 66.66, 66.94]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.515, Test loss: 1.299, Test accuracy: 47.55
Round   0, Global train loss: 1.515, Global test loss: 2.048, Global test accuracy: 31.53
Round   1, Train loss: 1.307, Test loss: 1.164, Test accuracy: 54.10
Round   1, Global train loss: 1.307, Global test loss: 1.831, Global test accuracy: 36.80
Round   2, Train loss: 1.184, Test loss: 1.112, Test accuracy: 57.60
Round   2, Global train loss: 1.184, Global test loss: 1.651, Global test accuracy: 42.29
Round   3, Train loss: 1.101, Test loss: 1.070, Test accuracy: 60.35
Round   3, Global train loss: 1.101, Global test loss: 1.538, Global test accuracy: 45.97
Round   4, Train loss: 1.035, Test loss: 1.048, Test accuracy: 61.89
Round   4, Global train loss: 1.035, Global test loss: 1.454, Global test accuracy: 48.86
Round   5, Train loss: 0.979, Test loss: 1.010, Test accuracy: 63.04
Round   5, Global train loss: 0.979, Global test loss: 1.387, Global test accuracy: 51.76
Round   6, Train loss: 0.930, Test loss: 1.004, Test accuracy: 62.89
Round   6, Global train loss: 0.930, Global test loss: 1.325, Global test accuracy: 53.83
Round   7, Train loss: 0.880, Test loss: 1.005, Test accuracy: 63.65
Round   7, Global train loss: 0.880, Global test loss: 1.285, Global test accuracy: 55.59
Round   8, Train loss: 0.837, Test loss: 0.968, Test accuracy: 65.77
Round   8, Global train loss: 0.837, Global test loss: 1.252, Global test accuracy: 56.78
Round   9, Train loss: 0.801, Test loss: 0.961, Test accuracy: 66.27
Round   9, Global train loss: 0.801, Global test loss: 1.231, Global test accuracy: 57.84
Round  10, Train loss: 0.725, Test loss: 0.948, Test accuracy: 66.56
Round  10, Global train loss: 0.725, Global test loss: 1.557, Global test accuracy: 55.00
Round  11, Train loss: 0.694, Test loss: 0.987, Test accuracy: 65.56
Round  11, Global train loss: 0.694, Global test loss: 1.257, Global test accuracy: 58.43
Round  12, Train loss: 0.683, Test loss: 0.995, Test accuracy: 65.49
Round  12, Global train loss: 0.683, Global test loss: 1.472, Global test accuracy: 54.80
Round  13, Train loss: 0.664, Test loss: 0.986, Test accuracy: 65.88
Round  13, Global train loss: 0.664, Global test loss: 1.316, Global test accuracy: 58.08
Round  14, Train loss: 0.723, Test loss: 0.964, Test accuracy: 66.94
Round  14, Global train loss: 0.723, Global test loss: 1.324, Global test accuracy: 55.47
Round  15, Train loss: 0.726, Test loss: 0.990, Test accuracy: 66.60
Round  15, Global train loss: 0.726, Global test loss: 1.330, Global test accuracy: 56.87
Round  16, Train loss: 0.671, Test loss: 0.993, Test accuracy: 66.86
Round  16, Global train loss: 0.671, Global test loss: 1.191, Global test accuracy: 60.27
Round  17, Train loss: 0.550, Test loss: 0.984, Test accuracy: 67.58
Round  17, Global train loss: 0.550, Global test loss: 1.314, Global test accuracy: 59.30
Round  18, Train loss: 0.605, Test loss: 1.044, Test accuracy: 66.90
Round  18, Global train loss: 0.605, Global test loss: 1.520, Global test accuracy: 55.35
Round  19, Train loss: 0.572, Test loss: 1.007, Test accuracy: 67.51
Round  19, Global train loss: 0.572, Global test loss: 1.287, Global test accuracy: 59.61
Round  20, Train loss: 0.543, Test loss: 1.025, Test accuracy: 67.58
Round  20, Global train loss: 0.543, Global test loss: 1.391, Global test accuracy: 57.74
Round  21, Train loss: 0.527, Test loss: 1.041, Test accuracy: 68.00
Round  21, Global train loss: 0.527, Global test loss: 1.222, Global test accuracy: 60.17
Round  22, Train loss: 0.527, Test loss: 1.023, Test accuracy: 68.45
Round  22, Global train loss: 0.527, Global test loss: 1.319, Global test accuracy: 59.78
Round  23, Train loss: 0.452, Test loss: 1.034, Test accuracy: 68.55
Round  23, Global train loss: 0.452, Global test loss: 1.261, Global test accuracy: 62.06
Round  24, Train loss: 0.393, Test loss: 1.047, Test accuracy: 68.90
Round  24, Global train loss: 0.393, Global test loss: 1.624, Global test accuracy: 59.88
Round  25, Train loss: 0.480, Test loss: 1.056, Test accuracy: 69.42
Round  25, Global train loss: 0.480, Global test loss: 1.317, Global test accuracy: 60.80
Round  26, Train loss: 0.467, Test loss: 1.065, Test accuracy: 69.49
Round  26, Global train loss: 0.467, Global test loss: 1.479, Global test accuracy: 59.36
Round  27, Train loss: 0.443, Test loss: 1.082, Test accuracy: 69.21
Round  27, Global train loss: 0.443, Global test loss: 1.306, Global test accuracy: 60.68
Round  28, Train loss: 0.529, Test loss: 1.083, Test accuracy: 69.53
Round  28, Global train loss: 0.529, Global test loss: 1.226, Global test accuracy: 62.95
Round  29, Train loss: 0.415, Test loss: 1.099, Test accuracy: 69.10
Round  29, Global train loss: 0.415, Global test loss: 1.335, Global test accuracy: 62.77
Round  30, Train loss: 0.445, Test loss: 1.142, Test accuracy: 68.72
Round  30, Global train loss: 0.445, Global test loss: 1.345, Global test accuracy: 61.23
Round  31, Train loss: 0.477, Test loss: 1.147, Test accuracy: 68.67
Round  31, Global train loss: 0.477, Global test loss: 1.430, Global test accuracy: 59.48
Round  32, Train loss: 0.369, Test loss: 1.165, Test accuracy: 68.53
Round  32, Global train loss: 0.369, Global test loss: 1.497, Global test accuracy: 58.62
Round  33, Train loss: 0.456, Test loss: 1.159, Test accuracy: 68.90
Round  33, Global train loss: 0.456, Global test loss: 1.326, Global test accuracy: 61.85
Round  34, Train loss: 0.432, Test loss: 1.139, Test accuracy: 69.04
Round  34, Global train loss: 0.432, Global test loss: 1.230, Global test accuracy: 63.13
Round  35, Train loss: 0.362, Test loss: 1.165, Test accuracy: 68.92
Round  35, Global train loss: 0.362, Global test loss: 1.401, Global test accuracy: 61.45
Round  36, Train loss: 0.370, Test loss: 1.156, Test accuracy: 69.13
Round  36, Global train loss: 0.370, Global test loss: 1.433, Global test accuracy: 62.22
Round  37, Train loss: 0.320, Test loss: 1.175, Test accuracy: 69.35
Round  37, Global train loss: 0.320, Global test loss: 1.391, Global test accuracy: 61.79
Round  38, Train loss: 0.398, Test loss: 1.192, Test accuracy: 69.59
Round  38, Global train loss: 0.398, Global test loss: 1.575, Global test accuracy: 59.92
Round  39, Train loss: 0.312, Test loss: 1.160, Test accuracy: 70.08
Round  39, Global train loss: 0.312, Global test loss: 1.399, Global test accuracy: 62.23
Round  40, Train loss: 0.281, Test loss: 1.137, Test accuracy: 70.58
Round  40, Global train loss: 0.281, Global test loss: 1.352, Global test accuracy: 63.14
Round  41, Train loss: 0.307, Test loss: 1.152, Test accuracy: 69.96
Round  41, Global train loss: 0.307, Global test loss: 1.344, Global test accuracy: 63.92
Round  42, Train loss: 0.216, Test loss: 1.163, Test accuracy: 69.97
Round  42, Global train loss: 0.216, Global test loss: 1.721, Global test accuracy: 61.33
Round  43, Train loss: 0.376, Test loss: 1.164, Test accuracy: 70.51
Round  43, Global train loss: 0.376, Global test loss: 1.244, Global test accuracy: 64.94
Round  44, Train loss: 0.315, Test loss: 1.168, Test accuracy: 70.68
Round  44, Global train loss: 0.315, Global test loss: 1.326, Global test accuracy: 63.70
Round  45, Train loss: 0.388, Test loss: 1.185, Test accuracy: 70.97
Round  45, Global train loss: 0.388, Global test loss: 1.202, Global test accuracy: 64.16
Round  46, Train loss: 0.346, Test loss: 1.166, Test accuracy: 71.43
Round  46, Global train loss: 0.346, Global test loss: 1.450, Global test accuracy: 60.88
Round  47, Train loss: 0.288, Test loss: 1.204, Test accuracy: 70.82
Round  47, Global train loss: 0.288, Global test loss: 1.375, Global test accuracy: 63.38
Round  48, Train loss: 0.295, Test loss: 1.205, Test accuracy: 70.67
Round  48, Global train loss: 0.295, Global test loss: 1.432, Global test accuracy: 63.27
Round  49, Train loss: 0.315, Test loss: 1.239, Test accuracy: 70.10
Round  49, Global train loss: 0.315, Global test loss: 1.471, Global test accuracy: 62.08
Round  50, Train loss: 0.319, Test loss: 1.244, Test accuracy: 70.33
Round  50, Global train loss: 0.319, Global test loss: 1.469, Global test accuracy: 62.17
Round  51, Train loss: 0.265, Test loss: 1.238, Test accuracy: 70.30
Round  51, Global train loss: 0.265, Global test loss: 1.875, Global test accuracy: 60.23
Round  52, Train loss: 0.291, Test loss: 1.231, Test accuracy: 70.70
Round  52, Global train loss: 0.291, Global test loss: 1.540, Global test accuracy: 62.66
Round  53, Train loss: 0.322, Test loss: 1.244, Test accuracy: 71.01
Round  53, Global train loss: 0.322, Global test loss: 1.627, Global test accuracy: 61.00
Round  54, Train loss: 0.325, Test loss: 1.250, Test accuracy: 70.83
Round  54, Global train loss: 0.325, Global test loss: 1.437, Global test accuracy: 62.87
Round  55, Train loss: 0.234, Test loss: 1.240, Test accuracy: 70.72
Round  55, Global train loss: 0.234, Global test loss: 1.652, Global test accuracy: 61.87
Round  56, Train loss: 0.221, Test loss: 1.240, Test accuracy: 70.85
Round  56, Global train loss: 0.221, Global test loss: 1.777, Global test accuracy: 61.22
Round  57, Train loss: 0.335, Test loss: 1.221, Test accuracy: 71.10
Round  57, Global train loss: 0.335, Global test loss: 1.409, Global test accuracy: 62.40
Round  58, Train loss: 0.250, Test loss: 1.239, Test accuracy: 71.36
Round  58, Global train loss: 0.250, Global test loss: 1.391, Global test accuracy: 63.56
Round  59, Train loss: 0.279, Test loss: 1.233, Test accuracy: 71.41
Round  59, Global train loss: 0.279, Global test loss: 1.361, Global test accuracy: 64.26
Round  60, Train loss: 0.212, Test loss: 1.262, Test accuracy: 71.31
Round  60, Global train loss: 0.212, Global test loss: 1.461, Global test accuracy: 64.20
Round  61, Train loss: 0.217, Test loss: 1.272, Test accuracy: 70.82
Round  61, Global train loss: 0.217, Global test loss: 1.960, Global test accuracy: 60.47
Round  62, Train loss: 0.227, Test loss: 1.256, Test accuracy: 71.06
Round  62, Global train loss: 0.227, Global test loss: 1.797, Global test accuracy: 60.43
Round  63, Train loss: 0.269, Test loss: 1.286, Test accuracy: 70.96
Round  63, Global train loss: 0.269, Global test loss: 1.432, Global test accuracy: 63.09
Round  64, Train loss: 0.272, Test loss: 1.277, Test accuracy: 71.27
Round  64, Global train loss: 0.272, Global test loss: 1.336, Global test accuracy: 64.76
Round  65, Train loss: 0.226, Test loss: 1.267, Test accuracy: 71.54
Round  65, Global train loss: 0.226, Global test loss: 1.751, Global test accuracy: 61.15
Round  66, Train loss: 0.230, Test loss: 1.238, Test accuracy: 71.98
Round  66, Global train loss: 0.230, Global test loss: 1.443, Global test accuracy: 63.62
Round  67, Train loss: 0.275, Test loss: 1.256, Test accuracy: 71.77
Round  67, Global train loss: 0.275, Global test loss: 1.616, Global test accuracy: 61.53
Round  68, Train loss: 0.230, Test loss: 1.251, Test accuracy: 71.76
Round  68, Global train loss: 0.230, Global test loss: 1.731, Global test accuracy: 60.84
Round  69, Train loss: 0.255, Test loss: 1.256, Test accuracy: 71.93
Round  69, Global train loss: 0.255, Global test loss: 1.552, Global test accuracy: 61.86
Round  70, Train loss: 0.191, Test loss: 1.279, Test accuracy: 71.96
Round  70, Global train loss: 0.191, Global test loss: 1.648, Global test accuracy: 61.93
Round  71, Train loss: 0.174, Test loss: 1.256, Test accuracy: 72.18
Round  71, Global train loss: 0.174, Global test loss: 1.533, Global test accuracy: 63.39
Round  72, Train loss: 0.268, Test loss: 1.261, Test accuracy: 71.97
Round  72, Global train loss: 0.268, Global test loss: 1.433, Global test accuracy: 63.45
Round  73, Train loss: 0.206, Test loss: 1.280, Test accuracy: 72.06
Round  73, Global train loss: 0.206, Global test loss: 1.527, Global test accuracy: 63.55
Round  74, Train loss: 0.191, Test loss: 1.280, Test accuracy: 72.12
Round  74, Global train loss: 0.191, Global test loss: 1.627, Global test accuracy: 62.78
Round  75, Train loss: 0.246, Test loss: 1.281, Test accuracy: 72.20
Round  75, Global train loss: 0.246, Global test loss: 1.543, Global test accuracy: 62.81
Round  76, Train loss: 0.185, Test loss: 1.292, Test accuracy: 71.97
Round  76, Global train loss: 0.185, Global test loss: 1.555, Global test accuracy: 63.63
Round  77, Train loss: 0.256, Test loss: 1.298, Test accuracy: 71.86
Round  77, Global train loss: 0.256, Global test loss: 1.700, Global test accuracy: 62.15
Round  78, Train loss: 0.209, Test loss: 1.328, Test accuracy: 71.85
Round  78, Global train loss: 0.209, Global test loss: 1.590, Global test accuracy: 63.35
Round  79, Train loss: 0.200, Test loss: 1.315, Test accuracy: 71.66
Round  79, Global train loss: 0.200, Global test loss: 1.650, Global test accuracy: 62.57
Round  80, Train loss: 0.149, Test loss: 1.313, Test accuracy: 71.91
Round  80, Global train loss: 0.149, Global test loss: 1.535, Global test accuracy: 64.78
Round  81, Train loss: 0.132, Test loss: 1.325, Test accuracy: 71.70
Round  81, Global train loss: 0.132, Global test loss: 1.645, Global test accuracy: 64.21
Round  82, Train loss: 0.123, Test loss: 1.322, Test accuracy: 71.78
Round  82, Global train loss: 0.123, Global test loss: 1.686, Global test accuracy: 64.52
Round  83, Train loss: 0.112, Test loss: 1.325, Test accuracy: 71.99
Round  83, Global train loss: 0.112, Global test loss: 1.766, Global test accuracy: 63.96
Round  84, Train loss: 0.115, Test loss: 1.374, Test accuracy: 71.24
Round  84, Global train loss: 0.115, Global test loss: 1.753, Global test accuracy: 64.21
Round  85, Train loss: 0.110, Test loss: 1.325, Test accuracy: 72.05
Round  85, Global train loss: 0.110, Global test loss: 1.696, Global test accuracy: 64.68
Round  86, Train loss: 0.099, Test loss: 1.332, Test accuracy: 72.18
Round  86, Global train loss: 0.099, Global test loss: 1.774, Global test accuracy: 64.34
Round  87, Train loss: 0.103, Test loss: 1.345, Test accuracy: 71.92
Round  87, Global train loss: 0.103, Global test loss: 1.765, Global test accuracy: 64.10
Round  88, Train loss: 0.095, Test loss: 1.374, Test accuracy: 71.48
Round  88, Global train loss: 0.095, Global test loss: 1.779, Global test accuracy: 64.25
Round  89, Train loss: 0.092, Test loss: 1.346, Test accuracy: 72.08
Round  89, Global train loss: 0.092, Global test loss: 1.859, Global test accuracy: 63.78
Round  90, Train loss: 0.224, Test loss: 1.395, Test accuracy: 70.90
Round  90, Global train loss: 0.224, Global test loss: 1.387, Global test accuracy: 66.03
Round  91, Train loss: 0.196, Test loss: 1.371, Test accuracy: 72.08
Round  91, Global train loss: 0.196, Global test loss: 1.362, Global test accuracy: 66.51
Round  92, Train loss: 0.191, Test loss: 1.340, Test accuracy: 72.32
Round  92, Global train loss: 0.191, Global test loss: 1.357, Global test accuracy: 66.61
Round  93, Train loss: 0.182, Test loss: 1.328, Test accuracy: 72.04
Round  93, Global train loss: 0.182, Global test loss: 1.370, Global test accuracy: 66.30
Round  94, Train loss: 0.179, Test loss: 1.344, Test accuracy: 72.65
Round  94, Global train loss: 0.179, Global test loss: 1.384, Global test accuracy: 66.41
Round  95, Train loss: 0.179, Test loss: 1.405, Test accuracy: 71.18
Round  95, Global train loss: 0.179, Global test loss: 1.374, Global test accuracy: 66.55
Round  96, Train loss: 0.181, Test loss: 1.335, Test accuracy: 71.79
Round  96, Global train loss: 0.181, Global test loss: 1.362, Global test accuracy: 66.51
Round  97, Train loss: 0.175, Test loss: 1.338, Test accuracy: 71.85
Round  97, Global train loss: 0.175, Global test loss: 1.393, Global test accuracy: 66.17
Round  98, Train loss: 0.174, Test loss: 1.377, Test accuracy: 71.82
Round  98, Global train loss: 0.174, Global test loss: 1.417, Global test accuracy: 66.16
Round  99, Train loss: 0.174, Test loss: 1.394, Test accuracy: 71.48
Round  99, Global train loss: 0.174, Global test loss: 1.387, Global test accuracy: 66.08
Final Round, Train loss: 0.129, Test loss: 1.467, Test accuracy: 72.11
Final Round, Global train loss: 0.129, Global test loss: 1.387, Global test accuracy: 66.08
Average accuracy final 10 rounds: 71.811
Average global accuracy final 10 rounds: 66.333
3778.5924882888794
[2.5014050006866455, 4.453910827636719, 6.449733257293701, 8.431573390960693, 10.452712059020996, 12.36748194694519, 14.345466613769531, 16.290996074676514, 18.24933910369873, 20.26656198501587, 22.184623956680298, 24.10460638999939, 26.00504970550537, 27.89902925491333, 29.827179193496704, 31.721080541610718, 33.61457872390747, 35.516319036483765, 37.4433012008667, 39.34426760673523, 41.24775266647339, 45.40968585014343, 49.5652437210083, 53.686845779418945, 57.85912370681763, 62.0349760055542, 66.23938608169556, 70.39146113395691, 74.53370332717896, 78.71754908561707, 82.86470317840576, 87.07892918586731, 91.24735283851624, 95.4101049900055, 99.58000540733337, 103.76117730140686, 107.89848804473877, 112.04820084571838, 116.22345852851868, 120.39524912834167, 124.57558870315552, 128.75486254692078, 132.9290828704834, 137.11738657951355, 141.2729570865631, 145.45352792739868, 149.63290143013, 153.8612096309662, 158.0380415916443, 162.20741033554077, 166.4230182170868, 170.59882521629333, 174.7532398700714, 178.8958580493927, 183.0276734828949, 187.2255847454071, 191.749431848526, 196.27075862884521, 200.78416752815247, 205.29919838905334, 209.80787110328674, 214.33136582374573, 218.8426239490509, 223.39694356918335, 227.573468208313, 231.73965096473694, 235.90614867210388, 240.0773684978485, 244.23783326148987, 248.3968448638916, 252.8895137310028, 257.3830192089081, 261.8963153362274, 266.3914427757263, 270.89402866363525, 275.3848419189453, 279.89567613601685, 284.395494222641, 288.90032386779785, 293.44745445251465, 297.9409234523773, 302.4494352340698, 306.9561266899109, 311.46273827552795, 315.98338890075684, 320.5136501789093, 325.02121925354004, 329.15300726890564, 333.2883698940277, 337.4839291572571, 341.62556648254395, 345.7708637714386, 349.9008684158325, 354.0385398864746, 358.23217511177063, 362.3720636367798, 366.50540566444397, 370.64032220840454, 374.77308440208435, 378.9627728462219, 382.7473523616791]
[47.55, 54.1, 57.6, 60.35, 61.89, 63.04, 62.89, 63.65, 65.77, 66.27, 66.56, 65.56, 65.49, 65.88, 66.94, 66.6, 66.86, 67.58, 66.9, 67.51, 67.58, 68.0, 68.45, 68.55, 68.9, 69.42, 69.49, 69.21, 69.53, 69.1, 68.72, 68.67, 68.53, 68.9, 69.04, 68.92, 69.13, 69.35, 69.59, 70.08, 70.58, 69.96, 69.97, 70.51, 70.68, 70.97, 71.43, 70.82, 70.67, 70.1, 70.33, 70.3, 70.7, 71.01, 70.83, 70.72, 70.85, 71.1, 71.36, 71.41, 71.31, 70.82, 71.06, 70.96, 71.27, 71.54, 71.98, 71.77, 71.76, 71.93, 71.96, 72.18, 71.97, 72.06, 72.12, 72.2, 71.97, 71.86, 71.85, 71.66, 71.91, 71.7, 71.78, 71.99, 71.24, 72.05, 72.18, 71.92, 71.48, 72.08, 70.9, 72.08, 72.32, 72.04, 72.65, 71.18, 71.79, 71.85, 71.82, 71.48, 72.11]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 13, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.705, Test loss: 1.654, Test accuracy: 34.44
Round   1, Train loss: 1.364, Test loss: 1.340, Test accuracy: 44.91
Round   2, Train loss: 1.222, Test loss: 1.204, Test accuracy: 51.00
Round   3, Train loss: 1.134, Test loss: 1.094, Test accuracy: 56.49
Round   4, Train loss: 1.073, Test loss: 1.070, Test accuracy: 57.64
Round   5, Train loss: 1.021, Test loss: 1.008, Test accuracy: 60.47
Round   6, Train loss: 0.981, Test loss: 0.969, Test accuracy: 62.70
Round   7, Train loss: 0.938, Test loss: 0.927, Test accuracy: 64.27
Round   8, Train loss: 0.908, Test loss: 0.930, Test accuracy: 64.07
Round   9, Train loss: 0.873, Test loss: 0.872, Test accuracy: 66.10
Round  10, Train loss: 0.846, Test loss: 0.864, Test accuracy: 67.25
Round  11, Train loss: 0.816, Test loss: 0.846, Test accuracy: 68.41
Round  12, Train loss: 0.793, Test loss: 0.832, Test accuracy: 68.61
Round  13, Train loss: 0.768, Test loss: 0.815, Test accuracy: 69.32
Round  14, Train loss: 0.743, Test loss: 0.813, Test accuracy: 69.57
Round  15, Train loss: 0.725, Test loss: 0.809, Test accuracy: 69.37
Round  16, Train loss: 0.703, Test loss: 0.795, Test accuracy: 70.75
Round  17, Train loss: 0.685, Test loss: 0.792, Test accuracy: 69.94
Round  18, Train loss: 0.666, Test loss: 0.784, Test accuracy: 71.18
Round  19, Train loss: 0.649, Test loss: 0.757, Test accuracy: 72.68
Round  20, Train loss: 0.615, Test loss: 0.780, Test accuracy: 71.68
Round  21, Train loss: 0.652, Test loss: 0.782, Test accuracy: 71.60
Round  22, Train loss: 0.683, Test loss: 0.792, Test accuracy: 71.40
Round  23, Train loss: 0.547, Test loss: 0.808, Test accuracy: 70.93
Round  24, Train loss: 0.581, Test loss: 0.790, Test accuracy: 71.90
Round  25, Train loss: 0.585, Test loss: 0.799, Test accuracy: 71.88
Round  26, Train loss: 0.688, Test loss: 0.786, Test accuracy: 72.41
Round  27, Train loss: 0.527, Test loss: 0.796, Test accuracy: 72.29
Round  28, Train loss: 0.564, Test loss: 0.788, Test accuracy: 72.13
Round  29, Train loss: 0.467, Test loss: 0.817, Test accuracy: 71.77
Round  30, Train loss: 0.549, Test loss: 0.826, Test accuracy: 71.55
Round  31, Train loss: 0.514, Test loss: 0.809, Test accuracy: 72.37
Round  32, Train loss: 0.551, Test loss: 0.797, Test accuracy: 72.70
Round  33, Train loss: 0.523, Test loss: 0.812, Test accuracy: 72.37
Round  34, Train loss: 0.502, Test loss: 0.821, Test accuracy: 72.83
Round  35, Train loss: 0.527, Test loss: 0.810, Test accuracy: 73.17
Round  36, Train loss: 0.522, Test loss: 0.819, Test accuracy: 72.85
Round  37, Train loss: 0.509, Test loss: 0.810, Test accuracy: 72.78
Round  38, Train loss: 0.408, Test loss: 0.816, Test accuracy: 73.16
Round  39, Train loss: 0.398, Test loss: 0.818, Test accuracy: 73.05
Round  40, Train loss: 0.444, Test loss: 0.814, Test accuracy: 73.12
Round  41, Train loss: 0.382, Test loss: 0.828, Test accuracy: 73.15
Round  42, Train loss: 0.368, Test loss: 0.864, Test accuracy: 72.37
Round  43, Train loss: 0.403, Test loss: 0.812, Test accuracy: 73.37
Round  44, Train loss: 0.523, Test loss: 0.837, Test accuracy: 73.54
Round  45, Train loss: 0.433, Test loss: 0.829, Test accuracy: 73.56
Round  46, Train loss: 0.430, Test loss: 0.865, Test accuracy: 73.12
Round  47, Train loss: 0.340, Test loss: 0.870, Test accuracy: 72.55
Round  48, Train loss: 0.471, Test loss: 0.852, Test accuracy: 72.93
Round  49, Train loss: 0.344, Test loss: 0.870, Test accuracy: 72.45
Round  50, Train loss: 0.393, Test loss: 0.893, Test accuracy: 72.06
Round  51, Train loss: 0.314, Test loss: 0.870, Test accuracy: 72.97
Round  52, Train loss: 0.356, Test loss: 0.872, Test accuracy: 73.13
Round  53, Train loss: 0.382, Test loss: 0.866, Test accuracy: 73.08
Round  54, Train loss: 0.420, Test loss: 0.897, Test accuracy: 72.42
Round  55, Train loss: 0.331, Test loss: 0.921, Test accuracy: 72.31
Round  56, Train loss: 0.295, Test loss: 0.921, Test accuracy: 72.38
Round  57, Train loss: 0.375, Test loss: 0.918, Test accuracy: 72.61
Round  58, Train loss: 0.325, Test loss: 0.942, Test accuracy: 72.20
Round  59, Train loss: 0.340, Test loss: 0.918, Test accuracy: 72.48
Round  60, Train loss: 0.358, Test loss: 0.956, Test accuracy: 73.17
Round  61, Train loss: 0.252, Test loss: 0.966, Test accuracy: 73.21
Round  62, Train loss: 0.295, Test loss: 0.953, Test accuracy: 73.21
Round  63, Train loss: 0.290, Test loss: 0.927, Test accuracy: 73.08
Round  64, Train loss: 0.347, Test loss: 0.932, Test accuracy: 73.59
Round  65, Train loss: 0.254, Test loss: 0.933, Test accuracy: 73.81
Round  66, Train loss: 0.339, Test loss: 0.911, Test accuracy: 74.14
Round  67, Train loss: 0.348, Test loss: 0.954, Test accuracy: 73.39
Round  68, Train loss: 0.291, Test loss: 0.980, Test accuracy: 73.18
Round  69, Train loss: 0.417, Test loss: 0.947, Test accuracy: 74.00
Round  70, Train loss: 0.244, Test loss: 0.928, Test accuracy: 74.17
Round  71, Train loss: 0.237, Test loss: 0.975, Test accuracy: 73.98
Round  72, Train loss: 0.296, Test loss: 0.970, Test accuracy: 73.75
Round  73, Train loss: 0.244, Test loss: 0.979, Test accuracy: 73.62
Round  74, Train loss: 0.322, Test loss: 1.022, Test accuracy: 72.88
Round  75, Train loss: 0.379, Test loss: 0.992, Test accuracy: 73.40
Round  76, Train loss: 0.240, Test loss: 0.985, Test accuracy: 73.56
Round  77, Train loss: 0.271, Test loss: 0.995, Test accuracy: 73.31
Round  78, Train loss: 0.317, Test loss: 0.974, Test accuracy: 73.26
Round  79, Train loss: 0.274, Test loss: 1.038, Test accuracy: 72.70
Round  80, Train loss: 0.191, Test loss: 0.977, Test accuracy: 73.98
Round  81, Train loss: 0.164, Test loss: 1.015, Test accuracy: 73.67
Round  82, Train loss: 0.158, Test loss: 1.015, Test accuracy: 73.83
Round  83, Train loss: 0.150, Test loss: 1.050, Test accuracy: 73.67
Round  84, Train loss: 0.156, Test loss: 1.053, Test accuracy: 73.33
Round  85, Train loss: 0.137, Test loss: 1.066, Test accuracy: 73.37
Round  86, Train loss: 0.145, Test loss: 1.088, Test accuracy: 73.09
Round  87, Train loss: 0.136, Test loss: 1.089, Test accuracy: 73.07
Round  88, Train loss: 0.136, Test loss: 1.068, Test accuracy: 73.42
Round  89, Train loss: 0.129, Test loss: 1.117, Test accuracy: 73.22
Round  90, Train loss: 0.266, Test loss: 1.046, Test accuracy: 73.40
Round  91, Train loss: 0.246, Test loss: 1.032, Test accuracy: 73.77
Round  92, Train loss: 0.244, Test loss: 1.015, Test accuracy: 74.14
Round  93, Train loss: 0.232, Test loss: 1.030, Test accuracy: 73.75
Round  94, Train loss: 0.230, Test loss: 1.077, Test accuracy: 73.51
Round  95, Train loss: 0.231, Test loss: 1.062, Test accuracy: 73.76
Round  96, Train loss: 0.219, Test loss: 1.061, Test accuracy: 73.58
Round  97, Train loss: 0.217, Test loss: 1.045, Test accuracy: 73.79
Round  98, Train loss: 0.222, Test loss: 1.100, Test accuracy: 73.04
Round  99, Train loss: 0.220, Test loss: 1.036, Test accuracy: 74.32
Final Round, Train loss: 0.176, Test loss: 1.053, Test accuracy: 74.08
Average accuracy final 10 rounds: 73.70599999999999
3103.3588349819183
[2.3042023181915283, 4.319631814956665, 6.333154916763306, 8.135911226272583, 9.941521167755127, 11.746744394302368, 13.5515718460083, 15.35702657699585, 17.16141128540039, 18.968211889266968, 20.77192187309265, 22.58109760284424, 24.396173000335693, 26.212933778762817, 28.08113121986389, 29.937129020690918, 31.792008638381958, 33.643195152282715, 35.457669496536255, 37.27737498283386, 39.092007875442505, 42.26531982421875, 45.42447519302368, 48.59969449043274, 51.778395652770996, 54.95701456069946, 58.15489983558655, 61.328736543655396, 64.50199270248413, 67.68331789970398, 70.85253310203552, 74.01811265945435, 77.1943187713623, 80.36350154876709, 83.5417788028717, 86.72801637649536, 89.91258502006531, 93.08752989768982, 96.35585141181946, 99.54952764511108, 102.73443293571472, 105.9250099658966, 109.11263227462769, 112.30301833152771, 115.47475790977478, 118.64537906646729, 121.81751537322998, 124.99468612670898, 128.1844460964203, 131.37156748771667, 134.55933809280396, 137.7346580028534, 140.90825366973877, 144.07906365394592, 147.2495982646942, 150.41705083847046, 153.59792470932007, 156.77332258224487, 159.96765613555908, 163.19644856452942, 166.379212141037, 169.5702247619629, 172.74091720581055, 175.92197799682617, 179.10721373558044, 182.3630313873291, 185.54950523376465, 188.7301619052887, 191.90344333648682, 195.08580946922302, 198.2743890285492, 201.462543964386, 204.6505184173584, 207.83715891838074, 211.02405905723572, 214.21171617507935, 217.40241146087646, 220.58599972724915, 223.77634239196777, 226.96657061576843, 230.14607191085815, 233.325040102005, 236.5164749622345, 239.69468784332275, 242.88465762138367, 246.07212018966675, 249.3425531387329, 252.51868629455566, 255.70796608924866, 258.8972268104553, 262.08862495422363, 265.27534317970276, 268.46276116371155, 271.6475315093994, 274.8195161819458, 277.99260902404785, 281.23482966423035, 284.44062328338623, 287.62638568878174, 290.8188717365265, 294.2249844074249]
[34.44, 44.91, 51.0, 56.49, 57.64, 60.47, 62.7, 64.27, 64.07, 66.1, 67.25, 68.41, 68.61, 69.32, 69.57, 69.37, 70.75, 69.94, 71.18, 72.68, 71.68, 71.6, 71.4, 70.93, 71.9, 71.88, 72.41, 72.29, 72.13, 71.77, 71.55, 72.37, 72.7, 72.37, 72.83, 73.17, 72.85, 72.78, 73.16, 73.05, 73.12, 73.15, 72.37, 73.37, 73.54, 73.56, 73.12, 72.55, 72.93, 72.45, 72.06, 72.97, 73.13, 73.08, 72.42, 72.31, 72.38, 72.61, 72.2, 72.48, 73.17, 73.21, 73.21, 73.08, 73.59, 73.81, 74.14, 73.39, 73.18, 74.0, 74.17, 73.98, 73.75, 73.62, 72.88, 73.4, 73.56, 73.31, 73.26, 72.7, 73.98, 73.67, 73.83, 73.67, 73.33, 73.37, 73.09, 73.07, 73.42, 73.22, 73.4, 73.77, 74.14, 73.75, 73.51, 73.76, 73.58, 73.79, 73.04, 74.32, 74.08]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.739, Test loss: 1.662, Test accuracy: 38.51
Round   1, Train loss: 1.370, Test loss: 1.310, Test accuracy: 45.49
Round   2, Train loss: 1.217, Test loss: 1.159, Test accuracy: 53.54
Round   3, Train loss: 1.131, Test loss: 1.058, Test accuracy: 59.00
Round   4, Train loss: 1.071, Test loss: 1.008, Test accuracy: 61.22
Round   5, Train loss: 1.024, Test loss: 0.974, Test accuracy: 61.99
Round   6, Train loss: 0.984, Test loss: 0.937, Test accuracy: 63.33
Round   7, Train loss: 0.946, Test loss: 0.917, Test accuracy: 64.48
Round   8, Train loss: 0.910, Test loss: 0.878, Test accuracy: 66.50
Round   9, Train loss: 0.875, Test loss: 0.849, Test accuracy: 68.18
Round  10, Train loss: 0.668, Test loss: 0.844, Test accuracy: 68.32
Round  11, Train loss: 0.881, Test loss: 0.845, Test accuracy: 67.85
Round  12, Train loss: 0.777, Test loss: 0.823, Test accuracy: 68.66
Round  13, Train loss: 0.774, Test loss: 0.812, Test accuracy: 69.33
Round  14, Train loss: 0.845, Test loss: 0.798, Test accuracy: 70.75
Round  15, Train loss: 0.817, Test loss: 0.785, Test accuracy: 71.25
Round  16, Train loss: 0.826, Test loss: 0.797, Test accuracy: 70.83
Round  17, Train loss: 0.731, Test loss: 0.798, Test accuracy: 70.44
Round  18, Train loss: 0.648, Test loss: 0.781, Test accuracy: 71.98
Round  19, Train loss: 0.626, Test loss: 0.775, Test accuracy: 72.28
Round  20, Train loss: 0.591, Test loss: 0.743, Test accuracy: 72.95
Round  21, Train loss: 0.653, Test loss: 0.766, Test accuracy: 72.40
Round  22, Train loss: 0.644, Test loss: 0.748, Test accuracy: 73.07
Round  23, Train loss: 0.574, Test loss: 0.739, Test accuracy: 73.37
Round  24, Train loss: 0.497, Test loss: 0.727, Test accuracy: 73.44
Round  25, Train loss: 0.525, Test loss: 0.740, Test accuracy: 73.36
Round  26, Train loss: 0.619, Test loss: 0.729, Test accuracy: 74.20
Round  27, Train loss: 0.534, Test loss: 0.719, Test accuracy: 74.45
Round  28, Train loss: 0.549, Test loss: 0.740, Test accuracy: 73.85
Round  29, Train loss: 0.585, Test loss: 0.711, Test accuracy: 74.90
Round  30, Train loss: 0.550, Test loss: 0.715, Test accuracy: 74.52
Round  31, Train loss: 0.578, Test loss: 0.719, Test accuracy: 74.74
Round  32, Train loss: 0.664, Test loss: 0.712, Test accuracy: 74.81
Round  33, Train loss: 0.538, Test loss: 0.726, Test accuracy: 74.13
Round  34, Train loss: 0.497, Test loss: 0.727, Test accuracy: 74.01
Round  35, Train loss: 0.681, Test loss: 0.716, Test accuracy: 74.90
Round  36, Train loss: 0.504, Test loss: 0.715, Test accuracy: 75.00
Round  37, Train loss: 0.542, Test loss: 0.698, Test accuracy: 75.64
Round  38, Train loss: 0.498, Test loss: 0.714, Test accuracy: 74.92
Round  39, Train loss: 0.484, Test loss: 0.700, Test accuracy: 75.06
Round  40, Train loss: 0.391, Test loss: 0.715, Test accuracy: 75.04
Round  41, Train loss: 0.482, Test loss: 0.727, Test accuracy: 74.61
Round  42, Train loss: 0.380, Test loss: 0.737, Test accuracy: 73.97
Round  43, Train loss: 0.446, Test loss: 0.733, Test accuracy: 74.14
Round  44, Train loss: 0.440, Test loss: 0.719, Test accuracy: 74.29
Round  45, Train loss: 0.441, Test loss: 0.722, Test accuracy: 74.88
Round  46, Train loss: 0.489, Test loss: 0.711, Test accuracy: 74.69
Round  47, Train loss: 0.457, Test loss: 0.705, Test accuracy: 75.20
Round  48, Train loss: 0.434, Test loss: 0.706, Test accuracy: 75.27
Round  49, Train loss: 0.341, Test loss: 0.712, Test accuracy: 75.39
Round  50, Train loss: 0.335, Test loss: 0.719, Test accuracy: 75.38
Round  51, Train loss: 0.321, Test loss: 0.713, Test accuracy: 75.30
Round  52, Train loss: 0.353, Test loss: 0.716, Test accuracy: 75.38
Round  53, Train loss: 0.302, Test loss: 0.721, Test accuracy: 75.08
Round  54, Train loss: 0.346, Test loss: 0.720, Test accuracy: 75.86
Round  55, Train loss: 0.287, Test loss: 0.706, Test accuracy: 75.79
Round  56, Train loss: 0.292, Test loss: 0.689, Test accuracy: 76.68
Round  57, Train loss: 0.448, Test loss: 0.712, Test accuracy: 76.37
Round  58, Train loss: 0.467, Test loss: 0.718, Test accuracy: 75.96
Round  59, Train loss: 0.380, Test loss: 0.719, Test accuracy: 76.07
Round  60, Train loss: 0.392, Test loss: 0.727, Test accuracy: 75.55
Round  61, Train loss: 0.240, Test loss: 0.730, Test accuracy: 75.51
Round  62, Train loss: 0.291, Test loss: 0.739, Test accuracy: 74.85
Round  63, Train loss: 0.353, Test loss: 0.711, Test accuracy: 76.04
Round  64, Train loss: 0.445, Test loss: 0.716, Test accuracy: 76.49
Round  65, Train loss: 0.315, Test loss: 0.713, Test accuracy: 76.16
Round  66, Train loss: 0.402, Test loss: 0.723, Test accuracy: 75.89
Round  67, Train loss: 0.289, Test loss: 0.720, Test accuracy: 75.92
Round  68, Train loss: 0.283, Test loss: 0.714, Test accuracy: 76.05
Round  69, Train loss: 0.470, Test loss: 0.735, Test accuracy: 75.51
Round  70, Train loss: 0.262, Test loss: 0.734, Test accuracy: 76.12
Round  71, Train loss: 0.301, Test loss: 0.744, Test accuracy: 75.94
Round  72, Train loss: 0.338, Test loss: 0.731, Test accuracy: 75.85
Round  73, Train loss: 0.331, Test loss: 0.759, Test accuracy: 75.00
Round  74, Train loss: 0.308, Test loss: 0.751, Test accuracy: 75.64
Round  75, Train loss: 0.340, Test loss: 0.740, Test accuracy: 75.81
Round  76, Train loss: 0.372, Test loss: 0.765, Test accuracy: 75.59
Round  77, Train loss: 0.250, Test loss: 0.742, Test accuracy: 76.01
Round  78, Train loss: 0.298, Test loss: 0.731, Test accuracy: 76.17
Round  79, Train loss: 0.260, Test loss: 0.741, Test accuracy: 76.15
Round  80, Train loss: 0.195, Test loss: 0.724, Test accuracy: 76.33
Round  81, Train loss: 0.173, Test loss: 0.730, Test accuracy: 76.22
Round  82, Train loss: 0.174, Test loss: 0.738, Test accuracy: 76.12
Round  83, Train loss: 0.160, Test loss: 0.750, Test accuracy: 75.85
Round  84, Train loss: 0.146, Test loss: 0.752, Test accuracy: 75.94
Round  85, Train loss: 0.149, Test loss: 0.740, Test accuracy: 75.87
Round  86, Train loss: 0.137, Test loss: 0.742, Test accuracy: 76.38
Round  87, Train loss: 0.129, Test loss: 0.751, Test accuracy: 76.37
Round  88, Train loss: 0.132, Test loss: 0.759, Test accuracy: 76.02
Round  89, Train loss: 0.130, Test loss: 0.765, Test accuracy: 75.89
Round  90, Train loss: 0.281, Test loss: 0.741, Test accuracy: 76.43
Round  91, Train loss: 0.265, Test loss: 0.726, Test accuracy: 76.96
Round  92, Train loss: 0.262, Test loss: 0.747, Test accuracy: 76.30
Round  93, Train loss: 0.258, Test loss: 0.751, Test accuracy: 76.41
Round  94, Train loss: 0.258, Test loss: 0.766, Test accuracy: 76.13
Round  95, Train loss: 0.253, Test loss: 0.749, Test accuracy: 76.32
Round  96, Train loss: 0.243, Test loss: 0.753, Test accuracy: 76.73
Round  97, Train loss: 0.244, Test loss: 0.764, Test accuracy: 76.46
Round  98, Train loss: 0.241, Test loss: 0.752, Test accuracy: 76.39
Round  99, Train loss: 0.237, Test loss: 0.767, Test accuracy: 76.23
Final Round, Train loss: 0.215, Test loss: 0.756, Test accuracy: 76.82
Average accuracy final 10 rounds: 76.436
3353.0075962543488
[2.8713085651397705, 5.411651611328125, 7.8602001667022705, 10.125605344772339, 12.387526750564575, 14.63044548034668, 16.875096797943115, 19.117488145828247, 21.358912706375122, 23.617608785629272, 25.88194441795349, 28.143645524978638, 30.406219005584717, 32.66802406311035, 34.928248167037964, 37.16936755180359, 39.41178846359253, 41.653685331344604, 43.898396015167236, 46.15873718261719, 48.4209771156311, 52.171213150024414, 55.90601921081543, 59.63797116279602, 63.38007879257202, 67.12059354782104, 70.85914635658264, 74.62078738212585, 78.36132478713989, 82.10073494911194, 85.84415984153748, 89.58210825920105, 93.3457305431366, 97.1801598072052, 100.92405819892883, 104.68892359733582, 108.43754148483276, 112.18788933753967, 115.92762899398804, 119.7099118232727, 123.47491145133972, 127.25826239585876, 131.04614353179932, 134.82837843894958, 138.61392068862915, 142.4030318260193, 146.16804337501526, 149.94824194908142, 153.72533178329468, 157.50313186645508, 161.26021766662598, 165.00851845741272, 168.75093030929565, 172.49765753746033, 176.2730827331543, 180.03772711753845, 183.78919792175293, 187.60798931121826, 191.3652229309082, 195.12936425209045, 198.9122452735901, 202.68940091133118, 206.46234583854675, 210.20583391189575, 213.98906016349792, 217.7743434906006, 221.55407238006592, 225.33168268203735, 229.11226630210876, 232.89681267738342, 236.68113207817078, 240.4579827785492, 244.2054409980774, 247.9883017539978, 251.767511844635, 255.54978489875793, 259.39344024658203, 263.1735942363739, 266.95082807540894, 270.7363781929016, 274.49727964401245, 278.27455949783325, 282.0517690181732, 285.83145403862, 289.6139597892761, 293.3928632736206, 297.14218163490295, 300.89586544036865, 304.67059564590454, 308.44701385498047, 312.28774762153625, 316.0687565803528, 319.8580503463745, 323.63558077812195, 327.4058895111084, 331.182758808136, 334.9556813240051, 338.7372658252716, 342.58256006240845, 346.3531472682953, 350.0666480064392]
[38.51, 45.49, 53.54, 59.0, 61.22, 61.99, 63.33, 64.48, 66.5, 68.18, 68.32, 67.85, 68.66, 69.33, 70.75, 71.25, 70.83, 70.44, 71.98, 72.28, 72.95, 72.4, 73.07, 73.37, 73.44, 73.36, 74.2, 74.45, 73.85, 74.9, 74.52, 74.74, 74.81, 74.13, 74.01, 74.9, 75.0, 75.64, 74.92, 75.06, 75.04, 74.61, 73.97, 74.14, 74.29, 74.88, 74.69, 75.2, 75.27, 75.39, 75.38, 75.3, 75.38, 75.08, 75.86, 75.79, 76.68, 76.37, 75.96, 76.07, 75.55, 75.51, 74.85, 76.04, 76.49, 76.16, 75.89, 75.92, 76.05, 75.51, 76.12, 75.94, 75.85, 75.0, 75.64, 75.81, 75.59, 76.01, 76.17, 76.15, 76.33, 76.22, 76.12, 75.85, 75.94, 75.87, 76.38, 76.37, 76.02, 75.89, 76.43, 76.96, 76.3, 76.41, 76.13, 76.32, 76.73, 76.46, 76.39, 76.23, 76.82]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.744, Test loss: 2.102, Test accuracy: 22.65
Round   0, Global train loss: 1.744, Global test loss: 2.287, Global test accuracy: 20.46
Round   1, Train loss: 1.658, Test loss: 1.909, Test accuracy: 25.31
Round   1, Global train loss: 1.658, Global test loss: 2.256, Global test accuracy: 16.66
Round   2, Train loss: 1.591, Test loss: 1.640, Test accuracy: 36.55
Round   2, Global train loss: 1.591, Global test loss: 2.074, Global test accuracy: 29.30
Round   3, Train loss: 1.550, Test loss: 1.595, Test accuracy: 35.84
Round   3, Global train loss: 1.550, Global test loss: 2.171, Global test accuracy: 19.07
Round   4, Train loss: 1.600, Test loss: 1.485, Test accuracy: 39.20
Round   4, Global train loss: 1.600, Global test loss: 2.107, Global test accuracy: 24.05
Round   5, Train loss: 1.542, Test loss: 1.503, Test accuracy: 41.10
Round   5, Global train loss: 1.542, Global test loss: 2.283, Global test accuracy: 27.17
Round   6, Train loss: 1.489, Test loss: 1.412, Test accuracy: 44.18
Round   6, Global train loss: 1.489, Global test loss: 2.154, Global test accuracy: 24.36
Round   7, Train loss: 1.531, Test loss: 1.403, Test accuracy: 44.44
Round   7, Global train loss: 1.531, Global test loss: 2.209, Global test accuracy: 23.13
Round   8, Train loss: 1.424, Test loss: 1.371, Test accuracy: 46.12
Round   8, Global train loss: 1.424, Global test loss: 2.110, Global test accuracy: 30.05
Round   9, Train loss: 1.458, Test loss: 1.370, Test accuracy: 44.74
Round   9, Global train loss: 1.458, Global test loss: 2.229, Global test accuracy: 19.21
Round  10, Train loss: 1.413, Test loss: 1.346, Test accuracy: 46.96
Round  10, Global train loss: 1.413, Global test loss: 2.125, Global test accuracy: 28.60
Round  11, Train loss: 1.370, Test loss: 1.325, Test accuracy: 46.98
Round  11, Global train loss: 1.370, Global test loss: 2.140, Global test accuracy: 28.20
Round  12, Train loss: 1.454, Test loss: 1.333, Test accuracy: 47.61
Round  12, Global train loss: 1.454, Global test loss: 2.109, Global test accuracy: 23.11
Round  13, Train loss: 1.364, Test loss: 1.294, Test accuracy: 48.94
Round  13, Global train loss: 1.364, Global test loss: 2.129, Global test accuracy: 24.04
Round  14, Train loss: 1.354, Test loss: 1.292, Test accuracy: 49.04
Round  14, Global train loss: 1.354, Global test loss: 2.108, Global test accuracy: 23.27
Round  15, Train loss: 1.453, Test loss: 1.283, Test accuracy: 49.96
Round  15, Global train loss: 1.453, Global test loss: 2.169, Global test accuracy: 25.25
Round  16, Train loss: 1.260, Test loss: 1.269, Test accuracy: 50.91
Round  16, Global train loss: 1.260, Global test loss: 2.276, Global test accuracy: 21.99
Round  17, Train loss: 1.298, Test loss: 1.255, Test accuracy: 51.70
Round  17, Global train loss: 1.298, Global test loss: 2.110, Global test accuracy: 24.56
Round  18, Train loss: 1.256, Test loss: 1.246, Test accuracy: 51.91
Round  18, Global train loss: 1.256, Global test loss: 2.008, Global test accuracy: 32.60
Round  19, Train loss: 1.224, Test loss: 1.256, Test accuracy: 52.01
Round  19, Global train loss: 1.224, Global test loss: 2.067, Global test accuracy: 29.02
Round  20, Train loss: 1.275, Test loss: 1.253, Test accuracy: 52.05
Round  20, Global train loss: 1.275, Global test loss: 2.145, Global test accuracy: 26.78
Round  21, Train loss: 1.322, Test loss: 1.252, Test accuracy: 52.16
Round  21, Global train loss: 1.322, Global test loss: 2.155, Global test accuracy: 24.63
Round  22, Train loss: 1.324, Test loss: 1.254, Test accuracy: 51.61
Round  22, Global train loss: 1.324, Global test loss: 2.133, Global test accuracy: 23.64
Round  23, Train loss: 1.162, Test loss: 1.255, Test accuracy: 51.94
Round  23, Global train loss: 1.162, Global test loss: 2.002, Global test accuracy: 29.56
Round  24, Train loss: 1.241, Test loss: 1.258, Test accuracy: 51.66
Round  24, Global train loss: 1.241, Global test loss: 2.003, Global test accuracy: 31.83
Round  25, Train loss: 1.205, Test loss: 1.274, Test accuracy: 51.41
Round  25, Global train loss: 1.205, Global test loss: 2.070, Global test accuracy: 33.94
Round  26, Train loss: 1.222, Test loss: 1.281, Test accuracy: 51.36
Round  26, Global train loss: 1.222, Global test loss: 2.123, Global test accuracy: 21.33
Round  27, Train loss: 1.162, Test loss: 1.282, Test accuracy: 51.91
Round  27, Global train loss: 1.162, Global test loss: 2.004, Global test accuracy: 30.79
Round  28, Train loss: 0.973, Test loss: 1.289, Test accuracy: 51.82
Round  28, Global train loss: 0.973, Global test loss: 1.933, Global test accuracy: 30.44
Round  29, Train loss: 1.132, Test loss: 1.298, Test accuracy: 51.88
Round  29, Global train loss: 1.132, Global test loss: 2.082, Global test accuracy: 28.02
Round  30, Train loss: 1.081, Test loss: 1.302, Test accuracy: 51.94
Round  30, Global train loss: 1.081, Global test loss: 1.985, Global test accuracy: 32.76
Round  31, Train loss: 1.021, Test loss: 1.290, Test accuracy: 52.41
Round  31, Global train loss: 1.021, Global test loss: 1.981, Global test accuracy: 29.46
Round  32, Train loss: 1.117, Test loss: 1.302, Test accuracy: 51.87
Round  32, Global train loss: 1.117, Global test loss: 2.037, Global test accuracy: 29.89
Round  33, Train loss: 1.090, Test loss: 1.317, Test accuracy: 51.51
Round  33, Global train loss: 1.090, Global test loss: 2.135, Global test accuracy: 24.55
Round  34, Train loss: 1.012, Test loss: 1.368, Test accuracy: 50.15
Round  34, Global train loss: 1.012, Global test loss: 2.193, Global test accuracy: 27.76
Round  35, Train loss: 0.863, Test loss: 1.390, Test accuracy: 50.19
Round  35, Global train loss: 0.863, Global test loss: 2.148, Global test accuracy: 31.62
Round  36, Train loss: 0.845, Test loss: 1.397, Test accuracy: 50.22
Round  36, Global train loss: 0.845, Global test loss: 2.166, Global test accuracy: 24.67
Round  37, Train loss: 0.971, Test loss: 1.404, Test accuracy: 50.53
Round  37, Global train loss: 0.971, Global test loss: 2.103, Global test accuracy: 27.14
Round  38, Train loss: 1.032, Test loss: 1.431, Test accuracy: 49.94
Round  38, Global train loss: 1.032, Global test loss: 2.162, Global test accuracy: 27.84
Round  39, Train loss: 0.934, Test loss: 1.437, Test accuracy: 50.20
Round  39, Global train loss: 0.934, Global test loss: 2.210, Global test accuracy: 27.46
Round  40, Train loss: 0.867, Test loss: 1.450, Test accuracy: 50.52
Round  40, Global train loss: 0.867, Global test loss: 1.995, Global test accuracy: 34.04
Round  41, Train loss: 0.789, Test loss: 1.478, Test accuracy: 50.22
Round  41, Global train loss: 0.789, Global test loss: 2.033, Global test accuracy: 25.53
Round  42, Train loss: 0.786, Test loss: 1.486, Test accuracy: 50.35
Round  42, Global train loss: 0.786, Global test loss: 1.976, Global test accuracy: 30.05
Round  43, Train loss: 0.955, Test loss: 1.544, Test accuracy: 49.13
Round  43, Global train loss: 0.955, Global test loss: 2.140, Global test accuracy: 20.37
Round  44, Train loss: 0.720, Test loss: 1.542, Test accuracy: 49.73
Round  44, Global train loss: 0.720, Global test loss: 2.097, Global test accuracy: 29.15
Round  45, Train loss: 0.722, Test loss: 1.576, Test accuracy: 49.43
Round  45, Global train loss: 0.722, Global test loss: 2.041, Global test accuracy: 28.96
Round  46, Train loss: 0.730, Test loss: 1.575, Test accuracy: 49.74
Round  46, Global train loss: 0.730, Global test loss: 2.058, Global test accuracy: 26.52
Round  47, Train loss: 0.907, Test loss: 1.590, Test accuracy: 49.31
Round  47, Global train loss: 0.907, Global test loss: 2.114, Global test accuracy: 25.62
Round  48, Train loss: 0.814, Test loss: 1.612, Test accuracy: 48.99
Round  48, Global train loss: 0.814, Global test loss: 2.031, Global test accuracy: 25.33
Round  49, Train loss: 0.821, Test loss: 1.662, Test accuracy: 47.97
Round  49, Global train loss: 0.821, Global test loss: 2.079, Global test accuracy: 27.85
Round  50, Train loss: 0.739, Test loss: 1.687, Test accuracy: 48.16
Round  50, Global train loss: 0.739, Global test loss: 2.092, Global test accuracy: 26.80
Round  51, Train loss: 0.618, Test loss: 1.690, Test accuracy: 48.42
Round  51, Global train loss: 0.618, Global test loss: 2.045, Global test accuracy: 25.60
Round  52, Train loss: 0.727, Test loss: 1.719, Test accuracy: 47.97
Round  52, Global train loss: 0.727, Global test loss: 1.936, Global test accuracy: 34.35
Round  53, Train loss: 0.674, Test loss: 1.741, Test accuracy: 48.53
Round  53, Global train loss: 0.674, Global test loss: 2.108, Global test accuracy: 27.25
Round  54, Train loss: 0.714, Test loss: 1.775, Test accuracy: 48.12
Round  54, Global train loss: 0.714, Global test loss: 2.124, Global test accuracy: 25.96
Round  55, Train loss: 0.759, Test loss: 1.808, Test accuracy: 47.51
Round  55, Global train loss: 0.759, Global test loss: 2.106, Global test accuracy: 27.30
Round  56, Train loss: 0.606, Test loss: 1.832, Test accuracy: 48.29
Round  56, Global train loss: 0.606, Global test loss: 2.251, Global test accuracy: 20.55
Round  57, Train loss: 0.526, Test loss: 1.840, Test accuracy: 48.01
Round  57, Global train loss: 0.526, Global test loss: 2.101, Global test accuracy: 24.23
Round  58, Train loss: 0.483, Test loss: 1.884, Test accuracy: 48.43
Round  58, Global train loss: 0.483, Global test loss: 1.979, Global test accuracy: 33.87
Round  59, Train loss: 0.433, Test loss: 1.918, Test accuracy: 48.27
Round  59, Global train loss: 0.433, Global test loss: 2.039, Global test accuracy: 29.87
Round  60, Train loss: 0.719, Test loss: 1.947, Test accuracy: 47.88
Round  60, Global train loss: 0.719, Global test loss: 2.151, Global test accuracy: 25.86
Round  61, Train loss: 0.474, Test loss: 1.973, Test accuracy: 47.27
Round  61, Global train loss: 0.474, Global test loss: 2.163, Global test accuracy: 18.06
Round  62, Train loss: 0.538, Test loss: 1.983, Test accuracy: 47.38
Round  62, Global train loss: 0.538, Global test loss: 2.078, Global test accuracy: 29.05
Round  63, Train loss: 0.499, Test loss: 1.994, Test accuracy: 47.72
Round  63, Global train loss: 0.499, Global test loss: 1.944, Global test accuracy: 32.75
Round  64, Train loss: 0.481, Test loss: 2.033, Test accuracy: 47.42
Round  64, Global train loss: 0.481, Global test loss: 2.023, Global test accuracy: 29.04
Round  65, Train loss: 0.487, Test loss: 2.025, Test accuracy: 48.00
Round  65, Global train loss: 0.487, Global test loss: 2.007, Global test accuracy: 26.81
Round  66, Train loss: 0.520, Test loss: 2.063, Test accuracy: 47.88
Round  66, Global train loss: 0.520, Global test loss: 2.006, Global test accuracy: 29.90
Round  67, Train loss: 0.555, Test loss: 2.084, Test accuracy: 48.52
Round  67, Global train loss: 0.555, Global test loss: 2.142, Global test accuracy: 26.41
Round  68, Train loss: 0.362, Test loss: 2.141, Test accuracy: 48.66
Round  68, Global train loss: 0.362, Global test loss: 1.982, Global test accuracy: 28.47
Round  69, Train loss: 0.498, Test loss: 2.121, Test accuracy: 48.95
Round  69, Global train loss: 0.498, Global test loss: 2.044, Global test accuracy: 27.94
Round  70, Train loss: 0.387, Test loss: 2.147, Test accuracy: 49.30
Round  70, Global train loss: 0.387, Global test loss: 2.247, Global test accuracy: 20.57
Round  71, Train loss: 0.400, Test loss: 2.124, Test accuracy: 49.61
Round  71, Global train loss: 0.400, Global test loss: 2.137, Global test accuracy: 24.64
Round  72, Train loss: 0.371, Test loss: 2.133, Test accuracy: 48.85
Round  72, Global train loss: 0.371, Global test loss: 2.095, Global test accuracy: 22.70
Round  73, Train loss: 0.337, Test loss: 2.173, Test accuracy: 49.05
Round  73, Global train loss: 0.337, Global test loss: 2.023, Global test accuracy: 31.34
Round  74, Train loss: 0.348, Test loss: 2.267, Test accuracy: 48.30
Round  74, Global train loss: 0.348, Global test loss: 2.018, Global test accuracy: 30.60
Round  75, Train loss: 0.399, Test loss: 2.290, Test accuracy: 48.50
Round  75, Global train loss: 0.399, Global test loss: 2.188, Global test accuracy: 18.74
Round  76, Train loss: 0.355, Test loss: 2.286, Test accuracy: 48.08
Round  76, Global train loss: 0.355, Global test loss: 2.100, Global test accuracy: 24.19
Round  77, Train loss: 0.328, Test loss: 2.296, Test accuracy: 48.26
Round  77, Global train loss: 0.328, Global test loss: 2.099, Global test accuracy: 24.25
Round  78, Train loss: 0.275, Test loss: 2.305, Test accuracy: 48.55
Round  78, Global train loss: 0.275, Global test loss: 2.091, Global test accuracy: 24.67
Round  79, Train loss: 0.352, Test loss: 2.449, Test accuracy: 47.51
Round  79, Global train loss: 0.352, Global test loss: 2.161, Global test accuracy: 21.22
Round  80, Train loss: 0.303, Test loss: 2.501, Test accuracy: 46.97
Round  80, Global train loss: 0.303, Global test loss: 1.945, Global test accuracy: 32.17
Round  81, Train loss: 0.339, Test loss: 2.546, Test accuracy: 46.96
Round  81, Global train loss: 0.339, Global test loss: 2.132, Global test accuracy: 18.77
Round  82, Train loss: 0.341, Test loss: 2.544, Test accuracy: 46.92
Round  82, Global train loss: 0.341, Global test loss: 2.055, Global test accuracy: 31.15
Round  83, Train loss: 0.392, Test loss: 2.569, Test accuracy: 47.33
Round  83, Global train loss: 0.392, Global test loss: 2.177, Global test accuracy: 24.85
Round  84, Train loss: 0.268, Test loss: 2.599, Test accuracy: 47.07
Round  84, Global train loss: 0.268, Global test loss: 2.180, Global test accuracy: 22.99
Round  85, Train loss: 0.232, Test loss: 2.603, Test accuracy: 47.86
Round  85, Global train loss: 0.232, Global test loss: 2.094, Global test accuracy: 26.28
Round  86, Train loss: 0.264, Test loss: 2.589, Test accuracy: 48.15
Round  86, Global train loss: 0.264, Global test loss: 2.050, Global test accuracy: 28.81
Round  87, Train loss: 0.267, Test loss: 2.624, Test accuracy: 47.80
Round  87, Global train loss: 0.267, Global test loss: 2.151, Global test accuracy: 21.94
Round  88, Train loss: 0.327, Test loss: 2.716, Test accuracy: 47.80
Round  88, Global train loss: 0.327, Global test loss: 2.226, Global test accuracy: 23.95
Round  89, Train loss: 0.221, Test loss: 2.760, Test accuracy: 47.82
Round  89, Global train loss: 0.221, Global test loss: 2.034, Global test accuracy: 30.88
Round  90, Train loss: 0.312, Test loss: 2.735, Test accuracy: 48.03
Round  90, Global train loss: 0.312, Global test loss: 2.065, Global test accuracy: 25.62
Round  91, Train loss: 0.220, Test loss: 2.711, Test accuracy: 48.24
Round  91, Global train loss: 0.220, Global test loss: 2.045, Global test accuracy: 29.87
Round  92, Train loss: 0.262, Test loss: 2.645, Test accuracy: 48.07
Round  92, Global train loss: 0.262, Global test loss: 2.020, Global test accuracy: 28.59
Round  93, Train loss: 0.265, Test loss: 2.663, Test accuracy: 47.22
Round  93, Global train loss: 0.265, Global test loss: 2.074, Global test accuracy: 24.62
Round  94, Train loss: 0.272, Test loss: 2.648, Test accuracy: 47.56
Round  94, Global train loss: 0.272, Global test loss: 2.081, Global test accuracy: 27.30
Round  95, Train loss: 0.246, Test loss: 2.698, Test accuracy: 47.27
Round  95, Global train loss: 0.246, Global test loss: 2.000, Global test accuracy: 29.42
Round  96, Train loss: 0.239, Test loss: 2.720, Test accuracy: 46.92
Round  96, Global train loss: 0.239, Global test loss: 2.097, Global test accuracy: 28.97
Round  97, Train loss: 0.263, Test loss: 2.746, Test accuracy: 46.83
Round  97, Global train loss: 0.263, Global test loss: 1.999, Global test accuracy: 29.17
Round  98, Train loss: 0.274, Test loss: 2.795, Test accuracy: 46.74
Round  98, Global train loss: 0.274, Global test loss: 1.990, Global test accuracy: 26.64
Round  99, Train loss: 0.191, Test loss: 2.814, Test accuracy: 46.99
Round  99, Global train loss: 0.191, Global test loss: 2.275, Global test accuracy: 19.52
Final Round, Train loss: 0.199, Test loss: 2.918, Test accuracy: 47.61
Final Round, Global train loss: 0.199, Global test loss: 2.275, Global test accuracy: 19.52
Average accuracy final 10 rounds: 47.387 

Average global accuracy final 10 rounds: 26.972 

1280.3142356872559
[1.3510768413543701, 2.7021536827087402, 3.826249837875366, 4.950345993041992, 6.0811872482299805, 7.212028503417969, 8.337809324264526, 9.463590145111084, 10.578938007354736, 11.694285869598389, 12.816796064376831, 13.939306259155273, 15.077970504760742, 16.21663475036621, 17.35210156440735, 18.487568378448486, 19.62326979637146, 20.758971214294434, 21.902185916900635, 23.045400619506836, 24.187101364135742, 25.32880210876465, 26.467761754989624, 27.6067214012146, 28.74856686592102, 29.89041233062744, 31.02961277961731, 32.16881322860718, 33.303157806396484, 34.43750238418579, 35.57063150405884, 36.703760623931885, 37.83788347244263, 38.97200632095337, 40.10467481613159, 41.237343311309814, 42.37400007247925, 43.51065683364868, 44.64619708061218, 45.781737327575684, 46.92019200325012, 48.05864667892456, 49.01629304885864, 49.973939418792725, 50.935402393341064, 51.896865367889404, 52.85943651199341, 53.82200765609741, 54.78290891647339, 55.743810176849365, 56.70291090011597, 57.66201162338257, 58.62029790878296, 59.57858419418335, 60.537970304489136, 61.49735641479492, 62.45530962944031, 63.41326284408569, 64.370774269104, 65.32828569412231, 66.28485536575317, 67.24142503738403, 68.19843626022339, 69.15544748306274, 70.1111888885498, 71.06693029403687, 72.02427864074707, 72.98162698745728, 73.93950986862183, 74.89739274978638, 75.85658383369446, 76.81577491760254, 77.77142977714539, 78.72708463668823, 79.68226361274719, 80.63744258880615, 81.5916678905487, 82.54589319229126, 83.50477242469788, 84.46365165710449, 85.41910743713379, 86.37456321716309, 87.33056855201721, 88.28657388687134, 89.24450373649597, 90.2024335861206, 91.16116881370544, 92.11990404129028, 93.07841181755066, 94.03691959381104, 94.99528431892395, 95.95364904403687, 96.90915870666504, 97.86466836929321, 98.82236170768738, 99.78005504608154, 100.73525881767273, 101.69046258926392, 102.64691996574402, 103.60337734222412, 104.56293535232544, 105.52249336242676, 106.48063564300537, 107.43877792358398, 108.3979287147522, 109.35707950592041, 110.31450390815735, 111.27192831039429, 112.2289776802063, 113.18602705001831, 114.14540576934814, 115.10478448867798, 116.06846690177917, 117.03214931488037, 117.99389600753784, 118.95564270019531, 119.91805219650269, 120.88046169281006, 121.83848905563354, 122.79651641845703, 123.75373220443726, 124.71094799041748, 125.67000436782837, 126.62906074523926, 127.58886170387268, 128.5486626625061, 129.5079870223999, 130.4673113822937, 131.4293122291565, 132.3913130760193, 133.35308265686035, 134.31485223770142, 135.27647161483765, 136.23809099197388, 137.19740176200867, 138.15671253204346, 139.11723923683167, 140.07776594161987, 141.03805804252625, 141.99835014343262, 142.95878958702087, 143.91922903060913, 144.8808515071869, 145.84247398376465, 146.8053286075592, 147.76818323135376, 148.73104977607727, 149.69391632080078, 150.65579533576965, 151.61767435073853, 152.57548928260803, 153.53330421447754, 154.4919137954712, 155.45052337646484, 156.41141510009766, 157.37230682373047, 158.3346118927002, 159.29691696166992, 160.25621700286865, 161.21551704406738, 162.17445039749146, 163.13338375091553, 164.09272575378418, 165.05206775665283, 166.01109528541565, 166.97012281417847, 167.93179893493652, 168.89347505569458, 169.85308527946472, 170.81269550323486, 171.77093958854675, 172.72918367385864, 173.69073629379272, 174.6522889137268, 175.61195302009583, 176.57161712646484, 177.53102564811707, 178.4904341697693, 179.45091342926025, 180.41139268875122, 181.37071919441223, 182.33004570007324, 183.29186129570007, 184.2536768913269, 185.21459484100342, 186.17551279067993, 187.13434839248657, 188.0931839942932, 189.05009388923645, 190.0070037841797, 190.96682405471802, 191.92664432525635, 192.88636994361877, 193.8460955619812, 194.80785703659058, 195.76961851119995, 196.7284746170044, 197.68733072280884, 198.64681887626648, 199.60630702972412, 201.52171444892883, 203.43712186813354]
[22.65, 22.65, 25.31, 25.31, 36.55, 36.55, 35.84, 35.84, 39.2, 39.2, 41.1, 41.1, 44.18, 44.18, 44.44, 44.44, 46.12, 46.12, 44.74, 44.74, 46.96, 46.96, 46.98, 46.98, 47.61, 47.61, 48.94, 48.94, 49.04, 49.04, 49.96, 49.96, 50.91, 50.91, 51.7, 51.7, 51.91, 51.91, 52.01, 52.01, 52.05, 52.05, 52.16, 52.16, 51.61, 51.61, 51.94, 51.94, 51.66, 51.66, 51.41, 51.41, 51.36, 51.36, 51.91, 51.91, 51.82, 51.82, 51.88, 51.88, 51.94, 51.94, 52.41, 52.41, 51.87, 51.87, 51.51, 51.51, 50.15, 50.15, 50.19, 50.19, 50.22, 50.22, 50.53, 50.53, 49.94, 49.94, 50.2, 50.2, 50.52, 50.52, 50.22, 50.22, 50.35, 50.35, 49.13, 49.13, 49.73, 49.73, 49.43, 49.43, 49.74, 49.74, 49.31, 49.31, 48.99, 48.99, 47.97, 47.97, 48.16, 48.16, 48.42, 48.42, 47.97, 47.97, 48.53, 48.53, 48.12, 48.12, 47.51, 47.51, 48.29, 48.29, 48.01, 48.01, 48.43, 48.43, 48.27, 48.27, 47.88, 47.88, 47.27, 47.27, 47.38, 47.38, 47.72, 47.72, 47.42, 47.42, 48.0, 48.0, 47.88, 47.88, 48.52, 48.52, 48.66, 48.66, 48.95, 48.95, 49.3, 49.3, 49.61, 49.61, 48.85, 48.85, 49.05, 49.05, 48.3, 48.3, 48.5, 48.5, 48.08, 48.08, 48.26, 48.26, 48.55, 48.55, 47.51, 47.51, 46.97, 46.97, 46.96, 46.96, 46.92, 46.92, 47.33, 47.33, 47.07, 47.07, 47.86, 47.86, 48.15, 48.15, 47.8, 47.8, 47.8, 47.8, 47.82, 47.82, 48.03, 48.03, 48.24, 48.24, 48.07, 48.07, 47.22, 47.22, 47.56, 47.56, 47.27, 47.27, 46.92, 46.92, 46.83, 46.83, 46.74, 46.74, 46.99, 46.99, 47.61, 47.61]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.733, Test loss: 2.044, Test accuracy: 27.51
Round   0, Global train loss: 1.733, Global test loss: 2.228, Global test accuracy: 24.50
Round   1, Train loss: 1.484, Test loss: 1.810, Test accuracy: 30.74
Round   1, Global train loss: 1.484, Global test loss: 2.110, Global test accuracy: 23.73
Round   2, Train loss: 1.382, Test loss: 1.536, Test accuracy: 41.51
Round   2, Global train loss: 1.382, Global test loss: 1.917, Global test accuracy: 32.07
Round   3, Train loss: 1.346, Test loss: 1.412, Test accuracy: 44.69
Round   3, Global train loss: 1.346, Global test loss: 1.872, Global test accuracy: 31.57
Round   4, Train loss: 1.251, Test loss: 1.284, Test accuracy: 49.05
Round   4, Global train loss: 1.251, Global test loss: 1.792, Global test accuracy: 35.99
Round   5, Train loss: 1.239, Test loss: 1.226, Test accuracy: 52.63
Round   5, Global train loss: 1.239, Global test loss: 1.802, Global test accuracy: 35.93
Round   6, Train loss: 1.264, Test loss: 1.179, Test accuracy: 55.10
Round   6, Global train loss: 1.264, Global test loss: 1.682, Global test accuracy: 36.90
Round   7, Train loss: 1.184, Test loss: 1.169, Test accuracy: 55.32
Round   7, Global train loss: 1.184, Global test loss: 1.750, Global test accuracy: 38.03
Round   8, Train loss: 1.148, Test loss: 1.128, Test accuracy: 56.38
Round   8, Global train loss: 1.148, Global test loss: 1.772, Global test accuracy: 36.39
Round   9, Train loss: 1.117, Test loss: 1.141, Test accuracy: 55.81
Round   9, Global train loss: 1.117, Global test loss: 1.804, Global test accuracy: 34.72
Round  10, Train loss: 1.159, Test loss: 1.093, Test accuracy: 58.43
Round  10, Global train loss: 1.159, Global test loss: 1.536, Global test accuracy: 44.08
Round  11, Train loss: 1.034, Test loss: 1.061, Test accuracy: 59.77
Round  11, Global train loss: 1.034, Global test loss: 1.488, Global test accuracy: 46.75
Round  12, Train loss: 1.102, Test loss: 1.072, Test accuracy: 59.85
Round  12, Global train loss: 1.102, Global test loss: 1.564, Global test accuracy: 42.93
Round  13, Train loss: 1.109, Test loss: 1.044, Test accuracy: 60.82
Round  13, Global train loss: 1.109, Global test loss: 1.503, Global test accuracy: 49.28
Round  14, Train loss: 1.006, Test loss: 1.030, Test accuracy: 61.40
Round  14, Global train loss: 1.006, Global test loss: 1.598, Global test accuracy: 43.30
Round  15, Train loss: 1.088, Test loss: 1.022, Test accuracy: 61.62
Round  15, Global train loss: 1.088, Global test loss: 1.502, Global test accuracy: 46.45
Round  16, Train loss: 0.998, Test loss: 0.985, Test accuracy: 63.47
Round  16, Global train loss: 0.998, Global test loss: 1.523, Global test accuracy: 44.83
Round  17, Train loss: 0.976, Test loss: 0.968, Test accuracy: 64.33
Round  17, Global train loss: 0.976, Global test loss: 1.475, Global test accuracy: 46.66
Round  18, Train loss: 0.938, Test loss: 0.957, Test accuracy: 65.02
Round  18, Global train loss: 0.938, Global test loss: 1.392, Global test accuracy: 50.60
Round  19, Train loss: 0.933, Test loss: 0.955, Test accuracy: 65.09
Round  19, Global train loss: 0.933, Global test loss: 1.443, Global test accuracy: 48.55
Round  20, Train loss: 1.008, Test loss: 0.945, Test accuracy: 65.43
Round  20, Global train loss: 1.008, Global test loss: 1.411, Global test accuracy: 50.03
Round  21, Train loss: 0.885, Test loss: 0.949, Test accuracy: 65.60
Round  21, Global train loss: 0.885, Global test loss: 1.484, Global test accuracy: 48.28
Round  22, Train loss: 0.984, Test loss: 0.980, Test accuracy: 64.68
Round  22, Global train loss: 0.984, Global test loss: 1.445, Global test accuracy: 48.52
Round  23, Train loss: 0.862, Test loss: 0.958, Test accuracy: 65.98
Round  23, Global train loss: 0.862, Global test loss: 1.376, Global test accuracy: 51.31
Round  24, Train loss: 0.887, Test loss: 0.944, Test accuracy: 66.14
Round  24, Global train loss: 0.887, Global test loss: 1.301, Global test accuracy: 53.88
Round  25, Train loss: 0.737, Test loss: 0.915, Test accuracy: 67.12
Round  25, Global train loss: 0.737, Global test loss: 1.309, Global test accuracy: 55.48
Round  26, Train loss: 0.755, Test loss: 0.918, Test accuracy: 67.03
Round  26, Global train loss: 0.755, Global test loss: 1.245, Global test accuracy: 56.05
Round  27, Train loss: 0.826, Test loss: 0.913, Test accuracy: 67.05
Round  27, Global train loss: 0.826, Global test loss: 1.233, Global test accuracy: 56.07
Round  28, Train loss: 0.776, Test loss: 0.934, Test accuracy: 66.51
Round  28, Global train loss: 0.776, Global test loss: 1.284, Global test accuracy: 54.53
Round  29, Train loss: 0.756, Test loss: 0.937, Test accuracy: 66.62
Round  29, Global train loss: 0.756, Global test loss: 1.343, Global test accuracy: 53.51
Round  30, Train loss: 0.807, Test loss: 0.922, Test accuracy: 67.48
Round  30, Global train loss: 0.807, Global test loss: 1.330, Global test accuracy: 53.83
Round  31, Train loss: 0.765, Test loss: 0.908, Test accuracy: 68.00
Round  31, Global train loss: 0.765, Global test loss: 1.274, Global test accuracy: 55.31
Round  32, Train loss: 0.915, Test loss: 0.902, Test accuracy: 68.67
Round  32, Global train loss: 0.915, Global test loss: 1.255, Global test accuracy: 55.73
Round  33, Train loss: 0.750, Test loss: 0.903, Test accuracy: 68.69
Round  33, Global train loss: 0.750, Global test loss: 1.369, Global test accuracy: 52.22
Round  34, Train loss: 0.654, Test loss: 0.918, Test accuracy: 68.40
Round  34, Global train loss: 0.654, Global test loss: 1.455, Global test accuracy: 52.39
Round  35, Train loss: 0.768, Test loss: 0.922, Test accuracy: 68.40
Round  35, Global train loss: 0.768, Global test loss: 1.317, Global test accuracy: 53.67
Round  36, Train loss: 0.697, Test loss: 0.925, Test accuracy: 68.16
Round  36, Global train loss: 0.697, Global test loss: 1.378, Global test accuracy: 53.38
Round  37, Train loss: 0.662, Test loss: 0.899, Test accuracy: 69.00
Round  37, Global train loss: 0.662, Global test loss: 1.292, Global test accuracy: 55.84
Round  38, Train loss: 0.869, Test loss: 0.903, Test accuracy: 68.60
Round  38, Global train loss: 0.869, Global test loss: 1.403, Global test accuracy: 54.04
Round  39, Train loss: 0.654, Test loss: 0.917, Test accuracy: 68.24
Round  39, Global train loss: 0.654, Global test loss: 1.373, Global test accuracy: 53.22
Round  40, Train loss: 0.629, Test loss: 0.922, Test accuracy: 68.23
Round  40, Global train loss: 0.629, Global test loss: 1.285, Global test accuracy: 57.75
Round  41, Train loss: 0.727, Test loss: 0.923, Test accuracy: 68.22
Round  41, Global train loss: 0.727, Global test loss: 1.176, Global test accuracy: 59.07
Round  42, Train loss: 0.642, Test loss: 0.916, Test accuracy: 68.69
Round  42, Global train loss: 0.642, Global test loss: 1.254, Global test accuracy: 57.19
Round  43, Train loss: 0.688, Test loss: 0.903, Test accuracy: 69.07
Round  43, Global train loss: 0.688, Global test loss: 1.296, Global test accuracy: 55.62
Round  44, Train loss: 0.603, Test loss: 0.905, Test accuracy: 69.12
Round  44, Global train loss: 0.603, Global test loss: 1.365, Global test accuracy: 57.37
Round  45, Train loss: 0.685, Test loss: 0.901, Test accuracy: 69.25
Round  45, Global train loss: 0.685, Global test loss: 1.177, Global test accuracy: 59.63
Round  46, Train loss: 0.698, Test loss: 0.918, Test accuracy: 69.07
Round  46, Global train loss: 0.698, Global test loss: 1.256, Global test accuracy: 56.67
Round  47, Train loss: 0.763, Test loss: 0.931, Test accuracy: 68.82
Round  47, Global train loss: 0.763, Global test loss: 1.187, Global test accuracy: 59.14
Round  48, Train loss: 0.708, Test loss: 0.910, Test accuracy: 69.67
Round  48, Global train loss: 0.708, Global test loss: 1.247, Global test accuracy: 57.02
Round  49, Train loss: 0.654, Test loss: 0.924, Test accuracy: 69.23
Round  49, Global train loss: 0.654, Global test loss: 1.235, Global test accuracy: 56.53
Round  50, Train loss: 0.671, Test loss: 0.922, Test accuracy: 69.14
Round  50, Global train loss: 0.671, Global test loss: 1.205, Global test accuracy: 59.15
Round  51, Train loss: 0.538, Test loss: 0.945, Test accuracy: 68.47
Round  51, Global train loss: 0.538, Global test loss: 1.185, Global test accuracy: 60.05
Round  52, Train loss: 0.658, Test loss: 0.923, Test accuracy: 69.22
Round  52, Global train loss: 0.658, Global test loss: 1.233, Global test accuracy: 58.49
Round  53, Train loss: 0.677, Test loss: 0.919, Test accuracy: 69.60
Round  53, Global train loss: 0.677, Global test loss: 1.315, Global test accuracy: 56.54
Round  54, Train loss: 0.651, Test loss: 0.927, Test accuracy: 69.63
Round  54, Global train loss: 0.651, Global test loss: 1.275, Global test accuracy: 56.76
Round  55, Train loss: 0.580, Test loss: 0.948, Test accuracy: 69.49
Round  55, Global train loss: 0.580, Global test loss: 1.256, Global test accuracy: 58.13
Round  56, Train loss: 0.573, Test loss: 0.979, Test accuracy: 68.81
Round  56, Global train loss: 0.573, Global test loss: 1.424, Global test accuracy: 54.70
Round  57, Train loss: 0.636, Test loss: 0.964, Test accuracy: 69.60
Round  57, Global train loss: 0.636, Global test loss: 1.354, Global test accuracy: 56.53
Round  58, Train loss: 0.604, Test loss: 0.963, Test accuracy: 69.77
Round  58, Global train loss: 0.604, Global test loss: 1.247, Global test accuracy: 58.73
Round  59, Train loss: 0.559, Test loss: 0.965, Test accuracy: 69.57
Round  59, Global train loss: 0.559, Global test loss: 1.163, Global test accuracy: 61.08
Round  60, Train loss: 0.623, Test loss: 0.961, Test accuracy: 69.65
Round  60, Global train loss: 0.623, Global test loss: 1.362, Global test accuracy: 55.10
Round  61, Train loss: 0.569, Test loss: 0.971, Test accuracy: 69.43
Round  61, Global train loss: 0.569, Global test loss: 1.299, Global test accuracy: 57.38
Round  62, Train loss: 0.584, Test loss: 0.967, Test accuracy: 69.94
Round  62, Global train loss: 0.584, Global test loss: 1.372, Global test accuracy: 58.62
Round  63, Train loss: 0.577, Test loss: 0.969, Test accuracy: 70.18
Round  63, Global train loss: 0.577, Global test loss: 1.301, Global test accuracy: 57.35
Round  64, Train loss: 0.508, Test loss: 0.983, Test accuracy: 69.79
Round  64, Global train loss: 0.508, Global test loss: 1.232, Global test accuracy: 58.86
Round  65, Train loss: 0.605, Test loss: 0.977, Test accuracy: 69.80
Round  65, Global train loss: 0.605, Global test loss: 1.390, Global test accuracy: 54.98
Round  66, Train loss: 0.557, Test loss: 0.990, Test accuracy: 69.81
Round  66, Global train loss: 0.557, Global test loss: 1.379, Global test accuracy: 56.63
Round  67, Train loss: 0.580, Test loss: 0.963, Test accuracy: 70.72
Round  67, Global train loss: 0.580, Global test loss: 1.175, Global test accuracy: 60.63
Round  68, Train loss: 0.523, Test loss: 0.965, Test accuracy: 71.03
Round  68, Global train loss: 0.523, Global test loss: 1.282, Global test accuracy: 59.02
Round  69, Train loss: 0.532, Test loss: 1.004, Test accuracy: 70.03
Round  69, Global train loss: 0.532, Global test loss: 1.294, Global test accuracy: 58.73
Round  70, Train loss: 0.476, Test loss: 0.998, Test accuracy: 70.16
Round  70, Global train loss: 0.476, Global test loss: 1.483, Global test accuracy: 53.92
Round  71, Train loss: 0.515, Test loss: 1.011, Test accuracy: 69.81
Round  71, Global train loss: 0.515, Global test loss: 1.247, Global test accuracy: 59.68
Round  72, Train loss: 0.504, Test loss: 1.047, Test accuracy: 69.36
Round  72, Global train loss: 0.504, Global test loss: 1.252, Global test accuracy: 61.69
Round  73, Train loss: 0.484, Test loss: 1.046, Test accuracy: 69.34
Round  73, Global train loss: 0.484, Global test loss: 1.347, Global test accuracy: 58.39
Round  74, Train loss: 0.459, Test loss: 1.036, Test accuracy: 69.57
Round  74, Global train loss: 0.459, Global test loss: 1.225, Global test accuracy: 62.72
Round  75, Train loss: 0.507, Test loss: 1.034, Test accuracy: 69.38
Round  75, Global train loss: 0.507, Global test loss: 1.308, Global test accuracy: 59.69
Round  76, Train loss: 0.467, Test loss: 1.023, Test accuracy: 69.64
Round  76, Global train loss: 0.467, Global test loss: 1.206, Global test accuracy: 62.98
Round  77, Train loss: 0.451, Test loss: 0.992, Test accuracy: 70.51
Round  77, Global train loss: 0.451, Global test loss: 1.290, Global test accuracy: 61.49
Round  78, Train loss: 0.452, Test loss: 1.004, Test accuracy: 70.96
Round  78, Global train loss: 0.452, Global test loss: 1.310, Global test accuracy: 60.18
Round  79, Train loss: 0.459, Test loss: 1.020, Test accuracy: 70.58
Round  79, Global train loss: 0.459, Global test loss: 1.301, Global test accuracy: 59.35
Round  80, Train loss: 0.469, Test loss: 1.054, Test accuracy: 69.89
Round  80, Global train loss: 0.469, Global test loss: 1.270, Global test accuracy: 60.24
Round  81, Train loss: 0.470, Test loss: 1.049, Test accuracy: 69.88
Round  81, Global train loss: 0.470, Global test loss: 1.344, Global test accuracy: 58.86
Round  82, Train loss: 0.521, Test loss: 1.045, Test accuracy: 69.80
Round  82, Global train loss: 0.521, Global test loss: 1.321, Global test accuracy: 59.52
Round  83, Train loss: 0.549, Test loss: 1.047, Test accuracy: 69.89
Round  83, Global train loss: 0.549, Global test loss: 1.288, Global test accuracy: 58.36
Round  84, Train loss: 0.484, Test loss: 1.054, Test accuracy: 69.96
Round  84, Global train loss: 0.484, Global test loss: 1.340, Global test accuracy: 58.18
Round  85, Train loss: 0.406, Test loss: 1.054, Test accuracy: 70.14
Round  85, Global train loss: 0.406, Global test loss: 1.229, Global test accuracy: 62.11
Round  86, Train loss: 0.382, Test loss: 1.043, Test accuracy: 70.30
Round  86, Global train loss: 0.382, Global test loss: 1.308, Global test accuracy: 61.32
Round  87, Train loss: 0.508, Test loss: 1.033, Test accuracy: 70.90
Round  87, Global train loss: 0.508, Global test loss: 1.295, Global test accuracy: 59.55
Round  88, Train loss: 0.493, Test loss: 1.039, Test accuracy: 71.08
Round  88, Global train loss: 0.493, Global test loss: 1.335, Global test accuracy: 58.34
Round  89, Train loss: 0.434, Test loss: 1.034, Test accuracy: 70.81
Round  89, Global train loss: 0.434, Global test loss: 1.317, Global test accuracy: 61.50
Round  90, Train loss: 0.437, Test loss: 1.034, Test accuracy: 70.65
Round  90, Global train loss: 0.437, Global test loss: 1.231, Global test accuracy: 63.13
Round  91, Train loss: 0.432, Test loss: 1.062, Test accuracy: 70.07
Round  91, Global train loss: 0.432, Global test loss: 1.243, Global test accuracy: 62.73
Round  92, Train loss: 0.432, Test loss: 1.077, Test accuracy: 70.08
Round  92, Global train loss: 0.432, Global test loss: 1.246, Global test accuracy: 61.63
Round  93, Train loss: 0.384, Test loss: 1.099, Test accuracy: 69.89
Round  93, Global train loss: 0.384, Global test loss: 1.437, Global test accuracy: 58.63
Round  94, Train loss: 0.442, Test loss: 1.092, Test accuracy: 69.81
Round  94, Global train loss: 0.442, Global test loss: 1.397, Global test accuracy: 58.60
Round  95, Train loss: 0.425, Test loss: 1.107, Test accuracy: 69.52
Round  95, Global train loss: 0.425, Global test loss: 1.276, Global test accuracy: 60.52
Round  96, Train loss: 0.380, Test loss: 1.111, Test accuracy: 69.20
Round  96, Global train loss: 0.380, Global test loss: 1.273, Global test accuracy: 61.59
Round  97, Train loss: 0.426, Test loss: 1.092, Test accuracy: 69.78
Round  97, Global train loss: 0.426, Global test loss: 1.302, Global test accuracy: 60.12
Round  98, Train loss: 0.442, Test loss: 1.083, Test accuracy: 70.10
Round  98, Global train loss: 0.442, Global test loss: 1.199, Global test accuracy: 63.29
Round  99, Train loss: 0.349, Test loss: 1.075, Test accuracy: 70.37
Round  99, Global train loss: 0.349, Global test loss: 1.494, Global test accuracy: 57.46
Final Round, Train loss: 0.321, Test loss: 1.186, Test accuracy: 69.37
Final Round, Global train loss: 0.321, Global test loss: 1.494, Global test accuracy: 57.46
Average accuracy final 10 rounds: 69.947 

Average global accuracy final 10 rounds: 60.77 

1318.9941844940186
[1.3935389518737793, 2.7870779037475586, 3.9064433574676514, 5.025808811187744, 6.13666033744812, 7.247511863708496, 8.363762617111206, 9.480013370513916, 10.603507041931152, 11.727000713348389, 12.847069263458252, 13.967137813568115, 15.09618878364563, 16.225239753723145, 17.34643006324768, 18.467620372772217, 19.590789794921875, 20.713959217071533, 21.83041262626648, 22.946866035461426, 24.065176248550415, 25.183486461639404, 26.301915645599365, 27.420344829559326, 28.543848752975464, 29.6673526763916, 30.7734694480896, 31.879586219787598, 32.989118337631226, 34.09865045547485, 35.208839416503906, 36.31902837753296, 37.43057608604431, 38.542123794555664, 39.65695333480835, 40.771782875061035, 41.88813042640686, 43.004477977752686, 44.11977005004883, 45.23506212234497, 46.35073685646057, 47.46641159057617, 48.573118686676025, 49.67982578277588, 50.79111170768738, 51.90239763259888, 53.02141284942627, 54.14042806625366, 55.265357971191406, 56.39028787612915, 57.51748967170715, 58.644691467285156, 59.75841999053955, 60.872148513793945, 61.989296674728394, 63.10644483566284, 64.22864818572998, 65.35085153579712, 66.45833349227905, 67.56581544876099, 68.67429876327515, 69.7827820777893, 70.88634467124939, 71.98990726470947, 73.1023461818695, 74.21478509902954, 75.33082866668701, 76.44687223434448, 77.56509304046631, 78.68331384658813, 79.80157804489136, 80.91984224319458, 82.03832769393921, 83.15681314468384, 84.27232933044434, 85.38784551620483, 86.5108380317688, 87.63383054733276, 88.7495481967926, 89.86526584625244, 90.97354578971863, 92.08182573318481, 93.18917775154114, 94.29652976989746, 95.40573215484619, 96.51493453979492, 97.62817931175232, 98.74142408370972, 99.85771203041077, 100.97399997711182, 102.08170747756958, 103.18941497802734, 104.30263447761536, 105.41585397720337, 106.52937698364258, 107.64289999008179, 108.75857043266296, 109.87424087524414, 110.98960399627686, 112.10496711730957, 113.22134971618652, 114.33773231506348, 115.45812916755676, 116.57852602005005, 117.69377398490906, 118.80902194976807, 119.91421318054199, 121.01940441131592, 122.12626218795776, 123.23311996459961, 124.34479069709778, 125.45646142959595, 126.56276726722717, 127.6690731048584, 128.771413564682, 129.87375402450562, 130.9802122116089, 132.08667039871216, 133.19646573066711, 134.30626106262207, 135.41203236579895, 136.51780366897583, 137.47228169441223, 138.42675971984863, 139.37509560585022, 140.3234314918518, 141.28078508377075, 142.2381386756897, 143.19771933555603, 144.15729999542236, 145.1131341457367, 146.06896829605103, 147.02852869033813, 147.98808908462524, 148.94716787338257, 149.9062466621399, 150.8663239479065, 151.8264012336731, 152.7851870059967, 153.7439727783203, 154.70325708389282, 155.66254138946533, 156.61815738677979, 157.57377338409424, 158.52709197998047, 159.4804105758667, 160.43610095977783, 161.39179134368896, 162.35091185569763, 163.3100323677063, 164.27100801467896, 165.2319836616516, 166.17960596084595, 167.12722826004028, 168.08819937705994, 169.0491704940796, 170.0122308731079, 170.97529125213623, 171.9421455860138, 172.90899991989136, 173.87739753723145, 174.84579515457153, 175.81317329406738, 176.78055143356323, 177.7476658821106, 178.71478033065796, 179.67425417900085, 180.63372802734375, 181.5851891040802, 182.53665018081665, 183.49208569526672, 184.4475212097168, 185.406751871109, 186.36598253250122, 187.32514834403992, 188.2843141555786, 189.24369072914124, 190.20306730270386, 191.16357517242432, 192.12408304214478, 193.0811219215393, 194.03816080093384, 195.00178480148315, 195.96540880203247, 196.93515706062317, 197.90490531921387, 198.8798143863678, 199.85472345352173, 200.81091117858887, 201.767098903656, 202.72715425491333, 203.68720960617065, 204.64737153053284, 205.60753345489502, 206.56681084632874, 207.52608823776245, 208.48160481452942, 209.4371213912964, 210.41090846061707, 211.38469552993774, 213.3210790157318, 215.25746250152588]
[27.51, 27.51, 30.74, 30.74, 41.51, 41.51, 44.69, 44.69, 49.05, 49.05, 52.63, 52.63, 55.1, 55.1, 55.32, 55.32, 56.38, 56.38, 55.81, 55.81, 58.43, 58.43, 59.77, 59.77, 59.85, 59.85, 60.82, 60.82, 61.4, 61.4, 61.62, 61.62, 63.47, 63.47, 64.33, 64.33, 65.02, 65.02, 65.09, 65.09, 65.43, 65.43, 65.6, 65.6, 64.68, 64.68, 65.98, 65.98, 66.14, 66.14, 67.12, 67.12, 67.03, 67.03, 67.05, 67.05, 66.51, 66.51, 66.62, 66.62, 67.48, 67.48, 68.0, 68.0, 68.67, 68.67, 68.69, 68.69, 68.4, 68.4, 68.4, 68.4, 68.16, 68.16, 69.0, 69.0, 68.6, 68.6, 68.24, 68.24, 68.23, 68.23, 68.22, 68.22, 68.69, 68.69, 69.07, 69.07, 69.12, 69.12, 69.25, 69.25, 69.07, 69.07, 68.82, 68.82, 69.67, 69.67, 69.23, 69.23, 69.14, 69.14, 68.47, 68.47, 69.22, 69.22, 69.6, 69.6, 69.63, 69.63, 69.49, 69.49, 68.81, 68.81, 69.6, 69.6, 69.77, 69.77, 69.57, 69.57, 69.65, 69.65, 69.43, 69.43, 69.94, 69.94, 70.18, 70.18, 69.79, 69.79, 69.8, 69.8, 69.81, 69.81, 70.72, 70.72, 71.03, 71.03, 70.03, 70.03, 70.16, 70.16, 69.81, 69.81, 69.36, 69.36, 69.34, 69.34, 69.57, 69.57, 69.38, 69.38, 69.64, 69.64, 70.51, 70.51, 70.96, 70.96, 70.58, 70.58, 69.89, 69.89, 69.88, 69.88, 69.8, 69.8, 69.89, 69.89, 69.96, 69.96, 70.14, 70.14, 70.3, 70.3, 70.9, 70.9, 71.08, 71.08, 70.81, 70.81, 70.65, 70.65, 70.07, 70.07, 70.08, 70.08, 69.89, 69.89, 69.81, 69.81, 69.52, 69.52, 69.2, 69.2, 69.78, 69.78, 70.1, 70.1, 70.37, 70.37, 69.37, 69.37]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.728, Test loss: 2.029, Test accuracy: 24.78
Round   0, Global train loss: 1.728, Global test loss: 2.204, Global test accuracy: 21.20
Round   1, Train loss: 1.475, Test loss: 1.810, Test accuracy: 28.76
Round   1, Global train loss: 1.475, Global test loss: 2.119, Global test accuracy: 20.65
Round   2, Train loss: 1.429, Test loss: 1.528, Test accuracy: 40.73
Round   2, Global train loss: 1.429, Global test loss: 1.921, Global test accuracy: 31.91
Round   3, Train loss: 1.389, Test loss: 1.437, Test accuracy: 43.49
Round   3, Global train loss: 1.389, Global test loss: 1.889, Global test accuracy: 31.24
Round   4, Train loss: 1.278, Test loss: 1.297, Test accuracy: 47.67
Round   4, Global train loss: 1.278, Global test loss: 1.836, Global test accuracy: 33.94
Round   5, Train loss: 1.249, Test loss: 1.267, Test accuracy: 49.74
Round   5, Global train loss: 1.249, Global test loss: 1.926, Global test accuracy: 32.88
Round   6, Train loss: 1.239, Test loss: 1.199, Test accuracy: 52.55
Round   6, Global train loss: 1.239, Global test loss: 1.707, Global test accuracy: 36.16
Round   7, Train loss: 1.167, Test loss: 1.185, Test accuracy: 53.07
Round   7, Global train loss: 1.167, Global test loss: 1.778, Global test accuracy: 36.69
Round   8, Train loss: 1.175, Test loss: 1.149, Test accuracy: 54.63
Round   8, Global train loss: 1.175, Global test loss: 1.714, Global test accuracy: 40.12
Round   9, Train loss: 1.175, Test loss: 1.163, Test accuracy: 54.65
Round   9, Global train loss: 1.175, Global test loss: 1.755, Global test accuracy: 36.49
Round  10, Train loss: 1.209, Test loss: 1.116, Test accuracy: 56.69
Round  10, Global train loss: 1.209, Global test loss: 1.585, Global test accuracy: 41.23
Round  11, Train loss: 1.239, Test loss: 1.094, Test accuracy: 57.53
Round  11, Global train loss: 1.239, Global test loss: 1.586, Global test accuracy: 43.49
Round  12, Train loss: 1.086, Test loss: 1.076, Test accuracy: 58.83
Round  12, Global train loss: 1.086, Global test loss: 1.577, Global test accuracy: 42.09
Round  13, Train loss: 1.219, Test loss: 1.069, Test accuracy: 59.13
Round  13, Global train loss: 1.219, Global test loss: 1.541, Global test accuracy: 46.35
Round  14, Train loss: 1.037, Test loss: 1.063, Test accuracy: 58.87
Round  14, Global train loss: 1.037, Global test loss: 1.562, Global test accuracy: 43.82
Round  15, Train loss: 1.111, Test loss: 1.046, Test accuracy: 59.42
Round  15, Global train loss: 1.111, Global test loss: 1.520, Global test accuracy: 46.90
Round  16, Train loss: 1.080, Test loss: 1.027, Test accuracy: 60.84
Round  16, Global train loss: 1.080, Global test loss: 1.644, Global test accuracy: 39.48
Round  17, Train loss: 1.069, Test loss: 1.007, Test accuracy: 61.78
Round  17, Global train loss: 1.069, Global test loss: 1.523, Global test accuracy: 45.06
Round  18, Train loss: 0.998, Test loss: 1.015, Test accuracy: 61.84
Round  18, Global train loss: 0.998, Global test loss: 1.480, Global test accuracy: 45.10
Round  19, Train loss: 0.993, Test loss: 1.004, Test accuracy: 62.13
Round  19, Global train loss: 0.993, Global test loss: 1.474, Global test accuracy: 47.57
Round  20, Train loss: 0.999, Test loss: 0.978, Test accuracy: 63.06
Round  20, Global train loss: 0.999, Global test loss: 1.441, Global test accuracy: 48.50
Round  21, Train loss: 0.933, Test loss: 0.967, Test accuracy: 63.63
Round  21, Global train loss: 0.933, Global test loss: 1.550, Global test accuracy: 46.16
Round  22, Train loss: 1.010, Test loss: 0.953, Test accuracy: 64.12
Round  22, Global train loss: 1.010, Global test loss: 1.453, Global test accuracy: 47.59
Round  23, Train loss: 0.998, Test loss: 0.953, Test accuracy: 64.18
Round  23, Global train loss: 0.998, Global test loss: 1.411, Global test accuracy: 49.39
Round  24, Train loss: 0.975, Test loss: 0.954, Test accuracy: 64.50
Round  24, Global train loss: 0.975, Global test loss: 1.313, Global test accuracy: 54.65
Round  25, Train loss: 0.959, Test loss: 0.944, Test accuracy: 64.73
Round  25, Global train loss: 0.959, Global test loss: 1.385, Global test accuracy: 53.32
Round  26, Train loss: 0.856, Test loss: 0.936, Test accuracy: 65.12
Round  26, Global train loss: 0.856, Global test loss: 1.314, Global test accuracy: 54.72
Round  27, Train loss: 0.806, Test loss: 0.928, Test accuracy: 65.86
Round  27, Global train loss: 0.806, Global test loss: 1.260, Global test accuracy: 54.68
Round  28, Train loss: 0.846, Test loss: 0.927, Test accuracy: 65.73
Round  28, Global train loss: 0.846, Global test loss: 1.296, Global test accuracy: 53.27
Round  29, Train loss: 0.847, Test loss: 0.916, Test accuracy: 66.48
Round  29, Global train loss: 0.847, Global test loss: 1.292, Global test accuracy: 55.40
Round  30, Train loss: 0.905, Test loss: 0.944, Test accuracy: 65.34
Round  30, Global train loss: 0.905, Global test loss: 1.329, Global test accuracy: 54.54
Round  31, Train loss: 0.859, Test loss: 0.939, Test accuracy: 65.79
Round  31, Global train loss: 0.859, Global test loss: 1.311, Global test accuracy: 55.01
Round  32, Train loss: 0.806, Test loss: 0.927, Test accuracy: 66.35
Round  32, Global train loss: 0.806, Global test loss: 1.263, Global test accuracy: 54.94
Round  33, Train loss: 0.874, Test loss: 0.912, Test accuracy: 67.01
Round  33, Global train loss: 0.874, Global test loss: 1.384, Global test accuracy: 50.97
Round  34, Train loss: 0.770, Test loss: 0.900, Test accuracy: 67.30
Round  34, Global train loss: 0.770, Global test loss: 1.409, Global test accuracy: 50.23
Round  35, Train loss: 0.810, Test loss: 0.908, Test accuracy: 67.53
Round  35, Global train loss: 0.810, Global test loss: 1.292, Global test accuracy: 55.17
Round  36, Train loss: 0.775, Test loss: 0.935, Test accuracy: 66.49
Round  36, Global train loss: 0.775, Global test loss: 1.408, Global test accuracy: 52.01
Round  37, Train loss: 0.711, Test loss: 0.907, Test accuracy: 67.44
Round  37, Global train loss: 0.711, Global test loss: 1.341, Global test accuracy: 53.40
Round  38, Train loss: 0.867, Test loss: 0.916, Test accuracy: 67.46
Round  38, Global train loss: 0.867, Global test loss: 1.350, Global test accuracy: 54.17
Round  39, Train loss: 0.713, Test loss: 0.911, Test accuracy: 67.53
Round  39, Global train loss: 0.713, Global test loss: 1.577, Global test accuracy: 46.95
Round  40, Train loss: 0.814, Test loss: 0.908, Test accuracy: 67.81
Round  40, Global train loss: 0.814, Global test loss: 1.236, Global test accuracy: 57.85
Round  41, Train loss: 0.722, Test loss: 0.911, Test accuracy: 68.12
Round  41, Global train loss: 0.722, Global test loss: 1.214, Global test accuracy: 58.73
Round  42, Train loss: 0.708, Test loss: 0.906, Test accuracy: 68.34
Round  42, Global train loss: 0.708, Global test loss: 1.250, Global test accuracy: 56.27
Round  43, Train loss: 0.732, Test loss: 0.901, Test accuracy: 68.65
Round  43, Global train loss: 0.732, Global test loss: 1.238, Global test accuracy: 58.29
Round  44, Train loss: 0.831, Test loss: 0.897, Test accuracy: 68.62
Round  44, Global train loss: 0.831, Global test loss: 1.324, Global test accuracy: 55.72
Round  45, Train loss: 0.698, Test loss: 0.910, Test accuracy: 68.32
Round  45, Global train loss: 0.698, Global test loss: 1.258, Global test accuracy: 55.98
Round  46, Train loss: 0.826, Test loss: 0.911, Test accuracy: 68.60
Round  46, Global train loss: 0.826, Global test loss: 1.193, Global test accuracy: 58.79
Round  47, Train loss: 0.731, Test loss: 0.904, Test accuracy: 68.61
Round  47, Global train loss: 0.731, Global test loss: 1.187, Global test accuracy: 59.06
Round  48, Train loss: 0.645, Test loss: 0.906, Test accuracy: 68.41
Round  48, Global train loss: 0.645, Global test loss: 1.247, Global test accuracy: 57.25
Round  49, Train loss: 0.749, Test loss: 0.918, Test accuracy: 68.40
Round  49, Global train loss: 0.749, Global test loss: 1.221, Global test accuracy: 57.73
Round  50, Train loss: 0.614, Test loss: 0.911, Test accuracy: 68.71
Round  50, Global train loss: 0.614, Global test loss: 1.262, Global test accuracy: 58.42
Round  51, Train loss: 0.687, Test loss: 0.901, Test accuracy: 68.98
Round  51, Global train loss: 0.687, Global test loss: 1.187, Global test accuracy: 59.71
Round  52, Train loss: 0.716, Test loss: 0.909, Test accuracy: 68.58
Round  52, Global train loss: 0.716, Global test loss: 1.187, Global test accuracy: 59.47
Round  53, Train loss: 0.692, Test loss: 0.899, Test accuracy: 69.22
Round  53, Global train loss: 0.692, Global test loss: 1.243, Global test accuracy: 58.04
Round  54, Train loss: 0.718, Test loss: 0.909, Test accuracy: 68.98
Round  54, Global train loss: 0.718, Global test loss: 1.321, Global test accuracy: 55.46
Round  55, Train loss: 0.573, Test loss: 0.897, Test accuracy: 70.02
Round  55, Global train loss: 0.573, Global test loss: 1.245, Global test accuracy: 57.50
Round  56, Train loss: 0.670, Test loss: 0.897, Test accuracy: 69.98
Round  56, Global train loss: 0.670, Global test loss: 1.310, Global test accuracy: 54.04
Round  57, Train loss: 0.731, Test loss: 0.872, Test accuracy: 70.79
Round  57, Global train loss: 0.731, Global test loss: 1.213, Global test accuracy: 57.97
Round  58, Train loss: 0.670, Test loss: 0.872, Test accuracy: 70.83
Round  58, Global train loss: 0.670, Global test loss: 1.181, Global test accuracy: 59.65
Round  59, Train loss: 0.684, Test loss: 0.884, Test accuracy: 70.30
Round  59, Global train loss: 0.684, Global test loss: 1.171, Global test accuracy: 60.13
Round  60, Train loss: 0.647, Test loss: 0.905, Test accuracy: 70.10
Round  60, Global train loss: 0.647, Global test loss: 1.304, Global test accuracy: 56.61
Round  61, Train loss: 0.638, Test loss: 0.897, Test accuracy: 70.41
Round  61, Global train loss: 0.638, Global test loss: 1.261, Global test accuracy: 58.27
Round  62, Train loss: 0.639, Test loss: 0.914, Test accuracy: 69.79
Round  62, Global train loss: 0.639, Global test loss: 1.296, Global test accuracy: 58.23
Round  63, Train loss: 0.600, Test loss: 0.893, Test accuracy: 70.29
Round  63, Global train loss: 0.600, Global test loss: 1.189, Global test accuracy: 59.05
Round  64, Train loss: 0.533, Test loss: 0.905, Test accuracy: 70.16
Round  64, Global train loss: 0.533, Global test loss: 1.258, Global test accuracy: 58.72
Round  65, Train loss: 0.589, Test loss: 0.926, Test accuracy: 69.83
Round  65, Global train loss: 0.589, Global test loss: 1.306, Global test accuracy: 57.05
Round  66, Train loss: 0.611, Test loss: 0.939, Test accuracy: 69.41
Round  66, Global train loss: 0.611, Global test loss: 1.238, Global test accuracy: 57.76
Round  67, Train loss: 0.533, Test loss: 0.928, Test accuracy: 69.83
Round  67, Global train loss: 0.533, Global test loss: 1.202, Global test accuracy: 60.80
Round  68, Train loss: 0.555, Test loss: 0.921, Test accuracy: 70.10
Round  68, Global train loss: 0.555, Global test loss: 1.220, Global test accuracy: 59.63
Round  69, Train loss: 0.571, Test loss: 0.912, Test accuracy: 70.35
Round  69, Global train loss: 0.571, Global test loss: 1.192, Global test accuracy: 59.71
Round  70, Train loss: 0.608, Test loss: 0.905, Test accuracy: 70.43
Round  70, Global train loss: 0.608, Global test loss: 1.441, Global test accuracy: 54.33
Round  71, Train loss: 0.579, Test loss: 0.923, Test accuracy: 70.26
Round  71, Global train loss: 0.579, Global test loss: 1.277, Global test accuracy: 58.60
Round  72, Train loss: 0.611, Test loss: 0.938, Test accuracy: 69.61
Round  72, Global train loss: 0.611, Global test loss: 1.218, Global test accuracy: 60.19
Round  73, Train loss: 0.565, Test loss: 0.961, Test accuracy: 69.29
Round  73, Global train loss: 0.565, Global test loss: 1.208, Global test accuracy: 60.12
Round  74, Train loss: 0.605, Test loss: 0.943, Test accuracy: 69.99
Round  74, Global train loss: 0.605, Global test loss: 1.202, Global test accuracy: 60.87
Round  75, Train loss: 0.500, Test loss: 0.957, Test accuracy: 69.99
Round  75, Global train loss: 0.500, Global test loss: 1.329, Global test accuracy: 58.91
Round  76, Train loss: 0.495, Test loss: 0.950, Test accuracy: 70.15
Round  76, Global train loss: 0.495, Global test loss: 1.205, Global test accuracy: 62.35
Round  77, Train loss: 0.569, Test loss: 0.958, Test accuracy: 69.80
Round  77, Global train loss: 0.569, Global test loss: 1.255, Global test accuracy: 59.19
Round  78, Train loss: 0.501, Test loss: 0.973, Test accuracy: 69.39
Round  78, Global train loss: 0.501, Global test loss: 1.208, Global test accuracy: 60.25
Round  79, Train loss: 0.512, Test loss: 0.975, Test accuracy: 68.86
Round  79, Global train loss: 0.512, Global test loss: 1.299, Global test accuracy: 57.32
Round  80, Train loss: 0.502, Test loss: 0.965, Test accuracy: 69.15
Round  80, Global train loss: 0.502, Global test loss: 1.213, Global test accuracy: 60.76
Round  81, Train loss: 0.463, Test loss: 0.959, Test accuracy: 69.58
Round  81, Global train loss: 0.463, Global test loss: 1.227, Global test accuracy: 61.56
Round  82, Train loss: 0.482, Test loss: 0.981, Test accuracy: 68.99
Round  82, Global train loss: 0.482, Global test loss: 1.238, Global test accuracy: 60.72
Round  83, Train loss: 0.488, Test loss: 0.986, Test accuracy: 69.00
Round  83, Global train loss: 0.488, Global test loss: 1.214, Global test accuracy: 60.64
Round  84, Train loss: 0.462, Test loss: 0.977, Test accuracy: 69.31
Round  84, Global train loss: 0.462, Global test loss: 1.298, Global test accuracy: 58.38
Round  85, Train loss: 0.470, Test loss: 0.981, Test accuracy: 69.64
Round  85, Global train loss: 0.470, Global test loss: 1.209, Global test accuracy: 60.97
Round  86, Train loss: 0.401, Test loss: 0.958, Test accuracy: 70.42
Round  86, Global train loss: 0.401, Global test loss: 1.302, Global test accuracy: 61.35
Round  87, Train loss: 0.457, Test loss: 0.972, Test accuracy: 70.23
Round  87, Global train loss: 0.457, Global test loss: 1.196, Global test accuracy: 61.47
Round  88, Train loss: 0.459, Test loss: 0.980, Test accuracy: 70.42
Round  88, Global train loss: 0.459, Global test loss: 1.320, Global test accuracy: 59.30
Round  89, Train loss: 0.597, Test loss: 0.975, Test accuracy: 71.11
Round  89, Global train loss: 0.597, Global test loss: 1.257, Global test accuracy: 60.52
Round  90, Train loss: 0.478, Test loss: 0.985, Test accuracy: 70.73
Round  90, Global train loss: 0.478, Global test loss: 1.199, Global test accuracy: 61.93
Round  91, Train loss: 0.553, Test loss: 0.979, Test accuracy: 70.45
Round  91, Global train loss: 0.553, Global test loss: 1.195, Global test accuracy: 62.01/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  92, Train loss: 0.446, Test loss: 0.995, Test accuracy: 70.25
Round  92, Global train loss: 0.446, Global test loss: 1.337, Global test accuracy: 58.74
Round  93, Train loss: 0.455, Test loss: 0.989, Test accuracy: 70.16
Round  93, Global train loss: 0.455, Global test loss: 1.246, Global test accuracy: 61.30
Round  94, Train loss: 0.510, Test loss: 0.991, Test accuracy: 70.43
Round  94, Global train loss: 0.510, Global test loss: 1.367, Global test accuracy: 58.88
Round  95, Train loss: 0.462, Test loss: 0.976, Test accuracy: 71.01
Round  95, Global train loss: 0.462, Global test loss: 1.229, Global test accuracy: 60.99
Round  96, Train loss: 0.499, Test loss: 0.970, Test accuracy: 71.03
Round  96, Global train loss: 0.499, Global test loss: 1.192, Global test accuracy: 62.85
Round  97, Train loss: 0.425, Test loss: 0.963, Test accuracy: 71.27
Round  97, Global train loss: 0.425, Global test loss: 1.244, Global test accuracy: 62.22
Round  98, Train loss: 0.403, Test loss: 0.996, Test accuracy: 70.22
Round  98, Global train loss: 0.403, Global test loss: 1.180, Global test accuracy: 63.39
Round  99, Train loss: 0.434, Test loss: 1.009, Test accuracy: 70.04
Round  99, Global train loss: 0.434, Global test loss: 1.343, Global test accuracy: 60.04
Final Round, Train loss: 0.360, Test loss: 1.062, Test accuracy: 69.96
Final Round, Global train loss: 0.360, Global test loss: 1.343, Global test accuracy: 60.04
Average accuracy final 10 rounds: 70.559 

Average global accuracy final 10 rounds: 61.235 

1319.45374917984
[1.4499812126159668, 2.8999624252319336, 4.081843137741089, 5.263723850250244, 6.443250417709351, 7.622776985168457, 8.788896322250366, 9.955015659332275, 11.11656665802002, 12.278117656707764, 13.436113834381104, 14.594110012054443, 15.742983102798462, 16.89185619354248, 18.089694499969482, 19.287532806396484, 20.494105100631714, 21.700677394866943, 22.72352886199951, 23.74638032913208, 24.767792224884033, 25.789204120635986, 26.809985160827637, 27.830766201019287, 28.85217595100403, 29.87358570098877, 30.894132375717163, 31.914679050445557, 32.93671631813049, 33.95875358581543, 34.979461908340454, 36.00017023086548, 37.02340745925903, 38.04664468765259, 39.06676626205444, 40.0868878364563, 41.109487771987915, 42.13208770751953, 43.154155015945435, 44.17622232437134, 45.19871473312378, 46.22120714187622, 47.24336123466492, 48.26551532745361, 49.2890887260437, 50.31266212463379, 51.33411908149719, 52.355576038360596, 53.3796124458313, 54.403648853302, 55.425299406051636, 56.44694995880127, 57.46961760520935, 58.49228525161743, 59.513938426971436, 60.53559160232544, 61.55971074104309, 62.58382987976074, 63.607314348220825, 64.63079881668091, 65.65263557434082, 66.67447233200073, 67.69590139389038, 68.71733045578003, 69.73633694648743, 70.75534343719482, 71.77695631980896, 72.7985692024231, 73.819326877594, 74.84008455276489, 75.86742520332336, 76.89476585388184, 77.9215362071991, 78.94830656051636, 79.97711372375488, 81.00592088699341, 82.03467154502869, 83.06342220306396, 84.09356379508972, 85.12370538711548, 86.15141248703003, 87.17911958694458, 88.20791983604431, 89.23672008514404, 90.26520657539368, 91.29369306564331, 92.31682896614075, 93.33996486663818, 94.3633713722229, 95.38677787780762, 96.40963363647461, 97.4324893951416, 98.4578628540039, 99.48323631286621, 100.51326656341553, 101.54329681396484, 102.57146263122559, 103.59962844848633, 104.63343501091003, 105.66724157333374, 106.69694256782532, 107.7266435623169, 108.75531005859375, 109.7839765548706, 110.80679154396057, 111.82960653305054, 112.84958934783936, 113.86957216262817, 114.89574527740479, 115.9219183921814, 116.95163488388062, 117.98135137557983, 119.00596642494202, 120.0305814743042, 121.05357003211975, 122.0765585899353, 123.09710764884949, 124.11765670776367, 125.14048099517822, 126.16330528259277, 127.1846535205841, 128.20600175857544, 129.2290415763855, 130.25208139419556, 131.27291560173035, 132.29374980926514, 133.31603717803955, 134.33832454681396, 135.35996103286743, 136.3815975189209, 137.40824913978577, 138.43490076065063, 139.4539406299591, 140.47298049926758, 141.49421334266663, 142.51544618606567, 143.53830361366272, 144.56116104125977, 145.57926225662231, 146.59736347198486, 147.6166501045227, 148.63593673706055, 149.65427231788635, 150.67260789871216, 151.6935224533081, 152.71443700790405, 153.73716688156128, 154.7598967552185, 155.78361439704895, 156.8073320388794, 157.82995533943176, 158.85257863998413, 159.87455701828003, 160.89653539657593, 161.9206144809723, 162.94469356536865, 163.96567749977112, 164.98666143417358, 166.00536918640137, 167.02407693862915, 168.04357147216797, 169.0630660057068, 170.08313179016113, 171.10319757461548, 172.12725615501404, 173.1513147354126, 174.172865152359, 175.19441556930542, 176.2144899368286, 177.2345643043518, 178.25542759895325, 179.2762908935547, 180.3001275062561, 181.32396411895752, 182.34696698188782, 183.36996984481812, 184.56030011177063, 185.75063037872314, 186.94393062591553, 188.1372308731079, 189.3289818763733, 190.52073287963867, 191.71558928489685, 192.91044569015503, 194.10398888587952, 195.297532081604, 196.49376511573792, 197.68999814987183, 198.8988344669342, 200.10767078399658, 201.3158664703369, 202.52406215667725, 203.7384307384491, 204.95279932022095, 206.16415309906006, 207.37550687789917, 208.5749123096466, 209.77431774139404, 210.97045993804932, 212.1666021347046, 214.57638955116272, 216.98617696762085]
[24.78, 24.78, 28.76, 28.76, 40.73, 40.73, 43.49, 43.49, 47.67, 47.67, 49.74, 49.74, 52.55, 52.55, 53.07, 53.07, 54.63, 54.63, 54.65, 54.65, 56.69, 56.69, 57.53, 57.53, 58.83, 58.83, 59.13, 59.13, 58.87, 58.87, 59.42, 59.42, 60.84, 60.84, 61.78, 61.78, 61.84, 61.84, 62.13, 62.13, 63.06, 63.06, 63.63, 63.63, 64.12, 64.12, 64.18, 64.18, 64.5, 64.5, 64.73, 64.73, 65.12, 65.12, 65.86, 65.86, 65.73, 65.73, 66.48, 66.48, 65.34, 65.34, 65.79, 65.79, 66.35, 66.35, 67.01, 67.01, 67.3, 67.3, 67.53, 67.53, 66.49, 66.49, 67.44, 67.44, 67.46, 67.46, 67.53, 67.53, 67.81, 67.81, 68.12, 68.12, 68.34, 68.34, 68.65, 68.65, 68.62, 68.62, 68.32, 68.32, 68.6, 68.6, 68.61, 68.61, 68.41, 68.41, 68.4, 68.4, 68.71, 68.71, 68.98, 68.98, 68.58, 68.58, 69.22, 69.22, 68.98, 68.98, 70.02, 70.02, 69.98, 69.98, 70.79, 70.79, 70.83, 70.83, 70.3, 70.3, 70.1, 70.1, 70.41, 70.41, 69.79, 69.79, 70.29, 70.29, 70.16, 70.16, 69.83, 69.83, 69.41, 69.41, 69.83, 69.83, 70.1, 70.1, 70.35, 70.35, 70.43, 70.43, 70.26, 70.26, 69.61, 69.61, 69.29, 69.29, 69.99, 69.99, 69.99, 69.99, 70.15, 70.15, 69.8, 69.8, 69.39, 69.39, 68.86, 68.86, 69.15, 69.15, 69.58, 69.58, 68.99, 68.99, 69.0, 69.0, 69.31, 69.31, 69.64, 69.64, 70.42, 70.42, 70.23, 70.23, 70.42, 70.42, 71.11, 71.11, 70.73, 70.73, 70.45, 70.45, 70.25, 70.25, 70.16, 70.16, 70.43, 70.43, 71.01, 71.01, 71.03, 71.03, 71.27, 71.27, 70.22, 70.22, 70.04, 70.04, 69.96, 69.96]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.686, Test loss: 2.016, Test accuracy: 25.11
Round   0, Global train loss: 1.686, Global test loss: 2.201, Global test accuracy: 21.42
Round   1, Train loss: 1.408, Test loss: 1.870, Test accuracy: 28.25
Round   1, Global train loss: 1.408, Global test loss: 2.205, Global test accuracy: 19.32
Round   2, Train loss: 1.346, Test loss: 1.522, Test accuracy: 40.89
Round   2, Global train loss: 1.346, Global test loss: 1.922, Global test accuracy: 32.59
Round   3, Train loss: 1.343, Test loss: 1.432, Test accuracy: 44.23
Round   3, Global train loss: 1.343, Global test loss: 1.940, Global test accuracy: 30.18
Round   4, Train loss: 1.216, Test loss: 1.307, Test accuracy: 47.18
Round   4, Global train loss: 1.216, Global test loss: 1.857, Global test accuracy: 32.54
Round   5, Train loss: 1.202, Test loss: 1.293, Test accuracy: 50.47
Round   5, Global train loss: 1.202, Global test loss: 2.126, Global test accuracy: 33.08
Round   6, Train loss: 1.163, Test loss: 1.243, Test accuracy: 52.21
Round   6, Global train loss: 1.163, Global test loss: 1.881, Global test accuracy: 35.65
Round   7, Train loss: 1.103, Test loss: 1.254, Test accuracy: 52.19
Round   7, Global train loss: 1.103, Global test loss: 1.926, Global test accuracy: 36.13
Round   8, Train loss: 1.062, Test loss: 1.267, Test accuracy: 52.58
Round   8, Global train loss: 1.062, Global test loss: 1.854, Global test accuracy: 40.12
Round   9, Train loss: 1.074, Test loss: 1.256, Test accuracy: 53.04
Round   9, Global train loss: 1.074, Global test loss: 1.890, Global test accuracy: 33.64
Round  10, Train loss: 1.117, Test loss: 1.194, Test accuracy: 55.57
Round  10, Global train loss: 1.117, Global test loss: 1.735, Global test accuracy: 39.14
Round  11, Train loss: 1.039, Test loss: 1.164, Test accuracy: 56.54
Round  11, Global train loss: 1.039, Global test loss: 1.613, Global test accuracy: 43.42
Round  12, Train loss: 1.036, Test loss: 1.138, Test accuracy: 58.08
Round  12, Global train loss: 1.036, Global test loss: 1.679, Global test accuracy: 42.04
Round  13, Train loss: 1.051, Test loss: 1.106, Test accuracy: 58.85
Round  13, Global train loss: 1.051, Global test loss: 1.646, Global test accuracy: 43.85
Round  14, Train loss: 0.942, Test loss: 1.107, Test accuracy: 58.97
Round  14, Global train loss: 0.942, Global test loss: 1.591, Global test accuracy: 45.30
Round  15, Train loss: 1.045, Test loss: 1.090, Test accuracy: 60.26
Round  15, Global train loss: 1.045, Global test loss: 1.603, Global test accuracy: 46.05
Round  16, Train loss: 0.994, Test loss: 1.088, Test accuracy: 60.72
Round  16, Global train loss: 0.994, Global test loss: 1.742, Global test accuracy: 39.04
Round  17, Train loss: 0.938, Test loss: 1.092, Test accuracy: 60.38
Round  17, Global train loss: 0.938, Global test loss: 1.578, Global test accuracy: 45.96
Round  18, Train loss: 0.934, Test loss: 1.082, Test accuracy: 60.97
Round  18, Global train loss: 0.934, Global test loss: 1.559, Global test accuracy: 44.37
Round  19, Train loss: 0.928, Test loss: 1.060, Test accuracy: 61.41
Round  19, Global train loss: 0.928, Global test loss: 1.541, Global test accuracy: 47.97
Round  20, Train loss: 0.936, Test loss: 1.050, Test accuracy: 61.60
Round  20, Global train loss: 0.936, Global test loss: 1.664, Global test accuracy: 45.30
Round  21, Train loss: 0.895, Test loss: 1.048, Test accuracy: 62.70
Round  21, Global train loss: 0.895, Global test loss: 1.724, Global test accuracy: 43.94
Round  22, Train loss: 0.971, Test loss: 1.045, Test accuracy: 62.37
Round  22, Global train loss: 0.971, Global test loss: 1.754, Global test accuracy: 44.01
Round  23, Train loss: 0.861, Test loss: 1.040, Test accuracy: 62.83
Round  23, Global train loss: 0.861, Global test loss: 1.553, Global test accuracy: 47.28
Round  24, Train loss: 0.850, Test loss: 1.041, Test accuracy: 62.87
Round  24, Global train loss: 0.850, Global test loss: 1.409, Global test accuracy: 51.51
Round  25, Train loss: 0.770, Test loss: 1.038, Test accuracy: 63.21
Round  25, Global train loss: 0.770, Global test loss: 1.481, Global test accuracy: 52.34
Round  26, Train loss: 0.801, Test loss: 1.024, Test accuracy: 63.48
Round  26, Global train loss: 0.801, Global test loss: 1.414, Global test accuracy: 51.95
Round  27, Train loss: 0.795, Test loss: 1.011, Test accuracy: 63.61
Round  27, Global train loss: 0.795, Global test loss: 1.319, Global test accuracy: 54.43
Round  28, Train loss: 0.733, Test loss: 1.009, Test accuracy: 64.15
Round  28, Global train loss: 0.733, Global test loss: 1.301, Global test accuracy: 55.21
Round  29, Train loss: 0.809, Test loss: 1.001, Test accuracy: 64.41
Round  29, Global train loss: 0.809, Global test loss: 1.296, Global test accuracy: 55.73
Round  30, Train loss: 0.819, Test loss: 0.975, Test accuracy: 65.11
Round  30, Global train loss: 0.819, Global test loss: 1.461, Global test accuracy: 52.52
Round  31, Train loss: 0.765, Test loss: 0.975, Test accuracy: 65.26
Round  31, Global train loss: 0.765, Global test loss: 1.370, Global test accuracy: 55.56
Round  32, Train loss: 0.842, Test loss: 0.979, Test accuracy: 65.50
Round  32, Global train loss: 0.842, Global test loss: 1.556, Global test accuracy: 48.03
Round  33, Train loss: 0.754, Test loss: 0.983, Test accuracy: 65.09
Round  33, Global train loss: 0.754, Global test loss: 1.635, Global test accuracy: 46.42
Round  34, Train loss: 0.719, Test loss: 0.961, Test accuracy: 66.10
Round  34, Global train loss: 0.719, Global test loss: 1.542, Global test accuracy: 50.52
Round  35, Train loss: 0.785, Test loss: 0.956, Test accuracy: 66.33
Round  35, Global train loss: 0.785, Global test loss: 1.278, Global test accuracy: 55.49
Round  36, Train loss: 0.729, Test loss: 0.957, Test accuracy: 66.11
Round  36, Global train loss: 0.729, Global test loss: 1.354, Global test accuracy: 53.77
Round  37, Train loss: 0.646, Test loss: 0.954, Test accuracy: 66.13
Round  37, Global train loss: 0.646, Global test loss: 1.346, Global test accuracy: 54.02
Round  38, Train loss: 0.839, Test loss: 0.945, Test accuracy: 66.78
Round  38, Global train loss: 0.839, Global test loss: 1.510, Global test accuracy: 52.40
Round  39, Train loss: 0.642, Test loss: 0.950, Test accuracy: 66.77
Round  39, Global train loss: 0.642, Global test loss: 1.633, Global test accuracy: 48.99
Round  40, Train loss: 0.674, Test loss: 0.928, Test accuracy: 67.50
Round  40, Global train loss: 0.674, Global test loss: 1.251, Global test accuracy: 57.18
Round  41, Train loss: 0.745, Test loss: 0.930, Test accuracy: 67.55
Round  41, Global train loss: 0.745, Global test loss: 1.227, Global test accuracy: 57.99
Round  42, Train loss: 0.679, Test loss: 0.935, Test accuracy: 67.37
Round  42, Global train loss: 0.679, Global test loss: 1.329, Global test accuracy: 54.90
Round  43, Train loss: 0.699, Test loss: 0.941, Test accuracy: 67.34
Round  43, Global train loss: 0.699, Global test loss: 1.329, Global test accuracy: 55.60
Round  44, Train loss: 0.636, Test loss: 0.946, Test accuracy: 67.46
Round  44, Global train loss: 0.636, Global test loss: 1.334, Global test accuracy: 57.33
Round  45, Train loss: 0.691, Test loss: 0.955, Test accuracy: 67.24
Round  45, Global train loss: 0.691, Global test loss: 1.366, Global test accuracy: 53.74
Round  46, Train loss: 0.750, Test loss: 0.933, Test accuracy: 68.07
Round  46, Global train loss: 0.750, Global test loss: 1.289, Global test accuracy: 55.95
Round  47, Train loss: 0.751, Test loss: 0.939, Test accuracy: 68.43
Round  47, Global train loss: 0.751, Global test loss: 1.248, Global test accuracy: 56.42
Round  48, Train loss: 0.698, Test loss: 0.969, Test accuracy: 68.06
Round  48, Global train loss: 0.698, Global test loss: 1.296, Global test accuracy: 56.12
Round  49, Train loss: 0.668, Test loss: 0.966, Test accuracy: 68.29
Round  49, Global train loss: 0.668, Global test loss: 1.352, Global test accuracy: 54.84
Round  50, Train loss: 0.689, Test loss: 0.986, Test accuracy: 67.93
Round  50, Global train loss: 0.689, Global test loss: 1.352, Global test accuracy: 55.60
Round  51, Train loss: 0.615, Test loss: 0.984, Test accuracy: 67.83
Round  51, Global train loss: 0.615, Global test loss: 1.204, Global test accuracy: 59.30
Round  52, Train loss: 0.587, Test loss: 0.983, Test accuracy: 67.84
Round  52, Global train loss: 0.587, Global test loss: 1.317, Global test accuracy: 57.18
Round  53, Train loss: 0.654, Test loss: 0.960, Test accuracy: 68.78
Round  53, Global train loss: 0.654, Global test loss: 1.479, Global test accuracy: 52.69
Round  54, Train loss: 0.638, Test loss: 0.959, Test accuracy: 68.36
Round  54, Global train loss: 0.638, Global test loss: 1.498, Global test accuracy: 52.09
Round  55, Train loss: 0.563, Test loss: 0.976, Test accuracy: 67.87
Round  55, Global train loss: 0.563, Global test loss: 1.335, Global test accuracy: 56.85
Round  56, Train loss: 0.590, Test loss: 0.982, Test accuracy: 68.49
Round  56, Global train loss: 0.590, Global test loss: 1.430, Global test accuracy: 52.46
Round  57, Train loss: 0.665, Test loss: 0.979, Test accuracy: 68.44
Round  57, Global train loss: 0.665, Global test loss: 1.287, Global test accuracy: 57.04
Round  58, Train loss: 0.564, Test loss: 0.980, Test accuracy: 68.15
Round  58, Global train loss: 0.564, Global test loss: 1.243, Global test accuracy: 58.69
Round  59, Train loss: 0.563, Test loss: 0.981, Test accuracy: 68.33
Round  59, Global train loss: 0.563, Global test loss: 1.201, Global test accuracy: 59.78
Round  60, Train loss: 0.660, Test loss: 0.999, Test accuracy: 67.73
Round  60, Global train loss: 0.660, Global test loss: 1.416, Global test accuracy: 55.20
Round  61, Train loss: 0.612, Test loss: 0.996, Test accuracy: 67.69
Round  61, Global train loss: 0.612, Global test loss: 1.263, Global test accuracy: 58.15
Round  62, Train loss: 0.589, Test loss: 0.980, Test accuracy: 68.05
Round  62, Global train loss: 0.589, Global test loss: 1.342, Global test accuracy: 57.12
Round  63, Train loss: 0.538, Test loss: 1.002, Test accuracy: 67.97
Round  63, Global train loss: 0.538, Global test loss: 1.284, Global test accuracy: 59.27
Round  64, Train loss: 0.543, Test loss: 0.995, Test accuracy: 68.24
Round  64, Global train loss: 0.543, Global test loss: 1.411, Global test accuracy: 55.70
Round  65, Train loss: 0.577, Test loss: 0.973, Test accuracy: 68.81
Round  65, Global train loss: 0.577, Global test loss: 1.449, Global test accuracy: 54.64
Round  66, Train loss: 0.526, Test loss: 0.983, Test accuracy: 68.34
Round  66, Global train loss: 0.526, Global test loss: 1.516, Global test accuracy: 53.79
Round  67, Train loss: 0.605, Test loss: 0.981, Test accuracy: 68.51
Round  67, Global train loss: 0.605, Global test loss: 1.332, Global test accuracy: 57.19
Round  68, Train loss: 0.486, Test loss: 0.993, Test accuracy: 68.68
Round  68, Global train loss: 0.486, Global test loss: 1.357, Global test accuracy: 57.15
Round  69, Train loss: 0.525, Test loss: 1.018, Test accuracy: 68.56
Round  69, Global train loss: 0.525, Global test loss: 1.346, Global test accuracy: 57.48
Round  70, Train loss: 0.534, Test loss: 1.052, Test accuracy: 68.45
Round  70, Global train loss: 0.534, Global test loss: 1.424, Global test accuracy: 57.15
Round  71, Train loss: 0.538, Test loss: 1.044, Test accuracy: 68.62
Round  71, Global train loss: 0.538, Global test loss: 1.338, Global test accuracy: 58.65
Round  72, Train loss: 0.518, Test loss: 1.053, Test accuracy: 68.55
Round  72, Global train loss: 0.518, Global test loss: 1.352, Global test accuracy: 57.64
Round  73, Train loss: 0.447, Test loss: 1.020, Test accuracy: 69.38
Round  73, Global train loss: 0.447, Global test loss: 1.346, Global test accuracy: 58.08
Round  74, Train loss: 0.486, Test loss: 1.060, Test accuracy: 68.58
Round  74, Global train loss: 0.486, Global test loss: 1.363, Global test accuracy: 57.98
Round  75, Train loss: 0.531, Test loss: 1.063, Test accuracy: 68.75
Round  75, Global train loss: 0.531, Global test loss: 1.278, Global test accuracy: 59.14
Round  76, Train loss: 0.478, Test loss: 1.021, Test accuracy: 69.27
Round  76, Global train loss: 0.478, Global test loss: 1.208, Global test accuracy: 61.45
Round  77, Train loss: 0.470, Test loss: 1.032, Test accuracy: 68.86
Round  77, Global train loss: 0.470, Global test loss: 1.300, Global test accuracy: 60.06
Round  78, Train loss: 0.441, Test loss: 1.032, Test accuracy: 69.10
Round  78, Global train loss: 0.441, Global test loss: 1.395, Global test accuracy: 56.52
Round  79, Train loss: 0.446, Test loss: 1.020, Test accuracy: 68.70
Round  79, Global train loss: 0.446, Global test loss: 1.485, Global test accuracy: 55.33
Round  80, Train loss: 0.486, Test loss: 1.026, Test accuracy: 68.69
Round  80, Global train loss: 0.486, Global test loss: 1.259, Global test accuracy: 60.84
Round  81, Train loss: 0.450, Test loss: 1.019, Test accuracy: 69.18
Round  81, Global train loss: 0.450, Global test loss: 1.297, Global test accuracy: 59.63
Round  82, Train loss: 0.500, Test loss: 1.015, Test accuracy: 69.02
Round  82, Global train loss: 0.500, Global test loss: 1.296, Global test accuracy: 58.62
Round  83, Train loss: 0.521, Test loss: 1.026, Test accuracy: 69.19
Round  83, Global train loss: 0.521, Global test loss: 1.429, Global test accuracy: 54.99
Round  84, Train loss: 0.462, Test loss: 1.022, Test accuracy: 69.04
Round  84, Global train loss: 0.462, Global test loss: 1.367, Global test accuracy: 56.82
Round  85, Train loss: 0.430, Test loss: 1.025, Test accuracy: 69.45
Round  85, Global train loss: 0.430, Global test loss: 1.221, Global test accuracy: 61.27
Round  86, Train loss: 0.390, Test loss: 1.040, Test accuracy: 69.57
Round  86, Global train loss: 0.390, Global test loss: 1.349, Global test accuracy: 60.27
Round  87, Train loss: 0.469, Test loss: 1.023, Test accuracy: 70.25
Round  87, Global train loss: 0.469, Global test loss: 1.331, Global test accuracy: 59.59
Round  88, Train loss: 0.510, Test loss: 1.032, Test accuracy: 69.87
Round  88, Global train loss: 0.510, Global test loss: 1.409, Global test accuracy: 55.57
Round  89, Train loss: 0.454, Test loss: 1.022, Test accuracy: 70.30
Round  89, Global train loss: 0.454, Global test loss: 1.374, Global test accuracy: 60.23
Round  90, Train loss: 0.431, Test loss: 1.040, Test accuracy: 69.78
Round  90, Global train loss: 0.431, Global test loss: 1.264, Global test accuracy: 61.61
Round  91, Train loss: 0.426, Test loss: 1.059, Test accuracy: 69.28
Round  91, Global train loss: 0.426, Global test loss: 1.316, Global test accuracy: 61.08
Round  92, Train loss: 0.440, Test loss: 1.048, Test accuracy: 69.90
Round  92, Global train loss: 0.440, Global test loss: 1.392, Global test accuracy: 58.08
Round  93, Train loss: 0.419, Test loss: 1.051, Test accuracy: 70.02
Round  93, Global train loss: 0.419, Global test loss: 1.333, Global test accuracy: 59.97
Round  94, Train loss: 0.443, Test loss: 1.061, Test accuracy: 69.76
Round  94, Global train loss: 0.443, Global test loss: 1.407, Global test accuracy: 58.31
Round  95, Train loss: 0.364, Test loss: 1.062, Test accuracy: 69.81
Round  95, Global train loss: 0.364, Global test loss: 1.407, Global test accuracy: 58.81
Round  96, Train loss: 0.387, Test loss: 1.061, Test accuracy: 69.98
Round  96, Global train loss: 0.387, Global test loss: 1.515, Global test accuracy: 57.65
Round  97, Train loss: 0.440, Test loss: 1.084, Test accuracy: 69.47
Round  97, Global train loss: 0.440, Global test loss: 1.371, Global test accuracy: 59.32
Round  98, Train loss: 0.422, Test loss: 1.079, Test accuracy: 69.54
Round  98, Global train loss: 0.422, Global test loss: 1.254, Global test accuracy: 61.21
Round  99, Train loss: 0.373, Test loss: 1.069, Test accuracy: 69.76
Round  99, Global train loss: 0.373, Global test loss: 1.396, Global test accuracy: 59.35
Final Round, Train loss: 0.310, Test loss: 1.235, Test accuracy: 69.16
Final Round, Global train loss: 0.310, Global test loss: 1.396, Global test accuracy: 59.35
Average accuracy final 10 rounds: 69.73
Average global accuracy final 10 rounds: 59.53900000000001
1805.0714874267578
[2.7306485176086426, 5.215439081192017, 7.6863157749176025, 10.172973871231079, 12.654023170471191, 14.803974628448486, 16.955303192138672, 19.111729860305786, 21.261932611465454, 23.417245388031006, 25.57283067703247, 27.724324941635132, 29.88281536102295, 32.04164791107178, 34.19727873802185, 36.362346172332764, 38.50914239883423, 40.65193462371826, 42.80484747886658, 44.946067094802856, 47.10779428482056, 49.263185262680054, 51.41000771522522, 53.5640184879303, 55.72183299064636, 57.93829846382141, 60.088545083999634, 62.24358940124512, 64.40420079231262, 66.55567646026611, 68.70816040039062, 70.85128164291382, 73.01008892059326, 75.1550805568695, 77.30031704902649, 79.45750880241394, 81.61288094520569, 83.77158188819885, 85.92838072776794, 88.07947516441345, 90.232741355896, 92.37759613990784, 94.5258436203003, 96.68455958366394, 98.8392186164856, 100.99463057518005, 103.14073538780212, 105.29821300506592, 107.45874452590942, 109.63756322860718, 111.80831265449524, 113.98596739768982, 116.15140438079834, 118.3152539730072, 120.48093938827515, 122.64728426933289, 124.81898736953735, 126.98643946647644, 129.1617157459259, 131.31828355789185, 133.48857951164246, 135.6464204788208, 137.82405138015747, 139.96392822265625, 142.10999369621277, 144.28634643554688, 146.43611669540405, 148.60948944091797, 150.78478002548218, 152.95289134979248, 155.1187756061554, 157.27358269691467, 159.45169711112976, 161.6233344078064, 163.7779335975647, 165.93638920783997, 168.1104793548584, 170.25500559806824, 172.40829849243164, 174.55066394805908, 176.70648193359375, 178.8708620071411, 181.03770518302917, 183.19894909858704, 185.37208461761475, 187.52844619750977, 189.6757960319519, 191.83421921730042, 193.9967484474182, 196.16399908065796, 198.32161951065063, 200.48986768722534, 202.64551210403442, 204.80857825279236, 206.97142362594604, 209.14490699768066, 211.2975640296936, 213.43805623054504, 215.5792579650879, 217.7487280368805, 221.63878393173218]
[25.11, 28.25, 40.89, 44.23, 47.18, 50.47, 52.21, 52.19, 52.58, 53.04, 55.57, 56.54, 58.08, 58.85, 58.97, 60.26, 60.72, 60.38, 60.97, 61.41, 61.6, 62.7, 62.37, 62.83, 62.87, 63.21, 63.48, 63.61, 64.15, 64.41, 65.11, 65.26, 65.5, 65.09, 66.1, 66.33, 66.11, 66.13, 66.78, 66.77, 67.5, 67.55, 67.37, 67.34, 67.46, 67.24, 68.07, 68.43, 68.06, 68.29, 67.93, 67.83, 67.84, 68.78, 68.36, 67.87, 68.49, 68.44, 68.15, 68.33, 67.73, 67.69, 68.05, 67.97, 68.24, 68.81, 68.34, 68.51, 68.68, 68.56, 68.45, 68.62, 68.55, 69.38, 68.58, 68.75, 69.27, 68.86, 69.1, 68.7, 68.69, 69.18, 69.02, 69.19, 69.04, 69.45, 69.57, 70.25, 69.87, 70.3, 69.78, 69.28, 69.9, 70.02, 69.76, 69.81, 69.98, 69.47, 69.54, 69.76, 69.16]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  16.9100
Round 1 global test acc  17.4500
Round 2 global test acc  23.5100
Round 3 global test acc  21.3600
Round 4 global test acc  28.6600
Round 5 global test acc  25.1500
Round 6 global test acc  23.7600
Round 7 global test acc  28.6000
Round 8 global test acc  27.6800
Round 9 global test acc  29.5200
Round 10 global test acc  27.3200
Round 11 global test acc  37.5200
Round 12 global test acc  29.7900
Round 13 global test acc  30.9500
Round 14 global test acc  34.9900
Round 15 global test acc  28.2400
Round 16 global test acc  27.9800
Round 17 global test acc  35.1000
Round 18 global test acc  35.0300
Round 19 global test acc  29.6100
Round 20 global test acc  37.2100
Round 21 global test acc  32.9700
Round 22 global test acc  37.0400
Round 23 global test acc  35.2200
Round 24 global test acc  37.9400
Round 25 global test acc  37.3400
Round 26 global test acc  28.2600
Round 27 global test acc  36.4700
Round 28 global test acc  34.7800
Round 29 global test acc  32.7900
Round 30 global test acc  39.3000
Round 31 global test acc  37.4700
Round 32 global test acc  36.7100
Round 33 global test acc  38.3500
Round 34 global test acc  36.2800
Round 35 global test acc  40.7100
Round 36 global test acc  32.8500
Round 37 global test acc  33.7400
Round 38 global test acc  47.9000
Round 39 global test acc  39.3900
Round 40 global test acc  35.8100
Round 41 global test acc  46.6900
Round 42 global test acc  39.7200
Round 43 global test acc  38.3400
Round 44 global test acc  39.8900
Round 45 global test acc  40.7900
Round 46 global test acc  35.2400
Round 47 global test acc  37.6100
Round 48 global test acc  43.7800
Round 49 global test acc  37.2500
Round 50 global test acc  43.2700
Round 51 global test acc  44.9700
Round 52 global test acc  44.8500
Round 53 global test acc  37.7100
Round 54 global test acc  42.4700
Round 55 global test acc  36.0500
Round 56 global test acc  38.9600
Round 57 global test acc  39.5400
Round 58 global test acc  37.9100
Round 59 global test acc  37.6000
Round 60 global test acc  45.4600
Round 61 global test acc  36.7700
Round 62 global test acc  45.8200
Round 63 global test acc  40.4000
Round 64 global test acc  39.8000
Round 65 global test acc  39.8600
Round 66 global test acc  33.5800
Round 67 global test acc  42.6400
Round 68 global test acc  44.1600
Round 69 global test acc  40.9000
Round 70 global test acc  40.9200
Round 71 global test acc  43.1000
Round 72 global test acc  43.4500
Round 73 global test acc  44.0400
Round 74 global test acc  40.2000
Round 75 global test acc  44.8500
Round 76 global test acc  44.6900
Round 77 global test acc  45.7100
Round 78 global test acc  43.9700
Round 79 global test acc  42.7100
Round 80 global test acc  41.0300
Round 81 global test acc  36.6300
Round 82 global test acc  33.8600
Round 83 global test acc  31.0200
Round 84 global test acc  28.6800
Round 85 global test acc  29.0800
Round 86 global test acc  28.4400
Round 87 global test acc  28.4400
Round 88 global test acc  28.7900
Round 89 global test acc  28.1100
Round 90 global test acc  26.8900
Round 91 global test acc  25.2800
Round 92 global test acc  25.3100
Round 93 global test acc  25.6200
Round 94 global test acc  26.1800
Round 95 global test acc  24.8600
Round 96 global test acc  24.2600
Round 97 global test acc  23.4400
Round 98 global test acc  23.6000
Round 99 global test acc  22.6000
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.930, Test loss: 2.150, Test accuracy: 25.41
Round   1, Train loss: 1.561, Test loss: 1.865, Test accuracy: 28.30
Round   2, Train loss: 1.518, Test loss: 1.578, Test accuracy: 40.05
Round   3, Train loss: 1.493, Test loss: 1.509, Test accuracy: 42.26
Round   4, Train loss: 1.446, Test loss: 1.357, Test accuracy: 47.57
Round   5, Train loss: 1.262, Test loss: 1.330, Test accuracy: 48.80
Round   6, Train loss: 1.330, Test loss: 1.224, Test accuracy: 51.70
Round   7, Train loss: 1.286, Test loss: 1.209, Test accuracy: 53.10
Round   8, Train loss: 1.248, Test loss: 1.153, Test accuracy: 55.01
Round   9, Train loss: 1.241, Test loss: 1.132, Test accuracy: 55.84
Round  10, Train loss: 1.320, Test loss: 1.095, Test accuracy: 58.47
Round  11, Train loss: 1.135, Test loss: 1.082, Test accuracy: 59.72
Round  12, Train loss: 1.224, Test loss: 1.067, Test accuracy: 60.27
Round  13, Train loss: 1.050, Test loss: 0.992, Test accuracy: 62.60
Round  14, Train loss: 1.137, Test loss: 1.010, Test accuracy: 62.53
Round  15, Train loss: 1.137, Test loss: 0.989, Test accuracy: 63.10
Round  16, Train loss: 1.156, Test loss: 0.987, Test accuracy: 63.14
Round  17, Train loss: 1.162, Test loss: 0.983, Test accuracy: 64.18
Round  18, Train loss: 1.014, Test loss: 0.953, Test accuracy: 64.81
Round  19, Train loss: 1.119, Test loss: 0.919, Test accuracy: 65.76
Round  20, Train loss: 1.121, Test loss: 0.911, Test accuracy: 66.68
Round  21, Train loss: 1.147, Test loss: 0.924, Test accuracy: 66.81
Round  22, Train loss: 1.032, Test loss: 0.903, Test accuracy: 67.44
Round  23, Train loss: 1.019, Test loss: 0.896, Test accuracy: 67.88
Round  24, Train loss: 1.110, Test loss: 0.884, Test accuracy: 67.79
Round  25, Train loss: 0.954, Test loss: 0.890, Test accuracy: 67.90
Round  26, Train loss: 0.898, Test loss: 0.864, Test accuracy: 68.59
Round  27, Train loss: 0.974, Test loss: 0.859, Test accuracy: 68.84
Round  28, Train loss: 1.063, Test loss: 0.857, Test accuracy: 69.18
Round  29, Train loss: 0.965, Test loss: 0.845, Test accuracy: 69.15
Round  30, Train loss: 0.996, Test loss: 0.850, Test accuracy: 69.52
Round  31, Train loss: 1.058, Test loss: 0.842, Test accuracy: 69.89
Round  32, Train loss: 0.974, Test loss: 0.835, Test accuracy: 69.89
Round  33, Train loss: 0.892, Test loss: 0.825, Test accuracy: 70.20
Round  34, Train loss: 0.877, Test loss: 0.827, Test accuracy: 69.89
Round  35, Train loss: 0.908, Test loss: 0.824, Test accuracy: 70.10
Round  36, Train loss: 0.950, Test loss: 0.817, Test accuracy: 70.87
Round  37, Train loss: 0.854, Test loss: 0.813, Test accuracy: 70.78
Round  38, Train loss: 0.917, Test loss: 0.801, Test accuracy: 71.00
Round  39, Train loss: 0.827, Test loss: 0.802, Test accuracy: 70.92
Round  40, Train loss: 0.746, Test loss: 0.814, Test accuracy: 71.07
Round  41, Train loss: 0.856, Test loss: 0.786, Test accuracy: 72.20
Round  42, Train loss: 0.844, Test loss: 0.790, Test accuracy: 72.17
Round  43, Train loss: 0.805, Test loss: 0.788, Test accuracy: 71.89
Round  44, Train loss: 0.771, Test loss: 0.771, Test accuracy: 72.01
Round  45, Train loss: 0.979, Test loss: 0.762, Test accuracy: 72.60
Round  46, Train loss: 0.952, Test loss: 0.757, Test accuracy: 72.84
Round  47, Train loss: 0.867, Test loss: 0.762, Test accuracy: 73.36
Round  48, Train loss: 0.969, Test loss: 0.750, Test accuracy: 73.21
Round  49, Train loss: 0.856, Test loss: 0.757, Test accuracy: 72.94
Round  50, Train loss: 0.803, Test loss: 0.753, Test accuracy: 73.08
Round  51, Train loss: 0.707, Test loss: 0.747, Test accuracy: 73.33
Round  52, Train loss: 0.727, Test loss: 0.749, Test accuracy: 73.06
Round  53, Train loss: 0.722, Test loss: 0.754, Test accuracy: 73.22
Round  54, Train loss: 0.843, Test loss: 0.745, Test accuracy: 73.12
Round  55, Train loss: 0.749, Test loss: 0.738, Test accuracy: 73.43
Round  56, Train loss: 0.734, Test loss: 0.733, Test accuracy: 73.58
Round  57, Train loss: 0.877, Test loss: 0.730, Test accuracy: 73.85
Round  58, Train loss: 0.696, Test loss: 0.736, Test accuracy: 73.70
Round  59, Train loss: 0.789, Test loss: 0.736, Test accuracy: 74.01
Round  60, Train loss: 0.789, Test loss: 0.727, Test accuracy: 74.24
Round  61, Train loss: 0.885, Test loss: 0.720, Test accuracy: 74.59
Round  62, Train loss: 0.632, Test loss: 0.728, Test accuracy: 73.97
Round  63, Train loss: 0.640, Test loss: 0.732, Test accuracy: 73.96
Round  64, Train loss: 0.843, Test loss: 0.720, Test accuracy: 74.58
Round  65, Train loss: 0.732, Test loss: 0.723, Test accuracy: 74.85
Round  66, Train loss: 0.700, Test loss: 0.725, Test accuracy: 74.39
Round  67, Train loss: 0.711, Test loss: 0.729, Test accuracy: 74.73
Round  68, Train loss: 0.739, Test loss: 0.722, Test accuracy: 74.82
Round  69, Train loss: 0.703, Test loss: 0.717, Test accuracy: 74.54
Round  70, Train loss: 0.712, Test loss: 0.713, Test accuracy: 74.88
Round  71, Train loss: 0.702, Test loss: 0.713, Test accuracy: 74.86
Round  72, Train loss: 0.613, Test loss: 0.709, Test accuracy: 75.15
Round  73, Train loss: 0.656, Test loss: 0.709, Test accuracy: 74.96
Round  74, Train loss: 0.655, Test loss: 0.711, Test accuracy: 75.28
Round  75, Train loss: 0.702, Test loss: 0.716, Test accuracy: 74.98
Round  76, Train loss: 0.630, Test loss: 0.712, Test accuracy: 75.20
Round  77, Train loss: 0.676, Test loss: 0.705, Test accuracy: 75.52
Round  78, Train loss: 0.541, Test loss: 0.713, Test accuracy: 75.27
Round  79, Train loss: 0.682, Test loss: 0.709, Test accuracy: 75.41
Round  80, Train loss: 0.687, Test loss: 0.699, Test accuracy: 75.94
Round  81, Train loss: 0.645, Test loss: 0.710, Test accuracy: 75.61
Round  82, Train loss: 0.623, Test loss: 0.711, Test accuracy: 75.38
Round  83, Train loss: 0.718, Test loss: 0.717, Test accuracy: 75.00
Round  84, Train loss: 0.588, Test loss: 0.714, Test accuracy: 75.16
Round  85, Train loss: 0.491, Test loss: 0.716, Test accuracy: 75.11
Round  86, Train loss: 0.529, Test loss: 0.710, Test accuracy: 75.08
Round  87, Train loss: 0.694, Test loss: 0.716, Test accuracy: 75.26
Round  88, Train loss: 0.732, Test loss: 0.710, Test accuracy: 75.47
Round  89, Train loss: 0.583, Test loss: 0.716, Test accuracy: 75.17
Round  90, Train loss: 0.492, Test loss: 0.707, Test accuracy: 75.84
Round  91, Train loss: 0.708, Test loss: 0.705, Test accuracy: 75.40
Round  92, Train loss: 0.619, Test loss: 0.716, Test accuracy: 75.28
Round  93, Train loss: 0.683, Test loss: 0.729, Test accuracy: 74.85
Round  94, Train loss: 0.586, Test loss: 0.724, Test accuracy: 75.18
Round  95, Train loss: 0.519, Test loss: 0.719, Test accuracy: 75.40
Round  96, Train loss: 0.500, Test loss: 0.710, Test accuracy: 75.54
Round  97, Train loss: 0.585, Test loss: 0.719, Test accuracy: 75.04
Round  98, Train loss: 0.646, Test loss: 0.719, Test accuracy: 75.24
Round  99, Train loss: 0.547, Test loss: 0.717, Test accuracy: 75.59
Final Round, Train loss: 0.504, Test loss: 0.730, Test accuracy: 75.23
Average accuracy final 10 rounds: 75.336
971.2960438728333
[1.6003923416137695, 2.869493007659912, 4.137151718139648, 5.407174587249756, 6.671229839324951, 7.942963600158691, 9.214056015014648, 10.484249591827393, 11.749308824539185, 13.014553785324097, 14.276785850524902, 15.540407180786133, 16.805712699890137, 18.067448377609253, 19.33095908164978, 20.59813165664673, 21.866689920425415, 23.130271673202515, 24.392330646514893, 25.662739038467407, 26.934870719909668, 28.20405411720276, 29.473695278167725, 30.74442982673645, 32.00935125350952, 33.27060317993164, 34.53313708305359, 35.79637050628662, 37.05756211280823, 38.324930906295776, 39.59562849998474, 40.86463975906372, 42.13540077209473, 43.40609359741211, 44.673725605010986, 45.944164991378784, 47.21095681190491, 48.480401039123535, 49.74679374694824, 51.00851035118103, 52.27147197723389, 53.53350377082825, 54.79624009132385, 56.05985450744629, 57.32951259613037, 58.59499168395996, 59.853482723236084, 61.11862659454346, 62.383790731430054, 63.64645862579346, 64.90963172912598, 66.17775797843933, 67.47538018226624, 68.59686923027039, 69.7169418334961, 70.83792400360107, 71.96091914176941, 73.08742952346802, 74.2118399143219, 75.33496451377869, 76.458181142807, 77.57953143119812, 78.70108723640442, 79.82355785369873, 80.94575762748718, 82.0672652721405, 83.1891839504242, 84.31012964248657, 85.43000769615173, 86.55281901359558, 87.67542862892151, 88.79811310768127, 89.92058849334717, 91.04375052452087, 92.17138743400574, 93.29353094100952, 94.41712069511414, 95.53823065757751, 96.66105699539185, 97.78224420547485, 98.9050395488739, 100.02734375, 101.15202713012695, 102.2753677368164, 103.39758038520813, 104.52032470703125, 105.64388370513916, 106.76692914962769, 107.89359402656555, 109.01723575592041, 110.14066004753113, 111.26402807235718, 112.38395881652832, 113.50585865974426, 114.6303403377533, 115.754310131073, 116.8776502609253, 118.00105023384094, 119.12592816352844, 120.2482328414917, 122.09933304786682]
[25.41, 28.3, 40.05, 42.26, 47.57, 48.8, 51.7, 53.1, 55.01, 55.84, 58.47, 59.72, 60.27, 62.6, 62.53, 63.1, 63.14, 64.18, 64.81, 65.76, 66.68, 66.81, 67.44, 67.88, 67.79, 67.9, 68.59, 68.84, 69.18, 69.15, 69.52, 69.89, 69.89, 70.2, 69.89, 70.1, 70.87, 70.78, 71.0, 70.92, 71.07, 72.2, 72.17, 71.89, 72.01, 72.6, 72.84, 73.36, 73.21, 72.94, 73.08, 73.33, 73.06, 73.22, 73.12, 73.43, 73.58, 73.85, 73.7, 74.01, 74.24, 74.59, 73.97, 73.96, 74.58, 74.85, 74.39, 74.73, 74.82, 74.54, 74.88, 74.86, 75.15, 74.96, 75.28, 74.98, 75.2, 75.52, 75.27, 75.41, 75.94, 75.61, 75.38, 75.0, 75.16, 75.11, 75.08, 75.26, 75.47, 75.17, 75.84, 75.4, 75.28, 74.85, 75.18, 75.4, 75.54, 75.04, 75.24, 75.59, 75.23]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.630, Test loss: 2.084, Test accuracy: 27.14
Round   0, Global train loss: 1.630, Global test loss: 2.274, Global test accuracy: 25.74
Round   1, Train loss: 1.454, Test loss: 1.795, Test accuracy: 29.65
Round   1, Global train loss: 1.454, Global test loss: 2.125, Global test accuracy: 20.53
Round   2, Train loss: 1.364, Test loss: 1.451, Test accuracy: 42.82
Round   2, Global train loss: 1.364, Global test loss: 1.835, Global test accuracy: 33.46
Round   3, Train loss: 1.288, Test loss: 1.391, Test accuracy: 45.41
Round   3, Global train loss: 1.288, Global test loss: 1.883, Global test accuracy: 31.19
Round   4, Train loss: 1.229, Test loss: 1.235, Test accuracy: 50.60
Round   4, Global train loss: 1.229, Global test loss: 1.755, Global test accuracy: 37.64
Round   5, Train loss: 1.160, Test loss: 1.228, Test accuracy: 52.45
Round   5, Global train loss: 1.160, Global test loss: 1.959, Global test accuracy: 32.19
Round   6, Train loss: 1.135, Test loss: 1.162, Test accuracy: 54.62
Round   6, Global train loss: 1.135, Global test loss: 1.751, Global test accuracy: 37.19
Round   7, Train loss: 1.118, Test loss: 1.144, Test accuracy: 54.72
Round   7, Global train loss: 1.118, Global test loss: 1.758, Global test accuracy: 38.68
Round   8, Train loss: 1.095, Test loss: 1.103, Test accuracy: 55.99
Round   8, Global train loss: 1.095, Global test loss: 1.671, Global test accuracy: 41.92
Round   9, Train loss: 1.036, Test loss: 1.113, Test accuracy: 56.87
Round   9, Global train loss: 1.036, Global test loss: 1.781, Global test accuracy: 36.24
Round  10, Train loss: 1.082, Test loss: 1.055, Test accuracy: 59.92
Round  10, Global train loss: 1.082, Global test loss: 1.594, Global test accuracy: 42.72
Round  11, Train loss: 1.049, Test loss: 1.012, Test accuracy: 61.91
Round  11, Global train loss: 1.049, Global test loss: 1.494, Global test accuracy: 47.23
Round  12, Train loss: 1.071, Test loss: 1.021, Test accuracy: 62.06
Round  12, Global train loss: 1.071, Global test loss: 1.544, Global test accuracy: 44.38
Round  13, Train loss: 0.890, Test loss: 0.980, Test accuracy: 63.29
Round  13, Global train loss: 0.890, Global test loss: 1.524, Global test accuracy: 48.45
Round  14, Train loss: 0.900, Test loss: 0.970, Test accuracy: 63.60
Round  14, Global train loss: 0.900, Global test loss: 1.544, Global test accuracy: 45.00
Round  15, Train loss: 0.931, Test loss: 0.969, Test accuracy: 63.80
Round  15, Global train loss: 0.931, Global test loss: 1.404, Global test accuracy: 49.55
Round  16, Train loss: 0.921, Test loss: 0.975, Test accuracy: 63.78
Round  16, Global train loss: 0.921, Global test loss: 1.579, Global test accuracy: 43.33
Round  17, Train loss: 0.851, Test loss: 0.954, Test accuracy: 64.66
Round  17, Global train loss: 0.851, Global test loss: 1.449, Global test accuracy: 49.40
Round  18, Train loss: 0.842, Test loss: 0.968, Test accuracy: 64.25
Round  18, Global train loss: 0.842, Global test loss: 1.389, Global test accuracy: 50.15
Round  19, Train loss: 0.903, Test loss: 0.968, Test accuracy: 64.78
Round  19, Global train loss: 0.903, Global test loss: 1.465, Global test accuracy: 48.77
Round  20, Train loss: 0.842, Test loss: 0.947, Test accuracy: 65.05
Round  20, Global train loss: 0.842, Global test loss: 1.469, Global test accuracy: 48.67
Round  21, Train loss: 0.824, Test loss: 0.949, Test accuracy: 65.25
Round  21, Global train loss: 0.824, Global test loss: 1.507, Global test accuracy: 48.10
Round  22, Train loss: 0.813, Test loss: 0.936, Test accuracy: 66.04
Round  22, Global train loss: 0.813, Global test loss: 1.477, Global test accuracy: 49.22
Round  23, Train loss: 0.873, Test loss: 0.920, Test accuracy: 66.44
Round  23, Global train loss: 0.873, Global test loss: 1.379, Global test accuracy: 50.43
Round  24, Train loss: 0.826, Test loss: 0.925, Test accuracy: 66.64
Round  24, Global train loss: 0.826, Global test loss: 1.297, Global test accuracy: 53.54
Round  25, Train loss: 0.764, Test loss: 0.928, Test accuracy: 66.68
Round  25, Global train loss: 0.764, Global test loss: 1.389, Global test accuracy: 53.19
Round  26, Train loss: 0.808, Test loss: 0.933, Test accuracy: 66.15
Round  26, Global train loss: 0.808, Global test loss: 1.296, Global test accuracy: 55.75
Round  27, Train loss: 0.780, Test loss: 0.944, Test accuracy: 65.72
Round  27, Global train loss: 0.780, Global test loss: 1.231, Global test accuracy: 56.53
Round  28, Train loss: 0.705, Test loss: 0.928, Test accuracy: 66.16
Round  28, Global train loss: 0.705, Global test loss: 1.245, Global test accuracy: 57.29
Round  29, Train loss: 0.807, Test loss: 0.909, Test accuracy: 66.85
Round  29, Global train loss: 0.807, Global test loss: 1.261, Global test accuracy: 57.29
Round  30, Train loss: 0.786, Test loss: 0.898, Test accuracy: 66.98
Round  30, Global train loss: 0.786, Global test loss: 1.390, Global test accuracy: 53.59
Round  31, Train loss: 0.787, Test loss: 0.894, Test accuracy: 67.50
Round  31, Global train loss: 0.787, Global test loss: 1.294, Global test accuracy: 56.84
Round  32, Train loss: 0.707, Test loss: 0.888, Test accuracy: 67.96
Round  32, Global train loss: 0.707, Global test loss: 1.282, Global test accuracy: 55.12
Round  33, Train loss: 0.649, Test loss: 0.899, Test accuracy: 67.88
Round  33, Global train loss: 0.649, Global test loss: 1.449, Global test accuracy: 50.52
Round  34, Train loss: 0.681, Test loss: 0.900, Test accuracy: 68.13
Round  34, Global train loss: 0.681, Global test loss: 1.403, Global test accuracy: 52.79
Round  35, Train loss: 0.707, Test loss: 0.901, Test accuracy: 68.19
Round  35, Global train loss: 0.707, Global test loss: 1.357, Global test accuracy: 54.24
Round  36, Train loss: 0.635, Test loss: 0.891, Test accuracy: 68.46
Round  36, Global train loss: 0.635, Global test loss: 1.400, Global test accuracy: 53.59
Round  37, Train loss: 0.626, Test loss: 0.896, Test accuracy: 68.43
Round  37, Global train loss: 0.626, Global test loss: 1.341, Global test accuracy: 54.40
Round  38, Train loss: 0.737, Test loss: 0.889, Test accuracy: 68.90
Round  38, Global train loss: 0.737, Global test loss: 1.372, Global test accuracy: 55.30
Round  39, Train loss: 0.621, Test loss: 0.913, Test accuracy: 68.03
Round  39, Global train loss: 0.621, Global test loss: 1.537, Global test accuracy: 49.36
Round  40, Train loss: 0.694, Test loss: 0.922, Test accuracy: 68.13
Round  40, Global train loss: 0.694, Global test loss: 1.237, Global test accuracy: 58.72
Round  41, Train loss: 0.639, Test loss: 0.910, Test accuracy: 68.51
Round  41, Global train loss: 0.639, Global test loss: 1.163, Global test accuracy: 60.51
Round  42, Train loss: 0.566, Test loss: 0.925, Test accuracy: 68.12
Round  42, Global train loss: 0.566, Global test loss: 1.280, Global test accuracy: 57.89
Round  43, Train loss: 0.705, Test loss: 0.921, Test accuracy: 68.46
Round  43, Global train loss: 0.705, Global test loss: 1.256, Global test accuracy: 57.98
Round  44, Train loss: 0.598, Test loss: 0.897, Test accuracy: 69.29
Round  44, Global train loss: 0.598, Global test loss: 1.366, Global test accuracy: 57.60
Round  45, Train loss: 0.616, Test loss: 0.879, Test accuracy: 69.59
Round  45, Global train loss: 0.616, Global test loss: 1.195, Global test accuracy: 58.69
Round  46, Train loss: 0.653, Test loss: 0.879, Test accuracy: 69.30
Round  46, Global train loss: 0.653, Global test loss: 1.173, Global test accuracy: 59.89
Round  47, Train loss: 0.738, Test loss: 0.895, Test accuracy: 69.49
Round  47, Global train loss: 0.738, Global test loss: 1.280, Global test accuracy: 56.54
Round  48, Train loss: 0.698, Test loss: 0.882, Test accuracy: 69.85
Round  48, Global train loss: 0.698, Global test loss: 1.201, Global test accuracy: 59.06
Round  49, Train loss: 0.596, Test loss: 0.905, Test accuracy: 69.70
Round  49, Global train loss: 0.596, Global test loss: 1.261, Global test accuracy: 57.52
Round  50, Train loss: 0.628, Test loss: 0.901, Test accuracy: 70.40
Round  50, Global train loss: 0.628, Global test loss: 1.212, Global test accuracy: 59.27
Round  51, Train loss: 0.590, Test loss: 0.893, Test accuracy: 70.36
Round  51, Global train loss: 0.590, Global test loss: 1.172, Global test accuracy: 60.82
Round  52, Train loss: 0.546, Test loss: 0.896, Test accuracy: 70.63
Round  52, Global train loss: 0.546, Global test loss: 1.251, Global test accuracy: 57.87
Round  53, Train loss: 0.539, Test loss: 0.910, Test accuracy: 70.19
Round  53, Global train loss: 0.539, Global test loss: 1.278, Global test accuracy: 58.41
Round  54, Train loss: 0.590, Test loss: 0.908, Test accuracy: 70.34
Round  54, Global train loss: 0.590, Global test loss: 1.340, Global test accuracy: 56.33
Round  55, Train loss: 0.562, Test loss: 0.916, Test accuracy: 70.20
Round  55, Global train loss: 0.562, Global test loss: 1.260, Global test accuracy: 59.13
Round  56, Train loss: 0.564, Test loss: 0.927, Test accuracy: 69.56
Round  56, Global train loss: 0.564, Global test loss: 1.301, Global test accuracy: 57.67
Round  57, Train loss: 0.545, Test loss: 0.964, Test accuracy: 68.86
Round  57, Global train loss: 0.545, Global test loss: 1.240, Global test accuracy: 58.98
Round  58, Train loss: 0.488, Test loss: 0.935, Test accuracy: 69.92
Round  58, Global train loss: 0.488, Global test loss: 1.210, Global test accuracy: 59.93
Round  59, Train loss: 0.476, Test loss: 0.943, Test accuracy: 69.77
Round  59, Global train loss: 0.476, Global test loss: 1.180, Global test accuracy: 61.12
Round  60, Train loss: 0.545, Test loss: 0.933, Test accuracy: 69.99
Round  60, Global train loss: 0.545, Global test loss: 1.453, Global test accuracy: 56.01
Round  61, Train loss: 0.537, Test loss: 0.936, Test accuracy: 70.04
Round  61, Global train loss: 0.537, Global test loss: 1.294, Global test accuracy: 58.36
Round  62, Train loss: 0.461, Test loss: 0.938, Test accuracy: 70.28
Round  62, Global train loss: 0.461, Global test loss: 1.303, Global test accuracy: 60.04
Round  63, Train loss: 0.450, Test loss: 0.935, Test accuracy: 70.47
Round  63, Global train loss: 0.450, Global test loss: 1.200, Global test accuracy: 61.19
Round  64, Train loss: 0.487, Test loss: 0.937, Test accuracy: 70.44
Round  64, Global train loss: 0.487, Global test loss: 1.268, Global test accuracy: 59.18
Round  65, Train loss: 0.552, Test loss: 0.962, Test accuracy: 69.90
Round  65, Global train loss: 0.552, Global test loss: 1.306, Global test accuracy: 58.97
Round  66, Train loss: 0.454, Test loss: 0.972, Test accuracy: 69.94
Round  66, Global train loss: 0.454, Global test loss: 1.433, Global test accuracy: 56.21
Round  67, Train loss: 0.587, Test loss: 0.990, Test accuracy: 70.07
Round  67, Global train loss: 0.587, Global test loss: 1.221, Global test accuracy: 59.64
Round  68, Train loss: 0.403, Test loss: 0.970, Test accuracy: 70.19
Round  68, Global train loss: 0.403, Global test loss: 1.254, Global test accuracy: 60.80
Round  69, Train loss: 0.578, Test loss: 0.974, Test accuracy: 69.44
Round  69, Global train loss: 0.578, Global test loss: 1.201, Global test accuracy: 60.25
Round  70, Train loss: 0.467, Test loss: 0.960, Test accuracy: 70.12
Round  70, Global train loss: 0.467, Global test loss: 1.479, Global test accuracy: 56.04
Round  71, Train loss: 0.463, Test loss: 0.977, Test accuracy: 69.90
Round  71, Global train loss: 0.463, Global test loss: 1.259, Global test accuracy: 60.55
Round  72, Train loss: 0.443, Test loss: 0.985, Test accuracy: 69.78
Round  72, Global train loss: 0.443, Global test loss: 1.230, Global test accuracy: 62.31
Round  73, Train loss: 0.430, Test loss: 0.971, Test accuracy: 70.42
Round  73, Global train loss: 0.430, Global test loss: 1.242, Global test accuracy: 60.84
Round  74, Train loss: 0.421, Test loss: 0.972, Test accuracy: 70.29
Round  74, Global train loss: 0.421, Global test loss: 1.293, Global test accuracy: 61.51
Round  75, Train loss: 0.535, Test loss: 0.980, Test accuracy: 70.43
Round  75, Global train loss: 0.535, Global test loss: 1.298, Global test accuracy: 60.43
Round  76, Train loss: 0.408, Test loss: 0.974, Test accuracy: 70.51
Round  76, Global train loss: 0.408, Global test loss: 1.218, Global test accuracy: 62.86
Round  77, Train loss: 0.383, Test loss: 0.999, Test accuracy: 70.11
Round  77, Global train loss: 0.383, Global test loss: 1.238, Global test accuracy: 62.62
Round  78, Train loss: 0.357, Test loss: 0.994, Test accuracy: 70.33
Round  78, Global train loss: 0.357, Global test loss: 1.247, Global test accuracy: 61.96
Round  79, Train loss: 0.521, Test loss: 1.004, Test accuracy: 70.50
Round  79, Global train loss: 0.521, Global test loss: 1.276, Global test accuracy: 59.11
Round  80, Train loss: 0.478, Test loss: 1.005, Test accuracy: 70.43
Round  80, Global train loss: 0.478, Global test loss: 1.233, Global test accuracy: 61.38
Round  81, Train loss: 0.403, Test loss: 1.000, Test accuracy: 70.45
Round  81, Global train loss: 0.403, Global test loss: 1.292, Global test accuracy: 60.79
Round  82, Train loss: 0.484, Test loss: 0.992, Test accuracy: 70.31
Round  82, Global train loss: 0.484, Global test loss: 1.236, Global test accuracy: 60.49
Round  83, Train loss: 0.478, Test loss: 0.990, Test accuracy: 70.56
Round  83, Global train loss: 0.478, Global test loss: 1.311, Global test accuracy: 58.75
Round  84, Train loss: 0.380, Test loss: 1.015, Test accuracy: 70.29
Round  84, Global train loss: 0.380, Global test loss: 1.427, Global test accuracy: 57.10
Round  85, Train loss: 0.393, Test loss: 1.010, Test accuracy: 70.75
Round  85, Global train loss: 0.393, Global test loss: 1.268, Global test accuracy: 61.86
Round  86, Train loss: 0.409, Test loss: 1.015, Test accuracy: 70.98
Round  86, Global train loss: 0.409, Global test loss: 1.301, Global test accuracy: 61.54
Round  87, Train loss: 0.424, Test loss: 1.028, Test accuracy: 70.75
Round  87, Global train loss: 0.424, Global test loss: 1.366, Global test accuracy: 59.10
Round  88, Train loss: 0.443, Test loss: 1.028, Test accuracy: 70.43
Round  88, Global train loss: 0.443, Global test loss: 1.346, Global test accuracy: 59.14
Round  89, Train loss: 0.362, Test loss: 1.061, Test accuracy: 69.70
Round  89, Global train loss: 0.362, Global test loss: 1.421, Global test accuracy: 60.62
Round  90, Train loss: 0.427, Test loss: 1.042, Test accuracy: 70.06
Round  90, Global train loss: 0.427, Global test loss: 1.242, Global test accuracy: 62.66
Round  91, Train loss: 0.408, Test loss: 1.025, Test accuracy: 70.79
Round  91, Global train loss: 0.408, Global test loss: 1.299, Global test accuracy: 61.89
Round  92, Train loss: 0.413, Test loss: 1.017, Test accuracy: 70.98
Round  92, Global train loss: 0.413, Global test loss: 1.341, Global test accuracy: 60.15
Round  93, Train loss: 0.362, Test loss: 1.017, Test accuracy: 70.85
Round  93, Global train loss: 0.362, Global test loss: 1.309, Global test accuracy: 61.25
Round  94, Train loss: 0.385, Test loss: 1.017, Test accuracy: 70.96
Round  94, Global train loss: 0.385, Global test loss: 1.401, Global test accuracy: 58.84
Round  95, Train loss: 0.428, Test loss: 1.025, Test accuracy: 71.11
Round  95, Global train loss: 0.428, Global test loss: 1.317, Global test accuracy: 60.75
Round  96, Train loss: 0.341, Test loss: 1.024, Test accuracy: 71.12
Round  96, Global train loss: 0.341, Global test loss: 1.420, Global test accuracy: 59.94
Round  97, Train loss: 0.332, Test loss: 1.028, Test accuracy: 71.08
Round  97, Global train loss: 0.332, Global test loss: 1.328, Global test accuracy: 61.13
Round  98, Train loss: 0.442, Test loss: 1.027, Test accuracy: 71.05
Round  98, Global train loss: 0.442, Global test loss: 1.204, Global test accuracy: 62.53
Round  99, Train loss: 0.325, Test loss: 1.027, Test accuracy: 71.17
Round  99, Global train loss: 0.325, Global test loss: 1.420, Global test accuracy: 59.02
Final Round, Train loss: 0.297, Test loss: 1.151, Test accuracy: 70.39
Final Round, Global train loss: 0.297, Global test loss: 1.420, Global test accuracy: 59.02
Average accuracy final 10 rounds: 70.91699999999999
Average global accuracy final 10 rounds: 60.816
1668.05175948143
[1.3406381607055664, 2.458277463912964, 3.5780224800109863, 4.707638502120972, 5.833040714263916, 6.96410870552063, 8.092305898666382, 9.209357738494873, 10.330393314361572, 11.445578336715698, 12.5586416721344, 13.679515600204468, 14.807639360427856, 15.936200857162476, 17.06251335144043, 18.189523220062256, 19.31555724143982, 20.438648223876953, 21.552731037139893, 22.663918495178223, 23.782104969024658, 26.055787086486816, 28.34304666519165, 30.615190267562866, 32.88983178138733, 35.15274524688721, 37.443603515625, 39.73683500289917, 42.027498722076416, 44.31015968322754, 46.61008048057556, 48.889509439468384, 51.149007081985474, 53.41540789604187, 55.66653251647949, 57.929364919662476, 60.19046950340271, 62.454184770584106, 64.70461344718933, 66.95929336547852, 69.30910682678223, 71.5620551109314, 73.83443808555603, 76.12331795692444, 78.4104642868042, 80.67652750015259, 82.96844601631165, 85.25699138641357, 87.53831171989441, 89.80914449691772, 92.07483458518982, 94.34482145309448, 96.6271493434906, 98.89705538749695, 101.1734938621521, 103.43425798416138, 105.69767045974731, 107.96552467346191, 110.2261893749237, 112.49424862861633, 114.75209403038025, 117.01276659965515, 119.2678804397583, 121.53183937072754, 123.78241896629333, 126.04608249664307, 128.29721927642822, 130.55977201461792, 132.82806515693665, 135.0886549949646, 137.34729385375977, 139.6046645641327, 141.91808700561523, 144.18625688552856, 146.44451785087585, 148.71046948432922, 150.97338438034058, 153.2368938922882, 155.52376770973206, 157.81663346290588, 160.1071810722351, 162.36380863189697, 164.6523094177246, 166.9382004737854, 169.07162261009216, 171.18769764900208, 173.3022005558014, 175.41609501838684, 177.5455470085144, 179.65974259376526, 181.76912689208984, 183.88684558868408, 186.00148129463196, 188.10783910751343, 190.22299361228943, 192.33718872070312, 194.45189666748047, 196.56298184394836, 198.6480450630188, 200.73271107673645, 202.6558871269226]
[27.14, 29.65, 42.82, 45.41, 50.6, 52.45, 54.62, 54.72, 55.99, 56.87, 59.92, 61.91, 62.06, 63.29, 63.6, 63.8, 63.78, 64.66, 64.25, 64.78, 65.05, 65.25, 66.04, 66.44, 66.64, 66.68, 66.15, 65.72, 66.16, 66.85, 66.98, 67.5, 67.96, 67.88, 68.13, 68.19, 68.46, 68.43, 68.9, 68.03, 68.13, 68.51, 68.12, 68.46, 69.29, 69.59, 69.3, 69.49, 69.85, 69.7, 70.4, 70.36, 70.63, 70.19, 70.34, 70.2, 69.56, 68.86, 69.92, 69.77, 69.99, 70.04, 70.28, 70.47, 70.44, 69.9, 69.94, 70.07, 70.19, 69.44, 70.12, 69.9, 69.78, 70.42, 70.29, 70.43, 70.51, 70.11, 70.33, 70.5, 70.43, 70.45, 70.31, 70.56, 70.29, 70.75, 70.98, 70.75, 70.43, 69.7, 70.06, 70.79, 70.98, 70.85, 70.96, 71.11, 71.12, 71.08, 71.05, 71.17, 70.39]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.555, Test loss: 1.288, Test accuracy: 48.02
Round   0, Global train loss: 1.555, Global test loss: 2.133, Global test accuracy: 27.46
Round   1, Train loss: 1.339, Test loss: 1.156, Test accuracy: 55.53
Round   1, Global train loss: 1.339, Global test loss: 1.805, Global test accuracy: 34.96
Round   2, Train loss: 1.220, Test loss: 1.101, Test accuracy: 59.29
Round   2, Global train loss: 1.220, Global test loss: 1.652, Global test accuracy: 41.12
Round   3, Train loss: 1.151, Test loss: 1.079, Test accuracy: 60.10
Round   3, Global train loss: 1.151, Global test loss: 1.562, Global test accuracy: 44.31
Round   4, Train loss: 1.093, Test loss: 1.073, Test accuracy: 60.24
Round   4, Global train loss: 1.093, Global test loss: 1.489, Global test accuracy: 47.35
Round   5, Train loss: 1.044, Test loss: 1.052, Test accuracy: 61.97
Round   5, Global train loss: 1.044, Global test loss: 1.437, Global test accuracy: 49.56
Round   6, Train loss: 0.998, Test loss: 1.040, Test accuracy: 62.27
Round   6, Global train loss: 0.998, Global test loss: 1.373, Global test accuracy: 51.93
Round   7, Train loss: 0.953, Test loss: 1.040, Test accuracy: 63.01
Round   7, Global train loss: 0.953, Global test loss: 1.336, Global test accuracy: 53.52
Round   8, Train loss: 0.913, Test loss: 1.008, Test accuracy: 63.90
Round   8, Global train loss: 0.913, Global test loss: 1.290, Global test accuracy: 55.11
Round   9, Train loss: 0.873, Test loss: 1.013, Test accuracy: 64.94
Round   9, Global train loss: 0.873, Global test loss: 1.270, Global test accuracy: 55.69
Round  10, Train loss: 0.809, Test loss: 1.013, Test accuracy: 64.55
Round  10, Global train loss: 0.809, Global test loss: 1.498, Global test accuracy: 46.39
Round  11, Train loss: 0.816, Test loss: 1.005, Test accuracy: 64.69
Round  11, Global train loss: 0.816, Global test loss: 1.356, Global test accuracy: 53.17
Round  12, Train loss: 0.887, Test loss: 1.023, Test accuracy: 64.45
Round  12, Global train loss: 0.887, Global test loss: 1.403, Global test accuracy: 51.31
Round  13, Train loss: 0.777, Test loss: 1.029, Test accuracy: 64.78
Round  13, Global train loss: 0.777, Global test loss: 1.345, Global test accuracy: 54.89
Round  14, Train loss: 0.648, Test loss: 1.062, Test accuracy: 64.14
Round  14, Global train loss: 0.648, Global test loss: 1.442, Global test accuracy: 51.53
Round  15, Train loss: 0.727, Test loss: 1.074, Test accuracy: 64.36
Round  15, Global train loss: 0.727, Global test loss: 1.383, Global test accuracy: 52.49
Round  16, Train loss: 0.649, Test loss: 1.085, Test accuracy: 64.29
Round  16, Global train loss: 0.649, Global test loss: 1.705, Global test accuracy: 47.22
Round  17, Train loss: 0.620, Test loss: 1.084, Test accuracy: 64.93
Round  17, Global train loss: 0.620, Global test loss: 1.390, Global test accuracy: 53.31
Round  18, Train loss: 0.572, Test loss: 1.097, Test accuracy: 64.50
Round  18, Global train loss: 0.572, Global test loss: 1.492, Global test accuracy: 52.01
Round  19, Train loss: 0.572, Test loss: 1.080, Test accuracy: 65.69
Round  19, Global train loss: 0.572, Global test loss: 1.468, Global test accuracy: 53.41
Round  20, Train loss: 0.649, Test loss: 1.118, Test accuracy: 65.53
Round  20, Global train loss: 0.649, Global test loss: 1.556, Global test accuracy: 52.19
Round  21, Train loss: 0.539, Test loss: 1.113, Test accuracy: 66.05
Round  21, Global train loss: 0.539, Global test loss: 1.580, Global test accuracy: 48.92
Round  22, Train loss: 0.554, Test loss: 1.151, Test accuracy: 65.49
Round  22, Global train loss: 0.554, Global test loss: 1.528, Global test accuracy: 53.02
Round  23, Train loss: 0.512, Test loss: 1.157, Test accuracy: 65.33
Round  23, Global train loss: 0.512, Global test loss: 1.362, Global test accuracy: 55.86
Round  24, Train loss: 0.484, Test loss: 1.153, Test accuracy: 65.94
Round  24, Global train loss: 0.484, Global test loss: 1.342, Global test accuracy: 56.87
Round  25, Train loss: 0.451, Test loss: 1.171, Test accuracy: 65.85
Round  25, Global train loss: 0.451, Global test loss: 1.523, Global test accuracy: 54.78
Round  26, Train loss: 0.492, Test loss: 1.177, Test accuracy: 65.86
Round  26, Global train loss: 0.492, Global test loss: 1.451, Global test accuracy: 54.94
Round  27, Train loss: 0.548, Test loss: 1.197, Test accuracy: 66.24
Round  27, Global train loss: 0.548, Global test loss: 1.293, Global test accuracy: 57.47
Round  28, Train loss: 0.382, Test loss: 1.198, Test accuracy: 66.50
Round  28, Global train loss: 0.382, Global test loss: 1.367, Global test accuracy: 58.73
Round  29, Train loss: 0.452, Test loss: 1.205, Test accuracy: 66.61
Round  29, Global train loss: 0.452, Global test loss: 1.379, Global test accuracy: 58.91
Round  30, Train loss: 0.426, Test loss: 1.214, Test accuracy: 66.19
Round  30, Global train loss: 0.426, Global test loss: 1.529, Global test accuracy: 56.79
Round  31, Train loss: 0.370, Test loss: 1.231, Test accuracy: 66.41
Round  31, Global train loss: 0.370, Global test loss: 1.457, Global test accuracy: 58.09
Round  32, Train loss: 0.513, Test loss: 1.224, Test accuracy: 66.52
Round  32, Global train loss: 0.513, Global test loss: 1.418, Global test accuracy: 55.87
Round  33, Train loss: 0.460, Test loss: 1.239, Test accuracy: 66.59
Round  33, Global train loss: 0.460, Global test loss: 1.723, Global test accuracy: 51.94
Round  34, Train loss: 0.385, Test loss: 1.243, Test accuracy: 66.49
Round  34, Global train loss: 0.385, Global test loss: 1.629, Global test accuracy: 54.93
Round  35, Train loss: 0.419, Test loss: 1.270, Test accuracy: 66.36
Round  35, Global train loss: 0.419, Global test loss: 1.480, Global test accuracy: 56.84
Round  36, Train loss: 0.362, Test loss: 1.257, Test accuracy: 67.00
Round  36, Global train loss: 0.362, Global test loss: 1.622, Global test accuracy: 54.90
Round  37, Train loss: 0.395, Test loss: 1.238, Test accuracy: 67.51
Round  37, Global train loss: 0.395, Global test loss: 1.549, Global test accuracy: 55.35
Round  38, Train loss: 0.447, Test loss: 1.289, Test accuracy: 67.07
Round  38, Global train loss: 0.447, Global test loss: 1.711, Global test accuracy: 54.57
Round  39, Train loss: 0.400, Test loss: 1.312, Test accuracy: 66.62
Round  39, Global train loss: 0.400, Global test loss: 1.626, Global test accuracy: 54.46
Round  40, Train loss: 0.405, Test loss: 1.309, Test accuracy: 66.59
Round  40, Global train loss: 0.405, Global test loss: 1.578, Global test accuracy: 55.55
Round  41, Train loss: 0.371, Test loss: 1.319, Test accuracy: 66.53
Round  41, Global train loss: 0.371, Global test loss: 1.405, Global test accuracy: 58.17
Round  42, Train loss: 0.285, Test loss: 1.341, Test accuracy: 66.39
Round  42, Global train loss: 0.285, Global test loss: 1.631, Global test accuracy: 55.57
Round  43, Train loss: 0.395, Test loss: 1.366, Test accuracy: 66.22
Round  43, Global train loss: 0.395, Global test loss: 1.595, Global test accuracy: 57.23
Round  44, Train loss: 0.366, Test loss: 1.386, Test accuracy: 66.11
Round  44, Global train loss: 0.366, Global test loss: 1.611, Global test accuracy: 57.91
Round  45, Train loss: 0.337, Test loss: 1.382, Test accuracy: 66.32
Round  45, Global train loss: 0.337, Global test loss: 1.449, Global test accuracy: 59.05
Round  46, Train loss: 0.366, Test loss: 1.373, Test accuracy: 66.80
Round  46, Global train loss: 0.366, Global test loss: 1.492, Global test accuracy: 57.86
Round  47, Train loss: 0.474, Test loss: 1.391, Test accuracy: 66.63
Round  47, Global train loss: 0.474, Global test loss: 1.476, Global test accuracy: 56.38
Round  48, Train loss: 0.327, Test loss: 1.387, Test accuracy: 66.91
Round  48, Global train loss: 0.327, Global test loss: 1.499, Global test accuracy: 57.83
Round  49, Train loss: 0.376, Test loss: 1.425, Test accuracy: 66.28
Round  49, Global train loss: 0.376, Global test loss: 1.549, Global test accuracy: 56.86
Round  50, Train loss: 0.348, Test loss: 1.409, Test accuracy: 66.63
Round  50, Global train loss: 0.348, Global test loss: 1.483, Global test accuracy: 57.86
Round  51, Train loss: 0.294, Test loss: 1.434, Test accuracy: 66.53
Round  51, Global train loss: 0.294, Global test loss: 1.588, Global test accuracy: 58.19
Round  52, Train loss: 0.363, Test loss: 1.403, Test accuracy: 67.32
Round  52, Global train loss: 0.363, Global test loss: 1.544, Global test accuracy: 57.41
Round  53, Train loss: 0.305, Test loss: 1.422, Test accuracy: 67.49
Round  53, Global train loss: 0.305, Global test loss: 1.687, Global test accuracy: 57.99
Round  54, Train loss: 0.364, Test loss: 1.440, Test accuracy: 66.89
Round  54, Global train loss: 0.364, Global test loss: 1.684, Global test accuracy: 56.01
Round  55, Train loss: 0.332, Test loss: 1.398, Test accuracy: 67.73
Round  55, Global train loss: 0.332, Global test loss: 1.556, Global test accuracy: 57.96
Round  56, Train loss: 0.381, Test loss: 1.422, Test accuracy: 67.23
Round  56, Global train loss: 0.381, Global test loss: 1.852, Global test accuracy: 52.10
Round  57, Train loss: 0.314, Test loss: 1.431, Test accuracy: 67.64
Round  57, Global train loss: 0.314, Global test loss: 1.767, Global test accuracy: 55.23
Round  58, Train loss: 0.316, Test loss: 1.472, Test accuracy: 67.24
Round  58, Global train loss: 0.316, Global test loss: 1.705, Global test accuracy: 57.89
Round  59, Train loss: 0.275, Test loss: 1.490, Test accuracy: 66.50
Round  59, Global train loss: 0.275, Global test loss: 1.585, Global test accuracy: 57.98
Round  60, Train loss: 0.325, Test loss: 1.484, Test accuracy: 66.64
Round  60, Global train loss: 0.325, Global test loss: 1.870, Global test accuracy: 53.98
Round  61, Train loss: 0.286, Test loss: 1.465, Test accuracy: 66.84
Round  61, Global train loss: 0.286, Global test loss: 1.554, Global test accuracy: 58.35
Round  62, Train loss: 0.296, Test loss: 1.500, Test accuracy: 66.82
Round  62, Global train loss: 0.296, Global test loss: 1.690, Global test accuracy: 57.07
Round  63, Train loss: 0.285, Test loss: 1.507, Test accuracy: 66.78
Round  63, Global train loss: 0.285, Global test loss: 1.669, Global test accuracy: 55.97
Round  64, Train loss: 0.250, Test loss: 1.489, Test accuracy: 66.67
Round  64, Global train loss: 0.250, Global test loss: 1.670, Global test accuracy: 58.08
Round  65, Train loss: 0.271, Test loss: 1.467, Test accuracy: 66.90
Round  65, Global train loss: 0.271, Global test loss: 1.697, Global test accuracy: 57.51
Round  66, Train loss: 0.302, Test loss: 1.513, Test accuracy: 66.51
Round  66, Global train loss: 0.302, Global test loss: 1.832, Global test accuracy: 54.75
Round  67, Train loss: 0.309, Test loss: 1.496, Test accuracy: 66.76
Round  67, Global train loss: 0.309, Global test loss: 1.617, Global test accuracy: 57.65
Round  68, Train loss: 0.219, Test loss: 1.506, Test accuracy: 66.78
Round  68, Global train loss: 0.219, Global test loss: 1.543, Global test accuracy: 60.28
Round  69, Train loss: 0.297, Test loss: 1.492, Test accuracy: 66.98
Round  69, Global train loss: 0.297, Global test loss: 1.496, Global test accuracy: 59.91
Round  70, Train loss: 0.263, Test loss: 1.467, Test accuracy: 67.58
Round  70, Global train loss: 0.263, Global test loss: 1.923, Global test accuracy: 55.19
Round  71, Train loss: 0.267, Test loss: 1.470, Test accuracy: 67.32
Round  71, Global train loss: 0.267, Global test loss: 1.564, Global test accuracy: 59.69
Round  72, Train loss: 0.243, Test loss: 1.466, Test accuracy: 67.66
Round  72, Global train loss: 0.243, Global test loss: 1.674, Global test accuracy: 58.43
Round  73, Train loss: 0.278, Test loss: 1.470, Test accuracy: 68.01
Round  73, Global train loss: 0.278, Global test loss: 1.724, Global test accuracy: 55.82
Round  74, Train loss: 0.257, Test loss: 1.456, Test accuracy: 68.15
Round  74, Global train loss: 0.257, Global test loss: 1.571, Global test accuracy: 59.99
Round  75, Train loss: 0.259, Test loss: 1.489, Test accuracy: 67.90
Round  75, Global train loss: 0.259, Global test loss: 1.711, Global test accuracy: 58.47
Round  76, Train loss: 0.229, Test loss: 1.509, Test accuracy: 68.04
Round  76, Global train loss: 0.229, Global test loss: 1.585, Global test accuracy: 60.99
Round  77, Train loss: 0.234, Test loss: 1.536, Test accuracy: 67.84
Round  77, Global train loss: 0.234, Global test loss: 1.663, Global test accuracy: 58.29
Round  78, Train loss: 0.253, Test loss: 1.521, Test accuracy: 67.82
Round  78, Global train loss: 0.253, Global test loss: 1.758, Global test accuracy: 56.43
Round  79, Train loss: 0.291, Test loss: 1.528, Test accuracy: 68.15
Round  79, Global train loss: 0.291, Global test loss: 1.813, Global test accuracy: 55.83
Round  80, Train loss: 0.206, Test loss: 1.567, Test accuracy: 67.75
Round  80, Global train loss: 0.206, Global test loss: 1.549, Global test accuracy: 61.18
Round  81, Train loss: 0.191, Test loss: 1.585, Test accuracy: 67.61
Round  81, Global train loss: 0.191, Global test loss: 1.538, Global test accuracy: 61.77
Round  82, Train loss: 0.173, Test loss: 1.549, Test accuracy: 67.85
Round  82, Global train loss: 0.173, Global test loss: 1.627, Global test accuracy: 59.90
Round  83, Train loss: 0.174, Test loss: 1.567, Test accuracy: 67.94
Round  83, Global train loss: 0.174, Global test loss: 1.675, Global test accuracy: 59.78
Round  84, Train loss: 0.157, Test loss: 1.573, Test accuracy: 68.14
Round  84, Global train loss: 0.157, Global test loss: 1.715, Global test accuracy: 59.27
Round  85, Train loss: 0.150, Test loss: 1.576, Test accuracy: 68.18
Round  85, Global train loss: 0.150, Global test loss: 1.769, Global test accuracy: 59.59
Round  86, Train loss: 0.148, Test loss: 1.582, Test accuracy: 67.87
Round  86, Global train loss: 0.148, Global test loss: 1.741, Global test accuracy: 59.92
Round  87, Train loss: 0.151, Test loss: 1.571, Test accuracy: 68.04
Round  87, Global train loss: 0.151, Global test loss: 1.746, Global test accuracy: 59.47
Round  88, Train loss: 0.145, Test loss: 1.590, Test accuracy: 68.06
Round  88, Global train loss: 0.145, Global test loss: 1.749, Global test accuracy: 60.23
Round  89, Train loss: 0.133, Test loss: 1.606, Test accuracy: 68.26
Round  89, Global train loss: 0.133, Global test loss: 1.784, Global test accuracy: 60.52
Round  90, Train loss: 0.248, Test loss: 1.590, Test accuracy: 67.59
Round  90, Global train loss: 0.248, Global test loss: 1.517, Global test accuracy: 61.74
Round  91, Train loss: 0.222, Test loss: 1.550, Test accuracy: 68.52
Round  91, Global train loss: 0.222, Global test loss: 1.498, Global test accuracy: 62.40
Round  92, Train loss: 0.216, Test loss: 1.573, Test accuracy: 68.03
Round  92, Global train loss: 0.216, Global test loss: 1.482, Global test accuracy: 62.71
Round  93, Train loss: 0.208, Test loss: 1.617, Test accuracy: 68.22
Round  93, Global train loss: 0.208, Global test loss: 1.498, Global test accuracy: 62.52
Round  94, Train loss: 0.207, Test loss: 1.610, Test accuracy: 67.68
Round  94, Global train loss: 0.207, Global test loss: 1.481, Global test accuracy: 63.01
Round  95, Train loss: 0.201, Test loss: 1.588, Test accuracy: 68.46
Round  95, Global train loss: 0.201, Global test loss: 1.493, Global test accuracy: 62.74
Round  96, Train loss: 0.202, Test loss: 1.605, Test accuracy: 68.39
Round  96, Global train loss: 0.202, Global test loss: 1.483, Global test accuracy: 62.79
Round  97, Train loss: 0.199, Test loss: 1.573, Test accuracy: 67.93
Round  97, Global train loss: 0.199, Global test loss: 1.498, Global test accuracy: 62.31
Round  98, Train loss: 0.197, Test loss: 1.594, Test accuracy: 68.19
Round  98, Global train loss: 0.197, Global test loss: 1.488, Global test accuracy: 62.40
Round  99, Train loss: 0.195, Test loss: 1.598, Test accuracy: 68.97
Round  99, Global train loss: 0.195, Global test loss: 1.494, Global test accuracy: 62.74
Final Round, Train loss: 0.150, Test loss: 1.738, Test accuracy: 67.60
Final Round, Global train loss: 0.150, Global test loss: 1.494, Global test accuracy: 62.74
Average accuracy final 10 rounds: 68.19800000000001
Average global accuracy final 10 rounds: 62.536000000000016
2281.4409141540527
[2.5122978687286377, 4.783320903778076, 6.702268362045288, 8.617608070373535, 10.535611629486084, 12.452003002166748, 14.368230819702148, 16.28464984893799, 18.210009813308716, 20.13663339614868, 22.064936876296997, 23.98900294303894, 25.913416147232056, 27.840791940689087, 29.76705503463745, 31.695183992385864, 33.62670636177063, 35.538928747177124, 37.461910009384155, 39.387274980545044, 41.31425976753235, 43.23648023605347, 45.15281128883362, 47.060150384902954, 48.973522424697876, 50.89829683303833, 52.8256356716156, 54.7408926486969, 56.67339563369751, 58.58719253540039, 60.51017165184021, 62.43756985664368, 64.37441873550415, 66.28503489494324, 68.19512486457825, 70.1151692867279, 72.03993773460388, 73.96226692199707, 75.88232183456421, 77.80853343009949, 79.73109769821167, 81.65469574928284, 83.58028221130371, 85.50668334960938, 87.43550872802734, 89.36271286010742, 91.2723376750946, 93.1955943107605, 95.12160038948059, 97.05267262458801, 98.97979187965393, 100.90337872505188, 102.82875156402588, 104.7521162033081, 106.67684578895569, 108.6005289554596, 110.52677416801453, 112.4581663608551, 114.38639211654663, 116.31340646743774, 118.22532415390015, 120.14118218421936, 122.05281090736389, 123.9786286354065, 125.90318584442139, 127.81607842445374, 129.72740960121155, 131.65180468559265, 133.5638165473938, 135.4778537750244, 137.39215421676636, 139.30763721466064, 141.22206783294678, 143.1347918510437, 145.0506420135498, 146.96462154388428, 148.87733268737793, 150.7918679714203, 152.70445895195007, 154.6171669960022, 156.53028464317322, 158.44355297088623, 160.3765320777893, 162.29036688804626, 164.20660781860352, 166.12030482292175, 168.03232502937317, 169.94715189933777, 171.87464213371277, 173.7993712425232, 175.7330939769745, 177.66316199302673, 179.58822345733643, 181.51436805725098, 183.44205570220947, 185.3596534729004, 187.30695033073425, 189.23579168319702, 191.16762113571167, 193.1003017425537, 196.95965266227722]
[48.02, 55.53, 59.29, 60.1, 60.24, 61.97, 62.27, 63.01, 63.9, 64.94, 64.55, 64.69, 64.45, 64.78, 64.14, 64.36, 64.29, 64.93, 64.5, 65.69, 65.53, 66.05, 65.49, 65.33, 65.94, 65.85, 65.86, 66.24, 66.5, 66.61, 66.19, 66.41, 66.52, 66.59, 66.49, 66.36, 67.0, 67.51, 67.07, 66.62, 66.59, 66.53, 66.39, 66.22, 66.11, 66.32, 66.8, 66.63, 66.91, 66.28, 66.63, 66.53, 67.32, 67.49, 66.89, 67.73, 67.23, 67.64, 67.24, 66.5, 66.64, 66.84, 66.82, 66.78, 66.67, 66.9, 66.51, 66.76, 66.78, 66.98, 67.58, 67.32, 67.66, 68.01, 68.15, 67.9, 68.04, 67.84, 67.82, 68.15, 67.75, 67.61, 67.85, 67.94, 68.14, 68.18, 67.87, 68.04, 68.06, 68.26, 67.59, 68.52, 68.03, 68.22, 67.68, 68.46, 68.39, 67.93, 68.19, 68.97, 67.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.575, Test loss: 1.324, Test accuracy: 46.22
Round   0, Global train loss: 1.575, Global test loss: 2.149, Global test accuracy: 28.58
Round   1, Train loss: 1.369, Test loss: 1.174, Test accuracy: 53.80
Round   1, Global train loss: 1.369, Global test loss: 1.835, Global test accuracy: 33.68
Round   2, Train loss: 1.251, Test loss: 1.117, Test accuracy: 57.34
Round   2, Global train loss: 1.251, Global test loss: 1.680, Global test accuracy: 39.24
Round   3, Train loss: 1.180, Test loss: 1.062, Test accuracy: 60.79
Round   3, Global train loss: 1.180, Global test loss: 1.569, Global test accuracy: 43.15
Round   4, Train loss: 1.120, Test loss: 1.068, Test accuracy: 60.45
Round   4, Global train loss: 1.120, Global test loss: 1.504, Global test accuracy: 45.96
Round   5, Train loss: 1.072, Test loss: 1.050, Test accuracy: 61.68
Round   5, Global train loss: 1.072, Global test loss: 1.436, Global test accuracy: 48.31
Round   6, Train loss: 1.023, Test loss: 1.021, Test accuracy: 62.94
Round   6, Global train loss: 1.023, Global test loss: 1.398, Global test accuracy: 50.47
Round   7, Train loss: 0.976, Test loss: 1.035, Test accuracy: 63.09
Round   7, Global train loss: 0.976, Global test loss: 1.352, Global test accuracy: 52.20
Round   8, Train loss: 0.935, Test loss: 1.002, Test accuracy: 64.53
Round   8, Global train loss: 0.935, Global test loss: 1.312, Global test accuracy: 53.44
Round   9, Train loss: 0.893, Test loss: 1.008, Test accuracy: 64.59
Round   9, Global train loss: 0.893, Global test loss: 1.280, Global test accuracy: 54.95
Round  10, Train loss: 0.911, Test loss: 1.008, Test accuracy: 64.76
Round  10, Global train loss: 0.911, Global test loss: 1.495, Global test accuracy: 46.93
Round  11, Train loss: 0.878, Test loss: 1.011, Test accuracy: 64.67
Round  11, Global train loss: 0.878, Global test loss: 1.450, Global test accuracy: 51.52
Round  12, Train loss: 0.858, Test loss: 1.039, Test accuracy: 64.42
Round  12, Global train loss: 0.858, Global test loss: 1.368, Global test accuracy: 52.51
Round  13, Train loss: 0.688, Test loss: 1.036, Test accuracy: 64.78
Round  13, Global train loss: 0.688, Global test loss: 1.502, Global test accuracy: 52.83
Round  14, Train loss: 0.742, Test loss: 1.054, Test accuracy: 64.94
Round  14, Global train loss: 0.742, Global test loss: 1.433, Global test accuracy: 52.74
Round  15, Train loss: 0.692, Test loss: 1.043, Test accuracy: 65.67
Round  15, Global train loss: 0.692, Global test loss: 1.323, Global test accuracy: 54.39
Round  16, Train loss: 0.664, Test loss: 1.044, Test accuracy: 65.82
Round  16, Global train loss: 0.664, Global test loss: 1.714, Global test accuracy: 46.53
Round  17, Train loss: 0.601, Test loss: 1.052, Test accuracy: 66.01
Round  17, Global train loss: 0.601, Global test loss: 1.434, Global test accuracy: 54.78
Round  18, Train loss: 0.538, Test loss: 1.059, Test accuracy: 66.36
Round  18, Global train loss: 0.538, Global test loss: 1.457, Global test accuracy: 53.72
Round  19, Train loss: 0.690, Test loss: 1.072, Test accuracy: 66.84
Round  19, Global train loss: 0.690, Global test loss: 1.437, Global test accuracy: 52.99
Round  20, Train loss: 0.584, Test loss: 1.103, Test accuracy: 66.21
Round  20, Global train loss: 0.584, Global test loss: 1.452, Global test accuracy: 53.39
Round  21, Train loss: 0.522, Test loss: 1.088, Test accuracy: 67.33
Round  21, Global train loss: 0.522, Global test loss: 1.633, Global test accuracy: 50.71
Round  22, Train loss: 0.615, Test loss: 1.127, Test accuracy: 66.31
Round  22, Global train loss: 0.615, Global test loss: 1.438, Global test accuracy: 54.34
Round  23, Train loss: 0.579, Test loss: 1.107, Test accuracy: 66.33
Round  23, Global train loss: 0.579, Global test loss: 1.457, Global test accuracy: 53.87
Round  24, Train loss: 0.581, Test loss: 1.128, Test accuracy: 66.33
Round  24, Global train loss: 0.581, Global test loss: 1.348, Global test accuracy: 56.20
Round  25, Train loss: 0.543, Test loss: 1.142, Test accuracy: 66.08
Round  25, Global train loss: 0.543, Global test loss: 1.503, Global test accuracy: 55.33
Round  26, Train loss: 0.450, Test loss: 1.159, Test accuracy: 66.32
Round  26, Global train loss: 0.450, Global test loss: 1.394, Global test accuracy: 57.02
Round  27, Train loss: 0.492, Test loss: 1.175, Test accuracy: 66.07
Round  27, Global train loss: 0.492, Global test loss: 1.295, Global test accuracy: 59.67
Round  28, Train loss: 0.430, Test loss: 1.218, Test accuracy: 65.80
Round  28, Global train loss: 0.430, Global test loss: 1.476, Global test accuracy: 57.70
Round  29, Train loss: 0.505, Test loss: 1.202, Test accuracy: 66.78
Round  29, Global train loss: 0.505, Global test loss: 1.512, Global test accuracy: 55.93
Round  30, Train loss: 0.571, Test loss: 1.224, Test accuracy: 66.57
Round  30, Global train loss: 0.571, Global test loss: 1.528, Global test accuracy: 54.81
Round  31, Train loss: 0.502, Test loss: 1.224, Test accuracy: 66.77
Round  31, Global train loss: 0.502, Global test loss: 1.504, Global test accuracy: 55.65
Round  32, Train loss: 0.473, Test loss: 1.223, Test accuracy: 67.29
Round  32, Global train loss: 0.473, Global test loss: 1.400, Global test accuracy: 55.98
Round  33, Train loss: 0.428, Test loss: 1.232, Test accuracy: 67.52
Round  33, Global train loss: 0.428, Global test loss: 1.583, Global test accuracy: 55.37
Round  34, Train loss: 0.390, Test loss: 1.250, Test accuracy: 67.33
Round  34, Global train loss: 0.390, Global test loss: 1.696, Global test accuracy: 54.14
Round  35, Train loss: 0.424, Test loss: 1.232, Test accuracy: 67.74
Round  35, Global train loss: 0.424, Global test loss: 1.682, Global test accuracy: 53.36
Round  36, Train loss: 0.351, Test loss: 1.244, Test accuracy: 67.43
Round  36, Global train loss: 0.351, Global test loss: 1.852, Global test accuracy: 51.39
Round  37, Train loss: 0.366, Test loss: 1.231, Test accuracy: 68.15
Round  37, Global train loss: 0.366, Global test loss: 1.635, Global test accuracy: 55.40
Round  38, Train loss: 0.493, Test loss: 1.232, Test accuracy: 68.12
Round  38, Global train loss: 0.493, Global test loss: 1.603, Global test accuracy: 55.97
Round  39, Train loss: 0.318, Test loss: 1.249, Test accuracy: 67.78
Round  39, Global train loss: 0.318, Global test loss: 1.727, Global test accuracy: 54.64
Round  40, Train loss: 0.397, Test loss: 1.274, Test accuracy: 67.93
Round  40, Global train loss: 0.397, Global test loss: 1.506, Global test accuracy: 58.02
Round  41, Train loss: 0.381, Test loss: 1.291, Test accuracy: 67.57
Round  41, Global train loss: 0.381, Global test loss: 1.482, Global test accuracy: 57.32
Round  42, Train loss: 0.375, Test loss: 1.333, Test accuracy: 67.23
Round  42, Global train loss: 0.375, Global test loss: 1.427, Global test accuracy: 59.37
Round  43, Train loss: 0.402, Test loss: 1.310, Test accuracy: 67.02
Round  43, Global train loss: 0.402, Global test loss: 1.513, Global test accuracy: 57.62
Round  44, Train loss: 0.329, Test loss: 1.300, Test accuracy: 67.22
Round  44, Global train loss: 0.329, Global test loss: 1.800, Global test accuracy: 56.09
Round  45, Train loss: 0.386, Test loss: 1.283, Test accuracy: 68.03
Round  45, Global train loss: 0.386, Global test loss: 1.577, Global test accuracy: 57.32
Round  46, Train loss: 0.400, Test loss: 1.292, Test accuracy: 68.18
Round  46, Global train loss: 0.400, Global test loss: 1.471, Global test accuracy: 58.31
Round  47, Train loss: 0.358, Test loss: 1.311, Test accuracy: 67.66
Round  47, Global train loss: 0.358, Global test loss: 1.425, Global test accuracy: 59.65
Round  48, Train loss: 0.386, Test loss: 1.339, Test accuracy: 67.19
Round  48, Global train loss: 0.386, Global test loss: 1.456, Global test accuracy: 58.42
Round  49, Train loss: 0.372, Test loss: 1.333, Test accuracy: 67.58
Round  49, Global train loss: 0.372, Global test loss: 1.470, Global test accuracy: 58.76
Round  50, Train loss: 0.350, Test loss: 1.325, Test accuracy: 67.58
Round  50, Global train loss: 0.350, Global test loss: 1.463, Global test accuracy: 58.80
Round  51, Train loss: 0.311, Test loss: 1.350, Test accuracy: 67.95
Round  51, Global train loss: 0.311, Global test loss: 1.434, Global test accuracy: 60.01
Round  52, Train loss: 0.311, Test loss: 1.341, Test accuracy: 67.94
Round  52, Global train loss: 0.311, Global test loss: 1.484, Global test accuracy: 58.92
Round  53, Train loss: 0.323, Test loss: 1.372, Test accuracy: 67.59
Round  53, Global train loss: 0.323, Global test loss: 1.527, Global test accuracy: 58.89
Round  54, Train loss: 0.336, Test loss: 1.351, Test accuracy: 68.07
Round  54, Global train loss: 0.336, Global test loss: 1.598, Global test accuracy: 57.51
Round  55, Train loss: 0.286, Test loss: 1.353, Test accuracy: 68.20
Round  55, Global train loss: 0.286, Global test loss: 1.556, Global test accuracy: 58.79
Round  56, Train loss: 0.281, Test loss: 1.341, Test accuracy: 68.33
Round  56, Global train loss: 0.281, Global test loss: 1.781, Global test accuracy: 55.89
Round  57, Train loss: 0.314, Test loss: 1.386, Test accuracy: 67.84
Round  57, Global train loss: 0.314, Global test loss: 1.626, Global test accuracy: 57.41
Round  58, Train loss: 0.332, Test loss: 1.389, Test accuracy: 68.33
Round  58, Global train loss: 0.332, Global test loss: 1.560, Global test accuracy: 58.74
Round  59, Train loss: 0.293, Test loss: 1.368, Test accuracy: 68.41
Round  59, Global train loss: 0.293, Global test loss: 1.572, Global test accuracy: 58.73
Round  60, Train loss: 0.386, Test loss: 1.353, Test accuracy: 68.46
Round  60, Global train loss: 0.386, Global test loss: 1.565, Global test accuracy: 57.74
Round  61, Train loss: 0.293, Test loss: 1.350, Test accuracy: 69.21
Round  61, Global train loss: 0.293, Global test loss: 1.577, Global test accuracy: 58.12
Round  62, Train loss: 0.253, Test loss: 1.379, Test accuracy: 68.46
Round  62, Global train loss: 0.253, Global test loss: 1.851, Global test accuracy: 55.59
Round  63, Train loss: 0.315, Test loss: 1.396, Test accuracy: 68.36
Round  63, Global train loss: 0.315, Global test loss: 1.441, Global test accuracy: 60.92
Round  64, Train loss: 0.307, Test loss: 1.413, Test accuracy: 68.01
Round  64, Global train loss: 0.307, Global test loss: 1.579, Global test accuracy: 58.14
Round  65, Train loss: 0.310, Test loss: 1.432, Test accuracy: 68.78
Round  65, Global train loss: 0.310, Global test loss: 1.704, Global test accuracy: 56.32
Round  66, Train loss: 0.283, Test loss: 1.449, Test accuracy: 68.48
Round  66, Global train loss: 0.283, Global test loss: 1.762, Global test accuracy: 57.52
Round  67, Train loss: 0.309, Test loss: 1.451, Test accuracy: 68.33
Round  67, Global train loss: 0.309, Global test loss: 1.591, Global test accuracy: 58.47
Round  68, Train loss: 0.258, Test loss: 1.481, Test accuracy: 68.11
Round  68, Global train loss: 0.258, Global test loss: 1.625, Global test accuracy: 58.92
Round  69, Train loss: 0.269, Test loss: 1.473, Test accuracy: 68.02
Round  69, Global train loss: 0.269, Global test loss: 1.620, Global test accuracy: 59.00
Round  70, Train loss: 0.314, Test loss: 1.481, Test accuracy: 68.10
Round  70, Global train loss: 0.314, Global test loss: 2.026, Global test accuracy: 53.04
Round  71, Train loss: 0.251, Test loss: 1.466, Test accuracy: 68.63
Round  71, Global train loss: 0.251, Global test loss: 1.794, Global test accuracy: 57.21
Round  72, Train loss: 0.258, Test loss: 1.457, Test accuracy: 68.32
Round  72, Global train loss: 0.258, Global test loss: 1.632, Global test accuracy: 59.11
Round  73, Train loss: 0.256, Test loss: 1.446, Test accuracy: 68.53
Round  73, Global train loss: 0.256, Global test loss: 1.678, Global test accuracy: 58.87
Round  74, Train loss: 0.266, Test loss: 1.437, Test accuracy: 68.96
Round  74, Global train loss: 0.266, Global test loss: 1.628, Global test accuracy: 60.41
Round  75, Train loss: 0.265, Test loss: 1.462, Test accuracy: 68.93
Round  75, Global train loss: 0.265, Global test loss: 1.774, Global test accuracy: 58.06
Round  76, Train loss: 0.232, Test loss: 1.440, Test accuracy: 68.96
Round  76, Global train loss: 0.232, Global test loss: 1.647, Global test accuracy: 60.83
Round  77, Train loss: 0.237, Test loss: 1.433, Test accuracy: 68.84
Round  77, Global train loss: 0.237, Global test loss: 1.674, Global test accuracy: 59.46
Round  78, Train loss: 0.222, Test loss: 1.448, Test accuracy: 69.00
Round  78, Global train loss: 0.222, Global test loss: 1.586, Global test accuracy: 59.97
Round  79, Train loss: 0.239, Test loss: 1.449, Test accuracy: 69.03
Round  79, Global train loss: 0.239, Global test loss: 1.784, Global test accuracy: 58.57
Round  80, Train loss: 0.189, Test loss: 1.469, Test accuracy: 69.24
Round  80, Global train loss: 0.189, Global test loss: 1.676, Global test accuracy: 60.88
Round  81, Train loss: 0.178, Test loss: 1.507, Test accuracy: 68.65
Round  81, Global train loss: 0.178, Global test loss: 1.689, Global test accuracy: 60.60
Round  82, Train loss: 0.171, Test loss: 1.485, Test accuracy: 68.61
Round  82, Global train loss: 0.171, Global test loss: 1.707, Global test accuracy: 60.58
Round  83, Train loss: 0.155, Test loss: 1.482, Test accuracy: 68.95
Round  83, Global train loss: 0.155, Global test loss: 1.789, Global test accuracy: 60.34
Round  84, Train loss: 0.151, Test loss: 1.468, Test accuracy: 69.15
Round  84, Global train loss: 0.151, Global test loss: 1.723, Global test accuracy: 61.00
Round  85, Train loss: 0.140, Test loss: 1.509, Test accuracy: 68.94
Round  85, Global train loss: 0.140, Global test loss: 1.851, Global test accuracy: 59.68
Round  86, Train loss: 0.145, Test loss: 1.506, Test accuracy: 69.00
Round  86, Global train loss: 0.145, Global test loss: 1.783, Global test accuracy: 60.97
Round  87, Train loss: 0.148, Test loss: 1.491, Test accuracy: 69.28
Round  87, Global train loss: 0.148, Global test loss: 1.768, Global test accuracy: 60.68
Round  88, Train loss: 0.143, Test loss: 1.479, Test accuracy: 69.39
Round  88, Global train loss: 0.143, Global test loss: 1.791, Global test accuracy: 60.45
Round  89, Train loss: 0.135, Test loss: 1.530, Test accuracy: 68.70
Round  89, Global train loss: 0.135, Global test loss: 1.793, Global test accuracy: 60.62
Round  90, Train loss: 0.251, Test loss: 1.464, Test accuracy: 69.80
Round  90, Global train loss: 0.251, Global test loss: 1.502, Global test accuracy: 62.45
Round  91, Train loss: 0.224, Test loss: 1.495, Test accuracy: 69.16
Round  91, Global train loss: 0.224, Global test loss: 1.484, Global test accuracy: 62.73
Round  92, Train loss: 0.220, Test loss: 1.522, Test accuracy: 68.75
Round  92, Global train loss: 0.220, Global test loss: 1.471, Global test accuracy: 63.00
Round  93, Train loss: 0.211, Test loss: 1.512, Test accuracy: 68.98
Round  93, Global train loss: 0.211, Global test loss: 1.490, Global test accuracy: 62.91
Round  94, Train loss: 0.210, Test loss: 1.567, Test accuracy: 68.66
Round  94, Global train loss: 0.210, Global test loss: 1.492, Global test accuracy: 62.60
Round  95, Train loss: 0.206, Test loss: 1.542, Test accuracy: 68.84
Round  95, Global train loss: 0.206, Global test loss: 1.469, Global test accuracy: 63.30
Round  96, Train loss: 0.206, Test loss: 1.565, Test accuracy: 68.58
Round  96, Global train loss: 0.206, Global test loss: 1.496, Global test accuracy: 62.62
Round  97, Train loss: 0.203, Test loss: 1.498, Test accuracy: 70.04
Round  97, Global train loss: 0.203, Global test loss: 1.484, Global test accuracy: 63.11
Round  98, Train loss: 0.202, Test loss: 1.511, Test accuracy: 69.16
Round  98, Global train loss: 0.202, Global test loss: 1.480, Global test accuracy: 62.98
Round  99, Train loss: 0.192, Test loss: 1.610, Test accuracy: 69.00
Round  99, Global train loss: 0.192, Global test loss: 1.503, Global test accuracy: 63.13
Final Round, Train loss: 0.148, Test loss: 1.667, Test accuracy: 69.38
Final Round, Global train loss: 0.148, Global test loss: 1.503, Global test accuracy: 63.13
Average accuracy final 10 rounds: 69.097
Average global accuracy final 10 rounds: 62.883
3882.1456434726715
[2.5186805725097656, 4.797883749008179, 7.077284097671509, 9.350027322769165, 11.619868516921997, 13.895395278930664, 15.812664985656738, 17.731599807739258, 19.65308928489685, 21.574934005737305, 23.555920362472534, 25.47830033302307, 27.401472091674805, 29.319704294204712, 31.229621648788452, 33.14731025695801, 35.066726207733154, 36.99279975891113, 38.89973020553589, 40.8090386390686, 42.727184772491455, 46.906333446502686, 51.11000847816467, 55.308812618255615, 59.46898055076599, 63.663463830947876, 67.82559704780579, 72.03151273727417, 76.23213076591492, 80.43050265312195, 84.63575911521912, 88.89671993255615, 93.11104559898376, 97.28414916992188, 101.49392986297607, 106.02587604522705, 110.57194137573242, 115.12774920463562, 119.67305421829224, 124.20357894897461, 128.74112629890442, 133.28075742721558, 137.82623147964478, 142.372656583786, 146.93197894096375, 151.48877429962158, 156.05848932266235, 160.6762557029724, 165.21934247016907, 169.76904344558716, 174.31229996681213, 178.85838651657104, 183.43045711517334, 187.98137497901917, 192.53347826004028, 197.09697675704956, 201.65573477745056, 206.20824122428894, 210.74356746673584, 215.27152824401855, 219.8178153038025, 224.3586883544922, 228.90797924995422, 233.51269268989563, 238.072190284729, 242.6245470046997, 247.18089771270752, 251.73570370674133, 256.2810945510864, 260.8048312664032, 265.33722591400146, 269.86955285072327, 274.0310010910034, 278.188973903656, 282.3557677268982, 286.5170886516571, 290.680312871933, 294.8471028804779, 299.00350522994995, 303.2305426597595, 307.39207220077515, 311.5496232509613, 315.7578043937683, 319.965026140213, 324.1273617744446, 328.34215116500854, 332.5490469932556, 336.7592635154724, 340.96557116508484, 345.23023891448975, 349.43964409828186, 353.6432008743286, 357.8497750759125, 362.0567183494568, 366.2788517475128, 370.4813072681427, 374.68682885169983, 378.8956820964813, 383.1015999317169, 387.6486794948578, 392.1853311061859]
[46.22, 53.8, 57.34, 60.79, 60.45, 61.68, 62.94, 63.09, 64.53, 64.59, 64.76, 64.67, 64.42, 64.78, 64.94, 65.67, 65.82, 66.01, 66.36, 66.84, 66.21, 67.33, 66.31, 66.33, 66.33, 66.08, 66.32, 66.07, 65.8, 66.78, 66.57, 66.77, 67.29, 67.52, 67.33, 67.74, 67.43, 68.15, 68.12, 67.78, 67.93, 67.57, 67.23, 67.02, 67.22, 68.03, 68.18, 67.66, 67.19, 67.58, 67.58, 67.95, 67.94, 67.59, 68.07, 68.2, 68.33, 67.84, 68.33, 68.41, 68.46, 69.21, 68.46, 68.36, 68.01, 68.78, 68.48, 68.33, 68.11, 68.02, 68.1, 68.63, 68.32, 68.53, 68.96, 68.93, 68.96, 68.84, 69.0, 69.03, 69.24, 68.65, 68.61, 68.95, 69.15, 68.94, 69.0, 69.28, 69.39, 68.7, 69.8, 69.16, 68.75, 68.98, 68.66, 68.84, 68.58, 70.04, 69.16, 69.0, 69.38]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.744, Test loss: 1.753, Test accuracy: 32.74
Round   1, Train loss: 1.414, Test loss: 1.312, Test accuracy: 44.92
Round   2, Train loss: 1.270, Test loss: 1.192, Test accuracy: 50.44
Round   3, Train loss: 1.186, Test loss: 1.121, Test accuracy: 54.89
Round   4, Train loss: 1.131, Test loss: 1.087, Test accuracy: 57.46
Round   5, Train loss: 1.086, Test loss: 1.007, Test accuracy: 60.33
Round   6, Train loss: 1.050, Test loss: 1.001, Test accuracy: 60.97
Round   7, Train loss: 1.014, Test loss: 0.964, Test accuracy: 62.24
Round   8, Train loss: 0.989, Test loss: 0.942, Test accuracy: 64.24
Round   9, Train loss: 0.959, Test loss: 0.929, Test accuracy: 64.58
Round  10, Train loss: 0.933, Test loss: 0.901, Test accuracy: 66.09
Round  11, Train loss: 0.905, Test loss: 0.895, Test accuracy: 66.39
Round  12, Train loss: 0.884, Test loss: 0.906, Test accuracy: 65.85
Round  13, Train loss: 0.861, Test loss: 0.868, Test accuracy: 67.13
Round  14, Train loss: 0.837, Test loss: 0.878, Test accuracy: 66.95
Round  15, Train loss: 0.819, Test loss: 0.845, Test accuracy: 68.41
Round  16, Train loss: 0.795, Test loss: 0.850, Test accuracy: 68.09
Round  17, Train loss: 0.777, Test loss: 0.839, Test accuracy: 68.89
Round  18, Train loss: 0.758, Test loss: 0.837, Test accuracy: 69.05
Round  19, Train loss: 0.737, Test loss: 0.837, Test accuracy: 69.23
Round  20, Train loss: 0.807, Test loss: 0.868, Test accuracy: 68.23
Round  21, Train loss: 0.730, Test loss: 0.864, Test accuracy: 68.45
Round  22, Train loss: 0.731, Test loss: 0.879, Test accuracy: 68.01
Round  23, Train loss: 0.727, Test loss: 0.872, Test accuracy: 68.62
Round  24, Train loss: 0.747, Test loss: 0.867, Test accuracy: 69.24
Round  25, Train loss: 0.679, Test loss: 0.855, Test accuracy: 69.72
Round  26, Train loss: 0.623, Test loss: 0.841, Test accuracy: 70.05
Round  27, Train loss: 0.622, Test loss: 0.850, Test accuracy: 70.07
Round  28, Train loss: 0.581, Test loss: 0.858, Test accuracy: 69.46
Round  29, Train loss: 0.654, Test loss: 0.841, Test accuracy: 70.18
Round  30, Train loss: 0.606, Test loss: 0.840, Test accuracy: 70.38
Round  31, Train loss: 0.592, Test loss: 0.850, Test accuracy: 70.33
Round  32, Train loss: 0.604, Test loss: 0.845, Test accuracy: 70.77
Round  33, Train loss: 0.650, Test loss: 0.862, Test accuracy: 70.33
Round  34, Train loss: 0.556, Test loss: 0.864, Test accuracy: 71.05
Round  35, Train loss: 0.578, Test loss: 0.853, Test accuracy: 71.02
Round  36, Train loss: 0.564, Test loss: 0.856, Test accuracy: 71.10
Round  37, Train loss: 0.501, Test loss: 0.863, Test accuracy: 71.01
Round  38, Train loss: 0.570, Test loss: 0.854, Test accuracy: 71.21
Round  39, Train loss: 0.491, Test loss: 0.870, Test accuracy: 70.80
Round  40, Train loss: 0.510, Test loss: 0.841, Test accuracy: 71.48
Round  41, Train loss: 0.474, Test loss: 0.863, Test accuracy: 71.28
Round  42, Train loss: 0.478, Test loss: 0.880, Test accuracy: 70.64
Round  43, Train loss: 0.467, Test loss: 0.869, Test accuracy: 70.72
Round  44, Train loss: 0.474, Test loss: 0.869, Test accuracy: 71.04
Round  45, Train loss: 0.540, Test loss: 0.861, Test accuracy: 71.58
Round  46, Train loss: 0.564, Test loss: 0.886, Test accuracy: 71.60
Round  47, Train loss: 0.524, Test loss: 0.862, Test accuracy: 71.48
Round  48, Train loss: 0.467, Test loss: 0.868, Test accuracy: 71.58
Round  49, Train loss: 0.514, Test loss: 0.890, Test accuracy: 71.29
Round  50, Train loss: 0.460, Test loss: 0.884, Test accuracy: 71.91
Round  51, Train loss: 0.435, Test loss: 0.902, Test accuracy: 71.81
Round  52, Train loss: 0.422, Test loss: 0.901, Test accuracy: 71.40
Round  53, Train loss: 0.433, Test loss: 0.926, Test accuracy: 71.48
Round  54, Train loss: 0.461, Test loss: 0.919, Test accuracy: 71.53
Round  55, Train loss: 0.370, Test loss: 0.942, Test accuracy: 71.30
Round  56, Train loss: 0.449, Test loss: 0.922, Test accuracy: 71.07
Round  57, Train loss: 0.468, Test loss: 0.943, Test accuracy: 70.65
Round  58, Train loss: 0.404, Test loss: 0.919, Test accuracy: 71.41
Round  59, Train loss: 0.443, Test loss: 0.945, Test accuracy: 71.38
Round  60, Train loss: 0.448, Test loss: 0.921, Test accuracy: 71.35
Round  61, Train loss: 0.432, Test loss: 0.970, Test accuracy: 71.21
Round  62, Train loss: 0.358, Test loss: 0.960, Test accuracy: 70.85
Round  63, Train loss: 0.392, Test loss: 0.978, Test accuracy: 70.85
Round  64, Train loss: 0.403, Test loss: 0.972, Test accuracy: 70.70
Round  65, Train loss: 0.357, Test loss: 0.964, Test accuracy: 70.66
Round  66, Train loss: 0.348, Test loss: 0.956, Test accuracy: 71.01
Round  67, Train loss: 0.414, Test loss: 0.979, Test accuracy: 70.95
Round  68, Train loss: 0.366, Test loss: 0.990, Test accuracy: 70.74
Round  69, Train loss: 0.389, Test loss: 0.965, Test accuracy: 70.91
Round  70, Train loss: 0.354, Test loss: 0.933, Test accuracy: 71.14
Round  71, Train loss: 0.342, Test loss: 0.968, Test accuracy: 71.32
Round  72, Train loss: 0.316, Test loss: 0.995, Test accuracy: 70.66
Round  73, Train loss: 0.338, Test loss: 1.004, Test accuracy: 70.73
Round  74, Train loss: 0.338, Test loss: 1.000, Test accuracy: 71.32
Round  75, Train loss: 0.357, Test loss: 1.008, Test accuracy: 70.57
Round  76, Train loss: 0.281, Test loss: 1.002, Test accuracy: 71.09
Round  77, Train loss: 0.321, Test loss: 1.039, Test accuracy: 70.61
Round  78, Train loss: 0.320, Test loss: 1.003, Test accuracy: 70.99
Round  79, Train loss: 0.361, Test loss: 1.029, Test accuracy: 70.39
Round  80, Train loss: 0.256, Test loss: 1.015, Test accuracy: 71.44
Round  81, Train loss: 0.229, Test loss: 1.036, Test accuracy: 71.38
Round  82, Train loss: 0.223, Test loss: 1.041, Test accuracy: 71.33
Round  83, Train loss: 0.204, Test loss: 1.066, Test accuracy: 71.28
Round  84, Train loss: 0.206, Test loss: 1.092, Test accuracy: 70.37
Round  85, Train loss: 0.193, Test loss: 1.095, Test accuracy: 70.55
Round  86, Train loss: 0.187, Test loss: 1.126, Test accuracy: 70.60
Round  87, Train loss: 0.190, Test loss: 1.106, Test accuracy: 70.71
Round  88, Train loss: 0.180, Test loss: 1.114, Test accuracy: 70.81
Round  89, Train loss: 0.175, Test loss: 1.105, Test accuracy: 70.86
Round  90, Train loss: 0.310, Test loss: 1.094, Test accuracy: 70.57
Round  91, Train loss: 0.284, Test loss: 1.056, Test accuracy: 71.11
Round  92, Train loss: 0.274, Test loss: 1.086, Test accuracy: 70.83
Round  93, Train loss: 0.275, Test loss: 1.073, Test accuracy: 71.28
Round  94, Train loss: 0.274, Test loss: 1.081, Test accuracy: 70.86
Round  95, Train loss: 0.269, Test loss: 1.115, Test accuracy: 70.68
Round  96, Train loss: 0.258, Test loss: 1.095, Test accuracy: 71.04
Round  97, Train loss: 0.249, Test loss: 1.117, Test accuracy: 71.09
Round  98, Train loss: 0.254, Test loss: 1.109, Test accuracy: 70.99
Round  99, Train loss: 0.247, Test loss: 1.156, Test accuracy: 70.18
Final Round, Train loss: 0.202, Test loss: 1.102, Test accuracy: 71.50
Average accuracy final 10 rounds: 70.863
3161.2986192703247
[2.2836923599243164, 4.270095109939575, 6.248420476913452, 8.245404720306396, 10.234819650650024, 12.220732688903809, 14.216136455535889, 16.21714687347412, 18.21352243423462, 20.210269689559937, 22.19628620147705, 24.19644021987915, 26.1895694732666, 27.965075492858887, 29.742270469665527, 31.522292137145996, 33.302512645721436, 35.08121609687805, 36.95551609992981, 38.73405933380127, 40.508525371551514, 43.6149959564209, 46.71126985549927, 49.81161689758301, 52.913535594940186, 56.01223421096802, 59.11360692977905, 62.21369981765747, 65.31210494041443, 68.41316485404968, 71.51460528373718, 74.61294269561768, 77.70978546142578, 80.81158828735352, 83.91322636604309, 87.01549363136292, 90.1150074005127, 93.21046614646912, 96.473317861557, 99.83427906036377, 103.15660071372986, 106.50670146942139, 109.8549394607544, 113.16683149337769, 116.4878830909729, 119.8017303943634, 123.13450932502747, 126.44939470291138, 129.79343700408936, 133.14705538749695, 136.4609980583191, 139.79882740974426, 143.15242743492126, 146.4939935207367, 149.83141541481018, 153.17976880073547, 156.5247504711151, 159.86479330062866, 163.2088484764099, 166.55216765403748, 169.88932466506958, 173.2423312664032, 176.5940706729889, 179.95231294631958, 183.32736039161682, 186.68352103233337, 190.01014757156372, 193.34824538230896, 196.6984257698059, 200.04222679138184, 203.37944102287292, 206.69237971305847, 210.00972270965576, 213.32689547538757, 216.67502903938293, 220.02445101737976, 223.33632349967957, 226.67030930519104, 230.0160117149353, 233.3629424571991, 236.70846819877625, 240.05498003959656, 243.3859851360321, 246.72306561470032, 250.0578258037567, 253.4018633365631, 256.81273770332336, 260.16472864151, 263.4714283943176, 266.78414964675903, 270.1311614513397, 273.4736399650574, 276.5764434337616, 279.68939328193665, 282.78684854507446, 285.88885951042175, 289.04918360710144, 292.14410281181335, 295.2814419269562, 298.4054636955261, 301.75351428985596]
[32.74, 44.92, 50.44, 54.89, 57.46, 60.33, 60.97, 62.24, 64.24, 64.58, 66.09, 66.39, 65.85, 67.13, 66.95, 68.41, 68.09, 68.89, 69.05, 69.23, 68.23, 68.45, 68.01, 68.62, 69.24, 69.72, 70.05, 70.07, 69.46, 70.18, 70.38, 70.33, 70.77, 70.33, 71.05, 71.02, 71.1, 71.01, 71.21, 70.8, 71.48, 71.28, 70.64, 70.72, 71.04, 71.58, 71.6, 71.48, 71.58, 71.29, 71.91, 71.81, 71.4, 71.48, 71.53, 71.3, 71.07, 70.65, 71.41, 71.38, 71.35, 71.21, 70.85, 70.85, 70.7, 70.66, 71.01, 70.95, 70.74, 70.91, 71.14, 71.32, 70.66, 70.73, 71.32, 70.57, 71.09, 70.61, 70.99, 70.39, 71.44, 71.38, 71.33, 71.28, 70.37, 70.55, 70.6, 70.71, 70.81, 70.86, 70.57, 71.11, 70.83, 71.28, 70.86, 70.68, 71.04, 71.09, 70.99, 70.18, 71.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.794, Test loss: 1.710, Test accuracy: 37.67
Round   1, Train loss: 1.464, Test loss: 1.331, Test accuracy: 46.61
Round   2, Train loss: 1.325, Test loss: 1.197, Test accuracy: 50.66
Round   3, Train loss: 1.247, Test loss: 1.131, Test accuracy: 55.48
Round   4, Train loss: 1.194, Test loss: 1.082, Test accuracy: 58.30
Round   5, Train loss: 1.154, Test loss: 1.039, Test accuracy: 60.22
Round   6, Train loss: 1.119, Test loss: 1.006, Test accuracy: 62.10
Round   7, Train loss: 1.087, Test loss: 0.977, Test accuracy: 62.99
Round   8, Train loss: 1.056, Test loss: 0.956, Test accuracy: 65.07
Round   9, Train loss: 1.024, Test loss: 0.929, Test accuracy: 65.95
Round  10, Train loss: 1.005, Test loss: 0.916, Test accuracy: 66.62
Round  11, Train loss: 1.028, Test loss: 0.907, Test accuracy: 66.41
Round  12, Train loss: 1.096, Test loss: 0.899, Test accuracy: 66.75
Round  13, Train loss: 0.880, Test loss: 0.897, Test accuracy: 66.92
Round  14, Train loss: 0.958, Test loss: 0.880, Test accuracy: 67.66
Round  15, Train loss: 0.856, Test loss: 0.870, Test accuracy: 68.55
Round  16, Train loss: 0.884, Test loss: 0.864, Test accuracy: 68.97
Round  17, Train loss: 0.830, Test loss: 0.835, Test accuracy: 69.54
Round  18, Train loss: 0.874, Test loss: 0.838, Test accuracy: 69.60
Round  19, Train loss: 0.831, Test loss: 0.826, Test accuracy: 70.15
Round  20, Train loss: 0.851, Test loss: 0.841, Test accuracy: 69.65
Round  21, Train loss: 0.788, Test loss: 0.831, Test accuracy: 69.94
Round  22, Train loss: 0.768, Test loss: 0.831, Test accuracy: 69.61
Round  23, Train loss: 0.751, Test loss: 0.822, Test accuracy: 70.29
Round  24, Train loss: 0.667, Test loss: 0.817, Test accuracy: 70.80
Round  25, Train loss: 0.683, Test loss: 0.819, Test accuracy: 70.15
Round  26, Train loss: 0.710, Test loss: 0.804, Test accuracy: 70.74
Round  27, Train loss: 0.698, Test loss: 0.802, Test accuracy: 70.98
Round  28, Train loss: 0.647, Test loss: 0.825, Test accuracy: 70.56
Round  29, Train loss: 0.635, Test loss: 0.807, Test accuracy: 71.25
Round  30, Train loss: 0.710, Test loss: 0.812, Test accuracy: 71.50
Round  31, Train loss: 0.643, Test loss: 0.822, Test accuracy: 71.28
Round  32, Train loss: 0.752, Test loss: 0.810, Test accuracy: 71.33
Round  33, Train loss: 0.624, Test loss: 0.810, Test accuracy: 71.43
Round  34, Train loss: 0.610, Test loss: 0.824, Test accuracy: 71.15
Round  35, Train loss: 0.604, Test loss: 0.802, Test accuracy: 72.12
Round  36, Train loss: 0.586, Test loss: 0.803, Test accuracy: 72.01
Round  37, Train loss: 0.658, Test loss: 0.791, Test accuracy: 72.40
Round  38, Train loss: 0.666, Test loss: 0.796, Test accuracy: 72.65
Round  39, Train loss: 0.623, Test loss: 0.817, Test accuracy: 71.65
Round  40, Train loss: 0.566, Test loss: 0.799, Test accuracy: 72.38
Round  41, Train loss: 0.586, Test loss: 0.806, Test accuracy: 72.60
Round  42, Train loss: 0.528, Test loss: 0.810, Test accuracy: 72.14
Round  43, Train loss: 0.648, Test loss: 0.833, Test accuracy: 71.64
Round  44, Train loss: 0.561, Test loss: 0.816, Test accuracy: 72.20
Round  45, Train loss: 0.530, Test loss: 0.813, Test accuracy: 72.64
Round  46, Train loss: 0.499, Test loss: 0.788, Test accuracy: 73.68
Round  47, Train loss: 0.661, Test loss: 0.807, Test accuracy: 73.36
Round  48, Train loss: 0.573, Test loss: 0.797, Test accuracy: 73.04
Round  49, Train loss: 0.516, Test loss: 0.800, Test accuracy: 72.94
Round  50, Train loss: 0.507, Test loss: 0.805, Test accuracy: 72.88
Round  51, Train loss: 0.473, Test loss: 0.802, Test accuracy: 73.23
Round  52, Train loss: 0.483, Test loss: 0.813, Test accuracy: 73.07
Round  53, Train loss: 0.503, Test loss: 0.823, Test accuracy: 72.72
Round  54, Train loss: 0.543, Test loss: 0.838, Test accuracy: 72.47
Round  55, Train loss: 0.496, Test loss: 0.846, Test accuracy: 72.22
Round  56, Train loss: 0.520, Test loss: 0.832, Test accuracy: 72.37
Round  57, Train loss: 0.460, Test loss: 0.833, Test accuracy: 72.69
Round  58, Train loss: 0.537, Test loss: 0.853, Test accuracy: 72.44
Round  59, Train loss: 0.436, Test loss: 0.855, Test accuracy: 72.03
Round  60, Train loss: 0.476, Test loss: 0.857, Test accuracy: 72.22
Round  61, Train loss: 0.402, Test loss: 0.850, Test accuracy: 71.68
Round  62, Train loss: 0.379, Test loss: 0.850, Test accuracy: 72.32
Round  63, Train loss: 0.433, Test loss: 0.846, Test accuracy: 72.26
Round  64, Train loss: 0.404, Test loss: 0.840, Test accuracy: 72.32
Round  65, Train loss: 0.455, Test loss: 0.854, Test accuracy: 72.60
Round  66, Train loss: 0.450, Test loss: 0.868, Test accuracy: 72.51
Round  67, Train loss: 0.512, Test loss: 0.871, Test accuracy: 71.98
Round  68, Train loss: 0.363, Test loss: 0.858, Test accuracy: 72.19
Round  69, Train loss: 0.423, Test loss: 0.868, Test accuracy: 72.54
Round  70, Train loss: 0.464, Test loss: 0.849, Test accuracy: 72.92
Round  71, Train loss: 0.402, Test loss: 0.850, Test accuracy: 72.44
Round  72, Train loss: 0.412, Test loss: 0.854, Test accuracy: 72.25
Round  73, Train loss: 0.353, Test loss: 0.860, Test accuracy: 72.35
Round  74, Train loss: 0.413, Test loss: 0.858, Test accuracy: 72.94
Round  75, Train loss: 0.422, Test loss: 0.878, Test accuracy: 72.40
Round  76, Train loss: 0.407, Test loss: 0.878, Test accuracy: 72.29
Round  77, Train loss: 0.326, Test loss: 0.862, Test accuracy: 72.65
Round  78, Train loss: 0.355, Test loss: 0.883, Test accuracy: 71.82
Round  79, Train loss: 0.448, Test loss: 0.899, Test accuracy: 72.16
Round  80, Train loss: 0.295, Test loss: 0.864, Test accuracy: 72.78
Round  81, Train loss: 0.267, Test loss: 0.875, Test accuracy: 72.13
Round  82, Train loss: 0.274, Test loss: 0.874, Test accuracy: 72.49
Round  83, Train loss: 0.258, Test loss: 0.868, Test accuracy: 72.41
Round  84, Train loss: 0.247, Test loss: 0.866, Test accuracy: 72.43
Round  85, Train loss: 0.242, Test loss: 0.873, Test accuracy: 72.78
Round  86, Train loss: 0.231, Test loss: 0.886, Test accuracy: 72.30
Round  87, Train loss: 0.229, Test loss: 0.903, Test accuracy: 71.92
Round  88, Train loss: 0.222, Test loss: 0.878, Test accuracy: 72.72
Round  89, Train loss: 0.217, Test loss: 0.888, Test accuracy: 72.66
Round  90, Train loss: 0.368, Test loss: 0.890, Test accuracy: 72.68
Round  91, Train loss: 0.359, Test loss: 0.898, Test accuracy: 72.32
Round  92, Train loss: 0.348, Test loss: 0.898, Test accuracy: 72.21
Round  93, Train loss: 0.341, Test loss: 0.890, Test accuracy: 72.66
Round  94, Train loss: 0.336, Test loss: 0.889, Test accuracy: 72.95
Round  95, Train loss: 0.330, Test loss: 0.905, Test accuracy: 72.25
Round  96, Train loss: 0.322, Test loss: 0.895, Test accuracy: 72.81
Round  97, Train loss: 0.327, Test loss: 0.900, Test accuracy: 72.68
Round  98, Train loss: 0.321, Test loss: 0.898, Test accuracy: 72.61
Round  99, Train loss: 0.317, Test loss: 0.929, Test accuracy: 72.12
Final Round, Train loss: 0.293, Test loss: 0.903, Test accuracy: 72.80
Average accuracy final 10 rounds: 72.52900000000001
3440.147839307785
[2.835395336151123, 5.331809759140015, 7.845661640167236, 10.357797861099243, 12.864166975021362, 15.377760887145996, 17.890449047088623, 20.409435033798218, 22.903106927871704, 25.39655876159668, 27.57886838912964, 29.762996435165405, 31.946279048919678, 34.130531311035156, 36.314311265945435, 38.499915599823, 40.68531346321106, 42.86896538734436, 45.05644965171814, 47.24540305137634, 49.427626609802246, 53.09042692184448, 56.739240884780884, 60.388915061950684, 64.03445649147034, 67.69142174720764, 71.35216689109802, 75.01527547836304, 78.67815613746643, 82.35723805427551, 86.01542448997498, 89.68572473526001, 93.33910942077637, 97.06864166259766, 100.71781849861145, 104.38494443893433, 108.04593563079834, 111.7057614326477, 115.36439037322998, 119.01860857009888, 122.67196011543274, 126.33433318138123, 130.01728343963623, 133.69618582725525, 137.3633794784546, 141.0357949733734, 144.6964237689972, 148.35664534568787, 152.01904916763306, 155.6834921836853, 159.34354758262634, 163.0040328502655, 166.66927361488342, 170.32166409492493, 173.98712015151978, 177.65246081352234, 181.30553817749023, 185.02158761024475, 188.67163348197937, 192.3515808582306, 196.07748341560364, 199.7716670036316, 203.71515607833862, 207.69103264808655, 211.64795660972595, 215.6123583316803, 219.56683135032654, 223.52644228935242, 227.4851040840149, 231.4590916633606, 235.4299716949463, 239.4020278453827, 243.36048293113708, 247.32091331481934, 251.27209544181824, 254.9476501941681, 258.6764507293701, 262.33531665802, 266.0123198032379, 269.6694576740265, 273.3410909175873, 277.0245499610901, 280.7153391838074, 284.4033877849579, 288.09938073158264, 291.7839481830597, 295.476660490036, 300.03976559638977, 303.9495782852173, 307.7834565639496, 311.8091661930084, 315.8143322467804, 319.7869522571564, 324.2644646167755, 328.58264660835266, 332.89204478263855, 337.1874952316284, 341.5187361240387, 345.79691910743713, 350.0513207912445, 353.9469554424286]
[37.67, 46.61, 50.66, 55.48, 58.3, 60.22, 62.1, 62.99, 65.07, 65.95, 66.62, 66.41, 66.75, 66.92, 67.66, 68.55, 68.97, 69.54, 69.6, 70.15, 69.65, 69.94, 69.61, 70.29, 70.8, 70.15, 70.74, 70.98, 70.56, 71.25, 71.5, 71.28, 71.33, 71.43, 71.15, 72.12, 72.01, 72.4, 72.65, 71.65, 72.38, 72.6, 72.14, 71.64, 72.2, 72.64, 73.68, 73.36, 73.04, 72.94, 72.88, 73.23, 73.07, 72.72, 72.47, 72.22, 72.37, 72.69, 72.44, 72.03, 72.22, 71.68, 72.32, 72.26, 72.32, 72.6, 72.51, 71.98, 72.19, 72.54, 72.92, 72.44, 72.25, 72.35, 72.94, 72.4, 72.29, 72.65, 71.82, 72.16, 72.78, 72.13, 72.49, 72.41, 72.43, 72.78, 72.3, 71.92, 72.72, 72.66, 72.68, 72.32, 72.21, 72.66, 72.95, 72.25, 72.81, 72.68, 72.61, 72.12, 72.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.774, Test loss: 2.170, Test accuracy: 12.89
Round   0, Global train loss: 1.774, Global test loss: 2.345, Global test accuracy: 9.61
Round   1, Train loss: 1.711, Test loss: 1.955, Test accuracy: 21.78
Round   1, Global train loss: 1.711, Global test loss: 2.313, Global test accuracy: 16.47
Round   2, Train loss: 1.729, Test loss: 1.843, Test accuracy: 23.40
Round   2, Global train loss: 1.729, Global test loss: 2.403, Global test accuracy: 12.68
Round   3, Train loss: 1.655, Test loss: 1.823, Test accuracy: 24.94
Round   3, Global train loss: 1.655, Global test loss: 2.369, Global test accuracy: 20.71
Round   4, Train loss: 1.621, Test loss: 1.715, Test accuracy: 26.20
Round   4, Global train loss: 1.621, Global test loss: 2.252, Global test accuracy: 18.36
Round   5, Train loss: 1.675, Test loss: 1.644, Test accuracy: 28.12
Round   5, Global train loss: 1.675, Global test loss: 2.298, Global test accuracy: 18.12
Round   6, Train loss: 1.615, Test loss: 1.615, Test accuracy: 29.20
Round   6, Global train loss: 1.615, Global test loss: 2.269, Global test accuracy: 13.78
Round   7, Train loss: 1.535, Test loss: 1.629, Test accuracy: 29.89
Round   7, Global train loss: 1.535, Global test loss: 2.341, Global test accuracy: 16.21
Round   8, Train loss: 1.420, Test loss: 1.609, Test accuracy: 31.89
Round   8, Global train loss: 1.420, Global test loss: 2.241, Global test accuracy: 22.57
Round   9, Train loss: 1.643, Test loss: 1.596, Test accuracy: 32.52
Round   9, Global train loss: 1.643, Global test loss: 2.333, Global test accuracy: 14.89
Round  10, Train loss: 1.523, Test loss: 1.522, Test accuracy: 34.33
Round  10, Global train loss: 1.523, Global test loss: 2.366, Global test accuracy: 16.99
Round  11, Train loss: 1.446, Test loss: 1.511, Test accuracy: 34.79
Round  11, Global train loss: 1.446, Global test loss: 2.213, Global test accuracy: 17.58
Round  12, Train loss: 1.429, Test loss: 1.508, Test accuracy: 35.59
Round  12, Global train loss: 1.429, Global test loss: 2.328, Global test accuracy: 13.84
Round  13, Train loss: 1.493, Test loss: 1.501, Test accuracy: 35.27
Round  13, Global train loss: 1.493, Global test loss: 2.263, Global test accuracy: 13.62
Round  14, Train loss: 1.484, Test loss: 1.494, Test accuracy: 35.76
Round  14, Global train loss: 1.484, Global test loss: 2.177, Global test accuracy: 25.88
Round  15, Train loss: 1.539, Test loss: 1.494, Test accuracy: 35.61
Round  15, Global train loss: 1.539, Global test loss: 2.251, Global test accuracy: 17.05
Round  16, Train loss: 1.589, Test loss: 1.494, Test accuracy: 35.58
Round  16, Global train loss: 1.589, Global test loss: 2.247, Global test accuracy: 22.90
Round  17, Train loss: 1.347, Test loss: 1.495, Test accuracy: 35.71
Round  17, Global train loss: 1.347, Global test loss: 2.226, Global test accuracy: 24.04
Round  18, Train loss: 1.493, Test loss: 1.498, Test accuracy: 36.02
Round  18, Global train loss: 1.493, Global test loss: 2.291, Global test accuracy: 19.75
Round  19, Train loss: 1.551, Test loss: 1.488, Test accuracy: 36.33
Round  19, Global train loss: 1.551, Global test loss: 2.328, Global test accuracy: 19.50
Round  20, Train loss: 1.571, Test loss: 1.489, Test accuracy: 36.28
Round  20, Global train loss: 1.571, Global test loss: 2.389, Global test accuracy: 21.30
Round  21, Train loss: 1.431, Test loss: 1.480, Test accuracy: 36.83
Round  21, Global train loss: 1.431, Global test loss: 2.247, Global test accuracy: 21.00
Round  22, Train loss: 1.534, Test loss: 1.482, Test accuracy: 37.41
Round  22, Global train loss: 1.534, Global test loss: 2.393, Global test accuracy: 12.08
Round  23, Train loss: 1.248, Test loss: 1.485, Test accuracy: 37.27
Round  23, Global train loss: 1.248, Global test loss: 2.298, Global test accuracy: 18.09
Round  24, Train loss: 1.364, Test loss: 1.482, Test accuracy: 37.46
Round  24, Global train loss: 1.364, Global test loss: 2.230, Global test accuracy: 24.89
Round  25, Train loss: 1.363, Test loss: 1.490, Test accuracy: 37.41
Round  25, Global train loss: 1.363, Global test loss: 2.285, Global test accuracy: 14.49
Round  26, Train loss: 1.414, Test loss: 1.478, Test accuracy: 37.89
Round  26, Global train loss: 1.414, Global test loss: 2.270, Global test accuracy: 17.93
Round  27, Train loss: 1.415, Test loss: 1.492, Test accuracy: 37.69
Round  27, Global train loss: 1.415, Global test loss: 2.240, Global test accuracy: 20.21
Round  28, Train loss: 1.453, Test loss: 1.497, Test accuracy: 37.08
Round  28, Global train loss: 1.453, Global test loss: 2.382, Global test accuracy: 15.13
Round  29, Train loss: 1.242, Test loss: 1.509, Test accuracy: 36.91
Round  29, Global train loss: 1.242, Global test loss: 2.182, Global test accuracy: 23.56
Round  30, Train loss: 1.392, Test loss: 1.507, Test accuracy: 37.56
Round  30, Global train loss: 1.392, Global test loss: 2.272, Global test accuracy: 13.58
Round  31, Train loss: 1.411, Test loss: 1.529, Test accuracy: 37.23
Round  31, Global train loss: 1.411, Global test loss: 2.351, Global test accuracy: 9.14
Round  32, Train loss: 1.366, Test loss: 1.551, Test accuracy: 37.15
Round  32, Global train loss: 1.366, Global test loss: 2.262, Global test accuracy: 19.87
Round  33, Train loss: 1.286, Test loss: 1.558, Test accuracy: 37.15
Round  33, Global train loss: 1.286, Global test loss: 2.294, Global test accuracy: 13.39
Round  34, Train loss: 1.411, Test loss: 1.561, Test accuracy: 36.65
Round  34, Global train loss: 1.411, Global test loss: 2.222, Global test accuracy: 21.11
Round  35, Train loss: 1.331, Test loss: 1.570, Test accuracy: 37.21
Round  35, Global train loss: 1.331, Global test loss: 2.223, Global test accuracy: 20.66
Round  36, Train loss: 1.409, Test loss: 1.566, Test accuracy: 37.40
Round  36, Global train loss: 1.409, Global test loss: 2.243, Global test accuracy: 21.83
Round  37, Train loss: 1.093, Test loss: 1.580, Test accuracy: 37.29
Round  37, Global train loss: 1.093, Global test loss: 2.203, Global test accuracy: 19.71
Round  38, Train loss: 1.310, Test loss: 1.620, Test accuracy: 37.37
Round  38, Global train loss: 1.310, Global test loss: 2.223, Global test accuracy: 20.48
Round  39, Train loss: 1.182, Test loss: 1.618, Test accuracy: 37.29
Round  39, Global train loss: 1.182, Global test loss: 2.241, Global test accuracy: 18.65
Round  40, Train loss: 1.062, Test loss: 1.632, Test accuracy: 37.35
Round  40, Global train loss: 1.062, Global test loss: 2.223, Global test accuracy: 23.49
Round  41, Train loss: 1.037, Test loss: 1.664, Test accuracy: 37.00
Round  41, Global train loss: 1.037, Global test loss: 2.202, Global test accuracy: 23.71
Round  42, Train loss: 1.171, Test loss: 1.716, Test accuracy: 35.54
Round  42, Global train loss: 1.171, Global test loss: 2.225, Global test accuracy: 23.60
Round  43, Train loss: 1.438, Test loss: 1.717, Test accuracy: 35.70
Round  43, Global train loss: 1.438, Global test loss: 2.408, Global test accuracy: 14.33
Round  44, Train loss: 1.244, Test loss: 1.731, Test accuracy: 36.20
Round  44, Global train loss: 1.244, Global test loss: 2.255, Global test accuracy: 14.03
Round  45, Train loss: 1.141, Test loss: 1.732, Test accuracy: 36.07
Round  45, Global train loss: 1.141, Global test loss: 2.181, Global test accuracy: 20.78
Round  46, Train loss: 1.162, Test loss: 1.742, Test accuracy: 36.00
Round  46, Global train loss: 1.162, Global test loss: 2.216, Global test accuracy: 23.02
Round  47, Train loss: 1.104, Test loss: 1.754, Test accuracy: 36.61
Round  47, Global train loss: 1.104, Global test loss: 2.231, Global test accuracy: 22.38
Round  48, Train loss: 0.977, Test loss: 1.757, Test accuracy: 36.88
Round  48, Global train loss: 0.977, Global test loss: 2.226, Global test accuracy: 23.00
Round  49, Train loss: 0.792, Test loss: 1.790, Test accuracy: 36.65
Round  49, Global train loss: 0.792, Global test loss: 2.140, Global test accuracy: 21.35
Round  50, Train loss: 0.916, Test loss: 1.823, Test accuracy: 36.01
Round  50, Global train loss: 0.916, Global test loss: 2.205, Global test accuracy: 21.01
Round  51, Train loss: 0.963, Test loss: 1.883, Test accuracy: 35.96
Round  51, Global train loss: 0.963, Global test loss: 2.244, Global test accuracy: 16.05
Round  52, Train loss: 1.066, Test loss: 1.933, Test accuracy: 35.24
Round  52, Global train loss: 1.066, Global test loss: 2.214, Global test accuracy: 21.61
Round  53, Train loss: 0.826, Test loss: 1.907, Test accuracy: 35.92
Round  53, Global train loss: 0.826, Global test loss: 2.173, Global test accuracy: 25.56
Round  54, Train loss: 0.963, Test loss: 1.924, Test accuracy: 35.81
Round  54, Global train loss: 0.963, Global test loss: 2.217, Global test accuracy: 22.72
Round  55, Train loss: 0.907, Test loss: 1.932, Test accuracy: 35.39
Round  55, Global train loss: 0.907, Global test loss: 2.166, Global test accuracy: 19.47
Round  56, Train loss: 0.993, Test loss: 1.971, Test accuracy: 35.43
Round  56, Global train loss: 0.993, Global test loss: 2.188, Global test accuracy: 23.85
Round  57, Train loss: 0.840, Test loss: 2.019, Test accuracy: 35.42
Round  57, Global train loss: 0.840, Global test loss: 2.186, Global test accuracy: 23.02
Round  58, Train loss: 0.832, Test loss: 2.063, Test accuracy: 35.93
Round  58, Global train loss: 0.832, Global test loss: 2.234, Global test accuracy: 19.44
Round  59, Train loss: 0.708, Test loss: 2.054, Test accuracy: 35.82
Round  59, Global train loss: 0.708, Global test loss: 2.191, Global test accuracy: 20.89
Round  60, Train loss: 0.850, Test loss: 2.113, Test accuracy: 35.43
Round  60, Global train loss: 0.850, Global test loss: 2.233, Global test accuracy: 20.07
Round  61, Train loss: 0.831, Test loss: 2.169, Test accuracy: 35.45
Round  61, Global train loss: 0.831, Global test loss: 2.219, Global test accuracy: 18.68
Round  62, Train loss: 0.624, Test loss: 2.194, Test accuracy: 34.67
Round  62, Global train loss: 0.624, Global test loss: 2.176, Global test accuracy: 22.13
Round  63, Train loss: 0.911, Test loss: 2.223, Test accuracy: 34.35
Round  63, Global train loss: 0.911, Global test loss: 2.272, Global test accuracy: 17.62
Round  64, Train loss: 0.859, Test loss: 2.266, Test accuracy: 34.24
Round  64, Global train loss: 0.859, Global test loss: 2.269, Global test accuracy: 14.65
Round  65, Train loss: 1.057, Test loss: 2.307, Test accuracy: 34.06
Round  65, Global train loss: 1.057, Global test loss: 2.287, Global test accuracy: 18.16
Round  66, Train loss: 0.851, Test loss: 2.313, Test accuracy: 34.60
Round  66, Global train loss: 0.851, Global test loss: 2.257, Global test accuracy: 18.16
Round  67, Train loss: 0.855, Test loss: 2.314, Test accuracy: 35.33
Round  67, Global train loss: 0.855, Global test loss: 2.260, Global test accuracy: 17.53
Round  68, Train loss: 0.615, Test loss: 2.318, Test accuracy: 35.36
Round  68, Global train loss: 0.615, Global test loss: 2.216, Global test accuracy: 19.54
Round  69, Train loss: 0.642, Test loss: 2.431, Test accuracy: 34.96
Round  69, Global train loss: 0.642, Global test loss: 2.267, Global test accuracy: 22.37
Round  70, Train loss: 0.687, Test loss: 2.489, Test accuracy: 34.31
Round  70, Global train loss: 0.687, Global test loss: 2.255, Global test accuracy: 16.36
Round  71, Train loss: 0.582, Test loss: 2.531, Test accuracy: 34.48
Round  71, Global train loss: 0.582, Global test loss: 2.239, Global test accuracy: 20.92
Round  72, Train loss: 0.755, Test loss: 2.567, Test accuracy: 34.79
Round  72, Global train loss: 0.755, Global test loss: 2.252, Global test accuracy: 14.30
Round  73, Train loss: 0.818, Test loss: 2.611, Test accuracy: 34.77
Round  73, Global train loss: 0.818, Global test loss: 2.298, Global test accuracy: 14.66
Round  74, Train loss: 0.526, Test loss: 2.634, Test accuracy: 34.44
Round  74, Global train loss: 0.526, Global test loss: 2.176, Global test accuracy: 20.78
Round  75, Train loss: 0.456, Test loss: 2.715, Test accuracy: 34.04
Round  75, Global train loss: 0.456, Global test loss: 2.239, Global test accuracy: 20.38
Round  76, Train loss: 0.583, Test loss: 2.756, Test accuracy: 34.14
Round  76, Global train loss: 0.583, Global test loss: 2.281, Global test accuracy: 15.07
Round  77, Train loss: 0.656, Test loss: 2.771, Test accuracy: 33.88
Round  77, Global train loss: 0.656, Global test loss: 2.314, Global test accuracy: 12.02
Round  78, Train loss: 0.723, Test loss: 2.807, Test accuracy: 34.40
Round  78, Global train loss: 0.723, Global test loss: 2.290, Global test accuracy: 17.00
Round  79, Train loss: 0.455, Test loss: 2.830, Test accuracy: 34.20
Round  79, Global train loss: 0.455, Global test loss: 2.127, Global test accuracy: 26.35
Round  80, Train loss: 0.624, Test loss: 2.852, Test accuracy: 34.62
Round  80, Global train loss: 0.624, Global test loss: 2.194, Global test accuracy: 22.55
Round  81, Train loss: 0.558, Test loss: 2.903, Test accuracy: 34.32
Round  81, Global train loss: 0.558, Global test loss: 2.265, Global test accuracy: 21.33
Round  82, Train loss: 0.564, Test loss: 2.970, Test accuracy: 34.20
Round  82, Global train loss: 0.564, Global test loss: 2.229, Global test accuracy: 16.23
Round  83, Train loss: 0.409, Test loss: 2.982, Test accuracy: 34.06
Round  83, Global train loss: 0.409, Global test loss: 2.133, Global test accuracy: 23.12
Round  84, Train loss: 0.585, Test loss: 2.993, Test accuracy: 34.58
Round  84, Global train loss: 0.585, Global test loss: 2.201, Global test accuracy: 19.57
Round  85, Train loss: 0.315, Test loss: 3.053, Test accuracy: 34.22
Round  85, Global train loss: 0.315, Global test loss: 2.207, Global test accuracy: 20.32
Round  86, Train loss: 0.439, Test loss: 3.097, Test accuracy: 34.30
Round  86, Global train loss: 0.439, Global test loss: 2.216, Global test accuracy: 21.96
Round  87, Train loss: 0.519, Test loss: 3.218, Test accuracy: 34.47
Round  87, Global train loss: 0.519, Global test loss: 2.284, Global test accuracy: 17.36
Round  88, Train loss: 0.478, Test loss: 3.252, Test accuracy: 34.61
Round  88, Global train loss: 0.478, Global test loss: 2.223, Global test accuracy: 17.14
Round  89, Train loss: 0.324, Test loss: 3.304, Test accuracy: 34.33
Round  89, Global train loss: 0.324, Global test loss: 2.208, Global test accuracy: 21.31
Round  90, Train loss: 0.506, Test loss: 3.296, Test accuracy: 34.09
Round  90, Global train loss: 0.506, Global test loss: 2.266, Global test accuracy: 17.23
Round  91, Train loss: 0.524, Test loss: 3.344, Test accuracy: 34.27
Round  91, Global train loss: 0.524, Global test loss: 2.238, Global test accuracy: 19.21
Round  92, Train loss: 0.468, Test loss: 3.397, Test accuracy: 33.81
Round  92, Global train loss: 0.468, Global test loss: 2.319, Global test accuracy: 16.71
Round  93, Train loss: 0.424, Test loss: 3.425, Test accuracy: 33.62
Round  93, Global train loss: 0.424, Global test loss: 2.248, Global test accuracy: 18.12
Round  94, Train loss: 0.345, Test loss: 3.396, Test accuracy: 33.74
Round  94, Global train loss: 0.345, Global test loss: 2.288, Global test accuracy: 15.06
Round  95, Train loss: 0.288, Test loss: 3.383, Test accuracy: 34.31
Round  95, Global train loss: 0.288, Global test loss: 2.315, Global test accuracy: 19.24
Round  96, Train loss: 0.330, Test loss: 3.501, Test accuracy: 33.74
Round  96, Global train loss: 0.330, Global test loss: 2.089, Global test accuracy: 26.60
Round  97, Train loss: 0.300, Test loss: 3.582, Test accuracy: 33.49
Round  97, Global train loss: 0.300, Global test loss: 2.246, Global test accuracy: 18.14
Round  98, Train loss: 0.380, Test loss: 3.611, Test accuracy: 33.16
Round  98, Global train loss: 0.380, Global test loss: 2.250, Global test accuracy: 15.04
Round  99, Train loss: 0.455, Test loss: 3.691, Test accuracy: 32.63
Round  99, Global train loss: 0.455, Global test loss: 2.240, Global test accuracy: 19.33
Final Round, Train loss: 0.356, Test loss: 3.676, Test accuracy: 33.99
Final Round, Global train loss: 0.356, Global test loss: 2.240, Global test accuracy: 19.33
Average accuracy final 10 rounds: 33.686 

Average global accuracy final 10 rounds: 18.468 

1463.236634016037
[1.390690803527832, 2.781381607055664, 3.909579277038574, 5.037776947021484, 6.171000957489014, 7.304224967956543, 8.432145595550537, 9.560066223144531, 10.686575889587402, 11.813085556030273, 12.931485891342163, 14.049886226654053, 15.168680429458618, 16.287474632263184, 17.415289640426636, 18.543104648590088, 19.500298738479614, 20.45749282836914, 21.413368225097656, 22.369243621826172, 23.32565212249756, 24.282060623168945, 25.23519492149353, 26.188329219818115, 27.140532732009888, 28.09273624420166, 29.0457763671875, 29.99881649017334, 30.950905323028564, 31.90299415588379, 32.891629457473755, 33.88026475906372, 34.866008043289185, 35.85175132751465, 36.80908727645874, 37.76642322540283, 38.72178363800049, 39.677144050598145, 40.795124769210815, 41.913105487823486, 43.02708649635315, 44.14106750488281, 45.25626587867737, 46.371464252471924, 47.48738956451416, 48.6033148765564, 49.722846269607544, 50.84237766265869, 51.95556712150574, 53.06875658035278, 54.18429207801819, 55.299827575683594, 56.41906404495239, 57.53830051422119, 58.65446424484253, 59.77062797546387, 60.878467321395874, 61.98630666732788, 63.09615969657898, 64.20601272583008, 65.33387541770935, 66.46173810958862, 67.57858562469482, 68.69543313980103, 70.00356769561768, 71.31170225143433, 72.66538405418396, 74.0190658569336, 75.22528553009033, 76.43150520324707, 77.56843757629395, 78.70536994934082, 79.85413312911987, 81.00289630889893, 82.15240430831909, 83.30191230773926, 84.48014307022095, 85.65837383270264, 86.83388662338257, 88.0093994140625, 88.99517345428467, 89.98094749450684, 90.96058201789856, 91.94021654129028, 93.07930874824524, 94.2184009552002, 95.3518877029419, 96.4853744506836, 97.62523150444031, 98.76508855819702, 99.90117740631104, 101.03726625442505, 102.17924308776855, 103.32121992111206, 104.46595978736877, 105.61069965362549, 106.74511885643005, 107.87953805923462, 109.02907991409302, 110.17862176895142, 111.33987307548523, 112.50112438201904, 113.67898488044739, 114.85684537887573, 116.03677248954773, 117.21669960021973, 118.4596517086029, 119.70260381698608, 120.94653534889221, 122.19046688079834, 123.43530106544495, 124.68013525009155, 125.92671990394592, 127.1733045578003, 128.42944383621216, 129.68558311462402, 130.92739176750183, 132.16920042037964, 133.41722106933594, 134.66524171829224, 135.7534143924713, 136.8415870666504, 137.92214059829712, 139.00269412994385, 140.24108719825745, 141.47948026657104, 142.7171859741211, 143.95489168167114, 145.20074701309204, 146.44660234451294, 147.69398641586304, 148.94137048721313, 150.17768669128418, 151.41400289535522, 152.65133023262024, 153.88865756988525, 154.96855211257935, 156.04844665527344, 157.1241991519928, 158.19995164871216, 159.27656316757202, 160.35317468643188, 161.43246412277222, 162.51175355911255, 163.59244060516357, 164.6731276512146, 165.74975490570068, 166.82638216018677, 167.9019570350647, 168.97753190994263, 170.05782270431519, 171.13811349868774, 172.2119379043579, 173.28576231002808, 174.36077332496643, 175.43578433990479, 176.5159981250763, 177.5962119102478, 178.66784811019897, 179.73948431015015, 180.81170868873596, 181.88393306732178, 182.9584572315216, 184.03298139572144, 185.11416673660278, 186.19535207748413, 187.2711420059204, 188.3469319343567, 189.41986227035522, 190.49279260635376, 191.74029159545898, 192.9877905845642, 194.24504327774048, 195.50229597091675, 196.75051736831665, 197.99873876571655, 199.2519130706787, 200.50508737564087, 201.7741572856903, 203.04322719573975, 204.29821944236755, 205.55321168899536, 206.81139612197876, 208.06958055496216, 209.33630561828613, 210.6030306816101, 211.86556386947632, 213.12809705734253, 214.3853154182434, 215.6425337791443, 216.89321970939636, 218.14390563964844, 219.39107370376587, 220.6382417678833, 221.8836750984192, 223.12910842895508, 224.38357877731323, 225.6380491256714, 226.8962676525116, 228.1544861793518, 230.64913320541382, 233.14378023147583]
[12.89, 12.89, 21.78, 21.78, 23.4, 23.4, 24.94, 24.94, 26.2, 26.2, 28.12, 28.12, 29.2, 29.2, 29.89, 29.89, 31.89, 31.89, 32.52, 32.52, 34.33, 34.33, 34.79, 34.79, 35.59, 35.59, 35.27, 35.27, 35.76, 35.76, 35.61, 35.61, 35.58, 35.58, 35.71, 35.71, 36.02, 36.02, 36.33, 36.33, 36.28, 36.28, 36.83, 36.83, 37.41, 37.41, 37.27, 37.27, 37.46, 37.46, 37.41, 37.41, 37.89, 37.89, 37.69, 37.69, 37.08, 37.08, 36.91, 36.91, 37.56, 37.56, 37.23, 37.23, 37.15, 37.15, 37.15, 37.15, 36.65, 36.65, 37.21, 37.21, 37.4, 37.4, 37.29, 37.29, 37.37, 37.37, 37.29, 37.29, 37.35, 37.35, 37.0, 37.0, 35.54, 35.54, 35.7, 35.7, 36.2, 36.2, 36.07, 36.07, 36.0, 36.0, 36.61, 36.61, 36.88, 36.88, 36.65, 36.65, 36.01, 36.01, 35.96, 35.96, 35.24, 35.24, 35.92, 35.92, 35.81, 35.81, 35.39, 35.39, 35.43, 35.43, 35.42, 35.42, 35.93, 35.93, 35.82, 35.82, 35.43, 35.43, 35.45, 35.45, 34.67, 34.67, 34.35, 34.35, 34.24, 34.24, 34.06, 34.06, 34.6, 34.6, 35.33, 35.33, 35.36, 35.36, 34.96, 34.96, 34.31, 34.31, 34.48, 34.48, 34.79, 34.79, 34.77, 34.77, 34.44, 34.44, 34.04, 34.04, 34.14, 34.14, 33.88, 33.88, 34.4, 34.4, 34.2, 34.2, 34.62, 34.62, 34.32, 34.32, 34.2, 34.2, 34.06, 34.06, 34.58, 34.58, 34.22, 34.22, 34.3, 34.3, 34.47, 34.47, 34.61, 34.61, 34.33, 34.33, 34.09, 34.09, 34.27, 34.27, 33.81, 33.81, 33.62, 33.62, 33.74, 33.74, 34.31, 34.31, 33.74, 33.74, 33.49, 33.49, 33.16, 33.16, 32.63, 32.63, 33.99, 33.99]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.723, Test loss: 2.136, Test accuracy: 25.23
Round   0, Global train loss: 1.723, Global test loss: 2.319, Global test accuracy: 20.93
Round   1, Train loss: 1.553, Test loss: 1.788, Test accuracy: 33.23
Round   1, Global train loss: 1.553, Global test loss: 2.126, Global test accuracy: 25.45
Round   2, Train loss: 1.382, Test loss: 1.598, Test accuracy: 38.15
Round   2, Global train loss: 1.382, Global test loss: 2.081, Global test accuracy: 25.59
Round   3, Train loss: 1.356, Test loss: 1.570, Test accuracy: 40.91
Round   3, Global train loss: 1.356, Global test loss: 2.085, Global test accuracy: 29.09
Round   4, Train loss: 1.389, Test loss: 1.442, Test accuracy: 45.01
Round   4, Global train loss: 1.389, Global test loss: 1.839, Global test accuracy: 33.41
Round   5, Train loss: 1.336, Test loss: 1.324, Test accuracy: 49.50
Round   5, Global train loss: 1.336, Global test loss: 1.742, Global test accuracy: 38.60
Round   6, Train loss: 1.189, Test loss: 1.278, Test accuracy: 51.02
Round   6, Global train loss: 1.189, Global test loss: 1.693, Global test accuracy: 40.59
Round   7, Train loss: 1.192, Test loss: 1.272, Test accuracy: 51.98
Round   7, Global train loss: 1.192, Global test loss: 1.822, Global test accuracy: 35.05
Round   8, Train loss: 1.115, Test loss: 1.246, Test accuracy: 52.93
Round   8, Global train loss: 1.115, Global test loss: 1.634, Global test accuracy: 41.74
Round   9, Train loss: 1.136, Test loss: 1.171, Test accuracy: 56.27
Round   9, Global train loss: 1.136, Global test loss: 1.663, Global test accuracy: 43.90
Round  10, Train loss: 1.134, Test loss: 1.120, Test accuracy: 58.10
Round  10, Global train loss: 1.134, Global test loss: 1.670, Global test accuracy: 45.69
Round  11, Train loss: 1.095, Test loss: 1.106, Test accuracy: 58.56
Round  11, Global train loss: 1.095, Global test loss: 1.556, Global test accuracy: 43.97
Round  12, Train loss: 1.186, Test loss: 1.090, Test accuracy: 58.92
Round  12, Global train loss: 1.186, Global test loss: 1.625, Global test accuracy: 41.80
Round  13, Train loss: 1.155, Test loss: 1.077, Test accuracy: 59.50
Round  13, Global train loss: 1.155, Global test loss: 1.532, Global test accuracy: 43.17
Round  14, Train loss: 0.940, Test loss: 1.075, Test accuracy: 59.73
Round  14, Global train loss: 0.940, Global test loss: 1.408, Global test accuracy: 49.84
Round  15, Train loss: 1.169, Test loss: 1.069, Test accuracy: 60.26
Round  15, Global train loss: 1.169, Global test loss: 1.524, Global test accuracy: 46.44
Round  16, Train loss: 0.980, Test loss: 1.081, Test accuracy: 59.85
Round  16, Global train loss: 0.980, Global test loss: 1.415, Global test accuracy: 50.71
Round  17, Train loss: 1.033, Test loss: 1.090, Test accuracy: 59.40
Round  17, Global train loss: 1.033, Global test loss: 1.457, Global test accuracy: 49.24
Round  18, Train loss: 1.014, Test loss: 1.085, Test accuracy: 59.51
Round  18, Global train loss: 1.014, Global test loss: 1.486, Global test accuracy: 48.48
Round  19, Train loss: 0.997, Test loss: 1.084, Test accuracy: 59.79
Round  19, Global train loss: 0.997, Global test loss: 1.586, Global test accuracy: 46.79
Round  20, Train loss: 1.001, Test loss: 1.086, Test accuracy: 59.99
Round  20, Global train loss: 1.001, Global test loss: 1.645, Global test accuracy: 45.53
Round  21, Train loss: 1.042, Test loss: 1.052, Test accuracy: 61.41
Round  21, Global train loss: 1.042, Global test loss: 1.468, Global test accuracy: 48.23
Round  22, Train loss: 0.889, Test loss: 1.049, Test accuracy: 61.34
Round  22, Global train loss: 0.889, Global test loss: 1.491, Global test accuracy: 48.13
Round  23, Train loss: 0.885, Test loss: 1.072, Test accuracy: 61.20
Round  23, Global train loss: 0.885, Global test loss: 1.555, Global test accuracy: 45.81
Round  24, Train loss: 0.941, Test loss: 1.071, Test accuracy: 61.64
Round  24, Global train loss: 0.941, Global test loss: 1.480, Global test accuracy: 47.33
Round  25, Train loss: 0.862, Test loss: 1.058, Test accuracy: 62.24
Round  25, Global train loss: 0.862, Global test loss: 1.410, Global test accuracy: 50.54
Round  26, Train loss: 0.810, Test loss: 1.055, Test accuracy: 62.10
Round  26, Global train loss: 0.810, Global test loss: 1.353, Global test accuracy: 53.20
Round  27, Train loss: 0.937, Test loss: 1.044, Test accuracy: 62.44
Round  27, Global train loss: 0.937, Global test loss: 1.370, Global test accuracy: 51.84
Round  28, Train loss: 0.856, Test loss: 1.032, Test accuracy: 62.54
Round  28, Global train loss: 0.856, Global test loss: 1.406, Global test accuracy: 51.64
Round  29, Train loss: 0.985, Test loss: 1.025, Test accuracy: 63.45
Round  29, Global train loss: 0.985, Global test loss: 1.365, Global test accuracy: 52.77
Round  30, Train loss: 0.919, Test loss: 1.003, Test accuracy: 64.48
Round  30, Global train loss: 0.919, Global test loss: 1.403, Global test accuracy: 50.77
Round  31, Train loss: 0.855, Test loss: 0.986, Test accuracy: 65.14
Round  31, Global train loss: 0.855, Global test loss: 1.468, Global test accuracy: 46.57
Round  32, Train loss: 0.794, Test loss: 0.995, Test accuracy: 64.54
Round  32, Global train loss: 0.794, Global test loss: 1.344, Global test accuracy: 53.78
Round  33, Train loss: 0.804, Test loss: 1.015, Test accuracy: 63.83
Round  33, Global train loss: 0.804, Global test loss: 1.466, Global test accuracy: 51.14
Round  34, Train loss: 0.766, Test loss: 1.024, Test accuracy: 63.72
Round  34, Global train loss: 0.766, Global test loss: 1.255, Global test accuracy: 57.72
Round  35, Train loss: 0.796, Test loss: 1.022, Test accuracy: 64.14
Round  35, Global train loss: 0.796, Global test loss: 1.401, Global test accuracy: 52.25
Round  36, Train loss: 0.798, Test loss: 1.029, Test accuracy: 64.34
Round  36, Global train loss: 0.798, Global test loss: 1.251, Global test accuracy: 58.00
Round  37, Train loss: 0.863, Test loss: 1.052, Test accuracy: 64.23
Round  37, Global train loss: 0.863, Global test loss: 1.266, Global test accuracy: 56.07
Round  38, Train loss: 0.677, Test loss: 1.056, Test accuracy: 63.94
Round  38, Global train loss: 0.677, Global test loss: 1.337, Global test accuracy: 54.70
Round  39, Train loss: 0.750, Test loss: 1.047, Test accuracy: 64.25
Round  39, Global train loss: 0.750, Global test loss: 1.387, Global test accuracy: 52.39
Round  40, Train loss: 0.841, Test loss: 1.040, Test accuracy: 64.48
Round  40, Global train loss: 0.841, Global test loss: 1.408, Global test accuracy: 51.14
Round  41, Train loss: 0.715, Test loss: 1.050, Test accuracy: 64.47
Round  41, Global train loss: 0.715, Global test loss: 1.402, Global test accuracy: 53.07
Round  42, Train loss: 0.775, Test loss: 1.042, Test accuracy: 64.83
Round  42, Global train loss: 0.775, Global test loss: 1.312, Global test accuracy: 55.90
Round  43, Train loss: 0.682, Test loss: 1.035, Test accuracy: 65.17
Round  43, Global train loss: 0.682, Global test loss: 1.677, Global test accuracy: 48.30
Round  44, Train loss: 0.575, Test loss: 1.017, Test accuracy: 65.58
Round  44, Global train loss: 0.575, Global test loss: 1.500, Global test accuracy: 54.76
Round  45, Train loss: 0.794, Test loss: 1.017, Test accuracy: 65.69
Round  45, Global train loss: 0.794, Global test loss: 1.368, Global test accuracy: 53.26
Round  46, Train loss: 0.655, Test loss: 1.023, Test accuracy: 65.60
Round  46, Global train loss: 0.655, Global test loss: 1.332, Global test accuracy: 56.06
Round  47, Train loss: 0.496, Test loss: 1.025, Test accuracy: 65.60
Round  47, Global train loss: 0.496, Global test loss: 1.263, Global test accuracy: 59.79
Round  48, Train loss: 0.667, Test loss: 1.024, Test accuracy: 65.72
Round  48, Global train loss: 0.667, Global test loss: 1.336, Global test accuracy: 57.89
Round  49, Train loss: 0.654, Test loss: 1.009, Test accuracy: 66.56
Round  49, Global train loss: 0.654, Global test loss: 1.229, Global test accuracy: 58.37
Round  50, Train loss: 0.629, Test loss: 1.029, Test accuracy: 66.49
Round  50, Global train loss: 0.629, Global test loss: 1.321, Global test accuracy: 56.58
Round  51, Train loss: 0.637, Test loss: 1.043, Test accuracy: 65.93
Round  51, Global train loss: 0.637, Global test loss: 1.307, Global test accuracy: 56.04
Round  52, Train loss: 0.697, Test loss: 1.048, Test accuracy: 65.73
Round  52, Global train loss: 0.697, Global test loss: 1.214, Global test accuracy: 59.37
Round  53, Train loss: 0.572, Test loss: 1.054, Test accuracy: 65.75
Round  53, Global train loss: 0.572, Global test loss: 1.315, Global test accuracy: 57.60
Round  54, Train loss: 0.609, Test loss: 1.053, Test accuracy: 65.90
Round  54, Global train loss: 0.609, Global test loss: 1.434, Global test accuracy: 53.83
Round  55, Train loss: 0.646, Test loss: 1.070, Test accuracy: 65.55
Round  55, Global train loss: 0.646, Global test loss: 1.336, Global test accuracy: 55.98
Round  56, Train loss: 0.571, Test loss: 1.053, Test accuracy: 65.92
Round  56, Global train loss: 0.571, Global test loss: 1.346, Global test accuracy: 56.28
Round  57, Train loss: 0.586, Test loss: 1.071, Test accuracy: 66.08
Round  57, Global train loss: 0.586, Global test loss: 1.254, Global test accuracy: 58.35
Round  58, Train loss: 0.635, Test loss: 1.078, Test accuracy: 66.35
Round  58, Global train loss: 0.635, Global test loss: 1.261, Global test accuracy: 58.49
Round  59, Train loss: 0.544, Test loss: 1.063, Test accuracy: 66.67
Round  59, Global train loss: 0.544, Global test loss: 1.275, Global test accuracy: 57.69
Round  60, Train loss: 0.595, Test loss: 1.088, Test accuracy: 66.45
Round  60, Global train loss: 0.595, Global test loss: 1.312, Global test accuracy: 57.71
Round  61, Train loss: 0.561, Test loss: 1.126, Test accuracy: 65.93
Round  61, Global train loss: 0.561, Global test loss: 1.351, Global test accuracy: 57.55
Round  62, Train loss: 0.515, Test loss: 1.121, Test accuracy: 65.74
Round  62, Global train loss: 0.515, Global test loss: 1.288, Global test accuracy: 59.59
Round  63, Train loss: 0.630, Test loss: 1.078, Test accuracy: 66.60
Round  63, Global train loss: 0.630, Global test loss: 1.340, Global test accuracy: 56.08
Round  64, Train loss: 0.558, Test loss: 1.080, Test accuracy: 66.79
Round  64, Global train loss: 0.558, Global test loss: 1.268, Global test accuracy: 58.92
Round  65, Train loss: 0.583, Test loss: 1.078, Test accuracy: 66.82
Round  65, Global train loss: 0.583, Global test loss: 1.363, Global test accuracy: 57.97
Round  66, Train loss: 0.633, Test loss: 1.070, Test accuracy: 66.80
Round  66, Global train loss: 0.633, Global test loss: 1.360, Global test accuracy: 55.74
Round  67, Train loss: 0.487, Test loss: 1.096, Test accuracy: 66.52
Round  67, Global train loss: 0.487, Global test loss: 1.331, Global test accuracy: 59.50
Round  68, Train loss: 0.570, Test loss: 1.103, Test accuracy: 66.87
Round  68, Global train loss: 0.570, Global test loss: 1.229, Global test accuracy: 59.39
Round  69, Train loss: 0.578, Test loss: 1.086, Test accuracy: 67.52
Round  69, Global train loss: 0.578, Global test loss: 1.385, Global test accuracy: 56.48
Round  70, Train loss: 0.440, Test loss: 1.097, Test accuracy: 67.40
Round  70, Global train loss: 0.440, Global test loss: 1.262, Global test accuracy: 60.70
Round  71, Train loss: 0.396, Test loss: 1.109, Test accuracy: 67.46
Round  71, Global train loss: 0.396, Global test loss: 1.279, Global test accuracy: 60.87
Round  72, Train loss: 0.587, Test loss: 1.142, Test accuracy: 66.41
Round  72, Global train loss: 0.587, Global test loss: 1.296, Global test accuracy: 59.18
Round  73, Train loss: 0.593, Test loss: 1.129, Test accuracy: 66.90
Round  73, Global train loss: 0.593, Global test loss: 1.324, Global test accuracy: 58.79
Round  74, Train loss: 0.589, Test loss: 1.118, Test accuracy: 67.12
Round  74, Global train loss: 0.589, Global test loss: 1.280, Global test accuracy: 59.92
Round  75, Train loss: 0.421, Test loss: 1.166, Test accuracy: 66.58
Round  75, Global train loss: 0.421, Global test loss: 1.312, Global test accuracy: 59.10
Round  76, Train loss: 0.505, Test loss: 1.147, Test accuracy: 66.59
Round  76, Global train loss: 0.505, Global test loss: 1.399, Global test accuracy: 57.59
Round  77, Train loss: 0.517, Test loss: 1.139, Test accuracy: 66.78
Round  77, Global train loss: 0.517, Global test loss: 1.455, Global test accuracy: 55.42
Round  78, Train loss: 0.455, Test loss: 1.137, Test accuracy: 66.55
Round  78, Global train loss: 0.455, Global test loss: 1.485, Global test accuracy: 56.25
Round  79, Train loss: 0.506, Test loss: 1.144, Test accuracy: 66.27
Round  79, Global train loss: 0.506, Global test loss: 1.278, Global test accuracy: 60.20
Round  80, Train loss: 0.602, Test loss: 1.142, Test accuracy: 66.87
Round  80, Global train loss: 0.602, Global test loss: 1.318, Global test accuracy: 57.67
Round  81, Train loss: 0.507, Test loss: 1.177, Test accuracy: 66.23
Round  81, Global train loss: 0.507, Global test loss: 1.307, Global test accuracy: 58.57
Round  82, Train loss: 0.504, Test loss: 1.169, Test accuracy: 66.73
Round  82, Global train loss: 0.504, Global test loss: 1.345, Global test accuracy: 59.12
Round  83, Train loss: 0.431, Test loss: 1.178, Test accuracy: 66.87
Round  83, Global train loss: 0.431, Global test loss: 1.214, Global test accuracy: 61.83
Round  84, Train loss: 0.496, Test loss: 1.180, Test accuracy: 66.95
Round  84, Global train loss: 0.496, Global test loss: 1.210, Global test accuracy: 61.87
Round  85, Train loss: 0.475, Test loss: 1.172, Test accuracy: 67.10
Round  85, Global train loss: 0.475, Global test loss: 1.414, Global test accuracy: 56.72
Round  86, Train loss: 0.356, Test loss: 1.185, Test accuracy: 66.89
Round  86, Global train loss: 0.356, Global test loss: 1.216, Global test accuracy: 62.60
Round  87, Train loss: 0.474, Test loss: 1.178, Test accuracy: 67.09
Round  87, Global train loss: 0.474, Global test loss: 1.591, Global test accuracy: 54.02
Round  88, Train loss: 0.518, Test loss: 1.141, Test accuracy: 67.68
Round  88, Global train loss: 0.518, Global test loss: 1.298, Global test accuracy: 59.14
Round  89, Train loss: 0.380, Test loss: 1.181, Test accuracy: 66.86
Round  89, Global train loss: 0.380, Global test loss: 1.449, Global test accuracy: 57.28
Round  90, Train loss: 0.452, Test loss: 1.163, Test accuracy: 67.46
Round  90, Global train loss: 0.452, Global test loss: 1.464, Global test accuracy: 57.34
Round  91, Train loss: 0.458, Test loss: 1.156, Test accuracy: 67.68
Round  91, Global train loss: 0.458, Global test loss: 1.430, Global test accuracy: 59.48
Round  92, Train loss: 0.490, Test loss: 1.174, Test accuracy: 67.56
Round  92, Global train loss: 0.490, Global test loss: 1.443, Global test accuracy: 58.50
Round  93, Train loss: 0.355, Test loss: 1.146, Test accuracy: 68.04
Round  93, Global train loss: 0.355, Global test loss: 1.380, Global test accuracy: 60.13
Round  94, Train loss: 0.380, Test loss: 1.165, Test accuracy: 67.58
Round  94, Global train loss: 0.380, Global test loss: 1.481, Global test accuracy: 59.78
Round  95, Train loss: 0.432, Test loss: 1.191, Test accuracy: 67.58
Round  95, Global train loss: 0.432, Global test loss: 1.341, Global test accuracy: 60.51
Round  96, Train loss: 0.438, Test loss: 1.209, Test accuracy: 67.07
Round  96, Global train loss: 0.438, Global test loss: 1.228, Global test accuracy: 62.41
Round  97, Train loss: 0.392, Test loss: 1.205, Test accuracy: 67.50
Round  97, Global train loss: 0.392, Global test loss: 1.433, Global test accuracy: 57.74
Round  98, Train loss: 0.435, Test loss: 1.188, Test accuracy: 67.77
Round  98, Global train loss: 0.435, Global test loss: 1.386, Global test accuracy: 59.42
Round  99, Train loss: 0.418, Test loss: 1.182, Test accuracy: 67.65
Round  99, Global train loss: 0.418, Global test loss: 1.471, Global test accuracy: 57.31
Final Round, Train loss: 0.346, Test loss: 1.321, Test accuracy: 67.27
Final Round, Global train loss: 0.346, Global test loss: 1.471, Global test accuracy: 57.31
Average accuracy final 10 rounds: 67.589 

Average global accuracy final 10 rounds: 59.262 

1456.1153428554535
[1.507967233657837, 3.015934467315674, 4.218136548995972, 5.4203386306762695, 6.5612547397613525, 7.7021708488464355, 8.767006874084473, 9.83184289932251, 10.895568132400513, 11.959293365478516, 13.041235446929932, 14.123177528381348, 15.1951904296875, 16.267203330993652, 17.327386140823364, 18.387568950653076, 19.454174995422363, 20.52078104019165, 21.579201221466064, 22.63762140274048, 23.696503400802612, 24.755385398864746, 25.814290523529053, 26.87319564819336, 27.945930004119873, 29.018664360046387, 30.066060066223145, 31.113455772399902, 32.151429414749146, 33.18940305709839, 34.22162628173828, 35.253849506378174, 36.2947416305542, 37.335633754730225, 38.38008642196655, 39.42453908920288, 40.47521185874939, 41.5258846282959, 42.57803654670715, 43.63018846511841, 44.67283535003662, 45.715482234954834, 46.76504468917847, 47.8146071434021, 48.84886956214905, 49.883131980895996, 50.93405318260193, 51.98497438430786, 53.02786946296692, 54.07076454162598, 55.11673831939697, 56.16271209716797, 57.195526123046875, 58.22834014892578, 59.2629132270813, 60.297486305236816, 61.342280626297, 62.38707494735718, 63.426109790802, 64.46514463424683, 65.51089978218079, 66.55665493011475, 67.61611270904541, 68.67557048797607, 69.75856232643127, 70.84155416488647, 72.03661775588989, 73.23168134689331, 74.47723364830017, 75.72278594970703, 76.90671181678772, 78.09063768386841, 79.27605962753296, 80.46148157119751, 81.62069272994995, 82.77990388870239, 83.97158813476562, 85.16327238082886, 86.3597903251648, 87.55630826950073, 88.68976187705994, 89.82321548461914, 91.0306658744812, 92.23811626434326, 93.43016695976257, 94.62221765518188, 95.83223605155945, 97.04225444793701, 98.2470850944519, 99.4519157409668, 100.6421971321106, 101.8324785232544, 102.98732876777649, 104.14217901229858, 105.31883764266968, 106.49549627304077, 107.69538521766663, 108.89527416229248, 110.09228563308716, 111.28929710388184, 112.47888422012329, 113.66847133636475, 114.8681628704071, 116.06785440444946, 117.28350281715393, 118.4991512298584, 119.6905369758606, 120.8819227218628, 122.08637428283691, 123.29082584381104, 124.48867797851562, 125.68653011322021, 126.89486908912659, 128.10320806503296, 129.28875303268433, 130.4742980003357, 131.65997457504272, 132.84565114974976, 134.04422569274902, 135.2428002357483, 136.43558645248413, 137.62837266921997, 138.71655583381653, 139.8047389984131, 140.85273003578186, 141.90072107315063, 142.956139087677, 144.01155710220337, 145.05945110321045, 146.10734510421753, 147.1628921031952, 148.21843910217285, 149.2746503353119, 150.33086156845093, 151.38460636138916, 152.4383511543274, 153.48545837402344, 154.53256559371948, 155.58994126319885, 156.64731693267822, 157.70268368721008, 158.75805044174194, 159.80488562583923, 160.85172080993652, 161.90150332450867, 162.9512858390808, 164.01466965675354, 165.07805347442627, 166.13358902931213, 167.189124584198, 168.2481825351715, 169.30724048614502, 170.34382271766663, 171.38040494918823, 172.45096492767334, 173.52152490615845, 174.57935047149658, 175.63717603683472, 176.69521474838257, 177.75325345993042, 178.7966752052307, 179.840096950531, 180.8860423564911, 181.93198776245117, 182.97726440429688, 184.02254104614258, 184.99905514717102, 185.97556924819946, 186.92777299880981, 187.87997674942017, 188.8314700126648, 189.78296327590942, 190.73532819747925, 191.68769311904907, 192.640527009964, 193.5933609008789, 194.79243063926697, 195.99150037765503, 197.0948510169983, 198.19820165634155, 199.2884669303894, 200.37873220443726, 201.4773244857788, 202.57591676712036, 203.66429471969604, 204.75267267227173, 205.85955238342285, 206.96643209457397, 208.05129313468933, 209.1361541748047, 210.21908283233643, 211.30201148986816, 212.38267278671265, 213.46333408355713, 214.54342532157898, 215.62351655960083, 216.71394538879395, 217.80437421798706, 218.8856122493744, 219.96685028076172, 222.1209855079651, 224.27512073516846]
[25.23, 25.23, 33.23, 33.23, 38.15, 38.15, 40.91, 40.91, 45.01, 45.01, 49.5, 49.5, 51.02, 51.02, 51.98, 51.98, 52.93, 52.93, 56.27, 56.27, 58.1, 58.1, 58.56, 58.56, 58.92, 58.92, 59.5, 59.5, 59.73, 59.73, 60.26, 60.26, 59.85, 59.85, 59.4, 59.4, 59.51, 59.51, 59.79, 59.79, 59.99, 59.99, 61.41, 61.41, 61.34, 61.34, 61.2, 61.2, 61.64, 61.64, 62.24, 62.24, 62.1, 62.1, 62.44, 62.44, 62.54, 62.54, 63.45, 63.45, 64.48, 64.48, 65.14, 65.14, 64.54, 64.54, 63.83, 63.83, 63.72, 63.72, 64.14, 64.14, 64.34, 64.34, 64.23, 64.23, 63.94, 63.94, 64.25, 64.25, 64.48, 64.48, 64.47, 64.47, 64.83, 64.83, 65.17, 65.17, 65.58, 65.58, 65.69, 65.69, 65.6, 65.6, 65.6, 65.6, 65.72, 65.72, 66.56, 66.56, 66.49, 66.49, 65.93, 65.93, 65.73, 65.73, 65.75, 65.75, 65.9, 65.9, 65.55, 65.55, 65.92, 65.92, 66.08, 66.08, 66.35, 66.35, 66.67, 66.67, 66.45, 66.45, 65.93, 65.93, 65.74, 65.74, 66.6, 66.6, 66.79, 66.79, 66.82, 66.82, 66.8, 66.8, 66.52, 66.52, 66.87, 66.87, 67.52, 67.52, 67.4, 67.4, 67.46, 67.46, 66.41, 66.41, 66.9, 66.9, 67.12, 67.12, 66.58, 66.58, 66.59, 66.59, 66.78, 66.78, 66.55, 66.55, 66.27, 66.27, 66.87, 66.87, 66.23, 66.23, 66.73, 66.73, 66.87, 66.87, 66.95, 66.95, 67.1, 67.1, 66.89, 66.89, 67.09, 67.09, 67.68, 67.68, 66.86, 66.86, 67.46, 67.46, 67.68, 67.68, 67.56, 67.56, 68.04, 68.04, 67.58, 67.58, 67.58, 67.58, 67.07, 67.07, 67.5, 67.5, 67.77, 67.77, 67.65, 67.65, 67.27, 67.27]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.735, Test loss: 2.067, Test accuracy: 24.84
Round   0, Global train loss: 1.735, Global test loss: 2.251, Global test accuracy: 20.63
Round   1, Train loss: 1.521, Test loss: 1.770, Test accuracy: 32.17
Round   1, Global train loss: 1.521, Global test loss: 2.073, Global test accuracy: 24.87
Round   2, Train loss: 1.437, Test loss: 1.692, Test accuracy: 35.30
Round   2, Global train loss: 1.437, Global test loss: 2.270, Global test accuracy: 22.60
Round   3, Train loss: 1.346, Test loss: 1.604, Test accuracy: 39.26
Round   3, Global train loss: 1.346, Global test loss: 2.069, Global test accuracy: 27.51
Round   4, Train loss: 1.350, Test loss: 1.447, Test accuracy: 44.39
Round   4, Global train loss: 1.350, Global test loss: 1.745, Global test accuracy: 37.23
Round   5, Train loss: 1.250, Test loss: 1.366, Test accuracy: 47.66
Round   5, Global train loss: 1.250, Global test loss: 1.801, Global test accuracy: 34.85
Round   6, Train loss: 1.316, Test loss: 1.298, Test accuracy: 50.54
Round   6, Global train loss: 1.316, Global test loss: 1.633, Global test accuracy: 41.40
Round   7, Train loss: 1.284, Test loss: 1.275, Test accuracy: 51.27
Round   7, Global train loss: 1.284, Global test loss: 1.674, Global test accuracy: 39.10
Round   8, Train loss: 1.135, Test loss: 1.245, Test accuracy: 53.10
Round   8, Global train loss: 1.135, Global test loss: 1.700, Global test accuracy: 39.45
Round   9, Train loss: 1.148, Test loss: 1.235, Test accuracy: 53.94
Round   9, Global train loss: 1.148, Global test loss: 1.593, Global test accuracy: 43.06
Round  10, Train loss: 1.116, Test loss: 1.165, Test accuracy: 56.49
Round  10, Global train loss: 1.116, Global test loss: 1.666, Global test accuracy: 44.36
Round  11, Train loss: 1.137, Test loss: 1.145, Test accuracy: 57.82
Round  11, Global train loss: 1.137, Global test loss: 1.447, Global test accuracy: 49.11
Round  12, Train loss: 1.217, Test loss: 1.120, Test accuracy: 58.84
Round  12, Global train loss: 1.217, Global test loss: 1.593, Global test accuracy: 42.93
Round  13, Train loss: 1.143, Test loss: 1.091, Test accuracy: 59.40
Round  13, Global train loss: 1.143, Global test loss: 1.490, Global test accuracy: 45.63
Round  14, Train loss: 1.048, Test loss: 1.097, Test accuracy: 59.56
Round  14, Global train loss: 1.048, Global test loss: 1.471, Global test accuracy: 46.63
Round  15, Train loss: 1.109, Test loss: 1.119, Test accuracy: 58.79
Round  15, Global train loss: 1.109, Global test loss: 1.560, Global test accuracy: 43.80
Round  16, Train loss: 1.060, Test loss: 1.118, Test accuracy: 58.65
Round  16, Global train loss: 1.060, Global test loss: 1.475, Global test accuracy: 47.08
Round  17, Train loss: 1.102, Test loss: 1.083, Test accuracy: 59.93
Round  17, Global train loss: 1.102, Global test loss: 1.531, Global test accuracy: 45.48
Round  18, Train loss: 0.930, Test loss: 1.091, Test accuracy: 59.47
Round  18, Global train loss: 0.930, Global test loss: 1.564, Global test accuracy: 45.15
Round  19, Train loss: 0.971, Test loss: 1.092, Test accuracy: 59.58
Round  19, Global train loss: 0.971, Global test loss: 1.533, Global test accuracy: 46.49
Round  20, Train loss: 0.897, Test loss: 1.086, Test accuracy: 59.96
Round  20, Global train loss: 0.897, Global test loss: 1.695, Global test accuracy: 40.61
Round  21, Train loss: 0.957, Test loss: 1.089, Test accuracy: 59.98
Round  21, Global train loss: 0.957, Global test loss: 1.424, Global test accuracy: 49.14
Round  22, Train loss: 0.891, Test loss: 1.064, Test accuracy: 61.06
Round  22, Global train loss: 0.891, Global test loss: 1.441, Global test accuracy: 48.96
Round  23, Train loss: 0.936, Test loss: 1.052, Test accuracy: 61.35
Round  23, Global train loss: 0.936, Global test loss: 1.619, Global test accuracy: 44.18
Round  24, Train loss: 1.022, Test loss: 1.015, Test accuracy: 62.83
Round  24, Global train loss: 1.022, Global test loss: 1.429, Global test accuracy: 48.98
Round  25, Train loss: 0.956, Test loss: 1.004, Test accuracy: 63.29
Round  25, Global train loss: 0.956, Global test loss: 1.345, Global test accuracy: 52.56
Round  26, Train loss: 0.835, Test loss: 1.022, Test accuracy: 62.57
Round  26, Global train loss: 0.835, Global test loss: 1.453, Global test accuracy: 49.60
Round  27, Train loss: 0.815, Test loss: 0.998, Test accuracy: 63.42
Round  27, Global train loss: 0.815, Global test loss: 1.327, Global test accuracy: 53.05
Round  28, Train loss: 0.911, Test loss: 0.984, Test accuracy: 63.85
Round  28, Global train loss: 0.911, Global test loss: 1.333, Global test accuracy: 53.51
Round  29, Train loss: 0.913, Test loss: 0.983, Test accuracy: 64.05
Round  29, Global train loss: 0.913, Global test loss: 1.334, Global test accuracy: 53.03
Round  30, Train loss: 0.950, Test loss: 0.975, Test accuracy: 64.64
Round  30, Global train loss: 0.950, Global test loss: 1.299, Global test accuracy: 55.36
Round  31, Train loss: 1.033, Test loss: 0.992, Test accuracy: 64.46
Round  31, Global train loss: 1.033, Global test loss: 1.464, Global test accuracy: 47.24
Round  32, Train loss: 0.832, Test loss: 1.023, Test accuracy: 63.58
Round  32, Global train loss: 0.832, Global test loss: 1.268, Global test accuracy: 56.21
Round  33, Train loss: 0.867, Test loss: 0.982, Test accuracy: 65.05
Round  33, Global train loss: 0.867, Global test loss: 1.363, Global test accuracy: 53.40
Round  34, Train loss: 0.752, Test loss: 0.984, Test accuracy: 65.18
Round  34, Global train loss: 0.752, Global test loss: 1.264, Global test accuracy: 56.05
Round  35, Train loss: 0.835, Test loss: 0.963, Test accuracy: 66.26
Round  35, Global train loss: 0.835, Global test loss: 1.278, Global test accuracy: 55.71
Round  36, Train loss: 0.849, Test loss: 0.965, Test accuracy: 66.18
Round  36, Global train loss: 0.849, Global test loss: 1.179, Global test accuracy: 59.51
Round  37, Train loss: 0.929, Test loss: 0.946, Test accuracy: 66.66
Round  37, Global train loss: 0.929, Global test loss: 1.216, Global test accuracy: 57.93
Round  38, Train loss: 0.838, Test loss: 0.952, Test accuracy: 66.56
Round  38, Global train loss: 0.838, Global test loss: 1.237, Global test accuracy: 57.15
Round  39, Train loss: 0.854, Test loss: 0.968, Test accuracy: 66.17
Round  39, Global train loss: 0.854, Global test loss: 1.262, Global test accuracy: 55.35
Round  40, Train loss: 0.908, Test loss: 0.954, Test accuracy: 66.42
Round  40, Global train loss: 0.908, Global test loss: 1.346, Global test accuracy: 53.30
Round  41, Train loss: 0.770, Test loss: 0.955, Test accuracy: 66.50
Round  41, Global train loss: 0.770, Global test loss: 1.369, Global test accuracy: 53.13
Round  42, Train loss: 0.801, Test loss: 0.979, Test accuracy: 66.13
Round  42, Global train loss: 0.801, Global test loss: 1.283, Global test accuracy: 56.21
Round  43, Train loss: 0.761, Test loss: 0.971, Test accuracy: 65.96
Round  43, Global train loss: 0.761, Global test loss: 1.555, Global test accuracy: 48.48
Round  44, Train loss: 0.721, Test loss: 0.935, Test accuracy: 67.31
Round  44, Global train loss: 0.721, Global test loss: 1.327, Global test accuracy: 55.88
Round  45, Train loss: 0.777, Test loss: 0.959, Test accuracy: 66.47
Round  45, Global train loss: 0.777, Global test loss: 1.289, Global test accuracy: 56.98
Round  46, Train loss: 0.843, Test loss: 0.983, Test accuracy: 65.87
Round  46, Global train loss: 0.843, Global test loss: 1.334, Global test accuracy: 54.58
Round  47, Train loss: 0.616, Test loss: 0.964, Test accuracy: 66.49
Round  47, Global train loss: 0.616, Global test loss: 1.217, Global test accuracy: 58.83
Round  48, Train loss: 0.722, Test loss: 0.961, Test accuracy: 66.67
Round  48, Global train loss: 0.722, Global test loss: 1.301, Global test accuracy: 57.99
Round  49, Train loss: 0.735, Test loss: 0.982, Test accuracy: 66.23
Round  49, Global train loss: 0.735, Global test loss: 1.206, Global test accuracy: 59.23
Round  50, Train loss: 0.671, Test loss: 1.007, Test accuracy: 65.56
Round  50, Global train loss: 0.671, Global test loss: 1.176, Global test accuracy: 59.17
Round  51, Train loss: 0.754, Test loss: 0.994, Test accuracy: 66.01
Round  51, Global train loss: 0.754, Global test loss: 1.223, Global test accuracy: 57.50
Round  52, Train loss: 0.727, Test loss: 1.008, Test accuracy: 65.33
Round  52, Global train loss: 0.727, Global test loss: 1.220, Global test accuracy: 58.41
Round  53, Train loss: 0.692, Test loss: 0.997, Test accuracy: 66.35
Round  53, Global train loss: 0.692, Global test loss: 1.366, Global test accuracy: 56.14
Round  54, Train loss: 0.672, Test loss: 1.014, Test accuracy: 66.27
Round  54, Global train loss: 0.672, Global test loss: 1.282, Global test accuracy: 57.15
Round  55, Train loss: 0.702, Test loss: 1.026, Test accuracy: 65.75
Round  55, Global train loss: 0.702, Global test loss: 1.249, Global test accuracy: 56.87
Round  56, Train loss: 0.617, Test loss: 1.024, Test accuracy: 65.93
Round  56, Global train loss: 0.617, Global test loss: 1.251, Global test accuracy: 57.36
Round  57, Train loss: 0.653, Test loss: 1.031, Test accuracy: 65.66
Round  57, Global train loss: 0.653, Global test loss: 1.233, Global test accuracy: 59.18
Round  58, Train loss: 0.638, Test loss: 1.021, Test accuracy: 66.05
Round  58, Global train loss: 0.638, Global test loss: 1.227, Global test accuracy: 59.33
Round  59, Train loss: 0.607, Test loss: 1.024, Test accuracy: 66.15
Round  59, Global train loss: 0.607, Global test loss: 1.282, Global test accuracy: 56.63
Round  60, Train loss: 0.634, Test loss: 1.026, Test accuracy: 66.18
Round  60, Global train loss: 0.634, Global test loss: 1.264, Global test accuracy: 57.55
Round  61, Train loss: 0.643, Test loss: 1.011, Test accuracy: 66.72
Round  61, Global train loss: 0.643, Global test loss: 1.222, Global test accuracy: 58.71
Round  62, Train loss: 0.580, Test loss: 1.020, Test accuracy: 66.67
Round  62, Global train loss: 0.580, Global test loss: 1.204, Global test accuracy: 59.73
Round  63, Train loss: 0.724, Test loss: 1.009, Test accuracy: 66.77
Round  63, Global train loss: 0.724, Global test loss: 1.257, Global test accuracy: 58.08
Round  64, Train loss: 0.634, Test loss: 0.992, Test accuracy: 67.61
Round  64, Global train loss: 0.634, Global test loss: 1.205, Global test accuracy: 60.53
Round  65, Train loss: 0.691, Test loss: 1.006, Test accuracy: 67.11
Round  65, Global train loss: 0.691, Global test loss: 1.364, Global test accuracy: 56.32
Round  66, Train loss: 0.667, Test loss: 1.030, Test accuracy: 66.50
Round  66, Global train loss: 0.667, Global test loss: 1.238, Global test accuracy: 59.66
Round  67, Train loss: 0.559, Test loss: 1.002, Test accuracy: 66.83
Round  67, Global train loss: 0.559, Global test loss: 1.169, Global test accuracy: 61.40
Round  68, Train loss: 0.564, Test loss: 0.989, Test accuracy: 67.44
Round  68, Global train loss: 0.564, Global test loss: 1.176, Global test accuracy: 60.99
Round  69, Train loss: 0.558, Test loss: 0.979, Test accuracy: 67.81
Round  69, Global train loss: 0.558, Global test loss: 1.310, Global test accuracy: 57.88
Round  70, Train loss: 0.507, Test loss: 0.985, Test accuracy: 67.87
Round  70, Global train loss: 0.507, Global test loss: 1.228, Global test accuracy: 60.62
Round  71, Train loss: 0.512, Test loss: 1.007, Test accuracy: 67.40
Round  71, Global train loss: 0.512, Global test loss: 1.211, Global test accuracy: 60.58
Round  72, Train loss: 0.638, Test loss: 1.022, Test accuracy: 67.46
Round  72, Global train loss: 0.638, Global test loss: 1.202, Global test accuracy: 59.76
Round  73, Train loss: 0.604, Test loss: 1.030, Test accuracy: 67.08
Round  73, Global train loss: 0.604, Global test loss: 1.212, Global test accuracy: 60.25
Round  74, Train loss: 0.522, Test loss: 1.019, Test accuracy: 67.08
Round  74, Global train loss: 0.522, Global test loss: 1.230, Global test accuracy: 61.53
Round  75, Train loss: 0.535, Test loss: 1.025, Test accuracy: 67.36
Round  75, Global train loss: 0.535, Global test loss: 1.275, Global test accuracy: 59.86
Round  76, Train loss: 0.647, Test loss: 1.047, Test accuracy: 67.04
Round  76, Global train loss: 0.647, Global test loss: 1.393, Global test accuracy: 54.57
Round  77, Train loss: 0.626, Test loss: 0.999, Test accuracy: 68.21
Round  77, Global train loss: 0.626, Global test loss: 1.271, Global test accuracy: 58.45
Round  78, Train loss: 0.546, Test loss: 1.011, Test accuracy: 68.07
Round  78, Global train loss: 0.546, Global test loss: 1.280, Global test accuracy: 59.32
Round  79, Train loss: 0.472, Test loss: 1.023, Test accuracy: 68.05
Round  79, Global train loss: 0.472, Global test loss: 1.247, Global test accuracy: 60.85
Round  80, Train loss: 0.691, Test loss: 1.046, Test accuracy: 67.58
Round  80, Global train loss: 0.691, Global test loss: 1.246, Global test accuracy: 59.66
Round  81, Train loss: 0.483, Test loss: 1.080, Test accuracy: 66.99
Round  81, Global train loss: 0.483, Global test loss: 1.266, Global test accuracy: 59.64
Round  82, Train loss: 0.518, Test loss: 1.051, Test accuracy: 67.81
Round  82, Global train loss: 0.518, Global test loss: 1.241, Global test accuracy: 61.30
Round  83, Train loss: 0.583, Test loss: 1.041, Test accuracy: 68.09
Round  83, Global train loss: 0.583, Global test loss: 1.163, Global test accuracy: 61.54
Round  84, Train loss: 0.552, Test loss: 1.074, Test accuracy: 67.78
Round  84, Global train loss: 0.552, Global test loss: 1.173, Global test accuracy: 61.52
Round  85, Train loss: 0.518, Test loss: 1.082, Test accuracy: 67.95
Round  85, Global train loss: 0.518, Global test loss: 1.235, Global test accuracy: 60.15
Round  86, Train loss: 0.505, Test loss: 1.073, Test accuracy: 68.01
Round  86, Global train loss: 0.505, Global test loss: 1.211, Global test accuracy: 61.14
Round  87, Train loss: 0.489, Test loss: 1.079, Test accuracy: 67.98
Round  87, Global train loss: 0.489, Global test loss: 1.432, Global test accuracy: 57.66
Round  88, Train loss: 0.603, Test loss: 1.091, Test accuracy: 67.32
Round  88, Global train loss: 0.603, Global test loss: 1.223, Global test accuracy: 59.88
Round  89, Train loss: 0.464, Test loss: 1.118, Test accuracy: 66.95
Round  89, Global train loss: 0.464, Global test loss: 1.306, Global test accuracy: 58.85
Round  90, Train loss: 0.505, Test loss: 1.121, Test accuracy: 66.77
Round  90, Global train loss: 0.505, Global test loss: 1.314, Global test accuracy: 59.44
Round  91, Train loss: 0.528, Test loss: 1.129, Test accuracy: 66.93
Round  91, Global train loss: 0.528, Global test loss: 1.277, Global test accuracy: 59.68/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  92, Train loss: 0.484, Test loss: 1.118, Test accuracy: 66.85
Round  92, Global train loss: 0.484, Global test loss: 1.393, Global test accuracy: 57.54
Round  93, Train loss: 0.423, Test loss: 1.099, Test accuracy: 67.50
Round  93, Global train loss: 0.423, Global test loss: 1.361, Global test accuracy: 59.67
Round  94, Train loss: 0.470, Test loss: 1.115, Test accuracy: 67.42
Round  94, Global train loss: 0.470, Global test loss: 1.278, Global test accuracy: 60.66
Round  95, Train loss: 0.411, Test loss: 1.116, Test accuracy: 67.59
Round  95, Global train loss: 0.411, Global test loss: 1.389, Global test accuracy: 59.83
Round  96, Train loss: 0.491, Test loss: 1.124, Test accuracy: 67.33
Round  96, Global train loss: 0.491, Global test loss: 1.209, Global test accuracy: 61.91
Round  97, Train loss: 0.437, Test loss: 1.135, Test accuracy: 67.15
Round  97, Global train loss: 0.437, Global test loss: 1.337, Global test accuracy: 59.21
Round  98, Train loss: 0.455, Test loss: 1.137, Test accuracy: 67.31
Round  98, Global train loss: 0.455, Global test loss: 1.329, Global test accuracy: 59.84
Round  99, Train loss: 0.477, Test loss: 1.141, Test accuracy: 67.47
Round  99, Global train loss: 0.477, Global test loss: 1.449, Global test accuracy: 57.28
Final Round, Train loss: 0.401, Test loss: 1.225, Test accuracy: 67.93
Final Round, Global train loss: 0.401, Global test loss: 1.449, Global test accuracy: 57.28
Average accuracy final 10 rounds: 67.232 

Average global accuracy final 10 rounds: 59.506 

1453.9074404239655
[1.4521937370300293, 2.9043874740600586, 4.091725826263428, 5.279064178466797, 6.476081848144531, 7.673099517822266, 8.862627506256104, 10.052155494689941, 11.237329959869385, 12.422504425048828, 13.61390209197998, 14.805299758911133, 15.990844488143921, 17.17638921737671, 18.368816137313843, 19.561243057250977, 20.751914978027344, 21.94258689880371, 23.21851658821106, 24.494446277618408, 25.821534633636475, 27.14862298965454, 28.37123680114746, 29.59385061264038, 30.78092360496521, 31.96799659729004, 33.16988396644592, 34.37177133560181, 35.613245725631714, 36.85472011566162, 38.06964421272278, 39.284568309783936, 40.380900621414185, 41.477232933044434, 42.72491788864136, 43.97260284423828, 45.21517014503479, 46.4577374458313, 47.697776079177856, 48.937814712524414, 50.13846945762634, 51.33912420272827, 52.538076877593994, 53.73702955245972, 54.944315671920776, 56.151601791381836, 57.35271954536438, 58.553837299346924, 59.80252742767334, 61.051217555999756, 62.295063734054565, 63.538909912109375, 64.78383278846741, 66.02875566482544, 67.2710452079773, 68.51333475112915, 69.76020574569702, 71.00707674026489, 72.23927164077759, 73.47146654129028, 74.72054600715637, 75.96962547302246, 77.2135398387909, 78.45745420455933, 79.705317735672, 80.95318126678467, 82.20811605453491, 83.46305084228516, 84.7098479270935, 85.95664501190186, 87.19642877578735, 88.43621253967285, 89.67975282669067, 90.9232931137085, 92.12167501449585, 93.3200569152832, 94.4188277721405, 95.5175986289978, 96.6323230266571, 97.7470474243164, 98.86167097091675, 99.97629451751709, 101.20501804351807, 102.43374156951904, 103.65624666213989, 104.87875175476074, 106.10264301300049, 107.32653427124023, 108.57036757469177, 109.81420087814331, 111.0564546585083, 112.29870843887329, 113.53559136390686, 114.77247428894043, 116.0005452632904, 117.22861623764038, 118.46145009994507, 119.69428396224976, 120.92751717567444, 122.16075038909912, 123.32749962806702, 124.49424886703491, 125.58780908584595, 126.68136930465698, 127.76980757713318, 128.85824584960938, 129.93847680091858, 131.01870775222778, 132.1068172454834, 133.194926738739, 134.2850103378296, 135.37509393692017, 136.45637369155884, 137.5376534461975, 138.73691296577454, 139.93617248535156, 141.0134072303772, 142.09064197540283, 143.16953492164612, 144.2484278678894, 145.3461971282959, 146.4439663887024, 147.54322695732117, 148.64248752593994, 149.73295664787292, 150.8234257698059, 151.91585659980774, 153.00828742980957, 154.10244750976562, 155.19660758972168, 156.41340279579163, 157.63019800186157, 158.87341976165771, 160.11664152145386, 161.3440546989441, 162.57146787643433, 163.79832291603088, 165.02517795562744, 166.25259828567505, 167.48001861572266, 168.72038388252258, 169.9607491493225, 171.19246196746826, 172.424174785614, 173.6638662815094, 174.90355777740479, 176.14314079284668, 177.38272380828857, 178.6248483657837, 179.8669729232788, 180.95935344696045, 182.0517339706421, 183.29996180534363, 184.54818964004517, 185.7896900177002, 187.03119039535522, 188.259131193161, 189.4870719909668, 190.81945657730103, 192.15184116363525, 193.48195886611938, 194.81207656860352, 196.0086488723755, 197.20522117614746, 198.4162974357605, 199.62737369537354, 200.8373920917511, 202.04741048812866, 203.26770782470703, 204.4880051612854, 205.6936604976654, 206.8993158340454, 208.13806986808777, 209.37682390213013, 210.57904863357544, 211.78127336502075, 212.98086524009705, 214.18045711517334, 215.36816120147705, 216.55586528778076, 217.76497316360474, 218.9740810394287, 220.1789448261261, 221.3838086128235, 222.58338713645935, 223.78296566009521, 224.97884035110474, 226.17471504211426, 227.39953303337097, 228.62435102462769, 229.81851196289062, 231.01267290115356, 232.19756031036377, 233.38244771957397, 234.57983016967773, 235.7772126197815, 236.97382521629333, 238.17043781280518, 239.36467242240906, 240.55890703201294, 242.95561861991882, 245.3523302078247]
[24.84, 24.84, 32.17, 32.17, 35.3, 35.3, 39.26, 39.26, 44.39, 44.39, 47.66, 47.66, 50.54, 50.54, 51.27, 51.27, 53.1, 53.1, 53.94, 53.94, 56.49, 56.49, 57.82, 57.82, 58.84, 58.84, 59.4, 59.4, 59.56, 59.56, 58.79, 58.79, 58.65, 58.65, 59.93, 59.93, 59.47, 59.47, 59.58, 59.58, 59.96, 59.96, 59.98, 59.98, 61.06, 61.06, 61.35, 61.35, 62.83, 62.83, 63.29, 63.29, 62.57, 62.57, 63.42, 63.42, 63.85, 63.85, 64.05, 64.05, 64.64, 64.64, 64.46, 64.46, 63.58, 63.58, 65.05, 65.05, 65.18, 65.18, 66.26, 66.26, 66.18, 66.18, 66.66, 66.66, 66.56, 66.56, 66.17, 66.17, 66.42, 66.42, 66.5, 66.5, 66.13, 66.13, 65.96, 65.96, 67.31, 67.31, 66.47, 66.47, 65.87, 65.87, 66.49, 66.49, 66.67, 66.67, 66.23, 66.23, 65.56, 65.56, 66.01, 66.01, 65.33, 65.33, 66.35, 66.35, 66.27, 66.27, 65.75, 65.75, 65.93, 65.93, 65.66, 65.66, 66.05, 66.05, 66.15, 66.15, 66.18, 66.18, 66.72, 66.72, 66.67, 66.67, 66.77, 66.77, 67.61, 67.61, 67.11, 67.11, 66.5, 66.5, 66.83, 66.83, 67.44, 67.44, 67.81, 67.81, 67.87, 67.87, 67.4, 67.4, 67.46, 67.46, 67.08, 67.08, 67.08, 67.08, 67.36, 67.36, 67.04, 67.04, 68.21, 68.21, 68.07, 68.07, 68.05, 68.05, 67.58, 67.58, 66.99, 66.99, 67.81, 67.81, 68.09, 68.09, 67.78, 67.78, 67.95, 67.95, 68.01, 68.01, 67.98, 67.98, 67.32, 67.32, 66.95, 66.95, 66.77, 66.77, 66.93, 66.93, 66.85, 66.85, 67.5, 67.5, 67.42, 67.42, 67.59, 67.59, 67.33, 67.33, 67.15, 67.15, 67.31, 67.31, 67.47, 67.47, 67.93, 67.93]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.646, Test loss: 2.102, Test accuracy: 25.15
Round   0, Global train loss: 1.646, Global test loss: 2.312, Global test accuracy: 20.95
Round   1, Train loss: 1.528, Test loss: 1.784, Test accuracy: 32.82
Round   1, Global train loss: 1.528, Global test loss: 2.102, Global test accuracy: 25.78
Round   2, Train loss: 1.343, Test loss: 1.645, Test accuracy: 37.55
Round   2, Global train loss: 1.343, Global test loss: 2.216, Global test accuracy: 25.79
Round   3, Train loss: 1.290, Test loss: 1.575, Test accuracy: 40.37
Round   3, Global train loss: 1.290, Global test loss: 2.142, Global test accuracy: 27.77
Round   4, Train loss: 1.318, Test loss: 1.428, Test accuracy: 44.97
Round   4, Global train loss: 1.318, Global test loss: 1.810, Global test accuracy: 34.28
Round   5, Train loss: 1.250, Test loss: 1.351, Test accuracy: 48.84
Round   5, Global train loss: 1.250, Global test loss: 1.721, Global test accuracy: 38.30
Round   6, Train loss: 1.102, Test loss: 1.296, Test accuracy: 51.51
Round   6, Global train loss: 1.102, Global test loss: 1.726, Global test accuracy: 38.02
Round   7, Train loss: 1.108, Test loss: 1.294, Test accuracy: 52.70
Round   7, Global train loss: 1.108, Global test loss: 1.790, Global test accuracy: 37.91
Round   8, Train loss: 1.135, Test loss: 1.260, Test accuracy: 53.54
Round   8, Global train loss: 1.135, Global test loss: 1.678, Global test accuracy: 40.99
Round   9, Train loss: 1.187, Test loss: 1.250, Test accuracy: 54.56
Round   9, Global train loss: 1.187, Global test loss: 1.722, Global test accuracy: 42.44
Round  10, Train loss: 1.053, Test loss: 1.155, Test accuracy: 57.31
Round  10, Global train loss: 1.053, Global test loss: 1.866, Global test accuracy: 41.71
Round  11, Train loss: 0.980, Test loss: 1.172, Test accuracy: 57.22
Round  11, Global train loss: 0.980, Global test loss: 1.583, Global test accuracy: 45.96
Round  12, Train loss: 1.019, Test loss: 1.147, Test accuracy: 57.86
Round  12, Global train loss: 1.019, Global test loss: 1.615, Global test accuracy: 43.53
Round  13, Train loss: 1.057, Test loss: 1.157, Test accuracy: 57.52
Round  13, Global train loss: 1.057, Global test loss: 1.699, Global test accuracy: 41.45
Round  14, Train loss: 1.025, Test loss: 1.136, Test accuracy: 58.20
Round  14, Global train loss: 1.025, Global test loss: 1.550, Global test accuracy: 46.68
Round  15, Train loss: 1.010, Test loss: 1.121, Test accuracy: 59.18
Round  15, Global train loss: 1.010, Global test loss: 1.551, Global test accuracy: 44.92
Round  16, Train loss: 0.946, Test loss: 1.120, Test accuracy: 59.46
Round  16, Global train loss: 0.946, Global test loss: 1.426, Global test accuracy: 50.82
Round  17, Train loss: 0.978, Test loss: 1.096, Test accuracy: 60.16
Round  17, Global train loss: 0.978, Global test loss: 1.430, Global test accuracy: 51.07
Round  18, Train loss: 0.937, Test loss: 1.091, Test accuracy: 60.35
Round  18, Global train loss: 0.937, Global test loss: 1.548, Global test accuracy: 46.53
Round  19, Train loss: 0.972, Test loss: 1.064, Test accuracy: 61.81
Round  19, Global train loss: 0.972, Global test loss: 1.629, Global test accuracy: 46.57
Round  20, Train loss: 0.991, Test loss: 1.064, Test accuracy: 61.50
Round  20, Global train loss: 0.991, Global test loss: 1.624, Global test accuracy: 44.80
Round  21, Train loss: 0.945, Test loss: 1.056, Test accuracy: 61.79
Round  21, Global train loss: 0.945, Global test loss: 1.523, Global test accuracy: 49.79
Round  22, Train loss: 0.917, Test loss: 1.065, Test accuracy: 61.99
Round  22, Global train loss: 0.917, Global test loss: 1.404, Global test accuracy: 51.89
Round  23, Train loss: 0.865, Test loss: 1.057, Test accuracy: 62.37
Round  23, Global train loss: 0.865, Global test loss: 1.636, Global test accuracy: 45.72
Round  24, Train loss: 0.887, Test loss: 1.046, Test accuracy: 62.78
Round  24, Global train loss: 0.887, Global test loss: 1.634, Global test accuracy: 45.44
Round  25, Train loss: 0.823, Test loss: 1.043, Test accuracy: 63.25
Round  25, Global train loss: 0.823, Global test loss: 1.358, Global test accuracy: 52.32
Round  26, Train loss: 0.869, Test loss: 1.086, Test accuracy: 61.96
Round  26, Global train loss: 0.869, Global test loss: 1.353, Global test accuracy: 52.82
Round  27, Train loss: 0.927, Test loss: 1.063, Test accuracy: 62.47
Round  27, Global train loss: 0.927, Global test loss: 1.475, Global test accuracy: 49.61
Round  28, Train loss: 0.829, Test loss: 1.064, Test accuracy: 62.95
Round  28, Global train loss: 0.829, Global test loss: 1.420, Global test accuracy: 52.59
Round  29, Train loss: 0.854, Test loss: 1.079, Test accuracy: 62.42
Round  29, Global train loss: 0.854, Global test loss: 1.403, Global test accuracy: 53.44
Round  30, Train loss: 0.825, Test loss: 1.066, Test accuracy: 63.15
Round  30, Global train loss: 0.825, Global test loss: 1.359, Global test accuracy: 53.06
Round  31, Train loss: 0.836, Test loss: 1.069, Test accuracy: 62.81
Round  31, Global train loss: 0.836, Global test loss: 1.619, Global test accuracy: 44.48
Round  32, Train loss: 0.763, Test loss: 1.047, Test accuracy: 63.57
Round  32, Global train loss: 0.763, Global test loss: 1.323, Global test accuracy: 55.99
Round  33, Train loss: 0.704, Test loss: 1.076, Test accuracy: 63.16
Round  33, Global train loss: 0.704, Global test loss: 1.455, Global test accuracy: 52.57
Round  34, Train loss: 0.869, Test loss: 1.062, Test accuracy: 64.24
Round  34, Global train loss: 0.869, Global test loss: 1.284, Global test accuracy: 56.52
Round  35, Train loss: 0.805, Test loss: 1.059, Test accuracy: 64.20
Round  35, Global train loss: 0.805, Global test loss: 1.260, Global test accuracy: 56.78
Round  36, Train loss: 0.873, Test loss: 1.035, Test accuracy: 64.68
Round  36, Global train loss: 0.873, Global test loss: 1.361, Global test accuracy: 53.26
Round  37, Train loss: 0.759, Test loss: 1.033, Test accuracy: 65.06
Round  37, Global train loss: 0.759, Global test loss: 1.224, Global test accuracy: 57.92
Round  38, Train loss: 0.634, Test loss: 1.017, Test accuracy: 65.30
Round  38, Global train loss: 0.634, Global test loss: 1.228, Global test accuracy: 59.09
Round  39, Train loss: 0.770, Test loss: 1.019, Test accuracy: 65.57
Round  39, Global train loss: 0.770, Global test loss: 1.288, Global test accuracy: 56.72
Round  40, Train loss: 0.731, Test loss: 1.021, Test accuracy: 65.69
Round  40, Global train loss: 0.731, Global test loss: 1.655, Global test accuracy: 50.12
Round  41, Train loss: 0.654, Test loss: 1.044, Test accuracy: 65.57
Round  41, Global train loss: 0.654, Global test loss: 1.326, Global test accuracy: 55.62
Round  42, Train loss: 0.730, Test loss: 1.049, Test accuracy: 65.89
Round  42, Global train loss: 0.730, Global test loss: 1.293, Global test accuracy: 57.73
Round  43, Train loss: 0.792, Test loss: 1.060, Test accuracy: 65.85
Round  43, Global train loss: 0.792, Global test loss: 1.421, Global test accuracy: 52.79
Round  44, Train loss: 0.635, Test loss: 1.023, Test accuracy: 66.69
Round  44, Global train loss: 0.635, Global test loss: 1.328, Global test accuracy: 57.62
Round  45, Train loss: 0.721, Test loss: 1.033, Test accuracy: 66.18
Round  45, Global train loss: 0.721, Global test loss: 1.254, Global test accuracy: 57.96
Round  46, Train loss: 0.618, Test loss: 1.043, Test accuracy: 66.10
Round  46, Global train loss: 0.618, Global test loss: 1.462, Global test accuracy: 54.62
Round  47, Train loss: 0.584, Test loss: 1.037, Test accuracy: 66.13
Round  47, Global train loss: 0.584, Global test loss: 1.300, Global test accuracy: 58.35
Round  48, Train loss: 0.657, Test loss: 1.029, Test accuracy: 66.39
Round  48, Global train loss: 0.657, Global test loss: 1.355, Global test accuracy: 57.42
Round  49, Train loss: 0.666, Test loss: 1.034, Test accuracy: 66.26
Round  49, Global train loss: 0.666, Global test loss: 1.264, Global test accuracy: 58.29
Round  50, Train loss: 0.670, Test loss: 1.038, Test accuracy: 66.07
Round  50, Global train loss: 0.670, Global test loss: 1.400, Global test accuracy: 54.63
Round  51, Train loss: 0.630, Test loss: 1.049, Test accuracy: 65.96
Round  51, Global train loss: 0.630, Global test loss: 1.171, Global test accuracy: 61.66
Round  52, Train loss: 0.690, Test loss: 1.027, Test accuracy: 67.02
Round  52, Global train loss: 0.690, Global test loss: 1.227, Global test accuracy: 59.67
Round  53, Train loss: 0.545, Test loss: 1.037, Test accuracy: 66.69
Round  53, Global train loss: 0.545, Global test loss: 1.397, Global test accuracy: 56.27
Round  54, Train loss: 0.656, Test loss: 1.001, Test accuracy: 67.58
Round  54, Global train loss: 0.656, Global test loss: 1.304, Global test accuracy: 55.89
Round  55, Train loss: 0.654, Test loss: 1.032, Test accuracy: 67.13
Round  55, Global train loss: 0.654, Global test loss: 1.262, Global test accuracy: 57.87
Round  56, Train loss: 0.637, Test loss: 1.032, Test accuracy: 67.34
Round  56, Global train loss: 0.637, Global test loss: 1.306, Global test accuracy: 56.76
Round  57, Train loss: 0.523, Test loss: 1.023, Test accuracy: 67.38
Round  57, Global train loss: 0.523, Global test loss: 1.242, Global test accuracy: 60.53
Round  58, Train loss: 0.592, Test loss: 1.001, Test accuracy: 67.88
Round  58, Global train loss: 0.592, Global test loss: 1.228, Global test accuracy: 59.94
Round  59, Train loss: 0.516, Test loss: 1.014, Test accuracy: 67.30
Round  59, Global train loss: 0.516, Global test loss: 1.450, Global test accuracy: 54.79
Round  60, Train loss: 0.571, Test loss: 1.024, Test accuracy: 67.94
Round  60, Global train loss: 0.571, Global test loss: 1.270, Global test accuracy: 59.89
Round  61, Train loss: 0.597, Test loss: 1.047, Test accuracy: 67.44
Round  61, Global train loss: 0.597, Global test loss: 1.344, Global test accuracy: 56.92
Round  62, Train loss: 0.514, Test loss: 1.078, Test accuracy: 66.91
Round  62, Global train loss: 0.514, Global test loss: 1.350, Global test accuracy: 58.73
Round  63, Train loss: 0.572, Test loss: 1.094, Test accuracy: 66.62
Round  63, Global train loss: 0.572, Global test loss: 1.381, Global test accuracy: 56.10
Round  64, Train loss: 0.624, Test loss: 1.117, Test accuracy: 66.47
Round  64, Global train loss: 0.624, Global test loss: 1.214, Global test accuracy: 60.38
Round  65, Train loss: 0.553, Test loss: 1.113, Test accuracy: 66.54
Round  65, Global train loss: 0.553, Global test loss: 1.488, Global test accuracy: 55.35
Round  66, Train loss: 0.626, Test loss: 1.093, Test accuracy: 67.04
Round  66, Global train loss: 0.626, Global test loss: 1.346, Global test accuracy: 56.73
Round  67, Train loss: 0.505, Test loss: 1.103, Test accuracy: 67.24
Round  67, Global train loss: 0.505, Global test loss: 1.289, Global test accuracy: 59.81
Round  68, Train loss: 0.592, Test loss: 1.098, Test accuracy: 67.05
Round  68, Global train loss: 0.592, Global test loss: 1.232, Global test accuracy: 60.07
Round  69, Train loss: 0.489, Test loss: 1.095, Test accuracy: 67.23
Round  69, Global train loss: 0.489, Global test loss: 1.550, Global test accuracy: 56.13
Round  70, Train loss: 0.533, Test loss: 1.130, Test accuracy: 67.37
Round  70, Global train loss: 0.533, Global test loss: 1.281, Global test accuracy: 59.70
Round  71, Train loss: 0.472, Test loss: 1.075, Test accuracy: 67.62
Round  71, Global train loss: 0.472, Global test loss: 1.365, Global test accuracy: 59.60
Round  72, Train loss: 0.557, Test loss: 1.073, Test accuracy: 67.09
Round  72, Global train loss: 0.557, Global test loss: 1.221, Global test accuracy: 60.97
Round  73, Train loss: 0.602, Test loss: 1.085, Test accuracy: 66.62
Round  73, Global train loss: 0.602, Global test loss: 1.293, Global test accuracy: 59.02
Round  74, Train loss: 0.557, Test loss: 1.113, Test accuracy: 66.19
Round  74, Global train loss: 0.557, Global test loss: 1.264, Global test accuracy: 60.49
Round  75, Train loss: 0.485, Test loss: 1.121, Test accuracy: 66.41
Round  75, Global train loss: 0.485, Global test loss: 1.370, Global test accuracy: 58.65
Round  76, Train loss: 0.490, Test loss: 1.136, Test accuracy: 66.21
Round  76, Global train loss: 0.490, Global test loss: 1.344, Global test accuracy: 59.40
Round  77, Train loss: 0.430, Test loss: 1.127, Test accuracy: 66.61
Round  77, Global train loss: 0.430, Global test loss: 1.352, Global test accuracy: 59.18
Round  78, Train loss: 0.448, Test loss: 1.108, Test accuracy: 67.04
Round  78, Global train loss: 0.448, Global test loss: 1.493, Global test accuracy: 57.23
Round  79, Train loss: 0.480, Test loss: 1.172, Test accuracy: 66.22
Round  79, Global train loss: 0.480, Global test loss: 1.305, Global test accuracy: 60.36
Round  80, Train loss: 0.538, Test loss: 1.152, Test accuracy: 66.63
Round  80, Global train loss: 0.538, Global test loss: 1.282, Global test accuracy: 59.60
Round  81, Train loss: 0.547, Test loss: 1.146, Test accuracy: 67.15
Round  81, Global train loss: 0.547, Global test loss: 1.390, Global test accuracy: 58.06
Round  82, Train loss: 0.500, Test loss: 1.165, Test accuracy: 67.22
Round  82, Global train loss: 0.500, Global test loss: 1.330, Global test accuracy: 59.32
Round  83, Train loss: 0.450, Test loss: 1.143, Test accuracy: 67.45
Round  83, Global train loss: 0.450, Global test loss: 1.209, Global test accuracy: 62.23
Round  84, Train loss: 0.492, Test loss: 1.137, Test accuracy: 67.65
Round  84, Global train loss: 0.492, Global test loss: 1.192, Global test accuracy: 61.84
Round  85, Train loss: 0.464, Test loss: 1.147, Test accuracy: 67.12
Round  85, Global train loss: 0.464, Global test loss: 1.271, Global test accuracy: 59.93
Round  86, Train loss: 0.447, Test loss: 1.156, Test accuracy: 67.32
Round  86, Global train loss: 0.447, Global test loss: 1.250, Global test accuracy: 61.05
Round  87, Train loss: 0.371, Test loss: 1.157, Test accuracy: 67.53
Round  87, Global train loss: 0.371, Global test loss: 1.409, Global test accuracy: 58.85
Round  88, Train loss: 0.465, Test loss: 1.168, Test accuracy: 67.65
Round  88, Global train loss: 0.465, Global test loss: 1.315, Global test accuracy: 58.08
Round  89, Train loss: 0.449, Test loss: 1.163, Test accuracy: 67.98
Round  89, Global train loss: 0.449, Global test loss: 1.314, Global test accuracy: 59.88
Round  90, Train loss: 0.492, Test loss: 1.152, Test accuracy: 68.38
Round  90, Global train loss: 0.492, Global test loss: 1.353, Global test accuracy: 59.27
Round  91, Train loss: 0.483, Test loss: 1.170, Test accuracy: 68.06
Round  91, Global train loss: 0.483, Global test loss: 1.355, Global test accuracy: 59.04
Round  92, Train loss: 0.515, Test loss: 1.182, Test accuracy: 67.86
Round  92, Global train loss: 0.515, Global test loss: 1.442, Global test accuracy: 57.87
Round  93, Train loss: 0.366, Test loss: 1.198, Test accuracy: 67.52
Round  93, Global train loss: 0.366, Global test loss: 1.344, Global test accuracy: 61.57
Round  94, Train loss: 0.345, Test loss: 1.156, Test accuracy: 67.91
Round  94, Global train loss: 0.345, Global test loss: 1.449, Global test accuracy: 59.75
Round  95, Train loss: 0.466, Test loss: 1.157, Test accuracy: 67.72
Round  95, Global train loss: 0.466, Global test loss: 1.442, Global test accuracy: 58.48
Round  96, Train loss: 0.359, Test loss: 1.154, Test accuracy: 68.07
Round  96, Global train loss: 0.359, Global test loss: 1.231, Global test accuracy: 62.35
Round  97, Train loss: 0.410, Test loss: 1.167, Test accuracy: 68.05
Round  97, Global train loss: 0.410, Global test loss: 1.461, Global test accuracy: 58.66
Round  98, Train loss: 0.392, Test loss: 1.178, Test accuracy: 67.42
Round  98, Global train loss: 0.392, Global test loss: 1.370, Global test accuracy: 60.66
Round  99, Train loss: 0.411, Test loss: 1.168, Test accuracy: 67.74
Round  99, Global train loss: 0.411, Global test loss: 1.307, Global test accuracy: 61.28
Final Round, Train loss: 0.335, Test loss: 1.343, Test accuracy: 67.67
Final Round, Global train loss: 0.335, Global test loss: 1.307, Global test accuracy: 61.28
Average accuracy final 10 rounds: 67.87299999999999
Average global accuracy final 10 rounds: 59.893
1898.9655051231384
[3.228381395339966, 5.917781829833984, 8.748001337051392, 11.318567991256714, 13.52162790298462, 15.732497692108154, 17.920353651046753, 20.102986812591553, 22.30681872367859, 24.759076833724976, 27.17380118370056, 29.636915922164917, 31.92541813850403, 34.096457719802856, 36.2685124874115, 38.449678897857666, 40.625542402267456, 42.8122832775116, 44.98432660102844, 47.1573703289032, 49.56598424911499, 52.00794744491577, 54.44684100151062, 56.880276918411255, 59.32545042037964, 61.77724266052246, 63.96010208129883, 66.1364119052887, 68.32350158691406, 70.50032663345337, 72.66700601577759, 74.84746885299683, 77.03857898712158, 79.22151732444763, 81.3984522819519, 83.58345127105713, 85.93458271026611, 88.38103461265564, 90.83491539955139, 93.27742433547974, 95.70785760879517, 98.13484907150269, 100.57099294662476, 103.04342651367188, 105.47198390960693, 107.91778588294983, 110.33766651153564, 112.77652621269226, 115.19670748710632, 117.64256548881531, 120.07432436943054, 122.52259063720703, 124.97249245643616, 127.15445756912231, 129.3749783039093, 131.681325674057, 134.06935000419617, 136.49145245552063, 138.9349913597107, 141.37898969650269, 143.5554563999176, 145.72100400924683, 147.91009759902954, 150.07173824310303, 152.47430205345154, 154.89289665222168, 157.329261302948, 159.77812004089355, 162.1960380077362, 164.6175389289856, 166.81681776046753, 168.97399234771729, 171.13872241973877, 173.3069624900818, 175.53556942939758, 177.68420720100403, 179.83226466178894, 181.9782841205597, 184.14725351333618, 186.4424331188202, 188.60841155052185, 191.17140746116638, 194.27143216133118, 197.13806796073914, 199.61765027046204, 202.54130673408508, 204.97494769096375, 207.73218750953674, 210.4443597793579, 213.01576614379883, 215.44391894340515, 218.01327800750732, 220.46842074394226, 223.23692989349365, 225.63206219673157, 227.99428510665894, 230.20088720321655, 232.41255259513855, 234.5934591293335, 236.77628016471863, 240.69923877716064]
[25.15, 32.82, 37.55, 40.37, 44.97, 48.84, 51.51, 52.7, 53.54, 54.56, 57.31, 57.22, 57.86, 57.52, 58.2, 59.18, 59.46, 60.16, 60.35, 61.81, 61.5, 61.79, 61.99, 62.37, 62.78, 63.25, 61.96, 62.47, 62.95, 62.42, 63.15, 62.81, 63.57, 63.16, 64.24, 64.2, 64.68, 65.06, 65.3, 65.57, 65.69, 65.57, 65.89, 65.85, 66.69, 66.18, 66.1, 66.13, 66.39, 66.26, 66.07, 65.96, 67.02, 66.69, 67.58, 67.13, 67.34, 67.38, 67.88, 67.3, 67.94, 67.44, 66.91, 66.62, 66.47, 66.54, 67.04, 67.24, 67.05, 67.23, 67.37, 67.62, 67.09, 66.62, 66.19, 66.41, 66.21, 66.61, 67.04, 66.22, 66.63, 67.15, 67.22, 67.45, 67.65, 67.12, 67.32, 67.53, 67.65, 67.98, 68.38, 68.06, 67.86, 67.52, 67.91, 67.72, 68.07, 68.05, 67.42, 67.74, 67.67]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  13.3300
Round 1 global test acc  19.1400
Round 2 global test acc  21.8900
Round 3 global test acc  26.5900
Round 4 global test acc  26.4800
Round 5 global test acc  30.4300
Round 6 global test acc  25.6000
Round 7 global test acc  24.1000
Round 8 global test acc  29.7300
Round 9 global test acc  32.9500
Round 10 global test acc  30.8600
Round 11 global test acc  26.6600
Round 12 global test acc  29.3900
Round 13 global test acc  33.2900
Round 14 global test acc  28.6700
Round 15 global test acc  31.3200
Round 16 global test acc  25.5900
Round 17 global test acc  34.8300
Round 18 global test acc  36.3800
Round 19 global test acc  31.9000
Round 20 global test acc  37.6300
Round 21 global test acc  34.1100
Round 22 global test acc  32.2600
Round 23 global test acc  26.1900
Round 24 global test acc  32.0600
Round 25 global test acc  31.2400
Round 26 global test acc  42.5300
Round 27 global test acc  34.9500
Round 28 global test acc  35.2200
Round 29 global test acc  41.9200
Round 30 global test acc  36.5800
Round 31 global test acc  36.6800
Round 32 global test acc  30.3100
Round 33 global test acc  32.3300
Round 34 global test acc  41.8500
Round 35 global test acc  36.0200
Round 36 global test acc  37.1900
Round 37 global test acc  34.9900
Round 38 global test acc  41.5800
Round 39 global test acc  40.6300
Round 40 global test acc  41.9100
Round 41 global test acc  30.8200
Round 42 global test acc  32.7100
Round 43 global test acc  44.2600
Round 44 global test acc  32.2600
Round 45 global test acc  40.4200
Round 46 global test acc  35.9600
Round 47 global test acc  36.5400
Round 48 global test acc  47.3800
Round 49 global test acc  35.0200
Round 50 global test acc  34.1400
Round 51 global test acc  43.9200
Round 52 global test acc  39.6600
Round 53 global test acc  37.5100
Round 54 global test acc  35.5700
Round 55 global test acc  36.1500
Round 56 global test acc  41.4300
Round 57 global test acc  39.3300
Round 58 global test acc  37.8300
Round 59 global test acc  38.5200
Round 60 global test acc  37.8900
Round 61 global test acc  40.0800
Round 62 global test acc  32.3900
Round 63 global test acc  37.4000
Round 64 global test acc  35.3800
Round 65 global test acc  44.1000
Round 66 global test acc  43.1200
Round 67 global test acc  43.4100
Round 68 global test acc  35.0900
Round 69 global test acc  47.0500
Round 70 global test acc  36.6400
Round 71 global test acc  39.0400
Round 72 global test acc  38.2700
Round 73 global test acc  34.8500
Round 74 global test acc  45.0600
Round 75 global test acc  39.5600
Round 76 global test acc  44.1500
Round 77 global test acc  39.8300
Round 78 global test acc  44.3400
Round 79 global test acc  46.1100
Round 80 global test acc  45.8700
Round 81 global test acc  43.7900
Round 82 global test acc  40.3700
Round 83 global test acc  36.6300
Round 84 global test acc  33.8500
Round 85 global test acc  33.3600
Round 86 global test acc  31.0700
Round 87 global test acc  28.8400
Round 88 global test acc  27.2300
Round 89 global test acc  25.5500
Round 90 global test acc  22.6400
Round 91 global test acc  19.2700
Round 92 global test acc  17.7000
Round 93 global test acc  17.0700
Round 94 global test acc  16.8700
Round 95 global test acc  16.9400
Round 96 global test acc  16.7000
Round 97 global test acc  17.3500
Round 98 global test acc  16.2600
Round 99 global test acc  16.2500
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.954, Test loss: 2.168, Test accuracy: 23.57
Round   1, Train loss: 1.547, Test loss: 1.849, Test accuracy: 30.80
Round   2, Train loss: 1.546, Test loss: 1.693, Test accuracy: 33.70
Round   3, Train loss: 1.331, Test loss: 1.693, Test accuracy: 37.76
Round   4, Train loss: 1.288, Test loss: 1.494, Test accuracy: 44.65
Round   5, Train loss: 1.256, Test loss: 1.330, Test accuracy: 49.09
Round   6, Train loss: 1.329, Test loss: 1.262, Test accuracy: 51.85
Round   7, Train loss: 1.247, Test loss: 1.254, Test accuracy: 52.33
Round   8, Train loss: 1.131, Test loss: 1.226, Test accuracy: 53.35
Round   9, Train loss: 1.120, Test loss: 1.158, Test accuracy: 55.99
Round  10, Train loss: 1.177, Test loss: 1.085, Test accuracy: 59.14
Round  11, Train loss: 1.180, Test loss: 1.079, Test accuracy: 59.53
Round  12, Train loss: 1.125, Test loss: 1.064, Test accuracy: 60.47
Round  13, Train loss: 1.158, Test loss: 1.064, Test accuracy: 60.72
Round  14, Train loss: 1.160, Test loss: 1.022, Test accuracy: 61.86
Round  15, Train loss: 1.067, Test loss: 1.017, Test accuracy: 61.18
Round  16, Train loss: 1.087, Test loss: 0.991, Test accuracy: 62.92
Round  17, Train loss: 1.021, Test loss: 0.986, Test accuracy: 62.53
Round  18, Train loss: 0.972, Test loss: 0.982, Test accuracy: 63.35
Round  19, Train loss: 0.978, Test loss: 0.961, Test accuracy: 64.03
Round  20, Train loss: 0.989, Test loss: 0.964, Test accuracy: 64.34
Round  21, Train loss: 0.933, Test loss: 0.970, Test accuracy: 63.77
Round  22, Train loss: 0.947, Test loss: 0.959, Test accuracy: 64.65
Round  23, Train loss: 0.869, Test loss: 0.955, Test accuracy: 65.28
Round  24, Train loss: 1.060, Test loss: 0.915, Test accuracy: 65.84
Round  25, Train loss: 0.932, Test loss: 0.912, Test accuracy: 66.46
Round  26, Train loss: 0.875, Test loss: 0.907, Test accuracy: 66.80
Round  27, Train loss: 0.908, Test loss: 0.911, Test accuracy: 66.88
Round  28, Train loss: 0.946, Test loss: 0.903, Test accuracy: 66.55
Round  29, Train loss: 0.921, Test loss: 0.888, Test accuracy: 67.38
Round  30, Train loss: 1.032, Test loss: 0.884, Test accuracy: 68.10
Round  31, Train loss: 0.903, Test loss: 0.872, Test accuracy: 68.42
Round  32, Train loss: 0.837, Test loss: 0.874, Test accuracy: 68.59
Round  33, Train loss: 0.921, Test loss: 0.860, Test accuracy: 68.18
Round  34, Train loss: 0.873, Test loss: 0.855, Test accuracy: 69.04
Round  35, Train loss: 0.773, Test loss: 0.857, Test accuracy: 68.37
Round  36, Train loss: 0.769, Test loss: 0.845, Test accuracy: 69.14
Round  37, Train loss: 0.947, Test loss: 0.818, Test accuracy: 70.32
Round  38, Train loss: 0.937, Test loss: 0.838, Test accuracy: 69.25
Round  39, Train loss: 0.764, Test loss: 0.816, Test accuracy: 70.23
Round  40, Train loss: 0.801, Test loss: 0.838, Test accuracy: 69.73
Round  41, Train loss: 0.810, Test loss: 0.825, Test accuracy: 70.23
Round  42, Train loss: 0.858, Test loss: 0.819, Test accuracy: 70.19
Round  43, Train loss: 0.892, Test loss: 0.797, Test accuracy: 70.64
Round  44, Train loss: 0.800, Test loss: 0.796, Test accuracy: 71.05
Round  45, Train loss: 0.857, Test loss: 0.800, Test accuracy: 70.95
Round  46, Train loss: 0.773, Test loss: 0.793, Test accuracy: 71.25
Round  47, Train loss: 0.770, Test loss: 0.784, Test accuracy: 71.44
Round  48, Train loss: 0.784, Test loss: 0.779, Test accuracy: 71.71
Round  49, Train loss: 0.745, Test loss: 0.783, Test accuracy: 71.60
Round  50, Train loss: 0.673, Test loss: 0.779, Test accuracy: 71.31
Round  51, Train loss: 0.779, Test loss: 0.786, Test accuracy: 71.52
Round  52, Train loss: 0.758, Test loss: 0.778, Test accuracy: 71.08
Round  53, Train loss: 0.727, Test loss: 0.777, Test accuracy: 71.63
Round  54, Train loss: 0.809, Test loss: 0.777, Test accuracy: 71.69
Round  55, Train loss: 0.696, Test loss: 0.784, Test accuracy: 71.29
Round  56, Train loss: 0.669, Test loss: 0.771, Test accuracy: 72.02
Round  57, Train loss: 0.737, Test loss: 0.776, Test accuracy: 71.93
Round  58, Train loss: 0.680, Test loss: 0.761, Test accuracy: 72.15
Round  59, Train loss: 0.637, Test loss: 0.764, Test accuracy: 72.03
Round  60, Train loss: 0.573, Test loss: 0.778, Test accuracy: 71.56
Round  61, Train loss: 0.658, Test loss: 0.781, Test accuracy: 71.64
Round  62, Train loss: 0.625, Test loss: 0.785, Test accuracy: 71.70
Round  63, Train loss: 0.591, Test loss: 0.762, Test accuracy: 72.46
Round  64, Train loss: 0.709, Test loss: 0.751, Test accuracy: 72.73
Round  65, Train loss: 0.687, Test loss: 0.743, Test accuracy: 72.89
Round  66, Train loss: 0.607, Test loss: 0.741, Test accuracy: 73.20
Round  67, Train loss: 0.570, Test loss: 0.745, Test accuracy: 72.99
Round  68, Train loss: 0.623, Test loss: 0.757, Test accuracy: 72.80
Round  69, Train loss: 0.571, Test loss: 0.759, Test accuracy: 72.49
Round  70, Train loss: 0.504, Test loss: 0.754, Test accuracy: 72.82
Round  71, Train loss: 0.537, Test loss: 0.755, Test accuracy: 72.93
Round  72, Train loss: 0.596, Test loss: 0.745, Test accuracy: 72.96
Round  73, Train loss: 0.608, Test loss: 0.751, Test accuracy: 72.62
Round  74, Train loss: 0.701, Test loss: 0.748, Test accuracy: 72.77
Round  75, Train loss: 0.552, Test loss: 0.757, Test accuracy: 72.67
Round  76, Train loss: 0.511, Test loss: 0.761, Test accuracy: 72.44
Round  77, Train loss: 0.638, Test loss: 0.756, Test accuracy: 73.00
Round  78, Train loss: 0.580, Test loss: 0.745, Test accuracy: 73.19
Round  79, Train loss: 0.614, Test loss: 0.746, Test accuracy: 73.04
Round  80, Train loss: 0.618, Test loss: 0.744, Test accuracy: 73.24
Round  81, Train loss: 0.552, Test loss: 0.750, Test accuracy: 73.01
Round  82, Train loss: 0.500, Test loss: 0.746, Test accuracy: 73.03
Round  83, Train loss: 0.674, Test loss: 0.738, Test accuracy: 73.45
Round  84, Train loss: 0.696, Test loss: 0.742, Test accuracy: 73.07
Round  85, Train loss: 0.592, Test loss: 0.735, Test accuracy: 73.43
Round  86, Train loss: 0.631, Test loss: 0.749, Test accuracy: 73.78
Round  87, Train loss: 0.629, Test loss: 0.754, Test accuracy: 73.04
Round  88, Train loss: 0.601, Test loss: 0.743, Test accuracy: 73.25
Round  89, Train loss: 0.477, Test loss: 0.747, Test accuracy: 72.94
Round  90, Train loss: 0.455, Test loss: 0.748, Test accuracy: 72.99
Round  91, Train loss: 0.613, Test loss: 0.748, Test accuracy: 73.35
Round  92, Train loss: 0.482, Test loss: 0.752, Test accuracy: 72.94
Round  93, Train loss: 0.491, Test loss: 0.750, Test accuracy: 72.76
Round  94, Train loss: 0.476, Test loss: 0.755, Test accuracy: 72.81
Round  95, Train loss: 0.464, Test loss: 0.747, Test accuracy: 73.27
Round  96, Train loss: 0.591, Test loss: 0.745, Test accuracy: 73.79
Round  97, Train loss: 0.431, Test loss: 0.751, Test accuracy: 73.51
Round  98, Train loss: 0.497, Test loss: 0.748, Test accuracy: 73.64
Round  99, Train loss: 0.536, Test loss: 0.742, Test accuracy: 73.79
Final Round, Train loss: 0.481, Test loss: 0.748, Test accuracy: 73.55
Average accuracy final 10 rounds: 73.285
944.110426902771
[1.560056209564209, 2.7883589267730713, 4.008006811141968, 5.2519919872283936, 6.393092632293701, 7.53594970703125, 8.68381404876709, 9.829871892929077, 10.95729923248291, 12.118654012680054, 13.269170045852661, 14.407443523406982, 15.548884630203247, 16.700361728668213, 17.861350774765015, 19.016186475753784, 20.18118715286255, 21.346617221832275, 22.492546319961548, 23.64488697052002, 24.78920865058899, 25.931244134902954, 27.080782175064087, 28.21444845199585, 29.36161470413208, 30.51151967048645, 31.658812761306763, 32.79967212677002, 33.95505976676941, 35.11502170562744, 36.268134355545044, 37.41580057144165, 38.563849210739136, 39.709760665893555, 40.859325647354126, 42.01951313018799, 43.16923451423645, 44.33369183540344, 45.478129386901855, 46.613133907318115, 47.76403594017029, 48.9168975353241, 50.053600549697876, 51.200446367263794, 52.33879899978638, 53.51853346824646, 54.66728115081787, 55.96298432350159, 57.23099160194397, 58.37209177017212, 59.514352321624756, 60.64992690086365, 61.78834295272827, 62.92739272117615, 64.06637120246887, 65.20174956321716, 66.34827423095703, 67.49323153495789, 68.6381516456604, 69.88704109191895, 71.14018726348877, 72.36298537254333, 73.56594562530518, 74.77882075309753, 76.03193759918213, 77.29087376594543, 78.54841685295105, 79.81978607177734, 80.99095368385315, 82.18782067298889, 83.36563467979431, 84.5522735118866, 85.74345421791077, 86.92537450790405, 88.10649061203003, 89.28351283073425, 90.482102394104, 91.68693494796753, 92.95248436927795, 94.21916198730469, 95.48008632659912, 96.7476761341095, 98.01010918617249, 99.28879499435425, 100.55319714546204, 101.81507062911987, 103.00538730621338, 104.13491535186768, 105.28807377815247, 106.43808603286743, 107.59561538696289, 108.74133849143982, 109.88867616653442, 111.00365138053894, 112.15217900276184, 113.29589653015137, 114.42378997802734, 115.56482005119324, 116.82998585700989, 117.96246075630188, 119.83200359344482]
[23.57, 30.8, 33.7, 37.76, 44.65, 49.09, 51.85, 52.33, 53.35, 55.99, 59.14, 59.53, 60.47, 60.72, 61.86, 61.18, 62.92, 62.53, 63.35, 64.03, 64.34, 63.77, 64.65, 65.28, 65.84, 66.46, 66.8, 66.88, 66.55, 67.38, 68.1, 68.42, 68.59, 68.18, 69.04, 68.37, 69.14, 70.32, 69.25, 70.23, 69.73, 70.23, 70.19, 70.64, 71.05, 70.95, 71.25, 71.44, 71.71, 71.6, 71.31, 71.52, 71.08, 71.63, 71.69, 71.29, 72.02, 71.93, 72.15, 72.03, 71.56, 71.64, 71.7, 72.46, 72.73, 72.89, 73.2, 72.99, 72.8, 72.49, 72.82, 72.93, 72.96, 72.62, 72.77, 72.67, 72.44, 73.0, 73.19, 73.04, 73.24, 73.01, 73.03, 73.45, 73.07, 73.43, 73.78, 73.04, 73.25, 72.94, 72.99, 73.35, 72.94, 72.76, 72.81, 73.27, 73.79, 73.51, 73.64, 73.79, 73.55]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.750, Test loss: 2.097, Test accuracy: 20.86
Round   0, Global train loss: 1.750, Global test loss: 2.271, Global test accuracy: 16.31
Round   1, Train loss: 1.462, Test loss: 1.703, Test accuracy: 34.31
Round   1, Global train loss: 1.462, Global test loss: 2.010, Global test accuracy: 26.92
Round   2, Train loss: 1.443, Test loss: 1.591, Test accuracy: 37.11
Round   2, Global train loss: 1.443, Global test loss: 2.095, Global test accuracy: 22.57
Round   3, Train loss: 1.344, Test loss: 1.495, Test accuracy: 41.94
Round   3, Global train loss: 1.344, Global test loss: 1.949, Global test accuracy: 28.70
Round   4, Train loss: 1.248, Test loss: 1.386, Test accuracy: 46.43
Round   4, Global train loss: 1.248, Global test loss: 1.703, Global test accuracy: 38.61
Round   5, Train loss: 1.205, Test loss: 1.291, Test accuracy: 49.77
Round   5, Global train loss: 1.205, Global test loss: 1.730, Global test accuracy: 36.40
Round   6, Train loss: 1.230, Test loss: 1.246, Test accuracy: 52.08
Round   6, Global train loss: 1.230, Global test loss: 1.646, Global test accuracy: 42.77
Round   7, Train loss: 1.329, Test loss: 1.251, Test accuracy: 52.91
Round   7, Global train loss: 1.329, Global test loss: 1.722, Global test accuracy: 38.49
Round   8, Train loss: 1.139, Test loss: 1.233, Test accuracy: 54.29
Round   8, Global train loss: 1.139, Global test loss: 1.655, Global test accuracy: 42.49
Round   9, Train loss: 1.013, Test loss: 1.189, Test accuracy: 55.94
Round   9, Global train loss: 1.013, Global test loss: 1.702, Global test accuracy: 41.15
Round  10, Train loss: 1.093, Test loss: 1.116, Test accuracy: 58.47
Round  10, Global train loss: 1.093, Global test loss: 1.853, Global test accuracy: 43.78
Round  11, Train loss: 1.157, Test loss: 1.106, Test accuracy: 59.20
Round  11, Global train loss: 1.157, Global test loss: 1.520, Global test accuracy: 48.02
Round  12, Train loss: 1.060, Test loss: 1.085, Test accuracy: 60.12
Round  12, Global train loss: 1.060, Global test loss: 1.648, Global test accuracy: 42.58
Round  13, Train loss: 1.119, Test loss: 1.073, Test accuracy: 60.78
Round  13, Global train loss: 1.119, Global test loss: 1.544, Global test accuracy: 44.81
Round  14, Train loss: 1.053, Test loss: 1.061, Test accuracy: 61.47
Round  14, Global train loss: 1.053, Global test loss: 1.390, Global test accuracy: 51.35
Round  15, Train loss: 1.002, Test loss: 1.051, Test accuracy: 62.04
Round  15, Global train loss: 1.002, Global test loss: 1.472, Global test accuracy: 47.12
Round  16, Train loss: 0.969, Test loss: 1.044, Test accuracy: 62.17
Round  16, Global train loss: 0.969, Global test loss: 1.326, Global test accuracy: 52.56
Round  17, Train loss: 0.964, Test loss: 1.061, Test accuracy: 61.77
Round  17, Global train loss: 0.964, Global test loss: 1.534, Global test accuracy: 45.86
Round  18, Train loss: 0.850, Test loss: 1.058, Test accuracy: 62.36
Round  18, Global train loss: 0.850, Global test loss: 1.480, Global test accuracy: 47.68
Round  19, Train loss: 0.886, Test loss: 1.050, Test accuracy: 62.30
Round  19, Global train loss: 0.886, Global test loss: 1.508, Global test accuracy: 49.49
Round  20, Train loss: 0.996, Test loss: 1.052, Test accuracy: 62.17
Round  20, Global train loss: 0.996, Global test loss: 1.529, Global test accuracy: 45.95
Round  21, Train loss: 0.903, Test loss: 1.031, Test accuracy: 63.03
Round  21, Global train loss: 0.903, Global test loss: 1.431, Global test accuracy: 49.47
Round  22, Train loss: 0.740, Test loss: 1.037, Test accuracy: 62.87
Round  22, Global train loss: 0.740, Global test loss: 1.395, Global test accuracy: 52.10
Round  23, Train loss: 0.804, Test loss: 1.040, Test accuracy: 63.05
Round  23, Global train loss: 0.804, Global test loss: 1.709, Global test accuracy: 44.01
Round  24, Train loss: 0.962, Test loss: 0.995, Test accuracy: 64.89
Round  24, Global train loss: 0.962, Global test loss: 1.489, Global test accuracy: 47.42
Round  25, Train loss: 0.893, Test loss: 0.988, Test accuracy: 65.39
Round  25, Global train loss: 0.893, Global test loss: 1.355, Global test accuracy: 52.14
Round  26, Train loss: 0.766, Test loss: 0.998, Test accuracy: 65.36
Round  26, Global train loss: 0.766, Global test loss: 1.335, Global test accuracy: 54.04
Round  27, Train loss: 0.797, Test loss: 0.992, Test accuracy: 65.52
Round  27, Global train loss: 0.797, Global test loss: 1.340, Global test accuracy: 53.52
Round  28, Train loss: 0.740, Test loss: 0.991, Test accuracy: 65.76
Round  28, Global train loss: 0.740, Global test loss: 1.543, Global test accuracy: 49.71
Round  29, Train loss: 0.861, Test loss: 1.001, Test accuracy: 65.52
Round  29, Global train loss: 0.861, Global test loss: 1.412, Global test accuracy: 51.57
Round  30, Train loss: 0.867, Test loss: 1.013, Test accuracy: 65.45
Round  30, Global train loss: 0.867, Global test loss: 1.318, Global test accuracy: 54.77
Round  31, Train loss: 0.811, Test loss: 1.012, Test accuracy: 65.44
Round  31, Global train loss: 0.811, Global test loss: 1.467, Global test accuracy: 47.35
Round  32, Train loss: 0.692, Test loss: 1.022, Test accuracy: 65.95
Round  32, Global train loss: 0.692, Global test loss: 1.350, Global test accuracy: 54.08
Round  33, Train loss: 0.757, Test loss: 1.012, Test accuracy: 66.20
Round  33, Global train loss: 0.757, Global test loss: 1.278, Global test accuracy: 57.12
Round  34, Train loss: 0.780, Test loss: 0.982, Test accuracy: 66.61
Round  34, Global train loss: 0.780, Global test loss: 1.179, Global test accuracy: 58.71
Round  35, Train loss: 0.619, Test loss: 0.969, Test accuracy: 66.80
Round  35, Global train loss: 0.619, Global test loss: 1.279, Global test accuracy: 56.83
Round  36, Train loss: 0.675, Test loss: 0.991, Test accuracy: 66.38
Round  36, Global train loss: 0.675, Global test loss: 1.254, Global test accuracy: 56.98
Round  37, Train loss: 0.830, Test loss: 1.003, Test accuracy: 66.52
Round  37, Global train loss: 0.830, Global test loss: 1.175, Global test accuracy: 58.62
Round  38, Train loss: 0.716, Test loss: 0.995, Test accuracy: 66.52
Round  38, Global train loss: 0.716, Global test loss: 1.149, Global test accuracy: 61.36
Round  39, Train loss: 0.711, Test loss: 0.999, Test accuracy: 66.41
Round  39, Global train loss: 0.711, Global test loss: 1.323, Global test accuracy: 53.85
Round  40, Train loss: 0.728, Test loss: 0.983, Test accuracy: 67.16
Round  40, Global train loss: 0.728, Global test loss: 1.478, Global test accuracy: 51.28
Round  41, Train loss: 0.621, Test loss: 0.986, Test accuracy: 67.35
Round  41, Global train loss: 0.621, Global test loss: 1.317, Global test accuracy: 55.04
Round  42, Train loss: 0.659, Test loss: 0.996, Test accuracy: 67.80
Round  42, Global train loss: 0.659, Global test loss: 1.286, Global test accuracy: 57.38
Round  43, Train loss: 0.623, Test loss: 0.988, Test accuracy: 67.94
Round  43, Global train loss: 0.623, Global test loss: 1.476, Global test accuracy: 52.70
Round  44, Train loss: 0.571, Test loss: 0.985, Test accuracy: 67.54
Round  44, Global train loss: 0.571, Global test loss: 1.374, Global test accuracy: 58.36
Round  45, Train loss: 0.794, Test loss: 0.987, Test accuracy: 67.99
Round  45, Global train loss: 0.794, Global test loss: 1.313, Global test accuracy: 56.38
Round  46, Train loss: 0.628, Test loss: 0.991, Test accuracy: 67.89
Round  46, Global train loss: 0.628, Global test loss: 1.327, Global test accuracy: 58.21
Round  47, Train loss: 0.611, Test loss: 0.990, Test accuracy: 68.13
Round  47, Global train loss: 0.611, Global test loss: 1.228, Global test accuracy: 59.45
Round  48, Train loss: 0.662, Test loss: 1.031, Test accuracy: 67.34
Round  48, Global train loss: 0.662, Global test loss: 1.482, Global test accuracy: 54.14
Round  49, Train loss: 0.556, Test loss: 1.025, Test accuracy: 67.51
Round  49, Global train loss: 0.556, Global test loss: 1.236, Global test accuracy: 58.90
Round  50, Train loss: 0.533, Test loss: 1.032, Test accuracy: 67.52
Round  50, Global train loss: 0.533, Global test loss: 1.241, Global test accuracy: 59.39
Round  51, Train loss: 0.534, Test loss: 1.012, Test accuracy: 68.00
Round  51, Global train loss: 0.534, Global test loss: 1.200, Global test accuracy: 59.45
Round  52, Train loss: 0.733, Test loss: 0.999, Test accuracy: 68.42
Round  52, Global train loss: 0.733, Global test loss: 1.240, Global test accuracy: 58.33
Round  53, Train loss: 0.493, Test loss: 0.985, Test accuracy: 69.06
Round  53, Global train loss: 0.493, Global test loss: 1.511, Global test accuracy: 55.74
Round  54, Train loss: 0.645, Test loss: 0.989, Test accuracy: 68.82
Round  54, Global train loss: 0.645, Global test loss: 1.437, Global test accuracy: 54.67
Round  55, Train loss: 0.627, Test loss: 0.998, Test accuracy: 68.99
Round  55, Global train loss: 0.627, Global test loss: 1.239, Global test accuracy: 59.00
Round  56, Train loss: 0.554, Test loss: 1.033, Test accuracy: 68.24
Round  56, Global train loss: 0.554, Global test loss: 1.235, Global test accuracy: 60.02
Round  57, Train loss: 0.588, Test loss: 1.036, Test accuracy: 68.65
Round  57, Global train loss: 0.588, Global test loss: 1.321, Global test accuracy: 58.50
Round  58, Train loss: 0.640, Test loss: 1.021, Test accuracy: 68.59
Round  58, Global train loss: 0.640, Global test loss: 1.178, Global test accuracy: 60.60
Round  59, Train loss: 0.471, Test loss: 1.036, Test accuracy: 68.36
Round  59, Global train loss: 0.471, Global test loss: 1.573, Global test accuracy: 52.86
Round  60, Train loss: 0.573, Test loss: 1.052, Test accuracy: 68.44
Round  60, Global train loss: 0.573, Global test loss: 1.370, Global test accuracy: 57.58
Round  61, Train loss: 0.444, Test loss: 1.036, Test accuracy: 68.61
Round  61, Global train loss: 0.444, Global test loss: 1.279, Global test accuracy: 60.23
Round  62, Train loss: 0.575, Test loss: 1.040, Test accuracy: 68.57
Round  62, Global train loss: 0.575, Global test loss: 1.256, Global test accuracy: 59.54
Round  63, Train loss: 0.612, Test loss: 1.072, Test accuracy: 68.27
Round  63, Global train loss: 0.612, Global test loss: 1.413, Global test accuracy: 54.39
Round  64, Train loss: 0.451, Test loss: 1.093, Test accuracy: 68.23
Round  64, Global train loss: 0.451, Global test loss: 1.197, Global test accuracy: 61.31
Round  65, Train loss: 0.590, Test loss: 1.109, Test accuracy: 67.92
Round  65, Global train loss: 0.590, Global test loss: 1.433, Global test accuracy: 56.63
Round  66, Train loss: 0.702, Test loss: 1.115, Test accuracy: 68.13
Round  66, Global train loss: 0.702, Global test loss: 1.294, Global test accuracy: 57.24
Round  67, Train loss: 0.457, Test loss: 1.114, Test accuracy: 67.61
Round  67, Global train loss: 0.457, Global test loss: 1.160, Global test accuracy: 62.55
Round  68, Train loss: 0.480, Test loss: 1.086, Test accuracy: 68.24
Round  68, Global train loss: 0.480, Global test loss: 1.125, Global test accuracy: 62.52
Round  69, Train loss: 0.541, Test loss: 1.063, Test accuracy: 68.82
Round  69, Global train loss: 0.541, Global test loss: 1.438, Global test accuracy: 56.08
Round  70, Train loss: 0.348, Test loss: 1.065, Test accuracy: 68.77
Round  70, Global train loss: 0.348, Global test loss: 1.268, Global test accuracy: 61.62
Round  71, Train loss: 0.391, Test loss: 1.078, Test accuracy: 68.88
Round  71, Global train loss: 0.391, Global test loss: 1.304, Global test accuracy: 60.65
Round  72, Train loss: 0.466, Test loss: 1.089, Test accuracy: 68.50
Round  72, Global train loss: 0.466, Global test loss: 1.160, Global test accuracy: 62.22
Round  73, Train loss: 0.495, Test loss: 1.082, Test accuracy: 69.04
Round  73, Global train loss: 0.495, Global test loss: 1.187, Global test accuracy: 61.25
Round  74, Train loss: 0.545, Test loss: 1.106, Test accuracy: 68.13
Round  74, Global train loss: 0.545, Global test loss: 1.242, Global test accuracy: 60.50
Round  75, Train loss: 0.456, Test loss: 1.116, Test accuracy: 68.10
Round  75, Global train loss: 0.456, Global test loss: 1.234, Global test accuracy: 60.43
Round  76, Train loss: 0.442, Test loss: 1.134, Test accuracy: 67.86
Round  76, Global train loss: 0.442, Global test loss: 1.420, Global test accuracy: 57.86
Round  77, Train loss: 0.507, Test loss: 1.114, Test accuracy: 68.20
Round  77, Global train loss: 0.507, Global test loss: 1.272, Global test accuracy: 59.76
Round  78, Train loss: 0.438, Test loss: 1.108, Test accuracy: 68.51
Round  78, Global train loss: 0.438, Global test loss: 1.284, Global test accuracy: 60.72
Round  79, Train loss: 0.523, Test loss: 1.113, Test accuracy: 68.75
Round  79, Global train loss: 0.523, Global test loss: 1.284, Global test accuracy: 59.97
Round  80, Train loss: 0.517, Test loss: 1.120, Test accuracy: 68.81
Round  80, Global train loss: 0.517, Global test loss: 1.249, Global test accuracy: 60.10
Round  81, Train loss: 0.393, Test loss: 1.126, Test accuracy: 68.74
Round  81, Global train loss: 0.393, Global test loss: 1.691, Global test accuracy: 53.89
Round  82, Train loss: 0.327, Test loss: 1.127, Test accuracy: 68.92
Round  82, Global train loss: 0.327, Global test loss: 1.411, Global test accuracy: 60.26
Round  83, Train loss: 0.570, Test loss: 1.137, Test accuracy: 68.81
Round  83, Global train loss: 0.570, Global test loss: 1.254, Global test accuracy: 59.43
Round  84, Train loss: 0.535, Test loss: 1.150, Test accuracy: 68.82
Round  84, Global train loss: 0.535, Global test loss: 1.179, Global test accuracy: 61.80
Round  85, Train loss: 0.518, Test loss: 1.127, Test accuracy: 69.63
Round  85, Global train loss: 0.518, Global test loss: 1.414, Global test accuracy: 57.67
Round  86, Train loss: 0.451, Test loss: 1.154, Test accuracy: 68.82
Round  86, Global train loss: 0.451, Global test loss: 1.333, Global test accuracy: 59.13
Round  87, Train loss: 0.444, Test loss: 1.128, Test accuracy: 69.35
Round  87, Global train loss: 0.444, Global test loss: 1.347, Global test accuracy: 59.88
Round  88, Train loss: 0.544, Test loss: 1.100, Test accuracy: 69.95
Round  88, Global train loss: 0.544, Global test loss: 1.288, Global test accuracy: 59.92
Round  89, Train loss: 0.341, Test loss: 1.126, Test accuracy: 69.31
Round  89, Global train loss: 0.341, Global test loss: 1.543, Global test accuracy: 55.51
Round  90, Train loss: 0.327, Test loss: 1.123, Test accuracy: 69.45
Round  90, Global train loss: 0.327, Global test loss: 1.429, Global test accuracy: 60.06
Round  91, Train loss: 0.462, Test loss: 1.110, Test accuracy: 69.65
Round  91, Global train loss: 0.462, Global test loss: 1.302, Global test accuracy: 61.45
Round  92, Train loss: 0.397, Test loss: 1.131, Test accuracy: 69.00
Round  92, Global train loss: 0.397, Global test loss: 1.445, Global test accuracy: 58.81
Round  93, Train loss: 0.348, Test loss: 1.159, Test accuracy: 68.61
Round  93, Global train loss: 0.348, Global test loss: 1.326, Global test accuracy: 63.00
Round  94, Train loss: 0.369, Test loss: 1.157, Test accuracy: 69.05
Round  94, Global train loss: 0.369, Global test loss: 1.461, Global test accuracy: 57.95
Round  95, Train loss: 0.393, Test loss: 1.165, Test accuracy: 68.94
Round  95, Global train loss: 0.393, Global test loss: 1.351, Global test accuracy: 60.97
Round  96, Train loss: 0.451, Test loss: 1.161, Test accuracy: 68.77
Round  96, Global train loss: 0.451, Global test loss: 1.455, Global test accuracy: 57.97
Round  97, Train loss: 0.364, Test loss: 1.167, Test accuracy: 69.38
Round  97, Global train loss: 0.364, Global test loss: 1.448, Global test accuracy: 58.65
Round  98, Train loss: 0.326, Test loss: 1.167, Test accuracy: 69.13
Round  98, Global train loss: 0.326, Global test loss: 1.558, Global test accuracy: 59.16
Round  99, Train loss: 0.353, Test loss: 1.158, Test accuracy: 69.24
Round  99, Global train loss: 0.353, Global test loss: 1.430, Global test accuracy: 59.90
Final Round, Train loss: 0.326, Test loss: 1.354, Test accuracy: 68.04
Final Round, Global train loss: 0.326, Global test loss: 1.430, Global test accuracy: 59.90
Average accuracy final 10 rounds: 69.122
Average global accuracy final 10 rounds: 59.792
2398.883472919464
[1.2931888103485107, 2.281383514404297, 3.2683193683624268, 4.2484352588653564, 5.256147623062134, 6.23848557472229, 7.214456081390381, 8.177892923355103, 9.15023684501648, 10.158859729766846, 11.151530981063843, 12.111396312713623, 13.071583271026611, 14.1085786819458, 15.090634822845459, 16.06433367729187, 17.039196729660034, 18.01157784461975, 18.967536687850952, 19.940357208251953, 20.924355030059814, 23.031425714492798, 25.158617734909058, 27.24448013305664, 29.398569107055664, 31.520023822784424, 33.61308765411377, 35.70228099822998, 37.80041456222534, 39.89959502220154, 41.983909130096436, 44.07212567329407, 46.15934443473816, 48.27640914916992, 50.640684843063354, 52.88172435760498, 55.213212966918945, 57.4463791847229, 59.68697237968445, 61.935094356536865, 64.1586389541626, 66.36963367462158, 68.60958886146545, 70.91817474365234, 73.15900826454163, 76.15105843544006, 79.09612584114075, 82.04413390159607, 84.98172354698181, 87.92880082130432, 90.86907172203064, 93.80290818214417, 96.68886828422546, 99.72066617012024, 103.87734079360962, 108.19064974784851, 112.68686008453369, 117.14089155197144, 121.94231843948364, 126.61051273345947, 131.04986119270325, 135.61201167106628, 140.15663743019104, 144.75635433197021, 149.3950390815735, 153.96983432769775, 158.42347311973572, 163.42148113250732, 168.1807701587677, 173.09457278251648, 177.62557578086853, 182.31031703948975, 187.12539386749268, 191.7441427707672, 196.46628761291504, 201.16822242736816, 205.9553964138031, 210.97763800621033, 215.6588363647461, 220.11157703399658, 224.8762423992157, 229.41450691223145, 233.91065502166748, 238.11932921409607, 242.79386043548584, 247.56618237495422, 252.32264184951782, 256.74008679389954, 261.1646146774292, 265.9299201965332, 270.5731978416443, 275.38555002212524, 279.9735333919525, 284.8613193035126, 289.446711063385, 294.6269495487213, 299.26725673675537, 303.8106279373169, 308.42250323295593, 313.6405568122864, 316.3388407230377]
[20.86, 34.31, 37.11, 41.94, 46.43, 49.77, 52.08, 52.91, 54.29, 55.94, 58.47, 59.2, 60.12, 60.78, 61.47, 62.04, 62.17, 61.77, 62.36, 62.3, 62.17, 63.03, 62.87, 63.05, 64.89, 65.39, 65.36, 65.52, 65.76, 65.52, 65.45, 65.44, 65.95, 66.2, 66.61, 66.8, 66.38, 66.52, 66.52, 66.41, 67.16, 67.35, 67.8, 67.94, 67.54, 67.99, 67.89, 68.13, 67.34, 67.51, 67.52, 68.0, 68.42, 69.06, 68.82, 68.99, 68.24, 68.65, 68.59, 68.36, 68.44, 68.61, 68.57, 68.27, 68.23, 67.92, 68.13, 67.61, 68.24, 68.82, 68.77, 68.88, 68.5, 69.04, 68.13, 68.1, 67.86, 68.2, 68.51, 68.75, 68.81, 68.74, 68.92, 68.81, 68.82, 69.63, 68.82, 69.35, 69.95, 69.31, 69.45, 69.65, 69.0, 68.61, 69.05, 68.94, 68.77, 69.38, 69.13, 69.24, 68.04]
usage: main_fedpac_psl2.py [-h] [--epochs EPOCHS] [--num_users NUM_USERS]
                           [--shard_per_user SHARD_PER_USER] [--frac FRAC]
                           [--local_ep LOCAL_EP] [--local_bs LOCAL_BS]
                           [--bs BS] [--lr LR] [--momentum MOMENTUM]
                           [--split SPLIT] [--grad_norm] [--lr_decay LR_DECAY]
                           [--local_updates LOCAL_UPDATES] [--m_tr M_TR]
                           [--m_ft M_FT] [--model MODEL]
                           [--kernel_num KERNEL_NUM]
                           [--kernel_sizes KERNEL_SIZES] [--norm NORM]
                           [--num_filters NUM_FILTERS] [--max_pool MAX_POOL]
                           [--num_layers_keep NUM_LAYERS_KEEP] [--alg ALG]
                           [--local_rep_ep LOCAL_REP_EP] [--lr_g LR_G]
                           [--mu MU] [--gmf GMF] [--alpha_apfl ALPHA_APFL]
                           [--alpha_l2gd ALPHA_L2GD]
                           [--lambda_l2gd LAMBDA_L2GD] [--lr_in LR_IN]
                           [--bs_frac_in BS_FRAC_IN] [--lam_ditto LAM_DITTO]
                           [--dataset DATASET] [--iid]
                           [--num_classes NUM_CLASSES]
                           [--num_channels NUM_CHANNELS] [--gpu GPU]
                           [--seed SEED] [--test_freq TEST_FREQ]
                           [--load_fed LOAD_FED] [--results_save RESULTS_SAVE]
                           [--save_every SAVE_EVERY] [--pac_param PAC_PARAM]
                           [--is_concept_shift IS_CONCEPT_SHIFT]
                           [--concept_shift_rate CONCEPT_SHIFT_RATE]
                           [--local_only LOCAL_ONLY]
                           [--limit_local_output LIMIT_LOCAL_OUTPUT]
                           [--nums_per_class NUMS_PER_CLASS]
                           [--is_reset_dataset IS_RESET_DATASET]
                           [--is_reset_model IS_RESET_MODEL]
                           [--personal_learning_rate PERSONAL_LEARNING_RATE]
                           [--lamda LAMDA] [--learning_rate LEARNING_RATE]
                           [--print_all PRINT_ALL]
                           [--data_store_file DATA_STORE_FILE]
                           [--level_n_system LEVEL_N_SYSTEM]
                           [--level_n_lowerb LEVEL_N_LOWERB]
                           [--filter_alg FILTER_ALG] [--init_steps INIT_STEPS]
                           [--prov_steps PROV_STEPS] [--prov_users PROV_USERS]
                           [--psl_step PSL_STEP] [--frac2 FRAC2]
                           [--rounds2 ROUNDS2] [--T_pl T_PL]
                           [--lambda_cen LAMBDA_CEN] [--lambda_e LAMBDA_E]
                           [--num_gradual NUM_GRADUAL]
                           [--forget_rate FORGET_RATE]
                           [--schedule SCHEDULE [SCHEDULE ...]]
                           [--weight_decay WEIGHT_DECAY]
                           [--feature_dim FEATURE_DIM] [--save_dir SAVE_DIR]
main_fedpac_psl2.py: error: argument --psl_step: invalid int value: '2y'
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.563, Test loss: 1.345, Test accuracy: 45.81
Round   0, Global train loss: 1.563, Global test loss: 2.141, Global test accuracy: 24.81
Round   1, Train loss: 1.352, Test loss: 1.211, Test accuracy: 53.56
Round   1, Global train loss: 1.352, Global test loss: 1.870, Global test accuracy: 30.94
Round   2, Train loss: 1.227, Test loss: 1.167, Test accuracy: 55.56
Round   2, Global train loss: 1.227, Global test loss: 1.708, Global test accuracy: 38.11
Round   3, Train loss: 1.154, Test loss: 1.125, Test accuracy: 58.07
Round   3, Global train loss: 1.154, Global test loss: 1.602, Global test accuracy: 44.57
Round   4, Train loss: 1.100, Test loss: 1.134, Test accuracy: 58.20
Round   4, Global train loss: 1.100, Global test loss: 1.546, Global test accuracy: 46.90
Round   5, Train loss: 1.050, Test loss: 1.106, Test accuracy: 59.97
Round   5, Global train loss: 1.050, Global test loss: 1.480, Global test accuracy: 48.88
Round   6, Train loss: 1.004, Test loss: 1.099, Test accuracy: 60.18
Round   6, Global train loss: 1.004, Global test loss: 1.418, Global test accuracy: 50.92
Round   7, Train loss: 0.965, Test loss: 1.067, Test accuracy: 61.37
Round   7, Global train loss: 0.965, Global test loss: 1.365, Global test accuracy: 52.46
Round   8, Train loss: 0.924, Test loss: 1.087, Test accuracy: 61.83
Round   8, Global train loss: 0.924, Global test loss: 1.312, Global test accuracy: 54.50
Round   9, Train loss: 0.882, Test loss: 1.063, Test accuracy: 62.71
Round   9, Global train loss: 0.882, Global test loss: 1.278, Global test accuracy: 55.44
Round  10, Train loss: 0.772, Test loss: 1.081, Test accuracy: 62.09
Round  10, Global train loss: 0.772, Global test loss: 1.511, Global test accuracy: 52.03
Round  11, Train loss: 0.781, Test loss: 1.079, Test accuracy: 62.68
Round  11, Global train loss: 0.781, Global test loss: 1.303, Global test accuracy: 55.11
Round  12, Train loss: 0.723, Test loss: 1.077, Test accuracy: 62.62
Round  12, Global train loss: 0.723, Global test loss: 1.359, Global test accuracy: 51.01
Round  13, Train loss: 0.742, Test loss: 1.071, Test accuracy: 63.23
Round  13, Global train loss: 0.742, Global test loss: 1.344, Global test accuracy: 52.53
Round  14, Train loss: 0.749, Test loss: 1.085, Test accuracy: 63.23
Round  14, Global train loss: 0.749, Global test loss: 1.265, Global test accuracy: 56.28
Round  15, Train loss: 0.759, Test loss: 1.094, Test accuracy: 63.14
Round  15, Global train loss: 0.759, Global test loss: 1.396, Global test accuracy: 52.84
Round  16, Train loss: 0.772, Test loss: 1.081, Test accuracy: 63.91
Round  16, Global train loss: 0.772, Global test loss: 1.285, Global test accuracy: 56.26
Round  17, Train loss: 0.578, Test loss: 1.095, Test accuracy: 64.23
Round  17, Global train loss: 0.578, Global test loss: 1.358, Global test accuracy: 55.17
Round  18, Train loss: 0.660, Test loss: 1.131, Test accuracy: 64.11
Round  18, Global train loss: 0.660, Global test loss: 1.470, Global test accuracy: 53.69
Round  19, Train loss: 0.582, Test loss: 1.144, Test accuracy: 63.96
Round  19, Global train loss: 0.582, Global test loss: 1.517, Global test accuracy: 52.58
Round  20, Train loss: 0.576, Test loss: 1.135, Test accuracy: 64.49
Round  20, Global train loss: 0.576, Global test loss: 1.617, Global test accuracy: 49.67
Round  21, Train loss: 0.576, Test loss: 1.136, Test accuracy: 64.61
Round  21, Global train loss: 0.576, Global test loss: 1.407, Global test accuracy: 54.35
Round  22, Train loss: 0.584, Test loss: 1.150, Test accuracy: 64.18
Round  22, Global train loss: 0.584, Global test loss: 1.475, Global test accuracy: 53.56
Round  23, Train loss: 0.508, Test loss: 1.184, Test accuracy: 64.25
Round  23, Global train loss: 0.508, Global test loss: 1.794, Global test accuracy: 49.56
Round  24, Train loss: 0.605, Test loss: 1.196, Test accuracy: 64.69
Round  24, Global train loss: 0.605, Global test loss: 1.469, Global test accuracy: 54.24
Round  25, Train loss: 0.492, Test loss: 1.204, Test accuracy: 65.05
Round  25, Global train loss: 0.492, Global test loss: 1.408, Global test accuracy: 57.34
Round  26, Train loss: 0.454, Test loss: 1.211, Test accuracy: 65.33
Round  26, Global train loss: 0.454, Global test loss: 1.444, Global test accuracy: 56.02
Round  27, Train loss: 0.476, Test loss: 1.255, Test accuracy: 65.05
Round  27, Global train loss: 0.476, Global test loss: 1.558, Global test accuracy: 53.52
Round  28, Train loss: 0.461, Test loss: 1.230, Test accuracy: 65.39
Round  28, Global train loss: 0.461, Global test loss: 1.604, Global test accuracy: 53.45
Round  29, Train loss: 0.474, Test loss: 1.246, Test accuracy: 65.47
Round  29, Global train loss: 0.474, Global test loss: 1.551, Global test accuracy: 54.10
Round  30, Train loss: 0.489, Test loss: 1.289, Test accuracy: 64.90
Round  30, Global train loss: 0.489, Global test loss: 1.364, Global test accuracy: 57.71
Round  31, Train loss: 0.456, Test loss: 1.325, Test accuracy: 64.35
Round  31, Global train loss: 0.456, Global test loss: 1.672, Global test accuracy: 49.38
Round  32, Train loss: 0.485, Test loss: 1.324, Test accuracy: 64.45
Round  32, Global train loss: 0.485, Global test loss: 1.534, Global test accuracy: 55.21
Round  33, Train loss: 0.454, Test loss: 1.354, Test accuracy: 64.26
Round  33, Global train loss: 0.454, Global test loss: 1.609, Global test accuracy: 54.46
Round  34, Train loss: 0.461, Test loss: 1.350, Test accuracy: 64.40
Round  34, Global train loss: 0.461, Global test loss: 1.342, Global test accuracy: 58.38
Round  35, Train loss: 0.452, Test loss: 1.357, Test accuracy: 64.81
Round  35, Global train loss: 0.452, Global test loss: 1.466, Global test accuracy: 56.28
Round  36, Train loss: 0.369, Test loss: 1.381, Test accuracy: 64.85
Round  36, Global train loss: 0.369, Global test loss: 1.371, Global test accuracy: 58.40
Round  37, Train loss: 0.507, Test loss: 1.404, Test accuracy: 65.09
Round  37, Global train loss: 0.507, Global test loss: 1.454, Global test accuracy: 56.16
Round  38, Train loss: 0.460, Test loss: 1.356, Test accuracy: 65.67
Round  38, Global train loss: 0.460, Global test loss: 1.409, Global test accuracy: 57.56
Round  39, Train loss: 0.341, Test loss: 1.359, Test accuracy: 65.97
Round  39, Global train loss: 0.341, Global test loss: 1.639, Global test accuracy: 54.37
Round  40, Train loss: 0.353, Test loss: 1.366, Test accuracy: 66.42
Round  40, Global train loss: 0.353, Global test loss: 1.882, Global test accuracy: 53.50
Round  41, Train loss: 0.406, Test loss: 1.361, Test accuracy: 66.49
Round  41, Global train loss: 0.406, Global test loss: 1.647, Global test accuracy: 53.38
Round  42, Train loss: 0.476, Test loss: 1.348, Test accuracy: 66.51
Round  42, Global train loss: 0.476, Global test loss: 1.561, Global test accuracy: 56.41
Round  43, Train loss: 0.487, Test loss: 1.396, Test accuracy: 65.87
Round  43, Global train loss: 0.487, Global test loss: 1.696, Global test accuracy: 52.55
Round  44, Train loss: 0.471, Test loss: 1.383, Test accuracy: 66.34
Round  44, Global train loss: 0.471, Global test loss: 1.618, Global test accuracy: 54.93
Round  45, Train loss: 0.422, Test loss: 1.407, Test accuracy: 66.26
Round  45, Global train loss: 0.422, Global test loss: 1.485, Global test accuracy: 57.12
Round  46, Train loss: 0.417, Test loss: 1.408, Test accuracy: 66.37
Round  46, Global train loss: 0.417, Global test loss: 1.639, Global test accuracy: 55.55
Round  47, Train loss: 0.325, Test loss: 1.404, Test accuracy: 66.36
Round  47, Global train loss: 0.325, Global test loss: 1.449, Global test accuracy: 59.18
Round  48, Train loss: 0.320, Test loss: 1.369, Test accuracy: 67.31
Round  48, Global train loss: 0.320, Global test loss: 1.669, Global test accuracy: 57.90
Round  49, Train loss: 0.292, Test loss: 1.387, Test accuracy: 66.84
Round  49, Global train loss: 0.292, Global test loss: 1.424, Global test accuracy: 59.64
Round  50, Train loss: 0.332, Test loss: 1.366, Test accuracy: 67.47
Round  50, Global train loss: 0.332, Global test loss: 1.595, Global test accuracy: 57.56
Round  51, Train loss: 0.354, Test loss: 1.384, Test accuracy: 67.07
Round  51, Global train loss: 0.354, Global test loss: 1.499, Global test accuracy: 57.44
Round  52, Train loss: 0.339, Test loss: 1.357, Test accuracy: 67.25
Round  52, Global train loss: 0.339, Global test loss: 1.510, Global test accuracy: 57.51
Round  53, Train loss: 0.287, Test loss: 1.399, Test accuracy: 66.78
Round  53, Global train loss: 0.287, Global test loss: 1.730, Global test accuracy: 56.05
Round  54, Train loss: 0.440, Test loss: 1.440, Test accuracy: 66.40
Round  54, Global train loss: 0.440, Global test loss: 1.670, Global test accuracy: 55.05
Round  55, Train loss: 0.349, Test loss: 1.433, Test accuracy: 66.66
Round  55, Global train loss: 0.349, Global test loss: 1.511, Global test accuracy: 58.16
Round  56, Train loss: 0.319, Test loss: 1.434, Test accuracy: 66.80
Round  56, Global train loss: 0.319, Global test loss: 1.612, Global test accuracy: 57.07
Round  57, Train loss: 0.302, Test loss: 1.459, Test accuracy: 66.44
Round  57, Global train loss: 0.302, Global test loss: 1.579, Global test accuracy: 58.66
Round  58, Train loss: 0.343, Test loss: 1.508, Test accuracy: 65.65
Round  58, Global train loss: 0.343, Global test loss: 1.525, Global test accuracy: 58.46
Round  59, Train loss: 0.259, Test loss: 1.514, Test accuracy: 66.03
Round  59, Global train loss: 0.259, Global test loss: 1.763, Global test accuracy: 54.50
Round  60, Train loss: 0.298, Test loss: 1.528, Test accuracy: 66.09
Round  60, Global train loss: 0.298, Global test loss: 1.761, Global test accuracy: 56.29
Round  61, Train loss: 0.334, Test loss: 1.567, Test accuracy: 65.58
Round  61, Global train loss: 0.334, Global test loss: 1.626, Global test accuracy: 55.73
Round  62, Train loss: 0.242, Test loss: 1.554, Test accuracy: 66.06
Round  62, Global train loss: 0.242, Global test loss: 1.599, Global test accuracy: 59.75
Round  63, Train loss: 0.335, Test loss: 1.538, Test accuracy: 66.34
Round  63, Global train loss: 0.335, Global test loss: 1.779, Global test accuracy: 55.44
Round  64, Train loss: 0.322, Test loss: 1.555, Test accuracy: 66.37
Round  64, Global train loss: 0.322, Global test loss: 1.601, Global test accuracy: 57.71
Round  65, Train loss: 0.382, Test loss: 1.509, Test accuracy: 66.84
Round  65, Global train loss: 0.382, Global test loss: 1.752, Global test accuracy: 56.37
Round  66, Train loss: 0.271, Test loss: 1.511, Test accuracy: 66.61
Round  66, Global train loss: 0.271, Global test loss: 1.560, Global test accuracy: 59.01
Round  67, Train loss: 0.301, Test loss: 1.487, Test accuracy: 67.20
Round  67, Global train loss: 0.301, Global test loss: 1.603, Global test accuracy: 59.43
Round  68, Train loss: 0.293, Test loss: 1.472, Test accuracy: 67.70
Round  68, Global train loss: 0.293, Global test loss: 1.550, Global test accuracy: 58.47
Round  69, Train loss: 0.261, Test loss: 1.506, Test accuracy: 67.27
Round  69, Global train loss: 0.261, Global test loss: 1.931, Global test accuracy: 55.54
Round  70, Train loss: 0.245, Test loss: 1.487, Test accuracy: 67.43
Round  70, Global train loss: 0.245, Global test loss: 1.581, Global test accuracy: 59.45
Round  71, Train loss: 0.223, Test loss: 1.504, Test accuracy: 67.49
Round  71, Global train loss: 0.223, Global test loss: 1.732, Global test accuracy: 56.63
Round  72, Train loss: 0.297, Test loss: 1.520, Test accuracy: 67.53
Round  72, Global train loss: 0.297, Global test loss: 1.541, Global test accuracy: 59.01
Round  73, Train loss: 0.304, Test loss: 1.522, Test accuracy: 67.67
Round  73, Global train loss: 0.304, Global test loss: 1.763, Global test accuracy: 56.86
Round  74, Train loss: 0.266, Test loss: 1.523, Test accuracy: 67.41
Round  74, Global train loss: 0.266, Global test loss: 1.629, Global test accuracy: 58.79
Round  75, Train loss: 0.231, Test loss: 1.526, Test accuracy: 67.08
Round  75, Global train loss: 0.231, Global test loss: 1.805, Global test accuracy: 56.80
Round  76, Train loss: 0.236, Test loss: 1.546, Test accuracy: 67.22
Round  76, Global train loss: 0.236, Global test loss: 1.910, Global test accuracy: 56.51
Round  77, Train loss: 0.261, Test loss: 1.643, Test accuracy: 66.21
Round  77, Global train loss: 0.261, Global test loss: 1.890, Global test accuracy: 54.76
Round  78, Train loss: 0.227, Test loss: 1.626, Test accuracy: 66.55
Round  78, Global train loss: 0.227, Global test loss: 1.882, Global test accuracy: 55.92
Round  79, Train loss: 0.226, Test loss: 1.617, Test accuracy: 66.71
Round  79, Global train loss: 0.226, Global test loss: 1.533, Global test accuracy: 60.48
Round  80, Train loss: 0.196, Test loss: 1.569, Test accuracy: 67.21
Round  80, Global train loss: 0.196, Global test loss: 1.678, Global test accuracy: 59.60
Round  81, Train loss: 0.177, Test loss: 1.628, Test accuracy: 66.64
Round  81, Global train loss: 0.177, Global test loss: 1.776, Global test accuracy: 59.10
Round  82, Train loss: 0.174, Test loss: 1.589, Test accuracy: 67.55
Round  82, Global train loss: 0.174, Global test loss: 1.769, Global test accuracy: 59.75
Round  83, Train loss: 0.161, Test loss: 1.600, Test accuracy: 67.35
Round  83, Global train loss: 0.161, Global test loss: 1.782, Global test accuracy: 59.92
Round  84, Train loss: 0.172, Test loss: 1.621, Test accuracy: 67.21
Round  84, Global train loss: 0.172, Global test loss: 1.793, Global test accuracy: 60.01
Round  85, Train loss: 0.162, Test loss: 1.597, Test accuracy: 67.40
Round  85, Global train loss: 0.162, Global test loss: 1.779, Global test accuracy: 59.42
Round  86, Train loss: 0.152, Test loss: 1.592, Test accuracy: 67.77
Round  86, Global train loss: 0.152, Global test loss: 1.856, Global test accuracy: 59.24
Round  87, Train loss: 0.149, Test loss: 1.607, Test accuracy: 67.87
Round  87, Global train loss: 0.149, Global test loss: 1.890, Global test accuracy: 58.62
Round  88, Train loss: 0.141, Test loss: 1.680, Test accuracy: 66.92
Round  88, Global train loss: 0.141, Global test loss: 1.892, Global test accuracy: 59.38
Round  89, Train loss: 0.142, Test loss: 1.665, Test accuracy: 66.68
Round  89, Global train loss: 0.142, Global test loss: 1.894, Global test accuracy: 58.72
Round  90, Train loss: 0.275, Test loss: 1.726, Test accuracy: 66.65
Round  90, Global train loss: 0.275, Global test loss: 1.506, Global test accuracy: 61.60
Round  91, Train loss: 0.240, Test loss: 1.626, Test accuracy: 68.00
Round  91, Global train loss: 0.240, Global test loss: 1.492, Global test accuracy: 62.05
Round  92, Train loss: 0.241, Test loss: 1.636, Test accuracy: 67.75
Round  92, Global train loss: 0.241, Global test loss: 1.450, Global test accuracy: 62.59
Round  93, Train loss: 0.223, Test loss: 1.644, Test accuracy: 67.36
Round  93, Global train loss: 0.223, Global test loss: 1.472, Global test accuracy: 62.53
Round  94, Train loss: 0.219, Test loss: 1.653, Test accuracy: 67.33
Round  94, Global train loss: 0.219, Global test loss: 1.484, Global test accuracy: 62.46
Round  95, Train loss: 0.219, Test loss: 1.619, Test accuracy: 67.96
Round  95, Global train loss: 0.219, Global test loss: 1.494, Global test accuracy: 62.81
Round  96, Train loss: 0.216, Test loss: 1.636, Test accuracy: 68.04
Round  96, Global train loss: 0.216, Global test loss: 1.472, Global test accuracy: 62.90
Round  97, Train loss: 0.213, Test loss: 1.594, Test accuracy: 68.13
Round  97, Global train loss: 0.213, Global test loss: 1.464, Global test accuracy: 62.85
Round  98, Train loss: 0.208, Test loss: 1.646, Test accuracy: 67.41
Round  98, Global train loss: 0.208, Global test loss: 1.472, Global test accuracy: 62.77
Round  99, Train loss: 0.213, Test loss: 1.682, Test accuracy: 67.25
Round  99, Global train loss: 0.213, Global test loss: 1.478, Global test accuracy: 62.83
Final Round, Train loss: 0.159, Test loss: 1.836, Test accuracy: 67.05
Final Round, Global train loss: 0.159, Global test loss: 1.478, Global test accuracy: 62.83
Average accuracy final 10 rounds: 67.58800000000001
Average global accuracy final 10 rounds: 62.539
7238.170921802521
[2.891047477722168, 5.63594651222229, 8.341685771942139, 11.05606460571289, 13.803771018981934, 16.606449365615845, 19.46428608894348, 22.21685552597046, 24.9384024143219, 27.715290784835815, 30.4304780960083, 33.14793014526367, 35.81233811378479, 38.52026605606079, 41.3830132484436, 44.06438326835632, 46.758660554885864, 49.421268939971924, 52.03064298629761, 54.786972999572754, 57.50313210487366, 66.534339427948, 75.73070287704468, 85.29408073425293, 94.34045696258545, 103.48967337608337, 112.48188591003418, 121.57746767997742, 131.16168451309204, 140.32105565071106, 149.8286497592926, 158.87530732154846, 167.95146775245667, 177.85781741142273, 186.8210780620575, 196.01423907279968, 205.42912530899048, 214.4730486869812, 223.36383628845215, 232.73261523246765, 241.89851760864258, 251.42377352714539, 260.54017519950867, 269.9370551109314, 279.4563982486725, 288.6247224807739, 297.96360301971436, 307.2535891532898, 316.26717352867126, 325.17704939842224, 334.39712285995483, 343.67085695266724, 352.6389584541321, 361.80217814445496, 371.0201735496521, 379.9736747741699, 389.1290616989136, 398.2152373790741, 407.18137097358704, 417.10169291496277, 425.9439413547516, 435.08019757270813, 444.2583749294281, 453.110214471817, 462.5245192050934, 471.9262487888336, 481.44835591316223, 490.45635771751404, 499.54185938835144, 508.918359041214, 518.40891456604, 527.8365108966827, 537.2466080188751, 546.3543453216553, 555.8758382797241, 565.078946352005, 574.2010507583618, 583.6366400718689, 592.417396068573, 601.4839105606079, 610.5723671913147, 619.4957132339478, 628.5941734313965, 637.6987497806549, 647.0082414150238, 656.4914712905884, 666.0549857616425, 675.7081162929535, 684.9268386363983, 694.2790985107422, 703.577497959137, 713.2351584434509, 722.6483891010284, 731.9884130954742, 741.5342934131622, 750.7297313213348, 760.3459537029266, 769.6374309062958, 779.035361289978, 788.5239350795746, 793.806248664856]
[45.81, 53.56, 55.56, 58.07, 58.2, 59.97, 60.18, 61.37, 61.83, 62.71, 62.09, 62.68, 62.62, 63.23, 63.23, 63.14, 63.91, 64.23, 64.11, 63.96, 64.49, 64.61, 64.18, 64.25, 64.69, 65.05, 65.33, 65.05, 65.39, 65.47, 64.9, 64.35, 64.45, 64.26, 64.4, 64.81, 64.85, 65.09, 65.67, 65.97, 66.42, 66.49, 66.51, 65.87, 66.34, 66.26, 66.37, 66.36, 67.31, 66.84, 67.47, 67.07, 67.25, 66.78, 66.4, 66.66, 66.8, 66.44, 65.65, 66.03, 66.09, 65.58, 66.06, 66.34, 66.37, 66.84, 66.61, 67.2, 67.7, 67.27, 67.43, 67.49, 67.53, 67.67, 67.41, 67.08, 67.22, 66.21, 66.55, 66.71, 67.21, 66.64, 67.55, 67.35, 67.21, 67.4, 67.77, 67.87, 66.92, 66.68, 66.65, 68.0, 67.75, 67.36, 67.33, 67.96, 68.04, 68.13, 67.41, 67.25, 67.05]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.734, Test loss: 1.741, Test accuracy: 35.05
Round   1, Train loss: 1.407, Test loss: 1.303, Test accuracy: 43.59
Round   2, Train loss: 1.247, Test loss: 1.187, Test accuracy: 51.27
Round   3, Train loss: 1.153, Test loss: 1.073, Test accuracy: 56.38
Round   4, Train loss: 1.092, Test loss: 1.031, Test accuracy: 59.05
Round   5, Train loss: 1.047, Test loss: 0.999, Test accuracy: 60.91
Round   6, Train loss: 1.001, Test loss: 0.952, Test accuracy: 62.46
Round   7, Train loss: 0.969, Test loss: 0.949, Test accuracy: 62.82
Round   8, Train loss: 0.934, Test loss: 0.907, Test accuracy: 64.72
Round   9, Train loss: 0.907, Test loss: 0.893, Test accuracy: 65.63
Round  10, Train loss: 0.876, Test loss: 0.872, Test accuracy: 66.97
Round  11, Train loss: 0.851, Test loss: 0.858, Test accuracy: 67.43
Round  12, Train loss: 0.825, Test loss: 0.846, Test accuracy: 67.94
Round  13, Train loss: 0.801, Test loss: 0.840, Test accuracy: 69.06
Round  14, Train loss: 0.777, Test loss: 0.843, Test accuracy: 68.25
Round  15, Train loss: 0.756, Test loss: 0.797, Test accuracy: 70.44
Round  16, Train loss: 0.736, Test loss: 0.813, Test accuracy: 70.31
Round  17, Train loss: 0.713, Test loss: 0.802, Test accuracy: 70.66
Round  18, Train loss: 0.702, Test loss: 0.789, Test accuracy: 70.70
Round  19, Train loss: 0.678, Test loss: 0.788, Test accuracy: 70.88
Round  20, Train loss: 0.611, Test loss: 0.823, Test accuracy: 69.69
Round  21, Train loss: 0.606, Test loss: 0.807, Test accuracy: 70.41
Round  22, Train loss: 0.542, Test loss: 0.810, Test accuracy: 70.39
Round  23, Train loss: 0.590, Test loss: 0.810, Test accuracy: 70.78
Round  24, Train loss: 0.615, Test loss: 0.791, Test accuracy: 71.78
Round  25, Train loss: 0.589, Test loss: 0.809, Test accuracy: 71.93
Round  26, Train loss: 0.579, Test loss: 0.817, Test accuracy: 71.94
Round  27, Train loss: 0.649, Test loss: 0.827, Test accuracy: 71.57
Round  28, Train loss: 0.594, Test loss: 0.812, Test accuracy: 72.25
Round  29, Train loss: 0.569, Test loss: 0.808, Test accuracy: 72.09
Round  30, Train loss: 0.553, Test loss: 0.806, Test accuracy: 73.10
Round  31, Train loss: 0.553, Test loss: 0.825, Test accuracy: 72.57
Round  32, Train loss: 0.534, Test loss: 0.823, Test accuracy: 72.49
Round  33, Train loss: 0.506, Test loss: 0.809, Test accuracy: 72.71
Round  34, Train loss: 0.456, Test loss: 0.832, Test accuracy: 72.77
Round  35, Train loss: 0.564, Test loss: 0.825, Test accuracy: 72.63
Round  36, Train loss: 0.470, Test loss: 0.854, Test accuracy: 72.59
Round  37, Train loss: 0.521, Test loss: 0.847, Test accuracy: 72.51
Round  38, Train loss: 0.493, Test loss: 0.815, Test accuracy: 73.13
Round  39, Train loss: 0.462, Test loss: 0.834, Test accuracy: 73.04
Round  40, Train loss: 0.490, Test loss: 0.823, Test accuracy: 73.26
Round  41, Train loss: 0.425, Test loss: 0.840, Test accuracy: 73.07
Round  42, Train loss: 0.400, Test loss: 0.837, Test accuracy: 73.14
Round  43, Train loss: 0.482, Test loss: 0.843, Test accuracy: 73.20
Round  44, Train loss: 0.459, Test loss: 0.834, Test accuracy: 72.93
Round  45, Train loss: 0.408, Test loss: 0.851, Test accuracy: 73.15
Round  46, Train loss: 0.385, Test loss: 0.833, Test accuracy: 73.56
Round  47, Train loss: 0.480, Test loss: 0.858, Test accuracy: 73.55
Round  48, Train loss: 0.403, Test loss: 0.843, Test accuracy: 74.02
Round  49, Train loss: 0.426, Test loss: 0.852, Test accuracy: 74.00
Round  50, Train loss: 0.340, Test loss: 0.844, Test accuracy: 73.56
Round  51, Train loss: 0.321, Test loss: 0.883, Test accuracy: 73.80
Round  52, Train loss: 0.444, Test loss: 0.843, Test accuracy: 74.15
Round  53, Train loss: 0.350, Test loss: 0.861, Test accuracy: 74.19
Round  54, Train loss: 0.371, Test loss: 0.876, Test accuracy: 74.08
Round  55, Train loss: 0.421, Test loss: 0.886, Test accuracy: 73.79
Round  56, Train loss: 0.441, Test loss: 0.889, Test accuracy: 73.20
Round  57, Train loss: 0.337, Test loss: 0.882, Test accuracy: 73.41
Round  58, Train loss: 0.392, Test loss: 0.927, Test accuracy: 73.02
Round  59, Train loss: 0.339, Test loss: 0.953, Test accuracy: 72.59
Round  60, Train loss: 0.371, Test loss: 0.928, Test accuracy: 72.50
Round  61, Train loss: 0.315, Test loss: 0.897, Test accuracy: 73.49
Round  62, Train loss: 0.344, Test loss: 0.913, Test accuracy: 73.62
Round  63, Train loss: 0.375, Test loss: 0.947, Test accuracy: 73.44
Round  64, Train loss: 0.309, Test loss: 0.917, Test accuracy: 73.47
Round  65, Train loss: 0.333, Test loss: 0.957, Test accuracy: 73.40
Round  66, Train loss: 0.365, Test loss: 0.951, Test accuracy: 73.18
Round  67, Train loss: 0.286, Test loss: 0.931, Test accuracy: 72.55
Round  68, Train loss: 0.312, Test loss: 0.908, Test accuracy: 73.66
Round  69, Train loss: 0.284, Test loss: 0.911, Test accuracy: 73.77
Round  70, Train loss: 0.377, Test loss: 0.940, Test accuracy: 73.32
Round  71, Train loss: 0.312, Test loss: 0.948, Test accuracy: 73.59
Round  72, Train loss: 0.304, Test loss: 0.990, Test accuracy: 73.75
Round  73, Train loss: 0.353, Test loss: 0.998, Test accuracy: 73.49
Round  74, Train loss: 0.303, Test loss: 0.960, Test accuracy: 73.09
Round  75, Train loss: 0.280, Test loss: 0.987, Test accuracy: 73.30
Round  76, Train loss: 0.304, Test loss: 0.992, Test accuracy: 72.77
Round  77, Train loss: 0.283, Test loss: 1.005, Test accuracy: 73.34
Round  78, Train loss: 0.299, Test loss: 1.021, Test accuracy: 73.19
Round  79, Train loss: 0.284, Test loss: 1.011, Test accuracy: 73.19
Round  80, Train loss: 0.226, Test loss: 0.997, Test accuracy: 72.87
Round  81, Train loss: 0.205, Test loss: 1.002, Test accuracy: 72.86
Round  82, Train loss: 0.199, Test loss: 1.017, Test accuracy: 72.76
Round  83, Train loss: 0.194, Test loss: 1.003, Test accuracy: 73.04
Round  84, Train loss: 0.177, Test loss: 1.043, Test accuracy: 73.37
Round  85, Train loss: 0.169, Test loss: 1.056, Test accuracy: 73.27
Round  86, Train loss: 0.168, Test loss: 1.047, Test accuracy: 73.11
Round  87, Train loss: 0.161, Test loss: 1.071, Test accuracy: 72.65
Round  88, Train loss: 0.154, Test loss: 1.082, Test accuracy: 73.13
Round  89, Train loss: 0.152, Test loss: 1.071, Test accuracy: 72.83
Round  90, Train loss: 0.266, Test loss: 1.045, Test accuracy: 73.45
Round  91, Train loss: 0.252, Test loss: 1.023, Test accuracy: 73.43
Round  92, Train loss: 0.242, Test loss: 1.059, Test accuracy: 73.39
Round  93, Train loss: 0.245, Test loss: 1.063, Test accuracy: 73.00
Round  94, Train loss: 0.235, Test loss: 1.040, Test accuracy: 73.66
Round  95, Train loss: 0.237, Test loss: 1.053, Test accuracy: 73.95
Round  96, Train loss: 0.231, Test loss: 1.075, Test accuracy: 73.46
Round  97, Train loss: 0.219, Test loss: 1.084, Test accuracy: 73.43
Round  98, Train loss: 0.224, Test loss: 1.088, Test accuracy: 73.35
Round  99, Train loss: 0.219, Test loss: 1.059, Test accuracy: 73.84
Final Round, Train loss: 0.180, Test loss: 1.064, Test accuracy: 73.74
Average accuracy final 10 rounds: 73.496
4781.163627624512
[2.940141201019287, 5.545768737792969, 8.176616907119751, 10.877464771270752, 13.567306995391846, 16.201746702194214, 18.83381414413452, 21.481592893600464, 24.168481826782227, 26.821083307266235, 29.468692779541016, 32.22495889663696, 35.560335636138916, 38.35090780258179, 41.21894121170044, 43.95143699645996, 46.7092502117157, 49.50443124771118, 52.23477864265442, 55.12838888168335, 57.825271129608154, 63.95331001281738, 69.71243238449097, 75.64378690719604, 81.24024963378906, 87.03840017318726, 93.07322907447815, 98.9715371131897, 104.75591683387756, 110.98317098617554, 116.7510130405426, 122.60545754432678, 128.38220524787903, 134.08171725273132, 139.89648270606995, 145.6507704257965, 151.21653771400452, 156.9712119102478, 162.90373158454895, 168.7287356853485, 174.64045476913452, 180.55962300300598, 186.34112644195557, 192.09405279159546, 198.19203233718872, 204.2579848766327, 210.09808206558228, 215.64438462257385, 221.5645396709442, 227.43364000320435, 233.36924505233765, 239.12182712554932, 245.00669932365417, 250.70723748207092, 256.3579216003418, 262.06623578071594, 267.9004752635956, 273.9461281299591, 279.75442028045654, 285.4348647594452, 291.13571643829346, 296.99424839019775, 302.8598871231079, 308.6629288196564, 314.4834449291229, 320.1767430305481, 325.9829125404358, 332.05864453315735, 337.99205684661865, 343.9799859523773, 349.93766736984253, 355.83391189575195, 361.61299538612366, 367.71756291389465, 373.70749020576477, 379.4403233528137, 385.317587852478, 391.1331889629364, 396.93453645706177, 402.7978434562683, 408.63891339302063, 414.7757787704468, 420.53474140167236, 425.1978189945221, 430.12567114830017, 434.97691559791565, 439.7686290740967, 444.79545283317566, 449.53507685661316, 454.2197198867798, 458.9583716392517, 463.7800896167755, 468.56982421875, 473.5659923553467, 478.36531257629395, 483.0986337661743, 487.8683109283447, 492.9276313781738, 497.759574174881, 502.5373694896698, 507.35546493530273]
[35.05, 43.59, 51.27, 56.38, 59.05, 60.91, 62.46, 62.82, 64.72, 65.63, 66.97, 67.43, 67.94, 69.06, 68.25, 70.44, 70.31, 70.66, 70.7, 70.88, 69.69, 70.41, 70.39, 70.78, 71.78, 71.93, 71.94, 71.57, 72.25, 72.09, 73.1, 72.57, 72.49, 72.71, 72.77, 72.63, 72.59, 72.51, 73.13, 73.04, 73.26, 73.07, 73.14, 73.2, 72.93, 73.15, 73.56, 73.55, 74.02, 74.0, 73.56, 73.8, 74.15, 74.19, 74.08, 73.79, 73.2, 73.41, 73.02, 72.59, 72.5, 73.49, 73.62, 73.44, 73.47, 73.4, 73.18, 72.55, 73.66, 73.77, 73.32, 73.59, 73.75, 73.49, 73.09, 73.3, 72.77, 73.34, 73.19, 73.19, 72.87, 72.86, 72.76, 73.04, 73.37, 73.27, 73.11, 72.65, 73.13, 72.83, 73.45, 73.43, 73.39, 73.0, 73.66, 73.95, 73.46, 73.43, 73.35, 73.84, 73.74]
