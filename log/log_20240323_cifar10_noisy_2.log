nohup: ignoring input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.586, Test loss: 2.184, Test accuracy: 18.07
Round   0, Global train loss: 1.586, Global test loss: 2.418, Global test accuracy: 12.89
Round   1, Train loss: 1.436, Test loss: 1.922, Test accuracy: 27.52
Round   1, Global train loss: 1.436, Global test loss: 2.433, Global test accuracy: 14.55
Round   2, Train loss: 1.295, Test loss: 1.624, Test accuracy: 35.66
Round   2, Global train loss: 1.295, Global test loss: 2.505, Global test accuracy: 10.21
Round   3, Train loss: 1.147, Test loss: 1.501, Test accuracy: 39.60
Round   3, Global train loss: 1.147, Global test loss: 2.378, Global test accuracy: 15.15
Round   4, Train loss: 1.194, Test loss: 1.374, Test accuracy: 44.88
Round   4, Global train loss: 1.194, Global test loss: 2.373, Global test accuracy: 12.88
Round   5, Train loss: 1.205, Test loss: 1.313, Test accuracy: 47.98
Round   5, Global train loss: 1.205, Global test loss: 2.356, Global test accuracy: 13.29
Round   6, Train loss: 1.124, Test loss: 1.207, Test accuracy: 51.28
Round   6, Global train loss: 1.124, Global test loss: 2.403, Global test accuracy: 12.35
Round   7, Train loss: 1.145, Test loss: 1.216, Test accuracy: 51.60
Round   7, Global train loss: 1.145, Global test loss: 2.405, Global test accuracy: 12.81
Round   8, Train loss: 1.035, Test loss: 1.141, Test accuracy: 53.83
Round   8, Global train loss: 1.035, Global test loss: 2.396, Global test accuracy: 10.72
Round   9, Train loss: 1.058, Test loss: 1.117, Test accuracy: 55.12
Round   9, Global train loss: 1.058, Global test loss: 2.438, Global test accuracy: 14.27
Round  10, Train loss: 0.995, Test loss: 1.109, Test accuracy: 55.73
Round  10, Global train loss: 0.995, Global test loss: 2.523, Global test accuracy: 11.40
Round  11, Train loss: 0.965, Test loss: 1.106, Test accuracy: 55.95
Round  11, Global train loss: 0.965, Global test loss: 2.324, Global test accuracy: 13.24
Round  12, Train loss: 0.981, Test loss: 1.091, Test accuracy: 56.89
Round  12, Global train loss: 0.981, Global test loss: 2.380, Global test accuracy: 13.62
Round  13, Train loss: 0.919, Test loss: 1.057, Test accuracy: 58.15
Round  13, Global train loss: 0.919, Global test loss: 2.382, Global test accuracy: 12.47
Round  14, Train loss: 0.798, Test loss: 1.039, Test accuracy: 59.49
Round  14, Global train loss: 0.798, Global test loss: 2.424, Global test accuracy: 10.18
Round  15, Train loss: 0.949, Test loss: 1.044, Test accuracy: 59.20
Round  15, Global train loss: 0.949, Global test loss: 2.371, Global test accuracy: 14.28
Round  16, Train loss: 0.860, Test loss: 1.038, Test accuracy: 59.68
Round  16, Global train loss: 0.860, Global test loss: 2.393, Global test accuracy: 12.14
Round  17, Train loss: 0.766, Test loss: 1.052, Test accuracy: 59.58
Round  17, Global train loss: 0.766, Global test loss: 2.481, Global test accuracy: 10.82
Round  18, Train loss: 0.870, Test loss: 1.047, Test accuracy: 60.13
Round  18, Global train loss: 0.870, Global test loss: 2.419, Global test accuracy: 15.29
Round  19, Train loss: 0.798, Test loss: 1.075, Test accuracy: 59.95
Round  19, Global train loss: 0.798, Global test loss: 2.408, Global test accuracy: 12.97
Round  20, Train loss: 0.796, Test loss: 1.052, Test accuracy: 60.47
Round  20, Global train loss: 0.796, Global test loss: 2.297, Global test accuracy: 14.60
Round  21, Train loss: 0.748, Test loss: 1.048, Test accuracy: 61.05
Round  21, Global train loss: 0.748, Global test loss: 2.461, Global test accuracy: 13.69
Round  22, Train loss: 0.744, Test loss: 1.044, Test accuracy: 61.53
Round  22, Global train loss: 0.744, Global test loss: 2.472, Global test accuracy: 15.32
Round  23, Train loss: 0.774, Test loss: 1.040, Test accuracy: 62.14
Round  23, Global train loss: 0.774, Global test loss: 2.427, Global test accuracy: 13.00
Round  24, Train loss: 0.670, Test loss: 1.052, Test accuracy: 61.80
Round  24, Global train loss: 0.670, Global test loss: 2.471, Global test accuracy: 10.92
Round  25, Train loss: 0.755, Test loss: 1.063, Test accuracy: 61.92
Round  25, Global train loss: 0.755, Global test loss: 2.462, Global test accuracy: 11.87
Round  26, Train loss: 0.629, Test loss: 1.071, Test accuracy: 61.65
Round  26, Global train loss: 0.629, Global test loss: 2.384, Global test accuracy: 14.41
Round  27, Train loss: 0.542, Test loss: 1.087, Test accuracy: 61.66
Round  27, Global train loss: 0.542, Global test loss: 2.332, Global test accuracy: 12.82
Round  28, Train loss: 0.679, Test loss: 1.087, Test accuracy: 61.73
Round  28, Global train loss: 0.679, Global test loss: 2.435, Global test accuracy: 13.92
Round  29, Train loss: 0.652, Test loss: 1.102, Test accuracy: 61.51
Round  29, Global train loss: 0.652, Global test loss: 2.346, Global test accuracy: 13.77
Round  30, Train loss: 0.489, Test loss: 1.105, Test accuracy: 62.02
Round  30, Global train loss: 0.489, Global test loss: 2.440, Global test accuracy: 12.31
Round  31, Train loss: 0.494, Test loss: 1.116, Test accuracy: 62.03
Round  31, Global train loss: 0.494, Global test loss: 2.378, Global test accuracy: 14.21
Round  32, Train loss: 0.575, Test loss: 1.130, Test accuracy: 62.45
Round  32, Global train loss: 0.575, Global test loss: 2.437, Global test accuracy: 13.53
Round  33, Train loss: 0.501, Test loss: 1.153, Test accuracy: 62.53
Round  33, Global train loss: 0.501, Global test loss: 2.322, Global test accuracy: 13.89
Round  34, Train loss: 0.549, Test loss: 1.149, Test accuracy: 62.92
Round  34, Global train loss: 0.549, Global test loss: 2.383, Global test accuracy: 12.65
Round  35, Train loss: 0.465, Test loss: 1.159, Test accuracy: 63.20
Round  35, Global train loss: 0.465, Global test loss: 2.477, Global test accuracy: 12.14
Round  36, Train loss: 0.397, Test loss: 1.181, Test accuracy: 63.10
Round  36, Global train loss: 0.397, Global test loss: 2.608, Global test accuracy: 12.26
Round  37, Train loss: 0.516, Test loss: 1.157, Test accuracy: 63.57
Round  37, Global train loss: 0.516, Global test loss: 2.355, Global test accuracy: 14.52
Round  38, Train loss: 0.351, Test loss: 1.164, Test accuracy: 63.64
Round  38, Global train loss: 0.351, Global test loss: 2.387, Global test accuracy: 13.00
Round  39, Train loss: 0.557, Test loss: 1.179, Test accuracy: 63.83
Round  39, Global train loss: 0.557, Global test loss: 2.358, Global test accuracy: 14.61
Round  40, Train loss: 0.466, Test loss: 1.206, Test accuracy: 63.69
Round  40, Global train loss: 0.466, Global test loss: 2.371, Global test accuracy: 13.30
Round  41, Train loss: 0.371, Test loss: 1.243, Test accuracy: 63.44
Round  41, Global train loss: 0.371, Global test loss: 2.476, Global test accuracy: 11.93
Round  42, Train loss: 0.445, Test loss: 1.247, Test accuracy: 63.66
Round  42, Global train loss: 0.445, Global test loss: 2.328, Global test accuracy: 15.25
Round  43, Train loss: 0.411, Test loss: 1.255, Test accuracy: 63.72
Round  43, Global train loss: 0.411, Global test loss: 2.449, Global test accuracy: 10.64
Round  44, Train loss: 0.346, Test loss: 1.260, Test accuracy: 63.98
Round  44, Global train loss: 0.346, Global test loss: 2.385, Global test accuracy: 12.28
Round  45, Train loss: 0.453, Test loss: 1.269, Test accuracy: 63.97
Round  45, Global train loss: 0.453, Global test loss: 2.404, Global test accuracy: 13.45
Round  46, Train loss: 0.425, Test loss: 1.304, Test accuracy: 63.83
Round  46, Global train loss: 0.425, Global test loss: 2.348, Global test accuracy: 14.35
Round  47, Train loss: 0.390, Test loss: 1.302, Test accuracy: 64.20
Round  47, Global train loss: 0.390, Global test loss: 2.441, Global test accuracy: 13.71
Round  48, Train loss: 0.303, Test loss: 1.351, Test accuracy: 63.18
Round  48, Global train loss: 0.303, Global test loss: 2.530, Global test accuracy: 13.41
Round  49, Train loss: 0.265, Test loss: 1.375, Test accuracy: 63.46
Round  49, Global train loss: 0.265, Global test loss: 2.458, Global test accuracy: 12.90
Round  50, Train loss: 0.362, Test loss: 1.392, Test accuracy: 63.34
Round  50, Global train loss: 0.362, Global test loss: 2.309, Global test accuracy: 13.56
Round  51, Train loss: 0.301, Test loss: 1.399, Test accuracy: 63.30
Round  51, Global train loss: 0.301, Global test loss: 2.434, Global test accuracy: 13.09
Round  52, Train loss: 0.291, Test loss: 1.434, Test accuracy: 63.64
Round  52, Global train loss: 0.291, Global test loss: 2.382, Global test accuracy: 13.65
Round  53, Train loss: 0.323, Test loss: 1.447, Test accuracy: 63.71
Round  53, Global train loss: 0.323, Global test loss: 2.317, Global test accuracy: 12.44
Round  54, Train loss: 0.265, Test loss: 1.443, Test accuracy: 63.98
Round  54, Global train loss: 0.265, Global test loss: 2.616, Global test accuracy: 13.12
Round  55, Train loss: 0.267, Test loss: 1.433, Test accuracy: 64.22
Round  55, Global train loss: 0.267, Global test loss: 2.424, Global test accuracy: 14.00
Round  56, Train loss: 0.308, Test loss: 1.433, Test accuracy: 64.52
Round  56, Global train loss: 0.308, Global test loss: 2.435, Global test accuracy: 15.33
Round  57, Train loss: 0.190, Test loss: 1.457, Test accuracy: 64.32
Round  57, Global train loss: 0.190, Global test loss: 2.308, Global test accuracy: 13.91
Round  58, Train loss: 0.221, Test loss: 1.491, Test accuracy: 63.97
Round  58, Global train loss: 0.221, Global test loss: 2.324, Global test accuracy: 12.55
Round  59, Train loss: 0.313, Test loss: 1.526, Test accuracy: 63.58
Round  59, Global train loss: 0.313, Global test loss: 2.387, Global test accuracy: 13.61
Round  60, Train loss: 0.246, Test loss: 1.532, Test accuracy: 63.70
Round  60, Global train loss: 0.246, Global test loss: 2.476, Global test accuracy: 13.85
Round  61, Train loss: 0.271, Test loss: 1.532, Test accuracy: 63.56
Round  61, Global train loss: 0.271, Global test loss: 2.329, Global test accuracy: 13.67
Round  62, Train loss: 0.258, Test loss: 1.549, Test accuracy: 63.53
Round  62, Global train loss: 0.258, Global test loss: 2.382, Global test accuracy: 13.43
Round  63, Train loss: 0.255, Test loss: 1.584, Test accuracy: 63.69
Round  63, Global train loss: 0.255, Global test loss: 2.448, Global test accuracy: 13.35
Round  64, Train loss: 0.204, Test loss: 1.638, Test accuracy: 63.71
Round  64, Global train loss: 0.204, Global test loss: 2.351, Global test accuracy: 13.42
Round  65, Train loss: 0.205, Test loss: 1.631, Test accuracy: 63.95
Round  65, Global train loss: 0.205, Global test loss: 2.366, Global test accuracy: 15.74
Round  66, Train loss: 0.225, Test loss: 1.650, Test accuracy: 64.19
Round  66, Global train loss: 0.225, Global test loss: 2.441, Global test accuracy: 13.85
Round  67, Train loss: 0.244, Test loss: 1.688, Test accuracy: 63.61
Round  67, Global train loss: 0.244, Global test loss: 2.326, Global test accuracy: 13.03
Round  68, Train loss: 0.181, Test loss: 1.678, Test accuracy: 64.27
Round  68, Global train loss: 0.181, Global test loss: 2.378, Global test accuracy: 14.00
Round  69, Train loss: 0.194, Test loss: 1.699, Test accuracy: 63.89
Round  69, Global train loss: 0.194, Global test loss: 2.473, Global test accuracy: 14.47
Round  70, Train loss: 0.162, Test loss: 1.759, Test accuracy: 63.95
Round  70, Global train loss: 0.162, Global test loss: 2.422, Global test accuracy: 14.39
Round  71, Train loss: 0.214, Test loss: 1.738, Test accuracy: 63.99
Round  71, Global train loss: 0.214, Global test loss: 2.385, Global test accuracy: 12.23
Round  72, Train loss: 0.201, Test loss: 1.745, Test accuracy: 64.16
Round  72, Global train loss: 0.201, Global test loss: 2.641, Global test accuracy: 14.43
Round  73, Train loss: 0.133, Test loss: 1.729, Test accuracy: 64.34
Round  73, Global train loss: 0.133, Global test loss: 2.381, Global test accuracy: 12.04
Round  74, Train loss: 0.186, Test loss: 1.746, Test accuracy: 64.46
Round  74, Global train loss: 0.186, Global test loss: 2.456, Global test accuracy: 14.15
Round  75, Train loss: 0.185, Test loss: 1.784, Test accuracy: 64.22
Round  75, Global train loss: 0.185, Global test loss: 2.485, Global test accuracy: 13.69
Round  76, Train loss: 0.153, Test loss: 1.804, Test accuracy: 64.52
Round  76, Global train loss: 0.153, Global test loss: 2.453, Global test accuracy: 14.77
Round  77, Train loss: 0.151, Test loss: 1.841, Test accuracy: 64.47
Round  77, Global train loss: 0.151, Global test loss: 2.384, Global test accuracy: 13.86
Round  78, Train loss: 0.156, Test loss: 1.851, Test accuracy: 64.11
Round  78, Global train loss: 0.156, Global test loss: 2.431, Global test accuracy: 14.30
Round  79, Train loss: 0.159, Test loss: 1.841, Test accuracy: 64.35
Round  79, Global train loss: 0.159, Global test loss: 2.561, Global test accuracy: 12.90
Round  80, Train loss: 0.133, Test loss: 1.911, Test accuracy: 64.16
Round  80, Global train loss: 0.133, Global test loss: 2.331, Global test accuracy: 13.80
Round  81, Train loss: 0.149, Test loss: 1.851, Test accuracy: 64.81
Round  81, Global train loss: 0.149, Global test loss: 2.414, Global test accuracy: 14.53
Round  82, Train loss: 0.150, Test loss: 1.862, Test accuracy: 64.73
Round  82, Global train loss: 0.150, Global test loss: 2.370, Global test accuracy: 15.28
Round  83, Train loss: 0.160, Test loss: 1.910, Test accuracy: 64.77
Round  83, Global train loss: 0.160, Global test loss: 2.394, Global test accuracy: 14.98
Round  84, Train loss: 0.106, Test loss: 1.945, Test accuracy: 64.67
Round  84, Global train loss: 0.106, Global test loss: 2.508, Global test accuracy: 12.14
Round  85, Train loss: 0.130, Test loss: 1.925, Test accuracy: 64.07
Round  85, Global train loss: 0.130, Global test loss: 2.344, Global test accuracy: 12.44
Round  86, Train loss: 0.104, Test loss: 1.949, Test accuracy: 64.00
Round  86, Global train loss: 0.104, Global test loss: 2.403, Global test accuracy: 13.53
Round  87, Train loss: 0.117, Test loss: 1.958, Test accuracy: 63.94
Round  87, Global train loss: 0.117, Global test loss: 2.405, Global test accuracy: 13.40
Round  88, Train loss: 0.125, Test loss: 1.959, Test accuracy: 63.72
Round  88, Global train loss: 0.125, Global test loss: 2.348, Global test accuracy: 14.32
Round  89, Train loss: 0.104, Test loss: 1.975, Test accuracy: 64.01
Round  89, Global train loss: 0.104, Global test loss: 2.545, Global test accuracy: 14.90
Round  90, Train loss: 0.125, Test loss: 1.970, Test accuracy: 64.14
Round  90, Global train loss: 0.125, Global test loss: 2.689, Global test accuracy: 11.77
Round  91, Train loss: 0.105, Test loss: 1.979, Test accuracy: 64.40
Round  91, Global train loss: 0.105, Global test loss: 2.309, Global test accuracy: 13.97
Round  92, Train loss: 0.106, Test loss: 1.978, Test accuracy: 64.34
Round  92, Global train loss: 0.106, Global test loss: 2.420, Global test accuracy: 12.71
Round  93, Train loss: 0.084, Test loss: 1.981, Test accuracy: 64.40
Round  93, Global train loss: 0.084, Global test loss: 2.648, Global test accuracy: 12.95
Round  94, Train loss: 0.115, Test loss: 1.993, Test accuracy: 64.49
Round  94, Global train loss: 0.115, Global test loss: 2.342, Global test accuracy: 14.27
Round  95, Train loss: 0.090, Test loss: 2.013, Test accuracy: 64.58
Round  95, Global train loss: 0.090, Global test loss: 2.415, Global test accuracy: 14.72
Round  96, Train loss: 0.098, Test loss: 2.018, Test accuracy: 64.33
Round  96, Global train loss: 0.098, Global test loss: 2.520, Global test accuracy: 11.82
Round  97, Train loss: 0.089, Test loss: 2.045, Test accuracy: 64.49
Round  97, Global train loss: 0.089, Global test loss: 2.443, Global test accuracy: 11.83
Round  98, Train loss: 0.090, Test loss: 2.100, Test accuracy: 64.47
Round  98, Global train loss: 0.090, Global test loss: 2.448, Global test accuracy: 13.48
Round  99, Train loss: 0.116, Test loss: 2.102, Test accuracy: 64.59
Round  99, Global train loss: 0.116, Global test loss: 2.346, Global test accuracy: 12.72
Final Round, Train loss: 0.096, Test loss: 2.150, Test accuracy: 64.18
Final Round, Global train loss: 0.096, Global test loss: 2.346, Global test accuracy: 12.72
Average accuracy final 10 rounds: 64.423 

Average global accuracy final 10 rounds: 13.024000000000001 

1856.7641623020172
[2.0951664447784424, 4.190332889556885, 5.720024108886719, 7.249715328216553, 8.845559358596802, 10.44140338897705, 12.271188259124756, 14.100973129272461, 15.70213770866394, 17.30330228805542, 18.881788730621338, 20.460275173187256, 22.1254665851593, 23.790657997131348, 25.46787714958191, 27.14509630203247, 28.90327215194702, 30.661448001861572, 32.28165340423584, 33.90185880661011, 35.538259744644165, 37.17466068267822, 38.841352224349976, 40.50804376602173, 42.18606615066528, 43.86408853530884, 45.594167709350586, 47.324246883392334, 48.89920163154602, 50.47415637969971, 51.92142653465271, 53.36869668960571, 55.02439546585083, 56.68009424209595, 58.190736055374146, 59.701377868652344, 61.61389708518982, 63.526416301727295, 65.1046690940857, 66.68292188644409, 68.34011912345886, 69.99731636047363, 71.50351452827454, 73.00971269607544, 74.64541888237, 76.28112506866455, 77.94618511199951, 79.61124515533447, 81.24476742744446, 82.87828969955444, 84.35966515541077, 85.84104061126709, 87.42709827423096, 89.01315593719482, 90.56937384605408, 92.12559175491333, 93.57473921775818, 95.02388668060303, 96.87588787078857, 98.72788906097412, 100.22726607322693, 101.72664308547974, 103.63601851463318, 105.54539394378662, 107.24922680854797, 108.95305967330933, 110.4673023223877, 111.98154497146606, 113.65255761146545, 115.32357025146484, 116.88285756111145, 118.44214487075806, 119.99059247970581, 121.53904008865356, 123.28748679161072, 125.03593349456787, 126.79883790016174, 128.56174230575562, 130.28078436851501, 131.9998264312744, 133.60291385650635, 135.20600128173828, 137.026695728302, 138.84739017486572, 140.4894895553589, 142.13158893585205, 144.01297736167908, 145.8943657875061, 147.46561551094055, 149.036865234375, 150.53220081329346, 152.0275363922119, 153.59078907966614, 155.15404176712036, 156.74660873413086, 158.33917570114136, 159.83998227119446, 161.34078884124756, 162.8385238647461, 164.33625888824463, 165.86314392089844, 167.39002895355225, 168.9271273612976, 170.46422576904297, 172.23024129867554, 173.9962568283081, 175.54946064949036, 177.1026644706726, 178.6053421497345, 180.1080198287964, 181.56942009925842, 183.03082036972046, 184.56333708763123, 186.095853805542, 187.65840935707092, 189.22096490859985, 190.83700227737427, 192.45303964614868, 194.2060468196869, 195.9590539932251, 197.42351031303406, 198.88796663284302, 200.48857426643372, 202.0891819000244, 203.73104739189148, 205.37291288375854, 207.17447328567505, 208.97603368759155, 210.71775770187378, 212.459481716156, 214.02049493789673, 215.58150815963745, 217.18256950378418, 218.7836308479309, 220.20663380622864, 221.62963676452637, 223.1841950416565, 224.73875331878662, 226.3443067073822, 227.94986009597778, 229.52874898910522, 231.10763788223267, 232.77837586402893, 234.4491138458252, 235.9511079788208, 237.4531021118164, 239.05121278762817, 240.64932346343994, 242.18229484558105, 243.71526622772217, 245.4046733379364, 247.09408044815063, 248.78472638130188, 250.47537231445312, 252.10723161697388, 253.73909091949463, 255.23723554611206, 256.7353801727295, 258.36040925979614, 259.9854383468628, 261.7269687652588, 263.4684991836548, 265.36034774780273, 267.2521963119507, 268.74295711517334, 270.233717918396, 272.12035751342773, 274.0069971084595, 275.8045618534088, 277.60212659835815, 279.3407533168793, 281.0793800354004, 282.5448679924011, 284.01035594940186, 285.5803425312042, 287.1503291130066, 288.72282910346985, 290.2953290939331, 291.95928621292114, 293.6232433319092, 295.3583517074585, 297.0934600830078, 298.76078820228577, 300.4281163215637, 302.08215165138245, 303.7361869812012, 305.50864934921265, 307.2811117172241, 308.8156816959381, 310.3502516746521, 311.97121572494507, 313.59217977523804, 315.32850551605225, 317.06483125686646, 318.72386956214905, 320.38290786743164, 321.93617010116577, 323.4894323348999, 325.02867221832275, 326.5679121017456, 329.71825671195984, 332.8686013221741]
[18.07, 18.07, 27.52, 27.52, 35.66, 35.66, 39.6, 39.6, 44.88, 44.88, 47.98, 47.98, 51.28, 51.28, 51.6, 51.6, 53.83, 53.83, 55.12, 55.12, 55.73, 55.73, 55.95, 55.95, 56.89, 56.89, 58.15, 58.15, 59.49, 59.49, 59.2, 59.2, 59.68, 59.68, 59.58, 59.58, 60.13, 60.13, 59.95, 59.95, 60.47, 60.47, 61.05, 61.05, 61.53, 61.53, 62.14, 62.14, 61.8, 61.8, 61.92, 61.92, 61.65, 61.65, 61.66, 61.66, 61.73, 61.73, 61.51, 61.51, 62.02, 62.02, 62.03, 62.03, 62.45, 62.45, 62.53, 62.53, 62.92, 62.92, 63.2, 63.2, 63.1, 63.1, 63.57, 63.57, 63.64, 63.64, 63.83, 63.83, 63.69, 63.69, 63.44, 63.44, 63.66, 63.66, 63.72, 63.72, 63.98, 63.98, 63.97, 63.97, 63.83, 63.83, 64.2, 64.2, 63.18, 63.18, 63.46, 63.46, 63.34, 63.34, 63.3, 63.3, 63.64, 63.64, 63.71, 63.71, 63.98, 63.98, 64.22, 64.22, 64.52, 64.52, 64.32, 64.32, 63.97, 63.97, 63.58, 63.58, 63.7, 63.7, 63.56, 63.56, 63.53, 63.53, 63.69, 63.69, 63.71, 63.71, 63.95, 63.95, 64.19, 64.19, 63.61, 63.61, 64.27, 64.27, 63.89, 63.89, 63.95, 63.95, 63.99, 63.99, 64.16, 64.16, 64.34, 64.34, 64.46, 64.46, 64.22, 64.22, 64.52, 64.52, 64.47, 64.47, 64.11, 64.11, 64.35, 64.35, 64.16, 64.16, 64.81, 64.81, 64.73, 64.73, 64.77, 64.77, 64.67, 64.67, 64.07, 64.07, 64.0, 64.0, 63.94, 63.94, 63.72, 63.72, 64.01, 64.01, 64.14, 64.14, 64.4, 64.4, 64.34, 64.34, 64.4, 64.4, 64.49, 64.49, 64.58, 64.58, 64.33, 64.33, 64.49, 64.49, 64.47, 64.47, 64.59, 64.59, 64.18, 64.18]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.595, Test loss: 2.031, Test accuracy: 22.71
Round   0, Global train loss: 1.595, Global test loss: 2.283, Global test accuracy: 16.44
Round   1, Train loss: 1.438, Test loss: 1.894, Test accuracy: 29.45
Round   1, Global train loss: 1.438, Global test loss: 2.431, Global test accuracy: 16.68
Round   2, Train loss: 1.342, Test loss: 1.699, Test accuracy: 35.03
Round   2, Global train loss: 1.342, Global test loss: 2.387, Global test accuracy: 15.64
Round   3, Train loss: 1.329, Test loss: 1.381, Test accuracy: 43.73
Round   3, Global train loss: 1.329, Global test loss: 2.333, Global test accuracy: 16.03
Round   4, Train loss: 1.224, Test loss: 1.306, Test accuracy: 48.00
Round   4, Global train loss: 1.224, Global test loss: 2.614, Global test accuracy: 14.52
Round   5, Train loss: 1.176, Test loss: 1.188, Test accuracy: 50.87
Round   5, Global train loss: 1.176, Global test loss: 2.635, Global test accuracy: 15.14
Round   6, Train loss: 1.163, Test loss: 1.146, Test accuracy: 52.62
Round   6, Global train loss: 1.163, Global test loss: 2.367, Global test accuracy: 15.63
Round   7, Train loss: 1.093, Test loss: 1.134, Test accuracy: 53.89
Round   7, Global train loss: 1.093, Global test loss: 2.508, Global test accuracy: 15.76
Round   8, Train loss: 1.135, Test loss: 1.123, Test accuracy: 54.39
Round   8, Global train loss: 1.135, Global test loss: 2.455, Global test accuracy: 12.83
Round   9, Train loss: 1.062, Test loss: 1.099, Test accuracy: 55.55
Round   9, Global train loss: 1.062, Global test loss: 2.533, Global test accuracy: 13.84
Round  10, Train loss: 1.066, Test loss: 1.061, Test accuracy: 57.43
Round  10, Global train loss: 1.066, Global test loss: 2.513, Global test accuracy: 18.20
Round  11, Train loss: 1.064, Test loss: 1.045, Test accuracy: 58.90
Round  11, Global train loss: 1.064, Global test loss: 2.511, Global test accuracy: 15.66
Round  12, Train loss: 1.064, Test loss: 1.024, Test accuracy: 59.57
Round  12, Global train loss: 1.064, Global test loss: 2.351, Global test accuracy: 18.62
Round  13, Train loss: 0.986, Test loss: 1.023, Test accuracy: 60.00
Round  13, Global train loss: 0.986, Global test loss: 2.438, Global test accuracy: 18.83
Round  14, Train loss: 1.064, Test loss: 0.996, Test accuracy: 61.60
Round  14, Global train loss: 1.064, Global test loss: 2.605, Global test accuracy: 17.49
Round  15, Train loss: 1.019, Test loss: 0.993, Test accuracy: 61.63
Round  15, Global train loss: 1.019, Global test loss: 2.583, Global test accuracy: 17.28
Round  16, Train loss: 0.958, Test loss: 0.985, Test accuracy: 61.97
Round  16, Global train loss: 0.958, Global test loss: 2.378, Global test accuracy: 18.37
Round  17, Train loss: 0.983, Test loss: 0.978, Test accuracy: 62.26
Round  17, Global train loss: 0.983, Global test loss: 2.491, Global test accuracy: 18.09
Round  18, Train loss: 0.915, Test loss: 0.957, Test accuracy: 62.82
Round  18, Global train loss: 0.915, Global test loss: 2.658, Global test accuracy: 17.80
Round  19, Train loss: 0.916, Test loss: 0.954, Test accuracy: 63.20
Round  19, Global train loss: 0.916, Global test loss: 2.586, Global test accuracy: 16.70
Round  20, Train loss: 0.819, Test loss: 0.946, Test accuracy: 63.70
Round  20, Global train loss: 0.819, Global test loss: 2.702, Global test accuracy: 18.15
Round  21, Train loss: 0.899, Test loss: 0.945, Test accuracy: 64.06
Round  21, Global train loss: 0.899, Global test loss: 2.552, Global test accuracy: 15.92
Round  22, Train loss: 0.861, Test loss: 0.975, Test accuracy: 63.26
Round  22, Global train loss: 0.861, Global test loss: 2.445, Global test accuracy: 17.78
Round  23, Train loss: 0.809, Test loss: 0.962, Test accuracy: 63.65
Round  23, Global train loss: 0.809, Global test loss: 2.721, Global test accuracy: 18.04
Round  24, Train loss: 0.791, Test loss: 0.948, Test accuracy: 64.33
Round  24, Global train loss: 0.791, Global test loss: 2.642, Global test accuracy: 17.24
Round  25, Train loss: 0.796, Test loss: 0.939, Test accuracy: 65.18
Round  25, Global train loss: 0.796, Global test loss: 2.700, Global test accuracy: 18.14
Round  26, Train loss: 0.855, Test loss: 0.932, Test accuracy: 65.43
Round  26, Global train loss: 0.855, Global test loss: 2.869, Global test accuracy: 17.05
Round  27, Train loss: 0.808, Test loss: 0.919, Test accuracy: 65.74
Round  27, Global train loss: 0.808, Global test loss: 2.576, Global test accuracy: 17.01
Round  28, Train loss: 0.807, Test loss: 0.922, Test accuracy: 65.77
Round  28, Global train loss: 0.807, Global test loss: 2.586, Global test accuracy: 16.09
Round  29, Train loss: 0.811, Test loss: 0.918, Test accuracy: 66.16
Round  29, Global train loss: 0.811, Global test loss: 2.627, Global test accuracy: 18.54
Round  30, Train loss: 0.763, Test loss: 0.909, Test accuracy: 66.65
Round  30, Global train loss: 0.763, Global test loss: 2.672, Global test accuracy: 18.27
Round  31, Train loss: 0.680, Test loss: 0.915, Test accuracy: 66.48
Round  31, Global train loss: 0.680, Global test loss: 2.613, Global test accuracy: 18.80
Round  32, Train loss: 0.809, Test loss: 0.908, Test accuracy: 66.98
Round  32, Global train loss: 0.809, Global test loss: 2.692, Global test accuracy: 17.03
Round  33, Train loss: 0.713, Test loss: 0.904, Test accuracy: 66.75
Round  33, Global train loss: 0.713, Global test loss: 2.676, Global test accuracy: 16.49
Round  34, Train loss: 0.813, Test loss: 0.897, Test accuracy: 67.47
Round  34, Global train loss: 0.813, Global test loss: 2.594, Global test accuracy: 17.98
Round  35, Train loss: 0.722, Test loss: 0.898, Test accuracy: 67.38
Round  35, Global train loss: 0.722, Global test loss: 2.570, Global test accuracy: 18.10
Round  36, Train loss: 0.716, Test loss: 0.887, Test accuracy: 67.84
Round  36, Global train loss: 0.716, Global test loss: 2.530, Global test accuracy: 17.69
Round  37, Train loss: 0.721, Test loss: 0.921, Test accuracy: 67.04
Round  37, Global train loss: 0.721, Global test loss: 2.649, Global test accuracy: 17.08
Round  38, Train loss: 0.736, Test loss: 0.904, Test accuracy: 67.77
Round  38, Global train loss: 0.736, Global test loss: 2.566, Global test accuracy: 19.62
Round  39, Train loss: 0.739, Test loss: 0.919, Test accuracy: 67.36
Round  39, Global train loss: 0.739, Global test loss: 2.619, Global test accuracy: 18.54
Round  40, Train loss: 0.682, Test loss: 0.910, Test accuracy: 67.78
Round  40, Global train loss: 0.682, Global test loss: 2.837, Global test accuracy: 17.22
Round  41, Train loss: 0.648, Test loss: 0.916, Test accuracy: 67.66
Round  41, Global train loss: 0.648, Global test loss: 2.713, Global test accuracy: 17.85
Round  42, Train loss: 0.681, Test loss: 0.900, Test accuracy: 68.26
Round  42, Global train loss: 0.681, Global test loss: 2.736, Global test accuracy: 18.80
Round  43, Train loss: 0.710, Test loss: 0.899, Test accuracy: 68.10
Round  43, Global train loss: 0.710, Global test loss: 2.628, Global test accuracy: 18.84
Round  44, Train loss: 0.609, Test loss: 0.897, Test accuracy: 68.43
Round  44, Global train loss: 0.609, Global test loss: 2.639, Global test accuracy: 17.72
Round  45, Train loss: 0.664, Test loss: 0.899, Test accuracy: 68.64
Round  45, Global train loss: 0.664, Global test loss: 2.508, Global test accuracy: 17.66
Round  46, Train loss: 0.692, Test loss: 0.883, Test accuracy: 69.21
Round  46, Global train loss: 0.692, Global test loss: 2.800, Global test accuracy: 18.41
Round  47, Train loss: 0.623, Test loss: 0.904, Test accuracy: 69.14
Round  47, Global train loss: 0.623, Global test loss: 2.772, Global test accuracy: 17.14
Round  48, Train loss: 0.613, Test loss: 0.890, Test accuracy: 69.55
Round  48, Global train loss: 0.613, Global test loss: 2.919, Global test accuracy: 17.20
Round  49, Train loss: 0.574, Test loss: 0.896, Test accuracy: 69.28
Round  49, Global train loss: 0.574, Global test loss: 2.833, Global test accuracy: 16.46
Round  50, Train loss: 0.594, Test loss: 0.897, Test accuracy: 69.35
Round  50, Global train loss: 0.594, Global test loss: 2.798, Global test accuracy: 17.89
Round  51, Train loss: 0.571, Test loss: 0.892, Test accuracy: 69.80
Round  51, Global train loss: 0.571, Global test loss: 2.962, Global test accuracy: 17.32
Round  52, Train loss: 0.581, Test loss: 0.902, Test accuracy: 69.60
Round  52, Global train loss: 0.581, Global test loss: 2.601, Global test accuracy: 19.17
Round  53, Train loss: 0.586, Test loss: 0.911, Test accuracy: 70.08
Round  53, Global train loss: 0.586, Global test loss: 2.709, Global test accuracy: 18.63
Round  54, Train loss: 0.522, Test loss: 0.922, Test accuracy: 69.80
Round  54, Global train loss: 0.522, Global test loss: 3.096, Global test accuracy: 17.64
Round  55, Train loss: 0.525, Test loss: 0.922, Test accuracy: 69.52
Round  55, Global train loss: 0.525, Global test loss: 3.098, Global test accuracy: 19.13
Round  56, Train loss: 0.561, Test loss: 0.923, Test accuracy: 69.84
Round  56, Global train loss: 0.561, Global test loss: 2.832, Global test accuracy: 18.76
Round  57, Train loss: 0.524, Test loss: 0.920, Test accuracy: 70.03
Round  57, Global train loss: 0.524, Global test loss: 2.731, Global test accuracy: 17.83
Round  58, Train loss: 0.546, Test loss: 0.953, Test accuracy: 69.50
Round  58, Global train loss: 0.546, Global test loss: 3.090, Global test accuracy: 17.91
Round  59, Train loss: 0.542, Test loss: 0.931, Test accuracy: 69.66
Round  59, Global train loss: 0.542, Global test loss: 3.136, Global test accuracy: 17.27
Round  60, Train loss: 0.548, Test loss: 0.921, Test accuracy: 69.94
Round  60, Global train loss: 0.548, Global test loss: 2.715, Global test accuracy: 18.90
Round  61, Train loss: 0.574, Test loss: 0.932, Test accuracy: 70.18
Round  61, Global train loss: 0.574, Global test loss: 3.265, Global test accuracy: 17.44
Round  62, Train loss: 0.492, Test loss: 0.920, Test accuracy: 70.39
Round  62, Global train loss: 0.492, Global test loss: 2.804, Global test accuracy: 18.82
Round  63, Train loss: 0.506, Test loss: 0.952, Test accuracy: 69.84
Round  63, Global train loss: 0.506, Global test loss: 3.416, Global test accuracy: 18.95
Round  64, Train loss: 0.488, Test loss: 0.960, Test accuracy: 69.77
Round  64, Global train loss: 0.488, Global test loss: 2.957, Global test accuracy: 18.20
Round  65, Train loss: 0.578, Test loss: 0.950, Test accuracy: 69.59
Round  65, Global train loss: 0.578, Global test loss: 3.057, Global test accuracy: 17.37
Round  66, Train loss: 0.549, Test loss: 0.955, Test accuracy: 70.05
Round  66, Global train loss: 0.549, Global test loss: 2.862, Global test accuracy: 19.17
Round  67, Train loss: 0.545, Test loss: 0.941, Test accuracy: 70.47
Round  67, Global train loss: 0.545, Global test loss: 3.011, Global test accuracy: 18.40
Round  68, Train loss: 0.463, Test loss: 0.931, Test accuracy: 70.59
Round  68, Global train loss: 0.463, Global test loss: 3.251, Global test accuracy: 17.39
Round  69, Train loss: 0.493, Test loss: 0.947, Test accuracy: 70.38
Round  69, Global train loss: 0.493, Global test loss: 3.250, Global test accuracy: 19.83
Round  70, Train loss: 0.513, Test loss: 0.958, Test accuracy: 70.25
Round  70, Global train loss: 0.513, Global test loss: 3.123, Global test accuracy: 19.01
Round  71, Train loss: 0.471, Test loss: 0.949, Test accuracy: 70.57
Round  71, Global train loss: 0.471, Global test loss: 3.230, Global test accuracy: 17.13
Round  72, Train loss: 0.419, Test loss: 0.944, Test accuracy: 70.81
Round  72, Global train loss: 0.419, Global test loss: 3.499, Global test accuracy: 18.73
Round  73, Train loss: 0.529, Test loss: 0.952, Test accuracy: 70.55
Round  73, Global train loss: 0.529, Global test loss: 3.269, Global test accuracy: 18.39
Round  74, Train loss: 0.488, Test loss: 0.969, Test accuracy: 70.39
Round  74, Global train loss: 0.488, Global test loss: 2.922, Global test accuracy: 19.25
Round  75, Train loss: 0.455, Test loss: 0.975, Test accuracy: 70.92
Round  75, Global train loss: 0.455, Global test loss: 3.372, Global test accuracy: 17.03
Round  76, Train loss: 0.409, Test loss: 0.970, Test accuracy: 70.61
Round  76, Global train loss: 0.409, Global test loss: 2.983, Global test accuracy: 18.78
Round  77, Train loss: 0.421, Test loss: 0.950, Test accuracy: 71.34
Round  77, Global train loss: 0.421, Global test loss: 3.337, Global test accuracy: 17.08
Round  78, Train loss: 0.454, Test loss: 0.956, Test accuracy: 71.28
Round  78, Global train loss: 0.454, Global test loss: 3.076, Global test accuracy: 18.61
Round  79, Train loss: 0.445, Test loss: 0.991, Test accuracy: 70.95
Round  79, Global train loss: 0.445, Global test loss: 3.207, Global test accuracy: 18.18
Round  80, Train loss: 0.414, Test loss: 0.979, Test accuracy: 71.00
Round  80, Global train loss: 0.414, Global test loss: 3.588, Global test accuracy: 17.62
Round  81, Train loss: 0.387, Test loss: 0.969, Test accuracy: 71.13
Round  81, Global train loss: 0.387, Global test loss: 3.358, Global test accuracy: 18.32
Round  82, Train loss: 0.461, Test loss: 0.994, Test accuracy: 71.11
Round  82, Global train loss: 0.461, Global test loss: 3.159, Global test accuracy: 19.27
Round  83, Train loss: 0.382, Test loss: 0.997, Test accuracy: 71.15
Round  83, Global train loss: 0.382, Global test loss: 3.402, Global test accuracy: 16.97
Round  84, Train loss: 0.428, Test loss: 1.021, Test accuracy: 70.79
Round  84, Global train loss: 0.428, Global test loss: 3.055, Global test accuracy: 18.65
Round  85, Train loss: 0.491, Test loss: 1.025, Test accuracy: 70.75
Round  85, Global train loss: 0.491, Global test loss: 3.103, Global test accuracy: 17.66
Round  86, Train loss: 0.443, Test loss: 1.004, Test accuracy: 71.01
Round  86, Global train loss: 0.443, Global test loss: 3.078, Global test accuracy: 17.28
Round  87, Train loss: 0.450, Test loss: 1.012, Test accuracy: 70.79
Round  87, Global train loss: 0.450, Global test loss: 3.426, Global test accuracy: 16.98
Round  88, Train loss: 0.368, Test loss: 0.969, Test accuracy: 71.35
Round  88, Global train loss: 0.368, Global test loss: 3.156, Global test accuracy: 17.15
Round  89, Train loss: 0.445, Test loss: 0.981, Test accuracy: 71.39
Round  89, Global train loss: 0.445, Global test loss: 2.937, Global test accuracy: 18.74
Round  90, Train loss: 0.420, Test loss: 0.974, Test accuracy: 71.52
Round  90, Global train loss: 0.420, Global test loss: 2.991, Global test accuracy: 18.33
Round  91, Train loss: 0.403, Test loss: 1.014, Test accuracy: 71.06
Round  91, Global train loss: 0.403, Global test loss: 3.123, Global test accuracy: 18.45
Round  92, Train loss: 0.392, Test loss: 1.031, Test accuracy: 70.78
Round  92, Global train loss: 0.392, Global test loss: 3.150, Global test accuracy: 18.49
Round  93, Train loss: 0.398, Test loss: 1.038, Test accuracy: 71.17
Round  93, Global train loss: 0.398, Global test loss: 3.126, Global test accuracy: 18.40
Round  94, Train loss: 0.380, Test loss: 1.024, Test accuracy: 71.44
Round  94, Global train loss: 0.380, Global test loss: 3.285, Global test accuracy: 17.81
Round  95, Train loss: 0.443, Test loss: 1.026, Test accuracy: 71.46
Round  95, Global train loss: 0.443, Global test loss: 3.251, Global test accuracy: 17.14
Round  96, Train loss: 0.367, Test loss: 1.019, Test accuracy: 71.20
Round  96, Global train loss: 0.367, Global test loss: 3.426, Global test accuracy: 19.10
Round  97, Train loss: 0.435, Test loss: 1.045, Test accuracy: 70.95
Round  97, Global train loss: 0.435, Global test loss: 3.214, Global test accuracy: 19.56
Round  98, Train loss: 0.365, Test loss: 1.038, Test accuracy: 71.05
Round  98, Global train loss: 0.365, Global test loss: 3.615, Global test accuracy: 18.43
Round  99, Train loss: 0.408, Test loss: 1.023, Test accuracy: 70.96
Round  99, Global train loss: 0.408, Global test loss: 3.333, Global test accuracy: 15.94
Final Round, Train loss: 0.304, Test loss: 1.134, Test accuracy: 72.07
Final Round, Global train loss: 0.304, Global test loss: 3.333, Global test accuracy: 15.94
Average accuracy final 10 rounds: 71.159 

Average global accuracy final 10 rounds: 18.165 

1807.518587589264
[2.035102605819702, 4.070205211639404, 5.604480504989624, 7.138755798339844, 8.656985521316528, 10.175215244293213, 11.600263833999634, 13.025312423706055, 14.446912050247192, 15.86851167678833, 17.322768449783325, 18.77702522277832, 20.41483974456787, 22.052654266357422, 23.58479595184326, 25.1169376373291, 26.58804178237915, 28.0591459274292, 29.563169956207275, 31.06719398498535, 32.621665477752686, 34.17613697052002, 35.68998432159424, 37.20383167266846, 38.64335632324219, 40.08288097381592, 41.513806104660034, 42.94473123550415, 44.47419738769531, 46.003663539886475, 47.547832012176514, 49.09200048446655, 50.54304599761963, 51.994091510772705, 53.47153639793396, 54.948981285095215, 56.51726174354553, 58.08554220199585, 59.56712508201599, 61.04870796203613, 62.529319047927856, 64.00993013381958, 65.54317569732666, 67.07642126083374, 68.55511236190796, 70.03380346298218, 71.60081720352173, 73.16783094406128, 74.62927269935608, 76.09071445465088, 77.88749742507935, 79.68428039550781, 81.09400415420532, 82.50372791290283, 83.98812747001648, 85.47252702713013, 86.906334400177, 88.34014177322388, 89.78324699401855, 91.22635221481323, 92.66890287399292, 94.11145353317261, 95.86040139198303, 97.60934925079346, 99.12587666511536, 100.64240407943726, 102.15592312812805, 103.66944217681885, 105.15638899803162, 106.64333581924438, 108.09905576705933, 109.55477571487427, 111.2136697769165, 112.87256383895874, 114.26414012908936, 115.65571641921997, 117.17618680000305, 118.69665718078613, 120.38393807411194, 122.07121896743774, 123.7427110671997, 125.41420316696167, 126.94179058074951, 128.46937799453735, 129.91360688209534, 131.35783576965332, 132.86557698249817, 134.37331819534302, 135.93237161636353, 137.49142503738403, 138.92037296295166, 140.3493208885193, 141.80952095985413, 143.26972103118896, 144.77328205108643, 146.2768430709839, 147.71695184707642, 149.15706062316895, 150.84173488616943, 152.52640914916992, 154.00096082687378, 155.47551250457764, 156.9021394252777, 158.32876634597778, 159.786963224411, 161.24516010284424, 162.69582200050354, 164.14648389816284, 165.57741284370422, 167.0083417892456, 168.48522877693176, 169.96211576461792, 171.43057489395142, 172.8990340232849, 174.36115670204163, 175.82327938079834, 177.25861287117004, 178.69394636154175, 180.19729661941528, 181.70064687728882, 183.20359706878662, 184.70654726028442, 186.40724182128906, 188.1079363822937, 189.82220935821533, 191.53648233413696, 193.09310245513916, 194.64972257614136, 196.04193019866943, 197.4341378211975, 198.9779109954834, 200.5216841697693, 201.96538043022156, 203.40907669067383, 204.950124502182, 206.49117231369019, 208.03262400627136, 209.57407569885254, 211.08107709884644, 212.58807849884033, 214.04870414733887, 215.5093297958374, 216.93340492248535, 218.3574800491333, 219.80799770355225, 221.2585153579712, 222.75974011421204, 224.26096487045288, 225.85376000404358, 227.44655513763428, 228.96708726882935, 230.4876194000244, 231.94114685058594, 233.39467430114746, 234.90564370155334, 236.41661310195923, 238.0056653022766, 239.594717502594, 241.57771921157837, 243.56072092056274, 245.1074116230011, 246.65410232543945, 248.21240401268005, 249.77070569992065, 251.29245972633362, 252.81421375274658, 254.38919377326965, 255.96417379379272, 257.48796558380127, 259.0117573738098, 260.4500894546509, 261.88842153549194, 263.3087136745453, 264.72900581359863, 266.2427558898926, 267.7565059661865, 269.2212963104248, 270.6860866546631, 272.0906982421875, 273.4953098297119, 275.2159900665283, 276.9366703033447, 278.5998649597168, 280.26305961608887, 281.7871162891388, 283.3111729621887, 284.67963671684265, 286.0481004714966, 287.6963472366333, 289.34459400177, 290.87980580329895, 292.4150176048279, 293.91940808296204, 295.4237985610962, 297.0396771430969, 298.65555572509766, 300.1988525390625, 301.74214935302734, 303.2861475944519, 304.83014583587646, 307.90751814842224, 310.984890460968]
[22.71, 22.71, 29.45, 29.45, 35.03, 35.03, 43.73, 43.73, 48.0, 48.0, 50.87, 50.87, 52.62, 52.62, 53.89, 53.89, 54.39, 54.39, 55.55, 55.55, 57.43, 57.43, 58.9, 58.9, 59.57, 59.57, 60.0, 60.0, 61.6, 61.6, 61.63, 61.63, 61.97, 61.97, 62.26, 62.26, 62.82, 62.82, 63.2, 63.2, 63.7, 63.7, 64.06, 64.06, 63.26, 63.26, 63.65, 63.65, 64.33, 64.33, 65.18, 65.18, 65.43, 65.43, 65.74, 65.74, 65.77, 65.77, 66.16, 66.16, 66.65, 66.65, 66.48, 66.48, 66.98, 66.98, 66.75, 66.75, 67.47, 67.47, 67.38, 67.38, 67.84, 67.84, 67.04, 67.04, 67.77, 67.77, 67.36, 67.36, 67.78, 67.78, 67.66, 67.66, 68.26, 68.26, 68.1, 68.1, 68.43, 68.43, 68.64, 68.64, 69.21, 69.21, 69.14, 69.14, 69.55, 69.55, 69.28, 69.28, 69.35, 69.35, 69.8, 69.8, 69.6, 69.6, 70.08, 70.08, 69.8, 69.8, 69.52, 69.52, 69.84, 69.84, 70.03, 70.03, 69.5, 69.5, 69.66, 69.66, 69.94, 69.94, 70.18, 70.18, 70.39, 70.39, 69.84, 69.84, 69.77, 69.77, 69.59, 69.59, 70.05, 70.05, 70.47, 70.47, 70.59, 70.59, 70.38, 70.38, 70.25, 70.25, 70.57, 70.57, 70.81, 70.81, 70.55, 70.55, 70.39, 70.39, 70.92, 70.92, 70.61, 70.61, 71.34, 71.34, 71.28, 71.28, 70.95, 70.95, 71.0, 71.0, 71.13, 71.13, 71.11, 71.11, 71.15, 71.15, 70.79, 70.79, 70.75, 70.75, 71.01, 71.01, 70.79, 70.79, 71.35, 71.35, 71.39, 71.39, 71.52, 71.52, 71.06, 71.06, 70.78, 70.78, 71.17, 71.17, 71.44, 71.44, 71.46, 71.46, 71.2, 71.2, 70.95, 70.95, 71.05, 71.05, 70.96, 70.96, 72.07, 72.07]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.604, Test loss: 2.072, Test accuracy: 18.91
Round   0, Global train loss: 1.604, Global test loss: 2.314, Global test accuracy: 12.58
Round   1, Train loss: 1.461, Test loss: 1.982, Test accuracy: 24.36
Round   1, Global train loss: 1.461, Global test loss: 2.445, Global test accuracy: 12.05
Round   2, Train loss: 1.417, Test loss: 1.713, Test accuracy: 33.64
Round   2, Global train loss: 1.417, Global test loss: 2.541, Global test accuracy: 12.90
Round   3, Train loss: 1.347, Test loss: 1.517, Test accuracy: 38.90
Round   3, Global train loss: 1.347, Global test loss: 2.389, Global test accuracy: 12.99
Round   4, Train loss: 1.260, Test loss: 1.520, Test accuracy: 40.27
Round   4, Global train loss: 1.260, Global test loss: 2.536, Global test accuracy: 13.01
Round   5, Train loss: 1.237, Test loss: 1.477, Test accuracy: 42.47
Round   5, Global train loss: 1.237, Global test loss: 2.500, Global test accuracy: 14.36
Round   6, Train loss: 1.253, Test loss: 1.287, Test accuracy: 47.72
Round   6, Global train loss: 1.253, Global test loss: 2.465, Global test accuracy: 14.66
Round   7, Train loss: 1.219, Test loss: 1.231, Test accuracy: 49.61
Round   7, Global train loss: 1.219, Global test loss: 2.411, Global test accuracy: 15.37
Round   8, Train loss: 1.171, Test loss: 1.188, Test accuracy: 52.72
Round   8, Global train loss: 1.171, Global test loss: 2.465, Global test accuracy: 15.68
Round   9, Train loss: 1.135, Test loss: 1.100, Test accuracy: 55.26
Round   9, Global train loss: 1.135, Global test loss: 2.439, Global test accuracy: 16.26
Round  10, Train loss: 1.139, Test loss: 1.073, Test accuracy: 56.34
Round  10, Global train loss: 1.139, Global test loss: 2.370, Global test accuracy: 15.73
Round  11, Train loss: 1.142, Test loss: 1.060, Test accuracy: 57.45
Round  11, Global train loss: 1.142, Global test loss: 2.436, Global test accuracy: 14.13
Round  12, Train loss: 1.108, Test loss: 1.043, Test accuracy: 58.32
Round  12, Global train loss: 1.108, Global test loss: 2.553, Global test accuracy: 15.19
Round  13, Train loss: 1.074, Test loss: 1.034, Test accuracy: 59.03
Round  13, Global train loss: 1.074, Global test loss: 2.585, Global test accuracy: 16.14
Round  14, Train loss: 1.046, Test loss: 1.019, Test accuracy: 59.55
Round  14, Global train loss: 1.046, Global test loss: 2.532, Global test accuracy: 14.25
Round  15, Train loss: 1.036, Test loss: 1.015, Test accuracy: 59.93
Round  15, Global train loss: 1.036, Global test loss: 2.542, Global test accuracy: 14.97
Round  16, Train loss: 1.044, Test loss: 1.021, Test accuracy: 59.67
Round  16, Global train loss: 1.044, Global test loss: 2.414, Global test accuracy: 14.54
Round  17, Train loss: 1.028, Test loss: 0.996, Test accuracy: 60.53
Round  17, Global train loss: 1.028, Global test loss: 2.689, Global test accuracy: 13.27
Round  18, Train loss: 1.057, Test loss: 0.999, Test accuracy: 60.38
Round  18, Global train loss: 1.057, Global test loss: 2.479, Global test accuracy: 14.68
Round  19, Train loss: 0.977, Test loss: 0.997, Test accuracy: 60.70
Round  19, Global train loss: 0.977, Global test loss: 2.715, Global test accuracy: 12.88
Round  20, Train loss: 0.960, Test loss: 0.994, Test accuracy: 61.23
Round  20, Global train loss: 0.960, Global test loss: 2.872, Global test accuracy: 14.31
Round  21, Train loss: 0.959, Test loss: 0.984, Test accuracy: 62.18
Round  21, Global train loss: 0.959, Global test loss: 2.562, Global test accuracy: 16.71
Round  22, Train loss: 0.922, Test loss: 0.996, Test accuracy: 61.59
Round  22, Global train loss: 0.922, Global test loss: 2.699, Global test accuracy: 16.09
Round  23, Train loss: 0.966, Test loss: 0.980, Test accuracy: 62.11
Round  23, Global train loss: 0.966, Global test loss: 2.545, Global test accuracy: 15.67
Round  24, Train loss: 0.926, Test loss: 0.961, Test accuracy: 62.64
Round  24, Global train loss: 0.926, Global test loss: 2.529, Global test accuracy: 17.40
Round  25, Train loss: 0.961, Test loss: 0.959, Test accuracy: 62.91
Round  25, Global train loss: 0.961, Global test loss: 2.422, Global test accuracy: 16.82
Round  26, Train loss: 0.883, Test loss: 0.952, Test accuracy: 63.22
Round  26, Global train loss: 0.883, Global test loss: 2.677, Global test accuracy: 17.87
Round  27, Train loss: 0.867, Test loss: 0.941, Test accuracy: 64.08
Round  27, Global train loss: 0.867, Global test loss: 2.444, Global test accuracy: 16.82
Round  28, Train loss: 0.824, Test loss: 0.938, Test accuracy: 63.70
Round  28, Global train loss: 0.824, Global test loss: 2.649, Global test accuracy: 15.53
Round  29, Train loss: 0.878, Test loss: 0.922, Test accuracy: 64.43
Round  29, Global train loss: 0.878, Global test loss: 2.557, Global test accuracy: 16.42
Round  30, Train loss: 0.877, Test loss: 0.909, Test accuracy: 64.93
Round  30, Global train loss: 0.877, Global test loss: 2.685, Global test accuracy: 16.60
Round  31, Train loss: 0.836, Test loss: 0.917, Test accuracy: 64.88
Round  31, Global train loss: 0.836, Global test loss: 2.694, Global test accuracy: 16.64
Round  32, Train loss: 0.860, Test loss: 0.923, Test accuracy: 64.82
Round  32, Global train loss: 0.860, Global test loss: 2.689, Global test accuracy: 16.12
Round  33, Train loss: 0.814, Test loss: 0.921, Test accuracy: 65.17
Round  33, Global train loss: 0.814, Global test loss: 2.651, Global test accuracy: 15.24
Round  34, Train loss: 0.778, Test loss: 0.910, Test accuracy: 65.48
Round  34, Global train loss: 0.778, Global test loss: 2.612, Global test accuracy: 17.32
Round  35, Train loss: 0.800, Test loss: 0.890, Test accuracy: 66.40
Round  35, Global train loss: 0.800, Global test loss: 2.640, Global test accuracy: 16.80
Round  36, Train loss: 0.812, Test loss: 0.891, Test accuracy: 66.06
Round  36, Global train loss: 0.812, Global test loss: 2.805, Global test accuracy: 15.33
Round  37, Train loss: 0.743, Test loss: 0.902, Test accuracy: 65.62
Round  37, Global train loss: 0.743, Global test loss: 2.734, Global test accuracy: 15.87
Round  38, Train loss: 0.746, Test loss: 0.907, Test accuracy: 65.83
Round  38, Global train loss: 0.746, Global test loss: 2.790, Global test accuracy: 16.26
Round  39, Train loss: 0.785, Test loss: 0.905, Test accuracy: 66.02
Round  39, Global train loss: 0.785, Global test loss: 2.646, Global test accuracy: 16.42
Round  40, Train loss: 0.762, Test loss: 0.902, Test accuracy: 66.12
Round  40, Global train loss: 0.762, Global test loss: 2.588, Global test accuracy: 15.83
Round  41, Train loss: 0.711, Test loss: 0.907, Test accuracy: 66.23
Round  41, Global train loss: 0.711, Global test loss: 2.734, Global test accuracy: 15.97
Round  42, Train loss: 0.768, Test loss: 0.903, Test accuracy: 66.69
Round  42, Global train loss: 0.768, Global test loss: 2.605, Global test accuracy: 16.04
Round  43, Train loss: 0.668, Test loss: 0.903, Test accuracy: 66.53
Round  43, Global train loss: 0.668, Global test loss: 2.659, Global test accuracy: 16.08
Round  44, Train loss: 0.764, Test loss: 0.886, Test accuracy: 67.41
Round  44, Global train loss: 0.764, Global test loss: 2.598, Global test accuracy: 13.54
Round  45, Train loss: 0.751, Test loss: 0.896, Test accuracy: 67.31
Round  45, Global train loss: 0.751, Global test loss: 2.832, Global test accuracy: 13.92
Round  46, Train loss: 0.733, Test loss: 0.889, Test accuracy: 67.64
Round  46, Global train loss: 0.733, Global test loss: 2.748, Global test accuracy: 14.03
Round  47, Train loss: 0.699, Test loss: 0.888, Test accuracy: 67.74
Round  47, Global train loss: 0.699, Global test loss: 2.855, Global test accuracy: 15.20
Round  48, Train loss: 0.773, Test loss: 0.896, Test accuracy: 67.85
Round  48, Global train loss: 0.773, Global test loss: 2.641, Global test accuracy: 15.58
Round  49, Train loss: 0.734, Test loss: 0.881, Test accuracy: 68.39
Round  49, Global train loss: 0.734, Global test loss: 2.934, Global test accuracy: 15.49
Round  50, Train loss: 0.743, Test loss: 0.879, Test accuracy: 68.33
Round  50, Global train loss: 0.743, Global test loss: 2.645, Global test accuracy: 15.07
Round  51, Train loss: 0.673, Test loss: 0.891, Test accuracy: 68.13
Round  51, Global train loss: 0.673, Global test loss: 2.760, Global test accuracy: 12.85
Round  52, Train loss: 0.738, Test loss: 0.905, Test accuracy: 67.78
Round  52, Global train loss: 0.738, Global test loss: 2.760, Global test accuracy: 15.66
Round  53, Train loss: 0.658, Test loss: 0.909, Test accuracy: 67.76
Round  53, Global train loss: 0.658, Global test loss: 2.914, Global test accuracy: 15.55
Round  54, Train loss: 0.658, Test loss: 0.899, Test accuracy: 68.05
Round  54, Global train loss: 0.658, Global test loss: 2.837, Global test accuracy: 16.42
Round  55, Train loss: 0.637, Test loss: 0.904, Test accuracy: 68.28
Round  55, Global train loss: 0.637, Global test loss: 3.033, Global test accuracy: 14.78
Round  56, Train loss: 0.662, Test loss: 0.891, Test accuracy: 68.64
Round  56, Global train loss: 0.662, Global test loss: 2.696, Global test accuracy: 16.28
Round  57, Train loss: 0.599, Test loss: 0.889, Test accuracy: 68.89
Round  57, Global train loss: 0.599, Global test loss: 2.986, Global test accuracy: 14.76
Round  58, Train loss: 0.593, Test loss: 0.893, Test accuracy: 68.95
Round  58, Global train loss: 0.593, Global test loss: 3.042, Global test accuracy: 16.64
Round  59, Train loss: 0.641, Test loss: 0.894, Test accuracy: 68.97
Round  59, Global train loss: 0.641, Global test loss: 2.793, Global test accuracy: 16.63
Round  60, Train loss: 0.625, Test loss: 0.900, Test accuracy: 68.66
Round  60, Global train loss: 0.625, Global test loss: 2.835, Global test accuracy: 16.10
Round  61, Train loss: 0.633, Test loss: 0.904, Test accuracy: 68.66
Round  61, Global train loss: 0.633, Global test loss: 2.725, Global test accuracy: 14.50
Round  62, Train loss: 0.644, Test loss: 0.894, Test accuracy: 69.50
Round  62, Global train loss: 0.644, Global test loss: 2.821, Global test accuracy: 14.03
Round  63, Train loss: 0.580, Test loss: 0.909, Test accuracy: 69.18
Round  63, Global train loss: 0.580, Global test loss: 2.832, Global test accuracy: 15.39
Round  64, Train loss: 0.644, Test loss: 0.925, Test accuracy: 68.91
Round  64, Global train loss: 0.644, Global test loss: 2.869, Global test accuracy: 15.72
Round  65, Train loss: 0.605, Test loss: 0.908, Test accuracy: 68.86
Round  65, Global train loss: 0.605, Global test loss: 2.968, Global test accuracy: 16.95
Round  66, Train loss: 0.589, Test loss: 0.912, Test accuracy: 68.96
Round  66, Global train loss: 0.589, Global test loss: 2.893, Global test accuracy: 16.09
Round  67, Train loss: 0.590, Test loss: 0.902, Test accuracy: 69.10
Round  67, Global train loss: 0.590, Global test loss: 3.191, Global test accuracy: 16.05
Round  68, Train loss: 0.580, Test loss: 0.889, Test accuracy: 69.40
Round  68, Global train loss: 0.580, Global test loss: 2.711, Global test accuracy: 16.17
Round  69, Train loss: 0.592, Test loss: 0.920, Test accuracy: 68.75
Round  69, Global train loss: 0.592, Global test loss: 2.876, Global test accuracy: 16.15
Round  70, Train loss: 0.563, Test loss: 0.930, Test accuracy: 69.12
Round  70, Global train loss: 0.563, Global test loss: 2.949, Global test accuracy: 16.33
Round  71, Train loss: 0.566, Test loss: 0.937, Test accuracy: 68.72
Round  71, Global train loss: 0.566, Global test loss: 2.952, Global test accuracy: 15.32
Round  72, Train loss: 0.546, Test loss: 0.918, Test accuracy: 69.34
Round  72, Global train loss: 0.546, Global test loss: 3.094, Global test accuracy: 15.87
Round  73, Train loss: 0.505, Test loss: 0.944, Test accuracy: 69.08
Round  73, Global train loss: 0.505, Global test loss: 3.236, Global test accuracy: 15.31
Round  74, Train loss: 0.552, Test loss: 0.945, Test accuracy: 68.84
Round  74, Global train loss: 0.552, Global test loss: 3.333, Global test accuracy: 15.28
Round  75, Train loss: 0.537, Test loss: 0.932, Test accuracy: 69.21
Round  75, Global train loss: 0.537, Global test loss: 3.176, Global test accuracy: 15.43
Round  76, Train loss: 0.539, Test loss: 0.956, Test accuracy: 68.99
Round  76, Global train loss: 0.539, Global test loss: 3.264, Global test accuracy: 15.13
Round  77, Train loss: 0.552, Test loss: 0.941, Test accuracy: 69.42
Round  77, Global train loss: 0.552, Global test loss: 3.087, Global test accuracy: 16.51
Round  78, Train loss: 0.518, Test loss: 0.976, Test accuracy: 68.73
Round  78, Global train loss: 0.518, Global test loss: 3.074, Global test accuracy: 16.22
Round  79, Train loss: 0.520, Test loss: 0.964, Test accuracy: 69.22
Round  79, Global train loss: 0.520, Global test loss: 3.216, Global test accuracy: 16.32
Round  80, Train loss: 0.515, Test loss: 0.952, Test accuracy: 69.75
Round  80, Global train loss: 0.515, Global test loss: 3.104, Global test accuracy: 15.75
Round  81, Train loss: 0.457, Test loss: 0.948, Test accuracy: 69.72
Round  81, Global train loss: 0.457, Global test loss: 3.122, Global test accuracy: 16.75
Round  82, Train loss: 0.531, Test loss: 0.948, Test accuracy: 69.74
Round  82, Global train loss: 0.531, Global test loss: 3.200, Global test accuracy: 16.83
Round  83, Train loss: 0.481, Test loss: 0.950, Test accuracy: 69.72
Round  83, Global train loss: 0.481, Global test loss: 3.337, Global test accuracy: 17.76
Round  84, Train loss: 0.567, Test loss: 0.955, Test accuracy: 69.77
Round  84, Global train loss: 0.567, Global test loss: 3.052, Global test accuracy: 14.26
Round  85, Train loss: 0.462, Test loss: 0.947, Test accuracy: 70.04
Round  85, Global train loss: 0.462, Global test loss: 3.328, Global test accuracy: 15.13
Round  86, Train loss: 0.499, Test loss: 0.952, Test accuracy: 70.24
Round  86, Global train loss: 0.499, Global test loss: 3.143, Global test accuracy: 16.17
Round  87, Train loss: 0.479, Test loss: 0.965, Test accuracy: 69.93
Round  87, Global train loss: 0.479, Global test loss: 3.246, Global test accuracy: 16.58
Round  88, Train loss: 0.549, Test loss: 0.971, Test accuracy: 69.80
Round  88, Global train loss: 0.549, Global test loss: 3.236, Global test accuracy: 15.71
Round  89, Train loss: 0.454, Test loss: 0.948, Test accuracy: 70.20
Round  89, Global train loss: 0.454, Global test loss: 3.288, Global test accuracy: 15.54
Round  90, Train loss: 0.439, Test loss: 0.951, Test accuracy: 70.12
Round  90, Global train loss: 0.439, Global test loss: 3.345, Global test accuracy: 15.22
Round  91, Train loss: 0.519, Test loss: 0.966, Test accuracy: 69.97
Round  91, Global train loss: 0.519, Global test loss: 3.018, Global test accuracy: 15.91
Round  92, Train loss: 0.459, Test loss: 0.973, Test accuracy: 70.05
Round  92, Global train loss: 0.459, Global test loss: 3.145, Global test accuracy: 14.59
Round  93, Train loss: 0.471, Test loss: 0.965, Test accuracy: 70.45
Round  93, Global train loss: 0.471, Global test loss: 3.177, Global test accuracy: 15.45
Round  94, Train loss: 0.504, Test loss: 0.958, Test accuracy: 70.64
Round  94, Global train loss: 0.504, Global test loss: 3.258, Global test accuracy: 15.61
Round  95, Train loss: 0.468, Test loss: 0.962, Test accuracy: 70.75
Round  95, Global train loss: 0.468, Global test loss: 3.276, Global test accuracy: 15.06/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 0.500, Test loss: 0.971, Test accuracy: 70.63
Round  96, Global train loss: 0.500, Global test loss: 3.404, Global test accuracy: 16.25
Round  97, Train loss: 0.423, Test loss: 0.982, Test accuracy: 70.44
Round  97, Global train loss: 0.423, Global test loss: 3.476, Global test accuracy: 18.04
Round  98, Train loss: 0.418, Test loss: 0.958, Test accuracy: 70.84
Round  98, Global train loss: 0.418, Global test loss: 3.126, Global test accuracy: 16.20
Round  99, Train loss: 0.509, Test loss: 0.967, Test accuracy: 70.88
Round  99, Global train loss: 0.509, Global test loss: 3.047, Global test accuracy: 16.07
Final Round, Train loss: 0.362, Test loss: 1.051, Test accuracy: 70.36
Final Round, Global train loss: 0.362, Global test loss: 3.047, Global test accuracy: 16.07
Average accuracy final 10 rounds: 70.477 

Average global accuracy final 10 rounds: 15.839999999999998 

1872.2476155757904
[1.8420536518096924, 3.6841073036193848, 5.3158934116363525, 6.94767951965332, 8.48159384727478, 10.01550817489624, 11.592886686325073, 13.170265197753906, 14.859116792678833, 16.54796838760376, 18.194517374038696, 19.841066360473633, 21.45233964920044, 23.063612937927246, 24.8068208694458, 26.550028800964355, 28.227913856506348, 29.90579891204834, 31.47015619277954, 33.03451347351074, 34.696494340896606, 36.35847520828247, 38.02032971382141, 39.68218421936035, 41.29098725318909, 42.89979028701782, 44.463836908340454, 46.027883529663086, 47.72679090499878, 49.42569828033447, 50.95073437690735, 52.475770473480225, 54.124680280685425, 55.773590087890625, 57.342041015625, 58.910491943359375, 60.59632897377014, 62.28216600418091, 63.874892473220825, 65.46761894226074, 67.00919961929321, 68.55078029632568, 70.17704176902771, 71.80330324172974, 73.46711707115173, 75.13093090057373, 76.84375762939453, 78.55658435821533, 80.16748189926147, 81.77837944030762, 83.33476972579956, 84.8911600112915, 86.43404865264893, 87.97693729400635, 89.54790115356445, 91.11886501312256, 92.96007108688354, 94.80127716064453, 96.43392014503479, 98.06656312942505, 99.67696928977966, 101.28737545013428, 102.9200279712677, 104.55268049240112, 106.27956509590149, 108.00644969940186, 109.68123269081116, 111.35601568222046, 112.875173330307, 114.39433097839355, 116.03071141242981, 117.66709184646606, 119.2914469242096, 120.91580200195312, 122.54897117614746, 124.1821403503418, 125.80403470993042, 127.42592906951904, 129.04261684417725, 130.65930461883545, 132.32554936408997, 133.99179410934448, 135.73324155807495, 137.47468900680542, 139.06026101112366, 140.6458330154419, 142.28893089294434, 143.93202877044678, 145.5340552330017, 147.13608169555664, 148.75428557395935, 150.37248945236206, 152.00457763671875, 153.63666582107544, 155.10608053207397, 156.5754952430725, 158.18718600273132, 159.79887676239014, 161.44605088233948, 163.09322500228882, 164.77868556976318, 166.46414613723755, 168.08866834640503, 169.7131905555725, 171.33565664291382, 172.95812273025513, 174.62686395645142, 176.2956051826477, 177.97415447235107, 179.65270376205444, 181.3389003276825, 183.02509689331055, 184.69942951202393, 186.3737621307373, 187.92450666427612, 189.47525119781494, 191.06115698814392, 192.6470627784729, 194.20288491249084, 195.7587070465088, 197.33109879493713, 198.90349054336548, 200.39936470985413, 201.89523887634277, 203.51922273635864, 205.1432065963745, 206.79764771461487, 208.45208883285522, 209.9427146911621, 211.433340549469, 213.1644058227539, 214.89547109603882, 216.43277144432068, 217.97007179260254, 219.60294008255005, 221.23580837249756, 222.84505534172058, 224.4543023109436, 225.99382758140564, 227.53335285186768, 229.16331481933594, 230.7932767868042, 232.3649983406067, 233.93671989440918, 235.74183630943298, 237.5469527244568, 239.24491953849792, 240.94288635253906, 242.61153841018677, 244.28019046783447, 245.85386490821838, 247.4275393486023, 249.07936549186707, 250.73119163513184, 252.4665071964264, 254.20182275772095, 255.95831394195557, 257.7148051261902, 259.27279257774353, 260.8307800292969, 262.5845034122467, 264.33822679519653, 265.9604768753052, 267.5827269554138, 269.2024211883545, 270.82211542129517, 272.6033184528351, 274.384521484375, 276.0796229839325, 277.77472448349, 279.3799350261688, 280.98514556884766, 282.5208399295807, 284.0565342903137, 285.7229197025299, 287.3893051147461, 288.9369456768036, 290.4845862388611, 292.0620002746582, 293.6394143104553, 295.2738456726074, 296.9082770347595, 298.45896649360657, 300.0096559524536, 302.20592188835144, 304.40218782424927, 306.2149052619934, 308.02762269973755, 309.7351589202881, 311.4426951408386, 313.2416076660156, 315.0405201911926, 316.64558124542236, 318.2506422996521, 319.87602400779724, 321.5014057159424, 323.22485184669495, 324.9482979774475, 326.6081385612488, 328.26797914505005, 331.6505844593048, 335.03318977355957]
[18.91, 18.91, 24.36, 24.36, 33.64, 33.64, 38.9, 38.9, 40.27, 40.27, 42.47, 42.47, 47.72, 47.72, 49.61, 49.61, 52.72, 52.72, 55.26, 55.26, 56.34, 56.34, 57.45, 57.45, 58.32, 58.32, 59.03, 59.03, 59.55, 59.55, 59.93, 59.93, 59.67, 59.67, 60.53, 60.53, 60.38, 60.38, 60.7, 60.7, 61.23, 61.23, 62.18, 62.18, 61.59, 61.59, 62.11, 62.11, 62.64, 62.64, 62.91, 62.91, 63.22, 63.22, 64.08, 64.08, 63.7, 63.7, 64.43, 64.43, 64.93, 64.93, 64.88, 64.88, 64.82, 64.82, 65.17, 65.17, 65.48, 65.48, 66.4, 66.4, 66.06, 66.06, 65.62, 65.62, 65.83, 65.83, 66.02, 66.02, 66.12, 66.12, 66.23, 66.23, 66.69, 66.69, 66.53, 66.53, 67.41, 67.41, 67.31, 67.31, 67.64, 67.64, 67.74, 67.74, 67.85, 67.85, 68.39, 68.39, 68.33, 68.33, 68.13, 68.13, 67.78, 67.78, 67.76, 67.76, 68.05, 68.05, 68.28, 68.28, 68.64, 68.64, 68.89, 68.89, 68.95, 68.95, 68.97, 68.97, 68.66, 68.66, 68.66, 68.66, 69.5, 69.5, 69.18, 69.18, 68.91, 68.91, 68.86, 68.86, 68.96, 68.96, 69.1, 69.1, 69.4, 69.4, 68.75, 68.75, 69.12, 69.12, 68.72, 68.72, 69.34, 69.34, 69.08, 69.08, 68.84, 68.84, 69.21, 69.21, 68.99, 68.99, 69.42, 69.42, 68.73, 68.73, 69.22, 69.22, 69.75, 69.75, 69.72, 69.72, 69.74, 69.74, 69.72, 69.72, 69.77, 69.77, 70.04, 70.04, 70.24, 70.24, 69.93, 69.93, 69.8, 69.8, 70.2, 70.2, 70.12, 70.12, 69.97, 69.97, 70.05, 70.05, 70.45, 70.45, 70.64, 70.64, 70.75, 70.75, 70.63, 70.63, 70.44, 70.44, 70.84, 70.84, 70.88, 70.88, 70.36, 70.36]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.632, Test loss: 2.120, Test accuracy: 20.28
Round   0, Global train loss: 1.632, Global test loss: 2.334, Global test accuracy: 14.41
Round   1, Train loss: 1.433, Test loss: 2.207, Test accuracy: 24.98
Round   1, Global train loss: 1.433, Global test loss: 2.627, Global test accuracy: 14.99
Round   2, Train loss: 1.353, Test loss: 1.969, Test accuracy: 27.82
Round   2, Global train loss: 1.353, Global test loss: 2.501, Global test accuracy: 10.57
Round   3, Train loss: 1.300, Test loss: 1.863, Test accuracy: 32.33
Round   3, Global train loss: 1.300, Global test loss: 2.480, Global test accuracy: 15.19
Round   4, Train loss: 1.243, Test loss: 1.802, Test accuracy: 35.48
Round   4, Global train loss: 1.243, Global test loss: 2.531, Global test accuracy: 13.43
Round   5, Train loss: 1.223, Test loss: 1.689, Test accuracy: 37.11
Round   5, Global train loss: 1.223, Global test loss: 2.468, Global test accuracy: 14.02
Round   6, Train loss: 1.193, Test loss: 1.748, Test accuracy: 38.14
Round   6, Global train loss: 1.193, Global test loss: 2.561, Global test accuracy: 14.73
Round   7, Train loss: 1.160, Test loss: 1.387, Test accuracy: 47.57
Round   7, Global train loss: 1.160, Global test loss: 2.367, Global test accuracy: 18.31
Round   8, Train loss: 1.113, Test loss: 1.340, Test accuracy: 49.06
Round   8, Global train loss: 1.113, Global test loss: 2.498, Global test accuracy: 18.52
Round   9, Train loss: 1.109, Test loss: 1.306, Test accuracy: 50.44
Round   9, Global train loss: 1.109, Global test loss: 2.508, Global test accuracy: 14.64
Round  10, Train loss: 1.070, Test loss: 1.119, Test accuracy: 55.56
Round  10, Global train loss: 1.070, Global test loss: 2.608, Global test accuracy: 16.38
Round  11, Train loss: 1.062, Test loss: 1.083, Test accuracy: 57.05
Round  11, Global train loss: 1.062, Global test loss: 2.452, Global test accuracy: 16.23
Round  12, Train loss: 0.990, Test loss: 1.059, Test accuracy: 58.33
Round  12, Global train loss: 0.990, Global test loss: 2.676, Global test accuracy: 13.46
Round  13, Train loss: 1.000, Test loss: 1.054, Test accuracy: 58.38
Round  13, Global train loss: 1.000, Global test loss: 2.440, Global test accuracy: 16.92
Round  14, Train loss: 1.019, Test loss: 1.058, Test accuracy: 58.39
Round  14, Global train loss: 1.019, Global test loss: 2.543, Global test accuracy: 16.59
Round  15, Train loss: 1.003, Test loss: 1.043, Test accuracy: 59.14
Round  15, Global train loss: 1.003, Global test loss: 2.570, Global test accuracy: 15.57
Round  16, Train loss: 1.015, Test loss: 1.029, Test accuracy: 59.96
Round  16, Global train loss: 1.015, Global test loss: 2.520, Global test accuracy: 17.14
Round  17, Train loss: 0.988, Test loss: 1.028, Test accuracy: 60.57
Round  17, Global train loss: 0.988, Global test loss: 2.370, Global test accuracy: 17.64
Round  18, Train loss: 0.938, Test loss: 1.015, Test accuracy: 61.57
Round  18, Global train loss: 0.938, Global test loss: 2.340, Global test accuracy: 19.88
Round  19, Train loss: 0.940, Test loss: 1.002, Test accuracy: 61.74
Round  19, Global train loss: 0.940, Global test loss: 2.546, Global test accuracy: 17.41
Round  20, Train loss: 0.884, Test loss: 1.006, Test accuracy: 61.74
Round  20, Global train loss: 0.884, Global test loss: 2.488, Global test accuracy: 18.59
Round  21, Train loss: 0.973, Test loss: 1.010, Test accuracy: 61.79
Round  21, Global train loss: 0.973, Global test loss: 2.607, Global test accuracy: 19.13
Round  22, Train loss: 0.865, Test loss: 1.018, Test accuracy: 62.10
Round  22, Global train loss: 0.865, Global test loss: 2.534, Global test accuracy: 19.44
Round  23, Train loss: 0.880, Test loss: 1.005, Test accuracy: 63.01
Round  23, Global train loss: 0.880, Global test loss: 2.494, Global test accuracy: 17.25
Round  24, Train loss: 0.829, Test loss: 1.021, Test accuracy: 62.15
Round  24, Global train loss: 0.829, Global test loss: 2.675, Global test accuracy: 18.63
Round  25, Train loss: 0.841, Test loss: 1.021, Test accuracy: 62.05
Round  25, Global train loss: 0.841, Global test loss: 2.417, Global test accuracy: 20.46
Round  26, Train loss: 0.852, Test loss: 1.005, Test accuracy: 62.24
Round  26, Global train loss: 0.852, Global test loss: 2.411, Global test accuracy: 20.02
Round  27, Train loss: 0.854, Test loss: 0.977, Test accuracy: 63.06
Round  27, Global train loss: 0.854, Global test loss: 2.466, Global test accuracy: 18.56
Round  28, Train loss: 0.783, Test loss: 0.986, Test accuracy: 62.91
Round  28, Global train loss: 0.783, Global test loss: 2.859, Global test accuracy: 19.34
Round  29, Train loss: 0.758, Test loss: 0.986, Test accuracy: 63.43
Round  29, Global train loss: 0.758, Global test loss: 2.792, Global test accuracy: 19.99
Round  30, Train loss: 0.772, Test loss: 0.986, Test accuracy: 63.65
Round  30, Global train loss: 0.772, Global test loss: 2.442, Global test accuracy: 20.33
Round  31, Train loss: 0.864, Test loss: 0.968, Test accuracy: 64.28
Round  31, Global train loss: 0.864, Global test loss: 2.516, Global test accuracy: 18.99
Round  32, Train loss: 0.777, Test loss: 0.990, Test accuracy: 63.74
Round  32, Global train loss: 0.777, Global test loss: 2.820, Global test accuracy: 19.67
Round  33, Train loss: 0.779, Test loss: 0.974, Test accuracy: 64.27
Round  33, Global train loss: 0.779, Global test loss: 2.619, Global test accuracy: 19.39
Round  34, Train loss: 0.797, Test loss: 0.961, Test accuracy: 64.89
Round  34, Global train loss: 0.797, Global test loss: 2.757, Global test accuracy: 18.88
Round  35, Train loss: 0.777, Test loss: 0.947, Test accuracy: 65.73
Round  35, Global train loss: 0.777, Global test loss: 2.572, Global test accuracy: 19.46
Round  36, Train loss: 0.715, Test loss: 0.928, Test accuracy: 65.88
Round  36, Global train loss: 0.715, Global test loss: 2.700, Global test accuracy: 19.61
Round  37, Train loss: 0.708, Test loss: 0.930, Test accuracy: 66.40
Round  37, Global train loss: 0.708, Global test loss: 2.736, Global test accuracy: 18.86
Round  38, Train loss: 0.746, Test loss: 0.918, Test accuracy: 66.59
Round  38, Global train loss: 0.746, Global test loss: 2.488, Global test accuracy: 18.73
Round  39, Train loss: 0.756, Test loss: 0.934, Test accuracy: 67.09
Round  39, Global train loss: 0.756, Global test loss: 2.518, Global test accuracy: 18.49
Round  40, Train loss: 0.704, Test loss: 0.933, Test accuracy: 67.04
Round  40, Global train loss: 0.704, Global test loss: 2.570, Global test accuracy: 18.07
Round  41, Train loss: 0.689, Test loss: 0.927, Test accuracy: 67.12
Round  41, Global train loss: 0.689, Global test loss: 2.683, Global test accuracy: 17.03
Round  42, Train loss: 0.676, Test loss: 0.930, Test accuracy: 67.29
Round  42, Global train loss: 0.676, Global test loss: 2.752, Global test accuracy: 20.54
Round  43, Train loss: 0.653, Test loss: 0.930, Test accuracy: 67.85
Round  43, Global train loss: 0.653, Global test loss: 2.809, Global test accuracy: 17.94
Round  44, Train loss: 0.621, Test loss: 0.952, Test accuracy: 67.44
Round  44, Global train loss: 0.621, Global test loss: 2.686, Global test accuracy: 19.87
Round  45, Train loss: 0.606, Test loss: 0.955, Test accuracy: 67.38
Round  45, Global train loss: 0.606, Global test loss: 2.935, Global test accuracy: 18.58
Round  46, Train loss: 0.699, Test loss: 0.943, Test accuracy: 67.78
Round  46, Global train loss: 0.699, Global test loss: 2.887, Global test accuracy: 17.82
Round  47, Train loss: 0.655, Test loss: 0.937, Test accuracy: 67.84
Round  47, Global train loss: 0.655, Global test loss: 2.678, Global test accuracy: 18.90
Round  48, Train loss: 0.599, Test loss: 0.941, Test accuracy: 67.88
Round  48, Global train loss: 0.599, Global test loss: 2.909, Global test accuracy: 20.38
Round  49, Train loss: 0.596, Test loss: 0.946, Test accuracy: 67.82
Round  49, Global train loss: 0.596, Global test loss: 2.855, Global test accuracy: 19.82
Round  50, Train loss: 0.668, Test loss: 0.938, Test accuracy: 67.86
Round  50, Global train loss: 0.668, Global test loss: 2.745, Global test accuracy: 18.67
Round  51, Train loss: 0.617, Test loss: 0.943, Test accuracy: 67.69
Round  51, Global train loss: 0.617, Global test loss: 2.836, Global test accuracy: 18.75
Round  52, Train loss: 0.646, Test loss: 0.931, Test accuracy: 68.00
Round  52, Global train loss: 0.646, Global test loss: 2.619, Global test accuracy: 19.36
Round  53, Train loss: 0.637, Test loss: 0.927, Test accuracy: 68.36
Round  53, Global train loss: 0.637, Global test loss: 2.730, Global test accuracy: 18.84
Round  54, Train loss: 0.641, Test loss: 0.926, Test accuracy: 68.90
Round  54, Global train loss: 0.641, Global test loss: 2.547, Global test accuracy: 19.34
Round  55, Train loss: 0.674, Test loss: 0.921, Test accuracy: 69.08
Round  55, Global train loss: 0.674, Global test loss: 2.576, Global test accuracy: 19.34
Round  56, Train loss: 0.566, Test loss: 0.935, Test accuracy: 69.07
Round  56, Global train loss: 0.566, Global test loss: 2.994, Global test accuracy: 20.08
Round  57, Train loss: 0.589, Test loss: 0.958, Test accuracy: 68.49
Round  57, Global train loss: 0.589, Global test loss: 2.766, Global test accuracy: 20.20
Round  58, Train loss: 0.562, Test loss: 0.957, Test accuracy: 68.57
Round  58, Global train loss: 0.562, Global test loss: 2.791, Global test accuracy: 19.88
Round  59, Train loss: 0.542, Test loss: 0.966, Test accuracy: 68.42
Round  59, Global train loss: 0.542, Global test loss: 3.480, Global test accuracy: 19.39
Round  60, Train loss: 0.594, Test loss: 0.971, Test accuracy: 67.87
Round  60, Global train loss: 0.594, Global test loss: 2.739, Global test accuracy: 19.57
Round  61, Train loss: 0.579, Test loss: 0.973, Test accuracy: 67.84
Round  61, Global train loss: 0.579, Global test loss: 3.009, Global test accuracy: 18.30
Round  62, Train loss: 0.607, Test loss: 0.991, Test accuracy: 67.64
Round  62, Global train loss: 0.607, Global test loss: 2.999, Global test accuracy: 17.58
Round  63, Train loss: 0.516, Test loss: 0.989, Test accuracy: 68.18
Round  63, Global train loss: 0.516, Global test loss: 3.230, Global test accuracy: 19.83
Round  64, Train loss: 0.485, Test loss: 0.975, Test accuracy: 68.22
Round  64, Global train loss: 0.485, Global test loss: 3.314, Global test accuracy: 19.77
Round  65, Train loss: 0.561, Test loss: 0.987, Test accuracy: 68.23
Round  65, Global train loss: 0.561, Global test loss: 2.908, Global test accuracy: 18.88
Round  66, Train loss: 0.591, Test loss: 0.990, Test accuracy: 68.52
Round  66, Global train loss: 0.591, Global test loss: 2.848, Global test accuracy: 18.81
Round  67, Train loss: 0.552, Test loss: 0.958, Test accuracy: 69.71
Round  67, Global train loss: 0.552, Global test loss: 2.742, Global test accuracy: 19.19
Round  68, Train loss: 0.551, Test loss: 0.935, Test accuracy: 70.19
Round  68, Global train loss: 0.551, Global test loss: 2.876, Global test accuracy: 16.50
Round  69, Train loss: 0.548, Test loss: 0.953, Test accuracy: 69.81
Round  69, Global train loss: 0.548, Global test loss: 2.928, Global test accuracy: 17.54
Round  70, Train loss: 0.522, Test loss: 0.970, Test accuracy: 70.16
Round  70, Global train loss: 0.522, Global test loss: 2.873, Global test accuracy: 19.98
Round  71, Train loss: 0.525, Test loss: 0.967, Test accuracy: 70.34
Round  71, Global train loss: 0.525, Global test loss: 2.854, Global test accuracy: 20.08
Round  72, Train loss: 0.512, Test loss: 0.963, Test accuracy: 70.26
Round  72, Global train loss: 0.512, Global test loss: 3.020, Global test accuracy: 19.10
Round  73, Train loss: 0.507, Test loss: 0.949, Test accuracy: 69.95
Round  73, Global train loss: 0.507, Global test loss: 2.997, Global test accuracy: 18.68
Round  74, Train loss: 0.520, Test loss: 0.963, Test accuracy: 69.87
Round  74, Global train loss: 0.520, Global test loss: 2.710, Global test accuracy: 19.29
Round  75, Train loss: 0.520, Test loss: 0.959, Test accuracy: 70.36
Round  75, Global train loss: 0.520, Global test loss: 3.024, Global test accuracy: 20.99
Round  76, Train loss: 0.475, Test loss: 0.965, Test accuracy: 70.36
Round  76, Global train loss: 0.475, Global test loss: 2.939, Global test accuracy: 19.47
Round  77, Train loss: 0.489, Test loss: 0.962, Test accuracy: 70.31
Round  77, Global train loss: 0.489, Global test loss: 3.121, Global test accuracy: 18.74
Round  78, Train loss: 0.511, Test loss: 0.958, Test accuracy: 70.48
Round  78, Global train loss: 0.511, Global test loss: 3.190, Global test accuracy: 18.98
Round  79, Train loss: 0.509, Test loss: 0.982, Test accuracy: 70.35
Round  79, Global train loss: 0.509, Global test loss: 3.087, Global test accuracy: 17.29
Round  80, Train loss: 0.497, Test loss: 0.988, Test accuracy: 70.31
Round  80, Global train loss: 0.497, Global test loss: 3.193, Global test accuracy: 19.59
Round  81, Train loss: 0.499, Test loss: 0.982, Test accuracy: 70.41
Round  81, Global train loss: 0.499, Global test loss: 3.220, Global test accuracy: 19.40
Round  82, Train loss: 0.481, Test loss: 0.979, Test accuracy: 70.51
Round  82, Global train loss: 0.481, Global test loss: 3.384, Global test accuracy: 17.60
Round  83, Train loss: 0.472, Test loss: 1.000, Test accuracy: 70.31
Round  83, Global train loss: 0.472, Global test loss: 3.280, Global test accuracy: 18.49
Round  84, Train loss: 0.448, Test loss: 0.993, Test accuracy: 70.68
Round  84, Global train loss: 0.448, Global test loss: 3.164, Global test accuracy: 20.61
Round  85, Train loss: 0.467, Test loss: 1.005, Test accuracy: 70.13
Round  85, Global train loss: 0.467, Global test loss: 3.408, Global test accuracy: 20.66
Round  86, Train loss: 0.431, Test loss: 1.001, Test accuracy: 69.90
Round  86, Global train loss: 0.431, Global test loss: 2.861, Global test accuracy: 19.52
Round  87, Train loss: 0.424, Test loss: 1.018, Test accuracy: 69.50
Round  87, Global train loss: 0.424, Global test loss: 3.104, Global test accuracy: 18.73
Round  88, Train loss: 0.482, Test loss: 1.050, Test accuracy: 69.32
Round  88, Global train loss: 0.482, Global test loss: 3.399, Global test accuracy: 20.83
Round  89, Train loss: 0.413, Test loss: 1.048, Test accuracy: 69.34
Round  89, Global train loss: 0.413, Global test loss: 3.404, Global test accuracy: 20.64
Round  90, Train loss: 0.459, Test loss: 1.030, Test accuracy: 69.75
Round  90, Global train loss: 0.459, Global test loss: 3.337, Global test accuracy: 21.82
Round  91, Train loss: 0.444, Test loss: 1.057, Test accuracy: 69.76
Round  91, Global train loss: 0.444, Global test loss: 3.474, Global test accuracy: 20.57
Round  92, Train loss: 0.429, Test loss: 1.065, Test accuracy: 70.06
Round  92, Global train loss: 0.429, Global test loss: 3.254, Global test accuracy: 19.66
Round  93, Train loss: 0.438, Test loss: 1.069, Test accuracy: 70.12
Round  93, Global train loss: 0.438, Global test loss: 3.188, Global test accuracy: 18.54
Round  94, Train loss: 0.381, Test loss: 1.095, Test accuracy: 69.75
Round  94, Global train loss: 0.381, Global test loss: 3.346, Global test accuracy: 20.99
Round  95, Train loss: 0.402, Test loss: 1.066, Test accuracy: 70.47
Round  95, Global train loss: 0.402, Global test loss: 3.364, Global test accuracy: 19.93
Round  96, Train loss: 0.408, Test loss: 1.075, Test accuracy: 69.90
Round  96, Global train loss: 0.408, Global test loss: 3.447, Global test accuracy: 18.78
Round  97, Train loss: 0.349, Test loss: 1.096, Test accuracy: 69.94
Round  97, Global train loss: 0.349, Global test loss: 3.222, Global test accuracy: 18.95
Round  98, Train loss: 0.408, Test loss: 1.084, Test accuracy: 69.89
Round  98, Global train loss: 0.408, Global test loss: 3.080, Global test accuracy: 19.13
Round  99, Train loss: 0.386, Test loss: 1.095, Test accuracy: 70.08
Round  99, Global train loss: 0.386, Global test loss: 3.266, Global test accuracy: 19.64
Final Round, Train loss: 0.315, Test loss: 1.155, Test accuracy: 70.19
Final Round, Global train loss: 0.315, Global test loss: 3.266, Global test accuracy: 19.64
Average accuracy final 10 rounds: 69.972
Average global accuracy final 10 rounds: 19.801
2632.3543961048126
[3.574038505554199, 6.763583660125732, 10.222803354263306, 13.733739137649536, 17.131754636764526, 20.56748080253601, 23.87729549407959, 27.07858395576477, 30.356053352355957, 33.81060457229614, 36.9885413646698, 40.36101698875427, 43.997299671173096, 47.30037069320679, 50.595882177352905, 53.97473692893982, 57.467562198638916, 61.037116289138794, 64.25840878486633, 67.5417492389679, 70.89148616790771, 74.19751119613647, 77.34194231033325, 80.4747269153595, 83.67790484428406, 86.92653274536133, 90.31253504753113, 93.7307755947113, 96.98634028434753, 100.34013772010803, 103.84559154510498, 107.10925650596619, 110.37706851959229, 113.61567878723145, 117.04625797271729, 120.64740657806396, 123.9895977973938, 127.4284656047821, 130.65095686912537, 134.1011254787445, 137.61753463745117, 140.80172991752625, 144.12329006195068, 147.53502225875854, 151.08461809158325, 154.62724375724792, 157.90939354896545, 161.30876088142395, 164.6304702758789, 167.96238827705383, 171.30086183547974, 174.7378933429718, 178.21488237380981, 181.4459273815155, 184.77980589866638, 188.1148648262024, 191.3292338848114, 195.18521666526794, 198.66023206710815, 202.21491765975952, 205.65789890289307, 208.95076966285706, 212.44445371627808, 215.7808976173401, 219.50327968597412, 222.8584554195404, 226.32485032081604, 229.7337338924408, 233.1213939189911, 236.5671272277832, 239.91289854049683, 243.21140933036804, 246.608300447464, 250.07520484924316, 253.28428745269775, 256.51343989372253, 259.7905795574188, 263.1597309112549, 266.46477937698364, 269.9089286327362, 273.03504180908203, 276.3482143878937, 279.5650625228882, 282.98707008361816, 286.4926805496216, 289.7872860431671, 293.3766212463379, 296.6055703163147, 299.92423152923584, 303.0920464992523, 306.3650379180908, 309.6469554901123, 312.8468403816223, 316.179559469223, 319.4848346710205, 322.7752151489258, 326.1880910396576, 329.43396401405334, 333.160120010376, 336.4936079978943, 342.66828203201294]
[20.28, 24.98, 27.82, 32.33, 35.48, 37.11, 38.14, 47.57, 49.06, 50.44, 55.56, 57.05, 58.33, 58.38, 58.39, 59.14, 59.96, 60.57, 61.57, 61.74, 61.74, 61.79, 62.1, 63.01, 62.15, 62.05, 62.24, 63.06, 62.91, 63.43, 63.65, 64.28, 63.74, 64.27, 64.89, 65.73, 65.88, 66.4, 66.59, 67.09, 67.04, 67.12, 67.29, 67.85, 67.44, 67.38, 67.78, 67.84, 67.88, 67.82, 67.86, 67.69, 68.0, 68.36, 68.9, 69.08, 69.07, 68.49, 68.57, 68.42, 67.87, 67.84, 67.64, 68.18, 68.22, 68.23, 68.52, 69.71, 70.19, 69.81, 70.16, 70.34, 70.26, 69.95, 69.87, 70.36, 70.36, 70.31, 70.48, 70.35, 70.31, 70.41, 70.51, 70.31, 70.68, 70.13, 69.9, 69.5, 69.32, 69.34, 69.75, 69.76, 70.06, 70.12, 69.75, 70.47, 69.9, 69.94, 69.89, 70.08, 70.19]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  20.3000
Round 1 global test acc  23.0800
Round 2 global test acc  21.1500
Round 3 global test acc  24.2100
Round 4 global test acc  27.1400
Round 5 global test acc  28.1000
Round 6 global test acc  32.3000
Round 7 global test acc  29.2500
Round 8 global test acc  35.0900
Round 9 global test acc  29.1300
Round 10 global test acc  34.2900
Round 11 global test acc  36.1700
Round 12 global test acc  37.2200
Round 13 global test acc  27.0400
Round 14 global test acc  30.0500
Round 15 global test acc  36.7400
Round 16 global test acc  35.6800
Round 17 global test acc  39.1000
Round 18 global test acc  38.8700
Round 19 global test acc  35.3500
Round 20 global test acc  32.8100
Round 21 global test acc  41.2800
Round 22 global test acc  32.6500
Round 23 global test acc  32.0400
Round 24 global test acc  35.0400
Round 25 global test acc  38.5300
Round 26 global test acc  39.1700
Round 27 global test acc  42.9700
Round 28 global test acc  38.8000
Round 29 global test acc  39.3100
Round 30 global test acc  43.1200
Round 31 global test acc  37.3900
Round 32 global test acc  34.2900
Round 33 global test acc  36.3900
Round 34 global test acc  38.2500
Round 35 global test acc  41.7600
Round 36 global test acc  34.0100
Round 37 global test acc  41.3100
Round 38 global test acc  38.9600
Round 39 global test acc  40.6200
Round 40 global test acc  37.1400
Round 41 global test acc  39.5100
Round 42 global test acc  44.2000
Round 43 global test acc  43.9400
Round 44 global test acc  37.5200
Round 45 global test acc  39.3400
Round 46 global test acc  37.8200
Round 47 global test acc  41.9300
Round 48 global test acc  45.1700
Round 49 global test acc  36.5500
Round 50 global test acc  43.7300
Round 51 global test acc  35.1700
Round 52 global test acc  41.5100
Round 53 global test acc  42.4500
Round 54 global test acc  37.2700
Round 55 global test acc  37.1400
Round 56 global test acc  35.5400
Round 57 global test acc  43.9800
Round 58 global test acc  47.5800
Round 59 global test acc  37.1400
Round 60 global test acc  44.5500
Round 61 global test acc  32.5400
Round 62 global test acc  49.9800
Round 63 global test acc  40.3300
Round 64 global test acc  40.8100
Round 65 global test acc  41.9100
Round 66 global test acc  38.5200
Round 67 global test acc  43.5400
Round 68 global test acc  44.1000
Round 69 global test acc  44.4600
Round 70 global test acc  45.3500
Round 71 global test acc  40.2300
Round 72 global test acc  41.9400
Round 73 global test acc  45.6300
Round 74 global test acc  35.4000
Round 75 global test acc  40.3300
Round 76 global test acc  37.0000
Round 77 global test acc  39.8800
Round 78 global test acc  39.2600
Round 79 global test acc  43.4300
Round 80 global test acc  38.9000
Round 81 global test acc  37.3500
Round 82 global test acc  36.7100
Round 83 global test acc  34.1200
Round 84 global test acc  32.8600
Round 85 global test acc  31.0600
Round 86 global test acc  30.5200
Round 87 global test acc  30.8300
Round 88 global test acc  29.9800
Round 89 global test acc  29.1200
Round 90 global test acc  29.4100
Round 91 global test acc  28.7500
Round 92 global test acc  28.2600
Round 93 global test acc  27.7500
Round 94 global test acc  27.4800
Round 95 global test acc  27.6100
Round 96 global test acc  27.3600
Round 97 global test acc  27.1600
Round 98 global test acc  27.4700
Round 99 global test acc  27.8000
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.928, Test loss: 2.233, Test accuracy: 15.08
Round   1, Train loss: 1.557, Test loss: 2.263, Test accuracy: 21.24
Round   2, Train loss: 1.470, Test loss: 1.985, Test accuracy: 25.63
Round   3, Train loss: 1.418, Test loss: 1.693, Test accuracy: 32.08
Round   4, Train loss: 1.311, Test loss: 1.629, Test accuracy: 36.47
Round   5, Train loss: 1.264, Test loss: 1.358, Test accuracy: 43.46
Round   6, Train loss: 1.244, Test loss: 1.346, Test accuracy: 44.97
Round   7, Train loss: 1.201, Test loss: 1.211, Test accuracy: 50.11
Round   8, Train loss: 1.118, Test loss: 1.151, Test accuracy: 51.84
Round   9, Train loss: 1.158, Test loss: 1.090, Test accuracy: 55.74
Round  10, Train loss: 1.071, Test loss: 1.054, Test accuracy: 56.83
Round  11, Train loss: 1.027, Test loss: 1.043, Test accuracy: 57.25
Round  12, Train loss: 1.037, Test loss: 1.046, Test accuracy: 57.12
Round  13, Train loss: 1.073, Test loss: 1.017, Test accuracy: 58.58
Round  14, Train loss: 1.009, Test loss: 0.981, Test accuracy: 59.86
Round  15, Train loss: 0.972, Test loss: 0.955, Test accuracy: 61.51
Round  16, Train loss: 0.907, Test loss: 0.945, Test accuracy: 62.26
Round  17, Train loss: 0.937, Test loss: 0.930, Test accuracy: 62.95
Round  18, Train loss: 0.979, Test loss: 0.910, Test accuracy: 63.68
Round  19, Train loss: 0.945, Test loss: 0.897, Test accuracy: 64.41
Round  20, Train loss: 0.884, Test loss: 0.879, Test accuracy: 65.18
Round  21, Train loss: 0.876, Test loss: 0.877, Test accuracy: 65.03
Round  22, Train loss: 0.898, Test loss: 0.865, Test accuracy: 65.46
Round  23, Train loss: 0.797, Test loss: 0.874, Test accuracy: 65.48
Round  24, Train loss: 0.849, Test loss: 0.842, Test accuracy: 66.88
Round  25, Train loss: 0.823, Test loss: 0.824, Test accuracy: 66.83
Round  26, Train loss: 0.799, Test loss: 0.845, Test accuracy: 66.39
Round  27, Train loss: 0.749, Test loss: 0.822, Test accuracy: 67.54
Round  28, Train loss: 0.831, Test loss: 0.805, Test accuracy: 67.80
Round  29, Train loss: 0.788, Test loss: 0.793, Test accuracy: 68.65
Round  30, Train loss: 0.805, Test loss: 0.788, Test accuracy: 68.67
Round  31, Train loss: 0.692, Test loss: 0.784, Test accuracy: 68.93
Round  32, Train loss: 0.853, Test loss: 0.776, Test accuracy: 69.36
Round  33, Train loss: 0.686, Test loss: 0.769, Test accuracy: 69.76
Round  34, Train loss: 0.679, Test loss: 0.758, Test accuracy: 69.99
Round  35, Train loss: 0.761, Test loss: 0.754, Test accuracy: 70.15
Round  36, Train loss: 0.830, Test loss: 0.753, Test accuracy: 70.21
Round  37, Train loss: 0.768, Test loss: 0.745, Test accuracy: 71.05
Round  38, Train loss: 0.689, Test loss: 0.745, Test accuracy: 70.66
Round  39, Train loss: 0.776, Test loss: 0.725, Test accuracy: 71.76
Round  40, Train loss: 0.681, Test loss: 0.722, Test accuracy: 71.72
Round  41, Train loss: 0.700, Test loss: 0.719, Test accuracy: 71.79
Round  42, Train loss: 0.754, Test loss: 0.710, Test accuracy: 71.99
Round  43, Train loss: 0.664, Test loss: 0.704, Test accuracy: 72.58
Round  44, Train loss: 0.679, Test loss: 0.691, Test accuracy: 72.94
Round  45, Train loss: 0.671, Test loss: 0.693, Test accuracy: 73.27
Round  46, Train loss: 0.639, Test loss: 0.692, Test accuracy: 73.50
Round  47, Train loss: 0.634, Test loss: 0.690, Test accuracy: 73.11
Round  48, Train loss: 0.682, Test loss: 0.690, Test accuracy: 73.36
Round  49, Train loss: 0.614, Test loss: 0.693, Test accuracy: 73.45
Round  50, Train loss: 0.668, Test loss: 0.686, Test accuracy: 73.40
Round  51, Train loss: 0.626, Test loss: 0.670, Test accuracy: 74.03
Round  52, Train loss: 0.599, Test loss: 0.661, Test accuracy: 74.45
Round  53, Train loss: 0.630, Test loss: 0.662, Test accuracy: 74.36
Round  54, Train loss: 0.649, Test loss: 0.660, Test accuracy: 74.71
Round  55, Train loss: 0.576, Test loss: 0.654, Test accuracy: 74.93
Round  56, Train loss: 0.568, Test loss: 0.662, Test accuracy: 74.61
Round  57, Train loss: 0.681, Test loss: 0.654, Test accuracy: 75.19
Round  58, Train loss: 0.608, Test loss: 0.643, Test accuracy: 75.58
Round  59, Train loss: 0.601, Test loss: 0.647, Test accuracy: 75.45
Round  60, Train loss: 0.540, Test loss: 0.639, Test accuracy: 75.80
Round  61, Train loss: 0.632, Test loss: 0.645, Test accuracy: 75.95
Round  62, Train loss: 0.537, Test loss: 0.645, Test accuracy: 75.39
Round  63, Train loss: 0.551, Test loss: 0.637, Test accuracy: 75.65
Round  64, Train loss: 0.547, Test loss: 0.632, Test accuracy: 76.35
Round  65, Train loss: 0.554, Test loss: 0.629, Test accuracy: 76.61
Round  66, Train loss: 0.508, Test loss: 0.634, Test accuracy: 76.37
Round  67, Train loss: 0.535, Test loss: 0.637, Test accuracy: 76.48
Round  68, Train loss: 0.502, Test loss: 0.628, Test accuracy: 76.33
Round  69, Train loss: 0.491, Test loss: 0.635, Test accuracy: 75.99
Round  70, Train loss: 0.453, Test loss: 0.636, Test accuracy: 76.50
Round  71, Train loss: 0.527, Test loss: 0.615, Test accuracy: 77.07
Round  72, Train loss: 0.539, Test loss: 0.634, Test accuracy: 76.56
Round  73, Train loss: 0.523, Test loss: 0.636, Test accuracy: 76.25
Round  74, Train loss: 0.528, Test loss: 0.630, Test accuracy: 76.55
Round  75, Train loss: 0.480, Test loss: 0.623, Test accuracy: 76.71
Round  76, Train loss: 0.544, Test loss: 0.616, Test accuracy: 76.76
Round  77, Train loss: 0.476, Test loss: 0.617, Test accuracy: 77.17
Round  78, Train loss: 0.457, Test loss: 0.624, Test accuracy: 77.01
Round  79, Train loss: 0.476, Test loss: 0.620, Test accuracy: 77.62
Round  80, Train loss: 0.459, Test loss: 0.627, Test accuracy: 77.12
Round  81, Train loss: 0.430, Test loss: 0.609, Test accuracy: 77.49
Round  82, Train loss: 0.470, Test loss: 0.606, Test accuracy: 77.51
Round  83, Train loss: 0.448, Test loss: 0.620, Test accuracy: 77.13
Round  84, Train loss: 0.445, Test loss: 0.619, Test accuracy: 77.59
Round  85, Train loss: 0.459, Test loss: 0.607, Test accuracy: 77.73
Round  86, Train loss: 0.406, Test loss: 0.624, Test accuracy: 77.35
Round  87, Train loss: 0.444, Test loss: 0.604, Test accuracy: 78.02
Round  88, Train loss: 0.438, Test loss: 0.608, Test accuracy: 77.78
Round  89, Train loss: 0.410, Test loss: 0.609, Test accuracy: 77.99
Round  90, Train loss: 0.439, Test loss: 0.620, Test accuracy: 77.76
Round  91, Train loss: 0.412, Test loss: 0.616, Test accuracy: 77.80
Round  92, Train loss: 0.447, Test loss: 0.614, Test accuracy: 77.68
Round  93, Train loss: 0.433, Test loss: 0.613, Test accuracy: 77.71
Round  94, Train loss: 0.464, Test loss: 0.607, Test accuracy: 77.81
Round  95, Train loss: 0.438, Test loss: 0.603, Test accuracy: 78.09
Round  96, Train loss: 0.402, Test loss: 0.610, Test accuracy: 78.07
Round  97, Train loss: 0.444, Test loss: 0.612, Test accuracy: 77.46
Round  98, Train loss: 0.392, Test loss: 0.605, Test accuracy: 77.77
Round  99, Train loss: 0.403, Test loss: 0.612, Test accuracy: 77.68
Final Round, Train loss: 0.349, Test loss: 0.613, Test accuracy: 77.98
Average accuracy final 10 rounds: 77.783
1328.733512878418
[2.014753818511963, 3.637880802154541, 5.378561735153198, 7.040611982345581, 8.731139898300171, 10.399837970733643, 12.144529342651367, 14.189040422439575, 15.898815393447876, 17.536355018615723, 19.216926097869873, 20.931008100509644, 22.59447193145752, 24.389013051986694, 26.018718957901, 27.8438663482666, 29.63507318496704, 31.437718391418457, 33.07995319366455, 34.815327405929565, 36.581443071365356, 38.34259915351868, 40.05124545097351, 41.82109522819519, 43.61373281478882, 45.5135452747345, 47.34614562988281, 49.040042877197266, 50.72156858444214, 52.464325189590454, 54.324960231781006, 56.17338562011719, 57.80444836616516, 59.47846841812134, 61.20384740829468, 62.86460590362549, 64.82020330429077, 66.51160311698914, 68.34657120704651, 70.14287900924683, 71.92898511886597, 73.6305513381958, 75.33315777778625, 77.00057768821716, 78.83515453338623, 80.664231300354, 82.42521238327026, 84.23558115959167, 85.95558714866638, 87.76341533660889, 89.56385612487793, 91.29147148132324, 93.03116965293884, 94.73059153556824, 96.4504566192627, 98.19559788703918, 99.93239521980286, 101.64681601524353, 103.38421416282654, 105.07381057739258, 106.82691788673401, 108.50583243370056, 110.25361227989197, 111.95166325569153, 113.68590641021729, 115.51082992553711, 117.36925172805786, 119.08625435829163, 120.796217918396, 122.47591495513916, 124.32136249542236, 126.04379773139954, 127.65337991714478, 129.52405881881714, 131.33826303482056, 133.08404994010925, 134.9762260913849, 136.65031671524048, 138.48016238212585, 140.23286843299866, 142.12865543365479, 143.78144645690918, 145.4925401210785, 147.2951204776764, 149.02434062957764, 150.86500310897827, 152.6749062538147, 154.50100922584534, 156.2144491672516, 157.84389328956604, 159.71118450164795, 161.37488222122192, 163.2980499267578, 164.94650673866272, 166.69630885124207, 168.44585466384888, 170.1015019416809, 171.71959161758423, 173.51479578018188, 175.2030119895935, 177.7980637550354]
[15.08, 21.24, 25.63, 32.08, 36.47, 43.46, 44.97, 50.11, 51.84, 55.74, 56.83, 57.25, 57.12, 58.58, 59.86, 61.51, 62.26, 62.95, 63.68, 64.41, 65.18, 65.03, 65.46, 65.48, 66.88, 66.83, 66.39, 67.54, 67.8, 68.65, 68.67, 68.93, 69.36, 69.76, 69.99, 70.15, 70.21, 71.05, 70.66, 71.76, 71.72, 71.79, 71.99, 72.58, 72.94, 73.27, 73.5, 73.11, 73.36, 73.45, 73.4, 74.03, 74.45, 74.36, 74.71, 74.93, 74.61, 75.19, 75.58, 75.45, 75.8, 75.95, 75.39, 75.65, 76.35, 76.61, 76.37, 76.48, 76.33, 75.99, 76.5, 77.07, 76.56, 76.25, 76.55, 76.71, 76.76, 77.17, 77.01, 77.62, 77.12, 77.49, 77.51, 77.13, 77.59, 77.73, 77.35, 78.02, 77.78, 77.99, 77.76, 77.8, 77.68, 77.71, 77.81, 78.09, 78.07, 77.46, 77.77, 77.68, 77.98]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.581, Test loss: 2.201, Test accuracy: 19.74
Round   0, Global train loss: 1.581, Global test loss: 2.452, Global test accuracy: 13.25
Round   1, Train loss: 1.422, Test loss: 2.009, Test accuracy: 27.97
Round   1, Global train loss: 1.422, Global test loss: 2.527, Global test accuracy: 13.70
Round   2, Train loss: 1.349, Test loss: 1.555, Test accuracy: 37.73
Round   2, Global train loss: 1.349, Global test loss: 2.316, Global test accuracy: 15.01
Round   3, Train loss: 1.324, Test loss: 1.360, Test accuracy: 44.15
Round   3, Global train loss: 1.324, Global test loss: 2.384, Global test accuracy: 12.49
Round   4, Train loss: 1.247, Test loss: 1.350, Test accuracy: 45.63
Round   4, Global train loss: 1.247, Global test loss: 2.520, Global test accuracy: 15.64
Round   5, Train loss: 1.205, Test loss: 1.234, Test accuracy: 49.38
Round   5, Global train loss: 1.205, Global test loss: 2.277, Global test accuracy: 16.30
Round   6, Train loss: 1.118, Test loss: 1.218, Test accuracy: 50.32
Round   6, Global train loss: 1.118, Global test loss: 2.391, Global test accuracy: 15.87
Round   7, Train loss: 1.107, Test loss: 1.117, Test accuracy: 54.26
Round   7, Global train loss: 1.107, Global test loss: 2.441, Global test accuracy: 15.37
Round   8, Train loss: 1.115, Test loss: 1.100, Test accuracy: 55.07
Round   8, Global train loss: 1.115, Global test loss: 2.469, Global test accuracy: 14.83
Round   9, Train loss: 1.156, Test loss: 1.077, Test accuracy: 56.34
Round   9, Global train loss: 1.156, Global test loss: 2.564, Global test accuracy: 14.31
Round  10, Train loss: 1.083, Test loss: 1.079, Test accuracy: 56.62
Round  10, Global train loss: 1.083, Global test loss: 2.398, Global test accuracy: 16.14
Round  11, Train loss: 1.068, Test loss: 1.056, Test accuracy: 57.69
Round  11, Global train loss: 1.068, Global test loss: 2.421, Global test accuracy: 17.25
Round  12, Train loss: 1.052, Test loss: 1.038, Test accuracy: 58.56
Round  12, Global train loss: 1.052, Global test loss: 2.425, Global test accuracy: 17.65
Round  13, Train loss: 0.990, Test loss: 1.019, Test accuracy: 59.73
Round  13, Global train loss: 0.990, Global test loss: 2.582, Global test accuracy: 16.31
Round  14, Train loss: 0.953, Test loss: 1.012, Test accuracy: 60.13
Round  14, Global train loss: 0.953, Global test loss: 2.513, Global test accuracy: 15.91
Round  15, Train loss: 0.957, Test loss: 1.011, Test accuracy: 59.88
Round  15, Global train loss: 0.957, Global test loss: 2.757, Global test accuracy: 15.76
Round  16, Train loss: 0.958, Test loss: 0.993, Test accuracy: 60.94
Round  16, Global train loss: 0.958, Global test loss: 2.390, Global test accuracy: 16.28
Round  17, Train loss: 0.993, Test loss: 0.972, Test accuracy: 61.94
Round  17, Global train loss: 0.993, Global test loss: 2.479, Global test accuracy: 18.51
Round  18, Train loss: 0.929, Test loss: 0.943, Test accuracy: 62.84
Round  18, Global train loss: 0.929, Global test loss: 2.389, Global test accuracy: 18.31
Round  19, Train loss: 0.973, Test loss: 0.933, Test accuracy: 63.40
Round  19, Global train loss: 0.973, Global test loss: 2.402, Global test accuracy: 17.89
Round  20, Train loss: 0.893, Test loss: 0.932, Test accuracy: 63.86
Round  20, Global train loss: 0.893, Global test loss: 2.491, Global test accuracy: 17.30
Round  21, Train loss: 0.886, Test loss: 0.924, Test accuracy: 64.41
Round  21, Global train loss: 0.886, Global test loss: 2.896, Global test accuracy: 16.47
Round  22, Train loss: 0.868, Test loss: 0.926, Test accuracy: 64.28
Round  22, Global train loss: 0.868, Global test loss: 2.418, Global test accuracy: 18.53
Round  23, Train loss: 0.836, Test loss: 0.925, Test accuracy: 64.59
Round  23, Global train loss: 0.836, Global test loss: 2.483, Global test accuracy: 16.61
Round  24, Train loss: 0.809, Test loss: 0.927, Test accuracy: 64.90
Round  24, Global train loss: 0.809, Global test loss: 2.387, Global test accuracy: 16.35
Round  25, Train loss: 0.845, Test loss: 0.935, Test accuracy: 64.84
Round  25, Global train loss: 0.845, Global test loss: 2.645, Global test accuracy: 18.55
Round  26, Train loss: 0.859, Test loss: 0.925, Test accuracy: 65.18
Round  26, Global train loss: 0.859, Global test loss: 2.495, Global test accuracy: 17.81
Round  27, Train loss: 0.818, Test loss: 0.913, Test accuracy: 65.78
Round  27, Global train loss: 0.818, Global test loss: 2.389, Global test accuracy: 17.72
Round  28, Train loss: 0.775, Test loss: 0.904, Test accuracy: 66.12
Round  28, Global train loss: 0.775, Global test loss: 2.512, Global test accuracy: 18.90
Round  29, Train loss: 0.742, Test loss: 0.910, Test accuracy: 66.15
Round  29, Global train loss: 0.742, Global test loss: 2.608, Global test accuracy: 16.88
Round  30, Train loss: 0.770, Test loss: 0.899, Test accuracy: 66.64
Round  30, Global train loss: 0.770, Global test loss: 2.463, Global test accuracy: 18.37
Round  31, Train loss: 0.774, Test loss: 0.892, Test accuracy: 67.00
Round  31, Global train loss: 0.774, Global test loss: 2.482, Global test accuracy: 18.63
Round  32, Train loss: 0.742, Test loss: 0.874, Test accuracy: 67.38
Round  32, Global train loss: 0.742, Global test loss: 2.619, Global test accuracy: 16.67
Round  33, Train loss: 0.722, Test loss: 0.865, Test accuracy: 68.05
Round  33, Global train loss: 0.722, Global test loss: 2.626, Global test accuracy: 19.18
Round  34, Train loss: 0.772, Test loss: 0.864, Test accuracy: 68.07
Round  34, Global train loss: 0.772, Global test loss: 2.480, Global test accuracy: 19.11
Round  35, Train loss: 0.731, Test loss: 0.866, Test accuracy: 67.68
Round  35, Global train loss: 0.731, Global test loss: 2.539, Global test accuracy: 18.21
Round  36, Train loss: 0.704, Test loss: 0.869, Test accuracy: 67.78
Round  36, Global train loss: 0.704, Global test loss: 2.611, Global test accuracy: 20.03
Round  37, Train loss: 0.749, Test loss: 0.875, Test accuracy: 67.86
Round  37, Global train loss: 0.749, Global test loss: 2.596, Global test accuracy: 16.54
Round  38, Train loss: 0.639, Test loss: 0.873, Test accuracy: 67.92
Round  38, Global train loss: 0.639, Global test loss: 2.788, Global test accuracy: 18.20
Round  39, Train loss: 0.652, Test loss: 0.871, Test accuracy: 68.14
Round  39, Global train loss: 0.652, Global test loss: 2.666, Global test accuracy: 19.16
Round  40, Train loss: 0.648, Test loss: 0.870, Test accuracy: 68.89
Round  40, Global train loss: 0.648, Global test loss: 2.652, Global test accuracy: 18.44
Round  41, Train loss: 0.715, Test loss: 0.875, Test accuracy: 69.04
Round  41, Global train loss: 0.715, Global test loss: 2.684, Global test accuracy: 17.29
Round  42, Train loss: 0.568, Test loss: 0.884, Test accuracy: 68.45
Round  42, Global train loss: 0.568, Global test loss: 2.762, Global test accuracy: 18.59
Round  43, Train loss: 0.680, Test loss: 0.899, Test accuracy: 68.12
Round  43, Global train loss: 0.680, Global test loss: 2.577, Global test accuracy: 18.40
Round  44, Train loss: 0.670, Test loss: 0.895, Test accuracy: 68.68
Round  44, Global train loss: 0.670, Global test loss: 2.626, Global test accuracy: 18.46
Round  45, Train loss: 0.588, Test loss: 0.881, Test accuracy: 69.29
Round  45, Global train loss: 0.588, Global test loss: 2.795, Global test accuracy: 17.98
Round  46, Train loss: 0.711, Test loss: 0.895, Test accuracy: 68.97
Round  46, Global train loss: 0.711, Global test loss: 2.543, Global test accuracy: 18.67
Round  47, Train loss: 0.550, Test loss: 0.905, Test accuracy: 68.55
Round  47, Global train loss: 0.550, Global test loss: 2.761, Global test accuracy: 17.10
Round  48, Train loss: 0.563, Test loss: 0.905, Test accuracy: 68.79
Round  48, Global train loss: 0.563, Global test loss: 2.921, Global test accuracy: 16.45
Round  49, Train loss: 0.593, Test loss: 0.912, Test accuracy: 68.75
Round  49, Global train loss: 0.593, Global test loss: 2.810, Global test accuracy: 16.21
Round  50, Train loss: 0.618, Test loss: 0.902, Test accuracy: 69.15
Round  50, Global train loss: 0.618, Global test loss: 2.801, Global test accuracy: 18.07
Round  51, Train loss: 0.618, Test loss: 0.898, Test accuracy: 69.51
Round  51, Global train loss: 0.618, Global test loss: 2.691, Global test accuracy: 18.50
Round  52, Train loss: 0.565, Test loss: 0.912, Test accuracy: 69.39
Round  52, Global train loss: 0.565, Global test loss: 2.663, Global test accuracy: 16.62
Round  53, Train loss: 0.579, Test loss: 0.886, Test accuracy: 70.10
Round  53, Global train loss: 0.579, Global test loss: 2.708, Global test accuracy: 17.53
Round  54, Train loss: 0.582, Test loss: 0.902, Test accuracy: 69.87
Round  54, Global train loss: 0.582, Global test loss: 2.845, Global test accuracy: 19.51
Round  55, Train loss: 0.595, Test loss: 0.894, Test accuracy: 70.66
Round  55, Global train loss: 0.595, Global test loss: 2.743, Global test accuracy: 16.91
Round  56, Train loss: 0.579, Test loss: 0.897, Test accuracy: 70.47
Round  56, Global train loss: 0.579, Global test loss: 2.913, Global test accuracy: 18.73
Round  57, Train loss: 0.580, Test loss: 0.916, Test accuracy: 70.21
Round  57, Global train loss: 0.580, Global test loss: 2.940, Global test accuracy: 19.05
Round  58, Train loss: 0.526, Test loss: 0.923, Test accuracy: 70.58
Round  58, Global train loss: 0.526, Global test loss: 3.020, Global test accuracy: 18.65
Round  59, Train loss: 0.538, Test loss: 0.927, Test accuracy: 70.41
Round  59, Global train loss: 0.538, Global test loss: 2.979, Global test accuracy: 17.20
Round  60, Train loss: 0.474, Test loss: 0.936, Test accuracy: 70.26
Round  60, Global train loss: 0.474, Global test loss: 2.944, Global test accuracy: 18.67
Round  61, Train loss: 0.517, Test loss: 0.924, Test accuracy: 70.54
Round  61, Global train loss: 0.517, Global test loss: 2.897, Global test accuracy: 18.44
Round  62, Train loss: 0.513, Test loss: 0.931, Test accuracy: 70.26
Round  62, Global train loss: 0.513, Global test loss: 3.129, Global test accuracy: 16.99
Round  63, Train loss: 0.433, Test loss: 0.925, Test accuracy: 70.32
Round  63, Global train loss: 0.433, Global test loss: 2.995, Global test accuracy: 17.62
Round  64, Train loss: 0.449, Test loss: 0.919, Test accuracy: 70.19
Round  64, Global train loss: 0.449, Global test loss: 3.465, Global test accuracy: 16.38
Round  65, Train loss: 0.519, Test loss: 0.931, Test accuracy: 70.34
Round  65, Global train loss: 0.519, Global test loss: 2.981, Global test accuracy: 18.54
Round  66, Train loss: 0.492, Test loss: 0.940, Test accuracy: 70.84
Round  66, Global train loss: 0.492, Global test loss: 2.952, Global test accuracy: 19.25
Round  67, Train loss: 0.509, Test loss: 0.969, Test accuracy: 70.00
Round  67, Global train loss: 0.509, Global test loss: 2.851, Global test accuracy: 19.34
Round  68, Train loss: 0.471, Test loss: 0.991, Test accuracy: 69.54
Round  68, Global train loss: 0.471, Global test loss: 3.138, Global test accuracy: 16.96
Round  69, Train loss: 0.529, Test loss: 0.996, Test accuracy: 69.69
Round  69, Global train loss: 0.529, Global test loss: 3.148, Global test accuracy: 18.92
Round  70, Train loss: 0.555, Test loss: 0.985, Test accuracy: 70.22
Round  70, Global train loss: 0.555, Global test loss: 2.799, Global test accuracy: 19.42
Round  71, Train loss: 0.531, Test loss: 0.982, Test accuracy: 70.07
Round  71, Global train loss: 0.531, Global test loss: 3.075, Global test accuracy: 18.23
Round  72, Train loss: 0.527, Test loss: 0.972, Test accuracy: 70.45
Round  72, Global train loss: 0.527, Global test loss: 2.849, Global test accuracy: 17.79
Round  73, Train loss: 0.485, Test loss: 0.970, Test accuracy: 70.95
Round  73, Global train loss: 0.485, Global test loss: 3.056, Global test accuracy: 16.82
Round  74, Train loss: 0.413, Test loss: 0.990, Test accuracy: 70.65
Round  74, Global train loss: 0.413, Global test loss: 3.258, Global test accuracy: 16.58
Round  75, Train loss: 0.438, Test loss: 1.001, Test accuracy: 70.63
Round  75, Global train loss: 0.438, Global test loss: 3.044, Global test accuracy: 17.25
Round  76, Train loss: 0.515, Test loss: 0.987, Test accuracy: 70.93
Round  76, Global train loss: 0.515, Global test loss: 2.912, Global test accuracy: 19.62
Round  77, Train loss: 0.452, Test loss: 0.962, Test accuracy: 71.18
Round  77, Global train loss: 0.452, Global test loss: 3.252, Global test accuracy: 18.11
Round  78, Train loss: 0.448, Test loss: 0.953, Test accuracy: 71.24
Round  78, Global train loss: 0.448, Global test loss: 3.208, Global test accuracy: 19.63
Round  79, Train loss: 0.497, Test loss: 0.942, Test accuracy: 71.42
Round  79, Global train loss: 0.497, Global test loss: 3.156, Global test accuracy: 16.62
Round  80, Train loss: 0.438, Test loss: 0.954, Test accuracy: 71.03
Round  80, Global train loss: 0.438, Global test loss: 3.153, Global test accuracy: 19.26
Round  81, Train loss: 0.432, Test loss: 0.982, Test accuracy: 70.49
Round  81, Global train loss: 0.432, Global test loss: 2.989, Global test accuracy: 17.15
Round  82, Train loss: 0.452, Test loss: 0.990, Test accuracy: 70.75
Round  82, Global train loss: 0.452, Global test loss: 2.912, Global test accuracy: 17.82
Round  83, Train loss: 0.461, Test loss: 1.014, Test accuracy: 70.32
Round  83, Global train loss: 0.461, Global test loss: 3.201, Global test accuracy: 19.29
Round  84, Train loss: 0.434, Test loss: 1.016, Test accuracy: 70.42
Round  84, Global train loss: 0.434, Global test loss: 2.924, Global test accuracy: 19.00
Round  85, Train loss: 0.404, Test loss: 1.015, Test accuracy: 70.78
Round  85, Global train loss: 0.404, Global test loss: 3.192, Global test accuracy: 16.10
Round  86, Train loss: 0.408, Test loss: 1.037, Test accuracy: 70.30
Round  86, Global train loss: 0.408, Global test loss: 3.256, Global test accuracy: 17.99
Round  87, Train loss: 0.379, Test loss: 1.049, Test accuracy: 70.26
Round  87, Global train loss: 0.379, Global test loss: 3.125, Global test accuracy: 16.82
Round  88, Train loss: 0.391, Test loss: 1.038, Test accuracy: 70.35
Round  88, Global train loss: 0.391, Global test loss: 3.139, Global test accuracy: 19.84
Round  89, Train loss: 0.393, Test loss: 1.020, Test accuracy: 70.56
Round  89, Global train loss: 0.393, Global test loss: 3.339, Global test accuracy: 16.44
Round  90, Train loss: 0.450, Test loss: 0.987, Test accuracy: 70.91
Round  90, Global train loss: 0.450, Global test loss: 3.102, Global test accuracy: 18.11
Round  91, Train loss: 0.427, Test loss: 1.017, Test accuracy: 70.63
Round  91, Global train loss: 0.427, Global test loss: 3.233, Global test accuracy: 16.10
Round  92, Train loss: 0.406, Test loss: 1.039, Test accuracy: 70.52
Round  92, Global train loss: 0.406, Global test loss: 3.364, Global test accuracy: 18.32
Round  93, Train loss: 0.429, Test loss: 1.046, Test accuracy: 70.56
Round  93, Global train loss: 0.429, Global test loss: 3.000, Global test accuracy: 19.52
Round  94, Train loss: 0.373, Test loss: 1.058, Test accuracy: 70.44
Round  94, Global train loss: 0.373, Global test loss: 3.367, Global test accuracy: 17.44
Round  95, Train loss: 0.384, Test loss: 1.071, Test accuracy: 70.27
Round  95, Global train loss: 0.384, Global test loss: 3.355, Global test accuracy: 17.43
Round  96, Train loss: 0.382, Test loss: 1.067, Test accuracy: 70.68
Round  96, Global train loss: 0.382, Global test loss: 3.617, Global test accuracy: 19.30
Round  97, Train loss: 0.423, Test loss: 1.029, Test accuracy: 71.05
Round  97, Global train loss: 0.423, Global test loss: 3.018, Global test accuracy: 19.95
Round  98, Train loss: 0.380, Test loss: 1.014, Test accuracy: 71.15
Round  98, Global train loss: 0.380, Global test loss: 3.181, Global test accuracy: 19.51
Round  99, Train loss: 0.380, Test loss: 1.011, Test accuracy: 71.45
Round  99, Global train loss: 0.380, Global test loss: 3.433, Global test accuracy: 18.10
Final Round, Train loss: 0.298, Test loss: 1.156, Test accuracy: 70.73
Final Round, Global train loss: 0.298, Global test loss: 3.433, Global test accuracy: 18.10
Average accuracy final 10 rounds: 70.76599999999999
Average global accuracy final 10 rounds: 18.377999999999997
2371.7021338939667
[1.841181755065918, 3.2199747562408447, 4.664382696151733, 6.137118339538574, 7.7075135707855225, 9.067416906356812, 10.585601568222046, 12.069502353668213, 13.52650785446167, 15.10104775428772, 16.69591450691223, 18.084198474884033, 19.56221294403076, 21.07956862449646, 22.55760431289673, 24.04747176170349, 25.55313515663147, 26.987065076828003, 28.41682481765747, 29.797444581985474, 31.2522132396698, 34.4232017993927, 37.63160419464111, 40.8820378780365, 44.015721559524536, 47.465784549713135, 50.65153479576111, 53.780290842056274, 57.00935244560242, 60.24556636810303, 63.51354455947876, 66.85135197639465, 70.2567720413208, 73.37583112716675, 76.97917103767395, 80.3847587108612, 83.93751215934753, 87.57364153862, 90.96726584434509, 94.4027304649353, 97.82966899871826, 101.33479189872742, 104.89794707298279, 108.4154920578003, 112.00109529495239, 115.51966643333435, 119.16454100608826, 122.74389410018921, 126.25589871406555, 129.6824769973755, 133.08972573280334, 136.5947825908661, 139.97209000587463, 143.46307492256165, 146.8512008190155, 150.29216051101685, 153.73602604866028, 157.3179292678833, 160.70080852508545, 164.22443342208862, 167.68770790100098, 171.03219771385193, 174.49704933166504, 177.93436193466187, 181.37250113487244, 184.9264075756073, 188.50665950775146, 192.1133530139923, 195.65961623191833, 199.0108551979065, 202.5850751399994, 205.93007254600525, 209.28217148780823, 212.86470317840576, 216.34512376785278, 219.74837446212769, 223.23929834365845, 226.85600543022156, 230.39014077186584, 233.96796989440918, 237.37642979621887, 240.89081835746765, 244.43137502670288, 247.85355281829834, 251.31267666816711, 254.67523169517517, 258.14259576797485, 261.6572976112366, 264.9640350341797, 268.28121161460876, 271.8181185722351, 275.3317437171936, 278.797575712204, 282.235671043396, 285.82569193840027, 289.4218089580536, 292.97954201698303, 296.4659774303436, 300.04974126815796, 303.6930778026581, 306.7501919269562]
[19.74, 27.97, 37.73, 44.15, 45.63, 49.38, 50.32, 54.26, 55.07, 56.34, 56.62, 57.69, 58.56, 59.73, 60.13, 59.88, 60.94, 61.94, 62.84, 63.4, 63.86, 64.41, 64.28, 64.59, 64.9, 64.84, 65.18, 65.78, 66.12, 66.15, 66.64, 67.0, 67.38, 68.05, 68.07, 67.68, 67.78, 67.86, 67.92, 68.14, 68.89, 69.04, 68.45, 68.12, 68.68, 69.29, 68.97, 68.55, 68.79, 68.75, 69.15, 69.51, 69.39, 70.1, 69.87, 70.66, 70.47, 70.21, 70.58, 70.41, 70.26, 70.54, 70.26, 70.32, 70.19, 70.34, 70.84, 70.0, 69.54, 69.69, 70.22, 70.07, 70.45, 70.95, 70.65, 70.63, 70.93, 71.18, 71.24, 71.42, 71.03, 70.49, 70.75, 70.32, 70.42, 70.78, 70.3, 70.26, 70.35, 70.56, 70.91, 70.63, 70.52, 70.56, 70.44, 70.27, 70.68, 71.05, 71.15, 71.45, 70.73]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: none, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.467, Test loss: 1.230, Test accuracy: 48.94
Round   0, Global train loss: 1.467, Global test loss: 2.288, Global test accuracy: 12.36
Round   1, Train loss: 1.259, Test loss: 1.131, Test accuracy: 54.38
Round   1, Global train loss: 1.259, Global test loss: 2.256, Global test accuracy: 14.77
Round   2, Train loss: 1.140, Test loss: 1.078, Test accuracy: 56.59
Round   2, Global train loss: 1.140, Global test loss: 2.252, Global test accuracy: 15.68
Round   3, Train loss: 1.065, Test loss: 1.020, Test accuracy: 59.60
Round   3, Global train loss: 1.065, Global test loss: 2.278, Global test accuracy: 15.83
Round   4, Train loss: 1.011, Test loss: 1.022, Test accuracy: 60.15
Round   4, Global train loss: 1.011, Global test loss: 2.290, Global test accuracy: 15.91
Round   5, Train loss: 0.962, Test loss: 1.002, Test accuracy: 61.33
Round   5, Global train loss: 0.962, Global test loss: 2.288, Global test accuracy: 16.54
Round   6, Train loss: 0.920, Test loss: 0.970, Test accuracy: 62.87
Round   6, Global train loss: 0.920, Global test loss: 2.294, Global test accuracy: 16.99
Round   7, Train loss: 0.877, Test loss: 0.951, Test accuracy: 64.30
Round   7, Global train loss: 0.877, Global test loss: 2.299, Global test accuracy: 17.20
Round   8, Train loss: 0.838, Test loss: 0.961, Test accuracy: 64.57
Round   8, Global train loss: 0.838, Global test loss: 2.320, Global test accuracy: 17.57
Round   9, Train loss: 0.797, Test loss: 0.978, Test accuracy: 64.42
Round   9, Global train loss: 0.797, Global test loss: 2.326, Global test accuracy: 17.58
Round  10, Train loss: 0.774, Test loss: 0.967, Test accuracy: 64.98
Round  10, Global train loss: 0.774, Global test loss: 2.728, Global test accuracy: 16.30
Round  11, Train loss: 0.699, Test loss: 0.970, Test accuracy: 65.32
Round  11, Global train loss: 0.699, Global test loss: 2.694, Global test accuracy: 17.50
Round  12, Train loss: 0.747, Test loss: 0.971, Test accuracy: 65.58
Round  12, Global train loss: 0.747, Global test loss: 2.682, Global test accuracy: 16.15
Round  13, Train loss: 0.624, Test loss: 0.983, Test accuracy: 65.81
Round  13, Global train loss: 0.624, Global test loss: 2.839, Global test accuracy: 17.34
Round  14, Train loss: 0.611, Test loss: 0.958, Test accuracy: 66.59
Round  14, Global train loss: 0.611, Global test loss: 3.010, Global test accuracy: 16.28
Round  15, Train loss: 0.587, Test loss: 0.979, Test accuracy: 66.67
Round  15, Global train loss: 0.587, Global test loss: 3.011, Global test accuracy: 16.74
Round  16, Train loss: 0.603, Test loss: 0.986, Test accuracy: 66.74
Round  16, Global train loss: 0.603, Global test loss: 3.329, Global test accuracy: 15.88
Round  17, Train loss: 0.609, Test loss: 0.992, Test accuracy: 66.87
Round  17, Global train loss: 0.609, Global test loss: 3.373, Global test accuracy: 16.63
Round  18, Train loss: 0.541, Test loss: 1.016, Test accuracy: 67.16
Round  18, Global train loss: 0.541, Global test loss: 3.527, Global test accuracy: 14.41
Round  19, Train loss: 0.524, Test loss: 1.014, Test accuracy: 67.70
Round  19, Global train loss: 0.524, Global test loss: 3.364, Global test accuracy: 17.19
Round  20, Train loss: 0.528, Test loss: 1.031, Test accuracy: 67.96
Round  20, Global train loss: 0.528, Global test loss: 3.067, Global test accuracy: 16.59
Round  21, Train loss: 0.518, Test loss: 1.026, Test accuracy: 68.02
Round  21, Global train loss: 0.518, Global test loss: 2.920, Global test accuracy: 16.91
Round  22, Train loss: 0.572, Test loss: 1.027, Test accuracy: 68.17
Round  22, Global train loss: 0.572, Global test loss: 2.887, Global test accuracy: 16.46
Round  23, Train loss: 0.548, Test loss: 1.036, Test accuracy: 68.81
Round  23, Global train loss: 0.548, Global test loss: 2.780, Global test accuracy: 16.62
Round  24, Train loss: 0.440, Test loss: 1.044, Test accuracy: 68.63
Round  24, Global train loss: 0.440, Global test loss: 3.357, Global test accuracy: 16.22
Round  25, Train loss: 0.555, Test loss: 1.050, Test accuracy: 68.68
Round  25, Global train loss: 0.555, Global test loss: 2.859, Global test accuracy: 16.40
Round  26, Train loss: 0.450, Test loss: 1.062, Test accuracy: 68.78
Round  26, Global train loss: 0.450, Global test loss: 3.508, Global test accuracy: 15.54
Round  27, Train loss: 0.470, Test loss: 1.077, Test accuracy: 68.94
Round  27, Global train loss: 0.470, Global test loss: 3.188, Global test accuracy: 15.57
Round  28, Train loss: 0.458, Test loss: 1.058, Test accuracy: 69.68
Round  28, Global train loss: 0.458, Global test loss: 3.378, Global test accuracy: 16.47
Round  29, Train loss: 0.440, Test loss: 1.067, Test accuracy: 69.87
Round  29, Global train loss: 0.440, Global test loss: 3.181, Global test accuracy: 15.66
Round  30, Train loss: 0.399, Test loss: 1.083, Test accuracy: 69.89
Round  30, Global train loss: 0.399, Global test loss: 3.472, Global test accuracy: 16.57
Round  31, Train loss: 0.407, Test loss: 1.123, Test accuracy: 69.40
Round  31, Global train loss: 0.407, Global test loss: 3.213, Global test accuracy: 17.09
Round  32, Train loss: 0.410, Test loss: 1.120, Test accuracy: 69.06
Round  32, Global train loss: 0.410, Global test loss: 3.324, Global test accuracy: 17.10
Round  33, Train loss: 0.402, Test loss: 1.145, Test accuracy: 69.25
Round  33, Global train loss: 0.402, Global test loss: 3.502, Global test accuracy: 15.59
Round  34, Train loss: 0.431, Test loss: 1.131, Test accuracy: 69.54
Round  34, Global train loss: 0.431, Global test loss: 3.192, Global test accuracy: 16.73
Round  35, Train loss: 0.372, Test loss: 1.154, Test accuracy: 68.83
Round  35, Global train loss: 0.372, Global test loss: 3.514, Global test accuracy: 16.53
Round  36, Train loss: 0.369, Test loss: 1.143, Test accuracy: 69.35
Round  36, Global train loss: 0.369, Global test loss: 3.553, Global test accuracy: 15.74
Round  37, Train loss: 0.361, Test loss: 1.176, Test accuracy: 69.15
Round  37, Global train loss: 0.361, Global test loss: 3.627, Global test accuracy: 15.03
Round  38, Train loss: 0.363, Test loss: 1.157, Test accuracy: 69.60
Round  38, Global train loss: 0.363, Global test loss: 3.689, Global test accuracy: 15.87
Round  39, Train loss: 0.358, Test loss: 1.165, Test accuracy: 70.10
Round  39, Global train loss: 0.358, Global test loss: 3.493, Global test accuracy: 16.82
Round  40, Train loss: 0.419, Test loss: 1.179, Test accuracy: 70.07
Round  40, Global train loss: 0.419, Global test loss: 3.451, Global test accuracy: 15.96
Round  41, Train loss: 0.376, Test loss: 1.201, Test accuracy: 69.70
Round  41, Global train loss: 0.376, Global test loss: 3.264, Global test accuracy: 15.31
Round  42, Train loss: 0.293, Test loss: 1.207, Test accuracy: 69.64
Round  42, Global train loss: 0.293, Global test loss: 3.670, Global test accuracy: 15.77
Round  43, Train loss: 0.354, Test loss: 1.200, Test accuracy: 69.89
Round  43, Global train loss: 0.354, Global test loss: 3.519, Global test accuracy: 16.19
Round  44, Train loss: 0.359, Test loss: 1.207, Test accuracy: 70.30
Round  44, Global train loss: 0.359, Global test loss: 3.386, Global test accuracy: 15.92
Round  45, Train loss: 0.306, Test loss: 1.224, Test accuracy: 70.05
Round  45, Global train loss: 0.306, Global test loss: 4.112, Global test accuracy: 15.78
Round  46, Train loss: 0.357, Test loss: 1.226, Test accuracy: 70.17
Round  46, Global train loss: 0.357, Global test loss: 3.327, Global test accuracy: 15.30
Round  47, Train loss: 0.312, Test loss: 1.255, Test accuracy: 69.93
Round  47, Global train loss: 0.312, Global test loss: 3.569, Global test accuracy: 15.30
Round  48, Train loss: 0.337, Test loss: 1.261, Test accuracy: 69.82
Round  48, Global train loss: 0.337, Global test loss: 3.840, Global test accuracy: 15.03
Round  49, Train loss: 0.317, Test loss: 1.241, Test accuracy: 70.38
Round  49, Global train loss: 0.317, Global test loss: 3.530, Global test accuracy: 15.84
Round  50, Train loss: 0.286, Test loss: 1.250, Test accuracy: 70.40
Round  50, Global train loss: 0.286, Global test loss: 3.717, Global test accuracy: 14.67
Round  51, Train loss: 0.281, Test loss: 1.270, Test accuracy: 70.17
Round  51, Global train loss: 0.281, Global test loss: 3.763, Global test accuracy: 15.72
Round  52, Train loss: 0.297, Test loss: 1.309, Test accuracy: 70.07
Round  52, Global train loss: 0.297, Global test loss: 4.090, Global test accuracy: 15.39
Round  53, Train loss: 0.267, Test loss: 1.308, Test accuracy: 70.37
Round  53, Global train loss: 0.267, Global test loss: 4.362, Global test accuracy: 15.68
Round  54, Train loss: 0.322, Test loss: 1.309, Test accuracy: 70.19
Round  54, Global train loss: 0.322, Global test loss: 3.882, Global test accuracy: 15.37
Round  55, Train loss: 0.319, Test loss: 1.302, Test accuracy: 70.21
Round  55, Global train loss: 0.319, Global test loss: 3.426, Global test accuracy: 14.94
Round  56, Train loss: 0.284, Test loss: 1.291, Test accuracy: 69.82
Round  56, Global train loss: 0.284, Global test loss: 3.671, Global test accuracy: 15.78
Round  57, Train loss: 0.287, Test loss: 1.295, Test accuracy: 69.91
Round  57, Global train loss: 0.287, Global test loss: 3.986, Global test accuracy: 16.49
Round  58, Train loss: 0.247, Test loss: 1.301, Test accuracy: 69.88
Round  58, Global train loss: 0.247, Global test loss: 3.961, Global test accuracy: 15.20
Round  59, Train loss: 0.241, Test loss: 1.303, Test accuracy: 70.14
Round  59, Global train loss: 0.241, Global test loss: 3.836, Global test accuracy: 15.59
Round  60, Train loss: 0.258, Test loss: 1.305, Test accuracy: 69.95
Round  60, Global train loss: 0.258, Global test loss: 3.735, Global test accuracy: 15.46
Round  61, Train loss: 0.266, Test loss: 1.274, Test accuracy: 70.18
Round  61, Global train loss: 0.266, Global test loss: 4.149, Global test accuracy: 16.28
Round  62, Train loss: 0.242, Test loss: 1.293, Test accuracy: 70.21
Round  62, Global train loss: 0.242, Global test loss: 4.248, Global test accuracy: 15.84
Round  63, Train loss: 0.217, Test loss: 1.313, Test accuracy: 70.40
Round  63, Global train loss: 0.217, Global test loss: 4.399, Global test accuracy: 16.93
Round  64, Train loss: 0.239, Test loss: 1.310, Test accuracy: 70.77
Round  64, Global train loss: 0.239, Global test loss: 4.258, Global test accuracy: 16.55
Round  65, Train loss: 0.223, Test loss: 1.314, Test accuracy: 70.88
Round  65, Global train loss: 0.223, Global test loss: 4.035, Global test accuracy: 15.37
Round  66, Train loss: 0.278, Test loss: 1.360, Test accuracy: 70.47
Round  66, Global train loss: 0.278, Global test loss: 3.846, Global test accuracy: 15.23
Round  67, Train loss: 0.249, Test loss: 1.369, Test accuracy: 70.17
Round  67, Global train loss: 0.249, Global test loss: 3.958, Global test accuracy: 14.44
Round  68, Train loss: 0.281, Test loss: 1.373, Test accuracy: 70.36
Round  68, Global train loss: 0.281, Global test loss: 4.127, Global test accuracy: 15.17
Round  69, Train loss: 0.238, Test loss: 1.361, Test accuracy: 70.72
Round  69, Global train loss: 0.238, Global test loss: 4.138, Global test accuracy: 16.85
Round  70, Train loss: 0.241, Test loss: 1.342, Test accuracy: 70.57
Round  70, Global train loss: 0.241, Global test loss: 3.945, Global test accuracy: 16.93
Round  71, Train loss: 0.243, Test loss: 1.337, Test accuracy: 70.78
Round  71, Global train loss: 0.243, Global test loss: 3.931, Global test accuracy: 15.18
Round  72, Train loss: 0.204, Test loss: 1.386, Test accuracy: 70.50
Round  72, Global train loss: 0.204, Global test loss: 4.432, Global test accuracy: 15.74
Round  73, Train loss: 0.215, Test loss: 1.383, Test accuracy: 70.46
Round  73, Global train loss: 0.215, Global test loss: 4.414, Global test accuracy: 16.15
Round  74, Train loss: 0.213, Test loss: 1.369, Test accuracy: 70.55
Round  74, Global train loss: 0.213, Global test loss: 4.325, Global test accuracy: 14.66
Round  75, Train loss: 0.268, Test loss: 1.361, Test accuracy: 70.51
Round  75, Global train loss: 0.268, Global test loss: 3.625, Global test accuracy: 14.92
Round  76, Train loss: 0.273, Test loss: 1.332, Test accuracy: 70.83
Round  76, Global train loss: 0.273, Global test loss: 3.983, Global test accuracy: 14.98
Round  77, Train loss: 0.219, Test loss: 1.332, Test accuracy: 71.16
Round  77, Global train loss: 0.219, Global test loss: 4.360, Global test accuracy: 16.38
Round  78, Train loss: 0.240, Test loss: 1.330, Test accuracy: 71.22
Round  78, Global train loss: 0.240, Global test loss: 3.761, Global test accuracy: 16.02
Round  79, Train loss: 0.205, Test loss: 1.378, Test accuracy: 70.77
Round  79, Global train loss: 0.205, Global test loss: 4.165, Global test accuracy: 16.33
Round  80, Train loss: 0.189, Test loss: 1.389, Test accuracy: 70.74
Round  80, Global train loss: 0.189, Global test loss: 3.738, Global test accuracy: 16.00
Round  81, Train loss: 0.172, Test loss: 1.368, Test accuracy: 71.09
Round  81, Global train loss: 0.172, Global test loss: 3.914, Global test accuracy: 16.35
Round  82, Train loss: 0.161, Test loss: 1.358, Test accuracy: 70.97
Round  82, Global train loss: 0.161, Global test loss: 4.000, Global test accuracy: 16.16
Round  83, Train loss: 0.153, Test loss: 1.379, Test accuracy: 70.95
Round  83, Global train loss: 0.153, Global test loss: 4.077, Global test accuracy: 15.88
Round  84, Train loss: 0.151, Test loss: 1.376, Test accuracy: 71.30
Round  84, Global train loss: 0.151, Global test loss: 4.175, Global test accuracy: 16.37
Round  85, Train loss: 0.147, Test loss: 1.385, Test accuracy: 70.93
Round  85, Global train loss: 0.147, Global test loss: 4.166, Global test accuracy: 16.06
Round  86, Train loss: 0.141, Test loss: 1.405, Test accuracy: 71.04
Round  86, Global train loss: 0.141, Global test loss: 4.256, Global test accuracy: 15.82
Round  87, Train loss: 0.142, Test loss: 1.383, Test accuracy: 71.23
Round  87, Global train loss: 0.142, Global test loss: 4.252, Global test accuracy: 15.78
Round  88, Train loss: 0.138, Test loss: 1.449, Test accuracy: 70.61
Round  88, Global train loss: 0.138, Global test loss: 4.271, Global test accuracy: 15.76
Round  89, Train loss: 0.132, Test loss: 1.413, Test accuracy: 71.46
Round  89, Global train loss: 0.132, Global test loss: 4.414, Global test accuracy: 15.89
Round  90, Train loss: 0.224, Test loss: 1.440, Test accuracy: 70.67
Round  90, Global train loss: 0.224, Global test loss: 3.550, Global test accuracy: 15.87
Round  91, Train loss: 0.205, Test loss: 1.459, Test accuracy: 70.35
Round  91, Global train loss: 0.205, Global test loss: 3.530, Global test accuracy: 16.03
Round  92, Train loss: 0.194, Test loss: 1.451, Test accuracy: 71.82
Round  92, Global train loss: 0.194, Global test loss: 3.493, Global test accuracy: 16.06
Round  93, Train loss: 0.197, Test loss: 1.473, Test accuracy: 70.67
Round  93, Global train loss: 0.197, Global test loss: 3.479, Global test accuracy: 16.04
Round  94, Train loss: 0.188, Test loss: 1.411, Test accuracy: 71.54
Round  94, Global train loss: 0.188, Global test loss: 3.482, Global test accuracy: 16.07
Round  95, Train loss: 0.182, Test loss: 1.489, Test accuracy: 70.97
Round  95, Global train loss: 0.182, Global test loss: 3.500, Global test accuracy: 16.04
Round  96, Train loss: 0.191, Test loss: 1.441, Test accuracy: 71.56
Round  96, Global train loss: 0.191, Global test loss: 3.486, Global test accuracy: 16.02
Round  97, Train loss: 0.181, Test loss: 1.465, Test accuracy: 70.57
Round  97, Global train loss: 0.181, Global test loss: 3.499, Global test accuracy: 16.31
Round  98, Train loss: 0.181, Test loss: 1.456, Test accuracy: 71.90
Round  98, Global train loss: 0.181, Global test loss: 3.512, Global test accuracy: 16.10
Round  99, Train loss: 0.178, Test loss: 1.479, Test accuracy: 71.27
Round  99, Global train loss: 0.178, Global test loss: 3.518, Global test accuracy: 16.20
Final Round, Train loss: 0.133, Test loss: 1.635, Test accuracy: 71.43
Final Round, Global train loss: 0.133, Global test loss: 3.518, Global test accuracy: 16.20
Average accuracy final 10 rounds: 71.132
Average global accuracy final 10 rounds: 16.073999999999998
3269.5475573539734
[2.974599838256836, 6.03096079826355, 9.073292255401611, 12.082652568817139, 15.027130365371704, 18.028287649154663, 21.14034342765808, 24.13861322402954, 27.13538408279419, 30.042929649353027, 32.91387343406677, 35.76301288604736, 38.72679305076599, 41.49384593963623, 44.565481662750244, 47.46310114860535, 50.38578462600708, 53.255940675735474, 56.12730121612549, 59.02043032646179, 61.90112829208374, 64.81214952468872, 67.76736783981323, 70.71213102340698, 73.55832362174988, 76.39279222488403, 79.38678121566772, 82.26713752746582, 85.1855800151825, 87.99770140647888, 90.9841616153717, 93.92004251480103, 96.99197483062744, 100.06677174568176, 102.96534585952759, 105.75387024879456, 108.57800030708313, 111.47931742668152, 114.43518280982971, 117.3368821144104, 120.26062726974487, 123.15943479537964, 126.23017120361328, 129.19023180007935, 132.13665080070496, 135.0395369529724, 138.0580325126648, 141.10777854919434, 144.02033615112305, 146.79821300506592, 149.70052576065063, 152.65585255622864, 155.58461213111877, 158.61354756355286, 161.57708430290222, 164.39156699180603, 167.5525622367859, 170.75167036056519, 173.55378079414368, 176.72539806365967, 179.70368552207947, 182.51888918876648, 185.4554295539856, 188.78599953651428, 191.84545755386353, 194.75619196891785, 197.81843090057373, 201.00354599952698, 203.84831261634827, 206.70100116729736, 209.75793933868408, 212.51912593841553, 215.5628364086151, 218.4200689792633, 221.38835263252258, 224.1749565601349, 227.0246558189392, 229.95619869232178, 233.26407074928284, 236.20785212516785, 239.66833448410034, 242.66647338867188, 245.70408487319946, 248.7150104045868, 251.73045206069946, 254.6360034942627, 257.73748660087585, 260.77946639060974, 263.67948818206787, 266.77906680107117, 270.185396194458, 273.27611327171326, 276.2434105873108, 279.31863355636597, 282.4689726829529, 285.47848439216614, 288.9046335220337, 291.9671530723572, 294.9956467151642, 297.9376609325409, 303.9316864013672]
[48.94, 54.38, 56.59, 59.6, 60.15, 61.33, 62.87, 64.3, 64.57, 64.42, 64.98, 65.32, 65.58, 65.81, 66.59, 66.67, 66.74, 66.87, 67.16, 67.7, 67.96, 68.02, 68.17, 68.81, 68.63, 68.68, 68.78, 68.94, 69.68, 69.87, 69.89, 69.4, 69.06, 69.25, 69.54, 68.83, 69.35, 69.15, 69.6, 70.1, 70.07, 69.7, 69.64, 69.89, 70.3, 70.05, 70.17, 69.93, 69.82, 70.38, 70.4, 70.17, 70.07, 70.37, 70.19, 70.21, 69.82, 69.91, 69.88, 70.14, 69.95, 70.18, 70.21, 70.4, 70.77, 70.88, 70.47, 70.17, 70.36, 70.72, 70.57, 70.78, 70.5, 70.46, 70.55, 70.51, 70.83, 71.16, 71.22, 70.77, 70.74, 71.09, 70.97, 70.95, 71.3, 70.93, 71.04, 71.23, 70.61, 71.46, 70.67, 70.35, 71.82, 70.67, 71.54, 70.97, 71.56, 70.57, 71.9, 71.27, 71.43]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.451, Test loss: 1.248, Test accuracy: 48.27
Round   0, Global train loss: 1.451, Global test loss: 2.286, Global test accuracy: 12.41
Round   1, Train loss: 1.275, Test loss: 1.163, Test accuracy: 53.49
Round   1, Global train loss: 1.275, Global test loss: 2.283, Global test accuracy: 16.83
Round   2, Train loss: 1.152, Test loss: 1.065, Test accuracy: 57.30
Round   2, Global train loss: 1.152, Global test loss: 2.288, Global test accuracy: 17.11
Round   3, Train loss: 1.075, Test loss: 1.049, Test accuracy: 58.19
Round   3, Global train loss: 1.075, Global test loss: 2.299, Global test accuracy: 16.97
Round   4, Train loss: 1.014, Test loss: 1.020, Test accuracy: 59.98
Round   4, Global train loss: 1.014, Global test loss: 2.309, Global test accuracy: 17.51
Round   5, Train loss: 0.961, Test loss: 1.004, Test accuracy: 60.90
Round   5, Global train loss: 0.961, Global test loss: 2.312, Global test accuracy: 18.04
Round   6, Train loss: 0.915, Test loss: 0.970, Test accuracy: 63.15
Round   6, Global train loss: 0.915, Global test loss: 2.315, Global test accuracy: 18.22
Round   7, Train loss: 0.867, Test loss: 0.985, Test accuracy: 63.21
Round   7, Global train loss: 0.867, Global test loss: 2.319, Global test accuracy: 18.32
Round   8, Train loss: 0.828, Test loss: 0.980, Test accuracy: 64.35
Round   8, Global train loss: 0.828, Global test loss: 2.341, Global test accuracy: 18.50
Round   9, Train loss: 0.791, Test loss: 0.983, Test accuracy: 64.85
Round   9, Global train loss: 0.791, Global test loss: 2.359, Global test accuracy: 18.43
Round  10, Train loss: 0.749, Test loss: 0.974, Test accuracy: 64.80
Round  10, Global train loss: 0.749, Global test loss: 2.790, Global test accuracy: 17.57
Round  11, Train loss: 0.714, Test loss: 0.975, Test accuracy: 65.28
Round  11, Global train loss: 0.714, Global test loss: 2.953, Global test accuracy: 15.23
Round  12, Train loss: 0.726, Test loss: 0.947, Test accuracy: 66.13
Round  12, Global train loss: 0.726, Global test loss: 2.906, Global test accuracy: 16.57
Round  13, Train loss: 0.654, Test loss: 0.949, Test accuracy: 66.13
Round  13, Global train loss: 0.654, Global test loss: 2.807, Global test accuracy: 18.00
Round  14, Train loss: 0.601, Test loss: 0.954, Test accuracy: 66.62
Round  14, Global train loss: 0.601, Global test loss: 2.868, Global test accuracy: 16.17
Round  15, Train loss: 0.652, Test loss: 0.969, Test accuracy: 66.67
Round  15, Global train loss: 0.652, Global test loss: 2.886, Global test accuracy: 17.14
Round  16, Train loss: 0.612, Test loss: 0.981, Test accuracy: 66.90
Round  16, Global train loss: 0.612, Global test loss: 2.948, Global test accuracy: 17.64
Round  17, Train loss: 0.629, Test loss: 0.989, Test accuracy: 67.34
Round  17, Global train loss: 0.629, Global test loss: 2.854, Global test accuracy: 15.75
Round  18, Train loss: 0.578, Test loss: 0.988, Test accuracy: 67.43
Round  18, Global train loss: 0.578, Global test loss: 3.067, Global test accuracy: 15.80
Round  19, Train loss: 0.512, Test loss: 0.999, Test accuracy: 67.19
Round  19, Global train loss: 0.512, Global test loss: 3.051, Global test accuracy: 16.17
Round  20, Train loss: 0.532, Test loss: 1.016, Test accuracy: 67.42
Round  20, Global train loss: 0.532, Global test loss: 3.024, Global test accuracy: 15.08
Round  21, Train loss: 0.561, Test loss: 1.019, Test accuracy: 67.63
Round  21, Global train loss: 0.561, Global test loss: 3.043, Global test accuracy: 16.07
Round  22, Train loss: 0.563, Test loss: 1.034, Test accuracy: 68.54
Round  22, Global train loss: 0.563, Global test loss: 3.112, Global test accuracy: 17.01
Round  23, Train loss: 0.496, Test loss: 1.033, Test accuracy: 68.78
Round  23, Global train loss: 0.496, Global test loss: 3.568, Global test accuracy: 16.26
Round  24, Train loss: 0.503, Test loss: 1.056, Test accuracy: 68.40
Round  24, Global train loss: 0.503, Global test loss: 3.256, Global test accuracy: 16.81
Round  25, Train loss: 0.486, Test loss: 1.047, Test accuracy: 68.86
Round  25, Global train loss: 0.486, Global test loss: 3.248, Global test accuracy: 17.48
Round  26, Train loss: 0.478, Test loss: 1.070, Test accuracy: 68.68
Round  26, Global train loss: 0.478, Global test loss: 3.207, Global test accuracy: 16.62
Round  27, Train loss: 0.400, Test loss: 1.103, Test accuracy: 68.37
Round  27, Global train loss: 0.400, Global test loss: 3.656, Global test accuracy: 16.97
Round  28, Train loss: 0.431, Test loss: 1.091, Test accuracy: 68.82
Round  28, Global train loss: 0.431, Global test loss: 3.271, Global test accuracy: 15.92
Round  29, Train loss: 0.444, Test loss: 1.088, Test accuracy: 69.06
Round  29, Global train loss: 0.444, Global test loss: 3.226, Global test accuracy: 16.46
Round  30, Train loss: 0.388, Test loss: 1.095, Test accuracy: 69.33
Round  30, Global train loss: 0.388, Global test loss: 3.756, Global test accuracy: 15.16
Round  31, Train loss: 0.385, Test loss: 1.091, Test accuracy: 69.27
Round  31, Global train loss: 0.385, Global test loss: 3.793, Global test accuracy: 16.42
Round  32, Train loss: 0.407, Test loss: 1.114, Test accuracy: 69.26
Round  32, Global train loss: 0.407, Global test loss: 3.300, Global test accuracy: 17.18
Round  33, Train loss: 0.342, Test loss: 1.114, Test accuracy: 69.42
Round  33, Global train loss: 0.342, Global test loss: 3.553, Global test accuracy: 16.50
Round  34, Train loss: 0.410, Test loss: 1.136, Test accuracy: 69.48
Round  34, Global train loss: 0.410, Global test loss: 3.694, Global test accuracy: 15.26
Round  35, Train loss: 0.397, Test loss: 1.135, Test accuracy: 69.73
Round  35, Global train loss: 0.397, Global test loss: 3.628, Global test accuracy: 16.30
Round  36, Train loss: 0.292, Test loss: 1.130, Test accuracy: 69.78
Round  36, Global train loss: 0.292, Global test loss: 3.859, Global test accuracy: 15.82
Round  37, Train loss: 0.346, Test loss: 1.150, Test accuracy: 69.72
Round  37, Global train loss: 0.346, Global test loss: 3.606, Global test accuracy: 14.28
Round  38, Train loss: 0.348, Test loss: 1.117, Test accuracy: 70.64
Round  38, Global train loss: 0.348, Global test loss: 3.605, Global test accuracy: 15.74
Round  39, Train loss: 0.383, Test loss: 1.153, Test accuracy: 70.77
Round  39, Global train loss: 0.383, Global test loss: 3.987, Global test accuracy: 14.65
Round  40, Train loss: 0.345, Test loss: 1.168, Test accuracy: 70.42
Round  40, Global train loss: 0.345, Global test loss: 3.593, Global test accuracy: 16.29
Round  41, Train loss: 0.352, Test loss: 1.194, Test accuracy: 70.05
Round  41, Global train loss: 0.352, Global test loss: 3.483, Global test accuracy: 16.49
Round  42, Train loss: 0.368, Test loss: 1.198, Test accuracy: 70.26
Round  42, Global train loss: 0.368, Global test loss: 3.546, Global test accuracy: 16.14
Round  43, Train loss: 0.366, Test loss: 1.200, Test accuracy: 70.28
Round  43, Global train loss: 0.366, Global test loss: 3.819, Global test accuracy: 15.34
Round  44, Train loss: 0.325, Test loss: 1.191, Test accuracy: 70.18
Round  44, Global train loss: 0.325, Global test loss: 3.613, Global test accuracy: 17.50
Round  45, Train loss: 0.325, Test loss: 1.209, Test accuracy: 70.29
Round  45, Global train loss: 0.325, Global test loss: 4.104, Global test accuracy: 16.23
Round  46, Train loss: 0.275, Test loss: 1.219, Test accuracy: 70.25
Round  46, Global train loss: 0.275, Global test loss: 3.689, Global test accuracy: 16.29
Round  47, Train loss: 0.305, Test loss: 1.221, Test accuracy: 70.28
Round  47, Global train loss: 0.305, Global test loss: 3.812, Global test accuracy: 16.78
Round  48, Train loss: 0.347, Test loss: 1.225, Test accuracy: 70.42
Round  48, Global train loss: 0.347, Global test loss: 4.077, Global test accuracy: 16.74
Round  49, Train loss: 0.304, Test loss: 1.229, Test accuracy: 70.59
Round  49, Global train loss: 0.304, Global test loss: 3.962, Global test accuracy: 16.05
Round  50, Train loss: 0.282, Test loss: 1.234, Test accuracy: 70.30
Round  50, Global train loss: 0.282, Global test loss: 3.923, Global test accuracy: 16.86
Round  51, Train loss: 0.300, Test loss: 1.237, Test accuracy: 70.54
Round  51, Global train loss: 0.300, Global test loss: 3.540, Global test accuracy: 15.57
Round  52, Train loss: 0.267, Test loss: 1.258, Test accuracy: 70.30
Round  52, Global train loss: 0.267, Global test loss: 3.971, Global test accuracy: 15.39
Round  53, Train loss: 0.293, Test loss: 1.249, Test accuracy: 70.42
Round  53, Global train loss: 0.293, Global test loss: 3.727, Global test accuracy: 15.83
Round  54, Train loss: 0.250, Test loss: 1.259, Test accuracy: 70.51
Round  54, Global train loss: 0.250, Global test loss: 4.465, Global test accuracy: 15.65
Round  55, Train loss: 0.309, Test loss: 1.251, Test accuracy: 70.93
Round  55, Global train loss: 0.309, Global test loss: 4.155, Global test accuracy: 15.30
Round  56, Train loss: 0.282, Test loss: 1.251, Test accuracy: 70.85
Round  56, Global train loss: 0.282, Global test loss: 4.143, Global test accuracy: 14.99
Round  57, Train loss: 0.256, Test loss: 1.282, Test accuracy: 70.50
Round  57, Global train loss: 0.256, Global test loss: 4.034, Global test accuracy: 17.46
Round  58, Train loss: 0.236, Test loss: 1.287, Test accuracy: 70.51
Round  58, Global train loss: 0.236, Global test loss: 4.969, Global test accuracy: 16.21
Round  59, Train loss: 0.321, Test loss: 1.285, Test accuracy: 70.68
Round  59, Global train loss: 0.321, Global test loss: 3.735, Global test accuracy: 15.62
Round  60, Train loss: 0.252, Test loss: 1.297, Test accuracy: 70.66
Round  60, Global train loss: 0.252, Global test loss: 4.142, Global test accuracy: 15.44
Round  61, Train loss: 0.256, Test loss: 1.293, Test accuracy: 70.72
Round  61, Global train loss: 0.256, Global test loss: 3.924, Global test accuracy: 15.06
Round  62, Train loss: 0.262, Test loss: 1.298, Test accuracy: 70.59
Round  62, Global train loss: 0.262, Global test loss: 4.037, Global test accuracy: 16.23
Round  63, Train loss: 0.231, Test loss: 1.323, Test accuracy: 70.48
Round  63, Global train loss: 0.231, Global test loss: 3.972, Global test accuracy: 14.80
Round  64, Train loss: 0.253, Test loss: 1.333, Test accuracy: 70.56
Round  64, Global train loss: 0.253, Global test loss: 3.867, Global test accuracy: 16.30
Round  65, Train loss: 0.256, Test loss: 1.324, Test accuracy: 70.46
Round  65, Global train loss: 0.256, Global test loss: 4.003, Global test accuracy: 15.94
Round  66, Train loss: 0.249, Test loss: 1.313, Test accuracy: 70.81
Round  66, Global train loss: 0.249, Global test loss: 4.013, Global test accuracy: 14.99
Round  67, Train loss: 0.196, Test loss: 1.312, Test accuracy: 71.05
Round  67, Global train loss: 0.196, Global test loss: 4.052, Global test accuracy: 15.72
Round  68, Train loss: 0.248, Test loss: 1.297, Test accuracy: 71.09
Round  68, Global train loss: 0.248, Global test loss: 3.944, Global test accuracy: 15.60
Round  69, Train loss: 0.238, Test loss: 1.314, Test accuracy: 71.08
Round  69, Global train loss: 0.238, Global test loss: 3.900, Global test accuracy: 16.76
Round  70, Train loss: 0.220, Test loss: 1.322, Test accuracy: 70.67
Round  70, Global train loss: 0.220, Global test loss: 4.057, Global test accuracy: 15.27
Round  71, Train loss: 0.259, Test loss: 1.354, Test accuracy: 70.40
Round  71, Global train loss: 0.259, Global test loss: 3.696, Global test accuracy: 15.31
Round  72, Train loss: 0.273, Test loss: 1.321, Test accuracy: 70.90
Round  72, Global train loss: 0.273, Global test loss: 4.448, Global test accuracy: 16.47
Round  73, Train loss: 0.231, Test loss: 1.348, Test accuracy: 70.77
Round  73, Global train loss: 0.231, Global test loss: 4.422, Global test accuracy: 16.52
Round  74, Train loss: 0.219, Test loss: 1.361, Test accuracy: 70.69
Round  74, Global train loss: 0.219, Global test loss: 4.127, Global test accuracy: 17.13
Round  75, Train loss: 0.187, Test loss: 1.352, Test accuracy: 70.77
Round  75, Global train loss: 0.187, Global test loss: 4.101, Global test accuracy: 16.53
Round  76, Train loss: 0.285, Test loss: 1.349, Test accuracy: 70.93
Round  76, Global train loss: 0.285, Global test loss: 4.089, Global test accuracy: 15.21
Round  77, Train loss: 0.213, Test loss: 1.370, Test accuracy: 70.65
Round  77, Global train loss: 0.213, Global test loss: 4.228, Global test accuracy: 16.02
Round  78, Train loss: 0.237, Test loss: 1.392, Test accuracy: 70.40
Round  78, Global train loss: 0.237, Global test loss: 4.894, Global test accuracy: 15.85
Round  79, Train loss: 0.230, Test loss: 1.372, Test accuracy: 70.29
Round  79, Global train loss: 0.230, Global test loss: 4.204, Global test accuracy: 16.60
Round  80, Train loss: 0.174, Test loss: 1.392, Test accuracy: 70.63
Round  80, Global train loss: 0.174, Global test loss: 3.749, Global test accuracy: 16.73
Round  81, Train loss: 0.156, Test loss: 1.402, Test accuracy: 70.45
Round  81, Global train loss: 0.156, Global test loss: 3.826, Global test accuracy: 16.69
Round  82, Train loss: 0.149, Test loss: 1.401, Test accuracy: 70.60
Round  82, Global train loss: 0.149, Global test loss: 3.870, Global test accuracy: 16.64
Round  83, Train loss: 0.145, Test loss: 1.398, Test accuracy: 70.67
Round  83, Global train loss: 0.145, Global test loss: 3.909, Global test accuracy: 16.38
Round  84, Train loss: 0.139, Test loss: 1.420, Test accuracy: 70.59
Round  84, Global train loss: 0.139, Global test loss: 4.014, Global test accuracy: 15.95
Round  85, Train loss: 0.144, Test loss: 1.412, Test accuracy: 70.55
Round  85, Global train loss: 0.144, Global test loss: 3.955, Global test accuracy: 15.87
Round  86, Train loss: 0.133, Test loss: 1.416, Test accuracy: 70.62
Round  86, Global train loss: 0.133, Global test loss: 4.019, Global test accuracy: 15.84
Round  87, Train loss: 0.128, Test loss: 1.453, Test accuracy: 70.61
Round  87, Global train loss: 0.128, Global test loss: 4.059, Global test accuracy: 16.32
Round  88, Train loss: 0.124, Test loss: 1.426, Test accuracy: 70.83
Round  88, Global train loss: 0.124, Global test loss: 4.148, Global test accuracy: 16.21
Round  89, Train loss: 0.125, Test loss: 1.461, Test accuracy: 70.36
Round  89, Global train loss: 0.125, Global test loss: 4.234, Global test accuracy: 16.12
Round  90, Train loss: 0.217, Test loss: 1.452, Test accuracy: 70.31
Round  90, Global train loss: 0.217, Global test loss: 3.578, Global test accuracy: 16.27
Round  91, Train loss: 0.197, Test loss: 1.423, Test accuracy: 71.30
Round  91, Global train loss: 0.197, Global test loss: 3.570, Global test accuracy: 16.76
Round  92, Train loss: 0.193, Test loss: 1.414, Test accuracy: 70.90
Round  92, Global train loss: 0.193, Global test loss: 3.554, Global test accuracy: 16.40
Round  93, Train loss: 0.188, Test loss: 1.472, Test accuracy: 70.76
Round  93, Global train loss: 0.188, Global test loss: 3.610, Global test accuracy: 16.73
Round  94, Train loss: 0.188, Test loss: 1.465, Test accuracy: 70.54
Round  94, Global train loss: 0.188, Global test loss: 3.577, Global test accuracy: 16.44
Round  95, Train loss: 0.180, Test loss: 1.436, Test accuracy: 71.71
Round  95, Global train loss: 0.180, Global test loss: 3.630, Global test accuracy: 16.59
Round  96, Train loss: 0.181, Test loss: 1.439, Test accuracy: 70.71
Round  96, Global train loss: 0.181, Global test loss: 3.615, Global test accuracy: 16.66
Round  97, Train loss: 0.177, Test loss: 1.480, Test accuracy: 71.05
Round  97, Global train loss: 0.177, Global test loss: 3.608, Global test accuracy: 16.31
Round  98, Train loss: 0.175, Test loss: 1.517, Test accuracy: 70.46
Round  98, Global train loss: 0.175, Global test loss: 3.620, Global test accuracy: 16.78
Round  99, Train loss: 0.173, Test loss: 1.482, Test accuracy: 71.26
Round  99, Global train loss: 0.173, Global test loss: 3.651, Global test accuracy: 16.93
Final Round, Train loss: 0.134, Test loss: 1.593, Test accuracy: 70.91
Final Round, Global train loss: 0.134, Global test loss: 3.651, Global test accuracy: 16.93
Average accuracy final 10 rounds: 70.89999999999999
Average global accuracy final 10 rounds: 16.587000000000003
6228.349049091339
[3.28584361076355, 6.2806549072265625, 9.329267501831055, 12.227273941040039, 15.24671745300293, 18.513829708099365, 21.508368015289307, 24.603899240493774, 27.981974363327026, 31.25141978263855, 34.32324695587158, 37.73907470703125, 40.85197639465332, 43.96060371398926, 47.26809525489807, 50.688101053237915, 54.054314851760864, 57.32485365867615, 60.607399702072144, 63.694600105285645, 66.97816967964172, 74.19992160797119, 81.48895192146301, 88.73836612701416, 96.17583322525024, 103.60402154922485, 110.89294028282166, 118.22295308113098, 125.38746380805969, 132.51718282699585, 140.02297520637512, 147.0423548221588, 154.29601097106934, 161.6491596698761, 169.1647400856018, 176.56024384498596, 183.70978713035583, 191.13603258132935, 198.71230220794678, 206.13059973716736, 213.42974305152893, 220.6823694705963, 228.19576025009155, 235.61122941970825, 242.81336307525635, 250.28505492210388, 257.72360825538635, 265.24875235557556, 273.019238948822, 280.57217144966125, 288.1204090118408, 295.6610598564148, 303.28445267677307, 311.1033408641815, 318.5646183490753, 326.07407116889954, 334.16617703437805, 341.79669880867004, 349.4375014305115, 356.95644092559814, 364.5097541809082, 372.4221384525299, 379.90666341781616, 387.3708164691925, 395.2110571861267, 403.1391279697418, 410.8324704170227, 418.2716474533081, 425.86811447143555, 433.3321328163147, 440.8738799095154, 448.2605803012848, 456.04081559181213, 463.7830493450165, 471.798707485199, 479.122545003891, 486.44726753234863, 493.9545485973358, 501.5558774471283, 509.03321862220764, 516.6052398681641, 524.1510026454926, 531.812905550003, 539.4062407016754, 547.1845316886902, 555.0938827991486, 562.7914938926697, 570.5315458774567, 578.4072754383087, 586.2017996311188, 594.0539526939392, 601.6619431972504, 609.5826704502106, 617.40003657341, 625.2315740585327, 632.8809406757355, 640.3516263961792, 647.8873298168182, 655.3767955303192, 663.2273812294006, 669.4253602027893]
[48.27, 53.49, 57.3, 58.19, 59.98, 60.9, 63.15, 63.21, 64.35, 64.85, 64.8, 65.28, 66.13, 66.13, 66.62, 66.67, 66.9, 67.34, 67.43, 67.19, 67.42, 67.63, 68.54, 68.78, 68.4, 68.86, 68.68, 68.37, 68.82, 69.06, 69.33, 69.27, 69.26, 69.42, 69.48, 69.73, 69.78, 69.72, 70.64, 70.77, 70.42, 70.05, 70.26, 70.28, 70.18, 70.29, 70.25, 70.28, 70.42, 70.59, 70.3, 70.54, 70.3, 70.42, 70.51, 70.93, 70.85, 70.5, 70.51, 70.68, 70.66, 70.72, 70.59, 70.48, 70.56, 70.46, 70.81, 71.05, 71.09, 71.08, 70.67, 70.4, 70.9, 70.77, 70.69, 70.77, 70.93, 70.65, 70.4, 70.29, 70.63, 70.45, 70.6, 70.67, 70.59, 70.55, 70.62, 70.61, 70.83, 70.36, 70.31, 71.3, 70.9, 70.76, 70.54, 71.71, 70.71, 71.05, 70.46, 71.26, 70.91]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.676, Test loss: 1.804, Test accuracy: 21.47
Round   1, Train loss: 1.364, Test loss: 1.406, Test accuracy: 37.97
Round   2, Train loss: 1.221, Test loss: 1.277, Test accuracy: 43.06
Round   3, Train loss: 1.129, Test loss: 1.174, Test accuracy: 49.53
Round   4, Train loss: 1.059, Test loss: 1.076, Test accuracy: 54.24
Round   5, Train loss: 1.003, Test loss: 1.015, Test accuracy: 57.72
Round   6, Train loss: 0.961, Test loss: 0.996, Test accuracy: 58.98
Round   7, Train loss: 0.925, Test loss: 0.953, Test accuracy: 61.51
Round   8, Train loss: 0.892, Test loss: 0.926, Test accuracy: 62.60
Round   9, Train loss: 0.857, Test loss: 0.890, Test accuracy: 64.49
Round  10, Train loss: 0.828, Test loss: 0.869, Test accuracy: 65.29
Round  11, Train loss: 0.799, Test loss: 0.859, Test accuracy: 65.78
Round  12, Train loss: 0.771, Test loss: 0.832, Test accuracy: 67.12
Round  13, Train loss: 0.743, Test loss: 0.814, Test accuracy: 67.84
Round  14, Train loss: 0.724, Test loss: 0.794, Test accuracy: 69.20
Round  15, Train loss: 0.699, Test loss: 0.771, Test accuracy: 69.62
Round  16, Train loss: 0.675, Test loss: 0.769, Test accuracy: 70.26
Round  17, Train loss: 0.656, Test loss: 0.758, Test accuracy: 70.63
Round  18, Train loss: 0.638, Test loss: 0.743, Test accuracy: 70.92
Round  19, Train loss: 0.612, Test loss: 0.742, Test accuracy: 71.66
Round  20, Train loss: 0.559, Test loss: 0.753, Test accuracy: 71.39
Round  21, Train loss: 0.601, Test loss: 0.749, Test accuracy: 71.40
Round  22, Train loss: 0.569, Test loss: 0.744, Test accuracy: 71.48
Round  23, Train loss: 0.535, Test loss: 0.743, Test accuracy: 71.08
Round  24, Train loss: 0.564, Test loss: 0.756, Test accuracy: 71.82
Round  25, Train loss: 0.571, Test loss: 0.767, Test accuracy: 71.83
Round  26, Train loss: 0.515, Test loss: 0.749, Test accuracy: 72.08
Round  27, Train loss: 0.498, Test loss: 0.760, Test accuracy: 71.88
Round  28, Train loss: 0.431, Test loss: 0.782, Test accuracy: 71.87
Round  29, Train loss: 0.493, Test loss: 0.737, Test accuracy: 73.36
Round  30, Train loss: 0.503, Test loss: 0.756, Test accuracy: 72.85
Round  31, Train loss: 0.471, Test loss: 0.741, Test accuracy: 73.21
Round  32, Train loss: 0.465, Test loss: 0.730, Test accuracy: 74.16
Round  33, Train loss: 0.441, Test loss: 0.763, Test accuracy: 73.41
Round  34, Train loss: 0.437, Test loss: 0.724, Test accuracy: 74.51
Round  35, Train loss: 0.418, Test loss: 0.752, Test accuracy: 74.12
Round  36, Train loss: 0.364, Test loss: 0.750, Test accuracy: 74.55
Round  37, Train loss: 0.404, Test loss: 0.735, Test accuracy: 74.90
Round  38, Train loss: 0.383, Test loss: 0.743, Test accuracy: 74.72
Round  39, Train loss: 0.445, Test loss: 0.722, Test accuracy: 75.44
Round  40, Train loss: 0.351, Test loss: 0.717, Test accuracy: 75.55
Round  41, Train loss: 0.387, Test loss: 0.741, Test accuracy: 75.29
Round  42, Train loss: 0.359, Test loss: 0.718, Test accuracy: 75.65
Round  43, Train loss: 0.444, Test loss: 0.707, Test accuracy: 75.74
Round  44, Train loss: 0.375, Test loss: 0.724, Test accuracy: 75.78
Round  45, Train loss: 0.370, Test loss: 0.719, Test accuracy: 76.34
Round  46, Train loss: 0.352, Test loss: 0.718, Test accuracy: 75.77
Round  47, Train loss: 0.368, Test loss: 0.738, Test accuracy: 75.65
Round  48, Train loss: 0.345, Test loss: 0.718, Test accuracy: 75.85
Round  49, Train loss: 0.358, Test loss: 0.736, Test accuracy: 76.02
Round  50, Train loss: 0.380, Test loss: 0.729, Test accuracy: 76.37
Round  51, Train loss: 0.294, Test loss: 0.730, Test accuracy: 75.76
Round  52, Train loss: 0.317, Test loss: 0.758, Test accuracy: 75.86
Round  53, Train loss: 0.356, Test loss: 0.760, Test accuracy: 76.18
Round  54, Train loss: 0.321, Test loss: 0.776, Test accuracy: 75.45
Round  55, Train loss: 0.296, Test loss: 0.769, Test accuracy: 75.46
Round  56, Train loss: 0.320, Test loss: 0.767, Test accuracy: 75.67
Round  57, Train loss: 0.285, Test loss: 0.782, Test accuracy: 75.94
Round  58, Train loss: 0.314, Test loss: 0.760, Test accuracy: 76.18
Round  59, Train loss: 0.265, Test loss: 0.769, Test accuracy: 76.22
Round  60, Train loss: 0.314, Test loss: 0.755, Test accuracy: 76.74
Round  61, Train loss: 0.239, Test loss: 0.768, Test accuracy: 76.11
Round  62, Train loss: 0.285, Test loss: 0.788, Test accuracy: 75.86
Round  63, Train loss: 0.260, Test loss: 0.758, Test accuracy: 76.18
Round  64, Train loss: 0.300, Test loss: 0.788, Test accuracy: 75.96
Round  65, Train loss: 0.259, Test loss: 0.780, Test accuracy: 76.36
Round  66, Train loss: 0.287, Test loss: 0.811, Test accuracy: 75.95
Round  67, Train loss: 0.258, Test loss: 0.811, Test accuracy: 75.92
Round  68, Train loss: 0.250, Test loss: 0.818, Test accuracy: 76.22
Round  69, Train loss: 0.272, Test loss: 0.825, Test accuracy: 76.25
Round  70, Train loss: 0.224, Test loss: 0.832, Test accuracy: 76.12
Round  71, Train loss: 0.218, Test loss: 0.841, Test accuracy: 76.21
Round  72, Train loss: 0.254, Test loss: 0.825, Test accuracy: 76.27
Round  73, Train loss: 0.267, Test loss: 0.833, Test accuracy: 76.44
Round  74, Train loss: 0.276, Test loss: 0.865, Test accuracy: 76.33
Round  75, Train loss: 0.227, Test loss: 0.828, Test accuracy: 76.14
Round  76, Train loss: 0.299, Test loss: 0.804, Test accuracy: 77.03
Round  77, Train loss: 0.282, Test loss: 0.831, Test accuracy: 76.97
Round  78, Train loss: 0.251, Test loss: 0.836, Test accuracy: 77.04
Round  79, Train loss: 0.240, Test loss: 0.810, Test accuracy: 77.67
Round  80, Train loss: 0.183, Test loss: 0.820, Test accuracy: 77.79
Round  81, Train loss: 0.175, Test loss: 0.835, Test accuracy: 77.55
Round  82, Train loss: 0.165, Test loss: 0.857, Test accuracy: 77.27
Round  83, Train loss: 0.157, Test loss: 0.905, Test accuracy: 76.85
Round  84, Train loss: 0.154, Test loss: 0.866, Test accuracy: 77.24
Round  85, Train loss: 0.140, Test loss: 0.906, Test accuracy: 76.98
Round  86, Train loss: 0.143, Test loss: 0.907, Test accuracy: 77.29
Round  87, Train loss: 0.141, Test loss: 0.898, Test accuracy: 77.01
Round  88, Train loss: 0.133, Test loss: 0.897, Test accuracy: 77.26
Round  89, Train loss: 0.139, Test loss: 0.906, Test accuracy: 76.83
Round  90, Train loss: 0.235, Test loss: 0.860, Test accuracy: 77.22
Round  91, Train loss: 0.216, Test loss: 0.847, Test accuracy: 77.16
Round  92, Train loss: 0.213, Test loss: 0.847, Test accuracy: 77.22
Round  93, Train loss: 0.192, Test loss: 0.861, Test accuracy: 77.64
Round  94, Train loss: 0.202, Test loss: 0.879, Test accuracy: 77.23
Round  95, Train loss: 0.191, Test loss: 0.863, Test accuracy: 77.48
Round  96, Train loss: 0.193, Test loss: 0.858, Test accuracy: 77.51
Round  97, Train loss: 0.187, Test loss: 0.872, Test accuracy: 77.43
Round  98, Train loss: 0.193, Test loss: 0.877, Test accuracy: 77.28
Round  99, Train loss: 0.191, Test loss: 0.892, Test accuracy: 76.88
Final Round, Train loss: 0.145, Test loss: 0.856, Test accuracy: 77.92
Average accuracy final 10 rounds: 77.30499999999999
4625.56902551651
[2.8754491806030273, 5.739973545074463, 8.583961248397827, 11.735279321670532, 14.716472387313843, 17.553619623184204, 20.66431498527527, 23.61369776725769, 26.32791304588318, 29.23245096206665, 32.17936086654663, 35.07000970840454, 38.06744718551636, 41.03010153770447, 43.85084819793701, 46.94409656524658, 49.94294476509094, 52.98960733413696, 55.78708600997925, 58.601014852523804, 61.34975743293762, 66.22568321228027, 71.08073282241821, 76.11403369903564, 81.11082291603088, 86.09820413589478, 91.16215443611145, 96.04413223266602, 101.14718079566956, 106.49299240112305, 111.51085948944092, 116.75262689590454, 121.85774803161621, 127.30808901786804, 132.37643814086914, 137.28271293640137, 142.4832305908203, 147.665354013443, 152.91428661346436, 157.93114185333252, 163.13460326194763, 168.50072717666626, 173.81712341308594, 179.3519811630249, 185.0011932849884, 190.3850176334381, 195.453045129776, 200.8044135570526, 206.1940426826477, 211.48285126686096, 216.64294171333313, 221.70179343223572, 226.97354125976562, 232.11245441436768, 237.11461567878723, 242.2418076992035, 247.3850874900818, 252.88616466522217, 258.20207715034485, 263.4482891559601, 268.6376667022705, 273.6351046562195, 279.0405912399292, 284.11818194389343, 289.073762178421, 294.52046298980713, 299.78398537635803, 304.81309962272644, 310.0685429573059, 315.27308893203735, 320.3796212673187, 325.679735660553, 330.7580690383911, 335.9893853664398, 341.1497366428375, 346.4241373538971, 351.66587591171265, 356.8360152244568, 361.94382762908936, 366.918030500412, 371.9420609474182, 376.95641708374023, 382.0467140674591, 387.27506947517395, 392.4175431728363, 397.5605046749115, 402.8066589832306, 407.8908989429474, 412.94525504112244, 418.10975909233093, 423.12644934654236, 428.33591866493225, 433.68817019462585, 439.28239369392395, 444.6473205089569, 450.0124282836914, 454.9579300880432, 460.83570408821106, 465.9788520336151, 471.1779444217682, 475.80126094818115]
[21.47, 37.97, 43.06, 49.53, 54.24, 57.72, 58.98, 61.51, 62.6, 64.49, 65.29, 65.78, 67.12, 67.84, 69.2, 69.62, 70.26, 70.63, 70.92, 71.66, 71.39, 71.4, 71.48, 71.08, 71.82, 71.83, 72.08, 71.88, 71.87, 73.36, 72.85, 73.21, 74.16, 73.41, 74.51, 74.12, 74.55, 74.9, 74.72, 75.44, 75.55, 75.29, 75.65, 75.74, 75.78, 76.34, 75.77, 75.65, 75.85, 76.02, 76.37, 75.76, 75.86, 76.18, 75.45, 75.46, 75.67, 75.94, 76.18, 76.22, 76.74, 76.11, 75.86, 76.18, 75.96, 76.36, 75.95, 75.92, 76.22, 76.25, 76.12, 76.21, 76.27, 76.44, 76.33, 76.14, 77.03, 76.97, 77.04, 77.67, 77.79, 77.55, 77.27, 76.85, 77.24, 76.98, 77.29, 77.01, 77.26, 76.83, 77.22, 77.16, 77.22, 77.64, 77.23, 77.48, 77.51, 77.43, 77.28, 76.88, 77.92]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.705, Test loss: 1.823, Test accuracy: 23.05
Round   1, Train loss: 1.377, Test loss: 1.479, Test accuracy: 34.75
Round   2, Train loss: 1.223, Test loss: 1.287, Test accuracy: 44.11
Round   3, Train loss: 1.126, Test loss: 1.173, Test accuracy: 51.24
Round   4, Train loss: 1.062, Test loss: 1.087, Test accuracy: 55.40
Round   5, Train loss: 1.009, Test loss: 1.026, Test accuracy: 58.45
Round   6, Train loss: 0.964, Test loss: 0.997, Test accuracy: 59.08
Round   7, Train loss: 0.927, Test loss: 0.954, Test accuracy: 61.54
Round   8, Train loss: 0.890, Test loss: 0.906, Test accuracy: 63.45
Round   9, Train loss: 0.864, Test loss: 0.908, Test accuracy: 63.50
Round  10, Train loss: 0.828, Test loss: 0.916, Test accuracy: 63.29
Round  11, Train loss: 0.781, Test loss: 0.880, Test accuracy: 64.75
Round  12, Train loss: 0.764, Test loss: 0.874, Test accuracy: 64.73
Round  13, Train loss: 0.790, Test loss: 0.844, Test accuracy: 66.19
Round  14, Train loss: 0.781, Test loss: 0.823, Test accuracy: 67.48
Round  15, Train loss: 0.677, Test loss: 0.815, Test accuracy: 67.96
Round  16, Train loss: 0.753, Test loss: 0.796, Test accuracy: 68.66
Round  17, Train loss: 0.701, Test loss: 0.798, Test accuracy: 68.76
Round  18, Train loss: 0.681, Test loss: 0.773, Test accuracy: 69.41
Round  19, Train loss: 0.598, Test loss: 0.769, Test accuracy: 69.65
Round  20, Train loss: 0.587, Test loss: 0.780, Test accuracy: 69.19
Round  21, Train loss: 0.567, Test loss: 0.766, Test accuracy: 70.05
Round  22, Train loss: 0.597, Test loss: 0.758, Test accuracy: 70.58
Round  23, Train loss: 0.581, Test loss: 0.749, Test accuracy: 71.06
Round  24, Train loss: 0.563, Test loss: 0.757, Test accuracy: 70.92
Round  25, Train loss: 0.578, Test loss: 0.737, Test accuracy: 71.39
Round  26, Train loss: 0.593, Test loss: 0.717, Test accuracy: 72.95
Round  27, Train loss: 0.525, Test loss: 0.719, Test accuracy: 72.85
Round  28, Train loss: 0.586, Test loss: 0.725, Test accuracy: 73.01
Round  29, Train loss: 0.499, Test loss: 0.706, Test accuracy: 73.03
Round  30, Train loss: 0.460, Test loss: 0.703, Test accuracy: 73.15
Round  31, Train loss: 0.542, Test loss: 0.703, Test accuracy: 73.80
Round  32, Train loss: 0.474, Test loss: 0.721, Test accuracy: 73.55
Round  33, Train loss: 0.509, Test loss: 0.713, Test accuracy: 73.57
Round  34, Train loss: 0.449, Test loss: 0.714, Test accuracy: 73.80
Round  35, Train loss: 0.481, Test loss: 0.694, Test accuracy: 74.29
Round  36, Train loss: 0.420, Test loss: 0.690, Test accuracy: 74.71
Round  37, Train loss: 0.373, Test loss: 0.699, Test accuracy: 74.22
Round  38, Train loss: 0.409, Test loss: 0.706, Test accuracy: 74.33
Round  39, Train loss: 0.383, Test loss: 0.707, Test accuracy: 74.04
Round  40, Train loss: 0.458, Test loss: 0.715, Test accuracy: 73.83
Round  41, Train loss: 0.441, Test loss: 0.701, Test accuracy: 74.48
Round  42, Train loss: 0.389, Test loss: 0.707, Test accuracy: 74.06
Round  43, Train loss: 0.448, Test loss: 0.688, Test accuracy: 74.38
Round  44, Train loss: 0.373, Test loss: 0.692, Test accuracy: 74.36
Round  45, Train loss: 0.345, Test loss: 0.686, Test accuracy: 74.58
Round  46, Train loss: 0.345, Test loss: 0.675, Test accuracy: 75.06
Round  47, Train loss: 0.394, Test loss: 0.674, Test accuracy: 75.72
Round  48, Train loss: 0.350, Test loss: 0.672, Test accuracy: 76.34
Round  49, Train loss: 0.342, Test loss: 0.669, Test accuracy: 76.12
Round  50, Train loss: 0.386, Test loss: 0.678, Test accuracy: 76.15
Round  51, Train loss: 0.353, Test loss: 0.688, Test accuracy: 75.54
Round  52, Train loss: 0.324, Test loss: 0.671, Test accuracy: 76.21
Round  53, Train loss: 0.359, Test loss: 0.678, Test accuracy: 76.08
Round  54, Train loss: 0.354, Test loss: 0.678, Test accuracy: 76.62
Round  55, Train loss: 0.280, Test loss: 0.682, Test accuracy: 76.17
Round  56, Train loss: 0.324, Test loss: 0.676, Test accuracy: 76.49
Round  57, Train loss: 0.316, Test loss: 0.694, Test accuracy: 75.85
Round  58, Train loss: 0.354, Test loss: 0.685, Test accuracy: 76.39
Round  59, Train loss: 0.332, Test loss: 0.671, Test accuracy: 76.32
Round  60, Train loss: 0.317, Test loss: 0.669, Test accuracy: 76.41
Round  61, Train loss: 0.278, Test loss: 0.661, Test accuracy: 76.68
Round  62, Train loss: 0.293, Test loss: 0.688, Test accuracy: 76.25
Round  63, Train loss: 0.312, Test loss: 0.676, Test accuracy: 76.38
Round  64, Train loss: 0.353, Test loss: 0.689, Test accuracy: 76.31
Round  65, Train loss: 0.270, Test loss: 0.701, Test accuracy: 75.64
Round  66, Train loss: 0.288, Test loss: 0.693, Test accuracy: 76.60
Round  67, Train loss: 0.273, Test loss: 0.698, Test accuracy: 75.98
Round  68, Train loss: 0.274, Test loss: 0.708, Test accuracy: 75.98
Round  69, Train loss: 0.259, Test loss: 0.711, Test accuracy: 76.06
Round  70, Train loss: 0.283, Test loss: 0.689, Test accuracy: 76.62
Round  71, Train loss: 0.318, Test loss: 0.687, Test accuracy: 76.61
Round  72, Train loss: 0.239, Test loss: 0.678, Test accuracy: 76.82
Round  73, Train loss: 0.270, Test loss: 0.681, Test accuracy: 76.97
Round  74, Train loss: 0.285, Test loss: 0.689, Test accuracy: 76.95
Round  75, Train loss: 0.228, Test loss: 0.693, Test accuracy: 76.72
Round  76, Train loss: 0.264, Test loss: 0.700, Test accuracy: 77.23
Round  77, Train loss: 0.311, Test loss: 0.710, Test accuracy: 76.63
Round  78, Train loss: 0.255, Test loss: 0.697, Test accuracy: 76.71
Round  79, Train loss: 0.231, Test loss: 0.692, Test accuracy: 77.06
Round  80, Train loss: 0.195, Test loss: 0.699, Test accuracy: 77.19
Round  81, Train loss: 0.178, Test loss: 0.697, Test accuracy: 77.26
Round  82, Train loss: 0.163, Test loss: 0.703, Test accuracy: 77.34
Round  83, Train loss: 0.166, Test loss: 0.704, Test accuracy: 76.92
Round  84, Train loss: 0.162, Test loss: 0.707, Test accuracy: 77.26
Round  85, Train loss: 0.152, Test loss: 0.721, Test accuracy: 77.10
Round  86, Train loss: 0.152, Test loss: 0.716, Test accuracy: 76.98
Round  87, Train loss: 0.137, Test loss: 0.719, Test accuracy: 76.81
Round  88, Train loss: 0.141, Test loss: 0.727, Test accuracy: 76.56
Round  89, Train loss: 0.130, Test loss: 0.721, Test accuracy: 76.79
Round  90, Train loss: 0.233, Test loss: 0.707, Test accuracy: 76.92
Round  91, Train loss: 0.226, Test loss: 0.705, Test accuracy: 77.19
Round  92, Train loss: 0.215, Test loss: 0.706, Test accuracy: 77.17
Round  93, Train loss: 0.210, Test loss: 0.701, Test accuracy: 77.63
Round  94, Train loss: 0.209, Test loss: 0.703, Test accuracy: 77.60
Round  95, Train loss: 0.211, Test loss: 0.701, Test accuracy: 77.80
Round  96, Train loss: 0.206, Test loss: 0.700, Test accuracy: 77.67
Round  97, Train loss: 0.200, Test loss: 0.694, Test accuracy: 77.72
Round  98, Train loss: 0.199, Test loss: 0.726, Test accuracy: 77.18
Round  99, Train loss: 0.193, Test loss: 0.710, Test accuracy: 77.55
Final Round, Train loss: 0.164, Test loss: 0.712, Test accuracy: 77.94
Average accuracy final 10 rounds: 77.443
5013.887048482895
[3.5681304931640625, 7.163569211959839, 10.612482786178589, 14.051170825958252, 17.46432137489319, 21.134363174438477, 24.727501153945923, 28.26421093940735, 31.659322261810303, 35.21372747421265, 38.53834772109985, 41.97845244407654, 45.22285532951355, 48.563862562179565, 51.99930429458618, 55.40185499191284, 58.778942346572876, 62.042967557907104, 65.6166307926178, 68.99523377418518, 72.44115662574768, 78.10672307014465, 83.74698090553284, 89.4317376613617, 95.24008297920227, 100.91685223579407, 106.55302119255066, 112.12321758270264, 118.00463366508484, 124.16802382469177, 129.8156816959381, 135.65512704849243, 141.6778109073639, 147.50630950927734, 153.32286596298218, 159.49854803085327, 165.28349232673645, 171.18111324310303, 177.0702199935913, 183.1363878250122, 189.2266297340393, 195.12946319580078, 200.9701280593872, 207.4647674560547, 213.54089999198914, 219.66735124588013, 225.719300031662, 231.65135765075684, 237.69064354896545, 243.5833384990692, 249.51256895065308, 255.40008974075317, 261.38894724845886, 267.29660511016846, 273.2591927051544, 279.2919874191284, 285.0311803817749, 290.85336804389954, 296.7907180786133, 302.7171964645386, 308.47260642051697, 314.309552192688, 320.2822651863098, 326.10406517982483, 331.81153178215027, 337.72146248817444, 343.45419239997864, 349.55087423324585, 355.28585290908813, 361.1145372390747, 366.909863948822, 372.9375491142273, 379.15779280662537, 385.04495453834534, 390.873015165329, 396.9900050163269, 402.76970863342285, 408.57386779785156, 414.5798804759979, 420.19143772125244, 426.2312343120575, 432.1034924983978, 438.1275954246521, 444.13617062568665, 450.0868926048279, 456.0322062969208, 462.40054392814636, 468.3432626724243, 474.43651962280273, 480.56376004219055, 487.0989315509796, 493.10103583335876, 499.2047538757324, 505.2860038280487, 511.2695233821869, 517.3413395881653, 523.399178981781, 529.481808423996, 535.6832480430603, 542.3297281265259, 547.5340406894684]
[23.05, 34.75, 44.11, 51.24, 55.4, 58.45, 59.08, 61.54, 63.45, 63.5, 63.29, 64.75, 64.73, 66.19, 67.48, 67.96, 68.66, 68.76, 69.41, 69.65, 69.19, 70.05, 70.58, 71.06, 70.92, 71.39, 72.95, 72.85, 73.01, 73.03, 73.15, 73.8, 73.55, 73.57, 73.8, 74.29, 74.71, 74.22, 74.33, 74.04, 73.83, 74.48, 74.06, 74.38, 74.36, 74.58, 75.06, 75.72, 76.34, 76.12, 76.15, 75.54, 76.21, 76.08, 76.62, 76.17, 76.49, 75.85, 76.39, 76.32, 76.41, 76.68, 76.25, 76.38, 76.31, 75.64, 76.6, 75.98, 75.98, 76.06, 76.62, 76.61, 76.82, 76.97, 76.95, 76.72, 77.23, 76.63, 76.71, 77.06, 77.19, 77.26, 77.34, 76.92, 77.26, 77.1, 76.98, 76.81, 76.56, 76.79, 76.92, 77.19, 77.17, 77.63, 77.6, 77.8, 77.67, 77.72, 77.18, 77.55, 77.94]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.645, Test loss: 2.187, Test accuracy: 17.92
Round   0, Global train loss: 1.645, Global test loss: 2.413, Global test accuracy: 12.02
Round   1, Train loss: 1.524, Test loss: 1.947, Test accuracy: 23.94
Round   1, Global train loss: 1.524, Global test loss: 2.360, Global test accuracy: 11.10
Round   2, Train loss: 1.410, Test loss: 1.729, Test accuracy: 30.88
Round   2, Global train loss: 1.410, Global test loss: 2.321, Global test accuracy: 12.50
Round   3, Train loss: 1.349, Test loss: 1.485, Test accuracy: 39.25
Round   3, Global train loss: 1.349, Global test loss: 2.344, Global test accuracy: 13.75
Round   4, Train loss: 1.414, Test loss: 1.380, Test accuracy: 43.51
Round   4, Global train loss: 1.414, Global test loss: 2.322, Global test accuracy: 12.05
Round   5, Train loss: 1.198, Test loss: 1.318, Test accuracy: 46.15
Round   5, Global train loss: 1.198, Global test loss: 2.447, Global test accuracy: 12.24
Round   6, Train loss: 1.097, Test loss: 1.221, Test accuracy: 49.94
Round   6, Global train loss: 1.097, Global test loss: 2.360, Global test accuracy: 12.46
Round   7, Train loss: 1.196, Test loss: 1.193, Test accuracy: 50.92
Round   7, Global train loss: 1.196, Global test loss: 2.457, Global test accuracy: 13.26
Round   8, Train loss: 1.014, Test loss: 1.186, Test accuracy: 51.38
Round   8, Global train loss: 1.014, Global test loss: 2.650, Global test accuracy: 11.73
Round   9, Train loss: 1.175, Test loss: 1.195, Test accuracy: 51.28
Round   9, Global train loss: 1.175, Global test loss: 2.337, Global test accuracy: 11.94
Round  10, Train loss: 1.095, Test loss: 1.186, Test accuracy: 52.27
Round  10, Global train loss: 1.095, Global test loss: 2.400, Global test accuracy: 11.94
Round  11, Train loss: 1.138, Test loss: 1.168, Test accuracy: 53.13
Round  11, Global train loss: 1.138, Global test loss: 2.550, Global test accuracy: 12.59
Round  12, Train loss: 1.042, Test loss: 1.160, Test accuracy: 53.97
Round  12, Global train loss: 1.042, Global test loss: 2.462, Global test accuracy: 14.30
Round  13, Train loss: 1.207, Test loss: 1.147, Test accuracy: 54.70
Round  13, Global train loss: 1.207, Global test loss: 2.347, Global test accuracy: 14.17
Round  14, Train loss: 1.062, Test loss: 1.121, Test accuracy: 55.63
Round  14, Global train loss: 1.062, Global test loss: 2.373, Global test accuracy: 14.50
Round  15, Train loss: 0.961, Test loss: 1.117, Test accuracy: 56.21
Round  15, Global train loss: 0.961, Global test loss: 2.345, Global test accuracy: 13.75
Round  16, Train loss: 0.978, Test loss: 1.121, Test accuracy: 56.55
Round  16, Global train loss: 0.978, Global test loss: 2.383, Global test accuracy: 13.57
Round  17, Train loss: 0.935, Test loss: 1.112, Test accuracy: 56.96
Round  17, Global train loss: 0.935, Global test loss: 2.378, Global test accuracy: 12.96
Round  18, Train loss: 0.829, Test loss: 1.117, Test accuracy: 57.25
Round  18, Global train loss: 0.829, Global test loss: 2.351, Global test accuracy: 14.00
Round  19, Train loss: 0.810, Test loss: 1.118, Test accuracy: 57.20
Round  19, Global train loss: 0.810, Global test loss: 2.417, Global test accuracy: 12.31
Round  20, Train loss: 0.942, Test loss: 1.110, Test accuracy: 57.46
Round  20, Global train loss: 0.942, Global test loss: 2.348, Global test accuracy: 13.23
Round  21, Train loss: 0.908, Test loss: 1.107, Test accuracy: 57.68
Round  21, Global train loss: 0.908, Global test loss: 2.526, Global test accuracy: 12.82
Round  22, Train loss: 0.848, Test loss: 1.112, Test accuracy: 57.78
Round  22, Global train loss: 0.848, Global test loss: 2.355, Global test accuracy: 11.62
Round  23, Train loss: 0.991, Test loss: 1.119, Test accuracy: 57.79
Round  23, Global train loss: 0.991, Global test loss: 2.355, Global test accuracy: 13.41
Round  24, Train loss: 0.818, Test loss: 1.132, Test accuracy: 58.01
Round  24, Global train loss: 0.818, Global test loss: 2.363, Global test accuracy: 14.03
Round  25, Train loss: 0.631, Test loss: 1.135, Test accuracy: 58.39
Round  25, Global train loss: 0.631, Global test loss: 2.421, Global test accuracy: 14.24
Round  26, Train loss: 0.693, Test loss: 1.138, Test accuracy: 58.76
Round  26, Global train loss: 0.693, Global test loss: 2.359, Global test accuracy: 12.67
Round  27, Train loss: 0.681, Test loss: 1.137, Test accuracy: 59.25
Round  27, Global train loss: 0.681, Global test loss: 2.426, Global test accuracy: 12.82
Round  28, Train loss: 0.779, Test loss: 1.110, Test accuracy: 60.29
Round  28, Global train loss: 0.779, Global test loss: 2.375, Global test accuracy: 12.62
Round  29, Train loss: 0.669, Test loss: 1.112, Test accuracy: 59.90
Round  29, Global train loss: 0.669, Global test loss: 2.350, Global test accuracy: 13.48
Round  30, Train loss: 0.698, Test loss: 1.123, Test accuracy: 60.17
Round  30, Global train loss: 0.698, Global test loss: 2.378, Global test accuracy: 13.61
Round  31, Train loss: 0.895, Test loss: 1.154, Test accuracy: 60.05
Round  31, Global train loss: 0.895, Global test loss: 2.350, Global test accuracy: 12.29
Round  32, Train loss: 0.578, Test loss: 1.179, Test accuracy: 59.85
Round  32, Global train loss: 0.578, Global test loss: 2.420, Global test accuracy: 12.63
Round  33, Train loss: 0.617, Test loss: 1.170, Test accuracy: 60.07
Round  33, Global train loss: 0.617, Global test loss: 2.372, Global test accuracy: 13.50
Round  34, Train loss: 0.517, Test loss: 1.186, Test accuracy: 59.97
Round  34, Global train loss: 0.517, Global test loss: 2.461, Global test accuracy: 12.02
Round  35, Train loss: 0.543, Test loss: 1.211, Test accuracy: 60.06
Round  35, Global train loss: 0.543, Global test loss: 2.451, Global test accuracy: 12.41
Round  36, Train loss: 0.680, Test loss: 1.203, Test accuracy: 60.03
Round  36, Global train loss: 0.680, Global test loss: 2.351, Global test accuracy: 13.68
Round  37, Train loss: 0.540, Test loss: 1.230, Test accuracy: 59.67
Round  37, Global train loss: 0.540, Global test loss: 2.397, Global test accuracy: 14.25
Round  38, Train loss: 0.461, Test loss: 1.256, Test accuracy: 60.31
Round  38, Global train loss: 0.461, Global test loss: 2.617, Global test accuracy: 14.56
Round  39, Train loss: 0.595, Test loss: 1.276, Test accuracy: 60.49
Round  39, Global train loss: 0.595, Global test loss: 2.396, Global test accuracy: 12.72
Round  40, Train loss: 0.300, Test loss: 1.262, Test accuracy: 60.27
Round  40, Global train loss: 0.300, Global test loss: 2.410, Global test accuracy: 13.70
Round  41, Train loss: 0.689, Test loss: 1.253, Test accuracy: 60.72
Round  41, Global train loss: 0.689, Global test loss: 2.336, Global test accuracy: 13.06
Round  42, Train loss: 0.563, Test loss: 1.270, Test accuracy: 61.22
Round  42, Global train loss: 0.563, Global test loss: 2.433, Global test accuracy: 11.04
Round  43, Train loss: 0.450, Test loss: 1.303, Test accuracy: 60.91
Round  43, Global train loss: 0.450, Global test loss: 2.492, Global test accuracy: 13.82
Round  44, Train loss: 0.823, Test loss: 1.286, Test accuracy: 60.91
Round  44, Global train loss: 0.823, Global test loss: 2.320, Global test accuracy: 13.32
Round  45, Train loss: 0.545, Test loss: 1.338, Test accuracy: 60.66
Round  45, Global train loss: 0.545, Global test loss: 2.377, Global test accuracy: 14.22
Round  46, Train loss: 0.567, Test loss: 1.352, Test accuracy: 60.59
Round  46, Global train loss: 0.567, Global test loss: 2.340, Global test accuracy: 12.96
Round  47, Train loss: 0.573, Test loss: 1.369, Test accuracy: 60.45
Round  47, Global train loss: 0.573, Global test loss: 2.380, Global test accuracy: 12.47
Round  48, Train loss: 0.448, Test loss: 1.390, Test accuracy: 60.55
Round  48, Global train loss: 0.448, Global test loss: 2.394, Global test accuracy: 11.97
Round  49, Train loss: 0.495, Test loss: 1.383, Test accuracy: 60.49
Round  49, Global train loss: 0.495, Global test loss: 2.316, Global test accuracy: 13.49
Round  50, Train loss: 0.391, Test loss: 1.407, Test accuracy: 60.89
Round  50, Global train loss: 0.391, Global test loss: 2.369, Global test accuracy: 13.16
Round  51, Train loss: 0.329, Test loss: 1.422, Test accuracy: 60.95
Round  51, Global train loss: 0.329, Global test loss: 2.467, Global test accuracy: 11.91
Round  52, Train loss: 0.540, Test loss: 1.449, Test accuracy: 60.64
Round  52, Global train loss: 0.540, Global test loss: 2.590, Global test accuracy: 13.54
Round  53, Train loss: 0.245, Test loss: 1.482, Test accuracy: 60.77
Round  53, Global train loss: 0.245, Global test loss: 2.379, Global test accuracy: 12.74
Round  54, Train loss: 0.479, Test loss: 1.515, Test accuracy: 59.94
Round  54, Global train loss: 0.479, Global test loss: 2.363, Global test accuracy: 12.52
Round  55, Train loss: 0.321, Test loss: 1.529, Test accuracy: 59.68
Round  55, Global train loss: 0.321, Global test loss: 2.392, Global test accuracy: 14.10
Round  56, Train loss: 0.507, Test loss: 1.538, Test accuracy: 60.01
Round  56, Global train loss: 0.507, Global test loss: 2.337, Global test accuracy: 11.71
Round  57, Train loss: 0.489, Test loss: 1.530, Test accuracy: 59.89
Round  57, Global train loss: 0.489, Global test loss: 2.370, Global test accuracy: 12.94
Round  58, Train loss: 0.457, Test loss: 1.561, Test accuracy: 60.48
Round  58, Global train loss: 0.457, Global test loss: 2.372, Global test accuracy: 13.07
Round  59, Train loss: 0.298, Test loss: 1.548, Test accuracy: 60.80
Round  59, Global train loss: 0.298, Global test loss: 2.408, Global test accuracy: 13.40
Round  60, Train loss: 0.328, Test loss: 1.567, Test accuracy: 60.73
Round  60, Global train loss: 0.328, Global test loss: 2.375, Global test accuracy: 13.94
Round  61, Train loss: 0.352, Test loss: 1.640, Test accuracy: 60.10
Round  61, Global train loss: 0.352, Global test loss: 2.367, Global test accuracy: 13.93
Round  62, Train loss: 0.386, Test loss: 1.643, Test accuracy: 59.93
Round  62, Global train loss: 0.386, Global test loss: 2.337, Global test accuracy: 12.44
Round  63, Train loss: 0.268, Test loss: 1.646, Test accuracy: 60.16
Round  63, Global train loss: 0.268, Global test loss: 2.374, Global test accuracy: 13.19
Round  64, Train loss: 0.267, Test loss: 1.666, Test accuracy: 60.38
Round  64, Global train loss: 0.267, Global test loss: 2.395, Global test accuracy: 12.44
Round  65, Train loss: 0.324, Test loss: 1.692, Test accuracy: 60.27
Round  65, Global train loss: 0.324, Global test loss: 2.337, Global test accuracy: 12.53
Round  66, Train loss: 0.272, Test loss: 1.719, Test accuracy: 59.81
Round  66, Global train loss: 0.272, Global test loss: 2.462, Global test accuracy: 12.82
Round  67, Train loss: 0.249, Test loss: 1.748, Test accuracy: 59.60
Round  67, Global train loss: 0.249, Global test loss: 2.436, Global test accuracy: 12.64
Round  68, Train loss: 0.319, Test loss: 1.725, Test accuracy: 59.96
Round  68, Global train loss: 0.319, Global test loss: 2.341, Global test accuracy: 13.37
Round  69, Train loss: 0.324, Test loss: 1.746, Test accuracy: 60.21
Round  69, Global train loss: 0.324, Global test loss: 2.346, Global test accuracy: 13.10
Round  70, Train loss: 0.148, Test loss: 1.722, Test accuracy: 60.81
Round  70, Global train loss: 0.148, Global test loss: 2.489, Global test accuracy: 12.74
Round  71, Train loss: 0.249, Test loss: 1.760, Test accuracy: 60.77
Round  71, Global train loss: 0.249, Global test loss: 2.407, Global test accuracy: 11.72
Round  72, Train loss: 0.199, Test loss: 1.787, Test accuracy: 60.75
Round  72, Global train loss: 0.199, Global test loss: 2.365, Global test accuracy: 14.14
Round  73, Train loss: 0.256, Test loss: 1.827, Test accuracy: 60.19
Round  73, Global train loss: 0.256, Global test loss: 2.438, Global test accuracy: 12.17
Round  74, Train loss: 0.206, Test loss: 1.844, Test accuracy: 60.05
Round  74, Global train loss: 0.206, Global test loss: 2.527, Global test accuracy: 13.17
Round  75, Train loss: 0.146, Test loss: 1.859, Test accuracy: 60.28
Round  75, Global train loss: 0.146, Global test loss: 2.479, Global test accuracy: 13.85
Round  76, Train loss: 0.230, Test loss: 1.845, Test accuracy: 60.21
Round  76, Global train loss: 0.230, Global test loss: 2.433, Global test accuracy: 10.94
Round  77, Train loss: 0.231, Test loss: 1.876, Test accuracy: 59.96
Round  77, Global train loss: 0.231, Global test loss: 2.415, Global test accuracy: 12.54
Round  78, Train loss: 0.214, Test loss: 1.902, Test accuracy: 60.10
Round  78, Global train loss: 0.214, Global test loss: 2.370, Global test accuracy: 12.21
Round  79, Train loss: 0.125, Test loss: 1.936, Test accuracy: 59.74
Round  79, Global train loss: 0.125, Global test loss: 2.513, Global test accuracy: 12.15
Round  80, Train loss: 0.289, Test loss: 1.964, Test accuracy: 59.96
Round  80, Global train loss: 0.289, Global test loss: 2.364, Global test accuracy: 13.23
Round  81, Train loss: 0.110, Test loss: 1.967, Test accuracy: 60.01
Round  81, Global train loss: 0.110, Global test loss: 2.538, Global test accuracy: 15.12
Round  82, Train loss: 0.194, Test loss: 1.965, Test accuracy: 60.83
Round  82, Global train loss: 0.194, Global test loss: 2.360, Global test accuracy: 14.07
Round  83, Train loss: 0.224, Test loss: 2.009, Test accuracy: 60.41
Round  83, Global train loss: 0.224, Global test loss: 2.353, Global test accuracy: 12.21
Round  84, Train loss: 0.136, Test loss: 2.032, Test accuracy: 60.14
Round  84, Global train loss: 0.136, Global test loss: 2.389, Global test accuracy: 12.85
Round  85, Train loss: 0.131, Test loss: 2.061, Test accuracy: 60.38
Round  85, Global train loss: 0.131, Global test loss: 2.404, Global test accuracy: 12.26
Round  86, Train loss: 0.181, Test loss: 2.065, Test accuracy: 60.74
Round  86, Global train loss: 0.181, Global test loss: 2.353, Global test accuracy: 14.72
Round  87, Train loss: 0.206, Test loss: 2.075, Test accuracy: 60.58
Round  87, Global train loss: 0.206, Global test loss: 2.370, Global test accuracy: 14.06
Round  88, Train loss: 0.158, Test loss: 2.098, Test accuracy: 59.96
Round  88, Global train loss: 0.158, Global test loss: 2.421, Global test accuracy: 13.02
Round  89, Train loss: 0.138, Test loss: 2.086, Test accuracy: 59.84
Round  89, Global train loss: 0.138, Global test loss: 2.466, Global test accuracy: 11.79
Round  90, Train loss: 0.210, Test loss: 2.083, Test accuracy: 60.39
Round  90, Global train loss: 0.210, Global test loss: 2.420, Global test accuracy: 10.87
Round  91, Train loss: 0.197, Test loss: 2.119, Test accuracy: 60.28
Round  91, Global train loss: 0.197, Global test loss: 2.377, Global test accuracy: 13.73
Round  92, Train loss: 0.105, Test loss: 2.130, Test accuracy: 60.37
Round  92, Global train loss: 0.105, Global test loss: 2.371, Global test accuracy: 12.81
Round  93, Train loss: 0.150, Test loss: 2.139, Test accuracy: 60.60
Round  93, Global train loss: 0.150, Global test loss: 2.379, Global test accuracy: 12.61
Round  94, Train loss: 0.121, Test loss: 2.127, Test accuracy: 60.39
Round  94, Global train loss: 0.121, Global test loss: 2.418, Global test accuracy: 14.55
Round  95, Train loss: 0.169, Test loss: 2.142, Test accuracy: 59.74
Round  95, Global train loss: 0.169, Global test loss: 2.360, Global test accuracy: 12.77
Round  96, Train loss: 0.137, Test loss: 2.160, Test accuracy: 59.74
Round  96, Global train loss: 0.137, Global test loss: 2.383, Global test accuracy: 14.40
Round  97, Train loss: 0.122, Test loss: 2.158, Test accuracy: 60.15
Round  97, Global train loss: 0.122, Global test loss: 2.363, Global test accuracy: 12.20
Round  98, Train loss: 0.150, Test loss: 2.190, Test accuracy: 60.30
Round  98, Global train loss: 0.150, Global test loss: 2.358, Global test accuracy: 12.33
Round  99, Train loss: 0.103, Test loss: 2.208, Test accuracy: 60.79
Round  99, Global train loss: 0.103, Global test loss: 2.332, Global test accuracy: 14.88
Final Round, Train loss: 0.131, Test loss: 2.257, Test accuracy: 60.32
Final Round, Global train loss: 0.131, Global test loss: 2.332, Global test accuracy: 14.88
Average accuracy final 10 rounds: 60.27500000000001 

Average global accuracy final 10 rounds: 13.115 

1838.31995511055
[2.199993848800659, 4.399987697601318, 6.460143566131592, 8.520299434661865, 10.104114770889282, 11.6879301071167, 13.262537479400635, 14.83714485168457, 16.41248106956482, 17.98781728744507, 19.43882179260254, 20.88982629776001, 22.402755737304688, 23.915685176849365, 25.449767112731934, 26.983849048614502, 28.583029985427856, 30.18221092224121, 31.75433897972107, 33.32646703720093, 34.9948992729187, 36.663331508636475, 38.17220854759216, 39.68108558654785, 41.268301248550415, 42.85551691055298, 44.53974771499634, 46.2239785194397, 47.692272663116455, 49.16056680679321, 50.6518657207489, 52.14316463470459, 53.60795521736145, 55.07274580001831, 56.48221492767334, 57.89168405532837, 59.34200072288513, 60.792317390441895, 62.34159779548645, 63.890878200531006, 65.45564484596252, 67.02041149139404, 68.592355966568, 70.16430044174194, 71.82729530334473, 73.49029016494751, 75.03695869445801, 76.5836272239685, 78.13172030448914, 79.67981338500977, 81.18447780609131, 82.68914222717285, 84.16351985931396, 85.63789749145508, 87.14047956466675, 88.64306163787842, 90.21363043785095, 91.78419923782349, 93.55502390861511, 95.32584857940674, 97.09520888328552, 98.8645691871643, 100.50365352630615, 102.142737865448, 103.72958993911743, 105.31644201278687, 106.85226082801819, 108.38807964324951, 109.86734247207642, 111.34660530090332, 113.01599669456482, 114.68538808822632, 116.31448221206665, 117.94357633590698, 119.54582905769348, 121.14808177947998, 122.78227877616882, 124.41647577285767, 125.9733874797821, 127.53029918670654, 129.01225352287292, 130.4942078590393, 132.04685759544373, 133.59950733184814, 135.07808876037598, 136.5566701889038, 138.0448546409607, 139.53303909301758, 141.07577538490295, 142.61851167678833, 144.25920486450195, 145.89989805221558, 147.51432466506958, 149.12875127792358, 150.61431908607483, 152.09988689422607, 153.63373374938965, 155.16758060455322, 156.66847801208496, 158.1693754196167, 159.68298196792603, 161.19658851623535, 162.73889303207397, 164.2811975479126, 165.87408423423767, 167.46697092056274, 169.10871696472168, 170.75046300888062, 172.5742666721344, 174.39807033538818, 175.9348373413086, 177.471604347229, 178.95199036598206, 180.4323763847351, 181.9338037967682, 183.43523120880127, 184.95942068099976, 186.48361015319824, 188.12899684906006, 189.77438354492188, 191.34207892417908, 192.90977430343628, 194.42254114151, 195.93530797958374, 197.39442229270935, 198.85353660583496, 200.42232513427734, 201.99111366271973, 203.62374138832092, 205.25636911392212, 206.88381028175354, 208.51125144958496, 210.19749927520752, 211.88374710083008, 213.45621967315674, 215.0286922454834, 216.63625621795654, 218.2438201904297, 219.7893693447113, 221.33491849899292, 222.81679916381836, 224.2986798286438, 225.9650559425354, 227.631432056427, 229.2255265712738, 230.8196210861206, 232.30320143699646, 233.78678178787231, 235.47514081001282, 237.16349983215332, 238.70121598243713, 240.23893213272095, 241.7311761379242, 243.22342014312744, 244.69368171691895, 246.16394329071045, 247.70578265190125, 249.24762201309204, 250.80730986595154, 252.36699771881104, 253.97742867469788, 255.58785963058472, 257.1877055168152, 258.78755140304565, 260.2666895389557, 261.7458276748657, 263.36419558525085, 264.982563495636, 266.51645851135254, 268.0503535270691, 269.5638358592987, 271.0773181915283, 272.6290147304535, 274.18071126937866, 275.68624210357666, 277.19177293777466, 278.6587507724762, 280.12572860717773, 281.78596210479736, 283.446195602417, 284.8776412010193, 286.3090867996216, 287.83253145217896, 289.3559761047363, 290.82399463653564, 292.29201316833496, 293.818781375885, 295.34554958343506, 296.9716725349426, 298.5977954864502, 300.1375803947449, 301.67736530303955, 303.15668749809265, 304.63600969314575, 306.1808590888977, 307.72570848464966, 309.17277002334595, 310.61983156204224, 312.15186643600464, 313.68390130996704, 316.76586985588074, 319.84783840179443]
[17.92, 17.92, 23.94, 23.94, 30.88, 30.88, 39.25, 39.25, 43.51, 43.51, 46.15, 46.15, 49.94, 49.94, 50.92, 50.92, 51.38, 51.38, 51.28, 51.28, 52.27, 52.27, 53.13, 53.13, 53.97, 53.97, 54.7, 54.7, 55.63, 55.63, 56.21, 56.21, 56.55, 56.55, 56.96, 56.96, 57.25, 57.25, 57.2, 57.2, 57.46, 57.46, 57.68, 57.68, 57.78, 57.78, 57.79, 57.79, 58.01, 58.01, 58.39, 58.39, 58.76, 58.76, 59.25, 59.25, 60.29, 60.29, 59.9, 59.9, 60.17, 60.17, 60.05, 60.05, 59.85, 59.85, 60.07, 60.07, 59.97, 59.97, 60.06, 60.06, 60.03, 60.03, 59.67, 59.67, 60.31, 60.31, 60.49, 60.49, 60.27, 60.27, 60.72, 60.72, 61.22, 61.22, 60.91, 60.91, 60.91, 60.91, 60.66, 60.66, 60.59, 60.59, 60.45, 60.45, 60.55, 60.55, 60.49, 60.49, 60.89, 60.89, 60.95, 60.95, 60.64, 60.64, 60.77, 60.77, 59.94, 59.94, 59.68, 59.68, 60.01, 60.01, 59.89, 59.89, 60.48, 60.48, 60.8, 60.8, 60.73, 60.73, 60.1, 60.1, 59.93, 59.93, 60.16, 60.16, 60.38, 60.38, 60.27, 60.27, 59.81, 59.81, 59.6, 59.6, 59.96, 59.96, 60.21, 60.21, 60.81, 60.81, 60.77, 60.77, 60.75, 60.75, 60.19, 60.19, 60.05, 60.05, 60.28, 60.28, 60.21, 60.21, 59.96, 59.96, 60.1, 60.1, 59.74, 59.74, 59.96, 59.96, 60.01, 60.01, 60.83, 60.83, 60.41, 60.41, 60.14, 60.14, 60.38, 60.38, 60.74, 60.74, 60.58, 60.58, 59.96, 59.96, 59.84, 59.84, 60.39, 60.39, 60.28, 60.28, 60.37, 60.37, 60.6, 60.6, 60.39, 60.39, 59.74, 59.74, 59.74, 59.74, 60.15, 60.15, 60.3, 60.3, 60.79, 60.79, 60.32, 60.32]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.607, Test loss: 2.126, Test accuracy: 18.69
Round   0, Global train loss: 1.607, Global test loss: 2.366, Global test accuracy: 13.76
Round   1, Train loss: 1.473, Test loss: 2.003, Test accuracy: 25.38
Round   1, Global train loss: 1.473, Global test loss: 2.519, Global test accuracy: 12.63
Round   2, Train loss: 1.440, Test loss: 1.810, Test accuracy: 30.24
Round   2, Global train loss: 1.440, Global test loss: 2.583, Global test accuracy: 10.99
Round   3, Train loss: 1.369, Test loss: 1.544, Test accuracy: 39.37
Round   3, Global train loss: 1.369, Global test loss: 2.559, Global test accuracy: 15.00
Round   4, Train loss: 1.344, Test loss: 1.410, Test accuracy: 42.97
Round   4, Global train loss: 1.344, Global test loss: 2.491, Global test accuracy: 11.85
Round   5, Train loss: 1.254, Test loss: 1.310, Test accuracy: 45.61
Round   5, Global train loss: 1.254, Global test loss: 2.474, Global test accuracy: 10.65
Round   6, Train loss: 1.268, Test loss: 1.244, Test accuracy: 49.59
Round   6, Global train loss: 1.268, Global test loss: 2.405, Global test accuracy: 11.57
Round   7, Train loss: 1.313, Test loss: 1.202, Test accuracy: 52.47
Round   7, Global train loss: 1.313, Global test loss: 2.404, Global test accuracy: 15.04
Round   8, Train loss: 1.151, Test loss: 1.170, Test accuracy: 53.63
Round   8, Global train loss: 1.151, Global test loss: 2.548, Global test accuracy: 11.62
Round   9, Train loss: 1.245, Test loss: 1.147, Test accuracy: 54.71
Round   9, Global train loss: 1.245, Global test loss: 2.731, Global test accuracy: 13.14
Round  10, Train loss: 1.261, Test loss: 1.117, Test accuracy: 56.24
Round  10, Global train loss: 1.261, Global test loss: 2.550, Global test accuracy: 15.58
Round  11, Train loss: 1.164, Test loss: 1.105, Test accuracy: 56.77
Round  11, Global train loss: 1.164, Global test loss: 2.541, Global test accuracy: 14.64
Round  12, Train loss: 1.278, Test loss: 1.099, Test accuracy: 57.31
Round  12, Global train loss: 1.278, Global test loss: 2.468, Global test accuracy: 14.67
Round  13, Train loss: 1.125, Test loss: 1.097, Test accuracy: 57.59
Round  13, Global train loss: 1.125, Global test loss: 2.505, Global test accuracy: 11.60
Round  14, Train loss: 1.249, Test loss: 1.078, Test accuracy: 58.12
Round  14, Global train loss: 1.249, Global test loss: 2.465, Global test accuracy: 13.55
Round  15, Train loss: 1.150, Test loss: 1.081, Test accuracy: 58.33
Round  15, Global train loss: 1.150, Global test loss: 2.551, Global test accuracy: 13.98
Round  16, Train loss: 1.179, Test loss: 1.066, Test accuracy: 59.06
Round  16, Global train loss: 1.179, Global test loss: 2.373, Global test accuracy: 13.40
Round  17, Train loss: 1.021, Test loss: 1.041, Test accuracy: 60.19
Round  17, Global train loss: 1.021, Global test loss: 2.425, Global test accuracy: 15.04
Round  18, Train loss: 1.116, Test loss: 1.037, Test accuracy: 59.84
Round  18, Global train loss: 1.116, Global test loss: 2.416, Global test accuracy: 14.17
Round  19, Train loss: 0.953, Test loss: 1.029, Test accuracy: 60.51
Round  19, Global train loss: 0.953, Global test loss: 2.524, Global test accuracy: 12.63
Round  20, Train loss: 1.002, Test loss: 1.022, Test accuracy: 60.83
Round  20, Global train loss: 1.002, Global test loss: 2.657, Global test accuracy: 14.33
Round  21, Train loss: 0.958, Test loss: 1.015, Test accuracy: 61.48
Round  21, Global train loss: 0.958, Global test loss: 2.505, Global test accuracy: 16.11
Round  22, Train loss: 0.941, Test loss: 1.011, Test accuracy: 61.73
Round  22, Global train loss: 0.941, Global test loss: 2.782, Global test accuracy: 13.63
Round  23, Train loss: 1.160, Test loss: 1.012, Test accuracy: 61.75
Round  23, Global train loss: 1.160, Global test loss: 2.448, Global test accuracy: 14.56
Round  24, Train loss: 0.944, Test loss: 0.992, Test accuracy: 62.00
Round  24, Global train loss: 0.944, Global test loss: 2.776, Global test accuracy: 14.61
Round  25, Train loss: 0.943, Test loss: 0.994, Test accuracy: 62.28
Round  25, Global train loss: 0.943, Global test loss: 2.623, Global test accuracy: 15.10
Round  26, Train loss: 1.043, Test loss: 0.985, Test accuracy: 62.68
Round  26, Global train loss: 1.043, Global test loss: 2.500, Global test accuracy: 14.84
Round  27, Train loss: 0.997, Test loss: 0.981, Test accuracy: 63.17
Round  27, Global train loss: 0.997, Global test loss: 2.615, Global test accuracy: 14.20
Round  28, Train loss: 1.040, Test loss: 0.980, Test accuracy: 63.28
Round  28, Global train loss: 1.040, Global test loss: 2.572, Global test accuracy: 15.77
Round  29, Train loss: 0.974, Test loss: 0.966, Test accuracy: 64.15
Round  29, Global train loss: 0.974, Global test loss: 2.474, Global test accuracy: 16.19
Round  30, Train loss: 0.881, Test loss: 0.970, Test accuracy: 63.86
Round  30, Global train loss: 0.881, Global test loss: 2.666, Global test accuracy: 11.85
Round  31, Train loss: 0.864, Test loss: 0.967, Test accuracy: 64.62
Round  31, Global train loss: 0.864, Global test loss: 2.681, Global test accuracy: 13.50
Round  32, Train loss: 0.941, Test loss: 0.970, Test accuracy: 64.48
Round  32, Global train loss: 0.941, Global test loss: 2.623, Global test accuracy: 15.85
Round  33, Train loss: 0.813, Test loss: 0.972, Test accuracy: 64.66
Round  33, Global train loss: 0.813, Global test loss: 2.761, Global test accuracy: 13.79
Round  34, Train loss: 0.754, Test loss: 0.959, Test accuracy: 65.18
Round  34, Global train loss: 0.754, Global test loss: 2.756, Global test accuracy: 14.49
Round  35, Train loss: 0.861, Test loss: 0.973, Test accuracy: 64.90
Round  35, Global train loss: 0.861, Global test loss: 2.629, Global test accuracy: 13.47
Round  36, Train loss: 0.878, Test loss: 0.967, Test accuracy: 65.02
Round  36, Global train loss: 0.878, Global test loss: 2.704, Global test accuracy: 13.11
Round  37, Train loss: 0.900, Test loss: 0.973, Test accuracy: 65.10
Round  37, Global train loss: 0.900, Global test loss: 2.773, Global test accuracy: 13.05
Round  38, Train loss: 0.960, Test loss: 0.973, Test accuracy: 64.83
Round  38, Global train loss: 0.960, Global test loss: 2.559, Global test accuracy: 14.80
Round  39, Train loss: 0.802, Test loss: 0.977, Test accuracy: 64.95
Round  39, Global train loss: 0.802, Global test loss: 2.878, Global test accuracy: 12.72
Round  40, Train loss: 0.856, Test loss: 0.984, Test accuracy: 65.07
Round  40, Global train loss: 0.856, Global test loss: 2.977, Global test accuracy: 12.73
Round  41, Train loss: 0.843, Test loss: 0.989, Test accuracy: 64.88
Round  41, Global train loss: 0.843, Global test loss: 2.601, Global test accuracy: 13.29
Round  42, Train loss: 0.757, Test loss: 0.989, Test accuracy: 65.10
Round  42, Global train loss: 0.757, Global test loss: 2.826, Global test accuracy: 14.49
Round  43, Train loss: 0.747, Test loss: 1.004, Test accuracy: 64.66
Round  43, Global train loss: 0.747, Global test loss: 2.917, Global test accuracy: 13.28
Round  44, Train loss: 0.891, Test loss: 1.021, Test accuracy: 64.38
Round  44, Global train loss: 0.891, Global test loss: 2.671, Global test accuracy: 13.41
Round  45, Train loss: 0.844, Test loss: 1.007, Test accuracy: 64.81
Round  45, Global train loss: 0.844, Global test loss: 2.709, Global test accuracy: 15.34
Round  46, Train loss: 0.932, Test loss: 0.992, Test accuracy: 65.46
Round  46, Global train loss: 0.932, Global test loss: 2.773, Global test accuracy: 14.98
Round  47, Train loss: 0.837, Test loss: 1.009, Test accuracy: 64.78
Round  47, Global train loss: 0.837, Global test loss: 2.653, Global test accuracy: 14.55
Round  48, Train loss: 0.825, Test loss: 1.006, Test accuracy: 65.07
Round  48, Global train loss: 0.825, Global test loss: 2.843, Global test accuracy: 14.14
Round  49, Train loss: 0.800, Test loss: 1.041, Test accuracy: 64.14
Round  49, Global train loss: 0.800, Global test loss: 2.911, Global test accuracy: 14.24
Round  50, Train loss: 0.660, Test loss: 1.044, Test accuracy: 64.39
Round  50, Global train loss: 0.660, Global test loss: 3.180, Global test accuracy: 12.86
Round  51, Train loss: 0.751, Test loss: 1.025, Test accuracy: 64.93
Round  51, Global train loss: 0.751, Global test loss: 2.919, Global test accuracy: 14.27
Round  52, Train loss: 0.957, Test loss: 1.039, Test accuracy: 64.64
Round  52, Global train loss: 0.957, Global test loss: 2.680, Global test accuracy: 13.66
Round  53, Train loss: 0.801, Test loss: 1.024, Test accuracy: 64.85
Round  53, Global train loss: 0.801, Global test loss: 2.931, Global test accuracy: 14.83
Round  54, Train loss: 0.790, Test loss: 1.048, Test accuracy: 64.46
Round  54, Global train loss: 0.790, Global test loss: 2.827, Global test accuracy: 14.11
Round  55, Train loss: 0.770, Test loss: 1.043, Test accuracy: 65.00
Round  55, Global train loss: 0.770, Global test loss: 3.144, Global test accuracy: 13.73
Round  56, Train loss: 0.752, Test loss: 1.023, Test accuracy: 65.40
Round  56, Global train loss: 0.752, Global test loss: 2.849, Global test accuracy: 13.40
Round  57, Train loss: 0.753, Test loss: 1.043, Test accuracy: 65.00
Round  57, Global train loss: 0.753, Global test loss: 2.770, Global test accuracy: 13.61
Round  58, Train loss: 0.690, Test loss: 1.062, Test accuracy: 64.92
Round  58, Global train loss: 0.690, Global test loss: 2.907, Global test accuracy: 13.68
Round  59, Train loss: 0.610, Test loss: 1.061, Test accuracy: 65.40
Round  59, Global train loss: 0.610, Global test loss: 3.145, Global test accuracy: 14.97
Round  60, Train loss: 0.710, Test loss: 1.048, Test accuracy: 65.26
Round  60, Global train loss: 0.710, Global test loss: 2.852, Global test accuracy: 14.08
Round  61, Train loss: 0.705, Test loss: 1.073, Test accuracy: 65.10
Round  61, Global train loss: 0.705, Global test loss: 2.936, Global test accuracy: 14.01
Round  62, Train loss: 0.682, Test loss: 1.063, Test accuracy: 65.08
Round  62, Global train loss: 0.682, Global test loss: 2.915, Global test accuracy: 14.06
Round  63, Train loss: 0.667, Test loss: 1.063, Test accuracy: 65.01
Round  63, Global train loss: 0.667, Global test loss: 3.017, Global test accuracy: 13.26
Round  64, Train loss: 0.594, Test loss: 1.058, Test accuracy: 65.59
Round  64, Global train loss: 0.594, Global test loss: 2.972, Global test accuracy: 14.20
Round  65, Train loss: 0.665, Test loss: 1.089, Test accuracy: 64.73
Round  65, Global train loss: 0.665, Global test loss: 3.055, Global test accuracy: 14.03
Round  66, Train loss: 0.609, Test loss: 1.104, Test accuracy: 64.91
Round  66, Global train loss: 0.609, Global test loss: 3.155, Global test accuracy: 14.60
Round  67, Train loss: 0.738, Test loss: 1.073, Test accuracy: 65.88
Round  67, Global train loss: 0.738, Global test loss: 3.137, Global test accuracy: 13.89
Round  68, Train loss: 0.644, Test loss: 1.066, Test accuracy: 65.96
Round  68, Global train loss: 0.644, Global test loss: 3.171, Global test accuracy: 13.72
Round  69, Train loss: 0.590, Test loss: 1.075, Test accuracy: 65.86
Round  69, Global train loss: 0.590, Global test loss: 3.251, Global test accuracy: 14.19
Round  70, Train loss: 0.731, Test loss: 1.093, Test accuracy: 65.26
Round  70, Global train loss: 0.731, Global test loss: 2.958, Global test accuracy: 14.32
Round  71, Train loss: 0.694, Test loss: 1.079, Test accuracy: 65.53
Round  71, Global train loss: 0.694, Global test loss: 3.212, Global test accuracy: 13.67
Round  72, Train loss: 0.636, Test loss: 1.071, Test accuracy: 66.05
Round  72, Global train loss: 0.636, Global test loss: 3.144, Global test accuracy: 14.43
Round  73, Train loss: 0.646, Test loss: 1.105, Test accuracy: 65.29
Round  73, Global train loss: 0.646, Global test loss: 2.930, Global test accuracy: 14.31
Round  74, Train loss: 0.540, Test loss: 1.103, Test accuracy: 65.18
Round  74, Global train loss: 0.540, Global test loss: 3.033, Global test accuracy: 14.51
Round  75, Train loss: 0.480, Test loss: 1.102, Test accuracy: 65.41
Round  75, Global train loss: 0.480, Global test loss: 3.294, Global test accuracy: 15.26
Round  76, Train loss: 0.595, Test loss: 1.121, Test accuracy: 65.29
Round  76, Global train loss: 0.595, Global test loss: 3.702, Global test accuracy: 13.06
Round  77, Train loss: 0.656, Test loss: 1.101, Test accuracy: 65.59
Round  77, Global train loss: 0.656, Global test loss: 3.219, Global test accuracy: 14.72
Round  78, Train loss: 0.591, Test loss: 1.097, Test accuracy: 65.67
Round  78, Global train loss: 0.591, Global test loss: 3.153, Global test accuracy: 14.49
Round  79, Train loss: 0.470, Test loss: 1.096, Test accuracy: 65.93
Round  79, Global train loss: 0.470, Global test loss: 3.378, Global test accuracy: 14.12
Round  80, Train loss: 0.624, Test loss: 1.086, Test accuracy: 66.36
Round  80, Global train loss: 0.624, Global test loss: 3.139, Global test accuracy: 14.24
Round  81, Train loss: 0.582, Test loss: 1.090, Test accuracy: 66.21
Round  81, Global train loss: 0.582, Global test loss: 3.283, Global test accuracy: 15.89
Round  82, Train loss: 0.529, Test loss: 1.109, Test accuracy: 65.75
Round  82, Global train loss: 0.529, Global test loss: 3.392, Global test accuracy: 13.30
Round  83, Train loss: 0.526, Test loss: 1.120, Test accuracy: 65.75
Round  83, Global train loss: 0.526, Global test loss: 3.491, Global test accuracy: 12.86
Round  84, Train loss: 0.553, Test loss: 1.131, Test accuracy: 65.40
Round  84, Global train loss: 0.553, Global test loss: 3.265, Global test accuracy: 14.42
Round  85, Train loss: 0.643, Test loss: 1.142, Test accuracy: 65.36
Round  85, Global train loss: 0.643, Global test loss: 3.232, Global test accuracy: 13.76
Round  86, Train loss: 0.560, Test loss: 1.149, Test accuracy: 65.60
Round  86, Global train loss: 0.560, Global test loss: 3.182, Global test accuracy: 14.23
Round  87, Train loss: 0.546, Test loss: 1.170, Test accuracy: 65.39
Round  87, Global train loss: 0.546, Global test loss: 3.317, Global test accuracy: 13.32
Round  88, Train loss: 0.447, Test loss: 1.166, Test accuracy: 65.49
Round  88, Global train loss: 0.447, Global test loss: 3.697, Global test accuracy: 13.72
Round  89, Train loss: 0.526, Test loss: 1.180, Test accuracy: 65.51
Round  89, Global train loss: 0.526, Global test loss: 3.554, Global test accuracy: 14.51
Round  90, Train loss: 0.549, Test loss: 1.204, Test accuracy: 65.32
Round  90, Global train loss: 0.549, Global test loss: 3.226, Global test accuracy: 13.60
Round  91, Train loss: 0.601, Test loss: 1.192, Test accuracy: 65.26
Round  91, Global train loss: 0.601, Global test loss: 3.358, Global test accuracy: 13.64
Round  92, Train loss: 0.632, Test loss: 1.202, Test accuracy: 64.92
Round  92, Global train loss: 0.632, Global test loss: 3.193, Global test accuracy: 14.61
Round  93, Train loss: 0.583, Test loss: 1.198, Test accuracy: 64.71
Round  93, Global train loss: 0.583, Global test loss: 3.350, Global test accuracy: 13.91
Round  94, Train loss: 0.574, Test loss: 1.213, Test accuracy: 64.26
Round  94, Global train loss: 0.574, Global test loss: 3.412, Global test accuracy: 13.91
Round  95, Train loss: 0.553, Test loss: 1.192, Test accuracy: 64.92
Round  95, Global train loss: 0.553, Global test loss: 3.369, Global test accuracy: 14.58
Round  96, Train loss: 0.467, Test loss: 1.194, Test accuracy: 65.21
Round  96, Global train loss: 0.467, Global test loss: 3.474, Global test accuracy: 14.94
Round  97, Train loss: 0.573, Test loss: 1.183, Test accuracy: 65.77
Round  97, Global train loss: 0.573, Global test loss: 3.303, Global test accuracy: 13.35
Round  98, Train loss: 0.457, Test loss: 1.191, Test accuracy: 65.45
Round  98, Global train loss: 0.457, Global test loss: 3.324, Global test accuracy: 13.90
Round  99, Train loss: 0.494, Test loss: 1.198, Test accuracy: 65.24
Round  99, Global train loss: 0.494, Global test loss: 3.347, Global test accuracy: 14.26
Final Round, Train loss: 0.430, Test loss: 1.296, Test accuracy: 66.07
Final Round, Global train loss: 0.430, Global test loss: 3.347, Global test accuracy: 14.26
Average accuracy final 10 rounds: 65.106 

Average global accuracy final 10 rounds: 14.070000000000002 

1825.0840680599213
[1.7131977081298828, 3.4263954162597656, 5.007246017456055, 6.588096618652344, 8.157163619995117, 9.72623062133789, 11.175978422164917, 12.625726222991943, 14.222463130950928, 15.819200038909912, 17.31776714324951, 18.81633424758911, 20.246924877166748, 21.677515506744385, 23.12399911880493, 24.57048273086548, 26.058239936828613, 27.545997142791748, 29.151970148086548, 30.757943153381348, 32.27542042732239, 33.79289770126343, 35.32124638557434, 36.849595069885254, 38.3758807182312, 39.90216636657715, 41.3263783454895, 42.750590324401855, 44.29636478424072, 45.84213924407959, 47.30668807029724, 48.77123689651489, 50.35851693153381, 51.945796966552734, 53.438475608825684, 54.93115425109863, 56.527077436447144, 58.123000621795654, 59.5785276889801, 61.03405475616455, 62.490596771240234, 63.94713878631592, 65.48689818382263, 67.02665758132935, 68.63537812232971, 70.24409866333008, 71.76128363609314, 73.2784686088562, 74.8206102848053, 76.3627519607544, 77.82561111450195, 79.28847026824951, 80.80529117584229, 82.32211208343506, 83.83278727531433, 85.3434624671936, 86.939120054245, 88.53477764129639, 90.08063530921936, 91.62649297714233, 93.1249167919159, 94.62334060668945, 96.10750961303711, 97.59167861938477, 99.20923185348511, 100.82678508758545, 102.45748543739319, 104.08818578720093, 105.64148759841919, 107.19478940963745, 108.8140127658844, 110.43323612213135, 111.92173194885254, 113.41022777557373, 115.0893292427063, 116.76843070983887, 118.29645156860352, 119.82447242736816, 121.47139430046082, 123.11831617355347, 124.61349105834961, 126.10866594314575, 127.5349805355072, 128.96129512786865, 130.4372832775116, 131.91327142715454, 133.556875705719, 135.20047998428345, 136.6628134250641, 138.12514686584473, 139.89620399475098, 141.66726112365723, 143.14890694618225, 144.63055276870728, 146.10247468948364, 147.57439661026, 149.1088252067566, 150.64325380325317, 152.12885808944702, 153.61446237564087, 155.05941009521484, 156.50435781478882, 158.01999139785767, 159.5356249809265, 160.97655773162842, 162.41749048233032, 163.9105100631714, 165.40352964401245, 166.92997813224792, 168.4564266204834, 170.0943353176117, 171.73224401474, 173.27623677253723, 174.82022953033447, 176.34107375144958, 177.8619179725647, 179.46122455596924, 181.06053113937378, 182.51886653900146, 183.97720193862915, 185.410395860672, 186.84358978271484, 188.31802678108215, 189.79246377944946, 191.30688285827637, 192.82130193710327, 194.45338249206543, 196.0854630470276, 197.64227294921875, 199.1990828514099, 200.6323881149292, 202.0656933784485, 203.5142662525177, 204.9628391265869, 206.4467363357544, 207.93063354492188, 209.49228358268738, 211.05393362045288, 212.6208963394165, 214.18785905838013, 215.67841863632202, 217.16897821426392, 218.76493191719055, 220.3608856201172, 221.83733558654785, 223.31378555297852, 224.7262783050537, 226.1387710571289, 227.73405504226685, 229.32933902740479, 230.80667757987976, 232.28401613235474, 233.88555884361267, 235.4871015548706, 236.9531750679016, 238.41924858093262, 239.97506093978882, 241.53087329864502, 242.9946324825287, 244.45839166641235, 245.97430896759033, 247.4902262687683, 249.0826985836029, 250.6751708984375, 252.24208331108093, 253.80899572372437, 255.4949734210968, 257.18095111846924, 258.88806772232056, 260.5951843261719, 262.0527939796448, 263.5104036331177, 265.16185092926025, 266.81329822540283, 268.32040309906006, 269.8275079727173, 271.37612771987915, 272.924747467041, 274.46828603744507, 276.0118246078491, 277.54200506210327, 279.0721855163574, 280.8008713722229, 282.5295572280884, 284.02831411361694, 285.5270709991455, 287.0388927459717, 288.55071449279785, 289.90593695640564, 291.2611594200134, 292.7363498210907, 294.21154022216797, 295.67148780822754, 297.1314353942871, 298.7056722640991, 300.27990913391113, 301.7654733657837, 303.25103759765625, 304.67398166656494, 306.09692573547363, 309.24023056030273, 312.38353538513184]
[18.69, 18.69, 25.38, 25.38, 30.24, 30.24, 39.37, 39.37, 42.97, 42.97, 45.61, 45.61, 49.59, 49.59, 52.47, 52.47, 53.63, 53.63, 54.71, 54.71, 56.24, 56.24, 56.77, 56.77, 57.31, 57.31, 57.59, 57.59, 58.12, 58.12, 58.33, 58.33, 59.06, 59.06, 60.19, 60.19, 59.84, 59.84, 60.51, 60.51, 60.83, 60.83, 61.48, 61.48, 61.73, 61.73, 61.75, 61.75, 62.0, 62.0, 62.28, 62.28, 62.68, 62.68, 63.17, 63.17, 63.28, 63.28, 64.15, 64.15, 63.86, 63.86, 64.62, 64.62, 64.48, 64.48, 64.66, 64.66, 65.18, 65.18, 64.9, 64.9, 65.02, 65.02, 65.1, 65.1, 64.83, 64.83, 64.95, 64.95, 65.07, 65.07, 64.88, 64.88, 65.1, 65.1, 64.66, 64.66, 64.38, 64.38, 64.81, 64.81, 65.46, 65.46, 64.78, 64.78, 65.07, 65.07, 64.14, 64.14, 64.39, 64.39, 64.93, 64.93, 64.64, 64.64, 64.85, 64.85, 64.46, 64.46, 65.0, 65.0, 65.4, 65.4, 65.0, 65.0, 64.92, 64.92, 65.4, 65.4, 65.26, 65.26, 65.1, 65.1, 65.08, 65.08, 65.01, 65.01, 65.59, 65.59, 64.73, 64.73, 64.91, 64.91, 65.88, 65.88, 65.96, 65.96, 65.86, 65.86, 65.26, 65.26, 65.53, 65.53, 66.05, 66.05, 65.29, 65.29, 65.18, 65.18, 65.41, 65.41, 65.29, 65.29, 65.59, 65.59, 65.67, 65.67, 65.93, 65.93, 66.36, 66.36, 66.21, 66.21, 65.75, 65.75, 65.75, 65.75, 65.4, 65.4, 65.36, 65.36, 65.6, 65.6, 65.39, 65.39, 65.49, 65.49, 65.51, 65.51, 65.32, 65.32, 65.26, 65.26, 64.92, 64.92, 64.71, 64.71, 64.26, 64.26, 64.92, 64.92, 65.21, 65.21, 65.77, 65.77, 65.45, 65.45, 65.24, 65.24, 66.07, 66.07]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.606, Test loss: 2.078, Test accuracy: 17.91
Round   0, Global train loss: 1.606, Global test loss: 2.324, Global test accuracy: 10.86
Round   1, Train loss: 1.498, Test loss: 2.010, Test accuracy: 24.20
Round   1, Global train loss: 1.498, Global test loss: 2.443, Global test accuracy: 12.46
Round   2, Train loss: 1.472, Test loss: 1.861, Test accuracy: 29.97
Round   2, Global train loss: 1.472, Global test loss: 2.476, Global test accuracy: 12.51
Round   3, Train loss: 1.409, Test loss: 1.516, Test accuracy: 38.65
Round   3, Global train loss: 1.409, Global test loss: 2.371, Global test accuracy: 14.69
Round   4, Train loss: 1.420, Test loss: 1.429, Test accuracy: 42.48
Round   4, Global train loss: 1.420, Global test loss: 2.341, Global test accuracy: 13.61
Round   5, Train loss: 1.392, Test loss: 1.369, Test accuracy: 44.86
Round   5, Global train loss: 1.392, Global test loss: 2.521, Global test accuracy: 11.04
Round   6, Train loss: 1.328, Test loss: 1.261, Test accuracy: 48.95
Round   6, Global train loss: 1.328, Global test loss: 2.473, Global test accuracy: 13.49
Round   7, Train loss: 1.221, Test loss: 1.225, Test accuracy: 49.94
Round   7, Global train loss: 1.221, Global test loss: 2.294, Global test accuracy: 16.50
Round   8, Train loss: 1.262, Test loss: 1.219, Test accuracy: 50.29
Round   8, Global train loss: 1.262, Global test loss: 2.395, Global test accuracy: 14.80
Round   9, Train loss: 1.243, Test loss: 1.206, Test accuracy: 50.83
Round   9, Global train loss: 1.243, Global test loss: 2.360, Global test accuracy: 13.67
Round  10, Train loss: 1.314, Test loss: 1.186, Test accuracy: 52.69
Round  10, Global train loss: 1.314, Global test loss: 2.330, Global test accuracy: 16.89
Round  11, Train loss: 1.248, Test loss: 1.161, Test accuracy: 53.86
Round  11, Global train loss: 1.248, Global test loss: 2.459, Global test accuracy: 17.72
Round  12, Train loss: 1.210, Test loss: 1.142, Test accuracy: 55.04
Round  12, Global train loss: 1.210, Global test loss: 2.492, Global test accuracy: 18.29
Round  13, Train loss: 1.241, Test loss: 1.127, Test accuracy: 55.61
Round  13, Global train loss: 1.241, Global test loss: 2.327, Global test accuracy: 17.61
Round  14, Train loss: 1.279, Test loss: 1.131, Test accuracy: 55.54
Round  14, Global train loss: 1.279, Global test loss: 2.545, Global test accuracy: 16.84
Round  15, Train loss: 1.080, Test loss: 1.124, Test accuracy: 56.28
Round  15, Global train loss: 1.080, Global test loss: 2.540, Global test accuracy: 16.12
Round  16, Train loss: 1.162, Test loss: 1.122, Test accuracy: 56.43
Round  16, Global train loss: 1.162, Global test loss: 2.347, Global test accuracy: 16.03
Round  17, Train loss: 1.169, Test loss: 1.109, Test accuracy: 56.59
Round  17, Global train loss: 1.169, Global test loss: 2.376, Global test accuracy: 16.22
Round  18, Train loss: 1.098, Test loss: 1.088, Test accuracy: 58.21
Round  18, Global train loss: 1.098, Global test loss: 2.391, Global test accuracy: 16.02
Round  19, Train loss: 1.150, Test loss: 1.074, Test accuracy: 58.90
Round  19, Global train loss: 1.150, Global test loss: 2.367, Global test accuracy: 17.10
Round  20, Train loss: 1.068, Test loss: 1.061, Test accuracy: 59.43
Round  20, Global train loss: 1.068, Global test loss: 2.524, Global test accuracy: 15.66
Round  21, Train loss: 1.169, Test loss: 1.063, Test accuracy: 59.08
Round  21, Global train loss: 1.169, Global test loss: 2.456, Global test accuracy: 14.68
Round  22, Train loss: 1.057, Test loss: 1.067, Test accuracy: 59.35
Round  22, Global train loss: 1.057, Global test loss: 2.364, Global test accuracy: 16.80
Round  23, Train loss: 1.192, Test loss: 1.057, Test accuracy: 59.59
Round  23, Global train loss: 1.192, Global test loss: 2.530, Global test accuracy: 16.46
Round  24, Train loss: 1.146, Test loss: 1.047, Test accuracy: 60.39
Round  24, Global train loss: 1.146, Global test loss: 2.388, Global test accuracy: 17.69
Round  25, Train loss: 1.010, Test loss: 1.049, Test accuracy: 60.20
Round  25, Global train loss: 1.010, Global test loss: 2.733, Global test accuracy: 15.63
Round  26, Train loss: 1.076, Test loss: 1.056, Test accuracy: 59.98
Round  26, Global train loss: 1.076, Global test loss: 2.450, Global test accuracy: 17.36
Round  27, Train loss: 1.008, Test loss: 1.052, Test accuracy: 60.34
Round  27, Global train loss: 1.008, Global test loss: 2.826, Global test accuracy: 15.65
Round  28, Train loss: 1.105, Test loss: 1.022, Test accuracy: 61.34
Round  28, Global train loss: 1.105, Global test loss: 2.343, Global test accuracy: 18.41
Round  29, Train loss: 1.099, Test loss: 1.028, Test accuracy: 61.08
Round  29, Global train loss: 1.099, Global test loss: 2.509, Global test accuracy: 15.73
Round  30, Train loss: 1.166, Test loss: 1.013, Test accuracy: 61.71
Round  30, Global train loss: 1.166, Global test loss: 2.585, Global test accuracy: 16.67
Round  31, Train loss: 1.013, Test loss: 1.005, Test accuracy: 62.14
Round  31, Global train loss: 1.013, Global test loss: 2.499, Global test accuracy: 17.33
Round  32, Train loss: 1.004, Test loss: 1.005, Test accuracy: 62.17
Round  32, Global train loss: 1.004, Global test loss: 2.405, Global test accuracy: 17.67
Round  33, Train loss: 0.990, Test loss: 1.014, Test accuracy: 61.68
Round  33, Global train loss: 0.990, Global test loss: 2.515, Global test accuracy: 15.11
Round  34, Train loss: 0.983, Test loss: 0.986, Test accuracy: 62.48
Round  34, Global train loss: 0.983, Global test loss: 2.489, Global test accuracy: 15.44
Round  35, Train loss: 1.083, Test loss: 1.019, Test accuracy: 61.66
Round  35, Global train loss: 1.083, Global test loss: 2.534, Global test accuracy: 16.26
Round  36, Train loss: 0.958, Test loss: 1.025, Test accuracy: 61.54
Round  36, Global train loss: 0.958, Global test loss: 2.556, Global test accuracy: 16.07
Round  37, Train loss: 1.087, Test loss: 1.022, Test accuracy: 61.86
Round  37, Global train loss: 1.087, Global test loss: 2.563, Global test accuracy: 17.04
Round  38, Train loss: 1.120, Test loss: 1.015, Test accuracy: 62.15
Round  38, Global train loss: 1.120, Global test loss: 2.607, Global test accuracy: 16.67
Round  39, Train loss: 0.985, Test loss: 1.004, Test accuracy: 62.87
Round  39, Global train loss: 0.985, Global test loss: 2.567, Global test accuracy: 17.02
Round  40, Train loss: 1.022, Test loss: 1.013, Test accuracy: 62.58
Round  40, Global train loss: 1.022, Global test loss: 2.481, Global test accuracy: 17.23
Round  41, Train loss: 0.875, Test loss: 1.017, Test accuracy: 62.70
Round  41, Global train loss: 0.875, Global test loss: 2.676, Global test accuracy: 17.02
Round  42, Train loss: 0.946, Test loss: 1.010, Test accuracy: 62.64
Round  42, Global train loss: 0.946, Global test loss: 2.473, Global test accuracy: 17.45
Round  43, Train loss: 0.953, Test loss: 1.046, Test accuracy: 61.61
Round  43, Global train loss: 0.953, Global test loss: 2.616, Global test accuracy: 13.29
Round  44, Train loss: 0.955, Test loss: 1.038, Test accuracy: 61.82
Round  44, Global train loss: 0.955, Global test loss: 2.520, Global test accuracy: 17.74
Round  45, Train loss: 0.957, Test loss: 1.013, Test accuracy: 62.34
Round  45, Global train loss: 0.957, Global test loss: 2.516, Global test accuracy: 18.24
Round  46, Train loss: 0.930, Test loss: 1.027, Test accuracy: 62.07
Round  46, Global train loss: 0.930, Global test loss: 2.525, Global test accuracy: 18.47
Round  47, Train loss: 0.790, Test loss: 1.006, Test accuracy: 62.46
Round  47, Global train loss: 0.790, Global test loss: 2.614, Global test accuracy: 17.70
Round  48, Train loss: 0.826, Test loss: 0.991, Test accuracy: 62.83
Round  48, Global train loss: 0.826, Global test loss: 2.692, Global test accuracy: 18.59
Round  49, Train loss: 0.834, Test loss: 1.022, Test accuracy: 62.47
Round  49, Global train loss: 0.834, Global test loss: 2.618, Global test accuracy: 17.83
Round  50, Train loss: 0.830, Test loss: 1.013, Test accuracy: 62.84
Round  50, Global train loss: 0.830, Global test loss: 2.824, Global test accuracy: 16.83
Round  51, Train loss: 0.860, Test loss: 1.008, Test accuracy: 63.25
Round  51, Global train loss: 0.860, Global test loss: 2.650, Global test accuracy: 16.30
Round  52, Train loss: 0.899, Test loss: 1.016, Test accuracy: 63.03
Round  52, Global train loss: 0.899, Global test loss: 2.533, Global test accuracy: 17.81
Round  53, Train loss: 0.883, Test loss: 1.007, Test accuracy: 63.34
Round  53, Global train loss: 0.883, Global test loss: 2.736, Global test accuracy: 16.88
Round  54, Train loss: 0.820, Test loss: 1.011, Test accuracy: 63.59
Round  54, Global train loss: 0.820, Global test loss: 2.618, Global test accuracy: 17.99
Round  55, Train loss: 0.784, Test loss: 1.010, Test accuracy: 63.55
Round  55, Global train loss: 0.784, Global test loss: 2.756, Global test accuracy: 16.67
Round  56, Train loss: 0.815, Test loss: 1.018, Test accuracy: 63.13
Round  56, Global train loss: 0.815, Global test loss: 2.683, Global test accuracy: 18.87
Round  57, Train loss: 0.874, Test loss: 1.003, Test accuracy: 63.91
Round  57, Global train loss: 0.874, Global test loss: 2.726, Global test accuracy: 17.88
Round  58, Train loss: 0.803, Test loss: 1.020, Test accuracy: 63.48
Round  58, Global train loss: 0.803, Global test loss: 2.623, Global test accuracy: 17.94
Round  59, Train loss: 0.680, Test loss: 1.011, Test accuracy: 63.85
Round  59, Global train loss: 0.680, Global test loss: 2.645, Global test accuracy: 17.20
Round  60, Train loss: 0.799, Test loss: 1.017, Test accuracy: 63.86
Round  60, Global train loss: 0.799, Global test loss: 2.806, Global test accuracy: 16.39
Round  61, Train loss: 0.811, Test loss: 1.016, Test accuracy: 64.19
Round  61, Global train loss: 0.811, Global test loss: 2.869, Global test accuracy: 17.29
Round  62, Train loss: 0.767, Test loss: 1.028, Test accuracy: 63.74
Round  62, Global train loss: 0.767, Global test loss: 2.703, Global test accuracy: 17.90
Round  63, Train loss: 0.878, Test loss: 1.048, Test accuracy: 63.13
Round  63, Global train loss: 0.878, Global test loss: 2.668, Global test accuracy: 16.55
Round  64, Train loss: 0.857, Test loss: 1.058, Test accuracy: 62.97
Round  64, Global train loss: 0.857, Global test loss: 2.659, Global test accuracy: 16.35
Round  65, Train loss: 0.744, Test loss: 1.031, Test accuracy: 63.88
Round  65, Global train loss: 0.744, Global test loss: 2.861, Global test accuracy: 17.87
Round  66, Train loss: 0.834, Test loss: 1.045, Test accuracy: 63.29
Round  66, Global train loss: 0.834, Global test loss: 2.711, Global test accuracy: 16.73
Round  67, Train loss: 0.735, Test loss: 1.041, Test accuracy: 63.74
Round  67, Global train loss: 0.735, Global test loss: 2.880, Global test accuracy: 16.69
Round  68, Train loss: 0.827, Test loss: 1.064, Test accuracy: 63.24
Round  68, Global train loss: 0.827, Global test loss: 2.841, Global test accuracy: 16.13
Round  69, Train loss: 0.645, Test loss: 1.064, Test accuracy: 62.95
Round  69, Global train loss: 0.645, Global test loss: 2.998, Global test accuracy: 16.40
Round  70, Train loss: 0.703, Test loss: 1.068, Test accuracy: 63.70
Round  70, Global train loss: 0.703, Global test loss: 2.832, Global test accuracy: 16.72
Round  71, Train loss: 0.770, Test loss: 1.077, Test accuracy: 63.25
Round  71, Global train loss: 0.770, Global test loss: 2.672, Global test accuracy: 16.63
Round  72, Train loss: 0.812, Test loss: 1.064, Test accuracy: 63.59
Round  72, Global train loss: 0.812, Global test loss: 2.622, Global test accuracy: 15.99
Round  73, Train loss: 0.761, Test loss: 1.061, Test accuracy: 64.33
Round  73, Global train loss: 0.761, Global test loss: 2.867, Global test accuracy: 17.02
Round  74, Train loss: 0.691, Test loss: 1.081, Test accuracy: 63.91
Round  74, Global train loss: 0.691, Global test loss: 2.765, Global test accuracy: 15.94
Round  75, Train loss: 0.685, Test loss: 1.084, Test accuracy: 64.09
Round  75, Global train loss: 0.685, Global test loss: 2.850, Global test accuracy: 16.05
Round  76, Train loss: 0.674, Test loss: 1.091, Test accuracy: 63.77
Round  76, Global train loss: 0.674, Global test loss: 2.826, Global test accuracy: 17.67
Round  77, Train loss: 0.744, Test loss: 1.085, Test accuracy: 64.30
Round  77, Global train loss: 0.744, Global test loss: 2.947, Global test accuracy: 17.24
Round  78, Train loss: 0.664, Test loss: 1.071, Test accuracy: 64.46
Round  78, Global train loss: 0.664, Global test loss: 2.921, Global test accuracy: 16.94
Round  79, Train loss: 0.637, Test loss: 1.071, Test accuracy: 64.65
Round  79, Global train loss: 0.637, Global test loss: 2.917, Global test accuracy: 16.18
Round  80, Train loss: 0.733, Test loss: 1.046, Test accuracy: 65.51
Round  80, Global train loss: 0.733, Global test loss: 2.801, Global test accuracy: 18.38
Round  81, Train loss: 0.738, Test loss: 1.063, Test accuracy: 65.06
Round  81, Global train loss: 0.738, Global test loss: 2.884, Global test accuracy: 15.86
Round  82, Train loss: 0.671, Test loss: 1.064, Test accuracy: 64.95
Round  82, Global train loss: 0.671, Global test loss: 2.980, Global test accuracy: 16.46
Round  83, Train loss: 0.659, Test loss: 1.088, Test accuracy: 64.51
Round  83, Global train loss: 0.659, Global test loss: 3.003, Global test accuracy: 16.46
Round  84, Train loss: 0.644, Test loss: 1.088, Test accuracy: 64.20
Round  84, Global train loss: 0.644, Global test loss: 3.084, Global test accuracy: 15.88
Round  85, Train loss: 0.675, Test loss: 1.116, Test accuracy: 63.27
Round  85, Global train loss: 0.675, Global test loss: 2.959, Global test accuracy: 15.96
Round  86, Train loss: 0.741, Test loss: 1.092, Test accuracy: 64.11
Round  86, Global train loss: 0.741, Global test loss: 3.169, Global test accuracy: 16.51
Round  87, Train loss: 0.630, Test loss: 1.112, Test accuracy: 63.87
Round  87, Global train loss: 0.630, Global test loss: 2.999, Global test accuracy: 16.80
Round  88, Train loss: 0.579, Test loss: 1.098, Test accuracy: 64.34
Round  88, Global train loss: 0.579, Global test loss: 3.165, Global test accuracy: 15.94
Round  89, Train loss: 0.500, Test loss: 1.120, Test accuracy: 64.09
Round  89, Global train loss: 0.500, Global test loss: 3.212, Global test accuracy: 17.05
Round  90, Train loss: 0.711, Test loss: 1.114, Test accuracy: 64.92
Round  90, Global train loss: 0.711, Global test loss: 2.903, Global test accuracy: 17.08
Round  91, Train loss: 0.578, Test loss: 1.149, Test accuracy: 64.24
Round  91, Global train loss: 0.578, Global test loss: 3.302, Global test accuracy: 17.77
Round  92, Train loss: 0.693, Test loss: 1.142, Test accuracy: 64.30
Round  92, Global train loss: 0.693, Global test loss: 3.036, Global test accuracy: 16.94
Round  93, Train loss: 0.582, Test loss: 1.141, Test accuracy: 63.93
Round  93, Global train loss: 0.582, Global test loss: 3.258, Global test accuracy: 16.69
Round  94, Train loss: 0.643, Test loss: 1.151, Test accuracy: 64.15
Round  94, Global train loss: 0.643, Global test loss: 3.290, Global test accuracy: 16.83/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.538, Test loss: 1.166, Test accuracy: 63.82
Round  95, Global train loss: 0.538, Global test loss: 3.046, Global test accuracy: 16.88
Round  96, Train loss: 0.690, Test loss: 1.181, Test accuracy: 62.94
Round  96, Global train loss: 0.690, Global test loss: 2.985, Global test accuracy: 16.60
Round  97, Train loss: 0.531, Test loss: 1.145, Test accuracy: 63.56
Round  97, Global train loss: 0.531, Global test loss: 3.008, Global test accuracy: 15.29
Round  98, Train loss: 0.618, Test loss: 1.135, Test accuracy: 64.16
Round  98, Global train loss: 0.618, Global test loss: 3.012, Global test accuracy: 16.34
Round  99, Train loss: 0.598, Test loss: 1.172, Test accuracy: 63.39
Round  99, Global train loss: 0.598, Global test loss: 3.225, Global test accuracy: 16.17
Final Round, Train loss: 0.517, Test loss: 1.208, Test accuracy: 64.48
Final Round, Global train loss: 0.517, Global test loss: 3.225, Global test accuracy: 16.17
Average accuracy final 10 rounds: 63.940999999999995 

Average global accuracy final 10 rounds: 16.659 

1912.205468416214
[1.8498973846435547, 3.6997947692871094, 5.388288736343384, 7.076782703399658, 8.72773551940918, 10.378688335418701, 12.072557210922241, 13.766426086425781, 15.4156813621521, 17.064936637878418, 18.697556495666504, 20.33017635345459, 21.975391387939453, 23.620606422424316, 25.40031123161316, 27.180016040802002, 28.778380632400513, 30.376745223999023, 31.950854063034058, 33.52496290206909, 35.15113925933838, 36.777315616607666, 38.37068319320679, 39.96405076980591, 41.66015410423279, 43.35625743865967, 44.88006901741028, 46.40388059616089, 47.962472438812256, 49.52106428146362, 51.071372509002686, 52.62168073654175, 54.34292387962341, 56.06416702270508, 57.73085284233093, 59.39753866195679, 61.04585409164429, 62.69416952133179, 64.38861775398254, 66.0830659866333, 67.89816284179688, 69.71325969696045, 71.35076665878296, 72.98827362060547, 74.7945008277893, 76.60072803497314, 78.24291801452637, 79.88510799407959, 81.51388597488403, 83.14266395568848, 84.89125418663025, 86.63984441757202, 88.51416325569153, 90.38848209381104, 92.13870573043823, 93.88892936706543, 95.72991466522217, 97.5708999633789, 99.30778932571411, 101.04467868804932, 102.87737560272217, 104.71007251739502, 106.50963091850281, 108.3091893196106, 110.2100613117218, 112.11093330383301, 113.9120979309082, 115.7132625579834, 117.55274534225464, 119.39222812652588, 121.31367874145508, 123.23512935638428, 125.01454067230225, 126.79395198822021, 128.56292867660522, 130.33190536499023, 132.46592736244202, 134.5999493598938, 136.2736496925354, 137.947350025177, 139.5523498058319, 141.15734958648682, 142.89774703979492, 144.63814449310303, 146.24048233032227, 147.8428201675415, 149.43635201454163, 151.02988386154175, 152.7007622718811, 154.37164068222046, 156.20470905303955, 158.03777742385864, 159.72702646255493, 161.41627550125122, 163.01133561134338, 164.60639572143555, 166.35213661193848, 168.0978775024414, 169.81615352630615, 171.5344295501709, 173.19728660583496, 174.86014366149902, 176.46782326698303, 178.07550287246704, 179.90174865722656, 181.72799444198608, 183.42824149131775, 185.1284885406494, 186.80539655685425, 188.48230457305908, 190.13071966171265, 191.7791347503662, 193.56217241287231, 195.34521007537842, 197.13067173957825, 198.91613340377808, 200.68204832077026, 202.44796323776245, 204.28430008888245, 206.12063694000244, 207.8362843990326, 209.55193185806274, 211.26778435707092, 212.9836368560791, 214.74853324890137, 216.51342964172363, 218.25342392921448, 219.99341821670532, 221.71022772789001, 223.4270372390747, 225.11352586746216, 226.8000144958496, 228.3524980545044, 229.90498161315918, 231.62272810935974, 233.3404746055603, 235.25958800315857, 237.17870140075684, 239.00562191009521, 240.8325424194336, 242.59257769584656, 244.35261297225952, 246.2375762462616, 248.12253952026367, 249.84445524215698, 251.5663709640503, 253.28275060653687, 254.99913024902344, 256.74420261383057, 258.4892749786377, 260.09810090065, 261.70692682266235, 263.4457302093506, 265.1845335960388, 266.74252128601074, 268.30050897598267, 269.9152112007141, 271.52991342544556, 273.0888237953186, 274.64773416519165, 276.33290672302246, 278.01807928085327, 279.74236822128296, 281.46665716171265, 283.10511541366577, 284.7435736656189, 286.30020093917847, 287.85682821273804, 289.6837000846863, 291.5105719566345, 293.1804964542389, 294.85042095184326, 296.4548258781433, 298.05923080444336, 299.81555438041687, 301.5718779563904, 303.40353178977966, 305.23518562316895, 307.1041519641876, 308.9731183052063, 310.7261803150177, 312.4792423248291, 314.2423048019409, 316.00536727905273, 317.9593060016632, 319.9132447242737, 321.61047768592834, 323.307710647583, 324.91150879859924, 326.5153069496155, 328.21057629585266, 329.90584564208984, 331.46747159957886, 333.02909755706787, 334.89860248565674, 336.7681074142456, 338.5935595035553, 340.419011592865, 342.10301756858826, 343.7870235443115, 347.49585580825806, 351.2046880722046]
[17.91, 17.91, 24.2, 24.2, 29.97, 29.97, 38.65, 38.65, 42.48, 42.48, 44.86, 44.86, 48.95, 48.95, 49.94, 49.94, 50.29, 50.29, 50.83, 50.83, 52.69, 52.69, 53.86, 53.86, 55.04, 55.04, 55.61, 55.61, 55.54, 55.54, 56.28, 56.28, 56.43, 56.43, 56.59, 56.59, 58.21, 58.21, 58.9, 58.9, 59.43, 59.43, 59.08, 59.08, 59.35, 59.35, 59.59, 59.59, 60.39, 60.39, 60.2, 60.2, 59.98, 59.98, 60.34, 60.34, 61.34, 61.34, 61.08, 61.08, 61.71, 61.71, 62.14, 62.14, 62.17, 62.17, 61.68, 61.68, 62.48, 62.48, 61.66, 61.66, 61.54, 61.54, 61.86, 61.86, 62.15, 62.15, 62.87, 62.87, 62.58, 62.58, 62.7, 62.7, 62.64, 62.64, 61.61, 61.61, 61.82, 61.82, 62.34, 62.34, 62.07, 62.07, 62.46, 62.46, 62.83, 62.83, 62.47, 62.47, 62.84, 62.84, 63.25, 63.25, 63.03, 63.03, 63.34, 63.34, 63.59, 63.59, 63.55, 63.55, 63.13, 63.13, 63.91, 63.91, 63.48, 63.48, 63.85, 63.85, 63.86, 63.86, 64.19, 64.19, 63.74, 63.74, 63.13, 63.13, 62.97, 62.97, 63.88, 63.88, 63.29, 63.29, 63.74, 63.74, 63.24, 63.24, 62.95, 62.95, 63.7, 63.7, 63.25, 63.25, 63.59, 63.59, 64.33, 64.33, 63.91, 63.91, 64.09, 64.09, 63.77, 63.77, 64.3, 64.3, 64.46, 64.46, 64.65, 64.65, 65.51, 65.51, 65.06, 65.06, 64.95, 64.95, 64.51, 64.51, 64.2, 64.2, 63.27, 63.27, 64.11, 64.11, 63.87, 63.87, 64.34, 64.34, 64.09, 64.09, 64.92, 64.92, 64.24, 64.24, 64.3, 64.3, 63.93, 63.93, 64.15, 64.15, 63.82, 63.82, 62.94, 62.94, 63.56, 63.56, 64.16, 64.16, 63.39, 63.39, 64.48, 64.48]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.604, Test loss: 2.141, Test accuracy: 19.76
Round   0, Global train loss: 1.604, Global test loss: 2.356, Global test accuracy: 13.35
Round   1, Train loss: 1.458, Test loss: 2.053, Test accuracy: 25.40
Round   1, Global train loss: 1.458, Global test loss: 2.518, Global test accuracy: 12.87
Round   2, Train loss: 1.474, Test loss: 1.804, Test accuracy: 31.10
Round   2, Global train loss: 1.474, Global test loss: 2.371, Global test accuracy: 14.01
Round   3, Train loss: 1.376, Test loss: 1.543, Test accuracy: 38.37
Round   3, Global train loss: 1.376, Global test loss: 2.378, Global test accuracy: 13.31
Round   4, Train loss: 1.334, Test loss: 1.460, Test accuracy: 41.62
Round   4, Global train loss: 1.334, Global test loss: 2.437, Global test accuracy: 11.61
Round   5, Train loss: 1.300, Test loss: 1.337, Test accuracy: 45.88
Round   5, Global train loss: 1.300, Global test loss: 2.358, Global test accuracy: 12.66
Round   6, Train loss: 1.178, Test loss: 1.252, Test accuracy: 49.11
Round   6, Global train loss: 1.178, Global test loss: 2.416, Global test accuracy: 13.78
Round   7, Train loss: 1.292, Test loss: 1.189, Test accuracy: 52.67
Round   7, Global train loss: 1.292, Global test loss: 2.349, Global test accuracy: 14.97
Round   8, Train loss: 1.208, Test loss: 1.169, Test accuracy: 53.29
Round   8, Global train loss: 1.208, Global test loss: 2.442, Global test accuracy: 14.26
Round   9, Train loss: 1.132, Test loss: 1.187, Test accuracy: 52.40
Round   9, Global train loss: 1.132, Global test loss: 2.394, Global test accuracy: 15.31
Round  10, Train loss: 1.237, Test loss: 1.181, Test accuracy: 53.01
Round  10, Global train loss: 1.237, Global test loss: 2.478, Global test accuracy: 15.20
Round  11, Train loss: 1.233, Test loss: 1.179, Test accuracy: 53.88
Round  11, Global train loss: 1.233, Global test loss: 2.388, Global test accuracy: 15.91
Round  12, Train loss: 1.144, Test loss: 1.186, Test accuracy: 54.46
Round  12, Global train loss: 1.144, Global test loss: 2.474, Global test accuracy: 14.02
Round  13, Train loss: 1.117, Test loss: 1.164, Test accuracy: 55.88
Round  13, Global train loss: 1.117, Global test loss: 2.602, Global test accuracy: 13.98
Round  14, Train loss: 1.170, Test loss: 1.167, Test accuracy: 55.97
Round  14, Global train loss: 1.170, Global test loss: 2.406, Global test accuracy: 16.74
Round  15, Train loss: 1.156, Test loss: 1.158, Test accuracy: 56.65
Round  15, Global train loss: 1.156, Global test loss: 2.456, Global test accuracy: 14.03
Round  16, Train loss: 1.165, Test loss: 1.141, Test accuracy: 57.23
Round  16, Global train loss: 1.165, Global test loss: 2.393, Global test accuracy: 15.64
Round  17, Train loss: 1.151, Test loss: 1.116, Test accuracy: 58.10
Round  17, Global train loss: 1.151, Global test loss: 2.562, Global test accuracy: 14.90
Round  18, Train loss: 1.128, Test loss: 1.097, Test accuracy: 58.45
Round  18, Global train loss: 1.128, Global test loss: 2.520, Global test accuracy: 14.08
Round  19, Train loss: 1.021, Test loss: 1.095, Test accuracy: 59.01
Round  19, Global train loss: 1.021, Global test loss: 2.407, Global test accuracy: 15.82
Round  20, Train loss: 0.965, Test loss: 1.106, Test accuracy: 58.81
Round  20, Global train loss: 0.965, Global test loss: 2.489, Global test accuracy: 16.73
Round  21, Train loss: 1.146, Test loss: 1.101, Test accuracy: 58.75
Round  21, Global train loss: 1.146, Global test loss: 2.522, Global test accuracy: 15.01
Round  22, Train loss: 0.912, Test loss: 1.093, Test accuracy: 59.14
Round  22, Global train loss: 0.912, Global test loss: 2.568, Global test accuracy: 17.64
Round  23, Train loss: 0.947, Test loss: 1.083, Test accuracy: 59.47
Round  23, Global train loss: 0.947, Global test loss: 2.597, Global test accuracy: 15.89
Round  24, Train loss: 1.049, Test loss: 1.071, Test accuracy: 59.92
Round  24, Global train loss: 1.049, Global test loss: 2.602, Global test accuracy: 13.75
Round  25, Train loss: 0.935, Test loss: 1.079, Test accuracy: 59.66
Round  25, Global train loss: 0.935, Global test loss: 2.585, Global test accuracy: 13.75
Round  26, Train loss: 1.139, Test loss: 1.074, Test accuracy: 60.31
Round  26, Global train loss: 1.139, Global test loss: 2.415, Global test accuracy: 15.58
Round  27, Train loss: 1.015, Test loss: 1.081, Test accuracy: 60.35
Round  27, Global train loss: 1.015, Global test loss: 2.629, Global test accuracy: 14.91
Round  28, Train loss: 0.904, Test loss: 1.088, Test accuracy: 60.00
Round  28, Global train loss: 0.904, Global test loss: 2.578, Global test accuracy: 15.86
Round  29, Train loss: 0.866, Test loss: 1.085, Test accuracy: 59.71
Round  29, Global train loss: 0.866, Global test loss: 2.615, Global test accuracy: 18.15
Round  30, Train loss: 1.085, Test loss: 1.095, Test accuracy: 59.66
Round  30, Global train loss: 1.085, Global test loss: 2.512, Global test accuracy: 17.14
Round  31, Train loss: 0.961, Test loss: 1.080, Test accuracy: 60.43
Round  31, Global train loss: 0.961, Global test loss: 2.504, Global test accuracy: 16.22
Round  32, Train loss: 0.805, Test loss: 1.056, Test accuracy: 61.60
Round  32, Global train loss: 0.805, Global test loss: 2.606, Global test accuracy: 16.46
Round  33, Train loss: 0.797, Test loss: 1.067, Test accuracy: 61.17
Round  33, Global train loss: 0.797, Global test loss: 2.681, Global test accuracy: 16.13
Round  34, Train loss: 0.834, Test loss: 1.068, Test accuracy: 60.84
Round  34, Global train loss: 0.834, Global test loss: 2.584, Global test accuracy: 17.12
Round  35, Train loss: 0.965, Test loss: 1.078, Test accuracy: 60.89
Round  35, Global train loss: 0.965, Global test loss: 2.512, Global test accuracy: 18.20
Round  36, Train loss: 1.026, Test loss: 1.054, Test accuracy: 61.64
Round  36, Global train loss: 1.026, Global test loss: 2.475, Global test accuracy: 15.88
Round  37, Train loss: 0.935, Test loss: 1.064, Test accuracy: 61.88
Round  37, Global train loss: 0.935, Global test loss: 2.494, Global test accuracy: 17.97
Round  38, Train loss: 0.875, Test loss: 1.088, Test accuracy: 61.04
Round  38, Global train loss: 0.875, Global test loss: 2.614, Global test accuracy: 16.84
Round  39, Train loss: 0.800, Test loss: 1.064, Test accuracy: 62.39
Round  39, Global train loss: 0.800, Global test loss: 2.693, Global test accuracy: 17.49
Round  40, Train loss: 0.895, Test loss: 1.040, Test accuracy: 63.48
Round  40, Global train loss: 0.895, Global test loss: 2.703, Global test accuracy: 16.29
Round  41, Train loss: 0.938, Test loss: 1.020, Test accuracy: 63.54
Round  41, Global train loss: 0.938, Global test loss: 2.434, Global test accuracy: 17.74
Round  42, Train loss: 0.943, Test loss: 1.042, Test accuracy: 62.93
Round  42, Global train loss: 0.943, Global test loss: 2.787, Global test accuracy: 16.41
Round  43, Train loss: 0.892, Test loss: 1.043, Test accuracy: 63.24
Round  43, Global train loss: 0.892, Global test loss: 2.709, Global test accuracy: 17.04
Round  44, Train loss: 0.841, Test loss: 1.044, Test accuracy: 63.72
Round  44, Global train loss: 0.841, Global test loss: 2.913, Global test accuracy: 16.76
Round  45, Train loss: 0.873, Test loss: 1.028, Test accuracy: 64.38
Round  45, Global train loss: 0.873, Global test loss: 2.567, Global test accuracy: 15.39
Round  46, Train loss: 0.930, Test loss: 1.038, Test accuracy: 63.79
Round  46, Global train loss: 0.930, Global test loss: 2.744, Global test accuracy: 17.45
Round  47, Train loss: 0.821, Test loss: 1.041, Test accuracy: 63.67
Round  47, Global train loss: 0.821, Global test loss: 2.829, Global test accuracy: 16.27
Round  48, Train loss: 0.801, Test loss: 1.048, Test accuracy: 63.24
Round  48, Global train loss: 0.801, Global test loss: 3.084, Global test accuracy: 16.71
Round  49, Train loss: 0.895, Test loss: 1.070, Test accuracy: 62.87
Round  49, Global train loss: 0.895, Global test loss: 2.716, Global test accuracy: 14.92
Round  50, Train loss: 0.937, Test loss: 1.047, Test accuracy: 63.52
Round  50, Global train loss: 0.937, Global test loss: 2.663, Global test accuracy: 15.73
Round  51, Train loss: 0.653, Test loss: 1.064, Test accuracy: 63.66
Round  51, Global train loss: 0.653, Global test loss: 3.033, Global test accuracy: 17.35
Round  52, Train loss: 0.821, Test loss: 1.042, Test accuracy: 64.53
Round  52, Global train loss: 0.821, Global test loss: 2.561, Global test accuracy: 18.78
Round  53, Train loss: 0.674, Test loss: 1.051, Test accuracy: 63.91
Round  53, Global train loss: 0.674, Global test loss: 2.809, Global test accuracy: 18.10
Round  54, Train loss: 0.783, Test loss: 1.040, Test accuracy: 64.28
Round  54, Global train loss: 0.783, Global test loss: 2.902, Global test accuracy: 17.27
Round  55, Train loss: 0.698, Test loss: 1.057, Test accuracy: 63.75
Round  55, Global train loss: 0.698, Global test loss: 2.715, Global test accuracy: 18.07
Round  56, Train loss: 0.743, Test loss: 1.048, Test accuracy: 64.32
Round  56, Global train loss: 0.743, Global test loss: 3.178, Global test accuracy: 17.05
Round  57, Train loss: 0.674, Test loss: 1.087, Test accuracy: 63.44
Round  57, Global train loss: 0.674, Global test loss: 2.903, Global test accuracy: 17.33
Round  58, Train loss: 0.688, Test loss: 1.093, Test accuracy: 63.78
Round  58, Global train loss: 0.688, Global test loss: 3.040, Global test accuracy: 18.25
Round  59, Train loss: 0.754, Test loss: 1.098, Test accuracy: 64.11
Round  59, Global train loss: 0.754, Global test loss: 2.869, Global test accuracy: 14.62
Round  60, Train loss: 0.676, Test loss: 1.075, Test accuracy: 64.27
Round  60, Global train loss: 0.676, Global test loss: 2.849, Global test accuracy: 16.51
Round  61, Train loss: 0.741, Test loss: 1.083, Test accuracy: 64.51
Round  61, Global train loss: 0.741, Global test loss: 2.723, Global test accuracy: 18.42
Round  62, Train loss: 0.743, Test loss: 1.110, Test accuracy: 63.81
Round  62, Global train loss: 0.743, Global test loss: 2.661, Global test accuracy: 16.35
Round  63, Train loss: 0.620, Test loss: 1.110, Test accuracy: 64.19
Round  63, Global train loss: 0.620, Global test loss: 2.838, Global test accuracy: 17.91
Round  64, Train loss: 0.718, Test loss: 1.144, Test accuracy: 63.67
Round  64, Global train loss: 0.718, Global test loss: 2.893, Global test accuracy: 17.98
Round  65, Train loss: 0.631, Test loss: 1.147, Test accuracy: 63.71
Round  65, Global train loss: 0.631, Global test loss: 3.050, Global test accuracy: 17.21
Round  66, Train loss: 0.621, Test loss: 1.143, Test accuracy: 63.84
Round  66, Global train loss: 0.621, Global test loss: 2.988, Global test accuracy: 16.89
Round  67, Train loss: 0.528, Test loss: 1.142, Test accuracy: 63.78
Round  67, Global train loss: 0.528, Global test loss: 3.078, Global test accuracy: 17.60
Round  68, Train loss: 0.686, Test loss: 1.144, Test accuracy: 63.75
Round  68, Global train loss: 0.686, Global test loss: 3.374, Global test accuracy: 17.33
Round  69, Train loss: 0.568, Test loss: 1.152, Test accuracy: 63.71
Round  69, Global train loss: 0.568, Global test loss: 3.159, Global test accuracy: 16.81
Round  70, Train loss: 0.681, Test loss: 1.145, Test accuracy: 64.01
Round  70, Global train loss: 0.681, Global test loss: 2.907, Global test accuracy: 17.06
Round  71, Train loss: 0.711, Test loss: 1.152, Test accuracy: 63.64
Round  71, Global train loss: 0.711, Global test loss: 2.958, Global test accuracy: 17.62
Round  72, Train loss: 0.631, Test loss: 1.140, Test accuracy: 63.89
Round  72, Global train loss: 0.631, Global test loss: 2.826, Global test accuracy: 15.66
Round  73, Train loss: 0.629, Test loss: 1.135, Test accuracy: 64.10
Round  73, Global train loss: 0.629, Global test loss: 3.054, Global test accuracy: 18.27
Round  74, Train loss: 0.645, Test loss: 1.126, Test accuracy: 64.19
Round  74, Global train loss: 0.645, Global test loss: 2.919, Global test accuracy: 17.12
Round  75, Train loss: 0.589, Test loss: 1.141, Test accuracy: 63.98
Round  75, Global train loss: 0.589, Global test loss: 2.951, Global test accuracy: 17.45
Round  76, Train loss: 0.636, Test loss: 1.127, Test accuracy: 64.31
Round  76, Global train loss: 0.636, Global test loss: 3.394, Global test accuracy: 17.20
Round  77, Train loss: 0.541, Test loss: 1.117, Test accuracy: 64.77
Round  77, Global train loss: 0.541, Global test loss: 3.102, Global test accuracy: 19.21
Round  78, Train loss: 0.664, Test loss: 1.115, Test accuracy: 64.70
Round  78, Global train loss: 0.664, Global test loss: 2.974, Global test accuracy: 17.78
Round  79, Train loss: 0.543, Test loss: 1.124, Test accuracy: 64.75
Round  79, Global train loss: 0.543, Global test loss: 3.000, Global test accuracy: 16.43
Round  80, Train loss: 0.628, Test loss: 1.150, Test accuracy: 64.76
Round  80, Global train loss: 0.628, Global test loss: 3.185, Global test accuracy: 16.93
Round  81, Train loss: 0.545, Test loss: 1.170, Test accuracy: 64.40
Round  81, Global train loss: 0.545, Global test loss: 3.124, Global test accuracy: 15.84
Round  82, Train loss: 0.612, Test loss: 1.168, Test accuracy: 64.50
Round  82, Global train loss: 0.612, Global test loss: 2.976, Global test accuracy: 16.84
Round  83, Train loss: 0.557, Test loss: 1.190, Test accuracy: 64.54
Round  83, Global train loss: 0.557, Global test loss: 3.175, Global test accuracy: 16.90
Round  84, Train loss: 0.472, Test loss: 1.183, Test accuracy: 64.33
Round  84, Global train loss: 0.472, Global test loss: 3.248, Global test accuracy: 17.80
Round  85, Train loss: 0.663, Test loss: 1.195, Test accuracy: 63.96
Round  85, Global train loss: 0.663, Global test loss: 3.234, Global test accuracy: 16.93
Round  86, Train loss: 0.608, Test loss: 1.190, Test accuracy: 64.27
Round  86, Global train loss: 0.608, Global test loss: 3.081, Global test accuracy: 17.69
Round  87, Train loss: 0.605, Test loss: 1.189, Test accuracy: 64.32
Round  87, Global train loss: 0.605, Global test loss: 3.186, Global test accuracy: 16.29
Round  88, Train loss: 0.571, Test loss: 1.208, Test accuracy: 64.55
Round  88, Global train loss: 0.571, Global test loss: 3.166, Global test accuracy: 16.16
Round  89, Train loss: 0.498, Test loss: 1.196, Test accuracy: 64.81
Round  89, Global train loss: 0.498, Global test loss: 3.625, Global test accuracy: 14.89
Round  90, Train loss: 0.652, Test loss: 1.207, Test accuracy: 64.31
Round  90, Global train loss: 0.652, Global test loss: 3.427, Global test accuracy: 16.76
Round  91, Train loss: 0.500, Test loss: 1.217, Test accuracy: 64.33
Round  91, Global train loss: 0.500, Global test loss: 3.403, Global test accuracy: 18.04
Round  92, Train loss: 0.610, Test loss: 1.214, Test accuracy: 64.60
Round  92, Global train loss: 0.610, Global test loss: 3.127, Global test accuracy: 16.06
Round  93, Train loss: 0.425, Test loss: 1.238, Test accuracy: 64.53
Round  93, Global train loss: 0.425, Global test loss: 4.022, Global test accuracy: 15.70
Round  94, Train loss: 0.476, Test loss: 1.229, Test accuracy: 64.53
Round  94, Global train loss: 0.476, Global test loss: 3.257, Global test accuracy: 17.12
Round  95, Train loss: 0.504, Test loss: 1.233, Test accuracy: 64.36
Round  95, Global train loss: 0.504, Global test loss: 3.388, Global test accuracy: 16.55
Round  96, Train loss: 0.581, Test loss: 1.255, Test accuracy: 64.50
Round  96, Global train loss: 0.581, Global test loss: 3.261, Global test accuracy: 16.00
Round  97, Train loss: 0.594, Test loss: 1.259, Test accuracy: 64.88
Round  97, Global train loss: 0.594, Global test loss: 3.216, Global test accuracy: 16.29
Round  98, Train loss: 0.502, Test loss: 1.241, Test accuracy: 65.13
Round  98, Global train loss: 0.502, Global test loss: 3.478, Global test accuracy: 15.71
Round  99, Train loss: 0.540, Test loss: 1.266, Test accuracy: 64.68
Round  99, Global train loss: 0.540, Global test loss: 3.116, Global test accuracy: 15.26
Final Round, Train loss: 0.406, Test loss: 1.418, Test accuracy: 64.81
Final Round, Global train loss: 0.406, Global test loss: 3.116, Global test accuracy: 15.26
Average accuracy final 10 rounds: 64.585
Average global accuracy final 10 rounds: 16.349
2756.252534866333
[3.8642334938049316, 7.666502237319946, 11.405118703842163, 15.077219009399414, 18.95579504966736, 23.125677347183228, 27.463796854019165, 31.48918342590332, 34.64773726463318, 39.12627196311951, 43.558480739593506, 47.42659020423889, 50.8834331035614, 54.40635347366333, 57.76860547065735, 61.06063938140869, 64.56463384628296, 68.51926755905151, 72.2806167602539, 75.66464447975159, 79.01333594322205, 83.91251683235168, 87.3448429107666, 90.69211935997009, 94.09082984924316, 97.92237496376038, 101.59036922454834, 105.70532393455505, 109.05828070640564, 112.756671667099, 116.11453533172607, 119.52633619308472, 122.94427466392517, 126.66127800941467, 130.30528020858765, 133.72932052612305, 137.07571506500244, 140.58220887184143, 144.11591458320618, 147.5685532093048, 151.8457589149475, 155.32031273841858, 158.73332118988037, 162.04132223129272, 165.45364093780518, 168.9052813053131, 172.43223977088928, 175.64433193206787, 179.3286418914795, 182.98260855674744, 186.66553568840027, 189.86478519439697, 193.12943077087402, 196.7781126499176, 200.4410445690155, 203.756840467453, 207.5943009853363, 211.2139070034027, 214.8442940711975, 218.61163139343262, 222.32753443717957, 225.64907026290894, 229.39331936836243, 232.94765496253967, 236.16678953170776, 239.65782737731934, 242.88456010818481, 246.5450894832611, 250.17273473739624, 253.33827209472656, 256.5338599681854, 260.03365445137024, 263.96311259269714, 267.6468026638031, 271.8882665634155, 276.0781948566437, 279.43881249427795, 282.5915880203247, 285.68991017341614, 289.0740442276001, 292.4497039318085, 295.5151860713959, 299.21061849594116, 302.70812249183655, 306.08418560028076, 309.2785918712616, 312.55276322364807, 316.09621500968933, 319.4861550331116, 322.74620366096497, 326.12874484062195, 329.53032660484314, 333.7735741138458, 336.97602224349976, 340.28814244270325, 343.75140953063965, 347.6471288204193, 351.60654044151306, 354.8865170478821, 358.1776671409607, 364.5453975200653]
[19.76, 25.4, 31.1, 38.37, 41.62, 45.88, 49.11, 52.67, 53.29, 52.4, 53.01, 53.88, 54.46, 55.88, 55.97, 56.65, 57.23, 58.1, 58.45, 59.01, 58.81, 58.75, 59.14, 59.47, 59.92, 59.66, 60.31, 60.35, 60.0, 59.71, 59.66, 60.43, 61.6, 61.17, 60.84, 60.89, 61.64, 61.88, 61.04, 62.39, 63.48, 63.54, 62.93, 63.24, 63.72, 64.38, 63.79, 63.67, 63.24, 62.87, 63.52, 63.66, 64.53, 63.91, 64.28, 63.75, 64.32, 63.44, 63.78, 64.11, 64.27, 64.51, 63.81, 64.19, 63.67, 63.71, 63.84, 63.78, 63.75, 63.71, 64.01, 63.64, 63.89, 64.1, 64.19, 63.98, 64.31, 64.77, 64.7, 64.75, 64.76, 64.4, 64.5, 64.54, 64.33, 63.96, 64.27, 64.32, 64.55, 64.81, 64.31, 64.33, 64.6, 64.53, 64.53, 64.36, 64.5, 64.88, 65.13, 64.68, 64.81]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  16.7700
Round 1 global test acc  22.6300
Round 2 global test acc  21.6700
Round 3 global test acc  26.8600
Round 4 global test acc  29.9200
Round 5 global test acc  30.5400
Round 6 global test acc  33.7100
Round 7 global test acc  30.2700
Round 8 global test acc  26.0800
Round 9 global test acc  25.3300
Round 10 global test acc  35.3800
Round 11 global test acc  30.3900
Round 12 global test acc  32.5000
Round 13 global test acc  35.4700
Round 14 global test acc  26.5700
Round 15 global test acc  31.2500
Round 16 global test acc  39.0800
Round 17 global test acc  35.3100
Round 18 global test acc  38.6500
Round 19 global test acc  35.6000
Round 20 global test acc  33.0700
Round 21 global test acc  34.0100
Round 22 global test acc  37.1000
Round 23 global test acc  42.6900
Round 24 global test acc  40.7700
Round 25 global test acc  40.4200
Round 26 global test acc  38.3900
Round 27 global test acc  32.3400
Round 28 global test acc  32.6900
Round 29 global test acc  34.6300
Round 30 global test acc  39.0500
Round 31 global test acc  36.2900
Round 32 global test acc  36.7700
Round 33 global test acc  37.4200
Round 34 global test acc  34.9800
Round 35 global test acc  36.8600
Round 36 global test acc  39.6200
Round 37 global test acc  38.2400
Round 38 global test acc  38.8700
Round 39 global test acc  36.8800
Round 40 global test acc  38.1900
Round 41 global test acc  30.8000
Round 42 global test acc  32.6700
Round 43 global test acc  39.2600
Round 44 global test acc  32.5500
Round 45 global test acc  39.0100
Round 46 global test acc  38.6300
Round 47 global test acc  37.9500
Round 48 global test acc  40.9400
Round 49 global test acc  36.0600
Round 50 global test acc  38.2200
Round 51 global test acc  41.0200
Round 52 global test acc  38.1000
Round 53 global test acc  37.6100
Round 54 global test acc  31.6100
Round 55 global test acc  47.8600
Round 56 global test acc  41.0200
Round 57 global test acc  36.9300
Round 58 global test acc  35.4900
Round 59 global test acc  39.1300
Round 60 global test acc  35.1200
Round 61 global test acc  40.7300
Round 62 global test acc  34.9800
Round 63 global test acc  32.8500
Round 64 global test acc  40.5500
Round 65 global test acc  39.2800
Round 66 global test acc  36.4900
Round 67 global test acc  34.6600
Round 68 global test acc  41.1400
Round 69 global test acc  40.7800
Round 70 global test acc  36.5900
Round 71 global test acc  35.0100
Round 72 global test acc  41.6700
Round 73 global test acc  41.1200
Round 74 global test acc  46.2700
Round 75 global test acc  41.4600
Round 76 global test acc  41.9000
Round 77 global test acc  41.8900
Round 78 global test acc  35.9500
Round 79 global test acc  36.8400
Round 80 global test acc  33.7900
Round 81 global test acc  32.0400
Round 82 global test acc  29.4800
Round 83 global test acc  26.3700
Round 84 global test acc  24.5000
Round 85 global test acc  22.6000
Round 86 global test acc  21.1200
Round 87 global test acc  20.7300
Round 88 global test acc  20.7200
Round 89 global test acc  19.9600
Round 90 global test acc  20.1100
Round 91 global test acc  19.6300
Round 92 global test acc  19.4700
Round 93 global test acc  19.3400
Round 94 global test acc  18.9400
Round 95 global test acc  19.0400
Round 96 global test acc  18.9800
Round 97 global test acc  18.3600
Round 98 global test acc  18.2200
Round 99 global test acc  17.9100
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.969, Test loss: 2.202, Test accuracy: 13.31
Round   1, Train loss: 1.624, Test loss: 2.116, Test accuracy: 18.12
Round   2, Train loss: 1.518, Test loss: 1.867, Test accuracy: 30.00
Round   3, Train loss: 1.525, Test loss: 1.687, Test accuracy: 30.00
Round   4, Train loss: 1.456, Test loss: 1.553, Test accuracy: 35.06
Round   5, Train loss: 1.384, Test loss: 1.467, Test accuracy: 37.63
Round   6, Train loss: 1.336, Test loss: 1.364, Test accuracy: 41.66
Round   7, Train loss: 1.286, Test loss: 1.270, Test accuracy: 44.74
Round   8, Train loss: 1.233, Test loss: 1.252, Test accuracy: 46.05
Round   9, Train loss: 1.309, Test loss: 1.226, Test accuracy: 47.64
Round  10, Train loss: 1.313, Test loss: 1.170, Test accuracy: 51.50
Round  11, Train loss: 1.127, Test loss: 1.137, Test accuracy: 52.74
Round  12, Train loss: 1.262, Test loss: 1.107, Test accuracy: 55.62
Round  13, Train loss: 1.208, Test loss: 1.070, Test accuracy: 57.51
Round  14, Train loss: 1.119, Test loss: 1.056, Test accuracy: 57.57
Round  15, Train loss: 1.036, Test loss: 1.034, Test accuracy: 59.18
Round  16, Train loss: 1.129, Test loss: 1.028, Test accuracy: 59.35
Round  17, Train loss: 1.035, Test loss: 0.999, Test accuracy: 59.99
Round  18, Train loss: 1.059, Test loss: 1.013, Test accuracy: 60.21
Round  19, Train loss: 1.038, Test loss: 0.990, Test accuracy: 61.69
Round  20, Train loss: 1.043, Test loss: 0.968, Test accuracy: 62.24
Round  21, Train loss: 1.039, Test loss: 0.963, Test accuracy: 62.24
Round  22, Train loss: 0.988, Test loss: 0.966, Test accuracy: 62.66
Round  23, Train loss: 1.050, Test loss: 0.948, Test accuracy: 63.81
Round  24, Train loss: 1.142, Test loss: 0.950, Test accuracy: 64.37
Round  25, Train loss: 1.127, Test loss: 0.943, Test accuracy: 64.77
Round  26, Train loss: 0.968, Test loss: 0.933, Test accuracy: 64.99
Round  27, Train loss: 0.945, Test loss: 0.901, Test accuracy: 65.96
Round  28, Train loss: 1.107, Test loss: 0.899, Test accuracy: 66.19
Round  29, Train loss: 0.892, Test loss: 0.885, Test accuracy: 66.06
Round  30, Train loss: 0.803, Test loss: 0.873, Test accuracy: 66.65
Round  31, Train loss: 1.012, Test loss: 0.869, Test accuracy: 67.20
Round  32, Train loss: 0.840, Test loss: 0.857, Test accuracy: 67.50
Round  33, Train loss: 0.995, Test loss: 0.853, Test accuracy: 67.87
Round  34, Train loss: 0.782, Test loss: 0.852, Test accuracy: 68.14
Round  35, Train loss: 0.785, Test loss: 0.849, Test accuracy: 67.88
Round  36, Train loss: 0.851, Test loss: 0.842, Test accuracy: 68.39
Round  37, Train loss: 0.788, Test loss: 0.837, Test accuracy: 68.35
Round  38, Train loss: 0.995, Test loss: 0.849, Test accuracy: 68.86
Round  39, Train loss: 0.859, Test loss: 0.830, Test accuracy: 69.36
Round  40, Train loss: 0.806, Test loss: 0.836, Test accuracy: 69.35
Round  41, Train loss: 0.807, Test loss: 0.821, Test accuracy: 69.82
Round  42, Train loss: 0.787, Test loss: 0.801, Test accuracy: 70.09
Round  43, Train loss: 0.849, Test loss: 0.802, Test accuracy: 70.10
Round  44, Train loss: 0.869, Test loss: 0.798, Test accuracy: 70.46
Round  45, Train loss: 0.986, Test loss: 0.805, Test accuracy: 70.54
Round  46, Train loss: 0.849, Test loss: 0.788, Test accuracy: 70.72
Round  47, Train loss: 0.822, Test loss: 0.790, Test accuracy: 70.79
Round  48, Train loss: 0.668, Test loss: 0.775, Test accuracy: 71.23
Round  49, Train loss: 0.742, Test loss: 0.779, Test accuracy: 71.35
Round  50, Train loss: 0.626, Test loss: 0.771, Test accuracy: 71.65
Round  51, Train loss: 0.809, Test loss: 0.779, Test accuracy: 71.15
Round  52, Train loss: 0.845, Test loss: 0.773, Test accuracy: 71.41
Round  53, Train loss: 0.733, Test loss: 0.769, Test accuracy: 72.06
Round  54, Train loss: 0.690, Test loss: 0.768, Test accuracy: 71.76
Round  55, Train loss: 0.795, Test loss: 0.778, Test accuracy: 71.36
Round  56, Train loss: 0.689, Test loss: 0.752, Test accuracy: 72.26
Round  57, Train loss: 0.768, Test loss: 0.746, Test accuracy: 72.49
Round  58, Train loss: 0.766, Test loss: 0.762, Test accuracy: 72.05
Round  59, Train loss: 0.709, Test loss: 0.761, Test accuracy: 71.56
Round  60, Train loss: 0.886, Test loss: 0.761, Test accuracy: 72.30
Round  61, Train loss: 0.763, Test loss: 0.758, Test accuracy: 72.45
Round  62, Train loss: 0.785, Test loss: 0.748, Test accuracy: 72.44
Round  63, Train loss: 0.793, Test loss: 0.751, Test accuracy: 72.58
Round  64, Train loss: 0.642, Test loss: 0.731, Test accuracy: 73.15
Round  65, Train loss: 0.709, Test loss: 0.732, Test accuracy: 73.77
Round  66, Train loss: 0.627, Test loss: 0.735, Test accuracy: 73.15
Round  67, Train loss: 0.855, Test loss: 0.732, Test accuracy: 73.31
Round  68, Train loss: 0.644, Test loss: 0.712, Test accuracy: 73.87
Round  69, Train loss: 0.657, Test loss: 0.728, Test accuracy: 73.65
Round  70, Train loss: 0.615, Test loss: 0.719, Test accuracy: 73.67
Round  71, Train loss: 0.726, Test loss: 0.726, Test accuracy: 73.99
Round  72, Train loss: 0.743, Test loss: 0.717, Test accuracy: 74.12
Round  73, Train loss: 0.674, Test loss: 0.713, Test accuracy: 74.24
Round  74, Train loss: 0.569, Test loss: 0.716, Test accuracy: 74.27
Round  75, Train loss: 0.542, Test loss: 0.703, Test accuracy: 74.80
Round  76, Train loss: 0.611, Test loss: 0.704, Test accuracy: 74.53
Round  77, Train loss: 0.790, Test loss: 0.718, Test accuracy: 74.03
Round  78, Train loss: 0.751, Test loss: 0.707, Test accuracy: 74.52
Round  79, Train loss: 0.583, Test loss: 0.723, Test accuracy: 74.00
Round  80, Train loss: 0.670, Test loss: 0.702, Test accuracy: 74.80
Round  81, Train loss: 0.735, Test loss: 0.702, Test accuracy: 74.92
Round  82, Train loss: 0.575, Test loss: 0.705, Test accuracy: 74.79
Round  83, Train loss: 0.744, Test loss: 0.704, Test accuracy: 74.73
Round  84, Train loss: 0.671, Test loss: 0.706, Test accuracy: 74.75
Round  85, Train loss: 0.568, Test loss: 0.696, Test accuracy: 74.76
Round  86, Train loss: 0.553, Test loss: 0.694, Test accuracy: 75.22
Round  87, Train loss: 0.595, Test loss: 0.707, Test accuracy: 74.45
Round  88, Train loss: 0.655, Test loss: 0.697, Test accuracy: 74.80
Round  89, Train loss: 0.449, Test loss: 0.694, Test accuracy: 75.28
Round  90, Train loss: 0.570, Test loss: 0.687, Test accuracy: 75.75
Round  91, Train loss: 0.639, Test loss: 0.686, Test accuracy: 75.60
Round  92, Train loss: 0.552, Test loss: 0.688, Test accuracy: 75.51
Round  93, Train loss: 0.430, Test loss: 0.690, Test accuracy: 75.04
Round  94, Train loss: 0.539, Test loss: 0.697, Test accuracy: 75.16
Round  95, Train loss: 0.691, Test loss: 0.702, Test accuracy: 75.19
Round  96, Train loss: 0.779, Test loss: 0.724, Test accuracy: 74.45
Round  97, Train loss: 0.550, Test loss: 0.706, Test accuracy: 74.70
Round  98, Train loss: 0.582, Test loss: 0.694, Test accuracy: 75.24
Round  99, Train loss: 0.664, Test loss: 0.710, Test accuracy: 74.51
Final Round, Train loss: 0.532, Test loss: 0.699, Test accuracy: 75.31
Average accuracy final 10 rounds: 75.11500000000001
1218.3793716430664
[2.105740785598755, 3.840764284133911, 5.5110766887664795, 7.510928392410278, 9.266216516494751, 11.358101606369019, 13.07138991355896, 14.8917555809021, 16.56084680557251, 18.260432720184326, 19.951048135757446, 21.736554861068726, 23.42735004425049, 25.273499727249146, 27.060128450393677, 28.71705389022827, 30.4049551486969, 32.16266870498657, 33.758915185928345, 35.53960824012756, 37.26844120025635, 38.97641682624817, 40.787816524505615, 42.55248475074768, 44.14078688621521, 45.41831040382385, 46.703009366989136, 48.015952825546265, 49.31115961074829, 50.67195272445679, 52.074387550354004, 53.66232466697693, 55.30406880378723, 56.83977913856506, 58.56825089454651, 59.924718618392944, 61.40879273414612, 63.0365526676178, 64.6973786354065, 66.47824192047119, 67.90156435966492, 69.33401775360107, 70.74170303344727, 72.2321629524231, 74.0981240272522, 75.89510440826416, 77.57622265815735, 79.36036396026611, 80.81748652458191, 82.28068828582764, 84.06354284286499, 85.80877447128296, 87.55191969871521, 89.18750047683716, 90.81273078918457, 92.23176646232605, 93.6746118068695, 95.37704873085022, 97.10496616363525, 98.87451529502869, 100.6529610157013, 103.03094387054443, 104.50332713127136, 105.97928524017334, 107.67678666114807, 108.97079062461853, 110.3717999458313, 111.65426802635193, 112.82420110702515, 114.01979923248291, 115.21723437309265, 116.39757633209229, 117.709468126297, 119.05004119873047, 120.23220014572144, 121.43172430992126, 122.62196493148804, 123.79498720169067, 124.99354934692383, 126.27989268302917, 127.63121032714844, 129.06009602546692, 130.47586250305176, 131.88583946228027, 133.304044008255, 135.25591349601746, 136.64799118041992, 138.0482473373413, 139.44688248634338, 140.84894466400146, 142.60289096832275, 144.3082239627838, 145.72956919670105, 147.14221739768982, 148.56442046165466, 149.99955916404724, 151.6181936264038, 153.02998232841492, 154.44218635559082, 155.86290884017944, 158.4136197566986]
[13.31, 18.12, 30.0, 30.0, 35.06, 37.63, 41.66, 44.74, 46.05, 47.64, 51.5, 52.74, 55.62, 57.51, 57.57, 59.18, 59.35, 59.99, 60.21, 61.69, 62.24, 62.24, 62.66, 63.81, 64.37, 64.77, 64.99, 65.96, 66.19, 66.06, 66.65, 67.2, 67.5, 67.87, 68.14, 67.88, 68.39, 68.35, 68.86, 69.36, 69.35, 69.82, 70.09, 70.1, 70.46, 70.54, 70.72, 70.79, 71.23, 71.35, 71.65, 71.15, 71.41, 72.06, 71.76, 71.36, 72.26, 72.49, 72.05, 71.56, 72.3, 72.45, 72.44, 72.58, 73.15, 73.77, 73.15, 73.31, 73.87, 73.65, 73.67, 73.99, 74.12, 74.24, 74.27, 74.8, 74.53, 74.03, 74.52, 74.0, 74.8, 74.92, 74.79, 74.73, 74.75, 74.76, 75.22, 74.45, 74.8, 75.28, 75.75, 75.6, 75.51, 75.04, 75.16, 75.19, 74.45, 74.7, 75.24, 74.51, 75.31]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.598, Test loss: 2.102, Test accuracy: 18.00
Round   0, Global train loss: 1.598, Global test loss: 2.347, Global test accuracy: 11.34
Round   1, Train loss: 1.523, Test loss: 1.926, Test accuracy: 22.22
Round   1, Global train loss: 1.523, Global test loss: 2.393, Global test accuracy: 10.30
Round   2, Train loss: 1.451, Test loss: 1.794, Test accuracy: 31.62
Round   2, Global train loss: 1.451, Global test loss: 2.479, Global test accuracy: 13.48
Round   3, Train loss: 1.409, Test loss: 1.507, Test accuracy: 39.14
Round   3, Global train loss: 1.409, Global test loss: 2.417, Global test accuracy: 12.03
Round   4, Train loss: 1.428, Test loss: 1.425, Test accuracy: 42.55
Round   4, Global train loss: 1.428, Global test loss: 2.476, Global test accuracy: 13.64
Round   5, Train loss: 1.410, Test loss: 1.351, Test accuracy: 45.29
Round   5, Global train loss: 1.410, Global test loss: 2.376, Global test accuracy: 11.87
Round   6, Train loss: 1.270, Test loss: 1.235, Test accuracy: 49.47
Round   6, Global train loss: 1.270, Global test loss: 2.522, Global test accuracy: 11.41
Round   7, Train loss: 1.199, Test loss: 1.202, Test accuracy: 51.73
Round   7, Global train loss: 1.199, Global test loss: 2.461, Global test accuracy: 13.15
Round   8, Train loss: 1.282, Test loss: 1.209, Test accuracy: 51.46
Round   8, Global train loss: 1.282, Global test loss: 2.437, Global test accuracy: 13.23
Round   9, Train loss: 1.145, Test loss: 1.181, Test accuracy: 52.67
Round   9, Global train loss: 1.145, Global test loss: 2.398, Global test accuracy: 15.08
Round  10, Train loss: 1.254, Test loss: 1.159, Test accuracy: 53.82
Round  10, Global train loss: 1.254, Global test loss: 2.565, Global test accuracy: 14.46
Round  11, Train loss: 1.196, Test loss: 1.146, Test accuracy: 54.93
Round  11, Global train loss: 1.196, Global test loss: 2.555, Global test accuracy: 13.59
Round  12, Train loss: 1.190, Test loss: 1.123, Test accuracy: 55.73
Round  12, Global train loss: 1.190, Global test loss: 2.382, Global test accuracy: 15.13
Round  13, Train loss: 1.269, Test loss: 1.105, Test accuracy: 57.02
Round  13, Global train loss: 1.269, Global test loss: 2.501, Global test accuracy: 13.87
Round  14, Train loss: 1.165, Test loss: 1.097, Test accuracy: 57.59
Round  14, Global train loss: 1.165, Global test loss: 2.433, Global test accuracy: 15.56
Round  15, Train loss: 1.097, Test loss: 1.082, Test accuracy: 57.99
Round  15, Global train loss: 1.097, Global test loss: 2.390, Global test accuracy: 16.23
Round  16, Train loss: 1.137, Test loss: 1.072, Test accuracy: 58.39
Round  16, Global train loss: 1.137, Global test loss: 2.536, Global test accuracy: 14.23
Round  17, Train loss: 1.060, Test loss: 1.056, Test accuracy: 59.19
Round  17, Global train loss: 1.060, Global test loss: 2.478, Global test accuracy: 15.70
Round  18, Train loss: 0.973, Test loss: 1.044, Test accuracy: 60.08
Round  18, Global train loss: 0.973, Global test loss: 2.541, Global test accuracy: 14.52
Round  19, Train loss: 1.169, Test loss: 1.037, Test accuracy: 60.46
Round  19, Global train loss: 1.169, Global test loss: 2.441, Global test accuracy: 13.51
Round  20, Train loss: 1.043, Test loss: 1.025, Test accuracy: 60.89
Round  20, Global train loss: 1.043, Global test loss: 2.426, Global test accuracy: 15.33
Round  21, Train loss: 1.073, Test loss: 1.022, Test accuracy: 61.17
Round  21, Global train loss: 1.073, Global test loss: 2.532, Global test accuracy: 13.80
Round  22, Train loss: 1.048, Test loss: 1.039, Test accuracy: 60.60
Round  22, Global train loss: 1.048, Global test loss: 2.654, Global test accuracy: 13.78
Round  23, Train loss: 1.089, Test loss: 1.035, Test accuracy: 60.95
Round  23, Global train loss: 1.089, Global test loss: 2.641, Global test accuracy: 14.47
Round  24, Train loss: 1.049, Test loss: 1.024, Test accuracy: 61.40
Round  24, Global train loss: 1.049, Global test loss: 2.502, Global test accuracy: 14.01
Round  25, Train loss: 0.969, Test loss: 1.019, Test accuracy: 61.89
Round  25, Global train loss: 0.969, Global test loss: 2.446, Global test accuracy: 12.53
Round  26, Train loss: 0.975, Test loss: 1.023, Test accuracy: 61.65
Round  26, Global train loss: 0.975, Global test loss: 2.539, Global test accuracy: 13.70
Round  27, Train loss: 0.958, Test loss: 1.022, Test accuracy: 61.77
Round  27, Global train loss: 0.958, Global test loss: 2.560, Global test accuracy: 14.61
Round  28, Train loss: 0.983, Test loss: 1.011, Test accuracy: 62.59
Round  28, Global train loss: 0.983, Global test loss: 2.516, Global test accuracy: 14.30
Round  29, Train loss: 1.035, Test loss: 1.024, Test accuracy: 61.95
Round  29, Global train loss: 1.035, Global test loss: 2.620, Global test accuracy: 15.87
Round  30, Train loss: 1.128, Test loss: 1.023, Test accuracy: 62.25
Round  30, Global train loss: 1.128, Global test loss: 2.457, Global test accuracy: 15.32
Round  31, Train loss: 1.048, Test loss: 1.024, Test accuracy: 62.41
Round  31, Global train loss: 1.048, Global test loss: 2.445, Global test accuracy: 13.71
Round  32, Train loss: 0.881, Test loss: 1.027, Test accuracy: 62.18
Round  32, Global train loss: 0.881, Global test loss: 2.645, Global test accuracy: 14.08
Round  33, Train loss: 0.995, Test loss: 1.018, Test accuracy: 62.31
Round  33, Global train loss: 0.995, Global test loss: 2.526, Global test accuracy: 14.00
Round  34, Train loss: 0.978, Test loss: 1.033, Test accuracy: 61.67
Round  34, Global train loss: 0.978, Global test loss: 2.595, Global test accuracy: 14.07
Round  35, Train loss: 0.940, Test loss: 1.039, Test accuracy: 61.83
Round  35, Global train loss: 0.940, Global test loss: 2.615, Global test accuracy: 15.45
Round  36, Train loss: 0.959, Test loss: 1.028, Test accuracy: 62.42
Round  36, Global train loss: 0.959, Global test loss: 2.460, Global test accuracy: 15.69
Round  37, Train loss: 0.870, Test loss: 1.026, Test accuracy: 62.65
Round  37, Global train loss: 0.870, Global test loss: 2.765, Global test accuracy: 14.59
Round  38, Train loss: 0.951, Test loss: 1.019, Test accuracy: 63.20
Round  38, Global train loss: 0.951, Global test loss: 2.520, Global test accuracy: 16.27
Round  39, Train loss: 0.967, Test loss: 1.024, Test accuracy: 62.83
Round  39, Global train loss: 0.967, Global test loss: 2.525, Global test accuracy: 15.54
Round  40, Train loss: 0.942, Test loss: 1.015, Test accuracy: 63.36
Round  40, Global train loss: 0.942, Global test loss: 2.607, Global test accuracy: 15.65
Round  41, Train loss: 0.894, Test loss: 1.018, Test accuracy: 63.46
Round  41, Global train loss: 0.894, Global test loss: 2.615, Global test accuracy: 14.82
Round  42, Train loss: 0.798, Test loss: 1.007, Test accuracy: 63.81
Round  42, Global train loss: 0.798, Global test loss: 2.539, Global test accuracy: 15.90
Round  43, Train loss: 0.813, Test loss: 1.014, Test accuracy: 63.77
Round  43, Global train loss: 0.813, Global test loss: 2.553, Global test accuracy: 15.73
Round  44, Train loss: 0.943, Test loss: 1.008, Test accuracy: 63.67
Round  44, Global train loss: 0.943, Global test loss: 2.563, Global test accuracy: 15.26
Round  45, Train loss: 0.823, Test loss: 1.008, Test accuracy: 63.68
Round  45, Global train loss: 0.823, Global test loss: 2.980, Global test accuracy: 14.34
Round  46, Train loss: 0.767, Test loss: 1.034, Test accuracy: 62.95
Round  46, Global train loss: 0.767, Global test loss: 2.800, Global test accuracy: 16.29
Round  47, Train loss: 0.690, Test loss: 1.046, Test accuracy: 62.78
Round  47, Global train loss: 0.690, Global test loss: 2.875, Global test accuracy: 15.13
Round  48, Train loss: 0.727, Test loss: 1.018, Test accuracy: 63.62
Round  48, Global train loss: 0.727, Global test loss: 2.902, Global test accuracy: 15.49
Round  49, Train loss: 0.826, Test loss: 1.021, Test accuracy: 64.02
Round  49, Global train loss: 0.826, Global test loss: 2.749, Global test accuracy: 15.20
Round  50, Train loss: 0.772, Test loss: 1.005, Test accuracy: 64.63
Round  50, Global train loss: 0.772, Global test loss: 2.689, Global test accuracy: 14.48
Round  51, Train loss: 0.850, Test loss: 1.018, Test accuracy: 64.32
Round  51, Global train loss: 0.850, Global test loss: 2.816, Global test accuracy: 16.07
Round  52, Train loss: 0.806, Test loss: 1.006, Test accuracy: 65.00
Round  52, Global train loss: 0.806, Global test loss: 2.773, Global test accuracy: 17.02
Round  53, Train loss: 0.723, Test loss: 1.017, Test accuracy: 64.80
Round  53, Global train loss: 0.723, Global test loss: 3.017, Global test accuracy: 15.15
Round  54, Train loss: 0.706, Test loss: 1.027, Test accuracy: 64.87
Round  54, Global train loss: 0.706, Global test loss: 3.112, Global test accuracy: 15.86
Round  55, Train loss: 0.774, Test loss: 1.047, Test accuracy: 64.51
Round  55, Global train loss: 0.774, Global test loss: 2.771, Global test accuracy: 16.07
Round  56, Train loss: 0.807, Test loss: 1.043, Test accuracy: 64.58
Round  56, Global train loss: 0.807, Global test loss: 2.675, Global test accuracy: 15.89
Round  57, Train loss: 0.683, Test loss: 1.054, Test accuracy: 64.20
Round  57, Global train loss: 0.683, Global test loss: 2.684, Global test accuracy: 16.33
Round  58, Train loss: 0.713, Test loss: 1.029, Test accuracy: 65.20
Round  58, Global train loss: 0.713, Global test loss: 2.980, Global test accuracy: 15.79
Round  59, Train loss: 0.656, Test loss: 1.037, Test accuracy: 65.27
Round  59, Global train loss: 0.656, Global test loss: 2.967, Global test accuracy: 15.08
Round  60, Train loss: 0.693, Test loss: 1.034, Test accuracy: 64.96
Round  60, Global train loss: 0.693, Global test loss: 2.888, Global test accuracy: 15.45
Round  61, Train loss: 0.744, Test loss: 1.076, Test accuracy: 64.47
Round  61, Global train loss: 0.744, Global test loss: 3.012, Global test accuracy: 14.56
Round  62, Train loss: 0.753, Test loss: 1.068, Test accuracy: 64.91
Round  62, Global train loss: 0.753, Global test loss: 2.760, Global test accuracy: 14.61
Round  63, Train loss: 0.814, Test loss: 1.096, Test accuracy: 64.24
Round  63, Global train loss: 0.814, Global test loss: 2.967, Global test accuracy: 15.41
Round  64, Train loss: 0.797, Test loss: 1.115, Test accuracy: 63.95
Round  64, Global train loss: 0.797, Global test loss: 2.814, Global test accuracy: 15.53
Round  65, Train loss: 0.760, Test loss: 1.110, Test accuracy: 63.83
Round  65, Global train loss: 0.760, Global test loss: 2.737, Global test accuracy: 14.13
Round  66, Train loss: 0.781, Test loss: 1.091, Test accuracy: 64.82
Round  66, Global train loss: 0.781, Global test loss: 2.819, Global test accuracy: 15.27
Round  67, Train loss: 0.671, Test loss: 1.126, Test accuracy: 64.01
Round  67, Global train loss: 0.671, Global test loss: 3.124, Global test accuracy: 15.10
Round  68, Train loss: 0.746, Test loss: 1.120, Test accuracy: 64.29
Round  68, Global train loss: 0.746, Global test loss: 2.982, Global test accuracy: 15.60
Round  69, Train loss: 0.603, Test loss: 1.120, Test accuracy: 64.01
Round  69, Global train loss: 0.603, Global test loss: 3.085, Global test accuracy: 13.80
Round  70, Train loss: 0.597, Test loss: 1.092, Test accuracy: 64.75
Round  70, Global train loss: 0.597, Global test loss: 2.921, Global test accuracy: 15.19
Round  71, Train loss: 0.755, Test loss: 1.116, Test accuracy: 64.07
Round  71, Global train loss: 0.755, Global test loss: 2.940, Global test accuracy: 16.10
Round  72, Train loss: 0.637, Test loss: 1.123, Test accuracy: 64.20
Round  72, Global train loss: 0.637, Global test loss: 2.903, Global test accuracy: 13.76
Round  73, Train loss: 0.815, Test loss: 1.110, Test accuracy: 64.60
Round  73, Global train loss: 0.815, Global test loss: 3.069, Global test accuracy: 16.61
Round  74, Train loss: 0.605, Test loss: 1.137, Test accuracy: 64.12
Round  74, Global train loss: 0.605, Global test loss: 3.180, Global test accuracy: 15.36
Round  75, Train loss: 0.641, Test loss: 1.147, Test accuracy: 63.58
Round  75, Global train loss: 0.641, Global test loss: 3.202, Global test accuracy: 14.90
Round  76, Train loss: 0.708, Test loss: 1.146, Test accuracy: 63.84
Round  76, Global train loss: 0.708, Global test loss: 3.048, Global test accuracy: 15.30
Round  77, Train loss: 0.717, Test loss: 1.153, Test accuracy: 63.92
Round  77, Global train loss: 0.717, Global test loss: 3.236, Global test accuracy: 16.33
Round  78, Train loss: 0.705, Test loss: 1.170, Test accuracy: 63.91
Round  78, Global train loss: 0.705, Global test loss: 3.186, Global test accuracy: 15.26
Round  79, Train loss: 0.606, Test loss: 1.186, Test accuracy: 63.74
Round  79, Global train loss: 0.606, Global test loss: 3.107, Global test accuracy: 14.23
Round  80, Train loss: 0.580, Test loss: 1.186, Test accuracy: 64.02
Round  80, Global train loss: 0.580, Global test loss: 3.170, Global test accuracy: 15.75
Round  81, Train loss: 0.574, Test loss: 1.177, Test accuracy: 64.34
Round  81, Global train loss: 0.574, Global test loss: 3.014, Global test accuracy: 14.45
Round  82, Train loss: 0.722, Test loss: 1.181, Test accuracy: 64.51
Round  82, Global train loss: 0.722, Global test loss: 3.056, Global test accuracy: 14.61
Round  83, Train loss: 0.630, Test loss: 1.215, Test accuracy: 63.82
Round  83, Global train loss: 0.630, Global test loss: 3.181, Global test accuracy: 14.38
Round  84, Train loss: 0.609, Test loss: 1.192, Test accuracy: 64.34
Round  84, Global train loss: 0.609, Global test loss: 3.172, Global test accuracy: 15.76
Round  85, Train loss: 0.558, Test loss: 1.177, Test accuracy: 64.58
Round  85, Global train loss: 0.558, Global test loss: 3.307, Global test accuracy: 15.98
Round  86, Train loss: 0.654, Test loss: 1.180, Test accuracy: 64.45
Round  86, Global train loss: 0.654, Global test loss: 3.034, Global test accuracy: 15.77
Round  87, Train loss: 0.664, Test loss: 1.180, Test accuracy: 64.48
Round  87, Global train loss: 0.664, Global test loss: 3.026, Global test accuracy: 15.46
Round  88, Train loss: 0.539, Test loss: 1.178, Test accuracy: 64.82
Round  88, Global train loss: 0.539, Global test loss: 3.447, Global test accuracy: 13.05
Round  89, Train loss: 0.429, Test loss: 1.215, Test accuracy: 64.35
Round  89, Global train loss: 0.429, Global test loss: 3.637, Global test accuracy: 14.55
Round  90, Train loss: 0.627, Test loss: 1.216, Test accuracy: 64.78
Round  90, Global train loss: 0.627, Global test loss: 3.022, Global test accuracy: 15.80
Round  91, Train loss: 0.514, Test loss: 1.237, Test accuracy: 64.49
Round  91, Global train loss: 0.514, Global test loss: 3.573, Global test accuracy: 16.00
Round  92, Train loss: 0.485, Test loss: 1.231, Test accuracy: 64.23
Round  92, Global train loss: 0.485, Global test loss: 3.227, Global test accuracy: 15.53
Round  93, Train loss: 0.459, Test loss: 1.224, Test accuracy: 64.44
Round  93, Global train loss: 0.459, Global test loss: 3.386, Global test accuracy: 16.45
Round  94, Train loss: 0.483, Test loss: 1.208, Test accuracy: 65.11
Round  94, Global train loss: 0.483, Global test loss: 3.288, Global test accuracy: 16.61
Round  95, Train loss: 0.469, Test loss: 1.224, Test accuracy: 65.01
Round  95, Global train loss: 0.469, Global test loss: 3.304, Global test accuracy: 15.64
Round  96, Train loss: 0.684, Test loss: 1.223, Test accuracy: 64.78
Round  96, Global train loss: 0.684, Global test loss: 3.067, Global test accuracy: 13.48
Round  97, Train loss: 0.522, Test loss: 1.213, Test accuracy: 64.72
Round  97, Global train loss: 0.522, Global test loss: 3.113, Global test accuracy: 15.62
Round  98, Train loss: 0.595, Test loss: 1.244, Test accuracy: 64.41
Round  98, Global train loss: 0.595, Global test loss: 3.315, Global test accuracy: 14.03
Round  99, Train loss: 0.572, Test loss: 1.258, Test accuracy: 64.20
Round  99, Global train loss: 0.572, Global test loss: 3.252, Global test accuracy: 14.10
Final Round, Train loss: 0.419, Test loss: 1.324, Test accuracy: 65.16
Final Round, Global train loss: 0.419, Global test loss: 3.252, Global test accuracy: 14.10
Average accuracy final 10 rounds: 64.617
Average global accuracy final 10 rounds: 15.326
2084.475168943405
[1.4095194339752197, 2.5503528118133545, 3.9331555366516113, 5.060686349868774, 6.207764625549316, 7.352479934692383, 8.49332332611084, 9.774967432022095, 11.031185626983643, 12.168829679489136, 13.30962347984314, 14.292160034179688, 15.280133485794067, 16.463253021240234, 17.438779592514038, 18.41497564315796, 19.391939163208008, 20.36771035194397, 21.34294557571411, 22.59922218322754, 23.579487800598145, 26.47712731361389, 29.63210391998291, 32.45902371406555, 35.39599418640137, 38.479323625564575, 41.28461670875549, 44.35291576385498, 47.68266463279724, 50.780810832977295, 53.91202759742737, 57.14039993286133, 60.23925995826721, 63.32025337219238, 66.63547348976135, 69.62119841575623, 72.74985313415527, 76.1032645702362, 79.14710569381714, 82.27168607711792, 85.73261666297913, 88.88913941383362, 91.98305082321167, 95.39281153678894, 98.50924611091614, 101.62804770469666, 104.95865488052368, 108.06309199333191, 111.63856267929077, 114.9381411075592, 117.97368550300598, 121.39433884620667, 124.49940729141235, 127.59581995010376, 130.79672050476074, 133.88258242607117, 136.97135877609253, 140.3746907711029, 143.57488584518433, 146.63080835342407, 149.80085849761963, 152.95847725868225, 156.04781293869019, 159.38177490234375, 162.49962902069092, 165.62642359733582, 169.03625059127808, 172.04755520820618, 175.16801166534424, 178.27692008018494, 181.3693494796753, 184.50610041618347, 187.80301451683044, 190.891188621521, 194.09111499786377, 197.39403128623962, 200.59537887573242, 203.81549334526062, 206.96362709999084, 210.05508303642273, 213.5493929386139, 216.64333534240723, 219.72407007217407, 222.89147877693176, 226.0091106891632, 229.2257833480835, 232.4590721130371, 235.59201788902283, 238.88671255111694, 242.0625011920929, 245.15551853179932, 248.55919361114502, 251.73615741729736, 254.92225289344788, 258.62930274009705, 261.69593930244446, 264.8164494037628, 268.23900508880615, 271.3644254207611, 274.53319668769836, 276.9334261417389]
[18.0, 22.22, 31.62, 39.14, 42.55, 45.29, 49.47, 51.73, 51.46, 52.67, 53.82, 54.93, 55.73, 57.02, 57.59, 57.99, 58.39, 59.19, 60.08, 60.46, 60.89, 61.17, 60.6, 60.95, 61.4, 61.89, 61.65, 61.77, 62.59, 61.95, 62.25, 62.41, 62.18, 62.31, 61.67, 61.83, 62.42, 62.65, 63.2, 62.83, 63.36, 63.46, 63.81, 63.77, 63.67, 63.68, 62.95, 62.78, 63.62, 64.02, 64.63, 64.32, 65.0, 64.8, 64.87, 64.51, 64.58, 64.2, 65.2, 65.27, 64.96, 64.47, 64.91, 64.24, 63.95, 63.83, 64.82, 64.01, 64.29, 64.01, 64.75, 64.07, 64.2, 64.6, 64.12, 63.58, 63.84, 63.92, 63.91, 63.74, 64.02, 64.34, 64.51, 63.82, 64.34, 64.58, 64.45, 64.48, 64.82, 64.35, 64.78, 64.49, 64.23, 64.44, 65.11, 65.01, 64.78, 64.72, 64.41, 64.2, 65.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: none, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.512, Test loss: 1.284, Test accuracy: 46.31
Round   0, Global train loss: 1.512, Global test loss: 2.262, Global test accuracy: 16.55
Round   1, Train loss: 1.346, Test loss: 1.176, Test accuracy: 52.12
Round   1, Global train loss: 1.346, Global test loss: 2.274, Global test accuracy: 17.83
Round   2, Train loss: 1.242, Test loss: 1.114, Test accuracy: 55.87
Round   2, Global train loss: 1.242, Global test loss: 2.270, Global test accuracy: 18.57
Round   3, Train loss: 1.179, Test loss: 1.085, Test accuracy: 57.52
Round   3, Global train loss: 1.179, Global test loss: 2.275, Global test accuracy: 18.86
Round   4, Train loss: 1.127, Test loss: 1.076, Test accuracy: 57.71
Round   4, Global train loss: 1.127, Global test loss: 2.289, Global test accuracy: 19.06
Round   5, Train loss: 1.084, Test loss: 1.054, Test accuracy: 59.47
Round   5, Global train loss: 1.084, Global test loss: 2.278, Global test accuracy: 19.27
Round   6, Train loss: 1.048, Test loss: 1.025, Test accuracy: 60.27
Round   6, Global train loss: 1.048, Global test loss: 2.299, Global test accuracy: 19.41
Round   7, Train loss: 1.006, Test loss: 1.022, Test accuracy: 61.20
Round   7, Global train loss: 1.006, Global test loss: 2.296, Global test accuracy: 19.37
Round   8, Train loss: 0.970, Test loss: 1.032, Test accuracy: 62.22
Round   8, Global train loss: 0.970, Global test loss: 2.304, Global test accuracy: 19.59
Round   9, Train loss: 0.935, Test loss: 1.031, Test accuracy: 61.73
Round   9, Global train loss: 0.935, Global test loss: 2.321, Global test accuracy: 19.68
Round  10, Train loss: 1.007, Test loss: 1.026, Test accuracy: 62.45
Round  10, Global train loss: 1.007, Global test loss: 2.465, Global test accuracy: 17.51
Round  11, Train loss: 0.853, Test loss: 1.035, Test accuracy: 62.36
Round  11, Global train loss: 0.853, Global test loss: 2.443, Global test accuracy: 18.08
Round  12, Train loss: 0.928, Test loss: 1.037, Test accuracy: 62.57
Round  12, Global train loss: 0.928, Global test loss: 2.635, Global test accuracy: 18.35
Round  13, Train loss: 0.913, Test loss: 1.033, Test accuracy: 62.93
Round  13, Global train loss: 0.913, Global test loss: 2.605, Global test accuracy: 16.54
Round  14, Train loss: 0.901, Test loss: 1.047, Test accuracy: 62.90
Round  14, Global train loss: 0.901, Global test loss: 2.759, Global test accuracy: 15.73
Round  15, Train loss: 0.782, Test loss: 1.041, Test accuracy: 62.62
Round  15, Global train loss: 0.782, Global test loss: 2.636, Global test accuracy: 18.83
Round  16, Train loss: 0.680, Test loss: 1.049, Test accuracy: 62.56
Round  16, Global train loss: 0.680, Global test loss: 2.694, Global test accuracy: 16.17
Round  17, Train loss: 0.748, Test loss: 1.055, Test accuracy: 62.85
Round  17, Global train loss: 0.748, Global test loss: 2.690, Global test accuracy: 17.52
Round  18, Train loss: 0.676, Test loss: 1.051, Test accuracy: 63.53
Round  18, Global train loss: 0.676, Global test loss: 2.902, Global test accuracy: 15.77
Round  19, Train loss: 0.669, Test loss: 1.062, Test accuracy: 64.01
Round  19, Global train loss: 0.669, Global test loss: 2.793, Global test accuracy: 16.98
Round  20, Train loss: 0.657, Test loss: 1.085, Test accuracy: 63.53
Round  20, Global train loss: 0.657, Global test loss: 2.908, Global test accuracy: 17.14
Round  21, Train loss: 0.566, Test loss: 1.085, Test accuracy: 63.82
Round  21, Global train loss: 0.566, Global test loss: 2.932, Global test accuracy: 17.01
Round  22, Train loss: 0.678, Test loss: 1.079, Test accuracy: 64.18
Round  22, Global train loss: 0.678, Global test loss: 3.154, Global test accuracy: 18.28
Round  23, Train loss: 0.639, Test loss: 1.078, Test accuracy: 64.50
Round  23, Global train loss: 0.639, Global test loss: 3.299, Global test accuracy: 16.43
Round  24, Train loss: 0.664, Test loss: 1.098, Test accuracy: 64.24
Round  24, Global train loss: 0.664, Global test loss: 2.981, Global test accuracy: 15.95
Round  25, Train loss: 0.493, Test loss: 1.124, Test accuracy: 64.11
Round  25, Global train loss: 0.493, Global test loss: 3.191, Global test accuracy: 17.27
Round  26, Train loss: 0.473, Test loss: 1.166, Test accuracy: 63.82
Round  26, Global train loss: 0.473, Global test loss: 3.195, Global test accuracy: 16.48
Round  27, Train loss: 0.465, Test loss: 1.186, Test accuracy: 64.34
Round  27, Global train loss: 0.465, Global test loss: 3.301, Global test accuracy: 17.59
Round  28, Train loss: 0.598, Test loss: 1.209, Test accuracy: 64.46
Round  28, Global train loss: 0.598, Global test loss: 3.186, Global test accuracy: 17.75
Round  29, Train loss: 0.520, Test loss: 1.242, Test accuracy: 64.18
Round  29, Global train loss: 0.520, Global test loss: 3.640, Global test accuracy: 18.70
Round  30, Train loss: 0.416, Test loss: 1.207, Test accuracy: 64.55
Round  30, Global train loss: 0.416, Global test loss: 3.105, Global test accuracy: 18.14
Round  31, Train loss: 0.512, Test loss: 1.202, Test accuracy: 64.87
Round  31, Global train loss: 0.512, Global test loss: 3.287, Global test accuracy: 17.46
Round  32, Train loss: 0.392, Test loss: 1.219, Test accuracy: 65.05
Round  32, Global train loss: 0.392, Global test loss: 3.622, Global test accuracy: 17.53
Round  33, Train loss: 0.507, Test loss: 1.266, Test accuracy: 64.48
Round  33, Global train loss: 0.507, Global test loss: 3.506, Global test accuracy: 18.88
Round  34, Train loss: 0.394, Test loss: 1.278, Test accuracy: 64.32
Round  34, Global train loss: 0.394, Global test loss: 3.562, Global test accuracy: 18.00
Round  35, Train loss: 0.359, Test loss: 1.283, Test accuracy: 64.22
Round  35, Global train loss: 0.359, Global test loss: 3.425, Global test accuracy: 18.89
Round  36, Train loss: 0.567, Test loss: 1.322, Test accuracy: 63.82
Round  36, Global train loss: 0.567, Global test loss: 3.338, Global test accuracy: 16.71
Round  37, Train loss: 0.421, Test loss: 1.321, Test accuracy: 64.13
Round  37, Global train loss: 0.421, Global test loss: 3.431, Global test accuracy: 14.85
Round  38, Train loss: 0.472, Test loss: 1.295, Test accuracy: 64.41
Round  38, Global train loss: 0.472, Global test loss: 3.476, Global test accuracy: 15.38
Round  39, Train loss: 0.452, Test loss: 1.297, Test accuracy: 64.73
Round  39, Global train loss: 0.452, Global test loss: 3.283, Global test accuracy: 15.32
Round  40, Train loss: 0.330, Test loss: 1.311, Test accuracy: 64.37
Round  40, Global train loss: 0.330, Global test loss: 3.894, Global test accuracy: 17.56
Round  41, Train loss: 0.542, Test loss: 1.311, Test accuracy: 64.63
Round  41, Global train loss: 0.542, Global test loss: 3.321, Global test accuracy: 18.13
Round  42, Train loss: 0.491, Test loss: 1.353, Test accuracy: 64.64
Round  42, Global train loss: 0.491, Global test loss: 3.372, Global test accuracy: 16.73
Round  43, Train loss: 0.539, Test loss: 1.344, Test accuracy: 64.93
Round  43, Global train loss: 0.539, Global test loss: 3.395, Global test accuracy: 16.50
Round  44, Train loss: 0.468, Test loss: 1.340, Test accuracy: 65.18
Round  44, Global train loss: 0.468, Global test loss: 3.502, Global test accuracy: 17.84
Round  45, Train loss: 0.430, Test loss: 1.352, Test accuracy: 64.60
Round  45, Global train loss: 0.430, Global test loss: 3.428, Global test accuracy: 18.39
Round  46, Train loss: 0.525, Test loss: 1.411, Test accuracy: 63.94
Round  46, Global train loss: 0.525, Global test loss: 3.215, Global test accuracy: 17.29
Round  47, Train loss: 0.438, Test loss: 1.407, Test accuracy: 64.65
Round  47, Global train loss: 0.438, Global test loss: 3.554, Global test accuracy: 18.43
Round  48, Train loss: 0.288, Test loss: 1.400, Test accuracy: 64.82
Round  48, Global train loss: 0.288, Global test loss: 3.745, Global test accuracy: 19.11
Round  49, Train loss: 0.306, Test loss: 1.389, Test accuracy: 64.86
Round  49, Global train loss: 0.306, Global test loss: 3.937, Global test accuracy: 16.97
Round  50, Train loss: 0.289, Test loss: 1.395, Test accuracy: 65.19
Round  50, Global train loss: 0.289, Global test loss: 3.869, Global test accuracy: 17.73
Round  51, Train loss: 0.410, Test loss: 1.423, Test accuracy: 64.58
Round  51, Global train loss: 0.410, Global test loss: 3.799, Global test accuracy: 18.64
Round  52, Train loss: 0.390, Test loss: 1.429, Test accuracy: 64.97
Round  52, Global train loss: 0.390, Global test loss: 3.778, Global test accuracy: 17.67
Round  53, Train loss: 0.321, Test loss: 1.431, Test accuracy: 64.70
Round  53, Global train loss: 0.321, Global test loss: 3.988, Global test accuracy: 18.05
Round  54, Train loss: 0.359, Test loss: 1.432, Test accuracy: 64.68
Round  54, Global train loss: 0.359, Global test loss: 3.961, Global test accuracy: 16.58
Round  55, Train loss: 0.365, Test loss: 1.449, Test accuracy: 64.67
Round  55, Global train loss: 0.365, Global test loss: 3.778, Global test accuracy: 16.58
Round  56, Train loss: 0.308, Test loss: 1.441, Test accuracy: 64.80
Round  56, Global train loss: 0.308, Global test loss: 4.298, Global test accuracy: 17.15
Round  57, Train loss: 0.523, Test loss: 1.447, Test accuracy: 65.01
Round  57, Global train loss: 0.523, Global test loss: 3.524, Global test accuracy: 14.91
Round  58, Train loss: 0.337, Test loss: 1.463, Test accuracy: 65.29
Round  58, Global train loss: 0.337, Global test loss: 3.891, Global test accuracy: 15.55
Round  59, Train loss: 0.326, Test loss: 1.446, Test accuracy: 65.36
Round  59, Global train loss: 0.326, Global test loss: 4.123, Global test accuracy: 17.29
Round  60, Train loss: 0.336, Test loss: 1.492, Test accuracy: 65.03
Round  60, Global train loss: 0.336, Global test loss: 3.986, Global test accuracy: 17.92
Round  61, Train loss: 0.260, Test loss: 1.515, Test accuracy: 64.70
Round  61, Global train loss: 0.260, Global test loss: 3.885, Global test accuracy: 15.45
Round  62, Train loss: 0.395, Test loss: 1.515, Test accuracy: 65.21
Round  62, Global train loss: 0.395, Global test loss: 3.730, Global test accuracy: 15.83
Round  63, Train loss: 0.342, Test loss: 1.520, Test accuracy: 65.08
Round  63, Global train loss: 0.342, Global test loss: 4.172, Global test accuracy: 17.81
Round  64, Train loss: 0.354, Test loss: 1.520, Test accuracy: 64.66
Round  64, Global train loss: 0.354, Global test loss: 3.732, Global test accuracy: 16.69
Round  65, Train loss: 0.257, Test loss: 1.542, Test accuracy: 64.53
Round  65, Global train loss: 0.257, Global test loss: 4.096, Global test accuracy: 16.74
Round  66, Train loss: 0.249, Test loss: 1.504, Test accuracy: 64.59
Round  66, Global train loss: 0.249, Global test loss: 4.268, Global test accuracy: 18.29
Round  67, Train loss: 0.357, Test loss: 1.487, Test accuracy: 64.82
Round  67, Global train loss: 0.357, Global test loss: 3.894, Global test accuracy: 17.03
Round  68, Train loss: 0.303, Test loss: 1.535, Test accuracy: 64.45
Round  68, Global train loss: 0.303, Global test loss: 4.229, Global test accuracy: 15.07
Round  69, Train loss: 0.235, Test loss: 1.546, Test accuracy: 64.92
Round  69, Global train loss: 0.235, Global test loss: 4.403, Global test accuracy: 16.48
Round  70, Train loss: 0.257, Test loss: 1.543, Test accuracy: 64.95
Round  70, Global train loss: 0.257, Global test loss: 4.248, Global test accuracy: 18.74
Round  71, Train loss: 0.351, Test loss: 1.511, Test accuracy: 65.56
Round  71, Global train loss: 0.351, Global test loss: 4.061, Global test accuracy: 19.28
Round  72, Train loss: 0.341, Test loss: 1.512, Test accuracy: 65.37
Round  72, Global train loss: 0.341, Global test loss: 3.833, Global test accuracy: 18.36
Round  73, Train loss: 0.349, Test loss: 1.502, Test accuracy: 65.43
Round  73, Global train loss: 0.349, Global test loss: 3.953, Global test accuracy: 17.51
Round  74, Train loss: 0.247, Test loss: 1.515, Test accuracy: 65.25
Round  74, Global train loss: 0.247, Global test loss: 4.040, Global test accuracy: 16.62
Round  75, Train loss: 0.253, Test loss: 1.512, Test accuracy: 65.42
Round  75, Global train loss: 0.253, Global test loss: 4.136, Global test accuracy: 18.58
Round  76, Train loss: 0.214, Test loss: 1.520, Test accuracy: 65.48
Round  76, Global train loss: 0.214, Global test loss: 4.164, Global test accuracy: 16.14
Round  77, Train loss: 0.410, Test loss: 1.511, Test accuracy: 65.95
Round  77, Global train loss: 0.410, Global test loss: 4.045, Global test accuracy: 17.01
Round  78, Train loss: 0.324, Test loss: 1.514, Test accuracy: 65.96
Round  78, Global train loss: 0.324, Global test loss: 4.027, Global test accuracy: 17.45
Round  79, Train loss: 0.216, Test loss: 1.539, Test accuracy: 65.81
Round  79, Global train loss: 0.216, Global test loss: 4.403, Global test accuracy: 20.07
Round  80, Train loss: 0.207, Test loss: 1.552, Test accuracy: 65.83
Round  80, Global train loss: 0.207, Global test loss: 3.910, Global test accuracy: 17.46
Round  81, Train loss: 0.183, Test loss: 1.531, Test accuracy: 65.89
Round  81, Global train loss: 0.183, Global test loss: 4.173, Global test accuracy: 18.06
Round  82, Train loss: 0.172, Test loss: 1.575, Test accuracy: 65.66
Round  82, Global train loss: 0.172, Global test loss: 4.314, Global test accuracy: 18.48
Round  83, Train loss: 0.179, Test loss: 1.573, Test accuracy: 65.76
Round  83, Global train loss: 0.179, Global test loss: 4.259, Global test accuracy: 18.33
Round  84, Train loss: 0.166, Test loss: 1.539, Test accuracy: 65.82
Round  84, Global train loss: 0.166, Global test loss: 4.309, Global test accuracy: 18.18
Round  85, Train loss: 0.161, Test loss: 1.608, Test accuracy: 64.94
Round  85, Global train loss: 0.161, Global test loss: 4.479, Global test accuracy: 18.25
Round  86, Train loss: 0.155, Test loss: 1.621, Test accuracy: 65.61
Round  86, Global train loss: 0.155, Global test loss: 4.385, Global test accuracy: 18.42
Round  87, Train loss: 0.154, Test loss: 1.597, Test accuracy: 65.87
Round  87, Global train loss: 0.154, Global test loss: 4.516, Global test accuracy: 18.72
Round  88, Train loss: 0.145, Test loss: 1.585, Test accuracy: 65.75
Round  88, Global train loss: 0.145, Global test loss: 4.461, Global test accuracy: 18.06
Round  89, Train loss: 0.145, Test loss: 1.618, Test accuracy: 65.28
Round  89, Global train loss: 0.145, Global test loss: 4.534, Global test accuracy: 18.16
Round  90, Train loss: 0.306, Test loss: 1.611, Test accuracy: 65.34
Round  90, Global train loss: 0.306, Global test loss: 3.609, Global test accuracy: 17.74
Round  91, Train loss: 0.276, Test loss: 1.669, Test accuracy: 65.30
Round  91, Global train loss: 0.276, Global test loss: 3.609, Global test accuracy: 17.95
Round  92, Train loss: 0.271, Test loss: 1.642, Test accuracy: 66.47
Round  92, Global train loss: 0.271, Global test loss: 3.609, Global test accuracy: 17.45
Round  93, Train loss: 0.269, Test loss: 1.675, Test accuracy: 65.28
Round  93, Global train loss: 0.269, Global test loss: 3.596, Global test accuracy: 17.59
Round  94, Train loss: 0.262, Test loss: 1.636, Test accuracy: 64.96
Round  94, Global train loss: 0.262, Global test loss: 3.570, Global test accuracy: 17.95
Round  95, Train loss: 0.253, Test loss: 1.680, Test accuracy: 65.25
Round  95, Global train loss: 0.253, Global test loss: 3.597, Global test accuracy: 17.65
Round  96, Train loss: 0.255, Test loss: 1.680, Test accuracy: 65.80
Round  96, Global train loss: 0.255, Global test loss: 3.596, Global test accuracy: 17.75
Round  97, Train loss: 0.254, Test loss: 1.728, Test accuracy: 65.07
Round  97, Global train loss: 0.254, Global test loss: 3.585, Global test accuracy: 17.50
Round  98, Train loss: 0.245, Test loss: 1.680, Test accuracy: 65.73
Round  98, Global train loss: 0.245, Global test loss: 3.671, Global test accuracy: 17.88
Round  99, Train loss: 0.249, Test loss: 1.709, Test accuracy: 65.25
Round  99, Global train loss: 0.249, Global test loss: 3.628, Global test accuracy: 17.64
Final Round, Train loss: 0.181, Test loss: 1.905, Test accuracy: 65.54
Final Round, Global train loss: 0.181, Global test loss: 3.628, Global test accuracy: 17.64
Average accuracy final 10 rounds: 65.445
Average global accuracy final 10 rounds: 17.71
2658.5993406772614
[3.0186312198638916, 5.840991020202637, 8.471768379211426, 11.221584796905518, 13.864622354507446, 16.46423363685608, 19.166707754135132, 21.998793840408325, 24.428696870803833, 26.940812349319458, 29.35531210899353, 31.749213218688965, 33.787054777145386, 35.81174302101135, 38.295244455337524, 40.32191038131714, 42.352224588394165, 44.3895103931427, 46.85118627548218, 48.887394189834595, 50.9242525100708, 52.95964598655701, 55.34942317008972, 57.38994908332825, 59.42631959915161, 61.78207468986511, 64.20306253433228, 66.48228812217712, 68.77153086662292, 71.24135255813599, 73.5235767364502, 75.80665373802185, 78.31950068473816, 80.85107612609863, 83.13087344169617, 85.40515542030334, 88.22569060325623, 90.51857495307922, 92.8001160621643, 95.49375581741333, 97.86427211761475, 100.1304669380188, 102.40599083900452, 104.8497486114502, 107.1256730556488, 109.40617775917053, 111.94052600860596, 114.21867156028748, 116.49817180633545, 118.78307795524597, 121.45796012878418, 123.72894406318665, 125.9927134513855, 128.66183423995972, 130.93734860420227, 133.20540928840637, 135.5226926803589, 138.20157623291016, 140.4862585067749, 142.7744801044464, 145.4318835735321, 147.71144437789917, 149.99493145942688, 152.8499677181244, 155.14383816719055, 157.44492530822754, 159.74268507957458, 162.25270986557007, 164.54074358940125, 166.82229828834534, 169.27865600585938, 171.54234147071838, 173.81714868545532, 176.0824155807495, 178.61328077316284, 180.91791415214539, 183.2178032398224, 186.04726934432983, 188.33106398582458, 190.61451363563538, 193.1367163658142, 195.4146568775177, 198.11885523796082, 200.5489203929901, 202.83195281028748, 205.45938324928284, 207.72976899147034, 210.28422784805298, 212.5630280971527, 215.05390858650208, 217.33695721626282, 219.75857138633728, 222.24817895889282, 224.95609593391418, 227.32912921905518, 229.59150791168213, 231.92297840118408, 234.34574222564697, 236.36246967315674, 238.79964566230774, 244.2300398349762]
[46.31, 52.12, 55.87, 57.52, 57.71, 59.47, 60.27, 61.2, 62.22, 61.73, 62.45, 62.36, 62.57, 62.93, 62.9, 62.62, 62.56, 62.85, 63.53, 64.01, 63.53, 63.82, 64.18, 64.5, 64.24, 64.11, 63.82, 64.34, 64.46, 64.18, 64.55, 64.87, 65.05, 64.48, 64.32, 64.22, 63.82, 64.13, 64.41, 64.73, 64.37, 64.63, 64.64, 64.93, 65.18, 64.6, 63.94, 64.65, 64.82, 64.86, 65.19, 64.58, 64.97, 64.7, 64.68, 64.67, 64.8, 65.01, 65.29, 65.36, 65.03, 64.7, 65.21, 65.08, 64.66, 64.53, 64.59, 64.82, 64.45, 64.92, 64.95, 65.56, 65.37, 65.43, 65.25, 65.42, 65.48, 65.95, 65.96, 65.81, 65.83, 65.89, 65.66, 65.76, 65.82, 64.94, 65.61, 65.87, 65.75, 65.28, 65.34, 65.3, 66.47, 65.28, 64.96, 65.25, 65.8, 65.07, 65.73, 65.25, 65.54]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.537, Test loss: 1.321, Test accuracy: 43.83
Round   0, Global train loss: 1.537, Global test loss: 2.275, Global test accuracy: 15.08
Round   1, Train loss: 1.399, Test loss: 1.221, Test accuracy: 50.20
Round   1, Global train loss: 1.399, Global test loss: 2.295, Global test accuracy: 15.98
Round   2, Train loss: 1.308, Test loss: 1.151, Test accuracy: 54.25
Round   2, Global train loss: 1.308, Global test loss: 2.295, Global test accuracy: 16.27
Round   3, Train loss: 1.238, Test loss: 1.125, Test accuracy: 56.09
Round   3, Global train loss: 1.238, Global test loss: 2.298, Global test accuracy: 16.31
Round   4, Train loss: 1.183, Test loss: 1.117, Test accuracy: 56.95
Round   4, Global train loss: 1.183, Global test loss: 2.295, Global test accuracy: 16.26
Round   5, Train loss: 1.134, Test loss: 1.088, Test accuracy: 58.63
Round   5, Global train loss: 1.134, Global test loss: 2.309, Global test accuracy: 15.97
Round   6, Train loss: 1.096, Test loss: 1.058, Test accuracy: 60.12
Round   6, Global train loss: 1.096, Global test loss: 2.295, Global test accuracy: 16.21
Round   7, Train loss: 1.054, Test loss: 1.059, Test accuracy: 60.83
Round   7, Global train loss: 1.054, Global test loss: 2.311, Global test accuracy: 15.76
Round   8, Train loss: 1.014, Test loss: 1.060, Test accuracy: 61.43
Round   8, Global train loss: 1.014, Global test loss: 2.318, Global test accuracy: 16.18
Round   9, Train loss: 0.977, Test loss: 1.042, Test accuracy: 62.24
Round   9, Global train loss: 0.977, Global test loss: 2.330, Global test accuracy: 16.25
Round  10, Train loss: 0.953, Test loss: 1.055, Test accuracy: 62.17
Round  10, Global train loss: 0.953, Global test loss: 2.785, Global test accuracy: 12.87
Round  11, Train loss: 0.977, Test loss: 1.055, Test accuracy: 62.10
Round  11, Global train loss: 0.977, Global test loss: 2.627, Global test accuracy: 14.30
Round  12, Train loss: 0.786, Test loss: 1.063, Test accuracy: 62.00
Round  12, Global train loss: 0.786, Global test loss: 2.807, Global test accuracy: 15.29
Round  13, Train loss: 0.874, Test loss: 1.069, Test accuracy: 62.85
Round  13, Global train loss: 0.874, Global test loss: 2.687, Global test accuracy: 14.30
Round  14, Train loss: 0.775, Test loss: 1.067, Test accuracy: 63.48
Round  14, Global train loss: 0.775, Global test loss: 2.729, Global test accuracy: 15.62
Round  15, Train loss: 0.736, Test loss: 1.071, Test accuracy: 63.47
Round  15, Global train loss: 0.736, Global test loss: 2.872, Global test accuracy: 15.29
Round  16, Train loss: 0.892, Test loss: 1.061, Test accuracy: 63.75
Round  16, Global train loss: 0.892, Global test loss: 2.838, Global test accuracy: 12.92
Round  17, Train loss: 0.777, Test loss: 1.050, Test accuracy: 64.51
Round  17, Global train loss: 0.777, Global test loss: 2.810, Global test accuracy: 12.90
Round  18, Train loss: 0.599, Test loss: 1.097, Test accuracy: 63.71
Round  18, Global train loss: 0.599, Global test loss: 2.915, Global test accuracy: 13.29
Round  19, Train loss: 0.822, Test loss: 1.106, Test accuracy: 63.90
Round  19, Global train loss: 0.822, Global test loss: 2.855, Global test accuracy: 13.43
Round  20, Train loss: 0.758, Test loss: 1.132, Test accuracy: 63.23
Round  20, Global train loss: 0.758, Global test loss: 2.850, Global test accuracy: 13.11
Round  21, Train loss: 0.676, Test loss: 1.145, Test accuracy: 63.29
Round  21, Global train loss: 0.676, Global test loss: 3.155, Global test accuracy: 13.31
Round  22, Train loss: 0.746, Test loss: 1.137, Test accuracy: 63.69
Round  22, Global train loss: 0.746, Global test loss: 2.767, Global test accuracy: 13.33
Round  23, Train loss: 0.601, Test loss: 1.175, Test accuracy: 63.71
Round  23, Global train loss: 0.601, Global test loss: 2.998, Global test accuracy: 14.03
Round  24, Train loss: 0.604, Test loss: 1.199, Test accuracy: 63.73
Round  24, Global train loss: 0.604, Global test loss: 3.362, Global test accuracy: 14.10
Round  25, Train loss: 0.564, Test loss: 1.212, Test accuracy: 63.65
Round  25, Global train loss: 0.564, Global test loss: 3.317, Global test accuracy: 12.81
Round  26, Train loss: 0.566, Test loss: 1.206, Test accuracy: 63.43
Round  26, Global train loss: 0.566, Global test loss: 3.269, Global test accuracy: 13.73
Round  27, Train loss: 0.469, Test loss: 1.223, Test accuracy: 63.48
Round  27, Global train loss: 0.469, Global test loss: 3.381, Global test accuracy: 14.56
Round  28, Train loss: 0.692, Test loss: 1.244, Test accuracy: 62.87
Round  28, Global train loss: 0.692, Global test loss: 3.289, Global test accuracy: 14.43
Round  29, Train loss: 0.580, Test loss: 1.235, Test accuracy: 62.99
Round  29, Global train loss: 0.580, Global test loss: 2.988, Global test accuracy: 14.69
Round  30, Train loss: 0.577, Test loss: 1.282, Test accuracy: 62.66
Round  30, Global train loss: 0.577, Global test loss: 3.317, Global test accuracy: 14.98
Round  31, Train loss: 0.485, Test loss: 1.293, Test accuracy: 63.08
Round  31, Global train loss: 0.485, Global test loss: 3.426, Global test accuracy: 15.25
Round  32, Train loss: 0.568, Test loss: 1.294, Test accuracy: 63.67
Round  32, Global train loss: 0.568, Global test loss: 3.383, Global test accuracy: 14.77
Round  33, Train loss: 0.589, Test loss: 1.312, Test accuracy: 63.21
Round  33, Global train loss: 0.589, Global test loss: 3.335, Global test accuracy: 14.32
Round  34, Train loss: 0.542, Test loss: 1.327, Test accuracy: 63.42
Round  34, Global train loss: 0.542, Global test loss: 3.651, Global test accuracy: 12.98
Round  35, Train loss: 0.522, Test loss: 1.357, Test accuracy: 63.23
Round  35, Global train loss: 0.522, Global test loss: 3.645, Global test accuracy: 14.05
Round  36, Train loss: 0.520, Test loss: 1.365, Test accuracy: 63.31
Round  36, Global train loss: 0.520, Global test loss: 3.255, Global test accuracy: 15.24
Round  37, Train loss: 0.499, Test loss: 1.380, Test accuracy: 63.25
Round  37, Global train loss: 0.499, Global test loss: 3.567, Global test accuracy: 13.88
Round  38, Train loss: 0.492, Test loss: 1.410, Test accuracy: 63.25
Round  38, Global train loss: 0.492, Global test loss: 3.386, Global test accuracy: 14.73
Round  39, Train loss: 0.575, Test loss: 1.401, Test accuracy: 63.62
Round  39, Global train loss: 0.575, Global test loss: 3.456, Global test accuracy: 13.89
Round  40, Train loss: 0.393, Test loss: 1.413, Test accuracy: 63.61
Round  40, Global train loss: 0.393, Global test loss: 3.550, Global test accuracy: 13.53
Round  41, Train loss: 0.436, Test loss: 1.439, Test accuracy: 63.47
Round  41, Global train loss: 0.436, Global test loss: 3.614, Global test accuracy: 14.08
Round  42, Train loss: 0.457, Test loss: 1.442, Test accuracy: 63.17
Round  42, Global train loss: 0.457, Global test loss: 3.418, Global test accuracy: 13.64
Round  43, Train loss: 0.535, Test loss: 1.466, Test accuracy: 63.30
Round  43, Global train loss: 0.535, Global test loss: 3.447, Global test accuracy: 14.38
Round  44, Train loss: 0.432, Test loss: 1.485, Test accuracy: 63.37
Round  44, Global train loss: 0.432, Global test loss: 3.594, Global test accuracy: 14.42
Round  45, Train loss: 0.445, Test loss: 1.478, Test accuracy: 63.68
Round  45, Global train loss: 0.445, Global test loss: 3.627, Global test accuracy: 14.62
Round  46, Train loss: 0.457, Test loss: 1.482, Test accuracy: 63.07
Round  46, Global train loss: 0.457, Global test loss: 3.813, Global test accuracy: 14.68
Round  47, Train loss: 0.398, Test loss: 1.478, Test accuracy: 63.38
Round  47, Global train loss: 0.398, Global test loss: 3.694, Global test accuracy: 13.84
Round  48, Train loss: 0.414, Test loss: 1.502, Test accuracy: 63.51
Round  48, Global train loss: 0.414, Global test loss: 3.837, Global test accuracy: 13.91
Round  49, Train loss: 0.317, Test loss: 1.535, Test accuracy: 63.14
Round  49, Global train loss: 0.317, Global test loss: 3.963, Global test accuracy: 14.47
Round  50, Train loss: 0.398, Test loss: 1.544, Test accuracy: 63.22
Round  50, Global train loss: 0.398, Global test loss: 3.667, Global test accuracy: 13.24
Round  51, Train loss: 0.455, Test loss: 1.524, Test accuracy: 63.81
Round  51, Global train loss: 0.455, Global test loss: 4.186, Global test accuracy: 11.93
Round  52, Train loss: 0.439, Test loss: 1.577, Test accuracy: 63.27
Round  52, Global train loss: 0.439, Global test loss: 3.942, Global test accuracy: 14.87
Round  53, Train loss: 0.392, Test loss: 1.571, Test accuracy: 63.45
Round  53, Global train loss: 0.392, Global test loss: 4.170, Global test accuracy: 15.36
Round  54, Train loss: 0.316, Test loss: 1.559, Test accuracy: 63.36
Round  54, Global train loss: 0.316, Global test loss: 4.024, Global test accuracy: 15.39
Round  55, Train loss: 0.415, Test loss: 1.551, Test accuracy: 63.97
Round  55, Global train loss: 0.415, Global test loss: 3.819, Global test accuracy: 14.21
Round  56, Train loss: 0.345, Test loss: 1.548, Test accuracy: 63.82
Round  56, Global train loss: 0.345, Global test loss: 3.543, Global test accuracy: 14.67
Round  57, Train loss: 0.412, Test loss: 1.537, Test accuracy: 63.72
Round  57, Global train loss: 0.412, Global test loss: 3.718, Global test accuracy: 15.89
Round  58, Train loss: 0.448, Test loss: 1.573, Test accuracy: 62.89
Round  58, Global train loss: 0.448, Global test loss: 4.064, Global test accuracy: 13.53
Round  59, Train loss: 0.319, Test loss: 1.594, Test accuracy: 62.95
Round  59, Global train loss: 0.319, Global test loss: 4.636, Global test accuracy: 13.58
Round  60, Train loss: 0.363, Test loss: 1.610, Test accuracy: 62.92
Round  60, Global train loss: 0.363, Global test loss: 4.303, Global test accuracy: 13.44
Round  61, Train loss: 0.349, Test loss: 1.631, Test accuracy: 62.56
Round  61, Global train loss: 0.349, Global test loss: 3.922, Global test accuracy: 14.46
Round  62, Train loss: 0.381, Test loss: 1.639, Test accuracy: 62.65
Round  62, Global train loss: 0.381, Global test loss: 3.879, Global test accuracy: 15.49
Round  63, Train loss: 0.391, Test loss: 1.651, Test accuracy: 62.46
Round  63, Global train loss: 0.391, Global test loss: 4.013, Global test accuracy: 12.44
Round  64, Train loss: 0.423, Test loss: 1.635, Test accuracy: 62.44
Round  64, Global train loss: 0.423, Global test loss: 4.293, Global test accuracy: 12.38
Round  65, Train loss: 0.341, Test loss: 1.634, Test accuracy: 62.68
Round  65, Global train loss: 0.341, Global test loss: 3.796, Global test accuracy: 14.80
Round  66, Train loss: 0.297, Test loss: 1.653, Test accuracy: 62.41
Round  66, Global train loss: 0.297, Global test loss: 4.180, Global test accuracy: 14.08
Round  67, Train loss: 0.395, Test loss: 1.630, Test accuracy: 62.69
Round  67, Global train loss: 0.395, Global test loss: 4.138, Global test accuracy: 12.29
Round  68, Train loss: 0.372, Test loss: 1.611, Test accuracy: 63.32
Round  68, Global train loss: 0.372, Global test loss: 4.212, Global test accuracy: 14.62
Round  69, Train loss: 0.331, Test loss: 1.628, Test accuracy: 63.16
Round  69, Global train loss: 0.331, Global test loss: 3.765, Global test accuracy: 13.23
Round  70, Train loss: 0.340, Test loss: 1.648, Test accuracy: 63.10
Round  70, Global train loss: 0.340, Global test loss: 3.961, Global test accuracy: 13.79
Round  71, Train loss: 0.374, Test loss: 1.667, Test accuracy: 63.30
Round  71, Global train loss: 0.374, Global test loss: 3.869, Global test accuracy: 13.90
Round  72, Train loss: 0.328, Test loss: 1.689, Test accuracy: 62.70
Round  72, Global train loss: 0.328, Global test loss: 3.872, Global test accuracy: 14.94
Round  73, Train loss: 0.324, Test loss: 1.679, Test accuracy: 63.04
Round  73, Global train loss: 0.324, Global test loss: 4.601, Global test accuracy: 15.16
Round  74, Train loss: 0.327, Test loss: 1.689, Test accuracy: 63.11
Round  74, Global train loss: 0.327, Global test loss: 3.882, Global test accuracy: 13.54
Round  75, Train loss: 0.279, Test loss: 1.686, Test accuracy: 63.20
Round  75, Global train loss: 0.279, Global test loss: 4.263, Global test accuracy: 13.94
Round  76, Train loss: 0.319, Test loss: 1.692, Test accuracy: 62.89
Round  76, Global train loss: 0.319, Global test loss: 4.274, Global test accuracy: 14.27
Round  77, Train loss: 0.332, Test loss: 1.678, Test accuracy: 63.16
Round  77, Global train loss: 0.332, Global test loss: 4.590, Global test accuracy: 14.33
Round  78, Train loss: 0.288, Test loss: 1.716, Test accuracy: 62.98
Round  78, Global train loss: 0.288, Global test loss: 4.624, Global test accuracy: 16.05
Round  79, Train loss: 0.302, Test loss: 1.700, Test accuracy: 63.12
Round  79, Global train loss: 0.302, Global test loss: 4.238, Global test accuracy: 12.20
Round  80, Train loss: 0.248, Test loss: 1.709, Test accuracy: 63.43
Round  80, Global train loss: 0.248, Global test loss: 3.892, Global test accuracy: 15.28
Round  81, Train loss: 0.222, Test loss: 1.743, Test accuracy: 62.86
Round  81, Global train loss: 0.222, Global test loss: 4.001, Global test accuracy: 14.63
Round  82, Train loss: 0.210, Test loss: 1.701, Test accuracy: 63.81
Round  82, Global train loss: 0.210, Global test loss: 4.068, Global test accuracy: 14.50
Round  83, Train loss: 0.202, Test loss: 1.749, Test accuracy: 63.55
Round  83, Global train loss: 0.202, Global test loss: 4.139, Global test accuracy: 14.44
Round  84, Train loss: 0.197, Test loss: 1.733, Test accuracy: 63.60
Round  84, Global train loss: 0.197, Global test loss: 4.159, Global test accuracy: 14.67
Round  85, Train loss: 0.193, Test loss: 1.763, Test accuracy: 63.70
Round  85, Global train loss: 0.193, Global test loss: 4.193, Global test accuracy: 14.23
Round  86, Train loss: 0.188, Test loss: 1.772, Test accuracy: 63.60
Round  86, Global train loss: 0.188, Global test loss: 4.208, Global test accuracy: 14.54
Round  87, Train loss: 0.181, Test loss: 1.752, Test accuracy: 63.52
Round  87, Global train loss: 0.181, Global test loss: 4.316, Global test accuracy: 14.23
Round  88, Train loss: 0.180, Test loss: 1.757, Test accuracy: 63.61
Round  88, Global train loss: 0.180, Global test loss: 4.277, Global test accuracy: 14.81
Round  89, Train loss: 0.167, Test loss: 1.780, Test accuracy: 63.28
Round  89, Global train loss: 0.167, Global test loss: 4.400, Global test accuracy: 14.42
Round  90, Train loss: 0.321, Test loss: 1.715, Test accuracy: 63.64
Round  90, Global train loss: 0.321, Global test loss: 3.711, Global test accuracy: 14.51
Round  91, Train loss: 0.297, Test loss: 1.801, Test accuracy: 62.80
Round  91, Global train loss: 0.297, Global test loss: 3.674, Global test accuracy: 14.70
Round  92, Train loss: 0.284, Test loss: 1.818, Test accuracy: 63.44
Round  92, Global train loss: 0.284, Global test loss: 3.719, Global test accuracy: 14.72
Round  93, Train loss: 0.278, Test loss: 1.774, Test accuracy: 63.03
Round  93, Global train loss: 0.278, Global test loss: 3.656, Global test accuracy: 14.96
Round  94, Train loss: 0.275, Test loss: 1.803, Test accuracy: 63.09
Round  94, Global train loss: 0.275, Global test loss: 3.649, Global test accuracy: 14.78
Round  95, Train loss: 0.267, Test loss: 1.791, Test accuracy: 63.40
Round  95, Global train loss: 0.267, Global test loss: 3.647, Global test accuracy: 14.74
Round  96, Train loss: 0.264, Test loss: 1.801, Test accuracy: 63.12
Round  96, Global train loss: 0.264, Global test loss: 3.689, Global test accuracy: 14.55
Round  97, Train loss: 0.260, Test loss: 1.794, Test accuracy: 63.50
Round  97, Global train loss: 0.260, Global test loss: 3.672, Global test accuracy: 14.76
Round  98, Train loss: 0.257, Test loss: 1.858, Test accuracy: 63.23
Round  98, Global train loss: 0.257, Global test loss: 3.720, Global test accuracy: 14.99
Round  99, Train loss: 0.261, Test loss: 1.842, Test accuracy: 63.39
Round  99, Global train loss: 0.261, Global test loss: 3.726, Global test accuracy: 14.80
Final Round, Train loss: 0.184, Test loss: 2.001, Test accuracy: 64.35
Final Round, Global train loss: 0.184, Global test loss: 3.726, Global test accuracy: 14.80
Average accuracy final 10 rounds: 63.263999999999996
Average global accuracy final 10 rounds: 14.751000000000003
5585.399235725403
[2.6044654846191406, 5.207484722137451, 7.82513952255249, 10.424208402633667, 12.425901174545288, 14.982795238494873, 17.274071216583252, 19.58403491973877, 21.594508409500122, 24.20936393737793, 26.215396642684937, 28.888360261917114, 30.875062942504883, 32.859097719192505, 35.28658151626587, 37.894871950149536, 39.88913083076477, 41.87762475013733, 44.594992876052856, 46.93745517730713, 49.28409433364868, 56.07590293884277, 62.706738233566284, 69.18621277809143, 76.21110916137695, 83.51541066169739, 89.94162368774414, 97.1496160030365, 104.57017707824707, 111.00781655311584, 118.1389331817627, 124.7844250202179, 131.2577669620514, 138.17973136901855, 145.01970887184143, 151.4038634300232, 158.46681427955627, 165.17099571228027, 171.4244418144226, 178.56547665596008, 185.83884406089783, 191.94671082496643, 198.60183310508728, 206.368004322052, 212.7717821598053, 219.2580578327179, 225.69179487228394, 232.13756394386292, 238.54415011405945, 245.02925610542297, 251.44683527946472, 257.8449101448059, 264.18086314201355, 270.62373542785645, 277.0366995334625, 283.4173409938812, 289.9088125228882, 296.39462780952454, 303.0734965801239, 309.52917647361755, 315.88907408714294, 322.4097707271576, 328.5639681816101, 335.0834639072418, 341.4908049106598, 347.6261067390442, 354.2794511318207, 360.7651557922363, 366.9697358608246, 373.35981249809265, 379.81749153137207, 385.99990487098694, 392.2520000934601, 398.6573941707611, 404.98759388923645, 411.4175980091095, 417.5568745136261, 424.82219910621643, 432.9724223613739, 440.2189567089081, 447.5536072254181, 454.925758600235, 463.35119009017944, 470.94492840766907, 479.14548659324646, 486.785519361496, 494.8422255516052, 502.28900241851807, 510.21436738967896, 517.8817594051361, 526.6498596668243, 535.2472915649414, 543.544233083725, 552.3874669075012, 560.782731294632, 569.2686767578125, 577.9359221458435, 586.0426127910614, 595.5095043182373, 604.3333134651184, 609.2890374660492]
[43.83, 50.2, 54.25, 56.09, 56.95, 58.63, 60.12, 60.83, 61.43, 62.24, 62.17, 62.1, 62.0, 62.85, 63.48, 63.47, 63.75, 64.51, 63.71, 63.9, 63.23, 63.29, 63.69, 63.71, 63.73, 63.65, 63.43, 63.48, 62.87, 62.99, 62.66, 63.08, 63.67, 63.21, 63.42, 63.23, 63.31, 63.25, 63.25, 63.62, 63.61, 63.47, 63.17, 63.3, 63.37, 63.68, 63.07, 63.38, 63.51, 63.14, 63.22, 63.81, 63.27, 63.45, 63.36, 63.97, 63.82, 63.72, 62.89, 62.95, 62.92, 62.56, 62.65, 62.46, 62.44, 62.68, 62.41, 62.69, 63.32, 63.16, 63.1, 63.3, 62.7, 63.04, 63.11, 63.2, 62.89, 63.16, 62.98, 63.12, 63.43, 62.86, 63.81, 63.55, 63.6, 63.7, 63.6, 63.52, 63.61, 63.28, 63.64, 62.8, 63.44, 63.03, 63.09, 63.4, 63.12, 63.5, 63.23, 63.39, 64.35]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.733, Test loss: 1.842, Test accuracy: 22.48
Round   1, Train loss: 1.463, Test loss: 1.480, Test accuracy: 35.07
Round   2, Train loss: 1.345, Test loss: 1.330, Test accuracy: 41.58
Round   3, Train loss: 1.262, Test loss: 1.224, Test accuracy: 48.65
Round   4, Train loss: 1.201, Test loss: 1.157, Test accuracy: 52.14
Round   5, Train loss: 1.153, Test loss: 1.105, Test accuracy: 55.61
Round   6, Train loss: 1.123, Test loss: 1.068, Test accuracy: 57.60
Round   7, Train loss: 1.090, Test loss: 1.030, Test accuracy: 59.48
Round   8, Train loss: 1.063, Test loss: 1.007, Test accuracy: 60.96
Round   9, Train loss: 1.030, Test loss: 0.977, Test accuracy: 62.12
Round  10, Train loss: 1.005, Test loss: 0.966, Test accuracy: 62.91
Round  11, Train loss: 0.983, Test loss: 0.942, Test accuracy: 64.45
Round  12, Train loss: 0.958, Test loss: 0.943, Test accuracy: 65.05
Round  13, Train loss: 0.932, Test loss: 0.906, Test accuracy: 65.34
Round  14, Train loss: 0.911, Test loss: 0.897, Test accuracy: 65.85
Round  15, Train loss: 0.889, Test loss: 0.881, Test accuracy: 67.29
Round  16, Train loss: 0.869, Test loss: 0.876, Test accuracy: 67.65
Round  17, Train loss: 0.851, Test loss: 0.870, Test accuracy: 68.00
Round  18, Train loss: 0.834, Test loss: 0.857, Test accuracy: 68.21
Round  19, Train loss: 0.811, Test loss: 0.848, Test accuracy: 69.24
Round  20, Train loss: 0.847, Test loss: 0.869, Test accuracy: 68.79
Round  21, Train loss: 0.790, Test loss: 0.873, Test accuracy: 68.32
Round  22, Train loss: 0.872, Test loss: 0.868, Test accuracy: 68.57
Round  23, Train loss: 0.694, Test loss: 0.846, Test accuracy: 68.82
Round  24, Train loss: 0.743, Test loss: 0.860, Test accuracy: 69.12
Round  25, Train loss: 0.654, Test loss: 0.860, Test accuracy: 69.07
Round  26, Train loss: 0.685, Test loss: 0.866, Test accuracy: 69.22
Round  27, Train loss: 0.539, Test loss: 0.852, Test accuracy: 69.24
Round  28, Train loss: 0.776, Test loss: 0.853, Test accuracy: 69.47
Round  29, Train loss: 0.708, Test loss: 0.876, Test accuracy: 69.54
Round  30, Train loss: 0.715, Test loss: 0.888, Test accuracy: 69.24
Round  31, Train loss: 0.591, Test loss: 0.874, Test accuracy: 69.09
Round  32, Train loss: 0.674, Test loss: 0.879, Test accuracy: 69.01
Round  33, Train loss: 0.734, Test loss: 0.887, Test accuracy: 69.13
Round  34, Train loss: 0.700, Test loss: 0.904, Test accuracy: 68.46
Round  35, Train loss: 0.673, Test loss: 0.911, Test accuracy: 68.52
Round  36, Train loss: 0.599, Test loss: 0.882, Test accuracy: 69.62
Round  37, Train loss: 0.637, Test loss: 0.924, Test accuracy: 69.16
Round  38, Train loss: 0.575, Test loss: 0.951, Test accuracy: 68.49
Round  39, Train loss: 0.729, Test loss: 0.947, Test accuracy: 69.22
Round  40, Train loss: 0.514, Test loss: 0.949, Test accuracy: 68.90
Round  41, Train loss: 0.473, Test loss: 0.902, Test accuracy: 69.75
Round  42, Train loss: 0.549, Test loss: 0.900, Test accuracy: 70.11
Round  43, Train loss: 0.633, Test loss: 0.914, Test accuracy: 70.00
Round  44, Train loss: 0.496, Test loss: 0.896, Test accuracy: 70.49
Round  45, Train loss: 0.557, Test loss: 0.915, Test accuracy: 70.23
Round  46, Train loss: 0.544, Test loss: 0.949, Test accuracy: 69.53
Round  47, Train loss: 0.450, Test loss: 0.951, Test accuracy: 69.94
Round  48, Train loss: 0.547, Test loss: 0.991, Test accuracy: 69.36
Round  49, Train loss: 0.369, Test loss: 0.980, Test accuracy: 69.75
Round  50, Train loss: 0.493, Test loss: 0.975, Test accuracy: 69.76
Round  51, Train loss: 0.554, Test loss: 0.968, Test accuracy: 69.83
Round  52, Train loss: 0.495, Test loss: 0.960, Test accuracy: 70.24
Round  53, Train loss: 0.501, Test loss: 0.971, Test accuracy: 69.53
Round  54, Train loss: 0.353, Test loss: 0.975, Test accuracy: 69.66
Round  55, Train loss: 0.486, Test loss: 1.025, Test accuracy: 68.97
Round  56, Train loss: 0.414, Test loss: 0.993, Test accuracy: 69.57
Round  57, Train loss: 0.473, Test loss: 0.972, Test accuracy: 68.85
Round  58, Train loss: 0.576, Test loss: 1.021, Test accuracy: 68.70
Round  59, Train loss: 0.401, Test loss: 0.996, Test accuracy: 68.86
Round  60, Train loss: 0.445, Test loss: 1.008, Test accuracy: 69.12
Round  61, Train loss: 0.419, Test loss: 1.010, Test accuracy: 68.97
Round  62, Train loss: 0.437, Test loss: 0.996, Test accuracy: 69.48
Round  63, Train loss: 0.463, Test loss: 1.012, Test accuracy: 69.28
Round  64, Train loss: 0.510, Test loss: 1.013, Test accuracy: 69.08
Round  65, Train loss: 0.403, Test loss: 1.040, Test accuracy: 68.45
Round  66, Train loss: 0.354, Test loss: 1.037, Test accuracy: 69.05
Round  67, Train loss: 0.442, Test loss: 1.030, Test accuracy: 69.22
Round  68, Train loss: 0.433, Test loss: 1.091, Test accuracy: 68.73
Round  69, Train loss: 0.396, Test loss: 1.091, Test accuracy: 67.98
Round  70, Train loss: 0.404, Test loss: 1.075, Test accuracy: 68.37
Round  71, Train loss: 0.441, Test loss: 1.098, Test accuracy: 68.36
Round  72, Train loss: 0.369, Test loss: 1.049, Test accuracy: 69.09
Round  73, Train loss: 0.384, Test loss: 1.087, Test accuracy: 68.89
Round  74, Train loss: 0.390, Test loss: 1.059, Test accuracy: 68.63
Round  75, Train loss: 0.340, Test loss: 1.119, Test accuracy: 67.99
Round  76, Train loss: 0.378, Test loss: 1.128, Test accuracy: 68.07
Round  77, Train loss: 0.376, Test loss: 1.093, Test accuracy: 68.63
Round  78, Train loss: 0.340, Test loss: 1.133, Test accuracy: 68.08
Round  79, Train loss: 0.356, Test loss: 1.121, Test accuracy: 68.70
Round  80, Train loss: 0.270, Test loss: 1.104, Test accuracy: 69.38
Round  81, Train loss: 0.235, Test loss: 1.135, Test accuracy: 69.21
Round  82, Train loss: 0.243, Test loss: 1.140, Test accuracy: 69.26
Round  83, Train loss: 0.221, Test loss: 1.134, Test accuracy: 69.44
Round  84, Train loss: 0.217, Test loss: 1.147, Test accuracy: 69.24
Round  85, Train loss: 0.196, Test loss: 1.152, Test accuracy: 69.29
Round  86, Train loss: 0.209, Test loss: 1.172, Test accuracy: 69.50
Round  87, Train loss: 0.192, Test loss: 1.178, Test accuracy: 69.55
Round  88, Train loss: 0.185, Test loss: 1.190, Test accuracy: 69.07
Round  89, Train loss: 0.188, Test loss: 1.212, Test accuracy: 69.55
Round  90, Train loss: 0.348, Test loss: 1.132, Test accuracy: 69.86
Round  91, Train loss: 0.325, Test loss: 1.143, Test accuracy: 69.62
Round  92, Train loss: 0.308, Test loss: 1.171, Test accuracy: 69.67
Round  93, Train loss: 0.319, Test loss: 1.160, Test accuracy: 69.25
Round  94, Train loss: 0.300, Test loss: 1.156, Test accuracy: 69.25
Round  95, Train loss: 0.292, Test loss: 1.162, Test accuracy: 69.67
Round  96, Train loss: 0.301, Test loss: 1.189, Test accuracy: 69.01
Round  97, Train loss: 0.292, Test loss: 1.144, Test accuracy: 69.60
Round  98, Train loss: 0.295, Test loss: 1.165, Test accuracy: 69.03
Round  99, Train loss: 0.287, Test loss: 1.211, Test accuracy: 68.54
Final Round, Train loss: 0.239, Test loss: 1.173, Test accuracy: 69.51
Average accuracy final 10 rounds: 69.35000000000001
4442.706329345703
[2.7401890754699707, 5.60878849029541, 7.817272424697876, 10.452911615371704, 13.068607568740845, 15.635571002960205, 18.17103910446167, 20.92167568206787, 23.496784687042236, 25.591959238052368, 28.354318141937256, 31.062276601791382, 33.18799328804016, 35.662193775177, 38.26278328895569, 40.93245840072632, 43.026232957839966, 45.75155711174011, 48.33955526351929, 50.502461194992065, 53.19155812263489, 58.520103454589844, 64.129802942276, 69.58907651901245, 74.95536136627197, 80.40429019927979, 85.71813583374023, 91.54913210868835, 97.05157852172852, 102.86045098304749, 108.30524015426636, 113.83395838737488, 119.05396342277527, 125.35804843902588, 130.7055435180664, 136.00848960876465, 141.38017177581787, 146.94477939605713, 152.18701100349426, 158.02767658233643, 163.22302103042603, 168.81090188026428, 174.3644461631775, 179.50914096832275, 185.30834650993347, 190.51603031158447, 196.45334219932556, 201.4974069595337, 207.5294270515442, 212.77674865722656, 218.75721430778503, 224.41047143936157, 230.0140540599823, 235.81676959991455, 241.06264853477478, 247.01854991912842, 252.2869472503662, 258.0027208328247, 263.2810769081116, 268.94730615615845, 274.2178077697754, 280.21568965911865, 285.3894693851471, 290.7709255218506, 296.0428800582886, 301.23670077323914, 306.6154839992523, 311.5686104297638, 316.6147310733795, 321.4605152606964, 326.5410325527191, 331.41810488700867, 336.46054792404175, 341.5069065093994, 346.7329652309418, 351.9051637649536, 357.0738482475281, 362.17435693740845, 367.20903968811035, 372.2672061920166, 377.34425163269043, 382.47955083847046, 387.8157215118408, 393.03610134124756, 398.20294666290283, 403.4179403781891, 408.515016078949, 413.5972156524658, 418.86001086235046, 423.883314371109, 428.91900277137756, 434.11209416389465, 439.18568754196167, 444.22427320480347, 449.38263964653015, 454.58538150787354, 459.5744740962982, 464.6921696662903, 469.83838272094727, 474.9524435997009, 478.76469802856445]
[22.48, 35.07, 41.58, 48.65, 52.14, 55.61, 57.6, 59.48, 60.96, 62.12, 62.91, 64.45, 65.05, 65.34, 65.85, 67.29, 67.65, 68.0, 68.21, 69.24, 68.79, 68.32, 68.57, 68.82, 69.12, 69.07, 69.22, 69.24, 69.47, 69.54, 69.24, 69.09, 69.01, 69.13, 68.46, 68.52, 69.62, 69.16, 68.49, 69.22, 68.9, 69.75, 70.11, 70.0, 70.49, 70.23, 69.53, 69.94, 69.36, 69.75, 69.76, 69.83, 70.24, 69.53, 69.66, 68.97, 69.57, 68.85, 68.7, 68.86, 69.12, 68.97, 69.48, 69.28, 69.08, 68.45, 69.05, 69.22, 68.73, 67.98, 68.37, 68.36, 69.09, 68.89, 68.63, 67.99, 68.07, 68.63, 68.08, 68.7, 69.38, 69.21, 69.26, 69.44, 69.24, 69.29, 69.5, 69.55, 69.07, 69.55, 69.86, 69.62, 69.67, 69.25, 69.25, 69.67, 69.01, 69.6, 69.03, 68.54, 69.51]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.754, Test loss: 1.852, Test accuracy: 22.04
Round   1, Train loss: 1.461, Test loss: 1.553, Test accuracy: 31.40
Round   2, Train loss: 1.340, Test loss: 1.380, Test accuracy: 41.81
Round   3, Train loss: 1.253, Test loss: 1.253, Test accuracy: 47.42
Round   4, Train loss: 1.192, Test loss: 1.174, Test accuracy: 52.80
Round   5, Train loss: 1.147, Test loss: 1.095, Test accuracy: 56.44
Round   6, Train loss: 1.107, Test loss: 1.044, Test accuracy: 59.30
Round   7, Train loss: 1.075, Test loss: 1.038, Test accuracy: 58.38
Round   8, Train loss: 1.046, Test loss: 1.003, Test accuracy: 59.74
Round   9, Train loss: 1.015, Test loss: 0.973, Test accuracy: 62.36
Round  10, Train loss: 1.001, Test loss: 0.977, Test accuracy: 61.42
Round  11, Train loss: 1.126, Test loss: 0.973, Test accuracy: 62.00
Round  12, Train loss: 0.830, Test loss: 0.958, Test accuracy: 63.00
Round  13, Train loss: 0.891, Test loss: 0.925, Test accuracy: 64.41
Round  14, Train loss: 0.961, Test loss: 0.931, Test accuracy: 64.66
Round  15, Train loss: 0.839, Test loss: 0.909, Test accuracy: 65.25
Round  16, Train loss: 0.826, Test loss: 0.887, Test accuracy: 66.15
Round  17, Train loss: 0.908, Test loss: 0.885, Test accuracy: 66.91
Round  18, Train loss: 0.686, Test loss: 0.878, Test accuracy: 66.79
Round  19, Train loss: 0.942, Test loss: 0.869, Test accuracy: 67.54
Round  20, Train loss: 0.841, Test loss: 0.862, Test accuracy: 67.13
Round  21, Train loss: 0.944, Test loss: 0.857, Test accuracy: 67.99
Round  22, Train loss: 0.751, Test loss: 0.856, Test accuracy: 68.23
Round  23, Train loss: 0.714, Test loss: 0.838, Test accuracy: 68.40
Round  24, Train loss: 0.717, Test loss: 0.828, Test accuracy: 69.15
Round  25, Train loss: 0.546, Test loss: 0.832, Test accuracy: 68.53
Round  26, Train loss: 0.770, Test loss: 0.814, Test accuracy: 69.58
Round  27, Train loss: 0.583, Test loss: 0.822, Test accuracy: 69.39
Round  28, Train loss: 0.786, Test loss: 0.835, Test accuracy: 69.11
Round  29, Train loss: 0.730, Test loss: 0.808, Test accuracy: 70.27
Round  30, Train loss: 0.862, Test loss: 0.818, Test accuracy: 69.65
Round  31, Train loss: 0.661, Test loss: 0.795, Test accuracy: 70.37
Round  32, Train loss: 0.687, Test loss: 0.812, Test accuracy: 69.52
Round  33, Train loss: 0.639, Test loss: 0.783, Test accuracy: 71.13
Round  34, Train loss: 0.762, Test loss: 0.807, Test accuracy: 70.10
Round  35, Train loss: 0.745, Test loss: 0.814, Test accuracy: 69.81
Round  36, Train loss: 0.548, Test loss: 0.793, Test accuracy: 70.64
Round  37, Train loss: 0.649, Test loss: 0.799, Test accuracy: 70.68
Round  38, Train loss: 0.492, Test loss: 0.794, Test accuracy: 71.54
Round  39, Train loss: 0.721, Test loss: 0.819, Test accuracy: 70.39
Round  40, Train loss: 0.559, Test loss: 0.821, Test accuracy: 70.34
Round  41, Train loss: 0.532, Test loss: 0.806, Test accuracy: 70.68
Round  42, Train loss: 0.642, Test loss: 0.809, Test accuracy: 70.01
Round  43, Train loss: 0.582, Test loss: 0.803, Test accuracy: 70.72
Round  44, Train loss: 0.580, Test loss: 0.796, Test accuracy: 71.18
Round  45, Train loss: 0.534, Test loss: 0.797, Test accuracy: 71.15
Round  46, Train loss: 0.615, Test loss: 0.816, Test accuracy: 70.65
Round  47, Train loss: 0.504, Test loss: 0.818, Test accuracy: 70.33
Round  48, Train loss: 0.612, Test loss: 0.842, Test accuracy: 69.63
Round  49, Train loss: 0.451, Test loss: 0.824, Test accuracy: 70.21
Round  50, Train loss: 0.475, Test loss: 0.825, Test accuracy: 70.75
Round  51, Train loss: 0.501, Test loss: 0.842, Test accuracy: 70.39
Round  52, Train loss: 0.404, Test loss: 0.812, Test accuracy: 70.91
Round  53, Train loss: 0.504, Test loss: 0.821, Test accuracy: 70.46
Round  54, Train loss: 0.444, Test loss: 0.814, Test accuracy: 70.85
Round  55, Train loss: 0.410, Test loss: 0.811, Test accuracy: 70.99
Round  56, Train loss: 0.518, Test loss: 0.809, Test accuracy: 71.15
Round  57, Train loss: 0.485, Test loss: 0.821, Test accuracy: 70.94
Round  58, Train loss: 0.544, Test loss: 0.843, Test accuracy: 70.58
Round  59, Train loss: 0.456, Test loss: 0.854, Test accuracy: 69.83
Round  60, Train loss: 0.352, Test loss: 0.843, Test accuracy: 70.54
Round  61, Train loss: 0.384, Test loss: 0.848, Test accuracy: 70.43
Round  62, Train loss: 0.389, Test loss: 0.832, Test accuracy: 70.87
Round  63, Train loss: 0.423, Test loss: 0.846, Test accuracy: 70.16
Round  64, Train loss: 0.567, Test loss: 0.880, Test accuracy: 69.63
Round  65, Train loss: 0.405, Test loss: 0.860, Test accuracy: 70.73
Round  66, Train loss: 0.431, Test loss: 0.864, Test accuracy: 70.28
Round  67, Train loss: 0.327, Test loss: 0.853, Test accuracy: 70.78
Round  68, Train loss: 0.469, Test loss: 0.875, Test accuracy: 70.50
Round  69, Train loss: 0.341, Test loss: 0.891, Test accuracy: 70.55
Round  70, Train loss: 0.355, Test loss: 0.888, Test accuracy: 70.26
Round  71, Train loss: 0.471, Test loss: 0.898, Test accuracy: 70.09
Round  72, Train loss: 0.340, Test loss: 0.878, Test accuracy: 71.21
Round  73, Train loss: 0.443, Test loss: 0.880, Test accuracy: 70.28
Round  74, Train loss: 0.402, Test loss: 0.890, Test accuracy: 69.90
Round  75, Train loss: 0.409, Test loss: 0.900, Test accuracy: 69.21
Round  76, Train loss: 0.411, Test loss: 0.942, Test accuracy: 68.69
Round  77, Train loss: 0.382, Test loss: 0.899, Test accuracy: 69.73
Round  78, Train loss: 0.367, Test loss: 0.908, Test accuracy: 69.71
Round  79, Train loss: 0.313, Test loss: 0.902, Test accuracy: 69.59
Round  80, Train loss: 0.250, Test loss: 0.887, Test accuracy: 70.42
Round  81, Train loss: 0.230, Test loss: 0.892, Test accuracy: 70.64
Round  82, Train loss: 0.212, Test loss: 0.900, Test accuracy: 70.66
Round  83, Train loss: 0.200, Test loss: 0.884, Test accuracy: 70.63
Round  84, Train loss: 0.199, Test loss: 0.896, Test accuracy: 70.76
Round  85, Train loss: 0.187, Test loss: 0.902, Test accuracy: 71.08
Round  86, Train loss: 0.181, Test loss: 0.893, Test accuracy: 70.84
Round  87, Train loss: 0.184, Test loss: 0.892, Test accuracy: 71.23
Round  88, Train loss: 0.169, Test loss: 0.890, Test accuracy: 71.06
Round  89, Train loss: 0.167, Test loss: 0.914, Test accuracy: 70.56
Round  90, Train loss: 0.347, Test loss: 0.888, Test accuracy: 71.10
Round  91, Train loss: 0.325, Test loss: 0.901, Test accuracy: 70.94
Round  92, Train loss: 0.320, Test loss: 0.886, Test accuracy: 71.49
Round  93, Train loss: 0.309, Test loss: 0.888, Test accuracy: 70.93
Round  94, Train loss: 0.308, Test loss: 0.901, Test accuracy: 71.13
Round  95, Train loss: 0.295, Test loss: 0.892, Test accuracy: 71.28
Round  96, Train loss: 0.297, Test loss: 0.890, Test accuracy: 71.32
Round  97, Train loss: 0.294, Test loss: 0.905, Test accuracy: 71.22
Round  98, Train loss: 0.292, Test loss: 0.926, Test accuracy: 70.90
Round  99, Train loss: 0.286, Test loss: 0.912, Test accuracy: 71.01
Final Round, Train loss: 0.266, Test loss: 0.922, Test accuracy: 71.15
Average accuracy final 10 rounds: 71.13199999999999
4708.884652137756
[3.2607388496398926, 5.902718782424927, 8.566882133483887, 11.232213258743286, 13.916186094284058, 16.56785297393799, 19.225335359573364, 21.904471397399902, 24.579613208770752, 27.26421809196472, 29.908852338790894, 32.562745332717896, 35.20253252983093, 37.891101598739624, 40.5902202129364, 43.26864409446716, 45.892863750457764, 48.530267000198364, 51.16872024536133, 53.820207357406616, 56.51972198486328, 62.29339575767517, 68.03647136688232, 73.74001502990723, 79.42368364334106, 85.21939516067505, 90.96022963523865, 96.95623302459717, 102.6951756477356, 108.48856258392334, 114.23593378067017, 120.07764530181885, 125.73621940612793, 131.4572856426239, 137.31787610054016, 143.1100046634674, 148.9810140132904, 154.9150402545929, 160.588125705719, 166.42536306381226, 172.2168152332306, 178.11559534072876, 183.9343237876892, 189.88594365119934, 195.94496989250183, 201.75105166435242, 207.5274178981781, 213.26329112052917, 219.07289719581604, 225.03809189796448, 230.86226153373718, 236.65569043159485, 242.46773600578308, 248.2373867034912, 253.99364852905273, 259.904602766037, 265.8328535556793, 271.63549637794495, 277.7020833492279, 283.7865164279938, 289.8358373641968, 295.60633635520935, 301.3325219154358, 307.0483486652374, 312.8654143810272, 318.7268445491791, 324.4346215724945, 330.22566986083984, 336.06192111968994, 341.71859431266785, 347.5194664001465, 353.3439157009125, 358.9425759315491, 364.71986269950867, 370.5729486942291, 376.53232049942017, 382.3594708442688, 388.2810289859772, 394.2923254966736, 400.14583563804626, 406.06609749794006, 411.91803431510925, 417.6492590904236, 423.4031455516815, 429.2102847099304, 435.0371012687683, 440.82645750045776, 446.6813290119171, 452.56522393226624, 458.2867863178253, 464.4277091026306, 470.50339126586914, 476.3783235549927, 482.4032955169678, 488.3460521697998, 494.3415365219116, 500.44180846214294, 506.6335883140564, 512.7852160930634, 518.7344977855682, 522.8890919685364]
[22.04, 31.4, 41.81, 47.42, 52.8, 56.44, 59.3, 58.38, 59.74, 62.36, 61.42, 62.0, 63.0, 64.41, 64.66, 65.25, 66.15, 66.91, 66.79, 67.54, 67.13, 67.99, 68.23, 68.4, 69.15, 68.53, 69.58, 69.39, 69.11, 70.27, 69.65, 70.37, 69.52, 71.13, 70.1, 69.81, 70.64, 70.68, 71.54, 70.39, 70.34, 70.68, 70.01, 70.72, 71.18, 71.15, 70.65, 70.33, 69.63, 70.21, 70.75, 70.39, 70.91, 70.46, 70.85, 70.99, 71.15, 70.94, 70.58, 69.83, 70.54, 70.43, 70.87, 70.16, 69.63, 70.73, 70.28, 70.78, 70.5, 70.55, 70.26, 70.09, 71.21, 70.28, 69.9, 69.21, 68.69, 69.73, 69.71, 69.59, 70.42, 70.64, 70.66, 70.63, 70.76, 71.08, 70.84, 71.23, 71.06, 70.56, 71.1, 70.94, 71.49, 70.93, 71.13, 71.28, 71.32, 71.22, 70.9, 71.01, 71.15]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.662, Test loss: 2.296, Test accuracy: 17.53
Round   0, Global train loss: 1.662, Global test loss: 2.489, Global test accuracy: 12.00
Round   1, Train loss: 1.505, Test loss: 1.998, Test accuracy: 23.05
Round   1, Global train loss: 1.505, Global test loss: 2.386, Global test accuracy: 12.45
Round   2, Train loss: 1.373, Test loss: 1.826, Test accuracy: 27.44
Round   2, Global train loss: 1.373, Global test loss: 2.349, Global test accuracy: 10.48
Round   3, Train loss: 1.368, Test loss: 1.812, Test accuracy: 32.79
Round   3, Global train loss: 1.368, Global test loss: 2.467, Global test accuracy: 13.80
Round   4, Train loss: 1.351, Test loss: 1.555, Test accuracy: 39.46
Round   4, Global train loss: 1.351, Global test loss: 2.343, Global test accuracy: 14.12
Round   5, Train loss: 1.300, Test loss: 1.472, Test accuracy: 41.31
Round   5, Global train loss: 1.300, Global test loss: 2.350, Global test accuracy: 14.40
Round   6, Train loss: 1.378, Test loss: 1.524, Test accuracy: 41.25
Round   6, Global train loss: 1.378, Global test loss: 2.556, Global test accuracy: 13.24
Round   7, Train loss: 1.230, Test loss: 1.367, Test accuracy: 45.94
Round   7, Global train loss: 1.230, Global test loss: 2.294, Global test accuracy: 12.80
Round   8, Train loss: 1.430, Test loss: 1.270, Test accuracy: 50.21
Round   8, Global train loss: 1.430, Global test loss: 2.407, Global test accuracy: 13.83
Round   9, Train loss: 1.392, Test loss: 1.195, Test accuracy: 52.42
Round   9, Global train loss: 1.392, Global test loss: 2.296, Global test accuracy: 14.80
Round  10, Train loss: 1.175, Test loss: 1.200, Test accuracy: 52.83
Round  10, Global train loss: 1.175, Global test loss: 2.347, Global test accuracy: 12.66
Round  11, Train loss: 1.107, Test loss: 1.166, Test accuracy: 54.18
Round  11, Global train loss: 1.107, Global test loss: 2.304, Global test accuracy: 12.57
Round  12, Train loss: 1.029, Test loss: 1.139, Test accuracy: 55.19
Round  12, Global train loss: 1.029, Global test loss: 2.373, Global test accuracy: 12.98
Round  13, Train loss: 1.065, Test loss: 1.144, Test accuracy: 55.22
Round  13, Global train loss: 1.065, Global test loss: 2.345, Global test accuracy: 13.29
Round  14, Train loss: 1.080, Test loss: 1.140, Test accuracy: 55.44
Round  14, Global train loss: 1.080, Global test loss: 2.314, Global test accuracy: 12.69
Round  15, Train loss: 1.061, Test loss: 1.145, Test accuracy: 55.65
Round  15, Global train loss: 1.061, Global test loss: 2.401, Global test accuracy: 14.51
Round  16, Train loss: 1.206, Test loss: 1.138, Test accuracy: 56.12
Round  16, Global train loss: 1.206, Global test loss: 2.303, Global test accuracy: 12.84
Round  17, Train loss: 1.054, Test loss: 1.124, Test accuracy: 56.68
Round  17, Global train loss: 1.054, Global test loss: 2.320, Global test accuracy: 15.15
Round  18, Train loss: 1.106, Test loss: 1.119, Test accuracy: 56.95
Round  18, Global train loss: 1.106, Global test loss: 2.369, Global test accuracy: 14.28
Round  19, Train loss: 0.990, Test loss: 1.118, Test accuracy: 57.67
Round  19, Global train loss: 0.990, Global test loss: 2.437, Global test accuracy: 12.51
Round  20, Train loss: 1.027, Test loss: 1.118, Test accuracy: 57.95
Round  20, Global train loss: 1.027, Global test loss: 2.396, Global test accuracy: 13.62
Round  21, Train loss: 0.937, Test loss: 1.113, Test accuracy: 58.25
Round  21, Global train loss: 0.937, Global test loss: 2.308, Global test accuracy: 11.53
Round  22, Train loss: 0.870, Test loss: 1.099, Test accuracy: 58.90
Round  22, Global train loss: 0.870, Global test loss: 2.303, Global test accuracy: 12.96
Round  23, Train loss: 0.926, Test loss: 1.112, Test accuracy: 58.69
Round  23, Global train loss: 0.926, Global test loss: 2.280, Global test accuracy: 14.42
Round  24, Train loss: 0.918, Test loss: 1.102, Test accuracy: 59.14
Round  24, Global train loss: 0.918, Global test loss: 2.345, Global test accuracy: 12.32
Round  25, Train loss: 0.915, Test loss: 1.117, Test accuracy: 59.00
Round  25, Global train loss: 0.915, Global test loss: 2.314, Global test accuracy: 15.37
Round  26, Train loss: 0.845, Test loss: 1.158, Test accuracy: 57.82
Round  26, Global train loss: 0.845, Global test loss: 2.296, Global test accuracy: 14.86
Round  27, Train loss: 0.797, Test loss: 1.187, Test accuracy: 57.34
Round  27, Global train loss: 0.797, Global test loss: 2.289, Global test accuracy: 14.71
Round  28, Train loss: 0.726, Test loss: 1.202, Test accuracy: 57.23
Round  28, Global train loss: 0.726, Global test loss: 2.367, Global test accuracy: 12.18
Round  29, Train loss: 0.825, Test loss: 1.215, Test accuracy: 57.26
Round  29, Global train loss: 0.825, Global test loss: 2.293, Global test accuracy: 13.99
Round  30, Train loss: 0.686, Test loss: 1.224, Test accuracy: 57.38
Round  30, Global train loss: 0.686, Global test loss: 2.293, Global test accuracy: 15.55
Round  31, Train loss: 0.580, Test loss: 1.170, Test accuracy: 58.41
Round  31, Global train loss: 0.580, Global test loss: 2.312, Global test accuracy: 15.34
Round  32, Train loss: 1.026, Test loss: 1.181, Test accuracy: 58.35
Round  32, Global train loss: 1.026, Global test loss: 2.380, Global test accuracy: 12.33
Round  33, Train loss: 0.742, Test loss: 1.204, Test accuracy: 58.13
Round  33, Global train loss: 0.742, Global test loss: 2.419, Global test accuracy: 12.84
Round  34, Train loss: 0.656, Test loss: 1.201, Test accuracy: 58.42
Round  34, Global train loss: 0.656, Global test loss: 2.293, Global test accuracy: 14.79
Round  35, Train loss: 0.734, Test loss: 1.216, Test accuracy: 58.58
Round  35, Global train loss: 0.734, Global test loss: 2.371, Global test accuracy: 14.68
Round  36, Train loss: 0.568, Test loss: 1.254, Test accuracy: 58.33
Round  36, Global train loss: 0.568, Global test loss: 2.335, Global test accuracy: 15.30
Round  37, Train loss: 0.697, Test loss: 1.267, Test accuracy: 58.21
Round  37, Global train loss: 0.697, Global test loss: 2.308, Global test accuracy: 14.66
Round  38, Train loss: 0.727, Test loss: 1.277, Test accuracy: 58.63
Round  38, Global train loss: 0.727, Global test loss: 2.336, Global test accuracy: 15.73
Round  39, Train loss: 0.604, Test loss: 1.311, Test accuracy: 58.78
Round  39, Global train loss: 0.604, Global test loss: 2.311, Global test accuracy: 13.82
Round  40, Train loss: 0.522, Test loss: 1.345, Test accuracy: 58.28
Round  40, Global train loss: 0.522, Global test loss: 2.386, Global test accuracy: 12.15
Round  41, Train loss: 0.614, Test loss: 1.362, Test accuracy: 57.96
Round  41, Global train loss: 0.614, Global test loss: 2.309, Global test accuracy: 13.33
Round  42, Train loss: 0.798, Test loss: 1.360, Test accuracy: 57.53
Round  42, Global train loss: 0.798, Global test loss: 2.373, Global test accuracy: 14.44
Round  43, Train loss: 0.830, Test loss: 1.364, Test accuracy: 57.46
Round  43, Global train loss: 0.830, Global test loss: 2.308, Global test accuracy: 13.90
Round  44, Train loss: 0.727, Test loss: 1.383, Test accuracy: 57.24
Round  44, Global train loss: 0.727, Global test loss: 2.319, Global test accuracy: 13.65
Round  45, Train loss: 0.686, Test loss: 1.385, Test accuracy: 58.28
Round  45, Global train loss: 0.686, Global test loss: 2.403, Global test accuracy: 13.01
Round  46, Train loss: 0.588, Test loss: 1.395, Test accuracy: 57.58
Round  46, Global train loss: 0.588, Global test loss: 2.350, Global test accuracy: 15.05
Round  47, Train loss: 0.555, Test loss: 1.413, Test accuracy: 57.40
Round  47, Global train loss: 0.555, Global test loss: 2.351, Global test accuracy: 13.11
Round  48, Train loss: 0.403, Test loss: 1.459, Test accuracy: 57.00
Round  48, Global train loss: 0.403, Global test loss: 2.462, Global test accuracy: 13.85
Round  49, Train loss: 0.534, Test loss: 1.482, Test accuracy: 57.23
Round  49, Global train loss: 0.534, Global test loss: 2.338, Global test accuracy: 11.83
Round  50, Train loss: 0.439, Test loss: 1.496, Test accuracy: 57.33
Round  50, Global train loss: 0.439, Global test loss: 2.325, Global test accuracy: 14.86
Round  51, Train loss: 0.319, Test loss: 1.500, Test accuracy: 57.71
Round  51, Global train loss: 0.319, Global test loss: 2.365, Global test accuracy: 14.35
Round  52, Train loss: 0.398, Test loss: 1.531, Test accuracy: 57.15
Round  52, Global train loss: 0.398, Global test loss: 2.394, Global test accuracy: 13.16
Round  53, Train loss: 0.328, Test loss: 1.563, Test accuracy: 57.07
Round  53, Global train loss: 0.328, Global test loss: 2.378, Global test accuracy: 15.61
Round  54, Train loss: 0.358, Test loss: 1.563, Test accuracy: 57.27
Round  54, Global train loss: 0.358, Global test loss: 2.343, Global test accuracy: 14.71
Round  55, Train loss: 0.579, Test loss: 1.579, Test accuracy: 57.13
Round  55, Global train loss: 0.579, Global test loss: 2.417, Global test accuracy: 15.55
Round  56, Train loss: 0.463, Test loss: 1.632, Test accuracy: 56.80
Round  56, Global train loss: 0.463, Global test loss: 2.308, Global test accuracy: 13.66
Round  57, Train loss: 0.336, Test loss: 1.682, Test accuracy: 56.05
Round  57, Global train loss: 0.336, Global test loss: 2.392, Global test accuracy: 14.51
Round  58, Train loss: 0.279, Test loss: 1.683, Test accuracy: 56.30
Round  58, Global train loss: 0.279, Global test loss: 2.431, Global test accuracy: 13.14
Round  59, Train loss: 0.302, Test loss: 1.679, Test accuracy: 56.52
Round  59, Global train loss: 0.302, Global test loss: 2.530, Global test accuracy: 13.17
Round  60, Train loss: 0.509, Test loss: 1.695, Test accuracy: 56.62
Round  60, Global train loss: 0.509, Global test loss: 2.373, Global test accuracy: 15.23
Round  61, Train loss: 0.300, Test loss: 1.679, Test accuracy: 57.43
Round  61, Global train loss: 0.300, Global test loss: 2.496, Global test accuracy: 14.69
Round  62, Train loss: 0.252, Test loss: 1.750, Test accuracy: 56.24
Round  62, Global train loss: 0.252, Global test loss: 2.485, Global test accuracy: 13.19
Round  63, Train loss: 0.320, Test loss: 1.778, Test accuracy: 55.83
Round  63, Global train loss: 0.320, Global test loss: 2.347, Global test accuracy: 13.24
Round  64, Train loss: 0.519, Test loss: 1.851, Test accuracy: 55.72
Round  64, Global train loss: 0.519, Global test loss: 2.342, Global test accuracy: 12.45
Round  65, Train loss: 0.293, Test loss: 1.833, Test accuracy: 55.73
Round  65, Global train loss: 0.293, Global test loss: 2.324, Global test accuracy: 16.17
Round  66, Train loss: 0.414, Test loss: 1.798, Test accuracy: 56.33
Round  66, Global train loss: 0.414, Global test loss: 2.337, Global test accuracy: 14.34
Round  67, Train loss: 0.349, Test loss: 1.825, Test accuracy: 56.30
Round  67, Global train loss: 0.349, Global test loss: 2.367, Global test accuracy: 13.15
Round  68, Train loss: 0.429, Test loss: 1.813, Test accuracy: 56.91
Round  68, Global train loss: 0.429, Global test loss: 2.359, Global test accuracy: 14.34
Round  69, Train loss: 0.400, Test loss: 1.863, Test accuracy: 56.43
Round  69, Global train loss: 0.400, Global test loss: 2.356, Global test accuracy: 11.62
Round  70, Train loss: 0.385, Test loss: 1.885, Test accuracy: 55.67
Round  70, Global train loss: 0.385, Global test loss: 2.332, Global test accuracy: 13.61
Round  71, Train loss: 0.285, Test loss: 1.964, Test accuracy: 55.94
Round  71, Global train loss: 0.285, Global test loss: 2.361, Global test accuracy: 15.85
Round  72, Train loss: 0.150, Test loss: 1.992, Test accuracy: 55.69
Round  72, Global train loss: 0.150, Global test loss: 2.356, Global test accuracy: 14.29
Round  73, Train loss: 0.251, Test loss: 1.984, Test accuracy: 55.68
Round  73, Global train loss: 0.251, Global test loss: 2.449, Global test accuracy: 13.89
Round  74, Train loss: 0.313, Test loss: 2.009, Test accuracy: 55.85
Round  74, Global train loss: 0.313, Global test loss: 2.339, Global test accuracy: 13.09
Round  75, Train loss: 0.180, Test loss: 2.022, Test accuracy: 56.10
Round  75, Global train loss: 0.180, Global test loss: 2.374, Global test accuracy: 13.25
Round  76, Train loss: 0.274, Test loss: 1.992, Test accuracy: 56.70
Round  76, Global train loss: 0.274, Global test loss: 2.308, Global test accuracy: 13.03
Round  77, Train loss: 0.255, Test loss: 2.019, Test accuracy: 56.51
Round  77, Global train loss: 0.255, Global test loss: 2.327, Global test accuracy: 13.54
Round  78, Train loss: 0.295, Test loss: 2.051, Test accuracy: 56.11
Round  78, Global train loss: 0.295, Global test loss: 2.367, Global test accuracy: 12.76
Round  79, Train loss: 0.229, Test loss: 2.078, Test accuracy: 56.11
Round  79, Global train loss: 0.229, Global test loss: 2.373, Global test accuracy: 14.26
Round  80, Train loss: 0.296, Test loss: 2.052, Test accuracy: 56.44
Round  80, Global train loss: 0.296, Global test loss: 2.332, Global test accuracy: 13.63
Round  81, Train loss: 0.354, Test loss: 2.109, Test accuracy: 56.45
Round  81, Global train loss: 0.354, Global test loss: 2.395, Global test accuracy: 13.74
Round  82, Train loss: 0.161, Test loss: 2.148, Test accuracy: 56.26
Round  82, Global train loss: 0.161, Global test loss: 2.334, Global test accuracy: 15.14
Round  83, Train loss: 0.271, Test loss: 2.181, Test accuracy: 56.35
Round  83, Global train loss: 0.271, Global test loss: 2.349, Global test accuracy: 12.34
Round  84, Train loss: 0.269, Test loss: 2.188, Test accuracy: 56.30
Round  84, Global train loss: 0.269, Global test loss: 2.347, Global test accuracy: 12.60
Round  85, Train loss: 0.207, Test loss: 2.230, Test accuracy: 56.39
Round  85, Global train loss: 0.207, Global test loss: 2.334, Global test accuracy: 15.01
Round  86, Train loss: 0.166, Test loss: 2.203, Test accuracy: 56.34
Round  86, Global train loss: 0.166, Global test loss: 2.335, Global test accuracy: 13.45
Round  87, Train loss: 0.273, Test loss: 2.220, Test accuracy: 56.29
Round  87, Global train loss: 0.273, Global test loss: 2.369, Global test accuracy: 11.38
Round  88, Train loss: 0.203, Test loss: 2.216, Test accuracy: 56.55
Round  88, Global train loss: 0.203, Global test loss: 2.349, Global test accuracy: 14.57
Round  89, Train loss: 0.256, Test loss: 2.227, Test accuracy: 56.82
Round  89, Global train loss: 0.256, Global test loss: 2.380, Global test accuracy: 12.63
Round  90, Train loss: 0.191, Test loss: 2.303, Test accuracy: 56.89
Round  90, Global train loss: 0.191, Global test loss: 2.385, Global test accuracy: 14.22
Round  91, Train loss: 0.194, Test loss: 2.341, Test accuracy: 57.17
Round  91, Global train loss: 0.194, Global test loss: 2.369, Global test accuracy: 14.79
Round  92, Train loss: 0.182, Test loss: 2.398, Test accuracy: 56.65
Round  92, Global train loss: 0.182, Global test loss: 2.378, Global test accuracy: 13.50
Round  93, Train loss: 0.147, Test loss: 2.435, Test accuracy: 56.10
Round  93, Global train loss: 0.147, Global test loss: 2.369, Global test accuracy: 14.18
Round  94, Train loss: 0.212, Test loss: 2.374, Test accuracy: 56.55
Round  94, Global train loss: 0.212, Global test loss: 2.373, Global test accuracy: 14.84
Round  95, Train loss: 0.143, Test loss: 2.382, Test accuracy: 56.58
Round  95, Global train loss: 0.143, Global test loss: 2.339, Global test accuracy: 15.17
Round  96, Train loss: 0.131, Test loss: 2.412, Test accuracy: 56.58
Round  96, Global train loss: 0.131, Global test loss: 2.358, Global test accuracy: 15.51
Round  97, Train loss: 0.166, Test loss: 2.395, Test accuracy: 56.72
Round  97, Global train loss: 0.166, Global test loss: 2.296, Global test accuracy: 13.11
Round  98, Train loss: 0.161, Test loss: 2.442, Test accuracy: 57.22
Round  98, Global train loss: 0.161, Global test loss: 2.368, Global test accuracy: 13.26
Round  99, Train loss: 0.180, Test loss: 2.470, Test accuracy: 56.81
Round  99, Global train loss: 0.180, Global test loss: 2.323, Global test accuracy: 12.89
Final Round, Train loss: 0.140, Test loss: 2.464, Test accuracy: 57.16
Final Round, Global train loss: 0.140, Global test loss: 2.323, Global test accuracy: 12.89
Average accuracy final 10 rounds: 56.727 

Average global accuracy final 10 rounds: 14.147 

1470.291194677353
[1.5175104141235352, 3.0350208282470703, 4.130924463272095, 5.226828098297119, 6.323440790176392, 7.420053482055664, 8.492954015731812, 9.565854549407959, 10.664513349533081, 11.763172149658203, 12.85300898551941, 13.942845821380615, 14.988916397094727, 16.034986972808838, 17.090047597885132, 18.145108222961426, 19.218602657318115, 20.292097091674805, 21.361697673797607, 22.43129825592041, 23.454333782196045, 24.47736930847168, 25.529608488082886, 26.581847667694092, 27.620868921279907, 28.659890174865723, 29.73760461807251, 30.815319061279297, 31.88930892944336, 32.96329879760742, 34.01226258277893, 35.06122636795044, 36.126654386520386, 37.19208240509033, 38.301042318344116, 39.4100022315979, 40.52105093002319, 41.632099628448486, 42.70870542526245, 43.785311222076416, 44.84204626083374, 45.898781299591064, 46.93923282623291, 47.979684352874756, 49.074337005615234, 50.16898965835571, 51.235647678375244, 52.302305698394775, 53.40909743309021, 54.515889167785645, 55.604504346847534, 56.693119525909424, 57.73962378501892, 58.78612804412842, 59.870075702667236, 60.954023361206055, 62.01905584335327, 63.08408832550049, 64.14200329780579, 65.19991827011108, 66.2546489238739, 67.30937957763672, 68.38705253601074, 69.46472549438477, 70.51808643341064, 71.57144737243652, 72.65089654922485, 73.73034572601318, 74.82485556602478, 75.91936540603638, 77.02765440940857, 78.13594341278076, 79.22830724716187, 80.32067108154297, 81.42999505996704, 82.53931903839111, 83.62218260765076, 84.7050461769104, 85.7745316028595, 86.8440170288086, 87.91019892692566, 88.97638082504272, 90.04833745956421, 91.1202940940857, 92.14525485038757, 93.17021560668945, 94.23118686676025, 95.29215812683105, 96.34124493598938, 97.3903317451477, 98.4940288066864, 99.5977258682251, 100.64702796936035, 101.6963300704956, 102.7608380317688, 103.82534599304199, 104.88274097442627, 105.94013595581055, 107.01471829414368, 108.0893006324768, 109.13068866729736, 110.17207670211792, 111.26931834220886, 112.3665599822998, 113.4194438457489, 114.472327709198, 115.53121709823608, 116.59010648727417, 117.64549255371094, 118.7008786201477, 119.77628540992737, 120.85169219970703, 121.8905258178711, 122.92935943603516, 123.9930968284607, 125.05683422088623, 126.1362714767456, 127.21570873260498, 128.26141548156738, 129.30712223052979, 130.42197394371033, 131.53682565689087, 132.62630796432495, 133.71579027175903, 134.82589435577393, 135.93599843978882, 137.0325951576233, 138.12919187545776, 139.25598526000977, 140.38277864456177, 141.48801493644714, 142.59325122833252, 143.6737198829651, 144.75418853759766, 145.83797574043274, 146.92176294326782, 148.00593900680542, 149.09011507034302, 150.18543767929077, 151.28076028823853, 152.32079434394836, 153.3608283996582, 154.42713594436646, 155.4934434890747, 156.58894300460815, 157.6844425201416, 158.7526659965515, 159.82088947296143, 160.84772610664368, 161.87456274032593, 162.93798780441284, 164.00141286849976, 165.04027032852173, 166.0791277885437, 167.15625286102295, 168.2333779335022, 169.29973077774048, 170.36608362197876, 171.43505096435547, 172.50401830673218, 173.57011532783508, 174.636212348938, 175.7296051979065, 176.822998046875, 177.90504145622253, 178.98708486557007, 180.0554006099701, 181.12371635437012, 182.1776614189148, 183.23160648345947, 184.29298329353333, 185.35436010360718, 186.4423999786377, 187.5304398536682, 188.57653141021729, 189.62262296676636, 190.68665409088135, 191.75068521499634, 192.8643283843994, 193.9779715538025, 195.09831357002258, 196.21865558624268, 197.3071312904358, 198.3956069946289, 199.52539467811584, 200.65518236160278, 201.7644681930542, 202.87375402450562, 204.01185941696167, 205.14996480941772, 206.2508111000061, 207.35165739059448, 208.4486367702484, 209.54561614990234, 210.63753294944763, 211.72944974899292, 212.83413982391357, 213.93882989883423, 215.00225806236267, 216.0656862258911, 218.24434876441956, 220.423011302948]
[17.53, 17.53, 23.05, 23.05, 27.44, 27.44, 32.79, 32.79, 39.46, 39.46, 41.31, 41.31, 41.25, 41.25, 45.94, 45.94, 50.21, 50.21, 52.42, 52.42, 52.83, 52.83, 54.18, 54.18, 55.19, 55.19, 55.22, 55.22, 55.44, 55.44, 55.65, 55.65, 56.12, 56.12, 56.68, 56.68, 56.95, 56.95, 57.67, 57.67, 57.95, 57.95, 58.25, 58.25, 58.9, 58.9, 58.69, 58.69, 59.14, 59.14, 59.0, 59.0, 57.82, 57.82, 57.34, 57.34, 57.23, 57.23, 57.26, 57.26, 57.38, 57.38, 58.41, 58.41, 58.35, 58.35, 58.13, 58.13, 58.42, 58.42, 58.58, 58.58, 58.33, 58.33, 58.21, 58.21, 58.63, 58.63, 58.78, 58.78, 58.28, 58.28, 57.96, 57.96, 57.53, 57.53, 57.46, 57.46, 57.24, 57.24, 58.28, 58.28, 57.58, 57.58, 57.4, 57.4, 57.0, 57.0, 57.23, 57.23, 57.33, 57.33, 57.71, 57.71, 57.15, 57.15, 57.07, 57.07, 57.27, 57.27, 57.13, 57.13, 56.8, 56.8, 56.05, 56.05, 56.3, 56.3, 56.52, 56.52, 56.62, 56.62, 57.43, 57.43, 56.24, 56.24, 55.83, 55.83, 55.72, 55.72, 55.73, 55.73, 56.33, 56.33, 56.3, 56.3, 56.91, 56.91, 56.43, 56.43, 55.67, 55.67, 55.94, 55.94, 55.69, 55.69, 55.68, 55.68, 55.85, 55.85, 56.1, 56.1, 56.7, 56.7, 56.51, 56.51, 56.11, 56.11, 56.11, 56.11, 56.44, 56.44, 56.45, 56.45, 56.26, 56.26, 56.35, 56.35, 56.3, 56.3, 56.39, 56.39, 56.34, 56.34, 56.29, 56.29, 56.55, 56.55, 56.82, 56.82, 56.89, 56.89, 57.17, 57.17, 56.65, 56.65, 56.1, 56.1, 56.55, 56.55, 56.58, 56.58, 56.58, 56.58, 56.72, 56.72, 57.22, 57.22, 56.81, 56.81, 57.16, 57.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.680, Test loss: 2.169, Test accuracy: 22.35
Round   0, Global train loss: 1.680, Global test loss: 2.379, Global test accuracy: 16.97
Round   1, Train loss: 1.556, Test loss: 2.010, Test accuracy: 26.28
Round   1, Global train loss: 1.556, Global test loss: 2.395, Global test accuracy: 16.88
Round   2, Train loss: 1.588, Test loss: 1.891, Test accuracy: 30.49
Round   2, Global train loss: 1.588, Global test loss: 2.369, Global test accuracy: 16.87
Round   3, Train loss: 1.507, Test loss: 1.850, Test accuracy: 31.51
Round   3, Global train loss: 1.507, Global test loss: 2.444, Global test accuracy: 14.32
Round   4, Train loss: 1.450, Test loss: 1.586, Test accuracy: 38.38
Round   4, Global train loss: 1.450, Global test loss: 2.331, Global test accuracy: 13.37
Round   5, Train loss: 1.315, Test loss: 1.508, Test accuracy: 41.84
Round   5, Global train loss: 1.315, Global test loss: 2.350, Global test accuracy: 14.70
Round   6, Train loss: 1.339, Test loss: 1.497, Test accuracy: 42.34
Round   6, Global train loss: 1.339, Global test loss: 2.406, Global test accuracy: 16.18
Round   7, Train loss: 1.311, Test loss: 1.416, Test accuracy: 44.95
Round   7, Global train loss: 1.311, Global test loss: 2.390, Global test accuracy: 14.52
Round   8, Train loss: 1.312, Test loss: 1.294, Test accuracy: 49.82
Round   8, Global train loss: 1.312, Global test loss: 2.402, Global test accuracy: 18.74
Round   9, Train loss: 1.346, Test loss: 1.184, Test accuracy: 53.92
Round   9, Global train loss: 1.346, Global test loss: 2.453, Global test accuracy: 15.19
Round  10, Train loss: 1.350, Test loss: 1.172, Test accuracy: 54.29
Round  10, Global train loss: 1.350, Global test loss: 2.307, Global test accuracy: 17.57
Round  11, Train loss: 1.301, Test loss: 1.160, Test accuracy: 54.49
Round  11, Global train loss: 1.301, Global test loss: 2.440, Global test accuracy: 19.00
Round  12, Train loss: 1.324, Test loss: 1.142, Test accuracy: 55.54
Round  12, Global train loss: 1.324, Global test loss: 2.413, Global test accuracy: 15.77
Round  13, Train loss: 1.294, Test loss: 1.133, Test accuracy: 55.83
Round  13, Global train loss: 1.294, Global test loss: 2.342, Global test accuracy: 13.81
Round  14, Train loss: 1.322, Test loss: 1.130, Test accuracy: 56.43
Round  14, Global train loss: 1.322, Global test loss: 2.364, Global test accuracy: 14.28
Round  15, Train loss: 1.379, Test loss: 1.127, Test accuracy: 56.91
Round  15, Global train loss: 1.379, Global test loss: 2.527, Global test accuracy: 12.42
Round  16, Train loss: 1.300, Test loss: 1.126, Test accuracy: 56.79
Round  16, Global train loss: 1.300, Global test loss: 2.395, Global test accuracy: 14.39
Round  17, Train loss: 1.238, Test loss: 1.110, Test accuracy: 57.86
Round  17, Global train loss: 1.238, Global test loss: 2.413, Global test accuracy: 17.95
Round  18, Train loss: 1.128, Test loss: 1.094, Test accuracy: 58.39
Round  18, Global train loss: 1.128, Global test loss: 2.385, Global test accuracy: 18.38
Round  19, Train loss: 1.280, Test loss: 1.102, Test accuracy: 58.56
Round  19, Global train loss: 1.280, Global test loss: 2.541, Global test accuracy: 14.93
Round  20, Train loss: 1.306, Test loss: 1.091, Test accuracy: 58.85
Round  20, Global train loss: 1.306, Global test loss: 2.420, Global test accuracy: 16.16
Round  21, Train loss: 1.249, Test loss: 1.081, Test accuracy: 59.10
Round  21, Global train loss: 1.249, Global test loss: 2.396, Global test accuracy: 17.43
Round  22, Train loss: 1.226, Test loss: 1.063, Test accuracy: 60.11
Round  22, Global train loss: 1.226, Global test loss: 2.300, Global test accuracy: 17.53
Round  23, Train loss: 1.238, Test loss: 1.065, Test accuracy: 60.48
Round  23, Global train loss: 1.238, Global test loss: 2.455, Global test accuracy: 19.78
Round  24, Train loss: 1.125, Test loss: 1.087, Test accuracy: 60.04
Round  24, Global train loss: 1.125, Global test loss: 2.336, Global test accuracy: 18.55
Round  25, Train loss: 1.143, Test loss: 1.075, Test accuracy: 60.58
Round  25, Global train loss: 1.143, Global test loss: 2.497, Global test accuracy: 16.93
Round  26, Train loss: 1.225, Test loss: 1.087, Test accuracy: 59.87
Round  26, Global train loss: 1.225, Global test loss: 2.588, Global test accuracy: 19.19
Round  27, Train loss: 1.189, Test loss: 1.081, Test accuracy: 60.10
Round  27, Global train loss: 1.189, Global test loss: 2.650, Global test accuracy: 15.29
Round  28, Train loss: 1.179, Test loss: 1.093, Test accuracy: 59.29
Round  28, Global train loss: 1.179, Global test loss: 2.365, Global test accuracy: 19.41
Round  29, Train loss: 1.029, Test loss: 1.099, Test accuracy: 59.11
Round  29, Global train loss: 1.029, Global test loss: 2.671, Global test accuracy: 15.68
Round  30, Train loss: 1.081, Test loss: 1.088, Test accuracy: 60.31
Round  30, Global train loss: 1.081, Global test loss: 2.515, Global test accuracy: 17.78
Round  31, Train loss: 1.140, Test loss: 1.088, Test accuracy: 59.91
Round  31, Global train loss: 1.140, Global test loss: 2.763, Global test accuracy: 14.88
Round  32, Train loss: 1.176, Test loss: 1.083, Test accuracy: 60.29
Round  32, Global train loss: 1.176, Global test loss: 2.307, Global test accuracy: 16.33
Round  33, Train loss: 1.019, Test loss: 1.080, Test accuracy: 60.43
Round  33, Global train loss: 1.019, Global test loss: 2.442, Global test accuracy: 16.79
Round  34, Train loss: 1.048, Test loss: 1.074, Test accuracy: 60.86
Round  34, Global train loss: 1.048, Global test loss: 2.467, Global test accuracy: 16.18
Round  35, Train loss: 1.042, Test loss: 1.069, Test accuracy: 61.04
Round  35, Global train loss: 1.042, Global test loss: 2.646, Global test accuracy: 15.67
Round  36, Train loss: 1.042, Test loss: 1.063, Test accuracy: 61.02
Round  36, Global train loss: 1.042, Global test loss: 2.835, Global test accuracy: 19.14
Round  37, Train loss: 1.033, Test loss: 1.059, Test accuracy: 61.65
Round  37, Global train loss: 1.033, Global test loss: 2.592, Global test accuracy: 18.59
Round  38, Train loss: 1.026, Test loss: 1.068, Test accuracy: 61.30
Round  38, Global train loss: 1.026, Global test loss: 2.545, Global test accuracy: 17.94
Round  39, Train loss: 0.942, Test loss: 1.066, Test accuracy: 61.40
Round  39, Global train loss: 0.942, Global test loss: 2.619, Global test accuracy: 15.48
Round  40, Train loss: 1.057, Test loss: 1.068, Test accuracy: 61.33
Round  40, Global train loss: 1.057, Global test loss: 2.708, Global test accuracy: 18.20
Round  41, Train loss: 1.021, Test loss: 1.079, Test accuracy: 61.25
Round  41, Global train loss: 1.021, Global test loss: 2.674, Global test accuracy: 16.74
Round  42, Train loss: 0.939, Test loss: 1.091, Test accuracy: 61.16
Round  42, Global train loss: 0.939, Global test loss: 2.627, Global test accuracy: 14.37
Round  43, Train loss: 0.962, Test loss: 1.100, Test accuracy: 61.17
Round  43, Global train loss: 0.962, Global test loss: 2.534, Global test accuracy: 17.12
Round  44, Train loss: 0.871, Test loss: 1.098, Test accuracy: 60.94
Round  44, Global train loss: 0.871, Global test loss: 2.479, Global test accuracy: 18.37
Round  45, Train loss: 0.729, Test loss: 1.092, Test accuracy: 61.59
Round  45, Global train loss: 0.729, Global test loss: 2.823, Global test accuracy: 17.29
Round  46, Train loss: 0.786, Test loss: 1.108, Test accuracy: 60.50
Round  46, Global train loss: 0.786, Global test loss: 2.632, Global test accuracy: 16.61
Round  47, Train loss: 1.049, Test loss: 1.124, Test accuracy: 60.54
Round  47, Global train loss: 1.049, Global test loss: 2.674, Global test accuracy: 15.79
Round  48, Train loss: 1.009, Test loss: 1.097, Test accuracy: 60.70
Round  48, Global train loss: 1.009, Global test loss: 3.012, Global test accuracy: 16.79
Round  49, Train loss: 0.942, Test loss: 1.080, Test accuracy: 61.35
Round  49, Global train loss: 0.942, Global test loss: 2.591, Global test accuracy: 17.41
Round  50, Train loss: 0.915, Test loss: 1.100, Test accuracy: 61.16
Round  50, Global train loss: 0.915, Global test loss: 2.692, Global test accuracy: 16.60
Round  51, Train loss: 0.904, Test loss: 1.082, Test accuracy: 62.01
Round  51, Global train loss: 0.904, Global test loss: 2.699, Global test accuracy: 15.27
Round  52, Train loss: 0.797, Test loss: 1.098, Test accuracy: 61.44
Round  52, Global train loss: 0.797, Global test loss: 2.810, Global test accuracy: 15.61
Round  53, Train loss: 1.025, Test loss: 1.097, Test accuracy: 61.27
Round  53, Global train loss: 1.025, Global test loss: 2.977, Global test accuracy: 13.47
Round  54, Train loss: 0.962, Test loss: 1.083, Test accuracy: 61.94
Round  54, Global train loss: 0.962, Global test loss: 2.724, Global test accuracy: 14.40
Round  55, Train loss: 0.846, Test loss: 1.087, Test accuracy: 61.35
Round  55, Global train loss: 0.846, Global test loss: 2.854, Global test accuracy: 17.63
Round  56, Train loss: 0.883, Test loss: 1.129, Test accuracy: 60.40
Round  56, Global train loss: 0.883, Global test loss: 2.772, Global test accuracy: 17.19
Round  57, Train loss: 0.993, Test loss: 1.132, Test accuracy: 61.00
Round  57, Global train loss: 0.993, Global test loss: 2.615, Global test accuracy: 16.96
Round  58, Train loss: 0.823, Test loss: 1.128, Test accuracy: 60.88
Round  58, Global train loss: 0.823, Global test loss: 2.629, Global test accuracy: 17.70
Round  59, Train loss: 0.933, Test loss: 1.156, Test accuracy: 60.73
Round  59, Global train loss: 0.933, Global test loss: 2.997, Global test accuracy: 16.73
Round  60, Train loss: 0.833, Test loss: 1.173, Test accuracy: 60.29
Round  60, Global train loss: 0.833, Global test loss: 2.856, Global test accuracy: 17.48
Round  61, Train loss: 0.914, Test loss: 1.151, Test accuracy: 60.93
Round  61, Global train loss: 0.914, Global test loss: 2.807, Global test accuracy: 15.87
Round  62, Train loss: 0.897, Test loss: 1.168, Test accuracy: 60.74
Round  62, Global train loss: 0.897, Global test loss: 2.782, Global test accuracy: 16.26
Round  63, Train loss: 0.899, Test loss: 1.174, Test accuracy: 60.49
Round  63, Global train loss: 0.899, Global test loss: 2.807, Global test accuracy: 18.59
Round  64, Train loss: 0.938, Test loss: 1.182, Test accuracy: 60.70
Round  64, Global train loss: 0.938, Global test loss: 2.787, Global test accuracy: 18.87
Round  65, Train loss: 0.668, Test loss: 1.148, Test accuracy: 61.47
Round  65, Global train loss: 0.668, Global test loss: 3.000, Global test accuracy: 17.80
Round  66, Train loss: 0.769, Test loss: 1.180, Test accuracy: 60.64
Round  66, Global train loss: 0.769, Global test loss: 2.915, Global test accuracy: 16.95
Round  67, Train loss: 0.851, Test loss: 1.182, Test accuracy: 60.33
Round  67, Global train loss: 0.851, Global test loss: 2.779, Global test accuracy: 17.21
Round  68, Train loss: 0.784, Test loss: 1.186, Test accuracy: 60.44
Round  68, Global train loss: 0.784, Global test loss: 3.032, Global test accuracy: 14.96
Round  69, Train loss: 0.726, Test loss: 1.187, Test accuracy: 60.16
Round  69, Global train loss: 0.726, Global test loss: 2.818, Global test accuracy: 17.68
Round  70, Train loss: 0.904, Test loss: 1.219, Test accuracy: 59.63
Round  70, Global train loss: 0.904, Global test loss: 2.867, Global test accuracy: 17.17
Round  71, Train loss: 0.828, Test loss: 1.211, Test accuracy: 60.45
Round  71, Global train loss: 0.828, Global test loss: 2.922, Global test accuracy: 17.16
Round  72, Train loss: 0.817, Test loss: 1.200, Test accuracy: 60.69
Round  72, Global train loss: 0.817, Global test loss: 2.771, Global test accuracy: 17.07
Round  73, Train loss: 0.617, Test loss: 1.201, Test accuracy: 60.82
Round  73, Global train loss: 0.617, Global test loss: 3.226, Global test accuracy: 15.38
Round  74, Train loss: 0.744, Test loss: 1.204, Test accuracy: 60.53
Round  74, Global train loss: 0.744, Global test loss: 2.894, Global test accuracy: 17.33
Round  75, Train loss: 0.840, Test loss: 1.226, Test accuracy: 60.27
Round  75, Global train loss: 0.840, Global test loss: 2.985, Global test accuracy: 16.11
Round  76, Train loss: 0.894, Test loss: 1.233, Test accuracy: 60.49
Round  76, Global train loss: 0.894, Global test loss: 2.938, Global test accuracy: 17.44
Round  77, Train loss: 0.764, Test loss: 1.255, Test accuracy: 60.34
Round  77, Global train loss: 0.764, Global test loss: 2.811, Global test accuracy: 17.25
Round  78, Train loss: 0.749, Test loss: 1.238, Test accuracy: 60.73
Round  78, Global train loss: 0.749, Global test loss: 2.843, Global test accuracy: 18.28
Round  79, Train loss: 0.678, Test loss: 1.259, Test accuracy: 59.95
Round  79, Global train loss: 0.678, Global test loss: 3.011, Global test accuracy: 18.17
Round  80, Train loss: 0.622, Test loss: 1.240, Test accuracy: 59.97
Round  80, Global train loss: 0.622, Global test loss: 3.470, Global test accuracy: 18.11
Round  81, Train loss: 0.635, Test loss: 1.244, Test accuracy: 60.29
Round  81, Global train loss: 0.635, Global test loss: 3.061, Global test accuracy: 16.93
Round  82, Train loss: 0.611, Test loss: 1.243, Test accuracy: 60.00
Round  82, Global train loss: 0.611, Global test loss: 3.330, Global test accuracy: 13.82
Round  83, Train loss: 0.785, Test loss: 1.230, Test accuracy: 60.25
Round  83, Global train loss: 0.785, Global test loss: 2.992, Global test accuracy: 17.06
Round  84, Train loss: 0.696, Test loss: 1.232, Test accuracy: 60.70
Round  84, Global train loss: 0.696, Global test loss: 3.277, Global test accuracy: 17.85
Round  85, Train loss: 0.678, Test loss: 1.278, Test accuracy: 59.85
Round  85, Global train loss: 0.678, Global test loss: 3.272, Global test accuracy: 15.65
Round  86, Train loss: 0.629, Test loss: 1.266, Test accuracy: 60.57
Round  86, Global train loss: 0.629, Global test loss: 3.275, Global test accuracy: 16.79
Round  87, Train loss: 0.655, Test loss: 1.290, Test accuracy: 60.59
Round  87, Global train loss: 0.655, Global test loss: 3.089, Global test accuracy: 15.60
Round  88, Train loss: 0.766, Test loss: 1.304, Test accuracy: 60.35
Round  88, Global train loss: 0.766, Global test loss: 3.146, Global test accuracy: 16.89
Round  89, Train loss: 0.666, Test loss: 1.305, Test accuracy: 60.77
Round  89, Global train loss: 0.666, Global test loss: 3.147, Global test accuracy: 17.12
Round  90, Train loss: 0.537, Test loss: 1.275, Test accuracy: 60.87
Round  90, Global train loss: 0.537, Global test loss: 3.244, Global test accuracy: 14.56
Round  91, Train loss: 0.638, Test loss: 1.287, Test accuracy: 60.83
Round  91, Global train loss: 0.638, Global test loss: 3.219, Global test accuracy: 17.38
Round  92, Train loss: 0.716, Test loss: 1.271, Test accuracy: 61.21
Round  92, Global train loss: 0.716, Global test loss: 3.057, Global test accuracy: 16.24
Round  93, Train loss: 0.789, Test loss: 1.294, Test accuracy: 61.07
Round  93, Global train loss: 0.789, Global test loss: 3.372, Global test accuracy: 17.67
Round  94, Train loss: 0.628, Test loss: 1.293, Test accuracy: 60.70
Round  94, Global train loss: 0.628, Global test loss: 3.029, Global test accuracy: 17.11
Round  95, Train loss: 0.606, Test loss: 1.317, Test accuracy: 60.67
Round  95, Global train loss: 0.606, Global test loss: 3.290, Global test accuracy: 16.69
Round  96, Train loss: 0.539, Test loss: 1.301, Test accuracy: 60.96
Round  96, Global train loss: 0.539, Global test loss: 3.334, Global test accuracy: 17.96
Round  97, Train loss: 0.657, Test loss: 1.304, Test accuracy: 60.87
Round  97, Global train loss: 0.657, Global test loss: 3.068, Global test accuracy: 16.37
Round  98, Train loss: 0.722, Test loss: 1.320, Test accuracy: 60.66
Round  98, Global train loss: 0.722, Global test loss: 3.032, Global test accuracy: 16.99
Round  99, Train loss: 0.552, Test loss: 1.333, Test accuracy: 60.59
Round  99, Global train loss: 0.552, Global test loss: 3.537, Global test accuracy: 16.64
Final Round, Train loss: 0.514, Test loss: 1.473, Test accuracy: 60.71
Final Round, Global train loss: 0.514, Global test loss: 3.537, Global test accuracy: 16.64
Average accuracy final 10 rounds: 60.843 

Average global accuracy final 10 rounds: 16.761 

1528.7057044506073
[1.5128047466278076, 3.0256094932556152, 4.323688983917236, 5.621768474578857, 6.903549909591675, 8.185331344604492, 9.444916248321533, 10.704501152038574, 11.840152978897095, 12.975804805755615, 14.108607053756714, 15.241409301757812, 16.38848567008972, 17.53556203842163, 18.649833917617798, 19.764105796813965, 20.867966651916504, 21.971827507019043, 23.09023690223694, 24.208646297454834, 25.36630153656006, 26.523956775665283, 27.655776023864746, 28.78759527206421, 29.91249108314514, 31.037386894226074, 32.137080907821655, 33.236774921417236, 34.344245195388794, 35.45171546936035, 36.564314126968384, 37.676912784576416, 38.77358293533325, 39.87025308609009, 41.011861085891724, 42.15346908569336, 43.289695739746094, 44.42592239379883, 45.52138352394104, 46.61684465408325, 47.723591804504395, 48.83033895492554, 49.97058320045471, 51.11082744598389, 52.22137665748596, 53.33192586898804, 54.497697830200195, 55.66346979141235, 56.79082465171814, 57.918179512023926, 59.094101428985596, 60.270023345947266, 61.42581820487976, 62.581613063812256, 63.678889751434326, 64.7761664390564, 65.91967725753784, 67.06318807601929, 68.20270991325378, 69.34223175048828, 70.49038529396057, 71.63853883743286, 72.8193907737732, 74.00024271011353, 75.1389753818512, 76.27770805358887, 77.399986743927, 78.52226543426514, 79.61781525611877, 80.71336507797241, 81.80418181419373, 82.89499855041504, 84.02653503417969, 85.15807151794434, 86.27138257026672, 87.38469362258911, 88.51482772827148, 89.64496183395386, 90.76518273353577, 91.88540363311768, 93.01293206214905, 94.14046049118042, 95.27913689613342, 96.41781330108643, 97.54186630249023, 98.66591930389404, 99.77562212944031, 100.88532495498657, 102.01352000236511, 103.14171504974365, 104.26145362854004, 105.38119220733643, 106.47602987289429, 107.57086753845215, 108.68245363235474, 109.79403972625732, 110.90313196182251, 112.0122241973877, 113.09913086891174, 114.18603754043579, 115.27426767349243, 116.36249780654907, 117.46960091590881, 118.57670402526855, 119.67283177375793, 120.76895952224731, 121.89598751068115, 123.02301549911499, 124.14700365066528, 125.27099180221558, 126.38825631141663, 127.50552082061768, 128.6088728904724, 129.71222496032715, 130.83898949623108, 131.965754032135, 133.0917191505432, 134.21768426895142, 135.33079481124878, 136.44390535354614, 137.54676151275635, 138.64961767196655, 139.77976179122925, 140.90990591049194, 142.0299050807953, 143.14990425109863, 144.23563265800476, 145.3213610649109, 146.4462103843689, 147.5710597038269, 148.70719289779663, 149.84332609176636, 150.9449110031128, 152.04649591445923, 153.20124125480652, 154.3559865951538, 155.49735021591187, 156.63871383666992, 157.81692004203796, 158.995126247406, 160.1154761314392, 161.2358260154724, 162.35916566848755, 163.48250532150269, 164.61323261260986, 165.74395990371704, 166.85876607894897, 167.9735722541809, 169.10947680473328, 170.24538135528564, 171.35281682014465, 172.46025228500366, 173.58964085578918, 174.7190294265747, 175.8599455356598, 177.00086164474487, 178.11456561088562, 179.22826957702637, 180.3401701450348, 181.4520707130432, 182.577299118042, 183.70252752304077, 184.8184986114502, 185.93446969985962, 187.04992198944092, 188.16537427902222, 189.2718894481659, 190.37840461730957, 191.48165655136108, 192.5849084854126, 193.702871799469, 194.8208351135254, 195.93523168563843, 197.04962825775146, 198.16300177574158, 199.2763752937317, 200.38071274757385, 201.48505020141602, 202.59857821464539, 203.71210622787476, 204.8279209136963, 205.94373559951782, 207.04262018203735, 208.14150476455688, 209.23259139060974, 210.3236780166626, 211.44612836837769, 212.56857872009277, 213.6809151172638, 214.79325151443481, 215.92607140541077, 217.05889129638672, 218.20121049880981, 219.3435297012329, 220.49925303459167, 221.65497636795044, 222.8039710521698, 223.95296573638916, 225.07893824577332, 226.20491075515747, 228.4134919643402, 230.62207317352295]
[22.35, 22.35, 26.28, 26.28, 30.49, 30.49, 31.51, 31.51, 38.38, 38.38, 41.84, 41.84, 42.34, 42.34, 44.95, 44.95, 49.82, 49.82, 53.92, 53.92, 54.29, 54.29, 54.49, 54.49, 55.54, 55.54, 55.83, 55.83, 56.43, 56.43, 56.91, 56.91, 56.79, 56.79, 57.86, 57.86, 58.39, 58.39, 58.56, 58.56, 58.85, 58.85, 59.1, 59.1, 60.11, 60.11, 60.48, 60.48, 60.04, 60.04, 60.58, 60.58, 59.87, 59.87, 60.1, 60.1, 59.29, 59.29, 59.11, 59.11, 60.31, 60.31, 59.91, 59.91, 60.29, 60.29, 60.43, 60.43, 60.86, 60.86, 61.04, 61.04, 61.02, 61.02, 61.65, 61.65, 61.3, 61.3, 61.4, 61.4, 61.33, 61.33, 61.25, 61.25, 61.16, 61.16, 61.17, 61.17, 60.94, 60.94, 61.59, 61.59, 60.5, 60.5, 60.54, 60.54, 60.7, 60.7, 61.35, 61.35, 61.16, 61.16, 62.01, 62.01, 61.44, 61.44, 61.27, 61.27, 61.94, 61.94, 61.35, 61.35, 60.4, 60.4, 61.0, 61.0, 60.88, 60.88, 60.73, 60.73, 60.29, 60.29, 60.93, 60.93, 60.74, 60.74, 60.49, 60.49, 60.7, 60.7, 61.47, 61.47, 60.64, 60.64, 60.33, 60.33, 60.44, 60.44, 60.16, 60.16, 59.63, 59.63, 60.45, 60.45, 60.69, 60.69, 60.82, 60.82, 60.53, 60.53, 60.27, 60.27, 60.49, 60.49, 60.34, 60.34, 60.73, 60.73, 59.95, 59.95, 59.97, 59.97, 60.29, 60.29, 60.0, 60.0, 60.25, 60.25, 60.7, 60.7, 59.85, 59.85, 60.57, 60.57, 60.59, 60.59, 60.35, 60.35, 60.77, 60.77, 60.87, 60.87, 60.83, 60.83, 61.21, 61.21, 61.07, 61.07, 60.7, 60.7, 60.67, 60.67, 60.96, 60.96, 60.87, 60.87, 60.66, 60.66, 60.59, 60.59, 60.71, 60.71]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.701, Test loss: 2.091, Test accuracy: 20.43
Round   0, Global train loss: 1.701, Global test loss: 2.315, Global test accuracy: 14.02
Round   1, Train loss: 1.538, Test loss: 1.924, Test accuracy: 24.85
Round   1, Global train loss: 1.538, Global test loss: 2.297, Global test accuracy: 16.11
Round   2, Train loss: 1.515, Test loss: 1.896, Test accuracy: 27.48
Round   2, Global train loss: 1.515, Global test loss: 2.407, Global test accuracy: 14.49
Round   3, Train loss: 1.470, Test loss: 1.866, Test accuracy: 31.11
Round   3, Global train loss: 1.470, Global test loss: 2.525, Global test accuracy: 16.20
Round   4, Train loss: 1.452, Test loss: 1.549, Test accuracy: 38.12
Round   4, Global train loss: 1.452, Global test loss: 2.330, Global test accuracy: 15.22
Round   5, Train loss: 1.466, Test loss: 1.552, Test accuracy: 38.82
Round   5, Global train loss: 1.466, Global test loss: 2.416, Global test accuracy: 10.65
Round   6, Train loss: 1.369, Test loss: 1.496, Test accuracy: 41.07
Round   6, Global train loss: 1.369, Global test loss: 2.328, Global test accuracy: 16.78
Round   7, Train loss: 1.343, Test loss: 1.397, Test accuracy: 45.74
Round   7, Global train loss: 1.343, Global test loss: 2.298, Global test accuracy: 17.69
Round   8, Train loss: 1.394, Test loss: 1.313, Test accuracy: 47.66
Round   8, Global train loss: 1.394, Global test loss: 2.381, Global test accuracy: 17.18
Round   9, Train loss: 1.385, Test loss: 1.237, Test accuracy: 50.08
Round   9, Global train loss: 1.385, Global test loss: 2.311, Global test accuracy: 15.17
Round  10, Train loss: 1.415, Test loss: 1.230, Test accuracy: 50.61
Round  10, Global train loss: 1.415, Global test loss: 2.321, Global test accuracy: 16.11
Round  11, Train loss: 1.337, Test loss: 1.217, Test accuracy: 51.31
Round  11, Global train loss: 1.337, Global test loss: 2.315, Global test accuracy: 15.70
Round  12, Train loss: 1.309, Test loss: 1.212, Test accuracy: 51.62
Round  12, Global train loss: 1.309, Global test loss: 2.341, Global test accuracy: 18.08
Round  13, Train loss: 1.245, Test loss: 1.184, Test accuracy: 52.69
Round  13, Global train loss: 1.245, Global test loss: 2.389, Global test accuracy: 17.78
Round  14, Train loss: 1.253, Test loss: 1.163, Test accuracy: 53.37
Round  14, Global train loss: 1.253, Global test loss: 2.367, Global test accuracy: 15.40
Round  15, Train loss: 1.310, Test loss: 1.150, Test accuracy: 54.86
Round  15, Global train loss: 1.310, Global test loss: 2.322, Global test accuracy: 18.01
Round  16, Train loss: 1.411, Test loss: 1.152, Test accuracy: 54.78
Round  16, Global train loss: 1.411, Global test loss: 2.235, Global test accuracy: 18.19
Round  17, Train loss: 1.235, Test loss: 1.144, Test accuracy: 55.38
Round  17, Global train loss: 1.235, Global test loss: 2.370, Global test accuracy: 17.27
Round  18, Train loss: 1.343, Test loss: 1.143, Test accuracy: 55.74
Round  18, Global train loss: 1.343, Global test loss: 2.295, Global test accuracy: 17.57
Round  19, Train loss: 1.211, Test loss: 1.138, Test accuracy: 56.16
Round  19, Global train loss: 1.211, Global test loss: 2.480, Global test accuracy: 17.52
Round  20, Train loss: 1.193, Test loss: 1.126, Test accuracy: 56.68
Round  20, Global train loss: 1.193, Global test loss: 2.369, Global test accuracy: 17.64
Round  21, Train loss: 1.251, Test loss: 1.135, Test accuracy: 56.56
Round  21, Global train loss: 1.251, Global test loss: 2.325, Global test accuracy: 16.90
Round  22, Train loss: 1.263, Test loss: 1.113, Test accuracy: 57.20
Round  22, Global train loss: 1.263, Global test loss: 2.352, Global test accuracy: 18.25
Round  23, Train loss: 1.262, Test loss: 1.128, Test accuracy: 56.83
Round  23, Global train loss: 1.262, Global test loss: 2.438, Global test accuracy: 14.84
Round  24, Train loss: 1.197, Test loss: 1.115, Test accuracy: 57.76
Round  24, Global train loss: 1.197, Global test loss: 2.543, Global test accuracy: 18.06
Round  25, Train loss: 1.183, Test loss: 1.107, Test accuracy: 57.95
Round  25, Global train loss: 1.183, Global test loss: 2.374, Global test accuracy: 16.16
Round  26, Train loss: 1.216, Test loss: 1.087, Test accuracy: 58.37
Round  26, Global train loss: 1.216, Global test loss: 2.329, Global test accuracy: 18.93
Round  27, Train loss: 1.267, Test loss: 1.095, Test accuracy: 57.88
Round  27, Global train loss: 1.267, Global test loss: 2.352, Global test accuracy: 17.53
Round  28, Train loss: 1.241, Test loss: 1.081, Test accuracy: 58.66
Round  28, Global train loss: 1.241, Global test loss: 2.485, Global test accuracy: 14.04
Round  29, Train loss: 1.100, Test loss: 1.074, Test accuracy: 59.08
Round  29, Global train loss: 1.100, Global test loss: 2.455, Global test accuracy: 15.57
Round  30, Train loss: 1.140, Test loss: 1.077, Test accuracy: 58.98
Round  30, Global train loss: 1.140, Global test loss: 2.452, Global test accuracy: 14.65
Round  31, Train loss: 1.103, Test loss: 1.072, Test accuracy: 59.51
Round  31, Global train loss: 1.103, Global test loss: 2.469, Global test accuracy: 17.42
Round  32, Train loss: 1.274, Test loss: 1.079, Test accuracy: 59.15
Round  32, Global train loss: 1.274, Global test loss: 2.329, Global test accuracy: 16.89
Round  33, Train loss: 1.175, Test loss: 1.060, Test accuracy: 59.92
Round  33, Global train loss: 1.175, Global test loss: 2.559, Global test accuracy: 17.37
Round  34, Train loss: 1.035, Test loss: 1.074, Test accuracy: 59.75
Round  34, Global train loss: 1.035, Global test loss: 2.575, Global test accuracy: 16.00
Round  35, Train loss: 1.071, Test loss: 1.078, Test accuracy: 59.95
Round  35, Global train loss: 1.071, Global test loss: 2.628, Global test accuracy: 14.17
Round  36, Train loss: 1.107, Test loss: 1.093, Test accuracy: 59.12
Round  36, Global train loss: 1.107, Global test loss: 2.557, Global test accuracy: 16.15
Round  37, Train loss: 1.103, Test loss: 1.082, Test accuracy: 59.61
Round  37, Global train loss: 1.103, Global test loss: 2.412, Global test accuracy: 16.84
Round  38, Train loss: 1.065, Test loss: 1.066, Test accuracy: 60.08
Round  38, Global train loss: 1.065, Global test loss: 2.487, Global test accuracy: 16.70
Round  39, Train loss: 1.001, Test loss: 1.049, Test accuracy: 60.74
Round  39, Global train loss: 1.001, Global test loss: 2.702, Global test accuracy: 15.73
Round  40, Train loss: 1.039, Test loss: 1.048, Test accuracy: 61.26
Round  40, Global train loss: 1.039, Global test loss: 2.476, Global test accuracy: 16.81
Round  41, Train loss: 0.975, Test loss: 1.059, Test accuracy: 60.92
Round  41, Global train loss: 0.975, Global test loss: 2.459, Global test accuracy: 18.18
Round  42, Train loss: 1.078, Test loss: 1.051, Test accuracy: 61.28
Round  42, Global train loss: 1.078, Global test loss: 2.563, Global test accuracy: 17.41
Round  43, Train loss: 0.977, Test loss: 1.040, Test accuracy: 61.56
Round  43, Global train loss: 0.977, Global test loss: 2.610, Global test accuracy: 14.42
Round  44, Train loss: 1.085, Test loss: 1.045, Test accuracy: 61.67
Round  44, Global train loss: 1.085, Global test loss: 2.484, Global test accuracy: 19.67
Round  45, Train loss: 1.044, Test loss: 1.055, Test accuracy: 61.33
Round  45, Global train loss: 1.044, Global test loss: 2.392, Global test accuracy: 18.98
Round  46, Train loss: 0.898, Test loss: 1.065, Test accuracy: 61.31
Round  46, Global train loss: 0.898, Global test loss: 2.719, Global test accuracy: 17.05
Round  47, Train loss: 1.002, Test loss: 1.068, Test accuracy: 60.41
Round  47, Global train loss: 1.002, Global test loss: 2.607, Global test accuracy: 16.28
Round  48, Train loss: 1.008, Test loss: 1.067, Test accuracy: 60.61
Round  48, Global train loss: 1.008, Global test loss: 2.587, Global test accuracy: 16.59
Round  49, Train loss: 1.014, Test loss: 1.050, Test accuracy: 61.68
Round  49, Global train loss: 1.014, Global test loss: 2.646, Global test accuracy: 17.24
Round  50, Train loss: 0.982, Test loss: 1.072, Test accuracy: 61.51
Round  50, Global train loss: 0.982, Global test loss: 2.739, Global test accuracy: 16.93
Round  51, Train loss: 0.903, Test loss: 1.067, Test accuracy: 61.90
Round  51, Global train loss: 0.903, Global test loss: 2.755, Global test accuracy: 16.21
Round  52, Train loss: 0.899, Test loss: 1.049, Test accuracy: 61.83
Round  52, Global train loss: 0.899, Global test loss: 2.634, Global test accuracy: 17.48
Round  53, Train loss: 0.934, Test loss: 1.047, Test accuracy: 62.02
Round  53, Global train loss: 0.934, Global test loss: 2.625, Global test accuracy: 17.55
Round  54, Train loss: 0.990, Test loss: 1.048, Test accuracy: 62.25
Round  54, Global train loss: 0.990, Global test loss: 2.564, Global test accuracy: 17.90
Round  55, Train loss: 1.027, Test loss: 1.059, Test accuracy: 61.82
Round  55, Global train loss: 1.027, Global test loss: 2.456, Global test accuracy: 18.12
Round  56, Train loss: 0.908, Test loss: 1.071, Test accuracy: 61.31
Round  56, Global train loss: 0.908, Global test loss: 2.723, Global test accuracy: 17.34
Round  57, Train loss: 0.955, Test loss: 1.073, Test accuracy: 61.07
Round  57, Global train loss: 0.955, Global test loss: 2.563, Global test accuracy: 16.51
Round  58, Train loss: 0.939, Test loss: 1.065, Test accuracy: 61.65
Round  58, Global train loss: 0.939, Global test loss: 2.717, Global test accuracy: 16.74
Round  59, Train loss: 1.029, Test loss: 1.078, Test accuracy: 60.81
Round  59, Global train loss: 1.029, Global test loss: 2.768, Global test accuracy: 17.59
Round  60, Train loss: 0.921, Test loss: 1.086, Test accuracy: 60.89
Round  60, Global train loss: 0.921, Global test loss: 2.868, Global test accuracy: 15.10
Round  61, Train loss: 0.898, Test loss: 1.081, Test accuracy: 61.47
Round  61, Global train loss: 0.898, Global test loss: 2.669, Global test accuracy: 16.10
Round  62, Train loss: 0.906, Test loss: 1.085, Test accuracy: 61.22
Round  62, Global train loss: 0.906, Global test loss: 2.701, Global test accuracy: 16.13
Round  63, Train loss: 1.006, Test loss: 1.089, Test accuracy: 61.10
Round  63, Global train loss: 1.006, Global test loss: 2.658, Global test accuracy: 16.60
Round  64, Train loss: 1.007, Test loss: 1.076, Test accuracy: 61.53
Round  64, Global train loss: 1.007, Global test loss: 2.798, Global test accuracy: 16.25
Round  65, Train loss: 0.977, Test loss: 1.091, Test accuracy: 60.84
Round  65, Global train loss: 0.977, Global test loss: 2.666, Global test accuracy: 16.36
Round  66, Train loss: 0.960, Test loss: 1.112, Test accuracy: 60.32
Round  66, Global train loss: 0.960, Global test loss: 2.701, Global test accuracy: 18.73
Round  67, Train loss: 0.942, Test loss: 1.113, Test accuracy: 61.03
Round  67, Global train loss: 0.942, Global test loss: 2.707, Global test accuracy: 16.83
Round  68, Train loss: 0.927, Test loss: 1.111, Test accuracy: 61.38
Round  68, Global train loss: 0.927, Global test loss: 2.722, Global test accuracy: 16.81
Round  69, Train loss: 0.995, Test loss: 1.119, Test accuracy: 60.85
Round  69, Global train loss: 0.995, Global test loss: 2.721, Global test accuracy: 15.77
Round  70, Train loss: 0.864, Test loss: 1.128, Test accuracy: 60.07
Round  70, Global train loss: 0.864, Global test loss: 2.787, Global test accuracy: 16.41
Round  71, Train loss: 0.872, Test loss: 1.134, Test accuracy: 60.69
Round  71, Global train loss: 0.872, Global test loss: 2.845, Global test accuracy: 15.77
Round  72, Train loss: 0.947, Test loss: 1.121, Test accuracy: 61.49
Round  72, Global train loss: 0.947, Global test loss: 2.788, Global test accuracy: 15.01
Round  73, Train loss: 0.810, Test loss: 1.121, Test accuracy: 61.35
Round  73, Global train loss: 0.810, Global test loss: 2.997, Global test accuracy: 16.87
Round  74, Train loss: 0.942, Test loss: 1.148, Test accuracy: 60.68
Round  74, Global train loss: 0.942, Global test loss: 2.774, Global test accuracy: 16.39
Round  75, Train loss: 0.712, Test loss: 1.157, Test accuracy: 60.20
Round  75, Global train loss: 0.712, Global test loss: 2.751, Global test accuracy: 16.98
Round  76, Train loss: 0.918, Test loss: 1.177, Test accuracy: 59.65
Round  76, Global train loss: 0.918, Global test loss: 2.849, Global test accuracy: 16.03
Round  77, Train loss: 0.803, Test loss: 1.165, Test accuracy: 59.91
Round  77, Global train loss: 0.803, Global test loss: 2.824, Global test accuracy: 16.70
Round  78, Train loss: 0.847, Test loss: 1.167, Test accuracy: 60.11
Round  78, Global train loss: 0.847, Global test loss: 2.982, Global test accuracy: 16.18
Round  79, Train loss: 0.902, Test loss: 1.159, Test accuracy: 60.18
Round  79, Global train loss: 0.902, Global test loss: 2.791, Global test accuracy: 17.53
Round  80, Train loss: 0.821, Test loss: 1.170, Test accuracy: 59.72
Round  80, Global train loss: 0.821, Global test loss: 2.934, Global test accuracy: 17.36
Round  81, Train loss: 0.870, Test loss: 1.180, Test accuracy: 60.43
Round  81, Global train loss: 0.870, Global test loss: 3.009, Global test accuracy: 16.38
Round  82, Train loss: 0.687, Test loss: 1.195, Test accuracy: 60.47
Round  82, Global train loss: 0.687, Global test loss: 3.159, Global test accuracy: 16.04
Round  83, Train loss: 0.897, Test loss: 1.176, Test accuracy: 60.42
Round  83, Global train loss: 0.897, Global test loss: 2.811, Global test accuracy: 15.32
Round  84, Train loss: 0.868, Test loss: 1.180, Test accuracy: 60.27
Round  84, Global train loss: 0.868, Global test loss: 2.762, Global test accuracy: 16.74
Round  85, Train loss: 0.783, Test loss: 1.159, Test accuracy: 60.68
Round  85, Global train loss: 0.783, Global test loss: 3.011, Global test accuracy: 16.01
Round  86, Train loss: 0.780, Test loss: 1.168, Test accuracy: 60.77
Round  86, Global train loss: 0.780, Global test loss: 3.092, Global test accuracy: 15.76
Round  87, Train loss: 0.827, Test loss: 1.212, Test accuracy: 60.09
Round  87, Global train loss: 0.827, Global test loss: 2.941, Global test accuracy: 15.21
Round  88, Train loss: 0.853, Test loss: 1.209, Test accuracy: 60.24
Round  88, Global train loss: 0.853, Global test loss: 3.015, Global test accuracy: 15.94
Round  89, Train loss: 0.803, Test loss: 1.228, Test accuracy: 59.89
Round  89, Global train loss: 0.803, Global test loss: 2.865, Global test accuracy: 16.01
Round  90, Train loss: 0.748, Test loss: 1.237, Test accuracy: 59.98
Round  90, Global train loss: 0.748, Global test loss: 3.124, Global test accuracy: 16.45
Round  91, Train loss: 0.728, Test loss: 1.244, Test accuracy: 59.87
Round  91, Global train loss: 0.728, Global test loss: 3.412, Global test accuracy: 14.74
Round  92, Train loss: 0.797, Test loss: 1.263, Test accuracy: 59.39
Round  92, Global train loss: 0.797, Global test loss: 3.077, Global test accuracy: 15.98
Round  93, Train loss: 0.791, Test loss: 1.255, Test accuracy: 59.64
Round  93, Global train loss: 0.791, Global test loss: 3.105, Global test accuracy: 15.95/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.824, Test loss: 1.262, Test accuracy: 59.32
Round  94, Global train loss: 0.824, Global test loss: 2.932, Global test accuracy: 17.15
Round  95, Train loss: 0.707, Test loss: 1.270, Test accuracy: 59.31
Round  95, Global train loss: 0.707, Global test loss: 3.108, Global test accuracy: 15.39
Round  96, Train loss: 0.756, Test loss: 1.277, Test accuracy: 59.17
Round  96, Global train loss: 0.756, Global test loss: 3.033, Global test accuracy: 16.56
Round  97, Train loss: 0.699, Test loss: 1.277, Test accuracy: 59.45
Round  97, Global train loss: 0.699, Global test loss: 3.173, Global test accuracy: 16.56
Round  98, Train loss: 0.817, Test loss: 1.264, Test accuracy: 59.73
Round  98, Global train loss: 0.817, Global test loss: 3.082, Global test accuracy: 14.95
Round  99, Train loss: 0.672, Test loss: 1.276, Test accuracy: 59.68
Round  99, Global train loss: 0.672, Global test loss: 3.058, Global test accuracy: 15.05
Final Round, Train loss: 0.600, Test loss: 1.372, Test accuracy: 58.91
Final Round, Global train loss: 0.600, Global test loss: 3.058, Global test accuracy: 15.05
Average accuracy final 10 rounds: 59.554 

Average global accuracy final 10 rounds: 15.878 

1532.0007238388062
[1.572249412536621, 3.144498825073242, 4.4850757122039795, 5.825652599334717, 7.179662227630615, 8.533671855926514, 9.683410882949829, 10.833149909973145, 11.952524662017822, 13.0718994140625, 14.200566291809082, 15.329233169555664, 16.48158359527588, 17.633934020996094, 18.782032012939453, 19.930130004882812, 21.09024429321289, 22.25035858154297, 23.412322282791138, 24.574285984039307, 25.746427536010742, 26.918569087982178, 28.089199542999268, 29.259829998016357, 30.40329933166504, 31.54676866531372, 32.68290090560913, 33.81903314590454, 35.01501703262329, 36.21100091934204, 37.427029848098755, 38.64305877685547, 39.828418493270874, 41.01377820968628, 42.18619346618652, 43.35860872268677, 44.54557394981384, 45.73253917694092, 46.8991334438324, 48.06572771072388, 49.228121757507324, 50.39051580429077, 51.55069065093994, 52.71086549758911, 53.849080085754395, 54.98729467391968, 56.163036584854126, 57.338778495788574, 58.555596113204956, 59.77241373062134, 61.045679330825806, 62.31894493103027, 63.65685486793518, 64.99476480484009, 66.32233023643494, 67.64989566802979, 68.9759452342987, 70.30199480056763, 71.60089302062988, 72.89979124069214, 74.16984343528748, 75.43989562988281, 76.62576961517334, 77.81164360046387, 79.00517439842224, 80.19870519638062, 81.3825204372406, 82.56633567810059, 83.72987055778503, 84.89340543746948, 86.03345465660095, 87.17350387573242, 88.30903840065002, 89.44457292556763, 90.59591937065125, 91.74726581573486, 92.93981385231018, 94.1323618888855, 95.26966285705566, 96.40696382522583, 97.55996680259705, 98.71296977996826, 99.89530658721924, 101.07764339447021, 102.21888375282288, 103.36012411117554, 104.49658942222595, 105.63305473327637, 106.76875376701355, 107.90445280075073, 109.0557427406311, 110.20703268051147, 111.34744620323181, 112.48785972595215, 113.63715815544128, 114.78645658493042, 115.96099543571472, 117.13553428649902, 118.30568504333496, 119.4758358001709, 120.64670658111572, 121.81757736206055, 122.9737856388092, 124.12999391555786, 125.3221218585968, 126.51424980163574, 127.64402103424072, 128.7737922668457, 129.9433515071869, 131.11291074752808, 132.27652144432068, 133.44013214111328, 134.569730758667, 135.6993293762207, 136.88805079460144, 138.07677221298218, 139.2704257965088, 140.4640793800354, 141.6313819885254, 142.79868459701538, 143.95553827285767, 145.11239194869995, 146.23732256889343, 147.3622531890869, 148.4985716342926, 149.6348900794983, 150.7644453048706, 151.89400053024292, 153.02560758590698, 154.15721464157104, 155.29658436775208, 156.4359540939331, 157.575585603714, 158.71521711349487, 159.86016273498535, 161.00510835647583, 162.14887928962708, 163.29265022277832, 164.4482672214508, 165.6038842201233, 166.75327324867249, 167.90266227722168, 169.04379034042358, 170.1849184036255, 171.3347887992859, 172.4846591949463, 173.6361939907074, 174.7877287864685, 175.93103885650635, 177.0743489265442, 178.22722339630127, 179.38009786605835, 180.5288164615631, 181.67753505706787, 182.82886791229248, 183.9802007675171, 185.16232252120972, 186.34444427490234, 187.55701160430908, 188.76957893371582, 189.98599934577942, 191.20241975784302, 192.38125586509705, 193.56009197235107, 194.72152471542358, 195.8829574584961, 197.05350422859192, 198.22405099868774, 199.4342396259308, 200.64442825317383, 201.7621512413025, 202.87987422943115, 204.052490234375, 205.22510623931885, 206.35898160934448, 207.49285697937012, 208.67018604278564, 209.84751510620117, 211.03614902496338, 212.2247829437256, 213.41057300567627, 214.59636306762695, 215.78337693214417, 216.97039079666138, 218.16386532783508, 219.3573398590088, 220.5746512413025, 221.7919626235962, 222.9700710773468, 224.1481795310974, 225.33244967460632, 226.51671981811523, 227.68014001846313, 228.84356021881104, 230.04264616966248, 231.24173212051392, 232.43651056289673, 233.63128900527954, 234.8205428123474, 236.00979661941528, 238.35913515090942, 240.70847368240356]
[20.43, 20.43, 24.85, 24.85, 27.48, 27.48, 31.11, 31.11, 38.12, 38.12, 38.82, 38.82, 41.07, 41.07, 45.74, 45.74, 47.66, 47.66, 50.08, 50.08, 50.61, 50.61, 51.31, 51.31, 51.62, 51.62, 52.69, 52.69, 53.37, 53.37, 54.86, 54.86, 54.78, 54.78, 55.38, 55.38, 55.74, 55.74, 56.16, 56.16, 56.68, 56.68, 56.56, 56.56, 57.2, 57.2, 56.83, 56.83, 57.76, 57.76, 57.95, 57.95, 58.37, 58.37, 57.88, 57.88, 58.66, 58.66, 59.08, 59.08, 58.98, 58.98, 59.51, 59.51, 59.15, 59.15, 59.92, 59.92, 59.75, 59.75, 59.95, 59.95, 59.12, 59.12, 59.61, 59.61, 60.08, 60.08, 60.74, 60.74, 61.26, 61.26, 60.92, 60.92, 61.28, 61.28, 61.56, 61.56, 61.67, 61.67, 61.33, 61.33, 61.31, 61.31, 60.41, 60.41, 60.61, 60.61, 61.68, 61.68, 61.51, 61.51, 61.9, 61.9, 61.83, 61.83, 62.02, 62.02, 62.25, 62.25, 61.82, 61.82, 61.31, 61.31, 61.07, 61.07, 61.65, 61.65, 60.81, 60.81, 60.89, 60.89, 61.47, 61.47, 61.22, 61.22, 61.1, 61.1, 61.53, 61.53, 60.84, 60.84, 60.32, 60.32, 61.03, 61.03, 61.38, 61.38, 60.85, 60.85, 60.07, 60.07, 60.69, 60.69, 61.49, 61.49, 61.35, 61.35, 60.68, 60.68, 60.2, 60.2, 59.65, 59.65, 59.91, 59.91, 60.11, 60.11, 60.18, 60.18, 59.72, 59.72, 60.43, 60.43, 60.47, 60.47, 60.42, 60.42, 60.27, 60.27, 60.68, 60.68, 60.77, 60.77, 60.09, 60.09, 60.24, 60.24, 59.89, 59.89, 59.98, 59.98, 59.87, 59.87, 59.39, 59.39, 59.64, 59.64, 59.32, 59.32, 59.31, 59.31, 59.17, 59.17, 59.45, 59.45, 59.73, 59.73, 59.68, 59.68, 58.91, 58.91]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.704, Test loss: 2.106, Test accuracy: 20.85
Round   0, Global train loss: 1.704, Global test loss: 2.309, Global test accuracy: 16.14
Round   1, Train loss: 1.552, Test loss: 2.201, Test accuracy: 24.79
Round   1, Global train loss: 1.552, Global test loss: 2.621, Global test accuracy: 16.37
Round   2, Train loss: 1.468, Test loss: 2.086, Test accuracy: 28.27
Round   2, Global train loss: 1.468, Global test loss: 2.611, Global test accuracy: 16.01
Round   3, Train loss: 1.457, Test loss: 1.885, Test accuracy: 30.38
Round   3, Global train loss: 1.457, Global test loss: 2.457, Global test accuracy: 17.43
Round   4, Train loss: 1.409, Test loss: 1.727, Test accuracy: 37.05
Round   4, Global train loss: 1.409, Global test loss: 2.458, Global test accuracy: 18.77
Round   5, Train loss: 1.358, Test loss: 1.754, Test accuracy: 39.15
Round   5, Global train loss: 1.358, Global test loss: 2.696, Global test accuracy: 18.85
Round   6, Train loss: 1.359, Test loss: 1.644, Test accuracy: 41.11
Round   6, Global train loss: 1.359, Global test loss: 2.501, Global test accuracy: 18.97
Round   7, Train loss: 1.365, Test loss: 1.642, Test accuracy: 43.62
Round   7, Global train loss: 1.365, Global test loss: 2.679, Global test accuracy: 18.27
Round   8, Train loss: 1.290, Test loss: 1.390, Test accuracy: 47.95
Round   8, Global train loss: 1.290, Global test loss: 2.560, Global test accuracy: 17.15
Round   9, Train loss: 1.323, Test loss: 1.285, Test accuracy: 50.42
Round   9, Global train loss: 1.323, Global test loss: 2.498, Global test accuracy: 16.01
Round  10, Train loss: 1.372, Test loss: 1.286, Test accuracy: 50.54
Round  10, Global train loss: 1.372, Global test loss: 2.492, Global test accuracy: 19.13
Round  11, Train loss: 1.330, Test loss: 1.285, Test accuracy: 50.87
Round  11, Global train loss: 1.330, Global test loss: 2.665, Global test accuracy: 15.91
Round  12, Train loss: 1.328, Test loss: 1.274, Test accuracy: 52.06
Round  12, Global train loss: 1.328, Global test loss: 2.616, Global test accuracy: 15.68
Round  13, Train loss: 1.318, Test loss: 1.257, Test accuracy: 52.57
Round  13, Global train loss: 1.318, Global test loss: 2.643, Global test accuracy: 18.52
Round  14, Train loss: 1.268, Test loss: 1.283, Test accuracy: 52.04
Round  14, Global train loss: 1.268, Global test loss: 2.755, Global test accuracy: 16.25
Round  15, Train loss: 1.165, Test loss: 1.281, Test accuracy: 52.48
Round  15, Global train loss: 1.165, Global test loss: 2.510, Global test accuracy: 15.49
Round  16, Train loss: 1.226, Test loss: 1.265, Test accuracy: 52.94
Round  16, Global train loss: 1.226, Global test loss: 2.539, Global test accuracy: 14.19
Round  17, Train loss: 1.091, Test loss: 1.251, Test accuracy: 53.74
Round  17, Global train loss: 1.091, Global test loss: 2.564, Global test accuracy: 15.90
Round  18, Train loss: 1.025, Test loss: 1.245, Test accuracy: 54.67
Round  18, Global train loss: 1.025, Global test loss: 2.830, Global test accuracy: 18.97
Round  19, Train loss: 1.209, Test loss: 1.247, Test accuracy: 54.89
Round  19, Global train loss: 1.209, Global test loss: 2.509, Global test accuracy: 16.46
Round  20, Train loss: 1.181, Test loss: 1.255, Test accuracy: 54.47
Round  20, Global train loss: 1.181, Global test loss: 2.644, Global test accuracy: 15.56
Round  21, Train loss: 1.029, Test loss: 1.227, Test accuracy: 55.15
Round  21, Global train loss: 1.029, Global test loss: 2.616, Global test accuracy: 18.34
Round  22, Train loss: 1.118, Test loss: 1.222, Test accuracy: 54.99
Round  22, Global train loss: 1.118, Global test loss: 2.789, Global test accuracy: 15.87
Round  23, Train loss: 1.171, Test loss: 1.225, Test accuracy: 55.65
Round  23, Global train loss: 1.171, Global test loss: 2.509, Global test accuracy: 15.06
Round  24, Train loss: 1.045, Test loss: 1.203, Test accuracy: 55.78
Round  24, Global train loss: 1.045, Global test loss: 2.702, Global test accuracy: 17.05
Round  25, Train loss: 1.185, Test loss: 1.211, Test accuracy: 56.23
Round  25, Global train loss: 1.185, Global test loss: 2.559, Global test accuracy: 17.53
Round  26, Train loss: 1.025, Test loss: 1.194, Test accuracy: 56.84
Round  26, Global train loss: 1.025, Global test loss: 2.511, Global test accuracy: 14.02
Round  27, Train loss: 1.106, Test loss: 1.161, Test accuracy: 57.69
Round  27, Global train loss: 1.106, Global test loss: 2.655, Global test accuracy: 15.94
Round  28, Train loss: 1.053, Test loss: 1.185, Test accuracy: 56.73
Round  28, Global train loss: 1.053, Global test loss: 2.765, Global test accuracy: 17.57
Round  29, Train loss: 1.259, Test loss: 1.189, Test accuracy: 56.36
Round  29, Global train loss: 1.259, Global test loss: 2.498, Global test accuracy: 15.90
Round  30, Train loss: 1.129, Test loss: 1.182, Test accuracy: 56.78
Round  30, Global train loss: 1.129, Global test loss: 2.550, Global test accuracy: 18.53
Round  31, Train loss: 0.937, Test loss: 1.173, Test accuracy: 56.71
Round  31, Global train loss: 0.937, Global test loss: 2.557, Global test accuracy: 17.30
Round  32, Train loss: 1.167, Test loss: 1.175, Test accuracy: 56.82
Round  32, Global train loss: 1.167, Global test loss: 2.632, Global test accuracy: 18.27
Round  33, Train loss: 1.013, Test loss: 1.176, Test accuracy: 56.58
Round  33, Global train loss: 1.013, Global test loss: 2.611, Global test accuracy: 17.50
Round  34, Train loss: 0.912, Test loss: 1.193, Test accuracy: 56.82
Round  34, Global train loss: 0.912, Global test loss: 2.948, Global test accuracy: 17.60
Round  35, Train loss: 0.965, Test loss: 1.206, Test accuracy: 56.61
Round  35, Global train loss: 0.965, Global test loss: 2.671, Global test accuracy: 17.56
Round  36, Train loss: 0.964, Test loss: 1.218, Test accuracy: 57.41
Round  36, Global train loss: 0.964, Global test loss: 2.760, Global test accuracy: 15.56
Round  37, Train loss: 1.067, Test loss: 1.180, Test accuracy: 58.29
Round  37, Global train loss: 1.067, Global test loss: 2.521, Global test accuracy: 16.88
Round  38, Train loss: 1.045, Test loss: 1.171, Test accuracy: 57.99
Round  38, Global train loss: 1.045, Global test loss: 2.627, Global test accuracy: 15.75
Round  39, Train loss: 0.958, Test loss: 1.152, Test accuracy: 58.29
Round  39, Global train loss: 0.958, Global test loss: 2.725, Global test accuracy: 17.92
Round  40, Train loss: 0.953, Test loss: 1.175, Test accuracy: 57.93
Round  40, Global train loss: 0.953, Global test loss: 2.762, Global test accuracy: 16.19
Round  41, Train loss: 0.939, Test loss: 1.183, Test accuracy: 57.25
Round  41, Global train loss: 0.939, Global test loss: 2.660, Global test accuracy: 16.68
Round  42, Train loss: 0.961, Test loss: 1.203, Test accuracy: 57.36
Round  42, Global train loss: 0.961, Global test loss: 2.801, Global test accuracy: 16.74
Round  43, Train loss: 1.120, Test loss: 1.182, Test accuracy: 58.00
Round  43, Global train loss: 1.120, Global test loss: 2.619, Global test accuracy: 15.86
Round  44, Train loss: 0.980, Test loss: 1.180, Test accuracy: 57.51
Round  44, Global train loss: 0.980, Global test loss: 2.624, Global test accuracy: 17.57
Round  45, Train loss: 0.833, Test loss: 1.188, Test accuracy: 58.10
Round  45, Global train loss: 0.833, Global test loss: 3.218, Global test accuracy: 17.39
Round  46, Train loss: 0.949, Test loss: 1.191, Test accuracy: 57.86
Round  46, Global train loss: 0.949, Global test loss: 2.798, Global test accuracy: 17.45
Round  47, Train loss: 1.010, Test loss: 1.185, Test accuracy: 58.12
Round  47, Global train loss: 1.010, Global test loss: 2.629, Global test accuracy: 16.96
Round  48, Train loss: 0.940, Test loss: 1.217, Test accuracy: 57.67
Round  48, Global train loss: 0.940, Global test loss: 2.810, Global test accuracy: 15.00
Round  49, Train loss: 0.969, Test loss: 1.195, Test accuracy: 58.19
Round  49, Global train loss: 0.969, Global test loss: 2.599, Global test accuracy: 18.70
Round  50, Train loss: 0.701, Test loss: 1.220, Test accuracy: 58.27
Round  50, Global train loss: 0.701, Global test loss: 2.921, Global test accuracy: 17.22
Round  51, Train loss: 0.848, Test loss: 1.213, Test accuracy: 58.85
Round  51, Global train loss: 0.848, Global test loss: 3.174, Global test accuracy: 15.76
Round  52, Train loss: 0.951, Test loss: 1.216, Test accuracy: 58.65
Round  52, Global train loss: 0.951, Global test loss: 2.894, Global test accuracy: 18.77
Round  53, Train loss: 0.833, Test loss: 1.219, Test accuracy: 58.18
Round  53, Global train loss: 0.833, Global test loss: 2.928, Global test accuracy: 15.09
Round  54, Train loss: 0.797, Test loss: 1.219, Test accuracy: 58.30
Round  54, Global train loss: 0.797, Global test loss: 2.893, Global test accuracy: 16.76
Round  55, Train loss: 0.843, Test loss: 1.210, Test accuracy: 59.12
Round  55, Global train loss: 0.843, Global test loss: 3.072, Global test accuracy: 14.95
Round  56, Train loss: 0.959, Test loss: 1.183, Test accuracy: 59.86
Round  56, Global train loss: 0.959, Global test loss: 2.643, Global test accuracy: 15.44
Round  57, Train loss: 0.962, Test loss: 1.196, Test accuracy: 59.48
Round  57, Global train loss: 0.962, Global test loss: 2.813, Global test accuracy: 17.42
Round  58, Train loss: 0.798, Test loss: 1.203, Test accuracy: 59.44
Round  58, Global train loss: 0.798, Global test loss: 3.058, Global test accuracy: 17.15
Round  59, Train loss: 0.730, Test loss: 1.175, Test accuracy: 59.90
Round  59, Global train loss: 0.730, Global test loss: 2.888, Global test accuracy: 15.84
Round  60, Train loss: 1.082, Test loss: 1.204, Test accuracy: 59.62
Round  60, Global train loss: 1.082, Global test loss: 2.919, Global test accuracy: 15.16
Round  61, Train loss: 0.860, Test loss: 1.195, Test accuracy: 59.55
Round  61, Global train loss: 0.860, Global test loss: 2.775, Global test accuracy: 16.69
Round  62, Train loss: 0.828, Test loss: 1.236, Test accuracy: 58.82
Round  62, Global train loss: 0.828, Global test loss: 3.120, Global test accuracy: 15.77
Round  63, Train loss: 0.769, Test loss: 1.242, Test accuracy: 58.44
Round  63, Global train loss: 0.769, Global test loss: 3.062, Global test accuracy: 15.38
Round  64, Train loss: 0.957, Test loss: 1.233, Test accuracy: 59.01
Round  64, Global train loss: 0.957, Global test loss: 2.774, Global test accuracy: 13.79
Round  65, Train loss: 0.747, Test loss: 1.238, Test accuracy: 58.79
Round  65, Global train loss: 0.747, Global test loss: 2.835, Global test accuracy: 16.25
Round  66, Train loss: 0.712, Test loss: 1.245, Test accuracy: 58.64
Round  66, Global train loss: 0.712, Global test loss: 2.808, Global test accuracy: 17.86
Round  67, Train loss: 0.814, Test loss: 1.240, Test accuracy: 58.78
Round  67, Global train loss: 0.814, Global test loss: 2.857, Global test accuracy: 16.77
Round  68, Train loss: 0.710, Test loss: 1.233, Test accuracy: 59.15
Round  68, Global train loss: 0.710, Global test loss: 2.881, Global test accuracy: 18.59
Round  69, Train loss: 0.790, Test loss: 1.239, Test accuracy: 59.07
Round  69, Global train loss: 0.790, Global test loss: 2.891, Global test accuracy: 17.22
Round  70, Train loss: 0.841, Test loss: 1.264, Test accuracy: 58.41
Round  70, Global train loss: 0.841, Global test loss: 2.878, Global test accuracy: 16.44
Round  71, Train loss: 0.708, Test loss: 1.287, Test accuracy: 58.15
Round  71, Global train loss: 0.708, Global test loss: 3.005, Global test accuracy: 14.55
Round  72, Train loss: 0.834, Test loss: 1.287, Test accuracy: 58.45
Round  72, Global train loss: 0.834, Global test loss: 2.974, Global test accuracy: 17.01
Round  73, Train loss: 0.616, Test loss: 1.309, Test accuracy: 58.12
Round  73, Global train loss: 0.616, Global test loss: 3.050, Global test accuracy: 16.98
Round  74, Train loss: 0.846, Test loss: 1.325, Test accuracy: 58.00
Round  74, Global train loss: 0.846, Global test loss: 2.935, Global test accuracy: 17.70
Round  75, Train loss: 0.839, Test loss: 1.290, Test accuracy: 58.55
Round  75, Global train loss: 0.839, Global test loss: 2.979, Global test accuracy: 17.50
Round  76, Train loss: 0.838, Test loss: 1.288, Test accuracy: 58.94
Round  76, Global train loss: 0.838, Global test loss: 2.922, Global test accuracy: 16.32
Round  77, Train loss: 0.825, Test loss: 1.305, Test accuracy: 58.87
Round  77, Global train loss: 0.825, Global test loss: 3.105, Global test accuracy: 16.51
Round  78, Train loss: 0.829, Test loss: 1.308, Test accuracy: 58.95
Round  78, Global train loss: 0.829, Global test loss: 2.928, Global test accuracy: 15.87
Round  79, Train loss: 0.647, Test loss: 1.302, Test accuracy: 59.02
Round  79, Global train loss: 0.647, Global test loss: 2.873, Global test accuracy: 15.48
Round  80, Train loss: 0.738, Test loss: 1.282, Test accuracy: 59.24
Round  80, Global train loss: 0.738, Global test loss: 2.917, Global test accuracy: 16.33
Round  81, Train loss: 0.711, Test loss: 1.295, Test accuracy: 59.12
Round  81, Global train loss: 0.711, Global test loss: 3.075, Global test accuracy: 17.93
Round  82, Train loss: 0.765, Test loss: 1.278, Test accuracy: 60.23
Round  82, Global train loss: 0.765, Global test loss: 3.324, Global test accuracy: 18.25
Round  83, Train loss: 0.723, Test loss: 1.281, Test accuracy: 59.97
Round  83, Global train loss: 0.723, Global test loss: 3.412, Global test accuracy: 18.34
Round  84, Train loss: 0.663, Test loss: 1.290, Test accuracy: 59.17
Round  84, Global train loss: 0.663, Global test loss: 3.109, Global test accuracy: 16.76
Round  85, Train loss: 0.615, Test loss: 1.317, Test accuracy: 58.73
Round  85, Global train loss: 0.615, Global test loss: 3.072, Global test accuracy: 16.30
Round  86, Train loss: 0.532, Test loss: 1.345, Test accuracy: 58.90
Round  86, Global train loss: 0.532, Global test loss: 3.465, Global test accuracy: 17.15
Round  87, Train loss: 0.724, Test loss: 1.331, Test accuracy: 59.34
Round  87, Global train loss: 0.724, Global test loss: 3.080, Global test accuracy: 14.82
Round  88, Train loss: 0.734, Test loss: 1.330, Test accuracy: 59.19
Round  88, Global train loss: 0.734, Global test loss: 2.950, Global test accuracy: 17.73
Round  89, Train loss: 0.800, Test loss: 1.315, Test accuracy: 59.37
Round  89, Global train loss: 0.800, Global test loss: 2.905, Global test accuracy: 17.87
Round  90, Train loss: 0.691, Test loss: 1.350, Test accuracy: 58.46
Round  90, Global train loss: 0.691, Global test loss: 3.106, Global test accuracy: 17.71
Round  91, Train loss: 0.845, Test loss: 1.360, Test accuracy: 58.79
Round  91, Global train loss: 0.845, Global test loss: 3.124, Global test accuracy: 16.38
Round  92, Train loss: 0.679, Test loss: 1.371, Test accuracy: 58.93
Round  92, Global train loss: 0.679, Global test loss: 3.011, Global test accuracy: 16.36
Round  93, Train loss: 0.718, Test loss: 1.356, Test accuracy: 59.28
Round  93, Global train loss: 0.718, Global test loss: 3.047, Global test accuracy: 14.50
Round  94, Train loss: 0.582, Test loss: 1.346, Test accuracy: 59.21
Round  94, Global train loss: 0.582, Global test loss: 3.282, Global test accuracy: 16.41
Round  95, Train loss: 0.580, Test loss: 1.366, Test accuracy: 59.17
Round  95, Global train loss: 0.580, Global test loss: 3.255, Global test accuracy: 15.70
Round  96, Train loss: 0.556, Test loss: 1.362, Test accuracy: 58.86
Round  96, Global train loss: 0.556, Global test loss: 3.407, Global test accuracy: 15.98
Round  97, Train loss: 0.652, Test loss: 1.360, Test accuracy: 58.82
Round  97, Global train loss: 0.652, Global test loss: 3.601, Global test accuracy: 12.78
Round  98, Train loss: 0.631, Test loss: 1.375, Test accuracy: 57.98
Round  98, Global train loss: 0.631, Global test loss: 3.150, Global test accuracy: 17.46
Round  99, Train loss: 0.687, Test loss: 1.372, Test accuracy: 58.69
Round  99, Global train loss: 0.687, Global test loss: 3.295, Global test accuracy: 17.56
Final Round, Train loss: 0.516, Test loss: 1.566, Test accuracy: 58.16
Final Round, Global train loss: 0.516, Global test loss: 3.295, Global test accuracy: 17.56
Average accuracy final 10 rounds: 58.819
Average global accuracy final 10 rounds: 16.084
2255.2932550907135
[3.2526278495788574, 6.081528425216675, 8.942582845687866, 11.907796859741211, 14.816039085388184, 17.683539628982544, 20.633687019348145, 23.549911975860596, 26.468112468719482, 29.347097158432007, 32.263484477996826, 35.071112394332886, 37.95234727859497, 40.881447315216064, 43.75204086303711, 46.55578398704529, 49.31818890571594, 52.18321180343628, 55.13961696624756, 58.01907658576965, 60.73397183418274, 63.709187507629395, 66.64023041725159, 69.51560974121094, 72.33514308929443, 75.03577136993408, 77.77278137207031, 80.63100171089172, 83.33211088180542, 86.11743831634521, 88.88236999511719, 91.65285849571228, 94.50733208656311, 97.37576842308044, 100.15284442901611, 102.9380943775177, 105.72879338264465, 108.54009222984314, 111.35777163505554, 114.0440411567688, 116.72816038131714, 119.4766013622284, 122.29192018508911, 125.12327027320862, 127.92628979682922, 130.7229769229889, 133.56322979927063, 136.3208622932434, 139.16555643081665, 142.0505747795105, 144.91555094718933, 147.78819608688354, 150.68993854522705, 153.46629762649536, 156.35279870033264, 159.2859401702881, 162.2491660118103, 165.02967286109924, 167.87492537498474, 170.7641134262085, 173.57165384292603, 176.40675926208496, 179.280100107193, 182.17967414855957, 184.86848950386047, 187.63036131858826, 190.41303420066833, 193.30396103858948, 196.1354856491089, 198.93065357208252, 201.77825808525085, 204.59132146835327, 207.45165991783142, 210.2330186367035, 213.19000673294067, 216.1022491455078, 218.9955472946167, 221.8802936077118, 224.8803415298462, 227.6143503189087, 230.5102882385254, 233.43878555297852, 236.30654001235962, 239.10888600349426, 241.9559428691864, 245.20237970352173, 248.24058485031128, 251.3807282447815, 254.20496344566345, 257.0893177986145, 259.8153350353241, 262.6743404865265, 265.4882228374481, 268.1771001815796, 270.9529709815979, 273.7467288970947, 276.54915142059326, 279.3366174697876, 282.12997794151306, 284.930704832077, 289.5833866596222]
[20.85, 24.79, 28.27, 30.38, 37.05, 39.15, 41.11, 43.62, 47.95, 50.42, 50.54, 50.87, 52.06, 52.57, 52.04, 52.48, 52.94, 53.74, 54.67, 54.89, 54.47, 55.15, 54.99, 55.65, 55.78, 56.23, 56.84, 57.69, 56.73, 56.36, 56.78, 56.71, 56.82, 56.58, 56.82, 56.61, 57.41, 58.29, 57.99, 58.29, 57.93, 57.25, 57.36, 58.0, 57.51, 58.1, 57.86, 58.12, 57.67, 58.19, 58.27, 58.85, 58.65, 58.18, 58.3, 59.12, 59.86, 59.48, 59.44, 59.9, 59.62, 59.55, 58.82, 58.44, 59.01, 58.79, 58.64, 58.78, 59.15, 59.07, 58.41, 58.15, 58.45, 58.12, 58.0, 58.55, 58.94, 58.87, 58.95, 59.02, 59.24, 59.12, 60.23, 59.97, 59.17, 58.73, 58.9, 59.34, 59.19, 59.37, 58.46, 58.79, 58.93, 59.28, 59.21, 59.17, 58.86, 58.82, 57.98, 58.69, 58.16]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  16.3000
Round 1 global test acc  20.2500
Round 2 global test acc  21.3900
Round 3 global test acc  17.5800
Round 4 global test acc  19.7900
Round 5 global test acc  26.9300
Round 6 global test acc  23.0500
Round 7 global test acc  30.1300
Round 8 global test acc  29.5700
Round 9 global test acc  32.2600
Round 10 global test acc  24.9600
Round 11 global test acc  25.9300
Round 12 global test acc  33.6800
Round 13 global test acc  28.3300
Round 14 global test acc  32.8800
Round 15 global test acc  36.5600
Round 16 global test acc  32.1200
Round 17 global test acc  29.7200
Round 18 global test acc  33.7300
Round 19 global test acc  30.7400
Round 20 global test acc  29.2900
Round 21 global test acc  30.4000
Round 22 global test acc  33.9700
Round 23 global test acc  36.7700
Round 24 global test acc  27.0900
Round 25 global test acc  35.8000
Round 26 global test acc  39.4500
Round 27 global test acc  30.7600
Round 28 global test acc  38.0500
Round 29 global test acc  28.3100
Round 30 global test acc  33.4900
Round 31 global test acc  27.4600
Round 32 global test acc  34.6100
Round 33 global test acc  32.9300
Round 34 global test acc  33.4700
Round 35 global test acc  33.6900
Round 36 global test acc  36.3200
Round 37 global test acc  34.1300
Round 38 global test acc  32.9800
Round 39 global test acc  35.2200
Round 40 global test acc  30.6200
Round 41 global test acc  33.4800
Round 42 global test acc  33.4800
Round 43 global test acc  35.8700
Round 44 global test acc  35.1300
Round 45 global test acc  37.2700
Round 46 global test acc  37.6800
Round 47 global test acc  45.0600
Round 48 global test acc  40.4500
Round 49 global test acc  34.0500
Round 50 global test acc  38.3400
Round 51 global test acc  39.3400
Round 52 global test acc  28.1100
Round 53 global test acc  38.5600
Round 54 global test acc  35.9400
Round 55 global test acc  35.0100
Round 56 global test acc  32.9700
Round 57 global test acc  41.0300
Round 58 global test acc  36.3500
Round 59 global test acc  41.5500
Round 60 global test acc  34.0000
Round 61 global test acc  42.6900
Round 62 global test acc  41.4700
Round 63 global test acc  37.3800
Round 64 global test acc  38.3300
Round 65 global test acc  34.7600
Round 66 global test acc  42.1200
Round 67 global test acc  34.4200
Round 68 global test acc  27.8800
Round 69 global test acc  38.8500
Round 70 global test acc  36.5500
Round 71 global test acc  35.6600
Round 72 global test acc  36.8400
Round 73 global test acc  46.8500
Round 74 global test acc  38.1500
Round 75 global test acc  28.1700
Round 76 global test acc  34.7000
Round 77 global test acc  43.3700
Round 78 global test acc  40.4000
Round 79 global test acc  32.1600
Round 80 global test acc  28.0300
Round 81 global test acc  28.2100
Round 82 global test acc  24.9600
Round 83 global test acc  27.7500
Round 84 global test acc  28.6300
Round 85 global test acc  28.4000
Round 86 global test acc  27.6600
Round 87 global test acc  25.3700
Round 88 global test acc  26.4600
Round 89 global test acc  26.3500
Round 90 global test acc  24.9900
Round 91 global test acc  24.6000
Round 92 global test acc  25.3500
Round 93 global test acc  24.5600
Round 94 global test acc  24.8200
Round 95 global test acc  24.8700
Round 96 global test acc  24.3200
Round 97 global test acc  24.2700
Round 98 global test acc  23.8700
Round 99 global test acc  24.1800
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.997, Test loss: 2.268, Test accuracy: 12.18
Round   1, Train loss: 1.633, Test loss: 2.231, Test accuracy: 17.86
Round   2, Train loss: 1.540, Test loss: 2.034, Test accuracy: 21.69
Round   3, Train loss: 1.500, Test loss: 1.903, Test accuracy: 26.02
Round   4, Train loss: 1.537, Test loss: 1.715, Test accuracy: 33.02
Round   5, Train loss: 1.470, Test loss: 1.609, Test accuracy: 37.12
Round   6, Train loss: 1.326, Test loss: 1.615, Test accuracy: 37.15
Round   7, Train loss: 1.391, Test loss: 1.486, Test accuracy: 39.21
Round   8, Train loss: 1.388, Test loss: 1.341, Test accuracy: 44.21
Round   9, Train loss: 1.361, Test loss: 1.272, Test accuracy: 46.47
Round  10, Train loss: 1.552, Test loss: 1.265, Test accuracy: 47.73
Round  11, Train loss: 1.314, Test loss: 1.218, Test accuracy: 49.47
Round  12, Train loss: 1.387, Test loss: 1.209, Test accuracy: 50.93
Round  13, Train loss: 1.287, Test loss: 1.210, Test accuracy: 51.56
Round  14, Train loss: 1.301, Test loss: 1.168, Test accuracy: 53.05
Round  15, Train loss: 1.347, Test loss: 1.149, Test accuracy: 54.95
Round  16, Train loss: 1.380, Test loss: 1.117, Test accuracy: 56.25
Round  17, Train loss: 1.227, Test loss: 1.100, Test accuracy: 56.88
Round  18, Train loss: 1.154, Test loss: 1.092, Test accuracy: 57.80
Round  19, Train loss: 1.208, Test loss: 1.090, Test accuracy: 58.21
Round  20, Train loss: 1.277, Test loss: 1.082, Test accuracy: 59.66
Round  21, Train loss: 1.205, Test loss: 1.075, Test accuracy: 59.26
Round  22, Train loss: 1.119, Test loss: 1.060, Test accuracy: 59.63
Round  23, Train loss: 1.324, Test loss: 1.038, Test accuracy: 61.09
Round  24, Train loss: 0.998, Test loss: 1.008, Test accuracy: 61.97
Round  25, Train loss: 1.310, Test loss: 1.033, Test accuracy: 62.40
Round  26, Train loss: 1.135, Test loss: 1.025, Test accuracy: 62.79
Round  27, Train loss: 1.184, Test loss: 1.027, Test accuracy: 63.00
Round  28, Train loss: 1.237, Test loss: 1.010, Test accuracy: 62.78
Round  29, Train loss: 1.296, Test loss: 1.017, Test accuracy: 63.22
Round  30, Train loss: 1.222, Test loss: 1.007, Test accuracy: 63.50
Round  31, Train loss: 1.086, Test loss: 0.999, Test accuracy: 63.61
Round  32, Train loss: 1.224, Test loss: 0.961, Test accuracy: 64.50
Round  33, Train loss: 0.950, Test loss: 0.956, Test accuracy: 64.92
Round  34, Train loss: 1.028, Test loss: 0.949, Test accuracy: 65.47
Round  35, Train loss: 1.103, Test loss: 0.952, Test accuracy: 65.83
Round  36, Train loss: 1.132, Test loss: 0.971, Test accuracy: 65.88
Round  37, Train loss: 1.011, Test loss: 0.930, Test accuracy: 66.06
Round  38, Train loss: 1.109, Test loss: 0.931, Test accuracy: 66.85
Round  39, Train loss: 1.079, Test loss: 0.926, Test accuracy: 66.54
Round  40, Train loss: 0.969, Test loss: 0.932, Test accuracy: 67.21
Round  41, Train loss: 0.886, Test loss: 0.919, Test accuracy: 67.23
Round  42, Train loss: 1.153, Test loss: 0.901, Test accuracy: 67.63
Round  43, Train loss: 1.079, Test loss: 0.912, Test accuracy: 67.56
Round  44, Train loss: 0.845, Test loss: 0.894, Test accuracy: 68.02
Round  45, Train loss: 0.958, Test loss: 0.887, Test accuracy: 68.21
Round  46, Train loss: 0.830, Test loss: 0.888, Test accuracy: 68.32
Round  47, Train loss: 1.068, Test loss: 0.892, Test accuracy: 68.43
Round  48, Train loss: 1.018, Test loss: 0.880, Test accuracy: 68.91
Round  49, Train loss: 0.946, Test loss: 0.882, Test accuracy: 68.91
Round  50, Train loss: 0.990, Test loss: 0.882, Test accuracy: 68.63
Round  51, Train loss: 0.901, Test loss: 0.877, Test accuracy: 68.70
Round  52, Train loss: 0.885, Test loss: 0.874, Test accuracy: 68.92
Round  53, Train loss: 0.926, Test loss: 0.872, Test accuracy: 69.78
Round  54, Train loss: 1.065, Test loss: 0.877, Test accuracy: 69.21
Round  55, Train loss: 0.932, Test loss: 0.856, Test accuracy: 69.79
Round  56, Train loss: 1.021, Test loss: 0.861, Test accuracy: 69.72
Round  57, Train loss: 1.124, Test loss: 0.868, Test accuracy: 69.70
Round  58, Train loss: 0.863, Test loss: 0.866, Test accuracy: 69.38
Round  59, Train loss: 0.922, Test loss: 0.862, Test accuracy: 69.37
Round  60, Train loss: 1.127, Test loss: 0.866, Test accuracy: 69.08
Round  61, Train loss: 1.118, Test loss: 0.872, Test accuracy: 69.12
Round  62, Train loss: 0.861, Test loss: 0.860, Test accuracy: 69.56
Round  63, Train loss: 0.947, Test loss: 0.858, Test accuracy: 69.81
Round  64, Train loss: 1.030, Test loss: 0.844, Test accuracy: 70.13
Round  65, Train loss: 0.924, Test loss: 0.848, Test accuracy: 69.86
Round  66, Train loss: 0.667, Test loss: 0.847, Test accuracy: 70.13
Round  67, Train loss: 0.821, Test loss: 0.846, Test accuracy: 69.96
Round  68, Train loss: 0.794, Test loss: 0.834, Test accuracy: 70.23
Round  69, Train loss: 0.917, Test loss: 0.834, Test accuracy: 70.16
Round  70, Train loss: 0.948, Test loss: 0.836, Test accuracy: 70.42
Round  71, Train loss: 0.980, Test loss: 0.840, Test accuracy: 70.20
Round  72, Train loss: 1.042, Test loss: 0.842, Test accuracy: 70.53
Round  73, Train loss: 0.734, Test loss: 0.838, Test accuracy: 70.63
Round  74, Train loss: 1.010, Test loss: 0.840, Test accuracy: 70.39
Round  75, Train loss: 0.834, Test loss: 0.826, Test accuracy: 70.63
Round  76, Train loss: 1.047, Test loss: 0.828, Test accuracy: 70.56
Round  77, Train loss: 0.715, Test loss: 0.832, Test accuracy: 70.68
Round  78, Train loss: 0.960, Test loss: 0.829, Test accuracy: 70.39
Round  79, Train loss: 0.676, Test loss: 0.810, Test accuracy: 71.22
Round  80, Train loss: 0.583, Test loss: 0.816, Test accuracy: 70.93
Round  81, Train loss: 0.833, Test loss: 0.817, Test accuracy: 71.11
Round  82, Train loss: 0.911, Test loss: 0.828, Test accuracy: 70.96
Round  83, Train loss: 0.798, Test loss: 0.815, Test accuracy: 71.09
Round  84, Train loss: 0.734, Test loss: 0.821, Test accuracy: 71.20
Round  85, Train loss: 0.877, Test loss: 0.833, Test accuracy: 70.52
Round  86, Train loss: 0.650, Test loss: 0.830, Test accuracy: 70.76
Round  87, Train loss: 0.702, Test loss: 0.821, Test accuracy: 71.25
Round  88, Train loss: 0.794, Test loss: 0.825, Test accuracy: 70.41
Round  89, Train loss: 1.019, Test loss: 0.818, Test accuracy: 70.79
Round  90, Train loss: 0.894, Test loss: 0.827, Test accuracy: 70.67
Round  91, Train loss: 0.959, Test loss: 0.834, Test accuracy: 70.23
Round  92, Train loss: 0.964, Test loss: 0.840, Test accuracy: 70.40
Round  93, Train loss: 0.777, Test loss: 0.839, Test accuracy: 70.10
Round  94, Train loss: 0.638, Test loss: 0.808, Test accuracy: 71.67
Round  95, Train loss: 0.665, Test loss: 0.817, Test accuracy: 71.28
Round  96, Train loss: 0.727, Test loss: 0.827, Test accuracy: 70.30
Round  97, Train loss: 0.751, Test loss: 0.809, Test accuracy: 70.98
Round  98, Train loss: 0.724, Test loss: 0.822, Test accuracy: 70.35
Round  99, Train loss: 0.729, Test loss: 0.804, Test accuracy: 71.01
Final Round, Train loss: 0.727, Test loss: 0.818, Test accuracy: 71.16
Average accuracy final 10 rounds: 70.699
1080.8077518939972
[1.7704732418060303, 3.1728880405426025, 4.636636972427368, 6.052530288696289, 7.509910821914673, 8.981184482574463, 10.312686920166016, 11.585813999176025, 12.894524574279785, 14.271934747695923, 15.622600793838501, 16.955594301223755, 18.305348873138428, 19.631381034851074, 20.981500148773193, 22.302777528762817, 23.62595224380493, 24.95524764060974, 26.298728227615356, 27.657071590423584, 28.983160972595215, 30.292564868927002, 31.627503156661987, 33.00510239601135, 34.34895348548889, 35.72566604614258, 37.0672345161438, 38.46027684211731, 39.81932497024536, 41.21081185340881, 42.52693223953247, 43.84160113334656, 45.19291138648987, 46.54783487319946, 47.90559983253479, 49.22409105300903, 50.567039012908936, 51.93377733230591, 53.2259840965271, 54.51414442062378, 55.81329798698425, 57.124353647232056, 58.52825617790222, 59.85387301445007, 61.185840368270874, 62.58850812911987, 63.90906023979187, 65.28291463851929, 66.61049771308899, 67.88932681083679, 69.26533508300781, 70.61829447746277, 71.99175691604614, 73.35172843933105, 74.71051335334778, 76.06927418708801, 77.42781829833984, 78.80640411376953, 80.1183602809906, 81.42306876182556, 82.74603724479675, 84.09091234207153, 85.37367367744446, 86.78133845329285, 88.15832209587097, 89.54216122627258, 90.88102269172668, 92.21247720718384, 93.61200642585754, 94.95636582374573, 96.29409265518188, 97.63582015037537, 99.000403881073, 100.35679173469543, 101.70773649215698, 103.0490620136261, 104.40020275115967, 105.7196192741394, 107.10197830200195, 108.43734288215637, 109.785231590271, 111.13864707946777, 112.50737190246582, 113.87156629562378, 115.21723437309265, 116.5892345905304, 117.89588665962219, 119.2468490600586, 120.60909962654114, 121.9614429473877, 123.33442950248718, 124.68502974510193, 125.99165225028992, 127.28321719169617, 128.57855105400085, 129.89568853378296, 131.22634768486023, 132.51601600646973, 133.87046456336975, 135.18178009986877, 137.2531316280365]
[12.18, 17.86, 21.69, 26.02, 33.02, 37.12, 37.15, 39.21, 44.21, 46.47, 47.73, 49.47, 50.93, 51.56, 53.05, 54.95, 56.25, 56.88, 57.8, 58.21, 59.66, 59.26, 59.63, 61.09, 61.97, 62.4, 62.79, 63.0, 62.78, 63.22, 63.5, 63.61, 64.5, 64.92, 65.47, 65.83, 65.88, 66.06, 66.85, 66.54, 67.21, 67.23, 67.63, 67.56, 68.02, 68.21, 68.32, 68.43, 68.91, 68.91, 68.63, 68.7, 68.92, 69.78, 69.21, 69.79, 69.72, 69.7, 69.38, 69.37, 69.08, 69.12, 69.56, 69.81, 70.13, 69.86, 70.13, 69.96, 70.23, 70.16, 70.42, 70.2, 70.53, 70.63, 70.39, 70.63, 70.56, 70.68, 70.39, 71.22, 70.93, 71.11, 70.96, 71.09, 71.2, 70.52, 70.76, 71.25, 70.41, 70.79, 70.67, 70.23, 70.4, 70.1, 71.67, 71.28, 70.3, 70.98, 70.35, 71.01, 71.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.721, Test loss: 2.092, Test accuracy: 18.22
Round   0, Global train loss: 1.721, Global test loss: 2.297, Global test accuracy: 14.00
Round   1, Train loss: 1.548, Test loss: 2.040, Test accuracy: 23.62
Round   1, Global train loss: 1.548, Global test loss: 2.383, Global test accuracy: 14.04
Round   2, Train loss: 1.518, Test loss: 2.022, Test accuracy: 28.63
Round   2, Global train loss: 1.518, Global test loss: 2.545, Global test accuracy: 15.11
Round   3, Train loss: 1.448, Test loss: 1.853, Test accuracy: 29.54
Round   3, Global train loss: 1.448, Global test loss: 2.391, Global test accuracy: 12.33
Round   4, Train loss: 1.529, Test loss: 1.554, Test accuracy: 37.65
Round   4, Global train loss: 1.529, Global test loss: 2.278, Global test accuracy: 15.51
Round   5, Train loss: 1.403, Test loss: 1.528, Test accuracy: 40.82
Round   5, Global train loss: 1.403, Global test loss: 2.371, Global test accuracy: 16.59
Round   6, Train loss: 1.313, Test loss: 1.493, Test accuracy: 41.26
Round   6, Global train loss: 1.313, Global test loss: 2.363, Global test accuracy: 14.68
Round   7, Train loss: 1.346, Test loss: 1.428, Test accuracy: 44.30
Round   7, Global train loss: 1.346, Global test loss: 2.364, Global test accuracy: 15.56
Round   8, Train loss: 1.398, Test loss: 1.261, Test accuracy: 50.08
Round   8, Global train loss: 1.398, Global test loss: 2.348, Global test accuracy: 16.48
Round   9, Train loss: 1.319, Test loss: 1.181, Test accuracy: 52.91
Round   9, Global train loss: 1.319, Global test loss: 2.276, Global test accuracy: 15.68
Round  10, Train loss: 1.465, Test loss: 1.159, Test accuracy: 53.22
Round  10, Global train loss: 1.465, Global test loss: 2.365, Global test accuracy: 15.81
Round  11, Train loss: 1.363, Test loss: 1.149, Test accuracy: 54.77
Round  11, Global train loss: 1.363, Global test loss: 2.415, Global test accuracy: 14.15
Round  12, Train loss: 1.361, Test loss: 1.138, Test accuracy: 55.22
Round  12, Global train loss: 1.361, Global test loss: 2.585, Global test accuracy: 13.30
Round  13, Train loss: 1.270, Test loss: 1.124, Test accuracy: 55.99
Round  13, Global train loss: 1.270, Global test loss: 2.402, Global test accuracy: 16.35
Round  14, Train loss: 1.365, Test loss: 1.123, Test accuracy: 55.97
Round  14, Global train loss: 1.365, Global test loss: 2.319, Global test accuracy: 17.39
Round  15, Train loss: 1.298, Test loss: 1.113, Test accuracy: 56.96
Round  15, Global train loss: 1.298, Global test loss: 2.395, Global test accuracy: 16.65
Round  16, Train loss: 1.222, Test loss: 1.109, Test accuracy: 57.51
Round  16, Global train loss: 1.222, Global test loss: 2.369, Global test accuracy: 15.69
Round  17, Train loss: 1.353, Test loss: 1.101, Test accuracy: 57.60
Round  17, Global train loss: 1.353, Global test loss: 2.360, Global test accuracy: 18.43
Round  18, Train loss: 1.219, Test loss: 1.112, Test accuracy: 56.62
Round  18, Global train loss: 1.219, Global test loss: 2.343, Global test accuracy: 17.33
Round  19, Train loss: 1.166, Test loss: 1.103, Test accuracy: 57.21
Round  19, Global train loss: 1.166, Global test loss: 2.339, Global test accuracy: 18.06
Round  20, Train loss: 1.230, Test loss: 1.098, Test accuracy: 57.51
Round  20, Global train loss: 1.230, Global test loss: 2.413, Global test accuracy: 17.15
Round  21, Train loss: 1.327, Test loss: 1.079, Test accuracy: 58.16
Round  21, Global train loss: 1.327, Global test loss: 2.542, Global test accuracy: 15.50
Round  22, Train loss: 1.171, Test loss: 1.085, Test accuracy: 58.58
Round  22, Global train loss: 1.171, Global test loss: 2.339, Global test accuracy: 17.21
Round  23, Train loss: 1.273, Test loss: 1.083, Test accuracy: 58.80
Round  23, Global train loss: 1.273, Global test loss: 2.349, Global test accuracy: 17.14
Round  24, Train loss: 1.124, Test loss: 1.059, Test accuracy: 59.69
Round  24, Global train loss: 1.124, Global test loss: 2.308, Global test accuracy: 18.60
Round  25, Train loss: 1.159, Test loss: 1.071, Test accuracy: 59.64
Round  25, Global train loss: 1.159, Global test loss: 2.411, Global test accuracy: 16.06
Round  26, Train loss: 1.192, Test loss: 1.076, Test accuracy: 59.54
Round  26, Global train loss: 1.192, Global test loss: 2.401, Global test accuracy: 16.62
Round  27, Train loss: 1.113, Test loss: 1.070, Test accuracy: 59.87
Round  27, Global train loss: 1.113, Global test loss: 2.445, Global test accuracy: 15.12
Round  28, Train loss: 1.331, Test loss: 1.079, Test accuracy: 59.61
Round  28, Global train loss: 1.331, Global test loss: 2.401, Global test accuracy: 17.48
Round  29, Train loss: 1.014, Test loss: 1.078, Test accuracy: 59.60
Round  29, Global train loss: 1.014, Global test loss: 2.517, Global test accuracy: 18.47
Round  30, Train loss: 1.219, Test loss: 1.083, Test accuracy: 59.71
Round  30, Global train loss: 1.219, Global test loss: 2.410, Global test accuracy: 15.48
Round  31, Train loss: 1.089, Test loss: 1.083, Test accuracy: 59.27
Round  31, Global train loss: 1.089, Global test loss: 2.415, Global test accuracy: 16.54
Round  32, Train loss: 1.138, Test loss: 1.074, Test accuracy: 60.06
Round  32, Global train loss: 1.138, Global test loss: 2.507, Global test accuracy: 16.64
Round  33, Train loss: 0.950, Test loss: 1.079, Test accuracy: 60.25
Round  33, Global train loss: 0.950, Global test loss: 2.432, Global test accuracy: 17.75
Round  34, Train loss: 1.166, Test loss: 1.085, Test accuracy: 60.11
Round  34, Global train loss: 1.166, Global test loss: 2.407, Global test accuracy: 17.93
Round  35, Train loss: 1.134, Test loss: 1.075, Test accuracy: 60.59
Round  35, Global train loss: 1.134, Global test loss: 2.594, Global test accuracy: 15.66
Round  36, Train loss: 1.109, Test loss: 1.066, Test accuracy: 60.80
Round  36, Global train loss: 1.109, Global test loss: 2.407, Global test accuracy: 18.26
Round  37, Train loss: 0.964, Test loss: 1.050, Test accuracy: 61.15
Round  37, Global train loss: 0.964, Global test loss: 2.564, Global test accuracy: 14.83
Round  38, Train loss: 0.955, Test loss: 1.065, Test accuracy: 60.80
Round  38, Global train loss: 0.955, Global test loss: 2.452, Global test accuracy: 16.94
Round  39, Train loss: 1.149, Test loss: 1.056, Test accuracy: 61.30
Round  39, Global train loss: 1.149, Global test loss: 2.445, Global test accuracy: 18.11
Round  40, Train loss: 1.101, Test loss: 1.069, Test accuracy: 60.73
Round  40, Global train loss: 1.101, Global test loss: 2.530, Global test accuracy: 16.01
Round  41, Train loss: 0.968, Test loss: 1.073, Test accuracy: 60.84
Round  41, Global train loss: 0.968, Global test loss: 2.549, Global test accuracy: 16.67
Round  42, Train loss: 1.047, Test loss: 1.090, Test accuracy: 60.20
Round  42, Global train loss: 1.047, Global test loss: 2.710, Global test accuracy: 15.92
Round  43, Train loss: 0.809, Test loss: 1.085, Test accuracy: 60.72
Round  43, Global train loss: 0.809, Global test loss: 2.645, Global test accuracy: 16.13
Round  44, Train loss: 0.875, Test loss: 1.078, Test accuracy: 61.20
Round  44, Global train loss: 0.875, Global test loss: 2.521, Global test accuracy: 17.94
Round  45, Train loss: 0.975, Test loss: 1.098, Test accuracy: 60.52
Round  45, Global train loss: 0.975, Global test loss: 2.450, Global test accuracy: 18.46
Round  46, Train loss: 0.720, Test loss: 1.093, Test accuracy: 60.45
Round  46, Global train loss: 0.720, Global test loss: 2.549, Global test accuracy: 17.62
Round  47, Train loss: 0.950, Test loss: 1.086, Test accuracy: 60.37
Round  47, Global train loss: 0.950, Global test loss: 2.808, Global test accuracy: 14.63
Round  48, Train loss: 0.987, Test loss: 1.062, Test accuracy: 61.38
Round  48, Global train loss: 0.987, Global test loss: 2.758, Global test accuracy: 17.38
Round  49, Train loss: 0.975, Test loss: 1.062, Test accuracy: 61.30
Round  49, Global train loss: 0.975, Global test loss: 2.657, Global test accuracy: 17.15
Round  50, Train loss: 1.116, Test loss: 1.074, Test accuracy: 60.96
Round  50, Global train loss: 1.116, Global test loss: 2.618, Global test accuracy: 18.64
Round  51, Train loss: 1.040, Test loss: 1.094, Test accuracy: 60.65
Round  51, Global train loss: 1.040, Global test loss: 2.687, Global test accuracy: 18.43
Round  52, Train loss: 0.852, Test loss: 1.085, Test accuracy: 60.98
Round  52, Global train loss: 0.852, Global test loss: 2.710, Global test accuracy: 16.69
Round  53, Train loss: 0.817, Test loss: 1.099, Test accuracy: 60.60
Round  53, Global train loss: 0.817, Global test loss: 2.613, Global test accuracy: 17.86
Round  54, Train loss: 0.976, Test loss: 1.094, Test accuracy: 60.80
Round  54, Global train loss: 0.976, Global test loss: 2.646, Global test accuracy: 16.25
Round  55, Train loss: 0.829, Test loss: 1.090, Test accuracy: 60.63
Round  55, Global train loss: 0.829, Global test loss: 2.576, Global test accuracy: 17.61
Round  56, Train loss: 0.912, Test loss: 1.098, Test accuracy: 60.84
Round  56, Global train loss: 0.912, Global test loss: 2.716, Global test accuracy: 17.52
Round  57, Train loss: 0.937, Test loss: 1.105, Test accuracy: 60.89
Round  57, Global train loss: 0.937, Global test loss: 2.712, Global test accuracy: 17.70
Round  58, Train loss: 0.872, Test loss: 1.104, Test accuracy: 61.08
Round  58, Global train loss: 0.872, Global test loss: 2.629, Global test accuracy: 17.04
Round  59, Train loss: 0.942, Test loss: 1.131, Test accuracy: 60.17
Round  59, Global train loss: 0.942, Global test loss: 2.744, Global test accuracy: 18.74
Round  60, Train loss: 0.763, Test loss: 1.142, Test accuracy: 60.37
Round  60, Global train loss: 0.763, Global test loss: 2.791, Global test accuracy: 15.02
Round  61, Train loss: 0.859, Test loss: 1.152, Test accuracy: 60.07
Round  61, Global train loss: 0.859, Global test loss: 3.048, Global test accuracy: 13.82
Round  62, Train loss: 0.915, Test loss: 1.128, Test accuracy: 60.97
Round  62, Global train loss: 0.915, Global test loss: 2.768, Global test accuracy: 17.27
Round  63, Train loss: 0.985, Test loss: 1.149, Test accuracy: 60.28
Round  63, Global train loss: 0.985, Global test loss: 2.894, Global test accuracy: 18.38
Round  64, Train loss: 0.843, Test loss: 1.147, Test accuracy: 60.77
Round  64, Global train loss: 0.843, Global test loss: 2.840, Global test accuracy: 17.70
Round  65, Train loss: 0.785, Test loss: 1.157, Test accuracy: 60.97
Round  65, Global train loss: 0.785, Global test loss: 2.700, Global test accuracy: 17.90
Round  66, Train loss: 0.690, Test loss: 1.164, Test accuracy: 60.84
Round  66, Global train loss: 0.690, Global test loss: 2.800, Global test accuracy: 17.52
Round  67, Train loss: 0.758, Test loss: 1.149, Test accuracy: 61.50
Round  67, Global train loss: 0.758, Global test loss: 2.837, Global test accuracy: 19.23
Round  68, Train loss: 0.759, Test loss: 1.166, Test accuracy: 60.76
Round  68, Global train loss: 0.759, Global test loss: 3.058, Global test accuracy: 15.28
Round  69, Train loss: 0.927, Test loss: 1.184, Test accuracy: 60.07
Round  69, Global train loss: 0.927, Global test loss: 2.740, Global test accuracy: 18.49
Round  70, Train loss: 0.683, Test loss: 1.172, Test accuracy: 60.65
Round  70, Global train loss: 0.683, Global test loss: 3.007, Global test accuracy: 16.05
Round  71, Train loss: 0.827, Test loss: 1.169, Test accuracy: 60.51
Round  71, Global train loss: 0.827, Global test loss: 2.805, Global test accuracy: 17.44
Round  72, Train loss: 0.934, Test loss: 1.187, Test accuracy: 60.41
Round  72, Global train loss: 0.934, Global test loss: 2.758, Global test accuracy: 16.88
Round  73, Train loss: 0.715, Test loss: 1.197, Test accuracy: 60.32
Round  73, Global train loss: 0.715, Global test loss: 2.877, Global test accuracy: 17.51
Round  74, Train loss: 0.885, Test loss: 1.225, Test accuracy: 59.64
Round  74, Global train loss: 0.885, Global test loss: 3.001, Global test accuracy: 17.09
Round  75, Train loss: 0.781, Test loss: 1.220, Test accuracy: 60.22
Round  75, Global train loss: 0.781, Global test loss: 2.853, Global test accuracy: 15.57
Round  76, Train loss: 0.917, Test loss: 1.203, Test accuracy: 61.08
Round  76, Global train loss: 0.917, Global test loss: 2.664, Global test accuracy: 18.29
Round  77, Train loss: 0.711, Test loss: 1.202, Test accuracy: 60.45
Round  77, Global train loss: 0.711, Global test loss: 2.802, Global test accuracy: 17.72
Round  78, Train loss: 0.795, Test loss: 1.211, Test accuracy: 60.46
Round  78, Global train loss: 0.795, Global test loss: 2.901, Global test accuracy: 16.42
Round  79, Train loss: 0.732, Test loss: 1.213, Test accuracy: 60.33
Round  79, Global train loss: 0.732, Global test loss: 2.869, Global test accuracy: 17.72
Round  80, Train loss: 0.656, Test loss: 1.205, Test accuracy: 61.12
Round  80, Global train loss: 0.656, Global test loss: 3.081, Global test accuracy: 17.29
Round  81, Train loss: 0.721, Test loss: 1.216, Test accuracy: 60.64
Round  81, Global train loss: 0.721, Global test loss: 2.802, Global test accuracy: 17.45
Round  82, Train loss: 0.758, Test loss: 1.221, Test accuracy: 60.97
Round  82, Global train loss: 0.758, Global test loss: 3.137, Global test accuracy: 17.54
Round  83, Train loss: 0.774, Test loss: 1.227, Test accuracy: 60.97
Round  83, Global train loss: 0.774, Global test loss: 2.879, Global test accuracy: 17.66
Round  84, Train loss: 0.633, Test loss: 1.242, Test accuracy: 60.87
Round  84, Global train loss: 0.633, Global test loss: 3.055, Global test accuracy: 17.34
Round  85, Train loss: 0.726, Test loss: 1.218, Test accuracy: 61.18
Round  85, Global train loss: 0.726, Global test loss: 3.103, Global test accuracy: 17.01
Round  86, Train loss: 0.774, Test loss: 1.240, Test accuracy: 60.75
Round  86, Global train loss: 0.774, Global test loss: 2.996, Global test accuracy: 17.58
Round  87, Train loss: 0.761, Test loss: 1.252, Test accuracy: 60.61
Round  87, Global train loss: 0.761, Global test loss: 2.939, Global test accuracy: 18.60
Round  88, Train loss: 0.626, Test loss: 1.265, Test accuracy: 60.49
Round  88, Global train loss: 0.626, Global test loss: 3.116, Global test accuracy: 14.88
Round  89, Train loss: 0.733, Test loss: 1.257, Test accuracy: 60.75
Round  89, Global train loss: 0.733, Global test loss: 2.927, Global test accuracy: 17.00
Round  90, Train loss: 0.587, Test loss: 1.298, Test accuracy: 59.76
Round  90, Global train loss: 0.587, Global test loss: 2.901, Global test accuracy: 17.63
Round  91, Train loss: 0.580, Test loss: 1.277, Test accuracy: 59.72
Round  91, Global train loss: 0.580, Global test loss: 3.196, Global test accuracy: 16.21
Round  92, Train loss: 0.694, Test loss: 1.273, Test accuracy: 60.05
Round  92, Global train loss: 0.694, Global test loss: 3.032, Global test accuracy: 18.75
Round  93, Train loss: 0.604, Test loss: 1.272, Test accuracy: 60.09
Round  93, Global train loss: 0.604, Global test loss: 3.090, Global test accuracy: 16.82
Round  94, Train loss: 0.686, Test loss: 1.312, Test accuracy: 59.35
Round  94, Global train loss: 0.686, Global test loss: 2.962, Global test accuracy: 16.91
Round  95, Train loss: 0.522, Test loss: 1.350, Test accuracy: 58.75
Round  95, Global train loss: 0.522, Global test loss: 3.107, Global test accuracy: 16.22
Round  96, Train loss: 0.753, Test loss: 1.333, Test accuracy: 59.05
Round  96, Global train loss: 0.753, Global test loss: 3.020, Global test accuracy: 18.02
Round  97, Train loss: 0.748, Test loss: 1.357, Test accuracy: 58.98
Round  97, Global train loss: 0.748, Global test loss: 3.336, Global test accuracy: 17.41
Round  98, Train loss: 0.721, Test loss: 1.380, Test accuracy: 58.46
Round  98, Global train loss: 0.721, Global test loss: 2.918, Global test accuracy: 17.64
Round  99, Train loss: 0.634, Test loss: 1.362, Test accuracy: 58.83
Round  99, Global train loss: 0.634, Global test loss: 3.154, Global test accuracy: 17.63
Final Round, Train loss: 0.525, Test loss: 1.490, Test accuracy: 60.04
Final Round, Global train loss: 0.525, Global test loss: 3.154, Global test accuracy: 17.63
Average accuracy final 10 rounds: 59.30400000000001
Average global accuracy final 10 rounds: 17.323999999999998
2385.7350125312805
[1.4751625061035156, 2.541353225708008, 3.6416776180267334, 4.740331172943115, 5.794051885604858, 6.843766689300537, 7.879228115081787, 8.967433214187622, 10.02562689781189, 11.13857889175415, 12.212721824645996, 13.263211250305176, 14.354675769805908, 15.413477420806885, 16.49450945854187, 17.54942798614502, 18.664657831192017, 19.741225242614746, 20.831552982330322, 21.90098524093628, 23.00913715362549, 26.727163553237915, 30.529794931411743, 34.381463289260864, 38.15070724487305, 42.04470491409302, 46.04275441169739, 49.89908051490784, 53.77841663360596, 57.583887577056885, 61.45888137817383, 65.07760977745056, 68.72651648521423, 72.38481569290161, 75.92576837539673, 79.59615778923035, 83.45372772216797, 87.21185684204102, 91.12324166297913, 94.93501782417297, 98.73039364814758, 102.63222670555115, 106.33285641670227, 110.02975034713745, 113.85044550895691, 117.37268805503845, 121.24608492851257, 124.8518397808075, 128.72933053970337, 132.40798830986023, 136.2217755317688, 140.20918607711792, 143.81671619415283, 147.55705499649048, 151.37603163719177, 155.2839093208313, 159.14066648483276, 162.83637619018555, 166.75602197647095, 170.5016176700592, 174.39419078826904, 177.9429533481598, 181.64920043945312, 185.23369646072388, 189.106285572052, 192.8977770805359, 196.77501678466797, 200.85028982162476, 204.75610280036926, 208.8878562450409, 213.06398177146912, 216.92675518989563, 220.8831751346588, 224.92900276184082, 228.9062922000885, 232.7656533718109, 236.58838963508606, 240.5043432712555, 244.3440613746643, 248.3949236869812, 252.1422746181488, 256.19895195961, 260.0483856201172, 264.09360218048096, 268.04758167266846, 271.9212520122528, 275.8299398422241, 279.72771310806274, 283.7306225299835, 287.6320114135742, 291.69787096977234, 295.70689582824707, 299.6782691478729, 303.61914443969727, 307.56394839286804, 311.17529225349426, 314.9244282245636, 318.63594603538513, 321.455628156662, 324.2090780735016, 326.1729483604431]
[18.22, 23.62, 28.63, 29.54, 37.65, 40.82, 41.26, 44.3, 50.08, 52.91, 53.22, 54.77, 55.22, 55.99, 55.97, 56.96, 57.51, 57.6, 56.62, 57.21, 57.51, 58.16, 58.58, 58.8, 59.69, 59.64, 59.54, 59.87, 59.61, 59.6, 59.71, 59.27, 60.06, 60.25, 60.11, 60.59, 60.8, 61.15, 60.8, 61.3, 60.73, 60.84, 60.2, 60.72, 61.2, 60.52, 60.45, 60.37, 61.38, 61.3, 60.96, 60.65, 60.98, 60.6, 60.8, 60.63, 60.84, 60.89, 61.08, 60.17, 60.37, 60.07, 60.97, 60.28, 60.77, 60.97, 60.84, 61.5, 60.76, 60.07, 60.65, 60.51, 60.41, 60.32, 59.64, 60.22, 61.08, 60.45, 60.46, 60.33, 61.12, 60.64, 60.97, 60.97, 60.87, 61.18, 60.75, 60.61, 60.49, 60.75, 59.76, 59.72, 60.05, 60.09, 59.35, 58.75, 59.05, 58.98, 58.46, 58.83, 60.04]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: none, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.564, Test loss: 1.340, Test accuracy: 43.78
Round   0, Global train loss: 1.564, Global test loss: 2.289, Global test accuracy: 13.42
Round   1, Train loss: 1.429, Test loss: 1.227, Test accuracy: 50.66
Round   1, Global train loss: 1.429, Global test loss: 2.271, Global test accuracy: 14.55
Round   2, Train loss: 1.352, Test loss: 1.193, Test accuracy: 53.85
Round   2, Global train loss: 1.352, Global test loss: 2.261, Global test accuracy: 15.73
Round   3, Train loss: 1.298, Test loss: 1.148, Test accuracy: 55.81
Round   3, Global train loss: 1.298, Global test loss: 2.258, Global test accuracy: 15.71
Round   4, Train loss: 1.256, Test loss: 1.138, Test accuracy: 56.72
Round   4, Global train loss: 1.256, Global test loss: 2.260, Global test accuracy: 16.05
Round   5, Train loss: 1.217, Test loss: 1.110, Test accuracy: 57.35
Round   5, Global train loss: 1.217, Global test loss: 2.261, Global test accuracy: 16.25
Round   6, Train loss: 1.182, Test loss: 1.095, Test accuracy: 59.09
Round   6, Global train loss: 1.182, Global test loss: 2.257, Global test accuracy: 16.52
Round   7, Train loss: 1.149, Test loss: 1.111, Test accuracy: 58.91
Round   7, Global train loss: 1.149, Global test loss: 2.262, Global test accuracy: 16.58
Round   8, Train loss: 1.116, Test loss: 1.075, Test accuracy: 59.20
Round   8, Global train loss: 1.116, Global test loss: 2.272, Global test accuracy: 16.24
Round   9, Train loss: 1.086, Test loss: 1.074, Test accuracy: 59.92
Round   9, Global train loss: 1.086, Global test loss: 2.284, Global test accuracy: 16.63
Round  10, Train loss: 1.212, Test loss: 1.072, Test accuracy: 60.01
Round  10, Global train loss: 1.212, Global test loss: 2.414, Global test accuracy: 14.65
Round  11, Train loss: 1.025, Test loss: 1.074, Test accuracy: 60.19
Round  11, Global train loss: 1.025, Global test loss: 2.541, Global test accuracy: 15.72
Round  12, Train loss: 0.991, Test loss: 1.085, Test accuracy: 60.37
Round  12, Global train loss: 0.991, Global test loss: 2.528, Global test accuracy: 14.81
Round  13, Train loss: 0.921, Test loss: 1.119, Test accuracy: 59.13
Round  13, Global train loss: 0.921, Global test loss: 2.749, Global test accuracy: 16.05
Round  14, Train loss: 0.825, Test loss: 1.127, Test accuracy: 59.14
Round  14, Global train loss: 0.825, Global test loss: 2.774, Global test accuracy: 16.11
Round  15, Train loss: 0.868, Test loss: 1.155, Test accuracy: 58.85
Round  15, Global train loss: 0.868, Global test loss: 2.593, Global test accuracy: 14.22
Round  16, Train loss: 0.971, Test loss: 1.156, Test accuracy: 58.81
Round  16, Global train loss: 0.971, Global test loss: 2.692, Global test accuracy: 13.98
Round  17, Train loss: 0.752, Test loss: 1.163, Test accuracy: 59.16
Round  17, Global train loss: 0.752, Global test loss: 2.893, Global test accuracy: 15.53
Round  18, Train loss: 0.941, Test loss: 1.171, Test accuracy: 59.24
Round  18, Global train loss: 0.941, Global test loss: 2.701, Global test accuracy: 13.96
Round  19, Train loss: 0.920, Test loss: 1.176, Test accuracy: 59.77
Round  19, Global train loss: 0.920, Global test loss: 2.858, Global test accuracy: 13.93
Round  20, Train loss: 0.757, Test loss: 1.181, Test accuracy: 60.22
Round  20, Global train loss: 0.757, Global test loss: 3.021, Global test accuracy: 15.46
Round  21, Train loss: 0.764, Test loss: 1.212, Test accuracy: 60.21
Round  21, Global train loss: 0.764, Global test loss: 2.967, Global test accuracy: 13.55
Round  22, Train loss: 0.841, Test loss: 1.223, Test accuracy: 59.55
Round  22, Global train loss: 0.841, Global test loss: 2.799, Global test accuracy: 14.44
Round  23, Train loss: 0.755, Test loss: 1.263, Test accuracy: 59.18
Round  23, Global train loss: 0.755, Global test loss: 3.044, Global test accuracy: 14.34
Round  24, Train loss: 0.670, Test loss: 1.284, Test accuracy: 59.43
Round  24, Global train loss: 0.670, Global test loss: 2.891, Global test accuracy: 16.22
Round  25, Train loss: 0.743, Test loss: 1.287, Test accuracy: 59.57
Round  25, Global train loss: 0.743, Global test loss: 3.073, Global test accuracy: 14.55
Round  26, Train loss: 0.612, Test loss: 1.309, Test accuracy: 59.12
Round  26, Global train loss: 0.612, Global test loss: 2.890, Global test accuracy: 14.41
Round  27, Train loss: 0.662, Test loss: 1.322, Test accuracy: 59.33
Round  27, Global train loss: 0.662, Global test loss: 3.143, Global test accuracy: 14.00
Round  28, Train loss: 0.631, Test loss: 1.346, Test accuracy: 58.44
Round  28, Global train loss: 0.631, Global test loss: 3.046, Global test accuracy: 15.46
Round  29, Train loss: 0.803, Test loss: 1.372, Test accuracy: 58.72
Round  29, Global train loss: 0.803, Global test loss: 3.264, Global test accuracy: 13.98
Round  30, Train loss: 0.572, Test loss: 1.396, Test accuracy: 58.86
Round  30, Global train loss: 0.572, Global test loss: 3.228, Global test accuracy: 15.82
Round  31, Train loss: 0.558, Test loss: 1.393, Test accuracy: 59.18
Round  31, Global train loss: 0.558, Global test loss: 3.281, Global test accuracy: 13.09
Round  32, Train loss: 0.813, Test loss: 1.418, Test accuracy: 58.90
Round  32, Global train loss: 0.813, Global test loss: 3.029, Global test accuracy: 13.68
Round  33, Train loss: 0.599, Test loss: 1.405, Test accuracy: 59.44
Round  33, Global train loss: 0.599, Global test loss: 3.146, Global test accuracy: 15.24
Round  34, Train loss: 0.473, Test loss: 1.413, Test accuracy: 59.26
Round  34, Global train loss: 0.473, Global test loss: 3.623, Global test accuracy: 15.65
Round  35, Train loss: 0.508, Test loss: 1.453, Test accuracy: 58.82
Round  35, Global train loss: 0.508, Global test loss: 3.458, Global test accuracy: 15.20
Round  36, Train loss: 0.566, Test loss: 1.447, Test accuracy: 59.31
Round  36, Global train loss: 0.566, Global test loss: 3.585, Global test accuracy: 15.15
Round  37, Train loss: 0.593, Test loss: 1.484, Test accuracy: 59.33
Round  37, Global train loss: 0.593, Global test loss: 3.742, Global test accuracy: 14.96
Round  38, Train loss: 0.574, Test loss: 1.512, Test accuracy: 59.09
Round  38, Global train loss: 0.574, Global test loss: 3.684, Global test accuracy: 14.76
Round  39, Train loss: 0.476, Test loss: 1.519, Test accuracy: 59.21
Round  39, Global train loss: 0.476, Global test loss: 3.439, Global test accuracy: 15.63
Round  40, Train loss: 0.467, Test loss: 1.508, Test accuracy: 59.94
Round  40, Global train loss: 0.467, Global test loss: 3.615, Global test accuracy: 14.96
Round  41, Train loss: 0.568, Test loss: 1.543, Test accuracy: 59.16
Round  41, Global train loss: 0.568, Global test loss: 3.467, Global test accuracy: 12.23
Round  42, Train loss: 0.501, Test loss: 1.534, Test accuracy: 59.30
Round  42, Global train loss: 0.501, Global test loss: 3.329, Global test accuracy: 15.01
Round  43, Train loss: 0.634, Test loss: 1.564, Test accuracy: 58.93
Round  43, Global train loss: 0.634, Global test loss: 3.282, Global test accuracy: 13.45
Round  44, Train loss: 0.551, Test loss: 1.564, Test accuracy: 58.64
Round  44, Global train loss: 0.551, Global test loss: 3.692, Global test accuracy: 15.78
Round  45, Train loss: 0.577, Test loss: 1.551, Test accuracy: 59.16
Round  45, Global train loss: 0.577, Global test loss: 3.462, Global test accuracy: 13.87
Round  46, Train loss: 0.449, Test loss: 1.569, Test accuracy: 59.31
Round  46, Global train loss: 0.449, Global test loss: 3.671, Global test accuracy: 13.79
Round  47, Train loss: 0.557, Test loss: 1.582, Test accuracy: 59.04
Round  47, Global train loss: 0.557, Global test loss: 3.565, Global test accuracy: 14.08
Round  48, Train loss: 0.406, Test loss: 1.589, Test accuracy: 58.98
Round  48, Global train loss: 0.406, Global test loss: 3.921, Global test accuracy: 15.42
Round  49, Train loss: 0.468, Test loss: 1.603, Test accuracy: 58.55
Round  49, Global train loss: 0.468, Global test loss: 3.437, Global test accuracy: 16.19
Round  50, Train loss: 0.370, Test loss: 1.606, Test accuracy: 58.23
Round  50, Global train loss: 0.370, Global test loss: 3.902, Global test accuracy: 16.07
Round  51, Train loss: 0.336, Test loss: 1.629, Test accuracy: 58.69
Round  51, Global train loss: 0.336, Global test loss: 3.965, Global test accuracy: 17.19
Round  52, Train loss: 0.408, Test loss: 1.646, Test accuracy: 58.95
Round  52, Global train loss: 0.408, Global test loss: 3.596, Global test accuracy: 14.97
Round  53, Train loss: 0.373, Test loss: 1.662, Test accuracy: 59.08
Round  53, Global train loss: 0.373, Global test loss: 3.906, Global test accuracy: 13.12
Round  54, Train loss: 0.462, Test loss: 1.639, Test accuracy: 59.46
Round  54, Global train loss: 0.462, Global test loss: 3.731, Global test accuracy: 13.67
Round  55, Train loss: 0.528, Test loss: 1.657, Test accuracy: 59.33
Round  55, Global train loss: 0.528, Global test loss: 3.897, Global test accuracy: 13.82
Round  56, Train loss: 0.483, Test loss: 1.685, Test accuracy: 59.39
Round  56, Global train loss: 0.483, Global test loss: 3.815, Global test accuracy: 15.03
Round  57, Train loss: 0.452, Test loss: 1.685, Test accuracy: 59.43
Round  57, Global train loss: 0.452, Global test loss: 3.525, Global test accuracy: 14.64
Round  58, Train loss: 0.392, Test loss: 1.696, Test accuracy: 59.29
Round  58, Global train loss: 0.392, Global test loss: 3.769, Global test accuracy: 14.83
Round  59, Train loss: 0.379, Test loss: 1.734, Test accuracy: 59.20
Round  59, Global train loss: 0.379, Global test loss: 4.164, Global test accuracy: 14.28
Round  60, Train loss: 0.539, Test loss: 1.722, Test accuracy: 59.67
Round  60, Global train loss: 0.539, Global test loss: 3.575, Global test accuracy: 14.12
Round  61, Train loss: 0.357, Test loss: 1.720, Test accuracy: 59.26
Round  61, Global train loss: 0.357, Global test loss: 3.988, Global test accuracy: 14.41
Round  62, Train loss: 0.342, Test loss: 1.747, Test accuracy: 59.07
Round  62, Global train loss: 0.342, Global test loss: 4.241, Global test accuracy: 14.91
Round  63, Train loss: 0.405, Test loss: 1.771, Test accuracy: 58.53
Round  63, Global train loss: 0.405, Global test loss: 4.010, Global test accuracy: 15.09
Round  64, Train loss: 0.486, Test loss: 1.779, Test accuracy: 58.69
Round  64, Global train loss: 0.486, Global test loss: 3.931, Global test accuracy: 15.32
Round  65, Train loss: 0.363, Test loss: 1.765, Test accuracy: 58.79
Round  65, Global train loss: 0.363, Global test loss: 3.807, Global test accuracy: 15.25
Round  66, Train loss: 0.412, Test loss: 1.758, Test accuracy: 59.70
Round  66, Global train loss: 0.412, Global test loss: 4.173, Global test accuracy: 15.12
Round  67, Train loss: 0.402, Test loss: 1.780, Test accuracy: 59.09
Round  67, Global train loss: 0.402, Global test loss: 3.749, Global test accuracy: 14.87
Round  68, Train loss: 0.346, Test loss: 1.777, Test accuracy: 59.40
Round  68, Global train loss: 0.346, Global test loss: 3.986, Global test accuracy: 15.51
Round  69, Train loss: 0.442, Test loss: 1.768, Test accuracy: 60.07
Round  69, Global train loss: 0.442, Global test loss: 4.025, Global test accuracy: 15.59
Round  70, Train loss: 0.404, Test loss: 1.788, Test accuracy: 59.93
Round  70, Global train loss: 0.404, Global test loss: 3.920, Global test accuracy: 14.68
Round  71, Train loss: 0.373, Test loss: 1.792, Test accuracy: 59.90
Round  71, Global train loss: 0.373, Global test loss: 4.044, Global test accuracy: 14.69
Round  72, Train loss: 0.358, Test loss: 1.802, Test accuracy: 59.94
Round  72, Global train loss: 0.358, Global test loss: 4.088, Global test accuracy: 15.87
Round  73, Train loss: 0.258, Test loss: 1.794, Test accuracy: 59.94
Round  73, Global train loss: 0.258, Global test loss: 3.868, Global test accuracy: 15.86
Round  74, Train loss: 0.453, Test loss: 1.796, Test accuracy: 59.89
Round  74, Global train loss: 0.453, Global test loss: 3.869, Global test accuracy: 15.07
Round  75, Train loss: 0.389, Test loss: 1.787, Test accuracy: 59.98
Round  75, Global train loss: 0.389, Global test loss: 4.046, Global test accuracy: 14.92
Round  76, Train loss: 0.437, Test loss: 1.806, Test accuracy: 59.20
Round  76, Global train loss: 0.437, Global test loss: 3.775, Global test accuracy: 15.13
Round  77, Train loss: 0.408, Test loss: 1.820, Test accuracy: 58.76
Round  77, Global train loss: 0.408, Global test loss: 3.917, Global test accuracy: 14.50
Round  78, Train loss: 0.427, Test loss: 1.840, Test accuracy: 58.17
Round  78, Global train loss: 0.427, Global test loss: 3.633, Global test accuracy: 14.29
Round  79, Train loss: 0.297, Test loss: 1.837, Test accuracy: 58.25
Round  79, Global train loss: 0.297, Global test loss: 4.054, Global test accuracy: 16.17
Round  80, Train loss: 0.247, Test loss: 1.859, Test accuracy: 58.31
Round  80, Global train loss: 0.247, Global test loss: 3.936, Global test accuracy: 16.38
Round  81, Train loss: 0.229, Test loss: 1.901, Test accuracy: 58.30
Round  81, Global train loss: 0.229, Global test loss: 4.080, Global test accuracy: 16.39
Round  82, Train loss: 0.226, Test loss: 1.886, Test accuracy: 58.63
Round  82, Global train loss: 0.226, Global test loss: 4.096, Global test accuracy: 16.13
Round  83, Train loss: 0.204, Test loss: 1.930, Test accuracy: 58.06
Round  83, Global train loss: 0.204, Global test loss: 4.233, Global test accuracy: 16.13
Round  84, Train loss: 0.204, Test loss: 1.918, Test accuracy: 58.24
Round  84, Global train loss: 0.204, Global test loss: 4.256, Global test accuracy: 16.18
Round  85, Train loss: 0.187, Test loss: 1.939, Test accuracy: 58.08
Round  85, Global train loss: 0.187, Global test loss: 4.275, Global test accuracy: 16.18
Round  86, Train loss: 0.179, Test loss: 1.942, Test accuracy: 58.17
Round  86, Global train loss: 0.179, Global test loss: 4.454, Global test accuracy: 16.11
Round  87, Train loss: 0.185, Test loss: 1.931, Test accuracy: 58.29
Round  87, Global train loss: 0.185, Global test loss: 4.342, Global test accuracy: 15.91
Round  88, Train loss: 0.184, Test loss: 1.924, Test accuracy: 58.41
Round  88, Global train loss: 0.184, Global test loss: 4.363, Global test accuracy: 15.99
Round  89, Train loss: 0.175, Test loss: 1.957, Test accuracy: 58.28
Round  89, Global train loss: 0.175, Global test loss: 4.417, Global test accuracy: 16.22
Round  90, Train loss: 0.392, Test loss: 1.931, Test accuracy: 58.95
Round  90, Global train loss: 0.392, Global test loss: 3.674, Global test accuracy: 15.67
Round  91, Train loss: 0.357, Test loss: 1.968, Test accuracy: 59.22
Round  91, Global train loss: 0.357, Global test loss: 3.649, Global test accuracy: 15.66
Round  92, Train loss: 0.348, Test loss: 2.006, Test accuracy: 58.71
Round  92, Global train loss: 0.348, Global test loss: 3.616, Global test accuracy: 15.23
Round  93, Train loss: 0.337, Test loss: 1.885, Test accuracy: 60.27
Round  93, Global train loss: 0.337, Global test loss: 3.656, Global test accuracy: 15.37
Round  94, Train loss: 0.335, Test loss: 1.971, Test accuracy: 59.07
Round  94, Global train loss: 0.335, Global test loss: 3.660, Global test accuracy: 15.13
Round  95, Train loss: 0.337, Test loss: 1.957, Test accuracy: 58.79
Round  95, Global train loss: 0.337, Global test loss: 3.587, Global test accuracy: 15.12
Round  96, Train loss: 0.322, Test loss: 1.992, Test accuracy: 58.98
Round  96, Global train loss: 0.322, Global test loss: 3.654, Global test accuracy: 15.14
Round  97, Train loss: 0.322, Test loss: 1.949, Test accuracy: 59.66
Round  97, Global train loss: 0.322, Global test loss: 3.677, Global test accuracy: 15.17
Round  98, Train loss: 0.316, Test loss: 2.012, Test accuracy: 59.80
Round  98, Global train loss: 0.316, Global test loss: 3.682, Global test accuracy: 15.35
Round  99, Train loss: 0.316, Test loss: 2.001, Test accuracy: 59.82
Round  99, Global train loss: 0.316, Global test loss: 3.695, Global test accuracy: 15.05
Final Round, Train loss: 0.226, Test loss: 2.216, Test accuracy: 59.62
Final Round, Global train loss: 0.226, Global test loss: 3.695, Global test accuracy: 15.05
Average accuracy final 10 rounds: 59.327
Average global accuracy final 10 rounds: 15.289
2479.449165582657
[2.601749897003174, 4.912194013595581, 7.2237935066223145, 9.518917798995972, 11.849292039871216, 14.158874273300171, 16.466386318206787, 18.784764051437378, 21.105177879333496, 23.43290877342224, 25.751646757125854, 28.081605434417725, 30.39607286453247, 32.716163635253906, 35.027899503707886, 37.34535217285156, 39.66303873062134, 41.97568082809448, 44.296700954437256, 46.614471673965454, 48.92402386665344, 50.897615909576416, 52.86837959289551, 54.840505838394165, 56.80793809890747, 58.77704071998596, 60.74593138694763, 62.71241545677185, 64.68726253509521, 66.65644931793213, 68.62571835517883, 70.58809852600098, 72.5572464466095, 74.52486038208008, 76.489581823349, 78.45463275909424, 80.4192750453949, 82.38396382331848, 84.35225415229797, 86.32337307929993, 88.29633831977844, 90.29630851745605, 92.2927553653717, 94.29559230804443, 96.29477882385254, 98.29016709327698, 100.29308867454529, 102.29584002494812, 104.29808139801025, 106.29717874526978, 108.29920697212219, 110.29328393936157, 112.29521441459656, 114.29490613937378, 116.29224586486816, 118.28855752944946, 120.28340268135071, 122.27883005142212, 124.27492141723633, 126.27527666091919, 128.27173900604248, 130.27249145507812, 132.26868891716003, 134.26278138160706, 136.2642903327942, 138.25814723968506, 140.2572317123413, 142.2541434764862, 144.24927711486816, 146.24145102500916, 148.2409107685089, 150.24184656143188, 152.2534294128418, 154.2551691532135, 156.24744200706482, 158.23945879936218, 160.2380518913269, 162.23126339912415, 164.2266697883606, 166.20845007896423, 168.19428777694702, 170.18796062469482, 172.17671871185303, 174.16918015480042, 176.16336846351624, 178.15687012672424, 180.15009331703186, 182.13706159591675, 184.12941718101501, 186.12492561340332, 188.12766695022583, 190.12641143798828, 192.12249994277954, 194.11446118354797, 196.10186505317688, 198.0975697040558, 200.09265995025635, 202.08680605888367, 204.08412790298462, 206.08048915863037, 210.0576000213623]
[43.78, 50.66, 53.85, 55.81, 56.72, 57.35, 59.09, 58.91, 59.2, 59.92, 60.01, 60.19, 60.37, 59.13, 59.14, 58.85, 58.81, 59.16, 59.24, 59.77, 60.22, 60.21, 59.55, 59.18, 59.43, 59.57, 59.12, 59.33, 58.44, 58.72, 58.86, 59.18, 58.9, 59.44, 59.26, 58.82, 59.31, 59.33, 59.09, 59.21, 59.94, 59.16, 59.3, 58.93, 58.64, 59.16, 59.31, 59.04, 58.98, 58.55, 58.23, 58.69, 58.95, 59.08, 59.46, 59.33, 59.39, 59.43, 59.29, 59.2, 59.67, 59.26, 59.07, 58.53, 58.69, 58.79, 59.7, 59.09, 59.4, 60.07, 59.93, 59.9, 59.94, 59.94, 59.89, 59.98, 59.2, 58.76, 58.17, 58.25, 58.31, 58.3, 58.63, 58.06, 58.24, 58.08, 58.17, 58.29, 58.41, 58.28, 58.95, 59.22, 58.71, 60.27, 59.07, 58.79, 58.98, 59.66, 59.8, 59.82, 59.62]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.569, Test loss: 1.339, Test accuracy: 43.81
Round   0, Global train loss: 1.569, Global test loss: 2.272, Global test accuracy: 16.01
Round   1, Train loss: 1.444, Test loss: 1.275, Test accuracy: 49.03
Round   1, Global train loss: 1.444, Global test loss: 2.281, Global test accuracy: 16.45
Round   2, Train loss: 1.366, Test loss: 1.185, Test accuracy: 52.76
Round   2, Global train loss: 1.366, Global test loss: 2.274, Global test accuracy: 17.45
Round   3, Train loss: 1.307, Test loss: 1.147, Test accuracy: 54.74
Round   3, Global train loss: 1.307, Global test loss: 2.270, Global test accuracy: 17.13
Round   4, Train loss: 1.265, Test loss: 1.136, Test accuracy: 56.77
Round   4, Global train loss: 1.265, Global test loss: 2.266, Global test accuracy: 17.32
Round   5, Train loss: 1.229, Test loss: 1.100, Test accuracy: 57.91
Round   5, Global train loss: 1.229, Global test loss: 2.279, Global test accuracy: 17.41
Round   6, Train loss: 1.194, Test loss: 1.107, Test accuracy: 58.06
Round   6, Global train loss: 1.194, Global test loss: 2.286, Global test accuracy: 17.29
Round   7, Train loss: 1.161, Test loss: 1.061, Test accuracy: 58.80
Round   7, Global train loss: 1.161, Global test loss: 2.288, Global test accuracy: 17.07
Round   8, Train loss: 1.126, Test loss: 1.087, Test accuracy: 58.69
Round   8, Global train loss: 1.126, Global test loss: 2.299, Global test accuracy: 17.35
Round   9, Train loss: 1.092, Test loss: 1.101, Test accuracy: 59.37
Round   9, Global train loss: 1.092, Global test loss: 2.318, Global test accuracy: 17.34
Round  10, Train loss: 1.129, Test loss: 1.080, Test accuracy: 59.35
Round  10, Global train loss: 1.129, Global test loss: 2.609, Global test accuracy: 16.22
Round  11, Train loss: 1.081, Test loss: 1.093, Test accuracy: 59.27
Round  11, Global train loss: 1.081, Global test loss: 2.688, Global test accuracy: 15.54
Round  12, Train loss: 0.862, Test loss: 1.120, Test accuracy: 59.11
Round  12, Global train loss: 0.862, Global test loss: 2.949, Global test accuracy: 13.38
Round  13, Train loss: 0.977, Test loss: 1.120, Test accuracy: 59.25
Round  13, Global train loss: 0.977, Global test loss: 2.614, Global test accuracy: 14.58
Round  14, Train loss: 0.973, Test loss: 1.126, Test accuracy: 59.90
Round  14, Global train loss: 0.973, Global test loss: 2.954, Global test accuracy: 16.42
Round  15, Train loss: 0.866, Test loss: 1.121, Test accuracy: 60.11
Round  15, Global train loss: 0.866, Global test loss: 2.683, Global test accuracy: 14.71
Round  16, Train loss: 0.959, Test loss: 1.124, Test accuracy: 60.04
Round  16, Global train loss: 0.959, Global test loss: 2.578, Global test accuracy: 14.62
Round  17, Train loss: 0.953, Test loss: 1.137, Test accuracy: 59.89
Round  17, Global train loss: 0.953, Global test loss: 2.875, Global test accuracy: 16.35
Round  18, Train loss: 0.878, Test loss: 1.175, Test accuracy: 59.00
Round  18, Global train loss: 0.878, Global test loss: 2.728, Global test accuracy: 13.95
Round  19, Train loss: 0.756, Test loss: 1.159, Test accuracy: 59.89
Round  19, Global train loss: 0.756, Global test loss: 3.132, Global test accuracy: 13.30
Round  20, Train loss: 0.956, Test loss: 1.187, Test accuracy: 60.22
Round  20, Global train loss: 0.956, Global test loss: 3.033, Global test accuracy: 15.24
Round  21, Train loss: 0.752, Test loss: 1.206, Test accuracy: 59.93
Round  21, Global train loss: 0.752, Global test loss: 2.971, Global test accuracy: 15.97
Round  22, Train loss: 0.703, Test loss: 1.236, Test accuracy: 59.75
Round  22, Global train loss: 0.703, Global test loss: 2.997, Global test accuracy: 14.89
Round  23, Train loss: 0.816, Test loss: 1.278, Test accuracy: 59.73
Round  23, Global train loss: 0.816, Global test loss: 3.114, Global test accuracy: 15.87
Round  24, Train loss: 0.710, Test loss: 1.294, Test accuracy: 59.50
Round  24, Global train loss: 0.710, Global test loss: 2.867, Global test accuracy: 14.13
Round  25, Train loss: 0.798, Test loss: 1.308, Test accuracy: 59.74
Round  25, Global train loss: 0.798, Global test loss: 2.986, Global test accuracy: 15.49
Round  26, Train loss: 0.715, Test loss: 1.347, Test accuracy: 58.70
Round  26, Global train loss: 0.715, Global test loss: 3.164, Global test accuracy: 14.85
Round  27, Train loss: 0.656, Test loss: 1.361, Test accuracy: 58.94
Round  27, Global train loss: 0.656, Global test loss: 3.414, Global test accuracy: 13.71
Round  28, Train loss: 0.755, Test loss: 1.395, Test accuracy: 58.60
Round  28, Global train loss: 0.755, Global test loss: 3.334, Global test accuracy: 14.26
Round  29, Train loss: 0.645, Test loss: 1.408, Test accuracy: 58.99
Round  29, Global train loss: 0.645, Global test loss: 3.157, Global test accuracy: 14.55
Round  30, Train loss: 0.647, Test loss: 1.415, Test accuracy: 58.92
Round  30, Global train loss: 0.647, Global test loss: 3.375, Global test accuracy: 15.98
Round  31, Train loss: 0.537, Test loss: 1.409, Test accuracy: 59.19
Round  31, Global train loss: 0.537, Global test loss: 3.587, Global test accuracy: 14.24
Round  32, Train loss: 0.770, Test loss: 1.435, Test accuracy: 58.22
Round  32, Global train loss: 0.770, Global test loss: 3.136, Global test accuracy: 14.20
Round  33, Train loss: 0.438, Test loss: 1.452, Test accuracy: 58.37
Round  33, Global train loss: 0.438, Global test loss: 3.362, Global test accuracy: 13.18
Round  34, Train loss: 0.717, Test loss: 1.475, Test accuracy: 58.50
Round  34, Global train loss: 0.717, Global test loss: 3.373, Global test accuracy: 14.04
Round  35, Train loss: 0.611, Test loss: 1.521, Test accuracy: 57.85
Round  35, Global train loss: 0.611, Global test loss: 3.687, Global test accuracy: 14.98
Round  36, Train loss: 0.620, Test loss: 1.501, Test accuracy: 58.83
Round  36, Global train loss: 0.620, Global test loss: 3.742, Global test accuracy: 15.87
Round  37, Train loss: 0.534, Test loss: 1.548, Test accuracy: 58.73
Round  37, Global train loss: 0.534, Global test loss: 3.407, Global test accuracy: 14.59
Round  38, Train loss: 0.501, Test loss: 1.552, Test accuracy: 58.56
Round  38, Global train loss: 0.501, Global test loss: 4.056, Global test accuracy: 13.32
Round  39, Train loss: 0.606, Test loss: 1.535, Test accuracy: 58.91
Round  39, Global train loss: 0.606, Global test loss: 3.643, Global test accuracy: 13.44
Round  40, Train loss: 0.539, Test loss: 1.574, Test accuracy: 58.41
Round  40, Global train loss: 0.539, Global test loss: 3.751, Global test accuracy: 15.11
Round  41, Train loss: 0.572, Test loss: 1.575, Test accuracy: 58.60
Round  41, Global train loss: 0.572, Global test loss: 3.922, Global test accuracy: 14.36
Round  42, Train loss: 0.648, Test loss: 1.565, Test accuracy: 58.64
Round  42, Global train loss: 0.648, Global test loss: 3.771, Global test accuracy: 13.28
Round  43, Train loss: 0.530, Test loss: 1.618, Test accuracy: 58.22
Round  43, Global train loss: 0.530, Global test loss: 3.508, Global test accuracy: 14.82
Round  44, Train loss: 0.558, Test loss: 1.614, Test accuracy: 58.51
Round  44, Global train loss: 0.558, Global test loss: 3.339, Global test accuracy: 14.62
Round  45, Train loss: 0.578, Test loss: 1.633, Test accuracy: 58.59
Round  45, Global train loss: 0.578, Global test loss: 3.630, Global test accuracy: 13.32
Round  46, Train loss: 0.432, Test loss: 1.649, Test accuracy: 58.60
Round  46, Global train loss: 0.432, Global test loss: 3.719, Global test accuracy: 12.70
Round  47, Train loss: 0.394, Test loss: 1.634, Test accuracy: 58.69
Round  47, Global train loss: 0.394, Global test loss: 3.808, Global test accuracy: 13.57
Round  48, Train loss: 0.454, Test loss: 1.651, Test accuracy: 58.79
Round  48, Global train loss: 0.454, Global test loss: 3.619, Global test accuracy: 14.73
Round  49, Train loss: 0.506, Test loss: 1.632, Test accuracy: 59.19
Round  49, Global train loss: 0.506, Global test loss: 3.953, Global test accuracy: 14.14
Round  50, Train loss: 0.511, Test loss: 1.641, Test accuracy: 59.26
Round  50, Global train loss: 0.511, Global test loss: 3.917, Global test accuracy: 14.66
Round  51, Train loss: 0.472, Test loss: 1.674, Test accuracy: 59.37
Round  51, Global train loss: 0.472, Global test loss: 4.120, Global test accuracy: 14.87
Round  52, Train loss: 0.392, Test loss: 1.679, Test accuracy: 59.35
Round  52, Global train loss: 0.392, Global test loss: 4.147, Global test accuracy: 13.44
Round  53, Train loss: 0.394, Test loss: 1.691, Test accuracy: 59.56
Round  53, Global train loss: 0.394, Global test loss: 3.988, Global test accuracy: 13.84
Round  54, Train loss: 0.506, Test loss: 1.730, Test accuracy: 58.74
Round  54, Global train loss: 0.506, Global test loss: 3.769, Global test accuracy: 14.33
Round  55, Train loss: 0.495, Test loss: 1.713, Test accuracy: 58.70
Round  55, Global train loss: 0.495, Global test loss: 3.614, Global test accuracy: 15.34
Round  56, Train loss: 0.449, Test loss: 1.711, Test accuracy: 59.04
Round  56, Global train loss: 0.449, Global test loss: 4.368, Global test accuracy: 15.07
Round  57, Train loss: 0.518, Test loss: 1.730, Test accuracy: 59.14
Round  57, Global train loss: 0.518, Global test loss: 3.771, Global test accuracy: 14.85
Round  58, Train loss: 0.311, Test loss: 1.733, Test accuracy: 59.31
Round  58, Global train loss: 0.311, Global test loss: 3.988, Global test accuracy: 14.59
Round  59, Train loss: 0.339, Test loss: 1.750, Test accuracy: 59.07
Round  59, Global train loss: 0.339, Global test loss: 4.180, Global test accuracy: 13.72
Round  60, Train loss: 0.391, Test loss: 1.763, Test accuracy: 59.04
Round  60, Global train loss: 0.391, Global test loss: 3.877, Global test accuracy: 16.08
Round  61, Train loss: 0.369, Test loss: 1.785, Test accuracy: 58.94
Round  61, Global train loss: 0.369, Global test loss: 4.337, Global test accuracy: 13.66
Round  62, Train loss: 0.348, Test loss: 1.807, Test accuracy: 58.47
Round  62, Global train loss: 0.348, Global test loss: 4.296, Global test accuracy: 14.69
Round  63, Train loss: 0.527, Test loss: 1.794, Test accuracy: 58.43
Round  63, Global train loss: 0.527, Global test loss: 3.951, Global test accuracy: 13.48
Round  64, Train loss: 0.510, Test loss: 1.802, Test accuracy: 58.05
Round  64, Global train loss: 0.510, Global test loss: 3.768, Global test accuracy: 13.77
Round  65, Train loss: 0.390, Test loss: 1.825, Test accuracy: 58.16
Round  65, Global train loss: 0.390, Global test loss: 4.254, Global test accuracy: 13.97
Round  66, Train loss: 0.358, Test loss: 1.856, Test accuracy: 57.76
Round  66, Global train loss: 0.358, Global test loss: 4.079, Global test accuracy: 13.02
Round  67, Train loss: 0.392, Test loss: 1.834, Test accuracy: 58.35
Round  67, Global train loss: 0.392, Global test loss: 3.815, Global test accuracy: 14.25
Round  68, Train loss: 0.446, Test loss: 1.840, Test accuracy: 58.62
Round  68, Global train loss: 0.446, Global test loss: 3.900, Global test accuracy: 12.57
Round  69, Train loss: 0.395, Test loss: 1.849, Test accuracy: 58.56
Round  69, Global train loss: 0.395, Global test loss: 4.037, Global test accuracy: 15.03
Round  70, Train loss: 0.409, Test loss: 1.873, Test accuracy: 58.33
Round  70, Global train loss: 0.409, Global test loss: 3.950, Global test accuracy: 12.98
Round  71, Train loss: 0.386, Test loss: 1.855, Test accuracy: 58.80
Round  71, Global train loss: 0.386, Global test loss: 4.208, Global test accuracy: 14.68
Round  72, Train loss: 0.404, Test loss: 1.857, Test accuracy: 58.81
Round  72, Global train loss: 0.404, Global test loss: 4.119, Global test accuracy: 14.41
Round  73, Train loss: 0.312, Test loss: 1.870, Test accuracy: 59.21
Round  73, Global train loss: 0.312, Global test loss: 4.318, Global test accuracy: 13.40
Round  74, Train loss: 0.483, Test loss: 1.903, Test accuracy: 59.34
Round  74, Global train loss: 0.483, Global test loss: 4.166, Global test accuracy: 13.96
Round  75, Train loss: 0.386, Test loss: 1.937, Test accuracy: 59.14
Round  75, Global train loss: 0.386, Global test loss: 4.119, Global test accuracy: 15.15
Round  76, Train loss: 0.429, Test loss: 1.915, Test accuracy: 59.24
Round  76, Global train loss: 0.429, Global test loss: 4.148, Global test accuracy: 13.96
Round  77, Train loss: 0.423, Test loss: 1.920, Test accuracy: 59.31
Round  77, Global train loss: 0.423, Global test loss: 4.233, Global test accuracy: 12.96
Round  78, Train loss: 0.432, Test loss: 1.913, Test accuracy: 59.92
Round  78, Global train loss: 0.432, Global test loss: 4.217, Global test accuracy: 15.88
Round  79, Train loss: 0.371, Test loss: 1.914, Test accuracy: 59.67
Round  79, Global train loss: 0.371, Global test loss: 4.162, Global test accuracy: 13.10
Round  80, Train loss: 0.276, Test loss: 1.908, Test accuracy: 59.52
Round  80, Global train loss: 0.276, Global test loss: 4.103, Global test accuracy: 14.51
Round  81, Train loss: 0.253, Test loss: 1.926, Test accuracy: 59.22
Round  81, Global train loss: 0.253, Global test loss: 4.097, Global test accuracy: 14.57
Round  82, Train loss: 0.235, Test loss: 1.930, Test accuracy: 59.70
Round  82, Global train loss: 0.235, Global test loss: 4.312, Global test accuracy: 13.89
Round  83, Train loss: 0.222, Test loss: 1.949, Test accuracy: 59.20
Round  83, Global train loss: 0.222, Global test loss: 4.503, Global test accuracy: 14.05
Round  84, Train loss: 0.216, Test loss: 1.953, Test accuracy: 59.27
Round  84, Global train loss: 0.216, Global test loss: 4.463, Global test accuracy: 14.03
Round  85, Train loss: 0.202, Test loss: 1.967, Test accuracy: 59.35
Round  85, Global train loss: 0.202, Global test loss: 4.668, Global test accuracy: 14.11
Round  86, Train loss: 0.197, Test loss: 1.981, Test accuracy: 59.42
Round  86, Global train loss: 0.197, Global test loss: 4.598, Global test accuracy: 14.04
Round  87, Train loss: 0.199, Test loss: 1.976, Test accuracy: 59.54
Round  87, Global train loss: 0.199, Global test loss: 4.614, Global test accuracy: 13.85
Round  88, Train loss: 0.187, Test loss: 1.964, Test accuracy: 59.81
Round  88, Global train loss: 0.187, Global test loss: 4.604, Global test accuracy: 14.38
Round  89, Train loss: 0.174, Test loss: 1.992, Test accuracy: 59.41
Round  89, Global train loss: 0.174, Global test loss: 4.773, Global test accuracy: 13.89
Round  90, Train loss: 0.382, Test loss: 1.961, Test accuracy: 59.73
Round  90, Global train loss: 0.382, Global test loss: 3.815, Global test accuracy: 15.01
Round  91, Train loss: 0.351, Test loss: 1.948, Test accuracy: 59.72
Round  91, Global train loss: 0.351, Global test loss: 3.755, Global test accuracy: 14.94
Round  92, Train loss: 0.338, Test loss: 1.993, Test accuracy: 59.50
Round  92, Global train loss: 0.338, Global test loss: 3.784, Global test accuracy: 14.54
Round  93, Train loss: 0.329, Test loss: 2.025, Test accuracy: 58.93
Round  93, Global train loss: 0.329, Global test loss: 3.786, Global test accuracy: 14.79
Round  94, Train loss: 0.323, Test loss: 1.985, Test accuracy: 59.45
Round  94, Global train loss: 0.323, Global test loss: 3.800, Global test accuracy: 14.63
Round  95, Train loss: 0.314, Test loss: 2.031, Test accuracy: 59.85
Round  95, Global train loss: 0.314, Global test loss: 3.883, Global test accuracy: 14.83
Round  96, Train loss: 0.316, Test loss: 2.074, Test accuracy: 59.30
Round  96, Global train loss: 0.316, Global test loss: 3.833, Global test accuracy: 14.98
Round  97, Train loss: 0.311, Test loss: 2.041, Test accuracy: 59.16
Round  97, Global train loss: 0.311, Global test loss: 3.837, Global test accuracy: 14.61
Round  98, Train loss: 0.309, Test loss: 1.984, Test accuracy: 60.05
Round  98, Global train loss: 0.309, Global test loss: 3.842, Global test accuracy: 14.41
Round  99, Train loss: 0.304, Test loss: 1.989, Test accuracy: 59.72
Round  99, Global train loss: 0.304, Global test loss: 3.850, Global test accuracy: 14.68
Final Round, Train loss: 0.220, Test loss: 2.282, Test accuracy: 58.96
Final Round, Global train loss: 0.220, Global test loss: 3.850, Global test accuracy: 14.68
Average accuracy final 10 rounds: 59.541000000000004
Average global accuracy final 10 rounds: 14.742
4602.450555801392
[2.6014137268066406, 4.616820573806763, 6.628173828125, 8.638951063156128, 10.654390573501587, 12.66926884651184, 14.68349289894104, 16.69453477859497, 18.704927682876587, 20.699026346206665, 22.70194125175476, 24.71351647377014, 26.722266674041748, 28.732043027877808, 30.74468445777893, 32.757328748703, 34.767722368240356, 36.77752113342285, 38.79336476325989, 40.78580927848816, 42.78619074821472, 48.370232582092285, 53.9281792640686, 59.51153755187988, 65.09949517250061, 70.69813561439514, 76.25853991508484, 81.83246898651123, 87.3997950553894, 92.92060923576355, 98.48450231552124, 104.07254242897034, 109.61899590492249, 115.17600083351135, 120.72830748558044, 126.27673125267029, 131.81959581375122, 137.3774287700653, 142.91559076309204, 148.48276567459106, 154.09722518920898, 159.69927096366882, 165.35535836219788, 170.98881554603577, 176.59091806411743, 182.19171357154846, 187.71500444412231, 192.78522181510925, 197.7958219051361, 202.7952618598938, 207.8133819103241, 212.7949080467224, 217.7902376651764, 222.7896785736084, 227.76588559150696, 232.75648951530457, 237.7395384311676, 242.7278904914856, 247.7077407836914, 252.70954585075378, 257.6851017475128, 262.7088553905487, 267.7473051548004, 272.8581156730652, 277.88858294487, 282.93147826194763, 287.9584798812866, 292.99052381515503, 298.0332074165344, 303.080246925354, 308.1296489238739, 313.04664754867554, 317.9621477127075, 322.92240023612976, 327.95920634269714, 332.9810953140259, 337.9873080253601, 343.00912642478943, 348.5145001411438, 354.03302216529846, 359.49916911125183, 365.02754855155945, 370.5305781364441, 376.02972435951233, 381.5156524181366, 387.0060155391693, 392.45150995254517, 397.9138650894165, 403.41122937202454, 408.90961742401123, 414.4075882434845, 419.91799306869507, 425.41285824775696, 431.2402687072754, 437.1417145729065, 443.01578307151794, 448.86028242111206, 454.72020959854126, 460.56953263282776, 466.43700981140137, 470.4555866718292]
[43.81, 49.03, 52.76, 54.74, 56.77, 57.91, 58.06, 58.8, 58.69, 59.37, 59.35, 59.27, 59.11, 59.25, 59.9, 60.11, 60.04, 59.89, 59.0, 59.89, 60.22, 59.93, 59.75, 59.73, 59.5, 59.74, 58.7, 58.94, 58.6, 58.99, 58.92, 59.19, 58.22, 58.37, 58.5, 57.85, 58.83, 58.73, 58.56, 58.91, 58.41, 58.6, 58.64, 58.22, 58.51, 58.59, 58.6, 58.69, 58.79, 59.19, 59.26, 59.37, 59.35, 59.56, 58.74, 58.7, 59.04, 59.14, 59.31, 59.07, 59.04, 58.94, 58.47, 58.43, 58.05, 58.16, 57.76, 58.35, 58.62, 58.56, 58.33, 58.8, 58.81, 59.21, 59.34, 59.14, 59.24, 59.31, 59.92, 59.67, 59.52, 59.22, 59.7, 59.2, 59.27, 59.35, 59.42, 59.54, 59.81, 59.41, 59.73, 59.72, 59.5, 58.93, 59.45, 59.85, 59.3, 59.16, 60.05, 59.72, 58.96]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.752, Test loss: 1.834, Test accuracy: 21.75
Round   1, Train loss: 1.516, Test loss: 1.579, Test accuracy: 27.89
Round   2, Train loss: 1.424, Test loss: 1.399, Test accuracy: 37.31
Round   3, Train loss: 1.355, Test loss: 1.297, Test accuracy: 44.76
Round   4, Train loss: 1.302, Test loss: 1.243, Test accuracy: 48.41
Round   5, Train loss: 1.262, Test loss: 1.173, Test accuracy: 52.41
Round   6, Train loss: 1.226, Test loss: 1.103, Test accuracy: 57.24
Round   7, Train loss: 1.192, Test loss: 1.072, Test accuracy: 58.28
Round   8, Train loss: 1.162, Test loss: 1.055, Test accuracy: 58.99
Round   9, Train loss: 1.136, Test loss: 1.008, Test accuracy: 61.46
Round  10, Train loss: 1.112, Test loss: 0.987, Test accuracy: 62.82
Round  11, Train loss: 1.086, Test loss: 0.968, Test accuracy: 63.85
Round  12, Train loss: 1.062, Test loss: 0.959, Test accuracy: 64.02
Round  13, Train loss: 1.039, Test loss: 0.945, Test accuracy: 64.63
Round  14, Train loss: 1.019, Test loss: 0.924, Test accuracy: 65.69
Round  15, Train loss: 0.998, Test loss: 0.914, Test accuracy: 66.52
Round  16, Train loss: 0.982, Test loss: 0.925, Test accuracy: 66.10
Round  17, Train loss: 0.961, Test loss: 0.909, Test accuracy: 66.34
Round  18, Train loss: 0.943, Test loss: 0.916, Test accuracy: 66.13
Round  19, Train loss: 0.922, Test loss: 0.901, Test accuracy: 67.15
Round  20, Train loss: 0.922, Test loss: 0.917, Test accuracy: 66.20
Round  21, Train loss: 0.972, Test loss: 0.917, Test accuracy: 66.54
Round  22, Train loss: 0.808, Test loss: 0.908, Test accuracy: 66.92
Round  23, Train loss: 1.026, Test loss: 0.929, Test accuracy: 66.23
Round  24, Train loss: 0.794, Test loss: 0.895, Test accuracy: 67.28
Round  25, Train loss: 0.928, Test loss: 0.919, Test accuracy: 66.69
Round  26, Train loss: 0.870, Test loss: 0.934, Test accuracy: 66.22
Round  27, Train loss: 0.821, Test loss: 0.937, Test accuracy: 66.54
Round  28, Train loss: 0.849, Test loss: 0.941, Test accuracy: 66.49
Round  29, Train loss: 0.769, Test loss: 0.929, Test accuracy: 66.66
Round  30, Train loss: 0.838, Test loss: 0.942, Test accuracy: 66.62
Round  31, Train loss: 0.830, Test loss: 0.959, Test accuracy: 66.50
Round  32, Train loss: 0.708, Test loss: 0.920, Test accuracy: 67.10
Round  33, Train loss: 0.754, Test loss: 0.944, Test accuracy: 66.63
Round  34, Train loss: 0.750, Test loss: 0.940, Test accuracy: 67.32
Round  35, Train loss: 0.723, Test loss: 0.950, Test accuracy: 66.72
Round  36, Train loss: 0.722, Test loss: 0.971, Test accuracy: 66.09
Round  37, Train loss: 0.633, Test loss: 0.953, Test accuracy: 66.76
Round  38, Train loss: 0.672, Test loss: 0.958, Test accuracy: 66.60
Round  39, Train loss: 0.765, Test loss: 0.968, Test accuracy: 66.17
Round  40, Train loss: 0.629, Test loss: 1.000, Test accuracy: 65.56
Round  41, Train loss: 0.596, Test loss: 0.988, Test accuracy: 66.21
Round  42, Train loss: 0.769, Test loss: 0.993, Test accuracy: 66.06
Round  43, Train loss: 0.540, Test loss: 0.989, Test accuracy: 66.05
Round  44, Train loss: 0.621, Test loss: 0.993, Test accuracy: 66.28
Round  45, Train loss: 0.517, Test loss: 0.999, Test accuracy: 66.11
Round  46, Train loss: 0.441, Test loss: 0.999, Test accuracy: 67.17
Round  47, Train loss: 0.579, Test loss: 1.017, Test accuracy: 66.41
Round  48, Train loss: 0.735, Test loss: 1.032, Test accuracy: 65.80
Round  49, Train loss: 0.563, Test loss: 1.030, Test accuracy: 65.89
Round  50, Train loss: 0.716, Test loss: 1.057, Test accuracy: 65.49
Round  51, Train loss: 0.624, Test loss: 1.064, Test accuracy: 65.58
Round  52, Train loss: 0.450, Test loss: 1.056, Test accuracy: 65.32
Round  53, Train loss: 0.590, Test loss: 1.065, Test accuracy: 65.20
Round  54, Train loss: 0.666, Test loss: 1.102, Test accuracy: 64.77
Round  55, Train loss: 0.649, Test loss: 1.093, Test accuracy: 65.03
Round  56, Train loss: 0.598, Test loss: 1.109, Test accuracy: 64.54
Round  57, Train loss: 0.496, Test loss: 1.107, Test accuracy: 65.01
Round  58, Train loss: 0.423, Test loss: 1.129, Test accuracy: 64.65
Round  59, Train loss: 0.602, Test loss: 1.202, Test accuracy: 63.49
Round  60, Train loss: 0.492, Test loss: 1.187, Test accuracy: 63.52
Round  61, Train loss: 0.427, Test loss: 1.204, Test accuracy: 63.54
Round  62, Train loss: 0.470, Test loss: 1.227, Test accuracy: 62.85
Round  63, Train loss: 0.557, Test loss: 1.217, Test accuracy: 62.72
Round  64, Train loss: 0.535, Test loss: 1.173, Test accuracy: 63.21
Round  65, Train loss: 0.562, Test loss: 1.218, Test accuracy: 62.75
Round  66, Train loss: 0.595, Test loss: 1.185, Test accuracy: 62.92
Round  67, Train loss: 0.503, Test loss: 1.196, Test accuracy: 63.35
Round  68, Train loss: 0.577, Test loss: 1.220, Test accuracy: 63.67
Round  69, Train loss: 0.536, Test loss: 1.229, Test accuracy: 63.85
Round  70, Train loss: 0.447, Test loss: 1.202, Test accuracy: 63.72
Round  71, Train loss: 0.526, Test loss: 1.185, Test accuracy: 64.60
Round  72, Train loss: 0.504, Test loss: 1.209, Test accuracy: 63.77
Round  73, Train loss: 0.441, Test loss: 1.240, Test accuracy: 63.68
Round  74, Train loss: 0.489, Test loss: 1.221, Test accuracy: 63.97
Round  75, Train loss: 0.401, Test loss: 1.204, Test accuracy: 64.46
Round  76, Train loss: 0.486, Test loss: 1.211, Test accuracy: 64.50
Round  77, Train loss: 0.400, Test loss: 1.199, Test accuracy: 64.81
Round  78, Train loss: 0.458, Test loss: 1.201, Test accuracy: 64.49
Round  79, Train loss: 0.433, Test loss: 1.229, Test accuracy: 63.70
Round  80, Train loss: 0.292, Test loss: 1.223, Test accuracy: 64.37
Round  81, Train loss: 0.272, Test loss: 1.257, Test accuracy: 64.46
Round  82, Train loss: 0.257, Test loss: 1.263, Test accuracy: 64.22
Round  83, Train loss: 0.240, Test loss: 1.268, Test accuracy: 64.73
Round  84, Train loss: 0.233, Test loss: 1.294, Test accuracy: 64.70
Round  85, Train loss: 0.219, Test loss: 1.303, Test accuracy: 64.53
Round  86, Train loss: 0.206, Test loss: 1.328, Test accuracy: 64.61
Round  87, Train loss: 0.209, Test loss: 1.317, Test accuracy: 64.17
Round  88, Train loss: 0.206, Test loss: 1.340, Test accuracy: 64.50
Round  89, Train loss: 0.202, Test loss: 1.363, Test accuracy: 64.69
Round  90, Train loss: 0.412, Test loss: 1.326, Test accuracy: 64.19
Round  91, Train loss: 0.392, Test loss: 1.313, Test accuracy: 64.13
Round  92, Train loss: 0.383, Test loss: 1.314, Test accuracy: 63.87
Round  93, Train loss: 0.371, Test loss: 1.325, Test accuracy: 63.88
Round  94, Train loss: 0.365, Test loss: 1.319, Test accuracy: 64.27
Round  95, Train loss: 0.360, Test loss: 1.310, Test accuracy: 64.10
Round  96, Train loss: 0.354, Test loss: 1.370, Test accuracy: 63.62
Round  97, Train loss: 0.354, Test loss: 1.398, Test accuracy: 62.82
Round  98, Train loss: 0.351, Test loss: 1.347, Test accuracy: 64.30
Round  99, Train loss: 0.350, Test loss: 1.333, Test accuracy: 64.31
Final Round, Train loss: 0.312, Test loss: 1.356, Test accuracy: 64.28
Average accuracy final 10 rounds: 63.94899999999999
3827.6942422389984
[2.422907829284668, 4.53792142868042, 6.6479737758636475, 8.765812158584595, 10.859309196472168, 12.963421821594238, 15.08054780960083, 17.19101071357727, 19.30808663368225, 21.419199228286743, 23.504392862319946, 25.598389625549316, 27.709214210510254, 29.824089527130127, 31.94067120552063, 34.05969047546387, 36.169989824295044, 38.28000020980835, 40.37310028076172, 42.46513485908508, 44.5554986000061, 49.0068564414978, 53.48028373718262, 58.027453899383545, 62.44410443305969, 66.85065960884094, 71.2954249382019, 75.81157922744751, 80.31318974494934, 84.70140051841736, 89.12631058692932, 93.54534029960632, 97.99702405929565, 102.47337126731873, 107.01432085037231, 111.41733837127686, 115.81433606147766, 120.23415875434875, 124.87333250045776, 129.30295276641846, 133.70616269111633, 138.1621596813202, 142.60295820236206, 147.087012052536, 151.23825883865356, 155.4124457836151, 159.5365707874298, 163.765123128891, 168.00893449783325, 172.19698524475098, 176.40546536445618, 180.62393927574158, 184.87378096580505, 189.11716532707214, 193.2916715145111, 197.45570921897888, 201.57351541519165, 205.6343162059784, 209.61763405799866, 213.6613335609436, 217.74745059013367, 221.8172435760498, 225.8379979133606, 229.87500429153442, 233.88773918151855, 237.9231550693512, 242.0149848461151, 246.1078441143036, 250.17234826087952, 254.24195528030396, 258.2223222255707, 262.2915403842926, 266.2723116874695, 270.3133137226105, 274.2439088821411, 278.18339109420776, 282.20788741111755, 286.3083996772766, 290.3721070289612, 294.40307903289795, 298.5835485458374, 302.8390517234802, 306.78054332733154, 310.7002058029175, 314.6504337787628, 318.61823415756226, 322.59602761268616, 326.5549898147583, 330.5869462490082, 334.61262679100037, 338.6411557197571, 342.87259888648987, 347.1309759616852, 351.40452766418457, 355.6926865577698, 359.96212339401245, 364.21830677986145, 368.4806487560272, 372.76094913482666, 377.0168125629425, 380.77343463897705]
[21.75, 27.89, 37.31, 44.76, 48.41, 52.41, 57.24, 58.28, 58.99, 61.46, 62.82, 63.85, 64.02, 64.63, 65.69, 66.52, 66.1, 66.34, 66.13, 67.15, 66.2, 66.54, 66.92, 66.23, 67.28, 66.69, 66.22, 66.54, 66.49, 66.66, 66.62, 66.5, 67.1, 66.63, 67.32, 66.72, 66.09, 66.76, 66.6, 66.17, 65.56, 66.21, 66.06, 66.05, 66.28, 66.11, 67.17, 66.41, 65.8, 65.89, 65.49, 65.58, 65.32, 65.2, 64.77, 65.03, 64.54, 65.01, 64.65, 63.49, 63.52, 63.54, 62.85, 62.72, 63.21, 62.75, 62.92, 63.35, 63.67, 63.85, 63.72, 64.6, 63.77, 63.68, 63.97, 64.46, 64.5, 64.81, 64.49, 63.7, 64.37, 64.46, 64.22, 64.73, 64.7, 64.53, 64.61, 64.17, 64.5, 64.69, 64.19, 64.13, 63.87, 63.88, 64.27, 64.1, 63.62, 62.82, 64.3, 64.31, 64.28]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.732, Test loss: 1.767, Test accuracy: 22.55
Round   1, Train loss: 1.488, Test loss: 1.558, Test accuracy: 30.14
Round   2, Train loss: 1.396, Test loss: 1.388, Test accuracy: 39.31
Round   3, Train loss: 1.329, Test loss: 1.305, Test accuracy: 43.36
Round   4, Train loss: 1.277, Test loss: 1.218, Test accuracy: 50.24
Round   5, Train loss: 1.233, Test loss: 1.155, Test accuracy: 54.61
Round   6, Train loss: 1.199, Test loss: 1.113, Test accuracy: 55.96
Round   7, Train loss: 1.172, Test loss: 1.073, Test accuracy: 57.90
Round   8, Train loss: 1.146, Test loss: 1.042, Test accuracy: 59.65
Round   9, Train loss: 1.117, Test loss: 1.019, Test accuracy: 60.72
Round  10, Train loss: 1.223, Test loss: 1.028, Test accuracy: 60.55
Round  11, Train loss: 1.041, Test loss: 0.996, Test accuracy: 61.55
Round  12, Train loss: 1.006, Test loss: 0.995, Test accuracy: 62.62
Round  13, Train loss: 0.966, Test loss: 0.968, Test accuracy: 63.41
Round  14, Train loss: 0.888, Test loss: 0.946, Test accuracy: 64.22
Round  15, Train loss: 0.953, Test loss: 0.937, Test accuracy: 65.16
Round  16, Train loss: 1.058, Test loss: 0.935, Test accuracy: 65.19
Round  17, Train loss: 0.909, Test loss: 0.907, Test accuracy: 66.16
Round  18, Train loss: 0.986, Test loss: 0.915, Test accuracy: 65.41
Round  19, Train loss: 0.985, Test loss: 0.910, Test accuracy: 66.34
Round  20, Train loss: 0.981, Test loss: 0.907, Test accuracy: 66.39
Round  21, Train loss: 0.899, Test loss: 0.915, Test accuracy: 66.35
Round  22, Train loss: 0.850, Test loss: 0.891, Test accuracy: 67.07
Round  23, Train loss: 0.897, Test loss: 0.886, Test accuracy: 66.99
Round  24, Train loss: 0.765, Test loss: 0.863, Test accuracy: 68.06
Round  25, Train loss: 0.849, Test loss: 0.861, Test accuracy: 68.19
Round  26, Train loss: 0.781, Test loss: 0.865, Test accuracy: 67.79
Round  27, Train loss: 0.764, Test loss: 0.865, Test accuracy: 68.02
Round  28, Train loss: 0.678, Test loss: 0.861, Test accuracy: 68.43
Round  29, Train loss: 0.901, Test loss: 0.876, Test accuracy: 67.82
Round  30, Train loss: 0.677, Test loss: 0.865, Test accuracy: 68.30
Round  31, Train loss: 0.682, Test loss: 0.876, Test accuracy: 67.74
Round  32, Train loss: 0.986, Test loss: 0.883, Test accuracy: 67.89
Round  33, Train loss: 0.695, Test loss: 0.857, Test accuracy: 68.86
Round  34, Train loss: 0.526, Test loss: 0.837, Test accuracy: 70.10
Round  35, Train loss: 0.623, Test loss: 0.838, Test accuracy: 69.99
Round  36, Train loss: 0.695, Test loss: 0.856, Test accuracy: 69.80
Round  37, Train loss: 0.717, Test loss: 0.840, Test accuracy: 70.01
Round  38, Train loss: 0.679, Test loss: 0.856, Test accuracy: 69.22
Round  39, Train loss: 0.568, Test loss: 0.845, Test accuracy: 69.48
Round  40, Train loss: 0.620, Test loss: 0.837, Test accuracy: 70.25
Round  41, Train loss: 0.789, Test loss: 0.863, Test accuracy: 69.09
Round  42, Train loss: 0.681, Test loss: 0.840, Test accuracy: 69.99
Round  43, Train loss: 0.858, Test loss: 0.866, Test accuracy: 69.13
Round  44, Train loss: 0.739, Test loss: 0.857, Test accuracy: 69.09
Round  45, Train loss: 0.794, Test loss: 0.900, Test accuracy: 67.58
Round  46, Train loss: 0.585, Test loss: 0.877, Test accuracy: 68.28
Round  47, Train loss: 0.688, Test loss: 0.884, Test accuracy: 68.01
Round  48, Train loss: 0.514, Test loss: 0.864, Test accuracy: 68.88
Round  49, Train loss: 0.456, Test loss: 0.880, Test accuracy: 68.87
Round  50, Train loss: 0.479, Test loss: 0.876, Test accuracy: 69.62
Round  51, Train loss: 0.370, Test loss: 0.871, Test accuracy: 69.37
Round  52, Train loss: 0.462, Test loss: 0.893, Test accuracy: 68.36
Round  53, Train loss: 0.433, Test loss: 0.880, Test accuracy: 68.67
Round  54, Train loss: 0.618, Test loss: 0.884, Test accuracy: 69.39
Round  55, Train loss: 0.684, Test loss: 0.908, Test accuracy: 68.18
Round  56, Train loss: 0.575, Test loss: 0.878, Test accuracy: 69.20
Round  57, Train loss: 0.535, Test loss: 0.886, Test accuracy: 69.19
Round  58, Train loss: 0.415, Test loss: 0.873, Test accuracy: 69.06
Round  59, Train loss: 0.410, Test loss: 0.887, Test accuracy: 69.20
Round  60, Train loss: 0.650, Test loss: 0.919, Test accuracy: 68.32
Round  61, Train loss: 0.414, Test loss: 0.908, Test accuracy: 68.50
Round  62, Train loss: 0.390, Test loss: 0.872, Test accuracy: 69.28
Round  63, Train loss: 0.513, Test loss: 0.881, Test accuracy: 69.39
Round  64, Train loss: 0.646, Test loss: 0.922, Test accuracy: 68.17
Round  65, Train loss: 0.407, Test loss: 0.893, Test accuracy: 68.97
Round  66, Train loss: 0.499, Test loss: 0.890, Test accuracy: 68.80
Round  67, Train loss: 0.474, Test loss: 0.918, Test accuracy: 68.14
Round  68, Train loss: 0.480, Test loss: 0.907, Test accuracy: 68.74
Round  69, Train loss: 0.516, Test loss: 0.915, Test accuracy: 68.69
Round  70, Train loss: 0.556, Test loss: 0.928, Test accuracy: 68.27
Round  71, Train loss: 0.497, Test loss: 0.933, Test accuracy: 67.82
Round  72, Train loss: 0.336, Test loss: 0.887, Test accuracy: 69.93
Round  73, Train loss: 0.276, Test loss: 0.888, Test accuracy: 70.24
Round  74, Train loss: 0.567, Test loss: 0.917, Test accuracy: 69.22
Round  75, Train loss: 0.453, Test loss: 0.931, Test accuracy: 68.79
Round  76, Train loss: 0.570, Test loss: 0.932, Test accuracy: 68.45
Round  77, Train loss: 0.507, Test loss: 0.931, Test accuracy: 68.79
Round  78, Train loss: 0.647, Test loss: 1.013, Test accuracy: 66.39
Round  79, Train loss: 0.373, Test loss: 0.957, Test accuracy: 68.21
Round  80, Train loss: 0.269, Test loss: 0.917, Test accuracy: 69.34
Round  81, Train loss: 0.247, Test loss: 0.909, Test accuracy: 69.64
Round  82, Train loss: 0.228, Test loss: 0.928, Test accuracy: 69.45
Round  83, Train loss: 0.218, Test loss: 0.910, Test accuracy: 69.73
Round  84, Train loss: 0.214, Test loss: 0.907, Test accuracy: 69.73
Round  85, Train loss: 0.201, Test loss: 0.913, Test accuracy: 69.89
Round  86, Train loss: 0.204, Test loss: 0.920, Test accuracy: 69.86
Round  87, Train loss: 0.187, Test loss: 0.933, Test accuracy: 69.63
Round  88, Train loss: 0.174, Test loss: 0.928, Test accuracy: 70.12
Round  89, Train loss: 0.177, Test loss: 0.941, Test accuracy: 69.74
Round  90, Train loss: 0.450, Test loss: 0.952, Test accuracy: 69.06
Round  91, Train loss: 0.432, Test loss: 0.970, Test accuracy: 68.39
Round  92, Train loss: 0.424, Test loss: 0.960, Test accuracy: 68.73
Round  93, Train loss: 0.414, Test loss: 0.986, Test accuracy: 68.06
Round  94, Train loss: 0.409, Test loss: 0.995, Test accuracy: 67.90
Round  95, Train loss: 0.409, Test loss: 0.978, Test accuracy: 68.07
Round  96, Train loss: 0.397, Test loss: 0.986, Test accuracy: 68.35
Round  97, Train loss: 0.395, Test loss: 1.014, Test accuracy: 67.46
Round  98, Train loss: 0.394, Test loss: 1.030, Test accuracy: 67.54
Round  99, Train loss: 0.387, Test loss: 1.011, Test accuracy: 67.92
Final Round, Train loss: 0.387, Test loss: 1.013, Test accuracy: 68.14
Average accuracy final 10 rounds: 68.14800000000001
4008.9630076885223
[3.0164878368377686, 5.738776206970215, 8.474811553955078, 11.199706077575684, 13.92568826675415, 16.64387536048889, 19.35107946395874, 21.77098774909973, 24.177766799926758, 26.588140726089478, 28.98375368118286, 31.389649152755737, 33.78615069389343, 36.18982768058777, 38.58952879905701, 40.990538358688354, 43.38091444969177, 45.77555012702942, 48.18026065826416, 50.58940839767456, 53.013386726379395, 57.790900230407715, 62.6185941696167, 67.4709792137146, 72.26243543624878, 77.11103868484497, 81.86914777755737, 86.65367245674133, 91.4111499786377, 96.16445350646973, 100.9284029006958, 105.72622513771057, 110.56049489974976, 115.37621355056763, 120.14137601852417, 124.89223623275757, 129.72380375862122, 134.5490460395813, 139.25942277908325, 144.04164266586304, 148.81394577026367, 153.59077262878418, 158.46440482139587, 163.25413250923157, 168.02393436431885, 172.8150041103363, 177.60888767242432, 182.41295099258423, 187.1934084892273, 192.01254177093506, 196.8018581867218, 201.57031798362732, 206.40249061584473, 211.19445157051086, 215.99970149993896, 220.8798472881317, 225.62444877624512, 230.4885425567627, 235.28447937965393, 240.14200687408447, 244.98136854171753, 249.79392743110657, 254.60611581802368, 259.390150308609, 264.1753170490265, 268.93347907066345, 273.74618196487427, 278.5446002483368, 283.32922744750977, 288.1272768974304, 292.97186374664307, 297.86621832847595, 302.6547541618347, 307.47608184814453, 312.33952283859253, 317.14713501930237, 321.9607515335083, 326.78295731544495, 331.69740867614746, 336.7401406764984, 341.60784888267517, 346.5154640674591, 351.1863567829132, 355.8803040981293, 360.50420117378235, 365.1567933559418, 369.8304612636566, 374.48499274253845, 379.1139316558838, 383.74123883247375, 388.4507169723511, 393.11881828308105, 397.7393288612366, 402.42841958999634, 407.1231384277344, 411.78546500205994, 416.1893358230591, 420.59211015701294, 424.9998109340668, 429.4075286388397, 433.4736888408661]
[22.55, 30.14, 39.31, 43.36, 50.24, 54.61, 55.96, 57.9, 59.65, 60.72, 60.55, 61.55, 62.62, 63.41, 64.22, 65.16, 65.19, 66.16, 65.41, 66.34, 66.39, 66.35, 67.07, 66.99, 68.06, 68.19, 67.79, 68.02, 68.43, 67.82, 68.3, 67.74, 67.89, 68.86, 70.1, 69.99, 69.8, 70.01, 69.22, 69.48, 70.25, 69.09, 69.99, 69.13, 69.09, 67.58, 68.28, 68.01, 68.88, 68.87, 69.62, 69.37, 68.36, 68.67, 69.39, 68.18, 69.2, 69.19, 69.06, 69.2, 68.32, 68.5, 69.28, 69.39, 68.17, 68.97, 68.8, 68.14, 68.74, 68.69, 68.27, 67.82, 69.93, 70.24, 69.22, 68.79, 68.45, 68.79, 66.39, 68.21, 69.34, 69.64, 69.45, 69.73, 69.73, 69.89, 69.86, 69.63, 70.12, 69.74, 69.06, 68.39, 68.73, 68.06, 67.9, 68.07, 68.35, 67.46, 67.54, 67.92, 68.14]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.688, Test loss: 2.151, Test accuracy: 21.15
Round   0, Global train loss: 1.688, Global test loss: 2.350, Global test accuracy: 16.01
Round   1, Train loss: 1.633, Test loss: 1.866, Test accuracy: 26.68
Round   1, Global train loss: 1.633, Global test loss: 2.311, Global test accuracy: 14.41
Round   2, Train loss: 1.504, Test loss: 1.786, Test accuracy: 29.55
Round   2, Global train loss: 1.504, Global test loss: 2.390, Global test accuracy: 16.26
Round   3, Train loss: 1.485, Test loss: 1.632, Test accuracy: 34.58
Round   3, Global train loss: 1.485, Global test loss: 2.299, Global test accuracy: 14.57
Round   4, Train loss: 1.433, Test loss: 1.584, Test accuracy: 36.78
Round   4, Global train loss: 1.433, Global test loss: 2.372, Global test accuracy: 15.98
Round   5, Train loss: 1.389, Test loss: 1.494, Test accuracy: 38.90
Round   5, Global train loss: 1.389, Global test loss: 2.279, Global test accuracy: 16.73
Round   6, Train loss: 1.419, Test loss: 1.394, Test accuracy: 41.92
Round   6, Global train loss: 1.419, Global test loss: 2.392, Global test accuracy: 9.60
Round   7, Train loss: 1.458, Test loss: 1.309, Test accuracy: 45.15
Round   7, Global train loss: 1.458, Global test loss: 2.321, Global test accuracy: 14.13
Round   8, Train loss: 1.480, Test loss: 1.291, Test accuracy: 46.49
Round   8, Global train loss: 1.480, Global test loss: 2.283, Global test accuracy: 15.69
Round   9, Train loss: 1.358, Test loss: 1.278, Test accuracy: 47.60
Round   9, Global train loss: 1.358, Global test loss: 2.339, Global test accuracy: 16.55
Round  10, Train loss: 1.424, Test loss: 1.263, Test accuracy: 49.25
Round  10, Global train loss: 1.424, Global test loss: 2.323, Global test accuracy: 13.32
Round  11, Train loss: 1.358, Test loss: 1.251, Test accuracy: 50.02
Round  11, Global train loss: 1.358, Global test loss: 2.291, Global test accuracy: 15.88
Round  12, Train loss: 1.214, Test loss: 1.248, Test accuracy: 50.42
Round  12, Global train loss: 1.214, Global test loss: 2.291, Global test accuracy: 15.78
Round  13, Train loss: 1.370, Test loss: 1.237, Test accuracy: 50.73
Round  13, Global train loss: 1.370, Global test loss: 2.336, Global test accuracy: 16.98
Round  14, Train loss: 1.391, Test loss: 1.229, Test accuracy: 51.14
Round  14, Global train loss: 1.391, Global test loss: 2.294, Global test accuracy: 14.87
Round  15, Train loss: 1.378, Test loss: 1.219, Test accuracy: 51.82
Round  15, Global train loss: 1.378, Global test loss: 2.312, Global test accuracy: 13.59
Round  16, Train loss: 1.214, Test loss: 1.220, Test accuracy: 52.27
Round  16, Global train loss: 1.214, Global test loss: 2.266, Global test accuracy: 17.28
Round  17, Train loss: 1.108, Test loss: 1.215, Test accuracy: 52.74
Round  17, Global train loss: 1.108, Global test loss: 2.296, Global test accuracy: 16.94
Round  18, Train loss: 1.049, Test loss: 1.207, Test accuracy: 53.53
Round  18, Global train loss: 1.049, Global test loss: 2.351, Global test accuracy: 16.98
Round  19, Train loss: 1.212, Test loss: 1.197, Test accuracy: 53.87
Round  19, Global train loss: 1.212, Global test loss: 2.299, Global test accuracy: 14.36
Round  20, Train loss: 1.129, Test loss: 1.204, Test accuracy: 53.40
Round  20, Global train loss: 1.129, Global test loss: 2.306, Global test accuracy: 16.35
Round  21, Train loss: 1.252, Test loss: 1.200, Test accuracy: 53.83
Round  21, Global train loss: 1.252, Global test loss: 2.303, Global test accuracy: 15.24
Round  22, Train loss: 1.150, Test loss: 1.197, Test accuracy: 54.36
Round  22, Global train loss: 1.150, Global test loss: 2.296, Global test accuracy: 14.50
Round  23, Train loss: 1.127, Test loss: 1.206, Test accuracy: 54.04
Round  23, Global train loss: 1.127, Global test loss: 2.306, Global test accuracy: 15.40
Round  24, Train loss: 1.159, Test loss: 1.218, Test accuracy: 53.88
Round  24, Global train loss: 1.159, Global test loss: 2.340, Global test accuracy: 16.09
Round  25, Train loss: 1.138, Test loss: 1.210, Test accuracy: 54.41
Round  25, Global train loss: 1.138, Global test loss: 2.308, Global test accuracy: 16.71
Round  26, Train loss: 1.068, Test loss: 1.214, Test accuracy: 54.44
Round  26, Global train loss: 1.068, Global test loss: 2.285, Global test accuracy: 15.33
Round  27, Train loss: 0.960, Test loss: 1.230, Test accuracy: 54.12
Round  27, Global train loss: 0.960, Global test loss: 2.441, Global test accuracy: 15.63
Round  28, Train loss: 1.097, Test loss: 1.240, Test accuracy: 53.32
Round  28, Global train loss: 1.097, Global test loss: 2.313, Global test accuracy: 15.50
Round  29, Train loss: 1.036, Test loss: 1.252, Test accuracy: 53.07
Round  29, Global train loss: 1.036, Global test loss: 2.290, Global test accuracy: 14.38
Round  30, Train loss: 0.944, Test loss: 1.246, Test accuracy: 53.67
Round  30, Global train loss: 0.944, Global test loss: 2.375, Global test accuracy: 16.03
Round  31, Train loss: 0.960, Test loss: 1.250, Test accuracy: 54.02
Round  31, Global train loss: 0.960, Global test loss: 2.417, Global test accuracy: 15.59
Round  32, Train loss: 0.982, Test loss: 1.287, Test accuracy: 53.40
Round  32, Global train loss: 0.982, Global test loss: 2.275, Global test accuracy: 16.08
Round  33, Train loss: 0.835, Test loss: 1.322, Test accuracy: 52.29
Round  33, Global train loss: 0.835, Global test loss: 2.338, Global test accuracy: 17.37
Round  34, Train loss: 0.874, Test loss: 1.325, Test accuracy: 52.74
Round  34, Global train loss: 0.874, Global test loss: 2.353, Global test accuracy: 17.10
Round  35, Train loss: 0.890, Test loss: 1.349, Test accuracy: 53.28
Round  35, Global train loss: 0.890, Global test loss: 2.278, Global test accuracy: 14.78
Round  36, Train loss: 0.889, Test loss: 1.344, Test accuracy: 53.54
Round  36, Global train loss: 0.889, Global test loss: 2.326, Global test accuracy: 13.71
Round  37, Train loss: 0.802, Test loss: 1.358, Test accuracy: 53.12
Round  37, Global train loss: 0.802, Global test loss: 2.284, Global test accuracy: 15.52
Round  38, Train loss: 0.927, Test loss: 1.352, Test accuracy: 53.39
Round  38, Global train loss: 0.927, Global test loss: 2.331, Global test accuracy: 15.77
Round  39, Train loss: 1.043, Test loss: 1.380, Test accuracy: 52.89
Round  39, Global train loss: 1.043, Global test loss: 2.317, Global test accuracy: 13.37
Round  40, Train loss: 0.859, Test loss: 1.389, Test accuracy: 52.89
Round  40, Global train loss: 0.859, Global test loss: 2.312, Global test accuracy: 13.23
Round  41, Train loss: 0.925, Test loss: 1.393, Test accuracy: 53.41
Round  41, Global train loss: 0.925, Global test loss: 2.300, Global test accuracy: 16.26
Round  42, Train loss: 0.739, Test loss: 1.405, Test accuracy: 52.88
Round  42, Global train loss: 0.739, Global test loss: 2.301, Global test accuracy: 15.50
Round  43, Train loss: 0.732, Test loss: 1.425, Test accuracy: 52.83
Round  43, Global train loss: 0.732, Global test loss: 2.388, Global test accuracy: 17.57
Round  44, Train loss: 0.748, Test loss: 1.460, Test accuracy: 52.15
Round  44, Global train loss: 0.748, Global test loss: 2.385, Global test accuracy: 14.82
Round  45, Train loss: 0.790, Test loss: 1.488, Test accuracy: 52.17
Round  45, Global train loss: 0.790, Global test loss: 2.290, Global test accuracy: 15.29
Round  46, Train loss: 0.864, Test loss: 1.483, Test accuracy: 52.59
Round  46, Global train loss: 0.864, Global test loss: 2.321, Global test accuracy: 11.26
Round  47, Train loss: 0.780, Test loss: 1.519, Test accuracy: 52.43
Round  47, Global train loss: 0.780, Global test loss: 2.370, Global test accuracy: 13.58
Round  48, Train loss: 0.532, Test loss: 1.534, Test accuracy: 52.77
Round  48, Global train loss: 0.532, Global test loss: 2.322, Global test accuracy: 16.20
Round  49, Train loss: 0.710, Test loss: 1.564, Test accuracy: 52.54
Round  49, Global train loss: 0.710, Global test loss: 2.506, Global test accuracy: 10.00
Round  50, Train loss: 0.506, Test loss: 1.640, Test accuracy: 51.72
Round  50, Global train loss: 0.506, Global test loss: 2.481, Global test accuracy: 15.15
Round  51, Train loss: 0.503, Test loss: 1.666, Test accuracy: 51.95
Round  51, Global train loss: 0.503, Global test loss: 2.294, Global test accuracy: 14.62
Round  52, Train loss: 0.611, Test loss: 1.681, Test accuracy: 51.70
Round  52, Global train loss: 0.611, Global test loss: 2.320, Global test accuracy: 14.95
Round  53, Train loss: 0.540, Test loss: 1.646, Test accuracy: 51.98
Round  53, Global train loss: 0.540, Global test loss: 2.352, Global test accuracy: 16.48
Round  54, Train loss: 0.558, Test loss: 1.659, Test accuracy: 51.67
Round  54, Global train loss: 0.558, Global test loss: 2.421, Global test accuracy: 17.02
Round  55, Train loss: 0.357, Test loss: 1.664, Test accuracy: 52.40
Round  55, Global train loss: 0.357, Global test loss: 2.341, Global test accuracy: 16.71
Round  56, Train loss: 0.631, Test loss: 1.740, Test accuracy: 51.61
Round  56, Global train loss: 0.631, Global test loss: 2.340, Global test accuracy: 17.60
Round  57, Train loss: 0.491, Test loss: 1.792, Test accuracy: 51.18
Round  57, Global train loss: 0.491, Global test loss: 2.331, Global test accuracy: 14.34
Round  58, Train loss: 0.655, Test loss: 1.815, Test accuracy: 51.24
Round  58, Global train loss: 0.655, Global test loss: 2.316, Global test accuracy: 17.80
Round  59, Train loss: 0.616, Test loss: 1.823, Test accuracy: 51.51
Round  59, Global train loss: 0.616, Global test loss: 2.317, Global test accuracy: 14.75
Round  60, Train loss: 0.406, Test loss: 1.882, Test accuracy: 51.42
Round  60, Global train loss: 0.406, Global test loss: 2.484, Global test accuracy: 15.02
Round  61, Train loss: 0.607, Test loss: 1.868, Test accuracy: 51.58
Round  61, Global train loss: 0.607, Global test loss: 2.356, Global test accuracy: 11.13
Round  62, Train loss: 0.426, Test loss: 1.880, Test accuracy: 51.62
Round  62, Global train loss: 0.426, Global test loss: 2.327, Global test accuracy: 15.07
Round  63, Train loss: 0.541, Test loss: 1.942, Test accuracy: 51.45
Round  63, Global train loss: 0.541, Global test loss: 2.332, Global test accuracy: 16.45
Round  64, Train loss: 0.511, Test loss: 2.013, Test accuracy: 51.04
Round  64, Global train loss: 0.511, Global test loss: 2.307, Global test accuracy: 11.81
Round  65, Train loss: 0.468, Test loss: 1.972, Test accuracy: 51.51
Round  65, Global train loss: 0.468, Global test loss: 2.325, Global test accuracy: 16.90
Round  66, Train loss: 0.474, Test loss: 2.022, Test accuracy: 51.39
Round  66, Global train loss: 0.474, Global test loss: 2.334, Global test accuracy: 11.51
Round  67, Train loss: 0.382, Test loss: 2.032, Test accuracy: 51.52
Round  67, Global train loss: 0.382, Global test loss: 2.353, Global test accuracy: 17.30
Round  68, Train loss: 0.428, Test loss: 2.041, Test accuracy: 51.21
Round  68, Global train loss: 0.428, Global test loss: 2.420, Global test accuracy: 11.04
Round  69, Train loss: 0.348, Test loss: 2.042, Test accuracy: 51.14
Round  69, Global train loss: 0.348, Global test loss: 2.423, Global test accuracy: 13.78
Round  70, Train loss: 0.349, Test loss: 2.052, Test accuracy: 51.65
Round  70, Global train loss: 0.349, Global test loss: 2.361, Global test accuracy: 15.51
Round  71, Train loss: 0.324, Test loss: 2.087, Test accuracy: 51.53
Round  71, Global train loss: 0.324, Global test loss: 2.323, Global test accuracy: 16.51
Round  72, Train loss: 0.348, Test loss: 2.108, Test accuracy: 51.44
Round  72, Global train loss: 0.348, Global test loss: 2.342, Global test accuracy: 16.25
Round  73, Train loss: 0.362, Test loss: 2.160, Test accuracy: 50.49
Round  73, Global train loss: 0.362, Global test loss: 2.360, Global test accuracy: 16.64
Round  74, Train loss: 0.364, Test loss: 2.163, Test accuracy: 50.54
Round  74, Global train loss: 0.364, Global test loss: 2.355, Global test accuracy: 12.69
Round  75, Train loss: 0.341, Test loss: 2.207, Test accuracy: 50.67
Round  75, Global train loss: 0.341, Global test loss: 2.344, Global test accuracy: 15.12
Round  76, Train loss: 0.373, Test loss: 2.259, Test accuracy: 50.93
Round  76, Global train loss: 0.373, Global test loss: 2.360, Global test accuracy: 12.45
Round  77, Train loss: 0.348, Test loss: 2.272, Test accuracy: 51.47
Round  77, Global train loss: 0.348, Global test loss: 2.331, Global test accuracy: 15.84
Round  78, Train loss: 0.238, Test loss: 2.319, Test accuracy: 51.16
Round  78, Global train loss: 0.238, Global test loss: 2.425, Global test accuracy: 15.31
Round  79, Train loss: 0.220, Test loss: 2.323, Test accuracy: 51.36
Round  79, Global train loss: 0.220, Global test loss: 2.379, Global test accuracy: 16.72
Round  80, Train loss: 0.382, Test loss: 2.366, Test accuracy: 51.30
Round  80, Global train loss: 0.382, Global test loss: 2.361, Global test accuracy: 12.22
Round  81, Train loss: 0.385, Test loss: 2.351, Test accuracy: 51.84
Round  81, Global train loss: 0.385, Global test loss: 2.295, Global test accuracy: 15.07
Round  82, Train loss: 0.301, Test loss: 2.356, Test accuracy: 52.04
Round  82, Global train loss: 0.301, Global test loss: 2.419, Global test accuracy: 12.91
Round  83, Train loss: 0.286, Test loss: 2.386, Test accuracy: 51.67
Round  83, Global train loss: 0.286, Global test loss: 2.335, Global test accuracy: 15.20
Round  84, Train loss: 0.291, Test loss: 2.467, Test accuracy: 51.22
Round  84, Global train loss: 0.291, Global test loss: 2.352, Global test accuracy: 13.28
Round  85, Train loss: 0.202, Test loss: 2.502, Test accuracy: 51.49
Round  85, Global train loss: 0.202, Global test loss: 2.355, Global test accuracy: 16.56
Round  86, Train loss: 0.252, Test loss: 2.521, Test accuracy: 51.10
Round  86, Global train loss: 0.252, Global test loss: 2.371, Global test accuracy: 14.60
Round  87, Train loss: 0.213, Test loss: 2.523, Test accuracy: 51.11
Round  87, Global train loss: 0.213, Global test loss: 2.516, Global test accuracy: 17.38
Round  88, Train loss: 0.199, Test loss: 2.528, Test accuracy: 51.29
Round  88, Global train loss: 0.199, Global test loss: 2.327, Global test accuracy: 16.16
Round  89, Train loss: 0.235, Test loss: 2.568, Test accuracy: 51.47
Round  89, Global train loss: 0.235, Global test loss: 2.403, Global test accuracy: 14.06
Round  90, Train loss: 0.346, Test loss: 2.632, Test accuracy: 51.11
Round  90, Global train loss: 0.346, Global test loss: 2.345, Global test accuracy: 13.40
Round  91, Train loss: 0.192, Test loss: 2.659, Test accuracy: 50.34
Round  91, Global train loss: 0.192, Global test loss: 2.353, Global test accuracy: 15.24
Round  92, Train loss: 0.188, Test loss: 2.681, Test accuracy: 50.14
Round  92, Global train loss: 0.188, Global test loss: 2.362, Global test accuracy: 16.16
Round  93, Train loss: 0.207, Test loss: 2.674, Test accuracy: 50.81
Round  93, Global train loss: 0.207, Global test loss: 2.355, Global test accuracy: 15.09
Round  94, Train loss: 0.177, Test loss: 2.649, Test accuracy: 50.85
Round  94, Global train loss: 0.177, Global test loss: 2.378, Global test accuracy: 13.18
Round  95, Train loss: 0.240, Test loss: 2.590, Test accuracy: 51.13
Round  95, Global train loss: 0.240, Global test loss: 2.308, Global test accuracy: 14.05
Round  96, Train loss: 0.178, Test loss: 2.647, Test accuracy: 51.13
Round  96, Global train loss: 0.178, Global test loss: 2.383, Global test accuracy: 13.50
Round  97, Train loss: 0.235, Test loss: 2.619, Test accuracy: 50.76
Round  97, Global train loss: 0.235, Global test loss: 2.360, Global test accuracy: 14.84
Round  98, Train loss: 0.176, Test loss: 2.630, Test accuracy: 51.24
Round  98, Global train loss: 0.176, Global test loss: 2.453, Global test accuracy: 12.31
Round  99, Train loss: 0.173, Test loss: 2.657, Test accuracy: 51.40
Round  99, Global train loss: 0.173, Global test loss: 2.368, Global test accuracy: 17.07
Final Round, Train loss: 0.191, Test loss: 2.835, Test accuracy: 51.30
Final Round, Global train loss: 0.191, Global test loss: 2.368, Global test accuracy: 17.07
Average accuracy final 10 rounds: 50.891000000000005 

Average global accuracy final 10 rounds: 14.484 

1364.538198709488
[1.3790416717529297, 2.7580833435058594, 3.853374481201172, 4.948665618896484, 6.048685073852539, 7.148704528808594, 8.249829769134521, 9.35095500946045, 10.44997763633728, 11.549000263214111, 12.688181638717651, 13.827363014221191, 14.984008550643921, 16.14065408706665, 17.298266172409058, 18.455878257751465, 19.613577365875244, 20.771276473999023, 21.931129693984985, 23.090982913970947, 24.24720811843872, 25.403433322906494, 26.54997944831848, 27.69652557373047, 28.84449529647827, 29.992465019226074, 31.147233247756958, 32.30200147628784, 33.44975686073303, 34.59751224517822, 35.7425971031189, 36.88768196105957, 38.04112219810486, 39.19456243515015, 40.34688401222229, 41.499205589294434, 42.65071177482605, 43.802217960357666, 44.95776128768921, 46.11330461502075, 47.27238154411316, 48.431458473205566, 49.44702911376953, 50.462599754333496, 51.48283839225769, 52.503077030181885, 53.51981711387634, 54.5365571975708, 55.55399823188782, 56.571439266204834, 57.58990788459778, 58.60837650299072, 59.62895941734314, 60.64954233169556, 61.668009519577026, 62.686476707458496, 63.70255780220032, 64.71863889694214, 65.73332238197327, 66.7480058670044, 67.76755619049072, 68.78710651397705, 69.80791544914246, 70.82872438430786, 71.8451144695282, 72.86150455474854, 73.87712383270264, 74.89274311065674, 75.87764644622803, 76.86254978179932, 77.84935212135315, 78.83615446090698, 79.82218885421753, 80.80822324752808, 81.79554533958435, 82.78286743164062, 83.76872253417969, 84.75457763671875, 85.74162173271179, 86.72866582870483, 87.7131118774414, 88.69755792617798, 89.68642091751099, 90.675283908844, 91.66121768951416, 92.64715147018433, 93.63289093971252, 94.61863040924072, 95.6065444946289, 96.59445858001709, 97.58240485191345, 98.57035112380981, 99.56026434898376, 100.55017757415771, 101.53923511505127, 102.52829265594482, 103.51635551452637, 104.50441837310791, 105.4994056224823, 106.49439287185669, 107.48278284072876, 108.47117280960083, 109.46048402786255, 110.44979524612427, 111.43653607368469, 112.42327690124512, 113.40734028816223, 114.39140367507935, 115.37378978729248, 116.35617589950562, 117.34506058692932, 118.33394527435303, 119.32116794586182, 120.3083906173706, 121.29490852355957, 122.28142642974854, 123.26564002037048, 124.24985361099243, 125.2305555343628, 126.21125745773315, 127.19563031196594, 128.18000316619873, 129.16726517677307, 130.1545271873474, 131.1427445411682, 132.130961894989, 133.11658191680908, 134.10220193862915, 135.08566856384277, 136.0691351890564, 137.05238103866577, 138.03562688827515, 139.0216109752655, 140.00759506225586, 140.99284839630127, 141.97810173034668, 142.96385216712952, 143.94960260391235, 144.93348217010498, 145.9173617362976, 146.9047167301178, 147.892071723938, 148.88128924369812, 149.87050676345825, 150.85754799842834, 151.84458923339844, 152.82818365097046, 153.81177806854248, 154.7970700263977, 155.78236198425293, 156.77055716514587, 157.75875234603882, 158.74607396125793, 159.73339557647705, 160.7204442024231, 161.70749282836914, 162.69439816474915, 163.68130350112915, 164.66581773757935, 165.65033197402954, 166.63536286354065, 167.62039375305176, 168.60454750061035, 169.58870124816895, 170.5713198184967, 171.55393838882446, 172.5433223247528, 173.53270626068115, 174.51580548286438, 175.4989047050476, 176.4833700656891, 177.46783542633057, 178.45242619514465, 179.43701696395874, 180.42005610466003, 181.40309524536133, 182.385507106781, 183.36791896820068, 184.3543438911438, 185.3407688140869, 186.32943487167358, 187.31810092926025, 188.30192804336548, 189.2857551574707, 190.27403664588928, 191.26231813430786, 192.2473225593567, 193.23232698440552, 194.21875667572021, 195.2051863670349, 196.1919732093811, 197.1787600517273, 198.16564345359802, 199.15252685546875, 200.13595366477966, 201.11938047409058, 202.10088968276978, 203.08239889144897, 204.06335473060608, 205.04431056976318, 207.01475477218628, 208.98519897460938]
[21.15, 21.15, 26.68, 26.68, 29.55, 29.55, 34.58, 34.58, 36.78, 36.78, 38.9, 38.9, 41.92, 41.92, 45.15, 45.15, 46.49, 46.49, 47.6, 47.6, 49.25, 49.25, 50.02, 50.02, 50.42, 50.42, 50.73, 50.73, 51.14, 51.14, 51.82, 51.82, 52.27, 52.27, 52.74, 52.74, 53.53, 53.53, 53.87, 53.87, 53.4, 53.4, 53.83, 53.83, 54.36, 54.36, 54.04, 54.04, 53.88, 53.88, 54.41, 54.41, 54.44, 54.44, 54.12, 54.12, 53.32, 53.32, 53.07, 53.07, 53.67, 53.67, 54.02, 54.02, 53.4, 53.4, 52.29, 52.29, 52.74, 52.74, 53.28, 53.28, 53.54, 53.54, 53.12, 53.12, 53.39, 53.39, 52.89, 52.89, 52.89, 52.89, 53.41, 53.41, 52.88, 52.88, 52.83, 52.83, 52.15, 52.15, 52.17, 52.17, 52.59, 52.59, 52.43, 52.43, 52.77, 52.77, 52.54, 52.54, 51.72, 51.72, 51.95, 51.95, 51.7, 51.7, 51.98, 51.98, 51.67, 51.67, 52.4, 52.4, 51.61, 51.61, 51.18, 51.18, 51.24, 51.24, 51.51, 51.51, 51.42, 51.42, 51.58, 51.58, 51.62, 51.62, 51.45, 51.45, 51.04, 51.04, 51.51, 51.51, 51.39, 51.39, 51.52, 51.52, 51.21, 51.21, 51.14, 51.14, 51.65, 51.65, 51.53, 51.53, 51.44, 51.44, 50.49, 50.49, 50.54, 50.54, 50.67, 50.67, 50.93, 50.93, 51.47, 51.47, 51.16, 51.16, 51.36, 51.36, 51.3, 51.3, 51.84, 51.84, 52.04, 52.04, 51.67, 51.67, 51.22, 51.22, 51.49, 51.49, 51.1, 51.1, 51.11, 51.11, 51.29, 51.29, 51.47, 51.47, 51.11, 51.11, 50.34, 50.34, 50.14, 50.14, 50.81, 50.81, 50.85, 50.85, 51.13, 51.13, 51.13, 51.13, 50.76, 50.76, 51.24, 51.24, 51.4, 51.4, 51.3, 51.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.635, Test loss: 2.086, Test accuracy: 19.81
Round   0, Global train loss: 1.635, Global test loss: 2.333, Global test accuracy: 12.85
Round   1, Train loss: 1.620, Test loss: 1.987, Test accuracy: 26.40
Round   1, Global train loss: 1.620, Global test loss: 2.507, Global test accuracy: 13.04
Round   2, Train loss: 1.522, Test loss: 1.750, Test accuracy: 31.49
Round   2, Global train loss: 1.522, Global test loss: 2.341, Global test accuracy: 14.26
Round   3, Train loss: 1.573, Test loss: 1.656, Test accuracy: 34.55
Round   3, Global train loss: 1.573, Global test loss: 2.436, Global test accuracy: 13.25
Round   4, Train loss: 1.530, Test loss: 1.551, Test accuracy: 38.62
Round   4, Global train loss: 1.530, Global test loss: 2.343, Global test accuracy: 11.99
Round   5, Train loss: 1.418, Test loss: 1.499, Test accuracy: 40.87
Round   5, Global train loss: 1.418, Global test loss: 2.365, Global test accuracy: 14.18
Round   6, Train loss: 1.514, Test loss: 1.343, Test accuracy: 45.94
Round   6, Global train loss: 1.514, Global test loss: 2.283, Global test accuracy: 14.92
Round   7, Train loss: 1.521, Test loss: 1.272, Test accuracy: 48.00
Round   7, Global train loss: 1.521, Global test loss: 2.335, Global test accuracy: 14.40
Round   8, Train loss: 1.486, Test loss: 1.248, Test accuracy: 50.19
Round   8, Global train loss: 1.486, Global test loss: 2.390, Global test accuracy: 14.28
Round   9, Train loss: 1.323, Test loss: 1.244, Test accuracy: 50.27
Round   9, Global train loss: 1.323, Global test loss: 2.439, Global test accuracy: 16.02
Round  10, Train loss: 1.358, Test loss: 1.219, Test accuracy: 51.21
Round  10, Global train loss: 1.358, Global test loss: 2.488, Global test accuracy: 16.27
Round  11, Train loss: 1.446, Test loss: 1.208, Test accuracy: 52.40
Round  11, Global train loss: 1.446, Global test loss: 2.408, Global test accuracy: 16.25
Round  12, Train loss: 1.284, Test loss: 1.201, Test accuracy: 52.97
Round  12, Global train loss: 1.284, Global test loss: 2.610, Global test accuracy: 15.52
Round  13, Train loss: 1.533, Test loss: 1.192, Test accuracy: 53.04
Round  13, Global train loss: 1.533, Global test loss: 2.392, Global test accuracy: 14.91
Round  14, Train loss: 1.452, Test loss: 1.175, Test accuracy: 54.24
Round  14, Global train loss: 1.452, Global test loss: 2.387, Global test accuracy: 13.26
Round  15, Train loss: 1.311, Test loss: 1.188, Test accuracy: 53.80
Round  15, Global train loss: 1.311, Global test loss: 2.352, Global test accuracy: 16.78
Round  16, Train loss: 1.216, Test loss: 1.189, Test accuracy: 54.33
Round  16, Global train loss: 1.216, Global test loss: 2.432, Global test accuracy: 12.13
Round  17, Train loss: 1.247, Test loss: 1.180, Test accuracy: 54.87
Round  17, Global train loss: 1.247, Global test loss: 2.394, Global test accuracy: 13.61
Round  18, Train loss: 1.274, Test loss: 1.167, Test accuracy: 55.37
Round  18, Global train loss: 1.274, Global test loss: 2.473, Global test accuracy: 11.93
Round  19, Train loss: 1.337, Test loss: 1.163, Test accuracy: 55.70
Round  19, Global train loss: 1.337, Global test loss: 2.371, Global test accuracy: 15.55
Round  20, Train loss: 1.349, Test loss: 1.147, Test accuracy: 55.95
Round  20, Global train loss: 1.349, Global test loss: 2.384, Global test accuracy: 14.28
Round  21, Train loss: 1.385, Test loss: 1.137, Test accuracy: 56.82
Round  21, Global train loss: 1.385, Global test loss: 2.407, Global test accuracy: 14.88
Round  22, Train loss: 1.227, Test loss: 1.134, Test accuracy: 56.75
Round  22, Global train loss: 1.227, Global test loss: 2.480, Global test accuracy: 17.29
Round  23, Train loss: 1.208, Test loss: 1.130, Test accuracy: 57.46
Round  23, Global train loss: 1.208, Global test loss: 2.575, Global test accuracy: 16.09
Round  24, Train loss: 1.333, Test loss: 1.133, Test accuracy: 57.33
Round  24, Global train loss: 1.333, Global test loss: 2.392, Global test accuracy: 15.36
Round  25, Train loss: 1.303, Test loss: 1.130, Test accuracy: 57.38
Round  25, Global train loss: 1.303, Global test loss: 2.386, Global test accuracy: 15.80
Round  26, Train loss: 1.286, Test loss: 1.125, Test accuracy: 57.79
Round  26, Global train loss: 1.286, Global test loss: 2.405, Global test accuracy: 16.10
Round  27, Train loss: 1.171, Test loss: 1.133, Test accuracy: 57.33
Round  27, Global train loss: 1.171, Global test loss: 2.463, Global test accuracy: 15.48
Round  28, Train loss: 1.280, Test loss: 1.120, Test accuracy: 57.84
Round  28, Global train loss: 1.280, Global test loss: 2.446, Global test accuracy: 13.91
Round  29, Train loss: 1.265, Test loss: 1.115, Test accuracy: 58.16
Round  29, Global train loss: 1.265, Global test loss: 2.451, Global test accuracy: 13.90
Round  30, Train loss: 1.201, Test loss: 1.129, Test accuracy: 57.09
Round  30, Global train loss: 1.201, Global test loss: 2.507, Global test accuracy: 11.83
Round  31, Train loss: 1.232, Test loss: 1.128, Test accuracy: 57.63
Round  31, Global train loss: 1.232, Global test loss: 2.449, Global test accuracy: 13.98
Round  32, Train loss: 1.046, Test loss: 1.133, Test accuracy: 57.44
Round  32, Global train loss: 1.046, Global test loss: 2.345, Global test accuracy: 16.43
Round  33, Train loss: 1.221, Test loss: 1.130, Test accuracy: 57.16
Round  33, Global train loss: 1.221, Global test loss: 2.379, Global test accuracy: 15.01
Round  34, Train loss: 1.294, Test loss: 1.131, Test accuracy: 57.60
Round  34, Global train loss: 1.294, Global test loss: 2.537, Global test accuracy: 10.68
Round  35, Train loss: 1.161, Test loss: 1.117, Test accuracy: 58.31
Round  35, Global train loss: 1.161, Global test loss: 2.467, Global test accuracy: 14.81
Round  36, Train loss: 1.195, Test loss: 1.114, Test accuracy: 58.22
Round  36, Global train loss: 1.195, Global test loss: 2.419, Global test accuracy: 16.42
Round  37, Train loss: 1.272, Test loss: 1.126, Test accuracy: 57.47
Round  37, Global train loss: 1.272, Global test loss: 2.510, Global test accuracy: 14.41
Round  38, Train loss: 1.023, Test loss: 1.112, Test accuracy: 58.45
Round  38, Global train loss: 1.023, Global test loss: 2.504, Global test accuracy: 14.59
Round  39, Train loss: 1.201, Test loss: 1.104, Test accuracy: 58.86
Round  39, Global train loss: 1.201, Global test loss: 2.558, Global test accuracy: 14.65
Round  40, Train loss: 0.980, Test loss: 1.092, Test accuracy: 59.30
Round  40, Global train loss: 0.980, Global test loss: 2.639, Global test accuracy: 14.94
Round  41, Train loss: 1.129, Test loss: 1.086, Test accuracy: 59.26
Round  41, Global train loss: 1.129, Global test loss: 2.479, Global test accuracy: 16.09
Round  42, Train loss: 1.059, Test loss: 1.106, Test accuracy: 58.81
Round  42, Global train loss: 1.059, Global test loss: 2.602, Global test accuracy: 15.62
Round  43, Train loss: 1.084, Test loss: 1.116, Test accuracy: 58.36
Round  43, Global train loss: 1.084, Global test loss: 2.655, Global test accuracy: 13.52
Round  44, Train loss: 1.243, Test loss: 1.117, Test accuracy: 58.19
Round  44, Global train loss: 1.243, Global test loss: 2.582, Global test accuracy: 14.50
Round  45, Train loss: 1.106, Test loss: 1.115, Test accuracy: 58.17
Round  45, Global train loss: 1.106, Global test loss: 2.525, Global test accuracy: 14.40
Round  46, Train loss: 1.027, Test loss: 1.116, Test accuracy: 58.28
Round  46, Global train loss: 1.027, Global test loss: 2.788, Global test accuracy: 15.25
Round  47, Train loss: 1.102, Test loss: 1.114, Test accuracy: 58.42
Round  47, Global train loss: 1.102, Global test loss: 2.690, Global test accuracy: 16.10
Round  48, Train loss: 1.104, Test loss: 1.123, Test accuracy: 58.44
Round  48, Global train loss: 1.104, Global test loss: 2.601, Global test accuracy: 14.34
Round  49, Train loss: 1.165, Test loss: 1.138, Test accuracy: 57.70
Round  49, Global train loss: 1.165, Global test loss: 2.529, Global test accuracy: 14.07
Round  50, Train loss: 1.010, Test loss: 1.149, Test accuracy: 57.26
Round  50, Global train loss: 1.010, Global test loss: 2.619, Global test accuracy: 14.22
Round  51, Train loss: 1.013, Test loss: 1.134, Test accuracy: 58.17
Round  51, Global train loss: 1.013, Global test loss: 2.555, Global test accuracy: 15.54
Round  52, Train loss: 0.991, Test loss: 1.127, Test accuracy: 58.72
Round  52, Global train loss: 0.991, Global test loss: 2.704, Global test accuracy: 15.04
Round  53, Train loss: 1.012, Test loss: 1.143, Test accuracy: 58.57
Round  53, Global train loss: 1.012, Global test loss: 2.629, Global test accuracy: 15.67
Round  54, Train loss: 1.040, Test loss: 1.157, Test accuracy: 57.95
Round  54, Global train loss: 1.040, Global test loss: 2.764, Global test accuracy: 13.71
Round  55, Train loss: 0.859, Test loss: 1.146, Test accuracy: 58.43
Round  55, Global train loss: 0.859, Global test loss: 2.920, Global test accuracy: 14.14
Round  56, Train loss: 1.169, Test loss: 1.128, Test accuracy: 59.23
Round  56, Global train loss: 1.169, Global test loss: 2.627, Global test accuracy: 13.25
Round  57, Train loss: 0.952, Test loss: 1.157, Test accuracy: 58.19
Round  57, Global train loss: 0.952, Global test loss: 2.748, Global test accuracy: 14.50
Round  58, Train loss: 1.076, Test loss: 1.160, Test accuracy: 57.83
Round  58, Global train loss: 1.076, Global test loss: 2.696, Global test accuracy: 14.02
Round  59, Train loss: 0.939, Test loss: 1.181, Test accuracy: 57.28
Round  59, Global train loss: 0.939, Global test loss: 2.664, Global test accuracy: 16.22
Round  60, Train loss: 1.020, Test loss: 1.187, Test accuracy: 57.21
Round  60, Global train loss: 1.020, Global test loss: 2.759, Global test accuracy: 13.75
Round  61, Train loss: 0.844, Test loss: 1.174, Test accuracy: 57.54
Round  61, Global train loss: 0.844, Global test loss: 2.740, Global test accuracy: 15.74
Round  62, Train loss: 1.019, Test loss: 1.172, Test accuracy: 57.92
Round  62, Global train loss: 1.019, Global test loss: 2.700, Global test accuracy: 14.11
Round  63, Train loss: 0.886, Test loss: 1.160, Test accuracy: 58.46
Round  63, Global train loss: 0.886, Global test loss: 2.712, Global test accuracy: 16.00
Round  64, Train loss: 0.932, Test loss: 1.162, Test accuracy: 58.99
Round  64, Global train loss: 0.932, Global test loss: 2.713, Global test accuracy: 16.28
Round  65, Train loss: 0.901, Test loss: 1.177, Test accuracy: 58.53
Round  65, Global train loss: 0.901, Global test loss: 2.692, Global test accuracy: 14.52
Round  66, Train loss: 1.046, Test loss: 1.187, Test accuracy: 58.18
Round  66, Global train loss: 1.046, Global test loss: 2.821, Global test accuracy: 13.90
Round  67, Train loss: 0.985, Test loss: 1.197, Test accuracy: 58.10
Round  67, Global train loss: 0.985, Global test loss: 2.678, Global test accuracy: 13.34
Round  68, Train loss: 0.868, Test loss: 1.218, Test accuracy: 57.57
Round  68, Global train loss: 0.868, Global test loss: 2.841, Global test accuracy: 14.27
Round  69, Train loss: 1.062, Test loss: 1.226, Test accuracy: 57.28
Round  69, Global train loss: 1.062, Global test loss: 2.763, Global test accuracy: 13.40
Round  70, Train loss: 0.890, Test loss: 1.225, Test accuracy: 57.53
Round  70, Global train loss: 0.890, Global test loss: 2.901, Global test accuracy: 13.45
Round  71, Train loss: 0.951, Test loss: 1.226, Test accuracy: 57.24
Round  71, Global train loss: 0.951, Global test loss: 2.877, Global test accuracy: 14.54
Round  72, Train loss: 0.998, Test loss: 1.247, Test accuracy: 57.22
Round  72, Global train loss: 0.998, Global test loss: 2.950, Global test accuracy: 11.32
Round  73, Train loss: 0.908, Test loss: 1.275, Test accuracy: 56.71
Round  73, Global train loss: 0.908, Global test loss: 2.859, Global test accuracy: 13.95
Round  74, Train loss: 0.825, Test loss: 1.301, Test accuracy: 56.70
Round  74, Global train loss: 0.825, Global test loss: 3.078, Global test accuracy: 14.74
Round  75, Train loss: 0.847, Test loss: 1.307, Test accuracy: 56.17
Round  75, Global train loss: 0.847, Global test loss: 3.130, Global test accuracy: 14.53
Round  76, Train loss: 1.092, Test loss: 1.303, Test accuracy: 56.36
Round  76, Global train loss: 1.092, Global test loss: 2.793, Global test accuracy: 12.87
Round  77, Train loss: 0.710, Test loss: 1.308, Test accuracy: 56.00
Round  77, Global train loss: 0.710, Global test loss: 3.050, Global test accuracy: 13.31
Round  78, Train loss: 0.985, Test loss: 1.260, Test accuracy: 57.57
Round  78, Global train loss: 0.985, Global test loss: 2.933, Global test accuracy: 14.24
Round  79, Train loss: 0.834, Test loss: 1.277, Test accuracy: 57.31
Round  79, Global train loss: 0.834, Global test loss: 3.058, Global test accuracy: 14.03
Round  80, Train loss: 0.937, Test loss: 1.281, Test accuracy: 57.43
Round  80, Global train loss: 0.937, Global test loss: 3.012, Global test accuracy: 14.70
Round  81, Train loss: 0.808, Test loss: 1.272, Test accuracy: 57.56
Round  81, Global train loss: 0.808, Global test loss: 2.895, Global test accuracy: 14.98
Round  82, Train loss: 0.866, Test loss: 1.307, Test accuracy: 56.39
Round  82, Global train loss: 0.866, Global test loss: 2.838, Global test accuracy: 14.17
Round  83, Train loss: 0.800, Test loss: 1.339, Test accuracy: 56.28
Round  83, Global train loss: 0.800, Global test loss: 2.915, Global test accuracy: 15.28
Round  84, Train loss: 0.903, Test loss: 1.341, Test accuracy: 56.66
Round  84, Global train loss: 0.903, Global test loss: 3.033, Global test accuracy: 14.24
Round  85, Train loss: 0.816, Test loss: 1.364, Test accuracy: 56.11
Round  85, Global train loss: 0.816, Global test loss: 2.963, Global test accuracy: 13.28
Round  86, Train loss: 0.801, Test loss: 1.352, Test accuracy: 56.78
Round  86, Global train loss: 0.801, Global test loss: 3.177, Global test accuracy: 14.78
Round  87, Train loss: 0.817, Test loss: 1.357, Test accuracy: 57.06
Round  87, Global train loss: 0.817, Global test loss: 3.022, Global test accuracy: 13.57
Round  88, Train loss: 0.842, Test loss: 1.344, Test accuracy: 57.26
Round  88, Global train loss: 0.842, Global test loss: 3.038, Global test accuracy: 13.43
Round  89, Train loss: 0.888, Test loss: 1.329, Test accuracy: 57.71
Round  89, Global train loss: 0.888, Global test loss: 3.011, Global test accuracy: 12.98
Round  90, Train loss: 0.870, Test loss: 1.363, Test accuracy: 56.91
Round  90, Global train loss: 0.870, Global test loss: 2.996, Global test accuracy: 14.26
Round  91, Train loss: 0.844, Test loss: 1.365, Test accuracy: 56.38
Round  91, Global train loss: 0.844, Global test loss: 3.213, Global test accuracy: 14.44
Round  92, Train loss: 0.794, Test loss: 1.374, Test accuracy: 57.35
Round  92, Global train loss: 0.794, Global test loss: 3.277, Global test accuracy: 12.73
Round  93, Train loss: 0.733, Test loss: 1.389, Test accuracy: 56.53
Round  93, Global train loss: 0.733, Global test loss: 2.973, Global test accuracy: 14.85
Round  94, Train loss: 0.892, Test loss: 1.401, Test accuracy: 56.33
Round  94, Global train loss: 0.892, Global test loss: 3.176, Global test accuracy: 13.67
Round  95, Train loss: 0.646, Test loss: 1.404, Test accuracy: 56.28
Round  95, Global train loss: 0.646, Global test loss: 3.230, Global test accuracy: 14.31
Round  96, Train loss: 0.688, Test loss: 1.431, Test accuracy: 56.04
Round  96, Global train loss: 0.688, Global test loss: 3.367, Global test accuracy: 14.79
Round  97, Train loss: 0.836, Test loss: 1.429, Test accuracy: 55.91
Round  97, Global train loss: 0.836, Global test loss: 3.321, Global test accuracy: 13.65
Round  98, Train loss: 0.777, Test loss: 1.399, Test accuracy: 56.80
Round  98, Global train loss: 0.777, Global test loss: 3.055, Global test accuracy: 13.75
Round  99, Train loss: 0.626, Test loss: 1.406, Test accuracy: 57.00
Round  99, Global train loss: 0.626, Global test loss: 3.164, Global test accuracy: 14.11
Final Round, Train loss: 0.589, Test loss: 1.558, Test accuracy: 56.64
Final Round, Global train loss: 0.589, Global test loss: 3.164, Global test accuracy: 14.11
Average accuracy final 10 rounds: 56.553 

Average global accuracy final 10 rounds: 14.056 

1369.9272673130035
[1.4415688514709473, 2.8831377029418945, 4.029632329940796, 5.176126956939697, 6.323132276535034, 7.470137596130371, 8.623754024505615, 9.77737045288086, 10.930325984954834, 12.083281517028809, 13.24038290977478, 14.397484302520752, 15.557864427566528, 16.718244552612305, 17.864533185958862, 19.01082181930542, 20.155393838882446, 21.299965858459473, 22.448071002960205, 23.596176147460938, 24.746827840805054, 25.89747953414917, 27.04912519454956, 28.20077085494995, 29.34868025779724, 30.49658966064453, 31.64254665374756, 32.788503646850586, 33.936535358428955, 35.084567070007324, 36.23009204864502, 37.375617027282715, 38.52360963821411, 39.67160224914551, 40.65992331504822, 41.64824438095093, 42.63687038421631, 43.62549638748169, 44.62010335922241, 45.614710330963135, 46.60655426979065, 47.598398208618164, 48.586114168167114, 49.573830127716064, 50.575223445892334, 51.5766167640686, 52.57195067405701, 53.56728458404541, 54.557414293289185, 55.54754400253296, 56.54634380340576, 57.545143604278564, 58.545330286026, 59.54551696777344, 60.539419412612915, 61.53332185745239, 62.52593541145325, 63.5185489654541, 64.51906871795654, 65.51958847045898, 66.52393674850464, 67.5282850265503, 68.52541661262512, 69.52254819869995, 70.5218300819397, 71.52111196517944, 72.51748275756836, 73.51385354995728, 74.5183892250061, 75.52292490005493, 76.50998187065125, 77.49703884124756, 78.48127508163452, 79.46551132202148, 80.44918608665466, 81.43286085128784, 82.41324734687805, 83.39363384246826, 84.38218975067139, 85.37074565887451, 86.35974979400635, 87.34875392913818, 88.33795762062073, 89.32716131210327, 90.31745076179504, 91.30774021148682, 92.29724216461182, 93.28674411773682, 94.28748178482056, 95.2882194519043, 96.29116368293762, 97.29410791397095, 98.29902911186218, 99.30395030975342, 100.30725455284119, 101.31055879592896, 102.30997037887573, 103.30938196182251, 104.31283116340637, 105.31628036499023, 106.31933832168579, 107.32239627838135, 108.32380986213684, 109.32522344589233, 110.33174872398376, 111.3382740020752, 112.33855557441711, 113.33883714675903, 114.34086489677429, 115.34289264678955, 116.34691095352173, 117.3509292602539, 118.35091304779053, 119.35089683532715, 120.35021591186523, 121.34953498840332, 122.35185146331787, 123.35416793823242, 124.35695481300354, 125.35974168777466, 126.38992309570312, 127.42010450363159, 128.4172761440277, 129.41444778442383, 130.4126434326172, 131.41083908081055, 132.41179895401, 133.41275882720947, 134.41461896896362, 135.41647911071777, 136.4197301864624, 137.42298126220703, 138.42329621315002, 139.42361116409302, 140.41943955421448, 141.41526794433594, 142.4179253578186, 143.42058277130127, 144.41993880271912, 145.41929483413696, 146.4188084602356, 147.41832208633423, 148.4177656173706, 149.41720914840698, 150.41530179977417, 151.41339445114136, 152.41365480422974, 153.41391515731812, 154.41360068321228, 155.41328620910645, 156.40892148017883, 157.40455675125122, 158.40033054351807, 159.3961043357849, 160.40601992607117, 161.41593551635742, 162.41593837738037, 163.41594123840332, 164.415212392807, 165.4144835472107, 166.41451120376587, 167.41453886032104, 168.41579413414001, 169.41704940795898, 170.41619753837585, 171.41534566879272, 172.41676306724548, 173.41818046569824, 174.4189751148224, 175.41976976394653, 176.4186496734619, 177.4175295829773, 178.4162516593933, 179.41497373580933, 180.41254591941833, 181.41011810302734, 182.4064211845398, 183.40272426605225, 184.39486384391785, 185.38700342178345, 186.38524341583252, 187.3834834098816, 188.38498711585999, 189.38649082183838, 190.3817436695099, 191.3769965171814, 192.3689000606537, 193.36080360412598, 194.35791945457458, 195.3550353050232, 196.3517873287201, 197.348539352417, 198.34730076789856, 199.34606218338013, 200.34722185134888, 201.34838151931763, 202.34833335876465, 203.34828519821167, 204.36706805229187, 205.38585090637207, 207.38440942764282, 209.38296794891357]
[19.81, 19.81, 26.4, 26.4, 31.49, 31.49, 34.55, 34.55, 38.62, 38.62, 40.87, 40.87, 45.94, 45.94, 48.0, 48.0, 50.19, 50.19, 50.27, 50.27, 51.21, 51.21, 52.4, 52.4, 52.97, 52.97, 53.04, 53.04, 54.24, 54.24, 53.8, 53.8, 54.33, 54.33, 54.87, 54.87, 55.37, 55.37, 55.7, 55.7, 55.95, 55.95, 56.82, 56.82, 56.75, 56.75, 57.46, 57.46, 57.33, 57.33, 57.38, 57.38, 57.79, 57.79, 57.33, 57.33, 57.84, 57.84, 58.16, 58.16, 57.09, 57.09, 57.63, 57.63, 57.44, 57.44, 57.16, 57.16, 57.6, 57.6, 58.31, 58.31, 58.22, 58.22, 57.47, 57.47, 58.45, 58.45, 58.86, 58.86, 59.3, 59.3, 59.26, 59.26, 58.81, 58.81, 58.36, 58.36, 58.19, 58.19, 58.17, 58.17, 58.28, 58.28, 58.42, 58.42, 58.44, 58.44, 57.7, 57.7, 57.26, 57.26, 58.17, 58.17, 58.72, 58.72, 58.57, 58.57, 57.95, 57.95, 58.43, 58.43, 59.23, 59.23, 58.19, 58.19, 57.83, 57.83, 57.28, 57.28, 57.21, 57.21, 57.54, 57.54, 57.92, 57.92, 58.46, 58.46, 58.99, 58.99, 58.53, 58.53, 58.18, 58.18, 58.1, 58.1, 57.57, 57.57, 57.28, 57.28, 57.53, 57.53, 57.24, 57.24, 57.22, 57.22, 56.71, 56.71, 56.7, 56.7, 56.17, 56.17, 56.36, 56.36, 56.0, 56.0, 57.57, 57.57, 57.31, 57.31, 57.43, 57.43, 57.56, 57.56, 56.39, 56.39, 56.28, 56.28, 56.66, 56.66, 56.11, 56.11, 56.78, 56.78, 57.06, 57.06, 57.26, 57.26, 57.71, 57.71, 56.91, 56.91, 56.38, 56.38, 57.35, 57.35, 56.53, 56.53, 56.33, 56.33, 56.28, 56.28, 56.04, 56.04, 55.91, 55.91, 56.8, 56.8, 57.0, 57.0, 56.64, 56.64]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.713, Test loss: 2.134, Test accuracy: 17.89
Round   0, Global train loss: 1.713, Global test loss: 2.343, Global test accuracy: 11.99
Round   1, Train loss: 1.608, Test loss: 2.017, Test accuracy: 23.05
Round   1, Global train loss: 1.608, Global test loss: 2.513, Global test accuracy: 10.60
Round   2, Train loss: 1.568, Test loss: 1.919, Test accuracy: 28.34
Round   2, Global train loss: 1.568, Global test loss: 2.542, Global test accuracy: 9.12
Round   3, Train loss: 1.569, Test loss: 1.692, Test accuracy: 33.31
Round   3, Global train loss: 1.569, Global test loss: 2.395, Global test accuracy: 11.63
Round   4, Train loss: 1.482, Test loss: 1.648, Test accuracy: 35.00
Round   4, Global train loss: 1.482, Global test loss: 2.396, Global test accuracy: 14.67
Round   5, Train loss: 1.423, Test loss: 1.557, Test accuracy: 37.77
Round   5, Global train loss: 1.423, Global test loss: 2.406, Global test accuracy: 14.49
Round   6, Train loss: 1.535, Test loss: 1.414, Test accuracy: 42.40
Round   6, Global train loss: 1.535, Global test loss: 2.415, Global test accuracy: 13.74
Round   7, Train loss: 1.523, Test loss: 1.338, Test accuracy: 44.81
Round   7, Global train loss: 1.523, Global test loss: 2.282, Global test accuracy: 16.27
Round   8, Train loss: 1.496, Test loss: 1.311, Test accuracy: 46.35
Round   8, Global train loss: 1.496, Global test loss: 2.357, Global test accuracy: 13.16
Round   9, Train loss: 1.464, Test loss: 1.294, Test accuracy: 46.62
Round   9, Global train loss: 1.464, Global test loss: 2.373, Global test accuracy: 11.67
Round  10, Train loss: 1.520, Test loss: 1.260, Test accuracy: 48.54
Round  10, Global train loss: 1.520, Global test loss: 2.376, Global test accuracy: 13.29
Round  11, Train loss: 1.507, Test loss: 1.261, Test accuracy: 48.64
Round  11, Global train loss: 1.507, Global test loss: 2.387, Global test accuracy: 13.80
Round  12, Train loss: 1.363, Test loss: 1.251, Test accuracy: 49.26
Round  12, Global train loss: 1.363, Global test loss: 2.467, Global test accuracy: 11.24
Round  13, Train loss: 1.465, Test loss: 1.234, Test accuracy: 50.84
Round  13, Global train loss: 1.465, Global test loss: 2.357, Global test accuracy: 14.59
Round  14, Train loss: 1.542, Test loss: 1.236, Test accuracy: 51.41
Round  14, Global train loss: 1.542, Global test loss: 2.455, Global test accuracy: 14.26
Round  15, Train loss: 1.418, Test loss: 1.223, Test accuracy: 51.51
Round  15, Global train loss: 1.418, Global test loss: 2.364, Global test accuracy: 14.89
Round  16, Train loss: 1.409, Test loss: 1.204, Test accuracy: 52.91
Round  16, Global train loss: 1.409, Global test loss: 2.413, Global test accuracy: 12.82
Round  17, Train loss: 1.390, Test loss: 1.200, Test accuracy: 54.14
Round  17, Global train loss: 1.390, Global test loss: 2.329, Global test accuracy: 12.80
Round  18, Train loss: 1.319, Test loss: 1.192, Test accuracy: 54.32
Round  18, Global train loss: 1.319, Global test loss: 2.402, Global test accuracy: 14.06
Round  19, Train loss: 1.400, Test loss: 1.205, Test accuracy: 53.73
Round  19, Global train loss: 1.400, Global test loss: 2.349, Global test accuracy: 13.67
Round  20, Train loss: 1.363, Test loss: 1.198, Test accuracy: 54.04
Round  20, Global train loss: 1.363, Global test loss: 2.414, Global test accuracy: 14.12
Round  21, Train loss: 1.438, Test loss: 1.180, Test accuracy: 54.81
Round  21, Global train loss: 1.438, Global test loss: 2.385, Global test accuracy: 14.44
Round  22, Train loss: 1.310, Test loss: 1.177, Test accuracy: 54.84
Round  22, Global train loss: 1.310, Global test loss: 2.341, Global test accuracy: 15.05
Round  23, Train loss: 1.312, Test loss: 1.174, Test accuracy: 55.45
Round  23, Global train loss: 1.312, Global test loss: 2.406, Global test accuracy: 13.80
Round  24, Train loss: 1.237, Test loss: 1.169, Test accuracy: 55.64
Round  24, Global train loss: 1.237, Global test loss: 2.452, Global test accuracy: 15.14
Round  25, Train loss: 1.434, Test loss: 1.161, Test accuracy: 55.82
Round  25, Global train loss: 1.434, Global test loss: 2.380, Global test accuracy: 13.36
Round  26, Train loss: 1.314, Test loss: 1.155, Test accuracy: 55.46
Round  26, Global train loss: 1.314, Global test loss: 2.419, Global test accuracy: 15.42
Round  27, Train loss: 1.314, Test loss: 1.134, Test accuracy: 56.87
Round  27, Global train loss: 1.314, Global test loss: 2.451, Global test accuracy: 14.37
Round  28, Train loss: 1.333, Test loss: 1.136, Test accuracy: 57.14
Round  28, Global train loss: 1.333, Global test loss: 2.396, Global test accuracy: 15.59
Round  29, Train loss: 1.342, Test loss: 1.130, Test accuracy: 57.37
Round  29, Global train loss: 1.342, Global test loss: 2.542, Global test accuracy: 14.12
Round  30, Train loss: 1.359, Test loss: 1.141, Test accuracy: 56.43
Round  30, Global train loss: 1.359, Global test loss: 2.359, Global test accuracy: 16.59
Round  31, Train loss: 1.328, Test loss: 1.119, Test accuracy: 56.91
Round  31, Global train loss: 1.328, Global test loss: 2.365, Global test accuracy: 14.44
Round  32, Train loss: 1.240, Test loss: 1.121, Test accuracy: 56.94
Round  32, Global train loss: 1.240, Global test loss: 2.451, Global test accuracy: 15.15
Round  33, Train loss: 1.130, Test loss: 1.127, Test accuracy: 56.97
Round  33, Global train loss: 1.130, Global test loss: 2.422, Global test accuracy: 16.40
Round  34, Train loss: 1.302, Test loss: 1.136, Test accuracy: 57.13
Round  34, Global train loss: 1.302, Global test loss: 2.364, Global test accuracy: 15.03
Round  35, Train loss: 1.244, Test loss: 1.128, Test accuracy: 57.67
Round  35, Global train loss: 1.244, Global test loss: 2.484, Global test accuracy: 14.83
Round  36, Train loss: 1.164, Test loss: 1.130, Test accuracy: 57.02
Round  36, Global train loss: 1.164, Global test loss: 2.480, Global test accuracy: 14.04
Round  37, Train loss: 1.263, Test loss: 1.127, Test accuracy: 57.36
Round  37, Global train loss: 1.263, Global test loss: 2.527, Global test accuracy: 14.73
Round  38, Train loss: 1.166, Test loss: 1.127, Test accuracy: 57.84
Round  38, Global train loss: 1.166, Global test loss: 2.499, Global test accuracy: 15.46
Round  39, Train loss: 1.265, Test loss: 1.129, Test accuracy: 57.72
Round  39, Global train loss: 1.265, Global test loss: 2.422, Global test accuracy: 16.88
Round  40, Train loss: 1.152, Test loss: 1.134, Test accuracy: 57.65
Round  40, Global train loss: 1.152, Global test loss: 2.395, Global test accuracy: 16.65
Round  41, Train loss: 1.287, Test loss: 1.125, Test accuracy: 58.07
Round  41, Global train loss: 1.287, Global test loss: 2.464, Global test accuracy: 15.21
Round  42, Train loss: 1.091, Test loss: 1.114, Test accuracy: 58.64
Round  42, Global train loss: 1.091, Global test loss: 2.679, Global test accuracy: 15.33
Round  43, Train loss: 1.260, Test loss: 1.120, Test accuracy: 58.42
Round  43, Global train loss: 1.260, Global test loss: 2.501, Global test accuracy: 13.08
Round  44, Train loss: 1.180, Test loss: 1.132, Test accuracy: 58.43
Round  44, Global train loss: 1.180, Global test loss: 2.417, Global test accuracy: 14.75
Round  45, Train loss: 1.275, Test loss: 1.128, Test accuracy: 58.13
Round  45, Global train loss: 1.275, Global test loss: 2.429, Global test accuracy: 13.25
Round  46, Train loss: 1.076, Test loss: 1.121, Test accuracy: 58.17
Round  46, Global train loss: 1.076, Global test loss: 2.448, Global test accuracy: 14.21
Round  47, Train loss: 1.180, Test loss: 1.117, Test accuracy: 57.86
Round  47, Global train loss: 1.180, Global test loss: 2.456, Global test accuracy: 14.54
Round  48, Train loss: 1.204, Test loss: 1.117, Test accuracy: 57.93
Round  48, Global train loss: 1.204, Global test loss: 2.527, Global test accuracy: 13.05
Round  49, Train loss: 1.206, Test loss: 1.124, Test accuracy: 58.11
Round  49, Global train loss: 1.206, Global test loss: 2.550, Global test accuracy: 13.57
Round  50, Train loss: 1.044, Test loss: 1.116, Test accuracy: 58.78
Round  50, Global train loss: 1.044, Global test loss: 2.681, Global test accuracy: 15.16
Round  51, Train loss: 1.152, Test loss: 1.134, Test accuracy: 58.45
Round  51, Global train loss: 1.152, Global test loss: 2.464, Global test accuracy: 14.66
Round  52, Train loss: 1.202, Test loss: 1.123, Test accuracy: 58.49
Round  52, Global train loss: 1.202, Global test loss: 2.522, Global test accuracy: 15.64
Round  53, Train loss: 1.034, Test loss: 1.124, Test accuracy: 58.85
Round  53, Global train loss: 1.034, Global test loss: 2.656, Global test accuracy: 15.55
Round  54, Train loss: 1.066, Test loss: 1.105, Test accuracy: 59.63
Round  54, Global train loss: 1.066, Global test loss: 2.769, Global test accuracy: 14.00
Round  55, Train loss: 0.835, Test loss: 1.109, Test accuracy: 59.58
Round  55, Global train loss: 0.835, Global test loss: 3.114, Global test accuracy: 13.86
Round  56, Train loss: 1.137, Test loss: 1.111, Test accuracy: 59.62
Round  56, Global train loss: 1.137, Global test loss: 2.580, Global test accuracy: 15.41
Round  57, Train loss: 0.961, Test loss: 1.116, Test accuracy: 59.32
Round  57, Global train loss: 0.961, Global test loss: 2.566, Global test accuracy: 14.98
Round  58, Train loss: 1.135, Test loss: 1.130, Test accuracy: 58.79
Round  58, Global train loss: 1.135, Global test loss: 2.477, Global test accuracy: 16.02
Round  59, Train loss: 1.012, Test loss: 1.133, Test accuracy: 58.77
Round  59, Global train loss: 1.012, Global test loss: 2.508, Global test accuracy: 16.98
Round  60, Train loss: 1.033, Test loss: 1.126, Test accuracy: 58.81
Round  60, Global train loss: 1.033, Global test loss: 2.610, Global test accuracy: 16.35
Round  61, Train loss: 1.046, Test loss: 1.129, Test accuracy: 58.67
Round  61, Global train loss: 1.046, Global test loss: 2.638, Global test accuracy: 16.36
Round  62, Train loss: 1.081, Test loss: 1.165, Test accuracy: 57.32
Round  62, Global train loss: 1.081, Global test loss: 2.649, Global test accuracy: 14.43
Round  63, Train loss: 1.063, Test loss: 1.154, Test accuracy: 57.66
Round  63, Global train loss: 1.063, Global test loss: 2.758, Global test accuracy: 13.29
Round  64, Train loss: 1.063, Test loss: 1.167, Test accuracy: 57.22
Round  64, Global train loss: 1.063, Global test loss: 2.607, Global test accuracy: 14.91
Round  65, Train loss: 1.014, Test loss: 1.177, Test accuracy: 57.20
Round  65, Global train loss: 1.014, Global test loss: 2.823, Global test accuracy: 14.15
Round  66, Train loss: 1.051, Test loss: 1.186, Test accuracy: 57.31
Round  66, Global train loss: 1.051, Global test loss: 2.640, Global test accuracy: 14.99
Round  67, Train loss: 1.174, Test loss: 1.174, Test accuracy: 57.55
Round  67, Global train loss: 1.174, Global test loss: 2.596, Global test accuracy: 13.45
Round  68, Train loss: 0.987, Test loss: 1.181, Test accuracy: 57.54
Round  68, Global train loss: 0.987, Global test loss: 2.643, Global test accuracy: 15.06
Round  69, Train loss: 1.084, Test loss: 1.180, Test accuracy: 57.57
Round  69, Global train loss: 1.084, Global test loss: 2.721, Global test accuracy: 14.85
Round  70, Train loss: 0.994, Test loss: 1.174, Test accuracy: 57.84
Round  70, Global train loss: 0.994, Global test loss: 2.715, Global test accuracy: 14.99
Round  71, Train loss: 0.950, Test loss: 1.184, Test accuracy: 57.22
Round  71, Global train loss: 0.950, Global test loss: 2.668, Global test accuracy: 15.06
Round  72, Train loss: 1.089, Test loss: 1.167, Test accuracy: 57.56
Round  72, Global train loss: 1.089, Global test loss: 2.692, Global test accuracy: 13.26
Round  73, Train loss: 1.084, Test loss: 1.184, Test accuracy: 57.12
Round  73, Global train loss: 1.084, Global test loss: 2.752, Global test accuracy: 13.52
Round  74, Train loss: 0.866, Test loss: 1.204, Test accuracy: 56.65
Round  74, Global train loss: 0.866, Global test loss: 2.908, Global test accuracy: 15.10
Round  75, Train loss: 1.107, Test loss: 1.200, Test accuracy: 56.74
Round  75, Global train loss: 1.107, Global test loss: 2.755, Global test accuracy: 12.90
Round  76, Train loss: 1.097, Test loss: 1.220, Test accuracy: 56.53
Round  76, Global train loss: 1.097, Global test loss: 2.773, Global test accuracy: 13.79
Round  77, Train loss: 0.964, Test loss: 1.202, Test accuracy: 57.49
Round  77, Global train loss: 0.964, Global test loss: 2.749, Global test accuracy: 14.79
Round  78, Train loss: 0.854, Test loss: 1.246, Test accuracy: 57.08
Round  78, Global train loss: 0.854, Global test loss: 2.770, Global test accuracy: 15.18
Round  79, Train loss: 0.850, Test loss: 1.278, Test accuracy: 56.36
Round  79, Global train loss: 0.850, Global test loss: 2.808, Global test accuracy: 15.67
Round  80, Train loss: 0.992, Test loss: 1.253, Test accuracy: 56.77
Round  80, Global train loss: 0.992, Global test loss: 2.760, Global test accuracy: 14.43
Round  81, Train loss: 1.000, Test loss: 1.270, Test accuracy: 56.34
Round  81, Global train loss: 1.000, Global test loss: 3.003, Global test accuracy: 13.73
Round  82, Train loss: 0.902, Test loss: 1.241, Test accuracy: 56.77
Round  82, Global train loss: 0.902, Global test loss: 2.850, Global test accuracy: 15.23
Round  83, Train loss: 0.822, Test loss: 1.257, Test accuracy: 57.02
Round  83, Global train loss: 0.822, Global test loss: 2.995, Global test accuracy: 14.40
Round  84, Train loss: 1.092, Test loss: 1.271, Test accuracy: 56.69
Round  84, Global train loss: 1.092, Global test loss: 2.882, Global test accuracy: 14.05
Round  85, Train loss: 0.922, Test loss: 1.256, Test accuracy: 57.19
Round  85, Global train loss: 0.922, Global test loss: 2.970, Global test accuracy: 13.66
Round  86, Train loss: 0.785, Test loss: 1.260, Test accuracy: 56.66
Round  86, Global train loss: 0.785, Global test loss: 3.179, Global test accuracy: 13.77
Round  87, Train loss: 0.849, Test loss: 1.262, Test accuracy: 56.50
Round  87, Global train loss: 0.849, Global test loss: 3.138, Global test accuracy: 14.60
Round  88, Train loss: 0.900, Test loss: 1.288, Test accuracy: 56.11
Round  88, Global train loss: 0.900, Global test loss: 3.035, Global test accuracy: 14.47
Round  89, Train loss: 0.941, Test loss: 1.293, Test accuracy: 55.98
Round  89, Global train loss: 0.941, Global test loss: 2.959, Global test accuracy: 14.59
Round  90, Train loss: 1.063, Test loss: 1.254, Test accuracy: 56.82
Round  90, Global train loss: 1.063, Global test loss: 2.800, Global test accuracy: 13.85
Round  91, Train loss: 0.871, Test loss: 1.289, Test accuracy: 56.88
Round  91, Global train loss: 0.871, Global test loss: 3.038, Global test accuracy: 13.91
Round  92, Train loss: 0.827, Test loss: 1.307, Test accuracy: 56.70
Round  92, Global train loss: 0.827, Global test loss: 3.011, Global test accuracy: 15.77/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  93, Train loss: 0.746, Test loss: 1.296, Test accuracy: 57.13
Round  93, Global train loss: 0.746, Global test loss: 2.955, Global test accuracy: 15.32
Round  94, Train loss: 0.865, Test loss: 1.293, Test accuracy: 57.44
Round  94, Global train loss: 0.865, Global test loss: 3.046, Global test accuracy: 15.40
Round  95, Train loss: 0.803, Test loss: 1.303, Test accuracy: 57.13
Round  95, Global train loss: 0.803, Global test loss: 3.241, Global test accuracy: 13.07
Round  96, Train loss: 0.729, Test loss: 1.323, Test accuracy: 56.44
Round  96, Global train loss: 0.729, Global test loss: 3.149, Global test accuracy: 16.31
Round  97, Train loss: 0.955, Test loss: 1.336, Test accuracy: 56.45
Round  97, Global train loss: 0.955, Global test loss: 3.195, Global test accuracy: 13.61
Round  98, Train loss: 0.889, Test loss: 1.324, Test accuracy: 56.63
Round  98, Global train loss: 0.889, Global test loss: 3.031, Global test accuracy: 14.22
Round  99, Train loss: 0.817, Test loss: 1.329, Test accuracy: 56.65
Round  99, Global train loss: 0.817, Global test loss: 3.003, Global test accuracy: 13.57
Final Round, Train loss: 0.703, Test loss: 1.417, Test accuracy: 56.22
Final Round, Global train loss: 0.703, Global test loss: 3.003, Global test accuracy: 13.57
Average accuracy final 10 rounds: 56.827000000000005 

Average global accuracy final 10 rounds: 14.503 

1403.7798743247986
[1.4869365692138672, 2.9738731384277344, 4.1895904541015625, 5.405307769775391, 6.619170427322388, 7.833033084869385, 9.049170017242432, 10.265306949615479, 11.478371858596802, 12.691436767578125, 13.923949480056763, 15.1564621925354, 16.384775638580322, 17.613089084625244, 18.836047649383545, 20.059006214141846, 21.285950422286987, 22.51289463043213, 23.584892511367798, 24.656890392303467, 25.730590343475342, 26.804290294647217, 27.881673574447632, 28.959056854248047, 30.03099036216736, 31.10292387008667, 32.17701578140259, 33.251107692718506, 34.316370487213135, 35.381633281707764, 36.45539975166321, 37.52916622161865, 38.60335326194763, 39.67754030227661, 40.7503547668457, 41.823169231414795, 42.88959860801697, 43.95602798461914, 45.03167271614075, 46.10731744766235, 47.18101453781128, 48.254711627960205, 49.329249143600464, 50.40378665924072, 51.47600722312927, 52.54822778701782, 53.62034773826599, 54.69246768951416, 55.76003980636597, 56.82761192321777, 57.90919256210327, 58.99077320098877, 60.06462264060974, 61.13847208023071, 62.2079496383667, 63.277427196502686, 64.35950088500977, 65.44157457351685, 66.51542091369629, 67.58926725387573, 68.66562485694885, 69.74198246002197, 70.81814050674438, 71.8942985534668, 72.96824145317078, 74.04218435287476, 75.11600589752197, 76.18982744216919, 77.25458359718323, 78.31933975219727, 79.38905262947083, 80.45876550674438, 81.52929186820984, 82.5998182296753, 83.67550206184387, 84.75118589401245, 85.81686210632324, 86.88253831863403, 87.96099829673767, 89.03945827484131, 90.12317323684692, 91.20688819885254, 92.28113913536072, 93.3553900718689, 94.42148780822754, 95.48758554458618, 96.56178212165833, 97.63597869873047, 98.70948719978333, 99.78299570083618, 100.85570573806763, 101.92841577529907, 103.0030825138092, 104.07774925231934, 105.16367435455322, 106.24959945678711, 107.33088231086731, 108.41216516494751, 109.4788990020752, 110.54563283920288, 111.62093043327332, 112.69622802734375, 113.78330636024475, 114.87038469314575, 115.96163558959961, 117.05288648605347, 118.12639832496643, 119.1999101638794, 120.27170753479004, 121.34350490570068, 122.42033672332764, 123.49716854095459, 124.57402849197388, 125.65088844299316, 126.73288631439209, 127.81488418579102, 128.89655900001526, 129.9782338142395, 131.05493593215942, 132.13163805007935, 133.21329045295715, 134.29494285583496, 135.37210512161255, 136.44926738739014, 137.53936195373535, 138.62945652008057, 139.70083284378052, 140.77220916748047, 141.84040665626526, 142.90860414505005, 143.9763948917389, 145.04418563842773, 146.10994458198547, 147.1757035255432, 148.24671578407288, 149.31772804260254, 150.39051985740662, 151.4633116722107, 152.5288679599762, 153.5944242477417, 154.66521549224854, 155.73600673675537, 156.80485916137695, 157.87371158599854, 158.93829774856567, 160.0028839111328, 161.07262539863586, 162.14236688613892, 163.21457886695862, 164.28679084777832, 165.35818147659302, 166.42957210540771, 167.50532126426697, 168.58107042312622, 169.65573573112488, 170.73040103912354, 171.80454659461975, 172.87869215011597, 173.94446516036987, 175.01023817062378, 176.07903599739075, 177.14783382415771, 178.22551727294922, 179.30320072174072, 180.36747121810913, 181.43174171447754, 182.50424003601074, 183.57673835754395, 184.6436676979065, 185.71059703826904, 186.78613185882568, 187.86166667938232, 188.93892812728882, 190.0161895751953, 191.09812426567078, 192.18005895614624, 193.25440645217896, 194.32875394821167, 195.4071125984192, 196.4854712486267, 197.56265687942505, 198.6398425102234, 199.7098832130432, 200.77992391586304, 201.86355781555176, 202.94719171524048, 204.01792311668396, 205.08865451812744, 206.16028237342834, 207.23191022872925, 208.2995903491974, 209.36727046966553, 210.43491506576538, 211.50255966186523, 212.5734965801239, 213.64443349838257, 214.7145962715149, 215.78475904464722, 216.85718083381653, 217.92960262298584, 220.09055948257446, 222.2515163421631]
[17.89, 17.89, 23.05, 23.05, 28.34, 28.34, 33.31, 33.31, 35.0, 35.0, 37.77, 37.77, 42.4, 42.4, 44.81, 44.81, 46.35, 46.35, 46.62, 46.62, 48.54, 48.54, 48.64, 48.64, 49.26, 49.26, 50.84, 50.84, 51.41, 51.41, 51.51, 51.51, 52.91, 52.91, 54.14, 54.14, 54.32, 54.32, 53.73, 53.73, 54.04, 54.04, 54.81, 54.81, 54.84, 54.84, 55.45, 55.45, 55.64, 55.64, 55.82, 55.82, 55.46, 55.46, 56.87, 56.87, 57.14, 57.14, 57.37, 57.37, 56.43, 56.43, 56.91, 56.91, 56.94, 56.94, 56.97, 56.97, 57.13, 57.13, 57.67, 57.67, 57.02, 57.02, 57.36, 57.36, 57.84, 57.84, 57.72, 57.72, 57.65, 57.65, 58.07, 58.07, 58.64, 58.64, 58.42, 58.42, 58.43, 58.43, 58.13, 58.13, 58.17, 58.17, 57.86, 57.86, 57.93, 57.93, 58.11, 58.11, 58.78, 58.78, 58.45, 58.45, 58.49, 58.49, 58.85, 58.85, 59.63, 59.63, 59.58, 59.58, 59.62, 59.62, 59.32, 59.32, 58.79, 58.79, 58.77, 58.77, 58.81, 58.81, 58.67, 58.67, 57.32, 57.32, 57.66, 57.66, 57.22, 57.22, 57.2, 57.2, 57.31, 57.31, 57.55, 57.55, 57.54, 57.54, 57.57, 57.57, 57.84, 57.84, 57.22, 57.22, 57.56, 57.56, 57.12, 57.12, 56.65, 56.65, 56.74, 56.74, 56.53, 56.53, 57.49, 57.49, 57.08, 57.08, 56.36, 56.36, 56.77, 56.77, 56.34, 56.34, 56.77, 56.77, 57.02, 57.02, 56.69, 56.69, 57.19, 57.19, 56.66, 56.66, 56.5, 56.5, 56.11, 56.11, 55.98, 55.98, 56.82, 56.82, 56.88, 56.88, 56.7, 56.7, 57.13, 57.13, 57.44, 57.44, 57.13, 57.13, 56.44, 56.44, 56.45, 56.45, 56.63, 56.63, 56.65, 56.65, 56.22, 56.22]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.797, Test loss: 2.130, Test accuracy: 15.64
Round   0, Global train loss: 1.797, Global test loss: 2.309, Global test accuracy: 12.10
Round   1, Train loss: 1.611, Test loss: 1.993, Test accuracy: 23.90
Round   1, Global train loss: 1.611, Global test loss: 2.418, Global test accuracy: 16.78
Round   2, Train loss: 1.574, Test loss: 1.872, Test accuracy: 26.30
Round   2, Global train loss: 1.574, Global test loss: 2.401, Global test accuracy: 13.40
Round   3, Train loss: 1.538, Test loss: 1.749, Test accuracy: 31.62
Round   3, Global train loss: 1.538, Global test loss: 2.447, Global test accuracy: 16.50
Round   4, Train loss: 1.566, Test loss: 1.693, Test accuracy: 35.21
Round   4, Global train loss: 1.566, Global test loss: 2.438, Global test accuracy: 16.64
Round   5, Train loss: 1.460, Test loss: 1.623, Test accuracy: 36.49
Round   5, Global train loss: 1.460, Global test loss: 2.557, Global test accuracy: 12.12
Round   6, Train loss: 1.499, Test loss: 1.461, Test accuracy: 41.45
Round   6, Global train loss: 1.499, Global test loss: 2.365, Global test accuracy: 16.53
Round   7, Train loss: 1.422, Test loss: 1.399, Test accuracy: 44.05
Round   7, Global train loss: 1.422, Global test loss: 2.386, Global test accuracy: 15.78
Round   8, Train loss: 1.480, Test loss: 1.379, Test accuracy: 45.83
Round   8, Global train loss: 1.480, Global test loss: 2.419, Global test accuracy: 12.94
Round   9, Train loss: 1.465, Test loss: 1.378, Test accuracy: 46.15
Round   9, Global train loss: 1.465, Global test loss: 2.510, Global test accuracy: 12.66
Round  10, Train loss: 1.443, Test loss: 1.352, Test accuracy: 48.53
Round  10, Global train loss: 1.443, Global test loss: 2.582, Global test accuracy: 16.67
Round  11, Train loss: 1.432, Test loss: 1.342, Test accuracy: 48.78
Round  11, Global train loss: 1.432, Global test loss: 2.568, Global test accuracy: 16.60
Round  12, Train loss: 1.411, Test loss: 1.346, Test accuracy: 49.06
Round  12, Global train loss: 1.411, Global test loss: 2.597, Global test accuracy: 16.44
Round  13, Train loss: 1.454, Test loss: 1.349, Test accuracy: 48.86
Round  13, Global train loss: 1.454, Global test loss: 2.407, Global test accuracy: 15.28
Round  14, Train loss: 1.325, Test loss: 1.360, Test accuracy: 49.34
Round  14, Global train loss: 1.325, Global test loss: 2.473, Global test accuracy: 16.67
Round  15, Train loss: 1.490, Test loss: 1.338, Test accuracy: 49.16
Round  15, Global train loss: 1.490, Global test loss: 2.562, Global test accuracy: 16.89
Round  16, Train loss: 1.328, Test loss: 1.312, Test accuracy: 50.66
Round  16, Global train loss: 1.328, Global test loss: 2.462, Global test accuracy: 14.49
Round  17, Train loss: 1.392, Test loss: 1.307, Test accuracy: 51.25
Round  17, Global train loss: 1.392, Global test loss: 2.600, Global test accuracy: 17.91
Round  18, Train loss: 1.349, Test loss: 1.308, Test accuracy: 51.87
Round  18, Global train loss: 1.349, Global test loss: 2.491, Global test accuracy: 17.04
Round  19, Train loss: 1.270, Test loss: 1.288, Test accuracy: 52.22
Round  19, Global train loss: 1.270, Global test loss: 2.514, Global test accuracy: 16.74
Round  20, Train loss: 1.231, Test loss: 1.277, Test accuracy: 52.37
Round  20, Global train loss: 1.231, Global test loss: 2.624, Global test accuracy: 17.65
Round  21, Train loss: 1.345, Test loss: 1.278, Test accuracy: 52.88
Round  21, Global train loss: 1.345, Global test loss: 2.411, Global test accuracy: 16.86
Round  22, Train loss: 1.400, Test loss: 1.265, Test accuracy: 53.59
Round  22, Global train loss: 1.400, Global test loss: 2.618, Global test accuracy: 16.45
Round  23, Train loss: 1.335, Test loss: 1.257, Test accuracy: 53.93
Round  23, Global train loss: 1.335, Global test loss: 2.495, Global test accuracy: 15.71
Round  24, Train loss: 1.269, Test loss: 1.259, Test accuracy: 53.36
Round  24, Global train loss: 1.269, Global test loss: 2.536, Global test accuracy: 16.78
Round  25, Train loss: 1.288, Test loss: 1.266, Test accuracy: 53.35
Round  25, Global train loss: 1.288, Global test loss: 2.548, Global test accuracy: 17.09
Round  26, Train loss: 1.192, Test loss: 1.256, Test accuracy: 53.82
Round  26, Global train loss: 1.192, Global test loss: 2.398, Global test accuracy: 14.98
Round  27, Train loss: 1.327, Test loss: 1.256, Test accuracy: 53.64
Round  27, Global train loss: 1.327, Global test loss: 2.459, Global test accuracy: 16.74
Round  28, Train loss: 1.191, Test loss: 1.262, Test accuracy: 53.95
Round  28, Global train loss: 1.191, Global test loss: 2.469, Global test accuracy: 17.36
Round  29, Train loss: 1.161, Test loss: 1.256, Test accuracy: 54.42
Round  29, Global train loss: 1.161, Global test loss: 2.556, Global test accuracy: 15.66
Round  30, Train loss: 1.191, Test loss: 1.236, Test accuracy: 54.60
Round  30, Global train loss: 1.191, Global test loss: 2.462, Global test accuracy: 15.44
Round  31, Train loss: 1.091, Test loss: 1.238, Test accuracy: 54.09
Round  31, Global train loss: 1.091, Global test loss: 2.548, Global test accuracy: 15.82
Round  32, Train loss: 1.247, Test loss: 1.248, Test accuracy: 53.88
Round  32, Global train loss: 1.247, Global test loss: 2.508, Global test accuracy: 14.05
Round  33, Train loss: 1.137, Test loss: 1.244, Test accuracy: 54.79
Round  33, Global train loss: 1.137, Global test loss: 2.587, Global test accuracy: 18.18
Round  34, Train loss: 1.128, Test loss: 1.244, Test accuracy: 54.23
Round  34, Global train loss: 1.128, Global test loss: 2.555, Global test accuracy: 15.75
Round  35, Train loss: 1.228, Test loss: 1.224, Test accuracy: 55.25
Round  35, Global train loss: 1.228, Global test loss: 2.451, Global test accuracy: 16.79
Round  36, Train loss: 1.309, Test loss: 1.244, Test accuracy: 54.67
Round  36, Global train loss: 1.309, Global test loss: 2.668, Global test accuracy: 19.27
Round  37, Train loss: 1.098, Test loss: 1.243, Test accuracy: 55.81
Round  37, Global train loss: 1.098, Global test loss: 2.785, Global test accuracy: 16.07
Round  38, Train loss: 1.166, Test loss: 1.273, Test accuracy: 55.50
Round  38, Global train loss: 1.166, Global test loss: 2.538, Global test accuracy: 14.48
Round  39, Train loss: 0.983, Test loss: 1.235, Test accuracy: 55.89
Round  39, Global train loss: 0.983, Global test loss: 2.586, Global test accuracy: 14.51
Round  40, Train loss: 1.181, Test loss: 1.230, Test accuracy: 55.72
Round  40, Global train loss: 1.181, Global test loss: 2.494, Global test accuracy: 16.79
Round  41, Train loss: 1.090, Test loss: 1.229, Test accuracy: 56.34
Round  41, Global train loss: 1.090, Global test loss: 2.622, Global test accuracy: 16.54
Round  42, Train loss: 1.037, Test loss: 1.226, Test accuracy: 56.33
Round  42, Global train loss: 1.037, Global test loss: 2.612, Global test accuracy: 17.37
Round  43, Train loss: 1.151, Test loss: 1.235, Test accuracy: 55.67
Round  43, Global train loss: 1.151, Global test loss: 2.533, Global test accuracy: 15.19
Round  44, Train loss: 1.057, Test loss: 1.228, Test accuracy: 56.13
Round  44, Global train loss: 1.057, Global test loss: 2.489, Global test accuracy: 16.43
Round  45, Train loss: 1.193, Test loss: 1.252, Test accuracy: 55.34
Round  45, Global train loss: 1.193, Global test loss: 2.547, Global test accuracy: 17.56
Round  46, Train loss: 1.176, Test loss: 1.238, Test accuracy: 55.45
Round  46, Global train loss: 1.176, Global test loss: 2.561, Global test accuracy: 17.95
Round  47, Train loss: 1.114, Test loss: 1.246, Test accuracy: 55.83
Round  47, Global train loss: 1.114, Global test loss: 2.636, Global test accuracy: 15.84
Round  48, Train loss: 1.126, Test loss: 1.243, Test accuracy: 55.63
Round  48, Global train loss: 1.126, Global test loss: 2.584, Global test accuracy: 17.64
Round  49, Train loss: 1.077, Test loss: 1.241, Test accuracy: 55.76
Round  49, Global train loss: 1.077, Global test loss: 2.641, Global test accuracy: 17.79
Round  50, Train loss: 1.122, Test loss: 1.235, Test accuracy: 56.25
Round  50, Global train loss: 1.122, Global test loss: 2.701, Global test accuracy: 13.92
Round  51, Train loss: 1.077, Test loss: 1.239, Test accuracy: 56.04
Round  51, Global train loss: 1.077, Global test loss: 2.844, Global test accuracy: 14.76
Round  52, Train loss: 1.112, Test loss: 1.220, Test accuracy: 56.40
Round  52, Global train loss: 1.112, Global test loss: 2.584, Global test accuracy: 14.97
Round  53, Train loss: 1.184, Test loss: 1.245, Test accuracy: 55.73
Round  53, Global train loss: 1.184, Global test loss: 2.652, Global test accuracy: 16.51
Round  54, Train loss: 1.061, Test loss: 1.247, Test accuracy: 56.62
Round  54, Global train loss: 1.061, Global test loss: 2.790, Global test accuracy: 16.03
Round  55, Train loss: 0.970, Test loss: 1.254, Test accuracy: 56.66
Round  55, Global train loss: 0.970, Global test loss: 2.954, Global test accuracy: 16.94
Round  56, Train loss: 0.900, Test loss: 1.277, Test accuracy: 56.24
Round  56, Global train loss: 0.900, Global test loss: 2.727, Global test accuracy: 14.66
Round  57, Train loss: 0.936, Test loss: 1.259, Test accuracy: 56.35
Round  57, Global train loss: 0.936, Global test loss: 2.839, Global test accuracy: 17.85
Round  58, Train loss: 0.962, Test loss: 1.251, Test accuracy: 56.22
Round  58, Global train loss: 0.962, Global test loss: 2.691, Global test accuracy: 13.80
Round  59, Train loss: 0.961, Test loss: 1.274, Test accuracy: 56.00
Round  59, Global train loss: 0.961, Global test loss: 2.642, Global test accuracy: 14.52
Round  60, Train loss: 0.936, Test loss: 1.271, Test accuracy: 56.58
Round  60, Global train loss: 0.936, Global test loss: 3.013, Global test accuracy: 14.25
Round  61, Train loss: 1.004, Test loss: 1.290, Test accuracy: 56.41
Round  61, Global train loss: 1.004, Global test loss: 2.860, Global test accuracy: 14.72
Round  62, Train loss: 1.132, Test loss: 1.290, Test accuracy: 56.01
Round  62, Global train loss: 1.132, Global test loss: 2.980, Global test accuracy: 16.84
Round  63, Train loss: 0.937, Test loss: 1.317, Test accuracy: 55.47
Round  63, Global train loss: 0.937, Global test loss: 2.844, Global test accuracy: 15.51
Round  64, Train loss: 1.015, Test loss: 1.323, Test accuracy: 55.37
Round  64, Global train loss: 1.015, Global test loss: 2.709, Global test accuracy: 16.44
Round  65, Train loss: 0.805, Test loss: 1.316, Test accuracy: 55.67
Round  65, Global train loss: 0.805, Global test loss: 2.781, Global test accuracy: 15.47
Round  66, Train loss: 0.903, Test loss: 1.309, Test accuracy: 55.71
Round  66, Global train loss: 0.903, Global test loss: 2.742, Global test accuracy: 14.31
Round  67, Train loss: 1.127, Test loss: 1.326, Test accuracy: 54.83
Round  67, Global train loss: 1.127, Global test loss: 2.700, Global test accuracy: 16.86
Round  68, Train loss: 0.830, Test loss: 1.312, Test accuracy: 54.82
Round  68, Global train loss: 0.830, Global test loss: 2.701, Global test accuracy: 15.55
Round  69, Train loss: 1.070, Test loss: 1.303, Test accuracy: 55.28
Round  69, Global train loss: 1.070, Global test loss: 2.736, Global test accuracy: 15.73
Round  70, Train loss: 0.824, Test loss: 1.313, Test accuracy: 55.40
Round  70, Global train loss: 0.824, Global test loss: 2.725, Global test accuracy: 15.68
Round  71, Train loss: 1.009, Test loss: 1.343, Test accuracy: 55.14
Round  71, Global train loss: 1.009, Global test loss: 2.920, Global test accuracy: 15.08
Round  72, Train loss: 0.886, Test loss: 1.372, Test accuracy: 55.03
Round  72, Global train loss: 0.886, Global test loss: 2.856, Global test accuracy: 16.83
Round  73, Train loss: 0.914, Test loss: 1.379, Test accuracy: 54.75
Round  73, Global train loss: 0.914, Global test loss: 2.866, Global test accuracy: 16.62
Round  74, Train loss: 0.971, Test loss: 1.360, Test accuracy: 55.15
Round  74, Global train loss: 0.971, Global test loss: 2.819, Global test accuracy: 14.59
Round  75, Train loss: 0.940, Test loss: 1.344, Test accuracy: 55.46
Round  75, Global train loss: 0.940, Global test loss: 2.998, Global test accuracy: 14.90
Round  76, Train loss: 0.940, Test loss: 1.337, Test accuracy: 55.50
Round  76, Global train loss: 0.940, Global test loss: 2.937, Global test accuracy: 16.80
Round  77, Train loss: 0.805, Test loss: 1.383, Test accuracy: 55.63
Round  77, Global train loss: 0.805, Global test loss: 3.058, Global test accuracy: 12.92
Round  78, Train loss: 0.891, Test loss: 1.357, Test accuracy: 56.07
Round  78, Global train loss: 0.891, Global test loss: 3.335, Global test accuracy: 16.07
Round  79, Train loss: 0.871, Test loss: 1.354, Test accuracy: 55.88
Round  79, Global train loss: 0.871, Global test loss: 3.026, Global test accuracy: 14.63
Round  80, Train loss: 0.881, Test loss: 1.356, Test accuracy: 55.63
Round  80, Global train loss: 0.881, Global test loss: 2.777, Global test accuracy: 15.63
Round  81, Train loss: 0.803, Test loss: 1.369, Test accuracy: 55.23
Round  81, Global train loss: 0.803, Global test loss: 2.967, Global test accuracy: 15.93
Round  82, Train loss: 0.738, Test loss: 1.389, Test accuracy: 54.62
Round  82, Global train loss: 0.738, Global test loss: 3.029, Global test accuracy: 14.22
Round  83, Train loss: 0.756, Test loss: 1.387, Test accuracy: 55.23
Round  83, Global train loss: 0.756, Global test loss: 2.918, Global test accuracy: 16.33
Round  84, Train loss: 0.974, Test loss: 1.374, Test accuracy: 55.66
Round  84, Global train loss: 0.974, Global test loss: 2.933, Global test accuracy: 15.52
Round  85, Train loss: 0.906, Test loss: 1.373, Test accuracy: 55.24
Round  85, Global train loss: 0.906, Global test loss: 2.884, Global test accuracy: 16.28
Round  86, Train loss: 0.849, Test loss: 1.368, Test accuracy: 55.27
Round  86, Global train loss: 0.849, Global test loss: 3.171, Global test accuracy: 17.16
Round  87, Train loss: 0.821, Test loss: 1.394, Test accuracy: 54.98
Round  87, Global train loss: 0.821, Global test loss: 3.114, Global test accuracy: 15.19
Round  88, Train loss: 0.847, Test loss: 1.395, Test accuracy: 55.63
Round  88, Global train loss: 0.847, Global test loss: 3.192, Global test accuracy: 15.54
Round  89, Train loss: 0.812, Test loss: 1.422, Test accuracy: 55.16
Round  89, Global train loss: 0.812, Global test loss: 3.326, Global test accuracy: 16.47
Round  90, Train loss: 0.858, Test loss: 1.438, Test accuracy: 55.25
Round  90, Global train loss: 0.858, Global test loss: 3.009, Global test accuracy: 14.57
Round  91, Train loss: 0.902, Test loss: 1.461, Test accuracy: 54.74
Round  91, Global train loss: 0.902, Global test loss: 3.167, Global test accuracy: 15.19
Round  92, Train loss: 0.769, Test loss: 1.445, Test accuracy: 55.09
Round  92, Global train loss: 0.769, Global test loss: 3.152, Global test accuracy: 14.18
Round  93, Train loss: 0.772, Test loss: 1.465, Test accuracy: 54.93
Round  93, Global train loss: 0.772, Global test loss: 3.080, Global test accuracy: 13.91
Round  94, Train loss: 0.807, Test loss: 1.437, Test accuracy: 54.85
Round  94, Global train loss: 0.807, Global test loss: 3.086, Global test accuracy: 14.96
Round  95, Train loss: 0.875, Test loss: 1.425, Test accuracy: 54.29
Round  95, Global train loss: 0.875, Global test loss: 2.932, Global test accuracy: 15.22
Round  96, Train loss: 0.812, Test loss: 1.442, Test accuracy: 54.45
Round  96, Global train loss: 0.812, Global test loss: 3.204, Global test accuracy: 13.77
Round  97, Train loss: 0.713, Test loss: 1.462, Test accuracy: 54.32
Round  97, Global train loss: 0.713, Global test loss: 3.384, Global test accuracy: 14.38
Round  98, Train loss: 0.776, Test loss: 1.451, Test accuracy: 54.46
Round  98, Global train loss: 0.776, Global test loss: 2.952, Global test accuracy: 14.72
Round  99, Train loss: 0.842, Test loss: 1.457, Test accuracy: 54.16
Round  99, Global train loss: 0.842, Global test loss: 3.148, Global test accuracy: 14.65
Final Round, Train loss: 0.624, Test loss: 1.689, Test accuracy: 53.76
Final Round, Global train loss: 0.624, Global test loss: 3.148, Global test accuracy: 14.65
Average accuracy final 10 rounds: 54.654
Average global accuracy final 10 rounds: 14.555000000000001
2280.1317851543427
[3.0414061546325684, 5.832218408584595, 8.65587592124939, 11.456948041915894, 14.288219690322876, 17.09563136100769, 19.886178016662598, 22.75018882751465, 25.53025460243225, 28.382166624069214, 31.17695140838623, 33.97201609611511, 36.809107303619385, 39.627840757369995, 42.503002643585205, 45.31893754005432, 48.13351559638977, 51.00053644180298, 53.81736421585083, 56.62748098373413, 59.43193769454956, 62.23413419723511, 65.0759847164154, 67.93806886672974, 70.81921744346619, 73.68827533721924, 76.54333519935608, 79.46422243118286, 82.3161039352417, 85.22106432914734, 88.07378888130188, 90.92139434814453, 93.80191683769226, 96.65188121795654, 99.57965207099915, 102.43958353996277, 105.29162645339966, 108.17371416091919, 111.0377779006958, 113.96167302131653, 116.82188153266907, 119.6930718421936, 122.55225920677185, 125.40749001502991, 128.33013772964478, 131.16504096984863, 134.06411695480347, 136.9260401725769, 139.78654670715332, 142.7060465812683, 145.57001852989197, 148.43500995635986, 151.31071043014526, 154.17467951774597, 157.073792219162, 159.93821382522583, 162.7958915233612, 165.7246949672699, 168.59571886062622, 171.46535062789917, 174.32370591163635, 177.1665005683899, 180.08445477485657, 182.93820452690125, 185.816148519516, 188.6793234348297, 191.53853392601013, 194.44345784187317, 197.29879307746887, 200.18100810050964, 203.0809633731842, 205.93515276908875, 208.84022784233093, 211.70522165298462, 214.55155062675476, 217.45779061317444, 220.30218315124512, 223.1790587902069, 226.0332591533661, 228.9011936187744, 231.8160915374756, 234.67829370498657, 237.55931091308594, 240.41158819198608, 243.2677037715912, 246.18877959251404, 249.0426208972931, 251.92055797576904, 254.80115485191345, 257.6791265010834, 260.54821014404297, 263.41580986976624, 266.29644322395325, 269.167142868042, 272.0402264595032, 274.92355823516846, 277.79063153266907, 280.65948581695557, 283.5311424732208, 286.39028096199036, 291.4891381263733]
[15.64, 23.9, 26.3, 31.62, 35.21, 36.49, 41.45, 44.05, 45.83, 46.15, 48.53, 48.78, 49.06, 48.86, 49.34, 49.16, 50.66, 51.25, 51.87, 52.22, 52.37, 52.88, 53.59, 53.93, 53.36, 53.35, 53.82, 53.64, 53.95, 54.42, 54.6, 54.09, 53.88, 54.79, 54.23, 55.25, 54.67, 55.81, 55.5, 55.89, 55.72, 56.34, 56.33, 55.67, 56.13, 55.34, 55.45, 55.83, 55.63, 55.76, 56.25, 56.04, 56.4, 55.73, 56.62, 56.66, 56.24, 56.35, 56.22, 56.0, 56.58, 56.41, 56.01, 55.47, 55.37, 55.67, 55.71, 54.83, 54.82, 55.28, 55.4, 55.14, 55.03, 54.75, 55.15, 55.46, 55.5, 55.63, 56.07, 55.88, 55.63, 55.23, 54.62, 55.23, 55.66, 55.24, 55.27, 54.98, 55.63, 55.16, 55.25, 54.74, 55.09, 54.93, 54.85, 54.29, 54.45, 54.32, 54.46, 54.16, 53.76]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  17.4700
Round 1 global test acc  15.8600
Round 2 global test acc  20.5500
Round 3 global test acc  20.5400
Round 4 global test acc  21.6900
Round 5 global test acc  21.6800
Round 6 global test acc  18.4300
Round 7 global test acc  29.8900
Round 8 global test acc  27.3400
Round 9 global test acc  25.1800
Round 10 global test acc  23.7200
Round 11 global test acc  32.2200
Round 12 global test acc  31.7700
Round 13 global test acc  29.2600
Round 14 global test acc  34.0300
Round 15 global test acc  31.2300
Round 16 global test acc  33.6700
Round 17 global test acc  30.7000
Round 18 global test acc  25.1700
Round 19 global test acc  29.1900
Round 20 global test acc  30.6000
Round 21 global test acc  28.8800
Round 22 global test acc  23.7600
Round 23 global test acc  30.7400
Round 24 global test acc  25.1900
Round 25 global test acc  40.2400
Round 26 global test acc  29.5500
Round 27 global test acc  31.2200
Round 28 global test acc  35.4200
Round 29 global test acc  31.7000
Round 30 global test acc  36.9600
Round 31 global test acc  30.6700
Round 32 global test acc  35.1000
Round 33 global test acc  25.1300
Round 34 global test acc  34.5500
Round 35 global test acc  33.7100
Round 36 global test acc  31.0400
Round 37 global test acc  30.5800
Round 38 global test acc  37.9500
Round 39 global test acc  38.9900
Round 40 global test acc  27.0700
Round 41 global test acc  36.2200
Round 42 global test acc  31.0700
Round 43 global test acc  35.1000
Round 44 global test acc  29.7700
Round 45 global test acc  31.7800
Round 46 global test acc  34.0200
Round 47 global test acc  30.1600
Round 48 global test acc  34.4200
Round 49 global test acc  41.2600
Round 50 global test acc  31.1400
Round 51 global test acc  29.2800
Round 52 global test acc  35.7300
Round 53 global test acc  36.9400
Round 54 global test acc  42.9900
Round 55 global test acc  30.9200
Round 56 global test acc  37.1200
Round 57 global test acc  33.6600
Round 58 global test acc  36.5100
Round 59 global test acc  29.2800
Round 60 global test acc  35.8300
Round 61 global test acc  38.2300
Round 62 global test acc  43.1300
Round 63 global test acc  43.9100
Round 64 global test acc  36.9900
Round 65 global test acc  30.7200
Round 66 global test acc  38.9500
Round 67 global test acc  33.8200
Round 68 global test acc  40.3200
Round 69 global test acc  35.1600
Round 70 global test acc  36.6900
Round 71 global test acc  31.6300
Round 72 global test acc  43.6700
Round 73 global test acc  38.1600
Round 74 global test acc  31.5300
Round 75 global test acc  34.7900
Round 76 global test acc  35.4100
Round 77 global test acc  35.8400
Round 78 global test acc  32.2100
Round 79 global test acc  41.0400
Round 80 global test acc  39.0900
Round 81 global test acc  36.7200
Round 82 global test acc  32.8300
Round 83 global test acc  28.8500
Round 84 global test acc  29.4300
Round 85 global test acc  26.7000
Round 86 global test acc  26.1900
Round 87 global test acc  25.7900
Round 88 global test acc  23.8200
Round 89 global test acc  23.7100
Round 90 global test acc  24.2000
Round 91 global test acc  23.1600
Round 92 global test acc  23.2100
Round 93 global test acc  22.6300
Round 94 global test acc  22.3600
Round 95 global test acc  21.9400
Round 96 global test acc  22.6000
Round 97 global test acc  22.3800
Round 98 global test acc  22.2700
Round 99 global test acc  22.2200
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.976, Test loss: 2.252, Test accuracy: 13.25
Round   1, Train loss: 1.670, Test loss: 2.139, Test accuracy: 17.03
Round   2, Train loss: 1.594, Test loss: 1.904, Test accuracy: 29.09
Round   3, Train loss: 1.598, Test loss: 1.776, Test accuracy: 29.74
Round   4, Train loss: 1.588, Test loss: 1.674, Test accuracy: 31.99
Round   5, Train loss: 1.495, Test loss: 1.603, Test accuracy: 35.00
Round   6, Train loss: 1.499, Test loss: 1.481, Test accuracy: 38.21
Round   7, Train loss: 1.503, Test loss: 1.424, Test accuracy: 39.78
Round   8, Train loss: 1.523, Test loss: 1.367, Test accuracy: 44.11
Round   9, Train loss: 1.454, Test loss: 1.351, Test accuracy: 45.69
Round  10, Train loss: 1.511, Test loss: 1.326, Test accuracy: 46.66
Round  11, Train loss: 1.517, Test loss: 1.329, Test accuracy: 47.35
Round  12, Train loss: 1.412, Test loss: 1.314, Test accuracy: 48.53
Round  13, Train loss: 1.460, Test loss: 1.300, Test accuracy: 50.31
Round  14, Train loss: 1.358, Test loss: 1.248, Test accuracy: 51.81
Round  15, Train loss: 1.430, Test loss: 1.248, Test accuracy: 52.32
Round  16, Train loss: 1.254, Test loss: 1.194, Test accuracy: 54.44
Round  17, Train loss: 1.386, Test loss: 1.191, Test accuracy: 55.28
Round  18, Train loss: 1.348, Test loss: 1.176, Test accuracy: 55.21
Round  19, Train loss: 1.397, Test loss: 1.181, Test accuracy: 55.09
Round  20, Train loss: 1.225, Test loss: 1.142, Test accuracy: 55.97
Round  21, Train loss: 1.469, Test loss: 1.148, Test accuracy: 57.56
Round  22, Train loss: 1.415, Test loss: 1.122, Test accuracy: 58.92
Round  23, Train loss: 1.396, Test loss: 1.147, Test accuracy: 58.63
Round  24, Train loss: 1.308, Test loss: 1.140, Test accuracy: 59.39
Round  25, Train loss: 1.356, Test loss: 1.138, Test accuracy: 60.22
Round  26, Train loss: 1.331, Test loss: 1.104, Test accuracy: 61.58
Round  27, Train loss: 1.241, Test loss: 1.103, Test accuracy: 61.78
Round  28, Train loss: 1.332, Test loss: 1.101, Test accuracy: 62.29
Round  29, Train loss: 1.279, Test loss: 1.112, Test accuracy: 61.80
Round  30, Train loss: 1.241, Test loss: 1.080, Test accuracy: 62.02
Round  31, Train loss: 1.273, Test loss: 1.070, Test accuracy: 61.77
Round  32, Train loss: 1.386, Test loss: 1.076, Test accuracy: 61.48
Round  33, Train loss: 1.144, Test loss: 1.036, Test accuracy: 63.08
Round  34, Train loss: 1.070, Test loss: 1.036, Test accuracy: 63.13
Round  35, Train loss: 1.263, Test loss: 1.041, Test accuracy: 62.86
Round  36, Train loss: 1.251, Test loss: 1.030, Test accuracy: 63.28
Round  37, Train loss: 1.267, Test loss: 1.031, Test accuracy: 64.13
Round  38, Train loss: 1.083, Test loss: 1.029, Test accuracy: 64.07
Round  39, Train loss: 1.084, Test loss: 1.006, Test accuracy: 63.80
Round  40, Train loss: 1.252, Test loss: 1.025, Test accuracy: 63.19
Round  41, Train loss: 1.157, Test loss: 1.017, Test accuracy: 63.61
Round  42, Train loss: 1.230, Test loss: 1.021, Test accuracy: 64.69
Round  43, Train loss: 1.118, Test loss: 1.003, Test accuracy: 65.08
Round  44, Train loss: 1.185, Test loss: 0.990, Test accuracy: 66.01
Round  45, Train loss: 1.053, Test loss: 0.982, Test accuracy: 65.81
Round  46, Train loss: 1.333, Test loss: 0.979, Test accuracy: 66.35
Round  47, Train loss: 1.279, Test loss: 0.970, Test accuracy: 66.87
Round  48, Train loss: 1.121, Test loss: 0.969, Test accuracy: 67.17
Round  49, Train loss: 1.108, Test loss: 0.977, Test accuracy: 67.01
Round  50, Train loss: 1.176, Test loss: 0.976, Test accuracy: 67.97
Round  51, Train loss: 1.205, Test loss: 0.973, Test accuracy: 67.64
Round  52, Train loss: 1.170, Test loss: 0.961, Test accuracy: 67.46
Round  53, Train loss: 1.133, Test loss: 0.965, Test accuracy: 67.57
Round  54, Train loss: 1.277, Test loss: 0.978, Test accuracy: 67.51
Round  55, Train loss: 1.190, Test loss: 0.982, Test accuracy: 66.90
Round  56, Train loss: 1.092, Test loss: 0.969, Test accuracy: 67.13
Round  57, Train loss: 1.185, Test loss: 0.937, Test accuracy: 67.89
Round  58, Train loss: 1.145, Test loss: 0.952, Test accuracy: 67.95
Round  59, Train loss: 1.204, Test loss: 0.945, Test accuracy: 68.01
Round  60, Train loss: 1.055, Test loss: 0.918, Test accuracy: 69.19
Round  61, Train loss: 1.181, Test loss: 0.923, Test accuracy: 68.72
Round  62, Train loss: 1.138, Test loss: 0.941, Test accuracy: 67.95
Round  63, Train loss: 1.058, Test loss: 0.930, Test accuracy: 68.81
Round  64, Train loss: 1.202, Test loss: 0.922, Test accuracy: 68.94
Round  65, Train loss: 1.064, Test loss: 0.924, Test accuracy: 68.36
Round  66, Train loss: 1.074, Test loss: 0.922, Test accuracy: 68.87
Round  67, Train loss: 1.257, Test loss: 0.928, Test accuracy: 69.37
Round  68, Train loss: 1.048, Test loss: 0.911, Test accuracy: 69.85
Round  69, Train loss: 1.175, Test loss: 0.917, Test accuracy: 69.84
Round  70, Train loss: 1.103, Test loss: 0.914, Test accuracy: 69.18
Round  71, Train loss: 1.187, Test loss: 0.922, Test accuracy: 69.05
Round  72, Train loss: 0.924, Test loss: 0.905, Test accuracy: 69.49
Round  73, Train loss: 1.114, Test loss: 0.912, Test accuracy: 69.36
Round  74, Train loss: 1.212, Test loss: 0.911, Test accuracy: 69.20
Round  75, Train loss: 1.020, Test loss: 0.907, Test accuracy: 69.21
Round  76, Train loss: 1.065, Test loss: 0.893, Test accuracy: 69.23
Round  77, Train loss: 1.049, Test loss: 0.917, Test accuracy: 69.16
Round  78, Train loss: 0.967, Test loss: 0.897, Test accuracy: 69.81
Round  79, Train loss: 1.012, Test loss: 0.896, Test accuracy: 69.70
Round  80, Train loss: 1.008, Test loss: 0.902, Test accuracy: 69.31
Round  81, Train loss: 0.954, Test loss: 0.872, Test accuracy: 70.11
Round  82, Train loss: 1.040, Test loss: 0.883, Test accuracy: 69.52
Round  83, Train loss: 0.995, Test loss: 0.893, Test accuracy: 70.00
Round  84, Train loss: 0.978, Test loss: 0.895, Test accuracy: 69.93
Round  85, Train loss: 0.938, Test loss: 0.895, Test accuracy: 69.43
Round  86, Train loss: 0.965, Test loss: 0.896, Test accuracy: 69.83
Round  87, Train loss: 1.049, Test loss: 0.888, Test accuracy: 69.99
Round  88, Train loss: 1.097, Test loss: 0.902, Test accuracy: 69.07
Round  89, Train loss: 0.985, Test loss: 0.891, Test accuracy: 69.33
Round  90, Train loss: 0.854, Test loss: 0.877, Test accuracy: 70.12
Round  91, Train loss: 1.124, Test loss: 0.894, Test accuracy: 69.29
Round  92, Train loss: 0.994, Test loss: 0.878, Test accuracy: 69.51
Round  93, Train loss: 0.955, Test loss: 0.881, Test accuracy: 69.34
Round  94, Train loss: 1.045, Test loss: 0.900, Test accuracy: 69.06
Round  95, Train loss: 1.049, Test loss: 0.887, Test accuracy: 69.36
Round  96, Train loss: 1.018, Test loss: 0.893, Test accuracy: 68.90
Round  97, Train loss: 0.814, Test loss: 0.878, Test accuracy: 69.55
Round  98, Train loss: 1.015, Test loss: 0.893, Test accuracy: 69.41
Round  99, Train loss: 0.925, Test loss: 0.894, Test accuracy: 69.16
Final Round, Train loss: 0.885, Test loss: 0.893, Test accuracy: 69.03
Average accuracy final 10 rounds: 69.37
1065.5105855464935
[1.738663673400879, 3.16558837890625, 4.595220565795898, 6.023403882980347, 7.44501805305481, 8.866095066070557, 10.292093992233276, 11.705151319503784, 13.124712705612183, 14.541553497314453, 15.955441951751709, 17.36638569831848, 18.779395818710327, 20.204432010650635, 21.627563953399658, 23.041332244873047, 24.462453603744507, 25.878973484039307, 27.298040628433228, 28.72021222114563, 30.143290996551514, 31.564834356307983, 32.98722839355469, 34.41036915779114, 35.833476305007935, 37.25904393196106, 38.677865505218506, 40.09648585319519, 41.50792694091797, 42.91599416732788, 44.32433843612671, 45.74242448806763, 47.164424657821655, 48.59662914276123, 50.03359246253967, 51.46705627441406, 52.89267039299011, 54.326372146606445, 55.75614142417908, 57.18830490112305, 58.614561796188354, 60.03743934631348, 61.447243213653564, 62.85340642929077, 64.2607364654541, 65.66441011428833, 67.07017827033997, 68.48588633537292, 69.88807511329651, 71.29744720458984, 72.53799748420715, 73.738516330719, 74.94411754608154, 76.14827108383179, 77.34885597229004, 78.55046939849854, 79.7476954460144, 80.94472193717957, 82.13861227035522, 83.33998942375183, 84.53966617584229, 85.74406862258911, 86.9404845237732, 88.17409896850586, 89.37079167366028, 90.5683081150055, 91.76931095123291, 92.97349834442139, 94.1742537021637, 95.3753912448883, 96.57862067222595, 97.77981901168823, 98.97943234443665, 100.18144607543945, 101.37633156776428, 102.57539105415344, 103.77195882797241, 104.97177767753601, 106.16989827156067, 107.37089943885803, 108.57506847381592, 109.7812876701355, 110.98844933509827, 112.19329166412354, 113.39761972427368, 114.5977029800415, 115.79935121536255, 117.00444531440735, 118.2034068107605, 119.4098048210144, 120.61422204971313, 121.81728792190552, 123.02288055419922, 124.22755932807922, 125.43704795837402, 126.64482998847961, 127.85812139511108, 129.05891036987305, 130.25923681259155, 131.47622728347778, 133.4445960521698]
[13.25, 17.03, 29.09, 29.74, 31.99, 35.0, 38.21, 39.78, 44.11, 45.69, 46.66, 47.35, 48.53, 50.31, 51.81, 52.32, 54.44, 55.28, 55.21, 55.09, 55.97, 57.56, 58.92, 58.63, 59.39, 60.22, 61.58, 61.78, 62.29, 61.8, 62.02, 61.77, 61.48, 63.08, 63.13, 62.86, 63.28, 64.13, 64.07, 63.8, 63.19, 63.61, 64.69, 65.08, 66.01, 65.81, 66.35, 66.87, 67.17, 67.01, 67.97, 67.64, 67.46, 67.57, 67.51, 66.9, 67.13, 67.89, 67.95, 68.01, 69.19, 68.72, 67.95, 68.81, 68.94, 68.36, 68.87, 69.37, 69.85, 69.84, 69.18, 69.05, 69.49, 69.36, 69.2, 69.21, 69.23, 69.16, 69.81, 69.7, 69.31, 70.11, 69.52, 70.0, 69.93, 69.43, 69.83, 69.99, 69.07, 69.33, 70.12, 69.29, 69.51, 69.34, 69.06, 69.36, 68.9, 69.55, 69.41, 69.16, 69.03]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.751, Test loss: 2.135, Test accuracy: 16.09
Round   0, Global train loss: 1.751, Global test loss: 2.326, Global test accuracy: 11.28
Round   1, Train loss: 1.620, Test loss: 1.912, Test accuracy: 24.40
Round   1, Global train loss: 1.620, Global test loss: 2.353, Global test accuracy: 11.04
Round   2, Train loss: 1.545, Test loss: 1.801, Test accuracy: 29.90
Round   2, Global train loss: 1.545, Global test loss: 2.405, Global test accuracy: 13.13
Round   3, Train loss: 1.607, Test loss: 1.688, Test accuracy: 33.44
Round   3, Global train loss: 1.607, Global test loss: 2.362, Global test accuracy: 16.22
Round   4, Train loss: 1.617, Test loss: 1.598, Test accuracy: 36.88
Round   4, Global train loss: 1.617, Global test loss: 2.317, Global test accuracy: 16.33
Round   5, Train loss: 1.470, Test loss: 1.513, Test accuracy: 39.52
Round   5, Global train loss: 1.470, Global test loss: 2.341, Global test accuracy: 16.02
Round   6, Train loss: 1.460, Test loss: 1.366, Test accuracy: 44.84
Round   6, Global train loss: 1.460, Global test loss: 2.389, Global test accuracy: 15.70
Round   7, Train loss: 1.496, Test loss: 1.290, Test accuracy: 47.67
Round   7, Global train loss: 1.496, Global test loss: 2.372, Global test accuracy: 16.43
Round   8, Train loss: 1.453, Test loss: 1.262, Test accuracy: 49.62
Round   8, Global train loss: 1.453, Global test loss: 2.340, Global test accuracy: 14.95
Round   9, Train loss: 1.460, Test loss: 1.245, Test accuracy: 49.59
Round   9, Global train loss: 1.460, Global test loss: 2.347, Global test accuracy: 14.94
Round  10, Train loss: 1.405, Test loss: 1.220, Test accuracy: 51.94
Round  10, Global train loss: 1.405, Global test loss: 2.376, Global test accuracy: 16.10
Round  11, Train loss: 1.482, Test loss: 1.219, Test accuracy: 52.48
Round  11, Global train loss: 1.482, Global test loss: 2.443, Global test accuracy: 14.76
Round  12, Train loss: 1.456, Test loss: 1.221, Test accuracy: 52.73
Round  12, Global train loss: 1.456, Global test loss: 2.387, Global test accuracy: 14.75
Round  13, Train loss: 1.476, Test loss: 1.210, Test accuracy: 52.85
Round  13, Global train loss: 1.476, Global test loss: 2.299, Global test accuracy: 14.58
Round  14, Train loss: 1.329, Test loss: 1.199, Test accuracy: 54.07
Round  14, Global train loss: 1.329, Global test loss: 2.413, Global test accuracy: 14.09
Round  15, Train loss: 1.444, Test loss: 1.183, Test accuracy: 54.40
Round  15, Global train loss: 1.444, Global test loss: 2.372, Global test accuracy: 12.32
Round  16, Train loss: 1.283, Test loss: 1.175, Test accuracy: 54.93
Round  16, Global train loss: 1.283, Global test loss: 2.482, Global test accuracy: 14.95
Round  17, Train loss: 1.342, Test loss: 1.164, Test accuracy: 55.89
Round  17, Global train loss: 1.342, Global test loss: 2.490, Global test accuracy: 13.64
Round  18, Train loss: 1.378, Test loss: 1.166, Test accuracy: 55.82
Round  18, Global train loss: 1.378, Global test loss: 2.426, Global test accuracy: 14.92
Round  19, Train loss: 1.287, Test loss: 1.166, Test accuracy: 55.62
Round  19, Global train loss: 1.287, Global test loss: 2.766, Global test accuracy: 14.19
Round  20, Train loss: 1.369, Test loss: 1.155, Test accuracy: 56.50
Round  20, Global train loss: 1.369, Global test loss: 2.379, Global test accuracy: 14.66
Round  21, Train loss: 1.308, Test loss: 1.145, Test accuracy: 56.82
Round  21, Global train loss: 1.308, Global test loss: 2.420, Global test accuracy: 16.23
Round  22, Train loss: 1.414, Test loss: 1.151, Test accuracy: 56.61
Round  22, Global train loss: 1.414, Global test loss: 2.355, Global test accuracy: 15.82
Round  23, Train loss: 1.357, Test loss: 1.177, Test accuracy: 55.25
Round  23, Global train loss: 1.357, Global test loss: 2.378, Global test accuracy: 15.25
Round  24, Train loss: 1.336, Test loss: 1.154, Test accuracy: 56.09
Round  24, Global train loss: 1.336, Global test loss: 2.466, Global test accuracy: 14.14
Round  25, Train loss: 1.279, Test loss: 1.165, Test accuracy: 55.81
Round  25, Global train loss: 1.279, Global test loss: 2.468, Global test accuracy: 16.51
Round  26, Train loss: 1.176, Test loss: 1.148, Test accuracy: 56.70
Round  26, Global train loss: 1.176, Global test loss: 2.483, Global test accuracy: 12.86
Round  27, Train loss: 1.368, Test loss: 1.143, Test accuracy: 57.11
Round  27, Global train loss: 1.368, Global test loss: 2.419, Global test accuracy: 16.98
Round  28, Train loss: 1.089, Test loss: 1.136, Test accuracy: 57.21
Round  28, Global train loss: 1.089, Global test loss: 2.497, Global test accuracy: 16.67
Round  29, Train loss: 1.180, Test loss: 1.116, Test accuracy: 58.12
Round  29, Global train loss: 1.180, Global test loss: 2.546, Global test accuracy: 14.84
Round  30, Train loss: 1.120, Test loss: 1.126, Test accuracy: 57.73
Round  30, Global train loss: 1.120, Global test loss: 2.575, Global test accuracy: 16.41
Round  31, Train loss: 1.149, Test loss: 1.131, Test accuracy: 57.69
Round  31, Global train loss: 1.149, Global test loss: 2.624, Global test accuracy: 13.85
Round  32, Train loss: 1.255, Test loss: 1.119, Test accuracy: 58.53
Round  32, Global train loss: 1.255, Global test loss: 2.449, Global test accuracy: 14.90
Round  33, Train loss: 1.212, Test loss: 1.117, Test accuracy: 58.36
Round  33, Global train loss: 1.212, Global test loss: 2.497, Global test accuracy: 15.99
Round  34, Train loss: 1.130, Test loss: 1.115, Test accuracy: 58.33
Round  34, Global train loss: 1.130, Global test loss: 2.486, Global test accuracy: 14.31
Round  35, Train loss: 1.325, Test loss: 1.133, Test accuracy: 58.01
Round  35, Global train loss: 1.325, Global test loss: 2.405, Global test accuracy: 13.70
Round  36, Train loss: 1.333, Test loss: 1.131, Test accuracy: 57.39
Round  36, Global train loss: 1.333, Global test loss: 2.468, Global test accuracy: 12.77
Round  37, Train loss: 1.174, Test loss: 1.135, Test accuracy: 57.27
Round  37, Global train loss: 1.174, Global test loss: 2.558, Global test accuracy: 15.57
Round  38, Train loss: 1.116, Test loss: 1.133, Test accuracy: 57.49
Round  38, Global train loss: 1.116, Global test loss: 2.585, Global test accuracy: 16.30
Round  39, Train loss: 1.054, Test loss: 1.119, Test accuracy: 57.84
Round  39, Global train loss: 1.054, Global test loss: 2.580, Global test accuracy: 14.51
Round  40, Train loss: 1.212, Test loss: 1.124, Test accuracy: 57.13
Round  40, Global train loss: 1.212, Global test loss: 2.644, Global test accuracy: 14.27
Round  41, Train loss: 1.084, Test loss: 1.127, Test accuracy: 57.18
Round  41, Global train loss: 1.084, Global test loss: 2.546, Global test accuracy: 16.01
Round  42, Train loss: 1.151, Test loss: 1.125, Test accuracy: 57.17
Round  42, Global train loss: 1.151, Global test loss: 2.514, Global test accuracy: 14.27
Round  43, Train loss: 1.115, Test loss: 1.129, Test accuracy: 57.17
Round  43, Global train loss: 1.115, Global test loss: 2.674, Global test accuracy: 16.64
Round  44, Train loss: 1.051, Test loss: 1.124, Test accuracy: 57.79
Round  44, Global train loss: 1.051, Global test loss: 2.563, Global test accuracy: 13.42
Round  45, Train loss: 1.181, Test loss: 1.132, Test accuracy: 57.69
Round  45, Global train loss: 1.181, Global test loss: 2.528, Global test accuracy: 13.65
Round  46, Train loss: 1.080, Test loss: 1.142, Test accuracy: 57.47
Round  46, Global train loss: 1.080, Global test loss: 2.573, Global test accuracy: 13.49
Round  47, Train loss: 1.087, Test loss: 1.135, Test accuracy: 57.73
Round  47, Global train loss: 1.087, Global test loss: 2.614, Global test accuracy: 13.34
Round  48, Train loss: 1.116, Test loss: 1.131, Test accuracy: 57.98
Round  48, Global train loss: 1.116, Global test loss: 2.724, Global test accuracy: 13.79
Round  49, Train loss: 1.121, Test loss: 1.128, Test accuracy: 58.10
Round  49, Global train loss: 1.121, Global test loss: 2.505, Global test accuracy: 14.80
Round  50, Train loss: 1.089, Test loss: 1.151, Test accuracy: 57.43
Round  50, Global train loss: 1.089, Global test loss: 2.721, Global test accuracy: 13.04
Round  51, Train loss: 0.955, Test loss: 1.162, Test accuracy: 57.40
Round  51, Global train loss: 0.955, Global test loss: 2.908, Global test accuracy: 13.19
Round  52, Train loss: 1.182, Test loss: 1.171, Test accuracy: 57.29
Round  52, Global train loss: 1.182, Global test loss: 2.876, Global test accuracy: 14.89
Round  53, Train loss: 1.128, Test loss: 1.170, Test accuracy: 57.32
Round  53, Global train loss: 1.128, Global test loss: 2.724, Global test accuracy: 15.63
Round  54, Train loss: 1.028, Test loss: 1.170, Test accuracy: 57.18
Round  54, Global train loss: 1.028, Global test loss: 2.855, Global test accuracy: 15.58
Round  55, Train loss: 1.044, Test loss: 1.169, Test accuracy: 57.36
Round  55, Global train loss: 1.044, Global test loss: 2.791, Global test accuracy: 14.85
Round  56, Train loss: 0.852, Test loss: 1.187, Test accuracy: 57.15
Round  56, Global train loss: 0.852, Global test loss: 2.755, Global test accuracy: 16.14
Round  57, Train loss: 0.950, Test loss: 1.198, Test accuracy: 56.97
Round  57, Global train loss: 0.950, Global test loss: 2.778, Global test accuracy: 14.45
Round  58, Train loss: 0.919, Test loss: 1.201, Test accuracy: 56.84
Round  58, Global train loss: 0.919, Global test loss: 2.831, Global test accuracy: 15.62
Round  59, Train loss: 0.968, Test loss: 1.209, Test accuracy: 56.36
Round  59, Global train loss: 0.968, Global test loss: 2.925, Global test accuracy: 16.00
Round  60, Train loss: 0.962, Test loss: 1.198, Test accuracy: 56.91
Round  60, Global train loss: 0.962, Global test loss: 2.705, Global test accuracy: 13.42
Round  61, Train loss: 0.877, Test loss: 1.196, Test accuracy: 57.05
Round  61, Global train loss: 0.877, Global test loss: 2.981, Global test accuracy: 15.50
Round  62, Train loss: 1.092, Test loss: 1.230, Test accuracy: 56.05
Round  62, Global train loss: 1.092, Global test loss: 2.709, Global test accuracy: 15.12
Round  63, Train loss: 0.901, Test loss: 1.231, Test accuracy: 55.89
Round  63, Global train loss: 0.901, Global test loss: 2.745, Global test accuracy: 14.89
Round  64, Train loss: 0.917, Test loss: 1.226, Test accuracy: 56.29
Round  64, Global train loss: 0.917, Global test loss: 2.868, Global test accuracy: 13.89
Round  65, Train loss: 0.920, Test loss: 1.232, Test accuracy: 56.51
Round  65, Global train loss: 0.920, Global test loss: 3.012, Global test accuracy: 16.36
Round  66, Train loss: 0.931, Test loss: 1.257, Test accuracy: 55.98
Round  66, Global train loss: 0.931, Global test loss: 2.878, Global test accuracy: 12.55
Round  67, Train loss: 1.009, Test loss: 1.273, Test accuracy: 56.04
Round  67, Global train loss: 1.009, Global test loss: 2.778, Global test accuracy: 15.00
Round  68, Train loss: 0.807, Test loss: 1.277, Test accuracy: 56.03
Round  68, Global train loss: 0.807, Global test loss: 2.984, Global test accuracy: 13.51
Round  69, Train loss: 0.982, Test loss: 1.266, Test accuracy: 56.23
Round  69, Global train loss: 0.982, Global test loss: 2.843, Global test accuracy: 12.18
Round  70, Train loss: 0.798, Test loss: 1.270, Test accuracy: 57.04
Round  70, Global train loss: 0.798, Global test loss: 2.938, Global test accuracy: 13.55
Round  71, Train loss: 0.978, Test loss: 1.268, Test accuracy: 57.22
Round  71, Global train loss: 0.978, Global test loss: 2.775, Global test accuracy: 13.63
Round  72, Train loss: 0.908, Test loss: 1.271, Test accuracy: 57.52
Round  72, Global train loss: 0.908, Global test loss: 2.807, Global test accuracy: 13.38
Round  73, Train loss: 0.858, Test loss: 1.273, Test accuracy: 56.98
Round  73, Global train loss: 0.858, Global test loss: 3.106, Global test accuracy: 15.87
Round  74, Train loss: 0.948, Test loss: 1.261, Test accuracy: 57.56
Round  74, Global train loss: 0.948, Global test loss: 2.999, Global test accuracy: 15.49
Round  75, Train loss: 0.825, Test loss: 1.272, Test accuracy: 57.39
Round  75, Global train loss: 0.825, Global test loss: 2.904, Global test accuracy: 14.70
Round  76, Train loss: 0.994, Test loss: 1.276, Test accuracy: 56.76
Round  76, Global train loss: 0.994, Global test loss: 2.910, Global test accuracy: 14.20
Round  77, Train loss: 0.711, Test loss: 1.304, Test accuracy: 56.43
Round  77, Global train loss: 0.711, Global test loss: 3.172, Global test accuracy: 14.74
Round  78, Train loss: 0.983, Test loss: 1.342, Test accuracy: 55.89
Round  78, Global train loss: 0.983, Global test loss: 2.889, Global test accuracy: 14.04
Round  79, Train loss: 0.781, Test loss: 1.333, Test accuracy: 55.65
Round  79, Global train loss: 0.781, Global test loss: 3.006, Global test accuracy: 14.65
Round  80, Train loss: 0.895, Test loss: 1.329, Test accuracy: 55.65
Round  80, Global train loss: 0.895, Global test loss: 2.970, Global test accuracy: 12.53
Round  81, Train loss: 0.752, Test loss: 1.330, Test accuracy: 55.81
Round  81, Global train loss: 0.752, Global test loss: 3.339, Global test accuracy: 15.25
Round  82, Train loss: 0.815, Test loss: 1.337, Test accuracy: 56.03
Round  82, Global train loss: 0.815, Global test loss: 2.997, Global test accuracy: 14.45
Round  83, Train loss: 0.758, Test loss: 1.362, Test accuracy: 55.83
Round  83, Global train loss: 0.758, Global test loss: 3.030, Global test accuracy: 13.85
Round  84, Train loss: 0.926, Test loss: 1.373, Test accuracy: 55.97
Round  84, Global train loss: 0.926, Global test loss: 2.960, Global test accuracy: 13.96
Round  85, Train loss: 0.837, Test loss: 1.377, Test accuracy: 56.12
Round  85, Global train loss: 0.837, Global test loss: 3.043, Global test accuracy: 15.21
Round  86, Train loss: 0.874, Test loss: 1.382, Test accuracy: 55.89
Round  86, Global train loss: 0.874, Global test loss: 3.179, Global test accuracy: 13.47
Round  87, Train loss: 0.735, Test loss: 1.420, Test accuracy: 55.09
Round  87, Global train loss: 0.735, Global test loss: 3.471, Global test accuracy: 16.21
Round  88, Train loss: 0.935, Test loss: 1.423, Test accuracy: 55.24
Round  88, Global train loss: 0.935, Global test loss: 3.261, Global test accuracy: 14.43
Round  89, Train loss: 0.845, Test loss: 1.409, Test accuracy: 55.75
Round  89, Global train loss: 0.845, Global test loss: 3.175, Global test accuracy: 15.44
Round  90, Train loss: 0.838, Test loss: 1.428, Test accuracy: 55.55
Round  90, Global train loss: 0.838, Global test loss: 2.994, Global test accuracy: 15.21
Round  91, Train loss: 0.810, Test loss: 1.440, Test accuracy: 54.88
Round  91, Global train loss: 0.810, Global test loss: 3.407, Global test accuracy: 14.52
Round  92, Train loss: 0.685, Test loss: 1.435, Test accuracy: 55.08
Round  92, Global train loss: 0.685, Global test loss: 3.263, Global test accuracy: 15.51
Round  93, Train loss: 0.817, Test loss: 1.422, Test accuracy: 55.37
Round  93, Global train loss: 0.817, Global test loss: 3.104, Global test accuracy: 14.15
Round  94, Train loss: 0.819, Test loss: 1.433, Test accuracy: 54.86
Round  94, Global train loss: 0.819, Global test loss: 3.191, Global test accuracy: 12.90
Round  95, Train loss: 0.748, Test loss: 1.440, Test accuracy: 54.93
Round  95, Global train loss: 0.748, Global test loss: 3.300, Global test accuracy: 14.86
Round  96, Train loss: 0.753, Test loss: 1.451, Test accuracy: 55.23
Round  96, Global train loss: 0.753, Global test loss: 3.284, Global test accuracy: 14.25
Round  97, Train loss: 0.657, Test loss: 1.471, Test accuracy: 55.32
Round  97, Global train loss: 0.657, Global test loss: 3.480, Global test accuracy: 14.45
Round  98, Train loss: 0.724, Test loss: 1.486, Test accuracy: 55.07
Round  98, Global train loss: 0.724, Global test loss: 3.328, Global test accuracy: 12.80
Round  99, Train loss: 0.770, Test loss: 1.500, Test accuracy: 54.73
Round  99, Global train loss: 0.770, Global test loss: 3.271, Global test accuracy: 15.00
Final Round, Train loss: 0.604, Test loss: 1.639, Test accuracy: 55.87
Final Round, Global train loss: 0.604, Global test loss: 3.271, Global test accuracy: 15.00
Average accuracy final 10 rounds: 55.102
Average global accuracy final 10 rounds: 14.365
2164.2867805957794
[1.5344386100769043, 2.7766830921173096, 4.016525506973267, 5.253474950790405, 6.490582466125488, 7.741684913635254, 9.000675201416016, 10.256306648254395, 11.504118919372559, 12.752715826034546, 13.998377799987793, 15.249738216400146, 16.498982667922974, 17.74436354637146, 18.98927092552185, 20.241043090820312, 21.489439725875854, 22.74121904373169, 23.992645978927612, 25.249419927597046, 26.54929494857788, 29.704885721206665, 32.88962411880493, 36.08142352104187, 39.22269296646118, 42.39286494255066, 45.52771973609924, 48.66476917266846, 51.75731539726257, 54.90513205528259, 58.03109908103943, 61.12374782562256, 64.17542815208435, 67.32828688621521, 70.4792902469635, 73.63108491897583, 76.78696322441101, 79.94639086723328, 83.1155173778534, 86.30293416976929, 89.41037225723267, 92.5577003955841, 95.7181351184845, 98.89724707603455, 102.0402159690857, 105.18796348571777, 108.36116552352905, 111.68110370635986, 114.96722555160522, 118.25793099403381, 121.50435781478882, 124.76501679420471, 128.04136991500854, 131.33543372154236, 134.59727597236633, 137.84568214416504, 141.1002082824707, 144.4087483882904, 147.67678093910217, 150.96911597251892, 154.27788472175598, 157.50826787948608, 160.79885506629944, 164.06361484527588, 167.3451337814331, 170.6299602985382, 173.90619945526123, 177.19159746170044, 180.4579212665558, 183.7314612865448, 187.00567960739136, 190.29525017738342, 193.53617763519287, 196.758216381073, 200.06132769584656, 203.33943605422974, 206.64862060546875, 209.95364141464233, 213.23461294174194, 216.55476713180542, 219.83491134643555, 223.11974501609802, 226.3956332206726, 229.68049812316895, 232.91673111915588, 236.21274304389954, 239.54117345809937, 242.8449728488922, 246.16863775253296, 249.42380785942078, 252.71690940856934, 255.97185516357422, 259.2958846092224, 262.51727843284607, 265.6801507472992, 268.82872676849365, 271.99142122268677, 275.15827345848083, 278.3279798030853, 281.501366853714, 283.9973192214966]
[16.09, 24.4, 29.9, 33.44, 36.88, 39.52, 44.84, 47.67, 49.62, 49.59, 51.94, 52.48, 52.73, 52.85, 54.07, 54.4, 54.93, 55.89, 55.82, 55.62, 56.5, 56.82, 56.61, 55.25, 56.09, 55.81, 56.7, 57.11, 57.21, 58.12, 57.73, 57.69, 58.53, 58.36, 58.33, 58.01, 57.39, 57.27, 57.49, 57.84, 57.13, 57.18, 57.17, 57.17, 57.79, 57.69, 57.47, 57.73, 57.98, 58.1, 57.43, 57.4, 57.29, 57.32, 57.18, 57.36, 57.15, 56.97, 56.84, 56.36, 56.91, 57.05, 56.05, 55.89, 56.29, 56.51, 55.98, 56.04, 56.03, 56.23, 57.04, 57.22, 57.52, 56.98, 57.56, 57.39, 56.76, 56.43, 55.89, 55.65, 55.65, 55.81, 56.03, 55.83, 55.97, 56.12, 55.89, 55.09, 55.24, 55.75, 55.55, 54.88, 55.08, 55.37, 54.86, 54.93, 55.23, 55.32, 55.07, 54.73, 55.87]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: none, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 13, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.616, Test loss: 1.390, Test accuracy: 43.06
Round   0, Global train loss: 1.616, Global test loss: 2.296, Global test accuracy: 12.02
Round   1, Train loss: 1.517, Test loss: 1.306, Test accuracy: 46.69
Round   1, Global train loss: 1.517, Global test loss: 2.273, Global test accuracy: 14.51
Round   2, Train loss: 1.449, Test loss: 1.255, Test accuracy: 50.51
Round   2, Global train loss: 1.449, Global test loss: 2.250, Global test accuracy: 16.16
Round   3, Train loss: 1.406, Test loss: 1.184, Test accuracy: 54.82
Round   3, Global train loss: 1.406, Global test loss: 2.239, Global test accuracy: 16.67
Round   4, Train loss: 1.368, Test loss: 1.175, Test accuracy: 55.11
Round   4, Global train loss: 1.368, Global test loss: 2.234, Global test accuracy: 16.70
Round   5, Train loss: 1.338, Test loss: 1.158, Test accuracy: 55.93
Round   5, Global train loss: 1.338, Global test loss: 2.232, Global test accuracy: 16.92
Round   6, Train loss: 1.309, Test loss: 1.162, Test accuracy: 55.46
Round   6, Global train loss: 1.309, Global test loss: 2.232, Global test accuracy: 17.07
Round   7, Train loss: 1.282, Test loss: 1.146, Test accuracy: 56.14
Round   7, Global train loss: 1.282, Global test loss: 2.234, Global test accuracy: 17.06
Round   8, Train loss: 1.253, Test loss: 1.154, Test accuracy: 56.13
Round   8, Global train loss: 1.253, Global test loss: 2.235, Global test accuracy: 16.81
Round   9, Train loss: 1.227, Test loss: 1.147, Test accuracy: 56.12
Round   9, Global train loss: 1.227, Global test loss: 2.242, Global test accuracy: 16.58
Round  10, Train loss: 1.244, Test loss: 1.145, Test accuracy: 56.63
Round  10, Global train loss: 1.244, Global test loss: 2.490, Global test accuracy: 12.63
Round  11, Train loss: 1.103, Test loss: 1.167, Test accuracy: 56.21
Round  11, Global train loss: 1.103, Global test loss: 2.558, Global test accuracy: 14.47
Round  12, Train loss: 1.069, Test loss: 1.148, Test accuracy: 57.51
Round  12, Global train loss: 1.069, Global test loss: 2.504, Global test accuracy: 14.57
Round  13, Train loss: 1.152, Test loss: 1.170, Test accuracy: 56.86
Round  13, Global train loss: 1.152, Global test loss: 2.391, Global test accuracy: 13.92
Round  14, Train loss: 1.214, Test loss: 1.189, Test accuracy: 56.14
Round  14, Global train loss: 1.214, Global test loss: 2.512, Global test accuracy: 12.12
Round  15, Train loss: 1.067, Test loss: 1.190, Test accuracy: 55.93
Round  15, Global train loss: 1.067, Global test loss: 2.687, Global test accuracy: 14.01
Round  16, Train loss: 1.113, Test loss: 1.209, Test accuracy: 56.01
Round  16, Global train loss: 1.113, Global test loss: 2.485, Global test accuracy: 15.13
Round  17, Train loss: 1.041, Test loss: 1.216, Test accuracy: 55.63
Round  17, Global train loss: 1.041, Global test loss: 2.628, Global test accuracy: 14.48
Round  18, Train loss: 1.061, Test loss: 1.212, Test accuracy: 56.16
Round  18, Global train loss: 1.061, Global test loss: 2.562, Global test accuracy: 14.53
Round  19, Train loss: 0.908, Test loss: 1.232, Test accuracy: 56.29
Round  19, Global train loss: 0.908, Global test loss: 2.864, Global test accuracy: 14.73
Round  20, Train loss: 1.007, Test loss: 1.254, Test accuracy: 55.73
Round  20, Global train loss: 1.007, Global test loss: 2.753, Global test accuracy: 13.06
Round  21, Train loss: 0.894, Test loss: 1.315, Test accuracy: 55.15
Round  21, Global train loss: 0.894, Global test loss: 2.875, Global test accuracy: 15.07
Round  22, Train loss: 0.872, Test loss: 1.353, Test accuracy: 54.42
Round  22, Global train loss: 0.872, Global test loss: 2.832, Global test accuracy: 14.97
Round  23, Train loss: 0.781, Test loss: 1.386, Test accuracy: 54.31
Round  23, Global train loss: 0.781, Global test loss: 2.965, Global test accuracy: 13.73
Round  24, Train loss: 0.923, Test loss: 1.416, Test accuracy: 54.10
Round  24, Global train loss: 0.923, Global test loss: 2.773, Global test accuracy: 13.63
Round  25, Train loss: 0.976, Test loss: 1.417, Test accuracy: 54.57
Round  25, Global train loss: 0.976, Global test loss: 2.849, Global test accuracy: 12.01
Round  26, Train loss: 0.789, Test loss: 1.436, Test accuracy: 54.64
Round  26, Global train loss: 0.789, Global test loss: 2.990, Global test accuracy: 14.70
Round  27, Train loss: 0.871, Test loss: 1.435, Test accuracy: 54.86
Round  27, Global train loss: 0.871, Global test loss: 3.015, Global test accuracy: 13.62
Round  28, Train loss: 0.835, Test loss: 1.484, Test accuracy: 54.38
Round  28, Global train loss: 0.835, Global test loss: 3.009, Global test accuracy: 13.67
Round  29, Train loss: 0.688, Test loss: 1.511, Test accuracy: 54.16
Round  29, Global train loss: 0.688, Global test loss: 3.120, Global test accuracy: 14.23
Round  30, Train loss: 0.728, Test loss: 1.524, Test accuracy: 54.14
Round  30, Global train loss: 0.728, Global test loss: 3.436, Global test accuracy: 13.98
Round  31, Train loss: 0.692, Test loss: 1.530, Test accuracy: 54.33
Round  31, Global train loss: 0.692, Global test loss: 3.179, Global test accuracy: 15.29
Round  32, Train loss: 0.701, Test loss: 1.567, Test accuracy: 54.44
Round  32, Global train loss: 0.701, Global test loss: 3.174, Global test accuracy: 13.32
Round  33, Train loss: 0.804, Test loss: 1.592, Test accuracy: 54.37
Round  33, Global train loss: 0.804, Global test loss: 3.096, Global test accuracy: 15.49
Round  34, Train loss: 0.658, Test loss: 1.600, Test accuracy: 54.21
Round  34, Global train loss: 0.658, Global test loss: 3.463, Global test accuracy: 13.68
Round  35, Train loss: 0.630, Test loss: 1.603, Test accuracy: 54.61
Round  35, Global train loss: 0.630, Global test loss: 3.249, Global test accuracy: 14.52
Round  36, Train loss: 0.776, Test loss: 1.623, Test accuracy: 54.35
Round  36, Global train loss: 0.776, Global test loss: 3.252, Global test accuracy: 14.18
Round  37, Train loss: 0.648, Test loss: 1.648, Test accuracy: 54.05
Round  37, Global train loss: 0.648, Global test loss: 3.414, Global test accuracy: 14.11
Round  38, Train loss: 0.822, Test loss: 1.669, Test accuracy: 54.06
Round  38, Global train loss: 0.822, Global test loss: 3.132, Global test accuracy: 14.78
Round  39, Train loss: 0.604, Test loss: 1.691, Test accuracy: 54.28
Round  39, Global train loss: 0.604, Global test loss: 3.549, Global test accuracy: 14.59
Round  40, Train loss: 0.658, Test loss: 1.682, Test accuracy: 54.66
Round  40, Global train loss: 0.658, Global test loss: 3.520, Global test accuracy: 13.92
Round  41, Train loss: 0.612, Test loss: 1.702, Test accuracy: 54.81
Round  41, Global train loss: 0.612, Global test loss: 3.619, Global test accuracy: 14.03
Round  42, Train loss: 0.541, Test loss: 1.721, Test accuracy: 54.25
Round  42, Global train loss: 0.541, Global test loss: 3.556, Global test accuracy: 14.71
Round  43, Train loss: 0.688, Test loss: 1.756, Test accuracy: 53.95
Round  43, Global train loss: 0.688, Global test loss: 3.452, Global test accuracy: 13.72
Round  44, Train loss: 0.605, Test loss: 1.769, Test accuracy: 53.83
Round  44, Global train loss: 0.605, Global test loss: 3.459, Global test accuracy: 15.69
Round  45, Train loss: 0.554, Test loss: 1.786, Test accuracy: 53.95
Round  45, Global train loss: 0.554, Global test loss: 3.661, Global test accuracy: 14.36
Round  46, Train loss: 0.635, Test loss: 1.794, Test accuracy: 54.11
Round  46, Global train loss: 0.635, Global test loss: 3.430, Global test accuracy: 14.98
Round  47, Train loss: 0.589, Test loss: 1.813, Test accuracy: 53.84
Round  47, Global train loss: 0.589, Global test loss: 3.872, Global test accuracy: 14.28
Round  48, Train loss: 0.573, Test loss: 1.862, Test accuracy: 52.91
Round  48, Global train loss: 0.573, Global test loss: 3.607, Global test accuracy: 14.22
Round  49, Train loss: 0.636, Test loss: 1.893, Test accuracy: 53.22
Round  49, Global train loss: 0.636, Global test loss: 3.452, Global test accuracy: 14.24
Round  50, Train loss: 0.625, Test loss: 1.896, Test accuracy: 52.71
Round  50, Global train loss: 0.625, Global test loss: 3.573, Global test accuracy: 13.45
Round  51, Train loss: 0.469, Test loss: 1.913, Test accuracy: 53.02
Round  51, Global train loss: 0.469, Global test loss: 4.122, Global test accuracy: 15.21
Round  52, Train loss: 0.576, Test loss: 1.919, Test accuracy: 53.11
Round  52, Global train loss: 0.576, Global test loss: 3.838, Global test accuracy: 14.28
Round  53, Train loss: 0.669, Test loss: 1.938, Test accuracy: 52.74
Round  53, Global train loss: 0.669, Global test loss: 3.773, Global test accuracy: 13.29
Round  54, Train loss: 0.538, Test loss: 1.931, Test accuracy: 53.26
Round  54, Global train loss: 0.538, Global test loss: 3.857, Global test accuracy: 13.54
Round  55, Train loss: 0.419, Test loss: 1.964, Test accuracy: 52.99
Round  55, Global train loss: 0.419, Global test loss: 4.379, Global test accuracy: 15.08
Round  56, Train loss: 0.543, Test loss: 2.005, Test accuracy: 53.25
Round  56, Global train loss: 0.543, Global test loss: 3.678, Global test accuracy: 14.19
Round  57, Train loss: 0.572, Test loss: 1.974, Test accuracy: 53.60
Round  57, Global train loss: 0.572, Global test loss: 3.723, Global test accuracy: 14.44
Round  58, Train loss: 0.499, Test loss: 1.970, Test accuracy: 53.46
Round  58, Global train loss: 0.499, Global test loss: 4.113, Global test accuracy: 14.44
Round  59, Train loss: 0.590, Test loss: 2.004, Test accuracy: 52.91
Round  59, Global train loss: 0.590, Global test loss: 4.124, Global test accuracy: 13.89
Round  60, Train loss: 0.529, Test loss: 2.008, Test accuracy: 53.24
Round  60, Global train loss: 0.529, Global test loss: 3.716, Global test accuracy: 13.49
Round  61, Train loss: 0.502, Test loss: 2.044, Test accuracy: 53.19
Round  61, Global train loss: 0.502, Global test loss: 3.923, Global test accuracy: 14.05
Round  62, Train loss: 0.575, Test loss: 2.085, Test accuracy: 52.35
Round  62, Global train loss: 0.575, Global test loss: 3.952, Global test accuracy: 13.45
Round  63, Train loss: 0.572, Test loss: 2.106, Test accuracy: 52.26
Round  63, Global train loss: 0.572, Global test loss: 3.711, Global test accuracy: 14.26
Round  64, Train loss: 0.521, Test loss: 2.069, Test accuracy: 52.88
Round  64, Global train loss: 0.521, Global test loss: 3.796, Global test accuracy: 14.58
Round  65, Train loss: 0.500, Test loss: 2.032, Test accuracy: 53.31
Round  65, Global train loss: 0.500, Global test loss: 3.760, Global test accuracy: 13.55
Round  66, Train loss: 0.428, Test loss: 2.042, Test accuracy: 53.37
Round  66, Global train loss: 0.428, Global test loss: 4.082, Global test accuracy: 14.64
Round  67, Train loss: 0.585, Test loss: 2.077, Test accuracy: 53.28
Round  67, Global train loss: 0.585, Global test loss: 3.738, Global test accuracy: 13.38
Round  68, Train loss: 0.425, Test loss: 2.091, Test accuracy: 53.32
Round  68, Global train loss: 0.425, Global test loss: 4.270, Global test accuracy: 14.56
Round  69, Train loss: 0.539, Test loss: 2.084, Test accuracy: 53.34
Round  69, Global train loss: 0.539, Global test loss: 3.784, Global test accuracy: 14.04
Round  70, Train loss: 0.381, Test loss: 2.119, Test accuracy: 53.11
Round  70, Global train loss: 0.381, Global test loss: 4.527, Global test accuracy: 14.70
Round  71, Train loss: 0.466, Test loss: 2.127, Test accuracy: 52.90
Round  71, Global train loss: 0.466, Global test loss: 4.151, Global test accuracy: 13.79
Round  72, Train loss: 0.478, Test loss: 2.129, Test accuracy: 53.11
Round  72, Global train loss: 0.478, Global test loss: 3.857, Global test accuracy: 13.15
Round  73, Train loss: 0.510, Test loss: 2.122, Test accuracy: 52.92
Round  73, Global train loss: 0.510, Global test loss: 4.040, Global test accuracy: 13.73
Round  74, Train loss: 0.397, Test loss: 2.138, Test accuracy: 52.77
Round  74, Global train loss: 0.397, Global test loss: 4.113, Global test accuracy: 14.46
Round  75, Train loss: 0.397, Test loss: 2.158, Test accuracy: 52.91
Round  75, Global train loss: 0.397, Global test loss: 4.539, Global test accuracy: 13.74
Round  76, Train loss: 0.496, Test loss: 2.231, Test accuracy: 51.91
Round  76, Global train loss: 0.496, Global test loss: 4.085, Global test accuracy: 12.94
Round  77, Train loss: 0.444, Test loss: 2.209, Test accuracy: 52.66
Round  77, Global train loss: 0.444, Global test loss: 4.374, Global test accuracy: 13.03
Round  78, Train loss: 0.483, Test loss: 2.213, Test accuracy: 53.50
Round  78, Global train loss: 0.483, Global test loss: 4.080, Global test accuracy: 14.77
Round  79, Train loss: 0.448, Test loss: 2.178, Test accuracy: 53.67
Round  79, Global train loss: 0.448, Global test loss: 3.999, Global test accuracy: 13.98
Round  80, Train loss: 0.353, Test loss: 2.193, Test accuracy: 53.28
Round  80, Global train loss: 0.353, Global test loss: 3.991, Global test accuracy: 14.98
Round  81, Train loss: 0.326, Test loss: 2.188, Test accuracy: 53.43
Round  81, Global train loss: 0.326, Global test loss: 4.095, Global test accuracy: 15.17
Round  82, Train loss: 0.303, Test loss: 2.181, Test accuracy: 53.72
Round  82, Global train loss: 0.303, Global test loss: 4.129, Global test accuracy: 15.34
Round  83, Train loss: 0.296, Test loss: 2.211, Test accuracy: 53.65
Round  83, Global train loss: 0.296, Global test loss: 4.229, Global test accuracy: 15.11
Round  84, Train loss: 0.283, Test loss: 2.227, Test accuracy: 53.73
Round  84, Global train loss: 0.283, Global test loss: 4.290, Global test accuracy: 15.20
Round  85, Train loss: 0.281, Test loss: 2.239, Test accuracy: 53.25
Round  85, Global train loss: 0.281, Global test loss: 4.260, Global test accuracy: 15.23
Round  86, Train loss: 0.267, Test loss: 2.239, Test accuracy: 53.30
Round  86, Global train loss: 0.267, Global test loss: 4.431, Global test accuracy: 15.16
Round  87, Train loss: 0.261, Test loss: 2.268, Test accuracy: 53.52
Round  87, Global train loss: 0.261, Global test loss: 4.448, Global test accuracy: 15.30
Round  88, Train loss: 0.250, Test loss: 2.262, Test accuracy: 53.97
Round  88, Global train loss: 0.250, Global test loss: 4.480, Global test accuracy: 15.14
Round  89, Train loss: 0.245, Test loss: 2.256, Test accuracy: 53.87
Round  89, Global train loss: 0.245, Global test loss: 4.508, Global test accuracy: 15.16
Round  90, Train loss: 0.455, Test loss: 2.210, Test accuracy: 53.26
Round  90, Global train loss: 0.455, Global test loss: 3.766, Global test accuracy: 15.05
Round  91, Train loss: 0.423, Test loss: 2.244, Test accuracy: 52.93
Round  91, Global train loss: 0.423, Global test loss: 3.718, Global test accuracy: 14.69
Round  92, Train loss: 0.410, Test loss: 2.294, Test accuracy: 52.12
Round  92, Global train loss: 0.410, Global test loss: 3.730, Global test accuracy: 14.33
Round  93, Train loss: 0.399, Test loss: 2.314, Test accuracy: 53.25
Round  93, Global train loss: 0.399, Global test loss: 3.743, Global test accuracy: 14.17
Round  94, Train loss: 0.390, Test loss: 2.328, Test accuracy: 53.28
Round  94, Global train loss: 0.390, Global test loss: 3.778, Global test accuracy: 14.65
Round  95, Train loss: 0.387, Test loss: 2.299, Test accuracy: 53.05
Round  95, Global train loss: 0.387, Global test loss: 3.761, Global test accuracy: 14.31
Round  96, Train loss: 0.381, Test loss: 2.248, Test accuracy: 53.37
Round  96, Global train loss: 0.381, Global test loss: 3.741, Global test accuracy: 14.19
Round  97, Train loss: 0.380, Test loss: 2.364, Test accuracy: 53.16
Round  97, Global train loss: 0.380, Global test loss: 3.784, Global test accuracy: 14.80
Round  98, Train loss: 0.377, Test loss: 2.309, Test accuracy: 53.69
Round  98, Global train loss: 0.377, Global test loss: 3.788, Global test accuracy: 14.59
Round  99, Train loss: 0.373, Test loss: 2.315, Test accuracy: 53.15
Round  99, Global train loss: 0.373, Global test loss: 3.785, Global test accuracy: 14.52
Final Round, Train loss: 0.267, Test loss: 2.621, Test accuracy: 54.69
Final Round, Global train loss: 0.267, Global test loss: 3.785, Global test accuracy: 14.52
Average accuracy final 10 rounds: 53.126
Average global accuracy final 10 rounds: 14.53
2480.3003385066986
[2.5674729347229004, 4.513175010681152, 6.441336393356323, 8.406371831893921, 10.356302499771118, 12.310396432876587, 14.261679887771606, 16.20845937728882, 18.165128707885742, 20.12066650390625, 22.080894708633423, 24.022398233413696, 25.96534776687622, 27.90768575668335, 29.8538236618042, 31.793267488479614, 33.73466372489929, 35.68547439575195, 37.63515901565552, 39.60256552696228, 41.56124997138977, 43.50913429260254, 45.470380783081055, 47.41776657104492, 49.36958980560303, 51.33169412612915, 53.32905030250549, 55.294071197509766, 57.25473761558533, 59.21890211105347, 61.17484903335571, 63.133065700531006, 65.08045268058777, 67.0313630104065, 68.98061013221741, 70.92785978317261, 72.88663792610168, 74.84691023826599, 76.80825400352478, 78.7683835029602, 80.73667883872986, 82.6979112625122, 84.66340446472168, 86.62327027320862, 88.58613634109497, 90.5440776348114, 92.50792670249939, 94.46159195899963, 96.41771340370178, 98.39015293121338, 100.3708233833313, 102.31812357902527, 104.27553105354309, 106.21509385108948, 108.16848397254944, 110.11850237846375, 112.07775139808655, 114.04198813438416, 116.26221442222595, 118.50171041488647, 120.73658537864685, 122.97324204444885, 125.23069524765015, 127.46873211860657, 129.7476680278778, 132.01652026176453, 134.2901749610901, 136.56667041778564, 138.83957171440125, 141.12861609458923, 143.41848492622375, 145.7072548866272, 147.97822403907776, 150.24363708496094, 152.51820158958435, 154.78924679756165, 157.01948142051697, 159.2692584991455, 161.5175633430481, 163.76953101158142, 166.06517672538757, 168.33251070976257, 170.5907998085022, 172.8479905128479, 175.11783266067505, 177.38950300216675, 179.6636073589325, 181.91650915145874, 184.18660020828247, 186.44320106506348, 188.71723556518555, 190.98882055282593, 193.24979996681213, 195.53026485443115, 197.81582927703857, 200.08945870399475, 202.36794352531433, 204.63822197914124, 206.89788842201233, 209.1706051826477, 213.72742438316345]
[43.06, 46.69, 50.51, 54.82, 55.11, 55.93, 55.46, 56.14, 56.13, 56.12, 56.63, 56.21, 57.51, 56.86, 56.14, 55.93, 56.01, 55.63, 56.16, 56.29, 55.73, 55.15, 54.42, 54.31, 54.1, 54.57, 54.64, 54.86, 54.38, 54.16, 54.14, 54.33, 54.44, 54.37, 54.21, 54.61, 54.35, 54.05, 54.06, 54.28, 54.66, 54.81, 54.25, 53.95, 53.83, 53.95, 54.11, 53.84, 52.91, 53.22, 52.71, 53.02, 53.11, 52.74, 53.26, 52.99, 53.25, 53.6, 53.46, 52.91, 53.24, 53.19, 52.35, 52.26, 52.88, 53.31, 53.37, 53.28, 53.32, 53.34, 53.11, 52.9, 53.11, 52.92, 52.77, 52.91, 51.91, 52.66, 53.5, 53.67, 53.28, 53.43, 53.72, 53.65, 53.73, 53.25, 53.3, 53.52, 53.97, 53.87, 53.26, 52.93, 52.12, 53.25, 53.28, 53.05, 53.37, 53.16, 53.69, 53.15, 54.69]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.618, Test loss: 1.389, Test accuracy: 43.27
Round   0, Global train loss: 1.618, Global test loss: 2.287, Global test accuracy: 14.00
Round   1, Train loss: 1.517, Test loss: 1.306, Test accuracy: 47.88
Round   1, Global train loss: 1.517, Global test loss: 2.285, Global test accuracy: 14.23
Round   2, Train loss: 1.454, Test loss: 1.256, Test accuracy: 50.96
Round   2, Global train loss: 1.454, Global test loss: 2.282, Global test accuracy: 14.15
Round   3, Train loss: 1.411, Test loss: 1.199, Test accuracy: 54.12
Round   3, Global train loss: 1.411, Global test loss: 2.283, Global test accuracy: 14.30
Round   4, Train loss: 1.374, Test loss: 1.188, Test accuracy: 54.50
Round   4, Global train loss: 1.374, Global test loss: 2.282, Global test accuracy: 14.54
Round   5, Train loss: 1.344, Test loss: 1.170, Test accuracy: 55.88
Round   5, Global train loss: 1.344, Global test loss: 2.285, Global test accuracy: 14.54
Round   6, Train loss: 1.313, Test loss: 1.208, Test accuracy: 53.25
Round   6, Global train loss: 1.313, Global test loss: 2.291, Global test accuracy: 14.87
Round   7, Train loss: 1.285, Test loss: 1.166, Test accuracy: 56.92
Round   7, Global train loss: 1.285, Global test loss: 2.294, Global test accuracy: 14.46
Round   8, Train loss: 1.253, Test loss: 1.156, Test accuracy: 56.46
Round   8, Global train loss: 1.253, Global test loss: 2.301, Global test accuracy: 14.74
Round   9, Train loss: 1.223, Test loss: 1.177, Test accuracy: 55.63
Round   9, Global train loss: 1.223, Global test loss: 2.310, Global test accuracy: 14.80
Round  10, Train loss: 1.135, Test loss: 1.177, Test accuracy: 55.89
Round  10, Global train loss: 1.135, Global test loss: 2.716, Global test accuracy: 14.73
Round  11, Train loss: 1.078, Test loss: 1.173, Test accuracy: 56.48
Round  11, Global train loss: 1.078, Global test loss: 2.641, Global test accuracy: 14.71
Round  12, Train loss: 1.142, Test loss: 1.173, Test accuracy: 56.42
Round  12, Global train loss: 1.142, Global test loss: 2.588, Global test accuracy: 13.31
Round  13, Train loss: 1.178, Test loss: 1.190, Test accuracy: 56.22
Round  13, Global train loss: 1.178, Global test loss: 2.529, Global test accuracy: 12.29
Round  14, Train loss: 1.125, Test loss: 1.211, Test accuracy: 55.23
Round  14, Global train loss: 1.125, Global test loss: 2.505, Global test accuracy: 14.85
Round  15, Train loss: 1.080, Test loss: 1.236, Test accuracy: 55.14
Round  15, Global train loss: 1.080, Global test loss: 2.595, Global test accuracy: 13.79
Round  16, Train loss: 1.242, Test loss: 1.249, Test accuracy: 54.70
Round  16, Global train loss: 1.242, Global test loss: 2.463, Global test accuracy: 12.84
Round  17, Train loss: 1.117, Test loss: 1.265, Test accuracy: 54.71
Round  17, Global train loss: 1.117, Global test loss: 2.660, Global test accuracy: 13.44
Round  18, Train loss: 1.069, Test loss: 1.284, Test accuracy: 54.90
Round  18, Global train loss: 1.069, Global test loss: 2.736, Global test accuracy: 12.50
Round  19, Train loss: 0.970, Test loss: 1.314, Test accuracy: 54.82
Round  19, Global train loss: 0.970, Global test loss: 2.864, Global test accuracy: 13.65
Round  20, Train loss: 0.941, Test loss: 1.350, Test accuracy: 54.29
Round  20, Global train loss: 0.941, Global test loss: 2.937, Global test accuracy: 14.63
Round  21, Train loss: 0.831, Test loss: 1.397, Test accuracy: 53.53
Round  21, Global train loss: 0.831, Global test loss: 2.898, Global test accuracy: 14.09
Round  22, Train loss: 0.936, Test loss: 1.439, Test accuracy: 53.13
Round  22, Global train loss: 0.936, Global test loss: 2.789, Global test accuracy: 13.47
Round  23, Train loss: 0.797, Test loss: 1.422, Test accuracy: 53.82
Round  23, Global train loss: 0.797, Global test loss: 3.041, Global test accuracy: 12.96
Round  24, Train loss: 0.810, Test loss: 1.451, Test accuracy: 53.36
Round  24, Global train loss: 0.810, Global test loss: 3.053, Global test accuracy: 12.73
Round  25, Train loss: 0.923, Test loss: 1.463, Test accuracy: 53.16
Round  25, Global train loss: 0.923, Global test loss: 2.895, Global test accuracy: 13.10
Round  26, Train loss: 0.941, Test loss: 1.492, Test accuracy: 52.87
Round  26, Global train loss: 0.941, Global test loss: 2.696, Global test accuracy: 12.98
Round  27, Train loss: 0.842, Test loss: 1.507, Test accuracy: 52.83
Round  27, Global train loss: 0.842, Global test loss: 3.017, Global test accuracy: 12.98
Round  28, Train loss: 0.763, Test loss: 1.535, Test accuracy: 52.67
Round  28, Global train loss: 0.763, Global test loss: 3.153, Global test accuracy: 14.48
Round  29, Train loss: 0.763, Test loss: 1.568, Test accuracy: 52.99
Round  29, Global train loss: 0.763, Global test loss: 3.109, Global test accuracy: 13.56
Round  30, Train loss: 0.808, Test loss: 1.562, Test accuracy: 53.18
Round  30, Global train loss: 0.808, Global test loss: 3.164, Global test accuracy: 12.11
Round  31, Train loss: 0.767, Test loss: 1.592, Test accuracy: 53.29
Round  31, Global train loss: 0.767, Global test loss: 3.261, Global test accuracy: 13.43
Round  32, Train loss: 0.773, Test loss: 1.618, Test accuracy: 53.35
Round  32, Global train loss: 0.773, Global test loss: 3.378, Global test accuracy: 12.29
Round  33, Train loss: 0.786, Test loss: 1.621, Test accuracy: 53.79
Round  33, Global train loss: 0.786, Global test loss: 3.072, Global test accuracy: 13.02
Round  34, Train loss: 0.732, Test loss: 1.638, Test accuracy: 53.35
Round  34, Global train loss: 0.732, Global test loss: 3.362, Global test accuracy: 13.43
Round  35, Train loss: 0.678, Test loss: 1.684, Test accuracy: 52.76
Round  35, Global train loss: 0.678, Global test loss: 3.559, Global test accuracy: 14.26
Round  36, Train loss: 0.713, Test loss: 1.691, Test accuracy: 52.79
Round  36, Global train loss: 0.713, Global test loss: 3.378, Global test accuracy: 13.29
Round  37, Train loss: 0.625, Test loss: 1.721, Test accuracy: 52.97
Round  37, Global train loss: 0.625, Global test loss: 3.440, Global test accuracy: 14.38
Round  38, Train loss: 0.759, Test loss: 1.771, Test accuracy: 52.11
Round  38, Global train loss: 0.759, Global test loss: 3.170, Global test accuracy: 13.15
Round  39, Train loss: 0.608, Test loss: 1.776, Test accuracy: 52.38
Round  39, Global train loss: 0.608, Global test loss: 3.632, Global test accuracy: 14.31
Round  40, Train loss: 0.536, Test loss: 1.823, Test accuracy: 52.23
Round  40, Global train loss: 0.536, Global test loss: 3.988, Global test accuracy: 13.67
Round  41, Train loss: 0.597, Test loss: 1.822, Test accuracy: 52.58
Round  41, Global train loss: 0.597, Global test loss: 3.860, Global test accuracy: 13.82
Round  42, Train loss: 0.577, Test loss: 1.810, Test accuracy: 53.08
Round  42, Global train loss: 0.577, Global test loss: 3.872, Global test accuracy: 14.53
Round  43, Train loss: 0.660, Test loss: 1.834, Test accuracy: 52.73
Round  43, Global train loss: 0.660, Global test loss: 3.404, Global test accuracy: 14.05
Round  44, Train loss: 0.628, Test loss: 1.863, Test accuracy: 52.77
Round  44, Global train loss: 0.628, Global test loss: 3.757, Global test accuracy: 12.13
Round  45, Train loss: 0.578, Test loss: 1.864, Test accuracy: 53.30
Round  45, Global train loss: 0.578, Global test loss: 3.703, Global test accuracy: 13.22
Round  46, Train loss: 0.574, Test loss: 1.884, Test accuracy: 52.54
Round  46, Global train loss: 0.574, Global test loss: 3.671, Global test accuracy: 12.91
Round  47, Train loss: 0.557, Test loss: 1.914, Test accuracy: 52.33
Round  47, Global train loss: 0.557, Global test loss: 3.676, Global test accuracy: 12.80
Round  48, Train loss: 0.709, Test loss: 1.915, Test accuracy: 52.71
Round  48, Global train loss: 0.709, Global test loss: 3.499, Global test accuracy: 13.15
Round  49, Train loss: 0.587, Test loss: 1.919, Test accuracy: 52.94
Round  49, Global train loss: 0.587, Global test loss: 3.549, Global test accuracy: 12.86
Round  50, Train loss: 0.626, Test loss: 1.962, Test accuracy: 52.56
Round  50, Global train loss: 0.626, Global test loss: 3.699, Global test accuracy: 12.69
Round  51, Train loss: 0.617, Test loss: 1.965, Test accuracy: 52.15
Round  51, Global train loss: 0.617, Global test loss: 3.692, Global test accuracy: 12.09
Round  52, Train loss: 0.603, Test loss: 1.955, Test accuracy: 52.44
Round  52, Global train loss: 0.603, Global test loss: 3.739, Global test accuracy: 13.10
Round  53, Train loss: 0.567, Test loss: 1.950, Test accuracy: 52.60
Round  53, Global train loss: 0.567, Global test loss: 3.608, Global test accuracy: 13.69
Round  54, Train loss: 0.572, Test loss: 1.947, Test accuracy: 53.25
Round  54, Global train loss: 0.572, Global test loss: 3.680, Global test accuracy: 13.95
Round  55, Train loss: 0.492, Test loss: 1.982, Test accuracy: 52.88
Round  55, Global train loss: 0.492, Global test loss: 4.109, Global test accuracy: 13.14
Round  56, Train loss: 0.543, Test loss: 1.967, Test accuracy: 53.04
Round  56, Global train loss: 0.543, Global test loss: 3.843, Global test accuracy: 13.73
Round  57, Train loss: 0.485, Test loss: 2.002, Test accuracy: 52.82
Round  57, Global train loss: 0.485, Global test loss: 4.258, Global test accuracy: 14.00
Round  58, Train loss: 0.485, Test loss: 2.014, Test accuracy: 53.01
Round  58, Global train loss: 0.485, Global test loss: 3.627, Global test accuracy: 13.78
Round  59, Train loss: 0.523, Test loss: 1.998, Test accuracy: 53.19
Round  59, Global train loss: 0.523, Global test loss: 3.952, Global test accuracy: 13.99
Round  60, Train loss: 0.536, Test loss: 1.987, Test accuracy: 53.38
Round  60, Global train loss: 0.536, Global test loss: 3.763, Global test accuracy: 13.57
Round  61, Train loss: 0.416, Test loss: 2.030, Test accuracy: 52.94
Round  61, Global train loss: 0.416, Global test loss: 4.259, Global test accuracy: 14.00
Round  62, Train loss: 0.520, Test loss: 2.058, Test accuracy: 52.49
Round  62, Global train loss: 0.520, Global test loss: 4.064, Global test accuracy: 13.10
Round  63, Train loss: 0.566, Test loss: 2.073, Test accuracy: 52.47
Round  63, Global train loss: 0.566, Global test loss: 3.793, Global test accuracy: 13.44
Round  64, Train loss: 0.422, Test loss: 2.069, Test accuracy: 52.72
Round  64, Global train loss: 0.422, Global test loss: 4.214, Global test accuracy: 13.84
Round  65, Train loss: 0.485, Test loss: 2.058, Test accuracy: 52.87
Round  65, Global train loss: 0.485, Global test loss: 4.355, Global test accuracy: 13.84
Round  66, Train loss: 0.501, Test loss: 2.122, Test accuracy: 52.72
Round  66, Global train loss: 0.501, Global test loss: 3.788, Global test accuracy: 13.19
Round  67, Train loss: 0.505, Test loss: 2.124, Test accuracy: 52.56
Round  67, Global train loss: 0.505, Global test loss: 4.042, Global test accuracy: 12.86
Round  68, Train loss: 0.468, Test loss: 2.141, Test accuracy: 52.40
Round  68, Global train loss: 0.468, Global test loss: 3.930, Global test accuracy: 13.42
Round  69, Train loss: 0.533, Test loss: 2.139, Test accuracy: 52.05
Round  69, Global train loss: 0.533, Global test loss: 4.263, Global test accuracy: 11.47
Round  70, Train loss: 0.388, Test loss: 2.171, Test accuracy: 51.79
Round  70, Global train loss: 0.388, Global test loss: 4.026, Global test accuracy: 12.81
Round  71, Train loss: 0.508, Test loss: 2.166, Test accuracy: 51.82
Round  71, Global train loss: 0.508, Global test loss: 4.252, Global test accuracy: 12.19
Round  72, Train loss: 0.478, Test loss: 2.162, Test accuracy: 51.92
Round  72, Global train loss: 0.478, Global test loss: 4.055, Global test accuracy: 13.04
Round  73, Train loss: 0.447, Test loss: 2.143, Test accuracy: 52.28
Round  73, Global train loss: 0.447, Global test loss: 4.218, Global test accuracy: 13.16
Round  74, Train loss: 0.429, Test loss: 2.141, Test accuracy: 52.32
Round  74, Global train loss: 0.429, Global test loss: 4.044, Global test accuracy: 13.54
Round  75, Train loss: 0.399, Test loss: 2.159, Test accuracy: 52.35
Round  75, Global train loss: 0.399, Global test loss: 4.120, Global test accuracy: 13.06
Round  76, Train loss: 0.440, Test loss: 2.183, Test accuracy: 52.11
Round  76, Global train loss: 0.440, Global test loss: 4.066, Global test accuracy: 14.21
Round  77, Train loss: 0.472, Test loss: 2.206, Test accuracy: 52.40
Round  77, Global train loss: 0.472, Global test loss: 3.953, Global test accuracy: 13.29
Round  78, Train loss: 0.458, Test loss: 2.189, Test accuracy: 52.70
Round  78, Global train loss: 0.458, Global test loss: 3.972, Global test accuracy: 14.15
Round  79, Train loss: 0.413, Test loss: 2.234, Test accuracy: 52.34
Round  79, Global train loss: 0.413, Global test loss: 4.118, Global test accuracy: 13.80
Round  80, Train loss: 0.347, Test loss: 2.209, Test accuracy: 52.22
Round  80, Global train loss: 0.347, Global test loss: 4.035, Global test accuracy: 14.22
Round  81, Train loss: 0.311, Test loss: 2.227, Test accuracy: 52.38
Round  81, Global train loss: 0.311, Global test loss: 4.255, Global test accuracy: 14.29
Round  82, Train loss: 0.304, Test loss: 2.212, Test accuracy: 52.49
Round  82, Global train loss: 0.304, Global test loss: 4.256, Global test accuracy: 14.48
Round  83, Train loss: 0.295, Test loss: 2.255, Test accuracy: 52.61
Round  83, Global train loss: 0.295, Global test loss: 4.350, Global test accuracy: 13.99
Round  84, Train loss: 0.284, Test loss: 2.244, Test accuracy: 52.27
Round  84, Global train loss: 0.284, Global test loss: 4.402, Global test accuracy: 14.10
Round  85, Train loss: 0.268, Test loss: 2.272, Test accuracy: 51.95
Round  85, Global train loss: 0.268, Global test loss: 4.419, Global test accuracy: 14.28
Round  86, Train loss: 0.271, Test loss: 2.267, Test accuracy: 52.70
Round  86, Global train loss: 0.271, Global test loss: 4.507, Global test accuracy: 13.99
Round  87, Train loss: 0.261, Test loss: 2.298, Test accuracy: 52.43
Round  87, Global train loss: 0.261, Global test loss: 4.461, Global test accuracy: 14.46
Round  88, Train loss: 0.254, Test loss: 2.259, Test accuracy: 52.48
Round  88, Global train loss: 0.254, Global test loss: 4.546, Global test accuracy: 14.38
Round  89, Train loss: 0.249, Test loss: 2.304, Test accuracy: 52.52
Round  89, Global train loss: 0.249, Global test loss: 4.624, Global test accuracy: 14.20
Round  90, Train loss: 0.459, Test loss: 2.283, Test accuracy: 52.47
Round  90, Global train loss: 0.459, Global test loss: 3.833, Global test accuracy: 13.80
Round  91, Train loss: 0.420, Test loss: 2.285, Test accuracy: 52.84
Round  91, Global train loss: 0.420, Global test loss: 3.810, Global test accuracy: 13.65
Round  92, Train loss: 0.405, Test loss: 2.308, Test accuracy: 52.89
Round  92, Global train loss: 0.405, Global test loss: 3.815, Global test accuracy: 13.48
Round  93, Train loss: 0.392, Test loss: 2.344, Test accuracy: 52.37
Round  93, Global train loss: 0.392, Global test loss: 3.852, Global test accuracy: 13.56
Round  94, Train loss: 0.391, Test loss: 2.314, Test accuracy: 52.95
Round  94, Global train loss: 0.391, Global test loss: 3.812, Global test accuracy: 13.60
Round  95, Train loss: 0.382, Test loss: 2.374, Test accuracy: 51.81
Round  95, Global train loss: 0.382, Global test loss: 3.844, Global test accuracy: 13.64
Round  96, Train loss: 0.382, Test loss: 2.339, Test accuracy: 52.94
Round  96, Global train loss: 0.382, Global test loss: 3.823, Global test accuracy: 13.96
Round  97, Train loss: 0.373, Test loss: 2.350, Test accuracy: 52.89
Round  97, Global train loss: 0.373, Global test loss: 3.825, Global test accuracy: 13.85
Round  98, Train loss: 0.368, Test loss: 2.399, Test accuracy: 52.91
Round  98, Global train loss: 0.368, Global test loss: 3.879, Global test accuracy: 13.46
Round  99, Train loss: 0.370, Test loss: 2.383, Test accuracy: 51.91
Round  99, Global train loss: 0.370, Global test loss: 3.882, Global test accuracy: 13.57
Final Round, Train loss: 0.263, Test loss: 2.603, Test accuracy: 53.05
Final Round, Global train loss: 0.263, Global test loss: 3.882, Global test accuracy: 13.57
Average accuracy final 10 rounds: 52.598000000000006
Average global accuracy final 10 rounds: 13.657
4911.724122285843
[2.7700626850128174, 5.134903430938721, 7.193651437759399, 9.308409452438354, 11.37163257598877, 13.436992645263672, 15.501300573348999, 17.557841300964355, 19.613181114196777, 21.693301916122437, 23.761255741119385, 25.837347745895386, 27.89906120300293, 29.960311889648438, 32.0293972492218, 34.092445611953735, 36.14914131164551, 38.20523190498352, 40.25990557670593, 42.31737494468689, 44.37108898162842, 50.02849316596985, 55.69452667236328, 61.35309553146362, 67.01846432685852, 72.66084694862366, 78.32137560844421, 83.9856858253479, 89.62477779388428, 95.27738761901855, 100.9478690624237, 106.79373216629028, 112.43523120880127, 118.08984589576721, 124.1764919757843, 130.26878380775452, 136.3269703388214, 142.39406561851501, 148.44786643981934, 154.52181434631348, 160.55947828292847, 166.64474725723267, 172.6953752040863, 178.39970469474792, 184.17290139198303, 189.96122789382935, 195.72472977638245, 201.49500560760498, 207.28403878211975, 213.0169494152069, 218.78392434120178, 224.57068824768066, 230.38038969039917, 236.40602731704712, 242.48159313201904, 248.55903506278992, 254.61843752861023, 260.6739206314087, 266.7500123977661, 272.802285194397, 278.83826541900635, 284.9357109069824, 290.9550178050995, 297.10816526412964, 303.14297318458557, 309.1555471420288, 315.2163829803467, 321.26699590682983, 327.3346173763275, 333.402987241745, 339.43736386299133, 345.4917562007904, 351.53843355178833, 357.58317041397095, 363.65923857688904, 369.72361636161804, 375.80633902549744, 381.8713436126709, 387.9138767719269, 394.30604887008667, 400.72296500205994, 406.7494022846222, 412.80994725227356, 418.86108922958374, 424.950008392334, 431.0009295940399, 436.77020049095154, 442.55078172683716, 448.3160343170166, 454.0506982803345, 459.82978439331055, 465.5928497314453, 471.36486172676086, 477.13586497306824, 482.90751004219055, 488.6884009838104, 494.4760344028473, 500.2663252353668, 506.0578062534332, 512.1163637638092, 516.2618024349213]
[43.27, 47.88, 50.96, 54.12, 54.5, 55.88, 53.25, 56.92, 56.46, 55.63, 55.89, 56.48, 56.42, 56.22, 55.23, 55.14, 54.7, 54.71, 54.9, 54.82, 54.29, 53.53, 53.13, 53.82, 53.36, 53.16, 52.87, 52.83, 52.67, 52.99, 53.18, 53.29, 53.35, 53.79, 53.35, 52.76, 52.79, 52.97, 52.11, 52.38, 52.23, 52.58, 53.08, 52.73, 52.77, 53.3, 52.54, 52.33, 52.71, 52.94, 52.56, 52.15, 52.44, 52.6, 53.25, 52.88, 53.04, 52.82, 53.01, 53.19, 53.38, 52.94, 52.49, 52.47, 52.72, 52.87, 52.72, 52.56, 52.4, 52.05, 51.79, 51.82, 51.92, 52.28, 52.32, 52.35, 52.11, 52.4, 52.7, 52.34, 52.22, 52.38, 52.49, 52.61, 52.27, 51.95, 52.7, 52.43, 52.48, 52.52, 52.47, 52.84, 52.89, 52.37, 52.95, 51.81, 52.94, 52.89, 52.91, 51.91, 53.05]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.812, Test loss: 1.897, Test accuracy: 20.20
Round   1, Train loss: 1.572, Test loss: 1.558, Test accuracy: 29.90
Round   2, Train loss: 1.502, Test loss: 1.435, Test accuracy: 38.41
Round   3, Train loss: 1.450, Test loss: 1.364, Test accuracy: 41.36
Round   4, Train loss: 1.409, Test loss: 1.284, Test accuracy: 46.86
Round   5, Train loss: 1.374, Test loss: 1.277, Test accuracy: 47.73
Round   6, Train loss: 1.343, Test loss: 1.186, Test accuracy: 52.72
Round   7, Train loss: 1.318, Test loss: 1.166, Test accuracy: 55.25
Round   8, Train loss: 1.294, Test loss: 1.130, Test accuracy: 57.31
Round   9, Train loss: 1.270, Test loss: 1.107, Test accuracy: 57.92
Round  10, Train loss: 1.252, Test loss: 1.081, Test accuracy: 59.06
Round  11, Train loss: 1.234, Test loss: 1.079, Test accuracy: 58.72
Round  12, Train loss: 1.215, Test loss: 1.051, Test accuracy: 61.05
Round  13, Train loss: 1.197, Test loss: 1.049, Test accuracy: 61.46
Round  14, Train loss: 1.179, Test loss: 1.041, Test accuracy: 61.09
Round  15, Train loss: 1.163, Test loss: 1.013, Test accuracy: 62.68
Round  16, Train loss: 1.146, Test loss: 1.004, Test accuracy: 63.21
Round  17, Train loss: 1.128, Test loss: 1.009, Test accuracy: 63.08
Round  18, Train loss: 1.111, Test loss: 0.989, Test accuracy: 63.91
Round  19, Train loss: 1.096, Test loss: 0.986, Test accuracy: 64.48
Round  20, Train loss: 1.122, Test loss: 0.983, Test accuracy: 64.55
Round  21, Train loss: 1.047, Test loss: 0.982, Test accuracy: 64.48
Round  22, Train loss: 1.110, Test loss: 0.980, Test accuracy: 64.10
Round  23, Train loss: 0.972, Test loss: 0.983, Test accuracy: 64.27
Round  24, Train loss: 1.019, Test loss: 0.981, Test accuracy: 64.73
Round  25, Train loss: 0.997, Test loss: 0.974, Test accuracy: 64.68
Round  26, Train loss: 1.056, Test loss: 0.982, Test accuracy: 63.94
Round  27, Train loss: 0.922, Test loss: 0.987, Test accuracy: 63.81
Round  28, Train loss: 1.008, Test loss: 0.993, Test accuracy: 62.94
Round  29, Train loss: 0.996, Test loss: 1.001, Test accuracy: 62.78
Round  30, Train loss: 0.858, Test loss: 1.019, Test accuracy: 62.50
Round  31, Train loss: 0.901, Test loss: 1.004, Test accuracy: 63.04
Round  32, Train loss: 0.938, Test loss: 1.019, Test accuracy: 62.88
Round  33, Train loss: 0.970, Test loss: 1.014, Test accuracy: 62.75
Round  34, Train loss: 0.974, Test loss: 1.034, Test accuracy: 62.73
Round  35, Train loss: 0.978, Test loss: 1.037, Test accuracy: 62.52
Round  36, Train loss: 0.976, Test loss: 1.056, Test accuracy: 62.08
Round  37, Train loss: 0.732, Test loss: 1.018, Test accuracy: 62.95
Round  38, Train loss: 0.931, Test loss: 1.034, Test accuracy: 62.86
Round  39, Train loss: 0.846, Test loss: 1.045, Test accuracy: 62.50
Round  40, Train loss: 0.773, Test loss: 1.039, Test accuracy: 62.68
Round  41, Train loss: 0.738, Test loss: 1.070, Test accuracy: 61.85
Round  42, Train loss: 0.750, Test loss: 1.067, Test accuracy: 62.17
Round  43, Train loss: 0.795, Test loss: 1.074, Test accuracy: 61.88
Round  44, Train loss: 0.824, Test loss: 1.081, Test accuracy: 61.40
Round  45, Train loss: 0.819, Test loss: 1.116, Test accuracy: 60.42
Round  46, Train loss: 0.859, Test loss: 1.133, Test accuracy: 60.49
Round  47, Train loss: 0.690, Test loss: 1.111, Test accuracy: 60.95
Round  48, Train loss: 0.803, Test loss: 1.120, Test accuracy: 61.03
Round  49, Train loss: 0.734, Test loss: 1.138, Test accuracy: 61.22
Round  50, Train loss: 0.751, Test loss: 1.156, Test accuracy: 60.77
Round  51, Train loss: 0.715, Test loss: 1.175, Test accuracy: 60.78
Round  52, Train loss: 0.692, Test loss: 1.137, Test accuracy: 60.64
Round  53, Train loss: 0.771, Test loss: 1.167, Test accuracy: 60.05
Round  54, Train loss: 0.611, Test loss: 1.166, Test accuracy: 61.04
Round  55, Train loss: 0.566, Test loss: 1.186, Test accuracy: 60.87
Round  56, Train loss: 0.699, Test loss: 1.187, Test accuracy: 59.98
Round  57, Train loss: 0.651, Test loss: 1.201, Test accuracy: 60.21
Round  58, Train loss: 0.580, Test loss: 1.188, Test accuracy: 59.97
Round  59, Train loss: 0.647, Test loss: 1.218, Test accuracy: 59.88
Round  60, Train loss: 0.662, Test loss: 1.230, Test accuracy: 59.86
Round  61, Train loss: 0.647, Test loss: 1.251, Test accuracy: 59.32
Round  62, Train loss: 0.734, Test loss: 1.273, Test accuracy: 59.60
Round  63, Train loss: 0.641, Test loss: 1.253, Test accuracy: 60.09
Round  64, Train loss: 0.633, Test loss: 1.279, Test accuracy: 59.50
Round  65, Train loss: 0.501, Test loss: 1.226, Test accuracy: 60.45
Round  66, Train loss: 0.662, Test loss: 1.281, Test accuracy: 59.65
Round  67, Train loss: 0.579, Test loss: 1.284, Test accuracy: 59.90
Round  68, Train loss: 0.658, Test loss: 1.263, Test accuracy: 59.41
Round  69, Train loss: 0.633, Test loss: 1.293, Test accuracy: 59.47
Round  70, Train loss: 0.482, Test loss: 1.299, Test accuracy: 59.46
Round  71, Train loss: 0.566, Test loss: 1.345, Test accuracy: 59.80
Round  72, Train loss: 0.601, Test loss: 1.338, Test accuracy: 59.23
Round  73, Train loss: 0.495, Test loss: 1.323, Test accuracy: 59.76
Round  74, Train loss: 0.523, Test loss: 1.338, Test accuracy: 58.74
Round  75, Train loss: 0.475, Test loss: 1.371, Test accuracy: 58.95
Round  76, Train loss: 0.534, Test loss: 1.332, Test accuracy: 59.29
Round  77, Train loss: 0.555, Test loss: 1.351, Test accuracy: 59.50
Round  78, Train loss: 0.523, Test loss: 1.341, Test accuracy: 59.18
Round  79, Train loss: 0.512, Test loss: 1.385, Test accuracy: 58.46
Round  80, Train loss: 0.371, Test loss: 1.353, Test accuracy: 59.71
Round  81, Train loss: 0.348, Test loss: 1.395, Test accuracy: 58.50
Round  82, Train loss: 0.326, Test loss: 1.416, Test accuracy: 58.71
Round  83, Train loss: 0.319, Test loss: 1.397, Test accuracy: 58.94
Round  84, Train loss: 0.309, Test loss: 1.409, Test accuracy: 59.39
Round  85, Train loss: 0.295, Test loss: 1.398, Test accuracy: 59.87
Round  86, Train loss: 0.290, Test loss: 1.432, Test accuracy: 59.07
Round  87, Train loss: 0.272, Test loss: 1.474, Test accuracy: 58.36
Round  88, Train loss: 0.287, Test loss: 1.469, Test accuracy: 58.84
Round  89, Train loss: 0.270, Test loss: 1.460, Test accuracy: 58.59
Round  90, Train loss: 0.529, Test loss: 1.451, Test accuracy: 58.30
Round  91, Train loss: 0.496, Test loss: 1.435, Test accuracy: 58.64
Round  92, Train loss: 0.487, Test loss: 1.427, Test accuracy: 59.56
Round  93, Train loss: 0.482, Test loss: 1.445, Test accuracy: 59.09
Round  94, Train loss: 0.467, Test loss: 1.461, Test accuracy: 58.52
Round  95, Train loss: 0.458, Test loss: 1.489, Test accuracy: 58.20
Round  96, Train loss: 0.456, Test loss: 1.497, Test accuracy: 58.45
Round  97, Train loss: 0.457, Test loss: 1.497, Test accuracy: 58.22
Round  98, Train loss: 0.448, Test loss: 1.518, Test accuracy: 58.33
Round  99, Train loss: 0.441, Test loss: 1.529, Test accuracy: 58.40
Final Round, Train loss: 0.422, Test loss: 1.519, Test accuracy: 58.27
Average accuracy final 10 rounds: 58.571
3844.9166667461395
[2.4174585342407227, 4.537984371185303, 6.642065763473511, 8.740062475204468, 10.849573850631714, 12.944637537002563, 15.046158075332642, 17.144876956939697, 19.24785017967224, 21.353897094726562, 23.458531141281128, 25.56796431541443, 27.667335748672485, 29.76944375038147, 31.877142906188965, 33.99172568321228, 36.10257577896118, 38.21403622627258, 40.318660736083984, 42.42726182937622, 44.52940773963928, 48.9893696308136, 53.51890325546265, 58.082536458969116, 62.56810283660889, 66.79948663711548, 71.01160788536072, 74.88400769233704, 78.7631185054779, 82.63644909858704, 86.49302840232849, 90.34024572372437, 94.18446612358093, 98.02683711051941, 101.87210154533386, 105.71698641777039, 109.56705975532532, 113.60749244689941, 117.81160235404968, 121.86125040054321, 125.9529538154602, 129.99659514427185, 134.05588722229004, 138.12238359451294, 142.333646774292, 146.54733085632324, 150.8492877483368, 155.0514271259308, 159.13432455062866, 163.17658829689026, 167.21576070785522, 171.27661991119385, 175.3228600025177, 179.3962128162384, 183.44916224479675, 187.52507305145264, 191.58626222610474, 195.63466906547546, 199.68204474449158, 203.737446308136, 207.72771096229553, 211.71970295906067, 215.71351552009583, 219.72294187545776, 223.772155046463, 227.81018447875977, 231.93339252471924, 236.04974102973938, 240.08526229858398, 244.12663173675537, 248.16827273368835, 252.44786882400513, 256.71635460853577, 261.03919315338135, 265.39223647117615, 269.6628267765045, 273.9325261116028, 278.29185795783997, 282.3882327079773, 286.64662075042725, 290.9956817626953, 295.3663492202759, 299.69365549087524, 304.07250690460205, 308.4046709537506, 312.7608709335327, 316.92873764038086, 321.0905935764313, 325.2628207206726, 329.4045114517212, 333.5578029155731, 337.7124574184418, 341.8754563331604, 346.0322325229645, 350.19726824760437, 354.5169517993927, 358.8509101867676, 363.180157661438, 367.5165812969208, 371.8284902572632, 375.6450469493866]
[20.2, 29.9, 38.41, 41.36, 46.86, 47.73, 52.72, 55.25, 57.31, 57.92, 59.06, 58.72, 61.05, 61.46, 61.09, 62.68, 63.21, 63.08, 63.91, 64.48, 64.55, 64.48, 64.1, 64.27, 64.73, 64.68, 63.94, 63.81, 62.94, 62.78, 62.5, 63.04, 62.88, 62.75, 62.73, 62.52, 62.08, 62.95, 62.86, 62.5, 62.68, 61.85, 62.17, 61.88, 61.4, 60.42, 60.49, 60.95, 61.03, 61.22, 60.77, 60.78, 60.64, 60.05, 61.04, 60.87, 59.98, 60.21, 59.97, 59.88, 59.86, 59.32, 59.6, 60.09, 59.5, 60.45, 59.65, 59.9, 59.41, 59.47, 59.46, 59.8, 59.23, 59.76, 58.74, 58.95, 59.29, 59.5, 59.18, 58.46, 59.71, 58.5, 58.71, 58.94, 59.39, 59.87, 59.07, 58.36, 58.84, 58.59, 58.3, 58.64, 59.56, 59.09, 58.52, 58.2, 58.45, 58.22, 58.33, 58.4, 58.27]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.809, Test loss: 1.846, Test accuracy: 22.39
Round   1, Train loss: 1.568, Test loss: 1.608, Test accuracy: 28.44
Round   2, Train loss: 1.488, Test loss: 1.471, Test accuracy: 35.89
Round   3, Train loss: 1.430, Test loss: 1.362, Test accuracy: 42.92
Round   4, Train loss: 1.384, Test loss: 1.287, Test accuracy: 48.67
Round   5, Train loss: 1.353, Test loss: 1.221, Test accuracy: 53.37
Round   6, Train loss: 1.324, Test loss: 1.187, Test accuracy: 54.41
Round   7, Train loss: 1.300, Test loss: 1.143, Test accuracy: 56.86
Round   8, Train loss: 1.277, Test loss: 1.126, Test accuracy: 58.53
Round   9, Train loss: 1.259, Test loss: 1.090, Test accuracy: 59.80
Round  10, Train loss: 1.271, Test loss: 1.093, Test accuracy: 59.24
Round  11, Train loss: 1.380, Test loss: 1.095, Test accuracy: 59.00
Round  12, Train loss: 1.217, Test loss: 1.101, Test accuracy: 58.77
Round  13, Train loss: 1.359, Test loss: 1.086, Test accuracy: 59.65
Round  14, Train loss: 1.157, Test loss: 1.065, Test accuracy: 60.67
Round  15, Train loss: 1.095, Test loss: 1.051, Test accuracy: 60.31
Round  16, Train loss: 0.995, Test loss: 1.023, Test accuracy: 62.32
Round  17, Train loss: 1.108, Test loss: 1.019, Test accuracy: 61.95
Round  18, Train loss: 1.002, Test loss: 1.005, Test accuracy: 62.09
Round  19, Train loss: 1.144, Test loss: 1.020, Test accuracy: 62.73
Round  20, Train loss: 1.039, Test loss: 1.012, Test accuracy: 62.73
Round  21, Train loss: 1.186, Test loss: 1.003, Test accuracy: 62.69
Round  22, Train loss: 1.094, Test loss: 1.001, Test accuracy: 63.47
Round  23, Train loss: 1.085, Test loss: 1.021, Test accuracy: 62.30
Round  24, Train loss: 1.079, Test loss: 0.995, Test accuracy: 63.22
Round  25, Train loss: 1.090, Test loss: 0.964, Test accuracy: 64.34
Round  26, Train loss: 1.078, Test loss: 0.978, Test accuracy: 64.14
Round  27, Train loss: 1.050, Test loss: 0.974, Test accuracy: 64.48
Round  28, Train loss: 0.996, Test loss: 0.968, Test accuracy: 64.42
Round  29, Train loss: 0.997, Test loss: 0.979, Test accuracy: 63.76
Round  30, Train loss: 1.033, Test loss: 1.005, Test accuracy: 62.98
Round  31, Train loss: 0.989, Test loss: 0.989, Test accuracy: 63.56
Round  32, Train loss: 0.921, Test loss: 0.982, Test accuracy: 63.64
Round  33, Train loss: 0.858, Test loss: 0.974, Test accuracy: 63.95
Round  34, Train loss: 0.910, Test loss: 1.004, Test accuracy: 62.95
Round  35, Train loss: 0.827, Test loss: 0.970, Test accuracy: 64.09
Round  36, Train loss: 0.820, Test loss: 0.961, Test accuracy: 64.58
Round  37, Train loss: 1.000, Test loss: 0.985, Test accuracy: 63.47
Round  38, Train loss: 0.812, Test loss: 0.954, Test accuracy: 64.39
Round  39, Train loss: 0.859, Test loss: 0.971, Test accuracy: 64.36
Round  40, Train loss: 0.773, Test loss: 0.962, Test accuracy: 64.43
Round  41, Train loss: 0.950, Test loss: 0.998, Test accuracy: 63.26
Round  42, Train loss: 0.846, Test loss: 1.001, Test accuracy: 62.76
Round  43, Train loss: 0.860, Test loss: 0.985, Test accuracy: 63.45
Round  44, Train loss: 0.852, Test loss: 0.985, Test accuracy: 63.21
Round  45, Train loss: 0.803, Test loss: 1.003, Test accuracy: 63.25
Round  46, Train loss: 0.747, Test loss: 0.968, Test accuracy: 64.26
Round  47, Train loss: 0.829, Test loss: 0.990, Test accuracy: 63.75
Round  48, Train loss: 0.801, Test loss: 0.999, Test accuracy: 62.73
Round  49, Train loss: 0.753, Test loss: 1.021, Test accuracy: 62.56
Round  50, Train loss: 0.663, Test loss: 0.990, Test accuracy: 63.36
Round  51, Train loss: 0.780, Test loss: 1.045, Test accuracy: 61.20
Round  52, Train loss: 0.784, Test loss: 1.030, Test accuracy: 61.82
Round  53, Train loss: 0.691, Test loss: 1.018, Test accuracy: 62.90
Round  54, Train loss: 0.910, Test loss: 1.054, Test accuracy: 61.83
Round  55, Train loss: 0.718, Test loss: 1.075, Test accuracy: 60.61
Round  56, Train loss: 0.776, Test loss: 1.065, Test accuracy: 61.95
Round  57, Train loss: 0.638, Test loss: 1.039, Test accuracy: 62.45
Round  58, Train loss: 0.832, Test loss: 1.067, Test accuracy: 61.73
Round  59, Train loss: 0.656, Test loss: 1.062, Test accuracy: 61.77
Round  60, Train loss: 0.593, Test loss: 1.032, Test accuracy: 62.95
Round  61, Train loss: 0.574, Test loss: 1.047, Test accuracy: 62.96
Round  62, Train loss: 0.625, Test loss: 1.051, Test accuracy: 62.51
Round  63, Train loss: 0.676, Test loss: 1.052, Test accuracy: 62.78
Round  64, Train loss: 0.618, Test loss: 1.072, Test accuracy: 61.89
Round  65, Train loss: 0.724, Test loss: 1.086, Test accuracy: 61.67
Round  66, Train loss: 0.720, Test loss: 1.117, Test accuracy: 60.16
Round  67, Train loss: 0.691, Test loss: 1.102, Test accuracy: 60.94
Round  68, Train loss: 0.542, Test loss: 1.082, Test accuracy: 61.30
Round  69, Train loss: 0.642, Test loss: 1.089, Test accuracy: 61.84
Round  70, Train loss: 0.612, Test loss: 1.114, Test accuracy: 60.71
Round  71, Train loss: 0.687, Test loss: 1.152, Test accuracy: 59.84
Round  72, Train loss: 0.637, Test loss: 1.129, Test accuracy: 60.35
Round  73, Train loss: 0.643, Test loss: 1.106, Test accuracy: 61.17
Round  74, Train loss: 0.644, Test loss: 1.136, Test accuracy: 60.78
Round  75, Train loss: 0.585, Test loss: 1.148, Test accuracy: 60.05
Round  76, Train loss: 0.703, Test loss: 1.170, Test accuracy: 59.74
Round  77, Train loss: 0.522, Test loss: 1.137, Test accuracy: 60.60
Round  78, Train loss: 0.619, Test loss: 1.128, Test accuracy: 60.75
Round  79, Train loss: 0.520, Test loss: 1.138, Test accuracy: 61.28
Round  80, Train loss: 0.438, Test loss: 1.099, Test accuracy: 62.57
Round  81, Train loss: 0.402, Test loss: 1.099, Test accuracy: 62.63
Round  82, Train loss: 0.380, Test loss: 1.116, Test accuracy: 62.70
Round  83, Train loss: 0.367, Test loss: 1.112, Test accuracy: 62.81
Round  84, Train loss: 0.350, Test loss: 1.115, Test accuracy: 62.78
Round  85, Train loss: 0.346, Test loss: 1.114, Test accuracy: 62.73
Round  86, Train loss: 0.334, Test loss: 1.133, Test accuracy: 62.75
Round  87, Train loss: 0.321, Test loss: 1.123, Test accuracy: 62.90
Round  88, Train loss: 0.316, Test loss: 1.133, Test accuracy: 62.39
Round  89, Train loss: 0.306, Test loss: 1.111, Test accuracy: 63.01
Round  90, Train loss: 0.538, Test loss: 1.136, Test accuracy: 61.57
Round  91, Train loss: 0.512, Test loss: 1.179, Test accuracy: 61.00
Round  92, Train loss: 0.504, Test loss: 1.157, Test accuracy: 60.87
Round  93, Train loss: 0.494, Test loss: 1.167, Test accuracy: 60.88
Round  94, Train loss: 0.488, Test loss: 1.173, Test accuracy: 60.79
Round  95, Train loss: 0.479, Test loss: 1.164, Test accuracy: 61.09
Round  96, Train loss: 0.477, Test loss: 1.204, Test accuracy: 60.51
Round  97, Train loss: 0.471, Test loss: 1.188, Test accuracy: 60.42
Round  98, Train loss: 0.472, Test loss: 1.197, Test accuracy: 60.99
Round  99, Train loss: 0.470, Test loss: 1.201, Test accuracy: 60.27
Final Round, Train loss: 0.473, Test loss: 1.215, Test accuracy: 60.19
Average accuracy final 10 rounds: 60.83900000000001
4187.109571456909
[3.160663604736328, 6.016604423522949, 8.87121033668518, 11.714141845703125, 14.56916880607605, 17.430767059326172, 20.29548740386963, 23.16307306289673, 26.033698558807373, 28.901397705078125, 31.764551401138306, 34.61420011520386, 37.4710910320282, 40.332029819488525, 43.2029664516449, 46.06714391708374, 48.947444677352905, 51.805447578430176, 54.664756059646606, 57.53454852104187, 60.40488624572754, 65.63489007949829, 70.96845722198486, 76.26377439498901, 81.52114963531494, 86.88868117332458, 92.18532109260559, 97.42644834518433, 102.76573276519775, 108.11491990089417, 113.3749771118164, 118.6882095336914, 124.04283952713013, 129.41170716285706, 134.66593074798584, 139.97928929328918, 145.35905861854553, 150.58987951278687, 155.9681077003479, 161.0530333518982, 166.09102082252502, 171.00873613357544, 176.03445553779602, 181.21319794654846, 186.3768274784088, 191.54983401298523, 196.71859741210938, 201.82676362991333, 206.92617011070251, 211.73933577537537, 216.68150639533997, 221.71733784675598, 226.75724911689758, 231.8468370437622, 236.95155668258667, 241.62297749519348, 246.3019199371338, 250.93747353553772, 255.54629373550415, 260.18148159980774, 264.82622241973877, 269.43962502479553, 274.06322860717773, 278.68834710121155, 283.3708403110504, 287.9968931674957, 292.63138699531555, 297.2483696937561, 301.9260106086731, 306.61139464378357, 311.27944231033325, 315.9619903564453, 320.63566422462463, 325.30146193504333, 329.93050932884216, 334.5637221336365, 339.1952910423279, 343.8454933166504, 348.4891142845154, 353.1216628551483, 357.93283009529114, 362.7816345691681, 367.61821937561035, 372.4928319454193, 377.34878396987915, 382.0518660545349, 386.7404863834381, 391.3600175380707, 396.0480899810791, 400.7312021255493, 405.41956210136414, 410.0983462333679, 414.8040964603424, 419.48917269706726, 424.15316247940063, 428.82273507118225, 433.48370695114136, 438.15593791007996, 442.86441230773926, 447.58574986457825, 451.57258582115173]
[22.39, 28.44, 35.89, 42.92, 48.67, 53.37, 54.41, 56.86, 58.53, 59.8, 59.24, 59.0, 58.77, 59.65, 60.67, 60.31, 62.32, 61.95, 62.09, 62.73, 62.73, 62.69, 63.47, 62.3, 63.22, 64.34, 64.14, 64.48, 64.42, 63.76, 62.98, 63.56, 63.64, 63.95, 62.95, 64.09, 64.58, 63.47, 64.39, 64.36, 64.43, 63.26, 62.76, 63.45, 63.21, 63.25, 64.26, 63.75, 62.73, 62.56, 63.36, 61.2, 61.82, 62.9, 61.83, 60.61, 61.95, 62.45, 61.73, 61.77, 62.95, 62.96, 62.51, 62.78, 61.89, 61.67, 60.16, 60.94, 61.3, 61.84, 60.71, 59.84, 60.35, 61.17, 60.78, 60.05, 59.74, 60.6, 60.75, 61.28, 62.57, 62.63, 62.7, 62.81, 62.78, 62.73, 62.75, 62.9, 62.39, 63.01, 61.57, 61.0, 60.87, 60.88, 60.79, 61.09, 60.51, 60.42, 60.99, 60.27, 60.19]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.741, Test loss: 2.094, Test accuracy: 19.62
Round   0, Global train loss: 1.741, Global test loss: 2.313, Global test accuracy: 14.27
Round   1, Train loss: 1.600, Test loss: 1.980, Test accuracy: 22.16
Round   1, Global train loss: 1.600, Global test loss: 2.351, Global test accuracy: 12.18
Round   2, Train loss: 1.528, Test loss: 1.838, Test accuracy: 25.74
Round   2, Global train loss: 1.528, Global test loss: 2.377, Global test accuracy: 8.53
Round   3, Train loss: 1.616, Test loss: 1.644, Test accuracy: 33.94
Round   3, Global train loss: 1.616, Global test loss: 2.351, Global test accuracy: 11.08
Round   4, Train loss: 1.613, Test loss: 1.491, Test accuracy: 39.33
Round   4, Global train loss: 1.613, Global test loss: 2.346, Global test accuracy: 14.16
Round   5, Train loss: 1.502, Test loss: 1.487, Test accuracy: 39.78
Round   5, Global train loss: 1.502, Global test loss: 2.416, Global test accuracy: 10.62
Round   6, Train loss: 1.480, Test loss: 1.424, Test accuracy: 42.43
Round   6, Global train loss: 1.480, Global test loss: 2.334, Global test accuracy: 10.54
Round   7, Train loss: 1.502, Test loss: 1.404, Test accuracy: 43.01
Round   7, Global train loss: 1.502, Global test loss: 2.371, Global test accuracy: 10.03
Round   8, Train loss: 1.440, Test loss: 1.350, Test accuracy: 45.20
Round   8, Global train loss: 1.440, Global test loss: 2.317, Global test accuracy: 12.38
Round   9, Train loss: 1.459, Test loss: 1.336, Test accuracy: 45.73
Round   9, Global train loss: 1.459, Global test loss: 2.335, Global test accuracy: 11.35
Round  10, Train loss: 1.379, Test loss: 1.326, Test accuracy: 47.14
Round  10, Global train loss: 1.379, Global test loss: 2.323, Global test accuracy: 13.67
Round  11, Train loss: 1.361, Test loss: 1.315, Test accuracy: 48.13
Round  11, Global train loss: 1.361, Global test loss: 2.330, Global test accuracy: 12.29
Round  12, Train loss: 1.399, Test loss: 1.305, Test accuracy: 48.90
Round  12, Global train loss: 1.399, Global test loss: 2.431, Global test accuracy: 10.77
Round  13, Train loss: 1.263, Test loss: 1.302, Test accuracy: 49.44
Round  13, Global train loss: 1.263, Global test loss: 2.316, Global test accuracy: 13.70
Round  14, Train loss: 1.444, Test loss: 1.296, Test accuracy: 49.51
Round  14, Global train loss: 1.444, Global test loss: 2.325, Global test accuracy: 11.73
Round  15, Train loss: 1.332, Test loss: 1.278, Test accuracy: 50.64
Round  15, Global train loss: 1.332, Global test loss: 2.383, Global test accuracy: 13.58
Round  16, Train loss: 1.308, Test loss: 1.274, Test accuracy: 51.30
Round  16, Global train loss: 1.308, Global test loss: 2.319, Global test accuracy: 11.61
Round  17, Train loss: 1.353, Test loss: 1.278, Test accuracy: 50.72
Round  17, Global train loss: 1.353, Global test loss: 2.368, Global test accuracy: 12.43
Round  18, Train loss: 1.403, Test loss: 1.271, Test accuracy: 50.61
Round  18, Global train loss: 1.403, Global test loss: 2.343, Global test accuracy: 14.99
Round  19, Train loss: 1.219, Test loss: 1.287, Test accuracy: 50.62
Round  19, Global train loss: 1.219, Global test loss: 2.323, Global test accuracy: 13.31
Round  20, Train loss: 1.276, Test loss: 1.285, Test accuracy: 51.60
Round  20, Global train loss: 1.276, Global test loss: 2.305, Global test accuracy: 14.27
Round  21, Train loss: 1.229, Test loss: 1.287, Test accuracy: 51.55
Round  21, Global train loss: 1.229, Global test loss: 2.455, Global test accuracy: 14.94
Round  22, Train loss: 1.063, Test loss: 1.274, Test accuracy: 51.88
Round  22, Global train loss: 1.063, Global test loss: 2.362, Global test accuracy: 15.24
Round  23, Train loss: 1.417, Test loss: 1.278, Test accuracy: 51.62
Round  23, Global train loss: 1.417, Global test loss: 2.363, Global test accuracy: 13.53
Round  24, Train loss: 1.212, Test loss: 1.275, Test accuracy: 51.99
Round  24, Global train loss: 1.212, Global test loss: 2.361, Global test accuracy: 13.96
Round  25, Train loss: 0.966, Test loss: 1.292, Test accuracy: 52.03
Round  25, Global train loss: 0.966, Global test loss: 2.318, Global test accuracy: 14.08
Round  26, Train loss: 1.199, Test loss: 1.309, Test accuracy: 51.55
Round  26, Global train loss: 1.199, Global test loss: 2.322, Global test accuracy: 11.49
Round  27, Train loss: 0.915, Test loss: 1.297, Test accuracy: 51.52
Round  27, Global train loss: 0.915, Global test loss: 2.311, Global test accuracy: 14.50
Round  28, Train loss: 1.167, Test loss: 1.310, Test accuracy: 51.48
Round  28, Global train loss: 1.167, Global test loss: 2.363, Global test accuracy: 11.25
Round  29, Train loss: 0.961, Test loss: 1.321, Test accuracy: 51.45
Round  29, Global train loss: 0.961, Global test loss: 2.396, Global test accuracy: 15.14
Round  30, Train loss: 1.180, Test loss: 1.320, Test accuracy: 51.95
Round  30, Global train loss: 1.180, Global test loss: 2.396, Global test accuracy: 11.15
Round  31, Train loss: 0.935, Test loss: 1.324, Test accuracy: 51.68
Round  31, Global train loss: 0.935, Global test loss: 2.370, Global test accuracy: 12.64
Round  32, Train loss: 1.182, Test loss: 1.341, Test accuracy: 51.80
Round  32, Global train loss: 1.182, Global test loss: 2.330, Global test accuracy: 13.47
Round  33, Train loss: 0.904, Test loss: 1.381, Test accuracy: 51.31
Round  33, Global train loss: 0.904, Global test loss: 2.321, Global test accuracy: 12.18
Round  34, Train loss: 1.036, Test loss: 1.396, Test accuracy: 50.99
Round  34, Global train loss: 1.036, Global test loss: 2.311, Global test accuracy: 11.07
Round  35, Train loss: 0.984, Test loss: 1.416, Test accuracy: 51.16
Round  35, Global train loss: 0.984, Global test loss: 2.322, Global test accuracy: 13.86
Round  36, Train loss: 1.060, Test loss: 1.434, Test accuracy: 51.45
Round  36, Global train loss: 1.060, Global test loss: 2.371, Global test accuracy: 14.34
Round  37, Train loss: 0.899, Test loss: 1.437, Test accuracy: 51.52
Round  37, Global train loss: 0.899, Global test loss: 2.370, Global test accuracy: 14.02
Round  38, Train loss: 0.955, Test loss: 1.446, Test accuracy: 51.20
Round  38, Global train loss: 0.955, Global test loss: 2.331, Global test accuracy: 12.28
Round  39, Train loss: 0.869, Test loss: 1.461, Test accuracy: 51.02
Round  39, Global train loss: 0.869, Global test loss: 2.362, Global test accuracy: 11.51
Round  40, Train loss: 1.063, Test loss: 1.472, Test accuracy: 51.15
Round  40, Global train loss: 1.063, Global test loss: 2.330, Global test accuracy: 11.57
Round  41, Train loss: 0.846, Test loss: 1.493, Test accuracy: 50.71
Round  41, Global train loss: 0.846, Global test loss: 2.339, Global test accuracy: 12.18
Round  42, Train loss: 1.010, Test loss: 1.500, Test accuracy: 50.55
Round  42, Global train loss: 1.010, Global test loss: 2.325, Global test accuracy: 14.47
Round  43, Train loss: 0.774, Test loss: 1.544, Test accuracy: 50.20
Round  43, Global train loss: 0.774, Global test loss: 2.337, Global test accuracy: 12.30
Round  44, Train loss: 0.771, Test loss: 1.518, Test accuracy: 50.23
Round  44, Global train loss: 0.771, Global test loss: 2.345, Global test accuracy: 10.33
Round  45, Train loss: 0.831, Test loss: 1.547, Test accuracy: 50.16
Round  45, Global train loss: 0.831, Global test loss: 2.302, Global test accuracy: 13.94
Round  46, Train loss: 0.867, Test loss: 1.570, Test accuracy: 49.44
Round  46, Global train loss: 0.867, Global test loss: 2.389, Global test accuracy: 10.77
Round  47, Train loss: 0.716, Test loss: 1.590, Test accuracy: 49.45
Round  47, Global train loss: 0.716, Global test loss: 2.332, Global test accuracy: 12.81
Round  48, Train loss: 0.764, Test loss: 1.622, Test accuracy: 49.03
Round  48, Global train loss: 0.764, Global test loss: 2.326, Global test accuracy: 13.71
Round  49, Train loss: 0.708, Test loss: 1.660, Test accuracy: 48.97
Round  49, Global train loss: 0.708, Global test loss: 2.367, Global test accuracy: 12.18
Round  50, Train loss: 0.715, Test loss: 1.709, Test accuracy: 49.13
Round  50, Global train loss: 0.715, Global test loss: 2.319, Global test accuracy: 13.93
Round  51, Train loss: 0.915, Test loss: 1.715, Test accuracy: 49.27
Round  51, Global train loss: 0.915, Global test loss: 2.387, Global test accuracy: 13.02
Round  52, Train loss: 0.426, Test loss: 1.755, Test accuracy: 49.34
Round  52, Global train loss: 0.426, Global test loss: 2.335, Global test accuracy: 14.40
Round  53, Train loss: 0.479, Test loss: 1.754, Test accuracy: 49.54
Round  53, Global train loss: 0.479, Global test loss: 2.351, Global test accuracy: 11.49
Round  54, Train loss: 0.584, Test loss: 1.790, Test accuracy: 49.79
Round  54, Global train loss: 0.584, Global test loss: 2.308, Global test accuracy: 13.85
Round  55, Train loss: 0.715, Test loss: 1.837, Test accuracy: 49.75
Round  55, Global train loss: 0.715, Global test loss: 2.335, Global test accuracy: 13.95
Round  56, Train loss: 0.850, Test loss: 1.859, Test accuracy: 49.67
Round  56, Global train loss: 0.850, Global test loss: 2.328, Global test accuracy: 13.24
Round  57, Train loss: 0.499, Test loss: 1.845, Test accuracy: 49.54
Round  57, Global train loss: 0.499, Global test loss: 2.318, Global test accuracy: 12.19
Round  58, Train loss: 0.775, Test loss: 1.892, Test accuracy: 49.40
Round  58, Global train loss: 0.775, Global test loss: 2.356, Global test accuracy: 13.28
Round  59, Train loss: 0.666, Test loss: 1.935, Test accuracy: 48.85
Round  59, Global train loss: 0.666, Global test loss: 2.321, Global test accuracy: 11.17
Round  60, Train loss: 0.504, Test loss: 1.972, Test accuracy: 48.45
Round  60, Global train loss: 0.504, Global test loss: 2.392, Global test accuracy: 13.18
Round  61, Train loss: 0.572, Test loss: 1.948, Test accuracy: 48.08
Round  61, Global train loss: 0.572, Global test loss: 2.339, Global test accuracy: 11.28
Round  62, Train loss: 0.574, Test loss: 2.006, Test accuracy: 48.20
Round  62, Global train loss: 0.574, Global test loss: 2.389, Global test accuracy: 13.90
Round  63, Train loss: 0.409, Test loss: 2.042, Test accuracy: 47.96
Round  63, Global train loss: 0.409, Global test loss: 2.319, Global test accuracy: 12.97
Round  64, Train loss: 0.708, Test loss: 2.056, Test accuracy: 48.27
Round  64, Global train loss: 0.708, Global test loss: 2.348, Global test accuracy: 12.68
Round  65, Train loss: 0.469, Test loss: 2.066, Test accuracy: 48.34
Round  65, Global train loss: 0.469, Global test loss: 2.295, Global test accuracy: 13.60
Round  66, Train loss: 0.663, Test loss: 2.096, Test accuracy: 48.18
Round  66, Global train loss: 0.663, Global test loss: 2.385, Global test accuracy: 10.65
Round  67, Train loss: 0.602, Test loss: 2.099, Test accuracy: 48.27
Round  67, Global train loss: 0.602, Global test loss: 2.398, Global test accuracy: 13.02
Round  68, Train loss: 0.510, Test loss: 2.129, Test accuracy: 48.65
Round  68, Global train loss: 0.510, Global test loss: 2.329, Global test accuracy: 14.24
Round  69, Train loss: 0.435, Test loss: 2.149, Test accuracy: 48.47
Round  69, Global train loss: 0.435, Global test loss: 2.377, Global test accuracy: 11.04
Round  70, Train loss: 0.440, Test loss: 2.185, Test accuracy: 48.14
Round  70, Global train loss: 0.440, Global test loss: 2.342, Global test accuracy: 10.51
Round  71, Train loss: 0.403, Test loss: 2.274, Test accuracy: 47.59
Round  71, Global train loss: 0.403, Global test loss: 2.407, Global test accuracy: 11.63
Round  72, Train loss: 0.402, Test loss: 2.283, Test accuracy: 47.16
Round  72, Global train loss: 0.402, Global test loss: 2.338, Global test accuracy: 11.30
Round  73, Train loss: 0.306, Test loss: 2.319, Test accuracy: 47.09
Round  73, Global train loss: 0.306, Global test loss: 2.349, Global test accuracy: 12.39
Round  74, Train loss: 0.435, Test loss: 2.326, Test accuracy: 47.69
Round  74, Global train loss: 0.435, Global test loss: 2.461, Global test accuracy: 9.73
Round  75, Train loss: 0.448, Test loss: 2.361, Test accuracy: 47.83
Round  75, Global train loss: 0.448, Global test loss: 2.366, Global test accuracy: 13.01
Round  76, Train loss: 0.355, Test loss: 2.408, Test accuracy: 47.75
Round  76, Global train loss: 0.355, Global test loss: 2.347, Global test accuracy: 13.73
Round  77, Train loss: 0.314, Test loss: 2.435, Test accuracy: 47.84
Round  77, Global train loss: 0.314, Global test loss: 2.364, Global test accuracy: 11.05
Round  78, Train loss: 0.264, Test loss: 2.427, Test accuracy: 47.71
Round  78, Global train loss: 0.264, Global test loss: 2.368, Global test accuracy: 11.47
Round  79, Train loss: 0.404, Test loss: 2.477, Test accuracy: 47.25
Round  79, Global train loss: 0.404, Global test loss: 2.352, Global test accuracy: 12.73
Round  80, Train loss: 0.406, Test loss: 2.478, Test accuracy: 47.43
Round  80, Global train loss: 0.406, Global test loss: 2.399, Global test accuracy: 12.02
Round  81, Train loss: 0.463, Test loss: 2.482, Test accuracy: 47.80
Round  81, Global train loss: 0.463, Global test loss: 2.331, Global test accuracy: 12.21
Round  82, Train loss: 0.295, Test loss: 2.536, Test accuracy: 47.63
Round  82, Global train loss: 0.295, Global test loss: 2.382, Global test accuracy: 12.83
Round  83, Train loss: 0.391, Test loss: 2.576, Test accuracy: 47.39
Round  83, Global train loss: 0.391, Global test loss: 2.377, Global test accuracy: 11.45
Round  84, Train loss: 0.322, Test loss: 2.601, Test accuracy: 47.27
Round  84, Global train loss: 0.322, Global test loss: 2.301, Global test accuracy: 13.20
Round  85, Train loss: 0.367, Test loss: 2.687, Test accuracy: 47.00
Round  85, Global train loss: 0.367, Global test loss: 2.351, Global test accuracy: 12.42
Round  86, Train loss: 0.253, Test loss: 2.749, Test accuracy: 46.47
Round  86, Global train loss: 0.253, Global test loss: 2.404, Global test accuracy: 14.11
Round  87, Train loss: 0.210, Test loss: 2.720, Test accuracy: 46.85
Round  87, Global train loss: 0.210, Global test loss: 2.315, Global test accuracy: 12.33
Round  88, Train loss: 0.309, Test loss: 2.774, Test accuracy: 46.61
Round  88, Global train loss: 0.309, Global test loss: 2.332, Global test accuracy: 11.63
Round  89, Train loss: 0.297, Test loss: 2.810, Test accuracy: 46.92
Round  89, Global train loss: 0.297, Global test loss: 2.417, Global test accuracy: 11.16
Round  90, Train loss: 0.199, Test loss: 2.804, Test accuracy: 47.02
Round  90, Global train loss: 0.199, Global test loss: 2.403, Global test accuracy: 12.98
Round  91, Train loss: 0.324, Test loss: 2.798, Test accuracy: 46.63
Round  91, Global train loss: 0.324, Global test loss: 2.366, Global test accuracy: 11.49
Round  92, Train loss: 0.255, Test loss: 2.809, Test accuracy: 46.48
Round  92, Global train loss: 0.255, Global test loss: 2.331, Global test accuracy: 13.22
Round  93, Train loss: 0.175, Test loss: 2.912, Test accuracy: 45.94
Round  93, Global train loss: 0.175, Global test loss: 2.451, Global test accuracy: 12.80
Round  94, Train loss: 0.289, Test loss: 2.898, Test accuracy: 45.96
Round  94, Global train loss: 0.289, Global test loss: 2.444, Global test accuracy: 10.38
Round  95, Train loss: 0.207, Test loss: 2.920, Test accuracy: 45.82
Round  95, Global train loss: 0.207, Global test loss: 2.364, Global test accuracy: 9.61
Round  96, Train loss: 0.259, Test loss: 2.909, Test accuracy: 46.21
Round  96, Global train loss: 0.259, Global test loss: 2.367, Global test accuracy: 12.49
Round  97, Train loss: 0.203, Test loss: 2.992, Test accuracy: 46.97
Round  97, Global train loss: 0.203, Global test loss: 2.351, Global test accuracy: 13.24
Round  98, Train loss: 0.287, Test loss: 2.905, Test accuracy: 47.25
Round  98, Global train loss: 0.287, Global test loss: 2.349, Global test accuracy: 13.37
Round  99, Train loss: 0.246, Test loss: 2.910, Test accuracy: 46.75
Round  99, Global train loss: 0.246, Global test loss: 2.340, Global test accuracy: 11.01
Final Round, Train loss: 0.218, Test loss: 3.094, Test accuracy: 46.58
Final Round, Global train loss: 0.218, Global test loss: 2.340, Global test accuracy: 11.01
Average accuracy final 10 rounds: 46.503 

Average global accuracy final 10 rounds: 12.059000000000001 

1451.8813662528992
[1.3759396076202393, 2.7518792152404785, 3.8983776569366455, 5.0448760986328125, 6.195347785949707, 7.345819473266602, 8.507100105285645, 9.668380737304688, 10.83115267753601, 11.993924617767334, 13.15531063079834, 14.316696643829346, 15.475165128707886, 16.633633613586426, 17.7971351146698, 18.960636615753174, 20.12168264389038, 21.282728672027588, 22.42908024787903, 23.57543182373047, 24.720993518829346, 25.866555213928223, 27.005435943603516, 28.14431667327881, 29.289886951446533, 30.435457229614258, 31.572483777999878, 32.7095103263855, 33.84952163696289, 34.98953294754028, 36.124505281448364, 37.259477615356445, 38.411378383636475, 39.563279151916504, 40.71905851364136, 41.87483787536621, 43.035624265670776, 44.19641065597534, 45.34093976020813, 46.48546886444092, 47.62677049636841, 48.7680721282959, 49.910139322280884, 51.05220651626587, 52.20240521430969, 53.352603912353516, 54.50446915626526, 55.656334400177, 56.808953523635864, 57.96157264709473, 59.11740589141846, 60.27323913574219, 61.43131709098816, 62.58939504623413, 63.74903607368469, 64.90867710113525, 66.06549787521362, 67.22231864929199, 68.38261532783508, 69.54291200637817, 70.70208835601807, 71.86126470565796, 73.02584171295166, 74.19041872024536, 75.35572075843811, 76.52102279663086, 77.67331290245056, 78.82560300827026, 79.98122692108154, 81.13685083389282, 82.29813051223755, 83.45941019058228, 84.62421298027039, 85.7890157699585, 86.95464825630188, 88.12028074264526, 89.2825493812561, 90.44481801986694, 91.60481238365173, 92.76480674743652, 93.92685604095459, 95.08890533447266, 96.25211310386658, 97.4153208732605, 98.58017420768738, 99.74502754211426, 100.90723013877869, 102.06943273544312, 103.22944378852844, 104.38945484161377, 105.54668140411377, 106.70390796661377, 107.86452770233154, 109.02514743804932, 110.18564939498901, 111.34615135192871, 112.49860858917236, 113.65106582641602, 114.80343389511108, 115.95580196380615, 117.10736846923828, 118.25893497467041, 119.41022968292236, 120.56152439117432, 121.70046305656433, 122.83940172195435, 123.98008155822754, 125.12076139450073, 126.25704431533813, 127.39332723617554, 128.5385992527008, 129.68387126922607, 130.82434487342834, 131.96481847763062, 133.11179447174072, 134.25877046585083, 135.39448738098145, 136.53020429611206, 137.67301630973816, 138.81582832336426, 139.9557068347931, 141.09558534622192, 142.2433886528015, 143.3911919593811, 144.534405708313, 145.67761945724487, 146.8233573436737, 147.96909523010254, 149.1102614402771, 150.25142765045166, 151.3961751461029, 152.54092264175415, 153.6907136440277, 154.84050464630127, 155.9892840385437, 157.13806343078613, 158.2844307422638, 159.43079805374146, 160.58358693122864, 161.73637580871582, 162.8858847618103, 164.03539371490479, 165.1869719028473, 166.3385500907898, 167.48502779006958, 168.63150548934937, 169.7844476699829, 170.93738985061646, 172.09164333343506, 173.24589681625366, 174.397522687912, 175.5491485595703, 176.70188927650452, 177.85462999343872, 179.00028467178345, 180.14593935012817, 181.29673552513123, 182.44753170013428, 183.59607124328613, 184.744610786438, 185.8930172920227, 187.04142379760742, 188.1825888156891, 189.32375383377075, 190.4674415588379, 191.61112928390503, 192.75576329231262, 193.90039730072021, 195.03553986549377, 196.17068243026733, 197.30816102027893, 198.44563961029053, 199.58690571784973, 200.72817182540894, 201.86258721351624, 202.99700260162354, 204.13874435424805, 205.28048610687256, 206.42110085487366, 207.56171560287476, 208.70475387573242, 209.8477921485901, 210.9888904094696, 212.12998867034912, 213.26521062850952, 214.40043258666992, 215.55278205871582, 216.70513153076172, 217.8566563129425, 219.0081810951233, 220.1598162651062, 221.3114514350891, 222.460387468338, 223.6093235015869, 224.76440596580505, 225.9194884300232, 227.0723638534546, 228.225239276886, 229.374680519104, 230.52412176132202, 232.80455946922302, 235.08499717712402]
[19.62, 19.62, 22.16, 22.16, 25.74, 25.74, 33.94, 33.94, 39.33, 39.33, 39.78, 39.78, 42.43, 42.43, 43.01, 43.01, 45.2, 45.2, 45.73, 45.73, 47.14, 47.14, 48.13, 48.13, 48.9, 48.9, 49.44, 49.44, 49.51, 49.51, 50.64, 50.64, 51.3, 51.3, 50.72, 50.72, 50.61, 50.61, 50.62, 50.62, 51.6, 51.6, 51.55, 51.55, 51.88, 51.88, 51.62, 51.62, 51.99, 51.99, 52.03, 52.03, 51.55, 51.55, 51.52, 51.52, 51.48, 51.48, 51.45, 51.45, 51.95, 51.95, 51.68, 51.68, 51.8, 51.8, 51.31, 51.31, 50.99, 50.99, 51.16, 51.16, 51.45, 51.45, 51.52, 51.52, 51.2, 51.2, 51.02, 51.02, 51.15, 51.15, 50.71, 50.71, 50.55, 50.55, 50.2, 50.2, 50.23, 50.23, 50.16, 50.16, 49.44, 49.44, 49.45, 49.45, 49.03, 49.03, 48.97, 48.97, 49.13, 49.13, 49.27, 49.27, 49.34, 49.34, 49.54, 49.54, 49.79, 49.79, 49.75, 49.75, 49.67, 49.67, 49.54, 49.54, 49.4, 49.4, 48.85, 48.85, 48.45, 48.45, 48.08, 48.08, 48.2, 48.2, 47.96, 47.96, 48.27, 48.27, 48.34, 48.34, 48.18, 48.18, 48.27, 48.27, 48.65, 48.65, 48.47, 48.47, 48.14, 48.14, 47.59, 47.59, 47.16, 47.16, 47.09, 47.09, 47.69, 47.69, 47.83, 47.83, 47.75, 47.75, 47.84, 47.84, 47.71, 47.71, 47.25, 47.25, 47.43, 47.43, 47.8, 47.8, 47.63, 47.63, 47.39, 47.39, 47.27, 47.27, 47.0, 47.0, 46.47, 46.47, 46.85, 46.85, 46.61, 46.61, 46.92, 46.92, 47.02, 47.02, 46.63, 46.63, 46.48, 46.48, 45.94, 45.94, 45.96, 45.96, 45.82, 45.82, 46.21, 46.21, 46.97, 46.97, 47.25, 47.25, 46.75, 46.75, 46.58, 46.58]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.777, Test loss: 2.115, Test accuracy: 18.04
Round   0, Global train loss: 1.777, Global test loss: 2.297, Global test accuracy: 13.34
Round   1, Train loss: 1.622, Test loss: 2.021, Test accuracy: 22.27
Round   1, Global train loss: 1.622, Global test loss: 2.337, Global test accuracy: 14.91
Round   2, Train loss: 1.688, Test loss: 1.903, Test accuracy: 23.83
Round   2, Global train loss: 1.688, Global test loss: 2.394, Global test accuracy: 8.59
Round   3, Train loss: 1.647, Test loss: 1.781, Test accuracy: 30.11
Round   3, Global train loss: 1.647, Global test loss: 2.510, Global test accuracy: 12.02
Round   4, Train loss: 1.678, Test loss: 1.534, Test accuracy: 35.67
Round   4, Global train loss: 1.678, Global test loss: 2.383, Global test accuracy: 11.77
Round   5, Train loss: 1.560, Test loss: 1.508, Test accuracy: 38.21
Round   5, Global train loss: 1.560, Global test loss: 2.304, Global test accuracy: 13.81
Round   6, Train loss: 1.609, Test loss: 1.432, Test accuracy: 42.34
Round   6, Global train loss: 1.609, Global test loss: 2.332, Global test accuracy: 14.19
Round   7, Train loss: 1.509, Test loss: 1.433, Test accuracy: 41.78
Round   7, Global train loss: 1.509, Global test loss: 2.586, Global test accuracy: 10.32
Round   8, Train loss: 1.652, Test loss: 1.371, Test accuracy: 44.60
Round   8, Global train loss: 1.652, Global test loss: 2.393, Global test accuracy: 14.25
Round   9, Train loss: 1.648, Test loss: 1.354, Test accuracy: 46.94
Round   9, Global train loss: 1.648, Global test loss: 2.300, Global test accuracy: 14.31
Round  10, Train loss: 1.569, Test loss: 1.345, Test accuracy: 47.48
Round  10, Global train loss: 1.569, Global test loss: 2.357, Global test accuracy: 13.79
Round  11, Train loss: 1.551, Test loss: 1.334, Test accuracy: 47.15
Round  11, Global train loss: 1.551, Global test loss: 2.334, Global test accuracy: 12.67
Round  12, Train loss: 1.545, Test loss: 1.321, Test accuracy: 48.77
Round  12, Global train loss: 1.545, Global test loss: 2.359, Global test accuracy: 13.31
Round  13, Train loss: 1.605, Test loss: 1.306, Test accuracy: 49.48
Round  13, Global train loss: 1.605, Global test loss: 2.373, Global test accuracy: 13.70
Round  14, Train loss: 1.493, Test loss: 1.293, Test accuracy: 49.95
Round  14, Global train loss: 1.493, Global test loss: 2.408, Global test accuracy: 14.89
Round  15, Train loss: 1.477, Test loss: 1.278, Test accuracy: 50.62
Round  15, Global train loss: 1.477, Global test loss: 2.293, Global test accuracy: 13.13
Round  16, Train loss: 1.563, Test loss: 1.270, Test accuracy: 50.66
Round  16, Global train loss: 1.563, Global test loss: 2.354, Global test accuracy: 14.29
Round  17, Train loss: 1.469, Test loss: 1.262, Test accuracy: 50.81
Round  17, Global train loss: 1.469, Global test loss: 2.483, Global test accuracy: 12.97
Round  18, Train loss: 1.530, Test loss: 1.242, Test accuracy: 52.01
Round  18, Global train loss: 1.530, Global test loss: 2.374, Global test accuracy: 15.56
Round  19, Train loss: 1.466, Test loss: 1.245, Test accuracy: 51.72
Round  19, Global train loss: 1.466, Global test loss: 2.330, Global test accuracy: 14.70
Round  20, Train loss: 1.553, Test loss: 1.241, Test accuracy: 53.43
Round  20, Global train loss: 1.553, Global test loss: 2.345, Global test accuracy: 13.26
Round  21, Train loss: 1.499, Test loss: 1.230, Test accuracy: 53.82
Round  21, Global train loss: 1.499, Global test loss: 2.516, Global test accuracy: 12.37
Round  22, Train loss: 1.468, Test loss: 1.231, Test accuracy: 53.75
Round  22, Global train loss: 1.468, Global test loss: 2.537, Global test accuracy: 12.15
Round  23, Train loss: 1.488, Test loss: 1.220, Test accuracy: 54.14
Round  23, Global train loss: 1.488, Global test loss: 2.407, Global test accuracy: 13.54
Round  24, Train loss: 1.371, Test loss: 1.214, Test accuracy: 54.40
Round  24, Global train loss: 1.371, Global test loss: 2.429, Global test accuracy: 13.25
Round  25, Train loss: 1.416, Test loss: 1.200, Test accuracy: 54.91
Round  25, Global train loss: 1.416, Global test loss: 2.522, Global test accuracy: 12.39
Round  26, Train loss: 1.473, Test loss: 1.217, Test accuracy: 53.69
Round  26, Global train loss: 1.473, Global test loss: 2.373, Global test accuracy: 13.88
Round  27, Train loss: 1.439, Test loss: 1.218, Test accuracy: 53.92
Round  27, Global train loss: 1.439, Global test loss: 2.379, Global test accuracy: 12.55
Round  28, Train loss: 1.436, Test loss: 1.219, Test accuracy: 53.84
Round  28, Global train loss: 1.436, Global test loss: 2.358, Global test accuracy: 14.41
Round  29, Train loss: 1.346, Test loss: 1.222, Test accuracy: 53.59
Round  29, Global train loss: 1.346, Global test loss: 2.367, Global test accuracy: 14.27
Round  30, Train loss: 1.410, Test loss: 1.220, Test accuracy: 53.60
Round  30, Global train loss: 1.410, Global test loss: 2.373, Global test accuracy: 13.59
Round  31, Train loss: 1.383, Test loss: 1.221, Test accuracy: 53.68
Round  31, Global train loss: 1.383, Global test loss: 2.492, Global test accuracy: 13.61
Round  32, Train loss: 1.437, Test loss: 1.236, Test accuracy: 52.80
Round  32, Global train loss: 1.437, Global test loss: 2.498, Global test accuracy: 14.26
Round  33, Train loss: 1.385, Test loss: 1.228, Test accuracy: 53.36
Round  33, Global train loss: 1.385, Global test loss: 2.520, Global test accuracy: 12.75
Round  34, Train loss: 1.360, Test loss: 1.223, Test accuracy: 53.77
Round  34, Global train loss: 1.360, Global test loss: 2.354, Global test accuracy: 14.51
Round  35, Train loss: 1.395, Test loss: 1.219, Test accuracy: 54.28
Round  35, Global train loss: 1.395, Global test loss: 2.411, Global test accuracy: 12.97
Round  36, Train loss: 1.459, Test loss: 1.228, Test accuracy: 53.99
Round  36, Global train loss: 1.459, Global test loss: 2.378, Global test accuracy: 14.20
Round  37, Train loss: 1.250, Test loss: 1.224, Test accuracy: 54.33
Round  37, Global train loss: 1.250, Global test loss: 2.415, Global test accuracy: 14.91
Round  38, Train loss: 1.277, Test loss: 1.225, Test accuracy: 53.91
Round  38, Global train loss: 1.277, Global test loss: 2.441, Global test accuracy: 14.08
Round  39, Train loss: 1.404, Test loss: 1.228, Test accuracy: 53.66
Round  39, Global train loss: 1.404, Global test loss: 2.524, Global test accuracy: 14.83
Round  40, Train loss: 1.357, Test loss: 1.219, Test accuracy: 54.19
Round  40, Global train loss: 1.357, Global test loss: 2.533, Global test accuracy: 14.84
Round  41, Train loss: 1.377, Test loss: 1.215, Test accuracy: 54.37
Round  41, Global train loss: 1.377, Global test loss: 2.541, Global test accuracy: 15.22
Round  42, Train loss: 1.310, Test loss: 1.216, Test accuracy: 54.08
Round  42, Global train loss: 1.310, Global test loss: 2.510, Global test accuracy: 14.24
Round  43, Train loss: 1.340, Test loss: 1.231, Test accuracy: 53.45
Round  43, Global train loss: 1.340, Global test loss: 2.462, Global test accuracy: 14.21
Round  44, Train loss: 1.333, Test loss: 1.241, Test accuracy: 53.19
Round  44, Global train loss: 1.333, Global test loss: 2.542, Global test accuracy: 14.88
Round  45, Train loss: 1.201, Test loss: 1.250, Test accuracy: 53.23
Round  45, Global train loss: 1.201, Global test loss: 2.529, Global test accuracy: 12.63
Round  46, Train loss: 1.335, Test loss: 1.241, Test accuracy: 53.31
Round  46, Global train loss: 1.335, Global test loss: 2.616, Global test accuracy: 12.62
Round  47, Train loss: 1.207, Test loss: 1.258, Test accuracy: 52.63
Round  47, Global train loss: 1.207, Global test loss: 2.484, Global test accuracy: 13.38
Round  48, Train loss: 1.258, Test loss: 1.289, Test accuracy: 51.90
Round  48, Global train loss: 1.258, Global test loss: 2.640, Global test accuracy: 13.83
Round  49, Train loss: 1.197, Test loss: 1.279, Test accuracy: 51.48
Round  49, Global train loss: 1.197, Global test loss: 2.613, Global test accuracy: 13.24
Round  50, Train loss: 1.308, Test loss: 1.270, Test accuracy: 51.97
Round  50, Global train loss: 1.308, Global test loss: 2.578, Global test accuracy: 13.48
Round  51, Train loss: 1.065, Test loss: 1.263, Test accuracy: 52.18
Round  51, Global train loss: 1.065, Global test loss: 2.680, Global test accuracy: 14.96
Round  52, Train loss: 1.268, Test loss: 1.263, Test accuracy: 52.37
Round  52, Global train loss: 1.268, Global test loss: 2.635, Global test accuracy: 12.36
Round  53, Train loss: 1.290, Test loss: 1.272, Test accuracy: 52.53
Round  53, Global train loss: 1.290, Global test loss: 2.562, Global test accuracy: 12.72
Round  54, Train loss: 1.284, Test loss: 1.276, Test accuracy: 52.64
Round  54, Global train loss: 1.284, Global test loss: 2.586, Global test accuracy: 12.82
Round  55, Train loss: 0.997, Test loss: 1.272, Test accuracy: 52.88
Round  55, Global train loss: 0.997, Global test loss: 2.620, Global test accuracy: 14.60
Round  56, Train loss: 1.103, Test loss: 1.292, Test accuracy: 52.08
Round  56, Global train loss: 1.103, Global test loss: 2.578, Global test accuracy: 14.57
Round  57, Train loss: 1.264, Test loss: 1.279, Test accuracy: 52.27
Round  57, Global train loss: 1.264, Global test loss: 2.568, Global test accuracy: 12.93
Round  58, Train loss: 1.163, Test loss: 1.279, Test accuracy: 52.35
Round  58, Global train loss: 1.163, Global test loss: 2.765, Global test accuracy: 15.24
Round  59, Train loss: 1.202, Test loss: 1.273, Test accuracy: 52.71
Round  59, Global train loss: 1.202, Global test loss: 2.719, Global test accuracy: 13.46
Round  60, Train loss: 1.142, Test loss: 1.276, Test accuracy: 53.00
Round  60, Global train loss: 1.142, Global test loss: 2.729, Global test accuracy: 12.91
Round  61, Train loss: 1.139, Test loss: 1.286, Test accuracy: 52.44
Round  61, Global train loss: 1.139, Global test loss: 2.638, Global test accuracy: 14.38
Round  62, Train loss: 1.097, Test loss: 1.289, Test accuracy: 52.39
Round  62, Global train loss: 1.097, Global test loss: 2.690, Global test accuracy: 14.53
Round  63, Train loss: 1.105, Test loss: 1.287, Test accuracy: 53.50
Round  63, Global train loss: 1.105, Global test loss: 2.967, Global test accuracy: 11.57
Round  64, Train loss: 1.056, Test loss: 1.291, Test accuracy: 53.00
Round  64, Global train loss: 1.056, Global test loss: 2.724, Global test accuracy: 14.36
Round  65, Train loss: 1.228, Test loss: 1.301, Test accuracy: 52.87
Round  65, Global train loss: 1.228, Global test loss: 2.624, Global test accuracy: 13.20
Round  66, Train loss: 1.208, Test loss: 1.294, Test accuracy: 53.06
Round  66, Global train loss: 1.208, Global test loss: 2.761, Global test accuracy: 14.19
Round  67, Train loss: 1.018, Test loss: 1.314, Test accuracy: 52.79
Round  67, Global train loss: 1.018, Global test loss: 2.694, Global test accuracy: 14.43
Round  68, Train loss: 1.050, Test loss: 1.318, Test accuracy: 52.92
Round  68, Global train loss: 1.050, Global test loss: 2.666, Global test accuracy: 13.32
Round  69, Train loss: 1.150, Test loss: 1.333, Test accuracy: 52.09
Round  69, Global train loss: 1.150, Global test loss: 2.824, Global test accuracy: 14.25
Round  70, Train loss: 1.081, Test loss: 1.330, Test accuracy: 52.30
Round  70, Global train loss: 1.081, Global test loss: 2.837, Global test accuracy: 14.61
Round  71, Train loss: 1.062, Test loss: 1.356, Test accuracy: 51.78
Round  71, Global train loss: 1.062, Global test loss: 2.806, Global test accuracy: 13.46
Round  72, Train loss: 0.999, Test loss: 1.372, Test accuracy: 51.54
Round  72, Global train loss: 0.999, Global test loss: 2.886, Global test accuracy: 15.46
Round  73, Train loss: 1.126, Test loss: 1.381, Test accuracy: 51.91
Round  73, Global train loss: 1.126, Global test loss: 2.922, Global test accuracy: 12.71
Round  74, Train loss: 0.941, Test loss: 1.416, Test accuracy: 51.89
Round  74, Global train loss: 0.941, Global test loss: 2.977, Global test accuracy: 14.98
Round  75, Train loss: 1.007, Test loss: 1.407, Test accuracy: 51.96
Round  75, Global train loss: 1.007, Global test loss: 2.836, Global test accuracy: 12.73
Round  76, Train loss: 1.021, Test loss: 1.407, Test accuracy: 52.06
Round  76, Global train loss: 1.021, Global test loss: 2.966, Global test accuracy: 12.94
Round  77, Train loss: 0.842, Test loss: 1.398, Test accuracy: 51.77
Round  77, Global train loss: 0.842, Global test loss: 2.993, Global test accuracy: 14.18
Round  78, Train loss: 0.958, Test loss: 1.389, Test accuracy: 52.03
Round  78, Global train loss: 0.958, Global test loss: 2.815, Global test accuracy: 14.25
Round  79, Train loss: 0.987, Test loss: 1.402, Test accuracy: 51.65
Round  79, Global train loss: 0.987, Global test loss: 3.021, Global test accuracy: 15.03
Round  80, Train loss: 1.076, Test loss: 1.394, Test accuracy: 52.18
Round  80, Global train loss: 1.076, Global test loss: 3.027, Global test accuracy: 14.26
Round  81, Train loss: 1.071, Test loss: 1.418, Test accuracy: 51.49
Round  81, Global train loss: 1.071, Global test loss: 2.925, Global test accuracy: 12.93
Round  82, Train loss: 1.141, Test loss: 1.434, Test accuracy: 51.39
Round  82, Global train loss: 1.141, Global test loss: 2.859, Global test accuracy: 12.57
Round  83, Train loss: 0.949, Test loss: 1.463, Test accuracy: 51.15
Round  83, Global train loss: 0.949, Global test loss: 3.049, Global test accuracy: 14.26
Round  84, Train loss: 0.933, Test loss: 1.476, Test accuracy: 50.70
Round  84, Global train loss: 0.933, Global test loss: 2.943, Global test accuracy: 12.29
Round  85, Train loss: 0.952, Test loss: 1.473, Test accuracy: 51.20
Round  85, Global train loss: 0.952, Global test loss: 3.018, Global test accuracy: 13.88
Round  86, Train loss: 1.013, Test loss: 1.480, Test accuracy: 51.22
Round  86, Global train loss: 1.013, Global test loss: 2.972, Global test accuracy: 13.23
Round  87, Train loss: 1.004, Test loss: 1.488, Test accuracy: 51.04
Round  87, Global train loss: 1.004, Global test loss: 2.972, Global test accuracy: 11.80
Round  88, Train loss: 1.010, Test loss: 1.480, Test accuracy: 51.41
Round  88, Global train loss: 1.010, Global test loss: 2.983, Global test accuracy: 13.75
Round  89, Train loss: 0.994, Test loss: 1.521, Test accuracy: 51.09
Round  89, Global train loss: 0.994, Global test loss: 3.067, Global test accuracy: 11.99
Round  90, Train loss: 0.913, Test loss: 1.512, Test accuracy: 51.38
Round  90, Global train loss: 0.913, Global test loss: 3.091, Global test accuracy: 12.98
Round  91, Train loss: 1.017, Test loss: 1.520, Test accuracy: 51.61
Round  91, Global train loss: 1.017, Global test loss: 3.183, Global test accuracy: 14.22
Round  92, Train loss: 0.900, Test loss: 1.520, Test accuracy: 51.56
Round  92, Global train loss: 0.900, Global test loss: 3.080, Global test accuracy: 13.16
Round  93, Train loss: 0.959, Test loss: 1.507, Test accuracy: 51.41
Round  93, Global train loss: 0.959, Global test loss: 3.247, Global test accuracy: 12.43
Round  94, Train loss: 0.932, Test loss: 1.531, Test accuracy: 50.28
Round  94, Global train loss: 0.932, Global test loss: 3.192, Global test accuracy: 14.67
Round  95, Train loss: 0.885, Test loss: 1.533, Test accuracy: 50.55
Round  95, Global train loss: 0.885, Global test loss: 3.132, Global test accuracy: 12.60
Round  96, Train loss: 0.942, Test loss: 1.544, Test accuracy: 51.42
Round  96, Global train loss: 0.942, Global test loss: 3.167, Global test accuracy: 12.18
Round  97, Train loss: 0.887, Test loss: 1.579, Test accuracy: 50.53
Round  97, Global train loss: 0.887, Global test loss: 3.474, Global test accuracy: 12.51
Round  98, Train loss: 0.755, Test loss: 1.565, Test accuracy: 50.82
Round  98, Global train loss: 0.755, Global test loss: 3.149, Global test accuracy: 14.10
Round  99, Train loss: 0.907, Test loss: 1.564, Test accuracy: 50.72
Round  99, Global train loss: 0.907, Global test loss: 3.185, Global test accuracy: 13.38
Final Round, Train loss: 0.727, Test loss: 1.792, Test accuracy: 49.72
Final Round, Global train loss: 0.727, Global test loss: 3.185, Global test accuracy: 13.38
Average accuracy final 10 rounds: 51.028000000000006 

Average global accuracy final 10 rounds: 13.222999999999999 

1433.9065840244293
[1.381955862045288, 2.763911724090576, 3.8573174476623535, 4.950723171234131, 6.105827569961548, 7.260931968688965, 8.419818878173828, 9.578705787658691, 10.743727445602417, 11.908749103546143, 13.074365615844727, 14.23998212814331, 15.40991497039795, 16.579847812652588, 17.74350666999817, 18.90716552734375, 20.07954716682434, 21.25192880630493, 22.414857864379883, 23.577786922454834, 24.746241807937622, 25.91469669342041, 27.07837200164795, 28.24204730987549, 29.405258417129517, 30.568469524383545, 31.729163646697998, 32.88985776901245, 34.050204038619995, 35.21055030822754, 36.36721968650818, 37.52388906478882, 38.6816611289978, 39.83943319320679, 41.001901149749756, 42.164369106292725, 43.32088017463684, 44.47739124298096, 45.63602066040039, 46.794650077819824, 47.95239043235779, 49.11013078689575, 50.26628398895264, 51.42243719100952, 52.578590393066406, 53.73474359512329, 54.89490604400635, 56.055068492889404, 57.214194774627686, 58.37332105636597, 59.53769540786743, 60.7020697593689, 61.87605547904968, 63.05004119873047, 64.21951103210449, 65.38898086547852, 66.55166363716125, 67.714346408844, 68.87792682647705, 70.04150724411011, 71.20216369628906, 72.36282014846802, 73.53990411758423, 74.71698808670044, 75.88207745552063, 77.04716682434082, 78.21476602554321, 79.3823652267456, 80.56505060195923, 81.74773597717285, 82.90976405143738, 84.0717921257019, 85.24287128448486, 86.41395044326782, 87.58235597610474, 88.75076150894165, 89.95033717155457, 91.14991283416748, 92.31421113014221, 93.47850942611694, 94.64523816108704, 95.81196689605713, 96.97644925117493, 98.14093160629272, 99.30508184432983, 100.46923208236694, 101.63698649406433, 102.80474090576172, 103.96779775619507, 105.13085460662842, 106.29632592201233, 107.46179723739624, 108.62980484962463, 109.79781246185303, 110.9643383026123, 112.13086414337158, 113.296626329422, 114.46238851547241, 115.6328775882721, 116.80336666107178, 117.96780180931091, 119.13223695755005, 120.29719638824463, 121.46215581893921, 122.62669634819031, 123.7912368774414, 124.9545361995697, 126.117835521698, 127.28202605247498, 128.44621658325195, 129.61533904075623, 130.7844614982605, 131.95284605026245, 133.1212306022644, 134.2861156463623, 135.4510006904602, 136.61781692504883, 137.78463315963745, 138.95335602760315, 140.12207889556885, 141.2765793800354, 142.43107986450195, 143.5886721611023, 144.74626445770264, 145.9064302444458, 147.06659603118896, 148.22381043434143, 149.3810248374939, 150.54251623153687, 151.70400762557983, 152.86375403404236, 154.02350044250488, 155.0154640674591, 156.00742769241333, 157.15778160095215, 158.30813550949097, 159.45278787612915, 160.59744024276733, 161.74653506278992, 162.8956298828125, 164.04364156723022, 165.19165325164795, 166.34688091278076, 167.50210857391357, 168.64863109588623, 169.7951536178589, 170.95104670524597, 172.10693979263306, 173.13254690170288, 174.1581540107727, 175.18205785751343, 176.20596170425415, 177.23657298088074, 178.26718425750732, 179.29404091835022, 180.32089757919312, 181.34766244888306, 182.374427318573, 183.40338587760925, 184.4323444366455, 185.45889258384705, 186.48544073104858, 187.50761723518372, 188.52979373931885, 189.5609233379364, 190.59205293655396, 191.61767196655273, 192.6432909965515, 193.70358204841614, 194.76387310028076, 195.7927749156952, 196.82167673110962, 197.84930062294006, 198.8769245147705, 199.90214443206787, 200.92736434936523, 201.95526599884033, 202.98316764831543, 204.0139937400818, 205.04481983184814, 206.07054138183594, 207.09626293182373, 208.12938117980957, 209.1624994277954, 210.1903133392334, 211.2181272506714, 212.2402319908142, 213.26233673095703, 214.28838777542114, 215.31443881988525, 216.34178376197815, 217.36912870407104, 218.39188981056213, 219.41465091705322, 220.43934202194214, 221.46403312683105, 222.49147248268127, 223.5189118385315, 224.5637948513031, 225.6086778640747, 227.89740920066833, 230.18614053726196]
[18.04, 18.04, 22.27, 22.27, 23.83, 23.83, 30.11, 30.11, 35.67, 35.67, 38.21, 38.21, 42.34, 42.34, 41.78, 41.78, 44.6, 44.6, 46.94, 46.94, 47.48, 47.48, 47.15, 47.15, 48.77, 48.77, 49.48, 49.48, 49.95, 49.95, 50.62, 50.62, 50.66, 50.66, 50.81, 50.81, 52.01, 52.01, 51.72, 51.72, 53.43, 53.43, 53.82, 53.82, 53.75, 53.75, 54.14, 54.14, 54.4, 54.4, 54.91, 54.91, 53.69, 53.69, 53.92, 53.92, 53.84, 53.84, 53.59, 53.59, 53.6, 53.6, 53.68, 53.68, 52.8, 52.8, 53.36, 53.36, 53.77, 53.77, 54.28, 54.28, 53.99, 53.99, 54.33, 54.33, 53.91, 53.91, 53.66, 53.66, 54.19, 54.19, 54.37, 54.37, 54.08, 54.08, 53.45, 53.45, 53.19, 53.19, 53.23, 53.23, 53.31, 53.31, 52.63, 52.63, 51.9, 51.9, 51.48, 51.48, 51.97, 51.97, 52.18, 52.18, 52.37, 52.37, 52.53, 52.53, 52.64, 52.64, 52.88, 52.88, 52.08, 52.08, 52.27, 52.27, 52.35, 52.35, 52.71, 52.71, 53.0, 53.0, 52.44, 52.44, 52.39, 52.39, 53.5, 53.5, 53.0, 53.0, 52.87, 52.87, 53.06, 53.06, 52.79, 52.79, 52.92, 52.92, 52.09, 52.09, 52.3, 52.3, 51.78, 51.78, 51.54, 51.54, 51.91, 51.91, 51.89, 51.89, 51.96, 51.96, 52.06, 52.06, 51.77, 51.77, 52.03, 52.03, 51.65, 51.65, 52.18, 52.18, 51.49, 51.49, 51.39, 51.39, 51.15, 51.15, 50.7, 50.7, 51.2, 51.2, 51.22, 51.22, 51.04, 51.04, 51.41, 51.41, 51.09, 51.09, 51.38, 51.38, 51.61, 51.61, 51.56, 51.56, 51.41, 51.41, 50.28, 50.28, 50.55, 50.55, 51.42, 51.42, 50.53, 50.53, 50.82, 50.82, 50.72, 50.72, 49.72, 49.72]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.791, Test loss: 2.194, Test accuracy: 13.69
Round   0, Global train loss: 1.791, Global test loss: 2.371, Global test accuracy: 10.00
Round   1, Train loss: 1.684, Test loss: 2.087, Test accuracy: 20.49
Round   1, Global train loss: 1.684, Global test loss: 2.394, Global test accuracy: 13.91
Round   2, Train loss: 1.659, Test loss: 1.999, Test accuracy: 25.21
Round   2, Global train loss: 1.659, Global test loss: 2.506, Global test accuracy: 12.05
Round   3, Train loss: 1.683, Test loss: 1.751, Test accuracy: 30.65
Round   3, Global train loss: 1.683, Global test loss: 2.356, Global test accuracy: 12.47
Round   4, Train loss: 1.641, Test loss: 1.564, Test accuracy: 37.12
Round   4, Global train loss: 1.641, Global test loss: 2.436, Global test accuracy: 9.71
Round   5, Train loss: 1.512, Test loss: 1.526, Test accuracy: 37.84
Round   5, Global train loss: 1.512, Global test loss: 2.323, Global test accuracy: 12.93
Round   6, Train loss: 1.561, Test loss: 1.449, Test accuracy: 40.85
Round   6, Global train loss: 1.561, Global test loss: 2.401, Global test accuracy: 12.76
Round   7, Train loss: 1.515, Test loss: 1.437, Test accuracy: 42.06
Round   7, Global train loss: 1.515, Global test loss: 2.418, Global test accuracy: 13.56
Round   8, Train loss: 1.582, Test loss: 1.382, Test accuracy: 44.41
Round   8, Global train loss: 1.582, Global test loss: 2.309, Global test accuracy: 13.26
Round   9, Train loss: 1.652, Test loss: 1.345, Test accuracy: 46.08
Round   9, Global train loss: 1.652, Global test loss: 2.284, Global test accuracy: 15.12
Round  10, Train loss: 1.470, Test loss: 1.338, Test accuracy: 46.21
Round  10, Global train loss: 1.470, Global test loss: 2.406, Global test accuracy: 13.60
Round  11, Train loss: 1.610, Test loss: 1.329, Test accuracy: 46.58
Round  11, Global train loss: 1.610, Global test loss: 2.382, Global test accuracy: 11.50
Round  12, Train loss: 1.632, Test loss: 1.312, Test accuracy: 48.02
Round  12, Global train loss: 1.632, Global test loss: 2.276, Global test accuracy: 15.10
Round  13, Train loss: 1.610, Test loss: 1.300, Test accuracy: 48.99
Round  13, Global train loss: 1.610, Global test loss: 2.417, Global test accuracy: 14.16
Round  14, Train loss: 1.613, Test loss: 1.300, Test accuracy: 49.15
Round  14, Global train loss: 1.613, Global test loss: 2.374, Global test accuracy: 15.22
Round  15, Train loss: 1.448, Test loss: 1.293, Test accuracy: 49.50
Round  15, Global train loss: 1.448, Global test loss: 2.268, Global test accuracy: 14.58
Round  16, Train loss: 1.592, Test loss: 1.286, Test accuracy: 50.19
Round  16, Global train loss: 1.592, Global test loss: 2.325, Global test accuracy: 13.70
Round  17, Train loss: 1.549, Test loss: 1.287, Test accuracy: 50.40
Round  17, Global train loss: 1.549, Global test loss: 2.334, Global test accuracy: 13.60
Round  18, Train loss: 1.420, Test loss: 1.275, Test accuracy: 51.52
Round  18, Global train loss: 1.420, Global test loss: 2.390, Global test accuracy: 13.63
Round  19, Train loss: 1.465, Test loss: 1.282, Test accuracy: 50.71
Round  19, Global train loss: 1.465, Global test loss: 2.409, Global test accuracy: 14.44
Round  20, Train loss: 1.485, Test loss: 1.277, Test accuracy: 51.39
Round  20, Global train loss: 1.485, Global test loss: 2.381, Global test accuracy: 13.78
Round  21, Train loss: 1.442, Test loss: 1.277, Test accuracy: 51.95
Round  21, Global train loss: 1.442, Global test loss: 2.405, Global test accuracy: 15.26
Round  22, Train loss: 1.363, Test loss: 1.271, Test accuracy: 52.17
Round  22, Global train loss: 1.363, Global test loss: 2.340, Global test accuracy: 14.56
Round  23, Train loss: 1.413, Test loss: 1.261, Test accuracy: 52.58
Round  23, Global train loss: 1.413, Global test loss: 2.344, Global test accuracy: 13.41
Round  24, Train loss: 1.371, Test loss: 1.246, Test accuracy: 53.17
Round  24, Global train loss: 1.371, Global test loss: 2.330, Global test accuracy: 14.07
Round  25, Train loss: 1.438, Test loss: 1.242, Test accuracy: 53.58
Round  25, Global train loss: 1.438, Global test loss: 2.414, Global test accuracy: 13.84
Round  26, Train loss: 1.416, Test loss: 1.247, Test accuracy: 53.49
Round  26, Global train loss: 1.416, Global test loss: 2.414, Global test accuracy: 13.81
Round  27, Train loss: 1.309, Test loss: 1.238, Test accuracy: 54.14
Round  27, Global train loss: 1.309, Global test loss: 2.417, Global test accuracy: 13.69
Round  28, Train loss: 1.377, Test loss: 1.233, Test accuracy: 54.81
Round  28, Global train loss: 1.377, Global test loss: 2.518, Global test accuracy: 14.17
Round  29, Train loss: 1.434, Test loss: 1.227, Test accuracy: 54.58
Round  29, Global train loss: 1.434, Global test loss: 2.334, Global test accuracy: 14.02
Round  30, Train loss: 1.426, Test loss: 1.233, Test accuracy: 54.39
Round  30, Global train loss: 1.426, Global test loss: 2.291, Global test accuracy: 15.58
Round  31, Train loss: 1.474, Test loss: 1.224, Test accuracy: 54.43
Round  31, Global train loss: 1.474, Global test loss: 2.343, Global test accuracy: 14.73
Round  32, Train loss: 1.362, Test loss: 1.216, Test accuracy: 54.92
Round  32, Global train loss: 1.362, Global test loss: 2.380, Global test accuracy: 13.94
Round  33, Train loss: 1.482, Test loss: 1.217, Test accuracy: 55.04
Round  33, Global train loss: 1.482, Global test loss: 2.361, Global test accuracy: 16.03
Round  34, Train loss: 1.427, Test loss: 1.232, Test accuracy: 54.27
Round  34, Global train loss: 1.427, Global test loss: 2.380, Global test accuracy: 14.94
Round  35, Train loss: 1.234, Test loss: 1.221, Test accuracy: 54.26
Round  35, Global train loss: 1.234, Global test loss: 2.383, Global test accuracy: 14.78
Round  36, Train loss: 1.490, Test loss: 1.222, Test accuracy: 54.40
Round  36, Global train loss: 1.490, Global test loss: 2.312, Global test accuracy: 14.93
Round  37, Train loss: 1.210, Test loss: 1.221, Test accuracy: 54.36
Round  37, Global train loss: 1.210, Global test loss: 2.349, Global test accuracy: 14.57
Round  38, Train loss: 1.271, Test loss: 1.237, Test accuracy: 53.94
Round  38, Global train loss: 1.271, Global test loss: 2.516, Global test accuracy: 15.45
Round  39, Train loss: 1.428, Test loss: 1.241, Test accuracy: 53.82
Round  39, Global train loss: 1.428, Global test loss: 2.374, Global test accuracy: 14.50
Round  40, Train loss: 1.410, Test loss: 1.235, Test accuracy: 53.58
Round  40, Global train loss: 1.410, Global test loss: 2.419, Global test accuracy: 13.45
Round  41, Train loss: 1.443, Test loss: 1.247, Test accuracy: 53.28
Round  41, Global train loss: 1.443, Global test loss: 2.512, Global test accuracy: 14.48
Round  42, Train loss: 1.413, Test loss: 1.230, Test accuracy: 54.29
Round  42, Global train loss: 1.413, Global test loss: 2.343, Global test accuracy: 14.42
Round  43, Train loss: 1.343, Test loss: 1.209, Test accuracy: 54.61
Round  43, Global train loss: 1.343, Global test loss: 2.475, Global test accuracy: 14.08
Round  44, Train loss: 1.410, Test loss: 1.220, Test accuracy: 54.20
Round  44, Global train loss: 1.410, Global test loss: 2.350, Global test accuracy: 14.66
Round  45, Train loss: 1.320, Test loss: 1.227, Test accuracy: 54.18
Round  45, Global train loss: 1.320, Global test loss: 2.378, Global test accuracy: 14.46
Round  46, Train loss: 1.450, Test loss: 1.229, Test accuracy: 54.23
Round  46, Global train loss: 1.450, Global test loss: 2.385, Global test accuracy: 14.27
Round  47, Train loss: 1.253, Test loss: 1.237, Test accuracy: 53.65
Round  47, Global train loss: 1.253, Global test loss: 2.475, Global test accuracy: 14.97
Round  48, Train loss: 1.339, Test loss: 1.233, Test accuracy: 53.75
Round  48, Global train loss: 1.339, Global test loss: 2.379, Global test accuracy: 14.83
Round  49, Train loss: 1.222, Test loss: 1.219, Test accuracy: 54.09
Round  49, Global train loss: 1.222, Global test loss: 2.480, Global test accuracy: 15.32
Round  50, Train loss: 1.293, Test loss: 1.206, Test accuracy: 55.01
Round  50, Global train loss: 1.293, Global test loss: 2.448, Global test accuracy: 13.22
Round  51, Train loss: 1.311, Test loss: 1.205, Test accuracy: 54.89
Round  51, Global train loss: 1.311, Global test loss: 2.497, Global test accuracy: 14.14
Round  52, Train loss: 1.299, Test loss: 1.217, Test accuracy: 54.52
Round  52, Global train loss: 1.299, Global test loss: 2.476, Global test accuracy: 14.67
Round  53, Train loss: 1.242, Test loss: 1.233, Test accuracy: 53.83
Round  53, Global train loss: 1.242, Global test loss: 2.437, Global test accuracy: 14.01
Round  54, Train loss: 1.109, Test loss: 1.238, Test accuracy: 53.80
Round  54, Global train loss: 1.109, Global test loss: 2.538, Global test accuracy: 14.07
Round  55, Train loss: 1.215, Test loss: 1.227, Test accuracy: 54.54
Round  55, Global train loss: 1.215, Global test loss: 2.463, Global test accuracy: 14.13
Round  56, Train loss: 1.265, Test loss: 1.233, Test accuracy: 54.21
Round  56, Global train loss: 1.265, Global test loss: 2.444, Global test accuracy: 15.49
Round  57, Train loss: 1.255, Test loss: 1.231, Test accuracy: 53.86
Round  57, Global train loss: 1.255, Global test loss: 2.620, Global test accuracy: 14.48
Round  58, Train loss: 1.222, Test loss: 1.227, Test accuracy: 54.90
Round  58, Global train loss: 1.222, Global test loss: 2.448, Global test accuracy: 14.73
Round  59, Train loss: 1.213, Test loss: 1.222, Test accuracy: 55.20
Round  59, Global train loss: 1.213, Global test loss: 2.622, Global test accuracy: 14.36
Round  60, Train loss: 1.237, Test loss: 1.237, Test accuracy: 54.53
Round  60, Global train loss: 1.237, Global test loss: 2.506, Global test accuracy: 14.08
Round  61, Train loss: 1.272, Test loss: 1.240, Test accuracy: 54.59
Round  61, Global train loss: 1.272, Global test loss: 2.539, Global test accuracy: 14.10
Round  62, Train loss: 1.080, Test loss: 1.224, Test accuracy: 54.74
Round  62, Global train loss: 1.080, Global test loss: 2.585, Global test accuracy: 13.91
Round  63, Train loss: 1.188, Test loss: 1.243, Test accuracy: 53.47
Round  63, Global train loss: 1.188, Global test loss: 2.704, Global test accuracy: 14.00
Round  64, Train loss: 1.168, Test loss: 1.275, Test accuracy: 52.67
Round  64, Global train loss: 1.168, Global test loss: 2.540, Global test accuracy: 13.84
Round  65, Train loss: 1.187, Test loss: 1.279, Test accuracy: 52.55
Round  65, Global train loss: 1.187, Global test loss: 2.601, Global test accuracy: 13.13
Round  66, Train loss: 1.241, Test loss: 1.285, Test accuracy: 52.28
Round  66, Global train loss: 1.241, Global test loss: 2.615, Global test accuracy: 14.16
Round  67, Train loss: 1.278, Test loss: 1.278, Test accuracy: 52.45
Round  67, Global train loss: 1.278, Global test loss: 2.521, Global test accuracy: 15.32
Round  68, Train loss: 1.165, Test loss: 1.263, Test accuracy: 53.30
Round  68, Global train loss: 1.165, Global test loss: 2.649, Global test accuracy: 14.84
Round  69, Train loss: 1.228, Test loss: 1.253, Test accuracy: 54.39
Round  69, Global train loss: 1.228, Global test loss: 2.604, Global test accuracy: 15.50
Round  70, Train loss: 1.206, Test loss: 1.271, Test accuracy: 53.59
Round  70, Global train loss: 1.206, Global test loss: 2.532, Global test accuracy: 15.14
Round  71, Train loss: 1.012, Test loss: 1.285, Test accuracy: 53.19
Round  71, Global train loss: 1.012, Global test loss: 2.618, Global test accuracy: 14.77
Round  72, Train loss: 1.147, Test loss: 1.290, Test accuracy: 53.23
Round  72, Global train loss: 1.147, Global test loss: 2.632, Global test accuracy: 14.06
Round  73, Train loss: 1.151, Test loss: 1.302, Test accuracy: 53.19
Round  73, Global train loss: 1.151, Global test loss: 2.745, Global test accuracy: 13.89
Round  74, Train loss: 1.239, Test loss: 1.310, Test accuracy: 53.37
Round  74, Global train loss: 1.239, Global test loss: 2.819, Global test accuracy: 14.28
Round  75, Train loss: 1.139, Test loss: 1.312, Test accuracy: 53.38
Round  75, Global train loss: 1.139, Global test loss: 2.617, Global test accuracy: 14.94
Round  76, Train loss: 1.070, Test loss: 1.334, Test accuracy: 53.04
Round  76, Global train loss: 1.070, Global test loss: 2.682, Global test accuracy: 14.31
Round  77, Train loss: 1.107, Test loss: 1.322, Test accuracy: 52.85
Round  77, Global train loss: 1.107, Global test loss: 2.810, Global test accuracy: 14.06
Round  78, Train loss: 1.074, Test loss: 1.334, Test accuracy: 52.40
Round  78, Global train loss: 1.074, Global test loss: 2.699, Global test accuracy: 14.41
Round  79, Train loss: 1.066, Test loss: 1.359, Test accuracy: 51.92
Round  79, Global train loss: 1.066, Global test loss: 2.657, Global test accuracy: 14.42
Round  80, Train loss: 1.126, Test loss: 1.353, Test accuracy: 51.83
Round  80, Global train loss: 1.126, Global test loss: 2.776, Global test accuracy: 12.98
Round  81, Train loss: 1.127, Test loss: 1.346, Test accuracy: 51.40
Round  81, Global train loss: 1.127, Global test loss: 2.696, Global test accuracy: 13.33
Round  82, Train loss: 1.168, Test loss: 1.353, Test accuracy: 50.73
Round  82, Global train loss: 1.168, Global test loss: 2.823, Global test accuracy: 13.74
Round  83, Train loss: 1.119, Test loss: 1.334, Test accuracy: 51.39
Round  83, Global train loss: 1.119, Global test loss: 2.659, Global test accuracy: 13.95
Round  84, Train loss: 1.177, Test loss: 1.331, Test accuracy: 52.01
Round  84, Global train loss: 1.177, Global test loss: 2.703, Global test accuracy: 13.80
Round  85, Train loss: 1.146, Test loss: 1.339, Test accuracy: 52.15
Round  85, Global train loss: 1.146, Global test loss: 2.650, Global test accuracy: 13.55
Round  86, Train loss: 1.050, Test loss: 1.371, Test accuracy: 51.93
Round  86, Global train loss: 1.050, Global test loss: 2.848, Global test accuracy: 13.56
Round  87, Train loss: 1.035, Test loss: 1.367, Test accuracy: 51.49
Round  87, Global train loss: 1.035, Global test loss: 2.885, Global test accuracy: 13.71
Round  88, Train loss: 1.065, Test loss: 1.364, Test accuracy: 52.21
Round  88, Global train loss: 1.065, Global test loss: 2.798, Global test accuracy: 14.05
Round  89, Train loss: 1.027, Test loss: 1.378, Test accuracy: 52.20
Round  89, Global train loss: 1.027, Global test loss: 2.835, Global test accuracy: 13.72
Round  90, Train loss: 0.927, Test loss: 1.397, Test accuracy: 51.62
Round  90, Global train loss: 0.927, Global test loss: 3.043, Global test accuracy: 13.76
Round  91, Train loss: 1.153, Test loss: 1.425, Test accuracy: 51.46
Round  91, Global train loss: 1.153, Global test loss: 2.837, Global test accuracy: 12.80/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  92, Train loss: 1.031, Test loss: 1.426, Test accuracy: 51.72
Round  92, Global train loss: 1.031, Global test loss: 2.860, Global test accuracy: 13.66
Round  93, Train loss: 1.016, Test loss: 1.438, Test accuracy: 50.99
Round  93, Global train loss: 1.016, Global test loss: 2.875, Global test accuracy: 13.26
Round  94, Train loss: 1.075, Test loss: 1.435, Test accuracy: 50.56
Round  94, Global train loss: 1.075, Global test loss: 2.829, Global test accuracy: 15.22
Round  95, Train loss: 1.026, Test loss: 1.456, Test accuracy: 50.55
Round  95, Global train loss: 1.026, Global test loss: 2.971, Global test accuracy: 13.62
Round  96, Train loss: 0.938, Test loss: 1.472, Test accuracy: 50.00
Round  96, Global train loss: 0.938, Global test loss: 2.874, Global test accuracy: 13.58
Round  97, Train loss: 0.834, Test loss: 1.476, Test accuracy: 50.11
Round  97, Global train loss: 0.834, Global test loss: 2.925, Global test accuracy: 13.67
Round  98, Train loss: 0.920, Test loss: 1.460, Test accuracy: 50.85
Round  98, Global train loss: 0.920, Global test loss: 3.010, Global test accuracy: 14.08
Round  99, Train loss: 1.006, Test loss: 1.493, Test accuracy: 50.17
Round  99, Global train loss: 1.006, Global test loss: 2.829, Global test accuracy: 13.82
Final Round, Train loss: 0.846, Test loss: 1.617, Test accuracy: 50.43
Final Round, Global train loss: 0.846, Global test loss: 2.829, Global test accuracy: 13.82
Average accuracy final 10 rounds: 50.803000000000004 

Average global accuracy final 10 rounds: 13.747 

1514.740309715271
[1.4867711067199707, 2.9735422134399414, 4.204599142074585, 5.4356560707092285, 6.6724371910095215, 7.9092183113098145, 9.149323225021362, 10.38942813873291, 11.67224669456482, 12.955065250396729, 14.272031307220459, 15.58899736404419, 16.882265090942383, 18.175532817840576, 19.465564012527466, 20.755595207214355, 22.063576698303223, 23.37155818939209, 24.671671152114868, 25.971784114837646, 27.31607484817505, 28.66036558151245, 29.95481038093567, 31.249255180358887, 32.55522632598877, 33.86119747161865, 35.16222596168518, 36.46325445175171, 37.759820222854614, 39.05638599395752, 40.37240648269653, 41.68842697143555, 42.98736548423767, 44.286303997039795, 45.604045391082764, 46.92178678512573, 48.22058987617493, 49.51939296722412, 50.81351351737976, 52.1076340675354, 53.397894620895386, 54.68815517425537, 56.02466821670532, 57.36118125915527, 58.68351912498474, 60.00585699081421, 61.337695598602295, 62.66953420639038, 63.990798473358154, 65.31206274032593, 66.63358569145203, 67.95510864257812, 69.26920461654663, 70.58330059051514, 71.88798260688782, 73.1926646232605, 74.49313020706177, 75.79359579086304, 77.0980818271637, 78.40256786346436, 79.70760321617126, 81.01263856887817, 82.30476379394531, 83.59688901901245, 84.89273524284363, 86.1885814666748, 87.48072123527527, 88.77286100387573, 90.0893714427948, 91.40588188171387, 92.70112252235413, 93.99636316299438, 95.2837586402893, 96.57115411758423, 97.86494302749634, 99.15873193740845, 100.46871709823608, 101.77870225906372, 103.07131004333496, 104.3639178276062, 105.65819454193115, 106.9524712562561, 108.24302363395691, 109.53357601165771, 110.82338762283325, 112.11319923400879, 113.42582750320435, 114.7384557723999, 116.0302369594574, 117.32201814651489, 118.61927199363708, 119.91652584075928, 121.20076823234558, 122.48501062393188, 123.76805353164673, 125.05109643936157, 126.34318828582764, 127.6352801322937, 128.94449257850647, 130.25370502471924, 131.5569531917572, 132.86020135879517, 134.14927339553833, 135.4383454322815, 136.74034190177917, 138.04233837127686, 139.33112812042236, 140.61991786956787, 141.9178602695465, 143.21580266952515, 144.50167751312256, 145.78755235671997, 147.08315682411194, 148.3787612915039, 149.67359447479248, 150.96842765808105, 152.2644169330597, 153.56040620803833, 154.8660924434662, 156.17177867889404, 157.47175073623657, 158.7717227935791, 160.0769600868225, 161.38219738006592, 162.67953062057495, 163.97686386108398, 165.29532146453857, 166.61377906799316, 167.8942277431488, 169.17467641830444, 170.45610785484314, 171.73753929138184, 173.01937794685364, 174.30121660232544, 175.57913279533386, 176.85704898834229, 178.1313819885254, 179.4057149887085, 180.69067668914795, 181.9756383895874, 183.27763533592224, 184.57963228225708, 185.8653528690338, 187.15107345581055, 188.4369924068451, 189.72291135787964, 191.0259575843811, 192.32900381088257, 193.61102604866028, 194.893048286438, 196.17788219451904, 197.4627161026001, 198.76996874809265, 200.0772213935852, 201.3744261264801, 202.671630859375, 203.9747714996338, 205.27791213989258, 206.56917643547058, 207.86044073104858, 209.1782283782959, 210.4960160255432, 211.79996156692505, 213.10390710830688, 214.3889718055725, 215.67403650283813, 216.9630470275879, 218.25205755233765, 219.54881525039673, 220.8455729484558, 222.13698530197144, 223.42839765548706, 224.7215507030487, 226.01470375061035, 227.30406761169434, 228.59343147277832, 229.87468647956848, 231.15594148635864, 232.43576908111572, 233.7155966758728, 235.00283122062683, 236.29006576538086, 237.56342148780823, 238.8367772102356, 240.10986161231995, 241.3829460144043, 242.64970564842224, 243.91646528244019, 245.1718966960907, 246.4273281097412, 247.5439383983612, 248.6605486869812, 249.76866340637207, 250.87677812576294, 251.9884238243103, 253.10006952285767, 254.21577858924866, 255.33148765563965, 256.4498698711395, 257.5682520866394, 259.79921889305115, 262.0301856994629]
[13.69, 13.69, 20.49, 20.49, 25.21, 25.21, 30.65, 30.65, 37.12, 37.12, 37.84, 37.84, 40.85, 40.85, 42.06, 42.06, 44.41, 44.41, 46.08, 46.08, 46.21, 46.21, 46.58, 46.58, 48.02, 48.02, 48.99, 48.99, 49.15, 49.15, 49.5, 49.5, 50.19, 50.19, 50.4, 50.4, 51.52, 51.52, 50.71, 50.71, 51.39, 51.39, 51.95, 51.95, 52.17, 52.17, 52.58, 52.58, 53.17, 53.17, 53.58, 53.58, 53.49, 53.49, 54.14, 54.14, 54.81, 54.81, 54.58, 54.58, 54.39, 54.39, 54.43, 54.43, 54.92, 54.92, 55.04, 55.04, 54.27, 54.27, 54.26, 54.26, 54.4, 54.4, 54.36, 54.36, 53.94, 53.94, 53.82, 53.82, 53.58, 53.58, 53.28, 53.28, 54.29, 54.29, 54.61, 54.61, 54.2, 54.2, 54.18, 54.18, 54.23, 54.23, 53.65, 53.65, 53.75, 53.75, 54.09, 54.09, 55.01, 55.01, 54.89, 54.89, 54.52, 54.52, 53.83, 53.83, 53.8, 53.8, 54.54, 54.54, 54.21, 54.21, 53.86, 53.86, 54.9, 54.9, 55.2, 55.2, 54.53, 54.53, 54.59, 54.59, 54.74, 54.74, 53.47, 53.47, 52.67, 52.67, 52.55, 52.55, 52.28, 52.28, 52.45, 52.45, 53.3, 53.3, 54.39, 54.39, 53.59, 53.59, 53.19, 53.19, 53.23, 53.23, 53.19, 53.19, 53.37, 53.37, 53.38, 53.38, 53.04, 53.04, 52.85, 52.85, 52.4, 52.4, 51.92, 51.92, 51.83, 51.83, 51.4, 51.4, 50.73, 50.73, 51.39, 51.39, 52.01, 52.01, 52.15, 52.15, 51.93, 51.93, 51.49, 51.49, 52.21, 52.21, 52.2, 52.2, 51.62, 51.62, 51.46, 51.46, 51.72, 51.72, 50.99, 50.99, 50.56, 50.56, 50.55, 50.55, 50.0, 50.0, 50.11, 50.11, 50.85, 50.85, 50.17, 50.17, 50.43, 50.43]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.759, Test loss: 2.155, Test accuracy: 15.52
Round   0, Global train loss: 1.759, Global test loss: 2.356, Global test accuracy: 11.31
Round   1, Train loss: 1.685, Test loss: 2.227, Test accuracy: 20.31
Round   1, Global train loss: 1.685, Global test loss: 2.591, Global test accuracy: 11.96
Round   2, Train loss: 1.610, Test loss: 1.909, Test accuracy: 25.87
Round   2, Global train loss: 1.610, Global test loss: 2.375, Global test accuracy: 12.62
Round   3, Train loss: 1.612, Test loss: 1.734, Test accuracy: 30.84
Round   3, Global train loss: 1.612, Global test loss: 2.350, Global test accuracy: 11.88
Round   4, Train loss: 1.634, Test loss: 1.593, Test accuracy: 36.43
Round   4, Global train loss: 1.634, Global test loss: 2.409, Global test accuracy: 11.39
Round   5, Train loss: 1.555, Test loss: 1.537, Test accuracy: 38.94
Round   5, Global train loss: 1.555, Global test loss: 2.398, Global test accuracy: 11.94
Round   6, Train loss: 1.483, Test loss: 1.439, Test accuracy: 42.48
Round   6, Global train loss: 1.483, Global test loss: 2.378, Global test accuracy: 11.61
Round   7, Train loss: 1.387, Test loss: 1.464, Test accuracy: 42.10
Round   7, Global train loss: 1.387, Global test loss: 2.525, Global test accuracy: 12.34
Round   8, Train loss: 1.462, Test loss: 1.421, Test accuracy: 44.26
Round   8, Global train loss: 1.462, Global test loss: 2.417, Global test accuracy: 12.81
Round   9, Train loss: 1.512, Test loss: 1.407, Test accuracy: 45.69
Round   9, Global train loss: 1.512, Global test loss: 2.443, Global test accuracy: 12.28
Round  10, Train loss: 1.497, Test loss: 1.400, Test accuracy: 46.28
Round  10, Global train loss: 1.497, Global test loss: 2.413, Global test accuracy: 13.39
Round  11, Train loss: 1.467, Test loss: 1.413, Test accuracy: 46.49
Round  11, Global train loss: 1.467, Global test loss: 2.527, Global test accuracy: 13.33
Round  12, Train loss: 1.478, Test loss: 1.384, Test accuracy: 48.46
Round  12, Global train loss: 1.478, Global test loss: 2.374, Global test accuracy: 13.11
Round  13, Train loss: 1.468, Test loss: 1.396, Test accuracy: 48.46
Round  13, Global train loss: 1.468, Global test loss: 2.477, Global test accuracy: 12.35
Round  14, Train loss: 1.455, Test loss: 1.385, Test accuracy: 48.51
Round  14, Global train loss: 1.455, Global test loss: 2.445, Global test accuracy: 13.58
Round  15, Train loss: 1.483, Test loss: 1.379, Test accuracy: 49.19
Round  15, Global train loss: 1.483, Global test loss: 2.459, Global test accuracy: 14.91
Round  16, Train loss: 1.523, Test loss: 1.377, Test accuracy: 49.64
Round  16, Global train loss: 1.523, Global test loss: 2.484, Global test accuracy: 12.93
Round  17, Train loss: 1.388, Test loss: 1.383, Test accuracy: 50.04
Round  17, Global train loss: 1.388, Global test loss: 2.457, Global test accuracy: 13.22
Round  18, Train loss: 1.348, Test loss: 1.376, Test accuracy: 49.97
Round  18, Global train loss: 1.348, Global test loss: 2.463, Global test accuracy: 12.54
Round  19, Train loss: 1.426, Test loss: 1.370, Test accuracy: 49.91
Round  19, Global train loss: 1.426, Global test loss: 2.513, Global test accuracy: 12.83
Round  20, Train loss: 1.379, Test loss: 1.363, Test accuracy: 50.58
Round  20, Global train loss: 1.379, Global test loss: 2.467, Global test accuracy: 13.39
Round  21, Train loss: 1.404, Test loss: 1.379, Test accuracy: 50.54
Round  21, Global train loss: 1.404, Global test loss: 2.644, Global test accuracy: 12.88
Round  22, Train loss: 1.331, Test loss: 1.381, Test accuracy: 50.58
Round  22, Global train loss: 1.331, Global test loss: 2.512, Global test accuracy: 12.54
Round  23, Train loss: 1.413, Test loss: 1.381, Test accuracy: 50.89
Round  23, Global train loss: 1.413, Global test loss: 2.677, Global test accuracy: 12.57
Round  24, Train loss: 1.289, Test loss: 1.374, Test accuracy: 51.03
Round  24, Global train loss: 1.289, Global test loss: 2.485, Global test accuracy: 13.32
Round  25, Train loss: 1.331, Test loss: 1.391, Test accuracy: 50.92
Round  25, Global train loss: 1.331, Global test loss: 2.585, Global test accuracy: 13.85
Round  26, Train loss: 1.291, Test loss: 1.369, Test accuracy: 51.45
Round  26, Global train loss: 1.291, Global test loss: 2.682, Global test accuracy: 11.30
Round  27, Train loss: 1.344, Test loss: 1.396, Test accuracy: 50.48
Round  27, Global train loss: 1.344, Global test loss: 2.755, Global test accuracy: 12.60
Round  28, Train loss: 1.245, Test loss: 1.385, Test accuracy: 50.82
Round  28, Global train loss: 1.245, Global test loss: 2.571, Global test accuracy: 12.24
Round  29, Train loss: 1.254, Test loss: 1.381, Test accuracy: 50.78
Round  29, Global train loss: 1.254, Global test loss: 2.686, Global test accuracy: 13.26
Round  30, Train loss: 1.271, Test loss: 1.372, Test accuracy: 50.95
Round  30, Global train loss: 1.271, Global test loss: 2.608, Global test accuracy: 12.96
Round  31, Train loss: 1.283, Test loss: 1.362, Test accuracy: 51.80
Round  31, Global train loss: 1.283, Global test loss: 2.529, Global test accuracy: 13.93
Round  32, Train loss: 1.423, Test loss: 1.353, Test accuracy: 52.74
Round  32, Global train loss: 1.423, Global test loss: 2.492, Global test accuracy: 13.41
Round  33, Train loss: 1.320, Test loss: 1.360, Test accuracy: 52.79
Round  33, Global train loss: 1.320, Global test loss: 2.656, Global test accuracy: 12.37
Round  34, Train loss: 1.171, Test loss: 1.393, Test accuracy: 52.51
Round  34, Global train loss: 1.171, Global test loss: 2.742, Global test accuracy: 12.21
Round  35, Train loss: 1.207, Test loss: 1.379, Test accuracy: 52.11
Round  35, Global train loss: 1.207, Global test loss: 2.631, Global test accuracy: 12.89
Round  36, Train loss: 1.387, Test loss: 1.392, Test accuracy: 51.32
Round  36, Global train loss: 1.387, Global test loss: 2.594, Global test accuracy: 12.24
Round  37, Train loss: 1.241, Test loss: 1.433, Test accuracy: 50.40
Round  37, Global train loss: 1.241, Global test loss: 2.571, Global test accuracy: 13.15
Round  38, Train loss: 1.252, Test loss: 1.414, Test accuracy: 50.71
Round  38, Global train loss: 1.252, Global test loss: 2.687, Global test accuracy: 13.17
Round  39, Train loss: 1.206, Test loss: 1.413, Test accuracy: 50.69
Round  39, Global train loss: 1.206, Global test loss: 2.668, Global test accuracy: 13.48
Round  40, Train loss: 1.289, Test loss: 1.384, Test accuracy: 51.73
Round  40, Global train loss: 1.289, Global test loss: 2.709, Global test accuracy: 12.47
Round  41, Train loss: 1.180, Test loss: 1.399, Test accuracy: 51.93
Round  41, Global train loss: 1.180, Global test loss: 2.679, Global test accuracy: 13.01
Round  42, Train loss: 1.279, Test loss: 1.392, Test accuracy: 51.60
Round  42, Global train loss: 1.279, Global test loss: 2.745, Global test accuracy: 12.31
Round  43, Train loss: 1.127, Test loss: 1.432, Test accuracy: 51.21
Round  43, Global train loss: 1.127, Global test loss: 2.981, Global test accuracy: 13.10
Round  44, Train loss: 1.242, Test loss: 1.432, Test accuracy: 50.85
Round  44, Global train loss: 1.242, Global test loss: 2.746, Global test accuracy: 13.20
Round  45, Train loss: 1.126, Test loss: 1.459, Test accuracy: 50.33
Round  45, Global train loss: 1.126, Global test loss: 2.695, Global test accuracy: 12.38
Round  46, Train loss: 1.231, Test loss: 1.471, Test accuracy: 49.97
Round  46, Global train loss: 1.231, Global test loss: 2.698, Global test accuracy: 13.95
Round  47, Train loss: 1.183, Test loss: 1.473, Test accuracy: 49.68
Round  47, Global train loss: 1.183, Global test loss: 2.743, Global test accuracy: 13.01
Round  48, Train loss: 1.247, Test loss: 1.483, Test accuracy: 49.47
Round  48, Global train loss: 1.247, Global test loss: 2.810, Global test accuracy: 13.59
Round  49, Train loss: 1.246, Test loss: 1.485, Test accuracy: 49.41
Round  49, Global train loss: 1.246, Global test loss: 2.807, Global test accuracy: 13.09
Round  50, Train loss: 1.178, Test loss: 1.457, Test accuracy: 50.04
Round  50, Global train loss: 1.178, Global test loss: 2.647, Global test accuracy: 13.62
Round  51, Train loss: 1.177, Test loss: 1.472, Test accuracy: 50.25
Round  51, Global train loss: 1.177, Global test loss: 2.851, Global test accuracy: 12.98
Round  52, Train loss: 1.164, Test loss: 1.471, Test accuracy: 50.52
Round  52, Global train loss: 1.164, Global test loss: 2.883, Global test accuracy: 12.60
Round  53, Train loss: 1.105, Test loss: 1.496, Test accuracy: 50.04
Round  53, Global train loss: 1.105, Global test loss: 2.831, Global test accuracy: 13.01
Round  54, Train loss: 1.058, Test loss: 1.527, Test accuracy: 49.99
Round  54, Global train loss: 1.058, Global test loss: 3.024, Global test accuracy: 12.01
Round  55, Train loss: 1.213, Test loss: 1.534, Test accuracy: 49.46
Round  55, Global train loss: 1.213, Global test loss: 2.789, Global test accuracy: 13.16
Round  56, Train loss: 1.151, Test loss: 1.540, Test accuracy: 49.46
Round  56, Global train loss: 1.151, Global test loss: 2.951, Global test accuracy: 12.83
Round  57, Train loss: 1.027, Test loss: 1.527, Test accuracy: 50.31
Round  57, Global train loss: 1.027, Global test loss: 2.964, Global test accuracy: 12.58
Round  58, Train loss: 1.172, Test loss: 1.573, Test accuracy: 49.74
Round  58, Global train loss: 1.172, Global test loss: 3.009, Global test accuracy: 12.22
Round  59, Train loss: 0.996, Test loss: 1.568, Test accuracy: 50.45
Round  59, Global train loss: 0.996, Global test loss: 2.825, Global test accuracy: 12.80
Round  60, Train loss: 1.115, Test loss: 1.546, Test accuracy: 50.42
Round  60, Global train loss: 1.115, Global test loss: 2.902, Global test accuracy: 12.75
Round  61, Train loss: 1.063, Test loss: 1.520, Test accuracy: 49.64
Round  61, Global train loss: 1.063, Global test loss: 2.935, Global test accuracy: 12.51
Round  62, Train loss: 1.104, Test loss: 1.543, Test accuracy: 49.38
Round  62, Global train loss: 1.104, Global test loss: 2.716, Global test accuracy: 12.93
Round  63, Train loss: 1.123, Test loss: 1.522, Test accuracy: 49.26
Round  63, Global train loss: 1.123, Global test loss: 2.964, Global test accuracy: 12.62
Round  64, Train loss: 1.156, Test loss: 1.533, Test accuracy: 48.89
Round  64, Global train loss: 1.156, Global test loss: 2.805, Global test accuracy: 13.17
Round  65, Train loss: 0.990, Test loss: 1.565, Test accuracy: 48.94
Round  65, Global train loss: 0.990, Global test loss: 2.783, Global test accuracy: 13.21
Round  66, Train loss: 0.965, Test loss: 1.579, Test accuracy: 48.65
Round  66, Global train loss: 0.965, Global test loss: 2.846, Global test accuracy: 12.38
Round  67, Train loss: 1.135, Test loss: 1.544, Test accuracy: 49.50
Round  67, Global train loss: 1.135, Global test loss: 2.848, Global test accuracy: 12.12
Round  68, Train loss: 1.092, Test loss: 1.627, Test accuracy: 48.27
Round  68, Global train loss: 1.092, Global test loss: 3.000, Global test accuracy: 12.77
Round  69, Train loss: 1.137, Test loss: 1.637, Test accuracy: 48.63
Round  69, Global train loss: 1.137, Global test loss: 2.982, Global test accuracy: 13.14
Round  70, Train loss: 1.048, Test loss: 1.645, Test accuracy: 48.60
Round  70, Global train loss: 1.048, Global test loss: 3.084, Global test accuracy: 12.23
Round  71, Train loss: 0.925, Test loss: 1.650, Test accuracy: 48.87
Round  71, Global train loss: 0.925, Global test loss: 3.054, Global test accuracy: 12.86
Round  72, Train loss: 0.969, Test loss: 1.628, Test accuracy: 48.99
Round  72, Global train loss: 0.969, Global test loss: 3.296, Global test accuracy: 11.67
Round  73, Train loss: 0.939, Test loss: 1.617, Test accuracy: 49.43
Round  73, Global train loss: 0.939, Global test loss: 3.095, Global test accuracy: 12.93
Round  74, Train loss: 1.091, Test loss: 1.621, Test accuracy: 49.26
Round  74, Global train loss: 1.091, Global test loss: 3.073, Global test accuracy: 12.04
Round  75, Train loss: 1.068, Test loss: 1.595, Test accuracy: 49.61
Round  75, Global train loss: 1.068, Global test loss: 2.858, Global test accuracy: 14.26
Round  76, Train loss: 0.936, Test loss: 1.625, Test accuracy: 49.53
Round  76, Global train loss: 0.936, Global test loss: 2.938, Global test accuracy: 13.37
Round  77, Train loss: 1.014, Test loss: 1.651, Test accuracy: 49.22
Round  77, Global train loss: 1.014, Global test loss: 3.040, Global test accuracy: 12.47
Round  78, Train loss: 0.832, Test loss: 1.665, Test accuracy: 48.95
Round  78, Global train loss: 0.832, Global test loss: 3.396, Global test accuracy: 12.90
Round  79, Train loss: 1.013, Test loss: 1.678, Test accuracy: 48.58
Round  79, Global train loss: 1.013, Global test loss: 3.002, Global test accuracy: 12.24
Round  80, Train loss: 0.918, Test loss: 1.684, Test accuracy: 48.50
Round  80, Global train loss: 0.918, Global test loss: 3.189, Global test accuracy: 12.20
Round  81, Train loss: 1.073, Test loss: 1.688, Test accuracy: 48.81
Round  81, Global train loss: 1.073, Global test loss: 2.864, Global test accuracy: 13.20
Round  82, Train loss: 1.047, Test loss: 1.650, Test accuracy: 49.46
Round  82, Global train loss: 1.047, Global test loss: 3.065, Global test accuracy: 12.80
Round  83, Train loss: 0.968, Test loss: 1.702, Test accuracy: 48.83
Round  83, Global train loss: 0.968, Global test loss: 3.174, Global test accuracy: 13.19
Round  84, Train loss: 0.959, Test loss: 1.723, Test accuracy: 48.77
Round  84, Global train loss: 0.959, Global test loss: 3.048, Global test accuracy: 12.37
Round  85, Train loss: 0.944, Test loss: 1.730, Test accuracy: 49.31
Round  85, Global train loss: 0.944, Global test loss: 3.163, Global test accuracy: 13.07
Round  86, Train loss: 0.953, Test loss: 1.710, Test accuracy: 49.64
Round  86, Global train loss: 0.953, Global test loss: 3.002, Global test accuracy: 13.15
Round  87, Train loss: 0.936, Test loss: 1.728, Test accuracy: 48.74
Round  87, Global train loss: 0.936, Global test loss: 3.125, Global test accuracy: 12.41
Round  88, Train loss: 0.934, Test loss: 1.726, Test accuracy: 48.97
Round  88, Global train loss: 0.934, Global test loss: 3.253, Global test accuracy: 12.97
Round  89, Train loss: 0.878, Test loss: 1.769, Test accuracy: 48.95
Round  89, Global train loss: 0.878, Global test loss: 3.125, Global test accuracy: 13.43
Round  90, Train loss: 0.778, Test loss: 1.739, Test accuracy: 49.18
Round  90, Global train loss: 0.778, Global test loss: 3.570, Global test accuracy: 12.74
Round  91, Train loss: 0.871, Test loss: 1.742, Test accuracy: 48.64
Round  91, Global train loss: 0.871, Global test loss: 3.225, Global test accuracy: 11.98
Round  92, Train loss: 0.944, Test loss: 1.746, Test accuracy: 48.18
Round  92, Global train loss: 0.944, Global test loss: 3.101, Global test accuracy: 12.55
Round  93, Train loss: 0.727, Test loss: 1.724, Test accuracy: 48.86
Round  93, Global train loss: 0.727, Global test loss: 3.594, Global test accuracy: 12.50
Round  94, Train loss: 1.038, Test loss: 1.684, Test accuracy: 49.35
Round  94, Global train loss: 1.038, Global test loss: 3.287, Global test accuracy: 13.18
Round  95, Train loss: 0.923, Test loss: 1.710, Test accuracy: 48.98
Round  95, Global train loss: 0.923, Global test loss: 3.250, Global test accuracy: 12.38
Round  96, Train loss: 0.885, Test loss: 1.764, Test accuracy: 47.88
Round  96, Global train loss: 0.885, Global test loss: 3.402, Global test accuracy: 13.43
Round  97, Train loss: 0.765, Test loss: 1.757, Test accuracy: 48.54
Round  97, Global train loss: 0.765, Global test loss: 3.522, Global test accuracy: 13.00
Round  98, Train loss: 0.925, Test loss: 1.760, Test accuracy: 48.54
Round  98, Global train loss: 0.925, Global test loss: 3.229, Global test accuracy: 12.32
Round  99, Train loss: 0.874, Test loss: 1.777, Test accuracy: 48.10
Round  99, Global train loss: 0.874, Global test loss: 3.253, Global test accuracy: 12.74
Final Round, Train loss: 0.686, Test loss: 2.109, Test accuracy: 47.40
Final Round, Global train loss: 0.686, Global test loss: 3.253, Global test accuracy: 12.74
Average accuracy final 10 rounds: 48.625
Average global accuracy final 10 rounds: 12.681999999999999
2218.824121952057
[2.9419894218444824, 5.709357738494873, 8.471925497055054, 11.247835874557495, 14.027467250823975, 16.834057331085205, 19.64201283454895, 22.475564002990723, 25.30363655090332, 28.112748861312866, 30.945231199264526, 33.79111456871033, 36.621124505996704, 39.45401954650879, 42.263915061950684, 45.093661308288574, 47.91223764419556, 50.733657121658325, 53.56615591049194, 56.4220335483551, 59.257031202316284, 62.11636757850647, 64.95432162284851, 67.80517745018005, 70.66278147697449, 73.50742483139038, 76.32456851005554, 79.16577458381653, 81.982248544693, 84.82676386833191, 87.6325192451477, 90.45389223098755, 93.29700541496277, 96.1367564201355, 98.9782202243805, 101.81531763076782, 104.66405534744263, 107.4972198009491, 110.3253800868988, 113.16150236129761, 115.98642802238464, 118.80679178237915, 121.6250352859497, 124.41605854034424, 127.21486735343933, 130.03471899032593, 132.85672616958618, 135.65790247917175, 138.50094866752625, 141.34885263442993, 144.19811844825745, 147.0434923171997, 149.8786482810974, 152.72020745277405, 155.551438331604, 158.38326382637024, 161.15040802955627, 163.80167198181152, 166.57946228981018, 169.35440874099731, 172.13710832595825, 174.92232084274292, 177.70303583145142, 180.48012924194336, 183.269846200943, 186.06036853790283, 188.83921360969543, 191.61857438087463, 194.39064145088196, 197.17380380630493, 199.94915890693665, 202.78277206420898, 205.58716559410095, 208.4157965183258, 211.2450680732727, 214.09179782867432, 216.92828965187073, 219.76116514205933, 222.59826636314392, 225.4317696094513, 228.26824283599854, 231.08811354637146, 233.9406144618988, 236.77175855636597, 239.5996310710907, 242.43958377838135, 245.26499032974243, 248.09373259544373, 250.55185103416443, 252.9795582294464, 255.43060040473938, 257.87598299980164, 260.29750418663025, 262.7368674278259, 265.1887216567993, 267.62347769737244, 270.0537061691284, 272.48051929473877, 274.9167106151581, 277.3566527366638, 281.6060712337494]
[15.52, 20.31, 25.87, 30.84, 36.43, 38.94, 42.48, 42.1, 44.26, 45.69, 46.28, 46.49, 48.46, 48.46, 48.51, 49.19, 49.64, 50.04, 49.97, 49.91, 50.58, 50.54, 50.58, 50.89, 51.03, 50.92, 51.45, 50.48, 50.82, 50.78, 50.95, 51.8, 52.74, 52.79, 52.51, 52.11, 51.32, 50.4, 50.71, 50.69, 51.73, 51.93, 51.6, 51.21, 50.85, 50.33, 49.97, 49.68, 49.47, 49.41, 50.04, 50.25, 50.52, 50.04, 49.99, 49.46, 49.46, 50.31, 49.74, 50.45, 50.42, 49.64, 49.38, 49.26, 48.89, 48.94, 48.65, 49.5, 48.27, 48.63, 48.6, 48.87, 48.99, 49.43, 49.26, 49.61, 49.53, 49.22, 48.95, 48.58, 48.5, 48.81, 49.46, 48.83, 48.77, 49.31, 49.64, 48.74, 48.97, 48.95, 49.18, 48.64, 48.18, 48.86, 49.35, 48.98, 47.88, 48.54, 48.54, 48.1, 47.4]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  15.5200
Round 1 global test acc  18.9600
Round 2 global test acc  18.9400
Round 3 global test acc  15.9400
Round 4 global test acc  19.6800
Round 5 global test acc  19.8000
Round 6 global test acc  23.4800
Round 7 global test acc  24.5200
Round 8 global test acc  29.0700
Round 9 global test acc  19.4600
Round 10 global test acc  28.0700
Round 11 global test acc  24.5500
Round 12 global test acc  23.2800
Round 13 global test acc  25.9400
Round 14 global test acc  24.9200
Round 15 global test acc  21.7900
Round 16 global test acc  30.9500
Round 17 global test acc  33.7800
Round 18 global test acc  26.2700
Round 19 global test acc  34.0100
Round 20 global test acc  35.8700
Round 21 global test acc  25.8000
Round 22 global test acc  27.4100
Round 23 global test acc  26.9000
Round 24 global test acc  25.3000
Round 25 global test acc  27.0500
Round 26 global test acc  31.8100
Round 27 global test acc  32.4800
Round 28 global test acc  30.2500
Round 29 global test acc  33.1300
Round 30 global test acc  35.4000
Round 31 global test acc  38.4500
Round 32 global test acc  31.1200
Round 33 global test acc  34.0100
Round 34 global test acc  35.9100
Round 35 global test acc  35.3500
Round 36 global test acc  35.4400
Round 37 global test acc  34.6400
Round 38 global test acc  29.1000
Round 39 global test acc  33.1500
Round 40 global test acc  32.4200
Round 41 global test acc  36.3800
Round 42 global test acc  36.2900
Round 43 global test acc  35.5900
Round 44 global test acc  32.3300
Round 45 global test acc  34.1000
Round 46 global test acc  39.2300
Round 47 global test acc  36.0600
Round 48 global test acc  32.8700
Round 49 global test acc  30.6900
Round 50 global test acc  33.9700
Round 51 global test acc  35.2600
Round 52 global test acc  33.5300
Round 53 global test acc  31.0300
Round 54 global test acc  30.0800
Round 55 global test acc  42.8300
Round 56 global test acc  37.7300
Round 57 global test acc  34.2400
Round 58 global test acc  41.3500
Round 59 global test acc  33.2100
Round 60 global test acc  36.1900
Round 61 global test acc  34.6200
Round 62 global test acc  26.6100
Round 63 global test acc  27.3800
Round 64 global test acc  30.7800
Round 65 global test acc  32.0400
Round 66 global test acc  40.2700
Round 67 global test acc  30.2100
Round 68 global test acc  38.7600
Round 69 global test acc  35.7000
Round 70 global test acc  33.9600
Round 71 global test acc  33.7300
Round 72 global test acc  37.8800
Round 73 global test acc  41.2200
Round 74 global test acc  35.4800
Round 75 global test acc  35.6300
Round 76 global test acc  30.8400
Round 77 global test acc  32.4900
Round 78 global test acc  40.7300
Round 79 global test acc  37.2700
Round 80 global test acc  33.8100
Round 81 global test acc  28.2600
Round 82 global test acc  27.8500
Round 83 global test acc  26.0200
Round 84 global test acc  24.5900
Round 85 global test acc  23.9100
Round 86 global test acc  23.2200
Round 87 global test acc  23.1500
Round 88 global test acc  23.1800
Round 89 global test acc  22.7000
Round 90 global test acc  22.1500
Round 91 global test acc  21.7700
Round 92 global test acc  22.0500
Round 93 global test acc  25.9300
Round 94 global test acc  27.5700
Round 95 global test acc  26.2600
Round 96 global test acc  24.9700
Round 97 global test acc  23.4600
Round 98 global test acc  23.0400
Round 99 global test acc  22.4000
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.974, Test loss: 2.310, Test accuracy: 11.36
Round   1, Train loss: 1.705, Test loss: 2.159, Test accuracy: 17.26
Round   2, Train loss: 1.618, Test loss: 2.041, Test accuracy: 19.75
Round   3, Train loss: 1.681, Test loss: 1.818, Test accuracy: 28.14
Round   4, Train loss: 1.653, Test loss: 1.605, Test accuracy: 34.57
Round   5, Train loss: 1.532, Test loss: 1.596, Test accuracy: 33.22
Round   6, Train loss: 1.554, Test loss: 1.540, Test accuracy: 36.80
Round   7, Train loss: 1.507, Test loss: 1.517, Test accuracy: 38.04
Round   8, Train loss: 1.602, Test loss: 1.444, Test accuracy: 39.20
Round   9, Train loss: 1.544, Test loss: 1.410, Test accuracy: 40.75
Round  10, Train loss: 1.563, Test loss: 1.403, Test accuracy: 42.90
Round  11, Train loss: 1.542, Test loss: 1.376, Test accuracy: 44.43
Round  12, Train loss: 1.605, Test loss: 1.357, Test accuracy: 46.38
Round  13, Train loss: 1.478, Test loss: 1.333, Test accuracy: 48.13
Round  14, Train loss: 1.569, Test loss: 1.314, Test accuracy: 49.49
Round  15, Train loss: 1.509, Test loss: 1.312, Test accuracy: 50.41
Round  16, Train loss: 1.476, Test loss: 1.282, Test accuracy: 51.68
Round  17, Train loss: 1.501, Test loss: 1.280, Test accuracy: 53.25
Round  18, Train loss: 1.420, Test loss: 1.241, Test accuracy: 53.54
Round  19, Train loss: 1.434, Test loss: 1.240, Test accuracy: 54.72
Round  20, Train loss: 1.396, Test loss: 1.212, Test accuracy: 55.47
Round  21, Train loss: 1.399, Test loss: 1.189, Test accuracy: 56.26
Round  22, Train loss: 1.373, Test loss: 1.210, Test accuracy: 56.55
Round  23, Train loss: 1.489, Test loss: 1.202, Test accuracy: 56.06
Round  24, Train loss: 1.479, Test loss: 1.173, Test accuracy: 57.63
Round  25, Train loss: 1.374, Test loss: 1.203, Test accuracy: 57.09
Round  26, Train loss: 1.358, Test loss: 1.171, Test accuracy: 57.90
Round  27, Train loss: 1.301, Test loss: 1.171, Test accuracy: 58.03
Round  28, Train loss: 1.391, Test loss: 1.155, Test accuracy: 60.11
Round  29, Train loss: 1.356, Test loss: 1.156, Test accuracy: 59.69
Round  30, Train loss: 1.346, Test loss: 1.123, Test accuracy: 60.45
Round  31, Train loss: 1.430, Test loss: 1.155, Test accuracy: 60.32
Round  32, Train loss: 1.442, Test loss: 1.141, Test accuracy: 61.23
Round  33, Train loss: 1.318, Test loss: 1.139, Test accuracy: 61.57
Round  34, Train loss: 1.402, Test loss: 1.125, Test accuracy: 61.34
Round  35, Train loss: 1.372, Test loss: 1.140, Test accuracy: 60.63
Round  36, Train loss: 1.307, Test loss: 1.130, Test accuracy: 61.17
Round  37, Train loss: 1.370, Test loss: 1.112, Test accuracy: 61.91
Round  38, Train loss: 1.275, Test loss: 1.097, Test accuracy: 61.82
Round  39, Train loss: 1.455, Test loss: 1.101, Test accuracy: 62.68
Round  40, Train loss: 1.393, Test loss: 1.082, Test accuracy: 62.93
Round  41, Train loss: 1.385, Test loss: 1.092, Test accuracy: 62.89
Round  42, Train loss: 1.452, Test loss: 1.075, Test accuracy: 63.20
Round  43, Train loss: 1.335, Test loss: 1.080, Test accuracy: 63.14
Round  44, Train loss: 1.487, Test loss: 1.092, Test accuracy: 63.22
Round  45, Train loss: 1.286, Test loss: 1.083, Test accuracy: 63.77
Round  46, Train loss: 1.480, Test loss: 1.105, Test accuracy: 63.95
Round  47, Train loss: 1.201, Test loss: 1.092, Test accuracy: 64.14
Round  48, Train loss: 1.441, Test loss: 1.117, Test accuracy: 63.80
Round  49, Train loss: 1.425, Test loss: 1.092, Test accuracy: 63.32
Round  50, Train loss: 1.359, Test loss: 1.075, Test accuracy: 63.96
Round  51, Train loss: 1.354, Test loss: 1.076, Test accuracy: 64.05
Round  52, Train loss: 1.330, Test loss: 1.065, Test accuracy: 64.20
Round  53, Train loss: 1.356, Test loss: 1.065, Test accuracy: 63.76
Round  54, Train loss: 1.234, Test loss: 1.050, Test accuracy: 64.90
Round  55, Train loss: 1.387, Test loss: 1.060, Test accuracy: 64.33
Round  56, Train loss: 1.205, Test loss: 1.047, Test accuracy: 64.21
Round  57, Train loss: 1.193, Test loss: 1.025, Test accuracy: 64.26
Round  58, Train loss: 1.211, Test loss: 1.018, Test accuracy: 64.80
Round  59, Train loss: 1.304, Test loss: 1.017, Test accuracy: 64.72
Round  60, Train loss: 1.255, Test loss: 1.031, Test accuracy: 64.82
Round  61, Train loss: 1.250, Test loss: 1.054, Test accuracy: 65.15
Round  62, Train loss: 1.270, Test loss: 1.032, Test accuracy: 64.66
Round  63, Train loss: 1.199, Test loss: 1.034, Test accuracy: 64.97
Round  64, Train loss: 1.282, Test loss: 1.022, Test accuracy: 64.83
Round  65, Train loss: 1.243, Test loss: 1.028, Test accuracy: 64.95
Round  66, Train loss: 1.163, Test loss: 1.004, Test accuracy: 65.35
Round  67, Train loss: 1.292, Test loss: 1.007, Test accuracy: 65.34
Round  68, Train loss: 1.120, Test loss: 1.022, Test accuracy: 65.38
Round  69, Train loss: 1.335, Test loss: 1.019, Test accuracy: 65.05
Round  70, Train loss: 1.174, Test loss: 1.040, Test accuracy: 65.39
Round  71, Train loss: 1.249, Test loss: 1.025, Test accuracy: 64.82
Round  72, Train loss: 1.198, Test loss: 1.027, Test accuracy: 64.74
Round  73, Train loss: 1.305, Test loss: 1.041, Test accuracy: 64.18
Round  74, Train loss: 1.331, Test loss: 1.038, Test accuracy: 64.34
Round  75, Train loss: 1.315, Test loss: 1.040, Test accuracy: 64.54
Round  76, Train loss: 1.167, Test loss: 1.023, Test accuracy: 64.60
Round  77, Train loss: 1.171, Test loss: 1.008, Test accuracy: 65.03
Round  78, Train loss: 1.186, Test loss: 1.002, Test accuracy: 65.00
Round  79, Train loss: 1.097, Test loss: 0.993, Test accuracy: 65.23
Round  80, Train loss: 1.241, Test loss: 0.994, Test accuracy: 65.07
Round  81, Train loss: 1.146, Test loss: 1.009, Test accuracy: 65.19
Round  82, Train loss: 1.200, Test loss: 1.006, Test accuracy: 65.59
Round  83, Train loss: 1.187, Test loss: 0.994, Test accuracy: 65.80
Round  84, Train loss: 1.131, Test loss: 1.001, Test accuracy: 65.33
Round  85, Train loss: 1.153, Test loss: 1.009, Test accuracy: 64.39
Round  86, Train loss: 1.266, Test loss: 1.017, Test accuracy: 64.83
Round  87, Train loss: 1.134, Test loss: 1.010, Test accuracy: 65.26
Round  88, Train loss: 1.115, Test loss: 0.995, Test accuracy: 65.45
Round  89, Train loss: 1.104, Test loss: 0.979, Test accuracy: 65.80
Round  90, Train loss: 1.018, Test loss: 0.995, Test accuracy: 65.70
Round  91, Train loss: 1.221, Test loss: 0.989, Test accuracy: 65.36
Round  92, Train loss: 1.101, Test loss: 1.018, Test accuracy: 64.37
Round  93, Train loss: 1.051, Test loss: 0.991, Test accuracy: 65.20
Round  94, Train loss: 1.136, Test loss: 1.016, Test accuracy: 64.17
Round  95, Train loss: 1.096, Test loss: 1.030, Test accuracy: 63.57
Round  96, Train loss: 1.230, Test loss: 1.039, Test accuracy: 62.97
Round  97, Train loss: 1.058, Test loss: 1.013, Test accuracy: 64.13
Round  98, Train loss: 1.067, Test loss: 1.023, Test accuracy: 63.80
Round  99, Train loss: 1.117, Test loss: 1.011, Test accuracy: 64.50
Final Round, Train loss: 1.043, Test loss: 1.012, Test accuracy: 63.57
Average accuracy final 10 rounds: 64.377
1002.6550900936127
[1.6209332942962646, 3.0376224517822266, 4.242472410202026, 5.43743371963501, 6.643065452575684, 7.838720083236694, 9.045801639556885, 10.240150213241577, 11.4467453956604, 12.797494888305664, 14.006566047668457, 15.208514928817749, 16.420254945755005, 17.61182165145874, 18.81969952583313, 20.0297269821167, 21.237862586975098, 22.437330722808838, 23.64322805404663, 24.843958854675293, 26.049752950668335, 27.245312452316284, 28.44761562347412, 29.651368141174316, 30.846881866455078, 32.04674983024597, 33.2440299987793, 34.446368932724, 35.64818620681763, 36.84938335418701, 38.056130170822144, 39.26655459403992, 40.462862491607666, 41.665868282318115, 42.85580086708069, 44.054150342941284, 45.24542045593262, 46.45105576515198, 47.64090061187744, 48.84734296798706, 50.09364342689514, 51.297691106796265, 52.49726366996765, 53.70130372047424, 54.90399718284607, 56.11322331428528, 57.324461698532104, 58.52651238441467, 59.734901666641235, 60.93569731712341, 62.141809940338135, 63.34106230735779, 64.53676271438599, 65.73691082000732, 66.93407320976257, 68.13394236564636, 69.33793449401855, 70.52801537513733, 71.7328634262085, 72.92777132987976, 74.12647986412048, 75.31628823280334, 76.52238130569458, 77.72009563446045, 78.91751384735107, 80.1190538406372, 81.3312771320343, 82.53688526153564, 83.73287463188171, 84.92987537384033, 86.1358711719513, 87.33282041549683, 88.53071284294128, 89.72758030891418, 90.92896819114685, 92.13459634780884, 93.33728194236755, 94.54228115081787, 95.7348985671997, 96.93334078788757, 98.13482189178467, 99.34980201721191, 100.54697060585022, 101.75112700462341, 102.94017481803894, 104.14957737922668, 105.3532862663269, 106.56228399276733, 107.77069163322449, 108.98199272155762, 110.18698358535767, 111.38414359092712, 112.57341527938843, 113.78337526321411, 114.99376130104065, 116.20653486251831, 117.41591572761536, 118.63312888145447, 119.83324337005615, 121.03849840164185, 123.02027440071106]
[11.36, 17.26, 19.75, 28.14, 34.57, 33.22, 36.8, 38.04, 39.2, 40.75, 42.9, 44.43, 46.38, 48.13, 49.49, 50.41, 51.68, 53.25, 53.54, 54.72, 55.47, 56.26, 56.55, 56.06, 57.63, 57.09, 57.9, 58.03, 60.11, 59.69, 60.45, 60.32, 61.23, 61.57, 61.34, 60.63, 61.17, 61.91, 61.82, 62.68, 62.93, 62.89, 63.2, 63.14, 63.22, 63.77, 63.95, 64.14, 63.8, 63.32, 63.96, 64.05, 64.2, 63.76, 64.9, 64.33, 64.21, 64.26, 64.8, 64.72, 64.82, 65.15, 64.66, 64.97, 64.83, 64.95, 65.35, 65.34, 65.38, 65.05, 65.39, 64.82, 64.74, 64.18, 64.34, 64.54, 64.6, 65.03, 65.0, 65.23, 65.07, 65.19, 65.59, 65.8, 65.33, 64.39, 64.83, 65.26, 65.45, 65.8, 65.7, 65.36, 64.37, 65.2, 64.17, 63.57, 62.97, 64.13, 63.8, 64.5, 63.57]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.788, Test loss: 2.104, Test accuracy: 19.39
Round   0, Global train loss: 1.788, Global test loss: 2.286, Global test accuracy: 14.94
Round   1, Train loss: 1.648, Test loss: 2.086, Test accuracy: 21.89
Round   1, Global train loss: 1.648, Global test loss: 2.468, Global test accuracy: 13.00
Round   2, Train loss: 1.692, Test loss: 1.846, Test accuracy: 26.20
Round   2, Global train loss: 1.692, Global test loss: 2.310, Global test accuracy: 15.00
Round   3, Train loss: 1.587, Test loss: 1.717, Test accuracy: 30.99
Round   3, Global train loss: 1.587, Global test loss: 2.331, Global test accuracy: 13.28
Round   4, Train loss: 1.659, Test loss: 1.516, Test accuracy: 36.18
Round   4, Global train loss: 1.659, Global test loss: 2.284, Global test accuracy: 14.31
Round   5, Train loss: 1.599, Test loss: 1.501, Test accuracy: 38.36
Round   5, Global train loss: 1.599, Global test loss: 2.420, Global test accuracy: 15.76
Round   6, Train loss: 1.632, Test loss: 1.440, Test accuracy: 40.31
Round   6, Global train loss: 1.632, Global test loss: 2.370, Global test accuracy: 14.97
Round   7, Train loss: 1.515, Test loss: 1.415, Test accuracy: 40.90
Round   7, Global train loss: 1.515, Global test loss: 2.387, Global test accuracy: 15.00
Round   8, Train loss: 1.607, Test loss: 1.361, Test accuracy: 43.66
Round   8, Global train loss: 1.607, Global test loss: 2.348, Global test accuracy: 15.24
Round   9, Train loss: 1.596, Test loss: 1.335, Test accuracy: 45.06
Round   9, Global train loss: 1.596, Global test loss: 2.307, Global test accuracy: 15.06
Round  10, Train loss: 1.574, Test loss: 1.336, Test accuracy: 45.22
Round  10, Global train loss: 1.574, Global test loss: 2.301, Global test accuracy: 14.61
Round  11, Train loss: 1.485, Test loss: 1.322, Test accuracy: 46.05
Round  11, Global train loss: 1.485, Global test loss: 2.346, Global test accuracy: 14.26
Round  12, Train loss: 1.495, Test loss: 1.296, Test accuracy: 48.28
Round  12, Global train loss: 1.495, Global test loss: 2.408, Global test accuracy: 14.72
Round  13, Train loss: 1.568, Test loss: 1.289, Test accuracy: 48.43
Round  13, Global train loss: 1.568, Global test loss: 2.382, Global test accuracy: 13.95
Round  14, Train loss: 1.474, Test loss: 1.277, Test accuracy: 49.22
Round  14, Global train loss: 1.474, Global test loss: 2.286, Global test accuracy: 14.43
Round  15, Train loss: 1.467, Test loss: 1.248, Test accuracy: 50.24
Round  15, Global train loss: 1.467, Global test loss: 2.362, Global test accuracy: 13.80
Round  16, Train loss: 1.547, Test loss: 1.237, Test accuracy: 50.91
Round  16, Global train loss: 1.547, Global test loss: 2.440, Global test accuracy: 14.24
Round  17, Train loss: 1.455, Test loss: 1.244, Test accuracy: 51.16
Round  17, Global train loss: 1.455, Global test loss: 2.391, Global test accuracy: 13.45
Round  18, Train loss: 1.497, Test loss: 1.226, Test accuracy: 52.77
Round  18, Global train loss: 1.497, Global test loss: 2.313, Global test accuracy: 13.49
Round  19, Train loss: 1.474, Test loss: 1.235, Test accuracy: 52.48
Round  19, Global train loss: 1.474, Global test loss: 2.428, Global test accuracy: 14.63
Round  20, Train loss: 1.474, Test loss: 1.231, Test accuracy: 53.09
Round  20, Global train loss: 1.474, Global test loss: 2.347, Global test accuracy: 15.16
Round  21, Train loss: 1.481, Test loss: 1.226, Test accuracy: 53.89
Round  21, Global train loss: 1.481, Global test loss: 2.348, Global test accuracy: 15.84
Round  22, Train loss: 1.381, Test loss: 1.227, Test accuracy: 52.85
Round  22, Global train loss: 1.381, Global test loss: 2.413, Global test accuracy: 15.91
Round  23, Train loss: 1.526, Test loss: 1.207, Test accuracy: 53.34
Round  23, Global train loss: 1.526, Global test loss: 2.267, Global test accuracy: 15.96
Round  24, Train loss: 1.349, Test loss: 1.212, Test accuracy: 53.21
Round  24, Global train loss: 1.349, Global test loss: 2.341, Global test accuracy: 15.20
Round  25, Train loss: 1.313, Test loss: 1.216, Test accuracy: 53.04
Round  25, Global train loss: 1.313, Global test loss: 2.464, Global test accuracy: 15.45
Round  26, Train loss: 1.447, Test loss: 1.216, Test accuracy: 52.49
Round  26, Global train loss: 1.447, Global test loss: 2.519, Global test accuracy: 14.32
Round  27, Train loss: 1.421, Test loss: 1.209, Test accuracy: 52.37
Round  27, Global train loss: 1.421, Global test loss: 2.440, Global test accuracy: 14.28
Round  28, Train loss: 1.417, Test loss: 1.214, Test accuracy: 52.33
Round  28, Global train loss: 1.417, Global test loss: 2.330, Global test accuracy: 14.82
Round  29, Train loss: 1.342, Test loss: 1.220, Test accuracy: 52.08
Round  29, Global train loss: 1.342, Global test loss: 2.526, Global test accuracy: 14.69
Round  30, Train loss: 1.357, Test loss: 1.208, Test accuracy: 53.07
Round  30, Global train loss: 1.357, Global test loss: 2.470, Global test accuracy: 15.89
Round  31, Train loss: 1.356, Test loss: 1.200, Test accuracy: 53.45
Round  31, Global train loss: 1.356, Global test loss: 2.369, Global test accuracy: 14.44
Round  32, Train loss: 1.427, Test loss: 1.200, Test accuracy: 53.34
Round  32, Global train loss: 1.427, Global test loss: 2.482, Global test accuracy: 12.75
Round  33, Train loss: 1.355, Test loss: 1.199, Test accuracy: 53.16
Round  33, Global train loss: 1.355, Global test loss: 2.386, Global test accuracy: 14.23
Round  34, Train loss: 1.259, Test loss: 1.193, Test accuracy: 53.69
Round  34, Global train loss: 1.259, Global test loss: 2.464, Global test accuracy: 14.71
Round  35, Train loss: 1.406, Test loss: 1.212, Test accuracy: 52.59
Round  35, Global train loss: 1.406, Global test loss: 2.396, Global test accuracy: 12.96
Round  36, Train loss: 1.438, Test loss: 1.204, Test accuracy: 52.91
Round  36, Global train loss: 1.438, Global test loss: 2.377, Global test accuracy: 13.73
Round  37, Train loss: 1.302, Test loss: 1.202, Test accuracy: 53.33
Round  37, Global train loss: 1.302, Global test loss: 2.345, Global test accuracy: 14.47
Round  38, Train loss: 1.295, Test loss: 1.199, Test accuracy: 53.40
Round  38, Global train loss: 1.295, Global test loss: 2.549, Global test accuracy: 14.18
Round  39, Train loss: 1.436, Test loss: 1.192, Test accuracy: 54.61
Round  39, Global train loss: 1.436, Global test loss: 2.446, Global test accuracy: 14.33
Round  40, Train loss: 1.353, Test loss: 1.200, Test accuracy: 54.35
Round  40, Global train loss: 1.353, Global test loss: 2.425, Global test accuracy: 13.37
Round  41, Train loss: 1.342, Test loss: 1.187, Test accuracy: 54.81
Round  41, Global train loss: 1.342, Global test loss: 2.471, Global test accuracy: 12.37
Round  42, Train loss: 1.294, Test loss: 1.190, Test accuracy: 54.49
Round  42, Global train loss: 1.294, Global test loss: 2.407, Global test accuracy: 14.42
Round  43, Train loss: 1.331, Test loss: 1.199, Test accuracy: 54.60
Round  43, Global train loss: 1.331, Global test loss: 2.477, Global test accuracy: 14.13
Round  44, Train loss: 1.353, Test loss: 1.207, Test accuracy: 54.65
Round  44, Global train loss: 1.353, Global test loss: 2.448, Global test accuracy: 14.21
Round  45, Train loss: 1.112, Test loss: 1.202, Test accuracy: 55.12
Round  45, Global train loss: 1.112, Global test loss: 2.572, Global test accuracy: 15.72
Round  46, Train loss: 1.249, Test loss: 1.201, Test accuracy: 55.32
Round  46, Global train loss: 1.249, Global test loss: 2.487, Global test accuracy: 14.55
Round  47, Train loss: 1.267, Test loss: 1.206, Test accuracy: 55.05
Round  47, Global train loss: 1.267, Global test loss: 2.492, Global test accuracy: 14.98
Round  48, Train loss: 1.307, Test loss: 1.212, Test accuracy: 54.53
Round  48, Global train loss: 1.307, Global test loss: 2.515, Global test accuracy: 13.83
Round  49, Train loss: 1.185, Test loss: 1.220, Test accuracy: 53.73
Round  49, Global train loss: 1.185, Global test loss: 2.453, Global test accuracy: 14.75
Round  50, Train loss: 1.287, Test loss: 1.229, Test accuracy: 53.71
Round  50, Global train loss: 1.287, Global test loss: 2.525, Global test accuracy: 13.65
Round  51, Train loss: 1.126, Test loss: 1.227, Test accuracy: 54.14
Round  51, Global train loss: 1.126, Global test loss: 2.761, Global test accuracy: 14.47
Round  52, Train loss: 1.240, Test loss: 1.232, Test accuracy: 54.63
Round  52, Global train loss: 1.240, Global test loss: 2.716, Global test accuracy: 13.60
Round  53, Train loss: 1.207, Test loss: 1.237, Test accuracy: 54.35
Round  53, Global train loss: 1.207, Global test loss: 2.458, Global test accuracy: 15.02
Round  54, Train loss: 1.265, Test loss: 1.264, Test accuracy: 53.41
Round  54, Global train loss: 1.265, Global test loss: 2.648, Global test accuracy: 14.58
Round  55, Train loss: 1.054, Test loss: 1.263, Test accuracy: 53.23
Round  55, Global train loss: 1.054, Global test loss: 2.586, Global test accuracy: 15.03
Round  56, Train loss: 1.151, Test loss: 1.251, Test accuracy: 53.21
Round  56, Global train loss: 1.151, Global test loss: 2.649, Global test accuracy: 14.26
Round  57, Train loss: 1.257, Test loss: 1.257, Test accuracy: 53.13
Round  57, Global train loss: 1.257, Global test loss: 2.642, Global test accuracy: 13.75
Round  58, Train loss: 1.188, Test loss: 1.240, Test accuracy: 53.28
Round  58, Global train loss: 1.188, Global test loss: 2.652, Global test accuracy: 14.18
Round  59, Train loss: 1.184, Test loss: 1.241, Test accuracy: 53.26
Round  59, Global train loss: 1.184, Global test loss: 2.545, Global test accuracy: 15.06
Round  60, Train loss: 1.138, Test loss: 1.246, Test accuracy: 53.15
Round  60, Global train loss: 1.138, Global test loss: 2.567, Global test accuracy: 15.43
Round  61, Train loss: 1.061, Test loss: 1.267, Test accuracy: 52.79
Round  61, Global train loss: 1.061, Global test loss: 2.767, Global test accuracy: 14.40
Round  62, Train loss: 1.153, Test loss: 1.273, Test accuracy: 53.32
Round  62, Global train loss: 1.153, Global test loss: 2.562, Global test accuracy: 14.51
Round  63, Train loss: 1.097, Test loss: 1.295, Test accuracy: 52.78
Round  63, Global train loss: 1.097, Global test loss: 2.680, Global test accuracy: 15.04
Round  64, Train loss: 1.123, Test loss: 1.309, Test accuracy: 52.62
Round  64, Global train loss: 1.123, Global test loss: 2.621, Global test accuracy: 14.72
Round  65, Train loss: 1.159, Test loss: 1.304, Test accuracy: 53.16
Round  65, Global train loss: 1.159, Global test loss: 2.625, Global test accuracy: 14.23
Round  66, Train loss: 1.150, Test loss: 1.289, Test accuracy: 53.40
Round  66, Global train loss: 1.150, Global test loss: 2.698, Global test accuracy: 15.33
Round  67, Train loss: 1.011, Test loss: 1.295, Test accuracy: 53.22
Round  67, Global train loss: 1.011, Global test loss: 2.800, Global test accuracy: 14.30
Round  68, Train loss: 1.062, Test loss: 1.302, Test accuracy: 53.05
Round  68, Global train loss: 1.062, Global test loss: 2.650, Global test accuracy: 14.60
Round  69, Train loss: 1.212, Test loss: 1.310, Test accuracy: 53.18
Round  69, Global train loss: 1.212, Global test loss: 2.620, Global test accuracy: 14.67
Round  70, Train loss: 1.082, Test loss: 1.315, Test accuracy: 53.52
Round  70, Global train loss: 1.082, Global test loss: 2.819, Global test accuracy: 14.21
Round  71, Train loss: 1.073, Test loss: 1.329, Test accuracy: 52.82
Round  71, Global train loss: 1.073, Global test loss: 2.736, Global test accuracy: 14.69
Round  72, Train loss: 1.022, Test loss: 1.364, Test accuracy: 52.55
Round  72, Global train loss: 1.022, Global test loss: 2.788, Global test accuracy: 13.67
Round  73, Train loss: 1.037, Test loss: 1.352, Test accuracy: 52.16
Round  73, Global train loss: 1.037, Global test loss: 2.918, Global test accuracy: 14.19
Round  74, Train loss: 0.953, Test loss: 1.349, Test accuracy: 52.44
Round  74, Global train loss: 0.953, Global test loss: 2.891, Global test accuracy: 14.18
Round  75, Train loss: 1.000, Test loss: 1.345, Test accuracy: 52.45
Round  75, Global train loss: 1.000, Global test loss: 2.731, Global test accuracy: 14.31
Round  76, Train loss: 1.017, Test loss: 1.351, Test accuracy: 52.37
Round  76, Global train loss: 1.017, Global test loss: 2.910, Global test accuracy: 14.09
Round  77, Train loss: 0.882, Test loss: 1.375, Test accuracy: 51.93
Round  77, Global train loss: 0.882, Global test loss: 2.877, Global test accuracy: 15.25
Round  78, Train loss: 0.934, Test loss: 1.359, Test accuracy: 52.87
Round  78, Global train loss: 0.934, Global test loss: 3.028, Global test accuracy: 12.98
Round  79, Train loss: 1.001, Test loss: 1.364, Test accuracy: 52.58
Round  79, Global train loss: 1.001, Global test loss: 2.895, Global test accuracy: 13.88
Round  80, Train loss: 1.003, Test loss: 1.365, Test accuracy: 53.07
Round  80, Global train loss: 1.003, Global test loss: 2.995, Global test accuracy: 13.76
Round  81, Train loss: 1.100, Test loss: 1.359, Test accuracy: 53.19
Round  81, Global train loss: 1.100, Global test loss: 2.928, Global test accuracy: 13.99
Round  82, Train loss: 1.140, Test loss: 1.387, Test accuracy: 52.20
Round  82, Global train loss: 1.140, Global test loss: 2.741, Global test accuracy: 14.90
Round  83, Train loss: 1.002, Test loss: 1.411, Test accuracy: 51.31
Round  83, Global train loss: 1.002, Global test loss: 3.056, Global test accuracy: 14.38
Round  84, Train loss: 0.868, Test loss: 1.412, Test accuracy: 51.46
Round  84, Global train loss: 0.868, Global test loss: 3.082, Global test accuracy: 15.64
Round  85, Train loss: 0.952, Test loss: 1.408, Test accuracy: 52.32
Round  85, Global train loss: 0.952, Global test loss: 3.150, Global test accuracy: 14.44
Round  86, Train loss: 1.012, Test loss: 1.432, Test accuracy: 51.57
Round  86, Global train loss: 1.012, Global test loss: 2.911, Global test accuracy: 13.43
Round  87, Train loss: 0.996, Test loss: 1.426, Test accuracy: 52.51
Round  87, Global train loss: 0.996, Global test loss: 3.120, Global test accuracy: 15.01
Round  88, Train loss: 1.023, Test loss: 1.435, Test accuracy: 52.58
Round  88, Global train loss: 1.023, Global test loss: 3.021, Global test accuracy: 13.44
Round  89, Train loss: 0.939, Test loss: 1.459, Test accuracy: 52.25
Round  89, Global train loss: 0.939, Global test loss: 3.059, Global test accuracy: 15.37
Round  90, Train loss: 0.909, Test loss: 1.478, Test accuracy: 51.88
Round  90, Global train loss: 0.909, Global test loss: 3.248, Global test accuracy: 13.81
Round  91, Train loss: 0.944, Test loss: 1.471, Test accuracy: 52.00
Round  91, Global train loss: 0.944, Global test loss: 3.159, Global test accuracy: 14.37
Round  92, Train loss: 0.930, Test loss: 1.470, Test accuracy: 51.76
Round  92, Global train loss: 0.930, Global test loss: 2.900, Global test accuracy: 14.21
Round  93, Train loss: 0.873, Test loss: 1.497, Test accuracy: 51.20
Round  93, Global train loss: 0.873, Global test loss: 3.039, Global test accuracy: 14.74
Round  94, Train loss: 0.997, Test loss: 1.497, Test accuracy: 51.41
Round  94, Global train loss: 0.997, Global test loss: 2.960, Global test accuracy: 14.48
Round  95, Train loss: 0.870, Test loss: 1.489, Test accuracy: 51.32
Round  95, Global train loss: 0.870, Global test loss: 3.133, Global test accuracy: 14.41
Round  96, Train loss: 0.893, Test loss: 1.500, Test accuracy: 50.97
Round  96, Global train loss: 0.893, Global test loss: 2.958, Global test accuracy: 14.95
Round  97, Train loss: 0.891, Test loss: 1.523, Test accuracy: 50.90
Round  97, Global train loss: 0.891, Global test loss: 3.093, Global test accuracy: 15.50
Round  98, Train loss: 0.805, Test loss: 1.551, Test accuracy: 50.23
Round  98, Global train loss: 0.805, Global test loss: 3.167, Global test accuracy: 15.43
Round  99, Train loss: 0.911, Test loss: 1.543, Test accuracy: 50.56
Round  99, Global train loss: 0.911, Global test loss: 3.278, Global test accuracy: 14.23
Final Round, Train loss: 0.731, Test loss: 1.763, Test accuracy: 49.68
Final Round, Global train loss: 0.731, Global test loss: 3.278, Global test accuracy: 14.23
Average accuracy final 10 rounds: 51.223
Average global accuracy final 10 rounds: 14.613
2045.9722559452057
[1.439875602722168, 2.6026012897491455, 3.7554335594177246, 4.910169839859009, 6.067997455596924, 7.233521938323975, 8.397172689437866, 9.558467864990234, 10.715738773345947, 11.870134115219116, 13.027565956115723, 14.19020962715149, 15.349891901016235, 16.514593362808228, 17.681737661361694, 18.844865560531616, 20.00889229774475, 21.173871517181396, 22.343612670898438, 23.51051664352417, 24.658495664596558, 27.6807963848114, 30.712162733078003, 33.71932291984558, 36.74683928489685, 39.786689043045044, 42.849934339523315, 45.8628134727478, 48.92026138305664, 51.95850133895874, 54.97936701774597, 57.994369983673096, 61.01447606086731, 64.01949954032898, 66.97670888900757, 69.98496389389038, 72.99743342399597, 76.06516623497009, 79.0512204170227, 82.04111528396606, 85.09310626983643, 88.10997462272644, 91.09841585159302, 94.11964106559753, 97.14558267593384, 100.12202978134155, 103.16915583610535, 106.20900249481201, 109.21779274940491, 112.22725582122803, 115.22819542884827, 118.28863739967346, 121.31095123291016, 124.35583424568176, 127.4137122631073, 130.45258140563965, 133.46787548065186, 136.44864296913147, 139.48352670669556, 142.54305505752563, 145.60218119621277, 148.63741493225098, 151.69447803497314, 154.7115080356598, 157.45103788375854, 160.24377298355103, 163.0158064365387, 165.76908540725708, 168.56771039962769, 171.37126421928406, 174.211332321167, 177.01632404327393, 179.86309337615967, 182.7233772277832, 185.52406430244446, 188.3498990535736, 191.17282390594482, 193.96825981140137, 196.7848024368286, 199.6060426235199, 202.44312191009521, 205.2530882358551, 208.28526425361633, 211.295490026474, 214.29111552238464, 217.31468772888184, 220.320467710495, 223.31457614898682, 226.30826544761658, 229.34722661972046, 232.35516500473022, 235.36418271064758, 238.40001368522644, 241.41535210609436, 244.39634203910828, 247.40842247009277, 250.4132068157196, 253.4337809085846, 256.41287326812744, 259.3869836330414, 261.68834590911865]
[19.39, 21.89, 26.2, 30.99, 36.18, 38.36, 40.31, 40.9, 43.66, 45.06, 45.22, 46.05, 48.28, 48.43, 49.22, 50.24, 50.91, 51.16, 52.77, 52.48, 53.09, 53.89, 52.85, 53.34, 53.21, 53.04, 52.49, 52.37, 52.33, 52.08, 53.07, 53.45, 53.34, 53.16, 53.69, 52.59, 52.91, 53.33, 53.4, 54.61, 54.35, 54.81, 54.49, 54.6, 54.65, 55.12, 55.32, 55.05, 54.53, 53.73, 53.71, 54.14, 54.63, 54.35, 53.41, 53.23, 53.21, 53.13, 53.28, 53.26, 53.15, 52.79, 53.32, 52.78, 52.62, 53.16, 53.4, 53.22, 53.05, 53.18, 53.52, 52.82, 52.55, 52.16, 52.44, 52.45, 52.37, 51.93, 52.87, 52.58, 53.07, 53.19, 52.2, 51.31, 51.46, 52.32, 51.57, 52.51, 52.58, 52.25, 51.88, 52.0, 51.76, 51.2, 51.41, 51.32, 50.97, 50.9, 50.23, 50.56, 49.68]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: none, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.661, Test loss: 1.398, Test accuracy: 41.85
Round   0, Global train loss: 1.661, Global test loss: 2.282, Global test accuracy: 13.22
Round   1, Train loss: 1.584, Test loss: 1.334, Test accuracy: 45.82
Round   1, Global train loss: 1.584, Global test loss: 2.273, Global test accuracy: 13.93
Round   2, Train loss: 1.541, Test loss: 1.305, Test accuracy: 48.71
Round   2, Global train loss: 1.541, Global test loss: 2.265, Global test accuracy: 15.04
Round   3, Train loss: 1.508, Test loss: 1.257, Test accuracy: 51.84
Round   3, Global train loss: 1.508, Global test loss: 2.259, Global test accuracy: 15.27
Round   4, Train loss: 1.478, Test loss: 1.225, Test accuracy: 52.22
Round   4, Global train loss: 1.478, Global test loss: 2.257, Global test accuracy: 15.62
Round   5, Train loss: 1.451, Test loss: 1.191, Test accuracy: 53.96
Round   5, Global train loss: 1.451, Global test loss: 2.253, Global test accuracy: 15.95
Round   6, Train loss: 1.426, Test loss: 1.206, Test accuracy: 53.95
Round   6, Global train loss: 1.426, Global test loss: 2.247, Global test accuracy: 16.19
Round   7, Train loss: 1.401, Test loss: 1.198, Test accuracy: 55.39
Round   7, Global train loss: 1.401, Global test loss: 2.245, Global test accuracy: 16.40
Round   8, Train loss: 1.376, Test loss: 1.180, Test accuracy: 54.55
Round   8, Global train loss: 1.376, Global test loss: 2.246, Global test accuracy: 16.23
Round   9, Train loss: 1.352, Test loss: 1.186, Test accuracy: 55.76
Round   9, Global train loss: 1.352, Global test loss: 2.245, Global test accuracy: 16.27
Round  10, Train loss: 1.330, Test loss: 1.194, Test accuracy: 55.01
Round  10, Global train loss: 1.330, Global test loss: 2.372, Global test accuracy: 15.26
Round  11, Train loss: 1.296, Test loss: 1.200, Test accuracy: 54.93
Round  11, Global train loss: 1.296, Global test loss: 2.402, Global test accuracy: 13.82
Round  12, Train loss: 1.308, Test loss: 1.212, Test accuracy: 54.27
Round  12, Global train loss: 1.308, Global test loss: 2.430, Global test accuracy: 14.66
Round  13, Train loss: 1.251, Test loss: 1.202, Test accuracy: 54.35
Round  13, Global train loss: 1.251, Global test loss: 2.462, Global test accuracy: 13.53
Round  14, Train loss: 1.254, Test loss: 1.216, Test accuracy: 54.22
Round  14, Global train loss: 1.254, Global test loss: 2.597, Global test accuracy: 14.26
Round  15, Train loss: 1.177, Test loss: 1.218, Test accuracy: 54.18
Round  15, Global train loss: 1.177, Global test loss: 2.429, Global test accuracy: 15.13
Round  16, Train loss: 1.129, Test loss: 1.253, Test accuracy: 53.49
Round  16, Global train loss: 1.129, Global test loss: 2.634, Global test accuracy: 13.13
Round  17, Train loss: 1.137, Test loss: 1.283, Test accuracy: 52.36
Round  17, Global train loss: 1.137, Global test loss: 2.635, Global test accuracy: 12.98
Round  18, Train loss: 0.994, Test loss: 1.318, Test accuracy: 51.84
Round  18, Global train loss: 0.994, Global test loss: 2.705, Global test accuracy: 14.57
Round  19, Train loss: 1.086, Test loss: 1.372, Test accuracy: 51.05
Round  19, Global train loss: 1.086, Global test loss: 2.784, Global test accuracy: 13.80
Round  20, Train loss: 1.092, Test loss: 1.387, Test accuracy: 51.22
Round  20, Global train loss: 1.092, Global test loss: 2.698, Global test accuracy: 13.98
Round  21, Train loss: 1.143, Test loss: 1.398, Test accuracy: 51.08
Round  21, Global train loss: 1.143, Global test loss: 2.758, Global test accuracy: 12.48
Round  22, Train loss: 0.936, Test loss: 1.438, Test accuracy: 50.30
Round  22, Global train loss: 0.936, Global test loss: 2.876, Global test accuracy: 14.27
Round  23, Train loss: 1.061, Test loss: 1.439, Test accuracy: 50.54
Round  23, Global train loss: 1.061, Global test loss: 2.700, Global test accuracy: 13.45
Round  24, Train loss: 0.966, Test loss: 1.461, Test accuracy: 51.45
Round  24, Global train loss: 0.966, Global test loss: 2.826, Global test accuracy: 15.71
Round  25, Train loss: 0.977, Test loss: 1.477, Test accuracy: 51.55
Round  25, Global train loss: 0.977, Global test loss: 2.933, Global test accuracy: 12.84
Round  26, Train loss: 0.935, Test loss: 1.530, Test accuracy: 50.82
Round  26, Global train loss: 0.935, Global test loss: 2.943, Global test accuracy: 13.90
Round  27, Train loss: 0.871, Test loss: 1.570, Test accuracy: 50.71
Round  27, Global train loss: 0.871, Global test loss: 3.047, Global test accuracy: 13.44
Round  28, Train loss: 0.868, Test loss: 1.581, Test accuracy: 50.56
Round  28, Global train loss: 0.868, Global test loss: 2.962, Global test accuracy: 12.78
Round  29, Train loss: 0.761, Test loss: 1.607, Test accuracy: 50.79
Round  29, Global train loss: 0.761, Global test loss: 3.152, Global test accuracy: 14.48
Round  30, Train loss: 0.951, Test loss: 1.612, Test accuracy: 50.98
Round  30, Global train loss: 0.951, Global test loss: 2.956, Global test accuracy: 14.03
Round  31, Train loss: 0.748, Test loss: 1.644, Test accuracy: 49.98
Round  31, Global train loss: 0.748, Global test loss: 3.458, Global test accuracy: 13.44
Round  32, Train loss: 0.850, Test loss: 1.664, Test accuracy: 49.70
Round  32, Global train loss: 0.850, Global test loss: 3.016, Global test accuracy: 13.19
Round  33, Train loss: 0.847, Test loss: 1.689, Test accuracy: 49.49
Round  33, Global train loss: 0.847, Global test loss: 3.204, Global test accuracy: 12.78
Round  34, Train loss: 0.816, Test loss: 1.737, Test accuracy: 49.16
Round  34, Global train loss: 0.816, Global test loss: 3.277, Global test accuracy: 13.00
Round  35, Train loss: 0.773, Test loss: 1.795, Test accuracy: 48.47
Round  35, Global train loss: 0.773, Global test loss: 3.202, Global test accuracy: 13.00
Round  36, Train loss: 0.884, Test loss: 1.826, Test accuracy: 47.92
Round  36, Global train loss: 0.884, Global test loss: 3.124, Global test accuracy: 13.01
Round  37, Train loss: 0.735, Test loss: 1.849, Test accuracy: 47.62
Round  37, Global train loss: 0.735, Global test loss: 3.174, Global test accuracy: 15.01
Round  38, Train loss: 0.704, Test loss: 1.832, Test accuracy: 48.73
Round  38, Global train loss: 0.704, Global test loss: 3.443, Global test accuracy: 12.66
Round  39, Train loss: 0.692, Test loss: 1.870, Test accuracy: 48.93
Round  39, Global train loss: 0.692, Global test loss: 3.469, Global test accuracy: 13.55
Round  40, Train loss: 0.747, Test loss: 1.925, Test accuracy: 49.24
Round  40, Global train loss: 0.747, Global test loss: 3.437, Global test accuracy: 13.17
Round  41, Train loss: 0.662, Test loss: 1.914, Test accuracy: 50.26
Round  41, Global train loss: 0.662, Global test loss: 3.600, Global test accuracy: 12.53
Round  42, Train loss: 0.838, Test loss: 1.945, Test accuracy: 50.04
Round  42, Global train loss: 0.838, Global test loss: 3.630, Global test accuracy: 13.61
Round  43, Train loss: 0.642, Test loss: 1.937, Test accuracy: 49.63
Round  43, Global train loss: 0.642, Global test loss: 3.592, Global test accuracy: 13.21
Round  44, Train loss: 0.643, Test loss: 1.970, Test accuracy: 48.85
Round  44, Global train loss: 0.643, Global test loss: 3.667, Global test accuracy: 13.22
Round  45, Train loss: 0.726, Test loss: 1.991, Test accuracy: 48.91
Round  45, Global train loss: 0.726, Global test loss: 3.604, Global test accuracy: 13.38
Round  46, Train loss: 0.691, Test loss: 1.991, Test accuracy: 49.21
Round  46, Global train loss: 0.691, Global test loss: 3.523, Global test accuracy: 13.33
Round  47, Train loss: 0.713, Test loss: 2.035, Test accuracy: 48.95
Round  47, Global train loss: 0.713, Global test loss: 3.678, Global test accuracy: 12.66
Round  48, Train loss: 0.617, Test loss: 2.052, Test accuracy: 48.91
Round  48, Global train loss: 0.617, Global test loss: 3.742, Global test accuracy: 12.88
Round  49, Train loss: 0.679, Test loss: 2.084, Test accuracy: 48.87
Round  49, Global train loss: 0.679, Global test loss: 3.768, Global test accuracy: 13.37
Round  50, Train loss: 0.587, Test loss: 2.125, Test accuracy: 48.44
Round  50, Global train loss: 0.587, Global test loss: 3.577, Global test accuracy: 14.37
Round  51, Train loss: 0.606, Test loss: 2.157, Test accuracy: 48.27
Round  51, Global train loss: 0.606, Global test loss: 3.693, Global test accuracy: 14.47
Round  52, Train loss: 0.659, Test loss: 2.127, Test accuracy: 48.97
Round  52, Global train loss: 0.659, Global test loss: 3.876, Global test accuracy: 12.15
Round  53, Train loss: 0.583, Test loss: 2.127, Test accuracy: 48.75
Round  53, Global train loss: 0.583, Global test loss: 3.984, Global test accuracy: 13.51
Round  54, Train loss: 0.654, Test loss: 2.156, Test accuracy: 48.45
Round  54, Global train loss: 0.654, Global test loss: 3.756, Global test accuracy: 13.95
Round  55, Train loss: 0.598, Test loss: 2.196, Test accuracy: 47.94
Round  55, Global train loss: 0.598, Global test loss: 3.634, Global test accuracy: 14.44
Round  56, Train loss: 0.636, Test loss: 2.151, Test accuracy: 48.20
Round  56, Global train loss: 0.636, Global test loss: 3.632, Global test accuracy: 13.31
Round  57, Train loss: 0.585, Test loss: 2.192, Test accuracy: 47.91
Round  57, Global train loss: 0.585, Global test loss: 4.011, Global test accuracy: 12.86
Round  58, Train loss: 0.621, Test loss: 2.190, Test accuracy: 48.19
Round  58, Global train loss: 0.621, Global test loss: 3.625, Global test accuracy: 13.88
Round  59, Train loss: 0.662, Test loss: 2.172, Test accuracy: 49.00
Round  59, Global train loss: 0.662, Global test loss: 3.780, Global test accuracy: 12.75
Round  60, Train loss: 0.574, Test loss: 2.159, Test accuracy: 48.68
Round  60, Global train loss: 0.574, Global test loss: 3.747, Global test accuracy: 13.82
Round  61, Train loss: 0.544, Test loss: 2.174, Test accuracy: 48.41
Round  61, Global train loss: 0.544, Global test loss: 3.925, Global test accuracy: 12.03
Round  62, Train loss: 0.647, Test loss: 2.163, Test accuracy: 48.99
Round  62, Global train loss: 0.647, Global test loss: 4.081, Global test accuracy: 14.59
Round  63, Train loss: 0.499, Test loss: 2.196, Test accuracy: 49.32
Round  63, Global train loss: 0.499, Global test loss: 3.888, Global test accuracy: 14.24
Round  64, Train loss: 0.618, Test loss: 2.238, Test accuracy: 48.58
Round  64, Global train loss: 0.618, Global test loss: 3.917, Global test accuracy: 13.27
Round  65, Train loss: 0.580, Test loss: 2.231, Test accuracy: 49.02
Round  65, Global train loss: 0.580, Global test loss: 3.849, Global test accuracy: 14.02
Round  66, Train loss: 0.606, Test loss: 2.270, Test accuracy: 48.81
Round  66, Global train loss: 0.606, Global test loss: 3.914, Global test accuracy: 12.63
Round  67, Train loss: 0.632, Test loss: 2.305, Test accuracy: 48.67
Round  67, Global train loss: 0.632, Global test loss: 4.124, Global test accuracy: 14.58
Round  68, Train loss: 0.530, Test loss: 2.332, Test accuracy: 48.63
Round  68, Global train loss: 0.530, Global test loss: 3.993, Global test accuracy: 14.00
Round  69, Train loss: 0.506, Test loss: 2.357, Test accuracy: 48.20
Round  69, Global train loss: 0.506, Global test loss: 4.356, Global test accuracy: 12.34
Round  70, Train loss: 0.548, Test loss: 2.335, Test accuracy: 47.83
Round  70, Global train loss: 0.548, Global test loss: 3.909, Global test accuracy: 13.40
Round  71, Train loss: 0.563, Test loss: 2.351, Test accuracy: 48.46
Round  71, Global train loss: 0.563, Global test loss: 4.012, Global test accuracy: 14.01
Round  72, Train loss: 0.533, Test loss: 2.311, Test accuracy: 48.71
Round  72, Global train loss: 0.533, Global test loss: 4.016, Global test accuracy: 13.74
Round  73, Train loss: 0.520, Test loss: 2.326, Test accuracy: 47.85
Round  73, Global train loss: 0.520, Global test loss: 4.133, Global test accuracy: 12.57
Round  74, Train loss: 0.517, Test loss: 2.322, Test accuracy: 47.82
Round  74, Global train loss: 0.517, Global test loss: 4.046, Global test accuracy: 13.48
Round  75, Train loss: 0.583, Test loss: 2.325, Test accuracy: 47.66
Round  75, Global train loss: 0.583, Global test loss: 3.960, Global test accuracy: 13.59
Round  76, Train loss: 0.455, Test loss: 2.343, Test accuracy: 47.73
Round  76, Global train loss: 0.455, Global test loss: 4.064, Global test accuracy: 14.64
Round  77, Train loss: 0.497, Test loss: 2.396, Test accuracy: 47.44
Round  77, Global train loss: 0.497, Global test loss: 4.097, Global test accuracy: 14.29
Round  78, Train loss: 0.501, Test loss: 2.395, Test accuracy: 47.41
Round  78, Global train loss: 0.501, Global test loss: 4.208, Global test accuracy: 12.91
Round  79, Train loss: 0.503, Test loss: 2.427, Test accuracy: 47.34
Round  79, Global train loss: 0.503, Global test loss: 4.091, Global test accuracy: 13.73
Round  80, Train loss: 0.402, Test loss: 2.438, Test accuracy: 47.83
Round  80, Global train loss: 0.402, Global test loss: 3.952, Global test accuracy: 14.31
Round  81, Train loss: 0.379, Test loss: 2.465, Test accuracy: 47.02
Round  81, Global train loss: 0.379, Global test loss: 4.109, Global test accuracy: 14.36
Round  82, Train loss: 0.358, Test loss: 2.464, Test accuracy: 47.53
Round  82, Global train loss: 0.358, Global test loss: 4.248, Global test accuracy: 14.49
Round  83, Train loss: 0.346, Test loss: 2.487, Test accuracy: 47.87
Round  83, Global train loss: 0.346, Global test loss: 4.315, Global test accuracy: 14.40
Round  84, Train loss: 0.341, Test loss: 2.464, Test accuracy: 47.77
Round  84, Global train loss: 0.341, Global test loss: 4.276, Global test accuracy: 14.71
Round  85, Train loss: 0.328, Test loss: 2.514, Test accuracy: 47.55
Round  85, Global train loss: 0.328, Global test loss: 4.380, Global test accuracy: 14.77
Round  86, Train loss: 0.323, Test loss: 2.504, Test accuracy: 47.75
Round  86, Global train loss: 0.323, Global test loss: 4.454, Global test accuracy: 14.43
Round  87, Train loss: 0.316, Test loss: 2.479, Test accuracy: 48.22
Round  87, Global train loss: 0.316, Global test loss: 4.419, Global test accuracy: 14.64
Round  88, Train loss: 0.298, Test loss: 2.568, Test accuracy: 47.22
Round  88, Global train loss: 0.298, Global test loss: 4.557, Global test accuracy: 14.53
Round  89, Train loss: 0.301, Test loss: 2.548, Test accuracy: 47.53
Round  89, Global train loss: 0.301, Global test loss: 4.523, Global test accuracy: 14.64
Round  90, Train loss: 0.514, Test loss: 2.479, Test accuracy: 48.28
Round  90, Global train loss: 0.514, Global test loss: 3.834, Global test accuracy: 14.56
Round  91, Train loss: 0.466, Test loss: 2.509, Test accuracy: 48.58
Round  91, Global train loss: 0.466, Global test loss: 3.857, Global test accuracy: 14.37
Round  92, Train loss: 0.452, Test loss: 2.601, Test accuracy: 47.49
Round  92, Global train loss: 0.452, Global test loss: 3.886, Global test accuracy: 14.27
Round  93, Train loss: 0.443, Test loss: 2.596, Test accuracy: 47.92
Round  93, Global train loss: 0.443, Global test loss: 3.857, Global test accuracy: 14.09
Round  94, Train loss: 0.440, Test loss: 2.582, Test accuracy: 48.40
Round  94, Global train loss: 0.440, Global test loss: 3.867, Global test accuracy: 13.94
Round  95, Train loss: 0.426, Test loss: 2.573, Test accuracy: 48.82
Round  95, Global train loss: 0.426, Global test loss: 3.913, Global test accuracy: 14.10
Round  96, Train loss: 0.424, Test loss: 2.604, Test accuracy: 48.03
Round  96, Global train loss: 0.424, Global test loss: 3.890, Global test accuracy: 14.28
Round  97, Train loss: 0.415, Test loss: 2.578, Test accuracy: 48.37
Round  97, Global train loss: 0.415, Global test loss: 3.904, Global test accuracy: 14.23
Round  98, Train loss: 0.415, Test loss: 2.613, Test accuracy: 47.99
Round  98, Global train loss: 0.415, Global test loss: 3.909, Global test accuracy: 14.11
Round  99, Train loss: 0.409, Test loss: 2.658, Test accuracy: 47.76
Round  99, Global train loss: 0.409, Global test loss: 3.930, Global test accuracy: 14.08
Final Round, Train loss: 0.294, Test loss: 2.944, Test accuracy: 48.08
Final Round, Global train loss: 0.294, Global test loss: 3.930, Global test accuracy: 14.08
Average accuracy final 10 rounds: 48.164
Average global accuracy final 10 rounds: 14.202999999999998
2528.961918115616
[2.488511085510254, 4.800358772277832, 7.119552373886108, 9.443584203720093, 11.755932092666626, 14.073469877243042, 16.390525341033936, 18.70015835762024, 21.000028371810913, 23.308517932891846, 25.611267566680908, 27.910947799682617, 30.20611047744751, 32.501521825790405, 34.79664444923401, 37.096248388290405, 39.38919734954834, 41.688533782958984, 43.988102436065674, 46.28324556350708, 48.567467212677, 50.854504108428955, 53.142499685287476, 55.4244179725647, 57.706024408340454, 59.987091302871704, 62.40299320220947, 64.44926452636719, 66.53208565711975, 68.54006791114807, 70.55068564414978, 72.55528354644775, 74.56414723396301, 76.60945868492126, 78.61737394332886, 80.60746884346008, 82.9083833694458, 85.20796155929565, 87.50589609146118, 89.80706405639648, 92.11622428894043, 94.11509275436401, 96.09815526008606, 98.08181118965149, 100.06228804588318, 102.04646730422974, 104.03554463386536, 106.02018189430237, 108.00136137008667, 109.98786091804504, 111.97989988327026, 113.97606301307678, 115.98610949516296, 117.99523854255676, 120.0039713382721, 122.0154287815094, 124.02737760543823, 126.03246593475342, 128.0207018852234, 130.01219844818115, 131.9942500591278, 133.9805371761322, 135.98673462867737, 137.97531461715698, 139.95827221870422, 141.94420528411865, 143.95052289962769, 145.96059107780457, 148.04209542274475, 150.0304138660431, 152.02138543128967, 154.07486724853516, 156.07027673721313, 158.05540561676025, 160.04093217849731, 162.0242154598236, 164.0181427001953, 166.2116129398346, 168.44983792304993, 170.49776816368103, 172.54215097427368, 174.6830813884735, 176.7278618812561, 179.19989848136902, 181.24258542060852, 183.27811098098755, 185.31642150878906, 187.35225343704224, 189.3895332813263, 191.42663502693176, 193.4645917415619, 195.49707412719727, 197.53931832313538, 199.65443229675293, 201.71100401878357, 203.74438643455505, 205.7855327129364, 207.83390545845032, 210.22507452964783, 212.65206480026245, 217.52548050880432]
[41.85, 45.82, 48.71, 51.84, 52.22, 53.96, 53.95, 55.39, 54.55, 55.76, 55.01, 54.93, 54.27, 54.35, 54.22, 54.18, 53.49, 52.36, 51.84, 51.05, 51.22, 51.08, 50.3, 50.54, 51.45, 51.55, 50.82, 50.71, 50.56, 50.79, 50.98, 49.98, 49.7, 49.49, 49.16, 48.47, 47.92, 47.62, 48.73, 48.93, 49.24, 50.26, 50.04, 49.63, 48.85, 48.91, 49.21, 48.95, 48.91, 48.87, 48.44, 48.27, 48.97, 48.75, 48.45, 47.94, 48.2, 47.91, 48.19, 49.0, 48.68, 48.41, 48.99, 49.32, 48.58, 49.02, 48.81, 48.67, 48.63, 48.2, 47.83, 48.46, 48.71, 47.85, 47.82, 47.66, 47.73, 47.44, 47.41, 47.34, 47.83, 47.02, 47.53, 47.87, 47.77, 47.55, 47.75, 48.22, 47.22, 47.53, 48.28, 48.58, 47.49, 47.92, 48.4, 48.82, 48.03, 48.37, 47.99, 47.76, 48.08]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.661, Test loss: 1.411, Test accuracy: 42.56
Round   0, Global train loss: 1.661, Global test loss: 2.269, Global test accuracy: 15.00
Round   1, Train loss: 1.582, Test loss: 1.366, Test accuracy: 43.76
Round   1, Global train loss: 1.582, Global test loss: 2.268, Global test accuracy: 15.10
Round   2, Train loss: 1.526, Test loss: 1.279, Test accuracy: 50.89
Round   2, Global train loss: 1.526, Global test loss: 2.254, Global test accuracy: 15.58
Round   3, Train loss: 1.488, Test loss: 1.238, Test accuracy: 51.74
Round   3, Global train loss: 1.488, Global test loss: 2.251, Global test accuracy: 15.80
Round   4, Train loss: 1.456, Test loss: 1.222, Test accuracy: 53.24
Round   4, Global train loss: 1.456, Global test loss: 2.248, Global test accuracy: 15.97
Round   5, Train loss: 1.427, Test loss: 1.208, Test accuracy: 54.46
Round   5, Global train loss: 1.427, Global test loss: 2.239, Global test accuracy: 16.29
Round   6, Train loss: 1.399, Test loss: 1.216, Test accuracy: 52.81
Round   6, Global train loss: 1.399, Global test loss: 2.246, Global test accuracy: 16.31
Round   7, Train loss: 1.372, Test loss: 1.173, Test accuracy: 55.20
Round   7, Global train loss: 1.372, Global test loss: 2.242, Global test accuracy: 16.79
Round   8, Train loss: 1.346, Test loss: 1.183, Test accuracy: 55.73
Round   8, Global train loss: 1.346, Global test loss: 2.242, Global test accuracy: 17.00
Round   9, Train loss: 1.318, Test loss: 1.205, Test accuracy: 54.09
Round   9, Global train loss: 1.318, Global test loss: 2.248, Global test accuracy: 16.99
Round  10, Train loss: 1.197, Test loss: 1.211, Test accuracy: 54.24
Round  10, Global train loss: 1.197, Global test loss: 2.466, Global test accuracy: 16.17
Round  11, Train loss: 1.347, Test loss: 1.204, Test accuracy: 54.73
Round  11, Global train loss: 1.347, Global test loss: 2.387, Global test accuracy: 15.72
Round  12, Train loss: 1.323, Test loss: 1.210, Test accuracy: 54.37
Round  12, Global train loss: 1.323, Global test loss: 2.500, Global test accuracy: 14.77
Round  13, Train loss: 1.302, Test loss: 1.212, Test accuracy: 55.06
Round  13, Global train loss: 1.302, Global test loss: 2.493, Global test accuracy: 15.56
Round  14, Train loss: 1.201, Test loss: 1.226, Test accuracy: 54.86
Round  14, Global train loss: 1.201, Global test loss: 2.555, Global test accuracy: 14.12
Round  15, Train loss: 1.059, Test loss: 1.248, Test accuracy: 54.21
Round  15, Global train loss: 1.059, Global test loss: 2.509, Global test accuracy: 15.41
Round  16, Train loss: 1.096, Test loss: 1.264, Test accuracy: 53.93
Round  16, Global train loss: 1.096, Global test loss: 2.630, Global test accuracy: 15.65
Round  17, Train loss: 1.195, Test loss: 1.275, Test accuracy: 53.51
Round  17, Global train loss: 1.195, Global test loss: 2.543, Global test accuracy: 15.72
Round  18, Train loss: 0.973, Test loss: 1.292, Test accuracy: 53.13
Round  18, Global train loss: 0.973, Global test loss: 2.645, Global test accuracy: 13.95
Round  19, Train loss: 1.001, Test loss: 1.317, Test accuracy: 52.85
Round  19, Global train loss: 1.001, Global test loss: 2.744, Global test accuracy: 16.43
Round  20, Train loss: 1.090, Test loss: 1.338, Test accuracy: 52.09
Round  20, Global train loss: 1.090, Global test loss: 2.637, Global test accuracy: 16.26
Round  21, Train loss: 0.992, Test loss: 1.376, Test accuracy: 51.53
Round  21, Global train loss: 0.992, Global test loss: 2.770, Global test accuracy: 14.92
Round  22, Train loss: 0.832, Test loss: 1.390, Test accuracy: 51.60
Round  22, Global train loss: 0.832, Global test loss: 2.787, Global test accuracy: 15.04
Round  23, Train loss: 0.990, Test loss: 1.413, Test accuracy: 51.87
Round  23, Global train loss: 0.990, Global test loss: 2.806, Global test accuracy: 14.98
Round  24, Train loss: 0.843, Test loss: 1.466, Test accuracy: 51.04
Round  24, Global train loss: 0.843, Global test loss: 2.795, Global test accuracy: 14.12
Round  25, Train loss: 0.870, Test loss: 1.478, Test accuracy: 51.23
Round  25, Global train loss: 0.870, Global test loss: 2.982, Global test accuracy: 14.10
Round  26, Train loss: 1.016, Test loss: 1.535, Test accuracy: 50.84
Round  26, Global train loss: 1.016, Global test loss: 2.896, Global test accuracy: 15.00
Round  27, Train loss: 0.723, Test loss: 1.575, Test accuracy: 50.34
Round  27, Global train loss: 0.723, Global test loss: 3.188, Global test accuracy: 14.35
Round  28, Train loss: 0.810, Test loss: 1.604, Test accuracy: 50.34
Round  28, Global train loss: 0.810, Global test loss: 3.076, Global test accuracy: 14.06
Round  29, Train loss: 0.888, Test loss: 1.593, Test accuracy: 50.86
Round  29, Global train loss: 0.888, Global test loss: 2.997, Global test accuracy: 14.49
Round  30, Train loss: 0.919, Test loss: 1.617, Test accuracy: 50.12
Round  30, Global train loss: 0.919, Global test loss: 2.988, Global test accuracy: 12.42
Round  31, Train loss: 0.836, Test loss: 1.653, Test accuracy: 49.91
Round  31, Global train loss: 0.836, Global test loss: 3.238, Global test accuracy: 13.64
Round  32, Train loss: 0.703, Test loss: 1.673, Test accuracy: 49.90
Round  32, Global train loss: 0.703, Global test loss: 3.026, Global test accuracy: 14.07
Round  33, Train loss: 0.801, Test loss: 1.692, Test accuracy: 49.34
Round  33, Global train loss: 0.801, Global test loss: 3.298, Global test accuracy: 14.13
Round  34, Train loss: 0.833, Test loss: 1.698, Test accuracy: 49.63
Round  34, Global train loss: 0.833, Global test loss: 3.114, Global test accuracy: 13.70
Round  35, Train loss: 0.720, Test loss: 1.728, Test accuracy: 49.08
Round  35, Global train loss: 0.720, Global test loss: 3.086, Global test accuracy: 14.47
Round  36, Train loss: 0.828, Test loss: 1.722, Test accuracy: 49.60
Round  36, Global train loss: 0.828, Global test loss: 3.247, Global test accuracy: 14.14
Round  37, Train loss: 0.685, Test loss: 1.754, Test accuracy: 50.04
Round  37, Global train loss: 0.685, Global test loss: 3.141, Global test accuracy: 13.71
Round  38, Train loss: 0.639, Test loss: 1.785, Test accuracy: 49.51
Round  38, Global train loss: 0.639, Global test loss: 3.228, Global test accuracy: 13.79
Round  39, Train loss: 0.808, Test loss: 1.810, Test accuracy: 49.85
Round  39, Global train loss: 0.808, Global test loss: 3.211, Global test accuracy: 14.61
Round  40, Train loss: 0.770, Test loss: 1.816, Test accuracy: 50.55
Round  40, Global train loss: 0.770, Global test loss: 3.222, Global test accuracy: 14.47
Round  41, Train loss: 0.660, Test loss: 1.827, Test accuracy: 49.92
Round  41, Global train loss: 0.660, Global test loss: 3.444, Global test accuracy: 13.84
Round  42, Train loss: 0.738, Test loss: 1.833, Test accuracy: 49.66
Round  42, Global train loss: 0.738, Global test loss: 3.588, Global test accuracy: 12.67
Round  43, Train loss: 0.695, Test loss: 1.850, Test accuracy: 49.97
Round  43, Global train loss: 0.695, Global test loss: 3.310, Global test accuracy: 13.57
Round  44, Train loss: 0.667, Test loss: 1.892, Test accuracy: 50.43
Round  44, Global train loss: 0.667, Global test loss: 3.598, Global test accuracy: 14.43
Round  45, Train loss: 0.778, Test loss: 1.923, Test accuracy: 49.65
Round  45, Global train loss: 0.778, Global test loss: 3.276, Global test accuracy: 13.72
Round  46, Train loss: 0.682, Test loss: 1.938, Test accuracy: 48.92
Round  46, Global train loss: 0.682, Global test loss: 3.324, Global test accuracy: 14.07
Round  47, Train loss: 0.712, Test loss: 1.963, Test accuracy: 49.00
Round  47, Global train loss: 0.712, Global test loss: 3.656, Global test accuracy: 14.60
Round  48, Train loss: 0.637, Test loss: 1.982, Test accuracy: 49.89
Round  48, Global train loss: 0.637, Global test loss: 3.670, Global test accuracy: 14.10
Round  49, Train loss: 0.515, Test loss: 2.002, Test accuracy: 50.12
Round  49, Global train loss: 0.515, Global test loss: 3.724, Global test accuracy: 13.85
Round  50, Train loss: 0.646, Test loss: 2.011, Test accuracy: 49.60
Round  50, Global train loss: 0.646, Global test loss: 3.522, Global test accuracy: 14.32
Round  51, Train loss: 0.688, Test loss: 2.021, Test accuracy: 50.03
Round  51, Global train loss: 0.688, Global test loss: 3.487, Global test accuracy: 14.49
Round  52, Train loss: 0.554, Test loss: 2.023, Test accuracy: 49.85
Round  52, Global train loss: 0.554, Global test loss: 3.888, Global test accuracy: 13.57
Round  53, Train loss: 0.571, Test loss: 2.015, Test accuracy: 49.80
Round  53, Global train loss: 0.571, Global test loss: 3.648, Global test accuracy: 14.44
Round  54, Train loss: 0.581, Test loss: 2.036, Test accuracy: 49.95
Round  54, Global train loss: 0.581, Global test loss: 3.593, Global test accuracy: 14.34
Round  55, Train loss: 0.567, Test loss: 2.027, Test accuracy: 50.43
Round  55, Global train loss: 0.567, Global test loss: 3.889, Global test accuracy: 13.74
Round  56, Train loss: 0.676, Test loss: 2.052, Test accuracy: 50.05
Round  56, Global train loss: 0.676, Global test loss: 3.469, Global test accuracy: 14.33
Round  57, Train loss: 0.616, Test loss: 2.053, Test accuracy: 49.57
Round  57, Global train loss: 0.616, Global test loss: 3.694, Global test accuracy: 14.35
Round  58, Train loss: 0.587, Test loss: 2.089, Test accuracy: 49.43
Round  58, Global train loss: 0.587, Global test loss: 3.633, Global test accuracy: 13.89
Round  59, Train loss: 0.644, Test loss: 2.111, Test accuracy: 48.65
Round  59, Global train loss: 0.644, Global test loss: 3.620, Global test accuracy: 13.76
Round  60, Train loss: 0.605, Test loss: 2.122, Test accuracy: 48.91
Round  60, Global train loss: 0.605, Global test loss: 3.830, Global test accuracy: 13.55
Round  61, Train loss: 0.541, Test loss: 2.103, Test accuracy: 49.59
Round  61, Global train loss: 0.541, Global test loss: 3.683, Global test accuracy: 13.12
Round  62, Train loss: 0.569, Test loss: 2.153, Test accuracy: 49.61
Round  62, Global train loss: 0.569, Global test loss: 3.922, Global test accuracy: 13.64
Round  63, Train loss: 0.535, Test loss: 2.159, Test accuracy: 49.42
Round  63, Global train loss: 0.535, Global test loss: 4.079, Global test accuracy: 14.20
Round  64, Train loss: 0.574, Test loss: 2.156, Test accuracy: 49.56
Round  64, Global train loss: 0.574, Global test loss: 4.083, Global test accuracy: 14.34
Round  65, Train loss: 0.588, Test loss: 2.162, Test accuracy: 48.59
Round  65, Global train loss: 0.588, Global test loss: 3.583, Global test accuracy: 12.69
Round  66, Train loss: 0.598, Test loss: 2.153, Test accuracy: 49.17
Round  66, Global train loss: 0.598, Global test loss: 3.898, Global test accuracy: 13.31
Round  67, Train loss: 0.591, Test loss: 2.141, Test accuracy: 49.49
Round  67, Global train loss: 0.591, Global test loss: 3.910, Global test accuracy: 13.31
Round  68, Train loss: 0.542, Test loss: 2.183, Test accuracy: 49.38
Round  68, Global train loss: 0.542, Global test loss: 3.871, Global test accuracy: 13.98
Round  69, Train loss: 0.591, Test loss: 2.239, Test accuracy: 49.11
Round  69, Global train loss: 0.591, Global test loss: 4.296, Global test accuracy: 14.51
Round  70, Train loss: 0.526, Test loss: 2.258, Test accuracy: 49.25
Round  70, Global train loss: 0.526, Global test loss: 4.222, Global test accuracy: 14.56
Round  71, Train loss: 0.499, Test loss: 2.255, Test accuracy: 49.24
Round  71, Global train loss: 0.499, Global test loss: 4.237, Global test accuracy: 13.94
Round  72, Train loss: 0.519, Test loss: 2.231, Test accuracy: 49.52
Round  72, Global train loss: 0.519, Global test loss: 4.157, Global test accuracy: 13.85
Round  73, Train loss: 0.509, Test loss: 2.239, Test accuracy: 50.05
Round  73, Global train loss: 0.509, Global test loss: 3.949, Global test accuracy: 13.88
Round  74, Train loss: 0.530, Test loss: 2.265, Test accuracy: 50.39
Round  74, Global train loss: 0.530, Global test loss: 3.782, Global test accuracy: 14.27
Round  75, Train loss: 0.482, Test loss: 2.314, Test accuracy: 50.09
Round  75, Global train loss: 0.482, Global test loss: 4.096, Global test accuracy: 14.11
Round  76, Train loss: 0.456, Test loss: 2.296, Test accuracy: 50.17
Round  76, Global train loss: 0.456, Global test loss: 4.334, Global test accuracy: 13.04
Round  77, Train loss: 0.476, Test loss: 2.316, Test accuracy: 49.82
Round  77, Global train loss: 0.476, Global test loss: 4.393, Global test accuracy: 14.02
Round  78, Train loss: 0.453, Test loss: 2.284, Test accuracy: 50.16
Round  78, Global train loss: 0.453, Global test loss: 4.137, Global test accuracy: 13.14
Round  79, Train loss: 0.459, Test loss: 2.296, Test accuracy: 49.91
Round  79, Global train loss: 0.459, Global test loss: 4.334, Global test accuracy: 14.14
Round  80, Train loss: 0.389, Test loss: 2.299, Test accuracy: 49.40
Round  80, Global train loss: 0.389, Global test loss: 3.939, Global test accuracy: 13.78
Round  81, Train loss: 0.364, Test loss: 2.319, Test accuracy: 49.42
Round  81, Global train loss: 0.364, Global test loss: 4.027, Global test accuracy: 13.71
Round  82, Train loss: 0.350, Test loss: 2.326, Test accuracy: 49.58
Round  82, Global train loss: 0.350, Global test loss: 4.080, Global test accuracy: 14.11
Round  83, Train loss: 0.331, Test loss: 2.366, Test accuracy: 49.23
Round  83, Global train loss: 0.331, Global test loss: 4.234, Global test accuracy: 14.04
Round  84, Train loss: 0.330, Test loss: 2.347, Test accuracy: 49.95
Round  84, Global train loss: 0.330, Global test loss: 4.213, Global test accuracy: 14.22
Round  85, Train loss: 0.314, Test loss: 2.411, Test accuracy: 49.12
Round  85, Global train loss: 0.314, Global test loss: 4.222, Global test accuracy: 14.13
Round  86, Train loss: 0.308, Test loss: 2.358, Test accuracy: 49.80
Round  86, Global train loss: 0.308, Global test loss: 4.294, Global test accuracy: 14.27
Round  87, Train loss: 0.294, Test loss: 2.457, Test accuracy: 49.04
Round  87, Global train loss: 0.294, Global test loss: 4.414, Global test accuracy: 13.93
Round  88, Train loss: 0.293, Test loss: 2.370, Test accuracy: 50.20
Round  88, Global train loss: 0.293, Global test loss: 4.428, Global test accuracy: 14.49
Round  89, Train loss: 0.299, Test loss: 2.430, Test accuracy: 49.37
Round  89, Global train loss: 0.299, Global test loss: 4.482, Global test accuracy: 14.61
Round  90, Train loss: 0.514, Test loss: 2.437, Test accuracy: 49.09
Round  90, Global train loss: 0.514, Global test loss: 3.774, Global test accuracy: 14.30
Round  91, Train loss: 0.471, Test loss: 2.504, Test accuracy: 48.33
Round  91, Global train loss: 0.471, Global test loss: 3.785, Global test accuracy: 14.45
Round  92, Train loss: 0.457, Test loss: 2.492, Test accuracy: 48.39
Round  92, Global train loss: 0.457, Global test loss: 3.790, Global test accuracy: 14.08
Round  93, Train loss: 0.448, Test loss: 2.459, Test accuracy: 48.91
Round  93, Global train loss: 0.448, Global test loss: 3.795, Global test accuracy: 14.09
Round  94, Train loss: 0.439, Test loss: 2.472, Test accuracy: 49.06
Round  94, Global train loss: 0.439, Global test loss: 3.822, Global test accuracy: 13.83
Round  95, Train loss: 0.429, Test loss: 2.464, Test accuracy: 48.04
Round  95, Global train loss: 0.429, Global test loss: 3.813, Global test accuracy: 13.84
Round  96, Train loss: 0.432, Test loss: 2.450, Test accuracy: 49.43
Round  96, Global train loss: 0.432, Global test loss: 3.805, Global test accuracy: 14.21
Round  97, Train loss: 0.424, Test loss: 2.523, Test accuracy: 49.01
Round  97, Global train loss: 0.424, Global test loss: 3.837, Global test accuracy: 14.34
Round  98, Train loss: 0.417, Test loss: 2.459, Test accuracy: 49.52
Round  98, Global train loss: 0.417, Global test loss: 3.865, Global test accuracy: 14.00
Round  99, Train loss: 0.414, Test loss: 2.533, Test accuracy: 49.11
Round  99, Global train loss: 0.414, Global test loss: 3.872, Global test accuracy: 14.44
Final Round, Train loss: 0.298, Test loss: 2.830, Test accuracy: 49.30
Final Round, Global train loss: 0.298, Global test loss: 3.872, Global test accuracy: 14.44
Average accuracy final 10 rounds: 48.888999999999996
Average global accuracy final 10 rounds: 14.157999999999998
5128.375277996063
[2.7528111934661865, 5.242737770080566, 7.7241644859313965, 10.200707912445068, 12.674972772598267, 15.154343843460083, 17.63630199432373, 20.114054203033447, 22.5937180519104, 25.074474573135376, 27.553481101989746, 30.034590244293213, 32.50727438926697, 34.97980308532715, 37.46590566635132, 39.93897843360901, 42.385700702667236, 44.863619804382324, 47.319916009902954, 49.81278085708618, 52.29892015457153, 58.256763219833374, 64.23266243934631, 69.85879874229431, 75.3957040309906, 80.90898394584656, 86.42983818054199, 92.48810696601868, 98.56816291809082, 104.62300825119019, 110.67918872833252, 117.11355304718018, 123.50692319869995, 129.98947548866272, 136.52068400382996, 142.9510474205017, 149.39533114433289, 155.82606291770935, 162.2743809223175, 168.63847374916077, 175.10636687278748, 181.5224311351776, 187.89842891693115, 194.4015610218048, 200.82938027381897, 207.27040219306946, 213.73236417770386, 220.15696954727173, 226.6305673122406, 233.09594535827637, 239.54529476165771, 246.00938367843628, 252.4803421497345, 258.9140546321869, 265.35480523109436, 271.7682774066925, 278.13110423088074, 284.51024866104126, 290.61403465270996, 296.7050347328186, 302.8208734989166, 308.96819519996643, 315.07724356651306, 321.2609326839447, 327.37804198265076, 333.51496601104736, 339.6744239330292, 345.8039176464081, 351.94213795661926, 358.06126403808594, 364.19236493110657, 370.32152104377747, 376.46548199653625, 382.61009788513184, 388.7611541748047, 394.9000098705292, 401.13414430618286, 407.2749936580658, 413.3860445022583, 419.5547649860382, 425.6824471950531, 431.81878113746643, 437.9762353897095, 443.59944891929626, 449.19383931159973, 454.8214201927185, 460.463262796402, 466.07978081703186, 471.706036567688, 477.3876049518585, 483.0284984111786, 489.0199522972107, 494.99827575683594, 500.98080348968506, 506.97101950645447, 513.0082597732544, 519.0316429138184, 525.065358877182, 531.1498191356659, 537.211047410965, 542.1942658424377]
[42.56, 43.76, 50.89, 51.74, 53.24, 54.46, 52.81, 55.2, 55.73, 54.09, 54.24, 54.73, 54.37, 55.06, 54.86, 54.21, 53.93, 53.51, 53.13, 52.85, 52.09, 51.53, 51.6, 51.87, 51.04, 51.23, 50.84, 50.34, 50.34, 50.86, 50.12, 49.91, 49.9, 49.34, 49.63, 49.08, 49.6, 50.04, 49.51, 49.85, 50.55, 49.92, 49.66, 49.97, 50.43, 49.65, 48.92, 49.0, 49.89, 50.12, 49.6, 50.03, 49.85, 49.8, 49.95, 50.43, 50.05, 49.57, 49.43, 48.65, 48.91, 49.59, 49.61, 49.42, 49.56, 48.59, 49.17, 49.49, 49.38, 49.11, 49.25, 49.24, 49.52, 50.05, 50.39, 50.09, 50.17, 49.82, 50.16, 49.91, 49.4, 49.42, 49.58, 49.23, 49.95, 49.12, 49.8, 49.04, 50.2, 49.37, 49.09, 48.33, 48.39, 48.91, 49.06, 48.04, 49.43, 49.01, 49.52, 49.11, 49.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.809, Test loss: 1.827, Test accuracy: 19.92
Round   1, Train loss: 1.621, Test loss: 1.605, Test accuracy: 28.32
Round   2, Train loss: 1.570, Test loss: 1.479, Test accuracy: 36.78
Round   3, Train loss: 1.531, Test loss: 1.405, Test accuracy: 40.46
Round   4, Train loss: 1.502, Test loss: 1.358, Test accuracy: 42.20
Round   5, Train loss: 1.477, Test loss: 1.304, Test accuracy: 46.64
Round   6, Train loss: 1.454, Test loss: 1.258, Test accuracy: 49.74
Round   7, Train loss: 1.432, Test loss: 1.233, Test accuracy: 50.85
Round   8, Train loss: 1.412, Test loss: 1.208, Test accuracy: 54.22
Round   9, Train loss: 1.393, Test loss: 1.196, Test accuracy: 53.83
Round  10, Train loss: 1.376, Test loss: 1.163, Test accuracy: 55.99
Round  11, Train loss: 1.359, Test loss: 1.148, Test accuracy: 57.73
Round  12, Train loss: 1.343, Test loss: 1.139, Test accuracy: 56.42
Round  13, Train loss: 1.327, Test loss: 1.138, Test accuracy: 57.37
Round  14, Train loss: 1.312, Test loss: 1.089, Test accuracy: 59.60
Round  15, Train loss: 1.295, Test loss: 1.101, Test accuracy: 58.58
Round  16, Train loss: 1.279, Test loss: 1.092, Test accuracy: 60.05
Round  17, Train loss: 1.261, Test loss: 1.061, Test accuracy: 60.99
Round  18, Train loss: 1.245, Test loss: 1.063, Test accuracy: 60.67
Round  19, Train loss: 1.231, Test loss: 1.072, Test accuracy: 60.85
Round  20, Train loss: 1.142, Test loss: 1.070, Test accuracy: 60.85
Round  21, Train loss: 1.183, Test loss: 1.090, Test accuracy: 60.30
Round  22, Train loss: 1.142, Test loss: 1.075, Test accuracy: 60.97
Round  23, Train loss: 1.317, Test loss: 1.079, Test accuracy: 60.09
Round  24, Train loss: 1.138, Test loss: 1.066, Test accuracy: 60.77
Round  25, Train loss: 1.120, Test loss: 1.088, Test accuracy: 60.29
Round  26, Train loss: 1.203, Test loss: 1.089, Test accuracy: 59.48
Round  27, Train loss: 1.009, Test loss: 1.077, Test accuracy: 60.56
Round  28, Train loss: 1.199, Test loss: 1.097, Test accuracy: 59.84
Round  29, Train loss: 1.097, Test loss: 1.096, Test accuracy: 59.52
Round  30, Train loss: 1.081, Test loss: 1.089, Test accuracy: 60.30
Round  31, Train loss: 1.039, Test loss: 1.109, Test accuracy: 59.94
Round  32, Train loss: 1.115, Test loss: 1.083, Test accuracy: 60.13
Round  33, Train loss: 1.001, Test loss: 1.112, Test accuracy: 59.03
Round  34, Train loss: 1.134, Test loss: 1.131, Test accuracy: 58.41
Round  35, Train loss: 1.013, Test loss: 1.130, Test accuracy: 58.78
Round  36, Train loss: 1.024, Test loss: 1.121, Test accuracy: 58.73
Round  37, Train loss: 0.978, Test loss: 1.099, Test accuracy: 59.94
Round  38, Train loss: 0.865, Test loss: 1.128, Test accuracy: 58.82
Round  39, Train loss: 1.078, Test loss: 1.158, Test accuracy: 58.09
Round  40, Train loss: 1.130, Test loss: 1.166, Test accuracy: 57.52
Round  41, Train loss: 0.957, Test loss: 1.187, Test accuracy: 57.10
Round  42, Train loss: 1.006, Test loss: 1.168, Test accuracy: 58.02
Round  43, Train loss: 1.034, Test loss: 1.188, Test accuracy: 57.40
Round  44, Train loss: 0.999, Test loss: 1.227, Test accuracy: 56.51
Round  45, Train loss: 0.927, Test loss: 1.201, Test accuracy: 56.81
Round  46, Train loss: 0.994, Test loss: 1.252, Test accuracy: 56.29
Round  47, Train loss: 0.831, Test loss: 1.216, Test accuracy: 57.10
Round  48, Train loss: 0.849, Test loss: 1.246, Test accuracy: 57.10
Round  49, Train loss: 0.911, Test loss: 1.290, Test accuracy: 54.99
Round  50, Train loss: 0.961, Test loss: 1.288, Test accuracy: 55.24
Round  51, Train loss: 0.857, Test loss: 1.302, Test accuracy: 55.69
Round  52, Train loss: 0.841, Test loss: 1.282, Test accuracy: 55.84
Round  53, Train loss: 0.844, Test loss: 1.281, Test accuracy: 55.70
Round  54, Train loss: 0.820, Test loss: 1.314, Test accuracy: 56.19
Round  55, Train loss: 0.789, Test loss: 1.338, Test accuracy: 55.88
Round  56, Train loss: 0.778, Test loss: 1.311, Test accuracy: 57.04
Round  57, Train loss: 0.733, Test loss: 1.316, Test accuracy: 56.65
Round  58, Train loss: 0.683, Test loss: 1.276, Test accuracy: 57.15
Round  59, Train loss: 0.813, Test loss: 1.335, Test accuracy: 56.46
Round  60, Train loss: 0.698, Test loss: 1.287, Test accuracy: 57.63
Round  61, Train loss: 0.680, Test loss: 1.319, Test accuracy: 57.01
Round  62, Train loss: 0.759, Test loss: 1.312, Test accuracy: 56.18
Round  63, Train loss: 0.727, Test loss: 1.355, Test accuracy: 55.86
Round  64, Train loss: 0.672, Test loss: 1.392, Test accuracy: 55.48
Round  65, Train loss: 0.811, Test loss: 1.424, Test accuracy: 54.32
Round  66, Train loss: 0.765, Test loss: 1.477, Test accuracy: 54.26
Round  67, Train loss: 0.683, Test loss: 1.428, Test accuracy: 54.51
Round  68, Train loss: 0.601, Test loss: 1.415, Test accuracy: 54.88
Round  69, Train loss: 0.695, Test loss: 1.437, Test accuracy: 54.29
Round  70, Train loss: 0.713, Test loss: 1.499, Test accuracy: 54.05
Round  71, Train loss: 0.740, Test loss: 1.521, Test accuracy: 53.44
Round  72, Train loss: 0.595, Test loss: 1.464, Test accuracy: 53.91
Round  73, Train loss: 0.645, Test loss: 1.504, Test accuracy: 54.29
Round  74, Train loss: 0.667, Test loss: 1.513, Test accuracy: 53.74
Round  75, Train loss: 0.685, Test loss: 1.514, Test accuracy: 54.34
Round  76, Train loss: 0.696, Test loss: 1.514, Test accuracy: 54.84
Round  77, Train loss: 0.577, Test loss: 1.495, Test accuracy: 54.52
Round  78, Train loss: 0.604, Test loss: 1.530, Test accuracy: 53.69
Round  79, Train loss: 0.603, Test loss: 1.528, Test accuracy: 53.24
Round  80, Train loss: 0.500, Test loss: 1.522, Test accuracy: 54.01
Round  81, Train loss: 0.474, Test loss: 1.544, Test accuracy: 53.99
Round  82, Train loss: 0.461, Test loss: 1.558, Test accuracy: 53.05
Round  83, Train loss: 0.440, Test loss: 1.588, Test accuracy: 53.52
Round  84, Train loss: 0.426, Test loss: 1.620, Test accuracy: 53.54
Round  85, Train loss: 0.437, Test loss: 1.622, Test accuracy: 53.39
Round  86, Train loss: 0.418, Test loss: 1.616, Test accuracy: 52.74
Round  87, Train loss: 0.407, Test loss: 1.612, Test accuracy: 53.88
Round  88, Train loss: 0.396, Test loss: 1.643, Test accuracy: 53.13
Round  89, Train loss: 0.388, Test loss: 1.634, Test accuracy: 53.44
Round  90, Train loss: 0.613, Test loss: 1.574, Test accuracy: 54.33
Round  91, Train loss: 0.589, Test loss: 1.609, Test accuracy: 53.97
Round  92, Train loss: 0.575, Test loss: 1.615, Test accuracy: 54.02
Round  93, Train loss: 0.564, Test loss: 1.632, Test accuracy: 53.82
Round  94, Train loss: 0.558, Test loss: 1.657, Test accuracy: 52.81
Round  95, Train loss: 0.543, Test loss: 1.665, Test accuracy: 53.96
Round  96, Train loss: 0.538, Test loss: 1.668, Test accuracy: 53.31
Round  97, Train loss: 0.538, Test loss: 1.730, Test accuracy: 52.15
Round  98, Train loss: 0.530, Test loss: 1.670, Test accuracy: 53.78
Round  99, Train loss: 0.520, Test loss: 1.678, Test accuracy: 54.01
Final Round, Train loss: 0.511, Test loss: 1.712, Test accuracy: 53.95
Average accuracy final 10 rounds: 53.616
3510.794424057007
[2.3823413848876953, 4.284397602081299, 6.1937501430511475, 8.098332166671753, 10.00310206413269, 11.908902883529663, 13.813491582870483, 15.716902017593384, 17.629426956176758, 19.546444416046143, 21.46701145172119, 23.381911754608154, 25.30144190788269, 27.2167067527771, 29.130469799041748, 31.04814910888672, 33.166682958602905, 35.09687900543213, 37.03083276748657, 38.957974672317505, 40.887975454330444, 44.952072620391846, 48.96437692642212, 53.052027225494385, 57.10333228111267, 61.12973713874817, 65.23530507087708, 69.29839015007019, 73.40343880653381, 77.50676202774048, 81.6180968284607, 85.74109029769897, 89.85106086730957, 93.9610903263092, 98.0294816493988, 102.08552861213684, 106.12920379638672, 110.22536516189575, 114.39387392997742, 118.50268769264221, 122.57773280143738, 126.59775757789612, 130.67139387130737, 134.71764516830444, 138.79965257644653, 142.57739663124084, 146.10725593566895, 149.63339591026306, 153.16814589500427, 156.69636511802673, 160.21918320655823, 163.74494457244873, 167.287029504776, 170.82048344612122, 174.36606121063232, 177.88929772377014, 181.409734249115, 184.90743565559387, 188.43552136421204, 191.9605221748352, 195.4822072982788, 199.00456404685974, 202.5354299545288, 206.07532954216003, 209.70058512687683, 213.2518241405487, 216.80610585212708, 220.35730695724487, 223.89887976646423, 227.45315957069397, 230.9994616508484, 234.53260397911072, 238.069091796875, 241.6029016971588, 245.13156604766846, 248.66406798362732, 252.20393872261047, 255.72694540023804, 259.24773693084717, 262.7967109680176, 266.3581533432007, 269.91307950019836, 273.4572832584381, 277.0023555755615, 280.5515413284302, 284.0818946361542, 287.6357047557831, 291.19007992744446, 295.02442169189453, 298.8846273422241, 302.7633590698242, 306.62393450737, 310.464280128479, 314.41513872146606, 318.48196029663086, 322.3149995803833, 326.23747730255127, 330.0711965560913, 333.9051556587219, 337.7358453273773, 341.2766613960266]
[19.92, 28.32, 36.78, 40.46, 42.2, 46.64, 49.74, 50.85, 54.22, 53.83, 55.99, 57.73, 56.42, 57.37, 59.6, 58.58, 60.05, 60.99, 60.67, 60.85, 60.85, 60.3, 60.97, 60.09, 60.77, 60.29, 59.48, 60.56, 59.84, 59.52, 60.3, 59.94, 60.13, 59.03, 58.41, 58.78, 58.73, 59.94, 58.82, 58.09, 57.52, 57.1, 58.02, 57.4, 56.51, 56.81, 56.29, 57.1, 57.1, 54.99, 55.24, 55.69, 55.84, 55.7, 56.19, 55.88, 57.04, 56.65, 57.15, 56.46, 57.63, 57.01, 56.18, 55.86, 55.48, 54.32, 54.26, 54.51, 54.88, 54.29, 54.05, 53.44, 53.91, 54.29, 53.74, 54.34, 54.84, 54.52, 53.69, 53.24, 54.01, 53.99, 53.05, 53.52, 53.54, 53.39, 52.74, 53.88, 53.13, 53.44, 54.33, 53.97, 54.02, 53.82, 52.81, 53.96, 53.31, 52.15, 53.78, 54.01, 53.95]
