nohup: ignoring input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.986, Test loss: 1.705, Test accuracy: 38.38
Round   0, Global train loss: 1.986, Global test loss: 1.687, Global test accuracy: 39.73
Round   1, Train loss: 1.671, Test loss: 1.549, Test accuracy: 43.66
Round   1, Global train loss: 1.671, Global test loss: 1.502, Global test accuracy: 45.73
Round   2, Train loss: 1.531, Test loss: 1.477, Test accuracy: 46.30
Round   2, Global train loss: 1.531, Global test loss: 1.369, Global test accuracy: 50.90
Round   3, Train loss: 1.401, Test loss: 1.426, Test accuracy: 48.46
Round   3, Global train loss: 1.401, Global test loss: 1.264, Global test accuracy: 55.83
Round   4, Train loss: 1.414, Test loss: 1.430, Test accuracy: 48.48
Round   4, Global train loss: 1.414, Global test loss: 1.272, Global test accuracy: 55.54
Round   5, Train loss: 1.357, Test loss: 1.440, Test accuracy: 48.27
Round   5, Global train loss: 1.357, Global test loss: 1.208, Global test accuracy: 58.51
Round   6, Train loss: 1.370, Test loss: 1.414, Test accuracy: 49.34
Round   6, Global train loss: 1.370, Global test loss: 1.318, Global test accuracy: 55.01
Round   7, Train loss: 1.379, Test loss: 1.400, Test accuracy: 49.98
Round   7, Global train loss: 1.379, Global test loss: 1.300, Global test accuracy: 54.56
Round   8, Train loss: 1.258, Test loss: 1.391, Test accuracy: 50.64
Round   8, Global train loss: 1.258, Global test loss: 1.226, Global test accuracy: 57.49
Round   9, Train loss: 1.146, Test loss: 1.377, Test accuracy: 51.27
Round   9, Global train loss: 1.146, Global test loss: 1.133, Global test accuracy: 60.00
Round  10, Train loss: 1.125, Test loss: 1.366, Test accuracy: 51.86
Round  10, Global train loss: 1.125, Global test loss: 1.188, Global test accuracy: 58.71
Round  11, Train loss: 1.030, Test loss: 1.369, Test accuracy: 52.27
Round  11, Global train loss: 1.030, Global test loss: 1.099, Global test accuracy: 61.67
Round  12, Train loss: 0.985, Test loss: 1.379, Test accuracy: 52.48
Round  12, Global train loss: 0.985, Global test loss: 1.113, Global test accuracy: 60.86
Round  13, Train loss: 1.099, Test loss: 1.373, Test accuracy: 53.05
Round  13, Global train loss: 1.099, Global test loss: 1.149, Global test accuracy: 60.04
Round  14, Train loss: 0.956, Test loss: 1.368, Test accuracy: 53.46
Round  14, Global train loss: 0.956, Global test loss: 1.151, Global test accuracy: 60.01
Round  15, Train loss: 0.988, Test loss: 1.365, Test accuracy: 53.71
Round  15, Global train loss: 0.988, Global test loss: 1.134, Global test accuracy: 60.77
Round  16, Train loss: 0.936, Test loss: 1.385, Test accuracy: 53.68
Round  16, Global train loss: 0.936, Global test loss: 1.146, Global test accuracy: 60.09
Round  17, Train loss: 0.879, Test loss: 1.392, Test accuracy: 53.85
Round  17, Global train loss: 0.879, Global test loss: 1.171, Global test accuracy: 59.67
Round  18, Train loss: 0.864, Test loss: 1.415, Test accuracy: 54.00
Round  18, Global train loss: 0.864, Global test loss: 1.093, Global test accuracy: 61.37
Round  19, Train loss: 0.918, Test loss: 1.446, Test accuracy: 53.99
Round  19, Global train loss: 0.918, Global test loss: 1.111, Global test accuracy: 60.67
Round  20, Train loss: 0.815, Test loss: 1.454, Test accuracy: 54.12
Round  20, Global train loss: 0.815, Global test loss: 1.143, Global test accuracy: 60.35
Round  21, Train loss: 0.955, Test loss: 1.450, Test accuracy: 54.66
Round  21, Global train loss: 0.955, Global test loss: 1.143, Global test accuracy: 60.24
Round  22, Train loss: 0.839, Test loss: 1.460, Test accuracy: 54.81
Round  22, Global train loss: 0.839, Global test loss: 1.127, Global test accuracy: 61.05
Round  23, Train loss: 0.827, Test loss: 1.473, Test accuracy: 54.72
Round  23, Global train loss: 0.827, Global test loss: 1.203, Global test accuracy: 58.23
Round  24, Train loss: 0.773, Test loss: 1.467, Test accuracy: 55.02
Round  24, Global train loss: 0.773, Global test loss: 1.112, Global test accuracy: 61.55
Round  25, Train loss: 0.702, Test loss: 1.476, Test accuracy: 55.44
Round  25, Global train loss: 0.702, Global test loss: 1.151, Global test accuracy: 59.67
Round  26, Train loss: 0.769, Test loss: 1.484, Test accuracy: 55.88
Round  26, Global train loss: 0.769, Global test loss: 1.108, Global test accuracy: 61.23
Round  27, Train loss: 0.727, Test loss: 1.511, Test accuracy: 55.47
Round  27, Global train loss: 0.727, Global test loss: 1.116, Global test accuracy: 61.19
Round  28, Train loss: 0.686, Test loss: 1.521, Test accuracy: 55.55
Round  28, Global train loss: 0.686, Global test loss: 1.140, Global test accuracy: 59.87
Round  29, Train loss: 0.691, Test loss: 1.543, Test accuracy: 55.85
Round  29, Global train loss: 0.691, Global test loss: 1.098, Global test accuracy: 62.35
Round  30, Train loss: 0.740, Test loss: 1.585, Test accuracy: 55.49
Round  30, Global train loss: 0.740, Global test loss: 1.104, Global test accuracy: 61.07
Round  31, Train loss: 0.658, Test loss: 1.602, Test accuracy: 55.54
Round  31, Global train loss: 0.658, Global test loss: 1.150, Global test accuracy: 59.42
Round  32, Train loss: 0.566, Test loss: 1.619, Test accuracy: 55.59
Round  32, Global train loss: 0.566, Global test loss: 1.090, Global test accuracy: 63.40
Round  33, Train loss: 0.622, Test loss: 1.637, Test accuracy: 55.48
Round  33, Global train loss: 0.622, Global test loss: 1.117, Global test accuracy: 61.12
Round  34, Train loss: 0.570, Test loss: 1.651, Test accuracy: 55.58
Round  34, Global train loss: 0.570, Global test loss: 1.135, Global test accuracy: 60.44
Round  35, Train loss: 0.646, Test loss: 1.656, Test accuracy: 56.01
Round  35, Global train loss: 0.646, Global test loss: 1.196, Global test accuracy: 58.84
Round  36, Train loss: 0.596, Test loss: 1.669, Test accuracy: 56.17
Round  36, Global train loss: 0.596, Global test loss: 1.132, Global test accuracy: 60.65
Round  37, Train loss: 0.533, Test loss: 1.689, Test accuracy: 56.30
Round  37, Global train loss: 0.533, Global test loss: 1.112, Global test accuracy: 62.68
Round  38, Train loss: 0.562, Test loss: 1.703, Test accuracy: 56.45
Round  38, Global train loss: 0.562, Global test loss: 1.125, Global test accuracy: 61.15
Round  39, Train loss: 0.495, Test loss: 1.716, Test accuracy: 56.33
Round  39, Global train loss: 0.495, Global test loss: 1.145, Global test accuracy: 62.03
Round  40, Train loss: 0.500, Test loss: 1.750, Test accuracy: 56.44
Round  40, Global train loss: 0.500, Global test loss: 1.154, Global test accuracy: 61.51
Round  41, Train loss: 0.473, Test loss: 1.773, Test accuracy: 56.31
Round  41, Global train loss: 0.473, Global test loss: 1.144, Global test accuracy: 60.43
Round  42, Train loss: 0.516, Test loss: 1.801, Test accuracy: 56.07
Round  42, Global train loss: 0.516, Global test loss: 1.205, Global test accuracy: 58.40
Round  43, Train loss: 0.510, Test loss: 1.835, Test accuracy: 55.85
Round  43, Global train loss: 0.510, Global test loss: 1.153, Global test accuracy: 60.59
Round  44, Train loss: 0.454, Test loss: 1.830, Test accuracy: 55.88
Round  44, Global train loss: 0.454, Global test loss: 1.183, Global test accuracy: 59.25
Round  45, Train loss: 0.400, Test loss: 1.877, Test accuracy: 55.59
Round  45, Global train loss: 0.400, Global test loss: 1.148, Global test accuracy: 63.62
Round  46, Train loss: 0.396, Test loss: 1.901, Test accuracy: 55.78
Round  46, Global train loss: 0.396, Global test loss: 1.167, Global test accuracy: 61.68
Round  47, Train loss: 0.437, Test loss: 1.935, Test accuracy: 55.70
Round  47, Global train loss: 0.437, Global test loss: 1.159, Global test accuracy: 59.89
Round  48, Train loss: 0.430, Test loss: 1.935, Test accuracy: 55.54
Round  48, Global train loss: 0.430, Global test loss: 1.139, Global test accuracy: 62.14
Round  49, Train loss: 0.401, Test loss: 1.954, Test accuracy: 55.58
Round  49, Global train loss: 0.401, Global test loss: 1.167, Global test accuracy: 60.66
Round  50, Train loss: 0.399, Test loss: 1.970, Test accuracy: 55.56
Round  50, Global train loss: 0.399, Global test loss: 1.224, Global test accuracy: 57.94
Round  51, Train loss: 0.375, Test loss: 1.956, Test accuracy: 55.77
Round  51, Global train loss: 0.375, Global test loss: 1.160, Global test accuracy: 60.22
Round  52, Train loss: 0.392, Test loss: 1.993, Test accuracy: 56.19
Round  52, Global train loss: 0.392, Global test loss: 1.201, Global test accuracy: 61.75
Round  53, Train loss: 0.408, Test loss: 1.990, Test accuracy: 55.93
Round  53, Global train loss: 0.408, Global test loss: 1.182, Global test accuracy: 61.00
Round  54, Train loss: 0.441, Test loss: 1.991, Test accuracy: 56.28
Round  54, Global train loss: 0.441, Global test loss: 1.195, Global test accuracy: 58.69
Round  55, Train loss: 0.394, Test loss: 2.019, Test accuracy: 55.97
Round  55, Global train loss: 0.394, Global test loss: 1.180, Global test accuracy: 60.56
Round  56, Train loss: 0.346, Test loss: 2.014, Test accuracy: 55.99
Round  56, Global train loss: 0.346, Global test loss: 1.164, Global test accuracy: 61.35
Round  57, Train loss: 0.362, Test loss: 2.042, Test accuracy: 56.31
Round  57, Global train loss: 0.362, Global test loss: 1.235, Global test accuracy: 57.66
Round  58, Train loss: 0.384, Test loss: 2.070, Test accuracy: 56.14
Round  58, Global train loss: 0.384, Global test loss: 1.202, Global test accuracy: 59.35
Round  59, Train loss: 0.291, Test loss: 2.103, Test accuracy: 56.10
Round  59, Global train loss: 0.291, Global test loss: 1.242, Global test accuracy: 62.21
Round  60, Train loss: 0.337, Test loss: 2.136, Test accuracy: 55.77
Round  60, Global train loss: 0.337, Global test loss: 1.225, Global test accuracy: 59.74
Round  61, Train loss: 0.341, Test loss: 2.150, Test accuracy: 55.89
Round  61, Global train loss: 0.341, Global test loss: 1.193, Global test accuracy: 60.71
Round  62, Train loss: 0.366, Test loss: 2.157, Test accuracy: 56.35
Round  62, Global train loss: 0.366, Global test loss: 1.221, Global test accuracy: 58.55
Round  63, Train loss: 0.288, Test loss: 2.174, Test accuracy: 56.59
Round  63, Global train loss: 0.288, Global test loss: 1.193, Global test accuracy: 62.03
Round  64, Train loss: 0.325, Test loss: 2.179, Test accuracy: 56.59
Round  64, Global train loss: 0.325, Global test loss: 1.184, Global test accuracy: 60.27
Round  65, Train loss: 0.348, Test loss: 2.205, Test accuracy: 56.53
Round  65, Global train loss: 0.348, Global test loss: 1.207, Global test accuracy: 60.38
Round  66, Train loss: 0.318, Test loss: 2.220, Test accuracy: 56.43
Round  66, Global train loss: 0.318, Global test loss: 1.225, Global test accuracy: 58.47
Round  67, Train loss: 0.268, Test loss: 2.227, Test accuracy: 56.35
Round  67, Global train loss: 0.268, Global test loss: 1.187, Global test accuracy: 61.62
Round  68, Train loss: 0.287, Test loss: 2.268, Test accuracy: 56.15
Round  68, Global train loss: 0.287, Global test loss: 1.181, Global test accuracy: 62.42
Round  69, Train loss: 0.326, Test loss: 2.291, Test accuracy: 55.78
Round  69, Global train loss: 0.326, Global test loss: 1.207, Global test accuracy: 61.05
Round  70, Train loss: 0.303, Test loss: 2.288, Test accuracy: 55.84
Round  70, Global train loss: 0.303, Global test loss: 1.244, Global test accuracy: 61.48
Round  71, Train loss: 0.287, Test loss: 2.329, Test accuracy: 55.76
Round  71, Global train loss: 0.287, Global test loss: 1.194, Global test accuracy: 62.03
Round  72, Train loss: 0.276, Test loss: 2.343, Test accuracy: 56.27
Round  72, Global train loss: 0.276, Global test loss: 1.200, Global test accuracy: 59.36
Round  73, Train loss: 0.308, Test loss: 2.349, Test accuracy: 56.24
Round  73, Global train loss: 0.308, Global test loss: 1.227, Global test accuracy: 59.80
Round  74, Train loss: 0.278, Test loss: 2.319, Test accuracy: 56.60
Round  74, Global train loss: 0.278, Global test loss: 1.224, Global test accuracy: 60.72
Round  75, Train loss: 0.254, Test loss: 2.334, Test accuracy: 56.63
Round  75, Global train loss: 0.254, Global test loss: 1.275, Global test accuracy: 60.77
Round  76, Train loss: 0.275, Test loss: 2.356, Test accuracy: 56.53
Round  76, Global train loss: 0.275, Global test loss: 1.209, Global test accuracy: 59.17
Round  77, Train loss: 0.311, Test loss: 2.378, Test accuracy: 56.00
Round  77, Global train loss: 0.311, Global test loss: 1.266, Global test accuracy: 55.83
Round  78, Train loss: 0.268, Test loss: 2.377, Test accuracy: 56.25
Round  78, Global train loss: 0.268, Global test loss: 1.196, Global test accuracy: 60.66
Round  79, Train loss: 0.238, Test loss: 2.378, Test accuracy: 56.19
Round  79, Global train loss: 0.238, Global test loss: 1.244, Global test accuracy: 60.95
Round  80, Train loss: 0.252, Test loss: 2.391, Test accuracy: 56.36
Round  80, Global train loss: 0.252, Global test loss: 1.257, Global test accuracy: 58.47
Round  81, Train loss: 0.278, Test loss: 2.394, Test accuracy: 56.52
Round  81, Global train loss: 0.278, Global test loss: 1.291, Global test accuracy: 56.09
Round  82, Train loss: 0.263, Test loss: 2.406, Test accuracy: 56.34
Round  82, Global train loss: 0.263, Global test loss: 1.266, Global test accuracy: 57.29
Round  83, Train loss: 0.273, Test loss: 2.422, Test accuracy: 56.53
Round  83, Global train loss: 0.273, Global test loss: 1.252, Global test accuracy: 57.26
Round  84, Train loss: 0.209, Test loss: 2.448, Test accuracy: 56.41
Round  84, Global train loss: 0.209, Global test loss: 1.342, Global test accuracy: 62.90
Round  85, Train loss: 0.254, Test loss: 2.488, Test accuracy: 56.09
Round  85, Global train loss: 0.254, Global test loss: 1.221, Global test accuracy: 59.27
Round  86, Train loss: 0.252, Test loss: 2.477, Test accuracy: 56.53
Round  86, Global train loss: 0.252, Global test loss: 1.236, Global test accuracy: 60.68
Round  87, Train loss: 0.225, Test loss: 2.504, Test accuracy: 56.52
Round  87, Global train loss: 0.225, Global test loss: 1.266, Global test accuracy: 60.14
Round  88, Train loss: 0.243, Test loss: 2.533, Test accuracy: 56.70
Round  88, Global train loss: 0.243, Global test loss: 1.241, Global test accuracy: 58.26
Round  89, Train loss: 0.244, Test loss: 2.563, Test accuracy: 56.62
Round  89, Global train loss: 0.244, Global test loss: 1.304, Global test accuracy: 54.19
Round  90, Train loss: 0.235, Test loss: 2.543, Test accuracy: 56.83
Round  90, Global train loss: 0.235, Global test loss: 1.280, Global test accuracy: 56.67
Round  91, Train loss: 0.231, Test loss: 2.525, Test accuracy: 56.88
Round  91, Global train loss: 0.231, Global test loss: 1.235, Global test accuracy: 58.94
Round  92, Train loss: 0.230, Test loss: 2.525, Test accuracy: 57.02
Round  92, Global train loss: 0.230, Global test loss: 1.227, Global test accuracy: 59.51
Round  93, Train loss: 0.240, Test loss: 2.529, Test accuracy: 56.81
Round  93, Global train loss: 0.240, Global test loss: 1.276, Global test accuracy: 57.87
Round  94, Train loss: 0.213, Test loss: 2.521, Test accuracy: 56.59
Round  94, Global train loss: 0.213, Global test loss: 1.291, Global test accuracy: 60.59
Round  95, Train loss: 0.246, Test loss: 2.576, Test accuracy: 56.54
Round  95, Global train loss: 0.246, Global test loss: 1.277, Global test accuracy: 56.53
Round  96, Train loss: 0.207, Test loss: 2.588, Test accuracy: 56.48
Round  96, Global train loss: 0.207, Global test loss: 1.224, Global test accuracy: 59.88
Round  97, Train loss: 0.209, Test loss: 2.577, Test accuracy: 56.68
Round  97, Global train loss: 0.209, Global test loss: 1.340, Global test accuracy: 61.87
Round  98, Train loss: 0.241, Test loss: 2.580, Test accuracy: 56.78
Round  98, Global train loss: 0.241, Global test loss: 1.276, Global test accuracy: 55.96
Round  99, Train loss: 0.210, Test loss: 2.642, Test accuracy: 56.28
Round  99, Global train loss: 0.210, Global test loss: 1.285, Global test accuracy: 58.63
Final Round, Train loss: 0.143, Test loss: 2.787, Test accuracy: 56.80
Final Round, Global train loss: 0.143, Global test loss: 1.285, Global test accuracy: 58.63
Average accuracy final 10 rounds: 56.687999999999995 

Average global accuracy final 10 rounds: 58.646750000000004 

5971.134387731552
[5.066788196563721, 10.133576393127441, 14.949482679367065, 19.76538896560669, 24.596819639205933, 29.428250312805176, 34.2631950378418, 39.09813976287842, 43.94384479522705, 48.789549827575684, 53.6065616607666, 58.42357349395752, 63.243459701538086, 68.06334590911865, 72.89739871025085, 77.73145151138306, 82.56742691993713, 87.40340232849121, 92.23198580741882, 97.06056928634644, 101.88994574546814, 106.71932220458984, 111.51488184928894, 116.31044149398804, 121.12527132034302, 125.940101146698, 130.71972513198853, 135.49934911727905, 140.35409235954285, 145.20883560180664, 150.00953006744385, 154.81022453308105, 159.57893085479736, 164.34763717651367, 168.5439910888672, 172.7403450012207, 176.93602013587952, 181.13169527053833, 185.32418727874756, 189.5166792869568, 193.71784806251526, 197.91901683807373, 202.11005806922913, 206.30109930038452, 210.5164875984192, 214.73187589645386, 218.9441876411438, 223.15649938583374, 227.3810634613037, 231.60562753677368, 235.8103325366974, 240.0150375366211, 244.2323865890503, 248.4497356414795, 252.7621409893036, 257.0745463371277, 261.367733001709, 265.6609196662903, 269.95812010765076, 274.25532054901123, 278.463675737381, 282.67203092575073, 286.8527798652649, 291.03352880477905, 295.2294750213623, 299.42542123794556, 303.59909772872925, 307.77277421951294, 311.96310448646545, 316.15343475341797, 320.50614166259766, 324.85884857177734, 329.0353765487671, 333.21190452575684, 337.56142926216125, 341.9109539985657, 346.104704618454, 350.2984552383423, 354.53773856163025, 358.7770218849182, 363.02985882759094, 367.2826957702637, 371.5007529258728, 375.71881008148193, 379.9451434612274, 384.1714768409729, 388.3719322681427, 392.5723876953125, 396.79158115386963, 401.01077461242676, 405.21041560173035, 409.41005659103394, 413.63894963264465, 417.86784267425537, 422.0645387172699, 426.2612347602844, 430.5023317337036, 434.7434287071228, 438.98192501068115, 443.2204213142395, 447.49424171447754, 451.7680621147156, 456.0126097202301, 460.25715732574463, 464.54033756256104, 468.82351779937744, 473.07458305358887, 477.3256483078003, 481.59958934783936, 485.8735303878784, 490.1172332763672, 494.36093616485596, 498.6203467845917, 502.8797574043274, 507.14041662216187, 511.40107583999634, 515.6797678470612, 519.958459854126, 524.2127268314362, 528.4669938087463, 532.7691204547882, 537.0712471008301, 541.2974634170532, 545.5236797332764, 549.7850887775421, 554.0464978218079, 558.2785844802856, 562.5106711387634, 566.7402732372284, 570.9698753356934, 575.2044947147369, 579.4391140937805, 583.6953661441803, 587.9516181945801, 592.2390034198761, 596.5263886451721, 600.7679479122162, 605.0095071792603, 609.2413084506989, 613.4731097221375, 617.6978507041931, 621.9225916862488, 626.13578748703, 630.3489832878113, 634.5707294940948, 638.7924757003784, 643.0072546005249, 647.2220335006714, 651.4677927494049, 655.7135519981384, 659.9452786445618, 664.1770052909851, 668.3374586105347, 672.4979119300842, 676.6844701766968, 680.8710284233093, 685.0279395580292, 689.184850692749, 693.4053435325623, 697.6258363723755, 701.8191199302673, 706.0124034881592, 710.2071707248688, 714.4019379615784, 718.6077260971069, 722.8135142326355, 727.0120255947113, 731.2105369567871, 735.4269254207611, 739.6433138847351, 743.867226600647, 748.0911393165588, 752.3133635520935, 756.5355877876282, 760.7977433204651, 765.059898853302, 769.3232908248901, 773.5866827964783, 777.8112235069275, 782.0357642173767, 786.3243396282196, 790.6129150390625, 794.8928472995758, 799.1727795600891, 803.4594950675964, 807.7462105751038, 812.0702075958252, 816.3942046165466, 820.6756885051727, 824.9571723937988, 829.1792623996735, 833.4013524055481, 837.6921546459198, 841.9829568862915, 846.2342958450317, 850.485634803772, 854.7494361400604, 859.0132374763489, 863.2493944168091, 867.4855513572693, 869.6464471817017, 871.807343006134]
[38.3775, 38.3775, 43.665, 43.665, 46.305, 46.305, 48.46, 48.46, 48.48, 48.48, 48.27, 48.27, 49.345, 49.345, 49.98, 49.98, 50.64, 50.64, 51.275, 51.275, 51.8625, 51.8625, 52.27, 52.27, 52.485, 52.485, 53.045, 53.045, 53.46, 53.46, 53.71, 53.71, 53.68, 53.68, 53.8525, 53.8525, 54.0025, 54.0025, 53.99, 53.99, 54.1175, 54.1175, 54.665, 54.665, 54.8075, 54.8075, 54.7175, 54.7175, 55.0225, 55.0225, 55.4375, 55.4375, 55.885, 55.885, 55.47, 55.47, 55.555, 55.555, 55.8475, 55.8475, 55.49, 55.49, 55.5425, 55.5425, 55.585, 55.585, 55.48, 55.48, 55.5775, 55.5775, 56.01, 56.01, 56.175, 56.175, 56.3, 56.3, 56.455, 56.455, 56.3275, 56.3275, 56.435, 56.435, 56.3075, 56.3075, 56.0725, 56.0725, 55.8475, 55.8475, 55.875, 55.875, 55.59, 55.59, 55.78, 55.78, 55.7025, 55.7025, 55.5375, 55.5375, 55.5825, 55.5825, 55.56, 55.56, 55.775, 55.775, 56.1875, 56.1875, 55.93, 55.93, 56.28, 56.28, 55.9725, 55.9725, 55.9925, 55.9925, 56.3075, 56.3075, 56.1425, 56.1425, 56.0975, 56.0975, 55.765, 55.765, 55.8925, 55.8925, 56.3475, 56.3475, 56.5925, 56.5925, 56.595, 56.595, 56.535, 56.535, 56.4275, 56.4275, 56.355, 56.355, 56.15, 56.15, 55.78, 55.78, 55.835, 55.835, 55.755, 55.755, 56.265, 56.265, 56.24, 56.24, 56.605, 56.605, 56.635, 56.635, 56.535, 56.535, 56.0025, 56.0025, 56.2525, 56.2525, 56.185, 56.185, 56.3575, 56.3575, 56.52, 56.52, 56.345, 56.345, 56.5325, 56.5325, 56.41, 56.41, 56.09, 56.09, 56.5325, 56.5325, 56.5225, 56.5225, 56.6975, 56.6975, 56.62, 56.62, 56.8275, 56.8275, 56.88, 56.88, 57.015, 57.015, 56.8075, 56.8075, 56.585, 56.585, 56.54, 56.54, 56.48, 56.48, 56.6825, 56.6825, 56.78, 56.78, 56.2825, 56.2825, 56.8, 56.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.000, Test loss: 1.730, Test accuracy: 37.43
Round   0, Global train loss: 2.000, Global test loss: 1.727, Global test accuracy: 38.00
Round   1, Train loss: 1.681, Test loss: 1.570, Test accuracy: 42.84
Round   1, Global train loss: 1.681, Global test loss: 1.486, Global test accuracy: 46.33
Round   2, Train loss: 1.528, Test loss: 1.498, Test accuracy: 45.44
Round   2, Global train loss: 1.528, Global test loss: 1.316, Global test accuracy: 52.22
Round   3, Train loss: 1.427, Test loss: 1.443, Test accuracy: 47.66
Round   3, Global train loss: 1.427, Global test loss: 1.240, Global test accuracy: 55.52
Round   4, Train loss: 1.352, Test loss: 1.354, Test accuracy: 51.19
Round   4, Global train loss: 1.352, Global test loss: 1.158, Global test accuracy: 58.94
Round   5, Train loss: 1.263, Test loss: 1.335, Test accuracy: 52.05
Round   5, Global train loss: 1.263, Global test loss: 1.120, Global test accuracy: 60.45
Round   6, Train loss: 1.191, Test loss: 1.299, Test accuracy: 53.87
Round   6, Global train loss: 1.191, Global test loss: 1.059, Global test accuracy: 62.92
Round   7, Train loss: 1.151, Test loss: 1.286, Test accuracy: 54.29
Round   7, Global train loss: 1.151, Global test loss: 1.031, Global test accuracy: 63.94
Round   8, Train loss: 1.121, Test loss: 1.237, Test accuracy: 56.26
Round   8, Global train loss: 1.121, Global test loss: 1.003, Global test accuracy: 64.09
Round   9, Train loss: 1.065, Test loss: 1.191, Test accuracy: 58.34
Round   9, Global train loss: 1.065, Global test loss: 0.967, Global test accuracy: 66.22
Round  10, Train loss: 1.045, Test loss: 1.160, Test accuracy: 59.56
Round  10, Global train loss: 1.045, Global test loss: 0.929, Global test accuracy: 67.53
Round  11, Train loss: 1.000, Test loss: 1.150, Test accuracy: 59.94
Round  11, Global train loss: 1.000, Global test loss: 0.907, Global test accuracy: 68.23
Round  12, Train loss: 0.963, Test loss: 1.128, Test accuracy: 60.93
Round  12, Global train loss: 0.963, Global test loss: 0.889, Global test accuracy: 69.17
Round  13, Train loss: 0.932, Test loss: 1.096, Test accuracy: 62.19
Round  13, Global train loss: 0.932, Global test loss: 0.863, Global test accuracy: 70.47
Round  14, Train loss: 0.899, Test loss: 1.093, Test accuracy: 62.56
Round  14, Global train loss: 0.899, Global test loss: 0.861, Global test accuracy: 70.30
Round  15, Train loss: 0.889, Test loss: 1.062, Test accuracy: 63.73
Round  15, Global train loss: 0.889, Global test loss: 0.842, Global test accuracy: 71.04
Round  16, Train loss: 0.840, Test loss: 1.057, Test accuracy: 63.98
Round  16, Global train loss: 0.840, Global test loss: 0.833, Global test accuracy: 71.61
Round  17, Train loss: 0.835, Test loss: 1.042, Test accuracy: 64.43
Round  17, Global train loss: 0.835, Global test loss: 0.819, Global test accuracy: 71.60
Round  18, Train loss: 0.803, Test loss: 1.026, Test accuracy: 65.18
Round  18, Global train loss: 0.803, Global test loss: 0.809, Global test accuracy: 72.21
Round  19, Train loss: 0.800, Test loss: 1.030, Test accuracy: 65.34
Round  19, Global train loss: 0.800, Global test loss: 0.803, Global test accuracy: 72.80
Round  20, Train loss: 0.804, Test loss: 1.022, Test accuracy: 65.94
Round  20, Global train loss: 0.804, Global test loss: 0.785, Global test accuracy: 72.99
Round  21, Train loss: 0.749, Test loss: 1.013, Test accuracy: 66.23
Round  21, Global train loss: 0.749, Global test loss: 0.780, Global test accuracy: 73.53
Round  22, Train loss: 0.742, Test loss: 1.002, Test accuracy: 66.91
Round  22, Global train loss: 0.742, Global test loss: 0.777, Global test accuracy: 74.23
Round  23, Train loss: 0.714, Test loss: 1.010, Test accuracy: 66.88
Round  23, Global train loss: 0.714, Global test loss: 0.782, Global test accuracy: 73.74
Round  24, Train loss: 0.707, Test loss: 1.002, Test accuracy: 67.03
Round  24, Global train loss: 0.707, Global test loss: 0.787, Global test accuracy: 73.34
Round  25, Train loss: 0.728, Test loss: 0.998, Test accuracy: 67.32
Round  25, Global train loss: 0.728, Global test loss: 0.759, Global test accuracy: 74.13
Round  26, Train loss: 0.716, Test loss: 0.984, Test accuracy: 67.70
Round  26, Global train loss: 0.716, Global test loss: 0.758, Global test accuracy: 74.16
Round  27, Train loss: 0.671, Test loss: 0.985, Test accuracy: 67.94
Round  27, Global train loss: 0.671, Global test loss: 0.767, Global test accuracy: 74.53
Round  28, Train loss: 0.690, Test loss: 0.980, Test accuracy: 68.28
Round  28, Global train loss: 0.690, Global test loss: 0.751, Global test accuracy: 75.07
Round  29, Train loss: 0.635, Test loss: 0.978, Test accuracy: 68.64
Round  29, Global train loss: 0.635, Global test loss: 0.773, Global test accuracy: 74.48
Round  30, Train loss: 0.660, Test loss: 0.970, Test accuracy: 69.03
Round  30, Global train loss: 0.660, Global test loss: 0.747, Global test accuracy: 75.21
Round  31, Train loss: 0.640, Test loss: 0.963, Test accuracy: 69.27
Round  31, Global train loss: 0.640, Global test loss: 0.736, Global test accuracy: 75.88
Round  32, Train loss: 0.606, Test loss: 0.960, Test accuracy: 69.44
Round  32, Global train loss: 0.606, Global test loss: 0.759, Global test accuracy: 75.05
Round  33, Train loss: 0.637, Test loss: 0.965, Test accuracy: 69.42
Round  33, Global train loss: 0.637, Global test loss: 0.741, Global test accuracy: 75.46
Round  34, Train loss: 0.630, Test loss: 0.952, Test accuracy: 69.80
Round  34, Global train loss: 0.630, Global test loss: 0.735, Global test accuracy: 75.44
Round  35, Train loss: 0.602, Test loss: 0.955, Test accuracy: 69.88
Round  35, Global train loss: 0.602, Global test loss: 0.745, Global test accuracy: 75.35
Round  36, Train loss: 0.587, Test loss: 0.957, Test accuracy: 70.03
Round  36, Global train loss: 0.587, Global test loss: 0.739, Global test accuracy: 76.08
Round  37, Train loss: 0.621, Test loss: 0.959, Test accuracy: 70.03
Round  37, Global train loss: 0.621, Global test loss: 0.735, Global test accuracy: 76.04
Round  38, Train loss: 0.598, Test loss: 0.951, Test accuracy: 70.28
Round  38, Global train loss: 0.598, Global test loss: 0.724, Global test accuracy: 76.37
Round  39, Train loss: 0.582, Test loss: 0.947, Test accuracy: 70.34
Round  39, Global train loss: 0.582, Global test loss: 0.731, Global test accuracy: 76.06
Round  40, Train loss: 0.614, Test loss: 0.944, Test accuracy: 70.59
Round  40, Global train loss: 0.614, Global test loss: 0.712, Global test accuracy: 75.99
Round  41, Train loss: 0.581, Test loss: 0.946, Test accuracy: 70.53
Round  41, Global train loss: 0.581, Global test loss: 0.724, Global test accuracy: 76.20
Round  42, Train loss: 0.569, Test loss: 0.942, Test accuracy: 70.84
Round  42, Global train loss: 0.569, Global test loss: 0.725, Global test accuracy: 76.64
Round  43, Train loss: 0.542, Test loss: 0.939, Test accuracy: 70.89
Round  43, Global train loss: 0.542, Global test loss: 0.733, Global test accuracy: 76.95
Round  44, Train loss: 0.530, Test loss: 0.944, Test accuracy: 70.88
Round  44, Global train loss: 0.530, Global test loss: 0.736, Global test accuracy: 76.33
Round  45, Train loss: 0.527, Test loss: 0.955, Test accuracy: 70.78
Round  45, Global train loss: 0.527, Global test loss: 0.744, Global test accuracy: 76.22
Round  46, Train loss: 0.546, Test loss: 0.961, Test accuracy: 70.75
Round  46, Global train loss: 0.546, Global test loss: 0.738, Global test accuracy: 76.41
Round  47, Train loss: 0.543, Test loss: 0.966, Test accuracy: 70.91
Round  47, Global train loss: 0.543, Global test loss: 0.729, Global test accuracy: 76.47
Round  48, Train loss: 0.541, Test loss: 0.966, Test accuracy: 70.85
Round  48, Global train loss: 0.541, Global test loss: 0.741, Global test accuracy: 76.28
Round  49, Train loss: 0.515, Test loss: 0.972, Test accuracy: 70.70
Round  49, Global train loss: 0.515, Global test loss: 0.724, Global test accuracy: 76.88
Round  50, Train loss: 0.572, Test loss: 0.959, Test accuracy: 71.05
Round  50, Global train loss: 0.572, Global test loss: 0.712, Global test accuracy: 77.00
Round  51, Train loss: 0.491, Test loss: 0.951, Test accuracy: 71.41
Round  51, Global train loss: 0.491, Global test loss: 0.738, Global test accuracy: 77.04
Round  52, Train loss: 0.533, Test loss: 0.965, Test accuracy: 71.32
Round  52, Global train loss: 0.533, Global test loss: 0.726, Global test accuracy: 76.90
Round  53, Train loss: 0.488, Test loss: 0.955, Test accuracy: 71.43
Round  53, Global train loss: 0.488, Global test loss: 0.736, Global test accuracy: 77.18
Round  54, Train loss: 0.489, Test loss: 0.954, Test accuracy: 71.47
Round  54, Global train loss: 0.489, Global test loss: 0.745, Global test accuracy: 76.69
Round  55, Train loss: 0.500, Test loss: 0.966, Test accuracy: 71.42
Round  55, Global train loss: 0.500, Global test loss: 0.734, Global test accuracy: 77.07
Round  56, Train loss: 0.517, Test loss: 0.965, Test accuracy: 71.52
Round  56, Global train loss: 0.517, Global test loss: 0.727, Global test accuracy: 76.72
Round  57, Train loss: 0.473, Test loss: 0.959, Test accuracy: 71.88
Round  57, Global train loss: 0.473, Global test loss: 0.741, Global test accuracy: 77.08
Round  58, Train loss: 0.487, Test loss: 0.956, Test accuracy: 72.02
Round  58, Global train loss: 0.487, Global test loss: 0.740, Global test accuracy: 76.75
Round  59, Train loss: 0.489, Test loss: 0.955, Test accuracy: 71.98
Round  59, Global train loss: 0.489, Global test loss: 0.725, Global test accuracy: 76.72
Round  60, Train loss: 0.506, Test loss: 0.957, Test accuracy: 72.00
Round  60, Global train loss: 0.506, Global test loss: 0.711, Global test accuracy: 77.25
Round  61, Train loss: 0.455, Test loss: 0.945, Test accuracy: 72.33
Round  61, Global train loss: 0.455, Global test loss: 0.738, Global test accuracy: 76.65
Round  62, Train loss: 0.481, Test loss: 0.942, Test accuracy: 72.54
Round  62, Global train loss: 0.481, Global test loss: 0.740, Global test accuracy: 77.16
Round  63, Train loss: 0.496, Test loss: 0.943, Test accuracy: 72.59
Round  63, Global train loss: 0.496, Global test loss: 0.735, Global test accuracy: 76.87
Round  64, Train loss: 0.464, Test loss: 0.946, Test accuracy: 72.55
Round  64, Global train loss: 0.464, Global test loss: 0.740, Global test accuracy: 77.12
Round  65, Train loss: 0.458, Test loss: 0.939, Test accuracy: 72.70
Round  65, Global train loss: 0.458, Global test loss: 0.747, Global test accuracy: 77.27
Round  66, Train loss: 0.440, Test loss: 0.943, Test accuracy: 72.67
Round  66, Global train loss: 0.440, Global test loss: 0.748, Global test accuracy: 77.17
Round  67, Train loss: 0.486, Test loss: 0.949, Test accuracy: 72.56
Round  67, Global train loss: 0.486, Global test loss: 0.736, Global test accuracy: 77.10
Round  68, Train loss: 0.459, Test loss: 0.943, Test accuracy: 72.71
Round  68, Global train loss: 0.459, Global test loss: 0.748, Global test accuracy: 77.14
Round  69, Train loss: 0.463, Test loss: 0.949, Test accuracy: 72.58
Round  69, Global train loss: 0.463, Global test loss: 0.738, Global test accuracy: 77.29
Round  70, Train loss: 0.481, Test loss: 0.948, Test accuracy: 72.61
Round  70, Global train loss: 0.481, Global test loss: 0.732, Global test accuracy: 77.00
Round  71, Train loss: 0.452, Test loss: 0.964, Test accuracy: 72.44
Round  71, Global train loss: 0.452, Global test loss: 0.744, Global test accuracy: 77.36
Round  72, Train loss: 0.467, Test loss: 0.973, Test accuracy: 72.66
Round  72, Global train loss: 0.467, Global test loss: 0.746, Global test accuracy: 76.48
Round  73, Train loss: 0.467, Test loss: 0.973, Test accuracy: 72.63
Round  73, Global train loss: 0.467, Global test loss: 0.732, Global test accuracy: 77.50
Round  74, Train loss: 0.451, Test loss: 0.987, Test accuracy: 72.50
Round  74, Global train loss: 0.451, Global test loss: 0.762, Global test accuracy: 76.61
Round  75, Train loss: 0.435, Test loss: 0.976, Test accuracy: 72.66
Round  75, Global train loss: 0.435, Global test loss: 0.741, Global test accuracy: 77.46
Round  76, Train loss: 0.413, Test loss: 0.978, Test accuracy: 72.74
Round  76, Global train loss: 0.413, Global test loss: 0.756, Global test accuracy: 77.64
Round  77, Train loss: 0.478, Test loss: 0.965, Test accuracy: 72.99
Round  77, Global train loss: 0.478, Global test loss: 0.734, Global test accuracy: 77.54
Round  78, Train loss: 0.447, Test loss: 0.958, Test accuracy: 73.11
Round  78, Global train loss: 0.447, Global test loss: 0.736, Global test accuracy: 77.73
Round  79, Train loss: 0.391, Test loss: 0.968, Test accuracy: 72.99
Round  79, Global train loss: 0.391, Global test loss: 0.789, Global test accuracy: 76.99
Round  80, Train loss: 0.408, Test loss: 0.968, Test accuracy: 72.91
Round  80, Global train loss: 0.408, Global test loss: 0.761, Global test accuracy: 77.57
Round  81, Train loss: 0.431, Test loss: 0.967, Test accuracy: 73.18
Round  81, Global train loss: 0.431, Global test loss: 0.751, Global test accuracy: 77.69
Round  82, Train loss: 0.431, Test loss: 0.976, Test accuracy: 73.05
Round  82, Global train loss: 0.431, Global test loss: 0.766, Global test accuracy: 76.99
Round  83, Train loss: 0.422, Test loss: 0.978, Test accuracy: 73.01
Round  83, Global train loss: 0.422, Global test loss: 0.760, Global test accuracy: 77.64
Round  84, Train loss: 0.425, Test loss: 0.978, Test accuracy: 72.95
Round  84, Global train loss: 0.425, Global test loss: 0.747, Global test accuracy: 77.38
Round  85, Train loss: 0.420, Test loss: 0.976, Test accuracy: 73.21
Round  85, Global train loss: 0.420, Global test loss: 0.771, Global test accuracy: 77.41
Round  86, Train loss: 0.387, Test loss: 0.973, Test accuracy: 73.20
Round  86, Global train loss: 0.387, Global test loss: 0.773, Global test accuracy: 77.31
Round  87, Train loss: 0.428, Test loss: 0.982, Test accuracy: 72.93
Round  87, Global train loss: 0.428, Global test loss: 0.762, Global test accuracy: 77.02
Round  88, Train loss: 0.439, Test loss: 0.981, Test accuracy: 73.08
Round  88, Global train loss: 0.439, Global test loss: 0.748, Global test accuracy: 77.42
Round  89, Train loss: 0.436, Test loss: 0.977, Test accuracy: 73.24
Round  89, Global train loss: 0.436, Global test loss: 0.748, Global test accuracy: 77.59
Round  90, Train loss: 0.401, Test loss: 0.977, Test accuracy: 73.22
Round  90, Global train loss: 0.401, Global test loss: 0.779, Global test accuracy: 77.28
Round  91, Train loss: 0.390, Test loss: 0.971, Test accuracy: 73.33
Round  91, Global train loss: 0.390, Global test loss: 0.769, Global test accuracy: 77.24
Round  92, Train loss: 0.436, Test loss: 0.976, Test accuracy: 73.27
Round  92, Global train loss: 0.436, Global test loss: 0.753, Global test accuracy: 77.80
Round  93, Train loss: 0.383, Test loss: 0.979, Test accuracy: 73.34
Round  93, Global train loss: 0.383, Global test loss: 0.774, Global test accuracy: 77.64
Round  94, Train loss: 0.396, Test loss: 0.977, Test accuracy: 73.31
Round  94, Global train loss: 0.396, Global test loss: 0.763, Global test accuracy: 77.85
Round  95, Train loss: 0.377, Test loss: 0.980, Test accuracy: 73.55
Round  95, Global train loss: 0.377, Global test loss: 0.778, Global test accuracy: 77.81
Round  96, Train loss: 0.396, Test loss: 0.991, Test accuracy: 73.32
Round  96, Global train loss: 0.396, Global test loss: 0.773, Global test accuracy: 77.63
Round  97, Train loss: 0.394, Test loss: 1.004, Test accuracy: 73.13
Round  97, Global train loss: 0.394, Global test loss: 0.778, Global test accuracy: 77.72
Round  98, Train loss: 0.408, Test loss: 0.996, Test accuracy: 73.25
Round  98, Global train loss: 0.408, Global test loss: 0.757, Global test accuracy: 77.81
Round  99, Train loss: 0.375, Test loss: 1.003, Test accuracy: 73.33
Round  99, Global train loss: 0.375, Global test loss: 0.789, Global test accuracy: 77.58
Final Round, Train loss: 0.232, Test loss: 1.100, Test accuracy: 74.16
Final Round, Global train loss: 0.232, Global test loss: 0.789, Global test accuracy: 77.58
Average accuracy final 10 rounds: 73.30175000000001 

Average global accuracy final 10 rounds: 77.63624999999999 

5954.541583776474
[4.686522722244263, 9.373045444488525, 13.625723361968994, 17.878401279449463, 22.149638652801514, 26.420876026153564, 30.647483348846436, 34.87409067153931, 39.09747385978699, 43.32085704803467, 47.51468563079834, 51.70851421356201, 55.92071580886841, 60.132917404174805, 64.30447030067444, 68.47602319717407, 72.66275334358215, 76.84948348999023, 81.00312685966492, 85.1567702293396, 89.34538769721985, 93.5340051651001, 97.71508717536926, 101.89616918563843, 106.02946519851685, 110.16276121139526, 114.28824925422668, 118.4137372970581, 122.56065034866333, 126.70756340026855, 130.8465268611908, 134.98549032211304, 139.16984915733337, 143.3542079925537, 147.5727949142456, 151.7913818359375, 155.9936375617981, 160.1958932876587, 164.41236877441406, 168.62884426116943, 172.83871483802795, 177.04858541488647, 181.2580807209015, 185.4675760269165, 189.63708424568176, 193.80659246444702, 197.97462701797485, 202.14266157150269, 206.30851936340332, 210.47437715530396, 214.66258215904236, 218.85078716278076, 223.04111671447754, 227.23144626617432, 231.4269824028015, 235.6225185394287, 239.84921050071716, 244.07590246200562, 248.2840588092804, 252.49221515655518, 256.7188489437103, 260.9454827308655, 265.12051582336426, 269.29554891586304, 273.4717059135437, 277.64786291122437, 282.407963514328, 287.16806411743164, 291.40520191192627, 295.6423397064209, 299.81139945983887, 303.98045921325684, 308.2853150367737, 312.5901708602905, 316.7410054206848, 320.8918399810791, 325.0635983943939, 329.23535680770874, 333.40927600860596, 337.5831952095032, 341.76268696784973, 345.9421787261963, 350.12949800491333, 354.31681728363037, 358.4641604423523, 362.6115036010742, 366.84090995788574, 371.07031631469727, 375.25447249412537, 379.43862867355347, 383.6386866569519, 387.83874464035034, 392.0778567790985, 396.3169689178467, 400.5399971008301, 404.7630252838135, 409.0301651954651, 413.2973051071167, 417.60807371139526, 421.9188423156738, 426.1702015399933, 430.42156076431274, 434.6034789085388, 438.7853970527649, 442.9643852710724, 447.1433734893799, 451.3271725177765, 455.5109715461731, 459.66597175598145, 463.8209719657898, 467.9817883968353, 472.14260482788086, 476.33547925949097, 480.5283536911011, 484.7450716495514, 488.9617896080017, 493.1615643501282, 497.36133909225464, 501.56272649765015, 505.76411390304565, 509.9711468219757, 514.1781797409058, 518.3870544433594, 522.595929145813, 526.8193416595459, 531.0427541732788, 535.2304246425629, 539.4180951118469, 543.6421902179718, 547.8662853240967, 552.144935131073, 556.4235849380493, 560.6669270992279, 564.9102692604065, 569.1254959106445, 573.3407225608826, 577.6304557323456, 581.9201889038086, 586.1221926212311, 590.3241963386536, 594.5542843341827, 598.7843723297119, 602.9873094558716, 607.1902465820312, 611.4366886615753, 615.6831307411194, 620.5392270088196, 625.3953232765198, 630.2111494541168, 635.0269756317139, 639.786783695221, 644.546591758728, 649.2759547233582, 654.0053176879883, 658.694572687149, 663.3838276863098, 668.0264811515808, 672.6691346168518, 677.2435436248779, 681.817952632904, 686.3594872951508, 690.9010219573975, 695.4469068050385, 699.9927916526794, 704.5749292373657, 709.157066822052, 713.8232500553131, 718.4894332885742, 723.2827458381653, 728.0760583877563, 732.7558240890503, 737.4355897903442, 742.0332260131836, 746.630862236023, 751.3620917797089, 756.0933213233948, 760.9186406135559, 765.743959903717, 770.5438771247864, 775.3437943458557, 780.1359477043152, 784.9281010627747, 789.5113372802734, 794.0945734977722, 798.7332532405853, 803.3719329833984, 807.9952054023743, 812.6184778213501, 817.3963444232941, 822.174211025238, 826.8943884372711, 831.6145658493042, 836.4175908565521, 841.2206158638, 845.8491702079773, 850.4777245521545, 854.8329565525055, 859.1881885528564, 863.4481840133667, 867.708179473877, 869.913455247879, 872.1187310218811]
[37.43, 37.43, 42.8375, 42.8375, 45.44, 45.44, 47.665, 47.665, 51.185, 51.185, 52.055, 52.055, 53.8675, 53.8675, 54.2925, 54.2925, 56.26, 56.26, 58.3425, 58.3425, 59.5575, 59.5575, 59.935, 59.935, 60.9325, 60.9325, 62.19, 62.19, 62.5575, 62.5575, 63.725, 63.725, 63.975, 63.975, 64.4325, 64.4325, 65.18, 65.18, 65.3425, 65.3425, 65.9375, 65.9375, 66.235, 66.235, 66.905, 66.905, 66.875, 66.875, 67.035, 67.035, 67.32, 67.32, 67.705, 67.705, 67.9425, 67.9425, 68.2825, 68.2825, 68.64, 68.64, 69.0325, 69.0325, 69.2725, 69.2725, 69.435, 69.435, 69.425, 69.425, 69.795, 69.795, 69.8775, 69.8775, 70.025, 70.025, 70.0325, 70.0325, 70.285, 70.285, 70.34, 70.34, 70.595, 70.595, 70.525, 70.525, 70.84, 70.84, 70.895, 70.895, 70.8825, 70.8825, 70.7775, 70.7775, 70.755, 70.755, 70.91, 70.91, 70.85, 70.85, 70.7, 70.7, 71.05, 71.05, 71.41, 71.41, 71.32, 71.32, 71.4275, 71.4275, 71.475, 71.475, 71.4175, 71.4175, 71.52, 71.52, 71.875, 71.875, 72.0225, 72.0225, 71.98, 71.98, 72.005, 72.005, 72.33, 72.33, 72.5375, 72.5375, 72.5925, 72.5925, 72.5475, 72.5475, 72.705, 72.705, 72.6725, 72.6725, 72.5625, 72.5625, 72.7125, 72.7125, 72.575, 72.575, 72.605, 72.605, 72.4425, 72.4425, 72.655, 72.655, 72.6275, 72.6275, 72.5, 72.5, 72.66, 72.66, 72.74, 72.74, 72.99, 72.99, 73.1075, 73.1075, 72.9875, 72.9875, 72.905, 72.905, 73.1775, 73.1775, 73.045, 73.045, 73.0125, 73.0125, 72.95, 72.95, 73.2125, 73.2125, 73.2, 73.2, 72.9275, 72.9275, 73.0775, 73.0775, 73.24, 73.24, 73.2175, 73.2175, 73.325, 73.325, 73.265, 73.265, 73.34, 73.34, 73.305, 73.305, 73.5475, 73.5475, 73.3175, 73.3175, 73.1275, 73.1275, 73.245, 73.245, 73.3275, 73.3275, 74.16, 74.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.033, Test loss: 1.831, Test accuracy: 32.91
Round   0, Global train loss: 2.033, Global test loss: 1.825, Global test accuracy: 33.68
Round   1, Train loss: 1.786, Test loss: 1.674, Test accuracy: 38.52
Round   1, Global train loss: 1.786, Global test loss: 1.608, Global test accuracy: 41.61
Round   2, Train loss: 1.677, Test loss: 1.606, Test accuracy: 40.99
Round   2, Global train loss: 1.677, Global test loss: 1.491, Global test accuracy: 46.20
Round   3, Train loss: 1.607, Test loss: 1.568, Test accuracy: 42.37
Round   3, Global train loss: 1.607, Global test loss: 1.426, Global test accuracy: 48.82
Round   4, Train loss: 1.538, Test loss: 1.557, Test accuracy: 42.90
Round   4, Global train loss: 1.538, Global test loss: 1.365, Global test accuracy: 51.11
Round   5, Train loss: 1.481, Test loss: 1.512, Test accuracy: 44.78
Round   5, Global train loss: 1.481, Global test loss: 1.302, Global test accuracy: 52.97
Round   6, Train loss: 1.449, Test loss: 1.461, Test accuracy: 46.98
Round   6, Global train loss: 1.449, Global test loss: 1.279, Global test accuracy: 54.40
Round   7, Train loss: 1.391, Test loss: 1.408, Test accuracy: 48.95
Round   7, Global train loss: 1.391, Global test loss: 1.232, Global test accuracy: 56.56
Round   8, Train loss: 1.339, Test loss: 1.387, Test accuracy: 49.94
Round   8, Global train loss: 1.339, Global test loss: 1.224, Global test accuracy: 56.74
Round   9, Train loss: 1.326, Test loss: 1.343, Test accuracy: 51.59
Round   9, Global train loss: 1.326, Global test loss: 1.156, Global test accuracy: 59.22
Round  10, Train loss: 1.275, Test loss: 1.328, Test accuracy: 52.26
Round  10, Global train loss: 1.275, Global test loss: 1.136, Global test accuracy: 59.47
Round  11, Train loss: 1.256, Test loss: 1.289, Test accuracy: 53.76
Round  11, Global train loss: 1.256, Global test loss: 1.101, Global test accuracy: 61.47
Round  12, Train loss: 1.214, Test loss: 1.278, Test accuracy: 54.19
Round  12, Global train loss: 1.214, Global test loss: 1.087, Global test accuracy: 62.09
Round  13, Train loss: 1.200, Test loss: 1.231, Test accuracy: 56.20
Round  13, Global train loss: 1.200, Global test loss: 1.066, Global test accuracy: 62.49
Round  14, Train loss: 1.175, Test loss: 1.214, Test accuracy: 56.77
Round  14, Global train loss: 1.175, Global test loss: 1.040, Global test accuracy: 63.95
Round  15, Train loss: 1.139, Test loss: 1.196, Test accuracy: 57.40
Round  15, Global train loss: 1.139, Global test loss: 1.020, Global test accuracy: 63.93
Round  16, Train loss: 1.151, Test loss: 1.161, Test accuracy: 58.73
Round  16, Global train loss: 1.151, Global test loss: 1.000, Global test accuracy: 65.15
Round  17, Train loss: 1.099, Test loss: 1.135, Test accuracy: 59.90
Round  17, Global train loss: 1.099, Global test loss: 0.974, Global test accuracy: 66.62
Round  18, Train loss: 1.070, Test loss: 1.134, Test accuracy: 59.93
Round  18, Global train loss: 1.070, Global test loss: 0.959, Global test accuracy: 66.86
Round  19, Train loss: 1.079, Test loss: 1.107, Test accuracy: 61.12
Round  19, Global train loss: 1.079, Global test loss: 0.946, Global test accuracy: 67.42
Round  20, Train loss: 1.056, Test loss: 1.095, Test accuracy: 61.59
Round  20, Global train loss: 1.056, Global test loss: 0.935, Global test accuracy: 67.59
Round  21, Train loss: 1.027, Test loss: 1.080, Test accuracy: 62.05
Round  21, Global train loss: 1.027, Global test loss: 0.915, Global test accuracy: 68.48
Round  22, Train loss: 1.010, Test loss: 1.059, Test accuracy: 62.92
Round  22, Global train loss: 1.010, Global test loss: 0.908, Global test accuracy: 68.44
Round  23, Train loss: 0.986, Test loss: 1.064, Test accuracy: 62.82
Round  23, Global train loss: 0.986, Global test loss: 0.897, Global test accuracy: 68.38
Round  24, Train loss: 0.949, Test loss: 1.063, Test accuracy: 63.01
Round  24, Global train loss: 0.949, Global test loss: 0.890, Global test accuracy: 68.85
Round  25, Train loss: 0.950, Test loss: 1.063, Test accuracy: 63.09
Round  25, Global train loss: 0.950, Global test loss: 0.883, Global test accuracy: 69.40
Round  26, Train loss: 0.943, Test loss: 1.054, Test accuracy: 63.36
Round  26, Global train loss: 0.943, Global test loss: 0.867, Global test accuracy: 70.03
Round  27, Train loss: 0.933, Test loss: 1.048, Test accuracy: 63.54
Round  27, Global train loss: 0.933, Global test loss: 0.861, Global test accuracy: 70.06
Round  28, Train loss: 0.916, Test loss: 1.030, Test accuracy: 64.17
Round  28, Global train loss: 0.916, Global test loss: 0.848, Global test accuracy: 70.51
Round  29, Train loss: 0.874, Test loss: 1.011, Test accuracy: 65.04
Round  29, Global train loss: 0.874, Global test loss: 0.844, Global test accuracy: 70.76
Round  30, Train loss: 0.903, Test loss: 0.991, Test accuracy: 65.75
Round  30, Global train loss: 0.903, Global test loss: 0.835, Global test accuracy: 71.30
Round  31, Train loss: 0.885, Test loss: 0.982, Test accuracy: 66.08
Round  31, Global train loss: 0.885, Global test loss: 0.823, Global test accuracy: 71.14
Round  32, Train loss: 0.883, Test loss: 0.977, Test accuracy: 66.47
Round  32, Global train loss: 0.883, Global test loss: 0.817, Global test accuracy: 71.88
Round  33, Train loss: 0.865, Test loss: 0.989, Test accuracy: 66.22
Round  33, Global train loss: 0.865, Global test loss: 0.814, Global test accuracy: 71.83
Round  34, Train loss: 0.839, Test loss: 0.982, Test accuracy: 66.37
Round  34, Global train loss: 0.839, Global test loss: 0.801, Global test accuracy: 72.14
Round  35, Train loss: 0.843, Test loss: 0.973, Test accuracy: 66.73
Round  35, Global train loss: 0.843, Global test loss: 0.795, Global test accuracy: 72.37
Round  36, Train loss: 0.837, Test loss: 0.968, Test accuracy: 67.01
Round  36, Global train loss: 0.837, Global test loss: 0.799, Global test accuracy: 72.65
Round  37, Train loss: 0.834, Test loss: 0.961, Test accuracy: 67.23
Round  37, Global train loss: 0.834, Global test loss: 0.780, Global test accuracy: 72.93
Round  38, Train loss: 0.822, Test loss: 0.963, Test accuracy: 67.08
Round  38, Global train loss: 0.822, Global test loss: 0.788, Global test accuracy: 72.52
Round  39, Train loss: 0.795, Test loss: 0.946, Test accuracy: 67.51
Round  39, Global train loss: 0.795, Global test loss: 0.773, Global test accuracy: 73.01
Round  40, Train loss: 0.789, Test loss: 0.942, Test accuracy: 67.76
Round  40, Global train loss: 0.789, Global test loss: 0.784, Global test accuracy: 72.91
Round  41, Train loss: 0.784, Test loss: 0.939, Test accuracy: 67.80
Round  41, Global train loss: 0.784, Global test loss: 0.773, Global test accuracy: 72.75
Round  42, Train loss: 0.776, Test loss: 0.919, Test accuracy: 68.37
Round  42, Global train loss: 0.776, Global test loss: 0.758, Global test accuracy: 73.46
Round  43, Train loss: 0.759, Test loss: 0.924, Test accuracy: 68.25
Round  43, Global train loss: 0.759, Global test loss: 0.764, Global test accuracy: 73.81
Round  44, Train loss: 0.768, Test loss: 0.923, Test accuracy: 68.45
Round  44, Global train loss: 0.768, Global test loss: 0.762, Global test accuracy: 73.43
Round  45, Train loss: 0.767, Test loss: 0.920, Test accuracy: 68.67
Round  45, Global train loss: 0.767, Global test loss: 0.750, Global test accuracy: 74.01
Round  46, Train loss: 0.741, Test loss: 0.912, Test accuracy: 69.07
Round  46, Global train loss: 0.741, Global test loss: 0.749, Global test accuracy: 73.77
Round  47, Train loss: 0.740, Test loss: 0.910, Test accuracy: 68.94
Round  47, Global train loss: 0.740, Global test loss: 0.747, Global test accuracy: 73.86
Round  48, Train loss: 0.733, Test loss: 0.913, Test accuracy: 68.89
Round  48, Global train loss: 0.733, Global test loss: 0.749, Global test accuracy: 73.95
Round  49, Train loss: 0.721, Test loss: 0.899, Test accuracy: 69.40
Round  49, Global train loss: 0.721, Global test loss: 0.750, Global test accuracy: 74.27
Round  50, Train loss: 0.737, Test loss: 0.895, Test accuracy: 69.73
Round  50, Global train loss: 0.737, Global test loss: 0.739, Global test accuracy: 74.87
Round  51, Train loss: 0.708, Test loss: 0.888, Test accuracy: 70.09
Round  51, Global train loss: 0.708, Global test loss: 0.735, Global test accuracy: 75.08
Round  52, Train loss: 0.700, Test loss: 0.887, Test accuracy: 70.16
Round  52, Global train loss: 0.700, Global test loss: 0.735, Global test accuracy: 75.07
Round  53, Train loss: 0.693, Test loss: 0.887, Test accuracy: 70.13
Round  53, Global train loss: 0.693, Global test loss: 0.735, Global test accuracy: 74.84
Round  54, Train loss: 0.693, Test loss: 0.891, Test accuracy: 70.05
Round  54, Global train loss: 0.693, Global test loss: 0.731, Global test accuracy: 74.80
Round  55, Train loss: 0.679, Test loss: 0.895, Test accuracy: 70.19
Round  55, Global train loss: 0.679, Global test loss: 0.732, Global test accuracy: 75.10
Round  56, Train loss: 0.676, Test loss: 0.891, Test accuracy: 70.42
Round  56, Global train loss: 0.676, Global test loss: 0.739, Global test accuracy: 74.89
Round  57, Train loss: 0.661, Test loss: 0.890, Test accuracy: 70.52
Round  57, Global train loss: 0.661, Global test loss: 0.735, Global test accuracy: 74.87
Round  58, Train loss: 0.671, Test loss: 0.885, Test accuracy: 70.69
Round  58, Global train loss: 0.671, Global test loss: 0.731, Global test accuracy: 75.16
Round  59, Train loss: 0.670, Test loss: 0.886, Test accuracy: 70.83
Round  59, Global train loss: 0.670, Global test loss: 0.733, Global test accuracy: 75.23
Round  60, Train loss: 0.644, Test loss: 0.880, Test accuracy: 70.95
Round  60, Global train loss: 0.644, Global test loss: 0.729, Global test accuracy: 75.44
Round  61, Train loss: 0.648, Test loss: 0.877, Test accuracy: 71.08
Round  61, Global train loss: 0.648, Global test loss: 0.722, Global test accuracy: 75.86
Round  62, Train loss: 0.659, Test loss: 0.875, Test accuracy: 71.28
Round  62, Global train loss: 0.659, Global test loss: 0.721, Global test accuracy: 75.50
Round  63, Train loss: 0.635, Test loss: 0.877, Test accuracy: 71.05
Round  63, Global train loss: 0.635, Global test loss: 0.728, Global test accuracy: 75.25
Round  64, Train loss: 0.638, Test loss: 0.884, Test accuracy: 70.75
Round  64, Global train loss: 0.638, Global test loss: 0.728, Global test accuracy: 75.36
Round  65, Train loss: 0.657, Test loss: 0.884, Test accuracy: 70.92
Round  65, Global train loss: 0.657, Global test loss: 0.710, Global test accuracy: 75.48
Round  66, Train loss: 0.642, Test loss: 0.879, Test accuracy: 71.20
Round  66, Global train loss: 0.642, Global test loss: 0.709, Global test accuracy: 76.18
Round  67, Train loss: 0.616, Test loss: 0.876, Test accuracy: 71.42
Round  67, Global train loss: 0.616, Global test loss: 0.709, Global test accuracy: 75.94
Round  68, Train loss: 0.618, Test loss: 0.877, Test accuracy: 71.58
Round  68, Global train loss: 0.618, Global test loss: 0.718, Global test accuracy: 76.08
Round  69, Train loss: 0.593, Test loss: 0.865, Test accuracy: 71.81
Round  69, Global train loss: 0.593, Global test loss: 0.724, Global test accuracy: 75.71
Round  70, Train loss: 0.612, Test loss: 0.867, Test accuracy: 71.84
Round  70, Global train loss: 0.612, Global test loss: 0.713, Global test accuracy: 75.83
Round  71, Train loss: 0.606, Test loss: 0.864, Test accuracy: 71.90
Round  71, Global train loss: 0.606, Global test loss: 0.713, Global test accuracy: 76.46
Round  72, Train loss: 0.578, Test loss: 0.871, Test accuracy: 71.89
Round  72, Global train loss: 0.578, Global test loss: 0.735, Global test accuracy: 75.92
Round  73, Train loss: 0.592, Test loss: 0.874, Test accuracy: 71.80
Round  73, Global train loss: 0.592, Global test loss: 0.723, Global test accuracy: 76.03
Round  74, Train loss: 0.607, Test loss: 0.877, Test accuracy: 71.94
Round  74, Global train loss: 0.607, Global test loss: 0.711, Global test accuracy: 76.24
Round  75, Train loss: 0.586, Test loss: 0.875, Test accuracy: 71.79
Round  75, Global train loss: 0.586, Global test loss: 0.723, Global test accuracy: 75.90
Round  76, Train loss: 0.593, Test loss: 0.880, Test accuracy: 71.92
Round  76, Global train loss: 0.593, Global test loss: 0.720, Global test accuracy: 75.81
Round  77, Train loss: 0.608, Test loss: 0.872, Test accuracy: 71.97
Round  77, Global train loss: 0.608, Global test loss: 0.708, Global test accuracy: 76.27
Round  78, Train loss: 0.580, Test loss: 0.867, Test accuracy: 72.08
Round  78, Global train loss: 0.580, Global test loss: 0.717, Global test accuracy: 75.97
Round  79, Train loss: 0.597, Test loss: 0.878, Test accuracy: 71.86
Round  79, Global train loss: 0.597, Global test loss: 0.729, Global test accuracy: 75.50
Round  80, Train loss: 0.581, Test loss: 0.878, Test accuracy: 71.94
Round  80, Global train loss: 0.581, Global test loss: 0.710, Global test accuracy: 76.19
Round  81, Train loss: 0.578, Test loss: 0.869, Test accuracy: 72.20
Round  81, Global train loss: 0.578, Global test loss: 0.711, Global test accuracy: 76.46
Round  82, Train loss: 0.567, Test loss: 0.875, Test accuracy: 72.12
Round  82, Global train loss: 0.567, Global test loss: 0.715, Global test accuracy: 76.19
Round  83, Train loss: 0.568, Test loss: 0.876, Test accuracy: 72.19
Round  83, Global train loss: 0.568, Global test loss: 0.711, Global test accuracy: 76.39
Round  84, Train loss: 0.583, Test loss: 0.867, Test accuracy: 72.45
Round  84, Global train loss: 0.583, Global test loss: 0.704, Global test accuracy: 76.54
Round  85, Train loss: 0.571, Test loss: 0.863, Test accuracy: 72.52
Round  85, Global train loss: 0.571, Global test loss: 0.700, Global test accuracy: 76.84
Round  86, Train loss: 0.549, Test loss: 0.864, Test accuracy: 72.57
Round  86, Global train loss: 0.549, Global test loss: 0.704, Global test accuracy: 77.01
Round  87, Train loss: 0.560, Test loss: 0.863, Test accuracy: 72.43
Round  87, Global train loss: 0.560, Global test loss: 0.710, Global test accuracy: 76.45
Round  88, Train loss: 0.565, Test loss: 0.870, Test accuracy: 72.36
Round  88, Global train loss: 0.565, Global test loss: 0.716, Global test accuracy: 76.34
Round  89, Train loss: 0.536, Test loss: 0.867, Test accuracy: 72.43
Round  89, Global train loss: 0.536, Global test loss: 0.710, Global test accuracy: 76.51
Round  90, Train loss: 0.568, Test loss: 0.861, Test accuracy: 72.67
Round  90, Global train loss: 0.568, Global test loss: 0.698, Global test accuracy: 76.84
Round  91, Train loss: 0.545, Test loss: 0.858, Test accuracy: 72.83
Round  91, Global train loss: 0.545, Global test loss: 0.702, Global test accuracy: 77.00
Round  92, Train loss: 0.528, Test loss: 0.866, Test accuracy: 72.66
Round  92, Global train loss: 0.528, Global test loss: 0.711, Global test accuracy: 76.67
Round  93, Train loss: 0.542, Test loss: 0.871, Test accuracy: 72.80
Round  93, Global train loss: 0.542, Global test loss: 0.708, Global test accuracy: 76.93
Round  94, Train loss: 0.531, Test loss: 0.867, Test accuracy: 72.92
Round  94, Global train loss: 0.531, Global test loss: 0.712, Global test accuracy: 76.84
Round  95, Train loss: 0.533, Test loss: 0.872, Test accuracy: 72.80
Round  95, Global train loss: 0.533, Global test loss: 0.707, Global test accuracy: 76.94/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 0.528, Test loss: 0.867, Test accuracy: 72.89
Round  96, Global train loss: 0.528, Global test loss: 0.702, Global test accuracy: 77.14
Round  97, Train loss: 0.524, Test loss: 0.864, Test accuracy: 72.94
Round  97, Global train loss: 0.524, Global test loss: 0.711, Global test accuracy: 77.11
Round  98, Train loss: 0.539, Test loss: 0.867, Test accuracy: 72.94
Round  98, Global train loss: 0.539, Global test loss: 0.716, Global test accuracy: 76.75
Round  99, Train loss: 0.509, Test loss: 0.871, Test accuracy: 72.91
Round  99, Global train loss: 0.509, Global test loss: 0.712, Global test accuracy: 76.88
Final Round, Train loss: 0.343, Test loss: 0.945, Test accuracy: 73.18
Final Round, Global train loss: 0.343, Global test loss: 0.712, Global test accuracy: 76.88
Average accuracy final 10 rounds: 72.83525 

Average global accuracy final 10 rounds: 76.90950000000001 

6206.554260253906
[5.392897844314575, 10.78579568862915, 15.99549388885498, 21.20519208908081, 26.445899724960327, 31.686607360839844, 36.33242464065552, 40.97824192047119, 45.69509696960449, 50.41195201873779, 55.06947445869446, 59.72699689865112, 64.30897545814514, 68.89095401763916, 73.46114444732666, 78.03133487701416, 82.6001501083374, 87.16896533966064, 91.76506018638611, 96.36115503311157, 100.95667576789856, 105.55219650268555, 110.09925270080566, 114.64630889892578, 119.16953659057617, 123.69276428222656, 128.25843739509583, 132.8241105079651, 137.38771557807922, 141.95132064819336, 146.4933569431305, 151.03539323806763, 155.58383083343506, 160.1322684288025, 164.72237730026245, 169.3124861717224, 173.92216205596924, 178.53183794021606, 183.07939434051514, 187.6269507408142, 192.24844479560852, 196.86993885040283, 201.50662660598755, 206.14331436157227, 210.7399880886078, 215.3366618156433, 219.92550086975098, 224.51433992385864, 229.102641582489, 233.69094324111938, 238.29206895828247, 242.89319467544556, 247.4763946533203, 252.05959463119507, 256.6412332057953, 261.2228717803955, 265.7927393913269, 270.3626070022583, 274.9417004585266, 279.5207939147949, 284.0888695716858, 288.65694522857666, 293.2276692390442, 297.7983932495117, 302.3870668411255, 306.97574043273926, 311.5941779613495, 316.2126154899597, 320.81291913986206, 325.4132227897644, 329.9576015472412, 334.501980304718, 339.0831685066223, 343.6643567085266, 348.25814032554626, 352.8519239425659, 357.44265627861023, 362.03338861465454, 366.6092929840088, 371.18519735336304, 375.74222683906555, 380.29925632476807, 384.8597855567932, 389.42031478881836, 393.97979831695557, 398.5392818450928, 403.1285238265991, 407.71776580810547, 412.29433131217957, 416.87089681625366, 421.4943935871124, 426.1178903579712, 430.73829555511475, 435.3587007522583, 439.9188721179962, 444.47904348373413, 449.07959604263306, 453.680148601532, 458.2812407016754, 462.88233280181885, 467.48477840423584, 472.08722400665283, 476.680846452713, 481.2744688987732, 485.86601305007935, 490.4575572013855, 495.0399172306061, 499.62227725982666, 504.2100567817688, 508.79783630371094, 513.3942711353302, 517.9907059669495, 522.590765953064, 527.1908259391785, 531.7607581615448, 536.3306903839111, 540.8962824344635, 545.4618744850159, 550.0580205917358, 554.6541666984558, 559.2113087177277, 563.7684507369995, 568.3464193344116, 572.9243879318237, 577.4882600307465, 582.0521321296692, 586.62442278862, 591.1967134475708, 595.8013808727264, 600.4060482978821, 604.988030910492, 609.5700135231018, 614.1513130664825, 618.7326126098633, 623.3172786235809, 627.9019446372986, 632.5294287204742, 637.1569128036499, 641.7667684555054, 646.3766241073608, 650.9921977519989, 655.607771396637, 660.2011122703552, 664.7944531440735, 669.4203336238861, 674.0462141036987, 678.6282649040222, 683.2103157043457, 687.7945828437805, 692.3788499832153, 696.9602077007294, 701.5415654182434, 706.1107444763184, 710.6799235343933, 715.2776734828949, 719.8754234313965, 724.4564802646637, 729.0375370979309, 733.6083512306213, 738.1791653633118, 742.7480297088623, 747.3168940544128, 751.9693217277527, 756.6217494010925, 761.1998631954193, 765.7779769897461, 770.3376932144165, 774.8974094390869, 779.4557857513428, 784.0141620635986, 788.5924150943756, 793.1706681251526, 797.7561101913452, 802.3415522575378, 806.9552733898163, 811.5689945220947, 816.127875328064, 820.6867561340332, 825.2462809085846, 829.805805683136, 834.3967945575714, 838.9877834320068, 843.5512828826904, 848.114782333374, 852.6595740318298, 857.2043657302856, 861.7762517929077, 866.3481378555298, 870.9177513122559, 875.4873647689819, 880.0375926494598, 884.5878205299377, 889.1246752738953, 893.6615300178528, 898.2109370231628, 902.7603440284729, 907.2902021408081, 911.8200602531433, 916.3682639598846, 920.916467666626, 923.2039284706116, 925.4913892745972]
[32.905, 32.905, 38.5225, 38.5225, 40.9875, 40.9875, 42.3675, 42.3675, 42.895, 42.895, 44.78, 44.78, 46.9825, 46.9825, 48.955, 48.955, 49.9425, 49.9425, 51.5925, 51.5925, 52.2625, 52.2625, 53.755, 53.755, 54.1875, 54.1875, 56.1975, 56.1975, 56.7675, 56.7675, 57.3975, 57.3975, 58.725, 58.725, 59.8975, 59.8975, 59.93, 59.93, 61.115, 61.115, 61.5925, 61.5925, 62.05, 62.05, 62.925, 62.925, 62.8225, 62.8225, 63.0075, 63.0075, 63.085, 63.085, 63.3575, 63.3575, 63.54, 63.54, 64.1725, 64.1725, 65.0425, 65.0425, 65.745, 65.745, 66.085, 66.085, 66.475, 66.475, 66.22, 66.22, 66.37, 66.37, 66.7325, 66.7325, 67.0075, 67.0075, 67.23, 67.23, 67.08, 67.08, 67.5075, 67.5075, 67.7575, 67.7575, 67.7975, 67.7975, 68.3725, 68.3725, 68.2525, 68.2525, 68.4475, 68.4475, 68.675, 68.675, 69.0725, 69.0725, 68.94, 68.94, 68.895, 68.895, 69.3975, 69.3975, 69.7325, 69.7325, 70.095, 70.095, 70.155, 70.155, 70.13, 70.13, 70.0525, 70.0525, 70.1925, 70.1925, 70.42, 70.42, 70.5175, 70.5175, 70.6875, 70.6875, 70.8325, 70.8325, 70.95, 70.95, 71.0825, 71.0825, 71.275, 71.275, 71.05, 71.05, 70.745, 70.745, 70.925, 70.925, 71.2025, 71.2025, 71.4225, 71.4225, 71.585, 71.585, 71.805, 71.805, 71.84, 71.84, 71.9025, 71.9025, 71.89, 71.89, 71.8025, 71.8025, 71.9425, 71.9425, 71.7925, 71.7925, 71.925, 71.925, 71.9675, 71.9675, 72.0825, 72.0825, 71.855, 71.855, 71.945, 71.945, 72.2, 72.2, 72.12, 72.12, 72.185, 72.185, 72.455, 72.455, 72.515, 72.515, 72.5675, 72.5675, 72.43, 72.43, 72.36, 72.36, 72.4325, 72.4325, 72.675, 72.675, 72.835, 72.835, 72.655, 72.655, 72.8, 72.8, 72.9225, 72.9225, 72.795, 72.795, 72.8875, 72.8875, 72.9375, 72.9375, 72.935, 72.935, 72.91, 72.91, 73.1825, 73.1825]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Co-teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.237, Test loss: 1.976, Test accuracy: 31.79
Round   1, Train loss: 1.899, Test loss: 1.637, Test accuracy: 41.78
Round   2, Train loss: 1.682, Test loss: 1.522, Test accuracy: 46.85
Round   3, Train loss: 1.580, Test loss: 1.439, Test accuracy: 50.29
Round   4, Train loss: 1.506, Test loss: 1.368, Test accuracy: 53.04
Round   5, Train loss: 1.438, Test loss: 1.301, Test accuracy: 54.73
Round   6, Train loss: 1.376, Test loss: 1.213, Test accuracy: 58.02
Round   7, Train loss: 1.316, Test loss: 1.190, Test accuracy: 59.15
Round   8, Train loss: 1.270, Test loss: 1.138, Test accuracy: 61.36
Round   9, Train loss: 1.210, Test loss: 1.110, Test accuracy: 62.21
Round  10, Train loss: 1.185, Test loss: 1.089, Test accuracy: 63.01
Round  11, Train loss: 1.143, Test loss: 1.041, Test accuracy: 64.42
Round  12, Train loss: 1.119, Test loss: 1.010, Test accuracy: 65.35
Round  13, Train loss: 1.080, Test loss: 0.988, Test accuracy: 66.16
Round  14, Train loss: 1.039, Test loss: 0.985, Test accuracy: 66.02
Round  15, Train loss: 1.038, Test loss: 0.963, Test accuracy: 67.28
Round  16, Train loss: 1.002, Test loss: 0.952, Test accuracy: 67.48
Round  17, Train loss: 0.988, Test loss: 0.943, Test accuracy: 68.37
Round  18, Train loss: 0.970, Test loss: 0.921, Test accuracy: 68.89
Round  19, Train loss: 0.949, Test loss: 0.905, Test accuracy: 69.18
Round  20, Train loss: 0.928, Test loss: 0.908, Test accuracy: 69.37
Round  21, Train loss: 0.931, Test loss: 0.866, Test accuracy: 70.75
Round  22, Train loss: 0.880, Test loss: 0.858, Test accuracy: 70.95
Round  23, Train loss: 0.878, Test loss: 0.846, Test accuracy: 71.44
Round  24, Train loss: 0.878, Test loss: 0.830, Test accuracy: 71.84
Round  25, Train loss: 0.832, Test loss: 0.842, Test accuracy: 71.53
Round  26, Train loss: 0.845, Test loss: 0.830, Test accuracy: 71.79
Round  27, Train loss: 0.819, Test loss: 0.841, Test accuracy: 71.61
Round  28, Train loss: 0.816, Test loss: 0.818, Test accuracy: 72.12
Round  29, Train loss: 0.836, Test loss: 0.800, Test accuracy: 72.95
Round  30, Train loss: 0.782, Test loss: 0.808, Test accuracy: 72.94
Round  31, Train loss: 0.796, Test loss: 0.795, Test accuracy: 73.19
Round  32, Train loss: 0.788, Test loss: 0.771, Test accuracy: 74.18
Round  33, Train loss: 0.737, Test loss: 0.772, Test accuracy: 73.73
Round  34, Train loss: 0.743, Test loss: 0.771, Test accuracy: 73.86
Round  35, Train loss: 0.741, Test loss: 0.778, Test accuracy: 73.48
Round  36, Train loss: 0.718, Test loss: 0.776, Test accuracy: 73.53
Round  37, Train loss: 0.689, Test loss: 0.774, Test accuracy: 73.68
Round  38, Train loss: 0.723, Test loss: 0.769, Test accuracy: 73.64
Round  39, Train loss: 0.694, Test loss: 0.774, Test accuracy: 73.83
Round  40, Train loss: 0.732, Test loss: 0.758, Test accuracy: 74.16
Round  41, Train loss: 0.739, Test loss: 0.752, Test accuracy: 74.52
Round  42, Train loss: 0.701, Test loss: 0.749, Test accuracy: 74.47
Round  43, Train loss: 0.667, Test loss: 0.747, Test accuracy: 74.87
Round  44, Train loss: 0.685, Test loss: 0.739, Test accuracy: 75.27
Round  45, Train loss: 0.687, Test loss: 0.736, Test accuracy: 75.33
Round  46, Train loss: 0.682, Test loss: 0.734, Test accuracy: 75.25
Round  47, Train loss: 0.647, Test loss: 0.732, Test accuracy: 75.23
Round  48, Train loss: 0.620, Test loss: 0.738, Test accuracy: 75.15
Round  49, Train loss: 0.651, Test loss: 0.724, Test accuracy: 75.58
Round  50, Train loss: 0.633, Test loss: 0.732, Test accuracy: 75.27
Round  51, Train loss: 0.649, Test loss: 0.720, Test accuracy: 75.50
Round  52, Train loss: 0.632, Test loss: 0.720, Test accuracy: 75.62
Round  53, Train loss: 0.637, Test loss: 0.726, Test accuracy: 75.26
Round  54, Train loss: 0.636, Test loss: 0.714, Test accuracy: 75.84
Round  55, Train loss: 0.622, Test loss: 0.720, Test accuracy: 75.81
Round  56, Train loss: 0.588, Test loss: 0.722, Test accuracy: 75.63
Round  57, Train loss: 0.610, Test loss: 0.713, Test accuracy: 75.93
Round  58, Train loss: 0.608, Test loss: 0.719, Test accuracy: 75.45
Round  59, Train loss: 0.615, Test loss: 0.720, Test accuracy: 75.70
Round  60, Train loss: 0.600, Test loss: 0.721, Test accuracy: 75.88
Round  61, Train loss: 0.613, Test loss: 0.722, Test accuracy: 76.25
Round  62, Train loss: 0.595, Test loss: 0.714, Test accuracy: 76.08
Round  63, Train loss: 0.613, Test loss: 0.718, Test accuracy: 75.64
Round  64, Train loss: 0.590, Test loss: 0.712, Test accuracy: 76.11
Round  65, Train loss: 0.583, Test loss: 0.718, Test accuracy: 76.00
Round  66, Train loss: 0.566, Test loss: 0.711, Test accuracy: 76.03
Round  67, Train loss: 0.588, Test loss: 0.715, Test accuracy: 76.19
Round  68, Train loss: 0.574, Test loss: 0.712, Test accuracy: 76.11
Round  69, Train loss: 0.546, Test loss: 0.709, Test accuracy: 76.36
Round  70, Train loss: 0.540, Test loss: 0.720, Test accuracy: 76.13
Round  71, Train loss: 0.525, Test loss: 0.735, Test accuracy: 75.45
Round  72, Train loss: 0.568, Test loss: 0.721, Test accuracy: 75.93
Round  73, Train loss: 0.536, Test loss: 0.724, Test accuracy: 75.90
Round  74, Train loss: 0.591, Test loss: 0.713, Test accuracy: 76.31
Round  75, Train loss: 0.580, Test loss: 0.711, Test accuracy: 76.14
Round  76, Train loss: 0.546, Test loss: 0.709, Test accuracy: 76.38
Round  77, Train loss: 0.569, Test loss: 0.704, Test accuracy: 76.56
Round  78, Train loss: 0.573, Test loss: 0.715, Test accuracy: 76.42
Round  79, Train loss: 0.543, Test loss: 0.699, Test accuracy: 76.78
Round  80, Train loss: 0.529, Test loss: 0.707, Test accuracy: 76.74
Round  81, Train loss: 0.546, Test loss: 0.699, Test accuracy: 76.83
Round  82, Train loss: 0.559, Test loss: 0.697, Test accuracy: 77.03
Round  83, Train loss: 0.530, Test loss: 0.687, Test accuracy: 77.17
Round  84, Train loss: 0.539, Test loss: 0.694, Test accuracy: 76.99
Round  85, Train loss: 0.551, Test loss: 0.709, Test accuracy: 76.64
Round  86, Train loss: 0.530, Test loss: 0.709, Test accuracy: 76.61
Round  87, Train loss: 0.502, Test loss: 0.708, Test accuracy: 76.75
Round  88, Train loss: 0.496, Test loss: 0.706, Test accuracy: 76.52
Round  89, Train loss: 0.519, Test loss: 0.711, Test accuracy: 76.62
Round  90, Train loss: 0.520, Test loss: 0.700, Test accuracy: 77.09
Round  91, Train loss: 0.507, Test loss: 0.710, Test accuracy: 76.65
Round  92, Train loss: 0.528, Test loss: 0.698, Test accuracy: 76.94
Round  93, Train loss: 0.508, Test loss: 0.699, Test accuracy: 76.70
Round  94, Train loss: 0.495, Test loss: 0.701, Test accuracy: 77.16
Round  95, Train loss: 0.494, Test loss: 0.704, Test accuracy: 76.94
Round  96, Train loss: 0.486, Test loss: 0.711, Test accuracy: 76.78
Round  97, Train loss: 0.501, Test loss: 0.697, Test accuracy: 77.42
Round  98, Train loss: 0.488, Test loss: 0.698, Test accuracy: 77.32
Round  99, Train loss: 0.495, Test loss: 0.698, Test accuracy: 77.14
Final Round, Train loss: 0.414, Test loss: 0.699, Test accuracy: 77.10
Average accuracy final 10 rounds: 77.01374999999999
4588.275949239731
[6.036204814910889, 11.879431247711182, 17.696768283843994, 23.539238691329956, 29.460846424102783, 35.29109048843384, 41.204325675964355, 47.07866835594177, 53.002930879592896, 58.82192277908325, 64.7107298374176, 70.64346218109131, 76.59946632385254, 82.44409108161926, 88.31743741035461, 94.21786880493164, 100.07016181945801, 105.94051837921143, 111.81151819229126, 117.66982531547546, 123.49353766441345, 129.3494257926941, 135.18355655670166, 141.04266929626465, 146.88138389587402, 152.70487689971924, 158.57929968833923, 164.46466970443726, 170.26552844047546, 176.14572644233704, 181.98950028419495, 187.76233291625977, 193.53547501564026, 199.3462417125702, 205.17377305030823, 210.9720423221588, 216.78074645996094, 222.53226351737976, 228.25372171401978, 234.01914167404175, 239.8566496372223, 245.68391346931458, 251.48243069648743, 257.3195524215698, 263.1376338005066, 268.842161655426, 274.5397803783417, 280.26060605049133, 286.0114006996155, 291.70027017593384, 297.3963580131531, 303.13384461402893, 308.89674282073975, 314.6143488883972, 320.4042978286743, 326.18587923049927, 331.89593863487244, 337.6311287879944, 343.3837778568268, 349.09441447257996, 354.81392550468445, 360.5247995853424, 366.24387550354004, 371.95123171806335, 377.66359424591064, 383.4784348011017, 389.2741663455963, 395.0038032531738, 400.74430751800537, 406.46981167793274, 412.1925449371338, 417.90622329711914, 423.60149574279785, 429.27866077423096, 434.97977352142334, 440.68029952049255, 446.34925365448, 452.026736497879, 457.7448341846466, 463.4659626483917, 469.1665313243866, 474.8519411087036, 480.5574538707733, 486.2471194267273, 491.9867024421692, 497.6759512424469, 503.39122319221497, 509.07779693603516, 514.7534353733063, 520.4367718696594, 526.1158051490784, 531.8401501178741, 537.5313122272491, 543.2073175907135, 548.9001681804657, 554.6067402362823, 560.3484501838684, 566.0525217056274, 571.7254552841187, 577.3884892463684, 579.5178804397583]
[31.7875, 41.7775, 46.855, 50.29, 53.04, 54.7325, 58.02, 59.15, 61.36, 62.2125, 63.005, 64.4225, 65.3525, 66.155, 66.0225, 67.275, 67.4775, 68.3675, 68.8925, 69.18, 69.37, 70.755, 70.95, 71.4425, 71.8425, 71.5275, 71.7875, 71.61, 72.125, 72.9475, 72.945, 73.185, 74.1825, 73.7325, 73.86, 73.4775, 73.5275, 73.68, 73.6375, 73.8325, 74.16, 74.5175, 74.4675, 74.87, 75.2675, 75.3275, 75.255, 75.23, 75.15, 75.575, 75.265, 75.495, 75.62, 75.26, 75.8375, 75.815, 75.6275, 75.9275, 75.4525, 75.7, 75.88, 76.255, 76.075, 75.645, 76.11, 75.9975, 76.025, 76.19, 76.105, 76.3575, 76.1275, 75.45, 75.9275, 75.9, 76.315, 76.14, 76.375, 76.555, 76.42, 76.7825, 76.74, 76.8275, 77.035, 77.1675, 76.9925, 76.645, 76.605, 76.7525, 76.52, 76.6225, 77.0875, 76.6525, 76.94, 76.705, 77.155, 76.9425, 76.775, 77.42, 77.32, 77.14, 77.1]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  32.5900
Round 1 global test acc  40.0600
Round 2 global test acc  43.9900
Round 3 global test acc  48.1200
Round 4 global test acc  50.9400
Round 5 global test acc  52.3400
Round 6 global test acc  52.1900
Round 7 global test acc  55.1700
Round 8 global test acc  55.9600
Round 9 global test acc  56.4400
Round 10 global test acc  56.9100
Round 11 global test acc  56.4500
Round 12 global test acc  57.2700
Round 13 global test acc  57.6600
Round 14 global test acc  59.0700
Round 15 global test acc  58.6000
Round 16 global test acc  58.8900
Round 17 global test acc  59.2600
Round 18 global test acc  59.8200
Round 19 global test acc  59.3900
Round 20 global test acc  60.0500
Round 21 global test acc  61.1200
Round 22 global test acc  60.9600
Round 23 global test acc  60.8500
Round 24 global test acc  61.0900
Round 25 global test acc  61.5000
Round 26 global test acc  61.7800
Round 27 global test acc  61.8300
Round 28 global test acc  60.9400
Round 29 global test acc  61.9300
Round 30 global test acc  62.3300
Round 31 global test acc  62.0700
Round 32 global test acc  62.9600
Round 33 global test acc  62.9500
Round 34 global test acc  62.4100
Round 35 global test acc  62.8900
Round 36 global test acc  63.6100
Round 37 global test acc  63.0800
Round 38 global test acc  63.8500
Round 39 global test acc  63.8900
Round 40 global test acc  63.9500
Round 41 global test acc  63.9400
Round 42 global test acc  64.5000
Round 43 global test acc  64.8100
Round 44 global test acc  64.4800
Round 45 global test acc  64.7800
Round 46 global test acc  64.7400
Round 47 global test acc  65.1500
Round 48 global test acc  64.7100
Round 49 global test acc  64.8500
Round 50 global test acc  65.7100
Round 51 global test acc  66.0700
Round 52 global test acc  65.7700
Round 53 global test acc  64.9800
Round 54 global test acc  65.1700
Round 55 global test acc  65.9800
Round 56 global test acc  66.0800
Round 57 global test acc  64.9100
Round 58 global test acc  65.1100
Round 59 global test acc  64.8800
Round 60 global test acc  65.7300
Round 61 global test acc  65.7300
Round 62 global test acc  66.3300
Round 63 global test acc  65.3200
Round 64 global test acc  66.1400
Round 65 global test acc  66.4900
Round 66 global test acc  65.5700
Round 67 global test acc  66.4900
Round 68 global test acc  66.0600
Round 69 global test acc  65.5000
Round 70 global test acc  66.5500
Round 71 global test acc  66.6900
Round 72 global test acc  67.0200
Round 73 global test acc  66.1200
Round 74 global test acc  66.9100
Round 75 global test acc  67.1100
Round 76 global test acc  66.6000
Round 77 global test acc  66.9300
Round 78 global test acc  67.2800
Round 79 global test acc  67.2400
Round 80 global test acc  66.0000
Round 81 global test acc  64.9200
Round 82 global test acc  63.9900
Round 83 global test acc  62.0900
Round 84 global test acc  61.8600
Round 85 global test acc  61.1000
Round 86 global test acc  60.7100
Round 87 global test acc  60.0500
Round 88 global test acc  60.3300
Round 89 global test acc  60.0500
Round 90 global test acc  59.8300
Round 91 global test acc  59.2000
Round 92 global test acc  58.8300
Round 93 global test acc  58.5100
Round 94 global test acc  58.2500
Round 95 global test acc  58.3500
Round 96 global test acc  58.3500
Round 97 global test acc  58.5700
Round 98 global test acc  58.4600
Round 99 global test acc  57.8500
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.225, Test loss: 1.937, Test accuracy: 32.04
Round   1, Train loss: 1.883, Test loss: 1.648, Test accuracy: 41.41
Round   2, Train loss: 1.678, Test loss: 1.545, Test accuracy: 45.45
Round   3, Train loss: 1.576, Test loss: 1.487, Test accuracy: 48.29
Round   4, Train loss: 1.519, Test loss: 1.374, Test accuracy: 51.80
Round   5, Train loss: 1.441, Test loss: 1.324, Test accuracy: 53.39
Round   6, Train loss: 1.371, Test loss: 1.261, Test accuracy: 56.43
Round   7, Train loss: 1.320, Test loss: 1.192, Test accuracy: 58.83
Round   8, Train loss: 1.271, Test loss: 1.155, Test accuracy: 60.25
Round   9, Train loss: 1.214, Test loss: 1.139, Test accuracy: 60.51
Round  10, Train loss: 1.185, Test loss: 1.101, Test accuracy: 61.64
Round  11, Train loss: 1.139, Test loss: 1.073, Test accuracy: 63.03
Round  12, Train loss: 1.121, Test loss: 1.044, Test accuracy: 64.42
Round  13, Train loss: 1.111, Test loss: 0.988, Test accuracy: 65.56
Round  14, Train loss: 1.061, Test loss: 0.987, Test accuracy: 66.26
Round  15, Train loss: 1.052, Test loss: 0.971, Test accuracy: 66.80
Round  16, Train loss: 1.009, Test loss: 0.955, Test accuracy: 67.26
Round  17, Train loss: 0.981, Test loss: 0.926, Test accuracy: 68.12
Round  18, Train loss: 0.966, Test loss: 0.916, Test accuracy: 68.70
Round  19, Train loss: 0.953, Test loss: 0.913, Test accuracy: 69.02
Round  20, Train loss: 0.936, Test loss: 0.894, Test accuracy: 69.48
Round  21, Train loss: 0.904, Test loss: 0.890, Test accuracy: 69.44
Round  22, Train loss: 0.906, Test loss: 0.868, Test accuracy: 70.44
Round  23, Train loss: 0.885, Test loss: 0.852, Test accuracy: 70.81
Round  24, Train loss: 0.870, Test loss: 0.841, Test accuracy: 71.33
Round  25, Train loss: 0.851, Test loss: 0.835, Test accuracy: 71.86
Round  26, Train loss: 0.849, Test loss: 0.821, Test accuracy: 71.96
Round  27, Train loss: 0.827, Test loss: 0.816, Test accuracy: 71.99
Round  28, Train loss: 0.819, Test loss: 0.814, Test accuracy: 72.32
Round  29, Train loss: 0.806, Test loss: 0.814, Test accuracy: 72.41
Round  30, Train loss: 0.797, Test loss: 0.799, Test accuracy: 72.69
Round  31, Train loss: 0.783, Test loss: 0.793, Test accuracy: 72.95
Round  32, Train loss: 0.777, Test loss: 0.795, Test accuracy: 72.93
Round  33, Train loss: 0.767, Test loss: 0.789, Test accuracy: 72.89
Round  34, Train loss: 0.756, Test loss: 0.794, Test accuracy: 73.12
Round  35, Train loss: 0.754, Test loss: 0.775, Test accuracy: 73.76
Round  36, Train loss: 0.729, Test loss: 0.762, Test accuracy: 74.06
Round  37, Train loss: 0.729, Test loss: 0.762, Test accuracy: 74.22
Round  38, Train loss: 0.734, Test loss: 0.763, Test accuracy: 74.19
Round  39, Train loss: 0.711, Test loss: 0.754, Test accuracy: 74.28
Round  40, Train loss: 0.691, Test loss: 0.751, Test accuracy: 74.55
Round  41, Train loss: 0.695, Test loss: 0.757, Test accuracy: 74.05
Round  42, Train loss: 0.669, Test loss: 0.745, Test accuracy: 74.95
Round  43, Train loss: 0.697, Test loss: 0.738, Test accuracy: 75.10
Round  44, Train loss: 0.669, Test loss: 0.740, Test accuracy: 75.18
Round  45, Train loss: 0.677, Test loss: 0.749, Test accuracy: 74.71
Round  46, Train loss: 0.655, Test loss: 0.762, Test accuracy: 74.48
Round  47, Train loss: 0.633, Test loss: 0.759, Test accuracy: 74.62
Round  48, Train loss: 0.667, Test loss: 0.737, Test accuracy: 75.00
Round  49, Train loss: 0.623, Test loss: 0.742, Test accuracy: 74.84
Round  50, Train loss: 0.638, Test loss: 0.743, Test accuracy: 75.00
Round  51, Train loss: 0.614, Test loss: 0.741, Test accuracy: 75.13
Round  52, Train loss: 0.622, Test loss: 0.743, Test accuracy: 75.33
Round  53, Train loss: 0.651, Test loss: 0.729, Test accuracy: 75.48
Round  54, Train loss: 0.668, Test loss: 0.734, Test accuracy: 75.65
Round  55, Train loss: 0.644, Test loss: 0.720, Test accuracy: 75.91
Round  56, Train loss: 0.604, Test loss: 0.729, Test accuracy: 75.70
Round  57, Train loss: 0.649, Test loss: 0.722, Test accuracy: 76.03
Round  58, Train loss: 0.601, Test loss: 0.732, Test accuracy: 75.72
Round  59, Train loss: 0.585, Test loss: 0.732, Test accuracy: 75.21
Round  60, Train loss: 0.623, Test loss: 0.727, Test accuracy: 75.69
Round  61, Train loss: 0.563, Test loss: 0.726, Test accuracy: 75.78
Round  62, Train loss: 0.611, Test loss: 0.715, Test accuracy: 75.84
Round  63, Train loss: 0.609, Test loss: 0.711, Test accuracy: 76.13
Round  64, Train loss: 0.569, Test loss: 0.717, Test accuracy: 76.12
Round  65, Train loss: 0.555, Test loss: 0.716, Test accuracy: 75.73
Round  66, Train loss: 0.580, Test loss: 0.722, Test accuracy: 75.92
Round  67, Train loss: 0.572, Test loss: 0.718, Test accuracy: 76.07
Round  68, Train loss: 0.573, Test loss: 0.715, Test accuracy: 76.17
Round  69, Train loss: 0.539, Test loss: 0.709, Test accuracy: 76.52
Round  70, Train loss: 0.580, Test loss: 0.721, Test accuracy: 76.28
Round  71, Train loss: 0.566, Test loss: 0.716, Test accuracy: 76.50
Round  72, Train loss: 0.553, Test loss: 0.720, Test accuracy: 76.34
Round  73, Train loss: 0.576, Test loss: 0.717, Test accuracy: 76.62
Round  74, Train loss: 0.555, Test loss: 0.713, Test accuracy: 76.77
Round  75, Train loss: 0.565, Test loss: 0.716, Test accuracy: 76.63
Round  76, Train loss: 0.545, Test loss: 0.711, Test accuracy: 76.86
Round  77, Train loss: 0.563, Test loss: 0.703, Test accuracy: 76.61
Round  78, Train loss: 0.545, Test loss: 0.698, Test accuracy: 76.99
Round  79, Train loss: 0.546, Test loss: 0.695, Test accuracy: 77.06
Round  80, Train loss: 0.538, Test loss: 0.702, Test accuracy: 76.86
Round  81, Train loss: 0.542, Test loss: 0.702, Test accuracy: 76.77
Round  82, Train loss: 0.538, Test loss: 0.692, Test accuracy: 77.29
Round  83, Train loss: 0.494, Test loss: 0.708, Test accuracy: 76.65
Round  84, Train loss: 0.506, Test loss: 0.706, Test accuracy: 76.81
Round  85, Train loss: 0.539, Test loss: 0.701, Test accuracy: 77.28
Round  86, Train loss: 0.532, Test loss: 0.697, Test accuracy: 77.22
Round  87, Train loss: 0.518, Test loss: 0.695, Test accuracy: 77.37
Round  88, Train loss: 0.537, Test loss: 0.690, Test accuracy: 77.48
Round  89, Train loss: 0.535, Test loss: 0.690, Test accuracy: 77.58
Round  90, Train loss: 0.510, Test loss: 0.702, Test accuracy: 77.32
Round  91, Train loss: 0.509, Test loss: 0.710, Test accuracy: 77.03
Round  92, Train loss: 0.500, Test loss: 0.708, Test accuracy: 76.85
Round  93, Train loss: 0.514, Test loss: 0.705, Test accuracy: 77.07
Round  94, Train loss: 0.492, Test loss: 0.702, Test accuracy: 77.19
Round  95, Train loss: 0.501, Test loss: 0.694, Test accuracy: 77.28
Round  96, Train loss: 0.501, Test loss: 0.693, Test accuracy: 77.41
Round  97, Train loss: 0.510, Test loss: 0.697, Test accuracy: 77.32
Round  98, Train loss: 0.470, Test loss: 0.705, Test accuracy: 77.28
Round  99, Train loss: 0.481, Test loss: 0.702, Test accuracy: 77.35
Final Round, Train loss: 0.430, Test loss: 0.705, Test accuracy: 77.41
Average accuracy final 10 rounds: 77.20875000000001
4765.280171394348
[6.371754884719849, 12.563087463378906, 18.74546790122986, 24.929229497909546, 31.0399112701416, 37.165451765060425, 43.301960945129395, 49.47763657569885, 55.66327214241028, 61.855414628982544, 68.0286476612091, 74.21269941329956, 80.37129354476929, 86.58758997917175, 92.78331017494202, 98.99119567871094, 105.17020273208618, 111.40717625617981, 117.69585418701172, 123.93749475479126, 130.18805575370789, 136.38695192337036, 142.6428186893463, 148.89845275878906, 155.09847164154053, 161.279132604599, 167.4719169139862, 173.67731833457947, 179.86072444915771, 186.05381751060486, 192.22609782218933, 198.38459467887878, 204.5160572528839, 210.67364311218262, 216.75573897361755, 222.91207194328308, 229.10359287261963, 235.32437896728516, 241.5225145816803, 247.66156697273254, 253.85305070877075, 260.0148956775665, 266.13964581489563, 272.2238116264343, 278.33374762535095, 284.4748821258545, 290.59124660491943, 296.74747681617737, 302.8630037307739, 308.97957396507263, 315.1005508899689, 321.2620882987976, 327.37825989723206, 333.5108685493469, 339.66977882385254, 345.8439061641693, 352.0114481449127, 358.1821036338806, 364.29653429985046, 370.4625177383423, 376.63923621177673, 382.7526285648346, 388.84729766845703, 394.97024750709534, 401.12968349456787, 407.2915916442871, 413.41350078582764, 419.6358163356781, 425.8259246349335, 432.01403617858887, 438.24533200263977, 444.41237902641296, 450.40432357788086, 456.20242738723755, 462.15056109428406, 468.10724568367004, 474.16016006469727, 480.15466499328613, 486.1134822368622, 492.0773787498474, 497.54111671447754, 503.01526522636414, 508.4500415325165, 513.8681855201721, 519.3325936794281, 524.7555296421051, 530.1425814628601, 535.5148198604584, 540.8610532283783, 546.2720673084259, 551.7552583217621, 557.2408385276794, 562.6101636886597, 568.177759885788, 573.5992107391357, 579.1318740844727, 584.5768744945526, 589.9750652313232, 595.3230993747711, 600.7591989040375, 602.9048154354095]
[32.0425, 41.4125, 45.4475, 48.29, 51.805, 53.39, 56.4275, 58.83, 60.2475, 60.51, 61.6425, 63.0325, 64.4225, 65.5575, 66.2625, 66.795, 67.2625, 68.1225, 68.7025, 69.02, 69.4825, 69.435, 70.4425, 70.815, 71.325, 71.855, 71.9625, 71.99, 72.32, 72.4075, 72.695, 72.955, 72.9275, 72.8925, 73.12, 73.76, 74.0625, 74.2175, 74.1875, 74.28, 74.5525, 74.0525, 74.9525, 75.1025, 75.1775, 74.7125, 74.4825, 74.6225, 74.9975, 74.8425, 75.005, 75.1275, 75.3325, 75.485, 75.65, 75.9075, 75.705, 76.0275, 75.725, 75.2125, 75.69, 75.785, 75.84, 76.1325, 76.1175, 75.7275, 75.92, 76.0675, 76.1675, 76.515, 76.28, 76.5, 76.345, 76.6175, 76.7725, 76.6275, 76.865, 76.605, 76.9875, 77.0625, 76.86, 76.77, 77.2875, 76.65, 76.815, 77.2775, 77.2175, 77.3725, 77.485, 77.5825, 77.32, 77.0275, 76.8475, 77.0725, 77.185, 77.2825, 77.4075, 77.3175, 77.275, 77.3525, 77.4125]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.542, Test loss: 2.108, Test accuracy: 17.64
Round   1, Train loss: 1.120, Test loss: 1.920, Test accuracy: 26.48
Round   2, Train loss: 1.140, Test loss: 1.688, Test accuracy: 40.23
Round   3, Train loss: 1.007, Test loss: 1.357, Test accuracy: 43.61
Round   4, Train loss: 1.084, Test loss: 1.019, Test accuracy: 58.47
Round   5, Train loss: 0.997, Test loss: 1.097, Test accuracy: 57.09
Round   6, Train loss: 0.933, Test loss: 0.957, Test accuracy: 59.99
Round   7, Train loss: 1.052, Test loss: 0.862, Test accuracy: 63.26
Round   8, Train loss: 0.889, Test loss: 0.836, Test accuracy: 65.72
Round   9, Train loss: 0.816, Test loss: 0.826, Test accuracy: 65.84
Round  10, Train loss: 0.754, Test loss: 0.793, Test accuracy: 68.08
Round  11, Train loss: 0.897, Test loss: 0.787, Test accuracy: 68.97
Round  12, Train loss: 1.085, Test loss: 0.787, Test accuracy: 69.22
Round  13, Train loss: 1.059, Test loss: 0.796, Test accuracy: 68.97
Round  14, Train loss: 0.932, Test loss: 0.791, Test accuracy: 69.99
Round  15, Train loss: 0.820, Test loss: 0.773, Test accuracy: 68.97
Round  16, Train loss: 1.039, Test loss: 0.798, Test accuracy: 68.56
Round  17, Train loss: 0.884, Test loss: 0.761, Test accuracy: 70.43
Round  18, Train loss: 0.882, Test loss: 0.759, Test accuracy: 71.78
Round  19, Train loss: 1.009, Test loss: 0.737, Test accuracy: 73.28
Round  20, Train loss: 0.822, Test loss: 0.729, Test accuracy: 73.76
Round  21, Train loss: 0.771, Test loss: 0.714, Test accuracy: 74.02
Round  22, Train loss: 0.833, Test loss: 0.708, Test accuracy: 74.86
Round  23, Train loss: 0.949, Test loss: 0.707, Test accuracy: 74.28
Round  24, Train loss: 0.792, Test loss: 0.689, Test accuracy: 74.67
Round  25, Train loss: 0.787, Test loss: 0.680, Test accuracy: 75.44
Round  26, Train loss: 0.699, Test loss: 0.677, Test accuracy: 75.54
Round  27, Train loss: 0.784, Test loss: 0.670, Test accuracy: 74.90
Round  28, Train loss: 0.606, Test loss: 0.671, Test accuracy: 75.38
Round  29, Train loss: 0.698, Test loss: 0.662, Test accuracy: 76.02
Round  30, Train loss: 0.912, Test loss: 0.670, Test accuracy: 76.42
Round  31, Train loss: 0.767, Test loss: 0.672, Test accuracy: 76.20
Round  32, Train loss: 0.861, Test loss: 0.664, Test accuracy: 76.37
Round  33, Train loss: 0.813, Test loss: 0.645, Test accuracy: 77.04
Round  34, Train loss: 0.770, Test loss: 0.647, Test accuracy: 77.75
Round  35, Train loss: 0.869, Test loss: 0.640, Test accuracy: 77.48
Round  36, Train loss: 0.790, Test loss: 0.641, Test accuracy: 77.88
Round  37, Train loss: 0.829, Test loss: 0.647, Test accuracy: 78.27
Round  38, Train loss: 0.528, Test loss: 0.645, Test accuracy: 78.32
Round  39, Train loss: 0.785, Test loss: 0.636, Test accuracy: 78.32
Round  40, Train loss: 0.943, Test loss: 0.634, Test accuracy: 78.05
Round  41, Train loss: 0.773, Test loss: 0.645, Test accuracy: 78.22
Round  42, Train loss: 0.868, Test loss: 0.635, Test accuracy: 78.28
Round  43, Train loss: 0.853, Test loss: 0.645, Test accuracy: 77.65
Round  44, Train loss: 0.776, Test loss: 0.622, Test accuracy: 78.54
Round  45, Train loss: 0.787, Test loss: 0.631, Test accuracy: 78.37
Round  46, Train loss: 0.765, Test loss: 0.608, Test accuracy: 79.24
Round  47, Train loss: 0.669, Test loss: 0.620, Test accuracy: 78.58
Round  48, Train loss: 0.748, Test loss: 0.629, Test accuracy: 78.13
Round  49, Train loss: 0.573, Test loss: 0.607, Test accuracy: 78.67
Round  50, Train loss: 0.664, Test loss: 0.605, Test accuracy: 78.84
Round  51, Train loss: 0.671, Test loss: 0.598, Test accuracy: 79.03
Round  52, Train loss: 0.687, Test loss: 0.601, Test accuracy: 78.95
Round  53, Train loss: 0.818, Test loss: 0.594, Test accuracy: 79.37
Round  54, Train loss: 0.800, Test loss: 0.604, Test accuracy: 79.03
Round  55, Train loss: 0.761, Test loss: 0.599, Test accuracy: 79.03
Round  56, Train loss: 0.829, Test loss: 0.605, Test accuracy: 78.82
Round  57, Train loss: 0.777, Test loss: 0.589, Test accuracy: 79.10
Round  58, Train loss: 0.693, Test loss: 0.595, Test accuracy: 79.48
Round  59, Train loss: 0.615, Test loss: 0.586, Test accuracy: 79.73
Round  60, Train loss: 0.656, Test loss: 0.577, Test accuracy: 79.87
Round  61, Train loss: 0.446, Test loss: 0.588, Test accuracy: 79.44
Round  62, Train loss: 0.576, Test loss: 0.586, Test accuracy: 79.38
Round  63, Train loss: 0.428, Test loss: 0.587, Test accuracy: 79.86
Round  64, Train loss: 0.813, Test loss: 0.583, Test accuracy: 79.01
Round  65, Train loss: 0.784, Test loss: 0.591, Test accuracy: 78.63
Round  66, Train loss: 0.790, Test loss: 0.591, Test accuracy: 78.78
Round  67, Train loss: 0.580, Test loss: 0.590, Test accuracy: 79.09
Round  68, Train loss: 0.659, Test loss: 0.593, Test accuracy: 79.13
Round  69, Train loss: 0.735, Test loss: 0.581, Test accuracy: 79.58
Round  70, Train loss: 0.558, Test loss: 0.588, Test accuracy: 79.28
Round  71, Train loss: 0.602, Test loss: 0.583, Test accuracy: 79.83
Round  72, Train loss: 0.730, Test loss: 0.584, Test accuracy: 79.22
Round  73, Train loss: 0.367, Test loss: 0.583, Test accuracy: 79.54
Round  74, Train loss: 0.482, Test loss: 0.579, Test accuracy: 79.18
Round  75, Train loss: 0.539, Test loss: 0.577, Test accuracy: 79.48
Round  76, Train loss: 0.534, Test loss: 0.588, Test accuracy: 78.94
Round  77, Train loss: 0.827, Test loss: 0.603, Test accuracy: 78.07
Round  78, Train loss: 0.651, Test loss: 0.591, Test accuracy: 78.36
Round  79, Train loss: 0.626, Test loss: 0.589, Test accuracy: 78.69
Round  80, Train loss: 0.575, Test loss: 0.579, Test accuracy: 79.16
Round  81, Train loss: 0.512, Test loss: 0.582, Test accuracy: 79.11
Round  82, Train loss: 0.647, Test loss: 0.585, Test accuracy: 79.03
Round  83, Train loss: 0.580, Test loss: 0.589, Test accuracy: 78.67
Round  84, Train loss: 0.714, Test loss: 0.587, Test accuracy: 78.22
Round  85, Train loss: 0.613, Test loss: 0.589, Test accuracy: 78.17
Round  86, Train loss: 0.656, Test loss: 0.591, Test accuracy: 78.03
Round  87, Train loss: 0.618, Test loss: 0.595, Test accuracy: 77.82
Round  88, Train loss: 0.617, Test loss: 0.594, Test accuracy: 77.88
Round  89, Train loss: 0.500, Test loss: 0.581, Test accuracy: 78.26
Round  90, Train loss: 0.615, Test loss: 0.592, Test accuracy: 77.96
Round  91, Train loss: 0.464, Test loss: 0.587, Test accuracy: 77.92
Round  92, Train loss: 0.532, Test loss: 0.588, Test accuracy: 78.13
Round  93, Train loss: 0.455, Test loss: 0.587, Test accuracy: 78.33
Round  94, Train loss: 0.744, Test loss: 0.591, Test accuracy: 77.74
Round  95, Train loss: 0.489, Test loss: 0.602, Test accuracy: 77.68
Round  96, Train loss: 0.537, Test loss: 0.583, Test accuracy: 78.39
Round  97, Train loss: 0.542, Test loss: 0.589, Test accuracy: 78.25
Round  98, Train loss: 0.696, Test loss: 0.600, Test accuracy: 77.49
Round  99, Train loss: 0.763, Test loss: 0.613, Test accuracy: 76.72
Final Round, Train loss: 0.533, Test loss: 0.602, Test accuracy: 76.78
Average accuracy final 10 rounds: 77.86249999999998
2434.4272797107697
[2.1630501747131348, 3.978407859802246, 5.774716377258301, 7.626088380813599, 9.453056812286377, 11.264923810958862, 13.079034566879272, 14.906985759735107, 16.71962594985962, 18.513522148132324, 20.344075202941895, 22.17773127555847, 23.961535692214966, 25.782549381256104, 27.609925985336304, 30.138299226760864, 31.936163187026978, 33.77118539810181, 35.58408069610596, 37.37696933746338, 39.1956992149353, 43.2356641292572, 47.21946096420288, 51.47158360481262, 55.50568413734436, 59.566537857055664, 63.56071925163269, 67.67501735687256, 71.73406338691711, 75.8142466545105, 79.82171177864075, 83.77446556091309, 87.80659556388855, 91.69508647918701, 95.6098861694336, 99.53915333747864, 103.52552437782288, 107.39738631248474, 111.40945506095886, 115.37986063957214, 119.48583674430847, 123.43839430809021, 127.52020716667175, 131.50345969200134, 135.5032901763916, 139.46354508399963, 143.46747303009033, 147.55583310127258, 151.54316926002502, 155.69611644744873, 159.77097368240356, 163.91249656677246, 167.83853936195374, 171.94441485404968, 175.85373449325562, 179.89698314666748, 183.88879680633545, 187.9253659248352, 191.74342489242554, 195.72346115112305, 199.49952268600464, 203.59721159934998, 207.49096202850342, 211.34557843208313, 215.2024257183075, 219.2873089313507, 223.12474966049194, 227.28585267066956, 231.270925283432, 235.41336703300476, 239.40368509292603, 243.5305690765381, 247.41181468963623, 251.55572390556335, 255.49645066261292, 259.4652237892151, 263.4776437282562, 267.59645652770996, 271.45041966438293, 275.45500206947327, 279.40411734580994, 283.44623947143555, 287.4912929534912, 291.4944772720337, 295.4467034339905, 299.45437574386597, 303.4872627258301, 307.35337352752686, 311.343631029129, 315.2024073600769, 318.7995641231537, 322.4503948688507, 326.1316976547241, 329.7187707424164, 333.3376696109772, 337.14448142051697, 340.9146685600281, 344.75770139694214, 348.5715386867523, 352.3018321990967, 354.42335629463196]
[17.641666666666666, 26.483333333333334, 40.233333333333334, 43.608333333333334, 58.46666666666667, 57.09166666666667, 59.99166666666667, 63.25833333333333, 65.725, 65.84166666666667, 68.075, 68.975, 69.21666666666667, 68.96666666666667, 69.99166666666666, 68.96666666666667, 68.55833333333334, 70.43333333333334, 71.78333333333333, 73.28333333333333, 73.75833333333334, 74.01666666666667, 74.85833333333333, 74.28333333333333, 74.66666666666667, 75.44166666666666, 75.54166666666667, 74.9, 75.38333333333334, 76.01666666666667, 76.425, 76.2, 76.36666666666666, 77.04166666666667, 77.75, 77.48333333333333, 77.875, 78.26666666666667, 78.31666666666666, 78.31666666666666, 78.05, 78.225, 78.275, 77.65, 78.54166666666667, 78.36666666666666, 79.24166666666666, 78.575, 78.13333333333334, 78.66666666666667, 78.84166666666667, 79.025, 78.95, 79.36666666666666, 79.025, 79.03333333333333, 78.81666666666666, 79.1, 79.48333333333333, 79.73333333333333, 79.86666666666666, 79.44166666666666, 79.375, 79.85833333333333, 79.00833333333334, 78.63333333333334, 78.775, 79.09166666666667, 79.13333333333334, 79.58333333333333, 79.275, 79.825, 79.21666666666667, 79.54166666666667, 79.18333333333334, 79.48333333333333, 78.94166666666666, 78.06666666666666, 78.35833333333333, 78.69166666666666, 79.15833333333333, 79.10833333333333, 79.03333333333333, 78.675, 78.21666666666667, 78.16666666666667, 78.025, 77.81666666666666, 77.875, 78.25833333333334, 77.95833333333333, 77.91666666666667, 78.13333333333334, 78.33333333333333, 77.74166666666666, 77.68333333333334, 78.39166666666667, 78.25, 77.49166666666666, 76.725, 76.775]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.2  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.2000 
   Client 16, noise    level: 0.2000 
   Client 6, noise    level: 0.2000 
   Client 13, noise    level: 0.2000 
   Client 15, noise    level: 0.2000 
   Client 0, noise    level: 0.2000 
   Client 8, noise    level: 0.2000 
   Client 9, noise    level: 0.2000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.058, Test loss: 1.791, Test accuracy: 35.62
Round   0, Global train loss: 2.058, Global test loss: 1.802, Global test accuracy: 35.62
Round   1, Train loss: 1.828, Test loss: 1.627, Test accuracy: 42.41
Round   1, Global train loss: 1.828, Global test loss: 1.575, Global test accuracy: 45.95
Round   2, Train loss: 1.726, Test loss: 1.570, Test accuracy: 44.81
Round   2, Global train loss: 1.726, Global test loss: 1.492, Global test accuracy: 49.77
Round   3, Train loss: 1.758, Test loss: 1.563, Test accuracy: 45.45
Round   3, Global train loss: 1.758, Global test loss: 1.496, Global test accuracy: 50.33
Round   4, Train loss: 1.734, Test loss: 1.548, Test accuracy: 46.12
Round   4, Global train loss: 1.734, Global test loss: 1.487, Global test accuracy: 51.72
Round   5, Train loss: 1.654, Test loss: 1.529, Test accuracy: 46.33
Round   5, Global train loss: 1.654, Global test loss: 1.449, Global test accuracy: 51.44
Round   6, Train loss: 1.628, Test loss: 1.520, Test accuracy: 47.05
Round   6, Global train loss: 1.628, Global test loss: 1.433, Global test accuracy: 54.13
Round   7, Train loss: 1.567, Test loss: 1.513, Test accuracy: 47.04
Round   7, Global train loss: 1.567, Global test loss: 1.367, Global test accuracy: 55.43
Round   8, Train loss: 1.502, Test loss: 1.508, Test accuracy: 47.38
Round   8, Global train loss: 1.502, Global test loss: 1.343, Global test accuracy: 55.94
Round   9, Train loss: 1.429, Test loss: 1.494, Test accuracy: 47.86
Round   9, Global train loss: 1.429, Global test loss: 1.374, Global test accuracy: 54.87
Round  10, Train loss: 1.509, Test loss: 1.477, Test accuracy: 48.55
Round  10, Global train loss: 1.509, Global test loss: 1.476, Global test accuracy: 53.16
Round  11, Train loss: 1.420, Test loss: 1.471, Test accuracy: 48.77
Round  11, Global train loss: 1.420, Global test loss: 1.311, Global test accuracy: 58.04
Round  12, Train loss: 1.453, Test loss: 1.469, Test accuracy: 49.01
Round  12, Global train loss: 1.453, Global test loss: 1.403, Global test accuracy: 53.94
Round  13, Train loss: 1.341, Test loss: 1.476, Test accuracy: 49.08
Round  13, Global train loss: 1.341, Global test loss: 1.295, Global test accuracy: 56.87
Round  14, Train loss: 1.429, Test loss: 1.468, Test accuracy: 49.39
Round  14, Global train loss: 1.429, Global test loss: 1.424, Global test accuracy: 53.70
Round  15, Train loss: 1.378, Test loss: 1.467, Test accuracy: 49.75
Round  15, Global train loss: 1.378, Global test loss: 1.379, Global test accuracy: 55.17
Round  16, Train loss: 1.299, Test loss: 1.466, Test accuracy: 50.13
Round  16, Global train loss: 1.299, Global test loss: 1.422, Global test accuracy: 55.19
Round  17, Train loss: 1.201, Test loss: 1.467, Test accuracy: 50.20
Round  17, Global train loss: 1.201, Global test loss: 1.346, Global test accuracy: 55.60
Round  18, Train loss: 1.277, Test loss: 1.469, Test accuracy: 50.37
Round  18, Global train loss: 1.277, Global test loss: 1.434, Global test accuracy: 53.79
Round  19, Train loss: 1.228, Test loss: 1.487, Test accuracy: 50.39
Round  19, Global train loss: 1.228, Global test loss: 1.369, Global test accuracy: 54.91
Round  20, Train loss: 0.979, Test loss: 1.497, Test accuracy: 50.48
Round  20, Global train loss: 0.979, Global test loss: 1.361, Global test accuracy: 54.85
Round  21, Train loss: 1.168, Test loss: 1.513, Test accuracy: 50.26
Round  21, Global train loss: 1.168, Global test loss: 1.409, Global test accuracy: 53.99
Round  22, Train loss: 1.177, Test loss: 1.535, Test accuracy: 50.26
Round  22, Global train loss: 1.177, Global test loss: 1.283, Global test accuracy: 57.11
Round  23, Train loss: 0.974, Test loss: 1.544, Test accuracy: 50.35
Round  23, Global train loss: 0.974, Global test loss: 1.332, Global test accuracy: 55.60
Round  24, Train loss: 1.044, Test loss: 1.547, Test accuracy: 50.73
Round  24, Global train loss: 1.044, Global test loss: 1.353, Global test accuracy: 55.22
Round  25, Train loss: 1.024, Test loss: 1.566, Test accuracy: 50.86
Round  25, Global train loss: 1.024, Global test loss: 1.369, Global test accuracy: 54.66
Round  26, Train loss: 1.156, Test loss: 1.573, Test accuracy: 50.82
Round  26, Global train loss: 1.156, Global test loss: 1.331, Global test accuracy: 55.12
Round  27, Train loss: 1.135, Test loss: 1.584, Test accuracy: 50.68
Round  27, Global train loss: 1.135, Global test loss: 1.331, Global test accuracy: 56.86
Round  28, Train loss: 0.948, Test loss: 1.618, Test accuracy: 50.23
Round  28, Global train loss: 0.948, Global test loss: 1.355, Global test accuracy: 53.86
Round  29, Train loss: 1.109, Test loss: 1.630, Test accuracy: 50.47
Round  29, Global train loss: 1.109, Global test loss: 1.329, Global test accuracy: 56.34
Round  30, Train loss: 0.828, Test loss: 1.658, Test accuracy: 50.43
Round  30, Global train loss: 0.828, Global test loss: 1.241, Global test accuracy: 58.10
Round  31, Train loss: 0.893, Test loss: 1.673, Test accuracy: 50.40
Round  31, Global train loss: 0.893, Global test loss: 1.227, Global test accuracy: 58.74
Round  32, Train loss: 0.815, Test loss: 1.684, Test accuracy: 50.30
Round  32, Global train loss: 0.815, Global test loss: 1.206, Global test accuracy: 58.45
Round  33, Train loss: 0.970, Test loss: 1.712, Test accuracy: 50.11
Round  33, Global train loss: 0.970, Global test loss: 1.254, Global test accuracy: 57.54
Round  34, Train loss: 0.797, Test loss: 1.735, Test accuracy: 49.89
Round  34, Global train loss: 0.797, Global test loss: 1.234, Global test accuracy: 57.51
Round  35, Train loss: 0.912, Test loss: 1.747, Test accuracy: 50.18
Round  35, Global train loss: 0.912, Global test loss: 1.361, Global test accuracy: 54.75
Round  36, Train loss: 0.882, Test loss: 1.768, Test accuracy: 50.20
Round  36, Global train loss: 0.882, Global test loss: 1.284, Global test accuracy: 57.45
Round  37, Train loss: 0.619, Test loss: 1.764, Test accuracy: 50.51
Round  37, Global train loss: 0.619, Global test loss: 1.264, Global test accuracy: 55.85
Round  38, Train loss: 0.814, Test loss: 1.797, Test accuracy: 50.13
Round  38, Global train loss: 0.814, Global test loss: 1.300, Global test accuracy: 54.86
Round  39, Train loss: 0.810, Test loss: 1.830, Test accuracy: 49.99
Round  39, Global train loss: 0.810, Global test loss: 1.369, Global test accuracy: 54.71
Round  40, Train loss: 0.749, Test loss: 1.859, Test accuracy: 49.99
Round  40, Global train loss: 0.749, Global test loss: 1.408, Global test accuracy: 52.99
Round  41, Train loss: 0.755, Test loss: 1.878, Test accuracy: 49.73
Round  41, Global train loss: 0.755, Global test loss: 1.374, Global test accuracy: 53.17
Round  42, Train loss: 0.753, Test loss: 1.894, Test accuracy: 49.78
Round  42, Global train loss: 0.753, Global test loss: 1.337, Global test accuracy: 55.05
Round  43, Train loss: 0.737, Test loss: 1.900, Test accuracy: 49.62
Round  43, Global train loss: 0.737, Global test loss: 1.454, Global test accuracy: 51.98
Round  44, Train loss: 0.718, Test loss: 1.944, Test accuracy: 49.57
Round  44, Global train loss: 0.718, Global test loss: 1.321, Global test accuracy: 54.47
Round  45, Train loss: 0.652, Test loss: 1.973, Test accuracy: 49.45
Round  45, Global train loss: 0.652, Global test loss: 1.328, Global test accuracy: 54.87
Round  46, Train loss: 0.726, Test loss: 1.978, Test accuracy: 49.48
Round  46, Global train loss: 0.726, Global test loss: 1.294, Global test accuracy: 56.66
Round  47, Train loss: 0.736, Test loss: 2.031, Test accuracy: 49.15
Round  47, Global train loss: 0.736, Global test loss: 1.349, Global test accuracy: 54.33
Round  48, Train loss: 0.584, Test loss: 2.024, Test accuracy: 49.66
Round  48, Global train loss: 0.584, Global test loss: 1.275, Global test accuracy: 55.82
Round  49, Train loss: 0.608, Test loss: 2.046, Test accuracy: 49.71
Round  49, Global train loss: 0.608, Global test loss: 1.248, Global test accuracy: 57.04
Round  50, Train loss: 0.663, Test loss: 2.100, Test accuracy: 49.30
Round  50, Global train loss: 0.663, Global test loss: 1.273, Global test accuracy: 57.18
Round  51, Train loss: 0.553, Test loss: 2.112, Test accuracy: 49.45
Round  51, Global train loss: 0.553, Global test loss: 1.269, Global test accuracy: 56.13
Round  52, Train loss: 0.610, Test loss: 2.153, Test accuracy: 49.22
Round  52, Global train loss: 0.610, Global test loss: 1.317, Global test accuracy: 55.12
Round  53, Train loss: 0.534, Test loss: 2.144, Test accuracy: 48.91
Round  53, Global train loss: 0.534, Global test loss: 1.285, Global test accuracy: 55.22
Round  54, Train loss: 0.614, Test loss: 2.188, Test accuracy: 48.75
Round  54, Global train loss: 0.614, Global test loss: 1.274, Global test accuracy: 57.13
Round  55, Train loss: 0.552, Test loss: 2.196, Test accuracy: 48.89
Round  55, Global train loss: 0.552, Global test loss: 1.245, Global test accuracy: 58.25
Round  56, Train loss: 0.498, Test loss: 2.203, Test accuracy: 49.41
Round  56, Global train loss: 0.498, Global test loss: 1.356, Global test accuracy: 53.30
Round  57, Train loss: 0.631, Test loss: 2.246, Test accuracy: 49.13
Round  57, Global train loss: 0.631, Global test loss: 1.406, Global test accuracy: 52.48
Round  58, Train loss: 0.488, Test loss: 2.244, Test accuracy: 49.16
Round  58, Global train loss: 0.488, Global test loss: 1.336, Global test accuracy: 53.38
Round  59, Train loss: 0.496, Test loss: 2.274, Test accuracy: 49.29
Round  59, Global train loss: 0.496, Global test loss: 1.319, Global test accuracy: 54.89
Round  60, Train loss: 0.600, Test loss: 2.269, Test accuracy: 49.27
Round  60, Global train loss: 0.600, Global test loss: 1.353, Global test accuracy: 54.89
Round  61, Train loss: 0.579, Test loss: 2.309, Test accuracy: 49.56
Round  61, Global train loss: 0.579, Global test loss: 1.285, Global test accuracy: 56.56
Round  62, Train loss: 0.437, Test loss: 2.323, Test accuracy: 49.44
Round  62, Global train loss: 0.437, Global test loss: 1.296, Global test accuracy: 55.51
Round  63, Train loss: 0.574, Test loss: 2.367, Test accuracy: 49.07
Round  63, Global train loss: 0.574, Global test loss: 1.367, Global test accuracy: 53.91
Round  64, Train loss: 0.492, Test loss: 2.352, Test accuracy: 48.96
Round  64, Global train loss: 0.492, Global test loss: 1.302, Global test accuracy: 55.65
Round  65, Train loss: 0.498, Test loss: 2.395, Test accuracy: 48.88
Round  65, Global train loss: 0.498, Global test loss: 1.344, Global test accuracy: 54.46
Round  66, Train loss: 0.469, Test loss: 2.402, Test accuracy: 48.88
Round  66, Global train loss: 0.469, Global test loss: 1.471, Global test accuracy: 49.70
Round  67, Train loss: 0.523, Test loss: 2.440, Test accuracy: 48.89
Round  67, Global train loss: 0.523, Global test loss: 1.367, Global test accuracy: 52.87
Round  68, Train loss: 0.496, Test loss: 2.449, Test accuracy: 48.89
Round  68, Global train loss: 0.496, Global test loss: 1.355, Global test accuracy: 54.23
Round  69, Train loss: 0.434, Test loss: 2.485, Test accuracy: 48.97
Round  69, Global train loss: 0.434, Global test loss: 1.365, Global test accuracy: 52.51
Round  70, Train loss: 0.421, Test loss: 2.496, Test accuracy: 48.89
Round  70, Global train loss: 0.421, Global test loss: 1.305, Global test accuracy: 55.29
Round  71, Train loss: 0.401, Test loss: 2.505, Test accuracy: 48.92
Round  71, Global train loss: 0.401, Global test loss: 1.316, Global test accuracy: 54.12
Round  72, Train loss: 0.423, Test loss: 2.505, Test accuracy: 48.88
Round  72, Global train loss: 0.423, Global test loss: 1.338, Global test accuracy: 53.56
Round  73, Train loss: 0.410, Test loss: 2.528, Test accuracy: 48.84
Round  73, Global train loss: 0.410, Global test loss: 1.382, Global test accuracy: 51.05
Round  74, Train loss: 0.492, Test loss: 2.558, Test accuracy: 48.90
Round  74, Global train loss: 0.492, Global test loss: 1.457, Global test accuracy: 51.22
Round  75, Train loss: 0.469, Test loss: 2.567, Test accuracy: 48.90
Round  75, Global train loss: 0.469, Global test loss: 1.366, Global test accuracy: 53.63
Round  76, Train loss: 0.451, Test loss: 2.598, Test accuracy: 48.90
Round  76, Global train loss: 0.451, Global test loss: 1.330, Global test accuracy: 54.15
Round  77, Train loss: 0.475, Test loss: 2.609, Test accuracy: 48.95
Round  77, Global train loss: 0.475, Global test loss: 1.372, Global test accuracy: 54.17
Round  78, Train loss: 0.399, Test loss: 2.669, Test accuracy: 49.13
Round  78, Global train loss: 0.399, Global test loss: 1.322, Global test accuracy: 55.00
Round  79, Train loss: 0.345, Test loss: 2.676, Test accuracy: 49.20
Round  79, Global train loss: 0.345, Global test loss: 1.418, Global test accuracy: 49.90
Round  80, Train loss: 0.408, Test loss: 2.693, Test accuracy: 49.03
Round  80, Global train loss: 0.408, Global test loss: 1.347, Global test accuracy: 54.58
Round  81, Train loss: 0.452, Test loss: 2.680, Test accuracy: 48.82
Round  81, Global train loss: 0.452, Global test loss: 1.489, Global test accuracy: 48.89
Round  82, Train loss: 0.345, Test loss: 2.721, Test accuracy: 48.18
Round  82, Global train loss: 0.345, Global test loss: 1.299, Global test accuracy: 56.47
Round  83, Train loss: 0.403, Test loss: 2.757, Test accuracy: 48.33
Round  83, Global train loss: 0.403, Global test loss: 1.363, Global test accuracy: 54.10
Round  84, Train loss: 0.343, Test loss: 2.769, Test accuracy: 48.15
Round  84, Global train loss: 0.343, Global test loss: 1.370, Global test accuracy: 52.19
Round  85, Train loss: 0.362, Test loss: 2.788, Test accuracy: 48.48
Round  85, Global train loss: 0.362, Global test loss: 1.356, Global test accuracy: 52.92
Round  86, Train loss: 0.416, Test loss: 2.751, Test accuracy: 48.54
Round  86, Global train loss: 0.416, Global test loss: 1.402, Global test accuracy: 52.13
Round  87, Train loss: 0.285, Test loss: 2.746, Test accuracy: 48.76
Round  87, Global train loss: 0.285, Global test loss: 1.312, Global test accuracy: 53.80
Round  88, Train loss: 0.356, Test loss: 2.761, Test accuracy: 48.64
Round  88, Global train loss: 0.356, Global test loss: 1.342, Global test accuracy: 54.36
Round  89, Train loss: 0.383, Test loss: 2.779, Test accuracy: 48.76
Round  89, Global train loss: 0.383, Global test loss: 1.364, Global test accuracy: 53.45
Round  90, Train loss: 0.370, Test loss: 2.789, Test accuracy: 48.66
Round  90, Global train loss: 0.370, Global test loss: 1.407, Global test accuracy: 52.02
Round  91, Train loss: 0.350, Test loss: 2.835, Test accuracy: 48.52
Round  91, Global train loss: 0.350, Global test loss: 1.311, Global test accuracy: 55.87
Round  92, Train loss: 0.326, Test loss: 2.847, Test accuracy: 48.68
Round  92, Global train loss: 0.326, Global test loss: 1.300, Global test accuracy: 55.97
Round  93, Train loss: 0.307, Test loss: 2.883, Test accuracy: 48.73
Round  93, Global train loss: 0.307, Global test loss: 1.332, Global test accuracy: 53.30
Round  94, Train loss: 0.303, Test loss: 2.893, Test accuracy: 48.83
Round  94, Global train loss: 0.303, Global test loss: 1.352, Global test accuracy: 54.76
Round  95, Train loss: 0.336, Test loss: 2.918, Test accuracy: 48.72
Round  95, Global train loss: 0.336, Global test loss: 1.274, Global test accuracy: 56.95
Round  96, Train loss: 0.356, Test loss: 2.910, Test accuracy: 49.01
Round  96, Global train loss: 0.356, Global test loss: 1.346, Global test accuracy: 54.09
Round  97, Train loss: 0.318, Test loss: 2.927, Test accuracy: 48.64
Round  97, Global train loss: 0.318, Global test loss: 1.443, Global test accuracy: 50.09
Round  98, Train loss: 0.361, Test loss: 2.892, Test accuracy: 48.55
Round  98, Global train loss: 0.361, Global test loss: 1.535, Global test accuracy: 46.27
Round  99, Train loss: 0.295, Test loss: 2.956, Test accuracy: 48.55
Round  99, Global train loss: 0.295, Global test loss: 1.374, Global test accuracy: 51.91
Final Round, Train loss: 0.219, Test loss: 3.221, Test accuracy: 49.00
Final Round, Global train loss: 0.219, Global test loss: 1.374, Global test accuracy: 51.91
Average accuracy final 10 rounds: 48.68775000000001 

Average global accuracy final 10 rounds: 53.12225 

6126.447880029678
[5.127928256988525, 10.25585651397705, 15.260884284973145, 20.26591205596924, 24.593955516815186, 28.921998977661133, 33.3327841758728, 37.74356937408447, 42.06775188446045, 46.391934394836426, 50.69935393333435, 55.006773471832275, 59.323970317840576, 63.64116716384888, 67.9655864238739, 72.29000568389893, 76.59942722320557, 80.9088487625122, 85.20548677444458, 89.50212478637695, 93.81682991981506, 98.13153505325317, 102.42153549194336, 106.71153593063354, 111.0123929977417, 115.31325006484985, 119.61610698699951, 123.91896390914917, 128.24127578735352, 132.56358766555786, 136.87828922271729, 141.1929907798767, 145.56214356422424, 149.93129634857178, 154.28702807426453, 158.64275979995728, 163.0099024772644, 167.37704515457153, 171.75132727622986, 176.12560939788818, 180.43349194526672, 184.74137449264526, 189.05254364013672, 193.36371278762817, 197.6479263305664, 201.93213987350464, 206.24306511878967, 210.5539903640747, 214.87165331840515, 219.1893162727356, 223.53102588653564, 227.8727355003357, 232.20831203460693, 236.54388856887817, 240.8828043937683, 245.22172021865845, 249.63989853858948, 254.0580768585205, 258.40036845207214, 262.7426600456238, 267.14286279678345, 271.5430655479431, 276.00743293762207, 280.471800327301, 284.8273751735687, 289.1829500198364, 293.5356750488281, 297.8884000778198, 302.3866517543793, 306.8849034309387, 311.2264847755432, 315.5680661201477, 319.9323527812958, 324.29663944244385, 328.6501507759094, 333.003662109375, 337.32768869400024, 341.6517152786255, 345.9942145347595, 350.33671379089355, 354.66885781288147, 359.0010018348694, 363.3452785015106, 367.68955516815186, 372.0180640220642, 376.34657287597656, 380.68536591529846, 385.02415895462036, 389.35623931884766, 393.68831968307495, 398.0172965526581, 402.3462734222412, 406.69333004951477, 411.04038667678833, 415.3992750644684, 419.75816345214844, 424.11493825912476, 428.4717130661011, 432.8050570487976, 437.13840103149414, 441.46316361427307, 445.787926197052, 450.12005519866943, 454.45218420028687, 458.81948161125183, 463.1867790222168, 467.54360461235046, 471.90043020248413, 476.24064564704895, 480.58086109161377, 484.921457529068, 489.2620539665222, 493.5670254230499, 497.87199687957764, 502.2493026256561, 506.6266083717346, 510.9642231464386, 515.3018379211426, 519.6258218288422, 523.9498057365417, 528.2617371082306, 532.5736684799194, 536.909396648407, 541.2451248168945, 545.5942251682281, 549.9433255195618, 554.2773506641388, 558.6113758087158, 562.9717335700989, 567.3320913314819, 571.7110767364502, 576.0900621414185, 580.4480767250061, 584.8060913085938, 589.1125185489655, 593.4189457893372, 597.7569494247437, 602.0949530601501, 606.4194946289062, 610.7440361976624, 615.0242335796356, 619.3044309616089, 623.6367950439453, 627.9691591262817, 632.3456745147705, 636.7221899032593, 641.0405333042145, 645.3588767051697, 649.6874678134918, 654.016058921814, 658.3224849700928, 662.6289110183716, 666.9325680732727, 671.2362251281738, 675.585363149643, 679.9345011711121, 684.2505843639374, 688.5666675567627, 692.876957654953, 697.1872477531433, 701.558586359024, 705.9299249649048, 710.2729206085205, 714.6159162521362, 718.9517381191254, 723.2875599861145, 727.6549916267395, 732.0224232673645, 736.3748872280121, 740.7273511886597, 745.1490273475647, 749.5707035064697, 754.1056351661682, 758.6405668258667, 762.953409910202, 767.2662529945374, 771.5719454288483, 775.8776378631592, 780.2023630142212, 784.5270881652832, 788.8543176651001, 793.181547164917, 797.5079691410065, 801.834391117096, 806.1461188793182, 810.4578466415405, 814.789489030838, 819.1211314201355, 823.471396446228, 827.8216614723206, 832.1315188407898, 836.441376209259, 840.7974390983582, 845.1535019874573, 849.6954762935638, 854.2374505996704, 858.5522675514221, 862.8670845031738, 867.2243542671204, 871.5816240310669, 873.7640171051025, 875.9464101791382]
[35.62, 35.62, 42.4125, 42.4125, 44.8125, 44.8125, 45.4525, 45.4525, 46.125, 46.125, 46.325, 46.325, 47.045, 47.045, 47.0425, 47.0425, 47.385, 47.385, 47.8625, 47.8625, 48.555, 48.555, 48.77, 48.77, 49.005, 49.005, 49.0775, 49.0775, 49.39, 49.39, 49.7525, 49.7525, 50.1325, 50.1325, 50.2025, 50.2025, 50.365, 50.365, 50.3925, 50.3925, 50.48, 50.48, 50.2575, 50.2575, 50.255, 50.255, 50.3525, 50.3525, 50.725, 50.725, 50.8625, 50.8625, 50.82, 50.82, 50.6825, 50.6825, 50.2325, 50.2325, 50.465, 50.465, 50.4325, 50.4325, 50.4, 50.4, 50.2975, 50.2975, 50.1125, 50.1125, 49.89, 49.89, 50.18, 50.18, 50.195, 50.195, 50.5075, 50.5075, 50.1325, 50.1325, 49.9875, 49.9875, 49.995, 49.995, 49.73, 49.73, 49.785, 49.785, 49.615, 49.615, 49.57, 49.57, 49.45, 49.45, 49.475, 49.475, 49.15, 49.15, 49.6575, 49.6575, 49.7125, 49.7125, 49.305, 49.305, 49.445, 49.445, 49.2225, 49.2225, 48.915, 48.915, 48.75, 48.75, 48.8925, 48.8925, 49.415, 49.415, 49.135, 49.135, 49.1575, 49.1575, 49.29, 49.29, 49.2725, 49.2725, 49.56, 49.56, 49.4425, 49.4425, 49.0725, 49.0725, 48.9575, 48.9575, 48.885, 48.885, 48.885, 48.885, 48.8875, 48.8875, 48.8925, 48.8925, 48.965, 48.965, 48.8925, 48.8925, 48.9175, 48.9175, 48.88, 48.88, 48.84, 48.84, 48.9025, 48.9025, 48.9, 48.9, 48.895, 48.895, 48.945, 48.945, 49.1325, 49.1325, 49.1975, 49.1975, 49.03, 49.03, 48.8175, 48.8175, 48.1775, 48.1775, 48.325, 48.325, 48.15, 48.15, 48.485, 48.485, 48.54, 48.54, 48.755, 48.755, 48.6375, 48.6375, 48.7575, 48.7575, 48.6575, 48.6575, 48.5225, 48.5225, 48.68, 48.68, 48.7275, 48.7275, 48.8275, 48.8275, 48.7225, 48.7225, 49.0075, 49.0075, 48.6425, 48.6425, 48.545, 48.545, 48.545, 48.545, 49.0025, 49.0025]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.2  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.2000 
   Client 5, noise    level: 0.2000 
   Client 1, noise    level: 0.2000 
   Client 3, noise    level: 0.2000 
   Client 9, noise    level: 0.2000 
   Client 10, noise    level: 0.2000 
   Client 15, noise    level: 0.2000 
   Client 18, noise    level: 0.2000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.178, Test loss: 1.831, Test accuracy: 30.14
Round   0, Global train loss: 1.178, Global test loss: 2.222, Global test accuracy: 19.23
Round   1, Train loss: 1.096, Test loss: 1.426, Test accuracy: 43.42
Round   1, Global train loss: 1.096, Global test loss: 2.049, Global test accuracy: 18.29
Round   2, Train loss: 0.953, Test loss: 1.028, Test accuracy: 61.98
Round   2, Global train loss: 0.953, Global test loss: 1.870, Global test accuracy: 35.05
Round   3, Train loss: 0.925, Test loss: 0.966, Test accuracy: 61.39
Round   3, Global train loss: 0.925, Global test loss: 1.861, Global test accuracy: 28.68
Round   4, Train loss: 0.890, Test loss: 0.896, Test accuracy: 67.52
Round   4, Global train loss: 0.890, Global test loss: 1.727, Global test accuracy: 40.81
Round   5, Train loss: 1.015, Test loss: 0.861, Test accuracy: 67.52
Round   5, Global train loss: 1.015, Global test loss: 1.857, Global test accuracy: 32.03
Round   6, Train loss: 0.851, Test loss: 0.735, Test accuracy: 74.13
Round   6, Global train loss: 0.851, Global test loss: 1.606, Global test accuracy: 48.13
Round   7, Train loss: 0.993, Test loss: 0.618, Test accuracy: 78.07
Round   7, Global train loss: 0.993, Global test loss: 1.696, Global test accuracy: 40.34
Round   8, Train loss: 0.735, Test loss: 0.600, Test accuracy: 78.71
Round   8, Global train loss: 0.735, Global test loss: 1.581, Global test accuracy: 42.56
Round   9, Train loss: 0.855, Test loss: 0.588, Test accuracy: 79.16
Round   9, Global train loss: 0.855, Global test loss: 1.747, Global test accuracy: 41.65
Round  10, Train loss: 0.638, Test loss: 0.590, Test accuracy: 79.17
Round  10, Global train loss: 0.638, Global test loss: 1.557, Global test accuracy: 50.02
Round  11, Train loss: 0.908, Test loss: 0.584, Test accuracy: 80.05
Round  11, Global train loss: 0.908, Global test loss: 1.478, Global test accuracy: 55.46
Round  12, Train loss: 0.781, Test loss: 0.579, Test accuracy: 80.12
Round  12, Global train loss: 0.781, Global test loss: 1.627, Global test accuracy: 44.76
Round  13, Train loss: 0.894, Test loss: 0.577, Test accuracy: 80.39
Round  13, Global train loss: 0.894, Global test loss: 1.606, Global test accuracy: 45.42
Round  14, Train loss: 0.683, Test loss: 0.586, Test accuracy: 80.20
Round  14, Global train loss: 0.683, Global test loss: 1.416, Global test accuracy: 53.40
Round  15, Train loss: 0.576, Test loss: 0.581, Test accuracy: 80.48
Round  15, Global train loss: 0.576, Global test loss: 1.453, Global test accuracy: 49.37
Round  16, Train loss: 0.620, Test loss: 0.566, Test accuracy: 80.97
Round  16, Global train loss: 0.620, Global test loss: 1.372, Global test accuracy: 55.88
Round  17, Train loss: 0.821, Test loss: 0.565, Test accuracy: 81.08
Round  17, Global train loss: 0.821, Global test loss: 1.454, Global test accuracy: 54.38
Round  18, Train loss: 0.694, Test loss: 0.565, Test accuracy: 81.20
Round  18, Global train loss: 0.694, Global test loss: 1.409, Global test accuracy: 55.24
Round  19, Train loss: 0.782, Test loss: 0.535, Test accuracy: 82.37
Round  19, Global train loss: 0.782, Global test loss: 1.378, Global test accuracy: 56.02
Round  20, Train loss: 0.621, Test loss: 0.540, Test accuracy: 82.30
Round  20, Global train loss: 0.621, Global test loss: 1.365, Global test accuracy: 56.48
Round  21, Train loss: 0.803, Test loss: 0.529, Test accuracy: 82.55
Round  21, Global train loss: 0.803, Global test loss: 1.386, Global test accuracy: 54.25
Round  22, Train loss: 0.658, Test loss: 0.514, Test accuracy: 82.99
Round  22, Global train loss: 0.658, Global test loss: 1.428, Global test accuracy: 53.45
Round  23, Train loss: 0.682, Test loss: 0.507, Test accuracy: 83.29
Round  23, Global train loss: 0.682, Global test loss: 1.235, Global test accuracy: 62.50
Round  24, Train loss: 0.623, Test loss: 0.512, Test accuracy: 83.31
Round  24, Global train loss: 0.623, Global test loss: 1.309, Global test accuracy: 58.23
Round  25, Train loss: 0.625, Test loss: 0.501, Test accuracy: 83.54
Round  25, Global train loss: 0.625, Global test loss: 1.328, Global test accuracy: 55.83
Round  26, Train loss: 0.652, Test loss: 0.507, Test accuracy: 83.42
Round  26, Global train loss: 0.652, Global test loss: 1.308, Global test accuracy: 55.94
Round  27, Train loss: 0.627, Test loss: 0.499, Test accuracy: 83.54
Round  27, Global train loss: 0.627, Global test loss: 1.266, Global test accuracy: 61.57
Round  28, Train loss: 0.702, Test loss: 0.483, Test accuracy: 83.91
Round  28, Global train loss: 0.702, Global test loss: 1.201, Global test accuracy: 63.26
Round  29, Train loss: 0.589, Test loss: 0.480, Test accuracy: 84.18
Round  29, Global train loss: 0.589, Global test loss: 1.286, Global test accuracy: 58.82
Round  30, Train loss: 0.526, Test loss: 0.483, Test accuracy: 84.08
Round  30, Global train loss: 0.526, Global test loss: 1.189, Global test accuracy: 63.25
Round  31, Train loss: 0.513, Test loss: 0.477, Test accuracy: 84.34
Round  31, Global train loss: 0.513, Global test loss: 1.295, Global test accuracy: 60.08
Round  32, Train loss: 0.595, Test loss: 0.487, Test accuracy: 84.15
Round  32, Global train loss: 0.595, Global test loss: 1.222, Global test accuracy: 61.54
Round  33, Train loss: 0.590, Test loss: 0.498, Test accuracy: 83.95
Round  33, Global train loss: 0.590, Global test loss: 1.407, Global test accuracy: 55.59
Round  34, Train loss: 0.558, Test loss: 0.486, Test accuracy: 84.16
Round  34, Global train loss: 0.558, Global test loss: 1.233, Global test accuracy: 60.46
Round  35, Train loss: 0.607, Test loss: 0.482, Test accuracy: 84.20
Round  35, Global train loss: 0.607, Global test loss: 1.340, Global test accuracy: 59.42
Round  36, Train loss: 0.593, Test loss: 0.481, Test accuracy: 84.40
Round  36, Global train loss: 0.593, Global test loss: 1.294, Global test accuracy: 60.72
Round  37, Train loss: 0.626, Test loss: 0.476, Test accuracy: 84.51
Round  37, Global train loss: 0.626, Global test loss: 1.221, Global test accuracy: 62.22
Round  38, Train loss: 0.682, Test loss: 0.480, Test accuracy: 84.15
Round  38, Global train loss: 0.682, Global test loss: 1.405, Global test accuracy: 51.89
Round  39, Train loss: 0.537, Test loss: 0.488, Test accuracy: 84.03
Round  39, Global train loss: 0.537, Global test loss: 1.219, Global test accuracy: 60.48
Round  40, Train loss: 0.639, Test loss: 0.486, Test accuracy: 84.05
Round  40, Global train loss: 0.639, Global test loss: 1.291, Global test accuracy: 57.23
Round  41, Train loss: 0.590, Test loss: 0.488, Test accuracy: 84.05
Round  41, Global train loss: 0.590, Global test loss: 1.320, Global test accuracy: 57.92
Round  42, Train loss: 0.510, Test loss: 0.478, Test accuracy: 84.27
Round  42, Global train loss: 0.510, Global test loss: 1.294, Global test accuracy: 60.00
Round  43, Train loss: 0.546, Test loss: 0.485, Test accuracy: 84.35
Round  43, Global train loss: 0.546, Global test loss: 1.341, Global test accuracy: 58.07
Round  44, Train loss: 0.496, Test loss: 0.477, Test accuracy: 84.88
Round  44, Global train loss: 0.496, Global test loss: 1.292, Global test accuracy: 58.45
Round  45, Train loss: 0.522, Test loss: 0.492, Test accuracy: 84.53
Round  45, Global train loss: 0.522, Global test loss: 1.296, Global test accuracy: 59.45
Round  46, Train loss: 0.613, Test loss: 0.489, Test accuracy: 84.65
Round  46, Global train loss: 0.613, Global test loss: 1.319, Global test accuracy: 57.30
Round  47, Train loss: 0.563, Test loss: 0.498, Test accuracy: 84.41
Round  47, Global train loss: 0.563, Global test loss: 1.293, Global test accuracy: 58.81
Round  48, Train loss: 0.499, Test loss: 0.486, Test accuracy: 84.73
Round  48, Global train loss: 0.499, Global test loss: 1.432, Global test accuracy: 54.59
Round  49, Train loss: 0.636, Test loss: 0.471, Test accuracy: 85.01
Round  49, Global train loss: 0.636, Global test loss: 1.352, Global test accuracy: 56.41
Round  50, Train loss: 0.356, Test loss: 0.478, Test accuracy: 84.78
Round  50, Global train loss: 0.356, Global test loss: 1.298, Global test accuracy: 60.34
Round  51, Train loss: 0.540, Test loss: 0.471, Test accuracy: 84.80
Round  51, Global train loss: 0.540, Global test loss: 1.211, Global test accuracy: 60.92
Round  52, Train loss: 0.522, Test loss: 0.476, Test accuracy: 84.70
Round  52, Global train loss: 0.522, Global test loss: 1.352, Global test accuracy: 55.99
Round  53, Train loss: 0.504, Test loss: 0.483, Test accuracy: 84.34
Round  53, Global train loss: 0.504, Global test loss: 1.321, Global test accuracy: 57.16
Round  54, Train loss: 0.498, Test loss: 0.487, Test accuracy: 84.21
Round  54, Global train loss: 0.498, Global test loss: 1.515, Global test accuracy: 52.16
Round  55, Train loss: 0.494, Test loss: 0.483, Test accuracy: 84.39
Round  55, Global train loss: 0.494, Global test loss: 1.243, Global test accuracy: 60.64
Round  56, Train loss: 0.614, Test loss: 0.480, Test accuracy: 84.53
Round  56, Global train loss: 0.614, Global test loss: 1.379, Global test accuracy: 56.02
Round  57, Train loss: 0.450, Test loss: 0.489, Test accuracy: 84.44
Round  57, Global train loss: 0.450, Global test loss: 1.460, Global test accuracy: 55.82
Round  58, Train loss: 0.454, Test loss: 0.491, Test accuracy: 84.49
Round  58, Global train loss: 0.454, Global test loss: 1.343, Global test accuracy: 56.82
Round  59, Train loss: 0.491, Test loss: 0.488, Test accuracy: 84.54
Round  59, Global train loss: 0.491, Global test loss: 1.423, Global test accuracy: 58.26
Round  60, Train loss: 0.431, Test loss: 0.494, Test accuracy: 84.29
Round  60, Global train loss: 0.431, Global test loss: 1.422, Global test accuracy: 53.83
Round  61, Train loss: 0.441, Test loss: 0.508, Test accuracy: 84.03
Round  61, Global train loss: 0.441, Global test loss: 1.368, Global test accuracy: 58.83
Round  62, Train loss: 0.601, Test loss: 0.516, Test accuracy: 83.92
Round  62, Global train loss: 0.601, Global test loss: 1.307, Global test accuracy: 59.44
Round  63, Train loss: 0.496, Test loss: 0.517, Test accuracy: 83.89
Round  63, Global train loss: 0.496, Global test loss: 1.271, Global test accuracy: 59.28
Round  64, Train loss: 0.460, Test loss: 0.500, Test accuracy: 84.28
Round  64, Global train loss: 0.460, Global test loss: 1.549, Global test accuracy: 51.45
Round  65, Train loss: 0.626, Test loss: 0.509, Test accuracy: 84.20
Round  65, Global train loss: 0.626, Global test loss: 1.382, Global test accuracy: 55.84
Round  66, Train loss: 0.441, Test loss: 0.513, Test accuracy: 84.04
Round  66, Global train loss: 0.441, Global test loss: 1.345, Global test accuracy: 57.35
Round  67, Train loss: 0.503, Test loss: 0.505, Test accuracy: 84.29
Round  67, Global train loss: 0.503, Global test loss: 1.392, Global test accuracy: 58.70
Round  68, Train loss: 0.439, Test loss: 0.512, Test accuracy: 84.03
Round  68, Global train loss: 0.439, Global test loss: 1.450, Global test accuracy: 57.87
Round  69, Train loss: 0.361, Test loss: 0.502, Test accuracy: 84.27
Round  69, Global train loss: 0.361, Global test loss: 1.426, Global test accuracy: 56.04
Round  70, Train loss: 0.491, Test loss: 0.507, Test accuracy: 84.21
Round  70, Global train loss: 0.491, Global test loss: 1.306, Global test accuracy: 58.87
Round  71, Train loss: 0.387, Test loss: 0.511, Test accuracy: 84.18
Round  71, Global train loss: 0.387, Global test loss: 1.360, Global test accuracy: 59.48
Round  72, Train loss: 0.417, Test loss: 0.506, Test accuracy: 84.48
Round  72, Global train loss: 0.417, Global test loss: 1.462, Global test accuracy: 55.45
Round  73, Train loss: 0.417, Test loss: 0.522, Test accuracy: 84.29
Round  73, Global train loss: 0.417, Global test loss: 1.244, Global test accuracy: 63.46
Round  74, Train loss: 0.359, Test loss: 0.508, Test accuracy: 84.36
Round  74, Global train loss: 0.359, Global test loss: 1.332, Global test accuracy: 63.24
Round  75, Train loss: 0.499, Test loss: 0.505, Test accuracy: 84.19
Round  75, Global train loss: 0.499, Global test loss: 1.331, Global test accuracy: 59.18
Round  76, Train loss: 0.476, Test loss: 0.506, Test accuracy: 84.14
Round  76, Global train loss: 0.476, Global test loss: 1.259, Global test accuracy: 59.55
Round  77, Train loss: 0.531, Test loss: 0.506, Test accuracy: 84.22
Round  77, Global train loss: 0.531, Global test loss: 1.454, Global test accuracy: 56.79
Round  78, Train loss: 0.459, Test loss: 0.505, Test accuracy: 84.08
Round  78, Global train loss: 0.459, Global test loss: 1.355, Global test accuracy: 57.98
Round  79, Train loss: 0.453, Test loss: 0.505, Test accuracy: 84.14
Round  79, Global train loss: 0.453, Global test loss: 1.259, Global test accuracy: 60.68
Round  80, Train loss: 0.489, Test loss: 0.501, Test accuracy: 84.32
Round  80, Global train loss: 0.489, Global test loss: 1.311, Global test accuracy: 59.84
Round  81, Train loss: 0.427, Test loss: 0.505, Test accuracy: 84.30
Round  81, Global train loss: 0.427, Global test loss: 1.441, Global test accuracy: 55.83
Round  82, Train loss: 0.422, Test loss: 0.510, Test accuracy: 84.32
Round  82, Global train loss: 0.422, Global test loss: 1.248, Global test accuracy: 60.55
Round  83, Train loss: 0.428, Test loss: 0.519, Test accuracy: 84.07
Round  83, Global train loss: 0.428, Global test loss: 1.313, Global test accuracy: 59.12
Round  84, Train loss: 0.427, Test loss: 0.515, Test accuracy: 84.07
Round  84, Global train loss: 0.427, Global test loss: 1.323, Global test accuracy: 59.44
Round  85, Train loss: 0.436, Test loss: 0.514, Test accuracy: 84.16
Round  85, Global train loss: 0.436, Global test loss: 1.347, Global test accuracy: 60.33
Round  86, Train loss: 0.368, Test loss: 0.516, Test accuracy: 83.89
Round  86, Global train loss: 0.368, Global test loss: 1.481, Global test accuracy: 58.47
Round  87, Train loss: 0.438, Test loss: 0.530, Test accuracy: 83.64
Round  87, Global train loss: 0.438, Global test loss: 1.436, Global test accuracy: 58.23
Round  88, Train loss: 0.422, Test loss: 0.537, Test accuracy: 83.42
Round  88, Global train loss: 0.422, Global test loss: 1.530, Global test accuracy: 55.56
Round  89, Train loss: 0.378, Test loss: 0.530, Test accuracy: 83.61
Round  89, Global train loss: 0.378, Global test loss: 1.563, Global test accuracy: 55.92
Round  90, Train loss: 0.475, Test loss: 0.529, Test accuracy: 83.92
Round  90, Global train loss: 0.475, Global test loss: 1.598, Global test accuracy: 53.05
Round  91, Train loss: 0.481, Test loss: 0.518, Test accuracy: 83.94
Round  91, Global train loss: 0.481, Global test loss: 1.530, Global test accuracy: 53.13
Round  92, Train loss: 0.411, Test loss: 0.512, Test accuracy: 83.97
Round  92, Global train loss: 0.411, Global test loss: 1.469, Global test accuracy: 56.33
Round  93, Train loss: 0.434, Test loss: 0.525, Test accuracy: 83.68
Round  93, Global train loss: 0.434, Global test loss: 1.493, Global test accuracy: 58.24
Round  94, Train loss: 0.382, Test loss: 0.531, Test accuracy: 83.51
Round  94, Global train loss: 0.382, Global test loss: 1.554, Global test accuracy: 56.66
Round  95, Train loss: 0.473, Test loss: 0.542, Test accuracy: 83.40
Round  95, Global train loss: 0.473, Global test loss: 1.487, Global test accuracy: 56.90
Round  96, Train loss: 0.330, Test loss: 0.545, Test accuracy: 83.39
Round  96, Global train loss: 0.330, Global test loss: 1.657, Global test accuracy: 55.41
Round  97, Train loss: 0.450, Test loss: 0.548, Test accuracy: 83.61
Round  97, Global train loss: 0.450, Global test loss: 1.343, Global test accuracy: 59.94
Round  98, Train loss: 0.357, Test loss: 0.558, Test accuracy: 83.51
Round  98, Global train loss: 0.357, Global test loss: 1.481, Global test accuracy: 57.48
Round  99, Train loss: 0.498, Test loss: 0.555, Test accuracy: 83.30
Round  99, Global train loss: 0.498, Global test loss: 1.567, Global test accuracy: 53.91
Final Round, Train loss: 0.272, Test loss: 0.625, Test accuracy: 83.06
Final Round, Global train loss: 0.272, Global test loss: 1.567, Global test accuracy: 53.91
Average accuracy final 10 rounds: 83.62305555555554 

Average global accuracy final 10 rounds: 56.10416666666668 

5645.822255849838
[4.906698942184448, 9.813397884368896, 14.507290363311768, 19.20118284225464, 24.04068946838379, 28.88019609451294, 33.54785442352295, 38.21551275253296, 42.68273210525513, 47.149951457977295, 51.741793632507324, 56.33363580703735, 60.97176694869995, 65.60989809036255, 70.12467455863953, 74.6394510269165, 79.15303373336792, 83.66661643981934, 88.35153317451477, 93.0364499092102, 97.67754435539246, 102.3186388015747, 106.9994113445282, 111.68018388748169, 116.32541418075562, 120.97064447402954, 125.62963128089905, 130.28861808776855, 134.96358036994934, 139.63854265213013, 144.28970408439636, 148.9408655166626, 153.61436772346497, 158.28786993026733, 162.83604311943054, 167.38421630859375, 171.79245495796204, 176.20069360733032, 180.56266570091248, 184.92463779449463, 189.2940890789032, 193.66354036331177, 198.06402158737183, 202.46450281143188, 206.8763554096222, 211.2882080078125, 215.6801736354828, 220.07213926315308, 224.46616506576538, 228.86019086837769, 233.1787555217743, 237.4973201751709, 241.32265424728394, 245.14798831939697, 248.97578167915344, 252.8035750389099, 256.86494994163513, 260.92632484436035, 264.8976743221283, 268.86902379989624, 272.70400071144104, 276.53897762298584, 280.37285113334656, 284.2067246437073, 288.0381007194519, 291.86947679519653, 295.68944692611694, 299.50941705703735, 303.5923161506653, 307.6752152442932, 311.6528568267822, 315.63049840927124, 319.89503622055054, 324.15957403182983, 328.14706110954285, 332.13454818725586, 336.1675646305084, 340.200581073761, 344.012282371521, 347.823983669281, 351.6147201061249, 355.40545654296875, 359.1937942504883, 362.9821319580078, 366.7935814857483, 370.60503101348877, 374.86441564559937, 379.12380027770996, 383.057861328125, 386.99192237854004, 390.8057098388672, 394.61949729919434, 398.4203555583954, 402.22121381759644, 406.0476291179657, 409.87404441833496, 413.7141377925873, 417.5542311668396, 421.9030861854553, 426.25194120407104, 430.6593437194824, 435.0667462348938, 439.4333481788635, 443.79995012283325, 448.1788673400879, 452.55778455734253, 456.95682191848755, 461.35585927963257, 465.71332001686096, 470.07078075408936, 474.42891335487366, 478.78704595565796, 483.1390869617462, 487.4911279678345, 491.83635234832764, 496.1815767288208, 500.61157059669495, 505.0415644645691, 509.4865896701813, 513.9316148757935, 518.3083233833313, 522.6850318908691, 527.0652384757996, 531.44544506073, 535.8460447788239, 540.2466444969177, 544.6398911476135, 549.0331377983093, 553.462858915329, 557.8925800323486, 562.3008925914764, 566.7092051506042, 571.1022388935089, 575.4952726364136, 579.8930101394653, 584.2907476425171, 588.677120923996, 593.0634942054749, 597.5136239528656, 601.9637537002563, 606.4847214221954, 611.0056891441345, 615.4120399951935, 619.8183908462524, 624.1012966632843, 628.3842024803162, 632.783460855484, 637.1827192306519, 641.7398838996887, 646.2970485687256, 650.6501190662384, 655.0031895637512, 659.464197397232, 663.9252052307129, 668.3261778354645, 672.7271504402161, 677.138813495636, 681.5504765510559, 685.9668684005737, 690.3832602500916, 694.817004442215, 699.2507486343384, 703.6828627586365, 708.1149768829346, 712.5379688739777, 716.9609608650208, 721.396466255188, 725.8319716453552, 730.2722010612488, 734.7124304771423, 739.1627380847931, 743.6130456924438, 748.0601286888123, 752.5072116851807, 756.9578568935394, 761.4085021018982, 765.8410584926605, 770.2736148834229, 774.7583351135254, 779.2430553436279, 783.6976447105408, 788.1522340774536, 792.6317203044891, 797.1112065315247, 801.5843212604523, 806.0574359893799, 810.4978494644165, 814.9382629394531, 818.8094913959503, 822.6807198524475, 826.5569493770599, 830.4331789016724, 834.3089570999146, 838.1847352981567, 842.060613155365, 845.9364910125732, 849.8232197761536, 853.7099485397339, 857.5923857688904, 861.4748229980469, 863.6452715396881, 865.8157200813293]
[30.136111111111113, 30.136111111111113, 43.419444444444444, 43.419444444444444, 61.983333333333334, 61.983333333333334, 61.394444444444446, 61.394444444444446, 67.51666666666667, 67.51666666666667, 67.51944444444445, 67.51944444444445, 74.12777777777778, 74.12777777777778, 78.07222222222222, 78.07222222222222, 78.70555555555555, 78.70555555555555, 79.16388888888889, 79.16388888888889, 79.16944444444445, 79.16944444444445, 80.04722222222222, 80.04722222222222, 80.12222222222222, 80.12222222222222, 80.39166666666667, 80.39166666666667, 80.20277777777778, 80.20277777777778, 80.47777777777777, 80.47777777777777, 80.97222222222223, 80.97222222222223, 81.08055555555555, 81.08055555555555, 81.20277777777778, 81.20277777777778, 82.37222222222222, 82.37222222222222, 82.3, 82.3, 82.54722222222222, 82.54722222222222, 82.99444444444444, 82.99444444444444, 83.29444444444445, 83.29444444444445, 83.30833333333334, 83.30833333333334, 83.54166666666667, 83.54166666666667, 83.41666666666667, 83.41666666666667, 83.54444444444445, 83.54444444444445, 83.91388888888889, 83.91388888888889, 84.17777777777778, 84.17777777777778, 84.07777777777778, 84.07777777777778, 84.34444444444445, 84.34444444444445, 84.15277777777777, 84.15277777777777, 83.94722222222222, 83.94722222222222, 84.16111111111111, 84.16111111111111, 84.19722222222222, 84.19722222222222, 84.39722222222223, 84.39722222222223, 84.5111111111111, 84.5111111111111, 84.15, 84.15, 84.02777777777777, 84.02777777777777, 84.04722222222222, 84.04722222222222, 84.04722222222222, 84.04722222222222, 84.26944444444445, 84.26944444444445, 84.35277777777777, 84.35277777777777, 84.88055555555556, 84.88055555555556, 84.52777777777777, 84.52777777777777, 84.65, 84.65, 84.40555555555555, 84.40555555555555, 84.73055555555555, 84.73055555555555, 85.01388888888889, 85.01388888888889, 84.78055555555555, 84.78055555555555, 84.80277777777778, 84.80277777777778, 84.69722222222222, 84.69722222222222, 84.34444444444445, 84.34444444444445, 84.20555555555555, 84.20555555555555, 84.3861111111111, 84.3861111111111, 84.525, 84.525, 84.43888888888888, 84.43888888888888, 84.4888888888889, 84.4888888888889, 84.54444444444445, 84.54444444444445, 84.28888888888889, 84.28888888888889, 84.03055555555555, 84.03055555555555, 83.91666666666667, 83.91666666666667, 83.88888888888889, 83.88888888888889, 84.275, 84.275, 84.19722222222222, 84.19722222222222, 84.04166666666667, 84.04166666666667, 84.29166666666667, 84.29166666666667, 84.03055555555555, 84.03055555555555, 84.27222222222223, 84.27222222222223, 84.20555555555555, 84.20555555555555, 84.17777777777778, 84.17777777777778, 84.47777777777777, 84.47777777777777, 84.28888888888889, 84.28888888888889, 84.35555555555555, 84.35555555555555, 84.18611111111112, 84.18611111111112, 84.1361111111111, 84.1361111111111, 84.22222222222223, 84.22222222222223, 84.07777777777778, 84.07777777777778, 84.13888888888889, 84.13888888888889, 84.32222222222222, 84.32222222222222, 84.3, 84.3, 84.31666666666666, 84.31666666666666, 84.06666666666666, 84.06666666666666, 84.06944444444444, 84.06944444444444, 84.15555555555555, 84.15555555555555, 83.8861111111111, 83.8861111111111, 83.64444444444445, 83.64444444444445, 83.425, 83.425, 83.6138888888889, 83.6138888888889, 83.91666666666667, 83.91666666666667, 83.93888888888888, 83.93888888888888, 83.97222222222223, 83.97222222222223, 83.67777777777778, 83.67777777777778, 83.51388888888889, 83.51388888888889, 83.4, 83.4, 83.39166666666667, 83.39166666666667, 83.6138888888889, 83.6138888888889, 83.50833333333334, 83.50833333333334, 83.29722222222222, 83.29722222222222, 83.05833333333334, 83.05833333333334]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.2  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.2000 
   Client 15, noise    level: 0.2000 
   Client 19, noise    level: 0.2000 
   Client 6, noise    level: 0.2000 
   Client 8, noise    level: 0.2000 
   Client 11, noise    level: 0.2000 
   Client 12, noise    level: 0.2000 
   Client 16, noise    level: 0.2000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.084, Test loss: 1.878, Test accuracy: 33.09
Round   0, Global train loss: 2.084, Global test loss: 1.867, Global test accuracy: 34.59
Round   1, Train loss: 1.870, Test loss: 1.718, Test accuracy: 37.31
Round   1, Global train loss: 1.870, Global test loss: 1.645, Global test accuracy: 40.78
Round   2, Train loss: 1.784, Test loss: 1.674, Test accuracy: 39.72
Round   2, Global train loss: 1.784, Global test loss: 1.572, Global test accuracy: 45.52
Round   3, Train loss: 1.718, Test loss: 1.618, Test accuracy: 41.60
Round   3, Global train loss: 1.718, Global test loss: 1.479, Global test accuracy: 47.73
Round   4, Train loss: 1.658, Test loss: 1.563, Test accuracy: 43.16
Round   4, Global train loss: 1.658, Global test loss: 1.416, Global test accuracy: 49.14
Round   5, Train loss: 1.608, Test loss: 1.525, Test accuracy: 44.89
Round   5, Global train loss: 1.608, Global test loss: 1.363, Global test accuracy: 53.05
Round   6, Train loss: 1.564, Test loss: 1.478, Test accuracy: 46.76
Round   6, Global train loss: 1.564, Global test loss: 1.324, Global test accuracy: 54.01
Round   7, Train loss: 1.503, Test loss: 1.463, Test accuracy: 47.29
Round   7, Global train loss: 1.503, Global test loss: 1.270, Global test accuracy: 56.05
Round   8, Train loss: 1.491, Test loss: 1.433, Test accuracy: 48.63
Round   8, Global train loss: 1.491, Global test loss: 1.224, Global test accuracy: 57.02
Round   9, Train loss: 1.479, Test loss: 1.426, Test accuracy: 48.77
Round   9, Global train loss: 1.479, Global test loss: 1.223, Global test accuracy: 58.96
Round  10, Train loss: 1.404, Test loss: 1.363, Test accuracy: 51.40
Round  10, Global train loss: 1.404, Global test loss: 1.175, Global test accuracy: 59.70
Round  11, Train loss: 1.388, Test loss: 1.344, Test accuracy: 52.45
Round  11, Global train loss: 1.388, Global test loss: 1.141, Global test accuracy: 61.78
Round  12, Train loss: 1.386, Test loss: 1.301, Test accuracy: 54.16
Round  12, Global train loss: 1.386, Global test loss: 1.124, Global test accuracy: 62.41
Round  13, Train loss: 1.345, Test loss: 1.272, Test accuracy: 55.34
Round  13, Global train loss: 1.345, Global test loss: 1.093, Global test accuracy: 63.25
Round  14, Train loss: 1.310, Test loss: 1.244, Test accuracy: 56.36
Round  14, Global train loss: 1.310, Global test loss: 1.060, Global test accuracy: 64.00
Round  15, Train loss: 1.307, Test loss: 1.237, Test accuracy: 56.80
Round  15, Global train loss: 1.307, Global test loss: 1.047, Global test accuracy: 64.42
Round  16, Train loss: 1.293, Test loss: 1.216, Test accuracy: 57.72
Round  16, Global train loss: 1.293, Global test loss: 1.040, Global test accuracy: 64.57
Round  17, Train loss: 1.286, Test loss: 1.192, Test accuracy: 58.85
Round  17, Global train loss: 1.286, Global test loss: 1.023, Global test accuracy: 65.84
Round  18, Train loss: 1.268, Test loss: 1.148, Test accuracy: 60.58
Round  18, Global train loss: 1.268, Global test loss: 0.999, Global test accuracy: 66.06
Round  19, Train loss: 1.226, Test loss: 1.138, Test accuracy: 60.96
Round  19, Global train loss: 1.226, Global test loss: 0.978, Global test accuracy: 67.28
Round  20, Train loss: 1.209, Test loss: 1.144, Test accuracy: 60.77
Round  20, Global train loss: 1.209, Global test loss: 0.968, Global test accuracy: 67.72
Round  21, Train loss: 1.175, Test loss: 1.141, Test accuracy: 60.90
Round  21, Global train loss: 1.175, Global test loss: 0.949, Global test accuracy: 67.78
Round  22, Train loss: 1.152, Test loss: 1.113, Test accuracy: 62.08
Round  22, Global train loss: 1.152, Global test loss: 0.946, Global test accuracy: 67.94
Round  23, Train loss: 1.158, Test loss: 1.108, Test accuracy: 62.34
Round  23, Global train loss: 1.158, Global test loss: 0.939, Global test accuracy: 68.33
Round  24, Train loss: 1.166, Test loss: 1.112, Test accuracy: 62.49
Round  24, Global train loss: 1.166, Global test loss: 0.921, Global test accuracy: 69.06
Round  25, Train loss: 1.132, Test loss: 1.098, Test accuracy: 62.98
Round  25, Global train loss: 1.132, Global test loss: 0.915, Global test accuracy: 69.28
Round  26, Train loss: 1.186, Test loss: 1.078, Test accuracy: 63.73
Round  26, Global train loss: 1.186, Global test loss: 0.927, Global test accuracy: 69.97
Round  27, Train loss: 1.078, Test loss: 1.060, Test accuracy: 64.04
Round  27, Global train loss: 1.078, Global test loss: 0.891, Global test accuracy: 70.58
Round  28, Train loss: 1.090, Test loss: 1.056, Test accuracy: 64.11
Round  28, Global train loss: 1.090, Global test loss: 0.885, Global test accuracy: 70.83
Round  29, Train loss: 1.116, Test loss: 1.047, Test accuracy: 64.64
Round  29, Global train loss: 1.116, Global test loss: 0.882, Global test accuracy: 71.37
Round  30, Train loss: 1.077, Test loss: 1.037, Test accuracy: 64.94
Round  30, Global train loss: 1.077, Global test loss: 0.866, Global test accuracy: 71.04
Round  31, Train loss: 1.078, Test loss: 1.037, Test accuracy: 65.03
Round  31, Global train loss: 1.078, Global test loss: 0.877, Global test accuracy: 71.54
Round  32, Train loss: 1.110, Test loss: 1.034, Test accuracy: 65.00
Round  32, Global train loss: 1.110, Global test loss: 0.872, Global test accuracy: 71.46
Round  33, Train loss: 1.040, Test loss: 1.023, Test accuracy: 65.38
Round  33, Global train loss: 1.040, Global test loss: 0.864, Global test accuracy: 71.20
Round  34, Train loss: 1.065, Test loss: 1.014, Test accuracy: 65.69
Round  34, Global train loss: 1.065, Global test loss: 0.858, Global test accuracy: 71.69
Round  35, Train loss: 1.024, Test loss: 1.006, Test accuracy: 66.17
Round  35, Global train loss: 1.024, Global test loss: 0.850, Global test accuracy: 72.34
Round  36, Train loss: 0.995, Test loss: 0.996, Test accuracy: 66.66
Round  36, Global train loss: 0.995, Global test loss: 0.824, Global test accuracy: 72.12
Round  37, Train loss: 1.018, Test loss: 0.989, Test accuracy: 66.86
Round  37, Global train loss: 1.018, Global test loss: 0.822, Global test accuracy: 72.96
Round  38, Train loss: 0.968, Test loss: 0.990, Test accuracy: 66.96
Round  38, Global train loss: 0.968, Global test loss: 0.806, Global test accuracy: 73.04
Round  39, Train loss: 0.980, Test loss: 0.981, Test accuracy: 67.18
Round  39, Global train loss: 0.980, Global test loss: 0.813, Global test accuracy: 72.89
Round  40, Train loss: 0.974, Test loss: 0.977, Test accuracy: 67.19
Round  40, Global train loss: 0.974, Global test loss: 0.810, Global test accuracy: 72.99
Round  41, Train loss: 0.977, Test loss: 0.973, Test accuracy: 67.32
Round  41, Global train loss: 0.977, Global test loss: 0.804, Global test accuracy: 73.31
Round  42, Train loss: 0.985, Test loss: 0.957, Test accuracy: 67.93
Round  42, Global train loss: 0.985, Global test loss: 0.808, Global test accuracy: 73.36
Round  43, Train loss: 0.946, Test loss: 0.972, Test accuracy: 67.53
Round  43, Global train loss: 0.946, Global test loss: 0.806, Global test accuracy: 73.19
Round  44, Train loss: 1.017, Test loss: 0.964, Test accuracy: 67.82
Round  44, Global train loss: 1.017, Global test loss: 0.804, Global test accuracy: 73.42
Round  45, Train loss: 0.938, Test loss: 0.965, Test accuracy: 67.82
Round  45, Global train loss: 0.938, Global test loss: 0.808, Global test accuracy: 72.97
Round  46, Train loss: 0.956, Test loss: 0.960, Test accuracy: 67.94
Round  46, Global train loss: 0.956, Global test loss: 0.794, Global test accuracy: 73.38
Round  47, Train loss: 0.884, Test loss: 0.952, Test accuracy: 68.39
Round  47, Global train loss: 0.884, Global test loss: 0.780, Global test accuracy: 74.11
Round  48, Train loss: 0.919, Test loss: 0.944, Test accuracy: 68.75
Round  48, Global train loss: 0.919, Global test loss: 0.780, Global test accuracy: 74.35
Round  49, Train loss: 0.937, Test loss: 0.935, Test accuracy: 68.98
Round  49, Global train loss: 0.937, Global test loss: 0.773, Global test accuracy: 74.46
Round  50, Train loss: 0.911, Test loss: 0.938, Test accuracy: 68.86
Round  50, Global train loss: 0.911, Global test loss: 0.768, Global test accuracy: 74.30
Round  51, Train loss: 0.919, Test loss: 0.934, Test accuracy: 68.97
Round  51, Global train loss: 0.919, Global test loss: 0.771, Global test accuracy: 74.09
Round  52, Train loss: 0.953, Test loss: 0.923, Test accuracy: 69.47
Round  52, Global train loss: 0.953, Global test loss: 0.777, Global test accuracy: 74.21
Round  53, Train loss: 0.930, Test loss: 0.922, Test accuracy: 69.39
Round  53, Global train loss: 0.930, Global test loss: 0.783, Global test accuracy: 74.01
Round  54, Train loss: 0.904, Test loss: 0.924, Test accuracy: 69.39
Round  54, Global train loss: 0.904, Global test loss: 0.777, Global test accuracy: 74.17
Round  55, Train loss: 0.918, Test loss: 0.928, Test accuracy: 69.23
Round  55, Global train loss: 0.918, Global test loss: 0.774, Global test accuracy: 74.27
Round  56, Train loss: 0.858, Test loss: 0.923, Test accuracy: 69.43
Round  56, Global train loss: 0.858, Global test loss: 0.763, Global test accuracy: 74.56
Round  57, Train loss: 0.899, Test loss: 0.922, Test accuracy: 69.62
Round  57, Global train loss: 0.899, Global test loss: 0.765, Global test accuracy: 74.49
Round  58, Train loss: 0.905, Test loss: 0.923, Test accuracy: 69.64
Round  58, Global train loss: 0.905, Global test loss: 0.765, Global test accuracy: 74.58
Round  59, Train loss: 0.871, Test loss: 0.918, Test accuracy: 69.80
Round  59, Global train loss: 0.871, Global test loss: 0.760, Global test accuracy: 74.78
Round  60, Train loss: 0.873, Test loss: 0.908, Test accuracy: 70.13
Round  60, Global train loss: 0.873, Global test loss: 0.759, Global test accuracy: 74.69
Round  61, Train loss: 0.888, Test loss: 0.908, Test accuracy: 70.00
Round  61, Global train loss: 0.888, Global test loss: 0.753, Global test accuracy: 75.17
Round  62, Train loss: 0.875, Test loss: 0.920, Test accuracy: 69.65
Round  62, Global train loss: 0.875, Global test loss: 0.750, Global test accuracy: 74.99
Round  63, Train loss: 0.837, Test loss: 0.915, Test accuracy: 70.01
Round  63, Global train loss: 0.837, Global test loss: 0.740, Global test accuracy: 75.83
Round  64, Train loss: 0.866, Test loss: 0.902, Test accuracy: 70.42
Round  64, Global train loss: 0.866, Global test loss: 0.744, Global test accuracy: 75.22
Round  65, Train loss: 0.803, Test loss: 0.902, Test accuracy: 70.48
Round  65, Global train loss: 0.803, Global test loss: 0.746, Global test accuracy: 75.43
Round  66, Train loss: 0.870, Test loss: 0.902, Test accuracy: 70.37
Round  66, Global train loss: 0.870, Global test loss: 0.754, Global test accuracy: 75.25
Round  67, Train loss: 0.818, Test loss: 0.910, Test accuracy: 70.35
Round  67, Global train loss: 0.818, Global test loss: 0.740, Global test accuracy: 75.38
Round  68, Train loss: 0.864, Test loss: 0.904, Test accuracy: 70.60
Round  68, Global train loss: 0.864, Global test loss: 0.750, Global test accuracy: 75.05
Round  69, Train loss: 0.817, Test loss: 0.903, Test accuracy: 70.70
Round  69, Global train loss: 0.817, Global test loss: 0.738, Global test accuracy: 75.62
Round  70, Train loss: 0.770, Test loss: 0.905, Test accuracy: 70.64
Round  70, Global train loss: 0.770, Global test loss: 0.743, Global test accuracy: 75.64
Round  71, Train loss: 0.841, Test loss: 0.912, Test accuracy: 70.39
Round  71, Global train loss: 0.841, Global test loss: 0.737, Global test accuracy: 75.36
Round  72, Train loss: 0.777, Test loss: 0.899, Test accuracy: 70.77
Round  72, Global train loss: 0.777, Global test loss: 0.732, Global test accuracy: 76.08
Round  73, Train loss: 0.823, Test loss: 0.898, Test accuracy: 71.07
Round  73, Global train loss: 0.823, Global test loss: 0.734, Global test accuracy: 75.59
Round  74, Train loss: 0.776, Test loss: 0.899, Test accuracy: 70.93
Round  74, Global train loss: 0.776, Global test loss: 0.739, Global test accuracy: 75.53
Round  75, Train loss: 0.814, Test loss: 0.900, Test accuracy: 70.78
Round  75, Global train loss: 0.814, Global test loss: 0.736, Global test accuracy: 75.68
Round  76, Train loss: 0.805, Test loss: 0.885, Test accuracy: 70.99
Round  76, Global train loss: 0.805, Global test loss: 0.734, Global test accuracy: 75.37
Round  77, Train loss: 0.749, Test loss: 0.889, Test accuracy: 70.88
Round  77, Global train loss: 0.749, Global test loss: 0.723, Global test accuracy: 76.24
Round  78, Train loss: 0.744, Test loss: 0.886, Test accuracy: 71.22
Round  78, Global train loss: 0.744, Global test loss: 0.730, Global test accuracy: 75.75
Round  79, Train loss: 0.782, Test loss: 0.888, Test accuracy: 71.07
Round  79, Global train loss: 0.782, Global test loss: 0.738, Global test accuracy: 75.58
Round  80, Train loss: 0.801, Test loss: 0.891, Test accuracy: 71.03
Round  80, Global train loss: 0.801, Global test loss: 0.728, Global test accuracy: 76.31
Round  81, Train loss: 0.799, Test loss: 0.888, Test accuracy: 71.17
Round  81, Global train loss: 0.799, Global test loss: 0.734, Global test accuracy: 75.69
Round  82, Train loss: 0.747, Test loss: 0.883, Test accuracy: 71.42
Round  82, Global train loss: 0.747, Global test loss: 0.721, Global test accuracy: 76.33
Round  83, Train loss: 0.755, Test loss: 0.883, Test accuracy: 71.26
Round  83, Global train loss: 0.755, Global test loss: 0.731, Global test accuracy: 75.68
Round  84, Train loss: 0.850, Test loss: 0.894, Test accuracy: 71.11
Round  84, Global train loss: 0.850, Global test loss: 0.729, Global test accuracy: 76.04
Round  85, Train loss: 0.786, Test loss: 0.894, Test accuracy: 71.19
Round  85, Global train loss: 0.786, Global test loss: 0.720, Global test accuracy: 75.86
Round  86, Train loss: 0.796, Test loss: 0.912, Test accuracy: 70.73
Round  86, Global train loss: 0.796, Global test loss: 0.734, Global test accuracy: 75.85
Round  87, Train loss: 0.747, Test loss: 0.913, Test accuracy: 70.60
Round  87, Global train loss: 0.747, Global test loss: 0.719, Global test accuracy: 76.17
Round  88, Train loss: 0.768, Test loss: 0.916, Test accuracy: 70.48
Round  88, Global train loss: 0.768, Global test loss: 0.724, Global test accuracy: 75.88
Round  89, Train loss: 0.705, Test loss: 0.896, Test accuracy: 70.99
Round  89, Global train loss: 0.705, Global test loss: 0.719, Global test accuracy: 76.03
Round  90, Train loss: 0.763, Test loss: 0.892, Test accuracy: 71.25
Round  90, Global train loss: 0.763, Global test loss: 0.725, Global test accuracy: 76.53
Round  91, Train loss: 0.746, Test loss: 0.883, Test accuracy: 71.53
Round  91, Global train loss: 0.746, Global test loss: 0.715, Global test accuracy: 76.28
Round  92, Train loss: 0.737, Test loss: 0.887, Test accuracy: 71.49
Round  92, Global train loss: 0.737, Global test loss: 0.717, Global test accuracy: 76.10
Round  93, Train loss: 0.760, Test loss: 0.893, Test accuracy: 71.50
Round  93, Global train loss: 0.760, Global test loss: 0.723, Global test accuracy: 76.14/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.747, Test loss: 0.895, Test accuracy: 71.36
Round  94, Global train loss: 0.747, Global test loss: 0.723, Global test accuracy: 75.84
Round  95, Train loss: 0.715, Test loss: 0.885, Test accuracy: 71.62
Round  95, Global train loss: 0.715, Global test loss: 0.708, Global test accuracy: 76.75
Round  96, Train loss: 0.707, Test loss: 0.883, Test accuracy: 71.76
Round  96, Global train loss: 0.707, Global test loss: 0.711, Global test accuracy: 76.65
Round  97, Train loss: 0.793, Test loss: 0.880, Test accuracy: 71.79
Round  97, Global train loss: 0.793, Global test loss: 0.728, Global test accuracy: 76.06
Round  98, Train loss: 0.705, Test loss: 0.893, Test accuracy: 71.53
Round  98, Global train loss: 0.705, Global test loss: 0.726, Global test accuracy: 76.23
Round  99, Train loss: 0.751, Test loss: 0.889, Test accuracy: 71.79
Round  99, Global train loss: 0.751, Global test loss: 0.724, Global test accuracy: 76.36
Final Round, Train loss: 0.484, Test loss: 0.966, Test accuracy: 71.38
Final Round, Global train loss: 0.484, Global test loss: 0.724, Global test accuracy: 76.36
Average accuracy final 10 rounds: 71.56225 

Average global accuracy final 10 rounds: 76.29425 

6310.795882701874
[5.675705909729004, 11.351411819458008, 16.853471994400024, 22.35553216934204, 26.944234371185303, 31.532936573028564, 36.14925026893616, 40.76556396484375, 45.35508918762207, 49.94461441040039, 54.546318769454956, 59.14802312850952, 63.78354525566101, 68.4190673828125, 73.05406332015991, 77.68905925750732, 82.33012628555298, 86.97119331359863, 91.80631184577942, 96.6414303779602, 101.32881140708923, 106.01619243621826, 110.65175867080688, 115.28732490539551, 119.92179656028748, 124.55626821517944, 129.17636966705322, 133.796471118927, 138.39507603645325, 142.9936809539795, 147.61635661125183, 152.23903226852417, 156.83143281936646, 161.42383337020874, 166.04636454582214, 170.66889572143555, 175.48944520950317, 180.3099946975708, 185.58924770355225, 190.8685007095337, 196.15925860404968, 201.45001649856567, 206.71696662902832, 211.98391675949097, 217.21735620498657, 222.45079565048218, 227.66219186782837, 232.87358808517456, 237.81256747245789, 242.7515468597412, 247.36724615097046, 251.9829454421997, 256.58051896095276, 261.1780924797058, 265.84333896636963, 270.50858545303345, 275.2622175216675, 280.0158495903015, 284.73958253860474, 289.46331548690796, 294.06113934516907, 298.6589632034302, 303.26274251937866, 307.86652183532715, 312.5116539001465, 317.1567859649658, 321.7895882129669, 326.422390460968, 331.02011227607727, 335.6178340911865, 340.19497656822205, 344.77211904525757, 349.3894076347351, 354.00669622421265, 358.61967945098877, 363.2326626777649, 367.8350839614868, 372.43750524520874, 377.06336784362793, 381.6892304420471, 386.2930293083191, 390.89682817459106, 395.5335557460785, 400.1702833175659, 404.7984700202942, 409.42665672302246, 414.0530216693878, 418.6793866157532, 423.3079311847687, 427.9364757537842, 432.5461492538452, 437.15582275390625, 441.7990758419037, 446.4423289299011, 451.061096906662, 455.67986488342285, 460.292019367218, 464.9041738510132, 469.58731603622437, 474.27045822143555, 478.94203758239746, 483.6136169433594, 488.2212278842926, 492.82883882522583, 497.45887756347656, 502.0889163017273, 506.704954624176, 511.32099294662476, 515.940515756607, 520.5600385665894, 525.1730813980103, 529.7861242294312, 534.4458177089691, 539.1055111885071, 543.7754125595093, 548.4453139305115, 553.081068277359, 557.7168226242065, 562.3973548412323, 567.077887058258, 571.6606938838959, 576.2435007095337, 580.8631355762482, 585.4827704429626, 590.1235074996948, 594.764244556427, 599.3518660068512, 603.9394874572754, 608.5314192771912, 613.1233510971069, 617.7019400596619, 622.2805290222168, 626.8861556053162, 631.4917821884155, 636.1076679229736, 640.7235536575317, 645.3481845855713, 649.9728155136108, 654.5697274208069, 659.1666393280029, 664.0066230297089, 668.8466067314148, 673.4892995357513, 678.1319923400879, 682.796858549118, 687.4617247581482, 692.170734167099, 696.8797435760498, 701.4980392456055, 706.1163349151611, 710.7296595573425, 715.3429841995239, 719.9816131591797, 724.6202421188354, 729.2472410202026, 733.8742399215698, 738.4923965930939, 743.1105532646179, 747.7494435310364, 752.3883337974548, 757.0865607261658, 761.7847876548767, 766.4386820793152, 771.0925765037537, 775.7441828250885, 780.3957891464233, 785.0596625804901, 789.7235360145569, 794.4383795261383, 799.1532230377197, 803.8004050254822, 808.4475870132446, 813.1160066127777, 817.7844262123108, 822.4528493881226, 827.1212725639343, 831.7612190246582, 836.4011654853821, 841.1131775379181, 845.8251895904541, 851.9508635997772, 858.0765376091003, 862.9420168399811, 867.8074960708618, 872.4851274490356, 877.1627588272095, 884.8551819324493, 892.5476050376892, 897.2614824771881, 901.975359916687, 906.6447229385376, 911.3140859603882, 919.6429622173309, 927.9718384742737, 932.6449866294861, 937.3181347846985, 942.0750489234924, 946.8319630622864, 951.4899079799652, 956.147852897644, 958.6326127052307, 961.1173725128174]
[33.085, 33.085, 37.3125, 37.3125, 39.72, 39.72, 41.605, 41.605, 43.165, 43.165, 44.8925, 44.8925, 46.755, 46.755, 47.2925, 47.2925, 48.6275, 48.6275, 48.7675, 48.7675, 51.4, 51.4, 52.445, 52.445, 54.155, 54.155, 55.3425, 55.3425, 56.3575, 56.3575, 56.8025, 56.8025, 57.7225, 57.7225, 58.85, 58.85, 60.575, 60.575, 60.9625, 60.9625, 60.7675, 60.7675, 60.9025, 60.9025, 62.08, 62.08, 62.345, 62.345, 62.4875, 62.4875, 62.9775, 62.9775, 63.725, 63.725, 64.04, 64.04, 64.1075, 64.1075, 64.64, 64.64, 64.9425, 64.9425, 65.03, 65.03, 65.005, 65.005, 65.375, 65.375, 65.685, 65.685, 66.1725, 66.1725, 66.6625, 66.6625, 66.86, 66.86, 66.96, 66.96, 67.1825, 67.1825, 67.1925, 67.1925, 67.32, 67.32, 67.9275, 67.9275, 67.5325, 67.5325, 67.82, 67.82, 67.82, 67.82, 67.945, 67.945, 68.385, 68.385, 68.7475, 68.7475, 68.9825, 68.9825, 68.8575, 68.8575, 68.965, 68.965, 69.465, 69.465, 69.39, 69.39, 69.3875, 69.3875, 69.2325, 69.2325, 69.4275, 69.4275, 69.62, 69.62, 69.645, 69.645, 69.795, 69.795, 70.1275, 70.1275, 70.0, 70.0, 69.6475, 69.6475, 70.01, 70.01, 70.425, 70.425, 70.4775, 70.4775, 70.3725, 70.3725, 70.3525, 70.3525, 70.5975, 70.5975, 70.7025, 70.7025, 70.64, 70.64, 70.395, 70.395, 70.7675, 70.7675, 71.07, 71.07, 70.9325, 70.9325, 70.785, 70.785, 70.99, 70.99, 70.8825, 70.8825, 71.225, 71.225, 71.0725, 71.0725, 71.035, 71.035, 71.1725, 71.1725, 71.425, 71.425, 71.2575, 71.2575, 71.1125, 71.1125, 71.195, 71.195, 70.7325, 70.7325, 70.6, 70.6, 70.4775, 70.4775, 70.99, 70.99, 71.245, 71.245, 71.5325, 71.5325, 71.4925, 71.4925, 71.5, 71.5, 71.3575, 71.3575, 71.6225, 71.6225, 71.7625, 71.7625, 71.7875, 71.7875, 71.53, 71.53, 71.7925, 71.7925, 71.3825, 71.3825]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Co-teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.2000 
   Client 4, noise    level: 0.2000 
   Client 12, noise    level: 0.2000 
   Client 9, noise    level: 0.2000 
   Client 16, noise    level: 0.2000 
   Client 15, noise    level: 0.2000 
   Client 11, noise    level: 0.2000 
   Client 2, noise    level: 0.2000 
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.294, Test loss: 2.234, Test accuracy: 21.84
Round   1, Train loss: 2.229, Test loss: 2.093, Test accuracy: 29.50
Round   2, Train loss: 2.209, Test loss: 2.034, Test accuracy: 32.88
Round   3, Train loss: 2.157, Test loss: 1.989, Test accuracy: 35.19
Round   4, Train loss: 2.173, Test loss: 1.969, Test accuracy: 36.21
Round   5, Train loss: 2.131, Test loss: 1.925, Test accuracy: 38.19
Round   6, Train loss: 2.150, Test loss: 1.904, Test accuracy: 39.50
Round   7, Train loss: 2.091, Test loss: 1.902, Test accuracy: 40.90
Round   8, Train loss: 2.132, Test loss: 1.893, Test accuracy: 41.40
Round   9, Train loss: 2.057, Test loss: 1.850, Test accuracy: 43.05
Round  10, Train loss: 2.085, Test loss: 1.801, Test accuracy: 45.05
Round  11, Train loss: 2.103, Test loss: 1.859, Test accuracy: 44.14
Round  12, Train loss: 2.159, Test loss: 1.812, Test accuracy: 45.26
Round  13, Train loss: 2.096, Test loss: 1.791, Test accuracy: 46.13
Round  14, Train loss: 2.050, Test loss: 1.747, Test accuracy: 47.34
Round  15, Train loss: 2.147, Test loss: 1.766, Test accuracy: 48.03
Round  16, Train loss: 2.083, Test loss: 1.743, Test accuracy: 48.69
Round  17, Train loss: 2.056, Test loss: 1.728, Test accuracy: 49.68
Round  18, Train loss: 2.084, Test loss: 1.696, Test accuracy: 50.48
Round  19, Train loss: 2.005, Test loss: 1.708, Test accuracy: 50.95
Round  20, Train loss: 2.031, Test loss: 1.701, Test accuracy: 51.99
Round  21, Train loss: 1.993, Test loss: 1.670, Test accuracy: 52.80
Round  22, Train loss: 2.106, Test loss: 1.671, Test accuracy: 51.73
Round  23, Train loss: 2.100, Test loss: 1.692, Test accuracy: 52.15
Round  24, Train loss: 1.972, Test loss: 1.674, Test accuracy: 53.26
Round  25, Train loss: 2.024, Test loss: 1.651, Test accuracy: 54.00
Round  26, Train loss: 1.956, Test loss: 1.614, Test accuracy: 54.78
Round  27, Train loss: 2.027, Test loss: 1.617, Test accuracy: 55.16
Round  28, Train loss: 2.082, Test loss: 1.627, Test accuracy: 55.54
Round  29, Train loss: 1.886, Test loss: 1.610, Test accuracy: 56.40
Round  30, Train loss: 1.870, Test loss: 1.589, Test accuracy: 55.85
Round  31, Train loss: 1.985, Test loss: 1.601, Test accuracy: 55.74
Round  32, Train loss: 1.988, Test loss: 1.587, Test accuracy: 57.06
Round  33, Train loss: 1.930, Test loss: 1.577, Test accuracy: 57.60
Round  34, Train loss: 1.972, Test loss: 1.576, Test accuracy: 56.78
Round  35, Train loss: 2.002, Test loss: 1.578, Test accuracy: 57.38
Round  36, Train loss: 1.847, Test loss: 1.566, Test accuracy: 58.22
Round  37, Train loss: 1.960, Test loss: 1.562, Test accuracy: 57.59
Round  38, Train loss: 2.034, Test loss: 1.556, Test accuracy: 58.09
Round  39, Train loss: 1.905, Test loss: 1.539, Test accuracy: 58.01
Round  40, Train loss: 1.957, Test loss: 1.539, Test accuracy: 58.60
Round  41, Train loss: 1.809, Test loss: 1.541, Test accuracy: 58.37
Round  42, Train loss: 2.046, Test loss: 1.543, Test accuracy: 58.12
Round  43, Train loss: 1.967, Test loss: 1.529, Test accuracy: 58.64
Round  44, Train loss: 1.868, Test loss: 1.521, Test accuracy: 58.20
Round  45, Train loss: 1.943, Test loss: 1.520, Test accuracy: 58.45
Round  46, Train loss: 1.937, Test loss: 1.537, Test accuracy: 58.69
Round  47, Train loss: 1.858, Test loss: 1.548, Test accuracy: 58.20
Round  48, Train loss: 1.851, Test loss: 1.496, Test accuracy: 59.70
Round  49, Train loss: 2.007, Test loss: 1.523, Test accuracy: 58.10
Round  50, Train loss: 2.012, Test loss: 1.517, Test accuracy: 57.83
Round  51, Train loss: 1.909, Test loss: 1.512, Test accuracy: 58.15
Round  52, Train loss: 1.907, Test loss: 1.514, Test accuracy: 58.16
Round  53, Train loss: 1.974, Test loss: 1.538, Test accuracy: 57.32
Round  54, Train loss: 1.978, Test loss: 1.550, Test accuracy: 56.65
Round  55, Train loss: 1.817, Test loss: 1.513, Test accuracy: 58.27
Round  56, Train loss: 1.738, Test loss: 1.493, Test accuracy: 59.15
Round  57, Train loss: 1.922, Test loss: 1.483, Test accuracy: 59.02
Round  58, Train loss: 1.858, Test loss: 1.497, Test accuracy: 58.36
Round  59, Train loss: 1.977, Test loss: 1.500, Test accuracy: 58.28
Round  60, Train loss: 1.959, Test loss: 1.509, Test accuracy: 57.26
Round  61, Train loss: 1.956, Test loss: 1.517, Test accuracy: 57.16
Round  62, Train loss: 1.790, Test loss: 1.482, Test accuracy: 59.14
Round  63, Train loss: 1.786, Test loss: 1.473, Test accuracy: 58.94
Round  64, Train loss: 1.857, Test loss: 1.489, Test accuracy: 58.45
Round  65, Train loss: 1.959, Test loss: 1.528, Test accuracy: 56.08
Round  66, Train loss: 1.862, Test loss: 1.509, Test accuracy: 56.77
Round  67, Train loss: 1.769, Test loss: 1.461, Test accuracy: 58.84
Round  68, Train loss: 1.923, Test loss: 1.506, Test accuracy: 56.94
Round  69, Train loss: 1.855, Test loss: 1.491, Test accuracy: 57.77
Round  70, Train loss: 1.920, Test loss: 1.525, Test accuracy: 56.35
Round  71, Train loss: 1.833, Test loss: 1.479, Test accuracy: 57.22
Round  72, Train loss: 1.907, Test loss: 1.534, Test accuracy: 54.81
Round  73, Train loss: 1.812, Test loss: 1.501, Test accuracy: 56.79
Round  74, Train loss: 1.776, Test loss: 1.489, Test accuracy: 57.30
Round  75, Train loss: 1.821, Test loss: 1.500, Test accuracy: 56.29
Round  76, Train loss: 1.806, Test loss: 1.521, Test accuracy: 56.17
Round  77, Train loss: 1.752, Test loss: 1.524, Test accuracy: 55.60
Round  78, Train loss: 1.800, Test loss: 1.525, Test accuracy: 55.31
Round  79, Train loss: 1.784, Test loss: 1.509, Test accuracy: 56.00
Round  80, Train loss: 1.810, Test loss: 1.495, Test accuracy: 56.63
Round  81, Train loss: 1.819, Test loss: 1.493, Test accuracy: 55.93
Round  82, Train loss: 1.779, Test loss: 1.509, Test accuracy: 56.08
Round  83, Train loss: 1.702, Test loss: 1.490, Test accuracy: 56.81
Round  84, Train loss: 1.885, Test loss: 1.506, Test accuracy: 55.83
Round  85, Train loss: 1.871, Test loss: 1.509, Test accuracy: 55.17
Round  86, Train loss: 1.842, Test loss: 1.520, Test accuracy: 55.04
Round  87, Train loss: 1.761, Test loss: 1.508, Test accuracy: 55.39
Round  88, Train loss: 1.790, Test loss: 1.494, Test accuracy: 55.80
Round  89, Train loss: 1.768, Test loss: 1.516, Test accuracy: 54.77
Round  90, Train loss: 1.777, Test loss: 1.493, Test accuracy: 55.69
Round  91, Train loss: 1.809, Test loss: 1.516, Test accuracy: 54.84
Round  92, Train loss: 1.771, Test loss: 1.504, Test accuracy: 54.84
Round  93, Train loss: 1.736, Test loss: 1.516, Test accuracy: 54.48
Round  94, Train loss: 1.766, Test loss: 1.500, Test accuracy: 55.05
Round  95, Train loss: 1.619, Test loss: 1.485, Test accuracy: 55.62
Round  96, Train loss: 1.734, Test loss: 1.512, Test accuracy: 54.61
Round  97, Train loss: 1.822, Test loss: 1.546, Test accuracy: 53.37
Round  98, Train loss: 1.775, Test loss: 1.510, Test accuracy: 54.56
Round  99, Train loss: 1.649, Test loss: 1.502, Test accuracy: 54.91
Final Round, Train loss: 1.680, Test loss: 1.507, Test accuracy: 54.28
Average accuracy final 10 rounds: 54.79625
4436.162099599838
[5.802250385284424, 11.647013664245605, 17.330485820770264, 23.162804126739502, 29.047473430633545, 34.938701152801514, 40.799503564834595, 46.64472484588623, 52.50292706489563, 58.371196269989014, 64.2846155166626, 70.15733003616333, 76.08414125442505, 82.03913950920105, 87.93980836868286, 93.9016592502594, 99.80146217346191, 105.72923946380615, 111.5924870967865, 117.24967527389526, 122.56060266494751, 127.92036414146423, 133.23316478729248, 138.54781913757324, 143.82892107963562, 149.1837513446808, 154.52080178260803, 159.85886645317078, 165.2392189502716, 170.57305240631104, 175.92428040504456, 181.26620364189148, 186.55860996246338, 191.8599500656128, 197.1855330467224, 202.52448916435242, 207.8181188106537, 213.14795517921448, 218.4642243385315, 223.80280303955078, 229.12568736076355, 234.49554419517517, 239.780779838562, 245.11364006996155, 250.41693449020386, 255.7614769935608, 261.1374852657318, 266.4174220561981, 271.7434046268463, 277.14007925987244, 282.5070745944977, 287.8790171146393, 293.2930610179901, 298.63156151771545, 304.0122706890106, 309.3984456062317, 314.7852656841278, 320.1461410522461, 325.56689453125, 330.9602038860321, 336.35250186920166, 341.7481129169464, 347.0844192504883, 352.5506200790405, 357.9858796596527, 363.3875072002411, 368.80995774269104, 374.25775933265686, 379.58653140068054, 385.05535197257996, 390.4909613132477, 395.8660686016083, 401.2520830631256, 406.64163613319397, 412.0807638168335, 417.52010226249695, 422.9231562614441, 428.3355379104614, 433.79670906066895, 439.20034527778625, 444.6396486759186, 450.07836151123047, 455.40645265579224, 460.8558955192566, 466.3058841228485, 471.70669651031494, 477.0673158168793, 482.47765469551086, 487.8573479652405, 493.30415773391724, 498.7252264022827, 504.1283016204834, 509.4887728691101, 514.9239780902863, 520.3023016452789, 525.7360198497772, 531.1709821224213, 536.5658121109009, 541.9690518379211, 547.3981258869171, 549.5283102989197]
[21.84, 29.495, 32.88, 35.1875, 36.2125, 38.185, 39.4975, 40.8975, 41.4025, 43.0475, 45.045, 44.1375, 45.2625, 46.13, 47.3375, 48.03, 48.685, 49.6775, 50.4825, 50.955, 51.99, 52.795, 51.725, 52.1475, 53.26, 53.9975, 54.7775, 55.1575, 55.5375, 56.3975, 55.8525, 55.7375, 57.0575, 57.6, 56.7825, 57.3825, 58.22, 57.59, 58.09, 58.005, 58.5975, 58.3675, 58.115, 58.64, 58.2025, 58.45, 58.6925, 58.2, 59.6975, 58.1025, 57.8325, 58.15, 58.1575, 57.32, 56.6475, 58.2675, 59.1475, 59.025, 58.3575, 58.2825, 57.255, 57.165, 59.1375, 58.9425, 58.455, 56.08, 56.7725, 58.8425, 56.9375, 57.7675, 56.3475, 57.22, 54.8125, 56.79, 57.3025, 56.2875, 56.17, 55.5975, 55.315, 55.9975, 56.635, 55.9325, 56.0775, 56.815, 55.8325, 55.1675, 55.04, 55.3875, 55.8, 54.775, 55.685, 54.84, 54.8425, 54.4775, 55.05, 55.615, 54.6125, 53.365, 54.5625, 54.9125, 54.2825]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 13, noise    level: 0.2000 
   Client 18, noise    level: 0.2000 
   Client 10, noise    level: 0.2000 
   Client 0, noise    level: 0.2000 
   Client 14, noise    level: 0.2000 
   Client 9, noise    level: 0.2000 
   Client 5, noise    level: 0.2000 
   Client 12, noise    level: 0.2000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  28.1800
Round 1 global test acc  40.7700
Round 2 global test acc  44.0100
Round 3 global test acc  48.8300
Round 4 global test acc  50.5300
Round 5 global test acc  52.3100
Round 6 global test acc  52.5100
Round 7 global test acc  53.2500
Round 8 global test acc  55.3100
Round 9 global test acc  56.1100
Round 10 global test acc  56.2000
Round 11 global test acc  56.7000
Round 12 global test acc  57.5000
Round 13 global test acc  57.9400
Round 14 global test acc  58.3600
Round 15 global test acc  57.6200
Round 16 global test acc  57.9600
Round 17 global test acc  59.6200
Round 18 global test acc  60.4000
Round 19 global test acc  59.8300
Round 20 global test acc  59.3800
Round 21 global test acc  59.6400
Round 22 global test acc  60.0300
Round 23 global test acc  60.9400
Round 24 global test acc  61.6300
Round 25 global test acc  61.4100
Round 26 global test acc  62.0800
Round 27 global test acc  61.7400
Round 28 global test acc  62.8100
Round 29 global test acc  62.9100
Round 30 global test acc  62.3900
Round 31 global test acc  63.1400
Round 32 global test acc  63.1900
Round 33 global test acc  63.4400
Round 34 global test acc  63.7500
Round 35 global test acc  63.5700
Round 36 global test acc  64.3500
Round 37 global test acc  62.9300
Round 38 global test acc  63.6300
Round 39 global test acc  63.2200
Round 40 global test acc  64.4300
Round 41 global test acc  64.7200
Round 42 global test acc  64.2400
Round 43 global test acc  64.9700
Round 44 global test acc  65.3400
Round 45 global test acc  65.1900
Round 46 global test acc  64.6600
Round 47 global test acc  65.1700
Round 48 global test acc  64.9100
Round 49 global test acc  65.8000
Round 50 global test acc  65.5700
Round 51 global test acc  65.6000
Round 52 global test acc  66.5000
Round 53 global test acc  65.4800
Round 54 global test acc  65.9000
Round 55 global test acc  65.3900
Round 56 global test acc  65.5900
Round 57 global test acc  64.3300
Round 58 global test acc  66.8500
Round 59 global test acc  66.8000
Round 60 global test acc  66.7400
Round 61 global test acc  66.2200
Round 62 global test acc  66.2300
Round 63 global test acc  66.0400
Round 64 global test acc  66.0700
Round 65 global test acc  66.2700
Round 66 global test acc  66.9900
Round 67 global test acc  66.8500
Round 68 global test acc  67.3900
Round 69 global test acc  66.5300
Round 70 global test acc  66.8600
Round 71 global test acc  66.9200
Round 72 global test acc  67.0900
Round 73 global test acc  67.4800
Round 74 global test acc  66.9600
Round 75 global test acc  67.5200
Round 76 global test acc  67.4100
Round 77 global test acc  67.5100
Round 78 global test acc  67.5000
Round 79 global test acc  67.5100
Round 80 global test acc  67.0100
Round 81 global test acc  64.9200
Round 82 global test acc  62.4100
Round 83 global test acc  62.3000
Round 84 global test acc  61.9600
Round 85 global test acc  61.3900
Round 86 global test acc  60.1200
Round 87 global test acc  59.7900
Round 88 global test acc  58.6700
Round 89 global test acc  59.0400
Round 90 global test acc  58.8900
Round 91 global test acc  58.5000
Round 92 global test acc  58.1400
Round 93 global test acc  58.2500
Round 94 global test acc  57.9300
Round 95 global test acc  57.7400
Round 96 global test acc  57.0400
Round 97 global test acc  56.8500
Round 98 global test acc  56.6700
Round 99 global test acc  56.1100
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.2000 
   Client 9, noise    level: 0.2000 
   Client 10, noise    level: 0.2000 
   Client 1, noise    level: 0.2000 
   Client 16, noise    level: 0.2000 
   Client 18, noise    level: 0.2000 
   Client 5, noise    level: 0.2000 
   Client 6, noise    level: 0.2000 
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.596, Test loss: 2.044, Test accuracy: 19.26
Round   1, Train loss: 1.169, Test loss: 1.776, Test accuracy: 32.65
Round   2, Train loss: 1.063, Test loss: 1.656, Test accuracy: 40.62
Round   3, Train loss: 0.990, Test loss: 1.336, Test accuracy: 53.60
Round   4, Train loss: 1.064, Test loss: 1.115, Test accuracy: 59.13
Round   5, Train loss: 1.022, Test loss: 1.183, Test accuracy: 57.28
Round   6, Train loss: 0.874, Test loss: 1.154, Test accuracy: 59.08
Round   7, Train loss: 0.852, Test loss: 0.942, Test accuracy: 67.42
Round   8, Train loss: 0.743, Test loss: 0.855, Test accuracy: 69.23
Round   9, Train loss: 0.979, Test loss: 0.703, Test accuracy: 73.91
Round  10, Train loss: 0.829, Test loss: 0.685, Test accuracy: 74.21
Round  11, Train loss: 0.769, Test loss: 0.657, Test accuracy: 75.58
Round  12, Train loss: 0.903, Test loss: 0.688, Test accuracy: 75.48
Round  13, Train loss: 0.813, Test loss: 0.674, Test accuracy: 76.20
Round  14, Train loss: 0.789, Test loss: 0.654, Test accuracy: 76.68
Round  15, Train loss: 0.864, Test loss: 0.641, Test accuracy: 77.61
Round  16, Train loss: 0.864, Test loss: 0.614, Test accuracy: 77.90
Round  17, Train loss: 0.806, Test loss: 0.582, Test accuracy: 78.88
Round  18, Train loss: 0.700, Test loss: 0.609, Test accuracy: 78.43
Round  19, Train loss: 0.654, Test loss: 0.582, Test accuracy: 78.84
Round  20, Train loss: 0.800, Test loss: 0.591, Test accuracy: 79.67
Round  21, Train loss: 0.796, Test loss: 0.575, Test accuracy: 80.35
Round  22, Train loss: 0.693, Test loss: 0.575, Test accuracy: 80.13
Round  23, Train loss: 0.594, Test loss: 0.578, Test accuracy: 80.62
Round  24, Train loss: 0.703, Test loss: 0.574, Test accuracy: 79.82
Round  25, Train loss: 0.833, Test loss: 0.542, Test accuracy: 81.01
Round  26, Train loss: 0.771, Test loss: 0.544, Test accuracy: 80.88
Round  27, Train loss: 0.653, Test loss: 0.526, Test accuracy: 81.10
Round  28, Train loss: 0.457, Test loss: 0.515, Test accuracy: 81.47
Round  29, Train loss: 0.757, Test loss: 0.523, Test accuracy: 81.74
Round  30, Train loss: 0.656, Test loss: 0.523, Test accuracy: 81.35
Round  31, Train loss: 0.667, Test loss: 0.533, Test accuracy: 81.34
Round  32, Train loss: 0.703, Test loss: 0.517, Test accuracy: 81.91
Round  33, Train loss: 0.643, Test loss: 0.527, Test accuracy: 81.80
Round  34, Train loss: 0.451, Test loss: 0.516, Test accuracy: 82.16
Round  35, Train loss: 0.655, Test loss: 0.517, Test accuracy: 82.28
Round  36, Train loss: 0.595, Test loss: 0.507, Test accuracy: 82.25
Round  37, Train loss: 0.573, Test loss: 0.490, Test accuracy: 83.23
Round  38, Train loss: 0.474, Test loss: 0.504, Test accuracy: 82.98
Round  39, Train loss: 0.612, Test loss: 0.494, Test accuracy: 82.91
Round  40, Train loss: 0.534, Test loss: 0.492, Test accuracy: 83.31
Round  41, Train loss: 0.695, Test loss: 0.473, Test accuracy: 83.81
Round  42, Train loss: 0.447, Test loss: 0.486, Test accuracy: 83.71
Round  43, Train loss: 0.456, Test loss: 0.475, Test accuracy: 83.74
Round  44, Train loss: 0.625, Test loss: 0.484, Test accuracy: 83.26
Round  45, Train loss: 0.530, Test loss: 0.468, Test accuracy: 83.84
Round  46, Train loss: 0.701, Test loss: 0.473, Test accuracy: 83.81
Round  47, Train loss: 0.648, Test loss: 0.467, Test accuracy: 84.22
Round  48, Train loss: 0.571, Test loss: 0.475, Test accuracy: 83.87
Round  49, Train loss: 0.761, Test loss: 0.466, Test accuracy: 83.81
Round  50, Train loss: 0.645, Test loss: 0.453, Test accuracy: 84.53
Round  51, Train loss: 0.479, Test loss: 0.453, Test accuracy: 84.75
Round  52, Train loss: 0.469, Test loss: 0.451, Test accuracy: 84.58
Round  53, Train loss: 0.728, Test loss: 0.454, Test accuracy: 84.67
Round  54, Train loss: 0.603, Test loss: 0.460, Test accuracy: 84.45
Round  55, Train loss: 0.677, Test loss: 0.456, Test accuracy: 84.50
Round  56, Train loss: 0.650, Test loss: 0.452, Test accuracy: 84.46
Round  57, Train loss: 0.528, Test loss: 0.448, Test accuracy: 84.41
Round  58, Train loss: 0.463, Test loss: 0.459, Test accuracy: 84.30
Round  59, Train loss: 0.583, Test loss: 0.446, Test accuracy: 84.89
Round  60, Train loss: 0.537, Test loss: 0.451, Test accuracy: 84.68
Round  61, Train loss: 0.572, Test loss: 0.447, Test accuracy: 84.59
Round  62, Train loss: 0.465, Test loss: 0.436, Test accuracy: 84.52
Round  63, Train loss: 0.691, Test loss: 0.448, Test accuracy: 85.12
Round  64, Train loss: 0.488, Test loss: 0.447, Test accuracy: 84.97
Round  65, Train loss: 0.568, Test loss: 0.444, Test accuracy: 85.34
Round  66, Train loss: 0.451, Test loss: 0.445, Test accuracy: 85.16
Round  67, Train loss: 0.535, Test loss: 0.448, Test accuracy: 84.67
Round  68, Train loss: 0.493, Test loss: 0.453, Test accuracy: 84.60
Round  69, Train loss: 0.451, Test loss: 0.441, Test accuracy: 84.93
Round  70, Train loss: 0.593, Test loss: 0.445, Test accuracy: 85.22
Round  71, Train loss: 0.488, Test loss: 0.443, Test accuracy: 85.31
Round  72, Train loss: 0.472, Test loss: 0.440, Test accuracy: 85.19
Round  73, Train loss: 0.443, Test loss: 0.440, Test accuracy: 85.01
Round  74, Train loss: 0.508, Test loss: 0.434, Test accuracy: 85.51
Round  75, Train loss: 0.371, Test loss: 0.427, Test accuracy: 85.64
Round  76, Train loss: 0.345, Test loss: 0.428, Test accuracy: 85.60
Round  77, Train loss: 0.537, Test loss: 0.433, Test accuracy: 85.48
Round  78, Train loss: 0.366, Test loss: 0.433, Test accuracy: 85.58
Round  79, Train loss: 0.408, Test loss: 0.430, Test accuracy: 85.62
Round  80, Train loss: 0.479, Test loss: 0.443, Test accuracy: 85.58
Round  81, Train loss: 0.580, Test loss: 0.442, Test accuracy: 85.51
Round  82, Train loss: 0.650, Test loss: 0.432, Test accuracy: 85.80
Round  83, Train loss: 0.355, Test loss: 0.425, Test accuracy: 86.03
Round  84, Train loss: 0.642, Test loss: 0.436, Test accuracy: 85.78
Round  85, Train loss: 0.494, Test loss: 0.428, Test accuracy: 85.77
Round  86, Train loss: 0.520, Test loss: 0.421, Test accuracy: 85.58
Round  87, Train loss: 0.389, Test loss: 0.431, Test accuracy: 85.47
Round  88, Train loss: 0.294, Test loss: 0.433, Test accuracy: 85.88
Round  89, Train loss: 0.505, Test loss: 0.440, Test accuracy: 85.37
Round  90, Train loss: 0.565, Test loss: 0.438, Test accuracy: 85.71
Round  91, Train loss: 0.366, Test loss: 0.436, Test accuracy: 85.47
Round  92, Train loss: 0.477, Test loss: 0.441, Test accuracy: 85.80
Round  93, Train loss: 0.498, Test loss: 0.433, Test accuracy: 86.15
Round  94, Train loss: 0.406, Test loss: 0.440, Test accuracy: 85.63
Round  95, Train loss: 0.410, Test loss: 0.433, Test accuracy: 85.65
Round  96, Train loss: 0.463, Test loss: 0.438, Test accuracy: 85.51
Round  97, Train loss: 0.368, Test loss: 0.435, Test accuracy: 85.78
Round  98, Train loss: 0.575, Test loss: 0.447, Test accuracy: 85.63
Round  99, Train loss: 0.320, Test loss: 0.425, Test accuracy: 85.85
Final Round, Train loss: 0.408, Test loss: 0.428, Test accuracy: 85.83
Average accuracy final 10 rounds: 85.71833333333332
1372.7591753005981
[1.876283884048462, 3.559537410736084, 5.167572259902954, 6.735651731491089, 8.356291770935059, 10.023777484893799, 11.6906578540802, 13.432876825332642, 15.151740550994873, 16.9034366607666, 18.746623992919922, 20.510095357894897, 22.23623275756836, 24.007110357284546, 25.736161708831787, 27.44766354560852, 29.18763494491577, 30.920796394348145, 32.65575075149536, 34.389233112335205, 36.09794068336487, 37.82756161689758, 39.57984232902527, 41.33559513092041, 43.11470913887024, 44.904396533966064, 46.59748029708862, 48.28904628753662, 50.03616762161255, 51.779975175857544, 53.5930700302124, 55.3256573677063, 57.020426988601685, 58.659465074539185, 60.31018543243408, 61.884363889694214, 63.54040837287903, 65.11823773384094, 66.66194462776184, 68.33436107635498, 70.01123046875, 71.6421766281128, 73.209219455719, 74.81631660461426, 76.3726270198822, 77.93407368659973, 79.50883460044861, 81.08282256126404, 82.65550088882446, 84.2497308254242, 85.81175112724304, 87.42819690704346, 89.10161519050598, 90.78146386146545, 92.50413942337036, 94.1677496433258, 95.81389379501343, 97.47375464439392, 99.12447166442871, 100.78570508956909, 102.43020391464233, 104.07606959342957, 105.7092878818512, 107.37797522544861, 109.11847972869873, 110.75831747055054, 112.4275119304657, 114.2258050441742, 115.88145565986633, 117.5304388999939, 119.25145125389099, 120.9007318019867, 122.61741805076599, 124.27077102661133, 125.9098801612854, 127.57512402534485, 129.31347584724426, 130.96730256080627, 132.68904614448547, 134.36436653137207, 136.0040304660797, 137.75101780891418, 139.52348613739014, 141.2207486629486, 142.86659955978394, 144.50696992874146, 146.2476749420166, 147.9763262271881, 149.6953480243683, 151.4570255279541, 153.18237781524658, 154.91290640830994, 156.55791068077087, 158.23214745521545, 159.9507191181183, 161.61802577972412, 163.26420187950134, 164.9316601753235, 166.62792801856995, 168.31211829185486, 170.60550785064697]
[19.258333333333333, 32.65, 40.61666666666667, 53.6, 59.13333333333333, 57.28333333333333, 59.083333333333336, 67.41666666666667, 69.23333333333333, 73.90833333333333, 74.20833333333333, 75.575, 75.48333333333333, 76.2, 76.68333333333334, 77.60833333333333, 77.9, 78.88333333333334, 78.43333333333334, 78.84166666666667, 79.675, 80.35, 80.13333333333334, 80.625, 79.81666666666666, 81.00833333333334, 80.88333333333334, 81.1, 81.475, 81.74166666666666, 81.35, 81.34166666666667, 81.90833333333333, 81.8, 82.15833333333333, 82.275, 82.25, 83.23333333333333, 82.98333333333333, 82.90833333333333, 83.30833333333334, 83.80833333333334, 83.70833333333333, 83.74166666666666, 83.25833333333334, 83.84166666666667, 83.80833333333334, 84.225, 83.86666666666666, 83.80833333333334, 84.525, 84.75, 84.575, 84.675, 84.45, 84.5, 84.45833333333333, 84.40833333333333, 84.3, 84.89166666666667, 84.68333333333334, 84.59166666666667, 84.51666666666667, 85.125, 84.975, 85.34166666666667, 85.15833333333333, 84.675, 84.6, 84.93333333333334, 85.21666666666667, 85.30833333333334, 85.19166666666666, 85.00833333333334, 85.50833333333334, 85.64166666666667, 85.6, 85.48333333333333, 85.58333333333333, 85.61666666666666, 85.575, 85.50833333333334, 85.8, 86.03333333333333, 85.775, 85.76666666666667, 85.58333333333333, 85.46666666666667, 85.875, 85.36666666666666, 85.70833333333333, 85.46666666666667, 85.8, 86.15, 85.63333333333334, 85.65, 85.50833333333334, 85.78333333333333, 85.63333333333334, 85.85, 85.83333333333333]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.2  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.2000 
   Client 7, noise    level: 0.2000 
   Client 9, noise    level: 0.2000 
   Client 1, noise    level: 0.2000 
   Client 5, noise    level: 0.2000 
   Client 12, noise    level: 0.2000 
   Client 4, noise    level: 0.2000 
   Client 8, noise    level: 0.2000 
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.221, Test loss: 1.947, Test accuracy: 31.66
Round   1, Train loss: 1.886, Test loss: 1.657, Test accuracy: 40.43
Round   2, Train loss: 1.681, Test loss: 1.516, Test accuracy: 45.92
Round   3, Train loss: 1.568, Test loss: 1.437, Test accuracy: 49.50
Round   4, Train loss: 1.499, Test loss: 1.366, Test accuracy: 52.49
Round   5, Train loss: 1.429, Test loss: 1.302, Test accuracy: 54.16
Round   6, Train loss: 1.351, Test loss: 1.254, Test accuracy: 57.27
Round   7, Train loss: 1.286, Test loss: 1.239, Test accuracy: 58.14
Round   8, Train loss: 1.260, Test loss: 1.171, Test accuracy: 59.98
Round   9, Train loss: 1.206, Test loss: 1.138, Test accuracy: 61.20
Round  10, Train loss: 1.188, Test loss: 1.078, Test accuracy: 62.84
Round  11, Train loss: 1.146, Test loss: 1.060, Test accuracy: 63.80
Round  12, Train loss: 1.121, Test loss: 1.008, Test accuracy: 65.02
Round  13, Train loss: 1.066, Test loss: 1.003, Test accuracy: 65.70
Round  14, Train loss: 1.053, Test loss: 0.984, Test accuracy: 65.94
Round  15, Train loss: 1.027, Test loss: 0.960, Test accuracy: 67.33
Round  16, Train loss: 1.001, Test loss: 0.937, Test accuracy: 67.90
Round  17, Train loss: 0.990, Test loss: 0.915, Test accuracy: 68.68
Round  18, Train loss: 0.992, Test loss: 0.896, Test accuracy: 69.10
Round  19, Train loss: 0.933, Test loss: 0.887, Test accuracy: 69.66
Round  20, Train loss: 0.908, Test loss: 0.890, Test accuracy: 70.07
Round  21, Train loss: 0.908, Test loss: 0.885, Test accuracy: 69.75
Round  22, Train loss: 0.924, Test loss: 0.865, Test accuracy: 70.72
Round  23, Train loss: 0.880, Test loss: 0.846, Test accuracy: 70.72
Round  24, Train loss: 0.865, Test loss: 0.846, Test accuracy: 70.95
Round  25, Train loss: 0.856, Test loss: 0.830, Test accuracy: 71.75
Round  26, Train loss: 0.852, Test loss: 0.821, Test accuracy: 71.94
Round  27, Train loss: 0.831, Test loss: 0.821, Test accuracy: 71.70
Round  28, Train loss: 0.810, Test loss: 0.818, Test accuracy: 71.83
Round  29, Train loss: 0.802, Test loss: 0.803, Test accuracy: 72.01
Round  30, Train loss: 0.785, Test loss: 0.801, Test accuracy: 72.36
Round  31, Train loss: 0.791, Test loss: 0.784, Test accuracy: 73.10
Round  32, Train loss: 0.779, Test loss: 0.779, Test accuracy: 73.38
Round  33, Train loss: 0.769, Test loss: 0.778, Test accuracy: 73.56
Round  34, Train loss: 0.731, Test loss: 0.766, Test accuracy: 73.64
Round  35, Train loss: 0.760, Test loss: 0.767, Test accuracy: 73.33
Round  36, Train loss: 0.718, Test loss: 0.766, Test accuracy: 73.72
Round  37, Train loss: 0.718, Test loss: 0.762, Test accuracy: 74.06
Round  38, Train loss: 0.722, Test loss: 0.756, Test accuracy: 74.05
Round  39, Train loss: 0.702, Test loss: 0.753, Test accuracy: 73.86
Round  40, Train loss: 0.709, Test loss: 0.759, Test accuracy: 74.07
Round  41, Train loss: 0.694, Test loss: 0.752, Test accuracy: 74.27
Round  42, Train loss: 0.690, Test loss: 0.739, Test accuracy: 74.57
Round  43, Train loss: 0.675, Test loss: 0.745, Test accuracy: 74.43
Round  44, Train loss: 0.680, Test loss: 0.732, Test accuracy: 75.09
Round  45, Train loss: 0.667, Test loss: 0.741, Test accuracy: 74.69
Round  46, Train loss: 0.667, Test loss: 0.729, Test accuracy: 75.14
Round  47, Train loss: 0.644, Test loss: 0.736, Test accuracy: 74.75
Round  48, Train loss: 0.662, Test loss: 0.734, Test accuracy: 74.69
Round  49, Train loss: 0.639, Test loss: 0.728, Test accuracy: 75.03
Round  50, Train loss: 0.656, Test loss: 0.729, Test accuracy: 75.02
Round  51, Train loss: 0.636, Test loss: 0.730, Test accuracy: 75.19
Round  52, Train loss: 0.643, Test loss: 0.726, Test accuracy: 75.39
Round  53, Train loss: 0.614, Test loss: 0.731, Test accuracy: 75.17
Round  54, Train loss: 0.634, Test loss: 0.722, Test accuracy: 75.69
Round  55, Train loss: 0.634, Test loss: 0.703, Test accuracy: 76.32
Round  56, Train loss: 0.594, Test loss: 0.716, Test accuracy: 75.83
Round  57, Train loss: 0.635, Test loss: 0.701, Test accuracy: 76.33
Round  58, Train loss: 0.615, Test loss: 0.706, Test accuracy: 76.39
Round  59, Train loss: 0.602, Test loss: 0.705, Test accuracy: 76.09
Round  60, Train loss: 0.615, Test loss: 0.706, Test accuracy: 76.46
Round  61, Train loss: 0.604, Test loss: 0.717, Test accuracy: 76.26
Round  62, Train loss: 0.607, Test loss: 0.728, Test accuracy: 75.51
Round  63, Train loss: 0.591, Test loss: 0.726, Test accuracy: 75.90
Round  64, Train loss: 0.590, Test loss: 0.721, Test accuracy: 76.04
Round  65, Train loss: 0.593, Test loss: 0.709, Test accuracy: 76.31
Round  66, Train loss: 0.583, Test loss: 0.716, Test accuracy: 76.18
Round  67, Train loss: 0.584, Test loss: 0.711, Test accuracy: 76.39
Round  68, Train loss: 0.580, Test loss: 0.706, Test accuracy: 76.34
Round  69, Train loss: 0.584, Test loss: 0.705, Test accuracy: 76.64
Round  70, Train loss: 0.563, Test loss: 0.698, Test accuracy: 77.01
Round  71, Train loss: 0.573, Test loss: 0.702, Test accuracy: 76.92
Round  72, Train loss: 0.538, Test loss: 0.706, Test accuracy: 76.50
Round  73, Train loss: 0.548, Test loss: 0.708, Test accuracy: 76.30
Round  74, Train loss: 0.546, Test loss: 0.700, Test accuracy: 76.69
Round  75, Train loss: 0.557, Test loss: 0.704, Test accuracy: 76.47
Round  76, Train loss: 0.556, Test loss: 0.689, Test accuracy: 77.08
Round  77, Train loss: 0.516, Test loss: 0.702, Test accuracy: 76.78
Round  78, Train loss: 0.537, Test loss: 0.706, Test accuracy: 76.64
Round  79, Train loss: 0.525, Test loss: 0.702, Test accuracy: 76.62
Round  80, Train loss: 0.552, Test loss: 0.704, Test accuracy: 76.78
Round  81, Train loss: 0.522, Test loss: 0.695, Test accuracy: 76.97
Round  82, Train loss: 0.545, Test loss: 0.692, Test accuracy: 77.07
Round  83, Train loss: 0.519, Test loss: 0.703, Test accuracy: 76.72
Round  84, Train loss: 0.529, Test loss: 0.699, Test accuracy: 76.73
Round  85, Train loss: 0.543, Test loss: 0.697, Test accuracy: 76.70
Round  86, Train loss: 0.532, Test loss: 0.697, Test accuracy: 76.77
Round  87, Train loss: 0.515, Test loss: 0.697, Test accuracy: 76.88
Round  88, Train loss: 0.512, Test loss: 0.695, Test accuracy: 77.04
Round  89, Train loss: 0.493, Test loss: 0.698, Test accuracy: 77.05
Round  90, Train loss: 0.498, Test loss: 0.705, Test accuracy: 76.72
Round  91, Train loss: 0.536, Test loss: 0.710, Test accuracy: 76.89
Round  92, Train loss: 0.519, Test loss: 0.706, Test accuracy: 76.58
Round  93, Train loss: 0.482, Test loss: 0.708, Test accuracy: 76.75
Round  94, Train loss: 0.510, Test loss: 0.716, Test accuracy: 76.37
Round  95, Train loss: 0.512, Test loss: 0.710, Test accuracy: 76.89
Round  96, Train loss: 0.505, Test loss: 0.702, Test accuracy: 76.87
Round  97, Train loss: 0.483, Test loss: 0.708, Test accuracy: 76.90
Round  98, Train loss: 0.501, Test loss: 0.707, Test accuracy: 77.03
Round  99, Train loss: 0.485, Test loss: 0.711, Test accuracy: 76.95
Final Round, Train loss: 0.416, Test loss: 0.703, Test accuracy: 77.23
Average accuracy final 10 rounds: 76.7965
7745.1657593250275
[5.999207019805908, 11.940735578536987, 17.769193649291992, 23.58318591117859, 29.566211462020874, 35.45931673049927, 41.55918312072754, 47.20443105697632, 52.862289905548096, 58.468475103378296, 63.93840956687927, 69.50311994552612, 74.90718841552734, 80.22791314125061, 85.81281852722168, 91.21741652488708, 96.52974510192871, 101.82709813117981, 107.1568922996521, 112.43710827827454, 117.807852268219, 131.0481264591217, 144.14651823043823, 157.37805366516113, 170.29576683044434, 183.10838508605957, 196.99388003349304, 210.62889122962952, 224.13104605674744, 238.03289675712585, 251.97375965118408, 265.5935146808624, 279.1133015155792, 292.64004778862, 306.12768363952637, 319.65827441215515, 332.91951036453247, 346.30732822418213, 359.7770140171051, 373.0373532772064, 386.43918681144714, 399.79687452316284, 413.17578196525574, 426.741366147995, 439.9690523147583, 453.79411458969116, 467.55265617370605, 481.0707302093506, 494.9154131412506, 508.7599925994873, 522.4080610275269, 535.7339544296265, 549.3758087158203, 563.2190763950348, 576.5766003131866, 590.45609998703, 603.6303260326385, 617.2525627613068, 631.328412771225, 645.0715565681458, 658.7291841506958, 672.4648234844208, 685.9913365840912, 699.608818769455, 712.789274930954, 726.4039721488953, 738.6094119548798, 750.7542626857758, 762.8388736248016, 775.1729989051819, 787.5032045841217, 799.8614709377289, 812.1901757717133, 824.2529883384705, 836.6583578586578, 849.1510603427887, 861.5533423423767, 873.78573179245, 886.2777149677277, 898.7062065601349, 911.2967538833618, 923.4896667003632, 935.8349645137787, 948.330796957016, 960.5371165275574, 972.9214997291565, 984.9637339115143, 996.4807341098785, 1008.1474239826202, 1019.5668110847473, 1031.3801386356354, 1043.103593826294, 1054.5128798484802, 1066.3042464256287, 1077.666687488556, 1089.3723759651184, 1101.1446981430054, 1112.8144578933716, 1124.3460612297058, 1135.897539138794, 1137.946801662445]
[31.665, 40.43, 45.9225, 49.4975, 52.4875, 54.16, 57.275, 58.14, 59.9825, 61.195, 62.845, 63.7975, 65.0225, 65.6975, 65.945, 67.3275, 67.9025, 68.6825, 69.1025, 69.66, 70.0725, 69.75, 70.715, 70.725, 70.9475, 71.7475, 71.9425, 71.7, 71.83, 72.0075, 72.365, 73.1025, 73.375, 73.5625, 73.6425, 73.3325, 73.715, 74.0575, 74.0525, 73.8625, 74.0675, 74.2725, 74.5725, 74.4325, 75.095, 74.685, 75.145, 74.7475, 74.69, 75.035, 75.015, 75.1875, 75.385, 75.1675, 75.69, 76.32, 75.835, 76.3275, 76.39, 76.0875, 76.4575, 76.2625, 75.5075, 75.9025, 76.0425, 76.315, 76.18, 76.3925, 76.345, 76.6375, 77.0075, 76.92, 76.495, 76.3, 76.695, 76.465, 77.085, 76.775, 76.635, 76.6225, 76.785, 76.9725, 77.07, 76.725, 76.735, 76.6975, 76.765, 76.8775, 77.0425, 77.0525, 76.72, 76.8925, 76.5825, 76.75, 76.3725, 76.89, 76.8725, 76.9025, 77.035, 76.9475, 77.2325]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.5  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.5000 
   Client 13, noise    level: 0.5000 
   Client 16, noise    level: 0.5000 
   Client 6, noise    level: 0.5000 
   Client 7, noise    level: 0.5000 
   Client 4, noise    level: 0.5000 
   Client 0, noise    level: 0.5000 
   Client 10, noise    level: 0.5000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.156, Test loss: 2.013, Test accuracy: 29.94
Round   0, Global train loss: 2.156, Global test loss: 2.009, Global test accuracy: 30.99
Round   1, Train loss: 1.960, Test loss: 1.810, Test accuracy: 36.66
Round   1, Global train loss: 1.960, Global test loss: 1.699, Global test accuracy: 42.20
Round   2, Train loss: 1.904, Test loss: 1.781, Test accuracy: 38.18
Round   2, Global train loss: 1.904, Global test loss: 1.640, Global test accuracy: 46.59
Round   3, Train loss: 1.862, Test loss: 1.766, Test accuracy: 39.57
Round   3, Global train loss: 1.862, Global test loss: 1.695, Global test accuracy: 47.20
Round   4, Train loss: 2.085, Test loss: 1.778, Test accuracy: 39.84
Round   4, Global train loss: 2.085, Global test loss: 1.937, Global test accuracy: 43.05
Round   5, Train loss: 1.906, Test loss: 1.721, Test accuracy: 41.41
Round   5, Global train loss: 1.906, Global test loss: 1.679, Global test accuracy: 48.53
Round   6, Train loss: 1.775, Test loss: 1.692, Test accuracy: 42.51
Round   6, Global train loss: 1.775, Global test loss: 1.547, Global test accuracy: 52.14
Round   7, Train loss: 1.676, Test loss: 1.677, Test accuracy: 42.79
Round   7, Global train loss: 1.676, Global test loss: 1.510, Global test accuracy: 52.49
Round   8, Train loss: 1.594, Test loss: 1.674, Test accuracy: 42.69
Round   8, Global train loss: 1.594, Global test loss: 1.439, Global test accuracy: 53.95
Round   9, Train loss: 1.636, Test loss: 1.667, Test accuracy: 43.33
Round   9, Global train loss: 1.636, Global test loss: 1.430, Global test accuracy: 54.03
Round  10, Train loss: 1.518, Test loss: 1.644, Test accuracy: 44.10
Round  10, Global train loss: 1.518, Global test loss: 1.363, Global test accuracy: 56.13
Round  11, Train loss: 1.431, Test loss: 1.621, Test accuracy: 45.14
Round  11, Global train loss: 1.431, Global test loss: 1.375, Global test accuracy: 55.69
Round  12, Train loss: 1.368, Test loss: 1.619, Test accuracy: 45.27
Round  12, Global train loss: 1.368, Global test loss: 1.327, Global test accuracy: 55.62
Round  13, Train loss: 1.793, Test loss: 1.644, Test accuracy: 45.03
Round  13, Global train loss: 1.793, Global test loss: 1.714, Global test accuracy: 50.60
Round  14, Train loss: 1.595, Test loss: 1.653, Test accuracy: 44.88
Round  14, Global train loss: 1.595, Global test loss: 1.605, Global test accuracy: 50.45
Round  15, Train loss: 1.531, Test loss: 1.637, Test accuracy: 45.33
Round  15, Global train loss: 1.531, Global test loss: 1.518, Global test accuracy: 53.10
Round  16, Train loss: 1.440, Test loss: 1.648, Test accuracy: 45.27
Round  16, Global train loss: 1.440, Global test loss: 1.472, Global test accuracy: 53.77
Round  17, Train loss: 1.330, Test loss: 1.670, Test accuracy: 44.69
Round  17, Global train loss: 1.330, Global test loss: 1.424, Global test accuracy: 54.80
Round  18, Train loss: 1.142, Test loss: 1.683, Test accuracy: 44.94
Round  18, Global train loss: 1.142, Global test loss: 1.287, Global test accuracy: 56.50
Round  19, Train loss: 1.454, Test loss: 1.681, Test accuracy: 45.12
Round  19, Global train loss: 1.454, Global test loss: 1.458, Global test accuracy: 54.18
Round  20, Train loss: 1.242, Test loss: 1.675, Test accuracy: 45.43
Round  20, Global train loss: 1.242, Global test loss: 1.389, Global test accuracy: 56.47
Round  21, Train loss: 1.531, Test loss: 1.692, Test accuracy: 45.58
Round  21, Global train loss: 1.531, Global test loss: 1.620, Global test accuracy: 52.12
Round  22, Train loss: 1.338, Test loss: 1.688, Test accuracy: 45.46
Round  22, Global train loss: 1.338, Global test loss: 1.460, Global test accuracy: 54.35
Round  23, Train loss: 1.367, Test loss: 1.715, Test accuracy: 44.91
Round  23, Global train loss: 1.367, Global test loss: 1.517, Global test accuracy: 52.53
Round  24, Train loss: 1.419, Test loss: 1.720, Test accuracy: 45.10
Round  24, Global train loss: 1.419, Global test loss: 1.507, Global test accuracy: 52.39
Round  25, Train loss: 1.457, Test loss: 1.753, Test accuracy: 44.49
Round  25, Global train loss: 1.457, Global test loss: 1.677, Global test accuracy: 49.48
Round  26, Train loss: 1.189, Test loss: 1.753, Test accuracy: 45.01
Round  26, Global train loss: 1.189, Global test loss: 1.452, Global test accuracy: 53.33
Round  27, Train loss: 1.166, Test loss: 1.772, Test accuracy: 45.01
Round  27, Global train loss: 1.166, Global test loss: 1.415, Global test accuracy: 54.73
Round  28, Train loss: 1.454, Test loss: 1.815, Test accuracy: 44.09
Round  28, Global train loss: 1.454, Global test loss: 1.588, Global test accuracy: 50.42
Round  29, Train loss: 1.169, Test loss: 1.811, Test accuracy: 44.27
Round  29, Global train loss: 1.169, Global test loss: 1.551, Global test accuracy: 48.83
Round  30, Train loss: 1.197, Test loss: 1.823, Test accuracy: 44.10
Round  30, Global train loss: 1.197, Global test loss: 1.550, Global test accuracy: 49.44
Round  31, Train loss: 1.244, Test loss: 1.858, Test accuracy: 43.58
Round  31, Global train loss: 1.244, Global test loss: 1.606, Global test accuracy: 48.12
Round  32, Train loss: 1.079, Test loss: 1.901, Test accuracy: 43.49
Round  32, Global train loss: 1.079, Global test loss: 1.374, Global test accuracy: 55.05
Round  33, Train loss: 1.316, Test loss: 1.910, Test accuracy: 43.63
Round  33, Global train loss: 1.316, Global test loss: 1.574, Global test accuracy: 49.33
Round  34, Train loss: 1.228, Test loss: 1.935, Test accuracy: 43.38
Round  34, Global train loss: 1.228, Global test loss: 1.688, Global test accuracy: 47.38
Round  35, Train loss: 1.284, Test loss: 1.970, Test accuracy: 42.86
Round  35, Global train loss: 1.284, Global test loss: 1.534, Global test accuracy: 51.77
Round  36, Train loss: 1.085, Test loss: 1.997, Test accuracy: 42.86
Round  36, Global train loss: 1.085, Global test loss: 1.632, Global test accuracy: 46.74
Round  37, Train loss: 0.914, Test loss: 2.024, Test accuracy: 42.82
Round  37, Global train loss: 0.914, Global test loss: 1.437, Global test accuracy: 51.52
Round  38, Train loss: 1.180, Test loss: 2.032, Test accuracy: 42.83
Round  38, Global train loss: 1.180, Global test loss: 1.499, Global test accuracy: 51.31
Round  39, Train loss: 0.837, Test loss: 2.079, Test accuracy: 42.60
Round  39, Global train loss: 0.837, Global test loss: 1.327, Global test accuracy: 54.62
Round  40, Train loss: 0.941, Test loss: 2.100, Test accuracy: 42.59
Round  40, Global train loss: 0.941, Global test loss: 1.520, Global test accuracy: 50.17
Round  41, Train loss: 0.958, Test loss: 2.105, Test accuracy: 42.39
Round  41, Global train loss: 0.958, Global test loss: 1.546, Global test accuracy: 49.48
Round  42, Train loss: 1.031, Test loss: 2.110, Test accuracy: 42.25
Round  42, Global train loss: 1.031, Global test loss: 1.592, Global test accuracy: 48.50
Round  43, Train loss: 1.027, Test loss: 2.141, Test accuracy: 41.90
Round  43, Global train loss: 1.027, Global test loss: 1.518, Global test accuracy: 49.84
Round  44, Train loss: 0.865, Test loss: 2.162, Test accuracy: 42.05
Round  44, Global train loss: 0.865, Global test loss: 1.406, Global test accuracy: 52.13
Round  45, Train loss: 0.835, Test loss: 2.186, Test accuracy: 41.98
Round  45, Global train loss: 0.835, Global test loss: 1.414, Global test accuracy: 52.92
Round  46, Train loss: 0.882, Test loss: 2.230, Test accuracy: 41.59
Round  46, Global train loss: 0.882, Global test loss: 1.695, Global test accuracy: 42.64
Round  47, Train loss: 0.885, Test loss: 2.262, Test accuracy: 41.46
Round  47, Global train loss: 0.885, Global test loss: 1.677, Global test accuracy: 44.05
Round  48, Train loss: 0.931, Test loss: 2.291, Test accuracy: 41.43
Round  48, Global train loss: 0.931, Global test loss: 1.516, Global test accuracy: 49.99
Round  49, Train loss: 0.678, Test loss: 2.335, Test accuracy: 40.98
Round  49, Global train loss: 0.678, Global test loss: 1.554, Global test accuracy: 45.88
Round  50, Train loss: 0.666, Test loss: 2.342, Test accuracy: 41.19
Round  50, Global train loss: 0.666, Global test loss: 1.348, Global test accuracy: 54.09
Round  51, Train loss: 0.952, Test loss: 2.361, Test accuracy: 41.38
Round  51, Global train loss: 0.952, Global test loss: 1.584, Global test accuracy: 48.34
Round  52, Train loss: 0.755, Test loss: 2.356, Test accuracy: 41.35
Round  52, Global train loss: 0.755, Global test loss: 1.499, Global test accuracy: 50.18
Round  53, Train loss: 1.065, Test loss: 2.389, Test accuracy: 40.85
Round  53, Global train loss: 1.065, Global test loss: 1.686, Global test accuracy: 43.94
Round  54, Train loss: 0.936, Test loss: 2.425, Test accuracy: 40.78
Round  54, Global train loss: 0.936, Global test loss: 1.609, Global test accuracy: 45.65
Round  55, Train loss: 0.827, Test loss: 2.498, Test accuracy: 40.31
Round  55, Global train loss: 0.827, Global test loss: 1.514, Global test accuracy: 51.12
Round  56, Train loss: 0.781, Test loss: 2.499, Test accuracy: 40.30
Round  56, Global train loss: 0.781, Global test loss: 1.555, Global test accuracy: 47.92
Round  57, Train loss: 0.797, Test loss: 2.526, Test accuracy: 40.43
Round  57, Global train loss: 0.797, Global test loss: 1.443, Global test accuracy: 51.45
Round  58, Train loss: 0.873, Test loss: 2.544, Test accuracy: 40.14
Round  58, Global train loss: 0.873, Global test loss: 1.588, Global test accuracy: 46.71
Round  59, Train loss: 0.683, Test loss: 2.586, Test accuracy: 40.34
Round  59, Global train loss: 0.683, Global test loss: 1.458, Global test accuracy: 48.08
Round  60, Train loss: 0.818, Test loss: 2.626, Test accuracy: 40.19
Round  60, Global train loss: 0.818, Global test loss: 1.626, Global test accuracy: 46.49
Round  61, Train loss: 0.612, Test loss: 2.623, Test accuracy: 40.16
Round  61, Global train loss: 0.612, Global test loss: 1.392, Global test accuracy: 51.93
Round  62, Train loss: 0.748, Test loss: 2.656, Test accuracy: 40.30
Round  62, Global train loss: 0.748, Global test loss: 1.673, Global test accuracy: 42.85
Round  63, Train loss: 0.596, Test loss: 2.669, Test accuracy: 40.48
Round  63, Global train loss: 0.596, Global test loss: 1.484, Global test accuracy: 48.66
Round  64, Train loss: 0.701, Test loss: 2.697, Test accuracy: 40.24
Round  64, Global train loss: 0.701, Global test loss: 1.606, Global test accuracy: 44.00
Round  65, Train loss: 0.744, Test loss: 2.755, Test accuracy: 39.74
Round  65, Global train loss: 0.744, Global test loss: 1.553, Global test accuracy: 46.47
Round  66, Train loss: 0.711, Test loss: 2.740, Test accuracy: 39.95
Round  66, Global train loss: 0.711, Global test loss: 1.577, Global test accuracy: 44.34
Round  67, Train loss: 0.677, Test loss: 2.778, Test accuracy: 40.18
Round  67, Global train loss: 0.677, Global test loss: 1.436, Global test accuracy: 51.35
Round  68, Train loss: 0.584, Test loss: 2.771, Test accuracy: 40.05
Round  68, Global train loss: 0.584, Global test loss: 1.418, Global test accuracy: 50.85
Round  69, Train loss: 0.691, Test loss: 2.792, Test accuracy: 40.06
Round  69, Global train loss: 0.691, Global test loss: 1.710, Global test accuracy: 40.41
Round  70, Train loss: 0.642, Test loss: 2.816, Test accuracy: 39.80
Round  70, Global train loss: 0.642, Global test loss: 1.599, Global test accuracy: 46.33
Round  71, Train loss: 0.728, Test loss: 2.841, Test accuracy: 40.03
Round  71, Global train loss: 0.728, Global test loss: 1.687, Global test accuracy: 41.73
Round  72, Train loss: 0.720, Test loss: 2.881, Test accuracy: 40.10
Round  72, Global train loss: 0.720, Global test loss: 1.553, Global test accuracy: 46.94
Round  73, Train loss: 0.664, Test loss: 2.899, Test accuracy: 40.01
Round  73, Global train loss: 0.664, Global test loss: 1.538, Global test accuracy: 46.54
Round  74, Train loss: 0.726, Test loss: 2.919, Test accuracy: 39.78
Round  74, Global train loss: 0.726, Global test loss: 1.661, Global test accuracy: 44.21
Round  75, Train loss: 0.670, Test loss: 2.921, Test accuracy: 39.78
Round  75, Global train loss: 0.670, Global test loss: 1.614, Global test accuracy: 45.30
Round  76, Train loss: 0.659, Test loss: 2.961, Test accuracy: 39.69
Round  76, Global train loss: 0.659, Global test loss: 1.652, Global test accuracy: 41.63
Round  77, Train loss: 0.648, Test loss: 2.978, Test accuracy: 39.92
Round  77, Global train loss: 0.648, Global test loss: 1.721, Global test accuracy: 38.13
Round  78, Train loss: 0.506, Test loss: 3.021, Test accuracy: 39.76
Round  78, Global train loss: 0.506, Global test loss: 1.556, Global test accuracy: 44.98
Round  79, Train loss: 0.746, Test loss: 3.039, Test accuracy: 39.99
Round  79, Global train loss: 0.746, Global test loss: 1.845, Global test accuracy: 37.22
Round  80, Train loss: 0.629, Test loss: 3.069, Test accuracy: 39.88
Round  80, Global train loss: 0.629, Global test loss: 1.805, Global test accuracy: 34.12
Round  81, Train loss: 0.535, Test loss: 3.093, Test accuracy: 40.12
Round  81, Global train loss: 0.535, Global test loss: 1.564, Global test accuracy: 46.82
Round  82, Train loss: 0.431, Test loss: 3.109, Test accuracy: 40.01
Round  82, Global train loss: 0.431, Global test loss: 1.416, Global test accuracy: 51.98
Round  83, Train loss: 0.521, Test loss: 3.120, Test accuracy: 40.10
Round  83, Global train loss: 0.521, Global test loss: 1.520, Global test accuracy: 47.94
Round  84, Train loss: 0.511, Test loss: 3.151, Test accuracy: 40.00
Round  84, Global train loss: 0.511, Global test loss: 1.532, Global test accuracy: 46.38
Round  85, Train loss: 0.408, Test loss: 3.185, Test accuracy: 40.03
Round  85, Global train loss: 0.408, Global test loss: 1.466, Global test accuracy: 48.14
Round  86, Train loss: 0.508, Test loss: 3.189, Test accuracy: 39.86
Round  86, Global train loss: 0.508, Global test loss: 1.490, Global test accuracy: 48.52
Round  87, Train loss: 0.487, Test loss: 3.253, Test accuracy: 39.91
Round  87, Global train loss: 0.487, Global test loss: 1.456, Global test accuracy: 50.98
Round  88, Train loss: 0.471, Test loss: 3.252, Test accuracy: 39.97
Round  88, Global train loss: 0.471, Global test loss: 1.516, Global test accuracy: 47.93
Round  89, Train loss: 0.560, Test loss: 3.263, Test accuracy: 39.45
Round  89, Global train loss: 0.560, Global test loss: 1.599, Global test accuracy: 45.48
Round  90, Train loss: 0.584, Test loss: 3.259, Test accuracy: 39.95
Round  90, Global train loss: 0.584, Global test loss: 1.806, Global test accuracy: 39.02
Round  91, Train loss: 0.590, Test loss: 3.297, Test accuracy: 39.84
Round  91, Global train loss: 0.590, Global test loss: 1.778, Global test accuracy: 38.21
Round  92, Train loss: 0.532, Test loss: 3.362, Test accuracy: 39.44
Round  92, Global train loss: 0.532, Global test loss: 1.644, Global test accuracy: 42.17
Round  93, Train loss: 0.473, Test loss: 3.362, Test accuracy: 39.78
Round  93, Global train loss: 0.473, Global test loss: 1.676, Global test accuracy: 40.45
Round  94, Train loss: 0.520, Test loss: 3.385, Test accuracy: 39.75
Round  94, Global train loss: 0.520, Global test loss: 1.607, Global test accuracy: 46.31
Round  95, Train loss: 0.454, Test loss: 3.395, Test accuracy: 39.94
Round  95, Global train loss: 0.454, Global test loss: 1.578, Global test accuracy: 44.61
Round  96, Train loss: 0.472, Test loss: 3.394, Test accuracy: 39.98
Round  96, Global train loss: 0.472, Global test loss: 1.617, Global test accuracy: 42.70
Round  97, Train loss: 0.411, Test loss: 3.454, Test accuracy: 39.97
Round  97, Global train loss: 0.411, Global test loss: 1.601, Global test accuracy: 42.97
Round  98, Train loss: 0.552, Test loss: 3.471, Test accuracy: 39.70
Round  98, Global train loss: 0.552, Global test loss: 1.759, Global test accuracy: 39.50
Round  99, Train loss: 0.501, Test loss: 3.469, Test accuracy: 39.75
Round  99, Global train loss: 0.501, Global test loss: 1.694, Global test accuracy: 40.99
Final Round, Train loss: 0.307, Test loss: 3.864, Test accuracy: 40.30
Final Round, Global train loss: 0.307, Global test loss: 1.694, Global test accuracy: 40.99
Average accuracy final 10 rounds: 39.81075 

Average global accuracy final 10 rounds: 41.693 

5710.740659713745
[4.914180040359497, 9.828360080718994, 14.56223726272583, 19.296114444732666, 24.025656938552856, 28.755199432373047, 33.52208733558655, 38.28897523880005, 43.05584216117859, 47.82270908355713, 52.624536752700806, 57.42636442184448, 62.16362166404724, 66.90087890625, 71.62121725082397, 76.34155559539795, 81.04639554023743, 85.7512354850769, 90.43270921707153, 95.11418294906616, 99.79634857177734, 104.47851419448853, 109.16036939620972, 113.84222459793091, 118.5651342868805, 123.28804397583008, 127.99111604690552, 132.69418811798096, 137.43896317481995, 142.18373823165894, 146.9210388660431, 151.65833950042725, 156.39619946479797, 161.1340594291687, 165.90728521347046, 170.68051099777222, 175.43579196929932, 180.19107294082642, 184.91078281402588, 189.63049268722534, 194.33709192276, 199.04369115829468, 203.73620295524597, 208.42871475219727, 213.14128375053406, 217.85385274887085, 222.55244135856628, 227.25102996826172, 231.92163038253784, 236.59223079681396, 241.2756769657135, 245.95912313461304, 250.6543791294098, 255.34963512420654, 259.9955086708069, 264.6413822174072, 269.27927589416504, 273.91716957092285, 278.65367126464844, 283.390172958374, 287.46873593330383, 291.54729890823364, 295.64522194862366, 299.7431449890137, 303.8198697566986, 307.89659452438354, 311.9519774913788, 316.007360458374, 320.07840728759766, 324.1494541168213, 328.2419149875641, 332.3343758583069, 336.42892718315125, 340.5234785079956, 344.6139769554138, 348.70447540283203, 352.76375579833984, 356.82303619384766, 360.8980450630188, 364.97305393218994, 369.01835656166077, 373.0636591911316, 377.12420773506165, 381.1847562789917, 385.27346992492676, 389.3621835708618, 393.4562225341797, 397.55026149749756, 401.65104627609253, 405.7518310546875, 409.8315939903259, 413.91135692596436, 417.90896940231323, 421.9065818786621, 425.8826513290405, 429.85872077941895, 433.83002042770386, 437.80132007598877, 441.78963708877563, 445.7779541015625, 449.76514983177185, 453.7523455619812, 457.73277616500854, 461.7132067680359, 465.9188575744629, 470.1245083808899, 474.10729336738586, 478.09007835388184, 482.1192843914032, 486.14849042892456, 490.1335732936859, 494.11865615844727, 498.1086947917938, 502.0987334251404, 506.09476590156555, 510.0907983779907, 514.0831918716431, 518.0755853652954, 522.0556764602661, 526.0357675552368, 530.0165042877197, 533.9972410202026, 537.9966247081757, 541.9960083961487, 545.9690225124359, 549.9420366287231, 553.9169964790344, 557.8919563293457, 561.8681378364563, 565.8443193435669, 569.827823638916, 573.8113279342651, 577.7901017665863, 581.7688755989075, 585.7390420436859, 589.7092084884644, 593.6974391937256, 597.6856698989868, 601.6759445667267, 605.6662192344666, 609.6311838626862, 613.5961484909058, 617.5779712200165, 621.5597939491272, 625.5704131126404, 629.5810322761536, 633.6011126041412, 637.6211929321289, 641.6329598426819, 645.6447267532349, 649.673271894455, 653.701817035675, 657.7083048820496, 661.7147927284241, 665.7246012687683, 669.7344098091125, 673.7585964202881, 677.7827830314636, 681.8078415393829, 685.8329000473022, 689.8392553329468, 693.8456106185913, 697.8566184043884, 701.8676261901855, 705.8634226322174, 709.8592190742493, 713.863828420639, 717.8684377670288, 721.8743777275085, 725.8803176879883, 729.8967170715332, 733.9131164550781, 737.933075428009, 741.9530344009399, 745.9624288082123, 749.9718232154846, 754.0013701915741, 758.0309171676636, 762.0492022037506, 766.0674872398376, 770.1306500434875, 774.1938128471375, 778.97323179245, 783.7526507377625, 788.7155363559723, 793.6784219741821, 798.6413812637329, 803.6043405532837, 808.5008335113525, 813.3973264694214, 818.1504211425781, 822.9035158157349, 827.6793763637543, 832.4552369117737, 837.2245631217957, 841.9938893318176, 846.7816832065582, 851.5694770812988, 856.3733615875244, 861.17724609375, 863.5817918777466, 865.9863376617432]
[29.9375, 29.9375, 36.665, 36.665, 38.1825, 38.1825, 39.5725, 39.5725, 39.8375, 39.8375, 41.405, 41.405, 42.5075, 42.5075, 42.7925, 42.7925, 42.69, 42.69, 43.3275, 43.3275, 44.105, 44.105, 45.1375, 45.1375, 45.27, 45.27, 45.0275, 45.0275, 44.885, 44.885, 45.33, 45.33, 45.2725, 45.2725, 44.6925, 44.6925, 44.9425, 44.9425, 45.1225, 45.1225, 45.43, 45.43, 45.575, 45.575, 45.4575, 45.4575, 44.91, 44.91, 45.1025, 45.1025, 44.49, 44.49, 45.0075, 45.0075, 45.01, 45.01, 44.0875, 44.0875, 44.2675, 44.2675, 44.1, 44.1, 43.58, 43.58, 43.495, 43.495, 43.635, 43.635, 43.385, 43.385, 42.86, 42.86, 42.8575, 42.8575, 42.8225, 42.8225, 42.8325, 42.8325, 42.605, 42.605, 42.59, 42.59, 42.3875, 42.3875, 42.2475, 42.2475, 41.9, 41.9, 42.0475, 42.0475, 41.975, 41.975, 41.59, 41.59, 41.4575, 41.4575, 41.4275, 41.4275, 40.98, 40.98, 41.1875, 41.1875, 41.38, 41.38, 41.355, 41.355, 40.85, 40.85, 40.7775, 40.7775, 40.3125, 40.3125, 40.3, 40.3, 40.4275, 40.4275, 40.1425, 40.1425, 40.3425, 40.3425, 40.1875, 40.1875, 40.155, 40.155, 40.305, 40.305, 40.4775, 40.4775, 40.2425, 40.2425, 39.7375, 39.7375, 39.945, 39.945, 40.1775, 40.1775, 40.055, 40.055, 40.0575, 40.0575, 39.7975, 39.7975, 40.03, 40.03, 40.1, 40.1, 40.0125, 40.0125, 39.78, 39.78, 39.78, 39.78, 39.6875, 39.6875, 39.92, 39.92, 39.76, 39.76, 39.9925, 39.9925, 39.8775, 39.8775, 40.12, 40.12, 40.005, 40.005, 40.1, 40.1, 40.0025, 40.0025, 40.03, 40.03, 39.86, 39.86, 39.91, 39.91, 39.97, 39.97, 39.445, 39.445, 39.9525, 39.9525, 39.8425, 39.8425, 39.4375, 39.4375, 39.785, 39.785, 39.7525, 39.7525, 39.935, 39.935, 39.985, 39.985, 39.965, 39.965, 39.705, 39.705, 39.7475, 39.7475, 40.2975, 40.2975]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.5  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.5000 
   Client 12, noise    level: 0.5000 
   Client 13, noise    level: 0.5000 
   Client 11, noise    level: 0.5000 
   Client 3, noise    level: 0.5000 
   Client 2, noise    level: 0.5000 
   Client 19, noise    level: 0.5000 
   Client 18, noise    level: 0.5000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.041, Test loss: 1.836, Test accuracy: 36.36
Round   0, Global train loss: 2.041, Global test loss: 1.840, Global test accuracy: 37.69
Round   1, Train loss: 1.871, Test loss: 1.693, Test accuracy: 39.10
Round   1, Global train loss: 1.871, Global test loss: 1.606, Global test accuracy: 42.85
Round   2, Train loss: 1.762, Test loss: 1.643, Test accuracy: 41.74
Round   2, Global train loss: 1.762, Global test loss: 1.460, Global test accuracy: 49.27
Round   3, Train loss: 1.655, Test loss: 1.594, Test accuracy: 44.13
Round   3, Global train loss: 1.655, Global test loss: 1.387, Global test accuracy: 53.20
Round   4, Train loss: 1.550, Test loss: 1.530, Test accuracy: 46.45
Round   4, Global train loss: 1.550, Global test loss: 1.287, Global test accuracy: 55.46
Round   5, Train loss: 1.575, Test loss: 1.496, Test accuracy: 48.50
Round   5, Global train loss: 1.575, Global test loss: 1.281, Global test accuracy: 57.21
Round   6, Train loss: 1.584, Test loss: 1.457, Test accuracy: 50.57
Round   6, Global train loss: 1.584, Global test loss: 1.230, Global test accuracy: 60.64
Round   7, Train loss: 1.433, Test loss: 1.432, Test accuracy: 51.71
Round   7, Global train loss: 1.433, Global test loss: 1.147, Global test accuracy: 62.34
Round   8, Train loss: 1.426, Test loss: 1.409, Test accuracy: 52.30
Round   8, Global train loss: 1.426, Global test loss: 1.109, Global test accuracy: 63.05
Round   9, Train loss: 1.468, Test loss: 1.368, Test accuracy: 54.12
Round   9, Global train loss: 1.468, Global test loss: 1.163, Global test accuracy: 62.74
Round  10, Train loss: 1.343, Test loss: 1.361, Test accuracy: 54.34
Round  10, Global train loss: 1.343, Global test loss: 1.060, Global test accuracy: 64.80
Round  11, Train loss: 1.362, Test loss: 1.332, Test accuracy: 55.60
Round  11, Global train loss: 1.362, Global test loss: 1.055, Global test accuracy: 66.22
Round  12, Train loss: 1.357, Test loss: 1.307, Test accuracy: 56.65
Round  12, Global train loss: 1.357, Global test loss: 1.046, Global test accuracy: 67.22
Round  13, Train loss: 1.307, Test loss: 1.266, Test accuracy: 57.88
Round  13, Global train loss: 1.307, Global test loss: 0.992, Global test accuracy: 68.02
Round  14, Train loss: 1.223, Test loss: 1.243, Test accuracy: 58.92
Round  14, Global train loss: 1.223, Global test loss: 0.965, Global test accuracy: 68.61
Round  15, Train loss: 1.214, Test loss: 1.213, Test accuracy: 59.98
Round  15, Global train loss: 1.214, Global test loss: 0.949, Global test accuracy: 69.70
Round  16, Train loss: 1.267, Test loss: 1.202, Test accuracy: 60.26
Round  16, Global train loss: 1.267, Global test loss: 0.963, Global test accuracy: 69.53
Round  17, Train loss: 1.072, Test loss: 1.212, Test accuracy: 59.99
Round  17, Global train loss: 1.072, Global test loss: 0.887, Global test accuracy: 70.39
Round  18, Train loss: 1.251, Test loss: 1.199, Test accuracy: 60.67
Round  18, Global train loss: 1.251, Global test loss: 0.936, Global test accuracy: 70.50
Round  19, Train loss: 1.192, Test loss: 1.169, Test accuracy: 61.73
Round  19, Global train loss: 1.192, Global test loss: 0.901, Global test accuracy: 70.88
Round  20, Train loss: 1.214, Test loss: 1.172, Test accuracy: 61.73
Round  20, Global train loss: 1.214, Global test loss: 0.927, Global test accuracy: 71.14
Round  21, Train loss: 1.143, Test loss: 1.163, Test accuracy: 62.09
Round  21, Global train loss: 1.143, Global test loss: 0.873, Global test accuracy: 71.75
Round  22, Train loss: 1.105, Test loss: 1.150, Test accuracy: 62.53
Round  22, Global train loss: 1.105, Global test loss: 0.871, Global test accuracy: 71.53
Round  23, Train loss: 1.151, Test loss: 1.148, Test accuracy: 62.63
Round  23, Global train loss: 1.151, Global test loss: 0.887, Global test accuracy: 71.47
Round  24, Train loss: 1.135, Test loss: 1.147, Test accuracy: 62.89
Round  24, Global train loss: 1.135, Global test loss: 0.871, Global test accuracy: 72.05
Round  25, Train loss: 1.168, Test loss: 1.140, Test accuracy: 63.18
Round  25, Global train loss: 1.168, Global test loss: 0.882, Global test accuracy: 71.91
Round  26, Train loss: 1.124, Test loss: 1.153, Test accuracy: 63.02
Round  26, Global train loss: 1.124, Global test loss: 0.873, Global test accuracy: 71.81
Round  27, Train loss: 1.082, Test loss: 1.145, Test accuracy: 63.45
Round  27, Global train loss: 1.082, Global test loss: 0.834, Global test accuracy: 72.76
Round  28, Train loss: 1.031, Test loss: 1.147, Test accuracy: 63.30
Round  28, Global train loss: 1.031, Global test loss: 0.842, Global test accuracy: 72.79
Round  29, Train loss: 1.076, Test loss: 1.159, Test accuracy: 63.12
Round  29, Global train loss: 1.076, Global test loss: 0.858, Global test accuracy: 72.50
Round  30, Train loss: 1.053, Test loss: 1.145, Test accuracy: 63.35
Round  30, Global train loss: 1.053, Global test loss: 0.850, Global test accuracy: 72.73
Round  31, Train loss: 1.018, Test loss: 1.147, Test accuracy: 63.40
Round  31, Global train loss: 1.018, Global test loss: 0.844, Global test accuracy: 72.34
Round  32, Train loss: 1.023, Test loss: 1.141, Test accuracy: 63.59
Round  32, Global train loss: 1.023, Global test loss: 0.826, Global test accuracy: 73.23
Round  33, Train loss: 0.989, Test loss: 1.137, Test accuracy: 63.85
Round  33, Global train loss: 0.989, Global test loss: 0.843, Global test accuracy: 72.92
Round  34, Train loss: 0.981, Test loss: 1.131, Test accuracy: 64.21
Round  34, Global train loss: 0.981, Global test loss: 0.854, Global test accuracy: 71.92
Round  35, Train loss: 1.028, Test loss: 1.130, Test accuracy: 64.17
Round  35, Global train loss: 1.028, Global test loss: 0.841, Global test accuracy: 72.45
Round  36, Train loss: 0.980, Test loss: 1.134, Test accuracy: 64.27
Round  36, Global train loss: 0.980, Global test loss: 0.817, Global test accuracy: 73.01
Round  37, Train loss: 0.930, Test loss: 1.155, Test accuracy: 63.83
Round  37, Global train loss: 0.930, Global test loss: 0.819, Global test accuracy: 72.86
Round  38, Train loss: 1.076, Test loss: 1.153, Test accuracy: 63.91
Round  38, Global train loss: 1.076, Global test loss: 0.858, Global test accuracy: 72.34
Round  39, Train loss: 0.913, Test loss: 1.139, Test accuracy: 64.31
Round  39, Global train loss: 0.913, Global test loss: 0.823, Global test accuracy: 73.05
Round  40, Train loss: 0.911, Test loss: 1.138, Test accuracy: 64.49
Round  40, Global train loss: 0.911, Global test loss: 0.804, Global test accuracy: 73.36
Round  41, Train loss: 0.940, Test loss: 1.139, Test accuracy: 64.47
Round  41, Global train loss: 0.940, Global test loss: 0.841, Global test accuracy: 72.53
Round  42, Train loss: 0.979, Test loss: 1.136, Test accuracy: 64.43
Round  42, Global train loss: 0.979, Global test loss: 0.826, Global test accuracy: 73.25
Round  43, Train loss: 0.946, Test loss: 1.129, Test accuracy: 64.61
Round  43, Global train loss: 0.946, Global test loss: 0.840, Global test accuracy: 72.93
Round  44, Train loss: 0.999, Test loss: 1.128, Test accuracy: 64.94
Round  44, Global train loss: 0.999, Global test loss: 0.839, Global test accuracy: 72.81
Round  45, Train loss: 1.008, Test loss: 1.135, Test accuracy: 64.85
Round  45, Global train loss: 1.008, Global test loss: 0.899, Global test accuracy: 71.69
Round  46, Train loss: 0.873, Test loss: 1.149, Test accuracy: 64.64
Round  46, Global train loss: 0.873, Global test loss: 0.823, Global test accuracy: 73.11
Round  47, Train loss: 0.895, Test loss: 1.153, Test accuracy: 64.56
Round  47, Global train loss: 0.895, Global test loss: 0.828, Global test accuracy: 73.42
Round  48, Train loss: 0.870, Test loss: 1.152, Test accuracy: 64.38
Round  48, Global train loss: 0.870, Global test loss: 0.838, Global test accuracy: 73.19
Round  49, Train loss: 0.893, Test loss: 1.145, Test accuracy: 64.59
Round  49, Global train loss: 0.893, Global test loss: 0.803, Global test accuracy: 74.19
Round  50, Train loss: 0.989, Test loss: 1.128, Test accuracy: 65.05
Round  50, Global train loss: 0.989, Global test loss: 0.819, Global test accuracy: 73.41
Round  51, Train loss: 0.951, Test loss: 1.146, Test accuracy: 64.50
Round  51, Global train loss: 0.951, Global test loss: 0.840, Global test accuracy: 72.87
Round  52, Train loss: 0.866, Test loss: 1.147, Test accuracy: 64.37
Round  52, Global train loss: 0.866, Global test loss: 0.839, Global test accuracy: 72.98
Round  53, Train loss: 0.897, Test loss: 1.146, Test accuracy: 64.38
Round  53, Global train loss: 0.897, Global test loss: 0.799, Global test accuracy: 73.65
Round  54, Train loss: 0.876, Test loss: 1.152, Test accuracy: 64.54
Round  54, Global train loss: 0.876, Global test loss: 0.813, Global test accuracy: 74.03
Round  55, Train loss: 0.968, Test loss: 1.144, Test accuracy: 65.02
Round  55, Global train loss: 0.968, Global test loss: 0.830, Global test accuracy: 73.35
Round  56, Train loss: 0.879, Test loss: 1.134, Test accuracy: 65.34
Round  56, Global train loss: 0.879, Global test loss: 0.854, Global test accuracy: 72.57
Round  57, Train loss: 0.952, Test loss: 1.139, Test accuracy: 65.27
Round  57, Global train loss: 0.952, Global test loss: 0.835, Global test accuracy: 73.04
Round  58, Train loss: 0.879, Test loss: 1.144, Test accuracy: 65.24
Round  58, Global train loss: 0.879, Global test loss: 0.807, Global test accuracy: 73.84
Round  59, Train loss: 0.852, Test loss: 1.147, Test accuracy: 65.19
Round  59, Global train loss: 0.852, Global test loss: 0.806, Global test accuracy: 73.81
Round  60, Train loss: 0.797, Test loss: 1.152, Test accuracy: 65.03
Round  60, Global train loss: 0.797, Global test loss: 0.809, Global test accuracy: 73.91
Round  61, Train loss: 0.849, Test loss: 1.165, Test accuracy: 64.83
Round  61, Global train loss: 0.849, Global test loss: 0.829, Global test accuracy: 73.58
Round  62, Train loss: 0.854, Test loss: 1.165, Test accuracy: 64.74
Round  62, Global train loss: 0.854, Global test loss: 0.850, Global test accuracy: 72.70
Round  63, Train loss: 0.866, Test loss: 1.152, Test accuracy: 65.22
Round  63, Global train loss: 0.866, Global test loss: 0.821, Global test accuracy: 73.54
Round  64, Train loss: 0.837, Test loss: 1.161, Test accuracy: 65.06
Round  64, Global train loss: 0.837, Global test loss: 0.827, Global test accuracy: 72.92
Round  65, Train loss: 0.801, Test loss: 1.164, Test accuracy: 64.99
Round  65, Global train loss: 0.801, Global test loss: 0.809, Global test accuracy: 74.04
Round  66, Train loss: 0.808, Test loss: 1.164, Test accuracy: 64.94
Round  66, Global train loss: 0.808, Global test loss: 0.801, Global test accuracy: 73.92
Round  67, Train loss: 0.858, Test loss: 1.164, Test accuracy: 64.76
Round  67, Global train loss: 0.858, Global test loss: 0.809, Global test accuracy: 73.79
Round  68, Train loss: 0.834, Test loss: 1.166, Test accuracy: 64.84
Round  68, Global train loss: 0.834, Global test loss: 0.805, Global test accuracy: 74.18
Round  69, Train loss: 0.794, Test loss: 1.150, Test accuracy: 65.28
Round  69, Global train loss: 0.794, Global test loss: 0.813, Global test accuracy: 74.25
Round  70, Train loss: 0.917, Test loss: 1.163, Test accuracy: 64.96
Round  70, Global train loss: 0.917, Global test loss: 0.888, Global test accuracy: 71.85
Round  71, Train loss: 0.772, Test loss: 1.169, Test accuracy: 65.00
Round  71, Global train loss: 0.772, Global test loss: 0.860, Global test accuracy: 72.98
Round  72, Train loss: 0.838, Test loss: 1.162, Test accuracy: 65.31
Round  72, Global train loss: 0.838, Global test loss: 0.807, Global test accuracy: 73.68
Round  73, Train loss: 0.745, Test loss: 1.162, Test accuracy: 65.34
Round  73, Global train loss: 0.745, Global test loss: 0.804, Global test accuracy: 74.40
Round  74, Train loss: 0.814, Test loss: 1.177, Test accuracy: 64.87
Round  74, Global train loss: 0.814, Global test loss: 0.851, Global test accuracy: 72.85
Round  75, Train loss: 0.791, Test loss: 1.170, Test accuracy: 65.23
Round  75, Global train loss: 0.791, Global test loss: 0.813, Global test accuracy: 74.12
Round  76, Train loss: 0.706, Test loss: 1.187, Test accuracy: 64.80
Round  76, Global train loss: 0.706, Global test loss: 0.832, Global test accuracy: 74.04
Round  77, Train loss: 0.765, Test loss: 1.190, Test accuracy: 64.70
Round  77, Global train loss: 0.765, Global test loss: 0.835, Global test accuracy: 73.47
Round  78, Train loss: 0.809, Test loss: 1.190, Test accuracy: 64.86
Round  78, Global train loss: 0.809, Global test loss: 0.823, Global test accuracy: 73.86
Round  79, Train loss: 0.843, Test loss: 1.180, Test accuracy: 65.15
Round  79, Global train loss: 0.843, Global test loss: 0.838, Global test accuracy: 74.01
Round  80, Train loss: 0.737, Test loss: 1.164, Test accuracy: 65.38
Round  80, Global train loss: 0.737, Global test loss: 0.825, Global test accuracy: 74.06
Round  81, Train loss: 0.820, Test loss: 1.162, Test accuracy: 65.41
Round  81, Global train loss: 0.820, Global test loss: 0.826, Global test accuracy: 73.54
Round  82, Train loss: 0.825, Test loss: 1.156, Test accuracy: 65.62
Round  82, Global train loss: 0.825, Global test loss: 0.829, Global test accuracy: 73.44
Round  83, Train loss: 0.887, Test loss: 1.161, Test accuracy: 65.49
Round  83, Global train loss: 0.887, Global test loss: 0.854, Global test accuracy: 72.92
Round  84, Train loss: 0.824, Test loss: 1.157, Test accuracy: 65.56
Round  84, Global train loss: 0.824, Global test loss: 0.858, Global test accuracy: 73.15
Round  85, Train loss: 0.801, Test loss: 1.160, Test accuracy: 65.64
Round  85, Global train loss: 0.801, Global test loss: 0.815, Global test accuracy: 74.00
Round  86, Train loss: 0.743, Test loss: 1.179, Test accuracy: 65.28
Round  86, Global train loss: 0.743, Global test loss: 0.842, Global test accuracy: 73.81
Round  87, Train loss: 0.844, Test loss: 1.184, Test accuracy: 65.16
Round  87, Global train loss: 0.844, Global test loss: 0.846, Global test accuracy: 73.46
Round  88, Train loss: 0.808, Test loss: 1.192, Test accuracy: 65.29
Round  88, Global train loss: 0.808, Global test loss: 0.870, Global test accuracy: 72.73
Round  89, Train loss: 0.700, Test loss: 1.200, Test accuracy: 64.92
Round  89, Global train loss: 0.700, Global test loss: 0.844, Global test accuracy: 73.75
Round  90, Train loss: 0.795, Test loss: 1.213, Test accuracy: 64.88
Round  90, Global train loss: 0.795, Global test loss: 0.866, Global test accuracy: 72.98
Round  91, Train loss: 0.663, Test loss: 1.218, Test accuracy: 64.89
Round  91, Global train loss: 0.663, Global test loss: 0.831, Global test accuracy: 74.30
Round  92, Train loss: 0.790, Test loss: 1.206, Test accuracy: 65.30
Round  92, Global train loss: 0.790, Global test loss: 0.842, Global test accuracy: 73.90
Round  93, Train loss: 0.688, Test loss: 1.224, Test accuracy: 64.87
Round  93, Global train loss: 0.688, Global test loss: 0.833, Global test accuracy: 73.98
Round  94, Train loss: 0.814, Test loss: 1.220, Test accuracy: 64.86
Round  94, Global train loss: 0.814, Global test loss: 0.861, Global test accuracy: 72.86
Round  95, Train loss: 0.731, Test loss: 1.216, Test accuracy: 64.83
Round  95, Global train loss: 0.731, Global test loss: 0.827, Global test accuracy: 73.62
Round  96, Train loss: 0.673, Test loss: 1.216, Test accuracy: 64.73
Round  96, Global train loss: 0.673, Global test loss: 0.833, Global test accuracy: 74.30
Round  97, Train loss: 0.677, Test loss: 1.218, Test accuracy: 64.96
Round  97, Global train loss: 0.677, Global test loss: 0.844, Global test accuracy: 73.93
Round  98, Train loss: 0.675, Test loss: 1.216, Test accuracy: 65.09
Round  98, Global train loss: 0.675, Global test loss: 0.848, Global test accuracy: 74.11
Round  99, Train loss: 0.718, Test loss: 1.217, Test accuracy: 65.01
Round  99, Global train loss: 0.718, Global test loss: 0.849, Global test accuracy: 73.50
Final Round, Train loss: 0.500, Test loss: 1.362, Test accuracy: 65.03
Final Round, Global train loss: 0.500, Global test loss: 0.849, Global test accuracy: 73.50
Average accuracy final 10 rounds: 64.94125 

Average global accuracy final 10 rounds: 73.7465 

6029.88169002533
[5.005933523178101, 10.011867046356201, 15.01891279220581, 20.02595853805542, 25.029056549072266, 30.03215456008911, 35.024935245513916, 40.01771593093872, 45.02723836898804, 50.03676080703735, 55.04197883605957, 60.04719686508179, 65.05750608444214, 70.06781530380249, 75.0670714378357, 80.0663275718689, 85.08437371253967, 90.10241985321045, 95.09658646583557, 100.0907530784607, 105.09468913078308, 110.09862518310547, 115.11350679397583, 120.12838840484619, 125.19483804702759, 130.26128768920898, 135.26912140846252, 140.27695512771606, 145.27370023727417, 150.27044534683228, 155.2703297138214, 160.27021408081055, 165.26159691810608, 170.2529797554016, 175.2521276473999, 180.2512755393982, 185.23682808876038, 190.22238063812256, 195.21924829483032, 200.2161159515381, 205.21445560455322, 210.21279525756836, 215.19157099723816, 220.17034673690796, 225.17354583740234, 230.17674493789673, 235.19911885261536, 240.22149276733398, 245.2376594543457, 250.25382614135742, 255.2759029865265, 260.29797983169556, 265.30235052108765, 270.30672121047974, 275.3021306991577, 280.2975401878357, 285.2921459674835, 290.28675174713135, 295.291624546051, 300.2964973449707, 305.3133680820465, 310.3302388191223, 315.33738112449646, 320.3445234298706, 325.3452603816986, 330.3459973335266, 335.3625707626343, 340.37914419174194, 345.3772087097168, 350.37527322769165, 355.38892936706543, 360.4025855064392, 365.406156539917, 370.4097275733948, 375.40871834754944, 380.4077091217041, 385.4420099258423, 390.47631072998047, 395.4948525428772, 400.5133943557739, 405.5261116027832, 410.5388288497925, 415.54857110977173, 420.558313369751, 425.5685293674469, 430.5787453651428, 435.59261989593506, 440.6064944267273, 445.6137683391571, 450.6210422515869, 455.6298990249634, 460.63875579833984, 465.6424231529236, 470.6460905075073, 475.6579496860504, 480.6698088645935, 485.6680495738983, 490.6662902832031, 495.6757037639618, 500.68511724472046, 505.6907489299774, 510.6963806152344, 515.7094440460205, 520.7225074768066, 525.7217195034027, 530.7209315299988, 535.5095357894897, 540.2981400489807, 545.3092200756073, 550.3203001022339, 555.4010782241821, 560.4818563461304, 565.540397644043, 570.5989389419556, 575.6406195163727, 580.6823000907898, 585.7327747344971, 590.7832493782043, 595.8552255630493, 600.9272017478943, 606.0013847351074, 611.0755677223206, 616.1454951763153, 621.2154226303101, 626.2669279575348, 631.3184332847595, 636.3678259849548, 641.4172186851501, 646.4417889118195, 651.4663591384888, 656.516613483429, 661.5668678283691, 666.554191827774, 671.541515827179, 676.5304436683655, 681.519371509552, 686.4802429676056, 691.4411144256592, 696.4062676429749, 701.3714208602905, 705.5059080123901, 709.6403951644897, 713.754296541214, 717.8681979179382, 721.9918472766876, 726.115496635437, 730.2508761882782, 734.3862557411194, 738.5095512866974, 742.6328468322754, 746.7455251216888, 750.8582034111023, 755.5335285663605, 760.2088537216187, 764.8848271369934, 769.5608005523682, 774.231879234314, 778.9029579162598, 783.5824353694916, 788.2619128227234, 792.9724552631378, 797.6829977035522, 802.3762862682343, 807.0695748329163, 811.7398176193237, 816.4100604057312, 820.5688495635986, 824.7276387214661, 828.9645328521729, 833.2014269828796, 837.4450576305389, 841.6886882781982, 845.8497416973114, 850.0107951164246, 854.13947224617, 858.2681493759155, 862.392817735672, 866.5174860954285, 870.6425993442535, 874.7677125930786, 878.8864059448242, 883.0050992965698, 887.1273255348206, 891.2495517730713, 895.378261089325, 899.5069704055786, 903.7840280532837, 908.0610857009888, 912.2108998298645, 916.3607139587402, 920.4735815525055, 924.5864491462708, 928.7212104797363, 932.8559718132019, 936.9990952014923, 941.1422185897827, 945.2763767242432, 949.4105348587036, 953.551427602768, 957.6923203468323, 959.7620587348938, 961.8317971229553]
[36.3575, 36.3575, 39.0975, 39.0975, 41.7375, 41.7375, 44.135, 44.135, 46.4475, 46.4475, 48.5, 48.5, 50.57, 50.57, 51.7075, 51.7075, 52.2975, 52.2975, 54.125, 54.125, 54.345, 54.345, 55.6025, 55.6025, 56.6475, 56.6475, 57.885, 57.885, 58.9175, 58.9175, 59.9825, 59.9825, 60.26, 60.26, 59.9875, 59.9875, 60.6675, 60.6675, 61.7275, 61.7275, 61.735, 61.735, 62.0925, 62.0925, 62.5275, 62.5275, 62.635, 62.635, 62.89, 62.89, 63.18, 63.18, 63.015, 63.015, 63.455, 63.455, 63.3025, 63.3025, 63.1175, 63.1175, 63.3525, 63.3525, 63.395, 63.395, 63.5875, 63.5875, 63.855, 63.855, 64.2075, 64.2075, 64.165, 64.165, 64.2725, 64.2725, 63.83, 63.83, 63.905, 63.905, 64.315, 64.315, 64.4925, 64.4925, 64.465, 64.465, 64.4275, 64.4275, 64.6125, 64.6125, 64.945, 64.945, 64.8475, 64.8475, 64.64, 64.64, 64.5575, 64.5575, 64.3825, 64.3825, 64.5925, 64.5925, 65.0525, 65.0525, 64.5025, 64.5025, 64.37, 64.37, 64.38, 64.38, 64.5375, 64.5375, 65.02, 65.02, 65.3375, 65.3375, 65.27, 65.27, 65.2375, 65.2375, 65.1925, 65.1925, 65.0275, 65.0275, 64.825, 64.825, 64.7375, 64.7375, 65.22, 65.22, 65.055, 65.055, 64.9925, 64.9925, 64.945, 64.945, 64.76, 64.76, 64.8375, 64.8375, 65.2775, 65.2775, 64.9625, 64.9625, 65.0025, 65.0025, 65.3075, 65.3075, 65.345, 65.345, 64.8725, 64.8725, 65.23, 65.23, 64.8025, 64.8025, 64.7, 64.7, 64.8625, 64.8625, 65.15, 65.15, 65.375, 65.375, 65.41, 65.41, 65.62, 65.62, 65.4875, 65.4875, 65.565, 65.565, 65.64, 65.64, 65.285, 65.285, 65.1625, 65.1625, 65.2875, 65.2875, 64.925, 64.925, 64.875, 64.875, 64.8925, 64.8925, 65.3025, 65.3025, 64.8675, 64.8675, 64.8575, 64.8575, 64.8325, 64.8325, 64.7275, 64.7275, 64.96, 64.96, 65.09, 65.09, 65.0075, 65.0075, 65.0275, 65.0275]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.5  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.5000 
   Client 16, noise    level: 0.5000 
   Client 10, noise    level: 0.5000 
   Client 18, noise    level: 0.5000 
   Client 6, noise    level: 0.5000 
   Client 8, noise    level: 0.5000 
   Client 3, noise    level: 0.5000 
   Client 5, noise    level: 0.5000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.382, Test loss: 1.980, Test accuracy: 27.26
Round   0, Global train loss: 1.382, Global test loss: 2.273, Global test accuracy: 20.59
Round   1, Train loss: 1.342, Test loss: 1.580, Test accuracy: 39.91
Round   1, Global train loss: 1.342, Global test loss: 2.082, Global test accuracy: 23.25
Round   2, Train loss: 1.284, Test loss: 1.430, Test accuracy: 46.58
Round   2, Global train loss: 1.284, Global test loss: 2.059, Global test accuracy: 23.90
Round   3, Train loss: 1.248, Test loss: 1.301, Test accuracy: 51.62
Round   3, Global train loss: 1.248, Global test loss: 1.939, Global test accuracy: 33.88
Round   4, Train loss: 1.225, Test loss: 1.059, Test accuracy: 60.60
Round   4, Global train loss: 1.225, Global test loss: 2.056, Global test accuracy: 18.69
Round   5, Train loss: 1.190, Test loss: 0.963, Test accuracy: 64.94
Round   5, Global train loss: 1.190, Global test loss: 1.933, Global test accuracy: 29.86
Round   6, Train loss: 1.171, Test loss: 0.895, Test accuracy: 67.85
Round   6, Global train loss: 1.171, Global test loss: 1.876, Global test accuracy: 35.55
Round   7, Train loss: 0.834, Test loss: 0.871, Test accuracy: 68.82
Round   7, Global train loss: 0.834, Global test loss: 1.775, Global test accuracy: 38.99
Round   8, Train loss: 1.079, Test loss: 0.850, Test accuracy: 69.72
Round   8, Global train loss: 1.079, Global test loss: 1.754, Global test accuracy: 39.84
Round   9, Train loss: 1.087, Test loss: 0.845, Test accuracy: 70.50
Round   9, Global train loss: 1.087, Global test loss: 1.841, Global test accuracy: 36.79
Round  10, Train loss: 1.041, Test loss: 0.842, Test accuracy: 71.14
Round  10, Global train loss: 1.041, Global test loss: 1.710, Global test accuracy: 45.54
Round  11, Train loss: 1.111, Test loss: 0.814, Test accuracy: 72.28
Round  11, Global train loss: 1.111, Global test loss: 1.895, Global test accuracy: 35.41
Round  12, Train loss: 1.261, Test loss: 0.803, Test accuracy: 73.06
Round  12, Global train loss: 1.261, Global test loss: 1.705, Global test accuracy: 44.22
Round  13, Train loss: 1.052, Test loss: 0.786, Test accuracy: 73.67
Round  13, Global train loss: 1.052, Global test loss: 1.704, Global test accuracy: 39.84
Round  14, Train loss: 0.980, Test loss: 0.750, Test accuracy: 75.27
Round  14, Global train loss: 0.980, Global test loss: 1.641, Global test accuracy: 44.92
Round  15, Train loss: 0.993, Test loss: 0.752, Test accuracy: 75.71
Round  15, Global train loss: 0.993, Global test loss: 1.605, Global test accuracy: 46.76
Round  16, Train loss: 1.005, Test loss: 0.763, Test accuracy: 75.42
Round  16, Global train loss: 1.005, Global test loss: 1.672, Global test accuracy: 41.06
Round  17, Train loss: 0.809, Test loss: 0.763, Test accuracy: 75.74
Round  17, Global train loss: 0.809, Global test loss: 1.554, Global test accuracy: 44.91
Round  18, Train loss: 0.951, Test loss: 0.746, Test accuracy: 76.06
Round  18, Global train loss: 0.951, Global test loss: 1.526, Global test accuracy: 48.54
Round  19, Train loss: 0.966, Test loss: 0.719, Test accuracy: 76.77
Round  19, Global train loss: 0.966, Global test loss: 1.545, Global test accuracy: 47.30
Round  20, Train loss: 0.947, Test loss: 0.731, Test accuracy: 76.72
Round  20, Global train loss: 0.947, Global test loss: 1.476, Global test accuracy: 50.58
Round  21, Train loss: 0.950, Test loss: 0.737, Test accuracy: 76.53
Round  21, Global train loss: 0.950, Global test loss: 1.511, Global test accuracy: 49.31
Round  22, Train loss: 1.190, Test loss: 0.732, Test accuracy: 76.75
Round  22, Global train loss: 1.190, Global test loss: 1.642, Global test accuracy: 45.08
Round  23, Train loss: 1.037, Test loss: 0.717, Test accuracy: 77.51
Round  23, Global train loss: 1.037, Global test loss: 1.507, Global test accuracy: 50.38
Round  24, Train loss: 0.934, Test loss: 0.702, Test accuracy: 77.91
Round  24, Global train loss: 0.934, Global test loss: 1.477, Global test accuracy: 52.26
Round  25, Train loss: 0.850, Test loss: 0.707, Test accuracy: 78.29
Round  25, Global train loss: 0.850, Global test loss: 1.546, Global test accuracy: 47.90
Round  26, Train loss: 0.890, Test loss: 0.724, Test accuracy: 77.83
Round  26, Global train loss: 0.890, Global test loss: 1.450, Global test accuracy: 52.17
Round  27, Train loss: 0.933, Test loss: 0.713, Test accuracy: 77.50
Round  27, Global train loss: 0.933, Global test loss: 1.542, Global test accuracy: 49.50
Round  28, Train loss: 1.107, Test loss: 0.715, Test accuracy: 77.82
Round  28, Global train loss: 1.107, Global test loss: 1.590, Global test accuracy: 47.67
Round  29, Train loss: 0.707, Test loss: 0.743, Test accuracy: 77.19
Round  29, Global train loss: 0.707, Global test loss: 1.439, Global test accuracy: 51.84
Round  30, Train loss: 1.090, Test loss: 0.715, Test accuracy: 77.47
Round  30, Global train loss: 1.090, Global test loss: 1.517, Global test accuracy: 49.39
Round  31, Train loss: 0.767, Test loss: 0.694, Test accuracy: 78.48
Round  31, Global train loss: 0.767, Global test loss: 1.582, Global test accuracy: 45.29
Round  32, Train loss: 0.963, Test loss: 0.682, Test accuracy: 78.78
Round  32, Global train loss: 0.963, Global test loss: 1.634, Global test accuracy: 47.24
Round  33, Train loss: 0.781, Test loss: 0.683, Test accuracy: 78.72
Round  33, Global train loss: 0.781, Global test loss: 1.463, Global test accuracy: 51.03
Round  34, Train loss: 0.898, Test loss: 0.689, Test accuracy: 78.46
Round  34, Global train loss: 0.898, Global test loss: 1.436, Global test accuracy: 53.63
Round  35, Train loss: 0.733, Test loss: 0.703, Test accuracy: 78.28
Round  35, Global train loss: 0.733, Global test loss: 1.439, Global test accuracy: 52.17
Round  36, Train loss: 0.820, Test loss: 0.677, Test accuracy: 79.36
Round  36, Global train loss: 0.820, Global test loss: 1.519, Global test accuracy: 50.02
Round  37, Train loss: 0.912, Test loss: 0.690, Test accuracy: 78.70
Round  37, Global train loss: 0.912, Global test loss: 1.528, Global test accuracy: 49.13
Round  38, Train loss: 1.056, Test loss: 0.697, Test accuracy: 77.91
Round  38, Global train loss: 1.056, Global test loss: 1.572, Global test accuracy: 48.06
Round  39, Train loss: 0.674, Test loss: 0.670, Test accuracy: 78.74
Round  39, Global train loss: 0.674, Global test loss: 1.401, Global test accuracy: 52.17
Round  40, Train loss: 0.819, Test loss: 0.680, Test accuracy: 78.53
Round  40, Global train loss: 0.819, Global test loss: 1.425, Global test accuracy: 52.88
Round  41, Train loss: 0.514, Test loss: 0.692, Test accuracy: 78.58
Round  41, Global train loss: 0.514, Global test loss: 1.376, Global test accuracy: 53.27
Round  42, Train loss: 0.953, Test loss: 0.684, Test accuracy: 78.35
Round  42, Global train loss: 0.953, Global test loss: 1.497, Global test accuracy: 50.20
Round  43, Train loss: 0.836, Test loss: 0.685, Test accuracy: 78.20
Round  43, Global train loss: 0.836, Global test loss: 1.441, Global test accuracy: 52.70
Round  44, Train loss: 0.698, Test loss: 0.671, Test accuracy: 78.45
Round  44, Global train loss: 0.698, Global test loss: 1.432, Global test accuracy: 51.79
Round  45, Train loss: 0.649, Test loss: 0.677, Test accuracy: 78.38
Round  45, Global train loss: 0.649, Global test loss: 1.392, Global test accuracy: 52.61
Round  46, Train loss: 0.696, Test loss: 0.691, Test accuracy: 77.56
Round  46, Global train loss: 0.696, Global test loss: 1.425, Global test accuracy: 50.42
Round  47, Train loss: 0.575, Test loss: 0.697, Test accuracy: 77.33
Round  47, Global train loss: 0.575, Global test loss: 1.357, Global test accuracy: 53.69
Round  48, Train loss: 0.643, Test loss: 0.712, Test accuracy: 77.37
Round  48, Global train loss: 0.643, Global test loss: 1.411, Global test accuracy: 52.58
Round  49, Train loss: 1.021, Test loss: 0.682, Test accuracy: 77.90
Round  49, Global train loss: 1.021, Global test loss: 1.489, Global test accuracy: 51.07
Round  50, Train loss: 0.675, Test loss: 0.698, Test accuracy: 77.48
Round  50, Global train loss: 0.675, Global test loss: 1.429, Global test accuracy: 51.62
Round  51, Train loss: 0.772, Test loss: 0.708, Test accuracy: 77.71
Round  51, Global train loss: 0.772, Global test loss: 1.486, Global test accuracy: 49.66
Round  52, Train loss: 0.824, Test loss: 0.680, Test accuracy: 78.32
Round  52, Global train loss: 0.824, Global test loss: 1.728, Global test accuracy: 42.63
Round  53, Train loss: 0.678, Test loss: 0.681, Test accuracy: 78.34
Round  53, Global train loss: 0.678, Global test loss: 1.487, Global test accuracy: 50.27
Round  54, Train loss: 0.553, Test loss: 0.671, Test accuracy: 78.29
Round  54, Global train loss: 0.553, Global test loss: 1.492, Global test accuracy: 51.22
Round  55, Train loss: 0.544, Test loss: 0.692, Test accuracy: 77.94
Round  55, Global train loss: 0.544, Global test loss: 1.594, Global test accuracy: 47.58
Round  56, Train loss: 0.701, Test loss: 0.680, Test accuracy: 78.42
Round  56, Global train loss: 0.701, Global test loss: 1.448, Global test accuracy: 51.44
Round  57, Train loss: 0.790, Test loss: 0.693, Test accuracy: 77.91
Round  57, Global train loss: 0.790, Global test loss: 1.421, Global test accuracy: 53.66
Round  58, Train loss: 0.741, Test loss: 0.706, Test accuracy: 77.67
Round  58, Global train loss: 0.741, Global test loss: 1.464, Global test accuracy: 52.19
Round  59, Train loss: 0.680, Test loss: 0.690, Test accuracy: 78.08
Round  59, Global train loss: 0.680, Global test loss: 1.548, Global test accuracy: 51.39
Round  60, Train loss: 0.891, Test loss: 0.689, Test accuracy: 78.09
Round  60, Global train loss: 0.891, Global test loss: 1.519, Global test accuracy: 49.38
Round  61, Train loss: 0.697, Test loss: 0.673, Test accuracy: 78.51
Round  61, Global train loss: 0.697, Global test loss: 1.379, Global test accuracy: 53.49
Round  62, Train loss: 0.600, Test loss: 0.688, Test accuracy: 78.03
Round  62, Global train loss: 0.600, Global test loss: 1.608, Global test accuracy: 47.17
Round  63, Train loss: 0.606, Test loss: 0.696, Test accuracy: 77.87
Round  63, Global train loss: 0.606, Global test loss: 1.474, Global test accuracy: 52.97
Round  64, Train loss: 0.555, Test loss: 0.707, Test accuracy: 77.30
Round  64, Global train loss: 0.555, Global test loss: 1.718, Global test accuracy: 49.37
Round  65, Train loss: 0.551, Test loss: 0.703, Test accuracy: 77.32
Round  65, Global train loss: 0.551, Global test loss: 1.576, Global test accuracy: 52.64
Round  66, Train loss: 0.705, Test loss: 0.702, Test accuracy: 77.72
Round  66, Global train loss: 0.705, Global test loss: 1.425, Global test accuracy: 53.27
Round  67, Train loss: 0.597, Test loss: 0.704, Test accuracy: 77.58
Round  67, Global train loss: 0.597, Global test loss: 1.597, Global test accuracy: 50.75
Round  68, Train loss: 0.588, Test loss: 0.729, Test accuracy: 77.06
Round  68, Global train loss: 0.588, Global test loss: 1.429, Global test accuracy: 54.42
Round  69, Train loss: 0.614, Test loss: 0.756, Test accuracy: 76.22
Round  69, Global train loss: 0.614, Global test loss: 1.539, Global test accuracy: 51.02
Round  70, Train loss: 0.557, Test loss: 0.768, Test accuracy: 76.03
Round  70, Global train loss: 0.557, Global test loss: 1.568, Global test accuracy: 51.26
Round  71, Train loss: 0.615, Test loss: 0.734, Test accuracy: 76.70
Round  71, Global train loss: 0.615, Global test loss: 1.464, Global test accuracy: 52.24
Round  72, Train loss: 0.706, Test loss: 0.735, Test accuracy: 76.66
Round  72, Global train loss: 0.706, Global test loss: 1.565, Global test accuracy: 52.01
Round  73, Train loss: 0.443, Test loss: 0.753, Test accuracy: 76.05
Round  73, Global train loss: 0.443, Global test loss: 1.512, Global test accuracy: 53.27
Round  74, Train loss: 0.712, Test loss: 0.773, Test accuracy: 75.97
Round  74, Global train loss: 0.712, Global test loss: 1.573, Global test accuracy: 51.05
Round  75, Train loss: 0.562, Test loss: 0.789, Test accuracy: 75.62
Round  75, Global train loss: 0.562, Global test loss: 1.690, Global test accuracy: 49.85
Round  76, Train loss: 0.434, Test loss: 0.771, Test accuracy: 76.18
Round  76, Global train loss: 0.434, Global test loss: 1.528, Global test accuracy: 50.95
Round  77, Train loss: 0.631, Test loss: 0.775, Test accuracy: 75.62
Round  77, Global train loss: 0.631, Global test loss: 1.690, Global test accuracy: 50.01
Round  78, Train loss: 0.658, Test loss: 0.772, Test accuracy: 75.99
Round  78, Global train loss: 0.658, Global test loss: 1.522, Global test accuracy: 52.51
Round  79, Train loss: 0.772, Test loss: 0.745, Test accuracy: 76.12
Round  79, Global train loss: 0.772, Global test loss: 1.563, Global test accuracy: 50.83
Round  80, Train loss: 0.528, Test loss: 0.738, Test accuracy: 76.70
Round  80, Global train loss: 0.528, Global test loss: 1.643, Global test accuracy: 51.42
Round  81, Train loss: 0.590, Test loss: 0.758, Test accuracy: 76.44
Round  81, Global train loss: 0.590, Global test loss: 1.510, Global test accuracy: 53.08
Round  82, Train loss: 0.477, Test loss: 0.778, Test accuracy: 76.17
Round  82, Global train loss: 0.477, Global test loss: 1.742, Global test accuracy: 47.48
Round  83, Train loss: 0.420, Test loss: 0.782, Test accuracy: 76.13
Round  83, Global train loss: 0.420, Global test loss: 1.481, Global test accuracy: 53.89
Round  84, Train loss: 0.514, Test loss: 0.794, Test accuracy: 75.83
Round  84, Global train loss: 0.514, Global test loss: 1.721, Global test accuracy: 52.71
Round  85, Train loss: 0.529, Test loss: 0.819, Test accuracy: 75.64
Round  85, Global train loss: 0.529, Global test loss: 1.659, Global test accuracy: 51.15
Round  86, Train loss: 0.477, Test loss: 0.817, Test accuracy: 75.90
Round  86, Global train loss: 0.477, Global test loss: 1.594, Global test accuracy: 52.15
Round  87, Train loss: 0.520, Test loss: 0.804, Test accuracy: 76.05
Round  87, Global train loss: 0.520, Global test loss: 1.562, Global test accuracy: 52.68
Round  88, Train loss: 0.565, Test loss: 0.749, Test accuracy: 76.78
Round  88, Global train loss: 0.565, Global test loss: 1.467, Global test accuracy: 54.26
Round  89, Train loss: 0.590, Test loss: 0.782, Test accuracy: 76.13
Round  89, Global train loss: 0.590, Global test loss: 1.604, Global test accuracy: 50.90
Round  90, Train loss: 0.461, Test loss: 0.747, Test accuracy: 76.61
Round  90, Global train loss: 0.461, Global test loss: 1.614, Global test accuracy: 51.54
Round  91, Train loss: 0.491, Test loss: 0.750, Test accuracy: 76.68
Round  91, Global train loss: 0.491, Global test loss: 1.837, Global test accuracy: 47.12
Round  92, Train loss: 0.479, Test loss: 0.765, Test accuracy: 76.26
Round  92, Global train loss: 0.479, Global test loss: 1.575, Global test accuracy: 50.09
Round  93, Train loss: 0.701, Test loss: 0.771, Test accuracy: 76.47
Round  93, Global train loss: 0.701, Global test loss: 1.607, Global test accuracy: 49.03
Round  94, Train loss: 0.450, Test loss: 0.762, Test accuracy: 76.47
Round  94, Global train loss: 0.450, Global test loss: 1.531, Global test accuracy: 53.74
Round  95, Train loss: 0.500, Test loss: 0.770, Test accuracy: 76.28
Round  95, Global train loss: 0.500, Global test loss: 1.635, Global test accuracy: 51.58
Round  96, Train loss: 0.374, Test loss: 0.789, Test accuracy: 76.00
Round  96, Global train loss: 0.374, Global test loss: 1.639, Global test accuracy: 54.61
Round  97, Train loss: 0.414, Test loss: 0.780, Test accuracy: 76.22
Round  97, Global train loss: 0.414, Global test loss: 1.620, Global test accuracy: 54.36
Round  98, Train loss: 0.364, Test loss: 0.784, Test accuracy: 76.30
Round  98, Global train loss: 0.364, Global test loss: 1.625, Global test accuracy: 53.74
Round  99, Train loss: 0.762, Test loss: 0.791, Test accuracy: 75.96
Round  99, Global train loss: 0.762, Global test loss: 1.576, Global test accuracy: 50.33
Final Round, Train loss: 0.414, Test loss: 0.825, Test accuracy: 75.94
Final Round, Global train loss: 0.414, Global test loss: 1.576, Global test accuracy: 50.33
Average accuracy final 10 rounds: 76.32416666666667 

Average global accuracy final 10 rounds: 51.615 

1841.2632701396942
[1.674043893814087, 3.348087787628174, 4.720028400421143, 6.091969013214111, 7.4665608406066895, 8.841152667999268, 10.220700025558472, 11.600247383117676, 12.971369504928589, 14.342491626739502, 15.709644079208374, 17.076796531677246, 18.445921897888184, 19.81504726409912, 21.181329250335693, 22.547611236572266, 23.90987277030945, 25.27213430404663, 26.63923192024231, 28.00632953643799, 29.372530937194824, 30.73873233795166, 32.10784721374512, 33.476962089538574, 34.852370500564575, 36.227778911590576, 37.596534729003906, 38.965290546417236, 40.3331937789917, 41.70109701156616, 43.072903633117676, 44.44471025466919, 45.81377816200256, 47.18284606933594, 48.559873819351196, 49.936901569366455, 51.30665850639343, 52.67641544342041, 54.046430826187134, 55.41644620895386, 56.786465644836426, 58.156485080718994, 59.525447845458984, 60.894410610198975, 62.26291275024414, 63.63141489028931, 64.9995346069336, 66.36765432357788, 67.73548769950867, 69.10332107543945, 70.47844696044922, 71.85357284545898, 73.21971487998962, 74.58585691452026, 75.95919513702393, 77.33253335952759, 78.70170593261719, 80.07087850570679, 81.47049951553345, 82.87012052536011, 84.23425579071045, 85.59839105606079, 86.96377658843994, 88.32916212081909, 89.75550389289856, 91.18184566497803, 92.54744982719421, 93.9130539894104, 95.28032374382019, 96.64759349822998, 98.01108646392822, 99.37457942962646, 100.76504635810852, 102.15551328659058, 103.52296280860901, 104.89041233062744, 106.26186609268188, 107.63331985473633, 109.00144076347351, 110.3695616722107, 111.74226784706116, 113.11497402191162, 114.48654198646545, 115.85810995101929, 117.22981071472168, 118.60151147842407, 119.96831464767456, 121.33511781692505, 122.70522952079773, 124.07534122467041, 125.44355058670044, 126.81175994873047, 128.1835901737213, 129.55542039871216, 130.92976570129395, 132.30411100387573, 133.67465782165527, 135.04520463943481, 136.41450881958008, 137.78381299972534, 139.1550281047821, 140.52624320983887, 141.8968915939331, 143.26753997802734, 144.63365292549133, 145.99976587295532, 147.37059617042542, 148.7414264678955, 150.11278223991394, 151.48413801193237, 152.85603642463684, 154.2279348373413, 155.60043120384216, 156.97292757034302, 158.33922743797302, 159.70552730560303, 161.08013129234314, 162.45473527908325, 163.82669591903687, 165.19865655899048, 166.56633496284485, 167.93401336669922, 169.30787777900696, 170.6817421913147, 172.04871010780334, 173.415678024292, 174.7876012325287, 176.15952444076538, 177.52496528625488, 178.89040613174438, 180.26019835472107, 181.62999057769775, 183.0018105506897, 184.37363052368164, 185.74371194839478, 187.1137933731079, 188.48540663719177, 189.85701990127563, 191.223788022995, 192.59055614471436, 193.9635591506958, 195.33656215667725, 196.7003517150879, 198.06414127349854, 199.43428301811218, 200.80442476272583, 202.17413091659546, 203.5438370704651, 204.90494084358215, 206.26604461669922, 207.63734817504883, 209.00865173339844, 210.36396169662476, 211.71927165985107, 213.08029103279114, 214.4413104057312, 215.80283856391907, 217.16436672210693, 218.52164435386658, 219.87892198562622, 221.24074125289917, 222.60256052017212, 223.9584038257599, 225.31424713134766, 226.6769688129425, 228.03969049453735, 229.39499235153198, 230.7502942085266, 232.10207295417786, 233.4538516998291, 234.81247901916504, 236.17110633850098, 237.55384588241577, 238.93658542633057, 240.29888105392456, 241.66117668151855, 243.02640581130981, 244.39163494110107, 245.75292706489563, 247.11421918869019, 248.47503781318665, 249.8358564376831, 251.20335340499878, 252.57085037231445, 254.1144003868103, 255.65795040130615, 257.19574785232544, 258.7335453033447, 260.27521443367004, 261.81688356399536, 263.3576786518097, 264.898473739624, 266.446683883667, 267.99489402770996, 269.5432639122009, 271.0916337966919, 272.64624643325806, 274.2008590698242, 275.7431547641754, 277.2854504585266, 279.8668773174286, 282.44830417633057]
[27.258333333333333, 27.258333333333333, 39.90833333333333, 39.90833333333333, 46.583333333333336, 46.583333333333336, 51.61666666666667, 51.61666666666667, 60.6, 60.6, 64.94166666666666, 64.94166666666666, 67.85, 67.85, 68.81666666666666, 68.81666666666666, 69.71666666666667, 69.71666666666667, 70.5, 70.5, 71.14166666666667, 71.14166666666667, 72.275, 72.275, 73.05833333333334, 73.05833333333334, 73.675, 73.675, 75.26666666666667, 75.26666666666667, 75.70833333333333, 75.70833333333333, 75.425, 75.425, 75.74166666666666, 75.74166666666666, 76.05833333333334, 76.05833333333334, 76.76666666666667, 76.76666666666667, 76.725, 76.725, 76.525, 76.525, 76.75, 76.75, 77.50833333333334, 77.50833333333334, 77.90833333333333, 77.90833333333333, 78.29166666666667, 78.29166666666667, 77.825, 77.825, 77.5, 77.5, 77.81666666666666, 77.81666666666666, 77.19166666666666, 77.19166666666666, 77.475, 77.475, 78.48333333333333, 78.48333333333333, 78.78333333333333, 78.78333333333333, 78.725, 78.725, 78.45833333333333, 78.45833333333333, 78.28333333333333, 78.28333333333333, 79.35833333333333, 79.35833333333333, 78.7, 78.7, 77.90833333333333, 77.90833333333333, 78.74166666666666, 78.74166666666666, 78.525, 78.525, 78.58333333333333, 78.58333333333333, 78.35, 78.35, 78.2, 78.2, 78.45, 78.45, 78.38333333333334, 78.38333333333334, 77.55833333333334, 77.55833333333334, 77.33333333333333, 77.33333333333333, 77.36666666666666, 77.36666666666666, 77.9, 77.9, 77.48333333333333, 77.48333333333333, 77.70833333333333, 77.70833333333333, 78.31666666666666, 78.31666666666666, 78.34166666666667, 78.34166666666667, 78.29166666666667, 78.29166666666667, 77.94166666666666, 77.94166666666666, 78.425, 78.425, 77.90833333333333, 77.90833333333333, 77.66666666666667, 77.66666666666667, 78.075, 78.075, 78.09166666666667, 78.09166666666667, 78.50833333333334, 78.50833333333334, 78.03333333333333, 78.03333333333333, 77.86666666666666, 77.86666666666666, 77.3, 77.3, 77.31666666666666, 77.31666666666666, 77.725, 77.725, 77.58333333333333, 77.58333333333333, 77.05833333333334, 77.05833333333334, 76.21666666666667, 76.21666666666667, 76.025, 76.025, 76.7, 76.7, 76.65833333333333, 76.65833333333333, 76.05, 76.05, 75.975, 75.975, 75.625, 75.625, 76.18333333333334, 76.18333333333334, 75.61666666666666, 75.61666666666666, 75.99166666666666, 75.99166666666666, 76.11666666666666, 76.11666666666666, 76.7, 76.7, 76.44166666666666, 76.44166666666666, 76.16666666666667, 76.16666666666667, 76.13333333333334, 76.13333333333334, 75.83333333333333, 75.83333333333333, 75.64166666666667, 75.64166666666667, 75.9, 75.9, 76.05, 76.05, 76.78333333333333, 76.78333333333333, 76.13333333333334, 76.13333333333334, 76.60833333333333, 76.60833333333333, 76.68333333333334, 76.68333333333334, 76.25833333333334, 76.25833333333334, 76.46666666666667, 76.46666666666667, 76.46666666666667, 76.46666666666667, 76.28333333333333, 76.28333333333333, 76.0, 76.0, 76.21666666666667, 76.21666666666667, 76.3, 76.3, 75.95833333333333, 75.95833333333333, 75.94166666666666, 75.94166666666666]/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Co-teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.5000 
   Client 4, noise    level: 0.5000 
   Client 5, noise    level: 0.5000 
   Client 14, noise    level: 0.5000 
   Client 6, noise    level: 0.5000 
   Client 9, noise    level: 0.5000 
   Client 19, noise    level: 0.5000 
   Client 12, noise    level: 0.5000 
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.520, Test loss: 2.204, Test accuracy: 24.14
Round   1, Train loss: 0.988, Test loss: 1.765, Test accuracy: 35.30
Round   2, Train loss: 0.951, Test loss: 1.594, Test accuracy: 42.48
Round   3, Train loss: 0.826, Test loss: 1.357, Test accuracy: 49.06
Round   4, Train loss: 0.905, Test loss: 1.029, Test accuracy: 62.73
Round   5, Train loss: 0.686, Test loss: 0.804, Test accuracy: 66.53
Round   6, Train loss: 0.717, Test loss: 0.723, Test accuracy: 69.48
Round   7, Train loss: 0.597, Test loss: 0.688, Test accuracy: 71.58
Round   8, Train loss: 0.669, Test loss: 0.670, Test accuracy: 72.47
Round   9, Train loss: 0.612, Test loss: 0.655, Test accuracy: 72.11
Round  10, Train loss: 0.691, Test loss: 0.631, Test accuracy: 74.45
Round  11, Train loss: 0.582, Test loss: 0.613, Test accuracy: 74.49
Round  12, Train loss: 0.627, Test loss: 0.589, Test accuracy: 75.86
Round  13, Train loss: 0.632, Test loss: 0.577, Test accuracy: 76.72
Round  14, Train loss: 0.654, Test loss: 0.564, Test accuracy: 77.72
Round  15, Train loss: 0.594, Test loss: 0.533, Test accuracy: 79.02
Round  16, Train loss: 0.539, Test loss: 0.541, Test accuracy: 78.73
Round  17, Train loss: 0.480, Test loss: 0.530, Test accuracy: 78.69
Round  18, Train loss: 0.544, Test loss: 0.523, Test accuracy: 78.83
Round  19, Train loss: 0.567, Test loss: 0.508, Test accuracy: 79.61
Round  20, Train loss: 0.546, Test loss: 0.491, Test accuracy: 80.81
Round  21, Train loss: 0.476, Test loss: 0.487, Test accuracy: 80.72
Round  22, Train loss: 0.564, Test loss: 0.484, Test accuracy: 81.09
Round  23, Train loss: 0.541, Test loss: 0.480, Test accuracy: 80.57
Round  24, Train loss: 0.527, Test loss: 0.460, Test accuracy: 81.57
Round  25, Train loss: 0.440, Test loss: 0.466, Test accuracy: 81.63
Round  26, Train loss: 0.483, Test loss: 0.458, Test accuracy: 81.62
Round  27, Train loss: 0.401, Test loss: 0.461, Test accuracy: 81.46
Round  28, Train loss: 0.567, Test loss: 0.458, Test accuracy: 81.88
Round  29, Train loss: 0.393, Test loss: 0.455, Test accuracy: 82.08
Round  30, Train loss: 0.499, Test loss: 0.460, Test accuracy: 82.06
Round  31, Train loss: 0.468, Test loss: 0.457, Test accuracy: 82.02
Round  32, Train loss: 0.437, Test loss: 0.438, Test accuracy: 82.62
Round  33, Train loss: 0.392, Test loss: 0.432, Test accuracy: 82.94
Round  34, Train loss: 0.447, Test loss: 0.441, Test accuracy: 82.72
Round  35, Train loss: 0.429, Test loss: 0.435, Test accuracy: 83.22
Round  36, Train loss: 0.453, Test loss: 0.422, Test accuracy: 83.34
Round  37, Train loss: 0.456, Test loss: 0.428, Test accuracy: 83.23
Round  38, Train loss: 0.544, Test loss: 0.433, Test accuracy: 83.19
Round  39, Train loss: 0.314, Test loss: 0.427, Test accuracy: 83.29
Round  40, Train loss: 0.401, Test loss: 0.421, Test accuracy: 83.45
Round  41, Train loss: 0.359, Test loss: 0.410, Test accuracy: 83.73
Round  42, Train loss: 0.431, Test loss: 0.406, Test accuracy: 83.81
Round  43, Train loss: 0.359, Test loss: 0.408, Test accuracy: 83.96
Round  44, Train loss: 0.400, Test loss: 0.403, Test accuracy: 84.27
Round  45, Train loss: 0.363, Test loss: 0.400, Test accuracy: 84.23
Round  46, Train loss: 0.356, Test loss: 0.409, Test accuracy: 83.66
Round  47, Train loss: 0.363, Test loss: 0.398, Test accuracy: 84.14
Round  48, Train loss: 0.325, Test loss: 0.388, Test accuracy: 84.49
Round  49, Train loss: 0.374, Test loss: 0.399, Test accuracy: 84.08
Round  50, Train loss: 0.377, Test loss: 0.395, Test accuracy: 84.49
Round  51, Train loss: 0.419, Test loss: 0.388, Test accuracy: 84.76
Round  52, Train loss: 0.473, Test loss: 0.397, Test accuracy: 84.40
Round  53, Train loss: 0.397, Test loss: 0.395, Test accuracy: 84.36
Round  54, Train loss: 0.341, Test loss: 0.385, Test accuracy: 84.77
Round  55, Train loss: 0.386, Test loss: 0.390, Test accuracy: 84.71
Round  56, Train loss: 0.313, Test loss: 0.391, Test accuracy: 84.77
Round  57, Train loss: 0.345, Test loss: 0.379, Test accuracy: 85.23
Round  58, Train loss: 0.274, Test loss: 0.380, Test accuracy: 85.01
Round  59, Train loss: 0.275, Test loss: 0.381, Test accuracy: 85.10
Round  60, Train loss: 0.296, Test loss: 0.386, Test accuracy: 84.64
Round  61, Train loss: 0.305, Test loss: 0.378, Test accuracy: 85.28
Round  62, Train loss: 0.282, Test loss: 0.375, Test accuracy: 85.21
Round  63, Train loss: 0.245, Test loss: 0.371, Test accuracy: 85.52
Round  64, Train loss: 0.312, Test loss: 0.370, Test accuracy: 85.63
Round  65, Train loss: 0.286, Test loss: 0.369, Test accuracy: 85.72
Round  66, Train loss: 0.357, Test loss: 0.375, Test accuracy: 85.33
Round  67, Train loss: 0.336, Test loss: 0.374, Test accuracy: 85.32
Round  68, Train loss: 0.336, Test loss: 0.369, Test accuracy: 85.64
Round  69, Train loss: 0.277, Test loss: 0.376, Test accuracy: 85.41
Round  70, Train loss: 0.277, Test loss: 0.365, Test accuracy: 85.97
Round  71, Train loss: 0.298, Test loss: 0.364, Test accuracy: 85.69
Round  72, Train loss: 0.340, Test loss: 0.367, Test accuracy: 85.49
Round  73, Train loss: 0.264, Test loss: 0.366, Test accuracy: 85.48
Round  74, Train loss: 0.339, Test loss: 0.367, Test accuracy: 85.61
Round  75, Train loss: 0.295, Test loss: 0.371, Test accuracy: 85.47
Round  76, Train loss: 0.227, Test loss: 0.359, Test accuracy: 86.03
Round  77, Train loss: 0.257, Test loss: 0.364, Test accuracy: 85.85
Round  78, Train loss: 0.346, Test loss: 0.360, Test accuracy: 85.94
Round  79, Train loss: 0.301, Test loss: 0.356, Test accuracy: 86.11
Round  80, Train loss: 0.274, Test loss: 0.364, Test accuracy: 85.77
Round  81, Train loss: 0.292, Test loss: 0.365, Test accuracy: 86.08
Round  82, Train loss: 0.242, Test loss: 0.363, Test accuracy: 86.07
Round  83, Train loss: 0.224, Test loss: 0.361, Test accuracy: 86.22
Round  84, Train loss: 0.249, Test loss: 0.357, Test accuracy: 86.14
Round  85, Train loss: 0.300, Test loss: 0.360, Test accuracy: 86.08
Round  86, Train loss: 0.230, Test loss: 0.367, Test accuracy: 86.08
Round  87, Train loss: 0.264, Test loss: 0.357, Test accuracy: 86.22
Round  88, Train loss: 0.301, Test loss: 0.368, Test accuracy: 85.73
Round  89, Train loss: 0.284, Test loss: 0.360, Test accuracy: 86.07
Round  90, Train loss: 0.272, Test loss: 0.363, Test accuracy: 86.18
Round  91, Train loss: 0.244, Test loss: 0.361, Test accuracy: 86.09
Round  92, Train loss: 0.248, Test loss: 0.359, Test accuracy: 86.17
Round  93, Train loss: 0.350, Test loss: 0.366, Test accuracy: 85.86
Round  94, Train loss: 0.242, Test loss: 0.359, Test accuracy: 85.97
Round  95, Train loss: 0.201, Test loss: 0.358, Test accuracy: 86.23
Round  96, Train loss: 0.220, Test loss: 0.354, Test accuracy: 86.57
Round  97, Train loss: 0.189, Test loss: 0.361, Test accuracy: 86.42
Round  98, Train loss: 0.194, Test loss: 0.357, Test accuracy: 86.36
Round  99, Train loss: 0.325, Test loss: 0.360, Test accuracy: 86.15
Final Round, Train loss: 0.203, Test loss: 0.362, Test accuracy: 86.55
Average accuracy final 10 rounds: 86.2
1290.1971969604492
[1.8974685668945312, 3.471301794052124, 5.058354377746582, 6.649451494216919, 8.27574348449707, 9.94288182258606, 11.59287142753601, 13.237253665924072, 14.877197742462158, 16.538893699645996, 18.19053053855896, 19.844744205474854, 21.475260019302368, 23.10565996170044, 24.763561725616455, 26.41908288002014, 28.06895899772644, 29.726970195770264, 31.385589599609375, 33.019246101379395, 34.64533591270447, 36.27547001838684, 37.89945864677429, 39.52417969703674, 41.1622896194458, 42.7990927696228, 44.439563035964966, 46.07294726371765, 47.70704245567322, 49.352113485336304, 50.99113941192627, 52.63346719741821, 54.28072142601013, 55.927030086517334, 57.57300782203674, 59.21116352081299, 60.8504102230072, 62.488019943237305, 64.12226891517639, 65.7699511051178, 67.41707158088684, 69.06480884552002, 70.69671273231506, 72.34818816184998, 73.99733853340149, 75.62929081916809, 77.25452184677124, 78.8957769870758, 80.54117608070374, 82.16936588287354, 83.80853915214539, 85.45591592788696, 87.09902453422546, 88.73855805397034, 90.37812232971191, 92.02541065216064, 93.65888690948486, 95.30129361152649, 96.9320330619812, 98.55718636512756, 100.17930912971497, 101.77350735664368, 103.27130270004272, 104.74983882904053, 106.2331964969635, 107.72280621528625, 109.20720291137695, 110.7085108757019, 112.21723985671997, 113.69115138053894, 115.19051790237427, 116.69908452033997, 118.18558764457703, 119.67781686782837, 121.17410445213318, 122.67691659927368, 124.15513372421265, 125.6406478881836, 127.1114513874054, 128.61366820335388, 130.11940670013428, 131.62003231048584, 133.13246989250183, 134.65841126441956, 136.16844654083252, 137.67290234565735, 139.20446467399597, 140.72320413589478, 142.20711398124695, 143.7188732624054, 145.23356652259827, 146.75144386291504, 148.27242636680603, 149.7890226840973, 151.3119466304779, 152.81216049194336, 154.33223152160645, 155.82947635650635, 157.3458149433136, 158.85194516181946, 160.84307074546814]
[24.141666666666666, 35.3, 42.475, 49.05833333333333, 62.725, 66.525, 69.48333333333333, 71.575, 72.46666666666667, 72.10833333333333, 74.45, 74.49166666666666, 75.85833333333333, 76.725, 77.71666666666667, 79.01666666666667, 78.73333333333333, 78.69166666666666, 78.825, 79.60833333333333, 80.80833333333334, 80.71666666666667, 81.09166666666667, 80.56666666666666, 81.56666666666666, 81.63333333333334, 81.61666666666666, 81.45833333333333, 81.875, 82.08333333333333, 82.05833333333334, 82.01666666666667, 82.61666666666666, 82.94166666666666, 82.725, 83.21666666666667, 83.34166666666667, 83.23333333333333, 83.19166666666666, 83.29166666666667, 83.45, 83.73333333333333, 83.80833333333334, 83.95833333333333, 84.26666666666667, 84.23333333333333, 83.65833333333333, 84.14166666666667, 84.49166666666666, 84.08333333333333, 84.49166666666666, 84.75833333333334, 84.4, 84.35833333333333, 84.76666666666667, 84.70833333333333, 84.76666666666667, 85.23333333333333, 85.00833333333334, 85.1, 84.64166666666667, 85.28333333333333, 85.20833333333333, 85.51666666666667, 85.63333333333334, 85.725, 85.33333333333333, 85.31666666666666, 85.64166666666667, 85.40833333333333, 85.975, 85.69166666666666, 85.49166666666666, 85.48333333333333, 85.60833333333333, 85.46666666666667, 86.025, 85.85, 85.94166666666666, 86.10833333333333, 85.76666666666667, 86.075, 86.06666666666666, 86.225, 86.14166666666667, 86.075, 86.075, 86.225, 85.73333333333333, 86.06666666666666, 86.18333333333334, 86.09166666666667, 86.175, 85.85833333333333, 85.96666666666667, 86.23333333333333, 86.56666666666666, 86.41666666666667, 86.35833333333333, 86.15, 86.55]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.5000 
   Client 10, noise    level: 0.5000 
   Client 5, noise    level: 0.5000 
   Client 11, noise    level: 0.5000 
   Client 1, noise    level: 0.5000 
   Client 6, noise    level: 0.5000 
   Client 18, noise    level: 0.5000 
   Client 8, noise    level: 0.5000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  15.6100
Round 1 global test acc  18.0300
Round 2 global test acc  18.5000
Round 3 global test acc  23.6700
Round 4 global test acc  22.4100
Round 5 global test acc  21.1100
Round 6 global test acc  21.5500
Round 7 global test acc  20.3100
Round 8 global test acc  23.9800
Round 9 global test acc  22.8300
Round 10 global test acc  26.7900
Round 11 global test acc  31.5800
Round 12 global test acc  15.5300
Round 13 global test acc  28.9300
Round 14 global test acc  30.8900
Round 15 global test acc  30.7300
Round 16 global test acc  28.4200
Round 17 global test acc  25.2900
Round 18 global test acc  28.1200
Round 19 global test acc  25.1400
Round 20 global test acc  30.8200
Round 21 global test acc  25.1500
Round 22 global test acc  26.5900
Round 23 global test acc  27.1600
Round 24 global test acc  29.9700
Round 25 global test acc  23.9600
Round 26 global test acc  25.6200
Round 27 global test acc  20.9100
Round 28 global test acc  34.5200
Round 29 global test acc  29.3400
Round 30 global test acc  24.6100
Round 31 global test acc  28.0200
Round 32 global test acc  27.9200
Round 33 global test acc  34.8600
Round 34 global test acc  29.4900
Round 35 global test acc  34.0100
Round 36 global test acc  36.5000
Round 37 global test acc  34.9200
Round 38 global test acc  28.9900
Round 39 global test acc  31.6500
Round 40 global test acc  32.3600
Round 41 global test acc  33.0700
Round 42 global test acc  37.2500
Round 43 global test acc  28.3800
Round 44 global test acc  21.7900
Round 45 global test acc  38.0800
Round 46 global test acc  30.3700
Round 47 global test acc  21.3800
Round 48 global test acc  26.4300
Round 49 global test acc  34.9600
Round 50 global test acc  30.6800
Round 51 global test acc  37.5000
Round 52 global test acc  30.2200
Round 53 global test acc  23.5600
Round 54 global test acc  37.8100
Round 55 global test acc  40.5800
Round 56 global test acc  41.3900
Round 57 global test acc  36.9600
Round 58 global test acc  33.9400
Round 59 global test acc  33.1900
Round 60 global test acc  32.8900
Round 61 global test acc  40.2500
Round 62 global test acc  36.1000
Round 63 global test acc  29.8500
Round 64 global test acc  24.8000
Round 65 global test acc  35.7200
Round 66 global test acc  20.5900
Round 67 global test acc  36.5800
Round 68 global test acc  26.9900
Round 69 global test acc  29.6200
Round 70 global test acc  31.7900
Round 71 global test acc  37.5600
Round 72 global test acc  33.1200
Round 73 global test acc  27.4400
Round 74 global test acc  33.9800
Round 75 global test acc  27.4300
Round 76 global test acc  37.6900
Round 77 global test acc  30.6900
Round 78 global test acc  35.9000
Round 79 global test acc  30.8300
Round 80 global test acc  29.4300
Round 81 global test acc  32.0700
Round 82 global test acc  29.7700
Round 83 global test acc  28.2100
Round 84 global test acc  25.7600
Round 85 global test acc  25.9300
Round 86 global test acc  27.3100
Round 87 global test acc  27.2900
Round 88 global test acc  27.3600
Round 89 global test acc  24.3600
Round 90 global test acc  27.2400
Round 91 global test acc  26.6000
Round 92 global test acc  22.5700
Round 93 global test acc  24.8600
Round 94 global test acc  25.2800
Round 95 global test acc  23.2900
Round 96 global test acc  24.0700
Round 97 global test acc  25.1100
Round 98 global test acc  23.5200
Round 99 global test acc  23.6900
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.5000 
   Client 10, noise    level: 0.5000 
   Client 1, noise    level: 0.5000 
   Client 11, noise    level: 0.5000 
   Client 18, noise    level: 0.5000 
   Client 2, noise    level: 0.5000 
   Client 5, noise    level: 0.5000 
   Client 19, noise    level: 0.5000 
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.230, Test loss: 2.075, Test accuracy: 29.99
Round   1, Train loss: 2.014, Test loss: 1.800, Test accuracy: 37.12
Round   2, Train loss: 1.855, Test loss: 1.702, Test accuracy: 41.49
Round   3, Train loss: 1.831, Test loss: 1.638, Test accuracy: 44.35
Round   4, Train loss: 1.789, Test loss: 1.571, Test accuracy: 46.78
Round   5, Train loss: 1.702, Test loss: 1.490, Test accuracy: 49.73
Round   6, Train loss: 1.638, Test loss: 1.458, Test accuracy: 51.20
Round   7, Train loss: 1.643, Test loss: 1.437, Test accuracy: 53.24
Round   8, Train loss: 1.639, Test loss: 1.422, Test accuracy: 54.28
Round   9, Train loss: 1.632, Test loss: 1.362, Test accuracy: 56.36
Round  10, Train loss: 1.582, Test loss: 1.329, Test accuracy: 56.99
Round  11, Train loss: 1.499, Test loss: 1.275, Test accuracy: 58.26
Round  12, Train loss: 1.443, Test loss: 1.258, Test accuracy: 59.20
Round  13, Train loss: 1.480, Test loss: 1.253, Test accuracy: 60.33
Round  14, Train loss: 1.446, Test loss: 1.226, Test accuracy: 61.02
Round  15, Train loss: 1.443, Test loss: 1.200, Test accuracy: 61.84
Round  16, Train loss: 1.366, Test loss: 1.183, Test accuracy: 62.68
Round  17, Train loss: 1.456, Test loss: 1.181, Test accuracy: 63.24
Round  18, Train loss: 1.294, Test loss: 1.176, Test accuracy: 63.64
Round  19, Train loss: 1.439, Test loss: 1.153, Test accuracy: 63.80
Round  20, Train loss: 1.347, Test loss: 1.140, Test accuracy: 64.16
Round  21, Train loss: 1.453, Test loss: 1.110, Test accuracy: 64.91
Round  22, Train loss: 1.364, Test loss: 1.116, Test accuracy: 65.06
Round  23, Train loss: 1.289, Test loss: 1.085, Test accuracy: 65.92
Round  24, Train loss: 1.334, Test loss: 1.081, Test accuracy: 66.48
Round  25, Train loss: 1.264, Test loss: 1.068, Test accuracy: 66.48
Round  26, Train loss: 1.259, Test loss: 1.070, Test accuracy: 66.54
Round  27, Train loss: 1.206, Test loss: 1.051, Test accuracy: 67.14
Round  28, Train loss: 1.301, Test loss: 1.033, Test accuracy: 67.51
Round  29, Train loss: 1.272, Test loss: 1.028, Test accuracy: 67.67
Round  30, Train loss: 1.120, Test loss: 1.028, Test accuracy: 67.99
Round  31, Train loss: 1.251, Test loss: 1.023, Test accuracy: 68.05
Round  32, Train loss: 1.209, Test loss: 1.015, Test accuracy: 68.22
Round  33, Train loss: 1.173, Test loss: 1.025, Test accuracy: 68.63
Round  34, Train loss: 1.226, Test loss: 1.028, Test accuracy: 68.40
Round  35, Train loss: 1.286, Test loss: 1.019, Test accuracy: 68.37
Round  36, Train loss: 1.137, Test loss: 1.007, Test accuracy: 69.00
Round  37, Train loss: 1.187, Test loss: 1.004, Test accuracy: 68.97
Round  38, Train loss: 1.257, Test loss: 1.014, Test accuracy: 68.94
Round  39, Train loss: 1.164, Test loss: 0.999, Test accuracy: 69.31
Round  40, Train loss: 1.200, Test loss: 1.003, Test accuracy: 69.29
Round  41, Train loss: 1.205, Test loss: 0.992, Test accuracy: 69.43
Round  42, Train loss: 1.133, Test loss: 0.984, Test accuracy: 69.66
Round  43, Train loss: 1.116, Test loss: 0.973, Test accuracy: 69.76
Round  44, Train loss: 1.162, Test loss: 0.986, Test accuracy: 69.63
Round  45, Train loss: 1.088, Test loss: 0.991, Test accuracy: 69.08
Round  46, Train loss: 1.219, Test loss: 0.974, Test accuracy: 69.89
Round  47, Train loss: 1.072, Test loss: 0.968, Test accuracy: 69.69
Round  48, Train loss: 1.121, Test loss: 0.966, Test accuracy: 70.01
Round  49, Train loss: 1.102, Test loss: 0.967, Test accuracy: 69.94
Round  50, Train loss: 1.109, Test loss: 0.958, Test accuracy: 70.42
Round  51, Train loss: 1.152, Test loss: 0.957, Test accuracy: 70.59
Round  52, Train loss: 1.169, Test loss: 0.960, Test accuracy: 70.40
Round  53, Train loss: 1.045, Test loss: 0.953, Test accuracy: 70.34
Round  54, Train loss: 1.075, Test loss: 0.967, Test accuracy: 69.84
Round  55, Train loss: 1.148, Test loss: 0.944, Test accuracy: 70.53
Round  56, Train loss: 1.070, Test loss: 0.961, Test accuracy: 69.99
Round  57, Train loss: 1.154, Test loss: 0.949, Test accuracy: 70.30
Round  58, Train loss: 1.133, Test loss: 0.950, Test accuracy: 70.29
Round  59, Train loss: 0.996, Test loss: 0.939, Test accuracy: 70.50
Round  60, Train loss: 1.166, Test loss: 0.952, Test accuracy: 70.05
Round  61, Train loss: 1.097, Test loss: 0.947, Test accuracy: 70.46
Round  62, Train loss: 1.100, Test loss: 0.969, Test accuracy: 70.20
Round  63, Train loss: 1.026, Test loss: 0.947, Test accuracy: 70.72
Round  64, Train loss: 1.029, Test loss: 0.936, Test accuracy: 71.08
Round  65, Train loss: 1.142, Test loss: 0.930, Test accuracy: 71.21
Round  66, Train loss: 1.032, Test loss: 0.930, Test accuracy: 70.81
Round  67, Train loss: 1.160, Test loss: 0.938, Test accuracy: 70.99
Round  68, Train loss: 1.054, Test loss: 0.938, Test accuracy: 70.82
Round  69, Train loss: 1.052, Test loss: 0.933, Test accuracy: 71.14
Round  70, Train loss: 1.066, Test loss: 0.945, Test accuracy: 70.69
Round  71, Train loss: 1.041, Test loss: 0.940, Test accuracy: 71.10
Round  72, Train loss: 1.129, Test loss: 0.943, Test accuracy: 70.76
Round  73, Train loss: 1.086, Test loss: 0.937, Test accuracy: 70.80
Round  74, Train loss: 1.029, Test loss: 0.928, Test accuracy: 71.17
Round  75, Train loss: 0.994, Test loss: 0.932, Test accuracy: 70.96
Round  76, Train loss: 0.989, Test loss: 0.936, Test accuracy: 71.04
Round  77, Train loss: 1.017, Test loss: 0.913, Test accuracy: 71.72
Round  78, Train loss: 0.930, Test loss: 0.923, Test accuracy: 71.37
Round  79, Train loss: 1.024, Test loss: 0.934, Test accuracy: 71.14
Round  80, Train loss: 0.873, Test loss: 0.913, Test accuracy: 71.67
Round  81, Train loss: 1.061, Test loss: 0.933, Test accuracy: 71.27
Round  82, Train loss: 1.035, Test loss: 0.923, Test accuracy: 71.47
Round  83, Train loss: 1.022, Test loss: 0.929, Test accuracy: 71.22
Round  84, Train loss: 0.976, Test loss: 0.934, Test accuracy: 70.99
Round  85, Train loss: 1.036, Test loss: 0.915, Test accuracy: 71.47
Round  86, Train loss: 1.017, Test loss: 0.909, Test accuracy: 71.89
Round  87, Train loss: 0.893, Test loss: 0.923, Test accuracy: 71.39
Round  88, Train loss: 0.891, Test loss: 0.919, Test accuracy: 71.35
Round  89, Train loss: 0.977, Test loss: 0.925, Test accuracy: 71.35
Round  90, Train loss: 1.037, Test loss: 0.948, Test accuracy: 70.81
Round  91, Train loss: 1.011, Test loss: 0.930, Test accuracy: 71.19
Round  92, Train loss: 0.981, Test loss: 0.931, Test accuracy: 71.16
Round  93, Train loss: 0.960, Test loss: 0.926, Test accuracy: 71.28
Round  94, Train loss: 1.098, Test loss: 0.927, Test accuracy: 71.25
Round  95, Train loss: 0.885, Test loss: 0.931, Test accuracy: 71.31
Round  96, Train loss: 1.003, Test loss: 0.927, Test accuracy: 71.41
Round  97, Train loss: 0.961, Test loss: 0.937, Test accuracy: 71.23
Round  98, Train loss: 0.964, Test loss: 0.943, Test accuracy: 70.91
Round  99, Train loss: 0.958, Test loss: 0.943, Test accuracy: 71.07
Final Round, Train loss: 0.884, Test loss: 0.940, Test accuracy: 71.03
Average accuracy final 10 rounds: 71.16199999999999
4328.166865825653
[6.013420581817627, 11.751804113388062, 17.353084325790405, 22.982359409332275, 28.686034202575684, 34.4111225605011, 40.160499572753906, 45.755478382110596, 51.38455033302307, 57.11581492424011, 62.8284478187561, 68.5002977848053, 74.18157982826233, 79.39161515235901, 84.53203463554382, 89.65863466262817, 94.77713251113892, 99.90824627876282, 105.0052318572998, 110.12460732460022, 115.24762678146362, 120.51318883895874, 125.60843110084534, 130.72401070594788, 135.85132908821106, 140.98781299591064, 146.11841201782227, 151.20282006263733, 156.31948828697205, 161.432434797287, 166.5390763282776, 172.02553796768188, 177.6972508430481, 183.34416961669922, 188.95247745513916, 194.56961250305176, 200.12335062026978, 205.73561024665833, 211.3026955127716, 216.86241149902344, 222.43062782287598, 227.9993815422058, 233.59104013442993, 239.1836724281311, 244.79470872879028, 250.37139916419983, 255.95866870880127, 261.5464687347412, 267.19433212280273, 272.80578899383545, 278.4226794242859, 284.1233744621277, 289.73683404922485, 295.39143681526184, 301.0112957954407, 306.6590576171875, 312.2952527999878, 317.9229381084442, 323.56877732276917, 329.25677251815796, 334.8981478214264, 340.5268111228943, 346.13606548309326, 351.7696056365967, 357.4077787399292, 363.0224132537842, 368.61159014701843, 374.1991832256317, 379.7433524131775, 385.3139863014221, 390.88757967948914, 396.44595289230347, 402.05746245384216, 407.7071783542633, 413.3197102546692, 418.91727089881897, 424.57436895370483, 430.21001505851746, 435.8344666957855, 441.44318199157715, 447.105614900589, 452.685800075531, 457.7251229286194, 462.81052112579346, 467.9071490764618, 472.9688003063202, 478.1134626865387, 483.2230906486511, 488.3209140300751, 493.4597280025482, 498.5817141532898, 503.6694781780243, 508.7942473888397, 513.9254186153412, 519.0086941719055, 524.1483714580536, 529.2760558128357, 534.3587605953217, 539.4860625267029, 544.5927486419678, 546.6181869506836]
[29.9925, 37.1175, 41.4875, 44.35, 46.785, 49.7325, 51.2, 53.24, 54.2775, 56.36, 56.9925, 58.2625, 59.2025, 60.3325, 61.0175, 61.8425, 62.6775, 63.2425, 63.6375, 63.795, 64.1625, 64.91, 65.055, 65.92, 66.4775, 66.485, 66.5425, 67.14, 67.51, 67.675, 67.99, 68.05, 68.215, 68.6325, 68.3975, 68.3675, 68.995, 68.975, 68.9425, 69.31, 69.2875, 69.43, 69.655, 69.76, 69.6325, 69.0775, 69.895, 69.685, 70.01, 69.935, 70.4175, 70.59, 70.3975, 70.3425, 69.8425, 70.525, 69.9925, 70.3025, 70.2875, 70.495, 70.0525, 70.4625, 70.205, 70.72, 71.075, 71.2075, 70.81, 70.99, 70.8225, 71.145, 70.6925, 71.1025, 70.7625, 70.7975, 71.165, 70.96, 71.04, 71.725, 71.3725, 71.1375, 71.665, 71.265, 71.47, 71.2225, 70.99, 71.465, 71.885, 71.385, 71.35, 71.35, 70.8075, 71.1875, 71.155, 71.285, 71.25, 71.3075, 71.4125, 71.235, 70.91, 71.07, 71.035]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.5  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.5000 
   Client 12, noise    level: 0.5000 
   Client 15, noise    level: 0.5000 
   Client 0, noise    level: 0.5000 
   Client 6, noise    level: 0.5000 
   Client 14, noise    level: 0.5000 
   Client 19, noise    level: 0.5000 
   Client 10, noise    level: 0.5000 
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.207, Test loss: 1.920, Test accuracy: 33.23
Round   1, Train loss: 1.855, Test loss: 1.649, Test accuracy: 41.97
Round   2, Train loss: 1.676, Test loss: 1.546, Test accuracy: 46.76
Round   3, Train loss: 1.577, Test loss: 1.452, Test accuracy: 49.56
Round   4, Train loss: 1.499, Test loss: 1.363, Test accuracy: 53.69
Round   5, Train loss: 1.416, Test loss: 1.314, Test accuracy: 54.59
Round   6, Train loss: 1.354, Test loss: 1.278, Test accuracy: 56.50
Round   7, Train loss: 1.293, Test loss: 1.234, Test accuracy: 58.05
Round   8, Train loss: 1.254, Test loss: 1.185, Test accuracy: 59.90
Round   9, Train loss: 1.219, Test loss: 1.122, Test accuracy: 61.79
Round  10, Train loss: 1.163, Test loss: 1.108, Test accuracy: 63.09
Round  11, Train loss: 1.149, Test loss: 1.056, Test accuracy: 63.90
Round  12, Train loss: 1.091, Test loss: 1.050, Test accuracy: 64.39
Round  13, Train loss: 1.080, Test loss: 0.992, Test accuracy: 66.11
Round  14, Train loss: 1.047, Test loss: 0.961, Test accuracy: 67.09
Round  15, Train loss: 1.011, Test loss: 0.936, Test accuracy: 67.97
Round  16, Train loss: 1.000, Test loss: 0.931, Test accuracy: 68.50
Round  17, Train loss: 0.955, Test loss: 0.934, Test accuracy: 69.17
Round  18, Train loss: 0.941, Test loss: 0.909, Test accuracy: 69.66
Round  19, Train loss: 0.942, Test loss: 0.879, Test accuracy: 70.35
Round  20, Train loss: 0.898, Test loss: 0.863, Test accuracy: 70.70
Round  21, Train loss: 0.901, Test loss: 0.845, Test accuracy: 71.47
Round  22, Train loss: 0.865, Test loss: 0.854, Test accuracy: 70.67
Round  23, Train loss: 0.855, Test loss: 0.860, Test accuracy: 70.82
Round  24, Train loss: 0.877, Test loss: 0.838, Test accuracy: 71.65
Round  25, Train loss: 0.846, Test loss: 0.810, Test accuracy: 72.14
Round  26, Train loss: 0.808, Test loss: 0.822, Test accuracy: 71.84
Round  27, Train loss: 0.814, Test loss: 0.816, Test accuracy: 72.33
Round  28, Train loss: 0.813, Test loss: 0.800, Test accuracy: 72.73
Round  29, Train loss: 0.775, Test loss: 0.793, Test accuracy: 73.08
Round  30, Train loss: 0.760, Test loss: 0.803, Test accuracy: 72.61
Round  31, Train loss: 0.763, Test loss: 0.799, Test accuracy: 72.82
Round  32, Train loss: 0.764, Test loss: 0.776, Test accuracy: 73.74
Round  33, Train loss: 0.757, Test loss: 0.773, Test accuracy: 73.61
Round  34, Train loss: 0.724, Test loss: 0.772, Test accuracy: 74.06
Round  35, Train loss: 0.731, Test loss: 0.758, Test accuracy: 74.43
Round  36, Train loss: 0.714, Test loss: 0.764, Test accuracy: 73.84
Round  37, Train loss: 0.702, Test loss: 0.762, Test accuracy: 74.12
Round  38, Train loss: 0.699, Test loss: 0.763, Test accuracy: 74.22
Round  39, Train loss: 0.701, Test loss: 0.762, Test accuracy: 74.00
Round  40, Train loss: 0.679, Test loss: 0.751, Test accuracy: 74.50
Round  41, Train loss: 0.686, Test loss: 0.758, Test accuracy: 74.37
Round  42, Train loss: 0.686, Test loss: 0.743, Test accuracy: 74.78
Round  43, Train loss: 0.668, Test loss: 0.747, Test accuracy: 75.14
Round  44, Train loss: 0.675, Test loss: 0.741, Test accuracy: 75.16
Round  45, Train loss: 0.641, Test loss: 0.733, Test accuracy: 75.63
Round  46, Train loss: 0.637, Test loss: 0.756, Test accuracy: 74.56
Round  47, Train loss: 0.645, Test loss: 0.733, Test accuracy: 75.31
Round  48, Train loss: 0.628, Test loss: 0.733, Test accuracy: 75.56
Round  49, Train loss: 0.618, Test loss: 0.738, Test accuracy: 75.42
Round  50, Train loss: 0.647, Test loss: 0.723, Test accuracy: 75.89
Round  51, Train loss: 0.614, Test loss: 0.720, Test accuracy: 75.87
Round  52, Train loss: 0.574, Test loss: 0.732, Test accuracy: 75.64
Round  53, Train loss: 0.627, Test loss: 0.714, Test accuracy: 76.30
Round  54, Train loss: 0.620, Test loss: 0.717, Test accuracy: 76.06
Round  55, Train loss: 0.609, Test loss: 0.720, Test accuracy: 75.78
Round  56, Train loss: 0.592, Test loss: 0.719, Test accuracy: 75.89
Round  57, Train loss: 0.627, Test loss: 0.712, Test accuracy: 76.28
Round  58, Train loss: 0.593, Test loss: 0.706, Test accuracy: 76.41
Round  59, Train loss: 0.597, Test loss: 0.708, Test accuracy: 76.38
Round  60, Train loss: 0.572, Test loss: 0.713, Test accuracy: 76.50
Round  61, Train loss: 0.570, Test loss: 0.716, Test accuracy: 76.47
Round  62, Train loss: 0.594, Test loss: 0.705, Test accuracy: 76.58
Round  63, Train loss: 0.574, Test loss: 0.696, Test accuracy: 76.89
Round  64, Train loss: 0.582, Test loss: 0.694, Test accuracy: 76.86
Round  65, Train loss: 0.582, Test loss: 0.705, Test accuracy: 76.59
Round  66, Train loss: 0.565, Test loss: 0.699, Test accuracy: 76.62
Round  67, Train loss: 0.575, Test loss: 0.692, Test accuracy: 76.88
Round  68, Train loss: 0.556, Test loss: 0.693, Test accuracy: 76.92
Round  69, Train loss: 0.557, Test loss: 0.686, Test accuracy: 77.06
Round  70, Train loss: 0.536, Test loss: 0.695, Test accuracy: 76.90
Round  71, Train loss: 0.540, Test loss: 0.702, Test accuracy: 76.95
Round  72, Train loss: 0.558, Test loss: 0.698, Test accuracy: 76.65
Round  73, Train loss: 0.547, Test loss: 0.700, Test accuracy: 76.88
Round  74, Train loss: 0.527, Test loss: 0.700, Test accuracy: 76.78
Round  75, Train loss: 0.530, Test loss: 0.693, Test accuracy: 77.21
Round  76, Train loss: 0.515, Test loss: 0.698, Test accuracy: 76.91
Round  77, Train loss: 0.555, Test loss: 0.701, Test accuracy: 76.65
Round  78, Train loss: 0.548, Test loss: 0.693, Test accuracy: 77.13
Round  79, Train loss: 0.517, Test loss: 0.696, Test accuracy: 77.19
Round  80, Train loss: 0.552, Test loss: 0.703, Test accuracy: 76.78
Round  81, Train loss: 0.528, Test loss: 0.702, Test accuracy: 76.63
Round  82, Train loss: 0.516, Test loss: 0.694, Test accuracy: 77.40
Round  83, Train loss: 0.505, Test loss: 0.687, Test accuracy: 77.78
Round  84, Train loss: 0.507, Test loss: 0.706, Test accuracy: 77.25
Round  85, Train loss: 0.517, Test loss: 0.697, Test accuracy: 77.23
Round  86, Train loss: 0.513, Test loss: 0.693, Test accuracy: 77.22
Round  87, Train loss: 0.518, Test loss: 0.696, Test accuracy: 77.47
Round  88, Train loss: 0.529, Test loss: 0.687, Test accuracy: 77.64
Round  89, Train loss: 0.495, Test loss: 0.689, Test accuracy: 77.33
Round  90, Train loss: 0.496, Test loss: 0.705, Test accuracy: 77.08
Round  91, Train loss: 0.501, Test loss: 0.705, Test accuracy: 77.08
Round  92, Train loss: 0.510, Test loss: 0.692, Test accuracy: 77.89
Round  93, Train loss: 0.506, Test loss: 0.691, Test accuracy: 77.50
Round  94, Train loss: 0.479, Test loss: 0.699, Test accuracy: 77.32
Round  95, Train loss: 0.488, Test loss: 0.689, Test accuracy: 77.84
Round  96, Train loss: 0.494, Test loss: 0.689, Test accuracy: 77.50
Round  97, Train loss: 0.461, Test loss: 0.703, Test accuracy: 77.55
Round  98, Train loss: 0.465, Test loss: 0.699, Test accuracy: 77.25
Round  99, Train loss: 0.445, Test loss: 0.709, Test accuracy: 77.10
Final Round, Train loss: 0.404, Test loss: 0.700, Test accuracy: 77.55
Average accuracy final 10 rounds: 77.4115
6704.436855792999
[5.622032403945923, 10.772920370101929, 15.8925199508667, 20.899361848831177, 26.034969329833984, 31.15726900100708, 36.17818641662598, 41.30028557777405, 46.434826612472534, 51.44918704032898, 56.50939202308655, 61.57748866081238, 66.56639289855957, 71.68494701385498, 76.78879904747009, 81.81782293319702, 86.90682864189148, 91.97238612174988, 97.04499697685242, 102.12073302268982, 107.21904468536377, 117.86884665489197, 128.52654910087585, 139.18903613090515, 149.82350754737854, 160.47131085395813, 171.19419312477112, 181.83777260780334, 192.566828250885, 203.25646042823792, 213.81837916374207, 224.31422066688538, 234.82643485069275, 245.46429324150085, 256.0023744106293, 266.5512936115265, 277.33013582229614, 288.02467155456543, 298.71532583236694, 309.4655063152313, 319.99669671058655, 330.56815481185913, 341.20147013664246, 351.72996163368225, 362.43380546569824, 372.9154632091522, 383.4606900215149, 393.98495507240295, 404.4484088420868, 414.8183362483978, 425.3335266113281, 435.82722568511963, 446.3177170753479, 456.7802631855011, 467.24855184555054, 477.79799485206604, 488.3000633716583, 498.70443415641785, 509.22946548461914, 519.6717567443848, 530.1382863521576, 540.6478288173676, 551.0294163227081, 561.9524719715118, 572.840384721756, 583.7508256435394, 594.7943360805511, 605.6553800106049, 616.5061275959015, 627.6178214550018, 638.4763970375061, 649.4419705867767, 660.5551235675812, 671.4165453910828, 682.279664516449, 693.3070249557495, 704.0809676647186, 715.4529938697815, 726.32732462883, 737.2081482410431, 748.0817883014679, 758.6354622840881, 769.3990421295166, 780.1744220256805, 790.8287174701691, 801.5893061161041, 812.4142196178436, 823.2282242774963, 834.0075585842133, 844.8785638809204, 855.7891540527344, 866.9044580459595, 878.0141837596893, 889.1391808986664, 900.2934575080872, 911.4524033069611, 922.3951396942139, 933.3623967170715, 944.8085424900055, 956.2815177440643, 958.3937001228333]
[33.225, 41.965, 46.755, 49.56, 53.6925, 54.585, 56.4975, 58.0525, 59.895, 61.7875, 63.095, 63.9025, 64.3925, 66.115, 67.0875, 67.965, 68.5, 69.1725, 69.6575, 70.3525, 70.705, 71.4675, 70.675, 70.8175, 71.6525, 72.1375, 71.845, 72.325, 72.73, 73.085, 72.6075, 72.8225, 73.7425, 73.6125, 74.06, 74.43, 73.845, 74.12, 74.2225, 74.0025, 74.505, 74.37, 74.785, 75.14, 75.1575, 75.63, 74.56, 75.315, 75.555, 75.415, 75.8875, 75.87, 75.635, 76.295, 76.06, 75.775, 75.885, 76.285, 76.4125, 76.3775, 76.505, 76.475, 76.585, 76.89, 76.865, 76.5925, 76.62, 76.8825, 76.9225, 77.055, 76.9025, 76.9475, 76.6525, 76.875, 76.7825, 77.21, 76.905, 76.65, 77.13, 77.19, 76.785, 76.6325, 77.4025, 77.775, 77.2475, 77.235, 77.215, 77.47, 77.6425, 77.325, 77.075, 77.085, 77.895, 77.5025, 77.3225, 77.8425, 77.5025, 77.545, 77.245, 77.1, 77.545]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.2  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.2000 
   Client 8, noise    level: 0.2000 
   Client 18, noise    level: 0.2000 
   Client 7, noise    level: 0.2000 
   Client 5, noise    level: 0.2000 
   Client 13, noise    level: 0.2000 
   Client 9, noise    level: 0.2000 
   Client 3, noise    level: 0.2000 
   Client 12, noise    level: 0.2000 
   Client 0, noise    level: 0.2000 
   Client 2, noise    level: 0.2000 
   Client 19, noise    level: 0.2000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.113, Test loss: 1.854, Test accuracy: 35.33
Round   0, Global train loss: 2.113, Global test loss: 1.859, Global test accuracy: 35.93
Round   1, Train loss: 1.967, Test loss: 1.712, Test accuracy: 40.80
Round   1, Global train loss: 1.967, Global test loss: 1.671, Global test accuracy: 43.45
Round   2, Train loss: 1.865, Test loss: 1.644, Test accuracy: 43.35
Round   2, Global train loss: 1.865, Global test loss: 1.567, Global test accuracy: 48.07
Round   3, Train loss: 1.822, Test loss: 1.618, Test accuracy: 44.38
Round   3, Global train loss: 1.822, Global test loss: 1.536, Global test accuracy: 50.16
Round   4, Train loss: 1.853, Test loss: 1.610, Test accuracy: 44.75
Round   4, Global train loss: 1.853, Global test loss: 1.591, Global test accuracy: 49.86
Round   5, Train loss: 1.783, Test loss: 1.587, Test accuracy: 45.21
Round   5, Global train loss: 1.783, Global test loss: 1.497, Global test accuracy: 51.75
Round   6, Train loss: 1.704, Test loss: 1.567, Test accuracy: 45.90
Round   6, Global train loss: 1.704, Global test loss: 1.527, Global test accuracy: 51.38
Round   7, Train loss: 1.782, Test loss: 1.568, Test accuracy: 45.52
Round   7, Global train loss: 1.782, Global test loss: 1.509, Global test accuracy: 52.86
Round   8, Train loss: 1.660, Test loss: 1.562, Test accuracy: 45.83
Round   8, Global train loss: 1.660, Global test loss: 1.474, Global test accuracy: 53.39
Round   9, Train loss: 1.690, Test loss: 1.547, Test accuracy: 46.51
Round   9, Global train loss: 1.690, Global test loss: 1.491, Global test accuracy: 52.39
Round  10, Train loss: 1.594, Test loss: 1.538, Test accuracy: 47.14
Round  10, Global train loss: 1.594, Global test loss: 1.421, Global test accuracy: 54.80
Round  11, Train loss: 1.610, Test loss: 1.523, Test accuracy: 47.83
Round  11, Global train loss: 1.610, Global test loss: 1.448, Global test accuracy: 55.14
Round  12, Train loss: 1.603, Test loss: 1.515, Test accuracy: 48.20
Round  12, Global train loss: 1.603, Global test loss: 1.504, Global test accuracy: 54.22
Round  13, Train loss: 1.532, Test loss: 1.499, Test accuracy: 48.62
Round  13, Global train loss: 1.532, Global test loss: 1.512, Global test accuracy: 53.02
Round  14, Train loss: 1.626, Test loss: 1.482, Test accuracy: 49.09
Round  14, Global train loss: 1.626, Global test loss: 1.455, Global test accuracy: 54.34
Round  15, Train loss: 1.464, Test loss: 1.491, Test accuracy: 48.97
Round  15, Global train loss: 1.464, Global test loss: 1.454, Global test accuracy: 53.42
Round  16, Train loss: 1.557, Test loss: 1.500, Test accuracy: 48.90
Round  16, Global train loss: 1.557, Global test loss: 1.454, Global test accuracy: 54.24
Round  17, Train loss: 1.451, Test loss: 1.509, Test accuracy: 48.72
Round  17, Global train loss: 1.451, Global test loss: 1.541, Global test accuracy: 52.95
Round  18, Train loss: 1.434, Test loss: 1.516, Test accuracy: 48.58
Round  18, Global train loss: 1.434, Global test loss: 1.408, Global test accuracy: 54.11
Round  19, Train loss: 1.510, Test loss: 1.530, Test accuracy: 48.24
Round  19, Global train loss: 1.510, Global test loss: 1.452, Global test accuracy: 55.61
Round  20, Train loss: 1.255, Test loss: 1.529, Test accuracy: 48.48
Round  20, Global train loss: 1.255, Global test loss: 1.422, Global test accuracy: 55.22
Round  21, Train loss: 1.283, Test loss: 1.539, Test accuracy: 48.18
Round  21, Global train loss: 1.283, Global test loss: 1.435, Global test accuracy: 54.79
Round  22, Train loss: 1.328, Test loss: 1.540, Test accuracy: 48.56
Round  22, Global train loss: 1.328, Global test loss: 1.417, Global test accuracy: 54.39
Round  23, Train loss: 1.373, Test loss: 1.543, Test accuracy: 48.84
Round  23, Global train loss: 1.373, Global test loss: 1.461, Global test accuracy: 54.94
Round  24, Train loss: 1.159, Test loss: 1.573, Test accuracy: 48.61
Round  24, Global train loss: 1.159, Global test loss: 1.364, Global test accuracy: 55.48
Round  25, Train loss: 1.077, Test loss: 1.561, Test accuracy: 49.07
Round  25, Global train loss: 1.077, Global test loss: 1.392, Global test accuracy: 54.53
Round  26, Train loss: 1.086, Test loss: 1.575, Test accuracy: 49.12
Round  26, Global train loss: 1.086, Global test loss: 1.469, Global test accuracy: 51.51
Round  27, Train loss: 1.220, Test loss: 1.590, Test accuracy: 48.74
Round  27, Global train loss: 1.220, Global test loss: 1.466, Global test accuracy: 52.78
Round  28, Train loss: 1.047, Test loss: 1.625, Test accuracy: 48.42
Round  28, Global train loss: 1.047, Global test loss: 1.431, Global test accuracy: 53.12
Round  29, Train loss: 1.282, Test loss: 1.633, Test accuracy: 48.44
Round  29, Global train loss: 1.282, Global test loss: 1.449, Global test accuracy: 53.84
Round  30, Train loss: 1.037, Test loss: 1.669, Test accuracy: 48.17
Round  30, Global train loss: 1.037, Global test loss: 1.574, Global test accuracy: 47.03
Round  31, Train loss: 1.133, Test loss: 1.705, Test accuracy: 47.74
Round  31, Global train loss: 1.133, Global test loss: 1.461, Global test accuracy: 53.42
Round  32, Train loss: 1.121, Test loss: 1.707, Test accuracy: 47.98
Round  32, Global train loss: 1.121, Global test loss: 1.593, Global test accuracy: 48.05
Round  33, Train loss: 0.970, Test loss: 1.726, Test accuracy: 47.26
Round  33, Global train loss: 0.970, Global test loss: 1.385, Global test accuracy: 53.94
Round  34, Train loss: 1.056, Test loss: 1.744, Test accuracy: 47.35
Round  34, Global train loss: 1.056, Global test loss: 1.446, Global test accuracy: 52.81
Round  35, Train loss: 1.030, Test loss: 1.763, Test accuracy: 47.41
Round  35, Global train loss: 1.030, Global test loss: 1.413, Global test accuracy: 53.85
Round  36, Train loss: 1.008, Test loss: 1.801, Test accuracy: 47.09
Round  36, Global train loss: 1.008, Global test loss: 1.370, Global test accuracy: 54.51
Round  37, Train loss: 1.020, Test loss: 1.841, Test accuracy: 47.19
Round  37, Global train loss: 1.020, Global test loss: 1.467, Global test accuracy: 53.10
Round  38, Train loss: 1.015, Test loss: 1.857, Test accuracy: 46.83
Round  38, Global train loss: 1.015, Global test loss: 1.441, Global test accuracy: 52.07
Round  39, Train loss: 1.009, Test loss: 1.873, Test accuracy: 46.53
Round  39, Global train loss: 1.009, Global test loss: 1.499, Global test accuracy: 51.54
Round  40, Train loss: 0.980, Test loss: 1.887, Test accuracy: 46.47
Round  40, Global train loss: 0.980, Global test loss: 1.646, Global test accuracy: 45.77
Round  41, Train loss: 0.819, Test loss: 1.949, Test accuracy: 45.96