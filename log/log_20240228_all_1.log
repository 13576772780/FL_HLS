nohup: ignoring input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.150, Test loss: 2.661, Test accuracy: 57.67
Final Round, Global train loss: 0.150, Global test loss: 1.182, Global test accuracy: 60.95
Average accuracy final 10 rounds: 57.138499999999986 

Average global accuracy final 10 rounds: 60.023250000000004 

6067.594718456268
[4.742488622665405, 9.48497724533081, 14.156854391098022, 18.828731536865234, 23.530823945999146, 28.232916355133057, 33.18820238113403, 38.14348840713501, 43.11849617958069, 48.09350395202637, 53.055196046829224, 58.01688814163208, 63.00375318527222, 67.99061822891235, 72.95457172393799, 77.91852521896362, 82.94308567047119, 87.96764612197876, 92.93814635276794, 97.90864658355713, 102.87864875793457, 107.84865093231201, 112.81712746620178, 117.78560400009155, 122.7602686882019, 127.73493337631226, 132.71235251426697, 137.68977165222168, 142.66095089912415, 147.6321301460266, 152.60137629508972, 157.57062244415283, 162.53549122810364, 167.50036001205444, 172.46792674064636, 177.43549346923828, 182.40482378005981, 187.37415409088135, 192.34690356254578, 197.3196530342102, 202.28999042510986, 207.26032781600952, 212.25064086914062, 217.24095392227173, 222.23947477340698, 227.23799562454224, 232.20551705360413, 237.17303848266602, 242.1219606399536, 247.0708827972412, 252.0395143032074, 257.0081458091736, 262.0011372566223, 266.99412870407104, 272.001261472702, 277.008394241333, 282.00214171409607, 286.99588918685913, 291.9788098335266, 296.9617304801941, 301.9529883861542, 306.94424629211426, 311.9292619228363, 316.91427755355835, 321.9144685268402, 326.91465950012207, 331.9014618396759, 336.88826417922974, 341.87231516838074, 346.85636615753174, 351.8372585773468, 356.81815099716187, 361.81300497055054, 366.8078589439392, 371.79375410079956, 376.7796492576599, 381.7644338607788, 386.7492184638977, 391.74130606651306, 396.7333936691284, 401.7278063297272, 406.7222189903259, 411.7268431186676, 416.7314672470093, 421.7281494140625, 426.7248315811157, 431.72469449043274, 436.72455739974976, 441.72472977638245, 446.72490215301514, 451.71745586395264, 456.71000957489014, 461.6777639389038, 466.6455183029175, 471.62974977493286, 476.61398124694824, 481.5824074745178, 486.5508337020874, 491.4987816810608, 496.4467296600342, 501.3980407714844, 506.34935188293457, 511.2813241481781, 516.2132964134216, 521.1569397449493, 526.100583076477, 531.0647823810577, 536.0289816856384, 541.0289542675018, 546.0289268493652, 551.0162489414215, 556.0035710334778, 560.9910957813263, 565.9786205291748, 570.9609124660492, 575.9432044029236, 580.9355270862579, 585.9278497695923, 590.9083850383759, 595.8889203071594, 600.8645992279053, 605.8402781486511, 610.8277721405029, 615.8152661323547, 620.7724874019623, 625.7297086715698, 630.7161529064178, 635.7025971412659, 640.6796271800995, 645.6566572189331, 650.6379172801971, 655.6191773414612, 660.5931930541992, 665.5672087669373, 670.5730817317963, 675.5789546966553, 680.5822672843933, 685.5855798721313, 690.5994212627411, 695.6132626533508, 700.6703410148621, 705.7274193763733, 710.7651975154877, 715.802975654602, 720.8658363819122, 725.9286971092224, 730.944141626358, 735.9595861434937, 740.9742560386658, 745.9889259338379, 751.0138900279999, 756.0388541221619, 761.0437526702881, 766.0486512184143, 771.0618033409119, 776.0749554634094, 781.095329284668, 786.1157031059265, 791.1232149600983, 796.13072681427, 801.1352398395538, 806.1397528648376, 811.1505856513977, 816.1614184379578, 821.1848964691162, 826.2083745002747, 831.2215855121613, 836.2347965240479, 841.2500998973846, 846.2654032707214, 851.2960114479065, 856.3266196250916, 861.3270697593689, 866.3275198936462, 871.3490364551544, 876.3705530166626, 881.3824076652527, 886.3942623138428, 891.420825958252, 896.4473896026611, 901.4574041366577, 906.4674186706543, 911.493093252182, 916.5187678337097, 921.5996322631836, 926.6804966926575, 931.6914637088776, 936.7024307250977, 941.495246887207, 946.2880630493164, 951.0847399234772, 955.8814167976379, 960.640453338623, 965.3994898796082, 970.2669620513916, 975.134434223175, 980.0063991546631, 984.8783640861511, 989.9108626842499, 994.9433612823486, 997.4769344329834, 1000.0105075836182]
[38.23, 38.23, 43.2225, 43.2225, 44.98, 44.98, 46.475, 46.475, 47.4625, 47.4625, 48.1225, 48.1225, 49.5825, 49.5825, 50.32, 50.32, 50.28, 50.28, 50.795, 50.795, 51.7875, 51.7875, 52.545, 52.545, 53.305, 53.305, 53.3875, 53.3875, 53.86, 53.86, 54.2825, 54.2825, 54.4875, 54.4875, 54.78, 54.78, 55.05, 55.05, 55.245, 55.245, 55.525, 55.525, 55.6425, 55.6425, 55.815, 55.815, 56.0925, 56.0925, 56.3025, 56.3025, 56.3175, 56.3175, 56.2575, 56.2575, 56.21, 56.21, 56.4425, 56.4425, 56.3425, 56.3425, 56.7, 56.7, 56.7725, 56.7725, 56.035, 56.035, 56.02, 56.02, 55.8475, 55.8475, 55.8125, 55.8125, 55.6175, 55.6175, 55.4825, 55.4825, 55.945, 55.945, 56.4275, 56.4275, 56.4825, 56.4825, 56.4775, 56.4775, 56.505, 56.505, 56.665, 56.665, 56.63, 56.63, 56.515, 56.515, 56.4775, 56.4775, 56.43, 56.43, 56.8075, 56.8075, 56.8975, 56.8975, 56.85, 56.85, 56.6625, 56.6625, 56.8725, 56.8725, 56.74, 56.74, 56.5575, 56.5575, 56.53, 56.53, 56.75, 56.75, 56.8825, 56.8825, 57.0175, 57.0175, 56.7125, 56.7125, 56.245, 56.245, 56.25, 56.25, 56.215, 56.215, 56.525, 56.525, 56.1275, 56.1275, 56.1975, 56.1975, 56.5175, 56.5175, 56.5325, 56.5325, 56.79, 56.79, 56.7775, 56.7775, 56.9475, 56.9475, 56.845, 56.845, 56.86, 56.86, 56.845, 56.845, 56.785, 56.785, 56.73, 56.73, 56.7575, 56.7575, 56.6875, 56.6875, 56.6425, 56.6425, 56.94, 56.94, 56.7075, 56.7075, 56.82, 56.82, 57.13, 57.13, 57.1525, 57.1525, 57.11, 57.11, 57.125, 57.125, 57.01, 57.01, 57.21, 57.21, 57.095, 57.095, 57.1075, 57.1075, 57.005, 57.005, 57.2925, 57.2925, 57.3025, 57.3025, 57.27, 57.27, 57.1475, 57.1475, 56.9125, 56.9125, 56.7375, 56.7375, 56.9975, 56.9975, 57.36, 57.36, 57.36, 57.36, 57.6675, 57.6675]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.180, Test loss: 0.595, Test accuracy: 83.07
Final Round, Global train loss: 0.180, Global test loss: 1.563, Global test accuracy: 56.68
Average accuracy final 10 rounds: 82.16499999999999 

Average global accuracy final 10 rounds: 57.739999999999995 

899.0198812484741
[0.9226284027099609, 1.8452568054199219, 2.5264298915863037, 3.2076029777526855, 3.884532928466797, 4.561462879180908, 5.276228189468384, 5.990993499755859, 6.710627317428589, 7.430261135101318, 8.148753881454468, 8.867246627807617, 9.585114240646362, 10.302981853485107, 11.021570682525635, 11.740159511566162, 12.462019205093384, 13.183878898620605, 13.910226583480835, 14.636574268341064, 15.35160207748413, 16.066629886627197, 16.78230595588684, 17.497982025146484, 18.21539068222046, 18.932799339294434, 19.651270627975464, 20.369741916656494, 21.087677240371704, 21.805612564086914, 22.52765965461731, 23.249706745147705, 23.963576316833496, 24.677445888519287, 25.393879890441895, 26.110313892364502, 26.83025050163269, 27.55018711090088, 28.265772819519043, 28.981358528137207, 29.696735382080078, 30.41211223602295, 31.127750396728516, 31.843388557434082, 32.56274199485779, 33.282095432281494, 33.99316954612732, 34.704243659973145, 35.419711112976074, 36.135178565979004, 36.85340356826782, 37.57162857055664, 38.294235706329346, 39.01684284210205, 39.73447799682617, 40.45211315155029, 41.17451858520508, 41.89692401885986, 42.60977578163147, 43.322627544403076, 44.04047679901123, 44.758326053619385, 45.47840476036072, 46.19848346710205, 46.92324995994568, 47.64801645278931, 48.36507534980774, 49.08213424682617, 49.79875111579895, 50.51536798477173, 51.234041690826416, 51.9527153968811, 52.675750970840454, 53.398786544799805, 54.115275859832764, 54.83176517486572, 55.552809953689575, 56.27385473251343, 56.99305462837219, 57.71225452423096, 58.427273988723755, 59.14229345321655, 59.856001138687134, 60.569708824157715, 61.286991357803345, 62.004273891448975, 62.72489547729492, 63.44551706314087, 64.16266441345215, 64.87981176376343, 65.58807873725891, 66.2963457107544, 67.00255966186523, 67.70877361297607, 68.41463470458984, 69.12049579620361, 69.83387541770935, 70.54725503921509, 71.26173233985901, 71.97620964050293, 72.6941602230072, 73.41211080551147, 74.12684607505798, 74.84158134460449, 75.55791854858398, 76.27425575256348, 76.9872817993164, 77.70030784606934, 78.31814813613892, 78.9359884262085, 79.56072664260864, 80.18546485900879, 80.79854989051819, 81.41163492202759, 82.03572154045105, 82.65980815887451, 83.28528499603271, 83.91076183319092, 84.5240547657013, 85.13734769821167, 85.74960541725159, 86.3618631362915, 86.97329711914062, 87.58473110198975, 88.20769429206848, 88.83065748214722, 89.44559907913208, 90.06054067611694, 90.67989206314087, 91.2992434501648, 91.91626214981079, 92.53328084945679, 93.15097856521606, 93.76867628097534, 94.3836886882782, 94.99870109558105, 95.61585712432861, 96.23301315307617, 96.85536599159241, 97.47771883010864, 98.09476852416992, 98.7118182182312, 99.33052015304565, 99.94922208786011, 100.56776833534241, 101.1863145828247, 101.804203748703, 102.4220929145813, 103.03778171539307, 103.65347051620483, 104.27073836326599, 104.88800621032715, 105.5055205821991, 106.12303495407104, 106.73828506469727, 107.35353517532349, 107.97633266448975, 108.599130153656, 109.21719026565552, 109.83525037765503, 110.45270299911499, 111.07015562057495, 111.68667984008789, 112.30320405960083, 112.92113518714905, 113.53906631469727, 114.15240502357483, 114.76574373245239, 115.38332104682922, 116.00089836120605, 116.61565041542053, 117.23040246963501, 117.8458092212677, 118.46121597290039, 119.0804169178009, 119.69961786270142, 120.3181140422821, 120.9366102218628, 121.55324459075928, 122.16987895965576, 122.78827428817749, 123.40666961669922, 124.02244114875793, 124.63821268081665, 125.25507593154907, 125.8719391822815, 126.49033331871033, 127.10872745513916, 127.72310853004456, 128.33748960494995, 128.9519453048706, 129.56640100479126, 130.18528270721436, 130.80416440963745, 131.4262354373932, 132.04830646514893, 132.6681351661682, 133.2879638671875, 133.90709686279297, 134.52622985839844, 135.7627980709076, 136.99936628341675]
[26.716666666666665, 26.716666666666665, 41.61666666666667, 41.61666666666667, 43.86666666666667, 43.86666666666667, 53.1, 53.1, 57.65, 57.65, 60.5, 60.5, 64.63333333333334, 64.63333333333334, 65.0, 65.0, 69.06666666666666, 69.06666666666666, 72.55, 72.55, 72.51666666666667, 72.51666666666667, 72.71666666666667, 72.71666666666667, 73.46666666666667, 73.46666666666667, 73.65, 73.65, 73.03333333333333, 73.03333333333333, 73.81666666666666, 73.81666666666666, 74.68333333333334, 74.68333333333334, 74.78333333333333, 74.78333333333333, 75.01666666666667, 75.01666666666667, 75.85, 75.85, 76.36666666666666, 76.36666666666666, 76.1, 76.1, 76.88333333333334, 76.88333333333334, 76.85, 76.85, 77.6, 77.6, 77.71666666666667, 77.71666666666667, 77.63333333333334, 77.63333333333334, 78.03333333333333, 78.03333333333333, 77.23333333333333, 77.23333333333333, 77.35, 77.35, 77.53333333333333, 77.53333333333333, 79.25, 79.25, 79.5, 79.5, 79.76666666666667, 79.76666666666667, 79.18333333333334, 79.18333333333334, 79.65, 79.65, 79.73333333333333, 79.73333333333333, 80.05, 80.05, 80.1, 80.1, 80.2, 80.2, 79.85, 79.85, 79.61666666666666, 79.61666666666666, 79.56666666666666, 79.56666666666666, 79.95, 79.95, 80.33333333333333, 80.33333333333333, 80.41666666666667, 80.41666666666667, 80.4, 80.4, 79.16666666666667, 79.16666666666667, 81.05, 81.05, 81.05, 81.05, 80.7, 80.7, 80.85, 80.85, 81.8, 81.8, 81.31666666666666, 81.31666666666666, 80.95, 80.95, 81.28333333333333, 81.28333333333333, 81.35, 81.35, 81.46666666666667, 81.46666666666667, 81.56666666666666, 81.56666666666666, 80.63333333333334, 80.63333333333334, 81.0, 81.0, 80.28333333333333, 80.28333333333333, 80.46666666666667, 80.46666666666667, 80.61666666666666, 80.61666666666666, 80.85, 80.85, 81.26666666666667, 81.26666666666667, 80.83333333333333, 80.83333333333333, 80.96666666666667, 80.96666666666667, 80.98333333333333, 80.98333333333333, 81.48333333333333, 81.48333333333333, 81.4, 81.4, 81.11666666666666, 81.11666666666666, 81.51666666666667, 81.51666666666667, 81.75, 81.75, 81.68333333333334, 81.68333333333334, 81.7, 81.7, 81.18333333333334, 81.18333333333334, 82.05, 82.05, 81.88333333333334, 81.88333333333334, 81.8, 81.8, 82.1, 82.1, 81.28333333333333, 81.28333333333333, 81.3, 81.3, 81.7, 81.7, 82.68333333333334, 82.68333333333334, 82.63333333333334, 82.63333333333334, 82.65, 82.65, 82.26666666666667, 82.26666666666667, 81.36666666666666, 81.36666666666666, 81.98333333333333, 81.98333333333333, 82.13333333333334, 82.13333333333334, 82.4, 82.4, 82.68333333333334, 82.68333333333334, 81.56666666666666, 81.56666666666666, 82.0, 82.0, 82.46666666666667, 82.46666666666667, 82.51666666666667, 82.51666666666667, 82.48333333333333, 82.48333333333333, 81.8, 81.8, 81.6, 81.6, 83.06666666666666, 83.06666666666666]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842 
)
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.247, Test loss: 0.433, Test accuracy: 82.85
Average accuracy final 10 rounds: 82.52833333333334 

734.816445350647
[0.9066381454467773, 1.8132762908935547, 2.4688310623168945, 3.1243858337402344, 3.7769086360931396, 4.429431438446045, 5.089171648025513, 5.7489118576049805, 6.40894627571106, 7.068980693817139, 7.725963354110718, 8.382946014404297, 9.036772012710571, 9.690598011016846, 10.346153259277344, 11.001708507537842, 11.653510570526123, 12.305312633514404, 12.962798595428467, 13.62028455734253, 14.281194686889648, 14.942104816436768, 15.605681419372559, 16.26925802230835, 16.93216848373413, 17.595078945159912, 18.259077787399292, 18.923076629638672, 19.58505916595459, 20.247041702270508, 20.904507637023926, 21.561973571777344, 22.21959662437439, 22.877219676971436, 23.531081199645996, 24.184942722320557, 24.835586071014404, 25.486229419708252, 26.13531517982483, 26.784400939941406, 27.440388679504395, 28.096376419067383, 28.7541561126709, 29.411935806274414, 30.06708860397339, 30.722241401672363, 31.37909984588623, 32.0359582901001, 32.697224378585815, 33.35849046707153, 34.01450228691101, 34.67051410675049, 35.326345443725586, 35.982176780700684, 36.63953948020935, 37.29690217971802, 37.95320677757263, 38.609511375427246, 39.266693353652954, 39.92387533187866, 40.58037495613098, 41.2368745803833, 41.89144515991211, 42.54601573944092, 43.199303150177, 43.852590560913086, 44.502418756484985, 45.152246952056885, 45.804445028305054, 46.45664310455322, 47.10715889930725, 47.75767469406128, 48.41017746925354, 49.0626802444458, 49.71540832519531, 50.368136405944824, 51.01779222488403, 51.66744804382324, 52.32162261009216, 52.975797176361084, 53.632189989089966, 54.28858280181885, 54.94442415237427, 55.60026550292969, 56.253467082977295, 56.9066686630249, 57.560285329818726, 58.21390199661255, 58.86849308013916, 59.52308416366577, 60.1774582862854, 60.83183240890503, 61.48340582847595, 62.134979248046875, 62.78460502624512, 63.43423080444336, 64.07987856864929, 64.72552633285522, 65.37285828590393, 66.02019023895264, 66.67294406890869, 67.32569789886475, 67.97594857215881, 68.62619924545288, 69.27414798736572, 69.92209672927856, 70.57216954231262, 71.22224235534668, 71.87428259849548, 72.52632284164429, 73.18380093574524, 73.84127902984619, 74.4935245513916, 75.14577007293701, 75.79782009124756, 76.4498701095581, 77.10213899612427, 77.75440788269043, 78.40907144546509, 79.06373500823975, 79.71899938583374, 80.37426376342773, 81.02411675453186, 81.67396974563599, 82.3276059627533, 82.9812421798706, 83.6359510421753, 84.29065990447998, 84.94821095466614, 85.6057620048523, 86.26306962966919, 86.92037725448608, 87.57110095024109, 88.2218246459961, 88.87197542190552, 89.52212619781494, 90.17320489883423, 90.82428359985352, 91.47955656051636, 92.1348295211792, 92.78551006317139, 93.43619060516357, 94.08477091789246, 94.73335123062134, 95.38270831108093, 96.03206539154053, 96.68636202812195, 97.34065866470337, 97.99669885635376, 98.65273904800415, 99.30497074127197, 99.9572024345398, 100.60963702201843, 101.26207160949707, 101.91914772987366, 102.57622385025024, 103.22604465484619, 103.87586545944214, 104.5311176776886, 105.18636989593506, 105.83996224403381, 106.49355459213257, 107.14479923248291, 107.79604387283325, 108.44669246673584, 109.09734106063843, 109.75456881523132, 110.41179656982422, 111.06971454620361, 111.72763252258301, 112.37801671028137, 113.02840089797974, 113.6785078048706, 114.32861471176147, 114.98565649986267, 115.64269828796387, 116.29853010177612, 116.95436191558838, 117.60653042793274, 118.2586989402771, 118.91086769104004, 119.56303644180298, 120.21685194969177, 120.87066745758057, 121.52229285240173, 122.1739182472229, 122.8247754573822, 123.4756326675415, 124.12478065490723, 124.77392864227295, 125.42569017410278, 126.07745170593262, 126.73284149169922, 127.38823127746582, 128.04182505607605, 128.69541883468628, 129.35824823379517, 130.02107763290405, 130.68354082107544, 131.34600400924683, 132.53681540489197, 133.7276268005371]
[26.433333333333334, 26.433333333333334, 31.066666666666666, 31.066666666666666, 36.266666666666666, 36.266666666666666, 45.31666666666667, 45.31666666666667, 46.266666666666666, 46.266666666666666, 52.71666666666667, 52.71666666666667, 62.38333333333333, 62.38333333333333, 62.6, 62.6, 65.25, 65.25, 64.7, 64.7, 65.25, 65.25, 68.01666666666667, 68.01666666666667, 69.01666666666667, 69.01666666666667, 69.85, 69.85, 70.51666666666667, 70.51666666666667, 71.1, 71.1, 71.2, 71.2, 71.8, 71.8, 72.28333333333333, 72.28333333333333, 72.63333333333334, 72.63333333333334, 72.25, 72.25, 72.55, 72.55, 73.86666666666666, 73.86666666666666, 74.88333333333334, 74.88333333333334, 74.73333333333333, 74.73333333333333, 74.41666666666667, 74.41666666666667, 76.5, 76.5, 76.73333333333333, 76.73333333333333, 76.75, 76.75, 76.05, 76.05, 76.66666666666667, 76.66666666666667, 76.45, 76.45, 76.95, 76.95, 77.86666666666666, 77.86666666666666, 77.85, 77.85, 77.58333333333333, 77.58333333333333, 77.56666666666666, 77.56666666666666, 78.2, 78.2, 77.46666666666667, 77.46666666666667, 77.68333333333334, 77.68333333333334, 78.03333333333333, 78.03333333333333, 78.33333333333333, 78.33333333333333, 78.43333333333334, 78.43333333333334, 79.11666666666666, 79.11666666666666, 79.08333333333333, 79.08333333333333, 79.3, 79.3, 79.25, 79.25, 79.65, 79.65, 79.55, 79.55, 79.31666666666666, 79.31666666666666, 79.56666666666666, 79.56666666666666, 80.33333333333333, 80.33333333333333, 80.1, 80.1, 80.31666666666666, 80.31666666666666, 80.03333333333333, 80.03333333333333, 81.03333333333333, 81.03333333333333, 80.5, 80.5, 80.66666666666667, 80.66666666666667, 80.61666666666666, 80.61666666666666, 81.28333333333333, 81.28333333333333, 80.65, 80.65, 80.7, 80.7, 80.71666666666667, 80.71666666666667, 80.98333333333333, 80.98333333333333, 81.53333333333333, 81.53333333333333, 81.96666666666667, 81.96666666666667, 81.8, 81.8, 81.61666666666666, 81.61666666666666, 81.63333333333334, 81.63333333333334, 81.86666666666666, 81.86666666666666, 81.36666666666666, 81.36666666666666, 82.2, 82.2, 81.68333333333334, 81.68333333333334, 82.28333333333333, 82.28333333333333, 82.28333333333333, 82.28333333333333, 82.36666666666666, 82.36666666666666, 81.85, 81.85, 81.35, 81.35, 81.31666666666666, 81.31666666666666, 81.55, 81.55, 81.56666666666666, 81.56666666666666, 82.23333333333333, 82.23333333333333, 82.55, 82.55, 82.33333333333333, 82.33333333333333, 82.16666666666667, 82.16666666666667, 82.11666666666666, 82.11666666666666, 82.73333333333333, 82.73333333333333, 82.41666666666667, 82.41666666666667, 82.46666666666667, 82.46666666666667, 82.33333333333333, 82.33333333333333, 81.58333333333333, 81.58333333333333, 82.66666666666667, 82.66666666666667, 82.7, 82.7, 82.4, 82.4, 82.8, 82.8, 82.53333333333333, 82.53333333333333, 82.6, 82.6, 82.43333333333334, 82.43333333333334, 82.8, 82.8, 82.76666666666667, 82.76666666666667, 82.85, 82.85]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedper  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedper , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedper
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842 
)
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.329, Test loss: 0.892, Test accuracy: 75.49
Average accuracy final 10 rounds: 75.7635 

4978.052330255508
[5.016364097595215, 10.03272819519043, 15.021852731704712, 20.010977268218994, 25.034399032592773, 30.057820796966553, 34.90882849693298, 39.759836196899414, 44.59508180618286, 49.43032741546631, 54.416077852249146, 59.40182828903198, 64.54967498779297, 69.69752168655396, 74.75168418884277, 79.80584669113159, 84.74154949188232, 89.67725229263306, 94.58444285392761, 99.49163341522217, 104.36101365089417, 109.23039388656616, 114.17147731781006, 119.11256074905396, 123.97526264190674, 128.83796453475952, 133.88061094284058, 138.92325735092163, 143.88637113571167, 148.8494849205017, 153.84309649467468, 158.83670806884766, 163.7175235748291, 168.59833908081055, 173.48394918441772, 178.3695592880249, 183.2554383277893, 188.1413173675537, 193.0747368335724, 198.00815629959106, 202.8911736011505, 207.77419090270996, 212.61869049072266, 217.46319007873535, 221.73857259750366, 226.01395511627197, 230.2473168373108, 234.4806785583496, 238.73281693458557, 242.98495531082153, 247.24767136573792, 251.5103874206543, 256.44268798828125, 261.3749885559082, 266.23819041252136, 271.1013922691345, 275.95155334472656, 280.8017144203186, 285.67646312713623, 290.55121183395386, 295.4610822200775, 300.3709526062012, 305.2804594039917, 310.1899662017822, 314.47093892097473, 318.75191164016724, 323.035197019577, 327.3184823989868, 331.5806770324707, 335.8428716659546, 340.0957589149475, 344.34864616394043, 348.65726041793823, 352.96587467193604, 357.29550075531006, 361.6251268386841, 365.96872425079346, 370.31232166290283, 374.58078122138977, 378.8492407798767, 383.135858297348, 387.42247581481934, 391.6760139465332, 395.92955207824707, 400.1881294250488, 404.4467067718506, 408.6939480304718, 412.941189289093, 417.19660782814026, 421.4520263671875, 425.65939116477966, 429.8667559623718, 434.1024887561798, 438.3382215499878, 442.62885069847107, 446.91947984695435, 451.15947127342224, 455.39946269989014, 459.6005084514618, 463.80155420303345, 468.06679582595825, 472.33203744888306, 477.2542231082916, 482.1764087677002, 487.11854219436646, 492.0606756210327, 496.9359793663025, 501.81128311157227, 507.2284183502197, 512.6455535888672, 518.3100275993347, 523.9745016098022, 528.6596302986145, 533.3447589874268, 538.2057814598083, 543.0668039321899, 547.8272640705109, 552.5877242088318, 557.4575109481812, 562.3272976875305, 566.8908259868622, 571.4543542861938, 576.039089679718, 580.6238250732422, 585.3540341854095, 590.0842432975769, 594.8915441036224, 599.698844909668, 604.4750990867615, 609.251353263855, 614.2089111804962, 619.1664690971375, 623.9562058448792, 628.7459425926208, 633.5803246498108, 638.4147067070007, 643.2011141777039, 647.987521648407, 652.8501620292664, 657.7128024101257, 662.1263394355774, 666.539876461029, 671.3507761955261, 676.1616759300232, 680.465677022934, 684.7696781158447, 689.1209251880646, 693.4721722602844, 697.774495601654, 702.0768189430237, 706.4717905521393, 710.8667621612549, 715.1990637779236, 719.5313653945923, 723.8259115219116, 728.120457649231, 732.3946084976196, 736.6687593460083, 741.0356528759003, 745.4025464057922, 749.7058577537537, 754.0091691017151, 758.3387532234192, 762.6683373451233, 766.9340143203735, 771.1996912956238, 775.551634311676, 779.9035773277283, 784.2263782024384, 788.5491790771484, 792.8751554489136, 797.2011318206787, 801.458464384079, 805.7157969474792, 809.9635057449341, 814.2112145423889, 818.5627727508545, 822.9143309593201, 827.2803149223328, 831.6462988853455, 835.9975986480713, 840.3488984107971, 844.6264789104462, 848.9040594100952, 853.1377351284027, 857.3714108467102, 861.7002296447754, 866.0290484428406, 870.4176051616669, 874.8061618804932, 879.1613688468933, 883.5165758132935, 887.7727463245392, 892.0289168357849, 896.6960990428925, 901.36328125, 906.1062226295471, 910.8491640090942, 915.5700781345367, 920.2909922599792, 922.2660989761353, 924.2412056922913]
[38.25, 38.25, 45.8775, 45.8775, 50.5125, 50.5125, 54.01, 54.01, 57.635, 57.635, 60.48, 60.48, 62.2475, 62.2475, 63.6175, 63.6175, 64.925, 64.925, 65.9675, 65.9675, 67.1775, 67.1775, 67.8375, 67.8375, 67.8025, 67.8025, 68.82, 68.82, 69.085, 69.085, 69.24, 69.24, 70.13, 70.13, 70.905, 70.905, 71.2625, 71.2625, 71.8375, 71.8375, 72.03, 72.03, 72.615, 72.615, 72.46, 72.46, 73.0575, 73.0575, 73.1875, 73.1875, 72.8225, 72.8225, 73.5175, 73.5175, 73.25, 73.25, 73.7775, 73.7775, 73.8825, 73.8825, 74.0725, 74.0725, 74.3725, 74.3725, 74.315, 74.315, 74.445, 74.445, 74.0475, 74.0475, 74.685, 74.685, 74.5475, 74.5475, 74.655, 74.655, 74.6025, 74.6025, 74.65, 74.65, 74.8725, 74.8725, 75.2475, 75.2475, 75.1125, 75.1125, 75.195, 75.195, 75.0925, 75.0925, 75.23, 75.23, 75.1675, 75.1675, 74.6525, 74.6525, 74.7975, 74.7975, 75.5775, 75.5775, 75.615, 75.615, 75.5325, 75.5325, 75.1425, 75.1425, 75.1525, 75.1525, 75.29, 75.29, 75.2525, 75.2525, 75.3575, 75.3575, 75.5475, 75.5475, 75.295, 75.295, 75.4925, 75.4925, 75.18, 75.18, 76.0675, 76.0675, 75.725, 75.725, 75.5275, 75.5275, 75.6675, 75.6675, 75.4475, 75.4475, 75.6475, 75.6475, 75.7425, 75.7425, 75.16, 75.16, 75.3575, 75.3575, 75.57, 75.57, 75.74, 75.74, 75.6125, 75.6125, 75.76, 75.76, 75.67, 75.67, 75.6575, 75.6575, 75.6025, 75.6025, 75.9225, 75.9225, 75.6925, 75.6925, 75.9325, 75.9325, 75.7875, 75.7875, 75.61, 75.61, 75.6, 75.6, 75.75, 75.75, 75.4775, 75.4775, 75.8725, 75.8725, 75.8475, 75.8475, 75.83, 75.83, 76.0825, 76.0825, 76.15, 76.15, 75.935, 75.935, 75.6, 75.6, 75.6325, 75.6325, 75.64, 75.64, 75.805, 75.805, 75.6275, 75.6275, 75.9075, 75.9075, 75.9175, 75.9175, 75.85, 75.85, 75.72, 75.72, 75.4875, 75.4875]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  lg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: lg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
lg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 8394 (global); Percentage 2.73 (8394/307842 
)
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.039, Test loss: 1.018, Test accuracy: 81.18
Average accuracy final 10 rounds: 80.81083333333332 

1525.32390832901
[1.6208698749542236, 3.2417397499084473, 4.632605075836182, 6.023470401763916, 7.437958478927612, 8.852446556091309, 10.263679504394531, 11.674912452697754, 13.057212829589844, 14.439513206481934, 15.820663213729858, 17.201813220977783, 18.627142667770386, 20.05247211456299, 21.680169343948364, 23.30786657333374, 25.020594120025635, 26.73332166671753, 28.57537007331848, 30.417418479919434, 32.126182317733765, 33.834946155548096, 35.61389994621277, 37.39285373687744, 39.12099885940552, 40.849143981933594, 42.47017979621887, 44.09121561050415, 45.49595856666565, 46.90070152282715, 48.22790336608887, 49.555105209350586, 50.89416265487671, 52.23322010040283, 53.59433317184448, 54.95544624328613, 56.27628827095032, 57.5971302986145, 58.91270303726196, 60.228275775909424, 61.538084268569946, 62.84789276123047, 64.17459273338318, 65.50129270553589, 66.84126138687134, 68.18123006820679, 69.49655318260193, 70.81187629699707, 72.12195348739624, 73.43203067779541, 74.75620698928833, 76.08038330078125, 77.44745135307312, 78.81451940536499, 80.1260416507721, 81.4375638961792, 82.7322256565094, 84.0268874168396, 85.34268736839294, 86.65848731994629, 88.00957608222961, 89.36066484451294, 90.70291900634766, 92.04517316818237, 93.48508954048157, 94.92500591278076, 96.37869691848755, 97.83238792419434, 99.31472063064575, 100.79705333709717, 102.2723708152771, 103.74768829345703, 105.22857928276062, 106.70947027206421, 108.20044040679932, 109.69141054153442, 111.17132759094238, 112.65124464035034, 114.00807642936707, 115.36490821838379, 116.83996319770813, 118.31501817703247, 119.71087574958801, 121.10673332214355, 122.40632963180542, 123.70592594146729, 125.0405957698822, 126.37526559829712, 127.67134428024292, 128.96742296218872, 130.2758502960205, 131.5842776298523, 132.90530061721802, 134.22632360458374, 135.5730893611908, 136.91985511779785, 138.20404243469238, 139.4882297515869, 140.78959250450134, 142.09095525741577, 143.38153886795044, 144.6721224784851, 145.98043298721313, 147.28874349594116, 148.58746194839478, 149.8861804008484, 151.2061631679535, 152.5261459350586, 153.8451235294342, 155.16410112380981, 156.4401822090149, 157.71626329421997, 159.01641654968262, 160.31656980514526, 161.62801051139832, 162.93945121765137, 164.23700499534607, 165.53455877304077, 166.8500461578369, 168.16553354263306, 169.49557447433472, 170.82561540603638, 172.13578009605408, 173.44594478607178, 174.74215602874756, 176.03836727142334, 177.37210726737976, 178.70584726333618, 180.03239059448242, 181.35893392562866, 182.63878870010376, 183.91864347457886, 185.20522737503052, 186.49181127548218, 187.8013458251953, 189.11088037490845, 190.40705180168152, 191.7032232284546, 192.98386406898499, 194.26450490951538, 195.56598472595215, 196.86746454238892, 198.1790406703949, 199.49061679840088, 200.78637671470642, 202.08213663101196, 203.35110759735107, 204.62007856369019, 205.92165899276733, 207.22323942184448, 208.518319606781, 209.81339979171753, 211.10063362121582, 212.3878674507141, 213.67630338668823, 214.96473932266235, 216.25551962852478, 217.5462999343872, 218.8150336742401, 220.08376741409302, 221.3598186969757, 222.6358699798584, 223.92673516273499, 225.21760034561157, 226.5041651725769, 227.79072999954224, 229.06721997261047, 230.3437099456787, 231.6251790523529, 232.9066481590271, 234.20207858085632, 235.49750900268555, 236.7833390235901, 238.06916904449463, 239.34013175964355, 240.61109447479248, 241.93008160591125, 243.24906873703003, 244.53820061683655, 245.82733249664307, 247.11425065994263, 248.4011688232422, 249.70358777046204, 251.00600671768188, 252.30924677848816, 253.61248683929443, 254.90816736221313, 256.20384788513184, 257.5241551399231, 258.84446239471436, 260.1410028934479, 261.4375433921814, 262.7369203567505, 264.0362973213196, 265.3390166759491, 266.6417360305786, 267.9190969467163, 269.196457862854, 270.4734652042389, 271.7504725456238, 273.86665654182434, 275.9828405380249]
[25.758333333333333, 25.758333333333333, 40.63333333333333, 40.63333333333333, 47.075, 47.075, 56.7, 56.7, 59.175, 59.175, 60.416666666666664, 60.416666666666664, 63.875, 63.875, 67.94166666666666, 67.94166666666666, 67.94166666666666, 67.94166666666666, 70.45, 70.45, 71.66666666666667, 71.66666666666667, 70.95, 70.95, 72.44166666666666, 72.44166666666666, 73.55, 73.55, 73.83333333333333, 73.83333333333333, 74.25, 74.25, 75.25833333333334, 75.25833333333334, 75.74166666666666, 75.74166666666666, 76.275, 76.275, 75.61666666666666, 75.61666666666666, 76.83333333333333, 76.83333333333333, 76.75833333333334, 76.75833333333334, 76.48333333333333, 76.48333333333333, 76.14166666666667, 76.14166666666667, 76.98333333333333, 76.98333333333333, 77.09166666666667, 77.09166666666667, 78.18333333333334, 78.18333333333334, 78.51666666666667, 78.51666666666667, 78.575, 78.575, 78.3, 78.3, 78.64166666666667, 78.64166666666667, 78.76666666666667, 78.76666666666667, 79.18333333333334, 79.18333333333334, 79.175, 79.175, 79.23333333333333, 79.23333333333333, 79.35833333333333, 79.35833333333333, 78.825, 78.825, 78.55833333333334, 78.55833333333334, 78.59166666666667, 78.59166666666667, 78.65833333333333, 78.65833333333333, 79.00833333333334, 79.00833333333334, 79.5, 79.5, 79.74166666666666, 79.74166666666666, 80.05, 80.05, 80.3, 80.3, 79.65833333333333, 79.65833333333333, 79.75833333333334, 79.75833333333334, 80.05833333333334, 80.05833333333334, 80.225, 80.225, 80.175, 80.175, 80.09166666666667, 80.09166666666667, 80.075, 80.075, 80.06666666666666, 80.06666666666666, 79.65833333333333, 79.65833333333333, 79.88333333333334, 79.88333333333334, 79.45, 79.45, 79.575, 79.575, 80.05, 80.05, 80.29166666666667, 80.29166666666667, 80.06666666666666, 80.06666666666666, 80.35833333333333, 80.35833333333333, 80.24166666666666, 80.24166666666666, 80.55, 80.55, 80.25833333333334, 80.25833333333334, 80.48333333333333, 80.48333333333333, 80.56666666666666, 80.56666666666666, 80.625, 80.625, 80.525, 80.525, 80.41666666666667, 80.41666666666667, 79.725, 79.725, 79.475, 79.475, 79.575, 79.575, 80.29166666666667, 80.29166666666667, 80.375, 80.375, 80.35, 80.35, 80.59166666666667, 80.59166666666667, 80.275, 80.275, 79.98333333333333, 79.98333333333333, 80.08333333333333, 80.08333333333333, 80.6, 80.6, 80.75, 80.75, 80.73333333333333, 80.73333333333333, 81.025, 81.025, 80.51666666666667, 80.51666666666667, 80.575, 80.575, 80.6, 80.6, 80.825, 80.825, 81.06666666666666, 81.06666666666666, 80.81666666666666, 80.81666666666666, 80.48333333333333, 80.48333333333333, 80.68333333333334, 80.68333333333334, 80.50833333333334, 80.50833333333334, 80.53333333333333, 80.53333333333333, 80.99166666666666, 80.99166666666666, 80.85833333333333, 80.85833333333333, 80.86666666666666, 80.86666666666666, 80.83333333333333, 80.83333333333333, 80.81666666666666, 80.81666666666666, 80.925, 80.925, 81.09166666666667, 81.09166666666667, 81.18333333333334, 81.18333333333334]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_apfl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
Final Round, Train loss: 0.049, Test loss: 0.746, Test accuracy: 68.45
Average accuracy final 10 rounds: 67.58583333333333
1839.7670996189117
[]
[29.808333333333334, 27.775, 34.11666666666667, 38.59166666666667, 46.80833333333333, 47.81666666666667, 44.65, 43.65833333333333, 44.53333333333333, 45.45, 45.30833333333333, 46.74166666666667, 51.166666666666664, 51.40833333333333, 52.108333333333334, 52.858333333333334, 51.65833333333333, 52.63333333333333, 54.81666666666667, 53.88333333333333, 55.35, 55.141666666666666, 53.05, 54.525, 54.775, 55.833333333333336, 55.975, 54.925, 56.358333333333334, 55.375, 54.74166666666667, 55.81666666666667, 55.75, 56.35, 56.166666666666664, 55.15833333333333, 58.166666666666664, 58.09166666666667, 58.583333333333336, 59.275, 58.625, 58.725, 59.61666666666667, 58.24166666666667, 57.875, 58.7, 60.34166666666667, 61.333333333333336, 61.19166666666667, 61.375, 62.583333333333336, 61.891666666666666, 61.38333333333333, 61.11666666666667, 62.05, 62.525, 63.46666666666667, 62.983333333333334, 62.916666666666664, 64.775, 64.75, 63.9, 64.20833333333333, 63.925, 65.59166666666667, 65.325, 65.05833333333334, 65.8, 64.8, 65.25833333333334, 64.29166666666667, 65.38333333333334, 64.29166666666667, 64.70833333333333, 65.29166666666667, 64.85, 66.2, 65.13333333333334, 66.54166666666667, 65.525, 64.61666666666666, 65.70833333333333, 65.9, 65.90833333333333, 66.89166666666667, 66.7, 65.725, 65.975, 65.225, 66.40833333333333, 66.44166666666666, 65.84166666666667, 65.50833333333334, 68.01666666666667, 68.05, 67.76666666666667, 69.19166666666666, 67.51666666666667, 68.89166666666667, 68.63333333333334, 68.45]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Fed_scaffold %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Final Round, Train loss: 0.573, Test loss: 0.558, Test accuracy: 77.44
Average accuracy final 10 rounds: 77.0725
Average global accuracy final 10 rounds: 77.0725
1357.46582198143
[]
[30.208333333333332, 44.84166666666667, 44.9, 51.03333333333333, 55.825, 62.50833333333333, 61.45, 62.625, 64.6, 65.84166666666667, 65.26666666666667, 64.99166666666666, 66.425, 68.48333333333333, 68.65833333333333, 68.2, 69.71666666666667, 70.18333333333334, 70.51666666666667, 70.325, 70.16666666666667, 70.80833333333334, 70.85, 70.99166666666666, 70.925, 71.775, 71.44166666666666, 70.53333333333333, 72.09166666666667, 72.525, 73.19166666666666, 72.25, 73.65833333333333, 74.75, 74.85833333333333, 74.65833333333333, 75.00833333333334, 75.28333333333333, 75.20833333333333, 74.90833333333333, 74.7, 74.35833333333333, 74.59166666666667, 74.5, 74.8, 74.20833333333333, 74.375, 74.34166666666667, 74.775, 74.85833333333333, 74.525, 74.1, 74.10833333333333, 74.175, 75.425, 75.10833333333333, 75.75, 76.15, 76.55, 76.96666666666667, 77.6, 77.45833333333333, 77.65833333333333, 77.48333333333333, 76.68333333333334, 76.44166666666666, 76.91666666666667, 76.65, 76.46666666666667, 76.2, 76.75833333333334, 76.76666666666667, 76.36666666666666, 75.81666666666666, 76.28333333333333, 76.35833333333333, 76.91666666666667, 77.375, 77.16666666666667, 77.1, 76.70833333333333, 76.98333333333333, 76.9, 77.44166666666666, 77.325, 77.425, 77.375, 77.06666666666666, 77.2, 77.3, 77.23333333333333, 77.09166666666667, 77.875, 78.03333333333333, 77.31666666666666, 76.775, 76.35833333333333, 76.71666666666667, 76.15, 77.175, 77.44166666666666]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_ditto%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
Final Round, Train loss: 0.163, Test loss: 1.070, Test accuracy: 66.91
Average accuracy final 10 rounds: 62.64999999999999
2407.990555047989
[3.8178532123565674, 7.424312591552734, 10.79268193244934, 14.202137470245361, 17.60018038749695, 20.97981882095337, 24.30562424659729, 27.70861029624939, 31.088043689727783, 34.49903106689453, 37.88311982154846, 41.29109597206116, 44.67161750793457, 48.08990716934204, 51.50739765167236, 54.90304183959961, 58.29339027404785, 61.73516511917114, 65.15950775146484, 68.54207682609558, 71.93524408340454, 75.36072707176208, 78.75400280952454, 82.13612127304077, 85.50204253196716, 88.8886296749115, 92.29623222351074, 95.69445538520813, 99.04831075668335, 102.39633393287659, 105.80082058906555, 109.20182013511658, 112.64568281173706, 116.05007982254028, 119.47193765640259, 122.8953685760498, 126.35168027877808, 129.6994550228119, 133.11949372291565, 136.54532957077026, 139.99552512168884, 143.4227077960968, 146.85330486297607, 150.30621671676636, 153.81890869140625, 157.28755712509155, 160.88517022132874, 164.41802501678467, 167.81214904785156, 171.18428540229797, 174.55242943763733, 177.9549331665039, 181.36996793746948, 184.8591866493225, 188.17762923240662, 191.59168100357056, 194.94247269630432, 198.32164692878723, 201.64906287193298, 205.03868579864502, 208.46787095069885, 211.86685037612915, 215.24874448776245, 218.62479376792908, 222.04002594947815, 225.4133267402649, 228.83696150779724, 232.209144115448, 235.61276984214783, 239.0166666507721, 242.45007300376892, 245.84758734703064, 249.29664063453674, 252.63941025733948, 256.0370662212372, 259.4197027683258, 262.85014843940735, 266.25413703918457, 269.6597855091095, 273.06925201416016, 276.6849069595337, 280.2855968475342, 283.7042033672333, 287.06886863708496, 290.46539187431335, 293.7843236923218, 297.20274114608765, 300.52839255332947, 304.1619379520416, 307.77367329597473, 311.3371753692627, 314.62992906570435, 317.98955249786377, 321.6785349845886, 325.39179611206055, 329.0553059577942, 332.7420039176941, 336.36754989624023, 340.01090455055237, 343.4203300476074, 346.33541464805603]
[20.008333333333333, 27.033333333333335, 24.233333333333334, 28.558333333333334, 35.791666666666664, 34.56666666666667, 36.833333333333336, 38.166666666666664, 43.608333333333334, 36.325, 47.24166666666667, 46.05, 37.025, 45.96666666666667, 48.15833333333333, 46.166666666666664, 52.30833333333333, 44.925, 47.575, 52.55, 48.13333333333333, 50.44166666666667, 51.475, 46.583333333333336, 47.791666666666664, 53.85, 43.108333333333334, 53.7, 53.525, 54.833333333333336, 57.8, 56.71666666666667, 54.95, 51.358333333333334, 57.516666666666666, 55.1, 58.34166666666667, 55.075, 51.78333333333333, 53.983333333333334, 56.81666666666667, 56.43333333333333, 54.925, 56.36666666666667, 52.775, 55.625, 56.99166666666667, 60.675, 57.391666666666666, 55.00833333333333, 58.56666666666667, 63.18333333333333, 61.00833333333333, 62.375, 62.358333333333334, 58.3, 61.50833333333333, 57.43333333333333, 56.4, 59.583333333333336, 61.5, 62.416666666666664, 56.84166666666667, 59.541666666666664, 62.05833333333333, 61.641666666666666, 59.55, 61.43333333333333, 59.291666666666664, 58.80833333333333, 60.858333333333334, 62.833333333333336, 60.958333333333336, 62.233333333333334, 55.31666666666667, 56.68333333333333, 58.28333333333333, 62.075, 60.475, 60.391666666666666, 60.525, 62.416666666666664, 64.675, 62.19166666666667, 60.291666666666664, 60.4, 61.391666666666666, 60.225, 63.38333333333333, 63.458333333333336, 63.30833333333333, 63.34166666666667, 63.766666666666666, 57.541666666666664, 63.075, 64.325, 62.50833333333333, 61.358333333333334, 64.4, 62.875, 66.90833333333333]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  pFedMe   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Traceback (most recent call last):
  File "main_pfedme.py", line 236, in <module>
    w_local, loss, indd = local.train(net=net_local.to(args.device), idx=idx, w_glob_keys=w_glob_keys, lr=args.lr, last=last, concept_matrix_local=concept_matrix[idx],w_locals = w_locals)
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 825, in train
    for batch_idx, (images, labels) in enumerate(self.ldr_train):
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 675, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 35, in __getitem__
    image, label = self.dataset[self.idxs[item]]
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torchvision/datasets/cifar.py", line 111, in __getitem__
    img, target = self.data[index], self.targets[index]
IndexError: index 58235 is out of bounds for axis 0 with size 50000
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Traceback (most recent call last):
  File "main_fedpac.py", line 232, in <module>
    w_local, loss, indd, class_center_local, class_num = local.train(net=net_local.to(args.device), class_center_glob=class_center_glob, idx=idx, w_glob_keys=w_glob_keys, lr=args.lr, last=last, concept_matrix_local=concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1272, in train
    for batch_idx, (images, labels) in enumerate(self.ldr_train):
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 675, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 35, in __getitem__
    image, label = self.dataset[self.idxs[item]]
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torchvision/datasets/cifar.py", line 111, in __getitem__
    img, target = self.data[index], self.targets[index]
IndexError: index 53709 is out of bounds for axis 0 with size 50000
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC-K-Means%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
4800
4864
107264
107328
299328
299448
307128
307192
307832
307842
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Final Round, Train loss: 0.215, Test loss: 0.373, Test accuracy: 85.83
Average accuracy final 10 rounds: 85.36333333333333
1649.208075761795
[2.1210596561431885, 4.242119312286377, 5.909784317016602, 7.577449321746826, 9.18256664276123, 10.787683963775635, 12.360110998153687, 13.932538032531738, 15.45419454574585, 16.97585105895996, 18.527546644210815, 20.07924222946167, 21.78557562828064, 23.49190902709961, 25.146480560302734, 26.80105209350586, 28.399035215377808, 29.997018337249756, 31.63840675354004, 33.27979516983032, 34.91660165786743, 36.55340814590454, 38.15125322341919, 39.74909830093384, 41.39940142631531, 43.04970455169678, 44.74054789543152, 46.43139123916626, 47.954999685287476, 49.47860813140869, 51.06847095489502, 52.65833377838135, 54.251904010772705, 55.84547424316406, 57.428446769714355, 59.01141929626465, 60.604586601257324, 62.19775390625, 63.82208490371704, 65.44641590118408, 66.97963571548462, 68.51285552978516, 70.10514616966248, 71.6974368095398, 73.34346842765808, 74.98950004577637, 76.55047535896301, 78.11145067214966, 79.64500164985657, 81.17855262756348, 82.75786113739014, 84.3371696472168, 85.90829396247864, 87.47941827774048, 89.01172184944153, 90.54402542114258, 92.13007664680481, 93.71612787246704, 95.2695426940918, 96.82295751571655, 98.33693027496338, 99.8509030342102, 101.3977038860321, 102.944504737854, 104.58964037895203, 106.23477602005005, 107.78309679031372, 109.33141756057739, 110.89743280410767, 112.46344804763794, 114.07480955123901, 115.68617105484009, 117.25644540786743, 118.82671976089478, 120.37913012504578, 121.93154048919678, 123.54799365997314, 125.16444683074951, 126.71835041046143, 128.27225399017334, 129.80702304840088, 131.34179210662842, 132.91081476211548, 134.47983741760254, 136.0504858493805, 137.62113428115845, 139.1550648212433, 140.68899536132812, 142.38507604599, 144.08115673065186, 145.7536027431488, 147.42604875564575, 148.97497463226318, 150.52390050888062, 152.08985686302185, 153.6558132171631, 155.22841596603394, 156.80101871490479, 158.3558759689331, 159.91073322296143, 161.4502923488617, 162.98985147476196, 164.56381630897522, 166.13778114318848, 167.71016883850098, 169.28255653381348, 170.92397952079773, 172.56540250778198, 174.22550177574158, 175.88560104370117, 177.53349566459656, 179.18139028549194, 180.8905544281006, 182.59971857070923, 184.31727766990662, 186.034836769104, 187.73688316345215, 189.4389295578003, 191.07892489433289, 192.71892023086548, 194.45369744300842, 196.18847465515137, 197.862774848938, 199.5370750427246, 201.21692609786987, 202.89677715301514, 204.62144780158997, 206.3461184501648, 208.07420778274536, 209.80229711532593, 211.49585461616516, 213.1894121170044, 214.89941787719727, 216.60942363739014, 218.31918168067932, 220.0289397239685, 221.73769521713257, 223.44645071029663, 225.19645953178406, 226.94646835327148, 228.5862340927124, 230.22599983215332, 231.78826332092285, 233.35052680969238, 234.92745757102966, 236.50438833236694, 238.0334050655365, 239.56242179870605, 241.0853295326233, 242.60823726654053, 244.15000700950623, 245.69177675247192, 247.22805333137512, 248.76432991027832, 250.28749299049377, 251.81065607070923, 253.3352768421173, 254.8598976135254, 256.38132524490356, 257.90275287628174, 259.44001483917236, 260.977276802063, 262.60183548927307, 264.22639417648315, 265.8518168926239, 267.47723960876465, 268.99873447418213, 270.5202293395996, 272.1016516685486, 273.68307399749756, 275.2586770057678, 276.8342800140381, 278.3497042655945, 279.8651285171509, 281.3862998485565, 282.90747117996216, 284.4321222305298, 285.9567732810974, 287.4823694229126, 289.0079655647278, 290.52937173843384, 292.0507779121399, 293.59717059135437, 295.14356327056885, 296.67238569259644, 298.201208114624, 299.7455995082855, 301.289990901947, 302.86350560188293, 304.43702030181885, 305.99471712112427, 307.5524139404297, 309.0825674533844, 310.6127209663391, 312.258731842041, 313.9047427177429, 315.54587864875793, 317.18701457977295, 318.79011034965515, 320.39320611953735, 322.5570077896118, 324.7208094596863]
[20.683333333333334, 20.683333333333334, 38.475, 38.475, 46.49166666666667, 46.49166666666667, 58.425, 58.425, 61.041666666666664, 61.041666666666664, 63.208333333333336, 63.208333333333336, 65.79166666666667, 65.79166666666667, 68.56666666666666, 68.56666666666666, 70.975, 70.975, 72.48333333333333, 72.48333333333333, 73.325, 73.325, 73.63333333333334, 73.63333333333334, 74.45833333333333, 74.45833333333333, 74.775, 74.775, 75.35, 75.35, 75.61666666666666, 75.61666666666666, 75.94166666666666, 75.94166666666666, 76.63333333333334, 76.63333333333334, 76.575, 76.575, 77.73333333333333, 77.73333333333333, 77.58333333333333, 77.58333333333333, 77.89166666666667, 77.89166666666667, 78.85, 78.85, 79.06666666666666, 79.06666666666666, 79.025, 79.025, 79.55, 79.55, 79.55, 79.55, 80.05833333333334, 80.05833333333334, 80.35, 80.35, 80.375, 80.375, 80.64166666666667, 80.64166666666667, 80.35, 80.35, 80.39166666666667, 80.39166666666667, 81.325, 81.325, 81.475, 81.475, 80.95833333333333, 80.95833333333333, 80.55, 80.55, 80.875, 80.875, 80.5, 80.5, 81.80833333333334, 81.80833333333334, 81.71666666666667, 81.71666666666667, 81.93333333333334, 81.93333333333334, 82.00833333333334, 82.00833333333334, 82.225, 82.225, 82.31666666666666, 82.31666666666666, 83.09166666666667, 83.09166666666667, 82.825, 82.825, 82.65833333333333, 82.65833333333333, 83.1, 83.1, 82.55, 82.55, 82.90833333333333, 82.90833333333333, 83.525, 83.525, 83.18333333333334, 83.18333333333334, 83.64166666666667, 83.64166666666667, 83.175, 83.175, 83.65, 83.65, 83.85, 83.85, 83.70833333333333, 83.70833333333333, 83.84166666666667, 83.84166666666667, 84.16666666666667, 84.16666666666667, 84.24166666666666, 84.24166666666666, 84.25833333333334, 84.25833333333334, 84.21666666666667, 84.21666666666667, 84.51666666666667, 84.51666666666667, 84.23333333333333, 84.23333333333333, 84.36666666666666, 84.36666666666666, 84.40833333333333, 84.40833333333333, 84.56666666666666, 84.56666666666666, 84.25833333333334, 84.25833333333334, 84.39166666666667, 84.39166666666667, 84.15833333333333, 84.15833333333333, 84.34166666666667, 84.34166666666667, 84.65, 84.65, 84.45833333333333, 84.45833333333333, 84.41666666666667, 84.41666666666667, 84.86666666666666, 84.86666666666666, 84.89166666666667, 84.89166666666667, 84.73333333333333, 84.73333333333333, 84.425, 84.425, 84.70833333333333, 84.70833333333333, 85.05833333333334, 85.05833333333334, 84.45, 84.45, 84.70833333333333, 84.70833333333333, 84.74166666666666, 84.74166666666666, 84.98333333333333, 84.98333333333333, 85.26666666666667, 85.26666666666667, 85.08333333333333, 85.08333333333333, 84.96666666666667, 84.96666666666667, 85.15833333333333, 85.15833333333333, 85.725, 85.725, 85.01666666666667, 85.01666666666667, 85.24166666666666, 85.24166666666666, 85.56666666666666, 85.56666666666666, 85.18333333333334, 85.18333333333334, 85.45, 85.45, 85.44166666666666, 85.44166666666666, 85.44166666666666, 85.44166666666666, 85.3, 85.3, 85.49166666666666, 85.49166666666666, 85.5, 85.5, 85.825, 85.825]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.058, Test loss: 1.028, Test accuracy: 80.04
Final Round, Global train loss: 0.058, Global test loss: 1.989, Global test accuracy: 32.63
Average accuracy final 10 rounds: 79.59916666666666 

Average global accuracy final 10 rounds: 26.029999999999998 

1810.3538954257965
[1.609360694885254, 3.218721389770508, 4.5869140625, 5.955106735229492, 7.385869979858398, 8.816633224487305, 10.437080144882202, 12.0575270652771, 13.49044394493103, 14.923360824584961, 16.391185760498047, 17.859010696411133, 19.292522192001343, 20.726033687591553, 22.21331524848938, 23.700596809387207, 25.165102243423462, 26.629607677459717, 28.083008527755737, 29.536409378051758, 30.99995517730713, 32.4635009765625, 33.916221141815186, 35.36894130706787, 36.78381824493408, 38.19869518280029, 39.68005394935608, 41.161412715911865, 42.631410360336304, 44.10140800476074, 45.56819772720337, 47.034987449645996, 48.48869466781616, 49.94240188598633, 51.391117811203, 52.83983373641968, 54.278706789016724, 55.71757984161377, 57.18713450431824, 58.656689167022705, 60.12229132652283, 61.58789348602295, 63.040940046310425, 64.4939866065979, 65.95756435394287, 67.42114210128784, 68.82442283630371, 70.22770357131958, 71.67771863937378, 73.12773370742798, 74.61517429351807, 76.10261487960815, 77.54547882080078, 78.98834276199341, 80.40457725524902, 81.82081174850464, 83.11109495162964, 84.40137815475464, 85.68555355072021, 86.96972894668579, 88.2375316619873, 89.50533437728882, 90.77452182769775, 92.04370927810669, 93.33271193504333, 94.62171459197998, 95.92311501502991, 97.22451543807983, 98.49691653251648, 99.76931762695312, 101.03294324874878, 102.29656887054443, 103.58773016929626, 104.8788914680481, 106.19453954696655, 107.51018762588501, 108.79258584976196, 110.07498407363892, 111.38984417915344, 112.70470428466797, 114.01017117500305, 115.31563806533813, 116.5949215888977, 117.87420511245728, 119.18523287773132, 120.49626064300537, 121.78318476676941, 123.07010889053345, 124.33020377159119, 125.59029865264893, 126.86766910552979, 128.14503955841064, 129.42099142074585, 130.69694328308105, 131.98879528045654, 133.28064727783203, 134.57226634025574, 135.86388540267944, 137.1340527534485, 138.40422010421753, 139.68161153793335, 140.95900297164917, 142.25648522377014, 143.5539674758911, 144.81346988677979, 146.07297229766846, 147.33317828178406, 148.59338426589966, 149.88426899909973, 151.1751537322998, 152.44908237457275, 153.7230110168457, 155.01020693778992, 156.29740285873413, 157.5663321018219, 158.83526134490967, 160.10675621032715, 161.37825107574463, 162.66262650489807, 163.9470019340515, 165.23445844650269, 166.52191495895386, 167.8206114768982, 169.11930799484253, 170.42356991767883, 171.72783184051514, 173.02721667289734, 174.32660150527954, 175.60636448860168, 176.88612747192383, 178.1758735179901, 179.4656195640564, 180.7625377178192, 182.05945587158203, 183.36642241477966, 184.6733889579773, 185.9723606109619, 187.27133226394653, 188.54228281974792, 189.81323337554932, 191.07346606254578, 192.33369874954224, 193.60178756713867, 194.8698763847351, 196.15021634101868, 197.43055629730225, 198.69078493118286, 199.95101356506348, 201.21370315551758, 202.47639274597168, 203.74169826507568, 205.0070037841797, 206.28002738952637, 207.55305099487305, 208.80338406562805, 210.05371713638306, 211.29867005348206, 212.54362297058105, 213.7814223766327, 215.01922178268433, 216.27518391609192, 217.5311460494995, 218.77878189086914, 220.02641773223877, 221.2603404521942, 222.49426317214966, 223.7465488910675, 224.99883460998535, 226.24948859214783, 227.5001425743103, 228.74225902557373, 229.98437547683716, 231.223308801651, 232.46224212646484, 233.71166586875916, 234.96108961105347, 236.21267795562744, 237.46426630020142, 238.69967484474182, 239.93508338928223, 241.1787292957306, 242.42237520217896, 243.66723942756653, 244.9121036529541, 246.14795517921448, 247.38380670547485, 248.61320281028748, 249.8425989151001, 251.09008240699768, 252.33756589889526, 253.57844352722168, 254.8193211555481, 256.0584440231323, 257.29756689071655, 258.54084300994873, 259.7841191291809, 261.04276633262634, 262.3014135360718, 263.5741217136383, 264.84682989120483, 267.2532362937927, 269.6596426963806]
[33.0, 33.0, 47.166666666666664, 47.166666666666664, 52.275, 52.275, 61.13333333333333, 61.13333333333333, 60.19166666666667, 60.19166666666667, 62.833333333333336, 62.833333333333336, 61.516666666666666, 61.516666666666666, 65.15, 65.15, 63.975, 63.975, 68.08333333333333, 68.08333333333333, 66.9, 66.9, 67.025, 67.025, 71.45833333333333, 71.45833333333333, 67.71666666666667, 67.71666666666667, 69.60833333333333, 69.60833333333333, 70.875, 70.875, 75.7, 75.7, 75.975, 75.975, 76.225, 76.225, 75.76666666666667, 75.76666666666667, 75.725, 75.725, 75.48333333333333, 75.48333333333333, 75.46666666666667, 75.46666666666667, 75.80833333333334, 75.80833333333334, 75.91666666666667, 75.91666666666667, 76.81666666666666, 76.81666666666666, 77.1, 77.1, 77.55833333333334, 77.55833333333334, 77.39166666666667, 77.39166666666667, 77.41666666666667, 77.41666666666667, 77.55833333333334, 77.55833333333334, 77.55833333333334, 77.55833333333334, 77.84166666666667, 77.84166666666667, 77.35, 77.35, 77.79166666666667, 77.79166666666667, 78.3, 78.3, 78.39166666666667, 78.39166666666667, 78.375, 78.375, 78.375, 78.375, 78.725, 78.725, 78.625, 78.625, 78.41666666666667, 78.41666666666667, 78.49166666666666, 78.49166666666666, 78.65, 78.65, 78.8, 78.8, 79.00833333333334, 79.00833333333334, 78.825, 78.825, 78.875, 78.875, 78.9, 78.9, 78.825, 78.825, 78.86666666666666, 78.86666666666666, 79.14166666666667, 79.14166666666667, 79.40833333333333, 79.40833333333333, 79.31666666666666, 79.31666666666666, 79.28333333333333, 79.28333333333333, 79.24166666666666, 79.24166666666666, 79.16666666666667, 79.16666666666667, 79.05833333333334, 79.05833333333334, 78.75833333333334, 78.75833333333334, 78.70833333333333, 78.70833333333333, 78.24166666666666, 78.24166666666666, 78.58333333333333, 78.58333333333333, 78.93333333333334, 78.93333333333334, 78.85833333333333, 78.85833333333333, 78.78333333333333, 78.78333333333333, 79.25833333333334, 79.25833333333334, 79.58333333333333, 79.58333333333333, 79.50833333333334, 79.50833333333334, 79.19166666666666, 79.19166666666666, 79.33333333333333, 79.33333333333333, 79.375, 79.375, 79.475, 79.475, 78.85, 78.85, 79.16666666666667, 79.16666666666667, 79.49166666666666, 79.49166666666666, 79.24166666666666, 79.24166666666666, 78.94166666666666, 78.94166666666666, 79.11666666666666, 79.11666666666666, 79.56666666666666, 79.56666666666666, 79.68333333333334, 79.68333333333334, 79.41666666666667, 79.41666666666667, 79.5, 79.5, 79.45833333333333, 79.45833333333333, 79.34166666666667, 79.34166666666667, 79.175, 79.175, 79.16666666666667, 79.16666666666667, 79.21666666666667, 79.21666666666667, 79.3, 79.3, 79.36666666666666, 79.36666666666666, 79.55833333333334, 79.55833333333334, 79.64166666666667, 79.64166666666667, 79.425, 79.425, 79.43333333333334, 79.43333333333334, 79.65, 79.65, 79.60833333333333, 79.60833333333333, 79.875, 79.875, 79.68333333333334, 79.68333333333334, 79.58333333333333, 79.58333333333333, 79.64166666666667, 79.64166666666667, 79.45, 79.45, 80.04166666666667, 80.04166666666667]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.152, Test loss: 0.495, Test accuracy: 86.00
Final Round, Global train loss: 0.152, Global test loss: 1.462, Global test accuracy: 59.88
Average accuracy final 10 rounds: 85.4775 

Average global accuracy final 10 rounds: 66.64916666666667 

1809.4219617843628
[1.6397664546966553, 3.2795329093933105, 4.659959077835083, 6.0403852462768555, 7.453839302062988, 8.867293357849121, 10.279869318008423, 11.692445278167725, 13.091654062271118, 14.490862846374512, 15.90920114517212, 17.327539443969727, 18.789653778076172, 20.251768112182617, 21.701507568359375, 23.151247024536133, 24.582286596298218, 26.013326168060303, 27.470691919326782, 28.92805767059326, 30.35317611694336, 31.778294563293457, 33.240174770355225, 34.70205497741699, 36.1061224937439, 37.5101900100708, 38.93978238105774, 40.36937475204468, 41.80388951301575, 43.238404273986816, 44.67634105682373, 46.114277839660645, 47.53536558151245, 48.95645332336426, 50.37647557258606, 51.79649782180786, 53.2147536277771, 54.63300943374634, 56.053404569625854, 57.47379970550537, 58.91081881523132, 60.347837924957275, 61.76723337173462, 63.18662881851196, 64.62022423744202, 66.05381965637207, 67.48720598220825, 68.92059230804443, 70.36402583122253, 71.80745935440063, 73.23584508895874, 74.66423082351685, 76.10158252716064, 77.53893423080444, 78.97589063644409, 80.41284704208374, 81.84371995925903, 83.27459287643433, 84.71752572059631, 86.1604585647583, 87.60700869560242, 89.05355882644653, 90.4875876903534, 91.92161655426025, 93.34927201271057, 94.77692747116089, 96.21775269508362, 97.65857791900635, 99.09440040588379, 100.53022289276123, 101.9706563949585, 103.41108989715576, 104.86259341239929, 106.31409692764282, 107.75558996200562, 109.19708299636841, 110.638742685318, 112.08040237426758, 113.52139663696289, 114.9623908996582, 116.39064598083496, 117.81890106201172, 119.24556469917297, 120.67222833633423, 122.10238528251648, 123.53254222869873, 124.96743988990784, 126.40233755111694, 127.82263350486755, 129.24292945861816, 130.67671823501587, 132.11050701141357, 133.54994368553162, 134.98938035964966, 136.42730450630188, 137.8652286529541, 139.29307556152344, 140.72092247009277, 141.9581413269043, 143.19536018371582, 144.4235188961029, 145.65167760849, 146.8777916431427, 148.1039056777954, 149.33883476257324, 150.57376384735107, 151.79204058647156, 153.01031732559204, 154.2300362586975, 155.44975519180298, 156.68337774276733, 157.9170002937317, 159.14023232460022, 160.36346435546875, 161.5948839187622, 162.82630348205566, 164.05385756492615, 165.28141164779663, 166.517502784729, 167.75359392166138, 168.98597836494446, 170.21836280822754, 171.43905019760132, 172.6597375869751, 173.88647508621216, 175.11321258544922, 176.3466558456421, 177.58009910583496, 178.80455422401428, 180.0290093421936, 181.26016402244568, 182.49131870269775, 183.7291555404663, 184.96699237823486, 186.1867651939392, 187.40653800964355, 188.63043022155762, 189.85432243347168, 191.0774998664856, 192.3006772994995, 193.51960921287537, 194.73854112625122, 195.9716923236847, 197.20484352111816, 198.4348418712616, 199.66484022140503, 200.89417910575867, 202.1235179901123, 203.35323429107666, 204.58295059204102, 205.81695675849915, 207.05096292495728, 208.27856922149658, 209.5061755180359, 210.73494124412537, 211.96370697021484, 213.19663667678833, 214.42956638336182, 215.66809391975403, 216.90662145614624, 218.14791917800903, 219.38921689987183, 220.61961603164673, 221.85001516342163, 223.09099125862122, 224.3319673538208, 225.56358003616333, 226.79519271850586, 228.02914571762085, 229.26309871673584, 230.4932360649109, 231.72337341308594, 232.9562873840332, 234.18920135498047, 235.41745257377625, 236.64570379257202, 237.87344908714294, 239.10119438171387, 240.3270444869995, 241.55289459228516, 242.78830814361572, 244.0237216949463, 245.24405670166016, 246.46439170837402, 247.6918272972107, 248.91926288604736, 250.13965725898743, 251.3600516319275, 252.58591151237488, 253.81177139282227, 255.0415506362915, 256.27132987976074, 257.50398778915405, 258.73664569854736, 260.2014629840851, 261.6662802696228, 263.10877561569214, 264.5512709617615, 265.9933488368988, 267.43542671203613, 269.844131231308, 272.25283575057983]
[29.383333333333333, 29.383333333333333, 34.666666666666664, 34.666666666666664, 49.59166666666667, 49.59166666666667, 53.69166666666667, 53.69166666666667, 57.375, 57.375, 68.44166666666666, 68.44166666666666, 66.55833333333334, 66.55833333333334, 69.40833333333333, 69.40833333333333, 68.45, 68.45, 72.175, 72.175, 72.75833333333334, 72.75833333333334, 73.84166666666667, 73.84166666666667, 73.36666666666666, 73.36666666666666, 74.99166666666666, 74.99166666666666, 75.65833333333333, 75.65833333333333, 75.71666666666667, 75.71666666666667, 78.15833333333333, 78.15833333333333, 78.99166666666666, 78.99166666666666, 79.69166666666666, 79.69166666666666, 79.71666666666667, 79.71666666666667, 79.925, 79.925, 80.69166666666666, 80.69166666666666, 80.83333333333333, 80.83333333333333, 80.63333333333334, 80.63333333333334, 80.825, 80.825, 81.31666666666666, 81.31666666666666, 81.425, 81.425, 81.93333333333334, 81.93333333333334, 82.00833333333334, 82.00833333333334, 82.35, 82.35, 82.73333333333333, 82.73333333333333, 82.75833333333334, 82.75833333333334, 82.43333333333334, 82.43333333333334, 82.15833333333333, 82.15833333333333, 82.50833333333334, 82.50833333333334, 82.625, 82.625, 82.71666666666667, 82.71666666666667, 82.95, 82.95, 83.0, 83.0, 83.38333333333334, 83.38333333333334, 83.48333333333333, 83.48333333333333, 84.04166666666667, 84.04166666666667, 83.46666666666667, 83.46666666666667, 83.125, 83.125, 83.48333333333333, 83.48333333333333, 83.23333333333333, 83.23333333333333, 83.225, 83.225, 83.15, 83.15, 83.99166666666666, 83.99166666666666, 84.26666666666667, 84.26666666666667, 84.25833333333334, 84.25833333333334, 84.54166666666667, 84.54166666666667, 84.175, 84.175, 83.975, 83.975, 84.10833333333333, 84.10833333333333, 84.48333333333333, 84.48333333333333, 84.45833333333333, 84.45833333333333, 84.35, 84.35, 84.13333333333334, 84.13333333333334, 84.575, 84.575, 84.175, 84.175, 84.275, 84.275, 84.59166666666667, 84.59166666666667, 83.76666666666667, 83.76666666666667, 83.45, 83.45, 83.85, 83.85, 84.275, 84.275, 84.05, 84.05, 84.63333333333334, 84.63333333333334, 84.75833333333334, 84.75833333333334, 84.78333333333333, 84.78333333333333, 85.21666666666667, 85.21666666666667, 85.28333333333333, 85.28333333333333, 85.43333333333334, 85.43333333333334, 85.30833333333334, 85.30833333333334, 85.16666666666667, 85.16666666666667, 84.65, 84.65, 84.525, 84.525, 84.08333333333333, 84.08333333333333, 84.08333333333333, 84.08333333333333, 83.65833333333333, 83.65833333333333, 84.15, 84.15, 84.325, 84.325, 84.53333333333333, 84.53333333333333, 84.66666666666667, 84.66666666666667, 84.95833333333333, 84.95833333333333, 85.23333333333333, 85.23333333333333, 84.825, 84.825, 84.925, 84.925, 85.41666666666667, 85.41666666666667, 85.75, 85.75, 85.73333333333333, 85.73333333333333, 85.5, 85.5, 85.59166666666667, 85.59166666666667, 85.65, 85.65, 85.66666666666667, 85.66666666666667, 85.25833333333334, 85.25833333333334, 85.23333333333333, 85.23333333333333, 85.23333333333333, 85.23333333333333, 85.15833333333333, 85.15833333333333, 86.0, 86.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842 
)
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.198, Test loss: 0.361, Test accuracy: 86.38
Average accuracy final 10 rounds: 86.1525 

1433.0313503742218
[1.4755096435546875, 2.951019287109375, 4.200707912445068, 5.450396537780762, 6.744216680526733, 8.038036823272705, 9.331805944442749, 10.625575065612793, 11.92225193977356, 13.218928813934326, 14.512876033782959, 15.806823253631592, 17.10746669769287, 18.40811014175415, 19.714025259017944, 21.01994037628174, 22.314350843429565, 23.608761310577393, 24.903976440429688, 26.199191570281982, 27.50011134147644, 28.8010311126709, 30.0981228351593, 31.395214557647705, 32.69799613952637, 34.00077772140503, 35.29912352561951, 36.597469329833984, 37.89577007293701, 39.19407081604004, 40.49856185913086, 41.80305290222168, 43.09563088417053, 44.388208866119385, 45.68792152404785, 46.98763418197632, 48.28886914253235, 49.59010410308838, 50.88963556289673, 52.18916702270508, 53.48998308181763, 54.790799140930176, 56.0921847820282, 57.39357042312622, 58.69026708602905, 59.986963748931885, 61.28575897216797, 62.58455419540405, 63.82748985290527, 65.0704255104065, 66.2511990070343, 67.43197250366211, 68.61703729629517, 69.80210208892822, 70.99278163909912, 72.18346118927002, 73.38140296936035, 74.57934474945068, 75.76774072647095, 76.95613670349121, 78.14191269874573, 79.32768869400024, 80.51622915267944, 81.70476961135864, 82.88314986228943, 84.06153011322021, 85.23700380325317, 86.41247749328613, 87.61003470420837, 88.80759191513062, 89.99589467048645, 91.18419742584229, 92.46706628799438, 93.74993515014648, 94.96737790107727, 96.18482065200806, 97.39849877357483, 98.6121768951416, 99.83559036254883, 101.05900382995605, 102.27837562561035, 103.49774742126465, 104.72874426841736, 105.95974111557007, 107.17912697792053, 108.398512840271, 109.60721826553345, 110.8159236907959, 112.03023767471313, 113.24455165863037, 114.46323466300964, 115.68191766738892, 116.89377641677856, 118.10563516616821, 119.32572770118713, 120.54582023620605, 121.77186393737793, 122.9979076385498, 124.213210105896, 125.42851257324219, 126.6313750743866, 127.834237575531, 129.02779936790466, 130.22136116027832, 131.42115235328674, 132.62094354629517, 133.8170313835144, 135.01311922073364, 136.21355414390564, 137.41398906707764, 138.60934925079346, 139.80470943450928, 141.00792503356934, 142.2111406326294, 143.4118595123291, 144.6125783920288, 145.81774520874023, 147.02291202545166, 148.22012424468994, 149.41733646392822, 150.58669257164001, 151.7560486793518, 152.94318962097168, 154.13033056259155, 155.32486844062805, 156.51940631866455, 157.697979927063, 158.87655353546143, 160.06118202209473, 161.24581050872803, 162.43342447280884, 163.62103843688965, 164.81826949119568, 166.0155005455017, 167.2058253288269, 168.3961501121521, 169.59420132637024, 170.79225254058838, 171.99920415878296, 173.20615577697754, 174.40605759620667, 175.6059594154358, 176.80620765686035, 178.0064558982849, 179.20330786705017, 180.40015983581543, 181.6003715991974, 182.80058336257935, 183.99808382987976, 185.19558429718018, 186.38034296035767, 187.56510162353516, 188.7550904750824, 189.94507932662964, 191.14783930778503, 192.35059928894043, 193.57190775871277, 194.7932162284851, 196.00668811798096, 197.2201600074768, 198.4513177871704, 199.682475566864, 200.90106463432312, 202.11965370178223, 203.34878826141357, 204.57792282104492, 205.81984901428223, 207.06177520751953, 208.2855474948883, 209.50931978225708, 210.72883415222168, 211.94834852218628, 213.19816064834595, 214.44797277450562, 215.6746950149536, 216.9014172554016, 218.10995721817017, 219.31849718093872, 220.52472448349, 221.73095178604126, 222.94525742530823, 224.1595630645752, 225.564546585083, 226.96953010559082, 228.2545042037964, 229.53947830200195, 230.92589592933655, 232.31231355667114, 233.6695272922516, 235.02674102783203, 236.42631483078003, 237.82588863372803, 239.21650218963623, 240.60711574554443, 241.96674704551697, 243.3263783454895, 244.71929502487183, 246.11221170425415, 247.50866603851318, 248.90512037277222, 250.9609739780426, 253.016827583313]
[23.433333333333334, 23.433333333333334, 32.1, 32.1, 47.075, 47.075, 47.15, 47.15, 57.93333333333333, 57.93333333333333, 61.833333333333336, 61.833333333333336, 63.625, 63.625, 67.68333333333334, 67.68333333333334, 69.54166666666667, 69.54166666666667, 68.15, 68.15, 68.28333333333333, 68.28333333333333, 69.56666666666666, 69.56666666666666, 74.99166666666666, 74.99166666666666, 76.41666666666667, 76.41666666666667, 77.175, 77.175, 77.36666666666666, 77.36666666666666, 76.725, 76.725, 77.56666666666666, 77.56666666666666, 77.09166666666667, 77.09166666666667, 78.28333333333333, 78.28333333333333, 78.19166666666666, 78.19166666666666, 78.29166666666667, 78.29166666666667, 79.225, 79.225, 78.8, 78.8, 79.73333333333333, 79.73333333333333, 80.225, 80.225, 79.99166666666666, 79.99166666666666, 80.45833333333333, 80.45833333333333, 79.81666666666666, 79.81666666666666, 81.175, 81.175, 81.2, 81.2, 81.225, 81.225, 81.73333333333333, 81.73333333333333, 81.425, 81.425, 81.325, 81.325, 81.66666666666667, 81.66666666666667, 82.10833333333333, 82.10833333333333, 82.06666666666666, 82.06666666666666, 82.75, 82.75, 82.725, 82.725, 82.95, 82.95, 83.14166666666667, 83.14166666666667, 82.66666666666667, 82.66666666666667, 83.49166666666666, 83.49166666666666, 83.58333333333333, 83.58333333333333, 82.88333333333334, 82.88333333333334, 83.70833333333333, 83.70833333333333, 83.91666666666667, 83.91666666666667, 84.125, 84.125, 83.525, 83.525, 84.34166666666667, 84.34166666666667, 84.425, 84.425, 84.275, 84.275, 84.45, 84.45, 84.41666666666667, 84.41666666666667, 84.26666666666667, 84.26666666666667, 84.39166666666667, 84.39166666666667, 84.74166666666666, 84.74166666666666, 84.38333333333334, 84.38333333333334, 84.45, 84.45, 84.49166666666666, 84.49166666666666, 84.2, 84.2, 84.96666666666667, 84.96666666666667, 85.14166666666667, 85.14166666666667, 84.675, 84.675, 84.84166666666667, 84.84166666666667, 84.94166666666666, 84.94166666666666, 84.81666666666666, 84.81666666666666, 85.0, 85.0, 84.975, 84.975, 84.99166666666666, 84.99166666666666, 85.075, 85.075, 85.49166666666666, 85.49166666666666, 85.51666666666667, 85.51666666666667, 85.69166666666666, 85.69166666666666, 85.7, 85.7, 85.325, 85.325, 85.40833333333333, 85.40833333333333, 85.45833333333333, 85.45833333333333, 85.63333333333334, 85.63333333333334, 86.04166666666667, 86.04166666666667, 85.9, 85.9, 85.86666666666666, 85.86666666666666, 85.78333333333333, 85.78333333333333, 85.8, 85.8, 85.14166666666667, 85.14166666666667, 85.8, 85.8, 86.175, 86.175, 85.81666666666666, 85.81666666666666, 85.98333333333333, 85.98333333333333, 86.15833333333333, 86.15833333333333, 86.03333333333333, 86.03333333333333, 86.225, 86.225, 86.00833333333334, 86.00833333333334, 86.4, 86.4, 86.25833333333334, 86.25833333333334, 86.125, 86.125, 85.95833333333333, 85.95833333333333, 86.18333333333334, 86.18333333333334, 86.175, 86.175, 86.375, 86.375]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedper  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedper , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedper
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842 
)
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.134, Test loss: 0.403, Test accuracy: 86.56
Average accuracy final 10 rounds: 86.09083333333334 

1516.2543060779572
[1.7956461906433105, 3.591292381286621, 5.089701175689697, 6.588109970092773, 7.85438084602356, 9.120651721954346, 10.408975839614868, 11.69729995727539, 12.981102705001831, 14.264905452728271, 15.554450035095215, 16.843994617462158, 18.130687475204468, 19.417380332946777, 20.70384931564331, 21.990318298339844, 23.279972791671753, 24.569627285003662, 25.854844570159912, 27.140061855316162, 28.425593614578247, 29.711125373840332, 30.986578702926636, 32.26203203201294, 33.531495332717896, 34.80095863342285, 36.07835292816162, 37.35574722290039, 38.631632566452026, 39.90751791000366, 41.16582703590393, 42.4241361618042, 43.68896555900574, 44.953794956207275, 46.23128533363342, 47.50877571105957, 48.7774338722229, 50.04609203338623, 51.31737756729126, 52.58866310119629, 53.841341733932495, 55.0940203666687, 56.35911560058594, 57.624210834503174, 58.897464990615845, 60.170719146728516, 61.4506402015686, 62.73056125640869, 64.00493359565735, 65.279305934906, 66.55811810493469, 67.83693027496338, 69.12797236442566, 70.41901445388794, 71.78127861022949, 73.14354276657104, 74.44832968711853, 75.75311660766602, 77.00709700584412, 78.26107740402222, 79.52731394767761, 80.79355049133301, 82.04506993293762, 83.29658937454224, 84.55178737640381, 85.80698537826538, 87.23744225502014, 88.6678991317749, 90.14072871208191, 91.61355829238892, 93.05008220672607, 94.48660612106323, 95.95469307899475, 97.42278003692627, 98.87942337989807, 100.33606672286987, 101.82012557983398, 103.3041844367981, 104.76520013809204, 106.22621583938599, 107.70606637001038, 109.18591690063477, 110.66948652267456, 112.15305614471436, 113.63764929771423, 115.12224245071411, 116.62148094177246, 118.12071943283081, 119.60390281677246, 121.08708620071411, 122.55634379386902, 124.02560138702393, 125.3330614566803, 126.64052152633667, 127.94018530845642, 129.23984909057617, 130.52927088737488, 131.81869268417358, 133.1198136806488, 134.42093467712402, 135.8597092628479, 137.29848384857178, 138.73770213127136, 140.17692041397095, 141.61989545822144, 143.06287050247192, 144.51976084709167, 145.97665119171143, 147.46188855171204, 148.94712591171265, 150.44058275222778, 151.93403959274292, 153.39830422401428, 154.86256885528564, 156.31949615478516, 157.77642345428467, 159.23646759986877, 160.69651174545288, 162.14958810806274, 163.6026644706726, 165.05786848068237, 166.51307249069214, 167.9812662601471, 169.44946002960205, 170.9161353111267, 172.38281059265137, 173.85022854804993, 175.3176465034485, 176.77318835258484, 178.2287302017212, 179.6328477859497, 181.03696537017822, 182.41485285758972, 183.79274034500122, 185.17067337036133, 186.54860639572144, 187.93468356132507, 189.3207607269287, 190.77244639396667, 192.22413206100464, 193.6750476360321, 195.12596321105957, 196.58963799476624, 198.0533127784729, 199.51473760604858, 200.97616243362427, 202.430104970932, 203.88404750823975, 205.3448531627655, 206.80565881729126, 208.2714512348175, 209.73724365234375, 211.19639801979065, 212.65555238723755, 214.15092086791992, 215.6462893486023, 217.15879559516907, 218.67130184173584, 220.2025294303894, 221.73375701904297, 223.1816110610962, 224.6294651031494, 226.0863926410675, 227.5433201789856, 229.00704789161682, 230.47077560424805, 231.93016862869263, 233.3895616531372, 234.84454154968262, 236.29952144622803, 237.75826025009155, 239.21699905395508, 240.67382645606995, 242.13065385818481, 243.58878803253174, 245.04692220687866, 246.48352551460266, 247.92012882232666, 249.19037675857544, 250.46062469482422, 251.73296332359314, 253.00530195236206, 254.28241991996765, 255.55953788757324, 256.81009316444397, 258.0606484413147, 259.31260228157043, 260.5645561218262, 261.8153796195984, 263.0662031173706, 264.3133924007416, 265.56058168411255, 266.81202387809753, 268.0634660720825, 269.32081389427185, 270.5781617164612, 271.8379604816437, 273.0977592468262, 274.3610579967499, 275.6243567466736, 277.61983013153076, 279.61530351638794]
[26.4, 26.4, 35.90833333333333, 35.90833333333333, 43.858333333333334, 43.858333333333334, 59.40833333333333, 59.40833333333333, 60.55833333333333, 60.55833333333333, 60.825, 60.825, 67.25, 67.25, 71.8, 71.8, 72.29166666666667, 72.29166666666667, 72.23333333333333, 72.23333333333333, 73.625, 73.625, 74.49166666666666, 74.49166666666666, 75.53333333333333, 75.53333333333333, 73.8, 73.8, 76.09166666666667, 76.09166666666667, 76.98333333333333, 76.98333333333333, 78.775, 78.775, 79.35, 79.35, 79.11666666666666, 79.11666666666666, 78.75833333333334, 78.75833333333334, 78.86666666666666, 78.86666666666666, 80.29166666666667, 80.29166666666667, 81.24166666666666, 81.24166666666666, 81.01666666666667, 81.01666666666667, 81.91666666666667, 81.91666666666667, 81.80833333333334, 81.80833333333334, 81.60833333333333, 81.60833333333333, 82.03333333333333, 82.03333333333333, 81.80833333333334, 81.80833333333334, 83.04166666666667, 83.04166666666667, 82.45833333333333, 82.45833333333333, 82.9, 82.9, 83.325, 83.325, 83.48333333333333, 83.48333333333333, 83.84166666666667, 83.84166666666667, 83.88333333333334, 83.88333333333334, 84.05, 84.05, 84.05, 84.05, 84.29166666666667, 84.29166666666667, 84.4, 84.4, 84.14166666666667, 84.14166666666667, 84.80833333333334, 84.80833333333334, 84.10833333333333, 84.10833333333333, 85.1, 85.1, 84.4, 84.4, 84.525, 84.525, 84.99166666666666, 84.99166666666666, 84.725, 84.725, 85.1, 85.1, 85.1, 85.1, 85.18333333333334, 85.18333333333334, 85.2, 85.2, 85.25, 85.25, 85.09166666666667, 85.09166666666667, 85.20833333333333, 85.20833333333333, 85.725, 85.725, 85.68333333333334, 85.68333333333334, 85.45833333333333, 85.45833333333333, 85.6, 85.6, 85.23333333333333, 85.23333333333333, 85.65833333333333, 85.65833333333333, 85.5, 85.5, 85.70833333333333, 85.70833333333333, 85.58333333333333, 85.58333333333333, 86.00833333333334, 86.00833333333334, 85.60833333333333, 85.60833333333333, 86.03333333333333, 86.03333333333333, 85.59166666666667, 85.59166666666667, 85.89166666666667, 85.89166666666667, 85.48333333333333, 85.48333333333333, 85.60833333333333, 85.60833333333333, 85.71666666666667, 85.71666666666667, 85.63333333333334, 85.63333333333334, 85.825, 85.825, 85.75833333333334, 85.75833333333334, 85.825, 85.825, 85.325, 85.325, 85.68333333333334, 85.68333333333334, 85.2, 85.2, 85.93333333333334, 85.93333333333334, 85.525, 85.525, 85.39166666666667, 85.39166666666667, 85.94166666666666, 85.94166666666666, 86.03333333333333, 86.03333333333333, 86.08333333333333, 86.08333333333333, 86.09166666666667, 86.09166666666667, 85.85, 85.85, 86.28333333333333, 86.28333333333333, 85.95, 85.95, 86.38333333333334, 86.38333333333334, 86.00833333333334, 86.00833333333334, 86.275, 86.275, 86.11666666666666, 86.11666666666666, 86.0, 86.0, 86.25, 86.25, 86.04166666666667, 86.04166666666667, 85.85, 85.85, 86.01666666666667, 86.01666666666667, 86.26666666666667, 86.26666666666667, 86.08333333333333, 86.08333333333333, 86.55833333333334, 86.55833333333334]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  lg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: lg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
lg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 8394 (global); Percentage 2.73 (8394/307842 
)
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.039, Test loss: 1.024, Test accuracy: 81.47
Average accuracy final 10 rounds: 81.13250000000001 

1604.8656768798828
[1.7969813346862793, 3.5939626693725586, 5.120118856430054, 6.646275043487549, 8.172393083572388, 9.698511123657227, 11.210453033447266, 12.722394943237305, 14.224781274795532, 15.72716760635376, 17.240439414978027, 18.753711223602295, 20.257832765579224, 21.761954307556152, 23.269670009613037, 24.777385711669922, 26.29940915107727, 27.82143259048462, 29.345702171325684, 30.869971752166748, 32.38777804374695, 33.90558433532715, 35.415860176086426, 36.9261360168457, 38.4373300075531, 39.9485239982605, 41.46706676483154, 42.98560953140259, 44.509315490722656, 46.033021450042725, 47.54535961151123, 49.057697772979736, 50.57048320770264, 52.08326864242554, 53.60569643974304, 55.12812423706055, 56.65041399002075, 58.17270374298096, 59.69227623939514, 61.211848735809326, 62.733927965164185, 64.25600719451904, 65.78424572944641, 67.31248426437378, 68.83303594589233, 70.35358762741089, 71.87055492401123, 73.38752222061157, 74.90781211853027, 76.42810201644897, 77.95488905906677, 79.48167610168457, 81.00399851799011, 82.52632093429565, 84.04654693603516, 85.56677293777466, 87.10035634040833, 88.63393974304199, 90.14591217041016, 91.65788459777832, 93.17038154602051, 94.6828784942627, 96.20209097862244, 97.72130346298218, 99.22564578056335, 100.72998809814453, 102.23423600196838, 103.73848390579224, 105.24636721611023, 106.75425052642822, 108.26986122131348, 109.78547191619873, 111.29747676849365, 112.80948162078857, 114.31955933570862, 115.82963705062866, 117.35249471664429, 118.87535238265991, 120.39486455917358, 121.91437673568726, 123.43125176429749, 124.94812679290771, 126.45550394058228, 127.96288108825684, 129.4738006591797, 130.98472023010254, 132.48633432388306, 133.98794841766357, 135.48137617111206, 136.97480392456055, 138.48857831954956, 140.00235271453857, 141.51864790916443, 143.03494310379028, 144.54151272773743, 146.04808235168457, 147.56853246688843, 149.08898258209229, 150.53289914131165, 151.976815700531, 153.42506980895996, 154.87332391738892, 156.3196985721588, 157.7660732269287, 159.22006559371948, 160.67405796051025, 162.12424278259277, 163.5744276046753, 165.0307137966156, 166.4869999885559, 167.9910478591919, 169.49509572982788, 170.95792031288147, 172.42074489593506, 173.9204969406128, 175.42024898529053, 176.92569088935852, 178.4311327934265, 179.94108390808105, 181.4510350227356, 182.95999693870544, 184.4689588546753, 185.9261772632599, 187.38339567184448, 188.85245513916016, 190.32151460647583, 191.7738425731659, 193.22617053985596, 194.7330219745636, 196.23987340927124, 197.76336860656738, 199.28686380386353, 200.80635261535645, 202.32584142684937, 203.8550832271576, 205.38432502746582, 206.91830825805664, 208.45229148864746, 209.96017169952393, 211.4680519104004, 212.98570704460144, 214.5033621788025, 216.01825881004333, 217.53315544128418, 218.99563360214233, 220.4581117630005, 221.96869039535522, 223.47926902770996, 224.9897656440735, 226.500262260437, 228.02217149734497, 229.54408073425293, 231.07269096374512, 232.6013011932373, 234.1197485923767, 235.6381959915161, 237.14821028709412, 238.65822458267212, 240.16645765304565, 241.6746907234192, 243.17918848991394, 244.6836862564087, 246.21524477005005, 247.7468032836914, 249.32965278625488, 250.91250228881836, 252.42833638191223, 253.9441704750061, 255.4669051170349, 256.9896397590637, 258.5038146972656, 260.01798963546753, 261.52624320983887, 263.0344967842102, 264.5427963733673, 266.0510959625244, 267.55970525741577, 269.06831455230713, 270.5859205722809, 272.10352659225464, 273.7028341293335, 275.30214166641235, 276.8217487335205, 278.34135580062866, 279.8177013397217, 281.2940468788147, 282.7761125564575, 284.25817823410034, 285.7363336086273, 287.2144889831543, 288.70549416542053, 290.19649934768677, 291.6814422607422, 293.1663851737976, 294.6586880683899, 296.1509909629822, 297.6381936073303, 299.12539625167847, 300.60366678237915, 302.08193731307983, 304.4156129360199, 306.74928855895996]
[28.908333333333335, 28.908333333333335, 43.71666666666667, 43.71666666666667, 49.916666666666664, 49.916666666666664, 56.625, 56.625, 61.175, 61.175, 63.25, 63.25, 66.60833333333333, 66.60833333333333, 68.40833333333333, 68.40833333333333, 72.725, 72.725, 72.85833333333333, 72.85833333333333, 73.14166666666667, 73.14166666666667, 74.0, 74.0, 73.775, 73.775, 73.19166666666666, 73.19166666666666, 73.23333333333333, 73.23333333333333, 73.675, 73.675, 74.05, 74.05, 75.04166666666667, 75.04166666666667, 76.03333333333333, 76.03333333333333, 76.43333333333334, 76.43333333333334, 76.325, 76.325, 76.525, 76.525, 77.25833333333334, 77.25833333333334, 77.35833333333333, 77.35833333333333, 77.29166666666667, 77.29166666666667, 77.36666666666666, 77.36666666666666, 77.48333333333333, 77.48333333333333, 78.43333333333334, 78.43333333333334, 78.53333333333333, 78.53333333333333, 78.65833333333333, 78.65833333333333, 78.54166666666667, 78.54166666666667, 78.60833333333333, 78.60833333333333, 78.59166666666667, 78.59166666666667, 79.3, 79.3, 79.06666666666666, 79.06666666666666, 78.725, 78.725, 79.05, 79.05, 78.89166666666667, 78.89166666666667, 79.05, 79.05, 79.31666666666666, 79.31666666666666, 79.06666666666666, 79.06666666666666, 78.94166666666666, 78.94166666666666, 79.075, 79.075, 79.75833333333334, 79.75833333333334, 79.4, 79.4, 79.18333333333334, 79.18333333333334, 79.25, 79.25, 79.125, 79.125, 79.23333333333333, 79.23333333333333, 79.46666666666667, 79.46666666666667, 79.50833333333334, 79.50833333333334, 79.3, 79.3, 79.45, 79.45, 79.25, 79.25, 79.625, 79.625, 79.81666666666666, 79.81666666666666, 79.65, 79.65, 79.85, 79.85, 80.53333333333333, 80.53333333333333, 80.15, 80.15, 80.49166666666666, 80.49166666666666, 80.725, 80.725, 80.18333333333334, 80.18333333333334, 80.66666666666667, 80.66666666666667, 80.65, 80.65, 80.9, 80.9, 80.925, 80.925, 80.73333333333333, 80.73333333333333, 80.125, 80.125, 80.31666666666666, 80.31666666666666, 80.38333333333334, 80.38333333333334, 80.48333333333333, 80.48333333333333, 80.35, 80.35, 80.79166666666667, 80.79166666666667, 80.83333333333333, 80.83333333333333, 81.13333333333334, 81.13333333333334, 81.03333333333333, 81.03333333333333, 81.10833333333333, 81.10833333333333, 80.83333333333333, 80.83333333333333, 80.85833333333333, 80.85833333333333, 80.41666666666667, 80.41666666666667, 80.50833333333334, 80.50833333333334, 80.46666666666667, 80.46666666666667, 80.91666666666667, 80.91666666666667, 80.675, 80.675, 81.24166666666666, 81.24166666666666, 81.76666666666667, 81.76666666666667, 81.41666666666667, 81.41666666666667, 81.35, 81.35, 81.575, 81.575, 81.70833333333333, 81.70833333333333, 81.525, 81.525, 81.525, 81.525, 81.34166666666667, 81.34166666666667, 81.06666666666666, 81.06666666666666, 81.14166666666667, 81.14166666666667, 80.975, 80.975, 80.70833333333333, 80.70833333333333, 80.71666666666667, 80.71666666666667, 80.61666666666666, 80.61666666666666, 81.475, 81.475]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_apfl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
Final Round, Train loss: 0.123, Test loss: 1.661, Test accuracy: 45.12
Average accuracy final 10 rounds: 44.653749999999995
6737.586879968643
[]
[33.475, 33.585, 32.9175, 31.1975, 30.67, 32.07, 30.58, 28.7975, 28.71, 27.765, 28.635, 28.915, 29.115, 29.2775, 29.94, 29.8325, 30.1225, 30.78, 30.955, 32.1525, 32.61, 33.8625, 33.91, 34.0225, 34.0275, 35.0025, 34.7975, 35.685, 37.2425, 36.3, 37.3325, 36.835, 36.965, 37.485, 37.825, 38.5825, 37.9925, 38.04, 38.9375, 39.1775, 39.9475, 40.555, 40.6825, 40.825, 41.0175, 40.475, 40.6125, 40.6875, 41.365, 41.285, 41.9975, 41.37, 40.8925, 41.4475, 42.295, 42.02, 43.2, 42.1325, 42.99, 42.1325, 42.835, 43.375, 43.4975, 42.82, 43.83, 43.24, 44.0125, 44.2025, 43.2975, 43.94, 44.075, 43.7975, 43.9175, 43.6575, 44.36, 43.805, 43.4575, 43.955, 44.1525, 44.465, 43.825, 44.495, 44.8175, 44.29, 44.23, 44.6075, 44.42, 44.82, 44.255, 44.1975, 43.5875, 44.64, 44.5125, 44.2575, 45.055, 44.43, 45.3825, 44.9625, 45.175, 44.535, 45.115]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Fed_scaffold %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Final Round, Train loss: 0.507, Test loss: 0.495, Test accuracy: 80.39
Average accuracy final 10 rounds: 80.67277777777777
Average global accuracy final 10 rounds: 80.67277777777777
2470.4859805107117
[]
[29.783333333333335, 40.35, 50.37222222222222, 51.227777777777774, 59.455555555555556, 59.71666666666667, 66.93888888888888, 67.17222222222222, 67.82222222222222, 67.22777777777777, 68.50555555555556, 71.02777777777777, 70.17222222222222, 72.0, 72.44444444444444, 73.97222222222223, 74.06666666666666, 74.46666666666667, 74.25555555555556, 75.12222222222222, 75.11111111111111, 75.35555555555555, 76.34444444444445, 76.68888888888888, 77.12777777777778, 76.78333333333333, 76.36666666666666, 75.96666666666667, 76.97222222222223, 77.01666666666667, 77.77222222222223, 77.87777777777778, 77.39444444444445, 77.8, 77.55555555555556, 78.14444444444445, 78.17777777777778, 77.80555555555556, 78.2611111111111, 78.41666666666667, 78.58333333333333, 78.52222222222223, 78.9, 78.31111111111112, 78.54444444444445, 78.56666666666666, 78.37777777777778, 79.40555555555555, 79.31666666666666, 79.22222222222223, 78.79444444444445, 78.91666666666667, 78.57222222222222, 79.07777777777778, 78.56666666666666, 78.94444444444444, 78.63888888888889, 78.64444444444445, 78.74444444444444, 78.55555555555556, 79.16666666666667, 78.70555555555555, 79.27777777777777, 79.03888888888889, 79.08333333333333, 79.33333333333333, 79.64444444444445, 79.71666666666667, 79.7611111111111, 79.59444444444445, 79.53888888888889, 79.61111111111111, 79.7388888888889, 79.92222222222222, 79.52222222222223, 79.45, 79.67222222222222, 79.86111111111111, 79.69444444444444, 79.88333333333334, 80.11111111111111, 81.15, 81.1, 80.75, 80.97777777777777, 80.75, 80.59444444444445, 80.51666666666667, 80.48333333333333, 80.34444444444445, 80.10555555555555, 80.33333333333333, 80.79444444444445, 80.84444444444445, 80.82222222222222, 80.63333333333334, 80.58333333333333, 80.63888888888889, 81.15555555555555, 80.81666666666666, 80.38888888888889]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_ditto%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
Final Round, Train loss: 0.136, Test loss: 0.996, Test accuracy: 69.29
Average accuracy final 10 rounds: 63.56166666666667
4318.522317647934
[6.889089345932007, 13.379938125610352, 19.871089935302734, 26.291999101638794, 32.7468945980072, 39.08646273612976, 45.45636463165283, 51.832624197006226, 57.79362392425537, 63.6944363117218, 69.61005139350891, 75.51584267616272, 81.54111886024475, 87.81118893623352, 94.10471057891846, 100.40024328231812, 106.59066343307495, 112.45386481285095, 118.36789727210999, 124.20775365829468, 130.05597376823425, 136.0465109348297, 141.9956169128418, 147.8767364025116, 153.8174431324005, 159.69649410247803, 165.6033639907837, 171.60775351524353, 177.82947635650635, 184.1214063167572, 190.5224530696869, 196.82574152946472, 203.037442445755, 209.33034992218018, 215.6127827167511, 222.0885512828827, 228.42728519439697, 234.73612880706787, 241.5247461795807, 247.7915849685669, 253.67447090148926, 259.9855263233185, 265.89516949653625, 271.82261538505554, 277.7512798309326, 283.74527406692505, 289.67381262779236, 295.61896300315857, 301.5474660396576, 307.5898985862732, 313.7143437862396, 319.6212785243988, 325.79940390586853, 332.28428387641907, 338.83065128326416, 344.81204080581665, 350.66956305503845, 356.57138562202454, 362.5058150291443, 368.5477213859558, 374.655136346817, 380.66278553009033, 386.6537821292877, 392.6176154613495, 398.68842697143555, 404.74337244033813, 411.10759687423706, 417.58724880218506, 423.8863413333893, 430.24070835113525, 436.33792185783386, 442.5197448730469, 448.65787625312805, 454.7097351551056, 460.89683651924133, 467.38024950027466, 473.84700107574463, 480.20548939704895, 486.2364785671234, 492.2860474586487, 498.2568094730377, 504.22540855407715, 510.4714992046356, 516.459629535675, 522.5456929206848, 528.5228555202484, 534.6221752166748, 540.60724568367, 546.5691208839417, 552.5870201587677, 558.653520822525, 564.6638054847717, 570.6421239376068, 576.6745908260345, 582.6424517631531, 588.6880135536194, 595.2505388259888, 601.66251039505, 607.996682882309, 614.295129776001, 617.9010043144226]
[21.988888888888887, 23.005555555555556, 33.31111111111111, 36.98888888888889, 37.077777777777776, 31.122222222222224, 44.794444444444444, 37.18888888888889, 48.85, 45.73888888888889, 50.138888888888886, 45.46111111111111, 48.85, 49.083333333333336, 50.51111111111111, 47.083333333333336, 49.11666666666667, 53.111111111111114, 52.62222222222222, 49.705555555555556, 58.21666666666667, 59.09444444444444, 54.22222222222222, 57.85, 57.15555555555556, 62.36666666666667, 51.111111111111114, 51.21666666666667, 62.544444444444444, 63.044444444444444, 61.71111111111111, 56.27777777777778, 54.81111111111111, 54.80555555555556, 57.59444444444444, 58.65, 50.13333333333333, 49.78888888888889, 61.96666666666667, 62.15, 62.62777777777778, 56.8, 60.388888888888886, 62.05, 56.81111111111111, 54.98888888888889, 62.727777777777774, 54.15, 57.611111111111114, 56.666666666666664, 60.94444444444444, 63.75, 57.516666666666666, 61.88333333333333, 62.47222222222222, 54.227777777777774, 62.266666666666666, 66.04444444444445, 58.23888888888889, 61.66111111111111, 59.65555555555556, 62.13333333333333, 62.96666666666667, 58.86666666666667, 67.55555555555556, 61.69444444444444, 54.88333333333333, 59.27777777777778, 61.016666666666666, 61.44444444444444, 62.33888888888889, 62.8, 63.25555555555555, 61.05, 61.68888888888889, 63.97222222222222, 58.02777777777778, 59.83888888888889, 67.21111111111111, 63.28888888888889, 59.17777777777778, 59.30555555555556, 65.70555555555555, 58.48888888888889, 66.52777777777777, 66.81111111111112, 64.34444444444445, 66.81666666666666, 64.89444444444445, 54.56111111111111, 65.85555555555555, 64.61111111111111, 62.977777777777774, 66.35555555555555, 64.86111111111111, 58.84444444444444, 57.85, 65.29444444444445, 64.5111111111111, 64.45555555555555, 69.29444444444445]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Traceback (most recent call last):
  File "main_fedpac.py", line 232, in <module>
    w_local, loss, indd, class_center_local, class_num = local.train(net=net_local.to(args.device), class_center_glob=class_center_glob, idx=idx, w_glob_keys=w_glob_keys, lr=args.lr, last=last, concept_matrix_local=concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1272, in train
    for batch_idx, (images, labels) in enumerate(self.ldr_train):
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 675, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 35, in __getitem__
    image, label = self.dataset[self.idxs[item]]
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torchvision/datasets/cifar.py", line 111, in __getitem__
    img, target = self.data[index], self.targets[index]
IndexError: index 51070 is out of bounds for axis 0 with size 50000
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC-K-Means%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
4800
4864
107264
107328
299328
299448
307128
307192
307832
307842
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Traceback (most recent call last):
  File "main_fedpac_k_means.py", line 293, in <module>
    w_local, loss, indd, class_center_local, class_num = local.train(net=net_local.to(args.device), class_center_glob=class_center_grob_local, idx=idx, w_glob_keys=w_glob_keys, lr=args.lr, last=last, concept_matrix_local=concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 2181, in train
    for batch_idx, (images, labels) in enumerate(self.ldr_train):
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 675, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 35, in __getitem__
    image, label = self.dataset[self.idxs[item]]
  File "/home/ChenSM/anaconda3/envs/python38/lib/python3.8/site-packages/torchvision/datasets/cifar.py", line 111, in __getitem__
    img, target = self.data[index], self.targets[index]
IndexError: index 56394 is out of bounds for axis 0 with size 50000
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.048, Test loss: 0.898, Test accuracy: 82.44
Final Round, Global train loss: 0.048, Global test loss: 2.497, Global test accuracy: 15.87
Average accuracy final 10 rounds: 81.95083333333332 

Average global accuracy final 10 rounds: 13.294166666666664 

2237.1260335445404
[1.9257347583770752, 3.8514695167541504, 5.399789571762085, 6.9481096267700195, 8.596626281738281, 10.245142936706543, 11.870348453521729, 13.495553970336914, 15.154125690460205, 16.812697410583496, 18.50194811820984, 20.19119882583618, 21.833808660507202, 23.476418495178223, 25.137561321258545, 26.798704147338867, 28.4065945148468, 30.014484882354736, 31.628566026687622, 33.24264717102051, 34.82912731170654, 36.41560745239258, 38.05254316329956, 39.68947887420654, 41.282389879226685, 42.875300884246826, 44.469475746154785, 46.063650608062744, 47.692304611206055, 49.320958614349365, 50.93431901931763, 52.54767942428589, 54.18925905227661, 55.830838680267334, 57.41578698158264, 59.00073528289795, 60.56119465827942, 62.12165403366089, 63.71519374847412, 65.30873346328735, 66.92211866378784, 68.53550386428833, 70.10703015327454, 71.67855644226074, 73.24349689483643, 74.80843734741211, 76.26027297973633, 77.71210861206055, 79.16790509223938, 80.62370157241821, 82.09410619735718, 83.56451082229614, 85.0282084941864, 86.49190616607666, 87.9832706451416, 89.47463512420654, 90.9139986038208, 92.35336208343506, 93.80578565597534, 95.25820922851562, 96.73054528236389, 98.20288133621216, 99.6239070892334, 101.04493284225464, 102.48804664611816, 103.93116044998169, 105.40120577812195, 106.8712511062622, 108.34481143951416, 109.81837177276611, 111.2409462928772, 112.66352081298828, 114.098797082901, 115.53407335281372, 117.01771569252014, 118.50135803222656, 119.96499133110046, 121.42862462997437, 122.8809266090393, 124.33322858810425, 125.78838658332825, 127.24354457855225, 128.70283031463623, 130.16211605072021, 131.63138961791992, 133.10066318511963, 134.5407977104187, 135.98093223571777, 137.44453024864197, 138.90812826156616, 140.50158286094666, 142.09503746032715, 143.54506850242615, 144.99509954452515, 146.46613121032715, 147.93716287612915, 149.5235676765442, 151.10997247695923, 152.6839861869812, 154.25799989700317, 155.8249912261963, 157.3919825553894, 158.9674825668335, 160.5429825782776, 162.13970375061035, 163.73642492294312, 165.3066601753235, 166.87689542770386, 172.60875129699707, 178.34060716629028, 179.7999665737152, 181.25932598114014, 182.74484872817993, 184.23037147521973, 185.66117405891418, 187.09197664260864, 188.5869722366333, 190.08196783065796, 191.56374979019165, 193.04553174972534, 194.5009582042694, 195.95638465881348, 197.3896028995514, 198.8228211402893, 200.27343320846558, 201.72404527664185, 203.19583821296692, 204.667631149292, 206.14026355743408, 207.61289596557617, 209.0271508693695, 210.44140577316284, 211.87623405456543, 213.31106233596802, 214.774311542511, 216.23756074905396, 217.719895362854, 219.20222997665405, 220.66086339950562, 222.11949682235718, 223.55100083351135, 224.98250484466553, 226.44027090072632, 227.8980369567871, 229.36554646492004, 230.83305597305298, 232.26692485809326, 233.70079374313354, 235.21958947181702, 236.7383852005005, 238.2053782939911, 239.6723713874817, 241.12073373794556, 242.56909608840942, 244.02102327346802, 245.4729504585266, 246.91773986816406, 248.3625292778015, 249.81997108459473, 251.27741289138794, 252.72008347511292, 254.1627540588379, 255.6162428855896, 257.0697317123413, 258.5297849178314, 259.98983812332153, 261.4280424118042, 262.86624670028687, 264.3212308883667, 265.77621507644653, 267.22916769981384, 268.68212032318115, 270.16068935394287, 271.6392583847046, 273.08868312835693, 274.5381078720093, 275.9757618904114, 277.4134159088135, 278.8659303188324, 280.3184447288513, 281.72966265678406, 283.1408805847168, 284.6721079349518, 286.20333528518677, 287.7275366783142, 289.25173807144165, 290.7106468677521, 292.1695556640625, 293.69757747650146, 295.22559928894043, 296.63483452796936, 298.0440697669983, 299.6558289527893, 301.2675881385803, 302.8032190799713, 304.3388500213623, 305.74564576148987, 307.15244150161743, 308.7129635810852, 310.273485660553, 312.9373400211334, 315.60119438171387]
[23.916666666666668, 23.916666666666668, 39.63333333333333, 39.63333333333333, 50.766666666666666, 50.766666666666666, 57.34166666666667, 57.34166666666667, 60.825, 60.825, 67.58333333333333, 67.58333333333333, 67.925, 67.925, 71.23333333333333, 71.23333333333333, 73.6, 73.6, 74.35833333333333, 74.35833333333333, 75.03333333333333, 75.03333333333333, 74.90833333333333, 74.90833333333333, 74.825, 74.825, 75.775, 75.775, 76.925, 76.925, 77.25, 77.25, 77.65, 77.65, 77.58333333333333, 77.58333333333333, 77.5, 77.5, 77.65, 77.65, 77.70833333333333, 77.70833333333333, 78.10833333333333, 78.10833333333333, 78.93333333333334, 78.93333333333334, 78.95833333333333, 78.95833333333333, 79.175, 79.175, 78.71666666666667, 78.71666666666667, 79.20833333333333, 79.20833333333333, 79.75, 79.75, 79.73333333333333, 79.73333333333333, 79.95, 79.95, 79.95833333333333, 79.95833333333333, 79.88333333333334, 79.88333333333334, 80.00833333333334, 80.00833333333334, 80.25833333333334, 80.25833333333334, 79.8, 79.8, 79.24166666666666, 79.24166666666666, 79.675, 79.675, 80.33333333333333, 80.33333333333333, 80.3, 80.3, 80.2, 80.2, 80.475, 80.475, 80.15, 80.15, 80.35, 80.35, 80.29166666666667, 80.29166666666667, 80.34166666666667, 80.34166666666667, 80.55833333333334, 80.55833333333334, 80.78333333333333, 80.78333333333333, 80.81666666666666, 80.81666666666666, 80.81666666666666, 80.81666666666666, 81.26666666666667, 81.26666666666667, 81.60833333333333, 81.60833333333333, 81.225, 81.225, 81.525, 81.525, 81.80833333333334, 81.80833333333334, 82.18333333333334, 82.18333333333334, 82.16666666666667, 82.16666666666667, 82.44166666666666, 82.44166666666666, 81.975, 81.975, 81.925, 81.925, 81.9, 81.9, 81.68333333333334, 81.68333333333334, 81.85, 81.85, 81.9, 81.9, 81.70833333333333, 81.70833333333333, 81.6, 81.6, 81.49166666666666, 81.49166666666666, 81.625, 81.625, 81.16666666666667, 81.16666666666667, 80.86666666666666, 80.86666666666666, 81.35, 81.35, 81.16666666666667, 81.16666666666667, 81.18333333333334, 81.18333333333334, 81.70833333333333, 81.70833333333333, 81.875, 81.875, 81.58333333333333, 81.58333333333333, 81.85, 81.85, 81.71666666666667, 81.71666666666667, 81.7, 81.7, 81.825, 81.825, 81.96666666666667, 81.96666666666667, 82.05, 82.05, 82.18333333333334, 82.18333333333334, 81.85, 81.85, 82.075, 82.075, 81.875, 81.875, 82.025, 82.025, 81.58333333333333, 81.58333333333333, 81.79166666666667, 81.79166666666667, 82.0, 82.0, 81.88333333333334, 81.88333333333334, 82.1, 82.1, 82.35833333333333, 82.35833333333333, 81.94166666666666, 81.94166666666666, 81.875, 81.875, 81.94166666666666, 81.94166666666666, 81.93333333333334, 81.93333333333334, 81.925, 81.925, 81.75, 81.75, 81.73333333333333, 81.73333333333333, 81.95, 81.95, 82.44166666666666, 82.44166666666666]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.317, Test loss: 1.191, Test accuracy: 71.97
Final Round, Global train loss: 0.317, Global test loss: 3.211, Global test accuracy: 14.22
Average accuracy final 10 rounds: 71.815 

Average global accuracy final 10 rounds: 15.577499999999999 

6652.343185901642
[5.206949472427368, 10.413898944854736, 15.399176359176636, 20.384453773498535, 25.558358907699585, 30.732264041900635, 35.741981506347656, 40.75169897079468, 45.61420035362244, 50.476701736450195, 55.3486909866333, 60.220680236816406, 65.18267607688904, 70.14467191696167, 75.07249855995178, 80.0003252029419, 84.88485598564148, 89.76938676834106, 94.5079493522644, 99.24651193618774, 104.01252675056458, 108.7785415649414, 113.77869629859924, 118.77885103225708, 123.60765719413757, 128.43646335601807, 133.2918872833252, 138.14731121063232, 142.97089672088623, 147.79448223114014, 152.56023454666138, 157.32598686218262, 162.1428792476654, 166.9597716331482, 171.86259150505066, 176.76541137695312, 181.65081024169922, 186.5362091064453, 191.42760586738586, 196.31900262832642, 201.39650535583496, 206.4740080833435, 211.48750758171082, 216.50100708007812, 221.71723747253418, 226.93346786499023, 232.04008865356445, 237.14670944213867, 242.1528754234314, 247.15904140472412, 252.14587473869324, 257.13270807266235, 262.2162537574768, 267.29979944229126, 272.3068935871124, 277.3139877319336, 282.3581783771515, 287.4023690223694, 292.05458974838257, 296.70681047439575, 301.54318714141846, 306.37956380844116, 311.47803711891174, 316.5765104293823, 321.4637339115143, 326.35095739364624, 331.10910177230835, 335.86724615097046, 340.62966561317444, 345.3920850753784, 350.16734790802, 354.9426107406616, 360.10403633117676, 365.2654619216919, 370.3884434700012, 375.51142501831055, 380.5595769882202, 385.6077289581299, 390.6027035713196, 395.5976781845093, 400.4103653430939, 405.22305250167847, 410.0272991657257, 414.83154582977295, 419.6309030056, 424.430260181427, 429.26396322250366, 434.0976662635803, 438.89133167266846, 443.6849970817566, 448.46669816970825, 453.2483992576599, 458.0424041748047, 462.83640909194946, 467.6045820713043, 472.3727550506592, 477.13354301452637, 481.89433097839355, 486.7198419570923, 491.545352935791, 496.3397674560547, 501.13418197631836, 505.9273157119751, 510.72044944763184, 515.5023968219757, 520.2843441963196, 525.0723929405212, 529.8604416847229, 534.6932964324951, 539.5261511802673, 544.3367826938629, 549.1474142074585, 553.9594223499298, 558.7714304924011, 563.5392892360687, 568.3071479797363, 573.0835537910461, 577.859959602356, 582.6853182315826, 587.5106768608093, 592.3050093650818, 597.0993418693542, 601.8904409408569, 606.6815400123596, 611.4745564460754, 616.2675728797913, 621.0552341938019, 625.8428955078125, 630.6419410705566, 635.4409866333008, 640.2486510276794, 645.0563154220581, 649.850670337677, 654.6450252532959, 659.4610025882721, 664.2769799232483, 669.091899394989, 673.9068188667297, 678.7089493274689, 683.511079788208, 688.294290304184, 693.0775008201599, 697.8669764995575, 702.6564521789551, 707.4688124656677, 712.2811727523804, 717.0843765735626, 721.8875803947449, 726.6951060295105, 731.5026316642761, 736.2509694099426, 740.9993071556091, 745.7878239154816, 750.576340675354, 755.3573040962219, 760.1382675170898, 764.9437754154205, 769.7492833137512, 774.5702655315399, 779.3912477493286, 784.1494977474213, 788.9077477455139, 793.6737501621246, 798.4397525787354, 803.213353395462, 807.9869542121887, 812.7662436962128, 817.5455331802368, 822.3316271305084, 827.11772108078, 831.8942642211914, 836.6708073616028, 841.4477517604828, 846.2246961593628, 850.9982707500458, 855.7718453407288, 860.5481142997742, 865.3243832588196, 870.087753534317, 874.8511238098145, 879.6254065036774, 884.3996891975403, 889.1655902862549, 893.9314913749695, 898.7296853065491, 903.5278792381287, 908.3284559249878, 913.1290326118469, 917.9316971302032, 922.7343616485596, 927.5432524681091, 932.3521432876587, 937.1363778114319, 941.9206123352051, 946.732218503952, 951.543824672699, 956.3102865219116, 961.0767483711243, 965.8872895240784, 970.6978306770325, 973.1100273132324, 975.5222239494324]
[17.48, 17.48, 25.455, 25.455, 28.515, 28.515, 30.835, 30.835, 36.8325, 36.8325, 39.8525, 39.8525, 44.36, 44.36, 47.215, 47.215, 50.4075, 50.4075, 51.355, 51.355, 52.6475, 52.6475, 53.175, 53.175, 53.445, 53.445, 54.2, 54.2, 57.78, 57.78, 59.165, 59.165, 59.9025, 59.9025, 60.4, 60.4, 61.07, 61.07, 62.48, 62.48, 63.495, 63.495, 64.29, 64.29, 64.36, 64.36, 65.4775, 65.4775, 65.775, 65.775, 66.1125, 66.1125, 66.355, 66.355, 66.39, 66.39, 66.5925, 66.5925, 66.735, 66.735, 67.0075, 67.0075, 67.33, 67.33, 67.375, 67.375, 67.485, 67.485, 67.7825, 67.7825, 67.955, 67.955, 68.1625, 68.1625, 68.0825, 68.0825, 68.255, 68.255, 68.5025, 68.5025, 68.4675, 68.4675, 68.4425, 68.4425, 68.7, 68.7, 68.62, 68.62, 68.65, 68.65, 68.89, 68.89, 69.0825, 69.0825, 69.4625, 69.4625, 69.33, 69.33, 69.63, 69.63, 69.6525, 69.6525, 69.8225, 69.8225, 69.9575, 69.9575, 70.0875, 70.0875, 70.0875, 70.0875, 70.07, 70.07, 69.9225, 69.9225, 70.13, 70.13, 70.2725, 70.2725, 70.3625, 70.3625, 70.48, 70.48, 70.5175, 70.5175, 70.5975, 70.5975, 70.43, 70.43, 70.3475, 70.3475, 70.625, 70.625, 70.5525, 70.5525, 70.58, 70.58, 70.7075, 70.7075, 70.6675, 70.6675, 70.7, 70.7, 70.8725, 70.8725, 70.41, 70.41, 70.4425, 70.4425, 70.57, 70.57, 70.91, 70.91, 71.2925, 71.2925, 71.265, 71.265, 71.3475, 71.3475, 71.1925, 71.1925, 71.34, 71.34, 71.2775, 71.2775, 71.2925, 71.2925, 71.52, 71.52, 71.4325, 71.4325, 71.47, 71.47, 71.47, 71.47, 71.5925, 71.5925, 71.7875, 71.7875, 71.835, 71.835, 71.565, 71.565, 71.54, 71.54, 71.94, 71.94, 71.955, 71.955, 71.805, 71.805, 71.96, 71.96, 71.9075, 71.9075, 71.875, 71.875, 71.785, 71.785, 71.8175, 71.8175, 71.965, 71.965]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842 
)
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.396, Test loss: 0.752, Test accuracy: 76.48
Average accuracy final 10 rounds: 75.8665 

4643.868995189667
[4.474827766418457, 8.949655532836914, 13.359313726425171, 17.768971920013428, 22.175304412841797, 26.581636905670166, 30.99447512626648, 35.40731334686279, 39.83250713348389, 44.25770092010498, 48.68129205703735, 53.10488319396973, 57.103360176086426, 61.101837158203125, 65.10451769828796, 69.1071982383728, 73.12974119186401, 77.15228414535522, 81.19462442398071, 85.2369647026062, 89.26997494697571, 93.30298519134521, 97.32497692108154, 101.34696865081787, 105.368479013443, 109.38998937606812, 113.40540146827698, 117.42081356048584, 121.4017174243927, 125.38262128829956, 129.3714144229889, 133.36020755767822, 137.36423254013062, 141.368257522583, 145.34458327293396, 149.3209090232849, 153.30506443977356, 157.2892198562622, 161.32786345481873, 165.36650705337524, 169.4114580154419, 173.45640897750854, 177.49431943893433, 181.5322299003601, 185.5340449810028, 189.5358600616455, 193.55797481536865, 197.5800895690918, 201.58593273162842, 205.59177589416504, 209.61758065223694, 213.64338541030884, 217.69126892089844, 221.73915243148804, 225.6753284931183, 229.61150455474854, 233.6131556034088, 237.6148066520691, 241.58916020393372, 245.56351375579834, 249.5188934803009, 253.47427320480347, 257.5002360343933, 261.52619886398315, 265.5297944545746, 269.533390045166, 273.5689232349396, 277.60445642471313, 281.6141710281372, 285.6238856315613, 289.65786385536194, 293.6918420791626, 297.6770360469818, 301.662230014801, 305.63224172592163, 309.60225343704224, 313.60370111465454, 317.60514879226685, 321.5339765548706, 325.46280431747437, 329.4073247909546, 333.3518452644348, 337.35739612579346, 341.3629469871521, 345.3761706352234, 349.3893942832947, 353.4025378227234, 357.4156813621521, 361.4119324684143, 365.4081835746765, 369.43982696533203, 373.47147035598755, 377.4737377166748, 381.47600507736206, 385.51124835014343, 389.5464916229248, 393.55568265914917, 397.56487369537354, 401.5316939353943, 405.49851417541504, 409.4829580783844, 413.46740198135376, 417.4132270812988, 421.3590521812439, 425.31868600845337, 429.27831983566284, 433.24209856987, 437.20587730407715, 441.18972539901733, 445.1735734939575, 449.187504529953, 453.2014355659485, 457.1992597579956, 461.1970839500427, 465.17859411239624, 469.16010427474976, 473.1302001476288, 477.1002960205078, 481.08807015419006, 485.0758442878723, 489.11235785484314, 493.14887142181396, 497.15084958076477, 501.1528277397156, 505.08910846710205, 509.0253891944885, 513.0045411586761, 516.9836931228638, 520.9791853427887, 524.9746775627136, 528.9393746852875, 532.9040718078613, 536.871821641922, 540.8395714759827, 544.8281192779541, 548.8166670799255, 552.8387115001678, 556.8607559204102, 560.8546805381775, 564.8486051559448, 568.8197290897369, 572.790853023529, 576.7674434185028, 580.7440338134766, 584.7594137191772, 588.7747936248779, 592.7629754543304, 596.751157283783, 600.7003111839294, 604.6494650840759, 608.6132826805115, 612.577100276947, 616.5616323947906, 620.5461645126343, 624.5409154891968, 628.5356664657593, 632.5474035739899, 636.5591406822205, 640.5500736236572, 644.541006565094, 648.5225894451141, 652.5041723251343, 656.4699625968933, 660.4357528686523, 664.4412322044373, 668.4467115402222, 672.4490838050842, 676.4514560699463, 680.3881494998932, 684.3248429298401, 688.2671473026276, 692.209451675415, 696.1949682235718, 700.1804847717285, 704.1418528556824, 708.1032209396362, 712.0499622821808, 715.9967036247253, 719.9636046886444, 723.9305057525635, 727.940761089325, 731.9510164260864, 735.950624704361, 739.9502329826355, 743.9485599994659, 747.9468870162964, 751.9269440174103, 755.9070010185242, 759.8712801933289, 763.8355593681335, 767.8097031116486, 771.7838468551636, 775.7821755409241, 779.7805042266846, 783.7376370429993, 787.694769859314, 791.6392605304718, 795.5837512016296, 799.5954008102417, 803.6070504188538, 805.5177428722382, 807.4284353256226]
[12.2575, 12.2575, 18.2225, 18.2225, 24.045, 24.045, 31.9725, 31.9725, 35.7525, 35.7525, 40.0275, 40.0275, 45.08, 45.08, 48.42, 48.42, 52.33, 52.33, 56.3675, 56.3675, 58.4975, 58.4975, 60.105, 60.105, 61.405, 61.405, 62.7475, 62.7475, 63.7925, 63.7925, 64.815, 64.815, 65.44, 65.44, 66.2125, 66.2125, 66.6075, 66.6075, 65.59, 65.59, 67.18, 67.18, 68.13, 68.13, 68.3375, 68.3375, 68.635, 68.635, 69.1775, 69.1775, 69.4875, 69.4875, 69.685, 69.685, 70.33, 70.33, 70.825, 70.825, 71.1625, 71.1625, 71.78, 71.78, 72.215, 72.215, 72.35, 72.35, 72.23, 72.23, 72.4625, 72.4625, 72.54, 72.54, 72.525, 72.525, 72.735, 72.735, 73.2525, 73.2525, 73.5175, 73.5175, 73.48, 73.48, 73.1675, 73.1675, 73.3325, 73.3325, 73.5225, 73.5225, 73.79, 73.79, 73.8375, 73.8375, 73.5475, 73.5475, 73.8425, 73.8425, 73.81, 73.81, 74.35, 74.35, 74.395, 74.395, 74.175, 74.175, 74.53, 74.53, 74.2725, 74.2725, 74.8975, 74.8975, 74.3825, 74.3825, 74.3875, 74.3875, 74.7075, 74.7075, 74.7925, 74.7925, 74.84, 74.84, 74.595, 74.595, 74.8, 74.8, 75.1, 75.1, 75.0875, 75.0875, 74.875, 74.875, 75.045, 75.045, 75.0725, 75.0725, 75.2475, 75.2475, 74.7725, 74.7725, 74.83, 74.83, 74.8525, 74.8525, 75.6475, 75.6475, 75.46, 75.46, 75.2275, 75.2275, 75.2575, 75.2575, 75.13, 75.13, 75.095, 75.095, 74.925, 74.925, 75.705, 75.705, 75.69, 75.69, 75.4375, 75.4375, 75.505, 75.505, 75.6925, 75.6925, 75.675, 75.675, 75.7625, 75.7625, 75.48, 75.48, 75.0825, 75.0825, 75.7275, 75.7275, 75.7125, 75.7125, 75.445, 75.445, 75.49, 75.49, 75.8025, 75.8025, 75.57, 75.57, 76.235, 76.235, 75.615, 75.615, 76.1825, 76.1825, 76.035, 76.035, 75.8625, 75.8625, 75.7075, 75.7075, 76.165, 76.165, 76.4825, 76.4825]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedper  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedper , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
fedper
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842 
)
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.306, Test loss: 0.838, Test accuracy: 76.53
Average accuracy final 10 rounds: 76.674 

5222.922810554504
[4.85055947303772, 9.70111894607544, 14.493492603302002, 19.285866260528564, 24.08557438850403, 28.885282516479492, 33.682504653930664, 38.479726791381836, 43.2538058757782, 48.02788496017456, 52.83842206001282, 57.648959159851074, 62.49572730064392, 67.34249544143677, 72.1919276714325, 77.04135990142822, 81.89384460449219, 86.74632930755615, 91.57309651374817, 96.39986371994019, 101.2474627494812, 106.09506177902222, 110.92895030975342, 115.76283884048462, 120.55913519859314, 125.35543155670166, 130.17822909355164, 135.0010266304016, 139.83089995384216, 144.66077327728271, 149.49689650535583, 154.33301973342896, 159.14685463905334, 163.96068954467773, 168.77234387397766, 173.5839982032776, 178.7618625164032, 183.9397268295288, 189.0700991153717, 194.2004714012146, 199.35057830810547, 204.50068521499634, 209.68380331993103, 214.86692142486572, 220.02922439575195, 225.19152736663818, 230.32964992523193, 235.46777248382568, 240.64759135246277, 245.82741022109985, 251.01208329200745, 256.19675636291504, 261.34810757637024, 266.49945878982544, 271.75900077819824, 277.01854276657104, 282.1785228252411, 287.33850288391113, 292.6119112968445, 297.88531970977783, 302.96417570114136, 308.0430316925049, 313.193320274353, 318.3436088562012, 323.55235981941223, 328.7611107826233, 333.9827461242676, 339.20438146591187, 344.4475848674774, 349.69078826904297, 354.902161359787, 360.113534450531, 365.3066346645355, 370.49973487854004, 375.6707820892334, 380.84182929992676, 386.0768768787384, 391.31192445755005, 396.49197697639465, 401.67202949523926, 406.8422529697418, 412.0124764442444, 417.1897542476654, 422.3670320510864, 427.5206537246704, 432.6742753982544, 437.8195035457611, 442.9647316932678, 448.1005370616913, 453.23634243011475, 458.3868749141693, 463.5374073982239, 468.7676351070404, 473.99786281585693, 479.2307391166687, 484.46361541748047, 489.67778158187866, 494.89194774627686, 500.1318256855011, 505.37170362472534, 510.5938594341278, 515.8160152435303, 521.0212733745575, 526.2265315055847, 530.9281349182129, 535.6297383308411, 542.2421262264252, 548.8545141220093, 554.0256249904633, 559.1967358589172, 564.3699407577515, 569.5431456565857, 574.7374374866486, 579.9317293167114, 585.1722111701965, 590.4126930236816, 595.6588203907013, 600.904947757721, 606.0768754482269, 611.2488031387329, 616.455178976059, 621.661554813385, 626.9351286888123, 632.2087025642395, 637.3914811611176, 642.5742597579956, 647.7836797237396, 652.9930996894836, 658.2068748474121, 663.4206500053406, 668.6517758369446, 673.8829016685486, 679.0732634067535, 684.2636251449585, 689.4891362190247, 694.7146472930908, 699.9454584121704, 705.17626953125, 710.1610231399536, 715.1457767486572, 720.0401709079742, 724.9345650672913, 729.7930750846863, 734.6515851020813, 739.3918154239655, 744.1320457458496, 748.3938665390015, 752.6556873321533, 757.015186548233, 761.3746857643127, 765.672801733017, 769.9709177017212, 774.2768585681915, 778.5827994346619, 782.8658194541931, 787.1488394737244, 791.4540274143219, 795.7592153549194, 800.0679948329926, 804.3767743110657, 808.6728904247284, 812.9690065383911, 817.2772207260132, 821.5854349136353, 825.8576350212097, 830.1298351287842, 834.5772342681885, 839.0246334075928, 843.3268666267395, 847.6290998458862, 851.9701368808746, 856.311173915863, 860.6174132823944, 864.9236526489258, 869.2402498722076, 873.5568470954895, 877.8982427120209, 882.2396383285522, 886.517083644867, 890.7945289611816, 895.0877387523651, 899.3809485435486, 903.728524684906, 908.0761008262634, 912.392637014389, 916.7091732025146, 921.0167238712311, 925.3242745399475, 929.6455283164978, 933.9667820930481, 938.3885226249695, 942.8102631568909, 947.1631455421448, 951.5160279273987, 955.8602566719055, 960.2044854164124, 964.5209624767303, 968.8374395370483, 973.1879858970642, 977.5385322570801, 979.5178127288818, 981.4970932006836]
[12.33, 12.33, 16.18, 16.18, 19.2925, 19.2925, 24.4175, 24.4175, 31.2525, 31.2525, 37.98, 37.98, 45.1525, 45.1525, 48.8075, 48.8075, 52.2275, 52.2275, 56.53, 56.53, 60.225, 60.225, 63.4325, 63.4325, 65.56, 65.56, 66.7, 66.7, 67.63, 67.63, 68.3225, 68.3225, 69.5075, 69.5075, 70.5925, 70.5925, 71.1275, 71.1275, 71.0575, 71.0575, 71.4725, 71.4725, 71.8325, 71.8325, 72.205, 72.205, 73.1075, 73.1075, 73.265, 73.265, 73.1075, 73.1075, 73.6975, 73.6975, 73.845, 73.845, 74.145, 74.145, 73.9625, 73.9625, 74.34, 74.34, 74.4425, 74.4425, 74.39, 74.39, 74.725, 74.725, 74.5325, 74.5325, 74.5925, 74.5925, 75.035, 75.035, 75.09, 75.09, 75.3225, 75.3225, 75.1975, 75.1975, 75.44, 75.44, 75.59, 75.59, 75.115, 75.115, 74.8275, 74.8275, 75.3675, 75.3675, 75.795, 75.795, 75.455, 75.455, 75.51, 75.51, 75.855, 75.855, 75.76, 75.76, 75.8025, 75.8025, 76.0375, 76.0375, 76.06, 76.06, 75.935, 75.935, 76.0775, 76.0775, 75.5925, 75.5925, 75.98, 75.98, 76.1575, 76.1575, 76.1075, 76.1075, 75.825, 75.825, 76.1075, 76.1075, 76.055, 76.055, 75.8575, 75.8575, 75.9325, 75.9325, 75.8625, 75.8625, 76.1075, 76.1075, 76.1425, 76.1425, 76.35, 76.35, 76.1575, 76.1575, 76.12, 76.12, 76.3175, 76.3175, 76.09, 76.09, 76.2875, 76.2875, 75.885, 75.885, 75.85, 75.85, 76.2425, 76.2425, 76.2, 76.2, 76.3025, 76.3025, 76.43, 76.43, 76.5925, 76.5925, 76.49, 76.49, 76.555, 76.555, 76.3675, 76.3675, 76.7975, 76.7975, 76.495, 76.495, 76.32, 76.32, 76.5075, 76.5075, 76.4725, 76.4725, 76.47, 76.47, 76.3275, 76.3275, 76.7425, 76.7425, 76.5875, 76.5875, 76.9325, 76.9325, 76.98, 76.98, 76.085, 76.085, 76.7575, 76.7575, 76.835, 76.835, 76.55, 76.55, 76.75, 76.75, 76.52, 76.52, 76.5325, 76.5325]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  lg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: lg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.0  

Files already downloaded and verified
Files already downloaded and verified
lg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 8394 (global); Percentage 2.73 (8394/307842 
)
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 0.038, Test loss: 0.991, Test accuracy: 81.71
Average accuracy final 10 rounds: 81.43999999999998 

1520.711226940155
[1.810398817062378, 3.620797634124756, 5.167631149291992, 6.7144646644592285, 8.247933626174927, 9.781402587890625, 11.316368103027344, 12.851333618164062, 14.40787386894226, 15.964414119720459, 17.51363778114319, 19.062861442565918, 20.5873966217041, 22.111931800842285, 23.638489484786987, 25.16504716873169, 26.720673084259033, 28.276298999786377, 29.817112922668457, 31.357926845550537, 32.884809732437134, 34.41169261932373, 35.961631298065186, 37.51156997680664, 39.07858943939209, 40.64560890197754, 42.187907457351685, 43.73020601272583, 45.25007081031799, 46.769935607910156, 48.05704069137573, 49.34414577484131, 50.62887120246887, 51.913596630096436, 53.20301580429077, 54.49243497848511, 55.759114027023315, 57.02579307556152, 58.30340003967285, 59.58100700378418, 60.873884201049805, 62.16676139831543, 63.468284606933594, 64.76980781555176, 66.04031372070312, 67.31081962585449, 68.57219815254211, 69.83357667922974, 71.10696291923523, 72.38034915924072, 73.672842502594, 74.96533584594727, 76.25343179702759, 77.54152774810791, 78.80396699905396, 80.06640625, 81.33394694328308, 82.60148763656616, 83.88506865501404, 85.16864967346191, 86.46220254898071, 87.75575542449951, 89.03436279296875, 90.31297016143799, 91.57812905311584, 92.8432879447937, 94.22225403785706, 95.60122013092041, 96.89339804649353, 98.18557596206665, 99.47727060317993, 100.76896524429321, 102.02677941322327, 103.28459358215332, 104.58702492713928, 105.88945627212524, 107.17020511627197, 108.4509539604187, 109.73267436027527, 111.01439476013184, 112.28320145606995, 113.55200815200806, 114.83208990097046, 116.11217164993286, 117.42656898498535, 118.74096632003784, 120.01163792610168, 121.28230953216553, 122.55594444274902, 123.82957935333252, 125.1112539768219, 126.39292860031128, 127.67582321166992, 128.95871782302856, 130.24372673034668, 131.5287356376648, 132.80320024490356, 134.07766485214233, 135.35140109062195, 136.62513732910156, 137.9179563522339, 139.2107753753662, 140.50214767456055, 141.79351997375488, 143.06622433662415, 144.3389286994934, 145.62029480934143, 146.90166091918945, 148.18385863304138, 149.4660563468933, 150.74232387542725, 152.01859140396118, 153.2913269996643, 154.56406259536743, 155.8464343547821, 157.12880611419678, 158.4340262413025, 159.7392463684082, 161.0270311832428, 162.3148159980774, 163.58083605766296, 164.84685611724854, 166.10794162750244, 167.36902713775635, 168.66140222549438, 169.95377731323242, 171.23901271820068, 172.52424812316895, 173.7988088130951, 175.07336950302124, 176.3299524784088, 177.5865354537964, 178.88224411010742, 180.17795276641846, 181.48476839065552, 182.79158401489258, 184.08096837997437, 185.37035274505615, 186.6390838623047, 187.90781497955322, 189.18977165222168, 190.47172832489014, 191.7607672214508, 193.04980611801147, 194.3319127559662, 195.6140193939209, 196.8827667236328, 198.15151405334473, 199.420170545578, 200.68882703781128, 201.97306632995605, 203.25730562210083, 204.5326235294342, 205.80794143676758, 207.07544469833374, 208.3429479598999, 209.6096739768982, 210.87639999389648, 212.1684286594391, 213.4604573249817, 214.75110030174255, 216.04174327850342, 217.30158162117004, 218.56141996383667, 219.8250789642334, 221.08873796463013, 222.3806653022766, 223.6725926399231, 224.96614003181458, 226.25968742370605, 227.53735423088074, 228.81502103805542, 230.08350563049316, 231.3519902229309, 232.61933159828186, 233.8866729736328, 235.18177366256714, 236.47687435150146, 237.7538001537323, 239.03072595596313, 240.314701795578, 241.59867763519287, 242.8773307800293, 244.15598392486572, 245.4374759197235, 246.7189679145813, 248.00069880485535, 249.2824296951294, 250.5725393295288, 251.86264896392822, 253.14734482765198, 254.43204069137573, 255.71014714241028, 256.9882535934448, 258.25642800331116, 259.5246024131775, 260.7944645881653, 262.0643267631531, 263.33837246894836, 264.61241817474365, 266.7022023200989, 268.7919864654541]
[23.283333333333335, 23.283333333333335, 35.5, 35.5, 39.05833333333333, 39.05833333333333, 41.541666666666664, 41.541666666666664, 42.391666666666666, 42.391666666666666, 54.916666666666664, 54.916666666666664, 57.8, 57.8, 65.89166666666667, 65.89166666666667, 67.74166666666666, 67.74166666666666, 69.59166666666667, 69.59166666666667, 71.2, 71.2, 71.29166666666667, 71.29166666666667, 72.09166666666667, 72.09166666666667, 74.20833333333333, 74.20833333333333, 75.49166666666666, 75.49166666666666, 75.34166666666667, 75.34166666666667, 76.075, 76.075, 76.56666666666666, 76.56666666666666, 76.86666666666666, 76.86666666666666, 76.31666666666666, 76.31666666666666, 77.4, 77.4, 77.125, 77.125, 78.26666666666667, 78.26666666666667, 77.51666666666667, 77.51666666666667, 77.54166666666667, 77.54166666666667, 78.41666666666667, 78.41666666666667, 78.63333333333334, 78.63333333333334, 78.975, 78.975, 77.98333333333333, 77.98333333333333, 78.2, 78.2, 78.78333333333333, 78.78333333333333, 79.15, 79.15, 79.03333333333333, 79.03333333333333, 79.41666666666667, 79.41666666666667, 79.1, 79.1, 79.0, 79.0, 79.40833333333333, 79.40833333333333, 79.3, 79.3, 79.55, 79.55, 79.61666666666666, 79.61666666666666, 79.64166666666667, 79.64166666666667, 80.03333333333333, 80.03333333333333, 80.4, 80.4, 80.625, 80.625, 80.58333333333333, 80.58333333333333, 80.375, 80.375, 80.43333333333334, 80.43333333333334, 79.68333333333334, 79.68333333333334, 80.01666666666667, 80.01666666666667, 79.99166666666666, 79.99166666666666, 80.28333333333333, 80.28333333333333, 80.49166666666666, 80.49166666666666, 80.68333333333334, 80.68333333333334, 80.75833333333334, 80.75833333333334, 80.4, 80.4, 80.325, 80.325, 80.075, 80.075, 79.85, 79.85, 80.03333333333333, 80.03333333333333, 80.33333333333333, 80.33333333333333, 80.81666666666666, 80.81666666666666, 81.00833333333334, 81.00833333333334, 81.15833333333333, 81.15833333333333, 80.73333333333333, 80.73333333333333, 81.09166666666667, 81.09166666666667, 80.88333333333334, 80.88333333333334, 80.63333333333334, 80.63333333333334, 80.775, 80.775, 81.15833333333333, 81.15833333333333, 81.30833333333334, 81.30833333333334, 81.1, 81.1, 81.21666666666667, 81.21666666666667, 80.71666666666667, 80.71666666666667, 81.11666666666666, 81.11666666666666, 81.45, 81.45, 81.49166666666666, 81.49166666666666, 81.8, 81.8, 81.75833333333334, 81.75833333333334, 81.575, 81.575, 81.20833333333333, 81.20833333333333, 81.04166666666667, 81.04166666666667, 81.35833333333333, 81.35833333333333, 81.46666666666667, 81.46666666666667, 81.44166666666666, 81.44166666666666, 81.00833333333334, 81.00833333333334, 81.06666666666666, 81.06666666666666, 81.275, 81.275, 81.25, 81.25, 81.46666666666667, 81.46666666666667, 81.30833333333334, 81.30833333333334, 81.15, 81.15, 81.21666666666667, 81.21666666666667, 81.3, 81.3, 81.21666666666667, 81.21666666666667, 81.45, 81.45, 81.46666666666667, 81.46666666666667, 81.66666666666667, 81.66666666666667, 81.59166666666667, 81.59166666666667, 81.64166666666667, 81.64166666666667, 81.7, 81.7, 81.70833333333333, 81.70833333333333]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_apfl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
Final Round, Train loss: 0.068, Test loss: 0.764, Test accuracy: 67.43
Average accuracy final 10 rounds: 68.16166666666666
2179.865911245346
[]
[21.55, 34.766666666666666, 38.99166666666667, 41.1, 46.65, 50.575, 56.516666666666666, 59.225, 59.75, 60.24166666666667, 59.3, 60.2, 61.25833333333333, 61.43333333333333, 60.44166666666667, 60.9, 60.475, 61.8, 61.4, 61.65, 62.59166666666667, 63.49166666666667, 64.60833333333333, 64.075, 64.475, 64.925, 64.65833333333333, 64.98333333333333, 65.86666666666666, 66.49166666666666, 65.88333333333334, 64.99166666666666, 66.15, 65.88333333333334, 66.35, 65.96666666666667, 65.4, 66.03333333333333, 66.28333333333333, 67.29166666666667, 66.43333333333334, 67.30833333333334, 66.89166666666667, 67.39166666666667, 66.825, 67.525, 67.95, 68.3, 69.275, 69.26666666666667, 67.79166666666667, 68.48333333333333, 69.075, 68.48333333333333, 69.84166666666667, 70.175, 70.88333333333334, 69.86666666666666, 69.6, 70.49166666666666, 69.66666666666667, 68.49166666666666, 68.50833333333334, 69.09166666666667, 69.34166666666667, 69.275, 68.93333333333334, 67.95, 68.73333333333333, 68.74166666666666, 68.09166666666667, 68.01666666666667, 68.275, 67.61666666666666, 67.375, 67.475, 67.01666666666667, 66.425, 65.88333333333334, 66.90833333333333, 67.19166666666666, 68.03333333333333, 68.71666666666667, 69.025, 68.66666666666667, 68.775, 68.65833333333333, 68.93333333333334, 67.89166666666667, 68.28333333333333, 68.53333333333333, 68.8, 69.20833333333333, 68.8, 67.61666666666666, 68.38333333333334, 68.4, 66.975, 67.35833333333333, 67.54166666666667, 67.43333333333334]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Fed_scaffold %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Final Round, Train loss: 0.575, Test loss: 0.564, Test accuracy: 77.26
Average accuracy final 10 rounds: 78.05
Average global accuracy final 10 rounds: 78.05
1434.424687385559
[]
[20.975, 33.45, 41.233333333333334, 40.666666666666664, 46.55, 53.95, 57.583333333333336, 61.75, 61.208333333333336, 63.475, 65.4, 65.73333333333333, 67.43333333333334, 68.98333333333333, 69.06666666666666, 68.85833333333333, 70.10833333333333, 70.46666666666667, 72.30833333333334, 72.175, 72.13333333333334, 71.66666666666667, 71.425, 72.34166666666667, 73.00833333333334, 72.84166666666667, 72.90833333333333, 72.41666666666667, 73.44166666666666, 73.30833333333334, 73.50833333333334, 73.9, 73.69166666666666, 73.94166666666666, 73.475, 74.13333333333334, 74.74166666666666, 74.93333333333334, 75.35833333333333, 75.3, 75.16666666666667, 74.475, 74.775, 74.06666666666666, 74.25833333333334, 74.95833333333333, 75.81666666666666, 75.85, 76.825, 76.59166666666667, 76.20833333333333, 76.26666666666667, 76.05833333333334, 75.59166666666667, 76.33333333333333, 76.7, 76.05833333333334, 76.26666666666667, 77.025, 76.76666666666667, 76.225, 76.53333333333333, 76.48333333333333, 76.74166666666666, 76.44166666666666, 76.175, 76.7, 76.69166666666666, 76.25833333333334, 77.06666666666666, 77.40833333333333, 76.88333333333334, 77.30833333333334, 77.55, 77.775, 77.35, 77.30833333333334, 76.43333333333334, 75.88333333333334, 76.61666666666666, 76.60833333333333, 76.625, 76.29166666666667, 76.65833333333333, 76.83333333333333, 77.125, 77.25833333333334, 77.425, 77.925, 77.88333333333334, 78.125, 77.96666666666667, 77.96666666666667, 77.94166666666666, 78.05833333333334, 78.1, 78.5, 78.25833333333334, 77.89166666666667, 77.69166666666666, 77.25833333333334]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  pFedMe   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Final Round, Train loss: nan, Test loss: nan, Test accuracy: 10.00
Final Round, Global train loss: nan, Global test loss: nan, Global test accuracy: 10.00
Average accuracy final 10 rounds: 10.0 

Average global accuracy final 10 rounds: 10.0 

1616.7553980350494
[1.7957804203033447, 3.363603115081787, 4.934453725814819, 6.546543836593628, 8.12610936164856, 9.697511672973633, 11.257782220840454, 12.824114799499512, 14.385583877563477, 15.938385963439941, 17.48066735267639, 19.03608512878418, 20.600558757781982, 22.165849208831787, 23.73994016647339, 25.312582969665527, 26.872599363327026, 28.434995889663696, 29.99668598175049, 31.553125143051147, 33.105048179626465, 34.64519119262695, 36.182689905166626, 37.7285053730011, 39.269891023635864, 40.81485033035278, 42.364293336868286, 43.92036318778992, 45.46657586097717, 47.017234802246094, 48.57058668136597, 50.11940884590149, 51.66435980796814, 53.20307469367981, 54.743789196014404, 56.28882026672363, 57.8437876701355, 59.400208473205566, 60.953566551208496, 62.5029673576355, 64.05904459953308, 65.61532282829285, 67.15802311897278, 68.71868991851807, 70.26294827461243, 71.80817651748657, 73.35948944091797, 74.91479539871216, 76.46474313735962, 78.00398349761963, 79.55581974983215, 81.11576771736145, 82.65692353248596, 84.20361113548279, 85.74970626831055, 87.29812026023865, 88.85014462471008, 90.40292453765869, 91.95628643035889, 93.50530934333801, 95.04551100730896, 96.59565472602844, 97.96990370750427, 99.35114455223083, 100.72536182403564, 102.1026566028595, 103.47041964530945, 104.85583829879761, 106.2298903465271, 107.602365732193, 108.97315287590027, 110.34665751457214, 111.7121570110321, 113.08705186843872, 114.4638876914978, 115.83863735198975, 117.209956407547, 118.56518816947937, 119.94321179389954, 121.33657598495483, 122.71650290489197, 124.09860610961914, 125.48173880577087, 126.85370230674744, 128.23856139183044, 129.61962485313416, 131.0037546157837, 132.3939483165741, 133.78257989883423, 135.15962171554565, 136.5459394454956, 137.94224762916565, 139.3396475315094, 140.73281335830688, 142.1275191307068, 143.52408623695374, 144.90820360183716, 146.28906083106995, 147.6788775920868, 149.05578351020813, 151.36073422431946]
[10.041666666666666, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_ditto%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
Final Round, Train loss: 0.187, Test loss: 2.502, Test accuracy: 25.09
Average accuracy final 10 rounds: 22.730833333333333
2488.1307775974274
[3.702800750732422, 7.1673338413238525, 10.650895833969116, 14.115853309631348, 17.544371128082275, 21.370955228805542, 25.189160585403442, 29.001147985458374, 32.4481635093689, 35.88465642929077, 39.35194110870361, 42.81688356399536, 46.257253885269165, 49.696146726608276, 53.11839008331299, 56.5478937625885, 59.98455238342285, 63.417855978012085, 66.86990976333618, 70.30725145339966, 73.74441456794739, 77.20366644859314, 80.73477625846863, 84.23179244995117, 87.68786597251892, 91.199223279953, 94.68405747413635, 98.16055679321289, 101.645681142807, 105.10876965522766, 108.61303329467773, 112.09662628173828, 115.59626126289368, 119.07920718193054, 122.56576013565063, 126.06611275672913, 129.51969361305237, 133.0023958683014, 136.49626970291138, 139.9585838317871, 143.4545295238495, 146.93131017684937, 150.45903182029724, 153.99552416801453, 157.53095626831055, 161.08278250694275, 164.55534029006958, 168.0325584411621, 171.55859541893005, 175.0676999092102, 178.57216930389404, 182.10721254348755, 185.6713593006134, 189.22002387046814, 192.75122475624084, 196.307630777359, 199.8367052078247, 203.4045271873474, 207.0002088546753, 210.5769419670105, 214.15132999420166, 217.74465131759644, 221.32312417030334, 224.9087154865265, 228.44298768043518, 231.9875409603119, 235.52738642692566, 239.05574750900269, 242.56309270858765, 246.08927655220032, 249.6479902267456, 253.2026767730713, 256.6884367465973, 260.16636967658997, 263.6634714603424, 267.1536509990692, 270.670622587204, 274.23228001594543, 277.7708010673523, 281.3532724380493, 284.86366748809814, 288.39115953445435, 291.90020275115967, 295.41754245758057, 298.9925603866577, 302.54923939704895, 306.11913800239563, 309.6151473522186, 313.1399793624878, 316.62854385375977, 320.1332564353943, 323.6452012062073, 327.1975257396698, 330.7178695201874, 334.235769033432, 337.78889417648315, 341.33141112327576, 344.84884428977966, 348.38776659965515, 351.9505305290222, 354.8839204311371]
[13.341666666666667, 19.433333333333334, 19.025, 22.75, 22.016666666666666, 21.866666666666667, 23.066666666666666, 19.45, 22.075, 21.341666666666665, 23.225, 22.0, 21.791666666666668, 20.791666666666668, 21.008333333333333, 21.708333333333332, 23.825, 22.2, 21.208333333333332, 22.383333333333333, 22.483333333333334, 22.75, 20.958333333333332, 19.166666666666668, 20.616666666666667, 20.641666666666666, 20.825, 18.191666666666666, 21.7, 22.975, 23.391666666666666, 21.191666666666666, 22.416666666666668, 24.1, 23.441666666666666, 23.233333333333334, 22.958333333333332, 24.341666666666665, 23.75, 20.966666666666665, 22.458333333333332, 22.55, 22.825, 24.025, 25.383333333333333, 23.333333333333332, 23.933333333333334, 24.158333333333335, 23.075, 24.925, 24.066666666666666, 21.508333333333333, 22.383333333333333, 23.091666666666665, 22.6, 24.325, 23.316666666666666, 24.758333333333333, 24.891666666666666, 23.491666666666667, 23.358333333333334, 23.641666666666666, 22.933333333333334, 23.608333333333334, 22.35, 22.458333333333332, 24.425, 24.333333333333332, 22.633333333333333, 23.541666666666668, 20.258333333333333, 23.441666666666666, 25.191666666666666, 23.2, 22.083333333333332, 24.675, 21.8, 22.008333333333333, 22.141666666666666, 23.166666666666668, 21.7, 24.166666666666668, 24.975, 22.416666666666668, 22.425, 22.958333333333332, 21.641666666666666, 23.508333333333333, 23.575, 22.35, 21.558333333333334, 22.291666666666668, 23.166666666666668, 18.958333333333332, 21.833333333333332, 24.441666666666666, 23.325, 23.483333333333334, 24.658333333333335, 23.591666666666665, 25.091666666666665]
python: can't open file 'main_fedpac_k.py': [Errno 2] No such file or directory
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC-K-Means%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
4800
4864
107264
107328
299328
299448
307128
307192
307832
307842
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Final Round, Train loss: 0.203, Test loss: 0.343, Test accuracy: 87.17
Average accuracy final 10 rounds: 86.73166666666668
1826.8115682601929
[2.2585396766662598, 4.5170793533325195, 6.383645057678223, 8.250210762023926, 10.131341218948364, 12.012471675872803, 13.867666006088257, 15.722860336303711, 17.568108081817627, 19.413355827331543, 21.258291959762573, 23.103228092193604, 24.91394305229187, 26.724658012390137, 28.5796902179718, 30.434722423553467, 32.26464533805847, 34.09456825256348, 35.913376331329346, 37.732184410095215, 39.56690955162048, 41.40163469314575, 43.233163356781006, 45.06469202041626, 46.87876772880554, 48.692843437194824, 50.50407791137695, 52.31531238555908, 54.092246294021606, 55.86918020248413, 57.63658261299133, 59.403985023498535, 61.216637134552, 63.02928924560547, 64.84057569503784, 66.65186214447021, 68.47453141212463, 70.29720067977905, 72.12236189842224, 73.94752311706543, 75.77142763137817, 77.59533214569092, 79.43795585632324, 81.28057956695557, 83.09888291358948, 84.91718626022339, 86.7376651763916, 88.55814409255981, 90.39913487434387, 92.24012565612793, 94.07523822784424, 95.91035079956055, 97.72667837142944, 99.54300594329834, 101.37609100341797, 103.2091760635376, 105.04620099067688, 106.88322591781616, 108.72498321533203, 110.5667405128479, 112.4014687538147, 114.2361969947815, 116.09161043167114, 117.94702386856079, 119.7767767906189, 121.606529712677, 123.41922736167908, 125.23192501068115, 127.06318426132202, 128.8944435119629, 130.72902250289917, 132.56360149383545, 134.40446281433105, 136.24532413482666, 138.08168363571167, 139.91804313659668, 141.7531373500824, 143.58823156356812, 145.44829845428467, 147.30836534500122, 149.1420612335205, 150.9757571220398, 152.79434776306152, 154.61293840408325, 156.44595313072205, 158.27896785736084, 160.10922837257385, 161.93948888778687, 163.76972222328186, 165.59995555877686, 167.42218923568726, 169.24442291259766, 171.07346105575562, 172.90249919891357, 174.7565610408783, 176.61062288284302, 178.48073935508728, 180.35085582733154, 182.19921159744263, 184.0475673675537, 185.882803440094, 187.71803951263428, 189.5660228729248, 191.41400623321533, 193.26479816436768, 195.11559009552002, 196.95751643180847, 198.79944276809692, 200.64291143417358, 202.48638010025024, 204.3194077014923, 206.15243530273438, 208.00253200531006, 209.85262870788574, 211.69718503952026, 213.54174137115479, 215.37623834609985, 217.21073532104492, 219.05089664459229, 220.89105796813965, 222.73709726333618, 224.58313655853271, 226.44400715827942, 228.30487775802612, 230.14429473876953, 231.98371171951294, 233.81215023994446, 235.64058876037598, 237.49261283874512, 239.34463691711426, 241.18881034851074, 243.03298377990723, 244.86916995048523, 246.70535612106323, 248.54045033454895, 250.37554454803467, 252.22761750221252, 254.07969045639038, 255.9073302745819, 257.73497009277344, 259.55916714668274, 261.38336420059204, 263.2222821712494, 265.06120014190674, 266.878865480423, 268.6965308189392, 270.5303108692169, 272.36409091949463, 274.20201683044434, 276.03994274139404, 277.88354110717773, 279.7271394729614, 281.5445399284363, 283.36194038391113, 285.2245280742645, 287.0871157646179, 288.92115235328674, 290.75518894195557, 292.59805560112, 294.4409222602844, 296.26549100875854, 298.09005975723267, 299.9067916870117, 301.72352361679077, 303.53878569602966, 305.35404777526855, 307.1679615974426, 308.9818754196167, 310.7987711429596, 312.6156668663025, 314.43528270721436, 316.2548985481262, 318.06826853752136, 319.8816385269165, 321.7033395767212, 323.5250406265259, 325.33474564552307, 327.14445066452026, 328.9660692214966, 330.7876877784729, 332.6043176651001, 334.4209475517273, 336.2217321395874, 338.0225167274475, 339.85211753845215, 341.6817183494568, 343.502810716629, 345.32390308380127, 347.13706040382385, 348.95021772384644, 350.7798306941986, 352.6094436645508, 354.42859983444214, 356.2477560043335, 358.0743820667267, 359.9010081291199, 361.72971296310425, 363.5584177970886, 365.380074262619, 367.2017307281494, 369.44371128082275, 371.6856918334961]
[16.016666666666666, 16.016666666666666, 32.21666666666667, 32.21666666666667, 40.90833333333333, 40.90833333333333, 45.675, 45.675, 52.975, 52.975, 54.4, 54.4, 56.71666666666667, 56.71666666666667, 62.733333333333334, 62.733333333333334, 67.84166666666667, 67.84166666666667, 68.625, 68.625, 69.6, 69.6, 70.475, 70.475, 73.54166666666667, 73.54166666666667, 74.74166666666666, 74.74166666666666, 76.0, 76.0, 76.66666666666667, 76.66666666666667, 76.56666666666666, 76.56666666666666, 77.4, 77.4, 77.45, 77.45, 77.9, 77.9, 78.725, 78.725, 79.55, 79.55, 79.71666666666667, 79.71666666666667, 79.24166666666666, 79.24166666666666, 79.81666666666666, 79.81666666666666, 79.89166666666667, 79.89166666666667, 80.43333333333334, 80.43333333333334, 80.54166666666667, 80.54166666666667, 80.825, 80.825, 80.38333333333334, 80.38333333333334, 81.03333333333333, 81.03333333333333, 81.525, 81.525, 81.60833333333333, 81.60833333333333, 82.2, 82.2, 82.35, 82.35, 82.10833333333333, 82.10833333333333, 82.35, 82.35, 82.48333333333333, 82.48333333333333, 82.55833333333334, 82.55833333333334, 82.44166666666666, 82.44166666666666, 83.1, 83.1, 83.45833333333333, 83.45833333333333, 83.125, 83.125, 83.85833333333333, 83.85833333333333, 83.90833333333333, 83.90833333333333, 83.6, 83.6, 83.68333333333334, 83.68333333333334, 83.875, 83.875, 84.375, 84.375, 84.325, 84.325, 84.21666666666667, 84.21666666666667, 84.125, 84.125, 84.04166666666667, 84.04166666666667, 84.11666666666666, 84.11666666666666, 84.66666666666667, 84.66666666666667, 84.575, 84.575, 84.36666666666666, 84.36666666666666, 83.75833333333334, 83.75833333333334, 84.49166666666666, 84.49166666666666, 84.48333333333333, 84.48333333333333, 84.75, 84.75, 85.19166666666666, 85.19166666666666, 84.95833333333333, 84.95833333333333, 85.16666666666667, 85.16666666666667, 85.24166666666666, 85.24166666666666, 85.43333333333334, 85.43333333333334, 84.675, 84.675, 85.70833333333333, 85.70833333333333, 85.16666666666667, 85.16666666666667, 85.18333333333334, 85.18333333333334, 85.625, 85.625, 85.14166666666667, 85.14166666666667, 85.61666666666666, 85.61666666666666, 86.1, 86.1, 85.625, 85.625, 86.08333333333333, 86.08333333333333, 86.33333333333333, 86.33333333333333, 86.05833333333334, 86.05833333333334, 85.95833333333333, 85.95833333333333, 86.4, 86.4, 86.10833333333333, 86.10833333333333, 86.38333333333334, 86.38333333333334, 86.21666666666667, 86.21666666666667, 85.925, 85.925, 86.55, 86.55, 86.30833333333334, 86.30833333333334, 85.95833333333333, 85.95833333333333, 86.3, 86.3, 85.75, 85.75, 86.20833333333333, 86.20833333333333, 86.425, 86.425, 86.575, 86.575, 86.01666666666667, 86.01666666666667, 86.775, 86.775, 86.96666666666667, 86.96666666666667, 87.04166666666667, 87.04166666666667, 86.45833333333333, 86.45833333333333, 86.79166666666667, 86.79166666666667, 87.125, 87.125, 87.14166666666667, 87.14166666666667, 87.175, 87.175]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.0  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 1.569, Test loss: 1.635, Test accuracy: 82.81
Final Round, Global train loss: 1.569, Global test loss: 1.624, Global test accuracy: 83.87
Average accuracy final 10 rounds: 82.83824999999999 

Average global accuracy final 10 rounds: 83.8545 

5128.283280849457
[3.7181150913238525, 7.436230182647705, 10.977999687194824, 14.519769191741943, 18.094101905822754, 21.668434619903564, 25.183805227279663, 28.69917583465576, 32.28873586654663, 35.8782958984375, 39.40274786949158, 42.927199840545654, 46.37346291542053, 49.81972599029541, 53.38289952278137, 56.946073055267334, 60.47951674461365, 64.01296043395996, 67.60303044319153, 71.1931004524231, 74.92000675201416, 78.64691305160522, 82.28367042541504, 85.92042779922485, 89.46422481536865, 93.00802183151245, 96.08239006996155, 99.15675830841064, 102.26866579055786, 105.38057327270508, 108.47283267974854, 111.56509208679199, 114.6128671169281, 117.66064214706421, 120.82632803916931, 123.99201393127441, 127.15467548370361, 130.3173370361328, 133.29061341285706, 136.2638897895813, 139.1533169746399, 142.0427441596985, 145.03592228889465, 148.02910041809082, 150.98916602134705, 153.94923162460327, 156.886004447937, 159.82277727127075, 162.7527244091034, 165.68267154693604, 168.59157466888428, 171.50047779083252, 174.38895535469055, 177.27743291854858, 180.18263173103333, 183.08783054351807, 186.00352668762207, 188.91922283172607, 191.8543884754181, 194.7895541191101, 197.7096564769745, 200.62975883483887, 203.55509996414185, 206.48044109344482, 209.37005352973938, 212.25966596603394, 215.1530909538269, 218.04651594161987, 220.95928812026978, 223.87206029891968, 226.80947875976562, 229.74689722061157, 232.7947278022766, 235.84255838394165, 238.88722491264343, 241.93189144134521, 244.92565321922302, 247.91941499710083, 250.90645694732666, 253.8934988975525, 256.8913805484772, 259.88926219940186, 262.89466762542725, 265.90007305145264, 268.9222557544708, 271.944438457489, 274.8971083164215, 277.849778175354, 280.8033695220947, 283.75696086883545, 286.6512405872345, 289.54552030563354, 292.4418203830719, 295.33812046051025, 298.25298285484314, 301.167845249176, 304.10470366477966, 307.0415620803833, 310.03222823143005, 313.0228943824768, 315.973650932312, 318.9244074821472, 321.93254137039185, 324.9406752586365, 327.8877305984497, 330.83478593826294, 333.8164336681366, 336.79808139801025, 339.7386965751648, 342.67931175231934, 345.6760470867157, 348.67278242111206, 351.62199330329895, 354.57120418548584, 357.4320101737976, 360.2928161621094, 363.19631123542786, 366.09980630874634, 368.99814891815186, 371.8964915275574, 374.84274101257324, 377.7889904975891, 380.73648500442505, 383.683979511261, 386.7233898639679, 389.7628002166748, 392.7475163936615, 395.7322325706482, 398.7899615764618, 401.8476905822754, 404.7803418636322, 407.712993144989, 410.661493062973, 413.60999298095703, 416.562908411026, 419.51582384109497, 422.5420620441437, 425.5683002471924, 428.5717890262604, 431.57527780532837, 434.68694519996643, 437.7986125946045, 440.8445565700531, 443.8905005455017, 446.9338684082031, 449.97723627090454, 453.0345959663391, 456.0919556617737, 459.2335367202759, 462.3751177787781, 465.52579402923584, 468.6764702796936, 471.7769033908844, 474.8773365020752, 477.8677353858948, 480.85813426971436, 483.8186933994293, 486.7792525291443, 489.74434542655945, 492.7094383239746, 495.71014380455017, 498.71084928512573, 501.73432302474976, 504.7577967643738, 507.81712532043457, 510.87645387649536, 513.9371960163116, 516.9979381561279, 520.034793138504, 523.0716481208801, 526.1151752471924, 529.1587023735046, 532.3095026016235, 535.4603028297424, 538.6152992248535, 541.7702956199646, 544.9134206771851, 548.0565457344055, 551.1130766868591, 554.1696076393127, 557.1112158298492, 560.0528240203857, 562.881189584732, 565.7095551490784, 568.6180477142334, 571.5265402793884, 574.4895348548889, 577.4525294303894, 580.516428232193, 583.5803270339966, 586.6702740192413, 589.7602210044861, 592.748583316803, 595.7369456291199, 598.6441912651062, 601.5514369010925, 604.506382226944, 607.4613275527954, 610.445366859436, 613.4294061660767, 614.9254283905029, 616.4214506149292]
[36.67, 36.67, 65.56, 65.56, 73.2125, 73.2125, 74.3325, 74.3325, 75.0375, 75.0375, 77.0475, 77.0475, 77.4025, 77.4025, 77.54, 77.54, 77.6025, 77.6025, 77.75, 77.75, 78.48, 78.48, 78.55, 78.55, 80.7625, 80.7625, 80.8225, 80.8225, 81.12, 81.12, 81.13, 81.13, 81.18, 81.18, 81.255, 81.255, 81.46, 81.46, 81.4375, 81.4375, 81.4325, 81.4325, 81.865, 81.865, 81.865, 81.865, 81.87, 81.87, 81.915, 81.915, 81.9125, 81.9125, 81.9975, 81.9975, 81.9925, 81.9925, 82.3125, 82.3125, 82.3025, 82.3025, 82.3075, 82.3075, 82.3225, 82.3225, 82.4875, 82.4875, 82.52, 82.52, 82.53, 82.53, 82.5275, 82.5275, 82.555, 82.555, 82.615, 82.615, 82.6075, 82.6075, 82.6, 82.6, 82.58, 82.58, 82.5575, 82.5575, 82.5875, 82.5875, 82.5925, 82.5925, 82.59, 82.59, 82.61, 82.61, 82.655, 82.655, 82.6475, 82.6475, 82.68, 82.68, 82.65, 82.65, 82.6375, 82.6375, 82.675, 82.675, 82.67, 82.67, 82.685, 82.685, 82.71, 82.71, 82.705, 82.705, 82.7075, 82.7075, 82.735, 82.735, 82.715, 82.715, 82.7075, 82.7075, 82.715, 82.715, 82.715, 82.715, 82.715, 82.715, 82.7275, 82.7275, 82.7425, 82.7425, 82.7275, 82.7275, 82.735, 82.735, 82.75, 82.75, 82.7425, 82.7425, 82.7175, 82.7175, 82.7325, 82.7325, 82.74, 82.74, 82.77, 82.77, 82.7575, 82.7575, 82.765, 82.765, 82.75, 82.75, 82.795, 82.795, 82.7875, 82.7875, 82.815, 82.815, 82.8225, 82.8225, 82.8225, 82.8225, 82.8325, 82.8325, 82.815, 82.815, 82.83, 82.83, 82.815, 82.815, 82.8175, 82.8175, 82.84, 82.84, 82.8125, 82.8125, 82.8025, 82.8025, 82.8175, 82.8175, 82.835, 82.835, 82.8375, 82.8375, 82.845, 82.845, 82.8625, 82.8625, 82.85, 82.85, 82.835, 82.835, 82.825, 82.825, 82.85, 82.85, 82.8275, 82.8275, 82.815, 82.815, 82.8125, 82.8125]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.0  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 1.469, Test loss: 1.497, Test accuracy: 96.62
Final Round, Global train loss: 1.469, Global test loss: 1.496, Global test accuracy: 96.76
Average accuracy final 10 rounds: 96.61975000000001 

Average global accuracy final 10 rounds: 96.78474999999999 

5354.560883283615
[3.5008339881896973, 7.0016679763793945, 10.412813425064087, 13.82395887374878, 17.283701419830322, 20.743443965911865, 24.328362703323364, 27.913281440734863, 31.14948058128357, 34.385679721832275, 37.97315716743469, 41.56063461303711, 45.167555809020996, 48.77447700500488, 52.30479454994202, 55.83511209487915, 59.25495409965515, 62.67479610443115, 66.1460223197937, 69.61724853515625, 73.12502861022949, 76.63280868530273, 80.22500324249268, 83.81719779968262, 87.38355302810669, 90.94990825653076, 94.49768042564392, 98.04545259475708, 101.61843466758728, 105.19141674041748, 108.79081130027771, 112.39020586013794, 115.97012996673584, 119.55005407333374, 122.98296976089478, 126.41588544845581, 129.6868507862091, 132.9578161239624, 136.4694013595581, 139.9809865951538, 143.5393843650818, 147.09778213500977, 150.61608171463013, 154.1343812942505, 157.63135075569153, 161.12832021713257, 164.68414568901062, 168.23997116088867, 171.78532338142395, 175.33067560195923, 178.82609915733337, 182.32152271270752, 185.6961064338684, 189.0706901550293, 192.46092891693115, 195.851167678833, 199.31975984573364, 202.78835201263428, 206.2990210056305, 209.8096899986267, 213.3500518798828, 216.89041376113892, 220.40821647644043, 223.92601919174194, 227.43214678764343, 230.93827438354492, 234.5128173828125, 238.08736038208008, 241.62598943710327, 245.16461849212646, 248.69336533546448, 252.2221121788025, 255.59779977798462, 258.97348737716675, 262.43833684921265, 265.90318632125854, 269.4254958629608, 272.9478054046631, 276.5328321456909, 280.11785888671875, 283.6824417114258, 287.2470245361328, 290.7050635814667, 294.16310262680054, 297.6222252845764, 301.0813479423523, 304.5642759799957, 308.04720401763916, 311.49316334724426, 314.93912267684937, 318.44459199905396, 321.95006132125854, 325.4119553565979, 328.87384939193726, 332.400830745697, 335.9278120994568, 339.5812015533447, 343.23459100723267, 346.87479734420776, 350.51500368118286, 354.1167097091675, 357.7184157371521, 361.2245066165924, 364.7305974960327, 368.2139542102814, 371.69731092453003, 375.1585605144501, 378.6198101043701, 382.16866421699524, 385.71751832962036, 389.2553400993347, 392.7931618690491, 396.2649760246277, 399.7367901802063, 403.31472420692444, 406.8926582336426, 410.4324429035187, 413.9722275733948, 417.5040924549103, 421.0359573364258, 424.51775097846985, 427.9995446205139, 431.4662272930145, 434.93290996551514, 438.41764974594116, 441.9023895263672, 445.4406991004944, 448.9790086746216, 452.57916021347046, 456.17931175231934, 459.76827335357666, 463.357234954834, 466.9008162021637, 470.4443974494934, 473.9389750957489, 477.4335527420044, 480.93746995925903, 484.4413871765137, 487.9930028915405, 491.5446186065674, 495.0784909725189, 498.61236333847046, 502.1659846305847, 505.719605922699, 509.2662556171417, 512.8129053115845, 516.3498485088348, 519.8867917060852, 523.3421049118042, 526.7974181175232, 530.2535717487335, 533.7097253799438, 537.2359735965729, 540.7622218132019, 544.2885818481445, 547.8149418830872, 551.3233485221863, 554.8317551612854, 558.334748506546, 561.8377418518066, 565.3072893619537, 568.7768368721008, 572.2313084602356, 575.6857800483704, 579.2066020965576, 582.7274241447449, 586.2965993881226, 589.8657746315002, 593.4016563892365, 596.9375381469727, 600.0001397132874, 603.062741279602, 606.0157046318054, 608.9686679840088, 612.097772359848, 615.2268767356873, 618.3549697399139, 621.4830627441406, 624.6458878517151, 627.8087129592896, 631.0021600723267, 634.1956071853638, 637.2120006084442, 640.2283940315247, 643.1879603862762, 646.1475267410278, 649.3398802280426, 652.5322337150574, 655.7355213165283, 658.9388089179993, 662.0571999549866, 665.1755909919739, 668.1320102214813, 671.0884294509888, 673.9944620132446, 676.9004945755005, 679.9741809368134, 683.0478672981262, 686.1891684532166, 689.3304696083069, 690.9011540412903, 692.4718384742737]
[45.82, 45.82, 70.9325, 70.9325, 77.475, 77.475, 79.9675, 79.9675, 80.4625, 80.4625, 83.4775, 83.4775, 83.6775, 83.6775, 83.8575, 83.8575, 84.2175, 84.2175, 84.4625, 84.4625, 86.3875, 86.3875, 88.3725, 88.3725, 89.6475, 89.6475, 90.6, 90.6, 90.895, 90.895, 91.06, 91.06, 92.5025, 92.5025, 92.81, 92.81, 92.925, 92.925, 93.0175, 93.0175, 93.47, 93.47, 93.645, 93.645, 93.8525, 93.8525, 93.97, 93.97, 94.06, 94.06, 94.285, 94.285, 94.3625, 94.3625, 94.37, 94.37, 95.0375, 95.0375, 95.1775, 95.1775, 95.2325, 95.2325, 95.2725, 95.2725, 95.335, 95.335, 95.4375, 95.4375, 95.5375, 95.5375, 95.585, 95.585, 95.605, 95.605, 95.6725, 95.6725, 95.67, 95.67, 95.6775, 95.6775, 95.7475, 95.7475, 95.7875, 95.7875, 95.85, 95.85, 95.8825, 95.8825, 95.9, 95.9, 95.93, 95.93, 95.9675, 95.9675, 95.98, 95.98, 95.98, 95.98, 96.005, 96.005, 96.045, 96.045, 96.0825, 96.0825, 96.075, 96.075, 96.105, 96.105, 96.145, 96.145, 96.1975, 96.1975, 96.2175, 96.2175, 96.2375, 96.2375, 96.2375, 96.2375, 96.255, 96.255, 96.2575, 96.2575, 96.25, 96.25, 96.2775, 96.2775, 96.3275, 96.3275, 96.33, 96.33, 96.3375, 96.3375, 96.325, 96.325, 96.375, 96.375, 96.415, 96.415, 96.4475, 96.4475, 96.4625, 96.4625, 96.465, 96.465, 96.485, 96.485, 96.4925, 96.4925, 96.5225, 96.5225, 96.56, 96.56, 96.5625, 96.5625, 96.58, 96.58, 96.56, 96.56, 96.6, 96.6, 96.5825, 96.5825, 96.5575, 96.5575, 96.5625, 96.5625, 96.5725, 96.5725, 96.59, 96.59, 96.58, 96.58, 96.5575, 96.5575, 96.5375, 96.5375, 96.5725, 96.5725, 96.5775, 96.5775, 96.6, 96.6, 96.59, 96.59, 96.5975, 96.5975, 96.5975, 96.5975, 96.6325, 96.6325, 96.6425, 96.6425, 96.65, 96.65, 96.6325, 96.6325, 96.6175, 96.6175, 96.6375, 96.6375, 96.625, 96.625]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 10, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.0  

fedrep
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346 
)
learning rate, batch size: 0.01, 10 

Final Round, Train loss: 1.473, Test loss: 1.504, Test accuracy: 95.84
Average accuracy final 10 rounds: 95.77475 

4080.53817486763
[3.5436933040618896, 7.087386608123779, 10.440189123153687, 13.792991638183594, 17.1362407207489, 20.47948980331421, 23.82097625732422, 27.16246271133423, 30.529860258102417, 33.897257804870605, 37.23268103599548, 40.56810426712036, 43.76357173919678, 46.95903921127319, 50.325594902038574, 53.692150592803955, 57.01488542556763, 60.3376202583313, 63.656582832336426, 66.97554540634155, 70.37677717208862, 73.7780089378357, 77.17382550239563, 80.56964206695557, 83.75983500480652, 86.95002794265747, 90.2533028125763, 93.55657768249512, 96.83024501800537, 100.10391235351562, 103.39430737495422, 106.68470239639282, 110.10418605804443, 113.52366971969604, 116.92540264129639, 120.32713556289673, 123.72880530357361, 127.13047504425049, 130.83212995529175, 134.533784866333, 137.89340686798096, 141.2530288696289, 144.58417749404907, 147.91532611846924, 151.29340720176697, 154.6714882850647, 157.89494919776917, 161.11841011047363, 164.53392934799194, 167.94944858551025, 171.34181880950928, 174.7341890335083, 178.0432004928589, 181.35221195220947, 184.51421236991882, 187.67621278762817, 191.05162262916565, 194.42703247070312, 197.63407397270203, 200.84111547470093, 204.15728974342346, 207.473464012146, 210.80966138839722, 214.14585876464844, 217.34055471420288, 220.53525066375732, 223.93181467056274, 227.32837867736816, 230.7351520061493, 234.14192533493042, 237.46690154075623, 240.79187774658203, 244.2737843990326, 247.75569105148315, 251.22439217567444, 254.69309329986572, 257.99252438545227, 261.2919554710388, 264.6553256511688, 268.0186958312988, 271.3389537334442, 274.6592116355896, 277.97889471054077, 281.29857778549194, 284.7529866695404, 288.20739555358887, 291.6759305000305, 295.14446544647217, 298.5122170448303, 301.8799686431885, 305.3331410884857, 308.78631353378296, 312.240713596344, 315.69511365890503, 319.05710458755493, 322.41909551620483, 325.8161129951477, 329.2131304740906, 332.5633313655853, 335.9135322570801, 339.22990798950195, 342.5462837219238, 345.8285219669342, 349.1107602119446, 352.4607939720154, 355.8108277320862, 359.03914642333984, 362.2674651145935, 365.72641348838806, 369.1853618621826, 372.6028401851654, 376.0203185081482, 379.227756023407, 382.43519353866577, 385.8123035430908, 389.18941354751587, 392.2593584060669, 395.3293032646179, 398.18514037132263, 401.04097747802734, 404.0670254230499, 407.0930733680725, 410.10745429992676, 413.121835231781, 416.1606559753418, 419.1994767189026, 422.2646095752716, 425.3297424316406, 428.41131591796875, 431.4928894042969, 434.3546621799469, 437.2164349555969, 440.21711921691895, 443.21780347824097, 446.1570100784302, 449.0962166786194, 452.27299547195435, 455.4497742652893, 458.5999126434326, 461.7500510215759, 464.65719270706177, 467.5643343925476, 470.5516526699066, 473.5389709472656, 476.60002756118774, 479.66108417510986, 482.5771265029907, 485.4931688308716, 488.5284321308136, 491.5636954307556, 494.6086754798889, 497.6536555290222, 500.620646238327, 503.58763694763184, 506.5511620044708, 509.5146870613098, 512.4027011394501, 515.2907152175903, 518.2113561630249, 521.1319971084595, 524.2038140296936, 527.2756309509277, 530.2502989768982, 533.2249670028687, 536.1133382320404, 539.0017094612122, 542.0308299064636, 545.0599503517151, 548.0369277000427, 551.0139050483704, 553.9788484573364, 556.9437918663025, 559.9554963111877, 562.967200756073, 565.9743139743805, 568.981427192688, 572.1659762859344, 575.3505253791809, 578.2098324298859, 581.0691394805908, 584.010175704956, 586.9512119293213, 590.0683906078339, 593.1855692863464, 596.2158017158508, 599.2460341453552, 602.147976398468, 605.0499186515808, 608.1548049449921, 611.2596912384033, 614.2541072368622, 617.248523235321, 620.1372134685516, 623.0259037017822, 626.0652313232422, 629.1045589447021, 632.0774574279785, 635.0503559112549, 638.0748624801636, 641.0993690490723, 642.5745513439178, 644.0497336387634]
[20.345, 20.345, 33.91, 33.91, 56.715, 56.715, 62.24, 62.24, 68.855, 68.855, 72.9075, 72.9075, 74.7175, 74.7175, 79.34, 79.34, 80.4375, 80.4375, 81.96, 81.96, 83.8, 83.8, 85.4875, 85.4875, 86.4975, 86.4975, 89.07, 89.07, 89.395, 89.395, 90.9625, 90.9625, 91.1175, 91.1175, 91.34, 91.34, 91.495, 91.495, 91.7825, 91.7825, 92.27, 92.27, 92.2275, 92.2275, 92.2775, 92.2775, 92.5975, 92.5975, 92.8075, 92.8075, 93.0725, 93.0725, 93.2525, 93.2525, 93.525, 93.525, 93.555, 93.555, 93.6, 93.6, 93.705, 93.705, 93.7525, 93.7525, 93.7725, 93.7725, 93.925, 93.925, 93.87, 93.87, 93.93, 93.93, 94.035, 94.035, 94.1475, 94.1475, 94.305, 94.305, 94.5, 94.5, 94.4675, 94.4675, 94.49, 94.49, 94.53, 94.53, 94.65, 94.65, 94.6775, 94.6775, 94.6375, 94.6375, 94.6975, 94.6975, 94.6975, 94.6975, 94.7375, 94.7375, 94.7675, 94.7675, 94.755, 94.755, 94.815, 94.815, 94.8825, 94.8825, 94.975, 94.975, 94.9725, 94.9725, 94.9275, 94.9275, 95.03, 95.03, 95.1375, 95.1375, 95.12, 95.12, 95.18, 95.18, 95.11, 95.11, 95.2175, 95.2175, 95.2975, 95.2975, 95.3325, 95.3325, 95.315, 95.315, 95.3475, 95.3475, 95.35, 95.35, 95.3475, 95.3475, 95.3975, 95.3975, 95.4075, 95.4075, 95.4075, 95.4075, 95.4875, 95.4875, 95.5075, 95.5075, 95.465, 95.465, 95.5475, 95.5475, 95.5475, 95.5475, 95.605, 95.605, 95.61, 95.61, 95.57, 95.57, 95.5575, 95.5575, 95.5775, 95.5775, 95.6225, 95.6225, 95.545, 95.545, 95.57, 95.57, 95.6525, 95.6525, 95.63, 95.63, 95.66, 95.66, 95.69, 95.69, 95.695, 95.695, 95.685, 95.685, 95.6875, 95.6875, 95.72, 95.72, 95.7375, 95.7375, 95.8125, 95.8125, 95.8, 95.8, 95.79, 95.79, 95.7925, 95.7925, 95.795, 95.795, 95.8025, 95.8025, 95.81, 95.81, 95.845, 95.845]
